# StackOverflow 问答 14486000-14486999

# orm - 如何使用orm在jaxb中进行多对多映射

> ID：14486010
> 
> 赞同：3
> 
> 时间：2013-01-23T17:44:22.570
> 
> 标签：orm, jaxb, hibernate-mapping

我正在尝试使用 jaxb 自动生成一些包含作者和书籍之间多对多关系的休眠映射类。数据库是postgres。我想要实现的是 Authors.java 和 Books.java，如下所示：

目标：Books.java

```
@ManyToMany(targetEntity = Author.class, cascade = {
    CascadeType.ALL
    }, mappedBy="books")
    public List<Author> getAuthors() {
    if (authors == null) {
        authors = new ArrayList<AUTHOR>();
    }
    return this.authors;
    } 
```

这是 bindings.xjb（它的一部分）

```
 <?xml version="1.0" encoding="UTF-8"?>
 <bindings xmlns="http://java.sun.com/xml/ns/jaxb" version="2.0"
xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc"
xmlns:jaxb="http://java.sun.com/xml/ns/jaxb"
    xmlns:hj="http://hyperjaxb3.jvnet.org/ejb/schemas/customizations"
xmlns:orm="http://java.sun.com/xml/ns/persistence/orm"
jaxb:extensionBindingPrefixes="hj orm">

<jaxb:bindings schemaLocation="types.xsd"
    node="/xs:schema">

    <jaxb:bindings
            node="xs:complexType[@name='author']//xs:element[@name='books']">
                   <hj:many-to-many>
                         <orm:join-table name="AUTHORS_BOOKS">
                                <orm:join-column name="aid" />
                                <orm:inverse-join-column name="bid"/>
                         </orm:join-table>
                   </hj:many-to-many>
     </jaxb:bindings>

    <jaxb:bindings
            node="xs:complexType[@name='book']//xs:element[@name='authors']">
                   <hj:many-to-many name="authors" mapped-by="books">
                       <hj:cascade>
                       <hj:cascade-persist/>
                       </hj:cascade>
                   </hj:many-to-many>
     </jaxb:bindings>

    <jaxb:bindings
        node="xs:complexType[@name='author']//xs:element[@name='aid']">
        <hj:id>
            <orm:generated-value strategy="AUTO" />
        </hj:id>
    </jaxb:bindings>

    <jaxb:bindings
        node="xs:complexType[@name='book']//xs:element[@name='bid']">
        <hj:id>
            <orm:generated-value strategy="AUTO" />
        </hj:id>
    </jaxb:bindings>

</bindings> 
```

这是 types.xsd（它的一部分）

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
 <xs:schema version="1.0" targetNamespace="http://catapult.jieddo.mil/feeds/domain"
xmlns:tns="http://catapult.jieddo.mil/feeds/domain"   
    xmlns:xs="http://www.w3.org/2001/XMLSchema">

<xs:complexType name="author">
    <xs:sequence>
        <xs:element name="id" type="xs:long"/>
        <xs:element name="name" type="xs:string" />
        <xs:element name="books" type="tns:book" minOccurs="0" maxOccurs="1000"/>
    </xs:sequence>
</xs:complexType>

<xs:complexType name="book">
    <xs:sequence>
        <xs:element name="id" type="xs:long"/>
        <xs:element name="name" type="xs:string"/>
        <xs:element name="authors" type="tns:author" minOccurs="0" maxOccurs="1000"/>
    </xs:sequence>
</xs:complexType>

</xs:schema> 
```

使用上述绑定和 xsd，我生成的文件如下所示。

当前：Authors.java

```
 @ManyToMany(targetEntity = Book.class, cascade = {
    CascadeType.ALL
})
@JoinTable(name = "AUTHORS_BOOKS", joinColumns = {
    @JoinColumn(name = "aid")
}, inverseJoinColumns = {
    @JoinColumn(name = "bid")
})
public List<Book> getBooks() {
    if (books == null) {
        books = new ArrayList<Book>();
    }
    return this.books;
} 
```

当前： Books.java

```
 @ManyToMany(targetEntity = Author.class, cascade = {
    CascadeType.ALL
}, mappedBy="books")
@JoinTable(name = "BOOK_AUTHORS_BOOK", joinColumns = {
    @JoinColumn(name = "PARENT_BOOK_ID")
}, inverseJoinColumns = {
    @JoinColumn(name = "CHILD_AUTHOR_ID")
})
public List<Author> getAuthors() {
    if (authors == null) {
        authors = new ArrayList<AUTHOR>();
    }
    return this.authors;
} 
```

在当前的 Book.java 中，我认为不应该存在 @JoinTable 表示法（表名也是错误的）。如果我使获取延迟或在 bindings.xjb 中未声明它，我会一直遇到延迟初始化错误

org.hibernate.LazyInitializationException：未能延迟初始化角色集合

如果我进行 fetch="EAGER" 那么我收到以下错误：

org.hibernate.loader.MultipleBagFetchException：不能同时获取多个包

而且我认为我遇到了这些问题，因为我的映射中的某些内容很愚蠢。关于这里发生了什么的任何想法？

# jax-ws - 在将 SOAP 消息发送到消费服务之前查看它

> ID：14486011
> 
> 赞同：2
> 
> 时间：2013-01-23T17:44:27.783
> 
> 标签：jax-ws, cxf, mule, flow

我在 mule 流中使用 CXF JAX-WS 来访问服务。

我能够成功访问它。

有什么方法可以让我在发送之前看到正在发送到服务的消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:57:44.620

试试 Logging Iterceptors。

```
<cxf:jaxws-client clientClass="com.example.MyexampleService"
    wsdlLocation="MyService.wsdl"               
    operation="sayHello" port="MyServicePort"        
    doc:name="SOAP">
    <cxf:outInterceptors>
 <spring:bean id="outLogger"
 class="org.apache.cxf.interceptor.LoggingOutInterceptor" />
    </cxf:outInterceptors>
</cxf:jaxws-client> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:53:52.873

您可以选择在调用 JAX WS 客户端之前打印有效负载，如下所示：

```
<logger message="------>Payload #[payload] before calling the web service client." level="INFO" /> 
```

或使用 a`Out Interceptor`打印传入请求并`In Interceptor`打印服务响应

```
<cxf:jaxws-client clientClass="..."
        wsdlLocation="..."              
        operation="..."  >                
        <cxf:inInterceptors>
            <spring:bean class="org.apache.cxf.interceptor.LoggingInInterceptor" />                  
        </cxf:inInterceptors>
        <cxf:outInterceptors>
            <spring:bean class="org.apache.cxf.interceptor.LoggingOutInterceptor" />
        </cxf:outInterceptors>              
</cxf:jaxws-client> 
```

# java - 从字节数组创建列表

> ID：14486014
> 
> 赞同：0
> 
> 时间：2013-01-23T17:44:40.917
> 
> 标签：java, android, objective-c

我正在移植一些目标 C 代码。

我需要创建一个对象列表（我将使用任何类型的列表，只要有意义）。该类如下所示：

```
class Foo{
    double fooValue1;
    double fooValue2;
    double fooValue3;
    double fooValue4;
} 
```

我正在将二进制文件读入一个工作正常的字节数组。字节数组是 4 个双精度的列表。因此，如果文件中有 100 个 Foo 实例，则字节数组有 3200 个字节。即 4 * 8 * 100。

在 Objective C 中，变量被声明为指向 Foo 类型数组的指针。通过简单地复制字节来加载该数组非常快。这样做的声明是：

```
[byteArray getBytes:fooData range:range] 
```

其中 range 是`NSRange`位置 = 0 且长度 = 字节数组长度的实例，byteArray 是从文件中读取的原始字节 []，而 fooData 是指向目标数组的指针。

目前，我正在遍历字节数组，为每 32 个字节创建一个新的 Foo 实例，然后通过将每 8 个字节转换为双精度来分配字段。对于数千个对象，这很慢。

我的目标是 API 8，因此`Arrays.copyOf`我无法使用它，但如果它提供了一个好的解决方案，我会考虑更改目标。

问题是; 有没有办法以与 Objective C 类似的“单一语句”方式创建列表？

谢谢

[编辑] 这是我根据彼得的回答使用的最终代码。我应该补充一点，该文件实际上包含一个列表列表，用标题分隔。解析文件的结果是一个字节数组。

```
ArrayList<SCGisPointData> pointData = new ArrayList<SCGisPointData>();
SCGisPointData thisPointdata;

for (byte[] ring : linearRings) {

    DoubleBuffer buffer = ByteBuffer.wrap(ring).order(ByteOrder.nativeOrder()).asDoubleBuffer().asReadOnlyBuffer();

    thisPointdata= new SCGisPointData ();

    while (buffer.hasRemaining()) {
        thisPointdata = new SCGisPointData();
        thisPointdata.longitude = buffer.get();
        thisPointdata.latitude = buffer.get();
        thisPointdata.sinLatitude = buffer.get();
        thisPointdata.cosLatitude = buffer.get();
        pointData.add(thisPointdata);  
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:51:31.777

在纯 Java 中没有办法神奇地假设一种类型可以变成另一种类型。顺便说一句，您可以使用 Unsafe 在 HotSpot 中执行此操作，但我不相信您可以在 Android 中使用它，这可能是最好的。

您可以通过使用具有本机字节顺序的直接 ByteBuffer 来加快翻译速度。这最大限度地减少了开销，但在 Android 中不如在 HotSpot 中快（因为后者可以将这些转换为内部方法）

我会计算这需要多长时间作为估计

```
// or use a MappedByteBuffer from a file
ByteBuffer bb = ByteBuffer.allocateDirect(3200).order(ByteOrder.nativeOrder());
while(bb.remaining() > 0) {
   float f= bb.getFloat();
} 
```

注意：这不会运行足够长的时间，甚至无法被 JITted 到本机代码。

```
ByteBuffer bb = ByteBuffer.allocateDirect(3200).order(ByteOrder.nativeOrder());
for (int i = 0; i < 12; i++) {
    long start = System.nanoTime();
    bb.clear(); // simulate we have 3200 bytes to read.
    int count = 0;
    while (bb.remaining() > 0) {
        float f = bb.getFloat();
        count++;
    }
    long time = System.nanoTime() - start;
    System.out.printf("Took %,d micro-seconds to read %,d float values%n", time / 1000, count);
} 
```

在 HotSpot Java 7 上打印

```
Took 960 micro-seconds to read 800 float values
Took 141 micro-seconds to read 800 float values
Took 99 micro-seconds to read 800 float values
Took 101 micro-seconds to read 800 float values
Took 100 micro-seconds to read 800 float values
Took 102 micro-seconds to read 800 float values
Took 115 micro-seconds to read 800 float values
Took 127 micro-seconds to read 800 float values
Took 108 micro-seconds to read 800 float values
Took 79 micro-seconds to read 800 float values
Took 78 micro-seconds to read 800 float values
Took 79 micro-seconds to read 800 float values 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:51:56.780

看看[MappedByteBuffer](http://developer.android.com/reference/java/nio/MappedByteBuffer.html)。在 Android 上可用，让您：

*   将文件映射为字节缓冲区
*   直接从所述缓冲区读取双精度值。

您必须小心选择正确的字节序。这是一些示例代码（请注意，API 将完成将字节缓冲区“转换”为双缓冲区的繁重工作，并且您可以一次从缓冲区中检索多个双精度）：

```
final String fileName = "/some/path/data.txt";
final MappedByteBuffer byteBuffer = new FileInputStream(fileName)
    .getChannel()
    .map(MapMode.READ_ONLY, 0, 3200);
final DoubleBuffer doubleBuffer = byteBuffer.asDoubleBuffer();

double[] swap = new double[4];
doubleBuffer.get(swap); 
```

# java - JSF 项目如何从其依赖项之一显示 xhtml 文件

> ID：14486016
> 
> 赞同：0
> 
> 时间：2013-01-23T17:44:41.927
> 
> 标签：java, jsf, maven

我正在尝试创建一个可以在许多项目中使用的常见错误页面。

我正在尝试创建一个名为 ErrorProject 的单独项目。我所有的其他项目都会对这个 ErrorProject 有 Maven 依赖。

假设我创建了项目 A，但出现错误，在浏览器中使用项目 A 时，如何从 ErrorProject 显示 xhtml 页面？

目前我在`web.xml`项目 A 中有这个，并且`error.xhtml`是 ErrorProject 中的一个页面。

```
<error-page>
    <exception-type>java.lang.Throwable</exception-type>
    <location>/error.xhtml</location>
</error-page>

<error-page>
    <error-code>404</error-code>
    <location>/error.xhtml</location>
</error-page> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:15:23.357

你的错误项目是一个引发战争的**网络项目吗？**如果只是`/error.xhtml`放入`src/main/webapp`. 然后你可以添加依赖，[Maven 会做一个覆盖](http://maven.apache.org/plugins/maven-war-plugin/overlays.html)，将它包含到主应用程序的 web 根目录中，这样你就可以从`web.xml`.

# javascript - html 按钮和 href 没有按预期工作

> ID：14486017
> 
> 赞同：2
> 
> 时间：2013-01-23T17:44:50.637
> 
> 标签：javascript, html

在下面的代码中，我有一个 href 和一个使用 javascript 发布到新页面的按钮。当我单击它时，href 有效，但使用 javascript 的按钮需要多次单击并且间歇性地工作。有时只需点击三下，但可能高达 19 次点击，具体取决于我点击鼠标的力度:)

任何想法为什么这些行为不同？

```
<head>
    <script type="text/javascript">
        function myFunction() {
            window.location.href = 'tournaments.aspx';
        }
    </script>
</head>
<body>
<form>
<div style="width:400px; height: 600px; border: 1px solid black;" align="center" >
    <div>
        <input type="image" name="ctl02" src="Images/Advertisement.png" />
    </div>
    <div>
        <input type="image" name="ctl03" src="Images/ISETLogo.png" />
    </div>
    <div >
        <button onclick="myFunction()">Click me</button>
        <a href="tournaments.aspx">tournaments</a>
    </div>
</div>
</form> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T17:54:56.913

这可能是因为您在标签中有一个按钮，`<form>`默认情况下会在单击时尝试提交表单。因此，除了尝试在当前窗口中加载“tournaments.aspx”之外，您还可以发布到当前页面，该页面将通过重新加载做出反应。

要防止这种默认行为，`return false;`请在您的`onclick`:

```
<head>
    <script type="text/javascript">
        function myFunction() {
            window.location.href = 'tournaments.aspx';           
        }
    </script>
</head>
<body>
<form>
<div style="width:400px; height: 600px; border: 1px solid black;" align="center" >
    <div>
        <input type="image" name="ctl02" src="Images/Advertisement.png" />
    </div>
    <div>
        <input type="image" name="ctl03" src="Images/ISETLogo.png" />
    </div>
    <div >
        <button onclick="myFunction(); return false;">Click me</button>
        <a href="tournaments.aspx">tournaments</a>
    </div>
</div>
</form>
</body> 
```

# javascript - javascript Internet Explorer 数组问题

> ID：14486023
> 
> 赞同：0
> 
> 时间：2013-01-23T17:45:27.997
> 
> 标签：javascript, internet-explorer-9, yui3

我知道 Internet Explorer <9 的 Javascript 数组存在问题。我尝试过[使用](http://code.google.com/p/ddr-ecma5/) [权宜之计](https://stackoverflow.com/a/6541169/2004825)，但我一生都无法弄清楚这一点。

基本上，我有这个代码（减少了）：

```
YUI.add('query-params', function (Y) {
  Y.QueryParams = {
  /**
  Parses our query string and returns an object containing the k/v pairs passed
  in rules

  @method parse
  @param {String} query string to parse
  @param {RegExp} regex rules to compare our query string against
  @return {Object} returns an object containing the k/v pairs that match
  */
  parse: function (qs, rules, params) {
    qs = qs.replace('?', ''); // remove ? from query string
    qs = qs.replace(/\+/g, ' ');
    var matches = rules.exec(qs);
    var defined_matches = Y.Array.filter(matches, function(m) {
      return ((typeof m != 'undefined') || ( m == true ));
    });

// rest of script omitted 
```

它被初始化为：

```
 <script>
  YUI({
    modules: {
      'query-params': {
        fullpath: './parse_search_terms.js'
      }
    },
    onFailure: function (error) {
      console.log(JSON.stringify(error));
    }
  }).use('node', 'console', 'query-params', function (Y) {
    var params = Y.QueryParams.parse(window.location.search, /(\w+)\s(\w+)\s(\w+)|(\w+)\s(\w+)/ig, ["firstName", "lastName", "state"]);
    var url = "url_to_send_to?firstName=" + params.firstName + "&lastName=" + params.lastName + "&state=" + params.state;

    var iframe = Y.Node.create('<iframe></iframe>').setAttrs({
      src: url,
      frameBorder: 'no',
      height: 300,
      width: 800,
      scrolling: 'no'
});
    Y.one('#iframe').appendChild(iframe);
}); 
```

当我传递像“q=john+smith+ca”和 JSON.stringify 这样的查询字符串时，我在 IE、Firefox 和 Chrome 中得到的匹配变量是这样的：

```
john smith ca,john,smith,ca,, 
```

当我在数组上调用 Y.Array.filter 时，Firefox 和 Chrome 会做正确的事情：

```
defined ["john","smith","ca"] 
```

但是 Internet Explorer 8：

```
defined ["john","smith","ca","",""] 
```

所以由于某种原因，IE 没有正确过滤我的数组。我已经尝试了所有上述阵列垫片和权宜之计，但似乎没有任何效果。我认为这将是非常有效的跨浏览器，因为我使用的是 YUI3，但我很难过。

有人有想法么？非常感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T16:36:34.747

事实证明，如果未设置 doctype，IE 将进入“怪癖模式”。在页面顶部添加“”可以解决所有问题。

# file - 使用带有重音符号的文件名在 StreamWithExternalResource 中崩溃

> ID：14486024
> 
> 赞同：0
> 
> 时间：2013-01-23T17:45:29.137
> 
> 标签：file, windows-8, microsoft-metro, windows-store-apps, non-ascii-characters

我必须阅读图片文件夹中带有重音符号的图像（例如“éleá”）。这个名字与一个也有口音的数据库相连。我正在使用来自客户端的这些资源，不知道是否可以同时更改数据库和文件名。

我已经使用以下代码成功加载了没有重音的图像：

```
IRandomAccessStream stream = StreamWithExternalResource(resourcePath).Result;

BitmapImage bitmapImage = new BitmapImage();
bitmapImage.SetSource(stream);

image.Source = bitmapImage; 
```

是否可以在 Windows Metro/Store 应用程序中读取文件名带有重音符号的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T10:27:46.400

命名文件的规则可以在这篇 MSDN 文章中找到：

[http://msdn.microsoft.com/en-us/library/aa365247.aspx](http://msdn.microsoft.com/en-us/library/aa365247.aspx)

重音符号应该没有问题，比如`áéíóú`，但是你会遇到使用保留字符的问题，比如`<>|\/`.

我会尝试使用常量文件名对 resourcePath 进行硬编码，并确保数据库中没有任何奇怪的东西。另一个测试是使用该函数将长文件名转换为短文件名（8.3 MS-DOS 格式）`GetShortPathName`。

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa364989(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364989(v=vs.85).aspx)

# vb.net - 解释反编译源中的错误

> ID：14486026
> 
> 赞同：0
> 
> 时间：2013-01-23T17:45:33.643
> 
> 标签：vb.net, visual-studio-2010, class, friend

我在网上找到了一些有用的代码，其中只提供了库文件，我重新创建了源代码，但发现了一些我不确定的错误。

```
<StandardModule()> _
Friend NotInheritable Class CreateFiles
' Methods

' Fields
Private Shared Configuration As Configuration = New Configuration

' Nested Types
Private Delegate Sub showITDelegate(ByVal message As String)

<STAThread()> _
Public Shared Sub Main()
    CreateFiles.Configuration.ReadConfig()
    CreateFiles.DisplayConfig(CreateFiles.Configuration)
    CreateFiles.CreateFiles()
End Sub

Public Shared Sub CreateFiles() 
```

我试图了解是否缺少另一个类，因为主中的 CreateFiles.* 行和此类中的这些参考子行存在错误： CreateFiles 在其下具有“表达式不产生值”。为什么它会引用自己以及同一类中的方法和子类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:59:54.123

似乎它着眼于`Sub CreateFiles()`而不是类。并且子（例程）不返回任何值。您可以删除子例程`CreateFiles`中的 (first)。`Main`

这应该有效：

```
<StandardModule()> _
Friend NotInheritable Class CreateFiles
' Methods

' Fields
Private Shared Configuration As Configuration = New Configuration

' Nested Types
Private Delegate Sub showITDelegate(ByVal message As String)

<STAThread()> _
Public Shared Sub Main()
    Configuration.ReadConfig()
    DisplayConfig(Configuration)
    CreateFiles()
End Sub

Public Shared Sub CreateFiles() 
```

鉴于您在其他任何地方都没有问题。

# java - org.netbeans.validation.api.ui.ValidationGroup.add() - 如何指定 ValidationStrategy？

> ID：14486028
> 
> 赞同：0
> 
> 时间：2013-01-23T17:45:38.510
> 
> 标签：java, validation, netbeans

以前我使用了支持的netbeans ValidationAPI_v0.4：

```
org.netbeans.validation.api.ui.ValidationGroup group;
...
group.add(myTextField, ValidationStrategy.ON_CHANGE_OR_ACTION, Validators.IP_ADDRESS); 
```

使用最新的 ValidationGroup API 如何指定 ValidationStrategy.ON_CHANGE_OR_ACTION ？

我在 ValidationGroup 中看到一个没有 ValidationStrategy 参数的 add() ：

```
public final <ComponentType,ValueType> void add(ComponentType comp,
                                 Validator<ValueType>... validators) 
```

有关简单验证的更多信息，请访问[http://kenai.com/projects/simplevalidation/pages/Home](http://kenai.com/projects/simplevalidation/pages/Home)

Javadoc API 位于[http://mongkie.org/javadoc/org-mongkie-validation/org/netbeans/validation/api/ui/ValidationGroup.html#add%28ComponentType,%20org.netbeans.validation.api.Validator... %29](http://mongkie.org/javadoc/org-mongkie-validation/org/netbeans/validation/api/ui/ValidationGroup.html#add%28ComponentType,%20org.netbeans.validation.api.Validator...%29)

我的旧方法用于例如[org.netbeans.validation.api.builtin.Validators](https://stackoverflow.com/questions/6843235/org-netbeans-validation-api-builtin-validators/8228519#8228519)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T18:32:34.917

原来 ON_CHANGE_OR_ACTION 是默认值。

在简单验证 API 的 0.4 和 0.9 版本之间有很多 API 变化。

我使用的信息来自：

*   [http://kenai.com/projects/simplevalidation/forums/forum/topics/1963-API-Stabilization-and-Changes](http://kenai.com/projects/simplevalidation/forums/forum/topics/1963-API-Stabilization-and-Changes)

并查看了类似迁移的变化

*   [https://netbeans.org/bugzilla/show_bug.cgi?id=204648](https://netbeans.org/bugzilla/show_bug.cgi?id=204648)其中引用变更集[http://hg.netbeans.org/main/rev/fa49e79eb900](http://hg.netbeans.org/main/rev/fa49e79eb900)来源[https://svn.kenai.com/svn/simplevalidation ~src/主干/](https://svn.kenai.com/svn/simplevalidation~src/trunk/)

以更好地了解必须更改的内容。

# python - 树莓派“响应缩进错误”

> ID：14486040
> 
> 赞同：0
> 
> 时间：2013-01-23T17:46:27.653
> 
> 标签：python, sms, response, local, raspberry-pi

我一直在看一个关于如何通过 rasp pi 发送短信的教程。这是我拥有的代码，我不确定为什么会出错。

```
#!/usr/bin/python 
#----------------------------------- 
# Send SMS Text Message 
# 
# Author : Matt Hawkins 
# Site : http://www.raspberrypi-spy.co.uk/ 
# Date : 30/08/2012 
# 
# Requires account with TxtLocal 
# http://www.txtlocal.co.uk/?tlrx=114032 
#  
#----------------------------------- 

# Import required libraries 
import urllib # URL functions 
import urllib2 # URL functions 

# Define your message 
message = 'Test message sent from my Raspberry Pi' 

# Set your username and sender name. 
# Sender name must alphanumeric and 
# between 3 and 11 characters in length. 
username = 'jonfdom1@aol.com' 
sender = 'Jonny.D' 

# Your unique hash is available from the docs page 
# https://control.txtlocal.co.uk/docs/ 
hash = '8fe5dae7bafdbbfb00c7aebcfb24e005b5cb7be8' 

# Set the phone number you wish to send 
# message to. 
# The first 2 digits are the country code. 
# 44 is the country code for the UK 
# Multiple numbers can be specified if required 
# e.g. numbers = ('447xxx123456','447xxx654321') 
numbers = ('447xxxxxx260') 

# Set flag to 1 to simulate sending 
# This saves your credits while you are 
# testing your code. 
# To send real message set this flag to 0 
test_flag = 1 

#----------------------------------- 
# No need to edit anything below this line 
#----------------------------------- 

values = {'test' : test_flag, 
'uname' : username, 
'hash' : hash, 
'message' : message, 
'from' : sender, 
'selectednums' : numbers } 

url = 'http://www.txtlocal.com/sendsmspost.php' 

postdata = urllib.urlencode(values) 
req = urllib2.Request(url, postdata) 

print 'Attempt to send SMS ...' 

try: 
response = urllib2.urlopen(req) 
response_url = response.geturl() 
if response_url==url: 
print 'SMS sent!' 
except urllib2.URLError, e: 
print 'Send failed!' 
print e.reason 
```

这是我在终端上弹出的错误消息

```
 File "send_sms.py", line 331
    response = urllib2.urlopen(req) 
           ^
IndentationError: expected an indented block 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:59:25.450

Python 需要适当的缩进，如下所示：

```
try: 
    response = urllib2.urlopen(req) 
    response_url = response.geturl() 
    if response_url==url: 
        print 'SMS sent!' 
except urllib2.URLError, e: 
    print 'Send failed!' 
    print e.reason 
```

这是[Dive Into Python 3 中有关 Python 缩进的部分](http://getpython3.com/diveintopython3/your-first-python-program.html#indentingcode)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:58:23.133

> *   语句分组是通过缩进 [...]

[来源](http://docs.python.org/2/tutorial/appetite.html)

# html - 更改后刷新 CSS 样式表？

> ID：14486043
> 
> 赞同：0
> 
> 时间：2013-01-23T17:46:33.013
> 
> 标签：html, css

> **可能重复：**
> [强制刷新缓存数据](https://stackoverflow.com/questions/3870726/force-refresh-of-cached-data)

在网站进行视觉更改后更新 CSS 样式表的最佳做法是什么？

我最近用新图片更新了我的网页并更新了 css。当我的朋友查看该站点时，他的浏览器出于某种原因将以前的 css 与新图像一起渲染。他以前曾访问过该网站。据我了解，样式表没有刷新，但他们的图像在他第一次启动网站时发生了变化，导致它出现错误。在他刷新页面后，它更新了 css 并且看起来还不错。

重大更改后是否需要更改 css 的名称以强制下载新样式表？或者有没有办法让浏览器强制重新加载样式表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T17:49:24.200

他有以前的版本，因为它被缓存了。最后，他可以通过使用`cntrl`+ `f5`（在 chrome 上）或他的浏览器等效项来“强制”一个新的 CSS 文件。或者只是清空他的缓存。

对您来说，您可以做的是更改样式表的名称。您可以通过将 a 添加`?=x`到样式表 href 来做到这一点。它使浏览器认为它是一个新版本，但实际上只是旧版本。

如果您不想再次缓存文件（我不建议这样做），您可以在 中添加时间戳`?=`，但同样，我不建议这样做

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:50:06.973

浏览器正在缓存 CSS 文件。如果在开发过程中这是一个问题，您可以使用诸如时间戳记脚本链接之类的技巧：[在此处描述](http://css-tricks.com/can-we-prevent-css-caching/)

在生产中，这通常不是问题，可以通过用户清除缓存来解决。通常浏览器会在刷新时获取更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:50:00.863

一个常见的解决方案是这样的：`<link href="css/style.css?<?php echo time();?>"`这将强制浏览器重新下载 css 文件。浏览器会认为这是一个新文件。

# asp.net - WCF 与 WebAPI 和本机移动设备

> ID：14486048
> 
> 赞同：7
> 
> 时间：2013-01-23T17:46:41.600
> 
> 标签：asp.net, wcf, asp.net-web-api

我一直在开发一个完全基于 ajax（没有 POST）的单页 Web 应用程序，现在我正在使用 ASMX 作为 Web 服务，而它正在开发中。Web 服务使用 JSON 数据。对于该版本，我知道我需要升级到 WCF 或 WebAPI。

最终，我计划构建原生移动应用程序，这些应用程序将使用与 Web 应用程序相同的 Web 服务。在所有条件相同的情况下，如果我必须在两者之间进行选择，我应该选择哪个选项，以便 Web 服务可以与不同的客户端应用程序一起使用？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-26T09:05:03.617

如果您的应用程序设计为只能通过各种平台的移动设备访问，这意味着您必须为所有这些平台找到最简单的共同点。因此，换句话说，如果您关心互操作性，您将专注于一种所有平台都可以使用的独特通信技术。

JSON + REST 似乎是当今许多平台（当然包括移动平台）最常见的最简单的分母。如果这是您将实现的唯一通信技术，那么 WebAPI 似乎是显而易见的选择。

WCF 更可扩展，更可配置，你可以在不同的协议上插入不同的绑定、不同的编码，它实现了 SOAP、WS-*，它可以非常快（通过精心选择的绑定），你也可以用它做 JSON+REST ，但是您并不需要所有这些功能（由于所有这些功能，WCF 也可能非常复杂），您需要的似乎是无处不在和简单。鉴于您的要求，我会选择 WebAPI。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-26T22:02:16.327

我使用 WCF 开发了一组 RESTful Web 服务，并且最近启动了一个用 ASP.NET Web API 替换 WCF 的项目。我的经验是 ASP.NET Web API 比 WCF 更容易学习和使用。我还可以给您几个选择 ASP.NET Web API 的理由：

*   WCF url 包含“.svc”扩展名。例如： `http://localhost/MyRestService.svc/`。这不应该对客户造成问题，但它很丑陋。`.svc`您可以通过使用 IIS URL 重写模块（请参阅[此博客文章](http://www.west-wind.com/weblog/posts/2008/Dec/15/Removing-the-SVC-Extension-from-WCF-REST-URLs)）摆脱扩展，但使用 ASP.NET Web API，您一开始就没有问题。

*   WCF 使用`DataContractJsonSerializer`，它生成的 JSON 可能会给客户端带来问题。具体示例包括[日期](http://www.hanselman.com/blog/OnTheNightmareThatIsJSONDatesPlusJSONNETAndASPNETWebAPI.aspx)和[字典](https://stackoverflow.com/questions/4559991/any-way-to-make-datacontractjsonserializer-serialize-dictionaries-properly)。您可以更改 WCF 使用的序列化程序（请参阅此[SO 问题](https://stackoverflow.com/questions/3118504/how-to-set-json-net-as-the-default-serializer-for-wcf-rest-service)），但 ASP.NET Web API 默认使用 JSON.NET，这是高度可配置的。

如果我今天开始创建一个新的 RESTful Web 服务，那么选择 ASP.NET Web API 而不是 WCF 将是一个简单的选择，因为这就是它的设计目的。

# python - Django Haystack Solr manage.py rebuild_index TypeError: cannot serialize 1.0 (type float)

> ID：14486056
> 
> 赞同：1
> 
> 时间：2013-01-23T17:47:06.010
> 
> 标签：python, django, django-haystack, pysolr

我尽量不寻求帮助并自己解决，但这非常困难，我无法弄清楚如何解决它。我正在使用 Python 2.7 和 Django 1.4。我使用 Tomcat 7.0 和 Solr 作为 Haystack v2 beta 的后端。我安装了 Pysolr v 3。Apache Tomcat 服务运行正常，我可以去 127.0.0.1:8000/solr/admin。我运行 manage.py build_solr_schema 并将该 schema.xml 文件放入我的 C:\solr\conf 文件夹中。

作为最后一步，我想运行 manage.py rebuild_index。当我在命令提示符中键入并单击 Enter 时，我会收到通常的消息：

```
WARNING: This will irreparably remove EVERYTHING from your search index in connection 'default'.
Your choices after this are to restore from backups or rebuild via the `rebuild_index` command.
Are you sure you wish to continue? [y/N] 
```

然后，当我输入“y”并再次单击输入时，我得到以下信息：

```
Removing all documents from your index because you said so.
All documents removed.
Indexing 71 readings.
Traceback (most recent call last):
File "C:\Users\Tech11\Dropbox\skimreads\skimreads\manage.py", line 10, in <module>
    execute_from_command_line(sys.argv)
  File "C:\Python27\lib\site-packages\django\core\management\__init__.py", line 443, in     execute_from
_command_line
    utility.execute()
  File "C:\Python27\lib\site-packages\django\core\management\__init__.py", line 382, in execute
self.fetch_command(subcommand).run_from_argv(self.argv)
  File "C:\Python27\lib\site-packages\django\core\management\base.py", line 196, in run_from_argv
self.execute(*args, **options.__dict__)
  File "C:\Python27\lib\site-packages\django\core\management\base.py", line 232, in execute
output = self.handle(*args, **options)
  File "c:\users\tech11\dropbox\django\skimreads\skimreads\src\django-  haystack\haystack\management\c
ommands\rebuild_index.py", line 15, in handle
call_command('update_index', **options)
   File "C:\Python27\lib\site-packages\django\core\management\__init__.py", line 150,     in call_command

return klass.execute(*args, **defaults)
  File "C:\Python27\lib\site-packages\django\core\management\base.py", line 232, in execute
output = self.handle(*args, **options)
  File "c:\users\tech11\dropbox\django\skimreads\skimreads\src\django-haystack\haystack\management\c
ommands\update_index.py", line 181, in handle
return super(Command, self).handle(*items, **options)
  File "C:\Python27\lib\site-packages\django\core\management\base.py", line 341, in handle
label_output = self.handle_label(label, **options)
  File "c:\users\tech11\dropbox\django\skimreads\skimreads\src\django-haystack\haystack\management\c
ommands\update_index.py", line 240, in handle_label
do_update(self.backend, index, qs, start, end, total, self.verbosity)
  File "c:\users\tech11\dropbox\django\skimreads\skimreads\src\django-haystack\haystack\management\c
ommands\update_index.py", line 79, in do_update
backend.update(index, current_qs)
  File "c:\users\tech11\dropbox\django\skimreads\skimreads\src\django-haystack\haystack\backends\sol
r_backend.py", line 66, in update
self.conn.add(docs, commit=commit, boost=index.get_field_weights())
File "build\bdist.win-amd64\egg\pysolr.py", line 746, in add
File "C:\Python27\lib\xml\etree\ElementTree.py", line 1127, in tostring
ElementTree(element).write(file, encoding, method=method)
File "C:\Python27\lib\xml\etree\ElementTree.py", line 821, in write
serialize(write, self._root, encoding, qnames, namespaces)
File "C:\Python27\lib\xml\etree\ElementTree.py", line 940, in _serialize_xml
_serialize_xml(write, e, encoding, qnames, None)
File "C:\Python27\lib\xml\etree\ElementTree.py", line 940, in _serialize_xml
_serialize_xml(write, e, encoding, qnames, None)
File "C:\Python27\lib\xml\etree\ElementTree.py", line 933, in _serialize_xml
v = _escape_attrib(v, encoding)
File "C:\Python27\lib\xml\etree\ElementTree.py", line 1093, in _escape_attrib
_raise_serialization_error(text)
File "C:\Python27\lib\xml\etree\ElementTree.py", line 1053, in _raise_serialization_error
"cannot serialize %r (type %s)" % (text, type(text).__name__)
TypeError: cannot serialize 1.0 (type float) 
```

请帮忙，因为我已经为此苦苦挣扎了一段时间。我已经让这个设置在我的家用电脑上工作，但我工作的电脑性能不佳。非常感谢您提前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T16:40:55.740

更新到 pysolr 3.0.6 修复了这个问题。

（我知道我参加聚会有点晚了，但无论如何它可能对某人有帮助。）

# windows-phone-7 - 如果我更改已经存在的 WP 应用程序的 ProductID 会发生什么？

> ID：14486058
> 
> 赞同：5
> 
> 时间：2013-01-23T17:47:14.737
> 
> 标签：windows-phone-7, windows-phone-7.1, windows-phone-8, windows-phone, windows-phone-7.1.1

我已经向市场提交了两个应用程序，现在我意识到它们在 WMAppManifest 和 AssemblyInfo 文件中具有相同的 ProductID - 所以我不能同时将这两个应用程序安装（部署）到模拟器。

如果在提交过程中这个 ProductID 保持不变，那么恐怕用户将无法同时安装我的两个应用程序。所以我想我的问题是：我在这两个文件中指定的 ProductID 真的很重要吗？还是提交过程会处理它并生成一个真正独特的 GUID？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-23T18:22:52.457

产品 ID 是在您在应用中心创建应用时分配的。特别是对于 WP7.X，作为认证过程的一部分，您放入 WMManifest.xml 中的大部分内容都被重写/重写。

您可能遇到的更大问题是您无法在具有相同 ProductId 的设备上加载多个应用程序，因此如果您想在同一个模拟器实例或同一物理设备上加载它们，您需要更改一个其中。

# matlab - Matlab中信号的到达时间估计

> ID：14486065
> 
> 赞同：0
> 
> 时间：2013-01-23T17:47:31.503
> 
> 标签：matlab, fft

我想在matlab中使用*音乐算法*`GPR echo`估计信号的到达时间，我正在使用傅里叶变换的对偶性。

 *我首先对获得的信号应用 FFT，然后将这些作为参数传递给`pmusic`函数，我仍然在频域中得到结果。？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:47:20.197

**简短回答：**您在这里使用了错误的功能。

据我所知，[Matlab 的`pmusic`](http://www.mathworks.co.uk/help/signal/ref/pmusic.html)函数返回输入信号的[伪谱。](http://www.mathworks.co.uk/help/signal/ref/dspdata.pseudospectrum.html)

如果单击伪谱链接，您将看到信号的伪谱存在于频域中。特别是看情节：

**（来自 Matlab 的文档：Plotting Pseudospectrum Data）**

*请注意，结果在频域中。*

![伪谱结果](../Images/fbe313aff8cf9855f655543cba3febac.png)

假设 GPR 是指探地雷达，然后尝试使用雷达或声纳回波检测方法来估计双向传输时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-06T06:53:09.460

这是可以做到的，该理论已发表在多篇论文中。例如，请参见此处：

[DS-CDMA 系统中的 STAR 信道估计](http://skynet.ee.ic.ac.uk/projects/papers/2003_J_IEE_Com_STAR_Channel_Est_DSCDMA_Sys.pdf "DS-CDMA 系统中的 STAR 信道估计")

那篇论文描述了时空估计（即估计时间和到达方向），但如果你有一个单天线接收器，你可以忽略空间部分，只做时间估计。

您可能不想直接使用 Matlab 的 pmusic 函数。为自己编写这些函数总是更快更容易，所以你知道实际发生了什么。在音乐的情况下：

```
% Get noise subspace (where M is number of signals)
[E, D] = eig(Rxx);
[lambda, idx] = sort(diag(D), 'descend');
E = E(:, idx);
En = E(:,M+1:end);

% [Construct matrix S, whose columns are the vectors to search]

% Calculate MUSIC null spectrum and convert to dB
Z = 10*log10(sum(abs(S'*En).^2, 2)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-01T08:28:56.940

`Phased array system toolbox`如果您想使用单个命令使用不同的算法估计 DOA，您可以使用MATLAB。比如 Root MUSIC 就是`phased.RootMUSICEstimator` `phased.ESPRITEstimator`.

然而，正如 Harry 提到的很容易编写自己的函数，一旦定义了信号子空间和接收向量，就可以直接将它应用到 MUSIC 函数中以找到它的峰值。这是另一个很好的参考。

[http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=1143830](http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=1143830)*

# c# - 实施解决 并解决 > 在 ServiceStack 和 NinjectIocAdapter

> ID：14486066
> 
> 赞同：2
> 
> 时间：2013-01-23T17:47:35.300
> 
> 标签：c#, ninject, servicestack

嗨，我正在尝试为`ServiceStack`.

Ninject 有两种解析方法，get 和 getall。当您尝试解析以下列表时，应使用 GetAll：

```
Interface[] arrayOfInterfaces = _kernel.GetAll(typeof(Interface)) 
```

问题是这个和服务堆栈之间的不匹配。我想出了这个解决方案，但我对此并不满意。任何关于如何更好地实现这一点的帮助或想法将不胜感激。

```
 public T Resolve<T>()
    {
        if (typeof (Array).IsAssignableFrom(typeof (T)))
        {
            throw new NotSupportedException("Can not resolve array types, use IEnumerable");
        }

        if (typeof(T).IsGenericType && typeof(T).GetGenericTypeDefinition() == typeof(IEnumerable<>))
        {
            var elementType = typeof(T).GetGenericArguments()[0];

            var listOfTypes = Activator.CreateInstance(typeof(List<>).MakeGenericType(elementType)) as IList;

            foreach (var o in _kernel.GetAll(elementType))
            {
                listOfTypes.Add(o);
            }
            return (T)listOfTypes;
        }

        return _kernel.Get<T>();
    } 
```

而且目前它只支持`IEnumerable<T>`而不支持`T[]`

# php - PHP 随机文本 - 是否有更好、更简洁或服务器密集程度更低的解决方案？

> ID：14486070
> 
> 赞同：0
> 
> 时间：2013-01-23T17:47:42.533
> 
> 标签：php, javascript, jquery, ssi

PHP中的以下`random_text`功能可以用更好的方法完成吗，例如Javascript，jQuery，SSI等？我正在寻找一种渲染速度最快且在服务器上占用最少的方法，以加快页面加载速度。或者，PHP 是最好的方法吗？

```
$random_text = array("Random Text 1",
                "Random Text 2",
                "Random Text 3",
                "Random Text 4",
                "Random Text 5");

print_r($random_text[array_rand($random_text)]); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:50:04.447

在客户端使用 jQuery 执行此操作：

```
var result = random_text[Math.floor(Math.random()*random_text.length)]; 
```

# android - 推送选择失败：只读文件系统 - android sdcard

> ID：14486074
> 
> 赞同：3
> 
> 时间：2013-01-23T17:48:10.663
> 
> 标签：android, sd-card, android-sdcard

当我尝试将 mp3 添加到我的 sdcard 中时，我收到了这个错误

```
 [2013-01-23 22:49:52 - ddms] transfer error: Read-only file system
 [2013-01-23 22:49:52] Failed to push selection: Read-only file system 
```

有没有人告诉我是什么原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-02T18:46:40.747

解决了我同样的问题的是： 1\. 向 mainfest 添加必要的权限

```
 <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
 <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" /> 
```

1.  从 DDMS 的角度重新启动 adb

2.  重启日食。

# xcode - 在windows上写，在mac上编译

> ID：14486075
> 
> 赞同：-2
> 
> 时间：2013-01-23T17:48:17.420
> 
> 标签：xcode, windows, macos

> **可能重复：**
> [在 Windows 上为 Mac OS X 开发？](https://stackoverflow.com/questions/1288330/developing-for-mac-os-x-on-windows)

我的情况是这样的，我没有mac，但需要在xcode中为mac编写一个应用程序。

有没有办法在windows中编写和模拟代码，将项目保存在usb驱动器上，然后在一切OK的情况下在朋友的mac上编译最终的包？

谢谢伊戈尔

ps：该项目必须与 xcode 兼容，因此不能选择使用其他编码语言的任何其他应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:00:02.100

如果您没有 Mac，那么您可以尝试使用 vmware 在基于英特尔的 PC 上安装 mac osx。但是，您不会获得所有功能，但您的 xcode 会运行。

您可以做的第二件事是，通过 Team Viewer 分享您的朋友 mac os，但他不应该同时使用。

# security - 使用 Node.js 进行 Kerberos 身份验证

> ID：14486076
> 
> 赞同：3
> 
> 时间：2013-01-23T17:48:18.470
> 
> 标签：security, node.js, kerberos

我需要从我的 Node.js 应用程序访问仅支持 Kerberos 身份验证的服务 (RESTful)。Node中是否有任何模块可以做到这一点？

[Passport](http://passportjs.org/)是 Node.js 的流行身份验证模块，似乎没有针对 Kerberos 身份验证的策略。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-26T10:21:20.533

我使用本地策略作为默认策略。并使用 node-krb5 验证用户名和密码。可以的，你可以试试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T11:33:45.357

npm 注册表中的 kerberos 模块并不多，但目前看来这是一个更合理的选择：

[https://npmjs.org/package/kerberos](https://npmjs.org/package/kerberos)

我会将它与护照和本地策略一起使用作为默认值。

# php - 找不到放置目录路径的位置

> ID：14486077
> 
> 赞同：0
> 
> 时间：2013-01-23T17:48:19.213
> 
> 标签：php

```
function makeDirFromDate($path)
{
    $date = date('Y-m-d-H-i-s.u');

    if (!mkdir($path . '/' . $date, 0, TRUE))

        return FALSE;

    return TRUE
} 
```

每次刷新浏览器以创建另一个添加变量的文件夹时，都无法运行此脚本。因此，如果我转到 domain.com/script/testfolder/create_dir.php 并在名为 create_dir.php 的文件夹中运行此文件，它将在 testfolder 中创建另一个文件夹，其中包含当前年份、月份、日期、小时、分钟秒和微秒等。问题是我在破译我需要将 domain.com/script/testfolder/ 告诉它在那里创建文件夹的位置时遇到了麻烦。

所以确切的目录路径应该是 domain.com/script/testfolders/ 但无论我把它放在哪里（我已经尝试了下面的两个）都不起作用

```
makeDirFromDate('/domain.com/script/testfolders/');
mkdir("/domain.com/script/testfolders/$date") 
```

我已经把这两个替换了顶级函数，我还通过定义 $path = 将它放在了 $date 下，但似乎都不起作用。我究竟做错了什么？我在哪里放 /domain.com/script/testfolders/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:00:46.563

所以你想调用**domain.com/script/testfolder/create_dir.php**并想在同一个地方创建新文件夹，对吧？

试试这个，但要小心处理：

```
makeDirFromDate(dirname(__FILE__)); 
```

使用 .htaccess 或其他解决方案拒绝除您以外的任何人访问 create_dir.php。

# file - 如何更改 Visual Studio 2012 中的文件编码？

> ID：14486078
> 
> 赞同：0
> 
> 时间：2013-01-23T17:48:21.157
> 
> 标签：file, visual-studio-2012

我想更改 Visual Studio 2012 中的文件编码，有人知道怎么做吗？有没有可以自动执行此操作的扩展程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:55:04.707

据我了解，您想更改某些文件的字符编码。在这种情况下，您需要在“文件”菜单的“文件另存为”对话框中使用“高级保存选项”。您可以在此处阅读有关 VS2012 编码的更多信息：http: [//msdn.microsoft.com/en-us/library/dxfdkfke.aspx](http://msdn.microsoft.com/en-us/library/dxfdkfke.aspx)

# c++ - 在单个接口后面隐藏多个实现

> ID：14486080
> 
> 赞同：3
> 
> 时间：2013-01-23T17:48:31.347
> 
> 标签：c++, design-patterns, inheritance, cmake

我知道策略和抽象工厂设计模式——但是它们并不能解决我当前的问题：

我正在创建一个提供非常基本 GUI 的 C++ 库。但是我希望用户能够在编译时选择使用哪个 GUI 库（比如 Qt 或 FLTK）来实际呈现 GUI。然而，用户应该只需要了解我的库中的方法。

应该可以使用 Qt 后端或 FLTK 后端编译相同的代码而无需任何更改。

我想到了类似的东西：

```
class A
{
  // do things that are not specific to QT or FLTK here as there are many 
  // methods I will need independent of the backend
}

class QT_A : public A
{
  // Implement the actual creation of a window, display of a widget here using Qt
}

class FLTK_A : public A
{
  // Implement the actual creation of a window, display of a widget here using FLTK
} 
```

问题是我不希望用户知道`QT_A`or `FLTK_A`。用户（开发人员）应该只处理`A`. 另外，我不能同时拥有这两种变体，因为我不希望我的库同时依赖于 Qt 和 FLTK；只是在编译时选择的那个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T17:52:07.517

Pimpl 成语可能是另一种选择。它允许您创建一个不依赖于框架的成员的通用接口。

```
class A
{
  struct impl;
  std::unique_ptr<impl> pimpl; // or scoped_ptr/auto_ptr on non-C++11
public:
  A();
  ~A();
 void do_sth();
}; 
```

然后，源文件可以根据后端提供不同的 impl 实现。

```
#ifdef QT
struct A::impl : QWidget { // Make it polymorphic, if you need
  QImage img;
  QString data;
};

void A::do_sth()
{
  impl->make_it(); // full access to the Qt things
}

A::A()
  : pimpl(new ...)
{
}

A::~A() {} // no need for delete thanks the smart pointer

#endif 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T17:59:17.437

一个选项是另一个答案中描述的 Pimpl 成语。

另一种选择是工厂返回指向接口类的指针：

```
std::unique_ptr<A> make_A()
{
#if defined(USING_QT)
    return std::unique_ptr<A>(new QT_A(...));
#elif defined(USING_FLTK)
    return std::unique_ptr<A>(new FLTK_A(...));
#else
    #error "No GUI library chosen"
#endif
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-23T18:12:12.590

不需要花哨的图案。

你分发

1.  A的标题；
2.  一个包含`A`、`QT_A`和`make_A`函数的库；
3.  另一个包含 的库`A`，`FLTK_A`以及另一个`make_A`函数实现。

用户链接到任一库。

# html - 无法获得适用于 MS Outlook 的 CSS 宽度

> ID：14486081
> 
> 赞同：1
> 
> 时间：2013-01-23T17:48:31.720
> 
> 标签：html, css, outlook

我希望段落中的文本宽度为 100 像素。

我尝试：

```
<p style="width:120px">This is some text in a paragraph. This is some text in a paragraph.
This is some text in a paragraph. This is some text in a paragraph.
This is some text in a paragraph. This is some text in a paragraph.</p> 
```

Outlook 忽略宽度。

知道如何让宽度在 Outlook 中工作吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T17:50:19.440

尝试旧学校版本

```
<p width="120"> 
```

对于电子邮件客户端，最好使用您通常不会看到的所有已弃用的属性。甚至更好 - 使用表格。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T12:08:22.203

我可以让它工作的唯一方法是将文本放在表格中并设置表格的宽度。

# performance - Cassandra 原生二进制协议性能

> ID：14486084
> 
> 赞同：6
> 
> 时间：2013-01-23T17:48:36.613
> 
> 标签：performance, binary, cassandra, native, thrift

我目前正在计划将一个相当大的 MongoDB 部署（大约 25 个大型服务器分布在几个数据中心）迁移到 Cassandra。我看到 Cassandra 1.2 采用了一个相对较新的原生二进制协议，似乎这就是该项目的未来。当我读到它时它看起来不错，但我最近一直在针对一个简单的基于 Thrift 的客户端对其进行测试，并且 Thrift 客户端在每次测试中都大大优于它。我的问题是本机二进制协议/客户端在什么情况下胜过 Thrift，是否有人在生产中使用它？

这是一个示例基准：

```
本地 3 节点集群（使用 ccm 创建），有 10 个客户端线程向其发送垃圾邮件
总吞吐量（写入、读取）[5 分钟内的总操作数]：
二进制：3,316,725.0 2,179,193.0
节俭：7,310,482.0 2,872,528.0

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T20:54:29.953

当您将现有客户端用作 Astyanax 或 Hector 时，不使用二进制协议。你可以看看[java-driver](https://github.com/datastax/java-driver)。它尚未发布，但据我测试，它工作正常。

# r - 当我设置 x 和 y 限制时，ggplot 会删除我的所有数据

> ID：14486086
> 
> 赞同：2
> 
> 时间：2013-01-23T17:48:41.253
> 
> 标签：r, ggplot2

我正在使用 R 从表中生成图。

我使用了该命令`a <- read.table("table.txt")`，并且效果很好。当我输入“a”时，它会正确打印出我的完整表格。

我也进入了`library(ggplot2)`，所以我可以使用 ggplot。

这是我的第一个命令：

```
ggplot(a, aes(x=V2, y=V5, group=V7)) + 
   geom_point(size=4, aes(col=V7)) + xlab("Rank") + 
   ylab("Inter-helix angle (Degree)") + 
   opts(legend.position="none") 
```

这个命令生成了所有的点，但是当我添加`xlim(0,110) + ylim(0,110)`到最后时，它给了我一个警告并说“删除了包含缺失值的 101 行”（我的表有 101 行长）。生成的地块完全是空的。发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T17:59:30.603

我猜您的数据可能超出了您指定的范围`xlim`，`ylim`例如：

```
 library(ggplot2)
 df <- data.frame(x=1:10,y=1:10)
 ggplot(a, aes(x=x, y=y)) + 
 geom_point(size=4) + xlab("Rank") + 
 ylab("Inter-helix angle (Degree)") 
```

工作正常，但是：

```
 ggplot(df, aes(x=x, y=y)) + 
 geom_point(size=4) + xlab("Rank") + 
 ylab("Inter-helix angle (Degree)") + xlim(0,0.1) + ylim(0,0.1) 
```

给出与您得到的相同的错误，因为没有值介于`0`和之间`0.1`

> 警告消息：删除了 10 行包含缺失值 (geom_point)。

尽管没有您的数据，这只是最有可能的答案。顺便说一句，一般人倾向于使用`coord_cartesian`：

```
ggplot(df, aes(x=x, y=y)) + 
 geom_point(size=4) + xlab("Rank") + 
 ylab("Inter-helix angle (Degree)") + coord_cartesian(xlim=c(0,0.1)) + 
coord_cartesian(ylim=c(0,0.1)) 
```

# c# - 如何重构此属性的代码？C＃

> ID：14486089
> 
> 赞同：-1
> 
> 时间：2013-01-23T17:48:46.493
> 
> 标签：c#, asp.net, asp.net-mvc-3, refactoring

我有一个视图模型，其属性代表年和月：

```
public IEnumerable<SelectListItem> Years
    {
        get
        {
            return new SelectList(
                Enumerable.Range(1900, 112)
                .OrderByDescending(year => year)
                .Select(year => new SelectListItem
                {
                    Value = year.ToString(CultureInfo.InvariantCulture),
                    Text = year.ToString(CultureInfo.InvariantCulture)
                }
            ), "Value", "Text");
        }
    }

    public IEnumerable<SelectListItem> Months
    {
        get
        {
            return new SelectList(
                Enumerable.Range(1, 12)
                .OrderByDescending(month => month)
                .Select(month => new SelectListItem
                {
                    Value = month.ToString(CultureInfo.InvariantCulture),
                    Text = month < 10 ? string.Format("0{0}", month) : month.ToString(CultureInfo.InvariantCulture)
                }
            ), "Value", "Text");
        }
    } 
```

绝对我在这里使用复制和粘贴方法）我如何重构这段代码？Mabby 以某种方式将数字作为参数传递给某个辅助方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:56:17.193

只是大声思考，但这里的共同部分是“获取一系列值，对它们进行排序，并将每个值包装在一个包装器对象中，其文本值为（如何获取文本）”。也就是说，您可以执行以下操作：

```
private IEnumerable<SelectListItem> GetXXXX(
       int start, 
       int count, 
       Func<int,string> nameGetter)
{
    return Enumerable
        .Range(start, count)
        .OrderByDescending (i => i)
        .Select(i => 
            new SelectListItem() 
            { 
                Value = i.ToString(CultureInfo.InvariantCulture),
                Text = nameGetter(i)
            });
} 
```

例如，您的“月份”将是：

```
public IEnumerable<SelectListItem> Months
{
    get 
    { 
        return GetXXXX(1, 12, m => 
              m < 10 
                ? string.Format("0{0}", m) 
                : m.ToString(CultureInfo.InvariantCulture));
    }
} 
```

# javascript - 固定容器内子 div 中的滚动条

> ID：14486091
> 
> 赞同：2
> 
> 时间：2013-01-23T17:48:49.327
> 
> 标签：javascript, jquery, css

我有一个相当长的导航（`.nav-main`）作为固定标题（`header`）内的子 div。当通过 jQuery 显示导航时`.toggle()`，内容比窗口长，因此不会滚动。我试图弄清楚如何将滚动条（最好在 CSS 中）应用于固定导航中的子 div：

```
 <header class="clearfix">

                <nav class="nav-main">
                    <button>Open Topics</button>
                    <ul>
                        <li><a href="">Section 1</a></li>
                        <li><a href="">Section 2</a></li>
                        <li><a href="">Section 3</a></li>
                        <li><a href="">Section 4</a></li>
                        <li><a href="">Section 5</a></li>
                        <li><a href="">Section 6</a></li>
                        <li><a href="">Section 7</a></li>
                        <li><a href="">Section 8</a></li>
                        <li><a href="">Section 9</a></li>
                        <li><a href="">Section 10</a></li>
                        <li><a href="">Section 11</a></li>
                        <li><a href="">Section 12</a></li>
                        <li><a href="">Section 13</a></li>
                        <li><a href="">Section 14</a></li>
                        <li><a href="">Section 15</a></li>
                        <li><a href="">Section 16</a></li>
                        <li><a href="">Section 17</a></li>
                        <li><a href="">Section 18</a></li>
                        <li><a href="">Section 19</a></li>
                        <li><a href="">Section 20</a></li>
                    </ul>
                </nav><!--end nav-main-->
</header>

<div id="main">
    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
</div><!--end main--> 
```

SCSS/CSS：

```
header{

    background-color: #ccc;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;

    .head-wrap{
        position: relative;
        height: 50px;
    }

    .nav-main{

        position: relative;

        button{
            float: right;
            margin-top: 10px;
            margin-right: 70px;
            background-color: pink;
        }

        ul{
            display: none;
            background-color: #333;
            top: 50px;
            position: absolute;
            width: 100%;
            z-index: 2;
            overflow: auto;

            li{
                background-color: #333;

                a{
                    color: #fff;
                    text-decoration: none;
                    padding:10px 50px;
                    display: block;
                }
            }
        }
    }
}

#main{
    margin-top: 50px;

    p{
        margin-bottom: 20px;
    }
} 
```

还有我的`.toggle()`JS：

```
$(".nav-main button").click(function(event){
        $(".nav-main ul").toggle();
        event.preventDefault();
}); 
```

这是一个小提琴。请将窗口缩小到足够小，以便通过单击 显示导航时`button`，内容被切断，需要滚动条：

[http://jsfiddle.net/HAUcU/1/](http://jsfiddle.net/HAUcU/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:59:23.240

您需要为`height`.nav-menu ul 元素设置一个属性。这可以静态设置或使用脚本根据窗口高度进行设置。

[JSFiddle](http://jsfiddle.net/bfelda/HAUcU/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:01:45.247

在 div 上设置高度并溢出：滚动。

# git - github 按计划从 origin master 合并

> ID：14486092
> 
> 赞同：0
> 
> 时间：2013-01-23T17:48:50.940
> 
> 标签：git, github, branching-and-merging

我们的一些开发人员拥有多个独立的存储库。我们希望他们为错误修复和增强而创建的分支每天早上从原始主机获取更新，自动合并，并在有任何冲突时通知。

我认为命令是

```
git merge [branchname] 
```

但我希望开发人员拥有的每个回购都发生这种情况，并且每天早上自动发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:47:35.563

我们决定只有在发布后才让开发人员从 origin master 获取更新。在考虑了这个想法之后，我们同意每天获取更新不是一个好主意，甚至不是必要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T04:36:59.813

我不能足够强烈地声明，该线程中的每条评论和您自己的自我回答最终都会给您带来麻烦。我并不想踩任何人的脚趾，但在我终于学会如何正确地做到这一点之前，这已经咬了我很多次。任何人如果在没有首先测试自己的代码是否与父存储库的当前状态冲突的情况下向大多数组织发出拉取请求，就会发现自己很快就会失业。

任何现代开发团队的最佳实践通常应该这样进行：

1.  Coder 从主存储库中分叉代码
2.  Coder 添加一个上游远程以将主存储库的更改拉入他自己的主分支。
3.  Coder 立即在他自己的 fork 中创建了一个新的功能/错误/修补程序分支，以拥有一个原始的工作环境来做他的事情。
4.  无论是定期还是在发出任何拉取请求之前，Coder 都会将任何上游更改拉取到他自己 fork 的主分支。
5.  Coder 使用他的新功能/错误/修补程序修复了对主存储库的更改导致的任何冲突。
6.  Coder 向主存储库发出拉取请求。

如果您似乎无法掌握工作流的基本概念，请找 gitflow 之类的东西来为您完成繁重的工作，您将永远不会回头。如果您遵循这些原则，那么与您共享代码的人将非常感激。

# c# - 如何将整个文件夹添加到 zip 存档

> ID：14486093
> 
> 赞同：3
> 
> 时间：2013-01-23T17:48:50.447
> 
> 标签：c#, dotnetzip

我试过了`zip.AddDirectory`，但我不知道如何将***整个文件夹***导入存档（使用`DotNetZip`）。

我**不**想要这个：

![在此处输入图像描述](../Images/b0d082c7fb3dbe24d51f27ed0cb4d60d.png)

但是这个：

![在此处输入图像描述](../Images/95cb7c49d0f6bb128b5c2b60e96d8d22.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T18:22:56.547

来自[DotNetZip 源代码示例](http://dotnetzip.codeplex.com/wikipage?title=CS-Examples)：

重新映射目录。压缩一组文件和目录，并将它们重新映射到 zip 文件中的不同目录层次结构中：

```
using (ZipFile zip = new ZipFile())
{
    // files in the filesystem like MyDocuments\ProjectX\File1.txt , will be stored in the zip archive as  backup\File1.txt
    zip.AddDirectory(@"MyDocuments\ProjectX", "backup");
    // files in the filesystem like MyMusic\Santana\OyeComoVa.mp3, will be stored in the zip archive as  tunes\Santana\OyeComoVa.mp3
    zip.AddDirectory("MyMusic", "tunes");
    // The Readme.txt file in the filesystem will be stored in the zip archive as documents\Readme.txt
    zip.AddDirectory("Readme.txt", "documents");
    zip.Comment = "This zip was created at " + System.DateTime.Now.ToString("G") ; 
    zip.Save(ZipFileToCreate);
} 
```

# c# - 您应该在类中引用属性还是成员变量？

> ID：14486101
> 
> 赞同：5
> 
> 时间：2013-01-23T17:49:22.340
> 
> 标签：c#, .net-4.0, properties

> **可能重复：**
> [您是否应该通过属性访问同一类中的变量？](https://stackoverflow.com/questions/271318/should-you-access-a-variable-within-the-same-class-via-a-property)

我最近遇到了这个问题，我很好奇是否有某种标准，你应该在课堂上参考哪个标准。

我的意思是，无论您是直接访问成员变量还是通过属性（除非您需要避开一些自定义设置器代码），这都不应该有所不同，但我想确保没有最佳实践。

```
partial class MyClass {
    private string foo;

    internal string Foo {
        get {
            return foo;
        }

        private set {
            foo=value;
            // I do other stuff
        }
    }

    public void DoSomething() {
        //Option 1;
        Foo="some string";

        //Option 2;
        foo="some string";
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:03:59.453

这不应该是你真正做出的选择。setter 中的代码应该运行，在这种情况下使用属性，或者不应该运行，在这种情况下使用成员变量。在大多数情况下，一种是对的，一种是错的。在一般情况下，两者都不总是对/错，而且“无关紧要”是不寻常的。

例如，如果 setter 代码正在触发“已更改”事件，您是否希望通知外部对象它已更改？如果您要更改它以响应先前的更改，可能不会（无限递归任何人？）如果不是，您可能希望确保它被触发（这样您就不会更改值并且不会通知任何人更改）。

如果只是验证设置的值是否有效，那么您要么知道，在这种情况下，该值已经验证并且必须有效，在这种情况下无需再次验证；设置属性。如果您尚未验证要设置的内容，那么您*希望*验证逻辑运行，因此请使用该属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T17:54:52.233

这个问题有很多争论，所以这个问题没有明显的答案。

就我个人而言，我更喜欢通过该属性进行访问，因为其中可能包含一些验证或转换代码。即使您的 getter 和 setter 微不足道，它们也可能在未来发生变化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T18:01:50.000

如果您将字段包装`foo`在 property`Foo`中，您可能是出于某种原因（转换、事件、验证等）这样做的。因此，一般来说，您应该引用该字段的唯一位置`foo`是在 property 的 getter 和 setter 中`Foo`。其余代码应引用该属性`Foo`。

我确信存在一些模糊的情况，您需要绕过属性的 getter 和 setter，这当然可以，但这种情况将是规则的例外。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T18:26:59.670

如果设置器没有逻辑，则显式声明私有变量没有意义，最好使用自动实现的属性：

```
 internal string Foo
    {
        get;
        private set;
    }

    public void DoSomething()
    {
        this.Foo = "some string";
    } 
```

如果 setter 有逻辑，那么私有变量只能在 setter 中使用，绝不能在 setter 之外修改。在任何情况下（在我看来:)）私有变量不应该出现在属性设置器旁边的任何其他地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T17:59:39.080

我会选择选项 1。如果您要设置变量，则应该使用该属性而不是直接访问该变量。这是因为该属性具有您用“// 我做其他事情”指示的额外代码。您不希望仅仅因为您没有设置属性而重复这个“其他事情”......除非您不想在这次设置它时做“其他事情”。

老实说，这只是一个理论上的情况，如果你给出一个遇到这个问题的实际情况，答案会容易得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-23T17:52:54.483

**选项 1**是很好的做法。因为如果你使用**Option 2**，你会在设置 foo 值时丢失其他东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-23T18:31:53.440

想象一下这样的代码

```
public partial class HybridPanel: Panel {
    [DefaultValue(BorderStyle.FixedSingle)]
    public virtual new BorderStyle BorderStyle {
        set {
            if(value!=borderStyle) {
                borderStyle=value;
                base.PerformLayout();
            }
        }

        get {
            try {
                return borderStyle;
            }
            finally {
                if(borderStyle!=base.BorderStyle)
                    base.PerformLayout();
            }
        }
    }

    BorderStyle borderStyle=BorderStyle.FixedSingle;
    bool isCollapsed, isAutoSize;
} 
```

在这种情况下，属性不仅用作*变量*，还可以做其他事情。访问同一类中的属性**不**被认为是一种不好的做法，此外，编译器会建议：

仅用于访问字段而不传递参数的方法，请考虑将其定义为属性。

顺便说一句，您可以将*访问成员变量目录*的描述更正为直接访问成员变量（即使用字段访问）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-23T18:19:38.143

使用 INotifyPropertyChanged 接口时，如果您希望更新绑定对象，则必须使用属性。

# sql - 用单词转换任何数字

> ID：14486108
> 
> 赞同：1
> 
> 时间：2013-01-23T17:49:42.450
> 
> 标签：sql, sql-server, sql-server-2005

是否有任何查询或功能可以将任何不转换为单词。喜欢 1001 到 1001 等。我使用的是 sql server 2005。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-23T17:57:44.890

嗨，试试下面的过程......它给出了你需要的输出......

程序 ：

```
CREATE FUNCTION fnNumberToWords(@Number as BIGINT)

    RETURNS VARCHAR(1024)

AS

BEGIN

      DECLARE @Below20 TABLE (ID int identity(0,1), Word varchar(32))

      DECLARE @Below100 TABLE (ID int identity(2,1), Word varchar(32))

      INSERT @Below20 (Word) VALUES

                        ( 'Zero'), ('One'),( 'Two' ), ( 'Three'),

                        ( 'Four' ), ( 'Five' ), ( 'Six' ), ( 'Seven' ),

                        ( 'Eight'), ( 'Nine'), ( 'Ten'), ( 'Eleven' ),

                        ( 'Twelve' ), ( 'Thirteen' ), ( 'Fourteen'),

                        ( 'Fifteen' ), ('Sixteen' ), ( 'Seventeen'),

                        ('Eighteen' ), ( 'Nineteen' )

       INSERT @Below100 VALUES ('Twenty'), ('Thirty'),('Forty'), ('Fifty'),

                               ('Sixty'), ('Seventy'), ('Eighty'), ('Ninety')

DECLARE @English varchar(1024) =

(

  SELECT Case

    WHEN @Number = 0 THEN  ''

    WHEN @Number BETWEEN 1 AND 19

      THEN (SELECT Word FROM @Below20 WHERE ID=@Number)

   WHEN @Number BETWEEN 20 AND 99  

     THEN  (SELECT Word FROM @Below100 WHERE ID=@Number/10)+ '-' +

           dbo.fnNumberToWords( @Number % 10)

   WHEN @Number BETWEEN 100 AND 999  

     THEN  (dbo.fnNumberToWords( @Number / 100))+' Hundred '+

         dbo.fnNumberToWords( @Number % 100)

   WHEN @Number BETWEEN 1000 AND 999999  

     THEN  (dbo.fnNumberToWords( @Number / 1000))+' Thousand '+

         dbo.fnNumberToWords( @Number % 1000) 

   WHEN @Number BETWEEN 1000000 AND 999999999  

     THEN  (dbo.fnNumberToWords( @Number / 1000000))+' Million '+

         dbo.fnNumberToWords( @Number % 1000000)

   WHEN @Number BETWEEN 1000000000 AND 999999999999  

     THEN  (dbo.fnNumberToWords( @Number / 1000000000))+' Billion '+

         dbo.fnNumberToWords( @Number % 1000000000)

   WHEN @Number BETWEEN 1000000000000 AND 999999999999999  

     THEN  (dbo.fnNumberToWords( @Number / 1000000000000))+' Trillion '+

         dbo.fnNumberToWords( @Number % 1000000000000)

  WHEN @Number BETWEEN 1000000000000000 AND 999999999999999999  

     THEN  (dbo.fnNumberToWords( @Number / 1000000000000000))+' Quadrillion '+

         dbo.fnNumberToWords( @Number % 1000000000000000)

  WHEN @Number BETWEEN 1000000000000000000 AND 999999999999999999999  

     THEN  (dbo.fnNumberToWords( @Number / 1000000000000000000))+' Quintillion '+

         dbo.fnNumberToWords( @Number % 1000000000000000000)

        ELSE ' INVALID INPUT' END

)

SELECT @English = RTRIM(@English)

SELECT @English = RTRIM(LEFT(@English,len(@English)-1))

                 WHERE RIGHT(@English,1)='-'

RETURN (@English)

END

GO 
```

**测试查询......**

```
SELECT NumberInEnglish=dbo.fnNumberToWords ( 18)

SELECT NumberInEnglish=dbo.fnNumberToWords ( 67)

SELECT NumberInEnglish=dbo.fnNumberToWords ( 947)

-- Nine Hundred Forty-Seven

SELECT NumberInEnglish=dbo.fnNumberToWords ( 984261)

-- Nine Hundred Eighty-Four Thousand Two Hundred Sixty-One

SELECT NumberInEnglish=dbo.fnNumberToWords ( 777999888)

/* Seven Hundred Seventy-Seven Million Nine Hundred Ninety-Nine Thousand

   Eight Hundred Eighty-Eight */

SELECT NumberInEnglish=dbo.fnNumberToWords ( 222777999888)

SELECT NumberInEnglish=dbo.fnNumberToWords ( 555222777999888)

SELECT NumberInEnglish=dbo.fnNumberToWords ( 7446744073709551616) 
```

来源：[http ://www.sqlusa.com/bestpractices2008/number-to-words/](http://www.sqlusa.com/bestpractices2008/number-to-words/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-23T18:02:25.803

你可以试试这个它在oracle中工作：

```
 select to_char(to_date(:number,'j'),'jsp') from dual; 
```

或[在此处](http://www.sqlservercentral.com/Forums/Topic794134-149-1.aspx#bm794177)查看详细链接，了解如何操作

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-23T17:55:25.050

没有这样的查询。您需要创建自己的程序，然后才能使用它。

# c# - c# windows 窗体多线程从另一个类事件更新窗体控件

> ID：14486109
> 
> 赞同：0
> 
> 时间：2013-01-23T17:49:45.820
> 
> 标签：c#, winforms, multithreading, event-handling

`onrecvdChanged`是一个事件（服务器类）一旦发生我希望它改变 form1 类的 label1 的文本。我已经被困在这里很长时间了。我尝试了一些技巧，但我得到了一个跨线程异常。

```
namespace TCPServerTutorial
{
    public partial class Form1 : Form
    {
        Server a;
        public Form1()
        {
            InitializeComponent();
            label1.Text = "Ready";
            a=new Server(this);
        }
        private void Start_btn_Click(object sender, EventArgs e)
        {
            a.StartTcpServer();
            label1.Text = "Listening...";
        }

        private void Stop_Btn_Click(object sender, EventArgs e)
        {
            a.StopListenForClients();
            label1.Text = "Stopped...";
        }
    }

    class Server
    {
        public event EventHandler recvdChanged;
        private TcpListener tcpListener;
        private Thread listenThread;
        private string recvd;
        Form1 _f1parent;
        public Server(Form1 par)
        {
            _f1parent = par;
        }
        public string getsetrecvd
        {
            get { return this.recvd; }
            set
            {
                this.recvd = value;
                if (this.recvdChanged != null)
                    this.recvdChanged(this, new EventArgs());
            }
        }
        public void StartTcpServer()
        {
            this.tcpListener = new TcpListener(IPAddress.Any, 3000);
            this.listenThread = new Thread(new ThreadStart(ListenForClients));
            this.listenThread.Start();
        }
        private void ListenForClients()
        {
            this.tcpListener.Start();

            while (true)
            {
                //blocks until a client has connected to the server
                TcpClient client = this.tcpListener.AcceptTcpClient();
                if(client.Connected)
                {
                    MessageBox.Show(client.Client.RemoteEndPoint + " Has Connected.");
                }

                //create a thread to handle communication 
                //with connected client
                Thread clientThread = new Thread(new ParameterizedThreadStart(HandleClientComm));
                clientThread.Start(client);
            }
        }
        public void StopListenForClients()
        {
            tcpListener.Stop();
        }
        private void HandleClientComm(object client)
        {
            TcpClient tcpClient = (TcpClient)client;
            NetworkStream clientStream = tcpClient.GetStream();
            recvdChanged += new EventHandler(onrecvdChanged);
            byte[] message = new byte[4096];
            int bytesRead;
            Form1 p = new Form1();
            while (true)
            {
                bytesRead = 0;

                try
                {
                    //blocks until a client sends a message
                    bytesRead = clientStream.Read(message, 0, 4096);
                }
                catch
                {
                    //a socket error has occured
                    break;
                }

                if (bytesRead == 0)
                {
                    //the client has disconnected from the server
                    break;
                }

                //message has successfully been received
                ASCIIEncoding encoder = new ASCIIEncoding();
                getsetrecvd=encoder.GetString(message, 0, bytesRead);
                if (recvd != "e")
                {
                }
                else
                {
                    break;
                }
            }

            tcpClient.Close();
        }
        void onrecvdChanged(object sender, EventArgs e)
        {
            MessageBox.Show("event: " + recvd);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:57:03.837

您已经有一个在字符串更改时触发的事件，`recvdChanged`. 只需让表单向该事件添加事件处理程序，然后调用 UI 线程：

```
public Form1()
{
    InitializeComponent();
    label1.Text = "Ready";
    a=new Server(this);
    a.recvdChanged += (_,args) => Invoke(new MethodInvoker(
        ()=>label1.Text = a.getsetrecvd));
} 
```

`Server`类本身内部不需要该事件的事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:06:15.317

跨线程异常通常通过使用 Invoke 来修复。

我发现最简单的方法是使用 MethodInvoker 强制转换和 Lambda 表达式......类似于：

```
Invoke((MethodInvoker)( () => Form1.Label1.Text = "some string" ) ); 
```

# javascript - 如何检查 Javascript 类是否继承了另一个（不创建 obj）？

> ID：14486110
> 
> 赞同：90
> 
> 时间：2013-01-23T17:49:47.563
> 
> 标签：javascript, class, inheritance

例如：

```
function A(){}
function B(){}
B.prototype = new A(); 
```

如何检查 B 类是否继承 A 类？

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2013-01-23T17:52:29.940

尝试以下操作：

```
ChildClass.prototype instanceof ParentClass 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2013-01-23T17:50:31.650

您可以测试直接继承

```
B.prototype.constructor === A 
```

要测试间接继承，您可以使用：

```
B.prototype instanceof A 
```

*（这第二个解决方案首先由 Nirvana Tikku 给出）*

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2017-08-13T20:14:22.287

回到 2017 年：
检查这是否适合你

```
ParentClass.isPrototypeOf(ChildClass) 
```

如果您想要防止阴影，则可以选择：

```
const isPrototypeOf = Function.call.bind(Object.prototype.isPrototypeOf);

// Usage:
isPrototypeOf(ParentClass, ChildClass); // true or false 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-08-13T04:06:41.410

**陷阱：**请注意，`instanceof`如果您使用多个执行上下文/窗口，则无法按预期工作。见[§§](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/instanceof#instanceof_and_multiple_context_(e.g._frames_or_windows))。

* * *

此外，根据[https://johnresig.com/blog/objectgetprototypeof/](https://johnresig.com/blog/objectgetprototypeof/)，这是与以下内容相同的替代实现`instanceof`：

```
function f(_, C) { // instanceof Polyfill
  while (_ != null) {
    if (_ == C.prototype)
      return true;
    _ = _.__proto__;
  }
  return false;
} 
```

修改它以直接检查类给我们：

```
function f(ChildClass, ParentClass) {
  _ = ChildClass.prototype;
  while (_ != null) {
    if (_ == C.prototype)
      return true;
    _ = _.__proto__;
  }
  return false;
} 
```

* * *

**边注**

`instanceof`本身检查是否`obj.proto`为`f.prototype`，因此：

```
function A(){};
A.prototype = Array.prototype;
[]instanceof Array // true 
```

和：

```
function A(){}
_ = new A();
// then change prototype:
A.prototype = [];
/*false:*/ _ instanceof A
// then change back:
A.prototype = _.__proto__
_ instanceof A //true 
```

和：

```
function A(){}; function B(){};
B.prototype=Object.prototype;
/*true:*/ new A()instanceof B 
```

如果不相等，则在检查中将 proto 与 proto 的 proto 交换，然后将 proto 的 proto 的 proto 交换，以此类推。因此：

```
function A(){}; _ = new A()
_.__proto__.__proto__ = Array.prototype
g instanceof Array //true 
```

和：

```
function A(){}
A.prototype.__proto__ = Array.prototype
g instanceof Array //true 
```

和：

```
f=()=>{};
f.prototype=Element.prototype
document.documentElement instanceof f //true
document.documentElement.__proto__.__proto__=[];
document.documentElement instanceof f //false 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-10-10T16:49:27.523

我不认为 Simon`B.prototype = new A()`在他的问题中的意思，因为这肯定不是在 JavaScript 中链接原型的方式。

假设 B 扩展 A，使用`Object.prototype.isPrototypeOf.call(A.prototype, B.prototype)`

# ruby-on-rails - 如何用 \n 字符替换新行

> ID：14486111
> 
> 赞同：2
> 
> 时间：2013-01-23T17:49:49.340
> 
> 标签：ruby-on-rails, ruby

存储在数据库中的数据是这样的：

```
This is a line

This is another line

How about this line 
```

当我将其输出到视图时，我想将其转换为：

```
This is a line\n\nThis is another line\n\nHow about this line 
```

没有新行并且`\n`打印出实际字符。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T17:56:09.287

```
> s = "hi\nthere"
> puts s
hi
there
> puts s.gsub(/\n/, "\\n")
hi\nthere 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T19:05:54.997

`gsub`如果您只想专门转换换行符，我会亲自使用。但是，如果您想普遍检查字符串的内容，请执行以下操作：

```
str = "This is a line\n\nThis is another line\n\nHow about this line"
puts str.inspect[1..-2]
#=> This is a line\n\nThis is another line\n\nHow about this line 
```

该`String#inspect`方法转义字符串中的各种“控制”字符。它还用`"`我在上面剥离的字符串包裹了字符串。请注意，这可能会产生不希望的结果，例如字符串`My name is "Phrogz"`将作为`My name is \"Phrogz\"`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T17:56:05.947

```
> s = "line 1\n\nline2"
 => "line 1\n\nline2"  

> puts s
line 1

line2

> puts s.gsub("\n", "\\n")
line 1\n\nline2 
```

关键是[转义单个反斜杠](http://en.wikibooks.org/wiki/Ruby_Programming/Strings#Escape_sequences)。

# php - 如何使用 composer 安装部分 git 存储库？

> ID：14486112
> 
> 赞同：10
> 
> 时间：2013-01-23T17:49:50.233
> 
> 标签：php, git, github, composer-php

我只想需要一个 git 存储库的子部分（而不是完整的东西）。我想这样做的原因是因为存储库很大。

在我的情况下，存储库是：[https](https://github.com/pubnub/pubnub-api.git) ://github.com/pubnub/pubnub-api.git我只想要 /php 目录。

我在作曲家中定义了以下包：

```
 {
            "type": "package",
            "package": {
                "name": "pubnub",
                "version": "dev-master",
                "source" : {
                    "url": "https://github.com/pubnub/pubnub-api.git",
                    "type": "git",
                    "reference":"master"
                }
            }
    }, 
```

有小费吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-10-10T19:37:05.863

给出[“有没有办法只克隆 git 存储库的子目录？”的答案？](https://stackoverflow.com/questions/600079/is-there-any-way-to-clone-a-git-repositorys-sub-directory-only)是[“否”](https://stackoverflow.com/a/600189/1114274)，并且作曲家需要子目录签出功能来满足所需的功能，那么我建议作曲家可以做的最好的事情是签出整个内容，然后删除你不想要的内容。

简而言之：不可能。

更长的答案是：git 可以进行[稀疏结帐](https://stackoverflow.com/a/13738951/1114274)，因此理论上作曲家有朝一日可以支持该功能。您可以使用[自动加载](http://getcomposer.org/doc/04-schema.md#autoload)字段仅加载您想要的代码部分（即，不加载整个库）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-10T08:05:25.513

似乎 php 目录已移至此处[https://github.com/pubnub/php](https://github.com/pubnub/php)的自己的存储库中。这可能对这个项目有所帮助，但不知道如何从主仓库和作曲家实现这一目标......

# domain-driven-design - 关于将非根实体的引用传递给外部对象的一些令人困惑的事情

> ID：14486115
> 
> 赞同：5
> 
> 时间：2013-01-23T17:50:02.793
> 
> 标签：domain-driven-design

*根实体*可以将*内部实体的临时引用*传递给*外部对象*，但在操作完成后*外部对象*不保留该引用的情况下

1)

a）为什么在单个操作期间具有引用（对*内部实体）的**外部对象*是可以接受的，但在两个操作期间保持该引用是不可接受的？我的观点是，如果在两次操作期间坚持参考是不好的，那么在一次操作期间坚持参考可能同样不好？！

 *b）假设`SomeRootEnt` *聚合根*将*内部实体的瞬时引用* `SomeIntEnt`传递给*外部对象，**外部*对象应该如何请求`SomeIntEnt`？*通过在根*上调用特定方法- 例如`SomeRootEnt.BorrowMeIntEnt(...)`- 或者*根*应该直接将*内部实体*公开为其*属性*（例如`SomeRootEnt.SomeIntEnt`）？

2)

a) 假设`SomeRootEnt` *root将对**内部实体* 的引用传递`SomeIntEnt` 给*外部对象*，而后者又对 进行一些修改`SomeIntEnt`，那么这是否意味着*root*无法对这些修改应用适当的*不变逻辑*（即*root*无法检查修改的完整性`SomeIntEnt`？

b) 同样，至少在我的理解中，*root*也没有办法在完成单个操作后强制*外部对象*删除对*内部实体的引用？*

谢谢

**更新：**

2a)

> 这是正确的，这就是为什么最好确保传递的对象不被修改，而是以不可变的方式使用。此外，通过的实体仍然可以自行保持一定程度的完整性。

是否主要由*Aggregate root*（部分由传递的*entity*）或*外部对象*（接收*瞬态引用*）负责确保传递的*实体*不被修改？*如果是后者，那么这个蕴的一致性真的不是由开发外在对象*的人摆布吗？

2b)

> 正确，您有责任确保这一点。就像您必须确保给定值对象是不可变的（如果需要），您必须考虑传递引用的完整性。

我认为在大多数情况下，一旦操作完成，*外部对象*就有责任摆脱引用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:34:20.377

1a) 可能需要对实体的引用来支持域操作，但是该引用应该是暂时的，因为它在操作之后不会保留。它只在操作期间保持，而不是在它之后，因此它不能通过归纳得出它可以保持两个操作。这样做的目的是确保将引用传递给外部实体的聚合可以保持对其成分的控制。您不希望其内部实体被其他聚合接管，因为这样就更难以推理行为。

1b）它可以采用任何一种方式，具体取决于用例。属性只是变相的方法。

2a）这是正确的，这就是为什么最好确保传递的对象不被修改，而是以不可变的方式使用。此外，通过的实体仍然可以自行保持一定程度的完整性。

2b) 正确，您有责任确保这一点。就像您必须确保给定值对象是不可变的（如果需要），您必须考虑传递引用的完整性。

其中大部分是一般准则，因为它导致“行为良好”、易于推理并且易于生成一致的聚合。

**更新**

2a) 鉴于编程语言的局限性，聚合保护自身的能力是有限度的。因此，需要“人工干预”，尤其是在像这样的更复杂的场景中。确实，总量可能会受制于他人，这就是制定这些指导方针的原因。

2b) 是的。外部对象可以使用另一个聚合的内部实体，但是它的引用应该是瞬态的——这意味着它不会被持久化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-04T21:17:00.450

如果具有私有实体的对象获得锁，将该实体的引用传递给外部方法，该方法永远不允许将其复制到该方法离开范围后仍然*存在*的任何位置，然后释放锁，它可以是确保当锁被释放时，没有外部实体会持有引用。即使锁中某处的代码抛出异常，该不变量仍将成立。如果允许外部方法将对实体的引用存储在可能超过它的任何地方，即使它承诺某些其他操作将破坏该引用，要确保销毁外部引用所需的操作实际发生也会变得更加困难在释放锁之前。*

# c# - 使用实体框架分组

> ID：14486118
> 
> 赞同：0
> 
> 时间：2013-01-23T17:50:06.267
> 
> 标签：c#, asp.net, entity-framework

大家好，我有一个 sql 查询，我想使用实体框架执行相同的操作并将其绑定到 gridview 可以帮助我。这是我的查询

```
SELECT Technology,[Description], Technologies.TechID, COUNT(*) AS 'num_employees'
FROM Technologies
LEFT JOIN Questions   
ON Questions.TechID = Technologies.TechID
GROUP BY Technologies.TechID, Technology,[Description] 
```

如何使用 EF 转换相同的结果以获得结果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:55:18.737

就个人而言，我会将其设为存储过程，并将其导入 EF。然后，您只需在代码中调用它并将结果数据绑定到您的网格。

这样，加入、分组等都发生在服务器端而不是客户端。否则，您将向客户发送比必要信息更多的信息。另外，理论上服务器可以比客户端更快地完成这些操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:06:15.507

试试这个，我没有时间测试它的逻辑和语法。你需要类似的东西。

```
var q = from a in context.Technologies
    join b in context.Questions
    on a.TechID equal b.TechID into j1
    from j2 in j1.DefaultIfEmpty()
    group j2 by new { a.TechID, b.Technology, b.Description into grouped
    select new { Tecnology = grouped.Technology, Description = grouped.Description, Count = grouped.Count() } 
```

# git - 樱桃挑选后git合并如何工作？

> ID：14486122
> 
> 赞同：221
> 
> 时间：2013-01-23T17:50:15.817
> 
> 标签：git, git-merge, cherry-pick

假设我们有一个`master`分支。

然后我们创建一个`newbranch`

```
git checkout -b newbranch 
```

并做出两个新的提交`newbranch`：*commit1*和*commit2*

然后我们切换到master并制作`cherry-pick`

```
git checkout master
git cherry-pick hash_of_commit1 
```

*调查*`gitk`我们看到commit1及其精选版本具有不同的哈希值，因此从技术上讲，它们是两个不同的提交。

 *最后我们合并`newbranch`成`master`：

```
git merge newbranch 
```

并看到这两个具有不同哈希值的提交合并没有问题，尽管它们暗示应该应用两次相同的更改，因此其中一个应该失败。

git 在合并时是否真的对提交的内容进行了智能分析，并决定不应两次应用更改，或者这些提交在内部被标记为链接在一起？

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2013-01-23T18:08:56.713

## 简短的回答

别担心，Git 会处理的。

## 长答案

与例如 SVN ¹不同，Git 不以增量格式存储提交，而是**基于快照的**^(2,3)。虽然 SVN 会天真地尝试将每个合并的提交作为补丁应用（并且由于您描述的确切原因而失败），但 Git 通常能够处理这种情况。

合并时，Git 会尝试将两个 HEAD 提交的快照合并到一个新的快照中。如果两个快照中的一部分代码或文件是相同的（即，因为提交已经被精心挑选），Git 不会触及它。

**来源**

¹ [Subversion 中的 Skip-Deltas](http://svn.apache.org/repos/asf/subversion/trunk/notes/skip-deltas)
² [Git 基础](https://git-scm.com/book/en/v2/Getting-Started-Git-Basics)
³ [Git 对象模型](http://shafiulazam.com/gitbook/1_the_git_object_model.html)

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2017-07-07T08:50:34.820

在这样的合并之后，您可能会在历史上两次精选提交。

防止这种情况的解决方案我引用了[文章](https://davitenio.wordpress.com/2008/09/27/git-merge-after-git-cherry-pick-avoiding-duplicate-commits/)，该文章建议具有重复（樱桃采摘）提交的分支在合并之前使用 rebase：

> git cherry-pick 之后的 git 合并：避免重复提交
> 
> 假设我们有 master 分支和一个分支 b：
> 
> ```
>  o---X   <-- master
>     \
>      b1---b2---b3---b4   <-- b 
> ```
> 
> 现在我们迫切需要 master 中的 b1 和 b3 提交，而不是 b 中剩余的提交。所以我们要做的是检查 master 分支并选择提交 b1 和 b3：
> 
> ```
> $ git checkout master
> $ git cherry-pick "b1's SHA"
> $ git cherry-pick "b3's SHA" 
> ```
> 
> 结果将是：
> 
> ```
>  o---X---b1'---b3'   <-- master
>     \
>      b1---b2---b3---b4   <-- b 
> ```
> 
> 假设我们在 master 上再次提交，我们得到：
> 
> ```
>  o---X---b1'---b3'---Y   <-- master
>     \
>      b1---b2---b3---b4   <-- b 
> ```
> 
> 如果我们现在将分支 b 合并到 master 中：
> 
> ```
> $ git merge b 
> ```
> 
> 我们会得到以下信息：
> 
> ```
>  o---X---b1'---b3'---Y--- M  <-- master
>      \                     /
>       b1----b2----b3----b4   <-- b 
> ```
> 
> 这意味着 b1 和 b3 引入的更改将在历史记录中出现两次。为了避免这种情况，我们可以变基而不是合并：
> 
> ```
> $ git rebase master b 
> ```
> 
> 这将产生：
> 
> ```
>  o---X---b1'---b3'---Y   <-- master
>                         \
>                          b2'---b4'   <-- b 
> ```
> 
> 最后：
> 
> ```
> $ git checkout master
> $ git merge b 
> ```
> 
> 给我们：
> 
> ```
>  o---X---b1'---b3'---Y---b2'---b4'   <-- master, b 
> ```

**编辑** 大卫柠檬的评论所提出的更正*

# java - Java：使用 getter 与缓存值

> ID：14486124
> 
> 赞同：3
> 
> 时间：2013-01-23T17:50:20.090
> 
> 标签：java, performance

我有一个返回字符串的getter，我将它与其他字符串进行比较。我检查 null 的返回值，所以我的`if`语句看起来像这样（如果它是真的，我真的会提前退出）

```
if (someObject.getFoo() != null && someObject.getFoo().equals(someOtherString)) {
  return;
} 
```

在性能方面，存储返回的字符串会比像这样调用两次 getter 更好吗？这还重要吗？

```
String foo = someObject.getFoo();
if (foo != null && foo.equals(someOtherString)) {
  return;
} 
```

* * *

为了回答评论中的问题，这种检查并不经常执行，而且 getter 相当简单。我很好奇分配一个新的局部变量与再执行一次 getter 相比如何。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-23T17:51:45.033

这完全取决于吸气剂的作用。如果它是一个简单的 getter（检索数据成员），那么如果 JVM 确定代码是性能的热点，它将能够即时内联它。这实际上就是为什么 Oracle/Sun 的 JVM 被称为“HotSpot”的原因。:-) 它会在它认为需要的地方（如果可以的话）应用积极的 JIT 优化。但是，如果 getter 做了一些复杂的事情，使用它并让它重复该工作自然会更慢。

如果代码不是热点，当然，您不在乎是否存在性能差异。

有人曾经告诉我，内联的 getter 有时可能比缓存到局部变量的值更快，但我从未向自己证明过这一点，也不知道为什么会这样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T19:12:15.730

使用第二块。无论如何，第一个块很可能会优化到第二个块，而第二个块更具可读性。 **但主要原因**是，如果 someObject 曾经被其他线程访问过，并且如果优化以某种方式被禁用，第一个块将不会抛出 NullPointerException 异常。

另外：即使没有多线程，如果 someObject 有任何机会变成*volatile*，优化也会消失。（对性能不利，当然，多线程也**很**糟糕。）最后，第二个块将使调试器的使用更容易（这不是*必需*的。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T22:31:10.487

您可以省略第一个 null 检查，因为 equals 会为您执行此操作：

> 当且仅当参数不为 null 并且是表示与此对象相同的字符序列的 String 对象时，结果才为真。

所以最好的解决方案很简单：

```
if(someOtherString.equals(someObject.getFoo()) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T17:55:09.163

它们看起来都一样，即使在性能方面也是如此。如果您确定不会进一步使用返回值，请使用第一个块，如果没有，请使用第二个块。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-24T06:34:09.080

我更喜欢第二个代码块，因为它分配了 foo，然后 foo 不能更改为 null/notnull。

Null 通常是必需的，Java 应该使用“Elvis”运算符来解决这个问题：

```
if (someObject.getFoo()?.equals(someOtherString)) {
  return;
} 
```

# uml - TopCoder UML 工具：如何创建泳道？

> ID：14486126
> 
> 赞同：0
> 
> 时间：2013-01-23T17:50:25.463
> 
> 标签：uml

正如题主所问，如何在应用程序中创建一个所谓的“分区”，通常称为泳道？

我正在创建一个活动图！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:52:09.210

“当前版本的 TopCoder UML 工具不支持以下元素，并且在 TopCoder 流程​​中没有积极使用。但是，这些元素在构建活动图时通常很有用。” 该死！元素包括泳道。

# windows-phone-8 - 我可以在 HTML 5 和 Windows 8 Phone SDK 中捕捉到任何电话抖动事件吗？

> ID：14486133
> 
> 赞同：0
> 
> 时间：2013-01-23T17:51:00.940
> 
> 标签：windows-phone-8

我打算使用 Windows 8 Phone SDK 制作一个应用程序，我打算制作的应用程序是在手机震动时播放音频。

由于我已经精通 HTML 5，因此我计划为此使用 HTML 5 项目模板。

所以我的问题是：是否有任何电话抖动事件我可以捕捉和播放 HTML 5 中的音频文件？

请分享您对此的看法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:19:25.587

WP8 上没有检测 HTML 抖动的事件。

您可以做的最接近的事情是在代码中检测它（使用这个[摇动手势库](http://blogs.windows.com/windows_phone/b/wpdev/archive/2011/02/22/windows-phone-shake-gestures-library.aspx)），然后当检测到摇动时，让它在 Web 浏览器中加载的页面上调用 HTML/JS 中的函数来播放声音。

# javascript - TypeScript 持续集成

> ID：14486134
> 
> 赞同：6
> 
> 时间：2013-01-23T17:51:07.790
> 
> 标签：javascript, unit-testing, coding-style, continuous-integration, typescript

有人有将 TypeScript 添加到持续集成系统的好策略吗？

我计划在我的构建中编译它，然后针对它生成的 JavaScript 运行单元测试。

但是，我想为 TypeScript 添加代码标准检查。有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:21:33.240

TypeScript 团队故意保留对官方编码标准的判断，因为他们想看看人们如何在现实生活中使用该语言。有趣的是，人们似乎在遵循 JavaScript 命名约定，即`ModuleName`, `ClassName`, `functionName`。

您可以使用 TypeScript (tsUnit) 或 JavaScript（Jasmine、QUnit 等）编写单元测试。

如何将它与 CI 集成在一定程度上取决于框架和 CI 平台。我已使用 MS 脚本引擎将 tsUnit 测试与 Visual Studio 和 TFS 集成以执行测试。如果您想了解有关此特定设置的更多详细信息，我很乐意分享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-23T00:38:45.763

一种选择是设置 TSLint 并将其集成到您的构建过程中。

就我而言（Angular 2+ 应用程序），我添加了一个 npm 任务来运行 TSLint。然后 CI 系统（对我来说是 VSTS）执行那个 npm 任务。如果 TSLint 检测到任何错误，CI 系统将无法构建。我使用的 TSLint 任务来自 Angular 的快速入门项目。这里：[https](https://github.com/angular/quickstart/blob/master/package.json) ://github.com/angular/quickstart/blob/master/package.json [注意“lint”脚本]

另请注意，TSLint 的规则是可配置的，因此您可以将编码标准自定义为您想要使用的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:54:22.100

您的问题含糊不清；很难给出准确的答案。

要将 TS 编译集成到您的构建系统中，您只需在 .ts 文件上调用 TypeScript 命令行编译器 (tsc.exe)。这将输出 JS，您可以针对这些运行单元测试。

关于 TS 代码标准，我认为现在没有任何工具可以查看 TS 编码标准，看看几个月前该语言是如何公开的。

# jquery - jQuery .on-method 不适用于动态添加的项目

> ID：14486135
> 
> 赞同：0
> 
> 时间：2013-01-23T17:51:08.797
> 
> 标签：jquery, ajax, dynamic

我有数百个

```
<button class="lb">
  <div class="l"></div>
  <div class="c">2</div>
  <div class="r"></div>
</button> 
```

加载页面时，其中一些已经在 DOM 中，而其他一些则是通过 javascript 动态添加的。

当有人点击按钮时，按钮里面的 div class="c" 里面的值应该加 1。

我以为我可以这样做

```
$(".lb").on("click", function(event) {
  $('.c', this).html(parseInt($('.c', this).html()) + 1);
  $(this).unbind('mouseout');
}); 
```

但这仅适用于页面加载时加载的元素，而不适用于新的 per-JS 插入的元素。

我找不到我缺少的东西，并希望得到任何提示。

谢谢！拉斐尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T17:52:54.923

`.lb`使用事件委托给or的父级`document`。正如@Zolton Toth 指出的那样，您应该使用`off`而不是弃用`unbind`。

```
$(document).on("click", ".lb", function(event) {
  $('.c', this).html(parseInt($('.c', this).html()) + 1);
  $(this).off('mouseout');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:52:28.957

您缺少一些`.on()`用作委托的概念：

```
$(' --CONTEXT-- ').on('click', ' -- YOUR ELEMENT -- ', function () {

});

// like-wise to "unbind" using the new methodology
// you would use .off()
$(' --CONTEXT-- ').off('click', '-- YOUR ELEMENT --'); 
```

因此，以示例形式表示：

```
$(document).on('click', '.lb', function () { }); 
```

但是，这当然会使上下文（或它将“冒泡”的位置）**文档**变得太高了。尝试在此项目可能出现的任何地方使用大的父级，它将加快性能。

```
$('#someParent').on('click', '.lb', function () { }); 
```

# msbuild - MSBuild 迭代属性

> ID：14486137
> 
> 赞同：0
> 
> 时间：2013-01-23T17:51:16.830
> 
> 标签：msbuild

是否可以通过 MSBuild 一些命令行属性：

```
msbuild.exe /p:Configuration=Release;labDeploy=false;prodDeploy=true 
```

然后以某种方式遍历通过属性 arg 传入的键/值对。

如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:55:24.667

你没有说你想用它们做什么，但如果你想用它们来控制执行，看看[MSBuild Conditions](http://msdn.microsoft.com/en-us/library/7szfhaft.aspx)。例如，我公司的“产品”此时已完全实施，包括一个传统的客户端-服务器应用程序、一个基于 Web 的报告应用程序，以及一些客户端-服务器应用程序的较新 Silverlight 实施。

在我的主 MSBuild 项目文件中，每个应用程序都有单独的目标，它们是否运行由几个命令行参数的条件检查控制。

```
 <!-- run the builds for the selected build types -->
  <Target Name="RunBuild" DependsOnTargets="ValidateBuildSelected">
    <CallTarget Targets="BuildWindowsClientApp" Condition="'$(BuildWindowsClientApp)'=='TRUE'" />
    <CallTarget Targets="BuildWebReportingApp" Condition="'$(BuildWebReportingApp)'=='TRUE'" />
    <CallTarget Targets="BuildWebClientApp" Condition="'$(BuildWebClientApp)'=='TRUE'" />
  </Target> 
```

我可以根据我设置参数字符串的方式运行一个或所有选项。

# java - Java：为什么检查“\n”与使用 System.getProperty("line.separator") 添加的新行不匹配

> ID：14486138
> 
> 赞同：8
> 
> 时间：2013-01-23T17:51:20.180
> 
> 标签：java, newline

（**更新的问题**）

首先，我认为这`"\n"`相当于`System.getProperty("line.separator")`

我写了一些使用字符串的方法，其中一些检查是否存在新行

`if (string.charAt(i) == '\n') {//do something;}`

但我注意到检查`"\n"`与添加的新行不匹配`System.getProperty("line.separator")`

这是一个**SSCCE**来证明我的主张！：

**描述：**
两串相同的文本；一个`alpha_String`使用 添加了新行`"\n"`，另一个`beta_String`使用 添加了新行`System.getProperty("line.separator")`

有一个名为`String removeExtraNewLines(String)`用于删除字符串中任何额外的新行并将其返回的方法；正如其标题所暗示的那样。使用此方法过滤的两个字符串。

两个按钮`buttonAlpha`，每个按钮都使用过滤`buttonBeta`后的字符串设置文本`JTextArea`

**您会注意到**该方法捕获/匹配并删除额外的新行， `alpha_String`但不要对`beta_String`

```
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import javax.swing.*;

public class NewLineTest extends JPanel
{

    JPanel buttonPanel;
    JPanel textAreaPanel;
    JButton buttonAlpha;
    JButton buttonBeta;
    JTextArea textArea;
    String n = "\n";
    String s = System.getProperty("line.separator");
    String alpha_String;
    String beta_String;

    public NewLineTest()
    {
        createSentencesText();
        buttonAlpha = new JButton("Alpha String");
        buttonAlpha.addActionListener(eventWatcher);

        buttonBeta = new JButton("Beta String");
        buttonBeta.addActionListener(eventWatcher);

        textArea = new JTextArea(0, 0);
        JScrollPane scrollTextArea = new JScrollPane(textArea);
        scrollTextArea.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);
        textArea.setEditable(false);

        buttonPanel = new JPanel();
        textAreaPanel = new JPanel(new BorderLayout());

        buttonPanel.add(buttonAlpha);
        buttonPanel.add(buttonBeta);

        textAreaPanel.add(scrollTextArea, BorderLayout.CENTER);

        JSplitPane splitPane = new JSplitPane(JSplitPane.HORIZONTAL_SPLIT, textAreaPanel, buttonPanel);
        splitPane.setDividerLocation(400);
        splitPane.setResizeWeight(.5d);
        this.setLayout(new BorderLayout());
        this.add(splitPane);
    }

    private void createSentencesText()
    {
        alpha_String = "A: Let’s go to the beach." + n + n
                + "B: That’s a great idea." + n
                + "A: We haven’t been in a while." + n + n
                + "B: We haven’t been in a month." + n
                + "A: The last time we went, you almost drowned." + n
                + "B: No, I didn’t." + n + n + n
                + "A: Then why did the lifeguard dive into the water?" + n
                + "B: I think he wanted to cool off." + n
                + "A: He swam right up to you." + n
                + "B: And then he turned right around." + n
                + "A: Maybe you’re right." + n
                + "B: Maybe we should get going.";

        beta_String = "A: Let’s go to the beach." + s + s
                + "B: That’s a great idea." + s
                + "A: We haven’t been in a while." + s + s
                + "B: We haven’t been in a month." + s
                + "A: The last time we went, you almost drowned." + s
                + "B: No, I didn’t." + s + s + s
                + "A: Then why did the lifeguard dive into the water?" + s
                + "B: I think he wanted to cool off." + s
                + "A: He swam right up to you." + s
                + "B: And then he turned right around." + s
                + "A: Maybe you’re right." + s
                + "B: Maybe we should get going.";
    }

    public static String removeExtraNewLines(String s)
    {
        String myNewString = s.trim();
        StringBuilder stringB = new StringBuilder();

        char previouseChar = '~';
        for (int i = 0; i < myNewString.length(); i++)
        {
            if (i > 1)
            {
                previouseChar = myNewString.charAt(i - 1);
            }
            if ((myNewString.charAt(i) == '\n') && (previouseChar == '\n'))
            {
                continue;
            }

            stringB.append(myNewString.charAt(i));
        }
        myNewString = stringB.toString();
        return myNewString;
    }
    AbstractAction eventWatcher = new AbstractAction()
    {
        @Override
        public void actionPerformed(ActionEvent ae)
        {
            Object source = ae.getSource();
            if (source == buttonAlpha)
            {
                String arranged_string_alpha = removeExtraNewLines(alpha_String);
                textArea.setText(arranged_string_alpha);
            }
            if (source == buttonBeta)
            {
                String arranged_string_beta = removeExtraNewLines(beta_String);
                textArea.setText(arranged_string_beta);
            }
        }
    };

    private static void createAndShowGUI()
    {
        JFrame frame = new JFrame("NewLine Test");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(700, 300);
        frame.add(new NewLineTest(), BorderLayout.CENTER);
        frame.setVisible(true);
    }

    public static void main(String[] args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                UIManager.put("swing.boldMetal", Boolean.FALSE);
                createAndShowGUI();
            }
        });
    }
} 
```

**所以问题是**：为什么检查`"\n"`不匹配使用添加的新行`System.getProperty("line.separator")`？，以及如何匹配它们？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-23T17:57:32.863

> 首先，我认为 "\n" 等价于 System.getProperty("line.separator") 除了后者是平台无关的。

不，后者是*特定于平台的*。这是获取平台行分隔符*的独立*于平台的方式。

例如，在 Windows 上，我希望`System.getProperty("line.separator")`返回“\r\n”。

现在至于你`textArea`对换行符的用途——这完全取决于是什么`textArea`——而且你还没有给我们任何关于这方面的信息。

# python - Python - 函数不是“全局”，因此不能在线程类中调用

> ID：14486139
> 
> 赞同：1
> 
> 时间：2013-01-23T17:51:22.880
> 
> 标签：python, multithreading, function

所以，首先这是我的代码：

```
import threading

print "Press Escape to Quit"

class threadOne(threading.Thread): #I don't understand this or the next line
    def run(self):
        setup()

    def setup():
        print 'hello world - this is threadOne'

class threadTwo(threading.Thread):
    def run(self):
        print 'ran'

threadOne().start()
threadTwo().start() 
```

所以，问题是在我的类'threadOne'中运行函数（由线程模块调用）但从那里我不能调用任何其他函数。这包括如果我在 setup() 函数下创建更多函数。例如上面，在我的 run(self) 函数中，我尝试调用 setup() 并得到“NameError: global name 'setup' is not defined”。

有没有人有任何想法或者他们可以向我解释这个？

山姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:54:03.520

`setup`是您的`Thread`实例的方法。因此，您使用`self.setup()`而不是调用它`setup()`。后者试图调用一个`setup`不存在的名为的全局函数。

由于`setup()`是一个实例方法，它也必须接受`self`作为它的第一个参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T17:54:12.443

我假设您打算执行以下操作：

```
class threadOne(threading.Thread): #I don't understand this or the next line
    def run(self):
        self.setup()

    def setup(self):
        print 'hello world - this is threadOne' 
```

# javascript - 如何处理 javascript 插件生成替代输入的 ASP.NET 表单？

> ID：14486145
> 
> 赞同：0
> 
> 时间：2013-01-23T17:51:35.253
> 
> 标签：javascript, jquery, ajax, asp.net-mvc, jquery-plugins

我有一个 ASP.NET MVC 网页，它使用 ajax 提交表单，如下所示：

```
function ValidateFormAndAjaxSubmit(formId, callingElement) {

    if (IsNotDblClick(callingElement.id)) {
        var _form = $("#" + formId);

        var validator = _form.validate();
        var anyError = false;

        anyError = !_form.valid();

        if (anyError) {
            window.latestClick = '';
            return false; // exit if any error found    
        }

        $.post(_form.attr("action"), _form.serialize(), function (data) {

            if (data.success && data.redirectUrl.length > 0) {
                window.location.href = data.redirectUrl;
            }
            else {

                var isValid = validateResponse(_form, data);

                window.latestClick = '';
            }
        })
    }
} 
```

表单中的所有控件都是使用 Html.TextBoxFor 等助手生成的，效果很好。

问题是 jquery 插件（Select2）会将常规文本框变成这样的列表：

```
<div class="floatLeft">
            <label class="controlTitleContainer" for="Url">Taggar</label>
            <br style="clear:both;">
            <div class="select2-container select2-container-multi bigdrop" id="s2id_txtTagBox" style="width: 408px">    <ul class="select2-choices" style="">  <li class="select2-search-choice">    <div>Film                </div>    <a href="#" onclick="return false;" class="select2-search-choice-close" tabindex="-1"></a></li><li class="select2-search-choice">    <div>Hund                </div>    <a href="#" onclick="return false;" class="select2-search-choice-close" tabindex="-1"></a></li><li class="select2-search-field">    <input type="text" autocomplete="off" class="select2-input valid" tabindex="0" style="width: 10px;">  </li></ul></div><input style="width: 408px; display: none;" class="bigdrop" id="txtTagBox" name="Tags" type="text" value="">
        </div> 
```

您可以在此处看到文本框设置为不显示，而添加的标签显示为 ul 列表。在这种情况下，我已将 Film 和 Hund 添​​加到列表中。

我需要将这些值发送到服务（使用上面的 ajax 调用），问题是如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:59:53.967

从我从文档中可以看出，select2 设计用于选择列表，而不是文本框。尝试生成选择列表而不是文本框。

查看示例中“多值选择框”的源代码，底层标记是一个选择框，但插件会生成一个 div 使其看起来像一个文本框。

# java - Java Web Start 应用程序在 XMonad 上显示空窗口

> ID：14486147
> 
> 赞同：3
> 
> 时间：2013-01-23T17:51:38.303
> 
> 标签：java, linux, java-web-start, xmonad

我使用 XMonad+gnome 作为窗口管理器。我的问题是，当我运行 Java Web Start 应用程序时，它总是显示一个空窗口，如屏幕：

![屏幕](../Images/8f431d8a1a057d268d11231db9ad0836.png)

有什么我可以解决的吗？

更新：

[我尝试了JWS 示例](http://enos.itcollege.ee/~jpoial/docs/tutorial/uiswing/learn/example-1dot4/index.html)中的简单程序，它可以正常工作，对。所以应该是应用的问题。

失败的应用是 Blast2Go。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T15:55:07.423

将窗口管理器的名称更改为已知名称，例如`LG3D`：

```
startupHook = setWMName "LG3D" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-02T21:53:49.510

我自己的 Java 代码遇到了完全相同的问题，使用其他建议的解决方案（setWMName、MToolkit 等）并没有解决 Xmonad 的问题。我必须注意，在其他窗口管理器（例如fluxbox）中，该应用程序按预期工作。然而，就我而言，我发现了问题所在。如果您可以访问 Java 应用程序的源代码，我建议您考虑以下事项：

如果您有任何 JFrame 或 JPanel 或其他容器，您应该明确定义它们的布局。如果将布局设置为 null，则必须明确设置容器的尺寸。否则，容器根本不会被渲染。例如，我有一个 JPanel，其中包含我所有的小部件。我宁愿完全控制布局，所以我将布局设置为 null，然后显式设置 JPanel 的尺寸：

```
jContentPane.setLayout(null);
jContentPane.setPreferredSize(new Dimension(appletWidth,appletHeight+100)); 
```

希望这可以帮助。

# vb.net - 如何将自己开发的浏览器设置为默认浏览器？

> ID：14486149
> 
> 赞同：1
> 
> 时间：2013-01-23T17:51:44.020
> 
> 标签：vb.net, browser, default-browser

我正在使用 VB.NET 中的 Web 浏览器，我想设置使其成为默认浏览器的选项。有什么帮助吗？Tks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T07:06:41.043

请参阅MSDN 的默认程序 API 文档中的[成为默认浏览器](http://msdn.microsoft.com/en-us/library/cc144154%28VS.85%29.aspx#browser)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:57:17.807

这是在VB6中如何做到的，需要转换

```
Const REG_SZ As Long = 1
Const HKEY_CURRENT_USER = &H80000001
Const HKEY_LOCAL_MACHINE = &H80000002
Const KEY_SET_VALUE = &H2
Const KEY_ALL_ACCESS = &H3F
Const REG_OPTION_NON_VOLATILE = 0
Const HWND_BROADCAST = &HFFFF
Const WM_SETTINGCHANGE = &H1A

Private Declare Function RegCloseKey Lib "advapi32.dll" _
  (ByVal hKey As Long) As Long
Private Declare Function RegCreateKeyEx Lib "advapi32.dll" _
  Alias "RegCreateKeyExA" (ByVal hKey As Long, _
  ByVal lpSubKey As String, ByVal Reserved As Long, _
  ByVal lpClass As String, ByVal dwOptions As Long, _
  ByVal samDesired As Long, ByVal lpSecurityAttributes As Long, _
  phkResult As Long, lpdwDisposition As Long) As Long
Private Declare Function RegOpenKeyEx Lib "advapi32.dll" _
  Alias "RegOpenKeyExA" (ByVal hKey As Long, _
  ByVal lpSubKey As String, ByVal ulOptions As Long, _
  ByVal samDesired As Long, phkResult As Long) As Long
Private Declare Function RegSetValueExString Lib "advapi32.dll" _
  Alias "RegSetValueExA" (ByVal hKey As Long, _
  ByVal lpValueName As String, ByVal Reserved As Long, _
  ByVal dwType As Long, ByVal lpValue As String, _
  ByVal cbData As Long) As Long
Private Declare Function SendMessage Lib "user32" _
  Alias "SendMessageA" (ByVal hwnd As Long, ByVal wMsg As Long, _
  ByVal wParam As Long, lparam As String) As Long
Public Function SetClient(iClient As Integer, sDisplayName As String, _
  sClientCommandLine As String, sClientResourceDLL As String, _
  iLocalization As Integer, bGlobalClient As Boolean, _
  Optional sCLParameters As String, Optional bMakeDefault As Boolean) As Integer

  ' iClient - 1 for internet browser, 2 for e-mail client
  ' sDisplayName - the name to be displayed on the menu for the client
  ' sClientCommandLine - the path and filename of the e-mail client
  '
  ' The next two parameters are included for localization of the client.
  ' For backwards compatibility with applications that do not support localized
  ' strings, the name of the application in the installed language should be set
  ' as the Default value for the key.
  ' sClientResourceDLL - provides a path to an EXE or DLL containing the
  '   localized strings for the client.
  ' iLocalization - a string resource ID within the DLL whose value is
  '   to be displayed to the user allowing the same registration to
  '   be used for multiple languages.  For each language, provide a
  '   different Resource DLL, and the dynamic loading of the string
  '   from the DLL results in the correct strings being displayed, depending
  '   on the language.
  '
  ' bGlobalClient - sets the value for either all users (True) or the
  '   current user (False)
  ' sCLParameters - additional parameters on the command line to be passed to the
  '   browser or e-mail client.
  ' bMakeDefault - (Optional) set the browser or e-mail application as the default

  Dim iStatus As Integer
  Dim hHandle As Long
  Dim hGRegKey As String
  Dim hLRegKey As String
  Dim sCommand As String
  Dim sKey As String
  Dim sAll As String
  Dim sRoot As String
  Dim hKey As Long
  Dim sLoc As String
  hGRegKey = HKEY_LOCAL_MACHINE
  hLRegKey = HKEY_CURRENT_USER

  If iClient = 1 Then
    sRoot = "Software\Clients\StartMenuInternet"
  Else
    sRoot = "Software\Clients\Mail"
  End If

  ' Create and null terminate needed strings
  sCommand = "shell\open\command"
  sKey = sRoot & "\" & sDisplayName
  sAll = sKey & "\" & sCommand
  sLoc = "@" & sClientResourceDLL & "," & iLocalization & Chr$(0)
  sClientLocation = """" & sClientCommandLine & """" & _
    IIf(sCLParameters <> "", " ", "") & Trim(sCLParameters) & Chr$(0)
  sDisplayName = sDisplayName & Chr$(0)

  ' Create a registry key for the new client
  iStatus = RegCreateKeyEx(hGRegKey, sKey, 0&, vbNullString, _
    REG_OPTION_NON_VOLATILE, KEY_ALL_ACCESS, 0&, hNewKey, lRetVal)
  iStatus = RegCreateKeyEx(hGRegKey, sAll, 0&, vbNullString, _
    REG_OPTION_NON_VOLATILE, KEY_ALL_ACCESS, 0&, hNewKey, lRetVal)
  If iStatus = ERROR_NONE Then
    iStatus = RegOpenKeyEx(hGRegKey, sAll, 0, KEY_SET_VALUE, hKey)
    iStatus = RegSetValueExString(hKey, "", 0&, REG_SZ, sClientLocation, _
      Len(sClientLocation))
    iStatus = RegCloseKey(hKey)
    iStatus = RegOpenKeyEx(hGRegKey, sKey, 0, KEY_SET_VALUE, hKey)
    iStatus = RegSetValueExString(hKey, "", 0&, REG_SZ, sDisplayName, _
      Len(sDisplayName))
    ' Add the localization string
    iStatus = RegSetValueExString(hKey, "LocalizedString", 0&, REG_SZ, _
        sLoc, Len(sLoc))
    iStatus = RegCloseKey(hKey)
  Else
    SetClient = iStatus
    Exit Function
  End If

  '  Sets browser as local or global default if specified
  If bMakeDefault Then
    If bGlobalClient Then
      iStatus = RegOpenKeyEx(hGRegKey, sRoot, 0, KEY_SET_VALUE, hKey)
      iStatus = RegSetValueExString(hKey, "", 0&, REG_SZ, sDisplayName, _
        Len(sDisplayName))
      iStatus = RegCloseKey(hKey)
    Else
      iStatus = RegCreateKeyEx(hLRegKey, sRoot, 0&, vbNullString, _
        REG_OPTION_NON_VOLATILE, KEY_ALL_ACCESS, 0&, hNewKey, lRetVal)
      iStatus = RegSetValueExString(hNewKey, "", 0&, REG_SZ, _
        sDisplayName, Len(sDisplayName))
      iStatus = RegCloseKey(hNewKey)
    End If
    UpdateMenus
  End If
End Function
Private Sub UpdateMenus()
  ' Refresh the menu choices with the updated client
  Dim iRetVal As Integer
  iRetVal = SendMessage(HWND_BROADCAST, WM_SETTINGCHANGE, 0, _
    "SOFTWARE\Clients\mail")
  iRetVal = SendMessage(HWND_BROADCAST, WM_SETTINGCHANGE, 0, _
    "SOFTWARE\Clients\StartMenuInternet")
End Sub 
```

来自[微软](http://support.microsoft.com/kb/299853)

# c# - 从孤立存储读取时引发异常“在独立存储文件流上不允许操作”

> ID：14486152
> 
> 赞同：0
> 
> 时间：2013-01-23T17:51:47.140
> 
> 标签：c#, windows-phone-7, windows-phone-7.1.1

在我的应用程序中，我必须从远程服务器下载所有图像并将其显示在列表视图中。当我尝试从隔离存储中提取图像时出现异常

> “IsolatedStorageFileStream 上不允许操作”

.这是我的代码

```
public static object ExtractFromLocalStorage(Uri imageFileUri)
    {

        byte[] data;
       string isolatedStoragePath = GetFileNameInIsolatedStorage(imageFileUri);       //Load from local storage
        if (null == _storage)
        {

             _storage = IsolatedStorageFile.GetUserStoreForApplication();
        }
         BitmapImage bi = new BitmapImage();
  //HERE THE EXCEPTION OCCURS
        using (IsolatedStorageFileStream sourceFile = _storage.OpenFile(isolatedStoragePath, FileMode.Open, FileAccess.Read))
        {
            data = new byte[sourceFile.Length];

            // Read the entire file and then close it
            sourceFile.Read(data, 0, data.Length);
         // Create memory stream and bitmap
        MemoryStream ms = new MemoryStream(data);

        // Set bitmap source to memory stream
        bi.SetSource(ms);
            sourceFile.Close();

        }
        return bi;
    } 
```

上述函数用于从隔离存储中获取位图图像，我的模型类是

```
public class Details
{ 
  public string id { get; set; }
  public string name { get; set; }
  public Uri imgurl { get; set; }
  [IgnoreDataMember]
  public BitmapImage ThumbImage{get;set;}
} 
```

我正在使用一个单例类来调用函数来获取图像。

```
public class SingleTon
{
    static SingleTon instance = null;

    private SingleTon()
    {

    }

    public static SingleTon Instance()
    {

                if (instance == null)
                {
                    instance = new SingleTon();
                }
                return instance;

    }

    public BitmapImage getImage(Uri uri)
    {
        lock (this)
        {
            BitmapImage image = new BitmapImage();
            image = (BitmapImage)CacheImageFileConverter.ExtractFromLocalStorage(uri);
            return image;
        }
    }
    public void writeImageToIsolatedStorage(Uri imageUri)
    {
        lock (this)
        {
            CacheImageFileConverter.DownloadFromWeb(imageUri);
        }
    }
} 
```

这是将图像设置为对象的代码

```
 SingleTon singleton = SingleTon.Instance();
 List<(Details > datalist = new Details()
 foreach (Details items in DataList)
        {

    items.ThumbImage = singleton.getImage(items.imgurl );
    datalist.add(items);    

    } 
```

请任何人帮助我解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T02:22:21.970

如果您没有关闭以前打开的流到同一文件，通常会发生此异常。检查`CacheImageFileConverter.DownloadFromWeb`并确保您的输出 Stream 包装在一个`using`块中。

*如果文件不存在，也可能*会引发该异常，但我不确定 100%。也许`IsolatedStorageFile.FileExists()`在你打开它之前通过一个电话来确定。

# joomla - 在 Joomla 前端中包含 TinyMCE

> ID：14486153
> 
> 赞同：1
> 
> 时间：2013-01-23T17:51:47.747
> 
> 标签：joomla, tinymce, frontend

我尝试将 TinyMCE 包含到我的模板中，但如果我尝试在前端编辑文本，我只有一个 html-tag 视图。有人给我一些提示吗？

那是网站和模板，也许这会有所帮助：

[http://www.sonnen-center-hermeskeil.de](http://www.sonnen-center-hermeskeil.de)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T12:50:57.067

如果上述任何一项都没有帮助，则可能是对插件的访问受到限制。转到`Plugin-Manager -> Editor - TinyMCE`并检查`Access`相应设置。例如，如果允许普通用户编辑文章，但 TinyMCE 的访问规则设置为“特殊”，**即使没有其他可用或启用的编辑**器，Joomla 也会仅显示 HTML 编辑器。当允许公共用户编辑文章时，将访问权限设置为“已注册”也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T16:37:18.463

转到插件并禁用除 tinyMCE 之外的所有编辑器。然后再次确保您已选择作为默认编辑器 tinyMCE。您还可以从“用户管理器”中为每个用户定义默认编辑器，方法是打开用户并定义他/她的默认编辑器。

# reporting-services - rsErrorLoadingCodeModule：部署与 Report Builder 2.0 一起使用的程序集的步骤是什么？

> ID：14486161
> 
> 赞同：4
> 
> 时间：2013-01-23T17:52:00.400
> 
> 标签：reporting-services

我已经用一个`public static`类和`public static`一个返回类型为`int`. 最终我会添加更多的方法，但现在程序集只包含一个方法。我正在尝试在我的 SSRS 报告中使用此程序集，但会导致错误：

> [rsErrorLoadingCodeModule]
> 加载代码模块时出错：'XXX.Calcs，Version=2013.1.21.0，Culture=neutral，PublicKeyToken=null'。
> 详细信息：无法加载文件或程序集 'XXX.Calcs，Version=2013.1.21.0，Culture=neutral，PublicKeyToken=null' 或其依赖项之一。该系统找不到指定的文件。

`Report Properties`我通过->引用了程序集`References`。当我创建一个在程序集中使用该方法的表达式然后构建时，我收到上述错误。

我将程序集部署到：

```
C:\Program Files\Microsoft Visual Studio 8\Common7\IDE\PrivateAssemblies 
```

想法？我错过了任何步骤吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T16:43:44.337

我发现[了这一点](http://www.sqlservercentral.com/blogs/dknight/2012/01/26/ssrs-custom-code-with-external-assemblies/)并完全按照步骤操作。

# android - 带有 ViewPager 的 html 页面中的水平 ScrollView

> ID：14486166
> 
> 赞同：0
> 
> 时间：2013-01-23T17:52:20.737
> 
> 标签：android, webview, android-viewpager

我在 Html 页面中有一个自定义水平滚动视图，现在这个基于 java 脚本库的水平滚动，现在当我在 webview 中加载 html 寻呼机时，我无法水平滚动，因为 viewpager 采用触摸事件在页面之间移动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:00:28.970

您将需要实现[onInterceptTouchEvent(MotionEvent)](http://developer.android.com/reference/android/view/ViewGroup.html#onInterceptTouchEvent%28android.view.MotionEvent%29)，确定触摸是否在 WebView 的水平滚动部分内，然后在 WebView 的父级（假设是 ViewPager）上调用[requestDisallowInterceptTouchEvent(boolean )。](http://developer.android.com/reference/android/view/ViewParent.html#requestDisallowInterceptTouchEvent%28boolean%29)

确定触摸是否在水平滚动条内可能很棘手，但您可能可以通过 WebView 侦听的一些 JS 回调来完成。

在此之前，您可能需要考虑这对用户体验的影响。在水平滚动视图中具有水平滚动内容可能会使用户感到困惑/迷失方向。

# jquery - 带有列表的 jQuery.param

> ID：14486167
> 
> 赞同：0
> 
> 时间：2013-01-23T17:52:22.203
> 
> 标签：jquery, asp-classic

这里有谁知道我如何使用 jQuery.param 创建一个**包含电话号码列表的对象，**以及如何在经典 ASP 中恢复它？

我使用 $.ajax 将参数发送到 ASP 页面。通常我所做的是这样的：

```
var p = {
    cod: cod.val(),
    name: name.val()
};
var param = jQuery.param(p);
$.ajax({
    type: "POST",
    url: "SomeASP.asp",
    data: param 
}); 
```

我使用**var param = jQuery.param(p);** 因为我的字符串可以包含任何字符，例如 & 或 ? 或空格。然后我通过这样做来恢复“SomeASP.ASP”的信息：

```
Dim cod, name
cod = Request("cod")
name= Request("name") 
```

**主要问题是**：现在我必须将电话号码列表发送到“SomeASP.asp”。我阅读了[文档](http://api.jquery.com/jQuery.param/)并注意到我可以发送比我上面演示的更复杂的对象，但我不知道如何发送和恢复这些项目。

我很感激任何帮助！对不起我糟糕的英语。

[]的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:00:51.753

你不需要`jQuery.param(p);`。

只需这样做：

```
var p = {
    cod: cod.val(),
    name: name.val()
};

$.ajax({
    type: "POST",
    url: "SomeASP.asp",
    data: p 
}); 
```

在这种情况下，jQuery 将`p`正确序列化并且在服务器端你将能够做到

```
Dim cod, name
cod = Request("cod")
name= Request("name") 
```

**升级版：**

不确定 ASP 将如何处理此类请求。在 asp.net 中它将是：

```
string[] = Request["phones[]"].Split(","); 
```

可能你需要在经典的 asp 中做类似的事情。

但如果没有，您可以在客户端加入电话号码： var p = { cod: cod.val(), name: name.val() }; p.phones = ['phone1', 'phone2'].join(",")//你应该收到类似 "phone1,phone2" 的字符串 $.ajax({ type: "POST", url: "SomeASP.asp" , 数据: p });

而不是在服务器端：

```
Dim cod, name, phones
cod = Request("cod")
name= Request("name")
phones = Request("phones")
phonesArray = phones.Split(",") //not sure how exactly this line will be in classic asp, but idea should be clear 
```

# javascript - 当我学习 eloquentjavascript 时，有一个关于 forEach 和 map 的无尽循环

> ID：14486169
> 
> 赞同：1
> 
> 时间：2013-01-23T17:52:27.143
> 
> 标签：javascript, map, foreach, infinite-loop

第六章

我的英语很差无法详细描述问题所以我粘贴我的练习代码：http://jsbin.com/exusox/3/edit

单击按钮时无限循环。

我已经测试了我的代码，我在这段代码中发现了无限循环：

```
function extractFootnotes(paragraphs){
    var footnotes=[],currentNum=0;
    function dealWithFootnote(fragment){
      if(fragment.type=="footnote"){
        currentNum++;
        fragment.number=currentNum;
        footnotes.push(fragment);
        return {type:"reference",number:currentNum};
      }
      else{
        return fragment;
      }
    }
    //run here ,endless loop happened.I've tested forEach,the i++ can't work.
    forEach(paragraphs,function(paragraph){
      paragraph.content=map(dealWithFootnote,paragraph.content);
    });

    return footnotes;
  }

  function forEach(array,action){
    for(i=0;i<array.length;i++)
      action(array[i]);
  }

  function map(func,array){
    var result=[];
    forEach(array,function(element){
      result.push(func(element));
    });
    return result;
  } 
```

为什么会发生这种情况以及如何减少我的代码？谢谢。

[我的实践代码](http://jsbin.com/exusox/3/edit "我的实践代码")

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:57:58.040

“forEach”函数中的变量“i”是一个**全局变量**。你应该声明它`var`：

```
function forEach(array, action) {
  var i;
  // ... etc
} 
```

因此，当对“forEach”的调用涉及一个本身将调用“forEach”的操作时，相同的变量“i”将被重置。

将它放在代码的顶部是个好主意：

```
"use strict"; 
```

这告诉解释器对代码应用一些更新的规则，它会向你显示这样的错误。

# web-services - 如何使用 vbscript 调用 Web 服务调用

> ID：14486174
> 
> 赞同：1
> 
> 时间：2013-01-23T17:52:37.973
> 
> 标签：web-services, vbscript, xmlhttprequest

我是编码的初学者。

我必须调用下面的网络服务： [http ://www.w3schools.com/webservices/tempconvert.asmx?op=CelsiusToFahrenheit](http://www.w3schools.com/webservices/tempconvert.asmx?op=CelsiusToFahrenheit)

输入像 25 这样的值，然后单击 Invoke 会返回华氏温度。

为此，我使用了以下代码：

```
url = "http://www.w3schools.com/webservices/tempconvert.asmx?op=CelsiusToFahrenheit&Celsius=25"
'Set oHttpReq = CreateObject("Microsoft.XMLHTTP") 'when i use XMLHTTP i am getting error saying "The download of the specified resource has failed."

Set oHttpReq = CreateObject("MSXML2.ServerXMLHTTP") 'If i use it, the response contains Root Element missing

oHttpReq.open "POST", url, False
oHttpReq.send

'Response
responseText = oHttpReq.responseText 

WScript.echo responseText 
```

谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-08T22:38:50.347

在 file.vbs（visual basic 脚本）处创建 用外部工具编译到 exe 在服务器任务集这个。

```
Const HOST = Sample service in IIS
Const URL = "wsPage.asmx"

Set xmlhttp = CreateObject("Microsoft.XMLHTTP")
xmlhttp.open "POST", HOST & URL & "/wsServiceTest", false

'Set the Content-Type header to the specified value
xmlhttp.setRequestHeader "Content-Type", "application/x-www-form-urlencoded"

' Send the request synchronously
xmlhttp.send "" 
WScript.Echo "Load ok..." 
```

# salesforce - Salesforce 字段级别访问权限由第三个变量确定

> ID：14486182
> 
> 赞同：0
> 
> 时间：2013-01-23T17:53:23.100
> 
> 标签：salesforce

对于联系人对象，我有一个自定义复选框，表示联系人所有者是否希望联系人信息（电子邮件和电话）可见。我们的大多数联系人对每个人都是完全可见的。但是，对于一些联系人，我们希望他们可见，但他们的联系信息需要对所有人隐藏，除了所有者。

有没有办法根据另一个变量设置字段级访问？如果联系信息可见，您能否创建一个工作流以重定向到另一个页面布局？如果是这样，您能否根据您是否是记录所有者将对象限制为某些字段布局？“隐藏联系人”的联系信息还会出现在报告中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T09:28:02.773

If I understood correctly (My english...) You could create a new RecordType and a new customized page layout without this fields assigned to it, then you have to create a WFR that change the Recordtype when the cheked field becomes true.

I'm assuming that you know how you have to give permissions to this new Recordtype...etc

Hope this helps.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:34:50.447

重定向、自定义 Visualforce 视图页面等 hack 都非常漂亮和闪亮，直到您意识到人们将能够通过一些报告、列表视图、Outlook 集成、移动应用程序等提取他们想要的数据；）

没有直接的答案，因为字段可见性实际上是“全有或全无”（通过配置文件和权限集）。仅当您将数据存储在一些新的相关对象中时，与所有者/角色相关的内容才会对您有所帮助。

另一种选择 - 将公共部分存储在潜在客户中（例如，公共只读）和敏感部分 - 在联系人（私人）中？一些查找以链接 2，可能是创建新联系人时的触发器，你很高兴。

最后但并非最不重要的一点 - 看看[https://salesforce.stackexchange.com/questions/777/can-i-grant-different-field-level-security-based-on-record-ownership](https://salesforce.stackexchange.com/questions/777/can-i-grant-different-field-level-security-based-on-record-ownership)的一些想法。

# c - 如何将参数从execl传输到scanf？

> ID：14486185
> 
> 赞同：0
> 
> 时间：2013-01-23T17:53:29.727
> 
> 标签：c, execution

我想将一些参数从一个程序传输到另一个程序。

例如，这里有两个程序。ac 编译为

```
#include <stdio.h>

int main() {
    char a[10];
    scanf("%s", a);
    printf("%s\n", a);
    return 0;
} 
```

和 ec 编译为 e：

```
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>

int main() {
    char *input = "here it is";
    execl("./a", "a", "a",  NULL);
    return 0;
} 
```

实际上，我想将参数“a”从 ec 传输到 ac，这样一旦我执行程序“e”，它就会打印出来

```
 a
 a 
```

但是，我发现`excel`无法将参数传递给指定的程序。

如果我无法修改程序 ac，我如何使用另一个使用标准输入的程序执行该程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:04:16.803

如果无法修改`a.c`，则需要将数据写入某个文件，然后重置标准输入以从该文件中读取：

```
FILE *fp = fopen("somefile", "w");
if (fp == NULL)
    // handle error
fputs(input, fp);
fclose(fp);

if (freopen("somefile", "r", stdin) == NULL)
    // handle error
unlink("somefile");
execl("./a", "a", NULL); 
```

系统`unlink`调用确保文件在`a`完成后消失。

注意：您可能可以使用管道而不是文件，因为消息太小以至于它可以放入管道的缓冲区中。但是，对于较大的消息，这不是一个可靠的解决方案——如果你想使用管道，你需要`fork`.

# architecture - 如何在限制访问的同时将 WebApi 和 WebApp 发布到两个域中？

> ID：14486189
> 
> 赞同：0
> 
> 时间：2013-01-23T17:53:38.450
> 
> 标签：architecture, asp.net-mvc-4, asp.net-web-api, iis-7.5

我有一个具有以下结构的 Web 项目项目：

```
网络项目
- 控制器
    - API
        - 订阅控制器
        - 用户控制器
    - 订阅控制器
- 意见
    - 订阅
        - 确认.cshtml
        - ConfirmationSuccessfull.cshtml   

```

假设我正在处理订阅，因此我的 API 公开了创建新订阅或取消订阅的方法。这些方法是从外部应用程序调用的。

作为要求的一部分，用户需要确认他的订阅。这是通过访问 URL 完成的，在确认后，用户将获得一个成功页面。

问题来了：我希望 API 在一个地址中公开，例如（http://api.myapp.com/subscription -> 订阅 api 控制器），项目的确认部分在另一个地址（http:// /myapp.com/subscription/confirm -> 用于订阅确认），但我**不**希望能够访问 API url 中的网站部分，反之亦然。

我考虑过以两种不同的方式限制这一点：

1.  将应用程序保留在一个 IIS 站点中，同时响应两个域并检查请求附带的主机标头并查看路由的位置。如果来自 api 域的网站调用返回 404。这里的问题是域限制在代码中有些“硬编码”，并且还必须在代码中处理这种基础设施。
2.  将应用程序分离在两个不同的 webproject 中，并将它们部署在 IIS 中的不同网站中。这是处理需求的最简洁的方法，但它带来了我不想处理的复杂性。我将不得不使用两个不同的代码和部署过程来管理两个不同文件夹中的两个不同站点。

那么，是否有第三种选择，最好是两全其美？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T08:56:50.020

选项 1 实施起来非常简单，并且不需要任何真正的基础设施。只是一个简单的自定义路由约束。[我试图在上一个问题How to configure Webapi Selfhosted for multiple HostHeaders](https://stackoverflow.com/questions/13882811/how-to-configure-webapi-selfhosted-for-multiple-hostheaders/13891801#13891801)中展示如何使用主机头来控制路由。

# python - 练习 14 艰难地学习 Python

> ID：14486196
> 
> 赞同：1
> 
> 时间：2013-01-23T17:54:18.647
> 
> 标签：python, windows, python-2.7

以下是练习中的代码：

```
from sys import argv

script, user_name = argv
prompt = '> '

print "Hi %s, I'm the %s script." % (user_name, script)
print "I'd like to ask you a few questions."
print "Do you like me %s?" % user_name
likes = raw_input(prompt)

print "Where do you live %s?" % user_name
lives = raw_input(prompt)

print "What kind of computer do you have?"
computer = raw_input(prompt)

print """
Alright, so you said %r about liking me.
You live in %r.  Not sure where that is.
And you have a %r computer.  Nice.
""" % (likes, lives, computer) 
```

现在我正在运行 Windows 7，并且正在使用代码运行 CMD 行

```
python ex14.py myname 
```

我收到此错误：

```
File "ex14.py", line 3
Python ex14.py, user_name
SyntaxError: invalid syntax 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T19:05:09.250

可见字符中[的脚本没有任何问题](http://ideone.com/duSzIv)。

*   检查源中没有 Unicode 空格，例如[NO-BREAK SPACE](http://unicode.org/cldr/utility/character.jsp?a=a0&B1=Show)字符。在同一目录中创建一个新脚本：

```
with open('ex14.py', 'rb') as file:
     s = file.read()
     print(repr(s)[:60])
     u = s.decode('ascii') # this line should raise an error
                           # if there are bytes outside ascii 
```

*   检查 Python 版本以确保它是 2.7（正确解释错误消息）：

    ```
    $ python -V 
    ```

*   检查文件是否未使用 utf-16/32 编码保存（@abarnert 在评论中的建议）。

    `'\x00'`在这种情况下，您应该在`repr()`结果中看到许多零字节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-23T14:21:24.940

安装 python2 和终端类型

> python2 ex14.py 我的名字

将解决您在最新 python 版本中运行脚本的问题，并且代码的语法适用于 python 版本 2，这就是您收到语法错误的原因

# opengl - GLUquadricObj 是否可在一次 gluNewQuadric 和 gluDeleteQuadric 调用中重用？

> ID：14486199
> 
> 赞同：0
> 
> 时间：2013-01-23T17:54:47.947
> 
> 标签：opengl, glut, glu

我刚刚从问题 #6663300 中读到 glut 函数不正确，我应该使用 glu 绘图原语而不是 glut 绘图原语。

所以我对如何使用 GLUquadricObj 有一些疑问。无论我走到哪里，GLUquadricObj 通常用作指针，然后在 1 个绘图阶段结束时创建和销毁新实例。是否有任何给定时间在没有指针的情况下使用 GLUquadricObj，以便将 GLUquadricObj 的引用传递给 gluCylinder 之类的函数？

对于第二个问题，假设我有一个不断更新的动画，它会一直持续到他的程序关闭，我应该为绘制的每一帧创建和删除 GLUquadricObj 吗？或者我可以只留下一个 GLUquadricObj ，然后在程序关闭时将其删除？如果我只想在整个动画中保留 1 个 GLUquadricObj 指针，是否需要使用绘图列表？

GLUquadricObj *qobj = 0; qobj = gluNewQuadric();

gluCylinder(qobj, CylinderRadius, CylinderRadius, length, Slices, stacks);

gluDeleteQuadric(qobj);

让 GLUquadricObj 是全局的而不是本地的是否更有效？或者我应该让 GLUquadricObj 在绘制的框架内被创建和销毁？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:25:12.250

> is there any given time where GLUquadricObj is used without pointer so that you pass reference of the GLUquadricObj into functions like gluCylinder?

I don't think so. declaring a GLUquadricObj variable probably doesn't set its internal state correctly, so don't do it. (although i haven't looked at the glu source so i can't say for sure)

> is it any more efficient to have the GLUquadricObj being global rather than local?

Probably very slightly.

> or should I just leave GLUquadricObj being created and destroyed within a drawn frame?

Yes. Don't worry about efficiency if you are only learning opengl, the difference this change would make is completely undetectable. Just leave it the way it is.

# sql - 不等于运算符不返回正确的结果 sql

> ID：14486213
> 
> 赞同：0
> 
> 时间：2013-01-23T17:55:31.123
> 
> 标签：sql, compare, equals

我有这个查询，我想得到所有在 2008 年 2 月 12 日没有处理订单的 empids

```
Select Distinct E.empid, lastname, firstname 
    From HR.Employees as E
    INNER JOIN Sales.Orders as O
    ON E.empid = O.empid 
    Where O.orderdate <> Convert(datetime,'02/12/2008',101) 
```

使用 NOT IN、EXISTS 或集合运算符不适用，有人能给我一个真正的解决方案和解释吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:32:20.960

一种方法是使用左外连接：

```
Select Distinct E.empid, lastname, firstname 
From HR.Employees as E left outer join
     Sales.Orders as O
     ON E.empid = O.empid and O.orderdate = Convert(datetime,'02/12/2008',101)
where o.orderdate is NULL 
```

如果员工与该日期的订单匹配，则该`where`子句将忽略这些记录。

此查询正在改写您的逻辑。你说“我想得到所有在 2008 年 2 月 12 日没有处理订单的 empids”。它的工作方式是它实际上将员工与该日期的订单相匹配。但是，因为它使用 a `left outer join`，所以匹配项在没有匹配项时会留下 NULL。这些是您想要的。

从某种意义上说，这个查询回答了等价的问题，表述为“我想要所有在某某日期未能匹配订单的 empids”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:03:32.000

```
Select E.empid, lastname, firstname 
    From HR.Employees as E
WHERE NOT EXISTS (SELECT O.Empid FROM Sales.Orders as O
    WHERE O.empid = E.EmpID
    AND O.orderdate = '02/12/2008') 
```

编辑：假设 Orders 表不会有给定日期的员工谁没有处理它的记录。

```
Select E.empid, lastname, firstname, MAX(O.OrderDate) 
    From HR.Employees as E LEFT JOIN Sales.Orders as O
    ON O.empid = E.EmpID
    WHERE O.orderdate = '02/12/2008'
GROUP BY E.empid, lastname, firstname
HAVING MAX(O.OrderDate) IS NULL 
```

EDIT2：我没有试过这个。我希望您了解使用`LEFT JOIN`,`MAX`和`HAVING`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:05:05.977

仅进行日期比较时，您应该使用 trunc。试试这个

```
Select Distinct E.empid, lastname, firstname 
    From HR.Employees as E
    INNER JOIN Sales.Orders as O
    ON E.empid = O.empid 
    Where trunc(O.orderdate) <> trunc(TO_DATE('02/12/2008','MM/DD/YYYY')) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T18:08:55.823

对于 Sql 服务器：

我认为问题出在你的`date format`. 尝试改用 ISO 格式 ( `yyyymmdd`)。此外，由于您没有任何时间在右边，`o.orderdate should be a date type field` 否则您将其转换为`convert(date,O.orderdate) <> Convert(date,'20081202')`;

```
Select Distinct E.empid, lastname, firstname 
From HR.Employees as E
INNER JOIN Sales.Orders as O
ON E.empid = O.empid 
Where convert(date,O.orderdate) <> Convert(date,'20081202') 
```

# mysql - 尝试仅在 mysql 中创建变量变量。（不使用 PHP）

> ID：14486217
> 
> 赞同：0
> 
> 时间：2013-01-23T17:56:02.580
> 
> 标签：mysql, mysqli, mysql-insert-id

## 语境

我有一个动态生成的 .sql 文件，其中包含一系列插入语句，这些语句将用于将数据插入到许多依赖于其他表的不同表中。

运行每个插入语句后，如果特定表具有自动递增的 id 列，则文本“SET @autoIncrementColumnName = LAST_INSERT_ID();” 生成该插入语句的最后一个插入 id 存储在 mysql 变量中。然后，如果该特定表有另一个 INSERT 语句，则重复该过程。问题是每个语句“SET @autoIncrementColumnName = LAST_INSERT_ID();” 覆盖前一个变量，然后才能在 .sql 文件中使用该变量。

所以稍后在 .sql 脚本中，您会看到如下两行：

```
INSERT INTO relatedTable (col1,col2,specialColumn,col3,col4) VALUES ('','',@autoIncrementColumnName,'','');

INSERT INTO relatedTable (col1,col2,specialColumn,col3,col4) VALUES ('','',@autoIncrementColumnName,'',''); 
```

它需要插入它之前存储的 mysql 值，但所有变量都被覆盖，除了一个。

## 两个问题

1.  是否可以仅使用 MYSQL 创建变量变量？像这样：

    ```
    SET @dynamicVarName = CONCAT('guestCreditCardId', LAST_INSERT_ID()); 
    SET @@dynamicVarName = LAST_INSERT_ID(); 
    ```

2.  如果变量变量是不可能的，我可以使用什么解决方案？

## 太感谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T21:41:59.213

## 回答

在深入研究手头的问题时，我发现我可以通过创建多个函数/方法来避免头痛，每个函数/方法负责 sql 生成的特定部分。这样以后，如果您需要创建另一个动态 sql 语句，您可以通过从任何需要的地方调用另一个函数/方法来将其放置在需要的地方。

## 例如

如果您有 5 个要为其生成“INSERT INTO”sql 语句的表，其中 3 个表的记录未用于创建其他动态 sql 语句，那么您可以让一个函数/方法处理所有不使用的表'不需要来自其他表的数据。

## 对于任何特殊情况

然后为特殊情况创建单独的函数/方法。

## 希望这对某人有所帮助！

# sql - 当一个结果大于另一个结果时求和大小写

> ID：14486220
> 
> 赞同：0
> 
> 时间：2013-01-23T17:56:10.833
> 
> 标签：sql, report, sum, case

我正在使用 SQL 报告生成器并希望在周转时间内计算百分比

我的桌子看起来像

```
Name  count  within tat
jeff   1      1
jeff   1      0
jeff   1      1
jeff   1      0 
```

我希望它看起来像这样。

```
Name  count  within tat
jeff   4     2 (50%) 
```

我用来在 tat 内计算的代码是

```
case
when (convert(Decimal(10,2),
    (cast(datediff(minute,
        (CAST(RequestDate AS DATETIME) + CAST(RequestTime AS DATETIME)), 
    REQUEST_TESTLINES.AuthDateTime)as float)/60/24))) > 
    EXP_TAT then '1' else '0' end as [withintat] 
```

我怎样才能总结这一列？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:11:42.183

你在找这样的东西吗？

```
select name , sum(count) total, sum(within_tat)*100 /sum(count) as percent

from Table1
Group by name 
```

[**看演示 SQLFIDDLE**](http://sqlfiddle.com/#!2/8d6a6/4)

编辑。

或者，如果你想要它，你想试试这个

```
 select name , sum(count) as total, CONCAT(sum(within_tat),' ' ,'(',sum(within_tat)*100 /sum(count),  '%',')' ) as percent

from Table1
Group by name 
```

[**在这里查看演示**](http://sqlfiddle.com/#!2/8d6a6/9)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:12:11.220

你可以把它包在另一个`SELECT`.

```
SELECT SUM(count), SUM(withintat)
FROM (/*Your original query*/) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:43:48.490

是的，您可以在 sum() 中使用 case 语句

但它需要返回一个数字..

你的“in tat”变成了类似的东西

```
select case when (convert(Decimal(10,2),
                 (cast(datediff(minute,
                 (CAST(RequestDate AS DATETIME) + CAST(RequestTime AS DATETIME)), 
                 REQUEST_TESTLINES.AuthDateTime)as float)/60/24))) > 
                 EXP_TAT 
            then 1 
            else 0 end as [withintat]
        .... 
```

但是，如果您需要总和和百分比。

您将需要使用此值两次。

而且我确定您不想保留复制代码。

所以使用你的实际查询作为子查询来总结它可能是一个好主意......

如果您真的不想将其用作子查询

你应该使用外部应用来收集 intat 的值，做这样的事情

```
 select Name
       ,count(*) as [count]
       ,sum(OA.[withintat]) as [withintat]
       ,sum(OA.[withintat])*100/count(*) as [percent]
       ,cast(sum(OA.[withintat]) as varchar(max))+' ('+cast(sum(OA.[withintat])*100/count(*) as varchar(max))+' %)' as [withintat_and_percent]
 from your_actual_query
 outer apply(select case when (convert(Decimal(10,2),
                              (cast(datediff(minute,
                              (CAST(RequestDate AS DATETIME) + CAST(RequestTime AS DATETIME)), 
                              REQUEST_TESTLINES.AuthDateTime)as float)/60/24))) > EXP_TAT 
            then 1 
            else 0 end as [withintat]
 )OA
 where .... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T18:52:52.230

在这种情况下我会使用 an `IF`（双关语除外）。我试图降低您比较的复杂性，但没有看到一些实际数据，这是一个最好的猜测。

```
 select 
   name, 
   count(name) as count, 
   concat(
      sum(if(datediff(minute, 
             (cast(RequestDate AS DATETIME) + 
              cast(RequestTime AS DATETIME)),
             REQUEST_TESTLINES.AuthDateTime) / 60 / 24 > EXP_TAT, 1, 0 )),
      ' (',
      format(
         (sum(if(datediff(minute, 
                 (cast(RequestDate AS DATETIME) + 
                  cast(RequestTime AS DATETIME)),
                 REQUEST_TESTLINES.AuthDateTime) / 60 / 24 > EXP_TAT, 1, 0 )        
            )/count(name))*100,1),
      '%)'
   ) as 'within tat' 
```

# sql-server - 比较 SSIS 包的 OLE 源中的日期

> ID：14486221
> 
> 赞同：0
> 
> 时间：2013-01-23T17:56:13.260
> 
> 标签：sql-server, ssis, datediff

我正在尝试创建一个 SSIS 包，它通过根据包变量 (User::LastUpdate) 检查表中的日期字段 (MODIFYDATE) 从数据库中提取一组记录。MODIFYDATE 等于或在 LastUpdate 之后的记录被选中。

我已经尝试了这两种方法，使用 DateDiff 和返回一点的 UDF（两者都使用 Second 作为间隔），并且两种方式都遇到了同样的问题。日期匹配似乎推迟了两天。

如果 LastUpdate 设置为 1/22/2013 0:00，则应返回两条记录，一条 MODIFYDATE 为 1/22/2013 14:47，另一条 MODIFYDATE 为 1/22/2013 15:34。但除非 LastUpdate 设置不迟于 2013 年 1 月 20 日 12:00，否则这些都不会返回。如果它设置得比这更早，它们都会被退回。如果以后，两者都不会被退回。

这些行正在 SSIS 包中的 OLE DB 源组件中提取。如果我进入查询生成器并从那里运行查询，手动提供日期，则会返回正确的行。我插入了一个断点并确认 LastUpdate 包含正确的提取行日期（LastUpdate 的值由包中较早的存储过程提供）。

这是现在的查询。

```
SELECT ACTIVITIES.*
FROM ACTIVITIES LEFT OUTER JOIN
ArchivedEvents ON ACTIVITIES.FBC_EVENTSID = 
    ArchivedEvents.FBC_EVENTSID
WHERE (dbo.IsDateInOrder(?, ACTIVITIES.MODIFYDATE) = 1) OR
(dbo.IsDateInOrder(?, ArchivedEvents.MODIFYDATE) = 1) 
```

我创建的功能

```
CREATE FUNCTION [dbo].[IsDateInOrder] 
(
    @Date1 DateTime,
    @Date2 DateTime
)
RETURNS bit
AS
BEGIN
    DECLARE @retval bit

    if DATEDIFF(s, @Date1, @Date2) >= 0
        SET @retval = 1
    else
        SET @retval = 0

    RETURN @retval

END

GO 
```

# android - Nexus One 中的 SupportMapFragment

> ID：14486223
> 
> 赞同：1
> 
> 时间：2013-01-23T17:56:18.413
> 
> 标签：android, google-maps-android-api-2, nexus-one, supportmapfragment

我在将旧`Google Nexus One`的与新的混合时遇到了一些问题`SupportMapFragment`。

在特定的**景观视图**中，我有`HorizontalScrollView`一个*地图*和*一些信息*，您必须滚动才能真正看到信息。

问题是滚动使（不知何故我现在无法理解）`SupportMapFragment`的背景可见（默认情况下似乎是黑色），而实际上滚动整个视图

图片来说明我的意思。

![行为演示](../Images/3ddc12722b5e75d75440862c126fc363.png)

尽管不是完全相同的问题，但在[gmaps-api-issues中有一个类似的报告错误](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4639)

* * *

所以，到目前为止我已经测试过：

*   将背景设置为`@color/transparent`，甚至以`XML`和/或以编程方式。
*   更改`SupportMapFragment`z 顺序

在调用我的地图**之前**设置此代码：

```
GoogleMapOptions op = new GoogleMapOptions();
op.zOrderOnTop(true);
SupportMapFragment.newInstance(op); 
```

所以我没有主意了。我已经成功地测试了相同的确切代码：

*   `Galaxy Nexus`
*   `HTC Desire HD`
*   `Samsung Galaxy S3`
*   `Samsung Galaxy Mini`
*   `Galaxy Ace`

编辑：有趣的是，截屏让我意识到捕捉我的具体情况是不可能的。截屏时，只能通过再次更改为纵向和横向来重现错误。

有任何想法吗？我错过了什么明显的东西吗？

提前感谢您的评论。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T18:59:33.283

我有一个[非常相似的问题](https://github.com/jfeinstein10/SlidingMenu/issues/168)，但是当我添加[SlidingMenu 库时，我通过](https://github.com/jfeinstein10/SlidingMenu)[在此评论上](https://github.com/jfeinstein10/SlidingMenu/issues/168#issuecomment-11834105)使用 hack 来修复它

```
public class MyMapFragment extends SupportMapFragment() {

   @Override
   public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
       View view = super.onCreateView(inflater, container, savedInstanceState);
       setMapTransparent((ViewGroup) view);
       return view;
   };

   private void setMapTransparent(ViewGroup group) {
       int childCount = group.getChildCount();
       for (int i = 0; i < childCount; i++) {
       View child = group.getChildAt(i);
       if (child instanceof ViewGroup) {
           setMapTransparent((ViewGroup) child);
       } else if (child instanceof SurfaceView) {
           child.setBackgroundColor(0x00000000);
       }
   }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-19T09:33:23.310

只是为了添加 Robert Estivill 的答案 - 最好不要在 >= 4.1 的设备上运行代码，因为它们没有问题。

稍作修改的版本：

```
public class FixMapFragment extends SupportMapFragment {

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View view = super.onCreateView(inflater, container, savedInstanceState);

        // Fix for black background on devices < 4.1
        if (android.os.Build.VERSION.SDK_INT < android.os.Build.VERSION_CODES.JELLY_BEAN){
            setMapTransparent((ViewGroup) view);
        } 
        return view;
    }

    private void setMapTransparent(ViewGroup group) {
        int childCount = group.getChildCount();
        for (int i = 0; i < childCount; i++) {
            View child = group.getChildAt(i);
            if (child instanceof ViewGroup) {
                setMapTransparent((ViewGroup) child);
            } else if (child instanceof SurfaceView) {
                child.setBackgroundColor(0x00000000);
            }
        }
    }
} 
```

我会将此放在评论中，但我没有足够的代表

# ruby-on-rails - 如何重用 Rails 中嵌套控制器的渲染动作？

> ID：14486224
> 
> 赞同：0
> 
> 时间：2013-01-23T17:56:18.753
> 
> 标签：ruby-on-rails, view, controller, reusability

我有一个关于控制器操作之间代码重用的问题。我认为这是一个相当标准的情况，所以我对 Rails 的最佳实践很感兴趣。

假设我有一个`films`具有相应 的资源，该资源具有由`FilmsController`提供的嵌套资源。嵌套资源可以使用其和操作自行呈现。但是，也应该可以渲染嵌入在相应电影页面中的评论。`comments``CommentsController``index``show`

现在，问题来了，从`CommentsController`内部重用代码的最佳方法是什么`FilmsController.show`？

1）强制`CommentsController.index`渲染为字符串，然后将其以变量形式传递给电影视图？

或者2）`CommentsController.index`直接在电影视图中调用作为一种“部分”，从那里执行数据库查询？

或者3）创建一个`CommentsController`负责数据库处理的单独方法，从两者调用它，`CommentsController.index`并`FilmsController.show`在这两个地方使用相应的视图？

对我来说，选项 1) 和 2) 似乎有点混乱，而 3) 不是模块化的，并且涉及一些代码重复。有没有更好的方法来实现这一点？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:02:02.657

> 现在，问题来了，在 FilmsController.show 中重用 CommentsController 代码的最佳方法是什么？

您可以将共享控制器逻辑移动到应用程序控制器内部（或 lib 并适当地要求它），例如：

```
class ApplicationController < ActionController::Base

  def foo
    @foo = "foo"
  end

end 
```

评论控制器：

```
class CommentsController < ApplicationController

  before_filter :foo, :only => [:index]

  def index    
  end

end 
```

电影控制器：

```
class FilmsController < ApplicationController

  before_filter :foo, :only => [:show]

  def show
  end

end 
```

对于重复的视图逻辑，您可以将其移动到一个公共文件夹中，`your_app/app/views/shared/_foo.html.erb`并适当地进行渲染。

* * *

另一种选择是将相关代码放入外部模块中：

**lib/mymodule.rb**

```
module MyModule
  def foo
  end
end 
```

然后您可以将模块包含在您的控制器中或您想要访问您的`foo`方法的任何地方。

```
class CommentsController < ApplicationController
  include MyModule

    def index
      foo()
    end

end 
```

# java - XStream 如何选择它的转换器？

> ID：14486225
> 
> 赞同：3
> 
> 时间：2013-01-23T17:56:20.860
> 
> 标签：java, converter, xstream

我能找到的关于 XStream 转换器的唯一文档在这两个页面上：

*   [教程](http://x-stream.github.io/converter-tutorial.html)
*   [所有已发货转换器的列表](http://x-stream.github.io/converters.html)

当 XStream 解析 XML 输入时，它使用 a [`ConverterLookup`](http://xstream.codehaus.org/javadoc/com/thoughtworks/xstream/converters/ConverterLookup.html)（默认为 a `DefaultConverterLookup`）来查找要按类使用的转换器。我想将我的`XStream`映射器配置为使用我自己的 custom `ConverterLookup`，但只看到一个`getConverterLookup()`方法，而不是相应的设置器。

我有一个实例，其中 XStream`Date`在 XML 中遇到一个值，并使用相应的`DateConverter`. 我希望它使用不同的转换器，这（我相信）意味着我需要设置/注册我自己的`Converter`impl。只是无法弄清楚如何做到这一点。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T19:29:10.510

首先，您的问题实际上是两个不相关的问题，我会尽力回答它们。

**转换器**

关于日期转换的第二个问题。在我看来，这似乎就是你在这里的原因。

添加自己的转换器的基本方法相当简单，该方法`registerConverter`应该会给您一个线索。如果您想知道如何实现，`Converter`我建议您查看 XStream 已经提供的众多转换器之一。另外，我觉得我必须提到转换器的优先级。

> 可以使用明确的优先级注册转换器。默认情况下，它们使用 XStream.PRIORITY_NORMAL 注册。相同优先级的转换器将按其注册的相反顺序使用。默认转换器，即如果没有其他已注册的转换器适用时将使用的转换器，可以使用优先级 XStream.PRIORITY_VERY_LOW 进行注册。XStream 默认使用 ReflectionConverter 作为后备转换器。

换句话说，给定两个接受相同类的转换器，将使用最后添加的那个。

**转换器查找**

要回答如何使用您`ConverterLookup`的方法，有两种方法可能会产生相同的结果，我个人会选择替代方法 2。

**1)**覆盖`getConverterLookup`

```
 XStream xs = new XStream(){
        @Override
        public ConverterLookup getConverterLookup() {
            return new ConverterLookup() {

                public Converter lookupConverterForType(Class type) {
                    //Do your magic here
                }
            };
        }
    }; 
```

**2)**使用`Mapper`

在这种情况下，我会为我的新映射保留`DefaultMapper`并实现's。`MapperWrapper`（查看`buildMapper`内部`XStream.java`以查看一些默认值）像这样初始化：

```
 ClassLoader classLoader = new ClassLoaderReference(new CompositeClassLoader());
    Mapper mapper = new DefaultMapper(classLoader);
    mapper = new MyOwnMapperWrapper(mapper);
    XStream xs = new XStream(null, mapper, new XppDriver()); 
```

# javascript - 获取body id的值并作为变量存储在js中

> ID：14486227
> 
> 赞同：5
> 
> 时间：2013-01-23T17:56:33.947
> 
> 标签：javascript, getelementbyid

我需要根据正文标签 ID 更改页面内的某些内容。

我的代码似乎不起作用，你能帮忙吗？

```
function changeHeaderTitle(){
    var bodyId = document.getElementsByTagName("body").id;
    alert(bodyId);
} 
```

这只是呼应“未定义”。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-23T18:00:26.220

`getElementsByTagName`返回节点集合，即使集合只包含一个元素。尝试

```
var bodyId = document.getElementsByTagName("body")[0].id;
// select the first (and only) body:              ^^^ 
```

或者更好

```
var bodyId = document.body.id; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T18:00:27.597

是的，试试这个：

```
 document.getElementsByTagName("body")[0].id 
```

因为`getElementsByTagName`返回一个数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T18:09:08.537

document.getElementsByTagName('body')[0].id

请注意，getElementsByTagName 返回一个 obj 数组

# javascript - 正则表达式逗号分隔列表包含九位电话号码

> ID：14486230
> 
> 赞同：2
> 
> 时间：2013-01-23T17:56:57.760
> 
> 标签：javascript, regex, phone-number

我对正则表达式有一个很小但很烦人的问题。我想为包含九位电话号码的逗号分隔列表查找正则表达式，例如：

通行证：123456789,123456789

不通过：123456789,123456789,

到目前为止，我有这样的东西：`/^\d{9}+(,\d{9}\+)\*$/`当然，它可以在这个工具[http://regex.larsolavtorvik.com](http://regex.larsolavtorvik.com/)中工作，但在 javascript 中它不起作用，我认为这是众所周知的错误（对于 Javascript 人）：

```
Invalid regular expression: /^\d{9}+(,\d{9}\+)\*$/: Nothing to repeat 
```

所以，我添加了反斜杠，它看起来像这样：`/^\d{9}\+(,\d{9}\+)\*$/`。当然这个也行不通。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:01:15.903

你正在逃跑`*`，这就是`+`问题`\`所在。

`*`表示匹配前面的字符 0 到多次

`+`表示匹配前面的字符 1 到多次

`{9}`表示匹配前面的字符 9 次..所以不需要`+`在它之后使用

正则表达式应该是

```
/^\d{9}(,\d{9})*$/ 
```

# functional-programming - 如何清理特定字符串的列表并返回清理后的列表或 NONE

> ID：14486231
> 
> 赞同：1
> 
> 时间：2013-01-23T17:56:59.637
> 
> 标签：functional-programming, sml, smlnj

我需要编写一个函数来回答这些规范：

`clean_list( [],s1] = NONE`

`clean_list( xs, "") = NONE`

`clean_list ([s1, s1, s1, s1], s1) = NONE`

`clean_list([s1, s2, s3, s2, s1], s3) = [s1, s2, s2, s1]`

其中`s1`, `s2`,`s3`是一些字符串和`xs`字符串列表。

我可以使用两个辅助函数来做到这一点`is_into(xs: string list, s1: string) -> bool`，`remove(xs: string list, s1: string) -> string list`但是通过列表递归两次似乎很难看。

```
clean_list(xs: string list, s1: string) =
    case (xs, s1) of
         ( [], _ ) => NONE
        |( _, "" ) => NONE
        |( _, _) => if is_into(xs, s1)
                    then remove(xs, s1)
                    else NONE 
```

有没有办法做到这一点，而无需在列表中递归两次（一次`is_into`和一次`remove`）？

注意：不要使用任何内置函数。

抱歉，我忘记了规格中的一个**重要案例**

```
clean_list ([s1, s2, s3, s4], s10] = NONE 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:48:30.977

您的`clean_list`函数不会进行类型检查，因为某些分支具有 type`'a option`而其他分支具有 type `'b list`。

假设你想退货`'b list`，`NONE`应该换成`[]`。您可以递归地使用模式匹配`clean_list`来避免需要辅助函数：

```
fun clean_list(xs: string list, s1: string) =
    case (xs, s1) of
      ([], _) => []
    | (_, "") => []
    | (x::xs', _) => if x = s1 
                     then clean_list(xs', s1)
                     else x::clean_list(xs', s1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:51:05.363

您可以轻松地遍历列表一次，逐个元素并删除与给定字符串匹配的所有内容，最后返回结果列表`SOME lst`在哪里`lst`

```
fun clean_list ([], _ ) = NONE
  | clean_list (_, "") = NONE
  | clean_list (xs, str) =
    let
      fun clean_list' [] = []
        | clean_list' (x::xs) =
          if x = str then
            clean_list' xs
          else
            x :: clean_list' xs
    in
      SOME (clean_list' xs)
    end 
```

**更新**

我注意到上面的代码实际上并没有处理这种情况：`clean_list ([s1, s1, s1, s1], s1) = NONE`. 但是，这是一个简单的解决方法。

我可以看到，鉴于您的新更新规范，如果该元素首先不在列表中，则`NONE`应该返回。这就像说，如果在遍历所有元素时没有删除任何元素，则 return `NONE`。

希望您可以看到，这可以通过向辅助函数添加一个额外的布尔参数来实现，最初将其设置为 false，然后在每次递归调用中传递其值，除非删除元素，这里可以始终设置为 true。

然后可以使用它来确定返回的天气，结果列表`SOME lst`在哪里，或者是否没有删除任何元素。`lst``NONE`

考虑到这两件事，需要修复，让辅助函数在累积参数中建立其结果可能是一个好主意。这样您就可以完全控制，并且可以`NONE`在最后累加列表为空时轻松返回。

# asp.net - DotnetOpenAuth 教程

> ID：14486232
> 
> 赞同：3
> 
> 时间：2013-01-23T17:57:00.707
> 
> 标签：asp.net, asp.net-mvc-4, forms-authentication, dotnetopenauth

有没有关于如何使用 DotNetOpenAuth 库的教程？如何使用 ASP.NET Authentication 附带的数据库并将其扩展为使用 OpenAuth 库？

谢谢

# c - 在 C 中只使用一个大的正则表达式

> ID：14486234
> 
> 赞同：0
> 
> 时间：2013-01-23T17:57:04.010
> 
> 标签：c, regex, pcre

我正在用 C 语言编写一个带有 libpcre 的引擎，该引擎过滤（在我的情况下，过滤器接受或拒绝字符串）以下形式的一些日志行：

```
tok1=foo tok2=bar ... tok3="value with spaces in it" ... 
```

所以，我过滤它们的方法是从用户那里接收一个过滤器字符串，格式如下：

```
"tok1=regex1 tok2=regex2 tok3!=regex3 ..." 
```

一开始，我的引擎解析这个模式，用 pcre_compile/pcre_study 编译所有找到的正则表达式，并将它们存储到哈希表（或基数）中。

```
("tok1"->pcre_regex1, "tok2"->pcre_regex2, "tok3"->pcre_regex3) 
```

（顺便说一下，“！=”运算符用于过滤不包含以下正则表达式的行。）

然后，在过滤阶段本身，对于每个日志行，我从头到尾逐个字符地遍历该行，我得到令牌/值对，如果在我的哈希表中存在相对于令牌的正则表达式，则值必须匹配正则表达式 (pcre_exec) 否则该行被拒绝。

它工作正常。

我的问题是：我非常怀疑，但我想知道是否可以编写一个大的正则表达式，将我所有的正则表达式组合起来过滤行，并考虑到可能的双引号：

```
pcre_exec(my_big_re, NULL, my_whole_log_line, len, 0, 0, NULL, 0) 
```

何，还有一个附属问题：是否可以写任何形式的任何正则表达式的*否定？*（我也很怀疑）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:58:47.347

是的，这是可能的。正则表达式完全等同于有限状态机，对有限状态机求反（使所有接受状态不接受，反之亦然）是微不足道的。但是，您会发现在最坏的情况下这样做会导致正则表达式呈指数级增长。

# c++ - 为什么我的交换方法会干扰 make_move_iterator？

> ID：14486236
> 
> 赞同：1
> 
> 时间：2013-01-23T17:57:06.990
> 
> 标签：c++, c++11, iterator, move-semantics

这让我彻底糊涂了。在下面的示例中，我收到错误：

> 错误 C2664: 'void std::unique_ptr<_Ty>::swap(std::unique_ptr<_Ty> &&)' : 无法将参数 1 从 'const std::unique_ptr<_Ty>' 转换为 'std::unique_ptr<_Ty > &&'

我不知道它是如何以我的交换功能结束的，或者为什么它是一个问题。~~有趣的是，如果我更改签名`void swap(const one& other)`并将 const 删除，`void swap(one& other)`一切正常。~~如果我更改签名`void swap(const one& other)`并删除 const ，`void swap(one& other)`它会在 VS2010 中编译，但在 GCC 中仍然被破坏。如果没有交换重载，则没有问题。

```
//-----------------------------------------------------------------------------
class one
{
public:
    one(){}
    one(one&& other) : x(std::move(other.x)) {}
    one& operator=(one&& other){ x = std::move(other.x); return *this; }

    void swap(const one& other){ x.swap(other.x); }
    void swap(one&& other){ x.swap(std::move(other.x)); }

private:
    one(const one&);
    one& operator=(const one&);

    std::unique_ptr<int> x;
};

//-----------------------------------------------------------------------------
void swap(one& left, one& right)
{
    left.swap(right);
}

//-----------------------------------------------------------------------------
void swap(one&& left, one& right)
{
    right.swap(std::move(left));
}

//-----------------------------------------------------------------------------
void swap(one& left, one&& right)
{
    left.swap(std::move(right));
}

//-----------------------------------------------------------------------------
class two
{
public:
    two(){}
    two(two&&){}
    two& operator=(two&&){ return *this; }

    operator one(){return one();}

private:
    two(const two&);
    two& operator=(const two&);
};

//-----------------------------------------------------------------------------
int main()
{
    std::vector<two> twos(10);
    std::vector<one> ones(std::make_move_iterator(twos.begin()), std::make_move_iterator(twos.end()));
} 
```

**编辑：** 非常量要求是有道理的。完全是我的疏忽。为什么它首先调用交换？

（供参考，我用的是VS2010）

[它的演示坏了](http://ideone.com/DIJiqE)

[它的演示仍然损坏，但这个“修复”在 VS2010 中有效](http://ideone.com/lEdGV1)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:05:23.200

```
// other can't be const since swap modifies it
void swap(one& other){ x.swap(other.x); }

// Why swapping? (swap on rvalues don't work either since it's pointless.)
//Just move the other
void swap(one&& other){ x = std::move(other.x); } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T18:05:31.470

完整的错误信息如下（我引入了一些换行符来防止水平滚动）：

> ```
> error C2664: 'void std::unique_ptr<_Ty>::swap(std::unique_ptr<_Ty> &&)'
>     : cannot convert parameter 1
>         from 'const std::unique_ptr<_Ty>'
>         to 'std::unique_ptr<_Ty> &&'
> with
> [
>     _Ty=int
> ]
> Conversion loses qualifiers 
> ```

错误发生在代码的以下行：

```
void swap(const one& other){ x.swap(other.x); } 
```

`other`是 const 限定的，但`std::unique_ptr::swap`需要一个非常量参数。因此，“转换丢失限定符”（特别是 const 限定符）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T18:07:48.660

这对我来说似乎很简单。当您交换两个对象时，它们都不能是只读的。它们都应该是可修改的，只有这样才能进行交换。

所以你的`swap`函数必须采用非常量引用。

请注意，`std::unique_ptr<T>`它没有`swap`采用*右值*引用的功能。事实上，拥有一个甚至没有多大意义。VS2010 在这方面是非标准的。标准（§20.7.1.2）只需要一个带有这个签名的：

```
void swap(std::unique_ptr<T> &) noexcept; 
```

没有`swap`右值引用。我还建议您删除需要右值引用的交换。它为您的代码增加了不必要的复杂性。

# hibernate - intellij - 从 bean 创建模式和休眠映射

> ID：14486238
> 
> 赞同：1
> 
> 时间：2013-01-23T17:57:07.450
> 
> 标签：hibernate, intellij-idea, mapping, schema

...例如，如果我有以下 bean（作为示例来自[这里](http://www.tikalk.com/java/load-a-tree-with-jpa-and-hibernate)）：

```
@Entity 
@Table(name = "tree") 
public class Node { 

    @Id 
    @GeneratedValue 
    private Integer id; 

    @NotNull 
    private String name; 

    @OneToMany 
    @JoinColumn(name = "parent_id") 
    @OrderColumn
    private List<Node> children = new LinkedList<Node>(); 

    ... 
} 
```

IntelliJ 12.0 Ultimate 中是否可以从 bean 创建模式和休眠映射？我发现了很多关于从现有模式生成 bean 的参考资料，但反之则不然。还是我要求的有点多？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T15:37:21.433

这还不可能，我已经创建了一个新的[功能请求](http://youtrack.jetbrains.com/issue/IDEA-99713)，请开始/投票。

# postgresql - 如何在 PostgreSQL 中导出数据库的模式？

> ID：14486241
> 
> 赞同：146
> 
> 时间：2013-01-23T17:57:18.810
> 
> 标签：postgresql, schema, export

我的电脑坏了，但幸运的是我备份了文件夹 C:\Program Files\PostgreSQL。

现在我在一台新计算机上工作，我想导入以前存储在外部磁盘中的 Postgres 数据库。

我想导出位于备份文件夹中的特定数据库的架构。

该文件`PostgreSQL\8.3\data\global\pg_database`包含有关数据库及其 OID 的信息；例如：

```
"db1" 20012
"db2" 23456 
```

我想导出“db1”的模式。

文件夹中有一个名为“20012”的文件夹`"PostgreSQL\8.3\data\base\20012"` ，其中包含很多文件[500个文件]。

有没有办法导出该数据库的模式？

请注意，所有 Postgresql 数据库文件都位于外部硬盘中，我想将该数据库的模式导出到 SQL 文件中，获取该文件，运行它并在本地创建完全相同的数据库。

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2013-01-23T18:13:08.077

你应该看看`pg_dump`：

```
pg_dump -s databasename 
```

只会将模式作为 .sql 转储到标准输出。

对于 Windows，您可能需要调用`pg_dump.exe`. 我无法访问 Windows 机器，但我很确定这是命令。看看帮助是否也适合您。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2015-07-24T05:41:06.583

在**Linux**中你可以这样做

```
pg_dump -U postgres -s postgres > exportFile.dmp 
```

也许它也可以在**Windows**中工作，如果不能尝试使用**pg_dump.exe**

```
pg_dump.exe -U postgres -s postgres > exportFile.dmp 
```

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2017-08-02T05:05:33.790

I am running Postgres 9.6 where I had to export a particular schema along with data.

I used the following command:

```
pg_dump.exe -U username -d databasename -n schemaname > C:\mylocation\mydumpfilename.dmp 
```

If you want only the schema without data, use the switch `s` instead of `n`

Below is the pg_dump switch list:

```
C:\Program Files\PostgreSQL\9.6\bin>pg_dump --help
pg_dump dumps a database as a text file or to other formats.

Usage:
  pg_dump [OPTION]... [DBNAME]

General options:
  -f, --file=FILENAME          output file or directory name
  -F, --format=c|d|t|p         output file format (custom, directory, tar,
                               plain text (default))
  -j, --jobs=NUM               use this many parallel jobs to dump
  -v, --verbose                verbose mode
  -V, --version                output version information, then exit
  -Z, --compress=0-9           compression level for compressed formats
  --lock-wait-timeout=TIMEOUT  fail after waiting TIMEOUT for a table lock
  -?, --help                   show this help, then exit

Options controlling the output content:
  -a, --data-only              dump only the data, not the schema
  -b, --blobs                  include large objects in dump
  -c, --clean                  clean (drop) database objects before recreating
  -C, --create                 include commands to create database in dump
  -E, --encoding=ENCODING      dump the data in encoding ENCODING
  -n, --schema=SCHEMA          dump the named schema(s) only
  -N, --exclude-schema=SCHEMA  do NOT dump the named schema(s)
  -o, --oids                   include OIDs in dump
  -O, --no-owner               skip restoration of object ownership in
                               plain-text format
  -s, --schema-only            dump only the schema, no data
  -S, --superuser=NAME         superuser user name to use in plain-text format
  -t, --table=TABLE            dump the named table(s) only
  -T, --exclude-table=TABLE    do NOT dump the named table(s)
  -x, --no-privileges          do not dump privileges (grant/revoke)
  --binary-upgrade             for use by upgrade utilities only
  --column-inserts             dump data as INSERT commands with column names
  --disable-dollar-quoting     disable dollar quoting, use SQL standard quoting
  --disable-triggers           disable triggers during data-only restore
  --enable-row-security        enable row security (dump only content user has
                               access to)
  --exclude-table-data=TABLE   do NOT dump data for the named table(s)
  --if-exists                  use IF EXISTS when dropping objects
  --inserts                    dump data as INSERT commands, rather than COPY
  --no-security-labels         do not dump security label assignments
  --no-synchronized-snapshots  do not use synchronized snapshots in parallel jobs
  --no-tablespaces             do not dump tablespace assignments
  --no-unlogged-table-data     do not dump unlogged table data
  --quote-all-identifiers      quote all identifiers, even if not key words
  --section=SECTION            dump named section (pre-data, data, or post-data)
  --serializable-deferrable    wait until the dump can run without anomalies
  --snapshot=SNAPSHOT          use given snapshot for the dump
  --strict-names               require table and/or schema include patterns to
                               match at least one entity each
  --use-set-session-authorization
                               use SET SESSION AUTHORIZATION commands instead of
                               ALTER OWNER commands to set ownership

Connection options:
  -d, --dbname=DBNAME      database to dump
  -h, --host=HOSTNAME      database server host or socket directory
  -p, --port=PORT          database server port number
  -U, --username=NAME      connect as specified database user
  -w, --no-password        never prompt for password
  -W, --password           force password prompt (should happen automatically)
  --role=ROLENAME          do SET ROLE before dump

If no database name is supplied, then the PGDATABASE environment
variable value is used.

Report bugs to <pgsql-bugs@postgresql.org>. 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2018-11-21T10:18:54.133

```
pg_dump -d <databasename> -h <hostname> -p <port> -n <schemaname> -f <location of the dump file> 
```

请注意，您有足够的权限访问该架构。如果您想以特定用户身份进行备份，请在该命令中添加用户名`-U`

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2020-05-04T19:20:35.900

对于**Linux：（**数据除外）

*   `pg_dump -s -t tablename databasename > dump.sql`（对于数据库中的特定表）

*   `pg_dump -s databasename > dump.sql`（对于整个数据库）

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2015-05-28T18:21:38.383

如果你只想要创建表，那么你可以做`pg_dump -s databasename | awk 'RS="";/CREATE TABLE[^;]*;/'`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-01-23T18:25:49.850

设置一个新的 postgresql 服务器并将其数据文件夹替换为外部磁盘中的文件。

然后，您将能够启动该 postgresql 服务器并使用 pg_dump 检索数据（如前所述，pg_dump -s 仅用于模式）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-11-05T12:54:03.390

`pg_dump -s databasename -t tablename -U user -h host -p port > tablename.sql`

这会将模式转储限制为“databasename”的表“tablename”

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-06-25T16:59:34.533

你应该使用这样的东西`pg_dump --schema=your_schema_name db1`，详情请看[这里](https://www.postgresql.org/docs/9.1/static/app-pgdump.html)

# c - 运行客户端时出现“协议不支持的地址”

> ID：14486242
> 
> 赞同：1
> 
> 时间：2013-01-23T17:57:20.030
> 
> 标签：c, sockets, client-server, runtime-error

这是我的问题：我正在编写一个简单的客户端，它将使用服务器的主机名和端口号作为命令行参数连接到服务器。它编译得很好，但是当我运行客户端时，我从 perror() 收到一条消息，上面写着“错误：协议不支持地址族”。不知道为什么我会收到这个错误，但我知道当我调用 connect() 时会发生错误。由于某种原因，connect 无法在我的 sockaddr_in 结构中找到地址族信息。任何帮助将非常感激。

```
int main(int argc, char* argv[])
{
    if(argv[1] == NULL)
    {
        printf("if 1\n");
        perror("Error: argv[1]:hostname\n");
        exit(1);
    }

    struct sockaddr_in* servaddr = getServerInfo(argv[1], argv[2]);
    int socketfd = createSocket();

    if(socketfd < 0)
    {
        printf("if 2\n");
        perror("Error: socketfd\n");
        exit(1);
    }

    int commResult = communicate(socketfd, servaddr);

    if(commResult < 0)
    {
        printf("if 3\n");
        perror("Error: communication\n");
        exit(1);
    }

    return 0;
}

struct sockaddr_in* getServerInfo(char* hostname, char* port)
{
    struct sockaddr_in* servaddr = malloc((size_t)sizeof(struct sockaddr_in));
    struct hostent *hostptr;
    hostptr = gethostbyname(hostname);

    memset((void *) servaddr, 0, (size_t)sizeof(*servaddr));
    servaddr->sin_family = (short)(AF_INET);
    memcpy((void*)& servaddr->sin_addr, (void *) hostptr->h_addr, hostptr->h_length);
    servaddr->sin_port = htons((u_short)atoi(port));

    return servaddr;
}

int createSocket()
{
    int socketfd = socket(AF_INET, SOCK_STREAM, 0);
    if(socketfd < 0)
    {
        return -1;
    }

    return socketfd;
}

int communicate(int socketfd, struct sockaddr_in* servaddr)
{
    char buffer[BUFFERSIZE];

    // connect to the server at the location displayed by TCPserver.c
    if(connect(socketfd, (struct sockaddr*)&servaddr, sizeof(*servaddr)) < 0)
    {
        printf("if 4\n");
        perror("ERROR: connecting to socket\n");
        return -1;
    }

    printf("Connected to server\n");

    strcpy(buffer, "This is the message I want the client to echo on the screen to prove that we can  communicate together.\n");

    write(socketfd, buffer, strlen(buffer)+1); 

    return 0;
} 
```

这里也是服务器代码：

```
int main()
{
char * hostname = malloc(MAXSIZE * sizeof(char));
char buffer[BUFFERSIZE];

struct sockaddr_in* servaddr = getServerInfo(hostname);
int listensockfd = createSocket(servaddr), connsockfd;
printServerInfo(hostname, servaddr);

listen(listensockfd, MAX_NUM_LISTENER_ALLOWED);

connsockfd = accept(listensockfd, NULL, NULL);
read(connsockfd, buffer, BUFFERSIZE);
printf("Message: %s\n", buffer);

// free memory
free(servaddr);
free(hostname);

return 0;
} // End main

struct sockaddr_in* getServerInfo(char* hostname)
{
    struct sockaddr_in* servaddr = malloc((size_t)sizeof(struct sockaddr_in));
    gethostname(hostname, 32);
    struct hostent *hostptr;
    hostptr = gethostbyname(hostname);

        memset((void *) servaddr, 0, (size_t)sizeof(*servaddr));
        servaddr->sin_family = (short)(AF_INET);
        memcpy((void *)& servaddr->sin_addr, (void *) hostptr->h_addr, hostptr->h_length);
        servaddr->sin_port = htons((u_short)38000);

    return servaddr;
}

int createSocket(struct sockaddr_in* servaddr)
{
    int listensockfd = socket(AF_INET, SOCK_STREAM, 0);

    bind(listensockfd, (struct sockaddr *) &servaddr, (socklen_t)sizeof(servaddr));

    socklen_t listensocklen = sizeof(servaddr);
    getsockname(listensockfd, (struct sockaddr*)&servaddr, &listensocklen);

    return listensockfd;
}

void printServerInfo(char* hostname, struct sockaddr_in* servaddr)
{
    struct hostent *hostptr;
    hostptr = gethostbyname(hostname);

    printf("Host Name: %s\n", hostname);
    printf("Host IP: %s\n", inet_ntoa(*(struct in_addr*)*hostptr->h_addr_list));
    printf("Port Number: %d\n", htons(servaddr->sin_port));
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:38:33.563

`&`前面有一个 spurious `servaddr`，它已经**是**一个指针。您实际上是将堆栈上指针的地址传递给`connect()`，而不是实际指向`struct sockaddr_in`.

替换这个：

```
 if(connect(socketfd, (struct sockaddr*)&servaddr, sizeof(*servaddr)) < 0) 
```

有了这个：

```
 if(connect(socketfd, (struct sockaddr*)servaddr, sizeof(*servaddr)) < 0) 
```

它会起作用。

在服务器中，对`bind()`和`getsockname()`的调用存在相同的错误`createSocket()`。此外，您使用`sizeof(servaddr)`（这是指针的大小）而不是`sizeof(*servaddr)`在同一函数的两个位置。

请注意，我强烈建议使用现代`getaddrinfo()`API 而不是过时的`gethostbyname()`调用。

# c++ - 有一个与非线程局部变量同名的线程局部变量是否可以？

> ID：14486243
> 
> 赞同：8
> 
> 时间：2013-01-23T17:57:22.333
> 
> 标签：c++, c, thread-local

我有一个线程局部变量`envptr`和非线程局部变量，也称为`envptr`. 后一个变量仅在运行代码看不到线程局部变量声明的单个线程中使用。线程局部变量被不同的线程使用，每个线程看不到也不需要看到非线程局部变量的声明。

这种情况是否可能并产生定义的行为？我在 x86 上使用 linux 32 位和 64 位。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T18:27:36.997

它们是同一个变量吗？换句话说，它们的[联系](http://en.wikipedia.org/wiki/Linkage_%28software%29)是什么？

如果是外部的，那么没有。如果它是内部的，那么*除非这两个定义都出现在同一个文件中，否则就可以了*。

如果没有联动，那么就没有问题。

除非我忽略了某些东西，否则`thread_local`对链接没有影响，所以通常的规则适用（并且`thread_local`在一个翻译单元而不是另一个翻译单元中定义变量是违反单一定义规则的）。

但是，我认为这里的标准存在错误。标准（第 7.1.1/1 节）说“如果 thread_local 出现在变量的任何声明中，它应该出现在该实体的所有声明中。” 没有明确声明不需要诊断，或者违反此规则是未定义的行为，因此需要编译器*来*诊断错误。当然，如果您在命名空间范围内定义：

```
thread_local int i; 
```

在一个翻译单元中，并且：

```
int i; 
```

在另一种情况下，编译器可能无法诊断错误（我很确定委员会不想要求它）。我的猜测是这里的意图是未定义的行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T17:58:49.420

这应该有效，并产生正确的行为，因为变量是两个不同的变量。

我强烈建议不要这样做，因为它只会降低软件的可维护性。这种行为是否正确似乎不如代码的可理解性那么重要——对行为截然不同的两组数据使用相同的变量名似乎是有问题的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-23T18:03:18.757

根据您的描述，听起来它们是两个不同的变量（一个都不会影响另一个），在这种情况下，从技术角度来看它似乎完全可以。

也就是说，我永远不会建议这样做，因为最有可能发生的事情是有人会对未来维护中的含义感到困惑，并且会导致试图理解代码时出现更多问题。

# google-maps - 谷歌地图搜索策略

> ID：14486244
> 
> 赞同：-1
> 
> 时间：2013-01-23T17:57:30.810
> 
> 标签：google-maps, google-maps-api-3, google-maps-markers

我有一个包含坐标、地标名称和描述的 kml 文件。我希望能够搜索此位置数据（地标名称和描述）并在地图上找到精确点。

我想我可以将数据保存在 kml 文件中，也可以将其导入数据库。我对 Google Maps API 相当陌生，想知道你们是否可以为我指出解决这个项目的正确方向。我特别想知道数据是否应该保留在 KML 文件中（或放在数据库中）。此外，是否可以通过 Google Maps API 搜索数据，还是应该使用第三方插件？谢谢！

环境：谷歌地图 API v3、ASP.NET 4.0、MSSQL 2008。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:31:10.217

我建议将数据导入[FusionTable](http://support.google.com/fusiontables)（您只需上传 KML 文件，仅此而已）。

好处：您可以使用[FusionTablesLayer](https://developers.google.com/maps/documentation/javascript/layers#FusionTables)显示几何图形（例如 PlaceMarks） ，它将在服务器端自动创建，并且可以根据需要进行过滤和样式设置。

要在表中搜索，您可以发送类似 SQL 的查询，例如通过 ajax（不需要特殊工具，并且当地图未设置为私有访问时，也不需要授权）

* * *

当您按原样使用 KML（不将其导入 Fusion-Table）时，数据也可能由自动创建的[Layer](https://developers.google.com/maps/documentation/javascript/layers#KMLLayers)显示，但功能无法设置样式，也无法通过 API 实现的方法过滤。

也没有 API 实现的方法来搜索 KML 内的数据，您必须自己解析 KML 才能在其中搜索。

# python - 有没有一种方法可以像我们在 Visual Studio 中创建的那样，使用 Python 的 GUI 和硬锁许可证创建漂亮的可安装应用程序？

> ID：14486253
> 
> 赞同：0
> 
> 时间：2013-01-23T17:58:01.550
> 
> 标签：python, ironpython, nsis, py2exe, pyinstaller

我熟悉 cx_freeze、py2exe 和 pyInstaller，它们将 python 脚本转换为可执行程序，可以进一步与 NSIS 捆绑作为 Windows 安装程序。

但是我在使用这些工具时遇到了问题： 1\. 对于一些 python 模块，如 pandas 和 SimpleCV，可执行文件会给出错误，我试图通过模块开发人员以及上述工具的开发人员来解决这些错误，但没有成功。

有没有一种方法可以像我们在 Visual Studio 中创建的那样，使用 Python 的 GUI 和硬锁许可证创建漂亮的可安装应用程序？

还是我必须用 Csharp 或 CPP 等重写我的 python 程序？

我希望有人能回答，我不确定 IronPython 在这方面是否会有所帮助？

**编辑：**我尝试了 IronPython，但是在 2.7 中我不能像我提到的那样导入许多 python 模块。如果哪位知道的好，请指点......

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-24T07:26:39.400

**如果您想集成 NSIS 和 Visual Studio，请使用名为Visual & Installer**的第三方插件：[http ://www.unsigned-softworks.sk/visual-installer/index.html](http://www.unsigned-softworks.sk/visual-installer/index.html)

使用 Visual Studio 2005/2008/2010 和 2012 工作正常。

# python - Python CSV与乘法比较

> ID：14486256
> 
> 赞同：0
> 
> 时间：2013-01-23T17:58:12.027
> 
> 标签：python, csv, import, percentage, multiplication

我想仔细检查我的逻辑如何在 Python 中将它们组合在一起，因此非常感谢示例。

我需要比较 2 个 CSV 文件（格式完全相同，2 行 6 列）并提供差异。

我需要将第 2 行、第 2-6 列与特定值 (5) 相乘，然后分别合计，然后相互比较（CSV2 总计/CSV1 总计），并以百分比格式显示。

import csv 和 reader 似乎是要走的路，但对我来说棘手的部分是将其拉入一个列表中，我可以将其与不同的值相乘（或者我应该使用一个集合吗？），然后以最简洁的方式比较两者/高效的方式。

代码更新（基于第二个答案-很棒，谢谢！但现在调用我的行值整数时遇到错误）：

```
import csv
file1 = open('csv1.csv', 'rb')
csv1 = csv.DictReader(file1)

file2 = open('csv2.csv', 'rb')
csv2 = csv.DictReader(file2)

myList = csv2.fieldnames
myList.append('Difference')

outFile = open('outFilename.csv', 'wb')
outCsv = csv.DictWriter(outFile, myList)

file1Dict = dict()
file2Dict = dict()

for row in file1:
    file1Dict[row['key value']]['Total1'] = {'Total1':(int(row[1]) * .75 + int(row[2]) * 2.25 + int(row[3]) * 3.5 + int(row[4]) * 5 + int(row[5]) * 25)}

for row in file2:
    file2Dict[row['key value']]['Total2'] = {'Total2':(int(row[1]) * .75, int(row[2]) * 2.25, int(row[3]) * 3.5, int(row[4]) * 5, int(row[5]) * 25)}

outFile.writeheader()

for stuff in file1Dict:
    file1Dict[stuff]['Difference'] = str(int(int(file1Dict[stuff]['Total2']) / int(file1Dict[stuff]['Total1'])) * 100) + '\%'
    outFile.writerow(file1Dict[stuff])

print 'difference' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:05:43.220

```
import csv
file1 = open('filename1.csv', 'rb')
csv1 = csv.DictReader(file1)

file2 = open('filename2.csv', 'rb')
csv2 = csv.DictReader(file2)

myList = csv2.fieldnames
myList.append('Total1','Total2', 'Difference')

outFile = open('outFilename.csv', 'wb')
outCsv = csv.DictWriter(outFile, myList)

file1Dict = dict()
file2Dict = dict()

for rows in file1:
    file1Dict[rows['key value']] = {rows[0], rows[1], 'Total1':int(rows[1]) * 5}

for rows in file2:
    file1Dict[rows['key value']]['Total2'] = {'Total2':int(rows[1]) * 5}

outFile.writeheader()

for stuff in file1Dict:
    file1Dict[stuff]['Difference'] = str(int(int(file1Dict[stuff]['Total2']) / int(file1Dict[stuff]['Total1'])) * 100) + '\%'
    outFile.writerow(file1Dict[stuff]) 
```

只是将您描述的内容快速组合在一起，没有非标准模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:03:52.997

我认为您应该使用[Python Pandas](http://pandas.pydata.org/)和内置[`read_csv`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.io.parsers.read_csv.html)函数，因为这将非常有效，并将其放入矩形形式中，任何类型的数学运算都可以轻松应用，并且易于在两个不同的导入数据集之间进行比较。

请注意，在导入之后`pandas`，有一个全局级别，就像上面链接的文档页面中那样`read_csv`调用`pandas.read_csv("/path/to/file.csv")`而不是需要经过。`io.parsers`

通过标准模块执行此操作没有任何问题；我只是认为，如果您打算进行聚合或广播数学运算，那么 Pandas 提供的使用高效 NumPy 数学运算的矩形数组是最佳选择。

# javascript - Twitter Bootstrap - 在导航栏中居中品牌标志

> ID：14486261
> 
> 赞同：4
> 
> 时间：2013-01-23T17:58:25.787
> 
> 标签：javascript, css, twitter-bootstrap, navbar, graphical-logo

`.brand`我尝试将徽标居中：

```
.brand { margin-left: auto; margin-right: auto; } 
```

这是我的顶级导航栏布局：

[http://jsfiddle.net/J4zkJ/3/](http://jsfiddle.net/J4zkJ/3/)

但它似乎不起作用。

我之前在堆栈上搜索过以发布此答案，而我上面使用的代码取自已回答的问题。

知道如何将 .brand 居中吗？

注意：我不能使用`position:absolute and fixed`，我想响应地这样做（`responsive`）

我也试过这个：

```
.brand { 
  margin:0 auto !important;
  padding:0 auto !important;
  position:absolute !important;
  right:0px;
  left:0px;
   z-index:9999999999 !important;

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T18:14:35.620

```
.navbar .brand {
  margin-left: auto;
  margin-right: auto;
  width: 60px;
  float: none;
} 
```

我给了它一个任意宽度，将其设置为您想要的任何宽度。

[jsFiddle](http://jsfiddle.net/J4zkJ/5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-17T20:47:12.510

**使用引导程序 3**

我在我的 global.less 文件中添加了三个类来扩充引导程序 navbar.less 类。

这种方法适用于所有响应式@media 规则大小，但您需要根据菜单项的宽度调整字体大小和菜单折叠点（这种方法绝对定位导航栏品牌 - 它“浮动”在其他菜单项）。

**风格：**

```
.navbar-brand-centered {
    position: absolute;
    top: 0;
    left: 50%;
    height: 50px;
    width: 200px;  /* bootstrap has max-width: 200px rule */
    margin-left: -100px;
    margin-top: 8px;
    text-align: center;
  }

  .navbar-brand-centered {
    color: @navbar-inverse-brand-color;
    &:hover,
    &:focus {
      color: @navbar-inverse-brand-hover-color;
      background-color: @navbar-inverse-brand-hover-bg;
    }
  }

  .navbar-brand-centered {
    display: block;
    max-width: 200px;
    margin-left: auto;
    margin-right: auto;
    padding: @navbar-padding-vertical @navbar-padding-horizontal;
    font-size: @font-size-large;
    font-weight: 500;
    line-height: @line-height-computed;
    color: @navbar-brand-color;
    text-align: center;
    &:hover,
    &:focus {
      color: @navbar-brand-hover-color;
      text-decoration: none;
      background-color: @navbar-brand-hover-bg;
    }
  } 
```

**用法：**

```
<div class="navbar navbar-fixed-top">
    <!-- .navbar-toggle is used as the toggle for collapsed navbar content -->
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>

    <!-- Be sure to leave the brand out here if you want it shown -->
    <a class="navbar-brand-centered" href="/"><span style="font-size: 2em">mess<span style="color: red;">2</span>dress</span></a>

    <!-- Place everything within .navbar-collapse to hide it until above 768px -->
    <div class="nav-collapse collapse navbar-responsive-collapse">
        <!-- YOUR MENU ITEMS HERE --> 
```

这对我有用，但我确信有更好的方法可以与 bootstrap 实现的基于浮点的方法集成。接受反馈。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-24T13:57:07.990

我只是在我的 style.css 中使用了这些，它对我有用：

```
    /* 导航栏的标题 */
    .navbar-header {
        文本对齐：居中；
        边距：10px；
        浮动：无！重要；
    }

    /* 网站名称 */
    .导航栏品牌{
        浮动：无！重要；
    }

```

# jquery - jQuery动画不播放

> ID：14486262
> 
> 赞同：2
> 
> 时间：2013-01-23T17:58:26.037
> 
> 标签：jquery, jquery-animate

我认为我拥有的这段代码可以工作，但它只能工作 50%。当动画宽度从 0 到 200px 时它可以工作，但反之亦然它不起作用。

这有效：`$('#left').animate({"width": "200px"}, "1000").show();`

但这不是：`$('#left').animate({"width": "0px"}, "1000").hide();`

我究竟做错了什么？

[这是一个包含所有代码的 JSFIDDLE](http://jsfiddle.net/nV5Tu/7/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:04:22.013

动画完成后隐藏它：

```
$('#left').animate({"width": "0px"}, "1000", function () {
    $(this).hide();
}); 
```

原因是动画异步触发，然后立即调用隐藏，导致它消失。把它放在完整的回调中会给你想要的效果。

查看更新的小提琴：http: [//jsfiddle.net/nV5Tu/12/](http://jsfiddle.net/nV5Tu/12/)

# jquery - 由于具有 :active 伪类的“按下按钮”效果，单击事件未触发

> ID：14486263
> 
> 赞同：9
> 
> 时间：2013-01-23T17:58:28.020
> 
> 标签：jquery, css, button

我正在尝试使用 css ":active" 伪类在单击 div 时为其设置动画。div 向右移动 10 像素，向下移动 10 像素：

```
#myButton:active {
    margin:10px 0 0 10px;
} 
```

在此处查看完整示例：http: [//jsfiddle.net/WdABS/](http://jsfiddle.net/WdABS/)

问题是，如果您单击 div 的顶部或左侧边框（在 jsFiddle 示例中为红色），则释放按钮时鼠标指针不再位于 div 上方。因此，*mouseup*和*click*都不会被触发。

从技术上讲，这种行为非常合理。然而，这不是最终用户所期望的，我不知道如何以一种干净简单的方式修复它。我试图在移动的 div 周围放置一个父容器并从中捕获 click 事件，但它似乎只是让事情变得更复杂并且也不能很好地工作。

谢谢阅读！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T18:10:38.820

## 纯 CSS：使用伪元素

这适用于 IE8+、Firefox 和 Chrome（所有这些都经过测试）。看到[这个小提琴](http://jsfiddle.net/WdABS/4/)。

```
#myButton:active {
    margin:10px 0 0 10px;
}
#myButton:active:before {
    content: '';
    position: absolute;
    top: -20px; /* border plus shift amount */
    right: 0;
    bottom: 0;
    left: -20px; /* border plus shift amount */
} 
```

您`#myButton`将需要一个`position: relative`或`absolute`多个`:before`元素正确定位自身。

## 纯 CSS：带有边框本身的 Shift (CSS3)

*如果按钮上还没有边框*，那么使用`border`属性本身（具有透明颜色）和`background-clip`（不让按钮颜色与边框重叠），您可以获得相同的功能。看到[这个小提琴](http://jsfiddle.net/WdABS/9/)。

```
#myButton:active {
    border-top:10px transparent solid;
    border-left:10px transparent solid;
    background-clip: padding-box;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T18:29:05.540

所以我的想法是在触发事件处理程序`mouseup`时将事件处理程序绑定到文档。`mousedown`然后你可以运行你想要运行的代码`mouseup`和`click`. 这是一个显示这一点的[小提琴。](http://jsfiddle.net/WdABS/12/)

```
$(document).ready(function() {
    $('#myButton').mousedown(function() { 
        debug('button down'); 
        $(document).on('mouseup', function(){
            $(document).off('mouseup');
            debug('button up');
            debug('click'); 
        });
    });
});

function debug(msg) {
    $('#debug').append('[' + msg + ']');
} 
```

# servicestack - RedisMQ PriorityQueue 中的 Servicestack 内部优先级

> ID：14486264
> 
> 赞同：6
> 
> 时间：2013-01-23T17:58:29.670
> 
> 标签：servicestack

我想创建一个具有内部优先级的优先级队列，以便首先使用 ServiceStack 弹出优先级更高的消息。ServiceStack RedisMQ 实现在其*IMessage*接口上提供了*long类型的**Priority* setter 。我希望在*Priority*属性上发送的具有更高值的消息将首先从队列中弹出。我的测试表明，*优先级 > 0*的消息被放在 Redis“Mq:MyDto.priorityq”上，而任何其他值将消息放在队列“Mq:MyDto.inq”中的正常消息上。

 ***这是一些示例代码，说明了我要完成的工作：

```
 using (var producer = MsgFactory.CreateMessageProducer())
         {
            var lowPrioMsg = new Message<MyDto>(lowPrioDto);
            lowPrioMsg = (long)1;
            producer.Publish<MyDto>(lowPrioMsg);

            var highPrioMsg = new Message<MyDto>(highPrioDto);
            highPrioMsg.Priority = (long)100;
            producer.Publish<MyDto>(highPrioMsg);
         } 
```

换句话说，我希望在具有Priority *=1的**lowPrioMsg*之前弹出具有*Priority=100的**highPrioMsg*。然而，在实践中，这些消息似乎遵循顺序 FIFO 原则。

 *有没有一种方法可以配置 ServiceStack RedisMQ 以在 PriorityQueue 中使用内部优先级按预期工作？

或者我唯一的选择是使用普通队列还是优先队列？在那种情况下，为什么*优先级*设置器使用*long*而不是布尔值？

 ** * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:32:12.760

在[ServiceStack Redis MQ](https://github.com/ServiceStack/ServiceStack/wiki/Messaging-and-Redis) `IMessageService`实现中，您的权利是**PriorityQ**只是另一个 FIFO 队列，当您发送带有 a 的消息时发生的所有事情`Priority > 0`就是它被发布到**PriorityQ**而不是标准的**InQ**消息通常被发布到。

优先级是一个数字，因此其他 ServiceStack MQ 提供者能够提供不同的实现，即利用优先级分数的实现。目前 Redis 中的 PriorityQ 由不支持元素优先级的标准 redis-server 列表支持，最终我们可能会考虑更改实现以使用允许排序的排序集。

我们还打算为 ServiceStack 提供不同的 MQ 主机提供程序（例如 RabbitMQ、ZeroMQ、ServiceBus 等），我们将在底层 MQ 代理支持的情况下使用优先级分数。*****

# c# - 执行 windows 服务文件时出错

> ID：14486265
> 
> 赞同：2
> 
> 时间：2013-01-23T17:58:36.333
> 
> 标签：c#, windows-services

我正在尝试使用以下命令执行 Windows 服务 C:\Windows\system32>installutil.exe MyNewService.exe

但我收到以下错误：初始化安装时发生异常：System.IO.FileNotFoundException：无法加载文件或程序集'file:///C:\Win dows\system32\MyNewService.exe'或其依赖项之一。该系统找不到指定的文件..

我尝试了各种博客，说空间存在一些问题，但我找不到对我的代码进行合适的修改。谁能告诉我需要哪些修改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:08:08.577

这个错误是因为你的“installutil.exe”不在“C:\Windows\system32”下，这是一个.NET framework文件，会在.NET framework的版本下找到。例如对于 Framework 4.0，您可以在此处找到此文件：“C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319”

我会建议打开一个命令提示符窗口并 'cd' 进入“C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319”，然后执行以下命令。

> > installutil.exe G:\MyProjects\MyNewService\MyNewService.exe

这应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T18:01:59.390

这可能是`System32`文件夹的权限问题。尝试将您的服务可执行文件（和其他相关文件）移出类似`C:\MyNewService\`的东西并像这样调用安装`C:\Windows\system32>installutil.exe C:\MyNewService\MyNewService.exe`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T18:07:59.747

不幸的是，这是一个非常普遍的错误，背后可能有很多问题。基本上，.NET 运行时无法完全加载文件，这可能意味着在奇怪的情况下文件本身存在问题，或者很可能无法找到其依赖项之一。

请注意，依赖项通常是链式的，因此您引用的程序集可能会引用另一个丢失的程序集。几个建议：

*   仔细检查您的任何依赖项是否没有强签名。
*   如果它们不是强签名的，它们应该与您的服务位于同一目录中。
*   如果它们是强签名的，则它们应该位于 GAC 中（确保它是正确的，将 .NET 4 DLL 放在 .NET 2 GAC 中将不起作用）或位于同一目录中。
*   如果依赖项在 GAC 中，请尝试将副本放在本地目录中以避免任何问题。
*   最后，如果您仍然遇到问题，请查看调试依赖项，特别是[Fusion Log](http://msdn.microsoft.com/en-us/library/e74a18c4%28v=vs.71%29.aspx)，请注意有很多方法可以到达那个日期，我只是链接到第一个结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T18:11:56.047

感谢您的关心，我得到了解决方案。其实我给了 installutil MyNewService.exe

相反，我必须提供 installutil MyNewService.exe 完整路径....

# javascript - Javascript Uncaught TypeError 在一个页面上，但在下一个页面上有效？

> ID：14486266
> 
> 赞同：0
> 
> 时间：2013-01-23T17:58:43.027
> 
> 标签：javascript, jquery, wordpress

在 wordpress 网站上工作并在将鼠标悬停在导航菜单栏上时添加滑动标记。

该网站 - [http://avuedesigns.com/iaq](http://avuedesigns.com/iaq)

在 chrome 开发人员工具中，它显示此错误：

```
Uncaught TypeError: Cannot read property 'left' of undefined script.js:242
(anonymous function) script.js:242
v.event.special.(anonymous function).handle jquery.js:2
v.event.dispatch jquery.js:2
o.handle.u 
```

菜单适用的唯一页面是购物车页面和我的帐户。我假设它可能与图书馆的冲突，因为我几天前遇到了类似的情况。但我不知道解决这个问题的正确方法，并希望找到指导，所以我不会在简单的问题上浪费任何人的时间。

我确实知道标记在工作页面上已关闭，没有时间调整它，想先让它工作=P。

感谢您的时间和智慧。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:51:46.847

似乎您使用错误的类来获取`#slidingArrow`script.js @ Line 231 中的位置值：

```
activeItem = menuList.find('.current_page_item, .current_page_ancestor, .current_page_parent'); 
```

我认为你会更适合切换`.current_page_item`到`.current-menu-item`. 该类`.current_page_item`似乎没有在所有页面上填充，因此`#slidingArrow`div 元素无法获取任何定位信息。

在 script.js 中，这是我所做的更改`menuSlidingArrow()`：

```
function menuSlidingArrow() {

    if(!($j('html').hasClass('oldie'))) {

        var mainmenu    = $j('.menu-content'),
            arrow       = $j('#slidingArrow'),
            menuList    = mainmenu.find('ul.menu'),
            activeItem  = menuList.find('.current-menu-item, .current_page_ancestor, .current_page_parent'); //remove .current_page_item

        $j(window).load(function() {
            arrow.css({ 'left':(activeItem.position().left + ((activeItem.outerWidth() - 48)/2) ) -6});
            arrow.fadeIn('slow');
        });

        menuList.children().hover(function(){
            arrow.animate({ 'left':($j(this).position().left + (($j(this).outerWidth() - 48)/2) ) -6},
                { queue: false, easing: 'easeOutQuad', duration: 250 });
        },function(){
            arrow.animate({ 'left':(activeItem.position().left + ((activeItem.outerWidth() - 48)/2) ) -6},
                { queue: false, easing: 'easeOutQuad', duration: 250 });
        });
    }

} 
```

我还需要以下 CSS 来让它工作：

```
#menu-main-menu {
    margin-left:68px;
}
#menu-item-8197 a { /* hide home navigation item */
    color:#fff;
}
#slidingArrow {
    margin-left:77px;
} 
```

最后，确保将“主页”页面添加到顶部导航。您将希望将其添加为导航上的第一项。

总而言之，我更改/添加了：

*   `.current_page_item`变成`.current-menu-item`
*   添加`#slidingArrow { margin-left: 77px; }`, `menu-item-8197 a { color:#fff; }`,`#menu-main-menu { margin-left:68px; }`
*   修改计算以`#slidingArrow`在导航项下居中
*   在导航中添加了主页
*   在导航上隐藏主页导航元素

让我知道这对您是如何工作的，如果您遇到任何错误，我很乐意为您纠正我的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:11:42.740

这个函数什么都不返回，所以 activeItem 被定义为一个空数组，这就是你的代码不起作用的原因，在你的其他页面中检查你发送给`menuList.find()`函数的参数，看看它们是否不同。

script.js 第 231 行：

```
activeItem = menuList.find('.current_page_item, .current_page_ancestor, .current_page_parent'); 
```

# java - 函数 G.grid().reduce() 所需的 GridGain MapReduce 清晰度

> ID：14486267
> 
> 赞同：1
> 
> 时间：2013-01-23T17:58:43.563
> 
> 标签：java, mapreduce, gridgain

我已经使用了这个在大多数网站中都有的例子..

```
int letterCnt = G.grid().reduce(
GridClosureCallMode.SPREAD,
F.yield("Counting Letters In This Phrase".split(" "),
    new C1<String, Integer>() {
        @Override public Integer apply(String word) {
            return word.length();
        }
    }
),
F.sumIntReducer()
); 
```

第一个参数表示工作负载的平均分配（我假设它更像是循环基础）第二个参数具有将在所有发现的节点中执行的代码第三个接收来自在不同节点中执行的 apply() 的所有结果数据并进行相应处理。

我想知道是否可以用我们自己的函数替换第三个参数 F.sumIntReducer() 。如果是，我想看一个例子。假设创建具有与 F.sumIntReducer() 相同功能的相同函数（即，将不同节点找到的所有长度相加）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T13:50:56.840

reduce 方法具有全局输入和输出数据类型。其结构示意图如下：

```
1   resultValue = grid.reduce(
2   job distribution mode,
3   executable logic function,
4   split function,
5   collect function); 
```

1.  任务的结果值直接赋值给reduce函数的返回值。Grid 是对应的网格，作业发送到的地方。这里可以定义多个网格并并行存在。
2.  作业分配设置在此处定义。作业分配的参数提供三个选项： -GridClosureCallMode.BALANCE - 平衡（循环？）作业分布 -GridClosureCallMode.BROADCAST - 所有节点处理所有作业 -GridClosureCallMode.SPREAD - 所有作业随机分布
3.  原子逻辑函数在这里定义。这部分称为作业；它被发送到一个节点，处理并包含全局结果的一部分。它定义了支持的输入和输出数据类型。GridGain 还支持开箱即用地分发此功能所需的所有库。这意味着主节点不限于使用所有节点都在本地可用的库，因为所有必要的库都随作业一起提供。这当然会产生更多的数据流量。
4.  输入数据需要分发到节点。每个函数都提供有来自 split 函数的数据集之一。数据的细分存储在具有相应数据类型的数组列表中。由于实现结果，仅支持低级数据类型（根据 GridGain ，高级数据也应该可传输）。要传输更复杂的数据（如 PDF 和图像），必须封装成字节数组。
5.  主节点使用此功能接收生成的零件并将它们重新组装成最终结果。

简单的例子：（不使用网格，因为只有内存操作而不是 CPU 密集型，所以不要指望单次执行的改进）

```
private static int countLettersReducer(String phrase) throws GridException {

        // final GridLogger log = grid.log();
        int letterCount = 0;

        // Execute Hello World task.
        try {

            @SuppressWarnings("unchecked")
            int letterCnt =

            grid.reduce(GridClosureCallMode.BALANCE,
            // input: string
            // output: integer
                    new GridClosure<String, Integer>() {

                        private static final long serialVersionUID = 1L;

                        // Create executable logic block for a job part
                        @Override
                        public Integer apply(String word) {
                            // Print out a given word, just so we can
                            // see which node is doing what.
                            // System.out.println(">>> Calculating for word: " + word);
                            // Return the length of a given word, i.e. number of
                            // letters.
                            return word.length();
                        }
                    },

                    // split tasks for single jobs according to this function
                    // split at linebreaks
                    Arrays.asList(phrase.split("\n")),

                    // Collection of words.
                    // Collect the results from each job of the nodes
                    //input and output is integer
                    new GridReducer<Integer, Integer>() {
                        /**
                         * 
                         */
                        private static final long serialVersionUID = 1L;
                        private int sum;

                        @Override
                        public boolean collect(Integer res) {
                            sum += res;

                            return true; // True means continue collecting until
                                            // last result.
                        }

                        // return the collected results
                        @Override
                        public Integer apply() {
                            return sum;
                        }
                    });

            letterCount = letterCnt;
        } catch (Exception e) {

        }
        return letterCount;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T07:15:47.500

是的，您可以定义自己的自定义减速器。例子在[这里](https://github.com/gridgain/gridgain/blob/master/examples/java/org/gridgain/examples/primenumbers/GridPrimeExample.java#L82-L102)。

# bioinformatics - 为什么 pmid 2 pmcid 的 Pubmed entrez 工具会给出奇怪的结果

> ID：14486271
> 
> 赞同：1
> 
> 时间：2013-01-23T17:59:04.533
> 
> 标签：bioinformatics, pubmed

我正在为一个 Ruby 脚本编写一个 rspec，其中包括使用这个 api 从 PMid 转换为 PMCid。

[像这样](http://www.pubmedcentral.nih.gov/utils/entrezpmc.cgi?1279666)调用它可以正常工作：

```
PubMedId             => PMCId               
1279666              => 50267 
```

但是我正在写一个规范并且想要一个失败的调用，比如当有人传入一个字符串而不是一个数字时。所以我尝试[了这个](http://www.pubmedcentral.nih.gov/utils/entrezpmc.cgi?foobar)：

```
PubMedId             => PMCId               
foobar               => 320759,320760,322131,322132,323033,323035,323115,323117...[599027 total PMCids] 
```

这将返回 599027 个 PMCid！

我刚刚检查了[反向服务](http://www.pubmedcentral.nih.gov/utils/pmcentrez.cgi?50267)：

```
PMCId                => PubMedId            
50267                => 1279666 
```

蚂蚁[电话](http://www.pubmedcentral.nih.gov/utils/pmcentrez.cgi?foobar)：

```
PMCId                => PubMedId            
foobar               => 
```

看起来不错。

有谁知道这是否是 PMid 到 PMCid 服务的正确（和记录）行为？

有趣的是，当我[反向查找](http://www.pubmedcentral.nih.gov/utils/pmcentrez.cgi?320760,320759,320760,322131,322132,323033,323035,323115,323117)“foobar”返回的一些 PMCid 时，它们都显示匹配的 PMid 为零：

```
PMCId                => PubMedId            
320760               => 0                   
320759               => 0                   
320760               => 0                   
322131               => 0                   
322132               => 0                   
323033               => 0                   
323035               => 0                   
323115               => 0                   
323117               => 0 
```

# oracle - rowid 在 pl/sql 块中自动更改

> ID：14486276
> 
> 赞同：0
> 
> 时间：2013-01-23T17:59:24.413
> 
> 标签：oracle, stored-procedures, rowid

```
create or replace
PROCEDURE PROMOLOG1 AS
CURSOR rule IS SELECT * FROM business_rules; --this table had where conditions to use
TYPE r_cursor IS REF CURSOR;
ruleMatch r_cursor;
row_id VARCHAR2(20);
query_test VARCHAR2(400);

BEGIN
  FOR a IN rule LOOP
    IF a.rule_name != 'Rule1' THEN
      OPEN rulematch FOR 'SELECT rowid FROM cold_promo_log_dup P WHERE EXISTS( SELECT   1 FROM cold_promo_log_dup C WHERE ' || a.condition || ' AND rowid < P.rowid)';
      dbms_output.put_line('matching completed for ' || a.rule_name);
      LOOP
         FETCH ruleMatch INTO row_id;
         EXIT WHEN rulematch%notfound;
         query_test := 'INSERT INTO cold_promo_log_duplicate SELECT * FROM cold_promo_log_dup WHERE rowid = ''' || row_id ||'''' ;
         dbms_output.put_line(query_test);
         --EXECUTE IMMEDIATE 'INSERT INTO cold_promo_log_duplicate SELECT * FROM cold_promo_log_dup WHERE rowid = ''' || row_id || '''';
         INSERT INTO cold_promo_log_duplicate SELECT * FROM cold_promo_log_dup WHERE rowid = row_id ;
         EXECUTE IMMEDIATE 'DELETE FROM cold_promo_log_dup WHERE rowid = ' || row_id;
      END LOOP;
    END IF;
  END LOOP;
END PROMOLOG1; 
```

在oracle中执行上述过程会引发以下错误：

```
 Connecting to the database dedupe_preprod.
    ORA-00904: "AAALJBABVAANSZDAAA": invalid identifier
    ORA-06512: at "DEDUPE.PROMOLOG1", line 23
    ORA-06512: at line 2
    matching completed for Rule2
    INSERT INTO cold_promo_log_duplicate SELECT * FROM cold_promo_log_dup WHERE rowid =   'AAALJBABvAANsZDAAA'
    Process exited.
    Disconnecting from the database dedupe_preprod. 
```

当我打印 rowid 时，它有几个小写字母（AAALJBABvAANsZDAAA），但错误显示所有字母都大写（AAALJBABVAANSZDAAA）。数据库中没有大写的rowid，因此出现错误无效标识符。
任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:07:21.353

首先你的row_id 变量应该是ROWID 类型而不是varchar2。

其次这是错误：

```
 EXECUTE IMMEDIATE 'DELETE FROM cold_promo_log_dup WHERE rowid = ' || row_id; 
```

您没有引用它（因此它将 rowid 视为标识符）。但是你为什么要在动态 SQL 中运行它呢？

Ps 如果你要离开这个动态，你应该使用绑定变量，因此不要破坏你的共享池并提高性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T19:34:25.497

不要使用 rowid 进行循环。您这样做：您可以删除该行，然后将其插入其他位置。最好的办法是使用 a `DELETE ... RETURNING BULK COLLECT ...`，这样你就不需要使用 rowid，你可以使用集合而不是使用将逐行执行的 for 循环

# java - Switch 语句（字符）

> ID：14486280
> 
> 赞同：-6
> 
> 时间：2013-01-23T17:59:34.977
> 
> 标签：java, switch-statement

我有一个 switch 语句，它采用字母等级并返回相应的 GPA；但是，它会为字母（A、B、C、D 和 F）引发找不到符号错误！我检查了 javaDocs 以获取指导，但找不到错误。是什么导致了这个错误？

```
switch (grade) {
        case A:  nv[i] = 4; //nv = numerical value
                 break;
        case B:  nv[i] = 3;
                 break;
        case C:  nv[i] = 2;
                 break;
        case D:  nv[i] = 1;
                 break;
        case F:  nv[i] = 0;
                 break;
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-23T18:00:40.943

`A`不是有效的字符文字 - `'A'`is。

所以你要：

```
switch (grade) {
    case 'A':  nv[i] = 4; //nv = numerical value
             break;
    case 'B':  nv[i] = 3;
             break;
    case 'C':  nv[i] = 2;
             break;
    case 'D':  nv[i] = 1;
             break;
    case 'F':  nv[i] = 0;
             break;
} 
```

对于成绩不是其中之一的情况，您可能还应该有一个默认情况。

哦，你的代码也可以写成：

```
nv[i] = "FDCBA".indexOf(grade); 
```

之后检查为`nv[i]`-1（意味着成绩不在该集合中）。

# c++ - QVariant::isNull() 和自定义类型

> ID：14486286
> 
> 赞同：5
> 
> 时间：2013-01-23T17:59:56.833
> 
> 标签：c++, qt

我可以以某种方式使用`QVariant::isNull()`自定义`Q_DECLARE_METATYPE()`类型吗？

例如，如果我为整数定义了这样的包装类（我为什么要这样做，但这应该是一个最小的例子）。定义`bool isNull() const`成员函数没有帮助：

```
#include <QVariant>
#include <QDebug>

class Integer {
    bool null;
    int x;
public:
    Integer() : null(true), x(0) {}
    Integer(int x) : null(false), x(x) {}
    int value() const {
        return x;
    }
    bool isNull() const {
        return null;
    }
};
Q_DECLARE_METATYPE(Integer)

int main()
{
    Integer x(42);
    Integer y(0);
    Integer z;

    qDebug() << x.isNull() << QVariant::fromValue(x).isNull();
    qDebug() << y.isNull() << QVariant::fromValue(y).isNull();
    qDebug() << z.isNull() << QVariant::fromValue(z).isNull(); // Not as expected!
} 
```

输出：

```
false false 
false false 
true false     // Not as expected! 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-24T10:58:57.337

不幸的是你不能。`QVariant::isNull`代码如下：

```
static bool isNull(const QVariant::Private *d)
{
    switch(d->type) {
    case QVariant::String:
        return v_cast<QString>(d)->isNull();
    case QVariant::Char:
        return v_cast<QChar>(d)->isNull();
    case QVariant::Date:
        return v_cast<QDate>(d)->isNull();
    case QVariant::Time:
        return v_cast<QTime>(d)->isNull();
    ...
    }
    return d->is_null;
} 
```

正如你所看到的，它明确地使用了`isNull()`一些常见变量类型的函数，默认情况下它返回`d->is_null`值。

`d->is_null`是类的 D 指针的类成员，它`QVariant`被初始化，`true`但每次你给它赋值时`QVariant`它变成`false`：

```
inline void qVariantSetValue(QVariant &v, const T &t)
{
    ...
    d.is_null = false;
    ...
} 
```

因此，对于自定义类型，它将始终返回`false`.

一种可能性（**我不推荐**）是子类化`QVariant`并重新实现该`isNull`功能。在此函数中，您可以检查类型是否为自定义，在这种情况下，您可以返回`isNull`自定义类的函数的返回值，否则您应该返回`QVariant::isNull`函数的返回值。

```
bool MyQVariant::isNull() const
{
    if (QString(typeName()) == "MyCustomClass")
       return value<MyCustomClass>().isNull();
    return QVariant::isNull();   
} 
```

**编辑**

您使用子类 QVariant 的示例代码：

```
#include <QVariant>
#include <QDebug>

class Integer {
    bool null;
    int x;
public:
    Integer() : null(true), x(0) {}
    Integer(int x) : null(false), x(x) {}
    int value() const {
        return x;
    }
    bool isNull() const {
        return null;
    }
};
Q_DECLARE_METATYPE(Integer)

class MyQVariant : public QVariant
{
public:
    MyQVariant(QVariant v) :
      QVariant(v) {}
    bool isNull() const
    {
        if (QString(typeName()) == "Integer")
            return value<Integer>().isNull();
        return QVariant::isNull();   
    }
};

int main(int argc, char *argv[])
{
    Integer x(42);
    Integer y(0);
    Integer z;

    qRegisterMetaType<Integer>("Integer");

    MyQVariant v1(QVariant::fromValue(x));
    MyQVariant v2(QVariant::fromValue(y));
    MyQVariant v3(QVariant::fromValue(z));

    qDebug() << x.isNull() << v1.isNull();
    qDebug() << y.isNull() << v2.isNull();
    qDebug() << z.isNull() << v3.isNull();
} 
```

输出：

```
false false 
false false 
true true 
```

# php - 使用 PHP xPath 解析复杂的 XML 文档

> ID：14486288
> 
> 赞同：0
> 
> 时间：2013-01-23T18:00:03.973
> 
> 标签：php, xml, parsing, xpath

我有一个 XML 结构，就像我在下面的大纲一样。我正在尝试使用 xPath 来查找结构中的特定元素，但没有成功。这是我迄今为止所拥有的：

$resultset[0]['bibXML'] - 这里是这个变量中传递的确切内容的粘贴。[http://pastebin.com/CwtFG5dj](http://pastebin.com/CwtFG5dj)

这是使用 print_r() 的 $myNode 输出的链接。 [http://pastebin.com/TwDaxs42](http://pastebin.com/TwDaxs42)

```
$myNode = new SimpleXMLElement($resultset[0]['bibXML']);
$bnum = $myNode->xpath("record/datafield[@tag='035']/subfield[@code='a']");

<?xml version="1.0" encoding="UTF-8"?>
<collection xmlns="http://www.loc.gov/MARC21/slim">
<record>
    <leader>01220nam  2200265   4500</leader>
    <controlfield tag="001">ocm00000197</controlfield>
    <datafield tag="035" ind1="" ind2="">
        <subfield code="a">.b10000021</subfield>
        <subfield code="b">a    </subfield>
        <subfield code="c">-</subfield>
    </datafield>
    <datafield tag="245" ind1="" ind2="">
        <subfield code="a">Some Book Title</subfield>
        <subfield code="b">a    </subfield>
        <subfield code="c">-</subfield>
    </datafield>
</record>
</collection> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:45:30.833

您的元素位于`http://www.loc.gov/MARC21/slim`命名空间中。[了解 xml 名称空间](http://zvon.org/comp/r/tut-Namespace.html)。

您的 XPath 匹配 null 命名空间中的元素，因为它们没有前缀。由于您的元素实际上不在 null 命名空间中，因此您的 XPath 不匹配任何内容。

您需要使用该[`registerXPathNamespace`方法](http://php.net/manual/en/simplexmlelement.registerxpathnamespace.php)注册一个命名空间前缀，然后使用该前缀来限定您的元素名称。

这将是您的完整代码：

```
$myNode = simplexml_load_string($resultset[0]['bibXML']);

$myNode->registerXPathNamespace('m21s', 'http://www.loc.gov/MARC21/slim');

$results = $myNode->xpath('m21s:record/m21s:datafield[@tag="035"]/m21s:subfield[@code="a"]');
$bnum = ($results) ? (string) $results[0] : null;

var_export($bnum); 
```

# java - Android Preference for API 低于和高于 3.0

> ID：14486289
> 
> 赞同：3
> 
> 时间：2013-01-23T18:00:03.923
> 
> 标签：java, android, api, preference, runtimeexception

我的偏好设置有 FC 问题。我在网上查找了一些适用于低于和高于 3.0 的 API 的偏好示例。所以我得到了 2 个 xml 首选项文件，就像教程一样。然后我使用相同的方法检查并调用每个 xml 首选项文件，现在得到 FC。我还必须手动将 min API 从 7 更改为 11 才能运行，这有时会破坏目的。两个 xml 是相同的。有什么见解吗？

**偏好类**

```
package com.armstrong.yi.android.app;

import java.util.List;
import android.os.Build;
import android.os.Bundle;
import android.preference.PreferenceActivity;
import com.armstrong.yi.android.app.R;

public class Prefs extends PreferenceActivity {

    final static String ACTION_PREFS_ONE = "com.armstrong.yi.android.app.PREFS";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);

        String action = getIntent().getAction();
        if (action != null && action.equals(ACTION_PREFS_ONE)) {
            addPreferencesFromResource(R.xml.prefs);
        }

        else if (Build.VERSION.SDK_INT < Build.VERSION_CODES.HONEYCOMB) {
            // Load the legacy preferences headers
            addPreferencesFromResource(R.xml.prefs_legacy);
        }

    }

    public void onBuildHeaders(List<Header> target) {
        loadHeadersFromResource(R.xml.prefs, target);
    }
} 
```

**首选项 xml**

```
 <?xml version="1.0" encoding="utf-8"?>
    <PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >

<EditTextPreference
    android:key="name"
    android:summary="Enter Your Name"
    android:title="EditText" />

<CheckBoxPreference
    android:defaultValue="true"
    android:key="checkbox"
    android:summary="for the splash screen"
    android:title="Music" />

<ListPreference
    android:entries="@array/list"
    android:key="list"
    android:summary="This is a list to choose from"
    android:title="list"
    android:entryValues="@array/lValues" />

    </PreferenceScreen> 
```

**显现**

```
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.armstrong.yi.android.app"
android:versionCode="2"
android:versionName="2.7.9" >

<uses-sdk
    android:minSdkVersion="11"
    android:targetSdkVersion="15" />

<uses-permission android:name="android.permission.SET_WALLPAPER" />

<application
    android:name="GlobalVariables"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".Splash"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.armstrong.yi.android.app.NumCounter"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="com.armstrong.yi.android.app.MAINACTIVITY" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name=".Menu"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="com.armstrong.yi.android.app.MENU" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name=".TextPlay"
        android:label="@string/title_activity_main" >
    </activity>
    <activity
        android:name=".Email"
        android:label="@string/title_activity_main" >
    </activity>
    <activity
        android:name=".DailyDataEntry"
        android:label="@string/title_activity_main" >
    </activity>
    <activity
        android:name=".WeeklyDataEntry"
        android:label="@string/title_activity_main" >
    </activity>
    <activity
        android:name=".Camera"
        android:label="@string/title_activity_main"
        android:screenOrientation="portrait" >
    </activity>
    <activity
        android:name=".InitialDataEntry"
        android:label="@string/title_activity_main" >
    </activity>
    <activity
        android:name=".FinalDataEntry"
        android:label="@string/title_activity_main" >
    </activity>
    <activity
        android:name=".Rankings"
        android:label="@string/title_activity_main" >
    </activity>
    <activity
        android:name=".Data"
        android:label="@string/title_activity_main" >
    </activity>
    <activity
        android:name=".OpenedClass"
        android:label="@string/title_activity_main" >
    </activity>
    <activity
        android:name=".AboutUs"
        android:label="@string/title_activity_main"
        android:theme="@android:style/Theme.Dialog" >
        <intent-filter>
            <action android:name="com.armstrong.yi.android.app.ABOUT" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.armstrong.yi.android.app.GlobalVariables"
        android:label="@string/title_activity_main" >
    </activity>
    <activity
        android:name=".Prefs"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="com.armstrong.yi.android.app.PREFS" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
</application>

    </manifest> 
```

**错误日志**

```
01-23 17:44:40.877: W/dalvikvm(2095): threadid=1: thread exiting with uncaught exception (group=0x40a70930)
01-23 17:44:40.957: E/AndroidRuntime(2095): FATAL EXCEPTION: main
01-23 17:44:40.957: E/AndroidRuntime(2095): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.armstrong.yi.android.app/com.armstrong.yi.android.app.Prefs}: java.lang.RuntimeException: XML document must start with <preference-headers> tag; foundPreferenceScreen at Binary XML file line #2
01-23 17:44:40.957: E/AndroidRuntime(2095):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
01-23 17:44:40.957: E/AndroidRuntime(2095):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
01-23 17:44:40.957: E/AndroidRuntime(2095):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
01-23 17:44:40.957: E/AndroidRuntime(2095):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
01-23 17:44:40.957: E/AndroidRuntime(2095):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-23 17:44:40.957: E/AndroidRuntime(2095):     at android.os.Looper.loop(Looper.java:137) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:06:36.520

您需要添加另一个文件，例如`pref_headers.xml`因为 Android 也可以使用标题来确定如何显示首选项。请参阅[文档](http://developer.android.com/reference/android/preference/PreferenceActivity.html)。

在其中，输入您的 Fragment 的名称

```
<preference-headers xmlns:android="http://schemas.android.com/apk/res/android" >

    <header
        android:fragment="com.myapp.MyFragment"
        android:title="My header" />

</preference-headers> 
```

为其他片段添加更多`header`标签。

然后改变

```
loadHeadersFromResource(R.xml.prefs, target); 
```

至

```
loadHeadersFromResource(R.xml.pref_headers.xml, target); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-05T21:08:55.567

我解决了：

```
Intent intent = new Intent(this, ActivityPreferences.class);
intent.putExtra(ActivityPreferences.EXTRA_NO_HEADERS, true );   
intent.putExtra(ActivityPreferences.EXTRA_SHOW_FRAGMENT,FragmentPreferences.class.getName());
startActivity(intent); 
```

# c++ - 如何在OpenGL中画线？

> ID：14486291
> 
> 赞同：17
> 
> 时间：2013-01-23T18:00:12.380
> 
> 标签：c++, opengl, line

我想在OpenGL中画一条线。

```
 glBegin(GL_LINES);
    glVertex2f(.25,0.25);
    glVertex2f(.75,.75);
glEnd(); 
```

这段代码画了一条线，但是如果我想画一条从坐标（10,10）到坐标（20,20）的线，我该怎么办？

(.25,.25) 和 (.75, .75) 是什么意思？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-01-23T18:54:46.287

(.25, .25) 和 (.75,.75) 是线的起点和终点。

从 (10,10) 到 (20,20) 画一条线：

```
glBegin(GL_LINES);
    glVertex2f(10, 10);
    glVertex2f(20, 20);
glEnd(); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2019-01-07T06:26:28.557

**使用 OpenGL2：**

中的每个点值`glVertex2f`都在 -1 和 1 之间，左下角是 (-1, -1)，右上角是 (1,1)，中心是 (0, 0)。

要将绝对点映射到标准化空间：

*   除以`x`窗口宽度 ,`w`得到 0 到 1 范围内的点。

*   将它乘以 2 得到 0 到 2 的范围。

*   减去 1 以获得所需的 -1 到 1 范围。

*   重复`y`值和窗口高度，`h`。

例如：

```
double x1 = 10;
double y1 = 10;
double x2 = 20;
double y2 = 20;

x1 = 2*x1 / w - 1;
y1 = 2*y1 / h - 1;

x2 = 2*x2 / w - 1;
y2 = 2*y2 / h - 1;

glBegin(GL_LINES);
    glVertex2f(x1, y1);
    glVertex2f(x2, y2);
glEnd(); 
```

**使用 OpenGL3+：** 使用可编程管道画线稍微复杂一些。您可以创建一个`Line`类，它将获取两个点并将它们发送到 GPU，并使用简单的着色器程序绘制它们。所有设置都可以在构造函数中完成，并且可以使用一些访问函数进行修改：

```
class Line {
    int shaderProgram;
    unsigned int VBO, VAO;
    vector<float> vertices;
    vec3 startPoint;
    vec3 endPoint;
    mat4 MVP;
    vec3 lineColor;
public:
    Line(vec3 start, vec3 end) {

        startPoint = start;
        endPoint = end;
        lineColor = vec3(1,1,1);
        MVP = mat4(1.0f);

        const char *vertexShaderSource = "#version 330 core\n"
            "layout (location = 0) in vec3 aPos;\n"
            "uniform mat4 MVP;\n"
            "void main()\n"
            "{\n"
            "   gl_Position = MVP * vec4(aPos.x, aPos.y, aPos.z, 1.0);\n"
            "}\0";
        const char *fragmentShaderSource = "#version 330 core\n"
            "out vec4 FragColor;\n"
            "uniform vec3 color;\n"
            "void main()\n"
            "{\n"
            "   FragColor = vec4(color, 1.0f);\n"
            "}\n\0";

        // vertex shader
        int vertexShader = glCreateShader(GL_VERTEX_SHADER);
        glShaderSource(vertexShader, 1, &vertexShaderSource, NULL);
        glCompileShader(vertexShader);
        // check for shader compile errors

        // fragment shader
        int fragmentShader = glCreateShader(GL_FRAGMENT_SHADER);
        glShaderSource(fragmentShader, 1, &fragmentShaderSource, NULL);
        glCompileShader(fragmentShader);
        // check for shader compile errors

        // link shaders
        shaderProgram = glCreateProgram();
        glAttachShader(shaderProgram, vertexShader);
        glAttachShader(shaderProgram, fragmentShader);
        glLinkProgram(shaderProgram);
        // check for linking errors

        glDeleteShader(vertexShader);
        glDeleteShader(fragmentShader);

        vertices = {
             start.x, start.y, start.z,
             end.x, end.y, end.z,

        };

        glGenVertexArrays(1, &VAO);
        glGenBuffers(1, &VBO);
        glBindVertexArray(VAO);

        glBindBuffer(GL_ARRAY_BUFFER, VBO);
        glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices.data(), GL_STATIC_DRAW);

        glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof(float), (void*)0);
        glEnableVertexAttribArray(0);

        glBindBuffer(GL_ARRAY_BUFFER, 0); 
        glBindVertexArray(0); 

    }

    int setMVP(mat4 mvp) {
        MVP = mvp;
        return 1;
    }

    int setColor(vec3 color) {
        lineColor = color;
        return 1;
    }

    int draw() {
        glUseProgram(shaderProgram);
        glUniformMatrix4fv(glGetUniformLocation(shaderProgram, "MVP"), 1, GL_FALSE, &MVP[0][0]);
        glUniform3fv(glGetUniformLocation(shaderProgram, "color"), 1, &lineColor[0]);

        glBindVertexArray(VAO);
        glDrawArrays(GL_LINES, 0, 2);
        return 1;
    }

    ~Line() {

        glDeleteVertexArrays(1, &VAO);
        glDeleteBuffers(1, &VBO);
        glDeleteProgram(shaderProgram);
    }
}; 
```

用 初始化一些 3D 线`Line line(vec3 ..., vec3 ...)`，设置模型-视图-投影矩阵`line.setMVP(projection * view * model)`并`line.draw()`旋转相机将产生如下结果：

[![xyz 轴](../Images/89455e6b233da26bffc396e6aa326e9e.png)](https://i.stack.imgur.com/cXTce.gif)

[示例代码](https://pastebin.com/um94B1pg)

**注意：**如果您只需要 2D 线，您只需指定 vec3 端点坐标，z 值设置为 0，并从`setMVP`调用中删除投影矩阵，并将相机位置设置为 (0,0,0) . 这同样适用于绘制 OpenGL2 的 2D 线，因此需要将坐标发送到 NDC 空间中的 OpenGL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-27T16:05:39.593

试试这个，你可以选择**颜色**和调整**线宽**。

```
def drawline(self, x1, y1, z1, x2, y2, z2, r=0, g=0, b=0, w=2):

    glLineWidth(w)
    glBegin(GL_LINES)
    glColor3fv((r/255, g/255, b/255))
    glVertex3fv((x1, y1, z1))
    glVertex3fv((x2, y2, z2))
    glEnd() 
```

# php - 覆盖onclick，在单个单元格中切换模式

> ID：14486292
> 
> 赞同：1
> 
> 时间：2013-01-23T18:00:13.943
> 
> 标签：php, javascript, jquery, html

我有一个表格，其中每一行都可以使用

```
 echo "<tr class=\"trlink\" onclick=\"location.href='".$row['task_id']."'\">\n"; 
```

那里没有问题。

然后我在这一行的一个单元格内有三个链接。指向不同页面的两个工作正常。但是，有一个链接可以切换模式对话框，它不会与标签中包含的 onclick 一起显示。没有它也能正常工作。我使用以下内容作为

```
<a role=\"button\" href=\"#" . $row['task_id'] . "taskModal\" data-toggle=\"modal\"> 
```

每当单击链接时，它都会直接转到分配给 . 我认为问题在于事件冒泡。我做了一些谷歌搜索，发现了一个小的 Javascript 脚本来取消单击模态触发器时的冒泡：

```
function cancelIt(evt) {
var e = (typeof evt != 'undefined') ? evt : event;
e.cancelBubble = true;
} 
```

和

```
<a href=\"...\" onclick=\"cancelIt(event);\" > 
```

在模态触发器上

这解决了单击时加载初始链接的问题，但是模式也不显示。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:11:27.667

`onclick`如果您使用 jQuery 检测页面，我不建议使用该事件。相反，使用以`click`编程方式分配的处理程序。这样可以确保您不会不小心踩到某些东西。

如果没有更多细节（可能是 jsfiddle），很难确定您的特定问题是什么，但您可以尝试的一件事是将某种选择器添加到适当的锚标记，然后使用类似于以下的范例：

```
<script>
  $(function() {
    $('#anchorTagICareAbout').click(function(e) {
      e.preventDefault();
      displayModalDialog();
    });

  });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:08:51.220

我有[一个可行的解决方案](http://jsfiddle.net/KWqmY/3/)。这可能是一种黑客方式，但它确实有效。请注意，我还将模态框移到`<div>`之外，`<tr>`因为当我关闭模态框时，它将遵循`<tr>`.

```
<script type="text/javascript">
var trlink = true;
</script> 
```

上面设置了单击时要检查的变量`tr onclick`。

```
<tr onclick=\"if(trlink) {location.href='google.com'} else { trlink = true; }> 
```

这会在打开链接之前检查 trlink 是否为真，如果不是，则将其设置为真。

```
<a onclick="trlink = false" role="button" href="#1printerModal" data-toggle="modal">None</a> 
```

最后，在此标记中执行任何操作之前，这会将 trlink 变量设置为 false。

我无法正确处理事件，但这似乎可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:50:27.863

您可以简单地使用“onmousedown”事件。

```
<a role=\"button\" href=\"#" . $row['task_id'] . "taskModal\" data-toggle=\"modal\" 
onmousedown=\"event.cancelBubble=true;event.returnValue=false;document.location.hash=this.getAttribute('href').replace('#','');return false;\"> 
```

这是一个小演示 jsfiddle：http: [//jsfiddle.net/r4dnp/6/](http://jsfiddle.net/r4dnp/6/)

始终首选使用适当的脚本分配的事件处理程序，但以上将完成工作。代码的关键部分：

```
document.location.hash=this.getAttribute('href').replace('#','') 
```

将 document.location.hash 设置为等于链接 HREF 的值。

# jquery - 带有类别和 ColdFusion 的 jQuery 自动完成功能

> ID：14486300
> 
> 赞同：0
> 
> 时间：2013-01-23T18:00:36.003
> 
> 标签：jquery, coldfusion, jquery-ui-autocomplete

我需要根据 ColdFusion 查询生成带有类别的自动完成功能。这是我的查询：

```
<cfquery name = "GetEvents" datasource = "tcc">
SELECT '{ label: "' + cE_Title + '", category: "Tournaments" }' as cE_Title
,'{ label: "' + cE_Location + '", category: "Locations" }' as cE_Location
FROM CourseEvents 
```

然后我把每条记录放到一个列表中，追加列表，然后把列表变成一个数组：

```
<cfset myList = ValueList(GetEvents.cE_Title)>
<cfset myList2 = ValueList(GetEvents.cE_Location)>
<cfset myListApp = ListAppend(myList,myList2)>
<cfset myArrayList = ListToArray(myListApp)> 
```

这是我的脚本：

```
<script>
 $.widget( "custom.catcomplete", $.ui.autocomplete, {
_enderMenu: function( ul, items ) {
  var that = this,
    currentCategory = "";
  $.each( items, function( index, item ) {
    if ( item.category != currentCategory ) {
      ul.append( "<li class='ui-autocomplete-category'>" + item.category + "</li>" );
      currentCategory = item.category;
    }
    that._renderItemData( ul, item );
  });
}
});
</script>
<script>
  $(function() {
    <cfoutput>
       var #toScript(myArrayList, "jsVar")#;
    </cfoutput>
    var availableTags = jsVar;

    $( "#EventSearch" ).catcomplete({
     delay: 0,
     source: availableTags
    });
  });
</script> 
```

结果应如下所示：

```
Tournaments
 2nd Annual March Madness Scramble
 River Run Golf Classic

Locations
 Trump International Golf Club
 Stoneybrook Golf and Country Club 
```

但是，它们看起来像这样：

```
{ label: "2nd Annual March Madness Scramble"
category: "Tournaments" }
{ label: "River Run Golf Classic"
category: "Tournaments" }
{ label: "Trump International Golf Club"
category: "Locations" }
{ label: "Stoneybrook Golf and Country Club"
category: "Locations" } 
```

这是一个演示：[http ://www.thecoursecaddy.com/c/sandbox/golfevents.cfm](http://www.thecoursecaddy.com/c/sandbox/golfevents.cfm)

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T20:13:47.660

这是如何做到的。 [在此处查看演示](http://www.thecoursecaddy.com/c/sandbox/golfevents.cfm)。

感谢大家的帮助。

```
<!--- Get List of Events --->
<cfquery name = "GetEvents" datasource = "tcc">
SELECT cE_Title, cE_Location
FROM CourseEvents
</cfquery>

<cfset dataset = [] />

<cfloop query="GetEvents">
 <cfset record = {} />
 <cfset record['label'] = GetEvents.cE_Title />
 <cfset record['category'] = "Tournaments" />
 <cfset ArrayAppend(dataset, record) />
</cfloop>

<cfloop query="GetEvents">
 <cfset record = {} />
 <cfset record['label'] = GetEvents.cE_Location />
 <cfset record['category'] = "Locations" />
 <cfset ArrayAppend(dataset, record) />
</cfloop>

<style>
.ui-autocomplete-category {
 font-weight: bold;
 padding: .2em .4em;
 margin: .8em 0 .2em;
 line-height: 1.5;
 font-size:13px;
}
.ui-menu-item a {
 font-size:11px;
}
</style>
<script>
 $.widget( "custom.catcomplete", $.ui.autocomplete, {
 _renderMenu: function( ul, items ) {
  var that = this,
    currentCategory = "";
  $.each( items, function( index, item ) {
    if ( item.category != currentCategory ) {
      ul.append( "<li class='ui-autocomplete-category'>" + item.category + "</li>" );
      currentCategory = item.category;
    }
    that._renderItemData( ul, item );
  });
 }
});
</script>
<script>
 $(function() {
  <cfoutput>
     var jsVar = #SerializeJSON(dataset)#;
  </cfoutput>
  var availableTags = jsVar;

  $( "#EventSearch" ).catcomplete({
   delay: 0,
   source: availableTags
  });
});
</script>

<body>
 <cfform action="#cgi.script_name#" method="post">
  <cfinput type="text" id="EventSearch" name="EventSearch">
 </cfform>
</body> 
```

# django - 在 django 中获取 soundcloud 授权码

> ID：14486312
> 
> 赞同：0
> 
> 时间：2013-01-23T18:01:27.203
> 
> 标签：django, soundcloud

我正在尝试让 soundcloud 授权我的 django 应用程序，该应用程序已成功注册到 soundcloud。我传入注册期间提供的详细信息以及回调 uri (http://localhost:8000/profile/)。

我调用了登录页面，它提示我允许我的应用程序访问我的 soundcloud 帐户。我接受。

```
def login(request):
    if request.method == 'GET':
        client = soundcloud.Client(
            client_id=settings.CLIENT_ID, 
            client_secret=settings.CLIENT_SECRET,
            redirect_uri=settings.REDIRECT_URI,
            )

        return HttpResponseRedirect(client.authorize_url())
    return render(request, 'login.html', {}) 
```

Soundcloud 为我的回调链接提供了附加的授权代码。

```
http://localhost:8000/profile/?code=xxxxxxxxxxxxxxxx...etc...&signed_up=0 
```

要提取代码以获取交换令牌，我这样做：

```
 urlpatterns = patterns('core.views',

    url(r'^login/$', 'login', name='login'),
    (r'^profile/\?code=(?P<code>[\d\w]{32}).*/$', 'profile'),

    url(r'^admin/', include(admin.site.urls)),
) 
```

但得到一个“找不到页面”。我在这里做错了什么？我检查了shell中的正则表达式，它返回了代码......

我是 oAuth 和 api 的新手，因此不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:15:43.597

使您的 URL 模式如下所示：

```
urlpatterns = patterns('core.views',
    url(r'^login/$', 'login', name='login'),
    url(r'^profile/$', 'profile'),
    url(r'^admin/', include(admin.site.urls)),
) 
```

在您的个人资料视图中，您可以`code`从查询字符串中获取如下信息：

```
def profile(request):
    code = request.GET.get("code", None)
    if not code:
        ## code has not been set in query string
        ## do something

    ## do something with code you have 
```

简单易行！！

# java - Intellij Idea 12.0.2 的新手，如何删除项目

> ID：14486326
> 
> 赞同：1
> 
> 时间：2013-01-23T18:02:25.260
> 
> 标签：java, intellij-idea

如何从 IDEA 列表中删除项目。另外，有人可以告诉我使用 IntelliJ 的优点，以便我可以说服一些 Eclipse 用户也使用这个产品吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T18:14:53.357

您问题的第一部分是几个不同帖子的副本，例如[这个。](https://stackoverflow.com/questions/8465875/how-do-i-delete-project-in-intellij-idea-10-5) 您可能还想参考[intellij 帮助系统寻求帮助。](http://www.jetbrains.com/idea/webhelp/intellij-idea.html)

您问题的第二部分非常主观，因为每个程序员对 IDE 都有不同的需求/需求/愿望。但是，对于它的价值，请查看以下内容：

*   [intellij 与 eclipse 相比如何更好（programmers.stackexchange.com）](https://softwareengineering.stackexchange.com/questions/21987/how-is-intellij-better-than-eclipse)
*   [Intellij 与 Eclipse（代码极客）](http://www.javacodegeeks.com/2012/01/intellij-vs-eclipse.html)
*   [一篇博文](http://caffeinbean.wordpress.com/2012/07/29/a-sequel-to-netbeans-vs-eclipse-comparison-verdict-is-intellij/)
*   [JetBrains 功能页面](http://www.jetbrains.com/idea/features/?fromIndex)

有很多资源可供比较。但是我遇到的最好的建议是：使用它两周，如果它适合你，那就使用它；如果没有，那么不要。

# linux - 如何在 deb 包中打包共享库

> ID：14486335
> 
> 赞同：2
> 
> 时间：2013-01-23T18:02:58.287
> 
> 标签：linux, package, debian, shared-libraries

我的应用程序使用了一些私有共享库，我需要将其与二进制文件一起打包，并根据 Debian 政策规则

> 建议将不需要用户手动调用但仍然需要软件包才能运行的支持文件和运行时支持程序放置（如果它们是二进制文件）在 /usr/lib 的子目录中，最好在 /usr/lib/package-name 下。

所以，我把我的共享库，例如 libabc.so 放在 /usr/lib/myapp/ 目录中。创建 debian 包后，二进制文件无法加载，因为加载程序未搜索 /usr/lib/myapp/ 以加载目录。他们不建议在二进制文件中使用**RPATH 。**那么我应该在 debian 包中进行哪些更改，或者在二进制文件或其他任何东西的编译中使其工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T11:22:29.420

如果您的共享库对其他（可能在未来的）应用程序有任何用途，并且该库有一个公共接口，您可能会考虑将其`/usr/lib/`直接安装到其中（或者更确切地说`/usr/lib/<host-triplet>`是为了支持多架构）。

如果这不是一个选项（因为您的共享库确实是私有的），请检查其他应用程序如何处理它。对我的系统的快速调查显示，两者`ardour`都有`gedit`私有 shlib `/usr/lib/<pkgname>/`。

## 热情

`ardour`使用（imo）相当hackish的方式：可执行文件`/usr/bin/ardour2`实际上只是一个shellscript，它使用一些LD_LIBRARY_PATH软糖来扭曲调用真正的二进制文件：

```
export LD_LIBRARY_PATH=/usr/lib/ardour2${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}
/usr/lib/ardour2/ardour-bin 
```

## 编辑

使用`gedit`，上游已正确转移到安装`libgedit-private.so`为`pkglib`（转到 的库的自动工具术语`/usr/lib/<pkgname>`）。

`autotools`自动处理解析（大概使用类似的东西`rpath`）。

最后，当我阅读 debian-policy`rpath`时，对于*非私有*库（其他应用程序可能使用的库）不赞成。我不认为这是一个问题，但当然这是我对政策的解释。您可能想查看其中一个 Debian 频道，例如他们的 IRC 或一些邮件列表。

# c# - WCF 响应时间峰值

> ID：14486336
> 
> 赞同：2
> 
> 时间：2013-01-23T18:03:10.060
> 
> 标签：c#, wcf

我有一个带有开箱即用 HTTP 绑定的 WCF 服务。它接受一个数据对象，在该对象上运行一些计算，然后返回该对象。

一个电话大约需要 1.5 秒，并且可以正常工作。但是并发调用可能会导致完成时间的巨大峰值（10 个并发调用可能需要长达 60 秒）。即使我一个接一个地运行多个呼叫，我也会看到所用时间从 1.5 秒跳到超过 5 秒的峰值。

我目前将服务配置为单上下文模式和多并发模式。但我尝试了其他组合无济于事。

谁能为这些看似随机的尖峰提供可能的原因？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T09:59:54.957

该问题是由于每次调用都执行数据库读取而只需要执行一次。

我添加了一项检查以确保仅在尚未加载数据时才执行数据库读取，这解决了问题。

# xsd - WSO2 ESB 代理服务导入 XSD 错误

> ID：14486337
> 
> 赞同：1
> 
> 时间：2013-01-23T18:03:14.213
> 
> 标签：xsd, wsdl, wso2, wso2esb, esb

我想将 ServiceManager WSDL 连接到 WSO2 esb 作为代理服务的目标。我在同一个开发系统上安装了 SM9 和 WSO2esb。SoapSonar 将用于检查我的 esb 配置的结果。

我的服务定义如下所示：

```
 <proxy name="SM9Lcl1IM" transports="http" startOnLoad="true" trace="enable" statistics="enable">
    <description>Incident Management Local SM9</description>
    <target>
        <endpoint>
            <address uri="http://localhost:19380/sc62server/PWS"/>
        </endpoint>
        <outSequence>
            <send/>
        </outSequence>
    </target>
    <publishWSDL uri="http://localhost:19380/sc62server/PWS/IncidentManagement.wsdl"/>
</proxy> 
```

不幸的是我无法解决问题，xsd 文件必须传输到客户端。SoapSonar 通过一个弹出窗口告诉我，它想知道在哪里可以找到

```
SM9Lcl1IM?xsd=http://VMDEMOW2K3:19380/sc62server/PWS/Common.xsd 
```

我检查了wsdl，发现如下语句：

```
<xs:import namespace="http://servicecenter.peregrine.com/PWS/Common" schemaLocation="http://VMDEMOW2K3:19380/sc62server/PWS/Common.xsd"/>' 
```

所以我尝试了几件事：

*   我复制了 WSDL 内联，定义了一个位置/密钥对并尝试在用户注册表中定义密钥
*   我检查了突触文档......似乎他们在过去也有这个问题。这两个建议都不能在 WS=2 中配置。我也在 Synapse 中尝试过——同样的问题。我尝试了 synapse 的代理示例（misc/proxy 文件夹中的 synapse.xml） - 这有效！啊......所以它应该以某种方式工作......
*   我认为 WSO2 的 GUI 以及单独的突触安装的 xml 配置有很多时间。没有任何效果。

是否有解决此问题的提示或设置指南？这些样本很好，但它们太简单了，无法从中得出解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T13:39:32.327

我解决了，但解决方案并不让我满意。我将 xsd 的内容包含在 wsdl 中，因此不需要导入。该解决方案有效，但颠倒了 xsd 的模块化概念。

我认为，这个问题与突触中的一个较旧的错误（wso2 esb 中的基础）有关，而且就它看起来，它根本没有最终解决。

如果您有更好的解决方案，请告诉我，因为我想要一个支持模块化概念的解决方案。

# javascript - Javascript Infovis 双链接节点

> ID：14486342
> 
> 赞同：1
> 
> 时间：2013-01-23T18:03:22.250
> 
> 标签：javascript, canvas, directed-graph, infovis

我正在使用 Javscript InfoVis 工具包。顺便说一句，感谢开发它的人。太棒了。无论如何，我有两个问题。我有一个从 .dot 文件中解析出来的信息绘制的有向图，并且一些节点需要是 A) 双重链接的，或者我需要有两个边`A->B`并`B->A`在图表上显示，并且 B) 能够有 slef - 显示参考边。

A）我认为该图`A-B`在绘制新边之前会自动检查任何方向之间是否存在边，并看到该边`A->B`已经存在并且没有绘制`B->A`。我确实知道`B->A`在这种情况下实际上根本没有绘制。我目前正在 jit.js 核心中寻找修复它的检查。另外，如果我确实要显示返回边缘，我怎样才能稍微弯曲边缘，以便我可以在图中看到它们？我在想我可以在`onBeforePlotLine:`jit.js 部分实现一些东西。

B) 我认为 A) 中边缘弯曲的解决方案将赋予我展示自我参照边缘的能力。该边缘实际上正在被绘制，但由于它的起点和终点相同，因此不可见。

如果有人有解决这些问题的任何经验，请提供帮助。提前致谢！

# opencv - 摄像机移动的 OpenCV 视频/图像拼接。SIFT 功能不够？

> ID：14486346
> 
> 赞同：1
> 
> 时间：2013-01-23T18:03:33.313
> 
> 标签：opencv, sift, image-stitching

我正在尝试注册从具有连续相机移动的短片中提取的图像。我有检测 -> 匹配 -> 干净匹配 -> 单应性工作的“常规”管道。典型的 SIFT 示例（Basmati，Cookiebox ...）的结果非常有效。
我的图像
a) 不会产生很多特征
b) 非常接近相同
c) 可能包括大的相似区域（墙壁）

问题
1）您会建议一些不同的方法吗？特别是当可以假设连续运动并且图像非常相似时。
2）我如何实现初始猜测（身份，简单滚动......），以优化“findHomography”计算的内容？
3）你建议对匹配项进行什么分析/过滤（见图）？PCA 可能对相机平移运动的约束？
4）我错过/做错的其他事情？

这些图像显示了平均到更差的结果。（右边的绿线是转换后的四边形。忽略中间的小绿线）有些对的配准会差很多。

[http://www.cs.hs-rm.de/~schweitz/siftmatch.jpg](http://www.cs.hs-rm.de/~schweitz/siftmatch.jpg)
[http://www.cs.hs-rm.de/~schweitz/siftmatch2.jpg](http://www.cs.hs-rm.de/~schweitz/siftmatch2.jpg)
h**p://www.cs .hs-rm.de/~schweitz/siftmatch3.jpg

# c - 播放 .wav C Mac

> ID：14486347
> 
> 赞同：1
> 
> 时间：2013-01-23T18:03:46.257
> 
> 标签：c

我正在寻找一种在我的 c 程序中播放 .wav 文件的简单方法。我已经用谷歌搜索了这样做的方法，但大多数答案都来自 Windows 的 PlaySound()，而且我正在运行 mac。任何答案表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T19:12:03.803

您可以`afplay`在 Mac 上使用终端命令播放声音文件，例如`wav`或`mp3`. 由于您可以在 C 中使用 运行命令`system()`，因此您可以简单地使用以下代码：

```
int main() {
    system("afplay sound.wav");
    // ...
    return 0;
} 
```

# junit - 使用 JBoss 4.2.2 GA 进行 Arquillian 测试以“无法获取 DeploymentManager”结束

> ID：14486348
> 
> 赞同：1
> 
> 时间：2013-01-23T18:03:51.847
> 
> 标签：junit, jboss-4.2.x, jboss-arquillian

我尝试在已安装的 JBoss 上使用 arquillian 做一个简单的测试示例，其版本为 4.2.2GA。花了很多时间在这个社区和堆栈流中做了很多阅读，但就是不知道如何让它工作。

现在的测试是这样的：

```
package com.ultramain.system.view.test;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;

import javax.ejb.EJB;

import org.jboss.arquillian.container.test.api.Deployment;
import org.jboss.arquillian.junit.Arquillian;
import org.jboss.shrinkwrap.api.ShrinkWrap;
import org.jboss.shrinkwrap.api.spec.JavaArchive;
import org.jboss.shrinkwrap.api.asset.StringAsset;
import org.jboss.shrinkwrap.api.spec.EnterpriseArchive;
import org.jboss.shrinkwrap.descriptor.api.Descriptors;

import org.junit.Test;
import org.junit.runner.RunWith;

import com.ultramain.system.view.test.IShrinkWrapBasicTest;
import com.ultramain.system.view.test.ShrinkWrapBasicTest;

@RunWith(Arquillian.class)
public class QuerySimulationContainer {

@EJB
private IShrinkWrapBasicTest testObject;

@Deployment
public static JavaArchive createDeployment() {
JavaArchive jar = ShrinkWrap.create(JavaArchive.class)
    .addClasses(QuerySimulationContainer.class,IShrinkWrapBasicTest.class,ShrinkWrapBasicTest.class);
System.out.println(jar.toString(true));
//System.out.println(jar.getContent());    
return jar; 
}

@Test 
public void testShrinkWrapWorks(){
    testObject = new ShrinkWrapBasicTest();
    assertEquals(testObject.getTestText(), "Test for ShrinkWrap");
} 
```

}

测试单元需要的接口和类如下：

IShrinkWrapBasicTest.java：

```
package com.ultramain.system.view.test;

import javax.ejb.Remote;

@Remote
public interface IShrinkWrapBasicTest
{
    public String getTestText();

    public void testMethod();
} 
```

ShrinkWrapBasicTest.java：

```
package com.ultramain.system.view.test;

import javax.ejb.Stateless;
import javax.ejb.Local;

@Stateless
public class ShrinkWrapBasicTest implements IShrinkWrapBasicTest
{ 
    public String getTestText()
    {
        return "Test for ShrinkWrap";
    }

    public void testMethod(){
    }
} 
```

我的 pom.XML 中更改的部分在并列出如下： pom.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
                      http://maven.apache.org/xsd/maven-4.0.0.xsd">

<!-- other parts in pom.XML which haven't been changed -->

    <dependencies>
        <!-- other dependency parts in original pom.XML, which haven't been changed after using arquillian -->

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-annotations</artifactId>
            <version>3.2.1.ga</version>
        </dependency>
        <dependency>
            <groupId>org.apache.commons</groupId>
            <artifactId>commons-math</artifactId>
            <version>2.0</version>
        </dependency>
        <dependency>
            <groupId>javax.jee</groupId>
            <artifactId>jee</artifactId>
            <version>5.0</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>jboss</groupId>
            <artifactId>jboss-annotations-ejb3</artifactId>
            <version>4.2.0.GA</version>
        </dependency>
        <dependency>
            <groupId>org.jboss.arquillian</groupId>
            <artifactId>arquillian-bom</artifactId>
            <version>1.0.3.Final</version>
            <scope>import</scope>
            <type>pom</type>
        </dependency>            
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.8.1</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.jboss.arquillian.junit</groupId>
            <artifactId>arquillian-junit-container</artifactId>
            <version>1.0.3.Final</version>            
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>javax.ejb</groupId>
            <artifactId>ejb-api</artifactId>
            <version>3.0</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>dom4j</groupId>
            <artifactId>dom4j</artifactId>
            <version>1.6.1-jboss</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.jboss.spec</groupId>
            <artifactId>jboss-javaee-5.0</artifactId>
            <version>1.0.0.GA</version>
            <type>pom</type>
            <scope>provided</scope>
        </dependency>    
        <dependency>
            <groupId>org.jboss.client</groupId>
             <artifactId>jmx-invoker-adaptor-client</artifactId>
              <version>4.2.2.GA</version>
              <scope>test</scope>
        </dependency>    
        <dependency>
            <groupId>org.jboss.arquillian.container</groupId>
            <artifactId>arquillian-jbossas-remote-4.2</artifactId>
            <version>1.0.0.Final-SNAPSHOT</version>
            <scope>test</scope>
        </dependency>
        <dependency>
          <groupId>org.jboss.arquillian.container</groupId>
          <artifactId>arquillian-container-spi</artifactId>
          <version>1.0.3.Final</version>
          <scope>test</scope>
        </dependency>
        <dependency>
          <groupId>org.jboss.arquillian.container</groupId>
          <artifactId>arquillian-container-test-spi</artifactId>
          <version>1.0.3.Final</version>
          <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.jboss.arquillian.protocol</groupId>
            <artifactId>arquillian-protocol-servlet</artifactId>
            <version>1.0.3.Final</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>jboss</groupId>
            <artifactId>jbossall-client</artifactId>
            <version>4.2.2.GA</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.jboss.deployers</groupId>
            <artifactId>jboss-deployers-client-spi</artifactId>
            <version>2.2.2.GA</version>
            <scope>test</scope>
        </dependency>
        <dependency>
          <groupId>org.jboss.deployers</groupId>
          <artifactId>jboss-deployers-core-spi</artifactId>
          <version>2.2.2.GA</version>
              <scope>test</scope>
        </dependency>         
        <dependency>
            <groupId>org.jboss.shrinkwrap.descriptors</groupId>
            <artifactId>shrinkwrap-descriptors-impl-javaee</artifactId>
            <version>2.0.0-alpha-4</version>
            <scope>test</scope>
        </dependency>
        <dependency>
          <groupId>org.jboss.shrinkwrap</groupId>
          <artifactId>shrinkwrap-api</artifactId>
          <version>1.1.1-alpha-2</version>
          <scope>test</scope>
        </dependency>
        <dependency>
          <groupId>org.jboss.shrinkwrap.resolver</groupId>
          <artifactId>shrinkwrap-resolver-bom</artifactId>
          <version>2.0.0-alpha-6</version>
          <type>pom</type>
          <scope>test</scope>
        </dependency>
        <dependency>
          <groupId>org.jboss.shrinkwrap.resolver</groupId>
          <artifactId>shrinkwrap-resolver-depchain</artifactId>
          <version>2.0.0-alpha-6</version>
          <type>pom</type>
          <scope>test</scope>
        </dependency>    

       <!-- other dependency parts in original pom.XML, which haven't been changed after using arquillian -->
    </dependencies>
<!-- other parts in original pom.XML, which haven't been changed after using arquillian -->
</project> 
```

我正在使用 jndi.properties 文件、aquillian.launch 文件和下面列出的另一个 arquillian.xml：

jndi.properties（这里的 URL 是我们用来启动 JBOSS 服务器的 ip 地址）：

```
java.naming.factory.initial=org.jnp.interfaces.NamingContextFactory
java.naming.factory.url.pkgs=org.jboss.naming\:org.jnp.interfaces 
java.naming.provider.url=jnp://URL:1099 
```

arquilllian.launch：

```
local 
```

arquillian.xml（这里的URL是我们用来启动JBOSS服务器的ip地址）：

```
<?xml version="1.0"?>
<arquillian xmlns="http://jboss.org/schema/arquillian"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
        http://jboss.org/schema/arquillian
        http://jboss.org/schema/arquillian/arquillian_1_0.xsd">        
    <container qualifier="local" default="true">
        <configuration>
            <property name="profileName">local</property>
            <property name="providerUrl">jnp://URL:1099</property>      
            <property name="contextFactory">org.jnp.interfaces.NamingContextFactory</property>
            <property name="urlPkgPrefix">org.jboss.naming:org.jnp.interfaces</property>
        </configuration>   
        <protocol type="Servlet 2.5">
                <property name="host">URL</property>
                <property name="port">8080</property>
        </protocol>          
    </container>
</arquillian> 
```

故障跟踪是：

```
org.jboss.arquillian.container.spi.client.container.LifecycleException: Could not connect to container
    at org.jboss.arquillian.container.jbossas.remote_4_2.JBossASRemoteContainer.start(JBossASRemoteContainer.java:97)
    at org.jboss.arquillian.container.impl.ContainerImpl.start(ContainerImpl.java:199)
    at org.jboss.arquillian.container.impl.client.container.ContainerLifecycleController$8.perform(ContainerLifecycleController.java:163)
    at org.jboss.arquillian.container.impl.client.container.ContainerLifecycleController$8.perform(ContainerLifecycleController.java:157)
    at org.jboss.arquillian.container.impl.client.container.ContainerLifecycleController.forContainer(ContainerLifecycleController.java:255)
    at org.jboss.arquillian.container.impl.client.container.ContainerLifecycleController.startContainer(ContainerLifecycleController.java:156)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.arquillian.core.impl.ObserverImpl.invoke(ObserverImpl.java:94)
    at org.jboss.arquillian.core.impl.EventContextImpl.invokeObservers(EventContextImpl.java:99)
    at org.jboss.arquillian.core.impl.EventContextImpl.proceed(EventContextImpl.java:81)
    at org.jboss.arquillian.container.impl.client.ContainerDeploymentContextHandler.createContainerContext(ContainerDeploymentContextHandler.java:57)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.arquillian.core.impl.ObserverImpl.invoke(ObserverImpl.java:94)
    at org.jboss.arquillian.core.impl.EventContextImpl.proceed(EventContextImpl.java:88)
    at org.jboss.arquillian.core.impl.ManagerImpl.fire(ManagerImpl.java:135)
    at org.jboss.arquillian.core.impl.ManagerImpl.fire(ManagerImpl.java:115)
    at org.jboss.arquillian.core.impl.EventImpl.fire(EventImpl.java:67)
    at org.jboss.arquillian.container.impl.client.container.ContainerLifecycleController$2.perform(ContainerLifecycleController.java:77)
    at org.jboss.arquillian.container.impl.client.container.ContainerLifecycleController$2.perform(ContainerLifecycleController.java:70)
    at org.jboss.arquillian.container.impl.client.container.ContainerLifecycleController.forEachSuiteContainer(ContainerLifecycleController.java:221)
    at org.jboss.arquillian.container.impl.client.container.ContainerLifecycleController.startSuiteContainers(ContainerLifecycleController.java:69)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.arquillian.core.impl.ObserverImpl.invoke(ObserverImpl.java:94)
    at org.jboss.arquillian.core.impl.EventContextImpl.invokeObservers(EventContextImpl.java:99)
    at org.jboss.arquillian.core.impl.EventContextImpl.proceed(EventContextImpl.java:81)
    at org.jboss.arquillian.core.impl.ManagerImpl.fire(ManagerImpl.java:135)
    at org.jboss.arquillian.core.impl.ManagerImpl.fire(ManagerImpl.java:115)
    at org.jboss.arquillian.core.impl.EventImpl.fire(EventImpl.java:67)
    at org.jboss.arquillian.container.test.impl.client.ContainerEventController.execute(ContainerEventController.java:86)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.arquillian.core.impl.ObserverImpl.invoke(ObserverImpl.java:94)
    at org.jboss.arquillian.core.impl.EventContextImpl.invokeObservers(EventContextImpl.java:99)
    at org.jboss.arquillian.core.impl.EventContextImpl.proceed(EventContextImpl.java:81)
    at org.jboss.arquillian.test.impl.TestContextHandler.createSuiteContext(TestContextHandler.java:60)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.arquillian.core.impl.ObserverImpl.invoke(ObserverImpl.java:94)
    at org.jboss.arquillian.core.impl.EventContextImpl.proceed(EventContextImpl.java:88)
    at org.jboss.arquillian.core.impl.ManagerImpl.fire(ManagerImpl.java:135)
    at org.jboss.arquillian.core.impl.ManagerImpl.fire(ManagerImpl.java:115)
    at org.jboss.arquillian.test.impl.EventTestRunnerAdaptor.beforeSuite(EventTestRunnerAdaptor.java:68)
    at org.jboss.arquillian.junit.Arquillian.run(Arquillian.java:97)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:49)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: javax.enterprise.deploy.spi.exceptions.DeploymentManagerCreationException: Could not get DeploymentManager
    at javax.enterprise.deploy.shared.factories.DeploymentFactoryManager.getDeploymentManager(DeploymentFactoryManager.java:138)
    at org.jboss.arquillian.container.jbossas.remote_4_2.JBossASRemoteContainer.createDeploymentManager(JBossASRemoteContainer.java:117)
    at org.jboss.arquillian.container.jbossas.remote_4_2.JBossASRemoteContainer.start(JBossASRemoteContainer.java:93)
    ... 61 more 
```

我在这里被困了几天，并尝试了我从这里的其他帖子以及 Github 的 arquillian.container.jboss 中的示例中学到的所有内容。现在有点绝望......谁能看到我的错误是什么？我错过了 pom 文件中的任何内容吗？

在此先感谢您的任何建议！

# c - 线程结束，结束整个程序？

> ID：14486350
> 
> 赞同：0
> 
> 时间：2013-01-23T18:03:59.070
> 
> 标签：c, multithreading, networking, pthreads

下面的循环在程序的主体内部。它接受传入的连接，并有一个线程使用它。

问题是，一旦任何线程终止，它就会终止整个程序。这是代码：

```
#include <sys/socket.h>
#include <sys/types.h>
#include <netdb.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <pthread.h>
#define BUFLEN 1500
#define MAXCON 30

char *returnTimeDate(int inputchoice);
void readWriteToClient(int inputconnfd);

int main(){

    int backlog = 10;

    int fd;
    fd = socket(AF_INET, SOCK_STREAM, 0);
    if (fd == -1) {
        // Error: unable to create socket
    }

    struct sockaddr_in cliaddr;
    socklen_t cliaddrlen = sizeof(cliaddr);

    struct sockaddr_in addr;
    addr.sin_addr.s_addr = INADDR_ANY;
    addr.sin_family = AF_INET;
    addr.sin_port = htons(5001);

    if (bind(fd, (struct sockaddr *) &addr, (socklen_t) sizeof(addr)) == -1) {
        fprintf(stderr,"Bind Didn't Work\n");
    }

    if (listen(fd, backlog) == -1) {
        fprintf(stderr,"Listen Didn't Work\n");
    }

    pthread_t *threadsArray = (pthread_t *)calloc(MAXCON, sizeof(pthread_t));
    pthread_t *threadPtr = threadsArray;

    int k;
    for(k = 0; k < MAXCON; k++){
        fprintf(stderr,"Make %d\n",k);
        int connfd;
        connfd = accept(fd, (struct sockaddr *) &cliaddr, &cliaddrlen);
        if (connfd == -1) {
            fprintf(stderr,"Accept Didn't Work\n");
        }
        fprintf(stderr,"Waited\n",k);
        pthread_create( &threadPtr, NULL, readWriteToClient, (void *)connfd);
        threadPtr++;
    }

    pthread_t *threadPtrJoin = threadsArray;

    for(k = 0; k < MAXCON; k++){
        fprintf(stderr,"Join %d\n",k);
        pthread_join( *threadPtrJoin, NULL);
        threadPtrJoin++;
    }

/*  readWriteToClient(connfd);*/

    close(fd);

    return 0;

}

void readWriteToClient(int inputconnfd){

    int connfd = inputconnfd;

    while(1){

        char *dateString = "DATE\r\n";
        char *timeString = "TIME\r\n";
        char *endString = "end";

        char *bufferTime = returnTimeDate(0);
        char *bufferDate = returnTimeDate(1);

        ssize_t i;
        ssize_t rcount;
        char buf[BUFLEN];
        char *toReturn = (char *)malloc(BUFLEN*sizeof(char));
        rcount = read(connfd, buf, BUFLEN);
        if((strcmp (buf, dateString)) == 0){
            strcpy(toReturn, bufferDate);
        }
        if((strcmp (buf, timeString)) == 0){
            strcpy(toReturn, bufferTime);
        }
        if((strcmp (buf, endString)) == 0){
            goto outside;
        }
        if (rcount == -1) {
            // Error has occurred
            printf("Error: rcount -1");
        }

/*      fprintf(stderr,"I have received = %s\n",buf);*/

        if (write(connfd, toReturn, BUFLEN) == -1) {
            fprintf(stderr,"I didn't write = %s\n",buf);    
        }
    }

    outside: return;

}

char *returnTimeDate(int inputchoice){

    time_t timer;
    char *bufferTimee = (char *)malloc(25*sizeof(char));
    char *bufferDatee = (char *)malloc(25*sizeof(char));
    struct tm* tm_info;
    time(&timer);
    tm_info = localtime(&timer);
    strftime(bufferTimee, 25, "%H:%M:%S\n\0", tm_info);
    strftime(bufferDatee, 25, "%d:%m:%Y\n\0", tm_info);

    if(inputchoice == 0){
        return bufferTimee;
    }else{
        return bufferDatee;
    }

} 
```

为什么要这样做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T19:23:13.557

您对 pthread 的使用有一些非常错误的地方。

首先，我认为您的意思是：

```
int st = pthread_create(&threadPtr[k], NULL, readWriteToClient, (void *)connfd);
if (st != 0) {
    /* handle error */
} 
```

请注意以下事项：

*   `pthread_create()`我们正在存储in的返回值`st`并处理它的错误情况。
*   我们传递的是`&threadPtr[k]`（类型`pthread_t *`），而不是`&threadPtr`（类型`pthread_t **`）。**这可能是您的问题的原因。**

但是我对您的代码的主要问题之一是您通过传递`readWriteToClient`给`pthread_create()`. `pthread_create`原型如下：

```
int pthread_create(pthread_t *restrict,
                   const pthread_attr_t *restrict,
                   void *(*start_routine)(void*), 
                   void *restrict arg); 
```

即使您更改`&threadPtr`为`&threadPtr[k]`，您也会这样称呼它：

```
int pthread_create(pthread_t *restrict,
                   const pthread_attr_t *restrict,
                   void (*start_routine)(int),      // oops!
                   void *restrict arg); 
```

因此，`pthread_create()`接受一个指向一种类型的函数的指针，但是您将一个指向另一种类型的函数的指针传递给它（C11，6.7.6.3/15，强调我的）：

> **对于要兼容的两种函数类型，两者都应指定兼容的返回类型**。此外，参数类型列表（如果两者都存在）应在参数数量和省略号终止符的使用方面达成一致；**相应的参数应具有兼容的类型**。[...]

指向函数的指针被隐式转换，无论如何都会调用你的函数，但这是非法的，根据标准（C11，6.3.2.3/8，强调我的）：

> 指向一种类型的函数的指针可以转换为指向另一种类型的函数的指针，然后再返回；结果应与原始指针比较。**如果转换后的指针用于调用类型与引用类型不兼容的函数，则行为未定义**。

由于您正在调用未定义的行为，因此无法确定代码在您执行后的行为方式。

另外，请记住，将 a 转换`int`为 a`void *`并返回并不能保证不会丢失信息（它是实现定义的），所以要小心。

如果您**在启用警告的情况下进行编译，您应该在代码中看到一些其他错误，这是您应该*始终*做的事情。**

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-23T18:43:04.030

我敢打赌你的编译器会发出一些关于指针类型不兼容的警告......

我的建议是在编译阶段**修复每个警告。**

如果这样做了，您会注意到 pthread 函数的参数必须是指向 void 而不是 int 的指针。

另外，后一个函数必须返回一个指向 void 的指针，而不仅仅是 void ，这会导致堆栈大乱。

首先，使用连接fds数组

```
int connfd[MAXCON]; 
```

然后将confd保存在

```
connfd[k] = accept(fd, (struct sockaddr *) &cliaddr, &cliaddrlen); 
```

然后，改变

```
pthread_create( threadPtr, NULL, readWriteToClient, connfd); 
```

和

```
pthread_create( threadPtr, NULL, readWriteToClient, (void *) &connfd[k]); 
```

和改变

```
void readWriteToClient(int inputconnfd) 
```

和

```
void *readWriteToClient(void *inputconnfd) 
```

然后将其分配给局部变量

```
int connfd = *((int *) inputconnfd); 
```

让我知道它是否有效

# python - 带有 cvMatchTemplate 的图像中的图像 - 但如何？

> ID：14486353
> 
> 赞同：7
> 
> 时间：2013-01-23T18:04:08.037
> 
> 标签：python, image-processing, opencv, python-2.7, computer-vision

我想找出某个子图像出现在源图像的哪个位置（例如源图像：http: [//i.pictr.com/6xg895m69q.png](http://i.pictr.com/6xg895m69q.png)，子图像：[http://i.pictr. com/jdaz9zwzej.png](http://i.pictr.com/jdaz9zwzej.png)）。据我所知，有必要转换数组以使它们对 OpenCV “可读”，这是我尝试过的，但由于某种原因，它不起作用。到目前为止，这是我的代码：

```
 from PIL import Image
 import numpy
 from pylab import *
 import cv2
 import cv

 image = cv2.imread('source_img.jpg')
 template = cv2.imread('template_img.jpg')

 im = cv.fromarray(image)
 templ = cv.fromarray(template)
 result = numpy.zeros(shape=(1,10)) ##create a matrix with 0s
 a = cv.fromarray(result)
 cv.MatchTemplate(im, templ, a, cv.CV_TM_CCORR)
 print result
 print image 
```

我的目标是在结果数组中写入子图像的坐标（数组的其余部分应保持值 0（我知道我的代码到现在都不会做到这一点）。这是错误消息，我在执行时得到编码：

> OpenCV 错误：断言失败 (result.size() == cv::Size(std::abs(img.cols - templ.cols) + 1, std::abs(img.rows - templ.rows) + 1) && result.type() == CV_32F) 在 cvMatchTemplate，文件 /opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_tarballs_ports_graphics_opencv/opencv/work/OpenCV-2.4.3/modules/imgproc/src/templmatch.cpp ，第 376 行 Traceback（最近一次调用最后一次）：文件“/Users/strongbow/imagerecognition.py”，第 27 行，在 cv.MatchTemplate(im, templ, a, cv.CV_TM_CCORR) cv2.error: result.size() == cv::Size(std::abs(img.cols - templ.cols) + 1, std::abs(img.rows - templ.rows) + 1) && result.type() == CV_32F

我是 OpenCV 的新手，真的不知道如何处理这个错误消息。任何人的想法/指针怎么办？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T18:57:12.080

```
import sys
import cv2
import numpy

img = cv2.imread(sys.argv[1])
template = cv2.imread(sys.argv[2])
th, tw = template.shape[:2]

result = cv2.matchTemplate(img, template, cv2.TM_CCORR_NORMED)
threshold = 0.99
loc = numpy.where(result >= threshold)
for pt in zip(*loc[::-1]):
    cv2.rectangle(img, pt, (pt[0] + tw, pt[1] + th), 0, 2)

cv2.imwrite(sys.argv[3], img) 
```

![在此处输入图像描述](../Images/faa90c29ae26dee68027e33dc4031936.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-23T18:57:22.267

```
import cv2
from cv2 import cv

image = cv2.imread('1_tree.jpg')
template = cv2.imread('1_tree_detail.jpg')

values = cv2.matchTemplate(image, template, method=cv.CV_TM_SQDIFF)
best_fit_point = cv2.minMaxLoc(values)[2]
bottom_right = best_fit_point[0]+template.shape[0], best_fit_point[1]+template.shape[1]
cv2.rectangle(image, best_fit_point, bottom_right, (255,255,255))
cv2.imshow('tree',image)
cv2.imwrite('tree_match.jpg', image)
cv2.waitKey() 
```

![在此处输入图像描述](../Images/0b51224cf08867bc9e0b442a3e54888a.png) ![在此处输入图像描述](../Images/728f7f584e64b4adb6f08691fe3350ab.png) ![在此处输入图像描述](../Images/c767c3ab2c2c615e84620c949de9188a.png)

# django - 南，恢复一个迁移失败的数据库

> ID：14486355
> 
> 赞同：1
> 
> 时间：2013-01-23T18:04:15.603
> 
> 标签：django, django-south, database-migration

```
python manage.py migrate page --list

 page
  (*) 0001_initial
  (*) migrations from 0002 to 0006
  (*) 0007_auto__del_realestatelistcontext__del_homepagecontext__add_listcontext
  (*) 0008_auto__add_field_listcontext_num
  (*) 0009_auto__chg_field_listcontext_content
  (*) 0010_auto__del_field_listcontext_content
  ( ) 0011_auto__add_field_listcontext_content 
```

我把事情搞砸了，所以 python`manage.py migrate page 0009`和`python manage.py migrate page 0011`raise `DatadaseError`。

我对修复损坏的迁移不感兴趣，但我想将数据库恢复到迁移 0008（我可以像在 0008 中一样手动更改 Python 模型）。我是南方的新手，正在寻求有关如何做到这一点的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:23:37.637

如果您可以手动将数据库状态恢复到 0008，则可以通过“伪造”反向迁移到 0008 来告诉 South 将其视为此类。

```
python manage.py migrate page 0008 --fake 
```

这会将内部状态设置为最后应用的迁移是 0008，而不会尝试实际应用 0010 和 0009 的反向迁移。

# java - 如何通过 ProcessBuilder 调用 Java 中的 CUDA C 应用程序？

> ID：14486357
> 
> 赞同：0
> 
> 时间：2013-01-23T18:04:17.053
> 
> 标签：java, cuda, processbuilder

我有一个非常复杂的应用程序，它使用 CUDA 并用 C 编写。这个应用程序只是命令行，现在我想使用 Java Swing 构建一个 GUI。

我不想重写 C 代码，所以我使用 ProcessBuilder 对象调用命令行版本。这样我就可以从中读取消息并在 GUI 内的控制台上显示。

这是我正在使用的代码：

```
String command = "myApp";
pb = new ProcessBuilder("bash", "-c",command);
pb.redirectErrorStream(true);
Process shell;
try {
        shell = pb.start();
        InputStream shellIn = shell.getInputStream();
        Drawer.writeToLog(convertStreamToStr(shellIn));
        shellIn.close();
    } catch (IOException e) {
        e.printStackTrace();
    }

public String convertStreamToStr(InputStream is) throws IOException{
    if(is != null){
        Writer writer = new StringWriter();

        char[] buffer = new char[1024];
        Reader reader = new BufferedReader(new InputStreamReader(is,"UTF-8"));
        int n;
        while((n = reader.read(buffer)) != -1){
            writer.write(buffer,0,n);
        }
        is.close();
        return writer.toString();
    }else{
        return "";
    }
} 
```

如果我尝试类似“ls”命令，它工作正常。但是，对于我的应用程序，我收到此错误：

```
./myApp: error while loading shared libraries: libcudart.so.5.0: cannot open shared object file: No such file or directory 
```

CUDA 已在我的机器中安装并正确配置，我可以从终端正确执行此应用程序。我想错误来自Java虚拟机。

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:51:54.900

这段代码对我有用，我刚刚测试过：

```
System.out.printf("[Starter#main] !\n");
final ProcessBuilder builder = new ProcessBuilder("absolute/path_to/your/executable");
builder.redirectErrorStream(true);
builder.environment().put("LD_LIBRARY_PATH",
    "/usr/local/cuda/lib64:/usr/local/cuda/lib");
final Process start = builder.start();
final InputStream outputStream = start.getInputStream();
final BufferedReader reader = new BufferedReader(new InputStreamReader(outputStream));
String s;
while ((s = reader.readLine()) != null) {
    System.out.printf("[Starter#main] %s\n", s);
} 
```

陷阱：

1.  确保您的应用程序位数与您的工具包匹配。
2.  Mac OS X 变量称为“DYLD_LIBRARY_PATH”

另请注意：

1.  生成的进程将从您的 Java 进程继承环境，也就是说，如果您运行 Java 应用程序并按照 CUDA 工具包安装程序的建议配置了 PATH 和 LD_LIBRARY_PATH，它应该可以正常工作。
2.  您可以在 shell 脚本中外部化变量设置和启动应用程序 - 然后您只需使用给定脚本运行 shell。

# android - 如何确定一个演员是否在 libgdx 中被击中？

> ID：14486359
> 
> 赞同：0
> 
> 时间：2013-01-23T18:04:22.853
> 
> 标签：android, libgdx

我有一个演员保持一个精灵来渲染它的视图。我确定此操作命中的方式是获取精灵边界框并针对 x,y 命中函数参数调用其包含点方法。这似乎不起作用。一直在寻找基于示例等的方法来做到这一点......但一直找不到任何东西。有人可以建议一种方法吗？

我现在使用的代码是：

```
@Override
public Actor hit(float x, float y)
{
   Rectangle re= _sprite.getBoundingRectangle();

   if(re.contains(x, y))
       return this;
   else
       return null; 
```

}

文档中的 x 和 y 和 re 矩形似乎都在演员坐标中，所以它应该可以工作，但测试总是失败。

有人可以帮忙吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T05:33:12.967

根据[scene2d 命中检测 wiki](https://github.com/libgdx/libgdx/wiki/Scene2d#hit-detection)`hit` ，当舞台确定 Actor 的边界框是“命中”时调用该方法。如果你想进一步细化命中，你只需要覆盖`hit`（例如，你的精灵是圆形的，如果边界框在半径之外，你想确保避免在边界框中出现“命中”等）。

如果您想在您的 Actor 被触摸后做某事，您需要重写相应的`InputListener`方法。有关更多详细信息，请参阅同一 wiki 的[InputListener 部分](https://github.com/libgdx/libgdx/wiki/Scene2d#inputlistener)。

# fortran - 将 Fortran 转换为 Matlab

> ID：14486363
> 
> 赞同：0
> 
> 时间：2013-01-23T18:04:42.390
> 
> 标签：fortran, indices

晚安; 我正在尝试将一些 fortran 代码转换为 matlab，但我不明白什么

```
ist = grp%brp%faceIndicatorArray(-20)
ien = grp%brp%faceIndicatorArray(-19) 
```

表示在下面的子程序中。我不习惯matlab中的负索引，所以这个（-20）和（-19）对应于数组中的哪个元素或什么？这是所有子程序：

```
subroutine calculateLiftAndDrag(grp,ivd,lift,drag,momentum)
! as the name says
IMPLICIT NONE

type(GridSolverData) :: grp
type(InputVariablesData) :: ivd
real :: lift,drag,momentum
integer :: i,ist,ien,ip
real :: flowTangent(2),flowNormal(2),wallTangent(2),wallNormal(2),r(2) 
real :: p,tau_t,tau_n,PI,alphaRad,sum

lift = 0.0
drag = 0.0
momentum = 0.0
PI = 4.0*atan(1.0)
alphaRad = ivd%alpha*PI/180\. 
flowTangent(1) = cos(alphaRad)
flowTangent(2) = sin(alphaRad)
flowNormal(1) = - flowTangent(2)
flowNormal(2) = flowTangent(1)

! inviscid faces
ist = grp%brp%faceIndicatorArray(-20)
ien = grp%brp%faceIndicatorArray(-19)
do i=ist,ien 
  ip = grp%brp%faceIndicatorArray(i)
  wallTangent(1) = grp%brp%faceTangentArray(ip,1)
  wallTangent(2) = grp%brp%faceTangentArray(ip,2)
  wallNormal(1) = -wallTangent(2)
  wallNormal(2) = wallTangent(1)
  p = grp%p(ip)  
  r = grp%coordinates(ip,:)-ivd%momentumPoint
  lift = lift - 2.0*grp%wallLength(ip)*p(wallNormal(1)*flowNormal(1)+wallNormal(2)*flowNormal(2))
  drag = drag - 2.0*grp%wallLength(ip)*p*(wallNormal(1)*flowTangent(1)+wallNormal(2)*flowTangent(2))
  momentum = momentum - 2.0*grp%wallLength(ip)*p*(r(1)*wallNormal(2)-r(2)*wallNormal(1))
end do 
```

如果有人可以提供帮助，我会很高兴。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T02:08:22.623

你面临一个有趣的困境。您正在从 Fortran 90/95（除非 .faceIndicatorArray 是 F2003 对象的一部分，因此这一切都更加复杂）基于循环到基于矩阵的系统（如 MATLAB）这一事实意味着您将失去一个如果你不改变所涉及的数学，效率会很高。假设这种效率损失是可以接受的，那么考虑一种替代方法来清理代码并使其更容易在未来转换为更灵活的东西。

当我在 Fortran 90/95 模拟代码中看到像这样的负负数组索引时，它是直接翻译的 FORTRAN 77 代码的保留。大多数时候，在我使用负索引的代码中，表示辅助数据不是数据集的一部分，但由于 FORTRAN 77 没有数据结构，它保留了实际数据和辅助数据一起。您几乎可以立即看出这段代码是从变量名直接从 FORTRAN 转换而来的：

```
IMPLICIT NONE 
```

是在最近与声明变量一起完成的：

```
integer :: i, ist, ien, ip 
```

属于默认值：

```
REAL(A-H, O-Z), INTEGER(I-N) 
```

有了这些知识，很明显它很快就被转换为与类型结构一起使用。

由于我不知道 GridSolverData 类型所表示的整个结构集以及它包含的类型，我只能给你模糊的建议。brp 元素可能代表“brep”，这是此类求解器的常见文件类型。我不知道其余的负数组索引是做什么的，但是将辅助值拆分为其他数组是有益的，因为它是有意义的，并使用带有 get/put 方法的 classdef 来切换当您访问时访问的内容使用负数组索引。

将来，这种方法将允许您在更充分地理解代码后及时减少使用这些负值的代码，同时允许您复制当前功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T23:46:08.223

了解 type(GridSolverData) 的完整定义会有所帮助。Fortran 允许零和负数组索引，但 matlab 不允许。

当我转换这种类型的东西时，我只是将 (|使用的最大负索引| + 1) 添加到 matlab 中该数组的所有索引。例如，这个 fortran：

```
ist = grp%brp%faceIndicatorArray(-20);

ien = grp%brp%faceIndicatorArray(-19); 
```

在matlab中可能会变成这样：

```
ist = grp.brp.faceIndicatorArray(-20+20+1);

ien = grp.brp.faceIndicatorArray(-19+20+1); 
```

只需在整个子程序中执行此操作。例如，这也会改变：

```
ip = grp%brp%faceIndicatorArray(i) 
```

至

```
ip = grp.brp.faceIndicatorArray(i+20+1); 
```

# gstreamer - GStreamer：降噪可能通过使用 pulssink 监控源

> ID：14486364
> 
> 赞同：1
> 
> 时间：2013-01-23T18:04:54.993
> 
> 标签：gstreamer, noise-reduction, pulseaudio

在我开始编程任务之前，我想我会寻求谷歌没有给我的指导。

我目前有一个 gstreamer 管道，它从*filesrc*、*pulsesrc*或*udpsrc*接收声音并将其播放到*pulsesink*。当我使用麦克风时，我会听到很多我认为是系统噪音的声音，并且想知道是否可以进行某种降噪。udpsrc和麦克风*会*产生很多白色（粉红色？）噪音*filesrc*听起来很棒。

那么，是否有众所周知的 gstreamer 降噪技术？

我的一个想法是将连接到脉冲接收器的监听源*作为*某种声音逆变器的输入，然后在顶部播放或播放原始声音并实现噪声消除。

Gstreamer 0.10.36，Xubuntu 12.04。基于 Realtec 芯片组的专有音响系统。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T21:05:59.577

抱歉 udpsrc 不会产生噪音。也许另一边的麦克风可以。

有几种方法可以攻击噪音。一个简单的方法是在 pulsesrc 之后设置一个鼻门。这将监视记录的信号，如果它低于某个线程保持，则将其静音。当用于 Voip 时，这听起来很奇怪，并且使用的技术是将舒适噪声发生器与噪声门（语音活动检测）结合起来。

其他方法是自适应噪声过滤，或者基于噪声印记或作为多频带噪声门。

# c++ - 为什么在 C++11 中有 && 时使用 std::move？

> ID：14486367
> 
> 赞同：65
> 
> 时间：2013-01-23T18:05:06.037
> 
> 标签：c++, c++11, move-semantics

> **可能重复：**
> [什么是移动语义？](https://stackoverflow.com/q/3106110)

我最近参加了一个 C++11 研讨会，并给出了以下建议。

```
when you have && and you are unsure, you will almost always use std::move 
```

谁能向我解释为什么你应该使用`std::move`而不是一些替代品和一些你不应该使用的情况`std::move`？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2013-01-23T18:26:19.583

首先，我要解决的问题可能存在误解：
每当您`T&& t`在代码中看到（并且 T 是实际类型，而不是模板类型）时，请记住值类别`t`是左值（引用），而不是右值（临时）不再。这很令人困惑。唯一的`T&&`意思`t`是从一个右值^(1的对象)*构造*，但*它本身*是一个左值，而不是一个右值。如果它有名称（在这种情况下为），那么它是一个左值并且不会自动移动，但如果它没有名称（ 的结果），那么它是一个右值，如果可以的话，它会*自动*移动到它的结果中。*类型*（在这种情况下^(`t` *`t``3+4`**`T&&`) 几乎与变量的值类别（在本例中为左值）无关。***)

 ***话虽这么说，如果您在代码中`T&& t`编写了代码，则意味着您引用了一个临时变量，*如果*您愿意，可以销毁。如果您需要多次访问该变量，您*不*希望`std::move`从中访问，否则它将失去它的价值。但是，如果您愿意，最后一次访问它对另一个`t`人来说是安全的。（而且 95% 的时间，这就是你想要做的）。所有这些也适用于 变量。`std::move``T``auto&&`

^(1.如果`T`是模板类型，`T&&`则改为转发引用，在这种情况下你使用`std::forward<T>(t)`而不是`std::move(t)`最后一次。看到[这个问题](https://stackoverflow.com/q/7257144/845092)。)

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-01-23T18:34:16.833

我发现[这篇文章](http://www.cprogramming.com/c++11/rvalue-references-and-move-semantics-in-c++11.html)对一般的右值引用主题很有启发性。他在最后提到`std::move`。这可能是最相关的报价：

> 我们需要使用`std::move`, from `<utility>`--`std::move`是一种说法，“好吧，老实说我知道我有一个左值，但我希望它是一个右值。” `std::move`本身不移动任何东西；它只是将左值转换为右值，以便您可以调用移动构造函数。

* * *

假设您有一个如下所示的移动构造函数：

```
MyClass::MyClass(MyClass&& other): myMember(other.myMember)
{
    // Whatever else.
} 
```

当您使用语句`other.myMember`时，返回的值是一个左值。因此代码使用*复制*构造函数来初始化`this->myMember`. 但由于这是一个移动构造函数，我们知道它`other`是一个临时对象，因此它的成员也是如此。所以我们真的很想使用更高效的*移动*构造函数来初始化`this->myMember`. Using`std::move`确保编译器将其视为`other.myMember`右值引用并调用移动构造函数，正如您希望的那样：

```
MyClass::MyClass(MyClass&& other): myMember(std::move(other.myMember))
{
    // Whatever else.
} 
```

只是不要`std::move`在需要保留的对象上使用 - 移动构造函数几乎可以保证将传递给它们的任何对象弄脏。这就是为什么它们只用于临时的。

希望有帮助！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-23T18:18:26.710

当你有`T&&`一个 rvalue 类型的对象时，这意味着这个对象可以安全地移动，因为以后没有其他人会依赖它的内部状态。

由于移动永远不会比复制更昂贵，因此您几乎总是想要移动它。要移动它，您必须使用该`std::move`功能。

什么时候应该避免`std::move`，即使它是安全的？我不会在琐碎的例子中使用它，例如：

```
 int x = 0;
 int y = std::move(x); 
```

除此之外，我认为没有缺点。如果它不会使代码复杂化，恕我直言，应尽可能进行移动。

另一个你不想移动的例子是返回值。该语言保证返回值（至少）被移动，所以你不应该写

```
return std::move(x); // not recommended 
```

（如果幸运的话，[返回值优化](https://en.wikipedia.org/wiki/Return_value_optimization)命中，这甚至比移动操作更好。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-23T18:09:55.023

当您需要将对象的内容“转移”到其他地方时，您可以使用 move ，而无需进行复制。对象也可以使用 std::move 获取临时对象的内容而不进行复制。

阅读更多关于[右值引用和](http://en.wikipedia.org/wiki/C++11#Rvalue_references_and_move_constructors)从维基百科移动构造函数的信息。***

# jquery - 使用 jQuery 显示和隐藏嵌套列表切换

> ID：14486368
> 
> 赞同：0
> 
> 时间：2013-01-23T18:05:13.570
> 
> 标签：jquery, list, nested, hide, show

我在显示和隐藏嵌套列表的某些元素时遇到了一些问题。我的 HTML 代码如下：

```
<ul class="unstyled">
        <li onClick="foo();">INFO 1234 - Some Code Subject
        <ul>
            <li class="sem_hide">Semester 1
            <li class="sem_hide">Semester 2
            <li class="sem_hide">Semester 3
        </ul>
        <li onClick="foo();">INFO 4567 - Some DB Subject
        <ul>
            <li class="sem_hide">Semester 1
            <li class="sem_hide">Semester 2
            <li class="sem_hide">Semester 3
        </ul>
</ul> 
```

我的 JavaScript 看起来像这样：

```
<script>
        function foo()
        {
            if($('li .sem_hide').is(":visible"))
            {
                $('li .sem_hide').hide();
            }
            else 
            {
                $('li .sem_hide').show();
            }
        }
</script>
<script type="text/javascript" src="js/jquery.js"></script> 
```

我的CSS是这样的：

```
<style>
    body{
        width: 600px;
        margin-left: auto;
        margin-right: auto;
        background: #efefef;
    }

    li .sem_hide{
        display: none;
    }

</style> 
```

我是网络开发的新手，目前面临一个问题，即当我单击一个主题时，会显示所有主题的所有学期，但我想要的是仅显示单击的主题的学期。有没有办法得到我想要的？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:13:11.883

```
<ul class="unstyled">
    <li class = 'subject'>INFO 1234 - Some Code Subject
    <ul class = "semList>
        <li>Semester 1</li>
        <li>Semester 2</li>
        <li>Semester 3</li>
    </ul>
    <li class = "subject">INFO 4567 - Some DB Subject
    <ul class ='semList'>
        <li>Semester 1</li>
        <li>Semester 2</li>
        <li>Semester 3</li>
    </ul>
</ul>

<script>
    $(document).ready(function(){
        $(".subject").click(function(){
            $(".semList").hide();
            $(this).next(".semList").show();
        });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:06:50.193

在使用之前添加 jQuery，在 foo 中将它传递给指向源对象。

```
<script>
        function foo(obj)
        {
            if($('.sem_hide', obj).is(":visible"))
            {
                $('sem_hide', obj).hide();
            }
            else 
            {
                $('.sem_hide', obj).show();
            }
        }
</script>
<li onClick="foo(this);"> 
```

# python - 烧瓶与应用程序混淆

> ID：14486370
> 
> 赞同：37
> 
> 时间：2013-01-23T18:05:26.927
> 
> 标签：python, flask

我正在开始一个`flask`项目，在我的代码中我有

```
from flask import Flask, render_template, abort
app = Flask(__name__) 
```

现在到底是`app`什么？

我正在关注[本指南](http://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world)，我对结构特别困惑，因为他选择了命名目录`app/`并且是他`app/__init__.py`的

```
from flask import Flask
app = Flask(__name__)
from app import views 
```

他`app/views.py`有

```
from app import app 
```

这些都是什么`app`鬼？！

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-01-23T21:47:31.757

我认为主要的困惑在于：

```
from app import app 
```

你有一个`__init__.py`名为“app”的python包（一个包含文件的文件夹）。从这个文件夹中，您现在正在导入您在下面`__init__.py`文件中定义的变量“app”：

```
app = Flask(__name__) 
```

将文件夹从 app 重命名为“myproject”。然后你会打电话

```
from myproject import app 
```

此外，您将导入视图为

```
from myproject import views 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-01-23T18:32:52.807

作者通过选择与 Flask 通常的应用程序对象实例名称相同的包名称，使他的代码产生了不必要的混乱。这是您最感兴趣的一个：

```
app = Flask(__name__) 
```

以下是有关 Flask 应用程序对象的文档：

[http://flask.pocoo.org/docs/api/#application-object](http://flask.pocoo.org/docs/api/#application-object)

为避免混淆，我建议使用[官方 Flask 文档](http://flask.pocoo.org/docs/)而不是该指南。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-23T18:39:51.863

由于名称选择不佳，这确实有点令人困惑。

*   `app = Flask(__name__)`：这`app`是一个[WSGI](http://wsgi.readthedocs.org/en/latest/)应用程序，它实现了相应的接口，并且还支持 Flask 提供给我们的任何东西。
*   `from app import app`: 从包中准确导入该`app`对象`app`。
*   `from app import view`：对于他在`views`那里导入的东西，有点神秘，我想他想确保执行视图绑定。（我宁愿在 中这样做`run.py`）。无论如何，这是两个模块之间的一种导入循环，至少也令人困惑。

# c# - 保持基类的按钮位置不变

> ID：14486374
> 
> 赞同：0
> 
> 时间：2013-01-23T18:05:35.510
> 
> 标签：c#, forms, button, location, size

类似于我[在这里](https://stackoverflow.com/questions/11369486/keep-button-position-on-panel-resize)提出的问题，当我使用我制作的表单作为基类并重新调整它的大小时，我的按钮丢失了。我确定这是因为我重新调整了表单的大小并且按钮放置在页面之外的位置，所以当我重新调整大小时它们仍然在页面之外，只是不知道如何修复它。一个简单的解决方法是在加载事件时重新调整大小，但这并不能让我正确设计页面 - 另外我真的只是希望按钮总是从底部向上 10-20 和从右侧 5-15 - 无论我如何重新调整表格的大小。提前致谢。

基本形式：

```
 namespace EXT
        {
        partial class ExtFormCard
            {
            private void InitializeComponent ()
                {
                this.btnSaveandClose = new System.Windows.Forms.Button();
                this.btnCancel = new System.Windows.Forms.Button();
                this.btnSave = new System.Windows.Forms.Button();
                this.SuspendLayout();
               // 
                // btnSaveandClose
                // 
                this.btnSaveandClose.Anchor = ((System.Windows.Forms.AnchorStyles)        ((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
               this.btnSaveandClose.Location = new System.Drawing.Point(899, 663);
                this.btnSaveandClose.Name = "btnSaveandClose";
                this.btnSaveandClose.Size = new System.Drawing.Size(100, 30);
                this.btnSaveandClose.TabIndex = 0;
                this.btnSaveandClose.Text = "Save and Close";
                this.btnSaveandClose.UseVisualStyleBackColor = true;
                this.btnSaveandClose.Click += new System.EventHandler(this.Click_SaveandClose);

            ... other buttons
            ...
                //
                // ExtFormCard
                // 
                this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
                this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
                this.ClientSize = new System.Drawing.Size(1200, 874);
                this.Controls.Add(this.btnSave);
                this.Controls.Add(this.btnCancel);
                this.Controls.Add(this.btnSaveandClose);
                this.Name = "ExtFormCard";
                this.Text = "ExtFormCard";
                this.ResumeLayout(false);
                }

            private System.Windows.Forms.Button btnSaveandClose;
            private System.Windows.Forms.Button btnCancel;
            private System.Windows.Forms.Button btnSave;
            }
        } 
```

新形式：

```
 namespace IDVisitorWindowsForms.Manager
        {
        public partial class AnswerForm : EXT.ExtFormCard
            {
            public AnswerForm ()
                {
                InitializeComponent ();
                }
            }
        }

    namespace IDVisitorWindowsForms.Manager
        {
        partial class AnswerForm
            {
            #region Windows Form Designer generated code

            /// <summary>
            /// Required method for Designer support - do not modify
            /// the contents of this method with the code editor.
            /// </summary>
            private void InitializeComponent ()
                {
                this.SuspendLayout();
                // 
                // AnswerForm
                // 
                this.AutoScaleDimensions = new System.Drawing.SizeF (6F, 13F);
                this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
                this.ClientSize = new System.Drawing.Size (724, 411);
                this.Name = "AnswerForm";
                this.Text = "Answer Form";
                this.Load += new System.EventHandler(this.AnswerForm_Load);
                this.ResumeLayout(false);

               }

            #endregion
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:29:38.577

使用 WinForms 时，您可以`Anchor`控制。这是在“属性”框中完成的。锚定时，您选择要锚定到的父容器的侧面。

锚定控件意味着它将保持其位置（间距）相对于它所在的容器的侧面。在您的示例中，您希望底部和右侧锚定您的按钮，以便它们始终是距离你想远离那些方面。

# haskell - Haskell 读取类型推断

> ID：14486376
> 
> 赞同：1
> 
> 时间：2013-01-23T18:05:46.283
> 
> 标签：haskell, type-inference, typeclass

我已经编写了自己的基于邻接矩阵的图实现并创建了`Read`该类的实例。

我的图表采用类型作为输入，这将是边的类型。

如果我尝试表达

```
read " - - 8 \n - 9 - \n 1 2 3" :: GraphADJ Int 
```

它工作得很好（它是一个有 3 个节点的图，边缘从第一个节点到第三个，从第二个到第二个，从第三个到所有节点）。

我想要做的是能够不告诉类型推断边缘的类型，而是将它们放入上下文中（如 in `read"4"+3`）。

我有一个函数`insertEdge`，它需要一个图表、几个节点和新边。

```
insertEdge :: Graph g n e => g -> (n, n) -> e -> g 
```

（是作为实例`Graph`的图的通用类）`GraphADJ`

所以当我尝试做

```
 insertEdge (read " - - 8 \n - 9 - \n 1 2 3" :: GraphADJ Int) (1,2) 3 
```

它工作得很好，但如果我不明确类型，我会得到错误 `Ambiguous type variables`。

我是忘记了什么`Read`还是遗漏了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:10:04.890

问题是编译器没有足够的信息来推断读取类型。

即使您为`n`to`Int`和`e`to`Int`编译器提供类型信息，仍然没有`g`. 它所知道的`g`只是一个带有`Graph g Int Int`. `g`即使在这样的实例中存在单一类型，它仍然无法推断。

编译器无法自动看到在当前范围内只有这样的类型具有这样的实例，因为允许这样的行为可能会通过导入模块导致代码中断。

因此，解决方案要么提供显式签名，要么制作`insertEdge`提供显式具体类型的专门版本，以为`read`. 如果您在多个地方将其用于同一类型，则后者将很有用。

# android - Android Facebook Api 异常 - remote_app_id 与存储的 id 不匹配

> ID：14486377
> 
> 赞同：6
> 
> 时间：2013-01-23T18:05:46.807
> 
> 标签：android, facebook, login, app-id

正如这篇文章的标题所说，我有一个问题。我无法登录。

```
SessionState currentstate =  session.getState(); 
```

给我一个状态`CLOSED_LOGIN_FAILED`。我看了这篇文章，[Android Facebook SDK 3.0 在登录时给出“remote_app_id 与存储的 id 不匹配”](https://stackoverflow.com/questions/13894006/android-facebook-sdk-3-0-gives-remote-app-id-does-not-match-stored-id-while-lo)

我使用 keytool 生成了一个密钥并将其放在 App Dashboard 中。但这似乎没有帮助。对此的任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-01-23T18:09:32.283

从您的活动的 oncreate 调用以下方法，它将在 logcat 中打印一个哈希键，将其添加到 Facebook 上应用程序设置的哈希字段中。再试一次它会工作

```
 public void printHashKey() {

        try {
            PackageInfo info = getPackageManager().getPackageInfo("your.package.name",
                    PackageManager.GET_SIGNATURES);
            for (Signature signature : info.signatures) {
                MessageDigest md = MessageDigest.getInstance("SHA");
                md.update(signature.toByteArray());
                Log.d("TEMPTAGHASH KEY:",
                        Base64.encodeToString(md.digest(), Base64.DEFAULT));
            }
        } catch (NameNotFoundException e) {

        } catch (NoSuchAlgorithmException e) {

        }

    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-30T14:46:29.433

我知道这已经有一个选定的答案，但重要的是要注意，如果您尝试使用 keytool 而不是在代码中打印 keyhash，请确保使用 java 1.6 附带的 keytool 而不是 java 1.7。

# c# - 使用 ajax 的 Json 的 MVC 4 中的困难

> ID：14486380
> 
> 赞同：2
> 
> 时间：2013-01-23T18:05:48.503
> 
> 标签：c#, asp.net-mvc, jquery

我正在尝试将变量传递给我的 JsonResult 但她得到 nul 所以这是我的 JsonResult 和 jQuery 中的代码

```
 [HttpPost]
    public JsonResult MostraTela(Teste testea)
    {

        return Json(new { success = true });
    } 
```

和 ：

```
 var testea = JSON.stringify(dado);
                    $.ajax({
                        url: '/Home/MostraTela',
                        type: 'POST',
                        dataType: 'json',
                        contentType: "application/json; charset=utf-8",
                        data: {testea: testea },
                        success: function (data) {
                            alert(data.success);
                        },
                        error: function () {
                            alert("error");
                        },

                    }); 
```

Agora eu fuitentar passar uma model e esta esta recebendo nulo novamente alguma ideia do que pode ser? 我加强数据：{testea：testea}，错误，如果我加强数据：testea，我的 JsonResult 中的所有内容都为空

我的模型：

```
public class Teste
{
    public int idteste { get; set; }
    public string name { get; set; }
    public int age { get; set; }
    public string birthday { get; set; }
    public string salary { get; set; }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:18:54.840

尝试为`testea`变量命名以确保操作方法将其分配给相同的命名参数，如下所示：

```
$.ajax({
    url: url,
    type: "post",
    data: { testea: testea },
    dataType: 'json',
    success: function (data) {
        alert(data.success);
    },
   error: function () {
       alert("error");
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:14:16.530

由于目标方法的签名是字符串，请尝试将 123 作为字符串传递，例如。

```
var testea = JSON.stringify("123"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:26:03.857

如果您要传递 JSON，请将其设置`content-type`为`application/json`.

```
$.ajax({
    type: 'POST',
    url: '@Url.Action("MostraTela", "Home")',
    data: { Id: 1, Name: 'Im a complex object' },
    success: function (data) {
        alert(data.success);
    },
    dataType: 'json',
    contentType: 'application/json, charset=utf-8',
}); 
```

控制器：

```
[HttpPost]
public JsonResult MostraTela(MyModel model, FormCollection collection)
{
    return Json(new { success = true });
} 
```

班级：

```
public class MyModel
{
    public string Name { get; set; }
    public int Id { get; set; }
} 
```

# c++ - 类定义中的 sizeof(*this)

> ID：14486383
> 
> 赞同：15
> 
> 时间：2013-01-23T18:06:00.847
> 
> 标签：c++

我们可以做这样的事情：

```
#include <iostream>

class Foo
{
public:
   Foo() { std::cout << sizeof(*this) << '\n'; }
}; 
```

在 C 标准中，我看到以下内容：

**ISO/IEC 9899:2011**

> 6.7.2.1 结构和联合说明符
> 
> 8 ... 直到终止列表的 } 之后，类型才不完整，然后完成。

但在 C++ 标准中我找不到任何类似物。

sizeof 运算符不能应用于类型不完整的表达式，那么我们是否可以编写这样的代码？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-23T18:08:01.460

是的，您可以编写这样的代码，因为编译器必须将其视为类定义在类方法实现中是完整的。

例如，它必须像您写的那样对待它：

```
#include <iostream>

class Foo
{
public:
   Foo();
};

// Methods declared in the body of a class are implicitly inline
// Inline, however, probably doesn't mean what you think it means:
inline Foo::Foo() { std::cout << sizeof(*this) << '\n'; } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-23T18:08:06.003

在成员函数体内，类是完整的——否则，您无法访问任何其他成员函数，也无法访问任何成员变量，这将成为一个相当没有价值的成员。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T18:13:57.273

是的，你可以写，结果也是正确的。

```
#include<iostream>
using namespace std;
class Foo
{
public:
       int x;
   Foo() { std::cout << sizeof(*this) << '\n'; }
};
int main(){
    Foo b;
    b.x=5;
    system("pause");
    return 0;
    } 
```

# c# - 为 C# SWIG 指定包装器方法前缀

> ID：14486384
> 
> 赞同：1
> 
> 时间：2013-01-23T18:06:07.863
> 
> 标签：c#, swig

当 SWIG（使用 C#）包装一个方法时，比如说

```
void foo(); 
```

它将生成一个带有`CSharp_`如下前缀的包装器方法：

```
SWIGEXPORT void SWIGSTDCALL CSharp_foo() {
  foo();
} 
```

是否可以指定/覆盖此前缀？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T15:55:01.207

我认为不可能在运行时更改它——据我所知，这是在文件 csharp.cxx 中设置的，行：

```
Swig_name_register("wrapper", "CSharp_%f"); 
```

所以你需要以某种方式改变它并重新编译 SWIG。

# sql - 最接近平均值 SQL

> ID：14486386
> 
> 赞同：5
> 
> 时间：2013-01-23T18:06:10.797
> 
> 标签：sql

我正在寻找一个查询来获取与所有值的平均值最接近的值。例如，我在 A 列中有值 - 1 , 2, 8 平均值为 3.667 。所以我希望查询返回 2，因为它最接近平均值。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T18:14:11.590

```
SELECT TOP 1 myTable.*
FROM myTable
CROSS JOIN (SELECT AVG(A) AS averageA FROM myTable) AS averageA
ORDER BY ABS(averageA.averageA - myTable.A) 
```

[SQL小提琴](http://sqlfiddle.com/#!3/ce4aa/5)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T18:38:50.030

```
SELECT number, ABS(number - (SELECT AVG(number) FROM numberTable)) AS deviation 
FROM numberTable 
ORDER BY deviation ASC 
LIMIT 1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:43:39.237

```
SELECT MAX(A)
FROM myTable
WHERE A < (SELECT AVG(A) AS averageA FROM myTable) 
```

# php - 如何仅为 php 文件设置执行时间？

> ID：14486393
> 
> 赞同：0
> 
> 时间：2013-01-23T18:06:31.070
> 
> 标签：php, ajax, comet

彗星项目。我希望彗星服务器（一个 php 文件）永远执行，其他 php 文件遵循 php.ini 文件设置的规则。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:07:54.520

您可以使用[set_time_limit()](http://us.php.net/set_time_limit)函数。

# javascript - 如何获得与浏览器分辨率相同高度的元素？

> ID：14486395
> 
> 赞同：0
> 
> 时间：2013-01-23T18:06:40.477
> 
> 标签：javascript, jquery, html, css

我正在尝试使用 jquery 将元素的高度设置为等于用户浏览器。这是我到目前为止无法正常工作的代码。是因为我在 css 中设置了最小高度吗？我真的需要那个类来等于用户的分辨率。

```
<script type="text/javascript">
jQuery(function() { 
    jQuery(".bg").css("height", jQuery(window).css("height"));
}
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:11:00.207

将变量设置为`window.innerHeight`

```
$(document).ready(function() {
    var height = window.innerHeight;
    $(".bg").css("height", height);
}); 
```

有关. [_](https://developer.mozilla.org/en-US/docs/DOM/window.innerHeight) _`window.innerHeight`

`window.innerHeight`如您所问，返回用户视口的高度，而不是*真正*的屏幕分辨率，但它有效。还有`window.innerWidth`其他方法可以获取用户的屏幕统计信息。

您也可以使用`self.innerHeight`, `parent.innerHeight`,`top.innerHeight`但它们有不同的用途。（见链接）。

此外，您正在使用`$(window).css("height");`jQuery`css()`函数*分配*css 值，它不返回字符串。那是`$(window).height()`因为`height()`确实返回了一个字符串。

```
var height = function() { return this.length; }
// height() returns "this.length" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:12:10.470

试试这个，它保持图像的纵横比

```
$(function(){
var ratio = $("img").width() / $("img").height();
var newWidth = ($(window).height()-10) * ratio;
if(newWidth > $(window).width())
        $("img").css("width","100%");
    else
        $("img").css("width",newWidth+"px");
$(window).resize(function(){
    var ratio = $("img").width() / $("img").height();
    var newWidth = $(window).height() * ratio;
    if(newWidth > $(window).width()){
        $("img").css("width","100%");

        }
    else{
        $("img").css("width",newWidth+"px");

        }
});
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:09:51.330

你必须使用`jQuery(window).height()`. Windows 实际上没有随分辨率变化的动态高度 css 属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T18:09:55.963

要设置“元素”高度，您需要设置窗口的高度。

```
$('element').height($(window).height()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T18:11:26.490

您可以使用此 javascript 脚本来获取浏览器的高度和宽度。它还支持多种浏览器：

```
var viewportwidth;
var viewportheight;
// the more standards compliant browsers (mozilla/netscape/opera/IE7) use window.innerWidth and window.innerHeight

if (typeof window.innerWidth != 'undefined') {
    viewportwidth = window.innerWidth,
    viewportheight = window.innerHeight
}

// IE6 in standards compliant mode (i.e. with a valid doctype as the first line in the document)

else if (typeof document.documentElement != 'undefined' && typeof document.documentElement.clientWidth != 'undefined' && document.documentElement.clientWidth != 0) {
    viewportwidth = document.documentElement.clientWidth,
    viewportheight = document.documentElement.clientHeight
}

// older versions of IE

else {
    viewportwidth = document.getElementsByTagName('body')[0].clientWidth,
    viewportheight = document.getElementsByTagName('body')[0].clientHeight
} 
```

浏览器的宽度和高度将分别存储在`viewportwidth`和`viewportheight`变量中。然后你可以使用类似的东西

```
var bg = document.getElementById("bg");
bg.style.height = viewportheight; 
```

这会将具有 id`bg`高度的元素设置为视口高度。

# c# - 控制器发布操作未收到模型

> ID：14486397
> 
> 赞同：3
> 
> 时间：2013-01-23T18:06:46.097
> 
> 标签：c#, asp.net-mvc, razor

非常基本的型号：

```
public class Person
{
    public string Name;
    public int Age;
} 
```

和非常简单的观点：

```
@model DynWebPOC.Models.Person

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

Hello, @Model.Name
<br/>
You're getting old at @Model.Age years old now!

@using(Html.BeginForm("Index","Test",FormMethod.Post))
{
    <fieldset>       
        <label for="name" style="color: whitesmoke">Name:</label>    
        @Html.TextBoxFor(m => m.Name)
        <br/>
        <label for="age" style="color: whitesmoke">Age:</label>

        @Html.TextBoxFor(m => m.Age)

        <br/>
        <input type="submit" value="Submit"/>
    </fieldset>
} 
```

还有一个非常简单的控制器：

```
public class TestController : Controller
{
    [HttpGet]
    public ActionResult Index()
    {
        object model = new Person {Name = "foo", Age = 44};
        return View(model);
    }

   [HttpPost]
   public ActionResult Index(Person person)
   {
       return View();
   }
} 
```

当屏幕加载时，这些值会正确绑定到页面。但是当我按下提交按钮时，人员对象的年龄和姓名都为空值。

因为我使用了 Html.TextBoxFor，它不应该正确设置所有绑定并且对象应该自动绑定回 POST 吗？它在 GET 中绑定得很好。

我是否错过了对 Html.BeginForm() 的调用中的某些内容？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T18:40:22.820

您必须在模型中创建属性

```
public class Person
{
    public string Name { get; set; }
    public int Age { get; set; }
} 
```

代替

```
public class Person
{
    public string Name;
    public int Age;
} 
```

ASP.net MVC 只绑定属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:22:53.863

为什么你的模型`object`在`Get`方法中？这可能是混淆模型绑定器的原因。`EditorFor`这也看起来像为什么当您将它们更改为s时它会在页面加载时引发异常

尝试强输入：

```
[HttpGet]
public ActionResult Index()
{
    Person model = new Person {Name = "foo", Age = 44};
    return View(model);
} 
```

# xml - Scriptella：将表从访问复制到 postgresql

> ID：14486400
> 
> 赞同：0
> 
> 时间：2013-01-23T18:06:52.157
> 
> 标签：xml, postgresql, ms-access, data-transfer, scriptella

我是 Scriptella 的新手，我完全陷入了以下问题。

我有给定的访问表。我正在使用我编写的程序获取表模式。输出文件 ( `tableschema.xml`) 如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<table>
    <column>ID</column>
    <datatype>COUNTER</datatype>
    <column>FirstName</column>
    <datatype>VARCHAR</datatype>
    <column>LastName</column>
    <datatype>VARCHAR</datatype>
    <column>Salary</column>
    <datatype>CURRENCY</datatype>
    <column>SSN</column>
    <datatype>INTEGER</datatype>
</table> 
```

然后，使用 Scriptella，我需要创建一个新的 PostgreSQL 数据库（如果可能。如果不可能，我们可以假设该数据库已经创建）。比我需要使用提供的 XML 文件创建一个新表（必需）并将所有数据从访问表复制到 PostgreSQL 表。

我实现了从访问中提取数据。我实现了从 XML 文件中提取信息。

我被困在 Postgres 中创建数据库和表。看来，`CREATE DATABASE`只是`CREATE TABLE`不通过 Scriptella 工作。

`etl.xml`我的文件草稿：

```
<!DOCTYPE etl SYSTEM "http://scriptella.javaforge.com/dtd/etl.dtd">
<etl>
    <connection id="db1" url="jdbc:odbc:TestDB" driver="scriptella.driver.odbc.Driver" user="Dzmitry" password="a"/>

    <connection id="db2" url="jdbc:odbc:PostgreSQLconnector" driver="scriptella.driver.odbc.Driver" classpath="postgresql.jar" user="Dzmitry" password="a"/>

    <connection id="script" driver="script"/>
    <connection id="java" driver="scriptella.driver.janino.Driver"/>
    <connection id="log" driver="text"/>

    <!--  doesn't work

    <script connection-id="db2" new-tx="true" if="create_databases">
            CREATE DATABASE testDB;
    </script>

    -->

    <query connection-id="db1">
        SELECT * FROM GenInfo;

        <script connection-id="script">
            java.lang.System.out.println("Processing row number " + rownum + " ");
        </script>
        <script connection-id="log">
            ${FirstName}, ${LastName}, ${Salary}, ${SSN}
        </script>
    </query>

    <query connection-id="java">
        import javax.xml.parsers.*;
        import javax.xml.xpath.*;
        import java.io.*;
        import org.w3c.dom.Document;
        import org.xml.sax.*;

        DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();
        DocumentBuilder docBuilder = dbFactory.newDocumentBuilder();

        File file = new File("tableschema.xml");
        Document document = docBuilder.parse(file);

        XPathFactory xpFactory = XPathFactory.newInstance();
        XPath xPath = xpFactory.newXPath();

        int numberOfColumns = Integer.parseInt(xPath.evaluate("count(/table/column)", document));

        for(int i = 1; i &lt;= numberOfColumns; i++){ // does not take less than sign
            System.out.print("Column name " + i + ": " + xPath.evaluate("/table/column[" + i + "]", document));
            System.out.println("\tData type " + i + ": " + xPath.evaluate("/table/datatype[" + i + "]", document));
        }

    </query>
</etl> 
```

有人可以帮助我吗？
问候， 兹米特里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T09:28:37.617

在您的脚本中，您使用 ODBC 驱动程序来访问 Postgres：

```
driver="scriptella.driver.odbc.Driver" 
```

我建议使用[文档](http://scriptella.javaforge.com/docs/api/scriptella/driver/postgresql/package-summary.html)中解释的 JDBC 驱动程序：

```
<connection driver="postgresql" url="jdbc:postgresql://localhost:5432/DATABASENAME" user="username" password="password">
</connection> 
```

此外，您可以省略 new-tx="true" 属性，我认为在您的场景中使用它没有意义。所以从像这样简单的事情开始：

```
<connection connection-id="db2" driver="postgresql" url="jdbc:postgresql://localhost:5432/DATABASENAME" user="Dzmitry" password="a" classpath="postgresql.jar">
</connection>

<script connection-id="db2">
    CREATE TABLE distributors (
        did     integer PRIMARY KEY,
        name    varchar(40)
    );
</script> 
```

在此示例中，我展示了如何为现有数据库 DATABASENAME 创建表。如果您想创建另一个数据库，脚本会更复杂，但在我提供更多详细信息之前，我需要您确认您现在能够在现有数据库中创建表。

为了创建一个数据库，首先你必须连接到一个现有的，比如 template1（它应该是预先安装的）。并从那里创建另一个数据库。然后使用单独的连接执行其他脚本。请注意，创建表脚本的连接必须启用lazy-init属性，否则会为不存在的数据库抛出错误：

```
<!-- Connection for just for creating a database -->
<connection connection-id="db2_init" driver="postgresql" url="jdbc:postgresql://localhost:5432/template1" user="postgres" password="postgres" classpath="postgresql.jar">
</connection>

<!-- Connection for DDL and data statements. Needs to be lazy-init=true -->
<connection connection-id="db2_tables" driver="postgresql" lazy-init="true" url="jdbc:postgresql://localhost:5432/testDB" user="Dzmitry" password="a" classpath="postgresql.jar">
</connection>

<script connection-id="db2_init" if="create_databases">
    CREATE DATABASE testDB;
</script>
<script connection-id="db2_tables" if="create_schema">
    CREATE TABLE distributors (
        did     integer PRIMARY KEY,
        name    varchar(40)
    );
</script> 
```

# ant - Ant 1.8.4 无法从另一个文件解析 refid - 但 Ant 1.6 很好

> ID：14486401
> 
> 赞同：-1
> 
> 时间：2013-01-23T18:07:01.177
> 
> 标签：ant, build

我在 Java 6 和 Ant 1.6 上构建良好，但我现在在 Java 7 和 Ant 1.8.4 上并且遇到了一些问题。我已经克服了很多，但有一个我被困住了。

我有一个包含一些常见目标的文件 common.xml （只包含目标 - 没有 xml 版本字符串或项目）：

```
<target name="common_init">
    <path id="project.class.path">
        ... stuff
    </path>
</target> 
```

和两个构建文件：buildfile1.xml

```
<?xml version="1.0"?>
<!DOCTYPE project [
    <!ENTITY common SYSTEM "file:./common.xml">
]>

<project name="proj1" default="main" basedir=".">
    <!-- import common targets using a xml entity definition -->
    &common;
    ...
    <target name="compile" depends="common_init">
        <javac
            srcdir="..." destdir="..." debug="on" deprecation="off" optimize="on" includes="**/*.java" source="${javac.target}" target="${javac.target}">

            <src path="..."/>
            <classpath refid="project.class.path"/>
        </javac>
    </target>
    ...
</project> 
```

这很好用。但是几乎相同的第二个构建文件给了我错误：

```
Reference project.class.path not found. 
```

第二个构建文件是：

```
<?xml version="1.0"?>
<!DOCTYPE project [
    <!ENTITY common SYSTEM "file:./common.xml">
]>

<project name="proj1" default="main" basedir=".">
    <!-- import common targets using a xml entity definition -->
    &common;
    ...
    <target name="compile" depends="common_init">
        <javac
            srcdir="..." destdir="..." debug="on" deprecation="off" optimize="on" includes="**/MyFile.java" source="${javac.target}" target="${javac.target}">

            <classpath refid="project.class.path"/>
        </javac>
    </target>
    ... 
```

我认为（抓住稻草）相同的项目名称可能是问题所在，但不是。两个构建文件都使用以下命令从更高级别的构建文件启动：

```
<ant antfile="buildfileX.xml"...> 
```

非常感谢任何帮助。

保罗

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-24T10:40:27.753

我在原始帖子中的代码只是伪代码，我省略了导致问题的重要差异，对此我深表歉意。

正在运行的构建文件与我原来的帖子一样。失败的也如发布的那样，但它的调用方式略有不同：

```
<project name="proj1" default="main" basedir=".">
    <!-- import common targets using a xml entity definition -->
    &common;
    ...
    <target name="compile" depends="common_init">
        <antcall target="compile1"/>
    </target>

    <target name="compile1" depends="">
        <javac
            srcdir="..." destdir="..." debug="on" deprecation="off" optimize="on" includes="**/MyFile.java" source="${javac.target}" target="${javac.target}">

            <classpath refid="project.class.path"/>
        </javac>
    </target>
    ...
</project> 
```

因此，Ant 1.6 和 1.8.4 之间肯定发生了变化，其中任务之间的默认继承发生了变化。做出了多么荒谬的改变。它只会引起人们（像我这样的人！！）的问题。无论如何，希望这篇文章能帮助遇到同样问题的其他人。

保罗

# vb.net - defaultview.sort 忽略默认视图中的最后一行

> ID：14486404
> 
> 赞同：1
> 
> 时间：2013-01-23T18:07:17.340
> 
> 标签：vb.net, sorting, datatable, dataview

我创建了一个表，创建了一个数据视图，并对数据视图进行了排序。然后我用三行数据填充表格，一切都很好。然后，我更改了应该导致它重新排序的行之一中的字段（小时）之一，但它没有重新排序。它似乎只影响数据视图的最后一行。我尝试删除并重新应用排序条件，但没有成功。知道这里有什么吗？

```
Function CreateStoreHours() As DataTable
    StoreHours.Columns.Add("Store", GetType(String))
    StoreHours.Columns.Add("Hours", GetType(Double))
    StoreHours.DefaultView.Sort = "Hours ASC"
    dgvStoresHours.DataSource = StoreHours
End Function

'Here I popluated the grid with three records. All were sorted correctly.

For v = 0 To StoreHours.DefaultView.Count - 1
    If row("Store") = StoreHours.DefaultView(v).Item("Store") Then
        Match = True
        StoreHours.DefaultView(v).Item("Hours") = StoreHours.DefaultView(v).Item("Hours") + row("Hours")
        'The Hours field gets adjusted properly, but it gets moved to the last record even 
        ' though it should be sorted as the second record of three. This is also where I tried
        ' the un-sort and re-sort with no luck.
        Exit For
    End If
Next 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T13:35:28.213

在另一个论坛上找到了答案...

我不得不直接更新底层数据表。这可确保更改反映在数据视图中。不知道为什么我们不能只通过默认视图进行更新，但问题已解决。

# php - 如何忽略 CSV 中的第一行

> ID：14486406
> 
> 赞同：0
> 
> 时间：2013-01-23T18:07:22.397
> 
> 标签：php

如何忽略第一行并在文本区域中回显 csv 文件中的数据并显示成功的记录数。

```
if ($_FILES[csv][size] > 0) { 

    //get the csv file 
    $file = $_FILES[csv][tmp_name]; 
    $handle = fopen($file,"r"); 

    //loop through the csv file and insert into database 
    do { 
        if ($data[1]) { 
            mysql_query("INSERT INTO contacts (contact_first, contact_last, contact_mobile, contact_email) VALUES 
                ( 
                    '".addslashes($data[0])."', 
                    '".addslashes($data[1])."',
                    '".addslashes($data[2])."', 
                    '".addslashes($data[3])."' 
                ) 
            "); 
        } 
    } while ($data = fgetcsv($handle,1000,"","'")); 
    // 

    //redirect 
    header('Location: batch_import.php?success=1'); die; 

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:10:33.563

在循环之前使用它。

```
fgets($handle); 
```

# php - 密码重置安全选项 - 这两个选项中哪个更安全

> ID：14486407
> 
> 赞同：1
> 
> 时间：2013-01-23T18:07:45.690
> 
> 标签：php, forms, login, email-validation

我对我的程序员关于密码重置功能的推理有了一点了解。有人可以告诉我以下哪个更安全，或者它们是否相等？

选项 1：向用户发送一封包含以下内容的电子邮件：

```
Url: http://mysite/reset/user%mail.com

CODE: 57583 
```

然后用户被带到一个页面，他们必须手动输入代码，但电子邮件已经填充在 Web 表单上。

选项 2：向用户发送以下电子邮件：

```
URL: http://mysite/reset/user%mail.com&code=57583 
```

我不是程序员，很抱歉，如果这是一个简单的问题，或者我的第二个 url 格式不正确，我的意思是，在示例 1 中，用户必须手动输入代码，而在第二个示例中，表单是 pre - 填充代码。

那么这些是否会与另一个有效地一样安全，或者一个是否具有显着的安全优势？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:13:02.587

就个人而言，我认为这两种方法同样安全（方法 2 对用户更友好）。

但是，您应该使用更长的代码。否则，它们将很容易被猜到，攻击者可以通过猜测重置令牌来随意重置密码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:11:46.973

两者同样安全 - 如果电子邮件到达用户的收件箱，并且该电子邮件映射到您网站上的该用户帐户，您可以放心地假设它是您想要的用户。您可以通过允许用户添加备用电子邮件来增加安全性，当他们将密码重置代码发送到电子邮件 A 时，您会向所有其他电子邮件地址发送通知，说“嘿，您或某人向电子邮件 A 发送了密码重置电子邮件. 如果这不酷，请单击此处"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:11:53.260

它们是平等的，因为电子邮件在两种情况下都包含相同的信息。

第二个选项对我来说似乎更加用户友好。但是你可以很容易地提供两者（因为有人有一个邮件客户端，它不允许打开 URL ......）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T18:16:18.213

由于您已经通过 URL 公开了用户的电子邮件，因此添加密钥并不会降低其安全性。

您可以通过根本不暴露用户的电子邮件来提高安全性 - 用令牌隐藏电子邮件： **mysite.com/reset/some-token?key=[key]**

并且在页面中不显示电子邮件：email @d****. **com**

这样人们就不能使用暴力方法来查看人们是否是您系统中的注册人。对于大多数网站来说，这可能不是问题，但我可以看到一些不公开电子邮件和/或注册人列表很重要的用例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T18:20:05.523

我会选择第二个选项。与第一个相比，它不会造成任何伤害，它将改善用户体验/可用性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-23T18:35:19.863

正如其他人所提到的，两者都同样安全，第二个选项对用户更友好。然而，攻击者不能轻易猜到“代码”，这一点至关重要。这意味着您应该避免按顺序生成代码或使用一些容易猜测的算法。最后，作为对任何猜测攻击的预防措施，如果您认为某个 IP 地址正试图错误地猜测代码，您可能希望实施基于 IP 的阻止。如果密码被猜错 10 次（例如），另一种选择可能是锁定用户帐户以防止密码被重置。

# c# - 如何在 C# 图表控件中为不同系列设置不同的比例？

> ID：14486420
> 
> 赞同：1
> 
> 时间：2013-01-23T18:08:40.073
> 
> 标签：c#, .net, mschart

我想要完成的内容如下图所示。在该图表中，我有三个系列，每个系列的比例都显示在左侧（最大在顶部，最小在底部。）

在图表控件中，据我所知，我能做的就是设置属性`Chart.ChartArea[0].AxisY.Minimum`和`Chart.ChartArea[0].AxisY.Maximum`，但它们对所有系列都是通用的。

有什么方法可以让我为每个系列设置不同的最小值和最大值，从而允许我为每个系列设置不同的比例？

![不同系列以不同比例显示](../Images/ff35a366d309cbf8ae4e80e03799fa73.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:31:35.243

您可能想查看可在[此处](http://archive.msdn.microsoft.com/mschart/Release/ProjectReleases.aspx?ReleaseId=4418)下载的“图表控件示例”的“MultipleYAxis”示例。

这个想法是在同一个图表控件中使用每个系列的两个 ChartArea。两者都包含彼此点系列的精确副本。

*   第一个向左对齐，仅显示 Y 轴而不显示点
*   秒数立即出现在右侧，仅显示没有 Y 轴的点。

因为您使用三个系列，所以您将不得不使用六个 ChartAreas。

这听起来有点麻烦，需要一些工作才能实现，但我在我的一个项目中以动态的方式做到了。它工作得很好，并且没有太多的性能损失。

# php - 根据文本输入字段填充包含省份的下拉菜单

> ID：14486422
> 
> 赞同：0
> 
> 时间：2013-01-23T18:08:50.043
> 
> 标签：php, jquery, mysql, ajax, jquery-ui

我有一个简单的用户表，其中显示用户信息，例如他们当前的国家和省份。

```
<td><b>Country</b></td>
        <td width="331">
        <form method="post" action="">
        <div id="countryList" style="vertical-align:top; display:inline-block; float:left;"><?=$country?></div>
        <input type="submit" name="submitCountry" id="submitCountry" class="ui-icon ui-icon-disk" style="border:none; display:none; background-color:transparent; float:right; vertical-align:top;" />  
        </td>
        <td width="336">&nbsp;</td>
      </tr>
      <tr>
        <td><b>Province</b></td>
        <td>
        <div id="provinceList" style="vertical-align:top; display:inline-block; float:left;"><?=$province?></div>
        </form>
      </td> 
```

当用户点击他们的 Country 时，DIV 会转换为具有自动完成功能的输入框并向数据库发起 AJAX 请求。这允许用户输入一个国家，它将显示在列表中。

jQuery代码：

```
$("#countryList").click(function(){

            $("#submitCountry").css("display", "inline");

            //check if there are any existing input elements
            if ($(this).children("input").length == 0){

                //variable that contains input HTML to replace
                var inputbox = "<input type='text' id='countryList' class='inputbox' name='country' value=\""+$(this).text()+"\">";    
                //insert the HTML intp the div
                $(this).html(inputbox);         

                //automatically give focus to the input box     
                $(".inputbox").focus();

                //maintain the input when it changes back to a div
                $(".inputbox").blur(function(){
                    $("#submitCountry").css("display", "none");

                    var value = $(this).val();
                    $("#country").val(value);
                    $("#countryList").text(value);

                });
            }  

            //Once input box is displayed assign it the autocomplete method
            $("input#countryList").autocomplete ({
                //set a few options, and select source data
                minLength : 2,
                source : function (request, callback)
                {
                    //variable that will carry the request 'term' from url
                    var data = { term : request.term };

                    //ajax method to call pho script
                    $.ajax ({
                        url : "getCountry.php",
                        data : data,
                        complete : function (xhr, result)
                        {
                            //if returns empty, then exit out
                            if (result != "success") return;

                            //otherwise get response and fill country array
                            var response = xhr.responseText;
                            var country = [];
                            //filter each li item
                            $(response).filter ("li").each (function ()
                            {
                            //display li item inline
                            country.push ($(this).text ());
                            });
                            //display country list
                            callback (country);
                        }

                    });
                }

            });   
if ($("#provinceList").children("input").length == 0){

                var selectbox = "<select id='selectProv' name='selectProv'></select> ";

                $("#provinceList").html(selectbox);

                var datastring = { term : request.term };
                $.ajax({
                    url: "getProvince.php",
                    data: datastring, 
                    success: function(html){
                        $(".selectProv").html(html);
                    }
                })
            } 
```

getCountry.php 文件如下。是的，我知道，我需要保护自己免受 SQL 注入。目前我的课程还没有走那么远（我是一名学生）。

这是getCountry.php

```
 <?php

$term = $_REQUEST["term"];
$term = utf8_decode ($term);
$dbUser = "admin";
$dbPass = "pass";
$dbName = "testdb";
$bd = mysql_connect ("localhost", $dbUser, $dbPass);
$ret = mysql_select_db ($dbName, $bd);
$query = sprintf ("SELECT * FROM Country WHERE Name LIKE '%%" . $term . "%%'", mysql_real_escape_string($term));

//send query string to DB
$result = mysql_query($query);

//if result returns a value
if ($result != NULL){

    // Use the result (sent to the browser)
    while ($row = mysql_fetch_assoc($result)){

        echo ("<li>" . utf8_encode ($row["Name"]) . " (" . utf8_encode ($row["Code"]) . ")</li>");

    }

    mysql_free_result($result);
}

mysql_close ($bd);

?> 
```

getProvince.php 此代码将用于查询数据库并生成下拉菜单。我知道这段代码有效，因为我可以导航到它，并将它传递给一个字符串，它会生成我需要的下拉列表。问题是它在整个应用程序中不起作用。

```
 <?php

$term = $_REQUEST["term"];
$term = utf8_decode ($term);
$dbUser = "admin";
$dbPass = "pass";
$dbName = "testdb";
$bd = mysql_connect ("localhost", $dbUser, $dbPass);
$ret = mysql_select_db ($dbName, $bd);
$query = sprintf ("SELECT * FROM Country WHERE Name LIKE '%%" . $term . "%%'", mysql_real_escape_string($term));

//send query string to DB
$result = mysql_query($query);

//if result returns a value
if ($result != NULL){

    $row = mysql_fetch_assoc($result);
    $code = $row['Code'];

    $sql = "SELECT DISTINCT District FROM City WHERE CountryCode='$code'";

    $result = mysql_query($sql);

    ?>
    <option>Select State/Province</option>
    <?php while($row=mysql_fetch_array($result)){

        echo "<option value=" . $row['District'] . ">" . $row['District'] . "</option>";
    }

    mysql_free_result($result);
}

mysql_close ($bd); 
```

上面的代码在一定程度上有效。我能够让国家文本框正确查询数据库并执行自动完成方法，但是结果不会像我想要的那样用省份填充下拉列表！提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:50:51.040

**您的查询没有被清理！！！！！！！！！！！！！！！！！！**，两者都没有被正确连接，你可以更简单地做到这一点：

```
$query = "SELECT * FROM Country WHERE Name LIKE '%" . mysql_real_escape_string($term) . "%'"; 
```

**请始终清理您的输入，这比拥有工作脚本更重要，因为您冒着数据库完整性的风险**

这条线也应该被清理，连接的值来自数据库**并不重要**

```
$sql = "SELECT DISTINCT District FROM City WHERE CountryCode='" . mysql_real_escape_string($code) . "'"; 
```

以下行应该是：

```
$.ajax({
                url: "getProvince.php",
                data: datastring, 
                success: function(html){
                    $("#selectProv").html(html);
                }
            }); 
```

注意**.selectProv**更改为**#selectProv**（**#**表示 'id'，. 表示 'class'）

# css - div溢出不起作用

> ID：14486427
> 
> 赞同：2
> 
> 时间：2013-01-23T18:09:06.563
> 
> 标签：css, html

有人可以告诉我为什么`overflow:hidden;`不工作，它一直在困扰我的大脑并尝试了各种方法，除非它是我完成的布局。

提前致谢。

```
#RightContent {
    min-height: 90%;
    background-color: #0A0A0A;
    border-top: 2px solid #2D2D2D;
    border-left: 2px solid #2D2D2D;
    border-right: 2px solid #2D2D2D;
    border-top-right-radius: 25px;
    width: 41%;
    margin: 0 auto;
    position: absolute;
    top: 20px;
    left: 404pt;
    overflow: hidden;   
}

#RightFooter {
    min-height: 30px;
    background-color: #0A0A0A;
    border-bottom: 2px solid #2D2D2D;
    border-left: 2px solid #2D2D2D;
    border-right: 2px solid #2D2D2D;
    border-bottom-right-radius: 25px;
    width: 41%;
    margin: 0 auto;
    position: absolute;
    bottom: 20px;
    left: 404pt;
    overflow: hidden;   
} 
```

请参阅 posturads.com 上的示例

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:13:19.997

您尚未设置元素或其任何祖先的高度。

尝试设置该`#RightContent`元素的高度。

**更新**

我创建了一个快速的 html 布局示例来帮助您入门：http: [//jsfiddle.net/Zdaaj/](http://jsfiddle.net/Zdaaj/)

请研究样品和实验。

我强烈建议您熟悉使用浮动、清除和边距来使您的布局达到您想要的位置并减少您的挫败感。

# jasperserver - jasperserver 数据库守卫

> ID：14486431
> 
> 赞同：0
> 
> 时间：2013-01-23T18:09:20.473
> 
> 标签：jasperserver, guard

我知道[Guard Gem](http://rubygems.org/gems/guard)可以继续监听文件的更改并根据更改触发脚本（尽管我从未使用过它）。.

但现在这并不是我所需要的。.我需要一个类似的工具来持续监听数据库中特定表的变化。.如果有任何变化，我需要触发一个脚本。.

**额外细节**

我正在使用一个名为 Jasper Server 的工具，它基本上是一个报告引擎。. 它作为 webapp 在 tomcat 之上运行。.

在设计新报表时通过用户界面添加大部分功能非常方便。.但是，当我进行更改时，更改本地存储在名为 jasperserver 的表中（我目前使用 PostgreSQL，可能它与其他数据库非常相似）。

所以每当我需要复印我的报告时，我都必须这样做

```
$JASPER_HOME/buildomatic/js-export.sh --uris Path/In/JasperServer --output-dir Path/In/FileSystem
```

这将拍摄 jasperserver 表的图片并创建 Report 文件夹。.可以部署在其他机器上。.

但是我发现这是一个手动步骤，我觉得必须有某种方法来自动化这个过程。.所以我想知道是否有任何工具来保护数据库而不是普通文件。.

有什么建议么 。。请回复 。.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T10:54:38.477

导出脚本不会获取数据库表的图像，而是在 JasperReports Server 中创建报表配置的描述符。如果您查看 --output-dir，您会发现描述报告配置的 XML 文件、包含所有内容的数据文件、输入控件的描述、数据源等。这些配置被导出为独立于数据库的 XML 格式，并涉及大约 20 个表JasperReports 服务器数据库。因此，监视特定表将无法满足您的要求，例如

*   如果您查看`JIResource`表格 - 所有新的存储库元素（例如文件夹、临时文件、其他资源）都会触发监视器。`JIResource`保存导出所需的 URI。
*   但是，如果您监视`JIReportUnit`表格，您会看到所有新的报告单元，然后您需要执行一些查询来检索导出所需的有关 URI 的信息。

一般来说，直接使用应用程序的数据库是不好的做法，最好是利用应用程序附带的 API。

因此，据我了解，有两种选择：

*   基于工作流的解决方案 - 即，当上传新报告时，手动启动导出（最新版本支持通过前端导出，这可能会简化您的用例）。

*   基于服务器产品定制的解决方案，您可以在其中扩展保存报告工作流程以在保存期间执行其他操作。

# jquery - 使用jquery的可见跨度长度

> ID：14486432
> 
> 赞同：1
> 
> 时间：2013-01-23T18:09:25.917
> 
> 标签：jquery

当一个跨度可见时，我想提醒“可见”。但是当我运行我的功能时，它不会发出警报。示例代码[链接](http://jsfiddle.net/xTF8f/)

//脚本

```
if($('.none').find('span').css('display')!='none'){
alert('visible')
} 
```

//html

```
<div class="none">
<span style="display:none">first</span>
<span style="display:block">second</span>
</div> 
```

//css

```
.none{display:none} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T18:10:28.257

如果元素的父级被隐藏，则该元素会自动隐藏，因此对于隐藏的父级，您将获得可见计数 = 0。

```
if($('.none').find('span:visible').length > 0){
    alert('visible');
} 
```

找出元素将显示：block

**[现场演示](http://jsfiddle.net/rajaadil/xTF8f/9/)**

```
visibles = $('.none').find('span').filter(function(){
   if($(this).css('display') == 'block')   
       return $(this);
});
alert(visibles.length); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:18:53.290

这将为您提供显示未设置为 none 的 span 的计数，但是如果父 div 设置为 display:none，则渲染时 span 将不会显示，即使它们的 display 属性未设置为 none。

```
var cnt = 0;
$('div.none span').each(function(){
    if($(this).css('display')!='none') cnt++;
});
if(cnt>0) console.log('foo',cnt); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/xTF8f/8/)**

# javascript - event.preventDefault() 在 Mozilla 或 IE 中不起作用

> ID：14486440
> 
> 赞同：2
> 
> 时间：2013-01-23T18:10:08.527
> 
> 标签：javascript, jquery, internet-explorer, mozilla, preventdefault

我终于可以在其他浏览器中测试我的网站了（主要是在 Chrome 中构建的）。不幸的是，很多东西的功能似乎不同。我将从第一个问题开始：登录时，我有一个 JS/jQuery 检查以确保用户名和密码匹配，并且在失败时它应该停止提交。

然而，虽然它在 Chrome 和 Safari 中有效，但在 Mozilla 和 IE 中，提交仍在进行中（点击道歉页面，但我仍然宁愿根本看不到）。

我已经尝试替代`event.preventDefault()`或`e.preventDefault()`但`evt.preventDefault()`它们都不起作用，表单仍然提交（并且对于后两个它使它也可以在 Chrome 中提交）。这是我的代码，希望有任何想法：

```
function checkLogin()
{
    // get the variables, execute some other checks (eg, things not blank)

    // run ajax code to determine if pieces match
    $.ajax({
    type: "POST",
    url: "check_login.php", 
    data: {'username': username, 'password': password},
    async: false,
    success: function(result) 
    {
      if (result == 1)
      {
        $('#loginoff').html("Invalid username/password");
        e.preventDefault();
        return false;
      } 
      else
      {
        $('#loginoff').html("");
        return true;
      } 
    }
    });
} 
```

请注意，当用户名和密码不匹配时，该函数肯定会通过并返回 1，因为在所有情况下，都会出现“无效的用户名/密码”消息。

此外，如果有人对 HTML 感兴趣：

```
<form action="login.php" method="post" onsubmit="return checkLogin()">
<!-- code for inputs, eg username -->
<input type="submit" class="btn" value="Log In"/>
</form> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T18:21:41.847

我建议先阻止该事件，然后当您希望提交表单时，请使用本机提交方法，因为它绕过了 jQuery。

```
var form = document.getElementById("formid");
$(form).submit(function(e){
    e.preventDefault();

    $.ajax({
        type: "POST",
        url: "check_login.php",
        data: {
            'username': username,
            'password': password
        },
        //async: false,
        success: function (result) {
            if (result == 1) {
                $('#loginoff').html("Invalid username/password");
            } else {
                $('#loginoff').html("");
                form.submit(); // note, form is a form NODE, not a jQuery object containing a form.
            }
        }
    });

}); 
```

这也允许您删除`async: false`始终是一件好事（网络工作者除外。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T18:59:25.167

将控制台设置为保留 console.log。您应该会看到一个 JavaScript 错误

```
e.preventDefault();  //<--trying to prevent the form from submitting 
```

在哪里`e`定义？

```
function checkLogin()  <-- No e defined 
```

您将遇到一个错误，这意味着表单将提交，因为没有任何东西阻止它停止。

```
function checkLogin(e) {
    e = e || window.event; 
```

并且由于它不是 jQuery 包装的事件对象，因此您需要这样做

```
$.Event(e).preventDefault(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T22:14:25.750

我最终想出了如何让它在一般情况下工作：

在该部分中，函数应写为：

请注意“事件”作为 checkLogin 的输入

然后我使用的功能如下。主要更改是 a.) 在开始时阻止默认提交（注意，$.Event(e) 是必需的，否则它在 IE 中不起作用），b.) 使用 getElementById 定义表单，c.) 提交函数使用 form.submit()。希望人们觉得这很有帮助。

```
function checkLogin(e)
{
var form = document.getElementById("mainloginform");
$.Event(e).preventDefault();

// set error counter
var counter = 0;
var username = $('#loginusername').val();
var password = $('#loginpassword').val();

// check that username is not blank
 if (username==null || username=="")
{
    $('#usernameoff').html("Must enter your username");
    counter++;
}
else
{
    $('#usernameoff').html("");
}

// check that password is not blank
 if (password==null || password=="")
{
    $('#passwordoff').html("Must enter your password");
    counter++;
}
else
{
    $('#passwordoff').html("");
}

// if counter zero at this point, return false, else return true
if (counter > 0)
{
    return false;
}
else
{
    $.post("check_login.php", {'username': username, 'password': password}, function(result)
    {
        if(result == 1)
        {
            $('#loginoff').html("Invalid username/password");
            return false;
        }
        else
        {
            $('#loginoff').html("");
            form.submit();
            return true;
        }
    });
}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T18:15:04.627

除了别人提到的ajax问题，IE8没有做preventDefault()。

[IE8的PreventDefault替代品](https://stackoverflow.com/questions/4422045/preventdefault-alternative-for-ie8)

```
(event.preventDefault) ? event.preventDefault() : event.returnValue = false; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T19:58:59.613

不幸的是，我无法像标题中希望的那样做，因为我永远无法成功阻止所有四种浏览器中的提交（Mozilla 一直坚持不懈）。

然后，我最终做了以下事情：

1.) 在我的 HTML 中，我更改了边界，使其仅包含输入，但“提交”按钮位于

2.) 然后，我没有像以前那样将“return checkLogin()”移到提交按钮（现在在表单之外）并将其更改为“onclick”。

3.) 这样，我不需要任何 preventDefault() 因为没有发生默认值。我只是去了ajax请求，在'return true'的情况下，将它设置为 $('#mainform').submit();

注意：通过这样做，我还能够使 ajax 请求不再是异步的，每个人都说这很好（我还是新手，所以不确定它的重要性）。

希望这可以帮助遇到相同问题的任何人。

# hadoop - 检查两个表是否相等

> ID：14486442
> 
> 赞同：2
> 
> 时间：2013-01-23T18:10:21.390
> 
> 标签：hadoop, hql, hive

我有两个结构相同的表。
如何检查这两个中的所有行是否相等？
即第一个表中的每一行都存在于另一个表中，反之亦然。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-06-13T12:57:44.930

Jeff 博客中的解决方案与 Hive 相关：[http](http://weblogs.sqlteam.com/jeffs/archive/2004/11/10/2737.aspx) ://weblogs.sqlteam.com/jeffs/archive/2004/11/10/2737.aspx 。

> “基本思想是：如果我们在所有列上对两个表的并集进行 GROUP，那么如果这两个表相同，则所有组将导致 COUNT(*) 为 2。但是对于在任何列上不完全匹配的任何行在 GROUP BY 子句中， COUNT(*) 将是 1 -- 这就是我们想要的。我们还需要在 UNION 的每个部分添加一列，以指示每一行来自哪个表，否则没有区分哪一行来自哪个表的方法。”

处理重复项的改进解决方案作为评论发布：[http](http://weblogs.sqlteam.com/jeffs/archive/2004/11/10/2737.aspx#3155) ://weblogs.sqlteam.com/jeffs/archive/2004/11/10/2737.aspx#3155 （从最初发布的评论中复制代码用户“佩里”）

```
SELECT MIN(TableName) as TableName, COL1, COL2, COL3 ...
  FROM
  (
   SELECT 'Table A' as TableName, COUNT(*) NDUPS, A.COL1, A.COL2, A.COL3, ...
    FROM Table1 A GROUP BY ID, COL1, COL2, COL3 ...
   UNION ALL
   SELECT 'Table B' as TableName, COUNT(*) NDUPS, B.COL1, B.COl2, B.COL3, ...
    FROM Table2 B
    GROUP BY ID, COL1, COL2, COL3 ...
   ) tmp
   GROUP BY NDUPS, ID, COL1, COL2, COL3 ...
   HAVING COUNT(*) = 1
   ORDER BY ID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T00:54:37.967

这是一个有趣的。我不确定是否有更好或更简单的方法来做到这一点，但这样的事情可能会奏效：

假设您有两个表 t1 和 t2，它们每个都有两列 c1 和 c2

```
create view t1_counts
as select c1, c2, count(*) as num
from t1
group by c1, c2;

create view t2_counts
as select c1, c2, count(*) as num
from t2
group by c1, c2;

select t1_counts.c1, t1_counts.c2, t1_counts.num, t2_counts.num
from t1_counts full outer join t2_counts on (t1_counts.c1 = t2_counts.c1 and t1_counts.c2 = t2_counts.c2)
where t1_counts.num != t2_counts.num; 
```

如果两个表相等，则输出将为空。

# jsp - struts 和 JSP：如何在单击某些按钮时保留表单值

> ID：14486450
> 
> 赞同：0
> 
> 时间：2013-01-23T18:10:44.593
> 
> 标签：jsp, struts-1

我创建了一个 JSP，其中包含一些文本和复选框字段。还有一个名为 update 的按钮。单击更新按钮时，我必须根据输入的值更新数据。但问题是单击更新按钮时，我必须重定向到同一页面。当我这样做时，用户输入的值没有得到反映，而是页面以空值打开。

请为此问题提供一些解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:59:34.203

这是我认为的一种方法。将 struts-config.xml 文件中的范围设置为 session。

```
<action path="/helloWorld"
    type="com.HelloWorldAction"
    name="helloWorldForm"
    scope="session" >
    <forward name="success"
        path="tile.helloWorld">
    </forward>
</action> 
```

# php - 等效于 ASP 中的 function_exists() 和 call_user_func()

> ID：14486451
> 
> 赞同：0
> 
> 时间：2013-01-23T18:10:48.010
> 
> 标签：php, asp-classic

ASP 中是否存在与 PHP 等效的函数`function_exists()`？

相当于怎么样`call_user_func()`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T10:06:50.567

你可以用一个技巧来做到这一点：

```
public function getFunction(functionName)
    set getFunction = nothing
    on error resume next
    set getFunction = getRef(functionName)
    on error goto 0
end function

dim func : set func = getFunction("myFunction")
if not func is nothing then
    ' call "myFunction"
    func
else
    ' "myFunction" does not exist
end if 
```

# iphone - 无法在触摸 uiimageview 时获取触摸事件委托方法

> ID：14486452
> 
> 赞同：0
> 
> 时间：2013-01-23T18:10:49.473
> 
> 标签：iphone, uiscrollview, uiimageview, uitouch

我在 scrollview 中添加了一些 uiimageview，现在想要在触摸 uiimageview 时执行一些操作。但是我的触摸委托方法没有被调用。以下是我的代码：

```
int x = 0;
for (int i = 0; i < [arr count]; i++){
    UIImageView *myImageview = [[UIImageView alloc] initWithFrame:CGRectMake(x, 0, 320, self.view.frame.size.height-45)];
    myImageview.userInteractionEnabled = TRUE;
    myImageview.opaque = YES;
    //[myImageview setImage:[arr objectAtIndex:i]];
    myImageview.tag = 100+i;
    [scrollvw addSubview:myImageview];
    [myImageview setImageWithURLRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:[(NSDictionary*)[arr objectAtIndex:i] objectForKey:@"image"]]] placeholderImage:nil success:^(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *image){
        //reload data here
        myImageview.image = image;

    } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error){
        //handle errors here
    }];

    x += myImageview.frame.size.width;

}

[scrollvw setContentSize:CGSizeMake(x, self.view.frame.size.height-45)]; 
```

我添加了以下方法，但它不起作用：

```
- (void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {

UITouch *touch = [[event allTouches] anyObject];
CGPoint location = [touch locationInView:touch.view];

if (touch.view.tag > 0) {
    touch.view.center = location;
}

NSLog(@"tag=%@", [NSString stringWithFormat:@"%i", touch.view.tag]); 
```

}

有人可以帮我调用触摸委托方法吗？

问候
潘卡伊

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:41:30.777

为什么不像这样将 UITapGestureRecognizer 添加到您的图像上：

```
UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(testMethod:)];

[myImageview addGestureRecognizer:tap];

- (void)testMethod:(id)sender {
    UIImageView *sent = (UIImageView *)sender;

    NSLog(@"Image Tag: %d", sent.tag);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T05:57:31.710

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 

{

UITouch *touch = [touches anyObject];

touchPoint = [touch locationInView:imageView];

} 
```

请确保您已在 .h 文件中导入 QuartzCore 框架

# ajax - 为什么 commandButton 在我的表单中运行在 tomcat 中而在 glassfish 中运行时不起作用？

> ID：14486458
> 
> 赞同：1
> 
> 时间：2013-01-23T18:11:09.103
> 
> 标签：ajax, tomcat, primefaces, glassfish

我所做的是在字段中不传递值并发送以给出所需字段的错误消息，然后我在字段中传递值并再次发送。在tomcat中工作，请求中的glassfish未发送。有谁知道可能会发生什么？

[发生了什么的图片](http://lh6.googleusercontent.com/-eMfJEKyAll4/UP_4-JyZECI/AAAAAAAAAb0/oYBOCSg9ct8/s641/login.jpg)

[发生了什么的图片，控制台 javascript 上的错误](http://lh4.googleusercontent.com/-5B09Rii0p7c/UP_4-BQd6cI/AAAAAAAAAbw/XGr0leuEYVU/s959/login2.jpg)

我真的不知道发生了什么，有人知道吗？我使用 Tomcat 7 和 Glassfish 3，Primefaces 3.4.2 e Primefaces Extensions 0.6.2。在 .ear 企业项目中。

:===============: 补充增强理解。:===============:

大家好，这个问题很难解决，然后在其他地方搜索后我看到（不确定在哪里）这可能是我的项目依赖项中的问题。所以我决定以primefaces网站为例，从三个角度进行复现。

1.  使用 Tomcat 运行（已工作）
2.  与 Glassfish 一起跑步（工作）
3.  在我的项目中使用 Glassfish 运行（未工作）

在1和2上，刚刚做了一个ctrl + C / ctrl + V的[primefaces网站](http://www.primefaces.org/showcase/ui/pprAjaxValidations.jsf)例子，这样：

索引.xhtml：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="pt-br" 
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    <f:view>
        <h:head/>
        <h:body>
            <h:form id="form">  
                <p:panel id="panel" header="New Person">  
                    <p:messages id="msgs"/>  
                    <h:panelGrid columns="3">  
                        <h:outputLabel for="firstname" value="Firstname: *" />  
                        <p:inputText id="firstname" value="#{testMB.name}" required="true" label="Firstname">  
                            <f:validateLength minimum="2" />  
                        </p:inputText>  
                        <p:message for="firstname" display="icon"/>  
                        <h:outputLabel for="surname" value="Surname: *" />  
                        <p:inputText id="surname" value="#{testMB.name}" label="Surname" required="true">  
                            <f:validateLength minimum="2" />  
                            <p:ajax update="msgSurname" event="keyup" />  
                        </p:inputText>  
                        <p:message for="surname" id="msgSurname" display="icon"/>  
                    </h:panelGrid>  
                    <p:commandButton id="btn" value="Save" update="panel" actionListener="#{testMB.save(actionEvent)}"/>  
                </p:panel>  
            </h:form> 
        </h:body>
    </f:view>
</html> 
```

TestManagedBean.java：

```
@ManagedBean(name="testMB")
@RequestScoped
public class TestManagedBean
{
  private String name;
  private String surname;

  public String getName()
  {
    return this.name;
  }

  public void setName(String name) {
    this.name = name;
  }

    public String getSurname() {
        return surname;
    }

    public void setSurname(String surname) {
        this.surname = surname;
    }

  public void save(ActionEvent actionEvent) {
    addMessage(FacesMessage.SEVERITY_INFO, "TEST: " + this.name);
  }

  public void addMessage(FacesMessage.Severity s, String summary) {
    FacesMessage message = new FacesMessage(s, summary, null);
    FacesContext.getCurrentInstance().addMessage(null, message);
  }
} 
```

在 3 岁时，我也这样做了，但是要使用计划的架构，正在使用 shiro、facelets、布局 primefaces 扩展等的安全过滤器......我检查了 shiro 并且没有过滤器阻止某些事情，其他依赖项也看起来和我发现在 ejb 模块中我声明了 primefaces（因为我使用的是 primefaces 的 SortOrder 模型类），而 web 模块也声明了 primefaces 和 primefaces 扩展。

项目依赖性与问题有关吗？去掉ejb模块中primefaces的依赖，只在web模块中声明primefaces会更合适吗？（我在这里试过，但是web模块可以看到ejb模块但是相反的没有发生，我该怎么做？）

谢谢大家，对不起我的英语，我是巴西人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T13:33:20.880

您的 EJB 不应该引用 Primefaces，并且应该尽可能独立于平台（尽管事实上不依赖于 Hibernate/EclipseLink 是不切实际的*）*。

这是我使用的结构：

```
EAR
  |- (1) WAR
  | \- Primefaces xhtml files etc.
  | |- backing beans (support components in the xhtml files)
  | |- dao beans (handle any interactions with the @Remote facades)
  | |- Dependencies: (2,3)
  |
  |- (2) JAR @Remote interfaces
  | \- Dependencies: (3)
  |
  |- (3) JAR @Entity objects
  | \- Dependencies: (none)
  |
  |- (4) @EJB Module
    \- @Local interfaces
    |- @Local implementations
    |- @Remote implementations
    |- Dependencies: (2,3) 
```

两个关键部分是 WAR 和 EJB 模块。这两个都依赖于@Remote 和@Entity jar。*它们根本不直接相互依赖。*

当 ManagedBean 与 EJB 通信时，它通过调用 Remote 接口来实现，例如`@EJB RemoteMyBeanInterface myBean`，它实际上返回 EJB 模块中的实现（通过魔术）。

尝试分离模块，看看是否对您有帮助。如果没有，那么安全过滤器可能会产生一些干扰（可能是无声的）。您应该开始一个干净的新项目（如有必要，还需要新的服务器域）；从 Primefaces 的剪切和粘贴代码开始，然后开始一一添加所有附加内容和过滤器，直到找到导致问题的原因。

如果您仍然感到困惑，请在 Primefaces 论坛上发帖和/或尝试引起[BalusC](https://stackoverflow.com/users/157882/balusc "栏杆C")的注意。由于他在这里发布的答案，我的大部分问题都得到了解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T16:22:12.570

我遇到了类似的问题，虽然我担心我不记得我是如何修复它的，但我很确定它是通过添加以下内容来解决的`web.xml`：

```
<context-param>
  <param-name>javax.faces.PARTIAL_STATE_SAVING</param-name>
  <param-value>false</param-value>
</context-param> 
```

和/或

```
<context-param>
  <param-name>javax.faces.STATE_SAVING_METHOD</param-name>
  <param-value>server</param-value>
</context-param> 
```

我会伸出脖子说这是第一个代码片段，但它可能取决于或可能不取决于设置为服务器的状态保存方法。

# nhibernate - factory.OpenSesion() 上的 NHibernate 错误“操作对于事务的状态无效”

> ID：14486460
> 
> 赞同：1
> 
> 时间：2013-01-23T18:11:21.147
> 
> 标签：nhibernate, sharepoint, transactions, distributed-transactions

我在使用 NHibernate 时遇到了一个非常奇怪的错误。当我调用打开会话时，我收到此错误和堆栈跟踪。

```
The operation is not valid for the state of the transaction.-at System.Transactions.TransactionState.EnlistVolatile(InternalTransaction tx, IEnlistmentNotification enlistmentNotification, EnlistmentOptions enlistmentOptions, Transaction atomicTransaction) 
at System.Transactions.Transaction.EnlistVolatile(IEnlistmentNotification enlistmentNotification, EnlistmentOptions enlistmentOptions) 
at NHibernate.Transaction.AdoNetWithDistributedTransactionFactory.EnlistInDistributedTransactionIfNeeded(ISessionImplementor session) 
at NHibernate.Impl.AbstractSessionImpl.CheckAndUpdateSessionStatus() 
at NHibernate.Impl.SessionImpl..ctor(IDbConnection connection, SessionFactoryImpl factory, Boolean autoclose, Int64 timestamp, IInterceptor interceptor, EntityMode entityMode, Boolean flushBeforeCompletionEnabled, Boolean autoCloseSessionEnabled, ConnectionReleaseMode connectionReleaseMode) 
at NHibernate.Impl.SessionFactoryImpl.OpenSession(IDbConnection connection, Boolean autoClose, Int64 timestamp, IInterceptor sessionLocalInterceptor) 
at NHibernate.Impl.SessionFactoryImpl.OpenSession(IInterceptor sessionLocalInterceptor) 
```

这只发生在我的应用程序的一个地方，即使那样也不是一致的。具体来说，这是在 SharePoint 应用程序中运行的代码。每当 SharePoint 在特定地址收到电子邮件时，它就会触发我的代码。我之所以提出这一点，是因为要注意，每次调用代码时，它都在单独的线程上运行，并且该线程上没有现有的 NHibernate 事务或会话。

我破解了 NHibernate 源代码，查看了抛出错误的方法。如堆栈跟踪中所述，它是“EnlistInDistributedTransactionIfNeeded”方法。这是该方法的代码

```
if (session.TransactionContext != null)
            return;

        if (System.Transactions.Transaction.Current == null)
            return;

        var transactionContext = new DistributedTransactionContext(session,
                                                                   System.Transactions.Transaction.Current);
        session.TransactionContext = transactionContext;
        logger.DebugFormat("enlisted into DTC transaction: {0}",
                           transactionContext.AmbientTransation.IsolationLevel);
        session.AfterTransactionBegin(null);
        transactionContext.AmbientTransation.TransactionCompleted +=
            delegate(object sender, TransactionEventArgs e)
                {
                    using (new SessionIdLoggingContext(session.SessionId))
                    {
                        ((DistributedTransactionContext)session.TransactionContext).IsInActiveTransaction = false;

                        bool wasSuccessful = false;
                        try
                        {
                            wasSuccessful = e.Transaction.TransactionInformation.Status
                                            == TransactionStatus.Committed;
                        }
                        catch (ObjectDisposedException ode)
                        {
                            logger.Warn("Completed transaction was disposed, assuming transaction rollback", ode);
                        }
                        session.AfterTransactionCompletion(wasSuccessful, null);
                        if (transactionContext.ShouldCloseSessionOnDistributedTransactionCompleted)
                        {
                            session.CloseSessionFromDistributedTransaction();
                        }
                        session.TransactionContext = null;
                    }
                };
        transactionContext.AmbientTransation.EnlistVolatile(transactionContext,
                                                            EnlistmentOptions.EnlistDuringPrepareRequired); 
```

如您所见，此方法仅在 System.Transactions.Transaction.Current 不为空时才真正执行任何操作。就我而言，我无法理解为什么它不会为空，因为尝试打开会话的方法不会打开任何其他会话或事务，但我不是分布式事务方面的专家。

其他一些可能相关的细节

1.  我的会话工厂由在 web 应用程序/服务的生命周期中存在的静态对象管理。
2.  调用我的方法的共享点进程是一个名为 OWSTimer 的 Windows 服务。据我了解（但尚未确认），它为每封传入的电子邮件生成一个单独的线程，然后在该线程上调用我的代码。
3.  我不需要分布式事务，所以如果我可以强制 NHibernate 永远不要在分布式事务中登记我的会话，那也很好。
4.  我有许多与会话交互的事件侦听器。在所有情况下，我都会通过调用 var session = @event.Session.GetSession(EntityMode.Poco); 在事件侦听器中获取会话实例；根据文档，我不会关闭这些会话实例。但是，在某些情况下，我确实调用了flush，只是因为我错过了文档的那一部分。

更新：这是处理创建会话并由我的其他代码调用的静态方法。

```
public static ISession CreateAuditableSession(string siteUrl, ISharePointDataContext context)
    {
        var factory = Instance(siteUrl);
        var session = factory.OpenSession();            
        var imp = session.GetSessionImplementation();

        imp.Listeners.PreUpdateEventListeners = new IPreUpdateEventListener[] { new AuditUpdateListener(context) };
        imp.Listeners.PostInsertEventListeners = new IPostInsertEventListener[] { new AuditUpdateListener(context) };
        imp.Listeners.FlushEventListeners = new IFlushEventListener[] { new FixedDefaultFlushEventListener() };
        imp.Listeners.PreInsertEventListeners = new IPreInsertEventListener[] { new PGUserDisplayNameRetrieverListener(context) };
        imp.Listeners.PreDeleteEventListeners = new IPreDeleteEventListener[] { new AuditUpdateListener(context) };
        imp.Listeners.PostCollectionUpdateEventListeners = new IPostCollectionUpdateEventListener[] { new AuditUpdateListener(context), new SupplierChangeEventListener() };
        imp.Listeners.PostCollectionRecreateEventListeners = new IPostCollectionRecreateEventListener[] { new AuditUpdateListener(context), new SupplierChangeEventListener() };
        imp.Listeners.PostLoadEventListeners = new IPostLoadEventListener[] { new PostLoadSubscriptionAndInjectionEventListener(context) };

        return session;       
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T15:35:43.757

我想我已经确定了一种解决方法并有一个关于原因的理论。据我所知，仅当属性 System.Transactions.Transaction.Current 不为 null 并且当前事务被中止时才会发生此错误。查看 Nhibernate 的代码，没有任何与 System.Transactions.Transaction.Current 或 TransactionScope 类交互的方式，以至于我的任何代码都可能导致 Nhibernate 创建这种场景。无论如何，我自己的代码也不直接使用 System.Transactions，因此我所做的任何事情都不太可能导致泄漏的中止事务。

但是，经过测试，我发现大多数与电子邮件处理相关的 OWSTimer 代码似乎都在单个线程上运行。因此，我怀疑在我们的环境中部署的与处理传入电子邮件相关的任何其他自定义代码都在与我的代码相同的线程上运行。其他一些组件中的错误可能会泄漏此事务并破坏对 NHibernate 的后续调用。

在与我们的生产管理员交谈后，我发现大约在这个问题开始的时候，我们升级了一个第三方组件（Newsgator），它对传入的电子邮件有很多作用。结果，我认为他们的一端可能存在错误，导致交易泄漏。

为了防御它，我正在修改我的会话管理代码，以在打开新会话之前检查 System.Transactions.Transaction.Current 是否包含并中止事务。如果是这样，那么我将自己处理并取消该交易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T19:49:42.590

这要么是你的代码中的一些奇怪的东西导致了这种情况，要么是 NHibernate 中的一个错误（因此它无法处理一些 Sharepoint 的怪异），或者是 Sharepoint 中的一个错误。

在任何一种情况下，禁用此代码都感觉像是一种解决方法，而不是解决真正的问题。然而，这样做是可能的。查看 NHibernate 源代码，您可以使用另一个事务工厂。查看NHibernate.Cfg.Environment，你会找到配置参数来设置它。

（即将用完，所以现在无法查看详细信息。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-26T07:15:57.860

我已经设法解决了这个完全相同的场景`NHibernate.ISessionFactory.Evict(System.Type persistentClass, object id);`

请注意，`Session.Dispose()`单独（没有上述`Evict`调用）没有帮助，因此使用了更激烈的方法`NHibernate.ISessionFactory.Evict`并愉快地帮助了我。

希望它可以帮助别人。

# ajax - IFRAME 沙盒属性正在阻止 AJAX 调用

> ID：14486461
> 
> 赞同：12
> 
> 时间：2013-01-23T18:11:21.050
> 
> 标签：ajax, html, iframe, sandbox, same-origin-policy

我有一个应用程序 ( `http://localhost/MyApp`)，其中一些部分是通过 IFRAMES 呈现的。这些 iframed 部分与应用程序的 DOM 的其余部分无关，因此我应用了该`sandbox`属性。

IFRAME 声明如下：

```
<iframe src="/MyApp/en/html/action?id=1" sandbox="allow-forms allow-scripts" seamless="seamless"></iframe> 
```

`HTTP GET`iframed 页面有一个按钮，可以对同一个 Web 应用程序进行 AJAX 调用，但是浏览器发出的不是 ，而是`HTTP OPTIONS`显示为 的`Cancelled`，并且发生错误：

```
XMLHttpRequest cannot load http://localhost/MyApp/en/data/action?id=1\. Cannot make any requests from null.
Ajax State 0 Error: HTTP 0 
```

如果我将 添加`allow-same-origin`到`sandbox`属性中，它会起作用。据[我在这里阅读](http://msdn.microsoft.com/en-us/hh563496.aspx)，它不应该影响 AJAX 调用。

为什么会这样？是否将路径`/MyApp/en/html/action`视为整个 IFRAME 的起源并将请求阻止到先前级别？

干杯。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-31T06:14:57.570

它影响 Ajax 的原因是因为 Ajax 受[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)规则的约束，并且当您对它进行沙箱处理时，您实际上是在告诉浏览器将`iframe`内容视为来自不同的来源。引用同[一篇文章](http://msdn.microsoft.com/en-us/hh563496.aspx)：

> *   **独特的原产地处理。**所有内容均在唯一来源下处理。内容无法遍历 DOM 或读取 cookie 信息。
> 
> 这意味着即使来自同一域的内容也会被跨域策略处理，因为每个*IFRAME*内容都将被视为唯一的来源。
> 
> **嵌入的内容只允许显示信息。**不能在*IFRAME*内进行任何可能损害托管网站或利用用户信任的其他操作。

换句话说，如果您省略属性`allow-same-origin`中的`sandbox`，它会将沙盒页面视为属于不同的域（实际上，它将视为具有`null`来源）。由于向 发出 Ajax 请求没有意义`null`，因此沙盒页面根本无法进行 Ajax 调用（如果`localhost`允许它们进行 Ajax 调用，它们将与来自父页面的调用无法区分，从而违背了沙盒的目的）。

### 附加信息

如果您尝试对不同的域进行 Ajax 调用，它显然会失败：

```
<script src="http://code.jquery.com/jquery.min.js"></script>
<script>
    console.log(location.host);
    $.post('https://google.com/',{},function() { });
</script> 
```

但是，它将**如何**失败将取决于所使用的沙盒属性。如果您将上面的页面嵌入到`iframe`其中，`allow-same-origin`它会将其打印到控制台：

```
localhost
XMLHttpRequest cannot load https://google.com/. Origin http://localhost is not allowed by Access-Control-Allow-Origin. 
```

...如果你**不** `allow-same-origin`嵌入它：

```
localhost
XMLHttpRequest cannot load https://google.com/. Cannot make any requests from null. 
```

请注意，虽然两者都报告`location.host`为`localhost`，但一个认为起源是`http://localhost`，而另一个认为它是`null`（显示您在示例中遇到的相同错误消息）。

### 推理

为什么阻止来自同一域的沙盒内容的 Ajax 调用如此重要？如文章中所述：

> *同一域上的内容应该*是安全的，这是有道理的。这里的风险主要来自重新托管在*IFRAME*中的用户生成内容。

让我们举个例子：假设 Facebook 决定允许用户在他们的页面中发布小的 HTML5 动画。它将它们存储在自己的服务器中，并在显示时将它们作为`allow-scripts`唯一的沙箱（因为动画需要脚本才能工作）但拒绝其他所有内容（特别是`allow-same-origin`，因为您不希望用户代码弄乱父页面）。如果默认情况下也没有阻止 Ajax 调用会发生什么？

Mallory 创建了一个“动画”，其中包括：

1.  [使用 Facebook 的 API（比如Open Graph](https://developers.facebook.com/docs/technical-guides/opengraph/tipsandtricks/) ）对 Facebook 执行 Ajax 调用；服务器会很高兴地接受这个调用，因为它知道请求来自一个`https://facebook.com`作为源的页面。

2.  创建一个指向她自己的服务器的 URI，将返回的数据作为查询字符串，并将其设置为`src`沙盒页面中的图片。

当 Alice 访问 Mallory 个人资料并看到动画时，上面的脚本运行：

1.  Ajax 调用在 Alice 的浏览器中运行，而 Alice 已登录；由于服务器不知道呼叫来自哪里（主页或嵌入式页面），它会做任何它被要求做的事情——包括检索个人信息。

2.  当`img`使用 Mallory 的 URI 创建元素时，浏览器将尝试正常加载“图像”，因为图像不受同源策略的约束。

3.  由于 URI 在查询字符串中有 Alice 的私人信息，Mallory 的服务器可以保存它并返回它想要的任何图像。现在马洛里有了爱丽丝的个人信息，爱丽丝一点也不怀疑。

# servicestack - ServiceStack - 依赖似乎没有被注入？

> ID：14486462
> 
> 赞同：4
> 
> 时间：2013-01-23T18:11:21.783
> 
> 标签：servicestack, funq

我有以下存储库类：

```
public class Repository<T> : IDisposable where T : new()
{
    public IDbConnectionFactory DbFactory { get; set; } //Injected by IOC
    IDbConnection db;
    IDbConnection Db
    {
        get
        {
            return db ?? (db = DbFactory.Open());
        }
    }

    public Repository()
    {
        Db.DropAndCreateTable<T>();
    }

    public List<T> GetByIds(long[] ids)
    {
        return Db.Ids<T>(ids).ToList();
    }
} 
```

然后在我的`AppHost.Configure()`. 我像这样注册依赖项：

```
container.Register<IDbConnectionFactory>(c => 
            new OrmLiteConnectionFactory(ConfigurationManager.
       ConnectionStrings["AppDb"].ConnectionString, SqlServerDialect.Provider));

container.RegisterAutoWired<Repository<Todo>>().ReusedWithin(Funq.ReuseScope.None); 
```

但是当我运行我的应用程序时，我的应用程序似乎`DbFactory`是 null 并且没有被正确注入，因为我得到了一个空引用异常。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T19:05:51.140

尝试访问构造函数中的任何依赖项时，它将为 null，因为该类是在 IOC 有机会注入任何依赖项之前启动的。

我会将任何初始化/设置逻辑移出`AppHost.Configure()`，例如：

```
using (var db = container.Resolve<IDbConnectionFactory>().Open())
{
    db.DropAndCreateTable<MyType>();
} 
```

# css - 如何删除css菜单上按钮之间的空格

> ID：14486463
> 
> 赞同：5
> 
> 时间：2013-01-23T18:11:22.580
> 
> 标签：css, menu, navigation, navbar

我是 css 和 html5 的新手，并试图让我的菜单栏正常工作。它是一个具有下拉功能的水平菜单栏。在我将菜单栏居中之前，导航按钮和下拉按钮之间没有空格。居中后，它们之间现在有一个令人讨厌的空间，因为当您在它们之间移动时，下拉菜单更是如此，您会因为空间而丢失下拉菜单。因此，我试图删除按钮之间的空间（而不是边框​​）。非常感谢您的帮助，代码如下：

CSS

```
 /* START NAV MENU */

  nav {
  background-color:#333333;
  height:40px;
  width:100%;
  }

  nav ul {
  font-family: Sonoma, Arial;
  font-size: 20px;
  margin: 0;
  padding: 0;
  list-style: none;
  text-align:center;
  }

  nav ul li {
  display: inline-block;
  position: relative;

  }

  nav li ul { 
  display: none; 
  }

  nav ul li a {
  display: inline-block;
  text-decoration: none;
  background: #666666;
  color: #ffffff;  
  padding: 5px 20px 3px 15px;
  margin-left: 1px;
  white-space: nowrap;
  height:30px; /* Width and height of top-level nav items */
  width:90px;
  text-align:center;
  border-right: 3px solid black;
  border-left: 3px solid black;

  }

  nav ul li a:hover { 
  background: #999999; 
  }

  nav li:hover ul {
  display: block;
  position: absolute;
  height:30px;
  }

  nav li:hover li {
  float: none;
  font-size: 11px;

  }

  nav li:hover a { 
  background: #534635; 
  height:30px; /* Height of lower-level nav items is shorter than main level */
  }

  nav li:hover li a:hover { 
  background: #999999; 
  }

  nav ul li ul li a {
    text-align:left;
  }

  /* END NAV MENU */ 
```

用于资产净值的 HTML：

```
 <nav>
  <ul>
  <li><a href="/">Home</a></li>
  <li><a href="/about">About Us</a>
    <ul>
        <li><a href="/crew">Our Crew</a></li>
        <li><a href="/history">History</a></li>
        <li><a href="/vision">Vision</a></li>
    </ul>
  </li>
  <li><a href="/products">Services</a>
    <ul>
        <li><a href="/carpentry">Carpentry</a></li>
        <li><a href="/waterproof">Waterproofing</a></li>
        <li><a href="/concrete">Concrete</a></li>
        <li><a href="/masonry">Masonry</a></li>
        <li><a href="/prop">Property Maintenance</a></li>
        <li><a href="/metal">Metal Construction</a></li>
        <li><a href="/design">Interior Design</a></li>
        <li><a href="/demo">Demo & Salvage</a></li>
    </ul>
  </li>
  <li><a href="/services">Portfolio</a>
  </li>          
  <li><a href="/contact">Contact</a>
    <ul>
        <li><a href="/email">Via Email</a></li>
        <li><a href="/contact_form">Web Form</a></li>
        <li><a href="/pigeon">Carrier Pigeon</a></li>
    </ul>
  </li>
  </ul>
  </nav> 
```

如果您能解释一下发生了什么变化以及为什么会发生变化，我将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T19:26:23.280

浮动确实是一种选择，但您还有其他可能更可取的选择，因为它们允许您保持内联块样式及其相关优势。

Chris Coyier 的文章 Fighting the Space Between Inline Block Elements [http://css-tricks.com/fighting-the-space-between-inline-block-elements/](http://css-tricks.com/fighting-the-space-between-inline-block-elements/)详细介绍了每一篇，但总的来说，这是由关闭之间的空白引起的`</li>`和下一个`<li>`。

您的选择如下：

### `</li>`从每个列表项中删除结束。

```
<li><a href="/crew">Our Crew</a>
<li><a href="/history">History</a>
<li><a href="/vision">Vision</a> 
```

它是有效的 HTML5，不会破坏任何东西。

### 删除空格，这样您的列表标记几乎都在一行上

```
<li><a href="/crew">Our Crew</a></li><li><a href="/history">History</a></li>
    <li><a href="/vision">Vision</a> 
```

### 注释掉空格

```
<li><a href="/crew">Our Crew</a></li><!--
--><li><a href="/history">History</a></li><!--
--><li><a href="/vision">Vision</a></li> 
```

### 将父级的字体大小设置为0

```
ul {
    font-size: 0;
} 
```

### 设置负右边距以缩小差距

```
a {
    margin-right: -4px;
} 
```

就我个人而言，我更喜欢删除结束标签，因为其他标签看起来太乱而且 font-size: 0 在使用相对大小时效果不太好，但这取决于你，它们都以自己的方式很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:16:00.173

您必须浮动`<li>`'s left 而不是 display:inline-block;

```
 nav ul li {
  float: left; 
  position: relative;

  } 
```

比你必须计算`width:`和`<ul>`修复它，还要`<ul>`让`margin: 0 auto;`菜单居中。

```
nav ul {
width: calculated-width
margin: 0 auto
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-20T11:36:45.497

对 margin 属性使用负值

```
margin-right: negative val; 
```

# php - 安全的方式处理用户提交的链接 - 使用 PHP

> ID：14486467
> 
> 赞同：0
> 
> 时间：2013-01-23T18:11:36.290
> 
> 标签：php, mysql, security, code-injection

在网站上 - 我让用户（通过 facebook 登录）在我的网站上发布链接。

链接通过 REGEX 运行，仅允许特定国家/地区的域/url

然后我在提交的链接/站点上运行 curl 以获取：标题/图像/描述（og：图像/og：描述 +++ 其他）并消除 404 帖子。我检查用户 IP 以及两者之间是否有代理 - 呈现给用户。

我做 str_replace 以消除“<”和“>”。

如果一切顺利，数据将在 MySQL db 中提交并发布在用户 facebook 上。这当然是某种安全性。

我运行 mysql_real_escape_string 以防止 sql 注入，但是如何防止可能通过服务器运行的恶意代码，因为我觉得我对此了解不够，所以我担心它。

那么除了我所做的之外，我还能做些什么来确保用户输入的安全。

# amazon-web-services - Erlang 亚马逊网络服务 (AWS) EC2 API

> ID：14486468
> 
> 赞同：5
> 
> 时间：2013-01-23T18:11:38.203
> 
> 标签：amazon-web-services, amazon-ec2, erlang

我对 AWS EC2 API 有疑问。我用过`erlawys`，`erlcloud`没有任何结果。使用 erlawys 我创建了模型，但是当我执行时

```
aws_ec2_test:test_simple(Key, AccessKey, Model). 
```

我收到错误

```
Failed in calling #Fun<aws_ec2_test.0.112913818> on count 100 from 100 to 0. 
```

的输出`aws_ec2_xml:describe_image`是：

```
aws_ec2:describe_images(Key, AccessKey, Model).
** exception error: undefined function http:request/1
     in function  aws_ec2_xml:describe_images/5 (../src/aws_ec2_xml.erl, line 364)
     in call from aws_ec2:describe_images/6 (../src/aws_ec2.erl, line 222) 
```

该功能`http:request/1`已过时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T09:57:58.973

我使用 erlcloud 而不是 erlawys，因为它很旧而且不能正常工作。
ercloud 非常棒。
可以启动/停止/创建/删除实例，管理密钥，ecc ...
这是 git 链接：
[https](https://github.com/gleber/erlcloud)
://github.com/gleber/erlcloud 我向开发人员发送邮件，因为我对亚马逊爱尔兰有疑问. 他给我发了这个回复。

```
start_instance(Ami, KeyPair, UserData, Type, Zone) ->
Config = #aws_config{
        access_key_id = application:get_env(aws_key),
        secret_access_key = application:get_env(aws_secret)
       },

InstanceSpec = #ec2_instance_spec{image_id = A`enter code here`mi,
                                  key_name = KeyPair,
                                  instance_type = Type,
                                  availability_zone = Zone,
                                  user_data = UserData},
erlcloud_ec2:run_instances(InstanceSpec, Config). 
```

这是自述文件。 [https://github.com/gleber/erlcloud/blob/master/README.md](https://github.com/gleber/erlcloud/blob/master/README.md)

# c# - 正则表达式 - 删除标签

> ID：14486478
> 
> 赞同：-1
> 
> 时间：2013-01-23T18:11:54.277
> 
> 标签：c#, regex

> **可能重复：**
> [使用 C# 正则表达式删除 HTML 标记](https://stackoverflow.com/questions/787932/using-c-sharp-regular-expressions-to-remove-html-tags)

我必须删除标签并将所有其他信息保存在 XML 文件中。使用正则表达式时，我不知何故不知所措。我只能想出逐行读取文件，然后尝试“定位”所有标签并将它们替换为“” - 空字符串。但是，它没有按预期工作：

```
line = Regex.Replace(line, "<.*>", ""); 
```

我能否解释一下为什么这不能按预期工作（我认为它应该只找到 <> 内所有可能的符号组合。另外，你能否推荐一个好的正则表达式介绍。我在常规上读了很多-expressions.info 但我发现它不完整且令人困惑。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T18:13:32.473

您应该使 * 量词惰性，以便它匹配下一个 > 而不是最后一个：

```
line = Regex.Replace(line, "<.*?>", ""); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T18:14:25.527

除了尝试使用正则表达式解析 XML 的徒劳（其他人无疑会发布该链接）之外，您的问题`*`是*greedy*。它将尽可能多地匹配文档中的第一个`<`和最后一个。`>`

例如，如果你有这个：

```
<someTag>some stuff 
```

然后它会正常工作。

但是，如果你有这个：

```
<someTag>some stuff</someTag> 
```

然后它将匹配第一个`<`和最后一个`>`，从而删除标签之间的内容。

正如 BlackBear 建议的那样，一种解决方案是添加`?`to`*`以使其成为*non-greedy*。这样，它将匹配可能的最小匹配而不是最大匹配。

但正如 I4V 所评论的，更好的解决方案是使用 XML 解析器来解析 XML。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T18:24:00.960

当您应该使用 XML 解析器时，为什么要在正则表达式上浪费时间？

```
using (var reader = XmlReader.Create("file.xml"))
{
    while (reader.Read())
    {
        switch (reader.NodeType)
        {
        case XmlNodeType.Text:
        case XmlNodeType.CDATA:
        case XmlNodeType.EntityReference:
        case XmlNodeType.Whitespace:
        case XmlNodeType.SignificantWhitespace:
           Console.Write("{0}", reader.ReadContentAsString());
           break;
        }
    }
} 
```

# javascript - Backbone.js 路由器不会在页面初始化时触发

> ID：14486480
> 
> 赞同：5
> 
> 时间：2013-01-23T18:11:56.467
> 
> 标签：javascript, backbone.js, backbone-events, backbone-routing

我有一个非常简单的主干路由器，到目前为止一切正常。除非我重新加载/直接输入网址，即`http://mydomain.com/#list/50fadc41125b0` 我现在几乎尝试了所有内容，但根本没有任何积极的结果。

```
myRouter = Backbone.Router.extend({
    routes: {
        "list/:id": "getList",      
        "*actions": "defaultRoute" // not needed right now
    },
    getList: function (id) {
        console.log ("test");
    }
}); 
```

我也尝试过这种方式，没有任何区别

```
// init router
router = new myRouter;
router.on('route:getList', function (id) {
    [...]
}); 
```

我不知道如何使这项工作！希望有人给我一个答案！

**编辑：**

我也开始历史

```
Backbone.history.start(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T19:05:55.183

由于一个错误，我在获取成功语句中异步初始化了我的路由器，所以`Backbone.history.start()`没有什么可以初始化的。

感谢用户 Lukas 提醒我之前创建路由器。

# javascript - Amazon S3 CORS 配置 XMLHttpRequest GET

> ID：14486486
> 
> 赞同：5
> 
> 时间：2013-01-23T18:12:12.817
> 
> 标签：javascript, amazon-s3, xmlhttprequest, amazon, cors

我正在通过 Amazon S3 托管一个静态网站，并且那里有一些 Javascript，它将调用另一个域并解析 XML、JSON 或它得到的任何内容。

我关注了 stackoverflow 上的许多帖子以及与之相关的各种博客帖子，声称可以使其正常工作，但即使在非常密切地关注之后，我也永远无法复制结果。

```
 <CORSRule>
   <AllowedOrigin>*</AllowedOrigin>
   <AllowedMethod>GET</AllowedMethod>
 </CORSRule> 
```

我什至尝试在规则中添加和不添加以下内容，

```
 <AllowedHeader>*</AllowedHeader> 
```

以下链接允许您通过发送 XMLHttpRequests 来测试是否启用了 CORS，它表示它无效，因此未正确设置或识别 CORS。

[http://client.cors-api.appspot.com/client/](http://client.cors-api.appspot.com/client/)

可能的线索是此处的 Amazon S3 文档中建议的内容，

[http://docs.aws.amazon.com/AmazonS3/latest/API/RESTBucketGETcors.html](http://docs.aws.amazon.com/AmazonS3/latest/API/RESTBucketGETcors.html)

这表示我们需要设置“s3:GetCORSConfiguration”权限，我通过类似...

"动作": ["s3:GetObject", "s3:GetCORSConfiguration"],

在 AWS 控制面板的“编辑存储桶策略”部分，但它给出了错误并且无法保存，因为它无法识别此操作？

此处关于 stackexchange 的一个可能类似的帖子，

[从 jquery 或 XMLHttpRequest 到亚马逊 aws 的 HTTP GET 失败，并且 Access-Control-Allow-Origin 不允许使用 Origin](https://stackoverflow.com/questions/11201738/http-get-to-amazon-aws-from-jquery-or-xmlhttprequest-fails-with-origin-is-not-al)

似乎表明，如果我有一个托管在 S3 上的网站，它不能将其配置为使 XMLHttpRequests 获取到第 3 方资源？

我觉得我在绕圈子......那里有人有任何线索/建议吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-09-19T17:52:38.887

您必须公开访问控制标头。尝试这个：

```
<CORSRule>
  <AllowedOrigin>*</AllowedOrigin>
  <AllowedMethod>GET</AllowedMethod>
  <ExposeHeader>Access-Control-Allow-Origin</ExposeHeader>
  <ExposeHeader>Access-Control-Allow-Methods</ExposeHeader>
</CORSRule> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-09T18:46:36.360

这里可能与我们刚刚在我们的应用程序上完成的示例有一些关系，该示例与 https 相关，这是我们一些客户端机器上的硬编码配置。我不知道这到底是什么意思，但它可能是一个检查的地方。

而不是 http:// 尝试 https://

[对 Amazon S3 的 XMLHttpRequest 仅在某些计算机上失败](https://stackoverflow.com/questions/27386108/xmlhttprequest-to-amazon-s3-fails-only-on-some-computers/27386441#27386441)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-23T18:25:08.443

我认为您很困惑，或者我误读了您的问题。

您在您的站点上启用 CORS，以便其他站点可以向您的页面发出请求。

在您的 S3 站点上启用 CORS 将允许 example.com 与您的 S3 页面对话。它不允许您的网站与 example.com 对话。

为了让您向其他域发出请求，他们必须启用权限。您不能神奇地为他们的域打开它。这就像说您允许自己走进白宫并使用总统的浴室。当您跳过围栏时，特勤局将用武力拒绝该请求。

# php - PDO fetchAll 非对象错误

> ID：14486488
> 
> 赞同：0
> 
> 时间：2013-01-23T18:12:16.640
> 
> 标签：php, pdo

我怎么会这样做：

```
<?php
$pdo  = new PDO("mysql:host=xxx;dbname=xxx", "xxx", "xxx");
$sql  = $pdo->query("call GetFromCoords($lat, $lng)");

$sql  = $pdo->query("call GetInRadius($zip, $dist)");
$rows = $sql->fetchAll(PDO::FETCH_ASSOC); 
```

我收到此错误：

> 致命错误：在第 28 行的 /home/ryannaddyps/weblyize.com/Party/nearby.php 中的非对象上调用成员函数 fetchAll()

但是，如果我在新连接上运行第二个查询，它工作正常吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:17:49.893

尝试使用[nextRowset](http://php.net/manual/en/pdostatement.nextrowset.php) ()：

```
$pdo  = new PDO("mysql:host=xxx;dbname=xxx", "xxx", "xxx");
$sql  = $pdo->query("call GetFromCoords($lat, $lng)");

$sql->nextRowset(); // This

$sql  = $pdo->query("call GetInRadius($zip, $dist)");
$rows = $sql->fetchAll(PDO::FETCH_ASSOC); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:19:47.003

您的 SQL 查询是否可能触发错误？根据[手册](http://php.net/manual/de/pdo.query.php)，查询失败时`PDO::query`返回`FALSE`（即非对象）。

使用启用`error_reporting`和`display_errors`/或初始化连接`PDO::ERRMODE_EXCEPTION`。

# basic - GWBASIC 文件 我需要了解此代码背后的方程式，但我无法解释它，我可以运行它

> ID：14486490
> 
> 赞同：2
> 
> 时间：2013-01-23T18:12:22.910
> 
> 标签：basic

谁能告诉我如何打开这个旧的 GWBASIC 文件。我可以运行它，但我知道它背后的方程式和代码。

```
"RANGE ADJUSTMENT PROGRAM"·(‘:‘:‘Ý2…
"ENTER RANGE QTY ________ ",QTA!
<…"ENTER PRICE ____________ ",PA!:‘*F…
"ENTER SECOND QTY _______ ",QTB!QP…
"ENTER SECOND PRICE _____ ",PB!:‘s
ZTVAç(QTA!ëPA!):TVBç(QTB!ëPB!)‚
dTVçTVBêTVA”
nLABORçQTBêQTA§
xLABORçTVìLABORÍ
‚‘"LABOR IS ______________ ";LABORç
ŒSUçTVAê(LABORë(QTA!))
–‘"SETUP IS ______________ ";SU:‘:‘1
…"ENTER DESIRED RANGE QTY";QTCE
ªPCçSUìQTCéLABORi
´‘:‘"PRICE FOR ABOVE QTY IS ";PCy
¾PDçPCë33
È‘:‘"PRICE AT 15% MARKUP IS ";PDã
Ò‘:…"ENTER (R)-(ANOTHER RANGE) (N)-(ANOTHER PART) (Q)-(QUIT)",RES$é
Ü‘þæ‹ RES$ç"R" ‰ ‚
ð‹ RES$ç"N" ‰ 
'ú‹ RES$ç"Q" Í þƒ1‰ Ò 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T02:14:09.493

我假设这是一个 .bas 文件并且你有 GW-BASIC 解释器。您可以做的是运行代码，并将其保存为 ASCII 格式，而不是默认的二进制格式。您可以通过附加 A 选项来做到这一点。`SAVE "C:\myfile.bas", A`应该做你需要的。在任何文本编辑器中打开文件，就会出现您的代码。

# objective-c - Objective-C 循环遍历数组需要大量内存

> ID：14486492
> 
> 赞同：0
> 
> 时间：2013-01-23T18:12:28.970
> 
> 标签：objective-c, memory-management

我正在尝试从磁盘读取文件，将其按行分隔，将其存储到 中`NSArray`，然后遍历该数组并对数据执行一些非常基本的操作。但是，如果我使用的是一个很小的文件（大约 5000 行数据，每行一个字），我最终会在循环结束时使用几百兆字节的内存。如果我使用一个非常大的文件（约 200,000 行），我最终会使用几 GB 的内存！为什么会这样？当我将文件加载到数组中时，我应该会看到内存的初始峰值，但是内存使用应该保持相当稳定。我正在使用 ARC，但我不相信它，所以现在我自己做所有的内存管理，我确信我正在释放我在循环中分配的所有临时内容。

```
NSString *fileContents = [NSString stringWithContentsOfFile:path encoding:NSUTF8StringEncoding error:nil];

NSScanner *scanner = [NSScanner scannerWithString:fileContents];
NSMutableArray *wordList = [[[NSMutableArray alloc] init] autorelease];
while (![scanner isAtEnd]) {
    NSString *line = [[NSString alloc] init];
    [scanner scanUpToCharactersFromSet:[NSCharacterSet newlineCharacterSet] intoString:&line];
    [wordList addObject:line];
    [line release];
}
return wordList; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T18:22:42.303

我看到两个问题；您不必要地创建了一个字符串，并且应该将字符集的创建从循环中提升出来。扫描仪可能也在创建临时对象；您还应该在循环中添加一个内部自动释放池。

```
NSMutableArray *wordList = [[[NSMutableArray alloc] init] autorelease];
NSCharacterSet * newline = [NSCharacterSet newlineCharacterSet];
while (![scanner isAtEnd]) {
    @autoreleasepool{
        NSString *line;
        [scanner scanUpToCharactersFromSet:newline intoString:&line];
        [wordList addObject:line];
    }
} 
```

该字符串只是一个普通的旧泄漏；`scanUpToCharactersFromSet:intoString:`不要求分配的字符串，并且在那之后您已经失去了对它的引用 -`release`不是针对与您分配的实例相同的实例。然而，Richard 是对的，这里分配的内存量并不太重要。

至于字符集，自动释放池在你的循环过程中不会被耗尽，所以如果`newlineCharacterSet`每次调用它时都会创建和自动释放一个新实例，你也会在那里建立内存。我希望它`NSCharacterSet`足够聪明，可以为您缓存它，但在[String Programming Guide](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/CharacterSets.html%23//apple_ref/doc/uid/20000146-BAJBJHCG)中有一条注释：

> *   缓存字符集（也许在全局字典中）而不是不断地重新创建它们。

表明情况可能并非如此。

然而，我的三个建议中最有效的一个可能是内部自动释放池。

最后，使用ARC；它可以工作，并且可以处理字符串和字符集的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:42:05.743

您必须考虑到在这段代码中有很多事情发生的事实。

首先，因为您使用的是 NSObjects，所以可能有很多开销，用于存储指向这些对象的指针、存储它们的函数和虚函数表等内容。除此之外，您还有 10,000 个以 null 结尾的字符串。你还有一个 NSMutableArray，根据它的实现方式，它最多可以有一半的分配空间是空的，以允许添加额外的元素，而不是在每次有新元素时增加 NSMutableArray 的大小。

如果您真的想让代码更有效地使用内存，您可能需要考虑使用字符数组来存储字符串和`char *`数组来存储单词列表。我还建议遵循关于使用 Instruments 的“Catfish_Man”建议。

希望这可以帮助！祝你好运！

# html - GWT AbstractImagePrototype.create 未闭合的 img 标签

> ID：14486494
> 
> 赞同：0
> 
> 时间：2013-01-23T18:12:35.313
> 
> 标签：html, gwt

```
 html = AbstractImagePrototype.create(RESOURCES.icon()).getHTML(); 
```

生成这样的字符串：

```
<img onload='this.__gwtLastUnhandledEvent="load";' src='http://localhost:8083/home/s/clear.cache.gif' style='width:16.0px;height:15.0px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAABUElEQVR42pWTv0oDQRDGBxt9CFv/gI2n+AgWVopvIZhGbG7vjivsFM3uJqWQTgQfIA+QTnwCq6ApQhQU/0ECEr/Z2QsrMdw58HG7O7/9dm5vjiiMuLFKysSUmA4l+hXPT5Ebd1yOmT8jtQeAetC4RD3HTiLP53DCSQC8QJeA9ik1SyKMeU1ynsMe3ktpfW+yqMwtqfoGzQrOMVPwvBeDtt/8SLldpLJghlkxabPBUNz0acFE0fp4luS+wIrBkA1G/p0OqWowKwYjNniWib2uXAGzYvCEizFNP/mAdstPByMsV90iyi7WMOl7kwE+W43y1sL05WGNc8wI26fMbBaux9B30Atd556YI5Ebd4P8gFRjJ+hCvYLF9wpdyGVfUaa3fpcXN5eRfAvAL3/iPe7oDrqBMspsJN039R8U3Wgf8DwjpbepZucrf1b/B567Sv4ZP34tDeOz81RuAAAAAElFTkSuQmCC) no-repeat 0px 0px;' border='0'> 
```

但是，请注意 img 标签没有关闭。当我将其添加到 html 模板中，并尝试通过将其放在`</img>`末尾来关闭它时，关闭标签会被剥离。缺少关闭标签会导致它显示字符串

我怎样才能让它关闭带有 oa 傻字符串操作的 img 标签？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:20:39.517

我认为您可能会以错误的方式使用此方法。

如果你打电话，你会得到一个 html 字符串`getHTML()`。你如何将这个字符串添加到你的 DOM 中？

正常的方法是调用类似的东西：

```
FlowPanel fp = new FlowPanel();
fp.add(AbstractImagePrototype.create(RESOURCES.icon())); 
```

这会将图像添加到文档中。

**更新**

如果你想在 SafeHtmlBuild 中使用这个字符串，你必须包装你的字符串。

SafeHtmlBuilder 将把 < 转为 > 和 > 到 < 我认为您将不得不用[SafeHtmlUtils#fromTrustedString](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/safehtml/shared/SafeHtmlUtils.html#fromTrustedString%28java.lang.String%29)包装图像。因为否则它将被逃脱两次。

# windows - powershell批处理管

> ID：14486497
> 
> 赞同：2
> 
> 时间：2013-01-23T18:12:43.073
> 
> 标签：windows, powershell, batch-file

以下行在 powershell 2.0 中运行良好。

```
servermanagercmd.exe -query | Select-String "Application Server" -Context 0,13 
```

但是当我将它合并到我的批处理文件中时，它只会尝试运行第一部分，然后在到达 Select-String 时返回错误。有谁知道如何确保它读取整行？我在管道之前尝试了 ^，但它仍然无法识别整行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T18:15:54.933

您正在尝试使用 cmd.exe 中的 PowerShell 内置命令之一，但这不起作用。但是，您可以从 .bat 文件执行 PowerShell，并传入您要执行的命令：

```
powershell.exe -command "& { servermanagercmd.exe -query | Select-String 'Application Server' -Context 0,13 }" 
```

# html - div 背景不显示

> ID：14486530
> 
> 赞同：0
> 
> 时间：2013-01-23T18:14:35.393
> 
> 标签：html, css

我有一个奇怪的问题。

由 CSS 设置的背景，`.article-container`根本`<article>`不显示（既不显示图像也不显示颜色）。为`<article>`孩子设置的背景显示属性。

**页面： http:** [//new.elenaakulova.com.ua/](http://new.elenaakulova.com.ua/)。

或者**代码：**

```
<div id="article-container">
  <article id="about-me">
    <div id="photo">
      <img src="http://placehold.it/300x404" width="300px">
    </div>
    <div id="description">
      <hgroup>
        <h2>психолог</h2>
        <h1>Вася Пупкин</h1>
      </hgroup>
      <p>Здравствуйте!</p>
    </div>
  </article>
</div> 
```

和

```
#article-container {
  width: 1000px;
  margin-left: auto;
  margin-right: auto;
  background: white;
}

#article-container > article {
  background: white;
}

#about-me #description {
  float: left;
  background: blue;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:17:25.580

您需要添加`overflow: hidden;`到`#article-container`

> 浮动、绝对定位元素、内联块、表格单元格、表格标题和具有“溢出”而不是“可见”的元素（除非该值已传播到视口）建立新的块格式化上下文。在块格式化上下文中，每个框的左外边缘接触包含块的左边缘（对于从右到左的格式化，右边缘接触）。即使存在浮动也是如此（尽管框的行框可能会由于浮动而缩小），除非框建立了新的块格式化上下文（在这种情况下，框本身可能会由于浮动而变窄）。

块格式化上下文清除浮动。来源：[http ://www.w3.org/TR/CSS2/visuren.html#block-formatting](http://www.w3.org/TR/CSS2/visuren.html#block-formatting)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:19:22.663

原因是你的`#photo`and`#description`是浮动的。所以父级失去了它的维度，因为文档流中没有内容。

为. `float:left;`_ `<article>`这解决了你的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:19:59.610

```
#article-container > article {
  background: white;
} 
```

这是白色的，它只是没有高度，sp它不可见试试，

```
#article-container > article {
  background: white;
  height:400px;
} 
```

# vba - 删除由 VBA/OLE 生成的 CSV 行中的最后一个逗号

> ID：14486532
> 
> 赞同：1
> 
> 时间：2013-01-23T18:14:47.913
> 
> 标签：vba, csv, ole

我正在使用 VBA 来控制带有 OLE 自动化的数据库前端。数据库查询的输出采用表格格式，我可以使用应用程序的 OLE 方法来读取单个单元格。我的目标是自动化将此输出转换为 CSV 的过程。我的方法是循环遍历每个单元格并使用 VBA 的`WRITE`函数输出到 CSV，但是这种方法在每行上都留下了多余的逗号。请帮助我删除这个额外的逗号或在没有它的情况下写下一行。在此先感谢您的时间。

第一个循环写入列标题，第二个循环写入表的数据。两个循环都会产生最后一个不需要的逗号。

```
'4\. Write headers and table content to CSV File
     Open pathOutput For Output As #1
         For h = 1 To results.columnCount
             Write #1, Cells(1, h);
         Next h
         Write #1,

         For i = 1 To results.rowCount
             For j = 1 To (results.columncount)
                 Write #1, results.cell(i, j);
             Next j
             Write #1,
         Next i

     Close #1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:11:12.890

这应该可以解决问题：

```
'4\. Write headers and table content to CSV File
    Open pathOutput For Output As #1
        For h = 1 To Results.columncount
            'Add a comma unless it's the last column
            If h <> Results.columncount Then
                Write #1, Cells(1, h);
            Else
                Write #1, Cells(1, h)
            End If
        Next h
        Write #1,

        For i = 1 To Results.RowCount
            For j = 1 To (Results.columncount)
                'Add a comma unless it's the last column
                If j <> Results.columncount Then
                    Write #1, Cells(1, j);
                Else
                    Write #1, Cells(1, j)
                End If
            Next j
            Write #1,
        Next i

    Close #1 
```

我还没有找到这方面的文档，但是分号比如在这里找到

`Write #1, Cells(1, j);`导致`Write`以逗号而不是[默认的 Crlf (related question)](https://stackoverflow.com/questions/9290731/what-is-the-effect-of-a-semicolon-at-the-end-of-a-line)结束行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:17:56.307

我认为最后的`Write #1,`陈述可能是罪魁祸首。当你删除它们时会发生什么？

# c++ - c++中带有cuda支持的错误opencv

> ID：14486533
> 
> 赞同：1
> 
> 时间：2013-01-23T18:14:49.020
> 
> 标签：c++, opencv, gpu, ubuntu-10.04

执行此代码时：

```
#include <iostream>
#include "opencv2/opencv.hpp"
#include "opencv2/gpu/gpu.hpp"

int main (int argc, char* argv[]){
try
{

    cv::Mat src_host = cv::imread(argv[1], CV_LOAD_IMAGE_GRAYSCALE);
    cv::gpu::GpuMat dst, src;
    src.upload(src_host);

    cv::gpu::threshold(src, dst, 128.0, 255.0, CV_THRESH_BINARY);

   cv::Mat result_host;
  dst.download(result_host);
    cv::imshow("Result", result_host);
    cv::waitKey();
}
catch(const cv::Exception& ex)
{
    std::cout << "Error: " << ex.what() << std::endl;
}
return 0; 
```

}

编译得很好......但我运行并收到以下错误：

```
OpenCV Error: Unknown error code -216 (The library is compiled without CUDA support) in copy, file /home/cbib/Descargas/OpenCV-2.4.3/modules/core/src/gpumat.cpp, line 736 
```

我已经安装了opencv cuda，并且如图所示。

我的操作系统是 Ubuntu Server 10.04。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:22:40.767

该错误几乎可以告诉您发生了什么。您安装了未使用 CUDA 支持编译的 OpenCV 版本。

下载 OpenCV 2.4.3 源代码并自行编译。请记住将 cmd-line 上的以下标志传递给**cmake**：

```
-D WITH_CUDA=YES -D CUDA_TOOLKIT_ROOT_DIR="/path/to/cuda/toolkit" 
```

[OpenCV 有一个页面](http://opencv.willowgarage.com/wiki/OpenCV_GPU)解释了所有这些标志等等。

然后在执行**make**之前检查 cmake 的输出，并确保它找到了在您的机器上安装的合适的 CUDA 版本。输出将显示如下内容：

```
--   Other third-party libraries:
--     Use IPP:                     NO
--     Use TBB:                     NO
--     Use Cuda:                    YES
--     Use OpenCL:                  NO
--     Use Eigen:                   YES (ver 3.1.2) 
```

如果失败，您会看到：

```
-- Could NOT find CUDA: Found unsuitable version "4.0", but required is at least "4.1" (found /usr/local/cuda) 
```

**您需要下载并安装[CUDA Toolkit](https://developer.nvidia.com/cuda-toolkit) 4.1**（或更新版本）。

# c# - 网格视图单元格在小计网格视图的底部自动添加 0

> ID：14486538
> 
> 赞同：-2
> 
> 时间：2013-01-23T18:15:15.540
> 
> 标签：c#, .net, vb.net, datagridview

为什么网格视图单元格会在小计网格视图的底部自动添加 0？

```
 int qty = 0;
        int amount = 0;
        int rowtotal = 0;
        int subtotal = 0;
        int total = 0;

        foreach (DataGridViewRow row in itemgridview.Rows)
        {
            qty = Convert.ToInt32(row.Cells[1].Value); 
            amount = Convert.ToInt32(row.Cells[2].Value); 
            rowtotal = qty * amount;
            row.Cells[3].Value = rowtotal;
            subtotal += rowtotal;

        }

        total = subtotal;
        txtordertotal.Text = total.ToString(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:31:00.963

制作`AllowUsersToAddRow = false`，然后重试。此属性将删除多余的行。

# wpf - ReactiveUI：从单元测试中测试可观察的属性

> ID：14486541
> 
> 赞同：0
> 
> 时间：2013-01-23T18:15:24.513
> 
> 标签：wpf, mvvm, reactiveui

RX 官方博客上有这个[例子：](http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx)

```
var scheduler = new TestScheduler();

var xs = scheduler.CreateColdObservable(
    OnNext(10, 42),
    OnCompleted<int>(20)
);

var res = scheduler.Start(() => xs);

res.Messages.AssertEqual(
    OnNext(210, 42),            // Subscribed + 10
    OnCompleted<int>(220)       // Subscribed + 20
);

xs.Subscriptions.AssertEqual(
    Subscribe(200, 1000)        // [Subscribed, Disposed]
); 
```

我想用reactiveui做这样的事情。我的意思是代替 scheduler.CreateColdObservable(...) 使用来自实际属性更改通知的流。问题是我尝试了 vm.ObservableForProperty 和 vm.Changed 但它们的工作不一致（并非所有属性更改都创建了一个事件或值为 null）

这是我的虚拟机的代码：

```
internal class ProductFileEditorVM : ReactiveObject
{
    private readonly List<string> _preloadedList;

    private bool _OnlyContainingProduct;
    public bool OnlyContainingProduct
    {
        get { return _OnlyContainingProduct; }
        set
        {
            this.RaiseAndSetIfChanged(x => x.OnlyContainingProduct, value);
        }
    }

    private ObservableAsPropertyHelper<IEnumerable<string>> _RepoList;
    public IEnumerable<string> RepoList
    {
        get{return _RepoList.Value;}
    }

    public ProductFileEditorVM(RepositoryManager repositoryManager)
    {

        //Set defaults
        OnlyContainingProduct = true;

        //Preload
        _preloadedList = repositoryManager.GetList();

        var list = this.WhenAny(x => x.OnlyContainingProduct,
                     ocp =>
                     ocp.Value
                         ? _preloadedRepoList.Where(repo => repo.ToLower().Contains("product"))
                         : _preloadedRepoList);
        list.ToProperty(this, x => x.RepoList);
    }
} 
```

理想情况下，我想在这两个属性上使用 Observable.CombineLatest 并创建一个元组并在断言表达式中比较这个元组，就像在第一个示例中一样。

好的结果是：

1.  [OnlyContainingProduct==true;RepoList= 过滤后的]
2.  !将 OnlyContainingProduct 更改为 false
3.  [OnlyContainingProduct==false;RepoList= 整个列表]

**或者这是错误的处理方式？我看到的唯一示例使用了毫秒等实际时间度量，但除了 Throttle 和类似方法外，我看不出它们有什么用处。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:09:28.070

所以，因为你没有做与*时间*相关的测试，只做基于*顺序*的测试（即“我做了这个，然后我做了这个，然后它应该是那个），实际上只写一个普通的要简单得多单元测试。TestScheduler 是一把大锤 :)

因此，您可以执行以下操作：

```
var fixture = new ProductFileEditorVM();

bool repoListChanged = false;
fixture.WhenAny(x => x.RepoList, x => x.Value)
    .Subscribe(_ => repoListChanged = true);

fixture.OnlyContainingProduct = true;
Assert.True(repoListChanged); 
```

### 何时使用 TestScheduler

However, if loading RepoList was asynchronous and could take some time, and you wanted to represent a "Loading" state, a TestScheduler would be good for that - you'd click the checkbox at say +20ms, AdvanceTo(200ms), check to see if you're in Loading state, AdvanceTo(10min), then see that the list is updated and the state isn't Loading

# jquery - .load() 限制元素以变量加载

> ID：14486542
> 
> 赞同：0
> 
> 时间：2013-01-23T18:15:33.670
> 
> 标签：jquery, load

好的，所以前几天我问了关于使用`.load`变量的问题，它坚持得很好，很高兴 SO 可以帮助我。不过，我还有另一个问题，我试图限制正在加载的元素，我正在调用`.tdtopics`它，它将`.tdtopics`从我正在加载的页面 url 加载所有元素。相反，我想将其限制为 5，仅此而已。

我试过的两个代码一个是所有元素，另一个是一个元素。

```
$(function(){
  $('body').append('<span id="view_mess">New Message</span><div id="mess_wrapper"><div id="new_mess_pop"></div></div><div id="message_holder"></div>');
    $('#message_holder').load('/privmsg?folder=inbox .tdtopics');
 $('#view_mess').click(function() {
    var msg = $('.tdtopics a').attr('href');
  $('#new_mess_pop').load(msg + ' .post');
   $('#mess_wrapper').show();
    $('.postfoot').remove();
 });
$('#mess_wrapper').click(function(){
  $(this).hide();
 });
}); 
```

……

```
$(function(){
 $('body').append('<span id="view_mess">New Message</span><div id="mess_wrapper"><div id="new_mess_pop"></div></div><div id="message_holder"></div>');
  $('#message_holder').load('/privmsg?folder=inbox .tdtopics:eq(0)');
 $('#view_mess').click(function() {
  var msg = $('.tdtopics a').attr('href');
   $('#new_mess_pop').load(msg + ' .post');
    $('#mess_wrapper').show();
     $('.postfoot').remove();
   });
  $('#mess_wrapper').click(function(){
   $(this).hide();
  });
 }); 
```

同样对于这方面的任何提示都会很好，虽然我稍后会阅读它，我想知道我是否可以展示这个插件，以及究竟如何启动它？我想我会从`$.fn.function`创建默认值开始？就像我说的那样，无论如何我都会阅读这个，只是想知道是否有任何 SO 用户对创建插件有任何建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:20:33.557

尝试[`:lt`](http://api.jquery.com/lt-selector/)

```
$('#message_holder').load('/privmsg?folder=inbox .tdtopics:lt(5)'); 
```

# cocoa - 单击 NSControl 时未调用 mouseDown 事件，甚至在子类 NSView 上也未调用

> ID：14486544
> 
> 赞同：0
> 
> 时间：2013-01-23T18:15:38.770
> 
> 标签：cocoa, nsevent

如何让当前的 NSControl 点击 NSWindow？我在 NSWindowController 上有一个鼠标按下事件，
`-(void)mouseDown:(NSEvent *)theEvent {`
但是当我在放置在 NSWindow 上的 NSControls 内单击时，我根本没有调用鼠标按下事件。
我什至将 NSControls 子类化为自定义 NSViews，但是在内部单击时我也没有收到他们的鼠标按下事件。我添加 `setAcceptsTouchEvents`了是并调用了acceptsFirstResponder，但它没有帮助。令人惊讶的是，当我单击 NSWindow 而不是任何 NSControls 时，我得到了 mousedown 事件。
我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:31:31.667

试试这个

```
 - (void) mouseDown:(NSEvent *)theEvent
{
if ( ([theEvent modifierFlags] & NSCommandKeyMask) != 0)
{
    [self setFloatValue:100.0f];
    [self.target performSelector:self.action withObject:self];
}
else
    [super mouseDown:theEvent];
} 
```

编辑：

目标应该是实现该方法的类实例。因此，例如，如果您的应用程序委托中有一个 IBAction 连接到名为 sliderReport: 的滑块，那么请执行以下操作：

```
 [self sendAction:@selector(sliderReport:) to:[NSApp delegate]]; 
```

# php - 如何为datagrid框架构建一个MySQL while循环PHP多维数组

> ID：14486545
> 
> 赞同：0
> 
> 时间：2013-01-23T18:15:39.913
> 
> 标签：php, mysql, arrays, datagrid, multidimensional-array

我不清楚如何构造一个多维数组来创建一个简单的数据网格框架。我有许多类方法，其中包含来自 MySQL 表的 crud select 语句，格式如下：

```
<?php

  function table1()
  {
    $sql = "SELECT * FROM `table1`";
    $result = mysqli_query ($link, $sql);
    $html = "<table>";
    while ($row = mysqli_fetch_array( $result ))
    {
      $html .= "<tr><td>".$row['field_a']."</td><td>".$row['field_b']."</td></tr>";
    }
    $html .= "</table>";
    return $html;
  }

  function table2()
  {
    $sql = "SELECT * FROM `table2`";
    $result_properties = mysqli_query ($link, $sql);
    $html = "<table>";
    while ($row = mysqli_fetch_array( $result ))
    {
      $html .= "<tr><td>".$row['field_x']."</td><td>".$row['field_y']."</td></tr>";
    }
    $html .= "</table>";
    return $html;
  }

?> 
```

MySQL 表如下所示：

表格1

```
+---------+--------------+------+-----+---------+----------------+
| Field   | Type         | Null | Key | Default | Extra          |
+---------+--------------+------+-----+---------+----------------+
| id      | bigint(12)   | NO   | PRI | NULL    | auto_increment |
| field_a | varchar(128) | NO   |     | NULL    |                |
| field_b | varchar(128) | NO   |     | NULL    |                |
+---------+--------------+------+-----+---------+----------------+ 
```

表 2

```
+---------+--------------+------+-----+---------+----------------+
| Field   | Type         | Null | Key | Default | Extra          |
+---------+--------------+------+-----+---------+----------------+
| id      | bigint(12)   | NO   | PRI | NULL    | auto_increment |
| field_x | varchar(128) | NO   |     | NULL    |                |
| field_y | varchar(128) | NO   |     | NULL    |                |
+---------+--------------+------+-----+---------+----------------+ 
```

我正在尝试用单个数据网格方法替换所有这些方法，从两个汇总网格表中选择有关每个单独表的信息 - 一个具有每个表的属性（表名和该表的 select sql 语句），另一个具有字段名称和每个单独表格的标题：

网格属性

```
+------------+--------------+------+-----+---------+----------------+
| Field      | Type         | Null | Key | Default | Extra          |
+------------+--------------+------+-----+---------+----------------+
| id         | bigint(12)   | NO   | PRI | NULL    | auto_increment |
| table      | varchar(128) | NO   |     | NULL    |                |
| select_sql | varchar(128) | NO   |     | NULL    |                |
+------------+--------------+------+-----+---------+----------------+ 
```

网格字段

```
+--------------------+--------------+------+-----+---------+----------------+
| Field              | Type         | Null | Key | Default | Extra          |
+--------------------+--------------+------+-----+---------+----------------+
| id                 | bigint(12)   | NO   | PRI | NULL    | auto_increment |
| grid_properties_id | bigint(12)   | NO   |     | NULL    |                |
| heading            | varchar(128) | NO   |     | NULL    |                |
| field              | varchar(128) | NO   |     | NULL    |                |
+--------------------+--------------+------+-----+---------+----------------+ 
```

中的数据`grid_fields`。`field`column 仅是 . 中引用的表的字段名称`grid_properties`。`table`, 相关通过`grid_properties`. `id`:: `grid_fields`. `grid_properties_id`.

我用来构造数据网格的方法在最后一个 while 循环中有一个多维数组，它有问题。构建这个的正确方法是什么？

```
<?php

  function grid_schema($table)
  {
    // Get information about $table from the grid_properties table
    $sql = "SELECT * FROM `grid_properties` WHERE `table` LIKE '".$table."'";
    $result_properties = mysqli_query ($link, $sql);
    $properties = mysqli_fetch_array ($result1);
    $properties_sql = $properties['select_sql'];
    $id = $properties['id'];

    // Get information about the grid field names
    $fields_sql = "SELECT * FROM `grid_fields` WHERE `grid_properties_id` ='".$id."'";
    $fields_result = mysqli_query ($link, $fields_sql);

    // Display the Table Headings
    $html = "<table><tr>";
    while ($fields_row = mysqli_fetch_array ( $fields_result ))
    { $html .= "<th>".$fields_row['heading']."</th>"; }
    $html .= "</tr>";

    // Perform the SQL query from the grid_properties table
    $properties_result = mysqli_query ($link, $properties_sql);
    while ($properties_row = mysqli_fetch_array ($properties_result))
    {
      // Print out the contents of each row
      $html .= "<tr>";
      while ($fields_row = mysqli_fetch_array( $fields_result ))
      {
        // This is where I am having problems
        $html .= "<td>".$properties_row[$fields_row]['field']."</td>";
      }
    }
    $html .= "</table>";
    return $html;
  }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T09:02:17.970

```
<?php
    function grid_schema($table)
{
$link = mysqli_connect("localhost", "root", "", "test");

// Get information about $table from the grid_properties table
$sql = "SELECT * FROM `grid_properties` WHERE `table` LIKE '".$table."'";
$result_properties = mysqli_query ($link, $sql);
$properties = mysqli_fetch_array ($result_properties, MYSQLI_ASSOC);
$properties_sql = $properties['select_sql'];
$id = $properties['id'];

// Get information about the grid field names
$fields_sql = "SELECT * FROM `grid_fields` WHERE `grid_properties_id` ='".$id."'";
$fields_result = mysqli_query ($link, $fields_sql);

// Display the Table Headings
$html = "<table><tr>";
    $rows = array();
while ($fields_row = mysqli_fetch_array ( $fields_result, MYSQLI_ASSOC ))
{
        $rows[] = $fields_row['field'];
        $html .= "<th>".$fields_row['heading']."</th>";
    }
$html .= "</tr>";

// Perform the SQL query from the grid_properties table
$properties_result = mysqli_query ($link, $properties_sql);
while ($properties_row = mysqli_fetch_array ($properties_result, MYSQLI_ASSOC))
{
// Print out the contents of each row
$html .= "<tr>";
foreach($rows as $row)
{
// This is where I am having problems
$html .= "<td>".$properties_row[$row]."</td>";
}
}
$html .= "</table>";
return $html;
}

echo grid_schema('table1'); 
```

# ruby-on-rails - sinatra 子应用程序中的过滤器之前

> ID：14486551
> 
> 赞同：5
> 
> 时间：2013-01-23T18:15:53.433
> 
> 标签：ruby-on-rails, ruby, sinatra

我里面有一个 Rails 应用程序和一个 Sinatra 应用程序：

路线.rb：

```
mount MySinatraApp => "/streaming" 
```

西纳特拉应用程序：

```
class MySinatraApp< Sinatra::Base
  ...
  before do
    puts 'hello from sinatra!'
  end
  ...
end 
```

我希望过滤器仅在以 开头的请求上运行`/streaming...`，但是，令我惊讶的是，过滤器在对整个 Rails 应用程序的每个请求上运行。我能用这种行为做什么？我可以在 之后添加一个正则表达式过滤器`before`，但我认为这不是一个好样式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T09:33:51.817

嗯，我换了

```
mount MySinatraApp => "/streaming" 
```

和

```
match "/streaming" => SinatraQuoridor, :anchor => false 
```

过滤器开始按预期说话。尽管如此，我不清楚为什么会这样：根据[这篇](http://living5to9.com/2011/11/rails-routes-match-and-mount/)文章， mount 应该只调用 match with `:anchor => false`，所以路由应该是相同的。但行为不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T02:12:11.123

我也很惊讶地看到这种情况发生，但我想它告诉我们这`filters`是普遍的。既然是这样，您可以尝试使用`Sinatra::Namespace`sinatra [-contrib gem](http://rubydoc.info/gems/sinatra-contrib/1.3.2/frames)，例如

```
require 'sinatra/namespace'

class App < Sinatra::Base
  register Sinatra::Namespace

  namespace "/" do
    before do
      # this will only run within routes marked "/",
      # which should also be prepended with the mounted route, 
      # so "/streaming/"
    end

    get "/?" do
      # something here
    end

  end 
```

我不完全确定这会起作用，这可能意味着路由必须包含尾部斜杠，因此“/streaming/”而不是“/streaming”（肯定有解决方法）但至少它可能会解决您遇到的问题。

* * *

### 更新

我测试了下面的代码，过滤器只针对他们自己的应用程序的 url 运行。似乎此代码也不需要命名空间部分。我注意到你已经指定了`mount`方法，但这不是 Rack 的一部分——你使用的是哪个库？机架式？

```
require 'rubygems'
require 'bundler'
Bundler.require

require 'sinatra'
require 'sinatra/namespace'

class StreamingApp < Sinatra::Base
  register Sinatra::Namespace

  namespace "/" do
    before do
      warn "Entering Streaming before filter"
    end

    get "/?" do
      "Hello from the StreamingApp"
    end
  end

  namespace "/something" do
    before do
      warn "Entering Streaming's /something before filter"
      warn "request.path_info = #{request.path_info}"
    end
    get "/?" do
      "Hello from StreamingApp something"
    end
  end
end

class OtherApp < Sinatra::Base
  before do
    warn "Entering OtherApp before filter"
    warn "request.path_info = #{request.path_info}"
  end
  get "/" do
    "Hello from the OtherApp"
  end
end

app = Rack::URLMap.new(
  "/streaming" => StreamingApp,
  "/" => OtherApp 
)

run app 
```

输出：

```
[2013-01-25 14:19:52] INFO  WEBrick 1.3.1
[2013-01-25 14:19:52] INFO  ruby 1.9.3 (2012-04-20) [x86_64-darwin10.8.0]
[2013-01-25 14:19:52] INFO  WEBrick::HTTPServer#start: pid=78178 port=9292

Entering OtherApp before filter
request.path_info = /
127.0.0.1 - - [25/Jan/2013 14:20:03] "GET / HTTP/1.1" 200 23 0.0201

Entering Streaming before filter
request.path_info = 
127.0.0.1 - - [25/Jan/2013 14:20:11] "GET /streaming HTTP/1.1" 200 27 0.0044

Entering Streaming before filter
request.path_info = /
127.0.0.1 - - [25/Jan/2013 14:20:15] "GET /streaming/ HTTP/1.1" 200 27 0.0016

Entering Streaming before filter
request.path_info = /something
Entering Streaming's /something before filter
request.path_info = /something
127.0.0.1 - - [25/Jan/2013 14:20:21] "GET /streaming/something HTTP/1.1" 200 33 0.0018 
```

请注意两个过滤器是如何在 StreamingApp 中运行的，[即使命名空间的文档说它不应该发生](http://rubydoc.info/gems/sinatra-contrib/1.3.2/frames)。我一定在那里做错了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T19:32:07.590

```
['/streaming', '/otherlink', '/whatever'].each do |path|
  before path do
    puts 'hello from sinatra!'
  end
end 
```

编辑：

如果您真的想保留您的结构，您还可以执行以下操作（但我的第一个答案绝对是更好的解决方案）：

```
before do
  if request.path.start_with? '/streaming'
    puts 'hello from sinatra!'
  end
end 
```

# intuit-partner-platform - Intuit.Ipp.E xception.InvalidTokenException：未经授权

> ID：14486557
> 
> 赞同：0
> 
> 时间：2013-01-23T18:16:02.020
> 
> 标签：intuit-partner-platform, quickbooks-online

我已经使用 QuickBooks Anywhere 构建了 QuickBooks Online 集成。我正在使用 QuickBooks Online 的付费版，但我的客户正在使用试用版。我的应用程序目前处于开发模式，尚未获得 Intuit Marketplace 的批准。

此代码适用于我的网站。试用 QuickBooks Online 是否意味着您无法写入数据？我的客户能够很好地提取帐户、供应商和付款方式的列表。

这是我的代码：

```
ItemQuery itQuery = new ItemQuery();
itQuery.Name = "Unknown";
itemsList = itQuery.ExecuteQuery<Item>(); 
```

> QBO：错误 2013 年 1 月 23 日下午 12:59:48 查询项目时出错：Intuit.Ipp.E​​xception.InvalidTokenException：在 Intuit.Ipp.Services.QboService.Get[T]（IQboQuery qboQuery，字符串 simpleQuery，布尔 isQuerySpecified）未授权在 Intuit.Ipp.Services.ServiceExtensions.ExecuteQuery[T]（IQuery 查询，ServiceContext serviceContext）

客户可以验证OK：

```
OAuthRequestValidator oauthValidator = new OAuthRequestValidator(acT, acTS, coK, coKS);
IntuitServicesType st = IntuitServicesType.QBO;
ServiceContext context = new ServiceContext(oauthValidator, acT, cId, st);
dataServices = new DataServices(context); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T19:33:45.370

我发现如果 itQuery.Name 变量为 null 或空字符串，那么您将收到此错误。Intuit 能否将错误消息更改为“您必须为项目查询名称字段指定一个值。您输入了一个空字符串或空字符串。”

在我的特殊情况下，我有一个应该说未知的字符串。这是一个空字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T22:41:58.317

You will need to add error checking to your application to ensure you are not passing empty string. Otherwise you are making an unnecessary API call.

The root cause seems to be that the signature is not calculated correctly by the DevKit when an empty string is passed, but the request is not valid.

# c++ - QTcpSocket 可以释放它的描述符吗

> ID：14486559
> 
> 赞同：2
> 
> 时间：2013-01-23T18:16:05.420
> 
> 标签：c++, qt, qtcpsocket

QTcpSocket 是否可以释放其描述符，以便**可以将套接字的所有权转移**到不同线程上的另一个 QTcpSocket 对象或 QSslSocket，**而无需关闭/中断**套接字？

```
socket1.setDescriptor(descriptor);

// .....

descriptor = socket1.descriptor();
socket1.release();                       // <--- Is there a way to do this?
socket2.setSocketDescriptor(descriptor); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T00:56:41.623

不，一旦将套接字描述符分配给`QTcpSocket`.

但我不确定你是否需要。`QTcpSocket`通常可以将 移动到另一个线程，`moveToThread`约束与任何移动相同`QObject`：

*   `moveToThread`应该在对象当前所属的线程内调用，
*   对象不能有父对象（您可以使用 删除它`theObject->setParent(0);`，或移动父对象而不是对象），

并且因为它是 a `QTcpSocket`，所以接收线程应该运行一个事件循环，或者您需要使用该`waitFor...`线程中的函数。

[该注释](http://qt-project.org/doc/qt-4.8/qtcpserver.html#note-33)似乎表明这仅适用于 Qt 4.7 以来的套接字。

# ios - 将 NSImage 从 CMYK 转换为 RGB

> ID：14486563
> 
> 赞同：2
> 
> 时间：2013-01-23T18:16:23.900
> 
> 标签：ios, objective-c, macos, nsimage, nsbitmapimagerep

经过一整天的搜索，我找到了一些类似的答案，但似乎没有什么对我有用。

我已经构建了一个要在 OSX 中使用的应用程序，它从用户输入的目录中获取图像列表，通过重命名过程运行每个图像，转换为 JPG，并希望在您的帮助下转换为 RGB 颜色。

```
NSImage *image = [[NSImage alloc] initWithContentsOfFile:from];

NSInteger imageWidth = image.size.width * 4.16666666667;
NSInteger imageHeight = image.size.height * 4.16666666667;

NSBitmapImageRep* theRGBImageRep = [[NSBitmapImageRep alloc]
    initWithBitmapDataPlanes:NULL pixelsWide:imageWidth pixelsHigh:imageHeight
        bitsPerSample: 8 samplesPerPixel: 4 hasAlpha: YES isPlanar: NO
    colorSpaceName: NSCalibratedRGBColorSpace bytesPerRow: 0 bitsPerPixel: 0];

NSGraphicsContext* theContext = [NSGraphicsContext
                    graphicsContextWithBitmapImageRep: theRGBImageRep];

NSImageRep* theImageRep = [image bestRepresentationForRect:
   NSMakeRect(0.0, 0.0, imageWidth, imageHeight) context:theContext
     hints:[NSDictionary dictionaryWithObject:NSDeviceRGBColorSpace
                     forKey:NSDeviceColorSpaceName]];

[NSGraphicsContext saveGraphicsState];
[NSGraphicsContext setCurrentContext: theContext];

NSRect theBoundsRect = NSMakeRect(0.0, 0.0, [theRGBImageRep pixelsWide],
                                                [theRGBImageRep pixelsHigh]);

[[NSColor clearColor] set];

NSRectFill(theBoundsRect);

[theImageRep drawInRect: theBoundsRect];
[NSGraphicsContext restoreGraphicsState];;
[image addRepresentation: theRGBImageRep];

NSDictionary *imageProps = [NSDictionary dictionaryWithObjectsAndKeys:
        [NSNumber numberWithFloat:1.0],NSImageCompressionFactor, nil];
NSData *bitmapData = [theRGBImageRep representationUsingType:NSJPEGFileType
                   properties:imageProps];

if ([bitmapData writeToFile:toJPG atomically:YES] == YES){
    feedback = [NSString stringWithFormat:@"%@ -> %@\n", string, jpgFileName];
    [readOut insertText:feedback];
    [readOut display];
} else {
    feedback = [NSString stringWithFormat:@"%@ - FAILED\n", string];
    [errorLog insertText:feedback];
    [errorLog display];
} 
```

如果图像在指定文件夹中正确输出为 JPEG，但始终保持 CMYK。还有其他人遇到这个吗？

已编辑以显示已清除的结果：

![](../Images/278d222f880a632d55c7dc7b003b95c5.png)

![](../Images/855a4fa6cdb4c4cb7fc48d17454f9882.png)

更新的代码（这是当前给出的淘汰结果）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:22:52.903

试试这个

```
NSImageRep* theImageRep = [inputImage bestRepresentationForDevice:
[NSDictionary dictionaryWithObject: NSDeviceRGBColorSpace

forKey: NSDeviceColorSpaceName]];

NSString* theColorSpace = [theImageRep colorSpaceName];

if ([theColorSpace isEqualToString: NSDeviceCMYKColorSpace])
{
NSBitmapImageRep* theRGBImageRep = [[[NSBitmapImageRep alloc]
initWithBitmapDataPlanes: NULL

pixelsWide: [theImageRep pixelsWide]

pixelsHigh: [theImageRep pixelsHigh]

bitsPerSample: 8

samplesPerPixel: 4

  hasAlpha: YES

  isPlanar: NO

 colorSpaceName: NSDeviceRGBColorSpace

 bytesPerRow: 0

 bitsPerPixel: 0] autorelease];

  NSGraphicsContext* theContext = [NSGraphicsContext
graphicsContextWithBitmapImageRep: theRGBImageRep];
[NSGraphicsContext saveGraphicsState];
[NSGraphicsContext setCurrentContext: theContext];

NSRect theBoundsRect = NSMakeRect(0.0, 0.0, [theRGBImageRep pixelsWide],
[theRGBImageRep pixelsHigh]);

[[NSColor clearColor] set];
NSRectFill(theBoundsRect);

[theImageRep drawInRect: theBoundsRect];

[NSGraphicsContext restoreGraphicsState];

ASSIGNOBJECT(rgbImage, [[[NSImage alloc] initWithSize: [theImageRepsize]] autorelease]);

[rgbImage addRepresentation: theRGBImageRep];
}
else
{
ASSIGNOBJECT(rgbImage, inputImage);
 } 
```

# iphone - 用于在 iphone 上本地存储评级的数据库

> ID：14486572
> 
> 赞同：0
> 
> 时间：2013-01-23T18:17:27.507
> 
> 标签：iphone, ios, database

我目前正在开发一个应用程序，用户可以在其中对应用程序中的不同对象进行评分（5 星）。我正在使用 parse.com 在线存储所有数据（评分数、星数），效果很好。

但我想做的是将数据本地存储在用户的 iPhone 上，这样即使他没有互联网连接，仍然会显示一些内容。而且我还会存储该用户的评分。

基本上我需要的是一个可以轻松读取和更新的本地数据库。我一直在阅读有关它的内容，但我不知道该使用哪个... Sqlite？XML 文件？杰森？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:26:24.043

您可以使用 Core Data、sqlite、plist 文件或任何其他类型的文本或二进制文件。他们都会工作。

选择归结为选择哪一个最适合您的需求，同时考虑到可能的未来增长。

您的数据是否容易存储在字典数组中？然后只需将数组写入文件（plist）。如果数据量很容易放入内存，则此方法有效。

您是否有大量数据要读取和写入？数据是否太大而无法放入内存？是否不需要一次将所有数据都保存在内存中？然后使用原始 sqlite（或各种 Objective-C 包装器之一）或使用 Core Data。Core Data 有一个巨大的学习曲线，但它比原始 sqlite 有一些好处。阅读有关 Core Data 的信息，看看是否值得付出努力。

# iphone - 我如何理解哪个 tableViewCell 包含被点击的按钮？

> ID：14486576
> 
> 赞同：0
> 
> 时间：2013-01-23T18:17:40.610
> 
> 标签：iphone, objective-c, uitableview, uibutton

> **可能重复：**
> [如何知道 UITableview 行号](https://stackoverflow.com/questions/9274494/how-to-know-the-uitableview-row-number)

我在这个 tableView 上有一个 tableView 和一个 tableViewCell。我为 tableViewCell 定义了另一个名为 CustomCell 的类，以便我编写必要的自定义代码并创建一个按钮（在此单元格上）。单击 tableViewCell 上的按钮时，我想了解哪个 tableViewCell 包含该按钮，以便我可以仅对该单元格（包含单击的按钮）进行必要的更改

我如何理解哪个 tableViewCell 包含被点击的按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:27:26.063

如果您将附件详细信息按钮替换为自定义按钮，则可以调用附件按钮TappedForRowWithIndexPath: 方法。

示例 - 将其放在 cellForRowAtIndexPath 中（设置单元格时）：

```
UIButton *myAccessoryButton = [[UIButton alloc] initWithFrame:CGRectMake(0, 0, 125, 24)];
[myAccessoryButton setImage:[UIImage imageNamed:@"yourImage.png"] forState:UIControlStateNormal];
[cell setAccessoryView:myAccessoryButton];
[myAccessoryButton release];
cell.accessoryType = UITableViewCellAccessoryDetailDisclosureButton; 
```

然后作为一个单独的方法：

```
- (void)tableView:(UITableView *)tableView accessoryButtonTappedForRowWithIndexPath:    (NSIndexPath *)indexPath
{
    //do something
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:27:55.883

实现这一点的一种策略是将带有行号的标签分配给按下的按钮：

```
- (UITableViewCell *)tableView:(UITableView *)tableView 
         cellForRowAtIndexPath:(NSIndexPath *)indexpath {
    YourCustomCell *cell = // Code
    cell.button.tag = indexPath.row;

    // Other cell preparation code

    return cell;
} 
```

然后，在按钮的动作中，你可以看到它的标签是什么，以确定对应的模型对象是什么：

```
- (void)didSelectButton:(id)sender {
    UIButton *button = sender;
    NSInteger tag = button.tag;

    YourModelObject *item = self.items[tag];

    //    Continue with the business logic for what should
    //    happen when that button is pressed.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:29:46.970

这个怎么样...

```
- (UITableViewCell *)cellWithSubview:(UIView *)subview {
    while (subview && ![subview isKindOfClass:[UITableViewCell self]]) subview = subview.superview;
    return (UITableViewCell *)subview;
}

- (IBAction)buttonClicked:(id)sender {
    UITableViewCell *theCell = [self cellWithSubview:sender];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T20:21:40.040

您需要以这种方式调用此`cellForRowAtIndexPath`方法。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
        cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    }

    button = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    button.frame = CGRectMake(10 , 10, 200, 20);
    [button addTarget:self action:@selector(passRowValueMethod:) forControlEvents:UIControlEventTouchUpInside];
    [button setTag:indexPath.row];
    [button setTitle:[NSString stringWithFormat:@"%d", indexPath.row] forState:UIControlStateNormal];
    [cell addSubview:button];

    return cell;
} 
```

然后定义按钮目标方法并在该方法中获取标签值。

```
-(void)passRowValueMethod:(UIButton*)sender
{
    UIButton *buttonGet = sender;
    NSLog(@"%d", buttonGet.tag);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-24T05:19:18.550

-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

```
UIButton * button = [UIButton buttonWithType:UIButtonTypeCustom];

CGRect frame = CGRectMake(0.0, 10.0, 24, 24);
button.frame = frame;
[button setTag:((indexPath.section & 0xFFFF) << 16) |
 (indexPath.row & 0xFFFF)];
[button setImage:[UIImage imageNamed:@"link-buttoni4.png"] forState:UIControlStateNormal];
[button setImage:[UIImage imageNamed:@"link-button-onclicki4.png"] forState:UIControlStateHighlighted];
[button setSelected:NO];

// set the button's target to this table view controller so we can interpret touch events and map that to a NSIndexSet

[button addTarget:self action:@selector(checkButtonTapped:) forControlEvents:UIControlEventTouchUpInside];
button.backgroundColor = [UIColor clearColor];
cell.accessoryView = button; 
```

}

-(void)checkButtonTapped:(UIButton *)sender {

```
NSUInteger section = ((sender.tag >> 16) & 0xFFFF);
NSUInteger row     = (sender.tag & 0xFFFF);
NSLog(@"Button in section %i on row %i was pressed.", section, row); 
```

}

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-24T10:56:56.243

试试这个，
你可以知道在这个方法中单击的单元格的部分和行号：
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
}

1>section 可以通过
int sectionno = indexPath.section
2>cell 索引可以通过
int rowno = indexPath.row
获得然后使用你可以像这样得到表格单元格，

```
UITableViewCell *cell=[product_table cellForRowAtIndexPath:[NSIndexPath indexPathForRow:rowno inSection:sectionno]]; 
```

# javascript - 在 Bing Maps AJAX 中不使用 PushPins 的纬度/经度位置的鼠标事件？

> ID：14486582
> 
> 赞同：0
> 
> 时间：2013-01-23T18:17:59.127
> 
> 标签：javascript, dom-events, bing-maps

我在一家车队跟踪公司工作，当我们将所有代表服务调用的图钉放在地图上时，Bing 地图的整体速度会减慢到无法使用的速度。我们推测它与拖动地图时它必须移动的 DOM 元素的数量有关。我们可能同时在地图上拥有数十辆汽车和数百个服务电话。

为了解决这个问题，我正在创建一个自定义`TileLayer`谁的源到我们的服务器，并且构建磁贴以使我们的图钉显示在磁​​贴上。到目前为止一切顺利，除了现在我不知道如何为`MouseOver`瓷砖上的“图钉”做事件。

我正在寻找一种在地图上某些位置引发鼠标事件而不添加 DOM 元素的方法。

一个可靠但可能非常慢的方法是`MouseOver`在整个地图对象上设置一个事件，该事件将查看鼠标接近哪个服务调用。如果鼠标足够近，它可以以这种方式调用事件。我真的很想避免这样做。

我尝试添加具有定义的高度/宽度且没有图标的 PushPins，希望有一个易于移动的元素（不需要重绘的元素），它可以触发鼠标事件，但无济于事。没有事件触发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T08:05:48.597

有几件事情需要考虑。

1：你应该在这么小的地图上显示那么多信息吗？我的意思是，网络地图的最佳实践建议以最佳方式保持可读性，因此集群可能是一个有趣的选择，但最重要的是，在跟踪场景中选择一辆车或人后，可能应该重新考虑用例场景以仅显示交互式图钉。

如果您必须使用集群，这应该使用服务器端集群来完成，因此您只需下载您能够在地图控件上显示的内容，它将减少需要下载的数据量，将优化客户端的性能（仅需要管理的元素数量较少）。

2：如果你想创建一个平铺层，这意味着你使用的是位图信息而不是矢量信息。可能有一些适合您的方法：

*   使用地图点击并获取与您的点击相对应的坐标（像素 -> 地理）并调用网络服务以获取有关应在特定区域显示的事件或元素的完整信息
*   使用地图点击而不是使用网络服务，在客户端进行操作。除此之外，您可以使用 Canvas 元素在地图控件上绘制图钉或信息，这样您就可以保持交互并能够根据客户端事件或操作自定义呈现。这不受官方支持，但根据您的用例，它可以很好地工作。

元素数量的限制主要与浏览器有关，而不是 Bing 地图平台，如果您在 IE8 中尝试使用其他地图控件进行相同的操作，您将获得与您的用例直接相关的同样糟糕的体验。

# ckeditor - 带有spring mvc的ckeditor不起作用

> ID：14486584
> 
> 赞同：2
> 
> 时间：2013-01-23T18:18:11.930
> 
> 标签：ckeditor

我正在尝试将 ckeditor 与 spring mvc 项目集成，但它似乎不起作用。据我所知，我正在关注文档，但出了点问题。我得到的唯一输出是一个没有工具栏或任何类似 ckeditor 的文本区域。如果我指定“完整”工具栏，这将保持不变。看起来好像没有找到 ckeditor，但为什么呢？

注意：在我的 servlet-context.xml 中我都尝试过

```
<resources mapping="/resources/**" location="/resources/" /> 
```

和

```
<resources location="/, classpath:/META-INF/web-resources/" mapping="/resources/**"/> 
```

仍然没有找到。

1）我在webapp目录下的Eclipse中有ckeditor 3.6.6。我从下载中复制了所有文件。

2）我的jsp有以下内容：

```
 <head>
    <script type="text/javascript" src="/ckeditor/ckeditor.js"></script>
    <script type="text/javascript" src="/ckeditor/adapters/jquery.js"></script>
    <title>Home</title>
 </head> 
```

注意：我也尝试将 src 称为 src="/resources/ckeditor/..." 但仍然不行。

```
<textarea id="editor1" name="editor1">&lt;p&gt;Initial value.&lt;/p&gt;</textarea>
<br>

 <script type="text/javascript">
CKEDITOR.replace( 'editor1',
    {
        toolbar : 'Basic',
        uiColor : '#9AB8F3'
    });
   </script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T19:41:06.523

我可以建议您检查您的参考路径。

您当前的路径说 ckeditor.js 文件应该位于`http://example.com/ckeditor/ckeditor.js`但我假设它在一个`resources`文件夹中。

试试这个：

```
<script type="text/javascript" src="/resources/ckeditor/ckeditor.js"></script> 
```

我已经发布了另一个关于引用资源应该如何工作的答案。这应该可以帮助您弄清楚为什么会出现 404ing
[如何在 HTML 中正确引用本地资源？](https://stackoverflow.com/a/14489018/124069)

或者，您可以尝试使用 CDN 托管文件。
*但是：不能保证 jsdelivr 会长期在线*

```
<head>
   <script type="text/javascript" src="//cdn.jsdelivr.net/ckeditor/4.0.1/ckeditor.js"></script>
</head> 
```

[另请注意，cdn http://www.jsdelivr.com/#!ckeditor](http://www.jsdelivr.com/#!ckeditor)中有更多插件等

# twitter - 无法使用 dotnetopenauth 通过 twitter 进行身份验证

> ID：14486585
> 
> 赞同：4
> 
> 时间：2013-01-23T18:18:16.460
> 
> 标签：twitter, asp.net-mvc-4, dotnetopenauth

嗨，我正在尝试让我的网站的用户能够使用 twitter 登录。我想用 localhost 注册我的应用程序，以便我可以测试。由于 twitter 不接受这一点，我将 url 更改为 127.0.0.1 我还尝试添加端口号。我在 AuthConfig 文件中输入了我的秘密。当我点击 twitter 按钮时，我得到了错误

`The remote server returned an error: (401) Unauthorized.`

然后我开始在 iis 上运行我的应用程序以解决我的网站无法使用我的 windows live 帐户登录的问题（对问题进行了排序），但我仍然收到此未经授权的错误。有人请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T19:32:10.890

`DotNetOpenAuth`我遇到了完全相同的问题，无论我尝试什么都无法解决。与 Facebook 或 Google+ 相比，Twitter 的身份验证过程更难正确使用`DotNetOpenAuth`。经过许多令人沮丧的时间，对数据的各个部分进行不同次数的加密和编码，并且总是在未经授权的情况下得到无用的 401，我将[Tweetsharp](https://github.com/danielcrenna/tweetsharp)添加到组合中，并创建了自己`IAuthenticationClient`的 Twitter 身份验证。使用 执行身份验证相当简单`Tweetsharp`。这变成了一个相对微不足道的事情：

在您的`TwitterClient`构造函数中：

```
var twitterService = new TwitterService(consumerKey, consumerSecret); 
```

在您的实施中`IAuthenticationClient`：

```
public void RequestAuthentication(HttpContextBase context, Uri returnUrl)
{
    var requestToken = twitterService.GetRequestToken(returnUrl.AbsoluteUri);
    var redirectUrl = twitterService.GetAuthorizationUri(requestToken).AbsoluteUri;
    context.Response.Redirect(redirectUrl, true);
}

public AuthenticationResult VerifyAuthentication(HttpContextBase context)
{
    var oAuthToken = context.Request.QueryString["oauth_token"];
    var oAuthVerifier = context.Request.QueryString["oauth_verifier"];
    var requestToken = new OAuthRequestToken { Token = oAuthToken };
    var accessToken = twitterService.GetAccessToken(requestToken, oAuthVerifier);
    twitterService.AuthenticateWith(accessToken.Token, accessToken.TokenSecret);
    var user = twitterService.VerifyCredentials();
    var userId = user.Id.ToString();
    var extraData = new Dictionary<string, string>
    {
        {"accesstoken", accessToken.Token},
        {"accesstokensecret", accessToken.TokenSecret},
        {"id", userId},
        {"name", user.Name},
        {"username", user.ScreenName},
        {"link", user.Url},
    };
    return new AuthenticationResult(true, ProviderName, userId, user.ScreenName, extraData);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-10T13:54:23.900

嗨原来这是一个配置问题。我需要指定一个回调 url。我将其设置为与我的网站相同

# javascript - 如何正确处理 JavaScript 事件中的闭包？

> ID：14486586
> 
> 赞同：2
> 
> 时间：2013-01-23T18:18:18.303
> 
> 标签：javascript, events, svg, closures

我正在构建自己的类（用于 SVG 对象）并且最近开始向它添加事件处理。遵循标准模型，我想要这种类型的交互

```
svgobj.bind('click', function(e){
  // do stuff here on click with svgobj
}); 
```

*即使我使用 jQuery 来附加事件，这个“绑定”不是 jQuery`bind()`方法并且 svgobj 不是 jQuery 对象*

我遇到的问题是，如果我创建多个对象，那么该`svgobj`匿名函数内的引用是最后`svgobj`创建的，而不是触发事件的那个。因此，例如，如果我的事件负责更改对象的状态，则无论我单击哪个对象，只有最后一个对象会更改状态。

我知道这是一个关闭问题，在一位同事的帮助下，我找到了解决方法，但这是一个非常难看的问题。它涉及将函数包装在一个自动执行的匿名函数中，我将正确传递给该`svgobj`函数并返回原始函数，这是一个示例

```
svgobj.bind('click', (function(target){
    return function(e){
      // do stuff here on click with target, i.e. the correct svgobj
    }
  })(svgobj)
); 
```

它有效，您可以在此处查看示例[http://jsfiddle.net/2late2die/98te2/](http://jsfiddle.net/2late2die/98te2/)。您可以通过单击红色/绿色区域来测试拖动事件（通过圆圈部分）和更改状态事件。

有没有更好的方法来解决这个问题？我想避免每次我想对事件做某事时都必须使用两个匿名函数。也许有一种方法可以将自执行函数移动到首先调用事件的方法中，这样“在外部”它仍然看起来像只有一个常规函数作为参数传递？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:31:37.677

通过使用[`.bind`](http://api.jquery.com/bind/)（我假设 jQuery 是如何使用的），*函数*`this`内部成为目标，所以应该不需要在函数内部使用变量。*`svobj`*

 *```
svgobj.bind('click', function (e) {
  // do stuff here on click with `this` or `$(this)`
}); 
```

如果您确实想要一份与当时`svgobj`完全相同的当前副本`.bind`，那么您需要在它自己的范围内捕获它以保护它免受更改。您描述为“丑陋”的 lambda 函数方式很可能是实现这一目标的最简单方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:28:37.293

你在那里使用了一个非常标准的约定，它会被认为是相当地道的javascript。

如果你真的想让它更干净，你可以像这样拆分匿名函数

```
function getCallBack(target){
   return function(e){
       //Do stuff with target
   }
}

svobj.bind('click',getCallBack(svobj)); 
```

总体而言更长，但它清理了绑定调用，然后您可以添加注释以阐明回调函数的使用。如果您打算重用该代码，也很有用。

### 更新

由于您似乎正在使用自定义绑定函数，因此您可以通过设置``var that = this;`然后`that`在内部函数内部引用来捕获内部闭包内的原始 this 值。`that`然后将始终引用调用对象，无论您使用多少级别的内部函数。

但是由于您显然在使用 jQuery，我建议您只使用 jQuery 绑定函数并让您自己轻松使用。*

# sql - SQL规范化，3个固定值上的多对多？

> ID：14486588
> 
> 赞同：3
> 
> 时间：2013-01-23T18:18:22.040
> 
> 标签：sql, database-design

我试图理解多对多的关系，但我的脑袋一直在我的这个爱好项目上打破：

在游戏数据库中，我目前有一个包含所有列和值的表。

```
GAMES
id   name   alt_name1   alt_name2   type                length    group_size
----------------------------------------------------------------------------
1    foo    foozoo      NULL        ice, team, silly    s, m      s, l, xl 
```

但是，在实现搜索时，我在专门为**小团体寻找****中等长度的****愚蠢**游戏时遇到了问题。

 ****据我了解，为了规范化，我将为`name`（一个 id 到最多三个名称）创建一个新表。`type`，`length`并且`group_size`是多对多关系，所以我需要为它们的值创建表，并创建一个表来保存它们与游戏的关系：

```
type
games_type
length
games_length
group_size
games_group_size 
```

**有没有比创建所有这些表更好的方法？**

谢谢你的想法！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:20:43.210

任何时候你有一个多对多的关系，你应该有 2 个包含不同值的表，然后是另一个关联这两者的表（联结表）。

在包含非关联记录的表中，所有其他列都应描述主键唯一的属性。如果一个描述性值可以在一个表中出现多次，它可能应该有自己的表（查找表）。

例如：

```
Items_A
id,name

Items_B
id,name

A_with_B
item_a_id,item_b_id 
```

一个常见的用法是用户和组，如下所示：

```
Users
id,name

Groups
id,name

Group_Users
user_id,group_id 
```

如果您扩展该示例以包含一个查找表，您可能会有类似这样*的内容（用户只能在一个位置，但可以属于多个组）*：

```
Users
id,name,location_id

Locations
id,name

Groups
id,name

Group_Users
user_id,group_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:20:36.833

没错，您正在使用和表有效地**分解**多对多关系`games_type`，从而允许游戏具有多个类型、长度和组大小。`games_length``games_group_size`****

# jquery - jQuery可点击元素嵌套在可拖动元素中

> ID：14486591
> 
> 赞同：2
> 
> 时间：2013-01-23T18:18:51.280
> 
> 标签：jquery, draggable

假设我的 HTML 代码如下所示：

```
<script>
  $("#draggable").draggable();

  $("#clickable").click(function() {
    alert('CLICK!');
  });
</script>

<div id="draggable">
    <div id="clickable">        
    </div>
</div> 
```

如您所见：可点击的 div 嵌套在可拖动的 div 中。当我使用可单击的 div 作为绑定到它的句柄单击事件拖放可拖动的 div 时，它会被触发。那不是理想的行为。我希望仅在单击可单击但不将其拖动到任何地方时才触发单击事件。甚至可能吗？我想补充一点，我对使用 setTimeout （或类似）的解决方案不感兴趣。在这里，您有 jsfiddle[链接](http://jsfiddle.net/AJmTg/8/)（注意：添加了 css 以提高可见性）。

感谢您提供任何线索！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:29:31.213

干得好：

```
function handleClick() {
    alert('click!');
};

$("#draggable").draggable({
    start: function () {
        $('#clickable').off('click');
    },
    stop: function () {
        setTimeout(function(){
            $('#clickable').on('click', handleClick);
        },1);
    }
});

$("#clickable").on('click', handleClick); 
```

演示：http: [//jsfiddle.net/HmK9z/](http://jsfiddle.net/HmK9z/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T18:24:21.503

像这样使用可拖动方法的回调：

HTML：

```
<div id="draggable">
    <div id="clickable">        
    </div>
</div> 
```

查询：

```
var dragged = false;
$("#draggable").draggable({stop:function(ev,ui) { dragged = true;}});

$("#clickable").click(function() {
    if(!dragged)
        alert('CLICK!');
    dragged = false;
}); 
```

JSFiddle：http: [//jsfiddle.net/AJmTg/9/](http://jsfiddle.net/AJmTg/9/)

祝你好运！

# ios - 使用日历事件调用 ios 应用程序

> ID：14486593
> 
> 赞同：2
> 
> 时间：2013-01-23T18:18:52.637
> 
> 标签：ios, objective-c, mobile, calendar

我正在为 iPhone 制作闹钟应用程序。谁能告诉我，当以编程方式调用日历事件时，是否有办法在日历事件中启动某些已安装的应用程序？我想从我的应用程序中设置一个闹钟（iPhone 日历中的事件），到时候我的事件发生并且应该启动我的应用程序。嗯，类似的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T06:18:02.643

简短的回答，不。您不能劫持日历应用程序的通知。

但是，您可以使用[本地通知](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/IPhoneOSClientImp/IPhoneOSClientImp.html#//apple_ref/doc/uid/TP40008194-CH103-SW13)来呈现警报，就像日历应用程序在特定时间所做的那样，然后用户可以选择查看警报并被带到您的应用程序。

另一种选择，尽管很笨拙，是在日历条目的注释或其他字段中添加指向您的应用程序的链接。像 myapp://event/123456 这样的东西，用户必须知道触摸这个 URI 才能打开你的应用程序。

# java - 为什么这个算法是线性的而不是线性的？

> ID：14486596
> 
> 赞同：12
> 
> 时间：2013-01-23T18:19:01.560
> 
> 标签：java, algorithm, complexity-theory, big-o

```
int sum = 0; 
for (int n = N; n > 0; n /= 2)
   for (int i = 0; i < n; i++)
      sum++; 
```

我很确定它会在 nlogn 中增长，但被告知它是线性的……为什么它是线性的而不是线性的？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-23T18:22:53.660

它是线性的。想象一下`n`是 64 秒。内部循环运行 64 次，然后是 32 次，然后是 16 次，然后是 8 次，然后是 4 次，然后是 2 次，然后是 1 次。64 + 32 + 16 + 8 + 4 + 2 + 1 = 127。

所以它需要`2n-1`总操作（对于 2 的幂，但这不会改变分析），假设内部循环没有被优化掉。这很明显`O(n)`——线性的。

如果内部 for 循环被优化掉（到`sum += n;`），它是对数的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-23T18:25:51.767

该算法的复杂度为 Θ(N)。

操作次数为

```
sum{2**k} for k = 0..log2(N) 
```

这个进度的总和是

```
2*N-1 
```

这是Θ（N）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-14T14:19:15.937

形式上，使用 Sigma 表示法可以帮助您清楚地看到增长顺序是线性的。

![在此处输入图像描述](../Images/db10a688285a34d02937f54248e74b40.png)

# git - 跨不同 SCM 系统同时管理单个项目

> ID：14486600
> 
> 赞同：1
> 
> 时间：2013-01-23T18:19:17.460
> 
> 标签：git, svn, version-control, mercurial

我目前有一个项目托管在我使用 sourcetree 管理的私有 Git 存储库上。最近我决定和一群朋友合作这个项目。然而，他们更喜欢 Mercurial 和 SVN 而不是 Git，我更愿意为我的项目创建单独的 Mercurial 和 SVN 存储库，以便他们在维护我自己的 Git 存储库的同时进行协作。我想知道是否可以通过 Sourcetree 或任何其他方法执行以下操作：

1.  我的工作系统上有一个项目文件夹，可以同时将我的项目跟踪到所有三个 repo (Git /Mercurial / SVN) 上？

2.  如果 1\. 是可能的，那么我是否可以选择性地从任一版本控制系统中提取更改并选择性地将更改推送到它们？

我在 Mac 上使用 Sourcetree。我遇到了一个用户的文章，他为 github 和 bitbucket 上的单独存储库执行此操作，但我不记得要在此处共享的链接。我希望找到一种好方法来简化代码管理。如果这样的问题不属于这里，请原谅我，模组可能会关闭它。任何帮助表示赞赏:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T08:22:18.313

我强烈建议**不要**在单个工作目录中混合使用 2 或 3 个不同的 VCS。为不同的引擎保持透明的统一性只是额外的头痛。

为您提供的免费工作目录（全部 - 以 Git 为中心）是更易于管理且不那么混乱的解决方案：

*   只需为每个“外国”存储库添加一个额外的远程 - “Mercurial-source”和“SVN-source”；
*   拉“其他”回购，推“自己”

SVN-link 可以由 git-svn 支持，Mercurial-link（来自 Git 端）由[“Mercurial bridge”支持](http://felipec.wordpress.com/2012/11/13/git-remote-hg-bzr-2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T02:08:53.747

实际上，通过直接使用 git 存储库，hg 可以通过 hg-git 扩展名很好地访问它。但是如果你的意图是维护两个存储库，我认为这也是可行的。

事实上，在一个文件夹中，它可以有 .hg 文件夹用于 mercurial，.git 文件夹用于 git，如果你是这个意思的话。其实 hg 和 git 是区分工作目录和仓库的，所以这个文件夹可以存放不同的仓库。

对于第二个问题，我认为你需要在 hg 和 git 中设置一些钩子，并让它们通过 hg 的 hg-git 扩展进行通信，当在任何系统中发生推送时。据我所知，这个扩展运行良好。

但是对于 SVN，情况就不同了。虽然 hg 和 git 都有 svn 扩展（hgsubversion 和 git-svn；这里的扩展是一个通用概念，而不是特定于类似 hg 的扩展），但 DVCS 系统将很容易分支，这会导致映射到 svn 有点复杂。

因此，我认为通过 hg-git 扩展和钩子将 hg 和 git 存储库放在一个文件夹中是可行的，而对 svn 不太确定。

# java - @ApplicationException 的继承可以在 EJB 3.1 中被覆盖吗？

> ID：14486603
> 
> 赞同：4
> 
> 时间：2013-01-23T18:19:27.230
> 
> 标签：java, ejb-3.1

如果我有一个带有 @ApplicationException(inherited = true, rollback = true) 的异常，但我希望子类不回滚。我可以只用@ApplciationException(rollback = false) 注释子类吗？或者那行不通？规范似乎没有说，我可以找到。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T19:48:07.060

EJB 3.1 规范 (JSR 318) 确实在第 14.2.1 节中解释了这一点。有一个例子：

```
In the following example :
@ApplicationException(rollback=true)
public class ExceptionA extends RuntimeException
public class ExceptionB extends ExceptionA
@ApplicationException(inherited=false, rollback=false)
public class ExceptionC extends ExceptionB
public class ExceptionD extends ExceptionC

ExceptionA is an application exception with transaction rollback.
ExceptionB is an application exception with transaction rollback.
ExceptionC is an application exception without transaction rollback.
ExceptionD is not an application exception. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T19:18:10.533

[JSR 220](http://download.oracle.com/otn-pub/jcp/ejb-3_0-fr-eval-oth-JSpec/ejb-3_0-fr-spec-ejbcore.pdf)没有明确说明在这种情况下应该发生什么。它确实指定`application-exception`部署描述符元素将覆盖特定 EJB 的任何带注释的值：

> 应用程序异常不会自动导致将事务标记为回滚，除非 ApplicationException 注释应用于异常类并指定回滚元素值 true 或异常的应用程序异常部署描述符元素将回滚元素指定为 true。应用程序异常部署描述符元素的回滚子元素可以显式指定以覆盖由 ApplicationException 注释指定或默认的回滚值

`@TransactionAttribute`这与其他 Java EE 组件（等）的注解如何工作相结合`@ConcurrencyManagement`，将导致人们强烈假设子类`@ApplicationException`注解将覆盖其父类的注解。我通过一个简单的测试确认了这种情况（显示的代码不完整）：

```
@ApplicationException(inherited = true, rollback = true)
public class MyBaseException extends RuntimeException {
    // Constructors
}

public class MySubException1 extends MyBaseException {
    // Constructors
}

@ApplicationException(rollback = false)
public class MySubException2 extends MyBaseException {
    // Constructors
}

@Stateless
@TransactionManagement(TransactionManagementType.CONTAINER)
@TransactionAttribute(TransactionAttributeType.REQUIRED)
@Path("/misc/exception")
@Produces(MediaType.APPLICATION_JSON)
public class ExceptionResourceImpl {
   @Inject
   private BaseDAO baseDAO;

   public ExceptionResourceImpl() {
      super();
   }

   @GET
   @Path("/app/{id}")
   public Response getApplicationException(@PathParam("id") final String id) {
      final PaymentTypeModel model = new PaymentTypeModel();
      model.setPayment("Key" + System.currentTimeMillis());

      if ("1".equals(id)) {
         baseDAO.create(model);
         throw new MySubException1(
               "Throwing sub exception 1, default annotation behaviour");
      } else if ("2".equals(id)) {
         baseDAO.create(model);
         throw new MySubException2(
               "Throwing sub exception 2, overrides annotation behaviour");
      } else {
         return Response.status(Status.BAD_REQUEST)
               .entity("Must supply id of 1 or 2").build();
      }
   }
} 
```

结果：

*   请求 /misc/exception/app/1 会导致屏幕上出现错误，并且没有记录保存到数据库中。
*   请求 /misc/exception/app/2 会导致屏幕上出现错误，但记录***会***保存到数据库中，也就是处理了不回滚事务的注释覆盖`MySubException2`。

* * *

*** 编辑 ***

[JSR 318](http://download.oracle.com/otn-pub/jcp/ejb-3.1-pfd-oth-JSpec/ejb-3_1-pfd-spec.pdf)`ApplicationException`确实通过使用示例阐明了继承注释的行为。

> 在以下示例中：
> 
> @ApplicationException(rollback=true) 公共类 ExceptionA 扩展 RuntimeException
> 
> 公共类 ExceptionB 扩展了 ExceptionA
> 
> @ApplicationException(inherited=false, rollback=false) 公共类 ExceptionC 扩展 ExceptionB
> 
> 公共类 ExceptionD 扩展了 ExceptionC
> 
> ExceptionA 是具有事务回滚的应用程序异常。ExceptionB 是具有事务回滚的应用程序异常。ExceptionC 是没有事务回滚的应用程序异常。ExceptionD 不是应用程序异常

这证实了我最初的陈述和测试。

# jquery - Flexslider 未正确加载

> ID：14486605
> 
> 赞同：0
> 
> 时间：2013-01-23T18:19:32.467
> 
> 标签：jquery, flexslider

我从未见过类似的问题。当我加载页面时，flexslider 不会加载，但是当我打开 chrome 的 web 检查器或 firebug 时，它会加载。在 iPad 上同样的事情，当页面加载时它不会加载，当我触摸并按住它时它会加载..

我正在加载 css 文件、lib 文件并通常在 a 中调用 flexslider 函数`$(function(){...})`：

```
$('.flexslider').flexslider({
    animation: "slide",
    animationLoop: true,
    itemWidth: 215,
    minItems: 2
}); 
```

也试过`$(window).load`

以前有没有其他人遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:27:07.170

而不是**$(window).load**尝试**$(document).ready**

# .net - 有什么方法可以确定用户在 WebBrowser.ShowDialog() 中单击了打印还是取消？

> ID：14486606
> 
> 赞同：4
> 
> 时间：2013-01-23T18:19:35.880
> 
> 标签：.net, winforms, devexpress, webbrowser-control

我只是想确定用户是否从对话框中选择了打印或取消。我找不到任何可能让我知道[WebBrowser](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx)控件中显示的文档是否实际发送到打印机的事件或属性。我现在能得到的最接近的是确定对话框是否打开。

这可能吗？

谢谢。

（我们使用的是 DevEx，所以如果我所追求的可以通过他们的控制之一实现，我也会对此感兴趣。）

背景：我们在 WebBrowser 中显示的是位于其 XSL 文件旁边的目录中的 xml 文件的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T09:48:47.273

如果您在谈论`ShowPrintDialog()`我认为返回类型存在问题，因为它会调用所选打印机的 UI。此 UI 不一定是标准化的，因此您可能有一个没有取消按钮的窗口：/

遇到类似问题时，我只是创建了一个简单的“打印表单”并用于打印`WebBrowser.Print()`

# ruby - 如何使用 selenium-webdriver 获得倒数第三个值 boo？

> ID：14486608
> 
> 赞同：2
> 
> 时间：2013-01-23T18:19:39.923
> 
> 标签：ruby, selenium-webdriver, ruby-1.9.3

```
<a href="/app1/data/r.doc">  foo    </a>
<a href="/app2/data/r.doc">  boo    </a>
<a href="/app3/data/r.doc">  loo    </a>
<a href="/app3/data/r.doc">  goo    </a> 
```

从下面的`html`部分，我必须找出倒数第三个`text`......现在要访问我写了下面的代码（`used selenium-webdriver`）：

```
all_links=driver.find_elements :tag_name, "a"

all_links.each do|link|

puts link.attribute("href")
puts link.text()

end 
```

那么现在如何使用 获得倒数第三个`boo`值`selenium-webdriver`？我告诉上面第三个最后`foo`可以有100个。

请问有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T22:47:10.377

您可以获得任何具有负索引的数组的倒数第三个元素：

```
array = [:foo, :bar, :baz, :qux]
array[-3] # => :bar 
```

所以在你的情况下

```
all_links = driver.find_elements(:tag_name, "a")
all_links[-3].text.strip # => "boo" 
```

请注意，您可以使用`text`方法而不是`attribute("text")`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T19:02:51.017

我找到了一种解决方案，如下所示：

```
all_links=driver.find_elements :tag_name, "a"

@linkscollection = Hash.new

all_links.each do|link|

text = link.attribute("text").strip
href = link.attribute("href").strip
@linkscollection[text]=href

end

#puts @linkscollection.length
print @linkscollection.keys[1] #=>boo 
```

# c++ - 在标准化之前多久可以使用“字符串”？

> ID：14486611
> 
> 赞同：5
> 
> 时间：2013-01-23T18:19:43.680
> 
> 标签：c++, history

C++ 于 1998 年正式标准化，但我们能在多远之前找到一个`string`类似于`std::string`C++2003 中的名称的类在预标准 C++ 实现中？

我问是因为`CString`，作为 MFC 的一部分，自 1992 年以来一直“存在”，我正试图确定它是在最终成为`std::string`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T18:21:52.393

之前还好。1992 年，每个人都还在开设自己的弦乐课程。请记住，这`std::string`最初很糟糕，然后它变得很糟糕*，并且*是一个 STL 风格的容器——但这在过程中已经很晚了，因为委员会将第一个标准推迟了两年，以适应 STL 和 Stepanov 所需的一切。所以`std::string`直到很晚才最终确定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T18:51:21.677

您可能会在 1998 年之前找到一个有点相似的，但实际上，在标准之后几年*之后*，您才能或多或少地指望有一个存在。早期的那些充其量只是“有点”相似。我记得注意到`push_back`其中一个委员会草案（我认为是最后一个草案）中没有，这是一个明显的疏忽，如果有人实现了具有该功能的版本，就不会发生这种情况。

# android - Environment.getExternalStorageState() 在虚拟设备上返回 false

> ID：14486617
> 
> 赞同：5
> 
> 时间：2013-01-23T18:20:18.927
> 
> 标签：android, android-permissions

我正在尝试检查外部存储是否可用，甚至我认为我所做的一切都是正确的，但它仍然说存储不可用。

```
 private String state;
    protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
        setContentView(R.layout.externaldata);
        eWrite = (TextView) findViewById(R.id.tveWrite);
        eRead = (TextView) findViewById(R.id.tveRead);
        enviromentState = Environment.getExternalStorageState();        
if (enviromentState.equals(Environment.MEDIA_MOUNTED)) {
                    // read and write
                    eWrite.setText("you can write");
                    eRead.setText("you can read");
                } else if (enviromentState.equals(Environment.MEDIA_MOUNTED_READ_ONLY)) {
                    // read but cant write
                    eWrite.setText("you cannot write ");
                    eRead.setText("but you can read");
                } else {
                    eWrite.setText("you cannot write");
                    eRead.setText("you canot read");
                }
    } 
```

我还授予了 AndroidManifest.xml 的权限

```
 <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/> 
```

这是我的虚拟设备的屏幕截图。

![截屏](../Images/80fa04f2e47b31abe4f69f8072824d2a.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:42:14.560

我通过将 SD 卡大小扩展到**151mb来解决我的问题**

# android - 我可以在操作栏中使用 2 导航模式吗？

> ID：14486620
> 
> 赞同：1
> 
> 时间：2013-01-23T18:20:35.210
> 
> 标签：android, tabs, actionbarsherlock

我正在尝试使用`ActionBarSherlock`，我需要实现 2 导航模式

`NAVIGATION_MODE_LIST`和`NAVIGATION_MODE_TABS`

我的代码

```
actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);
actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS); 
```

但是，我不能同时使用两者，只能使用最后一个。在这种情况下，模式选项卡

我如何同时使用两者？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:33:20.257

> 我如何同时使用两者？

你不能。操作栏一次只有一种导航模式。

您可能会考虑切换到`ViewPager`一个选项卡式寻呼机指示器（例如，`PagerTabStrip`），并将其用于您的选项卡。

# ruby - Ruby：将一组键映射到值的简写

> ID：14486626
> 
> 赞同：1
> 
> 时间：2013-01-23T18:20:57.597
> 
> 标签：ruby, hash, map, proc, collect

我最近刚开始使用 Ruby，我希望有一种速记方法可以将绑定方法用作我缺少的 proc。我试图从本质上做到这一点

```
SYMBOLS = {"I" => 1, "V" => 5, "X" => 10, ... }

roman = "zXXIV".upcase.chars.collect { |c| SYMBOLS[c] }
=> [nil, 10, 10, 1, 5] 
```

我觉得在 ruby​​ 中应该有一种简单的方法来使用 SYMBOLS[] 作为绑定方法，所以只需

```
roman = str.upcase.chars.collect &:SYMBOLS[] 
```

**解决方案 Ruby 1.9.3**

罗马 = SYMBOLS.values_at(*str.upcase.chars)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:41:32.043

```
SYMBOLS = {"I" => 1, "V" => 5, "X" => 10 }
roman = "zXXIV"

p roman.chars.map(&SYMBOLS.method(:[]))
#=> [nil, 10, 10, 1, 5] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T18:25:46.633

```
SYMBOLS.values_at(str.upcase.chars.to_a) 
```

关于 using `SYMBOLS[]`，您仍然需要将字符传递给方法。

您可以通过*获取*该方法`SYMBOLS.method(:[])`，例如，

```
> p = SYMBOLS.method(:[])
> p.call("X")
=> 10 
```

我不相信在这种情况下它是最易读的——对我来说，调用`map`和传入`SYMBOLS[]`虽然简洁而实用，但比我更喜欢延迟理解正在发生的事情。

# android - 从 AsyncTask 进行 SQLiteOpenHelper 调用时，Android 冻结

> ID：14486630
> 
> 赞同：0
> 
> 时间：2013-01-23T18:21:12.353
> 
> 标签：android, sqlite, android-asynctask

如果我有一个 SQLiteOpenHelper 类，其中包含用于将对象插入数据库的方法，如果我从 AsyncTask 内部调用此方法，那么对数据库的调用是在单独的线程上还是在主 UI 线程中完成？

我认为数据库调用将在后台线程上进行。我是否错误地理解了 asynctask 类？我是否必须重写我的 SQLiteOpenHelper 中的所有数据库调用才能使用异步任务？

目前，我在我的安卓设备上遇到了很多延迟，并且有一条消息说：

```
The application may be doing too much work on its main thread. 
```

我正在调用一个 web 服务，该服务响应一个 json 字符串，我在 doinbackground 方法中解析该字符串，然后将项目插入数据库。

```
public class DB_Async {
public void replaceDeck(String jsonString, Delegate d){
    ReplaceDeck del = new ReplaceDeck();
    del.setDelegate(d);
    del.addParameter("json", jsonString);
    del.execute();
}
private class ReplaceDeck extends AsyncTask<String, Object, String> {

    private Delegate delegate;
    private Exception error;
    private Hashtable<String, String> parameters = new Hashtable<String, String>();

    public void setDelegate(Delegate d){
        delegate = d;
    }

    public void addParameter(String key, String value){
        parameters.put(key, value);
    }

    @Override
    protected void onPreExecute() {                     //Main Thread
        super.onPreExecute();

        if(delegate != null)
            delegate.onStart();
    }

    @Override
    protected void onPostExecute(String result) {       //Main Thread
        super.onPostExecute(result);
        if(delegate != null)
            delegate.onResult(result, error);
    }

    protected String doInBackground(String... params){  //BACKGROUND THREAD
        String currDate = new Date().toString();
        SQLdataHelper mDataHelper = SQLdataHelper.getInstance();
        String result = null;
        String jsonString = parameters.get("json");
        try {
            JSONObject jsonObj    = new JSONObject(jsonString);    
            JSONArray  jsonDecks = jsonObj.getJSONArray("decks");   
            for(int i = 0; i < jsonDecks.length(); i++){
                Deck newDeck = new Deck();
                int new_deck_id =  mDataHelper.addDeck(newDeck); // call to SQLOpenHelper
            }           
        } catch (JSONException e) {
            e.printStackTrace();
        }catch(Exception e)
        {
            System.out.println(e);
            result = e.getMessage();
            error = e;
        }
        return result;
    }
} 
```

我的数据库只是在我的 Decks 列中插入了一个新行：

```
 public synchronized long addDeck(Deck deck){
    String currDate = new Date().toString();
    ContentValues values = new ContentValues();
    values.put(DB_DECK_UID_COLUMN, deck.student_id);
    values.put(DB_DECK_NAME_COLUMN, deck.name);
    values.put(DB_DECK_DESC_COLUMN, deck.description);
    values.put(DB_DECK_DIFFICULTY_COLUMN, deck.difficulty);
    values.put(DB_DECK_COUNT_COLUMN, deck.cardCount);
    values.put(DB_DECK_RATING_COLUMN, deck.rating);
    values.put(DB_DECK_CREATED_COLUMN, currDate);
    values.put(DB_DECK_UPDATED_COLUMN, currDate);
    values.put(DB_DECK_WEBID_COLUMN, deck.web_id);
    values.put(DB_DECK_NEED_SYNC, 0);
    long deck_id = mDB.insert(DB_DECK_TABLE, null, values);
    return deck_id;
} 
```

为了调用这个方法，我创建了一个新的委托并调用了我的 ReplaceDeck。

```
DB_Async.Delegate asyncDelegate = new DB_Async.Delegate() {
        @Override
        public void onStart() {
            // TODO Auto-generated method stub
        }
        @Override
        public void onResult(String result, Exception e) {
            Toast.makeText(mContext, "Successful Download", Toast.LENGTH_SHORT).show();
        }
    };
    try{
        DB_Async bf = new DB_Async(mContext);
        bf.replaceDeck(jsonString, asyncDelegate);
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:31:06.477

> 我正在调用一个 web 服务，该服务响应一个 json 字符串，我在 doinbackground 方法中解析该字符串，然后将项目插入数据库。

意味着您正在尝试在 UI Thread 上进行 webservice 调用，然后将其`replaceDeck`作为参数传递给`AsyncTask`在 doinbackground 中启动和解析它。

您还需要将 webservice 调用相关代码放在 AsyncTask 的 doinbackground 方法中。为此，您可以使用两个 AsyncTask 的一个来调用 web 服务以获取数据，第二个用于在 DB 中插入数据。

# python - pyinstaller 编译的文件有 ssl 问题，错误：185090050

> ID：14486631
> 
> 赞同：2
> 
> 时间：2013-01-23T18:21:16.460
> 
> 标签：python, ssl, python-requests, pyinstaller, httplib2

我有一些在 python ide 和 cmd 提示符下成功运行在我的 windows 机器上的 python 代码。

在我用 pyinstaller 编译（到一个文件中）后，我收到以下错误：

```
Traceback <most recent call last>:
    File "<string>", line 51, in <module>
    File "build\bdist.win32\egg\oauth2\__init__.py", line 682, in request
    ... ((traceback through httplib2 and then ssl))
ssl.SSLError: [Errno 185090050] _ssl.c:340: error:0B084002:x509 certificates routines:X509_load_cert_crl_file:system lib 
```

导致错误的我的代码子集如下：

```
 import oauth2 as oauth
     import httplib2
     import urlparse

     #consumer inputs
     consumer_key    =   'blah'
     consumer_secret =   'blah'
     consumer = oauth.Consumer(consumer_key, consumer_secret)

     #other inputs
     request_token_url = 'https://api.linkedin.com/uas/oauth/requestToken?scope=r_network'
     access_token_url =  'https://api.linkedin.com/uas/oauth/accessToken'
     authorize_url =     'https://api.linkedin.com/uas/oauth/authorize'

     #instantiate consumer object
     client = oauth.Client(consumer)
     resp, content = client.request(request_token_url, "POST", ) 
```

应该是一个简单的api请求！我已经查看了所有内容并尝试在代码开头使用以下内容：

```
 httplib2.Http(ca_certs = 'cacert.pem') 
```

……那没用。

我还用新的 cacert.pem（重命名为 cacerts.txt）替换了我在 httplib2 文件夹中的 cacerts.txt 文件……但这没有用。

我试图用这个禁用ssl：

```
 httplib2.Http(disable_ssl_certificate_validation=True) 
```

...但这没有用。

如何使用 pyinstaller 编译我的 python 脚本，而不会弄乱？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T12:19:20.983

当我尝试使用 OAuth 2.0 连接到谷歌驱动器时，我遇到了同样的问题。我搜索并发现解决方案在**init** .py 这一行中的 httplib2 中发生了变化

```
CA_CERTS = os.path.join(
    os.path.dirname(os.path.abspath(__file__ )), "cacerts.txt") 
```

通过这个其他

```
CA_CERTS = os.path.join(os.path.dirname(sys.executable), "cacerts.txt") 
```

然后构建 .exe 并将“cacerts.txt”文件放在 .exe 的同一文件夹中。

它对我有用，我希望它也对你有用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T16:23:52.353

解决了我自己的问题！在我的代码中的每一行之后：

```
 client = oauth.Client(consumer) 
```

我添加了这一行：

```
 client.ca_certs = os.path.join(os.path.dirname(__file__),'cacert.pem') 
```

然后我只是将“cacert.pem”文件与我的 exe 一起保存。超级容易。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-08-19T03:41:48.960

您必须在系统中找到 cacerts.txt 文件并确保您有权读取它。

# asp.net - ASP.NET webapp - ORA-12154: TNS: 无法解析指定的连接标识符

> ID：14486632
> 
> 赞同：6
> 
> 时间：2013-01-23T18:21:23.260
> 
> 标签：asp.net, oracle

我是一名新的 (ASP.NET) 开发人员，从现有项目开始，其中一部分连接到 Oracle 数据库。我以前没有使用过Oracle。

在 Web 应用程序尝试连接到 Oracle 时，它​​会引发上述异常。

很多其他帖子都提到了这个例外，但我觉得我已经遵循了所有建议，但无济于事。

这是我的设置的概览：

1.  我已将 Oracle 客户端版本 11.2.0 安装到主目录“C:\app\TroughT\product\11.2.0\dbhome_1”
2.  我已将另一台开发人员机器（这一切正常）的 tnsnames.ora 文件添加到“C:\app\TroughT\product\11.2.0\dbhome_1\NETWORK\ADMIN”
3.  我已将 sqlnet.ora 中的 APP_BASE 变量更改为“C:\app\TroughT\product\11.2.0\dbhome_1\log”
4.  我（现在）让每个人都可以完全控制整个 dbhome_1 目录和子目录
5.  在 Oracle 网络管理器中，我使用 ASP.NET 连接字符串中使用的相同安全凭证测试了相关连接，并且测试正常
6.  我添加了一个 TNS_ADMIN 系统变量，其值为“C:\app\TroughT\product\11.2.0\dbhome_1\NETWORK\ADMIN”

我们一定错过了什么，但我就是不知道是什么。请帮忙！

**更新：**

我发现用我的 tnsnames.ora 文件中的完整定义替换连接字符串中的 SID 确实有效。下面的例子。一定与 ASP.NET 未能找到我的 tnsnames.ora 文件有关，但我知道该文件是有效的，并且据我所知，我的所有系统变量都指向正确的位置。所以至少我现在正在工作，但我想了解为什么我的 tnsnames.ora 文件不起作用。

失败的连接字符串：

```
"Data source=RMSUSNAP;User ID=uuuu;Password=pppp;" 
```

工作连接字符串：

```
"Data source=(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = replaced.host.name)(PORT = 1521))(CONNECT_DATA =(SID = rmsusnap)));User ID=uuuu;Password=pppp;" 
```

tnsnames.ora 的相关部分：

```
RMSUSNAP.WORLD =
    (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = replaced.host.name)(PORT = 1521))
    (CONNECT_DATA =(SID = rmsusnap))
    ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T14:08:45.173

您应该在连接字符串中使用 RMSUSNAP.WORLD，而不仅仅是“RMSUSNAP”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T18:53:55.637

你检查过[这个问题](https://stackoverflow.com/questions/11366695/how-do-i-use-oracle-from-net)吗？

我上次使用 Oracle 已经很长时间了，但我确实记得至少花了几天时间让它在我的 Windows 7 x64 机器上正常工作。

我记得改变的最后一件事是环境变量（ORA_HOME，如果我没记错的话）指向正确的文件夹（在我的例子中是 x64）。

很抱歉，我不记得更多（将尝试搜索任何笔记），但我提到的链接可能会让你走上正确的道路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-03T21:20:15.017

当我遇到（曾经）相同的问题和错误时...确保您的 sqlnet.ora 文件没有将其他连接信息添加到存储在 TNSNAMES.ora 文件中的连接之前。通常，我们只是删除 sqlnet.ora 文件或重命名为其他文件（sqlnet.ora.org）。一旦此文件不再向连接字符串添加其他信息，blammo，一切都会正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-21T19:09:09.823

刚遇到这个问题：进入 IIS 并在 下查找 Web 应用程序`Sites`，然后单击 Web 应用程序并单击`SSL Settings`。在客户端证书下单击`Accept`单选按钮并应用。

# maven - 以编程方式查找 Maven/Ivy 位置以将 Ant 转换为 Ivy

> ID：14486637
> 
> 赞同：0
> 
> 时间：2013-01-23T18:21:37.727
> 
> 标签：maven, ivy

我正在将现有的 ant 构建转换为使用 ivy。我有我们所有库的名称和版本号，现在我只需要获取每个库的 maven/ivy 位置信息。我可以手动完成，但是我们使用了很多库，我没有时间将它们全部查找。是否有程序或脚本可以自动查找这些依赖项？

实际上，我有 jar 名称和版本号，通常还有工件 ID。我只需要查找组 ID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:40:47.697

签出以下 groovy 脚本：

*   [https://github.com/myspotontheweb/ant2ivy](https://github.com/myspotontheweb/ant2ivy)

In 使用文件校验和来发现 jar 的 Maven 坐标。（校验和比文件名更可靠）

代码并不完美（请随意贡献补丁），但我已经使用它成功地将 ivy 引入到大型遗留 ANT 项目中。

# windows-8 - Windows 8 项目背景（Javascript）

> ID：14486643
> 
> 赞同：1
> 
> 时间：2013-01-23T18:22:01.503
> 
> 标签：windows-8, windows-store-apps, winjs

我正在使用 Javascript 模板使用 Visual Studio 制作 Windows 8 应用程序。

使用 backgroundImage: : "images/breeds/sheep.jpg" 为我的一个项目设置背景图像似乎不起作用。

```
{ group: sampleGroups[0], title: "Item Title: 5", subtitle: "", description: itemDescription, content: itemContent, backgroundImage: : "images/breeds/sheep.jpg"} 
```

图像的位置相对于文件的根目录，因为我假设应用程序从 default.html 运行。

图像显示为断开的链接。关于我在这里做错了什么的任何想法？

更新：注意到以下错误

```
The app couldn’t resolve ms-appx://8a32c4d0-abb1-413b-8989-339848463d6c/images/breeds/Berrichon_Du_Cher.jpg because of this error: RESOURCE_NOT_FOUND 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:43:24.290

尝试使用`ms-appx`指定本地文件的协议。在您的示例中，您可以将图像路径更改为`"ms-appx:///images/breeds/sheep.jpg"`. [您可以在此 MSDN 文档](http://msdn.microsoft.com/en-us/library/windows/apps/hh781215.aspx)中获得有关可用于文件访问的协议的更多信息。

或者，您可以在路径前放一个 / 以确保它是从项目的根目录中解析的。IE，`"/images/breeds/sheep.jpg"`

# dojo - 使用 dgrid 进行多列排序

> ID：14486648
> 
> 赞同：7
> 
> 时间：2013-01-23T18:22:23.567
> 
> 标签：dojo, dgrid

如何更改默认行为，`grid.js::_setSort()`以便在排序所涉及的所有列的标题中正确显示排序条件（向上/向下箭头）？目前，`_setSort()`仅处理传递给的数组的第一列`grid.set("sort")`。例如，使用以下命令设置排序条件后，只有 col1 的标题会包含一个箭头（本例中为向上箭头）。

```
grid.set("sort", [{attribute: col1, descending: false}, {attribute: col2, descending: true}]); 
```

我可以覆盖`_setSort()`，但下划线告诉我这是一个私有函数......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-23T19:08:19.347

下划线只是意味着该函数应该被*视为*私有的，但这并不意味着您*不能*覆盖它。我会用你的超越方法前进并繁荣昌盛。:)

# c++ - 类类型的转换运算符？

> ID：14486650
> 
> 赞同：0
> 
> 时间：2013-01-23T18:22:38.760
> 
> 标签：c++, casting, c++11, operator-overloading, operator-keyword

对于算术类型`T`，可以有一个包含转换运算符的类：

```
template <typename T>
class Value
{
    constexpr operator T() const;
}; 
```

这`operator`是否适用于所有类型（例如，它是否适用于？）如果不是，它适用`T = std::vector<double>`于哪些类型*？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:47:29.440

类型就是一种类型：使用内置类型可以做的事情很少，而不是使用适当定义的用户定义类型。在这种情况下，唯一真正的要求是类型是可复制的（并且您有某种方式在实现中构造它）。

顺便说一句，我认为你的意思是：

```
class Value
{
    template <typename T>
    constexpr operator T() const;
}; 
```

`const`（除了对于很多类型，它不会真正用作 a`constexpr`或 no）。

# php - 显示头部搜索结果及其子结果

> ID：14486652
> 
> 赞同：1
> 
> 时间：2013-01-23T18:22:41.657
> 
> 标签：php, mysql

我正在使用 php 和 mysql 开发一个 web 应用程序。我试图在哪里显示搜索结果如下：

```
----------------------------------------------------------
: Model1      Diescription      Price                    :
:       => Model1-Version1     Discription   Price   :
:       => Model1-Version2     Discription   Price   :
:       => Model1-Version3     Discription   Price   :
..........................................................
: Model2      Diescription      Price                    :
:       => Model2-Version1     Discription   Price   :
:       => Model2-Version2     Discription   Price   :
:       => Model2-Version3     Discription   Price   : 
.......................................................... 
```

我是这个领域的初学者，所以我不知道它叫什么。

假设我有表（t）：

```
------+------+-------+---------+-------+-------------+
carID : make : model : version : price : discription :
------+------+-------+---------+-------+-------------+
1     : BMW  : XX1   : v1      :2345235: Best Car    :
------+------+-------+---------+-------+-------------+
2     : BMW  : XX1   : v2      :33235  : Good Car    :
------+------+-------+---------+-------+-------------+
3     : Audi  : p1   : vp1      :2345  : Best Car    :
------+------+-------+---------+-------+-------------+ 
```

搜索查询：

*   `SELECT carID FROM t WHERE price>=2000;`
*   让我们考虑所有汽车都已被选中。请建议我一种方法来完成它。

在我的研究中，我发现了这个网站，使用相同的搜索显示。[在这里](http://www.gaadi.com//new_car_research.php?minprice=4000000&maxprice=4500000)可能会有所帮助

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:37:42.510

我不太明白你的问题......你只想显示数据吗？

看到这个...

```
$query  = 'SELECT carID FROM t WHERE price>=2000';
$result = mysql_query($query) or die('Error: ' . mysql_error());

echo ('<table width="200" border="1">
       <tr>
         <td>carID</td>
         <td>make</td>
         <td>model</td>
         <td>version</td>
         <td>price</td>
         <td>discription</td>
       </tr>');

while ($row = mysql_fetch_assoc($result)) {

echo('<tr>
        <td>' . $row['carID'] . '</td>
        <td>' . $row['make'] . '</td>
        <td>' . $row['model'] . '</td>
        <td>' . $row['version'] . '</td>
        <td>' . $row['price'] . '</td>
        <td>' . $row['discription'] . '</td>
      </tr>');
}

echo('</table>'); 
```

# perl - Perl 脚本在 Mac 上不起作用

> ID：14486654
> 
> 赞同：0
> 
> 时间：2013-01-23T18:22:49.353
> 
> 标签：perl, file-copying, network-share

我在 Perl 中编写了一个脚本来将图像移动到在 PC 上运行良好的网络共享驱动器。当我尝试在 Mac 上运行它时，我得到的只是错误消息。我无法弄清楚是什么导致了问题。脚本无法在 Mac 上运行是否有原因？我正在使用 File::Copy 和 File::Find 来移动这些文件。

这是我收到的错误消息：

复制失败：“脚本位置”第 14 行没有这样的文件或目录。

任何帮助都会很棒。谢谢。:)

```
 use File::Copy;
 use File::Find;
 my @source = qw (source/location);
 my $target   = q{//share/drive/location};

 while (1)
 { sleep (10);
   find(
    sub {
     if (-f) {
       print "$File::Find::name -> $target";
       copy($File::Find::name, $target)
       or die(q{copy failed:} . $!);

       }
        },
     @source
   ); 

  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:25:32.337

您没有提供任何代码，所以我不得不猜测，但我会说您正在复制的文件或您复制到的目录不存在。

你可能在第 14 行有这样的代码。

```
copy($src, $dest) or die "copy failed:$!"; 
```

如果您放入错误消息`$src`，它将帮助您调试程序。`$dest`

```
copy($src, $dest) or die "copying $src to $dest failed: $!"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:21:09.280

您`//share/drive/location`在 Mac 上无效。这就是你收到 `no such file or directory`消息的原因。

您可以通过尝试`cd`访问该路径在终端窗口中对此进行测试。

该位置需要安装在您的 Mac 上，以便您有一个有效的路径。

这可以在您的[Finder](http://www.howtogeek.com/howto/21600/mount-a-windows-share-in-os-x-and-have-it-reconnect-at-login/)中完成，如果您有更新版本的 OSX，则可以通过[mount_smbfs命令完成。](https://support.apple.com/kb/HT4829)

完成后，您将拥有可以写入的路径，例如`/mnt/some/path`.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-23T18:25:27.057

Seems like the error explains it all:

```
copy failed:No such file or directory at "location of the script" line 14. 
```

Is "location of the script" an uncommented comment? It seems like your Perl parser is trying parse a value or variable dubbed "location of the script"

# windows-8 - 带有 MessageWebSocket 的 Windows 8 现代/地铁应用程序的 Socket.IO 文档

> ID：14486655
> 
> 赞同：2
> 
> 时间：2013-01-23T18:22:49.360
> 
> 标签：windows-8, c++11, websocket, socket.io, c++-cx

关于[我之前提出的问题](https://stackoverflow.com/questions/14468894/windows-8-messagewebsocket-http-request-garbage)，我正在构建一个 Windows 8 c++ 应用程序，该应用程序需要我连接到运行 socket.io 的 Node.js 服务器。

socket.io 是否在 websockets 之上使用任何类型的特殊协议？当我只是进行干式连接时，我收到一个错误“HTTP Invalid Response”。

我看到了许多 c++ websocket 实现，但我很难将这些概念转换为 Windows 8 websocket 实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-08T17:40:08.897

检查 Windows 商店应用程序的此实现，它是 socket.io 的 .Net 客户端的 WinRT (C#) 的端口。

[https://socketio4winrt.codeplex.com/](https://socketio4winrt.codeplex.com/)

# java - 如何在 Java Sockets 中第二次写入对象时停止获取流损坏异常

> ID：14486661
> 
> 赞同：1
> 
> 时间：2013-01-23T18:23:23.447
> 
> 标签：java, sockets, exception, stream

当我`streamCorruptedException`尝试从服务器获取对象时，我在客户端得到了一个。

起初，当客户端连接到服务器时它运行良好，但是当我尝试连接第二个客户端或第二次运行时，出现错误。我也尝试在服务器端重置流，但没有奏效。 **编辑：**

以下是我的**服务器**代码：

```
 Socket clientSocket=null;
            BufferedReader rdr=null;
            ObjectOutputStream objwriter=null;
            String name="";
            audioReceiver = new TAudioReceiver(ser);
            videoReceiver = new TVideoReceiver(ser);
            fileReceiver = new TFileReceiver(ser);
            //audioReceiver.start();
            //videoReceiver.start();
            //fileReceiver.start();
            InputStream cliIn=null;
            OutputStream cliOut = null;
            ClientDetails client=null;

            while(true)
            {
                objwriter=null;
                clientSocket = ser.MainSocket().accept();
                cliIn = clientSocket.getInputStream();
                cliOut = clientSocket.getOutputStream();
                client = new ClientDetails(clientSocket);
                rdr= new BufferedReader( new InputStreamReader(cliIn));
                name = rdr.readLine();
                System.out.println("Client connected '"+ name +"'");

                boolean a = ser.clientsMainSockets.AddClient(name, client);
                if(a){
                    ser.clientsNames = ser.clientsMainSockets.ClientNames();

                    wr = new BufferedWriter(new OutputStreamWriter(cliOut));
                    wr.write("OKM");
                    wr.write('\n');
                    wr.flush();
                    objwriter = new ObjectOutputStream(cliOut);
                    //Thread.sleep(1000);
                    objwriter.writeObject(ser.clientsNames);
                    objwriter.flush();
                    clientSocket =null;
                    cliIn = null;
                    cliOut = null;

                    client = ser.clientsMainSockets.Value(name);

                    TMessageHandler msghdl = new TMessageHandler(ser, client.InputStream() , client.OutputStream(), name);
                    clientHandler.add(msghdl);
                    msghdl.start();
                    System.out.println("Starting process for client");
                    objwriter.reset();
                    Thread.sleep(5000);
                }
                else{

                        wr = new BufferedWriter(new OutputStreamWriter(cliOut));
                        wr.write("ERROR");
                        wr.write('\n');
                        wr.flush();
                }

            }
    }
    catch(Exception ex)
    {
    } 
```

以下是**客户端**代码：

```
 mainSock = new Socket(serverIp,serMainPort);
            serOut = mainSock.getOutputStream();
            serIn = mainSock.getInputStream();
            buffWr= new BufferedWriter(new OutputStreamWriter(serOut));
            //serOut = mainSock.getOutputStream();
            //serIn = mainSock.getInputStream();
            buffWr.write(myName);
            buffWr.write('\n');
            buffWr.flush();
            buffRdr = new BufferedReader(new InputStreamReader(serIn));
            String per="";
            per = buffRdr.readLine();
            System.out.println(per);
            if(per.equals("OKM"))
            {

                objin = new ObjectInputStream(serIn);
                ClientsName = (String[])objin.readObject();
                System.out.println("Client no.'"+ ClientsName.length );
                msgHandler = new TMainHandler(this, serOut, serIn);
                msgHandler.start();
            }
            else {
                throw new Exception("User Already exisits. Choose Another name.");
            }
        }
        catch(Exception ex)
        {
            throw new Exception(ex.getMessage());
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:29:36.200

你不应该混合文本和二进制流，因为这通常会导致混淆，除非你真的知道你在做什么。

我建议您在流的生命周期中包装一次，`mainSock.getInputStream()`并且*只*使用它。即不要多次调用它。`mainSocket.getOutputStream()`

# android - 在android中处理屏幕旋转的更好方法

> ID：14486664
> 
> 赞同：1
> 
> 时间：2013-01-23T18:23:35.900
> 
> 标签：android, android-manifest, android-spinner, android-screen

对于屏幕旋转，我在清单文件中实现了属性 android:ConfigChanges="orientation|screenSize"。一切正常。但是这里的这个[链接](http://developer.android.com/guide/topics/resources/runtime-changes.html#HandlingTheChange)建议将这种方法视为最后的手段，而不是推荐的方法。处理此屏幕旋转的更好方法是什么？（仅供参考：我的应用程序实现了多个微调器以从用户那里获取信息，然后写入文件。所以默认情况下，当屏幕旋转发生时，我会丢失用户选择的所有信息）请帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:29:39.653

> 处理此屏幕旋转的更好方法是什么？

删除该属性。

如果您发现需要将信息从旧的活动实例传递到新的活动实例，在配置更改时，您可以将数据放入`Bundle`您传入的数据中`onSaveInstanceState()`，并使用该数据`onRestoreInstanceState()`来定制您的 UI。在 a 的情况下`Spinner`，您可以通过这种方式传递所选位置，将其恢复到新活动中。

# machine-learning - 使用情感字典值作为 SVM 中的特征

> ID：14486665
> 
> 赞同：0
> 
> 时间：2013-01-23T18:23:37.003
> 
> 标签：machine-learning, classification, svm, information-retrieval, sentiment-analysis

我有一个包含积极和消极词的情感词典以及它们的情感强度值。我的主要工作是检查这个强度值是否对最终分类有影响。这意味着我想检查带有单词“good”（强度= 6）的文本和带有出色（强度= 9）的单词是否具有不同的最终情绪得分。

我在为`SVM`. 如果我使用`TF-IDF`测量或`POS tagging`它不检查强度值。所以我的主要问题是如何在 SVM 中使用这个强度值以及如何生成包含单词强度值的特征向量？

例如，

```
"This book is good." 
```

对于这句话，如何生成考虑强度值的特征向量？

*   首先，我想将强度值与词频相乘并将这个加权分数用作特征输入，但这只会增加词频。例如“good”出现了 2 次，然后我将它乘以它的强度值 6，然后它的值变成 12，所以它只会增加单词“good”的出现，对吗？

*   所以请谁能告诉我是否可以使用情绪强度值`SVM`以及如何使用它？

*   如何使用它们的值生成特征向量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T05:27:47.927

只是一些建议：

## 构建一个词汇表

该词汇表用作字典。您不会将字典中不存在的任何单词包含到您的特征向量中。假设您的字典包含 5000 个单词。

## 为词汇表中的每个单词准备情感强度

当然，您可以为那些您不知道其情感强度的单词设置一些默认值。

## 为要分类的每个文本构建特征向量

对于任何给定的文本，例如，

```
This book is good. 
```

构造一个 5000 维的特征向量。每个维度对应于它的 Tf-Idf 分数，或者只是一个单词在字典中出现的次数。假设在你的字典中，你有

```
strength(book) = 0.01
strength(good) = 6.0, 
```

并且您没有`this`or的条目`is`。然后你最终会得到一个包含 5000 个元素的向量（我在下面的示例中使用出现次数而不是 Tf-Idf。随意以类似的方式尝试 Tf-Idf）。

```
 book,good
[0,0,0, ..., 1,1,0,0,....,0] 
```

`book`除了与和对应的两个元素外，所有元素都是零`good`。插入你的情绪强度，你会得到：

```
 book,good
[0,0,0, ...,0.01,6.0,0,0,....,0] 
```

将强度值乘以出现次数可能会增加或减少相应元素的值。这很好，因为您确实希望通过其情绪强度来增强或削弱组件的贡献。

## 训练 SVM

当为每个特征向量提供目标值或类标签时，您现在可以训练您的 SVM。

希望他们有所帮助。

# c# - 在 ASP.NET Web API 上抑制具有空值的属性

> ID：14486667
> 
> 赞同：100
> 
> 时间：2013-01-23T18:23:40.133
> 
> 标签：c#, asp.net-web-api

我创建了一个将由移动应用程序使用的 ASP.Net WEB API 项目。我需要响应 json 来省略 null 属性，而不是将它们作为`property: null`.

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2013-01-23T18:25:49.750

在`WebApiConfig`：

```
config.Formatters.JsonFormatter.SerializerSettings = 
                 new JsonSerializerSettings {NullValueHandling = NullValueHandling.Ignore}; 
```

或者，如果您想要更多控制，您可以替换整个格式化程序：

```
var jsonformatter = new JsonMediaTypeFormatter
{
    SerializerSettings =
    {
        NullValueHandling = NullValueHandling.Ignore
    }
};

config.Formatters.RemoveAt(0);
config.Formatters.Insert(0, jsonformatter); 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2015-10-16T09:44:22.980

我最终使用 ASP.NET5 1.0.0-beta7 在 startup.cs 文件中得到了这段代码

```
services.AddMvc().AddJsonOptions(options =>
{
    options.SerializerSettings.NullValueHandling = NullValueHandling.Ignore;
}); 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2019-11-15T15:43:50.923

对于 ASP.NET Core 3.0，代码中的`ConfigureServices()`方法`Startup.cs`应包含：

```
services.AddControllers()
    .AddJsonOptions(options =>
    {
        options.JsonSerializerOptions.IgnoreNullValues = true;
    }); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-09-26T09:30:25.900

您还可以使用`[DataContract]`和`[DataMember(EmitDefaultValue=false)]`属性

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-04-22T13:01:31.133

如果您使用 vnext，在 vnext web api 项目中，将此代码添加到 startup.cs 文件。

```
 public void ConfigureServices(IServiceCollection services)
    {
        services.AddMvc().Configure<MvcOptions>(options =>
        {
            int position = options.OutputFormatters.FindIndex(f =>  f.Instance is JsonOutputFormatter);

            var settings = new JsonSerializerSettings()
            {
                NullValueHandling = NullValueHandling.Ignore
            };

            var formatter = new JsonOutputFormatter();
            formatter.SerializerSettings = settings;

            options.OutputFormatters.Insert(position, formatter);
        });

    } 
```

# mysql - 使用 sql DISTINCT 获取唯一行的列表

> ID：14486672
> 
> 赞同：2
> 
> 时间：2013-01-23T18:24:09.363
> 
> 标签：mysql, sql, group-by, distinct

鉴于下表，我试图从 carCode 列中选择具有唯一电子邮件地址的所有条目。对此的 SQL 选择语句是什么？我尝试了以下方法，但它似乎不起作用：

```
SELECT DISTINCT carCode, emailAddress, COUNT( * ) AS count
FROM myTable
WHERE (
carCode != ''
)
GROUP BY carCode; 
```

这是表格列：

```
ID | carCode | emailAddress | fName | lName 
```

并给出以下示例：

```
1 | cc001 | a@b.com | fname1| lname1
2 | cc001 | a@b.com | fname2 | lname2
3 | cc001 | b@b.com | fname3 | lname3
4 | cc001 | c@b.com | fname4 | lname4 
```

应该只返回第 1、3 和 4 行或第 2、3 和 4 行，因为 1 和 2 具有相同的代码和电子邮件地址。

请指教。

PS 澄清一下，我正在尝试计算所有汽车代码的实例，但如果为相同的汽车代码找到重复的电子邮件地址，则只计算该电子邮件地址一次。这是否阐明了我想要实现的目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:27:21.937

您需要一个`having`子句来消除第 1 行（它有重复项）：

```
SELECT carCode, emailAddress, 1 as cnt
FROM myTable
WHERE carCode != ''
GROUP BY carCode, emailaddress;
having count(*) = 1 
```

对于您修改后的问题，答案只是一组：

```
SELECT carCode, emailAddress, count(*) as cnt
FROM myTable
WHERE carCode != ''
GROUP BY carCode, emailaddress; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:27:42.827

尝试这个

```
SELECT DISTINCT  emailAddress, carCode,  COUNT( * ) AS count
FROM myTable
WHERE (
carCode != ''
)
GROUP BY carCode; 
```

干杯:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:27:51.243

将 emailAddress 添加到 GROUP BY，删除 DISTINCT：

```
SELECT carCode, emailAddress, COUNT( * ) AS count
FROM myTable
WHERE carCode != ''
GROUP BY carCode, emailAddress; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T18:28:21.483

您实际上根本不需要`DISTINCT`这里，如果您想获取每个不同的汽车代码和电子邮件地址组合的记录数，您只需要按 carCode 和 emailAddress 进行分组。

```
SELECT carCode, emailAddress, count(ID) as `count`
FROM myTable
WHERE carCode <> ''
GROUP BY carCode, emailAddress 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T18:26:22.517

尝试这个...

```
SELECT  carCode, emailAddress, count(*) AS count
FROM myTable
WHERE carCode != ''
GROUP BY carCode, emailAddress 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-23T18:35:40.837

一种简单的方法是使用`LEFT JOIN`; 只返回所有没有具有较低 ID 和相同代码/电子邮件的行的行；

```
SELECT * 
FROM myTable a
LEFT JOIN myTable b
  ON a.emailAddress = b.emailAddress
 AND a.carCode = b.carCode
 AND a.ID > b.id
WHERE b.id IS NULL 
```

[用于测试的 SQLfiddle](http://sqlfiddle.com/#!9/3c19b/2)。

这种方法的优点是您可以获得结果的完整行，如果您真的只需要代码和电子邮件，您应该使用`GROUP BY`许多其他答案的建议。

# android - Android 无法写入具有 URL 的 NFC TAG

> ID：14486676
> 
> 赞同：0
> 
> 时间：2013-01-23T18:24:39.660
> 
> 标签：android, android-intent, nfc, rfid, ndef

我有一个标签，扫描后会打开我购买它的商店的链接。现在，我想用我自己的数据编写它。我有一个表格，我写我想写的东西，当我按下“开始写”按钮时，以下函数运行：

```
private void startWriting() {
    //This variable is actually of class to disable the foreground dispatch when the onPause method is called
    NfcAdapter mAdapter = NfcAdapter.getDefaultAdapter(this);
    changeStatus(false);

    findViewById(R.id.bt_write).setVisibility(View.GONE);
    findViewById(R.id.bt_stop).setVisibility(View.VISIBLE);

    PendingIntent pendingIntent = PendingIntent.getService(this, 0, getServiceIntent(), 0);
    IntentFilter ndef = new IntentFilter(NfcAdapter.ACTION_NDEF_DISCOVERED);

    try {
        ndef.addDataType("*/*"); /*
                                 * Handles all MIME based dispatches.
                                 * You should specify only the ones that you
                                 * need.
                                 */
    } catch (MalformedMimeTypeException e) {
        throw new RuntimeException("fail", e);
    }
    IntentFilter[] intentFiltersArray = new IntentFilter[] { ndef };

    String[][] techListsArray = new String[][] { new String[] { NfcF.class.getName(), MifareClassic.class.getName(), MifareUltralight.class.getName() } };

    mAdapter.enableForegroundDispatch(this, pendingIntent, intentFiltersArray, techListsArray);

} 
```

因此，目标是在找到 TAG 时启动服务。该函数`getServiceIntent()`创建一个意图并将数据作为额外的。它没有什么特别之处。

问题是，即使在运行之后，Android 仍然会启动浏览器而不是写入 TAG。最奇怪的是，如果我首先使用 NFC 任务启动器在 TAG 上写一些东西，那么我可以使用我的应用程序来写它。我的猜测是我缺少一些过滤器来检测标签。

谢谢

# vba - Excel VBA 十进制数字在文本输出中转换为整数

> ID：14486680
> 
> 赞同：1
> 
> 时间：2013-01-23T18:25:06.680
> 
> 标签：vba, text, excel, precision

我有一个电子表格，我编写了一个宏，它使用电子表格中的一些值来输出一个文本文件。一切正常，除了一个问题：

如果我有一个像 15.0 这样的浮点数，它会在输出文本文件中显示为整数 15，不带小数点。如果小数点后的数字不是零，我不会观察到同样的问题，例如，15.1 写为 15.1；那里没问题。

我想知道是否有某种命令或属性会强制将所有数字作为浮点数写入输出文件？

这是我将数字写入文本文件的行。WeightList(i) 和 SpacingList(i) 是字符串数组，用于存储从电子表格中收集的数字。

```
Print #1, Chr(9); "<truck axleW=" & Chr(34) & _
          WeightList(i) & Chr(34) & " axleS=" & _
          Chr(34) & SpacingList(i) & Chr(34) & "></truck>" 
```

谢谢！

编辑：这是将数字转换为字符串的行，我尝试使用 format 命令，但这没有帮助：

```
WeightList(i) = Format("0.0", Truck(i).AxleWeights(i)) 
```

EDIT2：在更改格式命令中的参数顺序后，代码现在可以工作了。有关详细信息，请参阅已接受的答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T18:29:58.583

您可以使用`format(value,"0.0")`转换为具有所需 sig figs 的字符串。

编辑 - 抱歉，订单颠倒了......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:34:13.623

使用情况如何`FormatNumber`

```
FormatNumber(value, 1) 
```

请参阅[http://msdn.microsoft.com/en-us/library/xfta99yt(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/xfta99yt(v=vs.80).aspx)

# android - 应用关闭时的 AlarmManager

> ID：14486684
> 
> 赞同：6
> 
> 时间：2013-01-23T18:25:17.020
> 
> 标签：android, alarmmanager

简单的问题，我想。我用一些警报集实例化了警报管理器。当用户关闭应用程序时会发生什么？

警报响起时，警报管理器是否仍会提醒我？还是警报管理器对象随应用程序一起销毁？

因为有时会发出警报而有时不会发出警报，所以我想知道这是否是问题所在。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T18:31:38.083

警报管理器是一个系统服务，它会在您的应用程序被销毁后继续运行。

警报的精度可能会有所不同，具体取决于您的设置方式。

检查 Logcat 以了解触发警报的情况，但您看不到任何效果。（也许是在后台崩溃？）

编辑： [A--C](https://stackoverflow.com/users/1815485/a-c)是对的。丢失警报的另一个原因可能是所有警报在重新启动时都会被清除。您可以通过设置 BroadcastReceiver 来侦听 boot_completed 意图并重新设置所需的警报来解决此问题。

# authorization - How to set authorization scopes for box?

> ID：14486686
> 
> 赞同：0
> 
> 时间：2013-01-23T18:25:23.897
> 
> 标签：authorization, box-api

Does anyone know how to specify specific authorization scopes for box? My only option seems to be in the OAuth2 parameters section, with one simple check box asking for scope to read and write all files and folders. In the authorization doc it displays different scopes in their screen shot but does not detail how to request them.

Thanks in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:38:35.910

我们目前仅支持整个帐户范围内的单一读/写，但随着时间的推移我们会添加更多。

# javascript - 当我单击“其他”单选按钮时，没有任何反应。为什么？

> ID：14486689
> 
> 赞同：-3
> 
> 时间：2013-01-23T18:25:30.013
> 
> 标签：javascript, jquery

> **可能重复：**
> [使用 javascript 对 html 脚本进行小修改，我无法整理](https://stackoverflow.com/questions/14482174/a-small-modification-needed-in-html-script-using-javascript-i-m-not-able-to-sor)

HTML：

```
<div class="rButtons">
<input type="radio" name="numbers" value="10" onclick="uncheck();" />10
<input type="radio" name="numbers" value="20"  onclick="uncheck();" />20
<input type="radio" name="numbers" value="other" onchange="blahblahblah();"/>other
<input type="text" id="other_field" name="other_field" onblur="checktext(this);"/>
</div> 
```

CSS：

```
<style type="text/css">
#other_field{
visibility: hidden;
width:40px;
height:14px;
border:1px solid #777;
background-color:#111;
font-size:10px;
color:#666;
}
</style> 
```

jQuery：

```
<script>
function blahblahblah()
{
 var $radios = $('input:radio[name=numbers]');
    if ($radios.is(':checked') === true) {
       $("#other_field").show();
    }     
    else
    {
       $("#other_field").hide();
    }   
}
</script> 
```

一切都很好..但问题是这个..当我点击“其他”单选按钮时没有任何反应..虽然它应该打开其他字段。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:31:10.120

```
if ($('input[name=numbers]:checked').val() === 'other') {
    // show hidden field
} 
```

这将找到任何一个单选按钮`checked`，并检查其值为“其他”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:41:08.150

如果`blahblahblah`仅被`other`单选按钮调用，则无需担心您编写的大部分逻辑。尝试通过 jQuery 专门将处理程序绑定到`other`单选按钮。

HTML：

```
<input type="radio" id="otherRadio" name="numbers" value="other"/>other 
```

JS：

```
$('#otherRadio').on('change', function () {
    if (this.checked) {
        $("#other_field").show();
    } else {
        $("#other_field").hide();
    }
}); 
```

如果由于某种原因您无法将 ID 添加到标记中，您可以在其位置使用不同的选择器，例如`$('input[type="radio"]:contains("other")');`

# c# - Window 8 App Store 长时间运行过程

> ID：14486692
> 
> 赞同：1
> 
> 时间：2013-01-23T18:25:40.240
> 
> 标签：c#, windows-8, winrt-xaml, windows-store-apps

我有一个 Web 服务，它将从存储在 Azure 中的数据库中返回大约 360 个条目。在我的`ModelView`我做一个异步调用来检索数据，但在`ModelView`异步调用完成之前执行的绑定。

`ModelView`在我继续绑定到我的视图之前，有没有办法“等待”异步完成`DataContext`，类似于等待？

```
// ModelView code

ServerSideModel.ProAmService.EntityServiceClient serviceClient = new ServerSideModel.ProAmService.EntityServiceClient();
serviceClient.GetPlayersPreviewCompleted += serviceClient_GetPlayersPreviewCompleted;
serviceClient.GetPlayersPreviewAsync(3); 
```

在 ModelView 的构造函数中调用 Get。

```
// View code

this.DataContext = _viewModel; 
```

在视图的构造函数中调用。

就像我说的那样，`this.DataContext = _viewModel`调用了 get 行并且异步函数在不返回任何数据的情况下触发。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T19:30:04.600

你敢打赌，在我看来你可能不知道 ObservableCollection，一个内置 XAML 感知事件的通用列表。在向此类列表添加或删除时，XAML UI 会自动反映更改。很美丽。像这样使用它：

```
// pretend your service returns this
class MyItem { public string Name { get; set; } }

// this is a property in your view model, bind your gridview to it
public ObservableCollection<MyItem> Items { get; set; }

// call this to load, it will continue to populate the UI until it is done
async System.Threading.Tasks.Task LoadAsync()
{
    var _Results = await GetItemsAsync();
    foreach (var item in _Results.OrderBy(x => x.Name))
        this.Items.Add(item);
} 
```

XAML 开发的经验法则是任何类型的列表都应该升级为 ObservableCollection，以便它可以轻松正确地绑定。

> 在此处阅读 ObservableCollections：http: [//msdn.microsoft.com/en-us/library/ms668604.aspx](http://msdn.microsoft.com/en-us/library/ms668604.aspx)在此处 阅读有关 XAML 绑定的更多信息：http: [//blog.jerrynixon.com/2012/10/xaml-binding-basics -101.html](http://blog.jerrynixon.com/2012/10/xaml-binding-basics-101.html)

# python - 使用 celery 任务创建新进程

> ID：14486696
> 
> 赞同：2
> 
> 时间：2013-01-23T18:25:50.387
> 
> 标签：python, daemon, celery

在 Celery 中，最终重新加载模块的唯一方法是重新启动所有 celery 进程。我知道如何远程关闭工作人员（`broadcast('shutdown', destination = [<workers>])`），但不知道如何让他们恢复。

我有一段 Python 代码可以用来创建一个包含新工作者的守护进程，但是当我尝试在 Celery 中将它作为 celery 任务运行时，我得到了`AssertionError: daemonic processes are not allowed to have children`，我猜这与工人池已建立。

1.  有没有办法以某种方式覆盖芹菜中的这个错误？
2.  如果没有，是否有另一种方法可以让 Celery 启动另一个工人来代替自己？也许将整个事情包装在一个 bash 脚本中（尽管在 Python 中这样做的目的是避免使用 Python 调用 bash 来调用 Python）。
3.  如果没有，还有其他方法可以说服 Celery 重新加载最新版本的代码吗？旗帜`--autoreload`，`broadcast('pool_restart')`两者都不做。

示例行为：

1.  创造：

    @task def add(x,y): 返回 x+y

2.  加载 celery，运行 add.delay(4,4)，返回 8。

3.  更改添加到：

    @task def add(x,y): 返回 x*y

4.  做魔术（目前是“重启芹菜”）

5.  再次运行 add.delay(4,4)

你应该回到 16。我总是回到 8，除非我关闭 celery 并重新加载它，如果没有办法从远程机器上调出工作进程，我就无法远程完成，最好是使用脚本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T03:14:36.967

在主管下运行 Celery 守护进程，例如 supervisord。当 celeryd 进程终止时，主管将把它重新启动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T02:39:47.620

如果您使用的是 Flask，则可以在带有子进程的 shell 中的另一个进程中打开 celery，并使用 Werkzeug 重新加载器重新启动文件：

```
if __name__ == "__main__":
    celery.control.broadcast("shutdown") # Kill the previous workers
    import subprocess
    subprocess.Popen("celery worker", shell=True) # Or celeryd
    app.run(use_reloader=True) # From Flask/Werkzeug 
```

您不妨`debug=True`在 Flask/Werkzeug 中使用重新加载器（不是在生产服务器中执行的操作）。您还可以使用[watchdog](https://pypi.python.org/pypi/watchdog)包监视更改。这在某种程度上是蛮力......但有效。

# extjs4 - Ext.ComponentQuery JSP ID 查找

> ID：14486698
> 
> 赞同：2
> 
> 时间：2013-01-23T18:25:52.657
> 
> 标签：extjs4

我有一个面板，我可以使用以下方法很好地查找这个面板：

```
Ext.ComponentQuery.query('banner'); 
```

这将返回当前组件。此面板使用加载器并将 jsp 页面加载到其中。我可以使用 Ext.ComponentQuery.query 来查找吗？我试过了 ：

```
Ext.ComponentQuery.query('banner > #myId'); 
```

但它没有找到它我猜它无法查找不基于 EXT 的组件？

然后我尝试了：

```
Ext.dom.Query.select('myId'); 
```

这有效，我得到了 HtmlElement 回来。但不知道 Ext.ComponentQuery 是否也能找到？

我想要做的是将 onclick 事件侦听器添加到我的 Ext.Controller 可以侦听的 HTMLElement。当我使用 Ext.dom.Query.select('myId'); 我尝试如下添加一个侦听器，但它不起作用，它说 attachEvent 不是一个函数。

```
 el.attachEvent('onclick', function(){alert('hello!!!!')}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:41:13.227

所以我能够使用如下附加它

```
 var el = Ext.dom.Query.select('myId'); 
```

然后按如下方式添加。

```
 el.onclick=function(){alert('hello');}. 
```

我只是希望使用 Ext.ComponentQuery.query，但你不能这样做是有道理的，而且它只适用于 EXT 组件。但我最终得到了相同的结果。

# ruby-on-rails - 设计：如何将登录表单移至您的主页？

> ID：14486699
> 
> 赞同：0
> 
> 时间：2013-01-23T18:25:52.937
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, erb

在我的 views/devise/sessions/new.erb.html 文件中，我有以下行

```
> <%= form_for(resource, :as => resource_name, :url =>
> session_path(resource_name), :html => { :class => "form-horizontal
> well"}) do |f| %> 
```

这很好用，但是如果我尝试将此表单放在我的主页上，我会收到错误消息...

```
undefined local variable or method `resource' for #<#<Class:0x2950e78>:0x563118> 
```

我需要做什么才能使它正常工作？或者是否有关于此的[设计](https://github.com/plataformatec/devise)文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:32:50.787

Devise 对其身份验证的对象采取了一种不可知论的方法，它`resource`只是您使用`devise_for`路由文件中定义的映射的代理。也就是说，如果您已经知道资源的名称，您可以手动指定它，例如：

```
<%= form_for("user", :url => user_session_path, :html => { :class => "form-horizontal well"}) do |f|%> 
```

或者，您可以简单地在控制器内部定义相应的`resource`和`resource_name`方法，如您链接的文档中所示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T21:58:07.927

您还可以将 Devise 辅助方法添加到您的 controller_helper.rb。对于家庭控制器，我相信它是 application_helper.rb。

一个例子是[here](https://stackoverflow.com/questions/10463874/how-to-expose-resource-in-devise-to-another-controller)

# sql-server - 总工作时间

> ID：14486701
> 
> 赞同：0
> 
> 时间：2013-01-23T18:26:00.467
> 
> 标签：sql-server

我有一个问题表，用户可以在其中记录工作时间并估计看起来像这样的时间

```
id |  assignee  |  task   |   timespent  |  original_estimate | date
--------------------------------------------------------------------------
1  |  john      |  design |   2          |  3                 | 2013-01-01
2  |  john      |  mockup |   2          |  3                 | 2013-01-02
3  |  john      |  design |   2          |  3                 | 2013-01-01
4  |  rick      |  mockup |   5          |  4                 | 2013-01-04 
```

我需要按任务和日期对工作时间和估计时间进行汇总和分组才能得到这个

```
assignee  |  task   | total_spent   | total_estimate  |  date
------------------------------------------------------------------
john      |  design | 4             | 6               | 2013-01-01
john      |  mockup | 2             | 3               | 2013-01-02
rick      |  design | 5             | 4               | 2013-01-04 
```

好的，这很容易，我已经有了这个：

`SELECT assignee, task, SUM(timespent) as total_spent, SUM(original_estimate) AS total_estimate, date FROM issues GROUP BY assignee, task, date`

我的问题是我还需要显示当天没有记录任何任务时间的受让人，我的意思是：

```
assignee  |  task   | total_spent   | total_estimate  |  date
------------------------------------------------------------------
john      |  design | 4             | 6               | 2013-01-01
john      |  mockup | 2             | 3               | 2013-01-02
rick      |  design | 5             | 4               | 2013-01-04
pete      |  design | 0             | 0               | 2013-01-01
pete      |  mockup | 0             | 0               | 2013-01-02
liz       |  design | 0             | 0               | 2013-01-04
liz       |  mockup | 0             | 0               | 2013-01-04 
```

目标是绘制这样的图表[http://jsfiddle.net/uUjst/embedded/result/](http://jsfiddle.net/uUjst/embedded/result/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:33:07.160

您需要在他们自己的单独表中加入受让人。

```
SELECT  tblAssignee.Name, task, SUM(timespent) as total_spent, SUM(original_estimate) AS   total_estimate, date 
FROM tblAssignee
    LEFT JOIN issue ON issues.assignee = tblAssignee.Name
GROUP BY tblAssignee.Name, task, date 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:34:50.150

假设您有一个`user`表，但没有一个`tasks`or`dates`表......这意味着我们必须从存在的值中得出这些值`issues`：

```
;WITH dates AS (
    SELECT DISTINCT date
    FROM issues
), tasks AS (
    SELECT DISTINCT task
    FROM issues
)
SELECT 
    u.user as assignee, 
    t.task, 
    SUM(i.timespent) as total_spent, 
    SUM(i.original_estimate) AS total_estimate, 
    d.date 
FROM 
    users u CROSS JOIN
    dates d CROSS JOIN
    tasks t LEFT OUTER JOIN
    issues i ON
        i.assignee = u.user
        AND i.task = t.task
        AND i.date = d.date
GROUP BY u.user, t.task, d.date 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:39:14.453

```
SELECT
   A.name,
   task,
    ISNULL(SUM(timespent), 0) as total_spent,
    ISNULL(SUM(original_estimate), 0) AS total_estimate,
    date
FROM Assignee A
    LEFT JOIN issue
        ON issues.assignee = A.Name
GROUP BY A.name, task, date 
```

# javascript - HTML5 应用程序缓存错误事件详细信息

> ID：14486702
> 
> 赞同：4
> 
> 时间：2013-01-23T18:26:03.587
> 
> 标签：javascript, html, google-chrome, application-cache

我有一个 HTML5 离线应用程序，有时用户会遇到缓存错误，我使用事件侦听器处理这些错误并显示一般错误消息。

为了帮助调试这些，我还想显示和记录错误详细信息（如 Chrome 控制台中所示），例如失败的获取。我还没有找到通过 Javascript 获取详细信息的方法。这目前可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-30T18:51:55.633

大概是这样的：

```
var appCache = window.applicationCache;
    function handleCacheError(e){
          console.log(e);
    }
    appCache.addEventListener('error', handleCacheError, false); 
```

然后您应该将错误记录到 Chrome 控制台中。

# c# - ASP.NET 中继器控制复选框问题

> ID：14486704
> 
> 赞同：3
> 
> 时间：2013-01-23T18:26:07.687
> 
> 标签：c#, asp.net, repeater

概述：单击中继器控件中第一个 CheckBox 的*文本会单击**最后一个*。我知道为什么会这样；`label`标签与元素 id的关联，`chkMarkedForDeletion`当单击该标签时，它会选择最后一个 CheckBox，因为所有 CheckBox 都具有相同的 ID .. 该死的转发器控件！我想知道是否有任何方法可以避免这种情况？简单的方法是创建单独的标签并正确关联到每个 CheckBox，但这会破坏 CheckBox 的假定默认行为。

中继器代码：

```
<asp:Repeater ID="childNodesDataRepeater" runat="server">
    <ItemTemplate>
        <table style="width: 100%;" cellpadding="0" cellspacing="0" border="0">
            <tr>
                <td style="width: 200px;">
                    <asp:CheckBox ID="chkMarkedForDeletion" runat="server" EnableViewState="true" Text="Remove"
                        Checked='<%# DataBinder.Eval(Container.DataItem, "IsMarkedForDeletion") %>' />
                </td>
                <td>
                    &nbsp;
                </td>
                <td style="width: 200px;">
                    <asp:CheckBox ID="chkHighImpactCause" runat="server" EnableViewState="true" Text="High Impact Cause"
                        Checked='<%# DataBinder.Eval(Container.DataItem, "IsHighPriority") %>' />
                </td>
            </tr>
            <tr>
                <td colspan="3">
                    <asp:Label ID="header002" runat="server" Text="What caused this problem?" />
                </td>
            </tr>
            <tr>
                <td colspan="3">
                    <asp:TextBox ID="txtProblemCausedBy" runat="server" EnableViewState="true" Width="100%"
                        Text='<%# DataBinder.Eval(Container.DataItem, "Description") %>' /><br />
                </td>
            </tr>
            <tr>
                <td colspan="3" style="height: 5px;">
                    <hr />
                    <asp:HiddenField ID="nodeIdentifier" runat="server" EnableViewState="true" Value='<%# DataBinder.Eval(Container.DataItem, "AnalysisID") %>' />
                </td>
            </tr>
        </table>
    </ItemTemplate>
</asp:Repeater> 
```

为 CheckBox 生成的 HTML 代码：

```
<INPUT id=chkMarkedForDeletion type=checkbox name=TabContainer$tabProblemResolution$frmProblemResolution1$childNodesDataRepeater$ctl00$chkMarkedForDeletion>
<LABEL for=chkMarkedForDeletion>Remove</LABEL>
...
...
<INPUT id=chkMarkedForDeletion type=checkbox name=TabContainer$tabProblemResolution$frmProblemResolution1$childNodesDataRepeater$ctl02$chkMarkedForDeletion>
<LABEL for=chkMarkedForDeletion>Remove</LABEL> 
```

问题： ![中继器问题截图](../Images/bc31526903a453f4790f0a447d726703.png)

谢谢，阿比

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T19:18:54.563

确保中继器上的[ClientIDMode](http://msdn.microsoft.com/en-us/library/system.web.ui.clientidmode.aspx)未设置为“静态”。

此设置可从父级继承，一直到 web.config。因此，如果您必须在中继器上显式设置 ClientIDMode，这意味着某些父级将默认（可预测）覆盖为“静态”。

# spring-mvc - java.lang.NullPointerException 当我运行我的单元测试 - 模拟

> ID：14486710
> 
> 赞同：1
> 
> 时间：2013-01-23T18:26:33.540
> 
> 标签：spring-mvc, mockito, spring-test, spring-test-mvc, springmockito

我有一个spring mvc应用程序并使用mockito进行单元测试。运行单元测试时，我不断收到空指针异常。:(

请在下面找到我的单元测试将基于的方法：

```
@Controller
public class LogInController {

    @Autowired
    private MessageSource messageSource;

    @RequestMapping(method = RequestMethod.POST, value = "/login")
    public ModelAndView validateViewLogin(@ModelAttribute Person person,
    BindingResult result, HttpServletRequest request) {
        ModelAndView mav = new ModelAndView();

        String userName = person.getFirstName();
        String password = person.getPassword();
        boolean isUserValid = false;
        if (userName != null && password != null) {
             isUserValid = userManagerService.validateUserLogin(userName,password);
        }
        if (!isUserValid) {
            mav.addObject("failLog",messageSource.getMessage("login.user.fail", new String[] {"  ", "" }, request.getLocale()));
            mav.addObject("isUserValid", false);
            mav.setViewName("login");
            return mav;
        }
        mav.addObject("isUserValid", isUserValid);
        mav.setViewName("home");
        return mav;
    } 
```

请在我的单元测试下面找到：

```
@Test
public void validateViewLogin_NotValidLogin_returnsLoginPage() {
    MockHttpServletRequest request = new MockHttpServletRequest();
    Person person = new Person();
    person.setFirstName("John");
    person.setPassword("123");
    isUserValid = false;
    LogInController controller = new LogInController();

    // Inject mock user service into controller
    UserManagerService mockUserService =   mock(UserManagerService.class);
    controller.setUserManagerService(mockUserService);

    // Configure mock user service to accept the person
    when(mockUserService.validateUserLogin("John", "123")).thenReturn(
            isUserValid);

    // Attempt the validation
    ModelAndView mav = controller
            .validateViewLogin(person, result, request);

    // Check the result
    assertEquals("login", mav.getViewName());
} 
```

当我运行上面的单元测试时，请在下面找到堆栈跟踪错误消息：

```
java.lang.NullPointerException
at com.gemstone.presentation.LogInController.validateViewLogin(LogInController.java:99)
at com.gemstone.presentation.LogInControllerTest.validateViewLogin_NotValidLogin_returnsLoginPage(LogInControllerTest.java:79)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
at org.junit.runners.BlockJUnit4ClassRunner.runNotIgnored(BlockJUnit4ClassRunner.java:79)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:71)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

基本上下面显示的第 99 行根据堆栈跟踪返回 null：

```
mav.addObject(
                "failLog",
                messageSource.getMessage("login.user.fail", new String[] {
                        "  ", "" }, request.getLocale())); 
```

任何想法为什么我在这一行上得到空指针？但是当我运行我的应用程序时它工作正常并且failLog消息显示在我的页面上。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:44:03.833

我的猜测是您的 messageSource 为空。您正在模拟您的请求，但不是您的 messageSource，并且您正在新建登录控制器，它没有被 Spring 注入。

在运行时，它会被 Spring 自动注入。

编辑以澄清：

首先，您需要能够设置一些测试方法。您可以添加一个 setter 或一个构造函数来获取它，例如：

```
@Controller
public class LogInController {

    @Autowired
    private MessageSource messageSource;

    public void setMessageSource(MessageSource ms){
        this.messageSource = ms;
    }
    // ......
} 
```

那么你的测试也需要改变：

```
 @Test
public void validateViewLogin_NotValidLogin_returnsLoginPage() {
    MockHttpServletRequest request = new MockHttpServletRequest();
    Person person = new Person();
    person.setFirstName("John");
    person.setPassword("123");
    isUserValid = false;
    LogInController controller = new LogInController();

    // Inject mock user service into controller
    UserManagerService mockUserService =   mock(UserManagerService.class);

            /** ADDED **/
            MessageSource ms = mock(MessageSource.class);

    controller.setUserManagerService(mockUserService);
            /** ADDED **/
            controller.setMessageSource(ms);

    // Configure mock user service to accept the person
    when(mockUserService.validateUserLogin("John", "123")).thenReturn(
            isUserValid);

            /** ADDED **/
            when(ms.getMessage("login.user.fail", new String[] {"  ", "" }).thenReturn("message");

    // Attempt the validation
    ModelAndView mav = controller
            .validateViewLogin(person, result, request);

    // Check the result
    assertEquals("login", mav.getViewName());
} 
```

随便放这个，所以请确保我没有任何错别字！本质上，您可以像使用 UserManagerService 一样尝试 MessageSource，它毕竟只是一个接口，并且可以以完全相同的方式进行模拟。

# hash - 如何自定义 unordered_map 以使其使用自定义哈希函数和自定义相等函数？

> ID：14486713
> 
> 赞同：0
> 
> 时间：2013-01-23T18:26:51.013
> 
> 标签：hash, unordered-map

如何为无序映射编写自己的哈希和权益运算符，以便可以使用 char * 而不是 std::string 作为键？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:27:24.413

```
class PtrStr
{
    protected:
        const char *m_pcStr;
        const int m_nSize;

    public:
        PtrStr(const char *pcStr, int nSize) : m_pcStr(pcStr), m_nSize(nSize) {}
        ~PtrStr() {};

        const char *GetStr() const { return m_pcStr; }
        const int GetSize() const { return m_nSize; }
};

namespace std
{ 
    namespace tr1
    { 
        template<> struct hash<PtrStr>
        {
            std::size_t operator()(PtrStr const &key) const
            {
                return MyHashMethod(key);
            }
        };
    }

    template<> struct equal_to<PtrStr>
    {
        bool operator()(const PtrStr &keyA, const PtrStr &keyB) const
        {
            return (strcmp(const_cast<PtrStr &>(keyA).GetStr(), const_cast<PtrStr &>(keyB).GetStr()) == 0);
            return (strcmp(keyA.GetStr(), keyB.GetStr()) == 0);
        }
    };
}

typedef std::tr1::unordered_map<PtrStr, int> unorderedCharMap;
typedef std::tr1::unordered_map<PtrStr, int>::iterator unorderedCharMapItr; 
```

# php - preg_match_all 需要 3 个参数？

> ID：14486721
> 
> 赞同：1
> 
> 时间：2013-01-23T18:27:19.613
> 
> 标签：php, regex, preg-match-all

这是我的代码：

```
$myText = "@koraytugaykoray@";
$mypattern = "@k.*y@";
echo "<br />";

preg_match_all($mypattern, $myText); 
```

我正进入（状态：

> 警告：preg_match_all() 至少需要 3 个参数，2 个在 C:\DocumentRoot\Framework\index.php 第 12 行给出

但根据： http: [//php.net/manual/en/function.preg-match-all.php](http://php.net/manual/en/function.preg-match-all.php)，这应该没问题吧？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T18:29:19.333

在 5.4.0 之前的版本中，第三个参数`preg_match_all()`不是可选的：

> 5.4.0 匹配参数变为可选。

[资源](http://php.net/manual/en/function.preg-match-all.php)

# android - Android上下文错误

> ID：14486724
> 
> 赞同：1
> 
> 时间：2013-01-23T18:27:21.963
> 
> 标签：android, android-context

我有以下课程：

```
package com.somedomain.enigma;

import java.io.IOException;
import java.io.UnsupportedEncodingException;
import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;

import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.util.Log;

public class APICall {
    private String DEBUG_TAG = "enigma";

    public void register(Context context, Intent intent) {
        final String URL = "http://somedomain.com:8888/register";

        String registrationId = intent.getStringExtra("registration_id");
        String error = intent.getStringExtra("error");
        String unregistered = intent.getStringExtra("unregistered"); 

        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost(URL);

        // Send a POST to the server to register the device
        if (registrationId != null) {
            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(1);
            nameValuePairs.add(new BasicNameValuePair("registrationId", registrationId));
            try {
                httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
                HttpResponse response = httpclient.execute(httppost);
                int responseCode = response.getStatusLine().getStatusCode();
                if(responseCode == 200) {
                    SharedPreferences settings = context.getPreferences(Context.MODE_PRIVATE);
                    SharedPreferences.Editor editor = settings.edit();
                    editor.putString("registrationId", registrationId);
                    editor.commit();
                    Log.d(DEBUG_TAG, "Device registered successfully");
                } else {
                    Log.d(DEBUG_TAG, "Device registration failed");
                }
            } catch (UnsupportedEncodingException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (ClientProtocolException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }

        if (unregistered != null) {
            // get old registration ID from shared preferences
            // notify 3rd-party server about the unregistered ID
            Log.d(DEBUG_TAG, "Unregister request");
        } 

        if (error != null) {
            if ("SERVICE_NOT_AVAILABLE".equals(error)) {
               // optionally retry using exponential back-off
                Log.d(DEBUG_TAG, "Service not available");
            } else {
                // Unrecoverable error, log it
                Log.d(DEBUG_TAG, "Received error: " + error);
            }
        }
    }
} 
```

我`"The method getPreferences(int) is undefined for the type Context"`在这一行收到错误：

```
SharedPreferences settings = context.getPreferences(Context.MODE_PRIVATE); 
```

我使用`Context context = getApplicationContext();`任何想法从以前的方法传递上下文如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:28:45.700

试试吧

```
SharedPreferences settings = context.getSharedPreferences("MyPreferencesName",Context.MODE_PRIVATE); 
```

直接从[文档](http://developer.android.com/reference/android/content/Context.html#getSharedPreferences%28java.lang.String,%20int%29)中，没有`getPreferences`方法，但是有`getSharedPreferences()`方法。

请注意，如果您使用的是默认 SharedPreferences 文件，[则可以执行](http://developer.android.com/reference/android/preference/PreferenceManager.html#getDefaultSharedPreferences%28android.content.Context%29)

```
SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(context); 
```

**编辑：** [`getSharedPreferences()`](http://developer.android.com/reference/android/app/Activity.html#getPreferences%28int%29)只是`Activity`课程的一部分。这种方法实际上是一种方便的方法。

> 这只是通过传入此活动的类名作为首选项名称来调用底层的 getSharedPreferences(String, int) 方法。

因此，如果您绝对确定这`context`是 Activity 的实例，您可以更改方法声明：

```
public void register(Activity activity, Intent intent) { 
```

或投

```
SharedPreferences settings = ((Activity)context).getPreferences(Context.MODE_PRIVATE); 
```

但是，如果`context`不是Activity**的**实例，您将不得不依赖其他方法来访问 Preferences。

# java - 处理多个布尔组合

> ID：14486725
> 
> 赞同：2
> 
> 时间：2013-01-23T18:27:23.820
> 
> 标签：java, boolean, combinations, boolean-logic

我有 5 个布尔变量 a、b、c、d 和 e。因此，对于每个变量的真假的每种不同组合，都有不同的打印语句。

**比如说：**

abcde --- 打印语句

TTTTT -- 打印全部为真

TTTTF -- 打印一些文本

TTTFF -- 打印一些其他文本

...........

可能有 32 种不同的可能组合。我正在写一个java代码。所以问题是对于每个条件都应该打印出不同的语句。那么处理这个问题的最佳解决方案是什么，而不是让代码更加混乱和难以管理的常规 if 语句呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T18:30:08.927

一种选择是基本上构建一个位掩码：

```
int mask = (a ? 1 : 0) |
           (b ? 2 : 0) |
           (c ? 4 : 0) |
           (d ? 8 : 0) |
           (e ? 16 : 0);

System.out.println(statements[mask]); 
```

...`statements`长度为 32 的数组在哪里。所以在你的情况下，`statements[31]`将是“All tr​​ues”，`statements[30]`将是“Some Text”等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:30:22.303

解释`true`为位设置和`false`位未设置。这样，您可以将所有组合映射到 int 值 0 .. 31。

比简单地定义

```
String[] outputs = new String[32]{"text 1", "text2", ... ,  "text 31"}; 
```

而不是打印`outputs[bitconstallation]`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-14T10:33:09.387

为什么不概括您的位掩码函数以传递任意数量的布尔值（可能使用 BigDecimal 会更好 -> 满足特定需求）：

```
/**
* Gets all the boolean combinations in the array of booleans.
* 
* @param booleans
* @return
*/
public static int getBooleanCombinations(final boolean... booleans) {
   int res = 0;
   for (int n = 0; n < booleans.length; n++) {
            final double pow = Math.pow(2, n);
            final boolean bool = booleans[n];
            final Double localres = Double.valueOf(bool ? pow : 0);
            res = localres.intValue() | res;
    }
    return res;
} 
```

# debugging - 在 Postgresql 中，如何调试删除级联后发生的错误？

> ID：14486727
> 
> 赞同：4
> 
> 时间：2013-01-23T18:27:24.757
> 
> 标签：debugging, postgresql, cascade

我正在从表中删除这一行，它在 FK 上有一堆级联，最终它给了我这个错误：

> 错误：在表“foo_route”上插入或更新违反了外键约束“foo_route_bar_fk”
> 
> SQL 状态：23503
> 
> 详细信息：表“bar”中不存在键 (bar_key)=(2176)。

foo_route_bar_fk 定义如下：

```
ALTER TABLE foo_route  
ADD CONSTRAINT foo_route_bar_fk FOREIGN KEY (bar_key) REFERENCES bar (bar_key) 
MATCH SIMPLE ON UPDATE NO ACTION ON DELETE CASCADE; 
```

通过删除与这两个无关的表，我得到了这个错误。我认为正在发生的事情是触发器或级联导致此错误，但很难找出原因。

我的问题是，你如何在 postgresql 中调试这样的问题？ **导致此错误的一系列步骤是什么？** Postgresql 只告诉我它在失败之前所做的最后一件事的结果。如果这是代码，则错误将提供非常有用的堆栈跟踪。有没有办法在 Postgresql 中看到类似的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T07:38:10.190

通常，您的 postgresql 日志将包含触发错误的语句。这应该允许您遵循级联事件的链。

然而，我建议的一件事是，您可能想要绘制 fkeys 的映射并查看外键上的 ON 事件的映射。如果是我，我会从仅模式转储或 pg_autodoc 输出开始，然后从那里开始。明显的问题是，您在不能级联的情况下删除了级联，因此您需要在这里查看并重新考虑。

# c# - 如何检查回发是否由动态链接按钮引起

> ID：14486733
> 
> 赞同：12
> 
> 时间：2013-01-23T18:27:37.600
> 
> 标签：c#, asp.net, .net

我有一个按钮控件。单击此按钮时，我需要动态添加一个链接按钮。链接按钮需要一个事件处理程序。因此，动态链接按钮首先添加到 Page_Load 中，然后在按钮单击处理程序中清除并再次添加。请阅读[Dynamic Control 的 Event Handler's Working](https://stackoverflow.com/questions/14364332/dynamic-controls-event-handlers-working)以了解对此的业务需求。

我已阅读[On postback，如何在 Page_Init 事件](https://stackoverflow.com/questions/3175513/on-postback-how-can-i-check-which-control-cause-postback-in-page-init-event) 中检查哪个控件导致回发，以识别导致回发的控件（在 Page_Load 内）。但它不适用于我的场景。

需要做哪些更改来确认回发是否是由链接按钮（在 Page_Load 内）引起的？

**注意**：有关不可避免的另一种情况，请参阅以下内容[https://codereview.stackexchange.com/questions/20510/custom-paging-in-asp-net-web-application](https://codereview.stackexchange.com/questions/20510/custom-paging-in-asp-net-web-application)

注 1：我需要获取回发控件 ID 作为内部的第一步`if (Page.IsPostBack)`。只有当它是来自按钮或链接按钮的回发时，我才需要添加动态链接按钮控件。将有其他控件导致回发。对于此类回发，我们不应执行此代码。

注意 2：我`Request["__EVENTARGUMENT"]`在 Page_Load 中得到空字符串

**相关问题**：通过什么`event`，动态控件将在页面中可用（用于在 FindControl 中使用）。@Tung 说-“您的 GetPostBackControlId 方法正在正确获取导致回发的控件的名称，但它无法通过 page.FindControl 找到具有该 ID 的控件，因为尚未创建链接按钮，因此页面没有知道它的存在。”

**ASPX**

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="PostbackTest.aspx.cs" Inherits="PostbackTest"
MasterPageFile="~/TestMasterPage.master" %>

<asp:Content ID="myContent" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
<div id="holder" runat="server">
</div>
<asp:Button ID="Button1" runat="server" Text="Button" OnClick="TestClick" />
</asp:Content> 
```

**代码背后**

```
public partial class PostbackTest : System.Web.UI.Page
{
protected void Page_Load(object sender, EventArgs e)
{

    if(Page.IsPostBack)
    {
        string IDValue = GetPostBackControlId(this.Page);
        int x = 0;

        holder.Controls.Clear();
        LinkButton lnkDynamic = new LinkButton();
        lnkDynamic.Click += new EventHandler(LinkClick);
        lnkDynamic.ID = "lnkDynamic123";
        lnkDynamic.Text = "lnkDynamic123";
        holder.Controls.Add(lnkDynamic);
    }
}

protected void TestClick(object sender, EventArgs e)
{
    holder.Controls.Clear();
    LinkButton lnkDynamic = new LinkButton();
    lnkDynamic.Click += new EventHandler(LinkClick);
    lnkDynamic.ID = "lnkDynamic123";
    lnkDynamic.Text = "lnkDynamic123";
    holder.Controls.Add(lnkDynamic);
}

protected void LinkClick(object sender, EventArgs e)
{

}

public static string GetPostBackControlId(Page page)
{
    if (!page.IsPostBack)
    {
        return string.Empty;
    }

    Control control = null;

    // First check the "__EVENTTARGET" for  controls with "_doPostBack" function
    string controlName = page.Request.Params["__EVENTTARGET"];
    if (!String.IsNullOrEmpty(controlName))
    {
        control = page.FindControl(controlName);
    }
    else
    {
        // if __EVENTTARGET is null, the control is a button type 
        string controlId;
        Control foundControl;

        foreach (string ctl in page.Request.Form)
        {
            // Handle ImageButton they having an additional "quasi-property" in their Id which identifies mouse x and y coordinates
            if (ctl.EndsWith(".x") || ctl.EndsWith(".y"))
            {
                controlId = ctl.Substring(0, ctl.Length - 2);
                foundControl = page.FindControl(controlId);
            }
            else
            {
                foundControl = page.FindControl(ctl);
            }

            if (!(foundControl is Button || foundControl is ImageButton)) continue;

            control = foundControl;
            break;
        }
    }

    return control == null ? String.Empty : control.ID;
}
} 
```

**参考**

1.  [在回发时，如何检查哪个控件导致 Page_Init 事件中的回发](https://stackoverflow.com/questions/3175513/on-postback-how-can-i-check-which-control-cause-postback-in-page-init-event)
2.  [动态控制的事件处理程序的工作](https://stackoverflow.com/questions/14364332/dynamic-controls-event-handlers-working)
3.  [了解 JavaScript __doPostBack 函数](http://aspalliance.com/articleViewer.aspx?aId=895&pId=-1)
4.  [使用 ASP.NET 代码访问 PostBack 上的 JavaScript 变量](http://www.dotnetcurry.com/ShowArticle.aspx?ID=203)
5.  [ASP.NET 如何知道在回发期间触发哪个事件？](https://stackoverflow.com/questions/9989122/how-does-asp-net-know-which-event-to-fire-during-a-postback)
6.  [如何从服务器控件中删除“名称”属性？](https://stackoverflow.com/questions/4424476/asp-net-how-to-remove-name-attribute-from-server-controls)
7.  [如何使用 __doPostBack()](https://stackoverflow.com/questions/3591634/how-to-use-dopostback/3914500#3914500)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T23:38:36.420

asp.net 中的回发由 java 脚本函数 __doPostback(source, parameter) 完成

所以在你的情况下

```
 __doPostback("lnkDynamic123","") something like this 
```

所以在后面的代码中执行以下操作

```
 var btnTrigger = Request["__EVENTTARGET"]; 

     if(btnTrigger=="lnkDynamic123") 
{
} 
```

--- 这将表明是您的链接按钮导致回发

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-29T10:43:39.063

在将 LinkBut​​ton添加到页面*后*，您可以将调用移至 GetPostBackControlId 方法：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (Page.IsPostBack)
    {
        holder.Controls.Clear();
        LinkButton lnkDynamic = new LinkButton();
        lnkDynamic.Click += new EventHandler(LinkClick);
        lnkDynamic.ID = "lnkDynamic123";
        lnkDynamic.Text = "lnkDynamic123";
        holder.Controls.Add(lnkDynamic);

        string IDValue = GetPostBackControlId(this.Page);

        if (IDValue == lnkDynamic.ID)
            LinkClick(lnkDynamic, new EventArgs());
    }
} 
```

在此处调用 click 事件处理程序也更接近于模仿标准 ASP.NET 页面生命周期，其中 Postback 事件处理发生在 Load 事件之后。

**编辑：**

如果必须在创建链接按钮*之前*确定控件 ID ，您可以为链接按钮 ID 创建一个命名方案，例如 lnkDynamic_1、lnkDynamic_2 等 `Request["__EVENTTARGET"]`将包含自动生成的控件 ID，例如“ctl00$mc$lnkDynamic_1”，您可以使用它来识别哪个 LinkBut​​ton 导致了回发。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-01T08:42:17.267

如果您正确获取回发控件 ID 但`FindControl`没有返回任何内容，则可能是因为您使用的是母版页。基本上，`someControl.FindControl(id)`搜索`someControl.NamingContainer`命名容器中的控件。但是在您的情况下，`Button1`控件位于`ContentPlaceHolder1`命名容器中，而不是直接位于`Page`命名容器中，因此您不会通过调用找到它`Page.FindControl`。如果您无法预测您要查找的控件将位于哪个命名容器中（例如，回发可能是由来自两个不同内容占位符的两个不同按钮引起的），那么您可以编写一个扩展来搜索递归控制，如下所示：

```
public static class Extensions
{
    public static Control FindControlRecursively(this Control control, string id)
    {
        if (control.ID == id)
            return control;
        Control result = default(Control);
        foreach (Control child in control.Controls)
        {
            result = child.FindControlRecursively(id);
            if (result != default(Control)) break;
        }
        return result;
    }
} 
```

但请谨慎使用，因为此方法将返回它找到的具有指定 id 的第一个控件（并且您可以拥有多个具有相同 id 的控件 - 但它们**应该**位于不同的命名容器中；命名容器旨在区分控件具有相同的 id，就像命名空间旨在区分具有相同名称的类）。

或者，您可以尝试使用`FindControl(string id, int pathOffset)`重载，但我认为这很棘手。

另外，检查[这个问题](https://stackoverflow.com/questions/12579311/how-to-use-postbackurl-in-pages-with-masterpage)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-01T13:01:16.623

**第一种方法（不推荐，但更灵活）**

一种完全不同的方法——虽然我真的不觉得我应该推广它——是在表单中添加一个隐藏字段。

默认情况下，此隐藏字段的值可能类似于*false*。

如果单击应该导致再次添加动态控件的动态按钮之一，您可以在执行回发之前在客户端简单地将隐藏字段值更改为*true*（最终您希望/必须修改客户端 onclick 处理程序实现这一点）。

当然，可以在这样的字段中存储更多信息，例如控件 id 和参数（但您可以按照其他答案中的描述获取这些值）。在这种情况下，不需要命名模式。

这个隐藏字段可能是“静态的”。所以它可以随时在代码中访问。无论如何，您可能想要实现一些东西来确保没有人在玩弄它的值并伪造一个看起来像是来自这些动态链接之一的回调。

但是，这整个方法只是帮助您获取控件的 id。在您再次创建控件之前，您将无法通过 NamingContainer.FindControl 获取实例（如其他答案中所述；））。如果你创建它，你就不需要再找到它了。

**第二种方法（由于其限制可能不适合）**

如果您想以干净的方式执行此操作，则需要创建控件 OnLoad，无论是否单击了某些内容。此外，动态控件 ID 必须与您最初发送给客户端的 ID 相同。您订阅其 Click 或 Command 事件并将其可见性设置为 false。在 click 事件处理程序中，您再次将发件人可见性设置为 true。这意味着，您不在乎是否创建了该链接，而只是不想将其发送给客户端。下面的示例当然只适用于单个链接（但您可以轻松修改它以覆盖整个链接组）。

```
public void Page_Load(object sender, EventArgs e)
{
  LinkButton dynamicButton = new LinkButton();
  dynamicButton.ID = "linkDynamic123";
  // this id needs to be the same as it was when you 
  // first sent the page containing the dynamic link to the client
  dynamicButton.Click += DynamicButton_Click;
  dynamicButton.Visible = false;
  Controls.Add(dynamicButton);
}

public void DynamicButton_Click(object sender, EventArgs e)
{
  // as you created the control during Page.Load, this event will be fired. 
  ((LinkButton)sender).Visible = true;
} 
```

# asp.net - SQL Server 轻量级版本

> ID：14486734
> 
> 赞同：-1
> 
> 时间：2013-01-23T18:27:37.163
> 
> 标签：asp.net, sql-server, sql-server-ce, simplemembership, localdb

我正在开发一个使用 LocalDb 数据库的 ASP.NET MVC 应用程序。这个应用程序还需要有一个始终运行的相应 Windows 服务。经过大量研究，LocalDb 似乎不是部署的明智选择，因为需要有两个用户和并发访问以及 24/7 的正常运行时间。

我正在构建的应用程序不会部署到一台服务器上，它将捆绑在安装程序中并分发给多个用户。如果我能证明分发 SQL Server Express 2012 的合理性，这将变得简单得多，但是将安装程序扩大 120MB 并在磁盘上使用 300MB 是我非常努力避免的事情。

数据库的负载将非常轻——Web 应用程序使用 SimpleMembership 提供程序，除了成员表之外，只有少数其他表中永远不会包含任何大量数据。在这个应用程序的早期版本中，我使用了一个 XML 成员资格提供程序，它将用户和角色数据存储在磁盘上，并将其他数据存储在我自己的 XML 配置文件中。一些客户对此有安全顾虑，因此我想将成员资格和配置数据移动到数据库中，以便客户可以将应用程序指向他们自己的 SQL Server，并使用它来实现他们想要的所有安全性。

我还希望 Windows 服务使用 SQL Server Broker 和 SqlDependency 来检测 Web 应用程序在数据库中所做的更改。

SQL Express 之所以出局，是因为它太大了，而且这个应用程序需要在一些嵌入式系统上运行，而我不太可能获得安装它的许可。

LocalDb 可能因为我上面提到的原因而退出了。

SQL Server Compact – 我从未使用过它。我的理解是它在进程内运行——该进程可以成为我的 Windows 服务以便它始终运行吗？我可以与网络应用程序同时访问它吗？SimpleMembership 提供者会使用它吗？知道 SqlDependency 是否可以使用它还是返回轮询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:02:08.857

如果你需要一个小型的 sql 数据库，试试这个怎么样。SQLlite 只有几百 KB 并且易于使用。

它有 ac# 端口[http://code.google.com/p/csharp-sqlite/](http://code.google.com/p/csharp-sqlite/)。

还有很多关于在你的 c# 项目中使用 sql lite 的信息。

有关更多信息，请参阅此链接：http: [//www.codeproject.com/Articles/22165/Using-SQLite-in-your-C-Application](http://www.codeproject.com/Articles/22165/Using-SQLite-in-your-C-Application)

[SQLite 是否有 .NET/C# 包装器？](https://stackoverflow.com/questions/93654/is-there-a-net-c-wrapper-for-sqlite)

我只是用它测试了一下，它非常小，速度快，简单而且 SQL 语法通常是一样的。您不能以相同的方式处理 T-SQL，但正如您所说，您只存储一些简单的数据，您应该尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:09:09.147

Windows 服务和 asp.net 都可以在同一台机器上同时访问数据库，是的。SimpleMemberShip 与它一起工作，没有 SqlDependency，但您可以通过使用 rowversion 列和 @@dbts 函数进行轻量级轮询示例，可能与一些系统表查询结合使用

# sql - SQL：更新时如何判断和跳过唯一约束？

> ID：14486740
> 
> 赞同：3
> 
> 时间：2013-01-23T18:27:54.430
> 
> 标签：sql, oracle

我正在编写一个 SQL (Oracle) 来使用另一个表中的值更新一个表。但由于有 2 列唯一约束，更新总是失败。它是这样的：

```
Table A
- A_1
- A_2
- A_3
(There is a unique constraint for A_1 + A_3 )

Table B
- B_1
- B_2 
```

这是我当前的sql：

```
UPDATE A a
SET a.A_1 =
    (SELECT b.B_1
    FROM B b
    WHERE a.A_2 = b.B_2
    )
AND EXISTS
    (SELECT b.B_1
    FROM B b
    WHERE a.a.A_2 = b.B_2
    ) 
```

我想跳过违反唯一约束的行，但我不知道该怎么做。请指教。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:31:30.010

您可以`AND NOT EXISTS`在最后放置一个，检查新的约束值（就像更新之后一样）：

```
...
AND NOT EXISTS
(
    SELECT 1
    FROM A checkA
    WHERE checkA.A_1 = (SELECT b.B_1 FROM B b WHERE a.A_2 = b.B_2)
    AND checkA.A_3 = a.A_3
) 
```

# ocaml - ocaml sprintf 澄清

> ID：14486747
> 
> 赞同：4
> 
> 时间：2013-01-23T18:28:22.493
> 
> 标签：ocaml, printf

我不明白为什么会这样：

```
Printf.sprintf "%08s" "s" = Printf.sprintf "%8s" "s"
- : bool = true 
```

换句话说，我希望：

```
Printf.sprintf "%08s" "s"
- : string = "0000000s" 
```

而不是实际结果：

```
- : string = "       s" 
```

有人可以澄清为什么会这样吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T18:39:47.983

从 的[文档中`printf`](http://caml.inria.fr/pub/docs/manual-ocaml/libref/Printf.html)，您可以看到该`0`标志不适用于`%s`.

> 0：**对于数字转换**，用零而不是空格填充。

（重点是我的。）

请注意，在 C 中，它会导致未定义的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T18:45:47.827

当我在 C 中尝试您的格式说明符时，我收到以下警告：

```
warning: flag '0' results in undefined behavior with 's' conversion specifier 
```

假设我的编译器不疯狂（Mac OS X 10.8.2），这表明 OCaml 的转换很好。

# c# - Async/Await + FromEvent 方法

> ID：14486752
> 
> 赞同：0
> 
> 时间：2013-01-23T18:28:45.987
> 
> 标签：c#, multithreading, asynchronous, async-await

基于以下问题： [General purpose FromEvent method](https://stackoverflow.com/questions/12865848/general-purpose-fromevent-method)

我如何知道事件将返回我的应用程序中的哪个线程？我可以以某种方式指定它将继续哪个线程？使用此功能的线程会发生什么情况？

当我使用 WPF（Dispatcher/Main/UI 线程）时，这些响应似乎很明显，但如果我正在使用线程 MTA、STA、Reactive、ThreadPool（Task/BackgroundWorker），我如何预测会发生什么？

使用 task.Wait() 有什么真正的好处（如果我不必担心锁定线程）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:43:53.363

如果您`await`是`Task`，则有一个“上下文”被捕获并用于恢复该`async`方法。这个“上下文”是当前的`SynchronizationContext`，除非它是`null`，在这种情况下它是当前的`TaskScheduler`（现在通常是线程池调度程序）。

如果你在做`async`编程，你应该使用`await`而不是`Wait`. [`Wait`正如我在博客中解释的那样，可能会导致死锁](http://nitoprograms.blogspot.com/2012/07/dont-block-on-async-code.html)。

您可能还会发现我的[`async`/`await`介绍](http://nitoprograms.blogspot.com/2012/02/async-and-await.html)很有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T18:46:12.340

> 我如何知道事件将返回我的应用程序中的哪个线程？

你没有。你永远不会处理事件，除非特定事件的文档指定它将从 UI 线程、线程池线程等执行。

> 我可以以某种方式指定它将继续哪个线程？

如果要在 UI 线程中运行代码，则在事件处理程序中编组到 UI 线程。如果要在线程池线程中运行代码，则将新任务添加到处理程序内部的线程池中。如果不需要，这两项任务都会增加开销，因此通常最好查看事件的文档以了解需要哪些任务。

但是，在链接问题的情况下，整个想法是您不再处理事件和事件处理程序，而是处理`Task`. 因此，如果您向任务添加延续，问题是该延续将在哪里运行？这完全由您指定。您可以使用默认任务调度程序并让它在线程池中运行，您可以传递一个 UI SynchronizationContext 以在 UI 线程中运行，或者您可以让它在您继续运行的任务的任何地方运行。（这意味着您不知道哪个线程将运行它。）

如果您将任务与 一起使用`await`，那么它将自动将延续配置为在您开始该异步操作之前所在的同步上下文中运行，这可能是也可能不是 UI 线程（但很可能是）。如果您特别*不*希望那样，请使用`.ConfigureAwait(false);`.

> 使用 task.Wait() 有什么真正的好处（如果我不必担心锁定线程）？

使用基于异步任务的方法的原因是您没有阻塞线程，尤其是线程池线程（因为您明确表示您没有阻塞 UI，这更糟糕）。让一个线程无所事事是一个问题，在某些环境中比其他环境更严重（例如用于高度活跃站点的 ASP）。通过不进行阻塞等待，您不会消耗这些资源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T18:44:20.057

使用您链接到的技术无法预测它运行的线程。*可能*是引发事件的线程，但这不能保证（不，真的！不是。这是一个常见的误解）。

因此，您需要强制切换到要运行的任何线程。例如用于`Task.Run`切换到线程池或用于`TaskScheduler.FromCurrentSynchronizationContext`在 UI 上运行。

如果您`await`的任务保证在`await`. **这可能就是你想要的。**

# java - Java和C++进程之间的通信

> ID：14486754
> 
> 赞同：3
> 
> 时间：2013-01-23T18:28:49.177
> 
> 标签：java, c++, ipc

> **可能重复：**
> [语言/操作系统之间的进程间通信](https://stackoverflow.com/questions/773097/inter-process-communication-between-languages-operating-systems)

我需要在 java 和 C++ 进程之间进行进程间通信，因为两者是不同的进程，所以我不能使用 JNI。我正在考虑使用套接字通信，但是除了套接字通信之外还有其他解决方案吗？哪个更好更快？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T18:37:27.043

一般来说，您有以下几种可能性（可能还有更多，但这些是“流行”的）：

*   **标准输入和输出通道。**(+) 易于实现 (+) 快速 (+) 易于调试 (-) 您不能附加/分离到/从已经运行的进程

*   **命名管道。**(+) 快速 (-) 取决于系统

*   **IPC 系统，例如 DBus。**(-) 系统相关

*   **TCP 套接字通信。**(-) 较慢，但应该足够快 (+) 可以轻松扩展为远程通信 (+) 易于调试 (-) 应用程序或同一应用程序的实例之间可能存在 TCP 端口冲突。

就个人而言，我更喜欢 TCP 套接字通信，因为可以在（几乎）没有源代码更改的情况下建立远程连接。但是，必须注意不要在同一台机器上两次使用相同的端口，这是不可能的。正如您可能已经知道的那样，第二个实例将无法侦听端口。一种可能的解决方法是使用端口范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:38:32.300

有许多可用的 IPC 方法，选择哪一种真正取决于您想要做什么

1.  文件：可能是最容易实现的一个，只有你需要关心同步、脏读等。
2.  信号：我只能说很少，但它应该是快速的通信方式，我相信实现起来更复杂
3.  网络：我最喜欢的方法，每个新进程/节点在 spwan 上打开一个新端口，更好的选择是使用类似于[ros nodelets](http://www.ros.org/wiki/nodelet)的机制，它在一个进程中触发许多“nodelet”。这是一种快速的方法，但不是实时的

除了你有信号量和共享内存和管道等。但这些都不容易理解和实现，虽然我相信应该有一些库，也在操作系统级别

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:36:57.967

您是否看过[ZeroMQ](http://www.zeromq.org)或者看起来更吸引我的[Crossroads I/O](http://www.crossroads.io)？

# galaxy - Arduino Mega ADK + Galaxy S3 + USB

> ID：14486757
> 
> 赞同：0
> 
> 时间：2013-01-23T18:28:55.897
> 
> 标签：galaxy, adk

我想买一个三星galaxy s3，但我不知道它是否可以连接。有人知道它有效吗？我需要一根 otg USB 线连接还是可以用普通的 USB 线连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T11:41:00.237

我已经用 ardunio mega ADK、Google Nexus one 和 Samsung Galaxy S3 测试了两台 android 设备。

Google Nexus one 工作正常，但三星 S3 对主板没有反应，要让它工作，你应该使用外部电源（例如 9V 电池），它工作正常，你也不想买 otg usb 电缆，它适用于手机随附的普通 USB 数据线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T04:01:24.497

在升级Android系统之前，我尝试连接ardunio mega ADK成功。但是，我可以连接成功率大约 20%。这意味着我每十次只连接两次成功。但是系统升级到4.1.2后无法连接成功。

# c# - 为什么我的沮丧在 c# 中失败了？

> ID：14486759
> 
> 赞同：2
> 
> 时间：2013-01-23T18:29:05.440
> 
> 标签：c#

我有三种类型：

1.  `Patient`
2.  `Inpatient : Patient`
3.  `Outpatient : Patient`

我有一个填充基础患者及其所有属性的方法：`PatientRepository.FillPatient()`并返回一个`Patient`对象。

然后我需要检查并查看`Patient`类型是什么，然后向下转换为 an`Outpatient`或`Inpatient`.

当我尝试向下转换时，它会抛出`Unable to cast object of type 'Patient' to type 'Inpatient'.`这是一个运行时错误。

```
if (patient.Type == PatientType.Inpatient)
{
    var inpatient = (Inpatient)patient;             
    return inpatient;
}

public enum PatientType
{
    Inpatient, Outpatient
} 
```

我不知道为什么。我从根本上在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:35:56.877

您的*FillPatient*应该以正确的方式返回特定的类：

```
public static Patient FillPatient()
{
    if (something) {
        return new InPatient();
    }
    else {
        return new OutPatient();
    }
} 
```

然后你可以将它向下转换为特定的类

```
Patient patient = PaitentRepository.FillPatient();

if (patient is InPatient) {
    ...
}
else {
    ...
} 
```

注意：大多数情况下，当一个类是 N 个其他类的基础时，该基类（在您的情况下为*Patient*）将是抽象的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:37:11.873

因为问题说“抛出”，所以我认为这是一个运行时错误。这反过来意味着`PatientRepository.FillPatient()`返回一个类型的对象，`Patient`并且在某处包含`new Patient()`. 您可以将基类标记`Patient`为`abstract`，然后应该得到一些编译器错误。

如果您想在某个时候强制转换为子类型，`PatientRepository.FillPatient()`则必须创建此子类型的实例。因此，`new Patient()`您不必使用`new Inpatient()`并`new Outpatient()`取决于您尝试填充的患者类型。

# android - Android - Google Play 过滤掉 xxhdpi

> ID：14486763
> 
> 赞同：9
> 
> 时间：2013-01-23T18:29:18.640
> 
> 标签：android, screen, android-manifest, compatibility, resolution

我目前在使用 Google Play 过滤和 API 级别 16 中引入的新密度类 xxhpdi 时遇到问题。我的应用程序被拆分为 3 个 APK 文件（我知道这不是最佳实践，但由于计划不周，我目前必须这样做）。有趣的部分是适用于 Android 4.0 的版本，仅限智能手机。我在 AndroidManifest.xml 中设置了市场过滤器，如下所示：

```
<uses-sdk android:minSdkVersion="14" android:targetSdkVersion="17"/>
<compatible-screens>
    <screen android:screenDensity="ldpi" android:screenSize="small"/>
    <screen android:screenDensity="mdpi" android:screenSize="small"/>
    <screen android:screenDensity="hdpi" android:screenSize="small"/>
    <screen android:screenDensity="xhdpi" android:screenSize="small"/>

    <screen android:screenDensity="ldpi" android:screenSize="normal"/>
    <screen android:screenDensity="mdpi" android:screenSize="normal"/>
    <screen android:screenDensity="hdpi" android:screenSize="normal"/>
    <screen android:screenDensity="xhdpi" android:screenSize="normal"/>
</compatible-screens> 
```

现在的问题是，像 HTC Droid DNA 这样具有 1080p 屏幕的新设备无法看到或安装我的应用程序，因为我没有指定它也支持 xxhdpi 屏幕。问题是，因为我将 minSdkVersion 设置为 API 级别 14，即 Android ICS，所以我不能简单地添加以下行：

```
<screen android:screenDensity="xxhdpi" android:screenSize="normal"/> 
```

这是因为 API 级别 14 不知道 xxhdpi 类。有什么解决方案可以解决我的问题，而无需创建第四个单独的 APK 文件？

谢谢你。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-24T11:50:47.070

我找到了解决方案：而不是添加

```
<screen android:screenDensity="xxhdpi" android:screenSize="normal"/> 
```

在 compatible-screens 部分的行中，数值似乎也可以正常工作：

```
<screen android:screenDensity="480" android:screenSize="normal"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-10T13:22:55.290

关于这个问题似乎有一个未解决的问题：[code.google.com/p/android](https://code.google.com/p/android/issues/detail?can=2&start=0&num=100&q=&colspec=ID%20Type%20Status%20Owner%20Summary%20Stars&groupby=&sort=&id=39622) 这很糟糕，但我想不出更好的解决方法。

# php - 无法填充三分之二的生日字段组件

> ID：14486769
> 
> 赞同：0
> 
> 时间：2013-01-23T18:29:37.903
> 
> 标签：php, html, codeigniter

我可以在下拉菜单中选择的数据库中插入正确的生日。当页面在成功更新数据库后重新加载时，仅显示生日下拉菜单的年份部分。为什么会这样？我对所有三个都使用相同的简单逻辑。

```
 // CONTROLLER

  if($this->form_validation->run() == FALSE )
                    {

                            $data['main_content'] = 'account/edit';
                            $this->load->view('includes/templates/main_page_template', $data);

                        }
                        else
                        {
                            $birthdate = $this->input->post('month'). "-" .$this->input->post('day'). "-" .$this->input->post('year');
                            echo $birthdate;
                            $save_data = array(
                                'relation' => $this->input->post('relation'),
                                'location' => $this->input->post('location'),
                                'birthday' => date('Y-m-d',strtotime($birthdate)),
                                'gender' => $this->input->post('gender'),
                                'mylife' => $this->input->post('mylife'),
                                'occupation' => $this->input->post('occupation'),
                                'hobbies' => $this->input->post('hobbies'),
                                'books' => $this->input->post('books'),
                                'music' => $this->input->post('music'),
                                'movies' => $this->input->post('movies'),
                                'quote' => $this->input->post('quote'),
                                'mycysticlife' => $this->input->post('mycysticlife'),
                                'medicines' => $this->input->post('medicines'),
                                'treatments' => $this->input->post('treatments'),
                                'PFTs:FVC' => $this->input->post('PFTs:FVC'),
                                'FEV1' => $this->input->post('FEV1'),
                                'mutation' => $this->input->post('mutation'),
                                'twitter' => $this->input->post('twitter'),
                                'myspace' => $this->input->post('myspace'),
                                'facebook' => $this->input->post('facebook'),
                                'blogspot' => $this->input->post('blogspot'),
                                'youtube' => $this->input->post('youtube'),
                                'url' => $this->input->post('url'),
                                'city' => $this->input->post('city'),
                                 );

                                    $query = $this->account_model->update_edit($user['id'],$save_data);
                            $data['main_content'] = 'account/profile';
                            $this->load->view('includes/templates/main_page_template', $data);
                        }

                    }
                }

// VIEW

  <?php
                        echo month_dropdown('months', $user['birthday'])." ".day_dropdown('days', $user['birthday'])." ".year_dropdown('year', $user['birthday']);

                    ?>

// FORM HELPER

function month_dropdown($month="month", $top_month='' ) {

   $months = array(
        "choose"=>"Month",
        "Jan"=>"Jan",
        "Feb"=>"Feb",
        "Mar"=>"Mar",
        "Apr"=>"Apr",
        "May"=>"May",
        "Jun"=>"Jun",
        "Jul"=>"Jul",
        "Aug"=>"Aug",
        "Sep"=>"Sep",
        "Oct"=>"Oct",
        "Nov"=>"Nov",
        "Dec"=>"Dec"
  );

  $html = "<select name='{$month}'>";

  foreach($months as $key => $month){

      $selected = "";
      //this will match for selected value and set the selected attribute
      if( $key == $top_month ) {
          $selected = "selected='selected'";
      }
      $html .="<option value='{$key}' $selected>{$month}</option>";
  }
  $html .="</select>";
  return $html;

}

function day_dropdown($day="day", $top_days="") {
   $days = array(
        "choose"=>"Day",
        "01"=>"01",
        "02"=>"02",
        "03"=>"03",
        "04"=>"04",
        "05"=>"05",
        "06"=>"06",
        "07"=>"07",
        "08"=>"08",
        "09"=>"09",
        "10"=>"10",
        "11"=>"11",
        "12"=>"12",
        "13"=>"13",
        "14"=>"14",
        "15"=>"15",
        "16"=>"16",
        "17"=>"17",
        "18"=>"18",
        "19"=>"19",
        "20"=>"20",
        "21"=>"21",
        "22"=>"22",
        "23"=>"23",
        "24"=>"24",
        "25"=>"25",
        "26"=>"26",
        "27"=>"27",
        "28"=>"28",
        "29"=>"29",
        "30"=>"30",
        "31"=>"31"
   );

   $html = "<select name='{$day}'>";

   foreach($days as $key => $day){
      $selected = "";
      if( $key == $top_days ) {
          $selected = "selected='selected'";
      }

      $html .="<option value='{$key}' $selected >{$day}</option>";
   }
   $html .="</select>";
   return $html;

}

function year_dropdown($year="year", $top_years='') {
   $years = array(
        "choose"=>"Year",
        "1997"=>"1997",
        "1996"=>"1996",
        "1995"=>"1995",
        "1994"=>"1994",
        "1993"=>"1993",
        "1992"=>"1992",
        "1991"=>"1991",
        "1990"=>"1990",
        "1989"=>"1989",
        "1988"=>"1988",
        "1987"=>"1987",
        "1986"=>"1986",
        "1985"=>"1985",
        "1984"=>"1984",
        "1983"=>"1983",
        "1982"=>"1982",
        "1981"=>"1981",
        "1980"=>"1980",
        "1979"=>"1979",
        "1978"=>"1978",
        "1977"=>"1977",
        "1976"=>"1976",
        "1975"=>"1975",
        "1974"=>"1974",
        "1973"=>"1973",
        "1972"=>"1972",
        "1971"=>"1971",
        "1970"=>"1970",
        "1969"=>"1969",
        "1968"=>"1968",
        "1967"=>"1967",
        "1966"=>"1966",
        "1965"=>"1965",
        "1964"=>"1964",
        "1963"=>"1963",
        "1962"=>"1962",
        "1961"=>"1961",
        "1960"=>"1960",
        "1959"=>"1959",
        "1959"=>"1959",
        "1958"=>"1958",
        "1957"=>"1957",
        "1956"=>"1956",
        "1955"=>"1955",
        "1954"=>"1954",
        "1953"=>"1953",
        "1953"=>"1953",
        "1952"=>"1952",
        "1951"=>"1951",
        "1950"=>"1950",
        "1949"=>"1949",
        "1948"=>"1948",
        "1947"=>"1947",
        "1946"=>"1946",
        "1945"=>"1945",
        "1944"=>"1944",
        "1943"=>"1943",
        "1942"=>"1942",
        "1941"=>"1941",
        "1940"=>"1940",
        "1939"=>"1939",
        "1938"=>"1938",
        "1937"=>"1937",
        "1936"=>"1936",
        "1935"=>"1935",
        "1934"=>"1934",
        "1933"=>"1933",
        "1932"=>"1932",
        "1931"=>"1931",
        "1930"=>"1930"

   );

   $html = "<select name='{$year}'>";

   foreach($years as $key => $year){

      $selected = "";
      if( $key == $top_years ) {
          $selected = "selected='selected'";
      }

     $html .="<option value='{$key}' $selected >{$year}</option>";
   }
   $html .="</select>";
   return $html;

 }

// MODEL

  public function update_edit($id,$data)
    {
        $this->db->where('id', $id);
        $this->db->update('users', $data);

    }
}

thanks in advance 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T00:14:30.637

只是仔细看了一下代码，我看到了这一行，并假设它是给你带来问题的那一行？

```
echo month_dropdown('months', $user['birthday'])." ".day_dropdown('days', $user['birthday'])." ".year_dropdown('year', $user['birthday']); 
```

该变量应该以您保存的格式返回日期，因此对我来说它将返回 09-12-1967，这可能不是您的下拉菜单的合法值。您可以将其分解，然后像这样填充下拉列表：

```
$birthdate = explode('-',$user['birthday']);
 echo month_dropdown('months', $birthdate[0])." ".day_dropdown('days', $birthdate[1])." ".year_dropdown('year', $birthdate[2]); 
```

那应该工作

# c# - .Net - 将使用“A”类的列表复制到使用“B”类的新列表，该“B”类继承自“A”类并添加新项目\变量

> ID：14486771
> 
> 赞同：0
> 
> 时间：2013-01-23T18:29:38.757
> 
> 标签：c#, .net, list, class

我有一个创建如下的列表。它使用第三方包装器来管理从电脑游戏下载 xml 信息：-

```
List<EveAI.Live.Asset> lst_eveai_characterabc_assets = eve_api.GetCharacterAssets(); 
```

Asset 的类定义是：-

```
namespace EveAI.Live
{
  [TypeConverter(typeof(ExpandableObjectConverter))]
  public class Asset
  {
    public Asset();

    public ContainerType Container { get; set; }
    public List<Asset> Contents { get; set; }
    public double ContentsVolume { get; }
    public bool IsSingleton { get; set; }
    public long ItemID { get; set; }
    [Obsolete("Will be removed in a future version, use LocationStation or      
    LocationSolarsystem or LocationConquerableStation instead")]
    public Station Location { get; set; }
    public ConquerableStation LocationConquerableStation { get; set; }
    public int LocationID { get; set; }
    public SolarSystem LocationSolarsystem { get; set; }
    public Station LocationStation { get; set; }
    public long Quantity { get; set; }
    public int RawQuantity { get; set; }
    public ProductType Type { get; set; }
    public int TypeID { get; set; }

    public override string ToString();
  }
} 
```

我想将列表 lst_eveai_characterabc_assets 复制到使用类 AssetUniverseIDs 的新列表 - 继承类 EveAI.Live.Asset 类似：-

```
public class AssetUniverseIDs : EveAI.Live.Asset
{
  public Int32 stationID {get;set;}
  public Int32 stationTypeID { get; set; }
  public Int32 corporationID { get; set; }
  public Int32 solarSystemID { get; set; }
  public string solarSystemName { get; set; }
  public double security { get; set; }
  public string securityClass { get; set; }
  public Int32 constellationID { get; set; }
  public Int32 regionID { get; set; }
  public string regionName { get; set; }
  public string stationName { get; set; }
} 
```

但到目前为止，我无法将 lst_eveai_characterabc_assets 复制到使用继承类 Assets 的类 AssetUniverseIDs 的新列表中。请问我怎么能做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:53:20.603

您最好的选择可能是复制构造函数：

```
public AssetUniverseIDs(EveAI.Live.Assett original)
{
     this.Container = original.Container;
     this.Contents = original.Contents;
     // ...
} 
```

然后，您可以从这样的资产列表中构建 AssetUniverseID 列表：

```
List<AssetUniverseIDs> newList = 
    lst_eveai_characterabc_assets.Select(a => new AssetUniverseIDs(a)).ToList(); 
```

你有什么特别的原因要`AssetUniverseIDs`继承`Asset`吗？`Asset`也许只拥有一个具有 a作为其属性之一的类就足够了？

# d3.js - 使用 d3 生成的直方图的小调整

> ID：14486773
> 
> 赞同：1
> 
> 时间：2013-01-23T18:29:43.687
> 
> 标签：d3.js

以下是精简版本是我用来使用 d3 和一些 jQuery 生成直方图的版本。[http://bl.ocks.org/4611158](http://bl.ocks.org/4611158)

虽然大部分看起来都是对的，但我仍然对

1.  为什么 x 轴上没有像上例中的给定输入那样的“14”？取而代之的是 13 得到应该是 14 的纵坐标

2.  在我的试验中，当我尝试将比例的输出范围更改为某个非零值时，d3.layout.histogram() 分配了负数（因此是非绘图表）宽度。为什么会这样？什么是可能的解决方法？

我使用序数比例的主要动机是使刻度在条形下方居中对齐，这与 Mike 在他 的直方图[演示中使用的不同。](http://bl.ocks.org/3048450)出于同样的目的，我还使 bin 的数量等于 d3.layout.histogram() 中的刻度数。我确信可能有更好的方法来编码我正在寻找的内容

还有任何想法如何添加指标线的“图形”，就像在[nvd3 可视化](http://nvd3.org/)中完成的那样（背景为浅灰色），这将使它更令人愉悦？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:11:02.703

没有， x 轴上`14`有两个s。`8`这是因为该函数会[根据 API 参考](https://github.com/mbostock/d3/wiki/Histogram-Layout#wiki-bins)`bins`将范围划分`= 14 - 1 = 13`为多个`14`区间：

> bins 可以指定为一个数字，在这种情况下，值的范围将被均匀地分成给定数量的 bins。或者，bins 可以是一个阈值数组，定义了 bins；指定的数组必须包含最右边（上）的值，因此为 n 个 bin 指定 n + 1 个值。...

在解决这个问题之前，我猜你面临的第二个问题是如果`rangeDefault`有负值，那么有些值不会被绘制。为了解决这个问题，不知道它的确切需求，我将从删除以下内容开始：

```
rangeDefault[0] = 0; //All histograms start from 0 <-- REMOVED 
```

然后要解决第一个问题，请使用第二种形式的参数，`bins`[如下所示](http://jsfiddle.net/xjMNr/)：

```
 var bins = [];
  for(var ii = settings.range[0], jj = 0; ii <= settings.range[1] + 1; ii++, jj++)
      bins[jj] = ii;

  var data = d3.layout.histogram()
                .bins(bins)(settings.data); 
```

我希望这能解决主要问题。

* * *

添加浅灰色指示线相当容易，[如下所示](http://jsfiddle.net/EXfCu/1/)。变化是：

# vis.css

```
.y.axis line.tick { opacity: .3; } 
```

# vis.js

Moving the axis before the chart in the DOM because of how SVG is laid out affects its `z-index`:

```
var gEnter = svg.enter().append("svg").append("g");
gEnter.append("g").attr("class", "x axis");
gEnter.append("g").attr("class","y axis");
gEnter.append("g").attr("class", "bars"); 
```

And finally making the major `tickSize` on the y-axis `-(width - margin.right - margin.left)`:

```
yAxis = d3.svg.axis()
            .scale(y)
            .orient("left")
            .tickSubdivide(true)
            .tickPadding(5)
            .ticks(10)
            .tickSize(-(width - margin.right - margin.left), 2, 8); 
```

# sql - Oracle 脚本 - 物化视图和同义词

> ID：14486776
> 
> 赞同：2
> 
> 时间：2013-01-23T18:29:48.430
> 
> 标签：sql, oracle, materialized-views, synonym

我有一个关于 Oracle 脚本的问题！

我在 BBDD 中的预建表上有一个物化视图（此 MV 属于用户 DAT_OWN，其他 2 个用户（APP 和 BO）在此 MV 上有同义词）我必须更改 MV 并添加一列。我知道我需要删除这个 MV 并创建另一个，但是同义词的附加值是什么？

我有一个以前的脚本，例如：

```
DROP SYNONYM APP.STAT_VOZ;
CREATE SYNONYM APP.STAT_VOZ FOR DAT_OWN.STAT_VOZ;

DROP SYNONYM BO.STAT_VOZ;
CREATE SYNONYM BO.STAT_VOZ FOR DAT_OWN.STAT_VOZ;

DROP MATERIALIZED VIEW DAT_OWN.STAT_VOZ;
CREATE MATERIALIZED VIEW DAT_OWN.STAT_VOZ 
ON PREBUILT TABLE WITH REDUCED PRECISION
REFRESH COMPLETE
START WITH TO_DATE('21-ene-2013 19:20:00','dd-mon-yyyy hh24:mi:ss')
NEXT (trunc(SYSDATE,'HH')+19/72) 
WITH PRIMARY KEY
AS 
  SELECT           TO_CHAR (SUM (COUNT)) AS sum_count,
         start_date AS date_hour,
         input_type AS input_type
    FROM DAT_OWN.another_table
   WHERE start_date > TO_CHAR (SYSDATE - 60, 'yyyymmdd')
GROUP BY start_date 
```

为什么有人会在删除物化视图之前先删除同义词 APP 并创建同义词 APP 删除同义词 BO 并创建同义词 BO？在我看来，我必须做

```
drop synonym1
drop synonym2
drop Mview
create Mview
create Synonym1
Create Synonym2 
```

我确信我之前的程序员做得很好，但我不明白他们为什么这样做！有人可以解释一下吗？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:42:29.487

您的原始脚本可能只是由“老派”开发人员编写的。大多数人习惯于在重新创建对象之前立即删除它们。正如您所注意到的，顺序并不重要。

现在大多数人使用`CREATE OR REPLACE`语法而不是首先删除对象。 [这是对该概念的一个很好的解释](https://stackoverflow.com/questions/1008248/how-do-i-use-create-or-replace)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:51:11.093

可能不需要触及脚本中的任何同义词。

同义词只是一个指针。不要求同义词指向的对象根本存在。如果您只是删除并重新创建物化视图，同义词将自动指向新创建的物化视图。当然，在物化视图被删除之后重新创建之前，如果会话尝试使用同义词查询物化视图，该会话将得到对象不存在的错误。但是，大概，您正在等待删除并重新创建物化视图，直到没有人使用它，所以这通常不是主要问题。

# mongodb - RMongo dbGetQueryForKeys()，“键”的结构是什么，我如何对它们进行子键化？

> ID：14486780
> 
> 赞同：1
> 
> 时间：2013-01-23T18:30:05.480
> 
> 标签：mongodb, rmongo

我正在尝试使用 RMongo 从 R 查询一个 mongo 数据库并返回几个嵌套文档的值。

查看 RMongo 的文档，我了解以下查询：

```
output <- dbGetQueryForKeys(mongo, 'test_data', '{"foo": "bar"}', '{"foo":1}') 
```

论据在哪里...

```
db = mongo
collection = 'test_data'
query = '{"foo": "bar"}'
keys = 'Specify a set of keys to return.' 
```

1 in 是`'{"foo":1}'`什么？这个密钥集的结构是什么？检查[this blog post](http://pseudofish.com/blog/2011/05/25/analysis-of-data-with-mongodb-and-r/)，我发现了如下格式：

> 结果 < - dbGetQueryForKeys(mongo, "items", "{'publish_date' : { '$gte' : '2011-04-01', '$lt' : '2011-05-01'}}", "{'发布日期'：1，'排名'：1}“）

那么，显然，键需要值 1？

如何获取嵌套文档的密钥？如果我想要类似...

```
output <- dbGetQueryForKeys(mongo, 'test_data', '{"foo": "bar"}', '{"foo1.foo2.foo3.foo4":1,"foo1.foo2.foo3.bar4":1}') 
```

对于嵌套键，我目前返回的东西更像......

```
 X_id
1 50fabd42a29d6013864fb9d7
                                                                               foo1
1 { "foo2" : { "foo3" : { "foo4" : "090909" , "bar4" : "1"}}} 
```

... where`output[,2]`是一个 looooong 字符串，而不是像我预期的那样作为与键 foo4 和 bar4 关联的值的两个单独变量 ("090909", "1")。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T15:49:57.387

> '{"foo":1}' 中的 1 是什么？这个密钥集的结构是什么？

这些键是为MongoDB中的[读取操作](http://docs.mongodb.org/manual/core/read-operations/)返回的[查询投影。](http://docs.mongodb.org/manual/reference/method/db.collection.find/#db.collection.find)“1”值表示包含特定字段，“0”表示排除。默认行为是在投影中包含所有字段。

> 如何获取嵌套文档的密钥？
> 
> 对于嵌套键，我目前返回的内容更像... 1 { "foo2" : { "foo3" : { "foo4" : "090909" , "bar4" : "1"}}} ...where output [,2] 是一个 looooong 字符串，而不是像我预期的那样，作为与键 foo4 和 bar4 关联的值的两个单独变量 ("090909", "1")。

RMongo 驱动程序正在返回包括嵌入层次结构的数据。

您可以使用 RMongo`dbAggregate()`命令和作为MongoDB 2.2+中[聚合框架](http://docs.mongodb.org/manual/core/aggregation/)[`$project`](http://docs.mongodb.org/manual/reference/aggregation/project/)的一部分的运算符来重塑和展平结果输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-22T23:05:29.660

如果您的最终目标是从嵌套对象中提取值以在 R 中进行某种类型的下游处理，这将使您到达那里。它避免了构建聚合管道，是解决问题的简单方法。与其尝试深入嵌套结构并直接访问 bar4，不如提取对象的顶层，该对象将提供您引用的长字符串。

```
output <- dbGetQueryForKeys(mongo, 'test_data', '{"foo": "bar"}', '{"foo1.foo2.foo3.foo4":1,"foo1":1}') 
```

由于输出是一个 data.frame，您可以使用“jsonlite”库来获取您的数据：

```
library(jsonlite)
foo1 <- fromJSON(output$foo1)
bar4 <- foo1$foo2$foo3$bar4 
```

# java - Jasper Report 4.7 中的 Times New Roman 字体

> ID：14486782
> 
> 赞同：1
> 
> 时间：2013-01-23T18:30:05.770
> 
> 标签：java, jasper-reports, ireport

# 概述

一份报告使用 Times New Roman。我通过 iReport 的`Tools -> Options -> Fonts`菜单安装了字体。我将字体导出为扩展名（jar 文件）并将其添加到应用程序的 CLASSPATH。

# 问题

导出为 PDF 时，字段文本已从末尾剪切。生成的 PDF 在 PDF 属性中列出了 Times New 罗马字体，表明该字体已嵌入。

我猜这是 JasperReport 4.7 的字体问题或不兼容问题，因为我将字体类型更改为 Verdana 并且正确生成了 PDF。

Times New Roman 用于 iReport，扩展文件是从 Windows 复制的。

# 问题

是否有与 JasperReport 库完美配合的 Times New Roman 版本？

我不应该使用 Times new Roman 吗？

# 更新

我附上了两张图片和报告的屏幕截图。

第一张图片[http://i.stack.imgur.com/tr7XD.jpg](http://i.stack.imgur.com/tr7XD.jpg)说明了报告的正确打印。我用红线突出显示“anexo”这个词。这个词在使用times new roman字体时被删掉了。

第二张图片[http://i.stack.imgur.com/AdW63.jpg](http://i.stack.imgur.com/AdW63.jpg)展示了使用 Times new roman 字体生成的报告。请注意，“anexo”这个词没有被打印出来。红线表示该字段已打印到单词“localização”

PS1：两个附件显示了葡萄牙语报告的部分内容

PS2：黑色矩形隐藏敏感数据。不要考虑他们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:29:20.507

尝试捆绑以下一组常用字体：

他们的 JAR 文件捆绑了以下字体，

```
Arial
Times New Roman
Courier New
Comic Sans MS
Georgia
Verdana
Monospaced 
```

[http://archiva.fdvs.com.ar/repository/public1/ar/com/fdvs/DynamicJasper-core-fonts/1.0/](http://archiva.fdvs.com.ar/repository/public1/ar/com/fdvs/DynamicJasper-core-fonts/1.0/)

# html - 内部 DIV 未扩展到 100% 高度

> ID：14486783
> 
> 赞同：0
> 
> 时间：2013-01-23T18:30:07.793
> 
> 标签：html, css

我有几页似乎会导致一些相互矛盾的结果。我有一个登录页面应该有一个灰色的背景，然后我的内页有一个白色的背景。但是 id="loginPage" 的 div 不会拉伸“容器” div 的整个高度。因此 loginPage div 是灰色的，但容器 div 的剩余空间仍然是白色的。

现在，主容器有一个最小高度，因为我有几个包含大量内容的页面。当我将其设置为仅高度：100% 时，页脚不在页面底部。但是一旦我将它设置为最小高度，它就会下降到页面的底部。

这是我的CSS：

```
html, body { height: 100%;}

#loginPage {
    width:100%;
    height:100%;
    float:left;
    background-color:#F7F7F9!important;
}
    #container
{
    min-height:95%;
    position: relative;
    background:white;
}
.footerBg
{
     width:100%;
     padding-top:10px;
     margin:0;
     position:relative;
} 
```

和html：

```
<div id="container">
<div class="topHeader_login">
<form method="post" action="/">
<div id="loginPage">
<div id="login_content">
<div id="login">
<div id="info">
<div style="text-align:center; padding-top:15px; float:left;"> </div>
</div>
</div>
</form>
</div>
<div class="footerBg"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:08:29.913

我想你可能想看看这个：[http ://ryanfait.com/sticky-footer/](http://ryanfait.com/sticky-footer/)

它解释了如何使页脚始终位于页面底部，即使内容较小，并且如果滚动条不是必需的，它也永远不会添加滚动条。然后，您可以将“灰色”背景颜色添加到页面包装器中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:36:58.970

> 如果要将网页上的高度设置为百分比，则必须设置要定义高度的每个父元素的高度。

来源：[http ://webdesign.about.com/od/csstutorials/f/set-css-height-100-percent.htm](http://webdesign.about.com/od/csstutorials/f/set-css-height-100-percent.htm)

尝试给予`form { height: 100% }`

看看这个[小提琴](http://jsfiddle.net/mnxMJ/)，我清理了你的 html 和 css

# email - 覆盖 Amazon SES 中的返回路径

> ID：14486791
> 
> 赞同：15
> 
> 时间：2013-01-23T18:30:54.817
> 
> 标签：email, amazon-ses

我正在使用[Amazon SES](http://aws.amazon.com/ses/)，无论我做什么，它都会覆盖邮件标头中的**Return-Path**。

我使用发件人电子邮件地址设置了**返回路径**，但我收到了类似这样的内容：`0000013c68a254c5-b4c65e38-b391-43ea-93b7-658a6e977e49-000000@amazonses.com`. 我想原因是为了抓住退回的电子邮件。

但是，我的主要问题是我收到了一些自动回复电子邮件，`MAILER-DAEMON@amazonses.com`而不是回复到**回复**或**发件人**电子邮件地址。

所以我的问题是：

1.  是否可以覆盖**Return-Path**电子邮件地址？
2.  我怎样才能避免`MAILER-DAMEON@amazonses.com`电子邮件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-24T09:32:28.200

我几乎可以肯定你不能覆盖返回路径。作为亚马逊代表您发送电子邮件的一部分，他们还需要确保您没有发送垃圾邮件、捕获退回邮件（包括自动回复）、捕获投诉等等。执行此操作的关键方法之一是控制返回地址。

他们使用的电子邮件地址是与您的电子邮件相关的唯一密钥。当消息返回到该地址时，他们可以使用它来跟踪您的帐户。同样，您作为发件人从 AWS 收到的电子邮件是以编程方式发送的。这些将始终出现在您的帐户中，并且作为您应该适当回应它们的条款的一部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-04-03T22:07:37.437

以下是亚马逊为您的问题提供的信息：

> 如果您使用 SMTP 接口发送消息，则通知将发送到 SMTP 所需的 MAIL FROM 命令中指定的地址，该命令会覆盖 SMTP DATA 中指定的任何 Return-Path: 标头。
> 
> 如果您使用 SendEmail API 操作发送消息，则：
> 
> 如果您指定了 SendEmail 的可选 ReturnPath 参数，则通知将发送到指定地址。
> 
> 否则，通知将发送到 SendEmail 所需的 Source 参数中指定的地址，该参数填充消息的 From: 标头。
> 
> 如果您使用 SendRawEmail API 操作发送消息，则：
> 
> 如果您指定了 SendRawEmail 的可选 Source 参数，则通知将发送到该地址，覆盖原始消息中指定的任何 Return-Path: 标头。
> 
> 否则，如果在原始消息中指定了 Return-Path: 标头，则通知将发送到该地址。
> 
> 否则，通知将发送到原始消息的 From: 标头中的地址。

在这里找到：http: [//docs.aws.amazon.com/ses/latest/DeveloperGuide/notifications-via-email.html](http://docs.aws.amazon.com/ses/latest/DeveloperGuide/notifications-via-email.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-05-01T13:49:35.680

您现在可以更改 Amazon AWS SES 上的 Return-Path / Mail-From 标头。

AWS 文档在这里： [https ://docs.aws.amazon.com/ses/latest/DeveloperGuide/mail-from.html](https://docs.aws.amazon.com/ses/latest/DeveloperGuide/mail-from.html)

如果链接发生变化，您可以从以下感兴趣的部分进行谷歌引用以查找当前链接：

为已验证的域设置 MAIL FROM 域

您可以为整个域配置 MAIL FROM 域。当您这样做时，您从该域上的地址发送的所有邮件都使用相同的 MAIL FROM 域。

将已验证域配置为使用指定的 MAIL FROM 域

1.  [在https://console.aws.amazon.com/ses/](https://console.aws.amazon.com/ses/)打开 Amazon SES 控制台

2.  在导航窗格中的身份管理下，选择域。

3.  在域列表中，确认 MAIL FROM 域的父域已验证。如果未验证域，请完成在 Amazon SES 中验证域中的过程以验证域。否则，请选择域并继续下一步。

4.  在 MAIL FROM Domain 下，选择 Set MAIL FROM Domain。

5.  在 Set MAIL FROM Domain 窗口中，执行以下操作：

    一种。对于 MAIL FROM 域，输入要用作 MAIL FROM 域的子域。

    湾。对于未找到 MX 记录时的行为，选择以下选项之一：

    ```
    - Use region.amazonses.com as MAIL FROM – If the custom MAIL FROM domain's MX record is not set up correctly, Amazon SES will use a subdomain of amazonses.com. The subdomain varies based on the AWS Region in which you use Amazon SES.

    - Reject message – If the custom MAIL FROM domain's MX record is not set up correctly, Amazon SES will return a MailFromDomainNotVerified error. Emails that you attempt to send from this domain will be automatically rejected. 
    ```

    C。选择从域设置邮件。将出现一个窗口，其中包含您必须添加到域的 DNS 配置中的 MX 和 SPF 记录。这些记录使用下表中显示的格式。名称 类型 值

    `subdomain.domain.com MX 10 feedback-smtp.region.amazonses.com`

    `subdomain.domain.com TXT "v=spf1 include:amazonses.com ~all"`

    在上述记录中，将 subdomain.domain.com 替换为您的 MAIL FROM 子域，将 region 替换为您要验证 MAIL FROM 域的 AWS 区域的名称（例如 us-west-2、us-east-1 , 或 eu-west-1)。请注意，TXT 记录的值必须包含引号。

    记下这些值，然后继续下一步。

6.  将 MX 记录发布到自定义 MAIL FROM 域的 DNS 服务器。

重要 要使用 Amazon SES 成功设置自定义 MAIL FROM 域，您必须将一条 MX 记录准确发布到您的 MAIL FROM 域的 DNS 服务器。如果 MAIL FROM 域有多个 MX 记录，使用 Amazon SES 的自定义 MAIL FROM 设置将失败。

如果 Route 53 为您的 MAIL FROM 域提供 DNS 服务，并且您使用用于 Route 53 的同一账户登录 AWS 管理控制台，则选择使用 Route 53 发布记录。DNS 记录将自动应用于您的域的 DNS 配置。

如果您使用不同的 DNS 提供商，您必须手动将 DNS 记录发布到 MAIL FROM 域的 DNS 服务器。将 DNS 记录添加到域的 DNS 服务器的过程因您的 Web 托管服务或 DNS 提供商而异。

为您的域发布 DNS 记录的过程取决于您使用的 DNS 提供商。下表包含几个常见 DNS 提供商的文档链接。此列表不是提供者的完整列表。如果您的提供商未在下面列出，您可能仍然可以设置 MAIL FROM 域。列入此列表并不表示对任何公司的产品或服务的认可或推荐。

[...]

当 Amazon SES 检测到记录到位时，您会收到一封电子邮件，通知您您的自定义 MAIL FROM 域已成功设置。根据您的 DNS 提供商，在 Amazon SES 检测到 MX 记录之前可能会有长达 72 小时的延迟。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-12-12T09:17:38.930

在该文档的底部（[http://docs.aws.amazon.com/ses/latest/DeveloperGuide/notifications-via-email.html](http://docs.aws.amazon.com/ses/latest/DeveloperGuide/notifications-via-email.html)）它说

```
When you specify a Return-Path address in an email, you receive 
notifications at that address. However, the version of the message 
that the recipient receives contains a Return-Path header that includes
an anonymized email address (such as 
a0b1c2d3e4f5a6b7-c8d9e0f1-a2b3-c4d5-e6f7-a8b9c0d1e2f3-000000@amazonses.com 
```

所以无论如何你都不会摆脱那个奇怪的返回路径。

# sql - 自定义帖子类型每年/每月存档

> ID：14486792
> 
> 赞同：6
> 
> 时间：2013-01-23T18:30:59.450
> 
> 标签：sql, wordpress, .htaccess, mod-rewrite, custom-post-type

我的 Wordpress 网站中有一个自定义帖子类型“新闻”。我正在使用高级自定义字段插件将元数据添加到每个帖子。

我想创建一个新闻项目数组作为存档：

```
[2013]
    [January] => 5
[2012]
    [January] => 20
    [February] => 10
[2011]
    [April] => 30 
```

我设法让这个工作使用：

```
 global $wpdb;
    $news = $wpdb->get_results(
        "SELECT wp_posts.post_date, COUNT(wp_posts.ID) as count
         FROM $wpdb->posts
         WHERE
         wp_posts.post_type = 'news' AND
         wp_posts.post_status = 'publish' AND
         wp_posts.post_date <= CURDATE() AND
         wp_posts.post_date >= DATE_SUB(CURDATE(), INTERVAL 3 YEAR)
         GROUP BY YEAR(wp_posts.post_date), MONTH(wp_posts.post_date)
         ORDER BY wp_posts.post_date DESC", 
         ARRAY_A);

    $archive = array();
    foreach ($news as $post):
        $year = date('Y', strtotime($post['post_date']));      
        $month = date('m', strtotime($post['post_date']));     
        $month_name = date('F', strtotime($post['post_date']));
        $post['url'] = 'NOT SURE ABOUT URL';
        $archive[$year][$month_name] = $post;
    endforeach; 
```

我需要能够使用`http://example.com/2012/`and链接到特定的年份和月份`http://example.com/2012/10/`。

由于这涉及自定义帖子类型“新闻”，我不确定如何做到这一点？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-02-12T21:12:15.463

为了满足您的要求，您需要修改 Wordpress 重写，以便能够捕获自定义帖子类型的年/月/等帖子数据。

您可以使用以下代码执行此操作：

```
/**
 * Custom post type date archives
 */

/**
 * Custom post type specific rewrite rules
 * @return wp_rewrite             Rewrite rules handled by Wordpress
 */
function cpt_rewrite_rules($wp_rewrite) {
    $rules = cpt_generate_date_archives('news', $wp_rewrite);
    $wp_rewrite->rules = $rules + $wp_rewrite->rules;
    return $wp_rewrite;
}
add_action('generate_rewrite_rules', 'cpt_rewrite_rules');

/**
 * Generate date archive rewrite rules for a given custom post type
 * @param  string $cpt        slug of the custom post type
 * @return rules              returns a set of rewrite rules for Wordpress to handle
 */
function cpt_generate_date_archives($cpt, $wp_rewrite) {
    $rules = array();

    $post_type = get_post_type_object($cpt);
    $slug_archive = $post_type->has_archive;
    if ($slug_archive === false) return $rules;
    if ($slug_archive === true) {
        $slug_archive = $post_type->name;
    }

    $dates = array(
        array(
            'rule' => "([0-9]{4})/([0-9]{1,2})/([0-9]{1,2})",
            'vars' => array('year', 'monthnum', 'day')),
        array(
            'rule' => "([0-9]{4})/([0-9]{1,2})",
            'vars' => array('year', 'monthnum')),
        array(
            'rule' => "([0-9]{4})",
            'vars' => array('year'))
        );

    foreach ($dates as $data) {
        $query = 'index.php?post_type='.$cpt;
        $rule = $slug_archive.'/'.$data['rule'];

        $i = 1;
        foreach ($data['vars'] as $var) {
            $query.= '&'.$var.'='.$wp_rewrite->preg_index($i);
            $i++;
        }

        $rules[$rule."/?$"] = $query;
        $rules[$rule."/feed/(feed|rdf|rss|rss2|atom)/?$"] = $query."&feed=".$wp_rewrite->preg_index($i);
        $rules[$rule."/(feed|rdf|rss|rss2|atom)/?$"] = $query."&feed=".$wp_rewrite->preg_index($i);
        $rules[$rule."/page/([0-9]{1,})/?$"] = $query."&paged=".$wp_rewrite->preg_index($i);
    }
    return $rules;
} 
```

你会注意到我已经硬编码`news`到`$rules = cpt_generate_date_archives('news', $wp_rewrite);`代码的一部分。您可以根据需要更改此设置。

使用此代码，您应该能够导航到[http://yoursite.com/news/2013/02/](http://yoursite.com/news/2013/02/)并在特定时间接收该特定帖子类型的存档列表。

为了完整起见，我将介绍如何生成每月存档小部件以使用它。

```
/**
 * Get a montlhy archive list for a custom post type
 * @param  string  $cpt  Slug of the custom post type
 * @param  boolean $echo Whether to echo the output
 * @return array         Return the output as an array to be parsed on the template level
 */
function get_cpt_archives( $cpt, $echo = false )
{
    global $wpdb; 
    $sql = $wpdb->prepare("SELECT * FROM $wpdb->posts WHERE post_type = %s AND post_status = 'publish' GROUP BY YEAR($wpdb->posts.post_date), MONTH($wpdb->posts.post_date) ORDER BY $wpdb->posts.post_date DESC", $cpt);
    $results = $wpdb->get_results($sql);

    if ( $results )
    {
        $archive = array();
        foreach ($results as $r)
        {
            $year = date('Y', strtotime( $r->post_date ) );
            $month = date('F', strtotime( $r->post_date ) );
            $month_num = date('m', strtotime( $r->post_date ) );
            $link = get_bloginfo('siteurl') . '/' . $cpt . '/' . $year . '/' . $month_num;
            $this_archive = array( 'month' => $month, 'year' => $year, 'link' => $link );
            array_push( $archive, $this_archive );
        }

        if( !$echo )
            return $archive;
        foreach( $archive as $a )
        {
            echo '<li><a href="' . $a['link'] . '">' . $a['month'] . ' ' . $a['year'] . '</a></li>';
        }
    }
    return false;
} 
```

要使用此功能，只需提供自定义帖子类型的 slug，即：`get_cpt_archives( 'news' )`。这将返回一组唯一的年份/日期/链接，即：

```
Array
(
    [0] => Array
        (
            [month] => February
            [year] => 2013
            [link] => http://yoursite.com/news/2013/02
        )

    [1] => Array
        (
            [month] => January
            [year] => 2013
            [link] => http://yoursite.com/news/2013/01
        )

) 
```

您可以使用 a 循环遍历这些内容`foreach`并根据需要输出它们。

或者，您可以使用`get_cpt_archives( 'news', true )`which 将自动回显包装在`<li>`指向其特定存档的链接中的每个项目。

输出的格式不是你想要的，所以你必须稍微调整一下才能让它显示在

```
Year
    Month
    Month
Year
    Month 
```

您需要的格式。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-11-20T19:09:14.920

我知道这是一篇旧帖子，但是有一种更简洁的方式来完成 OP 的要求：

```
function cpt_add_rewrite_rules()
{
    $cpt = 'news';

    add_rewrite_rule($cpt.'/([0-9]{4})/([0-9]{1,2})/([0-9]{1,2})?$',
        'index.php?post_type='.$cpt.'&year=$matches[1]&monthnum=$matches[2]&day=$matches[3]',
        'top');

    add_rewrite_rule($cpt.'/([0-9]{4})/([0-9]{1,2})?$',
        'index.php?post_type='.$cpt.'&year=$matches[1]&monthnum=$matches[2]',
        'top');

    add_rewrite_rule($cpt.'/([0-9]{4})?$',
        'index.php?post_type='.$cpt.'&year=$matches[1]',
        'top');
}

add_filter('init', 'cpt_add_rewrite_rules'); 
```

# python - 来自 Python 的带有乳胶文本的 EMF 数字 - 渲染器错误

> ID：14486798
> 
> 赞同：1
> 
> 时间：2013-01-23T18:31:13.443
> 
> 标签：python, latex, .emf

我需要使用 python 从数据中生成一些数字。它必须在标签、图例和标题中包含 Latex 文本，而输出格式必须是 .emf（封装的元文件，在 M$ Word 中可读）。

```
from pylab import *
from matplotlib import rc
import matplotlib.pyplot as plt
from sympy import pretty_print as pp, latex
import os
ion()

close('all')

rc('font',**{'family':'sans-serif','sans-serif':['Helvetica']})
matplotlib.pyplot.rc('text', usetex=True)
matplotlib.rc('xtick',  labelsize = 12);
matplotlib.rc('ytick',  labelsize = 12);
matplotlib.rc('legend', fontsize  = 12);

A = loadtxt('Data.txt', unpack=True)

p1, = plot(A[0,:],A[1,:])

xlabel('time [s]', fontsize=14)
ylabel('Current i_1 [A]',fontsize=14)
title('Phase current',fontsize=14)
legend([p1],['i_1'], frameon=True, loc='upper right')
grid(True)
savefig('data.emf') 
```

错误是这样的：“ **RendererEMF 实例没有属性**”。有没有人有这个问题的解决方案？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-19T06:21:46.743

这是由于 matplotlib.textpath 模块之间缺少链接。您可以通过编辑文件 [python 库的路径]/matplotlib/backends/backend_emf.py 来解决这个问题。在此文件的标题中添加该行

```
from matplotlib import textpath 
```

在类 RendererEMF 的类定义中添加行

```
self._text2path = textpath.TextToPath() 
```

在**初始化**方法中。至少对我来说，这个修复了 emf 中的乳胶渲染。

# html - ul li 中显示的换行符

> ID：14486801
> 
> 赞同：2
> 
> 时间：2013-01-23T18:31:25.260
> 
> 标签：html, css

> **可能重复：**
> [内联块列表项中不需要的边距](https://stackoverflow.com/questions/4969082/unwanted-margin-in-inline-block-list-items)
> [如何从 HTML 中删除“不可见空间”](https://stackoverflow.com/questions/12183341/how-to-remove-invisible-space-from-html)

我有`<ul>`多个`<li>`孩子。

`li`'s 只包含一个图像，我删除了它们的所有边距。我也调用`display:inline-block;`了它们，所以它们现在显示在一行中。

但是，s 的右侧仍有一小段余量`li`。我发现这是换行符，如果我删除它，边距就会消失。但是，如果我必须删除所有换行符，那将是非常不可读的。

你能给我一个解决方案吗？

* * *

## HTML

```
<ul>

    <li><a href="#"><img src="image1.png" alt="post_heart" /></a></li>
    <li><a href="#"><img src="image2.png" alt="post_repeat" /></a></li>
    <li><a href="#"><img src="image3.png" alt="post_tag" /></a></li>
    <li><a href="#"><img src="image4.png" alt="post_share" /></a></li>

</ul> 
```

* * *

## 较少的

```
ul {
    display:inline;
    padding:none;
    margin:none;

    li {
        display:inline-block;

        padding:none;
        margin:none;

        a {
            display:block;  
            margin:none;
            border-right: 1px solid #e0e1e2;

            &:hover {
                .linearGradient(transparent, rgba(0,0,0,0.05));
            }
        }

        &:last-child {
            a {
                border:none;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T18:35:37.793

“边距”实际上是空格（制表符、空格或换行符的某种组合）。您可以通过将其注释掉来保留格式。

```
<ul><!--
    --><li><img /></li><!--
    --><li><img /></li><!--
    --><li><img /></li><!--
    --><li><img /></li><!--
    --><li><img /></li><!--
--></ul> 
```

另见： [http ://css-tricks.com/fighting-the-space-between-inline-block-elements/](http://css-tricks.com/fighting-the-space-between-inline-block-elements/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T18:34:27.303

确保在 li 上没有边距。

我还使用 inline-block 遇到了这个问题，在你的标记中，你不能在 li 元素之间有任何空白，否则它会呈现它。看起来丑陋，但工作。

例如**这个**

```
<ul>
<li></li><li></li><li></li><li></li><li></li><li></li>
</u> 
```

而不是这个

```
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:34:35.487

只是让他们`float:left`。我认为当它们`display:inline`存在时，总会有大约 3px 的空间。

# python - Python 的 coerce() 是做什么用的？

> ID：14486802
> 
> 赞同：24
> 
> 时间：2013-01-23T18:31:25.190
> 
> 标签：python, type-conversion, python-2.x, built-in

Python 的内置`coerce`函数有哪些常见用途？如果我不知道[文档](http://docs.python.org/2/library/functions.html#coerce)`type`中的数值，我可以看到应用它，但是否存在其他常见用法？我猜想在执行算术计算时也会调用它，*例如*. 它是一个内置函数，所以大概它有一些潜在的常见用法？`coerce()` *`x = 1.0 +2`*

 ** * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-24T07:48:30.043

[它是早期python](http://docs.python.org/release/1.5.2/ref/numeric-types.html)的遗留物，它基本上使一个数字元组成为相同的基础数字类型，例如

```
>>> type(10)
<type 'int'>
>>> type(10.0101010)
<type 'float'>
>>> nums = coerce(10, 10.001010)
>>> type(nums[0])
<type 'float'>
>>> type(nums[1])
<type 'float'> 
```

它还允许对象像旧类中的数字一样
（这里使用它的一个不好的例子是......）

```
>>> class bad:
...     """ Dont do this, even if coerce was a good idea this simply
...         makes itself int ignoring type of other ! """
...     def __init__(self, s):
...             self.s = s
...     def __coerce__(self, other):
...             return (other, int(self.s))
... 
>>> coerce(10, bad("102"))
(102, 10) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-16T04:27:57.507

Python核心编程说：

> 函数 coerce() 提供程序员不依赖 Python 解释器，而是自定义两种数值类型的转换。”

例如

```
>>> coerce(1, 2)
(1, 2)
>>>
>>> coerce(1.3, 134L)
(1.3, 134.0)
>>>
>>> coerce(1, 134L)
(1L, 134L)
>>>
>>> coerce(1j, 134L)
(1j, (134+0j))
>>>
>>> coerce(1.23-41j, 134L)
((1.23-41j), (134+0j)) 
```*

# javascript - 了解触摸事件

> ID：14486804
> 
> 赞同：81
> 
> 时间：2013-01-23T18:31:30.353
> 
> 标签：javascript, mobile, touch

我正在尝试使我的一些库与触摸设备一起使用，但我很难弄清楚它们是如何被支持的以及它们是如何工作的。

基本上，有[5 个触摸事件](https://developer.mozilla.org/en-US/docs/DOM/Touch_events)，但似乎移动浏览器之间仅就事件达成共识`touchstart`（duh）。我创建了一个[小提琴](http://jsfiddle.net/cpUsA/4/)作为测试用例。

我已经在装有 Android 4 的 Galaxy Note 上对此进行了测试，但您也可以使用桌面浏览器查看链接。

目标是试图弄清楚如何处理轻击、双击和长击。没有什么花哨。

基本上，这就是发生的事情：

**Android 股票浏览器**不会触发触摸事件。它只是尝试通过连续点击、触发和事件来模拟鼠标点击`mousedown`，`mouseup`但`click`双击只是放大和缩小页面。

**当手指触摸屏幕时，**Chrome for Android 会触发 touchstart 事件。**如果它发布得足够快，它会触发 then `mousedown`、`mouseup`和`touchend`finally`click`事件。**

 **在*长*按的情况下，大约半秒后它会触发`mousedown`和`mouseup`，`touchend`当手指抬起时，`click`最后没有事件。

如果你*移动你的手指*，它会触发一个`touchmove`事件几次，然后它会触发一个`touchcancel`事件，之后什么都不会发生，甚至`touchend`在抬起手指时也不会发生任何事件。

*双击*触发放大/缩小功能，但在事件方面它会触发组合-`touchstart`两次`touchevent`，没有触发鼠标事件。

**Firefox** for Android 会正确触发`touchstart`事件，并且在短按触发的情况下,`mousedown`和之后。`mouseup``touchend``click`

在*长*按的情况下，它会触发`mousedown`，`mouseup`最后是`touchend`事件。对于这些事情，Chrome 也是如此。

但是如果你*移动你的手指*，如果连续触发`touchmove`（正如人们所期望的那样）但是当手指离开带有事件监听器的元素时它不会触发事件，并且*当*手指离开浏览器视口时它不会触发事件.`touchleave``touchcancel`

对于*双击*，它的行为就像 Chrome。

**Opera Mobile**与 Chrome 和 Firefox 一样，只需轻按一下，但长按会激活某种我真的想禁用的共享功能。如果您移动手指或双击，它的行为就像 Firefox。

**Chrome beta**对短按执行通常的操作，但在长按的情况下，它不再触发`mouseup`事件，只是`touchstart`，然后`mousedown`在半秒后，然后`touchend`当手指抬起时。当手指移动时，现在它的行为类似于 Firefox 和 Opera Mobile。

在*双击*的情况下，它不会在缩小时触发触摸事件*，*而只会在放大时触发。

Chrome 测试版显示出最奇怪的行为，但我真的不能抱怨，因为它是测试版。

**问题是**：在最常见的触摸设备浏览器中，是否有一种简单的方法来尝试检测短按、长按和双击？

太糟糕了，我无法在带有 Safari 的 iOS 设备或 Windows Phone 7/Phone 8/RT 的 IE 上对其进行测试，但如果你们中的一些人可以的话，我们将非常感谢您的反馈。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-09-06T18:34:27.853

如果您还没有，我建议您阅读 Hammer.js 的源代码

[https://github.com/hammerjs/hammer.js/blob/master/hammer.js](https://github.com/hammerjs/hammer.js/blob/master/hammer.js)

在注释和代码之间大约有 1400 行，有很棒的文档并且代码很容易理解。

你可以看到作者是如何选择解决很多常见的触摸事件的：

> 按住，点击，双击，拖动，dragstart，dragend，dragup，dragdown，dragleft，dragright，swipe，swipeup，swipedown，swipeleft，swiperight，transform，transformstart，transformend，旋转，pinch，pinchin，pinchout，touch（手势检测开始） , release（手势检测结束）

我认为阅读源代码后，您将更好地理解触摸事件的工作原理以及如何识别浏览器能够处理的事件。

[http://eightmedia.github.io/hammer.js/](http://eightmedia.github.io/hammer.js/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-09-13T18:51:57.213

有一个非常棒的资源[https://patrickhlauke.github.io/touch/tests/results/](https://patrickhlauke.github.io/touch/tests/results/)详细介绍了数量惊人的浏览器中的事件顺序。它似乎也定期更新（2016 年 9 月，最后一次更新是 2016 年 8 月）。

**要点是，**基本上所有的触发器`mouseover`和相关事件；大多数还触发触摸事件，*通常*在之前完成（到达`touchend`）`mouseover`然后继续`click`（除非对页面内容的更改取消了这一点）。谢天谢地，那些尴尬的例外相对较少（第 3 方 android 浏览器和黑莓 playbook）。

该链接资源的详细程度令人印象深刻，以下是许多操作系统、设备和浏览器测试中的前三个示例：

[![在此处输入图像描述](../Images/3881af3a1b50ab75c0ba27049fc6c60c.png)](https://i.stack.imgur.com/wjIam.png)

总结一些关键点：

## 移动浏览器

*   所有列出的浏览器都会`mouseover`在第一次点击时触发。只有某些 Windows Phone 浏览器会在第二次点击时触发它。
*   全部触发`click`。它没有指定`click`如果`mouseover`更改页面则取消（我相信大多数人都会这样做）
*   大多数浏览器在和`mouseover`之后触发。这包括 iOS7.1 Safari、库存 Android、Chrome、Opera 和 Firefox for Android，以及一些（并非所有 Windows 手机浏览器）`touchstart``touchend`
*   几个 Windows Phone 浏览器（所有 Windows 8 / 8.1 和一个 10 版本）和几个第 3 方 Android 浏览器（Dolphin、Maxathon、UC）`mouseover` *在* `touchstart`和`touchend`.
*   只有 Blackberry Playbook在和`mouseover`之间触发`touchstart``touchend`
*   只有 Opera Mini 和 Puffin（第 3 方 Android 浏览器）缺少`touchstart`或`touchend`.

## 桌面浏览器

*   桌面版 Chrome 和 Opera 的最新版本表现得与移动版类似，`touchstart`其次`touchend`是`mouseover`.
*   Firefox 和 Microsoft 浏览器（IE <=11 和许多版本的 Edge）不会触发任何`touchstart`和`touchend`事件。
*   Mac 上没有数据，但考虑到 Mac 触摸屏界面的稀缺性，`touchstart`可能没有 Ma 浏览器支持。`touchend`

与辅助技术相结合的浏览器上还有大量数据。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-18T15:19:38.440

这是我对 Android 4.3 上触摸和鼠标事件的最新观察

## Opera、Firefox 和 Chrome 似乎有标准行为

1.  滑动时（touchstart-touchmove-touchend）：

    1.  没有鼠标事件（不包括鼠标悬停）触发。
    2.  只有当 touchstart 和 touchend 出现在同一个元素上时，鼠标悬停才会触发。(touchstart-touchmove-touchend-mouseover)
    3.  如果在 touchstart 上阻止了默认设置：默认的滑动行为不起作用。鼠标事件触发不会发生任何变化。
2.  点按（touchstart-touchend）：

    1.  所有鼠标事件 mouseover-mousemove-mousedown-mouseup-click 在延迟后触发
    2.  如果在 touchstart 上阻止默认设置：仅触发鼠标悬停。

**Android 默认浏览器有一些非标准行为**：

1.  Mouseover 在 touchstart 之前触发，这意味着 mouseover 总是触发。
2.  所有鼠标事件都在 Tap 时触发，即使在 touchstart 上阻止了默认设置。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-23T18:34:59.543

是的，您可以启动一个计时器`touchstart`并结束它，`touchend`然后从那里做出选择。

你也可以让......比如说滑动，我的触发`touchmove`你可以获得“手指”的坐标，看看我在`touchend`被触发之前走了多少。

我不知道是否有比使用触摸事件库更简单的方法，但我想你可以很容易地为简单的“点击”、“双击”、“滑动”事件编写一个。**

# mysql - mysql排序顺序，需要稍微不同的结果

> ID：14486807
> 
> 赞同：2
> 
> 时间：2013-01-23T18:31:35.033
> 
> 标签：mysql, sorting, alpha, numeric

我有一个 varchar 列，我目前正在使用排序：ORDER BY (col_name+0)

此列包含数字和非数字，排序的结果是这样的：

```
D3
D111
M123-M124
M136
4
9
10
25
37b
132
147-149
168b
168ca 
```

这种排序对于我们的应用程序来说几乎是完美的，但有一个例外：我们希望以字母开头的项目显示在以数字开头的项目之后。这是理想的结果：

```
4
9
10
25
37b
132
147-149
168b
168ca
D3
D111
M123-M124
M136 
```

我希望这可以在 select 语句中实现，而不是需要在 select 之后再次遍历代码中的所有内容。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:39:11.137

你可以使用这个：

```
ORDER BY
  col_name regexp "^[^0-9]",
  case when col_name regexp "^[0-9]" then col_name + 0
       else mid(col_name, 2, length(col_name )-1) + 0 end,
  col_name 
```

这会将以数字开头的行放在顶部。如果 col_name 以数字开头，我将按它的数值排序，如果不是，我将按从第二个字符开始的字符串的数值排序。

# asp.net - 在 aspx 中更新 DLL

> ID：14486811
> 
> 赞同：0
> 
> 时间：2013-01-23T18:31:50.280
> 
> 标签：asp.net

我是一位老 ASP 程序员，最近接受了一份拥有 ASP.NET 的工作。我有一个顶部有这个的 aspx 文件：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Default.Master" AutoEventWireup="true"
CodeBehind="List.aspx.cs" Inherits="itnola.List" %> 
```

而我最感兴趣的领域是这行代码：

```
<asp:DropDownList ID="dplDistrict" runat="server" Width="205" DataValueField="districtID"
                                DataTextField="districtname"> 
```

数据库中有一个名为区的表，如果我对该表进行修改，它会在此下拉列表中显示更改。但是，下拉菜单中有一个额外的条目，我认为它们已经硬编码。

由于不熟悉 ASP.NET，我寻找了一个 List.aspx.cs 文件，但在服务器上的任何地方都找不到它。我确实在我怀疑可能与此有关的 bin 文件夹中找到了一个 itnola.dll 文件。如果我从我的 Visual Basic 日子里没记错的话，这个 dll 文件是“编译的”，因此不可编辑，对吗？如何删除下拉列表中的这一行？

# java - AES加密与openssl解密使用java

> ID：14486814
> 
> 赞同：13
> 
> 时间：2013-01-23T18:32:05.407
> 
> 标签：java, encryption, openssl, base64, aes

我必须使用 openssl 命令行或 C api 加密 xml 文件。输出应为 Base64。

将使用 java 程序进行解密。此程序由客户提供，无法更改（他们将此代码用于旧应用程序）。正如您在下面的代码中看到的，客户提供了一个密码短语，因此将使用 SecretKeySpec 方法生成密钥。

Java代码：

```
// Passphrase
private static final byte[] pass = new byte[] { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '0','1', '2', '3', '4', '5' };

public static String encrypt(String Data) throws Exception {
    Key key = generateKey();
    Cipher c = Cipher.getInstance("AES/ECB/PKCS5Padding");
    c.init(Cipher.ENCRYPT_MODE, key);
    byte[] encVal = c.doFinal(Data.getBytes());
    String encryptedValue = new BASE64Encoder().encode(encVal);
    return encryptedValue;
}

public static String decrypt(String encryptedData) throws Exception {
    Key key = generateKey();
    Cipher c = Cipher.getInstance("AES/ECB/PKCS5Padding");
    c.init(Cipher.DECRYPT_MODE, key);
    byte[] decordedValue = new BASE64Decoder().decodeBuffer(encryptedData);
    byte[] decValue = c.doFinal(decordedValue);
    String decryptedValue = new String(decValue);
    return decryptedValue;
}

private static Key generateKey() throws Exception {
    Key key = new SecretKeySpec(pass, "AES");
    return key;
} 
```

我已经测试了几个命令，例如：

```
 openssl enc -aes-128-ecb -a -salt -in file.xml -out file_enc.xml -pass pass:123456789012345
    openssl enc -aes-128-ecb -a -nosalt -in file.xml -out file_enc.xml -pass pass:123456789012345 
```

但是没有一个给定的输出是使用 java 成功解密的。出于测试目的，我使用给定的 java 代码进行加密，结果当然与 openssl 中的不同。

有没有办法使用 openssl C api 或命令行来加密数据，以便可以使用给定的 java 代码成功解密？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T18:54:11.517

Java`SecretKeySpec`直接使用密码 ASCII 字节作为密钥字节，而 OpenSSL 的`-pass pass:...`方法使用[密钥派生函数从密码中](https://openssl.org/docs/crypto/EVP_BytesToKey.html)**派生**密钥，从而以安全的方式将密码转换为密钥。您可以尝试在 Java 中进行相同的密钥派生（如果我正确解释了您的问题，您可能无法做到这一点），或者使用 OpenSSL 的选项来传递密钥（作为十六进制字节！）而不是密码。`-K`

你可以在[那里](https://stackoverflow.com/a/55884564/2873507)找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-01-29T13:12:15.593

补充一点。我正在努力解决同样的问题。我能够使用以下设置从 Java 解密 AES-128 加密消息。

我曾经`openssl`加密数据：

```
openssl enc -nosalt -aes-128-ecb -in data.txt -out crypted-aes.data -K 50645367566B59703373367639792442 
```

正如@Daniel 建议的那样，改变游戏规则的是使用该`-K`属性。让我们解密生成的文件的 Java 配置如下：

```
final byte[] aesKey = "PdSgVkYp3s6v9y$B".getBytes(StandardCharsets.UTF_8);
final SecretKeySpec aesKeySpec = new SecretKeySpec(aesKey, "AES");
Path path = Paths.get("src/test/resources/crypted-aes.data");
final byte[] cryptedData = Files.readAllBytes(path);
final Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5Padding");
cipher.init(Cipher.DECRYPT_MODE, aesKeySpec);
final byte[] decryptedMsg = cipher.doFinal(cryptedData); 
```

当 hex key `50645367566B59703373367639792442`、它的`String`表示`"PdSgVkYp3s6v9y$B"`和`AES/ECB/PKCS5Padding`对齐在一起时，魔法就会发生。

# html - 我正在尝试在我的页面上创建一个锚点而不更改 URL。有谁知道我该怎么做？

> ID：14486819
> 
> 赞同：0
> 
> 时间：2013-01-23T18:32:23.033
> 
> 标签：html, facebook

解释：我在 facebook 插件之前插入了一个锚点用于评论，并在文本中间插入了一个指向锚点评论的链接，所以当用户点击链接时，他/她会直接跳转到 facebook 评论，但它保持在 URL 中添加#comment，facebook 插件将其视为另一个页面，之前的所有评论都消失了。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T19:27:32.997

您可以仅在 HTML 中执行此操作。将此添加到您的文档中`<head>`：

```
<link rel="canonical" href="http://website.com/path/to/page" /> 
```

Facebook 将意识到这一点，`/path/to/page`并且`/path/to/page#comments`是同一个对象，并将在两者上显示相同的评论。

如果您使用的是 CMS，请小心。每个独特的网页都需要有一个独特的规范 url。

您还可以`og:url`在页面的元数据中指定规范 url。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:36:38.000

我认为您只需将 href 设置为“javascript: void();” 或类似的东西。

# youtube-api - 503 线程时服务不可用？

> ID：14486820
> 
> 赞同：3
> 
> 时间：2013-01-23T18:32:27.810
> 
> 标签：youtube-api

我通过具有 5 个并发线程的 Youtube API V3 获得了一些信息，并且在启动后我有一些“503 服务不可用”响应。当我重新启动相同的视频时，它可以正常或不正常......所以我这边似乎没有问题。

我的配额还可以（每秒 30k ......）

那么问题出在哪里？？

## 谢谢

我只使用列表视频 API，例如：

```
$ time curl --silent "https://www.googleapis.com/youtube/v3/videos?id=AX7Z5eqosxM&part=id%2Csnippet%2CcontentDetails%2Cplayer%2Cstatistics%2Cstatus%2CtopicDetails&key={MY_API_KEY}"
{
 "error": {
  "errors": [
   {
    "domain": "global",
    "reason": "backendError",
    "message": "Backend Error"
   }
  ],
  "code": 503,
  "message": "Backend Error"
 }
}
real    0m30.692s
user    0m0.024s
sys 0m0.024s 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T17:55:22.507

我不认为你做错了什么——只要你在正常的配额限制内，v3 中没有什么固有的东西可以阻止大量的调用成功。

我也看到了其他一些关于视频的[报告](https://code.google.com/p/gdata-issues/issues/detail?id=4020)。公开的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:16:27.877

谷歌开发有一个错误响应页面来解释不同的错误代码

[https://developers.google.com/analytics/devguides/reporting/core/v3/coreErrors](https://developers.google.com/analytics/devguides/reporting/core/v3/coreErrors)

在此页面中，他们还提供了一些实现指数退避，这可能对您有所帮助。但我同意 Jeff 的观点，我们除了等待之外别无他法。

# java - 如何使用 HttpURLConnection 对象从远程服务器获取响应？

> ID：14486821
> 
> 赞同：0
> 
> 时间：2013-01-23T18:32:44.787
> 
> 标签：java, httpurlconnection

我正在尝试使用`HttpURLConnection`该类的实例向远程服务器发送 HTTP POST 请求。虽然，我能够获得响应代码和响应消息，但是当我尝试将输入流写入 a`StringBuffer`时，我实际上无法读取任何行。

当我分析从*WireShark*发送的数据包时，我注意到远程服务器正在发送完整的响应。关于为什么我无法在 Java 程序中看到它的唯一猜测是因为我尝试从 InputStream 读取的时间太晚了。

那么，如何使用我的对象从远程服务器读取即时的**完整响应？**`HttpURLConnection`下面是我正在使用的代码：

```
HttpURLConnection conn = null;
String urlStr = "...";
URL url = null;
try
{
    url = new URL(urlStr); 
    conn = (HttpURLConnection) url.openConnection();
    conn.setRequestMethod("POST");
    conn.setDoInput(true);
    conn.setDoOutput(true);
...
    BufferedReader rd = new BufferedReader(
                new InputStreamReader(conn.getInputStream()));
    StringBuilder sb = new StringBuilder();
    String line;
    while ((line = rd.readLine()) != null)
    {
         sb.append(line);
    }
    rd.close();
...
}... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:14:33.423

好的没关系。事实证明，我正在寻找的是 HTTP 响应的标头。所以，我通过查看它的标题得到了我需要的东西。::掌心::

# php - 解析错误mysql 2个变量

> ID：14486826
> 
> 赞同：0
> 
> 时间：2013-01-23T18:33:00.617
> 
> 标签：php, mysql

我的代码是这个

```
$newentry = "
    UPDATE url 
    FROM auction_media 
    JOIN auctions ON auction_media.auction_id = auctions.auction_id                                            
    SET media_url = '$row2['url']/$match[0]' 
    WHERE media_type =  '3'"; 
```

我得到的错误是

解析错误：语法错误，意外的 T_ENCAPSED_AND_WHITESPACE，需要 T_STRING 或 T_VARIABLE 或 T_NUM_STRING

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:34:25.510

```
$newentry = "UPDATE `url` FROM `auction_media` JOIN `auctions` ON `auction_media.auction_id` = `auctions.auction_id` SET `media_url` = '".$row2['url']."/".$match[0]."' WHERE `media_type` =  '3'"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:34:45.927

这个片段似乎是错误的：

```
SET media_url = '$row2['url']/$match[0]' 
```

更正如下：

```
SET media_url = '" . $row2['url'] . "/" . $match[0] . "' 
```

试试这个：

```
 $newentry = "UPDATE url FROM auction_media JOIN auctions ON auction_media.auction_id = auctions.auction_id SET media_url = '" . $row2['url'] . "/" . $match[0] . "' WHERE media_type =  '3'"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T18:35:02.743

假设该查询将实际工作：

```
$newentry = "UPDATE url
    FROM auction_media
    JOIN auctions
        ON auction_media.auction_id = auctions.auction_id
    SET media_url = '" . $row2['url'] . '/' . $match[0] . "'
    WHERE media_type =  '3'"; 
```

# java - API 推特限速

> ID：14486831
> 
> 赞同：0
> 
> 时间：2013-01-23T18:33:35.167
> 
> 标签：java, twitter, twitter4j

这是我正在尝试做的事情：

我有一个 twitter 用户 ID 列表，我需要为每个用户检索他的追随者 ID 和他的朋友 ID 的完整列表。我不需要其他任何东西，没有网名等。

我正在使用 twitter4j 顺便说一句

这是我的做法：

对于每个用户，我正在执行以下代码以获取他的关注者 ID 的完整列表

```
long lCursor = -1
do{
    IDs response = t.getFollowersIDs(id, lCursor);
    long tab[] = response.getIDs();
    for(long val : tab){
        myIdList.add(val);
    }
    lCursor = response.getNextCursor(); 
}while(lCursor != 0); 
```

我的问题 ：

根据此页面：[https ://dev.twitter.com/docs/api/1.1/get/followers/ids](https://dev.twitter.com/docs/api/1.1/get/followers/ids)

getFollowersIDs() 的请求速率限制为 15，考虑到此方法最多返回 5000 个 ID，这意味着只能获得 15*5000 个 ID（如果关注者少于 5000 个，则为 15 个用户）。

这对于我正在尝试做的事情来说真的是不够的。

难道我做错了什么 ？有什么解决方案可以改善吗？（甚至轻微）

谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T19:01:21.937

**v1.1 中该端点的速率限制是每个访问令牌**每 15 分钟 15 次调用。有关限制的更多信息，请参阅[https://dev.twitter.com/docs/rate-limiting/1.1](https://dev.twitter.com/docs/rate-limiting/1.1)。

考虑到这一点，如果您为每个用户都有一个访问令牌，您应该能够每 15 分钟为每个访问令牌获取多达 75,000 (15*5000) 个关注者 ID。

如果您只有一个访问令牌，不幸的是，您将受到您描述的方式的限制，并且只需要在您的应用程序达到速率限制时进行处理，并在 15 分钟结束后继续处理。

# java - 为什么集合不从排序列表中删除重复项？

> ID：14486833
> 
> 赞同：0
> 
> 时间：2013-01-23T18:33:41.890
> 
> 标签：java, groovy

为什么集合不从排序列表中删除重复项？我已按第一行显示的升序对日期进行了排序，但该集合并未删除重复项。这是为什么 ？程序打印：
[Mon Apr 20 12:27:47 CDT 2009, Mon Apr 20 12:27:47 CDT 2009, Sun Dec 20 12:27:47 CST 2009] [Sun Dec 20 12:27:47 CST 2009, 2009 年 4 月 20 日星期一 12:27:47 CDT 2009，4 月 20 日星期一 12:27:47 CDT 2009]

不应该创建一个集合从集合中删除重复的日期吗？

```
 def void testLoadDoc()
     {
     Date date1 = getCurrentDate(3,20,2009)
     Date date2 = getCurrentDate(11,20,2009)
     Date date3 = getCurrentDate(3,20,2009)

     List<Date> dates = new ArrayList<Date>();
     dates.add(date2);
     dates.add(date1);
     dates.add(date3);

     Collections.sort(dates, new CurrencyDateComparator());
     Set uniqueDates = new HashSet(dates)

     println dates
     println uniqueDates

 }

 private Date getCurrentDate(int month, int day, int year)
 {

     Calendar cal = Calendar.getInstance();
     cal.set(YEAR, year);
     cal.set(MONTH, month);
     cal.set(DAY_OF_MONTH, day);
     return cal.getTime();

 }
}

class CurrencyDateComparator implements Comparator
{
    /* (non-Javadoc)
     * @see java.util.Comparator#compare(java.lang.Object, java.lang.Object)
     */
    public int compare(Object arg0, Object arg1)
    {
        Date p = (Date) arg0;
        Date q = (Date) arg1;

        if (p.before(q))
        {
            return -1;
        }
        else if (p.after(q))
        {
            return 1;
        }
        else
        {
            return 0;
        }
    }

    public boolean equals(Object o)
    {
        if (o instanceof CurrencyDateComparator)
        {
            CurrencyDateComparator c = (CurrencyDateComparator) o;

            return this.equals(o);
        }
        else
        {
            return false;
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:35:18.643

您所有的日期都有不同的毫秒值，这些值不会打印在您的跟踪中。将毫秒设置为 0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:35:56.877

## 第一的

`java.util.Date`带有时间信息，[您需要将时间信息归零，](http://docs.oracle.com/javase/6/docs/api/java/util/Calendar.html#clear%28%29)然后设置您想要设置的内容或从您的自定义比较中排除时间部分`Comparator`。

# 第二

你的习惯`Comparator`是错误的和多余的。`java.util.Date`已经实现`Comparable`，因此您无需再次比较日期，只需`.compare()`在第一个`Date`实例上调用第二个实例作为参数。

# 第三

还要记住，`MONTHS`在 Caledar 中是零。一月 ==`0`不是`1`。

# 第四

永远不要依赖默认值`toString()`on `java.util.Date`，始终使用`SimpleDateFormatter`将整个时间戳显示到毫秒的实例，包括`TimeZone`( `yyyy-MM-dd'T'HH:mm:ssZ`)，最好是 ISO-8601 和`UTC`TimeZone 以确定性行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:38:08.327

当您使用`Calendar.getInstance()`它时，它将“现在”返回到毫秒精度。更改 YMD 字段并不会清除其中的任何内容，因此您的两个日期可能相差一毫秒或二十，这不包含在`toString()`您看到输出的默认实现中。

如果要将日历设置为特定时间，最简单的方法是`clear()`在开始设置字段之前先进行设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T18:39:06.660

当您调用 时`Calendar.getInstance()`，您会`Calendar`使用当前时间初始化。这包括小时、分钟、秒和毫秒。调用[`clearTime()`](http://groovy.codehaus.org/groovy-jdk/java/util/Calendar.html#clearTime%28%29)它来将它们归零。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T18:43:33.003

您可以改用此集合

```
Set<Date> dates = new TreeSet<Date>(CurrencyDateComparator.INSTANCE);
dates.add(date2);
dates.add(date1);
dates.add(date3);

enum CurrencyDateComparator implements Comparator<Date> {
    INSTANCE;

    static final long MILLI_PER_DAY = 86400000L;
    public int compare(Date d1, Date d2) {
        // older versions of Java can use Double.compare()
        return Long.compare(d1.getTime() / MILLIS_PER_DAY, d2.getTime() / MILLIS_PER_DAY);
    }
} 
```

# function - Clojure 递归函数执行时间

> ID：14486836
> 
> 赞同：2
> 
> 时间：2013-01-23T18:33:45.983
> 
> 标签：function, recursion, time, clojure

我正在用 clojure 编写一个网络爬虫，它需要恒定的时间，与我赋予该函数的深度无关。这就是函数本身。（它使用的是[clojure soup](https://github.com/mfornos/clojure-soup)，但我认为这无关紧要）

```
(defn crawl [source current-depth max-depth]
    (if (= current-depth 0) (write-to-hf "{" false))
    (let [targets (get-links source)]
        (write-to-hf (str ":" source " " (seq targets) "\n") true)
        (if (< current-depth max-depth)
            (map crawl targets (repeat (inc current-depth)) (repeat max-depth))
            (if (= current-depth 0)
                (do (write-to-hf "}" true)
                 targets)
                targets)))) 
```

（write-to-hf 是将数据写入文件的函数，所以我猜它也与问题无关。）

当我在 REPL 中测试我的函数时，写：

```
(crawl "http://bg.wikipedia.org" 0 1) 
```

打印所有链接大约需要一个小时，但如果我将结果放入 var 中，则需要更少的时间。

```
(def a (crawl "http://bg.wikipedia.org" 0 1)) 
```

这对我来说看起来很正常，因为 I/O 操作是最耗时的，但我尝试测试将结果放入具有更多递归深度的 var 需要多少时间，并且它似乎是恒定的。甚至在做：

```
((crawl "http://bg.wikipedia.org" 0 100000000000)) 
```

需要同样的时间。

有人能解释一下为什么这是一个常数吗？我无法想象如何在不到一秒钟的时间内从维基百科（这是一个巨大的网站，每个页面上都有数百个链接）获取数十亿和更多页面的链接。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T18:46:06.300

此行正在生成一个延迟的爬网链接序列：

```
(map crawl targets (repeat (inc current-depth)) (repeat max-depth)) 
```

实际的抓取发生在打印链接时（在这种情况下由 REPL），因此当您将它们保存到 var 并且不查看它们时，没有完成任何工作。什么都不做需要大约恒定的时间。将该行包装在调用中`doall`以使其不懒惰

# ruby-on-rails - 来自数据库验证错误

> ID：14486841
> 
> 赞同：0
> 
> 时间：2013-01-23T18:34:13.593
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, sorcery

如果用户例如输入已使用的用户名或电子邮件，如何显示模型验证中的错误。我正在使用的验证确实有效，如果验证阻止它被创建，页面会很好地呈现。但是，我如何向用户显示错误。页面上的位置无关紧要。我知道我可以使用 :message => “用户名/电子邮件已在使用中”。但是我如何使它更具体，如何使错误直接来自验证检查。

```
class User < ActiveRecord::Base
  authenticates_with_sorcery! 

  attr_accessible :username, :password, :email

  validates_presence_of :email
  validates_presence_of :password
  validates_presence_of :username
  validates_uniqueness_of :email
  validates_uniqueness_of :username
  validates_uniqueness_of :password
  validates_confirmation_of :password

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:44:21.753

当您尝试保存或创建记录时，验证错误将被保存。

您可以使用`@user.errors`来获取验证错误并显示它们。您可以在[Rails 指南中查看验证](http://guides.rubyonrails.org/active_record_validations_callbacks.html#working-with-validation-errors)的一些详细信息。

这些将使用默认消息，您可以通过更改来改进`config/locales/en.yml`

一些示例代码：

```
<% @user.errors.full_messages.each do |msg| %>
  <div class="error"><%= msg %></div>
<% end %> 
```

例如，如果您想自定义电子邮件的验证消息，请打开`config/locales/en.yml`并添加以下内容`en:`

```
 activerecord:
    errors:
      models:
        user:
          attributes:
            email:
              taken: "has already been taken" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:40:42.237

[validates_uniqueness_of](http://apidock.com/rails/ActiveRecord/Validations/ClassMethods/validates_uniqueness_of)

```
Validates whether the value of the specified attributes are unique across the system. 
Useful for making sure that only one user can be named “davidhh”. 
```

它还可以根据范围参数验证指定属性的值是否唯一：

```
class Person < ActiveRecord::Base
  validates_uniqueness_of :user_name, :scope => :account_id
end 
```

**编辑**

我误读了这个问题。丹尼尔的回答是对的。[例子](http://guides.rubyonrails.org/active_record_validations_callbacks.html#working-with-validation-errors)

# .net - .NET 对可移动驱动器的反射

> ID：14486848
> 
> 赞同：1
> 
> 时间：2013-01-23T18:34:22.443
> 
> 标签：.net, vb.net, reflection

我们有以下设置：一个 IPlugin 接口，由主可执行文件公开。主要可执行文件（和插件）位于可移动驱动器上。

我们正在尝试加载插件目录中的每个 dll：

```
For Each Type As Type In asm.GetTypes()
     Trace(Type.ToString())
     If GetType(IPlugin).IsAssignableFrom(Type) Then
         loadedPlugin = asm.CreateInstance(Type.Namespace & "." & Type.Name)
     End If
Next 
```

但是，它似乎没有找到实现 IPlugin 的匹配类，尽管我可以看到有一个。如果我试图通过直接调用 CreateInstance 来强制它加载类，我会得到一个 ReflectionTypeLoadException。

但是，当我在本地驱动器上运行应用程序时，自动检测过程确实可以完美运行。

我知道可移动/网络驱动器上的 .NET 应用程序可能存在安全问题，但不会引发安全异常。我还安装了 .NET Framework 4.0。

插件 DLL 是针对最新版本的插件接口构建的，因此它似乎不是版本不匹配。

操作系统是 Windows 7 x64。

GetType(IPlugin).AssemblyQualifiedName: App.IPlugin, MainApp, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null Type.GetInterface("IPlugin").AssemblyQualifiedName: App.IPlugin, MainApp, Version=1.0.0.0, Culture =中性，PublicKeyToken=null

他们都有相同的结果。

*解决方法：如果我将插件程序集复制到本地驱动器，它确实可以工作。但是，这不是一个很好的解决方案。也许会出现更好的东西。*

我可能不得不指出的另一件事：.NET 应用程序本身主要是一个插件，它被 VB6 应用程序本机调用。

有人能帮我吗？

非常感谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T15:41:56.367

解决方法“将插件复制到本地驱动器上的临时目录”确实有效。

# ios - NSLocalizedString 有时会加载字符串，但并非总是如此

> ID：14486857
> 
> 赞同：7
> 
> 时间：2013-01-23T18:34:50.763
> 
> 标签：ios, objective-c, nslocalizedstring

NSLocalizedString 仅在我取回所引用键的预期值的一半时间内起作用。其他时候，我取回 NSLocalizedString 中指定的键名，并且在每次运行时始终如一地发生。

目前，我目前只支持英语。

我打电话给：

```
NSString *someText = NSLocalizedString(@"mystring.keyname", nil); 
```

en.lproj/Localizable.strings 的内容：

```
"mystring.keyname" = "Hello there!"; 
```

当它不能正常工作时，`someText's`值为`mystring.keyname`.

这是我测试可靠性的方法：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    NSBundle *bundle = [NSBundle bundleForClass:[self class]];
    NSLog(@"Strings file: %@", [bundle pathForResource:@"Localizable" ofType:@".strings"]);
    NSLog(@"Localizations: %@", [bundle localizations]);
    NSLog(@"Local Dict: %@", [bundle localizedInfoDictionary]);
    NSLog(@"localizedStringForKey: %@", [bundle localizedStringForKey:@"mystring.keyname"value:@"Wha happened?" table:nil]);
    NSLog(@"Localized String: %@", NSLocalizedString(@"mystring.keyname", @"Are you sure you want to start a new game?"));
} 
```

这将每隔一次运行打印出预期值：

```
Run #1:
Local Dict: (null)
localizedStringForKey: Hello there!
Localized String: Hello there!

Run #2:
Local Dict: (null)
localizedStringForKey: Wha happened?
Localized String: mystring.keyname 
```

我的文件布局如下：

```
WORKSPACE_DIR/ 
  my_workspace_name.xcworkspace
  PROJECT_DIR/
    - my_project_name.xcodeproj
    RESOURCES_DIR/
      - en.lproj/
          Localizable.strings 
```

XCode 的项目级设置：

```
1) Build Phases has Localizable.strings listed in the "Copy Bundle Resources".

2) Build Settings:
   Convert Copied Files => YES
   Property List Output Encoding => binary
   Strings file Output Encoding => UTF-16        

3) Info.plist's: CFBundleDevelopmentRegion => 'en' 
```

Localizable.strings 配置为 UTF-16，尽管我在文件检查器中没有看到选择了字符串文件的文本设置选项。但是我已经通过在 TextWrangler 中打开文件来验证编码类型，该文件确实将编码显示为带有 Unix LF 的 Unicode (UTF-16)。

关于如何让它一直工作的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-10-07T18:45:50.460

如果您的可本地化文件中有任何额外的分号，它会构建但无法本地化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-27T11:00:52.420

在寻求解决方案几分钟后，我找到了它。我已经包含了来自第三方的另一个 Localizable.strings 。一旦我删除它，每隔一次运行就不会再丢失翻译。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T16:56:58.283

您的目标中应该有多个名为“Localizable.strings”的文件。Xcode 无法处理此问题。您可以重命名一个，并使用“NSLocalizedStringFromTable”从中加载。有关详细信息，您可以参考： [本地化字符串并不总是在项目中使用 ShareKit](https://stackoverflow.com/questions/7747436/localisation-strings-not-always-work-having-sharekit-in-a-project)

# javascript - 表格行不在页面加载时计算

> ID：14486867
> 
> 赞同：0
> 
> 时间：2013-01-23T18:35:24.160
> 
> 标签：javascript, jquery, html

我有一个包含列总计和行总计的表格。我设置了当有人在输入字段中输入数字时，它会在键盘输入和页面加载时计算它们。列在页面加载时重新计算就好了，但行正在重置为零。

```
// Calculate Sum Of Rows
$(function() {
    $('input').live('keyup', newSum);
    newSum();
});
function newSum() {
    var sum = 0;
    var thisRow = $(this).closest('tr');
    //iterate through each input and add to sum
    $(thisRow).find("input:not(.ignore):not(.description):not(.miles)").each(function() {
            val = parseFloat(this.value);
            sum += isNaN(val) ? 0 : val;   
    });
    //change value of total
    $(thisRow).find(".sumtotalclaimed").html(sum);
} 
```

这是列的代码，它完美地工作（重新计算页面加载）：

```
// Calculate Sum Of Columns
$(function() {
    $('input.miles').live('keyup', calculateSum1);  
    calculateSum1();
} );
function calculateSum1() {
    var sum = 0;
    //iterate through each textboxes and add the values
    $("input.miles").each(function() {
        //add only if the value is number
        if(!isNaN(this.value) && this.value.length!=0) {
            sum += parseFloat(this.value);
        }
    });
    //.toFixed() method will roundoff the final sum to 2 decimal places
    $("#summiles").html(sum);
} 
```

我认为这就像输入 newSum(); 一样简单。在函数中，但这不起作用。任何想法我做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:38:48.647

您没有`this`页面加载。所以找不到`thisRow`。违规行是`var thisRow = $(this).closest('tr');`

我过去这样做的方法是找到有问题的第一个输入并触发事件，从而使用完全膨胀的事件调用该方法。

例如，不是`newSum();`直接调用，而是 call `$('input').first().trigger('keyup')`which 会自动调用该`newSum`函数。

编辑：http: [//jsfiddle.net/DTPZQ/3/](http://jsfiddle.net/DTPZQ/3/)

# jquery - 已删除 jQuery 1.9 .live() .... 我的脚本不再工作了

> ID：14486868
> 
> 赞同：0
> 
> 时间：2013-01-23T18:35:26.810
> 
> 标签：jquery

根据上一次 Rails gem 更新，我的 jQuery v 更新为 1.9 ，这引发了关于我的 .live() 绑定的错误......

```
$('#tags.tab-pane.active #tag-list li span.myTag').live "click", (e) -> 
```

现在错了..我试过了

```
$("#tags.tab-pane.active #tag-list li").on "click", "span.myTag", (e) -> 
```

但这也是错误的......我应该使用什么？“开”或“委托”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:41:40.870

如果您要附加一个元素，它最初不在 dom 中，但一旦附加，以下内容适用

```
$('body').on('click','#tags.tab-pane.active #tag-list li', function(e){
  //carry out function
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T18:38:42.630

live 已被弃用一段时间，不再受支持。您必须使用“on” [http://api.jquery.com/on/](http://api.jquery.com/on/)

```
$("#tags.tab-pane.active #tag-list li").on("click", "span.myTag", (e) -//NOT WORKING 
```

为了使其工作，当执行此代码时，dom 中必须存在“li”元素，以便可以将事件绑定到它。

使用“on”来表示您如何使用 live 的等效实现是：

```
$(document).on('click','#tags.tab-pane.active #tag-list li span.myTag',function(){...}) 
```

您应该尝试使用“在 dom 中更好或更深”的选择器将事件绑定到而不是文档，这样事件就不必每次都在 dom 中冒泡。请记住，在绑定事件时，您替换文档的选择器必须存在，否则它将不起作用。

如果您能弄清楚如何在元素位于 dom 之后执行绑定事件的代码，那么您可以直接在元素上绑定事件：

```
$('#tags.tab-pane.active #tag-list li span.myTag').on('click',function(){}) 
```

相当于：

```
$('#tags.tab-pane.active #tag-list li span.myTag').click(function(){...}) 
```

# actionscript-3 - 缩放对象以匹配视野

> ID：14486874
> 
> 赞同：1
> 
> 时间：2013-01-23T18:35:44.463
> 
> 标签：actionscript-3, flash, trigonometry, image-scaling, fieldofview

我在 Flash (as3) 中的专有全景查看器应用程序顶部覆盖了一些可点击的热点，我需要确保热点根据用户放大/缩小时不断变化的视野进行缩放，但我是不确定使用什么公式。

我分别设置了 90 和 25 的最大和最小视野。我得到了一些关于如何计算图标比例的建议：

来自全景软件的制造商：

```
Scale => 1/tan(FoV) 
```

这似乎对我不起作用。和：

```
scalar += (ZOOM_SCALE_UPPER - ZOOM_SCALE_LOWER) * ( ZOOM_LIMIT_OUT - tempFOV   )/( ZOOM_LIMIT_OUT-ZOOM_LIMIT_IN) ;

hotspot.scaleX = hotspot.scaleY = scalar; 
```

让我靠近，但在某些时候，即使全景图继续缩放，热点也会停止缩放。我以为我可以做类似的事情：

```
diffFOV = previousFOV - currentFOV.
hotspot.scale = currentScale*(1-diffFov) 
```

但这也不完全正确。一切都变得太大或太小。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T21:06:08.523

你可能想多了。

```
//assume we change the scale
var NEW_SCALE:Number = currentScale*(1-(previousFOV-currentFOV));

//1\. change the scale of the parent containing both the view and the hotspots
viewSprite.scale = NEW_SCALE;
//this way the hotspot and the panorama will scale together

//2\. if they are not in the same parent... then set them both to the same view
hotspot.scale = panorama.scale; 
```

如果它们没有在它们的中心点上注册，您唯一可能需要做的就是重新定位。

# php - PHP 认为 P == 0

> ID：14486877
> 
> 赞同：2
> 
> 时间：2013-01-23T18:35:50.710
> 
> 标签：php, types, conditional

这是绝对的疯狂。我今天正在测试一个应该始终评估为单个字符的 post 变量。示例代码是...

```
if($_POST['status'] == '' || $_POST['status'] == 0){ die('oh no!'); } 
```

如果我传递 P 的状态，它正在执行 die 语句。然后，我使用以下代码创建了一个 PHP 文件...

```
echo 'P1: '.intval($_POST['status']=='').'<br />';
echo 'P2: '.intval($_POST['status']==0).'<br />';
echo 'P3: '.intval('P'==0).'<br />'; 
```

你猜怎么了？P2 和 P3 都评估为 TRUE。intval 只是为了在 P1 上显示 0 而不是什么都没有。

这是 PHP 的已知错误吗？这只是我正在运行的版本上的问题吗？坦率地说，我完全不知道它为什么这样做。它使用三等式正确评估，但不是双等式。在我的书中，P 绝对不等于 0...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-23T18:40:35.250

来自[PHP 文档](http://php.net/manual/en/language.operators.comparison.php)：

> 如果将数字与字符串进行比较或比较涉及数字字符串，则每个字符串都将转换为数字并以数字方式执行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:41:45.097

阅读比较的php手册。[http://php.net/manual/en/language.operators.comparison.php](http://php.net/manual/en/language.operators.comparison.php)

> 如果将数字与字符串进行比较或比较涉及数字字符串，则每个字符串都将转换为数字并以数字方式执行比较。

如果您不想进行转换，则需要使用三等号。

`$a === $b`

> 如果 $a 等于 $b 并且它们属于同一类型，则为 TRUE

在哪里`$a == $b`

> 如果 $a 等于 $b 并且它们属于同一类型，则为 TRUE。

.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T18:46:42.620

在使用 比较字符串和数字时`==`，PHP 将该字符串转换为数字。

该字符串`'P'`中没有任何数字字符。因此，PHP 将其评估为 number `0`。终于`0 == 0`发生了，就是`true`。

另一方面，如果您使用三等号 ( `===`)，则不会发生上述转换。PHP 期望它们的类型也匹配。因为其中一个是字符串，另一个是数字，所以它返回`false`.

# php - php查询中的MYSQL变量

> ID：14486878
> 
> 赞同：9
> 
> 时间：2013-01-23T18:35:49.790
> 
> 标签：php, mysql, variables

这个问题的解决方案可能是我的一个简单的看法。

我正在尝试运行在 PHP 中存储为字符串的 MYSQL 查询。该查询使用像 Navicat 这样的 DBM 工具运行良好，但在我的 PHP 开发环境中返回 false。有什么我看过了吗？

```
SET @running_sum = 0;

SELECT
    TID,
    SumTotal,
    T.`Freight`,
    T.`Insurance`,
    T.`Discount`,
    CONCAT(
        '$',
        FORMAT(
            @running_sum :=@running_sum + SumTotal + T.`Freight` + T.`Insurance` - T.`Discount`,
            2
        )
    ) AS 'Running Total'
FROM
    (
        SELECT
            TID,
            SUM(Quantity * UnitNetValue) AS SumTotal,
            T.`Freight`,
            T.`Insurance`,
            T.`Discount`
        FROM
            Transactions T
        JOIN `Transactions_Products` P ON T.TransactionID = P.TID
        WHERE
            (
                T.TemplateName = ''
                OR T.TemplateName IS NULL
            )
        AND T. STATUS = 1
        GROUP BY
            TransactionID

    ) AS T; 
```

我正在执行这样的查询；

```
$result = mysql_query($this->query); 
```

`$this->query`是一个包含上述查询的字符串，正如上面显示的那样。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-23T18:51:02.200

问题是`mysql_query()`不支持多个查询。你`SET @running_sum = 0;`被认为是一个单独的查询，所以你必须先执行它：

```
$result1 = mysql_query("SET @running_sum = 0;");

$result2 = mysql_query($this->query); // <-- without the SET ... query 
```

从[手册](http://php.net/manual/en/function.mysql-query.php)：

> mysql_query() 发送唯一查询（不支持多个查询）

* * *

旁注：该`mysql_*`库已弃用，建议升级到现代 MySQL 库，例如[PDO](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)或[MySQLi](http://php.net/manual/en/book.mysqli.php)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-11-23T09:24:03.863

也可以使用`multi_query`方法代替`query`MySQLi：

```
$query = "SET @running_sum = 0; SELECT ...";
$db_link->multi_query($query); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-23T18:47:27.650

像这样放置变量。我想它应该工作。

```
 mysql_query("SELECT @i:=0");
 mysql_query("UPDATE table_name SET id = @i:=@i+1"); 
```

# c# - ASP.NET 报告 - 设置参数

> ID：14486882
> 
> 赞同：0
> 
> 时间：2013-01-23T18:36:15.403
> 
> 标签：c#, asp.net, .net, reporting-services, ado.net

我有一个名为“Graph”的存储过程，它应该获取参数@Material 的值，并且我在 ASP.NET 中创建了一个报告，该报告应该使用来自存储过程的数据显示一个图表。

但是，当我尝试加载报告时，我得到：

> “数据不可用”

意思是，参数设置不正确（使用默认值它可以工作......）

代码隐藏：

```
public partial class StatisticsPage : Page
{
    string Connectionstring = "server=(local)\\SQLEXPRESS;database=PhilipsMaterials;Integrated Security=SSPI";

    protected void btndisplay_Click(object sender, EventArgs e)
    {
        BindReport();
    }

    private void BindReport()
    {
        SSRSReport report = new SSRSReport();
        SqlParameter[] sqlParams = new SqlParameter[] {
         new SqlParameter("@Material","453567068441") };
        string ReportDataSource = "DataSet1";
        bool bind = report.CreateReport(Connectionstring, "graph", sqlParams, ref ReportViewer1, ReportDataSource);

        if (bind)
        {
            ReportViewer1.Visible = true;
        }
    }
}

public class SSRSReport
{     
    public bool CreateReport(String Connectionstring, string StoreProcedureName , SqlParameter[] parameters, ref Microsoft.Reporting.WebForms.ReportViewer ReportViewer, string ReportDataSource)
    {
        bool reportbind = false;
        using (SqlConnection con = new SqlConnection(Connectionstring))
        {

            SqlCommand com = new SqlCommand();
            com.Connection = con;
            com.CommandType = CommandType.StoredProcedure;
            com.CommandText = StoreProcedureName;
            com.Parameters.AddRange(parameters);
            DataSet ds = new DataSet();
            SqlDataAdapter da = new SqlDataAdapter(com);
            da.Fill(ds);
            ReportDataSource datasource = new ReportDataSource(ReportDataSource, ds.Tables[0]);
            if ( ds.Tables[0].Rows.Count > 0)
            {
                ReportViewer.LocalReport.DataSources.Clear();
                ReportViewer.LocalReport.DataSources.Add(datasource);
                ReportParameter myParam = new ReportParameter("Material", "453567068441");
                ReportViewer.LocalReport.SetParameters(myParam);
                ReportViewer.ServerReport.Refresh();
                reportbind = true;
            }                       
        }
       return reportbind;
    }
} 
```

标记：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="StatisticsPage.aspx.cs" Inherits="StatisticsPage" %>

<%@ Register assembly="Microsoft.ReportViewer.WebForms, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" namespace="Microsoft.Reporting.WebForms" tagprefix="rsweb" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1" runat="server">
    <title>Test SSRS</title>
</head>
<body>
      <form id="form1" runat="server">
        <rsweb:ReportViewer ID="ReportViewer1" runat="server" Font-Names="Verdana" Font-Size="8pt" WaitMessageFont-Names="Verdana" WaitMessageFont-Size="14pt" Height="610px" Width="1179px" ShowParameterPrompts="true">
            <LocalReport ReportPath="Report.rdlc" >
                <DataSources>
                    <rsweb:ReportDataSource DataSourceId="ObjectDataSource1" Name="DataSet1" />
                </DataSources>
            </LocalReport>
        </rsweb:ReportViewer>
        <asp:ObjectDataSource ID="ObjectDataSource1" runat="server" SelectMethod="GetData" TypeName="PhilipsMaterialsDataSetTableAdapters.GraphTableAdapter" >
            <SelectParameters>
                <asp:Parameter Name="Material"/>
          </SelectParameters>
          </asp:ObjectDataSource>
          <asp:ScriptManager ID="ScriptManager1" runat="server">
          </asp:ScriptManager>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:47:34.727

如果在没有默认参数的情况下发生错误，那么问题是 an`<asp:parameter>`不提供值，除非您提供值。您可以从标记或代码中设置 DefaultValue 属性，该值直接传递到后端。您还可以切换到从其他地方提取值的 ControlParameter、SessionParameter 等。

# c++ - flex / c ++正则表达式逻辑错误

> ID：14486883
> 
> 赞同：3
> 
> 时间：2013-01-23T18:36:16.623
> 
> 标签：c++, regex, flex-lexer

我尽了最大努力包含所有（并且仅）需要的信息。让我知道如果看到更多可以帮助你帮助我。

我的正则表达式有问题。我的程序打印到一个 .txt 文件 lexeme - token 对。除标识符和整数外，一切正常。例如，标识符的令牌是 262。

示例输入文件：

```
function main a: integer returns integer;
    b: integer is a * 2; 
```

样本输出：

```
function - 269
maina - 262
integer - 272
returns - 274
integer - 272
; - 59
b - 262
integer - 272
is - 271
a - 262
2 - 263
; - 59 
```

正确的输出是：

```
function - 269
main - 262
a - 262
: - 58
integer - 272
returns - 274
integer - 272
; - 59
b - 262
: - 58
integer - 272
is - 271
a - 262
* - 261
2 - 263
; - 59 
```

总而言之，它结合了由空格分隔的两个标识符，并且它还删除了标识符之后的任何标记。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:17:55.160

您刚刚忘记在某些名称周围加上花括号。代替

```
{letter}(letter|digit)* 
```

你应该写

```
{letter}({letter}|{digit})* 
```

您还需要在标识符规则之前移动**函数**、**整数**和**返回**的规则，因为标识符规则也匹配这些规则。

# android - android appwidget listview没有更新

> ID：14486888
> 
> 赞同：7
> 
> 时间：2013-01-23T18:36:39.580
> 
> 标签：android, listview, widget, android-appwidget

我编写了一个 AppWidget，它在 ListView 中显示来自 ContentProvider 的一些数据，但我无法更新它。当我第一次创建小部件时，它会正确填充，但在 AlarmManager 的 PendingIntent 到达后，ListView 上不会发生更新。这是代码：

```
Intent update = new Intent(context, MenuWidgetProvider.class);
update.setAction(AppWidgetManager.ACTION_APPWIDGET_UPDATE);
update.putExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS, appWidgetIds);
PendingIntent pIUpdate = PendingIntent.getBroadcast(context, 0, update, 0);
((AlarmManager) context.getSystemService(Context.ALARM_SERVICE)).
set(AlarmManager.RTC, nextTime.toMillis(false), pIUpdate);

Log.d(TAG, "updating: " + dmt.mealName);

for (int i = 0; i < appWidgetIds.length; ++i) {
    int widgetId = appWidgetIds[i];

    RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.widget_menu);
    // meal name
    views.setTextViewText(R.id.widget_locname, prefs.getString(PREF_WIDGET_LOCNAME, ""));

    // adapter
    Intent adapter = new Intent(context, MenuWidgetAdapterService.class);
    adapter.putExtra(EXTRA_LOCATIONID, prefs.getInt(PREF_WIDGET_LOCID, -1));
    adapter.putExtra(EXTRA_MEALNAME, dmt.mealName);
    adapter.putExtra(EXTRA_DATE, dmt.date.toString());
    views.setRemoteAdapter(R.id.widget_list, adapter);

    // update
    manager.updateAppWidget(widgetId, views);
}

super.onUpdate(context, manager, appWidgetIds); 
```

奇怪的是，当更新发生时，onUpdate() 方法运行——我看到了 Log.d 调用的输出——但是在我的 RemoteViewsFactory 中没有调用 onDataSetChanged()。即使当我调用 notifyAppWidgetViewDataChanged 时，也没有效果。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-06-24T07:13:57.130

这是因为您的 RemoteViewsFactory 缓存了它为每个小部件 ID 创建的工厂。因此，当同一个小部件（通过您的小部件适配器服务）发送创建新工厂的请求时，将返回同一个工厂。因此，列表视图没有“更新”。

我是如何解决它的：

在你的 WidgetProviderClass

```
adapter.setData(Uri.fromParts("content", String.valueOf(appWidgetIds[i]+randomNumber), null)); 
```

其中 randomNumber 是一个随机数（您的 WidgetProvider 类的公共静态成员）。

然后在您的 RemoteViewsFactory 类中，执行以下操作：

```
appWidgetId = Integer.valueOf(intent.getData().getSchemeSpecificPart())
            - WidgetProvider.randomNumber; 
```

这“愚弄”了服务认为它必须为另一个小部件创建一个工厂，因此，创建一个具有更新值的新工厂，它附加到您的小部件。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-15T16:48:48.443

试试动态号码

在您的 WidgetProviderClass 中：

```
int randomNumber=(int)(Math.random()*1000); 
intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId+randomNumber);

           intent.setData(Uri.fromParts("content", String.valueOf(appWidgetId), null));

           intent.putExtra("random",randomNumber );
           intent.setData(Uri.parse(intent.toUri(Intent.URI_INTENT_SCHEME)));
           rv = new RemoteViews(context.getPackageName(), R.layout.widget_layout); 
```

在您的 RemoteViewsFactory 类中，执行以下操作：

```
AppWidgetId = Integer.valueOf(intent.getData().getSchemeSpecificPart()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-13T09:31:29.470

即使我有同样的问题。小部件的 RemoteView 有这个问题。

**解决方法：**给自己发送广播，然后再次刷新列表。即将数据设置为您的完整视图，然后将广播发送给您自己。

希望这可以帮助

# debugging - 修补可执行文件

> ID：14486889
> 
> 赞同：1
> 
> 时间：2013-01-23T18:36:52.723
> 
> 标签：debugging, assembly, x86, exe, patch

**简而言之**

`ecx`通过替换 exe 文件中的以下指令来确保高位字包含 0 的最简单方法是什么？

```
004044be 0fbf4dfc        movsx   ecx,word ptr [ebp-4] 
```

而不是`FFFF9298`在执行后包含地址`004044be`，我想`ecx`包含`00009298`.

**我试过什么**

我尝试通过将可执行文件中的操作码替换`movsx`为简单`mov`的替换，但这并没有按计划进行*（使用调试器来验证更改，我确定它在正确的位置）*`0fbf``8b0c`

 ***一些背景**

我有一个相当旧的程序，当我尝试打印到我的 HP 打印机时，出于某种原因或另一个 AV。当我打印到 CutePDF 时一切正常，因此当前的解决方法是生成 PDF 文件并打印 PDF。

用 WinDbg 弄湿我的脚 我试图找出发生这种情况的原因。虽然这不是我的问题的根本原因，但似乎`ecx`在某些时候 get 是一个用于分配内存的负值，最终导致异常。

我可以尝试找出返回负值的*原因*`ecx`，但是在调试会话期间，我注意到将高字归零完成了这项工作*（也就是打印了文件）*。

因此，我不想`FFFF9298`在执行后包含地址，而是包含.`004044be``ecx``00009298`

```
004044ac 0fbf05e8025100  movsx   eax,word ptr [Encore32!SystemsPerPageDlogProc+0x10e4a1 (005102e8)]
004044b3 05416f0000      add     eax,6F41h
004044b8 668945fc        mov     word ptr [ebp-4],ax
004044bc 6a40            push    40h
004044be 0fbf4dfc        movsx   ecx,word ptr [ebp-4] --> replace with ?
004044c2 51              push    ecx
004044c3 8b55f8          mov     edx,dword ptr [ebp-8]
004044c6 52              push    edx 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:50:30.877

使用`movzx`，它完全符合您的需要。

[操作码](http://siyobik.info.gf/main/reference/instruction/MOVZX)（适用于 16->32 版本）`0F B7 /r`只需将 BF 修补到 B7 就可以了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T18:50:39.730

[`movsx`](http://web.itu.edu.tr/kesgin/mul06/intel/instr/movsx.html)意思是“用符号扩展移动”。这意味着 src 的最高位被复制到 dest 的所有高位。你不想要那个。

[`movzx`](http://web.itu.edu.tr/kesgin/mul06/intel/instr/movzx.html)用 0 填充最高位。

`movzx ecx,word ptr [ebp-4]`是你需要的。在您的示例中使用 32 位代码，它可以编码为`0F B7 4D FC`.*

# sql - 有什么更好的方法来创建我的食物数据库？

> ID：14486890
> 
> 赞同：2
> 
> 时间：2013-01-23T18:36:57.287
> 
> 标签：sql, normalize

我承担了创建一个关系数据库的项目，该数据库将包含我们在现代烹饪中使用的所有基本成分。正如您可以想象的那样，将有数千个项目。我没有太多的 sql 经验，所以我无法找到一种看似有效的存储成分的方法。如果你去这里[http://en.wikipedia.org/wiki/Outline_of_food_preparation#General_ingredients](http://en.wikipedia.org/wiki/Outline_of_food_preparation#General_ingredients)你可以看到我目前正试图放入我的数据库的列表。

我的数据库当前有一个表格，用于食品 ex 的每个主要和子类别。谷物的桌子和小麦的不同桌子。起初这样做似乎没问题，但后来我意识到还会有几十个子类别。对于该 wiki 列表中的每个项目，我必须创建更多表和更多表。我觉得过多的表格会使我的项目效率很低。有没有更好的方法来创建我的数据库？还是我走在正确的轨道上？这是我的表中列的示例：

```
 id INT(11),name VARCHAR(45),parent INT(11),img VARCHAR(45),desc VARCHAR(45) 
```

parent INT(11) 将是任何父表的外键，所以我认为它们都会以这种方式连接。任何建议表示赞赏！~谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:50:22.747

我首先不建议将所有这些存储在单独的表中——它会让你发疯:-)

但是，我认为您有两个选择。

选项 1（邻接列表模型）- 考虑使用单个`Foods`表，其中包含您希望存储的`FoodId`、`FoodName`、 、 AnyOtherAttributes。`ParentFoodId`这是存储数据最简单的方法，但返回结果可能会有点麻烦，因为您需要多次加入同一个表才能返回级别。

选项 2（嵌套集模型）——此选项仍将具有单个`Foods`表，但`ParentFoodId`您将拥有 2 列，left_index 和 right_index，而不是 a。起初这可能有点复杂，但如果您有几个未知的嵌套父子关系，则更容易查询。

看看这篇文章以获得一些进一步的解释：

[http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)

祝你好运。

# vim - vim 通过屏幕运行 make

> ID：14486893
> 
> 赞同：1
> 
> 时间：2013-01-23T18:37:00.600
> 
> 标签：vim, makefile, gnu-screen

由于需要一些复杂的环境变量，我选择通过 GNU screen 运行 Make。使用 screen vim 插件，我的 .vimrc 中有以下设置：

`map <Leader>mm :call ScreenShellSend("cd ".expand("%:p:h")." && make 2>&1 | tee /path/to/errorfile") <CR>`

粗略翻译，这将通过现有的屏幕会话在当前工作目录中运行 make，并预设所有必需的环境变量。然后我可以在单独的终端窗口中看到该命令的输出。

我的问题是，假设我将 make 的结果输出到文本文件，我如何告诉自动化 vim make 过程：

A.) 设置 make 使用 vimscript 函数，即调用 SreenShellSend() 而不是外部程序。

B.) 将错误文件设置为 /path/to/errorfile

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T08:18:07.153

不幸的是，你不能设置`'makeprg'`为 Vim 函数或命令，它必须是一个 shell 程序。（我希望有一个增强功能，它将以冒号开头的命令视为 Vim 命令，类似于 中的`:help`异常`'keywordprg'`，但还没有实现这一点。）

不过，有一些解决方法。一种是使用`vim --remote-send`as`'makeprg'`并使用这个其他临时 Vim 实例来回调原始 Vim。我所做的是`:make`通过[cmdalias.vim 插件](http://www.vim.org/script.php?script_id=746)覆盖这些缓冲区的命令。然后那个别名只是`:call`我的功能。

一旦你能够调用一个 Vim 函数，设置`'errorfile'`它只是放置一个函数包装器`ScreenShellSend()`并在那里设置它的问题。

# c++ - 删除 C++ Win32 中的标准窗口框架

> ID：14486894
> 
> 赞同：0
> 
> 时间：2013-01-23T18:37:02.203
> 
> 标签：c++, winapi, dwm

我[在 MSDN 上看到了这个文档](http://msdn.microsoft.com/en-us/library/windows/desktop/bb688195%28v=vs.85%29.aspx)。

我正在尝试删除窗口的标准框架。我成功地将框架扩展到客户区域，但以下代码段不起作用。我的窗户看起来和没有它时一模一样....

```
if (message == WM_CREATE)
{
    RECT rcClient;
    GetWindowRect(hWnd, &rcClient);

    // Inform the application of the frame change.
    SetWindowPos(hWnd, 
                 NULL, 
                 rcClient.left, rcClient.top,
                 (rcClient.right - rcClient.left), (rcClient.bottom - rcClient.top),
                 SWP_FRAMECHANGED);
} 
```

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:02:26.163

我认为您可以通过在创建窗口时将 WS_OVERLAPPED（而不是 WS_OVERLAPPEDWINDOW）作为 dwStyle 参数传递给 CreateWindowEx 来实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-25T20:42:13.070

这真的很简单，只要去你的窗口过程，然后消息 WM_NCCALCSIZE 并在 WPARAM 为 TRUE 时返回 0

```
// Window Procedure
LRESULT CALLBACK WndProc(HWND hwnd, UINT msg, WPARAM wparam, LPARAM lparam)
{
    switch (msg)
    {
    case WM_NCCALCSIZE:
        if (wparam == TRUE) return 0;
        break;
    }
    ...
} 
```

作为澄清，您显示的代码用于强制以前的代码

# jquery - CakePHP 不能与 Ajax jQuery 一起使用

> ID：14486895
> 
> 赞同：1
> 
> 时间：2013-01-23T18:37:01.867
> 
> 标签：jquery, ajax, google-maps-api-3, cakephp-2.1

我对这种情况感到非常绝望，因为我花了 3 天多的时间试图在这段代码中找到我的错误。

我的应用程序应该通过我的控制器从数据库中检索一些客户端地理坐标，并且它应该返回一个 JSON，其中包含要在视图中绘制的坐标作为 Google Map div 上的标记。

但是当我运行应用程序时，什么也没发生，只有我的表单加载，但谷歌地图没有显示，因此标记也没有显示。

这是我的代码：我有一个 CakePHP 控制器方法，它可以很好地返回 JSON 响应（我已经在 Chrome 控制台中检查过）。

代码：

```
 class ClientsController extends AppController {

          public $helpers = array('Js'=>array('Jquery'), 'GoogleMap', 'Html', 'Form');
          public $components = array('RequestHandler');

          public function loadJsonMarkers() {
              $conditions = array(
                                   'not' => array('Client.geoloc' => null),
                                   'geoloc !=' => '(-1,-1)'
                                  );

             if ($this->RequestHandler->isAjax()) {
                $clients = $this->Client->find('all', array(
                                                  'conditions' => $conditions,
                                                  'fields' => array('Client.geoloc'),
                                                  'recursive' => -1
                                               ));

              $this->header('Content-Type: application/json; Charset=UTF-8');
              return new CakeResponse(array('type'=> 'json', 'body' => json_encode(array('clients' => $clients))));

           }
      } 
```

然后我有带有 Ajax 请求的网页：

```
 function mapCaller(sentData)
         {

            $.ajax({
                       url: 'clients/loadJsonMarkers',
                       accepts: 'json',
                       type: 'POST',
                       data: sentData,
                       dataType: 'json',
                       error: function(xhr,status,err){
                             alert("DEBUG: status"+status+" \nError:"+err);
                       },  
                       success: function(transport){   

                             var markers = new Array();

                             for(var i in transport.clients){
                                 var latlng = transport.clients[i].Client.geoloc.replace("(", "");
                                 latlng = latlng.replace(")", "");
                                 latlng = latlng.split(',');

                                 markers.push(new google.maps.LatLng(parseFloat(latlng[0]),parseFloat(latlng[1])));
                             }

                             plotMap(markers);

                             $('#map-loading').fadeOut('slow');

                       },
                       complete: function(){
                             console.log(data);
                             console.log(sentData);
                       }
         });   

         function plotMap(markers)
         {   
            var mapOptions = { mapTypeId: google.maps.MapTypeId.ROADMAP };

             var map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);

             var markersCondensed = new Array(); 
             var bounds = new google.maps.LatLngBounds(); 

             $.each
             (markers,
             function(key, value){   
                  var marker = new google.maps.Marker({ position: value });
                  markersCondensed.push(marker);

                  bounds.extend(value);
              }
              );

              var mcOptions = {gridSize: 50}; 
              var markerCluster = new MarkerClusterer(map, markersCondensed, mcOptions);

              if (markers.length > 0)
                  map.fitBounds(bounds); 
              else
                  $('#map-no-results').fadeIn('slow');
          } 
```

在我看来： index.ctp Html->image("open-search.png", array('id'=>'open-search', 'class'=>'divlink')); ?> Html->link( $this->Html->image("clear-search.png", array('class'=>'divlink')), "#maps", array('escape'=>false )) ?>

```
 <div id="search-box">
        <?= $this->Html->image("hide-search.png",array('id'=>'close-search', 'class'=>'divlink')); ?>

        <div class="form">
            <?= $this->Form->create('User',array('action'=>'filter')); ?>
            <fieldset>
                <legend>Vendas</legend>
                <fieldset class="sub-fieldset">  <?php //TODO define style for ?>
                    <legend class="sub-legenda">Data da venda</legend>
                    <?= $this->Form->input('Sale.0.sale_date_min', array('label'=>'A partir do dia:', 'type'=>'date')); ?>
                    <?= $this->Form->input('Sale.0.sale_date_max', array('label'=>'Até o dia', 'type'=>'date'));  ?>
                </fieldset>
                <fieldset class="sub-fieldset">
                    <legend class="sub-legenda">Total da venda</legend>
                    <?= $this->Form->input('Sale.0.sale_total_min', array('label' => 'Valor mínimo', 'class' => 'money')); ?>
                    <?= $this->Form->input('Sale.0.sale_total_max', array('label' => 'Valor máximo', 'class' => 'money')); ?>
                </fieldset>
            </fieldset>
            <fieldset>
                <legend>Clientes</legend>
                <?= $this->Form->label('Client.sex', 'Sexo:'); ?>
                <?= $this->Form->checkbox('Client.sex', array('value'=> 'm')); ?>
                <?= $this->Form->checkbox('Client.sex', array('value'=> 'f')); ?>

                <fieldset class="sub-fieldset">
                    <legend class="sub-legenda">Faixa etária</legend>
                    <?= $this->Form->input('Client.age_min', array('label' => 'Idade mínima')); ?>
                    <?= $this->Form->input('Client.age_max', array('label' => 'Idade máxima')); ?>
                </fieldset>
                <fieldset class="sub-fieldset">
                    <legend class="sub-legenda">Renda</legend>
                    <?= $this->Form->input('Client.income_min', array('label' => 'Renda mínima', 'class' => 'money')); ?>
                    <?= $this->Form->input('Client.income_max', array('label' => 'Renda máxima', 'class' => 'money')); ?>
                </fieldset>
            </fieldset>
        </div>
    </div>

    <div id="map_canvas"></div>
    <div id="map-loading" class="notice-box">
        <p><?= $this->Html->image("ajax-loading.gif"); ?>Carregando o mapa...</p>
    </div>

    <div id="map-no-results" class="notice-box">
        <p><a href="maps">SEM RESULTADOS</a></p>
    </div> 
```

这应该可以正常工作，因为我总是得到 jqXHR.readystate = 4 和 SERVER STATE = 200，但我的页面没有加载地图。

我的应用程序的一些屏幕截图：

[http://dl.dropbox.com/u/67445902/server_status_response.png](http://dl.dropbox.com/u/67445902/server_status_response.png)

[http://dl.dropbox.com/u/67445902/loaded_app.png](http://dl.dropbox.com/u/67445902/loaded_app.png)

经过长时间的调试，我认为这是Ajax回调（成功）的问题，但我不能肯定。

关于它的任何帮助都会非常好。

注意：对不起，如果我的英语有问题。我是巴西人，我只会一点点英语。

# 更新

我已经实现了让这件事发挥作用。我必须创建一个没有正文的新模板，但是，

```
 <? echo $this->fetch('content'); ?> 
```

我真的不知道为什么，但是，它奏效了。如果有人知道原因或至少有线索。请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-26T11:41:58.340

当我设置地图显示的地图画布 div 的高度时，我发现所有这一切都是由于 css 错误而发生的。

映射画布和其他元素的 CSS 代码是：

```
 #map_canvas label{width:auto; display:inline; height: 900px; /*Your height here*/}
          #map_canvas img{max-width:none}
          .gmaps label{width:auto; display:inline}
          .gmaps img{max-width:none} 
```

并为 map-canvas 的父 div 或 map-canvas 设置一个固定值，例如：

```
 <div id="map_canvas"></div> 
```

# javascript - 在extjs中合并两个不同的json对象

> ID：14486897
> 
> 赞同：1
> 
> 时间：2013-01-23T18:37:14.770
> 
> 标签：javascript, json, extjs, extjs4, extjs4.1

假设我的第一个 json 对象是

```
 "jvtdata":{
    "tranid":"100001",
    "trandate":"Sun Jan 20 2013 00:00:00 GMT+0800 (Taipei Standard Time)",
    "trantype":"f"
  } 
```

我的第二个数据是

```
 "detail" : [
   {
      "id": "1",
      "obj": "data1"
   },
   {
      "id": "2",
      "obj": "data2"
   },
   {
      "id": "3",
      "obj": "data3"
   }

] 
```

我如何在 extjs 4 中做到这一点？

```
 "jvtdata":{
    "tranid":"100001",
    "trandate":"Sun Jan 20 2013 00:00:00 GMT+0800 (Taipei Standard Time)",
    "trantype":"f",
    "detail" : [
   {
      "id": "1",
      "obj": "data1"
   },
   {
      "id": "2",
      "obj": "data2"
   },
   {
      "id": "3",
      "obj": "data3"
   }

]
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:57:29.983

这不是 ExtJS 特定的问题。

如果你真的有两个对象`jvtdata`和`detail`（而不是一个 JSON 字符串，你可以很容易地变成一个对象），你可以简单地执行以下操作：

```
jvtdata.detail = detail 
```

**编辑**：查看这个小提琴的控制台：http: [//jsfiddle.net/FXT9k/](http://jsfiddle.net/FXT9k/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T09:30:31.427

[Ext.apply](http://docs.sencha.com/ext-js/4-1/#!/api/Ext-method-apply)可能是您正在寻找的。

```
var first = {
    "jvtdata":{
        "tranid":"100001",
        "trandate":"Sun Jan 20 2013 00:00:00 GMT+0800 (Taipei Standard Time)",
        "trantype":"f"
    }
};
var second = {
    "detail" : [{
        "id": "1",
        "obj": "data1"
    }, {
        "id": "2",
        "obj": "data2"
    }, {
        "id": "3",
        "obj": "data3"
    }]
};
var merged = {
    jvtdata: Ext.apply(first.jvtdata, second)
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T19:56:55.130

查看您对另一个答案的评论，这就是您要寻找的内容（我认为？）：

```
var details = Ext.Array.pluck(store_jvdtl.data.items, 'data');
var jvtData = Ext.Array.pluck(store_jvhdr.data.items, 'data')[0];
jvtData["details"] = details;
jvtData = Ext.encode(jvtData); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T18:44:15.303

我相信您需要合并方法：

[http://docs.sencha.com/ext-js/4-1/#!/api/Ext-method-merge](http://docs.sencha.com/ext-js/4-1/#!/api/Ext-method-merge)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-19T09:07:15.833

这里比较ExtJS[的函数](http://docs.sencha.com/extjs/4.2.2/#!/api/Ext.Object)：

```
Ext.Object.equals(object1, object2) 
```

# javascript - JavaScript/JQuery 函数不返回任何内容

> ID：14486900
> 
> 赞同：0
> 
> 时间：2013-01-23T18:37:17.640
> 
> 标签：javascript, jquery, html

我在 JavaScript/JQuery 中的函数不返回任何内容；我希望它为我返回结果，但它不会。正如你所看到的，返回的是，`$("#resultado").html("O Valor do produto ficara "+resultado);`但是当函数运行时这并没有出现：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script type="text/javascript">
     $("#target").submit(function(){

    var preco_dolar = $("#preco_dolar").val(); 
    var dolar = $("#dolar").val();
    var frete = $("#frete").val();

    if ($('#drop').is(':checked'))
    {
    var drop = 5.8;
    }else var drop = 0; 

    if(typeof preco_dolar == "undefined"){
        alert("Erro ! Falta preco do produto");
    }

    if(typeof frete == "undefined"){
        var frete = 40;
    }

    if(typeof dolar == "undefined"){
        var dolar = 2.16;
    }

    var resultado = (preco_dolar*dolar)+frete;

    $("#resultado").html("O Valor do produto ficara "+resultado);

});
</script> 
```

有人可以指出我要去哪里错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:38:55.630

您没有调用表单提交，因此页面正在刷新和重置页面。用于[`preventDefault`](http://api.jquery.com/event.preventDefault/)停止表单提交。

```
$("#target").submit(function (evt) {
    evt.preventDefault();
    ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:40:42.407

```
return false; 
```

应该足够了。

或者，您可以通过以下方式阻止默认行为

```
e.preventDefault();
e.stopPropagation(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T18:42:45.707

首先，您需要将脚本包装到

```
// here $("#target") is nothing

$(document).ready(function () {
    // here $("target") exists
}); 
```

第二为了你的改进，不要使用

```
if(typeof dolar == "undefined"){
    dolar = 2.16;
} 
```

改为使用

```
if(!dolar){
    dolar = 2.16;
} 
```

这和你做的一样：

```
if(!dolar && dolar == 0 && dolar == "" && dolar == false && dolar == undefined){
    dolar = 2.16;
} 
```

要使 0 成为有效值，请使用

```
if (!dolar && dolar !== 0) {
    dolar = 2.16;
} 
```

也不要使用`var dolar = 0;`两次。如果您已经声明了它，只需使用`dolar =`, 就不会覆盖已经声明的 var。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T18:39:47.527

你没有`return`声明。Javascript 函数需要一个 return 语句来返回一个值：

```
function test() {
    return 5;
} 
```

# android - 使用 Fragment 的弹出窗口

> ID：14486905
> 
> 赞同：1
> 
> 时间：2013-01-23T18:37:39.627
> 
> 标签：android, popup, fragment, android-dialogfragment

我想创建一个弹出窗口（周围有黑色透明背景），它会出现在应用程序活动屏幕上方（通过单击按钮）。此弹出窗口将包含视频播放器、要播放的视频列表和一些其他元素。这个弹出窗口必须是一个片段，因为我需要从其他应用程序片段中重用它。

所以我的问题是：实现这一目标的最佳方法是什么？我个人看到2个选项：

1）将弹出窗口添加为布局上的片段，并在需要时显示+激活它。但在那种情况下，我怎样才能在它周围放置一个黑色透明背景来填满整个屏幕？

2）使用 DialogFragment 但似乎这个类不是为这类东西设计得很好。

你怎么看？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:44:38.250

DialogFragments 是从 Fragment 中启动 Dialog 视图的建议方法，因此这是我为您建议的解决方案。

您可以在 DialogFragment 中执行几乎所有您需要的操作。使用此方法，您将完全控制 UI。

这是对同一点的 SO 讨论，提供了很好的信息：[Android DialogFragment vs Dialog](https://stackoverflow.com/questions/7977392/android-dialogfragment-vs-dialog)

# javascript - 谷歌地图 - setIcon 代码使标记消失

> ID：14486908
> 
> 赞同：3
> 
> 时间：2013-01-23T18:37:46.363
> 
> 标签：javascript, google-maps-api-3, maps

我试图在单击标记时动态更改标记的图标。我在地图上有多个标记（通过数据库查询收集），这是我目前正在使用的代码 - 所有非常标准的东西：

```
function initialize() {
        var myOptions = {
          center: new google.maps.LatLng(-30,135),
          zoom: 4,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("map"),
            myOptions);
        var bikeicon = "images/bike.png";

    <?php
    $result=mysql_query("select * from sites");
    while($row=mysql_fetch_assoc($result)){
        ?>
        marker = new google.maps.Marker({
        position: new google.maps.LatLng(<?php echo $row['Latitude']; ?>, <?php echo $row['Longitude']; ?>),
        map: map, icon: bikeicon});

        infoWindow = new google.maps.InfoWindow();

        marker.html="<?php echo stripslashes($row['ShortDesc']); ?>";

        google.maps.event.addListener(marker, 'click', function(){
            //show infowindow
            infoWindow.setContent(this.html);
            infoWindow.open(map, this);
            //change icon color
            var icon = new google.maps.MarkerImage({ url:"http://jovansfreelance.com/bikestats/images/bike_red.png"});
                this.setIcon(icon);     //why doesn't this work?

        })
        <?php
    }
    ?>

} 
```

infoWindow 代码工作正常，但 seticon 代码只是使标记消失并且不显示新的标记图标。新图标 URL 有效，您可以通过在浏览器中打开它来查看。

那么谁能告诉我为什么这段代码不起作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T19:03:03.463

MarkerImage 期望 url 作为第一个参数，而不是包含 url 的对象。

但是您应该避免使用 MarkerImage，它已被弃用。

您也可以将 url 直接传递给 setIcon。

可能的方法（都将给出相同的结果）：

```
  //使用 MarkerImage 对象
 this.setIcon(icon);    

  //直接使用url
 this.setIcon('http://jovansfreelance.com/bikestats/images/bike_red.png');  

  //使用**google.maps.Icon 对象**
 this.setIcon({url:'http://jovansfreelance.com/bikestats/images/bike_red.png'});

```

# performance - 在 Linux 上使用 Firefox 时 Canvas2D 性能不佳

> ID：14486910
> 
> 赞同：5
> 
> 时间：2013-01-23T18:37:48.953
> 
> 标签：performance, html, canvas

在使用 Canvas2D 进行一些非常密集的渲染时，我遇到了一些特别难以调试的问题。我使用各种各样的东西，从`globalCompositeOperation`多个屏幕外的画布，中间有一些`drawImage`魔法。

它在：

*   铬 (26) [OSX 10.7.5]
*   Safari (6.0.2) [OSX 10.7.5]
*   Firefox（18 和 20 Aurora）[OSX 10.7.5]
*   铬 (24) [Windows 7]
*   火狐 (12) [Windows 7]
*   铬 (24) [Archlinux, Gnome 3]

*编辑：添加了针对 Windows 7 的测试。奇怪的是，它适用于 FF12（我的双启动时有一个旧版本），但升级到 FF18 后性能肯定会受到影响。它在 Windows 上并不像在 Linux 上那么糟糕，而且 OSX 上的相同版本也可以完美运行。可能是回归？*

出于某种原因，在 Firefox 和 Linux 上（我尝试了 18 和 20 Aurora），同时拖动和渲染时渲染性能很差。

如果我触发并忘记动画，它与 Chrome/Safari 相当，但如果我拖动和渲染，我通常在释放拖动后只看到结束帧。

*   `requestAnimationFrame`鼠标事件处理程序上的直接渲染和直接渲染都不起作用。
*   分析后，渲染部分的报告时间完全在可接受的范围内（绝对最差可达 100 毫秒），并且绝对与我在屏幕上看到的不对应。
*   我尝试通过删除一些东西来减少负载，最终报告的渲染时间低于 15 毫秒，但我看到的并没有改变。

令我困惑的是，*除了*Linux 上的 Firefox 之外，它几乎可以在其他任何地方使用。关于我应该在哪里查看，错误报告或解决我的问题的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-21T18:34:41.027

由于这个问题，我已经完全切换到 Linux 上的 Chrome。它源于他们使用的名为 Cairo 的旧 2D 渲染引擎，该引擎陈旧且过时。Azure 是要替换这个引擎，他们基本上已经完成了除 linux 之外的所有平台。

[http://blog.mozilla.org/joe/2011/04/26/introducing-the-azure-project/](http://blog.mozilla.org/joe/2011/04/26/introducing-the-azure-project/) [https://bugzilla.mozilla.org/show_bug.cgi?id=781731](https://bugzilla.mozilla.org/show_bug.cgi?id=781731)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:05:32.433

我想我知道你应该根据这个看哪里：

> 如果我触发并忘记动画，它与 Chrome/Safari 相当，但如果我拖动和渲染，我通常在释放拖动后只看到结束帧。

这*可能*是 Firefox 在 linux 上的双缓冲错误。

Canvas 实现内置了双缓冲。您可以在任何浏览器上看到它在一个简单的例子中的作用，比如这个：http: [//jsfiddle.net/simonsarris/XzAjv/](http://jsfiddle.net/simonsarris/XzAjv/)（它使用一个`setTimeout`vs 额外的工作来说明清除确实不会马上发生）

这些实现尝试通过将其渲染到内部位图来延迟所有渲染，然后一次性（在下一次暂停时）将其渲染到画布上。在重绘场景之前清除画布时，这会停止“闪烁”效果，这很好。

但似乎 Linux Firefox 中存在一个普通的老错误。在您的拖动和渲染过程中，它似乎没有更新画布，可能是为了缓冲，但似乎在不应该这样做的时候这样做。这可以解释为什么它适用于即发即弃的场景。

* * *

所以我认为错误报告是有必要的。我没有任何 linux 机器，所以我无法复制它并自己提交一些东西来确定，抱歉。

* * *

这是对评论的回复：您可以在鼠标移动期间将绘图部分发送给一个小计时器。

例如：

```
// The old way
theCanvas.addEventListener('mousemove', function() {
  // if we're dragging and are redrawing
  drawingCode();
}, false);

// The new way
theCanvas.addEventListener('mousemove', function() {
  // if we're dragging and are redrawing

  // in 1 millisecond, fire off drawing code
  setTimeout(function() { drawingCode(); }, 1);
}, false); 
```

没有这样的方法，它完全隐藏。您可以做的是，在鼠标移动期间，调度

# php - Poedit 不解析“路径”中 PHP 文件中的所有字符串

> ID：14486914
> 
> 赞同：2
> 
> 时间：2013-01-23T18:38:07.947
> 
> 标签：php, poedit

今天，当我尝试扫描我的插件以查找翻译并为其创建本地化文件时，我遇到了这个麻烦，但我看到 Poedit 扫描了所有文件但没有解析所有字符串。例如，如果我有这样 `<?php _e('test string')?>`的字符串，它会被解析，但如果我在这样的上下文中使用它

```
如果（$a == $b）{
  _e('一切正常');
}别的{
  _e('错误');
}

```

poedit 没有解析任何字符串。然后我做了一个简单的测试，我把我的消息放在这样的一行
`<?php_e('test string'); _e('test string 2');?>`中，然后 poedit 提取它们！

**注意：** poedit 没有抛出错误。所有关键字都在那里，并通过搜索`(_,__,_e)`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T09:51:17.877

我有时会认为 Poedit 在文件中某处的注释后似乎无法识别字符串。

今天，它不会看到我的很多字符串。所以我做了一个测试。这是文件中间的一段代码：

```
//
// Check for valid address
//

echo __('Dit is een simpele test'); 
```

该字符串未被识别，之后的任何字符串也未被识别。删除评论和其他一些评论使 Poedit 可以看到文件中的所有字符串。

对我来说，它似乎是随机的，因为很多文件都包含注释并且它确实识别这些字符串。所以这似乎是一个错误。

我的一位同事指出，它只发生在单行注释中`//`，`#`而不是使用多行注释`/* */`。我对其进行了测试并且它有效，所以这似乎是一个简单的修复。

我使用的是 1.5.5 版本，并且在旧版本中遇到了这个问题。

（为什么我不能添加评论？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-28T14:40:37.020

将文件的行尾更改为 Unix（从 Mac OS 9 开始）导致我丢失的字符串出现在 Poedit 中。

删除评论也有效，但如果它是通用的，这是一个更好的解决方案。评论问题似乎是 Poedit 中的一个错误。

# android - Android 驱动程序到设备映射

> ID：14486916
> 
> 赞同：2
> 
> 时间：2013-01-23T18:38:11.670
> 
> 标签：android, usb, driver, 3g

在 android 中，是否有文件或数据库决定为某个 USB 设备加载哪个驱动程序（模块）？

**一些背景：**

我有一个制造商“支持”的 3g 调制解调器并获得一个`/dev/ttyUSBx`文件。我有一部可以用作 3g 调制解调器的电话（它在 Linux 中工作，只需要强制使用 usbserial 驱动程序）。

我的问题是 Android 加载 cdc_acm 驱动程序并创建一个`/dev/ttyACMx`文件。在这种情况下，移动网络功能不会显示在 Android 菜单中。

我的目标是找到处理 3g 调制解调器但忽略电话的机制。标准方法：`insmod usbserial vendor=0xVVVV product=0xPPPP`不起作用（未找到usbserial模块）。- 但显然有一种机制可以处理调制解调器（因此它可以很好地处理usbserial协议），但选择忽略电话。

注意：模式切换与它无关。

注2：我知道这不是一个严格的*编码*问题，但它当然也不是“用户级别”的东西，所以我认为这个网站有最好的观众来回答它。

# c - 在 C 中将一维数组重铸/转换为二维数组

> ID：14486917
> 
> 赞同：0
> 
> 时间：2013-01-23T18:38:13.747
> 
> 标签：c, pointers

在下文中，我将使用类型定义：

```
typedef float zreal;
typedef float* zvect;
typedef float** zmatr; 
```

假设我有一个`zvect`总长度`n`，我想将它重铸为一个`zmatr`带`m`列的（当然假设`m`除以`n`）。“`zvect`对象”按行打包值`zmatr`，即它是`a = [a1 a2 ... ap]`where `a`is 的类型`zvect`（被认为是行向量）。我需要将其转换为`zmatr`如下所示：

```
zmatr = [a1
         a2
         ...
         ap] 
```

其中`a1,...,ap`代表行向量。有没有办法将 my 重铸`zvect`为 a `zmatr`（无需将值复制到新实体）？最有效的方法是什么？请注意，我希望避免直接使用向量访问矩阵的值，例如`z[getIndex(i,j,ncols)];`where `getIndex(int i,int j, int ncols)`returns `i*ncols+j`。任何建议将不胜感激。

**更新：**似乎以下代码可以完成这项工作：

```
zvect v;
create_vector(&v,100);

zmatr zm;
zmatr* matrix = &zm;

*matrix = (zmatr)malloc(sizeof (zvect) * 10);
int i;
for (i = 0; i < 10; ++i) {
    (*matrix)[i] = &(v[i*10]);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:46:34.167

这些是非常不同的，不能转换：

```
typedef float* zvect;
typedef float** zmatr; 
```

类型`zvect`是指向 的一个`float`或数组的指针`float`。

类型`zmatr`是指向`float *`或 的数组的指针`float *`。

```
+-------+          +-------+
| zvect | -------> | float |
+-------+          | float |
                   | float |
                   | ...   |
                   +-------+

+-------+          +---------+           +-------+
| zmatr | -------> | float * | --------> | float |
+-------+          | float * | --        | float |
                   | float * |   \       | ...
                   | ...     |    \
                   +---------+     \     +-------+
                                    ---> | float |
                                         | float |
                                         | ... 
```

所以，简短的故事是这**不是**`zmatr`一个二维数组，它实际上是一个一维数组，其中包含指向一维数组的指针作为元素。

 **就个人而言，我会坚持：

```
float elem = arr[i*ncols+j]; 
```

这是清晰、简洁和明确的。**

# objective-c - “无法识别的选择器” - 将 AppDelegate 的 NSManagedObjectContext 导入其他类 (OSX) 时出错

> ID：14486923
> 
> 赞同：2
> 
> 时间：2013-01-23T18:38:46.663
> 
> 标签：objective-c, xcode, core-data, nsmanagedobjectcontext

在我的应用程序中，我想在另一个类（myClass）中使用由 AppDelegate 创建的 ManagedObjectContext。为此，我首先在 MyClass 中创建了一个实例变量来存储 objectContext：

```
NSManagedObjectContext *managedObjectContext; 
```

我还用@property 定义了getter 和setter。为了设置实例变量，我在初始化后为其分配了 AppDelegate 的 managedObject 上下文：

```
-(void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
   myClass *myClassInstance = [[myClass alloc]init];
   [myClassInstance setManagedObjectContext:[self managedObjectContext]];
} 
```

现在，当我运行应用程序时，我得到以下信息：

```
-[NSManagedObjectContext copyWithZone:]: unrecognized selector sent to instance 0x100634c90 
```

老实说，我真的不知道该怎么办。有人能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:52:11.903

似乎您已经使用“复制”属性为托管对象上下文声明了@property。您应该将其声明为

```
@property(strong, nonatomic) NSManagedObjectContext *managedObjectContext; 
```

无法复制托管对象上下文，但它也没有任何意义。您想在课堂上使用相同的上下文，而不是（独立）副本。

# qt4 - QML 信号到 C++ Slot qt4.8

> ID：14486927
> 
> 赞同：1
> 
> 时间：2013-01-23T18:38:53.383
> 
> 标签：qt4, signals-slots

我有一个 qt 快速项目，我试图从 QML 发出信号并连接到 C++ 中的插槽。

QML 文件

```
import QtQuick 1.0
//import com.net 1.0

Column {
id: mainCol
x: 20; y: 80
width: 320
//height: 62
opacity: 0

//NetCom{ id: netcom}

Rectangle{
    signal tcpMsg(string address, int port)
    objectName: "topRec"
    id: topRec
    width: 40; height: 40
    color: "blue"
    Text{
        text: "send tcp msg"; font.pointSize: 14
        anchors.verticalCenter: topRec.verticalCenter
        anchors.left: topRec.right
        anchors.rightMargin: 10
    }
    Text{
        id: statusTxt
        //text: cppInterface.qml_text ; font.pointSize: 12
        text: "status: "; font.pointSize: 12
        anchors.horizontalCenter: topRec.horizontalCenter
        anchors.top: topRec.bottom
        anchors.bottomMargin: 10
    }

    MouseArea {
        id: mouseArea
        transformOrigin: Item.Center
        anchors.fill: parent //anchor all sides of the mouse area to the rectangle's anchors
        onClicked: {
            topRec.tcpMsg("127.0.0.1", 8888)
            console.log("clicked")
        }
    }
}

states:[
   State {
        name: "visible";
        PropertyChanges { target:mainCol; opacity: 1;}
    }
]

transitions:[
  Transition {
        from:""; to: "visible"; reversible: true
        NumberAnimation { properties: "opacity"; duration: 500; easing.type: Easing.InOutQuad }
    }
]

} 
```

C++ 文件

```
#include <QtGui/QApplication>
#include <QtDeclarative>

#include "qmlcppmediator.h"
#include "qmlapplicationviewer.h"
#include "kernelcom.h"
#include "netcom.h"

Q_DECL_EXPORT int main(int argc, char *argv[])
{
QScopedPointer<QApplication> app(createApplication(argc, argv));
//needed to use C++ code in QML
qmlRegisterType<KernelCom>("com.kernel", 1, 0, "KernelCom");
qmlRegisterType<NetCom>("com.net", 1, 0, "NetCom");

QmlApplicationViewer viewer;
viewer.setWindowFlags(Qt::FramelessWindowHint);
viewer.setOrientation(QmlApplicationViewer::ScreenOrientationAuto);
viewer.setMainQmlFile(QLatin1String("qml/testMenu/main.qml"));

//make signal from Qml file trigger slots in C++
QDeclarativeView view;
view.setSource(QUrl::fromLocalFile("qml/testMenu/TCPmenu.qml"));
QObject *object = view.rootObject();
QObject *child = object->findChild<QObject*>("topRec");

qDebug()<<child;
NetCom client;

qDebug()<<QObject::connect(child,SIGNAL(tcpMsg(QString, quint16)), &client, SLOT(start(QString, quint16)));

viewer.showExpanded();

return app->exec();
} 
```

我不断收到以下错误消息

```
 QDeclarativeRectangle_QML_3(0x99c5998, name = "topRec") 
 Object::connect: No such signal QDeclarativeRectangle_QML_3::tcpMsg         (QString, quint16)
 Object::connect:  (sender name:   'topRec')
 false 
```

我尝试使用 QDecarativeEngine，将信号放在主要的 qml 项目中，所以我没有使用 get child，我不断收到上面的消息。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:01:28.613

刚刚想通了，它不会连接，因为我使用的是 qunit16 数据类型而不是使用 int 我将行改为这个

```
 connect(child,SIGNAL(tcpMsg(QString, int)), &client, SLOT(start(QString, int))) 
```

然后它连接了。

我也不需要 QDeclarativeView 我从 QmlApplicationViewer 查看器中设置了 rootObject；

# ruby-on-rails-3.2 - 在 Rspec 中使用 FactoryGirl 创建模型时如何防止 state_machine 执行

> ID：14486928
> 
> 赞同：0
> 
> 时间：2013-01-23T18:38:53.003
> 
> 标签：ruby-on-rails-3.2, rspec2, factory-bot, rspec-rails

在我看来，如果我使用 FactoryGirl 创建一个模型，其状态是使用 state_machine gem 处理的，那么 state_machine 将触发。

```
FactoryGirl.create(:order) 
```

我怎样才能防止这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:42:14.747

实际上，我将问题追溯到 rspec 在没有观察者的情况下无法运行：请参阅[此 SO question](https://stackoverflow.com/questions/3961880/how-to-run-rspec-with-no-observers-in-rails-3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T19:19:39.113

如果您的状态机是由 AR 回调触发的，您尝试使用以下描述的方式跳过回调： [如何跳过 ActiveRecord 回调？](https://stackoverflow.com/questions/1342761/how-to-skip-activerecord-callbacks)

还有一个[宝石](https://github.com/wireframe/callback_skipper)可以方便地完成这项工作。（我怀疑 state_machine 可能正在使用回调挂钩来进行状态更改）。

# javascript - 事件类型字段的 Typescript 事件处理函数 - 上下文不正确

> ID：14486930
> 
> 赞同：13
> 
> 时间：2013-01-23T18:38:58.480
> 
> 标签：javascript, typescript

这是来自 jquery.d.ts 的 jquery 接口：

```
export interface IDialogEvent extends DialogEvent {
    (event: Event, ui: DialogUIParams): void;
} 
```

这是我的自定义界面，模仿 jquery.d.ts 的 DialogOptions 界面的部分功能：

```
export interface IDialogOptions {
    open: IDialogEvent;
}

export class DialogClass implements IDialogOptions { 

    //Dialog options
    public open: IDialogEvent;

    //Class related fields
    public someField: any;
    public dialogEl: JQuery;

    constructor() { 
        this.open = this.OpenHandler;
        this.dialogEl = $("<div></div>").dialog(this); 
        //Passing "this" initializes the dialog by mapping relevant class fields
        //to the dialog's "option" object, in this case the only "relevant" field is "open".
    }

    public OpenHandler(event: Event, ui: DialogUIParams) { 
        var value = this.someField; //BAD. "this" is not type BaseClass
    }

    public NonEventHandlerMethod() { 
        var value = this.someField; //GOOD. "this" is type BaseClass
    }  
}

var dialog = new DialogClass();
dialog.dialogEl.dialog("open"); 
```

最后一行触发`OpenHandler()`但在其中`this`不是类型`BaseDialog`（与 in 不同`NonEventHandlerMethod`）。

我需要对话框选项字段的事件处理函数的原因以及我不能简单地这样做的原因：

```
 export class DialogClass implements IDialogOptions { 
     ...
      constructor() { 
          this.open = () => {
                //event handling logic
          };
          ...
      }
      ...
 } 
```

是因为我需要在扩展 DialogClass 的类中添加额外的开放事件处理逻辑，并且 this.member 和 super.member 之间没有区别...... this.function() 和 super.function() 之间只有区别：

```
 export class LoginDialog extends DialogClass { 
     ...
      constructor() { 
          this.open = this.OpenHandler;
          ...
      }

      public OpenHandler(event: Event, ui: DialogUIParams) { 
           super.OpenHandler(); //Base handling logic

           //Additional handling logic
      } 
      ...
 } 
```

我认为这可能是一个错误，因为

```
 export class DialogClass implements IDialogOptions { 
     ...
      constructor() { 
          this.open = () => {
                var test = this.someField;  //Correct context
          };
          ...
      }
      ...
   } 
```

并直接调用该方法：

```
 var dialog = new DialogClass();
   dialog.OpenHandler();  //Correct context when called directly
   //Note: I haven't actually tested this persay but this function is no different
   //than any other functionso a direct call should certainly not be problem. 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-23T20:31:47.583

TypeScript 遵循通常的 JavaScript 范围约定，因此`this`将依赖于上下文。如果您有基于事件触发的类的方法，`this`则将成为事件目标。当你直接调用一个类上的一个方法时，`this`会是这个类。

如果你想解决这个问题，你可以利用 JavaScript 如何通过提供`this`别名来遍历作用域链......

这是一种方法：

```
this.open = () => { this.OpenHandler(this); }; 
```

`_this`箭头函数语法在 JavaScript 中创建和别名。

```
public OpenHandler(context: DialogClass, event: Event, ui: DialogUIParams) { 
    var value = context.someField;
} 
```

我们接受巧妙的别名版本`this`作为参数，并且`context.someField`应该具有我们所追求的值。

# asp.net-mvc-3 - 带有隐藏控件的 ASP.NET MVC 中的模型绑定集合

> ID：14486931
> 
> 赞同：0
> 
> 时间：2013-01-23T18:38:59.940
> 
> 标签：asp.net-mvc-3

嗨，

与此类绑定模型时遇到问题（以下具体，而不是抽象）。忽略基本属性，它是我有兴趣绑定的列表。

```
public abstract class MessageModel
{
    public string Tag { get; set; }
    public string Message { get; set; }
    public int Id { get; set; }
    public const int DefaultIdValue = Int32.MinValue;

    public List<LinkModel> Linked { get; set; }
    public List<LinkModel> NotLinked { get; set; }

    protected MessageModel()
    {
        Id = DefaultIdValue;
        Linked = new List<LinkModel>();
        NotLinked = new List<LinkModel>();
    }

    protected MessageModel(string tag, string message):this()
    {
        Tag = tag;
        Message = message;
    }
}

public class TextModel:MessageModel
{
        public int TextId { get; set; }

        public TextModel()
        {
                TextId = DefaultIdValue;
        }
} 
```

这是我在提交时在服务器端收到的提交（为了理智而格式化）：

```
Tag=
&Message=
&NotLinked.index=35fda83a053645e6809bbb8b0ea00103
&NotLinked.index=14c2e286e28b4c9d8f889fb3eb437e5f
&NotLinked.%5b35fda83a053645e6809bbb8b0ea00103%5d.RecipientId=1
&NotLinked.%5b35fda83a053645e6809bbb8b0ea00103%5d.RecipientName=Bob+Biggins
&NotLinked.%5b14c2e286e28b4c9d8f889fb3eb437e5f%5d.RecipientId=2
&NotLinked.%5b14c2e286e28b4c9d8f889fb3eb437e5f%5d.RecipientName=Billy+Oswold
&Submit=Submit 
```

当调用接受该模型的函数时，NotLinked 集合设置为空。丁：

（相关）输出 html 看起来像这样（我试图“假”绑定到：

```
<ol> and <li> 
```

用 jQuery 做移动东西的工作）

```
<div id="NotLinkedContainer">
    <ol id="NotLinked" name="NotLinked" style="width: 500px;height: 200px">
        <li value="1">Bob Biggins
            <input id="NotLinked_index" name="NotLinked.index" type="hidden" value="a0ab331bee2a461084b686e13a87090b" />
            <input id="NotLinked__a0ab331bee2a461084b686e13a87090b__RecipientId" name="NotLinked.[a0ab331bee2a461084b686e13a87090b].RecipientId" type="hidden" value="1" />
            <input id="NotLinked__a0ab331bee2a461084b686e13a87090b__RecipientName" name="NotLinked.[a0ab331bee2a461084b686e13a87090b].RecipientName" type="hidden" value="Bob Biggins" />
        </li>
        <li value="2">Billy Oswold
            <input id="NotLinked_index" name="NotLinked.index" type="hidden" value="d7d294d3174c4bd98d583e92010359e7" />
            <input id="NotLinked__d7d294d3174c4bd98d583e92010359e7__RecipientId" name="NotLinked.[d7d294d3174c4bd98d583e92010359e7].RecipientId" type="hidden" value="2" />
            <input id="NotLinked__d7d294d3174c4bd98d583e92010359e7__RecipientName" name="NotLinked.[d7d294d3174c4bd98d583e92010359e7].RecipientName" type="hidden" value="Billy Oswold" />
        </li>
    </ol>
</div> 
```

有任何想法吗？以前没有做过这种复杂的绑定，所以我对我可能犯的简单错误感到茫然。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:49:42.493

尝试删除括号前的点符号，因为这不是字典，而是列表，因此您需要使用索引，而不是键。剃刀视图中列表的正确语法应该更像这样：

```
<div id="NotLinkedContainer">
    <ol id="NotLinked" name="NotLinked" style="width: 500px;height: 200px">
        <li value="1">Bob Biggins
            <input id="NotLinked_index" name="NotLinked.index" type="hidden" value="a0ab331bee2a461084b686e13a87090b" />
            <input id="NotLinked__a0ab331bee2a461084b686e13a87090b__RecipientId" name="NotLinked[0].RecipientId" type="hidden" value="1" />
            <input id="NotLinked__a0ab331bee2a461084b686e13a87090b__RecipientName" name="NotLinked[0].RecipientName" type="hidden" value="Bob Biggins" />
        </li>
        <li value="2">Billy Oswold
            <input id="NotLinked_index" name="NotLinked.index" type="hidden" value="d7d294d3174c4bd98d583e92010359e7" />
            <input id="NotLinked__d7d294d3174c4bd98d583e92010359e7__RecipientId" name="NotLinked[1].RecipientId" type="hidden" value="2" />
            <input id="NotLinked__d7d294d3174c4bd98d583e92010359e7__RecipientName" name="NotLinked[1].RecipientName" type="hidden" value="Billy Oswold" />
        </li>
    </ol>
</div> 
```

这是一篇涵盖您正在尝试做的事情的文章：

[http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)

# php - Doctrine2 Mysql 字符集

> ID：14486932
> 
> 赞同：0
> 
> 时间：2013-01-23T18:39:04.330
> 
> 标签：php, mysql, doctrine, doctrine-orm

我有一个教义2 orm，它使用另一个字符集生成我的 DB-Tables，然后我的默认 mysql 字符集是。

如何更改生成的 orm 表的字符集？

在他们编写的学说文档中，它应该与 mysql-default 相同。但它不是。

此致

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:42:18.723

好的，我发现了这样的东西：

```
// the connection configuration
$dbParams = array(
    'driver' => 'pdo_mysql',
    'user' => '****',
    'password' => '****',
    'dbname' => '****',
    'charset' => 'utf8',
    'driverOptions' => array(
        1002 => 'SET NAMES utf8'
    )
);

$config = Setup::createAnnotationMetadataConfiguration($paths, $isDevMode);

$em = EntityManager::create($dbParams, $config); 
```

我得试试。

# jsp - 集合中的随机元素，JSP

> ID：14486934
> 
> 赞同：0
> 
> 时间：2013-01-23T18:39:08.800
> 
> 标签：jsp, loops

我需要遍历 JSP 中的集合。现在我使用一个`<c:forEach>`循环遍历集合中的每个元素。我只需要访问集合中一个随机选择的元素的属性。

关于如何在 JSP 中执行此操作的任何想法？

# java - java Map 上的 java.util.NoSuchElementException

> ID：14486941
> 
> 赞同：0
> 
> 时间：2013-01-23T18:39:26.413
> 
> 标签：java, iterator

我只是不知道是什么问题，为什么这段代码会抛出 java.util.NoSuchElementException 因为在调用下一个方法之前有 hasNext

```
 Map results = getResults();
        if (results != null) 
        {

            Set set = results.entrySet();
            Iterator it = set.iterator();
            while (it.hasNext()) {
                Map.Entry entry = (Map.Entry) it.next();
                Iterator jt = ((Collection) entry.getValue()).iterator();
                while (jt.hasNext()) {
                    CustomException e = (CustomException) jt.next();
                    String exp = e.getMessage();
                    exp = (exp == null)?"":exp;
                    if(!"".equals(exp) && !exp.contains("errors"))
                    {
                        setError(exp)
                    }

                }
            }
        } 
```

# ruby-on-rails - 当某些嵌套记录为“nil”时，如何使用“count”获取数字

> ID：14486942
> 
> 赞同：0
> 
> 时间：2013-01-23T18:39:26.730
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我试图显示拥有社区唯一代码的用户数量。

```
@community.uniquecodes.users.count.to_s 
```

为什么这会返回此错误？

```
undefined method `users' 
```

请考虑到唯一代码仍然存在但用户被删除的可能性！

我的协会是这样的

```
User has_many :communities
     has_many :uniquecodes

Community belongs_to :user
          has_many :uniquecodes

Uniquecode belongs_to :user
           belongs_to :community 
```

如何获取拥有社区唯一代码的用户数量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:53:19.470

尝试：

```
Community has_many :uniquecodes
Uniquecode has_many :users 
```

这应该使这项工作：

```
@community.uniquecodes.users.count.to_s 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T19:01:09.270

### 使用#try 进行方法链

在调用可能为 nil 的对象的方法时，Rails [Object#try](http://api.rubyonrails.org/classes/Object.html#method-i-try)方法很有用。考虑以下：

```
1.9.3p362 :001 > @foo = []
 => [] 
1.9.3p362 :002 > @foo.count
 => 0 
1.9.3p362 :003 > @foo = nil
 => nil 
1.9.3p362 :004 > @foo.count
NoMethodError: undefined method `count' for nil:NilClass
1.9.3p362 :005 > @foo.try(:count)
 => nil 
```

方法链的一个问题`@community.uniquecodes.users.count.to_s`是，如果链上的任何方法返回 nil，您最终会在 NilClass 的实例上调用以下方法。:try 方法可以防止在这种情况下引发 NoMethodError 异常，并且在某种程度上类似于调用`@foo.some_method rescue nil`. 但是，与救援子句不同，Object#try 是可链接的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T19:15:14.493

您的关系不清楚，也许您需要类似 has_many :through 关联的东西，但是“belongs_to :user”让我有点困惑，uniquecode 是什么意思？

尝试

```
User has_one :community
     has_many :uniquecodes
     has_many :communities, :though => :uniquecodes

Community belongs_to :user
          has_many :uniquecodes
          has_many :users, :through => :uniquecodes

Uniquecode belongs_to :user
           belongs_to :community 
```

另外，我猜唯一码只是一个连接模型，所以如果用户被删除，它不应该存在（has_many, :through 关联会自动处理）

这样你就可以做“community.users”

# magento - 为什么 app\code\core\Mage\Customer\Model\Entity 中的所有文件都包含空类（Magento v 1.7）？他们是否搬迁

> ID：14486944
> 
> 赞同：1
> 
> 时间：2013-01-23T18:39:33.847
> 
> 标签：magento, magento-1.7

我正在尝试按照[fontis](http://www.fontis.com.au/blog/magento/know-more-about-your-customers-adding-custom-signup-attributes)的常用博客文章在 Magento v 1.7 中为客户注册创建自定义字段。但是，该帖子是为 Magento v 1.3 创建的，并且似乎上述文件已被重新定位。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T19:45:38.963

是的，他们被重新安置了。由于 Magento 1.7`..._Entity_...`和`..._Mysql4_...`类被重命名为`..._Resource_...`. 为了向后兼容，旧类仍然存在，但继承自新类。所以只要看看哪个类`Mage_Customer_Model_Entity_...`扩展。无论如何，1.3 和 1.7 之间的客户模型发生了更大的变化，因此您最好找到更新的教程。

# php - 奇怪的 MD5 生成到电子邮件链接问题

> ID：14486950
> 
> 赞同：0
> 
> 时间：2013-01-23T18:39:52.177
> 
> 标签：php, jquery, md5, urlencode

我发送给用户的验证链接有一个奇怪的问题。出于某种原因，在 MD5 字符串中插入了一个额外的空格，该空格被编码为“%20”并弄乱了我的验证链接。

我有以下简单的 PHP 来生成 MD5 验证字符串：

```
echo "<input type='hidden' name='unique_id' value='" . md5($event['date_submitted']) . "' />"; 
```

提交日期的格式为`2012-09-19 16:21:19`.

我有以下 jQuery，它获取字符串并`POST`使用唯一 ID 对数据库进行更新，并将链接通过电子邮件发送给用户：

```
$("#form1_review_form").submit(function(event) {
    event.preventDefault();

    var email = $(this).find("input[name='email']").val(),
        message = message_box.val(),
        alloc_id = $(this).find("input[name='alloc_id']").val(),
        unique_id = $(this).find("input[name='unique_id']").val();

        var informed_message = "<a href='MY_DOMAIN/MY_PHP_FILE.php?id=" + unique_id + "&alloc_id=" + alloc_id + "'>Click here</a>!</p>";
        mail(email, "", "FROM", "SUBJECT", informed_message, "");

        $.post(
            "update_form_url.php",
            { update: "lead_revise", alloc_id: alloc_id, unique_id: unique_id },
            function(data) {
                // do stuff
            }
        );  
}); 
```

在`mail()`上面的代码中是一个包装器，它向使用 PHP发送电子邮件`POST`的 PHP 文件发出请求。`mail()`

任何想法为什么要添加空格并因此编码为“％20”？因为在数据库中，该`unique_id`字段不包含任何空格，并且日期的MD5不包含任何空格。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:46:48.097

这很正常，请阅读此[http://php.net/manual/en/function.urldecode.php](http://php.net/manual/en/function.urldecode.php)

如果你想删除它们，你可以随时使用`trim`

我很仓促，让我解释一个适当的解决方案。我建议开始做一些调试，空格是否出现在PHP中？简单地回显它并查看结果。在 JS 中使用控制台登录，并让我们保持更新。此外，如果 md5 的长度为 32 位并且末尾出现“”（第 33 位），为什么不修剪它呢？但我怀疑它出现在 php

# selenium - 无法使用 Selenium“单击（）”一个单选元素

> ID：14486952
> 
> 赞同：0
> 
> 时间：2013-01-23T18:05:34.380
> 
> 标签：selenium

下面是html。

```
<input type="radio" onclick="getOrgList('1000149');" value="1000149" name="wlw-radio_button_group_key:{pageFlow.viewBy}"> 
```

我在用

```
driver.findElement(By.xpath("//input[@name='wlw-radio_button_group_key:{pageFlow.viewBy}' and @value='1000149']")).click(); 
```

或者

```
driver.findElement(By.xpath("//input[@value='1000149']")).click(); 
```

但什么也没发生。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T07:45:26.177

如果此单选按钮在其组中是第二个或第三个，则定位器似乎不起作用的可能情况。因为属于一个组的单选按钮具有相同的名称如果是这种情况，那么您可以使用“以下”，如 //输入[包含(@name,'wlw-radio_button_group_key:{pageFlow.viewBy}')]/following::input[contains(@name,'wlw-radio_button_group_key:{pageFlow.viewBy}')]

如果组中有更多按钮，您可以更多地关注它。

# eclipse - Ubuntu 12.04 Eclipse Indigo 无法启动

> ID：14486953
> 
> 赞同：0
> 
> 时间：2013-01-23T18:40:00.657
> 
> 标签：eclipse, ubuntu, ubuntu-12.04

请帮助 :( 我的 Eclipse Indigo 无法启动。它显示了蓝色的小矩形，然后挂在上面。如果我再把另一个窗口放在前面，蓝色方块现在是灰色的。没有错误，也没有错误日志文件.eclipse 文件夹。

我的 Ubuntu 12.04 一直表现得很有趣。软件安装程序不起作用，并且更新管理器中有错误。我终于用 apt-get 做了命令行-update，从那以后我的 Eclipse 就坏了。

系统 ：

Ubuntu 12.04 X 64

java版本

java 版本“1.7.0_11”Java(TM) SE 运行时环境（构建 1.7.0_11-b21）Java HotSpot(TM) 64 位服务器 VM（构建 23.6-b04，混合模式）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T15:14:27.703

过去，我一直被 Ubuntu 存储库中捆绑的 Eclipse 包所困扰。我建议直接从 Eclipse 的网站下载并从那里运行。

如果您在启动 Ubuntu 版本时遇到问题，手动提取和运行应该会给您一些迹象，表明问题出在 Java 或 Eclipse 上。

# c# - 引用 Windows 服务的 WCF 调用

> ID：14486954
> 
> 赞同：0
> 
> 时间：2013-01-23T18:40:02.277
> 
> 标签：c#, .net, wcf, service

我有一个长期运行的服务，它从一个来源获取数据，对其进行操作，将其存储在数据库中，等等。

我想将该服务上的一些方法公开给其他应用程序。目前我们通过 .NET Remoting 执行此操作，但我想转移到 WCF。

不幸的是，我连接的端点从来都不是我通过长期运行的服务公开的端点。下面是一个简单的例子：

```
 [ServiceContract]
    public interface ITestWcfService
    {
        [OperationContract]
        CounterResult GetCurrentValue();
    }

public class TestWcfService : ITestWcfService
    {
        private ITestWindowsService _service;
        public TestWcfService() { /*NOTE: For discoverability*/ }
        public TestWcfService(ITestWindowsService service)
        {
            _service = service;
        }

        public CounterResult GetCurrentValue()
        {
            return _service.GetCurrentValue();
        }
    }

public interface ITestWindowsService
    {
        CounterResult GetCurrentValue();
    } 
```

然后我有我的实际 Windows 服务，它通过 ServiceHost 类自托管 WCF 服务。

```
public partial class TestWindowsService : ServiceBase, ITestWindowsService
{
    private static ServiceHost _wcfService;

    public TestWindowsService()
    {
        InitializeComponent();
    }

    public void OnStart(string[] args)
    {
        //Create instance of WCF, passing in reference to this service instance
        TestWcfService wcf = new TestWcfService(this);
        _wcfService = new ServiceHost(wcf);
    }

        public CounterResult GetCurrentValue()
    {
        //Note: Some logic here
    }
} 
```

现在，这或多或少的工作，除了每次我调用`TestWcfServiceClient()`，它使用默认构造函数并创建 Wcf 服务的新实例，而不使用 Windows 服务创建的实例。这意味着当我调用时，`GetCurrentValue()`我得到一个空引用，因为该`_service`成员尚未设置。

我环顾四周寻找解决方案，发现了一些引用`ServiceHostFactory`，`ServiceHost`但`IInstanceProvider`每一个似乎都非常非常复杂。

您能提供的任何想法将不胜感激。

**编辑**：这是我的 ServiceModel 信息

```
<system.serviceModel>
    <services>
      <service name="WcfService.TestWcfService">
        <host>
          <baseAddresses>
            <add baseAddress = "http://localhost:8733/Design_Time_Addresses/WcfService/TestWcfService/" />
          </baseAddresses>
        </host>
        <!-- Service Endpoints -->
        <!-- Unless fully qualified, address is relative to base address supplied above -->
        <endpoint address="" binding="basicHttpBinding" contract="WcfService.ITestWcfService">
          <!-- 
              Upon deployment, the following identity element should be removed or replaced to reflect the 
              identity under which the deployed service runs.  If removed, WCF will infer an appropriate identity 
              automatically.
          -->
          <identity>
            <dns value="localhost"/>
          </identity>
        </endpoint>
        <!-- Metadata Endpoints -->
        <!-- The Metadata Exchange endpoint is used by the service to describe itself to clients. --> 
        <!-- This endpoint does not use a secure binding and should be secured or removed before deployment -->
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, 
          set the values below to false before deployment -->
          <serviceMetadata httpGetEnabled="True" httpsGetEnabled="True"/>
          <!-- To receive exception details in faults for debugging purposes, 
          set the value below to true.  Set to false before deployment 
          to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="False" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T16:51:02.767

您正在尝试将方形钉子放入圆孔中。

WCF 被明确设计为能够独立于其托管方式调用业务逻辑。您正在尝试维护在主机层中具有业务逻辑的旧远程处理设计（在本例中为 Window 的服务）。因此，您要求以一种在 WCF 中可行但丑陋的方式将信息传递回主机，并且出于许多充分的理由通常会避免这种方式。

如果您想要一个干净的 WCF 设计，您将需要创建抽象层并将您的业务逻辑移出现有的 TestWindowsService 类。然后windows服务创建WCF服务宿主，WCF宿主创建WCF服务，WCF服务不依赖于承载它的类。

说了这么多...

**要实际回答您的问题：**

从概念上讲，您编写的代码应该可以工作。迄今为止，将对象实例传递给 ServiceHost 构造函数是避免编写自定义 IInstanceProvider 的复杂性的最简单方法。有几件事要检查：

1.  当您将服务实例传递给 ServiceHost 构造函数时，需要将其标记为[单例](http://msdn.microsoft.com/en-us/library/system.servicemodel.instancecontextmode.aspx)。

    [服务行为（InstanceContextMode=InstanceContextMode.Single）]

2.  确保初始化确实按照您认为的方式工作：

    1.  在您的 TestService(ITestWindowsService) 构造函数上放置一个守卫，如果服务为空则抛出该构造函数。
    2.  您对 TestWcfService() 的默认构造函数有评论，上面写着“可发现性”。我会删除该构造函数（至少在您进行故障排除时）。一段代码可能正在使用该构造函数来托管您不想要的服务实例。这可能会导致您的应用程序开始抛出异常或编译指出您的真正问题的错误。

如果您仍然遇到问题：您的 app.config 的服务模型部分是什么样的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:47:20.837

WCF 是非常可扩展的，但是为了提供这种可扩展性，它也非常复杂。在我看来，如果你想使用这个实现，那么应该不止如此，这就是要走的路。您必须创建一种更改服务工厂的行为，以便您可以使用自定义构造函数而不是空构造函数。

但是，我认为可能还有另一种选择。由于服务和 WCF 共享同一个应用程序域，它们可以通过静态对象共享值。

我会将带有您想要公开的值的逻辑移动到底层程序集（如果您还没有），并且服务和 WCF 服务都会看到相同的实例，因此您不需要更改所有 WCF 管道。

# sql - 如何让我的联合查询结果正确分组？

> ID：14486958
> 
> 赞同：1
> 
> 时间：2013-01-23T18:40:27.407
> 
> 标签：sql, group-by, union

我有这个代码：

```
SELECT tenant.scode
,tenant.sunitcode
,rtrim(tenant.sLastName) + ', ' + (tenant.sFirstName)
,charge.total
,tenant.istatus
,tenant.dtmovein

FROM tenant
LEFT OUTER JOIN (
SELECT sum(CASE 
            WHEN trans.itype = 6
                THEN stotalamount * - 1
            ELSE CASE 
                    WHEN trans.itype = 3
                        THEN stotalamount * - 1
                    ELSE stotalamount
                    END
            END) total
    ,hperson
FROM trans
    where trans.itype in (6,7)
GROUP BY hperson
) charge ON tenant.hmyperson = charge.hperson
WHERE charge.total IS NOT NULL
AND charge.total <> 0
AND tenant.istatus IN (
    0
    ,3
    ,4
    )
and hproperty = 2396

UNION ALL

SELECT  tenant.scode
 ,tenant.sunitcode
,rtrim(tenant.sLastName) + ', ' + (tenant.sFirstName)
,charge.total
    ,tenant.istatus
,tenant.dtmovein

FROM tenant
LEFT OUTER JOIN tenant t2 on (tenant.sleasefield36 = t2.scode)
LEFT OUTER JOIN (
SELECT sum(CASE 
            WHEN trans.itype = 6
                THEN stotalamount * - 1
            ELSE CASE 
                    WHEN trans.itype = 3
                        THEN stotalamount * - 1
                    ELSE stotalamount
                    END
            END) total
    ,hperson
FROM trans
    where itype in (6,7)
GROUP BY hperson
) charge ON t2.hmyperson = charge.hperson
WHERE charge.total IS NOT NULL
AND charge.total <> 0
AND tenant.istatus IN (
    0
    ,3
    ,4
    )
and tenant.hproperty = 2396

ORDER BY total 
```

它从某个物业中检索拖欠租金和其他款项的所有租户以及他们所欠的款项。

我的问题是其中一处房产最近已售出，所以现在我需要从以前的房产中检索其旧余额并将其添加到新房产的余额中。我基本上可以正常工作，但是两个金额（旧属性中的 1 和新属性中的 1）在我的结果中显示为两个单独的行。第一个余额金额是从第一个查询中检索的，第二个是从 UNION ALL 之后的查询中检索的。

如何使每个租户的这两行合并余额金额，以便每个租户都有一个结果行？

提前致谢！:) 让我知道是否可以提供更多详细信息

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:59:54.030

快速，脑残的答案（注意你必须给你的最后一个，第一个串联一个名字，比如“名字”）：

```
SELECT
    scode,
    sunitcode,
    name,
    SUM(total),
    istatus,
    dtmovein
FROM (
 <your first query>
 UNION ALL
 <your second query>
) AS all_data
GROUP BY
    scode,
    sunitcode,
    name,
    istatus,
    dtmovein 
```

# delphi - XML 中的位操作 Delphi - 按位

> ID：14486960
> 
> 赞同：5
> 
> 时间：2013-01-23T18:40:35.693
> 
> 标签：delphi, delphi-xe2, bit-manipulation

我是一名高中生，目前正在学习 Delphi XE3。我们正在学习 BIT 操作。我们有一个任务，虽然我已经阅读了很多关于该主题的内容并了解在 Bits 和 SHL/SHR 中存储信息的整个过程，但我很难理解如何在 Delphi 中执行此过程。

任务如下：

```
Decimal        Hexidecimal    Binary
1              0x0001         0000000000000001
2              0x0002         0000000000000010
4              0x0004         0000000000000100 
```

在 XML 文件中传递一个整数值来标识选项集。例如。如果我想发送选项 1 和选项 2，我会添加 1+2=3。我会发送 3 作为数字来指定选项 1 和 2 为真。

在客户端，二进制值为 0000000000000011 = 3

根据我的阅读，我需要使用面具，但我不明白如何做到这一点。我将如何在 Delphi 中使用掩码来获取 True 或 False 的各个值。

我尝试在常规 Integer 变量中执行此操作，但它总是被视为 Integer，结果非常奇怪。如果我将整数转换为二进制字符串表示并遍历字符，则结果是正确的，但我假设我不应该对字符串执行此操作。任何帮助或示例将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:49:20.933

`and`您通常使用二元运算符检查是否在 Integer 变量中设置了特定位，然后使用`or`运算符设置各个位，如下所示：

```
const
  OPTION_X = $01;
  OPTION_Y = $02;
  OPTION_Z = $04;

var
  Options: Byte;
begin
  Options := OPTION_X or OPTION_Y;  //actually 3, like in your example
  //check if option_X is set
  if (Options and OPTION_X) = OPTION_X then
    ShowMessage('Option X is set');  //this message is shown, because the bit is set
  //check if option_Z is set
  if (Options and OPTION_Z) = OPTION_Z then
    ShowMessage('Option Z is set');  //this message is NOT shown
end; 
```

不同的`OPTION_`常量实际上是[掩码](http://en.wikipedia.org/wiki/Mask_%28computing%29)，从某种意义上说，它们用于将位掩码为零（以检查是否设置了特定位）或将​​位掩码为 1（以设置特定位）。

考虑这个片段：

```
begin
  ..

  if cbOptionX.Checked then
    Options := Options or OPTION_X;
  .. 
```

会将第`or`一位掩码为 1。如果我们从 01010000 的选项值（二进制）开始，则生成的选项将为 01010001

```
 01010000   
 OR 00000001  //OPTION_X 
  = 01010001 
```

相同的值用于将所有其他位屏蔽为 0，以检查是否设置了特定位。条件， `if`例如：`(Options and OPTION_Z) = OPTION_Z`，这样做：

*   首先它将Option变量的所有不感兴趣的字节掩码为0。如果我们考虑最后一个值01010001，该操作将导致清除所有位，但第一个。

    ```
     01010001   
    AND 00000001   
      = 00000001 
    ```

考虑到 01010000 的起始值，它将返回零：

```
 01010000   
    AND 00000001   
      = 00000000 
```

*   接下来，它比较该值是否等于掩码本身。如果相等，则在原始 Options 变量中设置该位，否则不设置。如果您的掩码仅包含一位，那是口味问题，您可以检查结果值是否不同于 0，但如果您的掩码包含多个位并且您想检查是否所有位都已设置，您必须检查是否相等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T19:19:27.027

Delphi 有一个预定义的类型 TIntegerSet，它允许使用集合运算符。假设这`options`是一个整数，您可以检查是否设置了任何位（从 0 开始），如下所示：

```
option1 := 0 in TIntegerSet(options); { Bit 0 is set? }
option3 := 2 in TIntegerSet(options); { Bit 2 is set? } 
```

更改选项是通过包含或排除完成的：

```
Include(TIntegerSet(options), 0); { set bit 0 }
Exclude(TIntegerSet(options), 2); { reset bit 2 } 
```

当然，您可以使用任何其他可能有用的集合运算符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T18:56:33.367

Delphi 具有用于操作整数类型的各个位的**位运算符。**查看`shl`, `shr`, `and`, `or`, 和`xor`运算符。要组合位，请使用`or`运算符。要测试位，请使用`and`运算符。例如，假设这些常量：

```
const
  Option1 = 0x0001;
  Option2 = 0x0002;
  Option3 = 0x0004; 
```

`or`运算符查看两个输入值的位，并产生一个输出值，该输出值在`1`任一输入值都有位的地方有一个`1`位。所以组合位看起来像这样：

```
var
  Value: Integer;
begin
  Value := Option1 or Option2;
  {
  00000000000000000000000000000001 Option1
  00000000000000000000000000000010 Option2
  -------------------------------- OR
  00000000000000000000000000000011 Result
  }
  ...
end; 
```

`and`运算符查看两个输入值的位并产生一个输出值，该输出值仅`1`在两个输入值都有位的地方有一个`1`位，否则它会产生一个`0`位。所以对位的测试看起来像这样：

```
var
  Value: Integer;
  Option1Set: Boolean;
  Option2Set: Boolean;
  Option3Set: Boolean;
begin
  Value := 7; // Option1 or Option2 or Option3

  Option1Set := (Value and Option1) = Option1;
  {
  00000000000000000000000000000111 Value
  00000000000000000000000000000001 Option1
  -------------------------------- AND
  00000000000000000000000000000001 Result
  }

  Option2Set := (Value and Option2) = Option2;
  {
  00000000000000000000000000000111 Value
  00000000000000000000000000000010 Option2
  -------------------------------- AND
  00000000000000000000000000000010 Result
  }

  Option3Set := (Value and Option3) = Option3;
  {
  00000000000000000000000000000111 Value
  00000000000000000000000000000100 Option3
  -------------------------------- AND
  00000000000000000000000000000100 Result
  }
  ...
end; 
```

# android - Sqlite，如何检查一行是否包含任一字符串

> ID：14486965
> 
> 赞同：0
> 
> 时间：2013-01-23T18:40:50.287
> 
> 标签：android, string, sqlite, row

使用下面的代码，我可以检查一行是否包含单个字符串（字符串 a），但我将如何检查一行是否等于任一字符串（字符串 a 或 b）？

```
public Cursor fetchMyList() {
        String[] columns = { KEY_ROWID, KEY_CATEGORY, KEY_SUMMARY,
                KEY_DESCRIPTION, KEY_EMAIL };
        String selection = "description=?";
        String a = "blue";
                String b = "red";

        String[] selectionArgs = { a };
               // String[] selectionArgs = { a , b}; ///tried this dont work!!
        Cursor cursor = null;
        try {
            cursor = database.query(DATABASE_TABLE, columns, selection,
                    selectionArgs, null, null, null);
        } catch (Exception e) {
            e.printStackTrace();
        }
        int numberOfRows = cursor.getCount();
        if (numberOfRows <= 0) {
            return cursor;
        }
        return cursor;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:42:59.207

如果声明 2 个参数，则只能传递 2 个参数。这就是你想要的：

```
String selection = "description=? OR description=?"; // Select rows with either description
String[] selectionArgs = {a , b}; 
```

我强烈建议您检查[SQL 语言](http://www.w3schools.com/sql/default.asp)。

PS：不要抓`Exception`。你以后会后悔的。捕获特定的异常子项；在你的情况下你想赶上`SQLException`。

PS2：使用`Log`而不是`printStackTrace()`.

# django - 将表单中的数据保存在数据库中。键错误

> ID：14486966
> 
> 赞同：0
> 
> 时间：2013-01-23T18:40:51.760
> 
> 标签：django

模型.py：

```
class Data(models.Model):
    name = models.CharField(max_length=250)
    is_big = models.BooleanField(default=False) 
```

表格.py：

```
class DataForm(ModelForm):

    class Meta:
        model = Data
        exclude = ['is_big'] 
```

而不是`is_big`从我创建的模型表单（在模板中）：

```
<div class="id_is_big-control-group control-group">

            <div class="controls">
                <label class="checkbox">
                    <input type="checkbox" disabled="disabled" checked="checked" name="is_big" id="id_is_big" /> <span>Is big?</span>
                </label>

         </div> 
```

如何将此值保存在数据库中？

```
form = DataForm(request.POST)
if form.is_valid():
    d = form.save(commit=False)
    d.is_big = form.cleaned_data['is_big']
    d.save() 
```

返回错误：**/site/'is_big' 处的 KeyError**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:47:04.550

`is_big`您已从模型表单中排除。这就是为什么它不存在于`cleaned_data`. 您需要从以下位置获取值`POST`：

```
is_big = request.POST.get('is_big') 
```

# jquery - 使用jquery而不是css打开jqueryui对话框后更改它的颜色

> ID：14486976
> 
> 赞同：0
> 
> 时间：2013-01-23T18:41:35.153
> 
> 标签：jquery, jquery-ui

我试图在打开 jqueryui 对话框后更改它的背景。要求阻止我在样式表中设置它，因为背景颜色或图像对于单击链接的人来说是唯一的（背景值是从数据库中提取的）。

当我在加载对话框后运行以下 jquery 命令来更改 div 的 css 时，它什么也没做？

```
$("#modal_popup_website").css("background","red !important"); 
```

或者

```
$("#modal_popup_website .ui-dialog-content").css("background","red !important"); 
```

或者

```
$(".ui-dialog-content").css("background","red !important"); 
```

我究竟做错了什么？

首先我初始化对话框如下：

```
$("#modal_popup_website").dialog({
            bgiframe: true,
            autoOpen: false,
            position: 'center',
            width: $(window).width()-30,
            minWidth: 990,
            height: 900,
            minHeight: 900,
            modal: true,
            stack: true, //Puts in front of other dialog's that may be open
            open: function(){

            },
            close: function() {
                //Save
            } 
```

然后，当用户单击这样的链接时，我打开对话框：

```
$("#modal_popup_website").dialog("open"); 
```

打开后，我将一些 HTML 放入对话框中，如下所示：

```
$("#modal_popup_website").html('gets loaded from external file'); 
```

下面是外部文件的 HTML：

```
<div>some text</div>
<script type="text/javascript">
   $("#modal_popup_website").css("background","red !important");
</script> 
```

而 <script> 区域是我尝试更改 css 背景的地方。在这个外部 PHP 文件中，我从数据库中为该用户检索背景颜色或图像，并且我想更改对话框的背景，但我无法使其工作。

任何想法将不胜感激！

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:46:27.010

这需要改变：

```
<div>some text</div>
<script type="text/javascript">
   $("#modal_popup_website").css("background","red !important");
</script> 
```

到：

```
<script type="text/javascript">
    $(document).ready(function() {
        $("#modal_popup_website").css("background","red");
    });
</script> 
```

这个链接应该有帮助：[http ://css-tricks.com/when-using-important-is-the-right-choice/](http://css-tricks.com/when-using-important-is-the-right-choice/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T23:12:54.997

我最终以另一种方式解决了这个问题。我添加了另一个 < div > 并将其设置为 100% 宽、100% 高度并使用 css 背景来添加图像。然后我删除了 jqueryui 对话框的滚动条，只是将 overflow:auto 添加到我添加的新 div 中，它给了我我需要的东西。

# android - 如何定时放弃 Android 线程？

> ID：14486981
> 
> 赞同：-2
> 
> 时间：2013-01-23T18:41:56.510
> 
> 标签：android, multithreading, time, block

我面临一个非常烦人的问题。我有一个代码要执行，可能需要几十秒。最后，我需要获得该计算的结果。

如果我只在主线程上执行代码，Android 会弹出告诉线程被阻塞并询问我们是否要强制阻塞。

那么原理是正常的，每个操作系统内核都需要知道我们的代码还活着并且没有被阻塞。

所以我的问题是如何通知 Android 我们没有死？例如，相当于 Sleep(0) 或 ProcessMessage() 或任何东西......但这会通知 Android 我们并没有死，因为我们只是在等待或执行相当长的时间......

请不要回答我：“让您在单独的线程中进行计算”，因为问题完全相同。主线程仍然需要坐下来了解线程何时完成及其结果。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T18:44:21.763

您不应运行任何访问数据库、互联网或在 UI 线程上花费超过 0.2 秒的进程。

Asynctask 是一种非常强大的方法，它允许您进行线程计算，同时仍然能够在预定点更新 UI。学会爱它。

只要让用户知道，请在执行前块上出现请等待微调器对话框，并使其在执行后块上消失。

编辑：深入研究一下：asynctask 具有三个块，它们在 UI 线程 onPreExecute、onPostExecute 和 onProgressUpdate 上运行）。在这些块中，您可以更新 UI。在 doInBackground 块中，它是自己的线程，因此在处理时不会阻塞 UI。

在实践中，您可以进行设置以通知 onPreExecute 中正在发生进程，在 onProgressUpdate 期间通知用户进度，然后在 onPostExecute 块期间显示最终信息/清除任何请等待对话框。它是专门为解决您正在讨论的确切问题而设计的。

任何通过在 UI 线程上运行而将系统锁定超过 4 秒的进程都会导致向用户显示无响应错误。

[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T19:42:33.770

我可能会对此感到震惊，但实际上，只在适当的情况下使用 AsyncTask ！（阅读：退出它！）

Virgil Dobjanschi 的回答在这里：

[http://www.youtube.com/watch?v=xHXn3Kg2IQE](http://www.youtube.com/watch?v=xHXn3Kg2IQE)

..是真的，真的很好。它有点复杂，但通常并不比实际问题复杂。

虽然原始问题中没有很多细节，但解决问题的最佳方法可能**是**（所有答案都同意）使用单独的线程。但是，到达该其他线程的最佳方式可能是在 IntentService 上触发一个意图。...然后 runOnUiThread 或 Handler 来获取响应。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T18:45:15.630

[您应该在另一个线程中计算，然后使用http://developer.android.com/reference/android/app/Activity.html#runOnUiThread(java.lang.Runnable](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread(java.lang.Runnable) )回调 UI 线程

有关详细信息，请参阅[http://developer.android.com/guide/components/processes-and-threads.html 。](http://developer.android.com/guide/components/processes-and-threads.html)

# visual-studio-2010 - 在 VS 中运行自定义工具

> ID：14486985
> 
> 赞同：1
> 
> 时间：2013-01-23T18:42:07.780
> 
> 标签：visual-studio-2010, resx, vsix, visual-studio-templates

我正在创建一个内部 VS 模板来创建一个多语言网站的新版本，其中包含由向导填充的自定义字段。一切顺利，直到我尝试运行该程序。跑步后，我收到...

**找不到适合指定区域性或中性区域性的任何资源。确保“<My Namespace>.Global.resources”在编译时被正确嵌入或链接到程序集“<My program>”中，或者所有需要的附属程序集都是可加载的并且是完全签名的。**

如果我打开 resx 文件并保存它们，或者选择在构建之前运行自定义工具，它可以正常工作，但如果我在创建项目后立即尝试构建，我会收到该错误。

我对所有 resx 文件的设置都是...

*   构建操作 - 嵌入式资源
*   复制到输出目录 - 不要复制
*   自定义工具 - PublicResXFileCodeGenerator
*   自定义工具命名空间 - <我的命名空间>

大多数情况下，我只是在寻找一种在构建时运行自定义工具的方法。正如我所描述的那样，这确实需要工作。这是一家大公司，非程序员/非专家在这里工作。

在此先感谢，安德鲁

# networking - 如何指定网络要求以确保 QoS？

> ID：14486987
> 
> 赞同：1
> 
> 时间：2013-01-23T18:42:12.490
> 
> 标签：networking, documentation, hardware, requirements

当我查看许多数据库支持的企业解决方案的硬件需求时，我发现对应用程序服务器（操作系统、处理器、RAM、磁盘空间等）、数据库服务器（版本、RAM 等）和客户端的需求。

[以下是 Oracle 融合中间件的示例。](http://docs.oracle.com/cd/E25054_01/doc.1111/e15722/overview.htm#CJAHADHD)

我找不到对网络速度或架构（交换机速度、SAN IOPS、RIOPS 等）的要求。我不希望我的应用程序带来糟糕的用户体验，而是由客户端环境中的网络延迟引起的。

在向客户发送所需的硬件要求规范时，您如何注意这些方面的要求？网络性能的相关衡量标准是什么？（或者它只是需要 IOPS= *x*）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T17:18:24.797

通常，需求的详细程度不止一个级别。例如，您通常会将详细程度划分为从 0（粗略的使命陈述）到 4（技术细节）的范围。

因此，如果您指定您的 SAN 应以至少 x 的带宽容量运行，那么在该规模上这将是一个很大的数字。确保将您的主要想法（系统应具有响应性，以防止客户变得不耐烦并转向竞争对手......）分解为更可衡量的目标（如上所述）。

Stephen Withall 在他的“软件需求模式”一书中写下了很好的例子。见第 9 章，第 191 页 ff.，它并不贵。他将其分解为关于响应时间、吞吐量、动态容量、静态容量和可用性的建议，我引用。

当然，那是软件！因为基本上，最好从定义整个系统在特定情况下断言的内容开始：我们什么时候开始测量？（例如，当客户端请求进入网络网关时）；我们假设超出我们影响的平均网络延迟是多少？我们测量了多少不同的客户以及这些客户联系了多少不同的自治系统？他们究竟执行什么样的任务，以及对什么样的资源要求特别高？我们什么时候停下来测量？我们真的对所有硬件都进行了完整的系统测试吗？我们将在运行时提供哪些类型的网络监控？等等

这应该比您只为传输速率/ IOPS 之类的单位分配一个值更能帮助您，这甚至可能无法解决您的问题。如果您以后发现网络硬件的性能低于您的预期，则更换起来相当容易。特别是如果您将托管服务交给外部合作伙伴。然而，该软件并不容易更换。

请务必区分您必须满足的要求或约束，以及您提供的技术解决方案的实际组成部分。可能还有更多解决方案。速度是一项要求（虽然是一个模糊的要求）。硬件架构是一种解决方案。

# asp.net-mvc-3 - 使用 jquery Ajax MVC 验证表单

> ID：14486988
> 
> 赞同：0
> 
> 时间：2013-01-23T18:42:14.300
> 
> 标签：asp.net-mvc-3, jquery

到目前为止，我一直在使用 Microsoft Ajax 在我的 MVC 应用程序中进行更新。我现在切换到 jQuery Ajax 以标准化我的方法。

但是，我刚刚意识到我的模型中表单的必填字段没有触发，即使某些必填字段留空，用户也能够提交表单。

如果我正在使用 jQuery 处理我的 ajax 函数，那么处理必填字段的标准方法是什么——即我希望通过突出显示我的必填字段并且不允许单击提交按钮来不显眼地处理我的必填字段。

另外，要提一下，我正在通过模型获取 data-val 属性。

PS 我现在使用事件处理程序来检测表单提交按钮上的点击事件。换句话说，我没有使用@using.Ajax.BeginForm 来定义我的表单。

# android - 适用于所有设备的 Android 应用

> ID：14486993
> 
> 赞同：0
> 
> 时间：2013-01-23T18:42:33.700
> 
> 标签：android, android-animation, android-4.0-ice-cream-sandwich, android-2.3-gingerbread

我正在开发一个针对 2.3 版的应用程序，以便它可以在我姐姐的手机上运行。但是，我可以在手机上运行 4.0。我想添加一些滑动动画等，但我不会在她的手机上运行动画。

这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:47:10.073

是的，只需将 API 特定代码放在 if/else 块中，因此仅在系统支持时才调用它：

像这样：

```
if (currentapiVersion < android.os.Build.VERSION_CODES.JELLY_BEAN) {
//do things that are only supported on JellyBean
} else {
//do the other stuff
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T19:57:18.117

您可以使用`ViewPager`and在各种s`FragmentPagerAdapter`之间提供滑动功能。`Fragment`所有这些都在支持库中可用。

`ViewPager`（注意，不要对 做任何事情`ActionBar`，因为它们还没有在支持库中）：http: [//developer.android.com/reference/android/support/v4/view/ViewPager.html](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)

`FragmentPagerAdapter`（几乎是您需要的示例代码）：http: [//developer.android.com/reference/android/support/v13/app/FragmentPagerAdapter.html](http://developer.android.com/reference/android/support/v13/app/FragmentPagerAdapter.html)

`Fragment`：http: [//developer.android.com/reference/android/support/v4/app/Fragment.html](http://developer.android.com/reference/android/support/v4/app/Fragment.html)