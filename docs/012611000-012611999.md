# StackOverflow 问答 12611000-12611999

# xcode - 无法使用地址簿在设备上保存联系人 - xcode

> ID：12611006
> 
> 赞同：1
> 
> 时间：2012-09-26T21:50:17.353
> 
> 标签：xcode, addressbook, abaddressbook, abperson

我找到了将 vcard 保存到设备的代码。此代码在模拟器上运行完美，但在设备上尝试代码时，我看不到新联系人。代码是：

```
NSString *vCardString = @"BEGIN:VCARD\nVERSION:2.1\nN:Standard11.3,Joe;\nADR:PO Box 555,Suite 55,5555 Any Street,San Diego,CA,92111,USA;;\nEND:VCARD";

    CFDataRef vCardData = (CFDataRef)CFBridgingRetain([vCardString dataUsingEncoding:NSUTF8StringEncoding]);  ABAddressBookRef book = ABAddressBookCreate();
    ABRecordRef defaultSource = ABAddressBookCopyDefaultSource(book);
    CFArrayRef vCardPeople = ABPersonCreatePeopleInSourceWithVCardRepresentation(defaultSource, vCardData);
    CFRelease(vCardData);
    for (CFIndex index = 0; index < CFArrayGetCount(vCardPeople); index++) {
        ABRecordRef person = CFArrayGetValueAtIndex(vCardPeople, index);
        ABAddressBookAddRecord(book, person, NULL);
        //CFRelease(person);
    }
    CFRelease(vCardPeople);
    CFRelease(defaultSource);
    ABAddressBookSave(book, NULL);
    CFRelease(book); 
```

知道为什么吗？另一件事，是我在其他应用程序中看到设置使用通讯录的权限，也许这就是解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T18:02:11.313

如果这是在 iOS 6 上，您需要征得用户的许可才能访问地址簿。

```
ABAddressBookRef ref = ABAddressBookCreate();
ABAddressBookRequestAccessWithCompletion(ref, ^(bool granted, CFErrorRef error) {
   if(granted) {
      //Use the address book
   }
}); 
```

这将弹出提示，以便用户可以批准您的应用程序。

# android - 自动视差andeengine：黑屏

> ID：12611010
> 
> 赞同：2
> 
> 时间：2012-09-26T21:50:28.307
> 
> 标签：android, andengine

Autoparallax [AndEngine](http://www.andengine.org/)给出一个黑屏。

```
public class MainActivity extends SimpleBaseGameActivity {
    static final int CAMERA_WIDTH = 480;
    static final int CAMERA_HEIGHT = 320;
    int k = 700;
    public Font mFont;
    public Camera mCamera;

    // A reference to the current scene
    public Scene mCurrentScene;

    public BitmapTextureAtlas mAutoParallaxBackgroundTexture;
    public TextureRegion mParallaxLayer;

    public static MainActivity instance;

    public static MainActivity getSharedInstance() {
        return instance;
    }

    @Override
    public EngineOptions onCreateEngineOptions() {
        instance = this;
        mCamera = new Camera(0, 0, CAMERA_WIDTH, CAMERA_HEIGHT);

        return new EngineOptions(true, ScreenOrientation.LANDSCAPE_FIXED, new RatioResolutionPolicy(CAMERA_WIDTH, CAMERA_HEIGHT),
                mCamera);
    }

    @Override
    protected void onCreateResources() {
        BitmapTextureAtlasTextureRegionFactory.setAssetBasePath("gfx/");

        mAutoParallaxBackgroundTexture = new BitmapTextureAtlas(this.getTextureManager(), 1024, 1024, TextureOptions.DEFAULT);

        mParallaxLayer = BitmapTextureAtlasTextureRegionFactory.createFromAsset(this.mAutoParallaxBackgroundTexture, this,
                "background.png", 0, 0);
    }

    @Override
    protected Scene onCreateScene() {
        mEngine.registerUpdateHandler(new FPSLogger());

        mCurrentScene = new Scene();

        final AutoParallaxBackground autoParallaxBackground = new AutoParallaxBackground(0, 0, 0, 10);
        autoParallaxBackground.attachParallaxEntity(new ParallaxEntity(5.0f, new Sprite(0, mCamera.getHeight()
                - this.mParallaxLayer.getHeight(), this.mParallaxLayer, this.getVertexBufferObjectManager())));
        mCurrentScene.setBackground(autoParallaxBackground);

        return mCurrentScene;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:59:39.683

看起来您没有“加载” TextureAtlas。在块的末尾添加`onCreateResources()`：

```
mAutoParallaxBackgroundTexture.load(); 
```

# python - Python Fabric 从单独的文件加载配置

> ID：12611020
> 
> 赞同：2
> 
> 时间：2012-09-26T21:51:20.077
> 
> 标签：python, passwords, fabric

我在一个 .fab 文件中使用带有所有配置的 python 结构。
如何将敏感数据作为密码放入单独的文件，然后导入/加载到 fab 主文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T22:46:52.667

在你的 fabfile.py 中定义一个简单的函数来从一个单独的文件中读取你的密码。类似于以下内容：

```
def new_getpass(username):
    with open("/etc/passwd", "r") as f:
        for entry in [l.split(":") for l in f.readlines()]:
            if entry[0] == username:
                return entry
    return None 
```

这将`None`在找不到用户名的情况下返回，并且在找到用户的情况下将整个用户的记录作为列表返回。

显然，我的示例是从中获取数据，`/etc/passwd`但您可以轻松地将这个基本功能调整到您自己的文件中：

`credentials.dat`

```
database1|abcd1234
database2|zyxw0987 
```

然后将上面的代码修改为像这样使用这个文件，稍有变化只返回密码（因为我们知道数据库名称）：

```
def getpass(database):
    with open("credentials.dat", "r") as f:
        for entry in [l.split("|") for l in f.readlines()]:
            if entry[0] == username:
                return entry[1]
    return None 
```

虽然不像导入那么简单，但它为您提供了使用纯文本文件存储凭据的灵活性。

# c++ - 分段错误：在 C++ 中弹出向量时出现 11

> ID：12611029
> 
> 赞同：1
> 
> 时间：2012-09-26T21:52:13.463
> 
> 标签：c++, vector, segmentation-fault

理想情况下，我想在这个程序中使用一个堆栈，但它不允许我这样做。我不断收到段错误 11。我通过创建一个新向量并将其设置为等于第一个向量然后弹出新向量来解决这种问题。但我最终需要将弹出的向量与第一个向量同步，但它会引发段错误 11。

无论如何，这里是代码，它是另一个项目的一部分，但我认为上下文不太重要，无法知道它的用途。此外，这确实会在我运行此方法时编译它，它会引发错误。

```
void print_well_formed_file(ifstream& ifs) {
   vector<string> vec;
   vector<string> finalVec;
   string line;
   string a;
   string temp;
   string final;
Lexer lexer;
Token tok;
while (getline(ifs, line)) {
    lexer.set_input(line);
    while (lexer.has_more_token()) {
        tok = lexer.next_token();
        switch (tok.type) {
            case TAG:
                if (tok.value[0] != '/'){
                    a = (tok.value);
                    if (a == "red") {
                        a = "\033[31m";
                    }
                    if (a == "green") {
                        a = "\033[32m";
                    }
                    if (a == "blue") {
                        a = "\033[34m";
                    }
                    if (a == "yellow") {
                        a = "\033[33m";
                    }
                    if (a == "magenta") {
                        a = "\033[31m";
                    }
                    if (a == "cyan") {
                        a = "\033[36m";
                    }
                    if (a == "dim") {
                        a = "\033[2m";
                    }
                    if (a == "underline") {
                        a = "\033[4m";
                    }
                    if (a == "bright") {
                        a = "\033[1m";
                    }

                    vec.push_back(a);
                    final = temp + a;
                }
                else{
                    string s;
                    string temp;
                    string fin;

                    finalVec = vec;
                    if(!finalVec.empty()){finalVec.pop_back();}
                    a = "\033[0m" + finalVec.back();
                    temp = final;
                    final = temp + a;
                    if(!vec.empty()){vec.pop_back();} // throws an error
                    vec = finalVec; // throws an error
                }
            break;
            case IDENT:
                a= (tok.value)+ " ";
                temp = final;
                final = temp + a;
                break;
        }
    }
}
cout << final << endl;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:35:39.370

```
 if(!finalVec.empty()){finalVec.pop_back();}
                a = "\033[0m" + finalVec.back();              // <-- bug 
```

显然是错误的：`finalVec.back()`可能不存在：由于刚刚弹出最后一个元素，因此向量可能为空。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:09:25.760

您不能从*空*向量中弹出或获取元素。这是未定义的行为，它可能会使您的应用程序崩溃。

*您可以通过检查代码中每次*访问之前的长度来验证这是问题所在（您只是“随机”选择了最新更新中的一个位置）。看，它真的很简单.. 如果它是空的，只需显示一条错误消息。

# sql - SQL 语句 - 大多数

> ID：12611034
> 
> 赞同：-3
> 
> 时间：2012-09-26T21:52:53.267
> 
> 标签：sql

对于以下数据库架构：

```
Medication-MedicationID, BrandName, GenericName 
```

检索处方最多的通用药物名称的 SQL 语句是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:57:32.217

你可以使用这样的东西来获得处方最多的物品：

```
select max(GenericCount)
from
(
    select count(*) GenericCount, GenericName
    from yourtable
    group by GenericName
) x 
```

如果您想查看每个规定的数字，请使用：

```
 select count(*) GenericCount, GenericName
    from yourtable
    group by GenericName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:58:21.260

```
SELECT MAX(COUNT(GenericName)), GenericName FROM MedicationTable GROUP BY GenericName 
```

表的命名位置`MedicationTable`

# python - 带有“分组依据”或“uniq”的统计信息

> ID：12611035
> 
> 赞同：3
> 
> 时间：2012-09-26T21:53:09.563
> 
> 标签：python, mysql, perl, shell

我有以下“basefile.csv”

```
AAM7676,2012-02-02 11:55:52,32,2012-02-03 19:55:30,62,1
AAM7676,2012-02-11 13:56:11,32,2012-02-12 21:00:18,52,2
AAM7676,2012-02-21 16:30:55,32,2012-02-23 13:29:41,62,1
AAM7676,2012-03-07 20:03:32,32,2012-03-09 13:31:35,62,1
AAM7676,2012-05-28 06:08:05,32,2012-05-29 15:49:55,52,2
AAM7676,2012-08-22 12:47:28,32,2012-08-24 08:03:09,52,1
AAO9229,2012-01-10 07:19:29,32,2012-01-11 16:39:16,52,2
AAP0678,2012-04-09 16:35:19,32,2012-04-10 19:46:55,52,2
AAP0678,2012-04-30 16:44:28,32,2012-05-01 19:20:00,52,2
AAP0678,2012-06-01 19:31:34,32,2012-06-03 10:34:33,52,3
AAU6100,2012-01-09 17:49:13,32,2012-01-11 02:00:33,52,3
AAU6100,2012-01-20 21:18:16,32,2012-01-22 14:09:00,52,3
AAU6100,2012-02-20 13:35:39,32,2012-02-21 19:45:55,52,2
AAU6100,2012-03-13 09:50:51,32,2012-03-14 22:35:51,52,3 
```

根据第 1 列（车牌）和第 4 列（日期时间），我想统计一下每个月（第 4 列）有多少次车牌（第 1 列）出现。

最终格式，应该是：

```
plate,jan,feb,mar,abr,may,jun,jul,aug,sep.oct,nov,dec,total
AAM7676,0,3,1,0,1,0,0,1,0,0,0,0,6
AAO9229,1,0,0,0,0,0,0,0,0,0,0,0,1
AAP0678,0,0,0,1,1,1,0,0,0,0,0,0,3
AAU6100,2,1,1,0,0,0,0,0,0,0,0,0,4 
```

我已经玩过（并搜索了解决方案）shell脚本和MySQL，但没有弄清楚如何解决它......可能是因为我是新手......

任何类型的解决方案都将受到欢迎（MySQL、sh、perl、python、...）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T22:38:24.923

这基本上是[Python Pandas](http://pandas.pydata.org/)的典型问题。我假设列标题名称：license、time1、num1、time2、num2、count（按此顺序）。

```
import pandas, numpy as np
df = pandas.io.parsers.read_csv("baseline.csv")
df["month"] = df["time2"].map(lambda x: int(x.split('-')[1]))
df.groupby(["license","month"]).apply(len) 
```

输出：

```
license  month
AAM7676  2        3
         3        1
         5        1
         8        1
AAO9229  1        1
AAP0678  4        1
         5        1
         6        1
AAU6100  1        2
         2        1
         3        1 
```

然后你就有了一个多索引的 Pandas 系列计数，所以你可以根据需要格式化输出表。但是，格式化以直接从 Pandas 打印非常类似于您想要的内容并不难：

```
t = df.groupby(["license","month"]).apply(len)
t.unstack(level=0).reindex(index=range(1,13), fill_value=0).T.fillna(0) 
```

打印出来：

```
 1   2   3   4   5   6   7   8   9   10  11  12
      license
count AAM7676   0   3   1   0   1   0   0   1   0   0   0   0
      AAO9229   1   0   0   0   0   0   0   0   0   0   0   0
      AAP0678   0   0   0   1   1   1   0   0   0   0   0   0
      AAU6100   2   1   1   0   0   0   0   0   0   0   0   0 
```

虽然此解决方案需要 (a) 标头名称和 (b) 两个第三方库；它带来了巨大的胜利。您可以非常轻松地聚合和应用分组操作，并且它们像 NumPy 一样进行了优化。如果需要，这对于非常大的数据或使用您的数据计算许多不同的辅助统计数据非常有效。

让我说清楚，因为我通常会因为这样的答案而被击落。知道如何用纯 Python 做到这一点是一件很棒的事情，Python 程序员应该花时间去学习它。但是，不要仅仅为了 Python 而重新发明轮子。Pandas 为这种数据操作提供了一些很棒的工具。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-26T22:21:19.377

以下 Python 解决方案应该可以工作：

```
import csv
import collections

result = collections.OrderedDict()
for cols in csv.reader(open('basefile.csv')):
    if len(cols) != 6:
        continue
    plate = cols[0]
    month = int(cols[3][5:7])
    result.setdefault(plate, [plate] + [0]*12)[month] += 1

print 'plate,jan,feb,mar,abr,may,jun,jul,aug,sep.oct,nov,dec,total'
for row in result.values():
    print ','.join(map(str, row)) + ',' + str(sum(row[1:])) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-27T00:13:41.523

使用 gawk：

```
gawk -F, '
    {
        plate[$1]++
        split($4, dt, /-0*/)
        count[$1,dt[2]]++
    }
    END {
        print "plate,jan,feb,mar,apr,may,jun,jul,aug,sep,oct,nov,dec,total"
        n = asorti(plate, ordered_plates)
        for (i=1; i<=n; i++) {
            p = ordered_plates[i]
            printf("%s,", p)
            for (m=1; m<=12; m++) 
                printf("%d,", count[p,m])
            print plate[p]
        }
    }
' basefile.csv 
```

输出

```
plate,jan,feb,mar,apr,may,jun,jul,aug,sep,oct,nov,dec,total
AAM7676,0,3,1,0,1,0,0,1,0,0,0,0,6
AAO9229,1,0,0,0,0,0,0,0,0,0,0,0,1
AAP0678,0,0,0,1,1,1,0,0,0,0,0,0,3
AAU6100,2,1,1,0,0,0,0,0,0,0,0,0,4 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-27T00:28:38.690

Perl 解决方案。它假定任何字段中都没有嵌入的逗号。

```
#!/usr/bin/perl
use strict;
use warnings;
use List::Util qw/ sum /;

my %data;
while (<DATA>) {
    my ($plate, $col4) = (split /,/)[0, 3];
    my ($month) = $col4 =~ /-(\d\d)-/;
    $data{$plate}{$month}++;
}

print join(",", qw/ plate jan feb mar apr may jun jul aug sep oct nov dec total /), "\n";

for my $plate (sort keys %data) {
    my @per_month = map $data{$plate}{$_} || 0, '01' .. '12';
    print join(",", $plate, @per_month, sum @per_month), "\n";
}

__DATA__
AAM7676,2012-02-02 11:55:52,32,2012-02-03 19:55:30,62,1 
AAM7676,2012-02-11 13:56:11,32,2012-02-12 21:00:18,52,2 
AAM7676,2012-02-21 16:30:55,32,2012-02-23 13:29:41,62,1 
AAM7676,2012-03-07 20:03:32,32,2012-03-09 13:31:35,62,1 
AAM7676,2012-05-28 06:08:05,32,2012-05-29 15:49:55,52,2 
AAM7676,2012-08-22 12:47:28,32,2012-08-24 08:03:09,52,1 
AAO9229,2012-01-10 07:19:29,32,2012-01-11 16:39:16,52,2 
AAP0678,2012-04-09 16:35:19,32,2012-04-10 19:46:55,52,2 
AAP0678,2012-04-30 16:44:28,32,2012-05-01 19:20:00,52,2 
AAP0678,2012-06-01 19:31:34,32,2012-06-03 10:34:33,52,3 
AAU6100,2012-01-09 17:49:13,32,2012-01-11 02:00:33,52,3 
AAU6100,2012-01-20 21:18:16,32,2012-01-22 14:09:00,52,3 
AAU6100,2012-02-20 13:35:39,32,2012-02-21 19:45:55,52,2 
AAU6100,2012-03-13 09:50:51,32,2012-03-14 22:35:51,52,3 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-26T22:25:49.437

我会保留一个列表字典：

```
from collections import defaultdict
d = defaultdict(lambda : [None]+[0]*12)

with open('yourfile') as f:
    for line in f:
        plate,_,_,time,_,_ = line.split(',')  #maybe use csv instead
        month = int(time.split('-')[1])       #get the month
        d[plate][month] += 1 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-26T22:42:34.687

### 第 1 阶段：生成带有车牌和年/月的条目

```
cut -d, -f1,4 basefile.csv |
sed 's/,2012-\([0-9][0-9]\)-[0-9][0-9] ..:..:..$/ \1/' 
```

这假定日期都是 2012 年，并且还将逗号分隔符映射到空格。

示例输出：

```
AAM7676 02
AAM7676 02
AAM7676 02
AAM7676 03
AAM7676 05
AAM7676 08
AAO9229 01
AAP0678 04
AAP0678 05
AAP0678 06
AAU6100 01
AAU6100 01
AAU6100 02
AAU6100 03 
```

### 第 2 阶段：每月生成计数

```
... |
sort | uniq -c 
```

样本输出：

```
3 AAM7676 02
1 AAM7676 03
1 AAM7676 05
1 AAM7676 08
1 AAO9229 01
1 AAP0678 04
1 AAP0678 05
1 AAP0678 06
2 AAU6100 01
1 AAU6100 02
1 AAU6100 03 
```

### 第 3 阶段：枢轴

数据按板块和月份的顺序排列。此时，我将使用`awk`创建控制中断报告：

```
cut -d, -f1,4 basefile.csv |
sed 's/,2012-\([0-9][0-9]\)-[0-9][0-9] ..:..:..$/ \1/' |
sort |
uniq -c |
awk '
    {   if ($2 != last_plate && last_plate != "")
        {
            printf "%s", last_plate
            for (i = 1; i <= 12; i++)
            {
                printf ",%d", count[i]
                count[i] = 0;
            }
            print ""
        }
        last_plate = $2
        count[$3+0] = $1
    }
    END {   if (last_plate != "")
            {
                printf "%s", last_plate
                for (i = 1; i <= 12; i++)
                    printf ",%d", count[i]
                print ""
            }
    }' 
```

那里唯一的“技巧”是下标`count[$3+0]`；这会将字符串转换`01`为下标的纯数字 1。

样本数据的输出为：

```
AAM7676,0,3,1,0,1,0,0,1,0,0,0,0
AAO9229,1,0,0,0,0,0,0,0,0,0,0,0
AAP0678,0,0,0,1,1,1,0,0,0,0,0,0
AAU6100,2,1,1,0,0,0,0,0,0,0,0,0 
```

如果您也想要列标题，那么只需在脚本中添加一个 BEGIN 块和适当`print`的语句即可。`awk`

这一切都可以完成`awk`吗？大概……做我的客人吧。排序是唯一棘手的地方。它也可以全部用 Perl 或 Python 或其他类似的脚本语言完成。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-26T23:15:00.770

尽管在 RBDS 中，monthes 的 12 列并不完全自然，但以下 SQL COUNT 和 GROUP BY 可以解决问题：

```
drop table if exists toto;
create table toto(
    plate VARCHAR(32),
    date1 DATETIME,
    something1 INT(10),
    date2 DATETIME,
    something2 INT(10),
    something3 INT(10)
);

INSERT INTO toto VALUES('AAM7676','2012-02-02 11:55:52',32,'2012-02-03 19:55:30',62,1);
INSERT INTO toto VALUES('AAM7676','2012-02-11 13:56:11',32,'2012-02-12 21:00:18',52,2);
INSERT INTO toto VALUES('AAM7676','2012-02-21 16:30:55',32,'2012-02-23 13:29:41',62,1);
INSERT INTO toto VALUES('AAM7676','2012-03-07 20:03:32',32,'2012-03-09 13:31:35',62,1);
INSERT INTO toto VALUES('AAM7676','2012-05-28 06:08:05',32,'2012-05-29 15:49:55',52,2);
INSERT INTO toto VALUES('AAM7676','2012-08-22 12:47:28',32,'2012-08-24 08:03:09',52,1);
INSERT INTO toto VALUES('AAO9229','2012-01-10 07:19:29',32,'2012-01-11 16:39:16',52,2);
INSERT INTO toto VALUES('AAP0678','2012-04-09 16:35:19',32,'2012-04-10 19:46:55',52,2);
INSERT INTO toto VALUES('AAP0678','2012-04-30 16:44:28',32,'2012-05-01 19:20:00',52,2);
INSERT INTO toto VALUES('AAP0678','2012-06-01 19:31:34',32,'2012-06-03 10:34:33',52,3);
INSERT INTO toto VALUES('AAU6100','2012-01-09 17:49:13',32,'2012-01-11 02:00:33',52,3);
INSERT INTO toto VALUES('AAU6100','2012-01-20 21:18:16',32,'2012-01-22 14:09:00',52,3);
INSERT INTO toto VALUES('AAU6100','2012-02-20 13:35:39',32,'2012-02-21 19:45:55',52,2);
INSERT INTO toto VALUES('AAU6100','2012-03-13 09:50:51',32,'2012-03-14 22:35:51',52,3);

SELECT 
    t.plate,
    (SELECT COUNT(*) FROM toto tt WHERE tt.plate=t.plate AND EXTRACT(MONTH FROM date1)=1),
    (SELECT COUNT(*) FROM toto tt WHERE tt.plate=t.plate AND EXTRACT(MONTH FROM date1)=2),
    (SELECT COUNT(*) FROM toto tt WHERE tt.plate=t.plate AND EXTRACT(MONTH FROM date1)=3),
    (SELECT COUNT(*) FROM toto tt WHERE tt.plate=t.plate AND EXTRACT(MONTH FROM date1)=4),
    (SELECT COUNT(*) FROM toto tt WHERE tt.plate=t.plate AND EXTRACT(MONTH FROM date1)=5),
    (SELECT COUNT(*) FROM toto tt WHERE tt.plate=t.plate AND EXTRACT(MONTH FROM date1)=6),
    (SELECT COUNT(*) FROM toto tt WHERE tt.plate=t.plate AND EXTRACT(MONTH FROM date1)=7),
    (SELECT COUNT(*) FROM toto tt WHERE tt.plate=t.plate AND EXTRACT(MONTH FROM date1)=8),
    (SELECT COUNT(*) FROM toto tt WHERE tt.plate=t.plate AND EXTRACT(MONTH FROM date1)=9),
    (SELECT COUNT(*) FROM toto tt WHERE tt.plate=t.plate AND EXTRACT(MONTH FROM date1)=10),
    (SELECT COUNT(*) FROM toto tt WHERE tt.plate=t.plate AND EXTRACT(MONTH FROM date1)=11),
    (SELECT COUNT(*) FROM toto tt WHERE tt.plate=t.plate AND EXTRACT(MONTH FROM date1)=12),
    COUNT(*)
FROM toto t
GROUP BY plate; 
```

结果 ：

```
AAM7676 0   3   1   0   1   0   0   1   0   0   0   0   6
AAO9229 1   0   0   0   0   0   0   0   0   0   0   0   1
AAP0678 0   0   0   2   0   1   0   0   0   0   0   0   3
AAU6100 2   1   1   0   0   0   0   0   0   0   0   0   4 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-27T06:40:08.350

试试这个查询 -

```
SELECT
  plate,
  COUNT(IF(MONTH(dt2) = 1, 1, NULL)) jan,
  COUNT(IF(MONTH(dt2) = 2, 1, NULL)) feb,
  COUNT(IF(MONTH(dt2) = 3, 1, NULL)) mar,
  COUNT(IF(MONTH(dt2) = 4, 1, NULL)) apr,
  COUNT(IF(MONTH(dt2) = 5, 1, NULL)) may,
  COUNT(*) total
FROM
  basefile_table
WHERE
  YEAR(dt2) = 2012
GROUP BY
  plate;

+---------+-----+-----+-----+-----+-----+-------+
| plate   | jan | feb | mar | apr | may | total |
+---------+-----+-----+-----+-----+-----+-------+
| AAM7676 |   0 |   3 |   1 |   0 |   1 |     6 |
| AAO9229 |   1 |   0 |   0 |   0 |   0 |     1 |
| AAP0678 |   0 |   0 |   0 |   1 |   1 |     3 |
| AAU6100 |   2 |   1 |   1 |   0 |   0 |     4 |
+---------+-----+-----+-----+-----+-----+-------+ 
```

添加其他月份 - 六月，七月，... 注意我已将年份过滤器添加到查询中。

# c# - 如何在事件发生后更新按钮文本

> ID：12611036
> 
> 赞同：0
> 
> 时间：2012-09-26T21:53:14.410
> 
> 标签：c#, refresh

我试图让一个程序发布一堆文本。用户输入文本、消息数量以及必须以多快的速度传递这些消息。当程序很忙时，按钮文本需要是“停止”而不是“开始”。当您在最初启动它后按下按钮强制它停止时，文本会变回“开始”，但是当程序在传递给定数量的消息后停止时不会发生这种情况，即使代码已到位并且不会产生错误。

我有一种感觉，这是因为文本由于某种原因没有更新。我试图用 Invalidate() 和 Update() 刷新它，但这不起作用。如何解决这个问题？

这是代码：

```
private void button1_Click(object sender, EventArgs e)
    {
        if (button1.Text == "Start")
        {
            isEvil = true;
            button1.Text = "Stop";

            Thread t = new Thread(StartTyping);
            t.Start(textBox1.Text);
        }
        else
        {
            isEvil = false;
            button1.Text = "Start";
        }
    }

    private void StartTyping(object obj)
    {
        string message = obj.ToString();
        int amount = (int)numericUpDown2.Value;
        Thread.Sleep(3000);

        for (int i = 0; i < amount; i++)
        {
            if (isEvil == false)
            {
                //////This does NOT work
                //button1.Text = "Start";
                //button1.Invalidate();
                //button1.Update();
                //button1.Refresh();
                //Application.DoEvents();
                break;
            }

            SendKeys.SendWait(message + "{ENTER}");
            int j = (int)numericUpDown1.Value * 10;
            Thread.Sleep(j);
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:31:09.627

您有四个答案告诉您从 UI 线程更新 UI 内容，但它们都没有解决您的代码的*逻辑流*问题。

它没有发生的原因是因为它只发生*在 for 循环*when `isEvil`is `false`。什么时候`isEvil`设置`false`？仅当您单击“停止”时，其他任何地方都没有。

如果您希望按钮在线程完成后返回“开始”，而不单击“停止”，那么您需要*在循环之后*添加代码来执行此操作，与 : 的值无关`isEvil`（搭载 VoidMain 的答案）

```
private void StartTyping(object obj)
{
    string message = obj.ToString();
    int amount = (int)numericUpDown2.Value;
    Thread.Sleep(3000);

    for (int i = 0; i < amount; i++)
    {
        if (isEvil == false)
        {
            if (button1.InvokeRequired)
            {
                button1.BeginInvoke( new Action(() => { button1.Text = "Start"; }) );
            }
            else
            {
                button1.Text = "Start";
            }
            break;
        }

        SendKeys.SendWait(message + "{ENTER}");
        int j = (int)numericUpDown1.Value * 10;
        Thread.Sleep(j);
    }

    if (button1.InvokeRequired)
    {
        button1.BeginInvoke( new Action(() => { button1.Text = "Start"; }) );
    }
    else
    {
        button1.Text = "Start";
    }
} 
```

现在你有重复的代码，所以你可能想把它拆分成一个单独的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:58:59.263

您需要在 UI 线程上更新 UI。

尝试一种叫做**SynchronizationContext**的东西。当你用谷歌搜索时，有很多例子。

如果您在*WPF*或*Silverlight*中，则可以使用**Dispatcher**。同样，如果您在 google 或 StackOverflow 中搜索这些关键字，则会有很多示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T22:00:52.613

您必须从 UI 线程更新您的控件。这就是你为winforms做的方式。

```
 for (int i = 0; i < amount; i++)
    {
        if (isEvil == false)
        {
            button1.Invoke(new Action(() => button1.Text = "Start"));
            break;
        }

        SendKeys.SendWait(message + "{ENTER}");
        int j = (int)numericUpDown1.Value * 10;
        Thread.Sleep(j);
    } 
```

这将阻止直到 button1 更新其文本。如果您不希望它阻止，请替换`Invoke`为`BeginInvoke`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T22:02:56.153

这样的东西（未经测试）*应该可以*工作：

```
private void StartTyping(object obj)
{
    string message = obj.ToString();
    int amount = (int)numericUpDown2.Value;
    Thread.Sleep(3000);

    for (int i = 0; i < amount; i++)
    {
        if (isEvil == false)
        {
            if(button1.InvokeRequired)
            {
                button1.BeginInvoke( new Action(() => { button1.Text = "Start"; }) );
            }
            else
            {
                button1.Text = "Start";
            }
            break;
        }

        SendKeys.SendWait(message + "{ENTER}");
        int j = (int)numericUpDown1.Value * 10;
        Thread.Sleep(j);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-26T22:15:49.167

你最好的选择是使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker%28v=vs.100%29.aspx#Y0)。在这里添加一个简洁的示例有点太笨拙了，但是[O'Reilly 提供了一个不错的教程](http://broadcast.oreilly.com/2010/06/understanding-c-using-backgrou.html)

# python - 在 django-tastypie 中，可以在模式中显示选择吗？

> ID：12611038
> 
> 赞同：3
> 
> 时间：2012-09-26T21:53:32.277
> 
> 标签：python, django, api, tastypie

**我试图弄清楚我是否可以`choices`向使用美味派 API 的客户表示模型字段。**

我有一个 django (1.4.1) 应用程序，我正在为其实现一个 django-tastypie (0.9.11) API。我有一个类似于以下的模型和模型资源：

```
class SomeModel(models.Model):
    QUEUED, IN_PROCESS, COMPLETE = range(3)

    STATUS_CHOICES = (
        (QUEUED, 'Queued'),
        (IN_PROCESS, 'In Process'),
        (COMPLETE, 'Complete'),
    )

    name = models.CharFIeld(max_length=50)
    status = models.IntegerField(choices=STATUS_CHOICES, default=QUEUED)

class SomeModelResource(ModelResource):
    class Meta:
        queryset = SomeModel.objects.all()
        resource_name = 'some_model' 
```

当我查看 API 中的对象时，名称和状态字段显示如下：

```
{
    ...
    "objects":[
    {
        "name": "Some name 1",
        "status": 0
    },
    {
        "name": "Some name 2",
        "status": 2
    }]
} 
```

我知道我可以`SomeModelResource`使用 hydrate/dehydrate 方法进行更改，以显示状态的字符串值，如下所示，这对客户来说更有价值：

```
{
    ...
    "objects":[
    {
        "name": "Some name 1",
        "status": "Queued"
    },
    {
        "name": "Some name 2",
        "status": "Complete"
    }]
} 
```

但是，客户如何在不了解 SomeModel 内部工作原理的情况下知道状态字段的可用选择呢？

*在系统中创建*对象的客户端可能不会提供状态，因为默认值`QUEUED`是可取的。但是正在*编辑*对象的客户端需要知道状态的可用选项以提供有效选项。

我希望将选项列在 SomeModelResource 的架构描述中，以便客户端可以在创建/编辑对象时内省可用的选项。但我只是不确定这是否是可口可乐的开箱即用的东西，或者我是否应该分叉可口派来引入该功能。

感谢您的任何反馈！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T07:19:21.403

您可以通过覆盖资源中的方法将选项添加到架构中。如果您想将选项添加到任何字段（可能与许多资源一起使用），您可以按如下方式创建方法：

```
def build_schema(self):
    base_schema = super(SomeModelResource, self).build_schema()
    for f in self._meta.object_class._meta.fields:
        if f.name in base_schema['fields'] and f.choices:
            base_schema['fields'][f.name].update({
                'choices': f.choices,
            })
    return base_schema 
```

我没有测试过上面的代码，但我希望你能明白。请注意，`object_class`只有当您使用来自提供的`queryset`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-29T21:23:31.650

一个更简单的解决方案是将选择信息破解到您的 help_text 简介中。

在我们的示例中，我们能够做到：

```
source = models.CharField(
    help_text="the source of the document, one of: %s" % ', '.join(['%s (%s)' % (t[0], t[1]) for t in DOCUMENT_SOURCES]),
    choices=DOCUMENT_SOURCES,
) 
```

简单易用，自动保持最新状态，并且几乎没有副作用。

# xml - 正在发送的 Web 服务 XML 中的额外 xmlns="" / 子元素 X 不属于命名空间

> ID：12611040
> 
> 赞同：0
> 
> 时间：2012-09-26T21:53:49.577
> 
> 标签：xml, web-services

我正在 VS2010 VB.Net 控制台应用程序中调用客户的 Web 服务。我做了通常的右键单击项目/添加服务参考/高级按钮/添加网络参考，导航到 URL，并添加参考。

该应用程序正在调用我们客户的网络服务来传递数据，以便他们可以使用它来更新他们的数据库。我们正在使用他们的 WSDL，它没有改变。

他们的一方拒绝了一些交易，哦。

他们最后的消息是“子元素 X 不属于命名空间”，这让我认为 X 不是 wsdl 的一部分，但我可以打开 IE 并导航到它并查看它。

我们的客户认为这是因为在几个节点中出现了额外的 xmlns=""。对于其他节点，它不会出现。我们不希望它存在并具有价值，因为我在网上看到了各种答案；我们希望它根本不存在。

这是请求的格式：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<soap:Body>
<SYNC_V1_REQUEST xmlns="https://OurCustsWebserviceURL.com/types">
<ORDER xmlns="">
<ROW_ID>1234</ROW_ID> 
```

...然后是 ORDER 的其余节点，然后是订单的关闭节点，等等。

对于其他类型的数据，例如 CUSTOMER 行，没有额外的 xmlns=""。

有谁知道我如何摆脱它？

提前感谢女士们先生们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-16T16:40:28.710

与 post 相同[xmlns="" 是一个有效的 xml 命名空间吗？](https://stackoverflow.com/questions/1587891/is-xmlns-is-a-valid-xml-namespace)

[http://www.w3.org/TR/xml-names/#defaulting](http://www.w3.org/TR/xml-names/#defaulting) 默认命名空间声明中的属性值可以为空。在声明的范围内，这与没有默认命名空间的效果相同。

# android - 如何使android构建系统在应用程序中嵌入annotations.jar？

> ID：12611043
> 
> 赞同：1
> 
> 时间：2012-09-26T21:54:00.060
> 
> 标签：android, annotations, android-source

我正在Android 开源项目 4.0.4 上构建[超级用户。](https://github.com/ChainsDD/Superuser)一世：

1.  获取 git repo `packages/apps`，
2.  发行`mm`于`packages/apps/Superuser`

并面临以下问题： http: [//pastebin.com/50vGLhH1](http://pastebin.com/50vGLhH1)

我读到我必须嵌入`annotations.jar`android 应用程序的依赖项。使用 eclipse 可以做到这一点，但无法使用 aosp 源代码找到我的答案。有谁知道？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:02:52.730

不确定这是否可行，请尝试在 Android.mk 中添加以下行

```
LOCAL_STATIC_JAVA_LIBRARIES += annotations 
```

# php - 查找子数组条目的多个元素

> ID：12611054
> 
> 赞同：0
> 
> 时间：2012-09-26T21:54:48.260
> 
> 标签：php, arrays, cakephp

所以，我想在我正在做的事情上添加一个“喜欢”系统，但我遇到了一些麻烦。

所以我喜欢的数据库表是这样的：

```
========================================
|| *id* | created | user_id | post_id ||
======================================== 
```

我同意计算一个帖子的点赞数。我遇到的问题是我想知道登录用户是否已经喜欢该帖子正在查看，因此“喜欢”链接将变为“不喜欢”链接。这就是我的问题。我无法想象该怎么做。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:58:33.363

看`Model::hasAny()`方法：

```
$userHasLikedThisPost = $this->Like->hasAny(array(
    'user_id' => $this->Auth->user('id'), 
    'post_id' => $postId
)); 
```

然后只需设置一个视图变量并输出相应的链接。

在模型中创建一个辅助方法，使其更可重用：

```
public function hasLike($postId, $userId) {
    return $this->hasAny(array(
        'user_id' => $userId, 
        'post_id' => $postId,
    ));
} 
```

# php - 调整字体大小 FPDF

> ID：12611060
> 
> 赞同：6
> 
> 时间：2012-09-26T21:55:12.913
> 
> 标签：php, pdf, fpdf

在 FPDF 中，我有一个宽度为 176 毫米的单元格，我需要在其中输入客户名称。问题是客户端名称并不总是调整到该固定宽度。有没有办法让单元格的字体大小自动调整到单元格宽度，以防它太长？

这是我现在拥有的代码：

```
$pdf->Cell( 116, 7, utf8_decode( $row_or[ 'client_name' ] ), 0, 0, 'L' ); 
```

我知道 TCPDF 有一种设置自动拉伸的方法，但我还没有为 FPDF 找到任何方法。我必须用代码来做吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-26T22:44:19.617

好吧，事实证明有一个名为 GetStringWidth 的函数，它接收一个字符串并以毫米为单位返回它的宽度，所以，我所做的是：

```
/* I know that the font size starts with 11, so i set a variable at this size */
$x = 11;    // Will hold the font size
/* I will cycle decreasing the font size until it's width is lower than the max width */
while( $pdf->GetStringWidth( utf8_decode( $row_or[ 'client_name' ] ) ) > 116 ){
    $x--;   // Decrease the variable which holds the font size
    $pdf->SetFont( 'Trebuchet', 'B', $x );  // Set the new font size
}
/* Output the string at the required font size */
$pdf->Cell( 116, 7, utf8_decode( $row_or[ 'client_name' ] ) ), 0, 0, 'L' );
/* Return the font size to itś original */
$pdf->SetFont( 'Trebuchet', 'B', 11 ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-27T15:59:33.310

对于更精细的列调整，减少也可以是分数的分数，例如： $x-=0.1; 而不是 $x--;

# objective-c - 未在 setStringValue 上调用 ControlTextDidChange

> ID：12611062
> 
> 赞同：3
> 
> 时间：2012-09-26T21:55:19.013
> 
> 标签：objective-c, xcode, cocoa

我已经实现了一个委托及其`controlTextDidChange`方法，每当我在`NSTextField`.

当我通过不调用`[field setStringValue:@"newText"]`以编程方式设置文本时。`controlTextDidChange`

你能解释一下吗？以及我应该如何以编程方式设置一个触发我的委托方法调用的新值`controlTextDidChange`。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-26T22:16:09.657

`controlTextDidChange`委托仅在用户交互时触发，手动
更新`NSControl`不会触发委托。

**适当的解决方案**

解决方案是创建一个单独的方法来处理文本更改：

```
- (void)myCustomFunction {
     // Triggered in case the text is changed,
     // no matter by user or programmatically
} 
```

从委托中触发此方法：

```
- (void)controlTextDidChange:(NSNotification *)aNotification {
    [self myCustomFunction];
} 
```

如果文本以编程方式更改：

```
[theField setStringValue:@"text"];
[self myCustomFunction]; 
```

现在您可以在同一方法中处理这两种情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-08-05T16:10:41.543

`controlTextDidChange`您可以以编程方式触发该功能

```
[[NSNotificationCenter defaultCenter] postNotificationName: NSControlTextDidChangeNotification
                                                    object:textFieldExample
                                                  userInfo:[NSDictionary dictionaryWithObject: [[textFieldExample window] fieldEditor:YES
                                                                                                                           forObject:textFieldExample]
                                                                                       forKey:@"NSFieldEditor"]]; 
```

这更有用，当`controlTextDidChange`由多个文本字段触发时！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-17T02:27:46.690

Oliver P 的答案移植到 Swift 4.0：

```
NotificationCenter.default.post(
    name: NSControl.textDidChangeNotification,
    object: textFieldExample,
    userInfo: ["NSFieldEditor":
        textFieldExample!.fieldEditor(true, for: textFieldExample)!]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-14T13:21:42.210

在我的情况下，调用它就足够了，没有任何`userInfo`（Swift 5）：

```
NotificationCenter.default.post(name: NSControl.textDidChangeNotification, object: myTextField) 
```

# objective-c - 发布 ipa：如何在堆栈跟踪中表示我的类的调用？显示框架调用

> ID：12611068
> 
> 赞同：1
> 
> 时间：2012-09-26T21:55:38.343
> 
> 标签：objective-c, ios, stack-trace, xcode4.5, symbolicate

我的应用程序是用目标 c 和 c++ 编写的。我正在使用 xcode 4.5，当然我有开发者帐户，我的设备没有越狱，我已经在我的开发者帐户中设置了所有内容。我不使用 xcode 中的“设备日志”，而是实现了信号/异常处理程序来将堆栈跟踪写入文件，并且 - 当下次应用程序启动时 - 将其发送到我的网络服务器。

为了获得崩溃时的堆栈跟踪，我使用 [NSException callStackSymbols]。有用。因此，当我进行示例崩溃时，例如：

```
NSArray *arr=[NSArray array];
[arr objectAtIndex:100]; 
```

在 xcode 中调试并从设备上的 xcode 应用程序安装启动时，我得到：

```
0 CoreFoundation 0x36c738a7 __exceptionPreprocess + 186
  1 libobjc.A.dylib 0x3308a259 objc_exception_throw + 32
  2 CoreFoundation 0x36bcb23d -[__NSArrayI objectAtIndex:] + 164
  3 MyApp 0x001be505 _ZN8Menu6handleEN12GestureE + 912
  4 MyApp 0x000e6ce1 _ZN13BaseLevel10handleBaseEN12GestureE + 440
  5 MyApp 0x0011b747 _ZN12Manager6handleEN12GestureE + 742
  6 MyApp 0x00102731 _ZN13Processor9doProcessEd + 552
  7 GLKit 0x3723a0c5 -[GLKViewController _updateAndDraw] + 272
  8 CoreFoundation 0x36bd27d3 -[NSObject performSelector:] + 38
  9 QuartzCore 0x3233486f _ZN2CA7Display11DisplayLink8dispatchEyy + 166
  10 QuartzCore 0x323347c5 _ZN2CA7Display16IOMFBDisplayLink8callbackEP21__IOMobileFramebufferyyyPv + 60 
```

MyApp c++​​ 和 objc 类和方法都可以符号化。

但是当我制作 AdHoc ipa 并在其中做同样的事情时，我得到：

```
0 CoreFoundation 0x36c738a7 __exceptionPreprocess + 186
  1 libobjc.A.dylib 0x3308a259 objc_exception_throw + 32
  2 CoreFoundation 0x36bcb23d -[__NSArrayI objectAtIndex:] + 164
  3 MyApp 0x001be505 _mh_execute_header + 894213
  4 MyApp 0x000e6ce1 _mh_execute_header + 11489
  5 MyApp 0x0011b747 _mh_execute_header + 227143
  6 MyApp 0x00102731 _mh_execute_header + 124721
  7 GLKit 0x3723a0c5 -[GLKViewController _updateAndDraw] + 272
  8 CoreFoundation 0x36bd27d3 -[NSObject performSelector:] + 38
  9 QuartzCore 0x3233486f _ZN2CA7Display11DisplayLink8dispatchEyy + 166
  10 QuartzCore 0x323347c5 _ZN2CA7Display16IOMFBDisplayLink8callbackEP21__IOMobileFramebufferyyyPv + 60] 
```

即我的类和方法的名称消失了，由符号_mh_execute_header+<offset> 代替。

我以为我错过了 dSYM 设置，但它在发布和调试时都打开了，“剥离调试符号”也关闭了。

已经搜索过SO，但没有运气。请告诉我怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T01:08:28.440

我的错，我不熟悉象征性技术。简而言之-要符号化堆栈跟踪，您需要包的 dSYM 和 xcode 来使用其私有 api 符号化崩溃日志。也许下次我会写更多：仍在学习如何以最方便（对我而言）的方式来做。

编辑：一周过去了，我已经制定了解决方案。它特定于我的多平台生态系统，但在这里简而言之它是​​如何工作的。应用程序崩溃并将包含所有需要数据的崩溃日志发送到我的服务器。当我想查看崩溃日志时，我会在我的桌面上启动实用程序，该实用程序会从服务器下载所有尚未处理的堆栈（来自 release/arm 二进制文件）。接下来，它在 Xcode Archives 文件夹中找到相应的包（为需要的 arch 获取 uuids/vmaddr），然后计算堆栈行的真实地址（使用二进制 vmaddr 和接收到的日志中的 _mh_execute_header 地址）并为每个地址调用 atos。然后它解析 atos 的输出，生成 diff 并将其发送回服务器。这样我就可以在基于 php 的 bugtracker 中看到符号化堆栈。这并不像在 java 中获得去混淆的堆栈那么容易，但它仍然是可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T12:17:59.653

您可以使用我编写的这个符号化工具来快速符号化您的应用程序的地址。

```
symbolication your.app.dSYM your.app.trace 
```

符号化版本将打印到 STDOUT。为获得最佳效果，请将 .app 与 .dSYM 保存在同一文件夹中。

[https://github.com/Imperiopolis/Symbolication](https://github.com/Imperiopolis/Symbolication)

# scala - A 类有一个类型参数，但 B 类有一个

> ID：12611072
> 
> 赞同：17
> 
> 时间：2012-09-26T21:55:45.080
> 
> 标签：scala

最近我偶然发现了一个奇怪的（对我来说）编译器错误消息。考虑以下代码：

```
trait Foo {
  type Res <: Foo
  type Bar[X <: Res]
}

class MyFoo extends Foo {
  override type Res = MyFoo
  override type Bar[X <: Res] = List[X]
}

type FOO[F <: Foo, R <: Foo, B[_ <: R]] = F { type Res = R; 
                                              type Bar[X <: R] = B[X] }

def process[F <: Foo, R <: Foo, B[_ <: R]](f: FOO[F, R, B]) {} 
```

现在，如果我想调用该`process`方法，我必须显式地编写类型参数：

```
process[MyFoo, MyFoo, List](new MyFoo) // fine 
```

如果我写：

```
process(new MyFoo) 
```

或者

```
process((new MyFoo): FOO[MyFoo, MyFoo, List]) 
```

我收到以下错误消息：

> 类型参数的推断类型 (MyFoo,MyFoo,List[X]) 不符合类型参数的预期类型 (类型 F,类型 R,类型 B)。List[X] 的类型参数与类型 B 的预期参数不匹配：类 List 有一个类型参数，但类型 B 有一个

为什么编译器不能推断类型（尽管我在调用参数中明确说明了它们）？那是什么`class List has one type parameter, but type B has one`意思？某物有一个，但另一个**也**有一个，这就是为什么它们不适合在一起？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T13:01:42.810

如果我们查看 Scala 编译器，源代码可以帮助我们理解问题所在。我从未为 Scala 编译器做出过贡献，但我发现源代码非常易读，并且我已经对此进行了调查。

负责类型推断的类`scala.tools.nsctypechecker.Infer`可以通过在 Scala 编译器源代码中查找部分错误来找到。您会发现以下片段：

```
 /** error if arguments not within bounds. */
    def checkBounds(pos: Position, pre: Type, owner: Symbol,
                    tparams: List[Symbol], targs: List[Type], prefix: String) = {
      //@M validate variances & bounds of targs wrt variances & bounds of tparams
      //@M TODO: better place to check this?
      //@M TODO: errors for getters & setters are reported separately
      val kindErrors = checkKindBounds(tparams, targs, pre, owner)

      if(!kindErrors.isEmpty) {
        error(pos,
          prefix + "kinds of the type arguments " + targs.mkString("(", ",", ")") +
          " do not conform to the expected kinds of the type parameters "+ tparams.mkString("(", ",", ")") + tparams.head.locationString+ "." +
          kindErrors.toList.mkString("\n", ", ", ""))
      } 
```

所以现在的重点是理解为什么`checkKindBounds(tparams, targs, pre, owner)`返回这些错误。如果你沿着方法调用链往下走，你会看到 checkKindBounds 调用了另一个方法

```
val errors = checkKindBounds0(tparams, targs, pre, owner, true) 
```

您会看到问题与检查更高类型的边界有关，在第 5784 行，在 checkKindBoundsHK 内：

```
 if (!sameLength(hkargs, hkparams)) {
        if (arg == AnyClass || arg == NothingClass) (Nil, Nil, Nil) // Any and Nothing are kind-overloaded
        else {error = true; (List((arg, param)), Nil, Nil) } // shortcut: always set error, whether explainTypesOrNot
      } 
```

测试没有通过，看来在我的调试器中：

```
hkargs$1 = {scala.collection.immutable.Nil$@2541}"List()"
arg$1 = {scala.tools.nsc.symtab.Symbols$ClassSymbol@2689}"class List"
param$1 = {scala.tools.nsc.symtab.Symbols$TypeSymbol@2557}"type B"
paramowner$1 = {scala.tools.nsc.symtab.Symbols$MethodSymbol@2692}"method process"
underHKParams$1 = {scala.collection.immutable.$colon$colon@2688}"List(type R)"
withHKArgs$1 = {scala.collection.immutable.Nil$@2541}"List()"
exceptionResult12 = null
hkparams$1 = {scala.collection.immutable.$colon$colon@2688}"List(type R)" 
```

所以看起来有一个更高种类的参数，类型 R，但没有提供值。

如果您实际上返回到 checkKindBounds，您会在代码段之后看到：

```
 val (arityMismatches, varianceMismatches, stricterBounds) = (
        // NOTE: *not* targ.typeSymbol, which normalizes
        checkKindBoundsHK(tparamsHO, targ.typeSymbolDirect, tparam, tparam.owner, tparam.typeParams, tparamsHO)
      ) 
```

包含`arityMismatches`一个元组List，B。现在您还可以看到错误消息是错误的：

> 类型参数的推断类型 (MyFoo,MyFoo,List[X]) 不符合类型参数的预期类型 (类型 F,类型 R,类型 B)。List[X] 的类型参数与类型 B 的预期参数不匹配：类 List 有一个类型参数，但类型 B**有零**

实际上，如果您在以下调用的第 5859 行设置断点

```
checkKindBoundsHK(tparamsHO, targ.typeSymbolDirect, tparam, tparam.owner, tparam.typeParams, tparamsHO) 
```

你可以看到

```
tparam = {scala.tools.nsc.symtab.Symbols$TypeSymbol@2472}"type B"
targ = {scala.tools.nsc.symtab.Types$UniqueTypeRef@2473}"List[X]" 
```

结论：

> 出于某种原因，在处理复杂的高级类型（例如您的类型）时，Scala 编译器推断是有限的。我不知道它是从哪里来的，也许你想向编译团队发送一个错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T08:37:17.957

我对 Scala 中类型推断器的确切工作原理只有一个模糊的理解，所以认为这个想法不是明确的答案。

1.  类型推断在一次推断不止一种类型方面存在问题。

2.  您在 FOO 的定义中使用了存在类型，它转换为：存在这样的类型，不确定这是否与 MyFoo 中给出的特定类型兼容

# javascript - appendChild 到 SVG defs 以在 Marker for Geochart API 中创建图像背景

> ID：12611078
> 
> 赞同：0
> 
> 时间：2012-09-26T21:56:12.100
> 
> 标签：javascript, svg, google-visualization, appendchild

我正在尝试稍微调整一下 google chart api，以便可以使用图像更改默认圆形标记。我正在考虑通过设置要使用的 svg 圆圈的图像模式来做到这一点。我应该很接近，但由于某种原因它似乎不起作用。

完整代码在这里：http: [//jsfiddle.net/PVkbM/1/](http://jsfiddle.net/PVkbM/1/)

这是代码的一部分。

```
google.visualization.events.addListener(chart, 'ready', function () {

    var patt = document.createElement('pattern');
    patt.setAttribute('id', 'img1');
    patt.setAttribute('patternUnits', 'userSpaceOnUse');
    patt.setAttribute('width', '20');
    patt.setAttribute('height', '20');
    patt.setAttribute('x', '0');
    patt.setAttribute('y', '0');

    var image = document.createElement('image');
    image.setAttribute('xlink:href', 'https://www.google.com/images/srpr/logo3w.png');
    image.setAttribute('x', '0');
    image.setAttribute('y', '0');
    image.setAttribute('width', '24');
    image.setAttribute('height', '24');

    var defs = document.getElementsByTagName('defs')[0];

    patt.appendChild(image);
    defs.appendChild(patt);

    //This works
     //document.getElementsByTagName('circle')[0].setAttribute("fill", "#FFF");     

  document.getElementsByTagName('circle')[0].setAttribute("fill", "url(#img1)");

 });    

 chart.draw(data, options); 
```

据我所知，代码在 <defs> 中添加了新的 <pattern>，但它不起作用。我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T06:47:34.880

`image.setAttribute('xlink:href', 'https://www.google.com/images/srpr/logo3w.png');`

需要是

`image.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', 'https://www.google.com/images/srpr/logo3w.png');`

您还需要在 SVG 命名空间中创建元素，例如

`var image = document.createElement('image');`

应该

`var image = document.createElementNS('http://www.w3.org/2000/svg', 'image');`

还有图案。

[http://jsfiddle.net/PVkbM/34/](http://jsfiddle.net/PVkbM/34/)

# c# - 方法“OnTimerEvent”没有重载需要“1”个参数

> ID：12611086
> 
> 赞同：1
> 
> 时间：2012-09-26T21:56:42.700
> 
> 标签：c#

我想在我的表单中的特定时间的标签中显示文本，这是我到目前为止尝试的代码：

```
private void ShowTextForParticularTime(String caption)
        {
            Timer t = new Timer { Interval = 2000, Enabled = true };
            t.Tick += new EventHandler(OnTimerEvent(caption));
        }

        private void OnTimerEvent(object sender, EventArgs e,String caption)
        {
            barStaticItem3.Caption = caption;
        } 
```

我的问题是如何将“标题”参数设置为 OnTimerEvent 方法，因为我编写的代码不起作用它给了我这个错误：

> 方法“OnTimerEvent”没有重载需要“1”个参数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:58:15.890

改用这个：

```
t.Tick += (sender, args) => OnTimerEvent(sender, args, caption); 
```

原因是您需要为事件*分配*一些事件处理程序。但是，当您声明`new EventHandler(OnTimerEvent(caption));`您实际上是在尝试调用它时。编译时的调用当然会失败，因为该方法需要 3 个参数（sender、e、caption）。

相反，如果您通过 lamdas 创建匿名委托，则可以利用它们的语法和闭包来连接事件，同时传入第三个`caption`参数。

# css - Chrome 对 CSS 边框的处理方式是否与 Firefox 不同？

> ID：12611088
> 
> 赞同：2
> 
> 时间：2012-09-26T21:56:44.990
> 
> 标签：css, firefox, google-chrome

我在 div 上运行了下面的 css，当我打印屏幕并物理测量他的宽度时，firefox 中的宽度为 181px 加上左侧 1 px 边框和右侧 1px 边框。但是当我在 Chrome 中查看它时，宽度为 179px，边框在左侧为 1px，右侧为 1px。好像他们已经吃进了盒子的宽度。任何人都可以对此有所了解吗？

```
.tab{
    background:#fff;
    border-left:1px #000 solid;
    border-right:1px #000 solid;
    height:111px;
    width:181px;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T22:01:01.087

不同的浏览器对边框的处理方式不同，请尝试将其添加到您的 .tab 类中：

```
.tab {
    ...
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
} 
```

请参阅[http://paulirish.com/2012/box-sizing-border-box-ftw/](http://paulirish.com/2012/box-sizing-border-box-ftw/) 和/或[http://css-tricks.com/box-sizing/](http://css-tricks.com/box-sizing/)

或者，您可以执行以下操作来解决所有元素的此“问题”：

```
* {
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
  } 
```

# iframe - 我可以将 rel nofollow 添加到 iframe 标签吗？

> ID：12611091
> 
> 赞同：5
> 
> 时间：2012-09-26T21:57:24.880
> 
> 标签：iframe, seo

我有一个小部件通过 iframe 分布在某些站点中。但我不希望 google bot 索引 url。添加`nofollow`到`iframe`标签会解决问题吗？`Iframe`标签是否支持`nofollow`，谷歌会理解吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-11-22T08:16:26.917

当然，您可以添加`rel="nofollow"`到 iframe。你一定很棘手。就是这样...

构建一个空白的 html 文件。仅将您的 iframe 添加到其中。在 Meta 标签中包括

```
<meta name="robots" content="noindex,nofollow"> 
```

现在，将该页面 iframe 放到您要显示的页面上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T13:45:24.183

元素`rel`不允许使用该属性。`iframe`

查看允许的属性`iframe`：[HTML5](http://www.w3.org/TR/html5/the-iframe-element.html#the-iframe-element)、[HTML 4.01](http://www.w3.org/TR/html401/present/frames.html#h-16.5)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-06T10:05:16.370

[根据谷歌](https://developers.google.com/webmasters/control-crawl-index/docs/robots_meta_tag)，你所需要的只是

```
<meta name="robots" content="none" /> 
```

“none - 相当于 noindex, nofollow”</p>

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-05-11T20:04:09.743

这是不可能的，但有一个解决方法。您可以使用重定向到 IFRAME 的域的 URL。在您的 robots.txt 中，您将阻止机器人跟踪您的 URL 链接。

在你的 robots.txt 添加

```
User-agent:*
Disallow:/h/ 
```

然后，在您的 htaccess 或类似的东西中创建一个 301 重定向，如果您使用其他类似 nginx 的东西。这会将本地 URL 重定向到 iframe 的 URL。

```
Redirect 301 /h/fancy-url/ http://targetdomain.com/the-uri-of-iframe/ 
```

在您的 iframe 中使用

```
<iframe src="https://yourdomain.com/h/fancy-url/?possibleparam=xx"> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-24T06:23:46.083

根据 W3C 规范，“rel”不是“iframe”标签的公认属性。您可以使用一些 javascript 和 document.write 将 iframe 代码放在页面上

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-24T14:00:23.337

您可能想查看[Google 是否抓取了 IFrame？](https://stackoverflow.com/questions/9101007/is-iframe-crawled-by-google)但据我了解，iframe 上不允许使用“nofollow”

# ruby-on-rails - 如何在heroku上使用sqlite gem（不是DB）？

> ID：12611099
> 
> 赞同：1
> 
> 时间：2012-09-26T21:58:24.197
> 
> 标签：ruby-on-rails, heroku, sqlite

我需要在 heroku 上解析 sqlite 文件，据我所知 Heroku 不支持 sqlite。

在本地，我正在使用 gem sqlite3，但在推动 heroku 时它被拒绝。我如何在生产中使用“需要 sqlite3”？

这是错误：

```
 An error occurred while installing sqlite3 (1.3.6), and Bundler cannot continue.
   Make sure that `gem install sqlite3 -v '1.3.6'` succeeds before bundling.
   Failed to install gems via Bundler.
   Heroku push rejected, failed to compile Ruby/rails app 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:02:29.603

很确定你只是不想这样做：[https ://devcenter.heroku.com/articles/how-do-i-use-sqlite3-for-development](https://devcenter.heroku.com/articles/how-do-i-use-sqlite3-for-development)

Heroku 不支持 sqlite，你必须使用 PostgreSQL。对不起伙计。

这个较旧的 SO 线程有一个解决方法：

[使用 Sqlite3 将 RoR 应用程序部署到 Heroku 失败](https://stackoverflow.com/questions/3897431/deploying-ror-app-to-heroku-with-sqlite3-fails)

那里的获胜答案只是使用 sqlite for dev 所以：（复制粘贴）

```
group :production, :staging do
  gem "pg"
end

group :development, :test do
  gem "sqlite3-ruby", "~> 1.3.0", :require => "sqlite3"
end 
```

# javascript - 隐藏输入的值始终为 0

> ID：12611112
> 
> 赞同：0
> 
> 时间：2012-09-26T21:59:37.547
> 
> 标签：javascript, jquery

我无法在隐藏的输入中获取正确的值。

下面我有一个表单，每次用户单击按钮时都会将其附加到表格中：

```
 var $fileImage = $("<form action='imageupload.php' method='post' enctype='multipart/form-data' target='upload_target_image' onsubmit='return imageClickHandler(this);' class='imageuploadform' >" + 
        "<p class='imagef1_upload_form' align='center'><br/><span class='msg'></span><label>" + 
        "Image File: <input name='fileImage' type='file' class='fileImage' /></label><br/><br/><label class='imagelbl'>" + 
        "<input type='submit' name='submitImageBtn' class='sbtnimage' value='Upload' /></label>" + 
        "<input type='hidden' class='numimage' name='numimage' value='" + GetFormImageCount + "' /></p>" +
        "<iframe class='upload_target_image' name='upload_target_image' src='#' style='width:0px;height:0px;border:0px;solid;#fff;'></iframe></form>");

$image.append($fileImage); 
```

现在这是我收到的问题，它处理表单中的隐藏输入：

```
<input type='hidden' class='numimage' name='numimage' value='" + GetFormImageCount + "' /> 
```

假设我将两种形式附加到表中，第 1 行中的一种形式（隐藏输入中的值应为 1）和第 2 行中的一种形式（隐藏输入中的值应为 2）。

问题是这两种形式都没有价值。两种形式的值仍然是 0。我需要在下面的代码中包含什么才能包含正确形式的正确值？

下面是代码：

```
...//form code from top goes here

//CODE BELOW INCREMENTS A QUESTION NUMBER AND INCREMENTS THE HIDDEN VALUE FOR EACH ROW ADDED
          $('.num_questions').each( function() {

    var $this = $(this);

     var $questionNumber = $("<input type='hidden' class='num_questionsRow'>").attr('name',$this.attr('name')+"[]")
                   .attr('value',$this.val());

     $qid.append($questionNumber);                             

});

//BELOW IS THE FUNCTION WHICH SHOULD INSERT THE VALUE FOR THE HIDDEN INPUT FOR EACH FORM

function GetFormImageCount(){ 
  var frm = $('.imageuploadform'); 

    if(frm[0] != undefined) 
    { 
       if(length in frm ) 
       { 
          return  frm.length; 
       } 
        return 1; 
    } 
    return 0; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:02:32.240

用于`.val()`获取值，`.attr("value")`从 jQuery 1.6 开始获取默认值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:06:31.087

您错过了调用函数所需的括号。试着写

```
<input type='hidden' class='numimage' name='numimage' value='" + GetFormImageCount() + "' /> 
```

# zend-framework - Zend 框架：找不到页面

> ID：12611115
> 
> 赞同：0
> 
> 时间：2012-09-26T21:59:42.707
> 
> 标签：zend-framework

我已经使用 Zend Framework 开发了一个 Web 应用程序，它的根目录是[http://www.demo31.com/validacion/demo31/](http://www.demo31.com/validacion/demo31/)但是当我调用那个 url 时，我得到了下一个错误：

```
Page not found

Request Parameters:

array (
  'controller' => 'validacion',
  'action' => 'demo31',
  'module' => 'default',
) 
```

我希望数组的值是下一个：

```
array (
  'controller' => 'index',
  'action' => 'index',
  'module' => 'default',
) 
```

我的 .htaccess 是正确的。

那么，我必须做我想做的事吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:10:56.170

Zend 框架通常按照路由运行。如果一个特定的 URL 没有到达你的代码，那么你必须配置路由来做到这一点。

```
 $router = $front -> getRouter();
    $routePage = new Zend_Controller_Router_Route('/:controller/:action', array(
    /*                                             ^ Things to notice
                                                     Only two parameters are 
                                                     asked from the route */
        'controller' => 'default',
        'action'    => 'index',
        'module'    => 'default' //Predefine the module as `default
    ));
    $router -> addRoute('default', $routePage); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:04:50.447

默认情况下，ZF 假定应用程序位于域的根目录中，这就是它将验证视为控制器的原因。

[Zend 框架在子文件夹中](https://stackoverflow.com/questions/1550840/zend-framework-in-a-subfolder)

# iphone - UIImagePickerController 不显示

> ID：12611116
> 
> 赞同：0
> 
> 时间：2012-09-26T21:59:44.193
> 
> 标签：iphone, ios, camera, uiimagepickercontroller

我正在尝试通过单击按钮显示 UIImagePickerController 。当我单击按钮时，我在该行得到一个 SIGABRT：

```
[self presentModalViewController:camera animated:YES]; 
```

从代码块：

```
camera = [[UIImagePickerController alloc]init];
[camera setSourceType:UIImagePickerControllerSourceTypeCamera];
[camera setDelegate:self.view];
camera.showsCameraControls = NO;
camera.navigationBarHidden = YES;
camera.wantsFullScreenLayout = YES;
camera.toolbarHidden = YES;
camera.cameraOverlayView = bottomArrow;
[self presentModalViewController:camera animated:YES]; 
```

定义`camera`的名称在哪里：`UIImagePickerController`

```
UIImagePickerController *camera; 
```

在`@interface`. 我的接口声明是：

```
@interface cameraViewController : UIViewController  <UINavigationControllerDelegate, UIImagePickerControllerDelegate> { 
```

有人可以看到我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:11:36.530

除了@Vikings 提出的好处之外，请务必在尝试使用之前检查您的设备是否有摄像头：

```
if ([UIImagePickerController
     isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera]) {
    [camera setSourceType:UIImagePickerControllerSourceTypeCamera];
} else {
    [camera setSourceType:UIImagePickerControllerSourceTypePhotoLibrary];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T23:01:31.287

确保您同时使用 Navigation Controller Delegate 和 Image Picker Controller Delegate。Image Picker 实际上是一个导航控制器，这就是为什么你必须实现它的委托。

```
 @interface YourViewController : UITableViewController <UINavigationControllerDelegate, UIImagePickerControllerDelegate> 
```

此外，正确设置委托，而不是视图，而是视图控制器。

```
camera.delegate = self; 
```

委托需要设置为 View Controller，而不是 View Controller 的 View。

查看下面的代码：

(1) 导航栏不需要隐藏，因为没有

(2) 不需要隐藏工具栏，因为没有

(3) 不需要指定 WantsFullScreenLayout，因为 Modal View Controller 会一直占据全屏

```
UIImagePickerController *picker = [[UIImagePickerController alloc] init];
picker.delegate = self;
picker.allowsEditing = YES;
picker.showsCameraControls = NO;
// Comment out the line below to make sure it is not causing a problem.
// This just expects a view, so if bottomArrow is a view you should be fine
picker.cameraOverlayView = bottomArrow;
[self presentModalViewController:picker animated:YES]; 
```

另外，我没有意识到你在 viewDidLoad 中加载了这段代码，这会崩溃，因为 View Controller 本身还没有完成它的转换，所以你不能开始另一个转换。而是使用 viewDidAppear 获得相同的效果：

```
- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:YES];
    // Place code here
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T04:48:20.527

不要将您的代码放入 viewDidLoad 创建一个 IBAction 并将您的代码放入该函数中。

并将委托设置为您的视图控制器。并在 .h 文件中确保你写的

```
<UIImagePickerControllerDelegate>

[camera setDelegate : self]; 
```

# algorithm - 用于跟踪写入 2 次方 32 元素的空间高效算法

> ID：12611117
> 
> 赞同：0
> 
> 时间：2012-09-26T21:59:48.263
> 
> 标签：algorithm, flash, storage, firmware, scsi

这是我在工作中遇到的要求之一。我们有一个 (2 power 32) 连续的 4294967296 个整数在内存中分配为一个数组，其功能是在另一个表中提供映射。有些条目比其他条目写得更频繁。我们想要跟踪热点并提供近似直方图。问题是，这将在固件中实现，并且可以使用的内存不多。

信息：该映射用于从主机到目标上的 lbas 的 scsi lba，可能是驱动器或闪存。

假设我们有 1 MB 的空间来处理跟踪冷热信息所需的元数据。除了显示它是否被写入的位映射之外，我们如何有效地使用它。我们可以根据用于跟踪的内存大小来扩展我们收集的数据的准确性，并对其进行数学扩展。

# jquery - 为什么这个 jQuery .post 无法返回结果，如何在 Firebug 中调试？

> ID：12611119
> 
> 赞同：0
> 
> 时间：2012-09-26T22:00:03.943
> 
> 标签：jquery

这个脚本过去可以正常工作，所以我很困惑为什么它现在不能正常工作；但它在一个简单的 php 调用中使用 .post 来检索给定两个键 mndx 和 sndx 的数据记录，这两个键都包含有效数据。

```
 function fetchgenotype() {
    // here's where we use an Ajax function to fetch the allele values without reloading the page.
    // Get the index number of the genotype record to retrieve; retrieve it; populate the alleles.

    var mndx, sndx = 0;

    mndx = $('#marker').val();

    if (Study_selected) {
      sndx = $('#stylabid').val();
    } else { 
      sndx = $('#pjtlabid').val();
    }    

    // for debugging...    
    //alert('sndx='+sndx+', mndx='+mndx);

    // This is the cryptic jQuery 'magic' that fetches the genotype values when the
    // Fetch button is clicked, and displays the values fetched.

    $.post("fetchAlleles.php", {mndx: mndx, sndx: sndx},

      function(result) {

    // The .each method used on the return object is the key to displaying multiple
    // run dates, and genotype values, associated with a sample. 

    i=0;
    $.post("fetchAlleles.php", {'mndx': mndx, 'sndx': sndx},

function(result) {
    // this works for a single return value
    //$('#allele_1_1').get(0).value = result[0].allele1;
    //$('#allele_1_2').get(0).value = result[0].allele2;
    //$('#run_date1').get(0).value = result[0].run_date;

    // The .each method used on the return object is the key to displaying multiple
    // run dates, and genotype values, associated with a sample. 

    i=0;
$.each(result,function() {
  if (i==0) {
    $('#allele_1_1').val(this.allele1);
    $('#allele_1_2').val(this.allele2);
    $('#run_date1').val(this.run_date);
  } else if (i==1) {
    $('#allele_2_1').val(this.allele1);
    $('#allele_2_2').val(this.allele2);
    $('#run_date2').val(this.run_date);
  } else if (i==2) {
    $('#allele_3_1').val(this.allele1);
    $('#allele_3_2').val(this.allele2);
    $('#run_date3').val(this.run_date);
  }
  i=i+1;
    })
  }
);
      } 
```

我曾尝试使用 Firebug 进入代码，但在上面的代码中，只要它越过 .post 行，它就会说结果未定义。

php脚本的相关部分是：

```
 $sql = "SELECT allele1, allele2, run_date FROM geno.genotypes WHERE markers_id=".$mndx." AND gsamples_id=".$sndx;

    // create array to hold results
    $obj_arr = array();
    $fetchresult = pg_exec($dbconnect, $sql);
    if ($fetchresult) {
        while ($obj = pg_fetch_object($fetchresult))
        // Add this object to our array of objects to return
        if (!array_push($obj_arr,$obj)) {
            echo("Error pushing results onto obj_arr");
            showerror(0,"Failed to connect to database",'fetchAlleles',38,"Failed in line 38");
            exit;
        }        
        // for debugging
        //print_r($obj_arr);
    } else {
        echo "(25) Failed to retrieve results.<BR>SQL: ".$sql."</br>";
    }

    // It appears necessary to return the array as json encapsulated.
    echo json_encode($obj_arr); 
```

非常感谢任何帮助！--rixter

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:25:13.363

如果将 post 请求的类型定义为 json，即使出现错误也需要返回 json

您可以在结果函数中使用

```
console.log(result); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:04:28.717

尝试这个

```
$.post("fetchAlleles.php", {'mndx': mndx, 'sndx': sndx}, 
```

将您的钥匙装在刺中并检查这是否有效..

还要检查浏览器控制台部分中的任何错误。检查请求部分中的参数是什么，如果成功，请检查响应

# ios - 查找与 AVPlayerItem 关联的 AVPlayer

> ID：12611120
> 
> 赞同：16
> 
> 时间：2012-09-26T22:00:08.720
> 
> 标签：ios, avplayer

一个 AVPlayerItem 只能分配给一个 AVPlayer。将 AVPlayerItem 添加到 AVPlayer 后，将来尝试将其添加到不同的 AVPlayer 将 SIGABRT 应用程序。

所以，给定一个 AVPlayerItem，你如何确定：

1.  它当前与什么 AVPlayer 相关联？和
2.  如果它曾经在过去的任何时候插入到 AVPlayer 中？

以下代码可靠地演示了该问题：

```
AVPlayerItem *item = [AVPlayerItem playerItemWithURL:[NSURL URLWithString:@"http://devimages.apple.com/iphone/samples/bipbop/bipbopall.m3u8"]];
AVPlayer *firstPlayer = [[AVPlayer alloc] init];
[firstPlayer replaceCurrentItemWithPlayerItem:item];
AVPlayer *secondPlayer = [[AVPlayer alloc] init];
[secondPlayer replaceCurrentItemWithPlayerItem:item]; 
```

这是错误消息：

```
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: 'An AVPlayerItem cannot be associated with more than one instance of AVPlayer' 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-07-07T14:09:38.797

有一种半合法的方式在未来可能会被打破。播放器项目有一个名为`_player`. 您可以像这样查询它（从技术上讲，它不使用私有 API，所以我认为它应该是 AppStore 安全的）：

```
id player = [item valueForKey:@"player"]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-18T12:50:29.103

你试过反过来吗？尝试访问 AVPlayer 正在播放的项目内的详细信息

```
AVPlayer *firstPlayer = [[AVPlayer alloc]init]; 
```

之后您可以访问。`firstPlayer.currentItem`这将使您可以访问`firstPlayer`。`AVPlayerItem`

例如：

```
firstPlayer.currentItem.duration 
```

将为您提供该曲目的持续时间。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-03-22T20:08:34.300

这是一个优雅的解决方案，没有私钥和相关对象。创建自定义播放器项目：

```
class PlayerAwareItem {
    weak var player: AVPlayer?
} 
```

设置播放器：

```
let item = PlayerAwareItem(asset: asset)
let player = AVPlayer(playerItem: item)
item.player = player 
```

以后有物品时访问播放器（在此示例中，我们希望在停止后重新启动播放器）：

```
@objc func handlePlayerItemDidStall(_ notification: Notification) {
    guard let playerItem = notification.object as? PlayerAwareItem,
        let player = playerItem.player else { return }
    player.play()
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-05T05:25:32.307

您可以将 an`AVPlayerItem`与`AVPlayer`using 关联：

```
static char playerKey;

objc_setAssociatedObject(item, &playerKey, player, OBJC_ASSOCIATION_RETAIN); 
```

并使用：

```
objc_getAssociatedObject(item, &playerKey); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-07T14:37:16.737

Based on Anil's answer, for a looped playback on multiple videos:

```
for (NSObject * obj in cachedVideos){
    if ([obj isKindOfClass:[AVPlayerLayer class]]){
        AVPlayerLayer * layer = (AVPlayerLayer *)obj;
        if ([layer.player.currentItem isEqual:n.object]){
            [layer.player seekToTime:kCMTimeZero];
            [layer.player play];
            break;
        }
    }
} 
```

# php - 从数组中弹出键或元素

> ID：12611123
> 
> 赞同：0
> 
> 时间：2012-09-26T22:00:21.320
> 
> 标签：php, cakephp

请阅读代码中的注释。我需要弹出符合某些条件的元素

```
$popthisarray= array(12, 34);

main array

array
    0
    array
        'id' => int 12

    1
    array
        'id' => int 1456

    2
    array
        'id' => int 34

    3
    array
        'id' => int 534 
```

我需要从我拥有的 $popthisarray 中的主数组中弹出元素

```
foreach($mainarray as $myarray){

// $myid will be either 12 0r 34

    if(in_array($my['id'],$mainarray)){

        //here I need to take the element out of main array
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:04:53.910

您想删除, 在?`$mainarray`中具有`id`值的所有元素`$popthisarray`

```
foreach($mainarray as $k => $my) {
    if(in_array($my['id'], $popthisarray)) {
        unset($mainarray[$k]);
    }
} 
```

如果您想重新组织密钥，请使用`array_values`：

```
$mainarray = array_values($mainarray); 
```

# javascript - 动态变化 使用无限滚动和砖石在分页期间对新照片集进行标识

> ID：12611128
> 
> 赞同：0
> 
> 时间：2012-09-26T22:01:16.877
> 
> 标签：javascript, jquery, ruby-on-rails-3, jquery-masonry

我正在使用 Infinitescroll 来设置分页。出于我的模态目的，我想为每组新照片提供一个唯一的 ID。现在，我可以设置类（静态）。

`itemSelector : '.each_photo_container'`

我遇到的问题是，当我尝试将 div ID 添加到当前照片的 ID（遍历每张照片）时，javascript 会不断将新照片的 ID 设置为第一组中第一张照片的 ID。

```
$newElems.attr('id', '<%=photo[:id]%>'); 
```

**如何为无限滚动和砖石加载的每张新照片动态添加值为 photo[:id] 的 ID？**

index.html.erb （我知道 javascript 必须移动到它自己的文件中）

```
<div class="body_container">

  <div id="index_header">
     <h1>Let's look at <%=params[:search]%>:</h1>
   </div>

   <div id="photos_container">
     <% @photos_array.each do |photo| %>

         <div class='each_photo_container' id='<%=photo[:id]%>' >
           <%= link_to '#' do %>
             <%= image_tag photo[:s_url] %>
           <% end %>
         </div>

      <!-- Masonry/Pinterest Layout + InfiniteScroll/Pagination -->
      <script type="text/javascript">
       $(function () {

         var $container = $('#photos_container');

         $container.imagesLoaded(function(){
           $container.masonry({
            itemSelector : '.each_photo_container',
           });
         });

         $container.infinitescroll({
           navSelector  : 'div.#page_navigation',            
           nextSelector : 'div.#page_navigation a',    
           itemSelector : '.each_photo_container'          

         },
         //trigger masonry on infinitescroll callback and add id to div
           function(newElements){

             var $newElems = $(newElements).css({ opacity: 0 });

             $newElems.imagesLoaded(function(){

               $newElems.animate({ opacity: 1 });
               $newElems.attr('id', '<%=photo[:id]%>'); //not appending correct ID - keeps appending first element ID

               $container.masonry('appended', $newElems,true);

             });
           }

         );

       });
      </script> 

  <!-- Load Modal onClick -->
  <script type="text/javascript">
  jQuery(function() {
    $('#<%=photo[:id]%>').click(function (e) {

      //ajax call to fetch photo info

      var fetch_id = '<%=photo[:id]%>';
      var fetch_secret = '<%=photo[:secret]%>';  

      $.ajax({
        type: 'GET',
        url: '/photos/fetch_info',
        dataType: 'json',
        data: { 'id' : fetch_id, 'secret' : fetch_secret },
        success: function(data){

          //edit innerHTML of basic_modal
          $('.basic_modal').html(
             //irrelevant code removed for readability
           );

          //load modal
          $('.basic_modal').modal({
            overlayClose:true
          });

        } //end success: function(result)
      });

      return false;
    });
  });
  </script>

  <% end %>

  <div class="basic_modal">
  </div>

  </div><!--End photos_container-->

  <div id="page_navigation">
  <%= link_to "Next", {:controller => "photos", :action => "index", :page => @page.to_i+1, :search => params[:search]}%>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:24:58.933

能够解决这个问题。查看 Infinitescroll 文档，您可以使用它来引用当前元素。

`$newElems.attr('id', this.id);`修复问题并分配正确的 ID。

# google-apps-script - 为什么 Google Script 会自动添加 50 行？

> ID：12611135
> 
> 赞同：0
> 
> 时间：2012-09-26T22:02:01.063
> 
> 标签：google-apps-script, google-sheets

我的代码只是将数据从电子表格 A 添加到电子表格 B。在电子表格 A 有 21 行数据而电子表格 B 只有 20 行的情况下，我的脚本显然试图写入电子表格 B 中的一行不存在。所以脚本显然会自动添加 50 行来为多余的数据腾出空间。

当一行就足够时，有没有办法阻止它添加 50 行？

这通常不会打扰我……但电子表格 B 中有格式，它会自动复制到 50 行。当电子表格 B 发布到我们的网站时，这种格式看起来不正确。

这是我的代码。当`rowCounterDTL`变量超过电子表格 B 中存在的行数时，电子表格 B 中会自动添加 50 行。

```
//Cycle through each line item in the task log
for (var i = 0; i < dataTL.length; ++i) {

    //If the package type is Other
    if(dataTL[i][2] == "Other Item" && dataTL[i][4] == "Complete") {

      continue;

    } else if (dataTL[i][2] == "Other Item") {

      rowCounterDTL = rowCounterDTL + 1

      var daysOld = Math.round((todaysDate - dataTL[i][0])/1000/60/60/24);

      sheetDTL.getRange(rowCounterDTL,1).setValue(dataTL[i][1]); //Add the client ID to column 1 of the DTL
      sheetDTL.getRange(rowCounterDTL,2).setValue(dataTL[i][2]); //Add the package type to column 2 of the DTL
      sheetDTL.getRange(rowCounterDTL,3).setValue(dataTL[i][3]); //Add the package notes to column 3 of the DTL
      sheetDTL.getRange(rowCounterDTL,4).setValue(dataTL[i][4]); //Add the package priority to column 4 of the DTL
      sheetDTL.getRange(rowCounterDTL,5).setValue(daysOld); //Add the age to column 5 of the DTL

        if (daysOld>20){

            sheetDTL.getRange(rowCounterDTL,6).setValue("On Hold?");

        } else if(daysOld>7) {

            sheetDTL.getRange(rowCounterDTL,6).setValue("Max!");

        } else if (daysOld>4){

            sheetDTL.getRange(rowCounterDTL,6).setValue("High");

        } else if (daysOld>2){

            sheetDTL.getRange(rowCounterDTL,6).setValue("Moderate");

        } else if (daysOld<3){

            sheetDTL.getRange(rowCounterDTL,6).setValue("Low");

        }

      sheetDTL.getRange(rowCounterDTL,1,1,6).setBackgroundRGB(255, 121, 255)
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:33:09.310

假设你有这条线

`for (var i = 0; i < dataTL.length; ++i) {`在此逻辑上方的代码中，

问题出在`++i`. 正在发生的事情是，当您调用 ++i 时，它会在您的 for 循环中的语句开始之前将值增加 1。

取而代之`for (var i = 0; i < dataTL.length; i++) {`的是，您应该准备就绪。

将“++”放在后面，意味着您将在逻辑完成后将 i 加一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T00:29:25.167

你能先插入一个 if 语句来检查可用的行吗？

```
} else if (dataTL[i][2] == "Other Item") {
  if (rowCounterDTL == sheetDTL.getMaxRows()) {
    sheetDTL.insertRowAfter(rowCounterDTL);
  }
  rowCounterDTL = rowCounterDTL + 1 
```

# android - GCM onRegistered 未调用

> ID：12611138
> 
> 赞同：7
> 
> 时间：2012-09-26T22:02:04.877
> 
> 标签：android, google-cloud-messaging

onRegistered 方法永远不会被调用，在 logcat 中我看到最后一行正在获取唤醒锁。

> *   09-26 14:03:23.285: D/GCMRegistrar(15820): 重置退避
> *   09-26 14:03:23.285: V/GCMRegistrar(15820): 注册应用程序 *a of senders 735175912799
> *   09-26 14:03:23.895: V/GCMBroadcastReceiver(15820): onReceive: - com.google.android.c2dm.intent.REGISTRATION 09-26 14:03:23.895: V/GCMRegistrar(15820): 设置名称重试接收器类到 *.notifications.MyGCMBroadcastReceiver
> *   09-26 14:03:23.895：V/GCMBroadcastReceiver(15820)：GCM IntentService 类：- *.notifications.GCMIntentService
> *   09-26 14:03:23.903: V/GCMBaseIntentService(15820): 获取唤醒锁

我有自己的广播接收器：

```
import com.google.android.gcm.GCMBroadcastReceiver;

public class MyGCMBroadcastReceiver extends GCMBroadcastReceiver {

    @Override
    protected String getGCMIntentServiceClassName (Context context) {
        return GCMIntentService.class.getCanonicalName();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-22T06:38:39.037

以下是常见的解决方案：

1) 将您的服务命名为`"GCMIntentService"`

2）把你`GCMIntentService`的默认包

3) 在发送 GCM 注册请求之前调用

```
GCMRegistrar.checkDevice(this);
GCMRegistrar.checkManifest(this); 
```

因此，如果您的设备或清单有任何问题，它会告诉您。4）检查权限。特别是在权限中检查包鬃毛。这是一个嵌套，如果您在权限中弄乱了包名称，它将适用于最新的 androids(Jelly Bean +)，但在较低的设备中会失败

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T09:57:22.947

我有类似的问题。原来我忘记在ApplicationManifest.xml中添加：

```
<service android:name=".GCMIntentService"/> 
```

# php - php regex - 需要捕获 2 个组

> ID：12611140
> 
> 赞同：0
> 
> 时间：2012-09-26T22:02:09.067
> 
> 标签：php, regex, html-parsing

我需要捕获 2 个组：1-expr（可以为空）；2-ESSI

见下面的代码

```
$s = 'regular expr<span>essi</span>on contains';
function my_func($matches){

    //I need 2 groups captured
    //$matches[1] - "expr" (see $s before span) - can be empty, but I still need to capture it
    //$matches[2] - "essi" (between spans)
}
$pattern = "???";
echo preg_replace_callback($pattern, my_func, $s); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:05:01.740

```
$pattern = "~(\w*)<span>(\w+)</span>~"; 
```

这应该可以解决问题。

如果第二组也应该能够匹配空字符串，请将 替换为`+`另一个`*`。请注意，`\w`它将匹配字母、数字和下划线。如果太多或不足，请用适当的字符类替换它。

还有一件事：我认为 for 的语法`preg_replace_callback`要求您将函数名作为字符串提交。

# php - php-error.log 多次报告相同的错误

> ID：12611144
> 
> 赞同：0
> 
> 时间：2012-09-26T22:02:24.673
> 
> 标签：php

php-error.log 多次报告相同的错误。似乎与每个浏览器请求一样。大多数页面都禁用缓存，因为这是一个包含用户生成内容的动态站点。

在 php.ini 中，ignore_repeated_errors 和 ignore_repeated_source 都是 On。

有没有人有任何想法来解决这个问题？

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:07:57.733

[PHP 日志不会忽略 ignore_repeated_errors = On 的重复错误](https://stackoverflow.com/questions/1964732/php-log-will-not-ignore-repeated-errors-with-ignore-repeated-errors-on)- 它会在每次脚本执行时发生（因此通常是...每个请求）。您如何运行 PHP（mod_php、fastcgi、...）？最好的选择是事后过滤日志，但如果你真的想更早进入那里，你可以使用像缓存这样的东西，它与错误消息一起传递，只有在缓存未命中时才记录。

或者，如果您正在运行典型的 LAMP 堆栈，则可以使用 db 表进行日志记录，并且仅在不存在最近的行时才插入新行。

# php - 使用 mysql php 运行基于另一个查询的查询

> ID：12611146
> 
> 赞同：3
> 
> 时间：2012-09-26T22:02:28.613
> 
> 标签：php, mysql, subquery, implode

下面的代码搜索我的 mysql 数据库，并使用存储过程返回邮政编码，如 IG6、RM11、RM8、RM4、RM2、RM6、RM7、RM1、RM5 和距离。（一切都好）

问题：有了这些结果，我想在同一数据库中搜索另一个表，该表可能包含这些邮政编码的工作信息（可能使用`LIKE`）。

让这个工作的最佳方法是什么？我尝试了很多示例（`implode`,`arrays`等） 一个与数据库的连接是否正确？如何查询变量，因为它返回 2 列，邮政编码和距离。我应该分成一个数组（如何？）

最终产品：HGV 司机 RM5，清洁工 RM5，老师 RM5

( `SELECT title FROM jobinfo WHERE location IN results from other query`);

```
 <?php
    include ("conn.php");
    $first="RM5";

    $result = mysql_query("select outcode, GetDistance(Lat, Lon, (SELECT Lat from postcodes where outcode = '$first' limit 1),(SELECT Lon from postcodes where outcode = '$first' limit 1)) as Distance from postcodes having Distance < 3 order by Distance DESC;");
    while($row = mysql_fetch_array($result))
    {
        echo  ($row['outcode']) ;
    } 
    // This returns postcodes

    $resultb = mysql_query("SELECT title FROM jobinfo WHERE location IN ($results[outcode]) ");
    while($row = mysql_fetch_array($resultb))
    {
        echo  ($row['title']) ;
    }
    mysql_close($con);
?> 
```

请帮助.....任何对连接表的引用都需要完整的解释，因为到目前为止都没有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:07:39.400

首先将输出准备到子句中：

在第一个 while 循环中：

```
while($row = mysql_fetch_array($result))
 {
    $array[] = $row['outcode'] ;
 } 
```

然后为 IN 子句准备数组：

```
foreach ($array as $a) {$clause.= "'$a',";}
$clause=substr($clause,0,-1) 
```

最后使用 IN 语句的子句：

```
$resultb = mysql_query("SELECT title FROM jobinfo WHERE location IN ($clause) " 
```

===== 编辑 === LIKE 语句

对于 like.. 你需要多个 like 语句`OR`一起使用.. 一起[使用 SQL LIKE 和 IN](https://stackoverflow.com/questions/2318126/using-sql-like-and-in-together)

将 prepare 子句代码更改为：

```
foreach ($array as $a) {$clause.= " location LIKE '%$a%' OR";}
$clause=substr($clause,0,-3) 
```

并且 sql 变为：

```
$resultb = mysql_query("SELECT title FROM jobinfo WHERE $clause "); 
```

当然你会想要添加更多的错误检查..想想可能的注入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:34:12.910

我认为您正在尝试执行类似[MySQL LIKE IN() 的答案？](https://stackoverflow.com/questions/1127088/mysql-like-in)

另外，请使用参数化查询[如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php)

# php - 如何使用 PHPExcel 将数据导出到 Excel 文件

> ID：12611148
> 
> 赞同：22
> 
> 时间：2012-09-26T22:02:31.647
> 
> 标签：php, phpexcel

我从 Limesurvey 获取源代码，并将 PHPExcel 库添加到我的 Limesurvey 代码中，以便在单击链接后将数据导出到 Excel 文件。目前打开的 excel 文件中包含一些虚拟数据，没有任何问题。在用户输入调查信息后，我需要能够从 Web 服务器动态添加数据。我查看了一些我发现的网站，但运气不佳。谁能帮我吗？

**编辑**

```
<?php 
$dbhost= "mysql"; //your MySQL Server 
$dbuser = "survey"; //your MySQL User Name 
$dbpass = "password"; //your MySQL Password 
$dbname = "database"; 
//your MySQL Database Name of which database to use this 
$tablename = "questions"; //your MySQL Table Name which one you have to create excel file 
// your mysql query here , we can edit this for your requirement 
$sql = "Select * from $table "; 
//create  code for connecting to mysql 
$Connect = @mysql_connect($dbhost, $dbuser, $dbpass) 
or die("Couldn't connect to MySQL:<br>" . mysql_error() . "<br>" . mysql_errno()); 
//select database 
$Db = @mysql_select_db($dbname, $Connect) 
or die("Couldn't select database:<br>" . mysql_error(). "<br>" . mysql_errno()); 
//execute query 
$result = @mysql_query($sql,$Connect) 
or die("Couldn't execute query:<br>" . mysql_error(). "<br>" . mysql_errno()); 

error_reporting(E_ALL);

 require_once '../Classes/PHPExcel.php';
 $objPHPExcel = new PHPExcel();

 // Set the active Excel worksheet to sheet 0 

$objPHPExcel->setActiveSheetIndex(0);  

// Initialise the Excel row number 

$rowCount = 1;  

//start of printing column names as names of MySQL fields  

 $column = 'A';

for ($i = 1; $i < mysql_num_fields($result); $i++)  

{
    $objPHPExcel->getActiveSheet()->setCellValue($column.$rowCount, mysql_field_name($result,$i));
    $column++;
}

//end of adding column names  
//start while loop to get data  

$rowCount = 2;  

while($row = mysql_fetch_row($result))  

{  
    $column = 'A';

   for($j=1; $j<mysql_num_fields($result);$j++)  
    {  
        if(!isset($row[$j]))  

            $value = NULL;  

        elseif ($row[$j] != "")  

            $value = strip_tags($row[$j]);  

        else  

            $value = "";  

        $objPHPExcel->getActiveSheet()->setCellValue($column.$rowCount, $value);
        $column++;
    }  

    $rowCount++;
} 

// Redirect output to a client’s web browser (Excel5) 
header('Content-Type: application/vnd.ms-excel'); 
header('Content-Disposition: attachment;filename="results.xls"'); 
header('Cache-Control: max-age=0'); 
$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5'); 
$objWriter->save('php://output'); 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-09-26T22:54:08.323

如果你直接复制了这个，那么：

```
->setCellValue('B2', Ackermann') 
```

应该

```
->setCellValue('B2', 'Ackermann') 
```

回答你的问题：

从limesurvey 获取您想要的数据，并使用setCellValue() 将这些数据值存储在您要存储它的单元格中。

/Tests 中的 Quadratic.php 示例文件作为起点可能会有所帮助：它从输入表单中获取数据并将其设置到 Excel 工作簿中的单元格。

**编辑**

一个极其简单的例子：

```
// Create your database query
$query = "SELECT * FROM myDataTable";  

// Execute the database query
$result = mysql_query($query) or die(mysql_error());

// Instantiate a new PHPExcel object
$objPHPExcel = new PHPExcel(); 
// Set the active Excel worksheet to sheet 0
$objPHPExcel->setActiveSheetIndex(0); 
// Initialise the Excel row number
$rowCount = 1; 
// Iterate through each result from the SQL query in turn
// We fetch each database result row into $row in turn
while($row = mysql_fetch_array($result)){ 
    // Set cell An to the "name" column from the database (assuming you have a column called name)
    //    where n is the Excel row number (ie cell A1 in the first row)
    $objPHPExcel->getActiveSheet()->SetCellValue('A'.$rowCount, $row['name']); 
    // Set cell Bn to the "age" column from the database (assuming you have a column called age)
    //    where n is the Excel row number (ie cell A1 in the first row)
    $objPHPExcel->getActiveSheet()->SetCellValue('B'.$rowCount, $row['age']); 
    // Increment the Excel row counter
    $rowCount++; 
} 

// Instantiate a Writer to create an OfficeOpenXML Excel .xlsx file
$objWriter = new PHPExcel_Writer_Excel2007($objPHPExcel); 
// Write the Excel file to filename some_excel_file.xlsx in the current directory
$objWriter->save('some_excel_file.xlsx'); 
```

**编辑#2**

使用您现有的代码作为基础

```
// Instantiate a new PHPExcel object 
$objPHPExcel = new PHPExcel();  
// Set the active Excel worksheet to sheet 0 
$objPHPExcel->setActiveSheetIndex(0);  
// Initialise the Excel row number 
$rowCount = 1;  

//start of printing column names as names of MySQL fields  
$column = 'A';
for ($i = 1; $i < mysql_num_fields($result); $i++)  
{
    $objPHPExcel->getActiveSheet()->setCellValue($column.$rowCount, mysql_field_name($result,$i));
    $column++;
}
//end of adding column names  

//start while loop to get data  
$rowCount = 2;  
while($row = mysql_fetch_row($result))  
{  
    $column = 'A';
    for($j=1; $j<mysql_num_fields($result);$j++)  
    {  
        if(!isset($row[$j]))  
            $value = NULL;  
        elseif ($row[$j] != "")  
            $value = strip_tags($row[$j]);  
        else  
            $value = "";  

        $objPHPExcel->getActiveSheet()->setCellValue($column.$rowCount, $value);
        $column++;
    }  
    $rowCount++;
} 

// Redirect output to a client’s web browser (Excel5) 
header('Content-Type: application/vnd.ms-excel'); 
header('Content-Disposition: attachment;filename="Limesurvey_Results.xls"'); 
header('Cache-Control: max-age=0'); 
$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5'); 
$objWriter->save('php://output'); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-01-12T17:56:07.240

尝试下面的完整示例

```
<?php
  $objPHPExcel = new PHPExcel();
  $query1 = "SELECT * FROM employee";
  $exec1 = mysql_query($query1) or die ("Error in Query1".mysql_error());
  $serialnumber=0;
  //Set header with temp array
  $tmparray =array("Sr.Number","Employee Login","Employee Name");
  //take new main array and set header array in it.
  $sheet =array($tmparray);

  while ($res1 = mysql_fetch_array($exec1))
  {
    $tmparray =array();
    $serialnumber = $serialnumber + 1;
    array_push($tmparray,$serialnumber);
    $employeelogin = $res1['employeelogin'];
    array_push($tmparray,$employeelogin);
    $employeename = $res1['employeename'];
    array_push($tmparray,$employeename);   
    array_push($sheet,$tmparray);
  }
   header('Content-type: application/vnd.ms-excel');
   header('Content-Disposition: attachment; filename="name.xlsx"');
  $worksheet = $objPHPExcel->getActiveSheet();
  foreach($sheet as $row => $columns) {
    foreach($columns as $column => $data) {
        $worksheet->setCellValueByColumnAndRow($column, $row + 1, $data);
    }
  }

  //make first row bold
  $objPHPExcel->getActiveSheet()->getStyle("A1:I1")->getFont()->setBold(true);
  $objPHPExcel->setActiveSheetIndex(0);
  $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');
  $objWriter->save(str_replace('.php', '.xlsx', __FILE__));
?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-28T07:24:00.087

```
$this->load->library('excel');
$file_name = 'Demo';
$arrHeader = array('Name', 'Mobile');
$arrRows = array(0=>array('Name'=>'Jayant','Mobile'=>54545), 1=>array('Name'=>'Jayant1', 'Mobile'=>44454), 2=>array('Name'=>'Jayant2','Mobile'=>111222), 3=>array('Name'=>'Jayant3', 'Mobile'=>99999));
$this->excel->getActiveSheet()->fromArray($arrHeader,'','A1');
$this->excel->getActiveSheet()->fromArray($arrRows);
header('Content-Type: application/vnd.ms-excel'); //mime type
header('Content-Disposition: attachment;filename="'.$file_name.'"'); //tell browser what's the file name
header('Cache-Control: max-age=0'); //no cache
$objWriter = PHPExcel_IOFactory::createWriter($this->excel, 'Excel5');  
$objWriter->save('php://output'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-12-15T16:38:52.000

100% 工作。可能与创建者的答案无关，但我为用户分享了将 mysql 查询导出到 phpexcel 的问题。祝你好运。

```
require('../phpexcel/PHPExcel.php');

require('../phpexcel/PHPExcel/Writer/Excel5.php');

$filename = 'userReport'; //your file name

    $objPHPExcel = new PHPExcel();
    /*********************Add column headings START**********************/
    $objPHPExcel->setActiveSheetIndex(0)
                ->setCellValue('A1', 'username')
                ->setCellValue('B1', 'city_name');

    /*********************Add data entries START**********************/
//get_result_array_from_class**You can replace your sql code with this line.
$result = $get_report_clas->get_user_report();
//set variable for count table fields.
$num_row = 1;
foreach ($result as $value) {
  $user_name = $value['username'];
  $c_code = $value['city_name'];
  $num_row++;
        $objPHPExcel->setActiveSheetIndex(0)
                ->setCellValue('A'.$num_row, $user_name )
                ->setCellValue('B'.$num_row, $c_code );
}

    /*********************Autoresize column width depending upon contents START**********************/
    foreach(range('A','B') as $columnID) {
        $objPHPExcel->getActiveSheet()->getColumnDimension($columnID)->setAutoSize(true);
    }
    $objPHPExcel->getActiveSheet()->getStyle('A1:B1')->getFont()->setBold(true);

//Make heading font bold

        /*********************Add color to heading START**********************/
        $objPHPExcel->getActiveSheet()
                    ->getStyle('A1:B1')
                    ->getFill()
                    ->setFillType(PHPExcel_Style_Fill::FILL_SOLID)
                    ->getStartColor()
                    ->setARGB('99ff99');

        $objPHPExcel->getActiveSheet()->setTitle('userReport'); //give title to sheet
        $objPHPExcel->setActiveSheetIndex(0);
        header('Content-Type: application/vnd.ms-excel');
        header("Content-Disposition: attachment;Filename=$filename.xls");
        header('Cache-Control: max-age=0');
        $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');
        $objWriter->save('php://output'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-25T10:13:24.290

经过一系列谷歌搜索从sql语句下载excel文件后，我目前在我的项目中使用此功能

```
 // $sql = sql query e.g "select * from mytablename"
    // $filename = name of the file to download 
        function queryToExcel($sql, $fileName = 'name.xlsx') {
                // initialise excel column name
                // currently limited to queries with less than 27 columns
        $columnArray = array("A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z");
                // Execute the database query
                $result =  mysql_query($sql) or die(mysql_error());

                // Instantiate a new PHPExcel object
                $objPHPExcel = new PHPExcel();
                // Set the active Excel worksheet to sheet 0
                $objPHPExcel->setActiveSheetIndex(0);
                // Initialise the Excel row number
                $rowCount = 1;
    // fetch result set column information
                $finfo = mysqli_fetch_fields($result);
// initialise columnlenght counter                
$columnlenght = 0;
                foreach ($finfo as $val) {
// set column header values                   
  $objPHPExcel->getActiveSheet()->SetCellValue($columnArray[$columnlenght++] . $rowCount, $val->name);
                }
// make the column headers bold
                $objPHPExcel->getActiveSheet()->getStyle($columnArray[0]."1:".$columnArray[$columnlenght]."1")->getFont()->setBold(true);

                $rowCount++;
                // Iterate through each result from the SQL query in turn
                // We fetch each database result row into $row in turn

                while ($row = mysqli_fetch_array($result, MYSQL_NUM)) {
                    for ($i = 0; $i < $columnLenght; $i++) {
                        $objPHPExcel->getActiveSheet()->SetCellValue($columnArray[$i] . $rowCount, $row[$i]);
                    }
                    $rowCount++;
                }
// set header information to force download
                header('Content-type: application/vnd.ms-excel');
                header('Content-Disposition: attachment; filename="' . $fileName . '"');
                // Instantiate a Writer to create an OfficeOpenXML Excel .xlsx file        
                // Write the Excel file to filename some_excel_file.xlsx in the current directory                
                $objWriter = new PHPExcel_Writer_Excel2007($objPHPExcel); 
                // Write the Excel file to filename some_excel_file.xlsx in the current directory
                $objWriter->save('php://output');
            } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-11T08:56:09.790

```
// gl and gl2 excel file Export Program
public function glExcelFileExport()
{
    $from_date1 = $this->input->post('from_date1');
    $to_date1 = $this->input->post('to_date1');
    $account_number = $this->input->post('account_number');
    $glnames = $this->input->post('glnames');

    $sql = "SELECT * FROM ut_sbi_reco_rungl WHERE value_date between '".$from_date1."' AND '".$to_date1."' ";
    $result = $this->db->query($sql)->result_array();

    if(count($result)>0)
    {
        require FCPATH . 'vendor/autoload.php';

        $object = new PHPExcel();

        $prestasi = $object->setActiveSheetIndex(0); 

        //manage row hight

        $object->getActiveSheet()->getRowDimension(1)->setRowHeight(25);

        // Excel Heading Description
        if($glnames == 'gl1') {

        //style alignment

        $styleArray = array(

            'alignment' => array('horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,

                'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,

            ),

        );

        $object->getActiveSheet()->getStyle('A1:U1')->getFont()->setBold(true);

        $object->getActiveSheet()->getStyle('A1:U1')->applyFromArray($styleArray);

        //border

        $styleArray1 = array(

            'borders' => array(

                'allborders' => array(

                    'style' => PHPExcel_Style_Border::BORDER_THIN

                )

            )

        );

        //background

        $styleArray12 = array(

            'fill' => array(

                'type' => PHPExcel_Style_Fill::FILL_SOLID,

                'startcolor' => array(

                    'rgb' => 'FFFF00',

                ),

            ),

        );

        //freeepane

        $object->getActiveSheet()->freezePane('A2');

        //column width

        $object->getActiveSheet()->getColumnDimension('A')->setWidth(15);

        $object->getActiveSheet()->getColumnDimension('B')->setWidth(15);

        $object->getActiveSheet()->getColumnDimension('C')->setWidth(15);

        $object->getActiveSheet()->getColumnDimension('D')->setWidth(20);

        $object->getActiveSheet()->getColumnDimension('E')->setWidth(20);

        $object->getActiveSheet()->getColumnDimension('F')->setWidth(12);

        $object->getActiveSheet()->getColumnDimension('G')->setWidth(15);

        $object->getActiveSheet()->getColumnDimension('H')->setWidth(20);

        $object->getActiveSheet()->getColumnDimension('I')->setWidth(20);

        $object->getActiveSheet()->getColumnDimension('J')->setWidth(20);

        $object->getActiveSheet()->getColumnDimension('K')->setWidth(20);

        $object->getActiveSheet()->getColumnDimension('L')->setWidth(10);

        $object->getActiveSheet()->getColumnDimension('M')->setWidth(12);

        $object->getActiveSheet()->getColumnDimension('N')->setWidth(25);

        $object->getActiveSheet()->getColumnDimension('O')->setWidth(15);

        $object->getActiveSheet()->getColumnDimension('P')->setWidth(15);

        $object->getActiveSheet()->getColumnDimension('Q')->setWidth(15);

        $object->getActiveSheet()->getColumnDimension('R')->setWidth(15);

        $object->getActiveSheet()->getColumnDimension('S')->setWidth(15);

        $object->getActiveSheet()->getColumnDimension('T')->setWidth(25);

        $object->getActiveSheet()->getColumnDimension('U')->setWidth(15);

        $object->getActiveSheet()->getStyle('A1:U1')->applyFromArray($styleArray1);

        $object->getActiveSheet()->getStyle('A1:U1')->applyFromArray($styleArray12);

        $object->getActiveSheet()->getStyle('I')->getNumberFormat()->setFormatCode("0.00");    

        $table_columns = array("SRL", "Scheme", "Tran Type", "App Refer", "OTH Refer",

             "Account", "Name", "Value Date", "Amount", "Pay Category", "Rev Flg",

              "Security", "Cheque Number", "SCH", "Book Date", "Cheque Date", 

              "Reg Id", "Inputter", "Narration", "FL", "Batch Number");

            $column = 0;

            foreach($table_columns as $field)
            {
                $object->getActiveSheet()->setCellValueByColumnAndRow($column, 1, $field);
                $column++;
            } 

        }

        if($glnames == 'gl2') {

            //style alignment

            $styleArray = array(

                'alignment' => array('horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,

                    'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,

                ),

            );

            $object->getActiveSheet()->getStyle('A1:C1')->getFont()->setBold(true);

            $object->getActiveSheet()->getStyle('A1:C1')->applyFromArray($styleArray);

            //border

            $styleArray1 = array(

                'borders' => array(

                    'allborders' => array(

                        'style' => PHPExcel_Style_Border::BORDER_THIN

                    )

                )

            );

            //background

            $styleArray12 = array(

                'fill' => array(

                    'type' => PHPExcel_Style_Fill::FILL_SOLID,

                    'startcolor' => array(

                        'rgb' => 'FFFF00',

                    ),

                ),

            );

            //freeepane

            $object->getActiveSheet()->freezePane('A2');

            //column width

            $object->getActiveSheet()->getColumnDimension('A')->setWidth(15);

            $object->getActiveSheet()->getColumnDimension('B')->setWidth(15);

            $object->getActiveSheet()->getColumnDimension('C')->setWidth(15);

            $object->getActiveSheet()->getStyle('A1:C1')->applyFromArray($styleArray1);

            $object->getActiveSheet()->getStyle('A1:C1')->applyFromArray($styleArray12);

            $object->getActiveSheet()->getStyle('C')->getNumberFormat()->setFormatCode("0.00");

            $table_columns1 = array("Account", "Name", "Amount");

            $column1 = 0;

            foreach($table_columns1 as $field1)
            {
                $object->getActiveSheet()->setCellValueByColumnAndRow($column1, 1, $field1);
                $column1++;
            } 

        }

        // List of column names

        $style = array(

                'alignment' => array(

                    'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,

                )
        );

        $prestasi->getDefaultStyle()->applyFromArray($style);

        if($glnames == 'gl1') {
              // Gl1 Query
             $excel_row = 2;
             for ($kk=0;$kk<count($account_number);$kk++) 
             { 
                $account_number2 = $account_number[$kk];
              $gl1Arr = $this->ut_gl_model->getDisplayGl1Query($account_number2,$from_date1,$to_date1);

              foreach($gl1Arr as $row)
              {           

               $object->getActiveSheet()->setCellValueByColumnAndRow(0, $excel_row, $row['srl']);
               $object->getActiveSheet()->setCellValueByColumnAndRow(1, $excel_row, $row['scheme']);
               $object->getActiveSheet()->setCellValueByColumnAndRow(2, $excel_row, $row['tran_type']);
               $object->getActiveSheet()->setCellValueByColumnAndRow(3, $excel_row, $row['app_refer']);
               $object->getActiveSheet()->setCellValueByColumnAndRow(4, $excel_row, $row['oth_refer']);
               $object->getActiveSheet()->setCellValueByColumnAndRow(5, $excel_row, $row['account']);
               $object->getActiveSheet()->setCellValueByColumnAndRow(6, $excel_row, $row['name']);
               $object->getActiveSheet()->setCellValueByColumnAndRow(7, $excel_row, (isset($row['value_date']) && $row['value_date']!='0000-00-00')?date('d/m/Y',strtotime($row['value_date'])):'');
               $object->getActiveSheet()->setCellValueByColumnAndRow(8, $excel_row, $row['amt']);
               $object->getActiveSheet()->setCellValueByColumnAndRow(9, $excel_row, $row['pay_catego']);
               $object->getActiveSheet()->setCellValueByColumnAndRow(10, $excel_row, $row['rev_flg']);
               $object->getActiveSheet()->setCellValueByColumnAndRow(11, $excel_row, $row['security']);
               $object->getActiveSheet()->setCellValueByColumnAndRow(12, $excel_row, $row['chq_number']);
               $object->getActiveSheet()->setCellValueByColumnAndRow(13, $excel_row, 'y');
               $object->getActiveSheet()->setCellValueByColumnAndRow(14, $excel_row, (isset($row['book_date']) && $row['book_date']!='0000-00-00')?date('d/m/Y',strtotime($row['book_date'])):'');
               $object->getActiveSheet()->setCellValueByColumnAndRow(15, $excel_row, (isset($row['chq_date']) && $row['chq_date']!='0000-00-00')?date('d/m/Y',strtotime($row['chq_date'])):'');
               $object->getActiveSheet()->setCellValueByColumnAndRow(16, $excel_row, $row['reg_id']);
               $object->getActiveSheet()->setCellValueByColumnAndRow(17, $excel_row, $row['inputter']);
               $object->getActiveSheet()->setCellValueByColumnAndRow(18, $excel_row, $row['narration']);
               $object->getActiveSheet()->setCellValueByColumnAndRow(19, $excel_row, '');
               $object->getActiveSheet()->setCellValueByColumnAndRow(20, $excel_row, '');

               $excel_row++;

               } 

             }

              // Excel Download Logic
                $downloadFile = 'gl1_'.date('Ymd').'.xlsx';
                $prestasi->setTitle("Gl1 Dump"); 
                $object_writer = PHPExcel_IOFactory::createWriter($object, 'Excel2007');
                header('Content-Type: application/vnd.ms-excel');
                header('Content-Disposition: attachment;filename="'.$downloadFile.'" ');
                $object_writer->save('php://output');                  
            }

        $excel_row1 = 2;
        if($glnames == 'gl2') {
              // Gl2 Query
            for ($jj=0;$jj<count($account_number);$jj++) 
            { 
                $account_number3 = $account_number[$jj];
                $gl2Arr = $this->ut_gl_model->getDisplayGl2Query($account_number3,$from_date1,$to_date1);

                foreach($gl2Arr as $row1)
                {      
                   $object->getActiveSheet()->setCellValueByColumnAndRow(0, $excel_row1, $row1['account']);
                   $object->getActiveSheet()->setCellValueByColumnAndRow(1, $excel_row1, $row1['name']);
                   $object->getActiveSheet()->setCellValueByColumnAndRow(2, $excel_row1, $row1['amount']);
                   // $object->getActiveSheet()->setCellValueByColumnAndRow(3, $excel_row1, $row1['value_date']);
                   $excel_row1++;

                }
            }                   
                // Excel Download Logic
                $prestasi->setTitle("Gl2 Dump");
                $downloadFile2 = 'gl2_'.date('Ymd').'.xlsx'; 
                $object_writer = PHPExcel_IOFactory::createWriter($object, 'Excel2007');
                header('Content-Type: application/vnd.ms-excel');
                header('Content-Disposition: attachment;filename="'.$downloadFile2.'" ');
                $object_writer->save('php://output');
            }             

    }
    else
    {
        $this->session->set_flashdata('error', 'Data not found.');
        redirect(site_url('sbi-reco/run-gl'));
    }

} 
```

# java - 欧拉计划 #3 Java

> ID：12611149
> 
> 赞同：1
> 
> 时间：2012-09-26T22:02:35.860
> 
> 标签：java, numbers

```
public class Problem3 {

    public static void main (String args[]) {
        System.out.print(primeMod(60085147514L));
    }

    public static double primeMod(long d) {
        long max = 0;
        int count = 0;

        for (long i = 2; i < d; i++) {
            if (d % i == 0) { 
                boolean isPrime = primeCounter(i);
                if(isPrime == true) { 
                    max = i;
                    System.out.println(max);
                }
            } else {
                max = max;
            }
        }

        return max;
    }

    public static boolean primeCounter(long x) {
        int count = 0;
        for (int s = 1; s <= x; s++) {
            if (x % s == 0) {
                count++;
            }
        }

        if (count == 2) {
            return true;
        } else {
            return false;
        }
    }
} 
```

我的程序适用于较小的数字，但是当它不被零除时，它会抛出除以 0 的算术异常。请不要给我答案，只是想理解它并提高我的技能谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T22:23:41.960

我的猜测`s`是溢出，最终导致除以零。换`s`一个`long`。

# ruby-on-rails - Rails 在开发模式下从 public/assets 而不是 app/assets 加载 css 文件

> ID：12611155
> 
> 赞同：2
> 
> 时间：2012-09-26T22:02:55.207
> 
> 标签：ruby-on-rails, assets

我正在开发模式下运行。我正在编辑 .css 文件，但没有看到更改。如果我转到 public/assets/ 并重命名 application.css，我会看到更改（它找不到任何样式）。为什么要使用该文件？不是生产模式吗？我不想一直在开发模式下预编译。谢谢。下面添加了环境文件。

开发.rb：

```
 Tcms::Application.configure do
  # Settings specified here will take precedence over those in config/application.rb

  # In the development environment your application's code is reloaded on
  # every request. This slows down response time but is perfect for development
  # since you don't have to restart the web server when you make code changes.
  config.cache_classes = false

  # Log error messages when you accidentally call methods on nil.
  config.whiny_nils = true

  # Show full error reports and disable caching
  config.consider_all_requests_local       = true
  config.action_controller.perform_caching = false

  # Don't care if the mailer can't send
  config.action_mailer.raise_delivery_errors = false

  # Print deprecation notices to the Rails logger
  config.active_support.deprecation = :log

  # Only use best-standards-support built into browsers
  config.action_dispatch.best_standards_support = :builtin

  # Raise exception on mass assignment protection for Active Record models
  config.active_record.mass_assignment_sanitizer = :strict

  # Log the query plan for queries taking more than this (works
  # with SQLite, MySQL, and PostgreSQL)
  config.active_record.auto_explain_threshold_in_seconds = 0.5

  # Do not compress assets
  config.assets.compress = false

  # Expands the lines which load the assets
  config.assets.debug = true
end 
```

生产.rb：

```
Tcms::Application.configure do
  # Uncomment and set this to match your production URL. Used for emailing links to the CMS. (default: localhost:3000)
  # config.cms.site_domain = "www.example.com"

  # Configure your mail server's address below
  config.action_mailer.smtp_settings = {:address => 'mail.yourmailserver.com', :domain => config.cms.site_domain}

  # Settings specified here will take precedence over those in config/application.rb

  # Code is not reloaded between requests
  config.cache_classes = true

  # Full error reports are disabled and caching is turned on
  config.consider_all_requests_local       = false
  config.action_controller.perform_caching = true

  # Disable Rails's static asset server (Apache or nginx will already do this)
  config.serve_static_assets = true

  # Compress JavaScripts and CSS
  config.assets.compress = true

  # Don't fallback to assets pipeline if a precompiled asset is missed
  config.assets.compile = true

  # Generate digests for assets URLs
  config.assets.digest = true

  # Defaults to nil and saved in location specified by config.assets.prefix
  # config.assets.manifest = YOUR_PATH

  # Specifies the header that your server uses for sending files
  # config.action_dispatch.x_sendfile_header = "X-Sendfile" # for apache
  # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx

  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.
  # config.force_ssl = true

  # See everything in the log (default is :info)
   config.log_level = :info

  # Prepend all log lines with the following tags
  # config.log_tags = [ :subdomain, :uuid ]

  # Use a different logger for distributed setups
  # config.logger = ActiveSupport::TaggedLogging.new(SyslogLogger.new)

  # Use a different cache store in production
  # config.cache_store = :mem_cache_store

  # Enable serving of images, stylesheets, and JavaScripts from an asset server
  # config.action_controller.asset_host = "http://assets.example.com"

  # Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)
  # config.assets.precompile += %w( search.js )

  # Disable delivery errors, bad email addresses will be ignored
  # config.action_mailer.raise_delivery_errors = false

  # Enable threaded mode
  # config.threadsafe!

  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to
  # the I18n.default_locale when a translation can not be found)
  config.i18n.fallbacks = true

  # Send deprecation notices to registered listeners
  config.active_support.deprecation = :notify

  # Log the query plan for queries taking more than this (works
  # with SQLite, MySQL, and PostgreSQL)
  # config.active_record.auto_explain_threshold_in_seconds = 0.5
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T22:16:23.290

默认情况下，Rails 将在 /public 中提供资产，如果这些资产存在，则不会实时编译。

要摆脱它，要么删除公共目录中的资产，要么将以下行添加到您的 config/environments/development.rb

```
config.serve_static_assets = false 
```

> config.serve_static_assets 将 Rails 本身配置为提供静态资产。默认为真

更多阅读：[这里](http://guides.rubyonrails.org/configuring.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T12:28:15.477

你运行的是什么版本的rails？这是从 2.x 或 3.0.x 升级到 3.1 或 3.2 的应用程序吗？这几乎听起来像这个应用程序是预资产管道。这是一个关于从预资产管道升级到资产管道的好教程......

[http://railscasts.com/episodes/282-upgrading-to-rails-3-1](http://railscasts.com/episodes/282-upgrading-to-rails-3-1)

...还有一个很好的资产管道基础教程...

[http://railscasts.com/episodes/279-understanding-the-asset-pipeline](http://railscasts.com/episodes/279-understanding-the-asset-pipeline)

# javascript - JQuery Mobile 与 Knockout 结合使用

> ID：12611159
> 
> 赞同：1
> 
> 时间：2012-09-26T22:03:41.967
> 
> 标签：javascript, html, jquery-mobile, knockout.js

我在将 JQuery Mobile 与 Knockout 结合使用时遇到了一些问题。实际上，这两个框架对我来说都是全新的，所以我有点迷失在实际出了什么问题。

由于这两个框架对我来说都是新的，我决定从 Knockout 网站中选择一个教程（待办事项列表）并将其与 JQuery Mobile 结合起来。到目前为止，我没有在原始教程代码中添加太多自定义代码，除了一些简单的 HTML。在 jsFiddle 上查看此示例：http: [//jsfiddle.net/nHhHV/2/](http://jsfiddle.net/nHhHV/2/)

如果您仔细观察，您可以清楚地看到 Knockout 将新项目添加到列表中。然而，一瞬间之后，JQuery Mobile 似乎完全重新呈现了那部分 HTML 并弄乱了表单。如果没有 JQuery Mobile，它可以正常工作。

有谁知道这个的解决方案？我希望表单与 Knockout 一起使用，但保持 JQM 外观。由于我对这两个框架都不熟悉，因此将不胜感激有关出了什么问题的详细信息！提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:43:34.873

问题是 jQuery mobile 认为您正在提交一个您需要阻止的表单。

我相信最好的解决方案就在这里：[jquery mobile and knockout form submit binding](https://stackoverflow.com/questions/10967034/jquery-mobile-and-knockout-form-submit-binding)

或者，您可以附加一个`click`处理程序和一个通用事件处理程序`keydown`来捕获返回键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T13:54:34.137

在回答您关于失去样式的评论时，我猜这是因为在内容更改后列表视图没有被刷新。你可以用 $(element).listview('refresh'); 或者，您可以再次添加自定义绑定....

```
ko.bindingHandlers.mobileList = {
'update': function (element, valueAccessor) {
    setTimeout(function () { //To make sure the refresh fires after the DOM is updated
        console.log("listview refresh");
        $(element).listview('refresh');
    }, 0);
}
}; 
```

并更改您的数据绑定

```
<ul data-bind="foreach: tasks, visible: tasks().length> 
```

至

```
<ul data-bind="mobileList: tasks, foreach: tasks, visible: tasks().length> 
```

# php - 如何扫描 MySQL 中的所有字段以获取表单输入

> ID：12611164
> 
> 赞同：0
> 
> 时间：2012-09-26T22:04:15.117
> 
> 标签：php

在我下面的脚本中，用户输入一个表单，如果行与用户输入的行相似，则从 MYSQL 表中返回行。我正在建立一个搜索引擎，一切都基于排名。但我希望能够调整下面的代码，以查看例如“iPad”一词出现了多少次行字段，即“标题”、“描述”、“关键字”和“链接”。如果是这样，我希望该行返回比具有更高 id 的行更高的返回值，但在所有合并的字段中只提到一次 iPad。我的代码如下： 条款一起查询： $query = " SELECT * FROM scan WHERE ";

```
$terms = array_map('mysql_real_escape_string', $terms);
$i = 0; 
foreach ($terms as $each) {
      if ($i++ !== 0){
            $query .= " AND "; 
      }
      $query .= "title LIKE '%{$each}%' OR link LIKE '%{$each}%' OR  keywords LIKE '%{$each}%' OR description LIKE '%{$each}%' ";

}

   $query = mysql_query($query) or die('MySQL Query Error: ' . mysql_error( $connect ));

echo '<p class="time">Qlick showed your results in ' . number_format($secs,2) . ' seconds.</p>';     

 $numrows = mysql_num_rows($query);
if ($numrows > 0) {

      while ($row = mysql_fetch_assoc($query)) {
            $id = $row['id'];
            $title = $row['title'];
            $description = $row['description'];
            $keywords = $row['keywords'];
            $link = $row['link'];
            $rank = $row['rank'];

   Seperate Terms Query

            $query = " SELECT * FROM scan WHERE "; 

    $terms = array_map('mysql_real_escape_string', $terms);
    $i = 0; 
    foreach ($terms as $each) {
          if ($i++ !== 0){
                $query .= " OR "; 
          }
          $query .= "title LIKE '%{$each}%' OR link LIKE '%{$each}%' OR  keywords LIKE '%{$each}%' OR description LIKE '%{$each}%' ";
      }

    // Don't append the ORDER BY until after the loop

          $query = mysql_query($query) or die('MySQL Query Error: ' . mysql_error( $connect ));
    $numrows = mysql_num_rows($query);
    if ($numrows > 0) {

          while ($row = mysql_fetch_assoc($query)) {
                $id = $row['id'];
                $title = $row['title'];
                $description = $row['description'];
                $keywords = $row['keywords'];
                $link = $row['link'];
                $rank = $row['rank']; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:32:32.250

我会尝试使用运行查询的辅助字段来执行此操作`FULLTEXT`，您将在其中保存所有文本数据：

```
http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html 
```

另一种方法是在 MySQL 中运行过滤并在 PHP 中运行排名。您可能会通过在连接字段上运行单个 LIKE 来压缩一些性能。

顺便说一句，您上面的代码在 LIKE 中缺少括号，因此结果将不正确：您不能问`WHERE field1 LIKE 'x' OR field2 LIKE 'x' AND field1 LIKE 'y' OR...`，必须声明`WHERE (field1 LIKE 'x' OR field2 LIKE 'x') AND (field1 LIKE 'y' OR...)`。

```
// Here we search for ALL terms (all must be present at least once)
// use ' OR ' to ask that at least one term must be present once.
$where = array();
foreach($terms as $term)
    $where[] = "( CONCAT(title,'|',link,'|',keywords) LIKE '%{$term}%')";
$query .= ' WHERE ' . '('.implode(' AND ', $where).')'; 
```

现在在 OR 情况下，您可以对匹配项的数量进行简单的排名（AND 数字始终是项的总数）：

```
$select_fields[] '(' . implode ('+', $where) . ') AS ranking'; 
```

否则，在 SQL 中，您将需要求助于一个*非常*丑陋的 hack：

```
(LENGTH(
    REPLACE(CONCAT(title,'|',link,'|',keywords),'{$term}','')
) - LENGTH(CONCAT(title,'|',link,'|',keywords)))/LENGTH('{$term}'); 
```

以上计算了要进行搜索的文本的总长度与相同文本的总长度之间的差异，其中*删除了搜索字符串*。差异当然与搜索字符串存在的次数成正比：如果字符串长度为 8 个字符，则差异 32 意味着它存在四次。将长度差除以词条的长度，我们得到命中数。

问题是对于几个术语，您必须使查询变得非常复杂，并且运行起来可能非常昂贵：

```
$select_fields = array('*');

$where = array();
$rank  = array();
foreach($terms as $term)
{
    // assume $term is NOT QUOTED
    $search  = mysql_real_escape_string($term);
    $concat  = "CONCAT(title,'|',link,'|',keywords)";

    $where[] = "(${concat} LIKE '%{$search}%')";
    $rank[]  = "(LENGTH(REPLACE(${concat},'{$search}',''))
           - LENGTH(${concat}))/LENGTH('{$search}')";
}
$select_fields[] = "(".implode(",", $rank).") AS ranking";

$query .= "SELECT " . implode(',', $select_fields)
       .  ' FROM scan WHERE (' . implode(' AND ', $where)   . ')'; 
```

# javascript - document.click 删除页面上的类行为不正确

> ID：12611165
> 
> 赞同：0
> 
> 时间：2012-09-26T22:04:18.620
> 
> 标签：javascript, jquery, html, css

我正在尝试创建一种全局样式的下拉菜单，当单击其菜单图标时，它会在打开和关闭之间切换，但在单击页面上的其他任何位置时也会关闭。我打开或关闭此下拉列表的方式是向下拉列表的父级添加或删除一个名为“open”的类。

这个想法（更清楚）是下拉菜单的普通类有 display: none; 设置它，但如果它是类“open”的东西的后代，那么它有 display: block;

所以，事不宜迟，这就是我目前所拥有的：“openable”是一类“父”元素，可以单击它来添加“open”类。

```
<script>
$(document).ready(function(){
    $('.openable').click(function(){
        if($(this).hasClass("open")){
            $(this).removeClass("open");
        }
        else{
            $(this).addClass("open");
        }
    });
}); 
```

就其本身而言，它实际上工作正常 - 它作为下拉菜单的一个足够体面的切换。当然，单击其他任何地方都不会关闭下拉菜单。

我显然不起作用的关闭脚本是：

```
<script>
$(document).ready(function(){
    $(document).click(function(event) {
        var clicked = $(event.target);
            if(clicked.hasClass(".open")){
        }
        else{
            if($(".open").length > 0){
                $(".open").each(function(){
                    $(this).removeClass("open");
                });
            }
        }
    });
});
</script> 
```

使用页面上的该脚本，下拉菜单完全停止工作，并且控制台不会抛出任何错误供我处理。

有更好的方法吗？

谢谢

编辑： html 标记类似于

```
<li class="navItem dropdown openable">
<span><img src="img/settings.png"></span>
  <ul class="subNav hubDrop">
    <li>Nav item 1</li>
    <li>Nav item 2</li>
    <li>Nav item 3</li>
    <li>Nav item 4</li>
</ul>
        </li> 
```

每一个人。li 标签在另一个 ul 中（请记住，这本质上是用于下拉菜单）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:26:03.247

**[jsBin 演示](http://jsbin.com/omutam/1/edit)**

只是玩了一下（不知道你的标记。）

```
<div>
<h2 class="openable">ICON 1</h2>
<div class="cont"></div>
</div> 
```

```
$('.openable').next('.cont').hide();
$('.openable').click(function(e) {
    e.stopPropagation();
    $('.opened').removeClass('opened');
    var d = $(this).next('.cont');
    var visib = (d.is(':visible')) ?
       /*yes*/   d.slideUp() :
       /*no */  ($('.cont').slideUp()) (d.slideDown().prev('.openable').addClass('opened')) ;
});

$(document).click(function(){
    $('.cont:visible').slideUp().prev('.openable').removeClass('opened');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:34:10.703

[***jsFiddle Demo***](http://jsfiddle.net/cxVty/) - 因为你没有提供任何 HTML 我模拟了一些元素......

**更新**：您没有指定是否可以一次“打开”多个元素；在您当前的解决方案中，它们可以，所以我保留了这种行为。但是，要将其限制为打开的，您可以`$('.open').not(this).removeClass('open');`在`.openable`点击处理程序中添加。

* * *

第一部分：为什么不直接使用[`.toggleClass`](http://api.jquery.com/toggleClass)

```
$(document).ready( function() {
    $('.openable').click( function() {
        $(this).toggleClass("open");
    });
}); 
```

第二部分：不需要第二个准备好的处理程序；首先，添加以下内容：

```
$(document).click( function(e) {
    var clicked = $(e.target).closest('.openable');
    if ( clicked.length == 0 ) {
        $(".open").removeClass('open');
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T22:32:06.970

让除了可打开的类元素之外的所有东西都执行你的点击方法怎么样？

```
var openable = $(".openable");
$("div, h2").not(openable).click(function(){
    $('.cont').slideUp().prev('.openable').removeClass('opened');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T22:20:14.117

我不相信您可以这样做`$(document).click()`，这并没有错，但是您永远不会单击文档本身，而是单击其子级。

我有一个非常相似的菜单系统，我以这种方式捕获一个事件：

```
 $('.navTab').mouseover(function (event) { navEvent($(this), event.type); }); 
```

然后删除所有“打开”并将“打开”重新应用于所选项目。

我相信您不想捕获所有文档点击事件。 [jQuery 事件.target](http://api.jquery.com/event.target/)

# jquery - pluploader 从本地文件获取完整路径？

> ID：12611166
> 
> 赞同：1
> 
> 时间：2012-09-26T22:04:20.757
> 
> 标签：jquery, file-upload, plupload

我正在使用pluploader，它工作正常。但我想在将图像保存到服务器之前使用 jcrop 裁剪图像。

所以，我需要知道文件的本地路径才能在浏览器上显示它。

有一种方法可以在我上传之前获取本地名称，例如 c:\images\photo10.jpg？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:32:46.867

出于安全原因，我认为不可能如此处所述：[http ://www.plupload.com/punbb/viewtopic.php?id=51](http://www.plupload.com/punbb/viewtopic.php?id=51)

但是，您可以在上传之前使用调整大小选项来调整图像大小。如果它不能解决您的问题，也许它可以帮助您找到方法。

# c# - 为什么 ConcurrentDictionary.GetOrAdd(key, valueFactory) 允许 valueFactory 被调用两次？

> ID：12611167
> 
> 赞同：31
> 
> 时间：2012-09-26T22:04:26.393
> 
> 标签：c#, multithreading, caching, concurrency, concurrentdictionary

我正在使用并发字典作为线程安全的静态缓存，并注意到以下行为：

来自[GetOrAdd 上的 MSDN 文档](https://docs.microsoft.com/en-us/dotnet/api/system.collections.concurrent.concurrentdictionary-2.getoradd)：

> 如果您在不同的线程上同时调用 GetOrAdd，则 addValueFactory 可能会被多次调用，但它的键/值对可能不会在每次调用时都添加到字典中。

**我希望能够保证工厂只被调用一次。有没有什么方法可以用 ConcurrentDictionary API 做到这一点，而无需借助我自己的单独同步（例如锁定在 valueFactory 内）？**

我的用例是 valueFactory 在动态模块中生成类型，因此如果同一键的两个 valueFactories 同时运行，我会点击：

`System.ArgumentException: Duplicate type name within an assembly.`

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-09-26T22:21:06.453

您可以使用这样键入的字典：`ConcurrentDictionary<TKey, Lazy<TValue>>`，然后您的值工厂将返回一个`Lazy<TValue>`已使用 初始化的对象，如果您未指定它`LazyThreadSafetyMode.ExecutionAndPublication`，这是使用的默认选项。`Lazy<TValue>`通过指定`LazyThreadSafetyMode.ExecutionAndPublication`你告诉 Lazy 只有一个线程可以初始化和设置对象的值。

这导致`ConcurrentDictionary`只使用一个对象实例`Lazy<TValue>`，并且该`Lazy<TValue>`对象保护多个线程免于初始化其值。

IE

```
var dict = new ConcurrentDictionary<int, Lazy<Foo>>();
dict.GetOrAdd(key,  
    (k) => new Lazy<Foo>(valueFactory)
); 
```

缺点是每次访问字典中的对象时都需要调用 *.Value 。以下是一些有助于解决此问题的[扩展。](https://msdn.microsoft.com/en-us/library/bb383977.aspx "扩展")

```
public static class ConcurrentDictionaryExtensions
{
    public static TValue GetOrAdd<TKey, TValue>(
        this ConcurrentDictionary<TKey, Lazy<TValue>> @this,
        TKey key, Func<TKey, TValue> valueFactory
    )
    {
        return @this.GetOrAdd(key,
            (k) => new Lazy<TValue>(() => valueFactory(k))
        ).Value;
    }

    public static TValue AddOrUpdate<TKey, TValue>(
        this ConcurrentDictionary<TKey, Lazy<TValue>> @this,
        TKey key, Func<TKey, TValue> addValueFactory,
        Func<TKey, TValue, TValue> updateValueFactory
    )
    {
        return @this.AddOrUpdate(key,
            (k) => new Lazy<TValue>(() => addValueFactory(k)),
            (k, currentValue) => new Lazy<TValue>(
                () => updateValueFactory(k, currentValue.Value)
            )
        ).Value;
    }

    public static bool TryGetValue<TKey, TValue>(
        this ConcurrentDictionary<TKey, Lazy<TValue>> @this,
        TKey key, out TValue value
    )
    {
        value = default(TValue);

        var result = @this.TryGetValue(key, out Lazy<TValue> v);

        if (result) value = v.Value;

        return result;
   }

   // this overload may not make sense to use when you want to avoid
   //  the construction of the value when it isn't needed
   public static bool TryAdd<TKey, TValue>(
       this ConcurrentDictionary<TKey, Lazy<TValue>> @this,
       TKey key, TValue value
   )
   {
       return @this.TryAdd(key, new Lazy<TValue>(() => value));
   }

   public static bool TryAdd<TKey, TValue>(
       this ConcurrentDictionary<TKey, Lazy<TValue>> @this,
       TKey key, Func<TKey, TValue> valueFactory
   )
   {
       return @this.TryAdd(key,
           new Lazy<TValue>(() => valueFactory(key))
       );
   }

   public static bool TryRemove<TKey, TValue>(
       this ConcurrentDictionary<TKey, Lazy<TValue>> @this,
       TKey key, out TValue value
   )
   {
       value = default(TValue);

       if (@this.TryRemove(key, out Lazy<TValue> v))
       {
           value = v.Value;
           return true;
       }
       return false;
   }

   public static bool TryUpdate<TKey, TValue>(
       this ConcurrentDictionary<TKey, Lazy<TValue>> @this,
       TKey key, Func<TKey, TValue, TValue> updateValueFactory
   )
   {
       if (!@this.TryGetValue(key, out Lazy<TValue> existingValue))
           return false;

       return @this.TryUpdate(key,
           new Lazy<TValue>(
               () => updateValueFactory(key, existingValue.Value)
           ),
           existingValue
       );
   }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-26T22:16:43.643

[这在非阻塞算法](http://en.wikipedia.org/wiki/Non-blocking_algorithm)中并不少见。他们基本上测试了一个条件，确认没有使用`Interlock.CompareExchange`. 他们循环直到CAS成功。看看第 (4) 页作为[非阻塞算法](http://en.wikipedia.org/wiki/Non-blocking_algorithm)[`ConcurrentQueue`](http://www.research.ibm.com/people/m/michael/podc-1996.pdf)的一个很好的介绍

简短的回答是否定的，这是野兽的本性，它需要多次尝试才能添加到争用的集合中。除了使用传递值的其他重载之外，您还需要防止值工厂内的多次调用，可能使用[双锁/内存屏障](http://msdn.microsoft.com/en-us/library/ff650316.aspx)。

# android - 接收电子邮件 java

> ID：12611169
> 
> 赞同：-1
> 
> 时间：2012-09-26T22:04:31.367
> 
> 标签：android

我正在使用 ics 附带的默认电子邮件应用程序，并且我想以编程方式捕获电子邮件接收（我想接收和发件人信息以及电子邮件正文本身），我该怎么做？我尝试搜索但是我只找到如何发送电子邮件以及如何在 gmail 中接收电子邮件（这不是我的情况）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:50:52.277

不幸的是，没有办法在电子邮件到达电话时“捕捉”它们。您必须手动连接到邮件服务器并下载电子邮件。如果您对此感兴趣，我使用了[javamail-android 端口](http://code.google.com/p/javamail-android/)，它实际上功能非常齐全。

# html - 移动 html 快捷方式

> ID：12611173
> 
> 赞同：0
> 
> 时间：2012-09-26T22:04:59.777
> 
> 标签：html, mobile, mobile-browser

我想知道在不同设备上带来不同功能的快捷方式（href 代码）是什么。

例如

```
 mailto: (opens the mail clients on a desktop/mobile)
 tel: brings up the "call" option on a phone 
```

其他是什么？是否有“短信：”等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:13:36.623

我确信这些链接取决于运行它们的系统，因此并非所有链接都将在所有设备上实现。

但是，我找到了一些至少对您会发现有用的黑莓设备的链接。

这是一个相当完整的列表： [http ://beradrian.wordpress.com/2010/01/15/special-links/](http://beradrian.wordpress.com/2010/01/15/special-links/)

和 [http://docs.blackberry.com/en/developers/deliverables/11844/Feature_link_behaviour_438487_11.jsp](http://docs.blackberry.com/en/developers/deliverables/11844/Feature_link_behaviour_438487_11.jsp)

这将 WTAI、tel、dc、cti、mailto、pin 显示为链接类型。

我知道也有“地理”作为一个。我相当肯定应用程序可以用来处理不同类型的链接，所以这个列表现在已经完成了。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:06:56.590

如果您谈论的是 Android，我认为没有完整的列表，因为每个应用程序都可以添加自己的应用程序。不过，有些肯定比其他更受欢迎。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-29T10:33:10.060

手机独有的技巧很少。实际上，我昨天刚刚发表了一篇关于同一主题的文章，您可以在其中找到协议列表，您可以专门用于移动设备的标签。

请检查[http://www.ikozmik.com/html-css-javascript-tricks-for-mobile-websites](http://www.ikozmik.com/html-css-javascript-tricks-for-mobile-websites)

# boolean - 有多少个不同的 n 变量布尔函数？

> ID：12611175
> 
> 赞同：0
> 
> 时间：2012-09-26T22:05:23.377
> 
> 标签：boolean, boolean-logic

由于有 n 个变量，不会有 2^n 个布尔函数吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T22:15:43.637

对于 n 元布尔函数，有 2^n 个可能的布尔输入。每个输入都可以生成“真”或“假”作为输出。您可以安排多少种不同的方式来安排 2^n 真与假输出？

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-26T22:26:19.137

如果选择 1 有 p 个可能性，选择 2 有 q 个可能性，那么总共有 p*q 种不同的方式来做这两种事情。

可以将其扩展到 n 个选择是微不足道的。

[http://en.wikipedia.org/wiki/Rule_of_product](http://en.wikipedia.org/wiki/Rule_of_product)

所以，是的，会有 2^n 个布尔函数（每个选择都有两个选择）。

# c++ - c++ 可执行文件中存储了多少源信息

> ID：12611179
> 
> 赞同：3
> 
> 时间：2012-09-26T22:05:38.247
> 
> 标签：c++, c, exe

几天前，我不小心在 Notepad++ 中打开了一个商业应用程序的 C++ 可执行文件，发现可执行文件中存储了很多关于原始源代码的信息。

在可执行文件中，我可以找到文件名（app.c、dlgstat.c、...）、函数名（`GetTickCount`、、`DispatchMessageA`...）和一小段源代码，主要是条件（`szChar != TEXT('\0')`、`iRow < XTGetRows( hwndList )`）。之后，我检查了另一个 QT 可执行文件，并且：再次是源文件名和方法签名。

因此，我想知道有多少源代码信息真正存储在 C/C++ 可执行文件中（例如，使用 QT 或 MinGW 编译）。这可能是某种仍然包含原始源的调试版本吗？这些信息是否用于一些反射的东西？出版商有什么理由不删除这些东西吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-26T22:10:27.167

> 有多少源代码信息真正存储在 C/C++ 可执行文件中？

在实践中，并不多。运行时不需要源代码。您命名的字符串来自两件事：

*   函数名（例如`GetTickCount`）是从其他模块导入的函数名。这些名称在运行时是必需的，因为函数是动态解析的（通过`GetProcAddress`使用函数名称调用）。

*   条件很可能是断言：`assert`宏将其参数字符串化，以便在触发时您知道未满足什么条件。

如果您构建一个 DLL，它还将包含它导出的所有函数的名称，因此可以在运行时解析它们（对于其他共享对象格式可能也是如此）。

调试符号也可能包含一些原始源代码，尽管它取决于调试符号使用的格式。这些符号可能包含在二进制文件本身或辅助文件中（例如，Windows 上使用的 .pdb 文件）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T22:12:39.263

Windows 函数名称：它们可能只是因为它们被动态访问而存在 - 在您的程序中的某个地方有一个`GetProcAddress`可以获取它们的地址。尽管如此，没有理由担心，每个应用程序都使用 WinAPI，因此从这些信息中没有太多关于您的可执行文件的信息。

条件：可能来自一些`assert`类似的宏；包含它们以允许`assert`打印触发失败断言的失败条件。无论如何，在发布模式下，断言应该被自动删除。

源文件名和方法签名：可能来自`__FILE__`和`__func__`宏的一些用法；可能，再次，从`assert`。

有关程序内部结构的其他信息来源是 RTTI，它必须为`typeid`可能正在处理的每种类型提供一些表示。如果您不需要它的功能，您可以禁用它（但我不知道这在 Qt 项目中是否可行）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T22:13:55.507

混合到 C++ 应用程序的二进制文件中，您会发现大多数全局符号的名称（以及调试符号，如果在编译器中启用），但如果它是函数或方法，则带有额外的“装饰文本”，用于编码符号的调用签名. 同样，字符串的文字嵌入在明文中。但是，您在哪里找不到类似编译器用来创建二进制可执行文件的实际源代码的东西。该信息在编译过程中会丢失，如果在构建中使用 C++ 模板，则特别难以进行逆向工程。

# asp.net-mvc-4 - MVC 4 中客户 URL 的自定义 OpenIdClient

> ID：12611180
> 
> 赞同：4
> 
> 时间：2012-09-26T22:05:51.477
> 
> 标签：asp.net-mvc-4, dotnetopenauth

我正在使用 MVC 4 的默认模板，并尝试将我自己的 openID 提供程序（例如[http://steamcommunity.com/dev](http://steamcommunity.com/dev) ）添加到 openID 登录列表和一个 openID 框，用户可以在其中输入他们的 openID 信息。

添加谷歌我只是取消评论

```
OAuthWebSecurity.RegisterGoogleClient(); 
```

至于其他自定义解决方案，您可以执行类似的操作

OAuthWebSecurity.RegisterClient(new SteamClient(),"Steam",null);

我遇到的麻烦是创建 SteamClient （或通用的）[http://blogs.msdn.com/b/webdev/archive/2012/08/23/plugging-custom-oauth-openid-providers.aspx](http://blogs.msdn.com/b/webdev/archive/2012/08/23/plugging-custom-oauth-openid-providers.aspx)没有显示在任何地方更改 URL。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-27T21:24:39.470

我想我找不到答案的原因是大多数人认为这是常识。我更喜欢我的感觉不寻常。

```
public class OidCustomClient : OpenIdClient
{
  public OidCustomClient() : base("Oid", "http://localhost:5004/") { }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-29T18:10:55.430

根据@Jeff 的回答，我创建了一个类来处理 Stack Exchange OpenID。

登记：

```
OAuthWebSecurity.RegisterClient(new StackExchangeOpenID()); 
```

班级：

```
public class StackExchangeOpenID : OpenIdClient
{
    public StackExchangeOpenID()
        : base("stackexchange", "https://openid.stackexchange.com")
    {

    }

    protected override Dictionary<string, string> GetExtraData(IAuthenticationResponse response)
    {
        FetchResponse fetchResponse = response.GetExtension<FetchResponse>();

        if (fetchResponse != null)
        {
            var extraData = new Dictionary<string, string>();
            extraData.Add("email", fetchResponse.GetAttributeValue(WellKnownAttributes.Contact.Email));
            extraData.Add("name", fetchResponse.GetAttributeValue(WellKnownAttributes.Name.FullName));
            return extraData;
        }

        return null;
    }
    protected override void OnBeforeSendingAuthenticationRequest(IAuthenticationRequest request)
    {
        var fetchRequest = new FetchRequest();
        fetchRequest.Attributes.AddRequired(WellKnownAttributes.Contact.Email);
        fetchRequest.Attributes.AddRequired(WellKnownAttributes.Name.FullName);
        request.AddExtension(fetchRequest);
    }
} 
```

检索额外数据：

```
var result = OAuthWebSecurity.VerifyAuthentication();
result.ExtraData["email"];
result.ExtraData["name"]; 
```

# ios - DokuWiki 中带有 markdownextra 插件的内部链接以匹配 Trunbk Notes 语法

> ID：12611182
> 
> 赞同：1
> 
> 时间：2012-09-26T22:06:24.233
> 
> 标签：ios, wiki, markdown, dokuwiki

我想将 DokuWiki 用作使用 iOS 应用程序 [Trunk Notes](http://appsonthemove.com/trunk.htm)生成的 wiki 文件的桌面前端。我已经安装了[markdownextra 插件](http://madpropellerhead.com/projects/php-markdown-extra-plugin-for-dokuwiki)，希望能让 DokuWiki 与 Trunk Notes 兼容。

**我现在的问题是在Trunk Notes**语法中输入的内部链接为

```
[[AnotherPage]] 
```

不要在**DokuWiki**中工作。因为链接应该在 Trunk Notes 中保持工作状态，所以我无法将链接样式更改为例如`[AnotherPage(?id=AnotherPage.md)`DokuWiki 插件用户指南中建议的（向下滚动到插件页面的末尾）。

知道如何解决这个问题吗？有没有人设法让**DokuWiki使用****Trunk Notes**生成的文件，包括内部链接？

# asp.net - 包含用户名和密码的 WebService 调用是否比登录站点更不安全？

> ID：12611183
> 
> 赞同：1
> 
> 时间：2012-09-26T22:06:28.683
> 
> 标签：asp.net, security

不久前，我们为没有站点证书/SSL 的客户创建了一个站点。它只有一个基本的 asp_net 登录系统。

您不能从该网站购买任何东西，并且它不保存个人详细信息 - 它只是显示股票并为用户提供一个电话号码，他们可以打电话购买股票。

我们的一个用户有自己的系统，并希望通过 WebService 获取一些信息——我们打算只放置一个带有 WebMethod 的 WebService，该 WebMethod 接受用户名、密码和 ID，然后将一些信息传递回他们的系统。

一位开发人员表示，这会使系统的安全性大大降低，因为使用用户名和密码进行 WebMethod 调用的安全性远低于网站上的登录系统。

这个 WebMethod 调用真的比网站上的登录系统安全吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:39:17.820

这一切都取决于您计划如何接受该密码数据。您应该确保强制他们不要通过网络发送密码明文。您可以通过以下类型的模式来做到这一点：

1.  客户端请求进行身份验证
2.  服务器用临时公钥回复。生成一个临时私钥并存储在服务器上，该私钥可能会在短时间内过期（如果未使用）。
3.  客户端使用公钥加密密码
4.  客户端通过网络发送加密密码和其他数据

一般来说，无论是什么密码，您都不应该通过网络发送纯文本密码。二进制、soap、web 服务、http 等等。如果它发送，有人可以嗅探它。只需要一次良好的wireshark 捕获，您的所有数据都会受到损害。

如果已经在进行有线加密，那么我看不出它的安全性如何。如果您也添加某种握手功能会更好，以便您知道谁是谁，或者如果 IP 源无法发送正确的令牌，您可以确保对请求进行速率限制。这就像如果某人没有在适当的尝试次数内登录，就将他们锁定在您的 UI 之外。

添加 SSL 也是一个好主意，因为它可以防止中间人攻击。

我不是安全专家，但我所知道的是安全是关于层的。加密流量，从不发送明文，关闭端口，管理权限，哈希密码，握手，限制身份验证尝试，大量日志等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T02:00:41.713

您可以对 WebService 文件使用混合模式身份验证。

请按照以下步骤操作：

*   右键单击 web 服务文件
*   转到身份验证
*   删除匿名并单击基本 windows 身份验证
*   将文件名添加到 web.config 以使其可公开访问

`<location path="webserice.svc"> <system.web> <authorization> <allow users="*"/> </authorization> </system.web> </location>`

*   使用管理工具在网络服务器中创建用户
*   调用 Web 服务并使用您创建的用户的凭据

`localhost.MyWebService myService = new localhost.MyWebService();
System.Net.CredentialCache myCredentials = new System.Net.CredentialCache(); NetworkCredential netCred = new NetworkCredential("UserName", "Password"); myCredentials.Add(new Uri(myService.Url), "Basic", netCred); myService.Credentials = myCredentials;`

如果您在调用 Web 服务时可以使用 SSL，那就太好了

# backbone.js - Trigger.io 和 Backbone-Boilerplate 相对路径

> ID：12611189
> 
> 赞同：1
> 
> 时间：2012-09-26T22:07:08.667
> 
> 标签：backbone.js, trigger.io, backbone-views, backbone-routing

我已经阅读并看到了 Trigger.io + Backbone.js 的实现——我的问题是关于专门使用骨干样板框架。

我将[Backbone-Boilerplate](https://github.com/tbranyen/backbone-boilerplate)与同一作者的 Backbone-LayoutManager 一起用于我的项目。当我使用触发器进行构建时，我的视图根本没有加载。在做了（很多）谷歌搜索之后，我认为它与应用程序的根路径有关，该根路径用于构建通过 AJAX 获取的文件的完整路径。（见[https://github.com/tbranyen/backbone-boilerplate/wiki/Relative-path-setup-notes](https://github.com/tbranyen/backbone-boilerplate/wiki/Relative-path-setup-notes)）

我按照上面链接中的说明查看是否可以让我的应用程序运行，`http://localhost/myapp/`而不是`http://mypp.local`肯定它工作正常。但是，我无法手动设置这些路由以在设备上运行，因为我不确定所有设备上的每个构建将是什么。

关于如何让 Backbone-Boilerplate 模板加载和 Trigger.io 一起玩得很好的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:50:44.423

如果每个设备的路径不同，那么探索变量的选项可能是有意义的`app.root`。这可以通过类似的东西来实现`location.pathname`。我对 trigger.io 一点也不熟悉，但会像这样工作：

`app.root = location.pathname;`

这会将根设置为：`/e034fde/random/path/`动态。

# .net - 是否可以使用 .NET 反射向类添加函数？

> ID：12611190
> 
> 赞同：0
> 
> 时间：2012-09-26T22:07:07.793
> 
> 标签：.net, reflection

是否可以使用 .NET 中的反射向类添加函数？

例如，我是否可以编写代码，将函数添加到添加两个 Int32 并返回结果的类中？

这是假设没有任何这样的函数已经编译到系统中，所以我想到的基本上是将字符串转换为函数，类似于 JavaScript 对“eval”所做的事情（是的，我知道那`eval`是*邪恶*的）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T00:13:10.773

您应该能够使用以下几种方法在运行时创建程序集：

*   使用[Roslyn](http://msdn.microsoft.com/en-gb/roslyn)（目前在 CTP 中），您应该能够将任意一段 .NET 代码编译成程序集，并且它可以轻松工作。这是目前进行运行时代码生成最轻松的方式。

*   您可以通过 ILWeaving 以硬（更）的方式做到这一点。这基本上是在运行时发出 IL 代码，您不仅可以生成新的类/函数等。但您可以修改现有的。一些已经通过[ILWeaving](http://www.infoq.com/news/2012/02/IL-Weaving)实现的 INotifyPropertyChanged 接口。你仍然需要对[IL](http://en.wikipedia.org/wiki/Common_Intermediate_Language)有很好的理解才能做到这一点。

*   使用某种[Aspect 框架](http://www.sharpcrafters.com/)。这些框架为您完成了繁重的工作，因此您无需编写 IL 代码。通常在编译时会为您生成必要的代码。

*   使用[动态代理](http://www.castleproject.org/projects/dynamicproxy/)，您还可以对现有代码的操作进行一些控制，例如，如果您有兴趣在类的现有方法/函数之前/之后做某事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:23:21.497

您还必须发出该类，所以不，您不能添加，这也很痛苦。

看看使用[.NET](http://en.wikipedia.org/wiki/.NET_Framework)动态语言[Python](http://en.wikipedia.org/wiki/Python_%28programming_language%29)、[Ruby](http://en.wikipedia.org/wiki/Ruby_%28programming_language%29)甚至 java（以及 ECMA）脚本都可用。

根据您对 Mitch 的回答的评论，您可能想要查看的另一件事是[AppDomain.AssemblyResolve](http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyresolve.aspx)事件。您可以做一些有趣的事情，例如将程序集保存在数据库 blob 中。

不过，您需要提前对该路线进行一些认真的计划。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T22:10:42.007

不，不是。您只能从类中的函数中读取，不能添加。无论如何，你为什么需要？只需在当前程序中编写要添加到其中的代码即可。

# sql-server - 使用索引视图会提高 SELECT COUNT 查询的性能吗？

> ID：12611194
> 
> 赞同：1
> 
> 时间：2012-09-26T22:07:19.997
> 
> 标签：sql-server, performance, sql-server-2008, indexed-view

我有一张桌子，几年后它会增长到几百万行。作为我的 Web 应用程序的一部分，每当用户访问特定页面时，我都必须查询该表子集的计数。戴架构师帽子的人说他们对此有性能问题。假设它们是正确的，添加索引视图会解决这个问题吗？

我想要快速的 Sql：

```
SELECT COUNT(*) FROM [dbo].[Txxx] WHERE SomeName = 'ZZZZ' 
```

或者

```
SELECT COUNT_BIG(*) FROM [dbo].[Txxx] WHERE SomeName = 'ZZZZ' 
```

桌子：

```
CREATE TABLE [dbo].[Txxx](
    [Id] [uniqueidentifier] ROWGUIDCOL  NOT NULL,
    [SomeName] [nvarchar](50) NOT NULL,
    [SomeGuid] [uniqueidentifier] NOT NULL
 CONSTRAINT [PK_Txxx] PRIMARY KEY CLUSTERED 
(
    [Id] ASC
) 
```

看法：

```
CREATE view dbo.Vxxx
WITH SCHEMABINDING
AS
SELECT     SomeName, COUNT_BIG(*) AS UsedCount
FROM         dbo.Txxx
GROUP BY SomeName 
```

指数：

```
CREATE UNIQUE CLUSTERED INDEX [IV_COUNT] ON [dbo].[Vxxx] 
(
    [SomeName] ASC
) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T22:12:57.097

可以，但只有企业版会在查询编译期间考虑索引视图。要利用非 EE 上的索引，您需要直接从视图中选择并使用[NOEXPAND 提示](http://msdn.microsoft.com/en-us/library/ms187373.aspx)：

> NOEXPAND 仅适用于索引视图。索引视图是在其上创建了唯一聚集索引的视图。如果查询包含对索引视图和基表中都存在的列的引用，并且查询优化器确定使用索引视图提供了执行查询的最佳方法，则查询优化器将使用视图上的索引。此功能称为索引视图匹配。**只有特定版本的 SQL Server 才支持查询优化器自动使用索引视图**。

请注意，像这样的索引视图会产生写争用，因为任何更新都会锁定整个`SomeName`范围：一次只有一个事务能够插入、删除或更新任何带有`SomeName = 'ZZZZ'`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:10:52.227

是的，索引视图肯定会提高特定查询的性能（假设企业版 - Remus 解释了如果您不在企业版上如何使用它）。

但是，它不是“免费的”——索引将需要为所有 DML 操作维护`dbo.Txxx`，将占用空间（虽然比基表小得多，相比之下），并且会受到也会影响普通表的问题的影响- 例如碎片和（在这种情况下可能在较小程度上）页面拆分。

# google-cloud-storage - 使用 gsutil 删除文件扩展名

> ID：12611199
> 
> 赞同：2
> 
> 时间：2012-09-26T22:07:55.763
> 
> 标签：google-cloud-storage

使用 gsutil 复制文件时有什么方法可以删除文件扩展名？

```
From local 0001:
 0001/a/1.jpg
 0001/b/2.png

To bucket 0002:
 gs://0002/a/1
 gs://0002/b/2 
```

（我可以在本地删除扩展，但复制到 GS 时会丢失 Content-Type）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T22:57:56.440

gsutil 没有以这种方式重写文件名的任何机制。您可以编写一个 shell 循环来遍历文件并删除正在复制的文件名中的扩展名。

为了保留 Content-Type 这里有几个建议：

1.  在命令行上显式设置它，例如，

    gsutil -h Content-Type:image/jpeg cp 0001/a/1.jpg gs://0001/a/1

2.  使用 use_magicfile 配置（在 .boto 配置文件中），以使“文件”命令检测到 Content-Type。这仅适用于您在 Unix 或 MacOS 上运行。在这种情况下，您仍将使用 shell 脚本来删除文件扩展名，但您不必指定 -h Content-Type 参数：

    gsutil cp 0001/a/1.jpg gs://0001/a/1

麦克风

# c# - 处理错误“WebDev.WebServer.Exe 已停止工作”

> ID：12611201
> 
> 赞同：10
> 
> 时间：2012-09-26T22:07:58.490
> 
> 标签：c#, asp.net, error-handling

有没有办法在 ASP.NET 中处理错误“WebDev.WebServer.Exe 已停止工作”并保持页面运行甚至只是 WebServer 运行？或者这是一项不可能完成的任务，本质上就像在询问如何在某人死后挽救他们的生命？

我在 try/catch 块中有导致错误的代码，但这并没有什么不同。我也尝试注册一个新的 UnhandledExceptionEventHandler，但这也不起作用。我的代码如下，以防我做错了什么。

另外要明确的是，我并不是在寻求有关如何防止错误的帮助；我想知道是否以及何时发生错误，如果我能做些什么来处理它。

更新 1：TestOcx 是一个 VB6 OCX，它将字符串的引用传递给用[Clarion](http://en.wikipedia.org/wiki/Clarion_(programming_language))编写的 DLL 。

更新 2：根据@JDennis 的回答，我应该澄清该`catch(Exception ex)`块也没有被输入。如果我从`try\catch`块中删除了对 OCX 的调用，它仍然无法到达该`UnhandledException`方法。基本上有两个领域永远不会被执行。

更新 3：来自@AndrewLewis，我还尝试添加一个常规`catch`块来捕获任何不符合 CLS 的异常，但这也不起作用。但是，我后来发现，从 .NET 2.0 开始，所有非 CLS 异常都包含在`RuntimeWrappedException`其中，因此 a`catch (Exception)`也会捕获不符合 CLS 的异常。[在此处](https://stackoverflow.com/questions/1531077/will-clr-handle-both-cls-complaint-and-non-cls-complaint-exceptions)查看其他问题以获取更多信息。

```
public bool TestMethod()
{
    AppDomain.CurrentDomain.UnhandledException +=
        new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException);

    string input = "test";
    string result = "";
    try
    {
        TestOcx myCom = new TestOcx();
        result = myCom.PassString(ref input); // <== MAJOR ERROR!
        // do stuff with result...
        return true;
    }
    catch (Exception ex)
    {
        log.Add("Exception: " + ex.Message); // THIS NEVER GETS CALLED
        return false;
    }
}

private static void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
{
    // THIS NEVER GETS CALLED
    try
    {
        Exception ex = (Exception)e.ExceptionObject;
        log.Add("Exception: " + ex.Message);
    }
    catch (Exception exc)
    {
        log.Add("Fatal Non-UI Error: " + exc.Message);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-28T20:18:36.063

您应该尝试捕获不符合 CLS 的异常，以确保没有抛出任何异常（请记住，您不想在生产中执行此操作，请始终保持具体！）：

```
try
{
    TestOcx myCom = new TestOcx();
    result = myCom.PassString(ref input); // <== MAJOR ERROR!
    // do stuff with result...
    return true;
}

catch (Exception ex)
{
    log.Add("Exception: " + ex.Message); // THIS NEVER GETS CALLED
    return false;
}
catch
{
   //do something here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-28T18:31:51.063

> 您的代码显示为**//THIS NEVER GETS CALLED**。

如果您捕获到异常，则不再对其进行处理。这就是为什么它不会触发 unhandledexception 事件。

# space-partitioning - 我在二维空间中有 x 个点。如何将它们分成最大的集群，每个集群的最大半径 r 并且没有重叠？

> ID：12611204
> 
> 赞同：1
> 
> 时间：2012-09-26T22:08:23.080
> 
> 标签：space-partitioning

[![簇](../Images/0cbd026fc3dbd1d0d5bb9041681e1c1b.png)](https://i.stack.imgur.com/BAg4w.jpg)
[（来源：[hiveworkshop.com](http://www.hiveworkshop.com/forums/attachments/world-editor-help-zone-98/118089d1348693275-how-group-clusters-into-subclusters-cluster.jpg)）]

在上图中，我将 20 个任意点分成 5 个簇。右边是一个定义最大集群大小的圆圈。右上角是每个集群的最大点数。我希望能够获取任意一组点 k 并将它们分成最大大小为 n 且最大半径为 r 的集群。我需要该算法来检索尽可能多*的*集群（在上面的示例中，尽可能多的 4 个集群）。任何给定点只能属于 1 个集群，并且集群不能重叠。

如果该算法可以向现有集合添加/删除点并更新集群，这也会很有帮助。

我完全不知道如何做到这一点。到目前为止，我最好的想法是计算点集的中心，然后使用这些中心进行二进制空间分区，但我希望使用这种方法的最好结果是均匀分布的集群。

任何帮助，将不胜感激 ：）。

**编辑**
不要重叠，因为区域形成的形状不与其他区域形成的形状相交，并且区域不位于其他区域的内部（例如圆圈中的圆圈）。在上图中，每个区域都有一个形状。这些形状都没有相交，并且没有区域位于另一个区域内。

# hibernate - 从 JPA1.0 迁移到 JPA2.0 时，什么会导致此 JPA 日历查询中断？

> ID：12611207
> 
> 赞同：1
> 
> 时间：2012-09-26T22:09:02.517
> 
> 标签：hibernate, jpa

我刚刚将一个应用程序从 JPA1.0/Hibernate 3.3.2.GA 迁移到 JPA2.0/Hibernate 3.6.10.FINAL 并且我现有的一个 JPA 查询不再有效。

该查询对持久字段的值使用约束，如下所示：

```
private java.sql.Timestamp birthday; 
```

查询如下所示：

```
String qlString = "SELECT u FROM User u WHERE u.birthday BETWEEN :minDate AND :maxDate";
Query query = eMgrTwo.createQuery(qlString);

Calendar minDateCalendar = Calendar.getInstance();
minDateCalendar.set(1970, 4, 29);

Calendar maxDateCalendar = Calendar.getInstance();
maxDateCalendar.set(1970, 6, 29);

query.setParameter("minDate", minDateCalendar, TemporalType.TIMESTAMP);
query.setParameter("maxDate", maxDateCalendar, TemporalType.TIMESTAMP);

List results = query.getResultList(); 
```

与旧版本的 jpa 和 hibernate 相比，这有效。反对，较新的版本，我收到一个错误，抱怨

```
Exception in thread "main" java.lang.IllegalArgumentException: Parameter value [java.util.GregorianCalendar SNIP SNIP] did not match expected type [java.util.Date] 
```

如果我将代码更改为使用日期而不是日历，它就可以工作。我只想知道为什么以前的代码有效？API有变化吗？还是我们之前使用了未记录的功能？

# objective-c - IOS 6 地图崩溃

> ID：12611210
> 
> 赞同：5
> 
> 时间：2012-09-26T22:09:46.023
> 
> 标签：objective-c, ios, ios6-maps

我在 IOS 6 上不断出现这种崩溃，但我不确定是什么问题。有谁知道这意味着什么？

```
Exception Type:  EXC_BAD_ACCESS (SIGBUS)
Exception Codes: EXC_ARM_DA_ALIGN at 0x00000001
Crashed Thread:  0

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   CoreFoundation                  0x3bcab0d8 CFRetain + 20
1   CoreFoundation                  0x3bd424ee __CFSetStandardRetainKey + 50
2   VectorKit                       0x3840e97c -[VKAnimation _stopAnimation:] + 36
3   VectorKit                       0x383d841c -[VKAnimation onTimerFired:] + 48
4   VectorKit                       0x383d8240 -[VKMainLoop displayTimerFired:] + 352
5   QuartzCore                      0x3664377c             CA::Display::DisplayLink::dispatch(unsigned long long, unsigned long long) + 156
6   QuartzCore                      0x366436d4 CA::Display::IOMFBDisplayLink::callback(__IOMobileFramebuffer*, unsigned long long, unsigned long long, unsigned long long, void*) + 60
7   IOMobileFramebuffer             0x3c497fd4 IOMobileFramebufferVsyncNotifyFunc + 152
8   IOKit                           0x35a965aa IODispatchCalloutFromCFMessage + 190
9   CoreFoundation                  0x3bd35888 __CFMachPortPerform + 116
10  CoreFoundation                  0x3bd403e4 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 32
11  CoreFoundation                  0x3bd40386 __CFRunLoopDoSource1 + 134
12  CoreFoundation                  0x3bd3f20a __CFRunLoopRun + 1378
13  CoreFoundation                  0x3bcb2238 CFRunLoopRunSpecific + 352
14  CoreFoundation                  0x3bcb20c4 CFRunLoopRunInMode + 100
15  GraphicsServices                0x33eae336 GSEventRunModal + 70
16  UIKit                           0x3be33284 UIApplicationMain + 1116
17  App Name                        0x000dcb88 main (main.m:14)
18  App Name                        0x000dcb54 start + 36 
```

该应用程序使用 IOS 6 中的 MKMapkit。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T08:59:00.480

这是一个内部错误。[将此报告给 Apple](http://bugreporter.apple.com/)。

如果模拟器中发生这种情况，您可以使用模拟器的“重置内容”（在应用程序/iOS 模拟器菜单中）清除缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T23:00:07.827

看起来这个问题是由在 VectorKit 的 stopAnimation: 方法被调用之后或之后访问释放的对象引起的。我不熟悉 VectorKit，因此您可能会查看该方法或看起来是 onTimerFired: 委托回调的方法。

祝你好运。

蒂姆

# drupal - Drupal 6 中的自定义 Web 表单页面布局

> ID：12611212
> 
> 赞同：0
> 
> 时间：2012-09-26T22:09:58.523
> 
> 标签：drupal, drupal-theming, drupal-webform, drupal-zen

我最近使用 Zen 主题使用 Drupal 6（客户端要求使用旧版本）构建了一个 Intranet 站点。该网站包含几个（20 多个）使用 Webform 制作的调查页面。

客户希望将 Web 表单页面的布局更改为具有全宽内容区域且没有侧边栏。我发现我可以制作一个名为“page-node-53.tpl.php”的自定义模板页面，并且仅适用于 node/53。如果我只有一个 Webform 页面，这会很好。

是否可以制作自定义布局页面并以某种方式将其仅分配给 webform 节点？这可以在 Wordpress 中轻松完成......只是想知道在 Drupal 中是否有一种简单的方法可以做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T16:04:44.007

我想到了...

首先，我将自定义模板文件的名称更改为“page-webform.tpl.php”。

接下来，我将以下代码添加到 page.tpl.php 顶部的 DOCTYPE 声明之前：

```
<?php if ($node->type == 'webform') {include 'page-webform.tpl.php';  return;  } ?> 
```

它似乎奏效了！除了具有 Webform 的页面之外，每个页面都没有变化。

# java - 仅当依赖项组装到一个 jar 中时才会抛出 Jersey 异常

> ID：12611213
> 
> 赞同：27
> 
> 时间：2012-09-26T22:10:00.677
> 
> 标签：java, maven, jar, jersey, executable-jar

我正在编写一个嵌入 Jetty w/ Jersey 的服务器。当我从 Eclipse 执行时，一切都很好。但是，如果我使用 Maven 的 assembly:single 目标将我的服务器和所有依赖项组装到一个 jar 中，则会出现异常：

```
Sep 26, 2012 5:35:59 PM com.sun.jersey.spi.container.ContainerResponse write
SEVERE: A message body writer for Java class com.acme.server.webservice.
exception.WebServiceFailure, and Java type class com.acme.server.webserv
ice.exception.WebServiceFailure, and MIME media type application/json was not fo
und
Sep 26, 2012 5:35:59 PM com.sun.jersey.spi.container.ContainerResponse write
SEVERE: The registered message body writers compatible with the MIME media type
are:
*/* ->
  com.sun.jersey.server.impl.template.ViewableMessageBodyWriter

17:35:59.372 [qtp184245201-22 - /] ERROR o.a.h.ReflectorServletProcessor - onReq
uest()
javax.ws.rs.WebApplicationException: com.sun.jersey.api.MessageException: A mess
age body writer for Java class com.acme.server.webservice.exception.WebS
erviceFailure, and Java type class com.acme.server.webservice.exception.
WebServiceFailure, and MIME media type application/json was not found
        at com.sun.jersey.spi.container.ContainerResponse.write(ContainerRespons
e.java:285) ~[vma-server-0.0.1-SNAPSHOT-jar-with-dependencies.jar:na]
        at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequ
est(WebApplicationImpl.java:1457) ~[server-0.0.1-SNAPSHOT-jar-with-dependenc
ies.jar:na] 
```

...

完整的跟踪在这里，如果它有用的话： [https ://gist.github.com/3790817](https://gist.github.com/3790817)

Maven 在创建 jar-with-dependencies 时不会抛出任何错误。

我是 Maven 和 Java 部署的新手，我真的不知道如何进行调试。

此外，虽然我需要解决这个问题，但我也很感激任何建议的解决方法，因为我需要尽快生成我的服务器的可执行演示，尖头 Boss (tm) 可以在没有 Eclipse 的情况下执行。

**解决方案：**

根据 Pavel 的回答，我放弃了 maven-assemly-plugin 以支持 maven-shade-plugin。这是对我有用的阴影配置：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-shade-plugin</artifactId>
            <version>2.0</version>
            <executions>
                <execution>
                    <phase>package</phase>
                    <goals>
                        <goal>shade</goal>
                    </goals>
                    <configuration>
                        <transformers>
                        <!--  use transformer to handle merge of META-INF/services - see http://java.net/jira/browse/JERSEY-440?focusedCommentId=14822&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#action_14822 -->
                            <transformer
                                implementation="org.apache.maven.plugins.shade.resource.ServicesResourceTransformer" />
                        </transformers> 
                        <filters>
                            <!--  filter to address "Invalid signature file" issue - see http://stackoverflow.com/a/6743609/589215-->
                            <filter>
                                <artifact>*:*</artifact>
                                <excludes>
                                    <exclude>META-INF/*.SF</exclude>
                                    <exclude>META-INF/*.DSA</exclude>
                                    <exclude>META-INF/*.RSA</exclude>
                                </excludes>
                            </filter>
                        </filters>
                    </configuration>
                </execution>
            </executions>
        </plugin> 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-27T13:02:09.023

您没有正确合并泽西罐。

Jersey 1.x 使用 META-INF/services 机制来发现其组件和程序集：single 可能只是将所有内容复制到单个 jar 中，覆盖已经存在的文件但 META-INF/services 文件需要连接。

尝试使用 jersey-bundle ( [com.sun.jersey:jersey-bundle:1.14](http://search.maven.org/#search%7Cga%7C1%7Cjersey-bundle) ) 或修复您的程序集设置（或找到另一个插件来做得更好）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T08:28:42.650

你能发布你的pom吗？

您是否将某些依赖项标记为已提供？构建一个独立的应用程序和一个 webapp 是完全不同的，因为一些 jars 应该由 web 容器（tomcat 或其他）提供。

由于您的容器“嵌入”在您的应用程序中（而不是容器中的应用程序），那么您可能没有正确管理这些依赖项。

# iphone - 使用 AudioQueueGetProperty 检索记录格式的一般参数错误

> ID：12611215
> 
> 赞同：0
> 
> 时间：2012-09-26T22:10:13.600
> 
> 标签：iphone, ios, core-audio

我从对 AudioQueueGetProperty 的调用中得到 -50（一般参数错误）。请帮助我，因为我接触 XCode 和任何 iPhone 工作已经过去几个月了。代表我这可能是一个简单的错误，但我无法解决它。我的代码导致-50：

```
//Setup format
AudioStreamBasicDescription recordFormat;
memset(&recordFormat, 0, sizeof(recordFormat));
recordFormat.mFormatID = kAudioFormatMPEG4AAC;
recordFormat.mChannelsPerFrame = 2;
CCGetDefaultInputDeviceSampleRate(&recordFormat.mSampleRate);
UInt32 propSize = sizeof(recordFormat);
AQ(AudioFormatGetProperty(kAudioFormatProperty_FormatInfo, 0, NULL,
                                  &propSize, &recordFormat), 
           "AudioFormatGetProperty throws unexpected errors.");

//Setup Queue
//listing 4.8-4.9
AudioQueueRef theQueue = {0};
self->queue = theQueue;
AQ(AudioQueueNewInput(&recordFormat, CCAudioRecordingCallback, 
                              self, NULL, NULL, 0, &self->queue),
           "AudioQueueNewInput throws unexpected errors.");
UInt32 size = sizeof(recordFormat);
AQ(AudioQueueGetProperty(self->queue,
                                 kAudioConverterCurrentOutputStreamDescription, 
                                 &recordFormat, 
                                 &size), 
           "Getting audio property kAudioConverterCurrentOutputStreamDescription throws unexpected errors."); 
```

我在调用 AudioQueueGetProperty 时验证了我有一个有效的队列。我尝试了两种传递队列“self->queue”和“self.queue”的方法，它们都导致相同的错误。队列定义如下：

```
@interface CCAudioRecorder()
//...
@property (nonatomic, assign) AudioQueueRef queue;
//...

@end

@implementation CCAudioRecorder
@synthesize queue; 
```

AQ 是一个#def：

```
#define AQ(expr, msg) if(nil!=CheckError((expr), msg)) [NSException raise:@"AudioException" format:@"Unexpected exception occured."]; 
```

这解决了以下错误检查功能：

```
static NSString* CheckError(OSStatus error, const char* operation)
{
    if (noErr == error) return nil;

    NSString *errorMessage = nil;
    char errorString[20];
    //See if it appears to be a 4-char code
    *(UInt32 *)(errorString+1) = CFSwapInt32HostToBig(error);
    if ( isprint(errorString[1]) && isprint(errorString[2]) 
        && isprint(errorString[3]) && isprint(errorString[4]) ) 
    {
        errorString[0] = errorString[5] = '\'';
        errorString[6] = '\0';
    } else {
        sprintf(errorString, "%d", (int)error);
    }
    errorMessage = [NSString stringWithFormat:
                    @"Audio Error: %@ (%@)\n", 
                    [NSString stringWithUTF8String:operation], 
                    [NSString stringWithUTF8String:errorString]];
    NSLog(@"%@", errorMessage);
    return errorMessage;
} 
```

我还尝试在使用局部变量创建的队列上调用 AudioFormatGetProperty，避免使用类实例级别 iVar，但仍然得到相同的错误：

```
AudioQueueRef theQueue = {0};
AQ(AudioQueueNewInput(&recordFormat, CCAudioRecordingCallback, 
                              self, NULL, NULL, 0, &theQueue),
           "AudioQueueNewInput throws unexpected errors.");
UInt32 size = sizeof(recordFormat);
AQ(AudioQueueGetProperty(theQueue,
                                 kAudioConverterCurrentOutputStreamDescription, 
                                 &recordFormat, 
                                 &size), 
           "Getting audio property kAudioConverterCurrentOutputStreamDescription throws unexpected errors."); 
```

**更新**我有以下代码在模拟器上而不是在设备上工作。（我没有将它与我之前发布的内容交叉引用，但我相信它要么相似，要么完全相同。）

```
AudioQueueRef theQueue = {0};
self->queue = theQueue;
AQ(AudioQueueNewInput(&recordFormat, CCAudioRecordingCallback, 
                              self, NULL, NULL, 0, &self->queue),
           "AudioQueueNewInput throws unexpected errors.");
UInt32 size = sizeof(recordFormat);
AQ(AudioQueueGetProperty(self->queue, 
                                 kAudioConverterCurrentOutputStreamDescription, 
                                 &recordFormat, 
                                 &size), 
           "Getting audio property kAudioConverterCurrentOutputStreamDescription throws unexpected errors."); 
```

在设备上运行它，我在同一个地方发生了崩溃，错误为 -50 一般参数错误。我的设备是运行 iOS6 的 iPhone 4S，我正在使用 XCode 4.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T10:45:05.590

您正在遵循[学习核心有声](https://rads.stackoverflow.com/amzn/click/com/0321636848)书中的代码吗？第 4 章关于实现记录器？我注意到您的代码和书中的代码之间存在差异，在书中他们只是初始化队列并按原样使用它：

```
AudioQueueRef queue = {0};
UInt32 size = sizeof(recordFormat);
CheckError(AudioQueueGetProperty(queue, kAudioConverterCurrentOutputStreamDescription,
                                 &recordFormat, &size), "couldn't get queue's format"); 
```

我不知道你为什么要`self`混在一起。但这绝对是导致您的错误的原因。[如果一切都失败了，只需在此处](http://www.informit.com/store/product.aspx?isbn=0321636848)下载该章的完整代码，然后查看在哪里可以识别错误。

# android - Android通知被解雇的回调？

> ID：12611216
> 
> 赞同：5
> 
> 时间：2012-09-26T22:10:18.120
> 
> 标签：android, callback, notifications, dismiss

我的应用搜索新文章并发送“5 篇新文章”之类的通知。但是，当我发送另一篇文章时，我想让它更新文本以假设有 3 篇新文章，例如“8 篇新文章”但“3 篇新文章”，如果用户忽略了之前的通知。我希望你能明白。

有没有办法知道通知已被驳回，以便我可以重置计数？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-28T20:14:28.693

这是一个相当晚的答案，但我正在寻找自己如何做到这一点，所以也许它对其他人有用。在 API 级别 18 中，引入了以下服务，这应该使这一点变得简单，因为您现在可以在添加或删除通知时获得回调：

[https://developer.android.com/reference/android/service/notification/NotificationListenerService.html](https://developer.android.com/reference/android/service/notification/NotificationListenerService.html)

特别是对于原始问题，请参阅 onNotificationRemoved 方法

上面 jpop 提到的另一个选项是在创建通知时使用构建器的 setDeleteIntent 方法，该方法会在删除通知时给出回调。然后，这将要求您在其他地方维护现有引发通知的状态，因为它只会告诉您何时添加而不是删除某些内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:10:46.573

如果您的应用程序有数据库，您可以这样做：创建一个表，其中包含一些字段，例如 id 作为 int，文章名称作为字符串，isdismissed 作为布尔值。因此，每次要发送通知时，都应统计 isdismissed 字段等于 false 的记录。另一方面，每次用户选择通知时，相关的 isdismissed 字段必须等于 true。

此外，developer.android.com 上的这个示例可能会对您有所帮助：

[http://developer.android.com/guide/topics/ui/notifiers/notifications.html](http://developer.android.com/guide/topics/ui/notifiers/notifications.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-09T09:17:02.443

自 android Nougat 以来，监听器不起作用，添加了新的访问规则

在 android 设备上：参数 -> 应用程序 -> 齿轮菜单 -> 特殊访问 -> 通知访问

使用：[抓住滑动以关闭事件](https://stackoverflow.com/questions/14671453/catch-on-swipe-to-dismiss-event/14671589#14671589)

# mysql - MySQL：使用连接进行更新需要很长时间

> ID：12611220
> 
> 赞同：1
> 
> 时间：2012-09-26T22:10:35.313
> 
> 标签：mysql, join

我有一个更新语句，它使用了一个需要很长时间的连接。我将在下面提供更多详细信息，但这里是查询：

```
update quote_line
left join quote q on (q.id = quote_id and q.version = version )
set quote_serial_id = q.serial_id 
```

背景故事：我正在尝试清理我继承的数据库。我有两个具有以下架构的表（仅显示重要列）：

引用：

```
serial_id  bigint(20)  -- Unique key defined with 'serial'
id         bigint(20)  -- Id of quote.
version    smallint(6) -- Version of quote. 
```

报价行：

```
id         bigint(20)  -- Unique key defined with 'serial'
quote_id   bigint(20)  -- Foreign key to quote.
version    smallint(6) -- Foreign key to quote. 
```

请注意，quote.id*不是*键，但quote.id+quote.version 是。无论出于何种原因，设计者决定使用 id+version 作为 quote_line 中的外键，而不是 serial_id。为了使这一点变得具体，这里*必须*如何进行连接：

```
select q.id, q.version, q.serial_id
from quote q join quote_line l on q.id = l.quote_id and l.version = q.version 
```

我想将 quote_line 中的 FK 更改为使用 quote.serial_id，这给了我这个更新语句：

```
update quote_line
left join quote q on (q.id = quote_id and q.version = version )
set quote_serial_id = q.serial_id 
```

这个声明，经过几个小时的运行，仍然没有完成。我尝试在报价上创建索引而没有任何改进。我正在运行 MySQL 5.5.14，所以我无法在更新中运行解释。这两个表有这么多行：

报价：335517 报价线：247992

你可以看到并不是所有的引号都有quote_lines（事实上，大部分都没有）。关于如何使这个运行更快的任何提示？我最终不得不在我们的生产服务器上复制它，我不能让它花几个小时。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:58:53.133

正如 Paul 和 sceaj 在评论中指出的那样，我使用的是 LEFT join。当我删除“LEFT”时，查询会在几秒钟内运行。谢谢您的帮助！

# sql-server - 模拟 DTS 复制 SQL Server 对象任务

> ID：12611229
> 
> 赞同：0
> 
> 时间：2012-09-26T22:11:15.950
> 
> 标签：sql-server, dts

我正在将 Web 应用程序数据库从 SQL Server 2000 迁移到 SQL Server 2008。目前有一个 DTS 包，用于将内容更改从临时数据库部署到生产数据库。

DTS 包正在使用已`Copy SQL Server Objects`选择以下选项的任务： `Copy Data (Append Data)`和`Use Collation`. 在“选择对象”对话框中选择要复制的特定表。

因为这是我们唯一的 DTS 包，所以学习和实施 SSIS 解决方案 IMO 没有多大意义，所以我想仅使用 T-SQL 重新创建 DTS 包的功能。

编写插入和选择不是问题。我需要知道的是“ `Append Data`”选项是如何工作的。

它是在查看源中的每一行，在目标中查找匹配的行，根据需要进行比较和更新，或者是忽略现有行并简单地追加新行？

如果确实是在比较和更新，那么`Checksum`在数据上使用 SQL Server 函数作为与目标进行比较的方法是否安全，还是有更好的方法？理想情况下，我想避免任何架构更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:39:26.993

请查看这篇 msdn 文章：[将 DTS 包迁移到集成服务](http://msdn.microsoft.com/en-us/library/cc768544%28v=SQL.100%29.aspx)

您可以使用文章中提到的工具非常轻松地将单个 DTS 包迁移到 SSIS 包。

# c - 如何删除和更新 yajl C 库中的对象？

> ID：12611230
> 
> 赞同：0
> 
> 时间：2012-09-26T22:11:33.647
> 
> 标签：c, edit, yajl

如何删除和更新 yajl C 库中的对象？

我在任何地方都找不到这个解决方案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T04:30:22.107

您将需要手动更新库文件。对此没有特定的方法或技术。

# javascript - 如何在更改文档时使用 javascript 遍历 xml？

> ID：12611231
> 
> 赞同：1
> 
> 时间：2012-09-26T22:11:40.863
> 
> 标签：javascript, xml, iteration, insertafter, xmlnodelist

如何遍历 xml 节点列表（tag="items"），并在这样做的同时在特定位置插入一个新节点，在这种情况下，当 chileNode 值更改时（tag="rowNum"）？这是一个显示我的输入和我想要的输出的示例：

启动xml：

```
<items>
  <item>
     <rowNum>1</rowNum>
     <description>some text</description>
  </item>
  <item>
     <rowNum>1</rowNum>
     <description>some more text</description>
  </item>
  <item>
     <rowNum>2</rowNum>
     <description>some text</description>
  </item>
</items> 
```

期望的输出：

```
<items>
  <item>
     <rowNum>1</rowNum>
     <description>some text</description>
  </item>
  <item>
     <rowNum>1</rowNum>
     <description>some more text</description>
  </item>
  <item>
     <rowNum>1</rowNum>
     <description>last row 1 item</description>
  </item>
  <item>
     <rowNum>2</rowNum>
     <description>some text</description>
  </item>
  <item>
     <rowNum>2</rowNum>
     <description>last row 2 item</description>
  </item>
</items> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:00:57.653

1.  为 rownum 创建一个变量，其初始值设置为例如 -1
2.  循环遍历项目元素，但从**末尾开始**
3.  检查变量值是否与 rowNum 元素的内容不同。如果是，则将 variable-value 设置为 rowNum-element 的内容，并在当前 item-element 的 nextSibling 之前插入新节点

演示：http: [**//jsfiddle.net/doktormolle/n5wUC/**](http://jsfiddle.net/doktormolle/n5wUC/)

# ios - 你能在 iOS 单元测试中包括手机关机吗？

> ID：12611232
> 
> 赞同：0
> 
> 时间：2012-09-26T22:11:42.393
> 
> 标签：ios, xcode, unit-testing

我想知道是否可以在您的单元测试中测试 iOS 手机状态？是否可以关闭手机然后在单元测试中重新打开它？有第三方软件可以测试吗？

提前致谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:16:25.337

我不知道有一个测试框架会重新启动并等待它重新启动，然后再继续。

以下是更多信息：[iphone reboot programmatically](https://stackoverflow.com/questions/6419678/iphone-reboot-programmatically)

# c# - 带有网格列和行的 WinRT ItemsControl

> ID：12611233
> 
> 赞同：1
> 
> 时间：2012-09-26T22:11:44.590
> 
> 标签：c#, xaml, windows-8, microsoft-metro, itemscontrol

我是 XAML 的新手。我搜索了ItemsControl，找到了一个教程，很容易理解，但问题是它在WinRT中不起作用。

教程：[https ://rachel53461.wordpress.com/2011/09/17/wpf-itemscontrol-example/](https://rachel53461.wordpress.com/2011/09/17/wpf-itemscontrol-example/)

我尝试`TargetType`在`Style`标签中使用，但是，在运行时出现异常。

```
<ItemsControl ItemsSource="{Binding MyCollection}">
    <!-- ItemsPanelTemplate -->
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition />
                    <ColumnDefinition />
                    <ColumnDefinition />
                    <ColumnDefinition />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
            </Grid>
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>

    <!-- ItemContainerStyle -->
    <ItemsControl.ItemContainerStyle>
        <Style TargetType="TextBox">
            <Setter Property="Grid.Column"
                Value="{Binding xIndex}" />
            <Setter Property="Grid.Row"
                Value="{Binding yIndex}" />
        </Style>
    </ItemsControl.ItemContainerStyle>

    <!-- ItemTemplate -->
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <TextBox  Background="{Binding color}" Text="{Binding xIndex,Mode=OneWay}" />
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T03:09:00.063

你的问题在这里：

```
<Style TargetType="TextBox"> 
```

这应该是：

```
<Style TargetType="ContentPresenter"> 
```

`ItemContainer`for an`ItemsControl`是 a （除非将`ContentPresenter`特定项目添加到`ItemsControl`）。

因此，您的视图层次结构看起来像这样（假设您没有将 a 更改为`ItemsPanel`a 以外的其他内容`StackPanel`）：

```
<StackPanel>
    <ContentPresenter>
        <TextBox/>
    </ContentPresenter>
</StackPanel> 
```

编辑：

As Scott pointed out in the comments, this solution doesn't actually work for WinRT. I did something similar and you can probably modify it to do the appropriate binding:

```
public class CustomItemsControl : ItemsControl
{
    protected override void PrepareContainerForItemOverride(DependencyObject element, object item)
    {
        base.PrepareContainerForItemOverride(element, item);
        FrameworkElement source = element as FrameworkElement;
        if (source != null)
        {
            source.SetBinding(Canvas.LeftProperty, new Binding { Path = new PropertyPath("X"), Mode = BindingMode.TwoWay });
            source.SetBinding(Canvas.TopProperty, new Binding { Path = new PropertyPath("Y"), Mode = BindingMode.TwoWay });
        }
    }
} 
```

This binds the `Canvas.LeftProperty` to the `X` property on each item in the collection and similarly the `Canvas.TopProperty` and the `Y` property.

# jquery - 需要使用 Highcharts 使工具提示边框颜色与标记颜色相同

> ID：12611237
> 
> 赞同：3
> 
> 时间：2012-09-26T22:12:06.033
> 
> 标签：jquery, highcharts

我正在使用 Highcharts 制作此图形：

![在此处输入图像描述](../Images/2086f1e768dff0bf7dc2bbdba2b016fe.png)

但我需要使工具提示的边框颜色与标记颜色相同，所以当我将鼠标悬停在绿色标记上时，边框颜色变为绿色，在黄色标记中，边框颜色变为黄色，与红色标记相同. 你知道我怎样才能做到这一点吗？

**更新：**这是我的 jsfiddle：http: [//jsfiddle.net/tbU7e/1/](http://jsfiddle.net/tbU7e/1/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T16:45:16.563

您必须设置`borderColor`to`null`然后将点`color`与您的`point`数据一起传递，如下所示。

```
var current_zafra_series = new Array();
current_zafra_series[0] = { y: 150, prueba: 'a', color: '#FF9933',marker: { fillColor: '#FF9933' } };
current_zafra_series[1] = { y: 200, prueba: 'b', color: '#F15B49', marker: { fillColor: '#F15B49' } };
current_zafra_series[2] = { y: 150, prueba: 'c', color: '#55B647', marker: { fillColor: '#55B647' } }; 
```

[**演示**](http://jsfiddle.net/tbU7e/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:21:36.597

根据[api](http://api.highcharts.com/highcharts#tooltip.borderColor)，您可以将选项设置为null。因此，在声明图表时，请确保添加以下选项

```
var chart = new Highcharts.Chart({
      //... other options ,
      tooltip : {
           borderColor : null
       }

 }); 
```

# linux - VMWare 播放器 - 从主机对来宾执行命令

> ID：12611239
> 
> 赞同：0
> 
> 时间：2012-09-26T22:12:09.427
> 
> 标签：linux, vmware

我在 VMWare Player 上运行 linux 服务器。主机的操作系统是Windows7。是否可以从将在来宾上运行的命令行（在主机上）执行命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:38:19.590

是的。有可能的。您可以使用 telnet 连接 Windows（Professional 及更高版本）来宾系统，并使用 *nix 来宾进行 telnet 或 ssh。因此，当您以访客身份运行 linux 时，对您来说最好的选择是 ssh（使用 putty - 这是非常强大的实现）。

# vba - 在 vba 中提交 Web 表单时输入文本框值为空

> ID：12611242
> 
> 赞同：2
> 
> 时间：2012-09-26T22:12:35.720
> 
> 标签：vba, excel

我正在尝试通过在表单输入文本框中提供所有值来提交网络表单，但是当我从 excel vba 调用提交按钮单击时，其中一个文本框变为空并引发验证错误。

```
Sub Click_Btn()    
  Dim objForms As Object
  Dim vTxtInput As Variant
  'Set objIE = GetIEApp
  Set objIE = New InternetExplorer

  'Make sure an IE object was hooked
  If TypeName(objIE) = "Nothing" Then
    MsgBox "Could not hook Internet Explorer object", _
      vbCritical, "GetFields() Error"
    'GoTo Clean_Up
  End If
  objIE.Navigate "http://fly3.emirates.com/CAB/IBE/SearchAvailability.aspx"
  objIE.Visible = True

  Sleep 5000

  Set objForms = objIE.document.all

  'Choose one way Flights
  objIE.document.getElementById("ctl00_c_CtWNW_onewaySearch").Click
  Sleep 1000

  objIE.document.getElementById("ctl00_c_CtWNW_ddlTo-suggest").Value = "Sydney (SYD)"

  ' Departure
  objIE.document.getElementById("ctl00_c_CtWNW_ddlFrom-suggest").Value = "Mumbai (BOM)"

  ' Departure Date
  objIE.document.getElementById("ctl00_c_CtWNW_txtDepartDate").Value = "28 Sep 12"
  Sleep 1000

  objIE.document.getElementById("ctl00_c_FS_FF").Click
End Sub 
```

当我单击表单的提交按钮时，`ctl00_c_CtWNW_ddlTo-suggest`文本框变为空并出现错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T05:06:43.400

您收到该错误是因为您没有给它足够的时间来验证`FROM`和`TO`下拉列表的名称（是 - 不是文本框）

试试这个代码（尝试和测试）。我也在使用 IE 的后期绑定。根据您的代码进行更改。

给下拉列表中的`Sleep 5000`文本足够的时间来使用下拉列表验证自身。

```
Option Explicit

Private Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)

Sub Click_Btn()
    Dim objForms As Object
    Dim vTxtInput As Variant
    Dim objIE As Object

    Set objIE = CreateObject("InternetExplorer.Application")

    'Make sure an IE object was hooked
    If TypeName(objIE) = "Nothing" Then
        MsgBox "Could not hook Internet Explorer object", _
        vbCritical, "GetFields() Error"
        'GoTo Clean_Up
    End If

    objIE.Navigate "http://fly3.emirates.com/CAB/IBE/SearchAvailability.aspx"
    objIE.Visible = True

    Sleep 5000

    Set objForms = objIE.document.all

    '~~> Choose one way Flights
    objIE.document.getElementById("ctl00_c_CtWNW_onewaySearch").Click

    '~~> From
    objIE.document.getElementById("ctl00_c_CtWNW_ddlFrom-suggest").Focus
    objIE.document.getElementById("ctl00_c_CtWNW_ddlFrom-suggest").Value _
    = "Mumbai (BOM)"
    Sleep 5000

    '~~> Departure Date
    objIE.document.getElementById("ctl00_c_CtWNW_txtDepartDate").Focus
    objIE.document.getElementById("ctl00_c_CtWNW_txtDepartDate").Value _
    = "28 Sep 12"
    Sleep 5000

    '~~> To
    objIE.document.getElementById("ctl00_c_CtWNW_ddlTo-suggest").Focus
    objIE.document.getElementById("ctl00_c_CtWNW_ddlTo-suggest").Value _
    = "Sydney (SYD)"
    Sleep 5000

    objIE.document.getElementById("ctl00_c_FS_FF").Focus
    objIE.document.getElementById("ctl00_c_FS_FF").Click
End Sub 
```

**编辑**

这是`Way 2`，它比我们不用于验证`Way 1 (Above)`的速度更快。这不需要您验证下拉菜单。它的作用是绕过在提交按钮的 ONCLICK 事件中执行的 javascript。`15 Seconds``Sleep 5000``checkValidation();`

**方式 2**

```
Option Explicit

Private Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)

Sub Click_Btn()
    Dim objForms As Object
    Dim vTxtInput As Variant
    Dim objIE As Object

    Set objIE = CreateObject("InternetExplorer.Application")

    'Make sure an IE object was hooked
    If TypeName(objIE) = "Nothing" Then
        MsgBox "Could not hook Internet Explorer object", _
        vbCritical, "GetFields() Error"
        'GoTo Clean_Up
    End If

    objIE.Navigate "http://fly3.emirates.com/CAB/IBE/SearchAvailability.aspx"
    objIE.Visible = True

    Sleep 5000

    Set objForms = objIE.document.all

    'Choose one way Flights
    objIE.document.getElementById("ctl00_c_CtWNW_onewaySearch").Click

    ' From
    objIE.document.getElementById("ctl00_c_CtWNW_ddlFrom-suggest").Focus
    objIE.document.getElementById("ctl00_c_CtWNW_ddlFrom-suggest").Value _
    = "Mumbai (BOM)"

    ' Departure Date
    objIE.document.getElementById("ctl00_c_CtWNW_txtDepartDate").Focus
    objIE.document.getElementById("ctl00_c_CtWNW_txtDepartDate").Value _
    = "28 Sep 12"

    ' To
    objIE.document.getElementById("ctl00_c_CtWNW_ddlTo-suggest").Focus
    objIE.document.getElementById("ctl00_c_CtWNW_ddlTo-suggest").Value _
    = "Sydney (SYD)"

    objIE.document.getElementById("ctl00_c_FS_FF").Focus
    objIE.document.getElementById("ctl00_c_FS_FF").onclick = _
    Replace(objIE.document.getElementById("ctl00_c_FS_FF").onclick, _
    "checkValidation();", "true;")

    objIE.document.getElementById("ctl00_c_FS_FF").Click
End Sub 
```

# selenium-ide - Selenium IDE 断言位置

> ID：12611245
> 
> 赞同：1
> 
> 时间：2012-09-26T22:12:45.150
> 
> 标签：selenium-ide

我正在尝试使用 Selenium IDE，并且我想测试我工作的网站的登录过程。登录后，您会在网站的会员区前面看到一个“newton”（我的老板称之为）`http://abc1234.members.domain.tld`所以我想使用`assertLocation`a`glob:http://*.members.domain.tld`但我似乎无法正确使用语法，或者我只是做错了：

```
<tr>
<td>assertLocation</td>
<td>glob:http://*.members.domain.tld</td>
<td></td>
</tr> 
```

但在日志中我得到：

```
[error] Actual value 'http://abc1234.members.domain.tld/' did not match 'glob:http://*.members.titanmen.com' 
```

我在各种 td 字段中尝试了各种 glob 和正则表达式的组合，甚至尝试了类似的东西`assertLocation(glob:http://*.members.domain.tld)`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-24T08:54:55.457

该`assertLocation`命令将获取当前页面的当前绝对地址，`http://abc1234.members.domain.tld/`并将其与您在目标中输入的模式进行比较，这是无意义的`glob:http://*.members.domain.tld`，因此测试用例以失败告终。

目标应该很可能只是`http://*.members.domain.tld/`

# gwt - 在gwt中通过鼠标拖动选择区域

> ID：12611254
> 
> 赞同：0
> 
> 时间：2012-09-26T22:13:28.197
> 
> 标签：gwt, select, drag, area, drag-and-drop

我将 gwt 与[gwt-dnd](http://code.google.com/p/gwt-dnd/)一起使用 ，我想做以下事情：

```
1\. Select rectangle area by dragging the mouse
2\. Select all the elements that are in this area
3\. drag all selected elements. 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T00:21:44.243

在 MouseDownEvent 上记录指针的坐标（event.getClientX() 和 eventGetClientY()）。

在 MouseUpEvent 上做同样的事情。如果坐标不同，则您选择了一个矩形。

获取包含所有可选择的小部件或元素的小部件。循环遍历它的孩子。

将每个小部件的坐标与您的矩形进行比较（使用 getAbsoluteTop()、getAbdoluteLeft()、getOffsetHeight() 和 getOffsetWidth()）。选择完全或部分位于所选区域内的小部件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T07:27:24.783

我想在 Andrei 的回答中补充一点，如果您通过在选择期间显示矩形来提供反馈，我们所做的就是将矩形显示为 com.google.gwt.user.client.ui.HTML 的实例，其样式显示边框. 这是使用 onMouseMove 和 setPixelSize 和 setWidgetPosition 更新的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-02T14:15:51.813

库 gwtquery-plugins 提供了 MultiSelect 功能，所以我会尝试一下。

[gwtquery-插件](http://code.google.com/p/gwtquery-plugins/)

# java - 循环中的整数到希腊字符-Java

> ID：12611255
> 
> 赞同：2
> 
> 时间：2012-09-26T22:13:30.580
> 
> 标签：java, unicode, ascii

所以我应该为作业写出大写和小写的希腊字母，但我觉得Java中有一种方法可以使用循环，并将整数转换为字符（或类似的东西）以便做这是最有效的。所以我尝试了这个：

```
public class GreekAlphabet{

public static void main(String[] args){
    char output;

    for (int i=0;i<1000;i++){

        output= (char) i;

        System.out.println(output);
    }
}

} 
```

但它没有打印出希腊字母，并且在一定数量的字符（我猜是 256 个）之后，都是问号。反正有没有得到一个扩展的字符集，或者类似的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:24:59.377

```
for (char c = 'Α'; c <= 'Ω'; c++) {
    System.out.println(c);
    if (c == 'Ρ') c++;
} 
```

请注意，这些是希腊字母 alpha 和 rho，而不是英语 A 和 P。此外，由于某种原因，希腊字母在 Unicode 中并不完全连续；rho 之后还有另一个字符，所以这就是为什么它在那个字母之后上升了两个。

# wordpress - 在 WP_query 中使用变量

> ID：12611256
> 
> 赞同：0
> 
> 时间：2012-09-26T22:13:33.610
> 
> 标签：wordpress

我试图在“tax_query”中回显 $zipcode_term，但它不起作用......

```
wp_reset_query();
$zipcode_term = get_the_term_list( get_the_ID(), 'zipcode' );

$args = array(
'tax_query' => array(
    array(

        'taxonomy' => 'zipcode',
        'field' => 'slug',
        'terms' => '.$zipcode_term.'
    )
)
);
$query = new WP_Query( $args ); 
```

我已经回显了 $zipcode_term 并且它正确显示了它，所以我知道该部分正在工作，我怎样才能正确地在数组内部表达它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:04:06.840

变量周围应该`'terms' => '.$zipcode_term.'`有撇号和连接吗？

```
'terms' => $zipcode_term 
```

?

# c# - 模板生成器中 sitecore 'source' 字段的查询表示法

> ID：12611258
> 
> 赞同：14
> 
> 时间：2012-09-26T22:13:36.903
> 
> 标签：c#, asp.net, content-management-system, sitecore, sitecore6

我正在尝试使用查询表示法（或 xpath - 无论哪个有效）设置模板的源字段，但它们似乎都没有工作。

我的内容树是多站点内容树：

```
France
--Page 1
----Page1A
-------Page1AA
--Page 2
--Page 3
--METADATA
----Regions

US
--Page 1
----Page1A
-------Page1AA
--Page 2
--Page 3
--METADATA
----Regions 
```

每个站点都有自己的 METADATA 文件夹，我想要它，以便在每个主要国家节点内添加页面时，我希望这些值反映该站点的元数据中的任何内容。我现在有两个不同的字段——一个 droplink 和一个 treelistex 字段。所以我想我可以得到一个国家网站的父项目，然后得到它的元数据文件夹。当我在两个字段中输入以下查询时，会得到不同的结果：

```
 query:./ancestor::*[@@templatename='CountryHome']/METADATA/Regions/* 
```

*   对于 droplink 字段，我只得到第一个 Region（一个项目）
*   对于 treelistex 字段，我得到了整个内容树

然后我尝试稍微修改查询并取出“查询”符号

```
 ./ancestor::*[@@templatename='CountryHome']/METADATA/Regions/* 
```

如果我转到开发人员中心/xpath 构建器，并将上下文节点设置为主要国家/地区站点下的任何项目，它会返回我所需要的内容，但是当我将其放入源代码时，我会在两者中获得整个内容树案件。

帮助！

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-09-27T09:14:49.817

# 支持 Sitecore 查询的字段

您可以在哪里使用语法`query:`或`fast:`（对于 FastQuery）：

*   下拉列表
*   分组下拉列表
*   DropLink
*   分组 Droplink
*   清单
*   多列表
*   删除树

# 支持参数化数据源的字段

您可以将增强的语法与参数化数据源查询一起使用：

*   删除树†</li>
*   树列表
*   TreelistEx

† *Droptree 仅支持`Datasource`and`DatabaseName`参数。*

### 增强的查询字符串语法包括以下参数：

*   数据源
*   数据库名称
*   允许多重选择
*   IncludeItemsForDisplay
*   排除项目显示
*   IncludeTemplatesForSelection
*   排除模板供选择
*   IncludeTemplatesForDisplay
*   排除显示模板

这些是这样使用的：`Datasource=/sitecore/content/home/Products/&IncludeTemplatesForDisplay=Product Category&ExcludeTemplatesForSelection=Product Description&IncludeTemplatesForSelection=Product Category`

[Mark Ursino 有一篇很棒的文章，介绍了如何在此处](http://firebreaksice.com/tame-your-sitecore-treelists/)使用这种语法。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-09-26T23:01:08.167

您在此处拥有的内容应该与 Droplink 字段一起使用。也许您指的是 Droptree？

```
query:./ancestor::*[@@templatename='CountryHome']/METADATA/Regions/* 
```

至于 TreelistEx，我认为默认的 Treelist 字段不支持 Sitecore 查询。但是，[本文](http://sdn.sitecore.net/Scrapbook/Custom%20TreeList%20that%20supports%20query.aspx)介绍了如何创建支持它的自定义 TreeList。

# php - hasAndBelongsToMany 不为 AssociationForeignKey 提取数据

> ID：12611259
> 
> 赞同：2
> 
> 时间：2012-09-26T22:13:54.223
> 
> 标签：php, cakephp

在我的 CakePHP 应用程序中，我的用户能够与其他用户成为朋友。

这是通过一个`users`表和一个`friends_users`具有以下列的表来完成的：`id, user_id, friend_id, status`用于关系。

因此，如果用户 id 1 是用户 id 2 的朋友，则 user_id 中将有 1，friend_id 列中将有 2

User 的模型如下所示：

```
public $hasAndBelongsToMany = array(
        'Friend'=>array(
            'className'              => 'User',
            'joinTable'              => 'friends_users',
            'foreignKey'             => 'user_id',
            'associationForeignKey'  => 'friend_id'
        )
    ); 
```

查看用户 1 时，它工作正常并将用户 2 显示为朋友。但是在查看用户 2 时，它并没有将用户 1 显示为朋友......所以当反向查看时，它并没有填满数据！

这是我用来为用户列出朋友的方法：

```
$user = $this->User->find('first', array( 
                    'conditions' => array('User.id' => $this->Auth->user('id')),
                    'contain'=>'Profile'
                ));

        $friends = $this->User->find('first', 
            array(
                'conditions'=>array(
                   'User.id'=>$user['User']['id']
                ),
                'contain'=>array(
                    'Profile',
                    'Friend'=>array(
                        'Profile',
                        'conditions'=>array(
                            'FriendsUser.status'=>1
                        )
                    )
                )
            )
        );

        $this->set('friends', $friends); 
```

任何想法为什么会发生这种情况？我浏览了文档，但对我来说一切都很好。

**理想情况下，我想修复我的代码，而不是指向其他资源！**

页面查询：http: [//pastebin.com/zQnBVM2X](http://pastebin.com/zQnBVM2X)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:16:47.727

当您检索用户#6 的朋友时，您将获得朋友#8。当您检索用户 #8 的朋友时，您应该什么也没有收到，因为您的`friends_users`表中没有用户 #8 的记录。因此，您需要在`friends_users`表 ( `user_id = 8, friend_id = 6`) 中插入其他数据，或者您需要创建`Friend`模型（不使用表）并通过`Friend`. 那是心理体操——你需要意识到用户是朋友，朋友是用户。

```
 $friends = $this->User->Friend->find('first', 
            array(
                'conditions'=>array(
                   'Friend.id'=>$id // user id whose friends you need to find
                ),
                'contain'=>array(
                    'Profile',
                    'User'=>array( // here you will get friends
                        'Profile',
                        'conditions'=>array(
                            'FriendsUser.status'=>1
                        )
                    )
                )
            )
        ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:07:21.660

这是一个有趣的问题，几年前我在建立一个约会网站时也遇到了同样的问题。

您需要做的是（在我的情况下）有 4 组关系：

*   前向关系
*   转发关系（未经批准的友谊）
*   后向关系
*   落后的关系（未经批准的友谊）

这将确保您提取所有必要的数据，`containable`尽可能使用。

```
var $hasAndBelongsToMany = array(
    'ForwardRelation' => array(
        'className'  => 'User',
        'joinTable'  => 'friends_users',
        'foreignKey' => 'user_id',
        'conditions' => array('approved' => '1'),
        'associationForeignKey' => 'friend_id',
        ),
    'ForwardRelationUn' => array(
       'className'  => 'User',
        'joinTable'  => 'friends_users',
        'foreignKey' => 'user_id',
        'conditions' => array('approved' => '0'),
        'associationForeignKey' => 'friend_id'
        ),
    'BackRelation' => array(
        'className'  => 'User',
        'joinTable'  => 'friends_users',
        'foreignKey' => 'friend_id',
        'associationForeignKey' => 'user_id',
        'conditions' => array('approved' => 1)
        ),
    'BackRelationUn' => array(
        'className'  => 'User',
        'joinTable'  => 'friends_users',
        'foreignKey' => 'friend_id',
        'associationForeignKey' => 'user_id',
        'conditions' => array('approved' => '0')
    )
); 
```

添加一个带有一些`afterFind()`魔法的行为，你会是金色的！

这是我寻找朋友的功能：

```
function getFriends( $userid, $search = null ) {

    $Friends    = ClassRegistry::init( 'FriendsUser' );

    $Friends->bindModel( 
        array(
            'belongsTo' => array(
                'User' => array(
                    'className' => 'User',
                    'foreignKey' => 'user_id'
                ),
                'Friend' => array(
                    'className' => 'User',
                    'foreignKey' => 'friend_id'
                    )
                )
            )
        );

    $data = $Friends->find( 
        'all', 
        array( 
            'fields' => array( 
                'DISTINCT FriendsUser.friend_id', 
                'FriendsUser.user_id',
                'FriendsUser.approved',
                'User.id', 
                'User.username', 
                'Friend.id', 
                'Friend.username'
                ), 
            'conditions' => array(
                 'AND' => array(
                     'OR' => array( 
                        'Friend.username LIKE' => '%' . $search . '%',
                        'User.username LIKE' => '%' . $search . '%'
                        )
                    )
                ),
            'contain' => array(
                'User', 
                'Friend'
                ),
            'order' => array( 'User.username ASC', 'FriendsUser.approved DESC' )
        ) 
    );

    $friendlist = array();
    $i = 0;

    foreach ( $data as $datum ) {

        foreach ( $datum as $key => $value ) {

            if ( in_array( $key, array( 'User', 'Friend' ) ) ) {

                if ( $value['id'] == $userid ) {
                    $friendlist[$i]['Me'] = $value;
                } else {
                    $friendlist[$i]['Friend']           = $value;
                }

            }
        }

        $i++;

    }

    $matches = array();

    foreach ( $friendlist as $friend ) {

        if ( stripos( $friend['Friend']['username'], $search ) !== false )
            $matches[ $friend['Friend']['id'] ] = $friend['Friend']['username'];

    }

    asort( $matches );

    $i = 0;

    $newmatches = array();

    foreach ( $matches as $key => $match ) {
        $newmatches[$i]['Tag']['caption']   = $match;
        $newmatches[$i]['Tag']['value']     = $key; 
        $newmatches[$i]['Tag']['image']     = $this->getProfileImage( $key );

        $i++;       
    }

    return $newmatches;

} 
```

# python - 如何在python中导致堆栈溢出和堆溢出

> ID：12611264
> 
> 赞同：7
> 
> 时间：2012-09-26T22:14:21.363
> 
> 标签：python, python-3.x, heap-memory, stack-overflow

我试图了解 python 如何管理堆栈和堆。所以我想做一些“糟糕”的编程并导致堆栈溢出和堆溢出。我不明白为什么字符串例如进入堆栈而所有其他字符串进入堆。仅仅是设计师的约定吗？这些例子是否正确？从我读过的内容来看，python 中的所有内容都是在堆中生成的，因为它是面向对象的，对吧？

***已编辑***：我认为像 C 这样的语言中的堆栈具有固定长度，但在 python 中，即使堆栈是动态分配的，正如 Anycorn 在他的回答中所说的那样。这就是为什么如果我同时尝试大字符串（在堆栈上）或列表（在堆上），我也会获得完整的内存。如果我错了，请纠正我。谢谢

来自[http://docs.python.org/c-api/memory.html](http://docs.python.org/c-api/memory.html)

> Python 中的内存管理涉及一个包含所有 Python 对象和数据结构的私有堆。这个私有堆的管理由 Python 内存管理器在内部确保。Python 内存管理器具有处理各种 ***动态存储管理***方面的不同组件，例如共享、分段、预分配或缓存。
> 
> 在最低级别，原始内存分配器通过与操作系统的内存管理器交互来确保私有堆中有足够的空间来存储所有与 Python 相关的数据。在原始内存分配器之上，几个特定于对象的分配器在同一个堆上运行，并实施适应每种对象类型特性的不同内存管理策略。

这里有些例子。您可以将它们复制粘贴到[Python 官方可视化工具](http://www.pythontutor.com/visualize.html#mode=edit)中，但使用较小的值会导致它无法运行...

对于堆栈溢出：

```
import time
word = "test "
x = word*1000000000
time.sleep(10)
print ("this message wont appear if stack overflow has occurred!") 
```

我明白了

```
x = word*1000000000
MemoryError 
```

如果我删除一个零，它就会运行。我使用时获得最大内存使用量`x = word*500000000` 所以我不能使堆栈溢出，因为即使堆栈是动态分配的？

对于堆溢出：

```
i = 10000
test_list = [0]
while i > 0 :
    test_list [:0] = test_list #insert a copy of itself at the beginning
    i -= 1 
```

现在我不明白垃圾收集器是如何在程序中运行的。它是否在堆栈和堆上都运行，因为它们都是动态分配的？是因为操作系统内存管理器吗？这些东西告诉我们关于 python 编程语言的特征的什么？这是否证明了“动态语言”或“解释”一词的合理性？很抱歉这个问题很长，但我只需要澄清一些事情。提前致谢！

***已编辑***
我找到了我正在寻找的内容：如果您调用 `sys.setrecursionlimit(N)`的 N 值大于系统实际可以处理的值，然后尝试递归到该深度，则可能导致“真正的”堆栈溢出。在某些时候，您的系统将耗尽堆栈空间，Python 解释器将崩溃。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-30T00:22:49.683

通过构建无限递归函数，您可以在 python 中很容易地导致堆栈溢出，就像在任何其他语言中一样。这在 python 中更容易，因为除了递归之外它实际上不需要做任何事情。

```
>>> def foo():
...     return foo()
... 

>>> foo()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  .......
  File "<stdin>", line 2, in foo
RuntimeError: maximum recursion depth exceeded
>>> 
```

至于堆，它由垃圾收集器管理。您可以分配大量对象并最终耗尽堆空间，Python 会引发 a `MemoryError`，但这需要相当长的时间。您实际上是在问题中的“堆栈溢出”示例中做到了这一点。您在堆栈上存储了对字符串的引用，该字符串占用了进程可用的所有空闲内存。根据经验，Python 会在堆栈上存储对任何无法保证其大小的值的堆结构的引用。

至于它是如何工作的，从第一个示例中您可以看到 python 对调用堆栈的深度有一个内置限制，它不会超过。然而，可用于堆空间的内存量由操作系统定义，并且取决于许多因素。

这些应该是 python 文档的适当部分，用于获取有关错误本身的信息：

*   [http://docs.python.org/release/3.2.3/library/exceptions.html#RuntimeError](http://docs.python.org/release/3.2.3/library/exceptions.html#RuntimeError)
*   [http://docs.python.org/release/3.2.3/library/exceptions.html#MemoryError](http://docs.python.org/release/3.2.3/library/exceptions.html#MemoryError)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-26T22:42:22.703

如果有错误请纠正我：

据我所知，当涉及到实际的堆栈实现时，python 堆栈（在默认分布中）实际上是基于堆内存（用 分配的内存`malloc`）。所以你不能导致堆栈溢出，但你可能会耗尽内存。您看到的计算机速度变慢是因为内存正在交换到磁盘，过程非常缓慢。

通常，您不知道解释/字节编译语言如何实现其堆栈，但最喜欢的是它没有在堆栈内存中实现，因此您不会导致堆栈溢出。可以使用 Python 来实现`alloca`，但是为什么呢？

参照。[CPython - 在内部，堆栈和堆中存储了什么？](https://stackoverflow.com/questions/2353552/cpython-internally-what-is-stored-on-the-stack-and-heap)

尝试使用编译为机器代码的编译语言、C++、Fortran 等进行相同的实验。

# css - div弹出对齐

> ID：12611268
> 
> 赞同：0
> 
> 时间：2012-09-26T22:14:48.383
> 
> 标签：css, layout, calendar, alignment

我在我网站的右侧边栏中使用“自制”php 日历。该网站的正文是固定的 1000 像素。当日历上安排了活动的一天悬停在上面时，会显示一个 div，其中提供有关该活动的详细信息。这是一个视觉表示：

![在此处输入图像描述](../Images/6f4242f92b9030e9a7ae49233c9df84c.png)

这里的问题是事件框通常会超出主体的边界。在较小的显示器上，该框超出屏幕右侧，无法读取。我试着让它落在左边而不是右边，但这覆盖了主要文本区域并且看起来很奇怪。有什么办法可以让盒子向右下，但如果需要（在较小的屏幕上查看），被推到左边？我猜类似于浮点数。

谢谢。

**编辑**：对不起，我忘了提到我制作盒子的方式。它完全由 CSS 驱动。包含元素是相对定位的，而盒子是绝对定位的。它们保持在页面外（左：-9999px；）并在日历单元格悬停时显示。这个过程似乎更快捷。因此，定位元素以避免此问题是不可能的。

我不希望框位于单元格的左侧。我希望它位于右侧*，除非*由于访问者的屏幕尺寸而另有要求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:19:01.213

这更像是一个 CSS / Javascript 问题。

第一种方式：赋值{position:absolute; right:0} 到弹出 div 和 {position:relative} 到包含 div，所以它会一直浮动到左边。

第二种方式：使用javascript/jQuery计算弹出div的右边缘位置，如果div要戳出边缘，则修改左。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:19:36.553

对于 Javascript：

1.  检查文档的大小（找到最右边的像素）..
2.  检查框最右边的像素
3.  从 document.right 中减去 box.right 并将 box 向左移动该数量

对于 CSS：

使盒子的位置绝对和`right: -10;`

# javascript - 控制淡入淡出的动画

> ID：12611269
> 
> 赞同：0
> 
> 时间：2012-09-26T22:14:55.090
> 
> 标签：javascript, jquery, html, css

我有以下标记。

```
<ul id="ticker">
<li><q> Education, then, beyond all other devices of human origin, is the great equalizer of the conditions of men, the balance-wheel of the social machinery </q><cite>Horace Mann</cite></li>
<li><q> The roots of education are bitter, but the fruit is sweet </q><cite>Aristotle</cite></li>
<li><q> Education is what remains after one has forgotten everything he learned in school </q><cite>Albert Einstein</cite></li>
<li><q> Education is the most powerful weapon which you can use to change the world </q><cite>Nelson Mandela</cite></li>
<li><q> Formal education will make you a living; self-education will make you a fortune </q><cite>Jim Rohn</cite></li>
</ul> 
```

以及以下脚本

```
<script>
function tick()
{
$('#ticker li:first').animate({'opacity':0}, 2000, function () { $(this).appendTo($('#ticker')).css('opacity', 1); });
}
setInterval(function(){ tick () }, 8000);
</script> 
```

问题是文本很好地淡出，但会随着闪光灯重新出现。任何方式我都可以使淡入淡出也顺利。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T22:18:05.147

代替：

```
$(this).appendTo($('#ticker')).css('opacity', 1); 
```

执行以下操作：

```
$(this).appendTo($('#ticker')).animate({'opacity' : 1}, 2000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T22:21:19.887

检查[小提琴](http://jsfiddle.net/sushanth009/ffe6q/)

```
function tick() {
    $('#ticker li:first').animate({
        'opacity': 0
    },2000, function() {
        $(this).appendTo($('#ticker')).animate({'opacity' : 1}, 2000);
    });
}
setInterval(function() {
    tick()
}, 8000);​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T22:22:59.077

如果你使用 jQuery 效果`.fadeIn(time_in_ms)`&会更容易和更简洁`.fadeOut(time_in_ms)`。更多信息在这里：[http](http://api.jquery.com/fadeIn/) ://api.jquery.com/fadeIn/ & [http://api.jquery.com/fadeOut/](http://api.jquery.com/fadeOut/)。

例子：`$('#ticker li:first').fadeIn(1000);`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-26T22:23:36.270

这个怎么样？

```
var $ticker = $('#ticker'); // save the static element
function tick(){
    $ticker.children().first().fadeOut(2000, function () {
        $(this).appendTo($ticker).fadeIn(500);
    });
}
setInterval(tick, 8000); 
```

基于 susanth reddy 的[jsfiddle](http://jsfiddle.net/ffe6q/2/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-26T22:47:32.157

我认为你想要的是更像这样的东西：

```
var $ticker = $('#ticker'); // save the static element
$ticker.children(':not(:first-child)').hide();

function tick(){
    $ticker.children(':first-child').fadeOut(1000, function () {
        $(this).appendTo($ticker);
        $ticker.children().first().fadeIn(1000);
    });
}
setInterval(tick, 8000); 
```

[http://jsfiddle.net/ffe6q/3/](http://jsfiddle.net/ffe6q/3/)

一次显示一个项目，显示的项目淡出然后下一个项目淡入。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-10-06T02:09:55.947

如果你想制作幻灯片，这就是我想出的。的CSS：

```
ul{position: relative;}
li{position: absolute;}
li:not(:first-child){display: none;} 
```

和js：

```
function tick(){
  $('#ticker > li:first').fadeOut(1000).next().fadeIn(1000).end().appendTo('#ticker');
}
setInterval(function(){ tick () }, 8000); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-07T12:12:17.353

var $ticker = $('#ticker');

$ticker.children(':not(:first-child)').hide();

功能滴答（）{

```
$ticker.children(':first-child').fadeOut(1000, function () {

    $(this).appendTo($ticker);

    $ticker.children().first().fadeIn(1000);

}); 
```

} setInterval(tick, 8000)

# string - isapi 3 - 从域和子页面中删除所有查询字符串

> ID：12611274
> 
> 赞同：0
> 
> 时间：2012-09-26T22:15:31.937
> 
> 标签：string, isapi, isapi-rewrite

我想知道如何去掉所有查询字符串，即

```
domain.com/?a=123 -->> domain.com 
```

和

```
domain.com/page.asp?b=456 -->> domain.com/page.asp 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T03:24:08.663

罗伯特，我想这是我第三次回复你的问题了：

```
RewriteEngine on
RewriteBase /

RewriteCond %{QUERY_STRING} .+
RewriteRule (.*) /$1? [NC,NS,R=301,L] 
```

相信我，我知道这是一个很好的规则，但是我们需要知道它可能与之冲突的其他规则。

# javascript - 我将如何在 Ruby 中重写这个 JavaScript 循环？

> ID：12611279
> 
> 赞同：1
> 
> 时间：2012-09-26T22:15:47.883
> 
> 标签：javascript, ruby

代码：

```
var some_var = [/*.......*/];
var compare_var;
for (var i = 0; i < some_var.length - 1; i++){
    if (some_var[i] <= compare_var && compare_var < some_var[i + 1]){
        return some_var[i];
    }
} 
```

的一个值为`some_var`30，下一个值为 40，下一个值为 50 和`compare_var`42。

即使小于 42，它也不会返回 30，因为 42 不小于 40。这也意味着它会返回 40，因为它小于 42 并且 42 小于 50。

**编辑：**

正如有人提到的，代码翻译对于 SE.so 来说并不是很好。只是为了说清楚：我确实在 ruby​​ 中尝试了几种不同的东西。不过，我在 javascript 方面有更多经验，所以我能想到的表达我的问题的最好方法是用 javascript 写出我需要的东西，这样我就可以看到它是如何翻译成 ruby​​ 的。感谢您的回答

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T22:27:34.177

我会使用neato[`Enumerable#each_cons(n)`方法](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-each_cons)：

```
def foo(arr, x)
  arr.each_cons(2) do |a,b|
    return a if (a <= x) && (x < b)
  end
  nil # Not found
end

foo([30,40,50], 42) # => 40 
```

这基本上会为每对创建一个“滑动窗口”，然后当您找到包含目标值 (x) 的对时，您可以返回该对的第一项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T00:03:57.970

这是一个单行：

```
some_var.select{|v| v < compare_var}.max 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T22:18:52.920

去掉`var`关键字，把`for`循环改成`some_var.each`，你就得到了一个在 Ruby 中工作的代码。

PS。StackOverflow 中的代码翻译不正确

# java - 在 Java 中交换单词

> ID：12611281
> 
> 赞同：2
> 
> 时间：2012-09-26T22:16:05.023
> 
> 标签：java

我是 Java 新手，想交换两个输入到程序中然后保存为字符串的单词。我包含了一个 if 语句，以确保输入了我要切换的两个单词。

```
 Scanner in = new Scanner(System.in);
  System.out.println("Please enter at least one thing you love and one thing you hate using the words hate and love: ");
  String loveHate = in.nextLine();

  if (loveHate.indexOf( "love" ) == -1 || loveHate.indexOf( "hate" ) == -1 ){
    System.out.println("Please include the words love and hate.");
    return; 
  } 
```

我想取用户输入的句子并切换爱和恨这两个词，然后用切换的词重新打印一个新字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T22:19:30.360

一种粗略的方法，前提是您不希望输入中的文本“xxxx”是标准交换：

```
...
String loveHate = in.nextLine();

String hateLove = loveHate.replaceAll("love", "xxxx");
       hateLove = hateLove.replaceAll("hate", "love");
       hateLove = hateLove.replaceAll("xxxx", "hate");

System.out.println("Changed "+loveHate+" into "+hateLove); 
```

# php - MongoCursorException：MangoDB as_array() 中查询中的错误跳过值

> ID：12611286
> 
> 赞同：1
> 
> 时间：2012-09-26T22:16:26.803
> 
> 标签：php, mongodb, kohana, kohana-mangodb

我有一个名为“公司”的 mongo 集合，如下所示：

```
{
    "_id" : ObjectId("..."),
    "name" : "company_1",
    "active" : false,
    "projects" : [
        {
            "_id" : ObjectId("..."),
            "name" : "Prj_1",
            ...
        },
        {
            "_id" : ObjectId("..."),
            "name" : "Prj_2" ,
            ...
        }
    ],
    "rating" : 0,
    ...
}
... 
```

我使用[Kohana 3.2](http://kohanaframework.org/)作为我的框架和[MangoDb](https://github.com/Wouterrr/MangoDB/wiki)库。

我想编写一个函数来检索所有项目并为用户列出它们（[检索字段子集](http://www.mongodb.org/display/DOCS/Retrieving+a+Subset+of+Fields)）。

这是我的公司模型：

```
<?php

class Model_Company extends Mango {

    protected $_db = 'default';
    protected $_collection = 'companies';
    protected $_fields = array(
        'name' => array(
            'type' => 'string',
            'required' => TRUE,
        ),
        'active' => array(
            'type' => 'boolean',
        ),
        'rating' => array(
            'type' => 'float',
        ),

        'projects' => array(
            'type' => 'has_many',
        ),
        ...
        ...
    );

    public function data_list($from = 0, $limit = 10, $sort = NULL)
    {
        return Mango::factory('company')->load(array( 'limit' => $limit, 'sort' => $sort, 'skip' => $from ));
    }

} 
```

这是嵌入式项目模型：

```
<?php

class Model_Project extends Mango {

    protected $_embedded = TRUE;
    protected $_db = 'default';
    //protected $_collection = 'projects';
    protected $_fields = array(
        '_id' => array(
            'type' => 'MongoId'
        ),
        'name' => array(
            'type' => 'string',
            'required' => TRUE,
        ),
        ...
        ...

    );

    public function data_list($from = 0, $limit = 10, $sort = NULL)
    {
        return Mango::factory('company')->load(array(
            'limit' => $limit, 
            'sort' => $sort, 
            'skip' => $from ,
            'fields'=>array('projects' => TRUE)
         ));
    }

} 
```

当我尝试运行以下行时：

```
$projects_list = Mango::factory('project')->data_list($from, $this->list_items_per_page)->as_array(); 
```

我收到下面列出的错误消息：

```
MongoCursorException [ 10105 ]: bad skip value in query

MODPATH\mongo\classes\mango\iterator.php [ 108 ]

103     /**
104      * Iterator: rewind
105      */
106     public function rewind()
107     {
108         $this->_cursor->rewind();
109     }
110 
111     /**
112      * Iterator: valid
113      */ 
```

这个错误的原因是什么，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T16:16:45.750

当您将“跳过”值传递给小于 0 的查询时，会出现此错误。我建议将您作为“跳过”传入的值打印到“工厂”函数以进行确认。

不知道您的数据或调用该特定行的位置，我无法确切说明为什么要传入负数，但这就是错误的原因。

# coldfusion - 使用 Coldfusion 循环通过 jquery ajax 例程提交的数据

> ID：12611290
> 
> 赞同：2
> 
> 时间：2012-09-26T22:16:47.060
> 
> 标签：coldfusion

如果 FF firebug 窗口，我看到这被传递到我的coldfusion操作页面：

```
RowOrder[]=&RowOrder[]=row_5&RowOrder[]=row_2&RowOrder[]=row_1&RowOrder[]=row_3&RowOrder[]=row_4&RowOrder[]=row_6&RowOrder[]=row_7&RowOrder[]=row_8&RowOrder[]=row_11 
```

现在我需要遍历它以获取更新的排序顺序，但由于 []，我遇到了问题。我怎样才能循环这个，以便我可以更新我的表？？？我希望这是容易的部分，但我显然错过了一些东西。

**+**我正在使用 jquery 插件 (http://www.isocra.com/2008/02/table-drag-and-drop-jquery-plugin/)。**+**

这是我用来循环提交数据的代码：

```
<cfif StructKeyExists(form, "RowOrder")>
<!---<cfset variables.Order = ReReplaceNoCase(form.RowOrder, "(&){0,1}row_\[\]=", ",", "all") />--->    
<cfset variables.Order = ReplaceNoCase(form["RowOrder[]"],"row_","","all")>
<cfloop from="1" to="#ListLen(variables.Order)#" index="index">
<cfquery name="qryOrder" datasource="#dsn#">
update  SystemTypes
set Order = <cfqueryparam value="#index#" cfsqltype="cf_sql_integer" />
where WETypeNum = <cfqueryparam value="#ListGetAt(variables.Order, index)#" cfsqltype="cf_sql_integer" />
</cfquery>
</cfloop>
</cfif> 
```

**+**我使用的 ajax 代码如下：

```
$("#RowOrder").tableDnD({
    onDrop: function(table, row) {
        var RowOrderData = $.tableDnD.serialize();
        $.ajax({
            type: 'POST',
            url: '../../ajax/UpdateListingOrder.cfm',
            cache: false,
            data:  RowOrderData
        });
    }   
}); 
```

**+**

**+**表示发布问题后添加的信息

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:53:08.347

问题是如何表现出来的？您是否收到错误，查询未执行，..？

转储`FORM`范围以验证正在传递的字段名称？它看起来像`FORM['RowOrder[]']`而不是`form.RowOrder`. 在这种情况下，您需要使用：

```
<cfif StructKeyExists(form, "RowOrder[]")>
    <cfset variables.Order = ReReplaceNoCase(form["RowOrder[]"], "(&){0,1}row_\[\]=", ",", "all") />
    ... rest of code ...
<cfelse>
    oops, that variable name does not exist
</cfif> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:06:19.537

你能不匹配数字而不是替换吗？

我已经在循环中完成了正则表达式匹配 - 然后您可以一次只关注字符串的一部分。

该方法的说明：

```
<cfif structKeyExists(form, "rowOrder")>
  <cfset data = listToArray(form.rowOrder, "&")/>
  <cfif not arrayIsEmpty(data)>
    <cfloop form="1" to="#arrayLen(data)#" index="index">
      <cfset match = reFind("[1-9][0-9]+", data[index], 1, true)/>
      <cfif arraySum(match)>
        <cfset weTypeNumber = val(mid(data[index], match["pos"], match["len"]))/> 
        <cfquery name="qryOrder" datasource="#dsn#">
         UPDATE
            system_types
          SET 
            order = <cfqueryparam cfsqltype="cf_sql_integer" value="#index#"/>
          WHERE
            we_type_num = <cfqueryparam cfsqltype="cf_sql_integer" value="#weTypeNumber#"/>
        </cfquery>
      </cfif>
    </cfloop>
  </cfif>
</cfif> 
```

# objective-c - UICollectionView 断言失败

> ID：12611292
> 
> 赞同：61
> 
> 时间：2012-09-26T22:16:56.677
> 
> 标签：objective-c, ios6, uicollectionview

我在执行`insertItemsAtIndexPaths`时收到此错误`UICollectionView`

断言失败：

```
-[UICollectionViewData indexPathForItemAtGlobalIndex:], 
/SourceCache/UIKit/UIKit-2372/UICollectionViewData.m:442
2012-09-26 18:12:34.432  
*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', 
reason: 'request for index path for global index 805306367 
when there are only 1 items in the collection view' 
```

我已经检查过了，我的数据源只包含一个元素。关于为什么会发生这种情况的任何见解？如果需要更多信息，我绝对可以提供。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-10-19T18:08:56.527

将第一个单元格插入集合视图时，我遇到了同样的问题。我通过更改代码来解决问题，以便调用 UICollectionView

```
- (void)reloadData 
```

插入第一个单元格时的方法，但是

```
- (void)insertItemsAtIndexPaths:(NSArray *)indexPaths 
```

插入所有其他单元格时。

*有趣的是，我也遇到了*问题

```
- (void)deleteItemsAtIndexPaths:(NSArray *)indexPaths 
```

删除最后一个单元格时。我做了和以前一样的事情：`reloadData`删除最后一个单元格时调用。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-18T23:17:13.903

在插入单元格之前插入 section#0 似乎让 UICollectionView 很高兴。

```
NSArray *indexPaths = /* indexPaths of the cells to be inserted */
NSUInteger countBeforeInsert = _cells.count;
dispatch_block_t updates = ^{
    if (countBeforeInsert < 1) {
        [self.collectionView insertSections:[NSIndexSet indexSetWithIndex:0]];
    }
    [self.collectionView insertItemsAtIndexPaths:indexPaths];
};
[self.collectionView performBatchUpdates:updates completion:nil]; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-06T22:55:19.680

我在这里发布了解决此问题的方法：[https ://gist.github.com/iwasrobbed/5528897](https://gist.github.com/iwasrobbed/5528897)

在`.m`文件顶部的私有类别中：

```
@interface MyViewController ()
{
    BOOL shouldReloadCollectionView;
    NSBlockOperation *blockOperation;
}
@end 
```

那么您的委托回调将是：

```
- (void)controllerWillChangeContent:(NSFetchedResultsController *)controller
{
    shouldReloadCollectionView = NO;
    blockOperation = [NSBlockOperation new];
}

- (void)controller:(NSFetchedResultsController *)controller didChangeSection:(id<NSFetchedResultsSectionInfo>)sectionInfo
           atIndex:(NSUInteger)sectionIndex forChangeType:(NSFetchedResultsChangeType)type
{
    __weak UICollectionView *collectionView = self.collectionView;
    switch (type) {
        case NSFetchedResultsChangeInsert: {
            [blockOperation addExecutionBlock:^{
                [collectionView insertSections:[NSIndexSet indexSetWithIndex:sectionIndex]];
            }];
            break;
        }

        case NSFetchedResultsChangeDelete: {
            [blockOperation addExecutionBlock:^{
                [collectionView deleteSections:[NSIndexSet indexSetWithIndex:sectionIndex]];
            }];
            break;
        }

        case NSFetchedResultsChangeUpdate: {
            [blockOperation addExecutionBlock:^{
                [collectionView reloadSections:[NSIndexSet indexSetWithIndex:sectionIndex]];
            }];
            break;
        }

        default:
            break;
    }
}

- (void)controller:(NSFetchedResultsController *)controller didChangeObject:(id)anObject atIndexPath:(NSIndexPath *)indexPath forChangeType:(NSFetchedResultsChangeType)type newIndexPath:(NSIndexPath *)newIndexPath
{
    __weak UICollectionView *collectionView = self.collectionView;
    switch (type) {
        case NSFetchedResultsChangeInsert: {
            if ([self.collectionView numberOfSections] > 0) {
                if ([self.collectionView numberOfItemsInSection:indexPath.section] == 0) {
                    shouldReloadCollectionView = YES;
                } else {
                    [blockOperation addExecutionBlock:^{
                        [collectionView insertItemsAtIndexPaths:@[newIndexPath]];
                    }];
                }
            } else {
                shouldReloadCollectionView = YES;
            }
            break;
        }

        case NSFetchedResultsChangeDelete: {
            if ([self.collectionView numberOfItemsInSection:indexPath.section] == 1) {
                shouldReloadCollectionView = YES;
            } else {
                [blockOperation addExecutionBlock:^{
                    [collectionView deleteItemsAtIndexPaths:@[indexPath]];
                }];
            }
            break;
        }

        case NSFetchedResultsChangeUpdate: {
            [blockOperation addExecutionBlock:^{
                [collectionView reloadItemsAtIndexPaths:@[indexPath]];
            }];
            break;
        }

        case NSFetchedResultsChangeMove: {
            [blockOperation addExecutionBlock:^{
                [collectionView moveItemAtIndexPath:indexPath toIndexPath:newIndexPath];
            }];
            break;
        }

        default:
            break;
    }
}

- (void)controllerDidChangeContent:(NSFetchedResultsController *)controller
{
    // Checks if we should reload the collection view to fix a bug @ http://openradar.appspot.com/12954582
    if (shouldReloadCollectionView) {
        [self.collectionView reloadData];
    } else {
        [self.collectionView performBatchUpdates:^{
            [blockOperation start];
        } completion:nil];
    }
} 
```

这种方法的功劳归功于 Blake Watters。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-09-20T09:53:36.207

这是对该问题的非黑客，基于文档的答案。就我而言，有一个条件，根据该条件，我将从`collectionView:viewForSupplementaryElementOfKind:atIndexPath:`. 遇到崩溃后，我检查了文档，这是他们所说的：

> 此方法必须始终返回有效的视图对象。如果您在特定情况下不想要补充视图，则您的布局对象不应为该视图创建属性。或者，您可以通过将相应属性的 hidden 属性设置为 YES 或将属性的 alpha 属性设置为 0 来隐藏视图。要在流布局中隐藏页眉和页脚视图，您还可以设置这些视图的宽度和高度为 0。

还有其他方法可以做到这一点，但最快的方法似乎是：

```
- (CGSize)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewFlowLayout *)collectionViewLayout referenceSizeForHeaderInSection:(NSInteger)section {
    return <condition> ? collectionViewLayout.headerReferenceSize : CGSizeZero;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-05-01T23:39:20.867

我的集合视图从两个数据源获取项目并更新它们导致了这个问题。我的解决方法是将数据更新和集合视图重新加载一起排队：

```
[[NSOperationQueue mainQueue] addOperationWithBlock:^{

                //Update Data Array
                weakSelf.dataProfile = [results lastObject]; 

                //Reload CollectionView
                [weakSelf.collectionView reloadItemsAtIndexPaths:@[[NSIndexPath indexPathForItem:0 inSection:0]]];
 }]; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-27T03:58:48.177

检查您是否在`UICollectionViewDataSource`方法中返回正确数量的元素：

```
- (NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section 
```

和

```
- (NSInteger)numberOfSectionsInCollectionView:(UICollectionView *)collectionView 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-25T17:27:32.343

我也遇到了这个问题。这是发生在我身上的事情：

1.  我将 UICollectionViewController 子类化，并且`initWithCollectionViewLayout:`正在初始化我的`NSFetchedResultsController`.
2.  让共享类从 NSURLConnection 获取结果并解析 JSON 字符串（不同的线程）
3.  循环浏览提要并创建 my `NSManagedObjects`，将它们添加到 my `NSManagedObjectContext`，它的主线程`NSManagedObjectContext`为`parentContext`.
4.  保存我的上下文。
5.  让我`NSFetchedResultsController`拿起更改并将它们排队。
6.  在 上`- (void)controllerDidChangeContent:`，我将处理更改并将它们应用到我的`UICollectionView`.

间歇性地，我会收到 OP 遇到的错误，但不知道为什么。

为了解决这个问题，我将`NSFetchedResultsController`初始化移到了`performFetch`我的`- viewDidLoad`方法中，这个问题现在已经消失了。无需打电话`[collectionView reloadData]`或任何事情，所有动画都可以正常工作。

希望这可以帮助！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-22T16:01:43.837

当您将单元格插入或移动到包含补充页眉或页脚视图（带有`UICollectionViewFlowLayout`或从中派生的布局）的部分并且该部分在插入/移动之前的单元格计数为 0 时，似乎会出现问题。

我只能通过在包含补充标题视图的部分中有一个空且不可见的单元格来避免崩溃并仍然保持动画，如下所示：

1.  `- (NSInteger)collectionView:(UICollectionView *)view numberOfItemsInSection:(NSInteger)section`为标题视图所在的部分返回实际的单元格`count + 1 。
2.  作为`- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath`回报

    ```
    if ((indexPath.section == YOUR_SECTION_WITH_THE_HEADER_VIEW) && (indexPath.item == [self collectionView:collectionView numberOfItemsInSection:indexPath.section] - 1)) {
            cell = [collectionView dequeueReusableCellWithReuseIdentifier:@"EmptyCell" forIndexPath:indexPath];
    } 
    ```

    ...该位置的空单元格。`viewDidLoad`请记住在初始化 UICollectionView的地方或任何地方注册单元重用：

    ```
    [self.collectionView registerClass:[UICollectionReusableView class] forCellWithReuseIdentifier:@"EmptyCell"]; 
    ```

3.  使用`moveItemAtIndexPath:`或`insertItemsAtIndexPaths:`不崩溃。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-03-07T16:27:18.533

这是我在项目中一直使用的这个错误的解决方案，我想我会在这里发布，以防有​​人发现它有价值。

```
@interface FetchedResultsViewController ()

@property (nonatomic) NSMutableIndexSet *sectionsToAdd;
@property (nonatomic) NSMutableIndexSet *sectionsToDelete;

@property (nonatomic) NSMutableArray *indexPathsToAdd;
@property (nonatomic) NSMutableArray *indexPathsToDelete;
@property (nonatomic) NSMutableArray *indexPathsToUpdate;

@end 
```

```
#pragma mark - NSFetchedResultsControllerDelegate

- (void)controllerWillChangeContent:(NSFetchedResultsController *)controller
{
    [self resetFetchedResultControllerChanges];
}

- (void)controller:(NSFetchedResultsController *)controller didChangeSection:(id <NSFetchedResultsSectionInfo>)sectionInfo
           atIndex:(NSUInteger)sectionIndex forChangeType:(NSFetchedResultsChangeType)type
{
    switch(type)
    {
        case NSFetchedResultsChangeInsert:
            [self.sectionsToAdd addIndex:sectionIndex];
            break;

        case NSFetchedResultsChangeDelete:
            [self.sectionsToDelete addIndex:sectionIndex];
            break;
    }
}

- (void)controller:(NSFetchedResultsController *)controller didChangeObject:(id)anObject
       atIndexPath:(NSIndexPath *)indexPath forChangeType:(NSFetchedResultsChangeType)type
      newIndexPath:(NSIndexPath *)newIndexPath
{
    switch(type)
    {
        case NSFetchedResultsChangeInsert:
            [self.indexPathsToAdd addObject:newIndexPath];
            break;

        case NSFetchedResultsChangeDelete:
            [self.indexPathsToDelete addObject:indexPath];
            break;

        case NSFetchedResultsChangeUpdate:
            [self.indexPathsToUpdate addObject:indexPath];
            break;

        case NSFetchedResultsChangeMove:
            [self.indexPathsToAdd addObject:newIndexPath];
            [self.indexPathsToDelete addObject:indexPath];
            break;
    }
}

- (void)controllerDidChangeContent:(NSFetchedResultsController *)controller
{
    if (self.sectionsToAdd.count > 0 || self.sectionsToDelete.count > 0 || self.indexPathsToAdd.count > 0 || self.indexPathsToDelete > 0 || self.indexPathsToUpdate > 0)
    {
        if ([self shouldReloadCollectionViewFromChangedContent])
        {
            [self.collectionView reloadData];

            [self resetFetchedResultControllerChanges];
        }
        else
        {
            [self.collectionView performBatchUpdates:^{

                if (self.sectionsToAdd.count > 0)
                {
                    [self.collectionView insertSections:self.sectionsToAdd];
                }

                if (self.sectionsToDelete.count > 0)
                {
                    [self.collectionView deleteSections:self.sectionsToDelete];
                }

                if (self.indexPathsToAdd.count > 0)
                {
                    [self.collectionView insertItemsAtIndexPaths:self.indexPathsToAdd];
                }

                if (self.indexPathsToDelete.count > 0)
                {
                    [self.collectionView deleteItemsAtIndexPaths:self.indexPathsToDelete];
                }

                for (NSIndexPath *indexPath in self.indexPathsToUpdate)
                {
                    [self configureCell:[self.collectionView cellForItemAtIndexPath:indexPath]
                            atIndexPath:indexPath];
                }

            } completion:^(BOOL finished) {
                [self resetFetchedResultControllerChanges];
            }];
        }
    }
}

// This is to prevent a bug in UICollectionView from occurring.
// The bug presents itself when inserting the first object or deleting the last object in a collection view.
// http://stackoverflow.com/questions/12611292/uicollectionview-assertion-failure
// This code should be removed once the bug has been fixed, it is tracked in OpenRadar
// http://openradar.appspot.com/12954582
- (BOOL)shouldReloadCollectionViewFromChangedContent
{
    NSInteger totalNumberOfIndexPaths = 0;
    for (NSInteger i = 0; i < self.collectionView.numberOfSections; i++)
    {
        totalNumberOfIndexPaths += [self.collectionView numberOfItemsInSection:i];
    }

    NSInteger numberOfItemsAfterUpdates = totalNumberOfIndexPaths;
    numberOfItemsAfterUpdates += self.indexPathsToAdd.count;
    numberOfItemsAfterUpdates -= self.indexPathsToDelete.count;

    BOOL shouldReload = NO;
    if (numberOfItemsAfterUpdates == 0 && totalNumberOfIndexPaths == 1)
    {
        shouldReload = YES;
    }

    if (numberOfItemsAfterUpdates == 1 && totalNumberOfIndexPaths == 0)
    {
        shouldReload = YES;
    }

    return shouldReload;
}

- (void)resetFetchedResultControllerChanges
{
    [self.sectionsToAdd removeAllIndexes];
    [self.sectionsToDelete removeAllIndexes];
    [self.indexPathsToAdd removeAllObjects];
    [self.indexPathsToDelete removeAllObjects];
    [self.indexPathsToUpdate removeAllObjects];
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-03-18T16:38:39.260

就我而言，问题在于我创建`NSIndexPath`. 例如，要删除第三个单元格，而不是这样做：

```
NSIndexPath* indexPath = [NSIndexPath indexPathWithIndex:2];
[_collectionView deleteItemsAtIndexPaths:@[indexPath]]; 
```

我需要做：

```
NSIndexPath* indexPath = [NSIndexPath indexPathForItem:2 inSection:0];
[_collectionView deleteItemsAtIndexPaths:@[indexPath]]; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-05-24T21:00:39.640

检查您是否返回了正确的值`numberOfSectionsInCollectionView:`

我用来计算截面的值是零，因此是`0`截面。这导致了异常。

```
- (NSInteger)numberOfSectionsInCollectionView:(UICollectionView *)collectionView {
    NSInteger sectionCount = self.objectThatShouldHaveAValueButIsActuallyNil.sectionCount;

    // section count is wrong!

    return sectionCount;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-04-26T13:36:56.550

只是为了记录，我遇到了同样的问题，对我来说，解决方案是删除标题（在 .xib 中禁用它们），因为不再需要它们，所以删除了这个方法。之后一切似乎都很好。

```
- (UICollectionReusableView *)collectionView:(UICollectionView *)collectionView viewForSupplementary
ElementOfKind:(NSString *)kind atIndexPath:(NSIndexPath *)indexPath 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-06-18T08:05:05.363

我自己遇到了这个问题。这里的所有答案似乎都存在问题，除了 Alex L 的。参考更新似乎是答案。这是我的最终解决方案：

```
- (void)addItem:(id)item {
    [[NSOperationQueue mainQueue] addOperationWithBlock:^{
        if (!_data) {
            _data = [NSMutableArray arrayWithObject:item];
        } else {
            [_data addObject:item];
        }
        [_collectionView insertItemsAtIndexPaths:@[[NSIndexPath indexPathForItem:_data.count-1 inSection:0]]];
    }];
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-08-23T21:11:10.607

实际可行的解决方法是，如果补充视图的索引路径上的单元格不存在（初始加载、您已删除该行等），则返回高度 0。在这里查看我的答案：

[https://stackoverflow.com/a/18411860/917104](https://stackoverflow.com/a/18411860/917104)

# common-lisp - 使用 RESTAS 和 Hunchentoot 进行用户身份验证

> ID：12611293
> 
> 赞同：2
> 
> 时间：2012-09-26T22:17:14.050
> 
> 标签：common-lisp, hunchentoot

（我使用 Hunchentoot 和 Restas，只是想我也会在这里提到它）

我真的不知道如何用 HTTP 做这些事情，所以我认为发布我的代码可能是表达我意图的最简单方法：

```
(define-route log-in ("/log-in/" :method :post)
  (multiple-value-bind (username pwd) (hunchentoot:authorization)
    (cond ((and (nth-value 1 (gethash username *users*)) ;; User exists
                (string= pwd (gethash username *users*)))) ;; Password is correct
          ;; Do something to keep track of logged in user
          ))) 
```

我基本上只是想让用户登录，给他某种方式说“嘿，又是我”，以及某种方式让我说“哦，嘿！又*是*你，给你”和然后为用户提供网页。我认为这应该使用 cookie 来完成，并且只需将一些值存储在一个可以根据 cookie 进行检查的列表中。

我应该如何使用 Hunchentoot+Restas 正确执行此操作？代码和一些解释真的很棒，我在这里很迷茫。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:09:11.137

您可能想要使用`(start-session)`然后添加如下方法：

```
(defmethod handle-request :before ((acceptor acceptor) (request request))
   (unless (your-check-request-matches-login-page) ; skip session check on login page
       (if (null *session*)
          (redirect "/log-in")
          (progn
             (your-check-session-validity)
             (other-stuff))))) 
```

如果您需要使用登录页面进行身份验证，上述方法将起作用。但是您需要另一种方法来从用户那里获取用户名和密码，这`(authorization)`将为您提供浏览器在标头中发送的内容，即基本身份验证。

如果你真的想使用 basic-auth，那么浏览器会弹出一个对话框来询问用户凭据，所以你不需要登录页面。您需要以下方法来拦截所有请求并发送适当的标头：

```
(defmethod handle-request :before ((acceptor acceptor) (request request))
    (multiple-value-bind (username pwd) (hunchentoot:authorization)
        (if (and (nth-value 1 (gethash username *users*)) ;; User exists
                 (string= pwd (gethash username *users*))) ;; Password is correct
            (progn
                ;; Do something here
            )

            (require-authorization "realm")))) 
```

# emacs - 在 slime-autodoc 中：进程过滤器中的错误：错误的类型参数：sequencep，：not-available

> ID：12611295
> 
> 赞同：1
> 
> 时间：2012-09-26T22:17:26.233
> 
> 标签：emacs, slime, autodoc

当我使用 slime-repl 时，我在我的 minibuffer 中收到这条消息，并且 emacs 会挂起一秒钟：

进程过滤器中的错误：错误的类型参数：sequencep，：不可用

当我关闭 slime-autodoc-mode 时它停止发生

有人见过吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-26T10:23:43.647

从此[错误报告](https://github.com/swank-js/swank-js/issues/40)

> **joddie 评论说：** 我遇到了同样的问题。经过粗略调查，这似乎与启用 slime/contrib 中的 slime-fancy 模块有关。slime-fancy 是启用许多不同的 slime 模块的快捷方式，我不确定哪个是问题的实际根源，但禁用它似乎至少可以解决这里的问题。
> 
> （这是使用最新的 Git/CVS 版本的 slime 和 slime-js，尽管我也尝试回滚到 2010-02-12 版本的 slime 以防万一；它没有任何区别）。
> 
> **鬼评论：** @joddie：我只是尝试一下并删除粘液，它确实有效。现在我把
> 
> (slime-setup '(slime-js slime-repl))
> 
> 在我的 .emacs 中。在此之前，即使我的选项卡已经绑定到 slime-indent-and-complete-symbol，我也无法在节点中使用自动完成功能。谢谢。:)

对于那些使用 quicklisp 和 slime-helper 来管理他们的 slime 设置的人，请打开 quicklisp/slime-helper.el 以找到使用**(slime-setup)**的地方。

# c# - C# - 从另一个 AppDomain 中的方法返回值

> ID：12611296
> 
> 赞同：4
> 
> 时间：2012-09-26T22:17:31.017
> 
> 标签：c#, appdomain

我有一个场景，我从 C# 代码中的操作将 DLL 添加到 GAC。然后我需要对新添加的 DLL 执行 Assembly.Load。但是，由于进程启动时 DLL 不在 GAC 中，因此它返回 null。

所以，我看到代码可以在不同的 AppDomain 中运行，这将导致 DLL 可以从单独的 AppDomain 中的 GAC 获得。

如何将另一个 AppDomain 的值返回到我的主线程？

我只是想运行：

```
var type = Assembly.Load(assembly).GetType(className); 
```

并让它从另一个 AppDomain 返回到我的主线程。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-26T22:56:47.160

您将不得不使用 .NET Remoting 进行一些操作。您在另一个 AppDomain 上加载的对象需要从 MarshalByRefObject 类 ( [http://msdn.microsoft.com/en-us/library/system.marshalbyrefobject.aspx](http://msdn.microsoft.com/en-us/library/system.marshalbyrefobject.aspx) ) 派生。

只是为了节省时间，这是该链接中的代码：

```
using System;
using System.Reflection;

public class Worker : MarshalByRefObject
{
    public void PrintDomain() 
    { 
        Console.WriteLine("Object is executing in AppDomain \"{0}\"",
            AppDomain.CurrentDomain.FriendlyName); 
    }
}

class Example
{
    public static void Main()
    {
        // Create an ordinary instance in the current AppDomain
        Worker localWorker = new Worker();
        localWorker.PrintDomain();

        // Create a new application domain, create an instance 
        // of Worker in the application domain, and execute code 
        // there.
        AppDomain ad = AppDomain.CreateDomain("New domain");
        Worker remoteWorker = (Worker) ad.CreateInstanceAndUnwrap(
            Assembly.GetExecutingAssembly().FullName,
            "Worker");
        remoteWorker.PrintDomain();
    }
}

/* This code produces output similar to the following:

Object is executing in AppDomain "source.exe"
Object is executing in AppDomain "New domain"
 */ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-26T23:03:39.137

一般来说，应用程序域之间共享的对象必须派生自[MarshalByRefObject](http://msdn.microsoft.com/en-us/library/system.marshalbyrefobject.aspx)。如果类型是在动态加载的 DLL 中定义的，则返回实际类型会出现问题。由于该类型在主线程的 AppDomain 中不可用。您可以将其转换为已在主应用程序线程中加载的 DLL 中可用的基类。

我过去所做的是为我想在应用程序域之间共享的类创建一个接口。显然，该接口将位于主应用程序和动态加载的 dll 共享的一些基本 dll 中。

在您的基础 dll 中，您可以声明您的接口：

```
public interface IMyBaseInterface
{
     void DoStuff();
} 
```

然后在动态加载的dll中，该类实现接口并派生自MarshalByRefObject：

```
public class MyDynamicClass : MarshalByRefObject, IMyBaseInterface
{
    public void DoStuff()
    {
        Console.WriteLine("Hello other app domain!");
    }
} 
```

加载对象实例的代码如下所示：

```
AppDomainSetup ads = new AppDomainSetup();
AppDomain appDomain = AppDomain.CreateDomain(_appDomainName, null, ads);
IMyBaseInterface myObj = (IMyBaseInterface) appDomain.CreateInstanceAndUnwrap(assemblyName, typeName);
myObj.DoStuff(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-26T23:06:09.667

当您通过 AppDomain 边界“泄漏”对象（在您的情况下隐式或显式）时，必须将实现程序集加载到两个域中。

正如您已经注意到的，在第一次从 AppDomain 中的程序集向一个类请求时，程序集不在 GAC 中，不会加载到 AppDomain（事实上它不是 GAC 被缓存到 AppDomain 生命周期结束，因为它不是预计装配会神奇地出现在 GAC 中）。

我认为您必须在新的 AppDomain 中保留来自新 GAC 程序集的类。

# ruby-on-rails - bootstrap ：要导入的文件未找到或不可读

> ID：12611298
> 
> 赞同：5
> 
> 时间：2012-09-26T22:17:37.303
> 
> 标签：ruby-on-rails

我已经找到了一些关于我的问题的主题，但我不明白应该如何解决它。

我正在关注[http://ruby.railstutorial.org/chapters/filling-in-the-layout#fnref-5_5](http://ruby.railstutorial.org/chapters/filling-in-the-layout#fnref-5_5)教程并通过在 app/assets/stylesheets/custom.css.scss 中导入引导程序而陷入困境。

那是我的 Gemfile：

```
source 'https://rubygems.org'
gem 'bootstrap-sass', '2.0.4'
gem 'rails', '3.2.8'

group :development, :test do
gem 'sqlite3', '1.3.5'
gem 'rspec-rails', '2.11.0'
end

Gems used only for assets and not required
in production environments by default.
group :assets do
gem 'sass-rails', '3.2.5'
gem 'coffee-rails', '3.2.2'
gem 'uglifier', '1.2.3'
end

gem 'jquery-rails', '2.0.2'

group :test do
gem 'capybara', '1.1.2'
end

group :production do
gem 'pg', '0.12.2'
end 
```

我在 localhost/sample_app/home 上遇到了什么错误

```
Sass::SyntaxError in Static_pages#home

Showing c:/Users/katja/Arbeit/rails_projects/sample_app/app/views/layouts/application.html.erb where line #5 raised:

File to import not found or unreadable: bootstrap.
Load path: Sass::Rails::Importer(c:/Users/katja/Arbeit/rails_projects/sample_app/app/assets/stylesheets/custom.css.scss)
(in c:/Users/katja/Arbeit/rails_projects/sample_app/app/assets/stylesheets/custom.css.scss)
Extracted source (around line #5):

2: 
3:

4: <%= full_title(yield(:title)) %>
5: <%= stylesheet_link_tag "application", media: "all" %>
6: <%= javascript_include_tag "application" %>
7: <%= csrf_meta_tags %>
8: <!--[if lt IE 9]>
Rails.root: c:/Users/katja/Arbeit/rails_projects/sample_app
Application Trace | Framework Trace | Full Trace
app/assets/stylesheets/custom.css.scss:1
app/views/layouts/application.html.erb:5:in `app_views_layouts_application_html_erb_16020705_20168520' 
```

我正在使用 Windows 和 GitBash。我已经尝试删除 tmp/cache，它没有帮助。一切运行完美，但是当我添加 @import "bootstrap"; 到 cusom.css.scss，我得到一个错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-07T17:27:43.823

重新启动 Web 服务器“rails s”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T12:38:16.900

我不得不重新启动服务器 ps aux | grep 轨道杀死 -9 12345

其中 12345 是进程号

（不确定是否有另一种方法可以重新启动 Rails？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T16:16:14.317

```
 source 'https://rubygems.org'
  gem 'rails', '3.2.8'

  group :development, :test do
  gem 'sqlite3', '1.3.5'
  gem 'rspec-rails', '2.11.0'
  end

  Gems used only for assets and not required
  in production environments by default.
  group :assets do
  gem 'sass-rails', '3.2.5'
  gem 'bootstrap-sass', '2.0.4'
  gem 'coffee-rails', '3.2.2'
  gem 'uglifier', '1.2.3'
  end

  gem 'jquery-rails', '2.0.2'

  group :test do
  gem 'capybara', '1.1.2'
  end

  group :production do
  gem 'pg', '0.12.2'
  end 
```

将你的 bootstrap-sass gem 添加到 assets 块中

# javascript - 选择具有特定 id 的 div 元素时出错 - jQuery、javascript 的初学者

> ID：12611301
> 
> 赞同：0
> 
> 时间：2012-09-26T22:17:46.177
> 
> 标签：javascript, jquery, dom, jquery-selectors

我正在使用 jQuery 在 DOM 中选择元素，我尝试了以下操作：

```
$(document).ready(function() {

      $("a").toggle(function(){
        $("div[@id=SomeID]").hide('slow');
        },function(){
        $("div[@id=SomeID]").show('fast');
       });

}); 
```

在 html 源代码中，我确实有这个部分：

```
<div id="SomeID">

      <!-- div code -->

</div> 
```

但是，当我单击锚标记时，出现以下错误：

语法错误，无法识别的表达式：div[@id=SomeID]

关于这里出了什么问题的任何想法？我是 jQuery 和 javaScript 的初学者，非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T22:19:04.670

要`id`在 jQuery 中按元素选择元素，请使用与 CSS 中相同的语法：

```
$('#someID'); 
```

要使用属性等于选择器格式，请使用：

```
$('div[id="someID"]'); 
```

参考：

*   [jQuery 选择器](http://api.jquery.com/category/selectors/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:28:17.167

您正在使用错误的选择器。ID 必须以**#开头**

这些是有效的

```
$("#SomeID").hide('slow'); //  element with id SomeID , can be any element
$("div#SomeID").hide('slow'); //  Div with id SomeID
$("div[id=SomeID]").hide('slow'); //  Div with id SomeID
$("div[id^=SomeID]").hide('slow'); //  Div id that starts with SomeID
$("div[id*=SomeID]").hide('slow'); //  Div id that has SomeID in its id attribute
$("div[id=SomeID]").hide('slow'); //  Div id that ends with SomeID 
```

# javascript - 从函数参数创建数组列表

> ID：12611302
> 
> 赞同：1
> 
> 时间：2012-09-26T22:17:54.583
> 
> 标签：javascript, jquery

我有一个非常简单的问题，我需要从函数参数创建一个数组列表，到目前为止，我设法一一提醒他们，但无法创建一个列表：

```
<span onclick="show_flights(1,2,3,4);">text</span> 
```

和功能

```
function show_flights() {
    var list='';
    for (var x = 0; x < arguments.length; x++) {
        alert(arguments[x]);
        list.append(arguments[x]);
    };
alert(list); 
```

谢谢大家的帮助，我真的很感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T22:19:54.493

您可以直接将`arguments`对象转换为数组：

```
function show_flights() {
    var list = Array.prototype.slice.call(arguments, 0);
    alert(list);
} 
```

如果您对它实际工作的方式/原因感兴趣，请阅读 ECMAScript 规范，特别是有关[`Array.prototype.slice`](http://es5.github.com/#x15.4.4.10)方法的部分。简而言之，该方法将尝试从调用它的对象（其`this`值）创建一个数组，方法是迭代其属性并将它们添加到该新数组（通过内部机制`[[DefineOwnProperty]]`）。

# ruby-on-rails - Ruby on Rails - 在 habtm 关系中创建子表

> ID：12611306
> 
> 赞同：1
> 
> 时间：2012-09-26T22:18:09.900
> 
> 标签：ruby-on-rails, ruby, parent, parent-child, has-and-belongs-to-many

我有一个可以很好地创建的表列表。然后，我希望能够通过单击父级上的编辑（转到 edit.html.erb）然后单击“新建子级”来创建子表。父子表的关系是has_and_belongs_to_many。

```
<%= button_to 'New Child', new_parent_child_path([@parent, @parent.children.build]), :method => :get %> 
```

这是新子表单的链接，产生以下错误：

```
'undefined method `children' for nil:NilClass' 
```

服务器日志给了我以下信息：

```
Started GET "/parents/1//children/new" for blah at blah
Processing by ChildrenController#new as HTML
  Parameters: {"parent_id"=>"1"}
  Rendered children/_form.html.erb (1.3ms)
  Rendered children/new.html.erb within layouts/application (1.9ms)
Completed 500 Internal Server Error in 4ms

ActionView::Template::Error (undefined method `children' for nil:NilClass):
    1: <%= form_for ([@parent, @parent.children.build]) do |f| %>
    2: 
    3: <div class = "field">
    4:   <%= f.label :Child_name %><br/>
  app/views/children      /_form.html.erb:1:in`_app_views_children__form_html_erb__2140243687_70034946643120'
  app/views/children/new.html.erb:3:in `_app_views_children_new_html_erb__655166082_70034947829100' 
```

在子 new.html.erb 中呈现的 _form.html.erb 如下：

```
<%= form_for ([@parent, @parent.children.build]) do |f| %>

<div class = "field">
  <%= f.label :Child_name %><br/>
  <%= f.text_field :ChildName %>
</div>

<div class = "field">
  <%= f.label :Child_email_address %><br/>
  <%= f.text_field :ChildEmail %>
</div>

<div class = "actions">
  <%= f.submit %>
</div>
<% end %> 
```

（注意：这些表实际上并不称为 parent 和 child，我只是出于保密的原因使用了这些名称。另外，请不要建议我使用 has_many through，我不感兴趣。）

编辑#1：来自“ChildrenController”的代码

```
 def new
    @child = Child.new
  end

  def create
    @parent = Parent.find(params [:parent_id])
    @scout = @parent.children.build(params[:child])
    redirect_to parent_path(@parent)
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:40:20.010

您需要包含`@parent = Parent.find(params[:parent_id])`在新操作中，因为您在 new.html.erb 模板中使用它。否则它将为零并且`@parent.children.build`将不起作用。

# php - mysql查询的多个查询字符串参数

> ID：12611308
> 
> 赞同：0
> 
> 时间：2012-09-26T22:18:19.753
> 
> 标签：php, mysql, query-string

我最初有这个工作：

网址：`http://server/blah.php?FacilityCode=FT`

```
$facilitycode = mysql_real_escape_string($_GET["FacilityCode"]);
$sql = "SELECT ..." .
       "FROM ..." .
       "WHERE ..." .
       "AND ('" . $facilitycode . "' = '' OR Facility.FacilityCode = '". $facilitycode . "')";
$result = mysql_query($sql); 
```

但我想改变这一点，以便人们可以在查询中以某种方式提交多个值，即：`http://server/blah.php?FacilityCode=FT,CC,DD,EE`

我尝试将查询更改为“IN”子句而不是“等于”，但我不确定如何在每个元素周围获取 ' 标记。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:22:58.323

使用`implode()`IN (...) 的函数。

```
$a = array('AB', 'CD', 'EF', 'ZE');
echo "field IN ('" . implode("', '", $a) . "')"; 
```

...将输出：

```
field IN ('AB', 'CD', 'EF', 'ZE') 
```

+逃避你得到的每一个选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:23:16.530

```
$facilitycode = mysql_real_escape_string($_GET["FacilityCode"]);
$array=explode(',',$facilitycode);
foreach ($array as $a){$output.="'$a',";}
$clause=substr($output,0,-1); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T22:30:48.297

如果您尝试创建一个如下所示的字符串：'AB'、'CD'、'EF'、'ZE'

在将其放入查询之前尝试此操作：

```
$facilitycode = preg_replace('/([^,]+)/', '\'$1\'', $facilitycode); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T22:34:44.703

我根据你的查询写了这个，但我仍然没有得到这部分查询“AND（'”。$facilitycode。“'=''”，无论如何你需要检查$_GET数据是否有“，”如果确实爆炸该变量由“，”，以便您可以为 $_GET 数据中由“，”分隔的所有内容添加 OR 分句。

之后，只需对爆炸数组中的每个元素执行 foreach 即可形成您的查询，如下所示：

```
<?php

$facilitycode = $_GET["FacilityCode"];

$facility_number_chk = strpos($facilitycode, ",");

if ($facility_number_chk > -1) {

    $facilitycode = explode(",", $facilitycode);

    $sql = "SELECT ..." .
    "FROM ..." .
    "WHERE ..." .
    "AND ('" . $facilitycode . "' = ''";

    foreach($facilitycode as $facode) {

        $facode = mysql_real_escape_string($facode);

        $sql .= " OR Facility.FacilityCode = '". $facode . "'";

    }

    $sql .= "')";

}
else {

    $facilitycode = mysql_real_escape_string($facilitycode);

    $sql = "SELECT ..." .
    "FROM ..." .
    "WHERE ..." .
    "AND ('" . $facilitycode . "' = '' OR Facility.FacilityCode = '". $facilitycode . "')";

}

$result = mysql_query($sql); 
```

如果 $_GET 数据中只有一个元素，请像我对常规查询所做的那样执行 else 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T00:52:05.940

我最终使用了几个答案的组合。基本上我在“，”上爆炸了，然后做了一个foreach来添加'标记并调用escape_string，然后将它内爆回来。

```
$facilitycodes = $_GET["FacilityCode"];
if ($facilitycodes == '') {
  $additionalfilter = '';
}
else {
  $facilitycodearray = explode(",", $facilitycodes);
  foreach($facilitycodearray as &$facilitycode) {
    $facilitycode = "'" . mysql_real_escape_string($facilitycode) . "'";
  }
  $facilitycodesformatted = implode(",", $facilitycodearray);
  $additionalfilter = " AND Facility.FacilityCode IN (" . $facilitycodesformatted . ")";
}

$sql = "SELECT ..." .
"FROM ..." .
"WHERE ..." .
$additionalfilter; 
```

# text - 在 VI 中编辑多部分 case 语句

> ID：12611310
> 
> 赞同：0
> 
> 时间：2012-09-26T22:18:25.910
> 
> 标签：text, vi, textblock

因此，我们的警报平台生成基于 SNMP MIB 的专有代码。如果您不熟悉 SNMP，请不要担心，这个问题只是切线相关的。代码最终看起来像这样：

```
case ".1.3.6.1.4.1.5555": ## This is the OID for that specific device type, this switch/case began in the main file.
    switch ($specific-trap): {
        case "10": ## The specific alarm
            # Alarm-specific code
            @Identifier = $enterprise + "." + $specific-trap
        case "11": ## A different alarm
            # Alarm-specific code
            @Identifier = $enterprise + "." + $specific-trap
        case "12": ## A different alarm
            # Alarm-specific code
            @Identifier = $enterprise + "." + $specific-trap
        case "20": ## clears specific-trap 10
            # Alarm-specific code
            @Identifier = $enterprise + "." + $specific-trap
        case "21": ## clears 11
            # Alarm-specific code
            @Identifier = $enterprise + "." + $specific-trap
        case "22": ## clears 12
            # Alarm-specific code
            @Identifier = $enterprise + "." + $specific-trap
        default:
            ## what happens if the alarm isn't found
    } 
```

我需要做的是使用警报并清除作为@Identifier（唯一键），因此它们会相互覆盖。因此，例如，第一种情况应如下所示：

```
 case "10": ## The specific alarm
        # Alarm-specific code
        @Identifier = $enterprise + ".10-20" 
```

并且“20”的情况将被设置为相同。

我通常只是浏览文件并手动编辑这些，但如果有数百个陷阱，这可能会变得乏味。我是否错过了一些可以做到这一点的简单 VI 技巧？我想到的一切都行不通，因为 $specific-trap 值已经与 @Identifier 不在同一行。

我考虑过只写一个 Perl 脚本来处理它，但我很懒。我认为可能有一些 VI 魔法可以轻松做到这一点。

# c++ - 将无符号整数地址视为指针并将其取消引用为字节数组

> ID：12611311
> 
> 赞同：1
> 
> 时间：2012-09-26T22:18:30.977
> 
> 标签：c++, c, pointers, byte, memory-address

所以，我有一个`unsigned int`变量，上面存储了一个十进制值地址，比方说`unsigned int var = 1232342`，我想做的是，在不知道变量的类型**但**知道它的大小和存储地址的情况下，获取值作为一个`byte array`. 例如，假设我有一个`int var = 20`地址和字节大小。我希望能够转到该地址并返回一个字节数组，在这种情况下`[00001100]`，对于`char`结构的变量和数据成员也是如此。

一点点伪代码将类似于：

```
for var.address until var.address = var.address + bytesize
    do 
       byte_array = *var.address
       var.address++ 
```

不过我遇到了一些问题，我对 C 有点陌生，所以我不知道如何将 unsigned int 视为地址/指针。其次，我不知道如何从地址中获取实际字节，每当我取消引用地址时，我得到的是它的实际值，但前提是我知道变量的类型。

**一点背景知识：** *我正在开发一个名为 Pin 的工具，它让我可以选择挂钩到正在运行的进程，然后我正在使用 DWARF 和 ELF 信息。所以我确实可以访问我试图访问的虚拟内存空间*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T03:09:55.523

看看[epatel](https://stackoverflow.com/users/842/epatel) here的`hexdump`功能

[现成的 C++ 十六进制转储代码](https://stackoverflow.com/questions/29242/off-the-shelf-c-hex-dump-code)

尽管有标题，但它实际上是 C 代码。为了您的方便，我会复制到这里

```
#include <ctype.h>
#include <stdio.h>

void hexdump(void *ptr, int buflen) {
  unsigned char *buf = (unsigned char*)ptr;
  int i, j;
  for (i=0; i<buflen; i+=16) {
    printf("%06x: ", i);
    for (j=0; j<16; j++) 
      if (i+j < buflen)
        printf("%02x ", buf[i+j]);
      else
        printf("   ");
    printf(" ");
    for (j=0; j<16; j++) 
      if (i+j < buflen)
        printf("%c", isprint(buf[i+j]) ? buf[i+j] : '.');
    printf("\n");
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:48:41.193

“a”是您想要获取 4 个字节的地址。“字节”是您要存储结果的位置。我将“i”的地址分配给“a”，然后从该地址读取 4 个字节。

```
#include <stdio.h>
int main(int argc, char *argv[]) {
    unsigned char bytes[4];
    int i = 65535, j;
    unsigned long a = (unsigned long) &i;

    for (j = 0; j < 4; j++) {
        bytes[j] = *((unsigned char*) a + j);
    }

    for (j = 0; j < 4; j++) {
        printf("bytes[%d]: %d\n", j, bytes[j]);
    }
} 
```

# grails - RouteBuilder.onException 是创建全局异常处理程序还是路由特定异常处理程序？

> ID：12611316
> 
> 赞同：2
> 
> 时间：2012-09-26T22:18:57.867
> 
> 标签：grails, apache-camel

我正在使用带有路由插件的 Grails 来使用 RouteBuilder DSL 定义路由。

如果我有如下场景：

```
...
//configure method for route builder A
def configure {
    onException(CustomException).process(exceptionProcessor)

    from(<route A.1>)...
    from(<route A.2>)...
}
...

...
//configure method for route builder B
def configure {
    onException(CustomException).process(exceptionProcessor)

    from(<route B.1>)...
}
... 
```

在这种情况下，确实`onException(CustomException).process(exceptionProcessor)`定义了一个涵盖路由 A.1、A.2 和 B.1 的全局异常处理程序，还是定义了仅包含在同一 RouteBuilder（即 A.1 和A2）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T12:04:17.220

它将在定义它的特定路由构建器本地创建一个异常处理程序。但它将跨越该特定路线构建器中的所有路线。也就是说，在Java中。但是，我认为没有区别，因为您的 groovy 代码几乎以相同的方式编译为 java。

# c# - 创建树视图绑定 wpf

> ID：12611324
> 
> 赞同：2
> 
> 时间：2012-09-26T22:19:23.587
> 
> 标签：c#, wpf, xaml

我一直在尝试制作一个看起来像的树视图

2001（根）
-Student1（节点）
-Student2（节点）

我试过使用分层数据模板，但我仍然没有掌握我需要什么。这是我希望将树视图绑定到的代码。任何有关 Xaml 的帮助都会得到帮助。

我以为它看起来像

```
 <TreeView ItemsSource="{Binding CurrentClass}">
        <TreeView.Resources>
            <HierarchicalDataTemplate DataType="{x:Type local:Student}" ItemsSource="{Binding CurrentClass.Students}">
                    <TextBlock Text="{Binding CurrentClass.Students/FirstName}" />
                </HierarchicalDataTemplate>
        </TreeView.Resources>
    </TreeView> 
```

```
public class ViewModel
{
    public FreshmenClass currentClass = new FreshmenClass();

    public ViewModel()
    {
        currentClass.Year = "2001";
        currentClass.Students.Add(new Student("Student1", "LastName1"));
        currentClass.Students.Add(new Student("Student2", "LastName2"));
    }

    public FreshmenClass CurrentClass
    {
        get { return currentClass; }
    }
}

public class FreshmenClass
{
    public string Year { get; set; }
    public List<Student> students = new List<Student>();

    public List<Student> Students
    {
        get { return students; }
        set { students = value; }
    }
}

public class Student
{
    public string FirstName { get; set; }
    public string LastName { get; set; }

    public Student(string firstName, string lastName)
    {
        FirstName = firstName;
        LastName = lastName;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T08:55:33.667

查看有关 Treeview 和 HierarchicalDataTemplate 的文档。无论如何，我像这样编辑您的示例（XAML）：

```
<TreeView ItemsSource="{Binding CurrentClass}" >
        <TreeView.ItemTemplate>
            <HierarchicalDataTemplate ItemsSource="{Binding Students}">
                <TextBlock Text="{Binding Year}" />
                <HierarchicalDataTemplate.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding FirstName}"> </TextBlock>
                    </DataTemplate>
                </HierarchicalDataTemplate.ItemTemplate>
            </HierarchicalDataTemplate>
        </TreeView.ItemTemplate>
    </TreeView> 
```

和 c#:

```
public class ViewModel 
{
    private List<FreshmenClass> currentClass;

    public ViewModel()
    {
        CurrentClass = new List<FreshmenClass>();
        FreshmenClass temp = new FreshmenClass();
        temp.Year = "2001";
        temp.Students.Add(new Student("Student1", "LastName1"));
        temp.Students.Add(new Student("Student2", "LastName2"));

        CurrentClass.Add(temp);
    }

    public List<FreshmenClass> CurrentClass
    {
        get { return currentClass; }
        set { currentClass = value; }
    }
} 
```

ItemsSource 属性是一个 IEnumerable。

# git - 使用 xarg 和 curl 传递 git 日志内容的正确方法

> ID：12611331
> 
> 赞同：1
> 
> 时间：2012-09-26T22:20:08.940
> 
> 标签：git, command-line, xargs

我想获取 git log 的输出并将其用作 curl 命令的参数。

这是我正在执行的 git log 命令：

```
git log -1 --format="(%h, %cn): %s" 
```

卷曲命令：

```
curl http://www.example.com -F note='git_log_output' 
```

git log 的输出如下所示：

```
(9b42b2f, Author Name): Adding support for fancy stuff 
```

我认为 xargs 会这样做，但会执行此操作（暂时使用 echo 而不是 curl）：

```
git log -1 --format="(%h, %cn): %s" | xargs -0 -I {} echo "Hi there {}" 
```

它实际上打印了这个：

```
27m" | xargs -0 -I {} echo "Hi {}"Hi (9b42b2f, Author Name): Adding support for fancy stuff 
```

代替：

```
Hi (9b42b2f, Author Name): Adding support for fancy stuff 
```

有什么好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:32:09.730

`curl http://www.example.com -F note="`git log -1 --format="(%h, %cn): %s"`"`

我认为反引号是你想要的。

# c++ - 从模板分配 void 指针

> ID：12611332
> 
> 赞同：0
> 
> 时间：2012-09-26T22:20:11.137
> 
> 标签：c++, string, templates, pointers, void

我正在尝试在`Obj`课堂上做这样的事情：

```
public:
    template <typename T>
    Obj(T & o) {
        siz = sizeof(o);

        p = malloc(siz);
        memcpy(p, &o, siz);
    }   
private:                                
    void * p;
    size_t siz; 
```

如果我这样做，那效果很好：

```
string str = "foobar";
Obj u = Obj(str); 
```

但如果我做这样的事情就不会：

```
Obj u = Obj(string("foobar")); 
```

这会产生一个填充随机字符的字符串。

要检索我使用的字符串：

```
string S() {
    return *((string *)p);
} 
```

任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:02:20.817

正如其他人所评论的那样，您不应该做这样的事情。您提供的代码示例不适用于非 POD 的任何内容（http://stackoverflow.com/questions/146452/what-are-pod-types-in-c）。当您执行 memcpy 时，您可能没有正确初始化新对象。例如，如果它的成员是指针。在字符串的情况下，它的实现可能包含一个指向原始字符串所拥有的字符缓冲区的指针。当原始字符串被删除时，字符缓冲区也会被删除。但是您的 memcopied 对象仍将指向已删除的缓冲区。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T23:01:15.630

好吧，很难猜出你想要做什么。

您似乎在做的是制作对象的二进制副本，这是所有坏事和邪恶的严重案例。在您的第一种情况下，您正在对“真实”对象执行此操作，因此由于原始对象（str 对象）仍然存在，因此它可能看起来有效，因此副本包含的任何指针仍然指向“有效”数据。在第二种情况下，您正在对一个临时对象执行此操作，该对象在事情发生后立即被释放，这可能就是您的“副本”只有垃圾的原因。

不管怎样，从表面上看，两者实际上都没有做任何合理的事情。我想说你的第一个例子似乎只起作用。

# c++ - 使用 boost 程序选项通过配置文件/命令行解析自定义对象

> ID：12611334
> 
> 赞同：1
> 
> 时间：2012-09-26T22:20:15.740
> 
> 标签：c++, boost, boost-program-options

所以我刚刚开始为我的代码添加选项支持。我可以自己做，也可以使用 boost 的程序选项。唯一阻止我使用 boost 的是我添加到项目中的另一个依赖项。但是，如果它可以轻松处理复杂对象的解析，我更愿意付出代价。

我只是根据示例尝试了类似的方法，但它不起作用：

```
#include <boost/program_options.hpp>
namespace po = boost::program_options;

#include <iostream>
#include <fstream>
#include <iterator>
using namespace std;

struct Grid{
    double xmin, xmax;
};

int main(int ac, char* av[])
{
    try {
        Grid g;

        po::options_description cmd("Allowed options");
        cmd.add_options()
            ("help", "produce help message")
            ("Grid", "grid information")
            ;

        po::variables_map vm;
        store(parse_command_line(ac, av, cmd), vm);
        notify(vm);

        if (vm.count("help")) {
            cout << cmd << "\n";
            return 0;
        }

        g = vm["Grid"].as<Grid>();
        cout << g.xmin << " " << g.xmax << endl;

    }
    catch(exception& e)
    {
        cout << e.what() << "\n";
        return 1;
    }    
return 0; 
```

当我使用 运行代码时`./a.out --Grid {-1, 1}`，我得到`boost::bad_any_cast: failed conversion using boost::any_cast`. 我不明白这意味着什么，但我的猜测是我无法正确判断我的对象类型的提升`Grid`。如何使用 boost 正确执行此操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T00:09:53.053

首先，简单的方法是使用`po::value<std::vector<double>>()->multitoken(),`: 但是，您需要像这样传递参数：`--Grid -1 1`

```
int main(int ac, char* av[])
{
    try {

        po::options_description cmd("Allowed options");
        cmd.add_options()
            ("help", "produce help message")
            ("Grid", po::value<std::vector<double>>()->multitoken(),
             "grid information")
            ;
        po::variables_map vm;
        store(parse_command_line(ac, av, cmd), vm);
        notify(vm);

        if (vm.count("help")) {
            cout << cmd << "\n";
            return 0;
        }

        Grid g{vm["Grid"].as<std::vector<double>>()[0],
               vm["Grid"].as<std::vector<double>>()[1]};
        cout << g.xmin << " " << g.xmax << endl;

    }
    catch(exception& e)
    {
        cout << e.what() << "\n";
        return 1;
    }
} 
```

如果你想传递类似的参数`--Grid {-1,1}`，你可以添加一个`operator>>`并自己解析`std::string`：

```
std::istream& operator>>(std::istream &in, Grid &g)
{
    // Note that this code does not do any error checking, etc.
    // It is made simple on purpose to use as an example
    // A real program would be much more robust than this
    std::string line;
    std::getline(in, line);
    std::stringstream ss(line);
    char bracket, comma;
    double xmin, xmax;
    ss >> bracket >> xmin >> comma >> xmax;
    g = Grid{xmin, xmax};
    return in;
}

//...
Grid g;
try {

//...
cmd.add_options()
   ("help", "produce help message")
   ("Grid", po::value(&g), "grid information")
;
//...

cout << g.xmin << " " << g.xmax << endl; 
```

另外，请注意，在 中`--Grid {-1,1}`，**没有空格**: `-1,1`，而不是`-1, 1`。这是因为`line`只会包含`{-1,`.

如果你想要空间，这里是一个可以解析的例子`--Grid {-1, 1}`，使用[自定义验证器](http://www.boost.org/doc/libs/1_51_0/doc/html/program_options/howto.html#id2550043)和`multitoken`：

```
// Showing only changes, rest of the code is the same
void validate(boost::any& v, const std::vector<std::string>& val,
              Grid*, double)
{
    std::stringstream ss(val[0]);
    char bracket;
    double xmin, xmax;
    ss >> bracket >> xmin;
    ss.str(val[1]);
    ss >> xmax;
    v = Grid{xmin, xmax};
}

po::options_description cmd("Allowed options");
        cmd.add_options()
        ("help", "produce help message")
        ("Grid", po::value(&g)->multitoken(), "grid information")
        ; 
```

# javascript - 检查切换元素的可见性

> ID：12611336
> 
> 赞同：3
> 
> 时间：2012-09-26T22:20:24.473
> 
> 标签：javascript, jquery, toggle, visibility

我有一个按钮，它可以切换`<div>`它下方的可见性，并希望根据所述的可见性修改按钮上的文本`<div>`。

[这是jsFiddle](http://jsfiddle.net/QgjJG/1/)上的现场演示

如果单击“保存的数据”，第一次它可以正常工作，但下次单击时文本不会改变。这本身就是我不理解的行为。

现在，我可以使用多个处理程序`slideToggle()`，**但是**，在代码的其他地方，我还设置了在“Cookie 数据：”和“服务器数据：”旁边加载数据的间隔。`<div>`如果不可见，我不希望这些间隔做任何事情，所以我使用这样的东西：

```
 this.timer_cookiedata = setInterval(function(){
        if (!$savedData.is(':visible'))
        {
            return null;
        }
        // ..
    }); 
```

我担心这些间隔不会因为这项`is(':visible')`业务而正常工作。所以问题是，为什么会发生这种情况（else 语句被忽略），我能做些什么来减轻这种情况？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-26T22:24:29.500

查看[更新的小提琴](http://jsfiddle.net/QgjJG/2/)。当您在调用 后立即检查可见性时`slideToggle`，jQuery 可能尚未更新元素的可见性，因为动画需要一些时间才能完成。由于这个确切的原因，`slideToggle`有一个回调可以用来在动画完成后执行操作：

```
$(function () {
    var $savedData = $('#savedData');
    $('#btn-savedData')
        .click(function () {
        var $button = jQuery(this);

        //I'm checking the visibility in the callback. Inside the callback, 
        //I can be sure that the animation has completed and the visibility 
        //has been updated.
        $savedData.slideToggle('fast', function () {
            if ($savedData.is(':visible')) {
                $button.html('visible');
            } else {
                $button.html('not visible');
            }

        });
    });
});​ 
```

# python - 递归 dir() 一个 python 对象以查找某种类型或具有某个值的值

> ID：12611337
> 
> 赞同：9
> 
> 时间：2012-09-26T22:20:28.713
> 
> 标签：python, recursive-descent, recursive-datastructures

我有一个复杂的 Python 数据结构（如果重要，它是一个大的 music21 Score 对象），由于对象结构深处某处存在弱引用，它不会腌制。我以前用堆栈跟踪和python调试器调试过这样的问题，但这总是一个很大的痛苦。是否有一种工具可以在对象的所有属性上递归运行 dir()，查找隐藏在列表、元组、字典等中的对象，并返回与某个值匹配的对象（lambda 函数或类似的东西）。一个大问题是递归引用，因此需要某种备忘录功能（如 copy.deepcopy 使用）。我试过：

```
import weakref
def findWeakRef(streamObj, memo=None):
    weakRefList = []
    if memo is None:
        memo = {}
    for x in dir(streamObj):
        xValue = getattr(streamObj, x)
        if id(xValue) in memo:
            continue
        else:
            memo[id(xValue)] = True
        if type(xValue) is weakref.ref:
            weakRefList.append(x, xValue, streamObj)
        if hasattr(xValue, "__iter__"):
            for i in xValue:
                if id(i) in memo:
                    pass
                else:
                    memo[id(i)] = True
                    weakRefList.extend(findWeakRef(i), memo)
        else:
            weakRefList.extend(findWeakRef(xValue), memo)
    return weakRefList 
```

我可能可以继续填补这个漏洞（例如，**iter**不是我想要的 dicts），但在我投入更多时间之前，想知道是否有人知道更简单的答案。它可能是一个非常有用的通用工具。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T00:33:58.277

这似乎是答案的开始。我不得不从 Python 3.2 [inspect.getattr_static](http://bugs.python.org/file18699/static.py)向后移植一些项目以使其工作，因此它不会调用不断生成新对象的属性。这是我想出的代码：

```
#-------------------------------------------------------------------------------
# Name:         treeYield.py
# Purpose:      traverse a complex datastructure and yield elements
#               that fit a given criteria
#
# Authors:      Michael Scott Cuthbert
#
# Copyright:    Copyright © 2012 Michael Scott Cuthbert
# License:      CC-BY
#-------------------------------------------------------------------------------
import types

class TreeYielder(object):
    def __init__(self, yieldValue = None):
        '''
        `yieldValue` should be a lambda function that
        returns True/False or a function/method call that
        will be passed the value of a current attribute
        '''        
        self.currentStack = []
        self.yieldValue = yieldValue
        self.stackVals = []
        t = types
        self.nonIterables = [t.IntType, t.StringType, t.UnicodeType, t.LongType,
                             t.FloatType, t.NoneType, t.BooleanType]

    def run(self, obj, memo = None):
        '''
        traverse all attributes of an object looking
        for subObjects that meet a certain criteria.
        yield them.

        `memo` is a dictionary to keep track of objects
        that have already been seen

        The original object is added to the memo and
        also checked for yieldValue
        '''
        if memo is None:
            memo = {}
        self.memo = memo
        if id(obj) in self.memo:
            self.memo[id(obj)] += 1
            return
        else:
            self.memo[id(obj)] = 1

        if self.yieldValue(obj) is True:
            yield obj

        ### now check for sub values...
        self.currentStack.append(obj)

        tObj = type(obj)
        if tObj in self.nonIterables:
            pass
        elif tObj == types.DictType:
            for keyX in obj:
                dictTuple = ('dict', keyX)
                self.stackVals.append(dictTuple)
                x = obj[keyX]
                for z in self.run(x, memo=memo):
                    yield z
                self.stackVals.pop()

        elif tObj in [types.ListType, types.TupleType]:
            for i,x in enumerate(obj):
                listTuple = ('listLike', i)
                self.stackVals.append(listTuple)
                for z in self.run(x, memo=memo):
                    yield z
                self.stackVals.pop()

        else: # objects or uncaught types...
            ### from http://bugs.python.org/file18699/static.py
            try:
                instance_dict = object.__getattribute__(obj, "__dict__")
            except AttributeError:
                ## probably uncaught static object
                return

            for x in instance_dict:
                try:
                    gotValue = object.__getattribute__(obj, x)
                except: # ?? property that relies on something else being set.
                    continue
                objTuple = ('getattr', x)
                self.stackVals.append(objTuple)
                try:
                    for z in self.run(gotValue, memo=memo):
                        yield z
                except RuntimeError:
                    raise Exception("Maximum recursion on:\n%s" % self.currentLevel())
                self.stackVals.pop()                

        self.currentStack.pop()

    def currentLevel(self):
        currentStr = ""
        for stackType, stackValue in self.stackVals:
            if stackType == 'dict':
                if isinstance(stackValue, str):
                    currentStr += "['" + stackValue + "']"
                elif isinstance(stackValue, unicode):
                    currentStr += "[u'" + stackValue + "']"
                else: # numeric key...
                    currentStr += "[" + str(stackValue) + "]"
            elif stackType == 'listLike':
                currentStr += "[" + str(stackValue) + "]"
            elif stackType == 'getattr':
                currentStr += ".__getattribute__('" + stackValue + "')"
            else:
                raise Exception("Cannot get attribute of type %s" % stackType)
        return currentStr 
```

此代码可让您运行如下内容：

```
class Mock(object):
    def __init__(self, mockThing, embedMock = True):
        self.abby = 30
        self.mocker = mockThing
        self.mockList = [mockThing, mockThing, 40]
        self.embeddedMock = None
        if embedMock is True:
            self.embeddedMock = Mock(mockThing, embedMock = False)

mockType = lambda x: x.__class__.__name__ == 'Mock'

subList = [100, 60, -2]
myList = [5, 20, [5, 12, 17], 30, {'hello': 10, 'goodbye': 22, 'mock': Mock(subList)}, -20, Mock(subList)]
myList.append(myList)

ty = TreeYielder(mockType)
for val in ty.run(myList):
    print(val, ty.currentLevel()) 
```

并得到：

```
(<__main__.Mock object at 0x01DEBD10>, "[4]['mock']")
(<__main__.Mock object at 0x01DEF370>, "[4]['mock'].__getattribute__('embeddedMock')")
(<__main__.Mock object at 0x01DEF390>, '[6]')
(<__main__.Mock object at 0x01DEF3B0>, "[6].__getattribute__('embeddedMock')") 
```

或运行：

```
high = lambda x: isinstance(x, (int, float)) and x > 10
ty = TreeYielder(high)
for val in ty.run(myList):
    print(val, ty.currentLevel()) 
```

并得到：

```
(20, '[1]')
(12, '[2][1]')
(17, '[2][2]')
(30, '[3]')
(22, "[4]['goodbye']")
(100, "[4]['mock'].__getattribute__('embeddedMock').__getattribute__('mocker')[0]")
(60, "[4]['mock'].__getattribute__('embeddedMock').__getattribute__('mocker')[1]")
(40, "[4]['mock'].__getattribute__('embeddedMock').__getattribute__('mockList')[2]") 
```

我仍在试图弄清楚为什么找不到 .abby，但我认为即使在这一点上也值得发布，因为它比我开始时更正确。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-05-16T21:43:03.137

这是一个有点幼稚的更简单的解决方案。即只是属性树下的深度优先搜索。如果它是原语，则停止，否则在树中更深入。它将为您提供调用树和叶子的值。

```
def recursive_dir(obj, path):
    if ((obj!=None) and (not isinstance(obj, (str,float,int,list,dict,set)))):
        for attr, val in obj.__dict__.iteritems():
            temp_path = path[:]
            temp_path.append(attr)
            recursive_dir(getattr(obj, attr), temp_path)
    else:
        print (path, "--->", obj)
        print("")
recursive_dir(x,[]) 
```

# flash - 更改 Flash VideoTime 组件中的字体颜色

> ID：12611338
> 
> 赞同：-1
> 
> 时间：2012-09-26T22:20:41.163
> 
> 标签：flash, components, skinning, scene7

我正在尝试通过修改他们提供的 .fla 模板来为 Adob​​e Scene7 制作视频播放器。到目前为止，我已经成功地改变了除了 VideoTime 组件中的文本之外的所有内容。

查看此库项目的属性表明它正在使用他们必须托管的类：com.scene7.fl.video.VideoTime

有没有办法通过时间线上的一些动作脚本（3）简单地改变这个组件的字体颜色？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T19:42:57.047

videoTime.setStyle("textFormat", new TextFormat("_sans", 11, 0xFFFFFF, false, false, false, '', '', TextFormatAlign.LEFT, 0, 0, 0, 0));

# javascript - 将图像动画到鼠标点击的位置

> ID：12611340
> 
> 赞同：1
> 
> 时间：2012-09-26T22:21:02.730
> 
> 标签：javascript, jquery, jquery-animate, mouseevent

我正在尝试使用 JQuery 将图像动画化到我在 div 上单击鼠标的位置。

html 的 div 的 id 为“stage”，图像的 id 为“player”。当用户在舞台上单击时，我已经成功地更新了标题，但是一旦我添加了另一个 JQuery 以使图像移动到舞台上的鼠标点击，两者都不起作用。

也许这是显而易见的，因为我是 JQuery 的新手，但希望有人能发现我的错误。

这是我的 JQuery 代码：

```
$(document).ready(function(){
//alert('It works');
    $('#stage').click(function() {
        $('#header').html('Image is moving!');
    });

    $('#stage').click(function(e){
        $('#player').animate({
            top: e.pageY + 'px';
            left: e.pageX + 'px';
         }, 800);
    });
}); 
```

总而言之，当有人在舞台 div 中单击时，它上面的标题应该会发生变化，并且图像应该移动到人们在舞台上单击的位置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T22:26:41.177

两件事情：

```
$('#player').animate({
    top: e.pageY + 'px';
    left: e.pageX + 'px';
}, 800); 
```

有语法错误。它应该是：

```
$('#player').animate({
    top: e.pageY,
    left: e.pageX
}, 800); 
```

请注意，我没有这样做，`'px'`因为没有必要。

你可以看到它在这里工作：http: [//jsfiddle.net/VBzUw/](http://jsfiddle.net/VBzUw/)

# django - django - 为什么 request.POST 对象是不可变的？

> ID：12611345
> 
> 赞同：112
> 
> 时间：2012-09-26T22:21:19.610
> 
> 标签：django, post

正如标题所问，为什么 Django 家伙决定用 querydict 实现 request.POST 对象（当然，这反过来又使整个事情不可变？）

我知道你可以通过复制帖子数据来*修改它*

```
post = request.POST.copy() 
```

但为什么要这样做？当然，无论如何允许事物是可变的会更简单吗？或者它是否也被用于其他可能导致问题的原因？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2012-09-27T10:54:56.773

这有点神秘，不是吗？一些表面上看似合理的理论在调查中被证明是错误的：

1.  这样`POST`对象就不必实现变异方法了吗？否：该`POST`对象属于[`django.http.QueryDict`类](https://github.com/django/django/blob/master/django/http/__init__.py#L371)`__setitem__`，该类实现了包括、和`__delitem__`在内的一整套变异方法。它通过在调用其中一种突变方法时检查标志来实现不变性。当您调用该方法时，您将获得另一个启用了可变标志的实例。`pop``clear``copy``QueryDict`

2.  为了提高性能？否：`QueryDict`当可变标志关闭时，该类不会获得性能优势。

3.  这样该`POST`对象可以用作字典键吗？否：`QueryDict`对象不可散列。

4.  如此处所述，以便可以[懒惰](https://stackoverflow.com/questions/2339857/why-is-post-data-copied-in-django#comment2312894_2339963)`POST`地构建数据（无需承诺阅读整个响应）？我在代码中没有看到这方面的证据：据我所知，整个响应总是被读取，或者[直接](https://github.com/django/django/blob/master/django/http/__init__.py#L296)读取，或者通过响应读取。[`MultiPartParser`](https://github.com/django/django/blob/master/django/http/multipartparser.py#L35)`multipart`

5.  保护您免受编程错误的影响？我已经看到了这种说法，但是我从来没有很好地解释过这些错误是什么，以及不变性如何保护您免受它们的侵害。

无论如何，`POST`它*并不总是不可变*的：当响应为 时`multipart`，则`POST`它是可变的。这似乎对你可能想到的大多数理论提出了质疑。（除非这种行为是疏忽。）

总之，**我看不出**在 Django 中`POST`对象对于非`multipart`请求是不可变的明确理由。

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2014-01-21T15:25:45.287

如果请求是 Django**`form`**提交的结果，那么 POST**`immutable`**确保表单**提交**和表单**验证****之间**数据的完整性是合理的。但是，如果请求**不是**通过 Django提交发送的，那么 POST 就是因为没有表单验证。********`form`****`mutable`********

 ****你总是可以做这样的事情：（根据[@leo-the-manic 的评论](https://stackoverflow.com/questions/12611345/django-why-is-the-request-post-object-immutable#comment31517766_12613004)）

```
#  .....
mutable = request.POST._mutable
request.POST._mutable = True
request.POST['some_data'] = 'test data'
request.POST._mutable = mutable
# ...... 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-27T01:55:59.653

**更新**：

Gareth Rees 是对的，第 1 点和第 3 点在这种情况下无效。虽然我认为第 2 点和第 4 点仍然有效，但我将把这些留在这里。

*（我注意到 Pyramid(Pylon) 和 Django 的对象`request.POST`都是`MultiDict`.`request.POST`*

* * *

我不能代表 Django 的人说话，尽管在我看来它可能是因为以下一些原因：

1.  ~~**性能**。不可变对象比可变对象“更快”，因为它们允许大量优化。对象是不可变的，意味着我们可以在*创建时*为其分配空间，并且空间需求不会发生变化。它也因此具有复制效率和比较效率之类的东西。~~ **编辑**`QueryDict`：正如 Gareth Rees 指出的那样，情况并非如此
2.  在 的情况下`request.POST`，似乎服务器端的任何活动都不需要更改**请求的**数据。因此不可变对象更适合，更不用说它们具有实质性的性能优势。
3.  ~~不可变对象可以用作`dict`键，我*想*这在 Django 中的某个地方可能非常有用。~~ **编辑**：我的错误，*不可变*并不直接暗示可*散列*；*然而，可散列*对象通常也是*不可变*的。
4.  当您传递`request.POST`（尤其是传递给第三方插件和输出）时，您可以期望来自用户的这个请求对象将保持不变。

在某种程度上，这些原因也是“不可变 vs 可变？”的通用答案。问题。我敢肯定，在 Django 案例中，设计考虑因素比上述要多得多。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-03-17T15:24:13.820

我喜欢它默认是不可变的。正如所指出的，如果需要，您可以使其可变，但您必须明确说明它。这就像“我知道我可以让我的表单调试成为一场噩梦，但我知道我现在在做什么。”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-04-30T22:40:43.527

[我在 Stack Answer https://stackoverflow.com/a/2339963](https://stackoverflow.com/a/2339963)的评论中发现了这一点

> 并且它必须是不可变的，以便可以懒惰地构建它。副本强制获取所有 POST 数据。直到副本，它可能不会全部被提取。此外，为了让多线程 WSGI 服务器工作得相当好，如果它是不可变的会很有帮助

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-04-12T10:40:07.290

请注意：`multipart`自 Django 1.11 [https://github.com/django/django/blob/stable/1.11.x/django/http/multipartparser.py#L292起，请求是不可变的](https://github.com/django/django/blob/stable/1.11.x/django/http/multipartparser.py#L292)

它们在以前的版本中是可变的。****

# iphone - 将 UISwitch 更改为 On

> ID：12611346
> 
> 赞同：0
> 
> 时间：2012-09-26T22:21:24.643
> 
> 标签：iphone, ios, uialertview, uiswitch

我的 .xib 文件中有一个 UISwitch 对象。其状态默认为开启。如果用户将其切换为关闭，我想问他是否确定，如果他单击否 - 自动将其切换回打开。

所以我在我的 .h 文件中设置了这些出口和操作：

```
@property (weak, nonatomic) IBOutlet UISwitch *campaignSwitch;
- (IBAction)checkCampaignSwitch:(id)sender; 
```

这是 checkCampaignSwitch 方法：

```
- (IBAction)checkCampaignSwitch:(id)sender {
    if(self.campaignSwitch.isOn==FALSE)
    {
        [self allertMessage:@"Receive updates" :@"Are you sure you don't want
           to receive updates?" :@"No" :@"Yes"];
    }
} 
```

这需要方法来显示带有各种参数（标题、文本、取消按钮和其他按钮）的警报消息。

我还注册了 UIAlertViewDelegate 并在我的 .m 文件中尝试实现 clickedButtonAtIndex 方法，如下所示：

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    switch (buttonIndex) {
        case 0:
            [self.campaignSwitch setOn:TRUE];
            break;

        default:
            break;
    }
} 
```

我收到警报消息，但是当我单击否按钮时没有任何反应。也不是。那么如何将其重新打开？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:27:34.150

确保在 Interface Builder 中连接了所有连接。此外，请确保警报视图中的 switch 语句与正确的按钮相关联（即确保您进入案例 0）。

要关闭开关，请参阅下面的代码。

```
// Set the switch on
[_switch setOn:YES];

// Set the switch off
[_switch SetOn:NO]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:45:19.303

我通常这样做是为了立即绘制它：

```
 [emailAlertSwitch setOn:NO animated:YES]; 
```

或者

```
 [emailAlertSwitch setOn:YES animated:YES]; 
```

是否进入alertView委托回调？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T22:46:08.027

您需要使用该`setOn: animated:`方法

```
[self.campaignSwitch setOn:YES animated:YES]; 
```

简单地使用不带动画的 setOn 不会显示动画。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-26T22:54:00.810

必须确保 UIAlertView 被委派：

```
UIAlertView *displayMessage = [[UIAlertView alloc]
   initWithTitle:messageTitle
   message:alertMessage
   **delegate:self**
   cancelButtonTitle:cancelButton
   otherButtonTitles:otherButton,
nil]; 
```

# c# - 这是一个 FormView 错误吗？

> ID：12611347
> 
> 赞同：1
> 
> 时间：2012-09-26T22:21:24.613
> 
> 标签：c#, asp.net, linq, linq-to-sql, formview

我有一个绑定到 ASP.NET 页面上的 LinqDataSource 的 FormView（启用了分页）。我遇到了一些**非常**奇怪的行为，无法弄清楚为什么会这样。为简单起见，我删除了一些不需要的代码（其他 FormView 模板等）来演示此行为。

我的 FormView 有 3 个字段、两个文本框和一个 DropDownList。DropDownList 绑定到页面上的另一个 LinqDataSource 并包含外键值。当 FormView 的 LinqDataSource 仅包含一条记录并且我尝试更新它时，*更新失败，因为 DropDownList 的选定值始终为空*，无论我为它选择哪个值。当 FormView 的 LinqDataSource 包含 2 个或更多记录时，它会正常工作。

现在这是真正奇怪的事情。由于 FormView 的 PagerSettings，更新实际上失败了！当我只使用默认的寻呼机设置时，一切都很好。当我将 PagerMode 更改为 时`NextPreviousFirstLast`，更新失败。

这是我的 FormView 及其数据源：

```
<asp:FormView ID="fvData" runat="server" AllowPaging="True" 
    DataKeyNames="ID" DataSourceID="ldsData" DefaultMode="Edit">
    <EditItemTemplate>
        <table class="pad5">
            <tr>
                <td class="field-name">AREA:</td>
                <td>
                    <asp:DropDownList ID="cboAREA" runat="server" DataTextField="AREA_NAME" 
                        DataValueField="AREA1" SelectedValue='<%# Bind("AREA") %>' DataSourceID="ldsAreas" />
                </td>
            </tr>
            <tr>
                <td class="field-name">LOOP:</td>
                <td><asp:TextBox ID="txtLOOP" runat="server" Text='<%# Bind("LOOP") %>' /></td>
            </tr>
            <tr>
                <td class="field-name">LOOP DESCRIPTION:</td>
                <td><asp:TextBox ID="txtLOOP_DESCRIPTION" runat="server" 
            Text='<%# Bind("LOOP_DESCRIPTION") %>' style="width: 600px" /></td>
            </tr>
        </table>

        <asp:Button ID="btnUpdate" runat="server" Text="Update" CommandName="Update" CausesValidation="True" />
        <asp:Button ID="btnCancel" runat="server" Text="Cancel" CommandName="Cancel" CausesValidation="False" />
    </EditItemTemplate>
    <PagerSettings Mode="NextPreviousFirstLast" 
        FirstPageText="&amp;lt;&amp;lt; First" LastPageText="Last &amp;gt;&amp;gt;" 
        NextPageText="Next &amp;gt;" PreviousPageText="&amp;lt; Prev" 
        Position="TopAndBottom" />
    <PagerStyle CssClass="pager" />
</asp:FormView>

<asp:LinqDataSource ID="ldsData" runat="server" 
    ContextTypeName="E_and_I.EAndIDataDataContext" EnableDelete="True" 
    EnableInsert="True" EnableUpdate="True" EntityTypeName="" 
    TableName="INSTRUMENT_LOOP_DESCRIPTIONs" onselecting="ldsData_Selecting" OrderBy="ID ASC" >
</asp:LinqDataSource>

<asp:LinqDataSource ID="ldsAreas" runat="server" 
    ContextTypeName="E_and_I.EAndIDataDataContext" EntityTypeName="" 
    TableName="AREAs" onselecting="ldsAreas_Selecting">
</asp:LinqDataSource> 
```

这是我的 LinqDataSource 的两个`Selecting`事件：

```
EAndIDataDataContext db = new EAndIDataDataContext();

protected void ldsData_Selecting(object sender, LinqDataSourceSelectEventArgs e)
{
    e.Result = db.INSTRUMENT_LOOP_DESCRIPTIONs.Take(1); // we only want one record for testing
}

protected void ldsAreas_Selecting(object sender, LinqDataSourceSelectEventArgs e)
{
    e.Result = db.AREAs.OrderBy(a => a.AREA1).Select(a => new { AREA1 = a.AREA1, AREA_NAME = "(" + a.AREA1 + ") " + a.AREA_NAME });
} 
```

我已经将问题追溯到以下几行：

```
<PagerSettings Mode="NextPreviousFirstLast" 
    FirstPageText="&amp;lt;&amp;lt; First" LastPageText="Last &amp;gt;&amp;gt;" 
    NextPageText="Next &amp;gt;" PreviousPageText="&amp;lt; Prev" 
    Position="TopAndBottom" /> 
```

一旦我删除了上述`PagerSettings`元素，FormView 就会很好地更新记录！有谁知道为什么寻呼机设置与此有关？我正在使用 .NET Framework 4.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T19:46:45.567

我复制了您的部分代码并进行了实验，我想，我正在尝试相同的行为。

这就是我所做的：

```
<asp:LinqDataSource runat="server" ID="lds"
    TableName="jobs" ContextTypeName="WebApplication2.DataAccess.PubsDataContext" >

</asp:LinqDataSource>
<asp:LinqDataSource runat="server" ID="ldse"
    TableName="employee" ContextTypeName="WebApplication2.DataAccess.PubsDataContext" OnSelecting="ldse_Selecting">

</asp:LinqDataSource>

<asp:FormView runat="server" DefaultMode="Edit" ClientIDMode="Predictable" DataKeyNames="emp_id" DataSourceID="ldse"
    AllowPaging="true" OnItemCommand="Unnamed_ItemCommand" ID="formView">
    <EditItemTemplate>
        <div>
            <asp:DropDownList runat="server" ID="ddlJobs" DataSourceID="lds" DataTextField="job_desc" DataValueField="job_id">
            </asp:DropDownList>
        </div>
        <div>
            <asp:TextBox runat="server" TextMode="MultiLine" ID="txtDesc" />
        </div>
        <div>
            <asp:Button Text="Save" runat="server" CommandName="Save" CausesValidation="true" />
            <asp:Button Text="Cancel" runat="server" CommandName="Cancel" CausesValidation="false" />
        </div>
    </EditItemTemplate>
    <PagerSettings Mode="NextPreviousFirstLast" 
        FirstPageText="&amp;lt;&amp;lt; First" LastPageText="Last &amp;gt;&amp;gt;" 
        NextPageText="Next &amp;gt;" PreviousPageText="&amp;lt; Prev" 
        Position="TopAndBottom" /> 
```

这些是我的观察：

*   如果`FormView` **仅包含一行，**则`FormView`行为很奇怪，我的命令无法按预期工作。

    *   我的`Save`命令从未被触发，而是“取消”命令被触发

    *   我的`Cancel`命令让我`FormView`消失了……

一开始我以为这是因为`&amp;`角色，但**事实并非如此**

我把问题缩小到`Position="TopAndBottom"`

*   如果将`Position`属性设置为：

    *   最佳

    *   顶部和底部

    你将尝试同样的问题。（正如你提到的可能是一个错误）

*   如果将`Position`属性设置为：

    *   巴顿

    它按预期工作

老实说，如果这是一个错误，我不敢相信没有其他人发现它并报告它。

我用 Visual Studio 2012 for Web (ASP.NET 4.5) 做了同样的实验，我正在试验完全相同的行为......

这让我觉得我可能在做一些根本错误的事情，也许这不是一个错误，这就是为什么我在 ASP.NET 4 和 ASP.NET 4.5 两个版本上试验相同的行为，但如果是这样的话，我根本无法弄清楚它是什么。

另一方面，如果这是一个错误，那么同样的错误将出现在 ASP.NET 4.5 中

## 编辑 1

[我将代码上传到我的 GitHub 站点以供参考](https://github.com/jupaol/SO-Answers/blob/master/Visual%20Studio%202012/src/SO/WebForms/WebForms_1/Topics/DataBinding/FormViewPagerBug.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:48:16.417

这很可能是由于 & < 和 > 的 url 解码。

尝试取出 &';' 只需使用 & 符号。您可以使用该方法进行注入。

# emacs - 如何计算 emacs 表中的睡眠持续时间？

> ID：12611348
> 
> 赞同：5
> 
> 时间：2012-09-26T22:21:27.193
> 
> 标签：emacs, org-mode

我有一个表格，其中包含日期、唤醒时间和就寝时间作为输入。根据这些数据，我想计算前一天晚上的睡眠时间。您可以在下面看到我想获得的表格示例：

```
| Date             | Waketime | Bedtime | Sleep |
| <2012-09-24 Mon> |     6:00 |   22:00 |       |
| <2012-09-25 Tue> |     8:00 |   01:00 | 10:00 |
| <2012-09-26 Wed> |     7:00 |   23:00 |  6:00 | 
```

当我应用表格公式时：`#+TBLFM: $4=if((24-$3)<12, (24-$3)+@-1$2, $3+@-1$2);t`这并没有给出想要的结果，因为整数 (24, 12...) 被解释为秒。

错误结果：

```
| Date             | Waketime | Bedtime |  Sleep |
| <2012-09-24 Mon> |     6:00 |   22:00 |        |
| <2012-09-25 Tue> |     8:00 |   01:00 |   5.01 |
| <2012-09-26 Wed> |     7:00 |   23:00 | -14.99 |

   #+TBLFM: $4=if((24-$3)<12, (24-$3)+@-1$2, $3+@-1$2);t 
```

**如何调整此公式以返回正确的睡眠时间？**

*请注意，对于计算睡眠持续时间，我有一个 if 语句，它根据 Bedtime 的值以不同的方式计算睡眠持续时间。如果就寝时间在 12 小时之前，则添加就寝时间和起床时间。如果就寝时间超过 12 小时，则首先将就寝时间减去 24，然后将其添加到唤醒时间*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T06:24:28.623

这是一个 hack，因为 org-mode 在创建公式时似乎不理解 calc 的 HMS 表示法，但你在这里：

```
 #+TBLFM: $4=if($3 - (12 * 3600) < 0, (24 * 3600), 0) + $2 - $3;T 
```

# web-applications - 将谷歌阅读器文章下载到本地文件夹？

> ID：12611349
> 
> 赞同：1
> 
> 时间：2012-09-26T22:21:30.887
> 
> 标签：web-applications, google-reader

有什么方法可以为我的谷歌阅读器提要在本地存储 html 或文本文件？提要中的每个项目一个文件？

它们可以追溯到多年前，我想要我自己的副本，我可以在没有互联网连接的情况下搜索和阅读。

有点像电子邮件，您可以将电子邮件放在服务器上并通过网络邮件获取，但您也可以将其保存在电子邮件客户端中以供离线使用。

我一直在看谷歌的 xml 提要和 json，直到我看到星星。

有没有我可以用来完成此任务的程序或语言？

即使我能以某种方式将所有文章移至电子邮件并通过客户端软件（如雷鸟）下载，那也很棒。

我尝试了 FeedDemon，但它并没有超过这么多项目，而且我有更多我想要的内容。

# c# - 重定向输出较大时启动的进程挂起

> ID：12611350
> 
> 赞同：8
> 
> 时间：2012-09-26T22:21:33.527
> 
> 标签：c#, asp.net, iis, process, redirectstandardoutput

我今天遇到了这个问题，我花了很长时间才弄清楚。我从 IIS 中启动一个进程，重定向它的标准输出和错误输出，所以当进程退出时，我可以用它生成一个日志。在我的机器上一切都运行良好，但在我发布它之后就不那么好了。

该过程应该工作一段时间然后退出，但它不会。它只是停止响应，持有像套接字这样的资源。过了好一阵子，我才确定了问题的原因：生成的日志太大了。从运行过程中发表评论后`Console.WriteLine`，一切正常。

只是为了澄清我是如何开始这个过程的：

```
Process process = new Process();
process.StartInfo.FileName = path;
process.StartInfo.Arguments = arguments;
process.StartInfo.UseShellExecute = false;
process.StartInfo.RedirectStandardOutput = true;
process.StartInfo.RedirectStandardError = true;
process.EnableRaisingEvents = true;
process.Exited += Process_Exited;
process.Start(); 
```

以及我如何处理它的退出：

```
private static void Process_Exited(object sender, EventArgs e)
{
    Process process = (Process)sender;
    File.WriteAllText(path, process.StandardOutput.ReadToEnd() +
    "\r\nEXCEPTIONS\r\n" + process.StandardError.ReadToEnd());
} 
```

即使我已经知道如何修复它，我仍然想知道到底发生了什么以及为什么，因为我必须有一种方法可以创建一个我想要的日志。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-01T21:00:04.373

[RedirectStandardOutput](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.redirectstandardoutput.aspx)的文档描述的不是一个，而是两个可能的死锁场景（对于一个有用且不危险的类库来说，这如何？！）

当 StandardOutput 和 StandardError 都被重定向并且正在读取的流已满时，会发生一种情况。这似乎完美地描述了你的情况。

一个非常烦人的情况，但阅读完整的文档，他们描述了如何避免它发生。

# scala - 在类型模式中显式声明类型参数是模式匹配的唯一方法，尽管被擦除消除了

> ID：12611352
> 
> 赞同：2
> 
> 时间：2012-09-26T22:21:38.187
> 
> 标签：scala, pattern-matching

考虑以下代码：

```
trait Trait {
  type X
  type Y[_ <: X]
} 

type T[X0,Y0[_ <: X0]] = Trait { type X = X0; type Y[S <: X0] = Y0[S] }

class TraitImpl extends Trait {
  override type X = Int
  override type Y[I <: Int] = List[I]
}

case class Wrap[X,Y[_ <: X]](t: T[X,Y])

val wrap = new Wrap[Int,List](new TraitImpl) // why explicitly write types? 
```

为什么要显式编写类型，请参阅[我的另一个问题](https://stackoverflow.com/questions/12611072/class-a-has-one-type-parameter-but-type-b-has-one)。
现在我想进行模式匹配`wrap`：

```
wrap match {
  case w: Wrap[_,_]      => // error
  case w: Wrap[_,_[_]]   => // error
  case Wrap(t)           => // error
  case w: Wrap[Int,List] => // fine
} 
```

我习惯于有多种模式匹配选择，尤其是最后两个`case`语句，有时是第一个语句。
但是前三个`case`都不起作用，为什么？（特别是`case Wrap(t) =>`）？

# r - R 以秒为单位查找 YYYY-MM-DD HH:MM:SS.MMM 格式的时差

> ID：12611361
> 
> 赞同：16
> 
> 时间：2012-09-26T22:23:00.810
> 
> 标签：r, date, datetime, time

我正在尝试减去 2 个包含以下格式的日期时间信息的字符向量：

```
> dput(train2)

structure(list(time2 = c("2011-09-01 23:44:52.533", "2011-09-05 12:25:37.42", 
"2011-08-24 12:56:58.91", "2011-10-25 07:18:14.722", "2011-10-25 07:19:51.697"
), time3 = c("2011-09-01 23:43:59.752", "2011-09-05 12:25:01.187", 
"2011-08-24 12:55:13.012", "2011-10-25 07:16:51.759", "2011-10-25 07:16:51.759"
)), .Names = c("time2", "time3"), row.names = c(NA, 5L), class = "data.frame") 
```

我四处寻找并使用`zoo`, `as.Date`,`as.POSIXct`等来尝试找到正确的代码来减去 2 个日期时间对象并在几秒钟内得到答案，但没有运气。

我会很感激任何建议。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-08-27T23:36:08.103

```
>  x1<-"2013-03-03 23:26:46.315" 
>  x2<-"2013-03-03 23:31:53.091"
>  x1 <- strptime(x1, "%Y-%m-%d %H:%M:%OS")
>  x2 <- strptime(x2, "%Y-%m-%d %H:%M:%OS")
> x1
[1] "2013-03-03 23:26:46"
> x2
[1] "2013-03-03 23:31:53" 
```

我遵循@Dirk Eddelbuettel 的回答，但我正在失去精确度。我怎样才能强制 R 不削减秒的部分？

谢天谢地（strptime 的人）我自己回答了我的问题：

```
op <- options(digits.secs = 3) 
```

应用此设置后，将使用精度。

[http://stat.ethz.ch/R-manual/R-devel/library/base/html/strptime.html](http://stat.ethz.ch/R-manual/R-devel/library/base/html/strptime.html)

如果您想在几秒钟内获得差异，但在几分钟内获得差异，以下可能会很有用：

```
> as.numeric(x2-x1,units="secs")
[1] 306.776 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-09-26T22:26:19.507

十分简单：

```
R> now <- Sys.time()
R> then <- Sys.time()
R> then - now
Time difference of 5.357 secs
R> class(then - now)
[1] "difftime"
R> as.numeric(then - now)
[1] 5.357
R> 
```

对于您的数据：

```
R> df
                    time2                   time3
1 2011-09-01 23:44:52.533 2011-09-01 23:43:59.752
2  2011-09-05 12:25:37.42 2011-09-05 12:25:01.187
3  2011-08-24 12:56:58.91 2011-08-24 12:55:13.012
4 2011-10-25 07:18:14.722 2011-10-25 07:16:51.759
5 2011-10-25 07:19:51.697 2011-10-25 07:16:51.759
R> df$time2 <- strptime(df$time2, "%Y-%m-%d %H:%M:%OS")
R> df$time3 <- strptime(df$time3, "%Y-%m-%d %H:%M:%OS")
R> df
                    time2                   time3
1 2011-09-01 23:44:52.533 2011-09-01 23:43:59.752
2 2011-09-05 12:25:37.420 2011-09-05 12:25:01.187
3 2011-08-24 12:56:58.910 2011-08-24 12:55:13.012
4 2011-10-25 07:18:14.722 2011-10-25 07:16:51.759
5 2011-10-25 07:19:51.697 2011-10-25 07:16:51.759
R> df$time2 - df$time3
Time differences in secs
[1]  52.781  36.233 105.898  82.963 179.938
attr(,"tzone")
[1] ""
R> 
```

并作为数字添加回数据框：

```
R> df$dt <- as.numeric(df$time2 - df$time3)
R> df
                    time2                   time3      dt
1 2011-09-01 23:44:52.533 2011-09-01 23:43:59.752  52.781
2 2011-09-05 12:25:37.420 2011-09-05 12:25:01.187  36.233
3 2011-08-24 12:56:58.910 2011-08-24 12:55:13.012 105.898
4 2011-10-25 07:18:14.722 2011-10-25 07:16:51.759  82.963
5 2011-10-25 07:19:51.697 2011-10-25 07:16:51.759 179.938
R> 
```

# perl - 如何判断 Perl 模块所需的最低版本号？

> ID：12611364
> 
> 赞同：1
> 
> 时间：2012-09-26T22:23:27.847
> 
> 标签：perl, module, version

我正在编写一个 Perl 模块，现在我包含在`Makefile.PL`所有依赖项中。唯一的问题是我拥有所需模块的所有最新版本，但我不想限制任何拥有早期版本的人（要么无法更新它们，要么需要旧版本的旧代码）。有什么方法可以在不下载和测试所有版本的情况下找出可用于我的模块的最低版本？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T00:17:26.967

不，没有一种自动的方式来判断。您可能希望首先阅读每个模块的变更日志并查看发生了哪些更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T00:29:23.450

听说过 Dist::Zilla 吗？它不会帮助您解决版本问题……但它可以帮助您解决许多其他创建、维护和发布模块的问题。正如其他人所提到的，了解版本工作的唯一方法是编写测试并针对它们进行测试......

# c++ - 如何反转链表的每个 k 元素？

> ID：12611365
> 
> 赞同：1
> 
> 时间：2012-09-26T22:23:29.390
> 
> 标签：c++, reverse, doubly-linked-list

> **可能重复：**
> [反转链表的每 k 个节点](https://stackoverflow.com/questions/7138128/reverse-every-k-nodes-of-a-linked-list)

假设链表是 <1,3,6,4,8,9,0,2>。调用 reversek(3) 将导致 <6,3,1,9,8,4,2,0>。我已经编写了可以用作reversek 中的辅助函数的reverse 函数。这是我的反向函数，它从给定的起点反转到给定的终点：

```
 void List::reverse(Node * & start, Node * & end)
    {
    Node *pter = start;
    while (pter != NULL) 
    {
         Node *tmp = pter->next;
         pter->next = pter->prev;
         pter->prev = tmp;
         if (tmp == NULL) 
         {
            endPoint = startPoint;
            startPoint = pter;
         }
       pter = tmp;
    } 
```

我对如何实现reversek 感到困惑，感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:30:36.873

尝试类似的东西 -

1.  有 2 个指向链表头元素的指针（P1，P2）。
2.  一个用于遍历列表（P1）。当遍历点到达列表中的第三个节点时，另一个（P2）用于交换元素。
3.  现在将两个指针移动到第 4 个节点。并再次继续 P1 遍历列表的其余部分。

在这里，您必须跟踪 P1 到达每个第 3 个节点的时间。例如，这里是 3，但它取决于函数参数。

# java - Java中的构造函数同步

> ID：12611366
> 
> 赞同：23
> 
> 时间：2012-09-26T22:23:31.717
> 
> 标签：java, multithreading, concurrency, constructor

有人告诉我Java构造函数是同步的，因此在构造过程中不能同时访问它，我想知道：如果我有一个将对象存储在映射中的构造函数，并且另一个线程在构建之前从该映射中检索它完成后，该线程会阻塞直到构造函数完成吗？

让我用一些代码来演示：

```
public class Test {
    private static final Map<Integer, Test> testsById =
            Collections.synchronizedMap(new HashMap<>());
    private static final AtomicInteger atomicIdGenerator = new AtomicInteger();
    private final int id;

    public Test() {
        this.id = atomicIdGenerator.getAndIncrement();
        testsById.put(this.id, this);
        // Some lengthy operation to fully initialize this object
    }

    public static Test getTestById(int id) {
        return testsById.get(id);
    }
} 
```

假设 put/get 是地图上唯一的操作，所以我不会通过迭代之类的方法获得 CME，并尝试忽略此处的其他明显缺陷。

我想知道的是，如果另一个线程（显然不是构造对象的线程）尝试使用`getTestById`并调用对象来访问对象，它会阻塞吗？换句话说：

```
Test test = getTestById(someId);
test.doSomething(); // Does this line block until the constructor is done? 
```

我只是想澄清构造函数同步在 Java 中的进展程度，以及这样的代码是否会出现问题。我最近看到这样的代码，而不是使用静态工厂方法，我想知道这在多线程系统中有多危险（或安全）。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-26T22:25:52.073

> 有人告诉我Java构造函数是同步的，因此在构造过程中不能同时访问它

当然不是这样。与构造函数没有隐含的同步。不仅可以同时发生多个构造函数，而且还可以通过例如在构造函数内部分叉一个线程并引用`this`正在构造的构造函数来解决并发问题。

> 如果我有一个将对象存储在映射中的构造函数，并且另一个线程在其构造完成之前从该映射中检索它，那么该线程会阻塞直到构造函数完成吗？

不，不会的。

线程应用程序中构造函数的最大问题是编译器有权在 Java 内存模型下对构造函数内部的操作进行重新排序，以便它们发生*在*（所有事情中）对象引用被创建并且构造函数完成之后。 `final`字段将保证在构造函数完成时完全初始化，而不是其他“正常”字段。

在您的情况下，由于您将您`Test`放入同步映射*然后*继续进行初始化，正如@Tim 所提到的，这将允许其他线程以可能的半初始化状态获取对象。一种解决方案是使用一种`static`方法来创建您的对象：

```
private Test() {
    this.id = atomicIdGenerator.getAndIncrement();
    // Some lengthy operation to fully initialize this object
}

public static Test createTest() {
    Test test = new Test();
    // this put to a synchronized map forces a happens-before of Test constructor
    testsById.put(test.id, test);
    return test;
} 
```

我的示例代码有效，因为您正在处理一个同步映射，它调用`synchronized`确保`Test`构造函数已完成并已实现内存同步。

您的示例中的大问题是“发生之前”保证（构造函数在`Test`放入映射之前可能无法完成）和内存同步（构造线程和获取线程可能会看到`Test`实例的不同内存）。如果您移动`put`构造函数的外部，则两者都由同步映射处理。不管它在什么对象`synchronized` 上，都可以保证构造函数在放入映射之前已经完成并且内存已经同步。

我相信，如果您`testsById.put(this.id, this);`在构造函数的*最后*调用，您实际上可能没问题，但这不是好的形式，至少需要仔细的评论/文档。如果该类是子类并且在`super()`. 我展示的`static`解决方案是一个更好的模式。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-27T10:28:35.027

> 有人告诉我Java构造函数是同步的

“某个地方的某个人”被严重误导。构造函数不同步。证明：

```
public class A
{
    public A() throws InterruptedException
    {
        wait();
    }

    public static void main(String[] args) throws Exception
    {
        A a = new A();
    }
} 
```

`java.lang.IllegalMonitorStateException`此代码在`wait()`调用时抛出。如果同步有效，则不会。

这甚至没有意义。它们不需要同步。只能在 a 之后调用构造函数，`new(),`并且根据定义，每次调用都`new()`返回不同的值。因此，两个线程同时调用具有相同值的构造函数的可能性为零`this`。所以不需要构造函数的同步。

> 如果我有一个将对象存储在映射中的构造函数，并且另一个线程在其构造完成之前从该映射中检索它，那么该线程会阻塞直到构造函数完成吗？

不，它为什么要这样做？谁来阻止它？让'this'从这样的构造函数中逃脱是不好的做法：它允许其他线程访问仍在构建中的对象。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-09-26T22:26:05.803

你被误导了。您所描述的实际上被称为不当发布，并在 Java Concurrency In Practice 一书中进行了详细讨论。

所以是的，另一个线程有可能获得对您的对象的引用并在它完成初始化之前开始尝试使用它。但是等等，考虑这个答案会变得更糟：[https](https://stackoverflow.com/a/2624784/122207) ://stackoverflow.com/a/2624784/122207 ...基本上可以重新排序引用分配和构造函数完成。在引用的示例中，一个线程可以分配`h = new Holder(i)`，另一个线程调用`h.assertSanity()`新实例，时机恰到好处，以便为在的构造函数`n`中分配的成员获取两个不同的值。`Holder`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-26T22:52:38.497

构造函数就像其他方法一样，没有额外的同步（处理`final`字段除外）。

`this`如果稍后发布该代码将起作用

```
public Test() 
{
    // Some lengthy operation to fully initialize this object

    this.id = atomicIdGenerator.getAndIncrement();
    testsById.put(this.id, this);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-07T12:24:49.433

虽然这个问题得到了回答，但是粘贴的代码没有遵循安全的构造技术，因为**它允许这个引用从构造函数中逃逸**，我想分享一下 Brian Goetz 在[文章中提出的一个漂亮的解释：“Java 理论与实践：安全构造技术”在 IBM developerWorks 网站上](http://www.ibm.com/developerworks/java/library/j-jtp0618/index.html)。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-26T22:32:52.170

这是不安全的。JVM 中没有额外的同步。你可以这样做：

```
public class Test {
    private final Object lock = new Object();
    public Test() {
        synchronized (lock) {
            // your improper object reference publication
            // long initialization
        }
    }

    public void doSomething() {
        synchronized (lock) {
            // do something
        }
    }
} 
```

# php - WSO2 WSF/PHP - WSDL w WS-Security 证书签名

> ID：12611369
> 
> 赞同：1
> 
> 时间：2012-09-26T22:23:57.767
> 
> 标签：php, wsdl, wso2, ws-security

我正在尝试连接到通过 HTTPS 使用 WS-Security 证书签名的 WSDL。

只有传出的消息被签名并且它使用二进制安全令牌（在 WSO2 中找不到这个特定选项，但我不确定我在下面的代码中使用了正确的选项）。

我查看了 WSO2 WSF/PHP 示例中的代码，并将 WDSL 客户端示例和签名示例结合在一起。

代码：

```
$my_cert = ws_get_cert_from_file("./keys/cert.pem");
$my_key = ws_get_key_from_file("./keys/key.pem");

$sec_array = array("sign"=>TRUE,
                   "algorithmSuite" => "Basic256Rsa15",
                   "securityTokenReference" => "EmbeddedToken");  //Is this correct for Binary Security Token?

$policy = new WSPolicy(array("security"=>$sec_array));

$sec_token = new WSSecurityToken(array("privateKey" => $my_key,
                                       "certificate" => $my_cert));

$client = new WSClient(array("wsdl"=>"https://.../Informationservice.WSDL",
                             "useWSA" => TRUE,
                             "policy" => $policy,
                             "securityToken" => $sec_token));

$proxy = $client->getProxy();   

$return_val =  $proxy->StreetTypes(); 
```

任何帮助将不胜感激，因为我无法在任何地方找到连接到此类在线服务的示例。大多数服务似乎使用用户名和密码而不是证书进行签名，并且在查找 WSDL 和证书签名时，我根本找不到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T14:40:59.817

您需要为 https 指定 CACert 选项以使用设置为 https 端点的“to”端点。也使用非 wsdl 模式，因为 wsdl 模式存在一些已知问题。

# android - .axml 突出显示和智能感知在 monodroid 中不起作用

> ID：12611373
> 
> 赞同：5
> 
> 时间：2012-09-26T22:24:28.720
> 
> 标签：android, visual-studio-2010, xamarin.android

我最近为 Android 安装了单声道，今天我尝试开始使用。在我看过的所有教程中，intellisense 和 highlighting 在编辑 .axml 文件时都在 Visual Studio 中工作，但是在安装、卸载和重新安装之后，我的仍然无法正常工作。我想我可以这样继续下去，但这简直让我发疯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T08:50:19.593

如果您使用 XML 的默认 VisualStudio 编辑器，则智能感知应该来自命名空间导入：`xmlns:android="http://schemas.android.com/apk/res/android"`

但是，如果您使用的是 Xamarin 设计器及其 XML 编辑器，那么我认为您不会获得任何智能感知 - 这是 Xamarin 团队正在进行的一项工作。

# css - 设计与 iPad 交叉兼容的 CSS 菜单

> ID：12611374
> 
> 赞同：1
> 
> 时间：2012-09-26T22:24:28.893
> 
> 标签：css, ipad, menu, cross-browser

我建立了一个在 Firefox、IE 和 Chrome 上运行良好的网站。客户去参加一个贸易展，并意识到他们的 iPad 上的网站菜单变得疯狂。
[破碎的菜单 http://www.glassdoctordenvermetro.com/wp-content/themes/GDDenverTheme/images/photo.JPG](http://www.glassdoctordenvermetro.com/wp-content/themes/GDDenverTheme/images/photo.JPG)

我尝试了一个网站，让您可以通过模拟它来预览您的设计，以防您没有 iPad（像我一样）。但问题是它看起来不错： http: [//ipadpreview.com/previewer ?url=http%3A%2F%2Fglassdoctordenvermetro.com%2F](http://ipadpreview.com/previewer?url=http%3A%2F%2Fglassdoctordenvermetro.com%2F)

我会怎么做才能解决这个问题？可能是每个浏览器上的字体都不同的问题吗？选项卡的宽度会根据菜单字体和措辞而变化，但在我测试的所有其他浏览器上，它看起来都很好。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T22:37:33.003

在 iPad 模拟器中打开它会显示字体更宽，并且字母间距也更大。您应该在标签中指定更多选项，`font-family`以便在 iOS 上使用另一种更简洁的字体。您还可以在 iOS 上降低字体大小。您正在使用的测试站点的一个大问题是它仍在输出 HTML，唯一值得信赖的站点类型必须生成屏幕截图以确保一致性。

这里有一些字体可以提供帮助：http: [//iosfonts.com/](http://iosfonts.com/)

并`11px`适用于现有字体。

或者，删除大写转换使其适合。

# sql - 在 Access 中选择条件

> ID：12611380
> 
> 赞同：0
> 
> 时间：2012-09-26T22:24:59.330
> 
> 标签：sql, ms-access

我有两个 excel 文件，我将它们链接在一起以在 Access 中进行查询。

```
Table One     Table Two
Name  ID      Name   ID
John  342     John   342
Mike  234     Mike   234
Mich  980     Mich   980
Jenn  098     Quay   309
Anna  145     Pond   612
              Lope   546
              Anna   145 
```

如何在访问查询中设置条件，以便它们与 ID 匹配，并且只显示左侧与右侧匹配的名称。表二中与表一不匹配的任何内容都可以忽略吗？

如果我有以下查询：

```
Name          Name
Table one     Table two 
```

我得到以下结果：

```
John   John
Mike   John
Mich   John
Jenn   John
Anna   John
John   Mike
Mike   Mike
Mich   Mike
Jenn   Mike
Anna   Mike 
```

等等......所以我想我必须设定一个标准......这是我坚持的地方......任何帮助都会很感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:33:00.517

您可以使用内部联接：

```
 SELECT [Table 1].Name, [Table 2].Name 
 FROM [Table 1] 
 INNER JOIN [Table 2]
 ON [Table 1].Name = [Table 2].Name 
```

您可以在 MS Access 中创建此查询，方法是将两个表都添加到查询设计窗口，然后将要匹配的字段从一个表拖到下一个表，或者切换到 SQL 视图并键入或粘贴 SQL。

更多信息：
[用于 Access 2000 的基本 Microsoft Jet SQL 用于 Access 2000 的](http://msdn.microsoft.com/en-us/library/aa140011%28office.10%29.aspx)
[中级 Microsoft Jet SQL 用于 Access 2000 的](http://msdn.microsoft.com/en-us/library/aa140015%28office.10%29.aspx)
[高级 Microsoft Jet SQL](http://msdn.microsoft.com/en-us/library/aa139977%28office.10%29.aspx)

# javascript - 是否有可能在 Javascript 中完成某件事后做某事？

> ID：12611383
> 
> 赞同：0
> 
> 时间：2012-09-26T22:25:08.313
> 
> 标签：javascript

我有一个简单的登录页面，我在验证时尝试禁用用户名字段、密码字段和提交按钮，如果密码/用户名或两者都错误或仅以其他方式登录，则重新启用它们。

我正在使用以下代码执行此操作：

```
 // get the field values
    var usernameField = document.getElementById("username");
    var passwordField = document.getElementById("password");
    var submit = document.getElementById("submit");

    usernameField.disabled = "disabled";
    passwordField.disabled = "disabled";
    submit.disabled = "disabled";

    // Authentication code 
```

我希望在身份验证代码开始之前禁用所有内容。现在，它的作用是当我单击提交按钮时，它会保持“卡住”几秒钟，然后登录或简单地产生错误。但它永远不会禁用任何东西（我确保这不是 CSS 问题）。

如果需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:29:10.580

您是否尝试将回调函数添加到您的身份验证代码？您可以在单击提交时禁用所有内容，调用身份验证代码，并在身份验证失败时在回调函数中重新启用您的字段。

# php - 从数据库下载图片以通过 JavaScript 显示？

> ID：12611386
> 
> 赞同：-1
> 
> 时间：2012-09-26T22:25:25.320
> 
> 标签：php, javascript, html, cordova

我正在开发移动应用程序，我在想，如果我需要从服务器下载图片，我实际上无法原生运行 PHP（我使用的是[PhoneGap](http://en.wikipedia.org/wiki/PhoneGap)类型设置），那么我如何从数据库下载图片，通过 JavaScript 运行它，然后将其显示给用户？

我会想象这样的事情：

1.  阿贾克斯请求，
2.  返回二进制数据的 HTML 字符串
3.  做点什么？

或者

1.  阿贾克斯请求，
2.  返回图片引用的 HTML 字符串，例如：`picture1.jpg`. 在 JavaScript 中，编写类似`document.write <img src="http://blahh/img/"+imagePath`

我不确定最好的方法是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:56:01.653

你可以做到这一点，但不是纯粹在 JavaScript 中。

既然你提到了[PHP](http://en.wikipedia.org/wiki/PHP)，我会朝那个方向走：

1.  在数据库中创建表，您将在其中存储所有图像。您需要有某种`image_content`字段并在某些baseline64编码器中加载每个图像，例如：

    [http://www.motobit.com/util/base64-decoder-encoder.asp](http://www.motobit.com/util/base64-decoder-encoder.asp)。并将返回的字符串存储到该`image_content`字段中。

    或者您可以编写一些脚本[，](http://en.wikipedia.org/wiki/Base64)使用`http://php.net/manual/en/function.base64-encode.php`.

2.  制作一个PHP文件。例如，`giveme_encoded_img.php`在该文件中，您需要在 URL 中有一个参数，例如`gimme_encoded_img.php?image_name=header_bg`.

    然后在语句中获取`image_name`并`$_REQUEST`使用该数据执行 MySQL 查询，`WHERE`以便您可以从数据库中选择编码的图像字符串。

    之后，只需打印它。

3.  当您对上述文件执行 Ajax 请求时，只需使用响应更新所需的图像 src。这样做的最佳方法是获取响应并通过 id 获取一些元素，例如

    var header_bg = document.getElementById('header_bg'); header_bg.src = 响应；

    最终的 HTML 需要看起来像这样：

    img alt="嵌入图像" id="header_bg" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIA..."

Baseline64 嵌入非常好，特别是如果您需要在电子邮件中嵌入图像，那么许多电子邮件客户端默认显示它们，而不是从您的服务器隐藏远程图像。

我希望我足够清楚。

这仍然不是一个纯粹的 JavaScript 解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T23:01:57.840

在我看来，动态加载外部图片的最简单方法是从包含图片 URL（如）的 PHP 脚本中获取[JSON对象。](http://en.wikipedia.org/wiki/JSON)`http://www.example.com/pictures/getPicture/YOUR_PICTURE_ID`

### 服务器端

```
<?php
    $pictureUrl = 'http://example.com/pictures/picture.jpg'; //You can get it with a database query
    $pictureName = 'Foo';
    $pictureAltText = 'Bar';

    // You can do some stuff here.

    // At the end of the script, write result.
    echo json_encode(compact('pictureUrl', 'pictureName', 'pictureAltText'));
?> 
```

### 客户端

```
<script type="text/javascript">
    // With jQuery
    $.getJSON('http://www.example.com/pictures/getPicture/YOUR_PICTURE_ID', function(data){
        console.log(data.pictureUrl, data.pictureName, pictureAltText);

        var img = new Image();
        img.src = data.pictureUrl;
        img.setAttribute('alt', data.pictureAltText);

        img.onload = function(){
            // Displaying picture when download completed
            $(img).appendTo('body');
        }
    });
</script> 
```

如果您不使用 jQuery，则必须使用[XMLHttpRequest来获取 JSON 编码的响应并对其进行解析（您可以在](http://en.wikipedia.org/wiki/XMLHttpRequest)[https://developer.mozilla.org/en-US/docs/JSON](https://developer.mozilla.org/en-US/docs/JSON)上查看 MDN 文档）。

# dojo - 如何以编程方式编辑 dojo.TitlePane 的样式（字体颜色）

> ID：12611387
> 
> 赞同：0
> 
> 时间：2012-09-26T22:25:34.397
> 
> 标签：dojo

我有一个我想更改字体颜色的 TitlePane。我就是不能。我需要以编程方式执行此操作。

到目前为止，我有这样的事情：

```
var newPane = new TitlePane({title: paneName}); 
```

我也试过这个：

```
var newPane = new TitlePane({title: paneName, id: paneName, style:{color:'red'}}); 
```

这会将窗格的内容设置为红色，并且不会在任何地方添加 id :(

根据此[API 信息](http://dojotoolkit.org/reference-guide/1.7/dijit/TitlePane.html#dijit-titlepane)，我只能设置三个属性（标题、内容和打开）。我怎么能在 TitlePane 中添加 id 和 style(color) ！请

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T05:05:57.407

通过级联样式表对其进行样式设置。在 jsFiddle 看看它是如何工作的：http: [//jsfiddle.net/phusick/63dHY/](http://jsfiddle.net/phusick/63dHY/)

更改`TitlePane`标题文本的颜色`id`

```
var titlePane1 = new TitlePane({
    id: "titlePane1",
    title: "some red title",
    content: "Collapse me!"            
}, "titlePane1"); 
```

使用以下样式：

```
#titlePane1 .dijitTitlePaneTextNode {
    color: red;
} 
```

或通过`class`

```
var titlePane2 = new TitlePane({
    title: "some blue title",
    content: "Collapse me!"
}, "titlePane2");

domClass.add(titlePane2.domNode, "blue");   // as of 'dojo/dom-class' module 
```

使用以下样式：

```
.blue .dijitTitlePaneTextNode {
    color: blue !important;
} 
```

​或直接通过 JavaScript 更改（我不推荐）：

```
titlePane2.titleNode.style.color = "green"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-08T17:26:53.770

```
newPane.style({color: "red"}); 
```

或者

```
query(newPane).style({color: "red"}); 
```

或者

```
newPane.style.color = "red"; 
```

# c# - WinForms 中表格的 Z 顺序

> ID：12611395
> 
> 赞同：1
> 
> 时间：2012-09-26T22:26:09.627
> 
> 标签：c#, winforms

我有5种形式如下：

*   表格1
*   表格2
*   表格3
*   表格4
*   表格5

Form1是我的启动表单。我在这个表单中有4个按钮来显示其他表单（form2，form3，form4，form5）。我想在form1后面显示其他表单，然后当我最小化form1时，其他表单也最小化，当我恢复 form1 其他表单也恢复了。但是 form1 总是在其他表单的顶部。

我该如何实施？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T22:51:53.813

以你的最佳形式试试这个。

```
private List<Form> subForms;
private bool minimized = false;

public TopForm()
{
    InitializeComponent();
    subForms = new List<Form>();
    subForms.Add(new SubForm(1));
    subForms.Add(new SubForm(2));
    subForms.Add(new SubForm(3));
    subForms.Add(new SubForm(4));
    subForms.Add(new SubForm(5));

    foreach (Form f in subForms)
    {
        f.Show();
    }

    BringToFront();
    Resize += OnResize;
}

/// <summary>
/// Detects a resize event and handles it according to window state.
/// </summary>
/// <param name="sender">Top form</param>
/// <param name="args">Unused</param>
private void OnResize(object sender, EventArgs args)
{
    switch (WindowState)
    {
    case FormWindowState.Normal:
        if (minimized)
        {
            minimized = false;
            OnRestore();
        }
        break;
    case FormWindowState.Minimized:
        minimized = true;
        OnMinimize();
        break;
    }
}

/// <summary>
/// Minimize all sub forms
/// </summary>
public void OnMinimize()
{
    foreach (Form form in subForms)
    {
        form.WindowState = FormWindowState.Minimized;
    }
}

/// <summary>
/// Restore all forms and bring them to the front, with this main form on top.
/// </summary>
public void OnRestore()
{
    foreach (Form form in subForms)
    {
        form.WindowState = FormWindowState.Normal;
        form.BringToFront();
    }
    BringToFront();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:39:39.403

使用组合继承将 Z 顺序表单的任务委托给 Form1 类，或者为可以访问所有这些表单的变量的那些表单创建一个中间类。然后：

设置最顶层：

```
<Form>.TopMost = True; 
```

请参阅：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.form.topmost (v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.topmost(v=vs.71).aspx)

要以特定顺序恢复和最小化表单（这将在您的控制类中）以相反的顺序恢复它们，这意味着您先显示表单 4，然后显示表单 3，然后显示表单 2，然后显示表单 1，然后设置表单 1 的最顶层属性。

然后，在每个表单中使用最小化的处理程序并将其与您的控制器代码集成，这样当 Form1 被最小化时，其他所有内容都会最小化（反之亦然）

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T23:00:17.590

子窗体出现在主窗体后面真的有意义吗？如果父窗体完全最大化怎么办？

否则，每个表单的按钮单击将如下所示：

```
private void subFormBtn_Click(object sender, EventArgs e)
        {
            SubForm subForm = new SubForm();
            subForm.Show(this);

        } 
```

这会将子表单的父级设置为包含单击按钮的表单。

如果您确实需要子表单出现在主表单后面，则需要执行 Benjamin Danger Johnson 建议的操作。

# objective-c - 如何在整个应用程序生命周期中获得有关每个 UIImage 初始化的通知？

> ID：12611398
> 
> 赞同：0
> 
> 时间：2012-09-26T22:26:23.323
> 
> 标签：objective-c, ios, memory-management, notifications, key-value-observing

一方面，我只是好奇。

另一方面，我必须以**某种方式计算创建的图像数量**（以触发一定数量的清理）。不幸的是，内存警告通知我太晚了，应用程序在我有机会做出反应之前就被终止了，所以我想解决这个问题。

我可以用一个全局计数器分散在我的项目周围，在我进行任何 UIImage 操作之前它会递增，但显然这正是我想要避免的，这将导致无法维护的设计。

所以我在考虑子类 UIImage 初始化程序（某种 MYImage 类），而不是在整个项目中使用 MYImage，但 UIImageView 无论如何都会使用 UIImages（也许我可以设置 UIImageView 的 setImage 方法，但我敢打赌 UIKit 在很多情况下使用实际的 _image 实例变量）。

最好的办法是从 UIImage 大小中计算像素数量，这样我就可以将图像内存刷新到给定的像素数之上。

有什么通知吗？通过类别的东西？或者某种 NSObject KVO 观察（对类/方法名称进行文字检查）？你有想法/经验吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:11:23.957

有很多方法可以实现这一点。一种方法是覆盖子类中的一个（或多个）图像创建方法，获取创建的图像的大小，并将其添加到用户默认值以跟踪所有图像的累积大小。例如，我像这样覆盖 imageNamed：

```
@implementation RDImage

+(UIImage *)imageNamed:(NSString *) name {
    UIImage *anImage = [super imageNamed:name];
    double oldSize = [[NSUserDefaults standardUserDefaults] doubleForKey:@"SizeAsWxH"];
    [[NSUserDefaults standardUserDefaults] setDouble:(anImage.size.width * anImage.size.height) + oldSize forKey:@"SizeAsWxH"];
    if ([[NSUserDefaults standardUserDefaults] doubleForKey:@"SizeAsWxH"] > 6912) {
        NSLog(@"Too big -- do something");
    }
    return anImage;
} 
```

在 applicationDidFinishLaunchingWithOptions: 方法中，我将该键的值设置为零。

在创建图像时的视图控制器中，我只是使用我的类来制作一个新的：

```
UIImage *anImage = [RDImage imageNamed:.... 
```

另一种方法是覆盖 UIImageView 的 setImage: 方法，并在该方法中执行相同的操作。

# iphone - 尝试上传应用程序得到“在顶级应用程序包装下找不到 info.plist 中指定的图标

> ID：12611407
> 
> 赞同：0
> 
> 时间：2012-09-26T22:26:56.950
> 
> 标签：iphone

我正在尝试将我佣人的新应用程序上传到 iTunes 商店。我收到以下错误“在顶级应用程序包装器下找不到 info.plist 中指定的图标我已通过拖放夏季屏幕添加图标

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:29:42.490

检查图标文件是否已添加到**Copy Bundle Resources**构建阶段。

# delphi - Delphi 动态方法调用

> ID：12611409
> 
> 赞同：0
> 
> 时间：2012-09-26T22:27:05.657
> 
> 标签：delphi, dynamic, methods, invoke

有谁知道 Delphi 2009 及以下版本的免费库，它允许您动态调用方法？

我已经开始为此编写自己的代码，但我觉得它超出了我的范围。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T00:28:33.280

你的问题比较模糊。除了后期绑定和脚本之外，它还可能意味着使用一个直到运行时才知道名称的方法。

这分为两类，COM 方法（使用变体类型）或使用 RTTI 找到和调用的 Delphi 方法。尽管 RTTI 在最新的 Delphi 版本中发生了变化，但我认为 [http://www.blong.com/Conferences/BorConUK98/DelphiRTTI/CB140.htm](http://www.blong.com/Conferences/BorConUK98/DelphiRTTI/CB140.htm)将适用于 D2009

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T23:05:56.470

“动态调用方法”可能意味着许多不同的事情。简单的后期绑定以声明为`virtual`or的方法的形式内置于语言中`dynamic`，您可能一直都在使用它们，尤其是`virtual`那些。

但是谈论“动态调用方法”通常会进入*脚本*领域，从而可以获取一个对象并让最终用户在运行时通过使用方法的名称来决定调用哪个方法。如果你想要，你需要一个 Delphi 的脚本库。

[DWS](http://code.google.com/p/dwscript/)（Delphi Web Script）运行良好，作者声称它支持 D2009，尽管积极的开发工作是在 XE 上进行的。此外，顾名思义，DWS 的设计主要考虑了 Web 开发，因此将脚本绑定到本机代码领域中的对象的框架比它应该的要复杂得多。

另一个主要的替代方案是 RemObjects 的[PascalScript](http://www.remobjects.com/ps.aspx)库。它支持比 D2009 更早的版本，并且它的对象绑定系统比 DWS 简单得多。不幸的是，它的速度也慢得多，而且作者也没有很好地支持它。但是，特别是对于简单的脚本，任何一个都应该让您能够允许用户动态地自动化您程序中的内容。

# iphone - 未定义符号和重复符号错误。可以为调试或发布而构建，但不能两者兼而有之

> ID：12611410
> 
> 赞同：1
> 
> 时间：2012-09-26T22:27:10.720
> 
> 标签：iphone, objective-c, xcode, xcode4.5

我对包含另一个项目的项目有疑问。第二个项目是主项目所需的 SDK。目前，我将 SDK 作为静态库包含在主项目中。SDK 和主项目都包含 FBConnect 和非官方 Twitter SDK 框架。我相信我的问题是两个项目中都包含这些框架的结果，但我一直无法找到一种方法让它们无错误地共存。

当项目为调试而构建时，它不会为存档而构建，反之亦然。我每次都可以通过执行相同的步骤来解决问题，但我想找到一种方法来解决它，而在调试和存档构建之间不需要任何步骤。

当项目构建以进行调试而没有任何错误时，我在尝试归档构建时得到以下信息：

```
Undefined symbols for architecture armv7:
  "_OBJC_CLASS_$_SBJSON", referenced from:
      objc-class-ref in FBRequest.o
      objc-class-ref in libSDK.a(ApiTvDiscussView.o)
      objc-class-ref in libSDK.a(ApiWebView.o)
ld: symbol(s) not found for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

[然后，根据链接的屏幕截图](http://d.pr/i/VT55)，我将 FBConnect 框架使用的 SBJSON 库的实现文件添加到目标的构建阶段中的编译源中：

这会产生一个不同的问题，如下所示：

```
 duplicate symbol _OBJC_METACLASS_$_OAHMAC_SHA1SignatureProvider in:
        /Users/Alan/Library/Developer/Xcode/DerivedData/App-gpvfsbaxxbvhsddtcbgkggquyltl/Build/Intermediates/ArchiveIntermediates/App/IntermediateBuildFilesPath/App.build/Release-iphoneos/App.build/Objects-normal/armv7/OAHMAC_SHA1SignatureProvider.o
./libSDK.a(OAHMAC_SHA1SignatureProvider.o)

    .
    .
    .
    .
    .

    duplicate symbol _OBJC_CLASS_$_TwitterDialog in:
        /Users/Alan/Library/Developer/Xcode/DerivedData/App-gpvfsbaxxbvhsddtcbgkggquyltl/Build/Intermediates/ArchiveIntermediates/App/IntermediateBuildFilesPath/App.build/Release-iphoneos/App.build/Objects-normal/armv7/TwitterDialog.o
        ./libSDK.a(TwitterDialog.o)
    duplicate symbol _OBJC_METACLASS_$_TwitterDialog in:
        /Users/Alan/Library/Developer/Xcode/DerivedData/App-gpvfsbaxxbvhsddtcbgkggquyltl/Build/Intermediates/ArchiveIntermediates/App/IntermediateBuildFilesPath/App.build/Release-iphoneos/App.build/Objects-normal/armv7/TwitterDialog.o
        ./libSDK.a(TwitterDialog.o)
    ld: 43 duplicate symbols for architecture armv7
    clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

从目标的 Build Phases 中的 Compile Sources 中删除 Unofficial Twitter SDK 框架使用的 OAUTH 库的实现文件会删除这些错误，并且项目存档构建成功。

当我尝试构建项目进行调试时，我得到了与这些错误相反的错误，首先 OAUTH 库符号未定义。将它们添加到编译源可以解决问题，然后复制 SBJSON 符号。从编译源中删除它们可以使调试构建成功完成。

有谁知道一种让这些和谐共存的方法，这样我就可以同时调试和归档项目构建，而无需每次都处理这个文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T11:04:00.720

Twitter 和 Facebook 库都链接到同一个 SBJSON 框架。从代码构建它们，而不是使用静态库。执行此操作时，请从其中一个 SDK 中删除 SBJSON 引用。

这是我讨厌针对静态库进行构建的另一个原因。如果您没有源代码并且库制造商没有为他的类/方法添加前缀，那么问题将无法解决。

或者，您可以使用新发布的 Facebook SDK 版本 3.1，他们最终将 SBJSON 前缀为 FBSBJSON。

# xslt - 参数值未在 xslt 调用模板中传递

> ID：12611421
> 
> 赞同：1
> 
> 时间：2012-09-26T22:27:55.513
> 
> 标签：xslt, xslt-2.0

对 XSLT 来说相当新，并将 with-param 视为完成某事的一种方式。

```
 <xsl:variable name="PQB_ID">
         <!-- <xsl:value-of select="wd:SSN"/> -->
           <xsl:value-of>123</xsl:value-of>
         </xsl:variable>

         <xsl:call-template name="testing">
                 <xsl:with-param name="PQB_ID"></xsl:with-param>
         </xsl:call-template> 
```

我的模板名称如下：

```
<xsl:template name="testing">
   <xsl:param name="PQB_ID"></xsl:param>
   <xsl:value-of select="$PQB_ID"></xsl:value-of>
</xsl:template> 
```

至少，我希望看到 123。或者，当 my`<xsl:value-of select="wd:SSN"/>` 未注释时，我希望看到我的程序中的值。事实上，我什么也得不到。

我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T23:06:45.887

```
<xsl:with-param name="PQB_ID"></xsl:with-param> 
```

将为参数传递一个空值。如果要传递全局 PQB_ID 变量的值，则需要显式地这样做

```
<xsl:with-param name="PQB_ID" select="$PQB_ID"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:49:59.160

还要注意，在 XSLT 2.0 中，在 xsl:param 中声明预期参数的类型是一个非常好的主意。你期待一个字符串吗？一个整数？我不希望您期待一个文档节点，这是您使用代码仔细创建的

```
 <xsl:variable name="PQB_ID">
   <xsl:value-of>123</xsl:value-of>
 </xsl:variable> 
```

如果模板需要一个整数，那么您不需要一个全新的文档来包含它；写吧

```
<xsl:variable name="PQB_ID" select="123"/> 
```

# java - 无法解析对 bean 'dataSource' Spring3 + Struts 2 的引用

> ID：12611422
> 
> 赞同：2
> 
> 时间：2012-09-26T22:28:05.380
> 
> 标签：java, jsp, struts2, spring-security

我正在尝试使用数据库从 spring 管理登录系统，我按照本教程创建了我的数据库：[http ://www.mkyong.com/spring/maven-spring-jdbc-example/](http://www.mkyong.com/spring/maven-spring-jdbc-example/)

我创建了一个包含以下内容的**datasource.xml**文件：

```
<beans xsi:schemaLocation="http://www.springframework.org/schema/beans
 http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="com.mysql.jdbc.Driver"/>
        <property name="url" value="jdbc:mysql://localhost:3306/login"/>
        <property name="username" value="root"/>
        <property name="password" value="pass"/>
    </bean>

</beans> 
```

这是我的security.xml：

```
<?xml version="1.0" encoding="UTF-8"?>

<!--
  - Configuracion de Muestra
  -
  -->

<beans:beans xmlns="http://www.springframework.org/schema/security"
xmlns:beans="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.springframework.org/schema/beans 
                http://www.springframework.org/schema/beans/spring-beans.xsd
                http://www.springframework.org/schema/security 
                http://www.springframework.org/schema/security/spring-security-3.1.xsd">

<beans:bean class="org.springframework.security.web.access.expression.DefaultWebSecurityExpressionHandler"/>

      <http auto-config='true'>

    <intercept-url pattern="/**" access="ROLE_USER" />
    <form-login default-target-url='/example/index.jsp'
            always-use-default-target='true' />
    </http>

  <authentication-manager>
       <authentication-provider>
        <jdbc-user-service data-source-ref="dataSource"

           users-by-username-query="
              select nombre,password 
              from usuarios where username=?" 

           authorities-by-username-query="
              select u.nombre, ur.rol from usuarios u, usuarios_roles ur 
              where u.user_id = ur.user_id and u.username =?  " 

        />
       </authentication-provider>
    </authentication-manager>

</beans:beans> 
```

但是我在部署时遇到了下一个错误：

> 设置 bean 属性“dataSource”时无法解析对 bean“dataSource”的引用；嵌套异常是 org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'dataSource' is defined

我不知道出了什么问题:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T23:38:17.530

您是否通过数据源包含文件`<import resource="datasource.xml" />`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-25T14:52:48.970

我在日志的开头遇到了这个错误，除了我在日志的底部也有一个错误：`java.lang.NoClassDefFoundError`

缺少一个 jar，因为它没有部署。只需在启动服务器之前将其添加到 tomcat 就可以了。

# java - Android，OpenGL ES 2.0 - 为什么为 ByteBuffer.allocateDirect 调用设置每个浮点数 4 个字节？

> ID：12611424
> 
> 赞同：0
> 
> 时间：2012-09-26T22:28:12.720
> 
> 标签：java, android, opengl-es-2.0

从示例中复制和粘贴源代码是一回事，但我正在寻找一些答案来解释为什么这些示例是这样的。

我无法回答的一个问题是为什么三角形的 ByteBuffer 每个坐标需要四个字节。

在[Google 提供的示例中，](http://developer.android.com/training/graphics/opengl/shapes.html)一个 ByteBuffer 被实例化为每个三角形坐标四个字节。

```
 // initialize vertex byte buffer for shape coordinates
    // (number of coordinate values * 4 bytes per float)
    ByteBuffer bb = ByteBuffer.allocateDirect(triangleCoords.length * 4);

    // use the device hardware's native byte order
    bb.order(ByteOrder.nativeOrder()); 
```

1.  为什么每个坐标是四个字节而不是 2 或 8 个？
2.  nativeOrder() 调用的目的是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:36:12.750

浮点数由 32 位表示，等于 4 个字节。

对本机顺序的调用将缓冲区中的字节重新排列为本机系统的顺序，大端，小端等。

# c++ - iPhone 应用程序因 C++ 代码而崩溃

> ID：12611426
> 
> 赞同：2
> 
> 时间：2012-09-26T22:28:23.083
> 
> 标签：c++, objective-c, arrays, malloc

我编写了一个代码片段来为我的应用程序实现 LCS 算法。在这个算法中，我使用 malloc 实现了一个数组。但是，我不确定我是否做错了什么。我找不到任何显示原因的特定消息。我找不到出路。

注意：我有弧

我的代码如下

```
- (IBAction)buttonAction:(id)sender
{
    [self getInlineDiffofFragment1:[NSArray arrayWithObjects:@"line1", @"line2", @"line3", @"line4", @"line5", nil] andFragment2:[NSArray arrayWithObjects:@"line1", @"line2", @"line4", @"line6", nil]];
}

- (void)getInlineDiffofFragment1:(NSArray*)fragment1 andFragment2:(NSArray*)fragment2
{
    int row = fragment1.count + 1;
    int col = fragment2.count + 1;
    int *lcs = (int*)malloc(sizeof(int) * row * col); //2d array
    NSString *str;
    for (int i = 0; i <= fragment1.count; i++) {
        lcs[i * row] = 0;
    }
    for (int j = 0; j <= fragment2.count; j++) {
        lcs[0 + j] = 0;
    }

    for (int i = 1; i < row; i++) {
        str = [NSString stringWithFormat:@""];
        for (int j = 1; j < col; j++) {
            int xy = i * row + j;
            if ([[fragment1 objectAtIndex:i - 1] isEqualToString:[fragment2 objectAtIndex:j - 1]]) {
                lcs[xy] = lcs[(i - 1) * row + (j - 1)] + 1;
            } else {
                lcs[xy] = MAX(lcs[(i - 1) * row + j], lcs[i * row + (j - 1)]);
            }
            str = [str stringByAppendingFormat:@"%d ", lcs[xy]];
        }
        NSLog(@"%@", str);
    }

    free(lcs);
    NSLog(@"freed");
} 
```

该函数按预期完美打印结果并退出该块。结果如下

```
2012-09-26 16:14:18.727 TestDiff[56178:11303] 1 1 1 1 
2012-09-26 16:14:18.733 TestDiff[56178:11303] 1 2 2 2 
2012-09-26 16:14:18.734 TestDiff[56178:11303] 1 2 2 2 
2012-09-26 16:14:18.735 TestDiff[56178:11303] 1 2 3 3 
2012-09-26 16:14:18.736 TestDiff[56178:11303] 1 2 3 3 
2012-09-26 16:14:18.736 TestDiff[56178:11303] freed 
```

打印结果并退出块后，它会崩溃。崩溃报告如下

![在此处输入图像描述](../Images/7b17de26022fd2ec32716074cf19eac4.png)

该程序可以用于以下测试功能

```
#define WIDTH 4
#define HEIGHT 5
#define INDEXOF(x,y) ((y*WIDTH) + x)

- (void)testArray
{
    NSString *str;
    int *myArray = (int *) malloc(sizeof(int) * 5 * 4);  // 4 * 5 array
    for(int x=0; x<WIDTH; x++){
        str = [NSString stringWithFormat:@""];
        for(int y=0; y<HEIGHT; y++){
            myArray[INDEXOF(x,y)] = y;
            str = [str stringByAppendingFormat:@"%d ", myArray[INDEXOF(x, y)]];
        }
        NSLog(@"%@", str);
    }
    free(myArray);
} 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:50:40.633

转到您的构建设置并查找名为“Compile Source As”的项目。将其值更改为“Objective C++”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:58:31.400

您是否尝试过在与 的行上放置一个断点`free(myArray);`？它是否成功地达到了这一点，然后在您跨过它时崩溃？

此外，如果你得到 EXC_BAD_ACCESS，你应该尝试[打开僵尸](https://stackoverflow.com/questions/2190227/how-do-i-set-up-nszombieenabled-in-xcode-4)，看看是否已经发布了一些东西。

# django - 多表继承南移

> ID：12611427
> 
> 赞同：6
> 
> 时间：2012-09-26T22:28:23.257
> 
> 标签：django, django-models, django-south

我有两个以前从 models.Model 继承的模型，现在我将它们重构为从同一个基本模型继承。Django 正在为此使用多表继承，我正在尝试为此生成模式和数据迁移。*数据库中有现有数据需要迁移*。

我知道 Django 创建了一个 OneToOneField，但我不明白它如何影响数据库中的现有项目。

## 继承前

```
class BlogPost(models.Model):
    name = models.CharField()
    published_on = models.DateTimeField()

class AudioFile(models.Model):
    file = models.FileField()
    published_on = models.DateTimeField() 
```

## 继承后

```
class Published(models.Model):
    published_on = models.DateTimeField()

class BlogPost(Published):
    name = models.CharField()

class AudioFile(Published):
    file = models.FileField() 
```

## 移民

这基本上是我运行时生成的迁移：

`./manage.py schemamigration app --auto`.

生成的文件：

```
class Migration(SchemaMigration):
    def forwards(self, orm):
        db.create_table('app_published', (
            ('id', self.gf('django.db.models.fields.AutoField')(primary_key=True)),
            ('published_on', self.gf('django.db.models.fields.DateTimeField')()),
        ))
        db.send_create_signal('app', ['Published'])

        db.delete_column('app_blogpost', 'published_on')
        db.delete_column('app_blogpost', 'id')
        db.add_column('app_blogpost', 'published_ptr', self.gf('django.db.models.fields.related.OneToOneField')(default=None, to=orm['app.Published'], unique=True, primary_key=True), keep_default=False)

        db.delete_column('app_audiofile', 'published_on')
        db.delete_column('app_audiofile', 'id')
        db.add_column('app_audiofile', 'published_ptr', self.gf('django.db.models.fields.related.OneToOneField')(default=None, to=orm['app.Published'], unique=True, primary_key=True), keep_default=False) 
```

当我尝试运行它时，它会引发 IntegrityError：

```
column "published_ptr_id" contains null values 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-26T23:30:00.473

您将需要将其分解为三个迁移：

1.  Schemamigration 创建 app_published 表，并添加两个新的 published_ptr 列。添加这些新列`null=True`而不是 with `primary_key=True`：

    ```
    db.create_table('app_published', (
        ('id', self.gf('django.db.models.fields.AutoField')(primary_key=True)),
        ('published_on', self.gf('django.db.models.fields.DateTimeField')()),
    ))
    db.add_column('app_blogpost', 'published_ptr', self.gf('django.db.models.fields.related.OneToOneField')(default=None, to=orm['app.Published'], null=True), keep_default=False)
    db.add_column('app_audiofile', 'published_ptr', self.gf('django.db.models.fields.related.OneToOneField')(default=None, to=orm['app.Published'], null=True), keep_default=False) 
    ```

2.  数据迁移以迭代您现有的音频文件和博客文章。代码基本上是：

    ```
    for blogpost in orm.BlogPost.objects.all():
        published = orm.Published.objects.create(published_on=blogpost.published_on)
        blogpost.published_ptr = published
        blogpost.save()

    for audiofile in orm.AudioFile.objects.all():
        published = orm.Published.objects.create(published_on=audiofile.published_on)
        audiofile.published_ptr = published
        audiofile.save() 
    ```

3.  Schemamigration 从旧模型中删除（现在未使用的） id 和 published_on 列。此外，将旧模型上的published_ptr 从更改`null=True`为。`primary_key=True`

    ```
    db.delete_column('app_blogpost', 'published_on')
    db.delete_column('app_blogpost', 'id')
    db.delete_column('app_audiofile', 'published_on')
    db.delete_column('app_audiofile', 'id')

    db.alter_column('app_blogpost', 'published_ptr', self.gf('django.db.models.fields.related.OneToOneField')(default=None, to=orm['app.Published'], null=False))
    db.alter_column('app_audiofile', 'published_ptr', self.gf('django.db.models.fields.related.OneToOneField')(default=None, to=orm['app.Published'], null=False))

    db.create_index('app_blogpost', ['published_ptr'], unique=True)
    db.create_index('app_audiofile', ['published_ptr'], unique=True)
    db.create_primary_key('app_blogpost', ['published_ptr'])
    db.create_primary_key('app_audiofile', ['published_ptr']) 
    ```

# sql-server-2008 - 如何使用 Visual Studio 2012 生成测试数据？

> ID：12611428
> 
> 赞同：6
> 
> 时间：2012-09-26T22:28:37.827
> 
> 标签：sql-server-2008, visual-studio-2012

如何使用 Visual Studio 2012 生成测试数据？

我找到了这两篇关于如何使用 VS 2010 进行操作的文章。但是 VS 2012 呢？

*   [SQL Server 2008 R2 测试数据加载使用VS2010](http://www.jnrit.com.au/2011/05/15/SQL-Server-2008-R2-Test-Data-Load-Using-VS2010.aspx)
*   [使用数据生成器为数据库生成测试数据](http://msdn.microsoft.com/en-us/library/dd193262%28v=vs.100%29.aspx)

我的数据库是 SQL-Server 2008-R2 数据库。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T00:54:15.673

虽然此功能在 Visual Studio 2010 中（如果您添加了 VSTE DBPRO），但它还[没有在 Visual Studio 2012 / SSDT](http://social.msdn.microsoft.com/Forums/en-US/ssdt/thread/5ce89ff5-3ce4-4a88-b43b-7da1794697bf)中实现。这并不意味着它不会在下一个版本之前进入产品——它可以作为功能包、[电动工具](http://visualstudiogallery.msdn.microsoft.com/96a2f8cc-0c8b-47dd-93cd-1e8e9f34a917)甚至是服务包提供。[与数据库单元测试和数据比较功能相同](http://social.msdn.microsoft.com/Forums/en-US/ssdt/thread/158edfb4-3712-4468-b37e-f454ad8a984d/)。

正如我在评论中建议的那样，与此同时，您可以使用像[RedGate 的 SQL Data Generator](http://www.red-gate.com/products/sql-development/sql-data-generator/)这样的 3rd 方工具。另请参阅[此问题](https://stackoverflow.com/questions/1577063/sql-server-data-generation)以了解其他一些选项。并挂在那里。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-01T19:40:05.270

从现在开始，我们将需要依赖 3rd 方工具，因为 Microsoft 将来不会支持此功能。 [http://blogs.msdn.com/b/ssdt/archive/2013/06/24/announcing-sql-server-data-tools-june-2013.aspx](http://blogs.msdn.com/b/ssdt/archive/2013/06/24/announcing-sql-server-data-tools-june-2013.aspx) 搜索“数据生成不包括且不打算未来发布”

如果我们使用测试驱动开发，这没什么大不了的。在 TDD 中，我们将有组件测试接触数据库（全场景覆盖）。我们可以使用相同的模块来创建测试数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T23:10:28.327

VS 2012 根本不支持数据库单元测试。

# java - Java Apache Commons WordUtils.wrap() 在运行时抛出 SecurityException

> ID：12611431
> 
> 赞同：-1
> 
> 时间：2012-09-26T22:29:23.437
> 
> 标签：java, apache, runtime-error, word-wrap, securityexception

好吧，所以在实现了这个`org.apache.commons.lang3.text.WordUtils`类之后，我希望能够使用这个`WordUtils.wrap(String str, int width)`函数。但我遇到了减速带。

我能够毫无问题地编译这个程序（我应该提到的是一个小程序）。我只需要设置一个 CLASSPATH 环境变量来引用 apache jar 文件，然后通过 appletviewer 让程序运行。但是，当我到达使用该`WordUtils.wrap()`函数的代码部分时，一切都变糟了，我在命令提示符下收到大约 20 行运行时错误。

错误：

```
Caught a SecurityException reading the system property 'awt.toolkit'; the System
Utils property value will default to null.
Caught a SecurityException reading the system property 'file.encoding'; the Syst
emUtils property value will default to null.
Caught a SecurityException reading the system property 'java.awt.fonts'; the Sys
temUtils property value will default to null.
Caught a SecurityException reading the system property 'java.awt.graphicsenv'; t
he SystemUtils property value will default to null.
Caught a SecurityException reading the system property 'java.awt.headless'; the
SystemUtils property value will default to null.
Caught a SecurityException reading the system property 'java.awt.printerjob'; th
e SystemUtils property value will default to null.
Caught a SecurityException reading the system property 'java.class.path'; the Sy
stemUtils property value will default to null.
Caught a SecurityException reading the system property 'java.compiler'; the Syst
emUtils property value will default to null.
Caught a SecurityException reading the system property 'java.endorsed.dirs'; the
 SystemUtils property value will default to null.
Caught a SecurityException reading the system property 'java.ext.dirs'; the Syst
emUtils property value will default to null.
Caught a SecurityException reading the system property 'java.home'; the SystemUt
ils property value will default to null.
Caught a SecurityException reading the system property 'java.io.tmpdir'; the Sys
temUtils property value will default to null.
Caught a SecurityException reading the system property 'java.library.path'; the
SystemUtils property value will default to null.
Caught a SecurityException reading the system property 'java.runtime.name'; the
SystemUtils property value will default to null.
Caught a SecurityException reading the system property 'java.runtime.version'; t
he SystemUtils property value will default to null.
Caught a SecurityException reading the system property 'java.util.prefs.Preferen
cesFactory'; the SystemUtils property value will default to null.
Caught a SecurityException reading the system property 'java.vm.info'; the Syste
mUtils property value will default to null.
Caught a SecurityException reading the system property 'user.country'; the Syste
mUtils property value will default to null.
Caught a SecurityException reading the system property 'user.region'; the System
Utils property value will default to null.
Caught a SecurityException reading the system property 'user.dir'; the SystemUti
ls property value will default to null.
Caught a SecurityException reading the system property 'user.home'; the SystemUt
ils property value will default to null.
Caught a SecurityException reading the system property 'user.language'; the Syst
emUtils property value will default to null.
Caught a SecurityException reading the system property 'user.name'; the SystemUt
ils property value will default to null.
Caught a SecurityException reading the system property 'user.timezone'; the Syst
emUtils property value will default to null. 
```

这是导致所有这些麻烦的代码行：

```
String strWrap = WordUtils.wrap("A really really really really really long sentence.", 50); 
```

这里发生了什么事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:02:59.240

如何将行分隔符作为参数传递以绕过 SystemUtils 访问：

```
String strWrap = WordUtils.wrap("A really really really really really long sentence.", 50, "\n", false); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:41:15.030

您的代码使用调用[SystemUtils的](http://www.docjar.com/html/api/org/apache/commons/lang/WordUtils.java.html)[WordUtils](http://www.docjar.com/html/api/org/apache/commons/lang/SystemUtils.java.html)来查找系统使用的行分隔符：

```
newLineStr = SystemUtils.LINE_SEPARATOR; 
```

由于浏览器的安全限制，SystemUtils 正在尝试读取可能不允许小程序读取的系统属性。

SystemUtils的[文档说：](http://commons.apache.org/lang/api-2.4/org/apache/commons/lang/SystemUtils.html)

> 如果由于安全限制无法读取系统属性，则将此类中的相应字段设置为`null`并写入消息`System.err`

# ruby-on-rails - 来自formtastic的复选框不适用于mongoid

> ID：12611434
> 
> 赞同：0
> 
> 时间：2012-09-26T22:29:50.747
> 
> 标签：ruby-on-rails, ruby, gem, mongoid, formtastic

我正在以添加新闻的形式工作。所以我希望用户使用复选框从可用类别中进行选择。但是formtastic一直在打印奇怪的东西。

PD。我正在使用 active-admin 并且我的所有资源都正常工作

我的关系是：新闻有和belongs_to_many 类别。

这就是我尝试打印的方式

```
<%=e.label :categorias %>
<%=e.check_boxes :categoria_ids, Hash[Categoria.all.map {|ca| [ca.nombre, ca.id]}]%> 
```

如果我将 check_boxes 更改为选择，它会完美运行。但这不是我要找的。

这是我得到的。类别 [#", label="Educativo">​​, #", label="Música">, #", label="Deportivos">]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:24:09.850

```
<%=e.check_boxes :categorias, Hash[Categoria.all.map {|ca| [ca.nombre, ca.id]}]%> 
```

# javascript - 通过 JS 访问 Chrome 最后检查的元素是 $0 和 $1

> ID：12611440
> 
> 赞同：1
> 
> 时间：2012-09-26T22:30:39.040
> 
> 标签：javascript, jquery, google-chrome, google-chrome-extension, google-chrome-devtools

可以使用 javascript 访问 Chrome 最后检查的元素吗？

背景，试图将其集成到一个 Debug.js 文件中以调用 onclick。 [https://stackoverflow.com/a/12596540/511438](https://stackoverflow.com/a/12596540/511438)

我正在尝试集成上面提供的功能以在可点击元素上执行。

这是我的尝试，即使我在执行此操作之前检查了元素，也会导致未定义。

```
$(document).on('click', "#debugelements", 
    function () { CompareElements(window.$0, window.$1); }); 
```

和

```
function CompareElements(a, b)
{
... as per the answer above.
} 
```

我怀疑 javascript 无法访问 $0。有没有办法在 javascript 中执行此操作而不将整个函数粘贴到 Chrome 控制台中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T09:10:30.213

恐怕只有 Chrome 扩展程序才能访问这些变量。有一个使用 的示例扩展`$0`，它称为“Chrome Query”，可在[示例页面](http://developer.chrome.com/extensions/samples.html)上找到。我拿了它的代码，做了一点修改，最后得到了[这个扩展](https://chrome.google.com/webstore/detail/pefnhibkhcfooofgmgoipfpcojnhhljm)。代码可在[github](https://github.com/kdzwinel/CSS-Diff)上找到。我不确定它在当前形式下是否特别有用，但还有很大的改进空间。表格而不是树应该更具可读性，我将在下周尝试实现它。

![CSS Diff 扩展的屏幕截图](../Images/a0401cfeeef1bad979f8a5662f97500d.png)

# c - 使用 GoogleTest 访问项目中包含的 jpg 文件的最佳方法是什么？

> ID：12611447
> 
> 赞同：0
> 
> 时间：2012-09-26T22:31:47.990
> 
> 标签：c, xcode, googletest

好的，所以我正在使用 GoogleTest，并且我已经包含了一个 Images 文件夹，其中包含我希望在测试中使用的 jpg 图像。但我不想硬编码路径。

如何通过文件的一些相对路径进行引用？

我查看了 getcwd，但当然，我得到了 Xcode Products/Debug 文件夹。

然后我想也许有办法将该jpg图像复制到构建文件夹中？

关于如何解决这个问题的建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T15:09:36.923

找到了一个解决方案，它又快又脏。如果你找到更好的让我知道。

在项目目标 -> 构建阶段选项卡 -> 根据面板复制文件。

我使用了目标资源。删除了子路径，并删除了仅在安装时复制旁边的复选标记。

单击 + 添加文件。

从 GoogleTest，相对路径是

字符串 getImagePath() { 字符 cwd[256];

```
 getcwd(cwd,sizeof(cwd));

    stringstream ss;
    ss << cwd << "/image.jpeg";

    return ss.str();
} 
```

希望这可以帮助某人。

# entity-framework - 实体框架5的源码在哪里

> ID：12611454
> 
> 赞同：4
> 
> 时间：2012-09-26T22:32:19.587
> 
> 标签：entity-framework, entity-framework-5

我知道 EF 在 CodePlex 上是开源的，但我没有看到当前发布的 5.0 版本的分支。我在哪里可以得到这个源代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T22:41:45.937

没有。他们只开源了 post 5 的构建。第一次签入*可能*足够接近，但话又说回来，它可能不会。

# ruby - Ruby - 如何在 ClassMethod 和 Instance 之间共享数据

> ID：12611455
> 
> 赞同：1
> 
> 时间：2012-09-26T22:32:23.107
> 
> 标签：ruby, class, methods, class-method

我研究类结构以实现 cli 脚本。
我想创建类方法来注册命令。当注册一个命令时，我想为此自动生成一个 getter。

所以，我有这个结构：

```
lib/my_lib/commands.rb
lib/my_lib/commands/setup_command.rb 
```

然后文件内容：

```
# lib/my_lib/commands.rb
method MyLib
  method Commands

    def self.included(base)
      base.extend(ClassMethods)
    end

    module ClassMethods
      def register_command(*opts)
        command = opts.size == 0 ? {} : opts.extract_options!
        ...
      end

      def register_options(*opts)
        options = opts.size == 0 ? {} : opts.extract_options!
        ...
      end
    end

    class AbstractCommand
      def name
        ...
      end

      def description
        ...
      end

      def run
        raise Exception, "Command '#{self.clas.name}' invalid"
      end
    end

  end
end 
```

```
# lib/my_lib/commands/setup_command.rb
module MyLib
  module Commands
    class SetupCommand < AbstractCommand
      include MyLib::Commands

      register_command :name        => "setup",
                       :description => "setup the application"

      def run
        puts "Yeah, my command is running"
      end

    end
  end
end 
```

我想要的：

```
# my_cli_script

#!/usr/bin/env ruby
require 'my_lib/commands/setup_command'

command = MyLib::Commands::SetupCommand.new
puts command.name # => "setup"
puts command.description # => "setup the application"
puts command.run # => "Yeah, my command is running" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:57:14.473

我会这样做：

```
class CommandDummy

  def self.register_command(options = {})
    define_method(:name)        { options[:name] }
    define_method(:description) { options[:name] }
  end

  register_command :name        => "setup",
                   :description => "setup the application"

  def run
    puts "Yeah, my command is running"
  end
end

c = CommandDummy.new
puts c.name          # => "setup"
puts c.description   # => "setup the application" 
```

添加：

而不是`opts.size == 0`你可以使用`opts.empty?`

编辑：

刚玩了一点

```
# NOTE: I've no idea where to use stuff like this!
class CommandDummy
  # Add methods, which returns a given String
  def self.add_method_strings(options = {})
    options.each { |k,v| define_method(k) { v } }
  end

  add_method_strings :name        => "setup",
                     :description => "setup the application",
                     :run         => "Yeah, my command is running",
                     :foo         => "bar"
end

c = CommandDummy.new
puts c.name          # => "setup"
puts c.description   # => "setup the application"
puts c.run           # => "Yeah, my command is running"
puts c.foo           # => "bar" 
```

# c - 如何写入执行进程的标准输入？

> ID：12611457
> 
> 赞同：5
> 
> 时间：2012-09-26T22:32:27.240
> 
> 标签：c, exec, stdin

我正在尝试`execve`从标准输入读取的进程。我想用一些数据准备标准输入，以便它可以成功执行。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T23:13:20.123

您需要将 execve 调用分叉到子进程中，然后创建从父进程到子进程标准输入的管道。

查看此链接以获取有关如何使用管道的详细示例：http: [//tldp.org/LDP/lpg/node11.html](http://tldp.org/LDP/lpg/node11.html)

# objective-c - UIScrollView scrollViewDidScroll 不触发

> ID：12611459
> 
> 赞同：0
> 
> 时间：2012-09-26T22:32:36.783
> 
> 标签：objective-c, ios, uiscrollview, uiscrollviewdelegate

我有一个`UIScrollView`里面有一堆文字。当用户向上滚动时，我在顶部创建了一个小颜色到透明的视图，这样文本看起来就不会掉下来。

我的滚动视图工作正常，代表设置等。

这一切都很好，花花公子，我得到了这个（这就是我想要的）：

滚动前：

![在此处输入图像描述](../Images/22e51defeec1f7239ccc40e424948743.png)

当我开始向下滚动时，它会变得像它假设的那样：

![在此处输入图像描述](../Images/10c7e62a781404f8cb4b468b3ef4ac15.png)

当我向上滚动时，它会缩小，就像它假设的那样：

![在此处输入图像描述](../Images/3199a7328702edd9128b87c752776823.png)

* * *

**问题：** 但是！如果我快速轻弹它，似乎`scrollViewDidScroll:(UIScrollView *)scrollView`调用的速度不够快，并且渐变的框架永远不会更新。我需要检查另一个 scollView 委托方法吗？或者我可能会以错误的方式处理渐变。

![在此处输入图像描述](../Images/a601a4fbb81507e67877d679a2521fa4.png)

* * *

这是我`scrollViewDidScroll:(UIScrollView *)scrollView`处理更新渐变框架的方法：

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView{

    //Only want our gradient to show if text is off screen
    if (scrollView.contentOffset.y >= 0) {

        //Dont want our gradient to be larger than 8 pixels tall
        if (scrollView.contentOffset.y <= 8) {

            //Grab our view that draws gradient frame
            CGRect frm = self.shadeView.frame;

            //Set it the size to be absolute value of our scrollView offset
            frm.size.height = abs(scrollView.contentOffset.y);

            //Set the frame
            self.shadeView.frame = frm;
        }
    }
    //If the scrollView is scrolled to the top we don't want to show our gradient so we set it's height to 0\. 
    else {
        CGRect frm = self.shadeView.frame;
        frm.size.height = 0;
        self.shadeView.frame = frm;
    }
} 
```

# actionscript-3 - AS3 gotoAndStop 无法正常工作。

> ID：12611460
> 
> 赞同：2
> 
> 时间：2012-09-26T22:32:41.307
> 
> 标签：actionscript-3, flash

我目前正在尝试在 Flash 中制作登录系统。

我尝试下载此源： [http ://active.tutsplus.com/tutorials/actionscript/create-a-flash-login-system-using-php-and-mysql-part-1/](http://active.tutsplus.com/tutorials/actionscript/create-a-flash-login-system-using-php-and-mysql-part-1/)

目前我唯一的问题是，如果值为“1”，我想将其更改为下一帧。

所以我改变了这个：

```
result_text.text = "" + event.target.data.systemResult; 
```

进入这个：

```
if (event.target.data.systemResult == "1") {
                result_text.text = "Welcome!!";
                this.gotoAndStop('2');
            } else {
                result_text.text = "" + event.target.data.systemResult;
            } 
```

但它只是说“欢迎！” 但它不会进入下一帧-.-'

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T09:39:41.907

`this`是您在该上下文中的事件，因为您处于事件处理闭包中。

尝试`MovieClip(root).gotoAndStop(2);`

正如@SrRichie 已经建议的那样，请确保您从 2 左右丢失 ''。

从您的屏幕截图中，这也应该有效：

```
MovieClip(root).gotoAndStop('LoggedIn'); 
```

如果`root`为 null （并且我没有详细阅读您引用的教程，所以我不确定），您可能需要在代码的前面创建一个变量来引用`root`，然后调用`gotoAndStop`它。

# c++ - 使用重载的 >> 运算符从文件中读取

> ID：12611465
> 
> 赞同：2
> 
> 时间：2012-09-26T22:33:01.583
> 
> 标签：c++, operator-overloading

我正在尝试从文件中读取客户的姓名、ID 和贷款信息。该文件设置如下：

```
Williams, Bill
567382910
380.86
Davidson, Chad
435435435
400.00 
```

基本上，每次我来一个新名称时，信息都会被放入 Customer 类的一个新对象中。我的问题是，我正在尝试从文件中读取，但我不确定如何正确地重载运算符以像我想要的那样从文件中读取 3 行并将它们放在正确的位置。

我创建客户并在此处打开文件：

```
Menu::Menu()
{
Customer C;
ifstream myFile;

myFile.open("customer.txt");
while (myFile.good())
{
  myFile >> C;
  custList.insertList(C);
}
} 
```

这正是我的 .cpp 文件中用于 Menu 类的内容。这是我的 Customer 类的 .cpp 文件中重载运算符的代码（我知道怎么做的一点点）。

```
istream& operator >> (istream& is, const Customer& cust)
{

} 
```

我不确定如何只获取这三行并将它们放在客户内部的各自位置，它们是：

```
string name
string id
float loanamount 
```

如果有人可以帮助我解决这个问题，我将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-26T22:40:22.657

就像是：

```
istream& operator >> (istream& is, Customer& cust) // Do not make customer const, you want to write to it!
{
    std::getline(is, cust.name); // getline from <string>
    is >> cust.id;
    is >> cust.loanAmount;
    is.ignore(1024, '\n'); // after reading the loanAmount, skip the trailing '\n'
    return is;
} 
```

[这是一个工作示例。](http://ideone.com/JEQtz)

# c# - C# - TableLayoutPanel 切断标签字符串

> ID：12611468
> 
> 赞同：2
> 
> 时间：2012-09-26T22:33:29.207
> 
> 标签：c#, winforms, label, tablelayoutpanel

我正在创建一个表格布局面板来显示字典中的值，但表格布局面板不断将我放入单元格的标签控件切割为 14 个字符。我试图摆弄我的表格布局面板的 ColumnStyles，但没有一个选项会使 Label 控件真正“适合”到单元格中。我已经尝试了所有可用的列样式 SizeTypes：

自动调整大小（每次将带有文本值的标签裁剪为 14 个字符（“1234567890ABCD”），尽管没有控件（间隔）的列被缩小到没有）

百分比（没有任何影响 - 没有列变宽，即使我将列类型（值、键、空间）加权为不同大小）。

绝对（使列 x 像素宽，但标签仍然在 14 个字符处被截断 - 即使单元格是 1,000 像素宽）

我也尝试过弄乱标签的 Size 属性，但我无法编辑它，因为我“无法修改 'System.Windows.Forms.Control.Size' 的返回值，因为它不是变量”（无论如何这意味着）。

那么，在用尽所有这些选项之后，如何让完整的标签出现在表格单元格中而不被截断为 14 个字符？

这是生成表格布局面板的代码。它使用我构建的自定义类 (GridDisplay)，该类保留包含控件、行号、列号和其他一些字段的对象列表 (GridDisplayCell)。该类允许我向列表添加/删除/移动/插入控件，然后使用 Generate() 函数一次性构建表格布局（而不是提前确定它的大小或在我添加项目时重新调整它的大小）。

```
 private void FillInCustomerData()
    {
        GridDisplay grid = new GridDisplay(tl_TopLeft);
        int rowMax = 8;
        int columnLabelIndex = 0;

        int curRow = 0;
        int curCol = 0;

        foreach (var item in DD.AllCustomerData["BasicInfo"]) //Dictionary<string, object>
        {
            if (curRow == rowMax)
            {
                curRow = 0;
                curCol = columnLabelIndex + 2; //1 for key column, 1 for value column
            }

            var keyLabel = new Label();
            keyLabel.Text = item.Key;

            var valueLabel = new Label();
            valueLabel.Text = (item.Value == null || item.Value.ToString() == "") ? "NA" :  "1234567890ABDCDEF"; //item.Value.ToString()

            var key = grid.AddItem(new GridDisplayCell(item.Key, keyLabel), item.Key, curRow, curCol);
            // Function Definition: GridDisplay.AddItem(GridDisplayCell(string cellName, Control control), string cellName, int rowNumber, int colNumber)                
            var value = grid.AddItem(new GridDisplayCell(item.Key + "Value", valueLabel), item.Key + "Value", curRow, curCol+1);

            curRow++;
        }

        grid.WrapMode = false;
        grid.AutoSize = true;

        grid.Generate();

        //experimenting with column sizes. NOT WORKING
        foreach (ColumnStyle cs in grid.Table.ColumnStyles)
        {
            cs.SizeType = SizeType.AutoSize;
        }            
    } 
```

这是我的生成函数的块，它实际上将控件添加到 TableLayoutPanel：（_cells 是 GridDisplayCells 的列表，在这种情况下 AutoSize 是 GridDisplay 的属性（不是 TableLayoutPanel 的 AutoSize 属性））

```
 foreach (var cellItem in _cells)
            {
                if (AutoSize == false && ValidateSize(cellItem.Value.Column, cellItem.Value.Row, false) == false)
                {
                    continue; //the cell was outside the range of the control, so we don't add it.
                }

                _table.Controls.Add(cellItem.Value.CellControl, cellItem.Value.Column, cellItem.Value.Row);
            } 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-26T22:56:34.067

修复了问题。我需要将标签的 AutoSize 属性设置为 true。

# javascript - 获取 jQuery UI 主题列表 - 从 URL (same-origin-policy)

> ID：12611469
> 
> 赞同：7
> 
> 时间：2012-09-26T22:33:33.460
> 
> 标签：javascript, jquery, cross-domain, same-origin-policy

有谁知道从[http://jquery-ui.googlecode.com/svn/tags/1.8.23/themes/](http://jquery-ui.googlecode.com/svn/tags/1.8.23/themes/)获取 jQuery 主题列表的方法？

我正在创建带有主题滚轮的简单网页，用户可以在其中动态切换主题。

[**工作小提琴**](http://jsfiddle.net/SXHrB/2/embedded/result/)- 单击右上角的主题并选择一个新主题。

现在该列表被硬编码如下，

```
<div id="theme-list">    
   <ul>
      <li class="themes-el ui-state-highlight" data-theme="cupertino">cupertino</li>
      <li class="themes-el" data-theme="hot-sneaks">hot-sneaks</li>
      <li class="themes-el" data-theme="smoothness">smoothness</li>
      <li class="themes-el" data-theme="pepper-grinder">pepper-grinder</li>
      <li class="themes-el" data-theme="ui-lightness">ui-lightness</li>
      <li class="themes-el" data-theme="ui-darkness">ui-darkness</li>
      <!-- and more -->
   </ul>    
</div> 
```

有没有办法从 URL [http://jquery-ui.googlecode.com/svn/tags/1.8.23/themes/](http://jquery-ui.googlecode.com/svn/tags/1.8.23/themes/)获取这个主题列表？（跨域：[http](http://www.w3.org/TR/cors/#access-control-allow-origin-response-hea) ://www.w3.org/TR/cors/#access-control-allow-origin-response-hea ）

试过了，但是下面的代码失败了..

```
$.ajax({
    url: 'http://jquery-ui.googlecode.com/svn/tags/1.8.23/themes/',
    dataType: 'text',
    beforeSend: function ( xhr ) {
        xhr.setRequestHeader("Access-Control-Allow-Origin", 'http://jquery-ui.googlecode.com');
        xhr.setRequestHeader("Access-Control-Allow-Methods", "POST, GET, OPTIONS");
    },
    crossDomain: true,
    success: function (data) {
        alert(data);
    }, 
    error: function (jqXHR, textStatus, errorThrown) {
        alert(errorThrown + ' ' + textStatus + ' ' + jqXHR.responseText);
    }
}); 
```

感觉我在这里遗漏了很多东西。任何见解都会有帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-02T01:26:29.100

似乎服务器不允许跨域请求。你无能为力。

您可以设置一个可以卷曲该页面的 PHP 脚本，然后您可以只对 PHP 脚本进行 ajax。就像昆卡斯所说的那样

你可以在你的服务器上使用这个简短的 PHP curl 脚本：

```
<?php

$ch = curl_init();
// URL to grab
curl_setopt($ch, CURLOPT_URL, 'http://jquery-ui.googlecode.com/svn/tags/1.8.23/themes/');
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$output = curl_exec($ch);
curl_close($ch);

print_r($output);

?> 
```

那么它只是一个简单的ajax脚本：

```
$.ajax({
    url: "linktoscript.php",
    dataType: "html",
    success: function(data) {
        console.log(data);
    },
    error: function (request, status, error) {
        console.log(request);
        console.log(status);
        console.log(error);
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T19:15:15.607

我从[**yahoo(YQL)**](http://developer.yahoo.com/yql/)和[**这个 Cross-domain requests with jQuery 插件**](http://james.padolsey.com/javascript/cross-domain-requests-with-jquery/)中找到了这项服务，该插件使用 YQL 来获取跨域内容。

[http://james.padolsey.com/javascript/cross-domain-requests-with-jquery/](http://james.padolsey.com/javascript/cross-domain-requests-with-jquery/)

**演示：http:** [//jsfiddle.net/SXHrB/4/](http://jsfiddle.net/SXHrB/4/)

下面的代码只是简单地获取了我解析的整个页面以获得所需的内容。

```
$.ajax({
    url: 'http://jquery-ui.googlecode.com/svn/tags/1.8.23/themes/',
    type: 'GET',
    success: function(data) {
        alert(data.responseText.substring(data.responseText.indexOf('<ul>'), data.responseText.lastIndexOf('</ul>') + 4));
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T06:25:39.940

您是否尝试过使用JQuery 使用的[主题切换器](http://jqueryui.com/themeroller/themeswitchertool/)插件：
它将提供 JQuery 用于演示目的的所有现成主题。

```
<script src="jquery.js"></script>
<script type="text/javascript" src="themeSwitcher.js"></script>
<script type="text/javascript">       
   $(document).ready(function(){
       $('#switcher').themeswitcher();
   });
</script>    

<div id="switcher"></div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-17T14:29:42.327

您可以让您的网站添加一个指向样式的链接，如下所示：

当您单击新主题时，javascript 会在头部添加一个链接标记，您可以将链接的 ui-lightness 部分替换为此处的任何名称：http: [//jquery-ui.googlecode.com/svn/tags/1.8 .23/themes/](http://jquery-ui.googlecode.com/svn/tags/1.8.23/themes/) 希望这会有所帮助

# objective-c - 如何更快地将一大块 NSString 加载到 UILabel

> ID：12611471
> 
> 赞同：1
> 
> 时间：2012-09-26T22:34:00.977
> 
> 标签：objective-c, uitableview, uiscrollview, nsstring

我正在尝试通过这样做来加载大量数据：

```
NSString *bigchunk=@".....";

label1.text=bigchunk;//this line is causing my uitableview to jerky scrolling 
```

有没有办法比 setText 更快地将大量数据加载到 UILabel 以克服我的 uitableview 上的生涩滚动？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:41:56.357

您可能会对此存储库的这一部分感兴趣。

[https://github.com/rnapier/ios5ptl/tree/master/ch05/TableViewPerformance](https://github.com/rnapier/ios5ptl/tree/master/ch05/TableViewPerformance)

它向您展示了 3 种显示`UITableView`s 的方式作为测试，以查看哪个具有最佳性能。通过子类化的方法`ABTableViewCell`（包含在 repo 中）具有最佳性能。您将绘制`NSString`with`drawInRect:`或`drawAtPoint`。`UIImage`这也适用于s 和其他人（如示例所示） 。

在上面链接的示例中，您可以通过在`TableViewPerformanceViewController`.

# grails - Grails 战争命令 - 不提示插件更新

> ID：12611472
> 
> 赞同：0
> 
> 时间：2012-09-26T22:34:05.977
> 
> 标签：grails, deployment, build, jenkins, war

情况就是这样，我有自动构建服务器，它构建应用程序战争并在每次 git 提交时将其部署到本地 tomcat。现在，作为项目的一部分，我有自定义编写的插件，每次更新插件版本时，都会提示插件版本更新，这会停止并最终破坏构建过程（因为线程在“n”秒后被破坏）。现在我很好奇有没有办法将选项传递给`grails war`命令，所以它会自动接受这个插件更新？一种解决方法是将“y”字符串作为标准输入传递给构建脚本：

```
cat "yyyy" | project-build.sh 
```

，但是如果命令中有这样的命令，或者 grails 自动获取新版本的任何其他方式，我很好奇`grails war`，因为这个版本是在 BuildConfig.groovy 中指定的：

```
plugins {
  compile ":custom-plugin:1.1.4"
} 
```

如果我想从 1.1.3 更新到 1.1.4，我仍然有疑问

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:46:11.003

`grails war --non-interactive`将绕过问题并进行更新。

`--non-interactive`可以应用于任何`grails`命令，并会自动为任何问题选择默认选项。

# c# - C# OPOS 公共控制对象向后兼容服务对象

> ID：12611475
> 
> 赞同：2
> 
> 时间：2012-09-26T22:34:12.583
> 
> 标签：c#, opos

我目前正在开发一个应用程序，它将使用适用于 OPOS 设备的 Monroe Consulting Services 通用控制对象包。我在网站上读到这些都向后兼容所有以前的版本。

> “此版本支持从版本 1.01 到版本 1.13 的所有 OPOS API。”

我知道随着多年的发展，一些方法调用已经发生了变化，但这并不是我所关心的，我可以适应它。我只是对 1.13 版本的 CCO 是否可以与供应商提供的旧版本的服务对象一起使用感到困惑。

我们的旧软件针对 CCO 的多个版本，一切正常，但通过这次升级，我们试图将所有内容统一在一个通用方案下，而不是使用与供应商硬件捆绑的控制对象。我已经在 Epson TR-24942 上测试了 1.13 驱动程序，一切似乎都正常。如果有人能对这个话题有更多的了解，将不胜感激。

更改 CCO 是否必然意味着必须更新服务对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T21:16:10.080

好消息是旧服务对象将继续与新版本的 OPOS 通用控件一起运行。如果您已经拥有所需的所有功能，则无需更新服务对象。

但是，您必须了解较新版本的 OPOS 中提供的功能不会被较旧的服务对象支持。例如，您可能会尝试在 POS 打印机接口上使用 CapSlpRuledLine() 方法，因为它存在于 1.13 中。但是如果您的服务对象不支持它，Common Controls 将返回 OPOS_E_EXTENDED 错误，并且 ResultCodeExtended() 中的值将是 OPOS_EX_SOVERSION。

较新版本的 OPOS 也可能会弃用您过去依赖的旧功能。在这种情况下，如果您的代码继续使用已弃用的函数，您将收到 OPOS_E_DEPRECATED 错误。

# css - 需要针对不同背景的 Firefox CSS hack

> ID：12611484
> 
> 赞同：0
> 
> 时间：2012-09-26T22:35:39.650
> 
> 标签：css, image, firefox, background

我有一个使用 gif 背景的 Joomla 网站：

```
<body style="background-color:#eeeeee; background-image:url(/images/new-background.gif); background-position: top center; background-repeat:no-repeat;" > 
```

在除 Firefox 之外的所有浏览器中，当前背景都与页面内容正确对齐。

是否有针对 Firefox 的 CSS hack 会强制使用不同的背景图像？我应该把代码放在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:37:54.733

您应该跨浏览器规范化样式，而不是尝试强制使用不同的背景：

```
body {
    margin: 0;
    padding: 0;
} 
```

此外，您应该将 CSS 保存在`.css`通过以下方式链接的文件中：

```
<link rel="stylesheet" type="text/css" href="/path/to/stylesheet.css" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:42:34.500

这不是你的背景。这是您的元素，您似乎在您可能不想要它们的地方应用了一些填充/边距。position.css 适用：

```
* { margin: 0
    padding:3px 0;
  } 
```

# android - 如何关闭或退出 Android 活动

> ID：12611486
> 
> 赞同：0
> 
> 时间：2012-09-26T22:36:06.503
> 
> 标签：android, android-activity, sharedpreferences, buttonclick

我希望我的应用程序在启动时检查用户名和密码是否保存在 sharedPreferences 中。如果它检测到这些凭据，则会显示一个登录页面，如果没有，则会显示一个注册页面。用户登录应用程序后，我希望整个应用程序关闭，无论是按下设备的后退按钮还是按下应用程序退出按钮。

除了应用程序正常关闭之外，我一切正常。我以为我编码正确，但我没有。选择退出和设备后退按钮时，如何关闭整个应用程序。

退出方法：

```
 public void onClick(DialogInterface dialog, int which) {
      // TODO Auto-generated method stub
      finish();
      }
      });
    builder.setNegativeButton("No", new DialogInterface.OnClickListener() {

            public void onClick(DialogInterface arg0, int arg1) {
               arg0.cancel();
            }
        });
    AlertDialog alert=builder.create();
    alert.show(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T23:01:33.290

只需[`finish()`](http://developer.android.com/reference/android/app/Activity.html#finish%28%29)在按下后退按钮时调用您的活动。

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event)  {
    if (keyCode == KeyEvent.KEYCODE_BACK && event.getRepeatCount() == 0) {
        finish();
    }
    return super.onKeyDown(keyCode, event);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-05T10:37:55.173

您可以使用此代码关闭或退出您的应用程序。

```
android.os.Process.killProcess(android.os.Process.myPid()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T03:54:36.383

```
public void AppExit()
{

 this.finish();
 Intent intent = new Intent(Intent.ACTION_MAIN);
 intent.addCategory(Intent.CATEGORY_HOME);
 intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
 startActivity(intent);

/*int pid = android.os.Process.myPid();=====> use this if you want to kill your activity. But its not a good one to do.
 android.os.Process.killProcess(pid);*/

 } 
```

当您想退出应用程序时调用此方法。

假设您想在按下后退按钮时退出应用程序，只需这样做

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event)  {
if (keyCode == KeyEvent.KEYCODE_BACK && event.getRepeatCount() == 0) {
    AppExit();
}
return super.onKeyDown(keyCode, event);
} 
```

# statistics - 如何在 minitab 16 中表示单个单元格？

> ID：12611489
> 
> 赞同：0
> 
> 时间：2012-09-26T22:36:24.647
> 
> 标签：statistics, add, cell, addition

如何在 minitab 16 中表示单个单元格？有 C1, C2 ...作为列，1, 2 ,3 .. 作为行...我尝试过像 excel 但我需要做单行统计...所以知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T04:27:13.490

C1[1] 将是 C1 列中的第一个单元格，C1[2] 是第二个单元格，依此类推。

# python - 在 Python 中使用正则表达式将数据转换为字典

> ID：12611491
> 
> 赞同：3
> 
> 时间：2012-09-26T22:36:29.570
> 
> 标签：python, regex, dictionary, bioinformatics

我有一个带有[FASTA](http://en.wikipedia.org/wiki/FASTA_format)格式排序的数据集，基本上是这样的：

```
>pc284  
ATCGCGACTCGAC

>pc293  
ACCCGACCTCAGC 
```

我想将每个标签用作字典中的键，并将基因存储为值。

这是我拥有的代码，但实际上什么也没做：

```
import re
fileData = open('d.fasta', 'r')

myDict = dict()

for line in fileData:
  match = re.search('(\>)(\w+)(\r)(\w+)', line)
  if match: 
    gene = match.group(3)
    myDict[gene[0]] = gene[1]

print myDict 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:45:05.450

`\r`不是有效的字符类，我认为您打算`\s`改用它。如果您也不使用它们，您可以减少这些组。

但最重要的是，您需要正确提取组：

```
match = re.search(r'>(\w+)\s+(\w+)', line)
if match:
    tag, gene = match.groups()
    myDict[tag] = gene 
```

通过只创建*两个*捕获组，我们可以更简单地提取这两个`.groups()`并直接将它们分配给两个变量，`tag`和`gene`。

然而，阅读[FASTA 格式](http://en.wikipedia.org/wiki/FASTA_format)似乎表明这是一种多行格式，标签在一行，基因数据在*多*行之后。在那种情况下，你`\r`的意思是匹配换行符。当您一次读取一行文件时，这将不起作用。

如果没有像这样的正则表达式，读取该格式会简单得多：

```
myDict = {}

with open('d.fasta', 'rU') as fileData:
    tag = None
    for line in fileData:
        line = line.strip()
        if not line:
            continue
        if line[0] == '>':
            tag = line[1:]
            myDict[tag] = ''
        else:
            assert tag is not None, 'Invalid format, found gene without tag'
            myDict[tag] += line

print myDict 
```

这将逐行读取文件，根据起始`>`字符检测标签，然后读取*多*行基因信息，将其收集到最近读取的标签下的字典中。

注意`rU`模式；我们使用 python 的[通用换行模式](http://docs.python.org/glossary.html#term-universal-newlines)打开文件，以处理用于创建文件的任何换行约定。

最后但并非最不重要的; 看看[BioPy 项目](http://biopython.org/wiki/Main_Page)；他们的[`Bio.SeqIO`模块](http://biopython.org/wiki/SeqIO)可以完美地处理 FASTA 以及许多其他格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:41:51.923

我看到两个错误：

您的正则表达式可能是错误的。您的[FASTA](http://en.wikipedia.org/wiki/FASTA_format)输入实际上不太可能包含裸回车 ( `\r`)，因此您的正则表达式不会匹配任何内容。因此`if match:`测试总是错误的，所以什么也没有发生。

此外，在处理每个匹配项时：您将添加的第一个字符`gene`（即空格）作为键，第二个字符作为值。

您可能打算分别使用第 2 组和第 4 组：

```
myDict[match.group(2)] = match.group(4) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T23:12:30.473

不要为此使用正则表达式...

```
class FASTA(object):
    def __init__(self,data):
        self.data = data.strip().splitlines()
        self.desc = self.data[0]
        self.sequence = "".join(self.data[1:]).replace(" ","")#get rid of spaces
    def  GetCodons(self):
        return [self.sequence[i:i+3] for i in range(0,len(self.sequence),3)]
    def __str__(self):
        return "DESC:'%s'\nSEQ:'%s'"%(self.desc,self.sequence)

with open("data.fasta") as f:
      data = f.read()
parts = data.split(">")
for p in parts[1:]:
    f= FASTA(p)
    print f
    print f.GetCodons() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T23:07:43.433

除非您的文件太大而无法放入内存（我猜不是），否则整个事情就像

```
with open('d.fasta') as fp:
    myDict = dict(re.findall(r'(?m)^>(\w+)\s+^(\S+)', fp.read())) 
```

# macos - 在launchd中使用“RootDirectory”？

> ID：12611493
> 
> 赞同：1
> 
> 时间：2012-09-26T22:36:50.617
> 
> 标签：macos, launchd

我正在编写一个具有潜在破坏性的脚本来临时存档，然后最终删除运行 Mac OS X Server 10.7 的客户端 FTP 系统上不再需要的文件。

为了扩展，我正在切换 FTP 主目录集，查找任何超过 30 天的文件，然后将这些文件移动到“存档”目录中，如果它们再保留 30 天，它们将被删除.

我打算使用 launchd 将此脚本设置为每 30 天自动运行一次，因为它是 Mac OS X 的首选方法。

当它使用 plist 中名为“RootDirectory”的键启动作业时，它还具有（或声称具有）chroot 作业的能力，但我无法开始工作。

Apple自己关于该主题的文档似乎非常精简，我一直无法找到实际使用 RootDirectory 键的已启动 plist 的单个示例。

有人有例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-21T12:41:35.193

将密钥包含`RootDirectory`在守护程序的配置属性列表中，并将 Directory 作为字符串。使用`StartCalendarInterval`30 天

```
 <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
    <plist version="1.0">
    <dict>
        <key>Label</key>
        <string>com.apple.dts.SampleD</string>
        <key>RootDirectory</key>
        <string>path</string>
        <key>ProgramArguments</key>
        <array>
            <string>/tmp/SampleD</string>
        </array>
        <key>ServiceIPC</key>
        <true/>
        <key>Sockets</key>
        <dict>
            <key>MyListenerSocket</key>
            <dict>
                <key>SockServiceName</key>
                <string>12345</string>
            </dict>
        </dict>
    </dict>
    </plist> 
```

# restkit - RestKit 和 Tastypie 集成

> ID：12611498
> 
> 赞同：0
> 
> 时间：2012-09-26T22:37:36.823
> 
> 标签：restkit, tastypie

我正在使用 RestKit 访问 Tastypie API。我可以控制两端。

我已将 RestKit 映射配置为在 `/api/v1/organizations/1/ 成功加载“裸” JSON 资源，如下所示：

```
{
"id": "1", 
"name": "ACME Space"
} 
```

但是如何配置 RestKit 以加载资源`/api/v1/organizations/`，如下所示：

```
{
"meta": 
    {
        "limit": 20, 
        "next": null, 
        "offset": 0, 
        "previous": null, 
        "total_count": 2
    }, 
"objects": 
    [
        {
            "id": "1", 
            "name": "ACME Space"
        },
        {
            "id": "2", 
            "name": "XYZ Tech"
        }
    ]
} 
```

我假设 RestKit 不喜欢`meta`密钥或`objects`用于`Organization`对象的密钥。

我正在尝试使用`RKFetchedResultsTableController`. 是否有一个我可以覆盖的委托回调或一个我可以子类化的类来去除 RestKit 不喜欢的额外 JSON？改变 Tastypie 发出 JSON 响应的方式是否更容易？

这个问题类似于[这个未回答的 SO question](https://stackoverflow.com/questions/11384010/integration-of-restkit-with-django-tastypie)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:50:02.190

我建议您看一下目前处于开发后期阶段的功能/重启网络层分支。其中的众多功能之一是使用名为`RKResponseDescriptor`. 基本上，这可以让您说，当我在此路径模式（在本例中为 /api/v1/organizations）加载对象时，使用给定映射映射“对象”键路径。这可以解决以前的问题，即“对象”等通用键路径的键路径不明确。

标头中有大量文档（发布在[http://restkit.org/api/0.20.0-dev/index.html](http://restkit.org/api/0.20.0-dev/index.html)）和一个新的 README.md 发布到[https://github.com/RestKit/RestKit/树/功能/重启网络层](https://github.com/RestKit/RestKit/tree/feature/reboot-networking-layer)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:39:34.113

TastyPie 的开发版有一个`Meta.collection_name`属性可以用来区分。请参阅此处的[文档](http://django-tastypie.readthedocs.org/en/latest/resources.html#collection-name)。

有了这个，我创建了一个`Meta`类并映射它`forKeyPath:@"meta"`，RestKit 找出了其余的。我用一个 Meta 对象和 N 个实际对象返回对象列表。

# python - Python如何将此for循环转换为while循环

> ID：12611502
> 
> 赞同：-1
> 
> 时间：2012-09-26T22:37:49.130
> 
> 标签：python

> **可能重复：**
> [将 for 循环转换为 while 循环](https://stackoverflow.com/questions/12610623/converting-a-for-loop-to-a-while-loop)

我有一个 for 循环，我想知道我将如何编写它以便它可以与 while 循环一起使用。

```
def scrollList(myList):
    negativeIndices=[]
    for i in range(0,len(myList)):
        if myList[i]<0:
            negativeIndices.append(i)
    return negativeIndices 
```

到目前为止我有这个

```
def scrollList2(myList):
    negativeIndices=[]
    i= 0
    length= len(myList)
    while i != length:
        if myList[i]<0:
            negativeIndices.append(i)
            i=i+1

    return negativeIndices 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T22:41:15.250

好吧，你快到了。就像这样：

```
def scrollList2(myList):
    negativeIndices=[]
    i= 0
    length= len(myList)
    while i != length:
        if myList[i]<0:
            negativeIndices.append(i)
        i=i+1

    return negativeIndices 
```

您遇到的问题是您必须在每次迭代时增加循环索引。当你发现一个负值时，你只会增加。

* * *

但最好作为一个`for`循环，你的`for`循环过于复杂。我会这样写：

```
def scrollList(myList):
    negativeIndices=[]
    for index, item in enumerate(myList):
        if item<0:
            negativeIndices.append(index)
    return negativeIndices 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T22:41:23.343

好吧，一方面，您的增量器`i`应该始终更新，而不是仅在满足条件时更新。仅在`if`语句中执行此操作意味着您只有在看到可返回元素时才会前进，因此如果您的第一个元素不符合您的条件，您的函数将挂起。哎呀。这会更好：

```
def scrollList2(myList):
    negativeIndices=[]
    i= 0
    length= len(myList)
    while i != length:
        if myList[i]<0:
            negativeIndices.append(i)
        i=i+1

    return negativeIndices 
```

# ruby - 一行块中有多个表达式的语法错误

> ID：12611505
> 
> 赞同：1
> 
> 时间：2012-09-26T22:37:54.797
> 
> 标签：ruby

我收到一个语法错误，但我不确定在 Ruby 中完成同样事情的理想替代方案是什么：

```
ruby-1.9.2-p290 :019 > Dvd.find_each { |x|  x.save, puts x.length }
SyntaxError: (irb):19: syntax error, unexpected tIDENTIFIER, expecting keyword_do or '{' or '('
Dvd.find_each { |x|  x.save, puts x.length } 
```

任何的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T22:39:20.460

`Dvd.find_each { |x| x.save; puts x.length }`

试试分号；代替 ，

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-26T22:48:04.623

或者，只是为了好玩，使用我们在 Ruby 1.9 中添加的新 #tap 方法：

```
Dvd.find_each { |x| puts x.tap(&:save).length } 
```

# c++ - Isstringstream 不适用于整数

> ID：12611512
> 
> 赞同：0
> 
> 时间：2012-09-26T22:39:01.993
> 
> 标签：c++, string, file, vector, io

我正在尝试从标有 {1...9} 或 X 的文件中读取输入。我需要分离这些值并将它们正确存储在向量中。我正在使用“sstringstream”来帮助我这样做：

```
void myclass::Initialize(ifstream &file_name)
{
    string input;
    int value;
    //Initialize the values in the matrix from the values given
    //in the input file, replace x with a 0
    for(int i = 0; i < 9; i++)
    {
        for(int j = 0; j < 9; j++)
        {   
            //Read the input from the file and determine
            //if the entry is an "int" or "x"
            file_name >> input;
            cout << input << endl;
            istringstream(input); 
            if(input >> value) //PROBLEM HERE!!
            {
                Matrix[i][j] = value;
                cout << "Debug: Check for values in matrix: " << Matrix[i][j] << endl;
            }
            else
                Matrix[i][j] = 0;
        }
    }

    cout << "The values in Matrix after initialization: " << endl;

Print_result();
} 
```

问题出现在 if 语句中，当“输入”中有一个整数时，它不会执行 if 语句。我不确定为什么它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T22:43:49.260

您实际上并没有使用 istringstream。我想你正在寻找类似的东西，

```
..

istringstream is(input); 
if (is >> value)
{

... 
```

其中 'is' 是从字符串“input”创建的 istringstream。

# hbase - 将数据仓库星型模式映射到 HBASE

> ID：12611515
> 
> 赞同：4
> 
> 时间：2012-09-26T22:39:19.927
> 
> 标签：hbase, data-warehouse, star-schema, dimensional-modeling, aggregates

假设，假设我在数据仓库设置中有一个星型模式。有一个非常非常长的事实表（想想数十亿到数万亿行）和几个低基数维度表（想想 100 个维度表）。每个指向维度表主键的事实表外键都被位图索引。每个维度表的主键也是位图索引的。这都是为了快速加入。都很标准。

假设数据仓库开始出现性能下降。从位图连接返回结果所需的时间越长，事实表越长。业务需求是事实表不断增长（我们不能将超过一年的数据移至归档存储）

我正在考虑以下解决方案：

1.  哈希分区事实表，但这只是暂时阻止了不可避免的增长问题。
2.  数据库将物理星型模式数据库划分为多个模式/数据库。1..N 个事实表及其维度副本，每个都保存通过 hash(1..N) 函数分配给它们的数据，该函数在单独的 ETL 暂存数据库中执行以确定事实行的数据库/模式（由 ETL 产生过程）将进入。如果任何维度发生更改，请将更改复制到其他数据库对应的维度。同样，这不会作为永久解决方案。
3.  折叠维度并将所有维度值直接存储在事实表中。然后，将事实表导入到 HBASE on Hadoop。你得到一个巨大的 HBASE 表，没有维度表的键值存储。我会这样做是因为连接在 HBASE 中的成本过高（因此实际上没有维度连接，只需在维度列上强制执行维度值）。

以前有人做过吗？

有人对解决方案＃3有任何提示吗？

就通过快速读取进行扩展而言，HBASE 解决方案是最优的吗？

就写入而言，我不关心快速写入，因为它们会在下班时间作为批处理过程完成。

如果有人选择了解决方案 1 或 2，是否有人使用了[一致的散列算法](http://en.wikipedia.org/wiki/Consistent_hashing)（如果更多分区、散列键是动态创建的，以避免像在普通旧散列中那样重新映射）？没有完整重新映射的分区数量的动态增长可能不是一个选项（就分区表而言，我还没有看到它在实践中完成）所以在我看来，任何分区解决方案都会导致扩展问题。

将具有多维的巨型事实表（传统的 DW 星型模式）移动到 HBASE 巨型无量纲表有什么想法、建议和经验？

**相关问题：**

如何在数据中聚合传统上驻留在物化视图中的数据集合（或者作为链接到与最细粒度的事实表相同的维度的单独事实表 - 即每小时/每天/每周/每月，其中基本事实表是每小时一次）仓库映射到 HBASE？

![聚合事实表部分星型模式](../Images/cce99a75dd4fb63c8faf2963cc3d8d6f.png)

我的想法是，由于 HBASE 中没有物化视图，因此聚合数据集合存储为 HBASE 表，这些表在最细粒度、最低级别的事实表发生更改时随时更新/插入。

对 HBASE 中的聚合表有什么想法吗？是否有人使用 Hive 脚本从本质上模仿物化视图的行为，以在更改最细粒度的事实表时更新存储在其中的聚合数据的辅助 HBASE 表中的聚合列数据（即daily_aggregates_fact_table、weekly_aggregates_fact_table、monthly_aggregates_fact_table）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T06:40:35.577

Dimension 将被定义为 HBase 中的 keyrow。该值是您的测量值。如果您的事实表是无事实的，则 HBase 行中的值可以为空。

依赖于来自互联网的资源贫乏，我认为这个想法是：

```
**RowKey**                                **Value**
DimensionA                             XX
DimensionA:DimensionB                  XX
DimensionB:DimensionC                  XX
DimenesionA:DimensionB:DimenesionC:   XXX 
```

它适合您的问题吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T18:44:48.307

HBase is not a good choice for a general purpose data warehouse (with real-timish query times) Any single table will only allow you to drill down along one dimension or along one path through dimensions (if you design the right composite key right). It isn't undoable (e.g. [ebay built their new search engine on HBase](http://www.infoq.com/news/2011/11/eBay_new_search)) but it isn't out of the box

There are several efforts to provide high-performance SQL over Hadoop (e.g. [Hadapt](http://www.hadapt.com/) or [Rainstor](http://rainstor.com/products/query/) ) but they won't give you the performance of a good massively parallel databases like [Vertica](http://www.vertica.com/), [Greenplum](http://www.greenplum.com/products), [Asterdata](http://www.asterdata.com/product/alwaysparallel.php), [Netezza](http://www-01.ibm.com/software/data/netezza/) and the like

# powershell - 用于设置 VS2012 解决方案的新副本的脚本

> ID：12611522
> 
> 赞同：0
> 
> 时间：2012-09-26T22:40:28.633
> 
> 标签：powershell, visual-studio-2012

每次我从源代码控制中获得项目副本时，我都必须：
- 更改启动项目
- 更改默认启动页面

我很感激有关如何编写脚本以及需要修改哪些文件的任何提示。首选 Powershell，但对任何解决方案都持开放态度……
谢谢。

# java - 使用 netbeans 从 pojo 和 hibernate 创建 mysql 模式

> ID：12611530
> 
> 赞同：1
> 
> 时间：2012-09-26T22:41:15.467
> 
> 标签：java, mysql, hibernate, orm

我很幸运地找到了一些关于如何使用 hibernate 从数据库模式创建 POJO 的好教程（例如[http://netbeans.org/kb/docs/web/hibernate-webapp.html](http://netbeans.org/kb/docs/web/hibernate-webapp.html)）。

有谁知道从 POJO 创建数据库模式的教程——最好使用 netbeans？即使是一个表或两个相关表的最小教程也可以。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:52:08.040

从 Hibernate 生成模式实际上是内置在 Hibernate 本身中的。我不确定是否有用于此的 GUI，但您需要做的只是在配置文件中添加一行。首先将配置值添加到您正在使用的 Hibernate 配置中。例如：

```
hibernate.hbm2ddl.auto=create 
```

其他[配置值](http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html/apa.html#d5e4731)包括`update`、`validate`和`create-drop`。

您可以相当多地[自定义生成的模式。](http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html/ch01.html#d5e339)

# javascript - 从 url 获取图像并使用 javascript 转换为 blob

> ID：12611531
> 
> 赞同：1
> 
> 时间：2012-09-26T22:41:20.423
> 
> 标签：javascript, database, image, google-maps-api-3, blob

好吧，伙计们，我一直在寻找互联网很多小时，但我找不到答案。

我有一个带有这样图像的 URL：

[http://maps.google.com/maps/api/staticmap?center=Berkeley,CA&zoom=14&size=400x400&sensor=false](http://maps.google.com/maps/api/staticmap?center=Berkeley,CA&zoom=14&size=400x400&sensor=false)

我需要使用 ajax 或其他工具加载此图像，然后将其转换为 blob 以保存在我的数据库中。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:48:34.657

将图像插入到画布元素中，从画布生成动态 URI，将 URI 解码为字节，构造 blob，添加到 FormData 对象，然后使用 XMLHttpRequest 提交。

见[这里](https://stackoverflow.com/questions/12391628/how-can-i-upload-an-embedded-image-with-javascript/12470362#12470362)。

PS - 因为图像是从谷歌提供的，你需要使用代理来规避“同源”安全策略，如我链接的帖子中所述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:51:43.557

那是违反[使用条款的](https://developers.google.com/maps/terms)。

请参阅此[常见问题解答](https://developers.google.com/maps/faq#tos_staticmaps_reuse)以解决您的问题。

# python - 在 Python lambda 表达式中处理 len() 中的 NoneType？

> ID：12611534
> 
> 赞同：0
> 
> 时间：2012-09-26T22:41:25.467
> 
> 标签：python, lambda, python-2.4

据我了解，Python lambda 只允许表达式，而不是语句。我有一个案例，我`len()`在 lambda 表达式中使用并试图获取函数调用的返回值的长度。但是，该函数调用有可能返回`None`，这会中断`len()`。有没有一种优雅的方式来解决这个问题？

例子：

```
def foo(obj_list, field):
    return maxk(obj_list, key=lambda obj: len(nested_getattr(obj, field))) 
```

在上面，`maxk()`是一个`max()`接受`key`参数的版本。我在 Python 2.4 上（目前不能使用更高版本），所以我有一个自定义实现，`max()`它需要一个关键参数，来自[这里](http://bytes.com/topic/python/answers/37337-key-argument-max)（请参阅帖子 #140122 和 #140143）。 `nested_getattr()`是另一个效用函数，其作用类似于`getattr()`但可以获取嵌套在另一个属性中的属性。这可以[从这里获得](http://bytes.com/topic/python/answers/830134-getattr-nested-attributes#post3315464)。

示例函数的作用（这是我使用更改变量/名称的实际函数）是通过对象列表 ( `obj_list`) 并比较值的长度`field`并返回列表`field`中总体最大的对象。

但是，如果`field`为每个对象指定的属性返回`None`，那么`len()`将被 阻塞`TypeError`。我想我可以使用内联条件来解决这个问题，但是我必须调用`nested_getattr()`两次，一次进行检查，如果返回值不是，则可能再调用一次`None`。我宁愿将它的返回值缓存到一个变量中，并在决定返回什么之前有条件地运行它（或者只是让生成器表达式完全跳过它）。

有什么好的方法来处理这个？我对这个函数的其他实现持开放态度`maxk()`，或者`nested_getattr()`（如果需要）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T22:45:32.727

只需将函数单独定义为常规函数，然后将其传递给 maxk：

```
def getLen(obj):
    val = nested_getattr(obj, field)
    if val is None:
        return 0
    else:
        return len(val)
return maxk(obj, key=getLen) 
```

Lambdas are meant to be used when it is easier to write an inline single-expression function that it would be to write a separate function. If it becomes harder to think of how to write the lambda than to just write a normal function, just write a normal function. There's no point spending time how to fit it into a lambda, because the lambda doesn't gain you anything in that case.

Edit: Lambdas are bytecode-identical to non-lambda functions that do the same thing.

```
>>> f = lambda x: x**2
>>> def g(x):
...     return x**2
>>> import dis
>>> dis.dis(f)
  1           0 LOAD_FAST                0 (x)
              3 LOAD_CONST               1 (2)
              6 BINARY_POWER        
              7 RETURN_VALUE        
>>> dis.dis(g)
  2           0 LOAD_FAST                0 (x)
              3 LOAD_CONST               1 (2)
              6 BINARY_POWER        
              7 RETURN_VALUE 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-26T22:54:55.913

Maybe this:

```
lambda val: len(val or []) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-26T22:56:02.533

You could add the third argument to `nested_getattr()` with the same meaning as the third argument of `getattr()`:

```
len(nested_getattr(obj, field, '')) 
```

Also *in this particular case* `len(nested_getattr(obj, field) or ''))` (suggested by @DSM) works fine if possible returned values are sequences and `None`.

一般来说，@BrenBarn 建议的命名函数可能更可取。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T22:53:28.407

```
def foo(obj_list, field):
    return maxk(obj_list, key=lambda obj: len(nested_getattr(obj, field) or [])) 
```

I can't test on 2.4 right now, but this works in 3.2.

# javascript - 我可以将原型放在对象文字中吗？

> ID：12611535
> 
> 赞同：-2
> 
> 时间：2012-09-26T22:41:26.963
> 
> 标签：javascript

我可以在对象文字中声明原型吗？

```
var Obj = function(){
  var private = "Oh hi there I'm a private variable";
  return {
    init : function(param){
        this.param = 
        return this;
    }
    prototype.sayHi: function(){
        console.log("HI");
    }
  }
} 
```

我现在可以打电话给“Obj.sayHi”吗？或者如果示例不可能，有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:45:52.550

只需在 JavaScript 控制台中尝试即可。由于您的示例充满了语法错误，请尝试运行以下命令：

```
var myObj = {
   prototype.blarg: function() { return 'blarg'; }
}; 
```

你会得到：

```
SyntaxError: missing : after property id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:53:58.017

如果您问是否可以手动设置使用文字语法创建的对象的原型，官方的答案是否定的。

有*一种*非标准语法可让您更改对象的原型。这是`__proto__`财产，但同样，它现在是非标准的。

```
var Obj = function(){
    var priv = "Oh hi there I'm a private variable";
    var o = {
       init : function(param){
           this.param = param;
           return this;
       }
    };

    o.__proto__ = {
        sayHi: function(){
            console.log("HI");
        }
    };
    return o;
} 
```

同样，这是*非标准的*，所以要小心。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T23:11:36.437

您可以使用本地函数创建带有原型的对象：

```
var Obj = function() {

    var private = "Oh hi there I'm a private variable";

    function create() {
        this.param = 42;
    }

    create.prototype = {

        sayHi: function() {
            console.log(private + this.param);
        }

    };

    return new create();

};

var x = Obj();
x.sayHi(); 
```

演示：http: [//jsfiddle.net/Guffa/pZQnU/](http://jsfiddle.net/Guffa/pZQnU/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T23:20:12.127

如果您重新创建原型对象/覆盖它，您应该重置构造函数属性，因为它将被 Function() 覆盖。

```
var Person = function() {};
Person.prototype = {
    constructor: Person,
    someMethod: function() {}
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-26T23:33:35.760

你不明白的几件事：

*   原型不是特定于对象的属性。它是用于制作它的函数的属性。
*   在这种情况下，创建对象字面量的东西可以在 JavaScript 中创建所有内容

您可以直接从任何对象的构造函数属性访问原型，并且在大多数情况下至少添加属性（但您通常不能替换核心本机对象构造函数的整个原型）。在对象文字的情况下，它将是这样的：

```
var obj = {};

//BIG NOTE: don't do this in real code. Just goof around in a console or a test project
obj.constructor.prototype.sayHi = function(){ console.log('HI'); }

var anotherObj = {};
anotherObj.sayHi(); //'HI' 
```

所以，是的，对吗？但这就是问题所在。这些也有效：

```
'bob'.sayHi();
[].sayHi();
new Date().sayHi();
document.sayHi();
(6).sayHi();//have to put 6 in parens because it handles '.' differently 
```

对象字面量是使用核心 Object 构造函数创建的。对象构造函数有一个简单的实例，用作原型链开头的原型，用于 JavaScript 中几乎所有可以想象的事情。自prototype.js 以来没有人这样做过，因为很可能会出现严重奇怪的问题。

一般来说，无论您想对原型做什么，都可能会在不同的方向上进行更好的尝试。将您的对象文字设置为新函数构造函数的原型。这样你就有了继承选项，而不会破坏页面上的所有 JS。

通常认为弄乱 Object 构造函数的原型是一个非常糟糕的主意。我会说 Function.prototype 也是你想要远离的。不用于为其他本地构造函数构建原型对象的对象构造函数通常被认为是原型调整的公平游戏，因此我们可以做一些事情，例如在旧 IE 中添加缺少的数组方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-26T23:40:14.497

> 我可以在对象文字中声明原型吗？

不。

> 或者如果示例不可能，有没有办法做到这一点？

建立原型继承的唯一方法是通过构造函数或[`Object.create`](http://ecma-international.org/ecma-262/5.1/#sec-15.2.3.5). 在这两种情况下，您都可以将对象设置为`[[Prototype]]`使用对象文字，但您不能使用对象文字来创建对象实例并`[[Protoype]]`在一个文字中。

使用构造函数：

```
function Obj() {
}

Obj.prototype = {
   sayHi: function(){
            alert('Hi');
   }
};

var obj = new Obj();
obj.sayHi(); 
```

使用 Object.create

```
var obj = Object.create({sayHi: function(){alert('Hi');}});

var obj = Object.create(

  {sayHi: function(){alert('Hi');}},
  {
    init: {
      value: function(param) {
        alert(param);
      },
      writable: false
    }
  }
);

obj.sayHi();     // Hi
obj.init('foo'); // foo 
```

请注意，Object.create 是 ES5，因此旧浏览器（例如 IE 7 和更低版本）不支持，但[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)上提供了修复程序。

# c++ - 传递值时出现分段错误

> ID：12611537
> 
> 赞同：1
> 
> 时间：2012-09-26T22:41:43.050
> 
> 标签：c++, struct, segmentation-fault

我已将其作为作业的 .H 文件提供给我，我的任务是创建 .C 来配合它。这真的很简单，我敢肯定我错过了一些小东西。

```
#ifndef String_H
#define String_H

#include <iostream>

class String
{
public:

  // constructor: initializes String with copy of 0-terminated C-string  
  String(const char *p);

  // destructor (when can shared data be released?)
  ~String();

  // copy constructor (how does this change reference counts?)
  String(const String &x);

  // assignment operator  (how does this change reference counts?)
  String &operator=(const String &x); 

  // return number of non-0 characters in string
  int size() const;

  // return reference count
  int ref_count() const;

  // returns pointer to character array
  const char *cstr() const;

private:

  // data containing character strings
  // shared by Strings when copying/assigning
  struct SharedCString
  {
    char *data; // 0-terminated char array
    int n;      // number of non-0 characters in string
    int count;  // reference count, how many Strings share this object?
  };

  SharedCString *shared;
};

#endif 
```

在我的构造函数中，当我尝试将 SharedCString 的计数值设置为 1 时，出现分段错误。

我试图通过它使用：

```
 shared->count = 1; 
```

我不确定为什么这不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:43:41.083

如果您在线上遇到段错误

```
shared->count = 1; 
```

然后`shared`是 NULL 或者是垃圾，指向您的进程不拥有的内存。

你应该做

```
shared = new SharedCString; 
```

在访问它之前。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T22:44:40.163

您必须为 SharedCString 分配内存空间。它现在是一个指针，指向一些随机内存地址（就像任何未初始化的变量一样）。

这个问题涵盖了它：[Dynamically allocate memory for struct](https://stackoverflow.com/questions/9397288/dynamically-allocate-memory-for-struct)

# azure - 如何进行每个实例的 Azure Worker-Role 配置？

> ID：12611547
> 
> 赞同：0
> 
> 时间：2012-09-26T22:42:34.233
> 
> 标签：azure, azure-storage, azure-worker-roles

需要部署 3 个不同的工作角色，但每个角色都需要自己的配置（用户名、密码等）才能连接到交易服务器。我无法跨实例共享凭据。

如果有人知道如何做到这一点，我将不胜感激！

谢谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T22:54:11.157

你的意思是你有 1 个工人角色和 3 个实例？您应该改为切换到 3 个工作角色（Visual Studio 中的不同项目）。这允许您独立配置每个 Worker 角色（双击 Azure 项目中的每个 Worker 角色并转到设置选项卡）。您的公共代码可以位于所有 3 个工作角色引用的共享程序集中。

# java - Java坐标点

> ID：12611550
> 
> 赞同：-5
> 
> 时间：2012-09-26T22:42:53.727
> 
> 标签：java

> 编写一个程序，该程序将具有一个名为 coordinate_point 的方法，该方法将采用任意两个整数并显示其形式 (x,y)，其中 x 和 y 是传递的任意 2 个整数。

我不知道为什么我会遇到麻烦，因为它似乎是初学者的工作......但我什至不知道从哪里开始。如何在位置点之间显示 2 个带有 , 的整数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:50:17.197

```
String display = "(" + x + "," + y + ")";
System.out.println("Display = " + display); 
```

# java - 字符串操作中的 Java 单词

> ID：12611554
> 
> 赞同：1
> 
> 时间：2012-09-26T22:43:19.273
> 
> 标签：java, string

我是 Java 新手，我想知道如何在字符串中切换单词。在我的程序中，用户将文本输入字符串并保存。程序应该将第一个单词移动到字符串的末尾。前任。“我爱猫恨狗”应该改成“我爱猫恨狗”。

```
Scanner in = new Scanner(System.in);
System.out.println("Please enter at least one thing you love and one thing you hate using the words hate and love: ");
String loveHate = in.nextLine(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T22:53:48.067

[这](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html)应该让你开始......

一个例子...

```
int spaceIndex = loveHate.indexOf(" "); //index of a first space character
String first = loveHate.substring(0, spaceIndex);
String rest = loveHate.substring(spaceIndex + 1); 

String reversed = rest + " " + first; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T22:53:51.107

您可以使用以下正则表达式将第一个单词交换到末尾：

```
loveHate.replaceAll("(\\w+)(.*)", "$2 $1"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T22:51:25.047

编辑：这是我最初的回答，但事后看来@iccthedral 的回答可能是最好的。

一种方法是将文本拆分为单词，然后将第一个单词连接到其后所有内容的末尾。

```
String input = "I love cats and hate dogs";
String[] words = input.split("\\s+");
String firstWord = words[0];
StringBuilder everythingAfterFirstWord = new StringBuilder();
for(int i = 1 ; i < words.length ; i++){
   String word = words[i];
   everythingAfterFirstWord.append(word);
   everythingAfterFirstWord.append(" ");
}
String switched = everythingAfterFirstWord + firstWord; 
```

另一种方法是使用正则表达式。匹配第一个单词，然后其他所有内容都使用 String.replaceAll 来切换两组。

```
String switched = input.replaceAll("^(\\w+)\\s(.*)$", "$2 $1") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T22:59:58.217

```
String ss = "i love you";
        String sss="";
        String temp="";
        String[] ssArr = ss.split("\\s");
        for(int i=0; i<ssArr.length; i++) {
            if(i==0) {
                temp = ssArr[i];
            }

            else {
                sss+=ssArr[i]+" ";
            }
             if(i==ssArr.length-1) {
                    sss+=temp;
                }
        }
        System.out.println(sss); 
```

输出：我爱你

# cocos2d-iphone - Kobold2d 2.0.4 警告

> ID：12611555
> 
> 赞同：0
> 
> 时间：2012-09-26T22:43:20.413
> 
> 标签：cocos2d-iphone, kobold2d

自从我更新到 Kobold2d 2.0.4 后，我一直在控制台中收到这些警告。

```
2012-09-26 16:36:00.455 KTireHoops-iOS[14583:c07] ===> WARNING: property setter 'setAutorotationType:' not defined in target: <KKStartupConfig: 0x1047efe0> <===
2012-09-26 16:36:00.455 KTireHoops-iOS[14583:c07] ===> WARNING: property setter 'setDeviceOrientation:' not defined in target: <KKStartupConfig: 0x1047efe0> <===
2012-09-26 16:36:00.456 KTireHoops-iOS[14583:c07] ===> WARNING: property setter 'setShouldAutorotateToLandscapeOrientations:' not defined in target: <KKStartupConfig: 0x1047efe0> <===
2012-09-26 16:36:00.456 KTireHoops-iOS[14583:c07] ===> WARNING: property setter 'setAllowAutorotateOnFirstAndSecondGenerationDevices:' not defined in target: <KKStartupConfig: 0x1047efe0> <===
2012-09-26 16:36:00.456 KTireHoops-iOS[14583:c07] ===> WARNING: property setter 'setShouldAutorotateToPortraitOrientations:' not defined in target: <KKStartupConfig: 0x1047efe0> <===
2012-09-26 16:36:00.457 KTireHoops-iOS[14583:c07] ===> WARNING: property setter 'setDirectorTypeFallback:' not defined in target: <KKStartupConfig: 0x1047efe0> <===
2012-09-26 16:36:00.547 KTireHoops-iOS[14583:c07] ===> WARNING: property setter 'setWindowFrame:' not defined in target: <KKStartupConfig: 0x1047efe0> <===
2012-09-26 16:36:00.548 KTireHoops-iOS[14583:c07] ===> WARNING: property setter 'setDirectorType:' not defined in target: <KKStartupConfig: 0x1047efe0> <=== 
```

这些是我需要解决的问题还是我可以忽略它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:45:18.930

当您从 Kobold2D v1.x 升级到 v2.x 时，这些是 config.lua 中已弃用的属性。你可以忽略它们，或者只是从 config.lua 中删除相应的条目。

# javascript - 我如何定位 div 以使它们在单击功能期间不可见？

> ID：12611557
> 
> 赞同：1
> 
> 时间：2012-09-26T22:43:36.323
> 
> 标签：javascript, jquery

代码示例：[http ://codepen.io/asuh/pen/JgdLK](http://codepen.io/asuh/pen/JgdLK)

这是针对我正在研究的响应式设计。列的数量将根据我的断点和此断点处 div 的宽度而变化

当您单击任何 div 时，隐藏的内容会出现在相对于其父级的绝对定位的 div 中。它的功能是一个充满链接的下拉菜单。

在此示例中，我需要做的是定位活动下拉列表下方的容器，并使该容器或那些容器淡出或不可见。目前，您可以通过下拉菜单的边缘看到容器框阴影，我希望它们完全或几乎不可见。

这是JS：

```
$('.module article').each(function() {
    $(this).hide();
});
$('.module-content').click(function() {
  var $this = $(this).closest('section').find('article');
  $('.module article').not($this).slideUp();
  $this.slideToggle('slow').addClass('active');
}); 
```

我一直在尝试这样的事情，但它不起作用：

```
if($('.module article').hasClass('active')) {
     $('.module:nth-child(3)').fadeTo('fast',0);
} 
```

如何修改上述内容以使其正常工作？还是我以错误的方式接近它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T23:55:12.483

过滤`.module-content`-elements 。所有 a`offset().left`等于被点击元素的`offset().left`且 a`offset().top`高于`offset().top`被点击元素的元素都被放置在被点击元素的下方。

```
 $('.module-content').click(function() {
  var offset=$(this).offset();
   var $this = $(this).closest('section').find('article');
  $('.module article').not($this).slideUp();
  $('.module-content').parent().css('visibility','visible');
  if($this.is(':hidden'))
  {$('.module-content')
    .filter(function(){return ($(this).offset().left==offset.left 
                                && $(this).offset().top>offset.top);})
      .parent().css('visibility','hidden');}

  $this.slideToggle('slow').addClass('active');
}); 
```

# go - 为什么 go 在函数中有 := 短赋值？

> ID：12611561
> 
> 赞同：7
> 
> 时间：2012-09-26T22:43:56.737
> 
> 标签：go

我不太明白短期作业的具体目的，

为什么这样做：

```
x:= 10 
```

当这也是可能的：

```
var x = 10 
```

是否有任何特定用例可以让短任务更方便谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-26T23:01:17.760

```
if x, err := fn(); err != nil {
    // do something
} 
```

在上述情况下，变量被限制在 if 语句中。如果您尝试`err`在 if 语句之外访问，它将不可用。同样对于`x`. 在各种情况下，像这样维护范围可能很有用，但我想说`:=`is 用于给定的样式，如上面的`if`, `switch`, `for`。

对于一些额外的背景，`var`也允许分组，很像使用`import`.

```
var (
    y = 1
    z = 2
) 
```

`var`这将vs的用例推得`:=`更远。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T00:37:21.850

**示例 1：**

```
var age int = 30 
```

**示例 2：**

```
var age = 30 
```

**示例 3：**

```
age := 30 
```

上面所有的例子都是一样的。**示例 2**和**示例 3**只是简单地“**推断**”类型。它也是一种速记。以下是公共领域的摘录 - 知识共享 pdf，**“Go 编程简介”，作者 Caleb Doxsey**

'由于创建具有起始值的新变量是如此普遍，Go 还支持更短的语句：

```
x := "Hello World" 
```

注意**`:`**之前的**`=`**并且没有指定类型。类型不是必需的，因为 Go 编译器能够根据您分配变量的**文字值推断类型。**（由于您要分配字符串文字，因此 x 被赋予类型字符串）

编译器还可以使用 var 语句进行推断：

```
var x = "Hello World" 
```

同样的事情适用于其他类型：

```
x := 5
fmt.Println(x) 
```

通常，您应该尽可能使用这种较短**的**形式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T19:31:17.427

我相信这`:=`主要是作为一种方便的语法来接收函数调用的结果，人们经常希望重用现有变量，同时声明一个新变量：

```
x, err := func1()
if err != nil {
    fmt.Fatal(err)
}
y, err := func2()
if err != nil {
    fmt.Fatal(err)
} 
```

上面的代码编译是因为`:=`允许列出现有变量，只要*至少*创建一个新变量。尝试替换`y, err :=`为`var y, err =`，您会发现它无法编译。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-26T23:07:16.663

在这种情况下没有理由，它们是等价的。

当你有这个时它是有道理的

```
var i int
i = 0 
```

所以你可以更简洁并推断类型

```
i := 0 
```

但除此之外，它们完全相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-26T22:46:37.353

```
x := fn() 
```

这将使`x`类型与函数的返回类型相同`fn`。如果你重构你的代码并且`fn`改变了返回类型，`x`'s 的类型将被免费改变。

...而且打字更少。

# jquery - 如何在ajax完成后继续执行脚本而不使脚本同步或嵌入内容？

> ID：12611563
> 
> 赞同：1
> 
> 时间：2012-09-26T22:44:01.440
> 
> 标签：jquery, ajax, asynchronous, synchronous

所以，我知道用 jQuery 等待 ajax 请求的两种方法：

```
$.ajaxSetup({async: false}); 
```

此方法将使 ajax 同步。我不要那个。

我知道的第二种方法如下：

```
$.post("foo.html", function (foo) {
// Put all the rest of the code in here
}); 
```

我也不想这样做。

是否有第三种选择，它涉及一个处理程序，它“侦听”要完成的 ajax 请求，然后运行其余代码？

我以为可能有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:02:42.320

你可以像这样在 jQuery 中使用 Deferred 对象：

```
$.post("foo.html").done(function() { 
  alert("$.post succeeded"); 
}); 
```

[您可以在jQuery 文档](http://api.jquery.com/category/deferred-object/)中找到有关延迟对象的更多信息：延迟对象

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:14:12.227

来自[jQuery $.ajax 文档](http://api.jquery.com/jQuery.ajax/)：

```
$.ajax({
  type: "POST",
  url: "foo.html",
}).done(function( response ) {
  // triggers when the ajax request is complete
  // 'response' contains any returned values
}); 
```

如果您愿意，还有 .success() 和 .error() 回调。

# objective-c - 单击编辑按钮时将 UITableViewCells 中的所有 UITextfields 设置为可编辑

> ID：12611568
> 
> 赞同：2
> 
> 时间：2012-09-26T22:44:21.707
> 
> 标签：objective-c, xcode, uitableview, uitextfield

我在单元格中嵌入了文本字段，并且我有一个编辑按钮，它应该触发单元格进入编辑模式，我可以在其中编辑单元格中的文本。

我需要做的是遍历所有文本字段并将其设置`userInteractionEnabled`为是。我在 `setEditing:animated 方法中完成了这个：

```
- (void)setEditing:(BOOL)editing animated:(BOOL)animated
{

[super setEditing:editing animated:animated];

if (editing)
{
    int tagNumber = 0;
    for (id cellTextField in [tableView visibleCells]) {
        UITextField *aField = (UITextField *)[cellTextField viewWithTag:tagNumber];
        aField.userInteractionEnabled = YES;
        tagNumber++;
    }

    self.editButtonItem.title = NSLocalizedString(@"Done", @"Done");
}
else
{
    self.editButtonItem.title = NSLocalizedString(@"Delete", @"Delete");
}
} 
```

然后我需要以某种方式将所有这些文本字段放回 tableview 单元格。希望有人可以提供帮助。

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T00:50:42.893

你应该把代码放在 UITableView 的委托方法中，就像这样：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"CellIdentifier";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[CircleViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    UITextField *aField = (UITextField *)[cell viewWithTag:tagNumber];
    aField.userInteractionEnabled = YES;
    return cell;
} 
```

在此之后，您应该处理编辑并在编辑按钮的方法中完成。顺便说一句，对于 UITableViewCell，最好使用带有 XIB 文件的视图（UIView 的子类）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T20:40:55.460

当我忘记指针的全部意义时，我意识到我有点愚蠢。

在 cellForRowAtIndexPath 方法中，我将 UITextFields 添加到一个数组中（在将它们作为子视图添加到单元格之后）。然后在编辑按钮方法中，我只是使用快速枚举循环遍历 textFields 数组并从那里更改 userInteractionEnabled 属性。

以下是创建文本字段的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tv cellForRowAtIndexPath:(NSIndexPath *indexPath
{
  // Configure the cell...
  UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"cell"];

  if (cell == nil)
  {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"cell"];
  }

  cell.selectionStyle = UITableViewCellSelectionStyleNone;
  tf = nil;

  if (self.currentLevel == 0)
  {
        // create textfield
        tf = [self makeTextField:@"Some text"];          

        // add to subview
        [cell.contentView addSubview:tf];

        // Textfield dimensions
        tf.frame = CGRectMake(20, 12, 170, 30);

        //handle textFieldDidEndEditing
        tf.delegate = self;

        tf.userInteractionEnabled = NO;

        [textFieldArray addObject:tf];
  }

 } 
```

这是使它们可编辑的代码：

```
//Edit Button
-(void) editObject:(id)sender
{

  if (editButton.title == @"Edit")
  {
    edit = TRUE;

    // make all textFields editable on click
    for (UITextField *textF in textFieldArray)
    {
        textF.userInteractionEnabled = YES;
    }        
    editButton.title = @"Done";
  }
  else
  {
    edit = FALSE;

    // make all textFields non-editable on click
    for (UITextField *textF in textFieldArray)
    {
        textF.userInteractionEnabled = NO;
    }
    editButton.title = @"Edit";
  }
} 
```

# c# - 如何使 System.Windows.Controls.Tooltip 立即淡出？

> ID：12611573
> 
> 赞同：0
> 
> 时间：2012-09-26T22:44:40.707
> 
> 标签：c#, .net, wpf

我有一个带有一些工具提示按钮的应用程序。其中一个按钮（以下称为“运行”按钮）在按下时开始在我的应用程序之外触发进程。因为我的应用程序需要从这些进程的输出中获取数据，所以我让它暂停，直到所有进程完成运行，然后在没有用户进一步干预的情况下获取数据。当然，这意味着我的应用程序在外部进程运行时挂起，但这没什么大不了的，因为用户可以点击离开并处理我的应用程序之外的其他内容；我的申请落到了后台。不幸的是，与“运行”按钮相关的工具提示不会落到后台，并且在我的代码停止执行之前它不会消失。

以下代码略有帮助：

```
private void RunButton_Click(object sender, RoutedEventArgs e)
{
    /*Gets the tooltip out of the way while running, otherwise it will stay in front of   everything until the optimizers finish.*/
    ToolTipService.SetShowDuration(runButton, 0);
    RunTooltip.IsOpen = false;//Doesn't close fast enough. It fades a little then hangs there until the code stop running. googling has been remarkably unhelpful.
    Run();
    ToolTipService.SetShowDuration(runButton, 5000);
} 
```

RunTooltip 是相关工具提示的名称。将持续时间设置为 0 或将 isOpen 设置为 false 具有相同的行为：导致工具提示变为半透明（但无论如何仍高于其他窗口），直到 Run() 完成。

似乎有一种方法可以使用 Windows.Forms.Tooltips 立即发生工具提示褪色（请参阅[http://msdn.microsoft.com/en-us/library/system.windows.forms.tooltip.usefading.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.tooltip.usefading.aspx)）但是WPF 工具提示似乎不再是这种情况（http://msdn.microsoft.com/en-us/library/ms617634.aspx）

除了完全删除此按钮的工具提示之外，如何防止此工具提示妨碍用户在等待我的应用程序完成时想做的任何事情？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:56:35.600

可以使用 BackgroundWorker，然后在 CallBack 上加载 UI。

[BackgroundWorker 类](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)

如果要报告进度链接过程 X 的 Y 可以使用 ReportsProgress。你可以取消。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:59:32.823

如果我错了，请纠正我，因为我可能会误解你，但听起来你正在处理 UI 的线程中做一些计算上昂贵的东西。这个问题的一个更简单的解决方案可能是创建一个工作线程，如下所示：

```
 private void button1_Click(object sender, EventArgs e)
    {
        Thread workerThread = new Thread(ExpensiveMethod);
        btnShow.Visible = false;
        workerThread.Start();
    }

    private void ExpensiveMethod()
    {
        for (int i = 0; i < int.MaxValue; i++)
        {

        }

        btnShow.Visible = true;
    } 
```

这意味着处理 UI（以及工具提示）的线程可以正常进行，而工作线程正在处理计算量大的东西。

如果我误解了你，请告诉我！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T23:33:41.493

您可能会在 OnClicked 事件中更改 ToolTip 的 Popup 组件的可见性，但您必须使用 VisualTreeHelper 才能找到 ToolTip，这有点混乱。UI 仍将被冻结，这不是执行此操作的最佳方式。

这里有一条经验法则：如果你冻结了 UI，那你就做错了。

您可能需要一个繁忙的指示器来包装您的控件（codeplex 上的 WPF 工具包中有一个很棒的指示器）。WPF 使用 MVVM 模式效果最好（即最干净），但如果您直接在代码隐藏中工作，则如下所示：

```
void MyButton_Click(object sender, EventArgs e)
{
    var backgroundThread = new Thread(DoWork);
    this.MyBusyIndicator.IsBusy = true;
    backgroundThread.Start();
} 
```

然后在工作完成后，将 BusyIndi​​cator 设置为不再忙碌。

# authentication - 限制对 Azure Web 角色的访问

> ID：12611585
> 
> 赞同：0
> 
> 时间：2012-09-26T22:45:27.043
> 
> 标签：authentication, azure, ravendb

我已将 RavenDB 部署到 Azure 并在 IIS 下以一个 Web 角色运行它。

现在我想限制对它的访问到另一个网络角色/工作角色或某些管理员用户。

有哪些可能的选择以及它们的优缺点？

到目前为止，这是我设法找到的：

1.  我知道 RavenDB 支持 Windows 身份验证，但我听说在 Azure 中很难使用它。是否可以在 Web 角色启动时创建本地用户？

2.  我可以以某种方式使用 Azure ACL 来限制对 RavenDB Web 角色的访问吗？

3.  我应该使用证书吗？

4.  我应该开始阅读有关联合身份的信息吗？

5.  我认为我不能通过 IP 限制访问，因为我希望能够创建新角色并从 Internet 访问 db 角色。

我希望有一个解决方案，它不会阻止/隐藏我启动需要与我的数据库角色对话的 web / worker 角色的新实例。

# jquery - 处理表单中的两个提交按钮

> ID：12611587
> 
> 赞同：1
> 
> 时间：2012-09-26T22:45:41.703
> 
> 标签：jquery, html, forms, post, jquery-validate

所以我有一个很长的表格，它用一个 div 分成两部分。我也在使用 jquery 的 validate 插件。我在第一个 div 上有一个提交按钮，按下时，它会验证表单，如果成功则移动到下一个表单。问题是表单对实际提交整个表单的提交按钮感到困惑。这是我的代码：[小提琴](http://jsfiddle.net/XmuG8/29/)

我正在考虑将第一次提交更改为按钮并使单击事件调用验证，但这并没有真正起作用。有谁知道我怎样才能使第二页上的提交按钮提交（发布）整个表单？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:17:43.457

听起来您想实现一个类似于[Validation samples中的](http://docs.jquery.com/Plugins/Validation#A_multipart_.22buy.26sell_a_house.22_form)[“Buy & Sell a House”演示](http://jquery.bassistance.de/validate/demo/multipart/)的多部分表单。

> 由 Michael Evangelista 提供，展示了用于买卖房屋的多部分表格。
> 
> 演示的显着特点：
> 
> Multipart，使用 jQuery UI 手风琴和自定义方法实现，以在验证时检查元素是否在当前页面上 与 masked-input 插件集成，请参阅电话和 Zip 字段

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T23:18:08.740

问题是两个提交表单都会将相同的表单发送回服务器。使用 div 将两者分开并不会在逻辑上将表单分成更小的子表单。

我想说最简单的解决方案是使用两个单独的表单，因为如果您只能使用提交按钮将表单发布到服务器。

您可以将一些 jQuery 与一些 javascript 一起使用，这些 javascript 在按下按钮时被激活，读取必要的输入并通过 jQuery 的[$.post](http://api.jquery.com/jQuery.post/)函数将它们发送到服务器。我还建议看看 jQuery 的[序列化](http://api.jquery.com/serialize/)函数。

# java - 滚动对象然后创建该对象的新实例

> ID：12611589
> 
> 赞同：2
> 
> 时间：2012-09-26T22:46:03.673
> 
> 标签：java, object, selection, instanceof

在我的游戏中，当按下鼠标右键时，您将在地面上放置一个物体。所有对象都具有相同的超类（GameObject）。我有一个名为 selected 的字段，一次将等于一个特定的游戏对象。单击鼠标右键时，它会检查所选实例是什么以及它如何确定将哪个对象放置在地面上。代码示例： t 是对象将要到达的“槽”。

```
if (selected instanceof MapleTree) {
    t = new MapleTree(game,highLight);
} else if (selected instanceof OakTree) {
        t = new OakTree(game,highLight);
} 
```

现在它必须是对象的“新”实例。最终我的游戏将有数百个游戏对象，我不想有一个巨大的 if else 声明。我将如何使它滚动可能的对象类型，如果它的类型正确，则创建它的新实例......？

当按下 E 时，它将切换选择的类型，并且也是一个 if else 语句。我该怎么做呢？这是一个代码示例：

```
if (selected instanceof MapleTree) {
        selected = new OakTree(game);
} else if (selected instanceof OakTree) {
    selected = new MapleTree(game);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:57:49.087

听起来你会很好地使用[Prototype](http://en.wikipedia.org/wiki/Prototype_pattern)。

或者

如果您想坚持使用显式路由，则可以使用工厂方法的 HashMap。

或者

如果你想去隐式和自动，你可以使用反射来操作实例类并检索然后调用的构造函数：http: [//docs.oracle.com/javase/tutorial/reflect/member/ctorInstance.html](http://docs.oracle.com/javase/tutorial/reflect/member/ctorInstance.html)

或者

上述一些方法的混合是确保每个类也实现一个静态（或非）工厂方法`getInstance()`，然后当你有你匹配的对象时，你可以直接在该对象上调用该工厂方法（或在它的类上保持静态）。这在某种程度上是自动的，但仍然更容易遵循。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:56:20.763

我对 Java 知之甚少，但建议您至少用很长的 if-else 树换取更好的可读性和可能更快的[switch 语句](http://www.homeandlearn.co.uk/java/java_switch_statements.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T23:30:34.603

这是一个使用一些反射的示例。它假定按照惯例，您在所有 GameObject 子类中具有相同的构造函数签名。

如果您想“滚动浏览所有对象的列表”，您必须自己维护一组所有不同的类。然后，您可以使用与克隆和现有方法相同的方法来构建一个新方法。

```
import java.lang.reflect.Constructor;
import java.lang.reflect.InvocationTargetException;
public class GameTest {

public static class Game {
    // TODO
}
public static abstract class GameObject {
    protected GameObject( Game game ) {
        // TODO
    }
}

public static class MapleTree extends GameObject {
    // Copy constructor
    public MapleTree( MapleTree tree, Game game ) {
        super( game );
        // TODO, copy
    }
}

public <T extends GameObject> T buildNew( Class<T> clazz, Game game ) {
    try {
        final Constructor<T> constructor = clazz.getConstructor( Game.class );
        return constructor.newInstance( game );
    }
    catch ( NoSuchMethodException | SecurityException
        | InstantiationException | IllegalAccessException
        | IllegalArgumentException | InvocationTargetException e ) {
        e.printStackTrace();
    }
    return null;
}

public GameObject cloneSelected( GameObject selected, Game game ) {
    return buildNew( selected.getClass(), game );
}
} 
```

# python - 如何获取 Beautiful Soup 以从 href 和 class 获取链接？

> ID：12611592
> 
> 赞同：3
> 
> 时间：2012-09-26T22:46:25.167
> 
> 标签：python, html, download, beautifulsoup

我正在编写一个脚本来从网站下载多个 FLAC，我正在使用 Beautiful Soup 来获取 flac 链接并使用*urlopen下载链接*

我想让BS搜索以.flac结尾的链接（我不知道文件名，只是扩展名EX：1个文件是`XXX.flac`，另一个是`YYY.flac`）

flac 文件的 HTML 在这里

```
<b><a class=location href="/soundtracks/index.php">Soundtracks</a><font class=location> &raquo </font><a href="/soundtracks/highquality/index.php">High Quality Game 
Soundtracks [FLAC]</a><font class=location> &raquo </font><a href="/soundtracks/highquality/Metal_Gear_20th_Anniversary/72">Metal Gear 20th Anniversary</a><font class=location> &raquo 01 Metal Gear 20 Years History -Past, Present, Future- Download</font></b><h1>Metal Gear 20th Anniversary Download Links:</h1><a style="font-size: 16px; font-weight:bold;" href="http://50.7.161.234/bks/94/245/Music/[029] MG 20th Anniversary [FLAC]/01 Metal Gear 20 Years History -Past, Present, Future-.flac">Metal Gear 20th Anniversary - 01 Metal Gear 20 Years History -Past, Present, Future-</a> <font face="Verdana" style="font-size: 16px;">Format: FLAC, Size: 76M</font><br> <font face="Verdana" style="font-size: 10px;"><b>Note: If the file starts playing in your browser window, try right-clicking and "Save Target As"</b></font><br> 
```

我试图找到id。`t = soup.find(id="flac")`但我没有得到任何相关结果。我对此很空白，我不知道有什么方法可以解决它 

我如何让 BS 搜索并找到文件链接，然后将该文件链接分配给变量？

```
import mechanize
import urllib, urllib2, re
from bs4 import BeautifulSoup
####MECHANIZE####
br = mechanize.Browser()
res = br.open("http://www.emuparadise.me/soundtracks/highquality/Metal_Gear_20th_Anniversary/72")
a = 2 #COUNTER FOR LOOP
br.follow_link(text_regex='Download', nr=a)
b = br.geturl() #GETS THE URL
print b

page = urllib2.urlopen(b).read()
soup = BeautifulSoup(page)
soup.prettify()
t = soup.find(id="")
print t 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T23:30:25.370

您的代码正在尝试匹配`id`链接到这些标记的锚标记中不存在的属性。

而是使用正则表达式来匹配`href`以 结尾的 's `.flac`：

```
t = soup.find_all(href=re.compile(".flac$")) 
```

# postgresql - 使用 plpgsql 在函数内部获取当前函数的名称

> ID：12611596
> 
> 赞同：13
> 
> 时间：2012-09-26T22:47:13.777
> 
> 标签：postgresql, plpgsql, postgresql-9.1

无论如何，您可以从 plpgsql 函数中获取函数的名称吗？甚至是函数的 OID？

我知道 plpgsql 中有一些“特殊”变量（例如 FOUND），但似乎没有任何方法可以得到它。（虽然，如果你的函数是用 C 语言编写的，我已经读过似乎有可能的地方）。这并不重要，但它会使我正在做的事情变得更好/不那么脆弱。

我正在使用 PostgreSQL v. 9.1.5

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2017-01-27T08:03:38.927

从 Postgres 9.4 开始，以下函数将返回它自己的名称：

```
CREATE OR REPLACE FUNCTION your_schema.get_curr_fx_name()
RETURNS text AS  $$
DECLARE
  stack text; fcesig text;
BEGIN
  GET DIAGNOSTICS stack = PG_CONTEXT;
  fcesig := substring(stack from 'function (.*?) line');
  RETURN fcesig::regprocedure::text;
END;
$$ LANGUAGE plpgsql; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-27T00:04:48.163

对于触发器，使用[TG_NAME](http://www.postgresql.org/docs/current/static/plpgsql-trigger.html)来获取触发的触发器（不是触发器函数）的名称。

您还必须`current_query()`获取应用程序执行的*顶级*查询，这是函数执行的根本原因。它不会显示任何中间函数。

否则，不是真正的 AFAIK，我确实在前一段时间想打印“当前函数堆栈”以进行调试时去寻找它。其他人可能知道更多。

*更新*：在 Pg 9.4 及更高版本中，您还可以使用`PG_CONTEXT`调用堆栈，而不仅仅是当前函数名称。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-27T11:20:00.300

> 更新：PostgreSQL 9.4 中提供了调用堆栈的可能性

不，无法在 plpgsql 函数中获取当前执行的函数的名称。

几年前，我编写了访问调用堆栈的函数——它是 orafce 的一部分。您可以从堆栈中获取最后一个函数

# php - 使用 PHP 的类似 Twitter 的关注系统

> ID：12611599
> 
> 赞同：-3
> 
> 时间：2012-09-26T22:47:42.937
> 
> 标签：php

如何在网站上的用户之间建立类似 Twitter 的关注系统？

我只是想知道制作这样的东西的基本结构是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T22:48:57.560

具有两列的数据库表：`follower`和`following`。

您可以使用第三列作为主键，也可以使用多列主键。后者将在数据库级别强制执行唯一性（因为您不能同时多次关注同一个人）。

# java - 有没有办法制作子菜单项？

> ID：12611604
> 
> 赞同：0
> 
> 时间：2012-09-26T22:48:32.967
> 
> 标签：java, user-interface, jmenu, jmenuitem, jmenubar

假设我有一个 JMenuBar。在那个 JMenuBar 上，我有一个 JMenu。在那个 JMenu 上，有另一个菜单，在那个菜单上，有项目。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:50:44.283

找到了！JMenu's 实际上可以添加其他 JMenu's... 为什么我没有想到呢？

# javascript - .toLowerCase 不起作用，替换功能？

> ID：12611609
> 
> 赞同：65
> 
> 时间：2012-09-26T22:48:44.620
> 
> 标签：javascript, string, lowercase

`.toLowerCase`当我尝试在数字上使用它时，该方法给了我一个错误。这就是我所拥有的：

```
var ans = 334;
var temp = ans.toLowerCase();
alert(temp); 
```

然后它给了我这个错误：

```
'undefined' is not a function (evaluating 'ans.toLowerCase()') 
```

我不知道我哪里弄错了。我一直认为数字也可以被解析，结果没有变化（也许这就是我填塞的地方）。

但如果这不是错误，有人可以编写一个自定义`makeLowerCase`函数来使字符串小写，也许使用正则表达式或其他东西？

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2012-09-26T22:51:56.323

该`.toLowerCase()`函数仅存在于字符串上。

您可以调用`.toString()`JavaScript 中的任何内容来获取字符串表示形式。

把这一切放在一起：

```
var ans = 334;
var temp = ans.toString().toLowerCase();
alert(temp); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-26T22:53:59.337

`Number`数字从没有该`.toLowerCase`方法的构造函数继承。其实你可以查一下：

```
"toLowerCase" in Number.prototype; // false 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-26T22:58:15.537

这不是错误。当需要一个字符串时（例如`parseInt(42)`），Javascript 很乐意将一个数字转换为一个字符串，但在这种情况下，没有任何东西期望该数字是一个字符串。

这是一个`makeLowerCase`函数。:)

```
function makeLowerCase(value) {
  return value.toString().toLowerCase();
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-09-26T22:51:17.833

```
var ans = 334 + '';
var temp = ans.toLowerCase();
alert(temp); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-09-26T22:50:17.527

它是一个数字，而不是一个字符串。数字没有`toLowerCase()`功能，因为数字首先没有大小写。

要使函数正确运行，请在字符串上运行它。

```
var ans = "334"; 
```

当然，输出将与输入相同，因为如前所述，数字首先没有大小写。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-05-19T14:11:54.760

```
const myvar = 222;
const tempVar = myvar.toString().toLowerCase();
alert(tempVar); 
```

请使用以下代码，因为**toLowerCase();** 应用于字符串，因此首先需要使用**toString()**方法将其转换为字符串

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-08-13T21:37:05.850

你也可以使用这个。

```
function strtolower(value){

 return ("" +  value).toLowerCase();
}

var ans=strtolower( 334); 
```

# php - ImageMagick 突然停止仅在 Firefox 中工作？

> ID：12611617
> 
> 赞同：0
> 
> 时间：2012-09-26T22:49:30.033
> 
> 标签：php, firefox, imagemagick, imagemagick-convert

所以我使用 ImageMagick 已经有一段时间了，但它最近才停止在 Firefox 中运行。我正在运行以下代码行：

```
exec('/usr/bin/convert /home/usr/public_html/upload/'.$filename.'[0] /home/usr/public_html/upload/'.$newfilename); 
```

它只是将上传的 PDF 文件转换为 JPG 用于预览目的。现在，从今天开始，这一直运行良好。现在它将正常上传 PDF，但不会创建 JPG。没有错误或错误日志，它就在那里。

这也只发生在 Firefox 中（用 IE 和 Chrome 测试，工作正常）。现在我的问题是，有人知道为什么会发生这种情况吗？或者以前有人遇到过这种情况吗？

任何帮助都会很棒，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T06:43:07.970

事实证明，这种文件类型限制一开始就阻止了 PDF 文件的上传。

```
if ($_FILES["picture"]["type"] == "application/pdf") 
```

**这仅在使用 Firefox 时发生。**Chrome 和 IE 似乎对此反应良好（是的，我也碰巧测试了一些旧版本）。在完全相同的 Firefox 版本上也有极少数情况下它在其他人的系统上运行良好。

我的解决方案最终是删除 PHP 文件检查并在另一端放置一个 javascript 文件检查。它现在似乎适用于所有主要浏览器。

谢谢大家的帮助！

# algorithm - 查找列表中值的最小数量以求和

> ID：12611618
> 
> 赞同：0
> 
> 时间：2012-09-26T22:49:35.997
> 
> 标签：algorithm, knapsack-problem

因此，如果给我一个排序列表/数组，即 [1,6,8,15,40]，数组的大小和请求的数字..

您将如何从该列表中找到所需的最小数量值以求和请求的数量？

例如，给定数组 [1,6,8,15,40]，我请求数字 23，它将从列表（8 和 15）中取 2 个值等于 23。然后该函数将返回 2（值的数量）。此外，数组中有无限数量的 1（因此您的函数将始终返回一个值）

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:06:27.130

NP 完全[子集和问题](http://en.wikipedia.org/wiki/Subset_sum_problem)可以简单地简化为您的问题：给定一组整数*S*和一个目标值*s*，我们为 S 中的每个 x k 构造*具有*值*(* *[n]* + *1) x* *[k]*的集合*S'*并设置目标等于*(n+1) s*。如果原始集合*S的一个子集与**s*相加，则新集合中最多有一个大小为*n的子集与**(n+1) s*相加，并且这样的集合不能包含额外的 1。如果没有这样的子集，则作为答案产生的子集必须至少包含*n+1********元素，因为它需要足够的*1*才能达到*n+1*的倍数。*******

 **因此，如果没有计算方面的革命，这个问题就不会承认任何多项式时间解决方案。有了这个免责声明，您可以考虑一些*伪多项式时间*解决方案，如果集合的最大大小很小，这些解决方案在实践中效果很好。

这是一个可以执行此操作的 Python 算法：

```
import functools
S = [1, 6, 8, 15, 40] # must contain only positive integers
@functools.lru_cache(maxsize=None) # memoizing decorator
def min_subset(k, s):
    # returns the minimum size of a subset of S[:k] summing to s, including any extra 1s needed to get there
    best = s # use all ones
    for i, j in enumerate(S[:k]):
        if j <= s:
            sz = min_subset(i, s-j)+1
            if sz < best: best = sz
    return best

print min_subset(len(S), 23) # prints 2 
```

即使对于相当大的列表（我测试了 n=50 个元素的随机列表），这也是易于处理的，*只要*它们的值是有界的。使用`S = [random.randint(1, 500) for _ in xrange(50)]`,`min_subset(len(S), 8489)`运行时间不到 10 秒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:02:05.480

可能有一个更简单的解决方案，但如果您的列表足够短，您可以尝试每组值，即：

*   1 --> 不是 23
*   6 --> 不是 23
*   ...
*   1 + 6 = 7 --> 不是 23
*   1 + 8 = 9 --> 不是 23
*   ...
*   1 + 40 = 41 --> 不是 23
*   6 + 8 = 14 --> 不是 23
*   ...
*   8 + 15 = 23 --> 哦，看，它是 23，我们添加了 2 个值

如果您知道您的列表已排序，则可以跳过一些测试，因为如果 6 + 20 > 23，则无需测试 6 + 40。**

# nhibernate - Nhibernate 只返回列有意义吗？

> ID：12611620
> 
> 赞同：0
> 
> 时间：2012-09-26T22:49:40.297
> 
> 标签：nhibernate

我想知道既然 nhibernate 必须制作整个对象，这样做有意义吗？

```
Session.Query<Table>().Where(x => x.Id == id).Select(x => x.ColumnA).FirstOrDefault(); 
```

还是这样做会更好

```
Session.Query<Table>().Where(x => x.Id == id).FirstOrDefault(); 
```

我正在尝试决定是否应该在我的服务层中创建一个单独的方法来返回 ColumnA 并使用另一个方法返回所有字段。

或者我应该只使用一种方法来返回所有字段，就像第二个示例一样。

一方面，如果我以第一种方式进行操作，则必须从数据库返回更少的数据，尤其是当您知道将只使用一列时。另一方面，如果我需要为每一列添加它会很糟糕。

```
 Session.Query<Table>().Where(x => x.Id == id).Select(x => x.ColumnB).FirstOrDefault();
 Session.Query<Table>().Where(x => x.Id == id).Select(x => x.ColumnC).FirstOrDefault(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T08:52:36.457

选择 1 个属性（或其中的多个）是一个投影。NHibernate 确实支持投影，并且在许多情况下使用投影是有意义的。

这取决于您要解决的问题。如果您不知道存在问题，那么我非常建议不要使用投影来选择单个属性 - 使用实体要容易得多。但是，如果您面临真正的性能问题，那么您应该分析正在发生的事情以及瓶颈在哪里，如果在分析之后您发现这确实是因为您选择的是整个实体而不是它的单个属性，那么一定要使用投影。

话虽如此，除非您的实体拥有大量属性和/或大量数据，否则投影单个属性可能没有意义。还会有一些小的性能损失，例如重复的查询计划。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T08:08:31.707

我认为 ORM“NHibernate”的主要思想是提供使用全值对象（实体）的机会。如果您使用的查询仅获得几个字段（不是所有对象），那么您无法使用 NHibernate 的大部分优势，这是一种错误的方式。

# php - 从指定边界内的数据库中获取坐标（地图角）

> ID：12611621
> 
> 赞同：1
> 
> 时间：2012-09-26T22:49:49.520
> 
> 标签：php, mysql

我有这个领域`center`。保存的数据是`Longitude_Latitude`位置。我正在使用 Google 地图 JavaScript API，我想获取位于所示地图中的坐标。（我在服务器端使用 php）。

![https://www.dropbox.com/s/uzeiq6043rvueqf/Capture.PNG](../Images/8125c19a2acad724c4da67c7e0d7cbf8.png)
![https://www.dropbox.com/s/lk6g4tucf60n8va/Untitled.png](../Images/4c20cb6ba4be3b9da92b87dd0e9eac40.png)

我解决这个问题的想法是将中心坐标与角落坐标进行比较。为了获得位置坐标

1.  `center_Longitude`必须在`TopLeftCoords_Longitude`和之间`BottomRightCoords_Longitude`
2.  `center_Latitude`必须在 `TopLeftCoords_Latitude`和之间`BottomRightCoords_Latitude`

问题是我可以使用 MySQL 做到这一点吗？还是我必须为中心经度和纬度设置单独的字段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:33:11.747

我不清楚你在问什么，但我收集到你想分离`center`字段以获得纬度和经度分量。这可以像这样完成：

```
SELECT 
    LEFT(center, LOCATE('_', center) - 1) AS latitude,
    RIGHT(center, LOCATE('_', center) - 1) AS longitude
FROM earth 
```

**更新 1**

根据您的评论，您已要求以下标准：

`IF Lat <= TopLeftLat && Lat >= BottomRightLat && Lon <= TopLeftLon && Lon >= BottomRightLon`

这是您修改后的查询：

```
SELECT
    LEFT(center, LOCATE('_', center) - 1) AS latitude, 
    RIGHT(center, CHAR_LENGTH(center) - LOCATE('_', center) ) AS longitude
FROM realestate 
```

将条件添加到您的查询中将如下所示（假设`TopLeftLat`等是表中的属性）：

```
SELECT a.lat, a.lon
FROM
    (SELECT
        LEFT(center, LOCATE('_', center) - 1) AS lat, 
        RIGHT(center, CHAR_LENGTH(center) - LOCATE('_', center) ) AS lon
    FROM realestate) a
WHERE a.lat <= TopLeftLat AND a.lat >= BottomRightLat AND a.lon <= TopLeftLon AND a.lon >= BottomRightLon 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:14:51.143

是的，您需要单独的经度和纬度字段。使用 php 将坐标保存在数据库中（出于安全原因，切勿使用 javascript ！！）。

当您的数据库中有数据时，您可以在那里执行数学运算，例如

```
SELECT SUM(latitude) FROM tablename 
```

或者，您从数据库中提取数据并在 php 中对其进行处理，如下所示：

```
<?php
    $result=mysqli_query("SELECT * FROM tablename");
    $entries=array();
    while($row=mysqli_fetch_object($result)) $entries[]=(object) $row;
?> 
```

这会将整个表保存在一个名为`entries`.

[这里](http://php.net/manual/en/mysqli.query.php)有一些关于如何使用 php 从数据库中检索数据的很好的说明。

# android - 如何在 4.1 Jelly Bean 中为 Toast 消息打开应用程序设置“显示通知”

> ID：12611635
> 
> 赞同：4
> 
> 时间：2012-09-26T22:50:49.860
> 
> 标签：android, notifications, toast, android-4.2-jelly-bean

我的应用程序使用 Toast 并且它不再在 Android 4.1 (Jelly Bean) 下工作，除非选中应用程序设置“显示通知”。有没有办法以编程方式设置它？我查看了权限列表，但没有找到任何东西。搜索发现一个突出的问题没有。35013 与谷歌。

# iphone - UITableView 背景作为平铺图像

> ID：12611638
> 
> 赞同：2
> 
> 时间：2012-09-26T22:50:57.990
> 
> 标签：iphone, objective-c, ios, uitableview

我在 iPhone 上有一个高度约为 1,5 屏幕的图像。我想让它作为 UITableView 的连续背景。它必须随着表格滚动。有什么办法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T22:59:35.630

您可以将此图像转换为一种图案，然后可以无限期地重复该图案作为表格视图的背景。首先，这样做：

```
UIColor *backgroundPatternColor = [UIColor colorWithPatternImage:myImage]; 
```

然后将表格视图或任何其他视图的背景颜色设置为`backgroundPatternColor`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-15T19:53:47.713

有简单的解决方案。

使用此代码为表格视图设置背景图案图像（图案图像可能是小图像，您想平铺）：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    self.tableView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"back"]];
} 
```

平铺图像将无限上下平铺，并使用 tableView 滚动。

然后做下一个重要的技巧 - 为单元格设置透明背景颜色，因为设置 tableView backgroundColor 也会为单元格设置平铺背景：

```
- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{
    cell.backgroundColor = [UIColor clearColor];
} 
```

将此方法用于简单的 tableView 单元格，否则复杂单元格的透明背景会导致性能不足。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T23:27:59.000

表格视图滚动很大程度上是一种错觉，因为表格单元在不使用时会排队，而当用户滑动/滚动时再次需要新的单元格时会出列。我们经常将此称为跑步机效果，您在屏幕上看到的内容就像跑步机的皮带。它仅存在于视口中，实际上并不会滚动得更远，尽管它以其他方式出现。这意味着您的表格视图的背景图像将*固定*在适当的位置，而不是随着您的单元格滚动。

我认为在图像与单元格一起滚动的地方做你想要的唯一方法是将图像分解成单元格大小的片段，并将每个单元格的背景设置为该索引路径的图像。

所以说你有一个像这样的表格视图：

```
 CELLS            INDEX PATH
|----------------------|
|          |           |  0, 0
|----------------------|
|        /   \         |  0, 1
|----------------------|
|      YOUR IMAGE      |  0, 2
|----------------------|
|        HERE          |  0, 3
|----------------------|
|        \   /         |  0, 4
|----------------------| 
```

将您的图像预先切成大小相等的部分，这些部分适合您的单元格的正确高度。然后，您可以只抓取索引路径的行`cellForRowAtIndexPath`并根据它设置单元格的背景图像。如果您的单元格数量超过图像高度，您最终可能会用完图像，但是，这很容易检查。

如果您将图像命名为 background_0.png、background_1.png 等，您可以像这样获取您需要的图像：

```
UIImage *imageForCell = [UIImage imageNamed:[NSString stringWithFormat:@"background_%d", [indexPath row]]];
[[cell backgroundImageView] setImage:imageForCell]; 
```

`backgroundImageView`您添加到自定义单元格的图像视图在哪里。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T00:49:40.210

您要求为您的表格提供平铺的滚动背景。通常用于在图块中滚动的 UI 是表格。所以用一张桌子作为你的背景:)

您需要两个表：一个 backgroundTableView 和一个 contentTableView。contentTableView 是您需要的任何内容，但请确保将单元格和表格的背景颜色和视图设置为 clear/nil。

backgroundTableView 包含您的平铺图像：也就是说，每个单元格都应该是平铺图像的高度，并且应该包含您的平铺图像。

然后当您滚动 contentTableView 时，更新 backgroundTableView 的 contentOffset 以匹配：

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {

    if (scrollView == self.contentTableView) {
        self.backgroundTableView.contentOffset = self.contentTableView.contentOffset;
    }
} 
```

确保将控制器设置为两个表的数据源和委托。此外，请确保 backgroundTableView 中有足够的“内容”（行数 * 高度），它可以继续滚动到至少 contentTableView 的末尾。

啊啊啊完成了！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-26T23:13:59.023

UITableView 继承自 UIScrollView。我建议您将图像添加为 UITableView 层次结构的自定义子视图。

```
UIImageView *imageView = [UIImageView alloc] initWithImage:myImage];
[self.tableView insertSubview:imageView atIndex:0]; 
```

现在，您可能需要继承 UITableView 并提供您自己的实现

```
 - (void)layoutSubviews
{
    [super layoutSubviews];
    [self sendSubviewToBack:myImageView];
} 
```

我刚刚把这段代码从我的脑海中拉出来，所以你可能需要摆弄它。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-26T23:05:31.423

您可以将图像设置为表格的背景视图。

```
self.tableView.backgroundView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"YOUR_BACKGROUND_IMAGE"]]; 
```

# mysql - mysql查询性能SUM，按日期分组

> ID：12611641
> 
> 赞同：0
> 
> 时间：2012-09-26T22:51:09.470
> 
> 标签：mysql, performance, group-by, sum

我在下面的mysql数据库中有这个查询。该查询在大约 1-2 百万行上运行大约需要 6 秒。我有日期、uniqueuserid、collectiontype 的索引。

如何在 mysql 中提高此查询的性能？

```
select 
DATE_FORMAT(MIN(collection.date),'%Y-%m-%d %H:00') as date, 
COUNT(distinct collection.uniqueuserid) as convertingusers, 
SUM(case when collection.type = 1 then valueofitem end) as valueofitem, 
SUM(case when collection.type = 1 then 1 end) as numofitems, 
SUM(case when collection.type = 1 and collection.network = 1 then collection.valueofitem end) as col1valueofitem, 
SUM(case when collection.type = 1 and collection.network = 1 then 1 end) as col1numofitem, 
SUM(case when collection.type = 1 and collection.network = 2 then collection.valueofitem end) as col2valueofitem, 
SUM(case when collection.type = 1 and collection.network = 2 then 1 end) as col2numofitem, 
SUM(case when collection.type = 1 and collection.network = 3 then collection.valueofitem end) as col3valueofitem, 
SUM(case when collection.type = 1 and collection.network = 3 then 1 end) as col3numofitem, 
SUM(case when collection.type = 2 then collection.valueofitem end) as collectiontypeB, 
SUM(case when collection.type = 3 then collection.valueofitem end) as collectiontypeC,
COUNT(distinct collection.uniqueuserid) as convertingusers 

from collection
where collection.date > date_sub(now(),INTERVAL 3 WEEK) 
group by DATE_FORMAT(collection.date,'%Y-%m-%d') order by collection.date DESC limit 500 
```

根据要求，我在查询之前使用“EXPLAIN”进行了分析

```
id  select_type table   type    possible_keys   key key_len ref rows    Extra
1   PRIMARY     ALL                 1196352 Using temporary; Using filesort
2   DERIVED collection  ALL                 1196352 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:21:38.127

夫妻心得：

1.  您正在分组，`DATE_FORMAT(collection.date,'%Y-%m-%d')`但您正在选择时间 ( `DATE_FORMAT(MIN(collection.date),'%Y-%m-%d %H:00')`)
2.  如果`collection.date`是一个`datetime`字段，然后`GROUP BY DATE(collection.date)`在`SELECT`.

我建议将`CASE`s 放在子查询中，然后像这样执行汇总（您需要添加列别名）：

```
SELECT DATE_FORMAT(a.date,'%Y-%m-%d %H:00') AS date,
    COUNT(a.uniqueuserid) AS convertingusers, 
    SUM(a.valueofitem),
    SUM(a.numofitems),
    SUM(a.col1valueofitem),
    SUM(a.col1numofitem),
    SUM(a.col2valueofitem),
    SUM(a.col2numofitem),
    SUM(a.col3valueofitem),
    SUM(a.col3numofitem),
    SUM(a.collectiontypeB)
FROM
    (SELECT collection.date AS date,
        collection.uniqueuserid AS convertingusers,
        CASE
        WHEN collection.type = 1
            THEN valueofitem
        END AS valueofitem,
        CASE
        WHEN collection.type = 1
            THEN 1
        END AS numofitems,
        CASE
        WHEN collection.type = 1 AND collection.network = 1 
            THEN collection.valueofitem
        END AS col1valueofitem,
        CASE
        WHEN collection.type = 1 AND collection.network = 1
            THEN 1
        END AS col1numofitem,
        CASE
        WHEN collection.type = 1 AND collection.network = 2
            THEN collection.valueofitem
        END AS col2valueofitem,
        CASE
        WHEN collection.type = 1 AND collection.network = 2
            THEN 1
        END AS col2numofitem,
        CASE
        WHEN collection.type = 1 AND collection.network = 3
            THEN collection.valueofitem
        END AS col3valueofitem,
        CASE
        WHEN collection.type = 1 AND collection.network = 3
            THEN 1
        END AS col3numofitem,
        CASE
        WHEN collection.type = 2
            THEN collection.valueofitem
        END AS collectiontypeB,
        CASE
            WHEN collection.type = 3
            THEN collection.valueofitem
        END AS collectiontypeC
    FROM collection
    WHERE collection.date > DATE_SUB(NOW(), INTERVAL 3 WEEK)) a
GROUP BY DATE(a.date)
ORDER BY a.date DESC
LIMIT 500 
```

# css - 如何正确设置这些社交分享者的样式？

> ID：12611642
> 
> 赞同：0
> 
> 时间：2012-09-26T22:51:16.427
> 
> 标签：css, facebook, wordpress, plugins, wordpress-theming

在单个帖子的底部，我有 4 个社交分享者，其中一个是 Facebook。我已经将它设置为显示喜欢的人的面孔。我不需要很多人出现，就几个......你可以看看如果你[看一下帖子](http://noahsdad.com/nyc-buddy-walk-2012-central-park/)，他们现在看起来很奇怪。我只是用 css 弄湿了我的脚，所以我非常感谢任何帮助让这个看起来正确。我会发布一些css，但是当我查看源代码时我不确定要发布什么。希望这是一个简单的修复。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:01:06.720

这仅仅是因为您没有足够的空间来容纳每个元素。

这不是最好的解决方案，但它肯定是最快的，只需将此代码段放入您的 CSS 中，它应该可以工作：

```
.dd_button {
    width: 85px;
} 
```

# audio - 在一个脚本中上传转换文件

> ID：12611650
> 
> 赞同：1
> 
> 时间：2012-09-26T22:51:56.287
> 
> 标签：audio, coldfusion, server-side, cfc, audio-converter

我为我的公司编写了一个流程，将音频文件 (wav) 从服务器拉到其永久位置。使用 ftp 非常简单。

现在的问题是我们希望将这些 wav 文件转换为 mp3。我希望将传输/上传过程和转换过程组合成一个脚本。因此，当我们将它们移过来时，我可以处理它们（同时不会降低整体传输速率）。显然，由于转换过程是过程密集型的，因此涉及技术问题，我们可能需要第三台服务器来进行实际转换。我们将使用的转换程序是 LAME。

我正在设想一个类似于多线程应用程序的东西，它将使用一个队列，其中每个线程将处理传输和转换文件的队列的一部分。所以线程 A 移动 10-30 个文件，线程 B 移动另外 10-30 个文件。A 和 B 都将文件移动到这个“转换框或框”，一旦它们被转换，就会被移动到它们的永久位置。

这会奏效还是有更简单的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T08:40:57.027

我认为杰里米在这里为您指明了正确的方向。我会这样做：

1.  将文件 FTP 到暂存目录
2.  将 Directory Watcher 网关配置为监视该目录并处理传入文件（[有关目录监视程序的好文章](http://www.aliaspooryorik.com/blog/index.cfm/e/posts.details/post/using-a-coldfusion-directory-watcher-to-minify-javascript-382)）
3.  您可能希望进行某种重新缓冲过程，或将无法转换的文件停放在另一个目录中（很像 `undelivr`ColdFusion 邮件子系统中的目录），并记录失败以便可以采取单独的操作
4.  将转换后的文件粘贴在不同的目录中，并且可能让另一个目录观察者密切关注以部署文件，或在数据库中创建记录以引用它，或者下一个工作流程步骤是什么。

# android - 水平滚动视图中的图像视图？

> ID：12611651
> 
> 赞同：0
> 
> 时间：2012-09-26T22:52:02.767
> 
> 标签：android, image-gallery, horizontalscrollview

我有一个要求，其中我需要加载图像的水平滚动视图。图像没有固定数量，因为我从服务器获取内容。

Gallery 已弃用，应使用 ViewPager（如[android 文档](http://developer.android.com/reference/android/widget/Gallery.html)中所示）

如何在水平滚动视图中使用无限数量的图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T01:23:59.043

从 Github 试用这个项目。这应该可以满足您的需求。这是[pakerfeldt / android-viewflow的链接](https://github.com/pakerfeldt/android-viewflow)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-21T09:44:53.190

```
 String RecentBooks="http://";

 ArrayList<List<String>> arrrecentbooks= new ArrayList<List<String>> ();
//HorizontalScrollview created programaticallly

HorizontalScrollView scollviewh = new HorizontalScrollView(this);

    View v1=null;

    LinearLayout linear_pmain = new LinearLayout(this);

        linear_pmain.setOrientation(LinearLayout.HORIZONTAL);
        //      linear_pmain.setBackgroundDrawable(getResources().getDrawable(R.drawable.topshelf));bottomthumbnail 
```

//arrrecentbook 包含从 uri 解析的图像

```
 int length=arrrecentbooks.size();

 for(int j=0;j<length;j++)
    {
        LayoutInflater vii =     (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        v1=vii.inflate(R.layout.thumbnailrowlayout, null);

        List<String> listitem=arrrecentbooks.get(j);

        String  rimageurl=listitem.get(13); 

        String  rbookprice=listitem.get(10);

  img=(ImageView) v1.findViewById(R.id.imgg);
        TextView txt=(TextView) v1.findViewById(R.id.txtg);
        txt.setText("Rs."+rbookprice+"/-");
        txt.setTypeface(tf,Typeface.NORMAL);    

    img.setTag(new String[]{listitem.get(0),listitem.get(1),listitem.get(2),listitem.get(3),listitem.get(4),listitem.get(5),listitem.get(6),listitem.get(7),listitem.get(8),listitem.get(9),listitem.get(10),listitem.get(11),listitem.get(12),listitem.get(13),listitem.get(14),listitem.get(15),listitem.get(16),listitem.get(17),listitem.get(18),listitem.get(19),listitem.get(20),"recentbooks"});
//image loaded to image view

        {

            imageLoader=new ImageLoader(this);

            imageLoader.DisplayImage(rimageurl, this, img);
        }
        img.setOnClickListener(myIItemClickListener);

        linear_pmain.addView(v1);
    }

    scollviewh.addView(linear_pmain);

    lrecentbooks.addView(scollviewh);
//imgeview on itemclick listener 
```

公共 OnClickListener myIItemClickListener = new OnClickListener() {

```
@Override

public void onClick(View v) {

    try{

     RelativeLayout borderlyt=(RelativeLayout)findViewById(R.id.Booklyut);

        borderlyt.setBackgroundResource(R.drawable.bgorange);

        String[] Qtag = (String[]) v.getTag();

        Log.d("myItemClickListener", Qtag + "");

        //v.setBackgroundResource(R.drawable.bgorange);

        Intent itemintent = new   Intent(cxt,NoolDashboardDetailPage.class);

        Bundle b = new Bundle();

        b.putStringArray("iarray", Qtag);

        b.putInt("mflag", 0);

        itemintent.putExtra("android.intent.extra.INTENT", b);

        startActivityForResult(itemintent,2);

    }
    catch (Exception e) {

        // TODO: handle exception
    }
}
}; 
```

# wif - Windows Identity Foundation - FedAuth cookie 过期

> ID：12611654
> 
> 赞同：2
> 
> 时间：2012-09-26T22:52:49.867
> 
> 标签：wif

我们正在使用 Windows Identity Foundation 为我们的应用程序实施单点登录解决方案。我遇到的问题是，当我认为 FedAuth cookie 应该在依赖方方面过期时，它并没有过期。

FedAuth cookie 直到其 ValidTo 时间*后大约五分钟才会被销毁。*出于测试目的，我将令牌生命周期和会话设置为十分钟后超时。

```
<sessionState timeout="10" mode="SQLServer" sqlConnectionString="..." />

<securityTokenHandlers>
  <add type="Microsoft.IdentityModel.Tokens.SessionSecurityTokenHandler, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
    <sessionTokenRequirement lifetime="00:10" />
  </add>
</securityTokenHandlers> 
```

我们已经实现了自己的 SessionAuthenticationModule，因为我们使用的是滑动会话。该代码几乎是从[Programming Windows Identity Foundation](https://rads.stackoverflow.com/amzn/click/com/0735627185)中逐字获取的，但我认为这不是问题所在，因为我尝试在 SessionSecurityTokenReceived 事件中注释掉代码并且我看到了相同的行为，但只是为了完整性。

```
DateTime now = DateTime.UtcNow;
DateTime validFrom = e.SessionToken.ValidFrom;
DateTime validTo = e.SessionToken.ValidTo;

double tokenLifetime = (validTo - validFrom).TotalMinutes;

if( now < validTo && now > validFrom.AddMinutes( tokenLifetime / 2 ) )
{
    SessionAuthenticationModule sam = sender as SessionAuthenticationModule;
    e.SessionToken = sam.CreateSessionSecurityToken(
        e.SessionToken.ClaimsPrincipal, e.SessionToken.Context,
        now, now.AddMinutes( tokenLifetime ), e.SessionToken.IsPersistent );
    e.ReissueCookie = true;
} 
```

如果我在上午 10:00 登录应用程序同时调试上述代码，我可以看到 validTo 值是上午 10:10。然后，我让应用程序等待 11 分钟，然后单击另一个链接。在调试上述内容时，我看到 now (10:11am) 的值确实 > validTo (10:10am) 因此令牌过期不会更新。在这一点上，我希望 SAM 销毁 FedAuth cookie。但是，FedAuth cookie 没有被破坏，Request.IsAuthenticated 的值仍然是 true（由于我假设的 cookie 的存在）并且用户继续访问应用程序。直到上午 10 点 15 分，我才真正看到 cookie 已过期（使用 Fiddler）。

我不知道为什么在validTo时间到期后第一次访问时FedAuth cookie没有被破坏。我可以通过将到期时间设置为比我真正想要的时间短五分钟来捏造它，但我更愿意理解为什么我会看到这种行为。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T13:59:27.527

发生这种情况是因为存在时钟偏差，默认情况下 I 设置为 5 分钟。通常，时钟偏差用于缓解服务器之间的时钟同步（在这种情况下是同一场的服务器）。如果您想禁用或减少该值，您可以通过设置（从我的头顶）来实现

`FederatedAuthentication.ServiceConfiuration.MaxClockSkew = TimeSpan.FromSeconds(10);`

只需确保服务器时钟 100% 同步

# c# - MemoryStream.WriteTo 是异步方法吗？

> ID：12611655
> 
> 赞同：0
> 
> 时间：2012-09-26T22:53:01.610
> 
> 标签：c#, memorystream

我想知道 MemoryStream.WriteTo 是否是异步方法？

我在我的异步套接字服务器中使用它

```
public void Send(byte[] buffer)
{
    if (buffer == null)
        return;

    using (var s = new MemoryStream(buffer))
    {
        if (SslStream != null) s.WriteTo(SslStream);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:57:02.650

不，不是。

# android - Android：将两个叠加图像视图组合到具有正确位置的 bmp

> ID：12611657
> 
> 赞同：5
> 
> 时间：2012-09-26T22:53:13.393
> 
> 标签：android, canvas, imageview, overlay

我有两个 ImageView。ImageView1 是背景图像，ImageView2 是较小的图像。ImageView2 的位置在应用程序的中间某处。

我想将这两个 ImageView 组合成一个位图，以便 ImageView2 在 ImageView1 之上。

合并过程工作正常，但 ImageView2 始终位于 bmp 文件的左上角。

下面是我用来生成 bmp 的代码：

```
 ImageView iv = (ImageView)findViewById(R.id.imageView1);
    ImageView iv2 = (ImageView)findViewById(R.id.imageView2);

    File rootPath = new File(Environment.getExternalStorageDirectory(), "testmerge");

    if (!rootPath.exists()) {
        rootPath.mkdirs();
    }

    Toast.makeText(this, rootPath.getPath(), Toast.LENGTH_LONG).show();
    File dataFile = new File(rootPath, "picture.png");

    iv.measure(MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED), MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED));
    iv.layout(0, 0, iv.getMeasuredWidth(), iv.getMeasuredHeight());

    iv.setDrawingCacheEnabled(true);
    Bitmap b1 = Bitmap.createBitmap(iv.getDrawingCache());
    iv.setDrawingCacheEnabled(false);

    iv2.measure(MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED), MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED));
    iv2.layout(0, 0, iv2.getMeasuredWidth(), iv2.getMeasuredHeight());

    iv2.setDrawingCacheEnabled(true);
    Bitmap b2 = Bitmap.createBitmap(iv2.getDrawingCache());
    iv2.setDrawingCacheEnabled(false);        

    Bitmap bmOverlay = Bitmap.createBitmap(b1.getWidth(), b1.getHeight(), b1.getConfig());
    Canvas canvas = new Canvas(bmOverlay);
    Paint paint = new Paint();
    paint.setAntiAlias(true);
    paint.setFilterBitmap(true);
    paint.setDither(true);

    canvas.drawBitmap(b1, 0, 0, null);
    canvas.drawBitmap(b2, 0, 0, null);

    try {
        FileOutputStream out = new FileOutputStream(dataFile, false);
        bmOverlay.compress(CompressFormat.PNG, 95, out);
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

你能告诉我如何调整最终位图文件的位置，以便 ImageViews 与它在应用程序上显示的位置相同吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T23:21:20.377

只需创建一个`FrameLayout`, 并在其中包含两个`ImageView`s。它自然会用第二个图像覆盖第一个图像。

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <ImageView
        android:id="@+id/main_image"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/main" />

    <ImageView
        android:id="@+id/overlay_image"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/overlay" />

</FrameLayout> 
```

您可以将重力应用到中心或以其他方式对齐图像。

# java - 日历安卓

> ID：12611667
> 
> 赞同：-1
> 
> 时间：2012-09-26T22:54:04.870
> 
> 标签：java, android

如何在 android 中捕获日历事件？（当我现在有日历活动时，我会做点什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:26:26.177

该文档没有直接提到捕获事件的能力。我假设您想“捕捉”弹出的通知？[您可以在此处](http://developer.android.com/guide/topics/providers/calendar-provider.html)查看所有日历提供程序信息

[http://developer.android.com/guide/topics/providers/calendar-provider.html](http://developer.android.com/guide/topics/providers/calendar-provider.html)

我建议尝试的是将手机连接到运行 Eclipse 和 Logcat 的计算机。触发一个日历事件，看看抛出了什么样的 Intent（如果有的话）。然后，您可以将这种类型的 Intent 处理程序添加到您的应用程序中。

**更新**

我已经做了我上面描述的。看起来正在广播 com.android.providers.calendar.action.SCHEDULE_EVENT_AWARE 意图。问题是它还指定了响应此请求的组件 com.android.providers.calendar/.EventAwareService

# ruby-on-rails - 辅助功能 Rails 3 失败

> ID：12611674
> 
> 赞同：0
> 
> 时间：2012-09-26T22:55:01.857
> 
> 标签：ruby-on-rails, ruby-on-rails-3, view-helpers

我弄完了！非常幸运，我花了大约三天的时间在我的显示视图中重写了代码，如下所示：

```
<ul>
<%= @tags.each do |z| %>
    <% if z.name == @tag.name %>
        <li style="visibility:hidden"><%= id = z.tagable_id %></li>
        <p>User name:<strong> <%= find_user(id)%></strong></p>
        <li>Post content:<strong><%= post = find_post(id)%></strong></li>
    <% end %>
<% end%>

</ul> 
```

现在的问题是，在信息下方显示了一个编写的代码，该代码是我拥有的所有标签的列表：

```
[#<Tag id: 1, name: "septiembre", tagable_id: 301, tagable_type: "Post", created_at:       "2012-09-25 23:43:02", updated_at: "2012-09-25 23:43:02">, #<Tag id: 2, name: "Septiembre", tagable_id: 302, tagable_type: "Post", created_at: "2012-09-26 15:40:54", updated_at: "2012-09-26 15:40:54">, #<Tag id: 3, name: "Octubre", tagable_id: 302, tagable_type: "Post", created_at: "2012-09-26 17:11:04", updated_at: "2012-09-26 17:11:04">, #<Tag id: 4, name: "septiembre", tagable_id: 302, tagable_type: "Post", created_at: "2012-09-26 18:45:54", updated_at: "2012-09-26 18:45:54">, #<Tag id: 5, name: "septiembre\r\n", tagable_id: 303, tagable_type: "Post", created_at: "2012-09-27 00:09:36", updated_at: "2012-09-27 00:09:36">, #<Tag id: 6, name: "septiembre", tagable_id: 304, tagable_type: "Post", created_at: "2012-09-27 00:10:26", updated_at: "2012-09-27 00:10:26">, #<Tag id: 7, name: "Octubre", tagable_id: 305, tagable_type: "Post", created_at: "2012-09-27 00:10:47", updated_at: "2012-09-27 00:10:47">] 
```

你觉得怎么样？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T02:15:30.313

更改`<%= @tags.each do |z| %>`为`<% @tags.each do |z| %>`。= 符号表示渲染到 html，因此它显示`@tags`变量。

# wordpress - 如何在小部件管理页面上使用 jQuery

> ID：12611675
> 
> 赞同：0
> 
> 时间：2012-09-26T22:55:00.757
> 
> 标签：wordpress

我的小部件有一个冗长的表单配置，所以我考虑使用单选按钮来隐藏和显示相关的输入字段，而不是让它们一个接一个。但这似乎不起作用。我想这是因为表单加载了ajax？有没有办法让它工作？

看看这里的代码：http: [//jsfiddle.net/JmVL3/](http://jsfiddle.net/JmVL3/)

# java - 在 PolylineConnection 的末尾创建一个空心箭头？

> ID：12611677
> 
> 赞同：0
> 
> 时间：2012-09-26T22:55:31.323
> 
> 标签：java, swt, draw2d

如何在 a 的末尾创建一个空心箭头`PolylineConnection`？

目前我有一个实心箭头使用：

```
PolylineConnection c
PolygonDecoration decoration = new PolygonDecoration();
PointList decorationPointList = new PointList();
decorationPointList.addPoint(0, 0);
decorationPointList.addPoint(-2, 2);
decorationPointList.addPoint(-2, 0);
decorationPointList.addPoint(-2, -2);
decoration.setTemplate(decorationPointList);
c.setSourceDecoration(decoration); 
```

但我只需要箭头的轮廓，中心是空心的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T08:25:39.510

没有时间测试它，但[`setFill(boolean)`](http://help.eclipse.org/galileo/topic/org.eclipse.draw2d.doc.isv/reference/api/org/eclipse/draw2d/Shape.html#setFill%28boolean%29)应该这样做：

```
decoration.setTemplate(decorationPointList);
decoration.setFill(false); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T08:19:28.517

你试过使用`drawPolyline`吗？似乎在简要查看文档之后，它应该做你所追求的。

# python - Python：终端关闭时对象销毁

> ID：12611681
> 
> 赞同：0
> 
> 时间：2012-09-26T22:56:20.793
> 
> 标签：python

我需要创建一个足够灵活的代码来执行一些所需的清理，即使它运行的终端已关闭或 SSH 连接丢失。我将所有必要的代码封装到一个类的`__del__`方法中。但是，Python 似乎并没有在退出时调用它（与 C++ 不同）。我试过`[atexit][1]`了，但也没有被调用。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:06:03.270

您需要使用该`signal`模块。`SIGHUP`应该在关闭终端窗口或丢失 SSH 连接时发送到您的程序。你可以用 catch`SIGINT`代替，`SIGHUP`但这是一个包罗万象的解决方案。

```
import signal
import sys
def signal_handler(signal, frame):
    print 'Handling SIGHUP signal!'
    sys.exit(0)
signal.signal(signal.SIGHUHP, signal_handler)
print 'Waiting for SIGHUP'
signal.pause() 
```

`sudo kill -1 <pid of your python process>`您可以通过在另一个终端窗口中发出来测试它。

# actionscript-3 - AS3 - 获取 TextField 的字体类对象

> ID：12611689
> 
> 赞同：1
> 
> 时间：2012-09-26T22:57:11.403
> 
> 标签：actionscript-3, flash

在一个混合的 Flash IDE/Flex 项目中，我有一个 TextField，我想检索与该 TextField 关联的 Font 类对象。TextField 位于在 CS4 IDE 中创建并加载到 Flex SWF 中的 SWF 中。

目前，如果满足以下条件，我的代码可以工作：

1.  字体在子 SWF 的库中导出。
2.  TextField 链接到导出的字体。
3.  导出字体的名称在父 SWF 中是硬编码的。

代码如下：

```
fontClass = childSwf.loaderInfo.applicationDomain.getDefinition("CustomFont") as Class; 
```

我真正想做的是**不必**知道导出字体的名称。相反，我想从 TextField 中动态获取字体的类或类名。

更好的是能够在不需要导出的情况下获得内置字体的类。

FWIW，最终目标是获取任意 TextField 并检查它是否包含其嵌入字体无法使用 Font::hasGlyphs() 显示的字符。但是，子 SWF 中的字体未注册以显示在 Font::enumerateFonts() 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T04:49:57.747

您可以使用它的功能获取文本字段字体名称`getTextFormat`。考虑`txt`是文本字段，然后

```
var format:TextFormat = txt.getTextFormat();
trace(format.font); 
```

经过一番研究，我找到了这个解决方案，它可能会解决问题。

```
import flash.text.TextField;
import flash.text.TextFormat;

import flash.utils.getQualifiedClassName;

import flash.text.Font;
import flash.display.Loader;
import flash.events.Event;
import flash.net.URLRequest;

var font:Font;
var txt:TextField;

var loader:Loader = new Loader();
loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onLoaded);
loader.load(new URLRequest("sub_fla.swf"));

function onLoaded(e:Event){
    var cl:Class = e.currentTarget.applicationDomain.getDefinition("CustomFont") as Class;
    Font.registerFont(cl);
    trace(cl);

    txt = new TextField();
    this.addChild(txt);
    txt.text = "Moorthy";

    var format:TextFormat = new TextFormat();// = txt.getTextFormat();
    font = new cl();
    format.font = font.fontName;
    txt.setTextFormat(format);

    enumerateFonts();
}

function enumerateFonts(){
    var embeddedFonts:Array = Font.enumerateFonts(false);
    embeddedFonts.sortOn("fontName", Array.CASEINSENSITIVE);

    trace("---->"+embeddedFonts.indexOf(txt.getTextFormat().font));
    for(var i:int = 0;i<embeddedFonts.length;i++){
        font = embeddedFonts[i];
        trace("embeddedFonts["+i+"]:"+font.fontName+":"+font);  

        if(txt.getTextFormat().font == font.fontName){
            trace("My font class is '"+getQualifiedClassName(font) +"'");
        }
    }
} 
```

不要忘记注册字体以将其添加到`enumerateFonts`列表中。否则它会获取默认字体类而不是您的自定义类。

或者，您可以简单地将一个变量添加到动画剪辑（其中放置文本字段）来保存字体类或字体类名称。

例如：如果`holder`是包含文本字段的影片剪辑，则使用

`holder.fontClass = cl`

代替

`Font.registerFont`

你可以简单地检索字体类

`txt.parent.fontClass`

如果是这样就不需要`enumerateFonts`这种方式。

# python - 如何逐行读取并从python中的文件中解析？

> ID：12611695
> 
> 赞同：2
> 
> 时间：2012-09-26T22:57:54.697
> 
> 标签：python, parsing, readline

如何逐行读取并从python中的文件中解析？

我是 python 新手。

第一行输入是模拟次数。下一行是行数 (x)，后跟一个空格，然后是列数 (y)。下一组 y 行将有 x 个字符，其中一个句点 ('.') 代表一个空格，一个大写字母“A”代表一个起始代理。

我的代码出错了

```
Traceback (most recent call last):
    numSims = int (line)
TypeError: int() argument must be a string or a number, not 'list' 
```

谢谢你的帮助。

输入.txt

```
2   --- 2 simulations
3 3  -- 3*3 map
.A.  --map
AA.
A.A
2 2  --2*2 map
AA  --map
.A 
```

```
def main(cls, args):
    numSims = 0
    path = os.path.expanduser('~/Desktop/input.txt') 
    f = open(path) 
    line = f.readlines() 
    numSims = int (line)
    print numSims
    k=0
    while k < numSims:
        minPerCycle = 1
        row = 0
        col = 0
        xyLine= f.readLines()
        row = int(xyLine.split()[0]) 
        col = int(xyLine.split()[1])
        myMap = [[Spot() for j in range(col)] for i in range(row)] 
        ## for-while
        i = 0
        while i < row:
            myLine = cls.br.readLines()
            ## for-while
            j = 0
            while j < col:
                if (myLine.charAt(j) == 'B'):
                    cls.myMap[i][j] = Spot(True)
                else:
                    cls.myMap[i][j] = Spot(False)
                j += 1
            i += 1 
```

对于 Spot.py

现货.py

```
class Spot(object):
isBunny = bool()
nextCycle = 0
UP = 0
RIGHT = 1
DOWN = 2
LEFT = 3
SLEEP = 4

def __init__(self, newIsBunny):
    self.isBunny = newIsBunny
    self.nextCycle = self.UP 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-26T23:01:42.977

您的错误很多，这是我迄今为止发现的错误：

1.  这条线`numSims = (int)line`没有做你认为它做的事情。Python 没有 C 类型转换，您需要改为调用*类型*`int`：

    ```
    numSims = int(line) 
    ```

    您稍后通过使用大写拼写来复合此错误`Int`：

    ```
    row = (Int)(xyLine.split(" ")[0])
    col = (Int)(xyLine.split(" ")[1]) 
    ```

    以类似的方式更正这些：

    ```
    row = int(xyLine.split()[0])
    col = int(xyLine.split()[1]) 
    ```

    并且由于默认`.split()`是在空格上拆分，因此您可以省略该`" "`参数。更好的是，将它们组合成一行：

    ```
    row, col = map(int, xyLine.split()) 
    ```

2.  你永远不会 increment `k`，所以你的`while k < numSims:`循环将永远持续下去，所以你会得到一个 EOF 错误。改用`for`循环：

    ```
    for k in xrange(numSims): 
    ```

    你不需要`while`在这个函数的任何地方使用，它们都可以用`for variable in xrange(upperlimit):`循环替换。

3.  Python 字符串没有`.charAt`方法。改用`[index]`：

    ```
    if myLine[j] == 'A': 
    ```

    但由于`myLine[j] == 'A'`是布尔测试，您可以`Spot()`像这样简化您的实例化：

    ```
    for i in xrange(row):
        myLine = f.readLine()
        for j in xrange(col):
            cls.myMap[i][j] = Spot(myLine[j] == 'A') 
    ```

4.  在 Python 中不需要太多初始化变量。如果您在下一行分配新值，您可以获得大部分`numSims = 0`和行等。`col = 0`

5.  您改为创建一个“myMap `variable but then ignore it by referring to`cls.myMap”。

6.  这里没有处理多重映射；文件中的最后一个地图将覆盖任何前面的地图。

改写版：

```
def main(cls, args):
    with open(os.path.expanduser('~/Desktop/input.txt')) as f:
        numSims = int(f.readline())
        mapgrid = []
        for k in xrange(numSims):
            row, col = map(int, f.readline().split())  
            for i in xrange(row):
                myLine = f.readLine()
                mapgrid.append([])
                for j in xrange(col):
                    mapgrid[i].append(Spot(myLine[j] == 'A'))
         # store this map somewhere?
         cls.myMaps.append(mapgrid) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T01:03:13.333

虽然[Martijn Pieters](https://stackoverflow.com/a/12611732/395321)在解释如何使您的代码变得更好方面做得非常好，但我建议采用完全不同的方法，即使用像 Parcon 这样的[Monadic](http://www.opengroove.org/parcon/parcon-tutorial.html) [Parser Combinator](https://www.google.de/search?q=%22Monadic%20Parser%20Combinators%22)库。这允许您超越上下文无关语法，并在运行时根据当前解析过程提取的信息轻松修改解析器：

```
from functools import partial
from parcon import (Bind, Repeat, CharIn, number, End,
                    Whitespace, ZeroOrMore, CharNotIn)

def array(parser, size):
    return Repeat(parser, min=size, max=size)

def matrix(parser, sizes):
    size, sizes = sizes[0], sizes[1:]
    return array(matrix(parser, sizes) if sizes else parser, size)

comment = '-' + ZeroOrMore(CharNotIn('\n')) + '\n'

sims = Bind(number[int],
            partial(array,
                    Bind(number[int] + number[int],
                         partial(matrix,
                                 CharIn('.A')['A'.__eq__])))) + End()

text = '''
2   --- 2 simulations
3 3  -- 3*3 map
.A.  --map
AA.
A.A
2 2  --2*2 map
AA  --map
.A
'''

import pprint
pprint.pprint(sims.parse_string(text, whitespace=Whitespace() | comment)) 
```

结果：

```
$ python numsims.py
[[False, True, False], [True, True, False], [True, False, True]]
[[True, True], [False, True]] 
```

起初，它有点让人费解，就像所有单子的东西一样。但是表达的灵活性和简洁性非常值得花时间学习单子。

# objective-c - 对于 setter 方法不存储传递的对象的 Obj-C 属性，合适的关键字是什么？

> ID：12611708
> 
> 赞同：2
> 
> 时间：2012-09-26T22:59:53.353
> 
> 标签：objective-c

对于从不实际存储您传递给它的对象的设置器，最合适的关键字是什么？（复制、保留或转让）

具体来说，下面的 endDate 设置器从不存储传递的日期，在内部它只是更新 numberOfNights NSUInteger。

相应的 getter 重新组合 startDate 和 numberOfNights 以返回一个新的 endDate 对象。

```
@property (nonatomic, readonly) NSDate *startDate;
@property (nonatomic) NSUInteger numberOfNights; //modifiable.
@property (nonatomic, copy) NSDate *endDate; //internally stored as an unsigned integer, number of nights. 
```

我觉得复制属性最有意义。（你传递给 -setEndDate: 的指针永远不会被 -endDate 返回）

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:04:57.867

我相信，如果您自己实现 getter/setter，那么您无需担心保留与分配。这些关键字仅影响自动 getter/setter 的工作方式。您也可以在此处安全地使用 copy 或完全省略。（我在这篇文章中写着“我相信……”，因为我感觉有点生疏，并试图回到 Xcode。今年随着 ARC 越来越受欢迎，事情发生了巨大变化。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T23:05:29.823

你为什么要定义一个`property`你从未真正设置或得到的？如果您要定义`method`类似的内容，您不会使您的代码更清晰，更易于他人理解：

```
-(void)setEndDate:(NSDate *)endDate; 
```

然后，您实现这个`method`，为 numberOfNights 分配一个新值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T23:07:03.933

属性的主要好处是能够为私有 ivar 支持的 getter 和 setter 自动创建繁琐的样板代码。在您的情况下，该属性不受 ivar 支持，听起来您无论如何都在编写手动 getter 和 setter。鉴于此，我想说`@property`语法只是令人困惑（正如您所发现的那样）。我只想声明 2 个方法，并实现它们以`numberOfNights`在幕后使用：

```
- (NSDate *)endDate;
- (void)setEndDate:(NSDate *)date; 
```

否则，您使用的任何限定符（保留、复制、分配）都将被忽略，因为您正在手动实现访问器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T07:56:56.913

我想不出拥有只写属性非常有意义的场景。如果该属性的唯一目的是更新其他内容，我将使用具有这样名称的方法，以便您的代码尽可能明确：

```
- (void)updateNumberOfNightsWithEndDate:(NSDate *)endDate; 
```

如果您不小心，具有副作用的属性访问器可能会导致代码混乱，因此通常我会尽量减少它们的使用。

# javascript - 具有一个 onclick 事件的多个操作

> ID：12611715
> 
> 赞同：0
> 
> 时间：2012-09-26T23:00:15.143
> 
> 标签：javascript

我有一个需要执行多项操作的按钮。

首先，我的按钮需要在文件中移回一个记录集。做到了这一点。“skyWeb.recordset.movePrevious();”

然后，如果到达第一个文件并且用户单击“返回”按钮，它应该移动到记录集中的最后一个文件（也这样做：“if (skyWeb.recordset.BOF) skyWeb.recordset.moveLast();” ) 然后显示一条消息，指出它已到达文件中的最后一条记录。我可以让按钮移动到最后一条记录，但不显示消息。这是我的代码：

```
<button onclick="skyWeb.recordset.movePrevious(); if (skyWeb.recordset.BOF) skyWeb.recordset.moveLast() && alert('You have reached the end of file')">
                      &lt; Back
</button> 
```

如何让按钮同时移动到 EOF 并显示消息？我不想调用函数，但让按钮本身执行操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:06:21.303

你只是不需要那个“&&”。

[演示在这里](http://jsbin.com/welcome/27431/edit)

编辑：

同意 Michael Berkowski 的观点，你不应该使用内联 javascript。

# c# - 有人记得 .net 的 Agilix 墨水控件吗？（平板电脑）

> ID：12611717
> 
> 赞同：0
> 
> 时间：2012-09-26T23:00:50.077
> 
> 标签：c#, .net, controls, tablet-pc, microsoft.ink

我终于更新了一个针对某些墨水功能的旧应用程序。当时我们使用 Agilix 控件来获得很多墨水功能。基本上它是单个控件中的无限音符。

有谁知道 Agilix 的替代品，因为该公司似乎不再有这样的支持或控制。

也许这会唤起你的记忆 [http://msdn.microsoft.com/en-us/library/ms812500.aspx](http://msdn.microsoft.com/en-us/library/ms812500.aspx)

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:06:24.270

我记得很清楚。在我自己的应用程序中使用它。不幸的是，当时没有任何东西，现在也没有任何东西可以用作这种功能的替代品。

如果您使用的是 WPF，您可以从[InkCanvas](http://msdn.microsoft.com/en-us/library/system.windows.controls.inkcanvas.aspx)控件开始，该控件具有对标准模式集（写入、选择、擦除）的内置支持并支持子控件（例如 TextBox 控件）。但它没有那么完美. 并不是说 Infinnotes 也没有自己的问题，但它对在同一页面中混合文本和墨迹有很好的支持。

您还可以使用[InkAnalyzer](http://msdn.microsoft.com/en-us/library/windows/desktop/ms704040.aspx)类将墨迹解析为段落、线条、单词和绘图，就像 Infinnotes 过去所做的那样。但是，一旦数据被解析，您如何处理这些数据取决于您。

# html - 是否可以将菜单保存为 css

> ID：12611722
> 
> 赞同：0
> 
> 时间：2012-09-26T23:01:07.760
> 
> 标签：html, css, menu

我为 ebay 创建了一个仅 css 的菜单。

我有大约 300 个列表，所以如果我想更改链接或编辑菜单，我必须浏览每个列表。显然，这是非常耗时的。我的问题是，我可以将菜单保存在单独的页面上，以便我可以在我喜欢的时候更新，这将更新所有 ebay 列表？

我不能使用 php 或 javascript，因为 ebay 不允许我使用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:22:04.217

有许多软件应用程序可用于更轻松地管理多个 eBay 列表。其中一些必须让您创建一次模板，然后将其应用于所有拍卖。然后，您可以将现有的 CSS 保留在模板中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:04:33.490

对于“你的”易趣？不知道应该是什么意思...

无论如何，听起来是我们老朋友 php 的时间了！

将菜单代码放在一个名为`menu.php`的文件中，使包含菜单的文件也成为 php 文件，并将其中的菜单代码替换为：

`<?php require('menu.php');` ?>

在显示菜单的每个文件中执行此操作。

这将简单地将代码放在那里，从 menu.php 中获取。所以，以后你只需要修改menu.php，变化就会无处不在。

# java - 获取德国时区显示字符串

> ID：12611726
> 
> 赞同：0
> 
> 时间：2012-09-26T23:01:20.930
> 
> 标签：java, timezone

我需要以编程方式确定世界各地站点的时区显示字符串（即加利福尼亚的 PST/PDT）。我的问题是德国；无论我如何转动它，我都无法让它以德语（MESZ）显示显示名称。

以下是我尝试过的一些尝试：

```
TimeZone tz = TimeZone.getTimeZone("MET");
Calendar calendar = Calendar.getInstance(tz);
Date date = new Date();
date.setTime(calendar.getTimeInMillis());
String displayName = tz.getDisplayName(tz.inDaylightTime(date), TimeZone.SHORT, Locale.GERMANY); 
```

为此，我将 displayName 设为 MEST（我需要的 MESZ 的英文版）。

如果我使用“Europe/Berlin”而不是“MET”，我会得到 CEST，甚至更糟......我也尝试在 getDisplayName 方法中使用语言环境参数，不传递它，传递 GERMANY，传递 GERMAN，但是结果不会改变。

我究竟做错了什么？

谢谢，尤塔姆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:44:30.813

我对 Sun 的 jre 库文件进行了一些研究，发现对于您提到的语言环境，该库只知道“Zentraleuropäische Zeit”的“MET”和“Zentraleuropäische Sommerzeit”的“MEST”。代码中没有列出其他名称。因此，它要么是错误（错字），要么是出于某种不清楚的原因而完成的。

# javascript - 如何自动刷新页面

> ID：12611729
> 
> 赞同：-2
> 
> 时间：2012-09-26T23:01:32.597
> 
> 标签：javascript, jquery

> **可能重复：**
> [自动页面刷新](https://stackoverflow.com/questions/3099430/automatic-page-refresh)

我在网上找到了这个开关，想用它来刷新页面。如果用户单击“打开”，它将每 5 秒刷新一次页面。如果他们点击关闭，它将停止。可以请一些帮助我。这是我到目前为止所拥有的：

```
<style>

body{
font-family:Verdana, Geneva, sans-serif;
font-size:14px;}

.left{
float:left;
width:120px;}

#ajax{
float:left;
width:300px;
padding-top:5px;
font-weight:700;
}

.clear{clear:both;}

</style>

</head>

<body>

</a></div>
<div id="container">

 <div class="left" id="1"></div>
 <div id="ajax"></div>
  <div class="clear"></div>

  <script type="text/javascript">

    $('#1').iphoneSwitch("on", 
     function() {
       $('#ajax').load('on.html');
      },
      function() {
       $('#ajax').load('off.html');
      },
      {
        switch_on_container_path: 'iphone_switch_container_off.png'
      });
  </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:04:37.507

为什么不使用一个简单的超时javascript函数，例如：

```
<script type="text/JavaScript">
    var timeoutPeriod = 5000;
    function timedRefresh(timeoutPeriod) {
        setTimeout("location.reload(true);",timeoutPeriod);
    }

</script> 
```

您可以添加逻辑以仅在单击 on 开关时运行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:13:52.947

您可以像这样启用和禁用页面刷新：

```
var refreshTimer;

$('#button').iphoneSwitch("on", 
    function() {
        refreshTimer = setTimeout(function(){ location.reload(true); }, 5000);
    },
    function() {
        clearTimeout(refreshTimer);
    },
    {
        switch_on_container_path: 'iphone_switch_container_off.png'
    }
); 
```

如果你想使用 ajax 重新加载一些 html，你可以使用这样的东西（使用 setInterval）：

```
var refreshTimer;

function ajaxReload()
{
    $.ajax .. etc
}

$('#button').iphoneSwitch("on", 
    function() {
        refreshTimer = setInterval(ajaxReload, 5000);
    },
    function() {
        clearInterval(refreshTimer);
    },
    {
        switch_on_container_path: 'iphone_switch_container_off.png'
    }
); 
```

**编辑**

在此示例中，默认情况下禁用页面重新加载，当用户使用按钮启用它时，它将保持打开状态直到禁用

```
var refreshTimer;

function enableTimer()
{
    refreshTimer = setTimeout(function(){ location.reload(true); }, 5000);
    window.location.hash = "#autoreload";
}

function disableTimer()
{
    clearTimeout(refreshTimer);
    window.location.hash = "";
}

$(function() {

    $('#button').iphoneSwitch(
        (window.location.hash == "#autoreload" ? "on" : "off"), 
        enableTimer, 
        disableTimer
    );

    if (window.location.hash == "#autoreload")
        enableTimer();
}); 
```

# api - 开放图形洞察 API

> ID：12611730
> 
> 赞同：1
> 
> 时间：2012-09-26T23:01:38.717
> 
> 标签：api, facebook-graph-api, facebook-insights

有没有办法通过查询 API 获取 Open Graph Insights 部分中提供的数据（例如：自定义 OG 操作的点赞和评论）？

我们希望无需爬取洞察页面即可执行此操作。

# sockets - 标签库支持命名空间：http://primefaces.org/ui，但没有为名称定义标签：socket

> ID：12611733
> 
> 赞同：1
> 
> 时间：2012-09-26T23:01:49.367
> 
> 标签：sockets, jsf, primefaces, atmosphere

当我的 xhtml 页面加载时出现错误消息，指向我的 xhtml 中的以下行：

> “标签库支持命名空间： http: [//primefaces.org/ui](http://primefaces.org/ui)，但没有为名称定义标签：socket”

我的 xhtml 中的行：（在 h:form 关闭之后）

```
<p:socket onMessage="handleMessage" channel="/counter" /> 
```

（我在这里仔细阅读了很棒的教程：[http](http://blog.eisele.net/2012/09/primefaces-push-with-atmosphere-on.html) ://blog.eisele.net/2012/09/primefaces-push-with-atmosphere-on.html ）

我应该在哪里调试？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-26T23:53:22.823

您在那里链接的博客的第一句话说：

> *PrimeFaces 3.4 三天前问世。除了通常令人敬畏的新组件和更新组件之外，它还包括新的 PrimeFaces Push 框架。*

因此，它仅在 PrimeFaces 3.4 之后可用。您收到的错误消息表明您还没有[升级](http://www.primefaces.org/downloads.html)到 3.4，或者升级本身没有正确完成（例如，旧的 PrimeFaces 版本根本没有被删除）。

# javascript - 更改复选框onclick的名称

> ID：12611734
> 
> 赞同：-2
> 
> 时间：2012-09-26T23:01:51.027
> 
> 标签：javascript

我需要在使用 javascript 单击复选框时更改其名称属性，但我不确定如何执行此操作。这是我尝试过的：

```
$("#first").click(function() {

$(#first).attr("name", thatName);

alert(#first).attr("name");
}); 
```

`<input type="checkbox" name="thisName" id="first">`

不好！任何帮助表示赞赏。

编辑...我想我明白了！...任何人都可以提供有关此解决方案的反馈：

```
$(document).ready(function(){
    $("#first").click(function() {
        $("#first").attr("name", "chump");
        alert($("#first").attr("name"));
    });
}); 
```

它有效，但我想听听任何人关于它是否会出现问题的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:07:36.493

您缺少引号-

```
var thatName = "chkBox";
$("#first").click(function() {
    $("#first").attr("name", thatName);
    alert("#first").attr("name");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:03:08.460

您缺少字符串的引号：

```
$("#first").click(function() {

    $("#first").attr("name", thatName);

}); 
```

但是您不需要首先做`$('#first')`，因为`this`现在将对象设置为它：

```
$("#first").click(function() {

    $(this).attr("name", thatName);

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T23:05:11.830

您可以在函数内部替换`#first`为。`this`

```
$("#first").click(function() {

    // you need to first assign a value to thatName
    $(this).attr("name", thatName);
    alert($(this).attr("name"));

}); 
```

注意：您需要将整个`alert`消息括在括号中。不要忘记美元符号。

# android - 片段内容不显示

> ID：12611738
> 
> 赞同：0
> 
> 时间：2012-09-26T23:02:08.573
> 
> 标签：android, android-fragments

我有两个片段。当我尝试从第一个更改第二个时，调试器加入第二个片段但内容不显示。我尝试添加和替换方法，但都一样。第二个的内容没有改变。

```
FragmentManager fragmentManager = getFragmentManager();
        FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();

        RepairViewFragment fragment = new RepairViewFragment();
        fragmentTransaction.add(R.id.detailFragment, fragment);
        fragmentTransaction.commit(); 
```

谢谢。

这是代码`RepairViewFragment`

```
public class RepairViewFragment extends Fragment implements OnClickListener {

//  private final static int REQUEST_ENABLE_BT = 1;
//  private final static int REQUEST_BT_SETTINGS = 2;

ProgressDialog myProgressDialog = null;
BluetoothAdapter mBluetoothAdapter = null;

ArrayList<MachineBT> Machines = new ArrayList<MachineBT>();

String BluetoothDevices = "";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

}

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);

    mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();

    Button btn_cl = (Button)getView().findViewById(R.id.btn_client_automat);
    btn_cl.setOnClickListener(this);

    Button btn_own = (Button)getView().findViewById(R.id.btn_own_automat);
    btn_own.setOnClickListener(this);

    ImageButton img_back = (ImageButton)getView().findViewById(R.id.img_back);
    img_back.setOnClickListener(this);

}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    View view = inflater.inflate(R.layout.repair_layout, container, false);
    return view;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T07:19:11.830

尝试将您在 onActivityCreated 中编写的代码移动到 onStart。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T06:47:24.787

嗯，我认为您应该将代码放在片段的 onCreateView 部分，而不是在 activityCreated 上，我知道 activityCreated 用于 listfrags，就像我的情况一样：D

# python - python密码子翻译输入检查

> ID：12611742
> 
> 赞同：-1
> 
> 时间：2012-09-26T23:02:33.970
> 
> 标签：python, input

我被困在密码子翻译器的错误检查中，该翻译器将密码子翻译成相应的氨基酸。我在字典中有密码子表。现在我想检查两个不同的输入错误：

1.  像“JFK”这样的输入应该显示一个错误，表明它不是密码子
2.  像“JF”这样的输入应该显示一个错误，表明它不是密码子，也不是三碱基代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:15:27.727

```
codon = raw_input()
if len(codon) != 3:
  print "Not a codon/3 letter based."
elif codon not in codonHash:
  print "Not a codon"
else:
  acid = codonHash[codon] 
```

我相信这应该有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:10:54.360

如果您的字典中有密码子，您可以尝试查找潜在的密码子并捕获由此产生的错误。

```
def check_codon(codon):
    try:
        acid = codonTable[codon]
    except KeyError:
        if len(codon) != 3:
            return "Not a codon, not a three-base code"
        else:
            return "Not a codon"

>>> print check_codon("JFK")
"Not a codon"
>>> print check_codon("JK")
"Not a codon, not a three-base code" 
```

# jenkins - phantomjs 茉莉花詹金斯

> ID：12611749
> 
> 赞同：1
> 
> 时间：2012-09-26T23:03:30.447
> 
> 标签：jenkins, jasmine, phantomjs

我遵循了[http://www.zendesk.com/blog/javascript-loves-ci](http://www.zendesk.com/blog/javascript-loves-ci)中给出的确切步骤，除了 jshint（因为我现在不需要它）。但是通过运行脚本运行 phantomjs 时出现以下错误。有谁知道它为什么会失败？

```
→ phantomjs spec/javascripts/support/phantom-js-runner.js http://localhost:8888
TypeError: 'undefined' is not an object 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-25T22:50:44.553

从 jasmine 2.0 开始，大部分设置都不需要让 jasmine 通过 phantom 运行。如果您安装了 jasmine-gem，默认运行器现在是 phantom，我们还没有听说让它运行有任何问题。

# ios - 为什么我不能让 glDrawElements 在 OpenGLES 2.0 中使用 VBO 进行绘制？

> ID：12611752
> 
> 赞同：0
> 
> 时间：2012-09-26T23:04:02.617
> 
> 标签：ios, opengl-es-2.0, opengl-3

我正在尝试使用 OpenGL 在 iOS 中进行简单测试（ES 2.0，但如果它是具有核心配置文件的常规 GL 3.5 或基本上没有固定管道的任何实现，则应该相同）：

我已经正确设置了所有内容（上下文、着色器、mvl 矩阵等）并通过 glDrawArrays 成功渲染了一个三角形，VBO 如下所示：

```
- (void)loadActors
{           
            GLfloat triangle1[] = {
                -1.0, -2.0, 0.0,
                3.0, 0.0, 0.0,
                0.0, 1.5, 0.0
            };

            GLuint VBO;
            glGenBuffers(1, &VBO);

            glBindBuffer(GL_ARRAY_BUFFER, VBO);
            glBufferData(GL_ARRAY_BUFFER, sizeof(triangle1), triangle1, GL_STATIC_DRAW);
            glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, sizeof(GLfloat)*3, 0);
            glEnableVertexAttribArray(0);
}

- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect
{
    glClearColor(1., 0., 0., 1.);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glUseProgram(_program);

    glUniformMatrix4fv(uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX], 1, 0, _modelViewProjectionMatrix.m);
    glUniformMatrix3fv(uniforms[UNIFORM_NORMAL_MATRIX], 1, 0, _normalMatrix.m);

    glDrawArrays(GL_TRIANGLES, 0, 3);
} 
```

现在，我正在尝试启用索引。所以我创建了另一个（全局）数组，它只包含 0,1,2 并尝试使用它来索引 VBO。像这样：

```
- (void)loadActors
{ 
            GLfloat triangle1[] = {
                -1.0, -2.0, 0.0,
                3.0, 0.0, 0.0,
                0.0, 1.5, 0.0
            };

            indicesG = malloc(sizeof(GLuint)*3);
            indicesG[0] = 0;
            indicesG[1] = 1;
            indicesG[2] = 2;

            GLuint VBO[2];
            glGenBuffers(2, VBO);

            glBindBuffer(GL_ARRAY_BUFFER, VBO[0]);
            glBufferData(GL_ARRAY_BUFFER, sizeof(triangle1), triangle1, GL_STATIC_DRAW);
            glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, sizeof(GLfloat)*3, 0);
            glEnableVertexAttribArray(0);

            glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, VBO[1]);
            glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indicesG), indicesG, GL_STATIC_DRAW);
}

- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect
{
    glClearColor(1., 0., 0., 1.);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glUseProgram(_program);

    glUniformMatrix4fv(uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX], 1, 0, _modelViewProjectionMatrix.m);
    glUniformMatrix3fv(uniforms[UNIFORM_NORMAL_MATRIX], 1, 0, _normalMatrix.m);

    glDrawElements(GL_TRIANGLES, 3, GL_UNSIGNED_INT, 0);
} 
```

我希望索引数组仅调用 VBO 的顶点 0,1 和 2，如果我不使用 GL_ELEMENT_ARRAY_BUFFER，我会得到相同的三角形。但相反，似乎没有绘制任何内容。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:57:26.210

你有`3`作为 glDrawElements 的最后一个参数，应该是`0`，因为你想从索引 VBO 的开头开始计数，而不是 3 个字节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T00:35:05.100

问题实际上是我对 indicesG 数组大小的计算。我正在做`sizeof(indicesG)`并且应该做`sizeof(GLuint)*3`

它适用于`glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(GLuint)*3, indicesG, GL_STATIC_DRAW);`

# php - yii 框架：显示消息“您的浏览器中禁用了 Cookie”

> ID：12611754
> 
> 赞同：-1
> 
> 时间：2012-09-26T23:04:10.307
> 
> 标签：php, cookies, yii

我正在使用 Yii 框架开发一个项目，我的问题是：当用户尝试在浏览器中禁用 cookie 的情况下登录网站时，我如何向用户显示消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T03:49:00.563

这里和yii无关就用：

```
if(count($_COOKIE) > 0){
    echo "Cookies are yummy!";
} else {
    die( "You didn't bring any cookies here. We are hungry!");
} 
```

检查这个网址：[http ://nik.chankov.net/2010/01/16/detecting-if-the-cookies-are-enabled-with-php/](http://nik.chankov.net/2010/01/16/detecting-if-the-cookies-are-enabled-with-php/)

要使用 yii 管理 Cookie，请查看：[http ://www.yiiframework.com/wiki/152/cookie-management-in-yii/](http://www.yiiframework.com/wiki/152/cookie-management-in-yii/)

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T12:52:09.983

在 WebUser 类中，我已经像这样覆盖了 beforeLogin 函数：

```
public function beforeLogin(){
    if(!isset(Yii::app()->request->cookies['PHPSESSID']))      
    Yii::app()->controller->redirect(array('page','view'=>'cookies'));
    return parent::beforeLogin($id,$states,$fromCookie);
} 
```

我定义了一个静态页面站点/页面/cookies 来显示消息。

# asp.net-mvc-3 - 如何创建保留字列表，然后在用户使用 asp.net MVC 注册时对其进行测试？

> ID：12611762
> 
> 赞同：1
> 
> 时间：2012-09-26T23:04:59.387
> 
> 标签：asp.net-mvc-3

我是 MVC C# 新手。

我有一个使用.net 内置的简单会员功能的项目。我有这一切工作正常。但是，我确实希望防止用户在注册时选择某些用户名，这些用户名已经不在数据库中，例如脏话（我今天已经使用了很多）。

我想在 ajax 调用和提交时针对这个列表进行测试。解决这个问题的正确方法是什么？我已经让系统从数据库检查正在使用的用户名，没有问题。

我在 RegisterModel 中添加了一个名为 ReservedWords 的列表，但我只是不知道在哪里或如何填充它，以便它可用于 2 个控制器（异步和发布）。

模型如下所示：

```
public class RegisterModel
{
    public string Email { get; set; }

    public string UserName { get; set; }

    public string Password { get; set; }

    public List<ReservedWord> ReservedWords { get; set; }
} 
```

我应该在模型文件或控制器中填充它吗？无论哪种情况，您都可以提供样品吗？

异步和回发的控制器代码都在这里：

```
 // POST: /Account/doesUserNameExist async

    [AllowAnonymous]
    [HttpPost]
    public JsonResult doesUserNameExist(string UserName)
    {
        var user = Membership.GetUser(UserName);
        return Json(user == null);
    }

 // POST: /Account/Register

    [HttpPost]
    [AllowAnonymous]
    [ValidateAntiForgeryToken]
    public ActionResult Register(RegisterModel model)
    {
        if (ModelState.IsValid)
        {
            // Attempt to register the user
            try
            {
                WebSecurity.CreateUserAndAccount(model.UserName, model.Password);
                Roles.AddUserToRole(model.UserName, Request.Form["RoleName"]);
                WebSecurity.Login(model.UserName, model.Password);

                return RedirectToAction("Index", "Home");
            }
            catch (MembershipCreateUserException e)
            {
                ModelState.AddModelError("", ErrorCodeToString(e.StatusCode));
            }
        }

        // If we got this far, something failed, redisplay form
        return View(model);
    } 
```

提前致谢！！！！！

* * *

## 更新

所以我按照建议创建了一个自定义验证属性，它在提交时效果很好。谢谢！有没有办法让它与客户端验证一起工作？我有一个类似的自定义验证属性，它比较两个字段并确保它们不相等。我遵循了该代码，但没有运气。这是现在的代码：

```
public class BlackListWordAttribute : ValidationAttribute, IClientValidatable
{
    private const string defaultErrorMessage = "{0} cannot use forbidden word.";

    private readonly List<string> blackListedWords = new List<string>();

    public BlackListWordAttribute()
        : base(defaultErrorMessage)
    {
        //populate from database or text file with cache dependency on either
        blackListedWords.Add("bananas");
    }

    public override string FormatErrorMessage(string name)
    {
        return string.Format(ErrorMessageString, name);
    }

    protected override ValidationResult IsValid(object value, ValidationContext validationContext)
    {
        if (value != null)
        {
            if (blackListedWords.Any(x => x.ToLower() == value.ToString().ToLower()))
            {
                return new ValidationResult(FormatErrorMessage(validationContext.DisplayName));
            }
        }

        return ValidationResult.Success;
    }
    public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context)
    {
        yield return new ModelClientValidationRule
        {
            ErrorMessage = FormatErrorMessage(metadata.DisplayName),
            //This is the name of the method added to the jQuery validator method (must be lower case)
            ValidationType = "blacklistword"
        };

    }
} 
```

再次感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:29:50.670

我会使用自定义验证。如果您将模式更改为

```
public class RegisterModel
{
    public string Email { get; set; }

    [BlackListWord]
    public string UserName { get; set; }

    public string Password { get; set; }
} 
```

然后自定义验证属性可能类似于：

```
 [AttributeUsage(AttributeTargets.Property, AllowMultiple = true, Inherited = false)]
    public class BlackListWordValidationAttribute : ValidationAttribute {
        private readonly List<string>  blackListedWords = new List<string>();

        public BlackListWordValidationAttribute() {
            //populate from database or text file with cache dependency on either
            blackListedWords.Add("bananas");
        }
        protected override ValidationResult IsValid(object value, ValidationContext validationContext) {
            if(value!=null) {
                if (blackListedWords.Any(x => x.ToLower() == value.ToString().ToLower()))
                    return new ValidationResult(@"Cannot use black listed word.");
            }

            return ValidationResult.Success;
        }
    } 
```

您可以将黑名单存储在数据库或文件或 xml 或其他任何内容中。

然后您也可以添加客户端验证。为了帮助解决这个问题，请考虑使用类似这个[肮脏列表](http://www.thefilthylist.com/pages/services.aspx)的东西，您可以通过 Web 服务访问它。

编辑/更新 2 号：

根据提问者的要求。使代码对“异步和回发”都可用的最佳方法是创建一个字符串扩展方法。例如，

```
public static class StringExtension {
        public static bool IsUserNameAllowed(this string value) {
    List<ReservedWord> ReservedWords = GetReservedWordsFromPersistantMedium();

    return ReservedWords.All(x => x.Word.ToLower() != value.ToLower());
    }
} 
```

将上面的类放在一个引用的项目或带有 web 项目的扩展文件夹中。

然后你可以打电话

```
model.UserName.IsUserNameAllowed() or userName.IsUserNameAllowed() 
```

例如：

```
[AllowAnonymous]
[HttpPost]
public JsonResult doesUserNameExist(string UserName)
{
    if !(UserName.IsUserNameAllowed())
    {
        return Json(new { ErrorMessage="An error has occured"});
    }
    var user = Membership.GetUser(UserName);
    return Json(user == null);
} 
```

在任何一种情况下

# c# - 在 WPF 中绑定 Incode DataTemplate

> ID：12611772
> 
> 赞同：0
> 
> 时间：2012-09-26T23:05:30.680
> 
> 标签：c#, wpf, mvvm

我有一个使用 MVVM 的 WPF 应用程序。

我知道在 XAML 中有这样做的方法，但我正在研究插件架构并提出了一个解决方案，其中插件将它的视图模型公开给我的插件主机的视图模型和它的数据模板。我想将插件视图的生命周期管理留给 WPF。我曾尝试让插件公开一个 UserControl，但是当 WPF 决定处置我的 UserControl 时遇到了问题，因此如果没有奇怪的 hacky 解决方法，我不会重新附加它。我在将某种绑定工作到可以将控件绑定到数据并将其模板绑定到我的数据模板的位置时遇到问题。

我有一个看起来像这样的 ViewModel：

```
public class MyViewModel
{
    public DataTemplate SelectedTemplate{ get; set;}
    public object SelectedViewModel {get; set;}
} 
```

所选模板和视图模型在代码中的其他位置确定，但与我的问题无关。

我的问题是如何绑定到 DataTemplate 以便我知道如何显示 SelectedViewModel 中显示的数据。

DataTemplate 是一个 DataTemplate 创建的 incode，它表示：

```
<DataTemplate DataType="{x:Type vm:MyViewModel}">
    <v:MyUserControl />
</DataTemplate> 
```

我努力了：

```
<UserControl Template="{Binding Path=SelectedTemplate}" 
    Content="{Binding Path=SelectedViewModel"} /> 
```

但 UserControl 需要一个控件模板而不是数据模板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T09:36:20.327

```
<UserControl>
   <ContentControl Content="{Binding SelectedViewModel}" ContentTemplate="{Binding SelectedTemplate}" />
</UserControl> 
```

# ios - 这是一个错误还是我的代码中有错误？

> ID：12611774
> 
> 赞同：1
> 
> 时间：2012-09-26T23:05:34.707
> 
> 标签：ios, xcode4, ios6

每当我将我的应用程序运行到“iPhone 6.0 模拟器”中时，我都会遇到这种奇怪的行为。第一次，它会成功运行，但第二次，它会因错误而崩溃：

```
loaded the "IouView" nib but the view outlet was not set.' 
```

这是可重现的，每隔一段时间，它就会起作用，反之亦然，它会崩溃。这是我的应用程序结构：

在 AppDelegate 中：

```
self.iouViewController = [[IouViewController alloc] initWithNibName:@"IouView" bundle:nil];
    [iouViewController setIouTableArray:iouTableArray];
    navController = [[UINavigationController alloc] initWithRootViewController:self.iouViewController];
    [window setRootViewController:navController]; 
```

然后，在 IouViewController.h 中：

```
@property (strong, nonatomic) IBOutlet UITableView *iouTableView; 
```

直到今天，我一直以编程方式编写我的视图（tableView 等）。由于 iPhone 5 有 4" 屏幕，我决定停止与 Apple 对抗，并使用 IB 和“自动布局”功能。

在我的 IouView.xib 中，结构如下：

```
Objects: 'View', 
  Referencing Outlets: view - File's Owner

Objects: 'View'->'Table View'
  Outlets: dataSource - File's Owner
  Outlets: delegate - File's Owner
  Referencing Outlets: iouTableView - File's Owner 
```

视图中实际上还有另一个表视图，但我没有在此处包含它。请帮助，因为我不知道如何进行！非常感谢。

只是把它扔在那里，因为我可能没有正确初始化我的视图控制器，我注释掉了'loadView'并将其用作init：

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {

    }

    return self;
} 
```

PS：我在 iOS 6 SDK 上构建，启用了 Apple LLVM 4.1 和 ARC。

更新：来自 IB 的图片添加： ![图像1](../Images/0017a69be63fdc131121ca32e543beeb.png) ![图2](../Images/d6b6ac48e36e7e824a492955ef3407bb.png) ![图3](../Images/1dd1a4f5145f788f67de046c25f726cc.png) ![图4](../Images/73a571b28f8636d7cdef2d9f85150f5a.png)

仍然迷路，如果您需要更多代码，请告诉我。我用一个简单的导航控制器创建了一个新项目，它适用于那个新项目，但不适用于我的。崩溃与模拟器有关。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-27T22:41:23.627

我认为我找到了一个不再使模拟器崩溃的解决方案。我只通过了第一个视图。这就是我所做的“事情”。如果有人有见解，请让他们分享，希望也能帮助其他人。特别感谢 Carl Veazey 的帮助。

我忘了提到的是，这段代码是在没有 ARC 的 iOS4 时代完成的。当我切换时，发生了很多变化。

按照 Carl 的建议，我查看了 'Build Phases' -> 'Compile Sources' 并查看了 IouView.xib。所以，我删了一个。我运行程序，它显示黑屏。最后，我查看了 main.m

原来的：

```
@autoreleasepool {
    int retVal = UIApplicationMain(argc, argv, nil, nil);
    return retVal;
} 
```

并将其更改为：

```
@autoreleasepool {
    return UIApplicationMain(argc, argv, nil, NSStringFromClass([IouApp2AppDelegate class]));
} 
```

我必须#import我的AppDelegate。进行该更改后，我可以多次运行该程序并且它没有崩溃。

# c++ - 使用变量访问字符串的内容

> ID：12611775
> 
> 赞同：-2
> 
> 时间：2012-09-26T23:05:48.757
> 
> 标签：c++, string, variables, printing

我目前正在做一些需要我访问字符串的个人部分的事情。我似乎在字符串语法中出现了一个奇怪的错误。

这是我的问题：

说你有一个字符串

```
string str = "hello"; 
```

`str[0]`您可以使用,访问该字符串中的单个字符`str[1]`。例子：

```
cout << str[0]; 
```

印刷：`'h'`

但是，使用以下语法，不会打印任何内容。

```
int i = 0;

cout << str[i]; 
```

无论我使用什么类型的变量，我都会得到相同的结果。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-09-26T23:52:42.263

String 是一个 C++ 对象，它不像 C 中那样存储为字符数组，因此您无法访问其单独的部分。它应该转换为 C 字符数组以访问其部分。
尝试这个：

```
cout <<str.c_str()[i]; 
```

# asp.net - 带有 Icollections 的 DropDownListFor

> ID：12611785
> 
> 赞同：1
> 
> 时间：2012-09-26T23:06:57.577
> 
> 标签：asp.net, asp.net-mvc-3

我正在尝试将多个租户添加到 House 实体。我的错误是下拉框 (option.TenantID == Model.TenantID) 我不知道如何比较 int 和 Icollection。

**模型**

```
namespace FlatSystem.Models
{
[Table("House")]
public class House
{
    [Key]
    public int HouseID { get; set; }
    public virtual ICollection<Tenants> TenantID { get; set; }

    public House() {
       TenantID = new HashSet<Tenants>();
    }

}
} 
```

**控制器**

```
public ActionResult Edit(int id)
{
    ViewBag.TenantLookupList = TenantGR.All;
    return View(GR.Find(id));
}
//
// POST: /House/Edit/5
[HttpPost]
public ActionResult Edit(House house)
{
    if (ModelState.IsValid)
    {
        GR.InsertOrUpdate(house);
        GR.Save();
        return RedirectToAction("Index");
    }
    return View(house);
} 
```

**编辑视图**

```
 @using (Html.BeginForm("AddRole", "Role", new { houseId = @Model.HouseID }))
 {
        <table>
        <tr>
            <td>Select to Add Item</td>
            <td>
               <div class="editor-field">
                 @Html.DropDownListFor(model => model.TenantID, ((IEnumerable<FlatSystem.Models.Tenants>)ViewBag.TenantLookupList).Select(option => new SelectListItem
                 {
                   Text = (option == null ? "None" : option.Firstname),
                   Value = option.TenantID.ToString(),
                   Selected = (Model != null) && (option.TenantID == Model.TenantID) <<----Error
                 }), "Choose...")
              </div>
            </td>
           <td><input type="submit" value="Add" /></td>
        </tr>
        </table>
 } 
```

**错误**

```
Operator '==' cannot be applied to operands of type 'int' and     'System.Collections.Generic.ICollection<FlatSystem.Models.Tenants>' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T05:55:52.213

由于您在模型中有多个租户，也许您正在寻找一个`ListBox`（允许多项选择）。

```
@Html.ListBoxFor(model => model.TenantID, ((IEnumerable<FlatSystem.Models.Tenants>)ViewBag.TenantLookupList).Select(option => new SelectListItem
    {
        Text = (option == null) ? "None" : option.Firstname),
        Value = option.TenantID.ToString()
    }), "Choose...") 
```

请注意，您不需要`Selected`显式设置属性，因为这是由模型确定的。您应该会看到`Model.TenantID`所选集合中的所有项目。

* * *

如果要设置所选项目，则必须使用`Html.ListBox`.

```
@Html.ListBox("MyListBox", ((IEnumerable<FlatSystem.Models.Tenants>)ViewBag.TenantLookupList).Select(option => new SelectListItem
{
    Text = (option == null) ? "None" : option.Firstname),
    Value = option.TenantID.ToString(),
    Selected = Model.TenantID.Any(tenant => tenant.ID == option.TenantID)
}), "Choose...") 
```

# python-3.x - 查找任何用户的主目录

> ID：12611787
> 
> 赞同：2
> 
> 时间：2012-09-26T23:07:06.270
> 
> 标签：python-3.x

我找到了几种解决方案来找出运行所述脚本的用户的用户主目录，但是，我正在编写一个小脚本，以便在为 lighttpd 或 apache 创建虚拟主机配置时让我的生活更轻松，并希望遵循类似的方案所以：

*   /home/USER/html/example.com
*   /home/USER/html/domain1.com

等等等等。但是，我可能会在以后决定是否要`/var/www/vhosts/example.com/public_html`用作某些域的模式。

该脚本显然必须以root身份运行，因此执行没有意义`os.getenv("HOME")`。我意识到我可以简单地连接`homedir = "/home/%s/" % username`。

我只是好奇是否有人遇到任何解决方案来**检索未执行脚本的用户的主目录。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T23:14:41.440

您正在寻找`os.path.expanduser`：[https ://docs.python.org/library/os.path.html#os.path.expanduser](https://docs.python.org/library/os.path.html#os.path.expanduser)

# asp.net - Visual Basic 可空值类型相等

> ID：12611795
> 
> 赞同：1
> 
> 时间：2012-09-26T23:07:39.070
> 
> 标签：asp.net, vb.net

为什么这打印出来的不是真的？

```
>         Dim test1 As Decimal? = Nothing
>         Dim test2 As Decimal? = 5D
> 
>         If (test1 <> test2) Then
>             Console.WriteLine("true")
>         End If 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T23:19:18.753

与 C# 不同，不等于运算符对此不起作用。相反，使用`Nullabe.Equals()`

```
Dim test1 As Decimal? = Nothing
Dim test2 As Decimal? = 5D

If (Nullable.Equals(test1, test2) = False) Then
    Console.WriteLine("not equal")
Else
    Console.WriteLine("equal")
End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:18:25.123

将值与空值进行比较通常会返回`False`.

无法比较这些值，因为缺少值，因此`=`and`<>`运算符都会返回`False`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T23:18:29.600

我想到了。我需要去做

IF（不是 test1.Equals（test2））

# ios - 截图定义(x,y,width,height)-MKAnnotationView

> ID：12611797
> 
> 赞同：0
> 
> 时间：2012-09-26T23:07:45.213
> 
> 标签：ios, mapkit, screenshot, mkannotation, mkannotationview

正如您在下面看到的代码截取了整个视图的屏幕截图，但是我如何修改下面的代码来捕获屏幕截图。例如，我想获取 (x,y,width,height)--> (20,20,120,50) 截图。我真正的问题是捕获注释部分屏幕截图并在 secondviewcontroller 中显示该区域。只是我需要知道如何捕获部分视图屏幕截图。提前致谢。

```
- (UIImage*)screenshot 
{
    // Create a graphics context with the target size
    // On iOS 4 and later, use UIGraphicsBeginImageContextWithOptions to take the scale into consideration
    // On iOS prior to 4, fall back to use UIGraphicsBeginImageContext
    CGSize imageSize = [[UIScreen mainScreen] bounds].size;
    if (NULL != UIGraphicsBeginImageContextWithOptions)
        UIGraphicsBeginImageContextWithOptions(imageSize, NO, 0);
    else
        UIGraphicsBeginImageContext(imageSize);

    CGContextRef context = UIGraphicsGetCurrentContext();

    // Iterate over every window from back to front
    for (UIWindow *window in [[UIApplication sharedApplication] windows]) 
    {
        if (![window respondsToSelector:@selector(screen)] || [window screen] == [UIScreen mainScreen])
        {
            // -renderInContext: renders in the coordinate space of the layer,
            // so we must first apply the layer's geometry to the graphics context
            CGContextSaveGState(context);
            // Center the context around the window's anchor point
            CGContextTranslateCTM(context, [window center].x, [window center].y);
            // Apply the window's transform about the anchor point
            CGContextConcatCTM(context, [window transform]);
            // Offset by the portion of the bounds left of and above the anchor point
            CGContextTranslateCTM(context,
                                  -[window bounds].size.width * [[window layer] anchorPoint].x,
                                  -[window bounds].size.height * [[window layer] anchorPoint].y);

            // Render the layer hierarchy to the current context
            [[window layer] renderInContext:context];

            // Restore the context
            CGContextRestoreGState(context);
        }
    }

    // Retrieve the screenshot image
    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

    UIGraphicsEndImageContext();

    return image;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-09T05:28:54.463

您可以通过提供 CGRect 参数来选择您的屏幕截图大小。

```
CGRect grabRect = CGRectMake(0,0,300,372); 
CGSize imageSize = grabRect.size; 
```

干杯。

# objective-c - 有没有办法使用内存映射文件访问从文件创建 CFData 对象？

> ID：12611798
> 
> 赞同：3
> 
> 时间：2012-09-26T23:07:53.313
> 
> 标签：objective-c, macos, cocoa-touch, cocoa, core-foundation

我仅限于在特定应用程序中使用 CoreFoundation，并且无权访问`NSData`.

我需要使用内存映射从文件中访问数据，因为该文件可能非常大。使用`NSData`，我可以使用该`+dataWithContentsOfURL:options:error:`方法实现此目的，并传入`NSDataReadingMappedAlways`选项。

有可能做到这一点`CFData`吗？我能找到的唯一`CFData`直接从文件中创建对象的函数是该`CFURLCreateDataAndPropertiesFromResource()`函数，它没有任何选项来设置内存映射标志。

`CFData`是否有一种使用内存映射读取从文件中加载对象的低级方法？我必须下降到`mmap`什么的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T23:40:55.403

您可以`CFData()`从字节缓冲区和计数创建一个。鉴于此，您应该能够处理`mmap()`有问题的文件，然后将映射的字节缓冲区传递给`CFDataCreateWithBytesNoCopy()`. 唯一真正的复杂性是您需要使用`CFAllocatorRef`知道如何`munmap()`作为`bytesDeallocator`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T01:07:06.300

这更像是一个评论而不是一个答案，但它太长了，无法放入评论中，所以......</p>

一般来说，当你不知道如何从 Cocoa/Foundation 做某事时，通常值得看看 GNUstep 等价物是如何实现的。当然 GNUstep 并没有实现 100% 的 Foundation 最新版本，而且它是直接在 POSIX 而不是 CoreFoundation 之上编写的，所以它并不总是有帮助……但通常是有帮助的。

在[NSData.m](http://svn.gna.org/viewcvs/gnustep/libs/base/trunk/Source/NSData.m)中，没有`+dataWithContentsOfURL:options:error:`，但有一个`+dataWithContentsOfMappedFile:`（当然还有`-initWithContentsOfMappedFile:`）方法，以及`NSDataMappedFile`它所依赖的类的实现。

最终， the`NSDataMappedFile`是一个非常简单的 an 包装器`mmap`，`NSData`方法只是创建 an`NSDataMappedFile`并调用它`-initWithContentsOfMappedFile:`。唯一真正的复杂性是回退代码（确保伪造 mmap 并调用`[NSData initWithContentsOfFile:]`）——您明确不想要的代码。

所以，这是一个很好的线索，您希望完全按照 Kevin Ballard 的建议来实现它。

# javascript - 为什么在 Chrome 的某些网站上 console.log 是一个空函数？

> ID：12611803
> 
> 赞同：14
> 
> 时间：2012-09-26T23:09:21.990
> 
> 标签：javascript, events, event-handling, dom-events

转到 Twitter 的登录页面并在控制台中输入以下内容：

```
window.addEventListener('keypress', function(e){console.log('hello')}, true) 
```

（注意：第三个参数如何设置为`true`启用事件捕获。这会导致事件首先被窗口拦截，然后被子元素消费。）

尝试按一些键。请注意如何`hello`不输出到控制台。添加事件侦听器`keydown`或`keyup`不更改任何内容。

`hello`将在大多数网站上获得输出，但不会在 Twitter 或 Gmail 等网站上获得输出。

为什么？是什么阻止了事件监听器？

编辑：似乎在 Firefox 上按预期工作。但不是铬。为什么 Chrome 没有按预期触发事件侦听器？

编辑 2：正如下面的一些人所推断的，`console.log`对于 Twitter 和 Gmail 等网站，Chrome 上是一个空功能。这是为什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-26T23:14:27.343

因为这些网站已经专门设置（显然是针对 webkit）：

```
console.log = function(){}; 
```

`log()`但是，在 Chrome 中，您可以通过在控制台中发出以下命令来恢复原始功能：

```
console.log = console.__proto__.log 
```

然后你可以这样做：

```
window.addEventListener('keypress', function(e){console.log('hello')}, true) 
```

它应该按预期工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-10-28T23:58:27.960

从 iframe 获取它：

```
function setConsole() {
  var iframe = document.createElement('iframe');
  iframe.style.display = 'none';
  document.body.appendChild(iframe);
  console = iframe.contentWindow.console;
  window.console = console;
} 
```

（然后调用它）

```
setConsole() 
```

来源：[https ://gist.github.com/cowlicks/a3bc662b38c36483b35f74b2b54e37c0](https://gist.github.com/cowlicks/a3bc662b38c36483b35f74b2b54e37c0)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-26T23:48:38.450

开发人员喜欢`console.log()`在他们的代码中添加语句以进行故障排除/调试。有时，他们在签入生产代码时忘记将它们全部取出。一个简单的防范措施是`console.log()`在生产代码中将其重新定义为一个不执行任何操作的空函数，因此即使开发人员不小心留下了一个，它也不会导致任何输出或`console`在不运行调试器时没有对象时抛出异常（就像在 IE 中一样）。

一些浏览器可能会通过将其设置为只读以防止以这种方式覆盖该函数来防止替换该函数，但如果他们这样做，则控制台对象必须存在，因此偶尔`console.log()`声明仍然没有任何危害。这些剩余`console.log()`语句的主要危害是在 IE 中，它会导致抛出异常，因为`console`除非正在运行调试器，否则对象不存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T23:27:26.100

这是console.log 的问题。试试这个：

```
window.addEventListener('keypress', function(e){alert('hello')}, true) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-26T23:27:56.397

Firefox 不会出现此问题。

我检查了 Chrome，显然出于某种原因，Gmail 和 Twitter 页面最终将 console.log 重新分配给了一个空函数`function () {}`，所以你的处理程序被调用但它什么也没做。如果您尝试`alert()`代替console.log，您会看到它正常工作。

有趣的。

# ios - 在 UINavigationBar 中为 UIBarButtons 添加空间或边距

> ID：12611805
> 
> 赞同：0
> 
> 时间：2012-09-26T23:09:32.417
> 
> 标签：ios, uinavigationbar, uinavigationitem

是否可以为导航栏上的按钮添加 5 像素的边距？

![在此处输入图像描述](../Images/53e624c9b06a0f9fe8513568ba85233e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:15:44.577

您可以尝试向具有两个子视图的导航栏添加一个视图，一个用于边距，一个用于实际按钮。如果失败，请尝试在按钮内的图像中添加 5（或 Retina 显示 10）像素。

# asp.net-mvc - MVC 路由和区域 - 如何构建路由以匹配区域中默认控制器上的操作？

> ID：12611806
> 
> 赞同：3
> 
> 时间：2012-09-26T23:09:36.520
> 
> 标签：asp.net-mvc, routing, asp.net-mvc-areas

我有一个简单的 MVC4 网站，其中包含一个区域（称为“用户”），其中包含一个名为“HomeController”的控制器。

在这个控制器上有两个动作方法：Index 和 Details：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        return View();
    }

    public ActionResult Details(int id)
    {
        return View();
    }
} 
```

“UserAreaRegistration.cs”类如下：

```
public class UserAreaRegistration : AreaRegistration
{
    public override string AreaName
    {
        get
        {
            return "User";
        }
    }

    public override void RegisterArea(AreaRegistrationContext context)
    {
        context.MapRoute(
            "User_default",
            "User/{controller}/{action}/{id}",
            new { controller = "Home", action = "Index", id = UrlParameter.Optional },
            namespaces: new[] { "MvcApplication1.Areas.User.Controllers" }
        );

        context.MapRoute(
            "User_default_no_contoller",
            "User/{action}/{id}",
            new { controller = "Home", action = "Index", id = UrlParameter.Optional },
            namespaces: new[] { "MvcApplication1.Areas.User.Controllers" }
        );
    }
} 
```

还有一个不在名为“HomeController”的区域中的控制器：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        return View();
    }
} 
```

RouteConfig.cs（针对非区域路由）如下：

```
public class RouteConfig
{
    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional }
        );

        routes.MapRoute(
            name: "Default",
            url: "{controller}/{action}/{id}",
            defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional },
            namespaces: new[] { "MvcApplication1.Controllers" }
        );
    }
} 
```

我可以通过任一方式访问“主页”

*   /
*   /家
*   /首页/索引

我还可以在“用户”区域中访问“索引”操作

*   /用户

我*不能*做的是弄清楚如何在名为“详细信息”的区域中使用我的控制器上的另一种方法：

*   /User/Details/5 不起作用，它返回 404

我还注意到，尝试显式访问 Index 方法也没有正确路由：

*   /User/Index 不起作用，它返回 404

我究竟做错了什么？

是否可以在作为区域中“默认”控制器的控制器上使用“索引”以外的任何操作方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T03:50:28.993

你的第一条路线有太多的默认值，所以它吞噬了一切。

*   URI`/User/Details/5`匹配*User_default*路由（控制器：“详细信息”和操作：“5”）。
*   URI`/User/Index`还匹配第一个路由（控制器：“索引”和默认操作：“索引”）

接近路线的方法是

*   把最有选择性的路线放在第一位
*   并仅设置必要的最小默认值
*   使用[路由约束](http://www.asp.net/mvc/tutorials/controllers-and-routing/creating-a-route-constraint-cs)来确保 MVC 路由器不会尝试错误地匹配参数（即，给用于*int*参数的路由值一个数字约束）
*   将最通用的路由（即*User_default*）放在最后（作为不匹配任何更具体路由的 URI 的全部内容）

我会尝试像这样设置区域路线。

```
context.MapRoute(
        "User_default_no_contoller",
        "User/{action}/{id}",
        defaults: new { controller = "Home", id = UrlParameter.Optional },
        constraints: new { id = @"\d+" },
        namespaces: new[] { "MvcApplication1.Areas.User.Controllers" }
    );

context.MapRoute(
        "User_default",
        "User/{controller}/{action}/{id}",
        new { controller = "Home", action = "Index", id = UrlParameter.Optional },
        namespaces: new[] { "MvcApplication1.Areas.User.Controllers" }
    ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-01T20:58:10.277

克服这个“多默认”问题的另一个建议是使用命名空间进行分离。

在您的示例中，我的建议是在命名空间 "Areas.User" 中有 Class UserAreaRegistration 。随后，您必须将 HomeController 放在命名空间“Areas.User.Controllers”中的用户区域中

它对我有用并保持代码干净。

彼得

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T10:42:40.027

感谢dbaseman的回答。它帮助我查看了自己的路由问题。我不确定我是否遇到了同样的问题，但这就是它的样子。

```
 routes.MapRoute("Tag", "Tag/{tag}", new { controller = "Blog", action = "Tag" });
        routes.MapRoute("Category", "Category/{category}", new { controller = "Blog", action = "Category" });
        routes.MapRoute("Post", "Archive/{year}/{month}/{day}/{title}", new {controller = "Blog", action = "Post"});
        routes.MapRoute("Action", "{action}", new { controller = "Blog", action = "Posts" }); 
```

当我在任何其他路线上方使用“Action”参数的最后一条路线时，将不会捕获“Action”下方的路线。将它移动到 RouteConfig 的底部允许它上面的所有现在成功命中。

# matlab - 如何在 matlab/octave 中读取格式化输入？

> ID：12611810
> 
> 赞同：2
> 
> 时间：2012-09-26T23:10:39.427
> 
> 标签：matlab, octave

我计划读取 5 列的格式化 .txt 文件，并按以下方式组织：

```
0 1:0.007477 2:0.000000 3:1.000000 id:10002 #we = GX008-86-4444840 an = 1 asd = 0.086622
0 1:0.603738 2:0.000000 3:1.000000 id:10002 #we = GX037-06-11625428 an = 0.0031586555555558 asd = 0.0897452
0 1:0.214953 2:0.000000 3:0.000000 id:10002 #we = GX044-30-4142998 an = 0.00841930701072746 asd = 0.0999735 
```

我计划将这些文件的内容读入一个矩阵，其中每个元素都将被视为字符串。在我成功将其读入矩阵后，我计划使用 octave 中的字符串操作函数来删除不必要的 id: 等。

但是，我无法正确读取文件。我试过`textscan`,`fscanf`和其他这样的命令等。

例如：

```
[sam,count]=fscanf(fid,'%d %*s %*s %*s %*s %*s',[5,inf]) 
```

返回`sam = [] (0x1) ???`和`count = 0`。我正在尝试阅读有关此的文档，但内容很少。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T10:21:19.977

这是一个使用 textscan 的工作示例。在 Matlab 中它正在工作。我没有用 Octave 测试它。

```
>> fid = fopen('test.txt')
>> A = textscan(fid,'%f 1:%f 2:%f 3:%f id:%f %*[^\n]')

A = 

  Columns 1 through 4

    [3x1 double]    [3x1 double]    [3x1 double]    [3x1 double]

  Column 5

    [3x1 double]

>> A{2}

ans =

    0.0075
    0.6037
    0.2150 
```

编辑：将其转换为矩阵：

```
cell2mat(A) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T00:10:37.327

Using `fopen` and `fgetl` you can read each line of the file into a MATLAB/OCTAVE cell array.

A quick example would be

```
fid=foepn('c:\path\to\file.txt') %# open the file for reading

%#Loop through the file reading one line at a time
i=0;
while ~feof(fid)
   i=i+1;
   cellContents{i,1}=fgetl(fid);
end 
```

Now each element of `cellContents` is the contents of a line in your file.

# c# - 当变量在指定时间范围内获得相同值时如何触发事件？

> ID：12611814
> 
> 赞同：0
> 
> 时间：2012-09-26T23:10:51.447
> 
> 标签：c#, multithreading, datetime

```
static void barreader_method()
{
   barreader.OpenPort(barport, 19200); //opens the port connected to the rfid reader
   byte TagType; //tag type
   byte[] TagSerial = new byte[4]; //tag serial in reverse order
   byte ReturnCode = 0; //return code sent from the rfid reader
   string bartagno; //tag no as a string

   while (true)
   {
      bartagno = "";
      while (!barreader.CMD_SelectTag(out TagType, out TagSerial, out ReturnCode)) /*wait until a tag is present in the rf field, if present return the tag number.*/
      {
      }
      for (int i = 0; i < 4; i++)
      {
         bartagno += TagSerial[i].ToString("X2");
      }
      barprocess(bartagno); //barprocess method
      Thread.Sleep(1200); //this is to prevent multiple reads
   }
} 
```

如果 bartagno 变量在一分钟内获得相同的值，我不想执行 barprocess 方法而是继续无限循环。否则会执行 barprocess 方法。我怎样才能做到这一点？我什至不知道从哪里开始。我尝试了不同的日期时间、循环组合但没有成功。

-------------------------------------------------- --------下面添加了进度---------------------------------------- --------

可以在一分钟内读取多张卡片，因此不幸的是，仅与前一张比较无济于事。我尝试使用数组列表而不是基于 Kelly Ethridge 的回答（谢谢）。但是，例如，如果我们每 10 秒读取一次读数，这将毫无用处。我们仍然必须删除超过 1 分钟的项目。

```
static void barreader_method()
{
    barreader.OpenPort(barport, 19200);
    byte TagType;
    byte[] TagSerial = new byte[4];
    byte ReturnCode = 0;
    string bartagno;
    ArrayList previoustagnos = new ArrayList();
    DateTime lastreaddt = DateTime.MinValue;

    while (true)
    {
        bartagno = "";
        while (!barreader.CMD_SelectTag(out TagType, out TagSerial, out ReturnCode))
        {
        }
        for (int i = 0; i < 4; i++)
        {
            bartagno += TagSerial[i].ToString("X2");
        }
        if (DateTime.Now - lastreaddt > TimeSpan.FromMinutes(1))
        {
            previoustagnos.Clear();
            barprocess(bartagno);
            previoustagnos.Add(bartagno);
            lastreaddt = DateTime.Now;
        }
        else
        {
            previoustagnos.Sort();
            if (previoustagnos.BinarySearch(bartagno) < 0)
            {
                barprocess(bartagno);
                previoustagnos.Add(bartagno);
                lastreaddt = DateTime.Now;
            }
        }
        Thread.Sleep(1200);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:41:27.537

您需要跟踪上次调用 barprocess 的时间以及之前的**bartango**是**什么**。

```
static void barreader_method()
{
   barreader.OpenPort(barport, 19200); //opens the port connected to the rfid reader
   byte TagType; //tag type
   byte[] TagSerial = new byte[4]; //tag serial in reverse order
   byte ReturnCode = 0; //return code sent from the rfid reader
   string bartagno; //tag no as a string
   string previousbartango;
   var lastTimeCalled = DateTime.MinValue;

   while (true)
   {
      bartagno = "";
      while (!barreader.CMD_SelectTag(out TagType, out TagSerial, out ReturnCode)) /*wait until a tag is present in the rf field, if present return the tag number.*/
      {
      }
      for (int i = 0; i < 4; i++)
      {
         bartagno += TagSerial[i].ToString("X2");
      }
      var spanSinceLastCalled = DateTime.Now - lastTimeCalled;
      if (spanSinceLastCalled > TimeSpan.FromMinutes(1) || bartango != previousbartango)
      {
          barprocess(bartagno); //barprocess method
          previousbartango = bartango;
          lastTimeCalled = DateTime.Now;
      }
      Thread.Sleep(1200); //this is to prevent multiple reads
   }
} 
```

这是空气代码，但我想你明白了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T23:46:29.970

这取决于您希望在一分钟内看到多少个标签。

想到一个丑陋的方法是创建一个新变量

```
List<Tuple<DateTime, String>> recentTags = new List<Tuple<DateTime, String>>() 
```

每次看到 bartagno 时，请搜索此列表以查看它是否已在此处。如果是，请跳过它。如果没有，请将其添加到列表中：

```
recentTags.Add(Tuple.Create(DateTime.Now, bartagno)); 
```

有时（可能通过主循环 5 到 10 次）您会希望从该列表中删除旧记录。

```
recentTags.RemoveAll(e => e.Item1.... 
```

（crud - 我不记得“e.Item1 过去超过 1 分钟”的语法）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T23:55:18.590

它不是像存储最后处理的值和日期时间那么简单吗？如果读取在时间限制内，那么在调用 barprocess() 方法之前测试是否相同？

... 字符串 lastBarTagNo = ""; 日期时间 lastTagProcessDateTime = DateTime.MinValue; ... while(true){ ... // 读取标签并构建新的 bartagno if(DateTime.Now - lastTagProcessDateTime < TimeSpan.FromMinutes(1)) && lastBarTagNo.Equals(bartagno){ barprocess(); } }

（抱歉格式化 - 在智能手机上执行此操作）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T20:10:24.260

```
static void barreader_method()
{
    barreader.OpenPort(barport, 19200);
    byte TagType;
    byte[] TagSerial = new byte[4];
    byte ReturnCode = 0;
    string bartagno;
    List<Tuple<DateTime, String>> previoustags = new List<Tuple<DateTime, String>>();
    DateTime lastreaddt = DateTime.MinValue;

    while (true)
    {
        bartagno = "";
        while (!barreader.CMD_SelectTag(out TagType, out TagSerial, out ReturnCode))
        {
        }
        for (int i = 0; i < 4; i++)
        {
            bartagno += TagSerial[i].ToString("X2");
        }
        if (DateTime.Now - lastreaddt > TimeSpan.FromMinutes(1))
        {
            previoustags.Clear();
            barprocess(bartagno);
            previoustags.Add(Tuple.Create(DateTime.Now, bartagno));
            lastreaddt = DateTime.Now;
        }
        else
        {
            if (!previoustags.Exists(a => a.Item2.Equals(bartagno)))
            {
                barprocess(bartagno);
                previoustags.Add(Tuple.Create(DateTime.Now, bartagno));
                lastreaddt = DateTime.Now;
            }
        }
        previoustags.RemoveAll(a => a.Item1.CompareTo(DateTime.Now - TimeSpan.FromMinutes(1)) < 0);
        Thread.Sleep(1200);
    }
} 
```

非常感谢丹和凯利。没有你的帮助，我无法解决这个问题。

# c# - 我需要知道如何获取组合框的选定项并使其出现在 Windows 窗体应用程序中？

> ID：12611816
> 
> 赞同：1
> 
> 时间：2012-09-26T23:11:01.513
> 
> 标签：c#

我有一个带有 ComboBox 的 Windows 窗体应用程序，并且框中有一些字符串。我需要知道当我选择一个字符串并按下我的创建按钮时，如何使该名称显示在我创建的面板中的另一个 Windows 窗体应用程序上。这是添加客户的代码

```
public partial class AddOrderForm : Form
{
    private SalesForm parent;

    public AddOrderForm(SalesForm s)
    {
        InitializeComponent();
        parent = s;

        Customer[] allCusts = parent.data.getAllCustomers();

        for (int i = 0; i < allCusts.Length; i++)
        {
            Text = allCusts[i].getName();
            newCustomerDropDown.Items.Add(Text);
            newCustomerDropDown.Text = Text;
            newCustomerDropDown.SelectedIndex = 0;
         } 
```

现在，当我单击创建订单按钮时​​，我希望将上面的信息标记在我的其他 Windows 窗体应用程序上。

```
 private void newOrderButton_Click(object sender, EventArgs e)
        {

            //get the info from the text boxes

            int Index = newCustomerDropDown.SelectedIndex;
            Customer newCustomer = parent.data.getCustomerAtIndex(Index);              

            //make a new order that holds that info
            Order brandSpankingNewOrder = new Order(newCustomer);
            //add the order to the data manager
            parent.data.addOrder(brandSpankingNewOrder);
            //tell daddy to reload his orders
            parent.loadOrders();
            //close myself
            this.Dispose();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T09:18:07.617

上下文对我来说不是很清楚，但是如果我做对了，您可以从 SalesForm 的实例打开 AddOrderForm 的实例，当您单击 newOrderButton 时，您想使用来自 AddOrderForm 的数据更新 SalesForm 上的某些内容。

如果是这种情况，有很多方法可以获得它，但也许需要对代码进行较少更改的方法就是这个（即使我不太喜欢它）。

制作您需要在 SalesForm 中修改的控件，`public`或者至少`internal`（查看控件属性的设计部分中的 Modifiers 属性）。这将允许您编写类似这样的内容（假设 customerTxt 是 SalesForm 中的 TextBox）：

```
parent.customerTxt.Text = newCustomerDropDown.SelectedItem.Text; 
```

# c - C- 传递和引用结构数组

> ID：12611819
> 
> 赞同：0
> 
> 时间：2012-09-26T23:11:22.613
> 
> 标签：c, pointers

我有一个 Point 结构的 C 代码：

```
typedef struct Point{
 int x, y;
} Point;

void one(Point P) {
 p.x = 1;
 p.y = 1;
} 
```

我想创建一个指向 50 个点的数组的指针，然后将这些数组成员中的一些传递给一个函数。

我试过了

```
struct Point (*mypointer)[50];
one(mypointer[i]); 
```

但是得到“预期的'Point'，但参数的类型是'struct Point'”然后我尝试推迟指针

```
one(&mypointer[i]) 
```

但是得到“预期的'Point'，但参数的类型是'struct Point (*)[(long unsigned int)N]”我该怎么办？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:15:05.487

那是因为函数的参数`one`不是对结构的引用，而只是真实的数据（在堆栈上分配）。

尝试使用：

```
void one(Point *p) {
 p->x = 1;
 p->y = 1;
} 
```

在任何情况下，声明为`struct Point *mypointer[50]`的数组都不是指向点的数组，而是指向点的指针数组（您必须一个一个地分配）。如果您希望只有一个数组指向您应该使用的点

```
Point points[50];
one(&points[i]) 
```

# restkit - 有人可以解释映射 Restkit 获取结果映射到数组中吗

> ID：12611826
> 
> 赞同：0
> 
> 时间：2012-09-26T23:11:58.360
> 
> 标签：restkit

我已经浏览了包括[https://github.com/RestKit/RestKit/wiki/Object-mapping](https://github.com/RestKit/RestKit/wiki/Object-mapping)在内的可用文档，但我无法找到将 GET 结果映射到的解释或示例

*   (void)objectLoader:(RKObjectLoader*)objectLoader didLoadObjects:(NSArray*)objects

(NSArray*)objects 到底是什么？

当我从服务器只返回一个 JSON 对象时，我能够将其映射为：

```
NSString *bodyResults;
bodyResults = [[objectLoader response] bodyAsString];

NSDictionary *resultsDictionary = [bodyResults objectFromJSONString];

NSString *subject = [resultsDictionary  objectForKey:@"subject"]; 
```

但是现在我要返回一个 JSON 列表（一组对象），我遇到了麻烦。

我在提交获取之前映射了对象：

//地图提供 RKObjectMapping* OfferingMapping = [RKObjectMapping mappingForClass:[Offering class]]; [offeringMapping mapKeyPath:@"categoryId" toAttribute:@"categoryId"]; [offeringMapping mapKeyPath:@"merchantId" toAttribute:@"merchantId"]; [offeringMapping mapKeyPath:@"name" toAttribute:@"name"]; [offeringMapping mapKeyPath:@"latitude" toAttribute:@"latitude"]; [offeringMapping mapKeyPath:@"longitude" toAttribute:@"longitude"];

```
[[RKObjectManager sharedManager].mappingProvider setMapping:offeringMapping forKeyPath:@"offering"];

double latitude = [(AppDelegate*)[[UIApplication sharedApplication] delegate] currentLatitude];
double longitude = [(AppDelegate*)[[UIApplication sharedApplication] delegate] currentLongitude];

NSString *latitudeString = [[NSNumber numberWithDouble:latitude] stringValue];
NSString *longitudeString = [[NSNumber numberWithDouble:longitude] stringValue];

NSDictionary *getParams = [NSDictionary dictionaryWithKeysAndObjects:
                            @"lat",latitudeString,
                            @"long",longitudeString,
                            nil];

[[RKObjectManager sharedManager] loadObjectsAtResourcePath:[@"/merchantofferings" stringByAppendingQueryParameters:getParams] delegate:self]; 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:24:02.890

在回答您的第一个问题时， (NSArray *)objects 是由 objectLoader 加载的对象的数组。因此，在您的情况下，它们应该是产品类型的对象，其中填充了您在对象映射中映射的属性。

您是否有从 GET 请求返回的 JSON 示例，可以在此处发布？您确定它是有效的 JSON 并且完全按照您的预期返回吗？

# zend-framework - 如何在 Zend 模型的选择查询中使用语言环境

> ID：12611828
> 
> 赞同：0
> 
> 时间：2012-09-26T23:12:26.900
> 
> 标签：zend-framework, locale

在我的管理员 cms 上，我可以添加 newsitems 并将“语言”列中的语言代码添加到 newsitem“en”或“nl”。在引导文件中，语言通过以下方式设置：

```
public function _initLanguage()
{
    $objSessionLanguage= new Zend_Session_Namespace('Zend_Lang'); 
    $objLocale = new Zend_Locale();
    $locale = new Zend_Locale();
    $language = $locale->getLanguage();
    $region = $locale->getRegion();
    Zend_Loader::loadClass('Zend_Controller_Request_Http');
    $request = new Zend_Controller_Request_Http();

    if($language=='nl' or $language=='en')
    {
        if($language=='nl')
        {
            $localFile = 'dutch.php';        
            $Locale = 'nl';
        }else
        {           {
                $localFile = 'english.php';      
                $Locale = 'en';

        }
        $objSessionLanguage->localFile=$localFile;
        $objSessionLanguage->Locale=$Locale;

    }else
    {
        if(!isset($objSessionLanguage->localFile))
        {
            $localFile = 'english.php';      
            $Locale = 'en';
        }else
        {
            $localFile = $objSessionLanguage->localFile;
            $Locale =$objSessionLanguage->Locale;
        }           
    }

    $objTranslate = new Zend_Translate('array', APPLICATION_PATH .'/../language/english.php', 'en');
    $objTranslate->addTranslation(APPLICATION_PATH .'/../language/'.$localFile, $Locale);
    $objTranslate->setLocale($Locale);
    Zend_Registry::set("Zend_Translate", $objTranslate);
} 
```

要在新闻列表中显示新闻站点，我想根据语言选择新闻模型中的新闻站点。

```
<?php

class Admin_Model_News extends  Zend_Db_Table_Abstract
{
    protected $_modelName = 'news';
    protected $_modelLabel = 'News';
    protected $_name = 'news';  
    protected $_objGeneralSettingVar;

public function init()
{
    parent::init(); 
    $this->_objGeneralSettingVar =  Zend_Registry::get( "objGeneralSettingVar");
}    
public function fetchNewsList()
{
    $objSelect = $this->select()->limit(5);
    $objSelect->where ("language = '$language'");
    $objSelect->order("news_date DESC");

    return $this->fetchAll($objSelect)->toArray(); 
}
} 
```

但是有了上面

```
$objSelect->where ("language = '$language'"); 
```

不显示任何新闻站点。我确定我错过了一些东西，但似乎找不到它。如何使用语言设置来选择关于语言的新闻站点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T10:32:02.980

在 Admin_Model_News 您正在使用

```
$objSelect->where ("language = '$language'"); 
```

对于您的 where 子句，但`$language`尚未在任何地方设置，因此您正在查询`Where language = null`.

函数 fetchNewsList 应该如下所示：-

```
public function fetchNewsList($language)
{
    $objSelect = $this->select()->limit(5);
    $objSelect->where ("language = '$language'");
    $objSelect->order("news_date DESC");

    return $this->fetchAll($objSelect)->toArray(); 
} 
```

您没有展示您如何使用 Admin_Model_News，但它应该是这样的：-

```
$news = new Admin_Model_News();
$newList = $news->fetchNewsList(howeverYouGetlanguage()); 
```

# ajax - 渲染ajax导致不同的视图Rails 3

> ID：12611830
> 
> 赞同：0
> 
> 时间：2012-09-26T23:12:42.750
> 
> 标签：ajax, ruby-on-rails-3

鉴于我有**路线**。

```
 root :to => 'pessoas#index'
  post '/pessoas'  => 'pessoas#create' 
```

而我的视图 app/view/pessoas/ **index.haml**有以下视图代码。（在这里提交将发布到 pessoas#create）

```
= form_tag "/pessoas", :method => :post, :remote => true, :id => "participe" do
  ...
  = button_tag "Sign up", :class => "envia" 
```

我的**create.js.erb**视图是。

```
$('#user-feedback').html('<%= @message %>'); 
```

控制器代码只是保存模型。

```
 def create
    @pessoa = Pessoa.new(params[:cliente])
    if @pessoa.save
      @message = "Success"
    else
      @message = "Failure"
    end
    respond_to do |format|
      format.js
    end
  end 
```

然后我转到根路径/然后填写表格并单击提交。然后元素 p#user-feedback 没有改变。为什么？

我在应用程序的日志中注意到：请求已正确完成，jquery 也已完成，但它呈现在 /pessoas 响应而不是当前视图（索引）。

我能做些什么？还是我应该忘记这一点并使用 $.ajax 方式制作它？我想要一种向用户提供反馈的方法。

# iphone - 非 UIView 动画：动画有时不播放，UIView 动画：工作正常

> ID：12611841
> 
> 赞同：3
> 
> 时间：2012-09-26T23:13:48.977
> 
> 标签：iphone, ios, uiviewanimation

有时当我在设备上运行我的应用程序时，我猜大概有 20% 的时间是动画，例如：

```
[tableView setEditing:NO animated:YES];
[tableView setContentOffset:rect animated:YES]; 
```

和

```
[viewController0 pushViewController:viewController1 animated:YES]; 
```

不要动画，但会立即改变。但动画如：

```
[UIView animateWithDuration:0.2
                     animations:^{
                         // do something
                     }
                     completion:^(BOOL finished) {
                         // do something else
                     }]; 
```

工作正常。这发生在其他人身上吗？不知道是什么原因造成的，它只发生在这个应用程序上，从来没有发生在任何其他应用程序上，而且它有时会发生。任何帮助表示赞赏。

**编辑：**

只是想澄清一下。

我用“animateWithDuration”创建的动画效果很好。

*有时*，来自可可的动画不会在应用程序运行的整个过程中播放。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T23:01:18.123

在推送视图控制器之前尝试设置 UIView 动画参数。

这是一个例子：

```
[UIView beginAnimation:nil context:nil];
[UIView setAnimationDuration:0.5];
[UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];

[UIView setAnimationTransition:UIViewAnimationTransitionFlipFromRight forView:viewController1.view cache:NO];

[viewController0 pushViewController:viewController1 animated:YES];
[UIView commitAnimations]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T22:21:01.880

也许是因为你使用了布尔值。我的动画是完全一样的，但它工作正常：

```
[UIView animateWithDuration:4.0 animations:^(void) {
        [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
        pfeil.alpha = 1.00;
         }]; 
```

那是我的代码...有任何问题吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T01:38:41.933

也许你有很多数据要加载到你的 VC 中？如果您在主线程中加载数据，它会在一段时间内停止所有用户交互和 UI 响应。

# actionscript-3 - 在类之间传递变量

> ID：12611844
> 
> 赞同：1
> 
> 时间：2012-09-26T23:14:00.410
> 
> 标签：actionscript-3, flash, apache-flex, oop, variables

我正在尝试将我的 Flash 文件的 DocumentClass 中的变量“预算”传递给一个类。

目前我有：

（DocumentClassv5，这是附加到属性面板中的闪存文件的代码，省略了一些代码）

```
package  
{

import flash.display.MovieClip;
import flash.utils.Timer;
import flash.events.TimerEvent;
import flash.events.*;
import flash.ui.Keyboard;
import flash.display.Stage;
import flash.text.TextFieldType;
import flash.media.Sound;
import flash.media.SoundChannel;    
import miniGameOne;
import floorTileMC;

import flash.display.Loader;
import flash.net.URLRequest;

public class DocumentClassv5 extends MovieClip 
{
    /*#################################
    ## Defining Variables            ##
    #################################*/

    public var budget:int = 0;

    var gameOne:miniGameOne = new miniGameOne();
        /*#################################
    ## Constructor                   ##
    #################################*/     
    public function DocumentClassv5() 
    {
        /*#################################
        ## Adding Event Listeners        ##
        #################################*/

        trace("Document class loaded");
    }
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    /*###################################################
    ## Begins the mini game                            ##
    ###################################################*/           
    public function begin(evt: MouseEvent)
    {
        beginGame.visible = false;
        beginGame.removeEventListener(MouseEvent.CLICK, begin);
        budget = 500;

        cleanListeners();
        gameOne.loadGame();
        trace(gameOne.testVar);
        trace(floorTile.testVar2);

        /*#################################
        ## Adding Event Listeners        ##
        #################################*/         

        trace("Game started");
    }

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// 
} 
```

然后我有 miniGameOne 类文件，目前什么都不做

我还有另一个类文件，称为 tileFloorMC。这是附加到一个符号。

```
package  
{

import flash.display.MovieClip;
import flash.events.MouseEvent;
import DocumentClassv5;

public class floorTileMC extends MovieClip 
{
    var propertyA:Number;
    //var hackerClass:DocumentClassv5 = new DocumentClassv5;
            public var testVar2:int = 50;

    public function floorTileMC() 
    {
        this.propertyA = randomRange(100, 500);

        this.addEventListener(MouseEvent.ROLL_OVER, manageMouseOver, false, 0, true);
        this.addEventListener(MouseEvent.ROLL_OUT, manageMouseOut, false, 0, true);
    }
    private function manageMouseOver(evt: MouseEvent)
    {
        this.gotoAndStop(2);
        //trace(mainClass.budget);
    }
    private function manageMouseOut(evt: MouseEvent)
    {
        this.gotoAndStop(1);
        //mainClass.budget += 1;
    }
    private function randomRange(minNum:Number, maxNum:Number):Number   
    {  
        return (Math.floor(Math.random() * (maxNum - minNum + 1)) + minNum);  
    }       

}

} 
```

现在，基本上我需要能够将预算从 DocumentClassv5 传递到 floorTileMC，然后返回到 DocumentClassv5。目前，我可以将任何东西从 floorTileMC 和任何东西从 miniGameOne 传递到 DocumentClassv5，但是当我尝试从 floorTileMC 传递到 DocumentClassv5 时，我收到错误错误 #2136：SWF 文件文件：///yadayada/GameV5.swf 包含无效数据。

更具体地说，只要我取消注释 //var hackerClass:DocumentClassv5 = new DocumentClassv5;

任何帮助将不胜感激！

谢谢，

蒂芙尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:25:08.267

您正在尝试在子类中实例化您的文档类：

```
var hackerClass:DocumentClassv5 = new DocumentClassv5(); 
```

您希望访问现有实例，而不是创建新实例。

您可以做的一件事是创建对文档类的静态引用。（见下面的代码示例）

静态引用可能会变得丑陋，您可能只想在实例化它们时将 doc 类的引用传递给其他类。

以下两种方法：

在您的文档类中：

```
//instead of the line below:
var gameOne:miniGameOne = new miniGameOne(); //It's a bad idea to instantiate non primitive objects before the constructor of your document class runs.

//just declare it, and instantiate it in the constructor
var gameOne:miniGameOne;

//if you want to use a static reference:
public static var me:DocumentClassv5;

public function DocumentClassv5() 
{
    /*#################################
    ## Adding Event Listeners        ##
    #################################*/

    //if using the static var me, set it's value to this (the instance of the document class):
    me = this;

    trace("Document class loaded");
    gameOne = new miniGameOne(this); //pass a reference to the document class if NOT using the static var me

} 
```

如果使用静态变量 me，您可以通过从任何类执行以下操作来访问它：

```
DocumentClassV5.me.budget; 
```

另一个更简洁的选择（如果您需要访问的值并不真正直接与任何类相关联，例如全局首选项），是创建一个全新的静态类（不会被实例化）来保存您的偏好。

```
package {
    public class Global {

        public static var budget:Number = 50;

    }
} 
```

然后，您可以通过导入您的 Global 课程并执行`Global.budget = 5`

# c++ - Boost 不是静态链接到 boost::python 共享对象

> ID：12611845
> 
> 赞同：3
> 
> 时间：2012-09-26T23:14:04.033
> 
> 标签：c++, python, boost, static-linking

我使用 boost::python 为我的应用程序创建了一个包装器。

到目前为止，这已经通过：（静态库/源代码的数量）-> python_mapping.so

这样，我的共享对象由许多静态库组成，包括 boost 本身（特别是 boost_thread）。我会假设这将包含我所有的应用程序信息，因为我已经静态链接了所有内容。

这编译得很好。

```
ldd python_mapping.so
        librt.so.1 => /lib64/librt.so.1 (0x00002b7cbad37000)
        libstdc++.so.6 => /usr/lib64/libstdc++.so.6 (0x00002b7cbaf40000)
        libm.so.6 => /lib64/libm.so.6 (0x00002b7cbb240000)
        libgcc_s.so.1 => /lib64/libgcc_s.so.1 (0x00002b7cbb4c4000)
        libpthread.so.0 => /lib64/libpthread.so.0 (0x00002b7cbb6d2000)
        libc.so.6 => /lib64/libc.so.6 (0x00002b7cbb8ed000)
        /lib64/ld-linux-x86-64.so.2 (0x000000327ee00000) 
```

但是，当我运行我的示例 python 应用程序时，我得到这个运行时链接错误：未定义的符号：_ZTIN5boost6detail16thread_data_baseE

似乎那些链接到静态库的 boost 库实际上并不存在？

我在这方面取得了一些进展。显然，我的共享对象没有包含很多编译器认为没有被使用的符号（因为它从未见过我的 c++ 对象被创建，因为它们是通过实例化 Python 对象创建的）。

有一些像：

```
//This is a class only created in python
#include "CPlusPlusClass.h"

PythonClass
{
       public:
           PythonClass() { }
       private:
           CPlusPlusClass _cplusplus;
};

//PythonMappings for PythonClass

#python file
import python_mapping

pythonClass = python_mapping.PythonClass() #This fails saying it can't find the symbol for CPlusPlusClass 
```

编译器将优化掉 CPlusCPlus 类，因为它从未看到它实际被使用，这完全令人讨厌。它似乎确实保留了 PythonClass 本身（可能是因为 Python Boost 映射宏。

您可以通过以下几种方式解决此问题：

1.  将所有库链接到：`-Xlinker --whole-archive`
2.  在共享对象中创建库的虚拟使用

我想知道是否有人能想到另一种解决方案，因为浏览所有可能的库并将它们添加到 --whole-archive 真的很烦人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:33:22.073

好的，由于没有人回应，我发现最简单（也是我知道的唯一解决方案）是包含你拥有的每个静态库：

```
-Xlinker --whole-archive 
```

当然，您可以动态链接您的库，这将要求您在执行 python 应用程序时设置 LD_LIBRARY_PATH（尽管对于许多库来说这不是我的选项）。

因此，从这个意义上说，*显式*动态链接可能被认为是一种更优雅的解决方案。

除此之外，如果您的库使用其他库：

python_mapping.so -> 在实用程序1.a 中静态链接 -> 在实用程序2.a 中静态链接

如果您忘记在运行 python 应用程序的实用程序1.a 中进行链接，它将让您知道它找不到符号，但是，它不会抱怨实用程序2.a，并且当它到达该部分时会出现奇怪的行为图书馆。所以...要小心，并确保您已明确链接到所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-21T16:07:57.133

您可以使用链接器参数 -rpath 嵌入库搜索路径，包括可执行文件中的“当前目录” (g++ -Wl,-rpath,.)，以便您可以准确指定从何处加载共享库。如果您将应用程序移动到 .so 文件未知的其他机器上，这将很有帮助。您还必须移动您明确指定的 .so 文件。这是静态链接和完全动态链接之间的折衷，因为您实际上不会与盒子上的其他应用程序“共享” .so 文件（您将自己的副本带过来），这是使用共享库的节省内存的好处之一.

这篇文章主要是为了宣传很少使用但非常有用的 -rpath 参数。

# iphone - FBRequest requestForMe startWithCompletionHandler 方法在设备上不起作用

> ID：12611847
> 
> 赞同：2
> 
> 时间：2012-09-26T23:14:20.303
> 
> 标签：iphone, ios, facebook, ios6, simulator

我遵循了 Facebook 开发者网站上关于将 Facebook SDK 3.1 集成到 iOS 6 中的所有指示。我的代码在 iPhone 6.0 模拟器上完美运行（用户可以登录 Facebook），但是当我在 iPhone 上运行应用程序时，函数 [ FBRequest requestForMe] startWithCompletionHandler] 不生成响应。根据 Facebook 开发者网站，它要么成功要么返回错误，但两者都没有。该应用程序只是坐在那里等待永远不会出现的响应。我的代码如下：

```
- (void)populateUserDetails {
    if (FBSession.activeSession.isOpen) {
        [[FBRequest requestForMe] startWithCompletionHandler:
         ^(FBRequestConnection *connection, NSDictionary<FBGraphUser> *user, NSError *error) {
             if (!error) {
                NSLog(@"logged in");
             } else {
                 NSLog(@"error: %@", error);
             }
         }];
    } else {
       NSLog(@"no active session");
    }
} 
```

使用断点，我确定 activeSession 始终处于打开状态，因此实际调用了 startWithCompletionHandler: 方法。也许这是一个构建问题，因为它在模拟器上运行良好？有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-24T11:31:56.180

> 确保没有为您的 App Store ID 自动插入“0”值

App Store ID 与 Bundle ID 不同。就像 Facebook 上所说的：“出于安全原因，我们在授权您的应用程序之前检查捆绑 ID”。因此，您应该将其设置为与您在 Xcode 中所做的完全相同。

但是 App Store ID（“我们可以在 Facebook 上链接到的 iPhone App Store ID”）是您在提交应用程序并被接受时设置的。因此，出于开发目的，您应该将 iPhone 和 iPad（如果有）设置为 0，我所做的，它在 Simulator 和 iPhone iOS 6.0 上都可以正常工作。

不是因为那个0，也许你修复了别的东西？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T00:47:08.823

回答了我自己的问题：转到您的 Facebook 应用页面并确保没有为您的 App Store ID 自动插入“0”值。我已经将我的捆绑包 ID 设置为正确的值（您也必须这样做），但一夜之间，Facebook 自动将 App Store ID 值设置为 0。我删除该值后一切正常。

# c# - IE驱动处理后，IEDriverServer.exe进程仍然挂起

> ID：12611850
> 
> 赞同：2
> 
> 时间：2012-09-26T23:14:35.873
> 
> 标签：c#, selenium, internet-explorer-8, webdriver

我正在使用 Selenium 的 IE 驱动程序进行 Web 测试。启动 IE8 并关闭它后，该`IEDriverServer.exe`过程不会消失。如果我再次运行测试，则会创建一个新进程并一直挂起。我的测试代码或 Selenium 设置有什么问题？

```
using (var driver = new InternetExplorerDriver(
    new InternetExplorerOptions() { 
        IntroduceInstabilityByIgnoringProtectedModeSettings = true }))
{
    Assert.IsTrue(true);
    driver.Close();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T23:54:18.293

您正在运行哪个版本的 Selenium WebDriver .NET 绑定？.NET InternetExplorerDriver 类`.Dispose()`在 2.25 或更早版本中的方法的语义不等同于调用该`.Quit()`方法。这意味着要正确关闭 .NET 绑定 2.25 或更早版本中的 IEDriverServer.exe 进程，您必须显式调用该`.Quit()`方法。应该注意的是，对于尚未发布的 .NET 绑定的 2.26 版本，这已经改变，并且调用`.Dispose()`将等同于调用，无论是通过构造`.Quit()`显式调用还是隐式调用。`using`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-06T17:48:43.740

简化： .Quit() --> 关闭驱动程序和浏览器 .Close() --> 关闭浏览器 .Dispose()-> 不知道

# ruby-on-rails - 提取Ruby中两个字符之间的子链接

> ID：12611851
> 
> 赞同：2
> 
> 时间：2012-09-26T23:14:40.473
> 
> 标签：ruby-on-rails, ruby

如何提取字符串中两个字符之间的子链接？

例如，我想在 youtube URL 中提取视频 ID：

```
http://www.youtube.com/watch?v=UkzbRkPv4T4&feature=g-all-u 
```

我想要“ `=`”和第一个“ `&`”符号之间的文本，即“ `UkzbRkPv4T4`”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T23:31:51.153

如果您不想处理正则表达式，则可以依赖 Ruby 标准库中的功能来解析 URL：

```
url = "http://www.youtube.com/watch?v=UkzbRkPv4T4&feature=g-all-u"
video_id = CGI.parse(URI.parse(url).query)['v'][0] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:23:07.010

你只需要一个正则表达式：

```
uri = 'http://www.youtube.com/watch?v=UkzbRkPv4T4&feature=g-all-u'
m = uri.match /v=(?<id>\w+)&/
if m
  puts m[:id]
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T23:23:50.323

只是为了扩展 apneadiving 的评论。

```
>> url = "http://www.youtube.com/watch?v=UkzbRkPv4T4&feature=g-all-u"
=> "http://www.youtube.com/watch?v=UkzbRkPv4T4&feature=g-all-u"
>> md = url.match(/v=(.*)&/)
=> #<MatchData "v=UkzbRkPv4T4&" 1:"UkzbRkPv4T4">
>> md[1]
=> "UkzbRkPv4T4" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-10T11:34:56.410

```
require 'uri'

uri = URI("http://www.youtube.com/watch?v=UkzbRkPv4T4&feature=g-all-u")
uri.query
# => "v=UkzbRkPv4T4&feature=g-all-u"
URI.decode_www_form(uri.query)
# => [["v", "UkzbRkPv4T4"], ["feature", "g-all-u"]]
URI.decode_www_form(uri.query).map(&:last)
# => ["UkzbRkPv4T4", "g-all-u"]
URI.decode_www_form(uri.query).assoc("v").last
# => "UkzbRkPv4T4" 
```

# javascript - 为什么在有同步 FileSystem 支持的情况下，Web Workers 中没有同步 WebSocket 支持？

> ID：12611853
> 
> 赞同：22
> 
> 时间：2012-09-26T23:14:48.957
> 
> 标签：javascript, asynchronous, w3c, policy, web-standards

我理解为什么浏览器供应商不想帮助我阻止他们的 UI 线程。但是，我不明白为什么会有：

1.  Web Worker 中的 no sleep(2)
2.  没有同步的 WebSockets API

有一个[同步的 FileSystem API](http://www.html5rocks.com/en/tutorials/file/filesystem-sync/)。还有一个[同步 IndexedDB API](https://developer.mozilla.org/en-US/docs/IndexedDB/Syncronous_API)。在我看来，这似乎是一个矛盾。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-05T17:41:38.083

WebWorkers没有可用功能的原因`sleep()`很简单：您不需要它。 `sleep`是一个同步函数，（它在返回之前一直阻塞）在 WebWorkers 的异步上下文中没有意义。

如果您向 WebWorker 发送消息，它不会阻塞等待响应；响应作为消息发送到您的消息处理函数。如果您想在发送响应之前等待一段时间，您不会使用`sleep`，您会在调用函数时使用`setTimeout`并触发消息。

同样，如果您使用 WebWorkers 进行 WebSocket 数据传输，您将从主线程接收消息，通过 websocket 异步发送数据包，然后在响应处理程序中将消息发送回主线程。`sleep`使用同步函数没有合乎逻辑的地方。

至于为什么 WebSockets 没有像文件系统那样的同步模式，主要区别在于文件系统不是通过网络访问的。一般来说，对于基于网络的函数来说，异步 API 更可取，所以我想我不认为它有太大的矛盾。

IDB[只支持 3 个浏览器，它们都没有实现同步 API](https://developer.mozilla.org/en-US/docs/IndexedDB#Browser_compatibility)，所以我不认为这是同步 API 的一个光辉例子。事实上，我认为这就是人们会定义 API 而不会费心去实现它的矛盾。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-25T13:28:29.673

一点都不明显：TCP协议也是一种网络协议，对吧？它经常在同步模式下使用，因为它使应用程序更易于开发和调试。

在我看来，异步模式在单线程应用程序的上下文中很明显，当您不希望 I/O 阻塞 UI 时。例如，如果您打算使用 Web Worker 来处理后台 I/O，那就不太明显了。将同步 Websocket 与 Web Worker 结合起来确实很方便。

最后，假设文件读取调用将很快完成是不明智的。如果 IO 没有响应，您应该总是有一个超时或接受您的应用程序将挂起的事实。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-10-06T00:19:15.837

对我来说，这是很明显的。

**FileSystem API 和 IndexedDB API 以毫秒为单位工作，**因此您现在可以放心拥有您的数据，相反，**WebSockets API 必须至少慢 100 倍，**数据必须在狂野的互联网上传输，因此很明显使其异步。你的回应甚至永远不会回来。

![在此处输入图像描述](../Images/e2991e332927f1f78713d91b18d3026e.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-05T07:33:16.040

索引数据库不会长时间阻塞执行，很可能它会在几毫秒内给出结果，我们不希望在索引数据库中存储数百万条记录。与文件 API 相同，大多数 API 将导致更快的执行。

同步 API 也会导致竞争条件，并且需要多线程同步等，这会增加编程复杂性。相反，基于消息的线程更容易编程，并且我们没有同步问题。

此外，大多数 javascript 引擎都是稳定的，人们熟悉异步编程方式。编写工人更容易也是唯一的方法。改变这一点需要大量重写 javascript 引擎。引入更多的原生 API 将使工作者编程更加复杂。不同的操作系统和不同的架构或设备 wiki 引入了更多的复杂性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-28T17:23:41.673

由于[V8 已经实现了 ES2017 await/async](https://v8project.blogspot.de/2016/10/v8-release-55.html)，我可以将它与支持 Promise 的库一起使用，并且我不再需要如此糟糕的同步 API。

# delphi - Delphi：缺少运算符或分号

> ID：12611855
> 
> 赞同：2
> 
> 时间：2012-09-26T23:14:57.713
> 
> 标签：delphi, operator-keyword

我正在使用 Indy 10(TIdTcpServer) 并收到以下错误：

```
[DCC Error] MainForm.pas(88): E2066 Missing operator or semicolon 
```

尝试运行此代码时：

```
procedure TForm1.SendMessage(Data: String; Client: Integer);
var
  List: TList;
  AContext: TIdContext;
begin
  List := idTcpServer1.Contexts.LockList;
  AContext(List[0]).Connection.IOHandler.WriteLn(Data);  // Line 88
end; 
```

我无法弄清楚我错过了什么；有什么帮助吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-26T23:32:55.477

虽然我无法解释您遇到的错误，但您的代码完全错误。

将其更改为：

```
procedure TForm1.SendMessage(Data: String; Client: Integer);
var
  List: TList;
  AContext: TIdContext;
begin
  List := idTcpServer1.Contexts.LockList;
  AContext := TIdContext(List[0]);
  AContext.Connection.IOHandler.WriteLn(Data);
end; 
```

您对非类型类型转换的错误使用可能会使编译器感到困惑。如果这不能解决问题，请编辑您的问题以围绕您发布的内容添加更多代码（您发布的内容之前的十几行会有所帮助）。

# c# - 在 Web 参考 .net 3.5 中更新服务参考

> ID：12611858
> 
> 赞同：0
> 
> 时间：2012-09-26T23:15:12.047
> 
> 标签：c#, .net, wcf, web-services, asmx

我们是一个旧版 3.5 Web 应用程序，它在其 Web 参考中引用了 WCF 服务。Web 参考是否用于使用旧的 .asmx 服务，而服务参考是否用于 .svc (WCF) 对吗？

现在 WCF 服务端点发生了变化，我将如何在 VS 2010 中更新它。

我们的构建目标仅限于 .net 3.5

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:40:08.570

如果端点发生了变化，即服务合同保持不变，那么您应该能够在 app.config 文件中更新端点。无需重新编译。

# c# - SslStream.WriteAsync“当另一个写入操作挂起时，无法调用 BeginWrite 方法”

> ID：12611861
> 
> 赞同：5
> 
> 时间：2012-09-26T23:15:27.073
> 
> 标签：c#, sslstream

将数据异步写入客户端时如何防止此问题

```
The BeginWrite method cannot be called when another write operation is pending 
```

我的密码

```
public async void Send(byte[] buffer)
{
    if (buffer == null)
        return;
    await SslStream.WriteAsync(buffer, 0, buffer.Length);
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-29T01:19:57.977

准确理解 await 关键字的作用很重要：

> await 表达式不会阻塞它正在执行的线程。相反，它会导致编译器注册 async 方法的其余部分作为等待任务的延续。然后控制权返回给异步方法的调用者。当任务完成时，它调用它的继续，并且异步方法的执行从它停止的地方继续（[MSDN - await（C# 参考）](http://msdn.microsoft.com/en-us/library/hh156528.aspx)）。

当您使用一些非空缓冲区调用 Send 时，您将到达

```
 await SslStream.WriteAsync(buffer, 0, buffer.Length); 
```

使用 await 您只能在 Send 方法中阻止执行，但即使 WriteAsync 尚未完成，调用者中的代码也会继续执行。现在，如果在 WriteAsync 完成之前再次调用 Send 方法，您将收到您发布的异常，因为 SslStream 不允许多个写入操作，并且您发布的代码不会阻止这种情况的发生。

如果要确保之前的 BeginWrite 已经完成，您必须更改 Send 方法以返回 Task

```
 async Task Send(SslStream sslStream, byte[] buffer)
    {
        if (buffer == null)
            return;

        await sslStream.WriteAsync(buffer, 0, buffer.Length);
    } 
```

并通过使用 await 调用它来等待它的完成，例如：

```
 await Send(sslStream, message); 
```

如果您不尝试从多个线程写入数据，这应该可以工作。

这里还有一些代码可以防止来自多个线程的写操作重叠（如果与您的代码正确集成）。它使用中间队列和异步编程模型（APM）并且运行速度非常快。您需要调用 EnqueueDataForWrite 来发送数据。

```
 ConcurrentQueue<byte[]> writePendingData = new ConcurrentQueue<byte[]>();
    bool sendingData = false;

    void EnqueueDataForWrite(SslStream sslStream, byte[] buffer)
    {
        if (buffer == null)
            return;

        writePendingData.Enqueue(buffer);

        lock (writePendingData)
        {
            if (sendingData)
            {
                return;
            }
            else
            {
                sendingData = true;
            }
        }

        Write(sslStream);            
    }

    void Write(SslStream sslStream)
    {
        byte[] buffer = null;
        try
        {
            if (writePendingData.Count > 0 && writePendingData.TryDequeue(out buffer))
            {
                sslStream.BeginWrite(buffer, 0, buffer.Length, WriteCallback, sslStream);
            }
            else
            {
                lock (writePendingData)
                {
                    sendingData = false;
                }
            }
        }
        catch (Exception ex)
        {
            // handle exception then
            lock (writePendingData)
            {
                sendingData = false;
            }
        }            
    }

    void WriteCallback(IAsyncResult ar)
    {
        SslStream sslStream = (SslStream)ar.AsyncState;
        try
        {
            sslStream.EndWrite(ar);
        }
        catch (Exception ex)
        {
            // handle exception                
        }

        Write(sslStream);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T23:18:17.107

如果操作是使用 BeginWrite 启动的，请调用[SslStream.EndWrite](http://msdn.microsoft.com/en-us/library/system.net.security.sslstream.endwrite.aspx)以结束旧的写入操作，然后再开始下一个操作。如果操作是使用[WriteAsync](http://msdn.microsoft.com/en-us/library/hh158629.aspx)启动的，请确保任务首先完成，例如使用`await`关键字或[Wait()](http://msdn.microsoft.com/en-us/library/dd235635.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-13T23:33:10.917

其他答案很好，但我认为更简洁的解释（这是我在搜索相同的错误消息时正在寻找的）是这样的：

该方法不是线程安全的，而是以非线程安全的方式调用的，因为您没有使用`await`您的`Send`方法。

# css - 元素无缘无故地躺在另一个“顶部”？

> ID：12611863
> 
> 赞同：0
> 
> 时间：2012-09-26T23:15:48.227
> 
> 标签：css, element

我只是想为客户整理一个网页，我在页面底部有一个照片库，但它似乎位于页面其余内容的顶部，尽管它自己的内容出现在其余部分下方. 最简单的方法是在这里亲自[查看。](http://www.bekonscot.co.uk/tv/talktalk/)*请注意您无法播放 YouTube 视频，如果您使用“检查元素”，您会明白我所说的“躺在上面”的意思 *

我已经花了至少一个半小时试图解决这个问题，这是漫长的一天！我可能只是累了，但我将不胜感激地收到一些友好的建议。如果可以的话，我想尽量避免使用 z-index ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:29:25.637

你需要清除你`float`的。

例如，通过添加`clear: both;`到图库：

```
.gallery {
    clear: both;
} 
```

# c# - c# : 将新的用户设置动态添加到 Settings.Default.Properties 集合，并在表单关闭后保存它们。

> ID：12611864
> 
> 赞同：4
> 
> 时间：2012-09-26T23:15:49.257
> 
> 标签：c#, properties, settings, save

我是使用 Visual C# 2010 的新手程序员。我正在尝试动态（在运行时）创建一个新的 SettingsProperty 并将其添加到我的应用程序中的 Settings.Default.Properties 集合中（新设置）。这些属性本质上是用户定义的视图（存储在字符串中），我想保存它们以供以后重新加载。我已经尝试使用下面的代码，但它似乎没有工作。当我关闭应用程序时，新创建和保存的属性消失了。

```
 private void button6_Click(object sender, EventArgs e)
    {
        string connectionText = maskedTextBox3.Text;
        string vusipsText = maskedTextBox2.Text;
        string chartText = maskedTextBox1.Text;

        string[] settingsArray = { connectionText, chartText, vusipsText };
        string saveSettings = String.Join(":", settingsArray);

        //configure new property
        SettingsProperty property = new SettingsProperty("kri");
        property.DefaultValue = saveSettings;
        property.IsReadOnly = false;
        property.PropertyType = typeof(string);

        property.Provider = Settings.Default.Providers["LocalFileSettingsProvider"];
        property.Attributes.Add(typeof(System.Configuration.UserScopedSettingAttribute), new System.Configuration.UserScopedSettingAttribute());

        Settings.Default.Properties.Add(property);

        //Properties.Settings.Default.Reload();

        Settings.Default.Save();
        ActiveForm.Close();
    } 
```

我该如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:12:26.460

您的代码看起来不错，但下次加载数据时设置不知道您的属性。如果您再次定义您的属性（在加载时），该值应该可用。这是我用来保存枚举的循环中的工作示例：

```
 If My.Settings.Properties(settingName) Is Nothing Then
        Dim p = New Configuration.SettingsProperty(settingName)
        p.Provider = My.Settings.Providers("LocalFileSettingsProvider")
        p.Attributes.Add(GetType(Configuration.UserScopedSettingAttribute), _
                                    New Configuration.UserScopedSettingAttribute())
        p.PropertyType = GetType(SampleEnum)
        My.Settings.Properties.Add(p)
        If My.Settings(settingName) Is Nothing Then
           My.Settings(settingName) = SampleEnum.DefaultValue
        End If
     End If 
```

始终在启动时运行代码以创建属性，并在第一次创建值时也是如此。

# ruby - RoR：如何只搜索具有特定属性的微博？

> ID：12611866
> 
> 赞同：0
> 
> 时间：2012-09-26T23:15:54.533
> 
> 标签：ruby, ruby-on-rails-3

现在在 app/views/microposts/home.html.erb 我有..

```
<% form_tag purchases_path, :method => 'get', :id => "products_search" do %>
  <p>
    <%= text_field_tag :search, params[:search] %>
    <%= submit_tag "Search", :name => nil %>
  </p>
<% end %>

<% form_tag sales_path, :method => 'get', :id => "sales_search" do %>
      <p>
        <%= text_field_tag :search, params[:search] %>
        <%= submit_tag "Search", :name => nil %>
      </p>
    <% end %> 
```

然后在 micropost.rb 我有

```
scope :purchases, where(:kind => "purchase")
  scope :sales, where(:kind => "sale")

 def self.search(search)
    if search
      where('name LIKE ?', "%#{search}%")
    else
      scoped
    end
  end 
```

然后最后在 microposts_controller.rb 我有

```
def home

    @microposts=Micropost.all
    @purchases=@microposts.purchases
    @sales=@microposts.sales

  end 
```

现在我收到一个错误，说未定义的局部变量或方法“purchases_path”，它对 sales_path 也是如此。

我想要做的是只搜索一些微博而不是所有微博。在我的微博表中，我有一个名为 kind 的列，可以是“购买”或“销售”。我如何更改这三段代码，以便一次搜索搜索并仅显示那些“购买”类型的微博的结果。然后另一个搜索并仅显示那些带有“销售”类型的微博的结果

这个问题（在另一篇文章中）在[RoR 获得了 50 名代表的赏金：如何仅搜索具有特定属性的微博？](https://stackoverflow.com/questions/12575140/ror-how-can-i-search-only-microposts-with-a-specific-attribute)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:26:28.597

你可以试试这个。

您的型号：

```
class Micropost
  # ...
  scope :purchase_only, where(:kind => "purchase")
  # ...
  def self.search(search)
    if search
      self.purchase_only.find(:all, :conditions => ['name LIKE ?', "%#{search}%"])
    else
      self.purchase_only
    end
  end
end 
```

但是，这东西在我看来很奇怪。

例如：你应该删除`.find(...)`，这个查找器将在 Rails 4 中被弃用。

# javascript - javascript：仅在不为 false 时返回

> ID：12611871
> 
> 赞同：0
> 
> 时间：2012-09-26T23:16:30.457
> 
> 标签：javascript, object

场景：我正在寻找深层对象中的特定对象。我正在使用一个遍历孩子的递归函数，并询问他们是在寻找他们还是在寻找他们的孩子或孙子等等。找到时，将返回找到的 obj，否则返回 false。基本上是这样的：

```
obj.find = function (match_id) {
    if (this.id == match_id) return this;
    for (var i = 0; i < this.length; i++) {
        var result = this[i].find(match_id);
        if (result !== false) return result;
    };
    return false;
}​ 
```

我想知道，还有比这更简单的吗？：

```
var result = this[i].find(match_id);
if (result) return result; 
```

将结果存储在变量中（在每个级别上！）让我很恼火，我只想检查它是否为假并返回结果。我还考虑了以下内容，但出于明显的原因，我更不喜欢它。

```
if (this[i].find(match_id)) return this[i].find(match_id); 
```

顺便说一句，我也想知道，这种方法甚至是“递归”的吗？它并没有真正称自己为...

非常感谢你。

[编辑]

`check_find`在 if 语句中使用另一个函数（仅在找到时才返回 true）还有另一种可能性。在一些非常复杂的情况下（例如，您不仅要找到对象，还要更改它），这可能是最好的方法。还是我错了？丁：

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T04:20:09.827

尽管就搜索算法而言，您拥有的解决方案可能是“*最好*的”，而且我不一定建议更改它（或者我会更改它以使用地图而不是算法），但这个问题对我来说很有趣，尤其是关于 JavaScript 语言的功能属性，我想提供一些想法。

## 方法一

以下应该可以工作，而不必在函数中显式声明变量，尽管它们被用作函数参数。它也很简洁，虽然有点简洁。

```
var map = Function.prototype.call.bind(Array.prototype.map);

obj.find = function find(match_id) {
    return this.id == match_id ? this : map(this, function(u) {
        return find.call(u, match_id);
    }).filter(function(u) { return u; })[0];
};​ 
```

这个怎么运作：

1.  我们测试看看是否`this.id == match_id`，如果是，返回`this`。
2.  我们使用`map`(via `Array.prototype.map`) 转换`this`为“找到的项目”数组，这些“找到的项目”是使用对该`find`方法的递归调用找到的。（假设，这些递归调用之一将返回我们的答案。没有得到答案的将返回`undefined`。）
3.  我们过滤“找到的项目”数组，以便`undefined`删除数组中的任何结果。
4.  我们返回数组中的第一项，并将其称为退出。
    *   如果数组中没有第一项，`undefined`将返回。

## 方法二

解决此问题的另一种尝试可能如下所示：

```
var concat = Function.prototype.call.bind(Array.prototype.concat),
    map = Function.prototype.call.bind(Array.prototype.map);

obj.find = function find(match_id) {
    return (function buildObjArray(o) {
        return concat([ o ], map(o, buildObjArray));
    })(this).filter(function(u) { return u.id == match_id })[0];
}; 
```

这个怎么运作：

1.  `buildObjArray`构建一个单一的、大的、一维数组，包含`obj`和所有`obj`的孩子。
2.  然后我们`filter`基于数组中的对象必须具有`id`of 的条件`match_id`。
3.  我们返回第一场比赛。

Method **1**和**Method 2**虽然很有趣，但它们的性能缺点是即使在找到匹配的 id 后它们仍会继续搜索。他们直到搜索结束才意识到他们拥有所需的东西，这不是很有效。

## 方法三

提高效率当然是可以的，现在我觉得这个真的很接近你感兴趣的东西了。

```
var forEach = Function.prototype.call.bind(Array.prototype.forEach);

obj.find = function(match_id) {
    try {
        (function find(obj) {
            if(obj.id == match_id) throw this;
            forEach(obj, find);
        })(obj);
    } catch(found) {
        return found;
    }
};​ 
```

这个怎么运作：

1.  我们将整个`find`函数包装在一个`try`/`catch`块中，这样一旦找到一个项目，我们就可以`throw`停止执行。
2.  我们在其中创建了一个内部`find`函数 (IIFE) `try`，我们引用它来进行递归调用。
3.  如果`this.id == match_id`, 我们`throw this`, 停止我们的搜索算法。
4.  如果不匹配，我们递归调用`find`每个孩子。
5.  如果匹配，`throw`则被我们的`catch`块捕获，并`found`返回对象。

由于该算法能够在找到对象后停止执行，因此它的性能将接近您的，尽管它仍然具有`try`/`catch`块的开销（在旧浏览器上可能很昂贵）并且`forEach`比典型的`for`循环慢。这些仍然是非常小的性能损失。

## 方法四

最后，虽然这种方法不符合您的要求，但如果可能的话，它在您的应用程序中的性能*要**好得多*，值得考虑。我们依赖于映射到对象的 id 映射。它看起来像这样：

 *```
// Declare a map object.
var map = { };

// ...
// Whenever you add a child to an object...
obj[0] = new MyObject();
// .. also store it in the map.
map[obj[0].id] = obj[0];

// ...
// Whenever you want to find the object with a specific id, refer to the map:
console.log(map[match_id]); // <- This is the "found" object. 
```

这样，根本不需要任何`find`方法！

通过使用这种方法，您的应用程序的性能提升将是巨大的。如果可能的话，请认真考虑。

但是，当您不再引用该对象时，请小心从地图中删除该对象。

```
delete map[obj.id]; 
```

这是防止内存泄漏所必需的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T23:20:51.240

不，没有其他明确的方法，将结果存储在变量中并没有那么麻烦，实际上这就是变量的用途。

是的，这种方法是递归的：

*   你有基本情况`if (this.id==match_id) return this`
*   你有调用自己的递归步骤`obj.find(match_id) { ... var result = this[i].find(match_id); }`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T23:37:43.560

我看不出有什么理由，为什么存储变量会不好。它不是一个副本，而是一个参考，所以它是有效的。加上临时变量是我现在可以看到的唯一方法（不过我可能错了）。

考虑到这一点，我认为一个方法没有`check_find`多大意义（它很可能基本上是相同的实现），所以如果你真的需要这个`check_find`方法，我会把它实现为

```
return this.find(match_id) !== false; 
```

该方法是否是递归的很难说。基本上，我会说是的，因为“find”的实现对于每个对象都是一样的，所以它几乎和

```
function find(obj, match_id) {
    if (obj.id == match_id) return obj;
    for (var i = 0; i < obj.length; ++i) {
        var result = find(obj[i], match_id);
        if (result !== false) return result;
    }
} 
```

这绝对是递归的（函数调用自身）。

但是，如果你这样做

```
onesingleobjectinmydeepobject.find = function(x) { return this; } 
```

我不太确定，如果你仍然会称之为递归。*

# emacs - ELisp：前向引用（在定义之前引用符号）

> ID：12611876
> 
> 赞同：2
> 
> 时间：2012-09-26T23:16:59.803
> 
> 标签：emacs, reference, elisp

你如何解决这个问题？

假设我想编写一个执行以下操作的函数：如果用户安装了库 X，则使用函数 X-function，否则 - 跳过？

我尝试了什么：

```
(when (symbol-function 'X-function)
  (X-function)) 
```

我收到此代码的警告 - 那么正确的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T23:27:00.643

这个怎么样：

```
(when (fboundp 'X-function)
    (X-function)) 
```

[http://www.gnu.org/software/emacs/manual/html_node/elisp/Function-Cells.html](http://www.gnu.org/software/emacs/manual/html_node/elisp/Function-Cells.html)上的文档介绍了符号功能

> 如果符号的功能单元格是无效的，则会发出无效功能错误信号。

我猜这就是你所看到的。另一方面， fboundp 只是根据函数是否存在返回 t 或 nil。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T16:00:41.400

抑制此编译器警告的方法是：

```
(declare-function X-function "ext:X-library.el")

(when (fboundp 'X-function)
     (X-function)) 
```

这里 X-library 是库存在时定义 X-function 的库的名称。然后字节编译器将执行以下操作：

1.  它将在加载路径中查找库。
2.  如果找到它，它将检查该函数是否已定义。
3.  如果它没有找到库，它将假定它会在库在那里并且没有错误地传递。

因此，如果没有 X 库，它不会抱怨，但如果有一个并且它没有定义函数，那么它会抱怨。这意味着如果库的更新版本不包含 X-function，那么您将知道何时尝试重新编译您的代码。

如果您查看 declare-function 的文档，您会发现它还可以检查函数的参数列表。

顺便说一句，如果您收到有关未声明变量的类似警告，您可以使用以下方法抑制这些警告：

```
(defvar X-variable) 
```

但是，即使您知道库将其设置为什么值，也不要设置该变量，因为这可能会在以后的版本中发生变化。

这为您提供了一个版本的程序，无论 X-library 是否存在都可以使用。您可能更喜欢有两个版本，一个用于 X-library 存在时，一个用于不存在时。这可以通过宏来完成：

```
(defmacro run? (function &rest args)
  "Expand to function call if function exists."
  (when (fboundp `,function)
    `(,function ,@args))) 
```

现在而不是像这样的电话：

```
(X-function a1 a2 a3) 
```

你写：

```
(run? X-function a1 a2 a3) 
```

如果你用 X-library 编译它，这将扩展为对 X-function 的调用。如果该库不存在，则它会扩展为什么都没有。在任何情况下，您都不需要 declare-function。这提供了两个不同的版本，但它应该更有效，因为关于库是否存在的决定是在编译时而不是运行时做出的。

一个小警告。如果您选择第二种解决方案，您必须在 X-library 环境中或外部编译整个程序。如果您尝试在程序中途加载库，那么当解释它时，它将按照您所期望的那样工作，宏在加载之前和之后扩展不同。但是在编译的程序中，宏只扩展一次。库的测试测试是在执行扩展的代码中而不是在扩展中，因此宏在加载之前和之后的工作方式不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T22:20:54.857

另一种可能会收到无法找到函数的警告的情况是，您以编程方式定义函数并使用**fset 对其**进行设置。以下示例说明了这一点以及如何处理它：

```
(eval-and-compile
  (fset 'my-function1 (lambda () nil)))

(my-function1)

(fset 'my-function2 (lambda () nil))

(my-function2)

(my-function3)

(eval-and-compile
  (fset 'my-function3 (lambda () nil))) 
```

如果你编译它，你会得到警告：

```
Warning: the function `my-function2' is not known to be defined. 
```

和：

```
Warning: the function `my-function3' might not be defined at runtime. 
```

如果您在同一个 Emacs 会话中第二次重新编译代码，第二个警告就会消失，但第一个警告不会。

这里发生的是：当编译器看到**eval-and-compile**时，它​​首先评估当前 Emacs 会话中的主体，然后编译它。在评估了代码之后，Emacs 知道了以编程方式定义的函数。

1.  对于**function1**，字节编译器会在 Emacs 评估表单后看到函数调用，因此您不会收到任何警告。
2.  在**function2**的情况下，字节编译器永远不知道函数已定义，因此您总是会收到警告。
3.  在**function3**的情况下，第一次，bite 编译器在看到函数调用时并不知道该函数存在。在编译结束时，它知道该函数存在，但它不够聪明，无法弄清楚它是如何知道的，因此您会收到不同的警告。但是，如果您在同一个 Emacs 会话中重新编译它，它确实知道，因此警告消失了。

请注意，**eval-and-compile**与**eval-with-compile**类似，在 Emacs 解释器中看起来像是一个**progn 。**

# knockout-validation - 淘汰赛验证插件自定义错误消息

> ID：12611878
> 
> 赞同：7
> 
> 时间：2012-09-26T23:17:17.693
> 
> 标签：knockout-validation

基于以下内容，我该如何设置回调以显示自定义错误消息而不是默认消息？

```
ko.validation.rules['exampleAsync'] = {
    async: true, // the flag that says "Hey I'm Async!"
    validator: function (val, otherVal, callBack) { // yes, you get a 'callback'

        /* some logic here */

        // hand my result back to the callback
        callback( /* true or false */ );
        // or if you want to specify a specific message
        callback( /* { isValid: true, message: "Lorem Ipsum" } */ );
    },
    message: 'My default invalid message'
}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-26T17:58:08.057

```
ko.validation.rules['exampleAsync'] = {
    async: true, 
    validator: function (val, otherVal, callBack) { 

        // make an ajax call or something here to do your async validation 
        $.ajax({ type: 'post', url: 'some url', data: val, success: function (data) { 
            if (data.success) {
                callback({ isValid: true, message: "yay it worked"});
            } else {
                callback({ isValid: false, message: data.message });
            }
        });
    },
    message: 'My default invalid message'
}; 
```

# ruby-on-rails - 通过 Ruby on Rails 验证方法验证年份的最佳方法？

> ID：12611881
> 
> 赞同：8
> 
> 时间：2012-09-26T23:17:55.980
> 
> 标签：ruby-on-rails

目前我有一个功能来检查出生年份是否正确：

```
 validates :birth_year, presence: true,
            format: {with: /(19|20)\d{2}/i } 
```

我还有一个检查日期是否正确的功能：

```
 validate :birth_year_format

  private

  def birth_year_format
    errors.add(:birth_year, "should be a four-digit year") unless (1900..Date.today.year).include?(birth_year.to_i)
  end 
```

是否可以将底部方法组合到`validates`顶部而不是我现在拥有的两个验证？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-26T23:26:00.810

你应该能够做这样的事情：

```
validates :birth_year, 
  presence: true,
  inclusion: { in: 1900..Date.today.year },
  format: { 
    with: /(19|20)\d{2}/i, 
    message: "should be a four-digit year"
  } 
```

看看：[http ://apidock.com/rails/ActiveModel/Validations/ClassMethods/validates](http://apidock.com/rails/ActiveModel/Validations/ClassMethods/validates)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-26T23:25:47.347

```
:birth_year, presence: true,
             format: {
                       with: /(19|20)\d{2}/i 
                     }  
             numericality: { 
                             only_integer: true,
                             greater_than_or_equal_to: 1900,
                             less_than_or_equal_to: Date.today.year
                           } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-25T16:43:26.030

正则表达式

```
 /\A(19|20)\d{2}\z/ 
```

只允许 1900 e 2099 之间的数字

\A - 字符串的开始

\z - 字符串结束

# actionscript-3 - Flex 3：如何设置 *selected* Tabbar 选项卡实例的渐变背景颜色？

> ID：12611887
> 
> 赞同：0
> 
> 时间：2012-09-26T23:18:25.347
> 
> 标签：actionscript-3, apache-flex, flex3

有没有办法设置 TabBar 的**选定**选项卡，使其包含渐变背景颜色？我会认为组合`fillColors`和`fillAplhas`将是要使用的样式，但这会设置其他**未选择**的选项卡背景颜色，正如您在运行下面的代码时所看到的那样。

目标是让最终用户选择所选选项卡实例的背景颜色（例如使用 ColorPicker）。我想对这种颜色应用一些渐变效果。

任何帮助将不胜感激，因为我一直试图让它工作太久。我已经在谷歌上无休止地搜索了这个，但仍然无法找到一个可行的解决方案。

```
private function updateTabColor():void {        
    var selectedTabIndex : int = tabBar.selectedIndex;        
    var tab:Tab = Tab(tabBar.getChildAt(selectedTabIndex));

    /* this works but not on the selected tab */
    tab.setStyle("fillColors", ["#000000", "000000"]);
    tab.setStyle("fillAlphas", [1.0, 0.4]);

    /* when not commented and as expected, tab is red */ 
    //tab.setStyle("backgroundColor", "red");

    /* when not commented, doesn't work as it appears it's deprecated in 3.0 */
    //tab.setStyle("selectedFillColors", "red");   
}

<mx:TabBar id="tabBar" dataProvider="viewStack" width="100%" itemClick="{updateTabColor()}"/>
<mx:ViewStack id="viewStack"  width="100%" height="100%">
  <mx:Box id="tab1" label="tab1" width="100%" height="100%"/>
  <mx:Box id="tab2" label="tab2" width="100%" height="100%"/>
  <mx:Box id="tab3" label="tab3" width="100%" height="100%"/>
</mx:ViewStack> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T05:11:01.887

[http://userflex.wordpress.com/2008/02/14/skin-tabnavigator-tabs/](http://userflex.wordpress.com/2008/02/14/skin-tabnavigator-tabs/)

^ 描述使用选项卡的皮肤而不是使用提供的样式

复制到这里作为历史

CSS

```
.tab
{
     up-skin: ClassReference("TabSkin");
     down-skin: ClassReference("TabSkin");
     over-skin: ClassReference("TabSkin");
     selected-up-skin: ClassReference("SelectedTabSkin");
     selected-down-skin: ClassReference("SelectedTabSkin");
     selected-over-skin: ClassReference("SelectedTabSkin");

     background-color: #FFFFFF;

     font-weight: normal;
     color: #000000;
     text-roll-over-color: #000000;

     corner-radius: 0;

     border-style: solid;
     border-thickness: 1;
     border-color: #000000;
}

.selectedTab
{
     background-color: #000000;

     font-weight: bold;
     color: #FFFFFF;
     text-roll-over-color: #FFFFFF;

     corner-radius: 0;

     border-style: solid;
     border-thickness: 1;
     border-color: #000000;
} 
```

AS3

```
package
{
     import mx.containers.Canvas;

     public class TabSkin extends Canvas
     {
         override protected function updateDisplayList
             (w : Number, h : Number) : void
         {
             this.styleName = "tab";

             super.updateDisplayList (w, h);
         }
     }
}

package
{
     import mx.containers.Canvas;

     public class SelectedTabSkin extends Canvas
     {
         override protected function updateDisplayList
             (w : Number, h : Number) : void
         {
             this.styleName = "selectedTab";

             super.updateDisplayList (w, h);
         }

     }
} 
```

MXML

```
<mx:TabNavigator id="tabs"
    tabStyleName="tab" selectedTabTextStyleName="selectedTab" /> 
```

# c# - Linq 到对象 C#

> ID：12611889
> 
> 赞同：0
> 
> 时间：2012-09-26T23:18:43.933
> 
> 标签：c#, linq-to-objects

我想获得一组债券及其相关的到期时间，其中的到期时间.matamount > 200000。

编辑：（我只希望每个债券的到期集合包括到期时间> 200000）

这是一个 program.cs，它具有类 defs 和一个为查询填充测试数据的方法。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace LinqToObjects
{
class Program
{
    static void Main(string[] args)
    {
        Program.QueryCollection();
        Console.ReadLine();
    }
    public static void QueryCollection()
    {
        List<Bond> bonds = Program.BuildCollections();
        //how do I get a list of Bonds that have a maturity.MatAmount > 200,000?
    }
    public static List<Bond> BuildCollections()
    {
        List<Bond> bonds = new List<Bond>();
        Bond bond;

        for (int i = 1; i <= 10; i++)
        {
            bond = new Bond() {ID = i, Title = "Bond Title " + i.ToString() };
            for (int j = 1; j <= 10; j++)
            { 
                bond.Maturities.Add(new Maturity(){ID = j, BondID = i, MatDate = DateTime.Today.AddDays(j), MatAmount = 152000 * j});
            }

            bonds.Add(bond);
        }
        return bonds;
    }
}
public class Bond
{
    public int ID { get; set; }
    public string Title { get; set; }
    public List<Maturity>  Maturities { get; set; }
    public Bond()
    {
        Maturities = new List<Maturity>();
    }
}
public class Maturity
{
    public int ID { get; set; }
    public int BondID { get; set; }
    public DateTime MatDate { get; set; }
    public int MatAmount { get; set; }
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:35:27.833

这个怎么样？

```
IEnumerable<Bond> bigBonds = bonds.Where(b => b.Maturities.Any(m => m.MatAmount > 200000)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:29:51.783

我不确定您在寻找什么，但要获得您的债券，只需执行以下操作：

```
var filteredBonds = 
        (
            from bond in bonds
            join maturity in maturities on bond.ID equals maturity.BondID
            where maturity.MatAmount > 200000
            select new { bond.ID, bond.Title, maturity.MatAmount, maturity.MatDate }
        ).ToList(); 
```

ToArray() 是可选的，如果您愿意，可以将内容保留在表格中。我不确定你想对你的结果做什么。

您可能还想在数据结构中解耦债券和到期日。我不认为你真的需要一个成熟度列表，因为你将 BondID 存储为成熟度对象的成员。这似乎有点多余，但老实说，我不使用 Linq，所以也许这就是要走的路。你的来电。

# actionscript-3 - 继承使用 Has-A 关系的类并用子类替换拥有的类？

> ID：12611892
> 
> 赞同：0
> 
> 时间：2012-09-26T23:19:07.613
> 
> 标签：actionscript-3, oop, inheritance

我正在使用 ActionScript3，我正在编写一个扩展 Bitmap 的类，我希望拥有 Bitmap 的所有行为，并且我还希望将其 bitmapData 替换为提供更大灵活性的 bitmapData 的子类。

所以基本上我所拥有的是（隐喻）：

```
Class Gunman
{
    //Has-A
    public var pistol : Gun;
    public function Gunman(gun : Gun)
    {
        this.pistol = gun;
    }
    //methods
    public function shoot():void ..
    {
        pistol.fire();
    }  
}

Class Gun
{
    //constructor omitted cause it is unnecessary for this example
    public function fire():void ..
} 
```

现在我扩展了这两个类。

```
Class Automatic extends Pistol
{
    override public function fire():void
    {
        super.fire(); super.fire(); super.fire();
    }
}

Class NavySeal extends Gunman
{
    public function Enforcer(auto : Automatic)
    {
        super(auto);
    }
} 
```

问题是人们仍然可以轻松地做到这一点：

```
var eliteSoldier : NaveSeal = new Enforce(new Automatic());
eliteSoldier.pistol = new Gun(); 
```

这会很糟糕。有什么办法可以防止这种情况吗？

我无法更改“Gunman”，因为它是 API 的一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T11:28:05.747

如果您试图阻止更改公共属性`public var pistol:Gun;`，那么如果您无法控制已定义它的类，则不能。这是一个糟糕的设计，它应该是 getter/setter。然后，您将能够获取并测试用户通过的内容等。

此致

# apache - 为什么这个 htaccess 排除条件不起作用？

> ID：12611895
> 
> 赞同：0
> 
> 时间：2012-09-26T23:19:22.860
> 
> 标签：apache, .htaccess, mod-rewrite

我在我们网站上的所有页面上强制使用 https，但是由于我们使用的一些旧插件的复杂性（需要通过 http 连接），我需要为一个目录设置 https 强制的例外。

不过我也搞不定。我认为应该起作用的规则是给我一个 403 错误。

有人可以看看吗？

我有很多东西可以将非 www 重定向到 www：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} !^subdomain1.site.com$
RewriteCond %{HTTP_HOST} !^subdomain2.site.com$
RewriteRule ^(.*)$ http://www.site.com/$1 [R=301] 
```

然后是 https 强制：

```
RewriteCond %{HTTPS} !=on
RewriteRule ^(.*)$ https://www.site.com/$1 [R,L] 
```

但是，如果我添加另一个条件以从该规则中排除目录：

```
RewriteCond %{HTTPS} !=on
RewriteCond %{REQUEST_URI} !^/subdir/sub-subdir/
RewriteRule ^(.*)$ https://www.site.com/$1 [R,L] 
```

我从 404 页面看到内容时出现错误，但 URL 是[https://www.site.com/403.shtml](https://www.site.com/403.shtml) - 但我的网络根目录中没有 403.shtml。（这是一个 WHM/cPanel 驱动的服务器）

# macos - Firefox NPAPI 插件在 VMware 上的 OSX 中损坏

> ID：12611896
> 
> 赞同：2
> 
> 时间：2012-09-26T23:19:39.910
> 
> 标签：macos, flash, firefox, vmware, npapi

Firefox NPAPI 插件似乎在 Mac OSX（在 10.6 和 10.7 上测试）VMware 虚拟机中被破坏。有谁知道为什么，或者有一个解决方法的想法 - 例如检测用户何时运行 Firefox/OSX/VM？

语境：

*   仅当 FF && OSX && VM 时，我的插件才会消耗 100% 的 CPU。但是，该插件仍然可以使用。这始终是可重现的，并且发生在多个 VM 上。
*   Adobe Reader、Adobe Flash 和我使用 Firebreath（教程）构建的一个测试插件在这个环境中也都被破坏了。
*   Firefox 在控制台中输出以下日志消息：“无效像素格式”和“无效上下文”。可能与 OpenGL 有关 - 请参阅[错误报告](https://bugzilla.mozilla.org/show_bug.cgi?id=728822)。
*   运行 glxinfo 命令会给出类似的错误：

    ```
    cb-sea-miniosx64-03:~ seabld$ glxinfo
    name of display: /tmp/launch-LojaDe/:0
    Thu Jul  5 20:13:51 cb-sea-miniosx64-03.comm-build.scl1.mozilla.com glxinfo[1009 <Error>: unknown error code: invalid pixel format
    Thu Jul  5 20:13:51 cb-sea-miniosx64-03.comm-build.scl1.mozilla.com glxinfo[1009] <Error>: kCGErrorFailure: Set a breakpoint @ CGErrorBreakpoint() to catch errors as they are logged.
    X Error of failed request: GLXBadContext
      Major opcode of failed request:  0 ()
      Serial number of failed request:  16
      Current serial number in output stream:   16 
    ```

*   Instruments 分析器报告了我的插件在 IOSurfaceCreate/IOSurfaceClientCreate 上花费的大量时间。如果我理解正确，浏览器使用 IOSurface 与插件共享渲染数据。
*   使用 Activity Monitor 获取的样本似乎没有任何有用的信息 - 除了 CPU 问题出在主线程 (DispatchQueue) 中。
*   一种解决方法是在 32 位模式下运行 Firefox：右键单击 FF 应用程序 > 获取信息 > 在 32 位模式下打开。但我们不能指望用户这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:26:18.143

听起来好像 OS X VMWare 来宾根本没有功能齐全的 3D 加速。如果有的话，这是一个 VMWare 错误（未公开完整的 3D 加速），或者可能是一个 Firefox 错误（对缺乏 3D 功能的反应很糟糕）；这几乎肯定不是你的错。

我不会花太多时间尝试解决它，特别是考虑到您尝试过的所有其他插件（包括 Flash！）似乎都受到完全相同的问题的影响。将其列为“已知问题”并继续。

# excel - 测试VBA中是否存在范围

> ID：12611900
> 
> 赞同：12
> 
> 时间：2012-09-26T23:20:51.237
> 
> 标签：excel, vba, range, offset

我的 excel ss 中有一个动态定义的命名范围，它根据像这样的开始日期和结束日期从表中抓取数据

```
=OFFSET(Time!$A$1,IFERROR(MATCH(Date_Range_Start,AllDates,0)-1,MATCH(Date_Range_Start,AllDates)),1,MATCH(Date_Range_End,AllDates)-IFERROR(MATCH(Date_Range_Start,AllDates,0)-1,MATCH(Date_Range_Start,AllDates)),4) 
```

但是，如果日期范围在表中没有数据，则该范围不存在（或某些东西，idk）。如何在 VBA 中编写代码来测试此范围是否存在？

我尝试过类似的东西

```
If Not Range("DateRangeData") Is Nothing Then 
```

但我收到“运行时错误 1004，对象 '_Global' 的方法 'Range' 失败。”

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-10-04T10:52:26.600

这是我敲出的一个函数，用于返回是否存在命名范围。它可能会帮助你。

```
Function RangeExists(R As String) As Boolean
    Dim Test As Range
    On Error Resume Next
    Set Test = ActiveSheet.Range(R)
    RangeExists = Err.Number = 0
End Function 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-09-26T23:39:07.153

您可以在 VBA 中复制匹配以在使用范围之前计算您将拥有多少行，或者您可以使用错误处理：

```
On Error Resume Next

Debug.Print range("DateRangeData").Rows.Count

If Err = 1004 Then
    MsgBox "Range Empty"
    Exit Sub
Else
    MsgBox "Range full"
End If

Err.Clear
On Error GoTo 0 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-07T17:07:06.783

这是另一种方法。它的优点是取容器和要测试的名称。这意味着您可以测试工作表名称或工作簿名称。

像这样：

```
If NamedRangeExists(ActiveSheet.Names, "Date") Then
    ...
Else
...
End If 
```

或者

```
If NamedRangeExists(ActiveWorkbook.Names, "Date") Then
   ...
Else
   ...
End If 
```

* * *

```
Public Function NamedRangeExists(ByRef Container As Object, item As String) As Boolean

Dim obj As Object
Dim value As Variant

On Error GoTo NamedRangeExistsError:

    value = Container(item)
    If Not InStr(1, CStr(value), "#REF!") > 0 Then
        NamedRangeExists = True
    End If
    Exit Function

Exit Function

NamedRangeExistsError:
    NamedRangeExists = False
End Function 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-22T04:32:01.710

根据您正在执行的应用程序，最好考虑使用字典。当您想检查某物是否存在时，它们特别有用。举个例子：

```
Dim dictNames as Scripting.Dictionary

Sub CheckRangeWithDictionary()

    Dim nm As Name

    'Initially, check whether names dictionary has already been created
    If Not dictNames Is Nothing Then
        'if so, dictNames is set to nothing
        Set dictNames = Nothing
    End If

    'Set to new dictionary and set compare mode to text
    Set dictNames = New Scripting.Dictionary
    dictNames.CompareMode = TextCompare

    'For each Named Range
    For Each nm In ThisWorkbook.Names
        'Check if it refers to an existing cell (bad references point to "#REF!" errors)
        If Not (Strings.Right(nm.RefersTo, 5) = "#REF!") Then
            'Only in that case, create a Dictionary entry
            'The key will be the name of the range and the item will be the address, worksheet included
            dictNames(nm.Name) = nm.RefersTo
        End If
    Next

    'You now have a dictionary of valid named ranges that can be checked

End Sub 
```

在您的主要程序中，您需要做的就是在使用范围之前进行存在性检查

```
Sub CopyRange_MyRange()

    CheckRangeWithDictionary

    If dictNames.exists("MyRange") then
        Sheets(1).Range("MyRange").Copy
    end if

End Sub 
```

虽然加载字典可能看起来有点长，但处理和搜索速度非常快。检查是否存在引用有效地址的任何命名范围也变得更加简单，而无需在这个简单的应用程序中使用错误处理程序。

请注意，在工作表级别而不是工作簿级别使用名称时，有必要使用更精细的键来保证唯一性。从创建字典的方式来看，如果重复某个键，则会覆盖项目值。这可以通过使用与密钥创建语句中的检查相同的*Exists方法来避免。*如果您需要有关如何使用字典的良好参考，请使用[这个](http://excelmacromastery.com/vba-dictionary/ "字典参考")。

祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-30T02:07:49.403

这是一篇旧帖子，但没有一个评分答案具有动态解决方案来测试`name`工作簿或工作表中是否存在。下面的这个函数将完成：

```
Function pg_Any_Name(thename As String) As Boolean
Dim n As Name, t As String

   For Each n In ThisWorkbook.Names
      t = Mid(n.Name, InStr(1, n.Name, "!", vbTextCompare) + 1, 999)

      If UCase(thename) = UCase(t) Then
         pg_Any_Name = True
         Exit Function
      End If
   Next n

End Function 
```

值得注意的是，这不适用于这个特定问题，因为 OP 有一个动态定义的范围。这个问题应该更准确地命名为*Test if Name is a Valid Range*因为`name`总是作为公式存在，问题是它是否是有效的*RANGE*。要使用同时检查工作簿和工作表的解决方案来解决此问题...此功能将起作用：

```
Function PG_Range_Name(thename As String) As Boolean
Dim n As Name, t As String

   For Each n In ThisWorkbook.Names
      t = Mid(n.Name, InStr(1, n.Name, "!", vbTextCompare) + 1, 999)

      If UCase(thename) = UCase(t) Then
         On Error Resume Next
         PG_Range_Name = n.RefersToRange.Columns.Count > 0
         Exit Function
      End If
   Next n

End Function 
```

# spring - 弹簧保护@RequestBody

> ID：12611904
> 
> 赞同：8
> 
> 时间：2012-09-26T23:21:26.197
> 
> 标签：spring, spring-security

`@RequestBody`使用 Spring Security保护安全的正确方法是什么？

例如：A`User`可以有多个`Blog`s，每个都`Blog`可以有多个`Entry`s。用户将条目保存到某个博客，请求将如下所示：

```
@RequestMapping(value="/api/entry", method=RequestMethod.POST)
@ResponseBody
public Entry save(@Valid @RequestBody Entry entry) {
    this.entryService.save(entry);
    return entry;
} 
```

现在，传入`entry`有一个`Blog`，用户可以修改请求并选择其他人的博客，有效地将条目发布到他们的博客。虽然我可以在验证中捕捉到这一点（查询持久层以验证是否`Blog`属于已登录`User`），但我觉得这应该由 Spring Security 处理。如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-27T01:02:27.310

我们遇到过这种情况。

这是两个解决方案。我不太喜欢

```
@RequestMapping(value="/api/entry", method=RequestMethod.POST)
@ResponseBody
@PreAuthorize("#entry.author.name == principal.name)"
public Entry save(@Valid @RequestBody Entry entry, Principal principal) {
    this.entryService.save(entry);
    return entry;
} 
```

或者

```
@RequestMapping(value="/api/entry", method=RequestMethod.POST)
    @ResponseBody
    @PreAuthorize("Decision.isOK(entry, principal)")
    public Entry save(@Valid @RequestBody Entry entry, Principal principal) {
        this.entryService.save(entry);
        return entry;
    } 
```

//在这种情况下，Spring 将从 Decision 类调用您的静态 isOk() 方法。它应该返回布尔值。

Spring 为方法注入 Principal 主体授权对象，你不必担心。启用`@PreAuthorize`注释

`<security:global-method-security pre-post-annotations="enabled" />`

第二个使用方面。创建方面。

```
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface Protector {
}

@Aspect
@Component
public class MyAspect {
   @Before("@annotation(com.xyz.Protector)")
   public void before(JoinPoint joinPoint) throws Throwable {
        //u can get method object from joinPoint object, 
        Method method = ((MethodSignature)joinPoint.getMethodSignature()).getMethod();
        //As long as you have Method object you can read the parameter objects (Entry and Principal) with reflection. 
        //So Compare here: If entry.getOwner().getId().equal(principal.getName()) blah blah blah  
    }
}

@RequestMapping(value="/api/entry", method=RequestMethod.POST)
@ResponseBody
@Protector
public Entry save(@Valid @RequestBody Entry entry, Principal principal) {
    this.entryService.save(entry);
    return entry;
} 
```

如果你有方面，你可以在运行时拥有更多的所有权

也可以参考这个[ulr](https://stackoverflow.com/questions/10185400/custom-class-principal-in-preauthorize)

# c# - 从 Web 服务将数据发布到 SQL Server 2008 数据库会产生错误

> ID：12611906
> 
> 赞同：1
> 
> 时间：2012-09-26T23:21:42.280
> 
> 标签：c#, .net, sql-server-2008

我正在尝试使用 c# 将数据发布到 Web 服务（我编写的）。当我从本地计算机运行此 Web 服务时，它运行良好。一旦我将服务器移至它（在我的建筑物内），它就会引发此错误：

> 服务器无法处理请求。
> ---> ExecuteNonQuery：连接属性尚未初始化。

有什么想法可能导致这种情况吗？

我检查过：

*   应用程序池标识 - 网络服务

    部分启用 ASP.NET 用来识别传入用户的安全身份验证模式的配置。--> 部分可以配置如果/当在执行请求期间发生未处理的错误时要做什么。具体来说，

    ```
     <customErrors mode="RemoteOnly" defaultRedirect="GenericErrorPage.htm">
                <error statusCode="403" redirect="NoAccess.htm" />
                <error statusCode="404" redirect="FileNotFound.htm" />
            </customErrors>
            -->
            <pages>
                <controls>
                    <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
                    <add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
                </controls>
            </pages>
            <httpHandlers>
                <remove verb="*" path="*.asmx"/>
                <add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
                <add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
                <add verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" validate="false"/>
            </httpHandlers>
            <httpModules>
                <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            </httpModules>
        </system.web>
        <system.codedom>
            <compilers>
                <compiler language="c#;cs;csharp" extension=".cs" warningLevel="4" type="Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
                    <providerOption name="CompilerVersion" value="v3.5"/>
                    <providerOption name="WarnAsError" value="false"/>
                </compiler>
            </compilers>
        </system.codedom>
        <!-- 
            The system.webServer section is required for running ASP.NET AJAX under Internet
            Information Services 7.0\.  It is not necessary for previous version of IIS.
        -->
        <system.webServer>
            <validation validateIntegratedModeConfiguration="false"/>
            <modules>
                <remove name="ScriptModule"/>
                <add name="ScriptModule" preCondition="managedHandler" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            </modules>
            <handlers>
                <remove name="WebServiceHandlerFactory-Integrated"/>
                <remove name="ScriptHandlerFactory"/>
                <remove name="ScriptHandlerFactoryAppServices"/>
                <remove name="ScriptResource"/>
                <add name="ScriptHandlerFactory" verb="*" path="*.asmx" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
                <add name="ScriptHandlerFactoryAppServices" verb="*" path="*_AppService.axd" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
                <add name="ScriptResource" preCondition="integratedMode" verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
            </handlers>
        </system.webServer>
        <runtime>
            <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
                <dependentAssembly>
                    <assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35"/>
                    <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
                </dependentAssembly>
                <dependentAssembly>
                    <assemblyIdentity name="System.Web.Extensions.Design" publicKeyToken="31bf3856ad364e35"/>
                    <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
                </dependentAssembly>
            </assemblyBinding>
        </runtime>
    </configuration> 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:39:55.903

`Connection property has not been initialized``Connection`由于`ConnectionString`未提供或不正确的信息，通常由对象抛出。

```
using (SqlConnection connection = new SqlConnection())
{
    // don't forget this line.
    connection.ConnectionString = "valid connection string here";
    // then pass the connection to your command object
    using (SqlCommand command = new SqlCommand())
    {
         command.Connection = connection;
         // other codes
    }
} 
```

附加说明：

**[SQL Server 2008 连接字符串格式...](http://connectionstrings.com/sql-server-2008)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T23:24:16.773

似乎连接尚未与命令对象关联。

检查并查看创建连接对象是否有问题。是否正确初始化？是否使用正确的连接字符串？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:54:43.423

我能够解决我的问题。我实际上是在向错误的服务器进行身份验证。因此，一旦我指向正确的服务器，它就起作用了。驾驶舱麻烦在这里。

# jquery - 选择子项或父项时切换选中/取消选中复选框？

> ID：12611907
> 
> 赞同：-1
> 
> 时间：2012-09-26T23:21:52.407
> 
> 标签：jquery, jquery-ui, jquery-selectors, telerik

下面的代码来自 Telerik Treeview 控件。我需要能够在选择和取消选择孩子时切换孩子。我需要能够在选择和取消选择父级时切换所有子级。

```
 <% Html.Telerik().TreeView()
                           .Name("MultiLocationPicker")
                           .ClientEvents(events1 => events1.OnSelect("MultiLocationPicker_Selected"))
                           .ClientEvents(events => events
                                .OnChecked("MultiLocationPicker_Checked")
                            )
                           .HtmlAttributes(new { style = "position:absolute;padding-top:5px;background-color:#EAEAEA;color:#3F8AC4;z-index:2000;display:none" })
                           .ShowCheckBox(true)
                           .BindTo(getAvailableLocations, mappings =>
                        {
                            mappings.For<RegionEntity>(binding => binding
                                .ItemDataBound((item, region) =>
                                                   {
                                                       item.Text = region.RecordName;
                                                       item.Value = ""; 
                                                       var regionNode = regionNodes.FirstOrDefault(e => e.Equals(region.RecordName));
                                                       var le = new List<LocationEntity>(region.Location);
                                                       bool isChecked = false;
                                                       foreach (var l in le)
                                                       {
                                                           if (userLocations.Contains(l.ID))
                                                           {
                                                               isChecked = true;
                                                           }
                                                           else
                                                           {
                                                               isChecked = false;
                                                               break;
                                                           }
                                                       }

                                                       item.Checked = isChecked;
                                                       item.Expanded = true;

                                                   }).Children(location => location.Location));
                            mappings.For<LocationEntity>(binding => binding
                                                                        .ItemDataBound((item, location) =>
                                                                                          {
                                                                                              item.Text = location.Name;
                                                                                              item.Value =
                                                                                                  location.ID.ToString();
                                                                                              item.Checked = userLocations.Contains(location.ID);

                                                                                          }

                                                                                           ));

                        }).Render();%>  

    </li> 
    <input type="hidden" id="isDirty" value="false"/>
    <%
      }
     %>

    <script type="text/javascript">
        //<![CDATA[

        var allVals = [];
        $('#spnloc').hover(function () {
            $('#MultiLocationPicker').show();
        });
        $('#MultiLocationPicker').mouseenter(function () {
            $('#MultiLocationPicker').show();

        });

        function MultiLocationPicker_Selected(e) {

            var item = $(e.item);
            var checkbox = item.find('.t-checkbox:first [type=checkbox]');                

            !checkbox.is(':checked') ? checkbox.attr('checked', 'checked') : checkbox.removeAttr('checked');                                      

        }                                                   

HTML Markup for the above control given below:                                                  

  <div style=
  "position: absolute; padding-top: 5px; background-color: rgb(234, 234, 234); color: rgb(63, 138, 196); z-index: 2000;"
  id="MultiLocationPicker" class="t-widget t-treeview t-reset">
    <ul class="t-group t-treeview-lines">
      <li class="t-item t-first">
        <div class="t-top">
          <span class="t-checkbox"><input type="hidden" value="0" name=
          "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
          "checkbox" value="False" name="MultiLocationPicker_checkedNodes[0].Checked"
          class="t-input" /></span><span class="t-in">Main Region</span><input type=
          "hidden" value="Main Region" name="itemValue" class="t-input" />
        </div>

        <ul class="t-group">
          <li class="t-item">
            <div class="t-top">
              <span class="t-checkbox"><input type="hidden" value="0:0" name=
              "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
              "checkbox" value="False" name=
              "MultiLocationPicker_checkedNodes[0:0].Checked" class=
              "t-input" /></span><span class="t-in">North Vancouver</span><input type=
              "hidden" value="5761a893-9ef0-48d3-847a-2638ec081f5f" name="itemValue"
              class="t-input" />
            </div>
          </li>

          <li class="t-item">
            <div class="t-mid">
              <span class="t-checkbox"><input type="hidden" value="0:1" name=
              "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
              "checkbox" value="False" name=
              "MultiLocationPicker_checkedNodes[0:1].Checked" class=
              "t-input" /></span><span class="t-in">testLocation2</span><input type=
              "hidden" value="d63d6ff6-07dc-4021-a4bb-7b1b7c781119" name="itemValue"
              class="t-input" />
            </div>
          </li>

          <li class="t-item t-last">
            <div class="t-bot">
              <span class="t-checkbox"><input type="hidden" value="0:2" name=
              "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
              "checkbox" value="False" name=
              "MultiLocationPicker_checkedNodes[0:2].Checked" class=
              "t-input" /></span><span class="t-in">TestLocations123</span><input type=
              "hidden" value="eadfd0f5-9181-4094-b01a-9d7ee383b7f2" name="itemValue"
              class="t-input" />
            </div>
          </li>
        </ul>
      </li>

      <li class="t-item">
        <div class="t-mid">
          <span class="t-checkbox"><input type="hidden" value="1" name=
          "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
          "checkbox" value="False" name="MultiLocationPicker_checkedNodes[1].Checked"
          class="t-input" /></span><span class="t-in">World</span><input type="hidden"
          value="World" name="itemValue" class="t-input" />
        </div>

        <ul class="t-group">
          <li class="t-item">
            <div class="t-top">
              <span class="t-checkbox"><input type="hidden" value="1:0" name=
              "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
              "checkbox" value="False" name=
              "MultiLocationPicker_checkedNodes[1:0].Checked" class=
              "t-input" /></span><span class="t-in">Sydney GMT+10</span><input type=
              "hidden" value="ca1033d4-a9ca-4e16-96ea-3b92ab6e1c52" name="itemValue"
              class="t-input" />
            </div>
          </li>

          <li class="t-item t-last">
            <div class="t-bot">
              <span class="t-checkbox"><input type="hidden" value="1:1" name=
              "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
              "checkbox" value="False" name=
              "MultiLocationPicker_checkedNodes[1:1].Checked" class=
              "t-input" /></span><span class="t-in">USA</span><input type="hidden" value=
              "a5261a17-9696-471c-a39a-af11b14bd546" name="itemValue" class="t-input" />
            </div>
          </li>
        </ul>
      </li>

      <li class="t-item">
        <div class="t-mid">
          <span class="t-checkbox"><input type="hidden" value="2" name=
          "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
          "checkbox" value="False" name="MultiLocationPicker_checkedNodes[2].Checked"
          class="t-input" /></span><span class="t-in">Africa</span><input type="hidden"
          value="Africa" name="itemValue" class="t-input" />
        </div>

        <ul class="t-group">
          <li class="t-item">
            <div class="t-top">
              <span class="t-checkbox"><input type="hidden" value="2:0" name=
              "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
              "checkbox" value="False" name=
              "MultiLocationPicker_checkedNodes[2:0].Checked" class=
              "t-input" /></span><span class="t-in">Africa</span><input type="hidden"
              value="5c2389eb-365e-42bb-9b1a-8db36f87b4af" name="itemValue" class=
              "t-input" />
            </div>
          </li>

          <li class="t-item t-last">
            <div class="t-bot">
              <span class="t-checkbox"><input type="hidden" value="2:1" name=
              "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
              "checkbox" value="True" name=
              "MultiLocationPicker_checkedNodes[2:1].Checked" class="t-input" checked=
              "checked" /><input type="hidden" value="Headquarters1" name=
              "MultiLocationPicker_checkedNodes[2:1].Text" class="t-input" /><input type=
              "hidden" value="ac171662-3eca-411f-a623-a3cb1a69238e" name=
              "MultiLocationPicker_checkedNodes[2:1].Value" class=
              "t-input" /></span><span class="t-in">Headquarters1</span><input type=
              "hidden" value="ac171662-3eca-411f-a623-a3cb1a69238e" name="itemValue"
              class="t-input" />
            </div>
          </li>
        </ul>
      </li>

      <li class="t-item">
        <div class="t-mid">
          <span class="t-checkbox"><input type="hidden" value="3" name=
          "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
          "checkbox" value="False" name="MultiLocationPicker_checkedNodes[3].Checked"
          class="t-input" /></span><span class="t-in">India</span><input type="hidden"
          value="India" name="itemValue" class="t-input" />
        </div>

        <ul class="t-group">
          <li class="t-item">
            <div class="t-top">
              <span class="t-checkbox"><input type="hidden" value="3:0" name=
              "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
              "checkbox" value="False" name=
              "MultiLocationPicker_checkedNodes[3:0].Checked" class=
              "t-input" /></span><span class="t-in">Gurgaon</span><input type="hidden"
              value="d8266db4-e846-4338-906f-e0b84fd9044a" name="itemValue" class=
              "t-input" />
            </div>
          </li>

          <li class="t-item">
            <div class="t-mid">
              <span class="t-checkbox"><input type="hidden" value="3:1" name=
              "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
              "checkbox" value="False" name=
              "MultiLocationPicker_checkedNodes[3:1].Checked" class=
              "t-input" /></span><span class="t-in">MASHALLAAH</span><input type="hidden"
              value="869c083a-a17b-4a7a-a2a9-ef88f972de1b" name="itemValue" class=
              "t-input" />
            </div>
          </li>

          <li class="t-item t-last">
            <div class="t-bot">
              <span class="t-checkbox"><input type="hidden" value="3:2" name=
              "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
              "checkbox" value="False" name=
              "MultiLocationPicker_checkedNodes[3:2].Checked" class=
              "t-input" /></span><span class="t-in">YouThinkSo</span><input type="hidden"
              value="4e33e582-8a54-450a-ad73-70698a578162" name="itemValue" class=
              "t-input" />
            </div>
          </li>
        </ul>
      </li>

      <li class="t-item t-last">
        <div class="t-bot">
          <span class="t-checkbox"><input type="hidden" value="4" name=
          "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
          "checkbox" value="False" name="MultiLocationPicker_checkedNodes[4].Checked"
          class="t-input" /></span><span class="t-in">Canada</span><input type="hidden"
          value="Canada" name="itemValue" class="t-input" />
        </div>

        <ul class="t-group">
          <li class="t-item t-last">
            <div class="t-top t-bot">
              <span class="t-checkbox"><input type="hidden" value="4:0" name=
              "MultiLocationPicker_checkedNodes.Index" class="t-input" /><input type=
              "checkbox" value="False" name=
              "MultiLocationPicker_checkedNodes[4:0].Checked" class=
              "t-input" /></span><span class="t-in">West Vancouver</span><input type=
              "hidden" value="b8fd4a6f-bfc7-4c8a-b2ff-cb3c278c7434" name="itemValue"
              class="t-input" />
            </div>
          </li>            
        </ul>            
      </li>             
    </ul>                
  </div> 
```

问题和疑问：

```
 On selecting a child node I want the checkbox to get selected/checked in toggle state?
    On selected a parent node I want the checkboxes of the parent and the children to get selected/checked in toggle state.                
    I have tried doing it with the Jquery code above in function              MultiLocationPicker_Selected .                                
Can you tell me how to refactor the code to achieve this functionality. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T00:05:30.543

I suggest first giving the parent checkboxes a unique identifier/class and same for its children.

Ill go with

```
Parent Checkbox: <input type='checkbox' class='parent1'/>

  Child1:<input type='checkbox' />
  Child2:<input type='checkbox' />
  Child3:<input type='checkbox' />
  Child4:<input type='checkbox' /> 
```

Then do something along the lines of

```
if($(".parent1").prop("checked")) {
   $(".parent > input").prop("checked","true");
} else {
   $(".parent > input").prop("checked","false");
} 
```

# php - 包装/重用/克隆 PHP 对象（代码优化）

> ID：12611910
> 
> 赞同：1
> 
> 时间：2012-09-26T23:22:24.623
> 
> 标签：php, oop, optimization

想象一下，两个类共享几乎完全相同的方法和属性，都扩展了父类，但差异很小。

```
class fields { 
 public function __construct() {
  global $id;
  $this->id = $id++;
 }
}

class input extends fields {
 public function __construct() {
  parent::__construct();
 }
 public function draw() {
  echo '<input>';
 }
}

class textarea extends fields {
 public function __construct() {
  parent::__construct();
 }
 public function draw() {
  echo '<textarea>';
 }
} 
```

我认为以这种伪代码方式重写 textarea 类会更有效：

```
class textarea extends fields {
 public function __construct() {
  $this = new input(); // <<------ 
 }
 public function draw() {
  echo '<textarea>';
 }
} 
```

基本上，我不确定如何最好地做到这一点，以便该类的行为类似于第一个示例中的类。

本质上，我想使用 OOP 执行以下操作，但能够像上面第一个示例中那样使用对象（能够调用可能重载的方法，具有不同的属性等）：

```
function a() {echo '123';}
function b() {a();} 
```

刚刚把整个类都抄下来了，修改了几行，感觉很浪费。

**最终答案** 感谢这些人，这是与示例调用的组合答案：

```
abstract class fields { 
 private static $masterid = 0;
 public function __construct() {
  $this->id = self::$masterid++;
 }
}

class input extends fields {
 public $data;
 public function __construct($new = '') {
  parent::__construct();
  if ($new) $this->data = $new;
  else $this->data = 'Hello';
 }
 public function draw() {
  echo '<input>'.$this->export().'</input>';
 }
 public function export() {
  return 'ID '.$this->id.' = '.$this->data;
 }
}

class textarea extends input {
 public function __construct($new = '') {
  parent::__construct($new);
 }
 public function draw() {
  echo '<textarea>'.$this->export().'</textarea>';
 }
}

$a = new textarea();
$a->draw();
$a = new textarea('World');
$a->draw();
$a = new input('!');
$a->draw();

//Outputs:
// <textarea>ID 0 = Hello</textarea>
// <textarea>ID 1 = World</textarea>
// <input>ID 2 = !</input> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:38:06.970

使字段类成为一个抽象类，就像 Darren 建议的那样，使“绘制”方法成为字段类的函数。

现在这是技巧，您希望输入类扩展字段，但覆盖 draw 方法。这将允许您自定义该方法的功能，并且您仍然可以从其中调用父变体。

最后，由于 textarea 类将与输入类有许多相似之处，因此请让 textarea 扩展输入。从而继承字段和输入的属性和方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:30:48.953

让“fields”类有一个draw方法：

```
public function draw($msg) {
    echo $msg;
} 
```

然后在 textarea 或输入类中放置：

```
parent::draw("<input>"); 
```

这减少了您拥有的方法数量，并且可以为两种类型的字段调用一种方法。

同样在您的“字段”类中，将 id 代码更改为如下所示：

```
public $id
public function __construct($id) {
    $this->id = $id;
} 
```

然后在子类中：

```
parent::__construct(1); //Or whatever ID you want 
```

您拥有它的方式，ID 每次设置时都是相同的值，这将导致字段的每个子类都具有相同的 id。这样每个子类将有一个单独的 ID。

也因为我很好，这一切都放在一起：

```
public class field {
    $id;
    public __construct($id) {
        $this->id = $id;
    }

    public function draw($msg) {
        echo $msg;
    }
}

public class input extends field {
    public __construct() {
        parent::__construct(1);
        parent::draw("<input>");
    }
}

public class textarea extends field {
    public __construct() {
        parent::__construct(2);
        parent::draw("<textarea>");
    }
} 
```

这就是我根据你所说的把它放在一起的方式。不过，我可能弄错了您的要求。你能告诉我我主要是一个Java程序员吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T23:41:07.120

目前还不清楚你想做什么。对于您给出的示例，我认为结构还可以，但是您应该进行一些更改，尤其是构造函数。我认为构造函数应该是抽象的，带有抽象方法draw()。

```
abstract class fields { 

   // Use a static member to keep track of id's instead of making it global
   private static $id = 0;

   // Use an instance variable to keep track of a particular instance's id
   private $myId;

   public function __construct() {
      // Increment the static ID & assign it to the instance id.
      $this->myId = self::$id++;
   }

   // Provide a public getter, so that the ID can't be changed
   // externally to this class
   public function getId() {
       return $this->myId;
   }

   public abstract draw(); // Make sure all sub classes implement a draw() method.

}

class input extends fields {
   // Don't need to call the parent constructor if you're not adding anything
   // else. It will be called automatically.

   public function draw() {
      echo '<input>';
   }
}

class textarea extends fields {
   public function draw() {
      echo '<textarea>';
   }
} 
```

# objective-c - UIWebView & NavigationController 在加载时崩溃

> ID：12611913
> 
> 赞同：0
> 
> 时间：2012-09-26T23:23:33.047
> 
> 标签：objective-c, uiwebview, uinavigationcontroller, drilldown

我有一个很奇怪的问题

我用 UIWebView 和 NavigationController 构建了一个简单的应用程序，但问题是当第二个页面正在加载时，我回到第一页并访问了一个链接，应用程序崩溃并且控制台什么也没说

这是我完成加载的代码

```
-(void)webViewDidFinishLoad:(UIWebView *)aWebView {
    NSString *str = [aWebView stringByEvaluatingJavaScriptFromString:@"document.title"];
    self.navigationItem.title = str; 
     [navigationActivity stopAnimating];
} 
```

这对于网络视图应该开始加载

```
if(navigationType == UIWebViewNavigationTypeOther)
    {
        NSURL *url2 = [request URL];
        NSString *URLStr = [url2 absoluteString];

        RootViewController* viewController = [[RootViewController alloc] init];
        NSString *holder = [self getQueryStringInner:URLStr];
        [self getQueryString:URLStr];
        if([holder length] != 0 && [flag length] != 0 && !facebook )
        {

            appDelegate.title =@"Title"; 
            appDelegate.query = queryString;
            appDelegate.url = holder; 

            [self.navigationController pushViewController:viewController animated:YES];
            [viewController release];
            return NO;
        }
} 
```

我对 Objective-c 和 iOS 开发真的很陌生，所以任何帮助都将不胜感激

任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T08:16:02.073

似乎必要的步骤是在您的 viewWillDisappear 中调用 [webView stopLoading]。显然，Web 视图委托正在将 webViewDidFinishLoading 方法消息发送到已释放的实例。很高兴你解决了。

# gwt - 为什么 webappcreator 不运行？

> ID：12611918
> 
> 赞同：0
> 
> 时间：2012-09-26T23:23:59.230
> 
> 标签：gwt

我只是通过 Windows 上的说明运行： [https ://developers.google.com/web-toolkit/gettingstarted](https://developers.google.com/web-toolkit/gettingstarted)

```
$ ./webAppCreator -out MyWebApp com.mycompany.mywebapp.MyWebApp
java.lang.NoClassDefFoundError: com/google/gwt/user/tools/WebAppCreator
Caused by: java.lang.ClassNotFoundException: com.google.gwt.user.tools.WebAppCreator
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
Could not find the main class: com.google.gwt.user.tools.WebAppCreator.  Program will exit.
Exception in thread "main" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T18:26:45.987

尝试将 webAppCreator 所在的文件夹添加到您的 PATH 变量中，这样您就可以运行而无需在该文件夹中...而且您可能不使用 Cygwin，但不要使用 cygwin 命令行并使用常规的 Windows 命令行（我有使用 Cygwin 时同样的错误）

# c++ - 在 C++ 中使用键盘进行多个动作

> ID：12611925
> 
> 赞同：1
> 
> 时间：2012-09-26T23:24:40.690
> 
> 标签：c++, keyboard

我试图让我的球运动像流体一样运动。我怎么能得到当我按上键、下键、左键或右键时，它不向上移动一个单位，停止，然后继续移动。另外，我怎样才能让它同时向两个方向移动，而在松开钥匙时不停止另一个方向？谢谢

```
if(GetAsyncKeyState(VK_UP))
{
    if(g_nGameState == SETTINGUPSHOT_GAMESTATE || g_nGameState == INITIAL_GAMESTATE)
    {
        g_cObjectWorld.AdjustCueBallY(MOVEDELTA);
        g_cObjectWorld.ResetImpulseVector();
    }
}

if(GetAsyncKeyState(VK_DOWN))
{
    if(g_nGameState == SETTINGUPSHOT_GAMESTATE || g_nGameState == INITIAL_GAMESTATE)
    {
        g_cObjectWorld.AdjustCueBallY(-MOVEDELTA);
        g_cObjectWorld.ResetImpulseVector();
    }
}

if(GetAsyncKeyState(VK_LEFT))
{
    if(g_nGameState == SETTINGUPSHOT_GAMESTATE || g_nGameState == INITIAL_GAMESTATE)
    {
        g_cObjectWorld.AdjustCueBallX(-MOVEDELTA);
        g_cObjectWorld.ResetImpulseVector();
    }
}

if(GetAsyncKeyState(VK_RIGHT))
{
    if(g_nGameState == SETTINGUPSHOT_GAMESTATE || g_nGameState == INITIAL_GAMESTATE)
    {
        g_cObjectWorld.AdjustCueBallX(MOVEDELTA);
        g_cObjectWorld.ResetImpulseVector();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T23:22:56.997

你可以这样做：

使用 SetTimer 在您的窗口事件循环上创建一个计时器 10ms 间隔应该适合您想要的。它必须在窗口线程上的原因是 GetAsyncKeyState 从不同的线程调用时不会给你想要的结果。我们使用计时器，因为对 GetAsyncKeyState 的调用应该在不同的消息上，然后是键处理事件，因此键仍在队列中。

在计时器功能中，您可以执行以下操作

```
int deltaX = 0, deltaY = 0;

unsigned int downDown = GetAsyncKeyState(VK_DOWN);
unsigned int upDown = GetAsyncKeyState(VK_UP);
unsigned int leftDown = GetAsyncKeyState(VK_LEFT);
unsigned int rightDown = GetAsyncKeyState(VK_RIGHT);

if(downDown & 0x00008000)deltaY -= MOVEDELTA;
if(upDown & 0x00008000)deltaY += MOVEDELTA;
if(leftDown & 0x00008000)deltaX -= MOVEDELTA;
if(rightDown & 0x00008000)deltaX += MOVEDELTA;

g_cObjectWorld.AdjustCueBallX(deltaX);
g_cObjectWorld.AdjustCueBallY(deltaY);
g_cObjectWorld.ResetImpulseVector(); 
```

通过这种方式，您还可以确保在 keyup 时停止移动 (deltaX == 0 && deltaY == 0) 我不确定 AdjustCueBall(X|Y) 的语义是什么，但如果你确保它们停止移动当他们得到 0 时，这个方向应该可以正常工作。

此外，您应该注意到，您的键盘必须支持硬件中的多个按键，以便您能够使用两个键沿对角线移动 - 如果可以，上述解决方案将有效，如果不支持，您仍然可以在其中任何一个中移动四个基本方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T23:31:02.997

一种设计是仅将键盘用于**改变**方向。

让球继续沿其当前方向前进，直到收到会改变其方向的按键。这减少了处理器上的负载，不会被按键连续中断。

至于非正交方向，使用更多键。看一个“键盘”。一些键是“5”键的对角线。使用那些。

# grails - 带有 aspectj 和/或 Groovy AOP 的 Grails AOP 最好使用注解

> ID：12611931
> 
> 赞同：4
> 
> 时间：2012-09-26T23:25:34.013
> 
> 标签：grails, groovy, aspectj, abstract-syntax-tree

在我们的企业应用程序中，我们希望将诸如日志记录、度量等横切关注点作为方面。我们已经准备好 aspectj 建议（来自我们现有的 java 应用程序），但我没有找到将 aspectj 与 Grails 集成的方法。

我已经知道`beforeInterceptor`and `afterInterceptor`，但是这些需要在所有控制器和服务中完成，有没有更简单的方法来做到这一点。

我的首选方法是为`@Metrics`我的 grails 应用程序中的任何方法创建注释，并且应该得到建议。有没有人这样做，任何链接/资源/示例都会很棒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T21:07:44.147

也许你可以看看 Grails*过滤器*，它可用于横切关注点，如日志记录等： http: [//grails.org/doc/2.1.0/ref/Plug-ins/filters.html](http://grails.org/doc/2.1.0/ref/Plug-ins/filters.html)

关于注释的使用，也许这篇文章会有所帮助，但我没有检查过：http: [//manbuildswebsite.com/2010/03/15/simple-aspects-using-annotations-in-grails/](http://manbuildswebsite.com/2010/03/15/simple-aspects-using-annotations-in-grails/)

祝你好运。

# c++ - 分段错误尝试使用凸性缺陷的结果

> ID：12611944
> 
> 赞同：2
> 
> 时间：2012-09-26T23:27:01.717
> 
> 标签：c++, opencv, segmentation-fault, openni

我正在尝试使用带有 OpenNi 和 OpenCV 2.4 库的 kinect 来做一个用于指尖识别的 C++ 程序。

在这里我列出了我的主要功能（我故意避免在这里写下可能不是错误原因的其他功能/类）：

```
// xml to initialize OpenNI
#define SAMPLE_XML_PATH "/home/jacopo/workspace/opencv_fingertip_detector/Sample-Tracking.xml"

int main(int argc, char ** argv)
{
    XnStatus rc = XN_STATUS_OK;
    xn::EnumerationErrors errors;

    // Initialize OpenNI
    rc = g_Context.InitFromXmlFile(SAMPLE_XML_PATH, g_ScriptNode, &errors);
    CHECK_ERRORS(rc, errors, "InitFromXmlFile");
    CHECK_RC(rc, "InitFromXmlFile");

    rc = g_Context.FindExistingNode(XN_NODE_TYPE_DEPTH, g_DepthGenerator);
    CHECK_RC(rc, "Find depth generator");
    rc = g_Context.FindExistingNode(XN_NODE_TYPE_HANDS, g_HandsGenerator);
    CHECK_RC(rc, "Find hands generator");
    rc = g_Context.FindExistingNode(XN_NODE_TYPE_GESTURE, g_GestureGenerator);
    CHECK_RC(rc, "Find gesture generator");

    XnCallbackHandle h;
    if (g_HandsGenerator.IsCapabilitySupported(XN_CAPABILITY_HAND_TOUCHING_FOV_EDGE))
    {
        g_HandsGenerator.GetHandTouchingFOVEdgeCap().RegisterToHandTouchingFOVEdge(TouchingCallback, NULL, h);
    }

    XnCallbackHandle hGestureIntermediateStageCompleted, hGestureProgress, hGestureReadyForNextIntermediateStage;
    g_GestureGenerator.RegisterToGestureIntermediateStageCompleted(GestureIntermediateStageCompletedHandler, NULL, hGestureIntermediateStageCompleted);
    g_GestureGenerator.RegisterToGestureReadyForNextIntermediateStage(GestureReadyForNextIntermediateStageHandler, NULL, hGestureReadyForNextIntermediateStage);
    g_GestureGenerator.RegisterGestureCallbacks(NULL, GestureProgressHandler, NULL, hGestureProgress);

    // Create NITE objects
    g_pSessionManager = new XnVSessionManager;
    rc = g_pSessionManager->Initialize(&g_Context, "Click,Wave", "RaiseHand");
    CHECK_RC(rc, "SessionManager::Initialize");

    g_pSessionManager->RegisterSession(NULL, SessionStarting, SessionEnding, FocusProgress);

    g_pDrawer = new XnVPointDrawer(20, g_DepthGenerator);
    g_pFlowRouter = new XnVFlowRouter;
    g_pFlowRouter->SetActive(g_pDrawer);

    g_pSessionManager->AddListener(g_pFlowRouter);

    g_pDrawer->RegisterNoPoints(NULL, NoHands);
    g_pDrawer->SetDepthMap(g_bDrawDepthMap);

    // Initialization done. Start generating
    rc = g_Context.StartGeneratingAll();
    CHECK_RC(rc, "StartGenerating");

    cv::Mat depthshow;
    int key_pre = 0 ;

    for( ; ; )
    {
        if (key_pre == 27)
            break ;
        XnMapOutputMode mode;
        g_DepthGenerator.GetMapOutputMode(mode);

        g_Context.WaitOneUpdateAll(g_DepthGenerator);

        //TEST
        g_DepthGenerator.GetMetaData(depthMD);
        XnDepthPixel* pDepth = depthMD.WritableData();

        // Update NITE tree
        g_pSessionManager->Update(&g_Context);

        if(g_pDrawer->handFound)
        {
            for (XnUInt y = 0; y < depthMD.YRes(); ++y)
            {
                for (XnUInt x = 0; x < depthMD.XRes(); ++x, ++pDepth)
                {

                    if (*pDepth>g_pDrawer->pt3D.Z+50 || *pDepth<g_pDrawer->pt3D.Z-50)
                    {
                        *pDepth=0;
                    }

                }
            }
        }

        //for opencv Mat
        cv::Mat depth16(480,640,CV_16SC1,(unsigned short*)depthMD.WritableData());

        //convert depth 11 bit image 2 8 bit image
        //depth16.convertTo(depthshow,CV_8U,-255/4096.0,255);
        depth16.convertTo(depthshow, CV_8UC1, 0.025);

        if(g_pDrawer->handFound)
        {
            cv::Point handPos(g_pDrawer->ptProjective.X, g_pDrawer->ptProjective.Y);
            cv::circle(depthshow, handPos, 5, cv::Scalar(0xffff), 10, 8, 0);
            Mat src_gray;
            int thresh = 10;
            RNG rng(12345);

            blur( depthshow, src_gray, Size(3,3) );

            Mat threshold_output;
            vector<vector<Point> > contours;
            vector<Vec4i> hierarchy;

            /// Detect edges using Threshold
            threshold( src_gray, threshold_output, thresh, 255, THRESH_BINARY );

            /// Find contours
            findContours( threshold_output, contours, hierarchy, CV_RETR_TREE, CV_CHAIN_APPROX_SIMPLE, Point(0, 0) );

            /// Find the convex hull object for each contour
            vector<vector<int> > hullsI (contours.size());
            vector<vector<Point> >  hullsP (contours.size() );
            vector<vector<Vec4i> >  defects (contours.size() );

            for( int i = 0; i < contours.size(); i++ )
            {
                convexHull(contours[i], hullsI[i], false, false);
                convexHull(contours[i], hullsP[i], false, true);
                if (contours[i].size() >3 )
                {
                    convexityDefects(contours[i], hullsI[i], defects[i]);
                }
            }

            /// Draw contours + hull results
            Mat drawing = Mat::zeros( threshold_output.size(), CV_8UC3 );

            for( int i = 0; i < defects.size(); i++)
            {
                Vec4i defect(defects[i][0]);
                Point start = contours[i][defect[0]];
                Point end = contours[i][defect[1]];
                Point far = contours[i][defect[2]];
                std::cout << "Roba mia: "<< start << "\t" << end << "\t" << far << std::endl;
                line(drawing, start, end, Scalar( 255, 0, 0 ), 1);
                circle(drawing, far, 5, Scalar( 255, 0, 0 ), 1);
            }

            for( int i = 0; i < contours.size(); i++ )
            {
                Scalar color = Scalar( 255, 0, 0 );
                drawContours( drawing, contours, i, color, 1, 8, vector<Vec4i>(), 0, Point() );
                drawContours( drawing, hullsP, i, color, 1, 8, vector<Vec4i>(), 0, Point() );
            }

            /// Show in a window
            namedWindow( "Hull demo", CV_WINDOW_AUTOSIZE );
            imshow( "Hull demo", drawing );

        }

        cv::imshow("PrimeSense Nite Point Viewer", depthshow);
        key_pre = cv::waitKey(33);

    }
    cv::destroyWindow("PrimeSense Nite Point Viewer");
    CleanupExit();
    return 0;
} 
```

当我尝试使用其中一个变量时会发生分段错误`start`，`end`或者`far`，如果我在分配三个变量后立即注释三行（和） `std::cout`，则代码正常运行而没有问题。`line``circle`

你们中有人知道如何解决这个问题吗？

谢谢阅读

J。

# icu - 如何使用 uconv 将地名列表转换为 ASCII？

> ID：12611945
> 
> 赞同：2
> 
> 时间：2012-09-26T23:27:09.283
> 
> 标签：icu

我正在尝试将地名字符串“智能”转换为 ASCII。我想我正在寻找的是音译。我能够使用“uconv”工具获得一些令人鼓舞的结果：

假设我的输入是“Emberá”：

```
uconv -x Latin-ASCII input.dat > output.dat 
```

相应的输出将是“Embera”——正是我想要的。但是在某些情况下，我没有得到预期的结果，（也许如果输入不是以拉丁语开头？）。例如，检查这个地方（我无法将名称正确复制并粘贴到此文本框中）[http://maps.google.ca/maps?q=karpos+macedonia&hl=en&ie=UTF8&hnear=Karpo%C5%A1 ,+马其顿+(FYROM)&t=m&z=12](http://maps.google.ca/maps?q=karpos+macedonia&hl=en&ie=UTF8&hnear=Karpo%C5%A1,+Macedonia+(FYROM)&t=m&z=12)。

理想情况下，这将被音译为“Karpos”（我认为），但如果我将其用作 uconv 的输入，使用上述命令，uconv 根本不会修改它。

所以给定一个地名列表（如果有人好奇，这里是列表-- [http://www.mediafire.com/file/gb0guu117yp1p26/test.dat](http://www.mediafire.com/file/gb0guu117yp1p26/test.dat)），我如何将它们转换为ASCII？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T20:51:28.323

尝试`-x 'Any-Latin;Latin-ASCII'` 您还可以将`--to-callback escape-unicode -t ascii` 输出中的所有内容强制添加到 ascii，否则类似于`{U+3045}`.

请注意，“智能”在这里是……相对的。您正在剥离大量信息并经过几层翻译。这不会有太大帮助，但是`-x 'el-en;Any-Latin;Latin-ASCII'`如果您知道文本是从希腊语到英语（即 el-en），那么您可以尝试使用特定语言的音译。

# javascript - jquery 表单验证和提交更改

> ID：12611948
> 
> 赞同：0
> 
> 时间：2012-09-26T23:27:27.380
> 
> 标签：javascript, jquery, forms, jquery-plugins

我想让我网站上的所有设置表单确认更改已保存，有点像 Facebook 所做的，如果您在表单中进行更改，然后尝试在不保存的情况下导航离开。所以我禁用表单上的提交按钮，仅在值更改时启用。然后我提示用户在他们离开页面之前点击保存，以防他们确实有待处理的更改。

```
var form = $('form.edit');
if(form.length > 0) {
  var orig_str = form.serialize();
  $(':submit',form).attr('disabled','disabled');
  form.on('change keyup', function(){
    if(form.serialize() == orig_str) {
      setConfirmUnload(false);
      $(':submit',form).attr('disabled','disabled');
    } else {
      setConfirmUnload(true);
      $(':submit',form).removeAttr('disabled')
    }
  });
  $('input[type=submit]').click(function(){ setConfirmUnload(false); });
}
function setConfirmUnload(on) {
  window.onbeforeunload = (on) ? unloadMessage : null;
}
function unloadMessage() {
  return 'If you navigate away from this page without saving your changes, they will be lost.';
} 
```

其中一种形式需要我使用 jQuery.validate 库进行的一些额外验证。例如，如果我想确保用户不能通过双击提交或类似的方式意外双重提交表单（有问题的实际验证是针对信用卡表单而不是这么简单）：

```
$('form').validate({
  submitHandler: function(form) {
    $(':submit', form).attr('disabled','disabled');
    form.submit();
  }
}); 
```

不幸的是，这两个位都试图绑定到提交按钮，并且它们相互干扰，因此无论我做什么，提交按钮都保持禁用状态，根本不可能提交表单。

有什么方法可以将验证链接在一起吗？或者其他方式来避免重写验证代码以重复“您是否更改了表单中的任何内容”业务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T02:34:44.757

不确定您的解决方案有什么问题，但这里似乎可行：

```
<!doctype html><!-- HTML5 ROCKS -->
<html>
<head>
<title>Usable Forms</title>
</head>
<body>

<form id="my_form" action="http://www.google.com/search">
  <input type="text" name="query">
  <input type="submit" disabled>
</form>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js">
</script>
<script>
var my_form = $('#my_form');
var original_form_values = my_form.serialize();

// Returns true if the contents of #my_form have changed since the page was
// loaded.
function MyFormChanged() {
  return my_form.serialize() != original_form_values;
}

var submitting = false;

// Warn of unsaved changes if the user tries to navigate away.
window.onbeforeunload = function() {
  // Don't stop the submission.
  if (submitting) {
    return;
  }

  if (MyFormChanged()) {
    return 'You have unsaved changes.';
  }

  // Not submitting, nor has form changed;
  // therefore, it is safe for the user to navigate away.
}

$('#my_form').on('submit', function() {
  // Just in case submit button isn't disabled for some reason.
  $('#my_form input[type=submit]').attr('disabled', '');

  if (!MyFormChanged()) {
    return false;
  }

  if (submitting) {
    return false;
  }

  submitting = true;
  return true;
});

// Toggle submit button, depending on whether there are any changes to submit.
$('#my_form input').on('change keyup', function() {
  if (!submitting && MyFormChanged()) {
    // Enable submit button.
    $('#my_form input[type=submit]').removeAttr('disabled');
  } else {
    // Disable submit button.
    $('#my_form input[type=submit]').attr('disabled', '');
  }
});
</script>

</body>
</html> 
```

# ruby-on-rails - 从视图运行 Rails rake 任务并在视图中生成 rake 任务结果？

> ID：12611950
> 
> 赞同：0
> 
> 时间：2012-09-26T23:27:53.170
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rake, rake-task

我正在尝试帮助非技术用户运行特定的 rails rake 任务，并能够在他们的浏览器中查看 rake 任务的结果。

以下是我的 rake 任务代码：

```
namespace :partner do

  task :report => :environment do
    csv_output = Partner.generate_report
    csv_output.split("\n").each {|row| puts row}
  end

  task :sample_report => :environment do
    csv_output = Partner.generate_report(30)
    csv_output.split("\n").each {|row| puts row}
  end
end 
```

目前我只运行 rake partner:report 并且终端中显示了一堆数据，但我希望他们能够在视图页面上按下按钮，运行 rake 任务，然后直接在视图中查看结果。

任何想法或建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:37:00.963

您可能希望为此目的查看后台任务宝石。

看看这些：

[https://github.com/defunkt/resque](https://github.com/defunkt/resque)

[http://mperham.github.com/sidekiq/](http://mperham.github.com/sidekiq/)

[https://github.com/collectiveidea/delayed_job](https://github.com/collectiveidea/delayed_job)

# .net - 实体框架代码首先使用 TimeStamp 类型

> ID：12611960
> 
> 赞同：8
> 
> 时间：2012-09-26T23:28:29.440
> 
> 标签：.net, sql-server-2008, entity-framework, asp.net-4.0, entity-framework-5

我正在使用 SQL Server 2008 R2 和 Entity Framework 5.0。生成数据库时，我无法添加 TimeStamp 类型的属性而不会出现以下错误：没有与概念侧类型对应的存储类型

> 原始类型“时间”的“Edm.Time(Nullable=True,DefaultValue=,Precision=)”。

我已将实体配置设置为类型时间或时间戳但没有成功

```
Property(x => x.RestBetweenSet).HasColumnType("timestamp"); 
```

当我进入 Sql Server Management Studio 并编辑表格时，我可以设置一列时间戳。

我需要做什么才能让 Entity Framework 代码首先能够生成此列？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-26T23:33:03.087

您应该在代码第一类中声明您的时间戳属性，如下所示：

```
[Timestamp] 
public Byte[] MyTimestamp { get; set; } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-01T13:12:09.993

目前，我映射到 INT64 并忽略时间戳。就像在这篇[文章](https://stackoverflow.com/questions/8503825/what-is-the-correct-sql-type-to-store-a-net-timespan-with-values-240000)中一样。

如果它们是更好的解决方案，请随时添加。我还不接受我的回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-16T09:44:36.093

我不确定我是否理解你的问题，但这就是我使用方法和 生成`timestamp`字段的方式`code first``entity framework`

```
[Required, DatabaseGenerated(DatabaseGeneratedOption.Computed)]
public DateTime CreatedAt { get; set; } 
```

# iphone - 如何从 NSDictionaries 的 NSArray 中读取值

> ID：12611961
> 
> 赞同：0
> 
> 时间：2012-09-26T23:29:01.137
> 
> 标签：iphone, ios, core-data

我有一个 NSDictionary 值的数组，当 NSLogged 时看起来像这样

```
{
 HASMOD = F;
 ISLOCKED = F;
 ISREGD = F;
 MANU = "HORNET";
 ID = 706;
},
 {
 HASMOD = T;
 ISLOCKED = F;
 ISREGD = T;
 MANU = "BANJI";
 ID = 225;
},
//etc 
```

我正在尝试将这些值保存到我的核心数据对象（使用正确的类型）。我一直在关注本[教程](http://goo.gl/wF5h1)，并且已经到了尝试将值插入每个对象的地步，但是我不确定如何从字典数组中执行此操作..因为它只显示了如何输入一个批次信息

所以我自己尝试过这样做......但它比任何东西都更像伪代码......这就是我所做的......希望它有助于理解我想要实现的目标。

```
// WRITE TO CORE DATA
    NSManagedObjectContext *context = [self managedObjectContext];
    Manuf *manuf = [NSEntityDescription insertNewObjectForEntityForName:@"Manuf" inManagedObjectContext:context];

    int mycount = [parsedDataArrayOfDictionaries count];

    while (mycount != 0) {

        // Somehow read Dictionaries and put them into their correct value types
        BOOL hasModBool;
        hasModelBool =

        BOOL isLockedBool;
        isLockedBool =

        BOOL isRegedBool;
        isRegedBool =

        NSString *manuString = [[NSString alloc] init];
        manuString =

        int manuIDInt;
        manuIDInt =

        // pass all the values into the manuf coredata obj
        manuf.hasMod = hasModBool;
        manuf.isLocked = isLockedBool;
        manuf.isReged = isRegedBool;
        manuf.manu = manuString;
        manuf.manuID = manuIDInt;

        count --; // itterate through the array
    } 
```

我希望有人可以帮助我遍历字典数组并将它们插入到我的核心数据对象的变量中。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T00:38:16.957

只需使用 for-in 循环遍历您的数组，并使用 valueForKey: 获取值。

```
for (NSDictionary *dict in parsedDataArrayOfDictionaries) {
     Manuf *manuf = [NSEntityDescription insertNewObjectForEntityForName:@"Manuf" inManagedObjectContext:context];
     BOOL hasModelBool;
     BOOL isLockedBool;
     BOOL isRegedBool;
     if([dict valueForKey:@"HASMOD"] isEqualToString:@"T"]) {
        hasModelBool = TRUE;
     }else{
        hasModelBool = FALSE;
     if([dict valueForKey:@"ISLOCKED"] isEqualToString:@"T"]) {
        isLockedBool = TRUE;
     }else{
        isLockedBool = FALSE;
     ......
     ......
     // pass all the values into the manuf coredata obj
    manuf.hasMod = hasModBool;
    manuf.isLocked = isLockedBool;
    manuf.isReged = isRegedBool;
    manuf.manu = manuString;
    manuf.manuID = manuIDInt;
} 
```

我在这里假设字典中的“T”或“F”值是需要转换为 TRUE 或 FALSE 的字符串。

# c# - 如何实现 WPF 导航控件呈现各种派生类型的框架，所有这些都使用 UserControl 作为基础

> ID：12611964
> 
> 赞同：0
> 
> 时间：2012-09-26T23:29:40.560
> 
> 标签：c#, .net, wpf, xaml, user-controls

所以我有一个场景，我想实现一个从 UserControl 派生的 WPF NavigationControl。在那个 NavigationControl 上，我有两个要求，处理后退/前进导航的历史记录（足够简单），并且能够直观地呈现从 NavigationFrameBase 类型派生的任何控件。同样从 UserControl 派生的 NavigationFrameBase 可以以多种形式呈现，因为多个控件将从该类型继承，但是 NavigationFrameBase 应该向 NavigationControl 提供一种通知形式，以通知它用户与从 NavigationFrameBase 派生的类型的内容进行交互具有请求了 Navigate 操作，允许 NavigationControl 呈现新的 NavigationFrameBase。

我的问题有两个：

*   设计 NavigationControl 以包含它将呈现的 NavigationFrameBase 实例的最佳方法是什么
*   WPF中处理子->父请求系统的正确方法是什么？路由/附加事件似乎是正确的，但我可以看到一个中介模式服务于相同的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T00:59:23.093

这取决于您期望父母和孩子之间如何进行交流。如果这只是 NavigationControl 侦听事件并做出反应的问题，那么简单的事件处理模式就可以工作。

但是，如果您需要 NavigationControl 来影响 NavigationFrames（例如，禁用/启用或在下拉菜单的情况下，您需要在另一个打开时关闭任何打开的下拉菜单等）或允许一个 NavigationFrame要影响同级，则需要使用中介模式，或在 NavigationFrameBase 上公开回调方法来处理这些操作。

如果不了解更多关于您预期的用例，很难为您提供比这更多的细节。

# javascript - HTML表单页面重定向不起作用

> ID：12611968
> 
> 赞同：3
> 
> 时间：2012-09-26T23:30:00.527
> 
> 标签：javascript, html

我的企业内部网站上有一个在线表格。提交表单后，表单会通过 Javascript 脚本进行错误检查。如果一切顺利，则将其发送到电子邮件进行评估，并且该页面应该重定向到确认页面。但是，当我单击发送时，电子邮件被发送，但页面没有改变。这是我遇到问题的代码：

```
emailForm(myForm, myForm.emailTo.value, myForm.emailSubject.value, myForm.emailLevel.value, 'server'),
location.href = formsubmitted.html; 
```

如果我删除 emailForm 函数，它将重定向页面。相同的代码适用于我拥有的其他形式，所以我不确定它为什么阻止我。我已经用完了所有资源，不知道如何解决这个问题。请帮忙。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T03:10:32.320

`emailForm`通话结束时可能是逗号而不是分号吗？

# javascript - 如何找到内存泄漏并调试 jquery/javascript 应用程序？

> ID：12611969
> 
> 赞同：6
> 
> 时间：2012-09-26T23:30:02.467
> 
> 标签：javascript, jquery, debugging, memory, jquery-mobile

我正在尝试调试一个用 jquery mobile 编写的相当大的应用程序，并且正在努力确定可疑的内存泄漏。 

我一直在上下运行所有​​功能的应用程序中穿梭。一直以来，服务器内存使用都还可以，除了一页之外的所有页面都可以正常工作。

在有问题的页面上（小部件繁重的产品搜索和订单页面，使用 JQM photoswipe、multiview 以及一堆其他插件）都可以正常工作一段时间，直到大多数按钮停止工作。 

按钮没有反应告诉我我需要检查我的 jquery 应用程序管理器，它还处理所有事件绑定。问题是，大约 90k，我真的不知道从哪里开始，所以

**问题**：是否有任何工具可以检查 Jquery/Javascript 是否存在潜在的内存泄漏？我还能做些什么来尝试解决问题？

感谢您的一些见解

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T01:03:53.293

您可能想查看 Chrome 开发人员工具提供的一些内容。我已经完成了内存分析并以这种方式识别了一些内存泄漏：

*   [https://developers.google.com/chrome-developer-tools/docs/heap-profiling](https://developers.google.com/chrome-developer-tools/docs/heap-profiling)
*   [https://developers.google.com/chrome-developer-tools/docs/heap-profiling-dom-leaks](https://developers.google.com/chrome-developer-tools/docs/heap-profiling-dom-leaks)

# ruby-on-rails - 重用rails上的视图

> ID：12611970
> 
> 赞同：2
> 
> 时间：2012-09-26T23:30:04.530
> 
> 标签：ruby-on-rails, ruby, views

我找不到使用其他视图的视图的方法。

我想我可以用这个例子更好地解释它：我有两个控制器，`IndexController`并且`UserController`. 用户控制器有一个`login`通过其视图调用的操作，该操作呈现登录表单并在其表单中的帖子发生时验证用户。

在`IndexController`中，有一个称为`home`呈现主页视图的操作。在这个视图中，我想渲染`loginform`，但我想重新使用用户/登录视图。

在我使用的几乎所有框架中，都有一种方法可以调用另一个控制器操作，以重用和隔离逻辑。

我发现，在 Rails 中，有一个助手`render`可以通过以下方式调用：

```
render 'user/login' 
```

或者

```
render :template => 'user/login' 
```

在这两种情况下，我只会收到诸如“路由索引/登录不存在”或“控制器索引必须登录操作”之类的错误。此外，我将登录视图文件名设置为`login`或`_login`。（我读到它用于部分视图。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T23:41:09.083

您可以通过在您的视图文件夹中创建一个共享文件夹并将登录表单创建为部分来做到这一点。

所以你的登录部分可能是这样的。

/app/views/shared/_loginform.html.erb：

```
<div id="loginform">        
    <%= form_for(resource, :as => resource_name, :url => session_path(resource_name)) do |f| %>
      <%= f.text_field :email %>
      <%= f.password_field :password %>
      <%= f.submit "Login" %>
    <% end %>
    <div id="loginlinks">
      <%= link_to "Become a member", new_member_registration_path %> <br />
      <%= link_to "Forgot Password?", new_member_password_path %>
    </div>
</div> 
```

然后在您看来，只需致电：

```
<%= render "shared/loginform"  %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T23:54:36.810

你应该看看 Railscast：“ [#269 模板继承](http://railscasts.com/episodes/269-template-inheritance)”。

从 Rails 3.1 开始，控制器继承现在也适用于视图。这比旧的“共享文件夹”策略更受欢迎。

简而言之，您将共享的部分放入，`app/views/application`然后您可以在资源特定的视图目录（例如`app/views/users`）中覆盖它们。

# php - Mysql db未更新到指定时区

> ID：12611972
> 
> 赞同：0
> 
> 时间：2012-09-26T23:30:17.947
> 
> 标签：php, mysql, apache, amazon-ec2

我在 php.ini 文件中将时区指定为东海岸时间：

```
[Date]
; Defines the default timezone used by the date functions
; http://php.net/date.timezone
date.timezone = America/New_York

$ service apache2 restart 
```

但是我的数据库日期时间条目指定了西部时间（落后 3 小时）。当我在 MySQL 控制台中查看时区时，它显示的是 SYSTEM，我一直认为它来自服务器上运行的任何脚本语言。在 apache2.conf 中，我知道更改时区的方法，所以那里什么也没有。

任何人都知道如何让我的条目走上正确的轨道，而不必在我的共享服务器上运行的每个 php 文件中指定正确的时区？如果有什么安慰的话，我正在美国西部 - 俄勒冈地区运行一个 EC2 实例。我可以在我的 EC2 控制台仪表板中更改任何内容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T01:59:02.237

> “在 MySQL 控制台中，它显示 SYSTEM，我一直认为它来自服务器上运行的任何脚本语言”。

不是这样，很抱歉。@Nelson 是对的。MySQL 从 mysqld 服务器机器的默认时区设置中获取其默认时区。脚本语言的时区设置与案例无关。

您的 mysqld 是否在您的 EC2 实例中运行？如果是这样，您需要更改该操作系统实例的默认时区设置。你可以看看如何做到这一点。您可能会发现在更改默认时区后重启 EC2 实例很有帮助。

为了尽量减少混淆，最好将系统时区设置为 UTC（也称为 Z 或祖鲁时间，以前称为格林威治标准时间）。这样，当夏令时开始或关闭时，事情就不会反弹。

# c++ - C++ 输出 * 表

> ID：12611974
> 
> 赞同：-1
> 
> 时间：2012-09-26T23:30:30.500
> 
> 标签：c++

我正在尝试在 C++ 中创建一个表格，询问您的边长并输出一个星形表格。

有人能指出我应该做些什么来让表格开始正确显示吗？

输入：

```
Enter length of side: 5 
```

想要的输出：

```
*****
*   *
*   *
*   *
*   *
***** 
```

到目前为止，我输出*的第一行减一，然后显示您输入的数字。

```
#include "main.h"
using namespace std;

    int main () {
      int sideLength;
      cout << "Enter lengh of side: ";
      cin >> sideLength;
      cout.fill('*');
      cout.width(sideLength);
      cout << sideLength << endl;
      return 0;
    } 
```

非常感谢，刚刚学习 c++

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:48:50.560

我还没那么可爱呢。也许我可以想出更好的东西...

```
#include <iostream>
#include <algorithm>
#include <iterator>

int main()
{
    int size;
    if (std::cin >> size) {
        auto to(std::ostreambuf_iterator<char>(std::cout));
        auto line([=](decltype(to) to){ return std::fill_n(to, size, '*'); });
        auto box([=](decltype(to) to){
                *to++ = '*'; std::fill_n(to, size - 2, ' '); *to++ = '*'; return to;
            });
        *(to = line(to))++ = '\n';
        for (int i(1); ++i < size; ) {
            *(to = box(to))++ = '\n';
        }
        *(to = line(to))++ = '\n';
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:38:53.833

您也应该添加一个循环来打印侧面和底部。
建议：

```
for (int i=0; i <= sideLength; i++)  
{
cout<<endl <<"*";
for (int j=0; j < sideLength;j++) 
{
cout<<" ";
cout<<"*";
}
cout.fill('*'); 
```

在 cout.fill('*') 之后添加这些行。
也许它会起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T23:41:09.853

你可以这样做：

```
#include <iostream>
using namespace std;

int main () {
  int sideLength;
  cout << "Enter lengh of side: ";
  cin >> sideLength;

  for (int i = 0; i < sideLength; i++)
    cout<<"*";

  cout<<"\n";

  for (int i = 0; i < sideLength-2; i++) 
  {
    cout<<"*";

    for (int j = 0; j < sideLength-2; j++)
      cout<<" ";

    cout<<"*"<<"\n";
  }

  for (int i = 0; i < sideLength; i++)
    cout<<"*";

  cout<<"\n";

  return 0;
} 
```

# iphone - iPhone 4 和 XCode 4 上的霓虹点积问题

> ID：12611977
> 
> 赞同：2
> 
> 时间：2012-09-26T23:30:56.070
> 
> 标签：iphone, xcode, neon

我正在尝试使用霓虹灯在 iPhone 4 上实现点积功能。基于本教程： http: [//www.delmarnorth.com/microwave/requirements/neon-test-tutorial.pdf](http://www.delmarnorth.com/microwave/requirements/neon-test-tutorial.pdf) 我在 XCode 4.5 中尝试了以下内容。当我设置 nruns=1 时，它可以工作，即，我从霓虹灯中得到与标准 C++ 版本相同的答案。但是，当我设置 nruns > 1 时，某些东西会损坏并出现垃圾（例如，如果我在第一次调用 dotProduct() 后打印出 a 数组的元素，它们就会损坏）。我不得不承认我没有使用霓虹灯的经验，但我所需要的就是能够做这个点积！有人有什么想法吗？

```
 float dotProduct ( float *a, float *b, int n) {
        float sum=0.0f;
        __asm__ volatile (
                          "vmov.f32 q8, #0.0               \n\t"
                          "vmov.f32 q9, #0.0               \n\t"
                          "1:                             \n\t"
                          "subs %3, %3, #8                \n\t"
                          "vld1.f32 {d0,d1,d2,d3}, [%1]!      \n\t"
                          "vld1.f32 {d4,d5,d6,d7}, [%2]!      \n\t"
                          "vmla.f32 q8, q0, q2              \n\t"
                          "vmla.f32 q9, q1, q3              \n\t"
                          "bgt 1b                         \n\t"
                          "vadd.f32 q8, q8, q9              \n\t"
                          "vpadd.f32 d0, d16, d17           \n\t"
                          "vadd.f32 %0, s0, s1              \n\t"
                          : "=w"(sum)
                          : "+r"(a), "+r"(b), "+r"(n)
                          : "q0", "q1", "q2", "q3", "q8", "q9");
        return sum;
    }

    void test_dotProduct_neon()
    {
        int n=16, i, k;
        int nruns = 2;
        float dp;
        float *a = new float[n];
        float *b = new float[n];
        for (i=0; i < n; i++) {
           a[i] = (float) i; 
           b[i] = (float) (2*i);
        }
        for (i=0; i<nruns; i++) {
           dp=0.0f;
           for( k=0; k < n; k++) {
               dp += a[k] * b[k];
            }
        }
        printf(" C Result:   %f\n", dp );
        for (i=0; i<nruns; i++) {
            dp = dotProduct( a, b, n);
        }
        printf(" Neon Result:   %f\n", dp );
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T13:01:32.623

您的 NEON 代码会修改指针“a”和“b”，因为您的加载指令 (vld1) 会增加地址寄存器（这就是地址后的“！”）。

据推测，正在发生的事情是编译器没有意识到这些值可能会改变，因此您的代码第二次使用虚假指针值。

您确实用“+”标记了这些内联汇编输入，这意味着“输入/输出操作数”，但我认为您需要在*输出*操作数部分中列出它们，而不是在第二*输入*操作数中列出它们才能工作。您的代码应阅读

```
: "=w"(sum), "+r"(a), "+r"(b), "+r"(n)
: /* No inputs */
: "q0", "q1", "q2", "q3", "q8", "q9" 
```

此外，输入、输出和破坏寄存器的集合*不是不*相交的！将寄存器标记为已破坏并不会阻止编译器将其用作输入寄存器 AFAIR，因为它假定在发生破坏*之前*已消耗输入。现在，由于您的输入是 ARM 寄存器，而您的破坏寄存器是 NEON 寄存器，因此**如果**输出与破坏寄存器的情况并非如此，那么您应该是安全的。我建议您检查[http://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html](http://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html)以确定。

**编辑：**您的代码似乎是正确的，即使`sum`碰巧存在于其中一个被破坏的寄存器中，因为您从未读过它，它只在最后写入它。我之前在写上面的警告时错过了这一点。

**编辑：**您的内联程序集传递指针`a`而`b`不是作为内存区域（使用`m`-Constraint），而是作为通用寄存器中的普通值。因此，编译器不知道您实际上是在从这些内存位置*读取*数据，因此可能会错误地将您的程序集块从其他存储区移到这些位置。现在，由于您的内存区域具有可变大小，您不能轻易使用`m`-Constraints，因为它们假定大小是静态确定的。相反，您可以添加`"memory"`到 clobber 列表中，它告诉编译器程序集块从任意内存位置读取和写入。当您使用它时，您还应该添加“`cc`"，因为您的汇编块修改了条件代码寄存器（包含测试指令结果的寄存器）。然后输入/输出声明如下所示

```
: "=w"(sum), "+r"(a), "+r"(b), "+r"(n)
: /* No inputs */
: "q0", "q1", "q2", "q3", "q8", "q9", "cc", "memory" 
```

在编写内联汇编块时，请始终记住编译器不会，绝对**不会**查看此类块的内容。关于块的行为和数据依赖关系的唯一信息来源是声明的输入和输出操作数，以及声明的 clobber 列表。并且编译器在优化时*会*积极地使用这些信息，特别是如果您使用`-O2`或更高版本进行编译。因此，这些声明中的任何遗漏都可能导致编译器生成不正确的代码。

# c - s390x 上的断点

> ID：12611978
> 
> 赞同：1
> 
> 时间：2012-09-26T23:30:59.717
> 
> 标签：c, linux, gdb, mainframe

我在 S390x 上的 GDB 工作

我有一个基本上可以做到这一点的功能：

```
Item *getItemFromRef( PrimaryDataStructure pds, size_t ref ) {
    Item *returnValue = NULL;
    SecondaryDataStructure sds = getSecondaryFromPrimary(pds, ref)
    if (sds) {
        returnValue = getItemFromRefSecondary(sds, ref);
    }
    return returnValue;
} 
```

我在`getItemFromRef`和上设置了断点`getItemFromRefSecondary`。`getItemFromRef`断点触发良好，但从不`getItemFromRefSecondary`触发。这是预期的吗？有什么办法让它着火吗？我究竟做错了什么？即使我禁用`getItemFromRef`.

编辑：使用 gdb 6.8.50

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T20:16:33.497

今天我又看了一下符号，发现两个不同的动态库正在导入相同的函数符号，并且断点被设置为函数的错误版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:35:56.920

有没有可能`getItemFromRefSecondary`在那一点被内联？当你进入它时它可能会报告内联函数名称（由于调试信息），但调试器只有在它真的是一个函数调用时才能中断。

您可以使用较少的优化（或没有，使用`-O0`）进行编译，或者如果这太侵入性，您可以强制该函数不内联`__attribute__((__noinline__))`（假设您使用 构建`gcc`）。

# audio - 在 C++ 或 C# 中为声卡生成音频

> ID：12611982
> 
> 赞同：2
> 
> 时间：2012-09-26T23:31:54.870
> 
> 标签：audio

我正在尝试为声卡生成音调（频率：1950 赫兹，持续时间：40 毫秒，电平：-30 分贝，右声道，在蒸汽 1 上）。有关如何使用 C++ 或 C# 完成此任务的任何建议。是否有任何库（C++ 或 C#）可以生成如此精确的音调？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-11-12T19:08:22.503

大卫，向扬声器播放音频是内置在 .NET 中的（我认为是在 .NET 2.0 框架中）。使用 System.Media.SoundPlayer，您可以从您构建的内存流中播放声音（WAV 格式）。这是我编写的一个函数，它在一定时间内播放一个简单的频率。关于分贝并将其发送到声卡，我真的不明白你指的是什么细节。例如，我无法理解以分贝为单位的音频是如何发送到声卡的。我的理解是，分贝只是衡量声音响度的指标，因此*在*它已被扬声器复制。因此，扬声器上的音量控制会影响您的声音产生的分贝，因此向声卡发送一定的分贝对我来说毫无意义。也许你需要更详细的东西，也许这对你不起作用。但也许你可以运行它并让它为你需要的东西工作。也许这几乎正是您要问的。

我在此代码中使用的过程允许构建您想要的任何音频并播放它。因此，如果需要，您可以使用此方法创建 2 个正弦波或更多，或三角波，甚至是语音合成。此方法获取经过计算的声音样本，然后播放这些样本，因此您需要对每个音频样本在给定时刻所需的内容进行编码。WAV 也允许立体声，但此代码示例仅使用非立体声。如果您想要立体声，则只需对其进行修改以生成立体声 WAV 格式的字节。我希望这不会太难。

快乐编码！

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Windows.Forms;

public static void PlayBeep(UInt16 frequency, int msDuration, UInt16 volume = 16383)
{
    var mStrm = new MemoryStream();
    BinaryWriter writer = new BinaryWriter(mStrm);

    const double TAU = 2 * Math.PI;
    int formatChunkSize = 16;
    int headerSize = 8;
    short formatType = 1;
    short tracks = 1;
    int samplesPerSecond = 44100;
    short bitsPerSample = 16;
    short frameSize = (short)(tracks * ((bitsPerSample + 7) / 8));
    int bytesPerSecond = samplesPerSecond * frameSize;
    int waveSize = 4;
    int samples = (int)((decimal)samplesPerSecond * msDuration / 1000);
    int dataChunkSize = samples * frameSize;
    int fileSize = waveSize + headerSize + formatChunkSize + headerSize + dataChunkSize;
    // var encoding = new System.Text.UTF8Encoding();
    writer.Write(0x46464952); // = encoding.GetBytes("RIFF")
    writer.Write(fileSize);
    writer.Write(0x45564157); // = encoding.GetBytes("WAVE")
    writer.Write(0x20746D66); // = encoding.GetBytes("fmt ")
    writer.Write(formatChunkSize);
    writer.Write(formatType);
    writer.Write(tracks);
    writer.Write(samplesPerSecond);
    writer.Write(bytesPerSecond);
    writer.Write(frameSize);
    writer.Write(bitsPerSample);
    writer.Write(0x61746164); // = encoding.GetBytes("data")
    writer.Write(dataChunkSize);
    {
        double theta = frequency * TAU / (double)samplesPerSecond;
        // 'volume' is UInt16 with range 0 thru Uint16.MaxValue ( = 65 535)
        // we need 'amp' to have the range of 0 thru Int16.MaxValue ( = 32 767)
        double amp = volume >> 2; // so we simply set amp = volume / 2
        for (int step = 0; step < samples; step++)
        {
            short s = (short)(amp * Math.Sin(theta * (double)step));
            writer.Write(s);
        }
    }

    mStrm.Seek(0, SeekOrigin.Begin);
    new System.Media.SoundPlayer(mStrm).Play();
    writer.Close();
    mStrm.Close();
} // public static void PlayBeep(UInt16 frequency, int msDuration, UInt16 volume = 16383) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-26T23:44:12.390

[NAudio](http://naudio.codeplex.com/)为 .NET 提供了一个强大的音频库。

> NAudio 是一个开源 .NET 音频和 MIDI 库，包含数十个有用的音频相关类，旨在加速 .NET 中音频相关实用程序的开发。它自 2002 年以来一直在开发中，并且已经发展到包括各种功能。虽然库的某些部分相对较新且不完整，但更成熟的功能已经过广泛的测试，可以快速用于将音频功能添加到现有的 .NET 应用程序中。可以使用 NuGet 将 NAudio 快速添加到您的 .NET 应用程序中。

这是一篇逐步介绍如何使用 NAudio 创建正弦波的文章。您可以在任何所需的持续时间内创建具有任何所需频率的正弦波：

[http://msdn.microsoft.com/en-us/magazine/ee309883.aspx](http://msdn.microsoft.com/en-us/magazine/ee309883.aspx)

# javascript - TypeError 为空？

> ID：12611983
> 
> 赞同：10
> 
> 时间：2012-09-26T23:32:04.083
> 
> 标签：javascript, jquery

这是我一直看到的 Firebug 中的一个错误。

```
TypeError: $("#gallery-nav-button") is null
 [Break On This Error]  
$('#gallery-nav-button').addClass('animated fadeOutRightBig'); 
```

这是我的代码：

***JS***

```
$(function() {
  $("#close-gallery-nav-button").click(function() {
    $('#gallery-nav-button').addClass('animated fadeOutRightBig');
   });
}); 
```

***HTML***

```
<div id="gallery-nav-button">
  <h4 id="close-gallery-nav-button">X</h4>
    <h3 class="text-center small-text"><a class="inline text-center small-text" href="#gallery-nav-instruct">Click Here for Gallery <br /> Navigation Instructions.</a></h3>
</div> 
```

***CSS***

```
#close-gallery-nav-button{
  text-indent:-9999px; 
  width:20px; 
  height:20px; 
  position:absolute; 
  top:-20px; 
  background:url(/images/controls.png) no-repeat 0 0;
}
#close-gallery-nav-button{background-position:-50px 0px; right:0;}
#close-gallery-nav-button:hover{background-position:-50px -25px;} 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-08-27T15:43:11.227

我还想补充一点——因为这是重要错误消息“TypeError: [x] is null”的#1 Google 搜索结果——JavaScript 开发人员得到这个的最常见原因是他们试图分配一个事件处理 DOM 元素，但尚未创建 DOM 元素。

代码基本上是从上到下运行的。大多数开发人员将他们的 JavaScript 放在 HTML 文件的头部。浏览器已从服务器接收到 HTML、CSS 和 JavaScript；正在“执行”/呈现网页；并且正在执行 JavaScript，但它还没有进一步深入 HTML 文件以“执行”/呈现 HTML。

为了处理这个问题，你需要在你的 JavaScript 被执行之前引入一个延迟，比如把它放在一个函数中，直到浏览器“执行”了所有的 HTML 并触发了“DOM 就绪”事件。

对于原始 JavaScript，使用 window.onload：

```
window.onload=function() {
   /*your code here*
   /*var date = document.getElementById("date");
   /*alert(date);
} 
```

使用 jQuery，使用准备好的文档：

```
$(document).ready(function() {
   /*your code here*
   /*var date = document.getElementById("date");
   /*alert(date);
}); 
```

这样，在浏览器构建 DOM、HTML 元素存在（不是 null :-)）并且您的 JavaScript 可以找到它并将事件处理程序附加到它之前，您的 JavaScript 不会运行。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-26T23:51:43.973

我在此页面上运行了几个脚本，显然一个脚本与另一个脚本冲突。为了解决我的问题，我添加了[jQuery.noConflict();](http://api.jquery.com/jQuery.noConflict/)

```
var $j = jQuery.noConflict();
$j(function() {
  $j("#close-gallery-nav-button").click(function() {
    $j('#gallery-nav-button').addClass('animated fadeOutRightBig');
   });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-27T18:04:49.193

我同意上面给出的关于 onload 事件的建议。[https://stackoverflow.com/a/18470043/2115934](https://stackoverflow.com/a/18470043/2115934)

一个更简单的解决方案（尽管不一定是更好的解决方案）是将您的脚本标签放在文档的结束正文标签之前。

```
<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Document</title>
</head>
<body>
<h1></h1>
<p></p>
<script src="script.js" type="text/javascript"></script> <!-- PUT IT HERE -->
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-04-08T19:49:49.940

我知道这已经得到回答，这是一个旧帖子，但想分享我的经验。我最难加载我的代码，并且不断收到此错误。我在头部加载了我的 javascript 外部页面。一旦我将它移到身体结束之前，该功能立即启动。

# c# - 详细视图和字段编辑授权

> ID：12611992
> 
> 赞同：0
> 
> 时间：2012-09-26T23:33:17.890
> 
> 标签：c#, asp.net

我正在尝试利用详细信息视图并为几个级别的用户授权提供编辑功能。基本上 1 级用户不能更新一组预定义的字段，但 2 级用户可以更新这些字段。我曾尝试`visible=false`在定义时简单地将字段设置为`EditTemplate`，然后在`DataBind`我将测试授权并使其`visible=true`在用户有权更新字段时进行（参见下面的代码示例）。工作就像一个魅力，除了我注意到当 1 级用户更新他们允许更新的字段时，这些`visible=false`字段将`null`在数据库中设置为（覆盖）。因此，一直在尝试各种选项，而不必复制视图等。

代码片段：aspx....

```
<asp:TemplateField HeaderText="<%$ Resources:Resource, Level %>" 
    SortExpression="LevelId">
        <EditItemTemplate>
            <asp:DropDownList ID="LevelList" runat="server" 
                DataTextField="LevelDesc" DataValueField="LevelId">
             </asp:DropDownList>
        </EditItemTemplate>
        <HeaderStyle HorizontalAlign="Right" />
</asp:TemplateField>
<asp:TemplateField HeaderText="<%$ Resources:Resource, Level1 %>" 
    SortExpression="Level1Date" Visible="false" >
        <EditItemTemplate>
            <asp:TextBox ID="Level1" runat="server" Text='<%# 
                Bind("Level1Date", "{0:d}") %>'  />
            <asp:CompareValidator ID="CompareValidator1" runat="server" 
                ErrorMessage="Please enter a valid date (m/d/y)" 
                ControlToValidate="Level1" Operator="DataTypeCheck" 
                Type="Date" Display="Dynamic">
            </asp:CompareValidator>
       </EditItemTemplate>
       <HeaderStyle HorizontalAlign="Right" />
   </asp:TemplateField>
   <asp:TemplateField HeaderText="<%$ Resources:Resource, Level2 %>" 
       SortExpression="Level2Date" Visible="false" >
       <EditItemTemplate>
           <asp:TextBox ID="Level2" runat="server" Text='<%# 
               Bind("Level2Date", "{0:d}") %>'  />
           <asp:CompareValidator ID="CompareValidator2" runat="server" 
               ErrorMessage="Please enter a valid date (m/d/y)" 
               ControlToValidate="Level2" Operator="DataTypeCheck" 
               Type="Date" Display="Dynamic">
           </asp:CompareValidator>
       </EditItemTemplate>
       <HeaderStyle HorizontalAlign="Right" />
   </asp:TemplateField>

   <asp:TemplateField HeaderText="<%$ Resources:Resource, Level4 %>" 
       SortExpression="Level4Date" Visible="false" >
       <EditItemTemplate>
           <asp:TextBox ID="Level4" runat="server" Text='<%# 
               Bind("Level4Date", "{0:d}") %>'  />
 </Fields> 
```

aspx.cs 片段

```
<name>_DataBound(object sender, EventArgs e)
        {
.
.
.
if (User.IsInRole("yyy") || User.IsInRole("xxx))
{
    OfficialProfileInfo.Fields[2].Visible = true;
    OfficialProfileInfo.Fields[3].Visible = true;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T03:51:54.770

您必须设置 DataKeyNames 属性才能使 DetailsView 控件的自动更新、删除和插入功能起作用。

如果某些字段不应该更改，则在更新时，您可以将它们放在键中。

```
if (User.IsInRole("yyy") || User.IsInRole("xxx))
{
    OfficialProfileInfo.Fields[2].Visible = true;
    OfficialProfileInfo.Fields[3].Visible = true;
}
else
{
    OfficialProfileInfo.DataKeyNames = "Level4Date"
} 
```

**注意：** DataKeyNames 是以逗号分隔的字段名称列表/

# assembly - TASM：负数的模

> ID：12611993
> 
> 赞同：1
> 
> 时间：2012-09-26T23:33:25.800
> 
> 标签：assembly, modulo, tasm

例如，当我执行 -1 % 3 时，我希望结果为 2。

当我执行以下 TASM 指令时，我得到了意想不到的结果：

```
mov ax, -1
xor bh, bh
mov bl,  3
idiv bl ; ah = FF (I expected 02), al = 00 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T00:30:20.340

[该网页](http://flylib.com/books/en/2.265.1.32/1/)指出：

> 余数的符号始终与被除数的符号相同。

[维基百科](http://en.wikipedia.org/wiki/Modulo_operation#Common_pitfalls)有一些关于带有签名余数的陷阱的信息。

一种可能的解决方法是使用`div`而不是`idiv`，和/或手动跟踪标志。

# php - 在 PHP 中广播另一个端口时侦听一个 UDP 端口

> ID：12611998
> 
> 赞同：0
> 
> 时间：2012-09-26T23:33:39.230
> 
> 标签：php, sockets, udp, home-automation

最近购买了一些 LightwaveRF 家庭自动化产品 - 效果非常好！经过一番谷歌搜索和反复试验，我有几个可以控制灯光的 PHP 脚本！

主脚本：control.php 传递了一些参数，它接受并转换为要使用端口 9760 上的 UDP 套接字广播的字符串。例如，正确的字符串是：“001，！R2D2F1|”。

R2 = 房间 2 D2 = 设备 2 F1 = 开（可接受的值为 F1 = 开、F0 = 关，或者调光值在 2-32 之间的范围内。32 = 100%。

这工作正常，但是“OK”消息随后在 UDP 端口 9761 上传回 - 我需要能够监听这个 OK，所以我可以链接多个灯光命令。如果您不等待并直接发送 4 个，那么您通常只会得到一两个实际运行的命令。

目前，我有一个文件，listen.php，它在端口 9761 上侦听并将消息打印到屏幕上。我可以通过以下方式将两者联系在一起：

*   运行listen.php，让它开始监听
*   运行 control.php 一次 listen.php 正在运行
*   排序。灯变了，OK 被打印出来，listen.php 停止执行。

但是，我需要这个过程是自动的，即开始监听，发送命令，等待 OK，在一个脚本中完成所有操作 - 但无法弄清楚如何做到这一点！

任何想法表示赞赏。谢谢！