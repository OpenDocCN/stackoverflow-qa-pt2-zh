# StackOverflow 问答 14674000-14674999

# sql - varchar(max) 的性能问题？

> ID：14674006
> 
> 赞同：0
> 
> 时间：2013-02-03T15:23:08.620
> 
> 标签：sql, sql-server-2008

> **可能重复：**
> [在表中使用 VARCHAR(MAX) 是否有缺点？](https://stackoverflow.com/questions/2572649/are-there-disadvantages-to-using-varcharmax-in-a-table)

如果我知道列实际大小最多只有 100 个字符，但我仍然想使用 nvarchar(max)。性能成本应该是多少，为什么？

# c# - HttpContext.Current.User.Identity.Name 在一个 HttpHandler 中为空，但在另一个 HttpHandler 中有值

> ID：14674009
> 
> 赞同：0
> 
> 时间：2013-02-03T15:24:00.490
> 
> 标签：c#, asp.net, http, httphandler

我有两个`HttpHandlers`。一个拦截 url 中的任何 pdf 文件请求，另一个拦截 xml 请求。在 pdf 文件处理程序中，我从中获取用户名，`HttpContext.Current.User.Identity.Name`但是当请求 xml 文件时`HttpContext.Current.User.Identity.Name`始终为空。

拦截处理程序的`web.config`部分如下所示：

```
<add verb="*" path="/calderdale/*.pdf" type="NES.HiLo.Security.CalderDaleAuthenticationHandler, NES.HiLo.Security" />
<add verb="GET" path="/Pallative/*.xml" type="NES.HiLo.Security.PallativeAuthenticationHandler, NES.HiLo.Security" /> 
```

认证部分

```
<authentication mode="Forms">
   <forms name="KFCSAUTH" loginUrl="login.aspx" protection="All" 
          slidingExpiration="true" path="/" domain=".scot.nhs.uk" />
</authentication>
<authorization>
    <allow users="?" />
</authorization>
<system.webServer>
   <!--<validation validateIntegratedModeConfiguration="false" />-->
   <handlers>
      <add name="Pallative Handler" path="/Pallative/*.xml" verb="GET" 
           modules="IsapiModule" 
           scriptProcessor="%windir%\Microsoft.NET\Framework\v2.0.50727\aspnet_isapi.dll" 
           resourceType="Unspecified" requireAccess="Script" 
           preCondition="classicMode,runtimeVersionv2.0,bitness32" />
      <add name="Calderdale Handler" path="/calderdale/*.pdf" verb="GET" 
           modules="IsapiModule" 
           scriptProcessor="%windir%\Microsoft.NET\Framework\v2.0.50727\aspnet_isapi.dll" 
           resourceType="Unspecified" requireAccess="Script" 
           preCondition="classicMode,runtimeVersionv2.0,bitness32" />
       <!--<add name="Pallative Handler" path="Pallative/pallative_doc.html" 
                verb="GET" modules="IsapiModule" 
                scriptProcessor="%windir%\Microsoft.NET\Framework\v2.0.50727\aspnet_isapi.dll" 
                resourceType="Unspecified" requireAccess="Script" 
                preCondition="classicMode,runtimeVersionv2.0,bitness32" />
   </handlers>
</system.webServer> 
```

# php - 序列化和加密存储

> ID：14674012
> 
> 赞同：0
> 
> 时间：2013-02-03T15:24:20.270
> 
> 标签：php

我想将敏感的用户信息存储在一个对象中，该对象将作为文件保存在服务器上（而不是在数据库中）。

用户的密码或其他密钥将用于生成加密密钥。

每当用户登录并提供正确的密钥时，将从服务器加载数据对象，然后将其存储在会话中。所有这一切都会发生在其他 SSL 上。

我不熟悉序列化，但我想它会像这样工作。

```
function loadData($id, $key)
{
    //open file from storage
    $fh = fopen("data/" . $id);
    $obj = fh->read //not sure what the read function would be....
    $obj = decrypt($obj, $key) // some sort of decryption function using openssl_decrpt
    $obj = unserialize($obj
    if ($obj != null) //if successful...
    {
        session_start();
        $_SESSION['data'] = $obj;

        return true;
    }

    return false;
}

function saveData($id, $key)
{
    //open file from storage
    $fh = fopen("data/" . $id);
    $obj = serialize($_SESSION(["data"]);
    $obj = encrypt($obj, $key);
    $obj = serialize($obj

    if ($obj != null) //if successful...
    {
        fh->write($obj) //not sure what the write function would be....

        return true;
    }

    return false;
} 
```

另外，这种方法安全吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T15:38:31.410

弱点是您的服务器。如果有人可以访问您的服务器，他/她可以：

1.  对加密对象运行[字典攻击](http://en.wikipedia.org/wiki/Dictionary_attack)（如果密钥是短密码，这可能非常有效）。
2.  在请求处理期间附加到您的服务器进程并从内存中获取解密的对象（或密钥）。

要缓解第一个问题，您应该使用[salt](http://en.wikipedia.org/wiki/Salt_%28cryptography%29)，但对于第二个问题，您确实无能为力 - 只需确保您的服务器没有受到损害......

（请注意，运行字典攻击比逆向工程过程简单得多，并且需要更少的权限。因此，根据您的用例，忽略第二个问题可能是合理的）

# python - 在python中绘制颜色直方图

> ID：14674014
> 
> 赞同：2
> 
> 时间：2013-02-03T15:24:31.950
> 
> 标签：python, image, histogram

我有一个 jpeg 图像，并想绘制图像中每种颜色出现频率的直方图。我可以使用 pymorph.histogram() 生成频率表，但我不知道 256 种颜色索引中的每一种对应的实际颜色。我怎样才能生成这个调色板？
此外，有没有办法只生成所有这些数字的直方图，并显示颜色（不是 0-255 范围内的数字，而是显示的实际颜色）？

我的频率列表是使用以下代码生成的：

```
import pymorph
import Image

im=Image.open('image.jpg')
im=np.asarray(im)
hist_im=pymorph.histogram(im) 
```

# java - 使用 OAuth 保护 jax-rs

> ID：14674015
> 
> 赞同：3
> 
> 时间：2013-02-03T15:24:35.853
> 
> 标签：java, web-services, oauth, jax-rs

我有以下问题：

我有 JAX-RS 服务，它有一个`get`操作：

```
@Path("/unsecure/")
@Produces("application/json")
public class MyUnsecureService {
    public MyUnsecureService() {

    }

    @GET
    @Path("/get/{id}")
    @Produces("application/json")
    public User get(@PathParam("id") String id) {
        return User.get(id);
    }
} 
```

现在，我要为移动设备打开这个 API，我需要身份验证和授权机制来访问这个 API。

我的问题是我有受信任的应用程序（内部作业，在我的主机上运行的网站）应该能够根据需要无限制地公开此 API，以及移动设备，只有在以下情况下才能公开此 API他们有一个令牌，使用真实用户的加密登录/密码形成，可以在服务端使用来确定：

1.  如果允许对该方法的请求。
2.  如果参数正确（因此，用户无法获取其他用户的信息）。

这可以使用 OAuth1 或 OAuth2 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-01T22:28:49.110

这是一个非常有效的问题。

您可能想看看 Oz（[背景](http://hueniverse.com/2012/07/oauth-2-0-and-the-road-to-hell/)），AFAIU 将对您的用例大有帮助。就个人而言，我有兴趣解决 Java 的问题并跟踪 Eran 在 Java 实现（[jiron](https://github.com/algermissen/jiron)、[hawkj](https://github.com/algermissen/hawkj)）方面的工作。最后用 Java 做 Oz（或类似的[东西](http://jalg.net/2013/05/beyond-oauth/)）。

现在发布的内容还不成熟，但如果您愿意，请与我们联系以获取详细信息。

JAX-RS 现在的具体问题似乎是[SecurityContext](https://java.net/jira/browse/JAX_RS_SPEC-412)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-27T12:26:24.500

找到了答案：

使用客户端凭据和资源所有者授权，它们在 Apache CXF 的 OAuth2 实现中实现。

# jquery - 降低视差元素的位置

> ID：14674016
> 
> 赞同：0
> 
> 时间：2013-02-03T15:24:36.523
> 
> 标签：jquery, html, web, parallax

我正在为我朋友的婚礼（[http://mhutchinson.me.uk/tom/](http://mhutchinson.me.uk/tom/)）建立一个网站，我正在使用视差使白色的“保存日期”文本消失在奶油部分下方，其中包含详细信息.

我的基本功能正常工作，但我无法让“保存日期”图像坐下。它总是与顶部对接，或者如果我将其向下移动，它就无法正常工作。

有谁知道如何定位它？

这是我正在使用的 jQuery：

```
$(document).ready(function(){
    //.parallax(xPosition, speedFactor, outerHeight) options:
    //xPosition - Horizontal position of the element
    //inertia - speed to move relative to vertical scroll. Example: 0.1 is one tenth the speed of scrolling, 2 is twice the speed of scrolling
    //outerHeight (true/false) - Whether or not jQuery should use it's outerHeight option to determine when a section is in the viewport

    $('#intro').parallax("50%", 0.4);
    $('#logo').parallax("50%", 0.1);
    $('#infoWrapper').parallax("50%", 0.1);
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-12-26T12:10:54.587

在您的 CSS 上尝试删除“背景附件：固定”规则并使用它。

```
 background-image: url(yourimage.path);
  background-repeat: no-repeat;
  height: 100vh;
  position: absolute;
  background-position: center bottom!important;
  top: 50vh;
  width: 100vw;
  z-index: 200; 
```

# drupal - 如何在特定条件下注销并在登录后显示消息？

> ID：14674017
> 
> 赞同：1
> 
> 时间：2013-02-03T15:24:38.923
> 
> 标签：drupal, drupal-7

给定一个 Drupal 7 网站，我想自定义登录行为：当用户登录时，我想检查他们是否在黑名单中。如果他们在该列表中，我希望他们自动注销并告知他们被踢出的原因。所以在这个drupal的一个自定义模块中，我添加了以下钩子：

```
function mymodule_user_login(&$edit, $account) {
  if(blacklist(&$edit, $account)) {
    drupal_goto("/user/logout/");
    drupal_set_message('Acces denied','error');
  }
} 
```

但是，我的代码不起作用。我做错了什么？我确定钩子已执行，因为我使用看门狗检查了这一点。但是，我还发现只有当 admin 是登录用户时才会执行该钩子。

有没有其他选择（可能使用 Context 模块）？任何建议将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T01:06:26.403

您的代码不起作用，因为[drupal_goto()](http://api.drupal.org/api/drupal/includes!common.inc/function/drupal_goto/7)调用[drupal_exit()](http://api.drupal.org/api/drupal/includes!common.inc/function/drupal_exit/7)所以脚本的其余部分不会被执行。

您尝试执行的操作将不起作用，因为[user_logout()](http://api.drupal.org/api/drupal/modules!user!user.pages.inc/function/user_logout/7)本身将 drupal_goto() 调用到首页。但是，您可以在用户登录表单中添加额外的验证回调，以便完全阻止用户登录。

```
<?php
function mymodule_form_alter(&$form, &$form_state, $form_id) {
  switch ($form_id) {
    case 'user_login':
    case 'user_login_block':
      $form['#validate'][] = 'mymodule_custom_user_validation',

    break;
  }
}

function mymodule_custom_user_valudation($form, &$form_state) {
  if (// Add your blacklist conditons here. ) {
    form_set_error('', t('Your account is blacklisted, therefore you cannot login to this account'))
  }
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T18:37:56.880

如果您对使用[登录目标](http://drupal.org/project/login_destination)模块感兴趣，那么您可以创建某种类型的规则来挂钩您的黑名单检查，然后将该用户重定向到“用户/注销”路径。如果您有任何问题，请告诉我。

您的“blacklist()”函数到底在做什么？

# java - 具有 preauth 的 Spring 安全自定义异常处理程序

> ID：14674021
> 
> 赞同：2
> 
> 时间：2013-02-03T15:25:02.853
> 
> 标签：java, spring, spring-mvc, spring-security

我正在尝试使用 Spring Security 3.1.2 配置一些自定义异常处理。我尝试按照我在[此处](https://stackoverflow.com/questions/5094449/spring-exception-handler-to-not-handle-certain-types-of-exception)和[此处](http://rockycode.com/blog/custom-exception-handling-accessdeniedexception/)找到的示例进行操作，但均无效。我是 Spring Security 的新手，我想知道这是否与我使用 preauth 过滤器的事实有关。我从 AuthenticationUserDetailsS​​ervice 实现的 loadUserDetails() 方法中抛出自定义异常。

```
public class AuthServiceImpl implements AuthenticationUserDetailsService<Authentication> {
  @Autowired
  private AuthDao authDao;

  @Override
  public UserDetails loadUserDetails(Authentication auth) throws UsernameNotFoundException {
    Request req = (Request) auth.getPrincipal();

    //get user details
    User u = authDao.loadUser(req.getSessionId());

    //check user rights for requested action
    if(!u.getRights().contains(req.getAction()){
      throw new CustomAuthException("User does not have permission to perform this action");
    }

    return u;
  }
} 
```

当抛出异常时，我只会得到带有异常详细信息的正常 Tomcat 500 页面。无论出于何种原因，我的自定义异常都没有得到处理。我什至在自定义处理程序中添加了一些 println()，它甚至没有被调用。

我开始怀疑这种方法是否以某种方式被排除在 Spring 的异常处理之外。如果需要，我可以提供更多代码示例，但在这一点上，我不确定什么是相关的分享。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T10:10:16.643

您使用**SimpleMappingExceptionResolver**。它是一个 Spring MVC 组件。因此，当您在执行某个控制器期间遇到一些异常时，DispatcherServlet 将调用 SimpleMappingExceptionResolver。问题是您的 AuthenticationUserDetailsS​​ervice 实现仅在登录操作期间使用。而这个动作**直接由 Spring Security 过滤器处理（不使用 Spring MVC）**。请求没有到达 DispatcherServlet 并且 SimpleMappingExceptionResolver 永远不会在这种情况下被调用。

# java - 检查 Object 是否是 List 的实例 I have an Object that sometimes contains a List. I want to check it with instanceof, and if it is, then add some elements to it. void add 问问题 问问题 2013-02-03T15:25:52.187 31773 次 This question shows research effort; it is useful and clear 6 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I have an Object that sometimes contains a List. I want to check it with instanceof, and if it is, then add some elements to it. void add(Object toAdd) { Object obj = getValue(); if (obj instanceof List) { List list = obj; if (list instanceof List) { // Error ((List) list).add(toAdd); } else { List newList = new ArrayList(list); newList.add(toAdd); setValue(newList); } return; } throw new SomeException(); } And it says I can't check if it is instanceof List because java doesn't care and erased the type in <>. Does this mean I have to create new ArrayList every time? Or is there a way to check that, eg. with reflection? I was wrong in my previous answer since i not fully understood your requirements. if your added item is an Object you may add it without any problem as long as you Have a list of something. You don't have to recreate the list void add(Object toAdd) { Object obj = getObject(); if (obj instanceof List) { ((List)obj).add(toAdd); return; } throw new SomeException(); } UPDATE as answer to few comments, there is no problem to add any object to a list, and there is no problem to find out what type of object it is during iteration after it: List <string>x1 = new ArrayList<string>(); Object c3 = x1; x1.add("asdsad"); Integer y2 = new Integer(5); if (c3 instanceof List){ ((List)c3).add((Object)y2); } for (Object i : (List)c3){ if (i instanceof String){ System.out.println("String: " + (String)i); } if (i instanceof Integer){ System.out.println("Integer: "+ (Integer)i); } } javalistgenerics 4 1 回答 1 This answer is useful 5 我之前的回答错了，因为我没有完全理解你的要求。如果您添加的项目是一个对象，您可以毫无问题地添加它，只要您有一个列表。您不必重新创建列表 void add(Object toAdd) { Object obj = getObject(); if (obj instanceof List) { ((List)obj).add(toAdd); return; } throw new SomeException(); } 更新 作为对少数评论的回答，将任何对象添加到列表中是没有问题的，并且在它之后的迭代期间找出它是什么类型的对象也没有问题： List <string>x1 = new ArrayList<string>(); Object c3 = x1; x1.add("asdsad"); Integer y2 = new Integer(5); if (c3 instanceof List){ ((List)c3).add((Object)y2); } for (Object i : (List)c3){ if (i instanceof String){ System.out.println("String: " + (String)i); } if (i instanceof Integer){ System.out.println("Integer: "+ (Integer)i); } } 于 2013-02-03T15:51:55.797 回答 Related 1 xmlsec - 多个XADES签名/获取原始文件 1 javascript - 自定义 jquery 选择器属性未在模拟器中触发 1 ant - sourceforge pmd-bin-5.0.0 下载中没有规则集或 basic.xml 1 html - 无法使用 Google Chrome 显示桌面通知 2 css - 为什么这个vertical-align：middle在Jquery mobile中失败 0 javascript - 点按时屏幕上闪烁的黑框 1 html - 并排放置两个表 TR 1 mercurial - Mercurial：查找应用于文件修订的所有标签 2 jquery - 水平平滑滚动 4 java - 在 Java 源代码中隐藏密码 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：14674027
> 
> 赞同：6
> 
> 时间：
> 
> 标签：java, list, generics

I have an `Object` that sometimes contains a `List<Object>`. I want to check it with `instanceof`, and if it is, then add some elements to it.

```
void add(Object toAdd) {
    Object obj = getValue();
    if (obj instanceof List<?>) {
        List<?> list = obj;
        if (list instanceof List<Object>) {    // Error
            ((List<Object>) list).add(toAdd);
        } else {
            List<Object> newList = new ArrayList<Object>(list);
            newList.add(toAdd);
            setValue(newList);
        }
        return;
    }
    throw new SomeException();
} 
```

And it says I can't check if it is `instanceof List<Object>` because java doesn't care and erased the type in `<>`. Does this mean I have to create new ArrayList every time? Or is there a way to check that, eg. with reflection?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T15:51:55.797

我之前的回答错了，因为我没有完全理解你的要求。如果您添加的项目是一个对象，您可以毫无问题地添加它，只要您有一个列表。您不必重新创建列表

```
void add(Object toAdd) {
    Object obj = getObject();
    if (obj instanceof List<?>) {
        ((List<Object>)obj).add(toAdd);
        return;
    }
    throw new SomeException();
} 
```

**更新**

作为对少数评论的回答，将任何对象添加到列表中是没有问题的，并且在它之后的迭代期间找出它是什么类型的对象也没有问题：

```
List<String> x1 = new ArrayList<String>();
Object c3 = x1;
x1.add("asdsad");
Integer y2 = new Integer(5);
if (c3 instanceof List<?>){
     ((List<Object>)c3).add((Object)y2);
}

for (Object i : (List<Object>)c3){
    if (i instanceof String){
        System.out.println("String: " + (String)i);
    }
    if (i instanceof Integer){
        System.out.println("Integer: "+ (Integer)i);
    }
} 
```</string></string></string></string>

# c - C++ 为什么 va_start 期望最后一个非可变函数参数？

> ID：14674028
> 
> 赞同：1
> 
> 时间：2013-02-03T15:26:01.157
> 
> 标签：c, undefined-behavior, variadic-functions

我正在使用 Visual Studio 2012 编译此示例代码：

```
#include <stdarg.h>
#include <stdio.h>

const char * __cdecl foo(const char * format, const char * requiredArgument, ...)
{
    va_list args;
    va_start(args, format);
    vprintf(format, args);
    va_end(args);
    return requiredArgument;
}

int main(int, char **)
{
    foo("The %s is %d pixels wide and %d pixels high.", "box", 300, 200);
    return 0;
} 
```

程序的调试构建在打印消息“框为 300 像素宽和 200 像素高。”后正常终止。

发布版本因分段错误而崩溃。

我对这种行为的解释——**但我可能错了，如果是，请纠正我**——是我错误地指定了一个函数参数，而不是最后一个非可变参数`va_start`，唯一可接受的形式是这里`va_start(args, requiredArgument)`而不是`va_start(args, format)`我想拥有。换句话说，我`va_start`以一种使整个程序流程不可预测的方式误用，因此这里的分段错误没什么大不了的。

如果我的假设是正确的，我现在有两个问题：

*   `va_start`如果选择其他任何东西显然是非法的，为什么还要指定最后一个正式声明的函数参数？

*   为什么挑剔的 VC++ 编译器不会对如此容易检测和潜在的严重陷阱发出警告？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T15:29:20.583

> 如果选择其他任何东西显然是非法的，为什么还要在 va_start 中指定最后一个正式声明的函数参数？

因为那个宏需要知道最后一个参数的*地址*。

> 为什么挑剔的 VC++ 编译器不会对如此容易检测和潜在的严重陷阱发出警告？

因为它还不够“智能”。或者它的创建者决定不包括这个警告。或者它可以，但默认情况下它是关闭的，你可以使用一些编译器标志打开它。

# search - 无法在 OCaml 中进行回溯研究

> ID：14674033
> 
> 赞同：1
> 
> 时间：2013-02-03T15:26:37.160
> 
> 标签：search, ocaml, backtracking, depth

我正在尝试解决 OCaml 中的谜题 15 游戏。我几乎什么都做了。。除了程序的核心功能，深度优先搜索功能。这就是我的函数现在的样子：

```
let df_search_path (Graph next) start =
    let rec from_node visited a =
            print(a);
             if List.mem a visited then raise Fail
             else if goal(a) then [a]
                  else a::from_list (a::visited) (next a)
        and from_list visited nextA = match visited with
            [] -> raise Fail
                | nextA::rest -> try from_node visited nextA
                          with Fail -> from_list visited rest
in from_node [] start;; 
```

`Graph`是一个图，`next`是一个搜索 2,3 或 4 个下一步移动的函数（我移动空白区域），`goal`是一个检查当前`a`状态是否是目标并且`Fail`是正常异常的函数。

我尝试了很多其他功能，它们运行良好。

这个函数总是在起始状态无限循环，我不明白为什么。 `print`是一个自定义函数，以友好的形式打印状态`a`。

我究竟做错了什么？我正在使用远离解决方案的状态“1 move”进行测试，只需“go down”即可解决此问题..但它卡在第一个状态，总是打印开始配置！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T16:50:51.700

我怀疑你的错误只是in`match visited with ..`而不是`match nextA with ...`in `from_list`。

```
let df_search_path (Graph next) start =
    let rec from_node visited a =
            print(a);
            if List.mem a visited then raise Fail
            else if goal(a) then [a]
            else a::from_list (a::visited) (next a)
        and from_list visited nextA = match nextA with
            | [] -> raise Fail
            | nextA::rest -> try from_node visited nextA
                             with Fail -> from_list visited rest
in from_node [] start;; 
```

也就是说，还有其他方法可以改进代码：目前，“已访问”仅存储*该搜索路径*已访问过的节点，而不是迄今为止访问过的所有节点；迁移到全局保存并在任何节点的所有“子搜索”之间共享的数据结构将减少无用搜索的数量（如果您只想要一条通向目标的路径）。

最后，在这里使用列表是一个相当糟糕的主意，因为`List.mem`时间与列表的大小成线性关系；这给出了一个整体的二次行为。您应该使用专门用于成员资格检查的数据结构，例如`Set`（或者可能是与您的问题域相对应的数据结构：例如，在类似迷宫的搜索中，布尔矩阵通常更简单且更有效）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T16:35:16.520

很难确切地看出这段代码应该如何工作。这是我看到的：

您使用 计算要访问（出现）的节点列表`next a`。在`from_list`函数中，您不使用此列表。相反，您将`visited`列表的第一个元素重命名为`nextA`并重新访问它。您似乎只是一遍又一遍地重新访问第一个已经访问过的节点。我不明白为什么`from_list`会关心访问的节点。很可能它只会将列表传递给`from_node`.

# c - 在 GNU C 中实现 printf for float ，半主机

> ID：14674036
> 
> 赞同：0
> 
> 时间：2013-02-03T15:26:57.767
> 
> 标签：c, arm, printf, gnu

我需要使用 gnu c printf 函数将浮点数发送到半主机控制台。当前的实现 printf(vsnprintf) 是

```
 signed int vsnprintf(char *pStr, size_t length, const char *pFormat, va_list ap)
{
    char          fill;
    unsigned char width;
    signed int    num = 0;
    signed int    size = 0;

    /* Clear the string */
    if (pStr) {

        *pStr = 0;
    }

    /* Phase string */
    while (*pFormat != 0 && size < length) {

        /* Normal character */
        if (*pFormat != '%') {

            *pStr++ = *pFormat++;
            size++;
        }
        /* Escaped '%' */
        else if (*(pFormat+1) == '%') {

            *pStr++ = '%';
            pFormat += 2;
            size++;
        }
        /* Token delimiter */
        else {

            fill = ' ';
            width = 0;
            pFormat++;

            /* Parse filler */
            if (*pFormat == '0') {

                fill = '0';
                pFormat++;
            }

            /* Parse width */
            while ((*pFormat >= '0') && (*pFormat <= '9')) {

                width = (width*10) + *pFormat-'0';
                pFormat++;
            }

            /* Check if there is enough space */
            if (size + width > length) {

                width = length - size;
            }

            /* Parse type */
            switch (*pFormat) {
            case 'd': 
            case 'i': num = PutSignedInt(pStr, fill, width, va_arg(ap, signed int)); break;
            case 'u': num = PutUnsignedInt(pStr, fill, width, va_arg(ap, unsigned int)); break;
            case 'x': num = PutHexa(pStr, fill, width, 0, va_arg(ap, unsigned int)); break;
            case 'X': num = PutHexa(pStr, fill, width, 1, va_arg(ap, unsigned int)); break;
            case 's': num = PutString(pStr, va_arg(ap, char *)); break;
            case 'c': num = PutChar(pStr, va_arg(ap, unsigned int)); break;
            default:
                return EOF;
            }

            pFormat++;
            pStr += num;
            size += num;
        }
    }

    /* NULL-terminated (final \0 is not counted) */
    if (size < length) {

        *pStr = 0;
    }
    else {

        *(--pStr) = 0;
        size--;
    }

    return size;
} 
```

非常感谢实现“f”格式说明符的任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:49:24.320

您似乎正在使用自定义 printf 实现，而不是使用来自 libc 您的工具链的实现。如果您已经实现了[syscalls](http://www.yagarto.de/download/yagarto/syscalls.c)，您应该能够通过不编译您的 stdio 实现来简单地切换到工具链的标准 printf 实现。

另一种方法是创建一个 PutFloat 函数，该函数只需将输入乘以 10 的幂，然后使用现有的整数打印分别打印数字的小数部分和小数部分。例如：

```
x = (signed int)floatIn*10000;
PutSignedInt(x/10000);
PutChar('.');
ax = abs(x);
ay = abs(y);
ax = ax - ay*10000;
PutSignedInt(ax); 
```

如果你明白了，你应该能够自己填写详细信息。

# jsf - Primefaces PickList 目标在 ajax 传输侦听器上为空

> ID：14674039
> 
> 赞同：2
> 
> 时间：2013-02-03T15:27:23.983
> 
> 标签：jsf, jsf-2, primefaces

我有以下内容`p:pickList`：

```
<p:pickList id="activityUser" value="#{activityEntryController.activityUserDualListModel}" var="model" itemLabel="#{model.fullName}"
    itemValue="#{model}" converter="activityUserListConverter" styleClass="activityUser" required="true" showSourceFilter="true"
    showTargetFilter="true" filterMatchMode="contains">

    <f:facet name="sourceCaption">Available</f:facet>
    <f:facet name="targetCaption">Selected</f:facet>

    <p:column style="width: 400px">
        <h:outputText value="#{model.fullName}" />
    </p:column>

    <p:ajax event="transfer" listener="#{activityEntryController.sortUsersOnTransfer}" update="activityUser" />
</p:pickList> 
```

这`value`是`p:pickList`一个扩展的类`DualListModel<T>`：

```
public class ActivityUserDualListModel extends DualListModel<ActivityUserDTO> {

    private static final long serialVersionUID = -5369543532197736480L;

    public ActivityUserDualListModel() {
        super();
        initModel();
    }

    public ActivityUserDualListModel(List<ActivityUserDTO> source, List<ActivityUserDTO> target) {
        super(source, target);
        initModel();
    }

    private void initModel() {
        IServiceProvider serviceProvider = (IServiceProvider) ContextLoader.getCurrentWebApplicationContext().getBean(Beans.SERVICE_PROVIDER.getName());
        IUserService userService = serviceProvider.getUserService();

        List<ActivityUserDTO> activityUserDTOs = new ArrayList<ActivityUserDTO>();

        for(User user : userService.getAllUser()) {
            if(user.isActive()) {
                activityUserDTOs.add(constructActivityUserDTO(user));
            }
        }

        Collections.sort(activityUserDTOs, ComparatorUtils.getActivityUserFullNameComparator());

        setSource(activityUserDTOs);
        setTarget(new ArrayList<ActivityUserDTO>());
    }

    private ActivityUserDTO constructActivityUserDTO(User user) {
        ActivityUserDTO activityUserDTO = new ActivityUserDTO();
        activityUserDTO.setId(user.getId());
        activityUserDTO.setUsername(user.getUsername());
        activityUserDTO.setFullName(user.getFullName());

        return activityUserDTO;
    }
} 
```

我是`ActivityUserDualListModel`从托管 bean的`PostConstruct`方法中实例化的。`ActivityEntryController`

在事件发生时触发的`listener`是：`p:ajax``transfer`

```
public void sortUsersOnTransfer(TransferEvent event) {      
    List<ActivityUserDTO> source = activityUserDualListModel.getSource();
    List<ActivityUserDTO> target = activityUserDualListModel.getTarget();
    System.out.println("=============================================");
    for(ActivityUserDTO dto : source) {
        System.out.println(dto.getFullName());
    }
    System.out.println("=============================================");
    System.out.println("=============================================");
    for(ActivityUserDTO dto : target) {
        System.out.println(dto.getFullName());
    }
    System.out.println("=============================================");

    if(source != null) {
        Collections.sort(source, ComparatorUtils.getActivityUserFullNameComparator());
    }

    if(target != null) {
        Collections.sort(target, ComparatorUtils.getActivityUserFullNameComparator());
    }
} 
```

奇怪的是`target`上面方法中的列表是空的。我无法找到我所缺少的。任何指针都会对我很有帮助。

## 编辑：

下面的类是转换器：

```
@FacesConverter("activityUserListConverter")
public class ActivityUserListConverter implements Converter {

    @Override
    public Object getAsObject(FacesContext context, UIComponent component, String submittedValue) {
        if (!(component instanceof PickList)) {
            return null;
        }

        if (StringUtils.isBlank(submittedValue)) {
            return null;
        }

        @SuppressWarnings("unchecked")
        DualListModel<ActivityUserDTO> pickListModel = (DualListModel<ActivityUserDTO>) ((PickList) component).getValue();
        ActivityUserDTO ret = null;

        for (ActivityUserDTO activityUserDTO : pickListModel.getSource()) {
            if (activityUserDTO.getId().equals(Long.parseLong(submittedValue))) {
                ret = activityUserDTO;
                break;
            }
        }

        if (ret == null) {
            for (ActivityUserDTO activityUserDTO : pickListModel.getTarget()) {
                if (activityUserDTO.getId().equals(Long.parseLong(submittedValue))) {
                    ret = activityUserDTO;
                    break;
                }
            }
        }

        return ret;
    }

    @Override
    public String getAsString(FacesContext context, UIComponent component, Object value) {
        if (value == null || value.equals("")) {
            return "";
        }

        if (value instanceof ActivityUserDTO) {
            return String.valueOf(((ActivityUserDTO) value).getId());
        }

        return "";
    }
} 
```

我也有以下`p:commandButton`提交表格。现在`actionListener`没有触发，但是如果我删除`p:pickList`了 xhtml 的表单，它就会触发。

# wordpress - Wordpress：不同帖子的不同外观

> ID：14674040
> 
> 赞同：0
> 
> 时间：2013-02-03T15:27:26.453
> 
> 标签：wordpress, wordpress-theming

我到处寻找如何做到这一点，但我没有运气。我阅读了帖子格式，但我认为这不是我想要的。

头版上的所有帖子都是相同的，但是对于功能或评论，与“标准”single.php 帖子相比，您可以拥有完全不同的外观。

例子：

**主页 //** http://ausdroid.net（所有帖子看起来都一样）

**标准单帖 //** [http://ausdroid.net/2013/02/03/samsung-galaxy-nexus-from-vodafone-receives-android-4-1-2-update](http://ausdroid.net/2013/02/03/samsung-galaxy-nexus-from-vodafone-receives-android-4-1-2-update)

**不同的单篇文章（本例为复习） //** [http://ausdroid.net/2013/02/02/huawei-ascend-d1-quad-review](http://ausdroid.net/2013/02/02/huawei-ascend-d1-quad-review)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T15:51:09.757

使用类别呈现不同单曲的示例：

`single.php`

```
<?php

if ( in_category( $foo ) )
    require( 'single-foo.php' );
else
    require( 'single-default.php' ); 
```

因此，您将在通常`single.php`的.`single.php``single-default.php``single-foo.php`

$foo 可以是类别 ID 或 Slug。

[in_category()](http://codex.wordpress.org/Function_Reference/in_category)

**编辑**

您可以修改它以使用帖子格式：

在functions.php中：

```
add_theme_support( 'post-formats', array( 'aside', 'gallery' ) ); 
```

...然后，将`if`上面示例中的语句更改为使用`has_post_format()`。

[has_post_format()](http://codex.wordpress.org/Function_Reference/has_post_format)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T15:40:34.700

[http://www.wpbeginner.com/wp-themes/create-custom-single-post-templates-for-specific-posts-or-sections-in-wordpress/](http://www.wpbeginner.com/wp-themes/create-custom-single-post-templates-for-specific-posts-or-sections-in-wordpress/)

这很好地解释了使用“单一帖子模板”插件，如果这是一个选项

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-03T15:48:30.987

您可以尝试将自定义字段添加到帖子并在 single.php 中检查它们以显示不同的布局。请参阅此视频和插件示例 - youtube.com/watch?v=L3VXnryN9iY

# haskell - 使用 parsec 解析递归数据

> ID：14674047
> 
> 赞同：4
> 
> 时间：2013-02-03T15:28:48.437
> 
> 标签：haskell, parsec, recursive-datastructures, attoparsec

```
import Data.Attoparsec.Text.Lazy
import Data.Text.Lazy.Internal (Text)
import Data.Text.Lazy (pack)

data List a = Nil | Cons a (List a)

list :: Text
list = pack $ unlines
  [ "0"
  , "1"
  , "2"
  , "5"
  ] 
```

如何实现`List Int`解析器来解析`Cons 0 (Cons 1 (Cons 2 (Cons 5 Nil)))`from `list`？

**ps**：不解析 a`[Int]`并将其转换为的纯解析器`List Int`是可取的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T15:48:44.353

像这样：

```
import Control.Applicative
-- rest of imports as in question

data List a = Nil | Cons a (List a)
  deriving Show -- for testing

-- definition of list as in question

parseList :: Parser (List Int)
parseList = foldr Cons Nil <$> many (decimal <* endOfLine) 
```

在 GHCi 中进行测试：

```
*Main> parse parseList list
Done "" Cons 0 (Cons 1 (Cons 2 (Cons 5 Nil))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T16:06:55.877

不从整数列表转换它：

```
import Data.Attoparsec.Text.Lazy
import Data.Text.Lazy (Text, pack)
import Control.Applicative

data List a = Nil | Cons a (List a)
  deriving Show

input :: Text
input = pack $ unlines [ "0", "1", "2", "5"]

list :: Parser (List Int)
list = cons <|> nil
  where
    cons = Cons <$> (decimal <* endOfLine) <*> list
    nil  = pure Nil 

main = print $ parse list input 
```

如您所见，列表解析器看起来几乎与它正在解析的数据类型完全一样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T18:03:38.903

正如其他人指出的那样，您实际上不需要使用递归（尽管可以）来解析列表。但是，如果您要解析递归语法，则可以在解析器中使用递归（请参阅 bzn 的答案和 Petr 的答案），也可以对解析器的结果进行递归（类似于您在 Markdown 中看到的嵌套）。后者我在这里介绍：[http ://www.youtube.com/watch?v=nCwG9ijQMuQ&t=17m32s](http://www.youtube.com/watch?v=nCwG9ijQMuQ&t=17m32s)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-03T15:57:46.817

我想说我们可以通过检查来做到这一点[`many'`](http://hackage.haskell.org/packages/archive/attoparsec/0.10.4.0/doc/html/src/Data-Attoparsec-Combinator.html#many%27)：

```
many' :: (MonadPlus m) => m a -> m [a]
many' p = many_p
  where
    many_p = some_p `mplus` return []
    some_p = liftM2' (:) p many_p 
```

我们可以类似地制作自己的变体：

```
many'' :: (MonadPlus m) => m a -> m (List a)
many'' p = many_p
  where
    many_p = some_p `mplus` return Nil
    some_p = liftM2 Cons p many_p 
```

并将其应用于任何一元解析器。

（注意，在第一个动作的结果中`many'`使用它自己[`liftM2'`](http://hackage.haskell.org/packages/archive/attoparsec/0.10.4.0/doc/html/src/Data-Attoparsec-Combinator.html#liftM2%27)的严格。它不是由模块导出的，所以我使用了一个普通的`liftM2`.）

或者我们可以制作一个更通用的变体，使用`Alternative`：

```
many'' :: (Alternative f) => f a -> f (List a)
many'' p = many_p
  where
    many_p = some_p <|> pure Nil
    some_p = Cons <$> p <*> many_p 
```

# c++ - 与 omp simd 并行：何时使用每个？

> ID：14674049
> 
> 赞同：65
> 
> 时间：2013-02-03T15:29:00.630
> 
> 标签：c++, c, performance, openmp, simd

[OpenMP 4.0](http://www.openmp.org/mp-documents/OpenMP4.0RC1_final.pdf)引入了一种称为“omp simd”的新结构。与旧的“parallel for”相比，使用此构造有什么好处？什么时候每个人都比另一个人更好？

编辑：这是一篇与 SIMD 指令相关的有趣[论文。](http://link.springer.com/content/pdf/10.1007/978-3-642-30961-8_5.pdf)

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-02-05T21:54:21.460

一个简单的答案：

OpenMP 仅用于为多个内核利用多个线程。这个新`simd`扩展允许您在现代 CPU 上显式使用**SIMD 指令**，例如 Intel 的 AVX/SSE 和 ARM 的 NEON。

（请注意，SIMD 指令在设计上是在单线程和单核中执行的。但是，对于 GPGPU，SIMD 的含义可以相当扩展。但是，但我认为您不需要考虑 OpenMP 4.0 的 GPGPU。 )

因此，一旦您了解 SIMD 指令，就可以使用这个新结构。

* * *

在现代 CPU 中，大致有三种类型的并行：(1) 指令级并行 (ILP)，(2) 线程级并行 (TLP)，以及 (3) SIMD 指令（我们可以说这是向量级或者）。

ILP 由您的乱序 CPU 或编译器自动完成。`parallel for`您可以使用 OpenMP和其他线程库来利用 TLP 。那么，SIMD 呢？内在函数是使用它们的一种方式（以及编译器的自动矢量化）。OpenMP`simd`是一种使用 SIMD 的新方法。

举一个非常简单的例子：

```
for (int i = 0; i < N; ++i)
  A[i] = B[i] + C[i]; 
```

上面的代码计算两个 N 维向量的和。如您所见，数组没有[（循环携带的）数据依赖性](http://en.wikipedia.org/wiki/Data_dependency)`A[]`。这个循环是[令人尴尬的并行](http://en.wikipedia.org/wiki/Embarrassingly_parallel)。

可以有多种方法来并行化这个循环。例如，在 OpenMP 4.0 之前，这可以仅使用`parallel for`构造进行并行化。每个线程将`N/#thread`在多个核心上执行迭代。

但是，您可能会认为使用多个线程来进行这种简单的加法将是一种矫枉过正的做法。这就是为什么会有向量化，这主要是通过 SIMD 指令实现的。

使用 SIMD 将是这样的：

```
for (int i = 0; i < N/8; ++i)
  VECTOR_ADD(A + i, B + i, C + i); 
```

此代码假定 (1) SIMD 指令 ( `VECTOR_ADD`) 是 256 位或 8 路（8 * 32 位）；(2)`N`是 8 的倍数。

8 路 SIMD 指令意味着一个向量中的 8 个项目可以在一条机器指令中执行。请注意，英特尔最新的 AVX 提供了这样的 8 路（32 位 * 8 = 256 位）向量指令。

在 SIMD 中，您仍然使用单核（同样，这仅适用于传统 CPU，不适用于 GPU）。但是，您可以在硬件中使用隐藏的并行性。现代 CPU 将硬件资源专用于 SIMD 指令，其中每个 SIMD*通道*可以并行执行。

您可以同时使用线程级并行。上面的例子可以进一步并行化`parallel for`。

（但是，我怀疑有多少循环可以真正转换为 SIMDized 循环。OpenMP 4.0 规范对此似乎有点不清楚。因此，实际性能和实际限制将取决于实际编译器的实现。）

* * *

总而言之，`simd`construct 允许您使用 SIMD 指令，反过来，可以利用更多的并行性以及线程级并行性。但是，我认为实际的实现很重要。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2013-02-03T18:05:24.877

链接到的标准相对清晰（第 13 页，第 19+20 行）

> 当任何线程遇到 simd 构造时，与该构造关联的循环的迭代可以由该线程可用的 SIMD 通道执行。

`SIMD`是一个子线程的东西。更具体地说，在 CPU 上，您可以想象使用`simd`指令专门请求对单独属于同一*线程的循环迭代块进行**矢量化*。它以独立于平台的方式暴露了单个多核处理器中存在的多级并行性。例如，请参阅此[英特尔博客文章](http://software.intel.com/en-us/blogs/2012/11/05/openmp-40-may-offer-important-solutions-for-targeting-and-vectorization)中的讨论（以及加速器内容） 。

 *因此，基本上，您将希望使用`omp parallel`将工作分配到不同的线程，然后可以迁移到多个内核；并且您将希望使用`omp simd`每个内核中的矢量管道（例如）。通常`omp parallel`会在“外部”处理更粗粒度的并行工作分配，并`omp simd`会绕过内部的紧密循环以利用细粒度并行性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-21T13:07:49.797

编译器不需要以 simd 子句的存在为条件在并行区域中进行 simd 优化。我熟悉的编译器继续以与以前相同的方式支持嵌套循环、并行外部、向量内部。
过去，通常采用 OpenMP 指令来防止涉及外部并行化循环（带有折叠子句的多个循环）的循环切换优化。这似乎在一些编译器中发生了变化。当设置了 omp parallel do [for] simd 时，OpenMP 4 开辟了新的可能性，包括通过一种带状挖掘优化具有不可矢量化内循环的并行外循环。ifort 有时在没有 simd 子句的情况下将其报告为外循环矢量化。然后，它可能会针对比 omp parallel do simd 更少的线程进行优化，这似乎需要比 simd 矢量宽度更多的线程才能得到回报。可以推断出这样的区别，因为没有 simd 子句，编译器被隐式要求优化循环计数，例如 100 或 300，而 simd 子句请求无条件的 simd 优化。当我有一个 24 核平台时，用于 simd 的 gcc 4.9 omp 并行看起来非常有效。*

# c# - 在 C# 中建模 C/C++ 联合

> ID：14674050
> 
> 赞同：1
> 
> 时间：2013-02-03T15:29:00.690
> 
> 标签：c#, c++, pinvoke, 32bit-64bit, unions

我的任务是在 C# 中对以下结构进行建模：

```
typedef struct _SHELLEXECUTEINFO {
  DWORD     cbSize;
  ULONG     fMask;
  HWND      hwnd;
  LPCTSTR   lpVerb;
  LPCTSTR   lpFile;
  LPCTSTR   lpParameters;
  LPCTSTR   lpDirectory;
  int       nShow;
  HINSTANCE hInstApp;
  LPVOID    lpIDList;
  LPCTSTR   lpClass;
  HKEY      hkeyClass;
  DWORD     dwHotKey;
  union {
    HANDLE hIcon;
    HANDLE hMonitor;
  } DUMMYUNIONNAME;
  HANDLE    hProcess;
} SHELLEXECUTEINFO, *LPSHELLEXECUTEINFO; 
```

工会可以在这里建模

```
[StructLayout(LayoutKind.Explicit)]
struct Union
{
    [FieldOffset(0)]
    IntPtr hIcon;

    [FieldOffset(4)]
    IntPtr hMonitor;
} 
```

这让我开始思考......由于 IntPtr 的大小从 32 位机器上的 4 和 64 位机器上的 8 变化，我如何在使用 FieldOffset 时对此进行补偿，因为示例显示 32 位的 FieldOffset 为 4机器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T15:32:50.083

实际上，在 C# 中对[a 进行建模的方法`union`](http://msdn.microsoft.com/en-us/library/acxa5b99%28v=vs.110%29.aspx)`FieldOffset`是对所有成员进行相同的操作：

```
[StructLayout(LayoutKind.Explicit)]
struct Union
{
    [FieldOffset(0)]
    IntPtr hIcon;

    [FieldOffset(0)]
    IntPtr hMonitor;
} 
```

`IntPtr`这使得这个问题变得没有意义：每个人占用多少空间并不重要，因为他们正在共享它。

# r - 根据数据，绘图中某些点之间的线？（带 R）

> ID：14674056
> 
> 赞同：0
> 
> 时间：2013-02-03T15:29:22.990
> 
> 标签：r, graph, plot, lines

我已经完成了我的研究和谷歌搜索，但还没有找到解决以下问题的方法。我经常从这个论坛找到与 R 相关的问题的解决方案，所以我想我会尝试一下，希望有人可以提出建议。我的博士论文需要它；任何我将使用的代码或建议的人自然会得到认可和认可。

所以：我需要画线/线段来连接 R 图中（特别是多维缩放）中的点（也欢迎基于 SPSS 的解决方案） - 但不是在*所有*点之间，只是那些代表属性/变量的点至少一个数据项共享 - 线的位置应基于相关绘图基于自身的数据。让我举例说明；以下是一些带有虚拟变量的虚构数据，其中“1”表示该项目具有该属性：

```
 "properties"
        a   b   c
"items" ---------
tree  | 1   1   0
house | 0   1   1
hut   | 0   1   1
book  | 1   0   0 
```

![在此处输入图像描述](../Images/2f5e0e6a32db37b43ecb2a5a0bded627.png)

该图是一个多维比例图（距离将被解释为相异）。这是逻辑：

*   A 和 B 之间有一条线，因为数据中至少有一个项目/变量（“树”）同时具有这两个属性；
*   B 和 C 之间有一条线，因为数据中至少有一个项目（“house”和“hut”）同时具有这两个属性；
*   有一个项目（“书”）只有一个属性（A），所以它不影响行的放置
*   重要的是，A 和 C 之间**没有界限**，因为数据中没有项目同时具有这两个属性。

我正在寻找的是一种自动/计算添加灰线的方法，我现在在上面的图中手动绘制了这种方法。自动绘图应基于上述数据。对于一个小的数据集，手动绘制线条是没有问题的，但是当有数十个这样的“属性”和数百个项目/行数据时，就会成为一个问题。有任何想法吗？一些 R 代码（如果可能的话，评论）将是最受欢迎的！

编辑：似乎我忘记了一些非常重要的事情。首先，@GaborCsardi 下面提出的解决方案与示例数据完美配合，谢谢！但我忘了包括点的链接也应该是“保守的”，尽可能少的连接线。例如，如果有一个项目具有所有“属性”，那么即使这些点已经由其他项目连接，即使是间接连接，它也不应该仅仅因为这个而在图中的每个属性点之间创建线。因此，基于以下数据的绘图不应是一个完整的三角形，即使 item1 具有所有三个属性：

```
 A B C
item1 1 1 1
item2 1 1 0
item3 0 1 1 
```

相反，A,B 和 B,C 应该通过一条线连接，但是 A 和 C 之间的一条线会很夸张，因为它们已经间接连接（通过 B）。这可以用发生率图来完成吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T15:41:00.347

如果您使用图表并创建表格中的二分图的投影，这将非常容易。例如

```
library(igraph)

## Some example data
mat <- "       properties
        items  a   b   c
        tree   1   1   0
        house  0   1   1
        hut    0   1   1
        book   1   0   0
       "
tab <- read.table(textConnection(mat), skip=1,
                  header=TRUE, row.names=1)

## Create a bipartite graph
graph <- graph.incidence(as.matrix(tab))

## Project the bipartite graph
proj <- bipartite.projection(graph)

## Plot one of the projections, the one you need 
## happens to be the second one
plot(proj$proj2)

## Minimum spanning tree of the projection
plot(minimum.spanning.tree(proj$proj2)) 
```

有关更多信息，请参阅手册页，`?"igraph-package"` `?graph.incidence`即`?bipartite.projection`和`?plot.igraph`。

# python - 无法用python解析简单的json

> ID：14674057
> 
> 赞同：3
> 
> 时间：2013-02-03T15:29:28.120
> 
> 标签：python, json, simplejson

我有一个非常简单的 json，我无法用 simplejson 模块解析。再生产：

```
import simplejson as json
json.loads(r'{"translatedatt1":"Vari\351es"}') 
```

结果：

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/pymodules/python2.5/simplejson/__init__.py", line 307, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/pymodules/python2.5/simplejson/decoder.py", line 335, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/pymodules/python2.5/simplejson/decoder.py", line 351, in raw_decode
    obj, end = self.scan_once(s, idx)
ValueError: Invalid \escape: line 1 column 23 (char 23) 
```

任何人都知道出了什么问题以及如何正确解析上面的json？

在那里编码的字符串是：**Variées**

PS我使用python 2.5

非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-03T15:34:20.520

那是完全正确的；`Vari\351es`包含无效转义，JSON 标准不允许 a`\`后跟数字。

无论产生什么代码都应该被修复。如果这是不可能的，您将需要使用正则表达式来删除这些转义，或者用有效的转义替换它们。

如果我们将该`351`数字解释为八进制数字，那将指向 unicode 代码点 U+00E9，即`é`字符（带有 ACUTE 的拉丁小写字母 E）。您可以使用以下方法“修复”您的 JSON 输入：

```
import re

invalid_escape = re.compile(r'\\[0-7]{1,6}')  # up to 6 digits for codepoints up to FFFF

def replace_with_codepoint(match):
    return unichr(int(match.group(0)[1:], 8))

def repair(brokenjson):
    return invalid_escape.sub(replace_with_codepoint, brokenjson) 
```

使用`repair()`您的示例可以加载：

```
>>> json.loads(repair(r'{"translatedatt1":"Vari\351es"}'))
{u'translatedatt1': u'Vari\xe9es'} 
```

您可能需要调整代码点的解释；我选择八进制（因为`Variées`是一个实际的单词），但您需要使用其他代码点进行更多测试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-03T15:34:05.417

您可能不打算使用原始字符串，而是使用 unicode 字符串？

```
>>> import simplejson as json
>>> json.loads(u'{"translatedatt1":"Vari\351es"}')
{u'translatedatt1': u'Vari\xe9es'} 
```

如果要引用 JSON 字符串中的数据，则需要使用`\uNNNN`：

```
>>> json.loads(r'{"translatedatt1":"Vari\u351es"}')
{'translatedatt1': u'Vari\u351es'} 
```

请注意，在这种情况下，生成的 dict 略有不同。解析 unicode 字符串时 simplejson`unicode strings`用于键。否则它使用`byte string`密钥。

如果您的 JSON 数据确实使用`\351e`，那么它只是被破坏并且没有有效的 JSON。

# c# - 设计插件时反射如何提供帮助？

> ID：14674058
> 
> 赞同：-4
> 
> 时间：2013-02-03T15:29:32.103
> 
> 标签：c#, java, .net, plugins, reflection

我读过反射在处理插件时特别有用。有人可以强调在这种特殊情况下的好处吗？在 C# 或 Java 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T15:33:02.983

“在最高抽象级别，宿主应用程序必须能够加载插件，然后与插件通信以利用其设计的服务。这两项任务可以根据开发人员的选择以不同的方式实现“

如果你谷歌其中一些，你可以看到这篇文章并阅读更多内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T15:34:04.063

你为什么不只是谷歌它？

如果是 .NET，您可以使用界面来创建插件的基本布局。我们称之为“IPlugIn”。然后，您使用实现 IPlugIn 的类加载程序集。现在，您可以查看所有类型，如果某个类型是由 IPlugIn 派生的，或者在程序集上定义 Attributes 以指示哪个类是插件。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-03T15:33:00.847

在我看来，您不需要依赖反射来实现插件。我建议使用常用的接口和服务。为您的插件定义一些接口以实现并让它们使用将帮助它们与您要提供的框架集成的服务。

# javascript - 获取 JavaScript 数组中的对象，其中约会.id = calEvent.id

> ID：14674060
> 
> 赞同：0
> 
> 时间：2013-02-03T15:29:33.740
> 
> 标签：javascript, jquery, arrays, jquery-week-calendar

如何获取`appointments`数组中的对象，在哪里`appointments.id = calEvent.id`？

```
appointments.push({
  id: id,
  start: startFormatted,
  end: endFormatted, 
  title: '<b>' + title + '</b><br><div id="event_body">' + body + '</div>', 
  userId: userid,
  categoryId: categoryId,
  counterId: counter
});

eventRender : function(calEvent, $event) {
  var id = calEvent.id;

  // get the object in the appointments-array where appointments.id = calEvent.id
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T15:34:27.607

您只需遍历数组以查找所需的 id：

```
for (var i = 0; i < appointments.length; i++) {
    if (appointments[i].id == calEvent.id) {
        // appointments[i] contains the desired id
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T15:34:38.570

您需要遍历`appointments`数组并找到匹配的`id`. 试试这个：

```
eventRender : function(calEvent, $event) {
    var id = calEvent.id;        
    for (var i = 0; i < appointments.length; i++) {
        if (appointments[i].id == id) {
            // do something with the appointment...
            break;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T15:35:06.187

关于什么

```
appointments[id]={

    start: startFormatted,
    end: endFormatted, 
    title: '<b>' + title + '</b><br><div id="event_body">' + body + '</div>', 
    userId: userid,
    categoryId: categoryId,
    counterId: counter
}; 
```

然后

```
eventRender : function(calEvent, $event) {
  var id = calEvent.id;
  // get the object in the appointments-array where appointments.id = calEvent.id
  var obj=appointments[id]
 } 
```

糟糕的索引总是比挑剔的循环更快，推送也很慢比每次调用 eventrender 时都循环更有效。最大的约会，最需要索引的明显

# python - Django：使用分页器持久化过滤器

> ID：14674063
> 
> 赞同：0
> 
> 时间：2013-02-03T15:29:42.303
> 
> 标签：python, django

我有显示可以按城市过滤的事件的列表页面，我也在使用 Django 分页器。我的问题是如何在另一个页面上保留过滤器？

示例 view.py 不是实际代码..

```
event_list = Event.objects.filter(city=something)
paginator = Paginator(event_list, 1) # Show 25 contacts per page 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:02:26.233

您需要手动传递额外的 get 变量，这些变量稍后将用于过滤：

```
<a href="?page={{ paginator.next_page_number }}&my_filter_a={{ my_filter_a }}&my_filter_b={{ my_filter_b }}">Next</a> 
```

# iphone - 从 Proximity Sleep 中强制唤醒 IOS 设备

> ID：14674067
> 
> 赞同：3
> 
> 时间：2013-02-03T15:30:04.317
> 
> 标签：iphone, ios

如果我使用以下方法在设备上启用接近传感器：

```
[[UIDevice currentDevice] setProximityMonitoringEnabled:true]; 
```

它按预期工作。但是我有一个在后台线程上运行的计时器，当触发时我希望设备唤醒。如果我打电话

```
[[UIDevice currentDevice] setProximityMonitoringEnabled:false]; 
```

当屏幕由于接近传感器而关闭时，设备不会唤醒。相反，我需要再次移动设备，它会在传感器禁用的情况下唤醒。

有没有办法强制设备/屏幕唤醒？是否有其他方法可以节省电池寿命？我相信简单地将屏幕亮度设置为 0.0f 不会禁用背光。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-24T03:27:13.457

你可以试试这个方法。不知道它是否适用于你的情况。

```
- (void)lightenTheScreen
{     
    [[UIApplication sharedApplication] setIdleTimerDisabled:YES];
    [[UIApplication sharedApplication] setIdleTimerDisabled:NO];
} 
```

# c# - 实体框架 - 如何将测试数据播种到使用按类型继承的实体？

> ID：14674069
> 
> 赞同：2
> 
> 时间：2013-02-03T15:30:28.213
> 
> 标签：c#, entity-framework, inheritance, table-per-type, seeding

我正在使用 EF5 代码优先、迁移和按类型继承的表。我有一些从其他类继承的类。例如`Tenant`并`Landlord`继承自`UserProfile`.

我正在使用该`protected override void Seed()`方法将测试数据添加到我的数据库中。因此，例如，我创建了 2 个`UserProfile`对象和 1`Tenant`和 1 `Landlord`。如何确保租户实体与第一个用户配置文件实体相关联，而房东实体与第二个用户配置文件实体相关联？因为我使用的是 table-per-type 继承，我是否需要明确地说`UserId`派生类的 等于`UserId`其基类的？我四处寻找，但找不到任何有用的东西。我尝试按如下方式进行：

```
protected override void Seed(Context context)
    {
        var users = new List<UserProfile>
        {
             new UserProfile { UserId=1, UserName="Matt", Email="a@a.com", AccountType=AccountType.Tenant },
             new UserProfile { UserId=2, UserName="Dave", Email="a@a.com", AccountType=AccountType.Landlord }
        };
        users.ForEach(u => context.UserProfile.AddOrUpdate(u));
        context.SaveChanges();

        var tenants = new List<Tenant>
        {
            new Tenant { UserId = users.Single(x => x.UserId = 1) /* other properties */  }
            // ...
        };
        tenants.ForEach(t => context.Tenant.AddOrUpdate(t));
        context.SaveChanges();

        var landlords = new List<Landlord>
        {
            new Landlord { UserId = users.Single(x => x.UserId = 2) /* other properties */ }
            // ...
        };
        landlords.ForEach(l => context.Tenant.AddOrUpdate(l));
        context.SaveChanges();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-11T12:14:30.000

尽管 Maximc 的想法是正确的，但我发现您可以使用该`DbContext.Set<T>`方法来`AddOrUpdate`为您的子类使用该方法，而无需先手动从数据库中获取它们：

```
protected override void Seed(Context context)
{            
    context.Set<Tenant>().AddOrUpdate(
        t => t.UserName, // or whatever property you want to use as an identifier for duplicates
        new Tenant { UserId=1, UserName="Matt", Email="a@a.com" });

    context.Set<Landlord>().AddOrUpdate(
        t => t.UserName,
        new Tenant { UserId=2, UserName="Dave", Email="a@a.com" });
} 
```

此外，您可能不应该自己指定鉴别器（在您的情况下为 AccountType）。当您正确设置 POCO 继承时，Entity Framework 将在后台为您处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T15:36:50.990

您必须使用 DbContext 来加载要分配给它的实体。

这应该这样做：

```
protected override void Seed(Context context)
    {
        var users = new List<UserProfile>
    {
         new UserProfile { UserId=1, UserName="Matt", Email="a@a.com", AccountType=AccountType.Tenant },
         new UserProfile { UserId=2, UserName="Dave", Email="a@a.com", AccountType=AccountType.Landlord }
    };
        users.ForEach(u => context.UserProfile.AddOrUpdate(u));
        context.SaveChanges();

        var tenants = new List<Tenant>
    {
        new Tenant { UserId = users.Single(x => x.UserId = context.UserProfile.First(x=>x.UserId = 1)) /* other properties */  }
        // ...
    };
        tenants.ForEach(t => context.Tenant.AddOrUpdate(t));
        context.SaveChanges();

        var landlords = new List<Landlord>
    {
        new Landlord { UserId = users.Single(x => x.UserId = context.UserProfile.First(x=>x.UserId = 2)) /* other properties */ }
        // ...
    };
        landlords.ForEach(l => context.Tenant.AddOrUpdate(l));
        context.SaveChanges();
    } 
```

# xaml - 无法将字符串转换为字符串

> ID：14674070
> 
> 赞同：3
> 
> 时间：2013-02-03T15:30:33.123
> 
> 标签：xaml, visual-studio-2012, windows-phone-8

我在 xaml 中有一个文本框。
但是当我导航到其他页面时收到此消息。
textBox 在输入、焦点和失去焦点时动态监控。
（检测是否包含文本并更改文本颜色。）
一切正常，我不知道异常会做什么。

这是文本框 xaml

```
<TextBox Name="SearchBox" TextChanged="OnTextChanged" Height="72" InputScope="Search" GotFocus="OnGotFocus" KeyDown="OnKeyDown" LostFocus="OnLostFocus"
    Text="{Binding LocalizedResources.Desc_InputKey, Mode=TwoWay, Source={StaticResource LocalizedStrings}}" >
    <TextBox.Foreground>
        <SolidColorBrush x:Name="SearhBoxColor" Color="{StaticResource PhoneTextBoxReadOnlyColor}"/>
    </TextBox.Foreground>
</TextBox> 
```

这是抛出的异常：

```
System.Windows.Data Error: ConvertBack cannot convert value 'hhh' (type 'System.String'). BindingExpression: Path='LocalizedResources.Desc_InputKey' DataItem='MyProject.LocalizedStrings' (HashCode=15848707); target element is 'System.Windows.Controls.TextBox' (Name='SearchBox'); target property is 'Text' (type 'System.String')..
   System.ArgumentException: Property set method not found.
   at System.Reflection.RuntimePropertyInfo.SetValue(Object obj, Object value, BindingFlags invokeAttr, Binder binder, Object[] index, CultureInfo culture)
   at System.Reflection.RuntimePropertyInfo.SetValue(Object obj, Object value, Object[] index)
   at System.Windows.CLRPropertyListener.set_Value(Object value)
   at System.Windows.PropertyAccessPathStep.set_Value(Object value)
   at System.Windows.Data.BindingExpression.UpdateValue(). 
```

我该如何摆脱它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:00:03.307

您正在尝试使用双向绑定从本地化资源中绑定文本。它不能工作，因为这些资源是只读的。

我相信你只是想设置你的文本框的初始值。因此，您应该绑定到您自己的属性，并使用资源对其进行初始化。

首先，在您的视图模型中创建属性：

```
public string SearchBoxColorText { get; set; } 
```

在代码中的某处初始化属性（在类构造函数中，在`OnNavigatedTo`事件中，任何适合您的工作流程）：

```
this.SearchBoxColorText = LocalizedStrings.StaticlocalizedResources.Desc_InputKey; 
```

然后将文本框绑定到此属性：

```
<TextBox Name="SearchBox" Text="{Binding SearchBoxColorText}" > 
```

# c# - 无法从其他项目中找到程序集

> ID：14674075
> 
> 赞同：0
> 
> 时间：2013-02-03T15:31:22.037
> 
> 标签：c#, visual-studio-2010

我无法从项目中找到装配体。我有两个控制台应用程序，一个我从另一个那里引用。但后来我不能做出使用语句，因为它找不到项目......

![错误图片](../Images/842316ecc9e9eaf5ea854dca9f54e755.png)

* * *

编辑：我在 Lab1PersonId 中的程序类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Lab1PersonId
{
    class Program
    {
        static void Main(string[] args)
         {
        }
     }
 } 
```

* * *

编辑：

```
using Lab1PersonId;

namespace Test
{
    public class Program
    {
        static void Main(string[] args)
        {
            Lab1PersonId lab = new Lab1PersonId();   ***
        }
    }
 } 
```

第 *** 行出错：需要类型名称，但找到命名空间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T15:33:55.013

你的设置看起来不错。您已`Lab1PersonId`在 Test 项目中添加了对该项目的引用，因此通常您应该能够使用在此程序集中定义的类。

例如，您应该首先重建`Lab1PersonId`项目，然后您应该能够添加对其中存在的某个命名空间的引用：

```
using Lab1PersonId; 
```

# debugging - Inno Setup：如何查看变量值或写入调试输出？

> ID：14674077
> 
> 赞同：40
> 
> 时间：2013-02-03T15:31:42.133
> 
> 标签：debugging, inno-setup, pascalscript

在 Inno Setup 中调试时如何查看变量值？如何打印一些东西来调试输出？

谢谢

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-02-03T15:35:40.100

目前没有调试监视窗口，但是当调试器在断点处停止时，您可以简单地悬停要检查的变量。要将某些内容打印到调试输出，请使用以下[`Log`](http://jrsoftware.org/ishelp/topic_isxfunc_log.htm)过程：

```
procedure InitializeWizard;
var
  Value: Integer;
begin
  Value := 123;
  Log('The Value is: ' + IntToStr(Value));
end; 
```

`Value`这是上一个脚本示例中悬停变量的结果：

![在此处输入图像描述](../Images/8f9e48add8c19c633d5d5b8ba08cbac4.png)

以及当您跳过`Log`语句后的调试输出窗口的结果：

![在此处输入图像描述](../Images/4c10b7555e8182b1f0f82dc80cc28c72.png)

# sql - 在单个语句与批处理中执行 SQL 更新

> ID：14674079
> 
> 赞同：0
> 
> 时间：2013-02-03T15:32:00.620
> 
> 标签：sql, performance, stored-procedures

我正在使用大型数据库，需要有关如何优化我的选择/更新的建议。这是一个前任：

```
create table Book (
   BookID int,
   Description  nvarchar(max)
)
-- 8 million rows

create table #BookUpdates (
   BookID int,
   Description  nvarchar(max)
)
-- 2 million rows 
```

假设有 800 万本书籍，我必须为其中的 200 万本更新类型。

问题：运行这些更新的时间很长。它偶尔会导致那些也试图从数据库运行语句的用户阻塞。我想出了一个解决方案，但想知道是否有更好的解决方案。我必须准备很多这样的一次性随机更新（无论出于何种原因）

```
-- normal update
update b set b.Description = bu.Description
from Book b
join #BookUpdates bu
   on bu.BookID = b.BookID

-- batch update
while (@BookID < @MaxBookID)
begin
   update b set b.Description = bu.Description
   from Book b
   join #BookUpdates bu
      on bu.BookID = b.BookID
   where bu.BookID >= @BookID
      and bu.BookID < @BookID + 5000

   set @BookID = @BookID + 5000
end 
```

第二次更新工作得更快。我喜欢这个解决方案，因为我可以向自己打印状态更新，了解它还剩多长时间，并且不会对我们的客户造成性能问题。

**问题：我在这里遗漏了一些重要的东西吗？临时表上的索引？**

我更新了示例表，所以我没有得到更多的规范化评论。每本书只有 1 个描述:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T15:55:55.670

`NOLOCK`您可以通过在 SQL 查询上使用或`READUNCOMITTED`提示来防止查询端的阻塞。

性能的真正问题可能是日志中变化的累积。您以 5,000 组为一组进行更改的方法非常合理。因为您是在批处理表中设置更新，所以您不妨计算表中的批处理号，然后在此基础上进行循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T16:01:13.343

在运行更新之前，我会先尝试您自己的建议并索引临时表：

```
CREATE INDEX IDX_BookID ON #BookUpdates(BookID) 
```

尝试使用索引和不使用索引，看看对运行时的影响是什么。如果您想避免影响您的用户进行此测试，请在工作时间之外运行它（如果可以的话）或先将 Book 复制到另一个临时表并针对它进行测试。

无论如何，考虑到数量，我希望您仍然会导致其他进程阻塞。如果您无法在没有其他进程针对此表运行时安排更新（这将是理想的解决方案），那么您现有的批量更新似乎是一个完全有效的解决方案。索引临时表也可能对此有所帮助，因此您可以增加批量大小而不会导致阻塞。

# c# - 如何将面板另存为 BMP

> ID：14674082
> 
> 赞同：0
> 
> 时间：2013-02-03T15:32:12.630
> 
> 标签：c#, winforms, bitmap, save, bmp

我正在尝试将面板上的图像保存到 BMP 中，无论何时保存，都只有一个空白图像。

绘图代码

```
 private void DrawingPanel_MouseMove(object sender, MouseEventArgs e)
    {
        OldPoint = NewPoint;
        NewPoint = new Point(e.X, e.Y);

        if (e.Button == MouseButtons.Left)
        {
            Brush brush = new SolidBrush(Color.Red);
            Pen pen = new Pen(brush, 1);

            DrawingPanel.CreateGraphics().DrawLine(pen, OldPoint, NewPoint);
        }
    } 
```

保存代码

```
 void SaveBMP(string location)
    {
        Bitmap bmp = new Bitmap((int)DrawingPanel.Width, (int)DrawingPanel.Height);
        DrawingPanel.DrawToBitmap(bmp, new Rectangle(0, 0, DrawingPanel.Width, DrawingPanel.Height));

        FileStream saveStream = new FileStream(location + ".bmp", FileMode.OpenOrCreate);
        bmp.Save(saveStream, ImageFormat.Bmp);

        saveStream.Flush();
        saveStream.Close();
    } 
```

最后结果

这是我画的

![我画的](../Images/1517a3b86c9d9365fd52291d88924576.png)

这就是节省

![保存了什么](../Images/06a16af102efc6cee990b69dd32308a7.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T17:51:42.657

您必须更改您的代码，以便它覆盖 OnPaint 方法。这是自定义控件外观时遵循的默认模式。

您的特定代码不起作用的原因是 DrawToBitmap 在调用时肯定必须重绘整个控件。在这种情况下，该方法不知道您对控件的自定义绘图。

这是一个工作示例：

```
public partial class DrawingPanel : Panel
{
    private List<Point> drawnPoints;

    public DrawingPanel()
    {
        InitializeComponent();
        drawnPoints = new List<Point>();

        // Double buffering is needed for drawing this smoothly,
        // else we'll experience flickering
        // since we call invalidate for the whole control.
        this.DoubleBuffered = true; 
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        base.OnPaint(e);

        // NOTE: You would want to optimize the object allocations, 
        // e.g. creating the brush and pen in the constructor
        using (Brush brush = new SolidBrush(Color.Red))
        {
            using (Pen pen = new Pen(brush, 1))
            {
                // Redraw the stuff:
                for (int i = 1; i < drawnPoints.Count; i++)
                {
                    e.Graphics.DrawLine(pen, drawnPoints[i - 1], drawnPoints[i]);
                }
            }
        }
    }

    protected override void OnMouseMove(MouseEventArgs e)
    {
        base.OnMouseMove(e);

        // Just saving the painted data here:
        if (e.Button == System.Windows.Forms.MouseButtons.Left)
        {
            drawnPoints.Add(e.Location);
            this.Invalidate();
        }
    }

    public void SaveBitmap(string location)
    {
        Bitmap bmp = new Bitmap((int)Width, (int)Height);
        DrawToBitmap(bmp, new Rectangle(0, 0, Width, Height));

        using (FileStream saveStream = new FileStream(location + ".bmp", FileMode.OpenOrCreate))
        {
            bmp.Save(saveStream, ImageFormat.Bmp);
        }                       
    }
} 
```

# ios - Kobold2D 设备方向

> ID：14674088
> 
> 赞同：0
> 
> 时间：2013-02-03T15:32:56.743
> 
> 标签：ios, cocos2d-iphone, screen-orientation, kobold2d

我很好奇是否有人弄清楚了这一点。从 iOS 6 开始，设备方向的工作方式发生了变化。据我所知，新方法如下所示：

```
-(BOOL) shouldAutorotate {

UIInterfaceOrientation orientation = [[UIDevice currentDevice] orientation];
if (orientation == UIDeviceOrientationUnknown)
    orientation = UIInterfaceOrientationPortrait;

if (orientation==UIInterfaceOrientationPortrait) {
    // do some stuff
}
return NO;
} 
```

我的问题是，在 Kobold2D 中，我应该把这个方法放在哪里，以便调用它来防止方向改变？无论我做什么，我似乎都无法让设备停止重新定向。

# c# - Webclient.UploadString 在后续调用中获取 System.Net.WebException:ReceiveFailure

> ID：14674093
> 
> 赞同：1
> 
> 时间：2013-02-03T15:33:11.357
> 
> 标签：c#, mono, debian, webclient, vps

我编写了一个从网页获取一些数据的 .net 3.5 控制台应用程序。在我的 Windows 7 开发机器上调试和运行时，它工作正常。

但是，当它在我的运行 Debian 6.0.5 和 Mono 2.6.7 的托管 VPS 上运行时，它会在第二次或以后调用`UploadString()`

```
System.Net.WebException: Error getting response stream (ReadDone2): ReceiveFailure ---> System.Exception:    at System.Net.WebConnection.HandleError(WebExceptionStatus st, System.Exception e, System.String where)
   at System.Net.WebConnection.ReadDone(IAsyncResult result)
   at System.Net.Sockets.Socket+SocketAsyncResult.Complete()
   at System.Net.Sockets.Socket+Worker.Receive()
  at System.Net.WebConnection.HandleError (WebExceptionStatus st, System.Exception e, System.String where) [0x00000] in <filename unknown>:0
  --- End of inner exception stack trace ---
  at System.Net.HttpWebRequest.EndGetResponse (IAsyncResult asyncResult) [0x00000] in <filename unknown>:0
  at System.Net.HttpWebRequest.GetResponse () [0x00000] in <filename unknown>:0
  at System.Net.WebClient.GetWebResponse (System.Net.WebRequest request) [0x00000] in <filename unknown>:0
  at System.Net.WebClient.ReadAll (System.Net.WebRequest request, System.Object userToken) [0x00000] in <filename unknown>:0
  at System.Net.WebClient.UploadDataCore (System.Uri address, System.String method, System.Byte[] data, System.Object userToken) [0x00000] in <filename unknown>:0
  at System.Net.WebClient.UploadData (System.Uri address, System.String method, System.Byte[] data) [0x00000] in <filename unknown>:0 
```

我的代码非常简单（我有一个 try/catch/finally，一旦完成就处理 webclient）

```
client = new WebClient();
client.Proxy = null;
client.Credentials = new NetworkCredential("xxx", "xxx");
client.Headers[HttpRequestHeader.ContentType] = "application/x-www-form-urlencoded";
string postString = "";
foreach (KeyValuePair<string, string> pair in postData)
{
    postString += pair.Key + "=" + pair.Value + "&";
}
string content = client.UploadString(url, postString);
return content; 
```

上面的代码被包装在一个方法中，并被多次调用以获取要获取的数据列表。第一次调用总是成功的。在第 2 次呼叫之后，`UploadString()`将阻塞 30 秒，然后出现上述异常。我通过观察控制台输出注意到了这一点。如果我让它循环运行，几次尝试后它会成功，然后再次失败。

我有另一种具有类似代码的方法，但`OpenRead()`改为调用并返回内容。这在我的 VPS 上运行没有任何问题。还有 2 个 PHP5 Web 应用程序托管在 VPS 上，运行没有任何问题。

由于我的 VPS 不支持 X11，而且我不知道如何使用 VS2010 远程调试代码（或者我应该使用 MonoDevelop）。我希望以前遇到过类似问题的人对此有答案，或者有一些调试此类似设置的指南。

有一个类似的问题，[WebClient“错误获取响应流](https://stackoverflow.com/questions/9454984/webclient-error-getting-response-stream) ，但答案没有帮助。谢谢

编辑：我突然想到我可以在我的开发机器上运行 MonoDevelop 和调试。现在会这样做。

编辑：尝试在 Windows 上使用 MonoDevelop + Mono 2.6.7 进行调试会产生一组不同的问题，MySQL.Data 无法连接到服务器并且 WebClient 会给出超时错误。

我求助于使用 HttpWebRequest 并且在 VPS 上运行但在我的机器上没有出现类似的异常

```
System.Net.WebException: Error getting response stream (ReadDone2): ReceiveFailure ---> System.Exception:    at System.Net.WebConnection.HandleError(WebExceptionStatus st, System.Exception e, System.String where)
   at System.Net.WebConnection.ReadDone(IAsyncResult result)
   at System.Net.Sockets.Socket+SocketAsyncResult.Complete()
   at System.Net.Sockets.Socket+Worker.Receive()
  at System.Net.WebConnection.HandleError (WebExceptionStatus st, System.Exception e, System.String where) [0x00000] in <filename unknown>:0
  --- End of inner exception stack trace ---
  at System.Net.HttpWebRequest.EndGetResponse (IAsyncResult asyncResult) [0x00000] in <filename unknown>:0
  at System.Net.HttpWebRequest.GetResponse () [0x00000] in <filename unknown>:0 
```

HttpWebRequest 实际上是在 WebClient 中使用的，因此获得相同的异常似乎是合理的。

编辑：在能够编译 Mono 2.10.8 并使用它运行之后，我得到了一个不同的异常。不确定它是否与分[块传输编码](http://en.wikipedia.org/wiki/Chunked_transfer_encoding)有关，但同样，当我在 Windows 中调试时没有这样的错误。

```
System.Net.WebException: An error occurred performing a WebClient request. ---> System.Net.ProtocolViolationException: The number of bytes to be written is greater than the specified ContentLength.
  at System.Net.WebConnectionStream.CheckWriteOverflow (Int64 contentLength, Int64 totalWritten, Int64 size) [0x00000] in <filename unknown>:0
  at System.Net.WebConnectionStream.BeginWrite (System.Byte[] buffer, Int32 offset, Int32 size, System.AsyncCallback cb, System.Object state) [0x00000] in <filename unknown>:0
  at System.Net.WebConnectionStream.Write (System.Byte[] buffer, Int32 offset, Int32 size) [0x00000] in <filename unknown>:0
  at System.Net.WebClient.UploadDataCore (System.Uri address, System.String method, System.Byte[] data, System.Object userToken) [0x00000] in <filename unknown>:0
  at System.Net.WebClient.UploadData (System.Uri address, System.String method, System.Byte[] data) [0x00000] in <filename unknown>:0
  --- End of inner exception stack trace ---
  at System.Net.WebClient.UploadData (System.Uri address, System.String method, System.Byte[] data) [0x00000] in <filename unknown>:0
  at System.Net.WebClient.UploadData (System.Uri address, System.Byte[] data) [0x00000] in <filename unknown>:0
  at System.Net.WebClient.UploadData (System.String address, System.Byte[] data) [0x00000] in <filename unknown>:0
  at System.Net.WebClient.UploadString (System.String address, System.String data) [0x00000] in <filename unknown>:0
  at (wrapper remoting-invoke-with-check) System.Net.WebClient:UploadString (string,string) 
```

编辑：`ProtocolViolationException`如果我正在使用，我会得到，`WebClient`但我得到`ReceiveFailure`，如果我使用 HttpWebRequest，这与之前的例外相同，都在 Mono 2.10.8 上

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T10:23:42.460

当您提到您使用的是 Mono 2.6.7 时，我停止阅读。这个版本已经有两年多了。

在试图找到罪魁祸首或添加任何解决方法之前，您应该首先检查问题是否仍然出现在 Mono 3.2 中，这是最后一个稳定版本（类似于 LTS）。

# html - 使用 Zurb Foundation 创建大型输入文本的正确方法是什么

> ID：14674095
> 
> 赞同：8
> 
> 时间：2013-02-03T15:33:15.840
> 
> 标签：html, forms, zurb-foundation

我已经阅读了有关[表单](http://foundation.zurb.com/docs/typography.php)的文档，并且没有说明如何使输入文本变大。更大的意思是，例如 Grooveshark 之前的搜索框，具有更大的排版和尺寸：

![像这样的文本框会很酷:)](../Images/28341057fbbf99d4187ae207ecdcacb8.png)

我已经阅读了[排版](http://foundation.zurb.com/docs/typography.php)，但它谈到了标题、列表等。可能有一种方法可以将其应用于输入文本，但我对 Foundation 真的很陌生，我不知道正确的方法。我还看到，对于[按钮](http://foundation.zurb.com/docs/buttons.php)，您可以使用相应的类“大”、“中”、“小”和“小”来控制它们的大小，但是如果我想让我的输入文本一样大怎么办按钮？

到目前为止，我有一个基本的输入表单如下：

```
<form> 
  <div class="row">
    <div class="ten mobile-three columns">
      <input type="text" placeholder="Type here what you want" />
    </div>
    <div class="two mobile-one columns">
      <a class="button expand postfix">Search</a>
    </div>
  </div>
</form> 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T11:55:15.420

根据 Foundation 的 UI 工具集，没有正确的方法。您必须将自己的 CSS 应用到 application.css 才能实现此目的。

例如：

```
input[type=text] {
    font-size: 24px;
} 
```

请注意，这仅在此特定示例中有效，您需要向`#id`搜索输入元素添加一些内容，以免将此样式设置为所有输入文本。

# javascript - jQuery 脚本忽略超链接

> ID：14674097
> 
> 赞同：0
> 
> 时间：2013-02-03T15:33:39.693
> 
> 标签：javascript, jquery, html

我的网页上有一个基本的 jQuery 脚本，它具有 div 隐藏/显示功能。

它工作得很好，但是，我注意到我在“隐藏”div ( `.newboxes2`) 中的链接没有按预期工作。我希望点击它们并被带到谷歌。

有人可以解释我如何更新我的代码来解决这个问题吗？

这是我的[jsFiddle](http://jsfiddle.net/fS5gq/5/)，希望能说明我的观点。

**jQuery：**

```
$(document).ready(function() {

 $('.showscroll').bind('click', 'h2, h3', function(e) {
   e.preventDefault();

   $(this).toggleClass('active');
   $(".newboxes2").not($(this).find(".newboxes2")).slideUp();
   $(this).find('.newboxes2').slideToggle();

               if($(this).is('.active') ) {
                       $(this).find('img.small').attr('src', '/wp-content/themes/boilerplate/images/image_corner_btn_onstate.png');
               } else {
                       $(this).find('img.small').attr('src', '/wp-content/themes/boilerplate/images/image_corner_btn_offstate.png');
               }
   if (this.id === 'service29') {
    $('html, body').animate({
      scrollTop: $(this).find('h2').offset().top
    }, 1000);
                }

 });

}); 
```

谢谢 ：-）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T15:39:33.420

你有`e.preventDefault();`你的jquery。这会阻止链接继续。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T15:55:14.077

试试这个：- [http://jsfiddle.net/fS5gq/9/](http://jsfiddle.net/fS5gq/9/)。

```
$(".ancClass").click(function (e) {
    window.location.href = $(this).attr("href");  
    return false;
}); 
```

我为锚标记添加了一个类，并添加了事件来处理重定向。

# c - 在 C 中列出文件

> ID：14674100
> 
> 赞同：1
> 
> 时间：2013-02-03T15:33:56.803
> 
> 标签：c, unix

我有一个简单的程序，列出了用 C 编写的文件。我只是想知道我可以在这段代码中添加什么，以便文件按排序顺序打印出来？谢谢

```
while ((directory = readdir(dir)) != NULL)
{
   printf("%s\n", directory->dir_name);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T15:45:22.737

您必须首先将名称存储在数组中，MAXDIRS 是最大目录数（或者您可以使用`calloc`动态分配数组）

```
#include <string.h>
#include <stdio.h> 
#include <stdlib.h> 

char dirs[MAXDIRS][512]; // you have to ensure correct allocation (eg names < 512 chars)
int ndirs = 0; // number of dirs

while ((directory = readdir(dir)) != NULL) {
   strcpy(dirs[ ndirs++ ], directory->d_name);
}

// Then sort the directories

// need a sorting function
int comp(void const *a, void const *b) { 
    char const *u = (char const *)a;
    char const *v = (char const *)b;

    return strcmp(u, v);
}

// use qsort to sort the dirs
qsort (dirs, ndirs, sizeof(dirs[0]), comp); 
```

`dirs`现在包含一个排序的目录数组

```
// display

int i;

for (i=0 ; i<ndirs ; i++) {
  printf("%s\n", dirs[i]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T15:38:09.833

`readdir()`不保证您有任何排序顺序。
如果您需要按*任何*排序顺序列出清单，则必须编写代码来执行此操作。简而言之，将所有文件名收集到一个数组中，然后根据您的排序标准对该数组进行排序。

您可以在 linux 平台上使用[scandir() 。](http://manpages.courier-mta.org/htmlman3/scandir.3.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T15:42:07.840

我建议您查找 qsort() 并使用它。您可能还会偶然发现标准库提供的其他一些有用的排序 API。

# html - 在另一个内部旋转 div 元素

> ID：14674104
> 
> 赞同：0
> 
> 时间：2013-02-03T15:34:04.533
> 
> 标签：html, css, rotation, rotatetransform

我为你准备了一个小提琴来展示我的问题是什么：

我需要将一些放置在 div-tag 内的文本转换为垂直显示。到目前为止没有问题。

[http://jsfiddle.net/pSDLY/](http://jsfiddle.net/pSDLY/)

HTML：

```
<div class="board">
  <div class="boardheading">
     <div class="verticalText">AVeryLongLongLongLongWord</div>
  </div>
  <div class="boardelement">
      Some larger content here<br>
      Some larger content here<br>
      Some larger content here<br>
  </div>
</div> 
```

相关CSS：

```
div .boardheading {
    display: table-cell;
    vertical-align: middle;
    text-align: center;
    padding: 5px;
    border-style: solid;
    overflow: visible;
    background: blue;
    /*See here: I want to have a fixed width and an automatically calculated height*/
    width: 20px;
}

div .verticalText {
    -webkit-transform: rotate(-90deg);
    -moz-transform: rotate(-90deg);
    -ms-transform: rotate(-90deg);
    -o-transform: rotate(-90deg);
    transform: rotate(-90deg);
} 
```

但是正如你所看到的，div 的高度并不能适应他的内容。宽度也不行。我希望宽度尽可能小（20px 对我来说应该是合适的尺寸，但设置宽度没有任何效果，正如您在小提琴中看到的那样）

关于如何实现这一目标的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T15:47:16.977

这应该让你朝着正确的方向前进。

```
div .verticalText {
    -webkit-transform: rotate(-90deg);
    -moz-transform: rotate(-90deg);
    -ms-transform: rotate(-90deg);
    -o-transform: rotate(-90deg);
    transform: rotate(-90deg);
    background: blue;
    padding: 5px;
    border-style: solid;
} 
```

# ios - Obj-C，顶部居中视图上的标签/

> ID：14674105
> 
> 赞同：0
> 
> 时间：2013-02-03T15:34:04.923
> 
> 标签：ios, objective-c, cocoa-touch

我在将标签定位在视图顶部时遇到了一些麻烦，以便它居中。但是，当我使用日期时，字符串的宽度会有所不同。我还注意到在 3.5 英寸的屏幕上，文本不适合。标签的两侧还有两个图像按钮。

所以我需要有一个保证金。

更复杂的是，视图仅以横向显示，因此左侧是顶部等。

```
ViewController *nextController = [[ViewController alloc] 
              initWithNibName:@"View" bundle:nil];
CGAffineTransform newTransform = CGAffineTransformMake(0.0,1.0,-1.0,0.0,0.0,0.0);         
nextController.view.transform = newTransform;
nextController.hidesBottomBarWhenPushed = YES; 
```

我确实认为我需要做的就是...

```
int margin = 50;
lblTitle.frame = CGRectMake(margin, 2, th - (margin * 2), 22); 
```

但这不起作用。这几乎就像是在左侧添加状态栏的高度，但状态栏是可见的。我有很多尝试，不知道我做错了什么。

```
lblTitle = [[UILabel alloc] initWithFrame:CGRectZero];
lblTitle.text = [NSString stringWithFormat:@"%@ - from %@ to %@", 
                       strChartType, displayStartDate, displayEndDate];

int th = self.view.frame.size.height;
//int th = self.view.bounds.size.height;

lblTitle.frame = CGRectMake(0, 2, th, 22);  // x, y, w, h

//[lblTitle setAutoresizingMask:UIViewAutoresizingFlexibleLeftMargin | 
           UIViewAutoresizingFlexibleRightMargin];

//lblTitle.center = CGPointMake( self.view.bounds.size.width / 2, 10);

[lblTitle setTextAlignment:UITextAlignmentCenter];
lblTitle.font = [UIFont boldSystemFontOfSize:14];
lblTitle.adjustsFontSizeToFitWidth = FALSE;

lblTitle.backgroundColor = [UIColor yellowColor];

[self.view addSubview:lblTitle]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T15:55:51.707

您可以获取屏幕边界，然后减去状态栏的高度以获得标签宽度。

```
float screenHeight = [UIScreen mainScreen].bounds.size.height;
float statusBarHeight = ([UIApplication sharedApplication].statusBarFrame.size.height < [UIApplication sharedApplication].statusBarFrame.size.width) ? [UIApplication sharedApplication].statusBarFrame.size.height : [UIApplication sharedApplication].statusBarFrame.size.width;
float labelWidth = screenHeight - statusBarHeight; 
```

注意：mainScreen 边界始终以纵向模式返回，因此您不必担心方向，但 statusBarFrame 可以旋转，因此您需要检查框架的宽度或高度是否为正确使用的值。

# python - 基本的 socket.io 应用程序不工作

> ID：14674109
> 
> 赞同：1
> 
> 时间：2013-02-03T15:34:20.330
> 
> 标签：python, django, socket.io

我创建并运行了一个`nodejs`文件`server.js`：

```
var io = require('socket.io').listen(8080); 
io.set('log level', 1);
io.sockets.on('connection', function (socket) {
  // pass  
}); 
```

和一个客户`client.js`：

```
window.onload = function(){
    var connected = function(){
    console.log("connect")
    }

    var start = function() {
        socket = new io.Socket();
        socket.connect('http://localhost:8080');
        socket.on('connect', connected);
    };
    start();
} 
```

我包括`socket.io`：

```
<script src="http://localhost:8080/socket.io/socket.io.js"></script> 
```

但在调试器中我查看：请求 URL：http：//undefined/socket.io/1/?t=1359905123022

我正在使用 django，我在 8000 端口运行 django 服务器...

怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T08:03:13.083

尝试在 client.js 中替换此行：

```
socket = new io.Socket();
socket.connect('http://localhost:8080'); 
```

至：

```
var socket = io.connect('http://localhost:8080'); 
```

# c++ - 类内回调函数

> ID：14674119
> 
> 赞同：1
> 
> 时间：2013-02-03T15:35:07.973
> 
> 标签：c++, class, function, callback

我正在尝试为 sfml 窗口创建一个窗口容器。如果您不熟悉 sfml，则 sfml 窗口是一个不可复制的类，因此例如不能放在 std::vector 中。

我已经完成了大部分工作，但我现在正在尝试实现某种回调函数，该函数将在调用 window.Display() 以更新窗口之前完成 open-gl 绘图工作。

我无法理解回调函数的语法（c 或 c++ 版本）。有人愿意向我解释一个例子吗？

更好的是，有人愿意解释如何在类中实现回调函数的示例，以便可以将函数（用户定义的）传递给类的函数，该函数将记住该函数是什么所以它以后可以被类调用。

为了使上面的句子更清楚：我认为我需要三件事：

1)：用户定义的函数，例如：

```
void doDrawing(){
    // do some open gl stuff
} 
```

2 :) 类中的一个函数，它接受上述用户定义函数的参数：

```
void setDisplayFunc( ?argument of a function? argument ){
    function_pointer pointer = argument;
} 
```

我不知道'argument'应该是什么类型，或者'function_pointer'必须是什么......我认为这是我最卡住的地方！

3:) 类可以调用上面分配的函数的一种方式。

```
// Do the function which is pointed at by pointer, which is of the type 'function_pointer' ... Whatever function_pointer happens to be! 
```

如果有人以前使用过 glut，那么我想我正在尝试实现 glut 回调函数，如下所示：

```
void someDisplayFunction(){
    // do open gl stuff
}

glutDisplayFunc( someDisplayFunction ); 
```

上面的函数接受用户定义函数的参数，然后在我们调用 'glutPostRedisplay' 时执行它......

我希望这是有道理的，我已尝试提供尽可能多的信息来提供帮助。任何帮助表示赞赏。（：

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T15:41:31.900

如果您使用的是 C++11，则可以使用[std::function](http://en.cppreference.com/w/cpp/utility/functional/function)。

```
void setDisplayFunc(const std::function<void()>& function) {
    function(); // call the function
} 
```

我相信它`<functional>`，所以请记住`#include <functional>`。

我也总是忘记函数指针的 C 风格语法，所以我非常喜欢在这种情况下使用 STL。您可以像使用任何其他对象一样管理它，它接近于 C# 等高级语言（我的意思是用于传递函数）。

如果您的项目没有使用 C++11，那么您将被旧语法困住。查看其他答案以了解如何使用它。

但是，如果您想稍后使用它，请查看[文档](http://en.cppreference.com/w/cpp/utility/functional/function)以了解函数接受参数、传递默认参数等的语法。您可能会发现它对进一步使用很有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T15:40:19.883

你想要一个函数指针。在你的情况下：

```
typedef void (*function_pointer)(); 
```

有了它，你可以写：

```
void setDisplayFunc(function_pointer argument){
    function_pointer pointer = argument;
} 
```

要调用它，您只需执行以下操作：

```
pointer(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T15:40:02.363

你想要做的是传递一个指向函数的指针，或者一个函数指针。

```
typedef void (*function_pointer)(); 
```

试试这个的类型`argument`。您实际上可以通过查看其标题来了解 glut 是如何做到的。

# c# - C# Backgroundworker 新问题

> ID：14674123
> 
> 赞同：0
> 
> 时间：2013-02-03T15:35:25.007
> 
> 标签：c#, backgroundworker

我正在为我的问题寻找一个有效的解决方案。我正在使用 VS 2010。我想从 wcf 服务方法执行一系列操作，并将每个操作状态发送回调用客户端。我已经设置了带有回调合同的 wcf 并使用了双工通道，我能够连接到 wcf。当我开始长时间运行的操作时，有时会触发回调，有时不会。我不知道为什么。以下是我遵循的方法。

在 wcf 服务方法中，

```
 public void Start()
  {
      List<Employee> empLists = GetEmpData();  // geting lots of employee objects
      foreach(Employee emp in empLists)        // maybe 1000 records
      {
          StartlongRunning(emp);
      }
  }

 private void StartlongRunning(Employee emp)
 {
     // here i am creating a new background worker...
     // Here i am registering for RunWorkerCompleted, DoWork, ReportProgress events...
     bgw.RunWorkerAsync(emp)
 }

 void bgw_DoWork(object sender, DoWorkEventArgs e)
 {
     Employee emp = (Employee)e.Argument;
     using (ClassA p = new ClassA(emp.ID)) // this class is from another dll.
     {
       e.Result = p.StartProcess(emp.Code);
     } 
 }

 void bgw_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
 {
    // This is not calling properly.
    // Sometimes this method is working...most of the time it is not working..
    // here i am unregistering the registerd DoWork, RunWorkerCompleted events...
    // calling bgw.Dispose(); // i tried without this also;...but no use...
    // from here I am firing the callback to client...
 } 
```

下面是 StartProcess 方法的实现。

```
 public string StartProcess(string empcode)
 {
     // call to another method1() // here saving to DB frequently. works fine
     // call to another method2() // here also saving to DB frequently. works fine
     // call to someother method3()  // here also some DB insert frequently. fine
     // call to Method4() // here also some DB insert.
                          // this method is not calling frequently..
                          // sometimes it is calling but most of times not..why ???
     return value;
 }

 private void SaveToDB(args1, args2...)
 {
     DatabaseHelper.Save(args1, args2.....); // this static class is from another dll
     // only DB operation in this static class..
 } 
```

这个静态类的实现如下所示。

```
using (SqlConnection conn = new SqlConnection(DBConnection))
{
     conn.open;
      using (SqlCommand cmd = conn.CreateCommand())
      {
         ...adding parameters
         cmd.ExecuteNonQuery();
      }
      conn.close();
} 
```

如果`StartProcess`返回，则后台工作人员将执行该`RunWorker`方法。但它没有发生。这里有什么问题？

我正在`ClassA`为每个后台工作人员创建每个对象。一旦一个对象`ClassA`完成，那么它就会被释放。

但我不知道为什么`StartProcess`没有正确回电。

`ClassA`在我的实现中，后台工作人员之间是否存在对象重叠？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:01:35.130

我认为问题在于您在循环中调用 RunWorkerAsync 而不检查它是否不忙。您应该使用列表作为参数调用 RunWorkerAsync，而不是尝试在不同的线程中启动所有工作。

我会做这样的事情：

```
 public void Start()
 {
     List<Employee> empLists = GetEmpData();  // geting lots of employee objects
     StartlongRunning(empLists);
 } 
```

并相应地更改 bgw_DoWork。

如果您需要查看进度，您可以为每个员工对象调用 ReportProgress。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:51:30.970

如果您想创建应用程序以同时使用多个 backgroundWorker，您应该为您正在执行的每个操作初始化新的 backgroundWorker 对象。这将解决问题。

# c# - 如何防止用户进行未经授权的 Web 方法调用和篡改客户端验证

> ID：14674124
> 
> 赞同：1
> 
> 时间：2013-02-03T15:35:25.957
> 
> 标签：c#, jquery, asp.net, ajax, webmethod

我正在创建一个网页，用户可以在其中注册自己和他们新购买的产品。

因此，该页面最初包含两个输入字段：序列号和他们的社会保险号。这些值将针对两个不同的 API 进行验证。用户不应滥用这些 API 调用，因为第二个调用每次调用都要花钱。另一个也应该以某种方式受到限制，以便用户无法访问我们所有的序列号。

并希望用ajax 制作这个网页，以创造良好的用户体验。所以我使用jQuery ajax 函数来调用我放在页面代码隐藏中的webmethods。

反过来，每个 Web 方法都使用凭据调用匹配的 API。但这是否意味着任何人都可以编辑脚本客户端，以便他们可以对 API 进行多少次调用？

我需要能够防止这种情况发生。我该怎么做呢？我可以检查调用不是由用户插入的脚本发起的吗？

另一个问题，如何在客户端验证两个 ajax 调用都已成功返回？如果只有一个 ajax 调用，这很容易。我会在成功中做一些事情：ajax 函数的一部分。我可以检查输入字段旁边的所有复选标记是否可见，但这很容易被用户篡改。那么有什么好方法呢？一旦成功进行了两次调用，我想启用一个按钮，以便用户可以确认来自 API 的结果。

```
[WebMethod]
    public static string CheckSerialNumber(String _input)
    {
        string result = null; 
        var client = new CheckSerialNumberClient(); //A service reference to the API
        try
        {
            //make the API call.
            result = client.checkSerialNumber(_input);
        }
        catch (Exception)
        {
            result = "An error occured";
        }
        return result;
    }

[WebMethod]
    public static string GetCustomerInfo(String _input)
    {
        string result = null; 
        var client = new CustomerInfoClient(); //A service reference to the API
        try
        {
            //make the API call.
            result = client.getCustomerInfo(_input, myCredentials); //credentials is so that the company that has the API can charge us for each call.
        }
        catch (Exception)
        {
            result = "An error occured";
        }
        return result;
    } 
```

jQuery，我得到了这个工作，但不妨展示它。这是在针对正则表达式验证输入之后：

```
$.ajax({
type: "POST",
url: "/Default.aspx/CheckSerialNumber",
data: ...
contentType: "application/json; charset=utf-8",
dataType: "json",
success: function (msg) {
    return true;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T15:55:20.000

您可以使 CheckSerialNumber 返回一个 nonce（单次使用密钥），在调用 GetCustomerInfo 时必须使用该 nonce（然后验证服务器端）。这将强制您的 api 用户在转到 GetCustomerInfo 之前通过 CheckSerialNumber。

这将解决调用 GetCustomerInfo 而不首先通过序列号验证的问题，但不会阻止某人重复调用第一个然后再调用另一个，直到您用完现金，前提是他们至少有一个经过验证的序列号。

您可以限制每个序列号的调用次数，在这种情况下，攻击者必须生成有效序列号列表（不确定这有多容易）

您可以检查请求 ip 并尝试限制这样的调用，但老实说，很难阻止足够坚定的人绕过此类限制，因此通常此类攻击是在网络级别处理的。如果您使用 SSL，这将使生活变得更加困难，因为据我所知，在使用 SSL 时不可能进行 IP 欺骗，但同样，它不是防弹的。

设置 cookie 等与使用攻击工具时删除 cookie 或忽略它们很容易无关。

至于确认一切顺利，在第一次调用的成功方法中，您可以调用第二次验证（如果您实现了一个随机密钥，无论如何您都必须这样做）。然后在 GetCustomerInfo 的成功方法中，您可以确认它也验证成功。

作为最后的手段，限制您在给定时间范围内对 client.getCustomerInfo api 的调用次数，因此如果有人确实绕过了您的限制，您可以通过限制您为该服务支付的费用来限制入侵的影响。例如，您可以说平均每分钟有 100 个调用，因此每分钟超过 200 个调用都应该停止服务处理新请求，直到您了解这是实际请求的激增还是攻击。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T15:42:09.953

您应该始终验证从客户端发送的数据，无论它是否在客户端上进行了验证。否则，您将容易受到恶意客户端的攻击。如果您担心恶意客户端，您必须接受不会有万无一失的方法来防止篡改。您可以通过使用身份验证和授权系统、为每个请求添加令牌、限制允许的请求数量等等来让它们变得更难一些……但即便如此，也没有绝对的安全性。

如果您想检查两个呼叫是否成功，只需在呼叫成功返回时设置一些全局标志。或者您可以在第一个呼叫成功之前发起第二个呼叫。您还可以返回一些令牌，这是以后调用所需的，但这也可能被滥用。

出于安全考虑，您可能还想查看[OWASP](http://www.owasp.org)网站。尤其是“参考”和“操作方法”部分可能很有用。

并且总会有客户端关闭 javascript，然后您的网站将无法按预期运行。

还要考虑想要编写这些访问脚本的客户。或者，您可能想将这些 Web 方法作为 API 提供，那么将没有带有 javascript 的客户端，并且您必须在服务器上验证提供的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T15:45:44.257

您是否为每个 Web 输入进行一次 ajax 调用？为什么不将它们组合成 1，作为形式？

请记住，除了任何客户端验证之外，您还应该始终进行服务器端验证。客户端验证不足以确保安全。在这种情况下，您可以使用会话变量或数据库表来记录用户进行的呼叫次数，对照他们的序列号来识别他们。然后，您将有办法在 x 次尝试失败后忽略它们。

您也可以使用他们的 IP 来识别他们，但这并不可靠 - 许多人拥有可以轻松更改的动态 IP 地址。IP地址也可以很容易地被欺骗。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T15:43:51.070

在数据库中捕获用户存储的 IP 地址，并且只允许每分钟 x 次尝试和每天 x 次尝试。

# scala - 如何在Scala中定义一个返回类型基于参数类型和类型参数的方法？

> ID：14674125
> 
> 赞同：1
> 
> 时间：2013-02-03T15:35:37.450
> 
> 标签：scala, types

我想定义一个方法，它的返回类型取决于传递给该方法的参数类型和封闭特征的类型参数。很难用语言来描述我的意思，所以下面是一些片段来解释。

我有一些积木

```
// This is the target of a binding
trait BindableValue[T] {
  def set(value: T): Unit

  // this is the method I am strugling with
  def bindTo[S](o: S) = ???
}

// This will dispatch events of type T
trait Observable[T]

// This represents a value of type T that will 
// dispatch events if the value changes
trait ObservableValue[T] extends Observable[T] {
  def value: T
}

// An Observable can be converted to an optional ObservableValue
object ObservableValue {
  implicit def wrap[T](o:Observable[T]):ObservableValue[Option[T]] = 
    new ObservableValue[Option[T]] {
      val value = None
    }
} 
```

绑定具有源和目标，并存在两种：

1.  Complete：源类型参数和目标类型参数相同
2.  不完整：源和目标类型参数不同

...

```
trait Binding[S, T] {
  def source: ObservableValue[S]
  def target: BindableValue[T]
}

class CompleteBinding[T](
  val source: ObservableValue[T], 
  val target: BindableValue[T]) extends Binding[T, T]

class IncompleteBinding[S, T](
  val source: ObservableValue[S], 
  val target: BindableValue[T]) extends Binding[S, T] 
```

我可以构造以下实例。

```
val bindable1 = new BindableValue[Int] { def set(value:Int) = {} }
val property1 = new ObservableValue[Int] { def value = 0 }
val property2 = new ObservableValue[String] { def value = "" }

val bindable2 = new BindableValue[Option[Int]] { def set(value:Option[Int]) = {} }
val event1 = new Observable[Int] {}
val event2 = new Observable[String] {} 
```

现在我想像这样使用这些实例：

```
// 'a' should be of type CompleteBinding
val a = bindable1 bindTo property1

// 'b' should be of type IncompleteBinding
val b = bindable1 bindTo property2

// 'c' should be of type CompleteBinding
val c = bindable2 bindTo event1

// 'd' should be of type IncompleteBinding
val d = bindable2 bindTo event2 
```

我不知道如何定义该方法`bindTo`，以便它编译上述 4 行并为所有值提供正确的具体类型。我只是想念有关 Scala 类型系统的知识。

尽管我很想找到一个解决方案，但我也想了解自己将来如何找到这样的解决方案。如果您对上述问题有解决方案，您能否向我指出一些可以用来教育自己的资源？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T16:29:25.567

类型类可以帮助您解决问题。首先让我们定义简单的特征：

```
trait Composeable[A, B, R] {
    def compose(a: A, b: B): R
} 
```

它只是将它们组合`a`到`b`其他类型的容器中`R`。

`CompleteBinding`现在让我们为伴生对象和在伴生对象中定义它的 2 个具体实现，`IncompleteBinding`并使它们隐含：

```
object Composeable extends LowPriorityComposables {
    implicit def  comCommplete[T] = new Composeable[ObservableValue[T], BindableValue[T], CompleteBinding[T]] {
        def compose(a: ObservableValue[T], b: BindableValue[T]) = new CompleteBinding(a, b)
    }
}

trait LowPriorityComposables {
    implicit def  comIncommplete[S, T] = new Composeable[ObservableValue[S], BindableValue[T], IncompleteBinding[S, T]] {
        def compose(a: ObservableValue[S], b: BindableValue[T]) = new IncompleteBinding(a, b)
    }
} 
```

如您所见，实现非常简单。它只需要`ObservableValue`和`BindableValue`然后结合在`Binding`. 我将它们分成不同的特征，因为通常它们都可以使用，如果您观察并绑定某种类型的相同值`T`（的情况`CompleteBinding`）。通过提取`comIncommplete`单独的特征，我告诉编译器，如果没有找到其他合适的隐式，它应该使用它。换句话说，您告诉编译器始终尝试应用`CompleteBinding`，如果无法完成，则`IncompleteBinding`应该应用。

唯一剩下的就是定义`bindTo`使用`Composeable`类型类的方法：

```
def bindTo[S, R](o: ObservableValue[S])(implicit ev: Composeable[ObservableValue[S], BindableValue[T], R]): R = 
    ev.compose(o, this) 
```

在这里我说，第一个参数是包含 type 值的`o`一些参数，但我也想编译以找到一个证据，即存在一些隐含的，证明我可以用. 当我有这样的证据时，我只是用这个（可绑定的）组成可观察的。如您所见，类型参数类似于自由变量 - 编译器可以自行计算，因此您始终可以从方法返回创建类型信息。`ObservableValue``S``ObservableValue[S]``BindableValue[T]``R``bindTo`

现在你所有的测试用例都应该编译得很好：

```
val a: CompleteBinding[Int] = bindable1 bindTo property1
val b: IncompleteBinding[String, Int] = bindable1 bindTo property2
val c: CompleteBinding[Option[Int]] = bindable2 bindTo event1
val d: IncompleteBinding[Option[String], Option[Int]] = bindable2 bindTo event2 
```

# java - 在垂直滚动视图中显示 5000 个项目列表

> ID：14674129
> 
> 赞同：-2
> 
> 时间：2013-02-03T15:36:10.823
> 
> 标签：java, android, scroll

这个问题可以分两部分来表述：

1.  滚动视图处理 5000 个项目是否太多？（在它的内存浪费方面，大部分列表在给定时间将不可见）

2.  是否有推荐的方法来处理部分列表并在用户上下滚动时添加/附加更多项目？（最好是透明的方式，让用户有流畅的滚动体验）

我尝试通过添加自己的 onScrollListener 来做到这一点，我发现的问题是，就好像我更改滚动视图内容一样，我需要滚动它以将可见列表保持在同一项目位置。
为什么？因为如果当前 y 滚动位置是项目编号 19 上的 445，并且我在顶部添加一个项目，项目 19 现在将位于 y 滚动位置 478。
所以我应该滚动到位置 478 以保持用户的相同视图。而这一切使得滚动不流畅。

更多解释：我尝试显示一个二维表，与电子表格不同。并且表格是动态填充的，表格中每一列的宽度可能会因新数据而改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:32:15.310

您可能只想从了解 ListViews 开始。

看到这个 SO 问题：[Efficient ListView in android](https://stackoverflow.com/questions/11684520/efficient-listview-in-android)

或者，如果你想做某种类型的电子表格，比如视图，你可能想看看这个项目：

[https://github.com/jess-anders/two-way-gridview](https://github.com/jess-anders/two-way-gridview)

我还没有尝试过，但它似乎解决了您的一些问题。

# javascript - javascript增加了误解

> ID：14674132
> 
> 赞同：0
> 
> 时间：2013-02-03T15:36:40.667
> 
> 标签：javascript

```
 </!DOCTYPE html>
</html>
</body>

<p>Given that y=5, calculate x=++y, and display the result.</p>
<button onclick="myFunction()">Try it</button>

<p id="demo"></p>

<script>
function myFunction()
{
var y=5;
var x=++y;
var demoP=document.getElementById("demo")
demoP.innerHTML="x=" + x + ", y=" + y;
}
</script>

<p><strong>Note:</strong> Both variables, x and y, are affected.</p>
</body>
</html>*/ 
```

显然，我是一个初学者，但我没有其他人可以问。如果有人能解释`demop.innerHTML="x=" + x + ", y=" +y;`这段代码背后的原因，那将会很有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T15:38:03.113

> 如果有人能解释 demop.innerHTML="x=" + x + ", y=" +y; 背后的原因会很有帮助 在这段代码中

那行代码不会增加任何内容，在该行中`+`是字符串连接运算符，而不是数字加法运算符。它用于构建一个字符串（它不会更改`x`or `y`），然后将其分配给`demoP.innerHTML`，它将 DOM 元素的内容替换为该字符串的内容。

对于初学者来说有点难以理解的是这一行：

```
var x=++y; 
```

这做了三件事：

1.  它声明了一个`x`在当前作用域 ( `var`) 中调用的变量。

2.  它增加 的值`y`。

3.  它将*增加*的值分配给`x`。

所以两者都以`x`结束`y`，`6`因为增量发生在用于初始化的值*之前*。这称为“前缀增量”。“Pre”是因为它发生在我们将值用于某事之前。`y``x`

与大多数从 B 派生主要语法的语言（如 C、C++、Java、C#、JavaScript 和许多其他语言）一样，还有一个“后缀”增量：

```
var x = y++; 
```

“发布”，因为我们在使用该值*后*递增。如果该行如上所示，`x`将得到`5`(`y`的旧值) 并`y`得到`6`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T15:38:55.387

```
demoP.innerHTML = "x = " + x + ", y = " + y; 
```

这将设置由 标识的元素的 HTML `demoP`。`+`将字符串和数字连接成一个字符串，该字符串将是`demoP`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T15:39:45.293

当您单击“尝试”按钮时，该函数`myFunction()`将被执行，并且元素内的 id 元素的 HTML`demo`更改为：x=6, y=6

# android-actionbar-compat - 未调用 Android OnNavigationListener

> ID：14674136
> 
> 赞同：1
> 
> 时间：2013-02-03T15:37:04.483
> 
> 标签：android-actionbar-compat

我正在使用 ActionBarCompat 创建一个操作栏。我可以使用 ArrayAdapter 在其中显示下拉导航列表。但是，我想在它上面附加一个 OnNavigationListener，这就是我遇到这个问题的地方：它没有效果。当我第一次将它附加到操作栏时，它只会被触发一次。这是我的 OnNavigationListener 实现：

```
class RaditazActionBarListener implements ActionBar.OnNavigationListener {
    @Override
    public boolean onNavigationItemSelected(int itemPosition, long itemId) {
        Intent parentActivityIntent = new Intent(ctx, Player.class);
        startActivity(parentActivityIntent);
        return true;
 } 
```

这是我将它附加到我的操作栏的方式：

```
getActionBar().setListNavigationCallbacks(mySpinnerAdapter, new RaditazActionBarListener()); 
```

知道为什么当我在下拉列表中选择项目时没有触发侦听器吗？

谢谢，伊戈尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T10:16:08.797

由于没有代码`mySpinnerAdapter`很难猜测：

1.  也许您正在尝试选择一个已经选择的项目（这不会给出回调）。
2.  也许您尝试选择的此项是列表中唯一的一项（根据您的`OnNavigationOtemSelected()`代码猜测）
3.  一堆其他可能的原因

# android - 通过服务的通知随机启动

> ID：14674137
> 
> 赞同：2
> 
> 时间：2013-02-03T15:37:07.327
> 
> 标签：android

我尝试通过服务通知进行简单的提醒。我选择了一些动作的时间，我想在那个时间结束前 10 分钟设置通知。它工作一次，我将计时器设置为 12 分钟，我在 2 分钟后收到通知。但是然后我每 25-35 分钟收到一次随机通知当然我可以一次收到很少的通知并且它们有效，但是随后我收到了随机通知并且我不知道如何阻止它们...我应该将通知 id 发送到服务并停止服务吗发送通知后？

定时器代码：

```
 Intent intent = new Intent(Review.this, AlarmService.class);

            PendingIntent pintent = PendingIntent.getService(Review.this, unique,     intent, PendingIntent.FLAG_ONE_SHOT);
            AlarmManager alarm = (AlarmManager)     getSystemService(Context.ALARM_SERVICE);
        alarm.set(AlarmManager.RTC_WAKEUP, currTimestamp - (10 * 60000), pintent); 
```

和服务代码：

```
 notifyMgr=(NotificationManager)getSystemService(NOTIFICATION_SERVICE);        
Notification notifyObj=new Notification(R.drawable.icon, "alarm",     System.currentTimeMillis());
PendingIntent i=PendingIntent.getActivity(this, 0, new Intent(this, MainList.class),  0);
notifyObj.setLatestEventInfo(this, "10 min to finish", "Click here to see list", i);
notifyObj.defaults |= Notification.DEFAULT_VIBRATE; 
notifyObj.defaults |= Notification.DEFAULT_SOUND;
notifyObj.flags|=Notification.FLAG_ONLY_ALERT_ONCE;    
notifyMgr.notify(1, notifyObj); 
```

我尝试了标志：一次射击，只发出一次警报，但我仍然收到这个随机通知：/也许整个代码都是错误的......不知道

# php - 无法使用 [function.move-uploaded-file] CAKEPHP 将 tmp 文件移动到正确的文件夹

> ID：14674138
> 
> 赞同：0
> 
> 时间：2013-02-03T15:37:15.230
> 
> 标签：php, cakephp, file-upload, cakephp-2.0

我正在尝试使用 cakephp 上传文件

我目前正在使用[教程](http://www.tuxradar.com/content/cakephp-tutorial-build-file-sharing-application)，但遇到了一些错误，尤其是 move-uplaoded-file。

错误 ：`Indirect modification of overloaded property UploadsController::$data has no effect`

我看到我的上传确实创建了一个包含信息详细信息的数组，它只是没有将它传递给数据库或移动 tmp 文件。

这是我的上传功能：

```
function uploadFile() {
    $file = $this->data['Upload']['file'];
    if ($file['error'] === UPLOAD_ERR_OK) {
        $id = String::uuid();
        if (move_uploaded_file($file['tmp_name'] , APP . 'uploads'.DS.$id)) {
            $this->data['Upload']['uploadID'] = $id;
            $this->data['Upload']['fileName'] = $file['name'];
            $this->data['Upload']['fileSize'] = $file['size'];
            $this->data['Upload']['fileType'] = $file['type'];
            return true;
        }
    }
    return false;
} 
```

任何帮助都会很棒，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T15:54:48.280

为了获取表单发送的数据（在您的情况下是文件本身），您必须使用 `$this->request->data`而不是`$this->data`.

我希望这有帮助。

# safari - 无法从 applescript 变量中提取 URL 属性（Safari）

> ID：14674142
> 
> 赞同：0
> 
> 时间：2013-02-03T15:37:44.067
> 
> 标签：safari, applescript

我对这些都不感兴趣……所以我希望以下内容就足够了。

我想从当前的 Safari 选项卡中获取属性，然后稍后在我的脚本中使用它们。在执行以下操作时：

```
tell application "Safari"
set pageInfo to properties of current tab of window 1
end tell

set subJect to name of pageInfo
set urlName to URL of pageInfo 
```

为 subJect 分配了一个值，但 urlName 没有，我收到一条错误消息

> “无法获取 {name:\“无法从 applescript 变量中提取 URL 属性 - Stack Overflow\”的 URL，URL:\” [https://stackoverflow.com/questions/ask?title=cant%20extract%20url %20applescript%20object](https://stackoverflow.com/questions/ask?title=cant%20extract%20url%20applescript%20object) \", index:6, visible:true, class:tab}." 来自 {class:«class bTab» 的 URL 的编号 -1728，名称：“无法从 applescript 变量中提取 URL 属性 - 堆栈溢出”，URL：” [https://stackoverflow.com/questions/ask?title=cant% 20extract%20url%20applescript%20object](https://stackoverflow.com/questions/ask?title=cant%20extract%20url%20applescript%20object) "，索引：6，可见：true}

我的问题是什么？我只想能够将属性分配给“变量”，然后访问它们

干杯，CSS

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T18:18:05.277

Applescript 在使用 URL 时遇到问题。如果您在 applescript 编辑器窗口中注意到它是蓝色的，这意味着它是 applescript 的关键字。我相信这就是你遇到的问题。因此，只需将这两行移动到 Safari 的 tell 块中，它应该可以工作，因为 Safari 了解如何为此目的使用 URL。当然，一旦您有了 urlName，您就可以在 tell 块之外使用该变量。

```
tell application "Safari"
    set pageInfo to properties of current tab of window 1
    set subJect to name of pageInfo
    set urlName to URL of pageInfo
end tell 
```

# javascript - 使用流程图创建 PDF 报告

> ID：14674150
> 
> 赞同：9
> 
> 时间：2013-02-03T15:38:55.937
> 
> 标签：javascript, jquery, pdf, flot, xhtmlrenderer

我正在尝试为我的客户实现一个自动报告生成工具。我需要创建 pdf 格式的报告，而且我非常喜欢使用 Jquery flot 创建图表。我只需要一种方法来获取 pdf 中的图表。

我尝试使用*飞碟（xhtmlrenderer）*来捕获图形的图像，但它似乎对我没有帮助，因为图形是由 javascript 创建的。

xhtmlrenderer 可以捕获使用 javascript 创建的元素吗？

还是他们的任何其他可以捕获图形图像的工具？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-03T16:51:09.973

Flot 在 HTML5`<canvas>`元素上绘制图形。所以可能的情况可能如下：

1.  `toDataURL`如[本答案](https://stackoverflow.com/a/3514404/693538)中所述，从画布中检索图像数据。
2.  [使用jsPDF](http://jspdf.com/)创建一个 PDF ，`addImage`像第一个示例一样使用将图像嵌入其中。

~~**但是**请注意，在这种情况下，您不会在图像中看到任何轴标签，因为它们不是在画布上绘制的，它们是`<div>`使用`position:relative`. 我发现[这篇文章](http://www.sanghvilabs.com/2012/02/01/canvas-text-labels-in-flot-graphs/)作者提供了一个 Flot 插件，它强制 Flot 在画布上绘制文本，但我不知道它是否有效。~~ **UPD：**画布上的绘图标签包含在即将发布的 0.8 版本中（见评论）。

**但是²***图例*也没有绘制在画布上，它也是一个正确定位的`<div>`. 似乎 Flot 社区的人正在尝试对此做些什么，我发现了两个拉取请求，[第一个](https://github.com/flot/flot/pull/36)修改核心，[另一个](https://github.com/flot/flot/pull/42)引入插件。它们都没有合并大约 9 个月，并且它们被标记为 v. 0.9 里程碑，这是在下一个之后并且没有截止日期。至少可以克隆这些人的存储库并测试他们的工作。

***简历：** Flot 周围的许多人都关心这个问题，但遗憾的是，还没有稳定的、开箱即用的方法来解决这个问题——只是希望 0.9 最终会出现，有时会解决这个问题。*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-27T04:12:03.697

我已经将一个 JSFiddle 与如何使用 Flot + Html2Canvas + jsPDF 完成此操作的示例放在一起。导出的PDF包括轴、图例等：

```
 html2canvas($("#placeholder").get(0), {
   onrendered: function(canvas) {
     document.body.appendChild(canvas);

     var imgData = canvas.toDataURL('image/png');
     var doc = new jsPDF('landscape');

     doc.addImage(imgData, 'PNG', 10, 10, 190, 95);
     doc.save('sample-file.pdf');
   }
 }); 
```

[JS小提琴](http://jsfiddle.net/jyu4v/1/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-03T18:22:39.613

如果您可以在服务器端执行此操作并且您在基于 Unix 的系统上，我会尝试[wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/)。

**一段时间后的编辑**

现在有一天，为了做这个服务器端，我会使用很棒的[phantomjs](https://github.com/ariya/phantomjs/blob/master/examples/rasterize.js)。我已经在基于 flot 的项目中使用它一段时间了，它运行良好。

# android - 将大位图加载到 ViewPager 中的 ImageView - 内存不足

> ID：14674156
> 
> 赞同：6
> 
> 时间：2013-02-03T15:39:40.833
> 
> 标签：android, bitmap, imageview, out-of-memory, bitmapfactory

我有 ViewPager 用于显示可缩放图像（使用[ImageViewTouch](https://github.com/sephiroth74/ImageViewZoom)）。我需要从 Internet (http) 加载大型位图。大我的意思是2000x1000。图像需要很大，因为它们是可缩放的并且需要显示细节。服务器上的图像是 .jpg 格式，但这没问题 - 我可以更改它。

我怎样才能设法将这么大的图像加载到 ImageViewTouch (ImageView) 而不会出现内存问题？

现在我只使用这个（AsyncTask）：

```
 ImageView currentView; //ImageView where to place image loaded from Internet
    String ImageUrl; //URL of image to load

    protected Bitmap doInBackground(ArrayList... params) {

            Bitmap bitmap;
            InputStream in = null;
            imageUrl = (String)params[0].get(1);

            try{
                HttpClient httpclient = new DefaultHttpClient();
                HttpResponse response = httpclient.execute(new HttpGet(imageUrl));
                in = response.getEntity().getContent();
            } catch(Exception e){
                e.printStackTrace();
            }
            try {
                bitmapa = BitmapFactory.decodeStream(in);
                in.close();
            } catch (IOException e1) {
                e1.printStackTrace();
            }

            return bitmap;
        }

        @Override
        protected void onPostExecute(Bitmap bitmap) {

            currentView.setImageBitmap(bitmap);
        } 
```

它会导致许多内存问题：

```
E/dalvikvm-heap(369): 69560740-byte external allocation too large for this process.
E/GraphicsJNI(369): VM won't let us allocate 69560740 bytes 
```

或者

```
E/AndroidRuntime(369): java.lang.RuntimeException: An error occured while executing doInBackground()
E/AndroidRuntime(369):  at android.os.AsyncTask$3.done(AsyncTask.java:200)
E/AndroidRuntime(369):  at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:274)
E/AndroidRuntime(369):  at java.util.concurrent.FutureTask.setException(FutureTask.java:125)
E/AndroidRuntime(369):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:308)
E/AndroidRuntime(369):  at java.util.concurrent.FutureTask.run(FutureTask.java:138)
E/AndroidRuntime(369):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
E/AndroidRuntime(369):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
E/AndroidRuntime(369):  at java.lang.Thread.run(Thread.java:1019)
E/AndroidRuntime(369): Caused by: java.lang.OutOfMemoryError: bitmap size exceeds VM budget
E/AndroidRuntime(369):  at android.graphics.BitmapFactory.nativeDecodeStream(Native Method)
E/AndroidRuntime(369):  at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:470)
E/AndroidRuntime(369):  at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:525)
E/AndroidRuntime(369):  at com.package.app.ImageDownloader.doInBackground(ImageDownloader.java:78)
E/AndroidRuntime(369):  at com.package.app.ImageDownloader.doInBackground(ImageDownloader.java:1)
E/AndroidRuntime(369):  at android.os.AsyncTask$2.call(AsyncTask.java:185)
E/AndroidRuntime(369):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
E/AndroidRuntime(369):  ... 4 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:18:25.440

您在哪个版本的操作系统上进行测试？在早期版本中，可用的堆空间远低于更高版本。

我会认真考虑缩小你的位图以避免这种情况。如果您正在为 mdpi 手机下载 2000x1000 `Bitmap`，那么这可能是个坏主意。

我还建议阅读[这篇文章](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)，以获取有关如何`ImageView`根据其尺寸准确地为特定加载适当图像的更多信息。

最后，您应该始终关闭`InputStream`一个`finally`块：

```
try {
        bitmap = BitmapFactory.decodeStream(in);
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        if (in != null) { in.close(); }
    } 
```

您还`android:largeHeap="true"`可以考虑使用专门为处理大型位图的应用程序（例如照片编辑应用程序）而设计的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T00:55:06.487

2000x1000 像素的图像很大，但不是那么大。

我明白了，虽然该进程试图在死前分配 69560740 个字节，但大约是 66MByte！

在最坏的情况下，您的 2000x1000 约为 2000x1000x4 = 8MBytes，远小于 66MBytes。其他事情正在发生。

此外，我发现在 AsyncTasks 中使用位图作为返回/结果值存在问题。已完成的 AsyncTask 仍会保留其结果，直到它们被垃圾收集。由于您不控制 AsyncTask 实例的垃圾收集，因此不要使用 Bitmap 作为返回/结果值。而是将 Bitmap 放在一个字段中，并在 doInBackground 即将结束时分配它，并使用此字段在 onPostExecute 中获取 Bitmap 并（！）将此字段设置为 null：

```
Bitmap bitmap;
protected Void doInBackground(ArrayList... params) {

        InputStream in = null;
        imageUrl = (String)params[0].get(1);

        try{
            HttpClient httpclient = new DefaultHttpClient();
            HttpResponse response = httpclient.execute(new HttpGet(imageUrl));
            in = response.getEntity().getContent();
        } catch(Exception e){
            e.printStackTrace();
        }
        try {
            bitmap = BitmapFactory.decodeStream(in);
            in.close();
        } catch (IOException e1) {
            e1.printStackTrace();
        }

        return null;
    }

    @Override
    protected void onPostExecute(Void unused) {
        if (bitmap != null) {
            currentView.setImageBitmap(bitmap);
        }

        // And don't forget to null the bitmap field!
        bitmap = null; 
    } 
```

# objective-c - 带有布尔参数的 Objective-C 方法中奇怪的“选择器修饰”

> ID：14674163
> 
> 赞同：3
> 
> 时间：2013-02-03T15:40:08.790
> 
> 标签：objective-c, macos, gcc, objective-c-runtime

我需要在运行时通过反射调用动态恢复方法名称。但对某些人来说会得到奇怪的结果。

我的 TestClass 包含一个方法，如：

```
- (void)testMethod6_NSRect:(NSRect)a1 int:(int)a2 int:(int)a3 bool:(Boolean)a4 {
    ...
} 
```

当使用 class_copyMethodList() 枚举上述类方法并通过 method_getName() 获取方法选择器时，我得到：

```
"testMethod6_NSRect:int:int:_Bool:" 
```

因此，选择器以某种方式（通过 gcc？）被重写以从“bool”生成“_Bool”。据我测试，这似乎只适用于“布尔”选择器部分 - 如果我将其更改为 int:(int)，如下所示：

```
- (void)testMethod1_int:(int)a1 int:(int)a2 int:(int)a3 int:(int)a4 {
    ...
} 
```

我得到了预期：

```
"testMethod1_int:int:int:int:" 
```

问：有没有人知道规则或指向我可以在哪里找到这些“选择器重写”的指针，或者我错过了什么？这仅适用于“布尔”吗？我还需要知道这种行为是否取决于 gcc-version、osx-version 或运行时库版本。

我正在使用 (gcc --version): i686-apple-darwin10-gcc-4.2.1 (GCC) 4.2.1 (Apple Inc. build 5666) (dot 3) on a (uname -a) 10.8.0 Darwin Kernel版本 10.8.0：

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T16:08:45.860

问题在于 C99 标准头文件中的一个丑陋的预处理器魔法`<stdbool.h>`：

```
#define bool _Bool 
```

C99 定义了一个名为的类型`_Bool`，其行为类似于 C++ 的`bool`类型。定义是为了能够在 C 中使用它，但使用 C++ 标识符。

解决方案：

```
#undef bool 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T15:52:18.057

尝试使用 BOOL 而不是 Boolean

# scheme - 方案 - 生成随机

> ID：14674165
> 
> 赞同：6
> 
> 时间：2013-02-03T15:40:21.660
> 
> 标签：scheme

如何在 Scheme 中生成随机数？是否有特殊表格或者我必须创建一个程序？如果是这样，我该怎么做？（我正在尝试创建一个名为 random-choice 的过程，它输入两种策略并随机返回一个。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-03T17:25:19.910

标准 Scheme 不提供随机数生成器，尽管大多数 Scheme 实现都提供了一个，但它们的细节往往不同。如果你想编写一个可移植的 Scheme 程序，构建自己的随机数生成器很容易；这是由于 Knuth 的一种方法：

```
(define random
  (let ((a 69069) (c 1) (m (expt 2 32)) (seed 19380110))
    (lambda new-seed
      (if (pair? new-seed)
          (set! seed (car new-seed))
          (set! seed (modulo (+ (* seed a) c) m)))
      (/ seed m)))) 
```

调用`(random)`返回 0（包括）和 1（不包括）之间的随机分数。随机分数以周期*m*循环。调用`(random seed)`重置随机数生成器的种子，这样从同一个种子开始的两个随机序列将是相同的；YYYYMMDD 形式的日期是很好的种子（上面是 Knuth 的生日）。如果你想掷硬币，说：`(if (< (random) 1/2) 'heads 'tails)`。

有时你想要一个范围内的随机整数。下面显示的函数返回*lo*（包括）到*hi*`randint` （不包括）范围内的随机整数；*lo*默认为 0：

 ***```
(define (randint . args)
  (cond ((= (length args) 1)
          (floor (* (random) (car args))))
        ((= (length args) 2)
          (+ (car args) (floor (* (random) (- (cadr args) (car args))))))
        (else (error 'randint "usage: (randint [lo] hi)")))) 
```

诸如此类的随机数对于简单的模拟来说已经足够了，但要注意它们不适合加密应用。如果您有兴趣，[我的博客上](http://programmingpraxis.com/contents/themes/#Random%20Number%20Generators)有几个随机数生成器，包括一些适用于加密应用程序的随机数生成器。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-03T15:48:11.770

令人惊讶的是，该过程被调用`random`- 尽管确切的语法可能因使用的 Scheme 解释器而异（阅读文档！），但总体思路如下：

```
(random)
=> 0.9113789707345018 
```

要返回两个可能值之一，这将在 Racket 中发挥作用：

```
(define (random-choice a b)
  (if (zero? (random 2)) a b)) 
```

请注意，`2`传递给的参数`random`强制它随机返回两个可能值之一：`0`或`1`。因此，如果`(random 2)`评估为`0`则`a`返回，否则`b`返回。

```
(random-choice 4 2)
=> 4
(random-choice 4 2)
=> 2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T18:40:57.010

由于您的另一个问题是关于在 DrRacket 中实现宇宙飞船游戏，我假设您所说的方案是指 DrRacket 中的一种教学语言。

在 DrRacket 中查找可用功能信息的方法很简单。比如说，`random`在交互窗口中写。将光标放在顶部，然后按 F1。

关于 htdp-languages的文档在`random`这里：

[http://docs.racket-lang.org/htdp-langs/beginner.html?q=random#(def.htdp-beginner. *(* (lib._lang/htdp-beginner..rkt)._random))](http://docs.racket-lang.org/htdp-langs/beginner.html?q=random#%28def._htdp-beginner._%28%28lib._lang/htdp-beginner..rkt%29._random%29%29)

返回随机值的一种方法：

```
(list-ref (list "one" "two") (random 2)) 
```

这里（随机 2）将返回 0 或 1。因此，list-ref 将返回索引为 0 或索引为 1 的条目。

使用上述方法的优点是很容易扩展到多于两个的值。***

# ruby-on-rails - 在 Mongoid 上运行额外查询的 Rails 'first' 方法

> ID：14674169
> 
> 赞同：0
> 
> 时间：2013-02-03T15:40:46.587
> 
> 标签：ruby-on-rails, ruby, mongodb, mongoid

我使用 Mongoid 作为我的 Rails 应用程序的数据库。注意到日志中有太多 QUERY 行，我决定看一看。

部分代码如下：

```
<%= if movie.directors.first
... Do something ...                  
end %> 
```

为此，日志显示了两个查询

```
 MOPED: 127.0.0.1:27017 QUERY        database=tgmd-wiki collection=directors selector={"$query"=>{"$and"=>[{"_id"=>{"$in"=>["510a097b53c205c294000163"]}}]}, "$orderby"=>{:_id=>1}} flags=[:slave_ok] limit=-1 skip=0 batch_size=nil fields=nil (0.7060ms)
  MOPED: 127.0.0.1:27017 QUERY        database=tgmd-wiki collection=directors selector={"$query"=>{"$and"=>[{"_id"=>{"$in"=>["510a097b53c205c294000163"]}}]}, "$orderby"=>{:_id=>1}} flags=[:slave_ok] limit=-1 skip=0 batch_size=nil fields=nil (0.4706ms) 
```

当我将其更改为：

```
<%= if movie.directors[0]
... Do something ...                  
end %> 
```

只有一个查询。

```
MOPED: 127.0.0.1:27017 QUERY        database=tgmd-wiki collection=directors selector={"$and"=>[{"_id"=>{"$in"=>["510a097b53c205c294000163"]}}]} flags=[:slave_ok] limit=0 skip=0 batch_size=nil fields=nil (0.7353ms) 
```

为什么**第**一种方法会进行重新查询？由于我的代码中有很多这样的查询，因此不可能将其忽略为仅 0.4 毫秒的差异。

有什么见解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T15:52:58.487

不知道为什么，但 .first 将与 mongoid 相关，而不是 Rails 本身。

附带说明一下，这样做可能会更快，或者至少更清洁

```
if movie.directors.any?
  ...
end 
```

当然，急切地加载你的导演，所以你甚至不会得到第一个查询。

# node.js - 在节点中使用 mongoosejs 更新多条记录

> ID：14674170
> 
> 赞同：9
> 
> 时间：2013-02-03T15:40:50.303
> 
> 标签：node.js, mongodb, mongoose

我在使用 mongoosejs 和节点更新多条记录时遇到问题。出于某种原因，我只更新一条记录，即使多个匹配。我还注意到回调不会在 .update() 之后触发。我没有收到任何错误消息。这里发生了什么？

```
Page.find({status:'queued'})
    .limit(queue_limit-queue.length)
    .update({ status: 'active' },{ multi: true },function(err,num){
        console.log("updated "+num);
        //this callback will never fire, but a single record will be updated and marked as active.                                                                                                 
    }); 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-03T16:36:59.857

[`Query#update`](http://mongoosejs.com/docs/api.html#query_Query-update)不接受`options`参数，但接受[`Model.update`](http://mongoosejs.com/docs/api.html#model_Model.update)。所以你想把它重写为：

```
Page.update({status:'queued'}, {status: 'active'}, {multi: true}, 
    function(err, num) {
        console.log("updated "+num);
    }
); 
```

我不确定你试图对`limit`链中的调用做什么，但你不能在更新中使用它。

**更新**

上面的查询将更新所有文档 where `{status: 'queued'}`。您唯一的选择`update`只是第一个匹配的一个`{multi: false}`或所有匹配项`{multi: true}`。

听起来您需要重新做一些事情以一次将文档从队列中取出并切换到，[`findOneAndUpdate`](http://mongoosejs.com/docs/api.html#model_Model.findOneAndUpdate)而不是`update`这样您就可以访问已从 更新到 的`'queued'`文档`'active'`。

# sql - 用于过滤唯一状态记录的 SQL 查询

> ID：14674171
> 
> 赞同：0
> 
> 时间：2013-02-03T15:40:52.040
> 
> 标签：sql, sql-server, oracle

我需要一个 SQL Server 和 Oracle 兼容的查询来获得以下结果

桌子：

```
PRIMARY IDN   SECONDARY_IDN    STATUS 
1             47               Pending
2             47               Completed
3             47               Error
4             57               Pending
5             59               Completed
6             60               Pending
7             60               Completed 
```

我的输入是`Pending`,`Completed`或`Error`.

我需要列出所有只有 1 个状态的辅助 IDN，这就是输入状态。

例如我的输入是`Pending`：它应该只显示 57。其他人可能有`Pending`，但它也有完成和错误记录。

你能帮我么 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T15:43:03.400

```
SELECT  SECONDARY_IDN
FROM    tableName
GROUP   BY SECONDARY_IDN
HAVING  SUM(CASE WHEN Status = 'Pending' THEN 1 ELSE 0 END) = COUNT(*) 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!3/537da/2)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T15:43:26.700

您需要只有一种状态的组。为此，您要使用聚合：

```
select secondary_idn
from t
group by secondary_idn
having max(status) = min(status)  and -- all the statuses are the same
       max(status) = 'Pending'        -- and the status is Pending 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T15:52:48.087

```
SELECT  *
FROM  tableName tn
WHERE tn.Status = 'Pending'
AND NOT EXISTS ( SELECT *
  FROM tableName nx
  WHERE nx.SECONDARY_IDN = tn.SECONDARY_IDN
  AND nx.Status <> 'Pending'
  ); 
```

* * *

*   外部查询没有`group by`，所以所有列都可以使用（可怕`select *`的是为了说明这个事实）
*   `exists`只需要检测*一个*不需要的记录来产生，`true`具有聚合（最小，最大，计数）的解决方案可能必须扫描（和聚合）*整个组*以确定记录的可取性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T15:43:39.490

```
 select status
 , secondary_idn
 , count(*) records
 from theTable
 where whatever
 group by status, secondary_idn
 having count(*) = 1 
```

# php - 为什么即使对于相同的字符串，字符串比较也总是返回 false？

> ID：14674175
> 
> 赞同：0
> 
> 时间：2013-02-03T15:41:08.300
> 
> 标签：php

我知道这可能是那些“树木换树”的问题之一，但我整天都坐在这里，我只是看不出我哪里出错了。

场景：

基本上我有一个查询返回以下地址结果的关联数组，如下所示：

```
Array ( [0] => Array ( [Address_ID] => 12 [Address_String] => 23 Abledone road Hobs moat Solihull West Midlands B92 4JJ ) [1] => Array ( [Address_ID] => 13 [Address_String] => 22 Holdean Road Deepcut Surrey KT164NJ ) [2] => Array ( [Address_ID] => 14 [Address_String] => 32 Palbrough Road Nottingham N32 4NJ ) [3] => Array ( [Address_ID] => 15 [Address_String] => Flat 2B Gateway House Rutland Street Bearwood Westmidlands B66 9RT ) [4] => Array ( [Address_ID] => 16 [Address_String] => 258 Lincoln Street Bullworth Street Dundee DD35 9RJ ) [5] => Array ( [Address_ID] => 17 [Address_String] => 4 Scott Arms Avenue Beckton Hartfordshire H32 7JJ ) [6] => Array ( [Address_ID] => 18 [Address_String] => 14 Fairfield house Millbank road Bearwood Birmingham Westmidlands B137JJ ) [7] => Array ( [Address_ID] => 19 [Address_String] => 9 Scott road Olton Solihull Westmidlands B91 7TY ) [8] => Array ( [Address_ID] => 20 [Address_String] => Normandy House Bunnian Place Basingstoke RG21 7EJ ) [9] => Array ( [Address_ID] => 27 [Address_String] => 3 New Square Bedfont Lakes Feltham Middlesex TW14 8HB ) [10] => Array ( [Address_ID] => 28 [Address_String] => No. 1 The Square Temple Quay Bristol BS1 6DG ) [11] => Array ( [Address_ID] => 29 [Address_String] => The Visual Space Capital Park Fulbourn Cambridge CB21 5XH ) [12] => Array ( [Address_ID] => 40 [Address_String] => 21 St. Andrew Square Edinburgh Scotland CB21 5XH ) ) 
```

我要做的就是将这些结果与搜索字符串进行匹配，以查看该地址是否已经在我的数据库中。

我的代码如下：

```
 public function addressExistsByString ($searchAddrString, $asJSON = FALSE) {
    if (!isset($searchAddrString)) {
        throw new Exception('The searchAddrString variable of function ' . __FUNCTION__ . ' of class ' . __CLASS__ . 'was empty or set to NULL.');
    } elseif (!is_string($searchAddrString)) {
        throw new Exception('The type of value for the argument addressID of function ' . __FUNCTION__ . ' of class ' . __CLASS__ . ' was ' . gettype($searchAddrString) . ' a string was expected');
    }if (!is_bool($asJSON)) {
        $asJSON = FALSE;
    }

   print_r ($addressArray = $this->getAllLocations(FALSE));

    if ($addressArray === -1) {
        return -2;
    } else {

        $search = str_replace(',','',  strtolower(trim($searchAddrString)));

        foreach ($addressArray as $record) {

           $recID = $record ['Address_ID']; 
           $currentAddress =str_replace(',','',  strtolower(trim($record['Address_String'])));

           echo 'Search address: '. $search. ' Current address: '.  $currentAddress .' type of current address: '.gettype($searchAddrString).'<br/>';  

           if ($currentAddress === $search) {

               if ($asJSON) {
                   echo json_encode($recID);
               }
               return intval($recID);
           }
        }
        if ($asJSON) {
            echo json_encode(-1);
        }
        return -1;
    }
} 
```

当我运行此代码时，我得到以下输出（抱歉，它有点长，但重要的部分已突出显示）：

> bunnian place bassingstoke rg21 7ej 当前地址：23abledone road hobs moat solihull west midlands b92 4jj 当前地址类型：字符串 搜索地址：normandy house bunnian place bassingstoke rg21 7ej 当前地址：22 holdean road deepcut surrey kt164nj 当前地址类型：字符串 搜索地址：normandy house bunnian place bassingstoke rg21 7ej 当前地址：32 palbrough road nottingham n32 4nj 当前地址类型：字符串 搜索地址：normandy house bunnian place bassingstoke rg21 7ej 当前地址：flat 2b gateway house rutland street Bearwood westmidlands b66 9rt 当前类型地址：字符串 搜索地址：normandy house bunnian place bassingstoke rg21 7ej 当前地址：258 lincoln street Bullworth street dudee dd35 9rj 当前地址类型：字符串 搜索地址：normandy house bunnian place bassingstoke rg21 7ej 当前地址：4 scott arm avenue beckton hartfordshire h32 7jj 当前地址类型：字符串 搜索地址：normandy house bunnian place bassingstoke rg21 7ej 当前地址：14 fairfield house millbank road Bearwood birmingham westmidlands b137jj 当前地址类型: string 搜索地址：normandy house bunnian place bassingstoke rg21 7ej 当前地址：9 scott road olton solihull westmidlands b91 7ty 当前地址类型：string 搜索地址：normandy house bunnian place bassingstoke rg21 7ej 当前地址：9 scott road olton solihull westmidlands b91 7ty 当前地址类型：字符串 搜索地址：normandy house bunnian place bassingstoke rg21 7ej 当前地址：9 scott road olton solihull westmidlands b91 7ty 当前地址类型：字符串 搜索地址：**诺曼底之家 bunnian place bassingstoke rg21 7ej**当前地址：**normandy house bunnian place bassingstoke rg21 7ej**当前地址类型：字符串 搜索地址：normandy house bunnian place bassingstoke rg21 7ej 当前地址：3 new square bedfont lakes feelham middlesex tw14 8hb 当前地址类型：字符串 搜索地址：normandy house bunnian place bassingstoke rg21 7ej 当前地址：no. 1 the square Temple quay 布里斯托 bs1 6dg 当前地址类型：string 搜索地址：normandy house bunnian place bassingstoke rg21 7ej 当前地址：visual space capital park fulbourn cambridge cb21 5xh 当前地址类型：string 搜索地址：normandy house bunnian place bassingstoke rg21 7ej 当前地址：21 st。安德鲁广场爱丁堡苏格兰cb21 5xh当前地址类型：字符串-1

突出显示的字符串完全相同，我通过将它们都拿来测试它们并将它们作为纯字符串粘贴在单独的 if 语句中，并且总是返回 true 。我已经尝试过 ==、=== 转换、字符串值以及我能想到的所有其他内容，但由于某种原因，总是返回 -1。我知道这可能是我想念的非常简单的东西，但我就是看不到，有人可以帮忙吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T15:58:28.603

[var_dump()](http://php.net/var-dump)你的两个变量就在你比较它们之前。在此之前回显一个`<pre>`标记以查看浏览器中的所有空白，而无需切换到 HTML 源代码。

您很可能会错过那里的一些空白字符。

# java - 如何使用 Hibernate 级联删除

> ID：14674179
> 
> 赞同：0
> 
> 时间：2013-02-03T15:41:45.583
> 
> 标签：java, hibernate, postgresql

我正在尝试使用 hibernate 级联删除，但不知道如何删除 3 个表的数据，第一个表与第二个表相关，第二个与第三个表相关，但关系是这样的，所以我有一所学校有 n老师，老师有n个材料，知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:25:11.217

要在关联中级联删除，`@OnToMany`您可以

*   使用`cascade = CascadeType.REMOVE`它将删除所有引用实体
*   或者您可以添加注释，该注释将在模式创建期间向外键定义`@OnDelete(action=OnDeleteAction.CASCADE)`添加子句`ON DELETE CASCADE`

也许您还想检查[这个](https://stackoverflow.com/questions/8435251/hibernate-does-not-add-on-delete-cascade/8435890#8435890)或[这个](https://stackoverflow.com/questions/10426979/removing-childs-from-onetomany-association-cascadetype-all-orphanremoval-t)相关的问题。

# iphone - iOS 键盘或按钮按钮按下和释放时间

> ID：14674187
> 
> 赞同：0
> 
> 时间：2013-02-03T15:42:11.793
> 
> 标签：iphone

> **可能重复：**
> [检测虚拟键盘上的按键](https://stackoverflow.com/questions/6882808/detect-key-press-on-virtual-keyboard)

我想知道是否可以在 iOS 应用程序开发中捕获准确的键盘按键时间和释放时间？

例如，假设我输入“ `Hello`”。我想知道`H`-Key 按下时间和释放时间，然后`E`等`L`。我认为答案会以微秒为单位，但这就是我想要的。

任何帮助都会非常有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:06:37.853

您可以使用`-(BOOL) textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string`（来自 UITextFieldDelegate）截取 UITextField 中输入的字符并在那里记录时间戳。

这至少为您提供了发布时间。按下时间可能要困难得多，特别是当您考虑必须按下更长的键才能获得字符的重音版本时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T16:55:46.877

您**将**需要制作自己的键盘，`Touch Down`并`Touch Up Inside`在您希望获得此信息的按钮上添加事件。

一旦您拥有自己的键盘，只需存储`NSDate`按下按钮的时间，然后在释放按钮时从 NSDate 中减去它以获得经过的时间。时间更有可能以毫秒（而不是微秒）为单位，因为运行循环甚至没有那么快。

我在 Github 上有一个开源项目（MIT 许可证），它创建了一个自定义数字键盘（您必须将自己的事件添加到按钮），这应该使实现键盘变得非常容易，这里： [https://github。 com/lnafziger/数字键盘](https://github.com/lnafziger/Numberpad)

如果您也想在此键盘上使用字母（不需要更改代码），您可以添加更多/不同的按钮。

# linux - 通过 bash 从 PHP 文件中注释掉一个值？

> ID：14674191
> 
> 赞同：0
> 
> 时间：2013-02-03T15:42:32.010
> 
> 标签：linux, bash, scripting, sed

所以，我正在处理一个 bash 脚本，并且在一个函数中我需要它来注释掉 PHP 文件中的两个值。

```
define('WP_CACHE', true); //Added by WP-Cache Manager
define( 'WPCACHEHOME', '/home/fescobar/public_html/testground/wp-content/plugins/wp-super-cache/' ); //Added by WP-Cache Manager 
```

我设法使用以下方法摆脱了第一行。

```
first="define('WP_CACHE', true);"; sed "s/$one/testingwp/g" wp-config.php 
```

但是，该方法第二次失败。我的主要目标只是在这些值前面用 //* 注释掉这两行。但是，我总是得到一个 sed 语法错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T15:51:49.543

看起来你只是想要：

`sed '/WP_CACHE/s|^|//|'`和`sed '/WPCACHE/s|^|//|'`

这将`//`添加到包含字符串`WP_CACHE`或`WPCACHE`. 如果您尝试将替换重新串到也匹配的行`^define`，请尝试：

`sed '/^define(.WP_CACHE/s|^|//|'` （您实际上可以匹配引号字符，但使用`.`更容易键入。您需要更多地细化问题以描述您要做什么。

# java - 将二进制转换为ascii，ascii中的旋转字符串 - java

> ID：14674192
> 
> 赞同：0
> 
> 时间：2013-02-03T15:42:34.213
> 
> 标签：java, string, binary, rotation, ascii

我真的是java新手，现在我真的迷路了。我必须首先将二进制文件转换为它的 ascii。然后，创建 ascii 的旋转字符串（例如：“2L4R6L”）以获取特定字母。

我仍然在第一部分，但现在我真的迷路了。我尝试了转换，但是当我打印它时， null 是输出。你能帮我指出我的错误，并帮助我解决这个程序吗？

这是我创建的方法：

```
public void setEncryptedMessage(String encryptedMess){
    encryptedMessage = encryptedMess;
    Cipher cph = new Cipher();
    cph.convertBinary(encryptedMessage);
}

public void convertBinary(String encryptedMessage){
    StringTokenizer st = new StringTokenizer(encryptedMessage, '#');
    int convert = Integer.parseInt(st.nextToken(), 2);
    String letter = new Character((char)convert).toString();
    encryptedMessage = letter;
}   

public String getEncryptedMessage(){    
  return encryptedMessage;
} 
```

这是主要的：

```
public static void main(String[] args){ 
  Cipher cph=new Cipher();
  String encryptedMessage="1000001#1001001#1011010#1010000#1000110";    
  cph.setEncryptedMessage(encryptedMessage);    
  System.out.println(cph.getEncryptedMessage());
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T15:54:58.400

摆脱`Cipher`您正在创建的额外对象`setEncryptedMessage`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-01T13:47:25.077

所以你在将二进制字符串转换为 ascii 格式时遇到了麻烦，对吧？
**这里！**我找到了解决办法！

```
public static void main(String[] args) {
    String encryptedMessage="1000001#1001001#1011010#1010000#1000110"; //BTW one ascii charecter is represented by 8 digits in binary. And here there are 7 digits per charecter...fix that and well moving on...
    String filtered= encryptedMessage.replaceAll("#", "");
    StringBuilder b = new StringBuilder();
    int i = 0;
    String rslt= "";
    while (i + 8 <= filtered.length()) {
    char c = convert(filtered.substring(i, i+8));
    i+=8;
    b.append(c);
    rslt= b.toString();
    }
    System.out.println(rslt);
}
private static char convert(String bs) {
    return (char)Integer.parseInt(bs, 2);
} 
```

# android - 在滚动视图中动态设置子高度

> ID：14674193
> 
> 赞同：1
> 
> 时间：2013-02-03T15:42:40.337
> 
> 标签：android, layout, scroll, scrollview

我在滚动视图中有一个子布局，其中包含许多根据布局大小移动的对象（具有 centerVertical=true 之类的属性）**。**问题是滚动视图在布局变得尽可能小之前**不会开始滚动，这使得这些对象中的许多相互重叠。**我试图通过将子高度设置为自定义值来纠正这个问题，但是整个布局变得混乱。我有fillviewport = true，我只是想找到一种方法来控制滚动视图内孩子的高度，因为它决定自己让它太小。谢谢！

# java - 在不同的侦听器中多次使用一个片段 [Android]

> ID：14674195
> 
> 赞同：1
> 
> 时间：2013-02-03T15:42:50.380
> 
> 标签：java, android, android-activity, listener, fragment

我有一个带有 4 个主要选项卡的 android 应用程序。每个选项卡包含不同的片段。我也有 ListFragment，我想在每个片段中显示它，但与其他 OnItemClickListener 一起显示（因为它具有相同的布局和数据，但单击时的行为不同）。

是正确的方法吗？

```
public class MyListFragment extends ListFragment {
    ...
    public void setOnItemClickListener(OnItemClickListener listener) {
        getList().setOnItemClickListener(listener);
    }
} 
```

在父片段中这样做：

```
public class FirstParentFragment extends Fragment {
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.fragment_beach_list, container, false);

        FragmentManager fm = getActivity().getSupportFragmentManager();
        MyListFragment fragment = (MyListFragment )fm.findFragmentById(R.id.fragment_list_first);
        OnItemClickListener listener = new OnItemClickListener(...bla bla...);
        fragment.setOnItemClickListener(listener);

        return view;
    }
} 
```

感谢您的回答:)

# php - 如何池化套接字连接？

> ID：14674197
> 
> 赞同：0
> 
> 时间：2013-02-03T15:43:03.363
> 
> 标签：php, web-services, sockets, appserver

我有一个 Win32 应用程序服务器，它通过自己的 TCP 协议与其客户端进行通信。我需要从 PHP 调用这个应用服务器的一些功能。

我打开一个套接字，与服务器建立通信，向套接字写入请求，接收答案，然后关闭套接字。为了获得更好的性能，我想与应用服务器建立一个连接池。

如何在 PHP 中建立连接池（套接字池）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:00:17.513

你可以用php打开一个socket来和你的服务器通信！

```
<?php
  $fp = fsockopen("udp://127.0.0.1", 13, $errno, $errstr);
  if (!$fp) {
      echo "ERROR: $errno - $errstr<br />\n";
  } else {
      // Write to a socket
      fwrite($fp, "Hello my server");

      // Read from socket
      echo fread($fp, 26);

      // Close the socket
      fclose($fp);
  }
?> 
```

# c - 是否可以使用 switch 从 float 函数更改 char 类型函数的值？

> ID：14674198
> 
> 赞同：0
> 
> 时间：2013-02-03T15:43:07.510
> 
> 标签：c

我想使用 get 选择函数让用户从菜单中选择一个字母，并且我想使用这个值在浮点函数中切换它......我知道它只能使用 switch 作为 int 类型，但是我将获得的价值将是浮动的？

> 浮点计算（浮点数 1，浮点数 2）
> 
> { int 答案 = get_choice();
> 
> ```
> switch (answer)
>     {
>         case 'a':
>             answer = number1 + number2;
>             break;
>         case 's':
>             answer = number1 - number2;
>             break;
>         case 'm':
>             answer = number1 * number2;
>             break;
>         case 'd':
>             answer = number1 / number2;
>             break;
>     }
> return answer; } 
> ```
> 
> char get_choice(void)
> 
> { int 选择;
> 
> ```
> printf("Enter the operation of your choice:\n");
> printf("a. add        s. subtract\n");
> printf("m. multiply   d. divide\n");
> printf("q. quit\n");
> 
> while ((choice = getchar()) == 1 && choice != 'q')
> {
> 
>     if (choice != 'a' || choice != 's' || choice != 'm' || choice != 'd')
>     {
>         printf("Enter the operation of your choice:\n");
>         printf("a. add        s. subtract\n");
>         printf("m. multiply   d. divide\n");
>         printf("q. quit\n");
>         continue;
>     }
> 
> }
> return choice; } 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T15:45:16.123

```
float calc(float number1, float number2)

{ int choice = get_choice();
  float answer = 0.0;

  switch (choice) 
```

无需重用该变量。您也可以`char`直接切换变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T15:45:48.990

任何非零值都是真的，所以你应该编码

```
while ((choice = getchar()) != EOF && choice != 'q') 
```

# android - 如何通过URI打开本机联系人卡片

> ID：14674199
> 
> 赞同：4
> 
> 时间：2013-02-03T15:43:15.443
> 
> 标签：android, android-intent, contactscontract

有人可以解释一下如何为特定联系人 URi 打开联系人本机

我设法通过以下方式解析联系人URI：

```
Uri lookupUri = Uri.withAppendedPath(ContactsContract.PhoneLookup.CONTENT_FILTER_URI,
                Uri.encode(displayName)); 
```

然后我尝试这样做：

```
 Intent intent = new Intent(Intent.ACTION_VIEW);
     intent.setType(ContactsContract.Contacts.CONTENT_TYPE);
     intent.putExtra(ContactsContract.Intents.SHOW_OR_CREATE_CONTACT, "555");
     context.startActivity(intent); 
```

但它只是打开本机通讯簿而没有任何解析

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T15:59:12.227

```
Intent intent = new Intent(Intent.ACTION_VIEW);
Uri uri = Uri.withAppendedPath(ContactsContract.Contacts.CONTENT_URI, String.valueOf(contactID));
intent.setData(uri);
context.startActivity(intent); 
```

您可以通过使用以下方式浏览来检索contactId `contentResolver`：

```
id = cur.getString(cur.getColumnIndex(ContactsContract.Contacts._ID));
name = cur.getString( cur.getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME));
Log.d(tag, "Id: "+ id+"\t Name: "+name); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-15T13:28:58.337

在您获得`cursor`联系人和特定联系人的索引后，获取`Uri`并启动活动，其意图`ACTION_VIEW`如下：

```
cursor.moveToPosition(position); // or cursor.moveToFirst() if single contact was selected.
long id = cursor.getLong(cursor.getColumnIndex(ContactsContract.Contacts._ID));
String lookupKey = cursor.getString(cursor.getColumnIndex(ContactsContract.Contacts.LOOKUP_KEY));
Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setData(ContactsContract.Contacts.getLookupUri(id, lookupKey));
try {
    context.startActivity(intent);
} catch (Exception e) {
    e.printStackTrace();
} 
```

# android - 减少加载图像时间和 RAM

> ID：14674203
> 
> 赞同：1
> 
> 时间：2013-02-03T15:43:42.970
> 
> 标签：android, bitmapfactory

我正在使用以下代码从图库中加载一些位图：

```
 bitmap = (BitmapFactory.decodeFile(picturePath)).copy(Bitmap.Config.ARGB_8888, true);
 bitmap = Bitmap.createScaledBitmap(bitmap, screenWidth, screenHeight, true);
 bitmapCanvas = new Canvas(bitmap);
 invalidate(); // refresh the screen 
```

**问题：**

首先完全解码并复制，然后进行缩放以适应屏幕宽度和高度，加载图像似乎需要很长时间。它实际上不需要以全密度加载图片，因为无论如何我都不会让用户放大导入的图像。

这样，有什么方法可以减少加载时间和RAM？（直接加载缩小的图像）如何进一步修改上述编码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T15:57:23.797

如果您没有透明度，可能值得尝试 RGB_565 而不是 ARGB_8888。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T04:33:22.727

刚刚找到了减少 RAM 和加载时间的答案，并避免`outofmemory`了其他类似问题的错误。

```
//get importing bitmap dimension
   Options op = new Options();
   op.inJustDecodeBounds = true;
   Bitmap pic_to_be_imported = BitmapFactory.decodeFile(picturePath, op);
   final int x_pic = op.outWidth;
   final int y_pic = op.outHeight;

//The new size we want to scale to
    final int IMAGE_MAX_SIZE= (int) Math.max(DrawViewWidth, DrawViewHeight);

    int scale = 1;
    if (op.outHeight > IMAGE_MAX_SIZE || op.outWidth > IMAGE_MAX_SIZE) 
    {
        scale = (int)Math.pow(2, (int) Math.round(Math.log(IMAGE_MAX_SIZE / 
               (double) Math.max(op.outHeight, op.outWidth)) / Math.log(0.5)));
    }

    final BitmapFactory.Options o2 = new BitmapFactory.Options();
    o2.inSampleSize = scale;        

//Import the file using the o2 options: inSampleSized
    bitmap = (BitmapFactory.decodeFile(picturePath, o2));
    bitmap = bitmap.copy(Bitmap.Config.ARGB_8888, true); 
```

# php - 如何选择数据库的所有值并按百分比选择其中一个

> ID：14674212
> 
> 赞同：0
> 
> 时间：2013-02-03T15:44:56.793
> 
> 标签：php, mysql, database

我想要做的是选择数据库的一个值，

让我们说：

```
id ---- giftid ---- userid
1         1           481
2         1           422
3         7           123
4         9           542
5         1           122
6         1           455 
```

例如，有 4 个用户希望拥有相同的 giftid：1、2、5、6

这意味着每个人将有 25% 可供选择。

如何进行“百分比选择”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T15:47:07.087

假设 each`userid`只能声明`giftid`一次，则可以`ORDER BY RAND()`在 MySQL 中使用。`table`这将首先从gifidid所在的表中选择所有行`1`，然后随机排序结果。`LIMIT 1`确保只返回第一条记录

```
SELECT * FROM table
WHERE giftid = `1`
ORDER BY RAND()
LIMIT 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T15:53:31.943

你在看这个吗？

```
SELECT giftid, 1.0 / COUNT(*) percentSelection
FROM tableName
GROUP BY giftid 
```

# php - 注册 php 文件

> ID：14674213
> 
> 赞同：1
> 
> 时间：2013-02-03T15:44:59.617
> 
> 标签：php, mysql, login

我创建了一个注册页面，它正在工作，但我有一个问题。

该页面包含用户名、密码、电子邮件、地址和电话。根据我所达到的，用户可以添加所有这些要求并且只能添加“用户名”才能成功注册我需要一种方法让用户添加所有这些要求（用户名、密码、电子邮件、地址和电话）不仅添加 1 个要求。

```
 <?php
 $con = mysql_connect("localhost","root","");
 if (!$con)
 {
 die('Could not connect: ' . mysql_error());
 }

 mysql_select_db("theater", $con);

 $sql="INSERT INTO member (username, password, email, telephone, address)
 VALUES
    ('$_POST[username]','$_POST[password]','$_POST[email]','$_POST[telephone]','$_POST[address]')";

 if (!mysql_query($sql,$con))
 {
 die('Error: ' . mysql_error());
 }
 echo "records added";

 mysql_close($con);
 ?> 
```

该`signup.php`页面是一个普通表格，其中包含输入用户名、电子邮件、密码、地址和带有注册按钮的电话。我认为我们不应该在这里使用它，不是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T15:52:15.957

您可以检查是否设置了特定项目，如果是，请继续。

```
$errors = array(); //Initialize an empty errors array.

if(!isset($_POST["username"]){
  $errors[] = "Username not set; please try again.";
}

if(!isset($_POST["email"]){
  $errors[] = "Email address not set; please try again.";
}

//If there are no errors in the $errors array (aka: every field is set):
if(empty($errors)) {
  //Query the database and whatnot.
} else {
  //Echo out the errors and demand proper values.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T15:52:24.027

您应该尝试这种方式来检查是否所有表单域都已填写。

```
<?php
 $con = mysql_connect("localhost","root","");
 if (!$con)
 {
 die('Could not connect: ' . mysql_error());
 }

 mysql_select_db("theater", $con);

if($_POST['username'] == '' || $_POST['password'] == '' || $_POST['email'] == '' || $_POST['telephone'] == '' || $_POST['address'] == '') $filled = false;
if($filled) {
 $sql="INSERT INTO member (username, password, email, telephone, address)
 VALUES
    ('$_POST[username]','$_POST[password]','$_POST[email]','$_POST[telephone]','$_POST[address]')"; } else echo 'Please fill all the fields!';

 if (!mysql_query($sql,$con))
 {
 die('Error: ' . mysql_error());
 }
 echo "records added";

 mysql_close($con);
 ?> 
```

# mysql - 在 php 中使用内部连接和 mysql lat long 查询

> ID：14674224
> 
> 赞同：1
> 
> 时间：2013-02-03T15:45:56.717
> 
> 标签：mysql, left-join, inner-join, latitude-longitude

我有这个 mysql 查询使用 Lat 和 Long 作为中心位置进行搜索半径：

```
$query = sprintf("SELECT Title, DateTime, ( 6371393 * acos( cos( radians('%s') ) * cos( radians( Lat ) ) * cos( radians( Lon ) - radians('%s') ) + sin( radians('%s') ) * sin( radians( Lat ) ) ) ) AS distance FROM Locations HAVING distance < '%s' ORDER BY distance",
    mysql_real_escape_string($center_lat),
    mysql_real_escape_string($center_lng),
    mysql_real_escape_string($center_lat),
    mysql_real_escape_string($radius)); 
```

我以米为单位输入纬度、经度和半径。然后输出是标题和日期时间，但我还需要使用 id 从另一个表中获取用户名。

这些表是：

**地点**

```
| Title | DateTime | UserID | 
```

**用户**

```
| UserID | Username | 
```

无论如何如何将此查询与内部联接或左联接一起使用？我也愿意接受其他方法来实现最佳优化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T15:52:50.913

```
select title, datetime, username
from location, users
where location.userid = users.userid 
```

或者

```
select title, datetime, username
from location
join users
on location.userid = users.userid 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T16:04:18.943

您可以使用内部联接：

```
select l.title, l.datetime, u.username
from location l inner join users u on l.userid = u.userid 
```

# hibernate - 异常 javax.persistence.Persistence.getPersistenceUtil()Ljavax/persistence/PersistenceUtil

> ID：14674236
> 
> 赞同：1
> 
> 时间：2013-02-03T15:47:19.993
> 
> 标签：hibernate, jpa-2.0

我有一个使用 Spring MVC、IOC、Hibernate Validator、Hibernate（基于注释）和 jdk1.6 的应用程序。

我有以下条目的 pom.xml

```
 <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>3.5.1-Final</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-annotations</artifactId>
        <version>3.5.1-Final</version>
        <type>jar</type>
        <scope>compile</scope>
    </dependency>

    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-validator</artifactId>
        <version>4.0.2.GA</version>
    </dependency>

    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-envers</artifactId>
        <version>3.5.6-Final</version>
    </dependency>
    <dependency>
        <groupId>javax.persistence</groupId>
        <artifactId>persistence-api</artifactId>
        <version>1.0</version>
        <type>jar</type>
        <scope>compile</scope>
    </dependency> 
```

我正在做类似这样的休眠验证

```
import javax.validation.constraints.Size;
import org.hibernate.validator.constraints.NotEmpty;

public class DepartmentForm {

    private Integer id;

    @NotEmpty(message = "Please enter department name")
    @Size(max = 60)
    private String department;

    @Size(max = 60)
    private String description;
} 
```

但应用程序给出如下错误

```
exception 

org.springframework.web.util.NestedServletException: Handler processing failed; nested exception is java.lang.NoSuchMethodError: javax.persistence.Persistence.getPersistenceUtil()Ljavax/persistence/PersistenceUtil;
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:839)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
    org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:560)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722)

root cause 

java.lang.NoSuchMethodError: javax.persistence.Persistence.getPersistenceUtil()Ljavax/persistence/PersistenceUtil;
    org.hibernate.validator.engine.resolver.JPATraversableResolver.isReachable(JPATraversableResolver.java:33)
    org.hibernate.validator.engine.resolver.DefaultTraversableResolver.isReachable(DefaultTraversableResolver.java:112)
    org.hibernate.validator.engine.resolver.SingleThreadCachedTraversableResolver.isReachable(SingleThreadCachedTraversableResolver.java:47)
    org.hibernate.validator.engine.ValidatorImpl.isValidationRequired(ValidatorImpl.java:764)
    org.hibernate.validator.engine.ValidatorImpl.validateConstraint(ValidatorImpl.java:331)
    org.hibernate.validator.engine.ValidatorImpl.validateConstraintsForRedefinedDefaultGroup(ValidatorImpl.java:278)
    org.hibernate.validator.engine.ValidatorImpl.validateConstraintsForCurrentGroup(ValidatorImpl.java:260)
    org.hibernate.validator.engine.ValidatorImpl.validateInContext(ValidatorImpl.java:213)
    org.hibernate.validator.engine.ValidatorImpl.validate(ValidatorImpl.java:119)
    org.springframework.validation.beanvalidation.SpringValidatorAdapter.validate(SpringValidatorAdapter.java:86)
    org.springframework.validation.DataBinder.validate(DataBinder.java:692)
    org.springframework.web.bind.annotation.support.HandlerMethodInvoker.doBind(HandlerMethodInvoker.java:807)
    org.springframework.web.bind.annotation.support.HandlerMethodInvoker.resolveHandlerArguments(HandlerMethodInvoker.java:359)
    org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:171)
    org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:426)
    org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:414)
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:790)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
    org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:560)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:17:28.167

如文件所述，[PersistenceUtil](http://docs.oracle.com/javaee/6/api/javax/persistence/PersistenceUtil.html)是在 JPA **2.0**中引入的。当前的 JPA API 依赖于 1.0 版。通过以下方式获取 JPA API (2.0) 解决了问题：

```
<dependency>
    <groupId>org.hibernate.javax.persistence</groupId>
    <artifactId>hibernate-jpa-2.0-api</artifactId>
    <version>1.0.1.Final</version>
</dependency> 
```

# mysql - 从原始 MySQL 查询到 symfony 2

> ID：14674237
> 
> 赞同：0
> 
> 时间：2013-02-03T15:47:21.957
> 
> 标签：mysql, symfony

我正在尝试使用此查询获取 symfony2 实体：

```
SELECT g . *, 
       (SELECT Count(gc.`code`) AS `codecount` 
        FROM   giftcode gc 
        WHERE  gc.`gift_id` = g.`id` 
               AND gc.`provided` IS NULL 
        GROUP  BY gc.`gift_id`) AS gcodecount 
FROM   gift g 
WHERE  Now() >= g.validbegin 
       AND Now() <= g.validend 
```

到目前为止，我有这个：

```
$query = $giftRepository->createQueryBuilder('p')
    ->where(':now >= p.validbegin AND :now <= p.validend')
    ->setParameter('now', new \DateTime())
    ->orderBy('p.points', $hts)
    ->getQuery();
    $gifts = $query->getResult(); 
```

它工作但不完整，我不知道如何在查询中调用第二个表（giftcode），就像我在原始查询中所做的那样。

**编辑**：

```
namespace Done\PunctisBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * Gift
 *
 * @ORM\Table(name="gift")
 * @ORM\Entity
 */
class Gift
{
    /**
     * @var integer
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @var string
     *
     * @ORM\Column(name="name", type="string", length=255)
     */
    private $name;

    /**
     * @var string
     *
     * @ORM\Column(name="description", type="text", nullable=true)
     */
    private $description;

    /**
     * @var string
     *
     * @ORM\Column(name="redemption", type="string", nullable=true)
     */
    private $redemption;

    /**
     * @var \Date $validbegin
     *
     * @ORM\Column(name="validbegin", type="date", nullable=true)
     */
    private $validbegin;

    /**
     * @var \Date $validend
     *
     * @ORM\Column(name="validend", type="date", nullable=true)
     */
    private $validend;

    /**
     * @var integer
     *
     * @ORM\Column(name="amount", type="integer", nullable=true)
     */
    private $amount;

    /**
     * @var integer
     *
     * @ORM\Column(name="points", type="integer")
     */
    private $points;

    /**
     * @var boolean
     *
     * @ORM\Column(name="verified", type="boolean")
     */
    private $verified;

    /**
     * @var string
     *
     * @ORM\Column(name="image", type="string", length=255)
     */
    private $image;

    /**
     * @var string
     *
     * @ORM\Column(name="price", type="integer")
     */
    private $price;

    /**
     * @var string
     *
     * @ORM\Column(name="discount", type="integer")
     */
    private $discount;

    /**
     * @var \Done\PunctisBundle\Entity\Brand
     *
     * @ORM\ManyToOne(targetEntity="Done\PunctisBundle\Entity\Brand", inversedBy="gifts")
     */
    protected $brand;

    /**
     * @var \Done\PunctisBundle\Entity\GiftCode
     *
     * @ORM\OneToMany(targetEntity="Done\PunctisBundle\Entity\GiftCode", mappedBy="gift", cascade={"persist"})
     */
    protected $codes;

    /**
     * Constructor
     */
    public function __construct()
    {
        $this->codes    = new \Doctrine\Common\Collections\ArrayCollection();
        $this->verified = false;
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set name
     *
     * @param string $name
     * @return Gift
     */
    public function setName($name)
    {
        $this->name = $name;

        return $this;
    }

    /**
     * Get name
     *
     * @return string 
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     * Set description
     *
     * @param string $description
     * @return Gift
     */
    public function setDescription($description)
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Get description
     *
     * @return string 
     */
    public function getDescription()
    {
        return $this->description;
    }

    /**
     * Set redemption
     *
     * @param string $redemption
     * @return Gift
     */
    public function setRedemption($redemption)
    {
        $this->redemption = $redemption;

        return $this;
    }

    /**
     * Get redemption
     *
     * @return string 
     */
    public function getRedemption()
    {
        return $this->redemption;
    }

    /**
     * Set points
     *
     * @param integer $points
     * @return Gift
     */
    public function setPoints($points)
    {
        $this->points = $points;

        return $this;
    }

    /**
     * Get points
     *
     * @return integer 
     */
    public function getPoints()
    {
        return $this->points;
    }

    /**
     * Set amount
     *
     * @param integer $amount
     * @return Gift
     */
    public function setAmount($amount)
    {
        $this->amount = $amount;

        return $this;
    }

    /**
     * Get amount
     *
     * @return integer 
     */
    public function getAmount()
    {
        return $this->amount;
    }

    /**
     * Set verified
     *
     * @param boolean $verified
     * @return Gift
     */
    public function setVerified($verified)
    {
        $this->verified = $verified;

        return $this;
    }

    /**
     * Get verified
     *
     * @return boolean 
     */
    public function getVerified()
    {
        return $this->verified;
    }

    /**
     * Set image
     *
     * @param string $image
     * @return Gift
     */
    public function setImage($image)
    {
        $this->image = $image;

        return $this;
    }

    /**
     * Get image
     *
     * @return string 
     */
    public function getImage()
    {
        return $this->image;
    }

    /**
     * Set price
     *
     * @param integer $price
     * @return Gift
     */
    public function setPrice($price)
    {
        $this->price = $price;

        return $this;
    }

    /**
     * Get price
     *
     * @return integer 
     */
    public function getPrice()
    {
        return $this->price;
    }

    /**
     * Set discount
     *
     * @param integer $discount
     * @return Gift
     */
    public function setDiscount($discount)
    {
        $this->discount = $discount;

        return $this;
    }

    /**
     * Get discount
     *
     * @return integer 
     */
    public function getDiscount()
    {
        return $this->discount;
    }

    /**
     * Set brand
     *
     * @param \Done\PunctisBundle\Entity\Brand $brand
     * @return Gift
     */
    public function setBrand(\Done\PunctisBundle\Entity\Brand $brand = null)
    {
        $this->brand = $brand;

        return $this;
    }

    /**
     * Get brand
     *
     * @return \Done\PunctisBundle\Entity\Brand 
     */
    public function getBrand()
    {
        return $this->brand;
    }

    /**
     * Add codes
     *
     * @param \Done\PunctisBundle\Entity\GiftCode $codes
     * @return Gift
     */
    public function addCode(\Done\PunctisBundle\Entity\GiftCode $codes)
    {
        $this->codes[] = $codes;

        return $this;
    }

    /**
     * Set validbegin
     *
     * @param \Date $validbegin
     * @return UserInfo
     */
    public function setValidbegin($validbegin)
    {
        $this->validbegin = $validbegin;

        return $this;
    }

    /**
     * Get validbegin
     *
     * @return \Date 
     */
    public function getValidbegin()
    {
        return $this->validbegin;
    }

    /**
     * Set validend
     *
     * @param \Date $validend
     * @return UserInfo
     */
    public function setValidend($validend)
    {
        $this->validend = $validend;

        return $this;
    }

    /**
     * Get validend
     *
     * @return \Date 
     */
    public function getValidend()
    {
        return $this->validend;
    }

    /**
     * Remove codes
     *
     * @param \Done\PunctisBundle\Entity\GiftCode $codes
     */
    public function removeCode(\Done\PunctisBundle\Entity\GiftCode $codes)
    {
        $this->codes->removeElement($codes);
    }

    /**
     * Get codes
     *
     * @return \Doctrine\Common\Collections\Collection 
     */
    public function getCodes()
    {
        return $this->codes;
    }
} 
```

* * *

```
<?php

namespace Done\PunctisBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * GiftCode
 *
 * @ORM\Table(name="giftcode")
 * @ORM\Entity
 */
class GiftCode
{
    /**
     * @var integer
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @var string
     *
     * @ORM\Column(name="code", type="string", length=255)
     */
    private $code;

    /**
     * @var \DateTime
     *
     * @ORM\Column(name="provided", type="datetime", nullable=true)
     */
    private $provided;

    /**
     * @var \Done\PunctisBundle\Entity\Gift
     *
     * @ORM\ManyToOne(targetEntity="Done\PunctisBundle\Entity\Gift", inversedBy="codes")
     */
    protected $gift;

    public function __construct( )
    {
        $this->provided = null;
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set code
     *
     * @param string $code
     * @return GiftCode
     */
    public function setCode($code)
    {
        $this->code = $code;

        return $this;
    }

    /**
     * Get code
     *
     * @return string 
     */
    public function getCode()
    {
        return $this->code;
    }

    /**
     * Set provided
     *
     * @param \DateTime $provided
     * @return GiftCode
     */
    public function setProvided($provided)
    {
        $this->provided = $provided;

        return $this;
    }

    /**
     * Get provided
     *
     * @return \DateTime 
     */
    public function getProvided()
    {
        return $this->provided;
    }

    /**
     * Set user
     *
     * @param string $user
     * @return GiftCode
     */
    public function setUser($user)
    {
        $this->user = $user;

        return $this;
    }

    /**
     * Get user
     *
     * @return string 
     */
    public function getUser()
    {
        return $this->user;
    }

    /**
     * Set gift
     *
     * @param \Done\PunctisBundle\Entity\Gift $gift
     * @return GiftCode
     */
    public function setGift(\Done\PunctisBundle\Entity\Gift $gift = null)
    {
        $this->gift = $gift;

        return $this;
    }

    /**
     * Get gift
     *
     * @return \Done\PunctisBundle\Entity\Gift 
     */
    public function getGift()
    {
        return $this->gift;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:59:57.237

您可以尝试以下方法：

```
$query=$entityManager->createQuery("SELECT g
                                      FROM gift g  
                                     WHERE  Now() >= g.validbegin 
                                        AND Now() <= g.validend 
                                        AND gc.provided IS NULL");
 $list=$query->getResults(); 
```

现在你可以遍历`$list`并且每个元素都是一个`Gift`.

`Giftcodes`要知道a有多少`Gift`，您只需要执行以下操作：

```
 $qtty= count( $gift->getCodes()); 
```

# c - 如何在单元测试源文件中使用（旧版）C 源文件中的 typedef？

> ID：14674240
> 
> 赞同：0
> 
> 时间：2013-02-03T15:47:49.533
> 
> 标签：c, unit-testing, testing, legacy-code

我有一个旧的 C 源文件，它定义了一个枚举。

```
//source.c
typedef enum
{
    ENUM_0,
    ENUM_1,
    ENUM_2
} my_enum; 
```

如何在单元测试的源代码中使用这个枚举？
我可以想到 2 个选项：
1\. 将 typedef 复制粘贴到我的源代码中。如果原始文件中的 typedef 发生更改，可能会导致测试中断。
2\. 在我的单元测试文件中使用#include "source.c"。最终导致模块分离不良。

谢谢

# c# - 由于 C# 的 Barrier 类中的 RemoveParticipants 导致的奇怪死锁

> ID：14674245
> 
> 赞同：1
> 
> 时间：2013-02-03T15:48:15.650
> 
> 标签：c#, barrier

在使用 C Sharp's Barrier 时，我遇到了一个非常奇怪的死锁。目的是看看`RemoveParticipants()`实际是如何工作的。我从 2 个线程（2 个动作）开始，每个线程执行`barrier.SignalAndWait();`. 之后，一个线程将删除一名参与者。从这一点开始，屏障计数只有 1。正确地，所有剩余的`barrier.SignalAndWait();`都应该通过而没有任何死锁。但是，下面的程序是死锁的。

```
using System;
using System.Threading;
using System.Threading.Tasks;

class BarrierDemo
{
    /* Print out barrier's phase and count */
    static void printInfo(int action, Barrier b){
        Console.WriteLine("action {0} : phase = {1} ; count = {2} ",action, b.CurrentPhaseNumber, b.ParticipantCount);
    }

    static void Main(string[] args)
    {
        Barrier barrier = new Barrier(2);

        Action action1 = () =>
        {
            printInfo(1,barrier);

            barrier.SignalAndWait();

            //Thread.Sleep(1000);

            printInfo(1,barrier);

            barrier.SignalAndWait();

            printInfo(1,barrier);

            Console.WriteLine("action 1: terminating");
        };

        Action action2 = () =>
        {
            printInfo(2,barrier);

            barrier.SignalAndWait();

            Thread.Sleep(1000);
            Console.WriteLine("action 2 : wake up 1 ");
            barrier.RemoveParticipants(1);
            Thread.Sleep(1000);
            Console.WriteLine("action 2 : wake up 2 ");
            printInfo(2,barrier);

            barrier.SignalAndWait(); // **DEADLOCK HERE**

            printInfo(2,barrier);
        };

        /* Execute 2 actions in parallel */
        Parallel.Invoke(action1,action2);

        Console.WriteLine("Going to dispose");
        barrier.Dispose();

    }

} 
```

我在跟踪时收​​到的输出是：

```
action 1 : phase = 0 ; count = 2
action 2 : phase = 0 ; count = 2
action 1 : phase = 1 ; count = 2
action 2 : wake up 1
action 1 : phase = 2 ; count = 1
action 1: terminating
action 2 : wake up 2
action 2 : phase = 2 ; count = 1
[Deadlock] 
```

另一个注意事项是，如果我在 action2 中注释所有 System.Sleep() 并在 action1 中取消注释 System.Sleep()。然后程序终止：

```
action 1 : phase = 0 ; count = 2
action 2 : phase = 0 ; count = 2
action 2 : wake up 1
action 2 : wake up 2
action 2 : phase = 1 ; count = 1
action 2 : phase = 2 ; count = 1
action 1 : phase = 2 ; count = 1
action 1 : phase = 3 ; count = 1
action 1: terminating
Going to dispose 
```

我不知道为什么上述程序死锁？为什么在它应该通过`action2`的时候停下来（障碍数只有 1）？`barrier.SignalAndWait();`

感谢您的观看和任何帮助。

> **解决方案总结：**
> 
> 这个问题是平台相关的。由于在非本机平台上运行它，我遇到了死锁。我尝试使用 2 个在线编译器（1）[http://www.compileonline.com/compile_csharp_online.php](http://www.compileonline.com/compile_csharp_online.php)，（2）[https://compilr.com/](https://compilr.com/)并陷入僵局。第一个唯一的编译器使用 mono 来执行 windows 可执行文件（它是非本地的）。我不确定第二个在线编译器的平台。
> 
> 但是，正如 and 所建议的`Phillip Scott Givens`，`svick`我在运行 .Net 4.0 的 Visual C# 2010 上本地安装并运行了该示例，并且死锁消失了。

# python - 在我导入模块后的python中，有没有办法找到它是从哪个物理文件加载的？

> ID：14674246
> 
> 赞同：1
> 
> 时间：2013-02-03T15:48:16.167
> 
> 标签：python, module, package, loading

我认为我的数学包中出现了一些问题，我想确保我正在加载正确的模块。如何检查 python 中加载模块的物理文件位置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T15:49:42.620

使用`__file__`属性：

```
>>> import numpy
>>> numpy.__file__
'/usr/lib/python2.7/dist-packages/numpy/__init__.pyc' 
```

请注意，用 C 编写并静态链接到解释器的内置模块没有此属性：

```
>>> import math
>>> math.__file__
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'module' object has no attribute '__file__' 
```

获取文件路径的另一种方法是使用[`inspect.getfile`](http://docs.python.org/2/library/inspect.html#inspect.getfile). `TypeError`如果传递的对象是内置模块、类或函数，则会引发。

附带说明一下，您应该避免使用与语言内​​置或标准库模块冲突的名称。所以，我建议你将你的`math`包重命名为别的东西，或者，如果它是一个包的一部分，比如`mypackage.math`，避免直接导入它并改用它`mypackage.math`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T15:49:42.033

检查`themodule.__file__`。

```
import urllib
print urllib.__file__ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T15:49:53.743

```
>>> import math
>>> math.__file__
'/usr/lib/python2.7/lib-dynload/math.so' 
```

# java - 将自定义 ArrayList 转换为 LinkedHashSet

> ID：14674251
> 
> 赞同：3
> 
> 时间：2013-02-03T15:48:54.183
> 
> 标签：java, android, arraylist, linkedhashset

我有一个`ArrayAdapter<Summary>`包含事件列表的自定义。中有重复的值`List<Summary>`，所以我试图将值放入，`List<Summary>`但这`LinkedHashSet<Summary>`会显示一个空白页。

如何将自定义转换`ArrayList`为`LinkedHashSet`获取唯一数据？

**主.java：**

```
LinkedHashSet<Summary> listToSet = new LinkedHashSet<Summary>();
final List<Summary> summaries = new ArrayList<Summary>();

public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    View v =  inflater.inflate(R.layout.events_summary, container, false);

    .......

    setListView(month, year, date_value);
    summaryAdapter = new SummaryAdapter(this.getActivity().getApplicationContext(), R.layout.listview_item_row, listToSet);

    calendarSummary = (ListView) v.findViewById(R.id.calendarSummary);
    calendarSummary.setAdapter(summaryAdapter);

    return v;
}

public void setListView(int month, int year, int dv) {

        events = new HolidayEvents();
        _calendar = Calendar.getInstance(Locale.getDefault());
        int totalDays = _calendar.getActualMaximum(Calendar.DAY_OF_MONTH);

        for(int i = 1; i <= totalDays; i++){
            if(isHoliday(i, month, year, dv))
            {
                date = i + " " + getMonthForInt(month-1) + " " + year;

                for (Event event : events.eventDetails(this, month, i)) 
                {
                       summaries.add(new Summary(date, event.eventdetails));
                       listToSet.addAll(summaries);

                } 
            }
        }
} 
```

**ArrayAdapter.java：**

```
public class SummaryAdapter extends ArrayAdapter<Summary>{

    Context context; 
    int layoutResourceId;
    LayoutInflater mInflater;
    LinkedHashSet<Summary> list = null;
    List<Summary> data = null;

    public SummaryAdapter(Context context, int layoutResourceId, LinkedHashSet<Summary> summaries) {
        super(context, layoutResourceId);
        this.layoutResourceId = layoutResourceId;
        this.context = context;
        this.list = summaries;
        data = new ArrayList<Summary>(list); //converting LinkedHashSet to List
        mInflater = LayoutInflater.from(context);
    }

 ....rest of the code retrieving data by using data.get(position) ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-10-27T07:42:43.150

您需要确保放入 Set 的类正确覆盖 Equals 和 hashCode 函数。

让我们看看 hashCode 没有被覆盖的情况：

```
import java.util.*;

public class Example {

    public static class Abc {
        protected String s;
        public Abc(String s) {
            this.s = s;
        }

        @Override
        public boolean equals(Object other) {
            if (other instanceof Abc) {
                return ((Abc) other).s.equals(this.s);
            }
            return false;
        }

        @Override
        public int hashCode() {
            return (int) (Math.random() * Integer.MAX_VALUE);
        }

        public String toString() {
            return "Abc: " + this.s; 
        }
    }

    public static void main(String[] args) {

        ArrayList<Abc> ar = new ArrayList<>();

        ar.add(new Abc("a"));
        ar.add(new Abc("a"));
        ar.add(new Abc("a"));

        LinkedHashSet<Abc> lhs = new LinkedHashSet<>(ar);

        System.out.println("ar: " + ar);
        System.out.println("LinkedHashSet: " + lhs);

    }
} 
```

这将产生：

> ar：[Abc：a，Abc：a，Abc：a] LinkedHashSet：[Abc：a，Abc：a，Abc：a]

即使 equals 已正确实施。我相信您可能想要仔细检查 HashCodes 和 Equals 的正确实现。

# c# - ASP.NET Web API 获取子列表（分层资源）

> ID：14674255
> 
> 赞同：5
> 
> 时间：2013-02-03T15:49:42.010
> 
> 标签：c#, asp.net, rest, asp.net-web-api, asp.net-mvc-routing

我想使用 ASP.NET Web Api 实现以下休息模式：

```
http://mydomain/api/students
http://mydomain/api/students/s123
http://mydomain/api/students/s123/classes
http://mydomain/api/students/s123/classes/c456 
```

我使用 ApiController 和以下两种方法使前两个链接正常工作：

```
public class StudentsController : ApiController {
  // GET api/students
  public IEnumerable<Student> GetStudents() {  
  }

  // GET api/students/5
  public IEnumerable<Student> GetStudent(string id) {  
  }
} 
```

在同一个控制器中，（或者我是否需要一个名为 ClassesController 的不同控制器？），我将如何实现最后两个链接？此外，“类”部分的路由会是什么样子（如果需要）？

这是我的 WebApiConfig （我想保持动态，而不是尽可能硬编码到 /classes 的路由：

```
config.Routes.MapHttpRoute(
  name: "DefaultApi",
  routeTemplate: "api/{controller}/{id}",
  defaults: new { id = RouteParameter.Optional }
);   

// EDIT - I'm getting 404's when trying to use this
context.Routes.MapHttpRoute(
  name: "JobsApi",
  routeTemplate: this.AreaName + "/Students/{id}/Classes/{classId}",
  defaults: new { classId = RouteParameter.Optional }
); 
```

编辑这是我新创建的 ClassesController：

```
public class ClassesController : ApiController {
  // GET api/classes
  public IEnumerable<TheClass> Get(string id) {    
      return null;
  }
} 
```

尝试访问此 URL 时出现 404 错误：

```
http://mydomain/api/students/s123/classes 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T17:47:31.073

ASP.NET 中的路由可以表达这些更复杂的规则，但需要明确设置。例如，在这种情况下，您必须定义 2 条路线：

```
config.Routes.MapHttpRoute(
  name: "DefaultApi",
  routeTemplate: "api/{controller}/{id}",
  defaults: new { id = RouteParameter.Optional }
);   

config.Routes.MapHttpRoute(
  name: "DefaultApi",
  routeTemplate: "api/students/{studentId}/{controller}/{classId}",
  defaults: new { classId = RouteParameter.Optional }
); 
```

你会有一个控制器：

```
public class ClassesController
{
   public TheClass Get(int studentId, int classId)
   {
       ....
   }
} 
```

这可能并不理想，但却是主要选择。

我正在研究分层路由，由于 Web API 中的实现问题，这是不可能的，但这个问题现在已经修复，所以我可能会再次开始研究它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-04T10:29:11.923

使用这种漂亮的分层方法，您会更加关注内部路由。有一个很好的示例应用程序采用分层资源结构：[PingYourPackage](https://github.com/tugberkugurlu/PingYourPackage)。检查出。

> **注意：**我有一篇关于这个问题的博客文章，解释了以下问题，并为那些有一些代码示例的人提供了解决方案。您可以查看它以获取更多详细信息：
> 
> *   [ASP.NET Web API 中的分层资源结构](http://www.tugberkugurlu.com/archive/hierarchical-resource-structure-in-asp-net-web-api)

让我通过设置一个示例场景来简要解释这里的问题。对于此类情况，这可能不是理想的方法，但可以很好地解决问题。假设您的数据库中有以下两家货运公司的附属公司：

*   附属公司 1（ID：100）
*   附属公司 2（编号：101）

然后假设这些附属公司附有一些货物：

*   附属公司 1（键：100）
    *   装运1（关键：100）
    *   装运 2（密钥：102）
    *   装运4（密钥：104）
*   附属公司 2（键：101）
    *   装运 3（密钥：103）
    *   装运 5（密钥：105）

最后，我们希望有以下资源结构：

```
GET api/affiliates/{key}/shipments
GET api/affiliates/{key}/shipments/{shipmentKey}
POST api/affiliates/{key}/shipments
PUT api/affiliates/{key}/shipments/{shipmentKey}
DELETE api/affiliates/{key}/shipments/{shipmentKey} 
```

## 路由问题

@Ali 已经解释过了，但我在这里有不同的方法。假设我们正在发送一个 GET 请求`/api/affiliates/105/shipments/102`。请注意，此处的附属密钥是 105，它不存在。因此，我们希望尽快在此处终止请求。我们可以通过每个路由消息处理程序来实现这一点。

## 授权问题

如果你有某种类型的身份验证，你会想要确保（在我们这里的场景中）经过身份验证的用户和请求的附属资源是相关的。例如，假设**Affiliate1在****Affiliate 角色**下进行了身份验证，并且您已`AuthorizeAttribute`注册以检查“Affiliate”角色授权。在这种情况下，您将惨遭失败，因为这意味着**Affiliate1**可以访问以下资源：`/api/affiliates/101/shipments`属于 Affiliate2。我们可以通过自定义来消除这个问题`AuthorizeAttribute`。

## 所有权问题

现在，以下 URI 应该为我提供正确的数据：

> 获取 /api/affiliates/100/shipments/102

但是，以下 URI 会发生什么：

> 获取 /api/affiliates/100/shipments/103

这应该会得到“404 Not Found”HTTP 响应，因为ID 为**100的****会员**不拥有ID 为**103的****货件**。

# ruby-on-rails - 如何将其他参数传递给 Rails 中的资源路由？

> ID：14674258
> 
> 赞同：1
> 
> 时间：2013-02-03T15:49:43.370
> 
> 标签：ruby-on-rails

我有一个模型叫`Post`. 在`config/routes.rb`中，我将其路线定义为：

```
resources :post 
```

默认路径下一切正常。我可以在以下网址创建一个新帖子：

```
/posts/new 
```

我需要传递额外的参数，以便新的 url 变为：

```
/posts/new/:year/:month/:day 
```

如果我执行以下操作，则假定 a`post_id`应该存在：

```
resources :posts do
  match '/new/:year/:month/:day',         
    :to => 'posts#new',
    :constraints => {:year => /\d{4}/, :month => /\d{2}/, :day => /\d{2}/},
    :as => 'new_post'
end 
```

对于以上内容，`rake routes`给我：

```
/posts/:post_id/new/:year/:month/:day(.:format) 
```

如何配置默认`new`路径以传递其他参数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T15:51:45.487

```
...
match '/new/:year/:month/:day', :on => :new
... 
```

# excel - 如何自动化日常邮件任务？

> ID：14674260
> 
> 赞同：0
> 
> 时间：2013-02-03T15:50:23.053
> 
> 标签：excel, outlook, vba

我想自动化我的一项日常任务。场景是这样的：

我必须在 Microsoft Outlook 中起草这样的邮件。

> 嗨`XXX`，
> 
> 请考虑`ZZZ`批准代码。

`XXX`每个`ZZZ`. _ 这些值存储在 microsoft excel 中的不同列中。

有什么办法可以让我多次生成这种固定格式的邮件？Outlook 属性或脚本方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:50:30.857

我使用 CDO 从 Excel VBA 发送电子邮件。 [查看这篇文章](http://www.rondebruin.nl/cdo.htm)以帮助您入门。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-14T18:41:07.183

这个链接可能对你有帮助，它对我帮助很大：[http ://www.rondebruin.nl/win/s1/outlook/amail1.htm](http://www.rondebruin.nl/win/s1/outlook/amail1.htm)

也有几个简单的例子。

# gradle - Gradle 多项目命名：如何为所有子项目设置属性（例如 baseName）？

> ID：14674263
> 
> 赞同：3
> 
> 时间：2013-02-03T15:51:01.900
> 
> 标签：gradle, multi-project

我开始将 Gradle 用于多项目。然而，Gradle 手册并没有给出关于子项目命名的最佳实践的很多提示。

我有一个名为“datalogger”的多项目，它由两个子项目“核心”和“条目”组成：

```
- datalogger
--- core
--- entries 
```

当我构建项目时，我得到了 jar 'core-1.0.jar' 和 'entries-1.0.jar'。如何以通用方式管理命名为“datalogger-core-1.0.jar”和“datalogger-entries-1.0.jar”？我知道，我可以按如下方式更改文件夹的名称：

```
- datalogger
--- datalogger-core
--- datalogger-entries 
```

但我认为，这不会被视为好方法。我也可以手动更改`archivesBaseName`每个项目的。但如前所述，我宁愿找到一种以通用方式执行此操作的方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-03T16:18:40.567

```
subprojects {
    tasks.withType(Jar) {
        baseName = "datalogger-$project.name"
    }
} 
```

或者，您可以`archivesBaseName`以类似的方式进行设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T11:19:22.547

我们通过重命名子项目来处理这个问题，在创建/命名您的 jar 时将考虑新名称：参考：[如何在 gradle 中重命名项目而不是使用文件夹名称？](https://stackoverflow.com/questions/11530420/how-to-rename-the-project-in-gradle-instead-of-using-folder-name/14269538#14269538)

```
include 'xxx', 'yyy'
rootProject.children.each { it.name = rootProject.name + it.name } 
```

# python - Python中1Gb文本文件的词频计算

> ID：14674266
> 
> 赞同：5
> 
> 时间：2013-02-03T15:51:16.437
> 
> 标签：python, word-frequency

我正在尝试计算大小为 1.2 GB 的文本文件的字频，大约 2.03 亿字。我正在使用以下 Python 代码。但它给了我一个记忆错误。有什么解决办法吗？

这是我的代码：

```
import re
# this one in honor of 4th July, or pick text file you have!!!!!!!
filename = 'inputfile.txt'
# create list of lower case words, \s+ --> match any whitespace(s)
# you can replace file(filename).read() with given string
word_list = re.split('\s+', file(filename).read().lower())
print 'Words in text:', len(word_list)
# create dictionary of word:frequency pairs
freq_dic = {}
# punctuation marks to be removed
punctuation = re.compile(r'[.?!,":;]') 
for word in word_list:
    # remove punctuation marks
    word = punctuation.sub("", word)
    # form dictionary
    try: 
        freq_dic[word] += 1
    except: 
        freq_dic[word] = 1

print 'Unique words:', len(freq_dic)
# create list of (key, val) tuple pairs
freq_list = freq_dic.items()
# sort by key or word
freq_list.sort()
# display result
for word, freq in freq_list:
    print word, freq 
```

这是错误，我收到了：

```
Traceback (most recent call last):
  File "count.py", line 6, in <module>
    word_list = re.split('\s+', file(filename).read().lower())
  File "/usr/lib/python2.7/re.py", line 167, in split
    return _compile(pattern, flags).split(string, maxsplit)
MemoryError 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-03T15:57:28.243

问题从这里开始：

```
file(filename).read() 
```

这会将整个文件读入一个字符串。相反，如果您逐行或逐块处理文件，则不会遇到内存问题。

```
with open(filename) as f:
    for line in f: 
```

* * *

您还可以从使用[collections.Counter](http://docs.python.org/2/library/collections.html#collections.Counter)来计算单词的频率中受益。

```
In [1]: import collections

In [2]: freq = collections.Counter()

In [3]: line = 'Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod'

In [4]: freq.update(line.split())

In [5]: freq
Out[5]: Counter({'ipsum': 1, 'amet,': 1, 'do': 1, 'sit': 1, 'eiusmod': 1, 'consectetur': 1, 'sed': 1, 'elit,': 1, 'dolor': 1, 'Lorem': 1, 'adipisicing': 1}) 
```

再数几个字，

```
In [6]: freq.update(line.split())

In [7]: freq
Out[7]: Counter({'ipsum': 2, 'amet,': 2, 'do': 2, 'sit': 2, 'eiusmod': 2, 'consectetur': 2, 'sed': 2, 'elit,': 2, 'dolor': 2, 'Lorem': 2, 'adipisicing': 2}) 
```

A`collections.Counter`是 的子类`dict`，因此您可以以您已经熟悉的方式使用它。此外，它还有一些有用的计数方法，例如[most_common](http://docs.python.org/2/library/collections.html#collections.Counter.most_common)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-03T15:56:00.627

问题是您正试图将整个文件读入内存。解决方法是逐行读取文件，统计每一行的字数，并对结果求和。

# java - 如何让重绘变慢？

> ID：14674268
> 
> 赞同：1
> 
> 时间：2013-02-03T15:51:28.893
> 
> 标签：java, swing, jframe, repaint

我正在制作一个 Java 应用程序，我想知道是否有办法让 jframe 上的重绘速度变慢。让我详细说明一下，该应用程序有一个 jframe 并调用另一个 jframe 来显示一个必须从一侧移动到另一侧的图形，但它可以以您实际可以看到运动的速度进行。

编辑*为了让我自己清楚，我添加了一段代码。

```
import javax.swing.JFrame;
import javax.swing.JLabel;

public class NewJFrame extends javax.swing.JFrame {

    /**
     * Creates new form NewJFrame
     */
    public NewJFrame() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">
    private void initComponents() {

        jButton1 = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTextArea1 = new javax.swing.JTextArea();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jButton1.setText("Start");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        jTextArea1.setColumns(20);
        jTextArea1.setRows(5);
        jScrollPane1.setViewportView(jTextArea1);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1)
                .addContainerGap())
            .addGroup(layout.createSequentialGroup()
                .addGap(152, 152, 152)
                .addComponent(jButton1)
                .addContainerGap(191, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(47, 47, 47)
                .addComponent(jButton1)
                .addGap(18, 18, 18)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 149, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(63, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {
        String position="";
        JFrame frame1=new JFrame();
        JLabel label1=new JLabel();
        label1.setText("Hello!");
        frame1.add(label1);
        frame1.setSize(400,300);
        frame1.setVisible(true);
        for(int i=1;i<20;i++){
            label1.setLocation(i, i);
            frame1.repaint();
            position+="The label is at position: "+label1.getLocation()+"\n";
            jTextArea1.setText(position);
        }
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
               NewJFrame frame= new NewJFrame();
            frame.setLocationRelativeTo(null);
            frame.setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify
    private javax.swing.JButton jButton1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTextArea jTextArea1;
    // End of variables declaration
} 
```

我需要的是让 frame1 显示 label1 定位的动画，并在每次更改时在 textarea 中打印一行位置。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T18:40:34.797

1.  `sleep`应该在 EDT 上严格禁止
2.  如果你觉得你想用`sleep`，你应该直接想到一个 Swing Timer

现在，如果您想查看如何轻松更改移动元素速度的示例，您不必更改摆动计时器的频率，而是实际更改移动元素的速度。50Hz 的频率对于人类来说通常就足够了。

这是一个小演示代码：

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.net.MalformedURLException;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JSlider;
import javax.swing.SwingUtilities;
import javax.swing.Timer;
import javax.swing.UnsupportedLookAndFeelException;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

public class TestAnimation2 {

    private static final int NB_OF_IMAGES_PER_SECOND = 50;
    private static final int WIDTH = 800;
    private static final int HEIGHT = 600;

    private static final int MIN = 0;
    private static final int MAX = 100;

    private double speed = convert(50);

    private double dx;
    private double dy;

    private double x = WIDTH / 2;
    private double y = HEIGHT / 2;

    private JFrame frame;
    private CirclePanel circle;
    private Runnable job;

    private long lastMove = System.currentTimeMillis();

    protected void initUI() throws MalformedURLException {
        frame = new JFrame(TestAnimation2.class.getSimpleName());
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLayout(null);
        circle = new CirclePanel();
        circle.setSize(20, 20);
        frame.add(circle);
        frame.setSize(WIDTH, HEIGHT);
        dx = speed;
        dy = speed;
        final JSlider slider = new JSlider(MIN, MAX);
        slider.addChangeListener(new ChangeListener() {

            @Override
            public void stateChanged(ChangeEvent e) {
                speed = convert(slider.getValue());
                if (dx > 0) {
                    dx = speed;
                } else {
                    dx = -speed;
                }
                if (dy > 0) {
                    dy = speed;
                } else {
                    dy = -speed;
                }

            }
        });
        slider.setValue(50);
        slider.setLocation(0, 0);
        slider.setSize(slider.getPreferredSize());
        frame.add(slider);
        frame.setVisible(true);
        Timer t = new Timer(1000 / NB_OF_IMAGES_PER_SECOND, new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                move();
            }
        });
        t.start();
    }

    protected double convert(double sliderValue) {
        return sliderValue + 1;
    }

    protected void move() {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                x += dx;
                y += dy;
                if (x + circle.getWidth() > frame.getContentPane().getWidth()) {
                    x = frame.getContentPane().getWidth() - circle.getWidth();
                    dx = -speed;
                } else if (x < 0) {
                    x = 0;
                    dx = speed;
                }
                if (y + circle.getHeight() > frame.getContentPane().getHeight()) {
                    y = frame.getContentPane().getHeight() - circle.getHeight();
                    dy = -speed;
                } else if (y < 0) {
                    y = 0;
                    dy = speed;
                }
                circle.setLocation((int) x, (int) y);
                circle.repaint();
            }
        });
    }

    public static class CirclePanel extends JPanel {

        public CirclePanel() {
            super();
            setOpaque(false);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            g.setColor(Color.RED);
            g.fillOval(0, 0, getWidth(), getHeight());
        }
    }

    public static void main(String[] args) throws ClassNotFoundException, InstantiationException, IllegalAccessException,
            UnsupportedLookAndFeelException {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                try {
                    new TestAnimation2().initUI();
                } catch (MalformedURLException e) {
                    e.printStackTrace();
                }
            }
        });
    }
} 
```

# java - JavaFX 中的多线程会挂起 UI

> ID：14674274
> 
> 赞同：23
> 
> 时间：2013-02-03T15:52:03.267
> 
> 标签：java, multithreading, javafx-2, javafx

我有一个简单的 JavaFX 2 应用程序，有 2 个按钮，分别是 Start 和 Stop。单击开始按钮时，我想创建一个后台线程，该线程将进行一些处理并随着它的进行更新UI（例如进度条）。如果单击停止按钮，我希望线程终止。

我尝试使用`javafx.concurrent.Task`从文档中收集的类来执行此操作，这可以正常工作。但是每当我单击开始时，用户界面就会冻结/挂起而不是保持正常。

她是主`Myprogram extends Application`类中用于显示按钮的代码：

```
public void start(Stage primaryStage)
{               
    final Button btn = new Button();
    btn.setText("Begin");

    //This is the thread, extending javafx.concurrent.Task :
    final MyProcessor handler = new MyProcessor();
    btn.setOnAction(new EventHandler<ActionEvent>()
    {
        public void handle(ActionEvent event)
        {                
           handler.run(); 
        }
    });

    Button stop = new Button();
    stop.setText("Stop");
    stop.setOnAction(new EventHandler<ActionEvent>()
        {
             public void handle(ActionEvent event)
             {
                handler.cancel();
             }
        }

    );
    // Code for adding the UI controls to the stage here.
} 
```

这是`MyProcessor`类的代码：

```
import javafx.concurrent.Task;
public class MyProcessor extends Task
{   
    @Override
    protected Integer call()
    {
        int i = 0;
        for (String symbol : feed.getSymbols() )
        {
            if ( isCancelled() )
            {
                Logger.log("Stopping!");
                return i;
            }
            i++;
            Logger.log("Doing # " + i);
            //Processing code here which takes 2-3 seconds per iteration to execute
            Logger.log("# " + i + ", DONE! ");            
        }
        return i;
    }
} 
```

很简单，但是每当我单击“开始”按钮时 UI 就会挂起，尽管控制台消息会继续显示（`Logger.log`只是`System.out.println`）

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-03T16:46:03.720

`Task`implements `Runnable`，因此当您调用时，`handler.run();`您实际上是`call`在 UI 线程中运行该方法。这将挂起用户界面。

您应该在后台线程中启动任务，通过执行程序或简单地调用`new Thread(handler).start();`.

[这在javadoc](http://docs.oracle.com/javafx/2/api/javafx/concurrent/Task.html)或[JavaFX concurrency tutorial](http://docs.oracle.com/javafx/2/threads/jfxpub-threads.htm)中有解释（可能不是很清楚）。

# python - 使用 CSV 文件在循环中跳过第一行（字段）？

> ID：14674275
> 
> 赞同：55
> 
> 时间：2013-02-03T15:52:05.830
> 
> 标签：python, csv, for-loop

> **可能重复：** [处理 CSV 数据时，如何忽略第一行数据？](https://stackoverflow.com/questions/11349333/when-processing-csv-data-how-do-i-ignore-the-first-line-of-data)

我正在使用 python 打开 CSV 文件。我正在使用公式循环，但我需要跳过第一行，因为它有标题。

到目前为止，我记得是这样的，但它缺少一些东西：我想知道是否有人知道我正在尝试做的事情的代码。

```
for row in kidfile:
    if row.firstline = false:  # <====== Something is missing here.
        continue
    if ...... 
```

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2013-02-03T16:06:40.857

有很多方法可以跳过第一行。除了Bakuriu所说的之外，我还要补充：

```
with open(filename, 'r') as f:
    next(f)
    for line in f: 
```

和：

```
with open(filename,'r') as f:
    lines = f.readlines()[1:] 
```

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2013-02-03T16:03:04.717

最好的方法是在将文件对象传递给模块*后*跳过标头：`csv`

```
with open('myfile.csv', 'r', newline='') as in_file:
    reader = csv.reader(in_file)
    # skip header
    next(reader)
    for row in reader:
        # handle parsed row 
```

这可以正确处理多行 CSV 标题。

* * *

较旧的答案：

可能你想要类似的东西：

```
firstline = True
for row in kidfile:
    if firstline:    #skip first line
        firstline = False
        continue
    # parse the line 
```

实现相同结果的另一种方法是`readline`在循环之前调用：

```
kidfile.readline()   # skip the first line
for row in kidfile:
    #parse the line 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2013-02-03T17:04:29.273

csvreader.next() Return the next row of the reader’s iterable object as a list, parsed according to the current dialect.

# ruby - 红宝石宝石需要问题

> ID：14674281
> 
> 赞同：1
> 
> 时间：2013-02-03T15:52:26.670
> 
> 标签：ruby, rvm, require

我是一个非常新的红宝石，我想做的实际上是使用谷歌代码中提供的开源代码将 stackoverflow 数据获取到 mysql 表中。它在 ruby​​ 中，可以在以下位置 ( `http://geeqe.googlecode.com/svn/trunk/scripts/load.rb`) 找到。前几行代码如下：

```
require 'rubygems'
require 'libxml'
require "mysql"
require "pp"

include LibXML 
```

在此之前安装 rvm，然后执行`rvm install 1.9.3, rvm install jruby`

但是当我尝试执行 ruby​​ load.py 时，我收到以下错误，由于我对 ruby​​ 的了解有限，我不确定该怎么做。

```
/Users/mac/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- libxml (LoadError)
    from /Users/mac/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from load.rb:2:in `<main>' 
```

这是我的宝石清单：

```
 *** LOCAL GEMS ***

    actionmailer (3.2.11)
    actionpack (3.2.11)
    activemodel (3.2.11)
    activerecord (3.2.11)
    activeresource (3.2.11)
    activesupport (3.2.11)
    arel (3.0.2)
    bigdecimal (1.1.0)
    builder (3.0.4)
    bundler (1.2.3)
    erubis (2.7.0)
    hike (1.2.1)
    i18n (0.6.1)
    io-console (0.3)
    journey (1.0.4)
    json (1.5.4)
    libxml-ruby (2.5.0)
    mail (2.4.4)
    mime-types (1.19)
    minitest (2.5.1)
    multi_json (1.5.0)
    polyglot (0.3.3)
    rack (1.4.4)
    rack-cache (1.2)
    rack-ssl (1.3.3)
    rack-test (0.6.2)
    rails (3.2.11)
    railties (3.2.11)
    rake (10.0.3, 0.9.2.2)
    rdoc (3.9.4)
    require (0.2.7)
    rubygems-bundler (1.1.0)
    rvm (1.11.3.6)
    sprockets (2.2.2)
    thor (0.17.0)
    tilt (1.3.3)
    treetop (1.4.12)
tzinfo (0.3.35) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:07:24.310

您还缺少 mysql gem。$gem 安装 mysql

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T16:08:06.773

只是重复我上面的评论：“你安装了 libxml 吗？尝试运行‘gem install libxml-ruby’。”

# libgdx - 支持 libgdx 的多种图像分辨率

> ID：14674282
> 
> 赞同：2
> 
> 时间：2013-02-03T15:52:32.023
> 
> 标签：libgdx

我应该如何遵循目录结构以及指定的内容，以便`assetManger`将该文件夹用于不同的分辨率。

我研究过`assetManager`，`ResolutionFileResolver`但直到现在我还不能完全弄清楚如何指定文件夹来支持不同的分辨率。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T16:56:18.287

**更新**：较新版本的 Libgdx 使用不同的策略来解析文件名（使用目录，而不是文件），因此此答案不适用于（0.9.2，我认为？[https://github.com/libgdx/ libgdx/commit/3afcfe49c40196765033a90b4610159183dde981](https://github.com/libgdx/libgdx/commit/3afcfe49c40196765033a90b4610159183dde981) )

内置[`ResolutionFileResolver`](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/assets/loaders/resolvers/ResolutionFileResolver.html)不使用目录层次结构。它使用文件后缀将屏幕分辨率与资产匹配。

这是来自 libGDX 的代码[`AssetManagerTest`](https://github.com/libgdx/libgdx/blob/master/tests/gdx-tests/src/com/badlogic/gdx/tests/AssetManagerTest.java)：

```
Resolution[] resolutions = { new Resolution(320, 480, ".320480"),
                             new Resolution(480, 800, ".480800"),
                             new Resolution(480, 856, ".480854") };
ResolutionFileResolver resolver = new ResolutionFileResolver(new InternalFileHandleResolver(), resolutions);
AssetManager manager = new AssetManager();
manager.setLoader(Texture.class, new TextureLoader(resolver));
... 
```

解析器根据当前屏幕分辨率附加这些后缀之一。因此，例如，如果您在 480x800 设备上查找“foo.jpg”，则会打开文件“foo.jpg.480800”。

如果您想根据目录解析文件（因此“foo.jpg”将被解析为“480x800/foo.jpg”或类似的东西），您可以编写一个新的解析器。只需执行[`FileHandleResolver`](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/assets/loaders/FileHandleResolver.html). [ResolutionFileResolver.java](https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/assets/loaders/resolvers/ResolutionFileResolver.java)源代码可能是一个不错的起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-08T10:23:20.743

曾经我也遇到过这个问题，但最后我得到了可行的解决方案，用于在 libgdx 中使用 SpriteBatch 或 Stage 绘制任何东西。使用正交相机我们可以做到这一点。

首先选择一个最适合游戏的恒定分辨率。在这里，我拍摄了 1280*720（横向）。

```
class ScreenTest implements Screen{

final float appWidth = 1280, screenWidth = Gdx.graphics.getWidth();
final float appHeight = 720, screenHeight = Gdx.graphics.getHeight();

OrthographicCamera camera;

SpriteBatch batch;
Stage stage;

Texture img1;
Image img2;

 public ScreenTest(){
  		camera = new OrthographicCamera();
		camera.setToOrtho(false, appWidth, appHeight);

        batch = new SpriteBatch();
 		batch.setProjectionMatrix(camera.combined);

        img1 = new Texture("your_image1.png");
 		img2 = new Image(new Texture("your_image2.png"));
 		img2.setPosition(0, 0); // drawing from (0,0)

        stage = new Stage(new StretchViewport(appWidth, appHeight, camera));
        stage.addActor(img2);
  }

    @Override
	public void render(float delta) {
	    batch.begin();
		batch.draw(img, 0, 0);
		batch.end();

		stage.act();
		stage.act(delta);
		stage.draw();

		// Also You can get touch input according to your Screen.

		if (Gdx.input.isTouched()) {
		 System.out.println(" X " + Gdx.input.getX() * (appWidth / screenWidth));
		 System.out.println(" Y " + Gdx.input.getY() * (appHeight / screenHeight));
	   }

	}
  //
  : 
  :
  //
}
```

以任何类型的分辨率运行此代码，它将以该分辨率进行调整而不会受到任何干扰。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T22:07:26.847

如果您使用[OrthographicCamera](http://code.google.com/p/libgdx/wiki/OrthographicCamera)，则无需处理不同的图像分辨率。

假设您有一台尺寸为 400x300 的相机。然后在坐标 (0,0) 处绘制一个 400x300 的大图像。然后，无论屏幕分辨率如何，图像都会被缩放以填满屏幕。这在 Android 上真的很简洁，不同设备之间的屏幕分辨率可能会有很大差异，这样做你不必考虑它。

# web-applications - 用于加载网页的简单 XULRunner 应用程序

> ID：14674283
> 
> 赞同：9
> 
> 时间：2013-02-03T15:52:46.870
> 
> 标签：web-applications, xul, xulrunner

我从未使用过 XUL，它看起来很神秘。创建一个在 Linux 环境中加载网页的简单 XUL 应用程序需要什么？无需窗口装饰、历史记录、后退或前进按钮。只是加载网页的最简单的 XUL 应用程序......使用带有 GRE 版本 10.0.11 的 xulrunner。

另外，哪里是获得有关编写 XUL 应用程序的教程的最佳地点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T16:53:26.013

我找到了答案。这是一种方法。

```
<?xml version="1.0"?>
<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
<window id="main" title="Konami Browser" width="800" height="600" 
    xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">
        <browser type="content" src="http://google.com/" flex="1"/>
</window> 
```

当然，目录结构中的其他文件也是必需的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T07:31:07.650

也许这可以解决问题，从命令行参数加载页面：

从...开始：

xulrunner /path/to/application.ini -test“ [http://www.google.nl](http://www.google.nl) ”

```
<?xml version="1.0"?>
<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>

<script type="application/x-javascript"> <![CDATA[
    function init_browser()
        {
        var cmdLine = window.arguments[0];
        cmdLine = cmdLine.QueryInterface(Components.interfaces.nsICommandLine);
        document.getElementById('id_browser').src = cmdLine.handleFlagWithParam("test", false));
        }
]]></script>

 <window id="main" title="Konami Browser" width="800" height="600" 
    xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
    onload="init_browser();">
        <browser id='id_browser' type="content" src="http://google.com/" flex="1"/>
</window>

]]></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T11:29:52.063

既然您已经提供了正确的答案，您可能希望查看一个简单的 XUL 教程来回答可能的进一步问题：

[http://www.xul.fr/tutorial/](http://www.xul.fr/tutorial/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T15:42:22.833

我没有 XULRunner，因此无法编写 XUL 代码，但我在[这里找到了一篇文章](https://groups.google.com/forum/?fromgroups#!topic/mozilla.dev.tech.xul/zC9uhuFEd34)，其中提供了有关如何访问命令行参数的提示。

# c++ - 容器使用的内部类型的内存分配

> ID：14674289
> 
> 赞同：6
> 
> 时间：2013-02-03T15:53:25.110
> 
> 标签：c++, c++11, std, allocator

C++11 标准在通用容器要求中有以下几行。

*(23.2.1 - 3)*

> 对于受本子条款影响的声明 allocator_type 的组件，存储在这些组件中的对象应使用 allocator_traits::construct 函数构造并使用 allocator_traits::destroy 函数 (20.6.8.2) 销毁。这些函数仅针对容器的元素类型调用，**而不针对容器使用的内部类型调用**

*(23.2.1 - 7)*

> 除非另有说明，**本节中定义的所有容器都使用分配器获取内存**

*容器使用的所有*内存是否都由指定的分配器分配？因为标准说内部类型不是用 allocator_traits::construct 构造的，所以应该有某种对 operator new 的调用。但是标准也说这个条款中定义的所有容器都使用分配器来获取内存，在我看来这意味着它不能是普通的新操作符，它必须是放置新操作符。我对么？

让我举个例子，为什么这很重要。

假设我们有一个类，它拥有一些分配的内存：

```
#include <unordered_map>
#include <iostream>
#include <cstdint>
#include <limits>
#include <memory>
#include <new>

class Arena
{
public:
        Arena(std::size_t size)
        {
                size_     = size;
                location_ = 0;

                data_ = nullptr;
                if(size_ > 0)
                        data_ = new(std::nothrow) uint8_t[size_];
        }
        Arena(const Arena& other) = delete;
        ~Arena()
        {
                if(data_ != nullptr)
                        delete[] data_;
        }
        Arena& operator =(const Arena& arena) = delete;

        uint8_t* allocate(std::size_t size)
        {
                if(data_ == nullptr)
                        throw std::bad_alloc();

                if((location_ + size) >= size_)
                        throw std::bad_alloc();

                uint8_t* result = &data_[location_];
                location_ += size;
                return result;
        }

        void clear()
        {
                location_ = 0;
        }

        std::size_t getNumBytesUsed() const
        {
                return location_;
        }

private:
        uint8_t* data_;
        std::size_t location_, size_;

}; 
```

我们还有自定义分配器：

```
template <class T> class FastAllocator
{
public:
        typedef T value_type;

        typedef T*       pointer;
        typedef const T* const_pointer;

        typedef T&       reference;
        typedef const T& const_reference;

        typedef std::size_t    size_type;
        typedef std::ptrdiff_t difference_type;

        template <class U> class rebind
        {
        public:
                typedef FastAllocator<U> other;

        };

        Arena* arena;

        FastAllocator(Arena& arena_): arena(&arena_) {}
        FastAllocator(const FastAllocator& other): arena(other.arena) {}
        template <class U> FastAllocator(const FastAllocator<U>& other): arena(other.arena) {}

        //------------------------------------------------------------------------------------
        pointer allocate(size_type n, std::allocator<void>::const_pointer)
        {
                return allocate(n);
        }
        pointer allocate(size_type n)
        {
                return reinterpret_cast<pointer>(arena->allocate(n * sizeof(T)));
        }

        //------------------------------------------------------------------------------------
        void deallocate(pointer, size_type) {}

        //------------------------------------------------------------------------------------
        size_type max_size() const
        {
                return std::numeric_limits<size_type>::max();
        }

        //------------------------------------------------------------------------------------
        void construct(pointer p, const_reference val)
        {
                ::new(static_cast<void*>(p)) T(val);
        }
        template <class U> void destroy(U* p)
        {
                p->~U();
        }

}; 
```

这是我们使用它的方式：

```
typedef std::unordered_map<uint32_t, uint32_t, std::hash<uint32_t>, std::equal_to<uint32_t>,
                           FastAllocator<std::pair<uint32_t, uint32_t>>> FastUnorderedMap;

int main()
{
        // Allocate memory in arena
        Arena arena(1024 * 1024 * 50);
        FastAllocator<uint32_t> allocator(arena);
        FastAllocator<std::pair<uint32_t, uint32_t>> pairAllocator(arena);
        FastAllocator<FastUnorderedMap> unorderedMapAllocator(arena);

        FastUnorderedMap* fastUnorderedMap = nullptr;

        try
        {
                // allocate memory for unordered map
                fastUnorderedMap = unorderedMapAllocator.allocate(1);

                // construct unordered map
                fastUnorderedMap =
                        new(reinterpret_cast<void*>(fastUnorderedMap)) FastUnorderedMap
                        (
                                0,
                                std::hash<uint32_t>(),
                                std::equal_to<uint32_t>(),
                                pairAllocator
                        );

                // insert something
                for(uint32_t i = 0; i < 1000000; ++i)
                        fastUnorderedMap->insert(std::make_pair(i, i));
        }
        catch(std::bad_alloc badAlloc)
        {
                std::cout << "--- BAD ALLOC HAPPENED DURING FAST UNORDERED MAP INSERTION ---" << std::endl;
        }

        // no destructor of unordered map is called!!!!
        return 0;
} 
```

如您所见，unordered_map 的析构函数从未被调用，但在销毁 arena 对象期间释放了内存。会不会有内存泄漏，为什么？

我非常感谢有关此主题的任何帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-03T16:03:56.993

分配器应该提供 4 个功能（此处感兴趣）：

*   2 用于内存管理：`allocate`/`deallocate`
*   2 用于对象生命周期管理：`construct`/`destroy`

您引用中的*这些功能*仅适用于`construct`and `destroy`（在上一句中提到），而不适用于`allocate`/ `deallocate`，因此没有矛盾。

现在，关于内存泄漏，为了使 arena 分配器工作，不仅容器中的对象应该使用 arena 分配器（容器保证）构建，而且*这些对象*分配的所有内存也应该从这个分配器获得；不幸的是，这可能会变得稍微复杂一些。

# javascript - 为什么在 javascript 中使用正则表达式匹配字符串时在输出数组中添加空字符串？

> ID：14674291
> 
> 赞同：2
> 
> 时间：2013-02-03T15:53:37.853
> 
> 标签：javascript, regex

我正在尝试学习`regex`javascript。在进行测试时，我的大脑在看到输出时会感到困惑。

您能否解释一下为什么我的输出结果数组在使用`*`in 模式而不是在`+`.

PS：输入的只是一个简单的示例字符串来学习。

这是我的示例代码：

```
a='bb bbbb bbb'
a.match(/(bb)*/g) // O/P is  ["bb","","bbbb","","bb","",""]
a.match(/(bb)+/g) // O/P is ["bb","bbbb","bb"] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T15:55:27.207

正则表达式中的`*`或[Kleene Star表示“零个或多个”，因此它匹配](http://en.wikipedia.org/wiki/Kleene_star)*空字符串*。

而是表示“一个或多个”，因此它与*空字符串*`+`不匹配。

 ** * *

鉴于我们有如下

```
a = 'bb bbbb bbb'; 
```

让我们这样表示：

```
a = /^bb bbbb bbb$/; 
```

where`^`是字符串的开头，是字符串`$`的结尾。

我们的模式是`(bb)*`。这意味着引擎将查找两个`b`“零次或多次”的序列。这意味着`bb`如果找到序列，则模式匹配，否则为*空字符串*。

现在，我将逐步使用点 ( `.`) 来表示正则表达式分析。

**脚步**

```
 STRING              MATCH ARRAY
start - /^.bb bbbb bbb$/ -> [ ]
    1 - /^bb. bbbb bbb$/ -> [ "bb" ]
    2 - /^bb .bbbb bbb$/ -> [ "bb", "" ]
    3 - /^bb bbbb. bbb$/ -> [ "bb", "", "bbbb" ]
    4 - /^bb bbbb .bbb$/ -> [ "bb", "", "bbbb", "", ]
    5 - /^bb bbbb bb.b$/ -> [ "bb", "", "bbbb", "", "bb" ]
    6 - /^bb bbbb bbb.$/ -> [ "bb", "", "bbbb", "", "bb", "", ]
    7 - /^bb bbbb bbb$./ -> [ "bb", "", "bbbb", "", "bb", "", "" ] 
```

自从模式匹配一​​个序列以来，`STEP 1`我们已经推送。`bb`

因为模式匹配*空字符串*，所以`STEP 2`我们已经推送。`""`

 *`STEP 3`我们推入是`bbbb`因为模式匹配了两个序列。

`STEP 4`->`STEP 2`

`STEP 5`->`STEP 1`

因为模式匹配*空字符串*`STEP 6`，所以我们已经推送，因为只找到了一个。`""`*`b`*

 *最后你遇到`$`令牌，它再次匹配*空字符串*。

请注意，如果字符串是`"bb bbbb bbbb"`数组将是`["bb", "", "bbbb", "", "bbbb", ""]`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T15:58:33.120

`*`表示“匹配前一组零次或多次”。引擎尝试`bb`在字符串中第一个之后的位置进行匹配。它找到一个空格，这意味着`(bb)`匹配“零次”，导致空匹配。

`+`表示“至少匹配前一个组一次”，因此每个匹配项都必须包含`bb`您的情况下的字符序列。

* * *

解释为什么最后有两个空匹配：

最后一个“词”是`bbb`。引擎匹配`bb`，这里没问题。然后`b`就剩一个了。它匹配`(bb)`“零次”。然后它尝试匹配字符串的最后一个位置，即在最后一个字符和字符串末尾之间。它再次匹配 es `(bb)`“零次”。

如果你想详细了解正则表达式引擎的工作原理，我推荐[《精通正则表达式》](http://shop.oreilly.com/product/9780596528126.do)这本书。***

# android - 如何在Android中删除文件夹

> ID：14674292
> 
> 赞同：0
> 
> 时间：2013-02-03T15:53:44.857
> 
> 标签：android

我在删除文件夹时遇到问题。

我制作了文件夹和文件夹。删除返回 false。为什么？

我也在下面试过这个。这将返回 false 并且文件夹不会被删除。为什么？

```
public static boolean deleteDirectory(File path) {
            if( path.exists() ) {
              File[] files = path.listFiles();
              if (files == null) {
                  return true;
              }
              for(int i=0; i<files.length; i++) {
                 if(files[i].isDirectory()) {
                   deleteDirectory(files[i]);
                 }
                 else {
                   files[i].delete();
                 }
              }
            }
            return( path.delete() );
          } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-23T04:12:07.610

受此解决方案的启发：

[Android删除目录不起作用](https://stackoverflow.com/questions/8362850/android-delete-directory-not-working)

我对它进行了如下改进，它对我有用：

```
private void deleteSubFolders(String uri)
{
     File currentFolder = new File(uri);        
     File files[] = currentFolder.listFiles();

     if (files == null) {
         return;
     }
     for (File f : files)
     {          
          if (f.isDirectory())
          {
              deleteSubFolders(f.toString());
          }
          //no else, or you'll never get rid of this folder!
          f.delete();
     }
} 
```

注意：请注意传递的文件夹名称。例如：

```
File folder = new File("path/to/directory"); 
```

folder.getName() 不一定等于完整路径目录名称。

# html - 如何创建一个简单的赞按钮？

> ID：14674296
> 
> 赞同：3
> 
> 时间：2013-02-03T15:54:38.307
> 
> 标签：html, web, button, widget

我需要一个简单的like 按钮。它必须允许访问者在不登录其社交网络帐户的情况下进行投票。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T22:00:46.193

[我从svbtle](https://svbtle.com/)重新创建了 Kudos 按钮作为独立的小部件。

[kudosplease.com](http://kudosplease.com)

## 什么是“荣誉”？

> 赢得荣誉就是赢得尊重和认可。一个没有依赖关系的单元素荣誉小部件。

[城市词典上的“荣誉”](http://www.urbandictionary.com/define.php?term=kudos)

## 如何使用它

### 1\. 将 CSS/JS 添加到您的页面

### 2.添加小部件HTML

```
<div class="kudos" 
     data-amount="0" 
     data-url="domain.tld/my-awesome-article"></div> 
```

### 3.通过JS初始化widget

```
new KudosPlease({ 
  el : '.kudos',
  duration : 1500,
  persistent : true,
  status : {
    alpha: 'fontelico-emo-shoot',
    beta: 'fontelico-emo-shoot',
    gamma: 'fontelico-emo-beer'
  }  
}); 
```

## 免费 API 或自己托管

特定 url 的点赞数量保存在我的后端，但你也可以在 GitHub 上下载：[https ://github.com/TimPietrusky/KudosPlease](https://github.com/TimPietrusky/KudosPlease)

## 例子

*   [荣誉请@CodePen](http://codepen.io/TimPietrusky/pen/acBCf)
*   [“告诉我们一些关于你的事情”@CodePen](http://codepen.io/TimPietrusky/pen/Kazcy)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-06-04T05:31:57.603

I recreated a Medium-style applause button:

[http://applause-button.com/](http://applause-button.com/)

The button persists claps to a hosted back-end service, so no need to spin up your own database. Adding it is as simple as follows:

```
<head>
  <!-- add the button style & script -->
  <link rel="stylesheet" href="dist/applause-button.css" />
  <script src="dist/applause-button.js"></script>
</head>
<body>
  <!-- add the button! -->
  <applause-button style="width: 58px; height: 58px;"/>
</body> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T16:05:42.090

您可以将“喜欢”存储在自己的数据库中。只需有一个点击服务器并更新数据库表中的计数的“喜欢”链接。当然，这需要数据库和服务器端语言（PHP、Ruby、Python 等）。

[https://svbtle.com/](https://svbtle.com/)博客网络有一个很酷的小“Kudos”按钮，当您将鼠标悬停在 Kudos 按钮上时，它会匿名喜欢。 [http://howtomakelightning.com/365/](http://howtomakelightning.com/365/)

不过，我不确定您将如何在静态网站上执行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-21T09:24:45.077

不能简单地创建一个赞按钮：D 您的按钮将在某处（通常是数据库）存储“赞”，根据定义，这是一个动态过程并找到一种方法来处理一些安全和用户体验问题。

如果你使用 React 我创建了这个服务[https://lyket.dev/](https://lyket.dev/)，它会处理一切。

# regex - NotePad++ 的正则表达式 - 否定字符串

> ID：14674300
> 
> 赞同：1
> 
> 时间：2013-02-03T15:54:55.583
> 
> 标签：regex, notepad++

我在一个 HTML 块中有一系列段落。大多数都是带有一些超链接标签的文本。有时，一个段落后面跟着一个仅包含图像的段落。所以：

```
<p1>...text..<a>...</a>...text...</p>
<p2>...text..<a>...</a>...text...</p>
<p3><img></p>
<p4>...text..<a>...</a>...text...</p> 
```

我正在尝试在 NotePad++ 中找到一个用于查找/替换的正则表达式，它将匹配一个段落，该段落后跟一个包含图像的段落（我想将它们包装在标签中）。

这似乎正确匹配单个段落，仅此而已：

```
<p(?!.*<p)?(.*?)</p> 
```

但是，一旦我尝试添加与以下图像段落匹配的任何内容，正则表达式就会开始向后匹配以包含图像段落之前的每个段落（即从 p1 到 p3，而不是从 p2 到 p3）。

该解决方案需要包含与换行符匹配的点字符（无论如何，我认为。段落文本中有回车）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T17:18:48.313

要匹配包含`img`标签的段落之前的段落，您可以使用

```
<p((?!</p>).)*</p>(?=\s*<p(.(?!</p>))*<img.*?</p>) 
```

应该检查`Regular expression`and选项。`. matches newline`

请注意，如果有嵌套标签，这可能不起作用`<p>`，并且假设段落之间只有空格，其中可能包括换行符。

如果您希望带有`img`标签的段落包含在选择中，请使用

```
<p((?!</p>).)*</p>\s*<p(.(?!</p>))*<img.*?</p> 
```

# ruby-on-rails - 如何获得相关结果的唯一列表？

> ID：14674310
> 
> 赞同：0
> 
> 时间：2013-02-03T15:55:44.983
> 
> 标签：ruby-on-rails, search

我想搜索一个产品，并从搜索结果中获取所有产品的所有类别，以创建一个过滤器界面，如 github（侧边栏中的“语言”菜单）。

```
@products = Product.product_search(params[:q])
@categories = ? 
```

我想列出 @products 数组中产品的所有类别。

知道什么是最好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:05:49.937

我认为这应该可以解决问题。

```
@categories = @products.map(&:category).compact.uniq 
```

# php - Yii + PDO_DBLIB + SQL Server

> ID：14674316
> 
> 赞同：0
> 
> 时间：2013-02-03T15:56:07.480
> 
> 标签：php, sql-server, sql-server-2008, yii, freetds

我的网站基于 yii 框架，我使用 pdo_dblib + freetds 在 linux 下使用 SQL Server（在 Windows 上）。

**我的 FreeTDS 配置：**

```
[egServer70]
        host = my server ip address
        port = 1433
        tds version = 8.0
        client charset = UTF-8 
```

连接很好。网站使用UTF-8，使用SQL Servercolumns`nvarchar, ntext`等类型。

当我将一些西里尔文字插入数据库时​​，它会像这样插入“??????????????????????”。

用英文文本插入很好。

当我选择已经有西里尔文字的数据时，它显示正常。

所以只有当我尝试`INSERT`西里尔文字时才会出现问题。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:11:12.330

尝试以下

```
INSERT INTO Sentences (LangText) VALUES (N'Поиск') 
```

（注意常量上的“N”限定符）

有关其他信息，请阅读[此处](http://www.dbforums.com/microsoft-sql-server/1629581-inserting-retrieving-cyrillic-characters.html)

# c++ - 如何告诉 XCode 调试器只在断点处停止？（并非例外）

> ID：14674317
> 
> 赞同：3
> 
> 时间：2013-02-03T15:56:09.270
> 
> 标签：c++, c, xcode, macos

我正在为一个闭源应用程序编写第 3 方插件。我遇到了 XCode 调试器的问题。

我想使用调试器来单步调试我正在编写的插件的代码。为此，我在代码中设置了断点，启动了宿主应用程序，然后将 XCode 调试器附加到宿主应用程序的进程。我的问题是，调试器不是在断点处停止，而是在程序的另一部分引发的异常处停止。（具体来说，这个`Thread 2: EXC_ARITHMETIC (code=EXC_i386_DIV, subcode=0x0)`：）

这个异常经常被抛出，以至于它实际上使我无法单步执行我真正感兴趣的代码。

我无法捕捉和处理这个异常，因为我没有抛出它的应用程序部分的源代码。

在这种情况下，谁能建议我如何调试我的代码？有什么方法可以告诉 XCode 调试器简单地“忽略”这个特定的`EXC_ARITHMETIC`异常，而是只在我明确设置的断点处停止？

*更新*

@user1118321 建议使用断点窗格关闭异常断点。我尝试使用此处显示的设置来执行此操作。

![在此处输入图像描述](../Images/ec6a0ad77b94a6e2931331d1c67ed9bf.png)

我认为选择“评估后自动继续”可能会阻止调试器停止。它没有。

我也尝试`cont`在停止后向调试器发出。这似乎也不起作用。

![在此处输入图像描述](../Images/a2bd33830da92bb7e6cb732f1bfd4d7a.png)

谁能告诉我我应该在此处输入哪些设置以防止调试器因我的`EXC_ARITHMETIC`异常而停止？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T18:51:10.087

这是一个整数“除以零”错误异常。据我所知，它们不会作为 C++ 异常传播，这就是为什么你不能不打破它们的原因。

即使您的插件未加载，也会发生这种情况吗？如果没有，您的插件会以某种方式导致除以零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T12:02:36.377

我按照@user1118321 建议的链接进行操作。经过几个小时的挠头，我无法弄清楚如何关闭或处理整数除以零异常。如果有人有任何想法，我很乐意听到。

不过，我确实找到了一种解决方法，即使用 GDB 而不是 XCode。与 XCode 不同，GDB 似乎并没有停止，而是`EXC_ARITHMETIC`让我进入我的代码。所以，我暂时将切换到 GDB 进行调试。

*编辑*

就我而言，第二个（更好的）解决方法涉及暂停引发异常的线程。这也让我可以单步执行我的插件代码。

# c# - 小型 C# 桌面应用程序的数据库引擎替代方案

> ID：14674320
> 
> 赞同：0
> 
> 时间：2013-02-03T15:56:23.917
> 
> 标签：c#, .net, database

我必须开发一个迷你应用程序，但需要创建数据库，我不想使用 sql、access 或 oracle，因为我只需要 4 个表数据。数据库存储的最佳选择是什么？桌面应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:05:19.323

如果您不需要 SP 并且您只需要关系数据（并且不处理安装和依赖开销），那么您只需参考 SQL Server CE。

它是一个嵌入式数据库，如果您运行 C#，则意味着框架已经存在，可能还有 SQL Server CE，否则安装非常轻量级，可以包含在您的安装程序中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T15:59:36.030

Mongo db 是一个非常轻量级、非常简单的 no-sql 数据库，它很容易学习和使用。它确实需要一个实例运行，我没有检查你是否可以将它嵌入到你的应用程序中，但如果可能的话，我不会感到惊讶。

一探究竟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T16:25:52.560

如果您需要关系和查询，请使用 Sqlite，如果不需要，请使用 ESENT。

# facebook - 未能发布到时间轴。错误：{"message":"调用非对象上的成员函数 getImageInfo()","type":"BadMethodCallException"}

> ID：14674323
> 
> 赞同：0
> 
> 时间：2013-02-03T15:57:19.513
> 
> 标签：facebook, wordpress

从最近几天开始，我在 Wordpress 上添加新帖子时遇到此错误，并且 Facebook 插件无法将其发布到 Facebook 页面上。

> 发布到时间线失败：
> 
> 错误：{"message":"调用非对象上的成员函数 getImageInfo()","type":"BadMethodCallException"}

现在升级 Facebook 插件 1.2.1 后，我收到一个新错误

未能发布到您的 Facebook 时间线。错误：{"message":"只能修改此应用程序拥有的连接","type":"Exception"}

# javascript - 为什么+“数字是”之前的x

> ID：14674327
> 
> 赞同：0
> 
> 时间：2013-02-03T15:57:30.547
> 
> 标签：javascript

```
<!DOCTYPE html>
<html>
<body>

<p>Click the button to loop through a block of code five times.</p>
<button onclick="myFunction()">Try it</button>
<p id="demo"></p>

<script>
function myFunction() {
  var x = "";
  for ( var i = 0; i < 5; i++ ) {
      x = x + "The number is " + i + "<br>";
  }
  document.getElementById("demo").innerHTML=x;
}
</script>

</body>
</html> 
```

我了解它返回的内容，但我不了解每个语句之前的 x。

```
x = x + "The number is " + i + "<br>"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T15:59:34.653

x 是一个将在循环中增长的变量。

该行：

```
x = x + "The number is " + i + <br> 
```

只需将“数字为” + i + 行尾这一行附加到 x 的当前值。

将此行视为：

```
var y = x + "The number is " + i + <br>
x = y 
```

在循环结束时，x 值得：

“数字是0
数字是1
数字是2
数字是3
数字是4
”

如果不是 x = ""，而是 x = "Hello,"，那么最终结果将是：

“你好，号码是0
号码是1
号码是2
号码是3
号码是4
”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T15:59:48.720

```
x = x + "The number is " + i + "<br>"; 
```

附加到指定文本的当前值并将其`x`存储回 x。

# .htaccess - .htaccess：RewriteCond 适用于 xy.com/?id=12，但不适用于 xy.com/index.php/?id=12

> ID：14674329
> 
> 赞同：1
> 
> 时间：2013-02-03T15:57:59.347
> 
> 标签：.htaccess, mod-rewrite

我正在尝试对查询字符串中某处具有给定 id 的页面进行密码保护。我的 .htaccess 看起来像这样：

```
RewriteEngine On
RewriteCond %{QUERY_STRING} id=12
RewriteRule (.*) $1 [E=protected_uri:1]

Order Deny,Allow

AuthName "Protected"
AuthType Basic
AuthUserFile /blabla/.htpasswd
AuthGroupFile /
Require valid-user

Order allow,deny
Allow from all
Deny from env=protected_uri
Satisfy any 
```

这适用于[http://xy.com/?id=12](http://xy.com/?id=12)，但不适用于[http://xy.com/index.php?id=12](http://xy.com/index.php?id=12)。对于第二个 URL，不需要密码。

我不知道为什么这行不通，因为 RewriteCond-Line 中的 id=12 应该与其中 id=12 的所有 URL 匹配？

谢谢你的帮助！本

# php - PHP/Javascript - 通过 POST 将日期字符串传递给 AJAX 不起作用

> ID：14674331
> 
> 赞同：1
> 
> 时间：2013-02-03T15:58:09.393
> 
> 标签：php, javascript, ajax

我正在创建一个将数据发布到 MySQL 的简单表单。你的想法为什么是 POST 而不是 GET？好吧，这种形式有一个描述字段，允许使用许多字符，并且鉴于 GET 有其字符限制，我选择使用 POST。

没有进一步的告别，这是我的 HTML 表单。

```
<form name="addExperienceForm" id="addExperienceForm" style="display:none;">
                    Title:<input type="text" name="title" id="title" />
                    From:<input type="text" name="startDate" id="startDate" />
                    To:<input type="text" name="endDate" id="endDate" />
                    Description:<textarea type="message" name="description" id="description"></textarea>
                    <input type="button" value="Submit" onclick="addUserExp()"/>
 </form> 
```

这是表单中日期框的 jQuery Datepicker 代码：

```
//allow a date range to be selected
        $("#startDate").datepicker({
                    changeMonth : true,
                    changeYear : true,
                    dateFormat : "M,yy",
        })
        $("#endDate").datepicker({
                    changeMonth : true,
                    changeYear : true, 
                    dateFormat : "M,yy",
        }) 
```

这是 AJAX 函数调用：

```
function addUserExp(){
        var title = document.getElementById('title').value;
        var startDate = document.getElementById('startDate').value;
        var endDate = document.getElementById('endDate').value;
        var description = document.getElementById('description').value;
        var str = "title="+title+"start="+startDate+"end="+endDate+"desc="+description;
        var req = getXMLHTTP();

        if(req){

            req.onreadystatechange = function(){
                if (req.readyState == 4) {
                    // only if "OK"
                    if (req.status == 200) {                        
                        document.getElementById('addNewExp').innerHTML=req.responseText;    

                    } else {
                        alert("There was a problem while using XMLHTTP:\n" + req.statusText);
                    }
                }
            }
        }
        req.open("post", "addExperience.php", true);
        req.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        req.send(str);
    } 
```

我怀疑问题出在 AJAX 调用中，可能与我的“str”变量有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:42:10.627

我没有测试你的代码，但不应该是：

```
 var str = "title="+title+"&start="+startDate+"&end="+endDate+"&desc="+description; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T14:43:23.460

经过无数小时的审查我的代码，我终于意识到我的 PHP 代码是问题所在。

前：

```
 <?php

$title = $_POST['title'];
$startDate = $_POST['startDate'];
$endDate = $_POST['endDate'];
$description = $_POST['desc'];

echo $title;
echo $startDate;
echo $endDate;
echo $description;

?> 
```

之后：

```
 <?php

$title = $_POST['title'];
$startDate = $_POST['start'];
$endDate = $_POST['end'];
$description = $_POST['desc'];

echo $title;
echo $startDate;
echo $endDate;
echo $description;

?> 
```

注意 $post 变量没有反映我的 JS 字符串。

感谢所有提供帮助的人。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-03T16:50:23.327

使用 jQuery 处理 AJAX 请求会容易得多：

```
function addUserExp(){
        var title = document.getElementById('title').value;
        var startDate = document.getElementById('startDate').value;
        var endDate = document.getElementById('endDate').value;
        var description = document.getElementById('description').value;
        $.post("addExperience.php", { "title": title, "start": startDate, "end": endDate, "desc":description })
        .done(function(data) {
            document.getElementById('addNewExp').innerHTML=data; 
        })
        .fail(function() { 
            alert("There was a problem with request."); 
        });         
    } 
```

[您可以在此处](http://api.jquery.com/jQuery.post/)阅读有关 $.post的更多信息。

# facebook - (Heroku/GIT) 添加到提交命令的注释未出现在活动中

> ID：14674342
> 
> 赞同：1
> 
> 时间：2013-02-03T15:59:27.283
> 
> 标签：facebook, git, heroku, commit

我和一个朋友正在为 facebook 创建一个应用程序。因此，为了保持井井有条，当我们做某事并将其推送到 heroku 时，我们会在提交命令中添加注释，例如：

```
git commit -am "changed logo" 
```

我们遇到的问题是，在 heroku 网站的活动日志中，我们收到如下消息：

```
v34 ************@gmail.com: Deploy ce43e3a less than a minute ago 
```

我们过去常常出现评论而不是“部署奇怪的代码”......我们能做些什么来让这种情况再次发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T18:22:14.277

一种方法是[自定义 Heroku Deploy hooks 之一的消息](https://devcenter.heroku.com/articles/deploy-hooks#customizing-messages)。
我记得两年多前在“ [Git email hook to include commit message and changed files](https://stackoverflow.com/questions/4406069/git-email-hook-to-include-commit-message-and-changed-files) ”中这样做了。

> 在定义任何部署挂钩属性的消息、标题或主题时，可以使用变量。

```
git_log 
```

> 本次部署与上次部署之间的提交日志

# excel - 使用公式将 Base 10 转换为 Base 36

> ID：14674345
> 
> 赞同：5
> 
> 时间：2013-02-03T15:59:35.130
> 
> 标签：excel, math

有没有一种简单的方法可以在 Excel 中将数字从 Base 10 转换为 Base 36？我有一个需要转换的 2,000 多个数字的列表，因此我无法在其中一个在线转换器中一一进行。

我在想，即使有一种数学方法，我也可以使用公式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-08-24T07:56:30.530

更好的解决方案是使用 BASE 函数

=Base（要转换的数字，base）

例如

=基础（35,36）= Z

=基础（36,36）= 10

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T16:10:10.227

看看这个：

[http://www.thetropicalevents.com/Xnumbers60/](http://www.thetropicalevents.com/Xnumbers60/)
[http://www.thetropicalevents.com/Xnumbers60.htm](http://www.thetropicalevents.com/Xnumbers60.htm)

[按Korem的要求添加了代码]

或者

```
Sub main()
    Dim base10Number As Double
    base10Number = Int(Rnd * 1000)
    Debug.Print base10Number, ConvertBase10(base10Number, "0123456789ABCDEF")
End Sub

Public Function ConvertBase10(ByVal d As Double, ByVal sNewBaseDigits As String) As String
    Dim S As String, tmp As Double, i As Integer, lastI As Integer
    Dim BaseSize As Integer
    BaseSize = Len(sNewBaseDigits)
    Do While Val(d) <> 0
        tmp = d
        i = 0
        Do While tmp >= BaseSize
            i = i + 1
            tmp = tmp / BaseSize
        Loop
        If i <> lastI - 1 And lastI <> 0 Then S = S & String(lastI - i - 1, Left(sNewBaseDigits, 1)) 'get the zero digits inside the number
        tmp = Int(tmp) 'truncate decimals
        S = S + Mid(sNewBaseDigits, tmp + 1, 1)
        d = d - tmp * (BaseSize ^ i)
        lastI = i
    Loop
    S = S & String(i, Left(sNewBaseDigits, 1)) 'get the zero digits at the end of the number
    ConvertBase10 = S
End Function 
```

复制自[http://www.freevbcode.com/ShowCode.asp?ID=6604](http://www.freevbcode.com/ShowCode.asp?ID=6604)

或类似的......

```
=ConvertBase10(A1,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ")

Sub main()
     Dim MyNumber As Double
     MyNumber = 999999999999999#
     MsgBox MyNumber & ": " & ConvertBase10(MyNumber, "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ")
End Sub

Public Function ConvertBase10(ByVal d As Double, ByVal sNewBaseDigits As String) As String
     Dim S As String, tmp As Double, i As Integer, lastI As Integer
     Dim BaseSize As Integer
     BaseSize = Len(sNewBaseDigits)
     Do While Val(d) <> 0
         tmp = d
         i = 0
         Do While tmp >= BaseSize
             i = i + 1
             tmp = tmp / BaseSize
         Loop
         If i <> lastI - 1 And lastI <> 0 Then S = S & String(lastI - i - 1, Left(sNewBaseDigits, 1)) 'get the zero digits inside the number
         tmp = Int(tmp) 'truncate decimals
         S = S + Mid(sNewBaseDigits, tmp + 1, 1)
         d = d - tmp * (BaseSize ^ i)
         lastI = i
     Loop
     S = S & String(i, Left(sNewBaseDigits, 1)) 'get the zero digits at the end of the number
     ConvertBase10 = S
End Function 
```

复制自：[https ://groups.google.com/forum/?fromgroups=#!topic/microsoft.public.excel.worksheet.functions/yY7U_kX_FwU](https://groups.google.com/forum/?fromgroups=#!topic/microsoft.public.excel.worksheet.functions/yY7U_kX_FwU)

# javascript - 为什么 preventDefault 不起作用？

> ID：14674349
> 
> 赞同：5
> 
> 时间：2013-02-03T15:59:54.063
> 
> 标签：javascript, jquery, droppable

这是我的代码的一部分。如果我尝试将图像放在块上，则 preventDefault 不起作用。

```
 jQuery(document).ready(function($) {
            $.event.props.push('dataTransfer');
            $('#imgDropzone').on({
                dragenter: function(e) {
                    $(this).css('background-color', '#ffd1ff');
                },
                dragleave: function(e) {
                    $(this).css('background-color', '');
                },
                drop: function(e) {
                    e.stopPropagation();
                    e.preventDefault();

                    var file = e.dataTransfer.files[0];
                    var fileReader = new FileReader();
                    var el = $(this);
                    fileReader.onload = (function(file) {
                        return function(event) {
                            alert(event.target.result);
                        };
                    })(file);
                    fileReader.readAsDataURL(file);
                }
            });
        }); 
```

[http://jsfiddle.net/LrmDw/](http://jsfiddle.net/LrmDw/)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-03T16:03:12.200

您还需要^*来防止所有其他拖动事件的默认设置：

见[http://jsfiddle.net/LrmDw/2/](http://jsfiddle.net/LrmDw/2/)

```
$('#imgDropzone').on("dragenter dragstart dragend dragleave dragover drag drop", function (e) {
    e.preventDefault();
}); 
```

要解释原始 jsfiddle 中不起作用的内容：

当您将文件拖放到放置区域（或页面中的任何位置）时，浏览器的默认行为是导航离开并尝试解释该文件。例如，如果你删除一个普通的 txt 文件，浏览器将离开 jsfiddle 并显示 txt 文件的内容。这是在 Chrome 中。

* * *

顺便说一句，base64 url​​ 不是可取的，因为它们重复数据。只需抓住一个指向文件的 blob 指针并使用它：

```
var file = e.dataTransfer.files[0];
var src = (window.URL || window.webkitURL).createObjectURL(file);
$("<img>", {src: src}).appendTo("body"); 
```

看

[http://jsfiddle.net/LrmDw/3/](http://jsfiddle.net/LrmDw/3/)

^(我不知道到底是哪一个，但我从来不用关心)

# c# - List.AddRange 是否调用 List.Add？

> ID：14674356
> 
> 赞同：5
> 
> 时间：2013-02-03T16:01:19.073
> 
> 标签：c#, .net, list

我有一个从 List 派生的自定义类，它带有一个 Add 方法，该方法仅在满足特定条件时才添加。

我是否还需要覆盖* AddRange，或者 AddRange 是否只是在给定范围的每个元素上调用 Add？

*：是的，在 C# 的上下文`new`中*隐藏*而不是覆盖。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-03T16:03:22.077

如果要创建自定义集合。不要`List<T>`从[`Collection<T>`](http://msdn.microsoft.com/en-us/library/ms132397.aspx)或直接实现`IList<T>`or派生它`ICollection<T>`。事实上，类中的`Add`方法`List<T>`不是虚拟的。

注意：`List<T>.AddRange`使用`Array.Copy`.

### 更新

继承 Collection 时，您只需覆盖 2 个方法！

```
public class MyCollection : Collection<string>
{
    private bool IsValidItem(string item)
    {
        return; // Your condition : true if valid; false, otherwise.
    }

    // This method will be called when you call MyCollection.Add or MyCollection.Insert
    protected override void InsertItem(int index, string item)
    {
        if(IsValidItem(item))
            base.InsertItem(index, item);
    }

    // This method will be called when you call MyCollection[index] = newItem
    protected override void SetItem(int index, string item)
    {
        if(IsValidItem(item))
            base.SetItem(index, item);
    }
} 
```

如果您要验证的项目没有在上面的代码中`string`替换`string`为正确的类型。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-03T16:17:20.133

不要使用改变方法语义的隐藏。这真是糟糕的设计。

创建一个实现`IList<T>`. 最简单的方法是继承自`Collection<T>`. `Collection<T>`以方法的形式实现`IList<T>`并具有四个扩展点`protected virtual`：

```
InsertItem
SetItem
RemoveItem
ClearItems 
```

由于您只需要验证添加的项目而不是删除的项目，因此您只需覆盖`InsertItem`和`SetItem`.

```
class MyCollection:Collection<T>
{
    private void ValidateItem(T item)
    {
       if(item is invalid)
         throw new ArgumentException("Item is invalid");
    }

    protected override InsertItem(int index, T item)
    {
        ValidateItem(item);
        base.InsertItem(index, item);
    }

    protected override SetItem(int index, T item)
    {
        ValidateItem(item);
        base.SetItem(index, item);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-03T16:10:33.313

如果您需要一个行为与 a 完全相同的集合`List<T>`，除了仅添加有效对象之外，我不会创建自定义集合。

只要清楚扩展程序在做什么，请改用**扩展程序**并调用它们`AddIfValid(T value)`或您喜欢的任何名称。`AddRangeIfValid(IEnumerable<T>)`

这是一个例子：

```
public static void AddIfValid(this List<T> list, T value)
{
    if (/* check if value is valid here */)
        list.Add(value);
} 
```

一旦你定义了你的扩展，像这样使用它：

```
myList.AddIfValid(myValue); 
```

# jquery - jQuery 回调函数与 for 循环同步

> ID：14674357
> 
> 赞同：0
> 
> 时间：2013-02-03T16:01:19.647
> 
> 标签：jquery, callback, closures

我正在尝试完成以下任务：

1) for 循环遍历产品列表，在每个产品上调用 requestCrossDomain() 函数。

2) 函数 requestCrossDomain() 会将检索到的每个产品的 3 组属性/描述传递回 requestCross Domain() 函数。

3）requestCrossDomain()函数完成后，使用闭环函数遍历属性/描述结果，创建3个数组。重要的是要知道这个函数一次只能在一个产品上工作，这意味着如果 for 循环在 product[0] 处，那么回调函数也应该在 product[0] 的属性/描述集上工作。

4) 使用 if() 语句查找匹配集，并返回数组/对象的索引位置。

我坚持使用 3），循环关闭似乎没有在 console.log 中返回任何内容。

```
//step 1)
for (i=0; i<product.length; i++){
   ....       
   requestCrossDomain(arg[i], function(i) {   //step 3)
                                              //need to hold the i value 
      return function() {                     //so the return function() is working on 
         var array = [];                      //the matching product[i]
         $('h4').each(function(j) { 
            array[j] = [];
            var $this = $(this);
            array[i][j] = {
               Attribute: $this.text(),
               Description: $this.next('p').text()
            };

            //step 4)
            if($this.text() == "Attr" && $this.next('p').text() == "Desc") {  
                console.log(i + "-" +j);  //nothing return, no error message
            };
         });          
      }; 

   }(i));
}

//step 2)
function requestCrossDomain(arg, callback) {
   ....
   // 3 sets of attribute/description are constructed here, the html will look like:
   // <div>
   //   <h4>Attribute</h4>
   //   <p>Description</p>
   //   <h4>Attr</h4>
   //   <p>Desc</p>
   //   <h4>A</h4>
   //   <p>D</p>
   // </div>    
   ....
   callback();
} 
```

我猜我没有完全理解 for 循环的回调函数。我的头已经旋转了几个小时，有人可以发光吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T17:12:26.683

我相信你的数组没有正确初始化。首先，你的意思是把

```
array[i] = []; //instead of array[j] right after $('h4').each(function(j) { 
```

? 因为它使您的代码更有意义。如果你改变它然后添加

```
array[i][j] = []; 
```

作为下一行，我相信你应该很高兴。让我知道。

另外，尝试放置 console.log("Step X"); 您在任何地方都评论了一个步骤以确保达到 tat 步骤，并查看是否所有步骤都已达到/哪个步骤中断。

# c++ - 构建用于编译 boost 的 Openssl 源

> ID：14674360
> 
> 赞同：2
> 
> 时间：2013-02-03T16:01:53.030
> 
> 标签：c++, boost, openssl, fedora

笔记。我已经看到并阅读了 [Boost::asio::ssl OpenSSL not compile](https://stackoverflow.com/questions/12021525/boostasiossl-openssl-not-compiling)

[源文件](http://www.boost.org/doc/libs/1_46_1/doc/html/boost_asio/example/ssl/server.cpp)

我在 linux fedora 64 上构建 boost 示例 ssl 服务器时遇到了一些问题，我认为它的版本是 15 或 16。它是一台大学机器，所以我们没有 root 访问权限，因为周末我通过 SSH 访问机器。我们没有root，也没有安装openssl。我没有构建boost库，示例服务器构建良好。然后我尝试`openssl`从源代码构建最新的库。我提取到`~/Dev/opensslSource`

```
Cd ~/Dev/opensslSource
 ./config --prefix=~/Dev/openssl --openssldir=~/Dev/openssl
Make
Make install 
```

现在问题存在于那里或我如何包含和链接。所以然后在我的 boostexamples 文件夹中，我确实保存了示例[sslserver.cpp](http://www.boost.org/doc/libs/1_46_1/doc/html/boost_asio/example/ssl/server.cpp) 并使用以下内容进行构建。

```
g++ -I ~/Dev/boost_1_52_0/ -I ~/Dev/openssl/include -L ~/Dev/boost_1_52_0/stage/lib -L ~/Dev/openssl server.cpp -o server -lboost_system -lssl –lpthread 
```

错误几乎是无穷无尽的。我什至都看不到他们。但我相信它们都只是不明确的参考。

```
d1_enc.c:(.text+0x10c): undefined reference to `EVP_MD_size'
d1_enc.c:(.text+0x12f): undefined reference to `EVP_CIPHER_CTX_cipher'
d1_enc.c:(.text+0x155): undefined reference to `EVP_CIPHER_block_size'
d1_enc.c:(.text+0x1b2): undefined reference to `EVP_Cipher'
d1_enc.c:(.text+0x2cf): undefined reference to `EVP_Cipher'
d1_enc.c:(.text+0x34b): undefined reference to `EVP_CIPHER_block_size'
d1_enc.c:(.text+0x363): undefined reference to `EVP_CIPHER_block_size'
d1_enc.c:(.text+0x375): undefined reference to `RAND_bytes' 
```

因此，在前几条评论之后，我将构建更改为。

```
g++ -I ~/Dev/boost_1_52_0/ -I ~/Dev/openssl/include -L ~/Dev/boost_1_52_0/stage/lib –L ~/Dev/openssl/lib server.cpp -o server -lboost_system -lssl -lcrypto -lpthread 
```

现在出错。

```
/home/andrew/Dev/openssl/lib/libcrypto.a(dso_dlfcn.o): In function `dlfcn_globallookup':
dso_dlfcn.c:(.text+0x1d): undefined reference to `dlopen'
dso_dlfcn.c:(.text+0x33): undefined reference to `dlsym'
dso_dlfcn.c:(.text+0x3d): undefined reference to `dlclose'
/home/andrew/Dev/openssl/lib/libcrypto.a(dso_dlfcn.o): In function `dlfcn_bind_func':
dso_dlfcn.c:(.text+0x381): undefined reference to `dlsym'
dso_dlfcn.c:(.text+0x460): undefined reference to `dlerror'
/home/andrew/Dev/openssl/lib/libcrypto.a(dso_dlfcn.o): In function `dlfcn_bind_var':
dso_dlfcn.c:(.text+0x4e1): undefined reference to `dlsym'
dso_dlfcn.c:(.text+0x5c0): undefined reference to `dlerror'
/home/andrew/Dev/openssl/lib/libcrypto.a(dso_dlfcn.o): In function `dlfcn_load':
dso_dlfcn.c:(.text+0x637): undefined reference to `dlopen'
dso_dlfcn.c:(.text+0x6ae): undefined reference to `dlclose'
dso_dlfcn.c:(.text+0x6e5): undefined reference to `dlerror'
/home/andrew/Dev/openssl/lib/libcrypto.a(dso_dlfcn.o): In function `dlfcn_pathbyaddr':
dso_dlfcn.c:(.text+0x781): undefined reference to `dladdr'
dso_dlfcn.c:(.text+0x7e9): undefined reference to `dlerror'
/home/andrew/Dev/openssl/lib/libcrypto.a(dso_dlfcn.o): In function `dlfcn_unload':
dso_dlfcn.c:(.text+0x84a): undefined reference to `dlclose'
collect2: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:30:09.527

您的链接选项中缺少一些库：libssl 依赖于 libcrypto，而后者又依赖于 libdl。总而言之，你需要

`-lboost_system -lssl -lcrypto -ldl -lpthread`.

# gwt - Tomcat 上的 GWT RPC 给出错误

> ID：14674361
> 
> 赞同：-1
> 
> 时间：2013-02-03T16:02:01.173
> 
> 标签：gwt

我正在尝试在 tomcat 上运行我的 GWT 应用程序，这个 GWT 应用程序在 ocalhose 上完美运行，在 tomcat 上运行良好，但仅适用于客户端，如果我尝试从 tomcat 调用 rpc 它会给出错误

这是附加的错误 ![在此处输入图像描述](../Images/e652068ea1d37af839cbd0a40209d4ae.png)

这是我的 web.xml 类 http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" version="2.5" xmlns="http://java.sun.com/xml/ns /javaee">

```
 <!-- Servlets -->

            <servlet>
          <servlet-name>DashBoardServlet</servlet-name>
       <servlet-class>com.dashboard.server.DashBoardServiceImpl</servlet-class>
      </servlet>

          <servlet-mapping>
          <servlet-name>DashBoardServlet</servlet-name>
            <url-pattern>/DashBoardServlet</url-pattern>
        </servlet-mapping>
        <!-- Default page to serve -->
       <welcome-file-list>
       <welcome-file>DashBoardSupervisor.html</welcome-file>
       </welcome-file-list>

       </web-app> 
```

这是RPC接口

```
 @RemoteServiceRelativePath("DashBoardServlet")
            public interface DashBoardService extends RemoteService {

ArrayList<FoundIntravue> fetchIntraVUE(String first, String second,  String choice);
String saveIntraVue(Intravue interVue, ArrayList<Networks> networksList) throws Exception;
String restoreDatabase(Date selectedDate) throws Exception; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:39:45.727

[`@RemoteServiceRelativePath`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/rpc/RemoteServiceRelativePath.html)的值与您的模块基本 URL 相关，因此您的 GWT 应用程序调用`.../dashboardsupervisor/DashBoardServlet`（这是来自您的屏幕截图），但您`web.xml`将 servlet 映射到`/DashBoardServlet`而不是`/dashboardsupervisor/DashBoardServlet`.

因为 没有任何东西`/dashboardsupervisor/DashBoardServlet`，所以 Tomcat 返回 404；案例制作。

# windows-phone-7 - 我的 Windows Phone 应用程序停止播放音乐

> ID：14674368
> 
> 赞同：0
> 
> 时间：2013-02-03T16:02:47.360
> 
> 标签：windows-phone-7, windows-phone-7.1

我的应用程序中有一个媒体元素。当用户单击“播放”按钮时它会播放。但是每当我的应用程序加载时，即使在我点击“播放”按钮之前，它也会停止播放音乐。

我想确保在单击“播放”按钮之前以及在完成播放我所拥有的声音 5 秒钟之后，仍在播放正在播放的音乐。或者至少在我点击播放按钮之前它不应该停止积极播放音乐。

```
 <MediaElement    Name="meBuzz"   Volume="1"  AutoPlay="False"    Source="/RingTones/SOUND1.mp3" /> 
```

c# 代码有以下代码来播放文件：

```
 meBuzz.Play() 
```

有什么建议么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:10:47.840

我不应该在 xaml 代码中设置源代码。

# ruby-on-rails-3 - 设计：在错误的令牌上覆盖输出到自定义 json

> ID：14674369
> 
> 赞同：1
> 
> 时间：2013-02-03T16:02:49.787
> 
> 标签：ruby-on-rails-3, devise

```
I want to show all models by request http://server/api/art/show.json?auth_token=correct_token
class ArticlesController < ApplicationController

  before_filter :authenticate_user!

  def show
    arts = Article.all
    render :json => {:state => {:code => 0}, :data => arts}
  end

  def new

  end
end 
```

如果令牌是正确的，那么我会收到数据并且没关系，但如果令牌不正确，我有：

{“电子邮件”：“”，“密码”：空}

```
In logs i see that it redirected me to http://server/users/sign_in.json 
```

为什么？？我可以在哪里覆盖这种行为？在这种情况下，我想显示自定义 json

PS我正在使用没有会话的令牌身份验证

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:26:30.413

自定义 failureApp 帮助了我。

class CustomFailureApp < Devise::FailureApp def respond if request.format json_failure else super end end

def json_failure self.status = 401 self.content_type = 'json' self.response_body = "{'state' : {'code' : 1, 'messages' = ['authentication error'] } }" // <- 这一行确实帮助我结束了

# c++ - 尝试链接 Boost 1.52 线程

> ID：14674374
> 
> 赞同：9
> 
> 时间：2013-02-03T16:03:15.747
> 
> 标签：c++, visual-c++, compiler-errors, boost-thread, visual-c++-2010

我正在尝试编译我的程序，但它根本不会链接。我已经指定了 boost lib 文件的路径，但链接器仍然抱怨。这是我得到的链接错误：

```
1>Edproj.obj : error LNK2001: unresolved external symbol "class boost::system::error_category const & __cdecl boost::system::system_category(void)" (?system_category@system@boost@@YAABVerror_category@12@XZ)
1>Edproj.obj : error LNK2001: unresolved external symbol "class boost::system::error_category const & __cdecl boost::system::generic_category(void)" (?generic_category@system@boost@@YAABVerror_category@12@XZ)
1>Edproj.obj : error LNK2001: unresolved external symbol "public: virtual __thiscall boost::detail::thread_data_base::~thread_data_base(void)" (??1thread_data_base@detail@boost@@UAE@XZ)
1>Edproj.obj : error LNK2001: unresolved external symbol "void __cdecl boost::throw_exception(class std::exception const &)" (?throw_exception@boost@@YAXABVexception@std@@@Z)
1>Edproj.obj : error LNK2001: unresolved external symbol "public: void __thiscall boost::thread::detach(void)" (?detach@thread@boost@@QAEXXZ)
1>Edproj.obj : error LNK2001: unresolved external symbol "public: void __thiscall boost::thread::join(void)" (?join@thread@boost@@QAEXXZ)
1>Edproj.obj : error LNK2001: unresolved external symbol "private: void __thiscall boost::thread::start_thread(void)" (?start_thread@thread@boost@@AAEXXZ)
1>Edproj.obj : error LNK2001: unresolved external symbol "bool __cdecl boost::this_thread::interruptible_wait(void *,struct boost::detail::timeout)" (?interruptible_wait@this_thread@boost@@YA_NPAXUtimeout@detail@2@@Z) 
```

BOOST_LIB_DIAGNOSTIC 返回

```
1>  Linking to lib file: libboost_thread-vc100-mt-s-1_52.lib
1>  Linking to lib file: libboost_date_time-vc100-mt-s-1_52.lib
1>  Linking to lib file: libboost_system-vc100-mt-s-1_52.lib
1>  Linking to lib file: libboost_chrono-vc100-mt-s-1_52.lib 
```

更多信息：

我正在运行 64 位 Windows 8 Pro，并使用以下选项编译了 boost

```
bjam --build-type=complete --toolset=msvc10.0 address-model=64 architecture=x86 variant=debug,release threading=multi link=static runtime-link=static 
```

有人可以告诉我有什么问题吗？

更新：

在更改为 boost 1.51 后，它消除了 8 个链接器错误中的 7 个，但这一个仍然存在

```
error LNK2001: unresolved external symbol "void __cdecl boost::throw_exception(class std::exception const &)" (?throw_exception@boost@@YAXABVexception@std@@@Z) 
```

我不明白这里发生了什么。这个来自 boostpro 32 位安装程序。它与我的源文件无关吗？

更新 ：

好的，我已经为 boost 1.51 解决了这个问题。结果在属性页 >> C/C++ >> 代码生成 >> 启用 C++ 异常对我来说是关闭的。

好的。我将尝试查看相同的设置是否可以解决 boost 1.52 的问题。稍后会更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-04-17T08:45:56.663

我之前也遇到过同样的问题：我使用默认参数构建 boost lib，直接运行**bootstrap.bat**。

如果您在项目中使用**boost::system**，则应使用并指定 x86 或 x64 版本的 boost::system 库。

您可以使用此 bat 重新编译 boost lib，将它们保存到 boost 根文件夹并在 CMD 窗口中运行（不要双击！）：

```
call "%VS140COMNTOOLS%..\..\VC\vcvarsall.bat" x86

cd boost_1_60_0
call bootstrap.bat

rem Most libraries can be static libs
b2 -j8 toolset=msvc-14.0 address-model=64 architecture=x86 link=static threading=multi runtime-link=shared --build-type=minimal stage --stagedir=stage/x64
b2 -j8 toolset=msvc-14.0 address-model=32 architecture=x86 link=static threading=multi runtime-link=shared --build-type=minimal stage --stagedir=stage/win32

pause 
```

有关更多详细信息，您可以查看这篇文章： [https ://studiofreya.com/2015/12/19/how-to-build-boost-1-60-with-visual-studio-2015/](https://studiofreya.com/2015/12/19/how-to-build-boost-1-60-with-visual-studio-2015/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:41:59.443

谢谢在我看来它没有正确的自动链接。

```
Include path is boost152/ only
Library path is boost152/stage/lib 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-07T03:03:07.227

下面这两个定义弄乱了我的链接器，抛出了一个漂亮的“LNK2001：未解析的外部符号”错误。那么你的代码中有什么地方吗？

```
//#define BOOST_FILESYSTEM_NO_DEPRECATED
//#define BOOST_FILESYSTEM_NO_LIB 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T17:34:31.630

确保将正确的目录添加到链接器属性中。

阅读这篇文章以了解更多详细信息 [Boost 链接器错误：未解决的外部符号“class boost::system::error_category const & __cdecl boost::system::get_system_category(void)”](https://stackoverflow.com/questions/1066071/boost-linker-error-unresolved-external-symbol-class-boostsystemerror-categ)

您还必须将此路径添加到链接器添加目录中：

$(BOOST_ROOT)\bin.v2\libs\thread\build\msvc-xx.0\release\address-model-64\link-static\threading-multi

其中 xx 是您的视觉工作室版本

# php - 生成随机且唯一的字符串

> ID：14674376
> 
> 赞同：5
> 
> 时间：2013-02-03T16:03:24.323
> 
> 标签：php, unique

我需要一种有效的方法来获取*随机*和**唯一的**字符串，重复的机会为零（或可忽略不计）。

我需要`[0-9A-z]`范围内的字符。

这是我到目前为止所拥有的：

```
substr(sha1(mt_rand().uniqid()),0,22); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-03T16:10:12.080

# 最近对 PHP 的更改

因为我知道这实际上是在谈论 bcrypt 和密码加盐，所以我现在真的可以将阅读本文的人指向他们应该使用的功能，而不是手动滚动他们自己的加盐系统。

用于`password_hash($input, PASSWORD_DEFAULT);`生成适合插入数据库的散列。这将为您取盐。

插入：

```
$hash = password_hash($_POST["password"], PASSWORD_DEFAULT, ["cost" => 16]);
DB::table("users")->insert(["username" => $user, "password" => $hash]);
// or whatever database method you use to insert data 
```

确认：

```
$hash = DB::table("users")->fetchByName($username)->select("password");
$input = $_POST["password"];

$verified = password_verify($input, $hash); // true if the password matches 
```

在 PHP 5.5 之前的版本中，使用[https://github.com/ircmaxell/password_compat](https://github.com/ircmaxell/password_compat)作为插件¹

* * *

当随机生成盐时，碰撞的几率是

```
1 / [number of possible letters/numbers] ** [length] 
```

对于 22 个字符的字符串来说，这不可能低（好吧，不是*不可能*，但***可以忽略不计***）

```
1 / (22 ** 60) = 1 / (3.51043 x 10**80) 
```

看？***微小的***。

* * *

# 数学谬误

如果您需要一个真正随机的字符串（注意：这些字符串只是映射到字母的一行数字），那么您就有点不走运了。
您正在寻找的是 CSPRNG（加密安全伪随机数生成器）。不需要唯一性。

正如***@Guarav***在他的回答中指出的那样，您可以使用时间戳作为种子，然后对其进行哈希处理。这称为 UUID（唯一通用标识符，如果它是 128 位时间戳）是可预测的，并且由于多种原因可能会很糟糕：

1.  您获取此时间戳的准确性成为该盐的可预测性的决定因素。
2.  如果您将时间（以秒为单位）作为整数并对其进行哈希处理，那么您最终会得到非常明确且容易猜到的盐

尽管如此，只要有足够的准确性，您仍然可以使用时间戳作为*唯一*盐。不是*随机*的（除非您将其用作随机种子并将其基本转换为 base10，这仍然是一个坏主意）。如果您可以在纳秒以下计算时间并喜欢将其用作唯一 ID，请考虑这一点。PHP 无法以足够快的速度处理以提供两个冲突的亚纳秒 ID ¹（但这并不意味着您不应该验证！）

* * *

^(1：它适用于作曲家！)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-03T16:13:36.203

这就是我有时正在做的方式......

```
// chars
$chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()-+';

// convert to array
$arr = str_split($chars, 1);

// shuffle the array
shuffle($arr);

// array to chars with 22 chars
echo substr(implode('', $arr), 0, 22); 
```

输出

```
xd*thKM$B#13^)9!QkD@gU

ixXYL0GEHRf+SNn#gcJIq-

$0LruRlgpjv1XS8xZq)hwY

$G-MKXf@rI3hFwT4l9)j0u 
```

为了确保它是唯一的，您可以随时检查您的数据库。如果重复，则重新生成 KEY。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-03T16:10:15.667

你可以检查我自己的问题的答案。 [如何使用实际订单 ID 生成唯一订单 ID（仅向用户展示）？](https://stackoverflow.com/questions/5387755/how-to-generate-unique-order-id-just-to-show-touser-with-actual-order-id)

您可以使用**TimeStamp**代替任何随机字符串。

关于您的解决方案，有可能发生碰撞，但水平很低。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-03T16:18:10.800

您不能保证这将始终返回一个唯一值，但它会显着降低风险。当您使用随机数生成算法时，总是有重复的可能性。

为了保证只生成唯一值，您可以搜索以前生成的值并丢弃重复项。

一些减少公式中重复机会的建议：

*   不要使用`sha1`. 这是一种为任何给定输入返回一个一致输出的方法。它不会影响重复的可能性。
*   而不是`sha1`，请考虑将随机数转换为不同的基数（例如，以 36 为基数的数字可以使用字符 0-9 和 AZ，您可以将其存储在数据库中或您对随机字符串输出所做的任何事情） . 但是我真的不会在这里选择36，也许是256+？
*   由于您将字符串限制为 22 个字符，`substr`因此实际上增加了重复的机会。使用我在上一个项目符号中所写的内容将随机数转换为不需要截断的少于 22 个字符的字符串。
*   `substr`此外，您可以通过使用该函数返回一个**原始**值来消除对的需求`sha1`，该值只有 20 个字符。
*   或者，只是不要将字符串限制为 22 个字符（除非您出于某种原因确实需要）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-03-12T08:39:02.217

为什么不直接使用该`time()`功能。

我需要做类似的事情，一个保持唯一 id 的解决方案，我最终得到了一个使用 PHP 函数的解决方案，`time()`你`$reference_number = 'BFF-' . time();`可以将 BFF 更改为对你的业务逻辑更有意义的东西。这样我就不必担心是否正在生成的新 id 之前被占用，因为时间总是唯一的

我希望这有帮助

# iphone - getCurrentDate getCurrentTime - 构造嵌入日期和时间信息的文件名

> ID：14674377
> 
> 赞同：0
> 
> 时间：2013-02-03T16:03:25.857
> 
> 标签：iphone

我正在尝试将日期和时间附加到我的文件名，但我想修改字符串构造中的默认返回值：

```
[controller addAttachmentData: logData mimeType:@"text/plain" fileName: [NSString stringWithFormat: @"FlightLog%@%@", [self getCurrentDate], [self getCurrentTime]]]; 
```

最终我的文件名应该是： FlightLog020220130901.txt 理想情况下我想要 mmddyyyyhhmm （其中 hhmm 是 24 小时时钟格式）

目前，上面的代码正在创建一个文件名，如：

> FlightLog2_2_2013 2:23 PM.txt

我对文件名中的冒号感到紧张，我不喜欢下划线。任何提示或建议来实现这一点将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:15:58.787

您在问如何将日期格式化为字符串？

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init]; 
NSLocale *enUSPOSIXLocale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"];
[dateFormatter setLocale:enUSPOSIXLocale];
[dateFormatter setTimeZone:[NSTimeZone systemTimeZone]];
[dateFormatter setDateFormat:@"MMddyyyyHHmmss"];
NSString *fileDate = [dateFormatter stringFromDate:[NSDate date]]; 
[dateFormatter release];
[enUSPOSIXLocale release];   

[controller addAttachmentData: logData mimeType:@"text/plain" fileName: [NSString stringWithFormat: @"FlightLog%@", fileDate]]; 
```

# ruby-on-rails - 如何在 Ruby on Rails 中构建语言环境切换器？

> ID：14674378
> 
> 赞同：0
> 
> 时间：2013-02-03T16:03:30.993
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, localization, ruby-on-rails-3.2

我正在尝试在 Rails 中构建一个语言环境切换器。我有很多语言要支持，所以我试图为此目的使用一个选择框。

```
# application.html.erb

<%= form_tag people_path, :class => 'locale' do %>
  <%= select_tag 'set_locale', options_for_select(LANGUAGES, I18n.locale.to_s), :onchange => 'this.form.submit()' %>
<% end %>

# application_controller.rb

before_filter :set_i18n_locale_from_params

def set_i18n_locale_from_params
  if params[:locale]
    if I18n.available_locales.include?(params[:locale].to_sym)
      I18n.locale = params[:locale] || "de"
    else
      flash.now[:notice] = "#{params[:locale]} translation not available"
      logger.error flash.now[:notice]
    end
  end
end

def default_url_options
  { :locale => I18n.locale }
end 
```

现在的问题是，当我从选择框中选择一种语言时，我`create`内部的操作`people_controller.rb`由于某种原因被触发。

`form_tag`为了获得在整个站点中都可以使用的语言环境切换器，我必须采取什么措施？

谢谢你的帮助。

```
class LocalesController < ApplicationController

  def change_locale
    if params[:set_locale]
      redirect_to people_path(:locale => params[:set_locale])
    end
  end

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:11:10.723

如果您只希望它发生在人物索引页面上，请尝试将其添加`:method => :get`到您的`form_tag`. 如果您需要在整个应用程序中支持多个不同页面上的区域设置，我将创建一个新控制器来切换区域设置 ( `LocalesController`)，该控制器在会话中设置区域设置并重定向回上一页。这样您就可以在整个应用程序中检查它。

# sql - 基础数据库设计

> ID：14674380
> 
> 赞同：0
> 
> 时间：2013-02-03T16:03:45.590
> 
> 标签：sql, database

我正在用 php 和 SQL 做一个小项目，以便让我的脚湿透数据库。我没有接受过任何正式的数据库培训，我只是对 SQL 有一定的了解。

我计划跟踪对象表中的对象和属性表中的属性。假设有 100 个属性，但将来可能会扩展。这两个表都只需要两列。

天真地，我会在表中记录哪些对象具有哪些属性，其列是属性 ID，行是对象 ID。这些条目将只是布尔值“真/假/空”，具体取决于对象是否已知具有或缺少该属性。每当添加一个新对象时，都需要添加一行及其 100 列。添加新属性时，必须为每个对象添加一列和一行。

但是，我之前读过，如果您担心有多少列，那么您有一个设计问题。一位朋友向我推荐了一张备用桌子。它将包含三列，一个条目将仅包含对象 ID、属性 ID 和相应的布尔值。在这个方案中，添加一个新对象需要向该表添加 100 个新行。

有人可以澄清这两种设计中哪一种更好，为什么？由于某种原因，拥有很多列是否比拥有很多行更成问题？

如果这是一个重复的问题，我完全不会感到惊讶，在这种情况下，我感谢您帮助我指出正确的问题。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:09:30.977

这似乎是一种`Many-to-Many`关系，因为一个对象可以有许多属性，同时属性属于许多对象。（*对吗？我希望如此*）我建议的数据库架构是

表对象

*   对象 ID (PK)
*   对象名（唯一）

表属性

*   属性 ID (PK)
*   属性名称（唯一）

Table Object_Property（这是一个*映射*表）

*   对象 ID (FK)
*   物业 ID (FK)

示例记录和查询，

*   [SQLFiddle 演示（*点击这里*）](http://www.sqlfiddle.com/#!2/f26e2/9)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T16:21:49.110

开始时，我建议您创建尽可能多的表，因为您拥有不同类型的对象，并且您继续将每个不同对象的特定属性作为列放在表中。如果你正在构建一个复杂的关系数据库，其中一些属性会被拉到其他表中，但如果它是简单的，那么它应该没有问题。

当您仅根据对象和属性来描述域时，很难理解您在做什么 - 本质上，使用您的数据库，您正在创建您所代表的域的逻辑视图。

例如，在一个简单的 Orders 数据库中，您可能有客户、产品和订单表。客户的属性 - 例如姓名、地址和电话可能是客户表中的列。但是，您可能会发现将地址拆分到单独的表中更容易，因为您可能有一个客户使用与他们的帐单地址和送货地址相同的地址。

我发现用更具体的术语讨论设计更容易。在您掌握了基础知识并可以创建一个正常运行的系统之后，我会担心完善或优化您的数据库。

查看亚马逊上[的实用程序员](https://rads.stackoverflow.com/amzn/click/com/020161622X)。

# haskell - Haskell 中的模块

> ID：14674381
> 
> 赞同：1
> 
> 时间：2013-02-03T16:03:45.853
> 
> 标签：haskell, module

我是 Haskell 的新手。我对模块、它们是什么以及如何使用它们感到非常困惑。例如，我创建了一个`add.hs`包含如下简单函数的文件：

```
add a b = a + b 
```

在名为 的文件中有一些测试用例`addTestCases.hs`，用于检查`add.hs`.

我应该以某种方式将测试用例加载到 GHC，它会自动运行并找到`add.hs`函数。

我真的不确定如何做到这一点，并希望得到任何澄清，因为我花了很多时间试图弄清楚这一点。

提前谢谢了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T16:18:04.000

在`Add.hs`您声明模块名称时：

```
-- Notice the module name matches the file name, this is typically required
module Add where

add :: Integer -> Integer -> Integer
add x y = x + y 
```

在 Test.hs 你告诉它函数来自哪些模块：

```
-- Notice we didn't declare a module name, so it defaults to 'Main'
import Add
import Test.QuickCheck
main = quickCheck (\ x y -> x > 0 && y > 0 ==> add x y > x && add x y > y) 
```

您现在可以编译并运行您的测试：

```
$ ghc Test.hs
[1 of 2] Compiling Add              ( Add.hs, Add.o )
[2 of 2] Compiling Main             ( Test.hs, Test.o )
Linking Test ...
$ ./Test
+++ OK, passed 100 tests. 
```

编辑：

如果您在 GHCi 内部工作，并且如上所示从终端编译，那么您可以执行以下操作：

```
... run "ghci Test.hs" ...
> main
+++ OK, passed 100 tests. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T16:06:06.750

添加`module Add where`为 add.hs 文件的第一行。然后，您在文件中定义的所有函数都将在模块内，`Add`并且可以通过写入`import Add`这些文件从其他文件中导入。

# wordpress - wordpress 基本循环问题

> ID：14674390
> 
> 赞同：1
> 
> 时间：2013-02-03T16:05:38.550
> 
> 标签：wordpress

我遇到了一个问题，由于某种原因，我试图添加到侧边栏的基本循环保持....在内部页面（单个和页面 .php）上保持循环，但在 index.php 上没有。

在 index.php （主页）上很好。

例如，我希望循环填充无序列表行项目，所以我这样做了：

```
 <div id="sideBarMain">
        <h2>title4sidebar</h2>
       <ul>     
             <?php 
            query_posts( array ( 'category_name' => 'left_sidebar', 'posts_per_page' => 4, 'orderby=menu_order' ) );
            if ( have_posts() ) : while ( have_posts() ) : the_post(); ?>
            <li><a href="<?php the_permalink();  ?>"><?php the_title(); ?></a></li>
            <?php endwhile; endif; ?>
        </ul>

      </div><!-- sidebar ender --> 
```

有几件事正在发生。1\. 最大的问题是，当这个循环到位时，它会破坏导航和所有内容。我点击一个页面，页面加载了标题上的列表行项目之一......所以如果我点击主导航上的“关于我们”，一个页面加载了“行项目标题”...... .

也发生在单击的任何项目上。

2 - 是在（page/single.php 页面）的侧边栏上，它将发布前 4 个帖子，类别为“left_sidebar”，它应该如何显示，css 到位，除了第四行项目之后，它将再重复一次循环。

3 - 我的网站内容区域有 2 列，左侧是侧边栏，中间是主要内容区域。在被错误重复的部分（在循环重复之后），当我使用 FireBug 检查重复的行项目时，它还从我假设的 H 标签属性中获取 H 标签属性，在另一列上它旁边有一个 h 标签。因此，前 4 个行项通过 CSS、链接颜色、翻转等赋予它们的样式很好，下一个错误的 4 个行项没有样式，固定链接也没有像前 4 个等那样应用于它们.

3 - 我从那个 php 循环中删除了所有 html，比如 div 和 ul / lis 等，所以没有应用 css，这样只有文本从循环中出现，但同样的事情发生了，因为我删除了循环的 html 部分，前 4 li 提出了标准的默认蓝色链接文本等，下面的 buggy 4 与之前所有的大都一样，并附有 htag....

全部排除故障 - 页面上只有一个来自侧边栏的循环。- 我正确清除了所有浮点数 - 在 W3C 检查错误等时，没有。绿灯贯穿始终。- 在 php 方面没有错误。（我检查了每个页面并启用了错误）在本地服务器上。

我迷路了。

关于会发生什么的任何想法？

注意：提前考虑，虽然只有 sidebar.php 页面上有一个循环，但一旦从技术上导入，就会有 2 个循环，我猜是侧边栏 wp 循环和获取内容的 page.php / single.php 循环。

可能与最新的wp有什么不同吗？我一直这样做，现在我有问题......

有任何想法吗？我迷路了。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:19:24.887

您的问题有两个方面：

1）**您必须停止使用 query_posts**。关于为什么需要结束使用此功能有很多有据可查的原因，但我认为[这是最好的解释](https://wordpress.stackexchange.com/questions/1753/when-should-you-use-wp-query-vs-query-posts-vs-get-posts)。

2）您没有重置您的查询。稍后会详细介绍。

回到第 1 点，query_posts 的问题在于它会影响全局 $wp_query 对象。如果您的意图是修改主循环，这会很好，但这不是您要在此处执行的操作。您需要使用的是[WP Query](http://codex.wordpress.org/Class_Reference/WP_Query)。创建新查询对象的语法与 query_posts 相同，但好处是您不再影响 $wp_query 的全局实例。

重置您的查询还可以确保使用 Wordpress 查询的其他代码部分不会受到您的查询对象的影响。

尝试将您的代码示例更改为：

```
<?php 
$query = new WP_Query(array('category_name'=>'left_sidebar','posts_per_page'=>4,'orderby=menu_order'));
if($query->have_posts()) : while($query->have_posts()) : $query->the_post();
?>
<li><a href="<?php the_permalink();  ?>"><?php the_title(); ?></a></li>
<?php
endwhile;endif;
wp_reset_postdata();
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T16:18:36.493

您的functions.php 中可能有一些与这些函数交互的过滤器。看看那里，看看你是否想找到一些东西。

您还应该尝试`<?php wp_reset_query(); ?>`在循环之前和之后使用，以确保它不会与其他循环交互。

# linux - 为了处理 arm cortex A9 上的中断，Linux 内核需要多少条指令？

> ID：14674392
> 
> 赞同：4
> 
> 时间：2013-02-03T16:05:43.900
> 
> 标签：linux, linux-kernel, arm, linux-device-driver, irq

我想估计`ARM` `cortex A9`单个内核处理 IRQ 所需的操作码数量。

假设我使用 Linux 内核，调用和执行`3.4`需要多少操作码？`irq``irq_handler`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T18:41:32.660

您的问题与如何计算Linux的[**中断延迟有关。**](https://stackoverflow.com/questions/14698229/what-is-the-irq-latency-due-to-the-operating-system)至少您可能对中断开始之前需要多长时间感兴趣。我们将忽略这里的这方面`irqs`。

一种简单的方法是切换 a`GPIO`并使用示波器来测量中断。您甚至可以切换`GPIO`多次以查看不同阶段所需的时间。此[Window CE 链接](http://msdn.microsoft.com/en-us/library/ms836535.aspx)显示了一个测量延迟的示例。一些中断控制器（例如 IMX）具有 I/O 多路复用模式，其中一个中断号将提高/降低特定的 I/O 线。或者，您可以添加代码来切换线路（请参阅下面的例程）。

主要中断处理的来源在[entry-armv.S](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=blob;f=arch/arm/kernel/entry-armv.S;hb=HEAD)中。为您使用的中断控制器定义了宏，这些宏取决于`.config`文件。例如，有抢占式中断、多中断控制器、SMP 等。*主*向量定义在**entry-armv.S**的底部。总的要点是检查当前的操作模式，然后采用`__irq_usr`或`__irq_svc`。这些例程具有不同的预置来存储状态，但它们最终都调用了`irq_handler`宏。有关于的`_irq_usr`东西`cmpxchg`，但如果你在你的`.config`，这将不适用。主要区别在于用户模式下发生 IRQ 后可能的上下文切换。您的机器定义了`mach/entry-macro.S`哪些是汇编器宏来访问中断控制器并获取中断号。然后它跳转到顶级*内核*目录中的通用`irq` [处理代码。](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=blob;f=kernel/irq/handle.c;hb=HEAD)

 *所以第二种方法是检查代码并直接计算。如果您查看源代码、编译内核然后`objdump --disassemble`在**vmlinux**映像上执行操作并查找这些符号，这可能会更容易。您将看到`irq_handler`宏扩展，它最终应该跳转到您的 IRQ 代码。

从源码可以看出，还有[`TRACE_IRQFLAGS`](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=blob;f=Documentation/irqflags-tracing.txt;hb=HEAD). 您可以检查这在您使用的 Cortex A9 上是否可用`make menuconfig`（并键入`/TRACE_IRQFLAGS`）。我不知道它是否可用。

有一些变化，例如，

1.  从用户/SVC 模式中断。
2.  当前正在运行的其他中断。
3.  被中断的代码（例如 stm/ldm）可能需要一些时间才能完成。
4.  ISR 中的页面错误。至少在某些 Linux 版本中，一些 Alsa 驱动程序可能会出现未分配页面的故障。
5.  ISR 中的条件。

在示波器上进行测量将显示维修中的**抖动。**`IRQ`检查说明通常会表明`IRQ`可能永远不会得到服务；例如，如果更高优先级的中断不断抢占/阻止`IRQ`. 可能您需要同时执行这两项操作才能完全优化硬期限。

通常，您并不关心整个`IRQ`过程需要多长时间，而是在`IRQ`提升线路和写入/读取某些外围寄存器之间的时间。例如，a 的`FIFO`深度可能有限，如果 IRQ 发生和读取`FIFO`寄存器之间的延迟大于**FIFO_Size x BPS**，那么您就会遇到`FIFO`溢出问题。

基础结构要快得多，但您可以使用的`FIQ`内核设施要少得多！

**编辑：** Cortex [A9 技术参考](http://infocenter.arm.com/help/topic/com.arm.doc.ddi0388i/DDI0388I_cortex_a9_r4p1_trm.pdf)在附录 B 中有指令计数。大多数 ARM 指令在大多数架构上都是一个周期，除了内存加载/存储、倍数和分支。按照上面的第 3 和第 4 段找到为您的配置处理 Linux 中断的完整指令路径，然后**将其添加**；对于*估计*（如原始问题所要求的那样），您可以只计算指令，因为它们通常是一个周期。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-03T19:38:54.103

虽然您可以通过检查源代码来计算理论上的最小核心周期数，但由于缓存、内存和内存控制器性能、其他核心当时正在做什么以及各种因素的影响，实际采用的数量要不确定得多。其他因素取决于相关 ARM 处理器的微架构。

我怀疑您最好测量系统的实际中断延迟性能，无论是使用数字范围还是性能计数器。

当然，对于硬实时应用程序，您需要知道*最坏情况下*的中断延迟——包括*所有*这些因素的最坏情况。*

# .net - GitHub 存储库和本地开发结构

> ID：14674395
> 
> 赞同：0
> 
> 时间：2013-02-03T16:05:51.497
> 
> 标签：.net, git, github

首先，我们所有的项目都是 .Net C# 项目。

我需要一些关于设置本地和存储库结构的最佳方法的建议。

我们有一个主要项目作为我们所有项目使用的核心库。我不一定希望拥有一个包含多个项目的存储库，但我确实希望我的其他项目能够访问主库的项目。出于组织目的，我希望将每个项目都放在自己的存储库中。

我知道我应该在我的本地系统上做些什么来实现这一点，但我想在开始设置我的项目之前获得社区的意见。

**更新**

与[布拉德利](https://stackoverflow.com/users/23633/bradley-grainger)建议的非常相似，我采用了类似的结构：

```
All Projects Folder
     Core Project
     Another Project
     Yet another Project 
```

使用[GitHub for Windows](http://windows.github.com/)，您可以使用该`Clone To`功能将本地存储库放置在主项目文件夹中。因此，在此示例中，我将从 GitHub for Windows 中选择远程存储库，右键单击要克隆的远程存储库并选择克隆到。我会选择“所有项目文件夹”来放置我的代码。这将为您创建文件夹和项目结构。然后，其他项目可以通过使用该结构中的相对路径来相互引用。我发现使用[Git Source Provider](http://gitscc.codeplex.com/) for Visual Studio 2012 也有助于查看项目之间的所有未决更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:08:10.467

你可以[`create and publish a NuGet package`](http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package)退出这个主项目，然后让其他项目简单地安装这个 NuGet。这样，其他人也可以在他们的应用程序中使用这个常见的 NuGet。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T18:37:45.757

假设您要将代码分成多个存储库，将一个存储库作为另一个存储库的依赖项的一种方法是使用[git submodules](http://git-scm.com/book/en/Git-Tools-Submodules)。

我个人发现子模块在日常使用中有点痛苦。（例如，`git checkout`在切换分支时不会自动更新子模块；开发人员经常在添加所有内容之前忘记回滚子模块`git submodule update`等）

因此，我们更喜欢“约定优于配置”的方法，并且简单地将所有必要的存储库克隆为彼此的兄弟姐妹。当对两个 repos 进行更改时，您只需提交并推送两个 repos，并假设其他开发人员正在跟踪`master`两个 repos 中的分支并将同时拉取两者。

很容易编写一个 bash 脚本或批处理文件来在新机器上进行设置，或者在现有机器上一次更新所有 repos。

有关更详细的示例，请参阅我的[“跨项目共享代码”](http://code.logos.com/blog/2012/11/building-code-at-logos-sharing-code-across-projects.html)博客文章。

# android - 如何为 HTC Evo 3D 或其他 3D 兼容设备等 3D Android 设备制作 3D 图片库？

> ID：14674397
> 
> 赞同：3
> 
> 时间：2013-02-03T16:06:13.157
> 
> 标签：android, image, 3d, gallery

我想为 3D 兼容设备创建一个 3D 图像库，但我不知道如何开始以及如何测试应用程序。我有一台 Android 设备 SonyEricsson Xperia neo V。是否可以使用此设备测试该应用程序？如果不是，那么我该如何创建应用程序以及如何测试？

# mysql - 使用外键约束更新

> ID：14674400
> 
> 赞同：0
> 
> 时间：2013-02-03T16:06:30.467
> 
> 标签：mysql, foreign-keys

如何更新与外键约束链接的多个元组这是我的表定义

```
CREATE TABLE person
(
    driverId VARCHAR(10) PRIMARY KEY,
    driverName VARCHAR(30),
    address VARCHAR(50)
);

CREATE TABLE car
(
    regNo VARCHAR(10),
    model VARCHAR(25),
    YEAR INT,
    PRIMARY KEY(regNo)
);

CREATE TABLE accident 
(
    reportNo INT,
    accidentDate DATE,
    location VARCHAR(30),
    PRIMARY KEY(reportNo)
);

CREATE TABLE participated
(
    driverId VARCHAR(10),
    regNo VARCHAR(10) ,
    reportNo INT,
    damageAmount INT,
    FOREIGN KEY(driverId) REFERENCES person(driverId),
    FOREIGN KEY(regNo) REFERENCES car(regNo),
    FOREIGN KEY(reportNo) REFERENCES accident(reportNo),
    PRIMARY KEY(driverId, regNo,reportNo)
);

CREATE TABLE owns
(
    driverId VARCHAR(10),
    regNo VARCHAR(10),
    FOREIGN KEY(driverId) REFERENCES person(driverId),
    FOREIGN KEY(regNo) REFERENCES car(regNo),
    PRIMARY KEY(driverId, regNo)
); 
```

当我执行这个命令时

```
UPDATE accident
SET reportNo=5555
WHERE reportNo=2222; 
```

“PARTICIPATED”表中具有相同“reportNo”的元组没有被更新

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:18:17.260

1.  您的数据库引擎必须是`InnoDB`. 您可以使用以下方法更改引擎：

    `ALTER TABLE database_name.table_name ENGINE = InnoDB;`

2.  如果未指定引用操作，则默认操作是限制。您必须指定`ON DELETE`或`ON UPDATE`操作。[文档](http://dev.mysql.com/doc/refman/5.1/en/innodb-foreign-key-constraints.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T16:21:41.960

使用以下查询。
**ALTER TABLE table_name ADD FOREIGN KEY(keyname) 引用 parent_table_name.column name on update cascade on delete cascade。**

级联允许父表中的更改反映在子表中。但请确保您的存储引擎必须是 InnoDB

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T16:13:54.717

尝试`ON UPDATE CASCADE`在参与表中添加外键约束

# mysql - Magento“一般错误：1005无法创建表”

> ID：14674405
> 
> 赞同：1
> 
> 时间：2013-02-03T16:06:38.653
> 
> 标签：mysql, magento, foreign-keys, magento-1.7, mysql-error-1005

我吓坏了……在 Magento 网站上工作，一切都很好。今天早上醒来继续工作，整个网站（前端和管理员）都在抛出错误。错误日志说：

```
a:5:{i:0;s:249:"Error in file: "/home1/ameridq4/public_html/pursuityourself/magento/app/code/core/Mage/Admin/sql/admin_setup/    install-1.6.0.0.php" - SQLSTATE[HY000]: General error: 1005 Can't create table 'ameridq4_ecommerce-pursuit-magento.admin_assert' (errno: -1)";i:1;s:1168:"#0 /home1/ameridq4/public_html/pursuityourself/magento/app/code/core/Mage/Core/Model/Resource/Setup.php(645): Mage::exception('Mage_Core', 'Error in file: ...')
#1 /home1/ameridq4/public_html/pursuityourself/magento/app/code/core/Mage/Core/Model/Resource/Setup.php(421): Mage_Core_Model_Resource_Setup->_modifyResourceDb('install', '', '1.6.1.0')
#2 /home1/ameridq4/public_html/pursuityourself/magento/app/code/core/Mage/Core/Model/Resource/Setup.php(327): Mage_Core_Model_Resource_Setup->_installResourceDb('1.6.1.0')
#3 /home1/ameridq4/public_html/pursuityourself/magento/app/code/core/Mage/Core/Model/Resource/Setup.php(235): Mage_Core_Model_Resource_Setup->applyUpdates()
#4 /home1/ameridq4/public_html/pursuityourself/magento/app/code/core/Mage/Core/Model/App.php(417): Mage_Core_Model_Resource_Setup::applyAllUpdates()
#5 /home1/ameridq4/public_html/pursuityourself/magento/app/code/core/Mage/Core/Model/App.php(343): Mage_Core_Model_App->_initModules()
#6 /home1/ameridq4/public_html/pursuityourself/magento/app/Mage.php(683): Mage_Core_Model_App->run(Array)
#7 /home1/ameridq4/public_html/pursuityourself/magento/index.php(87): Mage::run('', 'store')
#8 {main}";s:3:"url";s:10:"/magento/e";s:11:"script_name";s:18:"/magento/index.php";s:4:"skin";s:7:"default";} 
```

从昨晚工作正常到今天早上，我什么都没做……我昨天做的最后一件事是将默认商店名称从“默认商店”更改为“追求”。任何想法发生了什么以及如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:12:38.323

问题是存在外键约束，其中一个表是 MyISAM。此存储引擎不支持外键约束。（[来源](https://stackoverflow.com/questions/1655435/why-my-table-doesnt-support-foreign-keys)）。安装文件是 Admin 模块的文件，因此请尝试将`Mage_Admin`模块表转换为 InnoDB（在 phpmyadmin 或任何其他数据库客户端中执行）：

```
alter table admin_assert engine=innodb;
alter table admin_role engine=innodb;
alter table admin_rule engine=innodb;
alter table admin_user engine=innodb; 
```

如果其他表错误地具有 MyISAM 存储引擎，您可能还必须将其他表转换为 InnoDB。这个[博客](http://www.learnmagento.org/magento-tutorials/sqlstatehy000-general-error-1005-cant-create-table/)有一个脚本（在运行这个脚本之前备份你的数据库）。Magento 核心中的每个表，除了`catalogsearch_fulltext`(MyISAM) 和临时表 (MEMORY)，都是 InnoDB。

# d3.js - 隐藏/显示单个系列的适当方式

> ID：14674407
> 
> 赞同：1
> 
> 时间：2013-02-03T16:06:49.127
> 
> 标签：d3.js

在 d3.js 中，在多系列时间序列图表中隐藏/显示不同系列的最合适方法是什么？

1.  将我的数据绑定到一个`<svg>`元素，然后每次渲染时，选择该数据的一个子集并绑定到我的`<path>`元素。

2.  将数据附加到 javascript 变量（全局？），然后将其子集传递给我的`chart()`对象。

3.  其他的？

# php - Php PDO 扩展类在其他类中使用它而不扩展类

> ID：14674409
> 
> 赞同：0
> 
> 时间：2013-02-03T16:07:09.503
> 
> 标签：php, class, pdo

> **可能重复：**
> [PHP 和 PDO 类问题](https://stackoverflow.com/questions/6297835/php-and-pdo-class-question)

我想知道是否有人可以帮助我拥有一个基本的 php PDO 扩展类，并且我想在其他类中使用全局 $db 来完成所有 mysql 的工作。我可以连接到数据库，但只想使用可以在任何类中访问的全局变量。

但是我不想用我的新类扩展数据库类，我也不想在类构造函数中传递数据库连接变量。

有没有办法做到这一点？

这是我想要实现的一些编码示例，请原谅任何编码错误..

```
//--DATABASE CLASS
class Database Extends PDO {

    protected $database_hostname = DB_HOST;
    protected $database_username = DB_USER;
    protected $database_password = DB_PASSWORD;
    protected $database_name = DB_NAME;
    protected $database_type = DB_TYPE;

    public function __construct() {

        try {
            parent::__construct($this->database_type . ':host=' . $this->database_hostname . ';dbname=' . $this->database_name, $this->database_username, $this->database_password, array(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION));
        } catch (PDOException $e) {
            echo 'ERROR: ' . $e->getMessage();
        }
    }

}

//--TEST CLASS
class test1 {

    //--INSIDE MY FUNCTIONS I WANT TO BE ABLE TO USE A $db to do my msql stuff
    public function test1a() {

        $stmt = $db::prepare('SELECT * FROM table');
        $stmt->excute();
    }

}

//--TEST CLASS 2
class test2 {

    public function test2a() {

        $stmt = $db::prepare('SELECT * FROM table');
        $stmt->excute();
    }

}

//--CREATE THE DATABASE GLOBAL
 $db = new Database();
 $testers = new test2(); 
```

如果我执行上述操作，我会收到一条错误消息，指出 $db 是未定义的变量：db

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:15:20.823

虽然我读到不推荐这样做，但您可以执行以下操作：在所有类之外（在全局范围内）初始化您的连接：
`$db = new Database();`
然后在您需要 Db 连接的每个函数中，编写以下代码：
`global $db;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T16:16:23.893

在`$db`函数内部使用时，PHP 期望变量在本地函数范围内。要访问全局变量，请使用

1.  `$GLOBALS['db']->prepare`（**重要**：使用`->`而不是`::`；静态调用`prepare`将不起作用），**或**
2.  `global $db; $db->prepare(...);`

# c++ - 删除矢量数据而不是向前推进

> ID：14674412
> 
> 赞同：-3
> 
> 时间：2013-02-03T16:07:19.320
> 
> 标签：c++, vector

我有一个包含数据的向量

> 记录 1：03：泰德
> 记录 2：06：玛丽
> 记录 3：23：渡轮

我如何删除`Record 2`，以一种`Record 3`数据不会推高并最终变成的方式`Record 2`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:12:47.083

如果我理解正确，请使用记录编号映射到记录：

```
std::unordered_map<std::size_t, Record> records{ //or std::map in C++03
    {1, {"03", "Ted"}}, //or records[1] = Record("03", "Ted") in C++03
    {2, {"06", "Mary"}}, //or records[2] = Record("06", "Mary") in C++03
    {3, {"23", "Ferry"}} //or records[3] = Record("23", "Ferry") in C++03
};

records.erase(2); //leaves records[1] and records[3] intact 
```

有关完整的演示，[请参阅此处](http://liveworkspace.org/code/36BbdL%242)fpr C++11，或[此处](http://liveworkspace.org/code/36BbdL%247)查看 C++03，尽管 C++03 可以改进，`insert`因此不需要默认构造函数`Record`。我想 C++11 也可以`const`在迭代时使用，尽管这不是重点。

# sprite - XNA 循环绘制多个精灵不起作用

> ID：14674413
> 
> 赞同：0
> 
> 时间：2013-02-03T16:07:18.870
> 
> 标签：sprite, xna-4.0

为我在大学的第一学期作业开发一个简单的 XNA 游戏。然而，我在敌人精灵的绘制循环中遇到了一些障碍。据我所知，所有的敌人精灵都被添加到 game1.cs 类的列表中，但只有列表中的第一个被绘制。

此方法将敌人的实例添加到列表中。Spawn 在更新方法中每秒递增。这使得敌人每秒按顺序生成，直到生成了四个。

```
public void LoadEnemies()
    {
        int randX = rand.Next(0, 1000);
        int randY = rand.Next(0, 500);

        if (spawn >= 1)
        {
            spawn = 0;

            if (enemyList.Count() < 4)
            {
                enemyList.Add(new NM_Enemy(Content.Load<Texture2D>("Wisp1"), new Vector2(randX, randY)));
                enemyList.Add(new NM_Enemy(Content.Load<Texture2D>("Wisp2"), new Vector2(randX, randY)));
                enemyList.Add(new NM_Enemy(Content.Load<Texture2D>("Wisp3"), new Vector2(randX, randY)));
                enemyList.Add(new NM_Enemy(Content.Load<Texture2D>("Wisp4"), new Vector2(randX, randY)));
            } 
        }

        //Checks if enemies in the list have left the level bounds
        for (int i = 0; i < enemyList.Count; i++)
        {
            if (!enemyList[i].isVisible)
            {
                enemyList.RemoveAt(i);
                i--;
            }
        }
    } 
```

绘制方法

```
foreach (NM_Enemy enemy in enemyList)
                    {
                        enemy.Draw(gameTime, spriteBatch);
                    } 
```

更新方法

```
foreach (NM_Enemy enemy in enemyList)
                {
                    enemy.Update(gameTime);
                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T09:01:26.423

您发布的代码片段与您的程序描述不完全匹配。你之前这么说

> 敌人每秒按顺序产生，直到产生四个，但实际上发生的情况是，如果敌人少于四个，则同时产生四个。此外，它们都是在`(randX, randY)`没有你打电话`rand.Next()`的情况下产生的，这意味着你有四个敌人在完全相同的位置。这可以解释为什么你只看到一个 - 它们都在彼此之上。尝试在这一行设置断点

```
enemy.Draw(gameTime, spriteBatch); 
```

并看看敌人的位置。你可能会发现它们都在同一个地方。`randX`可以肯定的是，将行中的和`randY`值交换`enemyList.Add()`为一些手动输入的值，以便确定它们的位置不同，然后查看它们绘制的位置。

# javascript - Javascript向上箭头按键不触发

> ID：14674414
> 
> 赞同：3
> 
> 时间：2013-02-03T16:07:18.860
> 
> 标签：javascript, keypress

我最近一直在做一些 JS 并遇到这个愚蠢的错误，我可以使用`e.keyCode`并检查返回键，`keyCode == 13`但是当我尝试检查`38`（向上箭头）时它永远不会触发。请问有什么帮助吗？

HTML：

```
<input type="text" id="TxtMessage" 
       placeholder="Message" onKeyPress="SendMsg(event)" > 
```

Javascript：

```
function SendMsg(e)
{
var message = document.getElementById("TxtMessage");

if(e.keyCode ==13)
{
    var json = {"message": message.value};
    json = JSON.stringify(json);
    ws.send(json);
    PreviousMessage = message.value;
    message.value = "";
    message.focus();
}
else if(e.keyCode == 38) 
{ 
    message.value = PreviousMessage;
}
} 
```

编辑：通过将 onKeyPress 更改为 onKeyDown 来修复...奇怪。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:22:56.397

替换您的以下行：

```
if(e.keyCode !=13) return;
if(e.keyCode == 38) { message.value = PreviousMessage; return;  } 
```

对于这个：

```
var charCode = typeof e.which == "number" ? e.which : e.keyCode;

if(charCode == 38) { message.value = PreviousMessage; return;  }
if(charCode !=13) return; 
```

**更新：**
我上面的代码在 keypress 事件中使用时仍然不起作用，因为**正确的解决方案**是使用**keydown**或**keyup**事件来捕捉箭头键。请参阅此处以获取增强的答案[https://stackoverflow.com/a/2218915/352672](https://stackoverflow.com/a/2218915/352672) 另请参阅此处使用 keyup 事件的[**工作 jsfiddle 。**](http://jsfiddle.net/gnel/s63MR/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T16:09:47.977

交换

```
if(e.keyCode !=13) return; 
```

和下一行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T16:24:47.847

用这个：

```
function SendMsg(e)
{
    var message = document.getElementById("TxtMessage");

    // Load previous message
    if(e.keyCode == 38) { message.value = PreviousMessage; return;  }

    // Send message on ENTER
    if(e.keyCode == 13) {
        if(message.value !=null && message.value !="")
        {
            var json = {"message": message.value};
            json = JSON.stringify(json);
            ws.send(json);
            PreviousMessage = message.value;
            message.value = "";
            message.focus();
        }
        else
        {
            CAlert("Message cannot be empty.", false, true);    
        }
    }
} 
```

**更新**为什么 keyDown 有效而 keyPress 无效？

> 请注意，keydown 和 keyup 提供了指示按下哪个键的代码，而 keypress 指示输入了哪个字符。例如，小写的“a”将被 keydown 和 keyup 报告为 65，但被 keypress 报告为 97。所有事件都将大写“A”报告为 65。由于这种区别，当捕获特殊按键（如箭头键）时，.keydown() 或 .keyup() 是更好的选择。

简而言之，`keyPress`箭头键不会触发事件。

# c - 使用队列类型的指针

> ID：14674415
> 
> 赞同：0
> 
> 时间：2013-02-03T16:07:19.857
> 
> 标签：c, pointers, queue

我对 c 和指针很陌生。每次我认为 k 我已经理解它时，都会出现一个我不太理解的问题（我花了一些时间阅读 c 文档，但指针对我来说仍然不清楚）：

```
typedef struct {
        int q[QUEUESIZE+1];
        int first;
        int last;
        int count;
} queue;

enqueue(queue *q, int x)
{
  if (q->count >= QUEUESIZE)
        printf("Warning: queue overflow enqueue x=%d\n",x);

  else {
    q->last = (q->last+1) % QUEUESIZE;
    q->q[ q->last ] = x;
    q->count = q->count + 1;
  } 
} 
```

我希望我的问题不会太不透明，但有人可以解释在入队函数中使用指针吗？我以为排队的原理是分配一些精确的连续内存地址，但不是那么肯定......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T16:14:24.940

`enqueue`接受一个*队列*队列（队列类型的*队列*）并在其中添加一个元素（由整数组成。

`queue *q`是一个指针，因为，可能

*   可能有多个队列，参数告诉我们正在谈论的队列
*   为了避免全局变量，队列作为参数给出 - 我们想要对队列的引用以便可以对其进行修改，并且即使在退出后修改也将保持有效`enqueue`

按值传递队列，如

```
enqueue(queue q, int x) { ... 
```

意味着

*   大量数据作为参数给出（队列 myqueue 到`q`参数的副本）
*   当`q`被修改时，在函数`q`内进行修改。`enqueue`最初提供的队列（myqueue）作为参数不会被修改

例如

```
enqueue(queue q, int x) { 
  q.count++; // only the local q.count is changed, not myqueue.count
  // ...
}

// ...

queue myqueue;
// ...
enqueue (myqueue, 3); // enqueue changes its local parameter, myqueue is not affected 
```

此外，`enqueue`可以优化功能实现......（请参阅下面的*wildplasser*答案，谁建议更好的*队列*实现）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T16:28:43.210

```
struct queue {
        unsigned first;
        unsigned count;
        int q[QUEUESIZE];
        };

int enqueue(struct queue *q, int x)
{
  if (q->count >= QUEUESIZE) {
        fprintf(stderr, "Warning: queue overflow enqueue x=%d\n", x);
        return -1;
        }

  q->q[ (q->first+q->count++) % QUEUESIZE ] = x;
  return 0; /* success */ 
} 
```

* * *

几点：

*   诊断输出应该去stderr
*   对计数和偏移量使用无符号类型将（在大多数情况下）避免数值下溢（或将其转换为溢出，这将更快地失败；-）
*   你不需要三个元素 {head, tail, count}，只需要两个 {head, count} 就足够了
*   更少的变量 := 更少的赋值 := 更少的行 = 更少的出错机会。
*   范围检查和模除法中的 QUEUESIZE 可能应该替换`sizeof q->q / sizeof q->q[0]`为更健壮的 。

# python - 使用套接字通过主机名连接有效，但不适用于所有端口

> ID：14674416
> 
> 赞同：1
> 
> 时间：2013-02-03T16:07:22.893
> 
> 标签：python, sockets, networking

我想看看套接字是如何工作的，所以我浏览了[HOWTO](http://docs.python.org/3.3/howto/sockets.html#socket-howto)和[文档](http://docs.python.org/3.3/library/socket.html)并尝试编写自己的代码。服务器端如下所示：

```
ssock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
assert socket.gethostname() == HOST
ssock.bind((HOST, PORT))
ssock.listen(5)
while True:
    csock, address = ssock.accept()
    print('Accepted connection from', address)
    t = threading.Thread(target=server, args=(csock,))
    t.start() 
```

客户端是：

```
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((HOST, PORT)) 
```

这些都在一个模块中，因此常量是相同的。这行不通。当我尝试连接时，我得到一个`ConnectionRefusedError: [Errno 111] Connection refused`.

**但是**：

1.  当我尝试通过主机名连接到另一个端口时，它可以工作：

    ```
    In [4]: s.connect((HOST, 22))

    In [5]: s.recv(1024)
    Out[5]: b'SSH-2.0-OpenSSH_5.9p1 Debian-5ubuntu1\r\n' 
    ```

    （显然，不是我的应用程序处理服务器上的连接）。

2.  当我在服务器代码中将主机名更改为本地 IP 地址时，我也可以连接到我的端口（使用 IP 作为主机字符串）。

这些情况的结合使我感到困惑。谁能解释这种行为？

**编辑：**`HOST`如果我在服务器代码中使用 IP，似乎我也可以连接。但是为什么它不像在 HOWTO 中那样工作呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T17:08:29.920

绑定到 "" 而不是 HOST：

```
ssock.bind(("", PORT)) 
```

# jsp - JSP 脚本无法正确显示阿拉伯字符

> ID：14674419
> 
> 赞同：1
> 
> 时间：2013-02-03T16:08:00.843
> 
> 标签：jsp, character-encoding, jsp-tags

当我得到以下输出时：

```
System.out.print(name); 
```

我无法正确看到字符。

我该如何解决？

这是我的代码：

**插入.jsp**

```
<%@page import="dao.DaoAdmin"%>
<%@ page import="java.sql.*"%>
<%@ page import="java.sql.PreparedStatement;"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
    <%    request.setCharacterEncoding("UTF8");   %>
<%
    String name = request.getParameter("name");
    String city = request.getParameter("city");
    String phone = request.getParameter("phone");
    System.out.print(name);
%>

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
</head>
<body>
    <script type="text/javascript">

    alert("dsfg");
    </script>
</body>
</html> 
```

**索引.jsp**

```
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Sita Ajax test</title>
<script type="text/javascript" charset="UTF-8">
    function ajaxRequest() {
        var activexmodes = [ "Msxml2.XMLHTTP", "Microsoft.XMLHTTP" ]; //activeX versions to check for in IE
        if (window.ActiveXObject) { //Test for support for ActiveXObject in IE first (as XMLHttpRequest in IE7 is broken)
            for ( var i = 0; i < activexmodes.length; i++) {
                try {
                    return new ActiveXObject(activexmodes[i]);
                } catch (e) {
                    //suppress error
                }
            }
        } else if (window.XMLHttpRequest) // if Mozilla, Safari etc
            return new XMLHttpRequest();
        else
            return false;
    }
    // JavaScript Document
    function ajaxget() {
        var mygetrequest = new ajaxRequest();
        mygetrequest.onreadystatechange = function() {
            if (mygetrequest.readyState == 4) {

                document.getElementById("insert_response").innerHTML = mygetrequest.responseText;

            }
        };
        var name = document.getElementById("name").value;
        var city = document.getElementById("city").value;
        var phone = document.getElementById("phone").value;

        mygetrequest.open("GET", "insert.jsp?name=" + name + "&city=" + city
                + "&phone=" + phone + "", true);
        mygetrequest.send(null);

    }
</script>

</head>
<body>
    <h1>Welcome!</h1>

    <form action="javascript:ajaxget()" ; method="post"
        accept-charset="UTF-8">
        <table style="background-color: #ECE5B6;" width="30%">

            <tr>
                <th width="50%">Name</th>
                <td width="50%"><input type="text" name="name" id="name">
                </td>
            </tr>
            <tr>
                <th width="50%">City</th>
                <td width="50%"><input type="text" name="city" id="city">
                </td>
            </tr>
            <tr>
                <th width="50%">Phone</th>
                <td width="50%"><input type="text" name="phone" id="phone">
                </td>
            </tr>

            <tr>
                <th></th>
                <td width="50%"><input type="submit" value="submit"></td>

            </tr>
        </table>
    </form>
    <br />
    <br />
    <br />
    <br />

    <!-- Show Message for AJAX response -->
    <div id="insert_response"></div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:12:09.293

我不知道它是否对您有帮助，但我在您的代码中注意到的`insert.jsp`是您正在编写以下代码：

```
<%
    String name = request.getParameter("name");
    String city = request.getParameter("city");
    String phone = request.getParameter("phone");
    System.out.print(name);
%> 
```

甚至在你开始你的`<html>`代码之前。这段代码应该在`<body> ...</body>`标签的某个地方。

其次，为什么要编写`<%@page ..>`具有不同属性的多个标签。

```
<%@page import="dao.DaoAdmin"%>
<%@ page import="java.sql.*"%>
<%@ page import="java.sql.PreparedStatement;"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%    request.setCharacterEncoding("UTF8");   %> 
```

而是这样写：

```
<%@page import="dao.DaoAdmin;java.sql;java.sql.PreparedStatement" language="java"
contentType="text/html; charset=UTF-8" /> 
```

所以试试这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T16:20:11.200

尝试`response.setCharacterEncoding ("UTF-8");`在开头添加。

# wso2carbon - WSO2 BAM 中的服务监控在全新安装时不可用

> ID：14674421
> 
> 赞同：0
> 
> 时间：2013-02-03T16:08:05.823
> 
> 标签：wso2carbon

gadget-repo.xml 文件包含 Service Sample-1，但它没有在浏览器上呈现？

```
<resource path="/gadget-server/gadget-repo/gadget-metadata/gadget-0" isCollection="false">
                <mediaType>application/octet-stream</mediaType>
                <properties>
                    <property key="gadgetName">Sample-1 - Services Monitoring</property>

                    <property key="gadgetUrl">/registry/resource/_system/config/repository/gadget-server/gadgets/Sample-1-ServicesMonitoring/serviceMon.xml</property>
                    <property key="defaultGadget">false</property>
                    <property key="gadgetDesc">This is a sample gadget which show you how to display statistics using WSO2Vis. Graph is generated by a sample set of data.</property>
                    <property key="userCounter">0</property>
                    <property key="unsignedUserGadget">false</property>
                    <property key="thumbUrl">/registry/resource/_system/config/repository/gadget-server/gadgets/Sample-1-ServicesMonitoring/thumb/serviceMon-thumb.png</property>
                </properties>
            </resource> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T02:47:01.290

您使用的是 WSO2 BAM 2.xx 吗？如果是这样，则不再使用 gadget-repo.xml 在门户仪表板中呈现小工具。[您可以添加此处](http://docs.wso2.org/wiki/display/BAM201/Service+Statistics+Toolbox)提到的相应服务统计工具箱。[您可以从此处](http://docs.wso2.org/wiki/display/BAM201/Introduction+to+BAM+Toolbox)获得有关 BAM 工具箱概念的更多详细信息。

# jakarta-ee - 轻型 WAR 和全球可用的库

> ID：14674424
> 
> 赞同：0
> 
> 时间：2013-02-03T16:08:12.357
> 
> 标签：jakarta-ee, maven, jboss, jboss7.x, war

我开始使用 JBoss7.1 快速入门的体系结构构建我的 Web 应用程序。

我喜欢它，但现在我需要在我的项目中添加一些库，所以我在 pom.xml 中添加了几个依赖项。例如，这是针对 JasperReports 的：

```
<dependency>
            <groupId>net.sf.jasperreports</groupId>
            <artifactId>jasperreports</artifactId>
            <version>5.0.0</version>
        </dependency> 
```

等等，对于其他图书馆。不幸的是，在构建我的项目之后，我注意到“ *mvn package* ”产生的战争大小是.... 36MB？！？太多了，我得把那个东西上传到远程服务器上，快！

笨重的东西都存储在 /WEB-INF/lib 中，并且确实是一组 JAR（我作为依赖项包含的库）。

在我的战争中不必每次都包含不必要的有效载荷的最佳实践是什么？

我想我应该在 JBoss 环境中的某个地方包含 JAR 并以不同的方式声明 maven 依赖项，也许......但是如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T17:05:55.700

您可以将 Jboss 用作 7 模块系统，以将一些依赖关系作为 JBoss 模块从战争中带走。

[有关如何创建和使用模块的示例，您可以查看此博客文章。](http://www.javacodegeeks.com/2011/09/jboss-modules-example-modular-web.html)

在`pom.xml`文件中，您应该`scope`为模块化的 jar 添加一个带有`provided`as 值的元素（应该已经存在于 Java EE 依赖项中）。这会告诉 maven jar 将由环境提供，无需将它们放入战争中。

这种技术将使您的战争更轻松，但您将失去对运行时依赖项的 maven 管理。您必须确保在将部署应用程序的所有服务器上都有正确的版本。

# bash - Exec - 运行两个命令

> ID：14674425
> 
> 赞同：1
> 
> 时间：2013-02-03T16:08:23.820
> 
> 标签：bash, exec

我将 Debian 与[**LXDE**](http://lxde.org)一起使用。

我有一个简单的 bash 脚本可以运行

```
lxterminal -e /home/userpc/tvheadend/build.linux/tvheadend | sleep 5 | xbmc 
```

该脚本运行良好。我想将这三个命令添加到桌面上的激活器中，以及要删除的脚本。激活器如下所示：

```
[Desktop Entry]
Type=Application
Exec=lxterminal -e /home/userpc/tvheadend/build.linux/tvheadend | sleep 5 | xbmc
Name=test
Icon=brak 
```

问题是 exec 不想运行这些命令：

```
Exec=lxterminal -e /home/userpc/tvheadend/build.linux/tvheadend  | sleep 5 | xbmc 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:13:09.567

你不应该真的管道这些命令。也许像这样

```
Exec='lxterminal -e /home/userpc/tvheadend/build.linux/tvheadend; sleep 5; xbmc' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T17:18:56.263

您实际上可能希望使用双与号`&&`运算符分隔命令。

```
Exec='lxterminal -e /home/userpc/tvheadend/build.linux/tvheadend && sleep 5 && xbmc' 
```

这将“快速失败”：如果任何命令失败（以错误代码退出），后续命令将不会运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-14T15:40:18.290

在我的情况下，只有以下解决方案有效（用反引号括起来）：

```
Exec=`exo-open --launch WebBrowser https://www.example.com; sleep 2 & exo-open --launch WebBrowser https://www.example.com/` 
```

*Debian 10/Xfce4*

# r - 特征（corr）错误：制作“相关矩阵圆图”时，“x”中的值无限或缺失

> ID：14674431
> 
> 赞同：4
> 
> 时间：2013-02-03T16:09:13.030
> 
> 标签：r, matrix, correlation, heatmap

我想制作一个如下所示的相关矩阵。但是，R一直告诉我

```
'Error in eigen(corr) : infinite or missing values in 'x'' 
```

[相关矩阵圆](http://gallery.r-enthusiasts.com/graph/Correlation_matrix_circles,152)

我认为这可能是由我的矩阵中的 NA 值引起的。但是，当我尝试通过添加来删除它们时

```
'na.rm=TRUE,' it doesnt seem to help

circle.corr( cor(Plant, na.rm=TRUE,), order = TRUE, bg = "gray50", 
    col = colorRampPalette(c("blue","white","red"))(100) ) 
```

我已经加载了上面链接中提供的功能

是否可以在删除 NA 的情况下创建一个新的 data.frame？如果是这样，如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T16:21:03.663

没有数据很难为您提供帮助，但是由于您的相关矩阵包含`NA`并且`eigen`在这种情况下无法计算特征值，因此会出现错误。

这应该工作：

```
circle.corr( cor(Plant,use = "complete.obs"),   # NA are removed
      order = TRUE, bg = "gray50",
      col = colorRampPalette(c("blue","white","red"))(100) ) 
```

# ios - 情节提要：NavigationController 中的第三个场景到第一个场景

> ID：14674443
> 
> 赞同：0
> 
> 时间：2013-02-03T16:10:15.350
> 
> 标签：ios, uinavigationcontroller, storyboard

我在导航控制器中嵌入了三个场景。

场景 1：从用户那里获取输入，验证它是否大于 0，并启用一个使用 push segue 推入场景 2 的按钮。

场景 2：取决于第一个场景中的值（比如“n”），用户必须使用“下一个”UIButton 移动几个滑块“n”次。当计数器达到 n 时，启用另一个 UIButton 'submit' 以供用户使用 push segue 推入场景 3。

场景 3：显示场景 2 的值。有一个“重新开始”按钮，使用 push segue 进入场景 1。

但是，现在当我在场景 1 中时，有返回按钮，用户可以从该按钮返回场景 3。如何防止这种情况发生？

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:15:45.433

而不是*按下*第一个控制器，“重新开始”按钮应该*弹出*到第一个控制器。

# mysql - 将句点保留在首字母缩写词中还是不在数据库中？

> ID：14674445
> 
> 赞同：1
> 
> 时间：2013-02-03T16:10:19.660
> 
> 标签：mysql, regex

首字母缩略词在我的数据库中很痛苦，尤其是在进行搜索时。我还没有决定是否应该在搜索查询期间接受句点。这些是我在搜索时遇到的问题：

*   'IRQ' 不会找到 'IRQ'
*   'IRQ' 不会找到 'IRQ'
*   “中断请求。” 或“IR.Q”将找不到“IRQ”或“IRQ”

ETC...

同样的问题也适用于省略号 (...) 或三个系列的句点。

我只需要知道我应该采取什么方向来解决这个问题：

*   将字符串插入数据库时​​删除所有句点会更好吗？
*   如果是这样，我可以使用什么正则表达式来识别句点（而不是椭圆或三个系列的句点）来识别需要删除的内容？
*   如果可以将句点保留在首字母缩略词中，如果我在搜索字段中输入“IRQ”，如何在查询中编写脚本以查找“IRQ”，通过 MySQL 使用正则表达式或我不知道的 MySQL 函数?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:27:21.233

我对每个问题的回答：

*   **将字符串插入数据库时​​删除所有句点会更好吗？**

是和不是。您希望数据库具有原始文本。如果需要，请创建一个单独的“清理”字段以进行搜索。在这里，您可以删除句点，将所有内容设为小写等。

*   **如果是这样，我可以使用什么正则表达式来识别句点（而不是椭圆或三个系列的句点）来识别需要删除的内容？**

    /\.+/

这会在给定位置找到一个或多个周期。但是您需要将其与您的搜索公式集成。

注意：数据库上的正则表达式并不具有高性能。对此要谨慎。

其他注意事项：您可能希望在 MySQL 中使用全文搜索。这也不知道对超过 1000 个条目的数据集具有高性能。如果您有大数据并且需要全文搜索，请使用 Sphinx（作为 MySQL 插件和基于 RAM 的索引系统提供）。

*   **如果可以将句点保留在首字母缩略词中，如果我在搜索字段中输入“IRQ”，如何在查询中编写脚本以查找“IRQ”，通过 MySQL 使用正则表达式或我不知道的 MySQL 函数?**

是的，通过我在第一个项目符号的答案中描述的 2 个字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T16:25:07.320

您需要考虑输入的神圣性。如果改变不是你的，那就不要改变它。相反，您应该有一个单独的系统来允许文本搜索，并且*可以*根据它认为合适的方式更改文本，以便能够处理这些类型的问题。

阅读 Lucene，特别是 Lucene 的标准分析器，了解通常执行的更改类型以允许成功搜索复杂文本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T16:25:50.313

我认为您可以使用`REGEXP`MySQL 的功能来发送首字母缩写词：

```
SELECT col1, col2...coln FROM yourTable WHERE colWithAcronym REGEXP "#I\.?R\.?Q\.?#" 
```

如果你使用 PHP，你可以通过这个简单的循环来构建你的正则表达式：

```
$result = "#";
foreach($yourAcronym as $char){
    $result.=$char."\\.?";
}
$result.="#"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-03T16:25:54.497

您正在搜索的功能是全文搜索。Mysql 支持 myisam 表，但不支持 innodb。（[http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)）

或者，您可以选择提供该功能的外部框架。Lucene 是一种流行的开源软件。( [lucene.apache.org](http://lucene.apache.org) )

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-03T16:27:28.273

会有2种方法，

```
1\. save data -removing symbols from text and match accordingly,
2\. you can make a regex ,like this for eg.

select * from table where acronym regexp '^[A-Z]+[.]?[A-Z]+[.]?[A-Z]+[.]?$'; 
```

Please note, however, that this requires the acronym to be stored in uppercase. If you don't want the case to matter, just change [A-Z] to [A-Za-z].

# android - 如果应用程序崩溃一次，我无法启动应用程序，除非我重新启动我的 Android 手机

> ID：14674446
> 
> 赞同：0
> 
> 时间：2013-02-03T16:10:21.843
> 
> 标签：android, logcat, android-debug

我正在我的 HTC Desire HD 上开发适用于 Android 的应用程序；有时在应用程序开发过程中，应用程序由于某种原因而崩溃。

但是一旦它崩溃，它无论如何都不会启动，唯一的解决方案是重新启动我的设备。

*   我尝试使用 Ctrl+f11 再次运行它
*   我什至尝试从设备卸载程序中卸载该应用程序。
*   甚至使用`adb uninstall 'com.example.www'`成功的卸载来卸载它。

它不显示任何类型的日志消息`logcat`，仅此而已`killProcess, pid=xxxx`

你能提供一个解决方案吗？由于我的设备需要 5 分钟才能重新启动，并且随着应用程序变得复杂，它的崩溃甚至更多。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:18:22.487

您可以在 Eclipse 的 DDMS 透视图中查看可以调试的所有正在运行的进程：![在此处输入图像描述](../Images/c495522a4c81d458db4e58cb210547fb.png)

检查您的应用程序是否正在运行，如果是，您可以通过单击屏幕截图附近的停止按钮来停止它。

或者，如果您有 SU 权限，您可以使用进程 ID 在 shell 中终止进程：

```
adb shell
su
pkill #pid 
```

# css - 如何修复单行文本下的额外边距（仅在 Firefox 中）？

> ID：14674455
> 
> 赞同：0
> 
> 时间：2013-02-03T16:11:14.417
> 
> 标签：css, firefox, margin

我有一个表格，里面有一个只包含文本的单元格。除了[reset.css](http://meyerweb.com/eric/tools/css/reset/)、&和之外，此单元格及其父级`tr`和标签上没有应用任何样式，以便您清楚地看到问题。如果单元格内只有一行文本，Firefox 会添加一些我不想要的额外边距。`table``vertical-align: top``td``tr``border-bottom: 1px solid black`

![Firefox 中的边距](../Images/45879b8f00ea36ab715d3f3e2803ec5f.png)

在 Chrome 中，情况并非如此。

（如何）我可以在 Firefox 中解决这个问题而不会在 Chrome 中搞砸吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:54:48.073

我刚刚通过将`vertical-align`我的 reset.css 副本中的所有项目上的 更改为`baseline`来解决了这个问题`top`。即使`td`and`tr`标记已经`vertical-align`设置为，这似乎也是必要的`top`。

# javascript - 如何在 JavaScript 中结合按键和点击功能？

> ID：14674456
> 
> 赞同：14
> 
> 时间：2013-02-03T16:11:29.063
> 
> 标签：javascript, jquery

我有以下两个功能：

```
$("input").keypress(function(event) {
   if (event.which == 13) {
   //code        
   }       
});

$('#login_submit').click(function () {        
   //code                    
}); 
```

函数中使用的代码完全相同，基本上是代码复制。所以我想知道是否有办法将这些函数与 OR 语句结合起来？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-03T16:14:20.620

创建您自己的回调并将其传递给事件处理程序。

```
var callback = function() {...};

$("input").keypress(function() {
    if (event.which == 13) callback();
});

$('#login_submit').click(callback); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-03T16:21:35.417

向您的 HTML 添加一个类

```
<input class="myClass">
<div id="login_submit" class="myClass" ></div> 
```

现在你可以写：

```
$(".myClass").bind("keypress click", function(){}); 
```

或者这样做：

```
$("input").add("#login_submit").bind("keypress click", function(){}); 
```

请注意，单击输入也会触发此操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-03T16:14:44.550

你为什么不这样做呢？

```
$("input").keypress(function(event) {
    if (event.which == 13) {
        foospace.yourfunction();
    }       
});

$('#login_submit').click(function () {        
    foospace.yourfunction();                    
});

var foospace={}; 
foospace.yourfunction=function() { 
    alert("your code goes here!"); 
} 
```

**编辑：**

@David 的回调解决方案稍微优雅一些​​。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-05T09:57:20.580

我会像这样链接事件：

```
 var watchCurrentCursorPosition = function (){
            console.log("foo");
        }
        $("input").keypress(
            watchCurrentCursorPosition

        ).click(
            watchCurrentCursorPosition
        ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-01T21:00:34.877

对于那些仍在寻找@Sino 问题答案的人。

> 函数中使用的代码完全相同，基本上是代码复制。所以我想知道是否有办法将这些函数与 OR 语句结合起来？

JQuery [.on()](http://api.jquery.com/on/)方法是要走的路。

> **描述：将一个或多个事件**的事件处理函数附加到选定元素。

所以你的代码可以是这样的：

```
$("input").on("click keypress", function(event) {
  if (event.which === 13) {
    event.preventDefault();
    //code        
  }       
}); 
```

# opengl - GLFW、GLEW 和“我的班级”问题

> ID：14674460
> 
> 赞同：0
> 
> 时间：2013-02-03T16:11:50.143
> 
> 标签：opengl, glew, glfw

我正在使用`GLFW`（静态链接库 - `glfw.lib`）并`GLEW`在我的项目中，但现在我遇到了一个问题：
我编写了一个最简单的`GLFW`程序（`glfwInit()`, `glfwOpenWindow()`, ..., ），除了打开一个黑色窗口、调用和主循环`glewInit()`之外什么都不做`glewInit()`只有`glfwSwapBuffers()`，然后它运行正常。但是当我为加载着色器添加一个类（`cshader.h`, `cshader.cpp`）时（类中没有特殊内容，没有静态变量，没有静态方法，还没有创建任何实例，所以，我只将两个文件拖放到 Visual Studio 工作空间窗口中） ，然后重新构建，然后按`F5`，Visual Studio 显示`sfs.exe has triggered a breakpoint.`消息并在`msvcr110d.dll!_CrtIsValidHeapPointer(const void * pUserData) Line 2036 C++`. 但如果我改成`Release`这样就好了。

我的调用堆栈是：

```
msvcr110d.dll!_CrtIsValidHeapPointer(const void * pUserData) Line 2036  C++
msvcr110d.dll!_free_dbg_nolock(void * pUserData, int nBlockUse) Line 1322   C++
msvcr110d.dll!_free_dbg(void * pUserData, int nBlockUse) Line 1265  C++
msvcr110d.dll!free(void * pUserData) Line 49    C++
sfs.exe!__glfwPlatformWaitEvents()  Unknown
sfs.exe!__glfwPlatformWaitEvents()  Unknown
sfs.exe!__glfwPlatformOpenWindow()  Unknown
sfs.exe!_glfwOpenWindow()   Unknown
sfs.exe!main(int argc, char * * argv) Line 54   C++ 
```

是的，我对这个问题一无所知，我还没有创建任何类实例，我的类只有加载着色器、链接程序、使用、释放着色器、设置统一的一些方法。谁能帮我这个？

**更新：**我的`cshader.h`和`cshader.cpp`是：

```
// cshader.h
#ifndef __CShader_h__
#define __CShader_h__

#include <iostream>
#include <fstream>
#include <sstream>
#include <GL/gl.h>

class CShader
{
protected:
  GLuint m_FragmentShader;
  GLuint m_VertexShader;
  GLuint m_Program;

  bool readTextFile(const char *name, std::string& text);
  GLuint createShader(const char *name, GLenum type);

public:
  CShader();
  CShader(const char *vertex, const char *fragment);
  ~CShader();

  bool loadVertexShader(const char *vertex);
  bool loadFragmentShader(const char *fragment);
  bool link();
  void use();
  void end();
  GLint getUniformLocation(const char *name);
  GLint getAttribLocation(const char *name);
  void uni4x4Matrix(const char *name, float *matrix);
  void uni1i(const char *name, GLuint value);

  void enableAttrib(const char *name);
  void enableAttrib(GLint attrib);

  void disableAttrib(const char *name);
  void disableAttrib(GLint attrib);
};

#endif /* __CShader_h__ */

// cshader.cpp
#include <gl/glew.h>
#include "cshader.h"

bool CShader::readTextFile(const char *name, std::string& text) {
  std::ifstream in;

  in.open(name, std::ios::in);
  if (in.fail()) {
    std::cout << "CShader::readTextFile(\"" << name << "\") false" << std::endl;
    return false;
  }

  std::ostringstream data;
  data << in.rdbuf();
  text = data.str();
  in.close();

  return true;
}

GLuint CShader::createShader(const char *name, GLenum type) {
  std::string text, shader_type;
  const char *source;
  GLuint shader;

  switch(type) {
  case GL_VERTEX_SHADER:
    shader_type = "GL_VERTEX_SHADER";
    break;

  case GL_FRAGMENT_SHADER:
    shader_type = "GL_FRAGMENT_SHADER";
    break;

  default:
    shader_type = "UNKNOW_SHADER";
  }

  if (!readTextFile(name, text)) return 0;
  source = text.c_str();

  shader = glCreateShader(type);
  glShaderSource(shader, 1, &source, 0);
  glCompileShader(shader);

  GLint is_compiled;
  glGetShaderiv(shader, GL_COMPILE_STATUS, &is_compiled);
  if (GL_FALSE == is_compiled) {
    std::cout << "CShader::createShader(): Compile " << shader_type << " (" << name << ") error:" << std::endl;
    int errLen, errRet;
    glGetShaderiv(shader, GL_INFO_LOG_LENGTH, &errLen);

    char *errMsg = new char[errLen + 1];
    glGetShaderInfoLog(shader, errLen, &errRet, errMsg);
    std::cout << errMsg << std::endl;
    delete [] errMsg;

    glDeleteShader(shader);
    return 0;
  }

  return shader;
}

CShader::CShader() {
  m_FragmentShader = 0;
  m_VertexShader = 0;
  m_Program = 0;
}

CShader::CShader(const char *vertex, const char *fragment) {
  m_FragmentShader = 0;
  m_VertexShader = 0;
  m_Program = 0;

  loadVertexShader(vertex);
  loadFragmentShader(fragment);
}

CShader::~CShader() {
  if (m_Program > 0) {
    glDetachShader(m_Program, m_VertexShader);
    glDetachShader(m_Program, m_FragmentShader);
    glDeleteProgram(m_Program);
  }

  if (m_VertexShader > 0) glDeleteShader(m_VertexShader);
  if (m_FragmentShader > 0) glDeleteShader(m_FragmentShader);
}

bool CShader::loadVertexShader(const char *vertex) {
  if (m_VertexShader > 0) glDeleteShader(m_VertexShader);

  m_VertexShader = createShader(vertex, GL_VERTEX_SHADER);
  return (m_VertexShader > 0) ? (true) : (false);
}

bool CShader::loadFragmentShader(const char *fragment) {
  if (m_FragmentShader > 0) glDeleteShader(m_FragmentShader);

  m_FragmentShader = createShader(fragment, GL_FRAGMENT_SHADER);
  return (m_FragmentShader > 0) ? (true) : (false);
}

bool CShader::link() {
  if (m_VertexShader <= 0 || m_FragmentShader <= 0) return false;
  if (m_Program > 0) {
    std::cout << "Program have already linked!" << std::endl;
    return false;
  }

  m_Program = glCreateProgram();
  glAttachShader(m_Program, m_VertexShader);
  glAttachShader(m_Program, m_FragmentShader);
  glLinkProgram(m_Program);

  GLint is_Linked;
  glGetProgramiv(m_Program, GL_LINK_STATUS, &is_Linked);
  if (GL_FALSE == is_Linked) {
    std::cout << "CShader::link() got error:" << std::endl;

    int errLen, errRet;
    glGetProgramiv(m_Program, GL_INFO_LOG_LENGTH, &errLen);

    char * errMsg = new char[errLen + 1];
    glGetProgramInfoLog(m_Program, errLen, &errRet, errMsg);
    std::cout << errMsg << std::endl;
    delete [] errMsg;

    glDetachShader(m_Program, m_VertexShader);
    glDetachShader(m_Program, m_FragmentShader);
    glDeleteProgram(m_Program);
    m_Program = 0;
    return false;
  }

  return true;
}

void CShader::use() {
  if (m_Program <= 0) {
    std::cout << "CShader::use(): Program not ready!" << std::endl;
    return;
  }

  glUseProgram(m_Program);
}

void CShader::end() {
  glUseProgram(0);
}

GLint CShader::getUniformLocation(const char *name) {
  if (m_Program <= 0) return -1;
  return glGetUniformLocation(m_Program, name);
}

GLint CShader::getAttribLocation(const char *name) {
  if (m_Program <= 0) return -1;
  return glGetAttribLocation(m_Program, name);
}

void CShader::uni4x4Matrix(const char *name, float *matrix) {
  GLint matLoc = getUniformLocation(name);
  if (matLoc >= 0) {
    glUniformMatrix4fv(matLoc, 1, GL_FALSE, matrix);
  } else {
    std::cout << "CShader::uni4x4Matrix(): " << name << " uniform not found!" << std::endl;
  }
}

void CShader::uni1i(const char *name, GLuint value) {
  GLint matLoc = getUniformLocation(name);
  if (matLoc >= 0) {
    glUniform1i(matLoc, value);
  } else {
    std::cout << "CShader::uni1i(): " << name << " uniform not found!" << std::endl;
  }
}

void CShader::enableAttrib(const char *name) {
  GLint attribLoc = getAttribLocation(name);
  if (attribLoc < 0) {
    std::cout << "CShader::enableAttrib(): " << name << " attrib not found!" << std::endl;
  } else {
    enableAttrib(attribLoc);
  }
}

void CShader::enableAttrib(GLint attrib) {
  glEnableVertexAttribArray(attrib);
}

void CShader::disableAttrib(const char *name) {
  GLint attribLoc = getAttribLocation(name);
  if (attribLoc < 0) {
    std::cout << "CShader::disableAttrib(): " << name << " attrib not found!" << std::endl;
  } else {
    disableAttrib(attribLoc);
  }
}

void CShader::disableAttrib(GLint attrib) {
  glDisableVertexAttribArray(attrib);
} 
```

`main.cpp`：

```
#include <iostream>
#include <gl/glew.h>
#include "cshader.h"

#include <gl/glfw.h>

#pragma comment(lib, "glfw.lib")
#pragma comment(lib, "opengl32.lib")
#pragma comment(lib, "glew32.lib")

using namespace std;

void GLFWCALL reshape(int w, int h)
{
}

void display()
{

}

bool init()
{

    return true;
}

int main(int argc, char *argv[])
{
    if (glfwInit() != GL_TRUE) {
        cout << "glfwInit() return false!" << endl;
        cin.get();
        return -1;
    }

    glfwOpenWindowHint(GLFW_WINDOW_NO_RESIZE, GL_TRUE);
    if(glfwOpenWindow(640, 480, 0, 0, 0, 0, 16, 1, GLFW_WINDOW) != GL_TRUE) {
        cout << "Open window fail!" << endl;
        glfwTerminate();
        return -1;
    }

    if (glewInit() != GLEW_OK) {
        cout << "load opengl functions failed!" << endl;
        glfwTerminate();
        return -1;
    }

    glfwSetWindowTitle("Shadow from scratch...");
    if (!init()) {
        cout << "init() return false!" << endl;
        glfwTerminate();
        return -1;
    }

    glfwSetWindowSizeCallback(&reshape);
    reshape(640, 480);

    bool running = true;
    while (running) {
        display();
        glfwSwapBuffers();

        running = !glfwGetKey(GLFW_KEY_ESC) && glfwGetWindowParam(GLFW_OPENED);
    }

    glfwTerminate();
    return 0;
} 
```

**更新 2：**我已更改为`glLoadGen`加载 OpenGL 扩展，但问题仍然存在...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T04:42:30.200

我遇到了同样的问题，但它现在可以通过解决以下警告来工作。 [如何防止宏重新定义](https://stackoverflow.com/questions/3927810/how-to-prevent-macro-redefinition) 我希望它对你有用。

# mysql - PostgreSQL 中的 MySQL SET 类型？

> ID：14674461
> 
> 赞同：3
> 
> 时间：2013-02-03T16:11:51.880
> 
> 标签：mysql, database, postgresql, database-migration, sqldatatypes

我正在尝试使用`MySQL` [SET](http://dev.mysql.com/doc/refman/5.6/en/set.html)类型`PostgreSQL`，但我发现只有数组，它具有非常相似的功能但不符合要求。

是否`PostgreSQL`有类似的数据类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T08:22:12.363

您可以使用以下解决方法：

# 1\. [BIT字符串](http://www.postgresql.org/docs/9.2/static/datatype-bit.html)

您可以简单地定义一组最大 N 个元素`BIT(N)`。填充和检索有点尴尬 - 您必须使用位掩码作为集合成员。但是位串真的很适合[集合操作](http://www.postgresql.org/docs/9.2/static/functions-bitstring.html)：交集很简单`&`，并集很简单`|`。

这种类型的存储非常有效 - 每位每位的长度开销很小。

此外，长度不受限制也很好（但您必须提前决定）。

# 2\. [HSTORE](http://www.postgresql.org/docs/9.2/static/hstore.html)

`HSTORE`type 是一个扩展，但是很容易安装。简单地执行

```
CREATE EXTENSION hstore 
```

对于大多数安装 (9.1+) 将使其可用。有传言说 PostgreSQL 9.3 将`HSTORE`作为标准类型。

它不是真正的集合类型，而是更像 Perl 哈希或 Python 字典：它保留任意的`key`=>`value`对集合。

这样，它不是很有效（当然不是 BIT 字符串有效），但它确实提供了集合所必需的函数：`||`对于并集，但交集有点尴尬：使用

```
slice(a,akeys(b)) || slice(b,akeys(a)) 
```

[您可以在此处](http://www.postgresql.org/docs/9.2/static/hstore.html)阅读有关 HSTORE的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T02:08:17.647

基于上面 a_horse_with_no_name 的答案，我建议稍微复杂一点：

```
 CREATE FUNCTION set_check(in_value anyarray, in_check anyarray)
 RETURNS BOOL LANGUAGE SQL IMMUTABLE AS
 $$
    WITH basic_check AS (
         select bool_and(v = any($2)) as condition, count(*) as ct 
              FROM unnest($1) v
          GROUP BY v
    ), length_check AS (
         SELECT count(*) = 0 as test FROM unnest($1)
    )
    SELECT bool_and(condition AND ct = 1)
      FROM basic_check
     UNION
    SELECT test from length_check where test;

 $$; 
```

然后你应该能够做类似的事情：

```
 CREATE TABLE set_test (
       my_set text[] CHECK (set_check(my_set, array['one'::text,'two']))
 ); 
```

这有效：

```
postgres=# insert into set_test values ('{}');
INSERT 0 1
postgres=# insert into set_test values ('{one}');
INSERT 0 1
postgres=# insert into set_test values ('{one,two}');
INSERT 0 1
postgres=# insert into set_test values ('{one,three}');
ERROR:  new row for relation "set_test" violates check constraint "set_test_my_set_check"
postgres=# insert into set_test values ('{one,one}');
ERROR:  new row for relation "set_test" violates check constraint "set_test_my_set_check" 
```

请注意，这假设对于您的集合，每个值都必须是唯一的（我们在这里讨论集合）。该功能应该执行得非常好并且应该满足您的需求。然而，这具有处理任何尺寸集的优势。

存储方面它与 MySQL 的实现完全不同。它将占用更多磁盘空间，但应该处理具有尽可能多的成员的集合，前提是您没有遇到存储限制......所以与 MySQL 的实现相比，它应该具有超集的功能。但是，一个显着的区别是这不会*将*数组折叠成不同的值。它只是禁止他们。如果您也需要，请查看触发器。

此解决方案还保持输入数据的序数不变，因此 '{one,two}' 与 '{two,one}' 不同，因此如果您需要确保行为已更改，您可能需要查看 PostgreSQL 9.2 上的排除约束.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-04T08:47:21.877

带有检查约束的数组怎么样：

```
create table foobar 
(
  myset text[] not null,
  constraint check_set 
      check ( array_length(myset,1) <= 2 
             and (myset = array[''] or 'one'= ANY(myset) or 'two' = ANY(myset))
            )
); 
```

这将匹配`SET('one', 'two')`MySQL 手册中解释的定义。

唯一**不会**做的就是“标准化”数组。所以

```
insert into foobar values (array['one', 'two']); 
```

和

```
insert into foobar values (array['two', 'one']); 
```

显示方式与 MySQL 不同（两者都显示为`'one','two'`）

但是，检查约束会因超过 3 或 4 个元素而变得混乱。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-03T16:29:08.097

您在寻找枚举数据类型吗？

[PostgreSQL 9.1 枚举类型](http://www.postgresql.org/docs/9.1/static/datatype-enum.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-03T17:38:10.543

从阅读问题中引用的页面来看，似乎 SET 是一种在一列中存储多达 64 个命名布尔值的方法。PostgreSQL 没有提供这样做的方法。您可以使用独立的布尔列，或某种大小的整数并直接旋转位。添加两个新表（一个用于有效名称，另一个用于将名称连接到详细信息行）可能是有意义的，尤其是在可能需要将任何其他数据与单个值相关联的情况下。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-03T20:19:55.430

前段时间我写了一个类似的扩展

[https://github.com/okbob/Enumset](https://github.com/okbob/Enumset)

但它并不完整

pltoolkit 的一些更完整和更接近 mysql 的功能

[http://okbob.blogspot.cz/2010/12/bitmapset-for-plpgsql.html](http://okbob.blogspot.cz/2010/12/bitmapset-for-plpgsql.html) [http://pgfoundry.org/frs/download.php/3203/pltoolbox-1.0.2.tar.gz](http://pgfoundry.org/frs/download.php/3203/pltoolbox-1.0.2.tar.gz) [http:// postgres.cz/wiki/PL_toolbox_%28en%29](http://postgres.cz/wiki/PL_toolbox_%28en%29)

函数 find_in_set 可以通过数组来模拟

[http://okbob.blogspot.cz/2009/08/mysql-functions-for-postgresql.html](http://okbob.blogspot.cz/2009/08/mysql-functions-for-postgresql.html)

# linux - 为什么 perf 不报告缓存未命中？

> ID：14674463
> 
> 赞同：39
> 
> 时间：2013-02-03T16:12:05.133
> 
> 标签：linux, caching, optimization, profiling, perf

根据[perf tutorials](https://perf.wiki.kernel.org/index.php/Tutorial)，`perf stat`应该使用硬件计数器报告缓存未命中。但是，在我的系统（最新的 Arch Linux）上，它没有：

```
[joel@panda goog]$ perf stat ./hash

 Performance counter stats for './hash':

    869.447863 task-clock                #    0.997 CPUs utilized          
            92 context-switches          #    0.106 K/sec                  
             4 cpu-migrations            #    0.005 K/sec                  
         1,041 page-faults               #    0.001 M/sec                  
 2,628,646,296 cycles                    #    3.023 GHz                    
   819,269,992 stalled-cycles-frontend   #   31.17% frontend cycles idle   
   132,355,435 stalled-cycles-backend    #    5.04% backend  cycles idle   
 4,515,152,198 instructions              #    1.72  insns per cycle        
                                         #    0.18  stalled cycles per insn
 1,060,739,808 branches                  # 1220.015 M/sec                  
     2,653,157 branch-misses             #    0.25% of all branches        

   0.871766141 seconds time elapsed 
```

我错过了什么？我已经搜索了手册页和网络，但没有发现任何明显的东西。

编辑：如果重要的话，我的 CPU 是 Intel i5 2300K。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-02-03T17:07:04.240

在我的系统上，`Intel Xeon X5570 @ 2.93 GHz`我能够`perf stat`通过像这样明确地请求这些事件来报告缓存引用和未命中

```
perf stat -B -e cache-references,cache-misses,cycles,instructions,branches,faults,migrations sleep 5
Performance counter stats for 'sleep 5':

         10573 cache-references                                            
          1949 cache-misses              #   18.434 % of all cache refs    
       1077328 cycles                    #    0.000 GHz                    
        715248 instructions              #    0.66  insns per cycle        
        151188 branches                                                    
           154 faults                                                      
             0 migrations                                                  

   5.002776842 seconds time elapsed 
```

默认事件集不包括缓存事件，匹配你的结果，不知道为什么

```
perf stat -B sleep 5

Performance counter stats for 'sleep 5':

      0.344308 task-clock                #    0.000 CPUs utilized          
             1 context-switches          #    0.003 M/sec                  
             0 CPU-migrations            #    0.000 M/sec                  
           154 page-faults               #    0.447 M/sec                  
        977183 cycles                    #    2.838 GHz                    
        586878 stalled-cycles-frontend   #   60.06% frontend cycles idle   
        430497 stalled-cycles-backend    #   44.05% backend  cycles idle   
        720815 instructions              #    0.74  insns per cycle        
                                         #    0.81  stalled cycles per insn
        152217 branches                  #  442.095 M/sec                  
          7646 branch-misses             #    5.02% of all branches        

   5.002763199 seconds time elapsed 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-11-30T12:10:26.883

在[最新的源码](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/tools/perf/builtin-stat.c?id=refs/tags/v4.3#n975)中，默认事件不包括`cache-misses`和`cache-references`再次：

```
struct perf_event_attr default_attrs[] = {

  { .type = PERF_TYPE_SOFTWARE, .config = PERF_COUNT_SW_TASK_CLOCK      },
  { .type = PERF_TYPE_SOFTWARE, .config = PERF_COUNT_SW_CONTEXT_SWITCHES    },
  { .type = PERF_TYPE_SOFTWARE, .config = PERF_COUNT_SW_CPU_MIGRATIONS      },
  { .type = PERF_TYPE_SOFTWARE, .config = PERF_COUNT_SW_PAGE_FAULTS     },

  { .type = PERF_TYPE_HARDWARE, .config = PERF_COUNT_HW_CPU_CYCLES      },
  { .type = PERF_TYPE_HARDWARE, .config = PERF_COUNT_HW_STALLED_CYCLES_FRONTEND },
  { .type = PERF_TYPE_HARDWARE, .config = PERF_COUNT_HW_STALLED_CYCLES_BACKEND  },
  { .type = PERF_TYPE_HARDWARE, .config = PERF_COUNT_HW_INSTRUCTIONS        },
  { .type = PERF_TYPE_HARDWARE, .config = PERF_COUNT_HW_BRANCH_INSTRUCTIONS },
  { .type = PERF_TYPE_HARDWARE, .config = PERF_COUNT_HW_BRANCH_MISSES       },

}; 
```

所以到目前为止，这个人和大多数网络都已经过时了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-03T16:58:11.763

我花了几分钟试图理解`perf`。我通过首先记录然后报告数据（两种`perf`工具）来发现缓存未命中。

要查看事件列表：

```
perf list 
```

例如，为了检查最后一级缓存加载未命中，您需要使用这样的`LLC-loads-misses`事件

```
perf record -e LLC-loads-misses ./your_program 
```

然后报告结果

```
perf report -v 
```

# javascript - 使用 javascript 启用/禁用嵌套表单字段

> ID：14674467
> 
> 赞同：0
> 
> 时间：2013-02-03T16:12:34.057
> 
> 标签：javascript, ruby-on-rails

我有一个带有复选框和文本字段的嵌套表单。我希望能够仅在单击/启用该特定嵌套表单的文本框时启用文本字段。如果设置了“自定义”文本框，当前是硬编码来启用/禁用字段。如何让 javascript 即时更新这些文本框属性？

现在形成.erb

```
<%= simple_nested_form_for @client do |f| %>
  <%= f.fields_for :client_prices do |def_price_form| %>
  <div class="controls controls-row">
    <div class='span10'>
      <% if def_price_form.object.custom == true  %>
        <%= def_price_form.input :custom, :wrapper_html => { :class => 'span1' } %>
        <% end %>
        <%= def_price_form.input :visit_type, :wrapper_html => { :class => 'span2' } %>
        <%= def_price_form.input :price, :wrapper => :prepend, :wrapper_html => { :class => 'span2' }, :label => "Price" do %>
          <%= content_tag :span, "$", :class => "add-on" %>
          <%= def_price_form.input_field :price %>
          <%= def_price_form.link_to_remove '<i class="icon-remove"></i>'.html_safe, :class => 'btn btn-danger', :wrapper_html => { :class => 'span3 pull-left' } %>
          <%end%>
      <% else %>
        <%= def_price_form.input :custom, :hidden => false, :wrapper_html => { :class => 'span1' } %>
        <%= def_price_form.input :visit_type, disabled: true,  :wrapper_html => { :class => 'span2' } %>
        <%= def_price_form.input :price, :wrapper => :prepend, :wrapper_html => { :class => 'span2' }, :label => "Price" do %>
          <%= content_tag :span, "$", :class => "add-on" %>
          <%= def_price_form.input_field :price, disabled: true %>
          <%end%>
      <%end%>
    </div>
  </div>
  <% end %>
  <%= f.link_to_add "Add a custom price", :client_prices, :class => 'btn btn-success' %>
  <p>&nbsp;</p>
  <div class="controls">
    <%= f.button :submit, :class => 'btn btn-primary' %>
  </div>
<% end %> 
```

此处由 RoR 生成的 HTML [http://jsfiddle.net/59AXJ/](http://jsfiddle.net/59AXJ/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T03:51:35.237

这会从单击的复选框中获取属性名称。然后找到具有相似名称的输入，这些是我们将切换为“禁用”的输入。

```
$("input[type='checkbox']").click(function () {
    var thisCheckbox = $(this);
    var id = $(this).attr("id");
    var text = $("label[for=" + id + "]").text().toLowerCase();
    var name = $(this).attr("name").replace("[" + text + "]", "");
    $("input[name*='" + name + "']").each(function () {
        var thisInput = $(this);
        if (thisInput.attr("disabled")) {
            thisInput.removeAttr("disabled");
        } else {
            thisInput.attr("disabled", "disabled");
            thisCheckbox.removeAttr("disabled");
        }
    })
}); 
```

[http://jsfiddle.net/Sbw65/](http://jsfiddle.net/Sbw65/) <-- 测试一下

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T18:25:46.780

据我所知，这是不可能的，但你可以在 javascript 上编写一些独特的函数，它会通过他们的 css 类将一些输入与一些复选框连接起来。像这样的东西（CoffeeScript 上的代码）：

```
changeCheckbox: (class_value) =>
  $('[type=checkbox] '+class_value)). on 'check', (e) ->
    $input = $(e.currentTarget)
      if !$input.prop("checked")
        $("input "+class_value).prop('disabled', false)
      else
        $("input "+class_value).prop('disabled', true) 
```

之后，您只需要为连接的复选框和输入添加一些类。

# sql-server - 使用进程时间限制中止 SQL 查询

> ID：14674469
> 
> 赞同：6
> 
> 时间：2013-02-03T16:12:39.260
> 
> 标签：sql-server, delphi, ado

我可以使用 DELPHI、dbgo DB 组件和 SQL Server 数据库服务器编写 SQL 查询吗？

像

```
select * from table where ...... 
```

和`process_time_limit = 5 sec`？

最好在时间限制内给我 10% 的行，而不是等待几个小时才能获得完整的查询数据集

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T16:32:29.377

***ADO 组件：***

我会尝试异步数据获取。当您执行查询时，您会记住您何时开始以及每次[`OnFetchProgress`](http://docwiki.embarcadero.com/Libraries/XE2/en/Data.Win.ADODB.TCustomADODataSet.OnFetchProgress)事件触发时，您将检查是否[`EventStatus`](http://docwiki.embarcadero.com/Libraries/XE2/en/Data.Win.ADODB.TEventStatus)仍处于`esOK`状态并检查查询执行后经过的时间。如果它过去了，您可以使用数据集上的方法取消数据提取[`Cancel`](http://docwiki.embarcadero.com/Libraries/XE2/en/Data.DB.TDataSet.Cancel)。

我的意思是使用类似以下（未经测试）的伪代码：

```
var
  FQueryStart: DWORD;

procedure TForm1.FormCreate(Sender: TObject);
begin
  // configure the asynchronous data fetch for dataset
  ADOQuery1.ExecuteOptions := [eoAsyncExecute, eoAsyncFetchNonBlocking];
end;

procedure TForm1.Button1Click(Sender: TObject);
begin
  // store the query execution starting time and execute a query
  FQueryStart := GetTickCount;
  ADOQuery1.SQL.Text := 'SELECT * FROM Table';
  ADOQuery1.Open;
end;

procedure TForm1.ADOQuery1FetchProgress(DataSet: TCustomADODataSet; Progress,
  MaxProgress: Integer; var EventStatus: TEventStatus);
begin
  // if the fetch progress is in esOK (adStatusOK) status and the time since
  // the query has been executed (5000 ms) elapsed, cancel the query
  if (EventStatus = esOK) and (GetTickCount - FQueryStart >= 5000) then
    DataSet.Cancel;
end; 
```

# iphone - 以任何图像分辨率裁剪 UIImage

> ID：14674470
> 
> 赞同：0
> 
> 时间：2013-02-03T16:12:44.557
> 
> 标签：iphone, objective-c, cocoa-touch, uiimage, cgimage

> **可能重复：**
> [裁剪 UIImage](https://stackoverflow.com/questions/158914/cropping-a-uiimage)

我看到了很多关于裁剪图像的教程，并且正在尝试我的运气，但没有成功。

我需要从 AVFoundation 裁剪图像。因为当从相机拍摄图像时，它从肖像模式向左旋转，我还需要向右旋转它，我的 x 和 y 是相反的。问题是，如果我将图像的帧发送到我希望它驻留的位置，在我看来，图像和矩形的大小没有相关性。

代码是：

```
@property (weak, nonatomic) IBOutlet UIView *videoPreviewView;
...
...
int width = videoPreviewView.frame.size.width;
int height = videoPreviewView.frame.size.height;
int x = videoPreviewView.frame.origin.x;
int y = videoPreviewView.frame.origin.y;
CGRect croprect = CGRectMake(y, x,height,width);
// Draw new image in current graphics context
CGImageRef imageRef = CGImageCreateWithImageInRect([sourceImage CGImage], croprect);
// Create new cropped UIImage
UIImage *resultImage = [UIImage imageWithCGImage:imageRef scale:[sourceImage scale] orientation:UIImageOrientationRight]; 
```

当我打印框架的大小时，我得到：

(4.5,69.5,310,310)

图像大小为：

(720,1280)

如何以任何图像分辨率执行裁剪？

我尝试将这些值与`image.scale`- 但是，该值为 1.00

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T05:50:46.010

试试这个。这肯定会帮助你。[https://github.com/barrettj/BJImageCropper](https://github.com/barrettj/BJImageCropper)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T05:19:52.577

```
To resize image, Try this    

    UIImage *image = [UIImage imageNamed:@"image.png"];

    CGSize itemSize = CGSizeMake((your Width), (your Height));
    UIGraphicsBeginImageContext(itemSize);
    CGRect imageRect = CGRectMake(0.0, 0.0, itemSize.width, itemSize.height);
    [image drawInRect:imageRect];

    UIImage * yourCroppedImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

To Crop,

    // Create new image context
    UIGraphicsBeginImageContext(SIZE);

    // Create CGRect for image
    CGRect newRect = CGRectMake(x, y,SIZE.width,SIZE.height);

    // Draw the image into the rect
    [ORIGINALIMAGE drawInRect:newRect];

    // Saving the image, ending image context
    UIImage * newImage = UIGraphicsGetImageFromCurrentImageContext();

    UIGraphicsEndImageContext(); 
```

# php - $obj1->obj2()['something']; 仅适用于本地主机

> ID：14674471
> 
> 赞同：1
> 
> 时间：2013-02-03T16:12:46.413
> 
> 标签：php

这是我正在尝试做的一个例子：

```
<?php echo $Main->GetInfo()['Players'] . '/' . $Main->GetInfo()['MaxPlayers']; ?> 
```

在 Localhost 上，这非常有效。但是，当我将其上传到 Web 服务器时，我收到以下消息：

```
Parse error: syntax error, unexpected '[', expecting ',' or ';' in /usr/www/.../header.php on line 111 
```

为什么会这样？我无法更改`GetInfo()`为，`$GetInfo`因为它会返回未定义。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T16:14:57.010

在 localhost 中，您使用的是 PHP 5.4，而在您的服务器中，版本为 5.3 或更低，因此您不能使用该语法。

更多信息： http: [//php.net/manual/en/migration54.new-features.php](http://php.net/manual/en/migration54.new-features.php)

在 PHP 5.3 中，您应该使用：

```
<?php
$info = $Main->GetInfo();
echo $info['Players'] . '/' . $info['MaxPlayers'];
?> 
```

# javascript - 折叠/展开文本 - 逻辑错误

> ID：14674474
> 
> 赞同：1
> 
> 时间：2013-02-03T16:12:57.580
> 
> 标签：javascript, html

我有这个脚本，当我点击一个按钮时会执行。单击按钮时，下面的文本将折叠，当我再次单击按钮时，文本将被展开并查看。

但是，我想要的恰恰相反。当页面自行加载时，我想隐藏/折叠文本，仅在单击按钮时显示。

我怎样才能做出改变？

JS

```
function toggleMe(a) {
                var e = document.getElementById(a);
                if (!e)
                    return true;
                if (e.style.display == "none") {
                    e.style.display = "block"
                } else {
                    e.style.display = "none"
                }
                return true;
            } 
```

HTML

```
<input type="button" ="return toggleMe('para1')" value="Toggle">
                <br>
                <p id="para1">
                    some text................ </p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:28:11.250

改变

```
 <p id="para1">
to
        <p id="para1" style="display: none"> 
```

这行得通吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T16:28:34.417

为什么不在窗口加载时隐藏文本？

```
window.onload = function() {

    document.getElementById("para1").style.display = "none";

} 
```

或者你可以输入你的html

```
<p id="para1" style="display: none">
                some text................ 
</p> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T16:28:03.653

```
<html>
<head>
<script>
function toggleMe(a) {
                var e = document.getElementById(a);
                if (!e)
                    return true;
                if (e.style.display == "none") {
                    e.style.display = "block"
                } else {
                    e.style.display = "none"
                }
                return true;
            }
</script>

<body>
<input type="button" onclick="toggleMe('para1')" value="Toggle">
                <br>
                <p id="para1" style="display:none;">
                    some text................ </p>

</body>
</html> 
```

# android - 如何为我的 android 广播应用获取音频流？

> ID：14674475
> 
> 赞同：3
> 
> 时间：2013-02-03T16:13:01.450
> 
> 标签：android, radio

如果我从现有的广播流媒体网站获取流（用于我的 android 应用程序），会导致任何版权问题或任何问题吗？如果是，那么任何人都可以建议不会出现此类问题的网站吗？编辑：我不想要单个电台，而是一个网站，它可以播放一堆非附属电台，比如 radioreference.com

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:45:28.703

我们使用 Shoutcast，他们有超过 50,000 个站点和一个简单的 API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T16:34:47.487

您必须单独查看网站以确定是否需要许可证。

对“免许可广播电台”的快速谷歌搜索产生了这个网站，其中列出了许多免版税电台： `http://tunein.com/radio/Royalty-Free-Music-Radio-s112624/`

但是，看起来即使是免许可的电台也有版权声明，因此您需要单独联系这些电台以获得许可。

另一种做法是让广播电台与您签约，并同意通过您的应用程序广播他们的内容，以此扩大他们的外展范围。

祝你好运！

# iphone - UIButton内存

> ID：14674477
> 
> 赞同：0
> 
> 时间：2013-02-03T16:13:14.270
> 
> 标签：iphone, ios, ios5

我正在创建大约 100 个`uibuttons`，每个都有一个独特的图像（图像是一些 60x70 png 图像）。我的内存有问题。我想在某个时候释放这个内存，此时我已经使用完这个按钮.

我这样设置图像。

```
[button1 setImage:imageButton1  forState:UIControlStateNormal]; 
```

在哪里

```
button1=[UIButton buttonWithType:UIButtonTypeCustom]; 
```

现在我要做的是将uibuttons使用的图像设置为nil，如下所示。

```
[button1 setImage:nil forState:UIControlStateNormal]; 
```

但这样一来，记忆保持不变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:25:35.340

如果你完成了按钮，你能完全摆脱它吗？

```
[button1 removeFromSuperview]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T16:59:55.147

很难成功，当然，问题在于图像对内存的占用。您在哪个设备上测试您的应用程序？
您的图像在视网膜中约为 60x70 像素，我猜是正常显示的一半。您是否在此分辨率中使用它们？也许您可以将它们放大一点。100个按钮意味着您可能正在使用UIScrollview，我建议您使用诸如`UITableView`或`UICollectionView`（仅ios6）之类的东西，它可以重用它们的单元格，并且可以帮助您只为屏幕上的按钮懒惰地加载图像，只显示可见按钮的图像在屏幕上。
希望这可以帮助

# maven - 使用 maven-release-plugin 时，为什么不从本地 repo 中检测 scm 信息？

> ID：14674481
> 
> 赞同：5
> 
> 时间：2013-02-03T16:13:33.933
> 
> 标签：maven, maven-release-plugin, maven-scm-plugin

据我所知，为了使用 maven-release-plugin，您必须将 scm 部分放入您的 POM 文件中。例如：

```
<scm>
    <connection>scm:hg:ssh://hg@bitbucket.org/my_account/my_project</connection>
    <developerConnection>scm:hg:ssh://hg@bitbucket.org/my_account/my_project</developerConnection>
    <url>ssh://hg@bitbucket.org/my_account/my_project</url>
    <tag>HEAD</tag>
</scm> 
```

我了解此数据用于确定要标记的内容以及将更改推送到何处。但是，如果您已克隆/签出代码，这些信息是否已经可用？我对我需要告诉 maven 它需要标记什么代码的概念有点挣扎，至少在理论上，只要问 Git/HG/SVN/CVS 它正在处理什么代码。我怀疑我在细节上遗漏了一些东西，但我不确定是什么。是否可以更改 maven-release-plugin 代码以将其作为要求删除，或者至少将自动检测设为默认值？如果没有，有人可以提供一些关于为什么这不起作用的背景信息吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T11:55:27.503

一方面，GIT 和 Subversion 可以有不同的 SCM URI 用于读写和只读访问。

这就是不同的`<connection>`URI`<developerConnection>`应该捕获的内容。第一个是保证读取访问的 URI。第二个是保证写访问的URI。

很多时候，无法从签出的存储库中推断出规范的 URI。

例如，我可以通过`svn:`协议和服务器的 IP 地址在内部检查 Subversion 存储库，但外部贡献者需要使用`https://`主机名。

甚至使用 GIT 存储库，在 Github 上，您有不同的 URI 用于不同的访问机制，例如

*   `https://github.com/stephenc/eaio-uuid.git`（使用用户名/密码或 OAuth 进行读写）
*   `git@github.com:stephenc/eaio-uuid.git`（读写使用SSH私钥标识）
*   `git://github.com/stephenc/eaio-uuid.git`（匿名只读）

没关系，您可能已经签出`git://github.com/zznate/eaio-uuid.git`或克隆了本地签出，换句话说，您的本地 git 存储库可能是“上游”`../eaio-uuid-from-nate`而不是“上游”`git@github.com:stephenc/eaio-uuid.git`

我同意对于某些 SCM 工具，您可以自动检测...例如，如果您知道源是从 AccuRev 签出的，那么假设它的详细信息应该没问题...直到您点击 Subversion 或 GIT 或 CVS或其他代码模块签出到 AccuRev 工作区（真实故事），以便可以更新被拉入的标签。

所以简而言之，检测代码必须确保您没有同时使用两个 SCM 系统来确定哪个是主 SCM……而另一个 SCM 甚至可能不会将标记文件留在磁盘上嗅出（例如，AccuRev 不...因此我选择了它）

唯一安全的方法是要求 pom 至少定义 SCM 系统，并且对于那些无法可靠推断 URI 的 SCM 系统（想想 CVS、Subversion、GIT、HG，实际上它们中的大多数）需要 URI被指定。

# python - 如何正确管理应用程序配置

> ID：14674487
> 
> 赞同：2
> 
> 时间：2013-02-03T16:14:04.333
> 
> 标签：python, configuration

最通用和最好的应用程序配置管理方法是什么？我想拥有这些属性以便拥有“良好的配置管理”：

*   一个地方的所有可用属性及其默认值的列表。
*   可以由应用程序用户更改的属性列表，也可以在一个地方进行。
*   当我检索特定属性时，它的值将从第二个列表（用户可更改配置）返回，或者如果它不存在，则从第一个列表返回。

到目前为止，我所做的是将第一个列表硬编码为一个对象（更具体为 a `dict`），编写`.conf`用于`ConfigParser`使应用程序用户轻松更改某些属性的文件（第二个列表），并在配置对象以通过其名称检索属性，或者如果它不存在，则引发异常。最后，一个对象负责管理所有的东西（解析文件，引发异常，覆盖属性等）但我想知道，是否有一个内置库或多或少做同样的事情，甚至更好管理配置的方法，它考虑了所有的 KISS、DRY 和其他原则（我并不总是用这种方法成功地做到这一点）？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T22:24:34.257

Create a default settings module which contains your desired default settings. Create a second module intended to be used by the the user with a `from default_settings import *` statement at the top, and instructing the user to write any replacements into this module instead.

Python is rather expressive, so in most cases, if you can expect the user to understand it on any level, you can use a Python module itself as the configuration file.

# angularjs - 使用 Promise 仅获取部分 ajax 响应

> ID：14674488
> 
> 赞同：0
> 
> 时间：2013-02-03T16:14:04.347
> 
> 标签：angularjs

教程和文档展示了这种非常方便的 AJAX 调用语法：

```
$scope.myvar = $resource(/*blah blah*/); 
```

`successfn`如果我的 API 没有返回`myvar`但类似的东西，有没有办法使用这种语法（而不必每次都创建一个新的） `{"myvar": myvar}`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T18:16:16.640

更新：啊，现在我想我得到了你想要的：你想在这样的调用中为返回的对象的一个​​字段提供空引用（占位符）：

```
var User = $resource('/user/:userId', {userId:'@id'}); 
```

我对吗？

如果是这样 - 我认为最简单的方法就是绑定到对象的字段（又名 {{user.myvar}}）。

* * *

好吧，成功函数只被调用一次（如果）数据已经成功接收。该函数以获取的数据作为参数调用，无论其结构如何，您都可以访问它。当然，您可以重用一个函数而不是定义一个内联函数。

所以代替这个（来自Angular docs的例子）：

```
$http({method: 'GET', url: '/someUrl'}).
  success(function(data, status, headers, config) {
    // this callback will be called asynchronously
    // when the response is available
  }).
  error(function(data, status, headers, config) {
    // called asynchronously if an error occurs
    // or server returns response with an error status.
  }); 
```

您可以使用：

```
function myHandler(data) {
     // Do something with data.myvar ...
}

$http({method: 'GET', url: '/someUrl'}).success(myHandler); 
```

希望这会有所帮助，但很可能我没有得到你究竟想要什么:) 让我知道。

[相关文件](http://docs.angularjs.org/api/ng.%24http)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T02:54:20.533

您需要在资源上调用 get() 或 query() 来发出实际的 AJAX 请求。如果您不想将服务器 API 的完整结果直接分配给某个 ($scope) 变量，那么您必须编写成功函数。

```
var SomeResource = $resource('/blah/blah');
var theResource = SomeResource.get({optional params here}, function() {
    $scope.myVar = theResource.myVar;
} 
```

或者

```
var SomeResource = $resource('/blah/blah');
SomeResource.get({optional params here}, function(theResource) {
    $scope.myVar = theResource.myVar;
} 
```

或者按照@Chasseur 的建议进行操作——分配完整结果，然后绑定到您视图中的相应字段：

```
var SomeResource = $resource('/blah/blah');
$scope.theResource = SomeResource.get({optional params here}); 
```

然后在 HTML 中使用`{{theResource.myVar}}`.

此外，与 $http 不同，$resource 不返回承诺。 **更新**：在较新版本的 Angular 中，$resource 现在公开了一个承诺。

# jquery - 由于另一个繁重的操作，asp.net mvc 操作不断超时

> ID：14674491
> 
> 赞同：0
> 
> 时间：2013-02-03T16:14:17.893
> 
> 标签：jquery, ajax, asp.net-mvc

我正在构建一个 asp.net mvc 应用程序。在我的应用程序中，我有一个仪表板，允许运行几个繁重的操作。我还有另一个运行不同轮询请求的 jquery 方法，试图从服务器获取操作的状态。

由于某种原因，控制器中的状态操作不断超时。只有当整个繁重的操作完成后，状态动作才会返回值。我尝试添加一些跟踪，似乎服务器确实处理了请求，但由于某种原因没有做出有效的响应。

可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:17:35.580

ASP.NET 中的默认执行超时为 110 秒。这由以下元素控制：

```
<httpRuntime executionTimeout="110" /> 
```

如果您的操作花费的时间超过此默认超时，ASP.NET 将简单地将其关闭。您可以尝试增加默认值，但请记住，在 ASP.NET 中长时间运行的操作可能是灾难性的，因为在执行此操作期间会危及宝贵的工作线程，从而降低 ASP.NET 应用程序的服务能力。

此外，如果您在此操作中执行 SQL 查询，请记住，如果您有一些冗长的查询，您可能会遇到与 SqlConnection 和 SqlCommand 相关的其他超时。

您应该注意的另一件事是 ASP.NET 会话不是线程安全的。这意味着如果您对同一个 ASP.NET 会话有 2 个并行请求，它们将被序列化并按顺序执行，而不是并行执行。这是设计使然。因此，如果您在操作中使用会话，那么如果您有一个当前正在运行并使用会话的控制器操作，那么来自同一会话的另一个请求将必须等待它完成才能执行，这是完全正常的。

# objective-c - obj-c：无法使用通知更改视图控制器的子视图

> ID：14674495
> 
> 赞同：0
> 
> 时间：2013-02-03T16:14:22.073
> 
> 标签：objective-c

我对以下情况感到困惑。我有一个视图控制器（VC），它有 1 个子视图（SubV）和 1 个其他类。（classA）我还有一个从 classA 调用的事件处理程序，我希望这个事件处理程序在 VC 中更改我的 subV。

当我直接从 VC 访问 SubV 时，没关系，子视图的图像发生了变化等。但是当 classA 触发 VC 的事件处理程序时，它到达 VC，也访问了 subView 的方法，但我的 subView 没有变化！！！（我也尝试委托，但结果是一样的）

视图控制器.h

```
@interface ViewController : UIViewController {
.
IBOutlet SubView *subView;
ClassA *classA;
.
}
@property (retain, nonatomic) IBOutlet SubView *subView;
@property (retain, nonatomic) ClassA *classA; 
```

视图控制器.m

```
- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.
self.subView = [self.subView init];
self.classA = [[ClassA alloc] init];

[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(eventListener:) name:@"eventType" object:nil];

}

- (void) eventListener:(NSNotification *) not
{
   [self.subView RefreshView]; // it doesnt work! calls refreshView method but no change
}

- (IBAction)buttonPressed:(id)sender
{ 
   [self.subView RefreshView]; // it works perfect
} 
```

子视图.h

```
@interface SubView : UIImageView 

@property int state;
@property NSArray *imageArray;

- (void) RefreshView;
- (id) init;

@end 
```

子视图.m

```
- (void) RefreshView{
[self stopAnimating];
self.imageArray = [NSArray arrayWithObjects:[UIImage imageNamed:@"a.png"], nil];
self.animationDuration = 1;   
self.animationImages = self.imageArray;
self.animationRepeatCount = 0;
[self startAnimating];
} 
```

类A.m

```
-(void)methodA{
  [myEvent requestEvent];
} 
```

所以，我在这里要做的是使用 Viewcontroller 中的按钮和在另一个 classA 中运行的线程访问和更改 subView

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:11:59.413

编辑：不太清楚该怎么做。您已根据我提出的更改编辑了您的帖子，使我的回答充其量看起来是多余的，而在最坏的情况下却是疯狂的……

您已将 SubView 类创建为 UIImageView 的子类。但是 IBOutlet *subView 不是 SubView 类的成员，而是 UIImageView 的成员。我怀疑这也可能会延续到 xib/storyboard（？）如果是这样，这意味着您发送到 subView 实例的任何消息都将由库存 UIImageView 而不是您自己的类处理...

```
@property (retain, nonatomic) IBOutlet UIImageView *subView; 
```

应该读

```
@property (retain, nonatomic) IBOutlet SubView *subView; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T12:09:00.317

终于我找到了解决方案！由于我在 ClassA 中运行的线程，我应该使用 '

```
[self performSelectorOnMainThread:@selector(myMethodToRefreshSubView) withObject:nil    waitUntilDone:NO]; 
```

在我的 eventListener 方法中。

# java - 在java中使用.wav格式循环音频文件

> ID：14674496
> 
> 赞同：0
> 
> 时间：2013-02-03T16:14:23.327
> 
> 标签：java, audio, wav, javasound

我正在尝试循环播放音频文件，但是当我尝试了其他各种可用方法时，我的音乐无法播放。

我的基本代码是：

```
import java.io.*;
import sun.audio.*;

public class PlayMusic {

    public void playSound() {
        try {
            AudioPlayer p = AudioPlayer.player;
            AudioStream as = new AudioStream(new FileInputStream("02 River Flows In You.wav"));
            p.start(as);

        } catch (IOException IOE) {
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:55:12.853

我以前从未见过 sun.audio.AudioPlayer 使用过！我一直使用 javax.sound.sampled 库。

也许你可以告诉我你是怎么发现它的。在我看来，它看起来像是相当古老的代码（10 年？），而且有点有限。

我认为，如果您没有获得单次播放，您应该尝试使用 URL 表单：

```
     AudioStream audiostream = new AudioStream(url.openStream());
     AudioPlayer.player.start(audiostream);
```

然后尝试将代码放入循环中？很大程度上取决于 .start 命令是否阻塞。如果它启动了一个单独的线程（很可能），那么您将不得不弄清楚文件何时结束，而且我没有看到任何提供的命令来做到这一点！该规范还列出了创建 ContinuousAudioDataStream 并对其进行管理的可能性。

除非我对这个库有什么我不知道的地方，否则我建议使用 javax.sound.sampled.Clip 或 javax.sound.sampled.SourceDataLine 进行播放。Clip 有一个布尔值，您可以为循环设置，但需要先将整个文件加载到内存中。SourceDataLine 从 url 或文件位置播放，并且可以实现一个侦听器来告诉您文件何时完成。

[http://docs.oracle.com/javase/tutorial/sound/playing.html](http://docs.oracle.com/javase/tutorial/sound/playing.html)

# javascript - Google 应用程序脚本 location.reload 在网络应用程序中

> ID：14674502
> 
> 赞同：6
> 
> 时间：2013-02-03T16:14:34.483
> 
> 标签：javascript, html, google-apps-script, reload, window.location

我正在使用一个 GAS Web 应用程序，当用户执行某些操作（例如单击特定 div）时，它需要刷新其内容。

在客户端，我有这个从 onclick 调用的脚本

```
google.script.run.withSuccessHandler(refreshCallback).myServersideFunction();

function refreshCallback(roomsPlus) {
    var statusDiv = document.getElementById("status");
    statusDiv.innerHTML = "Reloading...";
    window.location.reload(true);
}; 
```

状态 div 更改为“重新加载...”所以我知道回调被调用，但它永远不会重新加载页面。Caja 或谷歌应用程序脚本是否禁用页面刷新？还有其他刷新页面的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-12-11T14:15:33.643

您需要做的就是使用：

```
window.open("https://script.google.com/macros/s/web_app_ID/dev",'_top'); 
```

我在下面的原始答案有效，但不需要：

有一个程序化的“解决方法”来重新加载/刷新 Apps Script Web App 中的页面。它基于 html 链接标签重新加载页面的能力，以及 JavaScript 调用该标签上的点击事件的能力。如果需要，您可以隐藏链接。

*   将链接标签添加到您的 HTML
*   如果您愿意，可以隐藏链接标签
*   在脚本标签中添加客户端代码以调用链接标签上的点击事件
*   随心所欲地运行代码

## 测试按钮：

```
<button onmouseup="reloadTheWebApp()">Trigger the Link Tag</button> 
```

## 关联：

```
<a id="testLink" style="display:none" 
   href="https://script.google.com/macros/s/script_ID/exec">Reload the Web App</a> 
```

## 脚本：

```
<script>

  window.reloadTheWebApp = function() {
    console.log('reloadTheWebApp ran');

    var linkTag = document.getElementById('testLink');

    linkTag.click();
  }

</script> 
```

最好实现一个简单的页面导航系统：

[页面导航 Web 应用程序 - Apps 脚本](https://script.google.com/d/1WArwQ_wtkwSjom9hmmxfClFX3lKa5LrFOPSrdndeIETJMRple_lDbF0L/edit?usp=sharing)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T23:17:55.503

## 编辑

Caja 已于 2016 年 7 月 16 日从 Web App HtmlService 中删除。

[原生沙盒模式](https://developers.google.com/apps-script/reference/html/sandbox-mode#properties)

[HTML 服务的更新](https://developers.googleblog.com/2015/10/google-apps-script-update-to-htmlservice.html)

**编辑结束**

不幸的是，HtmlService 使用的 Caja 清理引擎限制了对窗口对象的访问，从而阻止您以编程方式重新加载页面。这是服务的一个已知限制，我们正在努力更好地记录它。

# java - 在不同的类中实现 ButtonListener 的最佳方法是什么？

> ID：14674505
> 
> 赞同：1
> 
> 时间：2013-02-03T16:15:04.193
> 
> 标签：java

我知道创建监听器的 3 种方法：

### 1.匿名型

```
 btn.addClickListener(new ButtonClickListener(){
   doSomething();
 }) 
```

### 2.类内部类型

```
btn.addClickListener(new MyButtonClickListener());
public MyButtonClickListener implements ButtonClickListener{} 
```

### 3.外部类

所以上面相同，但在另一个类中。

## 问题

如果我在课堂上有一些使用按钮的字段并且我想用按钮做一些事情，这是最干净的方法？

例如，我有`String a = "foo"`一个字段，当我单击按钮时，我想更改此字段。

*   案例1：我可以使用`MyClass.this.foo = "bar";`
*   案例2：同样。
*   案例 3： ? （参照字段创建自定义构造函数？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:39:16.687

A`Listener`与任何其他类别一样；如果您需要该类的实例来操作另一个对象的字段，则将后者的引用作为构造函数的参数传递并将其保存为对象字段之一。稍后，您可以使用被引用对象的公共接口来随意操作它。

另一种方法（将`Listener`类进一步解耦）是将所有相关字段移动到`Listener`类中，因此它的实例可以直接操作它们。每当您需要从实际使用的`Listener`类（您创建它并将其附加到某个组件的类）中访问这些字段时，您可以使用它的公共接口从实例中检索它们。当然，您需要保存实例的引用，而不仅仅是将其添加为侦听器（就像您对案例 1 和 2 所做的那样）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T16:41:35.530

> 如果我在课堂上有一些使用按钮的字段并且我想用按钮做一些事情，这是最干净的方法？

一般来说，这取决于。如果您查看 sun/oracle 的 java 教程，您也会看到它们以不同的方式执行此操作。
甚至还有一种可能：通过GUI类实现接口。

根据我个人的经验，我会评价可读性而不是聪明。这意味着我会坚持一种方式，并在所有情况下都使用这种方式。只有当有一个真正好的论点时，我才会考虑改变风格。每个读者都对正在发生的事情有一个期望，并且期望得到了满足。如果他们必须开始四处寻找或担心是否发生了其他事情（以及在哪里发生），这会使阅读和理解速度变慢。
这通常会导致我的匿名内部类。它们总是设置在`addListeners()`方法中。我做了一些检查，如果必须做一些更严重的动作，我会从监听器内部调用一些其他（外部）类方法。

> 案例1（匿名内部类）：我可以使用 MyClass.this.foo = "bar";

尝试一下。（是的，你甚至可以打电话`foo = "bar";`）

> 案例2（内部类）：相同

试试看（与匿名内部类相同）

> 案例 3： ? （参照字段创建自定义构造函数？）

由于按值调用，这将不起作用。（MyButtonClickListener(String foo) .. foo = "bar" 仅更改本地 foo）。您可以传递对对象的引用并调用像 setField 这样的 getter。

# google-chrome - Google Chrome 托管应用与打包应用

> ID：14674508
> 
> 赞同：1
> 
> 时间：2013-02-03T16:15:20.913
> 
> 标签：google-chrome, hosted-app

我对 Chrome 托管应用程序与打包应用程序感到困惑。

托管应用程序 - 是我们在服务器端托管我们的网站的地方 - 需要互联网

打包的应用程序 - 在客户端站点中托管网站 - 就像原生应用程序一样 - 无需互联网。

我对打包应用很感兴趣，但我可以像 drive.google.com 或 gmail 一样制作打包应用吗？当他们离线时使用打包的应用程序，当他们在线并开始将待处理的离线文件同步到服务器时。或者打包的应用程序只是离线的一切？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-05T14:44:17.980

这可能会帮助你。 [https://developer.chrome.com/webstore/choosing](https://developer.chrome.com/webstore/choosing)

无论如何，如果您想要跨平台（即网络、移动设备等），则必须托管打包应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:12:57.007

如果您想要任何离线和在线功能，您需要使用打包应用程序。您可以考虑的一种方法是打包应用程序将运行所需的所有文件下载到本地计算机。使用托管应用程序，所有这些文件都存在于某处的网络服务器上。

打包的应用程序就像常规的网络应用程序一样，但它们具有允许它们离线运行的额外功能。

此外，打包的应用程序不需要支持离线。

# java - 为什么我的面板没有更新 java 中的 textarea

> ID：14674512
> 
> 赞同：0
> 
> 时间：2013-02-03T16:15:43.787
> 
> 标签：java, swing, jtextarea

我有一个包含 3 个面板的 JPanel。面板的布局是 BorderLayout，3 个面板使用 BorderLayout.NORTH、.CENTER 和 .SOUTH 进行划分。设置为 .SOUTH 的面板称为“底部”。在底部有一个 textArea 应该根据用户从其上方面板中的组合框中选择的内容显示信息。然而，出于某种原因，我的文本区域没有更新信息。这个想法是，例如，当用户选择“山地自行车”时，文本区域将显示有关山地自行车的信息。然后，如果用户在此之后立即选择“公路自行车”，它将显示有关公路自行车的信息。出于某种原因，它没有这样做，而且我确定更新它是一个问题，因为我所有的类实例都是正确的，当我尝试为组合框选择不同的起始索引时，它们都在文本区域中显示了正确的信息。这是我的构造函数：

```
 public MainGUI(){
       System.out.print("Loading...");
       frame.setVisible(true);
       frame.setLocationRelativeTo(null);
       frame.setDefaultCloseOperation(frame.EXIT_ON_CLOSE);
       frame.add(main);
       int frameSize = frame.getWidth();
       instructionField.setColumns(frameSize);
       instructionField.setEnabled(false);
       instructionField.setDisabledTextColor(Color.RED);
       instructionField.setText("Welcome to the Bike App! Please choose from the following bikes!");
       Color backColor = frame.getBackground();
       instructionField.setBackground(backColor);
       main.add(instructionField, BorderLayout.NORTH);
       main.add(middle, BorderLayout.CENTER);
       main.add(bottom, BorderLayout.SOUTH);
       GridBagConstraints gbc = new GridBagConstraints();
       gbc.insets = new Insets(10,10,10,10);
       gbc.gridx=0;
       gbc.gridy=0;
       middle.add(bikeComboBox, gbc);
       submit = new JButton("Load Selected Bike");
       gbc.gridx=1;
       gbc.gridy=0;
       middle.add(submit, gbc);
       bikeComboBox.addActionListener(this);
       submit.addActionListener(this);
       //bottom is a JPanel
       //HERE IS WHERE THE TEXT AREA CODE IS
       informationTextArea = new JTextArea();
       JScrollPane sp = new JScrollPane(informationTextArea);
       informationTextArea.setEditable(false);
       bottom.add(informationTextArea, BorderLayout.CENTER);
       //bikeComboBox.setSelectedIndex(1);
       selectedBikeIndex = bikeComboBox.getSelectedIndex();
       selectedBikeName = bikeTypes[selectedBikeIndex];
       String returnedInfo = loadSelectedBikeInfo(selectedBikeName);
       informationTextArea.setText(returnedInfo);
       informationTextArea.updateUI();
       bottom.updateUI();
       informationTextArea.setBackground(backColor);
       frame.setSize(400,400);
    } 
```

这是 loadSelectedBikeInfo(String selectedBikeName) 方法：

```
 public String loadSelectedBikeInfo(String selectedBikeName){
      String s = selectedBikeName;
      String selectedInfo = "";
      if(s.equalsIgnoreCase(this.mounBikeType)){//load mountain bike info
          selectedInfo = mountainBike.getBikeInfo();
      }
      if(s.equalsIgnoreCase(this.roadBikeType)){//load mountain bike info
          selectedInfo = roadBike.getBikeInfo();
      }
      if(s.equalsIgnoreCase(this.raciBikeType)){//load mountain bike info
          selectedInfo = racingBike.getBikeInfo();
      }
      if(s.equalsIgnoreCase(this.cruisBikeType)){//load mountain bike info
          selectedInfo = cruiserBike.getBikeInfo();
      }
      return selectedInfo; 
    } 
```

这是按钮的 actionPerformed 方法，而不是组合框（我不知道如何为组合框编写一个）：

```
 public void actionPerformed(ActionEvent e){
      if(e.getSource()==submit){
         selectedBikeIndex = bikeComboBox.getSelectedIndex();
         selectedBikeName = bikeTypes[selectedBikeIndex];
         loadSelectedBikeObject(selectedBikeName);
      }
    } 
```

编辑：我在另一个类中编写了一个 actionPerformed 方法，并将该侦听器添加到我的组合框中。为什么还是不更新？

```
 public class ComboBoxUpdateListener implements ActionListener{
      private MainGUI maingui;

      ComboBoxUpdateListener(MainGUI _mainGUI){
         this.maingui = _mainGUI;
      }

      @Override
      public void actionPerformed(ActionEvent ae) {
         JComboBox cb = (JComboBox)(ae.getSource());
         String bikeTypePassed = maingui.bikeTypes[cb.getSelectedIndex()];
         System.out.println("This is from the LISTENERCLASS: "+bikeTypePassed);
         maingui.loadSelectedBikeInfo(bikeTypePassed);
         maingui.informationTextArea.updateUI();
         maingui.bottom.updateUI();
      }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T17:56:10.320

> 当我尝试为组合框选择不同的起始索引时，它们都在文本区域中显示了正确的信息。

仔细看看你对工作代码做了什么：

```
String returnedInfo = loadSelectedBikeInfo(selectedBikeName);
informationTextArea.setText(returnedInfo); 
```

根据您的编辑：

> 编辑：我在另一个类中编写了一个 actionPerformed 方法，并将该侦听器添加到我的组合框中。为什么还是不更新？
> 
> ```
>  @Override
>   public void actionPerformed(ActionEvent ae) {
>      JComboBox cb = (JComboBox)(ae.getSource());
>      String bikeTypePassed = maingui.bikeTypes[cb.getSelectedIndex()];
>      System.out.println("This is from the LISTENERCLASS: "+bikeTypePassed);
>      maingui.loadSelectedBikeInfo(bikeTypePassed);
>      maingui.informationTextArea.updateUI();
>      maingui.bottom.updateUI();
>   } 
> ```

`loadSelectedBikeInfo(bikeTypePassed)`返回一个`String`：

```
public String loadSelectedBikeInfo(String selectedBikeName){
      String s = selectedBikeName;
      String selectedInfo = "";
      if(s.equalsIgnoreCase(this.mounBikeType)){//load mountain bike info
          selectedInfo = mountainBike.getBikeInfo();
      }
      if(s.equalsIgnoreCase(this.roadBikeType)){//load mountain bike info
          selectedInfo = roadBike.getBikeInfo();
      }
      if(s.equalsIgnoreCase(this.raciBikeType)){//load mountain bike info
          selectedInfo = racingBike.getBikeInfo();
      }
      if(s.equalsIgnoreCase(this.cruisBikeType)){//load mountain bike info
          selectedInfo = cruiserBike.getBikeInfo();
      }
      return selectedInfo; 
    } 
```

所以你应该得到它`String`并调用`setText(String text)`：`JTextArea`

```
 @Override
  public void actionPerformed(ActionEvent ae) {
     JComboBox cb = (JComboBox)(ae.getSource());
     String bikeTypePassed = maingui.bikeTypes[cb.getSelectedIndex()];
     System.out.println("This is from the LISTENERCLASS: "+bikeTypePassed);
     String info=maingui.loadSelectedBikeInfo(bikeTypePassed);
     maingui.informationTextArea.setText(info);
  } 
```

*   另请阅读[Swing 中的并发](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)。

*   也正如其他人所说[`updateUI`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JPanel.html#updateUI%28%29)对您没有帮助：

> 使用当前外观中的值重置 UI 属性。

如果`repaint()`应该调用任何东西，但我认为没有理由这样做。

*   在添加内容后但在设置可见之前不要使用`setSize`实现正确[`LayoutManager`](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)和调用`pack()``JFrame`

# applescript - 如何通过 applescript 将 iTunes 11 设置为随机播放或重复播放模式

> ID：14674517
> 
> 赞同：7
> 
> 时间：2013-02-03T16:16:05.690
> 
> 标签：applescript, itunes, repeat, shuffle

根据[http://dougscripts.com/](http://dougscripts.com/itunes/2012/11/itunes-11-applescript-bug/)通过 applescript 设置随机播放和重复模式在 iTunes 11 中被破坏。

根据这个[stackoverflow answer](https://stackoverflow.com/a/14223183/2037434) shuffle 现在是一个播放列表独立设置。

因此，我尝试通过 UI 设置 shuffle 值，无论是通过 iTunes 的 LCD 显示还是通过菜单栏。在尝试单击 LCD 区域或菜单栏中的随机播放按钮/菜单项时，我所能得到的只是“未知 UI 索引”错误。（我是applescript的新手）。

如果你们中的一些人能想出一种**在 iTunes 11 上**切换随机播放模式的方法，那就太好了。此外**，我更喜欢基于菜单栏而不是 LCD 显示屏的解决方案，**因为在后者中，随机播放按钮并不总是可见。

理想情况下，**我更喜欢基于语义的解决方案而不是基于 UI 的解决方案**，但我不确定它是否可能（iTunes 11 applescript 库似乎已经过时，因为它提到了“播放列表”项目的“随机播放”属性）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2017-05-12T16:00:19.507

对于新的音乐应用程序，这是可行的。如果您仍在使用 iTunes，请将“音乐”更改为“iTunes”。

重复可以设置为**一个**或**关闭**或**全部**。

```
tell application "Music"
   set song repeat to off
end 
```

Shuffle 可以设置为**true**或**false**。

```
tell application "Music"
   set shuffle enabled to true
end 
```

您可以在[Dougscripts](http://dougscripts.com/itunes/2016/05/the-return-of-shuffle-and-repeat/)找到更多详细信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T18:12:56.933

当我看到`current playlist`iTunes 应用程序的 AppleScript 属性时，我很乐观，但它并不能很好地工作。它能够获取和设置当前播放列表的名称，但它不能对属性`shuffle`或`song repeat`. 尝试设置任一属性时都会出错，并且总是返回 'false'`shuffle`和 'off' `song repeat`。

我认为您唯一的选择是 UI 脚本。以下是通过菜单栏切换随机播放的方法：

```
tell application "System Events" to perform action "AXPress" of (first menu item of process "iTunes"'s menu bar 1's menu bar item "Controls"'s menu 1's menu item "Shuffle"'s menu 1 whose name ends with "Shuffle") 
```

以下是设置重复的方法：

```
tell application "System Events" to tell process "iTunes"'s menu bar 1's menu bar item "Controls"'s menu 1's menu item "Repeat"'s menu 1
    perform action "AXPress" of menu item "Off"
    perform action "AXPress" of menu item "All"
    perform action "AXPress" of menu item "One"
end tell 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-04T01:38:13.783

我非常喜欢 John Sauer 的方法，我使用他的方法为这些属性编写了一些 getter/setter。它运作良好，因为您不必在使用 iTunes 之前激活它们。无论如何，我想我会发布它们以防它们对任何人有帮助。您将使用“类型”（以菜单项名称为模型）获取或设置它们的值，如下所示：

重复类型为“关闭”、“全部”或“一个”。

随机播放类型为“关闭”、“按歌曲”、“按专辑”或“按分组”

```
on getRepeatType() -- the return value is a string: Off/All/One
    tell application "System Events"
        tell process "iTunes"
            set menuItems to menu items of menu bar 1's menu bar item "Controls"'s menu 1's menu item "Repeat"'s menu 1
            set currentChoice to "unknown"
            repeat with anItem in menuItems
                try
                    set theResult to value of attribute "AXMenuItemMarkChar" of anItem
                    if theResult is not "" then
                        set currentChoice to name of anItem
                        exit repeat
                    end if
                end try
            end repeat
        end tell
    end tell
    return currentChoice
end getRepeatType

on setRepeatType(repeatType) -- repeatType is a string: Off/All/One
    set currentValue to my getRepeatType()
    ignoring case
        if currentValue is not repeatType then
            tell application "System Events" to tell process "iTunes"'s menu bar 1's menu bar item "Controls"'s menu 1's menu item "Repeat"'s menu 1
                if repeatType is "all" then
                    perform action "AXPress" of menu item "All"
                else if repeatType is "one" then
                    perform action "AXPress" of menu item "One"
                else
                    perform action "AXPress" of menu item "Off"
                end if
            end tell
        end if
    end ignoring
end setRepeatType

on getShuffleType() -- the return value is a string: Off/By Songs/By Albums/By Groupings
    tell application "System Events"
        tell process "iTunes"
            set menuItems to menu items of menu bar 1's menu bar item "Controls"'s menu 1's menu item "Shuffle"'s menu 1
            set onOffItemName to name of item 1 of menuItems
        end tell
    end tell

    -- is shuffle off
    ignoring case
        if onOffItemName contains " on " then return "Off"
    end ignoring

    -- shuffle is on so find how we are shuffling
    set currentChoice to "Unknown"
    tell application "System Events"
        tell process "iTunes"
            repeat with i from 2 to count of menuItems
                set anItem to item i of menuItems
                try
                    set theResult to value of attribute "AXMenuItemMarkChar" of anItem
                    if theResult is not "" then
                        set currentChoice to name of anItem
                        exit repeat
                    end if
                end try
            end repeat
        end tell
    end tell
    return currentChoice
end getShuffleType

on setShuffleType(shuffleType) -- shuffleType is a string:  Off/By Songs/By Albums/By Groupings
    set currentValue to my getShuffleType()

    script subs
        on toggleShuffleOnOff()
            tell application "System Events" to perform action "AXPress" of (first menu item of process "iTunes"'s menu bar 1's menu bar item "Controls"'s menu 1's menu item "Shuffle"'s menu 1 whose name ends with "Shuffle")
        end toggleShuffleOnOff

        on pressBySongs()
            tell application "System Events" to perform action "AXPress" of (first menu item of process "iTunes"'s menu bar 1's menu bar item "Controls"'s menu 1's menu item "Shuffle"'s menu 1 whose name ends with "Songs")
        end pressBySongs

        on pressByAlbums()
            tell application "System Events" to perform action "AXPress" of (first menu item of process "iTunes"'s menu bar 1's menu bar item "Controls"'s menu 1's menu item "Shuffle"'s menu 1 whose name ends with "Albums")
        end pressByAlbums

        on pressByGroupings()
            tell application "System Events" to perform action "AXPress" of (first menu item of process "iTunes"'s menu bar 1's menu bar item "Controls"'s menu 1's menu item "Shuffle"'s menu 1 whose name ends with "Groupings")
        end pressByGroupings
    end script

    ignoring case
        if shuffleType contains "off" then -- we have to make sure it's off
            if currentValue does not contain "off" then subs's toggleShuffleOnOff()
        else
            -- make sure it's on
            if currentValue contains "off" then subs's toggleShuffleOnOff()

            -- select the shuffle menu item for the type
            if shuffleType contains "song" and currentValue does not contain "song" then
                subs's pressBySongs()
            else if shuffleType contains "album" and currentValue does not contain "album" then
                subs's pressByAlbums()
            else if shuffleType contains "group" and currentValue does not contain "group" then
                subs's pressByGroupings()
            end if
        end if
    end ignoring
end setShuffleType 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-05-17T19:28:22.583

对于 iTunes 12，这有效

```
tell application "System Events"  
    tell process "iTunes" to if exists then  
        click menu item "Albums" of menu "Shuffle" of menu item "Shuffle" of menu "Controls" of menu bar 1  
    end if  
end tell 
```

相应地更改`Albums`为`Songs`、`Groupings`和。`On``Off`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-03T19:03:35.747

这是另一种方法：

```
activate application "iTunes"
tell application "System Events"
    tell process "iTunes"
        click menu item 1 of menu 1 of menu item "Shuffle" of menu 1 of menu bar item "Controls" of menu bar 1
    end tell
end tell 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-03-15T09:02:47.107

看起来很多这些脚本在最新的 iTunes 中都被破坏了。这里有两个工作：

```
tell application "System Events" to tell UI element "iTunes" of list 1 of process "Dock"
    if not (exists) then return
    perform action "AXShowMenu"
    click menu item "Shuffle" of menu 1
end tell 
```

那一个通过 Dock 切换随机播放。您可以在使用时观看 Dock 菜单动画。

这个通过菜单无形地切换随机播放：

```
tell application "System Events"
    tell application process "iTunes"
        tell menu 1 of menu item "Shuffle" of menu "Controls" of menu bar 1
            if (value of attribute "AXMenuItemMarkChar" of item 1 of menu items as string) = "✓" then
                click menu item 2
            else
                click menu item 1
            end if
        end tell
    end tell
end tell 
```

即使 iTunes 在后台，这两种方法也可以工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-29T00:02:12.307

花了一些时间解构这篇文章中的所有混淆解决方案（这些解决方案似乎不再起作用），这是一种适用于 iTunes 12.1 的更具可读性和可定制性的方法：

```
tell application "System Events"

    set itunesMenuBar to process "iTunes"'s first menu bar
    set controlsMenu to itunesMenuBar's menu bar item "Controls"'s first menu
    set shuffleMenu to controlsMenu's menu item "Shuffle"'s first menu

    set shuffleOnMenuItem to shuffleMenu's menu item "On"
    set shuffleSongsMenuItem to shuffleMenu's menu item "Songs"

    tell process "iTunes"
        click shuffleOnMenuItem
        click shuffleSongsMenuItem
    end tell

end tell 
```

这将打开随机播放并将其设置为随机播放歌曲而不是专辑，并且应该很明显如何将其更改为做其他事情。

# facebook - OG标签不解析成scraper

> ID：14674521
> 
> 赞同：2
> 
> 时间：2013-02-03T16:16:18.403
> 
> 标签：facebook, smarty

我想将我网站上的文章发布到我的时间轴上，但是沿着这条线的某个地方，元标记被清空了。例如： [http](http://www.uisge-beatha.eu/logboek/401/Verbouwing-koelbox-3.html) ://www.uisge-beatha.eu/logboek/401/Verbouwing-koelbox-3.html 如果我查看网站的来源，我会看到以下 OG-tags

```
<link rel="canonical" href="http://www.uisge-beatha.eu/logboek/401/30/Verbouwing-koelbox-3.html" />
<meta property="fb:app_id" content="175931732519501" />
<meta property='og:type' content='article'> 
<meta property="og:url" content="http://www.uisge-beatha.eu/logboek/401/30/Verbouwing-koelbox-3.html" />
<meta property="og:image" content="http://www.uisge-beatha.eu/uploads/cgblog/id401&#47;Koelkast_-_30.jpg" />
<meta property="og:title" content="Verbouwing koelbox - 3" />
<meta property="og:description" content="Het testen van de compressor..." /> 
```

通过检查 FB 调试器，它有时会正常处理，有时会失败。都是出于未知的原因。[https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwww.uisge-beatha.eu%2Flogboek%2F401%2FVerbouwing-koelbox-3.html](https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwww.uisge-beatha.eu%2Flogboek%2F401%2FVerbouwing-koelbox-3.html)

在处理正常的情况下，通过查看 OG 元标记，我确实看到了基于页面来源的预期信息。但是，如果我查看刮板，这些元标记是空的。

```
<link rel="canonical" href="http://www.uisge-beatha.eu/Nieuwtjes.html">
<meta property="fb:app_id" content="175931732519501">
<meta property="og:type" content="article">
<meta property="og:url" content="">
<meta property="og:image" content="/">
<meta property="og:title" content="">
<meta property="og:description" content=""> 
```

不知道为什么这些都是空的。一直在寻找解决方案几个小时，但没有找到。

负责“填充”元数据的站点模板包含 smarty 逻辑：

```
<link rel="image_src" type="image/jpeg" href="{$entry->file_location}&#47;{$entry->fieldsbyname.facebook_thumbnail->value}" alt="{$entry->title|escape}" />
{if isset($canonical)}<link rel="canonical" href="{$canonical}" />
{elseif isset($content_obj)}<link rel="canonical" href="{$content_obj->GetURL()}" />
{/if}
<meta property="fb:app_id" content="175931732519501" />
<meta property='og:type' content='article'> 
<meta property="og:url" content="{$canonical}" />
<meta property="og:image" content="{$entry->file_location}&#47;{$entry->fieldsbyname.facebook_thumbnail->value}" />
<meta property="og:title" content="{$entry->title|escape}" />
<meta property="og:description" content="{$entry->summary|strip_tags:false}" /> 
```

有人愿意帮助我解决这种奇怪的行为吗？

# ruby - 使用葡萄 API 将复杂的 JSON 发布到 PostgreSQL

> ID：14674524
> 
> 赞同：2
> 
> 时间：2013-02-03T16:16:33.847
> 
> 标签：ruby, json, postgresql, grape-api

我正在尝试使用[grape](https://github.com/djones/grape-goliath-example)创建一个 API ，它在发布时将 JSON 数据保存到 PostgreSQL。这是示例 JSON：

```
{
    "about": "this is about me",
    "company_name": "David Co",
    "company_url": "http://google.com",
    "created_at": "2013-02-03T13:09:37+05:30",
    "email": "jones@david.com",
    "first_name": "David",
    "google_plus": "http://google.com",
    "id": 1
} 
```

这是红宝石代码：

```
class Posts < Grape::API

  version 'v1', :using => :path
  format :json

  resource 'posts' do
    get "/" do
      Post.all
    end

    get "/:id" do 
      Post.find(params['id'])
    end

    post "/create" do
      Post.create(params['post'])
    end
  end

end 
```

我正在关注这个[示例](https://github.com/djones/grape-goliath-example)，它适用于上述 JSON。

如何修改代码以使其与更复杂的 JSON 一起工作，例如：

```
{
 "about": "this is about me",
 "company_name": "David Co",
 "company_url": "http://google.com",
 "created_at": "2013-02-03T13:09:37+05:30",
 "email": "jones@david.com",
 "first_name": "David",
 "google_plus": "http://google.com",
 "id": 1,
 "chall": [{
     "attributes": {
         "type": "tegory__c",
         "url": "/services0/sobjects/__c/a08Z0000000RmoTIAS"
     }
} 
```

这是当前的数据库架构：

```
create_table :posts do |t|
  t.string :first_name
  t.string :email
  t.string :company_name
  t.string :google_plus
  t.string :about
  t.string :company_url
  t.timestamps
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:35:10.173

您`attributes`将是一个单独的表，包括类型和 url。然后你将成为一个从单行映射到多行`chall`的链接表。这使您可以将这种格式的数据放入数据库中。`posts``attributes`

当然，只有一个条目`attributes`很难提供完整的模式，但这应该让您了解如何将它们组合在一起。

请注意，如果您的 JSON 看起来像这样，您可以简化事情：

```
"chall": [{
     "type": "tegory__c",
     "url": "/services0/sobjects/__c/a08Z0000000RmoTIAS"
}] 
```

因为 then`chall`将是与 的直接一对多链接`posts`，尽管鉴于示例 JSON 中缺少数据，因此很难判断这是否有效。不过，希望这会为您指明正确的方向。

如果我假设前者，那么您的架构看起来像这样：

```
create_table :posts do |t|
  t.string :first_name
  t.string :email
  t.string :company_name
  t.string :google_plus
  t.string :about
  t.string :company_url
  t.timestamps
end

create_table : attributes do |t|
  t.string :type
  t.string :url
end

create_table post_attributes do |t|
  t.references : posts
  t.references : attributes
end 
```

在这种情况下，帖子和属性之间存在多对多关系。

# ios - 在没有键的情况下访问 NSMutableDictionary 值？

> ID：14674526
> 
> 赞同：0
> 
> 时间：2013-02-03T16:16:54.780
> 
> 标签：ios, json, nsdictionary

同时对 iOS 开发和 Objective-c 来说还很陌生。我有以下方法：

```
-(NSMutableArray *)fetchDatabaseJSON{
    NSURL *url = [NSURL URLWithString:@"http://www.ios.com/ios/responseScript.php"];
    NSError *error = nil;
    NSURLRequest *request = [NSURLRequest requestWithURL:url];
    NSData *data = [NSURLConnection sendSynchronousRequest:request returningResponse:NULL error:&error];
    //jsonArray = [NSJSONSerialization JSONObjectWithData:data options:0 error:&error];
    //NSLog(@"Array: %@",[jsonArray objectAtIndex:0]);
    jsonDictionary = [NSJSONSerialization JSONObjectWithData:data options:0 error:&error];
    NSLog(@"Dictionary:  %@", jsonDictionary);
    return jsonArray;
} 
```

现在 NSLog 显示：

> 2013-02-03 19:15:37.081 TestConnection[24510:c07] 字典：（Bannana，Apple，SomeCheese）

据我了解，字典中的任何内容都没有键值。怎么会这样？我该如何解决？我希望能够拥有简化字典操作的键。

问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:47:52.673

`JSONObjectWithData`可能会返回 NSArray 或 NSDictionary，具体取决于您提供的 JSON 数据。如果您的 JSON 字符串是一个数组，那么您将拥有一个 NSArray。如果你的 JSON 数据是一个字典，你会得到一个 NSDictionary。

将您的 JSON 数据（您的`data`变量）转换为字符串并使用 NSLog 打印出来。要将 NSData 转换为 NSString，请使用以下内容：

```
NSString *myString = [[NSString alloc] initWithData:myData encoding:NSUTF8StringEncoding]; 
```

如果您将其打印出来并看到一个 JSON 数组，那么您根本就没有字典。如果您可以更改生成 JSON 的服务器代码，则可以更改它。

我注意到的另一件事是，您假设返回的容器是可变的。如果我没记错的话，您需要使用`NSJSONReadingMutableContainers`JSONObjectWithData 的 options 参数中的选项来获得它。

最后一个提示，如果您想在有 NSArray（或 NSDictionary）的情况下签入代码，请使用以下内容：

```
if ([obj isKindOfClass:[NSArray class]]) {...} 
```

# iphone - 更改已设置 UILocalNotification 的 soundName

> ID：14674540
> 
> 赞同：2
> 
> 时间：2013-02-03T16:18:29.507
> 
> 标签：iphone, ios, ipad, alert, uilocalnotification

对于尚未创建的通知（新通知）进行了更改，但对于已创建的通知，之前的声音保持不变。

我努力了：

```
NSString *soundName = cell.titleLabel.text;

NSArray *notifications = [[UIApplication sharedApplication] scheduledLocalNotifications];

for (UILocalNotification *notif in notifications) {
    notif.soundName = [NSString stringWithFormat:@"%@.mp3", soundName];
} 
```

但它不起作用......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-09T10:30:46.197

您必须重新安排已安排的通知。但请确保删除您之前安排的那些。

```
NSArray *notifications = [[UIApplication sharedApplication] scheduledLocalNotifications];
[[UIApplication sharedApplication] cancelAllLocalNotifications];

for (UILocalNotification *notif in notifications) {
    notif.soundName = [NSString stringWithFormat:@"%@.mp3", soundName]; 
    [[UIApplication sharedApplication] scheduleLocalNotification:notification];
} 
```

# methods - 使用 rake 路由显示的路径方法仍未定义

> ID：14674546
> 
> 赞同：0
> 
> 时间：2013-02-03T16:19:46.347
> 
> 标签：methods, path, routes, ruby-on-rails-3.2

摆脱这个[问题](https://stackoverflow.com/questions/14673532/rails-cant-map-automatically-y-ending-plural-models-is-it-possible)后，我得到了另一个。

我在 routes 中指定了一个路径方法`resources :tree_nurseries do ...`。并在我这样做时正确显示`rake routes`，`new_tree_nursery`然后通常`new_tree_nursery_path`会可用。

但是，当我使用 link_to 方法调用它时，它仍然是 undefiend.... ( `new_tree_nursery_path`)

我又错过了什么？

**这是代码行：**

```
.actions
  = link_to t('.new', :default => t("helpers.links.new")), new_tree_nursery_path, :class => 'btn btn-primary pull-right' 
```

**和耙路线的结果：**

```
 tree_nurseries GET    /tree_nurseries(.:format)                     tree_nurseries#index
                          POST   /tree_nurseries(.:format)                     tree_nurseries#create
         new_tree_nursery GET    /tree_nurseries/new(.:format)                 tree_nurseries#new
        edit_tree_nursery GET    /tree_nurseries/:id/edit(.:format)            tree_nurseries#edit
             tree_nursery GET    /tree_nurseries/:id(.:format)                 tree_nurseries#show
                          PUT    /tree_nurseries/:id(.:format)                 tree_nurseries#update
                          DELETE /tree_nurseries/:id(.:format)                 tree_nurseries#destroy 
```

**配置/环境.rb：**

```
ActiveSupport::Inflector.inflections do |inflect|
  inflect.irregular 'tree_nursery', 'tree_nurseries'
end 
```

# jquery - Jquery 幻灯片动画行为

> ID：14674548
> 
> 赞同：0
> 
> 时间：2013-02-03T16:19:57.923
> 
> 标签：jquery, slide

我正在制作一个简单的滑出标签。

此脚本导致 div - '#slideout' 在鼠标悬停在“#tabFeature1”上时滑入，并在鼠标滑出时滑出。

除了不需要的副作用外，一切都在工作。如果效果堆叠 - 所以每个 mouseover/mouseout 都是堆叠的。例如，如果用户快速将鼠标移入和移出 10 次，然后停止移动鼠标，动画将继续迭代 - 移入和移出 10 次。令人讨厌的效果是动画不会堆叠。请让我知道这是否有意义。

```
$(document).ready(function () {
    $('#tabFeature1').mouseover(function () {
            $('#slideout').show("slide", { direction: "left" }, 1000);
        });

    $('#tabFeature1').mouseout(function () {
            $('#slideout').hide("slide", { direction: "left" }, 1000);
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:30:18.990

检查动画是否仍在进行中`.is(':animated')`，如果前一个完成，则应用动画。

```
$(document).ready(function () {
    $('#tabFeature1').mouseover(function () {
            if (!$('#slideout').is(':animated')) {
                $('#slideout').show("slide", { direction: "left" }, 1000);
            }
        });

    $('#tabFeature1').mouseout(function () {
            if (!$('#slideout').is(':animated')) {
                $('#slideout').hide("slide", { direction: "left" }, 1000);
            }
    });
}); 
```

# c# - 在视图 asp.net mvc 3 中批量创建模型

> ID：14674554
> 
> 赞同：0
> 
> 时间：2013-02-03T16:20:50.957
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, razor

假设我有一个简单的模型：

```
public class studentNames
{
string name{get; set;}
} 
```

现在，如果我通过创建模式在视图中搭建它，则只会创建一个模型。我想在一个视图中创建多个对象。

就像是：

```
<form action="someAction">
Name of student1: <student1 name input box>
Name of student2: <student2 name input box>

<save button>

</form> 
```

单击此按钮时，控制器中将返回一个列表，我可以将它们保存在数据库中。

我怎样才能做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:24:02.180

您可以从阅读模型绑定器期望的约定开始[`binding to lists`](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)。然后适当地命名您的输入字段：

```
@using (Html.BeginForm("SomeAction", "SomeController"))
{
    @for (var i = 0; i < 5; i++)
    {
        <div>
            Name of student: @Html.TextBox("name[" + i + "]", null)
        </div>
    }
    <button type="submit">Save</button>
} 
```

然后您的 POST 控制器操作可能需要一组学生：

```
[HttpPost]
public ActionResult SomeAction(IList<StudentNames> students)
{
    ...
} 
```

如果您希望能够在视图内动态添加和删除此集合中的项目，我建议您阅读[`Editing a variable length list`](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)Steven Sanderson 的文章，他在其中说明了一种很好的技术，可以让您构建这样的界面。

# ms-access - 在 microsoft access (2007) 中启用关系数据库值的视图

> ID：14674557
> 
> 赞同：1
> 
> 时间：2013-02-03T16:21:17.910
> 
> 标签：ms-access

我正在为一个朋友创建一个关系数据库，但我以前从未使用过 MS Access。我正在尝试使相关值显示在表格视图而不是数字表示上。例如，而不是

```
[1][2242], [2][443] 
```

我想

```
[1][John Smith], [2][Marilyn Monroe] 
```

（第一个值是主键，第二个值是链接到另一个表的值）。

我已阅读有关在表之间创建关系的[此](http://office.microsoft.com/en-001/access-help/create-edit-or-delete-a-relationship-HA010072597.aspx)页面，但我仍然无法“查看”链接值。Microsoft Access 将成为我的朋友查看这些结果的唯一方式，因此能够看到正确的值很重要。

我以前做过关系数据库，但只用传统的 PHP 和 SQL，所以我知道我需要做什么，但我似乎做不到。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:22:42.747

不要被[误导在表中创建查找值](http://access.mvps.org/access/lookupfields.htm)。创建一个表单并添加组合框以显示相关表中的数据，或使用查询。

例如：[创建表单在多个表中添加记录](https://stackoverflow.com/questions/12131211/create-form-to-add-records-in-multiple-tables/12132196#12132196)

或者

```
 SELECT Id, Fullname FROM Table1
 INNER JOIN Table2
 ON Table1.FKID = Table2.ID 
```

[您可以在 MS Access 中直观地](https://stackoverflow.com/questions/14624976/synchronize-data-in-two-database-table-upon-deletion/14626305#14626305)创建关系。您还可以在查询设计窗口中构建查询。

# c++ - 在 Windows 7 OpenGL 下将 WGL 与 GLUT 组合用于形状。缺少 GLUT 初始化？

> ID：14674558
> 
> 赞同：2
> 
> 时间：2013-02-03T16:21:18.283
> 
> 标签：c++, opengl, glut, freeglut

我正在使用 Win32 API 使用 OpenGL。因此我使用 wgl (Wiggle)。一切安好。除非我想使用 FREEGLUT 库中的一些形状。例如，茶壶。我正在查看freeglut的源代码，似乎当我发出一个 glutSolidTeaPot(1.0); ，因为宏而存在程序：FREEGLUT_EXIT_IF_NOT_INITIALISED("glutSolidSphere"); 它调用 fgerror，它有一个 exit(1)。

因此，我得到的症状很明显。当我在没有任何 GLUT 命令（如茶壶）的情况下运行 OPENGL 程序时，它运行良好。如果我使用茶壶，它就会退出。

我很清楚，我缺少初始化。问题是我是否可以初始化（以及如何） glut 以用于我的 wgl 上下文中的形状......如果这是不可能的，我想我可以自己创建形状。如果可能的话，使用它们会更快。

到目前为止，我发现的所有示例都指向如何在仅使用 glut 时初始化 glut。

我正在使用 Windows 7 64、Visual Studio 2012、NVIDIA 330m、FreeGlut

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:26:29.563

FreeGLUT 不打算部分使用。它是一个用于创建和管理 OpenGL 渲染上下文的系统。它具有实用程序功能，但其主要目的是创建和管理窗口。因此，如果您不使用 FreeGLUT 来创建和管理 OpenGL，那么您也无法将其用于其他事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:58:55.790

虽然看起来将 GLUT 和 WGL (Wiggle) 结合起来是不可能的（而且是正确的），但我查看了代码，似乎可以进行更改以使其正常工作。当然，为什么要让它工作？由于 GLUT (FreeGlut) 有额外的实用程序......比如创建一个球体......更好的方法是创建一个现代库来完成所有这些......当然，你有一些几何库，但我没有检查它们。我说的是更像 AUX 库的东西，但是是最新的。

# android - 如何为 RelativeLayout 根使用合并标签？

> ID：14674559
> 
> 赞同：3
> 
> 时间：2013-02-03T16:21:22.890
> 
> 标签：android, android-layout, android-relativelayout

我有一个自定义视图，它扩展`RelativeLayout`并在 xml 文件中定义其内容（`RelativeLayout`作为其根）。

如何避免在`RelativeLayouts`自定义布局膨胀后出现两个？我尝试`merge`在 xml 中使用标签作为我的根目录，但这样我就失去了我所有的子视图结构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:50:03.737

> 我尝试在 xml 中使用合并标记作为我的根，但是这样我就失去了我所有的子视图结构。

我不信。`merge`标签可以正常工作，您只需将标签`merge`用作布局文件的根并为该布局中的子项分配适当的规则。在 Eclipse 的图形编辑器中，此布局将不起作用（规则将被忽略（很正常，因为编辑器不知道您将使用该布局作为 a 的内容`RelativeLayout`））但在模拟器/真实设备上，规则将是应用。

如果您有一个规则不适用于`merge`标签的示例应用程序，请不要害怕发布它。

# android - 提供应用程序徽标的 Android 尺寸

> ID：14674564
> 
> 赞同：0
> 
> 时间：2013-02-03T16:21:46.250
> 
> 标签：android, xml, image

我在我的应用程序中包含了我的应用程序的徽标。当设备处于纵向模式时，徽标将跨越整个屏幕。

**我应该在我的应用程序中包含什么宽度的图像，我应该在哪里包含它们？**

我在想 320px、480px、600px 和 720px 宽度。

**我应该如何根据设备特定的屏幕属性加载每一个**- 我正在考虑通过 XML 或以编程方式？

速度是我最关心的问题。

* * *

**编辑** 我知道不同的屏幕密度（hdpi、mdpi 等），但我应该提供我的标志的像素*尺寸是多少？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:25:49.227

看看开发者指南，关于支持多种设备：[这里。](http://developer.android.com/guide/practices/screens_support.html)

尤其是：

```
res/drawable-mdpi/my_icon.png        // bitmap for medium density
res/drawable-hdpi/my_icon.png        // bitmap for high density
res/drawable-xhdpi/my_icon.png       // bitmap for extra high density 
```

我建议你这些决议：

```
xhdpi: 720x1280
large-hdpi: 640x960
hdpi: 480x640
mdpi: 320x480
ldpi: 240x320 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T16:33:33.037

您不必为此编写特殊代码，因为 android 会自动选择适当的图像大小。只需将不同大小的图像放在不同的文件夹中，命名为

`drawable-ldpi`- 适用于小分辨率， - 适用于
`drawable-mdpi`中等分辨率，
`drawable-hdpi`- 适用于高分辨率
`drawable-xhdpi`- 适用于超高分辨率。

您可以使用[此](http://coh.io/adpi/)链接来决定适合哪个文件夹的图像大小。

# c# - mongodb C# 查询没有响应

> ID：14674565
> 
> 赞同：0
> 
> 时间：2013-02-03T16:21:48.800
> 
> 标签：c#, mongodb

我正在尝试从 mongodb 服务器获取项目，有时它的工作和 4-5 次尝试它在最后一行停止响应（我无法在查询之外取出对象）之前有人有过它吗？取出物体的正确方法是什么？

```
 var client = new MongoClient(connectionString);
            var server = client.GetServer();
            var database = server.GetDatabase("myPlaces");
            var collection = database.GetCollection<MongoPlace>("Places");  
            int startDay =  int.Parse(Request.QueryString["day"]);
            MongoPlace mp = collection.AsQueryable<MongoPlace>().Where(x => x.guid == 
                            Request.QueryString["id"]).FirstOrDefault(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T17:01:58.607

您可能会达到默认连接池限制。

看起来这是一个 Web 应用程序，您不应在每个 Web 应用程序实例中多次打开客户端。

、和 都是线程安全的，通常每个应该只有一个实例`MongoClient`。（有关更多信息，请参见[此处](http://docs.mongodb.org/ecosystem/tutorial/use-csharp-driver/)）。`MongoServer``MongoDatabase``MongoCollection`

您可能希望在应用程序启动时执行此操作，然后静态保持连接直到应用程序退出。

在我的 ASP.NET MVC 应用程序中，我通常会添加一个“DatabaseConfig”类，该类的调用方式与其他应用程序配置的调用方式相同。作为一个例子，这是我在当前使用 MongoDB 构建的项目中获得的一些代码（还没有任何错误处理）：

```
var client = new MongoClient(ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString);
var server = client.GetServer();

DataLayer.Client = client;
DataLayer.Server = server;

var settings = new MongoDatabaseSettings(server, "default");            
settings.WriteConcern = WriteConcern.Acknowledged;
DataLayer.Database = DataLayer.GetDatabase(settings); 
```

然后，在 Application_Start 中，我调用`Initialize`包含上述代码的方法。

```
DatabaseConfig.Initialize(); 
```

# database-design - 关于如何为具有多个相关属性的实体建模的数据库设计反馈

> ID：14674570
> 
> 赞同：0
> 
> 时间：2013-02-03T16:22:33.350
> 
> 标签：database-design

该问题代表两个独特的实体，报告和项目，其中项目将具有基于项目类型的结果类型，并且对于给定实例也是唯一的。所以...

报告可以有多个项目，项目可以有多个报告。

项目具有独特的类型，并且本身就是实体。他们可以有几种类型的发现，这些发现是其项目类型所独有的。根据日期值，它们在给定实例中也是唯一的。因此，一个项目可能存在于多个报告中，但对于每个实例，它的发现将是不同且独特的。换句话说，Projects 的调查结果将仅适用于该实例，始终是唯一的，并且永远不会再次使用。

例子

*   报告 A 有项目 1 和项目 2。
*   项目 1 的类型 X 具有混合和定量结果。
*   项目 2 的类型为 Y，具有混合和定量结果。

项目 1`Mixed`和`Quantitative`结果对于 X 类型是唯一的 项目 2`Mixed`和`Quantitative`结果对于 Y 类型是唯一的。

这是我制作的一个非常基本的 ERD，它是当前的设计。

![在此处输入图像描述](../Images/c887cdb07a78262ae16bfb0435be8772.png)

# activerecord - Arel - 如何将列转换为当前时区并截断毫秒

> ID：14674572
> 
> 赞同：1
> 
> 时间：2013-02-03T16:22:49.173
> 
> 标签：activerecord, arel, rails-activerecord

我一直试图找到详细的 Arel 文档，但徒劳无功。最后，我尝试深入研究源代码并发现

以下作品（注意最后的 to_sql ）：

```
Arel::Nodes::NamedFunction.new('to_char', Audit.arel_table[:created_at], 'dd-mm-yyyy').to_sql 
```

并且，以下工作：

```
tzdate = Arel::Nodes::InfixOperation.new('at time zone', Arel::Nodes::InfixOperation.new('at time zone', Audits.arel_table[:created_at], 'gmt'), Time.zone.tzinfo.name) 
```

由于以下原因，以下内容不起作用（请注意最后的 to_sql）`TypeError: Cannot visit Arel::Nodes::InfixOperation`：

```
Arel::Nodes::NamedFunction.new('to_char', [tzdate, 'dd-mm-yyyy']).to_sql 
```

谁能告诉我这里发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-07-17T21:37:41.893

这里有两个问题：

*   您需要用`Arel.new('dd-mm-yyyy')`（产生一个`Arel::Nodes::SqlLiteral`）来包装日期格式字符串。
*   时区字符串需要被引用（例如`Arel::Nodes::Quoted.new('UTC')`）。见[https://github.com/rails/arel/issues/323](https://github.com/rails/arel/issues/323)

# java - 玩！将 UI 值绑定到模型

> ID：14674573
> 
> 赞同：0
> 
> 时间：2013-02-03T16:22:53.130
> 
> 标签：java, playframework, playframework-1.x

我正在使用 Play 1.2.5

我有一个`User`模型如下：

```
@Entity
public class User extends Model {
public String name;
public String city;
public String country;
public Integer zip;
} 
```

`registration.html`文件是这样的：

```
#{extends 'main.html' /}
#{set title:'Home' /}

<form action="@{Application.registerUser()}" method="get">
Name: <input type="text" name="txtName"><br>
City: <input type="text" name="txtCity"><br>
Country: <input type="text" name="txtCountry"><br>
Zip: <input type="text" name="txtZip"><br>
<input type="submit" value="Submit">
</form> 
```

以下是`registerUser`应用程序控制器中的方法：

```
public static void registerUser(String txtName,String txtCity,String txtCountry,Integer txtZip){
    //some business logic
    render();
} 
```

上面的签名工作正常，但我必须在方法中添加很多我不想要的参数。

在一个表单中，我有超过 15 个字段，在这种情况下 15 个参数太多了！！！

因此，我需要知道如何将用户输入值绑定到模型（例如上面显示的用户模型）并将其作为`user`对象参数传递给控制器​​或作为具有键和值对的映射（更容易） ?

请让我知道这件事。

问候，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:32:44.233

将您的输入字段重命名为`user.name`,`user.city`等，并将控制器方法更改为

```
public static void registerUser(User user) 
```

这在[文档](http://www.playframework.org/documentation/1.2.5/controllers#pojo)中有所描述。

# android - appendQueryParameter 与选择参数

> ID：14674579
> 
> 赞同：0
> 
> 时间：2013-02-03T16:23:39.823
> 
> 标签：android, uri, android-contentprovider, android-contentresolver

我想知道如果在 URI 中指定选择参数或作为相应参数会有所不同吗？例如

```
Uri.Builder builder = Something.CONTENT_URI.buildUpon(); 
builder.appendQueryParameter("someColumn", "someValue");
Uri uri = builder.build();

getContext().getContentResolver().select(uri, null, null); 
```

相对

```
getContext().getContentResolver().select(
    Something.CONTENT_URI, 
    new String[]{"someColumn"}, 
    new String[]{"someValue"}
); 
```

我猜 ContentResolver 在内部解析和拆分 URI，所以它实际上并没有什么区别？

还是直接将 URI 传递给 ContentProvider，所以 ContentProvider 需要实现适当的 URI 解析？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:29:42.463

只需要自己弄清楚：尝试将例如 Events.CALENDAR_ID 作为 URI 参数传递给 CalendarContract.Events.CONTENT_URI，这给出了

```
E/AndroidRuntime(1714): java.lang.IllegalArgumentException: Invalid URI parameter: calendar_id
E/AndroidRuntime(1714):     at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:170) 
```

# linq - EF5代码第一个datetime2，构建一个linq表达式

> ID：14674582
> 
> 赞同：0
> 
> 时间：2013-02-03T16:23:46.117
> 
> 标签：linq, entity-framework

我想强制我域中的所有 DateTime 为 sql server 上的 datetime2。我知道我可以使用：

```
Property(x => x.Field).HasColumnType("datetime2"); 
```

在我的 EntityTypeConfiguration 派生类中。

但我想编写一些不那么“冗长”的代码。我尝试以下方法：

```
public static void SetDateTimeColumnType<T>(EntityTypeConfiguration<T> etc) where T : class {
    Type t = typeof(T);
    foreach (PropertyInfo pi in t.GetProperties(BindingFlags.Public | BindingFlags.Instance)) {
        if (pi.PropertyType.Name == "DateTime") {
            etc.Property(x => (DateTime)pi.GetValue(x)).HasColumnType("datetime2");
        }
    }
} 
```

但我得到以下异常：

```
The expression 'x => Convert(value(EFVIPRepository.ContextUtilities+<>c__DisplayClass0`1[ValkirIP.Domain.Entities.IPRight]).pi.GetValue(x))' 
is not a valid property expression. 
The expression should represent a property: C#: 't => t.MyProperty' VB.Net: 'Function(t) t.MyProperty'. 
Use dotted paths for nested properties: C#: 't => t.MyProperty.MyProperty'  VB.Net: 'Function(t) t.MyProperty.MyProperty'. 
```

我认为我真正的问题是如果可能的话，如何从属性名称构建“属性表达式”。

先感谢您

===== 编辑 =====

我也试试

```
Expression expr = Expression.Property(System.Linq.Expressions.Expression.Variable(t), pi);
etc.Property((Expression<Func<T, DateTime>>)expr).HasColumnType("datetime2"); 
```

除了以下例外：

```
Impossible d'effectuer un cast d'un objet de type 'System.Linq.Expressions.PropertyExpression' en type 'System.Linq.Expressions.Expression`1[System.Func`2[ValkirIP.Domain.Entities.IPRight,System.DateTime]]'. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:49:10.130

您必须构建正确`Expression Tree`的 .

试试这个：

```
public static void SetDateTimeColumnType<T>(EntityTypeConfiguration<T> etc) where T : class
{
    Type t = typeof(T);
    foreach (PropertyInfo pi in t.GetProperties(BindingFlags.Public | BindingFlags.Instance))
    {
        if (pi.PropertyType.Name == "DateTime")
        {
            var parameter = Expression.Parameter(t, "x");
            var property = Expression.Property(parameter, pi.Name);
            var lmbd Expression.Lambda<Func<T, DateTime>>(property, parameter);
            etc.Property(lmbd).HasColumnType("datetime2");
        }
    }
} 
```

# php - PHP MySQL - 从表 1 中选择不在表 2 中的值

> ID：14674583
> 
> 赞同：0
> 
> 时间：2013-02-03T16:24:00.727
> 
> 标签：php, mysql, arrays

这可能很容易解决，但我在这段代码上遇到了麻烦——我是一个自学 PHP 的新手，我想出的代码似乎不想工作。

这些页面用于体育比赛的在线输入系统。裁判的详细信息存储在“club_judges”表中，用户可以通过将它们复制到“competition_judges”中来参加比赛。这是通过表格中的复选框形式完成的。

我想添加功能，使已经加入比赛的评委不会出现在导入表单中，但是我的代码似乎不起作用。我正在使用“bg_number”（运动的标识号）的唯一字段来搜索现有条目。

当前代码：

```
$existing_judges = mysql_query("SELECT bg_number FROM competition_judges WHERE competition='Test Competition'");
$existing_judges_fetch = mysql_fetch_array($existing_judges);
$existing_judges_array = "('" . implode( "', '", $existing_judges_fetch ) . "');" ; 

$query = "SELECT * FROM club_judges WHERE (`club`='Test Club') AND (`bg_number` NOT IN '$existing_judges_array') ORDER BY name ";
$result = mysql_query($query) or die(mysql_error()); 
```

显示错误：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''('1234567', '1234567');') ORDER BY name' at line 1 
```

供参考 1234567 是我的测试法官的 bg_number。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:28:05.667

你为什么不只使用一个查询

```
SELECT * 
FROM club_judges 
WHERE `club`='Test Club' 
AND `bg_number`
NOT IN (SELECT bg_number FROM competition_judges WHERE competition='Test Competition')
ORDER BY name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T16:28:17.117

使用可以像这样使用单个查询：

```
$query = "SELECT * FROM `club_judges` WHERE `club`='Test Club' 
          AND 
          `bg_number` NOT IN 
              (SELECT `bg_number` FROM `competition_judges` WHERE `competition`='Test Competition')
           ORDER BY `name` ";
$existing_judges_fetch = mysql_fetch_array($existing_judges);
$result = mysql_query($query) or die(mysql_error()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T16:29:46.100

这是一个`JOIN`版本

```
SELECT  a.*
FROM    club_judges a
        LEFT JOIN competition_judges b
            ON  a.bg_number = b.bg_number AND
                b.competition='Test Competition'
WHERE   b.bg_number IS NULL AND
        a.club = 'Test Club'
ORDER   BY a.name 
```

要全面了解联接，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)

# php - 使用 MAMP 代替 localhost 在线测试

> ID：14674587
> 
> 赞同：1
> 
> 时间：2013-02-03T16:24:31.600
> 
> 标签：php, mysql, localhost, mamp

我是 PHP 的新手，所以我正在尝试学习一些东西。

我目前正在使用 MAMP 和 Localhost 在 Dreamweaver 中开发我的第一个 PHP 站点。

我已经购买了我的域名，并建立了一个较小的 html 站点，只是为了在 PHP 建立之前充当“托管站点”。如果我可以使用该域的子域而不是使用 localhost，我正在徘徊。因此，我可以访问 test.mysite.com，而不是访问 localhost/mysite。

如果我错了，请告诉我，但我不应该将任何文件上传到 GoDaddy，因为我使用 MAMP 作为服务器。对？

请记住，这不是永久性的。我不打算使用 MAMP 在我的计算机上托管我的网站。如果可能的话，我只是在徘徊，如果可能的话，该怎么做。

非常感谢任何建议、评论或答案。

谢谢。- 瑞安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:42:06.197

MAMP 不是服务器。MAMP 将服务器功能添加到您的计算机，但您不能使用 MAMP 来模仿任何服务器。

我建议您在计算机上使用 MAMP 并使用 localhost 作为“测试地址”。在本地主机中完成页面后，一切正常，您可以将页面上传到您的服务器（使用 FTP）。这样您就可以避免每次更改代码时都必须通过 FTP 上传文件。

欢迎来到 PHP 世界。无数杯咖啡和不安的夜晚等着您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T16:33:43.940

您可以在 Web 服务器上创建一些文件夹（在您的付费主机上）并从您的测试 localhost 文件夹上传所有文件。[如果您键入： https://yourwebsite.domain/yourfolder](https://yourwebsite.domain/yourfolder)，Everyting 将完美运行。如果要将其设置为像[http://yourfolder.yourwebsite.domain](http://yourfolder.yourwebsite.domain)一样查看，则必须从控制面板设置一个子域。子域是这样的：您输入映射到该子域的子域和文件夹的名称。例如，您设置子域[http://test.web.com](http://test.web.com)并将其映射到[http://web.com/testfolder](http://web.com/testfolder)。

我希望我能帮助你。

# ios - 清理 Documents 文件夹中的 .txt

> ID：14674588
> 
> 赞同：0
> 
> 时间：2013-02-03T16:24:32.083
> 
> 标签：ios, objective-c, xcode, text, nsuserdefaults

我正在将 .txt 文件添加到 Documents 文件夹以使用此处建立的解决方案存储一些数据： [Read Text File in Document Folder - Iphone SDK](https://stackoverflow.com/questions/2709705/read-text-file-in-document-folder-iphone-sdk)

所以现在我可以成功地从这个文件中写入和读取文本，但我还需要采取措施清除该文件中的所有文本以使其绝对为空。是否可以？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T16:35:00.890

在一行中，这应该这样做：

```
[[NSData data] writeToFile: pathToFile atomically: YES]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T16:41:14.917

这将循环所有文件 - 在 Documents Directory- 后缀为“txt”并删除其内容：

```
NSString* path = [NSHomeDirectory() stringByAppendingPathComponent:@"Documents"];
NSArray *arr = [[NSFileManager defaultManager] contentsOfDirectoryAtPath:path error:nil];
for (NSString *fileName in arr) {
    if ([fileName hasSuffix:@".txt"])
    {
        [@"" writeToFile:[path stringByAppendingPathComponent:fileName] atomically:YES encoding:NSUTF8StringEncoding error:nil];
    }
} 
```

# google-app-engine - 数据建模 - 在 NDB 中建模仅附加列表

> ID：14674589
> 
> 赞同：0
> 
> 时间：2013-02-03T16:24:40.473
> 
> 标签：google-app-engine, app-engine-ndb

我正在尝试制作通用数据结构。本质上，它将是客户端可以订阅的仅附加更新列表。客户端也可以发送更新。

我很好奇有关如何实现这一点的建议。我可以有一个包含数据和索引的 ndb.Model，“更新”，或者我可以在主实体上使用带有 Repeated=true 的 StructuredProperty。我也可以以某种方式存储键列表，然后将实际更新数据存储在非强链接结构中。

我不确定重复属性是如何工作的 - 附加到它们的列表（通过 Python API）是否必须全部重写它们？

我也担心一致性。由于多个客户端可能正在发送更新，我不希望它们相互覆盖并丢失更新，或者以某种方式结束具有相同索引的两个更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:28:28.327

问题是您对数据存储中的每个模型都有一个最大总大小。

因此，任何累积更新（直接存储数据或通过收集密钥）的单个模型*最终*都会耗尽空间（但不确定该限制如何应用于结构化属性）。

正如您所说，为什么没有模型“更新”，一个简单的版本是让每个提供的更新创建并保存一个新模型。如果您将保存日期作为模型中的一个字段进行跟踪，则可以在查询它们时按时间对它们进行排序（大概在某种程度上存在上限）。

此外，您不必担心同时客户端更新会相互覆盖，数据存储会为您担心。而且您不必担心他们被分配了什么“索引”，它是自动完成的。

由于这对于数据存储读取来说可能代价高昂，我相信您可以实现一个在单个中使用重复属性的版本，在存储 N 个键后移至新模型，但您必须将其包装在事务中才能成为确保多次更新不会发生冲突等等。

您还可以缓存生成结果的查询，并仅在保存新更新时使其无效。还可以查看 NDB，因为它提供了一些自动缓存（但不是用于查询）。

# web-applications - 在 iOS 上的全屏移动 Web 应用中使用 Addthis

> ID：14674595
> 
> 赞同：1
> 
> 时间：2013-02-03T16:25:27.403
> 
> 标签：web-applications, mobile, hyperlink, window, addthis

我有一个网络应用程序[http://aspekt.vni.io](http://aspekt.vni.io)。

这是一个全屏应用程序，我已经集成了 addthis。当我单击其中一项服务时，它会加载该服务的共享页面，但似乎会替换 Web 应用程序。当您将应用程序添加到您的主屏幕时 如果您单击顶部的非常漂亮的徽标，它将打开 safari 并转到正确的网页。但是，如果您单击其中一个 addthis 链接，它将停留在同一页面上。有什么方法可以强制它在 safari 中打开，或者至少在 iframe 中与模态框在同一页面上打开？

谢谢，豪伊

# c++ - cc1plus：错误：使用 g++ 无法识别的命令行选项“-std=c++11”

> ID：14674597
> 
> 赞同：95
> 
> 时间：2013-02-03T16:25:38.690
> 
> 标签：c++, c++11, compiler-errors, g++, std

我正在尝试使用`g++`or`-std=c++11`标志`c++0x`进行编译。

但是，我收到此错误

```
cc1plus: error: unrecognized command line option "-std=c++11" 
```

**g++ --版本**

```
g++ (GCC) 4.1.2 20080704 (Red Hat 4.1.2-54)
Copyright (C) 2006 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. 
```

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2013-02-03T16:33:22.763

从您的 G++ 版本来看，您需要对其进行严重更新。C++11 仅在 G++ 4.3 之后才可用。最新版本是 4.7。

在 G++ 4.7 之前的版本中，您必须使用`-std=c++0x`，对于更新的版本，您可以使用`-std=c++11`.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-03T16:30:48.777

引用[gcc 网站](http://gcc.gnu.org/projects/cxx0x.html)：

> C++11 功能在 GCC 的 Subversion 存储库的主干以及 GCC 4.3 及更高版本中作为“主线”GCC 编译器的一部分提供。要启用 C++0x 支持，请将命令行参数 -std=c++0x 添加到 g++ 命令行。或者，要启用除 C++0x 扩展之外的 GNU 扩展，请将 -std=gnu++0x 添加到您的 g++ 命令行。GCC 4.7 及更高版本也支持 -std=c++11 和 -std=gnu++11。

所以可能你使用的 g++ 版本不支持`-std=c++11`. 试试`-std=c++0x`吧。

C++11 功能的可用性仅适用于 >= 4.3 的版本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-20T16:46:27.490

你应该试试这个

```
g++-4.4 -std=c++0x or g++-4.7 -std=c++0x 
```

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2015-05-05T06:52:58.770

我也遇到了同样的错误，用 -D 标志编译修复了它，试试这个：

g++ -Dstd=c++11

# android - USB主机模式下的Android在pendrive中列出文件

> ID：14674603
> 
> 赞同：5
> 
> 时间：2013-02-03T16:25:53.017
> 
> 标签：android, file, usb, host, usb-drive

我有索尼平板电脑 S，我正在将 pendrive 连接到它。

我找到了可以让我：

*   - 查找连接的设备

*   - 找到它的接口

*   - 找到它的端点（读、写）

*   -我也可以打开设备

我的问题是：如何列出 pendrive 中的所有文件和目录？

根据我的阅读，有一些方法，例如

```
mDeviceConnection.controlTransfer(...) 
```

允许读取和写入 pendrive 但我如何列出 pendrive 中的文件和目录？

我希望能够获得 pendrive 中包含的文件的绝对路径，以便将它们传输到平板电脑上的 sd 卡。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:30:52.397

通常安装的 pendrive 位于文件夹中`/mnt/`，因此您可以从该文件夹中检索所有文件和文件夹。

```
File storageDir = new File("/mnt/");
if(storageDir.isDirectory()){
    String[] dirList = storageDir.list();
    //TODO some type of selecton method?
} 
```

某些设备的文件夹可能不同，例如。`/mnt/usb_storage/`

# android - 异步合并位图

> ID：14674609
> 
> 赞同：1
> 
> 时间：2013-02-03T16:27:12.920
> 
> 标签：android, bitmap, universal-image-loader

我使用`Android universal image loader`库从外部源下载图像。我需要合并 2 个位图（原始 + 本地 [动态图像]）并将它们显示在`ListView`.

现在我在 UI 线程上做它，当调用图像下载监听器时，但它真的很糟糕，很慢，不推荐。有什么方法可以访问处理类，以便可以异步完成合并，然后由库保存。实际上，我需要访问下载、解码和存储位图之间的瞬间。我试图扩展`BitmapDisplayer`类，但是我无法实现这一点，因为`BitmapDisplayer`在初始化时只设置了一次，`ImageLoader`并且我的本地图像（那些需要与下载的位图合并的图像）根据约束而变化，这与这个问题无关。

任何指针？

# algorithm - 标准库优先队列推送方法

> ID：14674621
> 
> 赞同：4
> 
> 时间：2013-02-03T16:28:58.280
> 
> 标签：algorithm, go, priority-queue

下面的代码片段是优先级队列的推送方法的库实现。我想知道为什么代码行`a = a[0 : n+1]`不会引发越界错误。

```
 func (pq *PriorityQueue) Push(x interface{}) {
    // Push and Pop use pointer receivers because they modify the slice's length,
    // not just its contents.
    // To simplify indexing expressions in these methods, we save a copy of the
    // slice object. We could instead write (*pq)[i].
    a := *pq
    n := len(a)
    a = a[0 : n+1]
    item := x.(*Item)
    item.index = n
    a[n] = item
    *pq = a
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T16:55:16.390

切片不是数组；它是现有阵列的视图。有问题的切片由一个比自身大的数组支持。当您定义现有切片的切片时，您实际上是在对底层数组进行切片，但引用的索引是相对于源切片的。

那是一口。让我们用以下方式证明这一点：我们将创建一个长度为零的切片，但我们将强制底层数组更大。使用 创建切片时`make`，第三个参数将设置底层数组的大小。该表达式`make([]int, 0, 2)`将分配一个大小为 2 的数组，但它的计算结果为大小为零的切片。

```
package main

import ("fmt")

func main() {
    // create a zero-width slice over an initial array of size 2
    a := make([]int, 0, 2)
    fmt.Println(a)

    // expand the slice.  Since we're not beyond the size of the initial
    // array, this isn't out of bounds.
    a = a[0:len(a)+1]

    a[0] = 1
    fmt.Println(a)
    fmt.Println(a[0:len(a)+1])
} 
```

[看这里](http://play.golang.org/p/YygcfTRQl5)。您可以使用`cap`关键字来引用支持给定切片的数组的大小。

您询问的特定代码`cap(pq)`在调用上下文中循环（container/heap/example_test.go 第 90 行）。如果您在调用站点修改代码并尝试将另一个项目推入队列，它会像您预期的那样恐慌。我......可能不会建议编写这样的代码。虽然标准库中的代码执行，但如果我在我的代码库中发现它，我会很生气。`append`使用关键字通常更安全。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T16:56:42.200

因为它适用于*特定*的示例程序。以下是原始/完整[示例源](http://golang.org/pkg/container/heap/#example_)中的重要部分）

```
const nItem = 10 
```

和

```
pq := make(PriorityQueue, 0, nItem) 
```

和

```
for i := 0; i < cap(pq); i++ {
        item := &Item{
                value:    values[i],
                priority: priorities[i],
        }
        heap.Push(&pq, item)
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T16:57:00.710

[它是容器/堆](http://golang.org/pkg/container/heap/#example_)的一个例子吗？如果是，那么它不会抛出异常，因为容量足够大（请参阅如何使用该`Push`方法）。如果您将示例更改为`Push`比容量更多的项目，那么它会抛出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T17:05:53.030

一般情况下是这样；示例中没有[`container/heap`](http://golang.org/pkg/container/heap/#example_)。这是我前段时间已经给你的一般修复。

```
func (pq *PriorityQueue) Push(x interface{}) {
    a := *pq
    n := len(a)
    item := x.(*Item)
    item.index = n
    a = append(a, item)
    *pq = a
} 
```

[Golang 解决 Project Euler 问题 #81](https://codereview.stackexchange.com/a/19374)

# jakarta-ee - Google 日历 API 适用性

> ID：14674629
> 
> 赞同：1
> 
> 时间：2013-02-03T16:29:59.893
> 
> 标签：jakarta-ee, google-calendar-api

我正在为我的学校开发预约网站。基本上，我希望能够创建多个用户帐户并拥有一个日历，您可以在其中查看其他教师/学生的可用时段并在可用时间预订会议，就像您在 Microsoft Outlook 日历上所做的那样。

环顾四周后，似乎人们建议制作日历实际上相当复杂，并建议使用 Google Calendar API。我一直在读这个，我想知道它是否适合我的项目。

我想要一个看起来类似于 Outlook 日历的前端，我只需要能够预订约会并在约会被预订时显示。谷歌日历 API 是否适合这个或者它是最重要的？我自己创造这个更好吗？我还可以在我的网站中使用 Google 日历 UI 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T18:57:12.953

您所描述的，*“看起来类似于 Outlook 日历的前端”*和*“能够预约并在预约时显示”*，正是 Google 日历和 Google Apps for EDU 已经存在的内容：

[google.com/a/edu](http://google.com/a/edu)

[support.google.com/calendar/bin/answer.py?hl=zh-CN&answer=2465776](http://support.google.com/calendar/bin/answer.py?hl=en&answer=2465776)

# python - cronjob-script 创建的日志的位置

> ID：14674631
> 
> 赞同：1
> 
> 时间：2013-02-03T16:30:13.757
> 
> 标签：python, cron, crontab

我以 root 用户身份运行 cronjob-script。该脚本位于**/root/scripts/myscript.py** 在这个 python 脚本中，我写入这样的文件

```
log = open(os.path.basename(__file__) + ".log", "w+")
print("some text", file=log) 
```

这应该创建一个名为**myscript.py.log**的文件，并且确实如此。但是这个文件位于**/root/myscript.py.log**。这是为什么？我希望它在脚本目录中创建。

我使用**Debian Squeeze**并通过**crontab -e**作为 root 用户添加作业。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:34:24.730

这是因为它取决于 cron 任务启动时的 cwd，cron 也可以更改目录，因此对于 cron 运行的作业始终使用绝对路径名，或者从命令行传入绝对存根。

在您的情况下 crontab -e 以 root 身份运行，cron 将以 root 身份运行您的脚本，因此使用该用户的主目录。即/根

# android - Android：AlertDialog 消息不会在 SDK < 11 上自动换行

> ID：14674635
> 
> 赞同：3
> 
> 时间：2013-02-03T16:30:23.763
> 
> 标签：android, android-alertdialog

我以`AlertDialog`编程方式构建时遇到问题：它的消息在运行 4.1.2 的模拟器中正确显示。但在我的设备（运行 2.3.7 的华为 U8510）上，消息不会自动换行。

有什么我可以添加到代码中以便 AlertDialog 允许其消息包装的吗？我显然不想添加手动换行符。（问题是，即使我添加了手动换行符，对话框也只会显示第一行）

我想我只是在这里遗漏了一些东西，但我在任何地方都找不到答案——它们都指的是手动添加换行符。

这是相关代码（是的，我现在使用的是硬编码）：

```
AlertDialog.Builder builder= new AlertDialog.Builder( activity );
builder.setPositiveButton( ...
builder.setNegativeButton( ...
builder.setTitle( "Wirklich löschen?" );
builder.setMessage( "Soll das Item \"" + deleteItem + "\" wirklich gelöscht werden?" );
AlertDialog dialog= builder.create();
dialog.show(); 
```

这是屏幕截图。您可以看到消息如何在模拟器（大图）上正确包装，但在设备上却看不到。

![设备 (2.3.7)](../Images/0dc8695808725d330c4e28e2b0ede002.png)

![模拟器 (4.1.2)](../Images/4437e2c06560db957150429859020086.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T16:58:43.773

我不确定是什么问题，或者它是特定于设备的还是什么，但我可以建议解决这种情况..您可以创建一个自定义布局，底部有一个 textview 和两个按钮，并将该布局附加到这个对话框. 现在您可以根据需要处理您的文本视图...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-24T02:22:15.437

我最近在一个从 Android Studio 移回 Eclipse 的项目中遇到了这个问题。

在这种情况下，问题是未定义 minSdkVersion。如果您不声明该属性，系统会假定默认值为“1”，这表示您的应用程序与所有版本的 Android 兼容。

显然 API 级别 1（甚至早于 Cupcake 1.5）没有包装 AlertDialog 消息文本。

问题已通过添加解决

```
<uses-sdk android:minSdkVersion="16" /> 
```

到 Android 清单。此应用程序需要 minSdkVersion 为 16（Jelly Bean）。我不知道 AlertDialog 何时开始包装消息文本，但早期的 API 级别，例如 10 (Gingerbread) 也可能有效。

另外，其他人发现在早期版本的 Android 上使用 Theme.Holo 可能会导致此问题，例如 [Android TextView 停止换行文本](https://stackoverflow.com/questions/8922671/android-textviews-stopped-wrapping-text)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T17:30:53.157

如果您希望所有 Android 版本的外观和感觉保持一致，您应该考虑使用自定义布局。

在这种情况下，一个简单的`TextView`应该可以完成这项工作。您可以设置样式、对齐和修改文本外观以匹配您需要的任何内容。

**custom_dialog.xml**：

```
<TextView
    android:id="@+id/custom_dialog_message"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:textColor="@color/white"
    android:textSize="20sp" /> 
```

然后使用以下方法将其应用于您的对话框：

```
dialog.setContentView(R.layout.custom_dialog); 
```

# java - 如何在所有 JSP 页面中实现 doGet 方法

> ID：14674637
> 
> 赞同：0
> 
> 时间：2013-02-03T16:30:42.773
> 
> 标签：java, jsp, servlets

我有继承 menu.jsp 页面的 page1.jsp。在 page1.jsp 的 servlet 上，doGet 调用数据库中的项目并将其显示在 menu.jsp 中。现在，当我转到另一个链接时，它会给我一个错误，因为新链接的 servlet 的 doGet 不提供对在我的 menu.jsp 中显示的项目的调用。它是提供所有页面所需的 doGet 的唯一选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:36:00.800

为应该支持 menu.jsp 的所有 servlet 创建一个抽象超类。在那里，您可以定义一个最终的 doGet 方法，您首先在其中执行菜单魔术，然后您可以委托给在扩展类中实现的抽象方法。

# opencv - RotatedRect 角度 - 稍微改变相机位置的奇怪行为

> ID：14674645
> 
> 赞同：2
> 
> 时间：2013-02-03T16:33:07.450
> 
> 标签：opencv, angle, rectangles

我使用 OpenCV 库（Win7 x64 和 Visual Studio 2010）。

我的工作包括检测一个经常旋转的矩形。为了检测矩形，我使用`squares.cpp`OpenCv，而不是使用返回的点`findSquares()`来创建一个 RotatedRect，这样：

```
for (size_t i = 0; i <squares.size(); i++) {

        RotatedRect box= cv::minAreaRect(Mat(squares[i])); 
```

哪里`squares`是返回的向量`findSquares()`。

现在我的问题是：当我`box.angle`在终端上打印时，我看到了一个奇怪的行为。有，在这张图片中 ![在此处输入图像描述](../Images/c6766a717cbfbb4beb71804f1b23ed39.png)

是`box.angle`正确的（大约是 0°）。但是，当我稍微改变我的相机位置时，`box.angle`变成了大约 -88°，正如你在第二张图片中看到的那样： ![在此处输入图像描述](../Images/226577789755ec3fe30a87c2d7626938.png)

我不明白为什么！！！！

有谁知道为什么这种奇怪的行为？？？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T10:37:00.153

这取决于您返回方形顶点的顺序。考虑到如果你从左下角开始，你的角度是正确的 -0.89º，它趋于零。如果您返回的第一个顶点是右下角，则您位于 -89.1º。这与 0.89 -90 的近似值相同。这仅取决于返回轮廓点的顺序。所以不用担心，根据轮廓点的顺序趋向于 0,90,180 或 270 的任何东西都是一个很好的结果。

亲切的问候，大卫

# php - 我可以通过 HTML 文件返回 JSON 数据吗？

> ID：14674649
> 
> 赞同：0
> 
> 时间：2013-02-03T16:33:43.217
> 
> 标签：php, jquery, json

这真的让我很烦恼，因为我无法用回声回应客户。

我需要用 JSON 响应以下数据，

```
header("Content-type: application/json");
$response = array();
$response['username'] = $user;
$response['password'] = $pass;
json_encode($response); 
```

但是，我需要通过 HTML 文件来完成，例如：

```
Template::set('response', json_encode($response)); 
```

原因是，我的框架总是需要这样的页面输出：

```
Template::set('response', array()); 
```

否则它会尝试自己执行。（要么是错误页面，要么是空 html 响应）

所以我不能用 JSON 标头和回显来响应。我基本上是想找到一种解决方法。如果我无法做到这一点，我会稍微调整我的框架以响应标题，但如果可能的话，我更喜欢使用一些解决方法。

附言。顺便说一句，这就是我的 jQuery 的运行方式。我相信这里没有问题，但我可能弄错了，所以也看看这个。

```
$("#doLogin").click(function(e) {
    e.preventDefault();  // prevent normal form submit
    $("#login-result").html('<img src="<%THEME%>images/loading.gif">');
    var formData = $("#loginForm").serialize();
    $.post("?page=login", formData, function(response)
    {
        alert(response.username);
        $("#login-result").html(response.username);
    },'json');
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:52:09.327

您必须修改框架的代码，或者适应它。

我建议您将业务逻辑和输出分开。在处理请求时，您不应该做任何回显，而是准备输出，并将输出变量传递给您的模板。您的模板应该独立于您的业务逻辑运行，仅取决于您传递的变量。这将使您的代码更具可读性和易于修改。

至于您当前问题的解决方案：我将通过添加一个传递数组的选项来扩展模板框架，并且框架会将其呈现为 json 对象。这将保持业务逻辑和视图分离，仍然为您提供满足您需求的简单解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T18:26:46.623

您可以通过以下方式规避框架尝试执行的操作：

```
header('Content-type: application/json');
echo json_encode($json);
exit; 
```

但是，如果框架不具备发出内置 JSON 的能力，我会感到非常惊讶。

# java - apache http客户端：“无路由到主机”情况的连接超时

> ID：14674652
> 
> 赞同：2
> 
> 时间：2013-02-03T16:33:53.620
> 
> 标签：java, apache-httpclient-4.x

我有一个`apache http client (4.2.1)`连接超时的问题，如果主机存在但没有及时响应，连接被超时关闭（一切都如预期的那样），但如果没有这样的主机，客户端等待的时间比预期的要长（大约 12 秒而不是配置中指定的 5 个）。最终这会导致 NoRouteToHostException，可能是由于特定的网络问题（当我试图在另一个网络中重现此问题时，我在等待 5 秒后遇到了套接字读取超时异常，正如预期的那样）。我正在使用以下超时设置：

*   http.socket.timeout = 5 秒
*   http.connection.timeout = 5 秒

任何想法表示赞赏。

## 更新

如果有人遇到过同样的问题，很可能是由客户端执行的连接重试引起的。解决问题后我会更新这篇文章

## 更新2

最终我已经能够解决这个问题。如果没有明确指定请求重试处理程序，则该问题是由 AbstractHttpClient（即 DefaultHttpClient 的父级）使用的 DefaultHttpRequestRetryHandler 执行的连接重试引起的。因此，如果您想摆脱它，只需指定重试次数较少的请求重试处理程序

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-11T16:59:56.897

最终我已经能够解决这个问题。如果没有明确指定请求重试处理程序，则该问题是由 AbstractHttpClient（即 DefaultHttpClient 的父级）使用的 DefaultHttpRequestRetryHandler 执行的连接重试引起的。因此，如果您想摆脱它，只需指定重试次数较少的请求重试处理程序

# sockets - 我可以在 Visual C++ 中使用 Indy 套接字吗？

> ID：14674657
> 
> 赞同：0
> 
> 时间：2013-02-03T16:34:29.267
> 
> 标签：sockets, visual-c++, indy

我想将 Borland(Embarcadero) C++ Builder 2010 项目移植到 Visual C++。障碍是 Indy Sockets 库。它工作得很好，但我需要它在 Microsoft 本机堆栈（不是托管 C# 端口）上。

简单地将 Indy 包含到 VC++ 项目中最终会变得丑陋，例如：

```
#if __BORLANDC__ < 0x500
#error BCW 5.0 or greater required
#endif 
```

或 #pragma delphiheader 开始

并且不编译...

甚至可能吗？

-斯坦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:17:02.187

Indy 是用 Delphi Pascal 编写的，因此只能使用 Borland/CodeGear/Embarcadero 或 FreePascal 编译器进行编译。

Indy 10 支持 .NET，但它的 .NET 程序集二进制文件很长时间没有重新编译（您必须使用 Delphi.NET 编译器来编译来自 Indy 的 SVN 的最新代码）。不过，Indy 11 可能会放弃对 .NET 的支持。

为了在 Visual C++ 环境中使用 Indy，您必须首先将其包装在 Delphi/FreePascal 编写的 DLL 中。

# macos - 如何开始使用 socket.io？

> ID：14674659
> 
> 赞同：2
> 
> 时间：2013-02-03T16:34:36.157
> 
> 标签：macos, node.js, socket.io

安装了 Node.js 和 socketio io（使用 npm）。节点`Hello World`工作。

使用以下行创建了 app.js：

```
var io = require('socket.io')(); 
```

节点`node app.js`抛出异常：

```
io_test.js:1
ts, require, module, __filename, __dirname) { var io = require('socket.io')();
                                                                       ^
TypeError: object is not a function 
```

怎么修？

OSX 10.7.5。Node.js 0.8.18。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T16:36:16.647

将该行替换为

```
var io = require('socket.io').listen(8080); 
```

基本上，如果您阅读错误描述，则 require('socket.io') 将返回一个对象，而不是您可以调用的函数。如果您查看 socket.io 网站上的示例代码，您可以看到您可以在返回的对象上调用 listen()。所以，你也可以这样写：

```
var sockio = require('socket.io')
var io = sockio.listen(8080) 
```

# jquery - 用于调用支付服务的表单 Action 的替代方案

> ID：14674664
> 
> 赞同：0
> 
> 时间：2013-02-03T16:35:09.350
> 
> 标签：jquery, asp.net, web-services

是否有任何可行的替代方案或替代品使用 jquery 或 webservice 进行表单操作来调用支付服务，如下所示：

```
<form name="ipg" action="https://pay.doku.com/DokuSuite/Channel" method="post" data-ajax="false"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T18:18:54.100

您可以使用 ajax 调用您的服务（该服务可以用任何服务器语言编写）：

在 javascript 中，您可以创建一个函数来使用 JQuery 通过 ajax 调用您的服务：

```
btnExecute_onclick = function() {

    $.ajax({
        url: "https://pay.doku.com/DokuSuite/Channel",
        type: "POST",
        data: {
            //parameters here
            anyParameterName: 'foo'
        },
        success: function( data ) {
            // do anything you want with data received from server
            // here I'm just showing the result in a div
            $( "#anyDiv" ).html( "Server return here: " + data + "" );
        }
    });

} 
```

在 html 中，您可以有一个这样的按钮：

```
<input type="button" id="btnExecute" onclick="btnExecute_onclick()"> 
```

您可以通过输入类型文本等表单标签从用户那里获取输入，并在您的 ajax 调用中作为参数发送。你可以在success函数中接收来自服务器的返回。

看[这里的ajax JQuery函数api](http://api.jquery.com/jQuery.ajax/)

# c# - 当前上下文中不存在名称“BodyTag”

> ID：14674672
> 
> 赞同：1
> 
> 时间：2013-02-03T16:36:04.400
> 
> 标签：c#, asp.net

我目前正在使用 Visual Studio 2012，并且对 ASP.NET 编程完全陌生。尽管如此，尽管搜索了谷歌并找到了一些看起来可能有帮助的东西，但我最终还是陷入了这种境地。大多数在当前上下文中不存在“名称”类错误的人似乎没有非常相似的问题，而且似乎与我无关。

到目前为止，我已经尝试过（删除并重新创建设计器文件，但无济于事。这是以前的一些 stackoverflow 问题所推荐的，并且（b，这个小解决方法可以从母版页外部访问 body 标签（即本质上是我在这里尝试做的）。

这是我的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.HtmlControls;

namespace WebApplication1
{
    public partial class _Default : Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            HelloWorldLabel.Text = "Hello" + TextInput.Text;
            if (Request.Cookies["BackgroundColor"] != null)
            {
                ColorSelector.SelectedValue = Request.Cookies["BackgroundColor"].Value;
                BodyTag.Style["background-color"] = ColorSelector.SelectedValue;
            }
        }

        protected void GreetList_SelectedIndexChanged(object sender, EventArgs e)
        {
            HelloWorldLabel.Text = "Hello, " + GreetList.SelectedValue;
        }

        protected void ColorSelector_IndexChanged(object sender, EventArgs e)
        {
            BodyTag.Style["background-color"] = ColorSelector.SelectedValue;
            HttpCookie cookie = new HttpCookie("BackgroundColor");
            cookie.Value = ColorSelector.SelectedValue;
            cookie.Expires = DateTime.Now.AddHours(1);
            Response.SetCookie(cookie);
        }
    }
} 
```

BodyTag 已在此处由此解决方法定义：

```
public HtmlGenericControl BodyTag
    {
        get
        {
            return MasterPageBodyTag;
        }
        set
        {
            MasterPageBodyTag = value;
        }
    } 
```

这似乎没有任何困难，但最终没有解决问题。我还导入了正确的类等。

请注意，我的母版页有这个：

```
<body id="MasterPageBodyTag" runat="server"> 
```

以防万一您认为这可能是问题所在。另请注意，这是由于合并了各种代码而创建的——我自己没有创建这个！我才刚刚开始并处理此类事情。

无论如何，非常感谢所有大大小小的帮助。在此先感谢您的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-17T19:26:39.577

要么你设置

```
<body id="BodyTag"  runat="server"> 
```

或者您将代码中的 BodyTag 更改为`"MasterPageBodyTag"`

# java - 从页面的内部 div 调用 response.redirect 以将新页面加载到浏览器上

> ID：14674673
> 
> 赞同：1
> 
> 时间：2013-02-03T16:36:05.943
> 
> 标签：java, ajax, jsp

我正在使用 ajax 加载方法将一些页面内容加载到我的 index.jsp 中名为“center_column”的内部 div。

```
$('#center_column').load('abc.jsp', function() {    }); 
```

但是在加载时我想检查会话超时并将请求重定向到登录页面。此会话超时代码位于“abc.jsp”中

我用了

```
response.sendRedirect("login.html"); 
```

方法。但这会在**#center_column** div 中重新加载 login.html。

但我想将 login.html 加载到浏览器上，而不是浏览器上的现有页面（ index.jsp ）。而且我想在不使用javascript的情况下解决这个问题。

谁能指导我解决这个问题

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-17T16:16:48.583

您必须使用 javascript，但它很少。尝试像这样处理服务器上的会话检查：

```
if (request.getSession(false) == null) {
    response.sendError(HttpServletResponse.SC_FORBIDDEN);
    return;
} 
```

然后在客户端的回调函数中，

```
$('#center_column').load('abc.jsp', function(responseText, textStatus, xhr) {
    if (xhr.status == 403)
        window.location = '/login.html';
}); 
```

# c - 当包含文件不存在时如何优雅地使 CMake 失败？

> ID：14674678
> 
> 赞同：5
> 
> 时间：2013-02-03T16:36:27.803
> 
> 标签：c, cmake

在 CMakeLists.txt 中，我想检查 bzlib.h 是否存在：

```
include(CheckIncludeFiles)
check_include_file(bzlib.h HAVE_BZLIB_H)
if(NOT HAVE_BZLIB_H)
    # How can I exit cmake with an error message if bzlib.h does not exists?
endif() 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-03T16:43:36.587

这很容易： `message( FATAL_ERROR "Your message" )`

# php - 搜索海量数据库时的速度

> ID：14674680
> 
> 赞同：4
> 
> 时间：2013-02-03T16:36:38.653
> 
> 标签：php, mysql, facebook, apache, rdbms

我是数据库新手。我想知道数据库中的一些事情。例如，我看到了 Facebook 如何存储朋友关系的结构（参见：[https](https://developers.facebook.com/docs/reference/fql/friend) ://developers.facebook.com/docs/reference/fql/friend ）。只有两列，第一个用户 id 和第二个用户 id。那没关系。

正如维基百科所说，Facebook 拥有大约 10 亿活跃用户。所以在那个朋友关系表中，可能有大约 1000 亿行。搜索该表非常快（例如：查看我的朋友列表）。我想知道他们是如何以这种速度做到的。

是因为 Facebook 有一些神奇的后端吗？还是数据库的魔力？我也可以使用 PHP 和 MySQL 来做（拥有数百万用户并在几秒钟内搜索数据库）吗？

（我可能会问一个愚蠢的问题，但它总是困扰我知道，请留下答案）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:42:18.237

数据库使用[索引](https://stackoverflow.com/questions/4506992/mysql-indexes-what-for)。通过这种方式，它可以快速找到与给定用户 ID 相关的数据。

根据索引结构、空间占用等...有一个好处，即不是搜索 N 列，而是搜索 - 例如 - `log(N)`。千亿行的二分法搜索

```
N = 100,000,000,000 
```

将会

```
Search(N) : search log2(N) = search (36 rows) 
```

而是搜索 10^12 行，只需要分析 36 行。

在你提到的情况下，朋友，每个用户可能有几个朋友，所以

```
user1 => (userX, userY, userZ, ...)
userX => (userU, userV, user1, ...) 
```

这意味着 user1 是 userX、userY 等的朋友……也就是说，您*没有*每个用户的唯一索引。但是每个用户都有一个唯一索引。

在 Mysql 上，那将是

```
UNIQUE(user1,user2) 
```

这意味着这对夫妇 (user1,user2) 在表中只有一次。语法是

```
CREATE UNIQUE INDEX friendsindex ON friends(user1,user2) 
```

*Friendsindex*是索引名称，*friends*是表。或者如您所说，将表*主键*声明为`(user1,user2)`（每个表的主键都是唯一的）。

--

赢得包括找到给定对象的确切价格的游戏的策略基于相同的原则。假设价格在 1 到 10000 之间。您说出价格，处理人员说`+`或`-`。您必须在尽可能少的尝试中找到价格。比如价格是6000。

您可以从开始`1`并给出所有价格，直到`6000`（即 6000 次尝试），但您也可以通过*二分法进行*

*   你：5000
*   玩家：+
*   7500 或 (10000 - 5000)/2
*   -
*   6250 或 (7500 - 5000)/2
*   -
*   ETC...

您在每次迭代时将剩余范围除以 2。您可以在 12 次尝试中找到，而不是 6000 次尝试 (log2(6000))。

--

关于[对数](http://en.wikipedia.org/wiki/Logarithm)

例如，如何在 中找到 x `2^x = 1024`？或`x = log2(1024)`表示*以 2 为底的 1024 的对数*（答案：10）。在我们的故事中，具有基于二叉树的索引的 1024 行表需要 10 次尝试（最多）才能找到正确的元素（而不是最多 1024 次）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T16:41:28.423

性能可能来自索引、缓存和[分片](https://en.wikipedia.org/wiki/Shard_%28database_architecture%29)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T16:43:02.643

Facebook 有一个服务器场。我认为他们设置了一个集群或其他东西来拥有几个相同的 sql 服务器副本。在这些 sql 数据库中，他们使用索引来加快搜索速度，但他们也可以在用户计算机上使用本地现金，这有助于他们获得更快的结果。

# windows - 如何在没有密钥文件的情况下生成 CSR？

> ID：14674681
> 
> 赞同：1
> 
> 时间：2013-02-03T16:36:49.657
> 
> 标签：windows, node.js, openssl, certificate, csr

我正在尝试从 Node.js 运行 OpenSSL 以创建 CSR。基本上，这工作正常，但现在我有一个我无法解决的问题。

基本上，我想做的是从一个密钥创建一个 CSR。适当的命令是

```
$ openssl req -key private.key -new -subj "/C=DE/ST=..." 
```

这会将 CSR 输出到标准输出。到目前为止，这很好。我现在要更改的是我不需要将私钥放在特殊文件中，而是想从标准输入中提供它。所以，基本上我想像这样运行 OpenSSL：

```
$ openssl req -new -subj "/C=DE/ST=..." 
```

但是由于`-key`现在缺少该参数，这会强制 OpenSSL 创建一个新的私钥。如何告诉 OpenSSL 不要创建新的私钥，而是使用我通过标准输入提供的私钥？

PS：我知道移交`/dev/stdin`给`-key`参数的选项，但这仅适用于 OS X 和 Linux，不适用于 Windows。

# python - Tkinter 窗口操作

> ID：14674686
> 
> 赞同：-1
> 
> 时间：2013-02-03T16:37:44.257
> 
> 标签：python, tkinter

对于初学者，我正在研究别人的代码。

在这段代码中，它打开一个初始的 tkinter 窗口，用户输入一些信息并按下一个按钮。然后另一个 tkinter 窗口打开，询问用户名和密码。用户提供信用并按下确定按钮。

除了子窗口，用户名密码窗口没有关闭之外，这一切都很好。

我已经破解了几个小时，而沮丧是我唯一的收获。

我已经能够用 destroy 关闭子窗口，但这会杀死整个应用程序。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:52:10.767

如果子窗口是 a `tk.Toplevel`，则可以通过让`ok`按钮调用`destroy`方法来关闭它：

```
import Tkinter as tk

class Child(object):
    def __init__(self, master=None):
        self.master = master
        window = tk.Toplevel(master)
        close_button = tk.Button(
            window, text='OK/Close', command=window.destroy)
        close_button.pack(side=tk.LEFT, padx=5, pady=5)

class MainApp(object):
    def __init__(self, master=None):
        self.master = master
        close_button = tk.Button(master, text='Child window',
                                 command=Child)
        close_button.pack(side=tk.BOTTOM, padx=5, pady=5)

root = tk.Tk()
app = MainApp(root)
root.mainloop() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T08:59:09.610

我不确定您何时要关闭窗口，但如果根本不需要该窗口，您可以使用`Window_name.withdraw()`

# jquery - 从后面的代码加载时将复选框设置为选中状态

> ID：14674689
> 
> 赞同：3
> 
> 时间：2013-02-03T16:38:03.160
> 
> 标签：jquery, checkbox

我在后面的代码中加载复选框列表的列表项，如下所示；

```
'load the fuel types into the checklist box
    For Each newitem As String In GetFuelTypes(Request.PhysicalApplicationPath & "OtherDataFiles\dataXML.xml")
        cblFuelstoDisplay.Items.Add(New ListItem(newitem))
    Next 
```

检查项目时，我使用以下 jquery 更改 css 样式；

```
$(document).ready(function () {
          $("#cbxarea").on("change", ":checkbox", function () {
              $(this).siblings("label").toggleClass("checkboxselected", $(this).is(":checked"));

          });              
      }); 
```

并且效果很好。但是，我将第一个复选框列表项设置为在 aspx 代码隐藏中选择的，并且您不能在那里设置 css 样式。在 doc.ready 之后，如何在 jquery 中更改页面加载样式？我尝试将其添加到脚本中，但它不起作用

```
$("#cbxarea:checkbox").each(function () {
              if( $(this).is(":checked")) {
                  $(this).toggleClass("checkboxselected");
              }
          }); 
```

这是复选框标记

```
 <fieldset style="height:140px;">
                <legend>Select a Fuel Type to Display</legend> 
                <div id="cbxarea" class="checkbox">
                    <asp:CheckBoxList ID="cblFuelstoDisplay" runat="server"  AutoPostBack="True" >              
                    </asp:CheckBoxList>
                </div>              
            </fieldset> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:40:05.507

您应该在选择器之间使用空格，而且您没有选择同级标签元素。

```
$("#cbxarea input[type=checkbox]:checked")
                             .siblings('label')
                             .addClass("checkboxselected"); 
```

您还可以触发更改事件：

```
$("#cbxarea").on("change", "input[type=checkbox]", function() {
    $(this).siblings("label").toggleClass("checkboxselected", this.checked);
}).change(); 
```

请注意，如果您的复选框是静态的，则无需使用事件委托。

```
$("#cbxarea input[type=checkbox]").on("change", function() {  }).change(); 
```

# php - XPath 和命名空间

> ID：14674691
> 
> 赞同：1
> 
> 时间：2013-02-03T16:38:09.630
> 
> 标签：php, xml, xpath, simplexml, kml

我已经看到了关于这个问题的[各种线程](https://stackoverflow.com/questions/352052/php-simplexml-why-does-xpath-stop-working)，但没有一个能够帮助我。基本上，我正在解释一个 KML 文件，目的是将其加载到地图中，但命名空间真的把我搞砸了。以下是 KML 的示例：

```
<?xml version="1.0" encoding="UTF-8">
<kml xmlns="http://www.opengis.net/kml/2.2" 
     xmlns:gx="http://www.google.com/kml/ext/2.2" 
     xmlns:kml="http://www.opengis.net/kml/2.2" 
     xmlns:atom="http://www.w3.org/2005/Atom">
 <Folder>
  <name>leeds primary schools (1 - 10)</name>
  <open>1<open>
  <Placemark>
      blah blah blah
  </Placemark>
  [etc etc etc] 
```

所以我的想法是我想获取页面上的所有 Placemark 元素。所以我正在使用这段代码：

```
$xml = simplexml_load_string($xml_string);
$xml->registerXPathNamespace("n", "http://www.opengis.net/kml/2.2");
$Placemarks = $xml->xpath("/n:Placemark"); 
```

然而，我被骗了，只是一个空数组。谁能看到我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:52:08.047

> $Placemarks = $xml->xpath("/n:Placemark");

这会尝试选择名为“ ”的*顶部元素*`n:Placemark`。

但是，顶部元素不是“ `Placemark`”——它是“ `klm`”

**解决方案**：

你要：

```
$Placemarks = $xml->xpath("/*/n:Folder/n:Placemark"); 
```

# extjs - KJSencha Formhandler 注释不起作用

> ID：14674693
> 
> 赞同：1
> 
> 时间：2013-02-03T16:38:21.210
> 
> 标签：extjs, extjs4, zend-framework2

我正在使用 Zend Framework 2 的 KJSencha 模块与 ExtJS 一起工作。模块是根据文档配置的。所有其他事情都很好。

我的应用程序必须模块 - 应用程序和后端。应用程序为空，但定义了 layout.phtml。后端模块有 index.phtml 和 IndexController，indexAction() 为空。

Backend\Direct\Model 中共有三种模型：Object、Single 和 Collection。它们用于直接。

后端\config\module.config.php

```
'kjsencha' => array(
    'direct' => array(
        'services' => array(
            'Direct.Tree' => 'Backend\Direct\Model\Tree',
            'Direct.Single' => 'Backend\Direct\Model\Object',
            'Direct.Collection' => 'Backend\Direct\Model\Collection',
        ),
    ),
) 
```

我想让 Object->update() 成为表单处理程序。

我花了几个小时寻找原因，但 apiBuilder 仍然没有将 'formHandler: true' 附加到我的方法中。

除了这个还有什么可以做的吗？

```
namespace Backend\Direct\Model;

class Object extends \Backend\Direct\Entity
{
    // .....

    /**
     * @\KJSencha\Annotation\Formhandler
     *
     */

    public function update($entity, $id)
    {
        // TODO: Implement update() method.
        return array();
    }
    // .....
} 
```

应用程序\视图\布局\布局.phtml

```
<?php
    echo $this->doctype(); ?>
<html lang="en">
<head>
    <meta charset="utf-8">
    <?php echo $this->headTitle('PROM-PC v.2') ?>
<?php

    echo $this->headLink();
    echo $this->headScript();
    ?>
</head>
<body>
<?php

    echo $this->content;
    echo $this->inlineScript();
?>

</body>
</html> 
```

后端\视图\后端\索引\index.phtml

```
<?php

$this->extJs()->loadLibrary();

// load custom variables set in configuration
$this->kjSenchaVariables();

// add loader configuration, which tells where ExtJs classes have to be loaded from
$this->kjSenchaLoaderConfig();

// preloads modules required to get the app running
$this->kjSenchaDirectApi();

// loads your actual application script (usually at the end of your body tag)
$this->inlineScript()->appendFile($this->basepath() . '/backend/js/app.js'); 
```

这是结果：

```
Ext.direct.Manager.addProvider({"type":"kjsenchamoduleremoting","url":"\/kjsencha\/rpc\/","actions":{"Direct.Tree":[{"name":"read","len":2},{"name":"update","len":2},{"name":"create","len":2},{"name":"destroy","len":2}],"Direct.Single":[{"name":"read","len":2},{"name":"create","len":2},{"name":"update","len":2},{"name":"destroy","len":2}],"Direct.Collection":[{"name":"read","len":2},{"name":"create","len":2},{"name":"update","len":2},{"name":"destroy","len":2}],"KJSencha.echo":[{"name":"__construct","len":1},{"name":"greet","len":1}]}}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T13:29:14.740

这是同样的问题 [Zend_Reflection 没有获得某些类的文档块](https://stackoverflow.com/questions/11836787/zend-reflection-doesnt-get-the-docblock-for-certain-classes)

解决方案：尝试将行尾从 Windows 转换为 Unix 样式。

它是 Zend\Reflection 的错误吗？

# c# - 如何在 C# MVC 中创建引用另一个模型两次的代码优先模型？

> ID：14674695
> 
> 赞同：2
> 
> 时间：2013-02-03T16:38:24.927
> 
> 标签：c#, asp.net-mvc, entity-framework, code-first

我试图了解如何使用代码优先方法来做到这一点。当我过去使用 SQL 语句和 ASP 编写更多代码时，我了解如何做到这一点。现在我正在尝试用 C# 中的代码优先 MVC 方法自学如何理解它。

首先，如果我要在 SQL 中解释我想要的东西，我希望重现这样的东西。

```
 Select s1.systemname, s2.systemname, j,jumplaneid 
    from systems s1, systems s2, jumplanes j 
    where s1.systemid = j.system1id and s2.systemid = j.system2id 
```

这是我的系统模型。

```
 public class system
    {
    public virtual int systemid { get; set; }
    public virtual string systemname { get; set; }
    public virtual int? posx { get; set; }
    public virtual int? posy { get; set; }
    public virtual int? starluminosityid { get; set; }
    public virtual int? stellartypeid { get; set; }
    public virtual int? starspectralclassid { get; set; }
    public virtual int? carry { get; set; }
    public virtual int? raw { get; set; }
    public virtual int? bio { get; set; }
    public virtual int? jumppoints { get; set; }
    public virtual int? specialrolls { get; set; }

    public virtual ICollection<settlement> settlements { get; set; }
    public virtual ICollection<fleet> fleets { get; set; }
    public virtual ICollection<Jumplane> jumplanes { get; set; }
    public virtual stellartype Stellartype { get; set; }
    public virtual starluminosity Luminosity { get; set; }
    public virtual starspectralclass SpectralClass { get; set; }
} 
```

我正在尝试创建一个可以引用端点系统模型的跳线模型。我是这样设置的，我认为它很接近，但并不完全在那里。想法？

```
public class Jumplane
{
    public virtual int jumplaneid { get; set; }
    public virtual int jumpcost { get; set; }
    public virtual string jumplanename { get; set; }
    public virtual system system1 { get; set; }
    public virtual system system2 { get; set; }
    public virtual ICollection<Supplyline> supplylines { get; set; }
} 
```

当我执行“更新数据库”以在数据库中设置所有内容时，我得到如下所示的跟踪：

```
 PM> update-database -force
    Specify the '-Verbose' flag to view the SQL statements being applied to the target database.
    No pending code-based migrations.
    Applying automatic migration: 201302030335260_AutomaticMigration.
    System.Data.SqlClient.SqlException (0x80131904): Either the parameter @objname is     ambiguous or the claimed @objtype (COLUMN) is wrong.
      at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
      at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
      at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
      at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
      at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout)
      at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite)
      at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
      at System.Data.Entity.Migrations.DbMigrator.ExecuteSql(DbTransaction transaction, MigrationStatement migrationStatement)
      at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.ExecuteSql(DbTransaction transaction, MigrationStatement migrationStatement)
      at System.Data.Entity.Migrations.DbMigrator.ExecuteStatements(IEnumerable`1 migrationStatements)
      at System.Data.Entity.Migrations.Infrastructure.MigratorBase.ExecuteStatements(IEnumerable`1 migrationStatements)
      at System.Data.Entity.Migrations.DbMigrator.ExecuteOperations(String migrationId, XDocument targetModel, IEnumerable`1 operations, Boolean downgrading, Boolean auto)
      at System.Data.Entity.Migrations.DbMigrator.AutoMigrate(String migrationId, XDocument sourceModel, XDocument targetModel, Boolean downgrading)
      at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.AutoMigrate(String migrationId, XDocument sourceModel, XDocument targetModel, Boolean downgrading)
      at System.Data.Entity.Migrations.DbMigrator.Upgrade(IEnumerable`1 pendingMigrations, String targetMigrationId, String lastMigrationId)
      at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.Upgrade(IEnumerable`1 pendingMigrations, String targetMigrationId, String lastMigrationId)
      at System.Data.Entity.Migrations.DbMigrator.Update(String targetMigration)
      at System.Data.Entity.Migrations.Infrastructure.MigratorBase.Update(String targetMigration)
      at System.Data.Entity.Migrations.Design.ToolingFacade.UpdateRunner.RunCore()
      at System.Data.Entity.Migrations.Design.ToolingFacade.BaseRunner.Run()
    ClientConnectionId:c4c1ba62-806b-4e68-bb0b-161da4d9e23e
    Either the parameter @objname is ambiguous or the claimed @objtype (COLUMN) is wrong. 
```

如果我先设置数据库，我知道该怎么做，但我正在尝试学习代码优先方法。任何更熟悉软件开发当前趋势的人能够指导我吗？

谢谢！

***更新：谢谢你们，从你们每个人身上学到了一些东西。***

这就是我结束的地方。

```
 public class Jumplane
{
    [Key]
    public int jumplaneid { get; set; }      
    [Range (1,1000)]
    public decimal jumpcost { get; set; }
    [Required]
    [StringLength(30)]
    public string jumplanename { get; set; }
    public virtual Starsystem starsystem1 { get; set; }
    public virtual Starsystem starsystem2 { get; set; }
    public virtual ICollection<Supplyline> supplylines { get; set; }
} 
```

和

```
public class Starsystem
{
    [Key]
    public int starsystemid { get; set; }
    public string systemname { get; set; }
    public int? posx { get; set; }
    public int? posy { get; set; }
    public int? starluminosityid { get; set; }
    public int? stellartypeid { get; set; }
    public int? starspectralclassid { get; set; }
    public int? carry { get; set; }
    public int? raw { get; set; }
    public int? bio { get; set; }
    public int? jumppoints { get; set; }
    public int? specialrolls { get; set; }

    public virtual ICollection<settlement> settlements { get; set; }
    public virtual ICollection<fleet> fleets { get; set; }
    public virtual ICollection<Jumplane> jumplanes { get; set; }
    public virtual stellartype Stellartype { get; set; }
    public virtual starluminosity Luminosity { get; set; }
    public virtual starspectralclass SpectralClass { get; set; }
} 
```

我将返回并捕获其他注释。因为我的头已经消失并且被尖尖的头发覆盖，所以我错过了注释的意义。

当您建议这是一个重命名问题时，我对 Update-Database 的问题变得很清楚。添加 -Verbose 选项让我非常清楚。我可能作弊了，但我通过删除其中的两个星系统引用来简化模型，更新数据库，然后将它们一一添加回来。

我也很欣赏关于类大写和使用“virtual”关键字的代码审查。我确实在 id 和 name 上留下了更具描述性的前缀，但这主要是为了我，因为如果我不使用它们，我以后可能会感到困惑。由于代码只适合我，我决定传递那条特别的建议，但反馈是（并且仍然是）最受欢迎的。

再次感谢你们的时间和专业知识。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T18:01:50.360

像您在 EF 中想要的那样的查询将类似于`dbContext.Jumplanes.Include("system1").Include("system2")`

话虽如此，您的模型没有属性/注释，一切都是虚拟的。当您希望延迟加载属性时，只需将其设置为虚拟属性。元素的主键不应该真正延迟加载。

看看`Key`和`ForeignKey`属性，用这些注释你的模型，删除不需要的虚拟关键字，然后让我们知道它是如何进行的:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T18:11:51.993

当您尝试重命名表时，通常会产生此错误。

我建议您创建模型并尝试以尽可能少的字段实现您想要的结果。此外，您只想在外国实体上使用`virtual`关键字。

我刚刚测试了类似的东西（Admin、AdminLog [包含 Admin1 和 Admin2]），它工作得很好。

## 您应该尝试的代码

```
public class System
{
    public int ID { get; set; }
    public string Name { get; set; }
}

public class Jumplane
{
    public int ID { get; set; }
    public virtual System System1 { get; set; }
    public virtual System System2 { get; set; }
} 
```

现在该代码可以运行，您将能够执行所需的 LINQ 查询，只需向其中添加所有其他字段。

一些指针（可能是主观的）

*   仅限外国虚拟
*   类以大写字母开头
*   不需要`SystemID`,`SystemName`字段，只是`ID`并且`Name`会做，因为你会看到它属于`System`

# iphone - 如果我在传递给它的方法中使用它，是否需要复制一个块？

> ID：14674698
> 
> 赞同：0
> 
> 时间：2013-02-03T16:38:38.637
> 
> 标签：iphone, objective-c, objective-c-blocks, grand-central-dispatch

我有一个类似的方法：

```
- (void)loadStoreWithCompletion:(CompletionBlock)loadCompletion
{
    dispatch_queue_t loadQueue = dispatch_queue_create("loadQueue", DISPATCH_QUEUE_SERIAL);

    dispatch_async(loadQueue, ^{

        // ... Do background stuff ...
    });

    dispatch_async(loadQueue, ^{

        dispatch_async(dispatch_get_main_queue(), ^{

            loadCompletion();
        });
    });

    dispatch_release(loadQueue);
} 
```

我是否需要复制该`loadCompletion`块，因为它只有在此方法的调用者不再存在时才可能被调用，还是这样可以？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T16:49:10.340

在另一个块中引用块参数的行为将导致它被隐式复制到堆中，因此您不需要显式这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T16:49:33.573

您可以依靠`dispatch_async()`直接传递给它的块来做正确的事情。同样的情况是，当一个块被复制时，它会复制它捕获的任何块。由于`loadCompletion`被内部块引用并且它没有用 声明`__block`，所以它被捕获。换句话说，你很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T16:43:16.803

这样就好了。但是您应该对代码进行 1 处更改：

```
dispatch_async(loadQueue, ^{
    dispatch_async(dispatch_get_main_queue(), ^{
        if (loadCompletion) {
            loadCompletion();       
        }
    });
}); 
```

你可以自己测试一下。如果您在没有任何参数 ( `[instance loadStoreWithCompletion:nil];`) 的情况下调用该方法，则在您的代码版本中，应用程序将在调用完成处理程序时崩溃。如果块不存在（不再存在），块检查将防止任何崩溃。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T16:43:38.480

调用者在堆栈上分配块，这意味着一旦超出范围，调用就会导致错误。

当您打算稍后使用它们时，您应该始终将它们复制到堆中（如在异步发生的回调中），您可以这样做

*   通过直接调用`[block copy]`
*   通过将它们存储在声明为的属性中`copy`

请注意，保留或释放它们并不总是有效，因为它们可能在堆栈中。

# iphone - View iOS 中的自定义 TabBar

> ID：14674700
> 
> 赞同：0
> 
> 时间：2013-02-03T16:38:55.943
> 
> 标签：iphone, ios, uitabbarcontroller, uitabbar

我正在尝试将一些选项卡添加到单个视图中，以便用户可以添加多个项目。

[![例子](../Images/9c0086d1c574f3821554ff9b4d8b0d23.png)](https://i.stack.imgur.com/TcU3e.png)

正如您可以看到选项卡的内容，只需稍微浏览整个视图，只需一点点，就在中间的栏中，上面的内容不会更改，当标签更改时不会更改。5 个视图的内容相同。

我还没有找到在iOS上复制它的方法，有什么想法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T18:27:47.913

有3种方法可以复制：

1) 使用 UISegmentedControl。这为您提供了所需的功能，但您可能无法使其看起来与您在图像中的样子完全相同。这是解决您的问题的最简单和最简单的方法。

2) 使用 5 个自定义 UIButtons 并排放置，管理按钮的状态，并根据它们的选择状态为这些按钮分配图像。如果按下按钮 1，其背景图像将为“lightRedImage”，所有其他按钮将为“darkRedImage”，依此类推。如果您不想使用太多图像，这是一个更好的选择，但是有更多代码来处理按钮状态。

3）为此，您需要所有 5 个选定状态的背景的完整图像。创建一个 5 个按钮宽的 imageView。在此 imageView 上放置 5 个自定义按钮，以 clearColor 作为背景。如果点击 button1，则 button1 的操作方法会将 imageView.image 设置为“highlightButton1.png”。如果您不介意将 backgroundImage 用于 5 种不同的可能状态，这会更好，并且代码更少，因为您唯一需要做的就是更新 UI 就是更改该 imageView 的背景。

注意：使用 UITabBar 和 UISegmentedControl，画外音功能是免费的。使用选项 #2 和 #3，由您来添加 UIAccessibility 属性以反映选择状态等。因此，如果您对应用程序的 Accessibility 和 VoiceOver 功能感到困扰，您应该记住这一点。（如果您不知道这些是什么，或者不介意，[请阅读此内容](http://mattgemmell.com/2010/12/19/accessibility-for-iphone-and-ipad-apps/ "读这个")）

# windows - 使用 EasyPhp 在 Windows 上的 Cron 选项卡

> ID：14674702
> 
> 赞同：0
> 
> 时间：2013-02-03T16:39:25.407
> 
> 标签：windows, cron, crontab, easyphp

是否可以制作一个仅请求页面的自定义 cron 选项卡？

每 5 分钟 ?

我不知道该怎么做..

这几乎是可能的吗？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-03T16:41:54.237

查看[PyCron或在](http://www.kalab.com/freeware/pycron/pycron.htm)[000WebHost](http://000webhost.com)上创建一个帐户，在那里上传您的文件，并在用户 CP 中添加一个 cron 作业，因为您只需要每 5 分钟运行一次（如果您的计算机不经常运行，我强烈推荐后者）。

# javascript - 具有 bg 颜色更改和淡入淡出 javascript 的横幅旋转器

> ID：14674704
> 
> 赞同：0
> 
> 时间：2013-02-03T16:39:34.323
> 
> 标签：javascript, html, image, fadein, rotator

我有以下代码：

```
<script type="text/javascript">
    var imgs = new Array("images/banner2.jpg", "images/banner3.jpg", "images/banner4.jpg");
    var alt = new Array();
    var bgcolor = new Array("#202020", "#00040F", "#202020");
    var currentAd = 0;
    var imgCt = 3;

    function cycle() {
        if (currentAd == imgCt) {
            currentAd = 0;
        }
        var div = document.getElementById('banner_bar');
        div.style.backgroundColor = bgcolor[currentAd]
        var banner = document.getElementById('adBanner');
        banner.src = imgs[currentAd]
        banner.alt = alt[currentAd]
        currentAd++;
    }
    window.setInterval("cycle()", 8000);        
</script>   
<div id="banner_bar">
    <img class="banner" src="images/banner4.png" id="adBanner"> 
</div> 
```

背景和图像更改效果很好，但我无法让淡入淡出工作。它要么破坏旋转器，要么什么都不做。关于如何通过重写轮换代码来做到这一点的任何想法？

编辑：我不知道我是否在正确的轨道上，但如果有人能把我推向正确的方向，我将不胜感激

```
 <script type="text/javascript">
        var imgs = new Array("images/banner2.jpg","images/banner3.jpg","images/banner4.jpg");
        var alt = new Array();
        var bgcolor = new Array("#FFF","#00040F","#000");
        var currentAd = 0;
        var imgCt = 3;
        function cycle() {
            if (currentAd == imgCt) {
                currentAd = 0;
            }
            $("#banner_bar").fadeOut(3000, function () {
                var div = document.getElementById('banner_bar');
                div.style.backgroundColor=bgcolor[currentAd]
                var banner = document.getElementById('adBanner');
                banner.src=imgs[currentAd]
                banner.alt=alt[currentAd]
                currentAd++;
            ) };
        }
        window.setInterval("cycle()",5000);
    </script>
    <div id="banner_bar">
        <img class="banner" src="images/banner4.jpg" id="adBanner">
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:48:51.673

就像 Pointy 提到的那样，没有通过任何褪色进行任何更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:06:09.873

如果您想使用 jQuery 使某些东西褪色，您可以使用 CSS 并分配具有 alpha 透明度的褪色属性，类似于此处所做的 - [http://tech.pro/tutorial/725/javascript-tutorial-simple-fade -动画](http://tech.pro/tutorial/725/javascript-tutorial-simple-fade-animation)。

虽然我通常已经在我的项目中使用 jQuery，所以我使用 .fade(); 因为我很懒。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T03:05:20.633

如果有人对此感到好奇。最后我使用了[http://jquery.malsup.com/cycle/](http://jquery.malsup.com/cycle/)。之前已经在这里提出过。我通过使用以下代码对我自己的函数进行回调来实现背景颜色更改：

```
 <script type="text/javascript">
    $(document).ready(function() {
        $('.slideshow').cycle({
            fx: 'fade', // choose your transition type, ex: fade, scrollUp, shuffle, etc...
            timeout: 5000,
             speed:   500,
            before: midBG,
            after: finalBG
        });
    });
    var fbgcolor = new Array("#313131","#000","#00040F","#FFF");
    var fcurrentAd = 0;
    var fimgCt = 4;
    function finalBG() { 
        if (fcurrentAd == fimgCt) {
                fcurrentAd = 0;
        }
        var fdiv = document.getElementById('banner_bar');
        fdiv.style.backgroundColor=fbgcolor[fcurrentAd]
        fcurrentAd++; 
    } 
    var mbgcolor = new Array("#989898","#191919","#000208","#808287");
    var mcurrentAd = 0;
    var mimgCt = 4;
    function midBG() { 
        if (mcurrentAd == mimgCt) {
                mcurrentAd = 0;
        }
        var mdiv = document.getElementById('banner_bar');
        mdiv.style.backgroundColor=mbgcolor[mcurrentAd]
        mcurrentAd++; 
    } 
</script> 
```

它可能有点粗糙，但它确实有效。我会继续在这里发帖，就好像我做了任何改变或改进一样！谢谢你们的建议。

〜马特

# c# - MVC 控制器方法参数始终为空

> ID：14674707
> 
> 赞同：1
> 
> 时间：2013-02-03T16:39:52.350
> 
> 标签：c#, javascript, asp.net-mvc-4

我的 javascript 函数正在调用我的 MVC 4 控制器，但参数始终为空。这似乎是一个常见问题，我已经尝试了一些我研究过的东西，但没有任何效果。知道为什么它总是为空吗？

我的 javascript GetEntries() 函数正确地创建了一个显示值的警报：

```
function GetEntries(firstLetter) {
    alert(firstLetter);
    $.post('/Home/GetEntries',
           firstLetter,
           EntriesReceived());
} 
```

我的控制器方法断点被命中：

```
public void GetEntries(string firstLetter)
{
    Debug.WriteLine(firstLetter);
} 
```

但是，firstLetter 始终为空。我不知道该怎么办。

**失败的尝试：**

**我尝试使用 JSON.stringify 发布。**

```
function GetEntries(firstLetter) {
    alert(firstLetter);
    var firstLetterAsJson = JSON.stringify(firstLetter);
    $.post('/Home/GetEntries',
           { jsonData: firstLetterAsJson },
            EntriesReceived());
} 
```

**我尝试将 HttpPost 属性添加到我的控制器：**

```
[HttpPost]
public void GetEntries(string firstLetter)
{
    Debug.WriteLine(firstLetter);
} 
```

**我尝试将参数名称更改为“id”以匹配我的路由映射：**

```
[HttpPost]
public void GetEntries(string id)
{
    Debug.WriteLine(id);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T16:41:41.303

以下应该工作

```
function GetEntries(firstLetter) {
    $.post('/Home/GetEntries', { firstLetter: firstLetter }, EntriesReceived);
} 
```

还要注意`EntriesReceived`回调是如何作为第三个参数传递给`$.post`函数的。在您的代码中，您似乎在调用函数 ( `EntriesReceived()`) 而不是将其作为回调传递。这里我假设这个函数是这样定义的：

```
function EntriesReceived(result) {
    // handle the result of the AJAX call here
} 
```

如果您想将其作为 JSON 请求发送，您应该使用 $.ajax 方法，该方法允许您指定正确的请求内容类型：

```
function GetEntries(firstLetter) {
    $.ajax({
        url: '/Home/GetEntries',
        type: 'POST',
        contentType: 'application/json; charset=utf-8',
        data: JSON.stringify({ firstLetter: firstLetter }),
        success: function(result) {
            // handle the result of the AJAX call here
        }
    });
} 
```

我在您的控制器操作中看到的另一个问题是您将其定义为`void`. 在 ASP.NET MVC 中，常见的既定约定是所有控制器操作都必须返回`ActionResult`类的实例。但是，如果您不想向客户端返回任何内容，则在这种情况下使用特定的 ActionResult - EmptyResult：

```
[HttpPost]
public ActionResult GetEntries(string firstLetter)
{
    Debug.WriteLine(firstLetter);
    return new EmptyResult();
} 
```

# visual-studio-2010 - 在所选文件中找不到派生自 dbContext 的可构造类型（EF Power Tools Beta 3 + VS 2010 SP1）

> ID：14674708
> 
> 赞同：0
> 
> 时间：2013-02-03T16:39:58.887
> 
> 标签：visual-studio-2010, entity-framework

每次尝试使用查看实体数据模型函数时都会出现此错误。对于我的星座（VS 2010 SP1，Power Tools Beta 3），在这个问题上没有任何发现。我已经尝试过的：

*   完全重新安装VS 2010
*   在新安装的 W7P64 机器上安装 VS 2010

没有帮助。微软表示使用 VS 2011 时可能会出现此错误（从未听说过！），解决方案是删除一些注册表项。不幸的是，我的机器上没有这样的注册表项。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T03:47:44.030

我有同样的问题。我通过升级安装MVC版本来解决这个问题我建议你安装ASP MVC3，如果你的项目在MVC3上链接是 [http://www.asp.net/mvc/mvc3](http://www.asp.net/mvc/mvc3)。

或者如果您的项目在 ASP MVC 4 中，请使用此链接：[http ://www.asp.net/mvc/mvc4](http://www.asp.net/mvc/mvc4)

# jquery - 在字段 Javascript 旁边显示验证错误

> ID：14674710
> 
> 赞同：2
> 
> 时间：2013-02-03T16:40:16.203
> 
> 标签：jquery, validation

我使用[Validate.Js](http://rickharrison.github.com/validate.js/)使用 jQuery 验证我的 HTML 表单，它运行良好。但是我需要在每个字段旁边显示错误，而不是在页面顶部显示所有错误的摘要。

HTML：

```
<div class="success_box">All of the fields were successfully validated!</div>
<div class="error_box"></div>

    <form name="example_form">
    <label for="req">Required field:</label>
    <label for="alphanumeric">Alphanumeric field:</label>
    <div id="AlphaNumeric"></div>

    <input name="req" id="req" />
    <input name="alphanumeric" id="alphanumeric" />

    <label for="password">Password:</label>
    <label for="password_confirm">Password Confirmation (match password):</label>

    <input name="password" id="password" type="password" />
    <input name="password_confirm" id="password_confirm" type="password" />

    <label for="email">Email:</label>
    <label for="minlength">Min length field (min. 8 chars):</label>

    <input name="email" id="email" />
    <input name="minlength" id="minlength" />

    <label for="tos_checkbox">Required checkbox (example: Terms of Service)</label>
    <input name="tos_checkbox" id="tos_checkbox" type="checkbox" />

    <button class="button gray" type="submit" name="submit">Submit</button>
</form> 
```

JavaScript：

```
 new FormValidator('example_form', [{
    name: 'req',
    display: 'required',    
    rules: 'required'
    }, {
    name: 'alphanumeric',
    rules: 'alpha_numeric'
    }, {
    name: 'password',
    rules: 'required'
    }, {
    name: 'password_confirm',
    display: 'password confirmation',
    rules: 'required|matches[password]'
    }, {
    name: 'email',
    rules: 'valid_email'
    }, {
    name: 'minlength',
    display: 'min length',
    rules: 'min_length[8]'
    }, {
    name: 'tos_checkbox',
    display: 'terms of service',
    rules: 'required'
    }], function(errors, event) {
    var SELECTOR_ERRORS = $('.error_box'),
        SELECTOR_SUCCESS = $('.success_box');

    if (errors.length > 0) {
        SELECTOR_ERRORS.empty();

        for (var i = 0, errorLength = errors.length; i < errorLength; i++) {
            SELECTOR_ERRORS.append(errors[i].message + '<br />');
        }

        SELECTOR_SUCCESS.css({ display: 'none' });
        SELECTOR_ERRORS.fadeIn(200);
    } else {
        SELECTOR_ERRORS.css({ display: 'none' });
        SELECTOR_SUCCESS.fadeIn(200);
    }

    if (event && event.preventDefault) {
        event.preventDefault();
    } else if (event) {
        event.returnValue = false;
    }
    }); 
```

有没有办法改变显示风格？有没有更好的脚本可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:45:38.620

> 引用：“但我需要在每个字段旁边显示错误，而不是在页面顶部显示所有错误的摘要。......有没有改变显示样式的方法？”

**没有**。 [根据文档](http://rickharrison.github.com/validate.js/)，没有列出如何放置错误消息的选项。

由于插件的描述说*“以 CodeIgniter 表单验证 API 为模型”*，这告诉我重点是在表单上方的单个摘要框中显示错误消息，就像 CodeIgniter 验证一样。如果您想在每个字段旁边显示单独的错误消息，您只是选择了错误的插件。

> 引用：“......还有更好的脚本可以做到这一点吗？”

**是**的。jQuery Validate 插件由 jQuery 团队的某个人开发。有巨大的支持基础和大量的选择。

> “该插件由 Jörn Zaefferer 编写和维护，他是 jQuery 团队的成员、jQuery UI 团队的首席开发人员和 QUnit 的维护者。它始于 2006 年 jQuery 的早期，并从那时起进行了更新和改进。 "

[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

[http://docs.jquery.com/Plugins/Validation/](http://docs.jquery.com/Plugins/Validation/)

默认情况下，错误显示在每个字段的“旁边”。

**见演示：http:** [//jsfiddle.net/UGyXP/](http://jsfiddle.net/UGyXP/)

**jQuery：**

```
$(document).ready(function() {

    $('#myform').validate({ // initialize the plugin
        rules: {
            field1: {
                required: true,
                minlength: 5
            },
            field2: {
                required: true,
                email: true
            }
        }
    });

}); 
```

**HTML：**

```
<form id="myform">  
     <input type="text" name="field1" />
     <input type="text" name="field2" />
     <input type="submit" />
</form> 
```

# windows-phone-7 - Windows Phone SMB 客户端

> ID：14674712
> 
> 赞同：2
> 
> 时间：2013-02-03T16:40:38.213
> 
> 标签：windows-phone-7, network-protocols, smb

我正在考虑通过允许用户录制收音机来改进我的免费软件 WP7 收音机应用程序。

如何将数据从 WP7 的隔离存储复制到 Windows PC 上的 NetBIOS 共享？

是否有任何东西（技术或法律）禁止根据[微软](http://msdn.microsoft.com/en-us/library/cc246482.aspx)在 Windows Phone 平台上的 .NET TCP 套接字之上的规范实现[SMB V2 协议？](http://en.wikipedia.org/wiki/Server_Message_Block#SMB2)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-25T14:37:51.667

[Samba](https://www.samba.org/)已经实现了 SMB/CIFS 并且它是开源的。我认为如果你也实现它应该是完全可以的..

# python - 鼻子：如何默认跳过测试？

> ID：14674713
> 
> 赞同：7
> 
> 时间：2013-02-03T16:40:44.400
> 
> 标签：python, nose, nosetests

我正在使用 Python 的鼻子，我已将我的一些测试标记为“慢”，如[attrib 插件文档](http://nose.readthedocs.org/en/latest/plugins/attrib.html)中所述。

我想在运行时默认跳过所有“慢”测试`nosetests`，即无需编写`nosetests -a '!slow'`。但是我希望能够在显式运行这些测试或编写`nosetests -a 'slow'`.

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T16:59:38.707

“选项与命令行中的选项相同，但删除了 -- 前缀”（[https://nose.readthedocs.org/en/latest/usage.html#configuration](https://nose.readthedocs.org/en/latest/usage.html#configuration)）

`setup.cfg`具有以下内容的文件应该可以工作：

```
[nosetests]
attr=!speed=slow 
```

# java - 我想我正在迭代 key(itr) 错误的方式？

> ID：14674714
> 
> 赞同：1
> 
> 时间：2013-02-03T16:41:01.033
> 
> 标签：java, collections

这是我用 Java 编写的代码，itr 是密钥的迭代器，我在迭代密钥时遇到了问题，代码的问题是：我们得到一个 2n 整数数组，其中每一对在这个数组中整数分别代表恐龙的出生年份和死亡年份。我们要考虑的有效年份范围是 [-100000 到 2005]。例如，如果输入是：

-80000 -79950 20 70 22 60 58 65 1950 2004

这意味着第一只恐龙的出生年份分别为 –80000 年和死亡年份 –79950 年。同样，第二只恐龙的寿命从 20 岁到 70 岁，以此类推。

我们想知道同时存在的最大数量的恐龙。给定上面的 2n 个整数数组，编写一个方法来计算它。

编写以下方法之一：

C/C++: int find_max_dinosaur (int[] 年);

Java: public int findMaxdinosaur (int[] 年);

```
package usingarray;

int dinoStrength;
int deathOfDino;
int dinoBirthAge;
int currentDinoBirthAge;
int currentDinoDeathAge;
int count;

TreeMap dino=new TreeMap();
List<Integer> dinos = new ArrayList<Integer>();

Scanner sc=new Scanner(System.in);

public void getDionoAges()
{
    System.out.println("How many Dinosaur");
    dinoStrength=sc.nextInt()+1;
    for(int i=1;i<dinoStrength;i++)
    {
        System.out.println("Please enter "+i+" dino birth age and death age:");
        dino.put(sc.nextInt(),sc.nextInt());
    }
}

public void logic()
{
    Collection value = dino.values();
    Collection key = dino.values();
    Iterator it = value.iterator();
    Iterator itr = key.iterator();

    System.out.println("logic");

    for(int x=0;x<dinoStrength;x++)
    {
        System.out.println("in for");
    while(it.hasNext() && itr.hasNext())
        {
            System.out.println("in while");
            deathOfDino=(int) it.next();
            //currentDinoDeathAge=(int) it.next();
            dinoBirthAge=(int) itr.next();

            while(itr.hasNext())
            {
                System.out.println("In itr while");
                currentDinoBirthAge=(int) itr.next();
                if(dinoBirthAge<=currentDinoBirthAge && currentDinoBirthAge<=deathOfDino)
                {
                    count++;
                    System.out.println(count);
                }
            }
            dinos.add(count);
        }
    }
}

public void display()
{
    Iterator<Integer> it = dinos.iterator();
    while(it.hasNext())
    {
        System.out.println(it.next());
    }
}
public static void main(String[] args) {
    VickyDino vd=new VickyDino();
    vd.getDionoAges();
    vd.logic();
    vd.display();
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:46:47.193

我会假设你的问题是这样的：

```
Collection value = dino.values();
Collection key = dino.values(); 
```

你用`dino.values()`了两次；第二个应该是`dino.keys()`。但是，由于您将出生年份放入键中，将死亡年份放入值中，您可能想要切换两者。注意：我没有检查循环中的逻辑是否正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T08:22:15.943

/* 问题：给定一个由 2n 个整数组成的数组，其中这个整数数组中的每一对分别代表恐龙的出生年份和死亡年份。我们想要的有效年份范围......分别是恐龙的死亡。我们要考虑的有效年份范围是 [-100000 到 2005]。

*/

公共 int findMaxdinosaur (int[] 年) {

```
 int[] birthDino = new int[years.length];
    int[] deathDino=new int[years.length];

      //Now  birth & death list is made in which death contains even place.

       for(int i=0;i<=years.length-2;i=i+2){  
           birthDino[i]=years[i];
           deathDino[i+1]=years[i+1];
          }
     Arrays.sort(birthDino);
     Arrays.sort(deathDino);
   List<Integer> al=new ArrayList<Integer>();//List is need because i need to remove null values from here
       for(int aa: birthDino){
            al.add(aa);
       }
      al.removeAll(Collections.singleton(0));// Removing all positions which contain null values
    // System.out.println(al);
     List<Integer> all=new ArrayList<Integer>();
       for(int aa: deathDino){
         all.add(aa);                             //adding in to the List
        }
     all.removeAll(Collections.singleton(0));

 int  Alive=0,maxDinos=0,LastBornMax=0;
 int b = 0,d=0;

    while( b!=birthDino.length && d!=deathDino.length) {
            if (birthDino[b] < deathDino[d])  {
                  Alive =  Alive + 1;
                  b = b + 1;
                } 
                 else {
                         Alive =  Alive - 1;
                        d = d + 1  ;    
                       }

            if(maxDinos <  Alive){  //checking the values
                maxDinos =  Alive;
                LastBornMax=birthDino[b-1];
                }
       }//while end

    //S N Prasad Rao.
      return maxDinos;
}//end of method 
```

# string - 将字符串分配给int？

> ID：14674715
> 
> 赞同：-1
> 
> 时间：2013-02-03T16:41:11.160
> 
> 标签：string, int

为班级做这个作业，我不确定这部分是什么意思。我们应该创建一个程序，提示用户输入命令并存储它们，但命令应该是整数，但里面有字母。不知道如何处理。

int getCommand() 返回 CMD_LET、CMD_DOC、CMD_PRINT、CMD_DO、CMD_HISTORY 或 CMD_END 以指示它是什么命令。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:47:23.003

您可以使用 ENUM 来执行 JOB 和 ENUM 映射，例如 CMD_LET=1、CMD_DOC=2 等等，每种编程语言的 enum 实现应该几乎相同

# css - 相对定位的容器完全封闭绝对定位的儿童

> ID：14674721
> 
> 赞同：0
> 
> 时间：2013-02-03T16:41:37.357
> 
> 标签：css, css-position

我在 position:relative 容器中有一些 position:absolute 元素。

有没有办法让容器完全包围它的孩子？

例如，如果我给容器一个背景颜色，我想看到所有绝对定位元素下面的背景颜色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:50:31.127

Noope，你必须给父母一些宽度和一些高度。在阅读这篇文章之前，我并没有完全理解 CSS Floats：

[http://alistapart.com/article/css-floats-101](http://alistapart.com/article/css-floats-101)

# mysql - 需要从多个表中选择

> ID：14674731
> 
> 赞同：0
> 
> 时间：2013-02-03T16:42:45.820
> 
> 标签：mysql, sql, select, join

因此，我的表如下（每个表中的主键是 PhoneID、ManufacturerID 和 OSID。外键在名称前标有星号）：

**电话**

```
PhoneID
*ManufacturerID
Model
*OSID
Description
ScreenSize
Price
StockQuantity
StorageSize
Image
Thumbnail
IsFlagged 
```

**制造商**

```
ManufacturerID
Name
Details
Telephone 
```

**操作系统**

```
OSID
Name
Company
Description 
```

我需要做的基本上是一个查询，它将获取制造商名称和手机型号以及其他详细信息并显示它。例子：

如果我有：

三星在制造商行中的制造**商**

**手机**中的型号行中的 Galaxy S3

 ****来自Phones**的 StorageSize 行中的 16GB

 ****操作系统**名称行中的 Android 4.2

 ****电话**中的价格行中的 499.99

 **我将如何构建查询，以便句子“Samsung Galaxy S3 16GB - Android 4.2 - £499.99？

很抱歉这篇冗长的帖子，感谢我收到的任何帮助/答案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:45:16.443

> 我将如何构建查询，以便句子“Samsung Galaxy S3 16GB - Android 4.2 - £499.99？

```
select  concat(m.Manufacturer, ' ', p.Model, ' ', p.StorageSize, ' - ',
            o.Name, ' - ', p.Price)
from    Phones p
join    Manufacturer m
on      p.ManufacturerID = m.ManufacturerID
join    OS o
on      p.OSID = o.OSID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T16:45:33.010

基本上你需要加入表格，

```
SELECT  a.*, b.*, c.*  -- select only the columns you want.
FROM    Phones a
        INNER JOIN Manufacturer b
            ON a.ManufacturerID = b.ManufacturerID
        INNER JOIN OS c
            ON a.OSID = c.OSID
-- WHERE    .... put the condition here ... 
```

如果您希望在查询中生成句子，您也可以使用[**CONCAT**](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat)（或[**CONCAT_WS**](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat-ws)），您也可以在前端执行所有操作。

要全面了解联接，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)

其他链接

*   [更多 MySQL 字符串函数](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html)********

# python - Python-daemon：保持记录

> ID：14674733
> 
> 赞同：3
> 
> 时间：2013-02-03T16:43:10.643
> 
> 标签：python, python-2.7

我有一个将一些数据记录到磁盘的脚本：

`logging.basicConfig(filename='davis-debug.log',level=logging.DEBUG) logging.basicConfig(filename='davis-error.log',level=logging.ERROR) logging.basicConfig(filename='davis-error.log',level=logging.WARNING) logging.basicConfig(filename='davis-error.log',level=logging.CRITICAL)`

当我像这样使用 python-daemon 时，日志记录会停止。

```
try:
  with daemon.DaemonContext():
  station = VantageProStation()
  station.run()

except KeyboardInterrupt:
  logging.critical('Stopping user aborted with CTRL+C')
pass 
```

我试过 file_preserve，但 logging.basicConfig 不返回流。
我也不能使用 files_preserve 传递多个流..？
我当然希望我的日志记录继续，我试图将日志定义放在我的类**init**中，但这也无济于事。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-03T17:07:49.173

在你的守护进程中配置你的记录器怎么样？这对我有用：

```
#!/usr/bin/env python

import daemon
import logging
import logging.handlers
from time import sleep
from datetime import datetime

def time_logging_daemon():
    logger = logging.getLogger('time_logging_daemon')
    logger.addHandler(logging.handlers.SysLogHandler(address='/dev/log'))
    logger.setLevel(logging.INFO)
    while True:
        logger.info(datetime.now())
        sleep(1)

with daemon.DaemonContext():
    time_logging_daemon() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-22T21:52:19.360

守护程序上下文将所有文件处理程序关闭为“表现良好的守护程序”，除了`files_preserve`. 你是在正确的方向。

有一种方法可以从中获取文件处理程序，`logging`但我建议您明确创建文件记录器。

```
#!/usr/bin/env python

import daemon
import logging
import logging.handlers
from time import sleep
from datetime import datetime

logging.basicConfig()

file_logger = logging.FileHandler("/tmp/aaa.log", "w")

logger = logging.getLogger()
logger.addHandler(file_logger)
logger.setLevel(logging.INFO)

with daemon.DaemonContext(files_preserve=[file_logger.stream.fileno()]):
    while True:
        logger.info(datetime.now())
        sleep(1) 
```

# javascript - 如何使用 javascript 进行日期提醒？

> ID：14674743
> 
> 赞同：-2
> 
> 时间：2013-02-03T16:44:48.407
> 
> 标签：javascript, date

我对javascript不太了解。所以请帮帮我。

如何设置 2013 年 3 月 1 日凌晨 3:00:00 的倒计时？

喜欢;

日期前：x 天 x 时间 x 分钟

日期：是的，3 月 1 日

日期之后：您错过了这一天:(

我之前发布过一个问题，但我没有很好地描述它。我希望这次我做到了。请帮忙。我真的需要在我的网页上设置倒计时（HTML）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:55:14.000

使用此代码，您可以知道从 date1 到 date2 还剩多少天

```
var date1 = new Date("Feb 3 2013 10:49:00");
var date2 = new Date("Feb 4 2013 10:49:00");

var days = (date2 - date1) / 1000 / 60 / 60 / 24;
document.write( "remain "  + days + " to <b>" +date2 + "</b>"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T16:50:37.507

```
var x=new Date();
x.setFullYear(2013,2,1);
var today = new Date();

if (x>today)
  {
  alert("You missed the day.");
  }
else if (x<today)
  {
  alert("x day left");
  }
else {
  alert("This is the day");
  } 
```

您只需要计算剩下的 X 天。

(2013,2,1) 在 JavaScript 中表示 2013 年 3 月 1 日。[参考](http://www.w3schools.com/js/js_obj_date.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T16:51:19.953

整个互联网？伙计，这是很多搜索。

[这也在互联网上。](http://www.w3schools.com/js/js_obj_date.asp)

```
var x=new Date();
x.setFullYear(2013,2,1);
var today = new Date();

if (x>today) {
    alert("Today is before March 1st, 2013");
} else {
    alert("Today is after March 1st, 2013");
} 
```

# c# - 动态将标签更改为文本框的最佳实践

> ID：14674745
> 
> 赞同：0
> 
> 时间：2013-02-03T16:45:02.047
> 
> 标签：c#, windows-8, windows-runtime, winrt-xaml, windows-store-apps

我有一个小的 WinRT XAML 标签，它显示了用户的名字。现在，当有人点击“编辑”按钮时，我想将其更改为 TextBox（可能带有灯光动画）。

什么是实现这一点的好方法？

下一步是在某些情况下，标签显示在单击时更改为 TextBox。

有没有办法使用样式来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:12:49.067

始终使用 TextBox，但在未聚焦时更改模板。为此，您可以在 Blend 中打开 XAML 文件，右键单击文本框并选择“编辑模板”/“编辑副本...”。然后“状态”选项卡将显示为模板定义的视觉状态，您可以隐藏“正常”状态的背景和边框。

这是我刚做的一个样本：

```
<Page
    x:Class="App103.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:App103"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">
    <Page.Resources>
        <Style
            x:Key="FlatTextBoxStyle"
            TargetType="TextBox">
            <Setter
                Property="MinWidth"
                Value="{StaticResource TextControlThemeMinWidth}" />
            <Setter
                Property="MinHeight"
                Value="{StaticResource TextControlThemeMinHeight}" />
            <Setter
                Property="Foreground"
                Value="{StaticResource TextBoxForegroundThemeBrush}" />
            <Setter
                Property="Background"
                Value="{StaticResource TextBoxBackgroundThemeBrush}" />
            <Setter
                Property="BorderBrush"
                Value="{StaticResource TextBoxBorderThemeBrush}" />
            <Setter
                Property="BorderThickness"
                Value="{StaticResource TextControlBorderThemeThickness}" />
            <Setter
                Property="FontFamily"
                Value="{StaticResource ContentControlThemeFontFamily}" />
            <Setter
                Property="FontSize"
                Value="{StaticResource ControlContentThemeFontSize}" />
            <Setter
                Property="ScrollViewer.HorizontalScrollBarVisibility"
                Value="Hidden" />
            <Setter
                Property="ScrollViewer.VerticalScrollBarVisibility"
                Value="Hidden" />
            <Setter
                Property="ScrollViewer.IsDeferredScrollingEnabled"
                Value="False" />
            <Setter
                Property="Padding"
                Value="{StaticResource TextControlThemePadding}" />
            <Setter
                Property="Margin"
                Value="0,0,0,10" />
            <Setter
                Property="TextWrapping"
                Value="Wrap" />
            <Setter
                Property="VerticalAlignment"
                Value="Top" />
            <Setter
                Property="Template">
                <Setter.Value>
                    <ControlTemplate
                        TargetType="TextBox">
                        <Grid>
                            <Grid.Resources>
                                <Style
                                    x:Name="DeleteButtonStyle"
                                    TargetType="Button">
                                    <Setter
                                        Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate
                                                TargetType="Button">
                                                <Grid>
                                                    <VisualStateManager.VisualStateGroups>
                                                        <VisualStateGroup
                                                            x:Name="CommonStates">
                                                            <VisualState
                                                                x:Name="Normal" />
                                                            <VisualState
                                                                x:Name="PointerOver">
                                                                <Storyboard>
                                                                    <ObjectAnimationUsingKeyFrames
                                                                        Storyboard.TargetProperty="Background"
                                                                        Storyboard.TargetName="BackgroundElement">
                                                                        <DiscreteObjectKeyFrame
                                                                            KeyTime="0"
                                                                            Value="{StaticResource TextBoxButtonPointerOverBackgroundThemeBrush}" />
                                                                    </ObjectAnimationUsingKeyFrames>
                                                                    <ObjectAnimationUsingKeyFrames
                                                                        Storyboard.TargetProperty="BorderBrush"
                                                                        Storyboard.TargetName="BorderElement">
                                                                        <DiscreteObjectKeyFrame
                                                                            KeyTime="0"
                                                                            Value="{StaticResource TextBoxButtonPointerOverBorderThemeBrush}" />
                                                                    </ObjectAnimationUsingKeyFrames>
                                                                    <ObjectAnimationUsingKeyFrames
                                                                        Storyboard.TargetProperty="Foreground"
                                                                        Storyboard.TargetName="GlyphElement">
                                                                        <DiscreteObjectKeyFrame
                                                                            KeyTime="0"
                                                                            Value="{StaticResource TextBoxButtonPointerOverForegroundThemeBrush}" />
                                                                    </ObjectAnimationUsingKeyFrames>
                                                                </Storyboard>
                                                            </VisualState>
                                                            <VisualState
                                                                x:Name="Pressed">
                                                                <Storyboard>
                                                                    <ObjectAnimationUsingKeyFrames
                                                                        Storyboard.TargetProperty="Background"
                                                                        Storyboard.TargetName="BackgroundElement">
                                                                        <DiscreteObjectKeyFrame
                                                                            KeyTime="0"
                                                                            Value="{StaticResource TextBoxButtonPressedBackgroundThemeBrush}" />
                                                                    </ObjectAnimationUsingKeyFrames>
                                                                    <ObjectAnimationUsingKeyFrames
                                                                        Storyboard.TargetProperty="BorderBrush"
                                                                        Storyboard.TargetName="BorderElement">
                                                                        <DiscreteObjectKeyFrame
                                                                            KeyTime="0"
                                                                            Value="{StaticResource TextBoxButtonPressedBorderThemeBrush}" />
                                                                    </ObjectAnimationUsingKeyFrames>
                                                                    <ObjectAnimationUsingKeyFrames
                                                                        Storyboard.TargetProperty="Foreground"
                                                                        Storyboard.TargetName="GlyphElement">
                                                                        <DiscreteObjectKeyFrame
                                                                            KeyTime="0"
                                                                            Value="{StaticResource TextBoxButtonPressedForegroundThemeBrush}" />
                                                                    </ObjectAnimationUsingKeyFrames>
                                                                </Storyboard>
                                                            </VisualState>
                                                            <VisualState
                                                                x:Name="Disabled">
                                                                <Storyboard>
                                                                    <DoubleAnimation
                                                                        Duration="0"
                                                                        To="0"
                                                                        Storyboard.TargetProperty="Opacity"
                                                                        Storyboard.TargetName="BackgroundElement" />
                                                                    <DoubleAnimation
                                                                        Duration="0"
                                                                        To="0"
                                                                        Storyboard.TargetProperty="Opacity"
                                                                        Storyboard.TargetName="BorderElement" />
                                                                </Storyboard>
                                                            </VisualState>
                                                        </VisualStateGroup>
                                                    </VisualStateManager.VisualStateGroups>
                                                    <Border
                                                        x:Name="BorderElement"
                                                        BorderBrush="{StaticResource TextBoxButtonBorderThemeBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}" />
                                                    <Border
                                                        x:Name="BackgroundElement"
                                                        Background="{StaticResource TextBoxButtonBackgroundThemeBrush}"
                                                        Margin="{TemplateBinding BorderThickness}">
                                                        <TextBlock
                                                            x:Name="GlyphElement"
                                                            Foreground="{StaticResource TextBoxButtonForegroundThemeBrush}"
                                                            FontFamily="{StaticResource SymbolThemeFontFamily}"
                                                            HorizontalAlignment="Center"
                                                            Text="&#xE0A4;"
                                                            VerticalAlignment="Center" />
                                                    </Border>
                                                </Grid>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </Grid.Resources>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition
                                    Width="*" />
                                <ColumnDefinition
                                    Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup
                                    x:Name="CommonStates">
                                    <VisualState
                                        x:Name="Disabled">
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames
                                                Storyboard.TargetProperty="Background"
                                                Storyboard.TargetName="BackgroundElement">
                                                <DiscreteObjectKeyFrame
                                                    KeyTime="0"
                                                    Value="{StaticResource TextBoxDisabledBackgroundThemeBrush}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames
                                                Storyboard.TargetProperty="BorderBrush"
                                                Storyboard.TargetName="BorderElement">
                                                <DiscreteObjectKeyFrame
                                                    KeyTime="0"
                                                    Value="{StaticResource TextBoxDisabledBorderThemeBrush}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames
                                                Storyboard.TargetProperty="Foreground"
                                                Storyboard.TargetName="ContentElement">
                                                <DiscreteObjectKeyFrame
                                                    KeyTime="0"
                                                    Value="{StaticResource TextBoxDisabledForegroundThemeBrush}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <DoubleAnimation
                                                Duration="0"
                                                To="0"
                                                Storyboard.TargetProperty="(UIElement.Opacity)"
                                                Storyboard.TargetName="BorderElement"
                                                d:IsOptimized="True" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState
                                        x:Name="Normal">
                                        <Storyboard>
                                            <DoubleAnimation
                                                Duration="0"
                                                To="0"
                                                Storyboard.TargetProperty="Opacity"
                                                Storyboard.TargetName="BackgroundElement" />
                                            <DoubleAnimation
                                                Duration="0"
                                                To="0"
                                                Storyboard.TargetProperty="Opacity"
                                                Storyboard.TargetName="BorderElement" />
                                            <ObjectAnimationUsingKeyFrames
                                                Storyboard.TargetProperty="(Control.Foreground)"
                                                Storyboard.TargetName="ContentElement">
                                                <DiscreteObjectKeyFrame
                                                    KeyTime="0">
                                                    <DiscreteObjectKeyFrame.Value>
                                                        <SolidColorBrush
                                                            Color="White" />
                                                    </DiscreteObjectKeyFrame.Value>
                                                </DiscreteObjectKeyFrame>
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState
                                        x:Name="PointerOver">
                                        <Storyboard>
                                            <DoubleAnimation
                                                Duration="0"
                                                To="0.095"
                                                Storyboard.TargetProperty="Opacity"
                                                Storyboard.TargetName="BackgroundElement" />
                                            <DoubleAnimation
                                                Duration="0"
                                                To="0"
                                                Storyboard.TargetProperty="Opacity"
                                                Storyboard.TargetName="BorderElement" />
                                            <ObjectAnimationUsingKeyFrames
                                                Storyboard.TargetProperty="(Control.Foreground)"
                                                Storyboard.TargetName="ContentElement">
                                                <DiscreteObjectKeyFrame
                                                    KeyTime="0">
                                                    <DiscreteObjectKeyFrame.Value>
                                                        <SolidColorBrush
                                                            Color="White" />
                                                    </DiscreteObjectKeyFrame.Value>
                                                </DiscreteObjectKeyFrame>
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState
                                        x:Name="Focused">
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames
                                                Storyboard.TargetProperty="(Control.Foreground)"
                                                Storyboard.TargetName="ContentElement">
                                                <DiscreteObjectKeyFrame
                                                    KeyTime="0">
                                                    <DiscreteObjectKeyFrame.Value>
                                                        <SolidColorBrush
                                                            Color="Black" />
                                                    </DiscreteObjectKeyFrame.Value>
                                                </DiscreteObjectKeyFrame>
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                                <VisualStateGroup
                                    x:Name="ButtonStates">
                                    <VisualState
                                        x:Name="ButtonVisible">
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames
                                                Storyboard.TargetProperty="Visibility"
                                                Storyboard.TargetName="DeleteButton">
                                                <DiscreteObjectKeyFrame
                                                    KeyTime="0">
                                                    <DiscreteObjectKeyFrame.Value>
                                                        <Visibility>Visible</Visibility>
                                                    </DiscreteObjectKeyFrame.Value>
                                                </DiscreteObjectKeyFrame>
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState
                                        x:Name="ButtonCollapsed" />
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <Border
                                x:Name="BackgroundElement"
                                Background="{TemplateBinding Background}"
                                Grid.ColumnSpan="2"
                                Margin="{TemplateBinding BorderThickness}" />
                            <Border
                                x:Name="BorderElement"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Grid.ColumnSpan="2" />
                            <ScrollViewer
                                x:Name="ContentElement"
                                HorizontalScrollMode="{TemplateBinding ScrollViewer.HorizontalScrollMode}"
                                HorizontalScrollBarVisibility="{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}"
                                IsTabStop="False"
                                IsHorizontalRailEnabled="{TemplateBinding ScrollViewer.IsHorizontalRailEnabled}"
                                IsVerticalRailEnabled="{TemplateBinding ScrollViewer.IsVerticalRailEnabled}"
                                IsDeferredScrollingEnabled="{TemplateBinding ScrollViewer.IsDeferredScrollingEnabled}"
                                Margin="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}"
                                VerticalScrollMode="{TemplateBinding ScrollViewer.VerticalScrollMode}"
                                ZoomMode="Disabled" />
                            <Button
                                x:Name="DeleteButton"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Grid.Column="1"
                                FontSize="{TemplateBinding FontSize}"
                                IsTabStop="False"
                                Style="{StaticResource DeleteButtonStyle}"
                                Visibility="Collapsed"
                                VerticalAlignment="Stretch" />
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style
            x:Key="LabelTextBlockStyle"
            TargetType="TextBlock"
            BasedOn="{StaticResource BaselineTextStyle}">
            <Setter
                Property="FontWeight"
                Value="Normal" />
            <Setter
                Property="VerticalAlignment"
                Value="Top" />
            <Setter
                Property="HorizontalAlignment"
                Value="Right" />
            <Setter
                Property="Margin"
                Value="10,1,10,0" />
            <Setter
                Property="TextWrapping"
                Value="Wrap" />
        </Style>
    </Page.Resources>

    <Grid
        Background="{StaticResource ApplicationPageBackgroundThemeBrush}"
        Margin="0,1,0,0">
        <Grid.RowDefinitions>
            <RowDefinition
                Height="Auto" />
            <RowDefinition
                Height="Auto" />
            <RowDefinition
                Height="Auto" />
            <RowDefinition
                Height="Auto" />
            <RowDefinition
                Height="Auto" />
            <RowDefinition
                Height="Auto" />
            <RowDefinition
                Height="Auto" />
            <RowDefinition />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition
                Width="Auto" />
            <ColumnDefinition />
        </Grid.ColumnDefinitions>
        <TextBlock
            Text="Regular TextBox"
            Style="{StaticResource LabelTextBlockStyle}" />
        <TextBox
            Text="Value 1"
            Grid.Column="1"
            Margin="0,0,0,10" />
        <TextBlock
            Grid.Row="1"
            Text="Regular Disabled TextBox"
            Style="{StaticResource LabelTextBlockStyle}" />
        <TextBox
            Grid.Row="1"
            Text="Value 2"
            Grid.Column="1"
            Margin="0,0,0,10"
            IsEnabled="False" />
        <TextBlock
            Grid.Row="2"
            Text="Styled TextBox"
            Style="{StaticResource LabelTextBlockStyle}" />
        <TextBox
            Grid.Row="2"
            Text="Value 3"
            Style="{StaticResource FlatTextBoxStyle}"
            Grid.Column="1" />
        <TextBlock
            Grid.Row="3"
            Text="Styled Disabled TextBox"
            Style="{StaticResource LabelTextBlockStyle}" />
        <TextBox
            Grid.Row="3"
            Text="Value 4"
            Style="{StaticResource FlatTextBoxStyle}"
            Grid.Column="1"
            IsEnabled="False" />
        <TextBlock
            Grid.Row="4"
            Text="Styled TextBox"
            Style="{StaticResource LabelTextBlockStyle}" />
        <TextBox
            Grid.Row="4"
            Text="Value 5"
            Style="{StaticResource FlatTextBoxStyle}"
            Grid.Column="1" />
        <TextBlock
            Grid.Row="5"
            Text="Styled TextBox"
            Style="{StaticResource LabelTextBlockStyle}" />
        <TextBox
            Grid.Row="5"
            Text="Value 6"
            Style="{StaticResource FlatTextBoxStyle}"
            Grid.Column="1" />
        <TextBlock
            Grid.Row="6"
            Text="Styled TextBox"
            Style="{StaticResource LabelTextBlockStyle}" />
        <TextBox
            Grid.Row="6"
            Text="Value 7"
            Style="{StaticResource FlatTextBoxStyle}"
            Grid.Column="1" />
    </Grid>
</Page> 
```

# java - Spring MVC @ResponseBody

> ID：14674749
> 
> 赞同：1
> 
> 时间：2013-02-03T16:45:23.690
> 
> 标签：java, spring-mvc

我有一个扩展 MultiActionController 并且不使用注释的控制器。一切都由xml配置。

有没有办法在 MultiActionController 中重现此方法？

```
 @RequestMapping(value = "/products", method = RequestMethod.GET)
        public @ResponseBody List<Product> products() {
            return product.getList();
        } 
```

我面临的问题是如何在@ResponeBody 中返回列表。

我的方法如下所示：

```
public ModelAndView login(HttpServletRequest request,HttpServletResponse response) throws ServletRequestBindingException {
    return new ModelAndView("login", model);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T20:16:28.920

一个开放式问题，我的意思是，你想要什么响应类型，json、xml、纯文本等，

如果您不限于使用此特定控制器，则可以专门为 RESTful 响应设置一个新控制器，例如`@ResponseMapping`在问题开始时使用您试图实现的方法。

如果您绑定到这个特定的控制器，并且没有使用注释的能力，您也可以直接使用 servlet 路由。例如：

```
public void generateProductList(HttpServletResponse response) {
    OutputStream os = response.getOutputStream();
    // This is where you would massage the data into the response type you want
    String responseBody = generateResponseBody(productList);
    os.write(responseBody.getBytes());
    os.flush();
} 
```

我假设如果您直接写入响应正文，这将用于某种 AJAX 调用。如果是这种情况，我建议使用 Jackson（或类似）库将列表转换为 JSON，并使用我刚才提到的任何一种方法来编写响应。如果 JSON 不是一个选项，您可以轻松地将列表转换为 CSV 响应，然后使用 javascript 解析 CSV 来做一些事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T18:45:03.233

如果您想将列表返回到调用它的位置，可以执行以下操作：

```
public ModelAndView login(HttpServletRequest request,HttpServletResponse response) throws ServletRequestBindingException {

   ModelMap model=new ModelMap();

   List<Product> productList=product.getList();

   model.add("productList",productList);
   return new ModelAndView("login", model);
} 
```

例如，您已经从 jsp 调用了它，那么您可以通过编写以下代码来检索 jsp 中的数据：

```
 {productList} 
```

现在通过使用 jstl for 循环，您可以迭代列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-09T13:12:38.603

```
public ModelAndView products(HttpServletRequest request,HttpServletResponse response) {
    final List<Product> products = product.getList();
    return new ModelAndView(new AbstractView() {

        @Override
        protected void renderMergedOutputModel(Map<String, Object> model, HttpServletRequest request, HttpServletResponse response) throws Exception {
            ByteArrayOutputStream baos = this.createTemporaryOutputStream();
            byte[] b = generateBytes(products)
            baos.write(b);
            this.writeToResponse(response, baos);
        };

        private byte[] generateBytes(List<Product> products) {
            // TODO Your codes.
        }

    });
} 
```

# java - 从客户端向服务器发送无限的文件

> ID：14674757
> 
> 赞同：2
> 
> 时间：2013-02-03T16:46:11.173
> 
> 标签：java

所以我有一个学校的作业，其中客户端必须向服务器发送无限的文件。我的想法是这样的。

1.  客户端将无限量的文件发送到服务器。
2.  服务器会将客户端上传的文件重定向到我的 wamp 服务器文件夹

我有工作代码，但此代码只能将 1 个文件从客户端发送到服务器。我还希望上传文件的文件名增加，因为在我的代码中它只使用 1 个文件名，所以如果更多客户上传他们的文件，他们将覆盖旧文件名。

例如：file01.rar 接下来上传file02.rar 等等。

这是我的服务器代码：

```
public void run() {
    filePath = "C:/wamp/www/file.rar";
    byte[] aByte = new byte[1];
    int bytesRead;
    InputStream is = null;
    try {
        is = clientSocket.getInputStream();
    } catch (IOException ie) {
        ie.printStackTrace();
    }
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    if (is != null) {
        FileOutputStream fos = null;
        BufferedOutputStream bos = null;
        try {
            fos = new FileOutputStream(filePath);
            bos = new BufferedOutputStream(fos);
            bytesRead = is.read(aByte, 0, aByte.length);
            do {
                baos.write(aByte);
                bytesRead = is.read(aByte);
            } while (bytesRead != -1);
            bos.write(baos.toByteArray());
            bos.flush();
            bos.close();
        } catch (IOException ie) {
            ie.printStackTrace();
        }
    }
} 
```

这是我的客户代码：

```
BufferedOutputStream bos = null;
            try {
                bos = new BufferedOutputStream(s.getOutputStream());
            } catch (IOException ie) {
                ie.printStackTrace();
            }

            if (bos != null) {
                File uploadFile = new File(clientFacultyUploadTextField.getText());
                byte[] myFileSize = new byte[(int)uploadFile.length()];
                FileInputStream fis = null;
                try {
                    fis = new FileInputStream(uploadFile);
                } catch (FileNotFoundException fife) {
                    fife.printStackTrace();
                }
                BufferedInputStream bis = new BufferedInputStream(fis);
                try {
                    bis.read(myFileSize, 0, myFileSize.length);
                    bos.write(myFileSize, 0, myFileSize.length);
                    bos.flush();
                    bos.close();
                    clientFacultyUploadTextField.setText("Upload complete...");
                } catch (IOException ie) {
                    ie.printStackTrace();
                }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T17:09:29.277

当您发送多个文件时，您需要告诉服务器一个文件何时停止，而另一个文件何时开始，以便它可以分别处理它们。

有多种方法可以解决这个问题。以下是一些，从简单但有限到困难但令人印象深刻的顺序：

a) 为每个文件使用一个新连接，并在传输完成后关闭它。这告诉服务器文件已经结束。这样做的好处是您可以轻松扩展它以允许同时上传多个文件。缺点：当传输由于某种原因中断时，服务器可能不会将其检测为错误并保存部分文件，就好像它已完成一样。

b) 使用相同的连接，但告诉服务器每个文件的长度。您可以通过以文件长度（以字节为单位）开始每个文件传输来做到这一点。这样服务器就可以读取这个字节数，然后启动一个新文件。当然，这仅在事先知道文件大小时才有效。当您在上传过程中流式传输仍在创建的文件时，无法使用它。

c) 使用成帧协议。将文件分成多个块，并在每个块前面加上一个标头，该标头告诉服务器该块的长度以及它是最后一个块还是后面会出现更多块。这种方法有一些开销，但它是一个非常可扩展的架构，它允许您通过向标头添加更多信息来轻松添加新功能。例如，您可以通过将传输的 ID 添加到标头来允许在一个连接上多路传输多个传输，通过添加序列号和控制代码来中止和恢复上传，告诉服务器删除或重命名的特殊命令帧它已经拥有的文件，以及更多。要获得一些灵感，请查看 HTTP 和 FTP 的工作原理。

# jquery - Jquery：“查找”范围属性（2个数字之间）

> ID：14674759
> 
> 赞同：0
> 
> 时间：2013-02-03T16:46:21.900
> 
> 标签：jquery, jquery-ui

我有一个无法解决的 JQuery 问题..

我有这一行：

```
var $price = $data.find('li[price=' + $max + ']'); 
```

找到等于 Var "$max" 的属性 "price"

现在，基本上，我有 2 个数字，$min 和 $max，我需要“查找”来检查属性是否在这两个数字之间..

例如：

```
 <ul class="ourHolder">
    <li price="200">
    <img src="img1.jpg">
    </li>
    <li price="300">
    <img src="img2.jpg">
    </li>
</ul>

    <script>

// get and assign the ourHolder element to the
    // $holder varible for use later
  var $holder = $('ul.ourHolder');

  // clone all items within the pre-assigned $holder element
  var $data = $holder.clone();
    var $min = 100;
    var $min = 400;
    var $price = $data.find('li[price=' + $max + ']'); //Not sure what to do here
    </script> 
```

应该返回两个`<li>`标签..（两者都在 100 和 400 之间）。

新编辑：

我添加了这个：

```
var price = data.find('li').filter(function() {
   var price = parseInt($(this).data('price')); // i think here it doesn't find nothing
    return price >= minPrice && price <= maxPrice;
}); 
```

但我什么也没返回:(

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:49:41.867

首先，您应该使用`data`属性，因为只是编写自己的属性会使您的代码无效。其次，您可以使用`filter()`基于更复杂的规则集来查找元素。尝试这个：

```
<li data-price="200">
    <img src="img1.jpg">
</li>
<li data-price="300">
    <img src="img2.jpg">
</li> 
```

```
var minPrice = 100;
var maxPrice = 400;
var $matchingLi = $data.find('li').filter(function() {
    var price = parseFloat($(this).data('price'));
    return price >= minPrice && price <= maxPrice;
}); 
```

# c - 有效地将 16 位 short 转换为 8 位 char

> ID：14674760
> 
> 赞同：3
> 
> 时间：2013-02-03T16:46:36.250
> 
> 标签：c, gcc, embedded, c99, integer-division

我正在研究一个没有硬件划分的 Cortex M0 cpu，所以每次我划分一些东西时，都会使用 GCC 库函数。现在我最常做的除法之一是除以 256，将短裤转换为字节。有什么方法可以比默认的 GCC 库更有效地做到这一点（例如通过位移）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T19:06:53.953

根据您的评论，您希望 -32768 映射到 0，并将 32767 映射到 255。因此，您想要的公式是：

```
short s = /* input value */;
unsigned char c = (unsigned char) ((s + 32768) / 256); 
```

其他评论者指出，您可以通过右移或其他各种策略来除以 256，这是正确的 - 一个合理的版本是：

```
unsigned char c = (unsigned char) ((s + 32768) >> 8); 
```

但是，不需要这样的优化。GCC 在将除以常数操作转换为特殊情况实现方面非常聪明，在这种情况下，它会将这两种操作编译成完全相同的代码（使用`-O2 -mcpu=cortex-m0 -mthumb`GCC 4.7.2 进行测试）：

```
 mov     r3, #128
    lsl     r3, r3, #8
    add     r0, r0, r3
    lsr     r0, r0, #8
    uxtb    r0, r0 
```

如果您尝试太聪明（就像其他答案中的联合或指针转换示例一样），您可能会混淆它并变得更糟 - 特别是因为那些通过内存加载工作，并且添加 32768 意味着您已经拥有寄存器中的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T16:57:37.597

只需投射一个指针。

```
unsigned char *bytes = (unsigned char*)&yourvalue; 
```

现在，`bytes[0]`将保留一个字节的值，`bytes[1]`并将保留另一个。顺序取决于系统的字节顺序

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T17:09:04.277

你可以这样使用`union`：

```
#include <stdio.h>

union Word {
    struct {
        unsigned char high;
        unsigned char low;
    } byte;
    unsigned short word;
};

int main(int argc, char **argv) {

    union Word word;
    word.word = 0x1122;

    printf("L = 0x%x, H = 0x%x", word.byte.low, word.byte.high);

    return 0;
} 
```

# python - 模型内的金字塔事件

> ID：14674768
> 
> 赞同：5
> 
> 时间：2013-02-03T16:47:46.230
> 
> 标签：python, events, sqlalchemy, pyramid, thread-local

我正在使用金字塔 1.4。我想从我的模型类中生成一些自定义 Pyramid 事件。事件是这样生成的：

```
request.registry.notify(MyCustomEventType("Here it comes")) 
```

如您所见，我需要访问应用程序注册表。我知道[`get_current_registry()`](http://docs.pylonsproject.org/projects/pyramid/en/1.0-branch/api/threadlocal.html#pyramid.threadlocal.get_current_registry)功能。但我也担心 Pyramid 网站上的这条评论：

“这个功能应该非常谨慎地使用，通常只在单元测试代码中”

**问题**：

*   从数据层（SQLAlchemy 模型）生成 Pyramid 事件通常是个坏主意吗？
*   如果*没有*，如何更文明地访问应用注册中心？`Base`（也许是扩展模型？）
*   如果*是*，是否有一些我可以使用的替代方案。我知道 SQLAlchemy 事件，但我找不到生成自定义事件的能力。

**理由**：

基本上，我将我的应用程序划分为功能，并尝试将它们解耦。为此，我有时需要 IoC：我正计划使用事件作为一种手段。例如，每当用户回答问题时，就会发出一个事件。然后，可以在应用程序的其他部分订阅这样的事件。我喜欢将应用程序逻辑保留在模型中而不是视图中。因此，所描述的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T12:20:04.730

从您的模型中触发金字塔事件的用例是什么？一般来说，这将是一个坏主意。

至于连接应用程序/模型。其中大部分是在 main() 中的初始化调用中完成的，它将设置传递给模型以提供连接设置等。我会确保任何将事物联系在一起的逻辑都仅限于应用程序启动时的单个函数调用。

最后，虽然我想你想要的最好以另一种方式完成。

# php - 什么是 PHP 对 python 编码（'hex'）的挂件？

> ID：14674770
> 
> 赞同：-3
> 
> 时间：2013-02-03T16:48:06.047
> 
> 标签：php, python

在python中，您可以将字符串编码为

```
encoded = text.encode('hex')
text = encoded.decode('hex') 
```

php中对应的函数有哪些？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T16:54:54.660

您可以使用

```
$data = bin2hex("your string");
$string = hex2bin($data); 
```

或者

```
$data = implode('', unpack("H*", "your string"));
$string = pack("H*", $data); 
```

# jruby - jruby - 设备不合适的 ioctl

> ID：14674776
> 
> 赞同：1
> 
> 时间：2013-02-03T16:49:18.587
> 
> 标签：jruby

我在 jruby 中遇到了一个在 cruby 1.9.3 中没有发生的错误。这是堆栈跟踪：[https](https://gist.github.com/4700559) ://gist.github.com/4700559和导致失败的代码行[https://github.com/dockyard/party_foul/blob/master/lib/generators/party_foul/install_generator。 rb#L11](https://github.com/dockyard/party_foul/blob/master/lib/generators/party_foul/install_generator.rb#L11)我不太确定如何调试它

# json - gson 和标识符

> ID：14674777
> 
> 赞同：0
> 
> 时间：2013-02-03T16:49:25.743
> 
> 标签：json, gson

我有这个问题：在我的 sql 数据库中，我有一个表 Utente，其主键 IDUtente 是 INT 类型并且是自动增量的。在数据库中我有：

```
ID|Name|....
1|Name1|....
2|Name2|.... 
```

在 Java servlet 中，我从数据库中读取数据，并以这种方式使用 Gson 序列化数据：

```
Gson gson = new Gson(); 
String lista = gson.toJson(utenti);
request.setAttribute("lista", lista);
request.getRequestDispatcher("GestioneUtenti.jsp").forward(request, response); 
```

在这里没关系，因为字符串 lista 它等于：

```
[{"idUtente":1,"username":"a","password":"a","nome":"a","cognome":"a","dataNascita":"dic 12, 1988","telefono":"3200769667","indirizzo":"a","citta":"a","luogoDiNascita":"a","abbonamentiATempo":0,"abbonamentiAPunti":0,"dataIscrizione":"dic 12, 2000","posizione":"socio","email":"a"},{"idUtente":2,"username":"b","password":"b","nome":"b","cognome":"b","dataNascita":"giu 25, 1960","telefono":"3474213142","indirizzo":"b","citta":"b","luogoDiNascita":"b","abbonamentiATempo":0,"abbonamentiAPunti":0,"dataIscrizione":"mar 11, 2001","posizione":"non socio","email":"b"}] 
```

现在在我的 JSP 页面中，我必须反序列化字符串，我这样做是这样的：

```
<%String lista = (String)request.getAttribute("lista");
Gson gson = new GsonBuilder().setDateFormat("yyyy-MM-dd").create();                         
Type listType = new TypeToken<ArrayList<Utente>>() {}.getType();
ArrayList<Utente> users = gson.fromJson(lista, listType);
for(int i=0;i<users.size();i++){
out.print("<tr>");
out.print("<td>"+users.get(i).getIdUtente()+"</td>");
out.print("<td>"+users.get(i).getNome()+"</td>");
out.print("<td>"+users.get(i).getCognome()+"</td>");
    out.print("<td>"+users.get(i).getPosizione()+"</td>");
    out.print("<td>"+users.get(i).getTelefono()+"</td>");
 } 
```

问题是打印的 ID 总是等于 0！为什么？如果有必要，我也会写我的课 Utente！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T16:55:42.537

为什么要将 utenti 序列化为 JSON，将其放在请求中，然后在 JSP 中反序列化？

只需将列表放入请求中并提取列表，因为您是字符串 - 不需要 GSON。

现在，如果您将它通过网络连接到客户端，那么我可以看到对 GSON 的需求，但在您的特定用例中却没有。

您的整个操作都在服务器内进行，因此您无需序列化 utenti 列表实例。

# https - 在 HTTPS 页面上添加 Adsense - 这有效吗？

> ID：14674781
> 
> 赞同：1
> 
> 时间：2013-02-03T16:49:47.437
> 
> 标签：https, adsense

我知道 Google 没有 HTTPS 替代他们的 AdSense 代码，如果你决定将他们的 HTTP 代码嵌入到你的安全页面中，你会从浏览器中收到一些警告。他们在插入广告时给您的脚本是`http://pagead2.googlesyndication.com/pagead/show_ads.js`.

现在，我所做的是更改`http://`by `https://`，因此警告消失了（页面完全安全），并且广告正确显示。我的问题是：
1.）这真的有效吗？我的意思是，这是一个真正的 HTTPS 链接还是只是欺骗浏览器的一些技巧？
2.) 我没有发现这个 HTTPS 链接会存在（正如我所说，我只是尝试将 HTTP 更改为 HTTPS，我发现它可以工作）。我正在做的事情合法、安全、值得推荐吗？

谢谢！

# performance - 谷歌应用脚 本替换innerHtml非常慢

> ID：14674782
> 
> 赞同：1
> 
> 时间：2013-02-03T16:49:58.537
> 
> 标签：performance, google-apps-script, innerhtml, google-caja

我有一个谷歌应用程序脚本部署为网络应用程序。我正在尝试通过将某些 div 的 .innerHTML 替换为从服务器发回的 html 来刷新内容。

对于少量的简单 html（深度不超过 3 层，基本上每个 15 个 4x21 div 的网格）需要 25 秒。

我记录了时间戳，发现实际上是对 mydiv.innerHTML = newhtml （在客户端）的调用占用了所有时间。

这是卡哈卫生吗？重新加载整个页面大约需要 10 秒，包括我所知道的至少 4 秒的服务器时间。那么为什么这几乎慢了一个数量级呢？
谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:09:08.183

很可能是卡哈消毒，是的。不幸的是，它在客户端完成的方式涉及比初始服务器负载更慢的重写。作为短期解决方案，我建议：

1.  用一个调用替换许多 innerHtml 调用，或
2.  保持 HTML 结构完整并使用 textContent 而不是 innerHTML 来更改其中的一小部分（例如：保持表格结构完整但不可见，并在单元格上使用 textContent 更改其中的值）。

从长远来看，我们意识到这很慢，并且正在积极努力加快速度。[您可以在公共 Caja 网站](http://code.google.com/p/google-caja)上寻求更详细的帮助或关注该进展。

# backbone.js - 获取后Backbone.js离线不保存到本地存储

> ID：14674783
> 
> 赞同：0
> 
> 时间：2013-02-03T16:50:04.920
> 
> 标签：backbone.js, coffeescript

嗨希望有人可以帮助我，

我试图离线使用骨干网（[https://github.com/Ask11/backbone.offline](https://github.com/Ask11/backbone.offline)），我可以设法通过骨干网离线同步方法获取到我的服务器，但它不存储在本地，这里是我的代码的一些部分：

```
define ['Backbone'
, 'Backbone.OffLine'
, 'models/requestOffer/RequestOfferModel']
,(Backbone
, OffLine
, RequestOfferModel) ->

  class RequestOfferCollection extends Backbone.Collection
    model: RequestOfferModel
    urlRoot: window.generalRootlUrl
    sync:  Backbone.Sync;
    initialize: ->
      console.log 'Request Collection init'
      @storage = new Offline.Storage('RequestOfferCollection', @, autoPush: true)
    url: ->
      api ='/api/v1/requestoffer/?format=json'
      return @urlRoot+api 
```

这就是我打电话的方式

```
 @reqOfferCol.fetch
        local: false
        data:
          'party': 1
          'estado': @list2Show
        success: (resp) =>
          console.log 'Success'
        error: (error) =>
          console.log 'Error en fectch!!!' 
```

我将 updated_at 属性添加到我的模型中。

我也在使用backbone.localstorage，这会与backbone.offline冲突吗，我小心地将同步方法分配给每个模型。

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:39:15.830

疯狂的猜测，但是在您设置同步方法的地方，尝试将`Backbone.Sync`（用大写的 S）`Backbone.sync`替换为（用小写的 s），看看是否有帮助。

# objective-c - 来自带有捕获组的正则表达式的 gobbledygook

> ID：14674787
> 
> 赞同：0
> 
> 时间：2013-02-03T16:50:36.430
> 
> 标签：objective-c, regex

在下面的代码中，我尝试使用正则表达式来提取文本文件的更下面的部分。

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    NSLog(@"Succeeded! Received %d bytes of data",[receivedData length]);
    NSString *string = [[NSString alloc] initWithData:receivedData encoding:NSISOLatin1StringEncoding];
    NSLog(@"string length: %d", [string length]);
    NSError *error = nil;
    NSString *toMatch = @"\[Board\\t\"([0-9]?)\"]*\[Dealer\\t\"([NEWS])\"]*";
    NSRegularExpression *regex = [NSRegularExpression  regularExpressionWithPattern:toMatch
        options:0 error:&error];
    NSLog(@"length: %d", [toMatch length]);
    NSUInteger numberOfMatches = [regex numberOfMatchesInString:string options:0 range:NSMakeRange(0, [string length])];
    NSLog(@" %ud", numberOfMatches);
    for (NSTextCheckingResult* match in [regex matchesInString:string options:0 range:NSMakeRange(0, [string length])]){
        // cannot make this work: NSRange trange =[match range];
        // cannot make this work: NSLog(@"range %i,%i", trange );
        NSString* tstring=[string substringWithRange:trange];
        NSLog(@" %@", tstring );}
} 
```

我`NSRegularExpression`用来从以下摘录的文本中挑选信息。更具体地说，我需要每个板的`Board`数量和`Dealer`值（大约有 40 个板，我删除了列表中的几个不相关的行）。

```
[Board "1"]
[Dealer "N"]
[Vulnerable "None"]
[Deal "N:Q952.652.KJT4.95 T.KQT84.A865.J73 K8763.A7.Q.KQT84 AJ4.J93.9732.A62"]
[Scoring ""]
[Declarer ""]
[Contract ""]
[Board "2"]
[Dealer "E"]
[Vulnerable "NS"]
[Deal "E:K8542.3.4.AT7532 J76.K7.AT85.KQJ8 QT3.AJ84.KJ963.4 A9.QT9652.Q72.96"]
[Scoring ""]
[Declarer ""]
[Contract ""] 
```

我正在为我的`for`循环打印得到 gobbledygook。gobbledygook 至少有两个原因：我的正则表达式错误，或者我的`for`循环错误。

控制台输出并`gobbledygook`遵循。

```
2013-02-03 11:00:14.161 BridgeDuplicate[51867:11303] the window: <UIWindow: 0x956eac0; frame = (0 0; 768 1024); hidden = YES; layer = <UIWindowLayer: 0x956ebc0>>
2013-02-03 11:00:14.163 BridgeDuplicate[51867:11303] the rootViewController: <BSViewController: 0x7188220>
2013-02-03 11:00:14.166 BridgeDuplicate[51867:11303] viewDidLoad
2013-02-03 11:00:27.156 BridgeDuplicate[51867:11303] Succeeded! Received 303896 bytes of data
2013-02-03 11:00:27.158 BridgeDuplicate[51867:11303] string length: 303896
2013-02-03 11:00:27.164 BridgeDuplicate[51867:11303] length: 41
2013-02-03 11:00:27.205 BridgeDuplicate[51867:11303]  264765d
2013-02-03 11:00:27.205 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.206 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.206 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.206 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.206 BridgeDuplicate[51867:11303]  l
2013-02-03 11:00:27.206 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.206 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.206 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.206 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.206 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.207 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.207 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.207 BridgeDuplicate[51867:11303]  ea
2013-02-03 11:00:27.207 BridgeDuplicate[51867:11303]  d
2013-02-03 11:00:27.207 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.207 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.207 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.207 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.207 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.208 BridgeDuplicate[51867:11303]  e
2013-02-03 11:00:27.208 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.208 BridgeDuplicate[51867:11303]  a
2013-02-03 11:00:27.208 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.208 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.208 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.208 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.208 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.208 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.208 BridgeDuplicate[51867:11303]  e
2013-02-03 11:00:27.209 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.209 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.209 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.209 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.209 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.209 BridgeDuplicate[51867:11303]  "
2013-02-03 11:00:27.228 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.228 BridgeDuplicate[51867:11303]  o
2013-02-03 11:00:27.228 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.228 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.228 BridgeDuplicate[51867:11303]  e
2013-02-03 11:00:27.228 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.229 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.229 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.229 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.229 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.229 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.230 BridgeDuplicate[51867:11303]  e"
2013-02-03 11:00:27.230 BridgeDuplicate[51867:11303]  
2013-02-03 11:00:27.230 BridgeDuplicate[51867:11303] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:24:18.083

我怀疑你误解了它的`NSTextCheckingResult`工作原理，但也许更重要的是，你的模式存在一些问题。以下代码应该是说明性的：

```
NSString *string = @"[Board\t\"1\"]\n[Dealer\t\"N\"]\n";
NSLog(@"string length: %lu", (unsigned long)[string length]);
NSError *error = nil;
NSString *toMatch = @"\\[Board\\t\"([0-9]?)\"\\].*\\n\\[Dealer\\t\"([NEWS])\"\\].*";
NSRegularExpression *regex = [NSRegularExpression  regularExpressionWithPattern:toMatch options:0 error:&error];
NSLog(@"length: %lu", (unsigned long)[toMatch length]);
NSUInteger numberOfMatches = [regex numberOfMatchesInString:string options:0 range:NSMakeRange(0, [string length])];
NSLog(@"number of matches: %lu", (unsigned long)numberOfMatches);
for (NSTextCheckingResult* match in [regex matchesInString:string options:0 range:NSMakeRange(0, [string length])])
{
    NSLog(@"Number of ranges in match: %lu", match.numberOfRanges);
    for (NSUInteger i = 0; i < match.numberOfRanges; ++i)
    {
        NSRange matchedRange = [match rangeAtIndex: i];
        NSString* tstring = [string substringWithRange: matchedRange];
        NSLog(@"range %lu string: %@", (unsigned long)i, tstring);
    }
} 
```

你会得到的是：

```
2013-02-03 12:16:41.112 RegExTest[72290:303] string length: 25
2013-02-03 12:16:43.889 RegExTest[72290:303] length: 49
2013-02-03 12:16:43.889 RegExTest[72290:303] number of matches: 1
2013-02-03 12:16:43.890 RegExTest[72290:303] Number of ranges in match: 3
2013-02-03 12:16:43.890 RegExTest[72290:303] range 0 string: [Board "1"]
[Dealer "N"]
2013-02-03 12:16:43.890 RegExTest[72290:303] range 1 string: 1
2013-02-03 12:16:43.890 RegExTest[72290:303] range 2 string: N 
```

这里要知道的是，您正在为*一场*比赛射击，并且该比赛有多个射程。每个成功的匹配至少有一个范围：与整个模式匹配的整个字符串的范围（这不是您在这里感兴趣的内容。）基于括号的捕获组将出现在超过 0 的索引处，如图所示通过此代码。

转义规则有点痛苦——在 NSString 中有转义规则，然后是正则表达式转义规则。它们如何交互可能并不明显，但我在这里提出的模式似乎可以满足您的需求。

编辑：

这是直接从您的 URL 中提取并成功匹配的另一个版本：

```
NSError* error = nil;
NSString* string = [NSString stringWithContentsOfURL: [NSURL URLWithString: @"http://www.atlantaduplicatebridgeclub.com/scorepost/2013/01/20130126ana.pbn"]
                                            encoding: NSUTF8StringEncoding error: &error];
NSLog(@"string length: %lu", (unsigned long)[string length]);
NSString *toMatch = @"\\[Board\\s*\"([0-9]?)\"\\].*\\[Dealer\\s*\"([NEWS])\"\\]";
NSRegularExpression *regex = [NSRegularExpression  regularExpressionWithPattern:toMatch options:NSRegularExpressionDotMatchesLineSeparators error:&error];
NSLog(@"pattern length: %lu", (unsigned long)[toMatch length]);
NSUInteger numberOfMatches = [regex numberOfMatchesInString:string options:0 range:NSMakeRange(0, [string length])];
NSLog(@"number of matches: %lu", (unsigned long)numberOfMatches);
for (NSTextCheckingResult* match in [regex matchesInString:string options:NSRegularExpressionDotMatchesLineSeparators range:NSMakeRange(0, [string length])])
{
    NSLog(@"Number of ranges in match: %lu", match.numberOfRanges);
    for (NSUInteger i = 0; i < match.numberOfRanges; ++i)
    {
        NSRange matchedRange = [match rangeAtIndex: i];
        NSString* tstring = [string substringWithRange: matchedRange];
        NSLog(@"range %lu string: %@", (unsigned long)i, tstring);
    }
} 
```

# c++ - 进行添加时修改了第一类对象

> ID：14674793
> 
> 赞同：1
> 
> 时间：2013-02-03T16:51:02.370
> 
> 标签：c++, class

下面的代码给出了加法的正确输出，它在执行后更改了第一个对象**b的****x**值。

 **```
class numbers{
public:
    int x;
    numbers(int i1){
        x = i1;
    }
    numbers operator+ (numbers num){
        x = x + num.x;
        return(x);
    }
};

int main(){
    numbers a (2);
    numbers b (3);
    numbers c (5);
    numbers d (7);
    cout << a.x << b.x << c.x << d.x << endl; // returns 2357
    numbers final (100); //this value won't be shown
    final = a+b+c+d; 
    cout << a.x << b.x << c.x << d.x << endl; // returns 5357
    cout << final.x; //returns 17 (2+3+5+7)
    system("pause");
} 
```

问题是，这个加法类究竟是如何工作的？我的意思是，为什么对象中**的****x**被修改了？我虽然只有来自**最终对象的****x**会被修改。

 ******谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T16:53:46.857

对 operator+ 的调用就像任何其他成员函数调用一样。`a + b`转换为`a.operator+(b)`。因此，`x = x + num.x;`在这种情况下，该行实际上是分配给`a.x`. 为了实现你想要的，你需要用新值填充一个新数字，即

```
numbers operator+ (numbers num) const {
    return numbers(x + num.x)
} 
```

还要注意 const - 当你犯了那个错误时它会给你一个编译错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T16:54:08.013

您编写的 operator+ 实际上正在执行您对 operator+= 的期望

operator+ 应该返回一个包含计算值的对象编号，而不是修改当前对象。

[这里](http://courses.cms.caltech.edu/cs11/material/cpp/donnie/cpp-ops.html)有一些指导方针

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T16:54:13.070

您的`operator+`更改`this`是因为这是您定义它的方式。或者，您可以尝试

```
numbers operator+( const numbers& num ) {
    numbers ret( this->x ); // constract a local copy
    ret.x += num.x;
    return ret;
} 
```********

# iphone - App Store 更新应用程序

> ID：14674796
> 
> 赞同：1
> 
> 时间：2013-02-03T16:51:10.453
> 
> 标签：iphone, ios, app-store

我想知道是否可以将应用程序上的 AppStore 更新与在模拟器上运行应用程序进行比较，更改一些代码，然后再次运行它？或者当您从 AppStore 更新应用程序时，是否会重新安装漏洞应用程序？

我想知道，因为在我的应用程序中，我使用 Key/Value 方法将字符串和整数保存到 userDefaults，但我不确定在 AppStore 更新后字符串和整数是否相同，或者它们是否会被重置。

# node.js - 如何使用 better-assert 和 mocha 运行单元测试？

> ID：14674800
> 
> 赞同：0
> 
> 时间：2013-02-03T16:51:51.810
> 
> 标签：node.js, mocha.js, better-assert

我正在尝试使用 mocha + [better-assert](https://github.com/visionmedia/better-assert)运行一些单元测试，但`better-assert`使用了未定义的变量[__stack](https://github.com/visionmedia/better-assert/blob/master/index.js#L25)，因此它会引发引用错误。

我是整个 node.js 堆栈的新手，尽管进行了一些搜索，但我无法确定这个`__stack`变量是来自 v8 运行时，还是来自 node.js、mocha 或其他东西。grepping没有结果。

使用节点 v0.8.18、mocha 1.8.1、better-assert 0.1.0

`__stack`变量在哪里定义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:50:23.690

Better-asset 的作者 TJ Holowaychuk 刚刚更新了它，修复了这个确切的问题。我所说的“只是”是指在您发布问题后的一个小时内！如果您更新到模块的最新版本，则不应再收到该错误。

如果您有兴趣，[这里是更改的详细信息。](https://github.com/visionmedia/better-assert/pull/2)

# highcharts - Highcharts - 它可以做这种类型的图表吗？

> ID：14674809
> 
> 赞同：0
> 
> 时间：2013-02-03T16:52:39.767
> 
> 标签：highcharts

Highcharts 可以做这样的图表吗？我知道如何制作条形图和样条曲线，我对图表开头的阴影“最快英里”部分感兴趣。

谢谢！

![这里的例子 --> (http://www.firehole.us/screen-capture.png)](../Images/9aca30a644ef1cf43b9828f7b291dc2e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:48:59.740

是的，请参阅[plotBands](http://api.highcharts.com/highcharts#xAxis.plotBands)上的 api 部分。

> xAxis.plotBands
> 
> 一条横跨绘图区域的彩色条带，标记轴上的间隔。

# php - 如何在 PHP 中获取 DIV 的 HTML 内容

> ID：14674816
> 
> 赞同：4
> 
> 时间：2013-02-03T16:53:57.703
> 
> 标签：php, html, parsing, preg-match, simple-html-dom

我需要从 URL 中获取 DIV 的 HTML 内容。我已经尝试使用 preg_match() 和 simple_html_dom 获取 div 的内容，但我只得到纯文本。

simple_html_dom 示例：

```
$html = file_get_html('http://webpage.tld');
$code = $html->find('#mydiv', 0);
var_dump($code->plaintext); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T17:01:19.157

而不是`$code->plaintext`使用`$code->outertext`

# c - 在 eof 之后从文件输入到 C 中的数组

> ID：14674818
> 
> 赞同：1
> 
> 时间：2013-02-03T16:54:00.767
> 
> 标签：c

在我已经遍历文件以查看文件有多少行之后，我试图将文件中的所有信息放入一个数组中。但是，如果我放置文件的一行，它似乎可以工作，但是，如果我在返回文件然后打印数组时将数组位置设置为文件行，则数字的输出方式与它们应该的不同。

这是我的代码。

```
int main()
{

                            //Opens File

    char fName[20];

   // fName = getchar();

    scanf( "%s", fName);

    FILE *fpIn;

    fpIn = fopen ( fName, "rt");
   // fpIn = fopen( "test1.txt", "rt");

    if ( fpIn == NULL)
    {
        printf( "Unable to open: ");
        exit(99);
    }

                            //Gets Lines

    int lines=0;
    char ch;

    while((ch=fgetc(fpIn))!=EOF)
    {
        if (ch=='\n') { lines++; }

    }

    clearerr(fName *fpIn);
    fclose(fpIn);
    fopen(fName, "rt");

                            //Makes Array

    int *pA;

    pA = (int *)malloc(lines*sizeof(int));

                            //Fills Array

    for (int i=0; i<lines; i++)
    {
        while ((ch=fgetc(fpIn))!='\n')
        {
            pA[i] = ch;
        }
        ch=fgetc(fpIn);
    }

    for (int i=0; i<lines; i++)
    {
        printf("%d\n", pA[i]);
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T20:29:36.547

虽然按照 Vaughn Cato 的建议切换到 fscanf() 语句而不是 getc() 绝对有助于让我找到正确的解决方案。真正的不同是删除了 while 语句，该语句检查以确保在继续下一个整数之前我已经到达了行尾。

代码现在显示，

```
for (int i=0; i<lines; i++)
    {
        fscanf(fpIn, "%lf", &pA[i]);
    } 
```

而且，到目前为止，似乎适用于所有适当的数据输入文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:06:04.073

考虑这部分代码：

```
 while ((ch=fgetc(fpIn))!='\n')
    {
        pA[i] = ch;
    } 
```

`i`在此循环期间不会更改，因此`pA[i]`会被每个新字符覆盖。您最终将`pA[i]`包含该行的最后一个字符。

# php - Symfony2 KnpMenuBundle：设置激活一个菜单项，即使它不在该菜单上

> ID：14674820
> 
> 赞同：5
> 
> 时间：2013-02-03T16:54:07.480
> 
> 标签：php, symfony, symfony-2.1, knpmenubundle

我创建了我的菜单生成器，它可以工作。我的一条路线是

```
/database 
```

但这有一个子路线：

```
database/view/{id} 
```

我不想将视图路径放入菜单项，因为没有 ID 它将无法工作。

但是我希望当用户在视图中时数据库路由处于活动状态。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-06T14:16:14.490

设法用这个小技巧解决了这个问题：

在添加所有子项之后但在返回我添加的菜单之前的 menuBuider 中

```
$request = $this->container->get('request');
        $routeName = $request->get('_route');
        switch ($routeName)
        {
            case 'battlemamono_database_view_by_name':
            case 'battlemamono_database_view_by_id':
                $database->setCurrent(true);
                break;
        } 
```

这将检查路线并将所需的菜单设置为活动状态。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-08-04T10:22:26.760

它没有记录，但现在这样做的正确方法是（例如）：

```
 $menu->addChild('Category', [
            'route' => 'category_show',
            'routeParameters' => ['slug' => $category->getSlug()],
            'extras' => [
                'routes' => [
                    [
                        'route' => 'thread_show',
                        'parameters' => ['categorySlug' => $category->getSlug()]
                    ],
                ],
            ],
        ]); 
```

如果不需要这些参数，可以跳过它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-10-08T11:55:07.883

当 时`$menu->addChild('Item name', ['route' => 'item_route'])`，该值`['extras']['routes'][0] = 'item_route'`被添加到当前孩子。

**因此，您需要将`['extra']['routes'] = []`数组的路由添加到 child**。

这很简单。有三种方法可以做到这一点：

1.  **我推荐这种方式。**'extras' 数组将被合并（无需复制当前`'route'`in `'routes'`）：

    ```
    $menu->addChild('Item name', [
        'route' => 'item_route', // The item link in the menu
        'extras' => [
            // Set current (active) if route matches one of the set (including route from key 'route')
            'routes' => [ 
                'item_route_inner_1',
                'item_route_inner_2',
                'item_route_outside_1',
            ],
        ],
    ]); 
    ```

2.  `->setExtra(key, value)`在`'extras'`数组中，整个值将被键替换（当由于某种原因您不需要获取路由中指定的路由路径时，它可能很有用）：

    ```
    $menu->addChild('Point name', [
        'route' => 'point_route', // route point (on click)
    ])
    // In the 'extras' array, the entire value will be replaced by the 'routes' key
    ->setExtra(
        'routes', [ // Set current (active) if route matches one of the set
            'point_route', // Can be removed, if necessary
            'point_route_inner_1',
            'point_route_inner_2',
            'point_route_outside_1',
        ]
    ); 
    ```

3.  `->setExtras(['routes'] => value)`阵列将`'extras'`被完全替换。**使用非常小心！**

    ```
    $menu->addChild('Point name', [
        'route' => 'point_route', // route point (on click)
    ])
    // The 'extras' array will be completely replaced
    ->setExtras([
        'routes' => [
            'point_route', // Can be removed, if necessary
            'point_route_inner_1',
            'point_route_inner_2',
            'point_route_outside_1',
        ]
    ]); 
    ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-05T21:57:44.903

几天来，我一直在为这个问题绞尽脑汁，我想我想出了最干净的解决方案，通过使用我的路由配置和自定义投票器来解决这个问题。由于这是关于 Symfony 路由组件的，我假设您正在使用 Symfony 框架或对 Symfony 有足够的了解以使其适合自己。

# 创建自定义选民

```
<?php
# src/AppBundle/Menu/RouteKeyVoter.php

namespace AppBundle\Menu;

use Knp\Menu\ItemInterface;
use Knp\Menu\Matcher\Voter\VoterInterface;
use Symfony\Component\HttpFoundation\Request;

/**
 * Voter based on routing configuration
 */
class RouteKeyVoter implements VoterInterface
{
    /**
     * @var Request
     */
    private $request;

    public function __construct(Request $request = null)
    {
        $this->request = $request;
    }

    public function setRequest(Request $request)
    {
        $this->request = $request;
    }

    public function matchItem(ItemInterface $item)
    {
        if (null === $this->request) {
            return null;
        }

        $routeKeys = explode('|', $this->request->attributes->get('_menu_key'));

        foreach ($routeKeys as $key) {
            if (!is_string($key) || $key == '') {
                continue;
            }

            // Compare the key(s) defined in the routing configuration to the name of the menu item
            if ($key == $item->getName()) {
                return true;
            }
        }

        return null;
    }
} 
```

## 在容器中注册选民

```
# app/config/services.yml

services:
    # your other services...

    app.menu.route_key_voter:
        class: AppBundle\Menu\RouteKeyVoter
        scope: request
        tags:
            - { name: knp_menu.voter } 
```

* * *

```
<!-- xml -->

<service id="app.menu.route_key_voter" class="AppBundle\Menu\RouteKeyVoter">
    <tag name="knp_menu.voter" request="true"/>
</service> 
```

请注意，这些尚未经过全面测试。如果我应该改进一些事情，请发表评论。

# 配置菜单键

创建自定义 Voter 并将其添加到配置的 Matcher 后，您可以通过将`_menu_key`默认值添加到路由来配置当前菜单项。可以使用 分隔键`|`。

```
/**
 * @Route("/articles/{id}/comments",
 *     defaults={
 *         "_menu_key": "article|other_menu_item"
 *     }
 * )
 */
public function commentsAction($id)
{
} 
```

* * *

```
article_comments:
    path:      /articles/{id}/comments
    defaults:
        _controller: AppBundle:Default:comments
        _menu_key:   article|other_menu_item 
```

* * *

```
<route id="article_comments" path="/articles/{id}/comments">
    <default key="_controller">AppBundle:Default:comments</default>
    <default key="_menu_key">article|other_menu_item</default>
</route> 
```

上述配置将匹配以下菜单项：

```
$menu->addChild('article', [ // <-- matched name of the menu item
    'label' => 'Articles',
    'route' => 'article_index',
]); 
```

# c - 简短的 C 代码：混淆 strlen() 函数

> ID：14674825
> 
> 赞同：2
> 
> 时间：2013-02-03T16:54:15.487
> 
> 标签：c

我的编译器：Dev C++ 5.3.0.3 TDM-GCC 4.6.1 64 位我的操作系统：Windows 7、64 位

我的 C 代码：

```
# include "stdio.h"
# include "string.h"

# define MAX (501)

int main() {
    char
        text[MAX]="";

    int i;

    i=0;
    printf("%d\n",strlen(text));        /* 0 */
    printf("%d\n",(strlen(text)-1));    /* -1 */
    if ( i<= (strlen(text)-1) ) printf("haha"); /* haha */

    return 0;
} 
```

我的问题：**为什么要打印“哈哈”？！** ( 0>-1 ?!!!) 感谢您的帮助！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-03T16:55:54.420

`strlen`返回一个*无符号*值，并且对*无符号*整数`i < strlen(text) - 1`执行比较，其中确实不大于另一个。*`0`*

 *在处理无符号类型时，如果只使用 ，则更容易推理`+`：

```
if (i + 1 <= strlen(text)) 
```

甚至更好：

```
if (i < strlen(text)) 
```

理解内置类型和运算符的算术提升和转换可能有点棘手，可能值得一读。肯定有一些意想不到的情况。可以制作一个好的编译器来警告你`comparing signed with unsigned types`。

（如果您很好奇为什么在一个同时具有有符号和无符号类型的表达式中都被提升为无符号，您可能会注意到从有符号到无符号的转换是绝对明确定义的（通过模算术），而从无符号到有符号的转换是实现定义。我想这意味着提升规则意味着算术运算和比较的行为是明确定义的，而不仅仅是实现定义的。）*

# sqlite - SQLite3 效率

> ID：14674829
> 
> 赞同：0
> 
> 时间：2013-02-03T16:55:08.590
> 
> 标签：sqlite

sqlite3 如何存储记录 - 作为文本或本机数据类型。

我将一列从**DOUBLE**更改为**INT**，文件大小没有区别。

我意识到 sqlite3 使用亲和力。

但我担心存储效率——我认为 INT 会比 DOUBLE 占用更少的空间。

还有运行时效率。如果所有内容都存储为文本-那么我假设对于查询，所有列值都必须转换为数字类型，然后进行比较-有点贵。（除非它是一个键列，然后我希望它存储在一个数字类型列中）。

任何帮助表示赞赏 - 当我开始数据库设计时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:39:36.847

SQLite以与本机格式非常相似的[格式存储值。](http://www.sqlite.org/fileformat2.html#record_format)

整数有多种存储格式，因此较小的值需要更少的字节。但是，浮点值始终使用每个值 8 个字节。

请注意，浮点值尽可能存储为整数。

更改声明的列类型确实会影响文件大小，因为存储类型仅取决于值的类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:22:10.357

请参阅 SQLite 官方网站上的常见问题解答

[http://www.sqlite.org/faq.html#q2](http://www.sqlite.org/faq.html#q2)

# php - PHP将字符串转换为十六进制和十六进制到字符串

> ID：14674834
> 
> 赞同：62
> 
> 时间：2013-02-03T16:55:17.363
> 
> 标签：php, string, hex

在 PHP 中的这两种类型之间进行转换时遇到了问题。这是我在谷歌搜索的代码

```
function strToHex($string){
    $hex='';
    for ($i=0; $i < strlen($string); $i++){
        $hex .= dechex(ord($string[$i]));
    }
    return $hex;
}

function hexToStr($hex){
    $string='';
    for ($i=0; $i < strlen($hex)-1; $i+=2){
        $string .= chr(hexdec($hex[$i].$hex[$i+1]));
    }
    return $string;
} 
```

当我使用 XOR 加密时，我检查并发现了这一点。

我有 string `"this is the test"`，在用一个键 XOR 之后，我有 string 的结果`↕↑↔§P↔§P ♫§T↕§↕`。之后，我尝试通过函数 strToHex() 将其转换为十六进制，我得到了这些`12181d15501d15500e15541215712`. 然后，我用函数 hexToStr() 进行了测试，我得到了`↕↑↔§P↔§P♫§T↕§q`. 那么，我应该怎么做才能解决这个问题呢？为什么我转换这 2 样式值时会出错？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2018-04-27T06:25:34.893

对于最终来到这里并且只是在寻找（二进制）字符串的十六进制表示的人。

```
bin2hex("that's all you need");
# 74686174277320616c6c20796f75206e656564

hex2bin('74686174277320616c6c20796f75206e656564');
# that's all you need 
```

文档：[bin2hex](https://www.php.net/manual/function.bin2hex.php)，[hex2bin](https://www.php.net/manual/function.hex2bin.php)。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2013-08-29T09:16:25.067

对于任何带有 ord($char) < 16 的字符，你会得到一个只有 1 长的 HEX。您忘记添加 0 填充。

这应该解决它：

```
<?php
function strToHex($string){
    $hex = '';
    for ($i=0; $i<strlen($string); $i++){
        $ord = ord($string[$i]);
        $hexCode = dechex($ord);
        $hex .= substr('0'.$hexCode, -2);
    }
    return strToUpper($hex);
}
function hexToStr($hex){
    $string='';
    for ($i=0; $i < strlen($hex)-1; $i+=2){
        $string .= chr(hexdec($hex[$i].$hex[$i+1]));
    }
    return $string;
}

// Tests
header('Content-Type: text/plain');
function test($expected, $actual, $success) {
    if($expected !== $actual) {
        echo "Expected: '$expected'\n";
        echo "Actual:   '$actual'\n";
        echo "\n";
        $success = false;
    }
    return $success;
}

$success = true;
$success = test('00', strToHex(hexToStr('00')), $success);
$success = test('FF', strToHex(hexToStr('FF')), $success);
$success = test('000102FF', strToHex(hexToStr('000102FF')), $success);
$success = test('↕↑↔§P↔§P ♫§T↕§↕', hexToStr(strToHex('↕↑↔§P↔§P ♫§T↕§↕')), $success);

echo $success ? "Success" : "\nFailed"; 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2017-09-21T13:02:05.523

PHP：

字符串到十六进制：

```
implode(unpack("H*", $string)); 
```

十六进制转字符串：

```
pack("H*", $hex); 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2016-03-08T21:30:35.280

这是我使用的：

```
function strhex($string) {
  $hexstr = unpack('H*', $string);
  return array_shift($hexstr);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-04-12T14:03:37.937

```
function hexToStr($hex){
    // Remove spaces if the hex string has spaces
    $hex = str_replace(' ', '', $hex);
    return hex2bin($hex);
}
// Test it 
$hex    = "53 44 43 30 30 32 30 30 30 31 37 33";
echo hexToStr($hex); // SDC002000173

/**
 * Test Hex To string with PHP UNIT
 * @param  string $value
 * @return 
 */
public function testHexToString()
{
    $string = 'SDC002000173';
    $hex    = "53 44 43 30 30 32 30 30 30 31 37 33";
    $result = hexToStr($hex);

    $this->assertEquals($result,$string);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-10-31T23:13:38.890

使用@bill-shirley 回答并稍加补充

```
function str_to_hex($string) {
$hexstr = unpack('H*', $string);
return array_shift($hexstr);
}
function hex_to_str($string) {
return hex2bin("$string");
} 
```

用法：

```
 $str = "Go placidly amidst the noise";
  $hexstr = str_to_hex($str);// 476f20706c616369646c7920616d6964737420746865206e6f697365
  $strstr = hex_to_str($str);// Go placidly amidst the noise 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-22T14:05:15.507

我只有一半的答案，但我希望它是有用的，因为它增加了 unicode (utf-8) 支持

```
 /**
     * hexadecimal to unicode character
     * @param  string  $hex
     * @return string
     */
    function hex2uni($hex) { 
      $dec = hexdec($hex);
        if($dec < 128) {
            return chr($dec);
        }
        if($dec < 2048) {
            $utf = chr(192 + (($dec - ($dec % 64)) / 64));
        } else {
            $utf = chr(224 + (($dec - ($dec % 4096)) / 4096));
            $utf .= chr(128 + ((($dec % 4096) - ($dec % 64)) / 64));
        }
        return $utf . chr(128 + ($dec % 64));
    } 
```

串起来

```
 var_dump(hex2uni('e641')); 
```

基于：[http ://www.php.net/manual/en/function.chr.php#Hcom55978](http://www.php.net/manual/en/function.chr.php#Hcom55978)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-11-10T07:01:30.737

您可以尝试以下代码将图像转换为十六进制字符串

```
<?php
$image = 'sample.bmp';
$file = fopen($image, 'r') or die("Could not open $image");
while ($file && !feof($file)){
$chunk = fread($file, 1000000); # You can affect performance altering
this number. YMMV.
# This loop will be dog-slow, almost for sure...
# You could snag two or three bytes and shift/add them,
# but at 4 bytes, you violate the 7fffffff limit of dechex...
# You could maybe write a better dechex that would accept multiple bytes
# and use substr... Maybe.
for ($byte = 0; $byte < strlen($chunk); $byte++)){
echo dechex(ord($chunk[$byte]));
}
}
?> 
```

# javascript - 使用 Javascript 在运行时使用 Symfony 和资产

> ID：14674837
> 
> 赞同：3
> 
> 时间：2013-02-03T16:55:32.507
> 
> 标签：javascript, symfony, assets

正如官方[Symfony2 文档](http://symfony.com/doc/current/book/templating.html#linking-to-assets)中所解释的，在 Twig 模板中，可以链接到资产，如下所示：

```
<img src="{{ asset('images/logo.png') }}" alt="My logo" /> 
```

这将呈现`logo.png`资源的正确路径（这取决于 Symfony2 应用程序所在的文件夹）。

好吧，假设使用必须在运行时加载图像的 Javascript 代码（例如，作为自动完成的结果），**如何在 Javascript 中实现与`asset`Twig 中的函数**提供的相同结果？

一些注意事项：

1.  也许存在类似[FOSJsRoutingBundle](https://github.com/FriendsOfSymfony/FOSJsRoutingBundle)的东西，但我真的忽略了它！
2.  一种肮脏的方法可能是为已知资源（例如`logo.png`文件）生成路径，然后通过将字符串替换为空的字符串替换变量来`<script>var known = {{asset('images/logo.png)')}}</script>`检索路径。但这是一种肮脏的方式！`known``images/logo.png`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T22:26:07.543

您可以从`asset`函数中删除文件名以获取目录的绝对路径：

```
<script>
    var imgDir = {{ asset('images/') }}
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T17:09:36.050

从您的 js 文件到图像的路径很可能保持不变。这使您可以在 javascript 文件中使用“硬编码”路径。

例子：

```
web
 |
 |--js
 |   |
 |   |--foo.js
 |
 |--images
 |   |
 |   |--pic.jpg 
```

在这种情况下，您可以通过注意从 foo.js 访问 pic.jpg `../images/pic.jpg` ，该解决方案在您的 twig 视图中不起作用，因为在您的 twig 视图中，相对资产 url 取决于路由 url。这就是您需要该`asset`功能的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T14:46:24.180

Twig 不仅可以渲染 HTML 的 JS 文件。您可以创建一个 Twig 模板，该模板将返回包含您需要的所有脚本的 JS 文件。然后，您可以在此脚本文件中使用 Twig 的所有功能。

# php - 如何根据特定的行值将行转换为列？

> ID：14674842
> 
> 赞同：0
> 
> 时间：2013-02-03T16:56:29.207
> 
> 标签：php, mysql

我有如下选择的输出

```
| s.no | user_id | user_type | user_group | prefix | fname | mname | lname | suffix |nick_name | company | department | designation_title | industry | dob        | nationality | passport_number | photograph | mobile | email | permanent_address | temporary_address | bbm_p |t_number_arrival | departure_date_time | depart_airlines | flight_number_departure |

|   17 |       0 | Husband   |         23 | sasas  | asd   |       |       |       |           |          |            |                   |          |0000-00-00  |             |                 |            |      0 | asdas |                   | sadx              | asd| 0000-00-00 00:00:00   |                 |                         |
|   18 |       0 | wife      |         23 |        |       |       |       |        |           |         |            |                   |          | 0000-00-00 |             |                 |            |      0 |       |                   |                   |     | 0000-00-00 00:00:00 |                 |                         |
|   19 |       0 | kid1      |         23 |        |       |       |       |        |           |         |            |                   |          | 0000-00-00 |             |                 |            |      0 |       |                   |                   |    | 0000-00-00 00:00:00 |                 |                         |
|   20 |       0 | kid2      |         23 |        |       |       |       |        |           |         |            |                   |          | 0000-00-00 |             |                 |            |      0 |       |                   |                   |     | 0000-00-00 00:00:00 |                 |                         |
|   21 |       0 | kid3      |         23 |        |       |       |       |        |           |         |            |                   |          | 0000-00-00 |             |                 |            |      0 |       |                   |                   |    | 0000-00-00 00:00:00 |                 |                         |
|   22 |       0 | kid4      |         23 |        |       |       |       |        |           |         |            |                   |          | 0000-00-00 |             |                 |            |      0 |       |                   |                   |     | 0000-00-00 00:00:00 |                 |                         |
|   23 |       0 | Husband   |         24 | sasas  | asd   |       |       |        |           |         |            |                   |          | 0000-00-00 |             |                 |            |      0 | asdas |                   | sadx              | asd| 0000-00-00 00:00:00 |                 |                         |
|   24 |       0 | wife      |         24 |        |       |       |       |        |           |         |            |                   |          | 0000-00-00 |             |                 |            |      0 |       |                   |                   |    | 0000-00-00 00:00:00 |                 |                         |
|   25 |       0 | kid1      |         24 |        |       |       |       |        |           |         |            |                   |          | 0000-00-00 |             |                 |            |      0 |       |                   |                   | 
```

我需要转换如下

```
 | husband | wife | kid1 | kid2 | kid3 | kid4

   sasas  |       |      |       |      |
    asd   |       |      |       |      | 
```

如何修改我的选择查询以将记录分组在丈夫、妻子、孩子 1、孩子 2、孩子 3 和孩子 4 下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:17:11.410

您的问题并不完全清楚，但您似乎想要取消*透视*现有列，然后*旋转*列中的值`user_type`。

如果是这种情况，那么您将需要使用 a`UNION ALL`来取消透视数据，然后应用带有`CASE`表达式的聚合函数来进行透视以获得最终结果：

```
select user_id, 
  user_group,
  col_name,
  max(case when user_type = 'Husband' then value end) as Husband,
  max(case when user_type = 'wife' then value end) as Wife,
  max(case when user_type = 'kid1' then value end) as Kid1,
  max(case when user_type = 'kid2' then value end) as Kid2,
  max(case when user_type = 'kid3' then value end) as Kid3,
  max(case when user_type = 'ki4=d4' then value end) as Kid4
from
(
  select user_id, user_type, user_group,
      'prefix' as col_name, prefix as value
  from yourtable
  union all
  select user_id, user_type, user_group,
      'fname' as col_name, fname as value
  from yourtable
  union all
  select user_id, user_type, user_group,
      'mname' as col_name, mname as value
  from yourtable
  union all
  select user_id, user_type, user_group,
      'lname' as col_name, lname as value
  from yourtable
  union all
  select user_id, user_type, user_group,
      'suffix' as col_name, suffix as value
  from yourtable
  union all
  select user_id, user_type, user_group,
      'nick_name' as col_name, nick_name as value
  from yourtable
  union all
  select user_id, user_type, user_group,
      'company' as col_name, company as value
  from yourtable
  union all
  select user_id, user_type, user_group,
      'department' as col_name, department as value
  from yourtable
) src
group by user_id, user_group, col_name 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!2/08b5a/6)。您的示例数据没有很多值，但结果将与此类似：

```
| USER_ID | USER_GROUP |   COL_NAME | HUSBAND |   WIFE |   KID1 |   KID2 |   KID3 |   KID4 |
--------------------------------------------------------------------------------------------
|       0 |         23 |    company |  (null) | (null) | (null) | (null) | (null) | (null) |
|       0 |         23 | department |  (null) | (null) | (null) | (null) | (null) | (null) |
|       0 |         23 |      fname |     asd | (null) | (null) | (null) | (null) | (null) |
|       0 |         23 |      lname |  (null) | (null) | (null) | (null) | (null) | (null) |
|       0 |         23 |      mname |  (null) | (null) | (null) | (null) | (null) | (null) |
|       0 |         23 |  nick_name |  (null) | (null) | (null) | (null) | (null) | (null) |
|       0 |         23 |     prefix |   sasas | (null) | (null) | (null) | (null) | (null) |
|       0 |         23 |     suffix |  (null) | (null) | (null) | (null) | (null) | (null) |
|       0 |         24 |    company |  (null) | (null) | (null) | (null) | (null) | (null) |
|       0 |         24 | department |  (null) | (null) | (null) | (null) | (null) | (null) |
|       0 |         24 |      fname |     asd | (null) | (null) | (null) | (null) | (null) |
|       0 |         24 |      lname |  (null) | (null) | (null) | (null) | (null) | (null) |
|       0 |         24 |      mname |  (null) | (null) | (null) | (null) | (null) | (null) |
|       0 |         24 |  nick_name |  (null) | (null) | (null) | (null) | (null) | (null) |
|       0 |         24 |     prefix |   sasas | (null) | (null) | (null) | (null) | (null) |
|       0 |         24 |     suffix |  (null) | (null) | (null) | (null) | (null) | (null) | 
```

*注意：我包括了额外的列来取消透视，但如果你只想要`fname`你只会在子查询中包含这些列*

编辑＃1，如果您需要根据原始表中的列保持数据的顺序，那么您可以`UNION ALL`使用排序顺序向查询中添加一列。然后，您可以在`ORDER BY`. 所以查询将是：

```
select user_id, 
  user_group,
  col_name,
  max(case when user_type = 'Husband' then value end) as Husband,
  max(case when user_type = 'wife' then value end) as Wife,
  max(case when user_type = 'kid1' then value end) as Kid1,
  max(case when user_type = 'kid2' then value end) as Kid2,
  max(case when user_type = 'kid3' then value end) as Kid3,
  max(case when user_type = 'ki4=d4' then value end) as Kid4
from
(
  select user_id, user_type, user_group,
      'prefix' as col_name, prefix as value
      , 1 as sortorder
  from yourtable
  union all
  select user_id, user_type, user_group,
      'fname' as col_name, fname as value
      , 2 as sortorder
  from yourtable
  union all
  select user_id, user_type, user_group,
      'mname' as col_name, mname as value
      , 3 as sortorder
  from yourtable
  union all
  select user_id, user_type, user_group,
      'lname' as col_name, lname as value
      , 4 as sortorder
  from yourtable
  union all
  select user_id, user_type, user_group,
      'suffix' as col_name, suffix as value
      , 5 as sortorder
  from yourtable
  union all
  select user_id, user_type, user_group,
      'nick_name' as col_name, nick_name as value
      , 6 as sortorder
  from yourtable
  union all
  select user_id, user_type, user_group,
      'company' as col_name, company as value
      , 7 as sortorder
  from yourtable
  union all
  select user_id, user_type, user_group,
      'department' as col_name, department as value
      , 8 as sortorder
  from yourtable
) src
group by user_id, user_group, col_name
order by user_group, sortorder 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!2/08b5a/18)

# iphone - 调整滚动视图以适应文本长度

> ID：14674843
> 
> 赞同：0
> 
> 时间：2013-02-03T16:56:33.987
> 
> 标签：iphone, objective-c, ipad, uiscrollview, core-text

我有一个滚动详细信息视图，其中我使用 Core Text（iPhone 和 iPad）显示来自数据库的一些文本。目前，我的滚动视图是默认设置长度。但是，由于某些文本条目比其他条目长，这意味着我在文本下方有很多空白区域用于一些细节视图。

谁能建议我如何根据文本的长度动态更改滚动视图的长度？

欢迎所有想法。

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:27:37.127

试试这个...

```
NSString *text = @"your text from db";

CGSize constraint = CGSizeMake(textview.frame.size.width, 20000.0f);

CGSize size = [text sizeWithFont:[UIFont systemFontOfSize:FONT_SIZE] constrainedToSize:constraint lineBreakMode:UILineBreakModeWordWrap];

textview.frame = CGRectMake(0, 0, size.width, size.height);

[yourScrollView setContentSize:CGSizeMake(textview.frame.size.width,textview.frame.size.height]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:17:12.693

尝试类似：

```
float yourDynamicHeight = 0;
for(UILabel *lbl in yourArrayOfLabels) {
    yourDynamicHeight += lbl.frame.size.height;
}
// Perhaps add some arbitrary extra height

[yourScrollView setContentSize:CGSizeMake(yourWidth,yourDynamicHeight]; 
```

注意：在旅途中写这个，所以没有编译测试它。）

希望能帮助到你！

# c++ - C++ 编程练习——深拷贝

> ID：14674844
> 
> 赞同：2
> 
> 时间：2013-02-03T16:56:40.233
> 
> 标签：c++, console-application

我正在尝试在 C++ 中为类创建一个基本的 ArrayList 实现。课程要求比较严格，需要数据成员和函数。但是，当我运行它时，当它尝试删除 deepCopy 中的列表指针时，我得到“无法访问内存位置”。我似乎无法弄清楚为什么。请帮忙。谢谢！

# 编辑：

我已经缩小了代码范围。不过，我仍然想为您提供足够的信息以提供帮助。

# 编辑#2

美国要求完整的代码，所以我把它加回来了。

## 列表.h

```
#ifndef LIST_H
#define LIST_H

/**
* This implentation of list is a pseudo ArrayList.  Since we don't guarantee that a class has a hashCode in C++
* this will only work for objects which have an id field.
*
*/
template <class T>
class List{
    private:
                                                // If you want the max size of the list (100), then you should probably create a const. Example:
                                                // const int MAX_SIZE;
                                                // T[] list = new T[MAX_SIZE];

                                                // But really, that is not much better.  This is just bad, overall.  It's like we're implementing a very poor ArrayList.

        T * list;                               // This is our array for our elements.
        int numberInList;                       // 
        int listSize;                           // Getter method will be getMaxSize.  This seems unnecessary if we're initializing it to 100...
        int nextIndex;                          // this is a number of the index for the next element.  Really, this should be inside a private class (who has the pointer to its next).
        double loadFactor;                      // We need to determine when we need to allocate additional slots so we don't run out if they try to add more than they have allocated.
        void deepCopy(const List<T> & toBeCopied ); // We need a method to perform a deepCopy.  Abstracts the implementation from each method. Private because we don't want it exposed to clients.
        bool isAboveThreshold();                // Check if the list is above the loadFactor.

    // Publicly available API
    public:
        List();
        List(int size);                         // Overloaded constructor to initialize the List to a runtime size
        List(const List<T> & toBeCopied);       // Copy constructor
        ~List();                                // Destructor -- Get rid of the dynamically allocated member.
        T next();                               // Gets the next element in the list, and increments next
        bool add( T & element );                // Adds an element to the list.  Also checks to make sure the element hasn't already been added.
        bool contains(T & element);             // Checks the list to see if the element exists in the list already.
        int getSize();                          // return the number of elements in the list.
        List<T> & List<T>::operator =( const List<T> & toBeCopied );
};

template <class T>
List<T>::List(){
    listSize = 100;
    list = new T[listSize];
    numberInList = 0;
    nextIndex = 0;                              // Initialize the next element to 0.
    loadFactor = 0.75;
};

template <class T>
List<T>::List(int size){
    list = new T[size];
    numberInList = 0;
    nextIndex = 0;                              // Initialize the next element to 0.
    listSize = size;
    loadFactor = 0.75;
};

template <class T>
List<T>::List(const List<T> & toBeCopied){
    deepCopy(toBeCopied);
};

/****
*
* We need to release the allocated heap memory.  Non-pointer members will be deallocated when they are out of scope.
*
*/
template <class T>
List<T>::~List(){
    delete [] list;
};

/**
* Return the number of elements in the list.
*/
template <class T>
int List<T>::getSize(){
    return numberInList;
}

/**
* Return the number of elements in the list.
*/
template <class T>
T List<T>::next(){
    return list[nextIndex++];
}

/**
* Check if the element is already in the list
*/
template <class T>
bool List<T>::contains( T & element){
                                                        // Now, to check if the item already exists, we could just iterate over the array, but that gives us linear execution time.
                                                        // It seems sub-optimal to work in linear time here, when it feels like we shouldn't have to, but honestly, I'm too tired
                                                        // to care at this point.
    for(int i = 0; i < (numberInList); i++){
        if(element != list[i])                          // We do this so that if the first item is not equal, we don't even bother checking the second condition.
        {
                                                        // The element isn't matched.  We have to finish iterating, though, before we can add it.
        }
        else{                                           // The element matched.  Return false.
            element = list[i];
            return true;
        }
    }
    return false;
}

/**
* The implementation for this is very bad.  But, the requirements in the homework documentation are very restrictive.
*
* Ideally, we would have a companion class named Entry which kept the reference to the element via composition.
*
* Obviously, this is a list, so we only want unique entries.
* 
* if successful, we return a true.  Else, we're returning false.
*
*/
template<class T>
bool List<T>::add( T & element ){
    // If we've exceeded the loadFactor, we want to expand our array before we add.
    if( isAboveThreshold() ){
        int newSize = listSize*2;
        List<T> tempPtr = List<T>(newSize);
        for(int i = 0; i < numberInList; i++){
            tempPtr.add(list[i]);
        }

        deepCopy(tempPtr);
    }
    if(!contains( element )){
        list[numberInList] = element;                   // if there are 4 in the list, the next empty index is 4, so this works.  We get our element, then post-increment.
        numberInList++;
        return true;
    }
    return false;

}

/**
* Deep copy mechanism
*/
template<class T>
void List<T>::deepCopy(const List<T> & toBeCopied){

    // Take care of shallow copying first.
    numberInList = toBeCopied.numberInList;
    listSize = toBeCopied.listSize;
    nextIndex = 0;                                      // We're getting a new list, so our iterator should start over.

                                                        // Now, to initialize the new list
    T *tempList = new T[listSize];

    for(int i = 0; i < toBeCopied.numberInList; i++){
        // We can do this because we're in the List class.  We have access to private members.
        tempList[i] = toBeCopied.list[i];
    }

    delete [] list;
    list = tempList;

}

/**
* boolean for if we've exceeded the loadFactor threshold.
*/
template<class T>
bool List<T>::isAboveThreshold(){
    if(numberInList != 0){
        double division = (double)numberInList/listSize;
        return (division >= loadFactor)? true : false;
    }else
        return false;
}

/***
*   Overloaded assignment operator
*/
template <class T>
List<T> & List<T>::operator =( const List<T> & assigner ){
    if(*this == &assigner)
        return *this;
    delete[] list;
    deepCopy(assigner);
    return *this;
}
#endif 
```

## 客户端.cpp

```
#include "List.h"
#include <string>
#include<iomanip>
#include <iostream>
#include <fstream>
#include <stdlib.h>
using namespace std;

struct Customer{
    int id;
    string name;
    string city;
    string address;
    float amount;
    Customer(){id=0; city="Default"; name="N/A"; address="N/A", amount = 0;}
    bool operator==( const Customer & assign){
        if(assign.id == id)
            return true;
        else
            return false;
    }
    bool operator!=( const Customer & assign){
        if(assign.id != id)
            return true;
        else
            return false;
    }
};

List<Customer> readCustomers();
void printCustomers();

int main(){
    cout.setf(std::ios::fixed);
    printCustomers();
    return 0;
}

// Definitions
List<Customer> readCustomers(){
    List<Customer> WebsterCommunications(50);
    ifstream custFile;
    custFile.open("Customers.csv");

    // This could be abstracted out into another method, where we took the struct, a struct name, and the inFile, and spit back a 
    // customer from the file.  But, for now, we'll just settle with the code duplication.
    if(!custFile){
        cout << "There was a problem reading the Customer File..." << endl;
        exit(99);
    }

    while(!custFile.eof()){
        Customer tempCust;
        custFile>>tempCust.id;
        if(tempCust.id == 0)
            break;
        custFile.ignore();
        getline(custFile, tempCust.name, ',');
        getline(custFile, tempCust.address, ',');
        getline(custFile, tempCust.city, ',');
        custFile>>tempCust.amount;
        custFile.ignore();
        WebsterCommunications.add(tempCust);
    }
    custFile.close();
    return WebsterCommunications;
}

void printCustomers(){
            List<Customer> customers = readCustomers();
            double addCalc = 0.0;

            cout << string( 100, '\n' );
            for(int i = 0; i < customers.getSize(); i++){
                Customer cust;
                cust = customers.next();
                cout << "id: " << cust.id << " name: " << cust.name << " address: " << cust.address << " balance: " << cust.amount << endl;
                addCalc += cust.amount;
            }
            cout.precision(2);
            cout << "average: " << (addCalc / customers.getSize()) << endl;
            int isActive = 1;
            cout << "Please enter a customer's id to find them (0 to exit):" << endl;
            while(isActive){
                cin >> isActive;
                if(!isActive){
                    return;
                }
                Customer tempCust;
                tempCust.id = isActive;
                if(customers.contains(tempCust)){
                    cout << "id: " << tempCust.id << " name: " << tempCust.name << " address: " << tempCust.address << " balance: " << tempCust.amount << endl;
                }
                else{
                    cout << "That customer is not found" << endl;
                }
                cout << "Please enter a customer's id to find them (0 to exit):" << endl;
            }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T17:02:53.773

在`operator=`中，您尝试删除当前附加到您的对象的内部列表，但您实际上做的是删除`list`您想要复制的 - 在复制构造函数中，`list`命名参数而不是类成员。

通过为类成员和参数提供不同的名称来解决此问题。C++ 中有明确定义的名称隐藏规则，但依赖它们几乎总是会导致混乱。

* * *

而且你还在双重删除`list`！一次进入你的`deepCopy`，一次进入你的`operator=`！您需要重新考虑您的设计以及在哪些资源之后应该清理什么。快速修复不是删除 in `deepCopy`，但我没有想过这可能会如何泄漏。我会留给你找到更好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T19:07:34.827

问题是复制构造函数。在它调用 deepCopy 时，列表指针还没有为其分配内存。因此，通过初始化指向 Customer 结构数组的指针，我们消除了这个问题。

# ruby - 如果 || 优先级高于=，那为什么`a || a = b`工作？

> ID：14674847
> 
> 赞同：1
> 
> 时间：2013-02-03T16:56:57.690
> 
> 标签：ruby

`||`我理解and `or`， or `&&`and之间的区别`and`，但我不明白的是：

考虑一个返回 的值的方法，或者如果为 false 为 nil`@var`则初始化它。`@var`

由于我来自 JavaScript 背景，我会这样写，因为`||`它的优先级高于`=`：

```
def some_method
  @var || (@var = MyClass.new)
end 
```

或使用`or`，因为`or`优先级较低：

```
def some_method
  @var or @var = MyClass.new
end 
```

或更简洁地说：

```
def some_method
  @var ||= MyClass.new
end 
```

但碰巧这个版本**也有效**：

```
def some_method
  @var || @var = MyClass.new
end 
```

我在网上搜索，但没有找到有用的结果。

他们中的大多数只是说出和之间的`||`区别`or`。

运算符优先级表清楚地表明`||`具有比 更高的优先级`=`。

我什至可以做到`a = b || c = d`，而 Ruby 将其视为`a = (b || (c = d))`.

这种行为是记录在某处还是 Ruby 中的某种魔法？

PS CoffeeScript 也有同样的行为。

**更新/澄清**：这个问题与短路评估无关。但是关于运算符优先级。请让我重新表述一下：

如果`||`优先级高于`=`，那么为什么 ruby​​ 会看到`a || a = b`as `a || (a = b)`，而不是看到`(a || a) = b`并引发语法错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T17:15:02.337

Ruby 使用所谓的`short-circuit evaluation`来评估这些逻辑表达式。只有当第一个参数不足以评估表达式时，才会考虑第二个参数。

在您的示例中，因为`@var`is 最初`nil`，表达式的后半部分被评估并设置为`MyClass.new`.

这些表达式的扩展非常有趣。[这里](http://procnew.com/ruby-short-circuit-edge-case-response.html)和[这里](http://dablog.rubypal.com/2008/3/25/a-short-circuit-edge-case)有一些博客文章很好地涵盖了它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T17:32:10.090

仅当表达式中存在歧义时，优先级才会成为问题。的情况下：

```
 @var || @var = MyClass.new 
```

没有歧义。赋值运算符`=`只有在它的左侧有一个变量时才有意义（忽略多重赋值产生的复杂性）。将某些东西分配给名为“”的变量是没有意义的`@var || @var`。因此，没有歧义。解释上述表达式的唯一方法是将其解释为：

```
 @var || (@var = MyClass.new) 
```

因此，优先级在这里不是问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T17:20:39.173

`and`我会完全忘记`or`。如果需要， 只需使用`&&`and ，带括号。`||`

您的最后一个示例仅有效，因为您使用的是实例变量。考虑这里的区别：

```
1.9.3> newvar
NameError: undefined local variable or method `newvar' for main:Object
        from (irb):59
        from /home/don/.rvm/rubies/ruby-1.9.3-p194/bin/irb:16:in `<main>'
1.9.3> @newvar
 => nil 
```

如果你尝试`newvar || newvar = 3`它会引发错误。

你可能想看看这个 SO 问题：[What does ||= (or-equals) mean in Ruby?](https://stackoverflow.com/questions/995593/what-does-or-equals-mean-in-ruby) .

# vb.net - VB.net上传字符串到ftp服务器，保存为文件

> ID：14674850
> 
> 赞同：-2
> 
> 时间：2013-02-03T16:57:03.860
> 
> 标签：vb.net, ftp

尝试使用用户名和密码直接从 vb.net 应用程序将字符串内容上传到服务器，以作为文件保存在服务器中。而不是上传文件，可能吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T17:04:47.183

**新答案：**
好的，有两种方法可以做到这一点。首先是创建一个临时文件 - 包含您的字符串 - 并将其写入 FTP 服务器，并在临时文件写入服务器后删除它。第二种方法是使用我找到的这个在线示例：[http](http://www.example-code.com/vb/ftp_uploadFromString.asp) ://www.example-code.com/vb/ftp_uploadFromString.asp您所要做的就是用您的字符串替换 fileContents 变量。唯一的问题是使用的 Visual Basic 框架是 30 天试用版，因此您需要购买它。

**旧答案：**

> 您需要提供更多信息，但我将尝试理解这一点。您可以将字符串写入您的 FTP 服务器。这很简单，您可以在 google 上轻松找到示例，但这里有一个链接可以教您如何设置自己的 FTP 客户端：
> 
> [http://www.codeproject.com/Articles/11991/An-FTP-client-library-for-NET-2-0](http://www.codeproject.com/Articles/11991/An-FTP-client-library-for-NET-2-0)
> 
> 或者您可以使用它只提供可下载的源代码：
> 
> [http://www.freevbcode.com/ShowCode.asp?ID=4655](http://www.freevbcode.com/ShowCode.asp?ID=4655)

# c - OpenGL 窗口错误

> ID：14674853
> 
> 赞同：0
> 
> 时间：2013-02-03T16:57:19.973
> 
> 标签：c, windows, window, opengl-4

我正在尝试在 C 中创建一个简单的 OpenGL 窗口，但我遇到了窗口本身的问题。创建了一个窗口，然后它突然消失了。我通过将“msg”归零来解决这个问题，但是窗口仍然试图退出并且所有其他消息都没有传递。所以我无法通过按 Escape 退出（未通过 WM_KEYDOWN）。渲染图形就像它应该的那样工作。有谁知道这是什么原因，以及如何解决？

入口点.c

```
#include "main.h"
#include "graphics.h"

int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
{
    int breedte, hoogte;
    DEVMODE dmScreenSettings;
    HWND hWnd;
    WNDCLASSEX wcex;
    MSG msg;

    wcex.cbSize = sizeof(WNDCLASSEX);
    wcex.style = CS_HREDRAW | CS_VREDRAW | CS_OWNDC;
    wcex.lpfnWndProc = Actie;
    wcex.cbClsExtra = 0;
    wcex.cbWndExtra = 0;
    wcex.hInstance = hInstance;
    wcex.hIcon = LoadIcon(NULL,IDI_APPLICATION);
    wcex.hCursor = LoadCursor(NULL,IDC_ARROW);
    wcex.hbrBackground = (HBRUSH) GetStockObject(GRAY_BRUSH);
    wcex.lpszMenuName = NULL;
    wcex.lpszClassName = L"WinClass";
    wcex.hIconSm = NULL;
    breedte = GetSystemMetrics(SM_CXSCREEN);
    hoogte = GetSystemMetrics(SM_CYSCREEN);
    RegisterClassEx(&wcex);

    // Tijdelijk "nep" venster maken
    hWnd = CreateWindowEx(WS_EX_APPWINDOW, L"WinClass", L"My Window", WS_POPUP,
        0, 0, 640, 480, NULL, NULL, hInstance, NULL);
    if(hWnd == NULL) {
        MessageBox(NULL, L"Error: er kon geen venster worden gemaakt.", L"ERROR", MB_OK);
        return -1;
    }

    if (InitializeExtensions(hWnd) != 0) {
        MessageBox(NULL, L"Error: OpenGL extensies konden niet worden geladen.", L"ERROR", MB_OK);
        return -1;
    }

    // Tijdelijk venster verwijderen
    DestroyWindow(hWnd);

    if (FULLSCREEN == 1) {
        memset(&dmScreenSettings, 0, sizeof(dmScreenSettings));
        dmScreenSettings.dmSize       = sizeof(dmScreenSettings);
        dmScreenSettings.dmPelsWidth  = (unsigned long)breedte;
        dmScreenSettings.dmPelsHeight = (unsigned long)hoogte;
        dmScreenSettings.dmBitsPerPel = 32;         
        dmScreenSettings.dmFields     = DM_BITSPERPEL | DM_PELSWIDTH | DM_PELSHEIGHT;
        ChangeDisplaySettings(&dmScreenSettings, CDS_FULLSCREEN);
        hWnd = CreateWindowEx(WS_EX_APPWINDOW, L"WinClass", L"My Window", WS_POPUP, 
            0, 0, breedte, hoogte, NULL, NULL, hInstance, NULL);
    }
    else {
        hWnd = CreateWindowEx(WS_EX_APPWINDOW, L"WinClass", L"My Window", WS_POPUP,  
            (breedte / 4), (hoogte / 4), (breedte / 2), (hoogte / 2), NULL, NULL, hInstance, NULL);
        breedte /= 2;
        hoogte /= 2;
    }

    if(hWnd == NULL) {
        MessageBox(NULL, L"Error: er kon geen venster worden gemaakt.", L"ERROR", MB_OK);
        return -1;
    }

    if (InitializeOpenGL(hWnd, breedte, hoogte, SCREEN_DEPTH, SCREEN_NEAR, VSYNC) != 0) {
        MessageBox(NULL, L"Error: OpenGL kon niet worden geïnitialiseerd", L"ERROR", MB_OK);
        return -1;
    }

    // Scherm laten zien
    ShowWindow(hWnd, SW_SHOW);
    UpdateWindow(hWnd);
    SetForegroundWindow(hWnd);
    SetFocus(hWnd);

    main_loop(&msg, hWnd);
    return msg.wParam;
} 
```

主程序

```
#include "main.h"
#include "graphics.h"

void keyevent();

BYTE key_down[256];

LRESULT CALLBACK CALLBACK Actie(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
    switch (msg)
    {
    case WM_DESTROY:
        ShutdownOpenGL(hWnd);
        PostQuitMessage(0);
        return 0;
    case WM_KEYDOWN:
        key_down[(unsigned int)wParam] = 1;
        keyevent();
        return 0;
    case WM_KEYUP:
        key_down[(unsigned int)wParam] = 0;
        return 0;
    default:
        return DefWindowProc(hWnd, msg, wParam, lParam);
        break;
    }
}

void main_loop(MSG* msg, HWND hWnd)
{
    memset(key_down, 0, 256);
    memset(&msg, 0, sizeof(MSG));

    while (1) {
        if(PeekMessage(msg, NULL, 0, 0, PM_REMOVE)) {
            if(msg->message == WM_QUIT) 
                break;

            TranslateMessage(msg);  
            DispatchMessage(msg);
        }

        if (Render() != 0) {
            break;
        }
    }
}

void keyevent()
{
    if (key_down[VK_ESCAPE] == 1) {
        PostQuitMessage(0);
    }
} 
```

主文件

```
#ifndef MAIN_HEADER

#define MAIN_HEADER
#define FULLSCREEN      1
#define VSCYNC          1
#define SCREEN_DEPTH    1000.0f
#define SCREEN_NEAR     0.1f

#include <Windows.h>

LRESULT CALLBACK CALLBACK Actie(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
void main_loop(MSG* msg, HWND hWnd);

#endif 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:03:14.713

1.  您的 ZeroMemory'ing 过多并且正在破坏您的堆栈。
2.  当您销毁临时窗口时，它会调用`PostQuitMessage`，因为这是您在其`WM_DESTROY`处理程序中告诉它执行的操作。然后，您的消息循环会拾取该退出消息，这会导致它立即退出。

# web-services - 使用 CXF 等 Web 服务框架的好处

> ID：14674859
> 
> 赞同：0
> 
> 时间：2013-02-03T16:58:12.997
> 
> 标签：web-services, rest, cxf

我对 REST 很陌生。据我所知，我可以使用普通的 Servlet 返回以下 JSON 文本：

```
{ "firstName":"John" , "lastName":"Doe" } 
```

因此称其为基于 REST 的 Web 服务。那么，问题是我们为什么要使用 CXF 等 Web 服务框架来创建基于 REST 的 Web 服务？使用框架仅仅是为了方便还是不仅仅是为了方便？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T18:40:39.843

> [W] 为什么我们使用 CXF 等 Web 服务框架来创建基于 REST 的 Web 服务？

因为该框架自动化了许多连接 webapp 级别和方法级别之间的粘合代码。您可以避免编写对不同方法进行分派的代码，并利用框架理解的反序列化和序列化引擎。更重要的是，您可以通过注释等*声明式地执行此操作；*这比手工完成要容易得多。随着 webapp 复杂性的增加，这种优势变得更加强大；虽然对于只有一个表示的单个资源没有太多好处，但嵌套的 20-30 个资源集合每个都有许多表示和支持的方法，但手工将它们拼接在一起是一个完整的 PITA，并且一个框架有很大帮助。

简而言之，*框架只是让您避免编写大量无聊的代码，同时又很困难*。您不需要使用它们，实际上应该仅在它们有用时才使用它们，因为它们*确实*限制了整体灵活性，但在它们的领域内它们有很大帮助。

# http - 动态网络应用程序如何工作？

> ID：14674861
> 
> 赞同：4
> 
> 时间：2013-02-03T16:58:18.377
> 
> 标签：http, rest, web-applications, xmlhttprequest

好吧，我明白了互联网是如何工作的基本概念：客户端发送请求，服务器发回响应。但是我在尝试开发一个 Rails 应用程序时遇到了诸如 RESTful 架构、http 请求（GET、POST 等）、xhr 请求之类的东西。因此，我认为如果有人可以详细解释这些东西是什么以及它们如何在 CRUD 网络应用程序中组合在一起，那就太好了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T20:09:38.580

好的，我试一试：

> 为什么要使用 RESTful 架构？

如今，对于许多 Web 应用程序，人们正在数据库和应用程序之间构建一个 REST API。

REST API 向 Web 应用程序提供数据，它可以在服务器端（在将页面发送给用户之前）或在客户端（在用户下载页面之后）调用。

未来的项目也可以利用它。例如，假设您的网站起飞了，并且您还想要一个原生移动应用程序。您可以重新使用现有的 REST API 来完成此操作。

> HTTP 动词

长期以来，大多数 Web 开发人员使用 的唯一 HTTP 动词 ( [http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods ) 是 GET 和 POST。](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods)

处理数据的 REST 服务扩展了现有的 HTTP 动词，这些动词通常不会采取太多行动。因此，如果您想通过 REST 调用删除对象，您可以使用 DELETE 动词作为示例。

HTTP 动词只是为您的 REST 服务提供了一种更直观的数据操作方式。

> XHR 请求

XHR 请求 ( [http://en.wikipedia.org/wiki/XMLHttpRequest](http://en.wikipedia.org/wiki/XMLHttpRequest) ) - 只是进行 AJAX 调用的一种方式。这个想法是客户端（获取您的网页的人）将直接调用您的 REST 服务。

但最大的不同是调用是“在后台”进行的 - 或者换句话说 - 没有页面刷新。想想当您收到新电子邮件时 Gmail 是如何工作的。您不会注意到整个页面在浏览器中刷新。它只是提供更好的用户体验。

> 他们如何一起工作？

如今，在制作 Web 应用程序时，通常有一个 REST 服务/API 来为您的数据库中的数据提供服务。然后，当从您的 Web 应用程序访问该 REST 服务时，您可以决定是要在服务器端（来自 Java/C#/Ruby/whatever）还是从客户端（Javascript）进行这些调用。

每种方法都存在挑战，但希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T21:15:00.147

我无法直接回答你的问题。但是，客户端-服务器关系可以非常简单。前段时间，我试图了解它在实践中是如何工作的，并从 Java 的角度来做到这一点。所以写了一些代码，我已经使用了一段时间了。基本思想是我有某种客户端应用程序，它在获取一些日期后发送到服务器，服务器将其保存在文件中。也许它可以帮助您了解应该如何做：

**客户端：**

```
 try {
              // Establish connection with the server
              Socket socket = new Socket(host, 8000);

              // Create an output stream to the server
              ObjectOutputStream toServer =new ObjectOutputStream(socket.getOutputStream());
              String playerIPClean=socket.getLocalAddress().getHostAddress();
              String s=""; 
# you can put your data here in this string and send everything  in this string 
# (afterwords you split the data)

              toServer.writeObject(s);
              toServer.close();
              socket.close();
            }
            catch (IOException ex) {
              System.err.println(ex);
            } 
```

客户端发送请求发送字符串！ **服务器端：**

```
 public TheServer() {
        try {
          // Create a server socket
          ServerSocket serverSocket = new ServerSocket(8000);
          System.out.println("Server started ");
          PrintWriter outputToFile=null;
          while (true) {
            // Listen for a new connection request
            Socket socket = serverSocket.accept();

            // Create an input stream from the socket
            inputFromClient =
              new ObjectInputStream(socket.getInputStream());

            // Read from input
            Object object = inputFromClient.readObject();
            textContent=object.toString();
            textContent=object.toString();
            String fileNameComposer;
            fileNameComposer=fileName+"rew"+reward+"."+expName+"prize";
    //        System.out.println(fileName);
            try{
                outputToFile=new PrintWriter(new FileWriter(fileNameComposer));
                outputToFile.println(object);
            }
            catch (IOException e) {
                System.err.println("Caught IOException: "
                                    +  e.getMessage());

           } finally {
                inputFromClient.close();
                if (outputToFile != null) {
                    System.out.println("Closing PrintWriter");
                    outputToFile.close();
                }
                else {
                    System.out.println("PrintWriter not open");
                }
           }

            System.out.println("A new object is stored");
//          System.out.println(object);
          }
        }
        catch(ClassNotFoundException ex) {
          ex.printStackTrace();
        }
        catch(IOException ex) {
          ex.printStackTrace();
        }
        finally {

          try {
//          inputFromClient.close();
    //        outputToFile.close();
          }
          catch (Exception ex) {
            ex.printStackTrace();
          }
        }
      } 
```

当然，服务器应用程序应该持续运行以接受任何东西（我花了一些时间来理解这一点）。服务器接受请求，接收字符串并保存。这个想法在 Java 中很容易实现。实际上，Liang 的 Java 书对我理解 Java 中的这些东西有很大帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T18:36:38.097

对于 Rail CRUD 项目，我建议您看一下本教程（[http://guides.rubyonrails.org/getting_started.html](http://guides.rubyonrails.org/getting_started.html)），它将向您展示一个具有 CRUD 操作的基本 Web 应用程序，之后您可以尝试尝试添加 REST API 以使创建博客文章或使用 REST API 向文章添加评论成为可能。你可以在这里找到很多资源 ( [http://ruby.railstutorial.org/chapters/following-users#sec-rest_api](http://ruby.railstutorial.org/chapters/following-users#sec-rest_api) )

# c# - 链接列表框中的项目 C#

> ID：14674862
> 
> 赞同：0
> 
> 时间：2013-02-03T16:58:19.063
> 
> 标签：c#, wpf, listbox, filelist

有没有办法将两个项目链接`ListBox`在一起？我想要完成的是允许用户删除 a 中的项目，`ListBox`并且在删除该项目之前，如果它是偶数，它会删除它上面的一个项目，或者如果它是奇数，它会删除一个低于它的项目。还是我应该使用其他东西来代替 a `ListBox`？这是我处理删除的代码部分：

```
private void DeleteItem(string path)
{
    var index = FileList.IndexOf(path);
    if (index % 2 == 0)
    {
        FilesList.RemoveAt(index + 1);
    }
    else
    {
        FileList.RemoveAt(index - 1);
    }
    FileList.Remove(path);        
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:44:04.747

您真的需要链接两个不同的项目，还是只是需要列表中每个对象的两个项目的视觉外观（一个在另一个之上）？如果是后者，那么您可以定义视图模型并在 XAML 中指定项目模板。然后对于集合更改逻辑，您可以使用实现 INotifyCollectionChanged 并引发 CollectionChanged 事件的 ObservableCollection。

```
public partial class MainWindow : Window
{
    class ListItemViewModel
    {
        public string Name1 { get; set; }
        public string Name2 { get; set; }
    }

    ObservableCollection<ListItemViewModel> items;

    public MainWindow()
    {
        InitializeComponent();

        // Populate list...
        // In reality, populate each instance based on your related item(s) from your data model.
        items = new ObservableCollection<ListItemViewModel>
        {
            new ListItemViewModel { Name1 = "Foo1", Name2 = "Foo2" },
            new ListItemViewModel { Name1 = "Bar1", Name2 = "Bar2" }
        };

        listBox1.ItemsSource = items;
        items.CollectionChanged += items_CollectionChanged;
    }

    void items_CollectionChanged(object sender, NotifyCollectionChangedEventArgs e)
    {
        switch (e.Action)
        {
            case NotifyCollectionChangedAction.Remove:
                for (int i = 0; i < e.OldItems.Count; i++)
                {
                    var itemVm = e.OldItems[i] as ListItemViewModel;

                    // Update underlying model collection(s).
                }
                break;

            //  Handle cases Add and/or Replace...
        }
    }
} 
```

XAML：

```
<ListBox x:Name="listBox1">
    <ListBox.ItemTemplate>
        <ItemContainerTemplate>
            <StackPanel>
                <TextBlock Text="{Binding Name1}" />
                <TextBlock Text="{Binding Name2}" />
            </StackPanel>
        </ItemContainerTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

# php - 如何在 preg_replace 中划分 $1？

> ID：14674864
> 
> 赞同：1
> 
> 时间：2013-02-03T16:58:32.997
> 
> 标签：php, regex, preg-replace

我想转换 html 文档中的所有尺寸。带有 **px 的所有内容都应除以 4。因此 100px 将变为 25px。

例如：

```
<div style="height:100px;"></div> 
```

应该成为

```
<div style="height:25px;"></div> 
```

这是我写的一个php代码。但它不起作用。

```
$content = "<div style=\"height:100px;\"></div>";
$regex = "#([0-9]*)px#";
$output = preg_replace($regex,"$1/4",$content); 
```

我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T17:07:52.260

作为 的替代方法`preg_replace_callback`，您可以使用`e`修饰符将替换评估为 php：

```
$content = "<div style=\"height:100px;\"></div>";
$regex = "#([0-9]*)px#e";
$output = preg_replace($regex,"round($1/4).'px'",$content); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:00:21.540

将[http://php.net/manual/en/function.preg-replace-callback.php](http://php.net/manual/en/function.preg-replace-callback.php)与这样的回调函数一起使用

```
function divideBy4($m) {
   return ceil($m[1]/4);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T17:23:11.077

```
<?php
$content = "<div style=\"height:100px;\"></div>";
$regex = "#([0-9]*)px#";

$output = preg_replace_callback($regex, 
   create_function('$matches', 
   'return ceil($matches[1]/4)."px";'), 
   $content);
?>

<?php
$content = "<div style=\"height:100px;\"></div>";
$regex = "#([0-9]*)px#";
$output = preg_replace_callback($regex, 'myfunc', $content);
function myfunc($matches){
 return ceil($matches[1]/4).'px';
}
?> 
```

# python - 使用自定义包设置本地 PyPi 服务器

> ID：14674873
> 
> 赞同：6
> 
> 时间：2013-02-03T16:59:42.387
> 
> 标签：python, package, pypi

我想使用一组自定义包及其所有依赖项设置一个本地 PyPi 服务器。

我现在拥有的是格式的软件包列表：

```
django==1.4.3
celery==3.0.12
uwsgi==1.2.6
pillow==1.7.7
... 
```

我想有一个本地 PyPi 服务器，它可以为所有这些鸡蛋及其依赖项提供服务。

我怎样才能做到这一点？

理想情况下，我想要一个可以将 requirements.txt 文件作为输入的工具，下载所有列出的包并将它们复制到本地 pypi 中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T17:02:26.160

您设置了一个[本地 pypi服务器，并且只在](http://pypi.python.org/pypi/pypiserver)[存储库](http://pypi.python.org/pypi/pypiserver#managing-the-package-directory)中提供这些鸡蛋和依赖项......

所有这些都可以通过谷歌搜索“本地 pypi 服务器”获得。

### 编辑

编写一个脚本来解析您的`requirements.txt`文件并将包拉入您的本地存储库会很简单 - 但理想情况下，这是您在寻求帮助之前自己尝试的事情。

# c# - 如何在 AWS RDS 上配置分布式事务？

> ID：14674880
> 
> 赞同：3
> 
> 时间：2013-02-03T17:00:30.967
> 
> 标签：c#, amazon-web-services, amazon-rds, distributed-transactions

我正在尝试将 RDS 上的 MSSQL Server 用于我的 ASP.NET MVC 站点。不幸的是，由于会员资格提供者的工作方式（不让我访问它使用的交易），我必须`TransactionScope`在创建帐户时使用 a 以避免竞争条件和导致状态不一致的潜在故障（当我创建一个新的帐户我还想对数据库进行其他更改）。

但是，由于事务跨越两个不同的连接，我需要配置分布式事务。如果我只是使用虚拟机，这很好，但如果我尝试使用 RDS，那么我似乎找不到配置它的机制。

我已将端口 135 添加到安全组以使其通过，并且我很确定我已在 webserver/dev 框上正确配置了它（ish）。所以我现在留下以下错误。

> *合作伙伴事务管理器已禁用其对远程/网络事务的支持。*

我假设这意味着 RDS 服务器尚未配置此选项，但我不知道如何配置此选项。我的 Google fu 在这些搜索词（rds、aws、分布式事务、MSSQL Server）上似乎特别弱。我没有得到任何好的点击 D:.

更新：我遇到了[这篇](http://uksqlexperts.com/2012/07/24/sql-server-limitations-on-amazon-rds/)文章，该文章指出它在 7 月份不受支持......所以也许它还不支持。如果有人知道此状态是否有更新，请告诉我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T21:43:04.830

目前 RDS 似乎不支持分布式事务。

# android - 找不到原因“您必须指定创建选项卡指示器的方法”

> ID：14674881
> 
> 赞同：5
> 
> 时间：2013-02-03T17:00:44.897
> 
> 标签：android, runtime-error

我收到“您必须指定创建选项卡指示器的方法”错误（根据 logcat）。找不到原因。

主类：

```
package org.tatvamoksh.tml;

import android.app.TabActivity; 
import android.content.Intent;
import android.os.Bundle;
import android.view.Window;
import android.widget.TabHost;
import android.widget.TabHost.TabSpec;

@SuppressWarnings({ "deprecation" })
public class MainActivity extends TabActivity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    //Remove title bar
    this.requestWindowFeature(Window.FEATURE_NO_TITLE);

    setContentView(R.layout.activity_main);

    TabHost tabHost = getTabHost();

    // Tab for Tatva
    TabSpec t = tabHost.newTabSpec("Tatva");
    // setting Title and Icon for the Tab
    t.setIndicator("Tatva");
    Intent tatvaIntent = new Intent(this, TatvaActivity.class);
    t.setContent(tatvaIntent);

    // Tab for Moksh
    TabSpec m = tabHost.newTabSpec("Moksh");
    m.setIndicator("Moksh");
    Intent mokshIntent = new Intent(this, MokshActivity.class);
    m.setContent(mokshIntent);

    //Tab for Updates
    TabSpec u = tabHost.newTabSpec("Updates");
    m.setIndicator("Updates");
    Intent updatesIntent = new Intent(this, Updates.class);
    m.setContent(updatesIntent);

    // Adding all TabSpec to TabHost
    tabHost.addTab(t); // Adding Tatva tab
    tabHost.addTab(m); // Adding Moksh tab
    tabHost.addTab(u); // Adding Updates tab
}
} 
```

布局文件：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<TabHost
android:id="@android:id/tabhost"
android:layout_width="wrap_content"
android:layout_height="wrap_content" >

    <LinearLayout
   android:layout_width="match_parent"
   android:layout_height="match_parent"
   android:orientation="vertical" >

        <TabWidget
       android:id="@android:id/tabs"
       android:layout_width="match_parent"
       android:layout_height="wrap_content" />

        <FrameLayout
        android:id="@android:id/tabcontent"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

            <ListView
            android:id="@android:id/list"
            android:layout_width="match_parent"
            android:layout_height="match_parent" >
            </ListView>
        </FrameLayout>
    </LinearLayout>
</TabHost>
</RelativeLayout> 
```

注释掉以下代码可以修复它。

```
 //Tab for Updates
    TabSpec u = tabHost.newTabSpec("Updates");
    m.setIndicator("Updates");
    Intent updatesIntent = new Intent(this, Updates.class);
    m.setContent(updatesIntent); 
```

我猜不出确切的问题。将不胜感激任何指导。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T17:06:17.377

将最后一个标签代码更改为：

```
//Tab for Updates
    TabSpec u = tabHost.newTabSpec("Updates");
    u.setIndicator("Updates");
    Intent updatesIntent = new Intent(this, Updates.class);
    u.setContent(updatesIntent); 
```

因为您没有为 TabSpec 设置指示符和内容`u`（您正在为 m Tab 设置）

# php - 连接到第二个数据库在 CodeIgniter 中不起作用

> ID：14674883
> 
> 赞同：4
> 
> 时间：2013-02-03T17:01:18.640
> 
> 标签：php, database, codeigniter, phpbb, phpbb3

我试图将 phpbb3 与代码点火器集成。我非常成功，但我试图访问论坛数据库并且它无法正常工作。这是目前我的数据库文件中的内容。

```
/** FORUM DATABASE **/

$active_group = 'forum';
$active_record = TRUE;

$db['forum']['hostname'] = 'localhost';
$db['forum']['username'] = 'root';
$db['forum']['password'] = 'root';
$db['forum']['database'] = 'phpbb';
$db['forum']['dbdriver'] = 'mysqli';
$db['forum']['dbprefix'] = 'phpbb';
$db['forum']['pconnect'] = FALSE;
$db['forum']['db_debug'] = TRUE;
$db['forum']['cache_on'] = FALSE;
$db['forum']['cachedir'] = '';
$db['forum']['char_set'] = 'utf8';
$db['forum']['dbcollat'] = 'utf8_general_ci';
$db['forum']['swap_pre'] = '';
$db['forum']['autoinit'] = TRUE;
$db['forum']['stricton'] = TRUE;

/** CMS DATABASE **/
$active_group = 'default';
$active_record = TRUE;

$db['default']['hostname'] = 'localhost';
$db['default']['username'] = 'root';
$db['default']['password'] = 'root';
$db['default']['database'] = 'cms';
$db['default']['dbdriver'] = 'mysql';
$db['default']['dbprefix'] = '';
$db['default']['pconnect'] = FALSE;
$db['default']['db_debug'] = TRUE;
$db['default']['cache_on'] = FALSE;
$db['default']['cachedir'] = '';
$db['default']['char_set'] = 'utf8';
$db['default']['dbcollat'] = 'utf8_general_ci';
$db['default']['swap_pre'] = '';
$db['default']['autoinit'] = TRUE;
$db['default']['stricton'] = TRUE; 
```

这是一种尝试访问数据库的方法。它一直返回null。

```
public function getUserGroupMembership()
{
  $forum = $this->load->database('forum',TRUE);
  global $table_prefix;
  $userId = $this->_user->data['user_id'];
  $this->forum->select('g.group_name');
  $this->forum->from($table_prefix . 'groups g');
  $this->forum->from($table_prefix . 'user_group u');
  $this->forum->where('u.user_id', $userId);
  $this->forum->where('u.group_id', 'g.group_id', FALSE);
  $query = $this->forum->get();
  foreach ($query->result_array() as $group)
  {
      $groups[] = $group['group_name'];
  }
  return $groups;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T01:38:50.723

我相信您不需要为两个数据库重新声明 $active_group 和 $active_record 。

如果您删除：

$active_group = '论坛';
$active_record = TRUE;

它可能会起作用。您还应该按照 Maxime 所说的将 $forum 更改为 $this->forum。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T15:20:34.463

数据库对象加载在`$forum`变量中，但`$this->forum`变量用于与数据库交互。它不会像`$forum`局部变量和`$this->forum`类变量那样工作，它们是不一样的。要修复您的代码，您应该更改`$forum`为`$this->forum`或。您不能同时使用两者。`$this->forum``$forum`

# python - 如何在 Matplotlib 的 3D 散点图中关闭透明度？

> ID：14674885
> 
> 赞同：11
> 
> 时间：2013-02-03T17:01:26.170
> 
> 标签：python, matplotlib

我正在使用 Matplotlib 的 Axes3D 创建具有自定义颜色的散点图，如下所示：

```
from mpl_toolkits.mplot3d import Axes3D
from matplotlib import pyplot as plt

fig = plt.figure(1)
ax = Axes3D(fig)
ax.scatter(xval, yval, zval, c=cval, cmap=plt.cm.gray) 
```

这很好用，但是 matplotlib 会自动添加一些阴影，以使更远的点看起来更透明/比更近的点颜色更浅。这使得在视觉上比较各个点的颜色变得非常困难。

有什么办法可以关闭它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2019-11-15T15:28:02.373

您需要`depthshade=False`在 scatter 函数中添加为参数。

```
ax.scatter(xval, yval, zval, c=cval, cmap=plt.cm.gray, depthshade=False) 
```

[Matplotlib 3D 教程](https://matplotlib.org/mpl_toolkits/mplot3d/tutorial.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-09-21T08:24:58.000

只需`alpha = 1`在 scatter 函数中添加作为参数。

`ax.scatter(xval, yval, zval, c=cval, alpha = 1, cmap=plt.cm.gray)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T18:40:49.500

这实际上也是 Matplotlib 的 2d 散点图的一个特性，这里有一个[问题](https://stackoverflow.com/questions/2925806/fixing-color-in-scatter-plots-in-matplotlib)，有一个潜在的解决方案。

[Scatter](http://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes.scatter)的输入是实际需要配置的。

# android - SmsManager 空指针异常

> ID：14674890
> 
> 赞同：1
> 
> 时间：2013-02-03T17:01:37.440
> 
> 标签：android, smsmanager

我正在尝试使用**smsManager**从发送短信`BroadCast Receiver`。我收到此错误消息`NullPointerException`。我不知道这有什么问题。我厌倦了这个错误。这是我的代码段

```
GPSTracker tracker = new GPSTracker(context);
            MyLocation temp = tracker.getCurrentLocation();
            String message = sp.getString("auto_text", "") + "\n"
                    + "Latitude: "+temp.getLatitude() + "\nLogitude: "+temp.getLongitude();
            Toast.makeText(context, message, Toast.LENGTH_LONG).show();
            smsManager.sendTextMessage(smsMessage.getOriginatingAddress(),
                    null, message, null, null); 
```

字符串消息不为空。它显示在 toast 中。如果我将消息替换为

```
sp.getString("auto_text","")+" "+temp.getLatitude()+" "+temp.getLongitude(); 
```

然后它工作正常。

我的位置.java

```
import android.os.Parcel;
import android.os.Parcelable;

public class MyLocation implements Parcelable{

    double latitude,longitude;
    public MyLocation() {
    }
    public double getLatitude() {
        return latitude;
    }

    public void setLatitude(double latitude) {
        this.latitude = latitude;
    }

    public double getLongitude() {
        return longitude;
    }
    @Override
    public String toString() {
        return getLatitude()+" , "+getLongitude();
    }

    public void setLongitude(double longitude) {
        this.longitude = longitude;
    }

    @Override
    public int describeContents() {
        // TODO Auto-generated method stub
        return 0;
    }

    @Override
    public void writeToParcel(Parcel dest, int flags) {
        dest.writeDouble(latitude);
        dest.writeDouble(longitude);

    }
    public static final Parcelable.Creator<MyLocation> CREATOR = new Parcelable.Creator<MyLocation>() {
        public MyLocation createFromParcel(Parcel pc) {
            return new MyLocation(pc);
        }

        public MyLocation[] newArray(int size) {
            return new MyLocation[size];
        }
    };
    public MyLocation(Parcel pc){
        latitude = pc.readDouble();
        longitude  = pc.readDouble();

    }

} 
```

日志猫

```
FATAL EXCEPTION: main
02-03 08:54:22.822: E/AndroidRuntime(3124): java.lang.RuntimeException: Unable to start receiver com.blogspot.uappmarket.locationbasedproject.Receiver.InCommingSmsReceiver: java.lang.NullPointerException
02-03 08:54:22.822: E/AndroidRuntime(3124):     at android.app.ActivityThread.handleReceiver(ActivityThread.java:1805)
02-03 08:54:22.822: E/AndroidRuntime(3124):     at android.app.ActivityThread.access$2400(ActivityThread.java:117)
02-03 08:54:22.822: E/AndroidRuntime(3124):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:981)
02-03 08:54:22.822: E/AndroidRuntime(3124):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-03 08:54:22.822: E/AndroidRuntime(3124):     at android.os.Looper.loop(Looper.java:130)
02-03 08:54:22.822: E/AndroidRuntime(3124):     at android.app.ActivityThread.main(ActivityThread.java:3683)
02-03 08:54:22.822: E/AndroidRuntime(3124):     at java.lang.reflect.Method.invokeNative(Native Method)
02-03 08:54:22.822: E/AndroidRuntime(3124):     at java.lang.reflect.Method.invoke(Method.java:507)
02-03 08:54:22.822: E/AndroidRuntime(3124):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
02-03 08:54:22.822: E/AndroidRuntime(3124):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
02-03 08:54:22.822: E/AndroidRuntime(3124):     at dalvik.system.NativeStart.main(Native Method)
02-03 08:54:22.822: E/AndroidRuntime(3124): Caused by: java.lang.NullPointerException
02-03 08:54:22.822: E/AndroidRuntime(3124):     at android.os.Parcel.readException(Parcel.java:1328)
02-03 08:54:22.822: E/AndroidRuntime(3124):     at android.os.Parcel.readException(Parcel.java:1276)
02-03 08:54:22.822: E/AndroidRuntime(3124):     at com.android.internal.telephony.ISms$Stub$Proxy.sendText(ISms.java:369)
02-03 08:54:22.822: E/AndroidRuntime(3124):     at android.telephony.SmsManager.sendTextMessage(SmsManager.java:87)
02-03 08:54:22.822: E/AndroidRuntime(3124):     at com.blogspot.uappmarket.locationbasedproject.Receiver.InCommingSmsReceiver.onReceive(InCommingSmsReceiver.java:33)
02-03 08:54:22.822: E/AndroidRuntime(3124):     at android.app.ActivityThread.handleReceiver(ActivityThread.java:1794) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T12:43:19.850

我刚刚找到了这个问题的正当理由。即：`SmsManager.sendTextMessage() throws NullPointerException`当 SMS 消息超过大小限制时。即最大字符限制为 159。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-31T16:12:43.707

也许Harpreet是对的，事实上我刚才也遇到了这种情况。

您可以只使用方法[SmsManager.divideMessage(String text)](http://developer.android.com/reference/android/telephony/SmsManager.html#divideMessage%28java.lang.String%29)让系统处理长度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-24T21:44:37.917

SmsManager.sendTextMessage() 方法还会在传入无效数字作为目标的情况下引发 NPE。当我传递一个格式化的电话号码（例如“+1 999 999 9999”）时，我第一手发现了这一点。当我去掉空字符并删除国家代码前的“+”时，该方法没有抛出 NPE。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-21T16:09:39.467

@harpreet aswer 向我指出了错误的根源。

请注意，SMS 消息长度限制可能因您的移动网络运营商而异。

那么你有两个解决方案：

1 - 发送较短的消息。

-或者-

2 - 将它们分成几条消息（这可能会导致额外费用）

```
SmsManager sms = SmsManager.getDefault();
ArrayList<String> dividedText = sms.divideMessage(message);
for (String shortMessage : dividedText) {
    sms.sendTextMessage(phoneNumber,null,shortMessage,null,null);
    } 
```

# java - Java：比较整数之谜

> ID：14674899
> 
> 赞同：3
> 
> 时间：2013-02-03T17:03:14.867
> 
> 标签：java, int

我有一个充满整数的列表：

```
List collection = new ArrayList();
collection.add(this.score1);
collection.add(this.score2);
collection.add(this.score3); 
```

现在我想将最高分数与每个单独的分数进行比较，看看哪个分数最高。直觉上我试着这样做：

```
String highestScore;

if(Collections.max(collection) == this.score1) {
highestScore = "Score 1";
}

if(Collections.max(collection) == this.score2) {
highestScore += ", Score 2";

}

if(Collections.max(collection) == this.score3) {
highestScore += ", Score 3";

} 
```

然而，

```
Collections.max(collection) == this.score1
Collections.max(collection) == this.score2
Collections.max(collection) == this.score3 
```

都给我错误：

> 不兼容的操作数类型 Comparable 和 int

然而，这似乎工作：

```
int highestScoreValue =  Collections.max(collection); 
```

现在怎么可能？

为什么 Java 允许将 int 设置为`Collections.max(collection)`，但不允许将 int 与 进行比较`Collections.max(collection)`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T17:12:26.313

原始类型不能存储在 Java 集合中，它们会自动装箱在各自的类中。

每当你这样做`list.add(score)`时，`score`首先将其包装到一个`Integer`对象中，然后再添加到集合中。

现在，当您调用返回`Collections.max`类型的对象时`<T extends Object & Comparable<? super T>>`，您将其与原始类型进行比较，`==`但此运算符只能比较对对象或直接原始类型的引用，并且在您的情况下，由于您的`List`参数类型未指定，编译器无法将`Integer`返回到`int`.

可能的解决方案是

*   将返回的值转换为 a `Integer`，从而允许拆箱
*   使用`equals`方法而不是该`==`运算符，以便将分数装箱到 an`Integer`然后与结果进行比较`max`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T17:05:23.930

尝试使用`equals()`比较：

```
Collections.max(collection).equals(this.score1) 
```

请注意，该[`max()`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#max%28java.util.Collection%29)方法返回一个`Comparable`对象，该对象不能`==`与`int`. 另一种选择是首先将其转换为`Integer`. 作为旁注，这不是找到最大值的最有效方法，您在原始类型和对象类型之间来回切换。更好地实现您自己`max`的整数方法。

# java - 为什么我在此显示行上出现语法错误？

> ID：14674900
> 
> 赞同：-7
> 
> 时间：2013-02-03T17:03:21.020
> 
> 标签：java, syntax

我在下面的代码行中遇到了一些表达式错误和符号预期错误，但无法弄清楚原因。

```
System.out.println( "Hourly Rate: " money.format(myEmployee.getHourlyRate() ) ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T17:04:40.990

因为您需要`+`在 print 语句中连接两个值。

```
System.out.println( "Hourly Rate: " +  money.format(myEmployee.getHourlyRate() ) ); 
```

# asp.net-mvc-3 - ReleaseView 什么时候被调用？

> ID：14674902
> 
> 赞同：2
> 
> 时间：2013-02-03T17:03:55.717
> 
> 标签：asp.net-mvc-3, viewengine

我只是 MVC 的新手。

我已经开始阅读`Professional ASP.NET MVC3`Jon Galloway、Phil Haack、Brad Wilson、Scott Allen 的书了

在尝试学习如何创建自定义视图时，我看到了一个名为“ReleaseView”的方法。我已经用谷歌搜索并找到了它的定义。

我的问题是：何时调用方法（ReleaseView）？还有其他可以使用的地方在哪里？

在 msdn 上 ReleaseView 的定义是 `Releases the specified view by using the specified controller context`. 那么，我可以在我的控制器操作中使用这种方法吗？

如果我错了，请建议我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T17:12:34.210

> 何时调用方法（ReleaseView）？

它由以下`ViewResultBase.ExecuteResult`方法调用：

```
public override void ExecuteResult(ControllerContext context)
{
    if (context == null)
    {
        throw new ArgumentNullException("context");
    }
    if (string.IsNullOrEmpty(this.ViewName))
    {
        this.ViewName = context.RouteData.GetRequiredString("action");
    }
    ViewEngineResult result = null;
    if (this.View == null)
    {
        result = this.FindView(context);
        this.View = result.View;
    }
    TextWriter output = context.HttpContext.Response.Output;
    ViewContext viewContext = new ViewContext(context, this.View, this.ViewData, this.TempData, output);
    this.View.Render(viewContext, output);
    if (result != null)
    {
        result.ViewEngine.ReleaseView(context, this.View);
    }
} 
```

请注意，一旦视图呈现到输出流，就会调用 ReleaseView 方法。所以基本上每次控制器操作返回一个 View 或 PartialView 时，当这个 ActionResult 完成执行时，它会调用底层视图引擎上的 ReleaseView 方法。

> 还有其他可以使用的地方在哪里？

例如，如果您正在编写自定义 ActionResults。

> 那么，我可以在我的控制器操作中使用这种方法吗？

不，控制器动作在视图引擎开始执行之前就已经完成执行。

# asp.net-mvc - 如何在 ASP.NET MVC 4 上执行 301 从非斜线根重定向到斜线根域

> ID：14674903
> 
> 赞同：1
> 
> 时间：2013-02-03T17:04:14.027
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2, asp.net-mvc-4, asp.net-mvc-routing

具有域[http://mosaically.com](http://mosaically.com)和[http://mosaically.com/](http://mosaically.com/)的 ASP.NET MVC 4 网站都返回 200 OK 响应。出于 SEO 的原因，我希望 sosaically.com 使用斜线进行 301 重定向到 mosically.com/。在 MVC 4 中有什么方法可以做到这一点吗？我更愿意在 MVC 中执行此操作，而不是尝试使用 IIS。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T05:05:36.440

刚刚发现它做不到，即使你是查克·诺里斯说谷歌

[http://googlewebmastercentral.blogspot.com/2010/04/to-slash-or-not-to-slash.html](http://googlewebmastercentral.blogspot.com/2010/04/to-slash-or-not-to-slash.html)

“请放心，对于您的根 URL，example.com 等同于 example.com/，即使您是 Chuck Norris，也无法重定向。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:07:15.160

您可以使用[`Url Rewrite module`](http://www.iis.net/downloads/microsoft/url-rewrite)IIS 中的来完成此任务。这是一个[`nice step by step article`](http://blogs.iis.net/carlosag/archive/2010/03/31/seo-made-easy-with-iis-url-rewrite-2-0-seo-templates.aspx)说明如何启用它的说明。下面是示例重写规则在 web.config 中的样子：

```
<system.webServer> 
    <rewrite> 
        <rules> 
            <rule name="CanonicalHostNameRule1"> 
                <match url="(.*)" /> 
                <conditions> 
                    <add input="{HTTP_HOST}" pattern="^www\.mosaically\.com$" negate="true" /> 
                </conditions> 
                <action type="Redirect" url="http://www.mosaically.com/{R:1}" /> 
            </rule> 
        </rules> 
    </rewrite> 
</system.webServer> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T05:26:33.167

我认为你应该这样使用

在你 global.aspx

```
 protected void Application_BeginRequest()
        {
            string rudsiteurl = HttpContext.Current.Request.Url.AbsoluteUri;
            if (rudsiteurl.Contains("http://www.mosaically.com"))
            {
                Response.Status = "301 Moved Permanently";
                Response.AddHeader("Location", "http://www.mosaically.com/");
            }

        } 
```

我想这会帮助你...

# xslt - XSLT - 测试每个节点的条件，如果条件满足则中断测试

> ID：14674910
> 
> 赞同：2
> 
> 时间：2013-02-03T17:04:54.427
> 
> 标签：xslt, xslt-1.0

我希望为两种类型的情况返回 1 个输出。第一种情况必须循环通过节点以确定是否满足。这是 XML：

```
<in:inputs 
  xmlns:in="http://www.composite.net/ns/transformation/input/1.0">
   <in:result name="GetCart">
      <root xmlns="">
        <USC_Purchase ProductPrice="95.0000" 
                      PriceRuleID="1810" 
                      PurchaseQuantity="-1.00" 
                      PaymentNotRequiredQuantity="0.00" 
                      PaymentRequiredQuantity="-1.00" 
                      PaymentRequiredTotal="-95.000000" 
                      PurchaseStatus="R" 
                      RefundTotalAllowed="0.00">
          <USC_Product_PriceRule 
            PriceRuleID="1810" 
            PriceRuleName="Full Attendee" 
            PriceRulePriority="1" 
            PriceRuleStatus="A" 
            WebUserGroups="13CONF-M001" 
            ExcludeWebUserGroups="" 
            ProductPrice="95.0000" 
            ExternalCode="" 
            PercentOfProductCode="" 
            OptionID="0" 
            FriendlyName="Discounted Rate" 
            StartEndRestrictionID="0" 
            ClassID="0" 
            IsHidden="0"/>
        </USC_Purchase>
        <USC_Purchase ProductPrice="55.0000" 
                      PurchaseQuantity="-4.00" 
                      PaymentNotRequiredQuantity="0.00" 
                      PaymentRequiredQuantity="-4.00" 
                      PaymentRequiredTotal="-220.000000" 
                      PurchaseStatus="R" 
                      RefundTotalAllowed="568.00">
          <USC_Product_PriceRule/>
        </USC_Purchase> 
```

这是我未完成的 XSLT，它从第一个 USC_Purchase 节点开始：

```
 <xsl:choose>
      <xsl:when test="@PurchaseStatus='R' 
        and ($purchase_total*($purchase_total >=0)
           - $purchase_total*($purchase_total &lt; 0)) 
           > @RefundTotalAllowed">
       We are having issues processing your refund online. 
       Please contact us for assistance.
      </xsl:when>
      <xsl:otherwise>
        <!-- insert credit card form here -->
      </xsl:otherwise> 
```

这很好用……只有当第一个产品满足这些条件时。其他产品未经检查。xsl:choose 语句顶部的 for-each 循环将返回多条消息，以及信用卡表单（如果任何产品通过正常）。（咕噜！）

我的问题是 - 是否可以循环多个购买节点并在遇到单个案例时停止？

以下是步骤（以防我的解释让任何人失望）：

1.  在两个输出（错误消息和信用卡表格）之间进行选择。

2.  对于每个 USC_Purchase 节点，如果在任何节点上满足“X”条件，则显示单个错误消息。

3.  否则，显示信用卡表格。

如果需要更多信息，请告诉我。

*编辑*

当然，purchase_total 由所有 paymentrequiredtotals 的总和决定，所以：

```
<xsl:variable 
  name="purchase_total" 
  select="sum(USC_Purchase/@PaymentRequiredTotal)" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T17:57:08.603

好的，我想我终于明白你的要求了。由于其功能性质，XSLT 不倾向于使用“循环直到”逻辑（可以这样做，但当有其他方法可用时通常不使用）。相反，测试通常同时应用于所有可能的目标，以查看其中任何一个是否满足条件。我相信以下应该做你想做的事情：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes"/>

  <xsl:template match="root">
    <xsl:variable
      name="purchase_total"
      select="sum(USC_Purchase/@PaymentRequiredTotal)" />
    <xsl:variable
      name="purchase_total_abs"
      select="$purchase_total * (1 - 2 * ($purchase_total &lt; 0))" />

    <xsl:choose>
      <xsl:when test="USC_Purchase[@PurchaseStatus  ='R' and
                                   $purchase_total_abs > @RefundTotalAllowed]">
        We are having issues processing your refund online. Please contact us for assistance.
      </xsl:when>
      <xsl:otherwise>
        <xsl:call-template name="CreditCardForm" />
      </xsl:otherwise>
    </xsl:choose>
  </xsl:template>

  <xsl:template name="CreditCardForm">
    <!-- Credit form-->
  </xsl:template>
</xsl:stylesheet> 
```

为了使公式简短，首先`purchase_total`确定其绝对值，然后进行测试以查看是否有任何`USC_Purchase`s 与错误条件匹配。如果是，则显示错误消息，如果不是，则显示信用卡表格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:04:42.093

**这种稍短的转换`USC_Purchase`会根据需要处理每个元素——结果清楚地表明了这一点**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

  <xsl:variable name="vTotalPaymentRequired"
   select="sum(/*/*/root/USC_Purchase/@PaymentRequiredTotal)"/>

 <xsl:template match="USC_Purchase">
  Purchase <xsl:value-of select="position()"/>
   <xsl:choose>
    <xsl:when test=
     "@PurchaseStatus  ='R'
    and not(@RefundTotalAllowed + $vTotalPaymentRequired >= 0)">
         <xsl:text>
          We are having issues processing your refund online.
         </xsl:text>
         <xsl:text> Please contact us for assistance.</xsl:text>
    </xsl:when>
    <xsl:otherwise>
     Credit Form displayed here
    </xsl:otherwise>
   </xsl:choose>
 </xsl:template>
 <xsl:template match="USC_Product_PriceRule"/>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<in:inputs
  xmlns:in="http://www.composite.net/ns/transformation/input/1.0">
   <in:result name="GetCart">
      <root xmlns="">
        <USC_Purchase ProductPrice="95.0000"
                      PriceRuleID="1810"
                      PurchaseQuantity="-1.00"
                      PaymentNotRequiredQuantity="0.00"
                      PaymentRequiredQuantity="-1.00"
                      PaymentRequiredTotal="-95.000000"
                      PurchaseStatus="R"
                      RefundTotalAllowed="0.00">
          <USC_Product_PriceRule
            PriceRuleID="1810"
            PriceRuleName="Full Attendee"
            PriceRulePriority="1"
            PriceRuleStatus="A"
            WebUserGroups="13CONF-M001"
            ExcludeWebUserGroups=""
            ProductPrice="95.0000"
            ExternalCode=""
            PercentOfProductCode=""
            OptionID="0"
            FriendlyName="Discounted Rate"
            StartEndRestrictionID="0"
            ClassID="0"
            IsHidden="0"/>
        </USC_Purchase>
        <USC_Purchase ProductPrice="55.0000"
                      PurchaseQuantity="-4.00"
                      PaymentNotRequiredQuantity="0.00"
                      PaymentRequiredQuantity="-4.00"
                      PaymentRequiredTotal="-220.000000"
                      PurchaseStatus="R"
                      RefundTotalAllowed="568.00">
          <USC_Product_PriceRule/>
        </USC_Purchase>
    </root>
  </in:result>
</in:inputs> 
```

**产生了想要的正确结果：**

```
 Purchase 1
          We are having issues processing your refund online.
          Please contact us for assistance.
  Purchase 2
     Credit Form displayed here 
```

# parsing - 为什么有 LR(0) 解析器而没有 LL(0) 解析器？

> ID：14674912
> 
> 赞同：20
> 
> 时间：2013-02-03T17:04:58.467
> 
> 标签：parsing, compiler-construction, lr, ll

我一直在 Wikipedia 中阅读这两个内容，并注意到尽管存在 LR(0) 解析器，但没有 LL(0) 解析器之类的东西。

从我读到的内容，我了解到 LL(k)/LR(k) 中的 k 表示解析器可以在当前正在处理的当前字符**之外看到多少个字符。**

所以我的问题是，为什么没有 LL(0) 解析器之类的东西，即使 LR(0) 存在？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-02-03T18:49:27.407

差异与 LR(k) 与 LL(k) 中 k 的含义有关。

在 LL(k) 中，解析器维护有关自上而下、从左到右的解析的信息，该解析追踪最左边的推导。解析器通过反复查看当前的非终结符来工作，然后检查输入流的下 k 个标记以确定应该使用哪个产生式。因此，如果您有一个 LL(0) 解析器，则解析器必须完全根据当前的非终结符来预测要使用的产生式。这只有在每个非终结符只有一个与之关联的产生式时才有可能，这意味着语法要么只产生一个字符串，要么根本不产生字符串（通过进入循环）。因此，虽然它在数学上是明确定义的，但在实践中从未使用过 LL(0) 解析。

在 LR(k) 中，解析器自下而上工作。它维护一堆符号以及当前的“状态”，然后不断地决定是执行*移位*（将另一个符号推到堆栈顶部）还是*减少*（从堆栈中弹出一些符号并应用产生式）相反）。LL(k) 和 LR(k) 解析器之间的一个关键区别是 LR(k) 解析器如何决定执行哪个操作。在 LR(k) 解析器中，基于前瞻的下 k 个标记和**解析器的当前状态来决定下一步做什么。**因此，即使 LR(0) 解析器看不到任何前瞻标记，它仍然可以对要执行的操作做出一些明智的决定，因为解析器的当前状态可以编码大量关于在生产中何处执行的信息。解析器是以及它可以实际期望看到的下一个输入标记（即使解析器不能直接查看这些标记）。

简而言之，LL(0) 非常弱，因为解析器必须完全基于当前的非终结符来做出决定，这意味着它不能根据可能使用的产生式采取许多不同的动作之一。LR(0) 解析器非常强大，因为解析器的选择基于其内部状态，内部状态通常足够详细，可以让解析器就下一步做什么做出明智的决定。

LL(0) 弱而 LR(0) 相当强大还有另一个原因。在 LL(0) 解析器中，解析器必须立即决定应该执行哪些产生式，这意味着解析器必须完全盲目地猜测产生式。在 LR(0) 解析器中，解析器可以在决定减少时间之前移动多个符号。因此，解析器在没有任何前瞻的情况下，可以推迟决定使用哪种归约​​，直到它看到足够的输入标记以了解字符串的结构。这是任何 LL(k) 文法自动为 LR(k) 的更普遍事实的特例。

希望这可以帮助！

# php - 如何在 Apache (Windows) 中保护我的 PHP 应用程序文件夹？

> ID：14674913
> 
> 赞同：1
> 
> 时间：2013-02-03T17:05:11.207
> 
> 标签：php, windows, apache, passwords

我的 PHP 应用程序将在 Windows（XP 或 7）中的 Apache 上运行，但最初用户将在同一台机器上使用它。

这意味着源代码将在用户触手可及的地方。

如何限制对文件夹和**非编译**PHP 文件的访问？有没有办法简单地用**密码保护**这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:16:26.180

根据Pekka 웃</a> 的建议，我使用[LAMP](http://en.wikipedia.org/wiki/LAMP_%28software_bundle%29)[设置了一个](https://stackoverflow.com/questions/14674913/how-can-i-protect-my-php-application-folder-in-apache-windows/14792216#comment20514414_14674913)[虚拟机](https://www.virtualbox.org)。实际上，我下载了一个已经从[VirtualBoxImages.com](http://virtualboximages.com/Ubuntu+12.04+i386+Lamp+Tomcat+Server+Virtual+Computer)制作的，并根据我的需要进行了调整（我什至能够设置一个与[DropBox](https://www.dropbox.com/install?os=lnx)同步的[crontab](https://help.ubuntu.com/community/CronHowto)的[MySQL](http://blog.winhost.com/using-mysqldump-to-backup-and-restore-your-mysql-databasetables/)备份，太酷了）。

现在客户端需要做的就是运行虚拟机来启动我的 PHP 应用程序。然后，他和同一网络中的每个人都可以通过在 URL 字段中键入虚拟机名称来访问应用程序（以及[数据库](http://www.phpmyadmin.net/home_page/downloads.php)）——这要归功于为虚拟机启用了两个网络适配器（[网桥和仅主机](https://askubuntu.com/questions/113604/how-to-run-virtualbox-on-bridged-and-host-only-networks)）。[另外，我可以使用WinSCP](http://sourceforge.net/projects/winscp/)远程维护应用程序。

现在我得到了我的要求：我的 PHP 应用程序在 Apache 上运行。它在 Linux 的 Ubuntu 机器内，但它可移植到 Windows XP/7 内：与客户端在同一台机器上，**未编译的**PHP 文件由虚拟机用户帐户**密码保护。**

这比我预期的要好得多，轻松！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:14:46.663

我知道只有一种方法，可以做你想做的事。第一部分是右键单击您的 htdocs 文件夹并单击“属性”，下一部分是转到“安全”选项卡。单击编辑按钮。接下来给自己该文件夹的所有权限，如果其他用户是管理员，则删除管理员的权限。最后一部分是单击“添加”按钮并输入“用户”。然后，您将能够为机器上的所有用户编辑此文件夹的权限。我会删除所有内容，这样他们就无法对您的文件夹做任何事情。

注意：因为您允许您自己，所有权限，“用户”权限不适用于您。

# php - 正则表达式从右到左读取

> ID：14674915
> 
> 赞同：1
> 
> 时间：2013-02-03T17:05:35.010
> 
> 标签：php, regex

我想从右到左读取字符串。例如，我想`50940775`从`$game`下面的代码中获取。

我提到了另一个stackoverflow问题。他们说要使用`$`，但它对我不起作用。我使用下面的代码。

```
$game = 'http://www.myspace.com/sdsf/1223232/videos/video/50940775black';

preg_match('/\/(.*?)black$/', $game, $match);
print_r($match[1]); 
```

注意：`$game Url`与下面的不同

```
http://www.myspace.com/sdsf/1223232/black/video/50940775black
http://www.myspace.com/sdsf/1223232/videos/12345/50940775black
http://www.myspace.com/sdsf/1223232/videos/games129kj/5675999black 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:09:35.947

由于您想获取数字，您可以指定只需要它们 ( `[0-9]+`) 而不是所有东西 ( `.*`)。使用`.*`它将检索第一个`/`找到的 和之间的所有内容`black`。所以，在你的情况下：`/www.myspace.com/sdsf/1223232/videos/video/50940775black`

试试这个：

```
$game = 'http://www.myspace.com/sdsf/1223232/videos/video/50940775black';

preg_match('/\/([0-9]+)black$/', $game, $match);
print_r($match[1]); 
```

[现场演示](http://codepad.viper-7.com/LqTvYu)。

**编辑：**

事实上，很难从右到左阅读。您可以做的是分解网址`/`，然后使用最后一部分应用您的正则表达式：

```
<?php

$game = explode('/', 'http://www.myspace.com/sdsf/1223232/videos/video/50940775black');
$data = end($game);

preg_match('/(.*?)black$/', $data, $match);
print_r($match[1]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T17:29:42.383

尝试这样的事情：

```
$game = 'http://www.myspace.com/sdsf/1223232/videos/video/50940775black';
preg_match('/\/([^\/]+)black$/', $game, $match);
print_r($match[1]); 
```

为什么以前不工作？这与贪婪的本性有关。非贪婪运算符不会导致正则表达式在字符串中找到最短的匹配项。它找到不包含任何其他匹配项的*第一个匹配项。*如果您使用它找到的匹配项并开始回溯，您将永远不会从它找到的匹配项的开头找到另一个与该字符串匹配的子字符串**first**。这是一个微妙的区别。

在写这篇文章时，我看到有人建议只寻找数字。只要您确定只有数字，这也将起作用。如果您的目的是获取最接近的`/`和之间的任何内容`black`，那么正则表达式正是针对该目标的。

# selenium-webdriver - 使用 Selenium WebDriver 播放 JWplayer 测试的电视频道

> ID：14674916
> 
> 赞同：0
> 
> 时间：2013-02-03T17:05:35.380
> 
> 标签：selenium-webdriver

我需要自动化播放网络应用程序 http:\wherever.tv 的电视频道，以测试频道是成功播放还是播放失败。我有用于频道播放的**Selenium IDE 脚本**。如果频道无法播放，我该如何处理。Channel 使用`jwplayer`.How 如何显示 JWPlayer 的 Channel 失败消息。

下面是播放频道的代码。

```
 public class Untitled {
    private WebDriver driver;
    private String baseUrl;
    private boolean acceptNextAlert = true;
    private StringBuffer verificationErrors = new StringBuffer();

    @Before
    public void setUp() throws Exception {
    driver = new FirefoxDriver();
    baseUrl = "http://wherever.tv/";
    driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
    }

    @Test
    public void testUntitled() throws Exception {
    driver.get(baseUrl + "/index2.jsf");
    driver.findElement(By.linkText("SIGN IN")).click();
    driver.findElement(By.id("login:txtUserName")).clear();
    driver.findElement(By.id("login:txtUserName")).sendKeys("testm1");
    driver.findElement(By.id("login:txtPassword")).clear();
    driver.findElement(By.id("login:txtPassword")).sendKeys("111111");
    driver.findElement(By.id("login:cmbSumbit")).click();
    driver.findElement(By.xpath("(//img[@title='(On Air) Play - This channel will work on     TV'])[7]")).click();
    driver.findElement(By.xpath("(//img[@title='(On Air) Play - This channel will NOT work   on TV'])[4]")).click();
  }

    @After
    public void tearDown() throws Exception {
    driver.quit();
    String verificationErrorString = verificationErrors.toString();
    if (!"".equals(verificationErrorString)) {
      fail(verificationErrorString);
     }
    }

    private boolean isElementPresent(By by) {
    try {
      driver.findElement(by);
      return true;
    } catch (NoSuchElementException e) {
      return false;
    }
    }

    private String closeAlertAndGetItsText() {
    try {
      Alert alert = driver.switchTo().alert();
      if (acceptNextAlert) {
        alert.accept();
      } else {
        alert.dismiss();
      }
      return alert.getText();
    } finally {
      acceptNextAlert = true;
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-18T07:03:03.807

根据您的问题，我假设您需要一种方法来显示或查找是否显示错误消息。如果是这种情况，您需要使用 Assert 语句

以下语句是单击错误代码。

```
 driver.findElement(By.xpath("(//img[@title='(On Air) Play - This channel will NOT work   on TV'])[4]")).click(); 
```

为此，您可以使用 assert() 作为 Assert.assertEquals() 或任何其他适当的 assert() 来比较此值。

exg

```
String expMsg  "'(On Air) Play - This channel will NOT work   on TV'";
Assert.assertEquals(expMsg,driver.findElement(By.xpath("(//img[@title='(On Air) Play - This channel will NOT work   on TV'])[4]")).getText(); 
```

更正确的 xpath 将帮助您识别通过和失败状态。

# delphi - “使用调试 DCU”的编译器选项？

> ID：14674919
> 
> 赞同：4
> 
> 时间：2013-02-03T17:05:56.720
> 
> 标签：delphi, compiler-options

在我正在编写的组件中，我想包括[注册图像格式的自动检测，但它是一种仅在禁用](https://stackoverflow.com/a/4430735/757830)*使用调试 DCU 的*编译器选项时才有效的解决方案。

我*真正*想知道的是这个解决方案的替代方案，它不涉及编译器选项依赖。

但就目前而言，我只想知道如何在运行时检查是否设置了*Use Debug DCU 的*编译器选项。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T20:59:44.100

# 没有可靠的方法在运行时获取该信息

`Use Debug DCUs`编译器选项只切换搜索路径；编译器最终会发现什么是未知的。（被误导的）用户可能已将 Release dcu 复制到调试目录中，反之亦然。

即使没有错误的用户，也可能会将一些文件添加到项目中（并与项目一起编译）以包含一些错误修复。例如，如果用户已`Graphics.pas`添加到项目中，进行了发布/无调试构建，但保留了`Use Debug DCU's`编译器选项，那么`Graphics.dcu`实际链接的不是调试构建，因为它是使用可执行文件重新构建的。因此，您会得到一个“混合”的调试和非调试 dcus 包。

您可以尝试检测是否存在与某些对象或方法相关的调试信息，但这也是不可靠的：如果您使用“Build with Debug Dcus”，然后将“Debug Information”设置为 false，那么您实际上是在丢弃调试信息，因此您无法再查找它。

# 但是该链接代码在调试 DCU 上失败

来自 GLScene 项目的代码不是一个好的 hack，它使用硬编码的偏移量到代码中`TPicture.RegisterFileFormat`，然后继续使用硬编码的偏移量来获取全局`FileFormats`变量的地址（不调用`GetFileFormats`例程）。里面有太多神奇的数字！

我的第一个想法是`TList`将使用该方法识别的`GLScene`方法与`TList`我识别的方法进行比较，但猜猜看：*在我的机器*上没有问题，两个例程在两种情况下都得到了相同的结果。在我的机器上`GLScene`，尽管它很丑，但调试 DCU 并没有破坏它。

我什至尝试过“指纹识别”一些 rtl/vcl 单元（SysUtils、Graphics、Classes）；我列出了所有公共类，为每个类中的每个方法生成了一些使用 RTTI 的代码，并将代码的前 1024 个字节转储到字符串文件中。使用调试 DCU 和非调试 DCU 运行该程序，*我得到了相同的结果*。我的文本文件包含大约 3500 种方法的指纹！

# 不是个好主意

由于该选项不会真正影响编译器的编译方式（仅影响链接器链接的内容），因此创建依赖于该选项的代码非常不可靠，也不是一个好主意。**这只会影响低级黑客攻击**，并且您不希望在您完全无法控制的情况下可能会导致应用程序崩溃的低级黑客攻击。

唯一真正的选择是用不会失败（或至少以可控方式失败）的黑客替换可能失败的黑客。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T19:21:16.313

正如[Ken 评论](https://stackoverflow.com/users/62576/ken-white)的那样，可能无法检测此编译器选项所涉及的路径更改。命令行编译器[文档](http://docwiki.embarcadero.com/RADStudio/XE3/en/DCC32.EXE,_the_Delphi_Command_Line_Compiler)没有提到编译器开关，因此意味着它根本不存在。如果没有编译器开关，则无法检查是否设置了该编译器选项

* * *

> ...但该解决方案仅在禁用*使用调试 DCU 的*编译器选项时才有效。

If *only works*意味着它会导致异常，那么您可以使用以下替代方法：

```
try
  // AutoDetectRegisteredImageFormats
except
  // Handle case when Use Debug DCU's is on
end; 
```

# linq - 如何在linq中获取最后一行计数值

> ID：14674920
> 
> 赞同：0
> 
> 时间：2013-02-03T17:05:59.423
> 
> 标签：linq, entity-framework

是否可以在不使用 linq 查询数据库的情况下获取最后一行计数值？

我有一个场景，我进行 linq 查询以查找一些记录并计数，但是当我第二次使用 linq 查询时，我希望计数最后影响的行而不查询数据库

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T17:14:42.777

您可以通过多种方式实现结果：

1.  将结果计数存储到变量中并仅在一定时间后重新计算
2.  将结果计数存储到缓存中（请参阅企业库）
3.  将结果计数存储到表中，并使用表上的触发器重新计算计数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T13:27:20.123

如果我理解你是正确的 - 你想要非查询语句影响的行数吗？更新、插入、删除（读取查询不影响行）

调用`context.SaveChanges()`返回受影响的行数。 `context`是您的 EntityModel 的一个实例

# javascript - Javascript - 告诉网页上尚未实现的图像的宽度/高度

> ID：14674929
> 
> 赞同：0
> 
> 时间：2013-02-03T17:06:45.447
> 
> 标签：javascript, jquery, image, height, width

> **可能重复：**
> [Javascript - 从 url 返回远程图像的宽度/高度的函数](https://stackoverflow.com/questions/11442712/javascript-function-to-return-width-height-of-remote-image-from-url)

是否可以通过js知道图像位置来获得宽度和高度？实际图片并未加载到 DOM 上。我一直在用 jQuery 尝试这个，但还没有运气。

```
var img = $('<img>').attr('src', 'images/logo.png');
console.log($(img).width()); 
```

返回 0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T17:24:33.260

不，图像不需要在 DOM 中。

```
var img = new Image();
img.onload = function(){
        console.log(this.width);
    };
img.src="images/logo.png"; 
```

但是你必须在知道它的尺寸之前加载它

（注意 onload 函数后面的 src）

这是一个jsfiddle：http: [//jsfiddle.net/fGUyz/2/](http://jsfiddle.net/fGUyz/2/)

#NotMrDownVoter

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T17:12:11.680

不幸的是，图像必须在 DOM 中才能计算出宽度/高度。

您可以通过将其附加到页面来作弊，但将其放置在远离屏幕的位置，如下所示：

```
.offscreen {
    position: absolute;
    left: -9999px;
} 
```

```
var $img = $('<img>', {
    'src': 'images/logo.png',
    'class': 'offscreen'
}).appendTo('body');
console.log($img.width());
$img.remove() // if required... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T17:27:17.290

不幸的是，正如 Rory McCrossan 已经建议的那样，在使用 JQuery 时，您必须在**任何**width() 或 height() 函数返回 0 以外的任何值之前将元素添加到 DOM。

具有隐藏元素也将返回 0 的宽度/高度。

# jquery - jQuery Masonry：像 Beyonce 的网站一样自动调整照片大小

> ID：14674930
> 
> 赞同：3
> 
> 时间：2013-02-03T17:06:57.320
> 
> 标签：jquery, photo, jquery-masonry, photo-gallery

jQuery Masonry 的网站在其展示中包括 Beyonce 的网站：

[http://iam.beyonce.com](http://iam.beyonce.com)

但这并没有显示她是如何实现自动调整大小的效果的。[我通过 prettifier 运行了她的代码](http://closure-compiler.appspot.com/code/jscf552bde8eeb640ef46e81af8c6715526/default.js)，但它看起来仍然很乱：

```
function resize() {
  1024 < $(window).width() ? 0 == headerNavOpen && $("#header").css({left:-$(window).width()}) : 0 == headerNavOpen && $("#header").css({left:-1024});
  $(".index .post.video").css({width:"33.2%", height:0.332 * $("#container").width() / 1.778})
} 
```

有人知道实现相同效果的更简单方法吗？

这是一个基本设置的小提琴：http: [//jsfiddle.net/CfsEb/](http://jsfiddle.net/CfsEb/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-03T20:29:11.123

见[http://metafizzy.co/blog/beyonce-seamless-fluid-image-masonry/](http://metafizzy.co/blog/beyonce-seamless-fluid-image-masonry/)

> 设计记忆想出了一个更好的解决方案。与其试图在布局中精确地获得 3 列，不如将列的大小调整为小于理想值的一小部分。然后图像的大小会稍微大一点以覆盖间隙。杰出的！

```
/* not quite 33.3% */
.item { width: 33.2%; }

/* images cover up the gap */
.item img { width: 100.5%; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T17:32:12.470

他们所做的实际上是非常基本的，他们使用现有的框架进行定位，如果屏幕小于 1024，那么他们会交换一些 CSS 来控制百分比宽度。所以看看发布的代码......

```
// Short Hand Version   
 function resize() {
      1024 < $(window).width() ? 0 == headerNavOpen && $("#header").css({left:-$(window).width()}) : 0 == headerNavOpen && $("#header").css({left:-1024});
      $(".index .post.video").css({width:"33.2%", height:0.332 * $("#container").width() / 1.778})
    }

// In more plain script
if ($(window).width() > 1024) {
   0 == headerNavOpen; 
   $("#header").css({left:-$(window).width()});
} else {
   0 == headerNavOpen;
   $("#header").css({left:-1024});

   // This is the actual part that reduces image sizes dynamically.
   $(".index .post.video").css({width:"33.2%", height:0.332 * $("#container").width() / 1.778})
} 
```

所以上面的代码做了两件事，调整导航和调整个别的“帖子”。这与 jQuery 正在执行的 DOM 操作完全分开——可以将其视为对它的捎带。但是，对于较小的屏幕，它只能以这种方式表现。因此，如果您希望它**始终**以这种方式运行，您可以简单地将一个类添加到您的 dom 元素中，并使用 % 来实现您所追求的。否则你可以像上面的代码一样做一个窗口检查，只是省略你不需要的部分。

# mysql - 带 OUT 参数的简单 Mysql 存储过程

> ID：14674936
> 
> 赞同：0
> 
> 时间：2013-02-03T17:07:20.063
> 
> 标签：mysql, stored-procedures

这是我的存储过程：

```
DELIMITER $$

CREATE PROCEDURE UserNameExists (IN pUserName VARCHAR(40), OUT rVal BIT)  
LANGUAGE SQL  
DETERMINISTIC  
BEGIN  
    SET @recCount := (SELECT COUNT(*) FROM Users WHERE userName = pUserName);
    IF @recCount > 0 THEN 
        SET rVal := 1;
    ELSE 
        SET rVal := 0;
    END IF;    
END $$

DELIMITER ; 
```

我是这样称呼它的：

```
USE MyDatabase;

CALL UserNameExists('sampleUser', @outputParam);

Select @outputParam; 
```

结果我得到一个空行，这里缺少什么？

# asp-classic - ASP Classic 将 byte[] Request.BinaryRead 放入数据库

> ID：14674940
> 
> 赞同：1
> 
> 时间：2013-02-03T17:07:42.667
> 
> 标签：asp-classic, vbscript

让我首先说我对此很陌生，如果很明显我几天来一直在寻找答案，我很抱歉！

我正在尝试将 byte[] 插入到我的数据库中的 varbinary 中，但遇到了一堵砖墙，所以我希望有人能提供帮助。到目前为止，我有：

```
Dim biData, matchId
Dim sConnString, connection, recordset, sql, count

biData = Request.BinaryRead(Request.TotalBytes)
matchId = Request.ServerVariables("QUERY_STRING")

sql = "SELECT * FROM MatchData WHERE matchId= '" & matchId & "'"

'define the connection string, specify database
'driver and the location of database
sConnString="Driver={SQL Server};<CONNECTIONSTRING>"

Set connection = Server.CreateObject("ADODB.Connection")
Set recordset = Server.CreateObject("ADODB.Recordset") 

'Open the connection to the database
connection.Open(sConnString)

'Open the recordset object executing the SQL 
recordset.Open sql, connection,3,3

count=recordset.recordcount

If count > 0 Then
    response.Write("Found  ")
    recordset.Update "MatchId", matchId

    'MY PROBLEM IS HERE
    'recordset.Update "MatchData", biData
    'recordset.Fields("MatchData").AppendChunk biData
Else
    response.Write("Not Found  ")
    recordset.AddNew "MatchId", matchId

    'MY PROBLEM IS ALSO HERE
    'recordset.Update "MatchData", biData       
    'recordset.Fields("MatchData").AppendChunk(biData)
End If

recordset.Close
Set recordset=Nothing

'Done. Close the connection object
connection.Close
Set connection = Nothing 
```

如果我只返回biData，那么我会看到我上传的确切字节[]，所以我猜它在那里，即response.BinaryWrite biData

提前感谢您的任何答案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T04:12:15.590

You need to append the binary (chunks) in a loop:

Check this page: [http://msdn.microsoft.com/en-us/library/windows/desktop/ms678200(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms678200(v=vs.85).aspx)

Paricularly this part of the code for how to do it:

```
Cnxn.Execute "INSERT publishers(pub_id, pub_name) VALUES('" & _
               strPubID & "','Your Test Publisher')"

' Add a new record, copying the logo in chunks
rstPubInfo.AddNew
rstPubInfo!pub_id = strPubID
rstPubInfo!pr_info = strPRInfo

lngOffset = 0 ' Reset offset
Do While lngOffset < lngLogoSize
    varChunk = LeftB(RightB(varLogo, lngLogoSize - lngOffset), _
        conChunkSize)
    rstPubInfo!logo.AppendChunk varChunk
    lngOffset = lngOffset + conChunkSize
Loop
rstPubInfo.Update 
```

# wordpress - wordpress 3.5 媒体管理器 - 添加我自己的backbone.js 视图

> ID：14674948
> 
> 赞同：9
> 
> 时间：2013-02-03T17:08:25.257
> 
> 标签：wordpress, backbone.js, backbone-views, wordpress-3.5

我目前正在尝试使用新的 WordPress 3.5 媒体管理器，它使用主干.js 来创建和填充其模式窗口。

我想要做的是：用户单击上传按钮，弹出媒体管理器，用户选择图像，按插入，然后将图像保存到自定义字段。

所有这些都已经奏效了，我唯一想改变的是用我自己的模板填充媒体上传器的侧边栏（用户可以添加标题、标题、选择大小等）。

我已经阅读了数十篇关于如何使用骨干网的教程，但现在有点卡住了。到目前为止，这是我的一些代码：

```
//defined earlier:
var frame;

//on click:

if ( file_frame )
{
    file_frame.open();
    return;
}
else
{
    // Create the media frame.
    file_frame  = wp.media(
    {
    frame:   'select',
    state:   'mystate',
    library:   {type: 'image'},
    multiple:   false
    });

    file_frame.states.add([

    new media.controller.Library({
        id:         'mystate',
        title: 'my title',
        priority:   20,
        toolbar:    'select',
        filterable: 'uploaded',
        library:    media.query( file_frame.options.library ),
        multiple:   file_frame.options.multiple ? 'reset' : false,
        editable:   true,
        displayUserSettings: false,
        displaySettings: true,
        allowLocalEdits: true,
          //AttachmentView: ?

    }),
    ]);

file_frame.open();

} 
```

我也尝试过像这样注册自己的模板：

```
media.view.Attachment.mySidebar = media.view.Settings.AttachmentDisplay.extend(
{
    className: 'attachment-display-settings',
    template:  media.template('avia-choose-size')
}); 
```

但问题是：我不知道只加载这个模板而不是原始侧边栏。将它作为 AttachmentView 参数传递显然不起作用，因为它替换了整个模板而不仅仅是侧边栏。

有一些backbone.js 经验的人可以提供帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-19T20:41:27.700

我不确定您是否找到了问题的答案，但我想让您知道，我只需修复对不以“wp”为前缀的“媒体”对象的引用，就可以为我工作上述代码。所以...您的新自定义状态代码应如下所示：

```
file_frame.states.add([

new wp.media.controller.Library({
    id:         'mystate',
    title: 'my title',
    priority:   20,
    toolbar:    'select',
    filterable: 'uploaded',
    library:    wp.media.query( file_frame.options.library ),
    multiple:   file_frame.options.multiple ? 'reset' : false,
    editable:   true,
    displayUserSettings: false,
    displaySettings: true,
    allowLocalEdits: true,
      //AttachmentView: ?

}),
]); 
```

我个人想替换“选择”框架的初始默认状态，这是通过添加`states : 'mystate'`到 file_frame 选项来实现的，导致初始化返回而不创建默认的“选择”状态。然后按照您的演示继续创建“mystate”（对象语法有两个小的变化）。

我感谢您在此处引入方法论！它工作得很好，我之前完全迷失和沮丧。

# mysql - MySQL查询三个表

> ID：14674949
> 
> 赞同：4
> 
> 时间：2013-02-03T17:08:25.943
> 
> 标签：mysql, sql, join

我有三张桌子，上面有人物、属性和属性的潜在价值。我想不出一个查询来显示所有人、每个人的属性及其缺失/空属性。

这是一个示例表...

```
attributes
+---------------------+
| attribute_name (col)|
+---------------------+
| name                |
+---------------------+
| age                 |
+---------------------+
| gender              |
+---------------------+
| email               |
+---------------------+

people
+-----------+----------+
| person_id | value_id |
+-----------+----------+
| 2         | 7        |
+-----------+----------+
| 2         | 9        |
+-----------+----------+
| 3         | 8        |
+-----------+----------+

values
+---------------+----------------+-------+
| value_id (pk) | attribute_name | value |
+---------------+----------------+-------+
| 7             | age            | 35    |
+---------------+----------------+-------+
| 8             | age            | 28    |
+---------------+----------------+-------+
| 9             | gender         | male  |
+---------------+----------------+-------+ 
```

如何加入三个表以显示这样的内容？

```
+-----------+----------+-----------------+--------+
| person_id | value_id | attribute_name  | value  |
+-----------+----------+-----------------+--------+
| 2         | 7        | age             | 35     |
+-----------+----------+-----------------+--------+
| 2         | 9        | gender          | male   |
+-----------+----------+-----------------+--------+
| 2         | NULL     | name            | NULL   |
+-----------+----------+-----------------+--------+
| 2         | NULL     | email           | NULL   |
+-----------+----------+-----------------+--------+
| 3         | 8        | age             | 28     |
+-----------+----------+-----------------+--------+
| 3         | NULL     | gender          | NULL   |
+-----------+----------+-----------------+--------+
| 3         | NULL     | name            | NULL   |
+-----------+----------+-----------------+--------+
| 3         | NULL     | email           | NULL   |
+-----------+----------+-----------------+--------+ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T17:24:55.253

```
SELECT  a.person_ID, 
        MAX(c.value_ID) value_ID, 
        b.attribute_name ,  
        MAX(c.value) Value
FROM    people a
        CROSS JOIN attributes b       
        LEFT JOIN `values` c
            ON  a.value_ID = c.value_ID AND
                b.attribute_name = c.attribute_name
GROUP BY a.person_ID, b.attribute_name 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/e5640/14)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:11:53.813

我会使用 WHERE 语句（SQL 基础知识）连接三个表。

发帖前有搜索过吗？

对于 null，有这篇文章[MySQL Show Null Results in Query - With INNER JOIN](https://stackoverflow.com/questions/8014631/mysql-show-null-results-in-query-with-inner-join)或这个[Mysql join 四张表并显示 NULL 值](https://stackoverflow.com/questions/8011171/mysql-join-four-table-and-show-null-value)

;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T17:15:49.857

```
select
    person_id,
    attributes.attribute_name as attribute_name,
    values.value as value
from people
cross join attributes
left join values on people.value_id=values.value_id
                and attributes.attribute_name=values.attribute_name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T18:27:18.910

使用您的预期输出作为起点，您基本上希望将属性和不同人员的叉积`people`从左连接到 to 的（n 内）连接的`people`结果`values`。这就是您可以在 SQL 中编写脚本的方式（尤其是在 MySQL 中）：

```
SELECT
  p.person_id,
  v.value_id,
  a.attribute_name,
  v.value
FROM 
  (SELECT DISTINCT person_id FROM people) p
  CROSS JOIN attributes a
  LEFT JOIN
    people d
    INNER JOIN `values` v ON d.value_id = v.value_id
  ON p.person_id = d.person_id
  AND a.attribute_name = v.attribute_name
; 
```

# regex - 用重组的文本索引语法替换乳胶索引语法

> ID：14674952
> 
> 赞同：1
> 
> 时间：2013-02-03T17:08:39.810
> 
> 标签：regex, latex, restructuredtext, pandoc

我正在使用 Pandoc 将文档从 LaTeX (XeTeX) 转换为 ReStructuredText。文档有大量索引条目，Pandoc 不处理索引。当 Pandoc 转换时，索引条目被删除，只留下条目的文本。因此，我需要一种将索引条目转换为 LaTeX 文件中的 ReST 语法的方法，然后 Pandoc 在转换时将它们剥离。在我的测试中，这种工作方式：Pandoc 保留了索引条目，但避开了反引号。我可以把那些去掉。这是我手动执行时的外观：

```
\index{Some index item}    # The LaTex entry
:index:`Some index item`   # Modified for ReST format (still in the LaTeX file)
:index:\`Some index item\` # Result after Pandoc conversion to ReST 
```

我可以在最终的 ReST 文件中用正确的反引号替换最终的转义反引号。我似乎无法弄清楚如何为 LaTeX 文件中的替换创建一个可行的方法（Regex？）。非常欢迎提出建议（包括有关完成整个制作的更好方法的建议）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:09:17.570

您似乎正在寻找与以下正则表达式匹配的条目

```
^\\index\{([^}]*)\} 
```

和

```
:index:`$1` 
```

where`$1`是对正则表达式的捕获组的引用`([^}]*)`。

例如，您可以使用 shell 脚本或在文本编辑器中手动执行此过程。

请注意，上面的正则表达式`}`假定`{}`.

# android - 检测区域内的电话

> ID：14674954
> 
> 赞同：2
> 
> 时间：2013-02-03T17:08:51.980
> 
> 标签：android, geolocation

我需要检测我的手机（android）是否进入了地图上的特定区域——该区域约为 300m x 300m。

一旦我确定了电话的位置，我就可以进行数学计算（这似乎很容易！），我只是不确定跟随电话并获得定期更新的最佳策略是什么。这是我到目前为止所拥有的：

一个 AlarmManager 每（当前） 1 分钟启动一次……我将把它增加到大约 10 分钟或更多。AlarmManager 检查是否可以从任何提供商（GPS 或 NETWORK）处获得 15 分钟以内的位置。

我有这个：

```
criteria.setAccuracy(Criteria.ACCURACY_COARSE);
criteria.setPowerRequirement(Criteria.POWER_LOW); 
```

...这很可能会选择 NETWORK 提供商，不是吗？目前这似乎不太精确，它目前正在将我的手机放在半路。

这*可能*是错误的策略。在 300m x 300m 区域内有 Wifi 接入点和蓝牙点 - 我可以使用这些来检测手机在附近吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:53:27.550

您应该为此使用[ProximityAlert 。](http://developer.android.com/reference/android/location/LocationManager.html#addProximityAlert%28double,%20double,%20float,%20long,%20android.app.PendingIntent%29)

它允许您定义地图上的位置（纬度和经度）和半径。如果您进入或退出定义的区域，则会发送一个意图。你可以捕捉到这个意图并在你的应用程序中使用它。

# ios - iOS - 如何在 iCloud 上移动文件时处理现有文件（通过 setUbiquitous :)

> ID：14674955
> 
> 赞同：2
> 
> 时间：2013-02-03T17:08:51.010
> 
> 标签：ios, icloud, nsfilemanager

`setUbiquitous:`当用户刚刚在我的应用程序中启用 iCloud 时，我正在努力寻找正确的方法来将本地文件移动到 iCloud。麻烦的是，*当 iCloud 上已经存在具有相同名称和路径的文档时，此方法会失败。*

到目前为止，我发现有些人提倡使用唯一的文件名来执行上传，但这对我来说听起来不对，因为这意味着任何禁用 iCloud 然后在我的应用程序中重新启用它的人都会拥有他们所有的两个版本文件。

我也了解在文件位于 iCloud 之后管理版本冲突，但我不能在这里使用它，因为调用`setUbiquitous:`必须在任何开始之前发生。

请帮助我了解如何处理此问题。[我在 iOS iCloud 设计指南 ( https://developer.apple.com/library/ios/#documentation/General/Conceptual/iCloudDesignGuide/Chapters/Introduction.html](https://developer.apple.com/library/ios/#documentation/General/Conceptual/iCloudDesignGuide/Chapters/Introduction.html) )中找不到答案，感谢您的帮助！

# php - PHP 5.2.17 中 DateTime::diff() 的解决方法

> ID：14674958
> 
> 赞同：1
> 
> 时间：2013-02-03T17:09:20.870
> 
> 标签：php, datetime

我目前有一个脚本来计算两个日期之间的差异，以天为单位：

```
$now      = new DateTime();
$birthday = new DateTime('1973-04-18 09:48:00');
$interval = $now->diff($birthday);
echo $interval->format('%a days'); 
```

但是，我不断收到此错误：

> 致命错误：在第 4 行的 /home/test/public_html/age.php 中调用未定义的方法 DateTime::diff()

我发现这段代码只适用于 PHP 5.3 版，但是，有 5.2.17 的解决方法吗？

# python - 如何为可以使用 shebang 加载解释器的脚本编写 Python 解释器

> ID：14674960
> 
> 赞同：0
> 
> 时间：2013-02-03T17:09:29.450
> 
> 标签：python, argv, shebang

我有一个用 Python 编写的简单脚本解释器，它处理用文本文件编写的脚本。我可以使用脚本顶部的 shebang 来引用解释器，这样我就可以直接执行脚本。

解释器有一些逻辑来检测何时通过 shebang 调用它，以便它可以调整参数列表以进行补偿。这是必要的，因为当直接调用时，每个参数都是 argv 中的一个单独项，但是，当通过 shebang 调用时，shebang 行上的所有参数都包含在第一个参数字符串中，脚本的名称在第二个参数字符串中之后直接给脚本的任何参数。

我检查shebang的方式如下：

```
def main(name, argv):

    ...

    if len(argv) >= 2 and name[0] == '/' and os.path.isfile(argv[1]) and os.access(argv[1], os.X_OK):
        input = open(argv[1])
        arglist = argv[0].split() + argv[2:]
    else:
        arglist = argv
        input = sys.stdin

    ...

sys.exit(main(sys.argv[0], sys.argv[1:])) 
```

如果至少有 2 个 argv 值，则假设执行是通过 shebang 执行的，命令名称以“/”开头（shebang 可执行路径是绝对路径）并且 argv[1] 中的脚本名称是一个可执行文件。如果通过 shebang 执行，则参数列表是 argv[0] 拆分出来的，然后将 argv[2] 附加到该列表中。

我想知道这是否正确，或者是否有另一种方法可以更明确地确定这一点。我所做的工作适用于我需要使用的所有场景，但如果有更好的方法，我会很感兴趣。

# java - 为最短路径计算存储一个巨大的图表

> ID：14674961
> 
> 赞同：3
> 
> 时间：2013-02-03T17:09:29.780
> 
> 标签：java, mysql

我正在尝试以一种有效的方式在 MySQL 数据库中存储超过 5GB 的未加权有向图，以找到最短路径。目前它存储在一个带有列源和一个列目标（逗号分隔）的表中，但我觉得这不是要走的路，所以我打算将它转换为一个带有顶点和一个表的表有边缘。

我有两个问题：

1.  存储图表的最佳方式是什么？
2.  我应该使用什么最短路径算法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T17:20:05.523

你应该有两张桌子。一个用于节点，一个用于边。在边表中，您应该有 source_node_id 和 dest_node_id。这样，您可以轻松地对边表进行查询，以获取 Dijkstra 算法使用的所有传出节点。

有关简单的 Dijksra 算法解释，请参见： [http ://www.sce.carleton.ca/faculty/chinneck/po/Chapter8.pdf](http://www.sce.carleton.ca/faculty/chinneck/po/Chapter8.pdf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-06T12:48:03.780

存储密集图的另一种非常有效的方法（稀疏图不是那么有效）是使用邻接矩阵。这是一个解释它的链接 -

[使用邻接矩阵存储图](https://www.khanacademy.org/computing/computer-science/algorithms/graph-representation/a/representing-graphs)

现在，要将矩阵存储在 MySQL 数据库中，您必须使用 rowid 作为行的顶点 id（假设您的顶点 id 为 1,2，...）。这些列可以只是普通的顶点名称或顶点 ID。您可以保留一个将顶点名称映射到 id 的表。

您将面临的一个问题是最大列数。如果您的矩阵太大，您可能必须将列拆分为多个表。如果您有一个索引方案/散列方案可以立即从您想要的节点告诉您表的名称，那么您的查询应该相对较快。

对于最短路径，正如其他人所提到的，Dijkstra 算法是目前最好的最短路径查找算法。

# javascript - RegExp 提取特定字符串，后跟任意数字，前导/尾随空格

> ID：14674964
> 
> 赞同：0
> 
> 时间：2013-02-03T17:09:36.877
> 
> 标签：javascript, regex, pattern-matching, string-matching

我想使用 JavaScript / RegExp 从另一个中提取一个字符串。这是我得到的：

```
var string = "wp-button wp-image-45 wp-label";
string.match(/(?:(?:.*)?\s+)?(wp-image-([0-9]+))(:?\s(?:.*)?)?/);
// returnes: ["wp-button ", "wp-image-45", "45", undefined] 
```

我只想拥有“wp-image-45”，所以：

*   （可选）任何字符
*   （可选）后跟空格
*   （必需）后跟“wp-image-”
*   （必填）后跟任意数字
*   （可选）后跟空格
*   （可选）后跟任意字符

这里缺少什么？它只是某种括号还是更多？我也试过

```
string.match(/(?:(?:.*)?\s+)?(?=(wp-image-([0-9]+)))(?=(:?\s(?:.*)?)?)/) 
```

**编辑：**最后我只想得到这个数字。但我也会在两者之间迈出这一步。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T17:16:49.047

正则表达式不需要在字符串的开头开始匹配，因此您无需尝试匹配空格和任何字符。此外，“任何字符”包括空格（某些模式下的换行符除外）。

这应该是您所需要的：

```
string.match(/\bwp-image-(\d+)\b/) 
```

例如，这会将“wp-image-123”捕获到匹配组 0，将“123”捕获到匹配组 1。

`\b`表示“单词边界”，确保您不会匹配“abcwp-image-123def”。单词边界定义为非单词字符后跟单词字符的任何位置，反之亦然。单词字符由字母、数字或下划线组成。

另外，我只是出于方便而使用`\d`而不是。`[0-9]`它们的含义略有不同（`\d`也匹配其他语言中被视为数字的字符），但这不会对您的情况产生影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:19:36.060

如果所有这些周围的东西都是可选的，而你想要的只是数字，那么除了“wp-image-”前缀之外，没有必要匹配任何这些东西，只需执行以下操作：

```
var string = "wp-button wp-image-45 wp-label";
string.match(/wp-image-([0-9]+)/); 
```

# mysql - 与 Sybase ASE 的 APPLICATIONNAME 等效的 MySQL 会话变量是什么？

> ID：14674965
> 
> 赞同：1
> 
> 时间：2013-02-03T17:09:46.570
> 
> 标签：mysql, session, variables, connection

Sybase 中的 APPLICATIONNAME 用于信息模式查询（当前连接、慢查询等），因此结果不仅包含线程/进程 ID，还包含对负责给定查询的应用程序的更易读的描述。

mysql中有没有等价的？我的 google fu 让我失望了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T11:44:39.343

在一个 SQL 电子邮件列表（list.prog.hu 中的 sq-l）上，我得到的答案是不，这在 MySQL 上不受支持，但一个相对常见的解决方法是在每个 SQL 语句前面加上一个描述性注释来标识发出应用程序。

例如：

```
/* cms_blog_module */ select * from blog_posts where id = .... 
```

这样，无论查询在哪里，它的来源也都存在

# iphone - iOS：UIImage EXC_BAD_ACCESS

> ID：14674966
> 
> 赞同：1
> 
> 时间：2013-02-03T17:09:49.027
> 
> 标签：iphone, ios, objective-c, memory-management

我正在构建一个仅适用于 iPhone 的小型应用程序（iOS SDK 6.0），并且在 XCode 中**出现 EXC_BAD_ACCESS**异常。

该应用程序具有`UITableView`自定义`UITableViewCell`. 我已经`UITableViewCell`在一个子类中实现了（我在这里调用它`MyCustomCell`）并向构造函数添加了另一个参数：

```
- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier cellImage:(UIImage *)image; 
```

被`UIImage`添加到`contentView`方法`TableCell`中，代码如下：

```
imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 100, 50)];
imageView.image = image;

[self.contentView addSubview:imageView]; 
```

这个函数`cellForRowAtIndexPath`当然是在函数内部调用的：

```
static NSString *CellIdentifier = @"MyCustomCell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil)
{
    cell = [[[MyCustomCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier cellImage:self.cellImage] autorelease];
}

return cell; 
```

（也是）的`cellImage`属性被声明为（它也是合成的）：`ViewController``UITableViewDelegate`

```
@property (nonatomic, retain) UIImage* cellImage; 
```

图像在`viewWillAppear`ViewController 的方法中使用以下行进行初始化：

```
cellImage = [UIImage imageNamed:@"my_image_resource.png"]; 
```

**此代码工作正常，但 EXC_BAD_ACCESS 出现，当我自定义与 iOS 6.0 唯一功能的图像**：

```
cellImage = [[UIImage imageNamed:@"my_image_resource.png"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 10, 0, 10) resizingMode:UIImageResizingModeStretch]; 
```

调试帮助我找到了触发错误的行 - 它在`initWithStyle`MyCustomCell 实现的方法中：

```
imageView.image = image; 
```

我已经查看了很多`EXC_BAD_ACCESS`错误，我还阅读了为什么会出现这个错误的教程，但到目前为止，我并没有取消任何东西。此时可能会释放某些对象，但我无法准确找到哪个对象以及如何解决该问题。

*我还尝试在 ViewController 类中创建两个属性，一个用于保存原始图像，另一个用于保存带有插图的图像。然而，它并没有解决问题。*

**为什么这是一个错误？为什么它不适用于带有插图的图像？我该如何解决这个问题？**

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T17:59:13.980

执行语句时出现错误`imageView.image = image;`。因此，`image`执行此语句时该对象不存在。它必须在以前被释放过，或者由 a 显式发布`[release image]`（因为您不使用 ARC），或者如果`image`是自动发布的（例如，如果您使用 ARC 创建它`[UIImage imageNamed:...]`）。
正如 Aaron Wojnowski 建议的那样，我认为最好的方法是转换您的代码 ARC。否则，检查是否`image`可以意外释放。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T17:31:37.307

您已经为 cellImage 创建了一个属性，但是您使用实例变量而不是为您创建的 setter 来设置它。由于您传递的是一个自动释放的对象，因此当您下次尝试引用它时，它可能已被释放。尝试在下面使用它：

```
[self setCellImage:[[UIImage imageNamed:@"my_image_resource.png"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 10, 0, 10) resizingMode:UIImageResizingModeStretch]]; 
```

或者这样：

```
self.cellImage = [[UIImage imageNamed:@"my_image_resource.png"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 10, 0, 10) resizingMode:UIImageResizingModeStretch]; 
```

使用此代码，图像将在设置器中为您保留，下次您尝试使用它时，内存仍将被分配，您应该不会有任何问题。

如果可能，还可以考虑使用 ARC，因为这些复杂的内存管理东西都是为您处理的。 [http://developer.apple.com/library/mac/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html](http://developer.apple.com/library/mac/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html)

# android - 无法显示从一个意图到另一个意图的价值

> ID：14674967
> 
> 赞同：0
> 
> 时间：2013-02-03T17:10:30.917
> 
> 标签：android, android-intent

我想根据我的复选框状态显示值..

我使用的代码是..

```
if((cb1).isChecked()==true){
        str="abc";
    }

    public void chk_med(View view){
    Intent intent = new Intent(Medicine.this, chk_med.class);
    Medicine.this.startActivity(intent);
    intent.putExtra("fvr", str); 
```

chk_med 的代码

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.disp_med);
    Bundle extras=getIntent().getExtras();
    String Value1;
    Value1 = extras.getString("fvr");

    TextView t1 = (TextView)findViewById(R.id.show_res);
    t1.setText(Value1);

} 
```

似乎是什么错误？请帮助家伙。

我将代码更改为

```
public void chk_med(View view){
    Intent intent = new Intent(Medicine.this, chk_med.class);
    intent.putExtra("fvr", a);
    Medicine.this.startActivity(intent); 
```

但它仍然没有显示 chk_med 意图

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:13:09.937

在启动新活动**后**，您将授予`extra`Intent 。因此，一旦你启动了那个新的 Activity，你就永远不会真正得到你想要的额外的东西。

 **这意味着你应该改变你的代码，所以它是：

```
 public void chk_med(View view){
    if(cb1.isChecked())
       str="abc";
    else
       str = "xyz";
    Intent intent = new Intent(Medicine.this, chk_med.class);
    intent.putExtra("fvr", str);
    Medicine.this.startActivity(intent);
} 
```

这允许在正确的时间将额外的内容提供给 Intent。

还要考虑正确的 Java 命名约定：类以大写字母开头，而变量*则不是*（驼峰式）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:13:10.107

这些行是乱序的：

```
Intent intent = new Intent(Medicine.this, chk_med.class);
Medicine.this.startActivity(intent);
intent.putExtra("fvr", str); 
```

改成：

```
Intent intent = new Intent(Medicine.this, chk_med.class);
intent.putExtra("fvr", str);
Medicine.this.startActivity(intent); 
```**

# bash - 如何比较bash脚本中文件的时间戳

> ID：14674969
> 
> 赞同：4
> 
> 时间：2013-02-03T17:10:57.093
> 
> 标签：bash, shell

我必须编写一个 bash shell 脚本来实现以下功能。从目录中获取所有文件的列表。在目标目录中，如果存在任何这些文件，请比较日期。仅当源文件比目标文件新时，才将文件直接复制到目标。必须为每个文件执行此操作。我创建了一个 for 循环来实现复制部分。但我需要帮助来比较文件的日期。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T22:16:30.383

`man test`

```
FILE1 -nt FILE2
          FILE1 is newer (modification date) than FILE2

FILE1 -ot FILE2
          FILE1 is older than FILE2

...
-e FILE
          FILE exists
.... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T17:13:59.987

```
man cp | grep -C1 update

       -u, --update
              copy only when the SOURCE file is newer than the destination file or when the destination file is missing 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T19:23:13.803

你应该可以做一个cp。

```
cp -Ru /Your/original/path/ /destination/path/location/ 
```

# java - 无法解析或不是字段

> ID：14674970
> 
> 赞同：1
> 
> 时间：2013-02-03T17:11:10.450
> 
> 标签：java, android, button

我想创建一个应用程序来记录应用程序的所有通知。我正在创建按钮，但我得到*“无法解决或不是字段”*。

这是activity_get_notification.xml

```
 <Button
    android:id="@+id/OKButton"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_centerHorizontal="true"
    android:layout_marginBottom="116dp"
    android:text="@string/ok" /> 
```

这是java代码

```
import android.app.Activity;

import android.content.Intent;
import android.os.Bundle;
import android.widget.Button;
import com.example.notificationnotifier.R;

public class GetNotification extends Activity {
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_get_notification);

    Button OKButton = (Button) findViewById(R.id.OKButton);
     Intent getNotification = new Intent("com.example.notificationnotifier.monitorNotification");
    startActivity(getNotification);
} 
```

我的 androidmanifest 是

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.notificationnotifier"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="16"
        android:targetSdkVersion="16" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.notificationnotifier.GetNotification"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name="com.example.notificationnotifier.monitorNotification"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.DEFAULT" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

这是错误信息

```
[2013-02-04 01:18:52 - NotificationNotifier] W/ResourceType( 7432): Bad XML block: header size 60 or total size 0 is larger than data size 0
[2013-02-04 01:18:52 - NotificationNotifier] C:\Users\Trend\workspace\NotificationNotifier\res\layout\activity_get_notification.xml:7: error: Error: No resource found that matches the given name (at 'text' with value '@string/ok').
[2013-02-04 01:18:52 - NotificationNotifier] C:\Users\Trend\workspace\NotificationNotifier\res\menu\activity_get_notification.xml:3: error: Error: No resource found that matches the given name (at 'title' with value '@string/menu_settings').
[2013-02-04 01:20:23 - NotificationNotifier] W/ResourceType( 6764): Bad XML block: header size 85 or total size 0 is larger than data size 0
[2013-02-04 01:20:23 - NotificationNotifier] C:\Users\Trend\workspace\NotificationNotifier\res\layout\activity_get_notification.xml:7: error: Error: No resource found that matches the given name (at 'text' with value '@string/ok').
[2013-02-04 01:20:23 - NotificationNotifier] C:\Users\Trend\workspace\NotificationNotifier\res\menu\activity_get_notification.xml:3: error: Error: No resource found that matches the given name (at 'title' with value '@string/menu_settings').
[2013-02-04 01:24:18 - NotificationNotifier] W/ResourceType( 5092): Bad XML block: header size 147 or total size 0 is larger than data size 0
[2013-02-04 01:24:18 - NotificationNotifier] C:\Users\Trend\workspace\NotificationNotifier\res\layout\activity_get_notification.xml:7: error: Error: No resource found that matches the given name (at 'text' with value '@string/ok').
[2013-02-04 01:24:18 - NotificationNotifier] C:\Users\Trend\workspace\NotificationNotifier\res\menu\activity_get_notification.xml:3: error: Error: No resource found that matches the given name (at 'title' with value '@string/menu_settings'). 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T17:33:32.417

如日志：

> 未找到与给定名称匹配的资源（在“文本”处，值为“@string/ok”）。

意味着您忘记在file中添加`ok`和`menu_settings` 字符串 。`res/values/strings.xml`将其添加为：

```
<resources>
    <string name="ok">ok button</string>
    <string name="menu_settings">menu settings</string>
</resources> 
```

# ssl - 使用 HTTP 而不是 HTTPS 时发出警告

> ID：14674973
> 
> 赞同：3
> 
> 时间：2013-02-03T17:11:39.963
> 
> 标签：ssl, https, cherrypy

我有一个已经运行了几年的纯 CherryPy 服务器。我最近决定添加 SSL 支持。在这种情况下，提供证书和密钥文件并将正确的值分配给变量`cherrypy.server.ssl_certificate`和`cherrypy.server.ssl_private_key`.

每当有人尝试使用“http://...”而不是“https://...”访问页面时，我想就此更改发出警告。有没有一种简单的方法可以在我的系统中不做很多更改的情况下实现这一目标？另一种选择是将 HTTP 访问重定向到 HTTPS——这很容易做到吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T12:46:53.803

我会创建一个自定义处理程序来实现你所追求的。这会自动重定向到 HTTPS。

```
class Functions():
    def check_ssl(self=None):
        # check if url is in https and redirect if http
        if cherrypy.request.scheme == "http":
            cherrypy.HTTPRedirect(Referer.replace("http:", "https:"))

    cherrypy.tools.Functions = cherrypy.Tool('before_handler', check_ssl) 
```

# reflection - 如何从使用反射 API 的可移植类库中定位 Silverlight？

> ID：14674974
> 
> 赞同：1
> 
> 时间：2013-02-03T17:11:45.370
> 
> 标签：reflection, silverlight-5.0, portable-class-library

我有一个针对 WSA、NET45 和 WP8 的可移植类库，我也想针对 SL5。愚蠢的是 99% 的库代码都符合 SL 标准，但有几个地方我调用反射 API 来检索类型属性或字段：

```
var fields = myType.GetTypeInfo().DeclaredFields; 
```

不幸的是 GetTypeInfo 在 SL5 中不可用，因此上述代码无法编译。所以我基本上有选择：

1.  不要从 PCL 定位 SL5，因此我需要为 Silverlight 保留一个单独的库。
2.  从使用反射的 PCL 代码中提取，因此 PCL 将需要解决这种对启动的依赖。
3.  在运行时做一些聪明的事情，这样 PCL 可以检测哪些方法可用并调用适当的方法。

选项 1 没问题，但我宁愿找到维护重复库的替代方法。如果我必须提取大量功能，那么选项 2 就可以了，因此值得引入一个引导程序。当有几行无法编译时，拖动 DI/IoC 是愚蠢的。

因此，我正在考虑选项 3，但没有清楚地了解它是否可能。反射是我的朋友，但这是我试图克服的反射 API 不匹配。

建议/经验分享表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:50:08.927

在玩过代码之后，我发现我可以简单地使用旧的检索字段的方法：

```
var fields = myType.GetFields(BindingFlags.Public | BindingFlags.Static); 
```

我的印象是，由于反射 API 更改，此语法在 PCL 中不可用，但实际上恰恰相反：使用此语法，我可以同时针对 WSA、WP8 和 SL5 的 .NET 4.0.3、.NET 4.5、.NET .

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-04-13T07:36:07.370

这个怎么样？

```
Reflection.Assembly = Reflection.IntrospectionExtensions.GetTypeInfo(GetType(*anyTypeInAssembly*)).Assembly 
```

# c# - 本地化和数据注释。GlobalResourceProxyGenerator 和 PublicResxFileCodeGenerator

> ID：14674981
> 
> 赞同：24
> 
> 时间：2013-02-03T17:12:13.923
> 
> 标签：c#, asp.net-mvc, localization

为什么 DataAnnotation 属性难以访问 PublicResxFileCodeGenerator 创建的资源？

我发现以下属性：

```
[Compare("NewPassword", ErrorMessageResourceName = "RegisterModel_ConfirmPasswordError", ErrorMessageResourceType = typeof(Resources.Global))] 
```

如果资源是使用 PublicResxFileCodeGenerator 创建的，将无法找到该资源。但是，使用 GlobalResourceProxyGenerator 创建的相同资源将正常工作。两个资源文件都设置为 Content 并位于 App_GlobalResources 中。我也尝试将默认语言放在 App_LocalResources 中，但似乎没有什么区别。我的测试是我的辅助语言（GlobalResourceProxyGenerator）有效，但我的主要语言（PublicResxFileCodeGenerator）抛出异常（它无法找到资源文件）。如果我同时切换到 GlobalResourceProxyGenerator 那么一切都很好（但显然没有公共访问权限）。

有人知道为什么吗？我想将来将资源转移到另一个程序集中。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-07T21:55:50.813

那是因为您将资源文件放在了`App_GlobalResources`文件夹中，该文件夹是 ASP.NET 中的一个特殊文件夹。如果您将资源文件放在其他地方，这应该可以工作。这也可以是一个完全独立于 ASP.NET MVC 应用程序的项目。

以下是您可以完成这项工作的步骤：

1.  使用默认 Internet 模板创建新的 ASP.NET MVC 3 应用程序
2.  添加`~/Messages.resx`包含`RegisterModel_ConfirmPasswordError`资源字符串的文件
3.  `PublicResXFileCodeGenerator`为此资源文件设置自定义工具：

    ![在此处输入图像描述](../Images/817ecbc1e9ca04d863f4edb81fe5cd7d.png)

4.  添加模型：

    ```
    public class MyViewModel
    {
        [Compare("NewPassword", 
                 ErrorMessageResourceName = "RegisterModel_ConfirmPasswordError",
                 ErrorMessageResourceType = typeof(MvcApplication1.Messages))]
        public string Password { get; set; }

        public string NewPassword { get; set; }
    } 
    ```

5.  控制器：

    ```
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            return View(new MyViewModel());
        }

        [HttpPost]
        public ActionResult Index(MyViewModel model)
        {
            return View(model);
        }
    } 
    ```

6.  看法：

    ```
    @model MyViewModel

    @using (Html.BeginForm())
    {
        <div>
            @Html.LabelFor(x => x.Password)
            @Html.EditorFor(x => x.Password)
            @Html.ValidationMessageFor(x => x.Password)
        </div>

        <div>
            @Html.LabelFor(x => x.NewPassword)
            @Html.EditorFor(x => x.NewPassword)
            @Html.ValidationMessageFor(x => x.NewPassword)
        </div>

        <button type="submit">OK</button>
    } 
    ```

然后您可以通过提供相应的翻译来开始本地化：

*   Messages.fr-FR.resx
*   Messages.de-DE.resx
*   Messages.it-IT.resx
*   Messages.es-ES.resx
*   ...

* * *

更新：

我在评论部分被问到该`App_GlobalResources`文件夹​​有什么特别之处以及为什么它不能与它一起使用。好吧，实际上你可以让它工作。您需要做的就是将 设置`Build Action`为`Embedded Resource`。默认情况下，当您将文件添加到文件`App_GlobalResources`夹时，Visual Studio 将其设置为`Content`意味着该资源不会被合并到运行时程序集中，并且 ASP.NET MVC 无法找到它：

![在此处输入图像描述](../Images/c0fa8010abfd121e216f7c708b2793a7.png)

# asp.net - 将模型值从视图传递到控制器不起作用

> ID：14674982
> 
> 赞同：1
> 
> 时间：2013-02-03T17:12:15.303
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, razor

我的模型有两个属性，其中一个是另一个类的对象

```
 public class Association : Entity
{
    public Association()
    {
        this.User = new User();
    }

    public User User
    {
        get;
        set;
    }

    public Role Role
    {
        get;
        set;
    }
}; 
```

我的观点是强类型到这个模型

```
@model MuddyBoots.Greenlight.Association
.
.
@using (Html.BeginForm())
{

@Html.ValidationSummary(true)
    <div>
     @Html.TextBoxFor(model => model.User.FirstName,new { id = "first-name" })
    <span class="red-asterisk">@Html.ValidationMessageFor(model =>    model.User.FirstName)</span>
 </div>
   <div>
    @Html.HiddenFor(model => model.Role, new { id="hiddenRole"})
        <ul id="user-roles">
            <li><input type="radio" name="user-role" id="role-admin" value="01" checked="checked" /> Read only</li>
            <li><input type="radio" name="user-role" id="role-member" value="02" /> Restricted</li>
            <li><input type="radio" name="user-role" id="role-read" value="03"/> Standard</li>
            <li><input type="radio" name="user-role" id="role-subscriber" value="04" /> Administrator</li>
        </ul>
</div>
} 
```

我的控制器函数是这样写的：

```
[HttpPost]
    public ActionResult AddUser(Association association)
    {
        string firstName = association.User.FirstName;
        var role = association.Role;

         IRepository<Association> associationRepository = new IRepository<Association>(db);
        if (ModelState.IsValid)
        { 
           siteRepository.Update(site);
            return RedirectToAction("Index");
        }
        return View(association);
    } 
```

我的问题是：当我发布我的视图时，我的关联对象为空，它没有值。

更准确地说，当我尝试调试这两行时：

```
 string firstName = association.User.FirstName;
 var role = association.Role; 
```

它们的值为空，但如果我注释第一行，则角色变量有一个值。所以感觉问题与用户属性有关，但我不知道如何解决。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T17:15:42.867

您似乎为角色类型使用了一些隐藏字段：

```
@Html.HiddenFor(model => model.Role, new { id = "hiddenRole" }) 
```

但是 Role 属性是一个复杂的类型，你不能将它序列化为隐藏字段。您必须为要发送的每个属性使用隐藏字段：

```
@Html.HiddenFor(model => model.Role.Property1)
@Html.HiddenFor(model => model.Role.Property2)
@Html.HiddenFor(model => model.Role.Property...) 
```

此外，您似乎在表单中使用了一些已命名的单选按钮，`user-role`但您的 Role 类上不能有一个具有此名称的属性（属性名称中不能有破折号），所以我想您必须使用正确的名称如果您希望将这些单选按钮的值绑定到关联模型上 Role 类的某些属性，请在此处。

例如，假设您的 Role 类如下所示：

```
public class Role
{
    public string Value { get; set; }
} 
```

现在您的视图可能如下所示：

```
@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)
    <div>
        @Html.TextBoxFor(model => model.User.FirstName, new { id = "first-name" })
        <span class="red-asterisk">
            @Html.ValidationMessageFor(model => model.User.FirstName)
        </span>
    </div>
    <div>
        <ul id="user-roles">
            <li>
                @Html.RadioButtonFor(model => model.Role.Value, "01", new { id = "role-admin" }) 
                Read only
            </li>
            <li>
                @Html.RadioButtonFor(model => model.Role.Value, "02", new { id = "role-member" }) 
                Restricted
            </li>
            <li>
                @Html.RadioButtonFor(model => model.Role.Value, "03", new { id = "role-read" }) 
                Standard
            </li>
            <li>
                @Html.RadioButtonFor(model => model.Role.Value, "04", new { id = "role-subscriber" }) 
                Administrator
            </li>
        </ul>
    </div>

    <button type="submit">OK</button>
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T17:29:18.827

我认为 ModelBinder 不会绑定子对象。您可以创建一个自定义 ModelBinder 来绑定您的 Association 类，或者只创建一个 ViewModel 类，将您当前的模型扁平化为单个类。因此，您的 AssociationViewModel 模型类可能如下所示：

```
public class AssociationViewModel
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string RoleName { get; set; }
}

public ActionResult AddUser(AssociationViewModel associationViewModel)
{
    if (ModelState.IsValid)
    { 
        var association = new Association
        {
            User.FirstName = associationViewModel.FirstName,
            Role = new Role { Name = associationViewModel.RoleName }
        };

        IRepository<Association> associationRepository = new IRepository<Association>(db);
        ....
    }
 } 
```

# ios - UICollectionView 设置列数

> ID：14674986
> 
> 赞同：109
> 
> 时间：2013-02-03T17:12:28.653
> 
> 标签：ios, objective-c, xcode, uicollectionview, uicollectionviewcell

我刚开始学习 UICollectionViews。我想知道是否有人知道如何指定collectionview 中的列数。默认设置为 3（iPhone/纵向）。我查看了文档，似乎找不到简明的答案。

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2016-12-31T15:32:51.593

在 Swift 5 和 iOS 12.3 中，您可以使用**以下 4 种实现**之一来设置每行中的项目数，`UICollectionView`同时管理插入和大小更改（包括旋转）。

* * *

### #1。子类化`UICollectionViewFlowLayout`和使用`UICollectionViewFlowLayout`的[`itemSize`](https://developer.apple.com/documentation/uikit/uicollectionviewflowlayout/1617711-itemsize)属性

*ColumnFlowLayout.swift：*

```
import UIKit

class ColumnFlowLayout: UICollectionViewFlowLayout {

    let cellsPerRow: Int

    init(cellsPerRow: Int, minimumInteritemSpacing: CGFloat = 0, minimumLineSpacing: CGFloat = 0, sectionInset: UIEdgeInsets = .zero) {
        self.cellsPerRow = cellsPerRow
        super.init()

        self.minimumInteritemSpacing = minimumInteritemSpacing
        self.minimumLineSpacing = minimumLineSpacing
        self.sectionInset = sectionInset
    }

    required init?(coder aDecoder: NSCoder) {
        fatalError("init(coder:) has not been implemented")
    }

    override func prepare() {
        super.prepare()

        guard let collectionView = collectionView else { return }
        let marginsAndInsets = sectionInset.left + sectionInset.right + collectionView.safeAreaInsets.left + collectionView.safeAreaInsets.right + minimumInteritemSpacing * CGFloat(cellsPerRow - 1)
        let itemWidth = ((collectionView.bounds.size.width - marginsAndInsets) / CGFloat(cellsPerRow)).rounded(.down)
        itemSize = CGSize(width: itemWidth, height: itemWidth)
    }

    override func invalidationContext(forBoundsChange newBounds: CGRect) -> UICollectionViewLayoutInvalidationContext {
        let context = super.invalidationContext(forBoundsChange: newBounds) as! UICollectionViewFlowLayoutInvalidationContext
        context.invalidateFlowLayoutDelegateMetrics = newBounds.size != collectionView?.bounds.size
        return context
    }

} 
```

*CollectionViewController.swift：*

```
import UIKit

class CollectionViewController: UICollectionViewController {

    let columnLayout = ColumnFlowLayout(
        cellsPerRow: 5,
        minimumInteritemSpacing: 10,
        minimumLineSpacing: 10,
        sectionInset: UIEdgeInsets(top: 10, left: 10, bottom: 10, right: 10)
    )

    override func viewDidLoad() {
        super.viewDidLoad()

        collectionView?.collectionViewLayout = columnLayout
        collectionView?.contentInsetAdjustmentBehavior = .always
        collectionView?.register(UICollectionViewCell.self, forCellWithReuseIdentifier: "Cell")
    }

    override func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -> Int {
        return 59
    }

    override func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {
        let cell = collectionView.dequeueReusableCell(withReuseIdentifier: "Cell", for: indexPath)
        cell.backgroundColor = UIColor.orange
        return cell
    }

} 
```

[![在此处输入图像描述](../Images/aefa273a4ad0e67875b46f6e058f6283.png)](https://i.stack.imgur.com/O7oAX.png)

* * *

### #2。使用`UICollectionViewFlowLayout`'s[`itemSize`](https://developer.apple.com/documentation/uikit/uicollectionviewflowlayout/1617711-itemsize)方法

```
import UIKit

class CollectionViewController: UICollectionViewController {

    let margin: CGFloat = 10
    let cellsPerRow = 5

    override func viewDidLoad() {
        super.viewDidLoad()

        guard let collectionView = collectionView, let flowLayout = collectionViewLayout as? UICollectionViewFlowLayout else { return }

        flowLayout.minimumInteritemSpacing = margin
        flowLayout.minimumLineSpacing = margin
        flowLayout.sectionInset = UIEdgeInsets(top: margin, left: margin, bottom: margin, right: margin)

        collectionView.contentInsetAdjustmentBehavior = .always
        collectionView.register(UICollectionViewCell.self, forCellWithReuseIdentifier: "Cell")
    }

    override func viewWillLayoutSubviews() {
        guard let collectionView = collectionView, let flowLayout = collectionView.collectionViewLayout as? UICollectionViewFlowLayout else { return }
        let marginsAndInsets = flowLayout.sectionInset.left + flowLayout.sectionInset.right + collectionView.safeAreaInsets.left + collectionView.safeAreaInsets.right + flowLayout.minimumInteritemSpacing * CGFloat(cellsPerRow - 1)
        let itemWidth = ((collectionView.bounds.size.width - marginsAndInsets) / CGFloat(cellsPerRow)).rounded(.down)
        flowLayout.itemSize =  CGSize(width: itemWidth, height: itemWidth)
    }

    override func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -> Int {
        return 59
    }

    override func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {
        let cell = collectionView.dequeueReusableCell(withReuseIdentifier: "Cell", for: indexPath)
        cell.backgroundColor = UIColor.orange
        return cell
    }

    override func viewWillTransition(to size: CGSize, with coordinator: UIViewControllerTransitionCoordinator) {
        collectionView?.collectionViewLayout.invalidateLayout()
        super.viewWillTransition(to: size, with: coordinator)
    }

} 
```

* * *

### #3。使用`UICollectionViewDelegateFlowLayout`'s[`collectionView(_:layout:sizeForItemAt:)`](https://developer.apple.com/documentation/uikit/uicollectionviewdelegateflowlayout/1617708-collectionview)方法

```
import UIKit

class CollectionViewController: UICollectionViewController, UICollectionViewDelegateFlowLayout {

    let inset: CGFloat = 10
    let minimumLineSpacing: CGFloat = 10
    let minimumInteritemSpacing: CGFloat = 10
    let cellsPerRow = 5

    override func viewDidLoad() {
        super.viewDidLoad()

        collectionView?.contentInsetAdjustmentBehavior = .always
        collectionView?.register(UICollectionViewCell.self, forCellWithReuseIdentifier: "Cell")
    }

    func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, insetForSectionAt section: Int) -> UIEdgeInsets {
        return UIEdgeInsets(top: inset, left: inset, bottom: inset, right: inset)
    }

    func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, minimumLineSpacingForSectionAt section: Int) -> CGFloat {
        return minimumLineSpacing
    }

    func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, minimumInteritemSpacingForSectionAt section: Int) -> CGFloat {
        return minimumInteritemSpacing
    }

    func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, sizeForItemAt indexPath: IndexPath) -> CGSize {
        let marginsAndInsets = inset * 2 + collectionView.safeAreaInsets.left + collectionView.safeAreaInsets.right + minimumInteritemSpacing * CGFloat(cellsPerRow - 1)
        let itemWidth = ((collectionView.bounds.size.width - marginsAndInsets) / CGFloat(cellsPerRow)).rounded(.down)
        return CGSize(width: itemWidth, height: itemWidth)
    }

    override func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -> Int {
        return 59
    }

    override func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {
        let cell = collectionView.dequeueReusableCell(withReuseIdentifier: "Cell", for: indexPath)
        cell.backgroundColor = UIColor.orange
        return cell
    }

    override func viewWillTransition(to size: CGSize, with coordinator: UIViewControllerTransitionCoordinator) {
        collectionView?.collectionViewLayout.invalidateLayout()
        super.viewWillTransition(to: size, with: coordinator)
    }

} 
```

* * *

### #4。子类化`UICollectionViewFlowLayout`和使用`UICollectionViewFlowLayout`的[`estimatedItemSize`](https://developer.apple.com/documentation/uikit/uicollectionviewflowlayout/1617709-estimateditemsize)属性

*CollectionViewController.swift：*

```
import UIKit

class CollectionViewController: UICollectionViewController {

    let items = [
        "Lorem ipsum dolor sit amet, consectetur adipiscing elit.",
        "Lorem ipsum dolor sit amet, consectetur.",
        "Lorem ipsum dolor sit amet.",
        "Lorem ipsum dolor sit amet, consectetur.",
        "Lorem ipsum dolor sit amet, consectetur adipiscing.",
        "Lorem ipsum.",
        "Lorem ipsum dolor sit amet.",
        "Lorem ipsum dolor sit.",
        "Lorem ipsum dolor sit amet, consectetur adipiscing.",
        "Lorem ipsum dolor sit amet, consectetur adipiscing elit.",
        "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor.",
        "Lorem ipsum dolor sit amet, consectetur."
    ]

    let columnLayout = FlowLayout(
        cellsPerRow: 3,
        minimumInteritemSpacing: 10,
        minimumLineSpacing: 10,
        sectionInset: UIEdgeInsets(top: 10, left: 10, bottom: 10, right: 10)
    )

    override func viewDidLoad() {
        super.viewDidLoad()

        collectionView?.collectionViewLayout = columnLayout
        collectionView?.contentInsetAdjustmentBehavior = .always
        collectionView?.register(Cell.self, forCellWithReuseIdentifier: "Cell")
    }

    override func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -> Int {
        return items.count
    }

    override func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {
        let cell = collectionView.dequeueReusableCell(withReuseIdentifier: "Cell", for: indexPath) as! Cell
        cell.label.text = items[indexPath.row]
        return cell
    }

    override func viewWillTransition(to size: CGSize, with coordinator: UIViewControllerTransitionCoordinator) {
        collectionView?.collectionViewLayout.invalidateLayout()
        super.viewWillTransition(to: size, with: coordinator)
    }

} 
```

*FlowLayout.swift：*

```
import UIKit

class FlowLayout: UICollectionViewFlowLayout {

    let cellsPerRow: Int

    required init(cellsPerRow: Int = 1, minimumInteritemSpacing: CGFloat = 0, minimumLineSpacing: CGFloat = 0, sectionInset: UIEdgeInsets = .zero) {
        self.cellsPerRow = cellsPerRow

        super.init()

        self.minimumInteritemSpacing = minimumInteritemSpacing
        self.minimumLineSpacing = minimumLineSpacing
        self.sectionInset = sectionInset
        estimatedItemSize = UICollectionViewFlowLayout.automaticSize
    }

    required init?(coder aDecoder: NSCoder) {
        fatalError("init(coder:) has not been implemented")
    }

    override func layoutAttributesForItem(at indexPath: IndexPath) -> UICollectionViewLayoutAttributes? {
        guard let layoutAttributes = super.layoutAttributesForItem(at: indexPath) else { return nil }
        guard let collectionView = collectionView else { return layoutAttributes }

        let marginsAndInsets = collectionView.safeAreaInsets.left + collectionView.safeAreaInsets.right + sectionInset.left + sectionInset.right + minimumInteritemSpacing * CGFloat(cellsPerRow - 1)
        layoutAttributes.bounds.size.width = ((collectionView.bounds.width - marginsAndInsets) / CGFloat(cellsPerRow)).rounded(.down)

        return layoutAttributes
    }

    override func layoutAttributesForElements(in rect: CGRect) -> [UICollectionViewLayoutAttributes]? {
        let superLayoutAttributes = super.layoutAttributesForElements(in: rect)!.map { $0.copy() as! UICollectionViewLayoutAttributes }
        guard scrollDirection == .vertical else { return superLayoutAttributes }

        let layoutAttributes = superLayoutAttributes.compactMap { layoutAttribute in
            return layoutAttribute.representedElementCategory == .cell ? layoutAttributesForItem(at: layoutAttribute.indexPath) : layoutAttribute
        }

        // (optional) Uncomment to top align cells that are on the same line
        /*
        let cellAttributes = layoutAttributes.filter({ $0.representedElementCategory == .cell })
        for (_, attributes) in Dictionary(grouping: cellAttributes, by: { ($0.center.y / 10).rounded(.up) * 10 }) {
            guard let max = attributes.max(by: { $0.size.height < $1.size.height }) else { continue }
            for attribute in attributes where attribute.size.height != max.size.height {
                attribute.frame.origin.y = max.frame.origin.y
            }
        }
         */

        // (optional) Uncomment to bottom align cells that are on the same line
        /*
        let cellAttributes = layoutAttributes.filter({ $0.representedElementCategory == .cell })
        for (_, attributes) in Dictionary(grouping: cellAttributes, by: { ($0.center.y / 10).rounded(.up) * 10 }) {
            guard let max = attributes.max(by: { $0.size.height < $1.size.height }) else { continue }
            for attribute in attributes where attribute.size.height != max.size.height {
                attribute.frame.origin.y += max.frame.maxY - attribute.frame.maxY
            }
        }
         */

        return layoutAttributes
    }

} 
```

*细胞.swift：*

```
import UIKit

class Cell: UICollectionViewCell {

    let label = UILabel()

    override init(frame: CGRect) {
        super.init(frame: frame)

        label.numberOfLines = 0
        backgroundColor = .orange
        contentView.addSubview(label)

        label.translatesAutoresizingMaskIntoConstraints = false
        label.topAnchor.constraint(equalTo: contentView.layoutMarginsGuide.topAnchor).isActive = true
        label.leadingAnchor.constraint(equalTo: contentView.layoutMarginsGuide.leadingAnchor).isActive = true
        label.trailingAnchor.constraint(equalTo: contentView.layoutMarginsGuide.trailingAnchor).isActive = true
        label.bottomAnchor.constraint(equalTo: contentView.layoutMarginsGuide.bottomAnchor).isActive = true
    }

    required init?(coder aDecoder: NSCoder) {
        fatalError("init(coder:) has not been implemented")
    }

    override func preferredLayoutAttributesFitting(_ layoutAttributes: UICollectionViewLayoutAttributes) -> UICollectionViewLayoutAttributes {
        layoutIfNeeded()
        label.preferredMaxLayoutWidth = label.bounds.size.width
        layoutAttributes.bounds.size.height = contentView.systemLayoutSizeFitting(UIView.layoutFittingCompressedSize).height
        return layoutAttributes
    }

    // Alternative implementation
    /*
    override func preferredLayoutAttributesFitting(_ layoutAttributes: UICollectionViewLayoutAttributes) -> UICollectionViewLayoutAttributes {
        label.preferredMaxLayoutWidth = layoutAttributes.size.width - contentView.layoutMargins.left - contentView.layoutMargins.right
        layoutAttributes.bounds.size.height = contentView.systemLayoutSizeFitting(UIView.layoutFittingCompressedSize).height
        return layoutAttributes
    }
    */

} 
```

[![在此处输入图像描述](../Images/05b506f516593e7f45bda3a72f43d2ef.png)](https://i.stack.imgur.com/8WupU.png)

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2013-02-03T17:38:23.527

CollectionViews 非常强大，而且它们是有代价的。很多，还有很多选择。正如 omz 所说：

> 有多种方法可以更改列数

我建议实施[`<UICollectionViewDelegateFlowLayout>`](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UICollectionViewDelegateFlowLayout_protocol/Reference/Reference.html)协议，让您可以访问以下方法，您可以更好地控制您的布局`UICollectionView`，而无需对其进行子类化：

*   `collectionView:layout:insetForSectionAtIndex:`
*   `collectionView:layout:minimumInteritemSpacingForSectionAtIndex:`
*   `collectionView:layout:minimumLineSpacingForSectionAtIndex:`
*   `collectionView:layout:referenceSizeForFooterInSection:`
*   `collectionView:layout:referenceSizeForHeaderInSection:`
*   `collectionView:layout:sizeForItemAtIndexPath:`

此外，实现以下方法将强制您的 UICollectionView 在方向更改时更新其布局：（假设您想重新调整横向单元格的大小并使其拉伸）

```
-(void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation
                               duration:(NSTimeInterval)duration{

    [self.myCollectionView.collectionViewLayout invalidateLayout];
} 
```

此外，这里有 2 个非常好的教程`UICollectionViews`：

[http://www.raywenderlich.com/22324/beginning-uicollectionview-in-ios-6-part-12](http://www.raywenderlich.com/22324/beginning-uicollectionview-in-ios-6-part-12)

[http://skeuo.com/uicollectionview-custom-layout-tutorial](http://skeuo.com/uicollectionview-custom-layout-tutorial)

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2015-10-17T18:34:41.460

我`UICollectionViewDelegateFlowLayout`在 my 上实现`UICollectionViewController`并覆盖了负责确定 Cell 大小的方法。然后我将屏幕宽度与我的列要求分开。例如，我想在每个屏幕尺寸上有 3 列。所以这就是我的代码的样子 -

```
- (CGSize)collectionView:(UICollectionView *)collectionView
                  layout:(UICollectionViewLayout *)collectionViewLayout
  sizeForItemAtIndexPath:(NSIndexPath *)indexPath
{
    CGRect screenRect = [[UIScreen mainScreen] bounds];
    CGFloat screenWidth = screenRect.size.width;
    float cellWidth = screenWidth / 3.0; //Replace the divisor with the column count requirement. Make sure to have it in float.
    CGSize size = CGSizeMake(cellWidth, cellWidth);

    return size;
} 
```

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2016-03-06T12:35:19.670

扩展菜鸟的答案：

```
func collectionView(collectionView: UICollectionView,
    layout collectionViewLayout: UICollectionViewLayout,
    sizeForItemAtIndexPath indexPath: NSIndexPath) -> CGSize {

        let flowLayout = collectionViewLayout as! UICollectionViewFlowLayout
        let totalSpace = flowLayout.sectionInset.left
            + flowLayout.sectionInset.right
            + (flowLayout.minimumInteritemSpacing * CGFloat(numberOfItemsPerRow - 1))
        let size = Int((collectionView.bounds.width - totalSpace) / CGFloat(numberOfItemsPerRow))
        return CGSize(width: size, height: size)
} 
```

这允许单元格之间的任何间距。它假定一个`Int`名为的成员变量`numberOfItemsPerRow`，并且所有单元格都是正方形且大小相同。正如 jhilgert00 的回答中所述，我们还必须对方向变化做出反应，但现在使用`viewWillTransitionToSize`as`willRotateToInterfaceOrientation`已贬值。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2016-10-17T14:28:09.970

这是 Swift 3 或更高版本的工作代码，具有两列布局：

```
func collectionView(_ collectionView: UICollectionView,
                    layout collectionViewLayout: UICollectionViewLayout,
                    sizeForItemAt indexPath: IndexPath) -> CGSize {

    let nbCol = 2

    let flowLayout = collectionViewLayout as! UICollectionViewFlowLayout
    let totalSpace = flowLayout.sectionInset.left
        + flowLayout.sectionInset.right
        + (flowLayout.minimumInteritemSpacing * CGFloat(nbCol - 1))
    let size = Int((collectionView.bounds.width - totalSpace) / CGFloat(nbCol))
    return CGSize(width: size, height: size)
} 
```

随意将“nbCol”更改为您想要的列数。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2020-02-28T07:29:41.020

**更新到 Swift 5+ iOS 13**

Collectionview Estimate Size 必须为**none**

[![在此处输入图像描述](../Images/19a7a27e95933d6b19b184c9d7dd4470.png)](https://i.stack.imgur.com/sxoDr.png)

声明单元格的边距

```
let margin: CGFloat = 10 
```

在 viewDidLoad 中配置`minimumInteritemSpacing`, `minimumLineSpacing`,`sectionInset`

```
 guard let collectionView = docsColl, let flowLayout = collectionView.collectionViewLayout as? UICollectionViewFlowLayout else { return }

    flowLayout.minimumInteritemSpacing = margin
    flowLayout.minimumLineSpacing = margin
    flowLayout.sectionInset = UIEdgeInsets(top: margin, left: margin, bottom: margin, right: margin) 
```

**UICollectionViewDataSource**方法`sizeForItemAt`

```
func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, sizeForItemAt indexPath: IndexPath) -> CGSize {

    let noOfCellsInRow = 2   //number of column you want
    let flowLayout = collectionViewLayout as! UICollectionViewFlowLayout
    let totalSpace = flowLayout.sectionInset.left
        + flowLayout.sectionInset.right
        + (flowLayout.minimumInteritemSpacing * CGFloat(noOfCellsInRow - 1))

    let size = Int((collectionView.bounds.width - totalSpace) / CGFloat(noOfCellsInRow))
    return CGSize(width: size, height: size)
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-06-08T08:51:23.180

如果你懒惰使用委托。

```
extension UICollectionView {
    func setItemsInRow(items: Int) {
        if let layout = self.collectionViewLayout as? UICollectionViewFlowLayout {
            let contentInset = self.contentInset
            let itemsInRow: CGFloat = CGFloat(items);
            let innerSpace = layout.minimumInteritemSpacing * (itemsInRow - 1.0)
            let insetSpace = contentInset.left + contentInset.right + layout.sectionInset.left + layout.sectionInset.right
            let width = floor((CGRectGetWidth(frame) - insetSpace - innerSpace) / itemsInRow);
            layout.itemSize = CGSizeMake(width, width)
        }
    }
} 
```

*PS：也应该在轮换后调用*

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2016-02-12T12:35:47.687

**更新到 Swift 3：**

而不是流布局，我更喜欢为特定的列号和行号使用自定义布局。因为：

1.  如果列数很大，可以水平拖动。
2.  由于使用列和行，它在逻辑上更容易接受。

**普通单元格和标题单元格：（将 UILabel 作为 IBOutlet 添加到您的 xib）：**

```
class CollectionViewCell: UICollectionViewCell {

@IBOutlet weak var label: UILabel!

override func awakeFromNib() {
    super.awakeFromNib()
    // Initialization code
    self.backgroundColor = UIColor.black
    label.textColor = UIColor.white
}
}

class CollectionViewHeadCell: UICollectionViewCell {

@IBOutlet weak var label: UILabel!

override func awakeFromNib() {
    super.awakeFromNib()
    // Initialization code
    self.backgroundColor = UIColor.darkGray
    label.textColor = UIColor.white
}
} 
```

**自定义布局：**

```
let cellHeight: CGFloat = 100
let cellWidth: CGFloat = 100

class CustomCollectionViewLayout: UICollectionViewLayout {
    private var numberOfColumns: Int!
    private var numberOfRows: Int!

    // It is two dimension array of itemAttributes
    private var itemAttributes = [[UICollectionViewLayoutAttributes]]()
    // It is one dimension of itemAttributes
    private var cache = [UICollectionViewLayoutAttributes]()

override func prepare() {
    if self.cache.isEmpty {

        self.numberOfColumns = self.collectionView?.numberOfItems(inSection: 0)
        self.numberOfRows = self.collectionView?.numberOfSections

        // Dynamically change cellWidth if total cell width is smaller than whole bounds
        /* if (self.collectionView?.bounds.size.width)!/CGFloat(self.numberOfColumns) > cellWidth {
         self.cellWidth = (self.collectionView?.bounds.size.width)!/CGFloat(self.numberOfColumns)
         }
         */
        for row in 0..<self.numberOfRows {
            var row_temp = [UICollectionViewLayoutAttributes]()
            for column in 0..<self.numberOfColumns {

                let indexPath = NSIndexPath(item: column, section: row)

                let attributes = UICollectionViewLayoutAttributes(forCellWith: indexPath as IndexPath)
                attributes.frame = CGRect(x: cellWidth*CGFloat(column), y: cellHeight*CGFloat(row), width: cellWidth, height: cellHeight)

                row_temp.append(attributes)

                self.cache.append(attributes)
            }
            self.itemAttributes.append(row_temp)
        }
    }
}
override var collectionViewContentSize: CGSize {
    return CGSize(width: CGFloat(self.numberOfColumns)*cellWidth, height: CGFloat(self.numberOfRows)*cellHeight)
}

override func layoutAttributesForElements(in rect: CGRect) -> [UICollectionViewLayoutAttributes]? {

    var layoutAttributes = [UICollectionViewLayoutAttributes]()

    for attributes in cache {
        if attributes.frame.intersects(rect) {
            layoutAttributes.append(attributes)
        }
    }
    return layoutAttributes
}
} 
```

**集合视图：**

```
let CellIdentifier = "CellIdentifier"
let HeadCellIdentifier = "HeadCellIdentifier"

class CollectionView: UICollectionView, UICollectionViewDelegate, UICollectionViewDataSource {

init() {
    let layout = CustomCollectionViewLayout()

    super.init(frame: CGRect.zero, collectionViewLayout: layout)

    self.register(UINib(nibName: "CollectionViewCell", bundle: nil), forCellWithReuseIdentifier: CellIdentifier)
    self.register(UINib(nibName: "CollectionViewHeadCell", bundle: nil), forCellWithReuseIdentifier: HeadCellIdentifier)

    self.isDirectionalLockEnabled = true
    self.dataSource = self
    self.delegate = self
}

required init?(coder aDecoder: NSCoder) {
    fatalError("init(coder:) has not been implemented")
}

func updateCollectionView() {
    DispatchQueue.main.async {
        self.reloadData()
    }
}

// MARK: CollectionView datasource
func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -> Int {
    return 20
}
func numberOfSections(in collectionView: UICollectionView) -> Int {
    return 20
}
override func numberOfItems(inSection section: Int) -> Int {
    return 20
}
func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {

    let column = (indexPath as NSIndexPath).row
    let row = (indexPath as NSIndexPath).section

    if column == 0 {
        let cell : CollectionViewHeadCell = collectionView.dequeueReusableCell(withReuseIdentifier: HeadCellIdentifier, for: indexPath) as! CollectionViewHeadCell

        cell.label.text = "\(row)"

        return cell
    }
    else if row == 0 {
        let cell : CollectionViewHeadCell = collectionView.dequeueReusableCell(withReuseIdentifier: HeadCellIdentifier, for: indexPath) as! CollectionViewHeadCell

        cell.label.text = "\(column)"

        return cell
    }
    else {
        let cell : CollectionViewCell = collectionView.dequeueReusableCell(withReuseIdentifier: CellIdentifier, for: indexPath) as! CollectionViewCell

        cell.label.text = String(format: "%d", arguments: [indexPath.section*indexPath.row])

        return cell
    }
}

// MARK: CollectionView delegate
func collectionView(_ collectionView: UICollectionView, didSelectItemAt indexPath: IndexPath) {

    let column = (indexPath as NSIndexPath).row
    let row = (indexPath as NSIndexPath).section

    print("\(column)  \(row)")
}
} 
```

**使用 ViewController 中的 CollectionView：**

```
class ViewController: UIViewController {
let collectionView = CollectionView()

override func viewDidLoad() {
    collectionView.translatesAutoresizingMaskIntoConstraints = false
    self.view.addSubview(collectionView)
    self.view.backgroundColor = UIColor.red

    self.view.addConstraints(NSLayoutConstraint.constraints(withVisualFormat: "H:|[collectionView]|", options: [], metrics: nil, views: ["collectionView": collectionView]))
    self.view.addConstraints(NSLayoutConstraint.constraints(withVisualFormat: "V:|[collectionView]|", options: [], metrics: nil, views: ["collectionView": collectionView]))
}

override func viewDidAppear(_ animated: Bool) {
    super.viewDidAppear(animated)

    collectionView.updateCollectionView()
}
} 
```

**最后你可以拥有精美的 CollectionView！**

[![在此处输入图像描述](../Images/f573351811e8b193cdbbd66e521bd76e.png)](https://i.stack.imgur.com/z0Vzt.png)

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2013-02-03T17:18:36.283

因为`UICollectionView`非常灵活，有多种方法可以更改列数，具体取决于您使用的布局类型。

（这`UICollectionViewFlowLayout`可能是您正在使用的）没有直接指定列数（因为它取决于视图大小/方向）。更改它的最简单方法是设置`itemSize`属性和/或`minimumInteritemSpacing`/ `minimumLineSpacing`。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2017-05-31T20:35:10.187

**斯威夫特 3.0。适用于水平和垂直滚动方向和可变间距**

指定列数

```
let numberOfColumns: CGFloat = 3 
```

配置`flowLayout`为渲染指定`numberOfColumns`

```
if let flowLayout = collectionView?.collectionViewLayout as? UICollectionViewFlowLayout {
    let horizontalSpacing = flowLayout.scrollDirection == .vertical ? flowLayout.minimumInteritemSpacing : flowLayout.minimumLineSpacing
    let cellWidth = (collectionView.frame.width - max(0, numberOfColumns - 1)*horizontalSpacing)/numberOfColumns
    flowLayout.itemSize = CGSize(width: cellWidth, height: cellWidth)
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-02-05T10:09:38.230

它全都与您要绘制的布局有关。您可以创建从 UICollectionViewFlowLayout 继承的自定义类。目前没有任何直接的方法来设置列。如果你想实现这种功能，你需要手动完成。您需要在自定义流布局类中处理它。

现在将出现问题，您将如何做到这一点？如果您不想打扰单元格框架，您可以调整

```
 collectionView:layout:minimumInteritemSpacingForSectionAtIndex:
 collectionView:layout:minimumLineSpacingForSectionAtIndex: 
```

另一种方法是为您提供自己的单元格位置。通过覆盖以下两种方法，它们将在您的布局形成期间被调用。

```
 - (NSArray*)layoutAttributesForElementsInRect:(CGRect)rect
  - (UICollectionViewLayoutAttributes *)layoutAttributesForItemAtIndexPath:(NSIndexPath *)path 
```

UICollectionViewLayoutAttributes 是处理单元格位置、框架、Zindex 等的类

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-03-18T13:53:35.170

首先添加**UICollectionViewDelegateFlowLayout**作为协议。

然后：

```
func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, sizeForItemAt indexPath: IndexPath) -> CGSize
{
        var columnCount = 3
        let width  = (view.frame.width - 20) / columnCount
        return CGSize(width: width, height: width)
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-12-14T16:41:45.503

这个答案适用于 swift 3.0 -->

首先符合协议：

```
 UICollectionViewDelegateFlowLayout 
```

然后添加这些方法：

```
 //this method is for the size of items      
    func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, sizeForItemAt indexPath: IndexPath) -> CGSize {
        let width = collectionView.frame.width/3
        let height : CGFloat = 160.0
        return CGSize(width: width, height: height)
    }
    //these methods are to configure the spacing between items

    func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, insetForSectionAt section: Int) -> UIEdgeInsets {
        return UIEdgeInsetsMake(0,0,0,0)
    }

    func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, minimumInteritemSpacingForSectionAt section: Int) -> CGFloat {
        return 0
    }

    func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, minimumLineSpacingForSectionAt section: Int) -> CGFloat {
        return 0
    } 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-10-17T06:40:59.207

我只是想附加到 Imanou Petit 的答案 #2。为了确保无论屏幕宽度如何，边距都是准确的，我使用具有所需边距的迭代求解器，并将列数作为输入。我还添加了一个方向标志，用于将它们的最终边距与目标进行比较。

迭代求解器如下所示，并返回 cellWidth 和 margin。

```
private func iterativeCellSpacing(targetMargins : CGFloat,
                                  cellsPerRow : Int,
                                  isMinTarget : Bool) -> (CGFloat, CGFloat)
{
    var w : CGFloat = 0
    var m : CGFloat = targetMargins
    let cols : CGFloat = CGFloat(cellsPerRow)

    let numMargins : CGFloat = cols + 1.0
    let screenWidth : CGFloat = collectionView!.bounds.size.width

    var delta = CGFloat.greatestFiniteMagnitude
    while abs(delta) > 0.001
    {
        let totalMarginSpacing = numMargins * m
        let totalCellSpacing = screenWidth - totalMarginSpacing

        if (isMinTarget)
        {
            w = floor(totalCellSpacing / cols)
            m = ceil((screenWidth - cols * w) / numMargins)
        }
        else
        {
            w = ceil(totalCellSpacing / cols)
            m = floor((screenWidth - cols * w) / numMargins)
        }

        delta = screenWidth - w * CGFloat(cellsPerRow) - m * numMargins
    }

    return (w, m)
} 
```

我这样称呼它：

```
fileprivate var margin: CGFloat = 20
fileprivate var cellWidth : CGFloat = 80
fileprivate let cellsPerRow = 4

override func viewDidLoad()
{
    super.viewDidLoad()

    (cellWidth, margin) = iterativeCellSpacing(targetMargins: margin, cellsPerRow: 4, isMinTarget: true)
    ...
} 
```

然后，我将 cellWidth 和边距值应用于流布局，如下所示：

```
extension MyCollectionController : UICollectionViewDelegateFlowLayout 
```

{ func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, sizeForItemAt indexPath: IndexPath) -> CGSize { return CGSize(width: cellWidth, height: cellWidth) }

```
override func viewWillTransition(to size: CGSize, with coordinator: UIViewControllerTransitionCoordinator) {
    collectionView?.collectionViewLayout.invalidateLayout()
    super.viewWillTransition(to: size, with: coordinator)
}

func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, insetForSectionAt section: Int) -> UIEdgeInsets
{
    return UIEdgeInsetsMake(margin, margin, margin, margin)
}

func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, minimumLineSpacingForSectionAt section: Int) -> CGFloat
{
    return margin
}

func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, minimumInteritemSpacingForSectionAt section: Int) -> CGFloat
{
    return margin
} 
```

}

希望这可以帮助。可能有一种更简单的方法可以确保边距准确，但这是一种方法。此外，此代码尚未针对允许旋转集合视图的设备进行测试。

谢谢，

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-12-05T02:27:59.887

我做了一个集合布局。

要使分隔符可见，请将集合视图的背景颜色设置为灰色。每节一排。

用途：

```
let layout = GridCollectionViewLayout()
layout.cellHeight = 50 // if not set, cellHeight = Collection.height/numberOfSections
layout.cellWidth = 50  // if not set, cellWidth = Collection.width/numberOfItems(inSection)
collectionView.collectionViewLayout = layout 
```

布局：

```
import UIKit

class GridCollectionViewLayout: UICollectionViewLayout {

var cellWidth : CGFloat = 0
var cellHeight : CGFloat = 0
var seperator: CGFloat = 1

private var cache = [UICollectionViewLayoutAttributes]()

override func prepare() {

    guard let collectionView = self.collectionView else {
        return
    }

    self.cache.removeAll()

        let numberOfSections = collectionView.numberOfSections

        if cellHeight <= 0
        {
            cellHeight = (collectionView.bounds.height - seperator*CGFloat(numberOfSections-1))/CGFloat(numberOfSections)
        }

        for section in 0..<collectionView.numberOfSections {

            let numberOfItems = collectionView.numberOfItems(inSection: section)

            let cellWidth2 : CGFloat
            if cellWidth <= 0
            {
                cellWidth2 = (collectionView.bounds.width - seperator*CGFloat(numberOfItems-1))/CGFloat(numberOfItems)
            }
            else
            {
                cellWidth2 = cellWidth
            }

            for row in 0..<numberOfItems {

                let indexPath = NSIndexPath(row: row, section: section)

                let attributes = UICollectionViewLayoutAttributes(forCellWith: indexPath as IndexPath)
                attributes.frame = CGRect(x: (cellWidth2+seperator)*CGFloat(row),
                                          y: (cellHeight+seperator)*CGFloat(section),
                                          width: cellWidth2,
                                          height: cellHeight)

                //row_temp.append(attributes)

                self.cache.append(attributes)
            }
            //self.itemAttributes.append(row_temp)
        }

}

override var collectionViewContentSize: CGSize {

    guard let collectionView = collectionView else
    {
        return CGSize.zero
    }

    if (collectionView.numberOfSections <= 0)
    {
        return collectionView.bounds.size
    }

    let width:CGFloat
    if cellWidth <= 0
    {
        width = collectionView.bounds.width
    }
    else
    {
        width = cellWidth*CGFloat(collectionView.numberOfItems(inSection: 0))
    }

    let numberOfSections = CGFloat(collectionView.numberOfSections)
    var height:CGFloat = 0
    height += numberOfSections * cellHeight
    height += (numberOfSections - 1) * seperator

    return CGSize(width: width, height: height)
}

override func layoutAttributesForElements(in rect: CGRect) -> [UICollectionViewLayoutAttributes]? {

    var layoutAttributes = [UICollectionViewLayoutAttributes]()

    for attributes in cache {
        if attributes.frame.intersects(rect) {
            layoutAttributes.append(attributes)
        }
    }
    return layoutAttributes
}

override func layoutAttributesForItem(at indexPath: IndexPath) -> UICollectionViewLayoutAttributes? {
    return cache[indexPath.item]
}
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-04-19T13:40:02.357

完美的解决方案是使用 UICollectionViewDelegateFlowLayout 但是你可以很容易地计算单元格宽度并划分你想要的列数

棘手的是使宽度没有分数

```
(UICollectionViewLayout*)collectionViewLayout sizeForItemAtIndexPath:(NSIndexPath *)indexPath

{
 CGFloat screenWidth = self.view.frame.size.width;
   CGFloat marginWidth = (screenWidth - collectionView.frame.size.width);

   CGFloat cellWith = (collectionView.frame.size.width - marginWidth )/3;
   cellWith= floorf(cellWith);

  CGSize retval = CGSizeMake(cellWith,cellWith);

  return retval;} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-02-08T09:08:10.713

试试这个，它对我来说很完美，

**请按照以下步骤操作：**

**1\. 在 .h 文件中定义值。**

```
 #define kNoOfColumsForCollection 3
     #define kNoOfRowsForCollection 4
     #define kcellSpace 5
     #define kCollectionViewCellWidth (self.view.frame.size.width - kcellSpace*kNoOfColumsForCollection)/kNoOfColumsForCollection
     #define kCollectionViewCellHieght (self.view.frame.size.height-40- kcellSpace*kNoOfRowsForCollection)/kNoOfRowsForCollection 
```

**或者**

```
 #define kNoOfColumsForCollection 3
  #define kCollectionViewCellWidthHieght (self.view.frame.size.width - 6*kNoOfColumsForCollection)/kNoOfColumsForCollection 
```

**2.在集合视图布局数据源方法中添加代码如下，**

```
 #pragma mark Collection View Layout data source methods
// collection view with autolayout

- (CGFloat)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout minimumLineSpacingForSectionAtIndex:(NSInteger)section
{
return 4;
}

- (CGFloat)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout minimumInteritemSpacingForSectionAtIndex:(NSInteger)section
 {
 return 1;
}

- (UIEdgeInsets)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout insetForSectionAtIndex:(NSInteger)section
{
return UIEdgeInsetsMake(4, 4, 4, 4);
}
- (CGSize)collectionView:(UICollectionView *)collectionView
              layout:(UICollectionViewLayout *)collectionViewLayout
   sizeForItemAtIndexPath:(NSIndexPath *)indexPath
{
 return 
 CGSizeMake(kCollectionViewCellWidth,kCollectionViewCellHieght);
 // CGSizeMake (kCollectionViewCellWidthHieght,kCollectionViewCellWidthHieght);
} 
```

希望这对某人有所帮助。

# actionscript-3 - 在 AS3 中更改宽度和高度后，MovieClip 消失

> ID：14674991
> 
> 赞同：2
> 
> 时间：2013-02-03T17:12:53.717
> 
> 标签：actionscript-3, flash, flash-cs5, flashdevelop

我正在尝试从 as3 中的 url 加载图像，如下所示：

```
var myImageLoader:Loader = new Loader();
private var mcImage: MovieClip = new MovieClip();
var myImageLocation:URLRequest = new URLRequest("http://example.com/xyz.jpg");
myImageLoader.load(myImageLocation);
mcImage.addChild(myImageLoader);
mcImage.x = 100;
mcImage.y = 100;
//mcImage.width = 50;
//mcImage.height = 50;
addChild(mcImage); 
```

上面的代码工作正常，但是由于我想要的图像与原始图像相比具有不同的大小，因此这里需要更改其大小。因此，在使用上面代码中注释的行之后，mcImage 消失了。

我尝试使用**mcImage.scaleX =myImageLoader.width/50**，但由于 myImageLoader 没有在开始时加载，我们无法获得 myImageLoader 的宽度为空。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T17:27:06.550

这是设置尺寸时经常出现的错误，您无法设置空显示对象的尺寸（宽度和高度为零的对象）。要设置显示对象的大小，您首先需要在其上绘制一些东西`graphics`（例如 1*1 px 矩形），但您应该了解，在它之后您只会相对于其原始大小缩放显示对象，例如如果您绘制 1 *1 px 矩形并设置=height=50，scaleX 和 scaleY 为 50，所以如果我们说加载器，您加载的图像将是巨大的尺寸:) 这都是关于闪存中的大小。

你的任务呢：有一个共同的规则 -*不要调整加载器的大小，调整加载的图像大小*。正如我上面所说，调整加载器的大小只会缩放你的图像而不是设置它的大小。添加完整的处理程序并根据需要调整 loader.content 的大小。

例子：

```
public function astest()
{
    var loader:Loader = new Loader();
    loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onComplte);
    addChild(loader);

    loader.load(new URLRequest("https://www.google.ru/images/srpr/logo3w.png"));
}

protected function onComplte(event:Event):void
{
    EventDispatcher(event.target).removeEventListener(event.type, arguments.callee);
    var image:DisplayObject = (event.target as LoaderInfo).content;

    image.width = 50;
    image.height = 50;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:37:51.247

尝试这个：

```
var myImageLoader:Loader = new Loader();
//hide until loaded
myImageLoader.visible = false;
//listen for load completed
myImageLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, completeHandler);
//...rest of your code (without setting width/height) 
```

然后添加它以调整大小并在加载时显示：

```
function completeHandler(event:Event):void
{
    myImageLoader.contentLoaderInfo.removeEventListener(Event.COMPLETE, completeHandler);
    myImageLoader.content.width = 50;
    myImageLoader.content.height = 50;
    myImageLoader.visible = true;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T17:31:06.427

在玩 MC 之前，您需要在加载程序上获取 loadComplete 事件

```
var myImageLoader:Loader = new Loader();
private var mcImage: MovieClip = new MovieClip();
var myImageLocation:URLRequest = new URLRequest("http://example.com/xyz.jpg");

myImageLoader.addEventListener(Event.COMPLETE, completeHandler);
myImageLoader.load(myImageLocation);

function completeHandler(e:Event){
    mcImage.x = 100;
    mcImage.y = 100;
    mcImage.width = 50;
    mcImage.height = 50;
    addChild(mcImage);
    mcImage.addChild(myImageLoader);
} 
```

# jquery - jQuery FileUpload 不会触发“完成”

> ID：14674999
> 
> 赞同：21
> 
> 时间：2013-02-03T17:13:49.123
> 
> 标签：jquery, jquery-file-upload, blueimp

我使用[jQuery-File-Upload](https://github.com/blueimp/jQuery-File-Upload)插件。我写了一个简单的代码来测试它——它可以工作，但并非没有问题。它不会触发`done`，即使文件已上传并且进度条已结束。

这是代码：

```
$('#file_file').fileupload({
    dataType: 'json',
    autoUpload: true,
    add: function (e, data) {
        data.context = $('<p/>').text('Uploading...').appendTo(document.body);
        data.submit();
    },
    progressall: function (e, data) {
        var progress = parseInt(data.loaded / data.total * 100, 10);
        $('#progress .bar').css(
            'width',
            progress + '%'
        );
    },
    done: function (e, data) {
        alert('Done');
    }
}); 
```

我的输入就这么简单：

```
<input type="file" id="file_file" name="file[file]" /> 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-08-09T22:34:27.010

如果您的服务器没有返回 JSON，请尝试删除：

```
dataType: 'json' 
```

否则，您可能会以失败事件告终，这很容易测试：

```
fail: function(e, data) {
  alert('Fail!');
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-03T18:06:40.080

我改变了几件事，它的工作原理。这里：

```
$('#file_file').fileupload({
    autoUpload: true,
    add: function (e, data) {
        $('body').append('<p class="upl">Uploading...</p>')
        data.submit();
    },
    progressall: function (e, data) {
        var progress = parseInt(data.loaded / data.total * 100, 10);
        $('#progress .bar').css(
            'width',
            progress + '%'
        );
    },
    done: function (e, data) {
        $('.upl').remove();
        $.each(data.files, function (index, file) {
            /**/
        });
    }
}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-05-29T09:47:15.953

我用**autoUpload: true**修复，看起来当 autoUpload 属性未设置时（即使上传按预期工作），完成事件也不会被触发。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-06-08T12:35:34.570

今天实验了！如果您使用的是 PHP，请确保您的`uploadhanler`PHP 文件不显示错误或警告。它会创建一个错误的 JSON 输出，当您的文件上传时，插件无法发送带有完成事件的正确 JSON 缓冲区。

对于 PHP 文件的错误跟踪，最好编写一个日志文件，而不是在此类脚本上显示错误。您可以使用：

```
error_reporting(0) 
```

但**不要忘记**在日志文件中添加错误跟踪。当然 ！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-18T17:40:56.973

按照文档中的说明尝试[此回调选项](https://github.com/blueimp/jQuery-File-Upload/wiki/Options#callback-options)：

```
$('#fileupload').bind('fileuploaddone', function (e, data) {
    alert('Done');
}); 
```

它确实对我有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-21T17:24:50.600

我正在使用 multer、multer-azure-storage 和 blueimp-file-upload。全部来自 unpkg.com。下面是使用完成触发器的多文件上传。截至 2017 年 10 月 22 日工作。

.js 文件：

```
 <script src="https://unpkg.com/jquery@3.2.1/dist/jquery.min.js"></script>
  <script src="https://unpkg.com/blueimp-file-upload@9.19.1/js/vendor/jquery.ui.widget.js"></script>
  <script src="https://unpkg.com/blueimp-file-upload@9.19.1/js/jquery.iframe-transport.js"></script>
  <script src="https://unpkg.com/blueimp-file-upload@9.19.1/js/jquery.fileupload.js"></script> 
```

页面 html，由 express 提供：

```
 $('#fileupload').fileupload({
          url: 'https://domainwhatevs/my-listings/edit/[property id]/gallery',
          paramName: '_file',
          dataType: 'json',
          type: 'POST',
          autoUpload: true,
          add: function (e, data) {
              console.log('uploading:', data)
              data.submit();
          },
          done: function (e, data) {
              console.log('done triggered');
              console.log(data._response.result.result[0].originalname, 'uploaded at', data._response.result.result[0].url);
              $.each(data.files, function (index, file) {
                // console.log(file.name, 'uploaded.')
                // console.log('done');
                // console.log(index);
                // console.log(file);
              });
              console.log(data);
          }
      }); 
```

// GET /my-listings/edit/[属性 id]/gallery

```
app.get(
    [
        '/my-listings/edit/:_id/gallery'
    ],
    (req, res) => {
        console.log('image gallery:', req.params._id);
        res.render('my-listings--edit--gallery', {
            _id: req.params._id,
            session: req.session
        });
    }
); 
```

// POST /my-listings/edit/[属性 id]/gallery

```
 app.post(
    [
        '/my-listings/edit/:_id/gallery'
    ],
    upload.array('_file'),
    (req, res, next) => {
        console.log(req.files);
        res.setHeader('Content-Type', 'application/json');
        res.send({result: req.files});
        next();
    }
); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-04-09T09:32:23.197

我想这不再是一个热门话题，但我刚刚通过使用**always**回调而不是**done**回调解决了这个问题。[此处](https://github.com/blueimp/jQuery-File-Upload/wiki/Options#callback-options)描述了此回调

代码的相关部分现在如下所示：

```
$('#fileupload').fileupload({
        dataType: 'json',
        autoUpload: true,
        url: 'transit/',
        always: function (e, data) {
        moveFile();
    },

    progressall: function (e, data) {
    var progress = parseInt(data.loaded / data.total * 100, 10);
    $('#progress .progress-bar').css('width', progress + '%'
    );
  }

}); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-02-03T17:53:36.133

```
 $(input).fileupload(

       url      : '...'

      ,dataType : 'json'
      ,sequentialUploads : true

       ,add      : function (e,data) {

           $.each(data.files,function(i,file){

                file.jqXHR = data.submit()
                           .success(function (result, textStatus, jqXHR) {/* ... */})
                           .error(function (jqXHR, textStatus, errorThrown) {
                             })
                           .complete(function (result, textStatus, jqXHR) { 
                               //...                   
                                     });

                 });
       }

       ,done: function (e, data) {
         console.log(data);

       }

   }); 
```

非常适合我；

差异是

*   url 已设置（我希望你只是忘了把它放在你的代码片段中）；

*   我将文件添加到下载队列的方式

*   顺序上传（？）

编辑 ：

> jQuery File Upload 插件使用 jQuery.ajax() 来处理文件上传请求。由于 iframe 传输插件，即使对于不支持 XHR 的浏览器也是如此。
> 
> 为文件上传插件设置的选项被传递给 jQuery.ajax() 并允许定义任何 ajax 设置或回调。ajax 选项 processData、contentType 和 cache 设置为 false 以使文件上传正常工作，不应更改。

[https://github.com/blueimp/jQuery-File-Upload/wiki/Options](https://github.com/blueimp/jQuery-File-Upload/wiki/Options)

在您的代码中的某个地方，您也可以更改那些 ajax 设置；无论如何，如果你的设置正确，因为它使用 $.ajax 就不能不触发完成