# StackOverflow 问答 14270000-14270999

# c# - 当某些导航键可以为空时，如何将实体框架导航属性与 MySqlConnector 一起使用？

> ID：14270002
> 
> 赞同：0
> 
> 时间：2013-01-11T00:58:02.957
> 
> 标签：c#, entity-framework-5, mysql-connector

这是一个示例设置：

```
public class Car
{
 public int CarId { get; set; }
 public int? PreviousOwnerId { get; set; }
 public PreviousOwner PreviousOwner { get; set; }
}

public PreviousOwner
{
 public int PreviousOwnerId { get; set; }
 public string Name { get; set; }
} 
```

然后是查询：

```
var cars = db.Cars.Where( c => c.PreviousOwner.Name = "Stack" ).ToList(); 
```

但是，我收到一个错误，因为有些汽车有一个 null `PreviousOwnerId`。内部异常读取`"Unknown column 'Extent1.PreviousOwnerId' in 'where clause'"`.

注意：这是使用 .net mysql 连接器

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-11T01:04:09.970

您在这里遇到的问题是您的导航属性似乎没有足够的配置信息。（例如模型构建器配置或属性配置）在为 PK/Fks 使用非标准名称时需要。我建议在这里阅读我关于导航属性如何工作的文章：http: [//blog.staticvoid.co.nz/2012/7/17/entity_framework-navigation_property_basics_with_code_first](http://blog.staticvoid.co.nz/2012/7/17/entity_framework-navigation_property_basics_with_code_first)

我想您将需要以下内容（示例使用模型构建器）：

```
modelBuilder.Entity<Car>().HasOptional(c=>c.PreviousOwner).WithMany().HasForeignKey(c=>c.PreviousOwnerId); 
```

# c# - 有条件地调用 JavaScript 函数

> ID：14270003
> 
> 赞同：3
> 
> 时间：2013-01-11T00:58:09.363
> 
> 标签：c#, javascript, asp.net

我有一个“支付”按钮，我们开始接受信用卡。我需要从服务器端点击事件调用 Javascript 函数。我尝试使用 Response.Write 如下，但这不会触发我在单独的 .js 文件中定义的函数。我还可以做些什么？

```
 protected void btmMakePayment_Click(object sender, EventArgs e)
        {            
            if (user selected credit card)
            {
                Response.Write("<script language='javascript' type='text/javascript'>OpenPayPalDialog();</script>");
            }
            else
            {
                continue with the current server side logic
            }
       } 
```

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T01:01:42.687

使用[ClientScriptManager.RegisterStartupScript](http://msdn.microsoft.com/en-us/library/asz8zsxy.aspx)，它注册一个 JavaScript 块以在页面加载时执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T01:31:11.977

您可以使用 ScriptManager.RegisterClientScriptBlock 来调用 JS 事件：

```
ScriptManager.RegisterClientScriptBlock(this, typeof(this), "JSKey", "JSFunctionName(<param>);", true); 
```

# jquery - 表单未在函数 jquery 内提交

> ID：14270007
> 
> 赞同：0
> 
> 时间：2013-01-11T00:58:39.193
> 
> 标签：jquery, html, sql, asp-classic, ado

我有一些 jquery 代码在用户完成输入时执行函数 doneTyping，这适用于任何代码。但是当我尝试使用“$('#searchf').submit();”提交表单时 表单不提交。我已经尝试了很多变化。

有谁知道为什么它不起作用？- 下面的jQuery代码

```
<script>
$(document).ready(function() {
    $("#cat").change(function () {
    this.form.submit();
})

var typingTimer;                //timer identifier
var doneTypingInterval = 1000;  //time in ms, 5 second for example

//on keyup, start the countdown
$('#legal').keyup(function(){
    clearTimeout(typingTimer);
    if ($('#legal').val) {
        typingTimer = setTimeout(doneTyping, doneTypingInterval);
    }
});

//user is "finished typing," do something
function doneTyping () {
    $('#searchf').submit();
     alert("Your book is overdue.");
}

});
</script> 
```

页码

```
<%@ LANGUAGE="VBSCRIPT" %>
<%
pagetitle="Contractor Details"
%>
<!--#INCLUDE VIRTUAL="/_lib/include/header.htm"-->
<!--#INCLUDE VIRTUAL="/_lib/include/menu.htm"-->
<script>
$(document).ready(function() {
    $("#cat").change(function () {
    this.form.submit();
})

var typingTimer;                //timer identifier
var doneTypingInterval = 1000;  //time in ms, 5 second for example

//on keyup, start the countdown
$('#legal').keyup(function(){
    clearTimeout(typingTimer);
    if ($('#legal').val) {
        typingTimer = setTimeout(doneTyping, doneTypingInterval);
    }
});

//user is "finished typing," do something
function doneTyping () {
    $('#searchf').submit();
     alert("Your book is overdue.");
}

});
</script>
<div class="twoColumnRow">
<div class="twoColumnContent">
<p class="breadCrm"><a href="/index.htm">Home</a> <span>&gt;</span> <a href="/tools/index.htm">Tools of the Trade</a> <span>&gt;</span> <a href="/tools/finance/index.htm">Finance and Purchasing</a><span>&gt;</span> <a href="/tools/finance/procurement/index.htm">Procurement and Contracts information</a></p>
<div class="contentPad">
<!-- Start of main content -->

<p class="imageRight">&nbsp;</p>
<h1><%=pagetitle%></h1>

<%
        Dim connectString, connect, conDB, sconDB, lDB, con, scon, lcon, src_abn, src_cat
        connectString = "Driver={Microsoft Text Driver (*.txt; *.csv)}; DBQ=" & Server.MapPath("data")
              src_legal = Request.QueryString("legal")
              src_cat = Request.QueryString("cat")
        set connect = Server.CreateObject("ADODB.connection")
        connect.open connectString

        if src_cat = "all" then
        conDB = "SELECT * FROM cont.csv WHERE ucase(legal) LIKE ucase('%"+src_legal+"%')"   
        lDB = "SELECT * FROM cont.csv WHERE ucase(legal) LIKE ucase('%"+src_legal+"%')" 
        else 
        conDB = " SELECT * FROM cont.csv WHERE " & src_cat & " = 'Yes' AND ucase(legal) LIKE ucase('%"+src_legal+"%')"
        lDB = " SELECT * FROM cont.csv WHERE " & src_cat & " = 'Yes' AND ucase(legal) LIKE ucase('%"+src_legal+"%')"
        end if

        sconDB = "SELECT * FROM cont.csv"   

        set con = connect.execute(conDB)
        set scon = connect.execute(sconDB)
        set lcon = connect.execute(lDB)
%>
<h2>Search results</h2>
<% if not con.BOF then %>
<div style="margin-top:1em">

  <form i="searchf" action="dbinstant.htm" method="get">

      <p>Company name:1<br/>
      <input id="legal" name="legal" type="text" value="<%=src_legal%>">
      </p>
     <p>Categories for Creative Design:<br/>
      <select id="cat" name="cat">
        <option class="group" label="All categories" value="all" <%if request.querystring("cat") = "all" then response.write("selected") %>></option>
        <option class="group" label="Strategic brand, marketing and communications advice" value="a" <%if request.querystring("cat") = "a" then response.write("selected") %>></option>
        <option class="group" label="Graphic design and layout" value="b" <%if request.querystring("cat") = "b" then response.write("selected") %>></option>
        <option class="group" label="Forms design" value="c" <%if request.querystring("cat") = "c" then response.write("selected") %>></option>
        <option class="group" label="Web design and development" value="d" <%if request.querystring("cat") = "d" then response.write("selected") %>></option>
        <option class="group" label="Authoring services" value="e" <%if request.querystring("cat") = "e" then response.write("selected") %>></option>
        <option class="group" label="Editorial services" value="f" <%if request.querystring("cat") = "f" then response.write("selected") %>></option>
        <option class="group" label="Translation services" value="g" <%if request.querystring("cat") = "g" then response.write("selected") %>></option>
        <option class="group" label="Photography and film services" value="h" <%if request.querystring("cat") = "h" then response.write("selected") %>></option>
        <option class="group" label="Scanning and digitisation services" value="i" <%if request.querystring("cat") = "i" then response.write("selected") %>></option>
        <option class="group" label="Multimedia editing services" value="j" <%if request.querystring("cat") = "j" then response.write("selected") %>></option>
      </select>
    </p>
    <input type="submit" value="Search" />
  </form>
  <br />

    <table style="font-size:.9em;" class="contentTable">
          <tr>
                <th>ABN:</th>
                <th>Company Name:</td>
          </tr>
  <% con.Movefirst() %>
  <% while (NOT con.EOF) %>
          <tr>
                <td width="120px"><%=con("abn")%></th>
                <td><a href="dbcomp.htm?abn=<%=con("abn")%>&cat=all"><%=con("legal")%></a></td>
          </tr>
  <%
    con.MoveNext()
    Wend
  %>
</table>

</div>
<% else %>
    <% scon.Movefirst() %>
  <form action="dbinstant.htm" method="get">

      <p>Company name:2<br/>
      <input id="legal" name="legal" type="text">
      </p>

     <p>Categories for Creative Design:<br/>
      <select id="cat" name="cat">
        <option class="group" label="All categories" value="all" <%if request.querystring("cat") = "all" then response.write("selected") %>></option>
        <option class="group" label="Strategic brand, marketing and communications advice" value="a" <%if request.querystring("cat") = "a" then response.write("selected") %>></option>
        <option class="group" label="Graphic design and layout" value="b" <%if request.querystring("cat") = "b" then response.write("selected") %>></option>
        <option class="group" label="Forms design" value="c" <%if request.querystring("cat") = "c" then response.write("selected") %>></option>
        <option class="group" label="Web design and development" value="d" <%if request.querystring("cat") = "d" then response.write("selected") %>></option>
        <option class="group" label="Authoring services" value="e" <%if request.querystring("cat") = "e" then response.write("selected") %>></option>
        <option class="group" label="Editorial services" value="f" <%if request.querystring("cat") = "f" then response.write("selected") %>></option>
        <option class="group" label="Translation services" value="g" <%if request.querystring("cat") = "g" then response.write("selected") %>></option>
        <option class="group" label="Photography and film services" value="h" <%if request.querystring("cat") = "h" then response.write("selected") %>></option>
        <option class="group" label="Scanning and digitisation services" value="i" <%if request.querystring("cat") = "i" then response.write("selected") %>></option>
        <option class="group" label="Multimedia editing services" value="j" <%if request.querystring("cat") = "j" then response.write("selected") %>></option>
      </select>
    </p>
    <input type="submit" value="Search" />
  </form>
  <br /><hr />
<p>No records match your query.</p>
<p><a href="dbtest.htm">Return to search page</a></p>
<%
  end if
  con.close
%>

<!-- End of main content -->
</div> <!-- end contentPad div -->
</div> <!-- end twocolumncontent div -->
<div class="twoColumnLinks">

<!--<div class="relatedLinks">
<h3>Related Links</h3>
<ul>
<li><a href="/index.htm">Related link 1</a></li>
</ul>
</div>--> <!-- end relatedlinks div -->
<!--#INCLUDE VIRTUAL="/_lib/include/quicklinks.htm"-->
<!--#INCLUDE VIRTUAL="/_lib/include/mylinks.htm"-->
</div> <!-- end twocolumnlinks div -->
</div> <!-- end twocolumnrow div -->
<!--#INCLUDE VIRTUAL="/_lib/include/footer.htm"--> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T01:10:40.123

`this.form`将始终`undefined`在您的上下文中，因为您从未设置它。

```
this.form
  ↑   ↑
  |   └── 'form' is seen as a property of the 'window' object
  └── this is the 'window' object 
```

你可能想要“说”的是

```
$("#cat").change(function () {
    $(this).form.submit();
}); 
```

但即使这样也会导致`not a property`异常，因为`form`它不是`$("#cat")`...的属性或对象

因此，为了让您更轻松，而不是`this.form.submit();`将其更改为：

```
$("form").submit(); 
```

或具体（当您在页面中有多个表单时）

```
<form id="form1" ... >

$("#form1").submit(); 
```

即使页面中没有多个`<form>`，使用第二种方法总是一个好习惯！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T01:18:08.557

我认为您只是输入了表单标签的 id 错误。

在您的代码中：

```
<form i="searchf" action="dbinstant.htm" method="get"> 
```

正确的：

```
<form id="searchf" action="dbinstant.htm" method="get"> 
```

# javascript - 在导航到外部站点 URL ASP.NET 之前提醒用户

> ID：14270010
> 
> 赞同：0
> 
> 时间：2013-01-11T00:58:50.733
> 
> 标签：javascript, asp.net, url, navigation, external

处理主要具有几个母版页的 ASP.NET 应用程序，这些母版页控制应用程序中的其余页面和用户控件。我们收到来自客户的请求，希望在用户尝试导航到任何其他外部站点时警告用户。例如，如果我们的应用程序是 www.abc.com，如果它们位于 abc.com/user、abc.com/payment 等，并且他们要键入 www.yahoo.com 并尝试离开，我们需要能够提醒用户他们正在从应用程序导航到其他站点。我们正在寻找一种方法来通过 Javascript（如果可能）或任何其他替代 .NET 方式来完成此任务。在最坏的情况下，我们甚至可以考虑使用 3rd 方工具（虽然不是首选）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:10:09.200

您需要处理 javascript**窗口**对象事件。谷歌 DOM 事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T01:44:21.660

我做过类似的工作，但在 IE 中工作。尽管该解决方案尚未经过验证，但对我有用。解决方案只是 window.onbeforeunload 事件上的 JS 函数。基本上我们需要在这里考虑两件事：

1.  如果用户在我们的网站区域之外点击意味着后退/前进按钮或关闭浏览器等 - window.event.clientY 将为负数。
2.  如果我们的网站显示一些弹出窗口，请忽略它们，因为它是我们网站的一部分。

{

```
 window.onbeforeunload = function (e) 
 {

  var currUrl = document.URL;
  e = e || window.event;
  var y = e.pageY || e.clientY;

 if (y < 0) 
 { 
   //call session end logic here
   //check URL in case you have popup windows in your website
   if (currUrl.indexOf('<popuppagename.aspx') >= 0 || ...)
     return;
   else
    //user is navigating away so show alert
  }
 } 
```

# javascript - 展平使用 d3.js 嵌套创建的对象层次结构

> ID：14270011
> 
> 赞同：8
> 
> 时间：2013-01-11T00:58:52.247
> 
> 标签：javascript, d3.js

我正在尝试以如下方式可视化团队协作数据：

![显示每个团队和每周的不同协作工件类型的份额的图表](../Images/b2ad8e8a2df7c0c0b86a57f24f8bb0b6.png)

图表中不同的颜色代表不同的协作工件类型。

来自源的数据如下所示：

```
var json = [
    {
        "teamLabel": "Team 1",
        "created_date": "2013-01-09",
        "typeLabel": "Email"
        "count": "5"
    },
    {
        "teamLabel": "Team 1",
        "created_date": "2013-01-10",
        "typeLabel": "Email"
        "count": "7"
    },
    /* and of course, a lot more data of this kind */
] 
```

请注意，数据是针对单日给出的。所以对于上面的可视化，我需要先根据一年中的星期来聚合数据。不过，团队名称和工件类型需要保留并用作分组属性。这是代码：

```
// "2013-01-09"
var dateFormat = d3.time.format.utc("%Y-%m-%d");

// "2013-02" for the 2nd week of the year
var yearWeek = d3.time.format.utc("%Y-%W");

var data = d3.nest().key(function(d) {
        return d.teamLabel;
    }).key(function(d) {
        var created_date = dateFormat.parse(d.created_date);
        return yearWeek(created_date);
    })
    .key(function(d) {
        return d.typeLabel;
    }).rollup(function(leaves) {
        return d3.sum(leaves, function(d) {
                return parseInt(d.count);    // parse the integer
            });
        }
    )
    .map(json); 
```

这会产生基于嵌套键的对象层次结构。我没有看到如何从中创建上面的图表，所以我宁愿寻找一种方法来转换`data`为以下结构：

```
[
    // This list contains an element for each donut
    {
        "teamLabel": "Team 1",
        "createdWeek": "2013-02",
        "values": [
            // This list contains one element for each type we found
            {
                "typeLabel": "Email",
                "count": 12
            },
            {
            ...
            }
        ]
    },
    {
    ...
    }
] 
```

这样，我可以分别使用`createdWeek`和`teamLabel`来进行 x 轴和 y 轴上的定位，并且`values`可以将下面的信息传递给`d3.layout.pie()`.

有没有一种干净的方法来进行这种数据转换？如果您需要任何澄清或更多细节，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-22T12:40:26.157

这就是你的做法：

```
var flat = data.entries().map(function(d){
    return d.value.entries().map(function(e){
        return {
            "teamLabel": d.key,
            "createdWeek": e.key,
            "values": e.value.entries().map(function(f){
                return {"typeLabel": f.key, "count": f.value}
            })
        }
    })
}).reduce(function(d1,d2){ return d1.concat(d2) },[]); 
```

请注意，我使用 d3.map 而不是标准的 javascript 对象来使用 map.entries() 辅助函数。我想这就是您尝试使用的事实来判断的：

```
.map(json); // whereas I used .map(json, d3.map) 
```

代替

```
.entries(json); 
```

jsFiddle 链接在这里：

[http://jsfiddle.net/RFontana/KhX2n/](http://jsfiddle.net/RFontana/KhX2n/)

# scala - 文字函数的隐式参数

> ID：14270012
> 
> 赞同：4
> 
> 时间：2013-01-11T00:58:59.663
> 
> 标签：scala, playframework-2.0, implicit

在阅读播放！框架文档，我遇到了这个片段：

```
def index = Action { implicit request =>
  session.get("connected").map { user =>
    Ok("Hello " + user)
  }.getOrElse {
    Unauthorized("Oops, you are not connected")
  }
} 
```

[文档](http://www.playframework.org/documentation/2.0.4/ScalaSessionFlash)在那里解释`implicit`：

> 或者，您可以从请求中隐式检索 Session

此外，我读了这篇文章：[Literal with Implicit](https://stackoverflow.com/questions/6326132/scala-functional-literals-with-implicits)从逻辑上讲，函数不能有隐式参数。

如果我想通了，这是因为与**方法**相反的**函数**总是有一个契约（接口）。

 **实际上，例如，`Function1[Int, Function1[Int, Int]]`作为返回类型的第一个参数 an `Int`，因此阻止我们将其注释为`implicit`。这将导致对其高级返回类型的混淆：`() => Int`或`Int => Int` ...

因此，前面的代码片段的行为是隐式的，因为 first`Action`的必需参数是一个文字函数。

我猜允许编译器接受此代码的原因是`Action.apply()`方法的多重签名：

*   `def apply(block: Request[AnyContent] => Result): Action[AnyContent]`
*   `def apply(block: => Result): Action[AnyContent]`（重定向到第一个）

由于第二个不需要某些参数，因此是否在存在文字函数的隐式参数的情况下选择了这个？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T01:18:03.860

考虑以下代码：

```
class MyImplicitClass(val session: Int)
object Tester {
  def apply(fun: MyImplicitClass => Int): Int = ???
  def apply(fun: => Int): Int = ???
}
Tester { implicit myImplicitClass => session * 20} 
```

如果这个函数：

```
def session(implicit myImplicitClass: MyImplicitClass): Int = myImplicitClass.session 
```

在范围内，那么第一个代码片段将编译，因为显然隐式参数`myImplicitClass`将传递给*函数* `session`以访问*字段* `myImplicitClass.session`，允许您省略字段访问。这正是 Play 的诀窍！框架正在使用，查看[`Controller`](http://www.playframework.org/documentation/api/2.0.1/scala/index.html#play.api.mvc.Controller)功能`session`。

作为旁注，上面的闭包并不是说它需要一个隐式参数，它是一种语言特性，可以避免必须执行以下操作：

```
Tester { myImplicitClass => 
  implicit val x = myImplicitClass
  session * 20
} 
```

当一个人想要使用闭包参数作为闭包主体中的隐式值时。另请注意，从 Scala 2.9 开始，此技巧仅限于使用 1 个参数的闭包。**

# windows-phone-8 - 如何删除 windows phone 8 SDK 的组件？

> ID：14270019
> 
> 赞同：0
> 
> 时间：2013-01-11T01:00:12.310
> 
> 标签：windows-phone-8

我认为这是一个愚蠢的问题……在我安装 wp sdk 8 后，我发现它在 C 盘上的大小超过了 7 giga。所以我想删除一些组件以节省大小，但是当我从（卸载程序）中选择更改时，它会卸载所有 sdk。我该做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T08:17:39.690

我不认为这是可能的。删除部分安装可以帮助您获得一些空间的唯一地方是删除一些模拟器图像。如果你不打算为 Windows Phone 7 开发，你可以删除这些图像并获得几个 GB，但同样，购买一些更大的 SSD 而不是推测，可以从 Windows Phone 8 SDK 中删除什么。

# ios - 如何为 UICollectionView 实现 UITableView 的滑动删除

> ID：14270023
> 
> 赞同：24
> 
> 时间：2013-01-11T01:00:29.400
> 
> 标签：ios, uitableview, uicollectionview

我只是想问如何在 UICollectionView 中实现与 UITableView 的滑动删除相同的行为。我正在尝试查找教程，但找不到任何教程。

另外，我正在使用 PSTCollectionView 包装器来支持 iOS 5。

谢谢！

编辑：滑动识别器已经很好了。我现在需要的是在取消删除模式时与 UITableView 相同的功能，例如，当用户点击表格视图中的单元格或空白区域时（即，当用户点击删除按钮外部时）。UITapGestureRecognizer 不起作用，因为它只检测释放触摸时的点击。UITableView 检测到手势开始时的触摸（而不是释放时），并立即取消删除模式。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2018-09-16T09:17:30.117

您的问题有一个更简单的解决方案，可以避免使用手势识别器。该解决方案基于`UIScrollView`结合`UIStackView`.

1.  首先，您需要创建 2 个容器视图 - 一个用于单元格的可见部分，一个用于隐藏部分。您会将这些视图添加到`UIStackView`. 将`stackView`充当内容视图。确保视图的宽度与`stackView.distribution = .fillEqually`.

2.  您将嵌入启用`stackView`了分页的内部`UIScrollView`。`scrollView`应该限制​​在单元格的边缘。然后将 ' 宽度设置为`stackView`' 宽度的 2 倍，`scrollView`这样每个容器视图都将具有单元格的宽度。

通过这个简单的实现，您已经创建了具有可见和隐藏视图的基本单元。使用可见视图向单元格添加内容，在隐藏视图中您可以添加删除按钮。通过这种方式，您可以实现：

[![滑动删除](../Images/ab0cab723ee290495f417dd66be6b3c4.png)](https://i.stack.imgur.com/AQIqz.gif)

我[在 GitHub 上建立了一个示例项目](https://github.com/amerhukic/SwipeableCollectionViewCell-Example)。您还可以[在此处阅读有关此解决方案的更多信息](https://www.amerhukic.com/swipeable-collection-view-cell)。
此解决方案的最大优点是简单，您不必处理约束和手势识别器。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-11-07T12:49:15.187

`customContentView`它非常简单..您需要`customBackgroundView`在`customContentView`.

之后，`customContentView`当用户从右向左滑动时，您需要向左移动。移动视图使`customBackgroundView`.

**让代码：**

首先，您需要将 panGesture 添加到您的`UICollectionView`as

```
 override func viewDidLoad() {
        super.viewDidLoad()
        self.panGesture = UIPanGestureRecognizer(target: self, action: #selector(self.panThisCell))
        panGesture.delegate = self
        self.collectionView.addGestureRecognizer(panGesture)

    } 
```

现在将选择器实现为

```
 func panThisCell(_ recognizer:UIPanGestureRecognizer){

        if recognizer != panGesture{  return }

        let point = recognizer.location(in: self.collectionView)
        let indexpath = self.collectionView.indexPathForItem(at: point)
        if indexpath == nil{  return }
        guard let cell = self.collectionView.cellForItem(at: indexpath!) as? CustomCollectionViewCell else{

            return

        }
        switch recognizer.state {
        case .began:

            cell.startPoint =  self.collectionView.convert(point, to: cell)
            cell.startingRightLayoutConstraintConstant  = cell.contentViewRightConstraint.constant
            if swipeActiveCell != cell && swipeActiveCell != nil{

                self.resetConstraintToZero(swipeActiveCell!,animate: true, notifyDelegateDidClose: false)
            }
            swipeActiveCell = cell

        case .changed:

            let currentPoint =  self.collectionView.convert(point, to: cell)
            let deltaX = currentPoint.x - cell.startPoint.x
            var panningleft = false

            if currentPoint.x < cell.startPoint.x{

                panningleft = true

            }
            if cell.startingRightLayoutConstraintConstant == 0{

                if !panningleft{

                    let constant = max(-deltaX,0)
                    if constant == 0{

                        self.resetConstraintToZero(cell,animate: true, notifyDelegateDidClose: false)

                    }else{

                        cell.contentViewRightConstraint.constant = constant

                    }
                }else{

                    let constant = min(-deltaX,self.getButtonTotalWidth(cell))
                    if constant == self.getButtonTotalWidth(cell){

                        self.setConstraintsToShowAllButtons(cell,animate: true, notifyDelegateDidOpen: false)

                    }else{

                        cell.contentViewRightConstraint.constant = constant
                        cell.contentViewLeftConstraint.constant = -constant
                    }
                }
            }else{

                let adjustment = cell.startingRightLayoutConstraintConstant - deltaX;
                if (!panningleft) {

                    let constant = max(adjustment, 0);
                    if (constant == 0) {

                        self.resetConstraintToZero(cell,animate: true, notifyDelegateDidClose: false)

                    } else {

                        cell.contentViewRightConstraint.constant = constant;
                    }
                } else {
                    let constant = min(adjustment, self.getButtonTotalWidth(cell));
                    if (constant == self.getButtonTotalWidth(cell)) {

                        self.setConstraintsToShowAllButtons(cell,animate: true, notifyDelegateDidOpen: false)
                    } else {

                        cell.contentViewRightConstraint.constant = constant;
                    }
                }
                cell.contentViewLeftConstraint.constant = -cell.contentViewRightConstraint.constant;

            }
            cell.layoutIfNeeded()
        case .cancelled:

            if (cell.startingRightLayoutConstraintConstant == 0) {

                self.resetConstraintToZero(cell,animate: true, notifyDelegateDidClose: true)

            } else {

                self.setConstraintsToShowAllButtons(cell,animate: true, notifyDelegateDidOpen: true)
            }

        case .ended:

            if (cell.startingRightLayoutConstraintConstant == 0) {
                //Cell was opening
                let halfOfButtonOne = (cell.swipeView.frame).width / 2;
                if (cell.contentViewRightConstraint.constant >= halfOfButtonOne) {
                    //Open all the way
                    self.setConstraintsToShowAllButtons(cell,animate: true, notifyDelegateDidOpen: true)
                } else {
                    //Re-close
                    self.resetConstraintToZero(cell,animate: true, notifyDelegateDidClose: true)
                }
            } else {
                //Cell was closing
                let buttonOnePlusHalfOfButton2 = (cell.swipeView.frame).width
                if (cell.contentViewRightConstraint.constant >= buttonOnePlusHalfOfButton2) {
                    //Re-open all the way
                    self.setConstraintsToShowAllButtons(cell,animate: true, notifyDelegateDidOpen: true)
                } else {
                    //Close
                    self.resetConstraintToZero(cell,animate: true, notifyDelegateDidClose: true)
                }
            }

        default:
            print("default")
        }
    } 
```

更新约束的辅助方法

```
 func getButtonTotalWidth(_ cell:CustomCollectionViewCell)->CGFloat{

        let width = cell.frame.width - cell.swipeView.frame.minX
        return width

    }

    func resetConstraintToZero(_ cell:CustomCollectionViewCell, animate:Bool,notifyDelegateDidClose:Bool){

        if (cell.startingRightLayoutConstraintConstant == 0 &&
            cell.contentViewRightConstraint.constant == 0) {
            //Already all the way closed, no bounce necessary
            return;
        }
        cell.contentViewRightConstraint.constant = -kBounceValue;
        cell.contentViewLeftConstraint.constant = kBounceValue;
        self.updateConstraintsIfNeeded(cell,animated: animate) {
            cell.contentViewRightConstraint.constant = 0;
            cell.contentViewLeftConstraint.constant = 0;

            self.updateConstraintsIfNeeded(cell,animated: animate, completionHandler: {

                cell.startingRightLayoutConstraintConstant = cell.contentViewRightConstraint.constant;
            })
        }
        cell.startPoint = CGPoint()
        swipeActiveCell = nil
    }

    func setConstraintsToShowAllButtons(_ cell:CustomCollectionViewCell, animate:Bool,notifyDelegateDidOpen:Bool){

        if (cell.startingRightLayoutConstraintConstant == self.getButtonTotalWidth(cell) &&
            cell.contentViewRightConstraint.constant == self.getButtonTotalWidth(cell)) {
            return;
        }
        cell.contentViewLeftConstraint.constant = -self.getButtonTotalWidth(cell) - kBounceValue;
        cell.contentViewRightConstraint.constant = self.getButtonTotalWidth(cell) + kBounceValue;

        self.updateConstraintsIfNeeded(cell,animated: animate) {
            cell.contentViewLeftConstraint.constant =  -(self.getButtonTotalWidth(cell))
            cell.contentViewRightConstraint.constant = self.getButtonTotalWidth(cell)

            self.updateConstraintsIfNeeded(cell,animated: animate, completionHandler: {(check) in

                cell.startingRightLayoutConstraintConstant = cell.contentViewRightConstraint.constant;
            })
        }
    }

    func setConstraintsAsSwipe(_ cell:CustomCollectionViewCell, animate:Bool,notifyDelegateDidOpen:Bool){

        if (cell.startingRightLayoutConstraintConstant == self.getButtonTotalWidth(cell) &&
            cell.contentViewRightConstraint.constant == self.getButtonTotalWidth(cell)) {
            return;
        }
        cell.contentViewLeftConstraint.constant = -self.getButtonTotalWidth(cell) - kBounceValue;
        cell.contentViewRightConstraint.constant = self.getButtonTotalWidth(cell) + kBounceValue;

        self.updateConstraintsIfNeeded(cell,animated: animate) {
            cell.contentViewLeftConstraint.constant =  -(self.getButtonTotalWidth(cell))
            cell.contentViewRightConstraint.constant = self.getButtonTotalWidth(cell)

            self.updateConstraintsIfNeeded(cell,animated: animate, completionHandler: {(check) in

                cell.startingRightLayoutConstraintConstant = cell.contentViewRightConstraint.constant;
            })
        }
    }

    func updateConstraintsIfNeeded(_ cell:CustomCollectionViewCell, animated:Bool,completionHandler:@escaping ()->()) {
        var duration:Double = 0
        if animated{

            duration = 0.1

        }
        UIView.animate(withDuration: duration, delay: 0, options: [.curveEaseOut], animations: {

            cell.layoutIfNeeded()

            }, completion:{ value in

                if value{ completionHandler() }
        })
    } 
```

我在 Swift 3 中创建[了一个示例项目。](https://github.com/anishparajuli555/SwipeCollectionViewCell)

它是本[教程](https://www.raywenderlich.com/62435/make-swipeable-table-view-cell-actions-without-going-nuts-scroll-views)的修改版本。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-08-09T13:16:37.990

在*Collection View Programming Guide for iOS*的[Incorporating Gesture Support](https://developer.apple.com/library/content/documentation/WindowsViews/Conceptual/CollectionViewPGforIOS/IncorporatingGestureSupport/IncorporatingGestureSupport.html#//apple_ref/doc/uid/TP40012334-CH4-SW1)部分中，文档如下：

> 您应该始终将手势识别器附加到集合视图本身，而不是特定的单元格或视图。

所以，我认为将识别器添加到`UICollectionViewCell`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-02-14T00:58:00.163

我采用了与@JacekLampart 类似的方法，但决定在 UICollectionViewCell 的 awakeFromNib 函数中添加 UISwipeGestureRecognizer，因此它只添加一次。

UICollectionViewCell.m

```
- (void)awakeFromNib {
    UISwipeGestureRecognizer* swipeGestureRecognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(swipeToDeleteGesture:)];
    swipeGestureRecognizer.direction = UISwipeGestureRecognizerDirectionLeft;
    [self addGestureRecognizer:swipeGestureRecognizer];
}

- (void)swipeToDeleteGesture:(UISwipeGestureRecognizer *)swipeGestureRecognizer {
    if (swipeGestureRecognizer.state == UIGestureRecognizerStateEnded) {
        // update cell to display delete functionality
    }
} 
```

至于退出删除模式，我创建了一个自定义 UIGestureRecognizer 和一个 NSArray 的 UIViews。我从这个问题中借用了@iMS 的想法：[UITapGestureRecognizer - 让它在触地时工作，而不是触地？](https://stackoverflow.com/questions/15628133/uitapgesturerecognizer-make-it-work-on-touch-down-not-touch-up)

在 touchesBegan 上，如果触摸点不在任何 UIView 中，则手势成功并退出删除模式。

通过这种方式，我可以将单元格（和任何其他视图）中的删除按钮传递给 UIGestureRecognizer，如果触摸点在按钮的框架内，删除模式将不会退出。

TouchDownExcludingViewsGestureRecognizer.h

```
#import <UIKit/UIKit.h>

@interface TouchDownExcludingViewsGestureRecognizer : UIGestureRecognizer

@property (nonatomic) NSArray *excludeViews;

@end 
```

TouchDownExcludingViewsGestureRecognizer.m

```
#import "TouchDownExcludingViewsGestureRecognizer.h"
#import <UIKit/UIGestureRecognizerSubclass.h>

@implementation TouchDownExcludingViewsGestureRecognizer

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    if (self.state == UIGestureRecognizerStatePossible) {
        BOOL touchHandled = NO;
        for (UIView *view in self.excludeViews) {
            CGPoint touchLocation = [[touches anyObject] locationInView:view];
            if (CGRectContainsPoint(view.bounds, touchLocation)) {
                touchHandled = YES;
                break;
            }
        }

        self.state = (touchHandled ? UIGestureRecognizerStateFailed : UIGestureRecognizerStateRecognized);
    }
}

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    self.state = UIGestureRecognizerStateFailed;
}

-(void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    self.state = UIGestureRecognizerStateFailed;
}

@end 
```

实现（在包含 UICollectionView 的 UIViewController 中）：

```
#import "TouchDownExcludingViewsGestureRecognizer.h"

TouchDownExcludingViewsGestureRecognizer *touchDownGestureRecognizer = [[TouchDownExcludingViewsGestureRecognizer alloc] initWithTarget:self action:@selector(exitDeleteMode:)];
touchDownGestureRecognizer.excludeViews = @[self.cellInDeleteMode.deleteButton];
[self.view addGestureRecognizer:touchDownGestureRecognizer];

- (void)exitDeleteMode:(TouchDownExcludingViewsGestureRecognizer *)touchDownGestureRecognizer {
    // exit delete mode and disable or remove TouchDownExcludingViewsGestureRecognizer
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-11T01:18:43.707

您可以尝试将 UISwipeGestureRecognizer 添加到每个集合单元格，如下所示：

```
-(UICollectionViewCell *)collectionView:(UICollectionView *)collectionView
             cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    CollectionViewCell *cell = ...

    UISwipeGestureRecognizer* gestureRecognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(userDidSwipe:)];
    [gestureRecognizer setDirection:UISwipeGestureRecognizerDirectionRight];
    [cell addGestureRecognizer:gestureRecognizer];
} 
```

其次是：

```
- (void)userDidSwipe:(UIGestureRecognizer *)gestureRecognizer {
    if (gestureRecognizer.state == UIGestureRecognizerStateEnded) {
        //handle the gesture appropriately
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-12-31T23:22:54.647

在 iOS 14 中，您可以[`UICollectionViewLayoutListConfiguration`](https://developer.apple.com/documentation/uikit/uicollectionlayoutlistconfiguration)与 结合使用[`UICollectionViewCompositionalLayout`](https://developer.apple.com/documentation/uikit/uicollectionviewcompositionallayout)以免费获得此功能，无需自定义单元格或手势识别。

如果您的最低部署目标是 >= iOS 14.x，这可能是从现在开始的首选方法，它还可以让您采用现代单元配置`UIContentView`并`UIContentConfiguration`启动。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-08-16T16:29:57.777

有一个更标准的解决方案来实现此功能，其行为与`UITableView`.

为此，您将使用 a`UIScrollView`作为单元格的根视图，然后将单元格内容和删除按钮放置在滚动视图内。单元类中的代码应该是这样的：

```
override init(frame: CGRect) {
    super.init(frame: frame)

    addSubview(scrollView)
    scrollView.addSubview(viewWithCellContent)
    scrollView.addSubview(deleteButton)
    scrollView.isPagingEnabled = true
    scrollView.showsHorizontalScrollIndicator = false
} 
```

在这段代码中，我们将属性设置`isPagingEnabled`为`true`使滚动视图仅在其内容的边界处停止滚动。此单元格的布局子视图应类似于：

```
override func layoutSubviews() {
    super.layoutSubviews()

    scrollView.frame = bounds
    // make the view with the content to fill the scroll view
    viewWithCellContent.frame = scrollView.bounds
    // position the delete button just at the right of the view with the content.
    deleteButton.frame = CGRect(
        x: label.frame.maxX, 
        y: 0, 
        width: 100, 
        height: scrollView.bounds.height
    )

    // update the size of the scrolleable content of the scroll view
    scrollView.contentSize = CGSize(width: button.frame.maxX, height: scrollView.bounds.height)
} 
```

使用此代码，如果您运行该应用程序，您将看到滑动删除按预期工作，但是，我们失去了选择单元格的能力。问题是，由于滚动视图填充了整个单元格，所有的触摸事件都由它处理，所以集合视图永远没有机会选择单元格（这类似于我们在单元格内有一个按钮时，因为触摸该按钮不会触发选择过程，而是由按钮直接处理。）

要解决这个问题，我们只需指示滚动视图忽略由它而不是由它的子视图之一处理的触摸事件。要实现这一点，只需创建一个子类`UIScrollView`并覆盖以下函数：

```
override func hitTest(_ point: CGPoint, with event: UIEvent?) -> UIView? {
    let result = super.hitTest(point, with: event)
    return result != self ? result : nil
} 
```

现在在您的单元格中，您应该使用这个新子类的实例而不是标准的`UIScrollView`.

如果您现在运行该应用程序，您将看到我们恢复了单元格选择，但这次滑动不起作用。由于我们忽略了由滚动视图直接处理的触摸，因此它的平移手势识别器将无法开始识别触摸事件。但是，可以通过向滚动视图指示其平移手势识别器将由单元格而不是滚动处理来轻松解决此问题。您可以在单元格的底部添加以下行`init(frame: CGRect)`：

```
addGestureRecognizer(scrollView.panGestureRecognizer) 
```

这可能看起来有点 hacky，但事实并非如此。按照设计，包含手势识别器的视图和该识别器的目标不必是同一个对象。

在此更改之后，一切都应该按预期工作。[你可以在这个 repo](https://github.com/rlaguilar/SwipeToDeleteCollectionView)中看到这个想法的完整实现

# php - 凌乱的 Jquery + HTML + PHP

> ID：14270026
> 
> 赞同：1
> 
> 时间：2013-01-11T01:00:49.967
> 
> 标签：php, javascript, jquery, html

我一直在审查我的代码试图整理它，当它需要从页面复制 html 时，我只是厌倦了我编写 jQuery 的方式。这就是我的意思：

我有一个页面的一部分循环通过论坛之类的帖子（我的实际代码更重html）：

```
<? foreach ($posts as $post): ?>
    <div class="post">
        <div class"post_details">
            <a href="<?= $post->link ?>"><?= $post->title ?></a>
            <br>
            <?= $post->timestamp ?>
        </div>
    </div>
<? endforeach ?> 
```

然后在我的 jquery 中，我基本上必须复制这个 HTML 以循环通过 AJAX 请求的结果来获取更多最近的帖子：

```
for (i = 0; i < response.length; i++) {
    post = respnse[i];

    html = '<div class="post">';
        html += '<div class"post_details">';
            html += '<a href="' + post.link + '">' + post.title + '</a>';
            html += '<br>';
            html += post.timestamp;
        html += '</div>';
    html += '</div>';
}
// Inject html into page

$(".feed").prepend(html); 
```

如果我更改了 PHP 循环遍历对象的 HTML 的布局，那么我还必须更改 jQuery 中的 HTML。然后我得到了很多基本上重复的代码，这些代码变得像任何东西一样混乱。

有没有办法更好地将 jQuery 链接到 HTML 元素以使代码更简洁？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T01:09:30.170

你的方法太疯狂了...

```
html = '<div class="post">';
    html += '<div class"post_details">';
        html += '<a href="' + post.link + '">' + post.title + '</a>';
        html += '<br>';
        html += post.timestamp;
    html += '</div>';
html += '</div>'; 
```

为什么在 JavaScript 中这样做？为什么不让 PHP 返回完全格式化的字符串，然后只使用 jQuery 将其放入其位置？只需在 xml 字符串中返回它并提取它。

更好的是，让 AJAX 请求返回一个运行该确切代码的视图（如果您使用的是 MVC 框架）。将代码放在一个地方，一个局部视图或其他地方，并创建一个指向您可以 AJAX 的链接。我的 0.02 美元。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T01:34:16.430

您应该使用服务器端模板 -> 客户端模板。这种方法很简单，在大多数情况下，您只需在维护中修改服务器端模板。

步骤 1\. 定义服务器端函数或块

```
<?php
 function postTemplate($post) { ?>
 <div class="post">
    <div class"post_details">
        <a href="<?= $post->link ?>"><?= $post->title ?></a>
        <br>
        <?= $post->timestamp ?>
    </div>
 </div>
<? } ?> 
```

步骤 2\. 将其输出到客户端模板的页面上（使用特定的客户端语法来处理您的客户端选择，即 Moustache）

```
<script type="html/template" id="postTemplate">
<?php
  $obj = new stdClass;
  $obj->link = "{link}";
  $obj->title = "{title}";
  $obj->timestamp = "{timestamp}";
  echo postTemplate($obj);
 ?>
 </script> 
```

步骤 3\. 使用您最喜欢的客户端模板策略

```
<script>
    // refer to http://mustache.github.com/
    // but I prefer EJS myself
</script> 
```

# jquery - jQuery延迟滑动

> ID：14270027
> 
> 赞同：0
> 
> 时间：2013-01-11T01:00:52.683
> 
> 标签：jquery, delay, slideup

有谁知道为什么这不起作用

```
$(window).load(function() {

      $('#first-div').animate({top:"640px"},3000);
      $('#second-div').delay(5000).slideup("1000");
      }); 
```

我要做的是在加载页面时，第一个 div 使用动画向下移动，第二个 div 使用延迟后向上滑动。

我的问题是第一个 div 工作正常，但第二个 div 不工作，没有使用 .delay() 做任何事情

有没有人可以帮助我。

是

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:34:30.433

尝试使用`setTimeout()`：

```
$(window).load(function() {

  $('#first-div').animate({top:"640px"},3000);
  setTimeout(function(){
      $('#second-div').slideUp("1000");
  }, 5000);
}); 
```

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T01:06:52.057

`u`in`slideUp`必须是大写。[http://jsfiddle.net/L4AaR/](http://jsfiddle.net/L4AaR/)

```
$('#second-div').delay(5000).slideUp("1000"); 
```

# javascript - CSS 和 Jquery：addClass 不覆盖 css

> ID：14270030
> 
> 赞同：3
> 
> 时间：2013-01-11T01:01:01.110
> 
> 标签：javascript, jquery, css, addclass

我有一个脚本，可以在悬停时向元素添加一个类。

问题是新添加的类似乎没有“覆盖”现有的 css（即使在我的样式表上，添加的类列在现有 css 的下方）。

我不能在元素上使用 removeClass，因为没有实际的初始类样式元素。

需要覆盖的“初始”样式是：

```
#menu ul li ul li {
background-color: #ccc;
} 
```

需要添加的类是：

```
.whitebg {
background-color: #fff;
} 
```

我的脚本是：

```
$('#menu ul li ul li').hover(
function() {
    $(this).addClass('whitebg');
},
function () {
    $(this).removeClass('whitebg');
  }
); 
```

有谁知道我可以解决这个问题的方法？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T01:02:36.637

`id`选择器优先于`class`选择器。你需要`!important`

```
.whitebg {
background-color: #fff !important;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T01:04:36.063

这是因为特殊性。您可以`!important`按照其他帖子的建议使用，但`!important`在您的 CSS 中使用是一种**不好的做法。**

```
Use that as you last option. 
```

而是使用两个类..

确保最里面的 li 有`default`它的类..

```
$('#menu ul li ul li').addClass('default').hover(
   function() {
      $(this).addClass('whitebg').removeClass('default');
   },
   function () {
      $(this).removeClass('whitebg').addClass('default');
   }
); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/Ytca7/2/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T01:18:40.687

然后，你需要这样的代码：

```
#menu ul li ul li {
  background-color: #ccc;
}
#menu ul li ul li.whitebg {
  background-color: #fff;
} 
```

只有这样，我们才能有一个共同的父类。

`!important`将是一个兼容性问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T01:03:08.927

只需将 !important 标签添加到 .whitebg 类中的背景颜色。那应该可以解决您的问题。

# javascript - 包含框架集文档的 iframe 未扩展到浏览器窗口的完整高度

> ID：14270032
> 
> 赞同：1
> 
> 时间：2013-01-11T01:01:08.217
> 
> 标签：javascript, css, internet-explorer, iframe, frameset

过去两天有一个问题一直困扰着我:(

我设置了一个 HTML 网页，其中包含一个加载**框架集文档的****iFrame**。是的，我知道，框架是古老的技术，不应该使用，但这是 Adob​​e 的 RoboHelp 工具产生的输出，所以我需要处理它。

 **我试图添加 JavaScript 代码的变体，这些代码将调整 iFrame 的高度以适应浏览器窗口的剩余高度。它在 Chrome、Safari、Firefox 等中运行良好，但与大多数组织一样，客户端已标准化为古老的 IE（Internet Explorer 8），而且看起来它们不会很快向前发展。

此处传达了当前问题的图像：

![iframe 不占用 IE 8 中的剩余空间](../Images/cf1fedd02478eb24bc7bebcda96dc2b7.png)

简而言之，我无法让 iFrame 占据*Internet Explorer* (8) 中横幅和页脚之间的剩余空间。我已经使用 CSS 样式和 JavaScript 代码的变体来“读取”（我猜）“frameset(?)”文档的高度，以便将高度传递给内框以调整其大小。我见过的大多数脚本都依赖于 iFrame 中文档的高度，但是当你有一个框架集时会发生什么？

这是包含 iFrame 的主页的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<style>
body {
width:100%;
height:100%
}
</style>
<script language="javascript" type="text/javascript">
function autoHeight(e)
{
    alert(e);
    if ( e.contentDocument ) {

        e.height = e.contentDocument.body.offsetHeight + 35;
    }
    else {
        e.height = e.contentWindow.document.body.scrollHeight + 35;
        alert("e.contentWindow = "+ e.contentWindow);
    }
}

this.onload = function(e) {
// or add it to the onload attribute of the body tag...
var ifr = document.getElementById('helpFrame');
    autoHeight(ifr);
}

</script>
</head>
<body>
<!--banner code here, not too important -->
<iframe frameborder="0" id="helpFrame" align="bottom" src="/RCMP/prod/index.htm" width="100%" height="100%" scrolling="no" style="height:100%;">
    Your browser does not support iframes.
</iframe>
<!-- added some paragraphs to actually "push" the footer down for now. -->
<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p>
<!--footer code here-->
</body>
</html> 
```

这是框架集的代码（包含在 iFrame 中，来自 Adob​​e 的 RoboHelp 发布的输出）。很多javascript可以忽略，相信重点是frameset）

```
<html>
<head>
 <link rel="shortcut icon" href="favicon.ico">
 <title>Orientation Guide To E-Division Headquarters</title>

 <meta name="generator" content="Adobe RoboHelp 9" />
 <meta name="description" content="WebHelp 5.50" />

</head>

<frameset cols="100%,*" frameborder=no border=0>
  <frame src="whnjs.htm">
  <frame src="whskin_blank.htm" noresize>
</frameset><noframes></noframes>

</html> 
```

所以挑战是让 iFrame 在 IE 中全高（到页脚）！任何建议/解决方案将不胜感激。如果我不需要的话，我真的不想使用 jQuery——JavaScript 和 CSS 会很好。

谢谢！**

# python - 尝试通过迭代创建新字典

> ID：14270033
> 
> 赞同：0
> 
> 时间：2013-01-11T01:01:09.577
> 
> 标签：python

我什至无法正确搜索谷歌，但这里是：

```
a = {}
b = {}
c = [a, b]
for d in c:
    d['ID'] = d
print c 
```

返回：

```
[{'ID': {...}}, {'ID': {...}}] 
```

为什么不是：

```
[{'ID': a}, {'ID': b}] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T01:08:22.433

让我们一步一步来：

```
a = {}
b = {}
c = [a, b] 
```

到目前为止，一切都很好。

```
for d in c:
    d['ID'] = d 
```

我们可以将其展开为：

```
d = c[0]
d['ID'] = d
d = c[1]
d['ID'] = 1 
```

并将其扩展为：

```
d = a
d['ID'] = d
d = b
d['ID'] = d 
```

现在替换：

```
a['ID'] = a
b['ID'] = a 
```

所以，让我们暂时忘记循环，看看它做了什么：

```
>>> a = {}
>>> a['ID'] = a
>>> a
{'ID': {...}} 
```

换句话说，您正在使每个`dict`递归包含其自身的副本，在 key 下`ID`。您希望如何打印？

所以，显而易见的事情是尝试打印整个字典：

```
{'ID': {'ID': {'ID': { … 
```

但这将是一个无限长的字符串，Python 会在达到无穷大之前耗尽堆栈空间。所以它需要以某种方式截断它。

它不能打印这个：

```
{'ID': a} 
```

因为`a`is 只是一个恰好绑定到 的名称`dict`，就像`d`当时的 is 一样。事实上，循环甚至不*知道*那个`a`时候绑定到那个；它知道那`d`是。但即使它*知道*，结果也是错误的。想一想：

```
>>> e = a
>>> a = 0
>>> e
??? 
```

因此，显而易见的答案是使用省略号（有点像我在人类可读版本中所做的）来表示“等等”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T01:54:00.443

```
for d in c:
    d['ID'] = d 
```

应该

```
c = [{'ID': d} for d in c] 
```

您的代码将 ID 元素添加到`c`. 这意味着`a = {'ID': a}`在您的代码运行之后。它包含对自身的引用。

我的代码片段生成一个*新*的dict，其属性`'ID'`包含来自`c`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T01:05:44.987

a 是字典。

b 是字典。

c 是两个字典的列表（不是“两个名称”或“两个变量”）。

另一个苏格拉底式的解释：如果它会返回`[{'ID': a}, {'ID': b}]`，值显示为`a`并且`b`将是哪种类型？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T01:20:59.460

考虑循环在做什么： a = {} b = {} c = [a, b]

```
 for d in c:
        d['ID'] = d 
```

d 将是 a 或 b，这样

```
 a['ID'] = a
    b['ID'] = b 
```

但回想一下 a 和 b 是 {}，即 dics 本身。结果，您将 ['ID'] 分配给 dic 本身，从而创建了一个循环。当你

```
print(c) 
```

你得到 `[{'ID': {...}}, {'ID': {...}}]`是因为键的值是 dic 本身而不是它的变量表示，因此你得到 {...} 来反映循环的性质。注意 this 之后 `a['ID']['ID']`，甚至 a `['ID']['ID']['ID']['ID']` is `{'ID': {...}}`，因为键的值是 dic 本身，而不是指向它的变量。

# android - 9-patch drawable 表现糟糕，奇怪的人工制品 - 这里有什么问题？

> ID：14270042
> 
> 赞同：2
> 
> 时间：2013-01-11T01:02:20.893
> 
> 标签：android, android-layout, nine-patch

所以我尝试了 9-patch 图像。我从一个 PNG 文件开始，其中有一个带圆角的半透明正方形：

![在此处输入图像描述](../Images/57ad4df3144eb042a4af8370f15116ec.png)

然后，我创建了 9-patch，如下所示（注意顶部和左侧的小点）：

![在此处输入图像描述](../Images/e8be674f9884ddb708a3c682a442e237.png)

我认为这足以处理这个问题，但是当将此 9-patch 添加到 Eclipse 时，我得到了奇怪的结果。

**结果 nbr 1**

基于此 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linearLayout6"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/taxibg3"
    android:orientation="vertical" >

    <ImageView
        android:layout_width="100dp"
        android:layout_height="100dp"
        android:background="@drawable/login_square" />
</LinearLayout> 
```

我得到这个结果：

![在此处输入图像描述](../Images/e77a1142e369da6b7c282b93d5b37a56.png)

结果 nbr 2

基于此 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linearLayout6"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/taxibg3"
    android:orientation="vertical" >

    <ImageView
        android:layout_width="300dp"
        android:layout_height="158dp"
        android:background="@drawable/login_square" />

</LinearLayout> 
```

我得到这个结果：

![在此处输入图像描述](../Images/49122299e19671d6f2a8b2cff2122059.png)

我还尝试让顶部的“9 条补丁线”和左侧更长，但这也会产生奇怪的伪影。

**有任何想法吗？**

**- 编辑 -**

我还尝试了这个 9-patch（来自 9patch-tool 的屏幕截图）：

![在此处输入图像描述](../Images/e9d4d4acec5777008f65d45382725aa7.png)

这给出了这个糟糕的结果（注意黑线）：

![在此处输入图像描述](../Images/c873c65e2cb1a3516111d9d816ce32f8.png)

**---- 编辑 2 ----**

Leonidos 告诉我 9-patch 太大了，不能缩小。所以我试了一下，结果同样糟糕。

这是 9 补丁（在[此处](https://docs.google.com/file/d/0B3wIZ9CS9Kj_M0xwY3FrS1FDLW8/edit)下载文件）

![在此处输入图像描述](../Images/908cea20560de28d93266d4d406d65e3.png)

这就是它的外观（注意黑线）：

![在此处输入图像描述](../Images/393af84505387e0f4d68e6237b2d8df8.png)

--- 编辑 3 ---

我查看了路径中的“显示坏补丁”，这就是显示的内容：

![在此处输入图像描述](../Images/16679488f13c1c570871166c3d02076d.png)

但这并不重要。如果我改变它，它看起来像这样：

![在此处输入图像描述](../Images/28641999f387dad8729b9ccaa6076d63.png)

我仍然得到黑色条纹！

哦为什么哦为什么！？=)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T08:54:52.100

使其尽可能小。9 贴片不能收缩，它们可以拉伸。用黑色填充右侧和底部边框。使用 draw9patch 工具编辑 9-patch 边界以防止错误。你的 9-patch 应该和[这个](http://2.bp.blogspot.com/_TmS45BcrloQ/TDQbGX1mpOI/AAAAAAAAA5U/w0BAjGUbR-4/s320/9patch.png)类似。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T07:40:15.707

1 像素边框*必须*是完全黑色（九个补丁标记）或完全透明。基本上，编辑图像以剪掉 1 像素边框中的任何内容，除了两个黑点。

此外，您的图像可以小得多。九个补丁的要点是顶部和左侧的标记标记要拉伸的内容。大多数带有直边的内容都可以删除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T01:43:54.890

尝试从所有 4 个面做 9 个补丁标记。还要确保你有 .9.png 文件扩展名（fi your_cool_pic.9.png）

这是我的例子 ![在此处输入图像描述](../Images/24fddfdb5d81af8b330a9d043a22329b.png)

# android - Android 应用程序在恢复后丢失/更改状态

> ID：14270044
> 
> 赞同：0
> 
> 时间：2013-01-11T01:02:33.627
> 
> 标签：android, lifecycle

我是 android-development 的初学者，所以请多多包涵。

这是我编写一个简单的“打地鼠”游戏的可悲尝试。UI 由 9 个没有标题的按钮组成。计时器随机选择用户必须单击的按钮之一（按钮获得标题“X”）。如果用户选择了正确的按钮，他将获得 10 分。如果没有及时点击按钮（或错误的按钮），将从分数中扣除 10 分。

如您所见，我为每个按钮添加了一个 OnClickListener，并在 onCreate-Method 中删除了其初始标题（“Button1”、“Button2”...）。一切看起来都很好，直到我离开应用程序然后再回来。所有按钮突然又有了它们的初始标题。计时器仍在运行（分数每秒减少），但所有按钮都不再更改。

现在我知道这可能与活动生命周期有关，并且我已经阅读过它。不幸的是，我的英语不是最好的，我在理解这个概念时遇到了一些麻烦。也许有人愿意简单地向我解释一下？

```
public class MainActivity extends Activity {

private static int[]        buttons     = {R.id.button1, R.id.button2, ...};
private static List<Button> buttonlist  = new ArrayList<Button>();

private static TextView     scoreboard;
private static Timer        timer = new Timer();
private static int          score;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    scoreboard = (TextView) findViewById(R.id.textView1);

    for (int i = 0; i < 9; i++) {
        buttonlist.add((Button) findViewById(buttons[i]));
        buttonlist.get(i).setText("");

        // add OnClickListener for each Button
        ((Button) buttonlist.get(i)).setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                //if correct Button is pressed add 20 to score 
                if ("X".equals(((Button) v).getText().toString())) {
                    score += 20;
                    //and set button-text to "" again ...
                    ((Button) v).setText("");
                }
                else {
                    score -= 10;
                }
            }
        });

    }
    // Start Game
    timer.schedule(new MyTimerTask(), 0, 1000);
}

private class MyTimerTask extends TimerTask {
    @Override
    public void run() {
        runOnUiThread(new Runnable() {
            public void run() {
                score -= 10;
                scoreboard.setText("Your Score: " + score);

                //clear buttons
                for (int i = 0; i < 9; i++)
                    buttonlist.get(i).setText("");

                //pick random button as next target
                buttonlist.get((int) (Math.random() * (9 - 1) + 1)).setText("X");
            }
        });
    }
}

@Override
protected void onResume() {
    super.onResume();
    // Do something here?
}

... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:19:44.007

一旦您离开您的活动，系统将在您的活动中调用以下方法：

onPause onStop onDestroy

您的活动类实例将被销毁

当您再次输入活动时，它将再次创建，将调用以下方法：

onCreate onStart onResume

这就是您的情况下活动生命周期的样子（还有更多细节）

你的问题是你的 buttonList 是静态的，还有计时器和分数。即使您离开您的应用程序，系统也不会破坏您的应用程序进程，这样所有静态变量都将保持不变。这意味着您的按钮列表最初将包含来自先前活动实例的按钮。

解决方案是不使用静态关键字。如果您想在退出活动后保留某些状态，请查看 onSaveInstanceState。此外 - 假设您的设备可以旋转，这也将重新创建您的活动。

# jackrabbit - 大型媒体文件的 Jackrabbit 和 HTTP 范围请求

> ID：14270047
> 
> 赞同：1
> 
> 时间：2013-01-11T01:03:34.730
> 
> 标签：jackrabbit, jcr

由于 VLC 播放器可以发出 http 范围请求，因此我可以从网络共享访问我的媒体文件切换到常规的 http 服务器，这样我就可以直接跳到电影的中间。

最近我想更多地组织这些文件，并考虑将它们放入 Jackrabbit。

上传即使是大文件也可以正常工作，但获取更多是一个问题，因为 Jackrabbits 对媒体文件的 http 访问似乎无法处理 http 范围请求，真可惜。

如果文件存储在文件系统中，那么实现这一点会有多困难？

君特

# html - 使用 Game Maker 语言，如何将文件中特定 HTML 标记中的文本隔离到其自己的变量中？

> ID：14270048
> 
> 赞同：1
> 
> 时间：2013-01-11T01:03:36.043
> 
> 标签：html, game-maker

这可能与大多数问题略有不同，因为它涉及游戏制作语言。

我的程序做什么：

> 下载 HTML 页面
> 将页面读取到变量
> 中 读取特定 HTML 标记的第一个文本

最后一部分是我的问题。在第一个标签下`<h3><a HREF="dynamic content">TEXT HERE</a></h3>`是我需要检索的文本。现在，文档中有很多这样的行，我必须得到第一行。此外，一个问题是每次更新此站点时 HREF 内容都会发生变化（为什么我将“动态内容”放在那里）。

如何处理变量以消除 h3 标签周围的所有文本，以及如何将文本数据放入其自己的变量中而不会造成任何混乱？

我知道，这在 GML 中很复杂。非常感谢任何知道如何做到这一点的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T23:34:30.477

有了这里的代码功能，我终于解决了自己的问题。希望这有助于某人，有时。

```
//Variable to store original file data 
working = argument0

//Isolate string to h3 hyperlink 
position = string_pos("<h3><a>",working) 
working = string_delete(working,1,position) 

//Delete all content after the version number 
position = string_pos("</a></h3>",working) 
working = string_delete(working,position, string_length(working) ) 

return working 
```

# c++ - 将 DLL 链接到 Visual C++ 时未定义的外部

> ID：14270049
> 
> 赞同：4
> 
> 时间：2013-01-11T01:03:41.710
> 
> 标签：c++, dll, visual-studio-2012

我从供应商那里获得了一个我想在 C++ Visual Studio 2012 项目中使用的 dll。它带有一个`.lib`文件。

链接时我得到：

```
Error   1   error LNK2019: unresolved external symbol __imp__FT_CreateDeviceInfoList referenced in function "int __cdecl Ftexam(void)" (?Ftexam@@YAHXZ) C:\Users\Terry\Documents\Visual Studio 2012\Projects\Win32Project1\Win32Project1\ftexam.obj ftexample 
```

我读过类似的帖子，但我没有得到任何地方。我想我正在根据这些答案做所有事情，但是在链接时我仍然得到一个未定义的参考错误。

1.  我已将 dll.lib 文件添加到 /Linker/Addional Dependencies 列表中。
2.  我已确保 dll.h 文件包含在我的源代码中
3.  我已经将`dll.lib`文件放在我的项目目录中，并确保如果我从那里删除它，我会`cannot find dll.lib`在链接时得到（即，它是“在构建中”）

在我提供的`dll.h`头文件中，我有这个：

```
#ifdef DLL_EXPORTS
#define DLL_API __declspec(dllexport)
#else
#define DLL_API __declspec(dllimport)
#endif
.
.
#ifdef __cplusplus
extern "C" {
#endif

typedef ULONG   FT_STATUS;
.
.
DLL_API FT_STATUS FT_CreateDeviceInfoList(
    LPDWORD lpdwNumDevs
); 
```

我的调用代码是：

```
#include dll.h

int Ftexam(){
    FT_STATUS ftStatus=0; 
    DWORD numDevs = 0;

    // create the device information list 
    ftStatus = FT_CreateDeviceInfoList(&numDevs); 
} 
```

我意识到可能存在一些名称修改，所以我使用depends查看了DLL符号。它列出了禁用“Undecorate C++ 函数”选项的这些导出，（因此，这些是未损坏的导出）：

```
FT_Open
FT_Close
FT_Read
....
FT_CyclePort
FT_CreateDeviceInfoList<  <<<<<this reference!!!!
FT_GetDeviceInfoList 
```

上面标识的导出显然不匹配`__imp__FT_CreateDeviceInfoList`

是否有一个工具可以查看 .lib 文件中的定义，或者 Visual Studio 以某种方式显示它？

更新：

通过使用 dumpbin，我能够看到 .lib 中的符号是

```
__imp_FT_CreateDeviceInfoList 

instead of 

__imp__FT_CreateDeviceInfoList 
```

这是我跟踪到 .lib 的 64 位版本的 DLL 而不是 32 位版本的。（我首先尝试解决的组合之一）。

为了简化帖子，我指出标题包含：

```
DLL_API FT_STATUS FT_CreateDeviceInfoList(LPDWORD lpdwNumDevs);

When in fact, it actually contains:

DLL_API FT_STATUS WINAPI FT_CreateDeviceInfoList(LPDWORD lpdwNumDevs); 
```

因为 WINAPI 是#defined

如此变化

```
#define WINAPI
to
#define WINAPI __stdcall 
```

连同正确的 .lib 一起解决了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:58:41.457

打开 Visual Studio 命令提示符。触发以下命令以列出 lib 文件中的符号：

> 垃圾箱/所有 dll.lib

将以上内容重定向到文本文件，因为输出会快速滚动

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T03:06:13.357

`FT_CreateDeviceInfoList()`没有在 .h 文件中声明任何调用约定，因此它使用编译器的默认调用约定。您的编译器默认为`__cdecl`，这是大多数 C++ 编译器的正常行为。很有可能创建 DLL 的编译器实际上使用了不同的默认调用约定。例如，尝试编辑 .h 文件以指定`__stdcall`，看看它是否有任何区别，例如：

```
DLL_API FT_STATUS __stdcall FT_CreateDeviceInfoList(LPDWORD lpdwNumDevs); 
```

大多数 DLL 供应商使用`__stdcall`与最广泛选择的编译器兼容，而不仅仅是 C/C++ 编译器，尽管有些供应商确实使用`__cdecl`甚至`__fastcall`（不同编译器供应商的实现方式不同，所以要小心那个）。

更糟糕的情况是，您可以使用反汇编程序，如 IDA 或 WinDASM，或者只使用 IDE 自己的调试器，查看`FT_CreateDeviceInfoList()`DLL 内部的实际汇编代码，并查看它在访问`lpdwNumDevs`参数并返回时如何管理调用堆栈`FT_STATUS`价值。这将准确地告诉您它实际使用的调用约定。

**更新**：做一些在线搜索，我看到许多 .NET 代码示例，这些代码使用应用于其声明`FT_CreateDeviceInfoList()`的调用约定进行调用，因此这是一个很好的起点。`__stdcall`如果可行，那么您应该联系 DLL 供应商并要求他们相应地修复他们的 .h 文件。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-11T01:54:51.277

据我所知，您正在做的事情应该有效。但是您总是可以忘记 .lib 文件并直接使用 DLL，使用 LoadLibrary 加载它并使用 GetProcAddress 获取要使用的函数的地址。

# php - mysql查询后源代码中出现换行符

> ID：14270052
> 
> 赞同：0
> 
> 时间：2013-01-11T01:03:48.450
> 
> 标签：php, mysql, database, csv

我正在做一个简单的查询来从我的数据库中检索汽车制造商：

```
$result = mysql_query("SELECT DISTINCT model_make_display_name FROM car_query_models_full ORDER By model_make_display_name ASC") or die(mysql_error());

while ($row = mysql_fetch_array($result)) {
echo "<p>".$row['model_make_display_name']."</p>\n";
} 
```

数据在 HTML 视图中正常显示，但是当我查看源代码时，一些结果显示如下：

```
<p>Ariel
</p>
<p>Armstrong </p>
<p>Ascari
</p>
<p>Aston Mart</p>
<p>Audi
</p>
<p>Austin
</p>
<p>Austin Hea</p>
<p>Autobianch</p>
<p>Auverland
</p>
<p>Avanti
</p>
<p>Beijing
</p>
<p>Bentley
</p> 
```

请注意，一些名称在强制关闭 p 标签进入下一行的文本之后添加了一个中断，这可能是什么原因造成的？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:05:32.983

它存储在数据库中的方式导致了这种情况。

你可以试试：

```
echo "<p>" . htmlspecialchars( $row['model_make_display_name'] ) . "</p>\n"; 
```

或从值替换`\n`和：`\r`

```
SELECT ... REPLACE(model_make_display_name, '\n', '') 
```

[**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T01:07:58.730

您是否检查了这些制造商末端的换行符？尝试

```
echo "<p>".trim($row['model_make_display_name'])."</p>\n"; 
```

看看他们是否在场。如果是这样，只需清理数据库（在输入或一次性），你会很高兴。

# python - 使用会话下载时 Python 请求不清除内存

> ID：14270053
> 
> 赞同：5
> 
> 时间：2013-01-11T01:03:57.750
> 
> 标签：python, python-requests

我有一个应用程序，我使用请求从服务器下载 .mp3 文件。

代码如下所示：

```
self.client = requests.session(headers={'User-Agent': self.useragent})

def download(self, url, name):
    request = self.client.get(url)

    with open(name, "wb") as code:
        code.write(request.content)

    print "done" 
```

问题是当下载完成时，python 不会清除内存，所以每次我下载 mp3 时，应用程序的内存使用量会随着 mp3 的大小而增加。内存没有再次被清除，导致我的应用程序使用了大量内存。

我认为这与我如何保存文件或 requests.session 的工作方式有关。

有什么建议么。

编辑：这里是代码： [https ://github.com/Simon1988/VK-Downloader](https://github.com/Simon1988/VK-Downloader)

相关部分在 lib/vklib.py

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T01:16:54.977

除了您不了解内存分配的工作原理之外，我认为这里没有实际问题。

当 Python 需要更多内存时，它会要求操作系统提供更多内存。用完该内存后，它通常不会将其返回给操作系统；相反，它会为以后的对象保留它。

因此，当您打开第一个 10MB mp3 时，您的内存使用量会从 3MB 变为 13MB。然后释放该内存，但仍为 13MB。然后你打开第二个 10MB 的 mp3，但它重用了相同的内存，所以你仍然是 13MB。等等。

在您的代码中，您正在为每次下载创建一个线程。如果您一次有 5 个线程，全部使用 10MB，显然这意味着您使用的是 50MB。并且这 50MB 不会被释放。但是，如果您等待它们完成，然后再进行 5 次下载，它将再次重复使用相同的 50MB。

由于您的代码不会以任何方式限制线程数量，因此没有什么（CPU 速度和上下文切换成本不足）可以阻止您启动数百个线程，每个线程使用 10MB，即千兆字节的 RAM。但是只要切换到一个线程池，或者如果有太多的工作等，不让用户开始更多的下载，等等，就可以解决这个问题。

所以，通常，这不是问题。但如果是这样，有两种方法可以解决它：

1.  创建一个子进程（例如，通过`multiprocessing`模块）来完成占用内存的工作。在任何现代操作系统上，当一个进程消失时，它的内存就会被回收。这里的问题是，一遍又一遍地分配和释放 10MB 实际上会减慢系统速度，而不是加快系统速度——而且进程启动的成本（尤其是在 Windows 上）会使情况变得更糟。因此，您可能希望将大量作业分拆给 ac 子进程。

2.  不要一次将整个事情读入内存；使用流式 API 而不是整个文件 API。使用`requests`，这意味着`stream=True`在初始请求中设置，然后通常使用`r.raw.read(8192)`、`r.iter_content()`或`r.iter_lines()`循环而不是访问`r.content`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-11T01:07:38.720

您可以尝试分块流式传输内容：

```
def download(self, url, name):
    request = self.client.get(url, stream=True)  # `prefetch=False` for older
                                                 # versions of requests
    with open(name, "wb") as code:
        for chunk in request.iter_content(1024):
            if not chunk:
                break

            code.write(chunk) 
```

# php - 对非对象调用成员函数查询失败，MySQLI

> ID：14270057
> 
> 赞同：2
> 
> 时间：2013-01-11T01:04:12.177
> 
> 标签：php, mysqli

我在使用 MySQLI 代码生成寄存器时遇到问题。表/连接变量匹配，并且通过查询传递的正确变量填充了预期的字符串，在运行`query`或`prepare & execute`执行任何类型的查询时，我会返回以下内容：

> 致命错误：在第 40 行的 /var/www/New/API/FormValidations.php 中的非对象上调用成员函数 query()

我的代码如下：

```
$Query = $STD->prepare("SELECT * FROM Users WHERE Username='$Username'");
$Query->execute();
$Number = $Query->num_rows;
if ($Number !== 0)
{
    echo "Username Already In Use";
}
else
{
$Insert_User = $STD->prepare("INSERT INTO Users ('Username', 'Password') VALUES ('$Username', '$Password)");
$Insert_User->execute();
echo "Account Created!";
} 
```

这是我的连接脚本：

```
$STD = new mysqli('localhost', 'root', 'xxxxx', 'SLMS');
$AccessCon = new mysqli('localhost', 'root', 'xxxxx', 'DBAccess');

if ($AccessCon->connect_error) {
    die("Access Has Been Revoked. Please Contact Administration");
}

if ($STD->connect_error) {
    die("Standard Access Has Been Revoked. Please Contact Administration"); 
} 
```

和我的用户 SQL 表：

```
CREATE TABLE IF NOT EXISTS `Users` (
  `ID` int(255) NOT NULL AUTO_INCREMENT,
  `Username` varchar(255) NOT NULL,
  `Password` text NOT NULL,
  PRIMARY KEY (`ID`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=2 ; 
```

我已经尝试注释掉我所有的查询代码，并运行

`$Query = $STD->query("SHOW TABLES"); $Results = $STD->fetch_array(MYSQLI_ASSOC);`

`$Query`这仍然在我的变量上返回了一个错误。

我还尝试修改我的代码以搜索数据库中已经存在的内容：

```
$Query = $STD->prepare("SELECT * FROM Users WHERE Username='Test'"); 
```

并试图附上我的`$Username`如下：

```
$Query = $STD->prepare("SELECT * FROM Users WHERE Username='{$Username}'"); 
```

这执行了 No Success。我想知道是否有人可以阐明这种情况？

**编辑：**

注释掉整个脚本并运行：

```
$Query = $STD->query("SHOW TABLES");
$test = $Query->fetch_array(MYSQLI_ASSOC);
print_r($test); 
```

返回一个结果。

**更新：**

我已将代码修改为：

```
$Query = $STD->prepare("SELECT * FROM Users WHERE Username=?");
                $Query->bind_param("s", $Username);
                $Query->execute(); 
```

**最终更新：**

> 致命错误：在第 45 行的 /var/www/New/Register.php 中的非对象上调用成员函数 bind_param()

这是新的错误。

违规行：

```
 $Insert_User = $STD->prepare("INSERT INTO Users ('Username', 'Password') VALUES (?, ?)");
                $Insert_User->bind_param("ss", $Username, $Password);
            $Insert_User->execute(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:14:16.847

使用 prepare 时，您必须绑定保存您的值的变量。

例子：

```
 $city = "Amersfoort";

/* create a prepared statement */
if ($stmt = $mysqli->prepare("SELECT District FROM City WHERE Name=?")) {

    /* bind parameters for markers */
    $stmt->bind_param("s", $city);

    /* execute query */
    $stmt->execute();

    /* bind result variables */
    $stmt->bind_result($district);

    /* fetch value */
    $stmt->fetch();

    printf("%s is in district %s\n", $city, $district);

    /* close statement */
    $stmt->close();
} 
```

这是[准备好的陈述的链接](http://php.net/manual/en/mysqli.prepare.php)

**更新**

这个：

```
$Query = $STD->prepare("SELECT * FROM Users WHERE Username=s"); 
```

应该：

```
$Query = $STD->prepare("SELECT * FROM Users WHERE Username=?"); 
```

这个：

```
$Insert_User = $STD->prepare("INSERT INTO Users ('Username', 'Password') VALUES ('U', 'P)"); 
```

应该：

```
$Insert_User = $STD->prepare("INSERT INTO Users ('Username', 'Password') VALUES (?, ?)"); 
```

这个 ：

```
$Insert_User->bind_param('U', $Username);
$Insert_User->bind_param('P', $Password); 
```

应该是这样的：

```
$Insert_User->bind_param('ss', $Username,$Password); 
```

# c++ - 使用 stl map 作为 struct 的成员

> ID：14270068
> 
> 赞同：1
> 
> 时间：2013-01-11T01:05:08.630
> 
> 标签：c++, stl, map

我正在构建一个结构，其中一个成员是地图。
第一个问题允许这样做吗？编译器没有抱怨。

```
struct A {  
  map<int, float> B;  
} 
```

后来我声明了一个这种数据类型的数组。

```
A *C = (A *)INTERNAL_CALLOC(..., sizeof(A)); 
```

这里的函数`INTERNAL_CALLOC`是 MALLOC 的函数式包装器。
后来在代码中，当我第一次尝试将一个项目插入到数组的第一个元素的映射中时，我得到了一个核心转储。

```
C[0].B[0] = 0.001; 
```

知道为什么会这样吗？
谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T01:07:36.623

是的，结构中的映射很好。

用 with 分配`malloc`肯定**不行**；构造函数没有被调用。因此，当您尝试使用它时，您的地图很可能会做一些可怕的事情。

一般经验法则：不要在 C++ 中使用`malloc`/// 。尽可能避免动态分配，并在不可避免时使用/ 。^*`calloc``realloc``free``new``delete`

* * *

[* 并阅读*智能指针*。]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T01:37:47.937

如果您确实必须使用 INTERNAL_CALLOC 进行分配，请使用placement new。

首先，必须为类型 A 定义构造函数和析构函数，或者将 A 定义为类：

```
struct A {
  A(){}
  ~A(){}
  map<int, float> B;  
}; 
```

然后你可以简单地调用：

```
//Allocate an A, uninitialized
A *C = (A *)INTERNAL_CALLOC(..., sizeof(A));  
//Initialize the newly allocated A
new (C) A(); 
```

稍后当您释放对象时，您必须显式调用析构函数：

```
//A *C;
C->~A();
INTERNAL_free(C); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T01:28:18.693

```
A *C = (A *)INTERNAL_CALLOC(..., sizeof(A)); 
```

在这里，您对编译器撒谎。你告诉它返回值从`INTERNAL_CALLOC`指向 a `A`，但它没有，它只是指向零。使用`new`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T01:07:16.410

使用 malloc 分配内存不会初始化数组元素。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-11T01:08:34.307

`std::map<whatever...>`通过用零字节填充内存，您不会得到有效的。

在一定程度上，使用 POD 类型（大约是“纯 C”数据结构）是可能的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-11T04:50:55.593

由于您使用`std::map`作为成员，我建议使用`std::vector`而不是普通数组作为容器。

您可以执行以下操作：

```
struct A
{
    std::map<int, int> B;
};

std::vector<A> vecofmap;    

A elem0;
A elem1;
A elem2;

vecofmap.push_back(elem0);
vecofmap.push_back(elem1);
vecofmap.push_back(elem2);

vecofmap[0].B[0] = 100;

std::cout << vecofmap[0].B[0] <<std::endl; 
```

那么就不需要担心内存分配了。

# sml - 试图弄清楚如何运行代码标准元语言

> ID：14270070
> 
> 赞同：0
> 
> 时间：2013-01-11T01:05:16.850
> 
> 标签：sml, ml

我试图弄清楚如何运行代码标准元语言：

```
smallest [5, ~4, 3]; returns ~4

fun smallest L =
    if null (tl L)
    then hd L
    else if hd L < smallest (tl L)
         then hd L
         else smallest (tl L); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T01:44:27.700

您需要一个 SML 解释器或编译器。有多种可供选择，但[SML/NJ](http://www.smlnj.org/)很可能是最知名/最常用的。

其他包括（但不限于）[Moscow ML](http://www.itu.dk/~sestoft/mosml.html) (MosML)、[MLKit](http://www.itu.dk/research/mlkit/index.php/Main_Page)和[MLton](http://www.mlton.org/)。其中 MLKit 和 MLton 是编译器，而 SML/NJ 和 MosML 是解释器。

关于 SML的[维基百科文章](http://en.wikipedia.org/wiki/Standard_ML)是您了解更多有关 SML 的一个很好的起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T18:54:35.517

我推荐 PolyML。它有一些更好的 ML 文档。

# asp.net-mvc - 在 ASP.Net MVC 中，如何管理视图和布局页面之间的依赖关系？

> ID：14270076
> 
> 赞同：0
> 
> 时间：2013-01-11T01:06:02.600
> 
> 标签：asp.net-mvc

我们正在使用 ASP.Net MVC 和 Google Publisher Tags (GPT)。

GPT 要求您`<head>`在`<body>`. 这里的关键依赖是在这两个地方都是一个必须匹配的 id。所以头部将包含一些 Javascript，其中包括：

```
<head>
<script>
...
DefineSlot('div-gpt-ad-123456789-0', 'foo', 'bar')
...
</script></head> 
```

和

```
<body>
...
<div id='div-gpt-ad-123456789-0'>
  <script> 
  ...
  Display('div-gpt-ad-123456789-0')
  ...
  </script>
</div>
... 
```

我们如何管理这两段代码之间的依赖关系？**关键是两个部分的 id 必须匹配。**

我们想使用 MVC 动态地创建这些代码。因此，在任何视图、部分视图或布局中，我都可以添加一个可能如下所示的辅助调用：

```
@Html.CreateAd(size, "foo", "bar") 
```

`@Html.CreateAd`可以在视图、局部视图、布局或嵌套布局中的任何位置调用。

您如何使用 ASP.Net MVC 编写进入的代码`<head>`？

任何建议表示赞赏。我只是在寻找方向，而不是一个完整的解决方案。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T03:24:50.620

你有几种不同的方法来做到这一点。

您可以将 id 添加到 ViewData 或基本视图模型中。

然后在基本控制器中或通过操作过滤器中的 OnActionExecuting 或 OnActionExecuted，您可以将数据添加到您喜欢的任何位置。如果您需要这方面的示例，请对此答案发表评论。

然后，您可以从您决定的 2 个来源之一中阅读您的助手（每个部分一个）。两条路我都走了。如果您的所有页面都将有广告，那么我会倾向于基本 ViewModel。如果它更罕见，ViewData 会更合适。

要在 htmlHelper 扩展方法中访问视图数据：

```
public static class HtmlExtension
{
    public static MvcHtmlString RenderAdHead(this HtmlHelper h)
    {
        h.ViewContext.ViewData.Model // a test and cast here
        h.ViewContext.ViewData["AdIdentifier"] // test for null and cast here

        string tags = String.Empty;
        //build up string to resemble your script/html tags using either of the 
        //sources above, so long as either source is not empty.

        return new HtmlMvcString(tags);
    }
} 
```

还有一些过滤器代码：

```
public class AdvertisingFilter : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
       List<String> idList = null; // list of string might not be adequate. depends on your implementation
        //read advertising ids from your datastore or wherever you have. 

        filterContext.Controller.ViewData["advertisingFilter"] = idList;
    }
} 
```

基本控制器几乎相同，而是您直接拥有控制器上下文。您只需要确保您的所有控制器都继承自它们。

# xml - JAX WS：更改 xmlns 属性的位置

> ID：14270079
> 
> 赞同：0
> 
> 时间：2013-01-11T01:06:33.600
> 
> 标签：xml, soap, jax-ws

JAX WS 正在生成以下内容（仅显示了一个片段）：

```
<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
   <S:Body>
      <ns2:capMessageResponse xmlns:ns2="http://www.########.com" xmlns:ns3="test:one:two:1.2" xmlns:ns4="test:one:two:three:1.1">
         <ns3:alert>
            <ns3:identifier>1247275</ns3:identifier> 
```

这是生成它的方法：

```
@WebMethod(operationName = "capMessage", action = "urn:getCapMessages")
    @WebResult(name = "alert", targetNamespace="test:one:two:1.2")
    public List<AlertType> getCapMessage(String messageIds,String uniqueId,boolean skipHtmlStrip) throws CommsMessageException {
        try { 
```

我们需要做的是从输出中删除 capMessageResponse 并将 xmlns 属性移动到警报属性。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T06:08:11.433

要获得所需的输出，请在服务实现 bean 上指定以下注释

```
 @SOAPBinding(style = Style.DOCUMENT,parameterStyle=SOAPBinding.ParameterStyle.BARE) 
```

`Document`只有当您的 web 服务绑定是样式（这是默认的，并且从外观上看您已经在使用）时，此注释才合法。

不过，请注意这个选择

1.  您的消息负载不再用操作名称包装，这是您已经知道/想要的

2.  直接由于 1\. 上述，您将无法在同一 Web 服务上的另一个操作中使用相同的实体/参数类型，因为调度程序将没有任何信息可以继续成功调度消息

3.  同样由于 1（缺少相关信息），您的 Web 服务操作将无法接受多个参数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T03:39:30.423

从 Java 方法签名看起来您正在使用 DOCUMENT/WRAPPED 样式。你确定吗？如果是这种情况，那么使用当前方法签名将无法完成您希望的操作。

如果您创建一个新类来保存方法参数并切换到 BARE 样式，那么您可以获得您正在寻找的输出。此外，您可能还需要创建另一个类来保存集合返回值。

```
public List<AlertType> getCapMessage(CapMessageRequest request) throws ... 
```

# .net - 使用 Windows 身份验证的连接字符串

> ID：14270082
> 
> 赞同：175
> 
> 时间：2013-01-11T01:07:05.890
> 
> 标签：.net, asp.net-mvc, connection-string, windows-authentication

我正在创建一个网站，但在数据库中我使用 Windows 身份验证。

我知道您使用它进行 SQL 身份验证

```
<connectionStrings> 
    <add name="NorthwindContex" 
       connectionString="data source=localhost;
       initial catalog=northwind;persist security info=True; 
       user id=sa;password=P@ssw0rd" 
       providerName="System.Data.SqlClient" /> 
</connectionStrings> 
```

如何修改它以使用 Windows 身份验证？

* * *

## 回答 #1

> 赞同：243
> 
> 时间：2013-01-11T01:13:28.017

将用户名和密码替换为`Integrated Security=SSPI;`

所以连接字符串应该是

```
<connectionStrings> 
<add name="NorthwindContex" 
   connectionString="data source=localhost;
   initial catalog=northwind;persist security info=True; 
   Integrated Security=SSPI;" 
   providerName="System.Data.SqlClient" /> 
</connectionStrings> 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2019-03-06T09:08:01.677

要通过 Windows 身份验证连接到 sql server 数据库，基本上需要您要连接的服务器、您的数据库名称、集成安全信息和提供程序名称。

基本上这有效：

```
<connectionStrings>      
<add name="MyConnectionString"
         connectionString="data source=ServerName;
   Initial Catalog=DatabaseName;Integrated Security=True;"
         providerName="System.Data.SqlClient" />
</connectionStrings> 
```

将***Integrated Security***字段设置为**true**意味着您希望通过 Windows 身份验证访问数据库，如果您将此字段设置为***false*** ， Windows 身份验证将不起作用。

根据您使用的提供商，它的工作方式也不同。

*   **SqlClient**都 **集成安全=true；**或**IntegratedSecurity=SSPI；**正在工作中。

*   **OleDb** 是**Integrated Security=SSPI；**

*   **odbc** 是**Trusted_Connection=yes;**
*   **OracleClient** 是**Integrated Security=yes;**

> 与 OleDb 提供程序一起使用时，Integrated Security=true 会引发异常。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2017-12-13T12:33:04.987

几个小时后的正确解决方案：

1.  打开配置文件
2.  使用以下内容更改连接字符串

`<add name="umbracoDbDSN" connectionString="data source=YOUR_SERVER_NAME;database=nrc;Integrated Security=SSPI;persist security info=True;" providerName="System.Data.SqlClient" />`

3.  使用您当前的服务器名称更改**YOUR_SERVER_NAME**并保存
4.  打开 IIS 管理器
5.  查找网站或 Web 应用程序正在使用的应用程序池的名称
6.  右键单击并选择高级设置
7.  **从Process Model**下的 Advanced settings将**Identity** 更改**为 Custom 帐户**并添加您的 Server Admin 详细信息，请参阅附图：

[![在此处输入图像描述](../Images/5b10e908137a05796a126cdf1393cf78.png)](https://i.stack.imgur.com/t4Zay.jpg)

希望这会有所帮助。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2017-09-26T15:45:47.020

这更短并且有效

```
<connectionStrings>      
<add name="DBConnection"
             connectionString="data source=SERVER\INSTANCE;
       Initial Catalog=MyDB;Integrated Security=SSPI;"
             providerName="System.Data.SqlClient" />
</connectionStrings> 
```

不需要持久安全信息

# css - Overflow-x:hidden 不会阻止内容在移动浏览器中溢出

> ID：14270084
> 
> 赞同：170
> 
> 时间：2013-01-11T01:07:31.433
> 
> 标签：css, overflow, viewport, mobile-browser

我在[这里](http://02b23fa.netsolhost.com/wordpress1/)有一个网站。

在桌面浏览器中查看，黑色菜单栏仅正确延伸到窗口边缘，`body`因为`overflow-x:hidden`.

在任何移动浏览器中，无论是 Android 还是 iOS，黑色菜单栏都会显示其全宽，这会在页面右侧带来空白。据我所知，这个空格甚至不是`html`or`body`标签的一部分。

即使我将视口设置为以下特定宽度`<head>`：

```
<meta name="viewport" content="width=1100, initial-scale=1"> 
```

该站点扩展到 1100 像素，但仍有超过 1100 的空白。

我错过了什么？如何将视口保持在 1100 并切断溢出？

* * *

## 回答 #1

> 赞同：332
> 
> 时间：2013-01-11T03:10:49.937

在 中创建站点包装器 div`<body>`并将 应用`overflow-x:hidden`到*包装器*而不是`<body>`或`<html>`解决问题。

解析标签的浏览器似乎`<meta name="viewport">`只是忽略了和标签`overflow`上的属性。`html``body`

注意：您可能还需要添加`position: relative`到包装器 div。

* * *

## 回答 #2

> 赞同：99
> 
> 时间：2013-01-11T02:41:51.850

尝试

```
html, body {
  overflow-x:hidden 
} 
```

而不仅仅是

```
body {
  overflow-x:hidden 
} 
```

* * *

## 回答 #3

> 赞同：76
> 
> 时间：2014-07-13T21:09:00.087

[VictorS](https://stackoverflow.com/users/407615/victor-s)对已[接受答案](https://stackoverflow.com/a/14271049/444382)的评论应该是它自己的答案，因为它是一个非常优雅的解决方案，确实有效。我会增加一点它的用处。

维克多注意到添加`position:fixed`作品。

```
body.modal-open {
    overflow: hidden;
    position: fixed;
} 
```

确实如此。但是，它也有一个轻微的副作用，即基本上滚动到顶部。`position:absolute`解决了这个问题，但重新引入了在移动设备上滚动的功能。

如果您知道您的视口（[我的用于将视口添加到 的插件`<body>`](https://github.com/will-e-yams/yams.viewport)），您只需为`position`.

```
body.modal-open {
    // block scroll for mobile;
    // causes underlying page to jump to top;
    // prevents scrolling on all screens
    overflow: hidden;
    position: fixed;
}
body.viewport-lg {
    // block scroll for desktop;
    // will not jump to top;
    // will not prevent scroll on mobile
    position: absolute; 
} 
```

* * *

我还添加了这个以防止底层页面在显示/隐藏模式时向左/向右跳转。

```
body {
    // STOP MOVING AROUND!
    overflow-x: hidden;
    overflow-y: scroll !important;
} 
```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2016-04-18T11:52:14.603

正如@Indigenuity 所说，这似乎是由浏览器解析`<meta name="viewport">`标签引起的。

要从源头解决此问题，请尝试以下方法：

`<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">`.

在我的测试中，这可以防止用户缩小以查看溢出的内容，因此也可以防止平移/滚动到它。

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2017-09-04T14:49:11.270

这是在 Safari 中解决水平滚动的最简单的解决方案。

```
html, body {
  position:relative;
  overflow-x:hidden;
} 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2015-09-21T15:02:09.830

```
body{
height: 100%;
overflow: hidden !important;
width: 100%;
position: fixed; 
```

适用于iOS9

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-01-11T04:43:50.973

保持视口不变：`<meta name="viewport" content="width=device-width, initial-scale=1.0">`

假设您想实现右侧连续黑条的效果：`#menubar`不应该超过**100%**，调整**边框半径**，使右侧为正方形，并调整填充，使其向右延伸一点. 将以下内容修改为您的`#menubar`：

```
border-radius: 30px 0px 0px 30px;
width: 100%; /*setting to 100% would leave a little space to the right */
padding: 0px 0px 0px 10px; /*fills the little gap*/ 
```

将 调整`padding`为 10px 当然会将左侧菜单留在栏的边缘，您可以将剩余的**40px**放在左右两边各20px**上**`li`：

 **```
.menuitem {
display: block;
padding: 0px 20px;
} 
```

当您将浏览器缩小时，您会发现仍然是白色背景：将背景纹理从 div 改为`body`. 或者，使用媒体查询将导航菜单宽度从 100% 调整为较低的值。要对您的代码进行很多调整以创建正确的布局，我不确定您打算做什么，但上面的代码会以某种方式修复您的溢出栏。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2016-11-29T11:46:18.727

> 在正文中创建站点包装器 div 并将溢出->x:hidden 应用于正文或 html 的包装器 INSTEAD 解决了该问题。

在添加`position: relative`到包装器之后，这对我有用。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-03-23T03:46:53.663

`<div>`在整个内容周围添加一个包装器确实会起作用。虽然语义上“恶心”，但我在标签内添加了一个带有类 overflowWrap 的 div，`body`然后像这样设置我的 CSS：

```
html, body, .overflowWrap {
overflow-x: hidden;
} 
```

现在可能有点矫枉过正，但就像一个魅力！

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-07-23T16:26:36.273

我在 Android 设备上遇到了同样的问题，但在 iOS 设备上没有。通过在绝对定位元素的外部 div 中指定 position:relative 来解决（溢出：对于外部 div 隐藏）

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2015-10-16T09:17:16.607

以前没有一个单一的解决方案对我有用，我不得不混合它们并在旧设备（iphone 3）上解决了这个问题。

首先，我必须将 html 内容包装到外部 div 中：

```
<html>
  <body>
    <div id="wrapper">... old html goes here ...</div>
  </body>
</html> 
```

然后我不得不将溢出隐藏应用到包装器，因为溢出-x 不起作用：

```
 #wrapper {
    overflow: hidden;
  } 
```

这解决了这个问题。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2015-12-16T14:45:39.767

我通过使用 overflow-x:hidden; 解决了这个问题。如下

```
@media screen and (max-width: 441px){

#end_screen { (NOte:-the end_screen is the wrapper div for all other div's inside it.)
  overflow-x: hidden;
   }
 } 
```

结构如下

`1st div end_screen >> inside it >> end_screen_2(div) >> inside it >> end_screen_2.`

`'end_screen is the wrapper of end_screen_1 and end_screen_2 div's`

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-06-09T12:08:21.917

正如 subarachnid 所说，overflow-x 为 body 和 html 都隐藏了工作 这里的工作示例

```
**HTML**
<div class="contener">
  <div class="menu">
  das
  </div>
  <div class="hover">
    <div class="img1">
    First Strip
    </div>
     <div class="img2">
    Second Strip
    </div>
</div>
</div>
<div class="baner">
dsa
</div>

**CSS**
body, html{
  overflow-x:hidden;
}
body{
  margin:0;
}
.contener{
  width:100vw;
}
.baner{
   background-image: url("http://p3cdn4static.sharpschool.com/UserFiles/Servers/Server_3500628/Image/abstract-art-mother-earth-1.jpg");
   width:100vw;
   height:400px;
   margin-left:0;
   left:0;
}
.contener{
  height:100px;
}
.menu{
  display:flex;
  background-color:teal;
  height:100%;
  justify-content:flex-end;
  align:content:bottom;
}
.img1{
  width:150px;
  height:25px;
  transform:rotate(45deg);
  background-color:red;
  position:absolute;
  top:40px;
  right:-50px;
  line-height:25px;
  padding:0 20px;
  cursor:pointer;
  color:white;
  text-align:center;
  transition:all 0.4s;
}
.img2{
  width:190px;
  text-align:center;
  transform:rotate(45deg);
  background-color:#333;
  position:absolute;
  height:25px;
  line-height:25px;
  top:55px;
  right:-50px;
  padding:0 20px;
  cursor:pointer;
  color:white;
  transition:all 0.4s;
}
.hover{
  overflow:hidden;
}
.hover:hover .img1{
  background-color:#333;
  transition:all 0.4s;
}
.hover:hover .img2{
  background-color:blue;
  transition:all 0.4s;
} 
```

[关联](http://jsfiddle.net/Lkqyka7n/1/)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2019-11-24T15:00:40.573

我从这个主题的回复中尝试了很多方法，大部分都有效，但有一些副作用，比如`body,html`当用户在移动设备上向下滚动时，如果我在其上使用 overflow-x 可能会减慢/冻结页面。

在 body 内的 wrapper/div 上使用`position: fixed`也很好，但是当我有一个菜单并使用 Javascript 单击动画滚动到某个部分时，它不起作用。

所以，我决定`touch-action: pan-y pinch-zoom`在 body 中使用 wrapper/div。问题解决了。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-01-14T10:00:57.123

我已经为此工作了几个小时，尝试了此页面和其他页面中的各种组合。最终对我有用的事情是制作一个站点包装器 div，正如接受的答案中所建议的那样，但是将两个溢出都设置为隐藏，而不仅仅是 x 溢出。如果我在滚动时离开溢出-y，我最终会得到一个仅垂直滚动几个像素然后停止的页面。

```
#all-wrapper {
  overflow: hidden;
} 
```

仅此就足够了，无需在 body 或 html 元素上设置任何内容。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-06-15T15:11:52.913

解决这个问题的最简单方法，添加

`<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">`

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-08-12T06:28:26.020

为我的引导模式（包含表单）解决此问题的唯一方法是将以下代码添加到我的 CSS 中：

```
.modal {
    -webkit-overflow-scrolling: auto!important;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-10-17T21:15:16.630

第 1 步：将位置设置为固定到从视口出来的元素。就我而言，它是：

```
.nav-links {
    position:fixed;
    right:0px;
    background-color:rgba(0,0,0, 0.8);
    height:85vh;
    top:8vh;
    display:flex;
    flex-direction:column;
    align-items: center;
    width:40%;
    transform: translateX(100%);
    transition: transform 0.5s ease-in;
} 
```

Step2：在body和html中添加一个css属性：

```
body, html{
    overflow-x:  hidden;
} 
```

我没有添加任何包装。只有这两个步骤对我有用。我正在做的项目是一个有角度的项目。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2022-01-17T10:46:19.710

以下作品

```
body,
.innerbodywrapper{
overflow-x: hidden;
position: fixed;
width: 100%;
height: 100vh;
} 
```**

# android - 将字符串传递给片段

> ID：14270086
> 
> 赞同：1
> 
> 时间：2013-01-11T01:07:36.483
> 
> 标签：android, webview, fragment, android-view

我的 MainActivity 中有一个 EditText 视图，用户可以输入一个 url。此 MainActivity 还包含一个将保存 WebView 的片段。

我进行了设置，以便在显示片段时 URL 将加载到 WebView 中。但是我不知道如何将字符串传递给片段？

以下是主要活动代码：

```
public class MainActivity extends FragmentActivity {

Button goBtn;
EditText urlInput;
String url;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    goBtn = (Button)findViewById(R.id.button1);
    urlInput = (EditText)findViewById(R.id.editText1);

    goBtn.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            url = "http://"+urlInput.getText().toString(); //THIS TO FRAGMENT!

            Toast.makeText(v.getContext(), "Search:" + url, Toast.LENGTH_SHORT).show();
        }
    }); 
```

这是片段代码：

```
 WebView webDisplay;
String url;
AsyncHttpClient client;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState) {
    View v = inflater.inflate(R.layout.frag1_layout, container, false);
    urlDisplay = (TextView)v.findViewById(R.id.textView1);
    webDisplay = (WebView)v.findViewById(R.id.webView1);
    return v;
}

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);
    //url = "http://"+this.getActivity() ???
    client = new AsyncHttpClient();
    client.get(url, new AsyncHttpResponseHandler(){

        @Override
        public void onSuccess(String response) {
            Toast.makeText(getActivity(), "Success!", Toast.LENGTH_SHORT).show();
            webDisplay.setWebViewClient(new WebViewClient() {
                public boolean shouldOverrideUrlLoading(WebView view, String url) {
                          view.loadUrl(url);
                          return true;
                }}); 
            webDisplay.loadUrl(url);
        }
    }); 
```

我关心的值是 MainActivity.java 中的 String URL 变量。

片段的事务由 TabFragment 类控制。

```
public class TabFragment extends Fragment {

private static final int TAB1_STATE = 0x1;
private static final int TAB2_STATE = 0x2;
private int mTabState;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState) {
    View v  = inflater.inflate(R.layout.fragment_tab, container, false);
    //References to buttons in layout file
    Button tabBtn1 = (Button)v.findViewById(R.id.tabBtn1);
    Button tabBtn2 = (Button)v.findViewById(R.id.tabBtn2);

    //add listener to buttons
    tabBtn1.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View arg0) {
            //Action to perform when Tab 1 clicked...
            goToTab1View();

        }
    });

    tabBtn2.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            //Action to perform when Tab 2 clicked...
            goToTab2View();
        }
    });

    return v;

}

//Tab action functions.
protected void goToTab1View() {
    if(mTabState != TAB1_STATE){
        mTabState = TAB1_STATE;
        FragmentManager fm = getFragmentManager();
        if(fm!= null){
            //Perform fragment transaction
            FragmentTransaction ft = fm.beginTransaction();
            ft.replace(R.id.fragment_content, new FragTab1());
            ft.commit();
        }
    }
}

protected void goToTab2View() {
    if(mTabState != TAB2_STATE){
        mTabState = TAB2_STATE;
        FragmentManager fm = getFragmentManager();
        if(fm!= null){
            //Perform fragment transaction
            FragmentTransaction ft = fm.beginTransaction();
            ft.replace(R.id.fragment_content, new FragTab2());
            ft.commit();
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T01:45:31.673

或者`Bundle`使用方法创建和设置它`fragment.setArguments(myBundle);`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T01:43:42.920

这个答案是在片段已经存在的情况下

您可以在片段中定义公共方法。就像是：

```
public void setString(final String str) { //... } 
```

之后，让您的活动实现 OnClickListener 接口。当按下按钮时，只需键入以下内容：

```
public void onClick(View view) {
// Form url...
((YourWebViewFragment) getFragmentManager().findFragmentById(fragments_id)).setString(url);
} 
```

# button - 在sencha touch 2中添加到导航栏后设置按钮文本

> ID：14270090
> 
> 赞同：0
> 
> 时间：2013-01-11T01:08:06.567
> 
> 标签：button, view, sencha-touch-2, navigationbar

在视图的初始化方法中将按钮添加到导航栏后，我试图更改按钮上的文本。然而，当使用 Chrome 进行调试时，它会停止并在 Connection.js 上显示以下消息：未捕获的类型错误：无法读取未定义的属性 'readyState'。我认为这应该很简单，有点困惑！这是我的代码：

```
Ext.define('EventsTest.view.NavTest', {
    extend: 'Ext.navigation.View',

    config: {
        navigationBar: {
            items: [
                {
                    xtype: 'button',
                    text: 'Help',
                    id: 'favoritesHelp',
                    translate: true,
                    translationKey: 'navigationbar.helpbutton',
                    align: 'right'
                }
            ]
        },
        items: [
            {
                xtype: 'container',
                items: [
                    {
                        xtype: 'panel',
                        html: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin vehicula tincidunt purus, a dignissim dui rutrum ut. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Nullam pellentesque quam non orci porta sodales. Nulla laoreet varius libero, ac eleifend velit eleifend et. Proin a odio orci, sed bibendum libero. Maecenas eget nisl nec sapien sollicitudin mollis. Phasellus vel est eget risus ornare facilisis ac sed dui. Aliquam non feugiat sapien. In suscipit libero nec lorem lobortis molestie.'
                    },
                    {
                        xtype: 'button',
                        id: 'nextPage',
                        text: 'Next Page'
                    }
                ]

            }

        ]
    },

    initialize: function() {
        this.callParent();
        this.setDefaultBackButtonText('reverse');
        var helpBtn = this.getNavigationBar().query('#favoritesHelp');
        helpBtn.text = 'Yello';
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T09:30:15.900

这是因为你的查询是错误的。尝试替换这 2 行：

```
var helpBtn = this.getNavigationBar().query('#favoritesHelp');
helpBtn.text = 'Yello'; 
```

有了这个：

```
var helpBtn = Ext.getCmp('favoritesHelp');
helpBtn.setText("Yellow"); 
```

希望能帮助到你 ：）

* * *

**编辑：**

保持这样的查询是可以的，但您需要记住，您的查询将检索元素数组而不是单个元素。

除此之外，您不能通过使用更改按钮内的文本，`.text`因为它不会更改`innerHTML`按钮的。尝试使用这个：

```
var helpBtn = this.getNavigationBar().query('#favoritesHelp');
helpBtn[0].textElement.dom.innerHTML = "Yellow"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T11:55:47.973

我想这就是你想要的......

```
config: {
        listeners: {
                   initialize: function(){
                   this.down('button').setText('Whatever You Want')
        }
}} 
```

# c - SetEvent 和 WaitForMultipleObjects 的不可预测行为

> ID：14270091
> 
> 赞同：0
> 
> 时间：2013-01-11T01:08:17.497
> 
> 标签：c, winapi, synchronization

我正在尝试使用`SetEvent`，`WaitForMultipleObjects`因此我编写了几个我想使用事件同步的函数。我希望第一个函数执行，然后发出第二个函数执行的信号，这反过来又发出第一个函数再次执行的信号，依此类推。

创建了两个事件，一个初始化为有信号状态，另一个初始化为无信号状态。我可以让执行按预期进行的唯一方法是让每个线程休眠 10 毫秒。我阅读了有关使用 SetEvent 的一些注意事项：http: [//cboard.cprogramming.com/windows-programming/100818-setevent-resetevent-3.html](http://cboard.cprogramming.com/windows-programming/100818-setevent-resetevent-3.html)

我的问题是我必须让我的线程进入睡眠状态，因为这些函数调用需要额外的时间来实际发出事件信号吗？有时调试时，设置的事件仍然未发出信号。我使用流程资源管理器验证了这一点。我的代码基本上是这样的：

主要是：

```
//1\. FinCalcpidUpdatestruct <<  initialize to unsignalled
//2\. FinUpdatestructCalcpid << initialize to signalled
FinCalcpidUpdatestruct = CreateEvent (NULL, FALSE, FALSE, TEXT("FinCalcpidUpdatestruct"));
FinUpdatestructCalcpid = CreateEvent (NULL, FALSE, TRUE, TEXT ("FinUpdatestructCalcpid"));

void function1()
{
    int n;
    int noGoCode;
    n=0;

    noGoCode = 0;
    while(1)
    {
    //Sleep(10);
    noGoCode = WaitForSingleObject (FinCalcpidUpdatestruct, INFINITE);
    if (noGoCode == WAIT_OBJECT_0) {

    //wait for FinCalcpidUpdatestruct to be signalled
    BufferOut[n] = pid_data_array -> output;

    //signal FinUpdatestructCalcpid 
    if(!SetEvent (FinUpdatestructCalcpid))
        printf("Couldn't set the event FinUpdatestructCalcpid\n");
    else{
        printf("FinUpdatestructCalcpid event set\n");
        Sleep(10);
        }
    }
    else
        printf("error\n");
    }
}

void function2()
{
    int nGoCode = 0;
    while(1)
    {
    //wait for FinUpdatestructCalcpid to be signalled

    // Sleep(10);
    nGoCode = WaitForSingleObject (FinUpdatestructCalcpid, INFINITE);
    if (nGoCode == WAIT_OBJECT_0) {
    if(!SetEvent (FinCalcpidUpdatestruct))
        printf("Couldn't set the event FinCalcpidUpdatestruct\n");
    else{
        printf("FinCalcpidUpdatestruct event set\n");
        Sleep(10);
        }
    }
    else
        printf("error\n");
    }//end while(1) 
```

如果不使用睡眠，那么有时同一个函数会在 while 循环中运行几次，而不是在两个函数之间来回反复。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T07:24:02.793

您可以通过在每个函数`printf`的调用上方添加一个来解决问题。`SetEvent`

问题是您正在设置事件然后执行一些输出。

在`function2`之后`printf`发生`SetEvent`：

```
// Add a printf call here to see sensible output.
if(!SetEvent (FinUpdatestructCalcpid))
    printf("Couldn't set the event FinUpdatestructCalcpid\n");
else{
    // Thread is pre-empted by kernel here.  This is not executed immediately
    printf("FinUpdatestructCalcpid event set\n");
} 
```

内核[抢占](http://en.wikipedia.org/wiki/Preemption_%28computing%29)了正在运行的线程，`function2`因此`FinUpdatestructCalcpid`现在已经设置了事件，而没有`printf`您期望的对应。

然后执行正在运行的线程`function1`并设置`FinUpdatestructCalcpid`事件。现在允许正在运行的线程`function2`执行并从它停止的地方继续。它运行`printf`并且因为`FinUpdatestructCalcpid`事件已经设置它立即再次运行。

您正在使用的`Sleep()`调用有助于使这种竞争条件不太可能发生，但不要消除它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T08:09:18.700

为了简洁起见，让我先缩短您的代码：

```
FinCalcpidUpdatestruct = CreateEvent (NULL, FALSE, FALSE, TEXT("FinCalcpidUpdatestruct"));
FinUpdatestructCalcpid = CreateEvent (NULL, FALSE, TRUE, TEXT ("FinUpdatestructCalcpid"));

void function1()
{
    while(1)
    {
        WaitForSingleObject (FinCalcpidUpdatestruct, INFINITE);
        // Do Something
        SetEvent (FinUpdatestructCalcpid);
        printf(...);
        Sleep(10);
    }
}

void function2()
{
    while(1)
    {
        nGoCode = WaitForSingleObject (FinUpdatestructCalcpid, INFINITE);
        SetEvent (FinCalcpidUpdatestruct);
        printf(...); // **A**
        Sleep(10);
    }
} 
```

基本上在任何执行点，控制都可能从线程中拿走并交给另一个线程。现在假设`function2`已经设置了事件并且即将`**A**`在代码中打印输出。在打印输出之前，控制权被拿走并交给`function1`. 最后打印的输出已经来自`function1`并且它的等待事件被设置，所以它通过并再次打印它的东西。

发生这种情况时，您的输出会偶尔出现：

```
function1
function2
function1
function2
function1
// When the situation **A** above happens:
function1
function2
function2
function1
// And we move on as usual further
function2
function1
function2 
```

完成后设置你的事件，即之后`printf`，你会没事的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T03:40:27.573

这就是我的想法...

在设置事件之前，您不会输出任何状态。那时，执行可能会在您输出任何内容之前切换到另一个线程。如果该线程首先运行，那么它可能看起来好像一个线程的循环已经运行了第二次——一个没有乒乓球的 ping ...

但是，如果您要在接收信号和设置事件之间增加一个全局计数器，然后将该计数器的值保存到一个局部变量中，您可能会发现一个线程的计数总是奇数，而另一个线程的计数总是偶数（这是你想要的行为），即使输出不是很有序。

# c# - 如何使用 FileStream 覆盖现有文本

> ID：14270099
> 
> 赞同：2
> 
> 时间：2013-01-11T01:09:43.583
> 
> 标签：c#, io

**注意：我不能使用 FileMode.Create 或 FileMode.Truncate，因为它们会导致一些不必要的问题**

```
 byte[] data = new UTF8Encoding().GetBytes(this.Box.Text);
                FileStream f = File.Open(path, FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite);
f.Write(data, 0, data.Length);
                f.Close(); 
```

这会将新文本附加到旧文本的顶部。我怎样才能覆盖所有内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:16:42.777

你的代码

`byte[] data = new UTF8Encoding().GetBytes(this.Box.Text); FileStream f = File.Open(path, FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite); f.Write(data, 0, data.Length); f.Close();`

你怎么不能做这样的事情..？请解释为什么你不能使用`FileMode.Create`

```
byte[] data = new UTF8Encoding().GetBytes(this.Box.Text);
using(Stream f = File.Open(path, FileMode.Write)) 
{
   f.Write(data, 0, data.Length);
} 
```

您还可以执行以下操作

```
1\. Let the users write to the same file
2\. capture the users Machine Name or User Id then
2\. write a line in your file like this 

strSeprate = new string('*',25); 
//will write to the file "*************************";
f.Write(strSeprate);
f.Write(Machine Name or UserId);
f.Write(data);
f.Write(DateTime.Now.ToString());
f.Write(strSeprate); 
```

只是一个想法..

# java - 光栅之外的 Java getSubimage()

> ID：14270100
> 
> 赞同：8
> 
> 时间：2013-01-11T01:09:56.873
> 
> 标签：java, bufferedimage, raster

我正在尝试拍摄图像并将其存储在 16x16 子图像的数组中。我使用的图像是 512x512 像素。但是，在遍历循环时，getSubimage() 会因 Raster 异常而停止。

这是代码：

```
public class TileList extends JPanel {

  private static final int width = 16;          //width of a tile
  private static final int height = width;
  private int col = 1;
  private int row = 1;

  private BufferedImage image;
  File tilesetImage = new File("image.png");
  BufferedImage tileset[];

  public void loadAndSplitImage (File loadImage) {
    try{
        image = ImageIO.read(loadImage);
    }catch(Exception error) {
        System.out.println("Error: cannot read tileset image.");
    }// end try/catch
    col = image.getWidth()/width;
    row = image.getHeight()/height;
    tileset = new BufferedImage[col*row];
  }// end loadAndSplitImage

  public TileList() {
    loadAndSplitImage(tilesetImage);
    setLayout(new GridLayout(row,col,1,1));
    setBackground(Color.black);

    int x=0;
    int y=0;
    int q=0;                                    //keeps track of tile #
    for (int i = 0; i < row; i++) {

        for (int j = 0; j < col; j++) {
            JPanel panel = new JPanel();
            tileset[q] = new BufferedImage(width, height, image.getType());
            tileset[q] = image.getSubimage(x,y,x + width,y + height);
            panel.add(new JLabel(new ImageIcon(tileset[q])));
            add(panel);
            x += width;
            q++;
        }// end for loop
        y += height;
        x = 0;
    }// end for loop
  }// end constructor
}// end class 
```

这是错误：

```
Exception in thread "AWT-EventQueue-0" java.awt.image.RasterFormatException: (x
+ width) is outside of Raster
    at sun.awt.image.ByteInterleavedRaster.createWritableChild(ByteInterleav
edRaster.java:1245)
    at java.awt.image.BufferedImage.getSubimage(BufferedImage.java:1173)
    at TileList.<init>(TileList.java:59)
    at TileList.createAndShowGui(TileList.java:79)
    at TileList$1.run(TileList.java:88)
    at java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:251)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:721)
    at java.awt.EventQueue.access$200(EventQueue.java:103)
    at java.awt.EventQueue$3.run(EventQueue.java:682)
    at java.awt.EventQueue$3.run(EventQueue.java:680)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDo
main.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:691)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThre
ad.java:244)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.
java:163)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThre
ad.java:151)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:147)

    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:139)

    at java.awt.EventDispatchThread.run(EventDispatchThread.java:97) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-11T01:24:02.317

您将错误的参数传递给`getSubimage`. 医生说...

> 参数：
> x - 指定矩形区域左上角的 X 坐标
> y - 指定矩形区域左上角的 Y 坐标
> w - 指定矩形区域的宽度
> h - 指定矩形区域的高度矩形区域

你传入`x, y, x + width, y + width`，这意味着 if `x`= 256,`width`实际上等于`256 + 16 = 272`。

因此，您的新图像将是 ... `x + width = 256 + 272 = 528`，它比您的图像区域更宽。

你应该通过`x, y, width, heigh`

```
tileset[q] = image.getSubimage(x, y, width, height); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T01:25:44.240

来自 javadoc

```
* @param x the X coordinate of the upper-left corner of the
*          specified rectangular region
* @param y the Y coordinate of the upper-left corner of the
*          specified rectangular region
* @param w the width of the specified rectangular region
* @param h the height of the specified rectangular region 
```

这意味着以下行是错误的

```
image.getSubimage(x,y,x + width,y + height); 
```

它应该是这样的

```
image.getSubimage(x, y, width, height); 
```

有关完整的工作示例，请查看此[粘贴](http://www.nomorepasting.com/getpaste.php?pasteid=39032)

# php - PHP、Wordpress、phpMyAdmin、C、i18n、L10n 等中的双下划线？

> ID：14270101
> 
> 赞同：6
> 
> 时间：2013-01-11T01:09:58.037
> 
> 标签：php, c++, c, localization, internationalization

引用[另一个](https://stackoverflow.com/questions/1777131/double-underscore-in-php)让我在这里结束的问题。

*这些 PHP 代码行中的双下划线是什么意思？*

```
$WPLD_Trans['Yes']=__('Yes',$WPLD_Domain);
$WPLD_Trans['No']=__('No',$WPLD_Domain); 
```

以及有关在 Wordpress 等中使用等的`__()`相关问题。`_()`

开始作为对上述问题和其他相关问题的回答。但是发布为自己的问题（带有答案），因为它变得更加详细。

请随时编辑和改进 - 或输入更好的答案/问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-11T01:10:24.880

## 的使用`__(…)`

各种实现都使用双下划线。提到了 Wordpress (WP)，phpMyAdmin (PMA) 是另一个，等等。

它反映了[原生 PHP 函数](http://php.net/manual/en/function.gettext.php) `gettext()`，在 PHP 中有一个别名为单个[下划线](http://php.net/manual/en/function.gettext.php#refsect1-function.gettext-notes)：`_()`。这不是 PHP 独有的。[Gettext](http://en.wikipedia.org/wiki/Gettext)本身是一个长期存在的 GNU 项目，用于在类 Unix 系统上编写多语言程序。我们`_()`在各种编程语言中找到别名。

### 对主题的反思

在谦虚/诚实的意见中，可以说，`_()`作为本地和 `__()`自定义实现`gettext`，或其他特定于语言环境的用途，是唯一*有效*的 - 因为它是一个完善的约定。另一方面，它并不*好*，但即使如此简洁。例如，在 ANSI-C 标准中，双下划线`__`保留给编译器内部使用；并且由于 PHP 与 C 密切相关，因此他们保留了它，而且总的来说，即使跨语言（恕我直言）混淆也不是最好的事情，它处于边界/薄冰/等等。

（*这里的一个问题是选择[UnderscoreJS](http://underscorejs.org/)作为`_`他们的基础，与语言支持无关。*）将它与prototype.js 混合，`$`并且`$$`可能会理解为什么有人在看到时会挠头`__()`——尤其是拿考虑到 PHP 和 JS 在实现一个工作系统时有多接近。

* * *

## 语言环境支持

在这一步中，我对用法做了一些说明：**Locale support** with weight on `i18n`and `L10n`。

通过提供语言支持，它经常与[WP](http://codex.wordpress.org/I18n_for_WordPress_Developers)、[2](http://codex.wordpress.org/Plugin_API/Filter_Reference/gettext)、[3](http://blog-en.icanlocalize.com/installing-wordpress-for-multiple-language-blogs/how-to-localize-wordpress-themes-and-plugins-with-gettext/)和（有[据可查](http://www.phpmyadmin.net/home_page/translate.php)的）[PMA一起使用。](http://wiki.phpmyadmin.net/pma/Gettext_for_developers)例如：

`__('Error');`将产生`Feil`挪威语或`Fehler`德语。但是，这里需要注意的一件重要事情是，在同一领域中，我们拥有的不仅仅是直接翻译，还有在不同地区/文化/语言中发现的其他怪癖。

例如（指定）：

一些语言使用逗号 – `,`– 作为小数分隔符，其他语言使用点 – `.`– 用于相同目的。其他典型的*语言环境*变化是厘米与英寸、日期格式、12 与 24 小时制、货币等。所以：

```
       数字时间
LANG1：3,133.44 2.00 英寸 5:00 PM
LANG2：3.133,44 5,08 厘米 17:00

```

您揭开的下一层代码可能会参考一些相当神秘的约定，例如`i18n`变量`l10n`名、函数和文件名。

一旦您知道它们的含义，它们就非常方便，但定义可能会有些模糊。一般来说，我们有：

```
i18n：国际化
l10n：本地化（通常是 L10n）
g11n：全球化（例如 IBM 和 Sun Microsystems 使用）
l12y：可本地化（微软）
m17n：多语言化（国际化和本地化之间的连续体）
... 等等。

```

*哎呀，我的头好痛。*

数字是指单词中第一个和最后一个字母之间的字母数。之前和之后的字母 - 是单词中的第一个和最后一个字母。呸。所以：

```
       i18n l10n
国际化本地化
 | | | |
 +-- 18 个字母 --+ +-- 10 --+

我 18 nl 10 n

```

（我们也有更强大的*[数字名称](http://en.wikipedia.org/wiki/Numeronym)*，不遵循这个约定，比如`G8`（八人组）-，但是我们超出了编程领域-或者我们是这样吗？）。

然后是定义：

[W3C对](http://www.w3.org/International/questions/qa-i18n)*国际*化 (i18n) 和*本地化*(l10n)有一个相当清晰的定义。

*   国际化 (i18n) 是产品、应用程序或文档内容的设计和开发，**能够**为不同文化、地区或语言的目标受众轻松本地化。

*   本地化 (l10n) 是指**调整**产品、应用程序或文档内容以满足特定目标市场（区域设置）的语言、文化和其他要求。

[来自debian](http://www.debian.org/doc/manuals/debian-reference/ch08.en.html)的关于该主题的简短而简洁的版本是：

*   国际化 (I18N)：使软件有可能处理多个语言环境。
*   本地化（L10N）：使软件处理特定的语言环境。

## *域*的使用

 *通常，在查看代码、阅读等本地化时，会遇到*domain*的用法。一个对*搜索引擎更友好的*名称可能是`Translation Domain`.

（*在这里我有点如履薄冰。*）。

简而言之，可以将其定义为*context*。作为一个基地，你有一个语言环境。例如苏格兰。但是您可以进一步将域定义为主题、专业等的一部分。例如，*Java*在编程中与咖啡店有很大不同。或者在一个关于女性与农业的退化网站上*牛。*

提供一些线索的页面是 repoze.org，其中包含：

*   [翻译领域](http://docs.repoze.org/bfg/1.3/glossary.html#term-translation-domain)
*   [翻译目录](http://docs.repoze.org/bfg/1.3/glossary.html#term-translation-directory)

翻译目录通常是：

```
/path/to/your/translation_root/en_US/LC_MESSAGES/
/path/to/your/translation_root/en_GB/LC_MESSAGES/
/path/to/your/translation_root/nn_NO/LC_MESSAGES/
…

```

## 与 GetText 一起使用的文件

如果您看一下例如 PMA，您会发现一个名为`locale`. 它包含各种语言的各种目录。这些文件带有`.mo`扩展名。这是 GetText 特定的文件。一种通常从 PO（可移植对象）文件开始，它是纯文本文件。这些被索引并*编译*为 MO（机器对象）文件，这些文件被索引以进行优化。更多关于[这里](http://wiki.phpmyadmin.net/pma/Gettext_for_developers)的信息（与上面的*PMA*链接相同）。

* * **

# android - 有什么方法可以在 Manifest 中将 LargeHeap 用于 v3.x 并忽略 2.x？

> ID：14270102
> 
> 赞同：3
> 
> 时间：2013-01-11T01:10:03.940
> 
> 标签：android, manifest, android-largeheap

我很想在 Manifest 中使用*Android:LargeHeap="true"*选项来获得一些额外的内存（我们正在处理 5+ MB 高分辨率 1980x1200 显示器上的位图，并期望很快会有更大的显示器。

我已经用完了所有正常的技巧来处理Android中位图的糟糕内存处理（即除了尝试祈祷它不会崩溃之外，没有办法知道碎片内存中是否有足够大的洞）。我已经花了数周时间优化、修整和应用其他技巧来最小化内存并防止崩溃。这是 2.x 与 3.x/4.x 中可以完成哪些功能的技巧，但将所有功能都保存在一个应用程序中。无需指出“如何优化位图”——我已经完成了这些并应用了我能做的。

2.x 版本不支持 LargeHeap，我将不同的图像用于在 2.x 中不需要 LargeHeap 选项的低分辨率屏幕。（也没有内存不足的问题）。

当 android:minSdkVersion="8" 时，它根本不会允许 Android:LargeHeap 选项。

有什么方法可以有条件地为 3.x 的系统包含 LargeHeap，而在 2.x 中忽略它？或者如果检测到 3.x，应用程序本身是否会尝试设置 LargeHeap？我找不到任何方法来做到这一点，但也许我忽略了一些技巧。

我也意识到 LargeHeap 相当糟糕，但我们已经没有其他技巧了。理想情况下，以编程方式执行 LargeHeap 会很好，只有在 OnCreate 程序真正需要（并允许）时。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T01:18:19.283

> 当 android:minSdkVersion="8" 时，它根本不会允许 Android:LargeHeap 选项。

是的，它会的。

现在，如果您的*构建目标*（例如，Properties > Android）设置为 API Level 8，它将无法编译。您将需要使用构建目标 API 级别 11 或更高版本进行编译。但`android:minSdkVersion`与它无关。该选项在旧设备上将被忽略。

> 有什么方法可以有条件地为 3.x 的系统包含 LargeHeap，而在 2.x 中忽略它？

在清单`android:largeHeap="true"`中的元素中使用。`<application>`

> 或者如果检测到 3.x，应用程序本身是否会尝试设置 LargeHeap？

AFAIK，没有编程方式来设置它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-04-24T13:08:45.833

我使用这种方法：

在 AndroidManifest.xml 中

```
android:largeHeap="@bool/largeheap" 
```

我创建了 2 个 configuration.xml 文件

值中的第一个：configuration.xml

```
<bool name="largeheap">false</bool> 
```

values-v11 中的第二个（仅用于版本 >= 11）

```
<bool name="largeheap">true</bool> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-24T07:24:09.543

如果你处理很多大的位图，你最好使用 JNI，它不受堆限制，而是受设备 RAM 本身的限制。

另一种方法是根据设备有多少可用堆大小来灵活处理。

据我所知，使用 largeHeap 标志是可以的，但是你没有得到任何关于你得到多少堆大小的承诺，如果有的话。事实上，我不确定谷歌是否对制造商提出了关于它应该给你多少的要求。

为了使用 largeHeap 标志，只需在清单中设置它，并使用 targetSdk 将其设置为可用的最新标志。在 minSdk 中，您设置了您支持的最小 API，因此在旧设备上运行时会自动忽略此标志。属于新 API 的任何 xml 属性也是如此。

只有属于较新 API 的类和方法才会给您带来问题，但为此您应该阅读 Lint 的警告。

# jquery - 使用 Autocomplete jQuery 插件时，如何在 OnSelect 事件上动态创建输入框？

> ID：14270106
> 
> 赞同：0
> 
> 时间：2013-01-11T01:10:30.873
> 
> 标签：jquery, jquery-ui, input, autocomplete, onselect

我的情况很简单。我有一个容器 div。在其中我有一个名为 tagName 的输入框。为此，我附加了自动完成插件[(jquery.autocomplete.js)](http://www.devbridge.com/projects/autocomplete/jquery/)。当下拉出现时，使用键盘或鼠标选择国家时，我捕获 onSelect 事件并声明

```
 $('#tagName').autocomplete({
        lookup: countriesArray,
        onSelect: function () {
            $(this).parent().append($('<input/>', {
                value: '',
                type: 'text',
                name: 'paramName1',
                id: 'paramName1'
            }));
            $('#paramName1').focus(); 
```

在 onSelect 中，我可以应用自动完成功能，但如果我结束此功能，然后说

$('#paramName1').autocomplete({ 查找：cityArray,... 等

然后自动完成不会应用于 paramName1。

我觉得这种创建输入文本框的方法效率很低。如何创建输入框并动态为其分配 id？此外，自动完成插件必须在新创建的输入框上工作。感谢您的关注。

PS：我想在那之后，在悬停/焦点上添加一个删除按钮，额外的功能会更容易。这是我的第一个 jQuery 项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:28:08.167

您必须`$('#paramName1').autocomplete({ lookup: citiesArray,... etc.`在函数内部`onSelect`调用。它在外面不起作用的原因是该元素还不存在。因此，无法应用自动完成功能。

如果你想要动态的 id，你可以使用一个变量来设置它。

像这样的东西：

```
$('#tagName').autocomplete({
        lookup: countriesArray,
        onSelect: function () {
            $(this).parent().append($('<input/>', {
                value: '',
                type: 'text',
                name: 'paramName1',
                id: myDinamicId
            }));
            $('#'+myDinamicId).autocomplete({ lookup: citiesArray,... etc.
            $('#'+myDinamicId).focus(); 
```

有一个问题看起来很像你的问题。检查一下：[动态生成的文本框的 jquery 自动完成](https://stackoverflow.com/questions/1492198/jquery-auto-complete-for-dynamically-generated-textboxes)

# ruby-on-rails-3 - 在 Rails 中未找到 Authlogic 用户的易腐令牌

> ID：14270107
> 
> 赞同：0
> 
> 时间：2013-01-11T01:10:33.307
> 
> 标签：ruby-on-rails-3, authlogic

我将 Authlogic 与我的 Rails 应用程序一起使用，但我无法弄清楚为什么它有时无法根据易腐令牌找到用户。它通常有效，但有时不会。我使用此[代码](http://www.nathancolgate.com/post/184694426/adding-email-and-user-verification-to-authlogic)，以便在能够登录之前验证用户。但是，例如现在，我正在查看一个示例，即使当我查看用户的数据库，易腐令牌与用户的数据库相匹配。

过程是这样的：

在 users_controller #create

```
@user.deliver_verification_instructions!(@subdomain) 
```

在用户模型中：

```
def deliver_verification_instructions!(subdomain)
  reset_perishable_token!
  Notifier.verification_instructions(self, subdomain).deliver!
end 
```

在我的邮件中（Notifier.rb）

```
# email on new user registration to verify user
def verification_instructions(user,subdomain)
  @user = user
  @subdomain = subdomain
  @url  = "http://#{@subdomain.name}.foobar.com/user_verifications/#{@user.perishable_token}"
  sent_on       Time.now
  mail(:to => "#{user.first_name} <#{user.email}>",
    :subject => "Email Verification",
    :from => 'Foo <info@foobar.com>') do |format|
    format.text
    format.html
  end
end 
```

在电子邮件视图中：

```
Please click the following link to verify your email address:                                           
<%= @url %> 
```

在 User_verifications 控制器中

```
class UserVerificationsController < ApplicationController
  before_filter :load_user_using_perishable_token

def show
  @subdomain = Subdomain.find_by_user_name(current_subdomain)

  if @user
    @user.verify!
    flash[:notice] = "Thank you for verifying your account. You may now login."
  end
  redirect_to home_path
end

private
  def load_user_using_perishable_token
    @user = User.find_using_perishable_token(params[:id])
    flash[:notice] = "Unable to find your account." unless @user
  end
end 
```

该代码有时会返回“无法找到您的帐户”。这意味着即使电子邮件中 ​​url 中的令牌与我在数据库中看到的相匹配，它也没有找到易腐烂的令牌。

当我查看我在 Heroku 上的日志时，我看到的都是：

```
2013-01-11 00:10:01+00:00 app web.1     - - Started GET "/user_verifications/lTpNRnjDw4WbyAMUyw6" for 10.253.207.217/ip-10-253-207-217.eu-west-1.compute.internal at 2013-01-11 00:10:01 +0000
2013-01-11 00:10:02+00:00 heroku router - - at=info method=GET path=/user_verifications/lTpNRnjDw4WbyAMUyw6 host=mvfd.foobar.com fwd=10.253.207.217/ip-10-253-207-217.eu-west-1.compute.internal dyno=web.1 queue=0 wait=0ms connect=10ms service=1325ms status=302 bytes=96
2013-01-11 00:10:02+00:00 app web.1     - - cache: [GET /user_verifications/lTpNRnjDw4WbyAMUyw6] miss
2013-01-11 00:10:02+00:00 app web.1     - -   Processing by UserVerificationsController#show as HTML
2013-01-11 00:10:02+00:00 app web.1     - -   Parameters: {"id"=>"lTpNRnjDw4WbyAMUyw6"}
2013-01-11 00:10:02+00:00 app web.1     - - Redirected to http://mvfd.foobar.com/home
2013-01-11 00:10:02+00:00 app web.1     - - Completed 302 Found in 1008ms 
```

感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T16:08:59.997

默认情况下，Authlogic 会在 10 分钟后过期易腐令牌（出于安全考虑），因此一些用户可能会在密码重置链接过期后关注它。

您可以在用户模型中更改此设置：

```
class User < ActiveRecord::Base
  acts_as_authentic do |config|
    config.perishable_token_valid_for = 1.hour
  end
end 
```

[https://github.com/binarylogic/authlogic/blob/master/lib/authlogic/acts_as_authentic/perishable_token.rb#L15-L25](https://github.com/binarylogic/authlogic/blob/master/lib/authlogic/acts_as_authentic/perishable_token.rb#L15-L25)

或者，将不同的过期值传递给控制器​​中的 find_using_perishable_token 方法：

```
@user = User.find_using_perishable_token(params[:id], 1.hour) 
```

[https://github.com/binarylogic/authlogic/blob/master/lib/authlogic/acts_as_authentic/perishable_token.rb#L55-L63](https://github.com/binarylogic/authlogic/blob/master/lib/authlogic/acts_as_authentic/perishable_token.rb#L55-L63)

确保根据应用程序的安全要求考虑增加过期值的风险。

# magento - Magento - 如何查看产品是否有来自 list.phtml 的相关产品

> ID：14270109
> 
> 赞同：1
> 
> 时间：2013-01-11T01:10:43.767
> 
> 标签：magento

我需要一种方法来检查产品是否具有类别列表中的相关产品。

从这个文件：`/app/design/frontend/base/default/template/catalog/product/list.phtml`

** 编辑 **

如果有一种方法可以成功调用 getChildHtml('relatedProducts') （最初在 中找到`view.phtml`），`list.phtml`那么问题应该得到解决，但是我不能这样做。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-11T01:19:35.527

我可以通过调用来解决这个问题：

```
$_product->getRelatedProductIds(); 
```

# c++ - C++：空 if 语句

> ID：14270110
> 
> 赞同：4
> 
> 时间：2013-01-11T01:10:55.857
> 
> 标签：c++, if-statement

这更像是一个入门级问题，但我想知道有一个空的 if 语句是否是一种好习惯。

考虑这段代码：

```
void RabbitList::purge()
{
    if(head == NULL)
    {
        //cout << "Can't purge an empty colony!" << endl;
    }
    else
    {
        //Kill half the colony
        for(int amountToKill = (getColonySize()) / 2; amountToKill != 0;)
        {
            RabbitNode * curr = head;
            RabbitNode * trail = NULL;

            bool fiftyFiftyChance = randomGeneration(2);

            //If the random check succeeded but we're still on the head node
            if(fiftyFiftyChance == 1 && curr == head)
            {
                head = curr->next;
                delete curr;
                --size;
                --amountToKill;
            }
            //If the random check succeeded and we're beyond the head, but not on last node
            else if(fiftyFiftyChance == 1 && curr->next != NULL)
            {
                trail->next = curr->next;
                delete curr;
                --size;
                --amountToKill;
            }
            //If the random check succeeded, but we're on the last node
            else if(fiftyFiftyChance == 1)
            {
                trail->next = NULL;
                delete curr;
                --size;
                --amountToKill;
            }
            //If the random check failed
            else
            {
                trail = curr;
                curr = curr->next;
            }
        }
        cout << "Food shortage! Colony has been purged by half." << endl;
    }
} 
```

如您所见，第 5 行的 if 语句目前已被注释掉；这更像是一个调试文本，我不想再向控制台发送任何反馈。我很确定让 if 语句什么都不做会被认为是不好的做法。我知道我可以回来；

但由于我的返回类型是 void 它给了我一个错误。例如，如果我的返回类型不是 void 怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T01:12:33.457

即使你的返回类型是无效的，它在`return`那里也是合法的，而且当然因为`if`有大括号，至少这不是一个等待发生的错误。然而，它并不漂亮，需要更多的阅读/理解工作。

您可以将其**改写**为

```
if(head == NULL) // or if(!head)
    return;

.... 
```

这应该消除对 else 的需要，并且其余代码现在在函数内部而不是嵌套范围内，这是一个快乐的特权。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-11T13:08:24.310

对于单个分支，直接写即可：

```
if (head != 0) {
    // whatever
} 
```

对于多个分支，有时有一个空的第一个分支可以简化以下条件：

```
if (head == 0) {
    // nothing to do
} else if (head->next == 0) {
    // whatever
} else {
    // whatever else
} 
```

是的，你可以用一个额外的层写最后一个：

```
if (head != 0) {
    if (head->next == 0) {
        // whatever
    } else {
        // whatever else
    }
} 
```

但是第一种形式更清晰，尤其是当第二种形式以三四个级别的 if 结尾时。

哦，还有

```
if (head == 0)
    return; 
```

有时可能很困难，因为它为函数引入了额外的退出点。过去我是这种形式的粉丝，但在过去的几年里，我发现我最终会非常一致地删除它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-11T01:12:33.700

我会删除该`if`部分，直到第一个`else`，并将其替换为`if (head)`，这是相反的条件，因此非常适合`else`在 if-else 情况下替换。但是，整个函数需要一个额外的缩进标签。在这一点上，它确实变得更加偏好，但我自己更喜欢早点把支票弄出来，而不是缩进。

如果您需要从任何地方返回，您可以使用`return;`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-11T01:13:13.603

我实际上并不认为这是主观的。为什么要写死代码？这是初学者的标志。相反，只需检查您所追求的条件并完成它：

```
if(!head)
   // stuff 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-11T02:06:24.137

我通过删除重复和冗余重写了你的函数。它归结为相当小。

```
void RabbitList::purge()
{
    if(head == NULL) return;

    //Kill half the colony
    for(int amountToKill = (getColonySize()) / 2; amountToKill != 0;)
    {
        RabbitNode * curr = head;
        RabbitNode * trail = NULL;

        bool fiftyFiftyChance = randomGeneration(2);

        if(fiftyFiftyChance == 1 )
        {
            if( curr == head)
                head = curr->next;
            else
                trail->next = curr->next;

            delete curr;
            --size;
            --amountToKill;
        }
        else
        {
            trail = curr;
            curr = curr->next;
        }
    }
    cout << "Food shortage! Colony has been purged by half." << endl;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-11T01:37:46.593

正如@Oli 在评论中所说，这是一个主观风格问题。你有两个选择：

```
if (<something is true>) {
    // Do nothing
} else {
    // Some code goes here
} 
```

或者

```
if (!<something is true>) {
    // Code goes here
} 
```

我可以想象前者比后者更具可读性的情况，尤其是在条件比较复杂的情况下。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-11T03:38:28.357

我会离开它。

但我会虚拟化日志记录（std::cout 并不总是有用）。

```
struct NullLogger : public Logger
{
    virtual void log(std::string const&) {}
};

// By default use the Null Logger
// But if you need to debug just pass a useful specialization of logging.
void RabbitList::purge(Logger const& logger = NullLogger())
{
    if(head == NULL)
    {
        logger.log("Can't purge an empty colony!");
    }
    else
    { 
```

# git - 为什么我需要“git add”我签出的文件？

> ID：14270114
> 
> 赞同：0
> 
> 时间：2013-01-11T01:11:52.943
> 
> 标签：git, version-control

我用 签出一个项目`git clone`，添加了一些文件，并编辑了`README.md`已签出的项目。

当我做 a`git commit`时，我得到这个建议来添加我已经签出的文件。

```
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#       modified:   README.md 
```

*   为什么这个文件没有暂存？
*   我该怎么做才能自动暂存此文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T02:12:25.977

Git 不会将更改的文件和新文件添加到提交中。首先，您需要将文件更改为索引阶段（要提交的更改）。您可以`git add file`对新的和修改的文件或`git rm`删除的文件执行此操作。只有在您使用时“要提交的更改”中列出的文件`git status`才会在您执行`git commit`.

执行 a 时自动添加更改文件的一种简单方法`git commit`是传递选项`-a`: `git commit -a`。这样，所有更改的文件都将被提交。但是，不会提交新文件和删除的文件。如果您只想提交一些更改的文件，则需要手动添加每个文件`git add`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T01:18:41.927

该文件未暂存，因为默认情况下未暂存更改。如果您不想使用 git index 功能，则需要通过运行`git commit -a`或来提交更改`git commit file1 file2...`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T01:16:07.610

尝试这样做： `git commit -a -m "message"`

添加所有更改 `git add .`

# java - 如何将html文件映射到过滤器

> ID：14270115
> 
> 赞同：0
> 
> 时间：2013-01-11T01:11:55.203
> 
> 标签：java, google-app-engine

我正在使用 GAE 并希望将 html 文件映射到过滤器。我在 web.xml 中执行以下操作：

```
<filter-mapping>
  <filter-name>VerifierFilter</filter-name>
  <url-pattern>/test.html</url-pattern>
</filter-mapping> 
```

但是，如果我访问`http://localhost/test.html`，似乎根本没有调用过滤器代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T09:42:47.213

AFAIR GAE 不通过相同的 servlet 基础结构提供静态文件。所以这就是你的过滤器没有被应用的原因。

您可以尝试将您的 test.html 重命名为 test.jsp。这会将静态文件作为 jsp 提供，并且应该应用过滤器。但是，这种方式不会变得更快，但是如果您不关心性能，那么它可能是一个可行的选择。

# mysql - 获取mysql行的最新日期

> ID：14270120
> 
> 赞同：0
> 
> 时间：2013-01-11T01:12:34.097
> 
> 标签：mysql, join

抱歉我的描述不好，但我正在尝试获取最后吃每种水果的每个人的最新日期。我认为我的分组不正确，或者我完全错过了一些东西。有人可以帮我弄这个吗？提前致谢。

```
T1
+--------+--------+--------+
| person | fruit  |  date  |
+--------+--------+--------+
|  Bob   | apple  | 1-1-13 |
|  Bob   | apple  | 1-4-13 |
|  Bob   | apple  | 1-6-13 |
|  Bob   | orange | 1-2-13 |
|  John  | apple  | 1-3-13 |
|  John  | orange | 1-2-13 |
|  John  | orange | 1-4-13 |
|  John  | orange | 1-9-13 |
+--------+--------+--------+

Results I'm looking for
+--------+--------+--------+
| person | fruit  |  date  |
+--------+--------+--------+
|  Bob   | apple  | 1-6-13 |
|  Bob   | orange | 1-2-13 |
|  John  | apple  | 1-3-13 |
|  John  | orange | 1-9-13 |
+--------+--------+--------+ 
```

我从阅读类似帖子中得到的尝试。

```
SELECT * FROM T1 
  JOIN (
    SELECT person,max(date) AS latest 
      FROM T1 GROUP BY person
    ) T2
  ON T1.person = T2.person AND T1.date = T2.latest

Resulting in
+--------+--------+--------+
| person | fruit  |  date  |
+--------+--------+--------+
|  Bob   | apple  | 1-6-13 |
|  John  | orange | 1-9-13 |
+--------+--------+--------+ 
```

我如何让它也分离水果柱？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T01:15:19.657

这里不需要`JOIN`。带有 . 的简单聚合`GROUP BY`。

```
SELECT person, fruit, DATE_FORMAT(MAX(date), '%c-%e-%y') AS max_date
FROM T1
GROUP BY person, fruit 
```

**结果**

```
| 人 | 水果 | MAX_DATE |
------------------------------
| 鲍勃 | 苹果| 高分辨率照片| CLIPARTO 1-6-13 |
| 鲍勃 | 橙色 | 1-2-13 |
| 约翰 | 苹果| 高分辨率照片| CLIPARTO 1-3-13 |
| 约翰 | 橙色 | 1-9-13 |
```

## [看到它在行动](http://sqlfiddle.com/#!2/4d698/3)

# javascript - 结合 document.load + blur

> ID：14270122
> 
> 赞同：2
> 
> 时间：2013-01-11T01:12:39.383
> 
> 标签：javascript, jquery

我有以下 javascript 来确定版权格式是否正确：

```
 var copyright = $('#copyright')
    var copyright_text = copyright[0].value
    if (copyright_text.length > 0) {
        var containsYear = /\d{4}/.test(copyright_text);

        if (containsYear == false) {
            copyright.css({
               'background-color': 'rgba(230, 89, 78, 0.07)',
            });
            copyright.parent().append(
               '<div class="explanatory caution">CAUTION: Make sure this copyright contains a year.</div>'
            );

        };
    }; 
```

`.blur()`如果不从上面复制和粘贴所有代码，我将如何将相同的逻辑应用于上面的正常页面加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:15:46.037

添加后可以使用`.trigger`触发回调：

```
$(document).ready(function() {
    $('#copyright').blur(function() {
        var copyright = $('#copyright')
        var copyright_text = copyright[0].value
        if (copyright_text.length > 0) {
            var containsYear = /\d{4}/.test(copyright_text);

            if (containsYear == false) {
                copyright.css({
                   'background-color': 'rgba(230, 89, 78, 0.07)',
                });
                copyright.parent().append(
                   '<div class="explanatory caution">CAUTION: Make sure this copyright contains a year.</div>'
                );

            };
        };
    }).trigger('blur');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T01:18:41.960

将您拥有的代码放入函数中。当您感兴趣的事件发生时调用它：

```
$(document).load(function(){
    formatCopyright();

    $(<the-selector>).blur(function({
        formatCopyright();
    });

    function formatCopyright({
        // the code from your question goes here
    });
}); 
```

# lua - 如何在 redis 中执行命令而不得到任何响应？

> ID：14270126
> 
> 赞同：2
> 
> 时间：2013-01-11T01:13:25.260
> 
> 标签：lua, redis

我尝试在 redis 上执行命令，但不关心任何响应，甚至不希望任何最小化网络流量。stackoverflow 上的一个[答案](https://stackoverflow.com/questions/13025165/can-redis-disable-the-replies-for-pipelined-commands "回答")说一个不返回任何内容的 Lua 脚本可以帮助实现这一点，但是当我在 redis-cli 上尝试它并嗅探我的包时，无论我有没有在客户端和服务器之间传输相同数量的包不返回任何内容或返回整数 1 的脚本。

示例查询是：

*   评估“”0
*   评估“返回 1”0

在这两种情况下，wireshark 都显示交换了 4 个包。一个 [PSH, ACK] 客户端到服务器，[ACK] 从服务器到客户端， [PSH, ACK] 从服务器到客户端， [ACK] 从客户端到服务器。在第一种情况下，我希望作为 redis 响应的 [PSH, ACK] 包包含以下数据：

```
0000  02 00 00 00 45 00 00 39  bc a8 40 00 40 06 00 00   ....E..9 ..@.@...
0010  7f 00 00 01 7f 00 00 01  18 eb e6 bb 03 4d 7c 9c   ........ .....M|.
0020  e2 97 bf 53 80 18 23 df  fe 2d 00 00 01 01 08 0a   ...S..#. .-......
0030  11 cd c0 31 11 cd c0 31  24 2d 31 0d 0a            ...1...1 $-1.. 
```

在第二种情况下，这个包包含：

```
0000  02 00 00 00 45 00 00 38  fa 9f 40 00 40 06 00 00   ....E..8 ..@.@...
0010  7f 00 00 01 7f 00 00 01  18 eb e6 bb 03 4d 7c a1   ........ .....M|.
0020  e2 97 bf 76 80 18 23 dd  fe 2c 00 00 01 01 08 0a   ...v..#. .,......
0030  11 ce be 46 11 ce be 46  3a 31 0d 0a               ...F...F :1.. 
```

对于第二种情况，这一点很清楚。:1 是 1 的整数回复。但对于第一种情况，我不确定。$ 是批量回复的指标和 - 错误的指标。这是否意味着 $-1 是 redis-cli 中显示的 (nil) 的数据？还是我在那里完全错了？如果我是对的，是否有可能告诉 redis 我根本不想要任何响应（命令的 ACK 除外）？还是我必须分叉 redis 代码并自己实现它？

我真的很感激任何关于如何在不深入研究 redis 源代码的情况下完全没有响应的提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T15:57:01.117

```
EVAL "" 0             returns $-1\r\n
EVAL "return 1" 0     returns :1\r\n 
```

在第一种情况下，$-1 是一个特定的批量回复，用于表示 nil 值（如[协议规范](http://redis.io/topics/protocol)中所述）

AFAIK，不可能告诉 Redis 它不必发送回复（即使是空答案）。

正如 Marc Gravell 所解释的，您可以使用 Lua 捆绑多个操作并减少回复数据的数量。但是，您不会避免最小的回复数据包。

例如，您可以在一个 Lua 脚本中运行 100 次操作，并使用一个最小数据包作为回复。但是，IMO 无法避免此数据包，除非通过更改 Redis 源代码。

# c# - linq lambda 表达式和 '&' 运算符

> ID：14270129
> 
> 赞同：2
> 
> 时间：2013-01-11T01:13:38.950
> 
> 标签：c#, linq

我正在开发一个 ASP.NET MVC（较旧版本）应用程序，并且我有一个表格，根据主要代码和学生姓氏的字母为学生分配顾问。

我正在尝试实现以下代码，但它向`&`操作员显示红色涂鸦：

> 错误：运算符“&”不能应用于“ `System.Linq.IQueryable<Appointments.Models.MajorAdviserStudentAssignmentByAlpha>`”和“lambda 表达式”和“lambda 表达式”类型的操作数

```
var majorAssignmentByAlpha = FindAllMajorAdviserStudentAssignmentByAlphas()
    .Where(
           a => a.MajorString == student.StudentMajor) &
           (a => ((String.Compare(student.StudentLastName, a.AlphaStart) >= 0) &
                 (String.Compare(student.StudentLastName, a.AlphaEnd) <= 0))
    .FirstOrDefault());

if (majorAssignmentByAlpha != null)
    return majorAssignmentByAlpha.Adviser; 
```

我将不胜感激任何帮助以了解这里出了什么问题。提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T01:21:09.073

我想在这里添加一个更正：实际上两者`&&` *和* `&` **都是**C# 中的布尔 AND 运算符（与 一起使用时`bool`）。但是前者会进行[短路评估](http://msdn.microsoft.com/en-us/library/2a723cdk%28v=vs.110%29.aspx)：

考虑一下`A && B`，如果`A`是`false`则`B`不会被评估，因为`false`无论真实性如何，结果都将是`B`。

对于您遇到的错误，可能是因为您的`&`运算符正在比较布尔表达式和 lambda 表达式（函数）。试试这个

```
MajorAdviserStudentAssignmentByAlpha majorAssignmentByAlpha = FindAllMajorAdviserStudentAssignmentByAlphas().FirstOrDefault(
        a => a.MajorString == student.StudentMajor & String.Compare(student.StudentLastName, a.AlphaStart) >= 0 &
             String.Compare(student.StudentLastName, a.AlphaEnd) <= 0);

    if (majorAssignmentByAlpha != null)
        return majorAssignmentByAlpha.Adviser; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T01:16:36.170

那是因为您正在寻找的运算符是`&&`. 像这样重构你的 Linq 表达式

```
MajorAdviserStudentAssignmentByAlpha majorAssignmentByAlpha = FindAllMajorAdviserStudentAssignmentByAlphas().Where(
        a => a.MajorString == student.StudentMajor) &&
        (a => ((String.Compare(student.StudentLastName, a.AlphaStart) >= 0) &&
             (String.Compare(student.StudentLastName, a.AlphaEnd) <= 0)).FirstOrDefault());

    if (majorAssignmentByAlpha != null)
        return majorAssignmentByAlpha.Adviser; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T01:21:45.633

我认为您添加了太多括号。试试这个：

```
MajorAdviserStudentAssignmentByAlpha majorAssignmentByAlpha = FindAllMajorAdviserStudentAssignmentByAlphas().Where(
            a => a.MajorString == student.StudentMajor &&
                 String.Compare(student.StudentLastName, a.AlphaStart >= 0) &
                 String.Compare(student.StudentLastName, a.AlphaEnd <= 0)).FirstOrDefault();

if (majorAssignmentByAlpha != null)
    return majorAssignmentByAlpha.Adviser; 
```

.Where() takes a single expression returning `bool`. You are trying to and together two different expressions. If you remove the close parentheses before the `&&`, the open parentheses after and the second `a =>`, you're anding two boolean statements, which works.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-11T01:16:28.077

我认为您`&&`的意思是用于逻辑 AND 操作。

`FirstOrDefault()`也需要 a`Func<T, bool>`所以你可以这样做：

```
var majorAssignmentByAlpha = FindAllMajorAdviserStudentAssignmentByAlphas().FirstOrDefault(
            a => a.MajorString == student.StudentMajor &&
            (a => ((String.Compare(student.StudentLastName, a.AlphaStart) >= 0) &&
                 (String.Compare(student.StudentLastName, a.AlphaEnd) <= 0)); 
```

# python - 使用 pyodbc 连接 Teradata 数据库时出现问题

> ID：14270131
> 
> 赞同：3
> 
> 时间：2013-01-11T01:14:12.213
> 
> 标签：python, odbc, pyodbc

目前，我正在运行一个简单的 python 脚本来连接数据库：

```
import pyodbc
cnxn = pyodbc.connect('DRIVER={Teradata};DBCNAME=(MYDB);UID=(MYUSER); PWD=(MYPASS);QUIETMODE=YES') 
```

显然替换了服务器和凭据。但是，在运行此脚本时，我收到以下错误：

```
pyodbc.Error: ('200', '[200] [unixODBC][eaaa[DCTrdt rvr o nuhifraint o n (0) (SQLDriverConnectW)') 
```

我能找到的唯一帮助是[在这里](http://cjgoldsmith.blogspot.com/2011/03/teradata-odbc-python-pyodbc-on-fedora.html%20I%27ve)安装了**Teradata ODBC 驱动程序**，但我只是不明白为什么我无法连接。有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-15T11:23:04.113

我遇到了这个“非英语”错误消息问题。我认为这是由于使用了错误版本的 libodbc.so 和 libodbcinst.so。更改 /usr/lib/... 中的链接以指向安装了 teradata 的版本对我有用。在 64 位 Ubuntu 12.04 中使用默认安装目录的命令是：

```
cd /usr/lib/x86_64-linux-gnu
ls -lha | grep odbc (To should see the files below which are to be replaced).
sudo mv libodbc.so.1.0.0 Xlibodbc.so.1.0.0
sudo ln -s /opt/teradata/client/14.10/odbc_64/lib/libodbc.so libodbc.so.1.0.0 
sudo mv libodbcinst.so.1.0.0 Xlibodbcinst.so.1.0.0
sudo ln -s /opt/teradata/client/14.10/odbc_64/lib/libodbcinst.so libodbcinst.so.1.0.0 
```

我以前也安装过（通过 apt-get）odbcinst，所以我重定向了这两个文件。但可能只需要第一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-13T12:35:25.040

您必须使用以下方式进行连接：

```
TDCONN = pyodbc.connect('DSN=yourDSNname;',ansi=True, autocommit=True) 
```

你可以`DSN=yourDSNname;`用你已经拥有的东西替换。

# android - 动态调整小部件的内容和布局到用户通过 resize 定义的大小。安卓

> ID：14270138
> 
> 赞同：33
> 
> 时间：2013-01-11T01:15:24.273
> 
> 标签：android, android-widget

Android设计模式指南说小部件的内容和布局可以通过resize操作动态调整到用户定义的大小：[小部件设计指南](http://developer.android.com/design/patterns/widgets.html "设计指南小部件")

设计指南中提供的示例： ![设计指南中提供的示例图像。](../Images/a476f515b7bf34cdd77142ab0b5e9268.png)

但我在文档中看不到任何关于如何完成此操作的内容。我们如何根据调整大小操作更改布局？任何有关该方法的想法将不胜感激。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-01-13T06:09:17.103

感谢 A--C ，这对于 Jellybean 及以上设备是可能的，并且易于实现。下面是使用`onAppWidgetOptionsChanged`方法的示例代码

```
@TargetApi(Build.VERSION_CODES.JELLY_BEAN)
@Override
public void onAppWidgetOptionsChanged(Context context,
        AppWidgetManager appWidgetManager, int appWidgetId, Bundle newOptions) {

    Log.d(DEBUG_TAG, "Changed dimensions");

    // See the dimensions and
    Bundle options = appWidgetManager.getAppWidgetOptions(appWidgetId);

    // Get min width and height.
    int minWidth = options.getInt(AppWidgetManager.OPTION_APPWIDGET_MIN_WIDTH);
    int minHeight = options
            .getInt(AppWidgetManager.OPTION_APPWIDGET_MIN_HEIGHT);

            // Obtain appropriate widget and update it.
    appWidgetManager.updateAppWidget(appWidgetId,
            getRemoteViews(context, minWidth, minHeight));

    super.onAppWidgetOptionsChanged(context, appWidgetManager, appWidgetId,
            newOptions);
}

/**
 * Determine appropriate view based on width provided.
 * 
 * @param minWidth
 * @param minHeight
 * @return
 */
private RemoteViews getRemoteViews(Context context, int minWidth,
        int minHeight) {
    // First find out rows and columns based on width provided.
    int rows = getCellsForSize(minHeight);
    int columns = getCellsForSize(minWidth);

    if (columns == 4) {
        // Get 4 column widget remote view and return
    } else {
                    // Get appropriate remote view.
        return new RemoteViews(context.getPackageName(),
                R.layout.quick_add_widget_3_1);
    }
}

/**
 * Returns number of cells needed for given size of the widget.
 * 
 * @param size Widget size in dp.
 * @return Size in number of cells.
 */
 private static int getCellsForSize(int size) {
  int n = 2;
  while (70 * n - 30 < size) {
    ++n;
  }
  return n - 1;
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-30T15:25:23.537

@Choletski @azendh

> 更改布局后，不再调用某些点击事件

我通过创建 setOnClickPendingIntent on view 的函数解决了这个问题，然后返回它。

例如代码就像

```
private RemoteViews getConfiguredView (RemoteViews remoteViews, Context context){

    Intent refreshIntent = new Intent(context, EarningsWidget.class);
    refreshIntent.setAction(REFRESH_ACTION);
    PendingIntent toastPendingIntent = PendingIntent.getBroadcast(context, 3, refreshIntent, PendingIntent.FLAG_UPDATE_CURRENT);
    remoteViews.setOnClickPendingIntent(R.id.refreshButton, toastPendingIntent);
    return remoteViews;
} 
```

*然后在您执行“获取适当的远程视图”*的地方调用函数。

 *```
return getConfiguredView(new RemoteViews(context.getPackageName(), R.layout.activity_widget), context); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-19T17:50:54.343

基于[Gogu](https://stackoverflow.com/a/14301127/6126110)响应并根据[this answer](https://stackoverflow.com/a/15738825/6126110) about how to get widget size，我在以下位置创建了`WidgetClass`这个`Kotlin`：

```
class WidgetClass: AppWidgetProvider() {

    override fun onUpdate(context: Context?, appWidgetManager: AppWidgetManager?, appWidgetIds: IntArray?) {

        for (id in appWidgetIds!!) {
            //get widget options for later get widget dimensions
            val options = appWidgetManager?.getAppWidgetOptions(id)
            //get widget view based on widget size
            val view = getView(context, options)
            //update widget
            appWidgetManager!!.updateAppWidget(id, view)
        }

    }

    //listen for widget changes
    override fun onAppWidgetOptionsChanged(context: Context?, appWidgetManager: AppWidgetManager?,
                                           appWidgetId: Int, newOptions: Bundle?) {

        //update widget view based on new options
        appWidgetManager?.updateAppWidget(appWidgetId, getView(context, newOptions))

        super.onAppWidgetOptionsChanged(context, appWidgetManager, appWidgetId, newOptions)
    }

    private fun getView(context: Context?, options: Bundle?): RemoteViews {

        val minWidth: Int
        val minHeight: Int

        if (context!!.resources.configuration.orientation == ActivityInfo.SCREEN_ORIENTATION_PORTRAIT
            || context.resources.configuration.orientation == ActivityInfo.SCREEN_ORIENTATION_REVERSE_PORTRAIT) {

            minWidth = options?.getInt(AppWidgetManager.OPTION_APPWIDGET_MIN_WIDTH) ?: 0
            minHeight = options?.getInt(AppWidgetManager.OPTION_APPWIDGET_MAX_HEIGHT) ?: 0

        } else {

            minWidth = options?.getInt(AppWidgetManager.OPTION_APPWIDGET_MAX_WIDTH) ?: 0
            minHeight = options?.getInt(AppWidgetManager.OPTION_APPWIDGET_MIN_HEIGHT) ?: 0

        }

        //get widget view accordin widget size
        return if (minWidth >= 240)
            RemoteViews(context.packageName, R.layout.widget_large)
        else
            RemoteViews(context.packageName, R.layout.widget_small)
    }
} 
```*

# iphone - CGContextEOClip 或设置 layer.mask 哪个更有效？

> ID：14270139
> 
> 赞同：1
> 
> 时间：2013-01-11T01:15:24.490
> 
> 标签：iphone, ios, objective-c, ipad

我正在以非矩形形状遮盖图层。什么是最有效的方法，覆盖 drawRect: 并使用自定义路径的 CGContextEOClip，或者不覆盖 drawRect: 而是使用由同一路径制成的 CALayer 设置 layer.mask？

或者，有没有更有效的方法来屏蔽图层？

# truezip - TrueZip 7 需要 Java 7？NoClassDefFoundError：Java 6 上的 java/nio/file/Path

> ID：14270141
> 
> 赞同：3
> 
> 时间：2013-01-11T01:15:44.103
> 
> 标签：truezip

[TFile](http://java.net/projects/truezip/sources/v7/content/truezip-file/src/main/java/de/schlichtherle/truezip/file/TFile.java?rev=6136)依赖于 Java 6 上不可用的 java.nio.file.Path（toPath() 方法返回 java.nio.file.Path），因此在 Java 6 上调用任何 TFile 方法都会抛出“java.lang.NoClassDefFoundError: java/ nio/文件/路径”

您如何设法在 Java 6 上使用 TFile？我正在考虑的是获取源，在没有这种方法的情况下重新编译它们并使用修补版本，这是一种令人不快的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T01:01:54.370

不，TrueZIP 7 不需要 JSE 7，JSE 6 作为主页文件就足够了。但是，某些功能仅在 JSE 7 上可用（例如 TrueZIP 路径模块），因此需要执行运行时测试。

使用正确的类加载器实现，您将永远不会看到 NoClassDefFoundError。然而，一些环境已经破坏了类加载器的实现，它们执行急切的类加载——尽管规范要求延迟类加载。只有这样你才会得到 NoClassDefFoundError。

另一方面，请注意项目的 Eclipse 许可证。如果你真的想通过修补来解决这个问题（你不能因为 java.io.File 和 java.nio.file.Path 之间存在循环依赖关系，这是这种设计的原因），那么你将不得不发布这个 fork .

**附录：**

Java 6 的 Java 语言规范[第 12.2.1 章“加载过程”](http://docs.oracle.com/javase/specs/jls/se5.0/html/execution.html#12.2.1)中写道：

> ClassLoader 的不同子类可以实现不同的加载策略。特别是，类加载器可以缓存类和接口的二进制表示，根据预期使用预取它们，或者一起加载一组相关的类。例如，如果由于类加载器缓存了旧版本而找不到新编译的类版本，则这些活动可能对正在运行的应用程序不是完全透明的。然而，类加载器的职责是仅在程序中没有预取或组加载的情况下可能出现加载错误的地方反映加载错误。

英语不是我的母语，但我从最后一句话中得出的结论是，只要类加载器不会因为未使用的类未能及时加载而引发类加载器，就可以进行急切的类加载。因此，如果由于 TFile.toPath() 需要返回 java.nio.file.Path 导致类加载器抛出，尽管您从未调用此方法，那么我认为这是类加载器的问题。顺便说一句，TFile.toPath() 会引发 UnsupportedOperationException - 请查看 Javadoc 了解详细信息。

我宁愿采取另一条路线，但 java.io.File.toPath() 和 java.nio.file.Path.toFile() 之间的循环依赖让我别无选择。

# php - 使用 mod_rewrite 替换 URL 中使用的变量

> ID：14270144
> 
> 赞同：0
> 
> 时间：2013-01-11T01:16:26.497
> 
> 标签：php, .htaccess, url, mod-rewrite, url-rewriting

我经历了几个不同的问题，例如： [重写所有 URL](https://stackoverflow.com/questions/893218/rewrite-for-all-urls)

[mod_rewrite 可以转换任意数量的任意名称的参数吗？](https://stackoverflow.com/questions/884377/can-mod-rewrite-convert-any-number-of-parameters-with-any-names)

[在 htaccess 中创建动态 URL](https://stackoverflow.com/questions/5845609/creating-dynamic-urls-in-htaccess)

这帮助我将一组网址从 domain.com/script2.php?d=1 更改为 domain.com/(d)，但现在我遇到了一些我找不到答案的问题。目前，我有一组 URL 设置为：domain.com/script.php?a=1

虽然我知道如何将这些 URL 更改为 domain.com/(a) 但这并不能帮助我解决这个问题，因为变量 A 只是一个数字标识符，所以从 domain.com/script.php?products=1 到domain.com/1 对我没有什么好处。

相反，它是变量 B，它实际上是描述符 ProductName。所以我想要做的是拥有它，而不是 domain.com/(a)，我可以获得 domain.com/(b)。有一个并发症。最初设置使用变量A的原因是多个产品在变量B中使用相同的描述符，所以我还需要包括区分它们的变量C，所以我需要URL是domain.com/(b)-( C）。

奖金！还记得我说过我有另一个脚本从 domain.com/script2.php?d=1 更改为 domain.com/(d) 吗？好吧，如果我可以将当​​前脚本设置为不显示为 domain.com/(b)-(c) 而是显示为 domain.com/(d)/(b)-(c) 那就太棒了因为 domain/(d) 实际上是这个其他脚本的搜索页面，所以它是一个非常合乎逻辑的流程，并且会真正简化浏览，并且可以让用户在搜索和产品之间直观地移动而无需太多工作。

我不知道这是否可能，但任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:26:30.167

为什么不将所有内容都重写回您的脚本文件？

```
RewriteEngine on
RewriteBase /

RewriteRule .* index.php [L] 
```

将所有内容重写回 index.php。从那里您可以解析`$_SERVER['REQUEST_URI']`PHP 中的变量。从那里您可以根据给定的 url 决定要加载的页面。

如果您在上述重写规则的同一目录中有任何其他文件夹，`RewriteEngine Off`如果您不希望将它们重写回 index.php，则可以将另一个 .htaccess 文件放入其中。这就是 css 文件或站点图像所需要的。

使用这种方法，你总是可以做这样的事情。domain.com/products/1 或 domain.com/search/blahblah

# wpf - 离屏（FBO）OpenGL渲染为WPF创建帧？

> ID：14270149
> 
> 赞同：0
> 
> 时间：2013-01-11T01:16:43.363
> 
> 标签：wpf, performance, opengl, fbo, off-screen

我有一个 WPF 应用程序，屏幕的一部分显示了一个需要以 3D 动态呈现的对象，速度可能为 20 FPS。我知道通常 WPF 应用程序会使用 DirectX 进行 3D 渲染。（我也知道 WFP 有一个简化的 3D API，但我认为这不适用于我的情况，因为我有太多的三角形要渲染。）在我的情况下，我想使用 OpenGL，因为很有可能整个应用程序将被移植到非 Windows 机器上，我不想重写 3D 代码。

我看到有人尝试创建一个 OpenGL 可以直接渲染到其中的 WPF 控件，但是它们看起来都太粗糙/太冒险了。

作为一种更安全的方法，我认为我可以使用带有 OpenGL 的 FBO 将帧渲染到屏幕外，然后获取位图并将它们作为常规 2D 图像实时传递给 WPF。

我的问题是关于速度。您是否预计该计划中存在破坏交易的瓶颈？我假设 FBO 渲染将与 OpenGL 端的直接窗口渲染一样快？我希望从渲染的 OpenGL 图像 (FBO) 中提取位图应该很快？我不太确定将这些图像交给 WFP 并看到它们以 20 FPS 的速度更新。

你有具体的经验可以帮助我决定这是否是一个合理的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T10:06:19.943

> 我想使用 OpenGL，因为整个应用程序很有可能被移植到非 Windows 机器上

但这意味着你也必须重写整个 WPF 应用程序，因为这个框架不是跨平台的。所以在这种情况下，OpenGL 部分在这里只是次要问题。我认为你应该重新考虑整个 UI 技术。对于例如，我将使用[Qt SDK](http://qt-project.org/search/tag/qt~sdk)，因为它是真正的跨平台，您可以随意将它与 DirectX 和 OpenGL 连接。但是，如果您打算在 Windows 上坚持使用 WPF 并使用 OpenGL，则只需使用[C# OpenGL wrapper](http://www.opentk.com/)。是的，你会得到一些性能开销，因为它是一个包装器。就像那些用于 Java（JOGL，LWJGL）的游戏一样。但是像 MineCraft 这样的游戏最初是由这些 API 编写的并且可以正常工作。另一种更具挑战性的方法是 WPF COM 互操作并调用一些直接从 WPF 包装 OpenGL 渲染器的 C++ 应用程序，甚至可能正在使用[不安全模式](http://msdn.microsoft.com/en-us/library/ct597kb0%28v=vs.80%29.aspx)尽可能降低级别。我自己从未尝试过，但它可能会为您带来更好的性能。但实际上这是很多工作。最后，我建议您使用 DirectX for Windows，因为 WPF 自然与它有最好的集成。如果您的应用程序设计得很好，那么以后将它连接到 OpenGL 后端就不会有问题。

# jquery - 用 jquery 读取外部 php 变量

> ID：14270152
> 
> 赞同：0
> 
> 时间：2013-01-11T01:16:47.523
> 
> 标签：jquery

在将 jquery 与 php 和 php 与 jquery 混合方面，我是个新手。
我必须归档 script.php 和 test.php
我设法使用 jquery 将变量从 test.php 发布到 script.php，但现在我想将变量从 script.php 读取到 test.php
我的 test.php 是这样的：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/
libs/jquery/1.3.0/jquery.min.js">
</script>
<script type="text/javascript" >
$(function() {
$(".submit").click(function() {
var like = $("#like").val();
var rid = $("#rid").val();
var dataString = 'like='+ like + '&rid='+ rid;
//alert('like='+ like + 'rid='+ rid);

$.ajax({
type: "POST",
url: "script.php",
data: dataString,
success: function(){
$('.success').fadeIn(200).show();
}
});

return false;
});
});
</script>
<form method="post" name="form">
<input type="hidden" value="3" id="rid" name="rid">
<button type="submit" value="like" class="submit" id="like" name="like">test</button>
<span class="default"> <?=$value?></span>
<span class="success" style="display:none"> You like this</span>
</div></form> 
```

我的 script.php 是：

```
<?php
if($_POST['like']=="like")
{
    require_once"dbconfig.php";
$rid=$_POST['rid'];
mysql_query("INSERT INTO likes set like_value='1', video_id='".$rid."'");
$sql=mysql_query("SELECT * FROM likes where like_value='1' and video_id='".$rid."'")or die(mysql_error());
$result=mysql_num_rows($sql);

}

?> 
```

我想显示 $result 而不是“你喜欢这个”。我正在尝试这样做，因为我不想刷新整个页面（test.php）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:23:04.963

在您的`script.php`中，添加最后一行`echo $result;`，如下所示：

```
<?php
if($_POST['like']=="like")
{
    require_once"dbconfig.php";
    $rid=$_POST['rid'];
    mysql_query("INSERT INTO likes set like_value='1', video_id='".$rid."'");
    $sql=mysql_query("SELECT * FROM likes where like_value='1' and video_id='".$rid."'")or die(mysql_error());
    $result=mysql_num_rows($sql);
    echo $result; //Add this line
}
?> 
```

在你的 text.php 脚本中：

```
$.ajax({
    type: "POST",
    url: "script.php",
    data: dataString,
    success: function(result){ 
        $('.success').html(result); //Add this line
        $('.success').fadeIn(200).show();
    }
}); 
```

为什么要`result`在成功函数中添加参数？这是因为 result 将是您的响应`script.php`，在您的情况下是`$result`.

# regex - PHP正则表达式最后一个实例后的所有数字

> ID：14270157
> 
> 赞同：1
> 
> 时间：2013-01-11T01:17:08.970
> 
> 标签：regex

嗨，我想在最后一个实例之后获取所有数字 - in php

我的代码现在就是这样

```
$results = array();       
    $pattern = '/[^\-]*$/';       
    $pattern_no_chars ="[!0-9]";
    preg_match($pattern, $alias_title, $matches);         

    if(count($matches) <1){
        return $results;
    }

    $last_id = end($matches);
    $id_no_char = preg_replace($pattern_no_chars, '', $last_id); 
```

例如，一个 url 可能是 /image/view?alias_title=birkenhead-park-15-v-lymm-49-00601jpg-6514

在这种情况下，我想要 6514

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T01:19:22.037

你可以使用`explode()`：

```
$chunks = explode("-", $url);
$numbers = end($chunks); 
```

或者像这样的正则表达式：

```
/-(\d+)$/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:01:01.740

你也可以使用

```
preg_match('~(?<=-)\d+$~',$str,$m);
if (!empty($m)) echo $m[0]; 
```

这是细分：

```
(?<=-)  # last character before the match should be a dash
\d+     # 1 or more decimals (aka. the matched part)
$       # end of string 
```

这是一个例子

```
$str = '/view?alias_title=network-warringtons-optare-versa-hybrid-yj62fkl-102-1593';
preg_match('~(?<=-)\d+$~',$str,$m);
if (!empty($m)) echo $m[0]; 
```

最后，这是输出：**`1593`**

# r - 通过多列排列重新排序数据框中的行

> ID：14270159
> 
> 赞同：2
> 
> 时间：2013-01-11T01:17:16.000
> 
> 标签：r

我正在尝试重新排序`data.frame`包含大约 250,000 行和 7 列的 a。我想要在顶部的行是第`data.frame`2 列包含最低值和第 7 列最高但将按包含最低到最高值的列序列中的行：2,5,1,4,6,3 ,7 （因此第 5 列将具有第二低的值等）。

一旦识别出与此序列匹配的任何行，它将继续查找列值在序列 2、5、1、4、6 中从最低到最高的行，然后是 2、5、1、4，依此类推，直到只有第 2 列最低的行，其他列值是随机分类的。任何没有第 2 列作为最小值的行都将被忽略，并且在已排序的行下方未排序。我正在努力想出任何可行的解决方案来解决我的问题 - 在提供与我正在使用的类似数据方面，我能做的最好的事情是：

```
df<-data.frame(matrix(rnorm(70000), nrow=10000))
df<-abs(df) 
```

如果有人有任何想法，我会全力以赴。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T01:45:23.213

鉴于您有一个较大的统一类型（数字）数据集，我建议使用矩阵而不是 data.frame

```
 tt <- abs(matrix(rnorm(70000), nrow=10000)) 
```

您有一个想要匹配的订单

```
 desiredOrder <- c(2,5,1,4,6,3,7) 
```

您需要找出每一行的顺序。我认为这里最简单的方法是确保为您提供一个列表，其中每行都有一个元素。我建议这样的事情。

```
 orders <- lapply(apply(tt, 1, function(x) list(order(x))), unlist) 
```

然后，您将需要经历（从`desiredOrder[seq_len(7)]`to `desiredOrder[seq_len(1)]`测试特定行的所需订单子集何时等于所需订单的所需子集。（我认为`sapply`with`which`和的某种组合`all`）

一旦您确定了与所需结果匹配的所有行，您可以使用它`setdiff`来查找不匹配的行，然后`tt`使用此`new order`向量重新排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:37:50.977

一种可能的方法是对列中的值进行加权排名。这将类似于等级回归。7 列 250K 行并不是那么大。对于您希望低值具有更高权重的那些，您可以从 NROW(dfrm) 中减去排名。如果您想在该列排序方案中缩放 wieighting，则只需乘以权重向量：例如 c(1, .6, .3, 0, .3, .6, 1)

```
dmat <- matrix(sample(20, 20*7, repl=TRUE), 20, 7)
dfrm <- as.data.frame(dmat)

dfrm$wt <- sapply( dfrm[ c(2,5,1,4,6,3,7)] , rank); dfrm
 dfrm$wt[,1:3]  <- rep(NROW(dfrm),3) - dfrm$wt[ , 1:3] 
 dfrm$wt <- dfrm$wt*rep(c(1, .6, .3,  0, .3, .6, 1), each=NROW(dfrm))
 dfrm[ order( apply( dfrm$wt, 1, FUN=sum), decreasing=TRUE ) , ] 
```

这并不强制将 V2 的最低值排在第一位，因为您暗示了一个多重标准。如果这与您想象的不完全一样，您仍然可以重新加权。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T06:55:00.280

***您可以使用将索引***`order()`返回到排序的事实， 这正是您要匹配的内容

 **```
For example if we apply `order` twice to each row of 
  [1,]   23   17  118   57   20   66  137
  [2,]   56   42   52   66   47    8   29
  [3,]   35    5   76   35   29  217   89

We would get
  [1,]    2    5    1    4    6    3    7
  [2,]    6    7    2    5    3    1    4
  [3,]    2    5    1    4    3    7    6 
```

然后您只需要检查哪些行与您要查找的内容匹配。

* * *

有几种方法可以实现这一点，下面是一个示例，我们创建
一个逻辑矩阵 ，`comparisons`它指示行的每个元素是否
处于“正确”位置，如 所示`expectedOrder`。然后，我们按照“正确列”中有

多少元素对原始行进行排序。
（当然，松散地使用这个短语）

```
# assuming mydf is your data frame or matrix

# the expected order of the columns
expectedOrder <- c(2,5,1,4,6,3,7)

# apply the order function twice. 
ordering <- apply(mydf, 1, function(r) order(r) )  

# Recall that the output of apply is transposed relative to the input. 
# We make use of this along with the recycling of vectors for the comparison
comparisons <-  ordering == expectedOrder

# find all rows with at least matches to 2,5,1,4
topRows  <- which(colSums(comparisons[1:4, ])==4)

# reorder the indecies based on the total number of matches in comparisons
#  ie:  first all 7-matches, then 5-matches, then 4-matches
topRows <- topRows[order(colSums(comparisons[,topRows]), decreasing=TRUE)]

# reorder the dataframe (or matrix) 
mydf.ordered <- 
  rbind(mydf[topRows, ],  
        mydf[-topRows,])

head(mydf.ordered)
 #    X1 X2  X3  X4  X5  X6  X7
 #    23 17 118  57  20  66 137
 #    39 21 102  50  24  53 163
 #    80  6 159 116  44 139 248
 #   131  5 185 132 128 147 202
 #    35 18  75  40  33  67 151
 #    61 14 157  82  57 105 355 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T03:05:41.600

像这样：

```
dat <- as.matrix(df)
rnk <- t(apply(dat, 1, rank))
desiredRank <- order(c(2,5,1,4,6,3,7))
rnk.match <- rnk == matrix(desiredRank, nrow(rnk), ncol(rnk), byrow = TRUE)
match.score <- apply(rnk.match, 1, match, x = FALSE) - 1
match.score[is.na(match.score)] <- ncol(dat)
out <- dat[order(match.score, decreasing = TRUE), ]

head(out)
#            X1         X2        X3        X4        X5       X6        X7
#[1,] 0.7740246 0.19692680 1.5665696 0.9623104 0.2882492 1.367786 1.8644204
#[2,] 0.5895921 0.00498982 1.7143083 1.2698382 0.1776051 2.494149 1.4216615
#[3,] 0.1981111 0.11379934 1.0379619 0.2130251 0.1660568 1.227547 0.9248101
#[4,] 0.7507257 0.23353923 1.6502192 1.2232615 0.7497352 2.032547 1.4409475
#[5,] 0.5418513 0.06987903 1.8882399 0.6923557 0.3681018 2.172043 1.2215323
#[6,] 0.1731943 0.01088604 0.6878847 0.2450998 0.0125614 1.197478 0.3087192 
```

在这个例子中，第一行匹配整个排名序列；接下来的行匹配序列的前五个等级：

```
head(match.score[order(match.score, decreasing = TRUE)])
# [1] 7 5 5 5 5 5 
```**

# python - 存储 1000 个数据框对象的 Pandas

> ID：14270163
> 
> 赞同：1
> 
> 时间：2013-01-11T01:18:06.950
> 
> 标签：python, object, pandas, dataframe, storage

我正在从事一个大型项目，该项目进行 SPC 分析并拥有 1000 个不同的不相关数据框对象。有谁知道用于在内存中存储对象的模块？我可以使用 python 字典，但想要更精细和更实用的机制，如锁定、线程安全、谁拥有它和等待列表等？我正在考虑创建一些类似于我当地公共图书馆系统的东西。它向一位所有者签入和签出书籍的方式......等等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:16:12.727

[HDF5-pytables](http://pandas.pydata.org/pandas-docs/dev/io.html#hdf5-pytables)是 pandas 一个非常好的存储后端。

[Pytables](http://www.pytables.org/moin)可以扩展为像文件系统一样进行管理，但是如果您需要任何类型的多访问，则必须小心*（如果您真的需要，您应该使用提供这些功能的传统数据库）*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T04:30:05.020

带有 redis-py 的 Redis 是一种解决方案。Redis 非常快，并且有很好的 Python 绑定。如上所述，Pytables 也是一个不错的选择。PyTables 是 HDF5，而且速度非常快。

# javascript - jqGrid 动态列和分组

> ID：14270168
> 
> 赞同：0
> 
> 时间：2013-01-11T01:18:34.067
> 
> 标签：javascript, jquery, jqgrid

我正在为我的网格使用 jqGrid。我正在努力解决一个问题。我的客户想要一个看起来像这样的网格：

![网格示例](../Images/62964eccff8f14bbbe38972c5379c7e2.png)

这里的问题是 Auto Makes 的动态列和分组。我真的不知道如何做到这一点。这个想法是最右边的计数是自动生成分组的总和。自动生成可以根据其余查询的结果而改变。

我尝试只使用 jqGrid 中的行分组功能并完成了类似的事情，但它的视觉效果非常不同。他坚持这种形式。

如果有人能指出我正确的方向来解决这个问题，那就太好了。我真的不知道从哪里开始。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T06:16:25.827

我认为您正在寻找标题分组试试这个，

[http://www.trirand.com/jqgridwiki/doku.php?id=wiki:groupingheadar](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:groupingheadar)

# mysql - 如何从 Ruby MySQL 驱动程序中的“.my.cnf”读取用户名/密码？

> ID：14270169
> 
> 赞同：1
> 
> 时间：2013-01-11T01:18:37.733
> 
> 标签：mysql, ruby

有没有办法使用 mysql gem 连接到 MySQL 服务器而不传递用户名/密码组合，而是从 .my.cnf 文件加载它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:25:34.060

加载它们的最简单方法是使用`inifile`gem。

```
require 'inifile'
client_options_hash = IniFile.new('~/.my.cnf')['client'] 
```

然后您可以使用 from 的值`client_options_hash`来设置您的连接。

# c - 在 Aero 窗口中禁用 VSync

> ID：14270174
> 
> 赞同：0
> 
> 时间：2013-01-11T01:18:43.753
> 
> 标签：c, windows, opengl, aero

我正在为 Windows（XP、Vista、7、8）开发一个窗口化（非全屏）OpenGL 应用程序，其中 VSync 和 GPU 帧队列会导致非常明显（和糟糕）的输入延迟。我使用 wglSwapBufferEXT 来禁用 VSync，并在 SwapBuffers 之后使用 glFinish 来防止帧排队。

问题是，在启用 Aero 的 Windows 版本上，输入延迟仍然存在。禁用 Aero 可以解决问题，但我们不想强迫用户这样做。有没有办法阻止 Aero 在我们的应用程序上强制 VSync，或者只为我们的应用程序禁用 Aero？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:36:52.007

您可以在应用程序运行时使用该`DwmEnableComposition`功能禁用 Aero。我不确定这是否正是您所说的“仅为我们的应用程序禁用 Aero”的意思。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:30:15.050

Aero 是一个窗口合成系统。合成器本质上会引入渲染延迟，甚至可能长达 2 帧周期。克服这个问题的唯一方法是禁用合成器。

* * *

大约两年前，我确实为基于 X11 Composite 的系统概述了一个同步方案，其中每个程序都会提供有关其渲染时间的“单圈时间”。基本上你不能让你的延迟比渲染你的帧所花费的时间更短。但是，如果您设法尽可能长时间地延迟渲染帧的开始，将用户输入整合到渲染的最开始，您将获得尽可能短的延迟。

这个想法是让合成器收集时间统计信息，合成窗口需要多长时间以及每个程序渲染一帧需要多长时间。然后合成器会给每个程序一个“现在开始渲染”的信号，这样渲染就会在 V-Sync 之前及时完成合成。

不过，到目前为止，我还没有实现这一点。

# javascript - 使用 HTML 页面获取浏览器大小

> ID：14270175
> 
> 赞同：-1
> 
> 时间：2013-01-11T01:18:46.327
> 
> 标签：javascript, html

我有一个按钮，当它被点击时，它会调用一个获取浏览器大小的警报，但它只是说未定义 x 未定义。如果我删除功能部分，那么它将正常工作。我如何让它与按钮单击一起工作？

```
<input type="button" onclick="alertME()" value="Finish">

<script>

function alertME() 
{
alert (screen.width + 'x' + screen.height);
}

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:26:22.630

当您收到未定义的消息时，您是否使用 firefox 打开文件？如果有是哪个版本？我知道我的代码可以正常工作（v17）在旧版本中可能不支持屏幕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T01:28:10.193

尝试以下操作：

```
<input type="button" onclick="alertME()" value="Finish">

<script>

function alertME() 
{
var width = document.body.offsetWidth;
var height = document.body.offsetHeight;
alert (width + 'x' + height);
}

</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T01:32:41.557

这在 jsFiddle 上为我修复了它：

```
var width = screen.width;
var height = screen.height;

window.alertME = function()
{
    alert(width + 'x' + height);
} 
```

HTML：

```
<input type="button" onclick="alertME();" value="Finish"> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T01:37:36.460

当您收到未聋消息时，您是否使用 Firefox 打开文件？如果是这样，哪个versafdsgion？我知道 minedadg 可以正常使用此代码（v17）在较旧的版本中可能不支持屏幕。dfkjngdojsndosgdg

# php - 从另一个具有不同结构的数组中构建一个数组

> ID：14270176
> 
> 赞同：0
> 
> 时间：2013-01-11T01:18:50.953
> 
> 标签：php, multidimensional-array

我有这个数组如下：

```
 Array ( 
[pageid_01_page_name] => first Page  
[pageid_01_Style] => full 
[thePageID_1] => pageid_01 
[theElementID_1] => 1 
[source_type_1] => slideshow_box 
[pageid_01_1_slideshow_box] => Array ( [layout] => one 
                                  [content_id] => Array ( [0] => 856 ) 
                                  [slideshow_timeout] => 8 
                                  [slideshow_height] => 400
                                  [image_resize] => on 
                                  [image_crop] => on 
                                  [list_orderby] => date 
                                  [list_order] => DESC 
                                  [slideshow_buttons] => on ) 

[thePageID_2] => pageid_01 
[theElementID_2] => 2 
[source_type_2] => banner_box 
[pageid_01_2_banner_box] => Array ( [layout] => one 
                                     [text] => test 
                                     [button_text] => Button Text 
                                     [button_link] => a link ) 

              ) 
```

我需要从上面的数组中构建另一个数组，结构如下：

```
 Array ( 
  [pages] => Array ( [pageid_01] => stdClass Object 
                       ( [pageName] => first Page
                       [style] => full
                       [pageID] => pageid_001 

                       [contents] => Array ( 
                       [2] => stdClass Object  ( 
                          [element_id] => 1 
                          [content_type] => slideshow_box
                          [layout] => one 
                          [content_id] => Array ( [0] => 856 )
                          [slideshow_timeout] => 8 
                          [slideshow_height] => 400 
                          [image_resize] => on 
                          [image_crop] => on 
                          [list_orderby] => date 
                          [list_order] => DESC 
                          [slideshow_buttons] => on 
                                               ) 
                        [3] => stdClass Object ( 
                        [element_id] => 2 
                        [content_type] => banner_box 
                        [layout] => one 
                        [text] => test
                         [button_text] =>Button text 
                         [button_link] => a link 
                                              ) 
          ) 
```

更新了更多细节：

我现在构建第二个数组的方式是这样的：

```
$pages  =  new \stdClass();
$i=0;
$page=0;
$thepagename = '_page_name';

if(isset($thepagename))
{
  if(in_array($thepagename, $AllPages))
  { foreach($AllPages as $k => $v) {
     $page = str_replace('_page_name','',$k); 
    @$pages->pages[$page]->pageID   = $page; 
    @$pages->pages[$page]->pageName     = $v;
    if(stristr($k, 'theElementID_') == true) {          
                    $element_id = $v;
                }
    if(stristr($k, '_slideshow_box') == true) {
        $i++;
        @$pages->pages[$page]->contents[$i]->element_id           =  $element_id; 
        $pages->pages[$page]->contents[$i]->content_type       =  'slideshow_box';
        $pages->pages[$page]->contents[$i]->layout             =  $v["layout"];
        $pages->pages[$page]->contents[$i]->content_id         =  @$v["content_id"];
        $pages->pages[$page]->contents[$i]->slideshow_timeout     =  $v["slideshow_timeout"];
        $pages->pages[$page]->contents[$i]->slideshow_height      =  $v["slideshow_height"];
        $pages->pages[$page]->contents[$i]->image_resize       =  $v["image_resize"];
        $pages->pages[$page]->contents[$i]->image_crop         =  $v["image_crop"];
        $pages->pages[$page]->contents[$i]->list_orderby       =  $v["slideshow_orderby"];
        $pages->pages[$page]->contents[$i]->list_order         =  $v["slideshow_order"]; 
        $pages->pages[$page]->contents[$i]->slideshow_buttons     =  $v["slideshow_buttons"]; 
  }

  }
    }
} 
```

等等....但是这种方式需要大量编码，而内容可能要多得多...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:36:53.797

首先，你可以循环你的数组，得到所有的值和键，第二，建立另一个数组，把所有的键和值压入新的数组。就像

```
$new_array = ($new_array,values1,values2,.......); 
```

希望它可以帮助你

# haskell - GHC：为 ARM 和 MIPS 处理器静态链接 Linux 二进制文件

> ID：14270177
> 
> 赞同：7
> 
> 时间：2013-01-11T01:18:56.480
> 
> 标签：haskell, arm, mips, ghc, static-linking

我正在使用 Debian/MIPS+QEMU 构建[PortFusion](https://github.com/corsis/PortFusion/wiki/MIPS-Builds)（一种 TCP 隧道解决方案）的 MIPS 端口。生成的二进制文件链接到 GNU libc。因此，它们不能仅仅被复制并在随**uclibc**而不是**eglibc**（似乎与 GNU libc 二进制兼容）一起提供的 vanilla OpenWrt 上使用。

* * *

*   GHC 7.4 不能将 libc（+ libgmp 等）与 ARM 和 MIPS 处理器的 Linux 二进制文件静态链接吗？
*   如何查看 GHC 是否使用可用的全静态编译构建？

* * *

`-static`在 MIPS 上被忽略：

```
root@debian:~# cat hello.hs
main = print 2
root@debian:~# ghc --make hello.hs 
[1 of 1] Compiling Main             ( hello.hs, hello.o )
Linking hello ...
root@debian:~# ldd ./hello
    libgmp.so.10 => /usr/lib/mips-linux-gnu/libgmp.so.10 (0x77908000)
    libffi.so.5 => /usr/lib/mips-linux-gnu/libffi.so.5 (0x778ea000)
    libm.so.6 => /lib/mips-linux-gnu/libm.so.6 (0x77855000)
    librt.so.1 => /lib/mips-linux-gnu/librt.so.1 (0x7783c000)
    libdl.so.2 => /lib/mips-linux-gnu/libdl.so.2 (0x77827000)
    libc.so.6 => /lib/mips-linux-gnu/libc.so.6 (0x776a0000)
    libpthread.so.0 => /lib/mips-linux-gnu/libpthread.so.0 (0x77675000)
    /lib/ld.so.1 (0x55550000)
root@debian:~# rm hello
root@debian:~# ghc --make -static hello.hs 
Linking hello ...
root@debian:~# ldd ./hello
    libgmp.so.10 => /usr/lib/mips-linux-gnu/libgmp.so.10 (0x76f98000)
    libffi.so.5 => /usr/lib/mips-linux-gnu/libffi.so.5 (0x76f7a000)
    libm.so.6 => /lib/mips-linux-gnu/libm.so.6 (0x76ee5000)
    librt.so.1 => /lib/mips-linux-gnu/librt.so.1 (0x76ecc000)
    libdl.so.2 => /lib/mips-linux-gnu/libdl.so.2 (0x76eb7000)
    libc.so.6 => /lib/mips-linux-gnu/libc.so.6 (0x76d30000)
    libpthread.so.0 => /lib/mips-linux-gnu/libpthread.so.0 (0x76d05000)
    /lib/ld.so.1 (0x55550000) 
```

* * *

GHC的相关资料：

```
root@debian:~# ghc --info
 [("Project name","The Glorious Glasgow Haskell Compilation System")
 ,("GCC extra via C opts"," -fwrapv")
 ,("C compiler command","/usr/bin/gcc")
 ,("C compiler flags"," -fno-stack-protector  -Wl,--hash-size=31 -Wl,--reduce-memory-overheads")
 ,("ar command","/usr/bin/ar")
 ,("ar flags","q")
 ,("ar supports at file","YES")
 ,("touch command","touch")
 ,("dllwrap command","/bin/false")
 ,("windres command","/bin/false")
 ,("perl command","/usr/bin/perl")
 ,("target os","OSLinux")
 ,("target arch","ArchUnknown")
 ,("target word size","4")
 ,("target has GNU nonexec stack","True")
 ,("target has subsections via symbols","False")
 ,("Project version","7.4.1")
 ,("Booter version","7.4.1")
 ,("Stage","2")
 ,("Build platform","mips-unknown-linux")
 ,("Host platform","mips-unknown-linux")
 ,("Target platform","mips-unknown-linux")
 ,("Have interpreter","NO")
 ,("Object splitting supported","NO")
 ,("Have native code generator","NO")
 ,("Support SMP","NO")
 ,("Unregisterised","YES")
 ,("Tables next to code","YES")
 ,("RTS ways","l debug    ")
 ,("Leading underscore","NO")
 ,("Debug on","False")
 ,("LibDir","/usr/lib/ghc")
 ,("Global Package DB","/usr/lib/ghc/package.conf.d")
 ,("Gcc Linker flags","[\"-Wl,--hash-size=31\",\"-Wl,--reduce-memory-overheads\"]")
 ,("Ld Linker flags","[\"--hash-size=31\",\"--reduce-memory-overheads\"]")
 ] 
```

* * *

另请参阅：[GHC 能否将二进制文件链接到 libc 实现，例如 uclibc（默认情况下在 OpenWrt 中使用）？](https://stackoverflow.com/questions/14270253/can-ghc-link-binaries-against-a-libc-implementation-such-as-uclibc-used-in-open)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-11T12:06:12.053

[事实上](http://www.haskell.org/ghc/docs/7.4.1/html/users_guide/options-phases.html#options-linker)，该`-static`标志只是告诉 GHC 避免动态链接到*Haskell*库。要静态链接到 C 库，您也需要传递`-optl-pthread -optl-static`。后者告诉链接器静态链接到 C 库，而前者是（AFAIK）需要的，因为这样做时链接库的某些顺序被搞砸了。

对于 x86 上的完全静态二进制文件，您也需要相同的标志，因此这并不特定于 ARM 和 MIPS。

# java - JPA - @EmbeddedId 和 @Id

> ID：14270197
> 
> 赞同：1
> 
> 时间：2013-01-11T01:21:03.403
> 
> 标签：java, database, jpa, eclipselink, composite-primary-key

这是相关的 JPA 代码：

```
@MappedSuperClass
public abstract class SuperClass {

  @EmbeddedId
  private FileId fileId;

  protected SuperClass() {
  }

  public SuperClass(FileId fileId) {
    this.fileId = fileId;
  }

}

@Embeddable
public class FileId {

  protected FileId() {
  }

  protected File fileName;

  public FileId(File fileName) {
    this.fileName = fileName;
  }

}

@Entity
public MyClass1 extends SuperClass {

  @Id
  protected String id;

  protected MyClass1() {
  }

  public MyClass1(String id, FileId fileId) {
    super(fileId);
    this.id = id;
  }

}

@Entity
public MyClass2 extends SuperClass {

  protected MyClass2() {
  }

  public MyClass2(FileId fileId) {
    super(fileId);
  }

} 
```

在运行时，我得到以下异常：

```
...
Exception Description: Entity class [class org.abcd.MyClass1] has both an @EmbdeddedId (on attribute [fileId]) and an @Id (on attribute [id]. Both ID types cannot be specified on the same entity.
... 
```

在 JPA / Eclipse Link 中似乎不允许将 @EmbeddedId 属性（@Embeddable 类的所有属性）和 @Id 属性一起定义为主键。

有人知道这个问题的可能解决方案吗？

任何帮助表示赞赏。

**一些附加信息：**

MyClassA 类应该包含有关某个存档文件的信息（进度，...；在上面的代码示例中省略）；超类 SuperClass 的属性 fileId 用于标识该文件。目前fileId（id-class FileId）只包含文件名，以后会添加更多的属性。

MyClassB 包含有关存档中文件的信息。该文件将使用超类 SuperClass 的属性 id（它在存档中的相对路径）和 fileId 来标识。

我想到了以下数据库结构：

表“MyClass1”：

文件名 | 编号 | ...

表“MyClass2”：

文件名 | ...

我希望现在更清楚我到底想要什么:)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:26:10.570

你的映射没有任何意义。你在同一个类中有一个`@EmbeddedId`和一个：你有 na并且它扩展了一个已经有一个. 我不知道你为什么想要那个？你到底想完成什么？`@Id``MyClassA``@Id``@EmbeddedId`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:44:18.683

正如人们向您推荐的那样-也许更改数据模型会让您在这里更有意义。

这是我的简单建议：

一个包含 ID 字段和 get/set-tters 的基本类实体，例如：

```
@MappedSuperclass
public class Entity { 

     @Id
     @GeneratedValue(strategy = GenerationType.AUTO)
     private int id;

     // getters/setters
} 
```

这可用于模型中所有实体的基本类。然后遵循您的功能要求可能会帮助您：

```
@Entity
@Inheritance(strategy = InheritanceType.JOIN)
public class File extends Entity {

    @Column(unique=true)
    private String fileName;

    // other future columns you mention above
}

@Entity
public class ArchiveFile extends File {

    // other information here - progress and so on 
}

@Entity
public class ArchiveFileTracker extends Entity {

    @OneToMany
    private ArchiteFile architeFile;

    // other specific information here 
} 
```

我希望这可以满足您的要求。

祝你好运，西蒙

# .net - MySQL & dotnet：高效更新每一行

> ID：14270198
> 
> 赞同：0
> 
> 时间：2013-01-11T01:21:04.183
> 
> 标签：.net, mysql, sequential, read-write

我开始了一些我认为直截了当的事情：顺序（逐行）读取，计算一些值并更新同一行，然后再继续整个表的下一行。

上下文：一个平面表，**2600 万条记录**，复合 PK（4 个数值）。 **物理表大小 1.3 GB**。处理记录的顺序无关紧要。这只会在可预见的未来进行一次。计算太复杂，无法在 SQL 中完成（至少对我来说 :-)

推荐的有效方法是什么？

我尝试了什么：使用`datareader`in `ADO.NET`（它不再有旧的 VB6 结果集，这本来会简单得多）。将它与每个`reader.Read()`循环中的更新语句 (statement.ExecuteNonQuery) 结合起来很棘手，因为 ADO.NET 不喜欢在同一个连接上这样做。所以我不得不打开2个连接。（更新查询在 WHERE 子句中使用复合 PK，这可能会很快，但仍然让我觉得效率低下，因为光标已经在我要更新的记录上。）

这种方法有点工作，但不适用于基于`SELECT * FROM MyTable`查询的阅读器。我不得不`LIMIT`一次读取几千行的块以避免超时错误。**根据早期的实验，我估计2600 万条记录**的处理过程需要9 个小时。我将它设置为通宵运行，当我回来时，它在整个过程中再次超时三分之一。重新启动后，我发现`SELECT`一旦偏移量变大，LIMIT 子句就会减慢查询速度。我对剩余 65% 的新估计超过了另外 20 小时，随着 LIMIT 偏移量的增加，可能会更长。

一定会有更好的办法！？

（我还尝试了优雅但当然超时的 EF :-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T11:38:38.930

经过与 Eric 的上述讨论和进一步的实验，这是我对传奇的结论：

*   关系数据库确实不适合顺序处理，并且任何此类过程在关系 DBMS 上执行时都会受到性能影响。
*   在数据库历史的某个阶段，像 VB6 这样的平台提供了像“Recordset”这样的工具，它支持“基于光标”的表遍历、读取和更新记录。这些用于在支持的提供程序上工作，如 ODBC 和 OLE（以及附加到这些的 DBMS）。记录集看起来非常适合手头的工作，但在 ADO.NET 中不再可用（截至 2013 年）
*   中小型桌子可以原谅设计错误。
*   操作系统缓存整个数据表，因此在处理中小型表时掩盖了数据库效率低下
*   一旦表大小（和/或行数）增加，系统就会开始颠簸并且表现异常。它可能以前表现不佳，但由于上述几点，您不会注意到它。
*   我使用 SELECT...LIMIT （检索 1000 行的块）的方法在 2600 万行表中突然停止了大约 75%；即现在需要几分钟才能完成 1000 行的每个 SELECT。
*   我曾尝试基于[http://www.codeproject.com/Articles/8435/Simulating-Recordsets-with-ADO-NET](http://www.codeproject.com/Articles/8435/Simulating-Recordsets-with-ADO-NET)模拟基于游标的记录集，结果发现 MySQL 不支持游标的更新，只支持存储过程中的游标，这违背了目的，因为我的计算必须在 DBMS 之外执行。（它可能适用于 SQL Server）
*   （因为我的表由一个 4 部分的复合键组成）我最终按照 Eric 的建议创建了一个人工 AutoIncrement 键/索引，因此我可以使用计算范围（例如 0-999、1000-1999 等）遍历记录与使用 LIMIT 不同，它在表格遍历的开始和结束时同样快。在慢速 2 核 Atom 上网本上创建 AutoIncrement 字段和索引/键（在一个命令中）花费了 MySQL 不到 1 小时（对于 150 字节/记录的 26+ 百万条记录）。
*   在上述配置中，26+ 百万条记录的完整遍历大约需要 9 个小时，这与我在流程开始时 LIMIT 计时时的原始估计相同。

希望这可以帮助任何处于类似情况的人。非常感谢评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T01:33:23.613

以小批量（1000 条左右的记录）更新数据库通常是一种好方法，因为它可以避免锁定行（或页面）太长时间，并避免超时。方法的那部分很棒。

对于较大的起始值，您可以提高 LIMIT 的性能。有多种方法。迄今为止我发现的最好的方法是根本不使用 LIMIT，而是选择主键范围

[https://stackoverflow.com/a/1911210/141172](https://stackoverflow.com/a/1911210/141172)

# ios - 应用因强制注册而被拒绝 - 电子书店

> ID：14270200
> 
> 赞同：-4
> 
> 时间：2013-01-11T01:21:16.660
> 
> 标签：ios, app-store

我为通过他们的网站销售专业电子书的公司开发了一个应用程序。为了使内容与网络数据保持同步，应用程序强制登录/注册，否则将无法提供任何功能。

这就是为什么它被拒绝审查指南**17.2 要求用户共享个人信息（例如电子邮件地址和出生日期）才能运行的应用程序将被拒绝的原因**

我的问题是：有没有办法说服苹果接受一个应用程序？

1.  它针对非常具体的专业人士。
2.  将来，该公司希望增加同步其网站上可用书籍的可能性。
3.  此外，通过应用内购买购买的书籍也可以在他们的网站上供用户帐户使用。

苹果接受这个应用程序的理由还不够吗？我的客户强烈希望拥有一个基于帐户的应用程序，整个系统就是为此而设计的。

有可能通过 udid 跟踪用户，但它仍然不是一个好的解决方案，因为它已被弃用，Apple 出于跟踪原因拒绝使用 UDID 的应用程序。

最近有没有人有类似的情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T02:11:30.663

你说：

> “应用程序强制登录/注册，没有它不提供任何功能。”

苹果 说：

> “要求用户共享个人信息才能运行的应用程序将被拒绝”

所以答案很明显。

> **该应用程序应该（至少）提供一些基本功能而不共享个人数据。**

也许一些书预览？1 或 2 本免费书籍？应用信息？为什么不是苹果书店？该网站（在看到任何内容之前）是否也强迫您注册？否则只需制作一个网络应用程序。

# android - 在 android Gps LocationListener 中更新当前位置

> ID：14270207
> 
> 赞同：1
> 
> 时间：2013-01-11T01:22:50.330
> 
> 标签：android, gps, position, locationmanager

我正在看其他帖子，但我的不能。当我距离目标位置“x”米时，我想更新我的位置并发出警报声。

我用过这段代码：

```
private TextView m1TextMessage, m2TextMessage, m3TextMessage;
private LocationManager locationManager;
private Location targetLocation;
double longitude, latitude;
private float distancia;
ProgressDialog pd;
LocationListener listener; 
```

这是我的位置监听器：

```
public class MyLocationListener implements LocationListener {

    public void onStatusChanged(String provider, int status, Bundle extras) {
        // TODO Auto-generated method stub

    }

    public void onProviderEnabled(String provider) {
        // TODO Auto-generated method stub

    }

    public void onProviderDisabled(String provider) {
        // TODO Auto-generated method stub

    }

    public void onLocationChanged(Location location) {
        // TODO Auto-generated method stub
        float dist=0;
        float error=0;

        //Escribir posición actual en m1TextMessage
        latitude =location.getLatitude();
        longitude = location.getLongitude();

        //calcular distancia al destino y error estimado
        //Escribir distancia al destino y error en m3TextMessage

        Location loc2= new Location(LocationManager.GPS_PROVIDER);

         if (loc2 != null)  
            {
               dist=location.distanceTo(targetLocation);
               error = location.getAccuracy();
               if(dist < distancia){
                   Toast.makeText(getApplicationContext(), "Distancia menor a 10 metros, "+dist+" metros.",Toast.LENGTH_SHORT).show(); 
                   Uri notification = RingtoneManager.getDefaultUri(RingtoneManager.TYPE_NOTIFICATION);
                   Ringtone r = RingtoneManager.getRingtone(getApplicationContext(), notification);
                   r.play();
                  }
            }else
                 Toast.makeText(getApplicationContext(), "location actual es null!!",Toast.LENGTH_SHORT).show();

           m1TextMessage.setText("Posición actual: "+longitude+", "+latitude+"\n");
            m2TextMessage.setText("Posición objetivo: "+targetLocation.getLatitude()+", "+targetLocation.getLongitude()+"\n");
            m3TextMessage.setText("Distancia al objetivo: "+dist+"\nError estimado: "+error);
        //Lanzar un Toast si la distancia al destino es inferior a 10 metros

    }

};

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_main);

    m1TextMessage=(TextView) findViewById(R.id.actualPos);
    m2TextMessage=(TextView) findViewById(R.id.destino);
    m3TextMessage=(TextView) findViewById(R.id.distanciaa);
    Button localiza = (Button)findViewById(R.id.button1);

    locationManager = (LocationManager) this.getSystemService(Context.LOCATION_SERVICE);
    localiza.setOnClickListener(this);

}

public class GPSLocation extends AsyncTask<Void, Void, Void>
{  
    boolean running =true;
            @Override
            protected void onPreExecute()
            {  
                super.onPreExecute(); 
                pd = new ProgressDialog(PracticaGPS.this);
                pd.setOnCancelListener(new DialogInterface.OnCancelListener(){
                      public void onCancel(DialogInterface dialog) {
                          pd.cancel();  
                      }
                });
                longitude=0;
                latitude =0;
                getLonLat();
                pd.setCancelable(true);
                pd.setMessage("Getting GPS Location...");
                pd.setProgressStyle(ProgressDialog.STYLE_SPINNER);

                pd.show();

            } 

            @Override 
            protected void onProgressUpdate(Void... values) {
                super.onProgressUpdate(values);

                // Things to be done while execution of long running operation is in progress. For example updating ProgessDialog
             }

            @Override 
            protected void onPostExecute(Void result)
            {  

                    pd.dismiss(); 
            }

            @Override
            protected Void doInBackground(Void... params) {  
                boolean isDataSubmitted = false;

                while(!isDataSubmitted)
                {  
                    if(longitude !=0 && latitude!=0)
                    { 

                        isDataSubmitted = true;
                        Log.d("LONGITUD", ""+longitude);
                        Log.d("LATITUDE", ""+latitude);

                    }  
                } 

                return null;    
            } 
 } 

public void getLonLat(){
    listener = new MyLocationListener();

    if (locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER)) {
        (locationManager).requestLocationUpdates(LocationManager.GPS_PROVIDER, 5000, 10,listener);
         new GPSLocation().execute();
    }else if (locationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER)) {
        locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 5000, 10, listener);
        Log.d("Long", ""+longitude);
    } else 
        enableLocationSettings();

}

@Override
public void onStart(){

    //Crear servicio de localización LocationManager       
    //Determinar si el GPS está encendido
    //Caso esté apagado, permitir al usuario activarlo mediante método enableLocationSettings()

    //Solicitar actualizaciones de posición al proveedor de GPS (opcionalmente también al proveedor de red)
    //Nota: el LocationListener ya ha sido creado: listener

    super.onStart();
}

private void enableLocationSettings() { //enable Location services is necessary
    Intent settingsIntent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
    startActivity(settingsIntent);
}

@Override
public void onStop(){
     locationManager.removeUpdates(listener);
     super.onStop();
}

public void onClick(View v) {
        EditText lat, lon, distan;
        lat = (EditText)findViewById(R.id.latitud);
        lon = (EditText)findViewById(R.id.longitud);
        targetLocation = new Location("Target Position");
        targetLocation.setLatitude(Double.valueOf(lat.getText().toString())); //punto pre-definido,
        targetLocation.setLongitude(Double.valueOf(lon.getText().toString())); //no cambiar el valor
        targetLocation.setAltitude(0);
        distan = (EditText)findViewById(R.id.distancia);
        distancia = Float.valueOf(distan.getText().toString());
        new GPSLocation().execute();

} 
```

}

这是我的 xml 代码：

```
 <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Longitud: " />

    <EditText
        android:id="@+id/longitud"
        android:layout_width="101dp"
        android:layout_height="wrap_content"
        android:ems="10" />

    <TextView
        android:id="@+id/texto2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Latitud: " />

    <EditText
        android:id="@+id/latitud"
        android:layout_width="105dp"
        android:layout_height="wrap_content"
        android:ems="10" >

        <requestFocus />
    </EditText>

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Distancia mínima alarma" />

    <EditText
        android:id="@+id/distancia"
        android:layout_width="150dp"
        android:layout_height="wrap_content"
        android:ems="10" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Enviar Localizacion" />

    <TextView
        android:id="@+id/actualPos"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="10dp"

        />

    <TextView
        android:id="@+id/destino"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="10dp"

         />
    <TextView
        android:id="@+id/distanciaa"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="10dp"

         /> 
```

我想这很简单，但我可以管理它。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T03:42:59.513

如果您在想要获取从当前位置到目标位置的距离时正确调用此方法..这将提供距离..根据谷歌服务。很简单，它会返回值......它会很好地工作。希望它会帮助你。

```
package com.google.map;
import java.io.IOException;
import java.io.InputStream;
import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;
public class Distance   {

public String getDistance(String Source,String Destination) {
    StringBuilder stringBuilder = new StringBuilder();
    String duration_final_value = "";
    try {

        Source = Source.replaceAll(" ", "%20");
        Destination = Destination.replaceAll(" ", "%20");

        HttpPost httppost = new HttpPost(
                "http://maps.google.com/maps/api/directions/json?origin="
                        + Source + "&destination=" + Destination
                        + "&sensor=false&units=metric&mode=driving");//&mode=walking,driving
        HttpClient client = new DefaultHttpClient();
        HttpResponse response;
        stringBuilder = new StringBuilder();

        response = client.execute(httppost);
        HttpEntity entity = response.getEntity();
        InputStream stream = entity.getContent();
        int b;
        while ((b = stream.read()) != -1) {
            stringBuilder.append((char) b);
        }
    } catch (ClientProtocolException e) {
    } catch (IOException e) {
    }

    JSONObject jsonObject = new JSONObject();
    try {
        jsonObject = new JSONObject(stringBuilder.toString()); // first we need to get the full json object which google returns    
        JSONArray routes_Array = jsonObject.getJSONArray("routes"); // in that first we need to go into the routes array
        JSONObject routes_object = (JSONObject) routes_Array.get(0); // in that we need first item 
        JSONArray legs_Array = routes_object.getJSONArray("legs");  // then go into the legs array
        JSONObject legs_object = (JSONObject) legs_Array.get(0);  // in that we need first item.
        JSONObject duration_object = legs_object.getJSONObject("distance"); // go into the distance object      
        // pull out the "duration" object
        duration_final_value = duration_object.getString("text"); // this should be the duration text value (20 hours 40 mins)

    } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    return duration_final_value;
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T03:27:23.677

读这个。

[http://developer.android.com/reference/android/location/Location.html](http://developer.android.com/reference/android/location/Location.html)

使用此功能

```
public static void distanceBetween (double startLatitude, double startLongitude, double endLatitude, double endLongitude, float[] results) 
```

从函数中获取结果并将其与循环中的目标位置相减。

# r - R中的自动多重绘图功能

> ID：14270212
> 
> 赞同：-4
> 
> 时间：2013-01-11T01:23:28.580
> 
> 标签：r, plot, ggplot2

我有两组时间序列变量。

```
WSN = c(HMn25_29,HMn28_29,HMn29_29)
Ref = c(suplmentryfor29,suplmentryob29) 
```

我想要有一个图，显示 WSN 的一个元素集和一个 Ref 元素。换句话说，我想可视化 {HMn25_29,suplmentryfor29},{HMn28_29,suplmentryfor29},{HMn28_29,suplmentryfor29},{HMn25_29,suplmentryob29},{HMn25_29,suplmentryob29},{HMn25_29,suplmentryob29}。

预期成绩：

![在此处输入图像描述](../Images/6f8b9b11df5852833f64d8a9c5e3bca6.png)

WSN 的样本数据：

```
 dt   temp
1 2007-09-29 00:00:00 -1.874500
2 2007-09-29 01:00:00 -1.693667
3 2007-09-29 02:00:00 -1.766667
4 2007-09-29 03:00:00 -1.928667
5 2007-09-29 04:00:00 -2.132581
6 2007-09-29 05:00:00 -1.752258 
```

参考数据示例：

```
 HMn29_29.h   V1
1 2007-09-29 00:00:00 -1.8
2 2007-09-29 01:00:00 -1.9
3 2007-09-29 02:00:00 -2.4
4 2007-09-29 03:00:00 -2.3
5 2007-09-29 04:00:00 -2.3
6 2007-09-29 05:00:00 -2.4 
```

此外，我有单独绘制的代码。单独绘制变量的代码：

```
plot29 <- list(HMn25_29,HMn28_29,HMn29_29,HMn31_29,HMn32_29,suplmentryfor29,suplmentryob29)
Mainn <- c('Node 25','Node 28','Node 29','Node 31','Node 32', 'MetoSwiss Forecast Grid Point', "MetoSwiss Sensing Station")
par(mfrow=c(1,2))
for (i in seq_along(plot29))  {
  plot(plot29[[i]], type = "o", pch = 16, lty = 2, col = "Black", xlab = "Hour  (2007/09/29)" , ylab = "Ambient Tempreture")
  title(Mainn[[i]])
} 
```

现在，我需要一个自动函数来获取列表并显示具有上述属性的图，其中 x 轴表示时间-日期，y 轴表示相同比例的变量的绝对值，例如 -2 ~ 10。此外，每个情节都应包括图例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:45:01.020

R 中的 ts.plot 和 plot.ts 函数都允许您将多条线绘制到一个图中，也许您可​​以尝试一下？这是一个简单的例子：

```
a<-c(1:5)
b<-c(2:6)
ts.plot(cbind(a,b)) 
```

另一种方法是在制作新图形之前使用“par(new=TRUE)”，它告诉 R 将新图形放入您上次使用的设备中，而不清除旧图形。这并不整洁，但它可能会给你更多的灵活性。如果你决定走这条路，你会想要在后面的图中省略轴和标签，并手动设置 xlim 和 ylim，否则它们会消失。

# android - 检查 Android 应用程序大小

> ID：14270213
> 
> 赞同：1
> 
> 时间：2013-01-11T01:23:34.320
> 
> 标签：android, size

我想知道是否有一种方法可以在您处于 Android 应用程序的开发阶段时检查您的应用程序的大小，而不是等到您完成应用程序然后创建 apk。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T03:22:22.257

您可以检查`.apk`文件`bin`夹中的文件。每次运行应用程序时，它都会生成一个新`.apk`文件。

# node.js - SVD 和奇异/非奇异矩阵

> ID：14270215
> 
> 赞同：3
> 
> 时间：2013-01-11T01:24:07.000
> 
> 标签：node.js, matrix, svd

我需要使用矩阵的 SVD 形式从一系列文档中提取概念。我的矩阵的形式`A = [d1, d2, d3 ... dN]`是组件`di`的二进制向量`M`。然后 svd 分解给了我`svd(A) = U x S x V'`包含`S`奇异值的信息。

我使用[SVDLIBC](http://tedlab.mit.edu/~dr/SVDLIBC/)在 nodejs 中进行处理（使用我编写的一个小模块来使用它）。它似乎工作得很好，但我注意到运行时间行为中的一些非常奇怪的东西取决于我的矩阵的状态（其中 N，M 正在增长，但每个都已经超过 1000）。首先，我没有考虑提取相同的文档向量，但现在经过一些测试，看起来像添加两次文档有时会异常加快处理速度。

1.  我是否必须确保 A 的每一列都是成对独立的？是否要求它们都是线性独立的？（我认为不，因为即使某些列完全相同，SVD 似乎也能很好地完成它的工作，它只会在结果分解中显示哪些列/行是无用的，因为在`U`or中有 0 个组件`V`）
2.  现在计算我的大矩阵的 SVD 有时需要太多时间，我试图通过删除相同的列来减小它的大小，但我发现实际上添加相同的虚拟向量可以让它更快。这正常吗？发生了什么？

从逻辑上讲，我会说我希望我的矩阵包含尽可能多的信息，因此

*   [A] 删除所有相同的列，在最好的情况下，也许
*   [B] 删除线性相关列。

做 [A] 看起来很简单，计算成本也不高，我可以在构造时对我的向量进行散列，以检查哪些可能是相同的向量，然后花时间检查这些，但是 [A] 和 [B] 有没有好的计算技术]？
（我很感激 [A] 不必以蛮力方式检查新向量与整个过去向量的相等性，至于 [B]，我不知道有什么好的方法来检查它/做它）。

**添加了相关问题**：关于我的第二个问题，为什么 SVD 的运行时间行为会通过添加一个类似的列而发生如此巨大的变化？这是正常的可能行为，还是意味着我应该在 SVDLIBC 中查找错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-18T23:47:49.987

如果没有快速和慢速输入矩阵的样本，很难说问题出在哪里。但是，由于 SVD 的主要用途之一是提供消除协方差的旋转，因此冗余（或相同）列不应引起问题。

要回答您关于缓慢行为是否是您正在使用的库中的错误的问题，我建议您尝试使用其他工具检索同一矩阵的 SVD。例如，在[Octave](https://www.gnu.org/software/octave/)中，检索矩阵的 SVD 以比较运行时：

```
[U, S, V] = svd(A) 
```

# php - 数组中列的PHP唯一值

> ID：14270217
> 
> 赞同：3
> 
> 时间：2013-01-11T01:24:09.537
> 
> 标签：php, arrays, unique

我有一个从我运行的 SQL 查询生成的数组。它如下所示：

```
$arr[$i]['id'] = $id;
$arr[$i]['name'] = $name;
$arr[$i]['email'] = $email; 
```

如何从电子邮件列中获取唯一值？我很感激帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2018-11-27T13:09:05.923

最好的答案是：

```
array_unique(array_column($arr, 'email')) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-11T01:30:22.060

使用 MySQL 中的 DISTINCT 方法在您的列中过滤它，或者使用类似的东西

```
$uniqueEmails = array();
foreach($arr as $array)
{
    if(!in_array($array['email'], $uniqueEmails)
        $uniqueEmails[] = $array['email'];
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-02-01T06:25:52.333

自 PHP 5.5 起，还提供了一个名为[array_column()](http://php.net/manual/en/function.array-column.php)的新函数。您可以通过以下方式使用它：

```
$allEmails = array_column($arr, 'email');
$uniqueEmails = array_unique($allEmails); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-02-20T12:51:52.393

### 从比较特定键的数组中删除重复项

考虑相同的数组，但第三个索引的 id 不同：

```
$all_array = Array
(
    [0] => Array
        (
            [id] => 1
            [value] => 111
        )

    [1] => Array
        (
            [id] => 2
            [value] => 222
        )

    [2] => Array
        (
            [id] => 3
            [value] => 333
        )

    [3] => Array
        (
            [id] => 4
            [value] => 111
        )
) 
```

现在，1 和 4 都具有相同的值。所以我们要删除它们中的任何一个：

```
$unique_arr = array_unique( array_column( $all_array , 'value' ) );
print_r( array_intersect_key( $all_array, $unique_arr ) ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-27T16:22:10.030

如果您从 SQL 中获得按电子邮件排序的列表，您可以像 Gareth 那样通过循环遍历数组来提高性能，但只需将当前电子邮件地址与最后插入的电子邮件地址进行比较。下面是一个代码示例：

```
$uniqueEmails = array();
$lastemail = '';
foreach($arr as $array)
{
    if($array['email'] != $lastemail)
    {
        $uniqueEmails[] = $array['email'];
        $lastemail = $array['email'];
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-08T06:00:47.333

```
if(!in_array($row,$data)){
  $data[]= $row;
} 
```

# java - 从 Java 中的泛型类中读取多个嵌入变量

> ID：14270219
> 
> 赞同：0
> 
> 时间：2013-01-11T01:24:26.183
> 
> 标签：java, list, generics, tuples

本质上，我的任务是编写两种方法：一种 zip 方法，它将包含两个通用反对列表的通用元组转换为由上述列表的元素组成的元组列表，以及一个 unzip 方法，它在另一个中执行相同的操作方向。IE：

```
({1, "banana", true}{asgard, 5.21e, "stupidhomework"})
=> unzip
{(1, asgard)("banana",5.21e)(true,"stupidhomework")}
=> zip
({1, "banana", true}{asgard, 5.21e, "stupidhomework"}) 
```

更复杂的是：列表是一个简单链接的不可变通用列表，其结构

```
List<T>
public final T       head;
public final List<T> tail; 
```

...而且元组同样通用；元组的两个元素实际上可以是任何东西：

```
public class Tuple<A, B> {
public final A a;
public final B b; 
```

所以这是我的问题：我不知道如何将元素放在第二层。例如，通常情况下，我会这样做——

```
 public static<A, B extends List> List unzip(Tuple<A, B> ListenTuple){
        List TupelnListe = new List(new Tuple(ListenTuple.a.head, ListenTuple.b.head)); 
```

- 为了获得我需要的元素，向下两层。不幸的是，因为 Tuple 是通用的，它不知道 ListenTuple.a 必须是一个 List，因此它有一个头。类似的问题出现在 zip 中，从元组中获取 a 和 b。哦，我不允许出于某种愚蠢的任意原因进行类型转换，尽管我不确定这对我有什么帮助。

...基本上，任何人都可以给我一个关于如何开始的指示吗？他们这周在课堂上基本上把我们扔进了仿制药，没有人明白。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:29:02.387

这行得通吗？

```
public static<A, B> List zip(Tuple<List<A>, List<B>> ListenTuple){ 
```

所以 A 和 B 是列表的元素，a, b 现在是列表。

我对 C++ 更熟悉，所以不确定这些差异是否会以某种方式阻止这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T03:47:48.730

我会推荐这些签名：

```
public static <A, B> List<Tuple<A, B>> zip(Tuple<List<A>, List<B>> x);
public static <A, B> Tuple<List<A>, List<B>> unzip(List<Tuple<A, B>> x); 
```

看看你能不能从那里弄清楚

# html - JSF inputText 所需属性不呈现

> ID：14270220
> 
> 赞同：4
> 
> 时间：2013-01-11T01:24:27.257
> 
> 标签：html, forms, jsf

在使用 Moharra JSF 2 的 JBoss AS 7.1.1 上，使用元素创建的 XHTML 文件`inputText`不会呈现属性`required="true"`。

没有错误，但输出 HTML 不包含必需的属性。如果编写纯 HTML 输入元素，则 required 属性将呈现为 JSF 表单的一部分。任何人都知道为什么这个属性会被剥离？该案例是容器管理的登录表单，因此没有支持 bean。提前谢谢了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T01:47:26.227

这是预期的行为，该属性不是针对 HTML 输入标记，而是针对保留在服务器端[的 UIInput 组件的必需属性。](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIInput.html#setRequired%28boolean%29)

请参阅以下相关问题：

*   [JSF 2.0 去除了所需的 HTML5 属性](https://stackoverflow.com/questions/6667322/jsf-2-0-strips-out-needed-html5-attributes)
*   [向 JSF 2.0 UIInput 组件添加自定义属性 (HTML5) 支持](https://stackoverflow.com/questions/6859520/adding-custom-attribute-html5-support-to-jsf-2-0-uiinput-component)

# ruby - ActiveRecord 不使用 counter_cache？

> ID：14270226
> 
> 赞同：0
> 
> 时间：2013-01-11T01:26:03.457
> 
> 标签：ruby, activerecord

我有两个简单的模型：

```
class Push < ActiveRecord::Base
    has_many :opened_pushes
end

class OpenedPush < ActiveRecord::Base
    belongs_to :push, :counter_cache => true
end 
```

但是，如果我这样做

```
a_push.opened_pushes.count 
```

它查询数据库，而不是使用`opened_push_count`Push 中存在的列。我认为这样做很聪明……这是应该的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:04:31.897

需要调用`size`，而不是`length`or`count`将生成查询。

# jquery - Jquery 选择的插件多语言支持

> ID：14270232
> 
> 赞同：-1
> 
> 时间：2013-01-11T01:26:40.750
> 
> 标签：jquery, plugins, jquery-chosen

我正在使用 Jquery Chosen 插件（[http://harvesthq.github.com/chosen/](http://harvesthq.github.com/chosen/)）

我需要所选插件的土耳其语支持。当我搜索“izmir”时，它显示“没有结果匹配”，因为“i”是小写的，而我的文本是“İzmir”。

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:44:25.170

`i`并且`İ`是在 Regex 中不相关的不同 Unicode 值，例如 latin`i`和`I`. Chosen 使用 Regex 过滤结果：

```
regex = new RegExp(regexAnchor + searchText.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&"), 'i');
zregex = new RegExp(searchText.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&"), 'i'); 
```

（来自 Chosen 在 github 上的源代码）

根据[regular-expressions.info](http://www.regular-expressions.info/unicode.html) ， javascript的RegExp缺乏复杂的Unicode支持，所以我认为如果没有额外的代码来转换可以匹配的代码，它不会匹配`İ`它`I`。还有一个[拉取请求](http://github.com/harvesthq/chosen/pull/628)，它允许代码确定要由服务器端库（具有更好的 Unicode 支持）运行的匹配，如果您不想/有时间实现自己的代码，您可以放弃支持。

# php - PHP：写入当前文件

> ID：14270234
> 
> 赞同：0
> 
> 时间：2013-01-11T01:27:03.823
> 
> 标签：php, file, version-control, checksum, repository

我目前正在开发一个网络应用程序更新系统。它的工作方式类似于版本控制，其中主服务器是存储库。我的系统和 vc 之间的区别在于你不能提交/推送等到主服务器。

所以这个想法是：

用户转到管理员 > 更新

检查更新

主存储库发回所有最新版本文件及其校验和的列表

该应用程序会根据服务器上的文件检查此列表。如果有些过期/不匹配校验和，则请求这些文件内容，并覆盖服务器上的文件。

我的问题是，如果更新文件本身需要更新怎么办......我将如何更新它？即使它当前已执行，我能否覆盖它？还是会出现错误，整个事情都爆炸了？我猜想当前文件存储在 ram 中，所以它可以覆盖自己，但我不确定。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:02:25.353

这是您可以解决的一种方法：

*   只允许通过“超级管理员”页面更新主文件
*   创建一个“注册表”，程序的任何部分都可以访问它（有些只能读取，有些可以写入）
*   当通过超级管理员更新文件时，它会检查注册表是否正在读取文件
*   当超级管理员更新任何文件时，它会设置“注册表”，表示正在更新给定文件（实际上是锁定它）
*   当用户尝试更新系统时，它会检查注册表，如果文件设置为“锁定”，则不会尝试下载它
*   当用户能够下载它时，它会设置注册表说正在读取文件（并在完成后将其关闭）

# php - 将 .DBF 文件转换为 .MYSQL 的 PHP 脚本

> ID：14270236
> 
> 赞同：5
> 
> 时间：2013-01-11T01:27:28.037
> 
> 标签：php, mysql, sql, phpmyadmin, dbf

只是想知道是否有人可以向我指出一些提示/脚本的方向，该脚本将帮助我使用 PHP 从原始 dbf 文件创建 mysql。

之前谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-12-14T14:29:00.313

试试下面的代码...

```
<?php
    $tbl = "cc";
    $db_uname = 'root';
    $db_passwd = '';
    $db = 'aa';
    $conn = mysql_pconnect('localhost',$db_uname, $db_passwd);

    // Path to dbase file
    $db_path = "dbffile/bbsres12.dbf";

    // Open dbase file
    $dbh = dbase_open($db_path, 0) or die("Error! Could not open dbase database file '$db_path'.");

    // Get column information
    $column_info = dbase_get_header_info($dbh);

    // Display information
    // print_r($column_info);

    $line = array();

    foreach($column_info as $col) {
        switch($col['type']) {
            case 'character':
                $line[]= "`$col[name]` VARCHAR( $col[length] )";
                break;
            case 'number':
                $line[]= "`$col[name]` FLOAT";
                break;
            case 'boolean':
                $line[]= "`$col[name]` BOOL";
                break;
            case 'date':
                $line[]= "`$col[name]` DATE";
                break;
            case 'memo':
                $line[]= "`$col[name]` TEXT";
                break;
        }
    }

    $str = implode(",",$line);
    $sql = "CREATE TABLE `$tbl` ( $str );";

    mysql_select_db($db, $conn);

    mysql_query($sql, $conn);
    set_time_limit(0); // I added unlimited time limit here, because the records I imported were in the hundreds of thousands.

    // This is part 2 of the code

    import_dbf($db, $tbl, $db_path);

    function import_dbf($db, $table, $dbf_file) {
        global $conn;

        if (!$dbf = dbase_open ($dbf_file, 0)) {
            die("Could not open $dbf_file for import.");
        }

        $num_rec = dbase_numrecords($dbf);
        $num_fields = dbase_numfields($dbf);
        $fields = array();

        for ($i=1; $i<=$num_rec; $i++) {
            $row = @dbase_get_record_with_names($dbf,$i);
            $q = "insert into $db.$table values (";

            foreach ($row as $key => $val) {
                if ($key == 'deleted') {
                    continue;
                }
                $q .= "'" . addslashes(trim($val)) . "',"; // Code modified to trim out whitespaces
            }

            if (isset($extra_col_val)) {
                $q .= "'$extra_col_val',";
            }

            $q = substr($q, 0, -1);
            $q .= ')';

            //if the query failed - go ahead and print a bunch of debug info
            if (!$result = mysql_query($q, $conn)) {
                print (mysql_error() . " SQL: $q\n");
                print (substr_count($q, ',') + 1) . " Fields total.";
                $problem_q = explode(',', $q);
                $q1 = "desc $db.$table";
                $result1 = mysql_query($q1, $conn);
                $columns = array();
                $i = 1;

                while ($row1 = mysql_fetch_assoc($result1)) {
                    $columns[$i] = $row1['Field'];
                    $i++;
                }

                $i = 1;

                foreach ($problem_q as $pq) {
                    print "$i column: {$columns[$i]} data: $pq\n";
                    $i++;
                }

                die();
            }
        }
    }

?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-21T17:22:24.510

您可以尝试 composer package hisamu/php-xbase ( [https://github.com/hisamu/php-xbase](https://github.com/hisamu/php-xbase) ) 来读取 dbf 文件并插入到您的数据库中。有同样的问题，这是最合适的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-05T21:32:26.817

更新：如果您没有使用 dbase 库编译 PHP，您可能会收到以下错误：

```
Call to undefined function dbase_open() 
```

在这种情况下（centos）

```
yum install php-dbase 
```

这是 $mysqli 的更新代码

```
<?php

$mysqli = new mysqli("localhost", "DBusername", "DBpassword", "tableName");
if ($mysqli->connect_errno) {
    echo "Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
}

$tbl = "yourTableName";
$db = 'YourDBName';

// Path to dbase file
$db_path = "/path/dbaseFileName.dbf";

// Open dbase file
$dbh = dbase_open($db_path, 0)
or die("Error! Could not open dbase database file '$db_path'.");

// Get column information
$column_info = dbase_get_header_info($dbh);

$line = array();

foreach($column_info as $col) {
	switch($col['type']){

		case 'character':
			$line[]= "`$col[name]` VARCHAR( $col[length] )";
			break;

		case 'number':
			$line[]= "`$col[name]` FLOAT";
			break;

		case 'boolean':
			$line[]= "`$col[name]` BOOL";
			break;

		case 'date':
			$line[]= "`$col[name]` DATE";
			break;

		case 'memo':
			$line[]= "`$col[name]` TEXT";
			break;
	}
}

$str = implode(",",$line);
$sql = "CREATE TABLE `$tbl` ( $str );";

//mysql_select_db($db,$conn);

//mysql_query($sql,$conn);
$mysqli->query($sql);
set_time_limit(0); // I added unlimited time limit here, because the records I imported were in the hundreds of thousands.

// This is part 2 of the code

import_dbf($db, $tbl, $db_path, $mysqli);

function import_dbf($db, $table, $dbf_file,$mysqli){
	//global $conn;
	global $mysqli;
	if (!$dbf = dbase_open ($dbf_file, 0)){ die("Could not open $dbf_file for import."); }
	$num_rec = dbase_numrecords($dbf);
	$num_fields = dbase_numfields($dbf);
	$fields = array();

	for ($i=1; $i<=$num_rec; $i++){
	$row = @dbase_get_record_with_names($dbf,$i);
	$q = "insert into $db.$table values (";
	foreach ($row as $key => $val){
	if ($key == 'deleted'){ continue; }
	$q .= "'" . addslashes(trim($val)) . "',"; // Code modified to trim out whitespaces
	}

	if (isset($extra_col_val)){ $q .= "'$extra_col_val',"; }
	$q = substr($q, 0, -1);
	$q .= ')';
	//if the query failed - go ahead and print a bunch of debug info
	// if (!$result = mysql_query($q, $conn)){
	if (!$result = $mysqli->query($q)){
		print (mysql_error() . " SQL: $q\n");
		print (substr_count($q, ',') + 1) . " Fields total.";

		$problem_q = explode(',', $q);
		$q1 = "desc $db.$table";
		//$result1 = mysql_query($q1, $conn);
		$result1 = $mysqli->query($q1);
		$columns = array();

		$i = 1;

		while ($row1 = $result1->fetch_assoc()){
			$columns[$i] = $row1['Field'];
			$i++;
		}

		$i = 1;
		foreach ($problem_q as $pq){
			print "$i column: {$columns[$i]} data: $pq\n";
			$i++;
		}
		die();
	}
}
}

$mysqli->close();

?>
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-19T09:14:02.140

```
<?php

$mysqli = new mysqli("localhost", "DBusername", "DBpassword", "tableName");
if ($mysqli->connect_errno) {
    echo "Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
}

$tbl = "yourTableName";
$db = 'YourDBName';

// Path to dbase file
$db_path = "/path/dbaseFileName.dbf";

// Open dbase file
$dbh = dbase_open($db_path, 0)
or die("Error! Could not open dbase database file '$db_path'.");

// Get column information
$column_info = dbase_get_header_info($dbh);

$line = array();

foreach($column_info as $col) {
	switch($col['type']){

		case 'character':
			$line[]= "`$col[name]` VARCHAR( $col[length] )";
			break;

		case 'number':
			$line[]= "`$col[name]` FLOAT";
			break;

		case 'boolean':
			$line[]= "`$col[name]` BOOL";
			break;

		case 'date':
			$line[]= "`$col[name]` DATE";
			break;

		case 'memo':
			$line[]= "`$col[name]` TEXT";
			break;
	}
}

$str = implode(",",$line);
$sql = "CREATE TABLE `$tbl` ( $str );";

//mysql_select_db($db,$conn);

//mysql_query($sql,$conn);
$mysqli->query($sql);
set_time_limit(0); // I added unlimited time limit here, because the records I imported were in the hundreds of thousands.

// This is part 2 of the code

import_dbf($db, $tbl, $db_path, $mysqli);

function import_dbf($db, $table, $dbf_file,$mysqli){
	//global $conn;
	global $mysqli;
	if (!$dbf = dbase_open ($dbf_file, 0)){ die("Could not open $dbf_file for import."); }
	$num_rec = dbase_numrecords($dbf);
	$num_fields = dbase_numfields($dbf);
	$fields = array();

	for ($i=1; $i<=$num_rec; $i++){
	$row = @dbase_get_record_with_names($dbf,$i);
	$q = "insert into $db.$table values (";
	foreach ($row as $key => $val){
	if ($key == 'deleted'){ continue; }
	$q .= "'" . addslashes(trim($val)) . "',"; // Code modified to trim out whitespaces
	}

	if (isset($extra_col_val)){ $q .= "'$extra_col_val',"; }
	$q = substr($q, 0, -1);
	$q .= ')';
	//if the query failed - go ahead and print a bunch of debug info
	// if (!$result = mysql_query($q, $conn)){
	if (!$result = $mysqli->query($q)){
		print (mysql_error() . " SQL: $q\n");
		print (substr_count($q, ',') + 1) . " Fields total.";

		$problem_q = explode(',', $q);
		$q1 = "desc $db.$table";
		//$result1 = mysql_query($q1, $conn);
		$result1 = $mysqli->query($q1);
		$columns = array();

		$i = 1;

		while ($row1 = $result1->fetch_assoc()){
			$columns[$i] = $row1['Field'];
			$i++;
		}

		$i = 1;
		foreach ($problem_q as $pq){
			print "$i column: {$columns[$i]} data: $pq\n";
			$i++;
		}
		die();
	}
}
}

$mysqli->close();

?>
```

# apache-flex - 无效的应用程序描述符：未知命名空间：_http://ns.adobe.com/air/application/3.4

> ID：14270244
> 
> 赞同：0
> 
> 时间：2013-01-11T01:28:11.937
> 
> 标签：apache-flex, air, adobe, fdt

我尝试使用 FDT 5 免费版和 Flex sdk 4.6 + Air SDk 3.4。发布 ActionScript 文件时出现此错误

无效的应用程序描述符：未知命名空间：_http://ns.adobe.com/air/application/3.4

# javascript - webRTC createDataChannel 在 Chrome Canary 中引发 DOM 异常

> ID：14270246
> 
> 赞同：0
> 
> 时间：2013-01-11T01:28:39.083
> 
> 标签：javascript, webrtc

我正在尝试在最新的 Chrome Canary 中创建一个数据通道（dataChannel 标志已打开）。

```
var SERVER = "stun:stun.l.google.com:19302";  
var pc1 = new window.webkitRTCPeerConnection({"iceServers": [{"url": SERVER}]});
pc1.createDataChannel('my_channel'); 
```

Canary 向我抛出以下异常： NotSupportedError: DOM Exception 9

有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T22:43:35.877

Chrome 需要将一些连接约束设置为 true。更具体地说，“RtpDataChannels”约束是最重要的。尝试以这种方式使用它：

```
configuration = {'iceServers': [{'url': 'stun:stun.l.google.com:19302'}]};
connection = { 'optional': [{'DtlsSrtpKeyAgreement': true}, {'RtpDataChannels': true }] };
pc1 = new window.webkitRTCPeerConnection(configuration,connection);
pc1.createDataChannel('my_channel'); 
```

# javascript - JavaScript 嵌套对象

> ID：14270248
> 
> 赞同：4
> 
> 时间：2013-01-11T01:28:54.580
> 
> 标签：javascript, oop, prototype

我有一个关于 JavaScript 的问题。我目前正在使用类似于以下代码的代码：

```
function Game() {

} 
```

我想嵌套对象，所以我可以像这样访问它们：

```
var a = new Game();
a.nested_object.method();
a.nested_object.property; 
```

我该怎么做呢？我会使用函数还是 {}？或者它甚至重要吗？下面的代码是我所指的示例代码。

```
function Game() {

this.id;

var stats = {};

} 
```

就像我上面所说的，我可以像这样访问统计信息：

```
var a = new Game();
a.stats 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T02:28:43.833

我会这样做：

```
function Game() {
    this.id;
    this.stats = new Stats(this);
}

function Stats(game) {
    this.property;
    this.method = method;

    function method() {
        this.property;
        game.id;
    }
}

var game = new Game;
game.stats.method(); 
```

原因如下：

1.  **关注点分离**——游戏构造器可以完全专注于游戏逻辑，而统计构造器将只专注于游戏的统计数据。
2.  **模块化**- 您可以将游戏构造函数和统计构造函数放在两个不同的文件中。这使您可以分别处理它们并使项目更易于管理。
3.  **Loose Coupling** - stats 对象不需要知道游戏对象。所以最好把它和游戏对象分开。如果您使用对象文字符号创建它（如@Bergi 所做的那样），那么 stats 对象可以访问游戏对象的私有成员（如果 stats 对象意外更改游戏对象的私有属性，这可能会适得其反）。
4.  **Readability** - Compare @Bergi's code and mine. Separating the stats and the game object makes the code easier to read and understand. You can have one glance at the code and know exactly what's going on.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T01:35:07.383

是的，这正是要走的路。

请注意，您的关键字[`this`将](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)`method()`包含`nested_object`，而不是您的`Game`实例。您只能通过使用指向以下内容的变量来获得对它的引用：

```
function Game() {
    var that = this; // the Game instance
    this.id = …;
    this.nested_object = {
        property: "nested!",
        method: function() {
            this.property; // nested! (=== that.nested_object.property)
            that.id // the game property
        }
    };
}
var game = new Game;
game.nested_object.method(); 
```

因为原型上的嵌套对象（您没有包含实例的变量）很少有意义 - 请参阅[Crockford 的原型继承 - 嵌套对象的问题](https://stackoverflow.com/q/10131052/1048572)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T01:32:35.383

将“嵌套”的东西添加到`this`或`Game.prototype`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T01:33:43.230

[编辑以回应以下评论]

这个怎么样：

```
function Game() {

    this.nested_object = {
        method: function () {
            return 'method return value';
        },

        property: 'property value'
    };

};

var a = new Game();
alert( a.nested_object.method() );
alert( a.nested_object.property ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-11T01:34:28.383

只需在构造函数中创建嵌套对象。

```
function Game() {
    this.stats = { lives: 3 };
};

var a = new Game();
-- a.stats.lives; 
```

但是，这可能很烦人，因为`Game`您必须在实现中引用`stats`as `this.stats`。当引用错误的东西时，例如在表达式中， `this`'es 加起来会引起混淆。`this``function(){}`

我喜欢的模式看起来像这样。它本质上是一个经典的 OO getter 函数。

```
function Game() {
    var stats = { lives: 3 };
    this.stats = function() { return stats; };
};

var a = new Game();
-- a.stats().lives; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-11T01:50:52.250

这应该更合适

```
function Game() {
  this.id;
  this.stats = "Hello";
  return this;
}

var a = new Game();
alert(a.stats); 
```

基本上在你的情况下`stats is a local variable`，创建的对象对变量一无所知。

**[检查小提琴](http://jsfiddle.net/sushanth009/BdTmr/)**

# jquery - 如何在jquery中刷新后将注意力集中在文本字段上

> ID：14270249
> 
> 赞同：1
> 
> 时间：2013-01-11T01:28:54.030
> 
> 标签：jquery, html, asp-classic, ado

刷新后如何保持对文本字段的关注？我有自动检测用户何时停止输入并在此时提交表单的代码。但是如果用户希望继续输入，他们必须再次单击文本框。

此外，如果他们正在执行的查询没有结果，则文本字段内的值（文本）将被删除。我已经在这几个小时了。任何帮助，将不胜感激！

jQuery代码：

```
<script>
$(document).ready(function() {
    $("#cat").change(function () {
    this.form.submit();
})

var typingTimer;                //timer identifier
var doneTypingInterval = 1000;  //time in ms, 5 second for example

//on keyup, start the countdown
$('#legal').keyup(function(){
    clearTimeout(typingTimer);
    if ($('#legal').val) {
        typingTimer = setTimeout(doneTyping, doneTypingInterval);
    }
});

//user is "finished typing," do something
function doneTyping () {
    $("form").submit();
}

});
</script> 
```

页码：

```
<%@ LANGUAGE="VBSCRIPT" %>
<%
pagetitle="Contractor Details"
%>
<!--#INCLUDE VIRTUAL="/_lib/include/header.htm"-->
<!--#INCLUDE VIRTUAL="/_lib/include/menu.htm"-->
<script>
$(document).ready(function() {
    $("#cat").change(function () {
    this.form.submit();
})

var typingTimer;                //timer identifier
var doneTypingInterval = 1000;  //time in ms, 5 second for example

//on keyup, start the countdown
$('#legal').keyup(function(){
    clearTimeout(typingTimer);
    if ($('#legal').val) {
        typingTimer = setTimeout(doneTyping, doneTypingInterval);
    }
});

//user is "finished typing," do something
function doneTyping () {
    $("form").submit();
}

});
</script>
<div class="twoColumnRow">
<div class="twoColumnContent">
<p class="breadCrm"><a href="/index.htm">Home</a> <span>&gt;</span> <a href="/tools/index.htm">Tools of the Trade</a> <span>&gt;</span> <a href="/tools/finance/index.htm">Finance and Purchasing</a><span>&gt;</span> <a href="/tools/finance/procurement/index.htm">Procurement and Contracts information</a></p>
<div class="contentPad">
<!-- Start of main content -->

<p class="imageRight">&nbsp;</p>
<h1><%=pagetitle%></h1>

<%
        Dim connectString, connect, conDB, sconDB, lDB, con, scon, lcon, src_abn, src_cat
        connectString = "Driver={Microsoft Text Driver (*.txt; *.csv)}; DBQ=" & Server.MapPath("data")
              src_legal = Request.QueryString("legal")
              src_cat = Request.QueryString("cat")
        set connect = Server.CreateObject("ADODB.connection")
        connect.open connectString

        if src_cat = "all" then
        conDB = "SELECT * FROM cont.csv WHERE ucase(legal) LIKE ucase('%"+src_legal+"%')"   
        lDB = "SELECT * FROM cont.csv WHERE ucase(legal) LIKE ucase('%"+src_legal+"%')" 
        else 
        conDB = " SELECT * FROM cont.csv WHERE " & src_cat & " = 'Yes' AND ucase(legal) LIKE ucase('%"+src_legal+"%')"
        lDB = " SELECT * FROM cont.csv WHERE " & src_cat & " = 'Yes' AND ucase(legal) LIKE ucase('%"+src_legal+"%')"
        end if

        sconDB = "SELECT * FROM cont.csv"   

        set con = connect.execute(conDB)
        set scon = connect.execute(sconDB)
        set lcon = connect.execute(lDB)
%>
<h2>Search results</h2>
<% if not con.BOF then %>
<div style="margin-top:1em">

  <form id="searchf" action="dbinstant.htm" method="get">

      <p>Company name:1<br/>
      <input id="legal" name="legal" type="text" value="<%=src_legal%>">
      </p>
     <p>Categories for Creative Design:<br/>
      <select id="cat" name="cat">
        <option class="group" label="All categories" value="all" <%if request.querystring("cat") = "all" then response.write("selected") %>></option>
        <option class="group" label="Strategic brand, marketing and communications advice" value="a" <%if request.querystring("cat") = "a" then response.write("selected") %>></option>
        <option class="group" label="Graphic design and layout" value="b" <%if request.querystring("cat") = "b" then response.write("selected") %>></option>
        <option class="group" label="Forms design" value="c" <%if request.querystring("cat") = "c" then response.write("selected") %>></option>
        <option class="group" label="Web design and development" value="d" <%if request.querystring("cat") = "d" then response.write("selected") %>></option>
        <option class="group" label="Authoring services" value="e" <%if request.querystring("cat") = "e" then response.write("selected") %>></option>
        <option class="group" label="Editorial services" value="f" <%if request.querystring("cat") = "f" then response.write("selected") %>></option>
        <option class="group" label="Translation services" value="g" <%if request.querystring("cat") = "g" then response.write("selected") %>></option>
        <option class="group" label="Photography and film services" value="h" <%if request.querystring("cat") = "h" then response.write("selected") %>></option>
        <option class="group" label="Scanning and digitisation services" value="i" <%if request.querystring("cat") = "i" then response.write("selected") %>></option>
        <option class="group" label="Multimedia editing services" value="j" <%if request.querystring("cat") = "j" then response.write("selected") %>></option>
      </select>
    </p>
    <input type="submit" value="Search" />
  </form>
  <br />

    <table style="font-size:.9em;" class="contentTable">
          <tr>
                <th>ABN:</th>
                <th>Company Name:</td>
          </tr>
  <% con.Movefirst() %>
  <% while (NOT con.EOF) %>
          <tr>
                <td width="120px"><%=con("abn")%></th>
                <td><a href="dbcomp.htm?abn=<%=con("abn")%>&cat=all"><%=con("legal")%></a></td>
          </tr>
  <%
    con.MoveNext()
    Wend
  %>
</table>

</div>
<% else %>
    <% scon.Movefirst() %>
  <form action="dbinstant.htm" method="get">

      <p>Company name:2<br/>
      <input id="legal" name="legal" type="text">
      </p>

     <p>Categories for Creative Design:<br/>
      <select id="cat" name="cat">
        <option class="group" label="All categories" value="all" <%if request.querystring("cat") = "all" then response.write("selected") %>></option>
        <option class="group" label="Strategic brand, marketing and communications advice" value="a" <%if request.querystring("cat") = "a" then response.write("selected") %>></option>
        <option class="group" label="Graphic design and layout" value="b" <%if request.querystring("cat") = "b" then response.write("selected") %>></option>
        <option class="group" label="Forms design" value="c" <%if request.querystring("cat") = "c" then response.write("selected") %>></option>
        <option class="group" label="Web design and development" value="d" <%if request.querystring("cat") = "d" then response.write("selected") %>></option>
        <option class="group" label="Authoring services" value="e" <%if request.querystring("cat") = "e" then response.write("selected") %>></option>
        <option class="group" label="Editorial services" value="f" <%if request.querystring("cat") = "f" then response.write("selected") %>></option>
        <option class="group" label="Translation services" value="g" <%if request.querystring("cat") = "g" then response.write("selected") %>></option>
        <option class="group" label="Photography and film services" value="h" <%if request.querystring("cat") = "h" then response.write("selected") %>></option>
        <option class="group" label="Scanning and digitisation services" value="i" <%if request.querystring("cat") = "i" then response.write("selected") %>></option>
        <option class="group" label="Multimedia editing services" value="j" <%if request.querystring("cat") = "j" then response.write("selected") %>></option>
      </select>
    </p>
    <input type="submit" value="Search" />
  </form>
  <br /><hr />
<p>No records match your query.</p>
<p><a href="dbtest.htm">Return to search page</a></p>
<%
  end if
  con.close
%>

<!-- End of main content -->
</div> <!-- end contentPad div -->
</div> <!-- end twocolumncontent div -->
<div class="twoColumnLinks">

<!--<div class="relatedLinks">
<h3>Related Links</h3>
<ul>
<li><a href="/index.htm">Related link 1</a></li>
</ul>
</div>--> <!-- end relatedlinks div -->
<!--#INCLUDE VIRTUAL="/_lib/include/quicklinks.htm"-->
<!--#INCLUDE VIRTUAL="/_lib/include/mylinks.htm"-->
</div> <!-- end twocolumnlinks div -->
</div> <!-- end twocolumnrow div -->
<!--#INCLUDE VIRTUAL="/_lib/include/footer.htm"--> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:33:14.460

您可以在要放置文本光标的元素上调用 focus() 事件。例如：在你的身体加载部分放置 $('#legal').focus()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T01:44:23.733

再试一次：

```
$(document).ready(function() {
    $("#cat").focus();
    $("#cat").val($("#cat").val());
    $("#cat").change(function () {
        this.form.submit();
    });
}); 
```

# haskell - GHC 可以将二进制文件链接到 libc 实现，例如 uclibc（默认在 OpenWrt 中使用）吗？

> ID：14270253
> 
> 赞同：10
> 
> 时间：2013-01-11T01:29:34.447
> 
> 标签：haskell, linker, ghc, glibc, uclibc

我正在使用 Debian/MIPS+QEMU 构建[PortFusion](https://github.com/corsis/PortFusion/wiki/MIPS-Builds)（一种 TCP 隧道解决方案）的 MIPS 端口。生成的二进制文件链接到 GNU libc。因此，它们不能仅仅被复制并在随**uclibc**而不是**eglibc**（似乎与 GNU libc 二进制兼容）一起提供的 vanilla OpenWrt 上使用。

* * *

*   有没有办法将 Debian/MIPS 上的 Haskell/GHC 二进制文件链接到**uclibc**而不是**eglibc**？

*   OpenWrt 使用**uclibc**是否真的是从 Debian 复制过来的 PortFusion 二进制文件无法运行*的*`-ash: binary not found`原因，或者此消息是否完全是由于其他原因？

* * *

有关使用 Linux 内核和 CPU 仿真的详细信息，请参阅[https://github.com/corsis/PortFusion/wiki/MIPS-Builds 。](https://github.com/corsis/PortFusion/wiki/MIPS-Builds)`haskell-platform`

* * *

`make`当我尝试构建使用**eglibc**的自定义 OpenWrt 映像时，OpenWrt 的 GIT 存储库的当前负责人失败了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T21:41:08.137

> 有没有办法将 Debian/MIPS 上的 Haskell/GHC 二进制文件链接到 uclibc 而不是 eglibc？

不可以。您需要使用基于 uclibc 的 GCC 交叉编译器从源代码重建 Haskell/GHC。

> OpenWrt 使用 uclibc 真的是原因吗

是的。此外，您可以尝试`ldd`在您的 MIPS pplatform 上使用来检查缺少哪些库。我敢肯定它会是一些与 libc 相关的库。

# python - Python：HTML 生成性能改进

> ID：14270254
> 
> 赞同：0
> 
> 时间：2013-01-11T01:29:45.493
> 
> 标签：python, html

我目前支持通过创建单个标签对象生成所有 html 的旧版 python 应用程序。

我们有一个父标签类

```
class TAG(object):
    def __init__(self, tag="TAG", contents=None, **attributes):
        self.tag = tag
        self.contents = contents
        self.attributes = attributes 
```

所以所有其他标签都继承自 TAG

```
class H1(TAG):
    def __init__(self, contents=None, **attributes):
        TAG.__init__(self, 'H1', contents, **attributes)
class H2(TAG):
    def __init__(self, contents=None, **attributes):
        TAG.__init__(self, 'H2', contents, **attributes) 
```

主 TAG 类有一个 to_string 方法，类似于

```
def to_string(self):
    yield '<{}'.format(self.tag)
    for (a, v) in self.attr_g():
        yield ' {}="{}"'.format(a, v)
    if self.NO_CONTENTS:
        yield '/>'
    else :
        yield '>'
        for c in self.contents:
            if isinstance(c, TAG):
                for i in c.str_g():
                    yield i
            else:
                yield c
        yield '</{}>'.format(self.tag) 
```

我们基本上写出了 to_string 方法的结果。

问题出现在生成大量 TAGS 并且大到足以造成性能影响的页面上。

我可以做些什么快速的胜利来让它表现得更好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T01:49:11.650

前言：这是一种很糟糕的生成 HTML 的方式，但如果你要这样做，你最好还是尽可能用最好的方式来做。

python 非常擅长的一件事是字符串格式化。如果你要连接很多细小的字符串，你会从一开始就扼杀你的表现。您的`to_string()`方法应该看起来更像这样：

```
def to_string(self):
    return """<{tag}{attributes}>{content}</{tag}>""".format(
        tag=self.tag,
        attributes=' '.join('%s="%s"' % (attr, val) for
                            attr, val in self.attributes),
        content=''.join(
            (n if isinstance(n, basestring) else n.to_string()) for
            n in self.contents)) 
```

记下我在那里做过的几件事：

1.  这是 Python，不是 Java。堆栈帧很昂贵，因此尽量减少函数和方法调用。
2.  如果您不需要函数来抽象属性，请不要这样做。即：您不需要`attr_g`（除了可能进行转义，但是当您将数据放入时可以这样做）。
3.  对同一个字符串进行所有字符串格式化！对一个小字符串进行单个字符串格式化操作，然后将其连接起来是一种巨大的浪费。
4.  不要为此使用生成器。每次屈服时，您都在纠结于指令指针，这本质上会减慢速度。

其他指针：

*   您继承自`object`，因此请使用该`super()`功能。
*   不要浪费代码编写构造函数来声明标签类型：

    ```
    class TAG(object):
        def __init__(self, contents=None, **attributes):
            self.contents = contents
            self.attributes = attributes

    class H1(TAG):
        tag = 'H1'

    class H2(TAG):
        tag = 'H2' 
    ```

*   `StringIO`如果你做了很多这样的事情，你可能会在对象方面取得一些成功。它们会让你构建你的标签和`.write()`它们。你可以把它们想象成 .Net`StringBuffer`或 Java 的`StringBuilder`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T02:32:01.313

@mattbasta 在这里有正确的想法。但是，我想提出一些不同的建议：`to_string`使用`cElementTree.TreeBuilder`. 我不知道 ElementTree 的超快速序列化是否会胜过创建 ElementTree 的开销。

这是一个不稳定的`TAG`类，它的`to_string_b()`方法利用了一些微优化并使用 TreeBuilder 来构建树。（您的和 TreeBuilder 之间可能的重要区别`to_string()`是 TreeBuilder 将始终转义 XML 的输出，而您的则不会。）

```
import xml.etree.cElementTree as ET

class TAG(object):
    def __init__(self, tag="TAG", contents=None, **attributes):
        self.tag = tag
        # this is to insure that `contents` always has a uniform
        # type.
        if contents is None:
            self.contents = []
        else:
            if isinstance(contents, basestring):
                # I suspect the calling code passes in a string as contents
                # in the common case, so this means that each character of
                # the string will be yielded one-by-one. let's avoid that by
                # wrapping in a list.
                self.contents = [contents]
            else:
                self.contents = contents
        self.attributes = attributes

    def to_string(self):
        yield '<{}'.format(self.tag)
        for (a, v) in self.attributes.items():
            yield ' {}="{}"'.format(a, v)
        if self.contents is None:
            yield '/>'
        else :
            yield '>'
            for c in self.contents:
                if isinstance(c, TAG):
                    for i in c.to_string():
                        yield i
                else:
                    yield c
            yield '</{}>'.format(self.tag)

    def to_string_b(self, builder=None):
        global isinstance, basestring
        def isbasestring(c, isinstance=isinstance, basestring=basestring):
            # some inlining
            return isinstance(c, basestring)
        if builder is None:
            iamroot = True
            builder = ET.TreeBuilder()
        else:
            iamroot = False #don't close+flush the builder
        builder.start(self.tag, self.attributes)
        if self.contents is not None:
            for c in self.contents:
                if (isbasestring(c)):
                    builder.data(c)
                else:
                    for _ in c.to_string_b(builder):
                        pass
        builder.end(self.tag)
        # this is a yield *ONLY* to preserve the interface
        # of to_string()! if you can change the calling
        # code easily, use return instead!
        if iamroot:
            yield ET.tostring(builder.close())

class H1(TAG):
    def __init__(self, contents=None, **attributes):
        TAG.__init__(self, 'H1', contents, **attributes)
class H2(TAG):
    def __init__(self, contents=None, **attributes):
        TAG.__init__(self, 'H2', contents, **attributes)    

tree = H1(["This is some ", H2("test input", id="abcd", cls="efgh"), " and trailing text"])

print ''.join(tree.to_string())
print ''.join(tree.to_string_b()) 
```

# node.js - 向 webclients 发送实时数据错误捕获

> ID：14270256
> 
> 赞同：1
> 
> 时间：2013-01-11T01:30:04.697
> 
> 标签：node.js, socket.io

尝试将数据从串行设备发送到 Web 客户端。我正在使用串行到网络代理[ser2Net](http://sourceforge.net/projects/ser2net/)使数据可用于服务器，该服务器对数据进行操作并将数据的操纵版本发送到 Web 客户端。客户端指定 ser2net 主机和端口的位置。此操作的核心在 node.js 中编码，如下所示：

```
function getDataStream(socket, dataSourcePort, host) {
    var dataStream = net.createConnection(dataSourcePort, host),
        dataLine = "";

    dataStream.on('error', function(error){
        socket.emit('error',{message:"Source not found on host:"+ host + " port:"+dataSourcePort});
        console.log(error);
    });

    dataStream.on('connect', function(){
        socket.emit('connected',{message:"Data Source Found"});
    });

    dataStream.on('close', function(){
        console.log("Close socket");     
    });

    dataStream.on('end',function(){
        console.log('socket ended');
        dataConnection.emit('lost',{connectInfo:{host:host,port:dataSourcePort}});
    });

    dataStream.on('data', function(data) {

        // Collect a line from the host
        line += data.toString();
        // Split collected data by delimiter
        line.split(delimiter).forEach(function (part, i, array) {
        if (i !== array.length-1) { // Fully delimited line.
            //push on to buffer and emit when bufferSendCommand is present
            dataLine = part.trim();
            buffer.push(part.trim());
            if(part.substring(0, bufferSendCommand.length) == bufferSendCommand){
                gotALine.emit('new', buffer);
                buffer=[];
            }
        }
        else {
          // Last split part might be partial. We can't announce it just yet.
          line = part;
        }
      });
    });
    return dataStream; 
}

io.sockets.on('connection', function(socket){

    var stream = getDataStream(socket, dataSourcePort, host);

    //dispense incoming data from data server
    gotALine.on('new', function(buffer){
        socket.emit('feed', {feedLines: buffer});
    });

    dataConnection.on('lost', function(connectInfo){
        setTimeout(function(){
            console.log("Trying --- to reconnect ");
            stream = getDataStream(socket, connectInfo.port, connectInfo.host);
        },5000);
    });

    // Handle Client request to change stream 
    socket.on('message',function(data) {
        var clientMessage = JSON.parse(data);
        if('connectString' in clientMessage
            && clientMessage.connectString.dataHost !== ''
            && clientMessage.connectString.dataPort !== '') {
            stream.destroy();
            stream = getDataStream(socket,
                clientMessage.connectString.dataPort,
                clientMessage.connectString.dataHost);
        }
    });    
}); 
```

这工作得很好，直到串行设备掉线并且 ser2net 停止发送数据。我试图抓住套接字的末端并重新连接是行不通的。该事件被正确发出，但 setTimeout 只发生一次。我想找到一种方法来继续尝试重新连接，同时向客户端发送消息通知或重试尝试。我是 node.js 新手，这可能不是最好的方法。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T21:54:05.123

好的，我想我在 dataStream.on('data' ... 我添加了一个 setTimeout

```
clearTimeout(connectionMonitor);
connectionMonitor = setTimeout(function(){doReconnect(socket);}, someThresholdTime); 
```

如果数据停止进入，超时就会执行，因为每次数据进入时都会重复清除它。doReconnect 函数不断尝试连接并向客户端发送一条消息，说明正在发生错误。

# knockout.js - 使用嵌套的 DIV 嵌套多个 VM

> ID：14270259
> 
> 赞同：5
> 
> 时间：2013-01-11T01:30:23.127
> 
> 标签：knockout.js

我遇到嵌套的 div 不会与 VM 绑定。有什么想法吗？我正在尝试以下方法，但它打破了任何想法？

```
<div id="div1">
   <div id="div2">

   </div>
</div> 
```

如果我尝试这很好用：

```
<div id="div1">
</div>

<div id="div2">
</div> 
```

Javascript：

```
ko.applyBindings(vm1, document.getElementById('div1'));
ko.applyBindings(vm2, document.getElementById('div2')); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T04:03:53.080

当您绑定`div1`时，它将绑定所有内容，包括`div2`. 当你绑定`div2`它会再次绑定元素。这不是一个好的情况，因为元素将附加多个事件处理程序。否则，其中一个 applyBindings 可能会出错，因为元素不希望绑定到不同的视图模型。

这里的文章列出了一种保护内部元素不受外部调用绑定的方法：[http ://www.knockmeout.net/2012/05/quick-tip-skip-binding.html](http://www.knockmeout.net/2012/05/quick-tip-skip-binding.html)

另一种选择是使用单一视图模型，如：

```
var viewModel = {
  vm1: vm1,
  vm2: vm2
};

ko.applyBindings(viewModel); 
```

然后，像这样绑定：

```
<div id="div1" data-bind="with: vm1">
   <div id="div2" data-bind="with: $root.vm2">

   </div>
</div> 
```

# android - 从数据库中读取值

> ID：14270262
> 
> 赞同：1
> 
> 时间：2013-01-11T01:30:47.850
> 
> 标签：android, database, select, if-statement, return

我的应用程序中有一个数据库，其中包含几列，其中 3 列是：`_id` `name` `selected`. 现在，我想从一行
中读取一个值，该值是我从一些代码中获得的字符串。最好的方法是什么？ 谢谢`selected``name`

PS我得到那个值来检查它是0还是1（只有两个可能的值），所以我想问一下如何在该领域做出一种`if`陈述`return`？我见过有些人用类似这样的东西来做到这一点：`return true ? ... false`

**编辑：**
好的，这是我的代码 atm，还没有检查它，因为我需要做一些其他的事情来完成它，但我认为可能有更好的方法来做到这一点。

```
public boolean isBandSelected(String name) {
    // TODO Auto-generated method stub
    Cursor cursor = mDb.query("bands", new String[] { "selected" }, "name="
            + name, null, null, null, null);
    int index = cursor.getColumnIndex("selected");
    String selected = cursor.getString(index);
    return selected == "1";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T01:51:42.843

您可以使用正则表达式来匹配名称字段为字符串的行。许多数据库可以支持正则表达式。

三元运算符（？ :) 可用于制作这样的返回语句。

```
return value == 0 ? false : true 
```

但这取决于你返回什么类型的数据。上面的代码返回布尔数据类型。

上面代码的最后一行将始终返回`false`。这是因为`==`运算符比较了两个对象的引用。您可以使用：

```
return "1".equals(selected); 
```

# cron - crontab 小时与 UTC 工作时间 GMT-8

> ID：14270268
> 
> 赞同：0
> 
> 时间：2013-01-11T01:31:53.910
> 
> 标签：cron, crontab, utc, gmt

我在格林威治标准时间设置了一台机器。我想在太平洋标准时间上午 6 点到下午 5 点安排一个 cron 任务，即 GMT-8。

GMT 时区。典型的。

```
00 06-17 * * * 
```

现在 -8 产生一个 crontab 错误时间错误。

```
00 22-09 * * * 
```

以下内容被接受，或者我应该说，没有错误。

```
00 22,23,0,1,2,3,4,5,6,7,8,9 * * * 
```

因此有任何简短的形式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T01:37:35.547

对于 vixie cron，

> 允许列表和范围共存于同一字段中。AT&T 或 BSD cron 会拒绝“1-3,7-9”——他们只想看到“1-3”或“7,8,9”

也就是说，以下内容：

```
00 22-23,0-9 * * * 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T01:47:05.467

您也可以尝试更改 cron 的时区：

```
suku@ubuntu-vm:~$ crontab -l | tail -2
TZ=Africa/Tripoli
*   *   *   *   *   date > date.txt
suku@ubuntu-vm:~$ cat date.txt
Thu Jan 10 18:50:01 EET 2013
suku@ubuntu-vm:~$ date
Thu Jan 10 22:20:19 IST 2013 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T08:16:03.273

尝试基础知识的好地方是 www.dataphyx.com 上的 cron 模拟器[1](http://www.dataphyx.com/cronsandbox/)

# javascript - 将多个 iframe 调整为当前窗口大小

> ID：14270270
> 
> 赞同：0
> 
> 时间：2013-01-11T01:32:19.400
> 
> 标签：javascript

我有一个位于内容管理系统内的仪表板。它有 4 个 iframe 排列在一个表格中，因此 3 个框架占据第一列和 3 个单独的行。第 4 帧占据第二列并跨越所有三行。Javascript 获取窗口尺寸并调整框架 onload() 和 onresize() 的大小。在一个小窗口上，左列的 3 个框架的大小都为半英寸高，即使它们有可见的空间。

什么是垂直尺寸投掷，我该如何改进它？

请将答案集中在 javascript 上。

```
 <script type="text/javascript">
    var winW = 1024, winH = 768; //This sets a minimum height and width
    function calcHeight(ifid) {
        getWinH();
        document.getElementById(ifid).height = winH;
    }
    //Cross-browser function to get window height

       var compW = 35;
       var compH = 290;

        function getWinH() {

        if (document.body &amp;&amp; document.body.offsetWidth) {
            winW = document.body.offsetWidth;
            winH = document.body.offsetHeight;
        }
        if (document.compatMode == 'CSS1Compat' &amp;&amp; document.documentElement &amp;&amp; document.documentElement.offsetWidth) {
            winW = document.documentElement.offsetWidth;
            winH = document.documentElement.offsetHeight;
        }
        if (window.innerWidth &amp;&amp; window.innerHeight) {
            winW = window.innerWidth;
            winH = window.innerHeight;
        }
          winW = winW - compW;
          winH = winH - compH;  

    document.getElementById("box1").setAttribute("width", Math.floor(winW * 0.4));
    document.getElementById("box1").setAttribute("height", Math.floor(winH * 0.4));

    document.getElementById("box4").setAttribute("width", Math.floor(winW * 0.6));
    document.getElementById("box4").setAttribute("height", winH + 175); //comps for the titles of other boxes

    document.getElementById("box2").setAttribute("width", Math.floor(winW * 0.4));
    document.getElementById("box2").setAttribute("height", Math.floor(winH * 0.4));

    document.getElementById("box3").setAttribute("width", Math.floor(winW * 0.4));
    document.getElementById("box3").setAttribute("height", Math.floor(winH * 0.4));

    }
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:09:29.100

尝试使用样式设置大小：

```
 var boxes = [document.getElementById("box1"), document.getElementById("box2"), document.getElementById("box3"), document.getElementById("box4")];
boxes[0].style.width = Math.floor(winW * 0.4) + "px";
boxes[0].style.height =  Math.floor(winH * 0.4) + "px"

boxes[3].style.width = Math.floor(winW * 0.6) + "px";
boxes[3].style.height =  (winH + 175) + "px"; //comps for the titles of other boxes

boxes[1].style.width = Math.floor(winW * 0.4) + "px";
boxes[1].style.height = Math.floor(winH * 0.4) + "px";

boxes[2].style.width = Math.floor(winW * 0.4) + "px";
boxes[2].style.height = Matth.floor(winH * 0.4) + "px"; 
```

# google-chrome - 有没有办法在 Chrome 浏览器上模拟两指滑动？

> ID：14270274
> 
> 赞同：12
> 
> 时间：2013-01-11T01:33:06.517
> 
> 标签：google-chrome, google-chrome-devtools

我已启用“模拟触摸事件”并且可以执行正常滑动。有没有办法模拟两指滑动？还有其他这样的手势？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T10:42:42.120

检查[http://www.html5rocks.com/en/mobile/touch/#toc-touchdev（MULTI-TOUCH](http://www.html5rocks.com/en/mobile/touch/#toc-touchdev) EVENTS 小节） - 它包含对该主题的一些处理。

# android - 如何使用 OAuth 2 在 App Engine 服务器上对 Android 应用进行身份验证/验证？

> ID：14270278
> 
> 赞同：2
> 
> 时间：2013-01-11T01:33:31.707
> 
> 标签：android, google-app-engine, authentication, servlets, oauth-2.0

我有一个简单的应用程序，可以让用户绘制图片。有安卓版、IOS版和网页版。我还让用户将他们的图片存储在我们的 App 引擎服务器上，我希望他们能够与其他用户协作。我想使用谷歌帐户进行身份验证和一些权限方案的基础。

我不知道如何在 android（或 IOS）上验证/验证用户的 Google 帐户。我希望有人可以帮助或指出我正确的方向。到目前为止，这是我的理解：

在基于 Web 的客户端上，我只使用 Google-web 工具包 UserService。但是对于我的应用程序引擎 servlet，我不确定我应该使用什么。目前，servlet 的代码如下：

```
 public void doGet(HttpServletRequest request, HttpServletResponse response)
      throws IOException, ServletException
{
    OAuthService oauth = null; 
    oauth = OAuthServiceFactory.getOAuthService(); 
    User user = oauth.getCurrentUser();
    // Do stuff
} 
```

在我的 android 应用程序中，我认为我应该执行以下操作：

1) 从 AccountManager 获取账户

2) 致电：

```
accountManager.getAuthToken
(account,  // Account 
"oauth2:https://www.googleapis.com/auth/userinfo.profile",//AUTH Token Type
null,   // Options
this,  // Activity
new MyAccountsManagerCallBack(),  // call-back
null);    // Handler 
```

这会给我授权令牌。

3)?? 利润 ？？

这就是我迷路的地方。我是否将此授权令牌作为明文查询参数发送到我的应用引擎服务器，然后从 Web 服务器向 userinfo/profile api 发出请求？这似乎并不安全。

有什么方法可以使 OAuthService 的旧代码正常工作吗？

OAuth 2 的示例使用 Google 任务 API，但我想使用我的应用引擎 API。我使用 cookie、webviews、title 等找到了 OAuth 1 的信息，但没有关于 OAuth 2 的信息，而且没有一个真正告诉我如何验证服务器端。

我真的不知道我应该在这里做什么。我将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-22T18:41:02.367

澄清一下，这是我在应用程序引擎上提供的 java servlet 的示例：

```
public class ServletSecureData extends HttpServlet { 
  @Override
  protected void doGet(HttpServletRequest request, HttpServletResponse response)
    throws ServletException, IOException {
    UserService usersrvc = null;      
    usersrvc = UserServiceFactory.getUserService();
    User user = usersrvc.getCurrentUser();
    if(user == null)
      throw new IOException();

    Random r = new Random(System.currentTimeMillis());
    int num = r.nextInt(10);
    PrintWriter out = response.getWriter();
    out.printf("Security !! %s radioactive man! %d", user.getEmail(), num);
    out.close();
  }
} 
```

此 servlet 受到 web.xml 文件中定义的安全约束的保护。我希望能够使用 android 客户端访问这个 servlet。我以为我必须使用 Oauth，但事实证明我需要使用较旧的已弃用服务 ClientLogin

我的实现基于此站点的代码：http: [//blog.notdot.net/2010/05/Authenticating-against-App-Engine-from-an-Android-app](http://blog.notdot.net/2010/05/Authenticating-against-App-Engine-from-an-Android-app)

# javascript - getDay() 是否符合 ISO 8601？

> ID：14270281
> 
> 赞同：5
> 
> 时间：2013-01-11T01:34:10.160
> 
> 标签：javascript

我很难确定 JavaScript 的`getDay()`方法（[http://www.w3schools.com/jsref/jsref_getday.asp](http://www.w3schools.com/jsref/jsref_getday.asp)）是否符合 ISO 8601。

`getDay()``0`周日，`1`周一等返回。

该文档建议映射到这样的日期名称：

```
var weekday=new Array(7);
weekday[0]="Sunday";
weekday[1]="Monday";
weekday[2]="Tuesday";
...
var n = weekday[(new Date()).getDay()]; 
```

我只能看到 ISO 标准将星期一定义为一周的第一天。我认为这意味着星期一应该是 0，而不是星期日。

有人对这个有经验么？您能否澄清一下，您是否会建议重写使星期一成为一周第一天的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T01:41:50.817

```
var weekday=new Array(7);
weekday[0]="Monday";
weekday[1]="Tuesday";
weekday[2]="Wednesday";
...
var n = weekday[((new Date()).getDay() + 6) % 7 + 1]; 
```

或扩展 Date 原型：

```
Date.prototype.getISODay = function(){ return (this.getDay() + 6) % 7 + 1; } 
```

然后使用

```
var n = weekday[(new Date()).getISODay()]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T01:46:47.957

仅当您想使用日期格式（其中工作日实际上表示为数字）时，如何表示工作日才重要，例如`YYYY-Www-D`格式，或者如果您想获取特定日期的周数。

否则，工作日的数字表示方式无关紧要。星期一仍然是星期一。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-11T02:42:00.123

我能找到的唯一来源是[维基百科](http://en.wikipedia.org/wiki/ISO_week_date)和[这个页面](http://www.cl.cam.ac.uk/~mgk25/iso-time.html)。两者都建议星期几数字应该是`1`从*星期一*`7`开始。

 *我支持[ic3b3rg](https://stackoverflow.com/users/753237/ic3b3rg)的扩展建议[`Date.prototype`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/prototype)，尽管建议使用 UTC 和文字来获取名称。以下示例使用*Object*和匿名函数，因此名称只需定义一次。

```
(function () {
    var dayNames = {1: 'Monday', 2: 'Tuesday', 3: 'Wednesday', 4: 'Thursday', 5: 'Friday', 6: 'Saturday', 7: 'Sunday'};
    // Local time
    Date.prototype.getISODay = function () {return this.getDay() || 7;};
    Date.prototype.getISODayName = function () {return dayNames[this.getDay() || 7];};
    // Date.prototype.getDayName = Date.prototype.getISODayName
    // UTC
    Date.prototype.getUTCISODay = function () {return this.getUTCDay() || 7;};
    Date.prototype.getUTCISODayName = function () {return dayNames[this.getUTCDay() || 7];};
    // Date.prototype.getUTCDayName = Date.prototype.getUTCISODayName;
}()); 
```

由于日期名称与 ISO 日期名称相同（假设为*English*），因此我添加了额外的行，如果您想要两者都可以取消注释。*

# ruby-on-rails - 在 Dreamhost VPS 上安装 imagemagick

> ID：14270288
> 
> 赞同：0
> 
> 时间：2013-01-11T01:35:00.070
> 
> 标签：ruby-on-rails, ruby, imagemagick, carrierwave, dreamhost

我正在尝试安装 imagemagick 和 rmagick，这样我就可以使用 rails 运行carrierwave gem。我在 Dreamhost 的 VPS 上。服务器和 gem 的安装不是我的强项，我可以使用以下命令在我的本地机器上安装这些 gem

```
sudo apt-get install imagemagick libmagickcore-dev libmagickwand-dev
sudo gem install rmagick 
```

但是在 VPS 服务器上有点不同，但是这样做是行不通的。在dreamhost上安装carrierwave的正确方法是什么。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T02:51:13.647

我们有几篇 wiki 文章可能对您有用：

[http://wiki.dreamhost.com/Image_Magick](http://wiki.dreamhost.com/Image_Magick) [http://wiki.dreamhost.com/RMagick](http://wiki.dreamhost.com/RMagick)

Dreamhost VPS 不再允许 admin/sudo 用户。 ~~此外，当您在 VPS 上时，您只能对管理员用户使用 sudo。如果您还没有设置，可以在此处从 DreamHost 面板进行设置：[https ://panel.dreamhost.com/index.cgi?tree=vserver.adminusers&](https://panel.dreamhost.com/index.cgi?tree=vserver.adminusers&)~~

希望这可以帮助！如果没有，请不要犹豫，通过您的小组向我们的支持团队发送电子邮件。我们很乐意每周 7 天、每天 24 小时提供帮助。:)

埃利斯小号

DreamHost 员工

# c# - 在 C# 中将 CSV 文件与数据库进行比较的最快方法

> ID：14270289
> 
> 赞同：1
> 
> 时间：2013-01-11T01:34:59.943
> 
> 标签：c#, sql, compare

我正在编写一个内部应用程序，其中一个功能是从远程系统导入数据。来自远程系统的数据以 CSV 文件的形式出现。我需要将系统中的数据与 CSV 文件中的数据进行比较。

我需要对我的系统应用任何更改（添加和更改）。我需要跟踪每个更改的字段。

我的数据库已标准化，因此我正在处理大约 10 个表以与 CSV 文件中的数据相对应。实现这一点的最佳方法是什么？每个 CSV 文件每天处理大约 500,000 条记录。我首先使用查找 ID 从我的 SQL 数据库中逐行查询，然后使用 c# 逐字段进行比较，并根据需要进行更新或插入；但是，这需要的时间太长了。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T01:42:08.977

您可以执行以下操作：

*   将 cvs 文件加载到数据库中的暂存表中；
*   对其执行验证和清理程序（如有必要）
*   对实时数据进行比较和更新
*   清除临时表中的所有数据

使用这种方法，您可以使用您的 RDBMS 功能实现几乎所有的清理、验证和更新逻辑。

如果您的 RDBMS 是 SQL Server，您可以利用 SQL Server Integration Services。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T01:43:16.887

如果您有任何东西可用作唯一键，则可以执行以下操作：

*   创建一个新表 Hashes，其中包含唯一键和与该键关联的所有字段的哈希（不要*使用*.NET 的 object.GetHashCode()，因为返回的值会根据设计不时更改。我个人使用 Google 的 CityHash我移植到 C#)。
*   当你得到一个新的 CSV 文件时，计算每个键的哈希值
*   检查 CSV 文件中每一行的哈希表。
*   如果唯一键没有条目，则创建一个并插入行。
*   如果有条目，请查看哈希是否已更改。
*   如果有，请更新哈希表中的哈希并更新数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T01:43:14.423

扩展对您问题的第一条评论。

创建一个与您的 csv 文件格式匹配的适当索引表，并将数据直接转储到其中。

有一个带有适当查询的存储过程来更新/删除/插入活动表。

摆脱临时表。

# node.js - 如何在开发人员/客户端机器上的工作目录上监听 svn commit 事件？

> ID：14270294
> 
> 赞同：1
> 
> 时间：2013-01-11T01:36:29.497
> 
> 标签：node.js, svn, commit

我需要编写一个 node.js 程序，只要开发人员将代码签入 svn，它就会以某种方式被触发。这将更新工作目录中的文件。开发人员在 Mac OS X 和 Windows 上工作。该程序需要在两台机器上运行。

有没有办法让我以某种方式听取 svn 客户端的提交？是否有任何允许插件/扩展的 svn sdk？会观察 .svn 隐藏目录（svn 创建供自己使用）进行更改吗？如果是这样，我如何通过查看此目录来知道文件已提交？

起初我认为钩子可能是要走的路，但钩子是在托管 svn 的机器上运行的，它们主要用于管理任务，例如发送电子邮件警报或启动构建

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T09:21:28.897

首先您需要了解，如果不连接到服务器，就无法知道服务器上是否发生了更新。因此，您不能仅仅通过查看本地文件夹来做到这一点，因为这不是 svn 的工作方式。

实现您想要的解决方法如下。在服务器上，编写一个“post-commit”钩子，它从文本文件中获取一个计数器，将其递增，然后将其写回。将此文本文件存放在您的客户可以下载的地方。我假设这将在“http://www.example.com/commit-id.txt”上。然后，在客户端上，使用 shell 脚本来监视此文本文件的更改并执行所需的操作。例如，使用 windows powershell 可以按如下方式工作。对于 Mac，您需要使用不同的 shell，但我确信这个脚本可以很容易地移植。

```
function get-current-commit-id {
        trap [Exception] {
                # Make sure the script doesn't freak out when server is down or connection
                $commitid
                return
        }
        # The rand.next() ensures by brute force that the text file is not cached
        [int] $clnt.DownloadString("http://www.example.com/commit-id.txt?q="+$rand.next())
}

$clnt = new-object System.Net.WebClient
$commitid = get-current-commit-id

while( 1 ){
        $commitidnew = get-current-commit-id
        if( $commitidnew -ne $rsid ){
                Write-Output "Commit occured on server"

                ### execute desired action here
                ### perhaps you'll also want to run "svn up"

                $commitid = $rsidnew
        }
        ### check for new update every 10 seconds
        sleep 10
} 
```

# c# - 双倍指定长度的正则表达式

> ID：14270296
> 
> 赞同：0
> 
> 时间：2013-01-11T01:37:05.237
> 
> 标签：c#, asp.net, regex, validation, double

我似乎找不到完全符合我需要的表达式，我需要验证一个表示从数据库中提取的双精度值的文本框。表中的列具有数值精度，因此我需要一个正则表达式来保持双精度值的长度以适应表列的 19 精度。它可以为空，但不能超过字段的限制。

确切地说，数据库列值是 OleDbType.Currency，但是当我检索我相信的数据类型时，它会转换为双精度或整数。

如果有人有适合我需要的表达方式，我将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T01:45:26.620

我想我也需要更多表中数据的示例。但是这样的事情会开始到达那里吗：

`-?\d+(\.\d{1,x})?`

分解它：

`-?`是一个可选的减号。

`\d+`是一些位数

`(\.\d{1,x})?`用于可选的小数点组，后跟至少一位数字，最多 x 位。对于 x，代入您知道它可以具有的最大精度或比例。

# java - QueryDsl 设置架构

> ID：14270297
> 
> 赞同：2
> 
> 时间：2013-01-11T01:37:11.733
> 
> 标签：java, spring, db2, h2, querydsl

使用 Spring`DataSource`和 QueryDsl `SQLQueryImpl`，您如何指定架构或设置架构？

测试用例是：

1.  使用 querydsl-maven-plugin (2.9.0) 连接到 DB2 数据库以生成 Q-Classes 指定`<schemaPattern>`
2.  Spring创建一个`DataSource`bean
3.  `DataSource`bean 由脚本（`CREATE SCHEMA FOO`等`CREATE TABLE FOO.BAR`）填充
4.  JUnit 测试导入`DataSource`
5.  查询使用`new SQLQueryImpl(dataSource.getConnection(), Configuration.DEFAULT)`

错误：

```
org.h2.jdbc.JdbcSQLException: Table "BAR" not found; SQL Statement: ... 
```

请注意，这个测试实现是一个 H2 数据库，但生产数据库是 DB2。到目前为止，我尝试在 JDBC 连接字符串中指定模式无济于事。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-07T09:10:08.100

`com.mysema.query.sql.SQLTemplates`有一个名为`printSchema()`. `SQLTemplates`使用方法初始化`builder()`并调用`printSchema()`before `build()`。要遵循的示例：

```
SQLTemplates templates = OracleTemplates.builder().printSchema().build(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T07:37:07.697

Schema 以 Q 类型编码。它通过 RelationalPath 接口在 SQL 序列化中访问[http://www.querydsl.com/static/querydsl/2.9.0/apidocs/com/mysema/query/sql/RelationalPath.html](http://www.querydsl.com/static/querydsl/2.9.0/apidocs/com/mysema/query/sql/RelationalPath.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T19:51:45.483

我能够`SQLTemplates`使用自己的实现进行扩展，该实现称为受保护的方法`setPrintSchema(true);`。

# api - GDB Api lookup_symbol 没有得到符号地址

> ID：14270298
> 
> 赞同：1
> 
> 时间：2013-01-11T01:37:27.303
> 
> 标签：api, debugging, gdb

这是一个关于更改 GDB 代码以添加我自己的 CLI 的问题。

我正在使用 lookup_symbol("XYZ", ...) 在我的核心转储中查找全局系统地址。API 成功 - 即，获取符号数据结构，符号名称，但没有地址。

'打印 XYZ' 工作正常！

我可以更改什么来正确获取符号地址。

# linux - CLOCK_MONOTONIC 和 CLOCK_MONOTONIC_RAW 有什么区别？

> ID：14270300
> 
> 赞同：46
> 
> 时间：2013-01-11T01:37:29.023
> 
> 标签：linux, ubuntu, timing

根据Ubuntu下的Linux手册页

```
CLOCK_MONOTONIC
      Clock that cannot be set and  represents  monotonic  time  since
      some unspecified starting point.

CLOCK_MONOTONIC_RAW (since Linux 2.6.28; Linux-specific)
      Similar  to  CLOCK_MONOTONIC, but provides access to a raw hard‐
      ware-based time that is not subject to NTP adjustments. 
```

根据韦伯斯特在线词典单调意味着：

> 2：随着自变量的值或项的下标的增加，具有从不增加或从不减少的性质。

换句话说，它不会向后跳。我可以看到，如果您正在计时一些代码，这将是一个重要的属性。

但是，普通版和原始版之间的区别尚不清楚。有人可以阐明 NTP 如何仍然影响 CLOCK_MONOTONIC 吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-01-11T01:51:23.840

`CLOCK_MONOTONIC`从未因 NTP 时间调整而出现不连续性，但随着 NTP 了解本地振​​荡器和上游服务器之间存在什么错误，它的频率*确实会*发生变化。

`CLOCK_MONOTONIC_RAW`只是本地振荡器，不受 NTP 约束。如果您想针对由于 NTP 而不会与您对抗的时钟实现一些其他时间同步算法，这可能非常有用。虽然 ntpd（NTP 协议的参考实现和最广泛使用的 NTP 守护程序）被认为对时间调整“温和”，但更准确地说它对绝对时间很温和。如果您能够根据其他标准测量您的时钟频率，它愿意将时钟调整 500 ppm，这非常引人注目。

The utility of `CLOCK_MONOTONIC_RAW` is going to be limited until facilities like `pthread_timedwait_monotonic` offer an option to use that timebase.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T01:43:33.637

`ntpd`如果差异低于某个阈值，则不会导致时间*跳跃。*而是使用了类似 adjtime 的调整，同时影响`CLOCK_MONOTONIC`和`CLOCK_REALTIME`（但`CLOCK_MONOTONIC_RAW`显然不是）。

# qt - 是否可以将一个场景中的项目移动到 Qt 中的另一个场景之上

> ID：14270304
> 
> 赞同：0
> 
> 时间：2013-01-11T01:37:38.733
> 
> 标签：qt, qgraphicsview, qgraphicsitem, qgraphicsscene

我目前正在学习 Qt，我希望有 2 个视图和 2 个单独的场景。第二个视图绘制在第一个视图之上，并且只占据了第一个视图的一个角。使用移动鼠标的自定义图形项是否可以在第二个视图上方，同时仍然在第一个视图中。该项目实际上也将大于第二个视图，并且它当前移动到第二个视图后面。

# c# - 反射发射堆栈和方法调用

> ID：14270309
> 
> 赞同：5
> 
> 时间：2013-01-11T01:37:49.563
> 
> 标签：c#, .net, reflection, reflection.emit

有人可以向我解释在通过reflection.emit进行函数调用之前需要将什么加载到堆栈中吗？

我有一个非常简单的方法

```
public static void Execute(string 1, string 2) 
```

我想在下面的类中动态生成方法（忘了剩下的，我把它们整理好了）

```
public class Test{
    public string s1;

    public void Run(string s2)
    {
        MyOtherClass.Execute(s2,s1)
    }
} 
```

我有一份上述测试的副本供参考，我注意到在“调用”之前发出了以下操作码。

1.  ldarg_1
2.  ldarg_0
3.  ldfld

问题是 ldarg_0 在那里做什么？我只需要 2 个调用参数，为什么 CLR 需要将 ldarg_0 推入堆栈？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-11T01:58:22.443

`arg.0`包含`this`并且需要被`ldfld string Test:s1`压入`this.s1`堆栈。

```
.method public hidebysig instance void Run(string s2) cil managed
{
    .maxstack 8                                      // maximum stack size 8
    ldarg.1                                          // push argument s2
    ldarg.0                                          // push this
    ldfld string Test::s1                            // pop this, push this.s1
    call void MyOtherClass::Execute(string, string)  // call
    ret                                              // return
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T01:56:18.983

如果方法不是静态的，则需要按声明和对象引用的顺序推送方法的参数。在您的测试用例中，您正在访问一个成员字段 ( `s1`)，因此您需要`this`它的引用。这就是`ldarg_0`提供的。随后`ldfld`弹出`this`引用并将字段的值推送到评估堆栈上。

# xampp - XAMPP php.ini 显示错误不起作用

> ID：14270310
> 
> 赞同：0
> 
> 时间：2013-01-11T01:37:53.163
> 
> 标签：xampp, php

我想静音我的 XAMPP 错误报告，所以我将`display_error`值从 On 更改为 Off，然后重新启动服务。但是重新启动后，我仍然收到错误消息。我不知道为什么会这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:42:08.373

如果要在脚本上从 PHP 中删除错误，请使用

> 错误报告（0）；

编辑：哦。你想完全禁用它吗？我不会这样做，因为您可能会错过不会导致页面加载的小错误。

# java - CentOS 4 上的 Java 1.6 相当神秘的 SocketException

> ID：14270311
> 
> 赞同：2
> 
> 时间：2013-01-11T01:38:00.780
> 
> 标签：java, networking

我对 JAX-RS Web 服务进行了 JUnit 测试。测试启动嵌入式 tomcat，然后通过 Apache CXF JAX-RS 客户端与其对话。

考虑这个回溯：

```
Caused by: java.net.SocketException: Socket Closed
        at java.net.PlainSocketImpl.getOption(PlainSocketImpl.java:286)
        at java.net.Socket.getSoTimeout(Socket.java:1032)
        at sun.net.www.http.HttpClient.available(HttpClient.java:356)
        at sun.net.www.http.HttpClient.New(HttpClient.java:273)
        at sun.net.www.http.HttpClient.New(HttpClient.java:310)
        at sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:987)
        at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:923)
        at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:841)
        at sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1031) 
```

*这仅*在 CentOS 4.8 上失败。相同的单元测试（启动嵌入式 tomcat，然后与其中的 Web 服务对话）在各种其他系统上运行良好。请注意此回溯的极端奇怪之处：`HttpHRLConnection`已调用`HttpClient`以获取新连接，并且稍后的类显然在返回连接之前关闭了自己的套接字，我的任何代码都可以访问它。

此外，测试中有朋友对相同的服务进行相同的服务器设置，并且可以毫无问题地与之交谈。

更进一步，以下咒语（略微缩写）是一种解决方法：

```
@Before
public void pingServiceToWorkAroundCentos() {
   try {
      /* ... code to make a connection to the service and close it ... */
   } catch (Throwable t) {
      // do nothing
   }
} 
```

换句话说，如果我在运行每个测试用例之前安排一个额外的一次性连接，那么无论这个问题是什么，都会用完。

这可能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T03:15:03.310

由于这里只有一个回溯并且没有代码，我假设存在某种竞争条件或错误，即当前线程试图获取 OutputStream 时，另一个线程先关闭了套接字。

查看 JDK 的源代码，我看到了这个......

```
public Object getOption(int opt) throws SocketException {
    if (isClosedOrPending()) {
        throw new SocketException("Socket Closed");
    }
    ... snip ... 
```

isClosedOrPending 方法检查内部 FD 是否为 null 或关闭是否挂起，即在套接字上调用了关闭。

祝你好运追踪它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T07:10:16.510

没什么神秘的。您已关闭套接字，然后继续使用它。

关闭套接字的输入或输出流会关闭另一个流和套接字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T09:53:13.457

看起来类似于我们遇到的问题，其中 httpclient 池连接的存活时间比 tomcat 中相应的服务器端连接长。基本上，这会导致 httpclient 连接池中的连接过时。当 httpclient 尝试使用这些时，它们基本上会失败。我相信 httpclient 实际上使用标准重试处理程序从中恢复。

解决方案是仔细检查您的超时设置客户端和服务器端以及您的重试策略。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T09:26:49.187

我很确定这是一个 JDK 错误。

HttpClient 在最近的提交中进行了修改：

[http://hg.openjdk.java.net/jdk7u/jdk7u/jdk/diff/e6dc1d9bc70b/src/share/classes/sun/net/www/http/HttpClient.java](http://hg.openjdk.java.net/jdk7u/jdk7u/jdk/diff/e6dc1d9bc70b/src/share/classes/sun/net/www/http/HttpClient.java)

getSoTimeout() 调用需要在 try/catch 块中，不幸的是，目前唯一真正的选择是降级 JDK。

# php - PHP - 我如何才能找到仅提取字符串中的整数，该字符串用两个句点分隔整数？

> ID：14270313
> 
> 赞同：0
> 
> 时间：2013-01-11T01:38:21.127
> 
> 标签：php, string, strip

假设我有一个这样的字符串：

```
$string = '.30..5..12..184..6..18..201..1.' 
```

我将如何提取每个整数，去除句点并将它们存储到数组中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T01:40:54.857

你可以用这个。您将字符串按所有句点分开……但这仅在完全一样的情况下才有效；如果中间还有其他东西，例如 25.sdg.12 它就不起作用。

```
 <?php
    $my_array = explode("..",$string);
    $my_array[0] = trim($my_array[0]); //This removes the period in first part making '.30' into '30'
  ///XXX  $my_array[-1] = trim($my_array[-1]); XXX If your string is always the same format as that you could just use 7 instead. 
```

我检查了 PHP 不支持负索引，但您可以计算数组列表并使用它。前任：

```
$my_index = count($my_array) - 1;
$my_array[$my_index] = trim($my_array[$my_index]); //That should replace '1.' with '1' no matter what format or length your string is.
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T01:47:00.437

我能想到的。

```
<?php
$string = '.30..5..12..184..6..18..201..1.';
$r_string = str_replace("..", ",", $string);
$r_string = str_replace(".", ",", $r_string);
print_r(explode(",", $r_string));
?> 
```

或者如果你想在一个变量中的数组

```
<?php
$string = '.30..5..12..184..6..18..201..1.';
$r_string = str_replace("..", ",", $string);
$r_string = str_replace(".", ",", $r_string);
$arr_ex = explode(",", $r_string);
print_r($arr_ex);
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T01:50:18.990

其他人发布了这个但随后删除了他们的代码，它按预期工作：

```
<?php
$string = '.30..5..12..184..6..18..201..1.';

$numbers = array_filter (explode ('.', $string), 'is_numeric');

print_r ($numbers);
?> 
```

输出：

> ```
> Array (
> [1] => 30
> [3] => 5
> [5] => 12
> [7] => 184
> [9] => 6
> [11] => 18
> [13] => 201
> [15] => 1 ) 
> ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T01:50:30.070

尝试这个 ..

```
$string = '.30..5..12..184..6..18..201..1.';
$new_string =str_replace(".", "",  str_replace("..", ",", $string));
print_r (explode(",",$new_string)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-11T01:51:26.213

一线解决方案：

```
print_r(explode("..",substr($string,1,-1))); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-11T01:43:18.900

这会将您的字符串分解为一个数组，然后循环获取数字。

```
$string = '.30..5..12..184..6..18..201..1.';
$pieces = explode('.', $string);

foreach($pieces as $key=>$val) {
    if( is_numeric($val) ) {
    $numbers[] = $val;
    }
} 
```

您的号码将在数组中`$numbers`

# c# - 如何在运行时调整窗体上所有控件的大小？

> ID：14270314
> 
> 赞同：1
> 
> 时间：2013-01-11T01:38:30.450
> 
> 标签：c#, .net, winforms, resize, controls

我有一个包含 PictureBox 控件网格的 Windows 窗体。我希望能够在运行时调整整个表单的大小，并让所有这些 PictureBox 控件按比例动态调整大小（缩放）以适应表单的新大小。目标是避免仅仅因为我想要不同的大小而必须制作基本上会使用相同 .cs 文件的单独资源文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T02:01:38.947

尝试[`TableLayoutPanel`](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.aspx)在百分比模式下使用所有行和列的控件。

```
new Form {
    Controls = {
        new TableLayoutPanel {
            Dock = DockStyle.Fill,
            ColumnCount = 2,
            Controls = {
                new Button {Text = "0,0", Dock = DockStyle.Fill},
                new Button {Text = "1,0", Dock = DockStyle.Fill},
                new Button {Text = "0,1", Dock = DockStyle.Fill},
                new Button {Text = "1,1", Dock = DockStyle.Fill}
            },
            RowStyles = {
                new RowStyle(SizeType.Percent) {Height = 1},
                new RowStyle(SizeType.Percent) {Height = 1}
            },
            ColumnStyles = {
                new ColumnStyle(SizeType.Percent) {Width = 1},
                new ColumnStyle(SizeType.Percent) {Width = 1}
            }
        }
    }
}.ShowDialog(); 
```

# java - CombineFileInputFormat Hadoop 0.20.205 的实现

> ID：14270317
> 
> 赞同：5
> 
> 时间：2013-01-11T01:38:57.150
> 
> 标签：java, mapreduce, inputformatter

有人可以指出我在哪里可以找到`CombineFileInputFormat`（org. using Hadoop 0.20.205）的实现吗？这是使用 EMR 从非常小的日志文件（行中的文本）创建大的拆分。

令人惊讶的是，Hadoop 没有专门为此目的制作的此类的默认实现，并且谷歌搜索看起来我不是唯一对此感到困惑的人。我需要编译该类并将其捆绑在一个 jar 中用于 hadoop-streaming，对 Java 的了解有限，这是一个挑战。

编辑：我已经尝试过使用必要的导入的 Yetitrails 示例，但是下一个方法出现编译器错误。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-11T18:22:26.310

这是我为您准备的一个实现：

```
import java.io.IOException;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapred.FileSplit;
import org.apache.hadoop.mapred.InputSplit;
import org.apache.hadoop.mapred.JobConf;
import org.apache.hadoop.mapred.LineRecordReader;
import org.apache.hadoop.mapred.RecordReader;
import org.apache.hadoop.mapred.Reporter;
import org.apache.hadoop.mapred.lib.CombineFileInputFormat;
import org.apache.hadoop.mapred.lib.CombineFileRecordReader;
import org.apache.hadoop.mapred.lib.CombineFileSplit;

@SuppressWarnings("deprecation")
public class CombinedInputFormat extends CombineFileInputFormat<LongWritable, Text> {

    @SuppressWarnings({ "unchecked", "rawtypes" })
    @Override
    public RecordReader<LongWritable, Text> getRecordReader(InputSplit split, JobConf conf, Reporter reporter) throws IOException {

        return new CombineFileRecordReader(conf, (CombineFileSplit) split, reporter, (Class) myCombineFileRecordReader.class);
    }

    public static class myCombineFileRecordReader implements RecordReader<LongWritable, Text> {
        private final LineRecordReader linerecord;

        public myCombineFileRecordReader(CombineFileSplit split, Configuration conf, Reporter reporter, Integer index) throws IOException {
            FileSplit filesplit = new FileSplit(split.getPath(index), split.getOffset(index), split.getLength(index), split.getLocations());
            linerecord = new LineRecordReader(conf, filesplit);
        }

        @Override
        public void close() throws IOException {
            linerecord.close();

        }

        @Override
        public LongWritable createKey() {
            // TODO Auto-generated method stub
            return linerecord.createKey();
        }

        @Override
        public Text createValue() {
            // TODO Auto-generated method stub
            return linerecord.createValue();
        }

        @Override
        public long getPos() throws IOException {
            // TODO Auto-generated method stub
            return linerecord.getPos();
        }

        @Override
        public float getProgress() throws IOException {
            // TODO Auto-generated method stub
            return linerecord.getProgress();
        }

        @Override
        public boolean next(LongWritable key, Text value) throws IOException {

            // TODO Auto-generated method stub
            return linerecord.next(key, value);
        }

    }
} 
```

在您的工作中，首先`mapred.max.split.size`根据您希望将输入文件组合成的大小设置参数。在*run()*中执行以下操作：

```
...
            if (argument != null) {
                conf.set("mapred.max.split.size", argument);
            } else {
                conf.set("mapred.max.split.size", "134217728"); // 128 MB
            }
...

            conf.setInputFormat(CombinedInputFormat.class);
... 
```

# php - 是否有可能以某种方式为我的站点获取这个随机生成的密钥并访问 SQL？

> ID：14270318
> 
> 赞同：2
> 
> 时间：2013-01-11T01:39:07.880
> 
> 标签：php, jquery, sql, security, encryption

我有一个 php/js 站点，其中信息被编码并放入数据库。信息的加密密钥是随机生成的，然后在用户通过表单发送帖子后返回给用户。加密密钥根本不存储在我的数据库中。一个单独的、随机生成的 ID 形成并存储在数据库中，用于在解密之前查找项目本身。

我的问题是，是否有可能查看日志并找到可以揭示密钥的信息？我试图使读取任何 SQL 数据成为不可能，而不是拥有代码的人（谁可以用它做任何他想做的事），或者通过暴力攻击（如果有人得到我的 SQL 数据库，这是不可避免的）？

只是为了重复我的步骤：

1.  用户通过 POST 发送信息
2.  php 文件生成随机 ID 和访问密钥。数据使用访问密钥加密，然后以 ID 作为 PRIMARY KEY 放入 php 数据库。
3.  php 文件只回显随机 ID 和访问密钥。
4.  网站使用 jQuery 从密钥和*mysite.com?i=cYFogD3Se8RkLSE1CA* [9 digit A-Ba-b09 = ID][9 digit A-Ba-b09 = key]创建链接

如果有人可以访问可以读取信息的我的服务器，是否有任何可能性？我希望它成为我自己阅读消息的信息。信息必须是可解码的，它不能是单向编码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T03:44:06.630

让我们从一些基本定义开始：

**代码**通过将数据翻译成另一种语言（通常是私有语言）来保护数据。翻译成西班牙语的英语是编码的，但它不是很安全，因为很多人都懂西班牙语。

**Cipher**通过使用密钥对数据进行加扰来保护数据。Julius Caesar 首先记录的字母替换密码就是一个例子。现代技术涉及使用素数对二进制数据进行数学处理。最好的技术使用非对称密钥；用于加密数据的密钥无法解密，需要不同的密钥。这允许公开密钥并且是 SSL 浏览器通信的基础。

**加密通过***编码*和/或*加密*数据来保护数据。

所有这些术语通常可以互换使用，但它们是不同的，而且这些差异有时很重要。您要做的是通过密码保护数据。

如果数据是“清晰的”，那么如果它被截获，它就会丢失。如果它被加密，那么数据和密钥都需要被截获。如果它被加密和编码，那么需要截取数据、密钥和代码。

您的数据在哪里易受攻击？

1.  任何数据最容易受到攻击的地方是当它明确属于某人的个人财产、存储设备（USB、CD、一张纸）或在他们的头脑中时，因为该人很容易受到诱导或胁迫。这是 Wikileaks 的基础——信任信息的人被诱使背叛了这种信任——我把这个道德问题留给你个人的良心。
2.  当它在客户端和服务器之间传输时，反之亦然。除了具有国家安全重要性的数据外，SSL 加密方法应该是足够的。
3.  当它在程序的内存中时。程序的源代码是存储密钥的最佳位置，但是，它们本身需要使用您在每次程序运行时输入的密码（最好）加密存储，该密码是在您编译和发布时输入的，或者是嵌入到您的代码中（最差）。除非您有充分的理由，否则一把钥匙就足够了；不是每个用户一个。您还应该对内存中的数据进行加密，除非您确实需要它，并且您应该立即使用任何内存中的明文数据结构，并在完成后立即销毁它们。密钥必须存储在某个地方，否则数据将无法恢复。但是考虑一下，谁可以访问源代码（包括备份和替代版本）以及如何检查后门或木马？
4.  当它在程序的机器和数据存储之间传输时。如果您只在程序和数据存储之间发送加密数据并且不将密钥存储在数据存储中，这应该没问题。
5.  当它存储在数据存储中时。同上。

不要忽视物理安全，窃取数据的最简单方法通常是走到服务器并复制硬盘驱动器。许多公司（以及令人遗憾的国防/安全部队）花费数百万用于在线数据安全，然后将他们的数据放在一个*没有*锁的房间里。他们还有一个 10 岁的孩子可以绕过的访问协议。

您现在拥有了可爱的加密数据——您将如何阻止您的程序将其以明文形式提供给任何需要它的人？

这给我们带来了识别、验证和授权。更多定义：

**识别**一个人声称他们是某某。这通常由用户名在计算机程序中处理。在物理安全应用程序中，它是由一个人展示自己并说“我是某某”；这可以通过口头声明或出示护照等身份证件明确表示，也可以通过您认识的警卫默示承认您。

**验证**这是一个人是他们所说的人的证明。在计算机中，这是密码的作用；更准确地说，这证明他们知道他们所说的那个人的密码，这是整个事情中的大问题。在物理安全方面，它是通过将可信文件（如护照）中记录的物理指标（外观、身高等）与声明进行比较；您需要制定协议以确保您可以信任该文档。顺便说一句，这是面部识别技术在识别坏人时出现问题的主要原因——它使用验证技术来尝试识别某人。“这家伙看起来像坏家伙 #1”；你猜怎么着？70亿人口中的很多人也是如此。

**授权**一旦一个人被识别和验证，他们就会被授权做某些事情并去某些地方。为此，他们可能会获得临时身份证明文件；想想访客 ID 徽章或 cookie。根据他们去哪里，他们可能需要重新识别和重新验证自己；想想银行的网站；您识别并验证自己以查看您的银行帐户，然后再次进行转账或付款。

总的来说，这是任何计算机安全系统中最薄弱的部分。我要窃取你的数据很难，我要窃取你的身份并将数据提供给我要容易得多。

在你的情况下，这可能不是你关心的问题，只要你做了正常的事情，允许用户以正常的商业方式设置、更改和检索他们的密码，你可能已经做了所有你能做的。

请记住，数据安全性是一方面的安全性与另一方面的信任和可用性之间的权衡。把事情弄得太难（比如低价值数据的高复杂性密码），你会危及整个系统（因为人就是人，他们会把它们*写下来*）。

就像计算机中的一切一样——用户是个问题！

**你为什么要保护这些数据，你愿意为此付出什么？**

这是一个经典的风险管理问题。实际上，您需要考虑丢失此数据的不利后果、在您当前的保护措施下发生这种情况的风险以及降低额外保护措施所花费的风险是否值得。

丢失数据可能意味着以下任何或全部：

1.  公之于众
2.  如果落入错误的人之手
3.  被恶意或意外破坏。（备份，人们！）
4.  让它改变。如果您知道它已更改，则等于丢失它；如果你不这样做，这可能会更糟，因为你可能会根据虚假数据采取行动。

这种思维导致国防和政府中的数据分为绝密、机密、受限和非受限（澳大利亚分类）。人的因素在这里再次介入；由于官僚主义的性质，没有动机对文件进行低分类和大量抑制；所以文件经常被过度分类。这意味着，由于许多具有受限分类的文档需要分发给没有适当许可的人，只是为了使该死的东西工作，这就是发生的事情。

您也可以将其视为层次结构；我个人的想法是：

1.  **无论你在想什么级别，**保卫领域妥协都会对我的国家/公司/家庭的战略生存产生严重的不利影响。****
***   **生死**妥协会使某人的生命或健康处于危险之中。*   **财务**妥协将使某人的钱/汽车/船/航天飞机被盗。*   **商业**妥协将导致未来财务收益的损失。*   **羞辱性**妥协会造成尴尬。当然，如果你是一名政治家，这可能是第一名。*   **个人**这些是您宁愿不发布但不会特别惊天动地的细节。我会把我的个人病史放在这里，但是，违反隐私法的影响可能会将其推向羞辱（如果人们发现）或财务（如果你被起诉或起诉）。*   **私人**这不是别人的事，但如果他们发现了，实际上并不会伤害你。*   **公开**将其打印在纸上，以供任何人关心。**

 **无论级别如何，您都不希望任何此类数据丢失或更改，但如果是，您需要知道这已经发生。对于纳粹来说，破解他们的 Enigma 密码是很糟糕的。不知道它已经发生是灾难性的。

在下面的评论中，我被要求描述最佳实践。如果不知道数据的风险（以及组织的风险承受能力），这是不可能的。在数据安全上花费过多与花费过少一样糟糕。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T04:06:37.747

我喜欢包含解密密钥的 URL 系统，因此即使您没有仅在用户计算机上可用的数据，也无法访问。

我仍然看到一些问题。

1.  URL 通常保存在 Web 服务器日志中。如果你登录到磁盘，他们得到了磁盘，然后他们得到了密钥。

2.  如果攻击者可以访问您的数据库，他可能对您的系统有足够的访问权限，可以秘密安装记录 URL 的软件。他甚至可以做一些平淡无奇的事情，比如重新登录。

3.  访问您网站的人至少会将 URL 加入书签（否则对他来说毫无用处），并且它很可能会出现在他的浏览器历史记录中。通常，书签和历史记录不被视为安全数据。因此，对用户计算机的攻击者（通过直接坐下或计算机受到恶意软件的攻击）也可以访问数据。如果有效负载足够令人满意，那么有人可能会创建专门挖掘您的静态身份验证令牌的病毒或恶意软件，并且可以达到合理的命中率。这些 URL 可用于浏览器插件，甚至可用于以“立即导入您的书签”的看似合理的幌子运行的其他应用程序。

所以在我看来，最好的安全措施是让客户不仅拥有书签（虽然它是信息，但它不会保存在任何人的脑海中，因此可以被认为是“他拥有的东西”），而且对他来说也是也必须展示“他知道的东西”。所以也用他的密码加密，不要保存密码。当他提供 URL 时，要求输入密码，然后用两者（串行或组合）解密，数据是安全的。

最后，我知道第三方可以使用 Google 的双因素身份验证（例如，我将它与 Dropbox 一起使用）。这通过要求访问资源的人拥有他的手机或什么都没有，从而创建了另一个“你拥有的东西”。是的，如果您丢失了手机，有追索权，但它通常涉及另一个电话号码，或已打印出来并存放在钱包中的特殊 Google 提供的一次性长密码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T05:24:24.123

**首先也是最重要的是，您需要一个非常好的、无懈可击的法律免责声明。**

**其次，根本不存储用户的数据。**

相反，当用户提交数据（使用 SSL）时，生成 SessionID 和系统日期时间的哈希值。将此哈希与日期时间一起存储在您的表中并获取记录 ID。使用此哈希加密用户的数据，并生成一个带有记录 ID 和其中数据的 URL，并将其发送回用户（再次使用 SSL）。此 URL 的安全性现在是用户的问题，您不再有他们发送的任何记录（确保它没有被记录）。

通常，从数据库中删除过时的（4 小时、24 小时？）记录。

当检索请求进入时（使用 SSL）查找哈希，如果不存在，则告诉用户 URL 已过时。如果是，请解密他们发送的数据并将其发回（使用 SSL）并从数据库中删除记录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T02:16:18.020

让我们稍微想想

1.  使用 SSL - 数据已加密
2.  使用用户名/密码进行授权

如果有人打破了它 - 你确实有安全问题

花精力解决这个问题。在这种情况下，灾难恢复是浪费精力。只需正确设置基本案例即可。**

# regex - 替换 IP 地址后文本文件中的所有内容

> ID：14270319
> 
> 赞同：1
> 
> 时间：2013-01-11T01:39:16.293
> 
> 标签：regex, notepad++

我有一个文本文件，其中有类似的内容-

```
10.2.57.44      56538154    3028
120.149.20.197  28909678    3166
10.90.158.161   869126135   6025 
```

在那个文本文件中，我有大约 400,000 行，与上面完全相同。我在 Notepad++ 中打开了相同的文本文件。我需要一种方法来从该文本文件中删除所有内容，只留下 IP 地址（上述文本文件中的第一列是 IP 地址）。我想，我可以使用正则表达式来做到这一点。notepad++ 也可以选择使用正则表达式。但不确定我需要使用什么正则表达式。有谁可以帮我离开这里吗？

所以输出应该是这样的 -

```
10.2.57.44
120.149.20.197
10.90.158.161 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T01:43:53.903

寻找：

```
(\d+\.\d+\.\d+\.\d+).* 
```

并替换为：

```
\1 
```

括号会将正则表达式的那部分捕获到一个变量中，该变量被命名`\1`（因为它是正则表达式中的第一个捕获块）。该行的其余部分不会被捕获，而是被替换操作简单地丢弃。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T01:45:34.340

什么都不换`\s.*`！正则表达式只需要匹配它需要匹配的内容，而您要在此处匹配的内容是一个空格，后跟任何内容（因此不理会 IP 地址，因为它开始该行并且其中没有空格）

或者，如果你有它们，最好使用经典的 Unix 命令来完成：

```
sed -i 's/\s.*//' thefile 
```

例子：

```
$ cat <<EOF | sed 's/\s.*//'
> 10.2.57.44      56538154    3028
> 120.149.20.197  28909678    3166
> 10.90.158.161   869126135   6025
> EOF
10.2.57.44
120.149.20.197
10.90.158.161
$ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T01:56:48.457

如果你有 gawk 什么的：

```
gawk "{print $1}" filename 
```

在 linux(bash) 中的用法`awk`如下所示：

```
suku@ubuntu-vm:~$ cat stack 
10.2.57.44      56538154    3028
120.149.20.197  28909678    3166
10.90.158.161   869126135   6025
suku@ubuntu-vm:~$ cat stack | awk '{ print $1 }'
10.2.57.44
120.149.20.197
10.90.158.161 
```

# c# - 如何从文本框中删除css？

> ID：14270320
> 
> 赞同：2
> 
> 时间：2013-01-11T01:39:30.953
> 
> 标签：c#, asp.net, css, stylesheet

这个问题可能听起来很愚蠢......但我有一个在文本框上应用 css 的代码。现在我希望它在另一个条件下再次设置为默认值。

或者准确地说，我想将我的文本框发送到它的默认样式。

在互联网和stackoverflow上搜索我找到了这些答案 -

[默认文本框边框样式和宽度](https://stackoverflow.com/questions/1232188/default-textbox-border-style-and-width)

有什么帮助吗？

编辑 ：

```
 if (condition)
        {
            txtLastName.CssClass="ControlBackground_Yellow"; 
        }
    else
        {               
            txtLastName.CssClass="ControlBackground_White"; 
        } 
```

CSS是——

```
ControlBackground_Yellow    
{
    background-color:#FFFF00;
}

ControlBackground_White     
{
    background-color:#FFFFFF;
} 
```

PS：**抱歉不允许使用 jQuery**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T01:55:53.933

您可以根据特定条件使用 jQuery 从控件中删除 css 类：

```
 var $arrow = jQuery('<div class="arrow"></div>');

 $arrow.removeClass(); 
```

您可以再次添加类：

```
 $arrow.addClass('className'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:07:35.453

我刚刚删除了这一行

```
 background-color:#FFFFFF; 
```

从我的CSS。

```
 ControlBackground_Yellow    
{
    background-color:#FFFF00;
}

ControlBackground_White     
{
    background-color:#FFFFFF;
} 
```

谢谢你们的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T01:57:58.400

根据您的实施，您可以：

使用 jQuery 删除/添加文本框上的类：

```
 $('input[type=text].yourClass#yourId)).removeClass('class_to_remove');
  $('input[type=text].yourClass#yourId)).removeClass('class_to_add'); 
```

或者使用jQuery直接设置css值：

```
 $('input[type=text].yourClass#yourId)).css('display', 'block');
  $('input[type=text].yourClass#yourId)).css('border-color', 'red'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-03T12:00:14.503

也可以从后面的代码中尝试这一行：

```
textBox.Attributes.Remove("class"); 
```

单词“class”指向当前应用于textBox的类，不需要替换这个文本。希望能帮助到你。

# java - Arrays.fill() 只允许在方法中使用？

> ID：14270321
> 
> 赞同：2
> 
> 时间：2013-01-11T01:40:13.107
> 
> 标签：java, arrays

我正在使用一本书自学Java。我的一个练习需要一个带有布尔值的数组。当我尝试`Arrays.fill(myArray, false)`如下所示使用时，出现编译器错误。加上IDE抱怨。

```
...\ArrayFill.java:6: <identifier> expected
...\ArrayFill.java:6: <identifier> expected
...\ArrayFill.java:6: illegal start of type 
```

这是代码：

```
import java.util.Arrays;

public class ArrayFill {

boolean[] myArray = new boolean[4];   // Declaration OK.
Arrays.fill( myArray, false);         // Not OK.

//    boolean[] myArray = {false, false, false, false }; // Manually OK.

public void makeReservation(){
    Arrays.fill(myArray, false);      // In a method, OK.
}

} 
```

似乎它与`Arrays.fill`静态方法的事实有关，但我找不到答案。我接近了吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-11T01:41:43.173

您不能在方法主体之外运行任意语句。

您需要将代码放入构造函数、初始化程序块或 main 方法中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T01:54:07.463

唯一可以直接在类中的代码是声明和静态初始化器。请注意，这`Arrays.fill(myArray, false);`两者都不是，因此它必须位于另一个代码块中，特别是构造函数、方法或静态初始化程序。

# mysql - 多行的 MySQL linux 服务器和 my.cnf 优化

> ID：14270322
> 
> 赞同：-1
> 
> 时间：2013-01-11T01:40:17.653
> 
> 标签：mysql, linux, ubuntu, ubuntu-12.10

如何优化 linux MySQL 服务器以更快地查询具有多行（最多 10 亿行）的表。

服务器仅用于开发，因此安全性、可用性或恢复不是问题。

这是一个例子：

```
ALTER TABLE link ADD UNIQUE KEY url_index(url(255)) 
```

*   持续时间>6h
*   链接数（~ 2000 万）
*   CPU 使用率低 (~19%)
*   高 IO（iotop mysql 主要返回 600 KB/s 读取和 500 KB/s 写入，99% IO 一些峰值达到 2-3 MB/s）

链接表：

```
CREATE TABLE `links` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `url` varchar(2000) NOT NULL,
  `domain` varchar(255) DEFAULT NULL  
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=27765646 DEFAULT CHARSET=utf8; 
```

我有一个专用的 linux 服务器（ubuntu 12.10）

*   6 GB 内存
*   1 TB 硬盘（非 SSD）

[my.cnf](http://pastebin.com/vx6BNqrE) (http://pastebin.com/vx6BNqrE)

我可以在软件方面优化什么（查询/表设计和 my.cnf 或其他服务器配置）以及在 RAM 以外的硬件方面应该首先升级什么（不幸的是 RAM 不可升级，因为只有 3 个 RAM 插槽可用）。

更新

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:55:54.680

您需要开始扩展，而不是四处进行可能会在一小时内为您带来更多交易的微优化。

首先，获得SSD。如果您需要更多空间，请对它们进行 RAID。如果您真的关心性能，SSD 是巨大的，尤其是在查看您的 IO 时。

其次，一台服务器只能走这么远。您需要开始设置将减轻一些负载的从站，它们还可以作为一个漂亮的故障转移。

MySQL 并不是真正为按需模式更改而设计的，所以 alter table 很难回答；实际上，我会停止服务以防止锁定，运行更改表，然后将其与错过的内容同步，并与其他服务器一起跟进。你真的应该只选择一个模式并坚持下去。

祝你好运！

# sql - 访问 VBA - 识别文本

> ID：14270325
> 
> 赞同：0
> 
> 时间：2013-01-11T01:40:41.103
> 
> 标签：sql, string, ms-access, vba

我试图创建一个按钮来删除子表单中的某些记录。但是我在查询表达式'KEY_ID =“1'中得到“语法错误（缺少运算符）。

我知道问题是什么：属性是文本，因此值需要用单引号括起来。我只是不知道如何编写 VBA 来实现这一点。

```
Private Sub cmdDelete_Click()
If Not (Me.subKey.Form.Recordset.EOF And Me.subKey.Form.Recordset.BOF) Then
    If MsgBox("Confirm Deletion?", vbYesNo) = vbYes Then
        Dim strSql As String
        strSql = "DELETE FROM KEYS" & _
            " WHERE KEY_ID='" & Me.subKey.Form.Recordset.Fields("KEY_ID")
        Debug.Print strSql ' <- prints to Immediate window
        CurrentDb.Execute strSql, dbFailOnError

    End If
End If 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:49:49.417

```
strSql = "DELETE FROM KEYS" & _
    " WHERE KEY_ID='" & Me.subKey.Form.Recordset.Fields("KEY_ID") & "'" 
```

...不过，请注意，当这类事情变得更加密集时，将引号用作 ASCII 字符会更安全，或者至少更通用或可移植。

```
strSql = "DELETE FROM KEYS" & _
    " WHERE KEY_ID=" & _
    Chr(32) & Me.subKey.Form.Recordset.Fields("KEY_ID") & Chr(32) 
```

我不确定这是不是，`Chr(32)`但我认为这是正确的。

# php - CodeIgniter 将数据传递给视图

> ID：14270330
> 
> 赞同：1
> 
> 时间：2013-01-11T01:41:30.937
> 
> 标签：php, codeigniter

我试图从我的控制器传递到视图，就像这样......

```
public function playerslist()
    {
        $this->load->database();
        $data = $this->db->get('skaters');
        $this->load->helper('url');
        $this->load->view('playerslist', $data);
    } 
```

在我看来……

```
<?php echo $data; ?> 
```

但我得到这个**错误......**

> 遇到 PHP 错误
> 
> 严重性：通知
> 
> 消息：未定义变量：数据
> 
> 文件名：views/playerslist.php
> 
> 行号：76

我究竟做错了什么？

我想用这些数据做的是放在一个 foreach 语句中并显示 $data 数组中的所有内容

```
foreach($data as $value => $key){
echo $key . "<br/>";
} 
```

谢谢，J

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T01:44:37.417

您无法`$data`直接从您的视图中访问。你传递给你的`$data`视图必须是一个关联数组。然后这些键将在您的视图中转换为变量。

例如：

```
$data = array(
    'name' => 'John',
    'bars' => 23
);

$this->load->view('playerslist', $data); 
```

然后，在您看来，这些将被转换为变量：

```
<?php echo $name; ?> has <?php echo $bars; ?> bars of chocolate. 
```

* * *

如果要以原始格式访问数据，请将其传递*到*关联数组中：

```
$data = $this->db->get('skaters')->result();
$this->load->view( 'playerslist', array('data' => $data) ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T02:09:59.347

根据您的问题和示例代码，我得出结论，您希望从表“滑板”中检索数据并将其显示在视图中。

```
$this-> db-> get ('skaters'); //not return result object or array 
```

您需要更改代码

```
$ this-> db-> get ('skaters') -> result (); // return object 
```

或者

```
$ this-> db-> get ('skaters) -> result_array (); //return array 
```

检查此链接[http://ellislab.com/codeigniter/user-guide/database/results.html](http://ellislab.com/codeigniter/user-guide/database/results.html)

数据通过视图加载函数的第二个参数中的数组或对象从控制器传递到视图。然后codeigniter将使用'extract'函数[http://php.net/manual/en/function.extract.php提取第二个参数](http://php.net/manual/en/function.extract.php)

```
public function playerslist ()
     {
         $ this-> load-> database ();
         $ data = $ this-> db-> get ('skaters') -> result ();
         $ this-> load-> helper ('url');
         $ this-> load-> view ('playerslist', array ('data' => $ data));
     } 
```

# redirect - 在 IIS7 中重写地图 - 不重定向

> ID：14270332
> 
> 赞同：4
> 
> 时间：2013-01-11T01:41:49.020
> 
> 标签：redirect, iis-7, url-rewrite-module

我正在尝试使用一个名为“rewritemaps.config”的单独配置文件，其中包含我要重定向的 URL。该文件位于根目录中（与 web.config 相同的位置）。我拥有的 Redirects.config 文件的格式是：

```
<rewriteMaps>
    <rewriteMap name="Redirects">
        <add key="aspx/drvmain.aspx"
             value="http://www.newdomain.com/folder2/page2.aspx" />
        <add key="aspx/jobs_AboutUs.aspx"
             value="http://www.newdomain.com/folder1/jobs.aspx" />
        <add key="aspx/page.aspx"
             value="http://www.newdomain.com/folder1/page2.aspx" />
    </rewriteMap>
</rewriteMaps> 
```

在我的 web.config 文件中，我有：

```
<system.webServer>
    <rewrite>
        <rewriteMaps configSource="rewritemaps.config" />
            <rules>
                <rule name="Redirect rules">
                    <match url=".*" />
                    <conditions>
                        <add input="{Redirects:{REQUEST_URI}}" pattern="(.+)" />
                    </conditions>
                    <action type="Redirect" redirectType="Permanent"
                            url="{C:1}" appendQueryString="false" />
                </rule>
            </rules>
        </rewriteMaps>
    </rewrite>
</system.webServer> 
```

在 IIS 管理器中（是的，我已经安装了 URL 重写模块），我什至已经针对我在 redirects.config 文件中的一个 URL 测试了规则和条件，它说它有效。但是当我尝试在浏览器中访问 URL 时，它并没有按照我指定的那样重定向。在 rewritemaps.config 文件中，我尝试放置完整的域，并尝试在 aspx 之前使用“/”。似乎没有任何效果。我不确定我在这里缺少什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T18:22:50.350

好吧，我让它工作了。有什么愚蠢的。在 rewritemaps.config 文件中，我需要在密钥 URL 之前使用“/”。我知道我以前曾尝试过，但当时我一定是在其他地方遗漏了一些东西。那好吧。现在可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:03:10.840

确实很难确定失败的原因，但您可以做的最好的事情是使用失败的请求跟踪，以便 IIS 告诉您正在发生的事情。使用 FREB，您将获得详细的跟踪信息，告诉您评估了哪些规则以及它们是否匹配以及为什么不匹配。您还可以查看要匹配的“正确”模式以及评估的每个条件。

请参阅以下链接： [http ://www.iis.net/learn/extensions/url-rewrite-module/using-failed-request-tracing-to-trace-rewrite-rules](http://www.iis.net/learn/extensions/url-rewrite-module/using-failed-request-tracing-to-trace-rewrite-rules)

# asynchronous - Mule ESB 3.3 如何同时启动事务流

> ID：14270334
> 
> 赞同：3
> 
> 时间：2013-01-11T01:41:52.970
> 
> 标签：asynchronous, transactions, esb, mule

我想同时处理一组消息，但除非我将虚拟机设置为请求-响应，否则我无法使它们成为事务性的……在这种情况下，处理不是并发的。

[Mule 文档](http://www.mulesoft.org/documentation/display/MULE3USER/Transaction+Management)指出“Mule 事务是在同步端点上配置的”，但我不太了解这个限制。
很明显，在您希望成为事务性的流中，不应产生异步流，但（对我而言）不清楚为什么不能（从非 tx 主流）启动任意数量的异步流交易性的。

换句话说，为什么这可以正常工作：

![在此处输入图像描述](../Images/cd777b65578714039a386e53c009564b.png)

但是如果我将虚拟机更改为“单向”，它会失败：

```
org.mule.transaction.IllegalTransactionStateException: Can only bind "javax.sql.DataSource/java.sql.Connection" type resources 
```

**有没有解决的办法？**

流的 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<mule>
    <spring:beans>
        <spring:bean id="dataSource" name="dataSource" class="org.enhydra.jdbc.standard.StandardDataSource" destroy-method="shutdown">
            <spring:property name="driverName" value="org.h2.Driver" />
            <spring:property name="url" value="jdbc:h2:tcp://localhost/~/mule" />
            <spring:property name="user" value="sa" />
            <spring:property name="password">
                <spring:value></spring:value>
            </spring:property>
        </spring:bean>

        <spring:bean id="transactionFactory" name="transactionFactory" class="org.mule.transport.jdbc.JdbcTransactionFactory" />

    </spring:beans>

    <jdbc:connector name="dbConnector" dataSource-ref="dataSource" validateConnections="true" queryTimeout="-1" pollingFrequency="0" doc:name="Database" />

    <flow name="triggerFlow" doc:name="triggerFlow">
        <http:inbound-endpoint exchange-pattern="request-response" host="localhost" port="8081" doc:name="HTTP" />
        <set-payload value="#[[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]]" doc:name="[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]"/>
        <collection-splitter doc:name="Collection Splitter"/>
        <vm:outbound-endpoint exchange-pattern="request-response" path="flow" doc:name="flow" />
    </flow>

    <flow name="flow" doc:name="flow">
        <vm:inbound-endpoint exchange-pattern="request-response" path="flow" doc:name="flow">
            <custom-transaction factory-ref="transactionFactory" action="ALWAYS_BEGIN" timeout="10" />
        </vm:inbound-endpoint>
        <logger message="#[payload]" level="INFO" doc:name="Logger"/>
        <jdbc:outbound-endpoint exchange-pattern="request-response" queryKey="insert" queryTimeout="-1" connector-ref="dbConnector" doc:name="Insert 1">
            <jdbc:transaction action="ALWAYS_JOIN" />
            <jdbc:query key="insert" value="insert into test values (#[payload], 'Test 1')" />
        </jdbc:outbound-endpoint>
        <jdbc:outbound-endpoint exchange-pattern="request-response" queryKey="insert2" queryTimeout="-1" connector-ref="dbConnector" doc:name="Insert 2">
            <jdbc:transaction action="ALWAYS_JOIN" />
            <jdbc:query key="insert2" value="insert into test values (#[payload + 10], 'Test 2')" />
        </jdbc:outbound-endpoint>
    </flow>

</mule> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T01:47:06.723

> Mule 文档指出“Mule 事务是在同步端点上配置的”，但我不太了解这个限制。

这种限制是因为在 Mule 中和 Spring 中一样，更一般地在 Java 中，事务是线程绑定的。使用异步流，涉及多个线程，因此无法维护事务-线程关联。

所以不，您不能拆分/分叉/并行化/异步处理消息，并且在 Mule 中也有事务。

> org.mule.transaction.IllegalTransactionStateException: 只能绑定“javax.sql.DataSource/java.sql.Connection”类型的资源

但这与第一个问题 IMO 无关：这是因为您通过 a 强制`custom-transaction`尝试在 JDBC 事务中注册 VM 端点。这是行不通的。如果要注册异构资源，请使用 XA 事务。

编辑：根据您在评论中所说，您不想在事务中注册 VM 端点，因此只需在此处注册 JDBC 端点：

```
<transactional action="ALWAYS_BEGIN">
    <jdbc:outbound-endpoint exchange-pattern="request-response"
        queryKey="insert" queryTimeout="-1" connector-ref="dbConnector"
        doc:name="insert into test values (1, 'Test 1')">
        <jdbc:transaction action="ALWAYS_JOIN" />
        <jdbc:query key="insert"
            value="insert into test values (1, 'Test 1')" />
    </jdbc:outbound-endpoint>
    <jdbc:outbound-endpoint exchange-pattern="request-response"
        queryKey="insert2" queryTimeout="-1" connector-ref="dbConnector"
        doc:name="insert into test values (2, 'Test 2')">
        <jdbc:transaction action="ALWAYS_JOIN" />
        <jdbc:query key="insert2"
            value="insert into test values (2, 'Test 2')" />
    </jdbc:outbound-endpoint>
</transactional> 
```

这适用于`one-way`入站端点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:07:02.547

我设法使它工作。我必须添加一个中间异步流来调用同步/发送流：

![在此处输入图像描述](../Images/01b47206233f9c77986fad04b7b767d7.png)

我认为这是丑陋和不必要的，将它作为原始帖子调用它是完全可以的，但由于我无法理解的原因，Mule 让你为此跳过箍。

以下是流的 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
    <mule>
    <spring:beans>
        <spring:bean id="dataSource" name="dataSource" class="org.enhydra.jdbc.standard.StandardDataSource" destroy-method="shutdown">
            <spring:property name="driverName" value="org.h2.Driver" />
            <spring:property name="url" value="jdbc:h2:tcp://localhost/~/mule" />
            <spring:property name="user" value="sa" />
            <spring:property name="password">
                <spring:value></spring:value>
            </spring:property>
        </spring:bean>

        <spring:bean id="transactionFactory" name="transactionFactory" class="org.mule.transport.jdbc.JdbcTransactionFactory" />

    </spring:beans>

    <jdbc:connector name="dbConnector" dataSource-ref="dataSource" validateConnections="true" queryTimeout="-1" pollingFrequency="0" doc:name="Database" />

    <flow name="triggerFlow" doc:name="triggerFlow">
        <http:inbound-endpoint exchange-pattern="request-response" host="localhost" port="8081" doc:name="HTTP" />
        <set-payload value="#[[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]]" doc:name="[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]"/>
        <collection-splitter doc:name="Collection Splitter"/>
        <vm:outbound-endpoint exchange-pattern="one-way" path="async" doc:name="async" />
    </flow>
    <flow name="simpletransactionFlow1" doc:name="simpletransactionFlow1">
        <vm:inbound-endpoint exchange-pattern="one-way" path="async" doc:name="async"/>
        <vm:outbound-endpoint exchange-pattern="request-response" path="flow" doc:name="flow"/>
    </flow>

    <flow name="flow" doc:name="flow">
        <vm:inbound-endpoint exchange-pattern="request-response" path="flow" doc:name="flow">
            <custom-transaction factory-ref="transactionFactory" action="ALWAYS_BEGIN" timeout="10" />
        </vm:inbound-endpoint>
        <logger message="#[groovy:Thread.currentThread().getName()], payload=#[payload]" level="INFO" doc:name="Logger"/>
        <jdbc:outbound-endpoint exchange-pattern="request-response" queryKey="insert" queryTimeout="-1" connector-ref="dbConnector" doc:name="Insert 1">
            <jdbc:transaction action="ALWAYS_JOIN" />
            <jdbc:query key="insert" value="insert into test values (#[payload], 'Test 1')" />
        </jdbc:outbound-endpoint>
        <jdbc:outbound-endpoint exchange-pattern="request-response" queryKey="insert2" queryTimeout="-1" connector-ref="dbConnector" doc:name="Insert 2">
            <jdbc:transaction action="ALWAYS_JOIN" />
            <jdbc:query key="insert2" value="insert into test values (#[payload + 10], 'Test 2')" />
        </jdbc:outbound-endpoint>
    </flow>

</mule> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-23T09:44:40.930

这在[Mule 文档](http://www.mulesoft.org/documentation/display/current/Reliability+Patterns)中进行了讨论。它可能需要稍微麻烦一点，但还不错，实际上只需要一个 VM 传输，而不是两个：

![在此处输入图像描述](../Images/c56b88ebb0c8c362358464481ae58dcb.png)

我更改它是因为我想使用 TCP 而不是 HTTP，但它基本上是相同的示例。

第一个流接收未处理的 TCP，用它做一些事情（这里只是一个字节数组到字符串，但可能你有验证或其他东西），将输入推送到 VM 连接器，然后将输入回显到 TCP 流。在 VM 连接器保证它可以释放它的消息的 TCP 源之后返回，如果它正在做一些低级别的保证传递。

VM 连接器是单向的，并且有一个连接到它的持久存储，因此它不会丢失消息。这在 Mule Studio 3.5 中显示了一个错误，但它工作正常。

然后中间流接管，并包含一个事务，因此除非业务逻辑子流成功完成，否则 VM 连接器不会释放消息。

最后子流程运行；目前只是 Thread.sleep()ing 5 秒钟，所以我可以看到它一切正常。Telnet 进入会立即回显到 Telnet 控制台，然后在五秒钟后再次回显。

希望有帮助！我只花了几个小时和骡子在一起，但这似乎是正确的。

# javascript - 带有 $ 的 Grunt lint 错误

> ID：14270346
> 
> 赞同：2
> 
> 时间：2013-01-11T01:42:47.273
> 
> 标签：javascript, jslint, gruntjs

我正在尝试将 lint 与 Grunt 一起使用。我可以从命令行运行 Grunt，但它给了我很多错误。大多数情况下“' `$`'未定义”。甚至`alert`抛出错误，“'alert'未定义”。

我怎样才能绕过那些？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-11T07:41:08.507

你需要告诉 JSHint（这是 Grunt 默认使用的 linter）关于被 linted 文件可用的全局变量。我假设您在页面上包含 jQuery，因此`$`标识符（当然可以是各种其他库）。

您可以在每个文件中或在 Grunt 脚本中指定全局变量。要在文件中指定它们，您可以使用`global`指令。把它放在文件的顶部，或者在你使用全局的函数的顶部：

```
/*global $:false */ 
```

请注意，这`false`意味着如果您覆盖`$`. 如果您需要这样做的能力，请将其更改为`true`.

如果您希望在 Grunt 脚本中指定全局变量，您可以为您的部分`globals`中的任何任务添加一个属性。`jshint`例如：

```
grunt.initConfig({
    jshint: {
        someTask: {
            globals: {
                $: false
            }
        }
    }
}); 
```

至于`alert`您收到的消息，您需要告诉 JSHint 您允许使用开发功能，例如`alert`和`console.log`。为此，您可以`jshint`在文件中使用指令（就像`global`指令一样）：

```
/*jshint devel:true */ 
```

或者你可以`options`在 Grunt 脚本中为任务添加一个属性：

```
someTask: {
    globals: {
        $: false
    },
    options: {
        devel: true
    }
} 
```

有关您可用的所有选项，请参阅[JSHint 文档](http://jshint.com/docs/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-18T17:48:13.150

`globals`必须在里面`options`

```
someTask: {
    options: {
        devel: true,
        globals: {
            $: false
        }
    }
} 
```

# php - 从表格单元格中获取已编辑的单元格值

> ID：14270362
> 
> 赞同：0
> 
> 时间：2013-01-11T01:44:37.927
> 
> 标签：php, javascript, jquery, ajax, database

我在 html 页面上使用 php 显示表格。我想编辑单元格内容（基本上是对值进行更改，并进行 ajax 调用以更新数据库）。我的要求是使用 onblur 功能（我也可以使用 onkeypress 来解决）。谁能告诉我用单元格ID输入新值的最简单方法是什么？

x 的警报告诉我它的“对象 HTMLTableCellElement”

谢谢！！！

```
foreach($_RESPONSE['VENDOR_LIST'] as $r){
     echo  "<tr><td>".$r['fdEmail']."</td><td id='companyname_".$r['fdId']."' contenteditable='true' onblur='updateValue(id)';>".$r['fdCompanyName']." ".$r['fdId']."</td></tr>";
} 
```

Javascript 方法

```
function updateValue(thisdata){
        alert(""+thisdata);
    var x=document.getElementById(""+thisdata);
    if(x){
        alert(x);
        //var r = x.value;
    }
    else
            alert("not found");

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:50:48.273

表格单元格的“值”实际上并不被 javascript 视为值，它只是 HTML。尝试警报`x.innerText`。有关按 ID 获取单元格内容的信息，请参阅[此问题。](https://stackoverflow.com/questions/4253558/how-to-get-the-html-table-particullar-cell-value-using-javascript)

另外，我知道每个人都讨厌听到这个，但是使用[jQuery](http://jquery.com/)会更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T01:53:00.423

在您的 HTML 中，将**updateValue(id)**更改为**updateValue(this.id)**；

然后将其放在 updateValue 函数中的第一个 if 语句中。

```
if(x.innerText){
    alert(x.innerText);
} else {
    // Firefox support
    alert(x.textContent);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T04:40:29.533

在您的代码中

```
var x=document.getElementById(""+thisdata); 
```

这里 x 是一个对象，您需要编写所需的函数来更改值或获取值。

```
alert(x.innerHTML); 
```

会给你单元格的值。

HTML td 标记中提到的 ID 与您的 getElementById deos 中的 id 不匹配。（使用浏览器中的错误控制台获取 javascript 错误）

您可能必须像这样更改您的功能

```
function updateValue(thisdata){
    var x=document.getElementById("companyname_"+thisdata);
    if(x){
        alert(x.innerHTML);
    }
    else
            alert("not found");

} 
```

您的 HTML 代码：

```
foreach($_RESPONSE['VENDOR_LIST'] as $r){
     echo  "<tr><td>".$r['fdEmail']."</td>
                <td id='companyname_".$r['fdId']."' contenteditable='true' onblur="updateValue('companyname_".$r['fdId']."');">".$r['fdCompanyName']." ".$r['fdId']."</td></tr>";
} 
```

注意：我没有测试过代码，请做出相应的更改，如果你觉得有困难，请在此处发布:)

始终使用 jQuery，它使您的任务变得简单 :)

# ios - 在存折中添加通行证时未发生通知

> ID：14270367
> 
> 赞同：0
> 
> 时间：2013-01-11T01:45:15.953
> 
> 标签：ios, xcode, passbook

我只是想在将通行证添加到存折时收到通知。

需要注意的一件事是，我还尝试使用我使用与我的应用程序使用的不同的苹果开发帐户生成的通行证。我试图弄清楚这是否是问题的一部分。

这是 3-tab 应用程序中的一个 VC。

视图控制器.m：

```
@interface ViewController ()
{
    PKPassLibrary *_passLibrary;
    NSArray *_passes;
}
@end 
```

“viewDidLoad”：

```
- (void)viewDidLoad
{
    //init passbook
    _passLibrary = [[PKPassLibrary alloc] init];

    _passes = [_passLibrary passes];

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(passLibraryDidChange:) name:PKPassLibraryDidChangeNotification object:_passLibrary];
} 
```

和我的通知处理程序：

```
- (void)passLibraryDidChange:(NSNotification *)notification
{
    dispatch_async(dispatch_get_main_queue(), ^{
      NSLog(@"%@", @"passes added");
    });
} 
```

当我在 iOS 模拟器中运行应用程序时，一切都按预期工作，我可以在 Xcode 中看到控制台的日志输出。

当我在设备上运行时，添加 Pass 时不会调用通知。在设备上，我什至无法列出任何通行证。

更奇怪的是，当我从存折中删除通行证，然后重新进入应用程序时，会调用通知。

ps：我真的希望这是我在这里想念的简单的东西。

编辑：更新了更多信息和更完整的代码示例

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T16:28:40.203

您似乎没有保留 PKPassLibrary 实例的句柄。在你的 UIViewController 子类上创建一个强大的@property。Alloc+Init 属性并配置在 viewDidLoad 中监听的通知（所以它只会完成一次）。

在某处的 UIApplication 上设置它可能更合适，但这取决于应用程序逻辑以及您的 ViewController 如何适合您的 UI（例如，当您仍然需要访问 PassKit 通知时，它是否被替换或释放？）...</ p>

缺口。

PS你有什么理由如此明确地在GCD主队列上进行NSLogging？这只是从一些 UI 反馈中遗留下来的吗？

PPS 在您重新进入应用程序时看到通知非常有意义，因为此时会调用 viewWillAppear 并且新的 PKPassLibrary 实例将立即触发正在等待的通知。不知道为什么它在模拟器中工作 - 一定是偶然的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T21:00:15.510

它归结为从供应配置文件的同一来源创建的通行证类型标识符。

然后我必须获取新的通行证并将它们添加到我的钥匙串中，然后使用新的通行证类型标识符重新创建实际通行证。

同时，在 Xcode..在我的目标的摘要部分的权利部分中，我可以刷新通行证并看到新的通行证类型 ID 进来了。

应用程序运行后，我现在会收到任何更改（加法/减法/等）的正确通知。

我还需要确保我的 _passLibrary 被正确保留。

# groovy - 如何在 Groovy 中的 Object 上添加全局可用的 MetaMethod？

> ID：14270369
> 
> 赞同：2
> 
> 时间：2013-01-11T01:45:22.720
> 
> 标签：groovy

（这是一个普遍的例子）

我想创建一个可以在任何对象上调用的实用程序方法，它的签名如下：

```
class StringMetaData {
    Object value
    String meta
}

Object.metaClass.withStringMetaData = { meta ->
   new StringMetaData(delegate, meta)
} 
```

有了这样的想法，然后在我的程序中的任何地方我都可以做类似的事情：

```
def foo = 1.withStringMetaData("bar") 
```

现在我可以获取`foo.value`值或`foo.meta`附加的字符串。

在本地上下文中，我可以在 Object 上定义此元方法，但我想让它在我的应用程序中全局可用，使此元方法在任何地方都可用的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T07:17:29.063

也许一个 groovy 扩展模块可以帮助你。我自己从未尝试过，但文档指出，您可以向 JDK 类添加自定义方法。

# delphi - 虚拟 TreeView 提示未显示

> ID：14270375
> 
> 赞同：2
> 
> 时间：2013-01-11T01:45:55.550
> 
> 标签：delphi, virtualtreeview

我已将 ShowHint 设置为 true，将 HintMode 设置为 hmToolTip，但是当我将光标悬停在控件上时，我的 OnGetHint() 事件处理程序***甚至没有断点。***

知道我做错了什么吗？

.

* * *

此外，是否有人对好的文档、教程等有任何提示？例如，我在哪里可以找到 HintMode 属性的各种值的实际含义？

网站上的文档极其不完整，短语“使用新闻组或 Delphi Gems 留言板等其他资源来查找描述”在 HMTL 帮助中出现了 789 次——通常是我真正需要帮助的地方：-/

[更新] 事实上，如果有文档的话，我愿意使用另一个组件，即使是一个不那么强大的组件。

谢谢 ！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-11T04:20:49.853

源代码是您使用 VirtualTree 最好的朋友...

```
TVTHintMode = (
    hmDefault,         // show the hint of the control
    hmHint,            // show node specific hint string returned by the application
    hmHintAndDefault,  // same as hmHint but show the control's hint if no node is concerned
    hmTooltip          // show the text of the node if it isn't already fully shown 
```

);

我通常使用这些选项来显示节点的提示文本

```
 ShowHint := True;
  HintAnimation := hatFade;
  HintMode := hmHint; 
```

hmTooltip 正在使用节点的文本，因此在这种情况下它可能不会调用 OnGetHint。

# variables - 在 Scheme 中模拟静态变量

> ID：14270376
> 
> 赞同：1
> 
> 时间：2013-01-11T01:46:09.333
> 
> 标签：variables, static, scheme, increment, lexical

返回在 Scheme 中调用了多少次的函数看起来像

```
(define count
  (let ((P 0))
    (lambda () 
      (set! P (+ 1 P))
      P)))

(list (count) (count) (count) (count)) ==> (list 1 2 3 4) 
```

但是假设我们有一个看起来像这样的表达式

```
(map ______ lst) 
```

我们希望它评估为

```
(list 1 2 3 ... n)
where n = (length list) 
```

问题要求我们在空格中使用 lambda 语句，并且不能在空格中使用任何辅助定义，如 (count)，所以

```
(lambda (x) (count)) 
```

不被允许。只需将 (count) 替换为之前的定义，如下所示：

```
(map
 (lambda (x)
   ((let ((P 0))
      (lambda () 
        (set! P (+ 1 P))
        P))))
 L) 
```

也不行。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:05:03.067

你已经完成了 90% 的路。在空白处使用定义的右侧`count`，并向函数添加一个（忽略的）参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T02:41:24.507

You're very, very close to a correct solution! in the code in the question just do this:

1.  The outermost `lambda` is erroneous, delete that line and the corresponding closing parenthesis
2.  The innermost `lambda` is the one that will eventually get passed to the `map` procedure, so it needs to receive a parameter (even though it's not actually used)
3.  Delete the outermost parenthesis surrounding the `let` form

It all boils down to this: the `lambda` that gets passed to `map` receives a parameter, but also encloses the `P` variable. The `let` form defines `P` only once in the context of the passed `lambda`, and from that point on the `lambda` "remembers" the value of `P`, because for each of the elements in the list the same `P` is used.

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2022-01-09T11:17:51.470

```
(define add-stat-var

    (let ( (P '()) )
        (lambda (x1) 
            (if (equal? x1 "ResetStatVar") (set! P '()) (set! P (cons x1 P)))
        P
        ) ;lambda

    ) ;let

) ;define

(define (test-add-stat-var x)

    (let* ( (result '()) )

            (set! result (add-stat-var 12))
            (set! result (add-stat-var 14))
            (set! result (add-stat-var 16))

            (display (add-stat-var x)) (newline)

            (set! result (add-stat-var "ResetStatVar"))

            (display (cdr (add-stat-var x))) (newline)

    )

) 
```

# rotation - 使用 toAxisAngle() 时 x3dom 旋转不起作用。元素正确跟随鼠标，但不能正确旋转

> ID：14270377
> 
> 赞同：1
> 
> 时间：2013-01-11T01:46:19.007
> 
> 标签：rotation, mousemove, x3dom

我正在创建一个类似于鸟瞰游戏的页面。我正在尝试根据鼠标移动事件在 x 和 z 轴上移动 x3dom 元素。它可以工作，除非它没有正确旋转。称为占位符的元素是我根据鼠标坐标移动的元素。在函数 squaremousemove() 下，您会注意到 rot[1] 的旋转。我尝试用 rotateIncrement 替换它，这是我旋转所有其他元素的方式，但这不起作用。占位符假设与正方形具有相同的旋转。有任何想法吗？

```
<!DOCTYPE HTML>
<html>
<head>
<link rel="stylesheet" href="style/x3dom.css">

<script type="text/javascript" charset="utf-8" src="js/jquery-1.7.2.min.js"></script>
<script type="text/javascript" charset="utf-8" src="js/x3dom.js"></script>

<style>
    body        {margin: 0; padding: 0;}
    #debugtext  {position: absolute; top: 30px; left: 15px;}
</style>

<script type="text/javascript" charset="utf-8">

    $(document).ready(function(){
        var screenW = $(document).width();
        var screenH = $(document).height();
        var rotateIncrement = 0.78;
        var groundlevel = 0.1;
        var isMouseDown = false;
        var isShiftPressed = false;
        var isCtrlPressed = false;
        var lastrotatevalueX = 0;
        var lastpanvalueX = 0;
        var lastpanvalueZ = 0;
        var panincrementX = 0;
        var panincrementZ = 200;

        var x3d = document.getElementById('x3darea');

        // set the height and width of the x3d area
        $("#x3darea").css({width: screenW + "px", height: screenH + "px", border: "0"});

        // set viewpoint attributes
        viewpoint.setAttribute("position", "0 65 200");
        viewpoint.setAttribute("orientation", "1 0 0 -0.5");

        // set initial rotation
        rotateshapes();

        // disable selection for all elements
        $(document).disableSelection();

        $(document).keydown(function(e) {
            if (e.shiftKey)
                isShiftPressed = true;

            if (e.ctrlKey)
                isCtrlPressed = true;
        });

        $(document).keyup(function(e) {
            isShiftPressed = false;
            isCtrlPressed = false;
        });

        x3d.addEventListener("mousedown", function() { 
            isMouseDown = true; 
        }, false);

        x3d.addEventListener("mouseup", function() {
            isMouseDown = false;
        }, false);

        x3d.addEventListener("mousemove", function(e) {
            if (isMouseDown) {

                if (isShiftPressed)
                    rotatesetup(e);

                if (isCtrlPressed) {
                    panviewbox(e);
                }

                // not sure what these two lines do except that they disable the built-in rotation and panning
                e.cancelBubble = true;
                e.stopPropagation();
            }
        }, true);

        function panviewbox(e) {
            var increment = 0.4;

            if (lastpanvalueX > e.layerX)
                panincrementX += increment;
            else
                panincrementX -= increment;

            if (lastpanvalueZ > e.layerY)
                panincrementZ += increment;
            else
                panincrementZ -= increment;

            lastpanvalueX = e.layerX;
            lastpanvalueZ = e.layerY;

            viewpoint.setAttribute("position", panincrementX + " 65 " + panincrementZ);
        }

        function rotatesetup(e) {
            var increment = 0.06;

            if (lastrotatevalueX > e.layerX)
                rotateIncrement += increment;
            else
                rotateIncrement -= increment;

            lastrotatevalueX = e.layerX;

            rotateshapes(e);
        }

        function rotateshapes() {

            $(".rotatable").each(function() {
                gridline = document.getElementById($(this).attr('id'));

                gridline.setAttribute('rotation', '0 1 0 ' + rotateIncrement);
            });
        }
    });

    function squaremousemove(event) {
        var posX = event.worldX;
        var posZ = event.worldZ;
        var placeholder = document.getElementById('placeholder');

        var norm = new x3dom.fields.SFVec3f(event.normalX, event.normalY, event.normalZ);
        var qDir = x3dom.fields.Quaternion.rotateFromTo(new x3dom.fields.SFVec3f(0, 1, 0), norm);
        var rot = qDir.toAxisAngle();

        $("#debugtext").html(rot[1]);
        // $("#debugtext").html(posX.toFixed(4) + ", " + posZ.toFixed(4));

        placeholder.setAttribute('rotation', rot[0].x + ' 1 ' + rot[0].z + ' ' + rot[1]);
        placeholder.setAttribute('translation', event.worldX + ' 0.1 ' + event.worldZ);
        placeholder.setAttribute('center', (event.worldX*-1) + ' 0 ' + (event.worldZ*-1));

        // placeholder.setAttribute('translation', posX + ' 1 ' + posZ);
        // placeholder.setAttribute('rotation', '0 1 0 ' + rotateIncrement);
    }
</script>
</head>
<body>
    <div id="devcontent">
        <span id="debugtext"></span>

<x3d id="x3darea">
            <scene>
                <transform id="square" class="rotatable" onmousemove="squaremousemove(event);" translation="0 0 0">
                    <shape>
                        <appearance>
                            <material diffuseColor='green'></material>
                        </appearance>
                        <box size="200 0.01 200" />
                    </shape>
                </transform>
                <transform id="placeholder" class="rotatable" translation="-95 0.1 91" center="95 0 -91">
                    <shape>
                        <appearance>
                            <material diffuseColor='#ff8787'></material>
                        </appearance>
                        <box size="6 0.1 6" />
                    </shape>
                </transform>
                <transform id="building1" class="rotatable" translation="-40 2 20" center="40 0 -20">
                    <shape>
                        <appearance>
                            <material diffuseColor='blue'></material>
                        </appearance>
                        <box size="2 4 2" />
                    </shape>
                </transform>
                <transform id="building2" class="rotatable" translation="5 2.5 18" center="-5 0 -18">
                    <shape>
                        <appearance>
                            <material diffuseColor='yellow'></material>
                        </appearance>
                        <box size="4 5 4" />
                    </shape>
                </transform>
                <transform id="road1" class="rotatable" translation="0 0.1 0" center="0 0 0">
                    <shape>
                        <appearance>
                            <material diffuseColor='gray'></material>
                        </appearance>
                        <box size="200 0.001 2" />
                    </shape>
                <Viewpoint id="viewpoint" />
            </scene>
        </x3d>
</div>
</body>
</html> 
```

# razor - 我的空列表编辑器模板未呈现

> ID：14270378
> 
> 赞同：0
> 
> 时间：2013-01-11T01:46:19.983
> 
> 标签：razor, asp.net-mvc-4

我的 EditorTemplates 文件夹中有一个自定义编辑器，用于`IList<PersonRelations>`. 编辑器有这个模型：

```
@model IList<PersonRelation> 
```

在我的实体中是这样的：

```
public IList<PersonRelation> Relations { get; set; } 
```

在我看来，这就是我所说的：

```
 <div class="editor-field">
      @Html.EditorFor(model => model.Relations)
 </div> 
```

如果`Relations`为空，它正在渲染模型。

但是..我想以这种方式声明我的财产

```
 private IList<PersonRelation> _relations;
    public IList<PersonRelation> Relations
    {
        get { return _relations ?? (_relations = new List<PersonRelation>()); }
        set { _relations = value; }
    } 
```

避免空引用异常。

问题是当 List 不为 null 且没有元素时，编辑器根本不会显示。

在我的编辑器中，我迭代了元素，但我也在循环之外渲染了另一个控件，我看不到任何元素。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:04:59.710

解决了。当我改变财产时，我忘了用它来装饰它`[UIHint("PersonRelations")]`

这是属性的原始形式（我的自定义编辑器的文件名是“PersonRelations.cshtml”）

这是必需的，因为引擎似乎无法推断集合的编辑器，即使您有一个集合，所以您必须明确告诉您要使用哪个。

# ios - 追加一个从字典对象转换的 NSString 到 NSMutableArray

> ID：14270381
> 
> 赞同：0
> 
> 时间：2013-01-11T01:46:48.897
> 
> 标签：ios, nsstring, nsdate, nsdictionary, nsmutablestring

我被这个问题困扰了很久。

我有一个从 RSS 解析器接收的 NSString，我可以在屏幕上成功地 NSlog 它，但是当我尝试将它附加到现有的 NSmutablearray 时，它会导致异常。

这是我的代码。

```
//mystring is a NSMutableString with some content initialized succesfully

NSString *myDate = [dic objectForKey:@"date"];
NSLog(@"%@ and %@",myString,myDate);
[myString appendString:myDate]; 
```

直到 NSLog，myDate 和 myString 都按照我的意愿正确打印在屏幕上，但是 appendString 行会导致错误

*[* _NSDate 长度]：无法识别的选择器发送到实例 0*7141a00 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：'-[__NSDate 长度]：......

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:49:50.707

您正在调用`-appendString:`with `myDate`，这不是字符串。这是一个`NSDate`. 您不能将其传递给需要字符串的 API。您需要以某种方式将其转换为字符串。这可能最好使用 来完成`NSDateFormatter`，它使您可以完全控制如何将日期格式化为字符串。

但是，出于测试目的，您可以将最后一行替换为`[myString appendString:[myDate description]]`它应该停止崩溃。

# android - 如何从 facebook 应用程序中创建操作栏功能？

> ID：14270386
> 
> 赞同：0
> 
> 时间：2013-01-11T01:47:33.947
> 
> 标签：android, android-actionbar

这是来自 Play 商店的 Facebook 应用程序的图片。我想在我的应用程序中复制“New Stories 10+”部分。我该怎么做？那是操作栏的一部分吗？

[我在这里](http://developer.android.com/guide/topics/ui/actionbar.html#Dropdown)通读了操作栏文档，但找不到任何相关信息。我也很难用谷歌搜索它，因为我不知道它叫什么。

此外，如果您在飞机上打开 Facebook 应用程序，则会出现一条非常相似的消息，上面写着“没有 Internet 连接”。该消息是如何创建的？

![在此处输入图像描述](../Images/5e1cd904be73b72e1648c86293859439.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T03:14:04.113

更*深入地*查看 Facebook 应用程序，该栏似乎只是`LinearLayout`包含两个`TextView`s。然后，此布局仅嵌入新闻提要片段中，并根据需要隐藏/显示。换句话说，**它不是操作栏的一部分**；这只是片段中的正常视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T03:22:26.840

查看Cyril Mottier 的[这个库](https://github.com/keyboardsurfer/Crouton)。它旨在完全满足您的要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T03:18:15.703

是的，它是 ActionBar 的一部分，但前提是设备或模拟器在 API 3.0 或更高版本上。如果设备或模拟器的 API 级别较低，则操作将显示在菜单按钮上。

这只是一个假人，但它会给你一个粗略的想法。

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {

    int groupid = 1;

    menu.add(groupid, 1, 1, "Search").setIcon(R.drawable.embassy_default);
    // menu.add(groupid, , ,"Back").setIcon(R.drawable.hospital_default);
    menu.add(groupid, 1, 1, "Exit").setIcon(R.drawable.government_default);

    return true;

} 
```

在这里阅读更多

[http://developer.android.com/guide/topics/ui/menus.html](http://developer.android.com/guide/topics/ui/menus.html)

# ios - CTLineGetStringIndexForPosition 在核心文本中给我错误的索引

> ID：14270387
> 
> 赞同：0
> 
> 时间：2013-01-11T01:48:15.227
> 
> 标签：ios, objective-c, core-text

我有一个关于`CTLineGetStringIndexForPosition`核心文本的问题。

我有这样的文字：

```
Question: Hello, how are you today?
Answer: I am fine thank you
Question: great day isn't it?
... 
```

在上面的文字中，我为每个“问题：”字设置了属性，以使其可点击。我将所有这些文本放在一个`UITableview`单元格上。我有很多类似的单元格有问题和答案。当我触摸其中一个单元格上的“问题：”字时，我得到的索引是正确的。我向下滚动`UITableview`，然后我有另一个像以前一样的文本。当我点击“问题：”时，索引不正确。

这就是我实现索引的方式。

```
index = CTLineGetStringIndexForPosition(line,CGPointMake(lineOrigins[i].x + pnt.x, pnt.y)); 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:46:42.993

你没有解释`pnt`从哪里来，但它可能是不正确的。`CTLineGetStringIndexForPosition`相对于文本空间中每一行的原点（通常与您可能期望的相反）。有关如何处理此问题的示例，请参阅[使用 CoreText 和触摸创建可点击操作。](https://stackoverflow.com/questions/3802697/using-coretext-and-touches-to-create-a-clickable-action)

# python - Python matplotlib 多条

> ID：14270391
> 
> 赞同：132
> 
> 时间：2013-01-11T01:48:40.797
> 
> 标签：python, pandas, matplotlib, seaborn, bar-chart

如何在 matplotlib 中绘制多个条形图，当我尝试多次调用 bar 函数时，它们重叠，如下图所示，只能看到最高值红色。如何在 x 轴上绘制带有日期的多个条形图？

到目前为止，我试过这个：

```
import matplotlib.pyplot as plt
import datetime

x = [
    datetime.datetime(2011, 1, 4, 0, 0),
    datetime.datetime(2011, 1, 5, 0, 0),
    datetime.datetime(2011, 1, 6, 0, 0)
]
y = [4, 9, 2]
z = [1, 2, 3]
k = [11, 12, 13]

ax = plt.subplot(111)
ax.bar(x, y, width=0.5, color='b', align='center')
ax.bar(x, z, width=0.5, color='g', align='center')
ax.bar(x, k, width=0.5, color='r', align='center')
ax.xaxis_date()

plt.show() 
```

我懂了：

![在此处输入图像描述](../Images/48fcbb2c28e58de1aa80f3d8d2e1ef39.png)

结果应该是这样的，但是日期在 x 轴上，条形彼此相邻：

![在此处输入图像描述](../Images/d85cf9e9c5120b9f876eb34fb2bd6651.png)

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2013-01-11T02:12:49.650

```
import matplotlib.pyplot as plt
from matplotlib.dates import date2num
import datetime

x = [
    datetime.datetime(2011, 1, 4, 0, 0),
    datetime.datetime(2011, 1, 5, 0, 0),
    datetime.datetime(2011, 1, 6, 0, 0)
]
x = date2num(x)

y = [4, 9, 2]
z = [1, 2, 3]
k = [11, 12, 13]

ax = plt.subplot(111)
ax.bar(x-0.2, y, width=0.2, color='b', align='center')
ax.bar(x, z, width=0.2, color='g', align='center')
ax.bar(x+0.2, k, width=0.2, color='r', align='center')
ax.xaxis_date()

plt.show() 
```

![在此处输入图像描述](../Images/215fdead048a0173646a6432b0ee95b9.png)

我不知道“y 值也重叠”是什么意思，下面的代码能解决你的问题吗？

```
ax = plt.subplot(111)
w = 0.3
ax.bar(x-w, y, width=w, color='b', align='center')
ax.bar(x, z, width=w, color='g', align='center')
ax.bar(x+w, k, width=w, color='r', align='center')
ax.xaxis_date()
ax.autoscale(tight=True)

plt.show() 
```

![在此处输入图像描述](../Images/db34df48392a2fce89b16e81e5103897.png)

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2013-01-11T02:06:16.990

使用日期作为 x 值的问题在于，如果您想要第二张图片中的条形图，那么它们将是错误的。您应该使用堆叠条形图（颜色相互叠加）或按日期分组（x 轴上的“假”日期，基本上只是对数据点进行分组）。

```
import numpy as np
import matplotlib.pyplot as plt

N = 3
ind = np.arange(N)  # the x locations for the groups
width = 0.27       # the width of the bars

fig = plt.figure()
ax = fig.add_subplot(111)

yvals = [4, 9, 2]
rects1 = ax.bar(ind, yvals, width, color='r')
zvals = [1,2,3]
rects2 = ax.bar(ind+width, zvals, width, color='g')
kvals = [11,12,13]
rects3 = ax.bar(ind+width*2, kvals, width, color='b')

ax.set_ylabel('Scores')
ax.set_xticks(ind+width)
ax.set_xticklabels( ('2011-Jan-4', '2011-Jan-5', '2011-Jan-6') )
ax.legend( (rects1[0], rects2[0], rects3[0]), ('y', 'z', 'k') )

def autolabel(rects):
    for rect in rects:
        h = rect.get_height()
        ax.text(rect.get_x()+rect.get_width()/2., 1.05*h, '%d'%int(h),
                ha='center', va='bottom')

autolabel(rects1)
autolabel(rects2)
autolabel(rects3)

plt.show() 
```

![在此处输入图像描述](../Images/626d2b267f926f69c750bf4008cb4c01.png)

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2020-02-17T21:09:01.677

在寻找类似的解决方案但没有找到足够灵活的东西后，我决定为它编写自己的函数。它允许您在每个组中拥有任意数量的条，并指定组的宽度以及组内条的各个宽度。

享受：

```
from matplotlib import pyplot as plt

def bar_plot(ax, data, colors=None, total_width=0.8, single_width=1, legend=True):
    """Draws a bar plot with multiple bars per data point.

    Parameters
    ----------
    ax : matplotlib.pyplot.axis
        The axis we want to draw our plot on.

    data: dictionary
        A dictionary containing the data we want to plot. Keys are the names of the
        data, the items is a list of the values.

        Example:
        data = {
            "x":[1,2,3],
            "y":[1,2,3],
            "z":[1,2,3],
        }

    colors : array-like, optional
        A list of colors which are used for the bars. If None, the colors
        will be the standard matplotlib color cyle. (default: None)

    total_width : float, optional, default: 0.8
        The width of a bar group. 0.8 means that 80% of the x-axis is covered
        by bars and 20% will be spaces between the bars.

    single_width: float, optional, default: 1
        The relative width of a single bar within a group. 1 means the bars
        will touch eachother within a group, values less than 1 will make
        these bars thinner.

    legend: bool, optional, default: True
        If this is set to true, a legend will be added to the axis.
    """

    # Check if colors where provided, otherwhise use the default color cycle
    if colors is None:
        colors = plt.rcParams['axes.prop_cycle'].by_key()['color']

    # Number of bars per group
    n_bars = len(data)

    # The width of a single bar
    bar_width = total_width / n_bars

    # List containing handles for the drawn bars, used for the legend
    bars = []

    # Iterate over all data
    for i, (name, values) in enumerate(data.items()):
        # The offset in x direction of that bar
        x_offset = (i - n_bars / 2) * bar_width + bar_width / 2

        # Draw a bar for every value of that type
        for x, y in enumerate(values):
            bar = ax.bar(x + x_offset, y, width=bar_width * single_width, color=colors[i % len(colors)])

        # Add a handle to the last drawn bar, which we'll need for the legend
        bars.append(bar[0])

    # Draw legend if we need
    if legend:
        ax.legend(bars, data.keys())

if __name__ == "__main__":
    # Usage example:
    data = {
        "a": [1, 2, 3, 2, 1],
        "b": [2, 3, 4, 3, 1],
        "c": [3, 2, 1, 4, 2],
        "d": [5, 9, 2, 1, 8],
        "e": [1, 3, 2, 2, 3],
        "f": [4, 3, 1, 1, 4],
    }

    fig, ax = plt.subplots()
    bar_plot(ax, data, total_width=.8, single_width=.9)
    plt.show() 
```

输出：

[![在此处输入图像描述](../Images/fde7a23641704d31abbeec2c40407255.png)](https://i.stack.imgur.com/6zkj6.png)

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2019-03-20T13:40:19.283

我知道这是关于 的`matplotlib`，但是使用`pandas`and`seaborn`可以为您节省大量时间：

```
df = pd.DataFrame(zip(x*3, ["y"]*3+["z"]*3+["k"]*3, y+z+k), columns=["time", "kind", "data"])
plt.figure(figsize=(10, 6))
sns.barplot(x="time", hue="kind", y="data", data=df)
plt.show() 
```

[![在此处输入图像描述](../Images/8baa3b2c9ea3fe610b9b3821851e21e7.png)](https://i.stack.imgur.com/wMWSM.png)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2021-09-14T01:12:50.633

*   给定现有答案，给定 OP 中的数据，最简单的解决方案是将数据加载到数据框中并使用[`pandas.DataFrame.plot`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.plot.html).
    *   使用 a 将值列表加载到 pandas 中`dict`，并指定`x`为索引。索引将自动设置为 x 轴，列将绘制为条形图。
    *   `pandas.DataFrame.plot`用作`matplotlib`默认后端。
*   **在`python 3.8.11`, `pandas 1.3.2`,中测试`matplotlib 3.4.3`**

```
import pandas as pd

# using the existing lists from the OP, create the dataframe
df = pd.DataFrame(data={'y': y, 'z': z, 'k': k}, index=x)

# since there's no time component and x was a datetime dtype, set the index to be just the date
df.index = df.index.date

# display(df)
            y  z   k
2011-01-04  4  1  11
2011-01-05  9  2  12
2011-01-06  2  3  13

# plot bars or kind='barh' for horizontal bars; adjust figsize accordingly
ax = df.plot(kind='bar', rot=0, xlabel='Date', ylabel='Value', title='My Plot', figsize=(6, 4))

# add some labels
for c in ax.containers:
    # set the bar label
    ax.bar_label(c, fmt='%.0f', label_type='edge')

# add a little space at the top of the plot for the annotation
ax.margins(y=0.1)

# move the legend out of the plot
ax.legend(title='Columns', bbox_to_anchor=(1, 1.02), loc='upper left') 
```

[![在此处输入图像描述](../Images/0986675ce34d2c779316e8206032fcd8.png)](https://i.stack.imgur.com/R6Fux.png)

*   有更多列时的水平条

```
ax = df.plot(kind='barh', ylabel='Date', title='My Plot', figsize=(5, 4))
ax.set(xlabel='Value')
for c in ax.containers:
    # set the bar label
    ax.bar_label(c, fmt='%.0f', label_type='edge')

ax.margins(x=0.1)

# move the legend out of the plot
ax.legend(title='Columns', bbox_to_anchor=(1, 1.02), loc='upper left') 
```

[![在此处输入图像描述](../Images/2cb109187bc2bfc6b406893d7381b4e9.png)](https://i.stack.imgur.com/sFKEE.png)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-09-13T23:55:40.840

我修改了 pascscha 扩展界面的解决方案，希望这对其他人有帮助！主要特点：

*   **每个栏组的可变条目数**
*   **可定制的颜色**
*   **处理 x 刻度**
*   **条形顶部完全可定制的条形标签**

```
def bar_plot(ax, data, group_stretch=0.8, bar_stretch=0.95,
             legend=True, x_labels=True, label_fontsize=8,
             colors=None, barlabel_offset=1,
             bar_labeler=lambda k, i, s: str(round(s, 3))):
    """
    Draws a bar plot with multiple bars per data point.
    :param dict data: The data we want to plot, wher keys are the names of each
      bar group, and items is a list of bar values for the corresponding group.
    :param float group_stretch: 1 means groups occupy the most (largest groups
      touch side to side if they have equal number of bars).
    :param float bar_stretch: If 1, bars within a group will touch side to side.
    :param bool x_labels: If true, x-axis will contain labels with the group
      names given at data, centered at the bar group.
    :param int label_fontsize: Font size for the label on top of each bar.
    :param float barlabel_offset: Distance, in y-values, between the top of the
      bar and its label.
    :param function bar_labeler: If not None, must be a functor with signature
      ``f(group_name, i, scalar)->str``, where each scalar is the entry found at
      data[group_name][i]. When given, returns a label to put on the top of each
      bar. Otherwise no labels on top of bars.
    """
    sorted_data = list(sorted(data.items(), key=lambda elt: elt[0]))
    sorted_k, sorted_v  = zip(*sorted_data)
    max_n_bars = max(len(v) for v in data.values())
    group_centers = np.cumsum([max_n_bars
                               for _ in sorted_data]) - (max_n_bars / 2)
    bar_offset = (1 - bar_stretch) / 2
    bars = defaultdict(list)
    #
    if colors is None:
        colors = {g_name: [f"C{i}" for _ in values]
                  for i, (g_name, values) in enumerate(data.items())}
    #
    for g_i, ((g_name, vals), g_center) in enumerate(zip(sorted_data,
                                                         group_centers)):
        n_bars = len(vals)
        group_beg = g_center - (n_bars / 2) + (bar_stretch / 2)
        for val_i, val in enumerate(vals):
            bar = ax.bar(group_beg + val_i + bar_offset,
                         height=val, width=bar_stretch,
                         color=colors[g_name][val_i])[0]
            bars[g_name].append(bar)
            if  bar_labeler is not None:
                x_pos = bar.get_x() + (bar.get_width() / 2.0)
                y_pos = val + barlabel_offset
                barlbl = bar_labeler(g_name, val_i, val)
                ax.text(x_pos, y_pos, barlbl, ha="center", va="bottom",
                        fontsize=label_fontsize)
    if legend:
        ax.legend([bars[k][0] for k in sorted_k], sorted_k)
    #
    ax.set_xticks(group_centers)
    if x_labels:
        ax.set_xticklabels(sorted_k)
    else:
        ax.set_xticklabels()
    return bars, group_centers 
```

# 样品运行：

```
fig, ax = plt.subplots()
data = {"Foo": [1, 2, 3, 4], "Zap": [0.1, 0.2], "Quack": [6], "Bar": [1.1, 2.2, 3.3, 4.4, 5.5]}
bar_plot(ax, data, group_stretch=0.8, bar_stretch=0.95, legend=True,
         labels=True, label_fontsize=8, barlabel_offset=0.05,
         bar_labeler=lambda k, i, s: str(round(s, 3)))
fig.show() 
```

[![在此处输入图像描述](../Images/68c1753f7179eea5767018f165861dd1.png)](https://i.stack.imgur.com/S4YQC.png)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-04-05T23:55:52.987

我做了这个解决方案：如果您想在一个图中绘制多个图，请确保在绘制下一个图之前，您已设置 `matplotlib.pyplot.hold(True)` 为能够添加另一个图。

关于 X 轴上的日期时间值，使用条形对齐的解决方案对我有用。当您创建另一个条形图时`matplotlib.pyplot.bar()`，只需使用`align='edge|center'`并设置`width='+|-distance'`.

当您正确设置所有条形图（图）时，您会看到条形图正常。

# c# - 在不更改控件的情况下调整大小

> ID：14270397
> 
> 赞同：1
> 
> 时间：2013-01-11T01:49:23.353
> 
> 标签：c#, winforms

我敢肯定，当 resize 事件发生的速度比 onPaint 事件快时，许多开发人员都会对闪烁感到沮丧。

我创建了许多显示在主窗体上的用户对象。当我尝试在主窗体的 resize 事件中设置每个控件的位置和大小时，我得到了闪烁。

为了解决这个问题，我想做一种如下所述的新方法。

1.  当 resizeBegin 事件被触发时，显示当前帧的边界
2.  当 resize 事件被触发时，只有边框会被调整大小，而主框架中的控件保持不变。
    *   棘手的部分是当边界线大于原始大小时，我希望它显示窗口的背景。 [点击放大图片](http://jokerham.hosting.paran.com/DataUpload/enlarge.png)
    *   相反，如果边界线更小，我仍然希望显示原始对象 [点击缩小图像](http://jokerham.hosting.paran.com/DataUpload/reduce.png)
3.  当 resizeEnd 时，边界线将被隐藏，并且框架中的控件将被调整大小。

有人知道如何实现调整大小时提到的棘手部分吗？

# wpf - WPF 中的数据绑定形状和线条

> ID：14270398
> 
> 赞同：1
> 
> 时间：2013-01-11T01:49:33.490
> 
> 标签：wpf, data-binding, path, geometry, shapes

我正在开发一个需要能够在 WPF 中操作形状和线条的应用程序。我最初的想法是将集合数据绑定到 ListBox 并在数据模板中使用 Rectangles，将每个填充属性设置为图像。这对大多数形状都很有效，除了圆形和一些矩形。由于重新调整图像大小会导致像素化并且线条会改变大小，因此结果并不理想。

我花了一些时间浏览 SO 和其他一些关于 Path 元素的网站，但没有找到任何真正满足我需求的东西。我的猜测是我需要为每种类型的形状生成不同的路径，并使用类似于[路径绘图和数据绑定](https://stackoverflow.com/questions/4631231/path-drawing-and-data-binding)的转换器对它们进行数据绑定，或者使用[http://www.telerik.com/help/wpf/raddiagram-overview.html](http://www.telerik.com/help/wpf/raddiagram-overview.html)或类似的 rad 工具。

我的问题：有没有更简单的方法来完成这个或任何其他示例？

编辑：我还需要能够添加文本。不知道如何使用路径来做到这一点......也许是 ContentControl？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:48:31.240

`Path.Data`您可以通过将 a 数据绑定到 a来绘制各种形状`Geometry`。您可以`Geometry`从点列表生成。转换器非常适合这种适应。

例如，我通过将`Path.Data`属性数据绑定到`StreamGeometry`我从视图模型管理的点列表中生成的 a 来绘制螺旋线，它非常适合我的需求：

```
// ViewModel ...
public class ViewModel 
{
    [Notify]
    public IList<Point> Points { get; set; }
}

// Converter ... 
public class GeometryConverter : IValueConverter
{
    public Object Convert(Object value, Type targetType, Object parameter, CultureInfo culture)
    {
        if (value == null || value == DependencyProperty.UnsetValue)
        {
            return value;
        }

        var points = (IList<Point>)value;            
        var i = 0; 
        var newPath = new StreamGeometry();

        using (var context = newPath.Open())
        {
            var begun = false;

            for (var i = 0; i < points.Count; i++)
            {
                var current = points[i];

                if (!begun)
                {
                    begun = true;
                    context.BeginFigure(current, true, false);
                }
                else
                {
                    context.ArcTo(current, new Size(radius, radius), angle, false, SweepDirection.Counterclockwise, true, true);
                }
            }
        }

        newPath.Freeze();
        return newPath.GetFlattenedPathGeometry();
    }
} 
```

XAML：

```
<Canvas>
    <Path StrokeThickness="{Binding StrokeWidth}"
          Canvas.Top="{Binding Top}"
          Canvas.Left="{Binding Left}"
          Data="{Binding Points, Converter={StaticResource GeometryConverter}}">
        <Path.Stroke>
            <SolidColorBrush Color="{Binding CurrentColor}" />
        </Path.Stroke>
    </Path>
</Canvas> 
```

至于文本，绑定`TextBlock`元素并根据需要将它们排列在“画布”上不是更好吗？

# internationalization - AngularJS I18n 文件在哪里？

> ID：14270405
> 
> 赞同：24
> 
> 时间：2013-01-11T01:50:34.110
> 
> 标签：internationalization, angularjs, locale

他们在这里谈论特定于语言环境的文件[http://docs.angularjs.org/guide/i18n](http://docs.angularjs.org/guide/i18n)但没有提到从哪里获得它们（官方 AngularJS 存储库不包含它们）。

那么从哪里获得这些语言环境文件呢？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-09-04T14:39:59.203

您也可以使用**bower**获取它们：

```
bower install angular-i18n 
```

它是反映[https://code.angularjs.org/文件的官方 Bower 发行版](https://code.angularjs.org/)

更多信息在[https://github.com/angular/bower-angular-i18n](https://github.com/angular/bower-angular-i18n)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-01-11T02:02:41.447

最新的稳定版本 i18n 文件在这里： [http ://code.angularjs.org/1.0.3/i18n/](http://code.angularjs.org/1.0.3/i18n/)

您还可以在这里找到其他版本：http: [//code.angularjs.org/](http://code.angularjs.org/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-09-21T19:48:41.597

您也可以使用**npm**获取它们：

```
npm install angular-i18n 
```

然后在 index.html 中添加您选择的语言环境文件：

```
<script src="/node_modules/angular-i18n/angular-locale_YOUR-LOCALE.js"></script> 
```

请注意，您的 Angular 应用程序只会使用最新加载的语言环境文件。

也可以使用[angular-dynamic-locale](http://github.com/lgalfaso/angular-dynamic-locale)动态更改语言环境。然后，您无需在 index.html 中决定启动时要使用哪个语言环境。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-04T08:48:54.247

**首先从bower**安装所有文件

 **```
bower install angular-i18n --save 
```

[或从https://github.com/angular/bower-angular-i18n](https://github.com/angular/bower-angular-i18n)获取所需语言国家/地区的 angular-locale 文件

*然后要么努力工作并将所有文件包含在你的脚本标签中，要么只是下载*

> tmhDynamicLocale js

***（聪明的工作）***，它动态包含所有角度语言环境文件。

按照这个 git hub 存储库进行演示

[https://github.com/ajarvis98/angular-locale-tmh-dynamic-locale](https://github.com/ajarvis98/angular-locale-tmh-dynamic-locale)

完全按照这个 git-repo 中的结构进行操作**

# arrays - 弹性数组从循环到字符串

> ID：14270409
> 
> 赞同：0
> 
> 时间：2013-01-11T01:50:56.290
> 
> 标签：arrays, string, apache-flex, loops

我能够毫无问题地追踪结果。但是我想将结果转换为字符串而不是数组。我想这样做的原因是因为我需要对返回的每个字符串进行搜索和替换。也有人可以帮助将数组的每一行放在一个字符串中，这样我就可以进行搜索和替换。对不起，我我是 flex dev 的新手。非常感谢您的帮助

```
 var myArrayOfLines:Array = ul.data.split(/\n/);
 var line:String;
 for each (var lineRaw:String in myArrayOfLines)
 { 
  //line:String = lineRaw.match(pattern);
 trace(lineRaw.match(pattern));
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:59:46.293

由于您的数组存储字符串。您可以定义`String`变量（例如`str`）并迭代数组并将数组的每个项目附加到 str ，如下所示：

```
var str : String = "";
for each (var line : String in myArrayOfLines) {
    str += line;
}
//you can do some match and replace operation on the str variable, 
//since it contains all the elements of the arr. 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-11T02:12:01.873

如果您想替换每一行中的某些内容，并且只需加入结果，则无需将其拆分为行。您可以只使用 replaceAll 方法。

```
replaceAll("pattern to search","string to put where pattern match"); 
```

如果您仍然需要替换并加入所有行，您可以执行以下操作

```
 var myArrayOfLines:Array = ul.data.split(/\n/);
    var line:String;
    var result:String = "";
    for each (var lineRaw:String in myArrayOfLines){ 
        // you can use replace or replaceAll
        line:String = lineRaw.replace(pattern, "whatever you want to put in places");
        result += line;
        result += "\n"; // use this line if you want to add the break lines again
    } 
```

如果您仍想使用 match()，它会返回所有匹配项而不是单个字符串：

```
var str:String = "bob@example.com, omar@example.org"; 
var pattern:RegExp = /\w*@\w*\.[org|com]+/g; 
var results:Array = str.match(pattern);
// the result is ["bob@example.com","omar@example.org"] 
```

所以，如果你有这样的东西，你可以做一个 for 来迭代所有的匹配。

```
 var lines:Array = lineRaw.match(pattern);
    for each (var line:String in lines){ 
        // you can do whatever you want with the String line
        result += line;
    } 
```

# ruby - 您如何表示任意大小的二维数组？

> ID：14270412
> 
> 赞同：-2
> 
> 时间：2013-01-11T01:51:09.523
> 
> 标签：ruby, arrays, data-structures, ruby-1.9, hash

有什么好的方法来表示在两个维度上以任意长度扩展的二维数组？

在 Ruby 中工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:06:50.333

我认为哈希很好：

```
{
  [0, 0] => "A1",
  [1, 0] => "B1",
  ...
  [0, 1] => "A2",
  [1, 1] => "B2",
  ...
} 
```

[或者，为了使其不那么透明但更高效，您可能会想到一种方法，使用此处](https://stackoverflow.com/questions/919612)建议的配对函数将一对数字映射到单个数字，并将其用作键：

```
{
  0 => "A1",
  1 => "B1",
  ...
  2 => "A2",
  4 => "B2",
  ...
} 
```

# c++ - How do you change a std::map element while iterating?

> ID：14270414
> 
> 赞同：0
> 
> 时间：2013-01-11T01:51:20.303
> 
> 标签：c++, stdmap

I have a large array of object pointers (lets call it A), and a smaller map of object pointers (M) keyed with the index of A.

While iterating M, I want to swap the mapped pointer (second) with the pointer that is currently at that index (first) in A.

I have something like this:

```
map<LONG, Object*>::iterator mit;
for (mit = M.begin(); mit != M.end(); mit++)
{
    if ((*mit).first != NO_ID)
    {
          Object* pTmp = pA->ReplaceObject((*mit).first, (*mit).second);
          if (pTmp != NULL)
          {
               M.at((*mit).first) = pTmp;
          }
    }
} 
```

Here ReplaceObject first gets A[(*mit).first] for return, then changes A[(*mit).first] to (*mit).second.

My mapped pointer is staying stubbornly unchanged - though the debugger, appears to show the change happens correctly.

What am I doing wrong?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T21:12:48.613

A great 'wood-for-the-trees' moment - I was simply negelcting to copy my altered undo operation back to the undo stack. Once I stopped looking for the "error" and just read my code, it was obvious! D'oh!

# php - 发送ajax请求报错

> ID：14270420
> 
> 赞同：0
> 
> 时间：2013-01-11T01:51:51.730
> 
> 标签：php, ajax, request

给出了我的代码的以下摘要：

**JS**

```
$(function() {
    $(".submit").click(function() {

       var dataString = 'user=' + user + '&size=' + size + '&q_1=' + q_1 + '&q_2=' + q_2 + '&q_3=' + q_3 + '&q_4=' + q_4 + '&q_5=' + q_5;

       $.ajax({
           type: "POST",
           url: "form_send.php",    
           data: dataString,
           success: function() {
               //success
           },
           error: function() {
               //error
           }
       });

       return false;

   });
}); 
```

**PHP**

```
if ($_POST) {
$user = $_POST['user'];
$size = $_POST['size'];
$q1 = $_POST['q_1'];
$q2 = $_POST['q_2'];
$q3 = $_POST['q_3'];
$q4 = $_POST['q_4'];
$q5 = $_POST['q_5'];

//insert data
$insert = mysql_query("INSERT INTO table (username, size, q_1, q_2, q_3, q_4, q_5) VALUES ('$user', '$size', '$q1', '$q2', '$q3', '$q4', '$q5')");
if(!$insert){ die("There's little problem: ".mysql_error());}

} 
```

其他代码经过检查并且工作正常，所以这个摘要肯定有错误；我也找不到。

它总是进入 ajax 请求的“错误”。在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:57:52.127

您在 ajax 中的数据应该是这样的

```
data:{'user' : user, 'size':size,'q_1' : q_1 , 'q_2':q_2, 'q_3': q_3 , 'q_4':q_4, 'q_5' :q_5} 
```

# linux - 如何将这五个键盘动作映射到 Vim 中的一个键？

> ID：14270421
> 
> 赞同：0
> 
> 时间：2013-01-11T01:51:56.210
> 
> 标签：linux, vim

我想映射一个键，以便它在 Vim 中执行以下操作。假设我正在编辑一个文件；我希望它进行设置，以便如果我按`F2`，我将完成与执行以下操作时相同的事情：

1.  按`ESC`
2.  键入冒号 ( `:`)
3.  类型`w`
4.  按`Enter`
5.  再按`ESC`_
6.  键入`i`以返回插入模式

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T02:00:45.930

是的，这是可能的，但如果光标位于行尾，它不会做你想做的事。

要`F2`以*插入*模式保存文件，请使用以下映射：

```
:imap <F2> <C-O>:w<CR> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T02:04:37.050

字面答案：是的。你可以使用这个：

```
:inoremap <F2> <Esc>:w<CR>I 
```

但它不会完全符合您的要求（光标将位于错误的位置）。

安东击败了我，得到了不那么直白（但正确）的答案。

不过，最好的答案是：**不要错误地使用 Vim。**你永远不应该在插入模式下花费太多时间，以至于需要一个快捷方式才能退出，保存文件，然后再重新进入。对于所有其他编辑器，你一直处于“插入模式”，而且只有临时弹出菜单或对话框或其他任何内容；在 Vim 中，你应该学会扭转这一点。仅弹出插入模式以编辑或添加内容；在插入模式下切勿使用箭头键移动光标；将大部分时间花在命令（普通）模式下，对新范式稍作调整后，您会发现您的编辑速度有所提高。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-11T02:06:10.290

编写映射几乎比您的描述容易。

首先，您需要确定将从哪种*模式*使用映射，因为这决定了`:map`您将使用哪种变体。您可能希望在*插入模式下*使用它，因此您将使用`:inoremap`.

映射的格式为：

```
:..noremap {keys} {rhs} 
```

你想要`<F2>`（见`:help key-notation`）为`keys`. 对于`{rhs}`，只需连接描述中列出的键。

要保留映射，请将其添加到`~/.vimrc`. （见`:help vimrc`。）

PS [Anton Kovalenko 给出的替代方案](https://stackoverflow.com/a/14270483/758011)可能更适合您尝试做的事情，但在这里我为您提供了未来键映射的一般配方。

# ssl - 如何检查 SSL_write 是否可行？

> ID：14270423
> 
> 赞同：0
> 
> 时间：2013-01-11T01:52:16.800
> 
> 标签：ssl

如何检查是否可以使用 写入 SSL 流`SSL_write()`？

我需要类似的东西

```
 if(SSL_write_possible(ssl))
        SSL_write(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T10:16:19.300

看起来您想使用 OpenSSL 进行非阻塞 I/O。如果是这种情况，我建议您使用 SSL_get_wfd() 和 select() 来检测底层文件描述符何时准备就绪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T05:27:25.343

事情是我确实有异步 IO，但我现在使用缓冲区并写入 SSL，后者写入 BIO，然后我从 BIO 读取并写入另一个异步流。我通过修复我正在使用的握手代码解决了这个问题。所以现在写永远不会失败。:)

# ios - 存折在特定时间提醒我

> ID：14270424
> 
> 赞同：2
> 
> 时间：2013-01-11T01:52:34.760
> 
> 标签：ios, passbook

我使用带有以下内容的存折`pass.json`：

```
"formatVersion" : 1,
"passTypeIdentifier" : "pass.socialPoint.passbook",
"serialNumber" : "69874562241",
"teamIdentifier" : "9TS732CS23",
"lastUpdated" : "1357177440",
"associatedStoreIdentifiers":[564576004],
"relevantDate" : "2013-01-10T20:50+08:00",
"isRelative" : true,
"locations" : [{
  "longitude" : 128.598845,
  "latitude" : 35.203006
}], 
```

我希望它在 20:50 提醒我，但它没有。文件中的时间`pass.json`是`2013-01-10T18:50+08:00`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T04:43:33.387

根据[Apple 文档](https://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/PassKit_PG/Chapters/Creating.html#//apple_ref/doc/uid/TP40012195-CH4-SW53)（表 3-2），`relevantDate`不支持密钥`coupon`并`storeCard`通过。更改为其他通行证类型之一应允许您的通知在指定时间显示在锁定屏幕上。

您的通知时间设置为 2013-01-10T18:50+08:00，即中国的 18:50 和韩国的 19:50（您所在的位置）。尝试设置为 2013-01-10T20:50+09:00

# wpf - 将 setter 行为添加到依赖项属性

> ID：14270427
> 
> 赞同：1
> 
> 时间：2013-01-11T01:52:47.567
> 
> 标签：wpf, silverlight, dependency-properties

我们建议不要向依赖属性包装器的访问器方法添加行为，因为它们可以通过直接调用 Get/SetValue 来绕过。

好的，这很合理。那么我们把这种行为放在哪里*呢？*

我们可以`ValidateValueCallback`在注册依赖属性时提供一个委托。这调用了我们出处的静态方法，该方法采用单个参数对象值，足以进行上下文独立检查，例如“秒必须在 0-59 范围内”。

有时您需要依赖于实例的上下文信息，例如，Day 的有效范围取决于 Month 的实例值。

在这种情况下我们应该怎么做？在 propdp 设置器中处理这将是微不足道的。

下面有人提出，PropertyChanged 事件可能用于这种验证，这实际上是我在提示这个问题的情况下所做的。然而，这很难看，因为在这个阶段更改已经提交给模型，因此有必要维护一个撤消堆栈以提供对先前值的访问。

MSDN 中似乎确实有一些关于这个主题的材料，但我没有时间考虑它需要的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T04:55:06.867

我想我可能已经找到了一个解决方案，`CoerceValueCallback`在属性更改之前运行，如果需要，您可以在进一步传递之前拦截和更改值。

也许你可以试试这个，看看它是否适用于你的情况。

```
public static readonly DependencyProperty MyPropertyProperty =
    DependencyProperty.Register("MyProperty", typeof(int), typeof(MainWindow), new PropertyMetadata(0, null, new CoerceValueCallback(CoercePropertyValue)));

private static object CoercePropertyValue(DependencyObject d, object value)
{
    if (This != That)
    {
        return value;
    }
    return 6;
} 
```

# arrays - 为嵌套在 hashrefs 中的某个键构建倒置映射的优雅方法

> ID：14270428
> 
> 赞同：1
> 
> 时间：2013-01-11T01:52:51.733
> 
> 标签：arrays, perl, hash

我有以下 hashrefs 结构的 hashref：

```
$hashref = {
    user1 => {
        key1 => "unique_value1",
        ...
        key99 => "value1_99"
    },
    ...
    user26 => {
        key1 => "unique_value2",
        ...
        key99 => "value1_99"
    },

    user99 => {
        key1 => "unique_value1",
        ...
        key99 => "value99_99"
    },
}; 
```

我想要的：

```
$hashref = {
    "unique_value1" => ["user1","user99"],
    "unique_value2" => ["user26"]
}; 
```

我历来在创建时构建了倒置地图，但我越来越懒了。

我可以用任何一种糖来做这个吗？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:01:01.870

单程：

```
my $h; 
push (@{$h->{$hashref->{$_}{key1}}}, $_) for keys %$hashref; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T01:59:53.413

```
my %users_by_uval;
for my $user_id (%$users) {
    push @{ $users_by_uval{ $users->{$user_id}{key1} } }, $user_id;
} 
```

# arduino - Arduino RGB LED 代码问题

> ID：14270430
> 
> 赞同：1
> 
> 时间：2013-01-11T01:53:25.663
> 
> 标签：arduino, rgb, led, lcd

我的 arduino 代码有问题。我的代码有 3 个电位器，它们可以改变 LED 中的每种颜色，还有一个按钮，它会淡出红色、绿色、蓝色（按下时会循环一次，按住时会连续循环）。它曾经可以工作，但是当我尝试添加一个显示每个 RGB 值的 LCD 屏幕时，它停止了工作。我知道它写得不是最好的，它只是一个实验代码，因为我刚得到一个 arduino 并且只是想熟悉自己。当我插入它时，LCD 会在顶行打印所有白色方块，并且 LED 为红色并闪烁蓝色，当我按下按钮或转动锅时没有任何反应。这是代码，任何帮助表示赞赏：

```
#include <LiquidCrystal.h>

LiquidCrystal lcd(12, 11, 5, 4, 3, 2);

int potPin1 = 14 ; // select the input pin for the potentiometer, ANALOG
int potPin2 = 15;
int potPin3 = 16; 

int potVal1 = 0; // variable to store the value coming from the sensor
int potVal2 = 0;
int potVal3 = 0; 

int ledPin1 = 6; // select the pin for the LED, PWM for analogWrite capability?
int ledPin2 = 9;
int ledPin3 = 10;

int buttonPin = 7;
int buttonState= LOW;

String printCycleVal1 = (""); //print values when cycling colors
String printCycleVal2 = ("");
String printCycleVal3 = ("");

String printVal1 = ("");//print values when not cycling colors
String printVal2 = ("");
String printVal3 = ("");

int val1 = 0; //values to store rgb colors in
int val2 = 0;
int val3 = 0;

void setup() 
{
  pinMode(potPin1, INPUT);
  pinMode(potPin2, INPUT);
  pinMode(potPin3, INPUT);
  pinMode(ledPin1, OUTPUT);
  pinMode(ledPin2, OUTPUT);
  pinMode(ledPin2, OUTPUT);
  pinMode(buttonPin, INPUT);
  lcd.begin(2,16);
}

void loop()
{
  lcd.clear();
  lcd.setCursor(0,0);
  lcd.print("RGB Values: ");
  lcd.setCursor(0,1);

  potVal1 = analogRead(potPin1);
  val1 = map(potVal1, 0, 1023, 0, 255);
  analogWrite(ledPin1, val1);
  printVal1 += ("V1: ");
  printVal1 += (val1);
  printVal1 += (" | ");

  potVal2 = analogRead(potPin2);
  val2 = map(potVal2, 0, 1023, 0, 255);
  analogWrite(ledPin2, val2);
  printVal2 += ("V2: ");
  printVal2 += (val2);
  printVal2 += (" | ");

  potVal3 = analogRead(potPin3);
  val3 = map(potVal3, 0, 1023, 0, 255);
  analogWrite(ledPin3, val3);
  printVal3 = ("V3: ");
  printVal3 += (val3);

  buttonState = digitalRead(buttonPin);

  while (buttonState == HIGH)
    cycle();
}

void cycle() {
  setColourRgb(0, 0, 0);
  unsigned int rgbColour[3];

  // Start off with red.
  rgbColour[0] = 255;
  rgbColour[1] = 0;
  rgbColour[2] = 0;  

  // Choose the colours to increment and decrement.
  for (int decColour = 0; decColour < 3; decColour += 1) {
    int incColour = decColour == 2 ? 0 : decColour + 1;

    // cross-fade the two colours.
    for(int i = 0; i < 255; i += 1) {
      rgbColour[decColour] -= 1;
      rgbColour[incColour] += 1;

      setColourRgb(rgbColour[0], rgbColour[1], rgbColour[2]);
      lcd.clear();
      lcd.setCursor(0,0);
      lcd.print("RGB Values: ");
      lcd.setCursor(0,1);

      printCycleVal1 += ("V1: ");
      printCycleVal1 += (rgbColour[0]);
      printCycleVal1 += (" | ");

      printCycleVal2 += ("V2: ");
      printCycleVal2 += (rgbColour[1]);
      printCycleVal2 += (" | ");

      printCycleVal3 += ("V3: ");
      printCycleVal3 += (rgbColour[2]);
      delay(5);
    }
    buttonState = LOW;   n
  }
}

void setColourRgb(unsigned int red, unsigned int green, unsigned int blue) {
  analogWrite(ledPin1, red);
  analogWrite(ledPin2, green);
  analogWrite(ledPin3, blue);
} 
```

# python - 在 Python 中并行执行两个进程

> ID：14270433
> 
> 赞同：4
> 
> 时间：2013-01-11T01:53:57.580
> 
> 标签：python, shell, parallel-processing

我正在尝试使用以下代码并行执行两个命令 10 秒，但正如您在输出中看到的那样，整个过程需要 10 多秒。请您帮助我更好地理解这个问题的原因和最佳解决方案。

```
stime = datetime.datetime.now()
print stime
commands = ("sudo /usr/local/bin/snort -v -u snort -g snort -c /usr/local/snort/etc/snort.conf -i eth0 &", "sudo gedit test")
for p in commands:
    p = subprocess.Popen(shlex.split(p), stdout=subprocess.PIPE, stdin=subprocess.PIPE, stderr=subprocess.STDOUT)
    class Alarm(Exception):
        pass
    def alarm_handler(signum, frame):
        raise Alarm
    signal.signal(signal.SIGALRM, alarm_handler)
    signal.alarm(10) #in seconds
    try:
        stdoutdata, stderrdata = p.communicate()
        signal.alarm(0) #reset the alarm
    except Alarm:
        print 'Ooops, taking too long!!!!'
etime = datetime.datetime.now() 
print etime 
```

和输出：

```
2013-01-08 03:30:00.836412
Ooops, taking too long!!!!
2013-01-08 03:30:16.548519 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:07:20.773

我觉得`threading.Timer`可能更合适：

```
from threading import Timer
from subprocess import Popen,PIPE
import shlex
import datetime
import sys

jobs = ['sleep 100','sleep 200']

timers = []
processes = []
print datetime.datetime.now()
for job in jobs:
    p = Popen(shlex.split(job),stdout = PIPE)
    t = Timer(10,lambda p=p: p.terminate())
    t.start()
    timers.append(t)
    processes.append(p)

for t in timers:
    t.join()

stdout,stderr = processes[0].communicate()    
stdout,stderr = processes[1].communicate()
print datetime.datetime.now() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T02:50:34.367

```
import multiprocessing
import subprocess
import shlex
import time

commands = ("echo -n HI-FIRST ", "echo -n HI-SECOND ")
def parallel():
    p = subprocess.Popen(shlex.split(cmd), stdout=subprocess.PIPE, stdin=subprocess.PIPE, stderr=subprocess.STDOUT)
    stdoutdata, stderrdata = p.communicate()
    print stdoutdata + "\t" + time.ctime()
for cmd in commands:
    p = multiprocessing.Process(target=parallel)
    p.start() 
```

**输出：**

```
$ python stack.py 
HI-FIRST    Fri Jan 11 08:47:18 2013
HI-SECOND   Fri Jan 11 08:47:18 2013 
```

# c++ - #includes 在命名空间中，以在命名空间中“嵌入”预先编写的内容

> ID：14270435
> 
> 赞同：4
> 
> 时间：2013-01-11T01:54:05.647
> 
> 标签：c++, templates, namespaces

简介：这样做是否安全

```
 namespace Foo {
 #include "bar"
 } 
```

在你轻率地说不之前，我想我有一些规则可以相当安全地允许它。

但我不喜欢它们，因为它们要求包含器单独包含所需的所有全局范围标头。尽管这可能是可以容忍的，但如果我们想象在命名空间中包含只是一个特殊的管理功能。

总的来说，外部和前向声明在命名空间内不能很好地工作。

所以我想我在问

a) 还有什么其他问题

b) 有没有更好的方法

**== A [[仅标题库]] ==**

我喜欢写图书馆。[[仅头文件库和链接器库]]。

例如

```
#include "Valid.hpp" 
```

为简单的包装器类型定义了一个有效的模板。

（不要陷入“你应该为此使用一些标准库而不是你自己的库。这是一个例子。我不知道 Boost 或 C++ 是否已经标准化了这个。自从模板被添加到 C++ 以来，我一直在使用包装器。 )

另外，让我们说，它是一个只有头文件的库，它在 Valid.hpp 中定义了一个打印函数

std::string to_string( const Valid& v ) { std::ostringstream oss; if( v.valid() ) { oss << v; } 其他 {“无效”；} 返回 oss.str(); }

而且因为我认为这是正确的做法，所以我让 Valid.hpp 包含它所依赖的标头：

```
 Valid.hpp:

         #include <iostream>
         #include <sstream>

         template<typename T> 
         class Valid {
         private:
           T value_;
           bool valid_
           ...
         };

         ...

         std::string to_string( const Valid<T>& v ) { ... 
```

到目前为止，一切都很好。

我可以直接使用Valid。

**== 名称冲突 - 尝试在命名空间中使用 include 来解决 ==**

但有时也会发生碰撞。有时其他人有自己的Valid。

命名空间来拯救，对吧？但我不想更改所有现有代码以使用命名空间。所以，我很想，在一个有冲突的新项目中，做

```
 namespace AG {
    namespace Wrapper {
    #include "lib/AG/Wrapper/Valid.hpp"
    }
    }

    AG::Wrapper::Valid<T> foo_v; 

    ... 
```

问题：包含的标题不再是独立的。里面定义的所有东西都没有放在命名空间 AG::Wrapper 中。

“修复”并不难。
我们“必须”做的就是包含 Valid.hpp 所依赖的所有顶级库。如果他们有包含警卫，他们将不会被重新包含。

```
 #include <iostream>
    #include <sstream>

    namespace AG {
    namespace Wrapper {
    #include "lib/AG/Wrapper/Valid.hpp"
    }
    }

    AG::Wrapper::Valid<T> foo_v; 

    ... 
```

但它不再是独立的。:-(

更糟糕的是，有时只有标头的库包含外部声明和前向声明，它们在其外部。这些声明也被放置在命名空间内。特别是，如果 extern 声明位于命名空间中定义的函数内部。

即有时我们使用外部和前向声明，而不是包含整个头文件。这些被包含在命名空间中。

问：有没有更好的方法？

**== :: 不这样做 ==**

提示：:: 不这样做。至少不是一直，不是在 gcc 4.7.2 中。
（Gcc 在这方面的行为随着时间的推移而改变。Gcc 4.1.2 的行为有所不同。）

例如

```
 Type var;

 namespace Foo {
 void bar() {
    extern ::Type      ::var;;
    extern ::Type      ::Foo::bar;
    extern ::Type::foo      ::bar;  // see the ambiguity?
 }; 
```

但这不仅仅是模棱两可。

整数变量；

```
 namespace Foo {
 void bar() {
    extern int var;
 }; 
```

有效 - Foo::bar'svar 等于 ::var。

但它只是因为命名空间之外的声明才有效。

以下不起作用

标头 int var; cpp namespace Foo { void bar() { extern int var; } }

虽然以下是：

标头 int var; cpp void bar() { extern int var; } }

基本上，这等于说，将函数放在命名空间中并不是一项微不足道的重构。将命名空间包裹在一块代码周围，无论它是否是#include'd，都是不够的。...至少在有外部或前向声明的情况下不会。

而且即使你

**== 反对将包含放入命名空间的意见 ==**

Stackoverflow 的人似乎反对将#includes 放在命名空间中：

例如[，如何使用命名空间内单独标头中定义的类](https://stackoverflow.com/questions/8760711/how-to-use-class-defined-in-a-separate-header-within-a-namespace/8761278#8761278)：

> ...您永远不应该在命名空间内编写#include。“从不”的意思是，“除非你正在做一些我没有想到的非常晦涩的事情并且证明它是合理的”。您希望能够查看文件，并查看其中所有内容的完全限定名称。如果有人稍后出现并通过在其命名空间中包含一个额外的命名空间，您将无法这样做。——史蒂夫·杰索普 2012 年 1 月 6 日 16:38

* * *

总体问题：

有没有办法从命名空间的深处说“现在这里有一些我依赖于外部世界的名称，而不是在命名空间内。”？

即我想说

```
namespace A {
void foo() {
   // --- here is a reference to gloal scope extreren ... 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-07-23T09:56:35.167

我知道这是一个老问题，但无论如何我想给出更详细的答案。另外，对根本问题给出真正的答案。

如果您在命名空间中包含标头，这只是一些可能出错的事情。

1.  标头包括其他标头，然后这些标头也包含在命名空间中。然后另一个地方也想包含这些标头，但来自命名空间之外。因为标头具有包含保护，实际上只有一个包含生效，并且标头中定义的内容的实际名称空间突然微妙地取决于您包含其他标头的顺序。

2.  标头或其任何包含的标头应位于全局命名空间中。例如，标准库头文件经常（为了避免冲突）将其他标准内容（或实现细节）称为`::std::other_stuff`，即期望`std`直接位于全局命名空间中。如果您在命名空间中包含标头，则不再是这种情况。这些东西的名称查找将失败，并且标头将不再编译。它不仅仅是标准标题；我敢肯定在 Boost 标头中也有这种情况。

3.  如果您通过确保首先包含所有其他标头来解决第一个问题，并通过确保不使用完全限定名称来解决第二个问题，那么事情仍然可能出错。一些图书馆要求其他图书馆专门研究他们的东西。例如，一个库可能想要专门化`std::swap`，`std::hash`或者`std::less`针对它自己的类型。（您可以改为重载`std::swap`，但不能为`std::hash`and`std::less`这样做。）这样做的方法是关闭特定于库的命名空间，打开命名空间`std`，然后将专业化放在那里。除非库的标头包含在任意深度嵌套的命名空间中，否则它不能关闭这些命名空间。它尝试打开的命名空间`std`不会是`::std`，但是`::YourStuff::std`，它可能不包含任何要专门化的主要模板，即使它包含，这仍然是错误的做法。

4.  最后，命名空间中的事物与外部事物的名称不同。如果您的库不是仅标头但具有编译部分，则编译部分可能没有将所有内容嵌套在名称空间中，因此库中的内容与您刚刚包含的内容具有不同的名称。换句话说，您的程序将无法链接。

因此，理论上，您可以设计包含在命名空间中时可以工作的标头，但它们使用起来很烦人（必须将所有依赖项都冒泡到包含器）并且非常受限（不能使用完全限定名称或在另一个中专门化东西库的命名空间，必须是仅标头）。所以不要这样做。

但是您有一个不使用名称空间的旧库，并且您想更新它以使用它们而不破坏所有旧代码。这是你*应该*做的：

首先，将子目录添加到库的包含目录。称它为“命名空间”或类似的东西。接下来，将所有标头移动到该目录并将其内容包装在名称空间中。

然后将转发标头添加到基本目录。对于库中的每个文件，您添加一个如下所示的转发器：

```
#ifndef YOURLIB_LEGACY_THE_HEADER_H
#define YOURLIB_LEGACY_THE_HEADER_H

#include "namespaced/the_header.h"
using namespace yourlib;

#endif 
```

现在旧代码应该像往常一样工作。

对于新代码，诀窍不是包含“namespaced/the_header.h”，而是更改项目设置，使包含目录指向命名空间子目录而不是库根目录。然后您可以简单地包含“the_header.h”并获取命名空间版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-11T01:59:41.537

我不认为这是安全的。您将所有包含放入命名空间 Foo...想象一下您的一些包含包含来自 std 命名空间的某些内容...我无法想象混乱！

我不会那样做的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-11T02:01:29.220

头文件不是黑盒子。您始终可以查看包含在项目中的标头，并查看将其包含在命名空间块中是否安全。或者更好的是，您可以修改标头本身以添加命名空间块。即使标头来自第三方库并且在后续版本中发生更改，**您在****项目**中拥有的标头也不会更改。

# c# - Android 从 WWW 下载文本文件

> ID：14270438
> 
> 赞同：1
> 
> 时间：2013-01-11T01:54:27.947
> 
> 标签：c#, text, download, monodevelop, inputstream

我正在使用适用于 Android 的 MonoDevelop，并且希望获得一些帮助以从 Internet 下载文本文件并将其存储在字符串中。

这是我的代码：

```
 try 
        {
            URL url = new URL("mysite.com/thefile.txt");

            BufferedReader in = new BufferedReader(new InputStreamReader(url.openStream()));
            String str;
            while ((str = in.readLine()) != null) 
            {
                // str is one line of text; readLine() strips the newline character(s)
            }

            in.close();
        } 
        catch (MalformedURLException e) 
        {

        } catch (IOException e) 
        {

        } 
```

我收到以下错误：

无效的表达式术语“in”；

我可以请一些帮助以使此代码正常工作。如果有一种更简单的方法可以从 WWW 上下载文本文件并将内容保存到字符串中，请帮助我实现它。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:02:47.570

这是我们用于项目下载网站的代码。

只需将此函数传递给您的 URI，您将返回一个包含整个网站的 BufferedReader。

```
 public static BufferedReader openConnection(URI uri) throws URISyntaxException, ClientProtocolException, IOException {
        HttpGet http = new HttpGet(uri);
        HttpClient client = new DefaultHttpClient();
        HttpResponse resp = (HttpResponse) client.execute(http);
        HttpEntity entity = resp.getEntity();
        InputStreamReader isr = new InputStreamReader(entity.getContent());
        BufferedReader br = new BufferedReader(isr, DNLD_BUFF_SIZE);
        return br;
    } 
```

您可以通过以下方式制作 uri：

```
try{
    try{
    URI uri = new URI("mysite.com/thefile.txt");
    catch (Exception e){} //Should never occur

    BufferedReader in = openConnection(uri);
    String str;
        while ((str = in.readLine()) != null) 
        {
         // str is one line of text; readLine() strips the newline character(s)
        }
    in.close();
    } 
 catch (Exception e){
 e.printStackTrace();
 } 
```

这应该可以帮助您下​​载该网站。

# 3d - 正交投影到 2D

> ID：14270441
> 
> 赞同：1
> 
> 时间：2013-01-11T01:54:57.003
> 
> 标签：3d, projection, orthographic, orthogonal

如何使用非基数向量将一组 3D 点 (x1,y1,z1...) 正交投影到二维空间 (x1,y1...) 以表示要折叠的轴？我环顾四周，找不到满意的答案，我的线性数学手册只有平面投影，而不是二维空间的投影，许多与投影有关的答案要么是透视，要么是基轴，这是我需要的原因这是计算坠落物体上的空气阻力，我的向量是物体的速度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T10:23:48.490

诀窍是使用基数向量，因为它使这变得微不足道。大多数 3d 软件包背后的想法是，相机始终以基本方向（通常是 -z）的方向定向。世界被改变以匹配相机。

那么你如何处理非主要方向呢？您以相同的方式处理它们，只是将世界转换为相机的基本空间。所以你要做的是为平面形成一个矩阵，该平面的法线为负 z。Y和x轴是彼此和z的任意正交单位向量。然后身体通过逆矩阵转换到相机空间的基数空间。最终结果是一个对齐的 3d 空间，因此读取前 2 个坐标会产生您的答案，并且在透视的情况下，您仍然需要将点与它们的 w 值分开。

我制作的一个旧视频示例，可视化了透视的所有步骤，可以在[这里找到（2.5M Quicktime 电影）](http://users.tkk.fi/~joojala2/highend/3DCameraWorksLikeThis.mov)

从本质上讲，这只是一个选择你认为好的参考框架的问题。它与您只是缺少具有分层转换链的不明显部分的计算相同。

# java - 部署程序集：当前显示的页面包含无效值

> ID：14270442
> 
> 赞同：15
> 
> 时间：2013-01-11T01:55:18.737
> 
> 标签：java, eclipse, tomcat, deployment

我从 Sourceforge 导入了一个 Java Web 应用程序，我花了三个工作周的时间来消除项目名称和包上的所有红叉，但现在我无法让该应用程序在我的 Eclipse 和 tomcat6 开发环境上运行。在我尝试设置部署程序集的项目属性中，对话框显示：当前显示的页面包含无效值。在错误日志中，我发现当我单击部署程序集时，显示了以下错误消息：

错误

```
 Wed Jan 09 10:25:16 CST 2013
Problems occurred when invoking code from plug-in: "org.eclipse.jface".

java.lang.NullPointerException
    at org.eclipse.wst.common.componentcore.internal.resources.VirtualFolder.getFirstTaggedResource(VirtualFolder.java:185)
    at org.eclipse.jst.j2ee.componentcore.J2EEModuleVirtualComponent.getDefaultDeploymentDescriptorFolder(J2EEModuleVirtualComponent.java:542)
    at org.eclipse.jst.j2ee.internal.ui.JavaEEDeploymentAssemblyAdvancedSectionBuilder.(JavaEEDeploymentAssemblyAdvancedSectionBuilder.java:86)
    at org.eclipse.jst.j2ee.internal.ui.J2EEModuleDependenciesPropertyPage.getAdvancedSectionBuilder(J2EEModuleDependenciesPropertyPage.java:381)
    at org.eclipse.jst.j2ee.internal.ui.J2EEModuleDependenciesPropertyPage.(J2EEModuleDependenciesPropertyPage.java:65)
    at org.eclipse.jst.servlet.ui.internal.WebDependencyPropertyPage.(WebDependencyPropertyPage.java:34)
    at org.eclipse.jst.servlet.ui.internal.WebModuleDependencyPageProvider.createPages(WebModuleDependencyPageProvider.java:54)
    at org.eclipse.wst.common.componentcore.ui.propertypage.ModuleAssemblyRootPage.createContents(ModuleAssemblyRootPage.java:195)
    at org.eclipse.jface.preference.PreferencePage.createControl(PreferencePage.java:232)
    at org.eclipse.wst.common.componentcore.ui.propertypage.ModuleAssemblyRootPage.createControl(ModuleAssemblyRootPage.java:346)
    at org.eclipse.jface.preference.PreferenceDialog.createPageControl(PreferenceDialog.java:1502)
    at org.eclipse.jface.preference.PreferenceDialog$14.run(PreferenceDialog.java:1259)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:49)
    at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:175)
    at org.eclipse.jface.preference.PreferenceDialog.showPage(PreferenceDialog.java:1253)
    at org.eclipse.ui.internal.dialogs.FilteredPreferenceDialog.showPage(FilteredPreferenceDialog.java:675)
    at org.eclipse.jface.preference.PreferenceDialog$10.run(PreferenceDialog.java:709)
    at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70)
    at org.eclipse.jface.preference.PreferenceDialog$9.selectionChanged(PreferenceDialog.java:705)
    at org.eclipse.jface.viewers.StructuredViewer$3.run(StructuredViewer.java:888)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:49)
    at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:175)
    at org.eclipse.jface.viewers.StructuredViewer.firePostSelectionChanged(StructuredViewer.java:886)
    at org.eclipse.jface.viewers.StructuredViewer.handlePostSelect(StructuredViewer.java:1226)
    at org.eclipse.jface.viewers.StructuredViewer$5.widgetSelected(StructuredViewer.java:1251)
    at org.eclipse.jface.util.OpenStrategy.firePostSelectionEvent(OpenStrategy.java:262)
    at org.eclipse.jface.util.OpenStrategy.access$5(OpenStrategy.java:256)
    at org.eclipse.jface.util.OpenStrategy$3.run(OpenStrategy.java:433)
    at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)
    at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135)
    at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4144)
    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3761)
    at org.eclipse.jface.window.Window.runEventLoop(Window.java:825)
    at org.eclipse.jface.window.Window.open(Window.java:801)
    at org.eclipse.ui.dialogs.PropertyDialogAction.run(PropertyDialogAction.java:158)
    at org.eclipse.jface.action.Action.runWithEvent(Action.java:498)
    at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:584)
    at org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:501)
    at org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:411)
    at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053)
    at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4169)
    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3758)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1022)
    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:916)
    at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:86)
    at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:585)
    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:540)
    at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
    at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124)
    at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1438)
    at org.eclipse.equinox.launcher.Main.main(Main.java:1414) 
```

我用谷歌搜索了很多次，但我找不到解决方案。谁能帮个忙让部署大会工作？我认为这是我的应用程序无法运行的关键。提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-10-23T23:19:15.007

eclipse -clean 没有为我修复它。我的解决方法：在 Eclipse 中删除项目（不要在磁盘上删除）。然后在文件系统中删除 .project .classpath 和 .settings/* 然后在 eclipse 中，相同的工作区，创建与旧的同名的新 webproject。它创建了项目并找到了我所有的源代码。现在部署程序集再次工作！之后，我更新了构建路径以拥有正确的项目和库依赖项。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-27T14:57:22.633

请看[这个答案](https://stackoverflow.com/a/3492924)。如果`clean`没有帮助，那么您的项目的特定设置可能有问题。我建议您检查`.settings/`目录中的每个文件。

我知道这不是一个现成的解决方案，但可能至少是一个起点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-06-06T11:53:31.490

我也遇到过这个问题。这是因为我删除了我当前项目所依赖的另一个项目。我通过打开`org.eclipse.wst.common.component`.settings 文件夹中的文件并删除依赖项来解决此问题。这解决了问题，我能够编辑部署程序集。

第 I 部分删除：（utility.jar 是我的违规 jar 的名称）

```
 <dependent-module archiveName="utility.jar" deploy-path="/WEB-INF/lib" handle="module:/resource/utility/utility">
        <dependency-type>uses</dependency-type>
    </dependent-module> 
```

我与之合作的其他人能够通过从他们的构建路径中删除 jar 来修复它。

希望这可以帮助遇到此问题的任何人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-16T16:24:05.470

*添加Source*（文件夹）并尝试修改*Deploy Path*后，我在不同情况下遇到了相同的状态。因此，得到了相同的错误消息：**部署程序集：当前显示的页面包含无效值**。不幸的是，上面的想法并没有帮助，许多人似乎建议对一个看似很小的配置问题进行更大的删除/重新安装操作。

不幸的是，在给定的错误状态下，Eclipse（版本：Mars.2 Release (4.5.2)）不允许使用 GUI 来纠正问题……所以我接下来做了什么。

我发现标记为： 在**{workspace}/{project}/.settings**`<wb-resource .... />`文件夹中的**xml 文件 org.eclipse.wst.common.component**中的条目有 wb 资源的不完整条目。我需要在其中包含类似的内容：

 **```
<wb-resource deploy-path="/" source-path="/web" tag="defaultRootSource"/>
<wb-resource deploy-path="/WEB-INF/classes" source-path="/src"/> 
```

wegb-row 不完整，src-containing-row 完全丢失。该文件/位置已被定位并在早期答案中被识别为可能损坏/无效。修复这个文件并没有让我得到 GUI 工作。接下来，我必须从插件历史记录中删除几行。

在**{workspace}/.metadata/.plugins/org.eclipse.core.resources/.history** -folder 中，我找到了*最新的文件夹*并**删除了包含与*Deployment Assembly***相关的更改的文件夹。

在此重新启动 Eclipse 之后，我可以再次使用 GUI 进行配置！**我不需要删除/重新安装项目**（我想避免由于大量配置而重新安装项目）。我希望这可以帮助其他人遇到相同的错误消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-07T13:28:43.837

删除 .project .classpath 和 .settings 然后清理一个新的（临时）工作区，将您的项目导入新的工作区，这将生成新的 .project .classpath 和 .settings 文件。然后再次打开旧工作区并修复问题。如果不需要，可以删除临时工作区

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-26T20:29:46.253

添加：

```
--launcher.GTK_version
2 
```

eclipse.ini 在 Fedora 33 GNOME 上为我解决了问题

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-26T06:40:23.180

请检查 .settings 文件夹下的此文件“.settings/org.eclipse.wst.common.component”，该文件映射到 UI 中的部署程序集。请检查“wb-module”标签并清理其中的 wb-resource 项如果存在。

此文件将在 Eclipse 的导航器视图中可见

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-01-15T17:11:31.677

我遇到了同样的问题，我意识到它是在我将某个旧插件安装到我的 Neon.1a Eclipse 中后开始的，该插件针对版本 3.x。

所以我卸载了那个插件，问题就消失了，没有改变我的工作区。

（为了完成信息，我会说“罪魁祸首”是 Randalco EHP 插件，但我想任何旧版本的插件也可能是可疑的）。**

# python - 发送响应并关闭连接后的金字塔回调

> ID：14270452
> 
> 赞同：0
> 
> 时间：2013-01-11T01:56:47.003
> 
> 标签：python, heroku, callback, wsgi, pyramid

我需要 Pyramid 中的回调，该回调将在发送响应并关闭与客户端的连接后执行。

我知道[完成的回调](http://docs.pylonsproject.org/projects/pyramid/en/master/narr/hooks.html#using-finished-callbacks)。然而，这不是我想要的。在连接关闭之前评估完成的回调（据我所知）。

有什么线索吗？我需要它来发送电子邮件而不会造成几秒钟的延迟。通常我应该使用像芹菜这样的东西，我猜。但是，我买不起 Heroku 的后台工作人员。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:09:32.607

我的理解是，WSGI 应用程序基本上是一个 Python 函数，它接收一组参数并*返回*代表 HTTP 响应的文本块。该 blob 可能会传递给 WSGI 管道中的一些过滤器，这些过滤器也只是函数，之后 Web 服务器将响应发送给客户端并关闭连接。来自[维基百科的文章](http://en.wikipedia.org/wiki/Web_Server_Gateway_Interface)：

```
def application(environ, start_response):
    start_response('200 OK', [('Content-Type', 'text/plain')])
    yield 'Hello World\n' 
```

由于 Pyramid 是一个 WSGI 应用程序，您可以看到连接关闭之类的事情很可能发生在其影响范围之外。

在您的情况下，如果您不能/不想使用现有解决方案（如 Chris McDonough 所建议的那样，处于队列模式的 pyramid_mailer），我会考虑拥有一个后台[线程](http://docs.python.org/2/library/threading.html#thread-objects)，每隔几秒从[队列](http://docs.python.org/2/library/queue.html#module-Queue)中读取数据并发送电子邮件。然后您的视图代码只是将数据放入队列并愉快地返回，而工作线程则发送电子邮件。

# jquery - 使用 jquery 在分页文本周围环绕一个跨度

> ID：14270455
> 
> 赞同：1
> 
> 时间：2013-01-11T01:56:55.520
> 
> 标签：jquery

由于我们的 CMS，我有这个我无法编辑的 HTML 结构，正如您所见，它缺少一个类/跨度，因此很难设置活动页面的样式，即“5”。同时，当最后一个分页处于活动状态时，结束人字形被删除，即“7”。

有人可以提供一个 jquery 解决方案来`<span></span>`在“5”处于活动状态时以及最后一个分页处于活动状态时（即“7”）环绕它，所以我可以设置它的样式吗？

1.  活动页面将根据所选数字增加/减少，因此它并不总是需要跨度的“5”和“7”。
2.  jquery 不应触及同一 div 块中存在的摘要“xx 记录/每页 xx 条记录/x 页”。
3.  单击最后一个分页，即 7 时，V 形将被删除，活动数字位于摘要旁边。这种孤立的分页需要 span 标签而不影响摘要。

这是我提供演示的小提琴：http: [//jsfiddle.net/evanmoore/yay9W/](http://jsfiddle.net/evanmoore/yay9W/)

示例 1：

```
<div class="pag">
    <a class="prev" href="http://www.example.com">‹‹&lt;/a>
    <a href="http://www.example.com">1</a>
    <a href="http://www.example.com">2</a>
    <a href="http://www.example.com">3</a>
    <a href="http://www.example.com">4</a>
    5
    <a href="http://www.example.com">6</a>
    <a href="http://www.example.com">7</a>
    <a class="prev" href="http://www.example.com">››&lt;/a>
    xx records / xx records per page / x pages 
</div> 
```

示例 2：那么最后一个分页是否处于活动状态，在本例中为 7，html 如下所示：

```
<div class="pag">
    <a class="prev" href="http://www.example.com">‹‹&lt;/a>
    <a href="http://www.example.com">1</a>
    <a href="http://www.example.com">2</a>
    <a href="http://www.example.com">3</a>
    <a href="http://www.example.com">4</a>
    <a href="http://www.example.com">5</a>
    <a href="http://www.example.com">6</a>
    7 xx records / xx records per page / x pages 
</div> 
```

这是我提供演示的小提琴：http: [//jsfiddle.net/evanmoore/bqyYA/](http://jsfiddle.net/evanmoore/bqyYA/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T02:23:48.160

假设我们想要包装除最后一个（包含您的摘要）之外的文本节点的任何内容，这应该有效：

```
$('div.pag').contents(':not(:last-child)').filter(function() {
  return this.nodeType == 3;
})
.wrap('<span></span>') 
```

.contents 函数类似于 .children 函数，不同之处在于它也返回文本节点。过滤器检查文本节点类型。添加的过滤器会跳过最后一个子节点。

这是演示：

[http://jsfiddle.net/36Wwt/](http://jsfiddle.net/36Wwt/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T02:37:38.267

这应该适用于大多数情况。

上述解决方案在许多情况下都不起作用，例如我在此处粘贴的小提琴中的标记

```
var elms = $('.pag').contents().filter(function () {
  return this.nodeType === 3 && $.trim(this.nodeValue) != '';
});

elms.each(function () {
  var num = Number(this.nodeValue);
  if (!isNaN(num)) {
    this.nodeValue = num;
    $(this).wrap('<span class="lonerPage"></span>');
  }
}); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/yay9W/1/)**

# java - 树结构的复制构造函数偶尔会删除叶子

> ID：14270456
> 
> 赞同：0
> 
> 时间：2013-01-11T01:57:00.003
> 
> 标签：java, tree, copy, copy-constructor

我有一个树状结构，我的复制构造函数似乎偶尔会丢弃我的一些“叶子”。

基本结构：

```
public class Arrow {
   ArrayList<Arrow> subArrows;
   Interval start;
   Interval end;
} 
```

复制构造函数：

```
public Arrow(Arrow other) {
    this.start = new Interval(other.start);
    this.end = new Interval(other.end);
    if (other.subArrows != null) {
        this.subArrows = new ArrayList<Arrow>();
        for (Arrow sub : other.subArrows) {
            this.subArrows.add(new Arrow(sub));
        }
    } else {
        this.subArrows = new ArrayList<Arrow>();
    }
} 
```

我希望这基本上可以对我的树结构进行深度复制。相反，我偶尔会发现我的一个`subArrows`数组是空的。除了它们往往位于我的树的最低“级别”之外，我没有注意到其他模式。

有任何想法吗？好久没用java了。

编辑：有几个人要求更多代码，所以这里是所有触及 subArrows 的地方。这是来自一个相当大的算法/数据结构，因此将其全部发布是不合理的。

递归获取所有子箭头并返回一组。

```
Set<Arrow> allSubArrows(Arrow arrow) {
    Set<Arrow> arrowSet = new HashSet<Arrow>();
    if (arrow.subArrows != null && arrow.subArrows.size() > 0) {
        for (Arrow sub : arrow.subArrows) {
            arrowSet.addAll(allSubArrows(sub));
        }
        return arrowSet;
    } else {
        arrowSet.add(arrow);
        return arrowSet;
    }
} 
```

这背后的数学原因，但 subArrows 在底部修改：

```
void enforceMonotonicity(Arrow arrow) {
    boolean changed = false;
    if (arrow.end != null && arrow.start != null) {
        if (arrow.start.isParallelTo(arrow.end)) {
            //either left to right or bottom to top
            if (arrow.start.isVertical()) {
                //left interval pointing to right interval
                if (arrow.start.startGraph.y > arrow.end.startGraph.y) {
                    arrow.end.startGraph.y = arrow.start.startGraph.y;
                    changed = true;
                }
                if (arrow.end.endGraph.y < arrow.start.endGraph.y) {
                    arrow.start.endGraph.y = arrow.end.endGraph.y;
                    changed = true;
                }
            } else {
                //bottom interval pointing to top interval
                if (arrow.start.startGraph.x > arrow.end.startGraph.x) {
                    arrow.end.startGraph.x = arrow.start.startGraph.x;
                    changed = true;
                }
                if (arrow.end.endGraph.x < arrow.start.endGraph.x) {
                    arrow.start.endGraph.x = arrow.end.endGraph.x;
                    changed = true;
                }
            }
        }
    }
    if (changed) {
        //check to make sure SOMETHING is still reachable, if not arrow = null
        if (arrow.start.isVertical()) {
            if (arrow.start.startGraph.y >= arrow.start.endGraph.y ||
                    arrow.end.startGraph.y >= arrow.end.endGraph.y) {
                arrow = null;
            }
        } else {
            if (arrow.start.startGraph.x >= arrow.start.endGraph.x ||
                    arrow.end.startGraph.x >= arrow.end.endGraph.x) {
                arrow = null;
            }
        }
        //if we changed the outer arrows, we need to recursively change the subarrows
        if (arrow != null && arrow.subArrows != null && arrow.subArrows.size() > 0) {
            for (Arrow sub : arrow.subArrows) {
                enforceMonotonicity(sub);
            }
        }
    }
} 
```

合并算法的一部分：

```
HashSet<Arrow> mergeCells(Set<Arrow> first, Set<Arrow> second) {
    HashSet<Arrow> mergedCell = new HashSet<Arrow>();
    //loop through arrows in adjacent cells and find the ones that connect
    for (Arrow topArrow : first) {
        for (Arrow bottomArrow : second) {
            if(topArrow.start.intersects(bottomArrow.end)) {
                //merge arrows
                Interval middle = topArrow.start.intersection(bottomArrow.end);
                Arrow newArrow = new Arrow();
                if (middle != null) {
                    //if they connect, we copy the two arrows, modify their connection,
                    //create a new arrow with the constituents as subarrows, and add that to the mergedcell
                    //after the mergedcell is created, we can delete the base arrows
                    Arrow topCopy = new Arrow(topArrow);
                    topCopy.start = middle;
                    Arrow bottomCopy = new Arrow(bottomArrow);
                    bottomCopy.end = middle;

                    newArrow.subArrows.add(topCopy);
                    newArrow.subArrows.add(bottomCopy);
                    newArrow.start = bottomCopy.start;
                    newArrow.end = topCopy.end;

                    //if end and middle are parallel, we need to project monotonicity
                    //monotonicity is already enforced within a single cell
                    //and enforcemonotonicity knows whether or not start and end are parallel
                    enforceMonotonicity(newArrow);
                }
                //enforceMonotonicity could null out the new arrow
                if (newArrow != null && !newArrow.isNull()) {
                    mergedCell.add(newArrow);
                }
            }
        }
    }

    //keep the originals in case they can connect later on
    //(hashset doesn't allow duplicates, so no need to worry here)
    mergedCell.addAll(first);
    mergedCell.addAll(second);

    return mergedCell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:58:03.337

何时，您的`(other.subArrows == null)`代码仍由`this.subArrows`. `new ArrayList<Arrow>()`这不是一个真正的克隆（一个是`null`，另一个不是）。如果要确保 subArrow 始终为非空（这有助于在不检查的情况下添加 subArrow `null`），您可以在字段定义中实例化它。

如果这仍然不起作用，您可能需要显示更多代码，因为我们不知道如何在箭头中添加子箭头。另外，如果你的代码是在多线程环境下，而且bug很难重现，可能是同步问题。请注意，这`ArrayList`不是线程安全的。尝试`Vector`或`Collections.synchronizedList`代替，或正确同步关键块。同样，我们没有您的相关代码。

顺便说一句，声明`List<Arrow> subArrows`比`ArrayList<Arrow> subArrows`.

# asp.net-mvc - Visual Studio 2010 - 与按钮关联的事件未在智能感知中显示

> ID：14270458
> 
> 赞同：1
> 
> 时间：2013-01-11T01:57:05.987
> 
> 标签：asp.net-mvc, vb.net, intellisense

我是 Visual Studio 2010 的新手，我已经处于黑暗时代（2005 年）很长时间了。看来我不能只将“单击”事件与任何类型的服务器端按钮相关联。我看不到按钮的任何“事件”类型（没有检查其他控件类型，但假设相同。

我看到以下内容： OnClientClick，但没有“Click”或“OnClick”命令，但没有“OnCommand”

奇怪，但我确定这是我不知道的一些配置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:05:51.570

我认为您从错误的角度看待 MVC 项目。asp.net mvc 框架中没有按钮单击事件。你所拥有的是`ActionResults`链接。

但是，如果您想在视图上放置一个按钮标签，则 throw`JavaScript`您可以模拟该事件。

```
$('#buttonId').click(function(){
   document.location = '@Url.Action("MyAction","MyController")';
}); 
```

如果您的**按钮在您发布的表单**中，请使用以下命令：

```
<% using(Html.BeginForm("Create", "Home")) {%> 
```

**解决方案#2：**对于这种情况，如果您的 MVC 视图中有多个按钮，则使用本文作为一种方法：[ASP.NET MVC – 同一表单中的多个按钮](http://weblogs.asp.net/dfindley/archive/2009/05/31/asp-net-mvc-multiple-buttons-in-the-same-form.aspx)

# c# - 正则表达式检查字符串的第二个字母

> ID：14270460
> 
> 赞同：2
> 
> 时间：2013-01-11T01:57:46.160
> 
> 标签：c#, regex

我有一个有趣的小任务。如果出现以下情况，我需要将变量设置为 true：

字符串以字母结尾或字符串中的第二个数字是“p”或“r”。

到目前为止，我有

```
var endingIsLetter = Regex.(myString.length - 1) ??? magic here. 
```

有什么帮助吗？我的正则表达式伙伴在一台死机的笔记本电脑上。

编辑——不需要正则表达式。我只是认为这将是完成这项工作的最简单方法。欢迎任何例子。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T01:59:54.567

为什么要为此使用正则表达式？

```
var flag = char.IsLetter(s[s.Length - 1]) || 
           s[1] == 'p' || 
           s[1] == 'r'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T02:00:47.567

回想一下，`.`表示单个字符，`^`是字符串开头的`$`锚点，是字符串结尾的锚点，并且`[pr]`是方括号之间列表中的任何单个字符。

```
^.[pr] 
```

意思是“第二个字母是`p`or `r`。

```
[A-Za-z]$ 
```

意思是“最后一个字符是一个字母”。

```
Console.WriteLine(Regex.IsMatch("abc123", "^.[pr]|[A-Za-z]$")); // False
Console.WriteLine(Regex.IsMatch("abc12x", "^.[pr]|[A-Za-z]$")); // True
Console.WriteLine(Regex.IsMatch("apc123", "^.[pr]|[A-Za-z]$")); // True
Console.WriteLine(Regex.IsMatch("arc123", "^.[pr]|[A-Za-z]$")); // True
Console.WriteLine(Regex.IsMatch("", "^.[pr]|[A-Za-z]$"));       // False 
```

[ideone 上的演示](http://ideone.com/clone/hPI9AD)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-11T02:03:41.750

你必须使用正则表达式？还是这是可选的？因为没有正则表达式的代码实际上可能更快。:)

匹配字符串中的第二个字符：`^.[pr]` 匹配字符串中的最后一个字符：`[a-z]$`

结合：`^.[pr]|[a-z]$`

*   `^`匹配字符串的开头
*   `$`匹配字符串的结尾
*   `.`匹配任何字符（根据您的设置，换行符除外）
*   `[...]`提供选择“其中任何一个”，您也可以在其中定义范围
*   `[a-z]``a`表示从范围到的任何字符`z`。请注意，这不**包括**变音符号之类的东西。

请注意，上面的正则表达式需要不区分大小写的匹配才能正常工作（否则您还必须添加大写字符）：`^.[PRpr]|[A-Za-z]$`

为了快速预览正则表达式（如果我不确定），我更喜欢[Regex Hero Tester](http://regexhero.net/tester/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T02:15:36.810

```
var match = Regex.Matches( @"\w(p|r)+*\w", "Eppressio9n" ) 
```

啊，我只是突然间做了这件事，因为我现在必须去上班。

我忘记了 Regex.Matches 返回的内容，您所要做的就是检查是否有任何从 Regex.Matches 返回的内容。

希望这可以帮助

# c# - 如何获得 IE 进入/进入键？

> ID：14270466
> 
> 赞同：1
> 
> 时间：2013-01-11T01:58:09.417
> 
> 标签：c#, visual-studio-2010, windows-phone-7

如何更改我的应用程序键盘上的回车键，使其看起来像这样：我必须导入它们的东西吗？

![来自 IE 的密钥](../Images/64c00da6c0a19e4ba4b16d5260aaf9e1.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:16:05.913

在 Windows Phone 设备上，这是键盘查找具有 URL 输入范围的文本框的方式。

[http://msdn.microsoft.com/en-us/library/system.windows.input.inputscopenamevalue%28VS.96%29.aspx](http://msdn.microsoft.com/en-us/library/system.windows.input.inputscopenamevalue%28VS.96%29.aspx)

在您的 XAML 中，您可以简单地设置您的 URL 范围

`<TextBox InputScope="Url">`

例如，请参阅： http: [//www.jeffblankenburg.com/2010/10/10/31-days-of-windows-phone-day-10-inputscope-textboxes/](http://www.jeffblankenburg.com/2010/10/10/31-days-of-windows-phone-day-10-inputscope-textboxes/)

# jquery - jQuery Callback 函数不会取 function() 的名称，必须有一个匿名函数

> ID：14270467
> 
> 赞同：5
> 
> 时间：2013-01-11T01:58:11.767
> 
> 标签：jquery, jquery-callback

这有效：

```
$("#formbottom").slideUp(speed,'swing',function(){
    openSubmitting();
}); 
```

这不会：

```
$("#formbottom").slideUp(speed,'swing',
    openSubmitting()
); 
```

当您有回调时，您是否总是必须在其中有一个匿名函数？不能只放你要调用的函数吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-11T01:59:45.963

`openSubmitting()`调用你的函数。你不想要你的函数的结果。您想要您的*实际*功能，这就是您编写`function() {...}`而不是`(function() {...})()`.

由于您想传递对函数的引用，请删除这些括号：

```
$("#formbottom").slideUp(speed,'swing',
    openSubmitting
); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-11T01:59:17.947

你试过`jQuery("#formbottom").slideUp(speed,'swing',openSubmitting);`吗？

# c# - try catch 块外的变量失去价值

> ID：14270470
> 
> 赞同：-6
> 
> 时间：2013-01-11T01:58:54.030
> 
> 标签：c#, .net

我有一个小问题。我有一个函数，它在 try-catch-finally 块之外有一个字符串，该函数会根据块内发生的情况而改变。完成后，我想显示它。我的问题是块中更改的值返回到它的原始值。我怎样才能解决这个问题？

```
string error = "No issues";

try{
    error = "Correct";
}catch(Exception ex){
    error = "Wrong:" + ex.Message.ToString();
}finally{
    // Closes connection
}

MessageBox.Show(error); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:11:46.497

我不清楚是否在方法之外声明了有问题的字符串。如果您 100% 确定为字符串赋予了新值，则以下代码可能会解决您遇到的问题：

```
static void Foo(string s)
{
    try
    {
        s = "OK";
    }
    catch { }
}

static void Main(string[] args)
{
    string temp = "??";
    Foo(temp);
    Console.WriteLine(temp); //prints ??
    Console.ReadLine();
} 
```

当您按值传递字符串时。如果您需要更改该值，您应该：

做一个`ref`参数：

```
static void Foo(ref string s) 
```

并称之为

```
Foo(ref temp); 
```

或从方法返回新值：

```
 static string Foo(string s)
    {
        try
        {
            s = "OK";
        }
        catch { }
        return s;
    } 
```

并称之为：

```
temp = Foo(temp); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T03:36:18.907

您发布的代码将显示一个带有文本的消息框

> 正确的

如果没有抛出异常，否则消息

> 错误：（加上异常的消息属性）

它永远不会显示消息

> 没有问题

`error`因为您覆盖了try 块第一行中的初始值。

`error`给定您发布的代码，永远不会*丢失*一个值（就像我猜变成*null ）。*最终*错误*将超出范围（例如，当您退出定义此代码的方法时）。

**更新**

我拿了你的代码，创建了一个全新的 WinForms 项目，双击 Form1 以创建一个 Load 事件处理程序，并在你的代码中发布如下：

```
 private void Form1_Load(object sender, EventArgs e)
    {
        string error = "No issues";

        try
        {
            error = "Correct";
        }
        catch (Exception ex)
        {
            error = "Wrong:" + ex.Message.ToString();
        }
        finally
        {
            // Closes connection
        }

        MessageBox.Show(error);
    } 
```

结果是一个显示“正确”的消息框。

如果这不是您在真实代码中看到的，那么您没有共享足够的代码来重现问题。

# c++ - for_each 和变换

> ID：14270475
> 
> 赞同：2
> 
> 时间：2013-01-11T01:59:52.677
> 
> 标签：c++, algorithm, c++11, lambda

```
for_each(ivec.begin(),ivec.end(),
        []( int& a)->void{ a = a < 0 ? -a : a; 
    });

transform(ivec.begin(),ivec.end(),ivec.begin(),
        [](int a){return a < 0 ? -a : a;
    }); 
```

我目前正在学习 lambda，我很好奇我在上面发布的两个实现有何不同？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T02:04:32.073

您展示的两个实现在逻辑上没有区别（假设您通过添加返回获得了第一个版本）。第一个修改元素，而最后一个用新值覆盖其元素。

我看到的最大区别是，`transform`你可以通过`abs`而不是重新实现它的 lambda。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-11T02:02:58.047

`transform`是什么，在函数式语言中，被称为`map`. 也就是说，它将函数应用于输入范围中的每个元素，并将输出存储到输出范围中。（因此通常不打算修改输入，而是存储一系列输出）

`for_each`只是丢弃应用函数的返回值（因此它可能会修改输入）。

这是主要的区别。它们是相似的，但设计用于不同的目的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-11T02:04:30.563

第一个版本：

```
for_each(ivec.begin(),ivec.end(),
      []( int& a)->void{ a = a < 0 ? -a : a; 
}); 
```

通过调用 lambda 函数工作

```
 []( int& a)->void{ a = a < 0 ? -a : a; } 
```

范围内的每个元素一次，将范围内的元素作为参数传递。因此，它通过直接更改元素的值来就地更新元素。

第二个版本：

```
transform(ivec.begin(),ivec.end(),ivec.begin(),
    [](int a){return a < 0 ? -a : a;
}); 
```

通过应用 lambda 函数工作

```
[](int a){return a < 0 ? -a : a;} 
```

`ivec.begin()`to 范围内的每个元素`ivec.end()`，生成一系列值，然后将这些值写回从 开始的范围`ivec.begin()`。这意味着它使用通过将函数应用于每个数组元素而产生的值范围覆盖范围的原始内容，因此元素被覆盖而不是就地修改。不过，净效果与原始效果相同`for_each`。

希望这可以帮助！

# c++ - 如何修复简单 C++ 应用程序中的“标识符未定义”错误？

> ID：14270478
> 
> 赞同：-2
> 
> 时间：2013-01-11T01:59:53.190
> 
> 标签：c++, undefined, message, identifier

我到处搜索，但无济于事。有人可以告诉我这段代码有什么问题吗？它给了我“错误：标识符“XXX”未定义”

```
 #include <windows.h>
int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance,
    LPSTR lpCmdLine, int nCmdShow)
{
    MSG msg;
    MyRegisterClass(hInstance);
    if(!InitInstance (hInstance, nCmdShow))
        return false;
    while (GetMessage(&msg, NULL, 0, 0))
    {
        TranslateMessage(&msg);
        DispatchMessage(&msg);
    }
    return msg.wParam;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:15:48.157

Windows.h 中没有 MyRegisterClass 和 InitInstance 全局函数

# jquery - 导航栏变成滚动条

> ID：14270481
> 
> 赞同：0
> 
> 时间：2013-01-11T02:00:02.660
> 
> 标签：jquery, html, css

导航栏下拉菜单大于顶部的标题空间。我的预期设计是让下拉导航继续浏览下面的内容，但它在顶部有自己的滚动条？

容器的溢出设置为自动。

任何帮助将不胜感激乔治

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:50:44.110

您可能对盒子模型有疑问。由于一切似乎都在溢出：自动问题通常是计算的宽度太高。

在您提供的小提琴中，导航下拉菜单对我根本不起作用。尝试摆弄容器的宽度。这是一个盒子模型修复尝试：

```
 * {
     box-sizing:border-box;
     -moz-box-sizing:border-box;
     webkit-box-sizing:border-box;
     max-width:100%; 
    } 
```

如果一切都失败了，请节省一些时间并使用预制的 jQuery 下拉菜单。有很多列表，例如“35 个最佳 jQuery 菜单”等，其中之一可能适合您的需求，让您不必考虑案例和查找错误。

# php - MongoDb PHP 驱动程序 - 使用 readPreference 聚合查询？

> ID：14270485
> 
> 赞同：1
> 
> 时间：2013-01-11T02:00:56.030
> 
> 标签：php, mongodb, master-slave, aggregation-framework

使用 php 驱动程序 1.3.2 和 mongodb 2.2，我尝试使用 readPreference 将聚合查询定向到我的副本集中的辅助节点之一。似乎无论我尝试什么，聚合查询都是在主服务器上执行的。

基本示例：

```
$db = new \MongoClient('rs1.example:27017,rs2.example:27017,rs3.example:27017', array('replicaSet' => 'myRs') );
$db->setReadPreference( \MongoClient::RP_SECONDARY );
$results = $db->tracking->sessions->aggregate( array( ... ) ); 
```

我启用`MongoLog`并得到以下结果：

聚合方法显示：`REPLSET INFO: - connection: type: PRIMARY`

如果我改用 find ，它会显示：`REPLSET INFO: - connection: type: SECONDARY`

这是php驱动程序的错误吗？还有其他人遇到这个吗？以为我会在将其作为错误添加到他们的 Jira 之前将其扔到 SO 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T01:19:08.730

通过 PHP 驱动程序的所有命令查询当前都定向到主服务器。我们有几张与此相关的旧票证，它们源于将计数命令定向到辅助节点的请求，但这是一个不平凡的更改，需要根据白名单检查命令以确保它是只读的。当前跟踪此修复的票证是[PHP-535](https://jira.mongodb.org/browse/PHP-535)，我将其链接到您打开的问题[PHP-662](https://jira.mongodb.org/browse/PHP-662)。

如果您需要立即解决，您可以直接调用`find()`该`$cmd`集合，将`$command`您通常作为参数传递给的相同数组参数传递[`MongoDB::command()`](http://php.net/manual/en/mongodb.command.php)给`find()`. Kristina 在[此 JIRA 评论](https://jira.mongodb.org/browse/PHP-310?focusedCommentId=82665&page=com.atlassian.jira.plugin.system.issuetabpanels%3acomment-tabpanel#comment-82665)中记录了此解决方案，尽管她`slaveOkay()`在该示例中使用了该解决方案，但它也应与读取首选项一起使用。

# semantic-web - 带有 schema.org 微数据的楼层号？

> ID：14270488
> 
> 赞同：1
> 
> 时间：2013-01-11T02:01:02.800
> 
> 标签：semantic-web, semantic-markup, street-address, microdata, postal-code

知道如何使用[schema.org](http://schema.org/PostalAddress)微数据为当地企业的邮政地址标记楼层号码吗？

```
<div itemscope itemtype="http://schema.org/LocalBusiness">
    <span itemprop="legalName">Company Limited</span>
    <div itemprop="address" itemscope itemtype="http://schema.org/PostalAddress">
        <div itemprop="streetAddress">Billy Street 100</div>
        <div>10th Floor</div>
        <div><span itemprop="addressLocality">Paris</span>, 
                <span itemprop="addressRegion">TX</span> 
                <span itemprop="postalCode">75462</span></div>
        <div itemprop="addressCountry">United States</div>
    </div>
</div> 
```

另外，上面的标记是语义的吗？

如果没有楼层号，我应该使用[RDFa](http://manu.sporny.org/2011/uber-comparison-rdfa-md-uf/)吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:17:00.860

不幸的是，schema.org 没有二级地址线的属性，这是楼层号所在的位置。postOfficeBoxNumber 尽可能接近，但看起来它是专门为 PO Box *numbers*保留的，而不是包含 PO Box 的整行。

`<br>`也许您可以使用标签将楼层号放在 streetAddress 中的新行上。

虽然我对街道地址了解很多（我在 SmartyStreets 工作），但我不是微数据专家：但据我所知，是的，标记对我来说看起来不错。

如果您愿意，您也可以使用 RDFa：[Google 支持它](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=146898)的丰富网页摘要。或者你可以有一些乐趣并根据你的需要[扩展 schema.org](http://www.schema.org/docs/extension.html)。

# php - AJAX 将西里尔字母转换为某种编码

> ID：14270491
> 
> 赞同：3
> 
> 时间：2013-01-11T02:01:07.763
> 
> 标签：php, ajax, encoding

我有个问题。提交表单后，我使用 AJAX 发送请求。在我尝试西里尔文字之前，一切都很完美。

我输入的内容：`питання`

什么提醒我 javascript：`питання`

什么呼应了我 $_POST['question']：`%u041F%u0438%u0442%u0430%u043D%u043D%u044F`

这是我的 AJAX 请求：

```
$.ajax({
        type: "POST",
        url: "addQuestion.php",
        data: "u_id=" + $("#u_id").val() + "&u_a_name=" + $("#u_a_name").val() + "&question="+escape($("#question_input").val()),
        success: function(data) {
                if (data == "Asked") {
                alert("Asked");
                window.location.reload();
            } else {
                alert(data);
            }
        }
    }); 
```

所以我认为这是 AJAX 问题，但我还没有在互联网上找到答案。感谢您的关注。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T02:13:08.630

Javascript`escape()`不能很好地处理非 ASCII 字符，并且无法处理我通常使用的任何 unicode 字符`encodeURIComponent()`。在 PHP 中，您可以使用`urldecode()`反转相同的编码。所以：

Javascript：`encodeURIComponent("питання")`返回`%D0%BF%D0%B8%D1%82%D0%B0%D0%BD%D0%BD%D1%8F`

PHP：`urldecode("%D0%BF%D0%B8%D1%82%D0%B0%D0%BD%D0%BD%D1%8F");`返回`питання`

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/encodeURIComponent](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/encodeURIComponent)

[http://php.net/manual/en/function.urldecode.php](http://php.net/manual/en/function.urldecode.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T10:31:33.483

`escape`使用非标准 URL 编码，根本不应该使用。

无论如何，使用 jQuery，您不会将数据作为字符串而是作为对象，让 jQuery 对其进行格式化和编码：

```
$.ajax({
        type: "POST",
        url: "addQuestion.php",
        data: {
            u_id: $("#u_id").val(),
            u_a_name: $("#u_a_name").val(),
            question: $("#question_input").val()

        },

        success: function(data) {
                if (data == "Asked") {
                alert("Asked");
                window.location.reload();
            } else {
                alert(data);
            }
        }
}); 
```

更清洁，更容易。

# objective-c - Sublassing NSImageRep 以支持新的文件格式 (pgm)

> ID：14270496
> 
> 赞同：1
> 
> 时间：2013-01-11T02:01:37.287
> 
> 标签：objective-c, cocoa, nsimage, pgm

大家好！这是我在这里的第一篇文章。

我在objective-c方面很新，所以也许我的问题并不难，但这对我来说是个问题。我在网上搜索并没有找到任何对我有用的提示......我正在 Xcode 中用 Objective-c 编写一个程序。我需要读取并显示一个[pgm](http://netpbm.sourceforge.net/doc/pgm.html)文件（P5，每个像素两个字节）。为此，我正在尝试子类化`NSImageRep`，但我不知道如何为该文件创建正确的位图以及如何绘制它。到目前为止，以下是我的代码：

标题：

```
@interface CTPWTPGMImageRep : NSImageRep

@property (readonly)NSInteger width;
@property (readonly)NSInteger height;
@property (readonly)NSInteger maxValue;

+ (void)load;
+ (NSArray *)imageUnfilteredTypes;
+ (NSArray *)imageUnfilteredFileTypes;
+ (BOOL)canInitWithData:(NSData *)data;
+ (id)imageRepWithContentsOfFile:(NSString*)file;
+ (id)imageRepWithData:(NSData*)pgmData;

- (id)initWithData:(NSData *)data;
- (BOOL)draw;

@end 
```

和实施：

```
#import "CTPWTPGMImageRep.h"

@implementation CTPWTPGMImageRep

@synthesize width;
@synthesize height;
@synthesize maxValue;

#pragma mark - class methods
+(void) load
{
    NSLog(@"Called 'load' method for CTPWTPGMImageRep");
    [NSImageRep registerImageRepClass:[CTPWTPGMImageRep class]];
}

+ (NSArray *)imageUnfilteredTypes
{    
    // This is a UTI
    NSLog(@"imageUnfilteredTypes called");
    static NSArray *types = nil;
    if (!types) {
        types = [[NSArray alloc] initWithObjects:@"public.unix-executable", @"public.data", @"public.item", @"public.executable", nil];
    }

    return types;
}

+ (NSArray *)imageUnfilteredFileTypes
{
    // This is a filename suffix
    NSLog(@"imageUnfilteredFileTypes called");

    static NSArray *types = nil;
    if (!types)
        types = [[NSArray alloc] initWithObjects:@"pgm", @"PGM", nil];
    return types;
}

+ (BOOL)canInitWithData:(NSData *)data;
{
    // FIX IT
    NSLog(@"canInitWithData called");
    if ([data length] >= 2) // First two bytes for magic number magic number
    {
        NSString *magicNumber = @"P5";
        const unsigned char *mNum = (const unsigned char *)[magicNumber UTF8String];
        unsigned char aBuffer[2];
        [data getBytes:aBuffer length:2];
        if(memcmp(mNum, aBuffer, 2) == 0)
        {
            NSLog(@"canInitWithData: YES");
            return YES;
        }
    }
    NSLog(@"canInitWithData: NO");

    // end
    return NO;
}

+ (id)imageRepWithContentsOfFile:(NSString*)file {
    NSLog(@"imageRepWithContentsOfFile called");
    NSData* data = [NSData dataWithContentsOfFile:file];
    if (data)
        return [CTPWTPGMImageRep imageRepWithData:data];
    return nil;
 }

+ (id)imageRepWithData:(NSData*)pgmData {
    NSLog(@"imageRepWithData called");
    return [[self alloc] initWithData:pgmData];
}

#pragma mark - instance methods

- (id)initWithData:(NSData *)data;
{
    NSLog(@"initWithData called");
    self = [super init];

    if (!self)
    {
        return nil;
    }

    if ([data length] >= 2) {
        NSString *magicNumberP5 = @"P5";
        const unsigned char *mnP5 = (const unsigned char *)[magicNumberP5 UTF8String];
        unsigned char headerBuffer[20];
        [data getBytes:headerBuffer length:2];

        if(memcmp(mnP5, headerBuffer, 2) == 0)
        {
            NSArray *pgmParameters = [self calculatePgmParameters:data beginingByte:3];
            width = [[pgmParameters objectAtIndex:0] integerValue];
            height = [[pgmParameters objectAtIndex:1] integerValue];
            maxValue = [[pgmParameters objectAtIndex:2] integerValue];

            if (width <= 0 || height <= 0)
            {
                NSLog(@"Invalid image size: Both width and height must be > 0");
                return nil;
            }

            [self setPixelsWide:width];
            [self setPixelsHigh:height];
            [self setSize:NSMakeSize(width, height)];
            [self setColorSpaceName:NSDeviceWhiteColorSpace];
            [self setBitsPerSample:16];
            [self setAlpha:NO];
            [self setOpaque:NO];

            //What to do here?
            //CTPWTPGMImageRep *imageRep = 
              [NSBitmapImageRep alloc] initWithBitmapDataPlanes:];

            //if (imageRep) {
            /* code to populate the pixel map */
            //}
        }
        else
        {
            NSLog(@"It is not supported pgm file format.");
        }
    }
    return self;
  //return imageRep;
}

- (BOOL)draw
{
    NSLog(@"draw method1 called");
    return NO;
} 
```

有趣的是我的`canInitWithData:`方法从未被调用过。你能给我一个提示如何智能读取位图吗？我认为我需要使用`initWithBitmapDataPlanes:pixelsWide:pixelsHigh:bitsPerSample:samplesPerPixel:hasAlpha:isPlanar:colorSpaceName:bytesPerRow:bitsPerPixel:`但我不知道如何使用它。如何从我的`NSData`对象创建智能创建（无符号字符**）平面？我需要吗？

我可以使用`NSDeviceWhiteColorSpace`具有白色和 alpha 成分的吗（我不需要 alpha）

```
[self setColorSpaceName:NSDeviceWhiteColorSpace]; 
```

最困难的部分 - 我完全不知道如何实现绘图方法。有什么建议或提示吗？

预先感谢您的帮助。

**编辑：**

好的。现在我根据 NSGod 的指示实现了：

```
@implementation CTPWTPGMImageRep

//@synthesize width;
//@synthesize height;

#pragma mark - class methods

+(void) load
{
    NSLog(@"Called 'load' method for CTPWTPGMImageRep");
    [NSBitmapImageRep registerImageRepClass:[CTPWTPGMImageRep class]];
}

+ (NSArray *)imageUnfilteredTypes
{
    // This is a UTI
    NSLog(@"imageUnfilteredTypes called");
    static NSArray *types = nil;
    if (!types) {
        types = [[NSArray alloc] initWithObjects:@"public.unix-executable", @"public.data", @"public.item", @"public.executable", nil];
    }

    return types;
}

+ (NSArray *)imageUnfilteredFileTypes
{
    // This is a filename suffix
    NSLog(@"imageUnfilteredFileTypes called");

    static NSArray *types = nil;
    if (!types)
        types = [[NSArray alloc] initWithObjects:@"pgm", nil];
    return types;
}

+ (NSArray *)imageRepsWithData:(NSData *)data {
    NSLog(@"imageRepsWithData called");
    id imageRep = [[self class] imageRepWithData:data];
    return [NSArray arrayWithObject:imageRep];
}

- (id)initWithData:(NSData *)data {
    NSLog(@"initWithData called");
    CTPWTPGMImageRep *imageRep = [[self class] imageRepWithData:data];

    if (imageRep == nil) {
        return nil;
    }
    return self;
}

#pragma mark - instance methods

+ (id)imageRepWithData:(NSData *)data {
    NSLog(@"imageRepWithData called");
    if (data.length < 2) return nil;
    NSString *magicNumberP5 = @"P5";
    const unsigned char *mnP5 = (const unsigned char *)[magicNumberP5 UTF8String];
    unsigned char headerBuffer[2];
    [data getBytes:headerBuffer length:2];

    if (memcmp(mnP5, headerBuffer, 2) != 0) {
        NSLog(@"It is not supported pgm file format.");
        return nil;
    }
    NSArray *pgmParameters = [self calculatePgmParameters:data beginingByte:3];

    NSInteger width = [[pgmParameters objectAtIndex:0] integerValue];     // width in pixels
    NSInteger height = [[pgmParameters objectAtIndex:1] integerValue];    // height in pixels

    NSUInteger imageLength = width * height * 2;                          // two bytes per pixel

    // imageData contains bytes of Bitmap only. Without header

    NSData *imageData = [data subdataWithRange:
                         NSMakeRange(data.length - imageLength, imageLength)];

    CGDataProviderRef provider = CGDataProviderCreateWithCFData((CFDataRef)CFBridgingRetain(imageData));
    CGColorSpaceRef colorSpace = CGColorSpaceCreateWithName(kCGColorSpaceGenericGray); // kCGColorSpaceGenericGrayGamma2_2
    CGImageRef imageRef = CGImageCreate(width,
                                        height,
                                        16,
                                        16,
                                        width * 2,
                                        colorSpace,
                                        kCGImageAlphaNone,
                                        provider,
                                        NULL,
                                        false,
                                        kCGRenderingIntentDefault);
    CGColorSpaceRelease(colorSpace);
    CGDataProviderRelease(provider);

    if (imageRef == NULL) {
        NSLog(@"CGImageCreate() failed!");
    }
    CTPWTPGMImageRep *imageRep = [[CTPWTPGMImageRep alloc] initWithCGImage:imageRef];
    return imageRep;
} 
```

正如你所看到的，我留下了扩展值在 0-255 之间的部分，因为我的像素值在 0-65535 之间。

但它不起作用。当我从面板中选择一个 pgm 文件时，什么也没有发生。贝娄是我的 openPanel 代码：

```
- (IBAction)showOpenPanel:(id)sender
{
    NSLog(@"showPanel method called");

    __block NSOpenPanel *panel = [NSOpenPanel openPanel];
    [panel setAllowedFileTypes:[NSImage imageFileTypes]];
    [panel beginSheetModalForWindow:[pgmImageView window] completionHandler:^ (NSInteger result) {
        if (result == NSOKButton) {
            CTPWTPGMImageRep *pgmImage = [[CTPWTPGMImageRep alloc] initWithData:[NSData dataWithContentsOfURL:[panel URL]]];

            // NSLog(@"Bits per pixel: %ld",[pgmImage bitsPerPixel]); // BUG HERE!

            NSImage *image = [[NSImage alloc] init];
            [image addRepresentation:pgmImage];
            [pgmImageView setImage:image];
        }
        panel = nil; // prevent strong ref cycle
    }];
} 
```

此外，当我取消注释代码行`// NSLog(@"Bits per pixel: %ld",[pgmImage bitsPerPixel]); // BUG HERE!`只是为了检查我的 Xcode 冻结片刻，我得到 EXC_BAD_ACCESS ：

```
AppKit`__75-[NSBitmapImageRep _withoutChangingBackingPerformBlockUsingBackingCGImage:]_block_invoke_0:
0x7fff8b4823e8:  pushq  %rbp
0x7fff8b4823e9:  movq   %rsp, %rbp
0x7fff8b4823ec:  pushq  %r15
0x7fff8b4823ee:  pushq  %r14
0x7fff8b4823f0:  pushq  %r13
0x7fff8b4823f2:  pushq  %r12
0x7fff8b4823f4:  pushq  %rbx
0x7fff8b4823f5:  subq   $312, %rsp
0x7fff8b4823fc:  movq   %rsi, %rbx
0x7fff8b4823ff:  movq   %rdi, %r15
0x7fff8b482402:  movq   10625679(%rip), %rax
0x7fff8b482409:  movq   (%rax), %rax
0x7fff8b48240c:  movq   %rax, -48(%rbp)
0x7fff8b482410:  movq   %rbx, %rdi
0x7fff8b482413:  callq  0x7fff8b383148            ; BIRBackingType  //EXC_BAD_ACCESS (code=2, adress=...) 
```

有什么帮助吗？？？我不知道出了什么问题...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T08:25:46.183

它实际上比你想象的要容易得多。

首先，我建议创建`CTPWTPGMImageRep`一个`NSBitmapImageRep`而不是`NSImageRep`. 这将解决“最难”的问题，因为不需要实现自定义`draw`方法，因为`NSBitmapImageRep`我们已经知道如何绘制自己。（在 OS X 10.5 及更高版本中，`NSBitmapImageRep`基本上是 CoreGraphics`CGImageRef`的直接包装器）。

我对 PGM 格式不是很熟悉，但是您基本上要做的是以与源格式匹配的最接近的目标格式创建图像的表示。为了使用一个具体的例子，我们将使用来自 Wikipedia的[PGM 示例 FEEP 图像。](http://en.wikipedia.org/wiki/Netpbm_format#PGM_example)

```
P2
# Shows the word "FEEP" (example from Netpbm main page on PGM)
24 7
15
0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
0  3  3  3  3  0  0  7  7  7  7  0  0 11 11 11 11  0  0 15 15 15 15  0
0  3  0  0  0  0  0  7  0  0  0  0  0 11  0  0  0  0  0 15  0  0 15  0
0  3  3  3  0  0  0  7  7  7  0  0  0 11 11 11  0  0  0 15 15 15 15  0
0  3  0  0  0  0  0  7  0  0  0  0  0 11  0  0  0  0  0 15  0  0  0  0
0  3  0  0  0  0  0  7  7  7  7  0  0 11 11 11 11  0  0 15  0  0  0  0
0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 
```

![在此处输入图像描述](../Images/5719df47c09c7b2ab5c1b827861a1713.png)

能够描绘示例图像中的值的最接近的原生图像将是单通道灰度图像，每像素 8 位，无 alpha。然后计划是`CGImageRef`使用指定的设置创建一个，然后使用`NSBitmapImageRep`'`initWithCGImage:`方法来初始化自定义子类。

我将首先覆盖以下两种方法以都依赖于单数`+imageRepWithData:`：

```
+ (NSArray *)imageRepsWithData:(NSData *)data {
    id imageRep = [[self class] imageRepWithData:data];
    return [NSArray arrayWithObject:imageRep];
}

- (id)initWithData:(NSData *)data {
    CTPWTPGMImageRep *imageRep = [[self class] imageRepWithData:data];
    if (imageRep == nil) {
        [self release];
        return nil;
    }
    self = [imageRep retain];
    return self;
} 
```

`+imageRepsWithData:`对我来说，在图像能够正确加载之前，有必要实现调用奇异方法的方法。

然后我会改变单数`+imageRepWithData:`方法如下：

```
+ (id)imageRepWithData:(NSData *)data {
    if (data.length < 2) return nil;
    NSString *magicNumberP5 = @"P5";
    const unsigned char *mnP5 = (const unsigned char *)[magicNumberP5 UTF8String];
    unsigned char headerBuffer[20];
    [data getBytes:headerBuffer length:2];

    if (memcmp(mnP5, headerBuffer, 2) != 0) {
        NSLog(@"It is not supported pgm file format.");
        return nil;
    }
    NSArray *pgmParameters = [self calculatePgmParameters:data beginingByte:3];

    NSUInteger width = [[pgmParameters objectAtIndex:0] integerValue];
    NSUInteger height = [[pgmParameters objectAtIndex:1] integerValue];
    NSUInteger maxValue = [[pgmParameters objectAtIndex:2] integerValue];

    NSUInteger imageLength = width * height * 1;

    NSData *imageData = [data subdataWithRange:
                        NSMakeRange(data.length - imageLength, imageLength)];
    const UInt8 *imageDataBytes = [imageData bytes];
    UInt8 *expandedImageDataBytes = malloc(imageLength);

    for (NSUInteger i = 0; i < imageLength; i++) {
        expandedImageDataBytes[i] = 255 * (imageDataBytes[i] / (CGFloat)maxValue);
    }

    NSData *expandedImageData = [NSData dataWithBytes:expandedImageDataBytes
                                               length:imageLength];
    free(expandedImageDataBytes);
    CGDataProviderRef provider = CGDataProviderCreateWithCFData(
                                          (CFDataRef)expandedImageData);
    CGColorSpaceRef colorSpace =
             CGColorSpaceCreateWithName(kCGColorSpaceGenericGrayGamma2_2);
    CGImageRef imageRef = CGImageCreate(width,
                                        height,
                                        8,
                                        8,
                                        width * 1,
                                        colorSpace,
                                        kCGImageAlphaNone,
                                        provider,
                                        NULL,
                                        false,
                                        kCGRenderingIntentDefault);
    CGColorSpaceRelease(colorSpace);
    CGDataProviderRelease(provider);
    if (imageRef == NULL) {
        NSLog(@"CGImageCreate() failed!");
    }
    CTPWTPGMImageRep *imageRep = [[[CTPWTPGMImageRep alloc]
                                initWithCGImage:imageRef] autorelease];
    CGImageRelease(imageRef);
    return imageRep;
} 
```

如您所见，我们需要遍历原始图像中的字节并创建这些字节的第二个副本，其完整扩展范围在 0 到 255 之间。

要使用这个图像代表，你可以像下面这样调用它（一定要使用`NSImage`'s`initWithData:`方法）：

```
// if it hasn't been done already:
[NSImageRep registerImageRepClass:[CTPWTPGMImageRep class]];

NSString *path = [[NSBundle mainBundle] pathForResource:@"feep" ofType:@"pgm"];
NSData *data = [NSData dataWithContentsOfFile:path];
NSImage *image = [[[NSImage alloc] initWithData:data] autorelease];
[self.imageView setImage:image]; 
```

关于您的`+imageUnfilteredFileTypes`方法的另一个注意事项：文件扩展名不区分大小写，因此无需同时指定小写和大写`@"PGM"`，您可以只使用小写：

```
+ (NSArray *)imageUnfilteredFileTypes {
    static NSArray *types = nil;
    if (!types) types = [[NSArray alloc] initWithObjects:@"pgm", nil];
    return types;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T05:00:33.677

将像素数据简单地读入内存并[`NSBitmapImageRep`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSBitmapImageRep_Class/Reference/Reference.html)从像素数据创建一个而不是尝试专门为 .pgm 文件创建图像表示可能更容易。

# haskell - 以 `{- |` 开头的 Haskell 注释通常是什么意思？

> ID：14270500
> 
> 赞同：37
> 
> 时间：2013-01-11T02:02:04.400
> 
> 标签：haskell, haddock

`{- |`我看到Haskell多行注释有时以`{-`.

注释中以竖线字符开头是否意味着约定俗成？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-01-11T02:07:23.950

注释的开头`|`是[Haddock](http://www.haskell.org/haddock/doc/html/markup.html)语法，它开始一个文档注释。Haddock 文档中的一个示例是：

```
-- |The 'square' function squares an integer.
square :: Int -> Int
square x = x * x 
```

它还继续说

> “--|” 语法开始一个文档注释，它适用于源文件中的以下声明。请注意，注解只是 Haskell 中的注释——它会被 Haskell 编译器忽略。

# c# - 分离轴定理问题

> ID：14270501
> 
> 赞同：1
> 
> 时间：2013-01-11T02:02:18.963
> 
> 标签：c#, xna, 2d, game-physics

我目前正在尝试为轴对齐和定向边界框添加重叠测试器，但该解决方案似乎仅在 OBB 的角度在 -10 到 +10 之间时才能准确工作。当角度接近 +90 度时，碰撞区域似乎首先移动到 OBB 的右半部分，然后变得不存在。在 90 到 270 之间我无法获得重叠，然后当它围绕一个完整的 360 度时，该区域再次准确记录。

关于这个主题的任何光线都会很棒。我使用正 X 表示 0 度增加逆时针方向。

干杯。

编辑：做了更多的研究并意识到将一个向量投影到另一个向量上需要的不仅仅是一个点积。谁能给我一个正确版本的以下检查轴方法之一，非常漂亮：)

编辑2：实际上我认为应该只是一个点积，因为被投影到的向量是单位长度。

```
public static bool overlapAABB_OBB(AABB a, OBB o)
    {
        float rads = MathHelper.ToRadians(-o.angle);
        T = Vector2.Subtract(o.position, a.position);
        Ax.X = 1;
        Ax.Y = 0;
        Ay.X = 0;
        Ay.Y = 1;
        Ox.X = (float)Math.Cos(rads);
        Ox.Y = (float)Math.Sin(rads);
        Oy.X = -Ox.Y;
        Oy.Y = Ox.X;
        if (checkAX(a, o) &&
           checkAY(a, o) &&
           checkOX(a, o) &&
           checkOY(a, o))
            return true;
        else
            return false;
    }

    private static bool checkAX(AABB a, OBB o)
    {
        float TAx = Vector2.Dot(T, Ax);
        float WoOxAx = Vector2.Dot(Vector2.Multiply(Ox, o.halfWidth), Ax);
        float HoOyAx = Vector2.Dot(Vector2.Multiply(Oy, o.halfHeight), Ax);
        if (TAx > a.halfWidth + WoOxAx + HoOyAx)
            return false;
        else
            return true;
    }

    private static bool checkAY(AABB a, OBB o)
    {
        float TAy = Vector2.Dot(T, Ay);
        float WoOxAy = Vector2.Dot(Vector2.Multiply(Ox, o.halfWidth), Ay);
        float HoOyAy = Vector2.Dot(Vector2.Multiply(Oy, o.halfHeight), Ay);
        if (TAy > a.halfHeight + WoOxAy + HoOyAy)
            return false;
        else
            return true;
    }

    private static bool checkOX(AABB a, OBB o)
    {
        float TOx = Vector2.Dot(T, Ox);
        float WaAxOx = Vector2.Dot(Vector2.Multiply(Ax, a.halfWidth), Ox);
        float HaAyOx = Vector2.Dot(Vector2.Multiply(Ay, a.halfHeight), Ox);
        if (TOx > o.halfHeight + WaAxOx + HaAyOx)
            return false;
        else
            return true;
    }

    private static bool checkOY(AABB a, OBB o)
    {
        float TOy = Vector2.Dot(T, Oy);
        float WaAxOy = Vector2.Dot(Vector2.Multiply(Ax, a.halfWidth), Oy);
        float HaAyOy = Vector2.Dot(Vector2.Multiply(Ay, a.halfHeight), Oy);
        if (TOy > o.halfHeight + WaAxOy + HaAyOy)
            return false;
        else
            return true;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T16:54:19.667

我在 GameDev.stackexchange 上发布了这个问题，并从 rraallvv 收到了这个答案，它已经解决了这个问题。

当两个向量之间的角度大于 90º 时，点积为负，为了使代码正常工作，您需要取点积的绝对值。

```
//...
private static bool checkAX(AABB a, OBB o)
{
    float TAx    = Math.Abs( Vector2.Dot(T, Ax) );
    float WoOxAx = Math.Abs( Vector2.Dot(Vector2.Multiply(Ox, o.halfWidth), Ax) );
    float HoOyAx = Math.Abs( Vector2.Dot(Vector2.Multiply(Oy, o.halfHeight), Ax) );
    if (TAx > a.halfWidth + WoOxAx + HoOyAx)
        return false;
    else
        return true;
}
//... 
```

这也适用于`checkAY`、`checkOX`和`checkOY`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-17T02:57:44.763

除了 Mazk1985 提供的修复之外，checkOX() 函数中还有一个错字。o.halfHeight 应该是 o.halfWidth，如下所示：

```
private static bool checkOX(AABB a, OBB o)
{
    float TOx = Vector2.Dot(T, Ox);
    float WaAxOx = Vector2.Dot(Vector2.Multiply(Ax, a.halfWidth), Ox);
    float HaAyOx = Vector2.Dot(Vector2.Multiply(Ay, a.halfHeight), Ox);
    if (TOx > o.halfWidth + WaAxOx + HaAyOx)
        return false;
    else
        return true;
} 
```

# php - 在php中将两个数组值相乘

> ID：14270502
> 
> 赞同：-3
> 
> 时间：2013-01-11T02:02:22.213
> 
> 标签：php, arrays

我正在尝试使用以下公式将两个数组值相乘：`Qty* Price = total`每个倍数，然后是所有值的总和。

```
Array
(
[qty] => Array
    (
        [0] => .6
        [1] => .2
        [2] => .4
        [3] => .75
        [4] => 0.3
    )

[price] => Array
    (
        [0] => 1.2
        [1] => 0.5
        [2] => 0.8
        [3] => 12
        [4] => 2
    )

) 
```

我不知道该怎么做。看到几个关于它们固定值的乘法示例，即 2 或 5 等。但在我的情况下，每个数量都有不同的价格。请有人建议如何做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T02:05:02.257

只要两个数组的大小相同，以下将起作用。

```
for($i = 0; $i < count($qty); $i++) {
    $result[] = $qty[$i] * $price[$i];
} 
```

结果将在`$result`数组中。

要得到总和：

```
echo "sum(result) = " . array_sum($result) . "\n"; 
```

# c# - 从基本控制器返回后 TempData null

> ID：14270512
> 
> 赞同：0
> 
> 时间：2013-01-11T02:03:14.380
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, tempdata

TempData 在 Base 方法中填充，但在代码返回到派生控制器的方法时立即变为 null。

派生控制器编辑操作（发布）：

```
public class ManageItemsController : BaseController
{
        private BaseControllerSingle<Item, ItemViewModel> GetBaseControllerSingle()
        {
            return new BaseControllerSingle<Item, ItemViewModel>(_itemRepository, AreaName, ControllerName);
        }
...

    // POST: /InventoryMgmt/ManageItems/Edit/5
    [HttpPost]
    public ActionResult Edit(ItemViewModel ItemViewModel)
    {
        ItemViewModel = _manageItemsAppServ.SaveOrUpdate(ItemViewModel, CurrentCompanyId);

        return GetBaseControllerSingle().EditPost(
            ItemViewModel, 
            x => x.Id == ItemViewModel.Item.Id && x.CompanyId == CurrentCompanyId
        );
    } 
```

基本控制器编辑操作：

```
public class BaseControllerSingle<TRepository, TViewModelSingle> : BaseController
        where TRepository : class, IEntity, IAuditStamps, new()
        where TViewModelSingle : class, IEntity, IViewModelSingle<TRepository, TViewModelSingle>, new()
    {
        ...

        public virtual ActionResult EditPost(
        TViewModelSingle viewModel,
        Expression<Func<TRepository, bool>> predicate = null
    )
    {
        if (ModelState.IsValid)
        {
            BaseAppServSingle<TRepository, TViewModelSingle> baseAppServSingle =
                new BaseAppServSingle<TRepository, TViewModelSingle>(_repository);

            ActionConfirmation<int> result = baseAppServSingle.SaveOrUpdate(
                viewModel,
                CurrentUserId,
                predicate
            );

            TempData["message"] = result.Message;

            if (result.WasSuccessful)
            {
                return RedirectToAction("Edit", new { id = result.Value });
            }
        }

        TempData["message"] = "There is invalid data on the form.";
        return View(viewModel);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T06:25:18.900

最后我通过从基本控制器继承而不是实例化一个新实例来解决这个问题。我正在创建的新实例一定弄乱了 TempData

# dynamics-crm-2011 - 在 CRM 2011 中创建筛选子网格时，对象不支持 setParameter 方法的属性或方法

> ID：14270515
> 
> 赞同：1
> 
> 时间：2013-01-11T02:03:28.987
> 
> 标签：dynamics-crm-2011, dynamics-crm

我正在尝试在 crm 2011 中创建一个过滤的子网格。我发现以下链接描述了如何制作它：http: [//community.dynamics.com/product/crm/f/117/p/76157/140281.aspx](http://community.dynamics.com/product/crm/f/117/p/76157/140281.aspx)

这是建议构建代码的方式：

```
var relatedOHSOrders = document.getElementById("OHSOrderSubGrid_d"); //Set Subgrid Id
var fetchXml = "..."
relatedOHSOrders.control.setParameter("fetchXml", fetchXml); 
```

我遇到的问题是我得到`Object does not support .setParameter property or method`了，当我调试它时，为了以防万一，我没有在`relatedOHSOrders.control.` I Uninstalled and reinstalled rollup 11 下看到 setParameter 但仍然有同样的问题！

请注意，我尝试了其他方式来使用 setParameter。下面的代码也不起作用

```
Xrm.Page.getControl("OHSOrderSubGrid")._control.get_innerControl();
relatedOHSOrders.setParameter("fetchXml", fetchXml); 
```

似乎每个人都使用此代码来过滤子网格，但我不确定我的问题是什么，它没有出现。

提前感谢您的任何帮助或建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T13:54:03.053

如您所知，Microsoft Dynamics CRM on-premises 的最新更新汇总和 Microsoft Dynamics CRM Online 的服务更新包括 Web 应用程序中的重大更改，以便能够支持各种浏览器。看看这篇文章：http: [//support.microsoft.com/kb/2795627](http://support.microsoft.com/kb/2795627)

您尝试使用的脚本在以前的 RUP 版本的 CRM 中工作。**setParameter**函数不再可用。现在您可以使用**SetParameter**代替它。幸运的是**刷新**功能仍然可用。因此，更改代码中的函数名称，它将起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T20:28:06.640

我自己找到了我的问题的答案。下面的代码完美地工作

```
function setOhsOrderGrid()
{
   var relatedOrders = document.getElementById("OrderSubGrid"); //Set Subgrid Id

    //If this method is called from the form OnLoad, make sure that the grid is loaded before   proceeding
    if (relatedOrders == null || relatedOrders.readyState != "complete") {
        //The subgrid hasn't loaded, wait 1 second and then try again
        setTimeout('setOhsOrderGrid()', 1000);
        return;
    }

    var fetchXml = "<?xml version='1.0'?>";
    fetchXml += "<fetch distinct='false' mapping='logical' output-format='xml-platform'    version='1.0'>"; 
    fetchXml += "<entity name='new_ohsorder'> <attribute name='new_orderid'/>";
    fetchXml += "<attribute name='new_order_no'/>";
    fetchXml += "<attribute name='createdon'/>"; 
    fetchXml += "<order descending='false' attribute='new_order_no'/>";
    fetchXml += "<filter type='and'> <condition attribute='new_clientcontactid' value='{1E9A621B-ACA1-E011-9A67-005056A8002D}' uitype='new_clientcontact' uiname='OHS-000001-6FBC4-CCR-01' operator='eq'/>";
    fetchXml += "</filter>";
    fetchXml += "</entity>";
    fetchXml += " </fetch>";

    relatedOrders.control.setParameter("fetchXml", fetchXml); --> It breaks
   relatedOrders.control.refresh();  --> It breaks

}; 
```

setOhsOrderGrid();

* * *

我不得不将 var relatedOrders = document.getElementById("OrderSubGrid_d") 更改为 var relatedOrders = document.getElementById("OrderSubGrid")

* * *

我收到一条评论说 setParameter 不受支持。我不知道为什么以及如何知道这一点。因为 setParameter document.getElementById("OrderSubGrid").control.setParameter !!! 有人知道吗？我想知道是否有人知道如何以受支持的方式编写过滤器子网格！？？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-23T13:01:26.887

只需将 替换`control.setParameter`为`control.SetParameter`。

有关更多详细信息，请查看此[MSDN 文章](https://social.msdn.microsoft.com/Forums/en-US/5722d056-07ba-4410-a6b0-59703963e00e/obeject-does-not-support-the-property-or-method-for-setparameter-method-in-crm-2011-javascript?forum=crm)。

# python - 遍历一个列表，我必须从第一个项目中获取数据以在最后一个项目中使用

> ID：14270517
> 
> 赞同：1
> 
> 时间：2013-01-11T02:03:45.133
> 
> 标签：python, dna-sequence

这是我之前提出的问题的后续： [在更大的列表中处理可变大小的子列表](https://stackoverflow.com/questions/14063387/processing-a-sub-list-of-variable-size-within-a-larger-list)。

我设法使用 itertools 取出 DNA 片段组，但现在我面临一个不同的问题。

我需要根据这些 DNA 片段组设计引物。通过包括来自不同 DNA 片段的重叠来设计引物。假设我在一个列表中有三个 DNA 片段，片段 A、B 和 C。我需要提取：

*   C的最后20个核苷酸（nt）与A的前40个核苷酸（按顺序）连接，
*   B 的前 20 个 nt 的反向补码 (RC) 按顺序与 A 的最后一个 nt 的 RC 连接，
*   A 的最后 20 nt 与 B 的前 40 nt 连接，
*   C 的前 20 nt 的 RC 与 B 的最后 40 nt 的 RC 连接，
*   C 的最后 20 nt 与 A 的前 40 nt 连接，
*   A 的前 20 nt 的 RC 与 C 的后 40 nt 的 RC 连接。

我似乎无法解决这个问题，而且我不确定从哪里开始最适合我......

到目前为止，我已经编写的代码仅输出“第 1 组”（故意这样，我可以最大限度地减少我正在处理的视觉输出量）。这里是：

```
#import BioPython Tools
from Bio.Seq import Seq
from Bio.Alphabet import IUPAC

#import csv tools
import csv
import sys
import os
import itertools

with open('constructs-to-make.csv', 'rU') as constructs:
    construct_list = csv.DictReader(constructs)
    def get_construct_number(row):
        return row["Construct"]
    def get_strategy(row):
        return row["Strategy"]
##    construct_list.next()
##    construct_number = 1
    primer_list = []
##    temp_list = []
##    counter = 2
    groups = []

##    for row in construct_list:
##        print(row)
##
    for key, items in itertools.groupby(construct_list, key=get_construct_number):
        for subitems in items:
            #here, I am trying to get the annealing portion of the Gibson sequence out
            if subitems['Strategy'] == 'Gibson' and subitems['Construct'] == '1':
                print(subitems['Construct'])
                fw_anneal = Seq(subitems['Sequence'][0:40], IUPAC.unambiguous_dna)
                print(fw_anneal)
                re_anneal = Seq(subitems['Sequence'][-40:], IUPAC.unambiguous_dna).reverse_complement()
                print(re_anneal)
                fw_overhang = Seq(subitems['Sequence'][0:20], IUPAC.unambiguous_dna).reverse_complement()
                print(fw_overhang)
                re_overhang = Seq(subitems['Sequence'][-20:], IUPAC.unambiguous_dna)
                print(re_overhang) 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T19:14:12.340

Martineau 可能对特定领域的语言有正确的想法。我对此没有任何经验，但这是我在半小时内想到的。

我没有运行、调试或测试过这个，但如果你有任何问题，请告诉我。此代码还假定片段长度不会太长以至于无法将它们保存在内存中。如果该假设不成立，则此方法将不会非常有效。

我在片段字典的设计上也很懒惰。它真的不应该是一个全局变量，整个代码应该在一个类中。

```
def head(seq, count):
    return seq[count:]

def tail(seq, count):
    return seq[:count]

def reverse(nt):
    if nt in 'Gg':
        return 'C'
    elif nt in 'Cc':
        return 'G'
    elif nt in 'Aa':
        return 'T'
    elift nt in 'Tt':
        return 'A'
    raise Exception('invalid nucleotide')

def complement(seq):
    return (reverse(i) for i in seq)

def identity(seq):
    return seq

fragments = {}
def register(fragment, name):
    if name not in fragments:
        fragments[name] = fragment
    else:
        raise Exception('a fragment of that name is already registered!')

def make_combination(portions):
    """ Each entry in portions should be a tuple consisting of:
    (sequence name, count, accessor function, complement function)"""
    output = []
    for entry in portions:
        name, count, select, order = entry
        section = order(select(fragments[name], count))
        output.append(str(section))
    # return a string, not a list
    return ''.join(output)

def example()
    a = 'gattaca'
    b = 'tagacat'
    c = 'gagatac'
    register(a, 'a')
    register(b, 'b')
    register(c, 'c')
    # the last 20 nucleotides (n.t.) of C with the first 40 n.t. of A
    first = (('c', 20, tail, identity),
             ('a', 40, head, identity))
    # RC of the first 20 n.t. of B with the RC of the last n.t. of A,
    second = (('b', 20, head, complement),
              ('a', 1, tail, identity)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T16:49:57.137

我最终使用了一堆条件来解决这个问题。

代码不优雅，并且涉及大量重复，但对于我将一遍又一遍地使用的快速而肮脏的脚本，我认为这就足够了。

```
##here, i process all the gibson primers to get the final list of primers##
##=======================================================================##
    construct_num = 1
    temp = []
    part_num = 1
    temp_row_num = 1
    max_seq_num = 0

    for row in gibson_primer_temp_list:

        max_seq_num = 0

        for x in gibson_primer_temp_list:
            if int(x[1]) > construct_num:
                pass
            if int(x[1]) == construct_num:
                max_seq_num += 1
##        print('Const. number counter is at ' + str(construct_num) + ' and current maximum known number of sequences is ' + str(max_seq_num))

##        print(row[1])

##        if int(row[1]) < construct_num:
##            while construct_num < int(row[1]):
##        print(max_seq_num)
##        for row in gibson_primer_temp_list:
##            if int(row[1]) == construct_num:
##                max_seq_num += 1
##            if int(row[1]) > construct_num:
##                break

        #print('Construct number is ' + str(row[1]) + ' and seq. number is ' + str(row[4]))
        #print('Const. number counter is ' + str(construct_num) + ' and max. seq. number is ' + str(max_seq_num) + '.')

        if int(row[1]) > construct_num:
            part_num = 1
            while construct_num < int(row[1]):
                #print('Construct number is ' + str(construct_num))
                construct_num += 1
##                temp_row_num += 1 #do not uncomment
            #continue - not to be added back again!

        if int(row[1]) == construct_num:

            if int(row[4]) == max_seq_num:

                #print(row)
                temp.append(row)
                temp_row_num += 1
                #print('We are going to make primers that join the first and last part in construct ' + str(construct_num))
                #print('Grabbing overhang portion from part ' + str(part_num) + ', which is sequence ' + str(row[4]) + '. It has the sequence ' + str(row[0]))
                overhang = row
                #print('Grabbing the first sequence...')
                for x in gibson_primer_temp_list:
                    #print(row[1] == x[1] and x[4] == 1)
                    if row[1] == x[1] and x[4] == 1:
                        #print(x[0])
                        anneal = x
                        #print('The first sequence is ' + str(anneal))
                        fw_primer = overhang[0] + anneal [0]
                        #print('The forward primer on the first part is: ' + str(fw_primer))
                        primer_list.append([fw_primer, construct_num, x[2], 'fw primer'])
                        break

                #print('Grabbing the third sequence...')
                for y in gibson_primer_temp_list:
                    #print(row[1] == y[1] and y[4] == 3)
                    if row[1] == y[1] and y[4] == 3:
                        #print(y[0])
                        overhang = y
                        #print('The third sequence is ' + str(overhang))
                        break

                #print('Grabbing the (n-2)th sequence...')
                steps_backward = 2
                target_seq_num = max_seq_num - steps_backward
                for z in gibson_primer_temp_list:
                    #print(row[1] == z[1] and z[4] == target_seq_num)
                    if row[1] == z[1] and z[4] == target_seq_num:
                        #print(z[0])
                        anneal = z
                        #print('The n-2th sequence is ' + str(anneal))
                        break

                re_primer = overhang[0] + anneal[0]
                primer_list.append([re_primer, construct_num, z[2], 're primer'])
                continue

            if part_num == int(row[2]) and part_num == 1: #if the part number counter = part number
                #print(row)
                temp.append(row)
                temp_row_num += 1
                continue #do NOT delete this continue

            if part_num < int(row[2]):
                #print('Current part is: ' + str(part_num) + '. Upping part number.' + '\n')
                part_num += 1
                #do NOT add in a "continue" here

            if part_num == int(row[2]) and row[3] == 'fp_anneal':
                #print(row)
                temp.append(row)
                temp_row_num += 1
                #print('Current part is: ' + str(part_num))
                #print('Grabbing tp_overhang from part ' + str(part_num - 1) + '...')
                x = 1
                for row in temp:
                    x += 1
                    if x == temp_row_num - 1:
                        prev_tp_overhang = row
                #print('Sequence of tp_overhang from part ' + str(part_num - 1) + ' is: ' + prev_tp_overhang[0])
                fw_primer_current = prev_tp_overhang[0] + row[0]
                #print('Appending to master primer list...')
                primer_list.append([fw_primer_current, construct_num, part_num, 'fw primer'])
                #print('Forward primer is: ' + str(fw_primer_current) + '\n')
                continue

            if part_num == int(row[2]) and row[3] == 'tp_anneal':
                #print(row)
                temp.append(row)
                temp_row_num += 1
                continue

            if part_num == int(row[2]) and row[3] == 'fp_overhang':
                #print(row)
                temp.append(row)
                temp_row_num += 1
                #print('Current temp_row_num is ' + str(temp_row_num))
                #print('Current part is: ' + str(part_num))
                #print('Grabbing tp_anneal from part ' + str(part_num - 1) + '...')
                x = 1
                for row in temp:
                    x += 1
                    if x == temp_row_num - 5:
                        prev_tp_anneal = row
                        #print(row)
                        pass
                #print('Sequence of tp_anneal from part ' + str(part_num - 1) + ' is: ' + prev_tp_anneal[0])
                re_primer_prev = row[0] + prev_tp_anneal[0]
                #print('Appending to master primer list...')
                primer_list.append([re_primer_prev, construct_num, part_num - 1, 're primer'])
                #print('Reverse primer for previous part is: ' + str(re_primer_prev) + '\n')
                part_num += 1
                continue

            if part_num == int(row[2]) and row[3] == 'tp_overhang':
                #print(row)
                temp.append(row)
                temp_row_num += 1
                continue

            continue 
```

感谢大家的帮助！

# php - PHP条件错误测试值

> ID：14270525
> 
> 赞同：0
> 
> 时间：2013-01-11T02:04:33.490
> 
> 标签：php, variables, conditional, evaluation

$var==1 是测试 $var 是否有值的正确语法吗？

我问，因为我在一个简单的条件下失败了。

这是似乎失败的代码：

```
if ($slcustom31==1) {$page="http://www.mydomain.com/members/page_Alpha.php";} 
```

我认为语法有问题， $var==1 。

++++++++ **这是整个条件，如果这使事情更清楚：**

```
//condition 1
if ($slcustom31==1) {$page="http://www.mydomain.com/members/page_Alpha.php";} 

//condition2
elseif ($slcustom31!=1 AND $slcustom29!="") {$page="http://www.mydomain.com/members/".$slcustom29;}

//condition3
else {$page="http://www.mydomain.com/members/page_Beta.php";} 

sl_redirecttourl($page); 
```

**具体症状：脚本忽略条件 1 和条件 2，默认为条件 3。**

++++ 如果有帮助，这里是整个（短）脚本：

```
$groupswithaccess="somegroup";

require_once("../slpw/sitelokpw.php");
require_once("../slpw/sitelokapi.php"); //gets value being tested by conditional

if ($slcustom31==1) {$page="http://www.mydomain.com/members/page_Alpha.php";} 
elseif ($slcustom31!=1 AND $slcustom29!="") {$page="http://www.mydomain.com/members/".$slcustom29;}//not finished, but started
else {$page="http://www.mydomain.com/members/page_Beta.php";} 

sl_redirecttourl($page); 
```

有人能告诉我我应该做些什么不同吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:08:23.490

```
if($var ==1){
//returns true only if var is 1
}

if(isset($var)){
//returns true if you currently have any value stored as the variable $var
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T02:11:00.413

要检查变量是否具有值，请使用：

```
empty($var); 
```

如果它是“空的”，它将返回 TRUE，否则将返回 FALSE。这被认为是空的：

*   ""（一个空字符串）
*   0（0 为整数）
*   0.0（0 作为浮点数）
*   "0" (0 作为字符串)
*   空值
*   错误的
*   array() （一个空数组）
*   $var; （声明的变量，但没有值）

更多信息请参见： http: [//php.net/manual/en/function.empty.php](http://php.net/manual/en/function.empty.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T02:11:27.687

不，您想查看[isset](http://php.net/manual/en/function.isset.php)或[empty](http://ca2.php.net/manual/en/function.empty.php)。

# magento - 仅在客户登录时在某些产品描述上显示图像

> ID：14270529
> 
> 赞同：0
> 
> 时间：2013-01-11T02:04:49.900
> 
> 标签：magento

我在使用 Magento 时遇到问题，如何仅在客户登录时在某些产品描述上显示图像？以及登录后是否可以访问客户所属的客户群？因此，如果是普通客户，他会看到某种形象，如果是分销商，他会看到另一种形象。

我说的是产品描述中的图片，在文字的开头有一个横幅，我不是在谈论产品图片。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:15:03.247

您需要修改您的主题`catalog/product/view/description.phtml`模板，因为这是输出产品描述的地方。

```
$customerSession = Mage::getSingleton('customer/session');
$customer = $customerSession->getCustomer();
if ($customerSession->isLoggedIn()) {
     // your image actions here
}

if ($customer && $customer->getCustomerGroupId() == 5) {
     // your customer group specific actions
} 
```

第一个 if 语句检查用户是否登录，第二个检查客户组 ID 是否等于 5（或您正在搜索的任何客户组）。将其放在您的描述之前以输出必要的图像/内容。

# mysql - 如何在我的慢 MySQL 例程（存储过程）中找到瓶颈？

> ID：14270541
> 
> 赞同：0
> 
> 时间：2013-01-11T02:06:19.580
> 
> 标签：mysql, sql, performance, stored-procedures

我在 MySQL 中有一个很长的例程，其中有多个`SELECT`,`INSERT`和`UPDATE`语句，其中包含一些`IF`s 和`REPEAT`s。它一直运行良好，直到最近，它挂起超过 20 秒才能完成（考虑到它过去需要 1 秒左右，这是不可接受的）。

对我来说，找出瓶颈来自哪里的最快、最简单的方法是什么？基本上，例程已经停止了，并且在某些方面......我如何在不分解例程并逐个测试每个部分的情况下找出它在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:15:17.807

如果您使用[Percona Server](http://www.percona.com/software/percona-server)（具有许多增强功能的免费 MySQL 发行版），您可以使用`log_slow_sp_statements`配置变量为单个查询创建慢查询日志记录时间。请参阅[http://www.percona.com/doc/percona-server/5.5/diagnostics/slow_extended_55.html](http://www.percona.com/doc/percona-server/5.5/diagnostics/slow_extended_55.html)

如果您使用的是库存 MySQL，您可以在存储过程中添加语句，将一系列会话变量设置为[`SYSDATE()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_sysdate)函数返回的值。在 SP 的不同点使用不同的会话变量。然后在测试执行中运行 SP 后，您可以检查这些会话变量的值以查看 SP 的哪个部分花费的时间最长。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:18:04.300

分析查询可以看到相同的执行计划。这并不总是一件容易的事，但稍加阅读就会找到解决方案。我留下一些有用的链接

[http://dev.mysql.com/doc/refman/5.5/en/execution-plan-information.html](http://dev.mysql.com/doc/refman/5.5/en/execution-plan-information.html)

[http://dev.mysql.com/doc/refman/5.0/en/explain.html](http://dev.mysql.com/doc/refman/5.0/en/explain.html)

[http://dev.mysql.com/doc/refman/5.0/en/using-explain.html](http://dev.mysql.com/doc/refman/5.0/en/using-explain.html)

[http://www.lornajane.net/posts/2011/explaining-mysqls-explain](http://www.lornajane.net/posts/2011/explaining-mysqls-explain)

# node.js - 在 Socket.io 中使用第一个连接发送一些状态

> ID：14270544
> 
> 赞同：0
> 
> 时间：2013-01-11T02:06:52.830
> 
> 标签：node.js, socket.io

我正在使用 socket.io 并正在寻找一种方法让客户端能够指定它想要连接到哪个房间，但我想不出一个好的方法来实现这一点。

在我的服务器上：

```
io.sockets.on 'connection', (socket)->
    console.log 'A socket connected.'
    socket.join('my_room') 
```

在客户端我有：

```
io = io.connect("http://domain.com") 
```

我想做的是在客户端的第一个连接中获得一些初始状态，以便服务器知道它应该尝试将人连接到哪个房间。

所以在客户端上是这样的：

```
io = io.connect("http://domain.com", room_1) 
```

然后服务器会有这样的事情：

```
io.sockets.on 'connection', (socket, data)->
    console.log 'A socket with connected!'
    socket.join(data) 
```

这可能与房间有关吗？有没有更好的办法？我研究了名称空间，但房间更适合我想要做的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T17:02:53.837

我同意 drinchev 的观点。您应该只在客户端的连接事件上发送数据。

```
io = io.connect 'http://domain.com'

io.on 'connect', () ->
    socket.emit('join-room', room_1) 
```

另一种选择是使用 socket.io 命名空间。这将允许您避免往返，但命名空间和通道之间存在一些差异，您必须确定哪个对您的应用程序更有意义。

`io = io.connect 'http://domain.com/room_1'`

这里接受的答案很好地概括了通道和命名空间之间的差异。[socket.io 房间或命名空间？](https://stackoverflow.com/questions/10930286/socket-io-rooms-or-namespacing)

# multithreading - 多个用户访问同一系统的并发（系统同时处理请求）

> ID：14270546
> 
> 赞同：0
> 
> 时间：2013-01-11T02:07:00.410
> 
> 标签：multithreading, servlets, concurrency, web, theory

我一直在思考一个令人困惑的问题。在我的应用程序的美好一天场景中，我想编写一个`algorithm`为我编译我的数据的程序`parallel`，并利用加速。但在我进行所有这些努力之前，我想知道在这种情况下是否有可能，或者只是一个白日梦。

![加速](../Images/3240000fa6c7661633642ef1e25258c1.png) （[维基百科](http://en.wikipedia.org/wiki/Speedup)，2011）

假设出于这个问题的目的，我有 5 个用户（`User A, User B, User C, User D and User E`。这些是使用用户名/密码登录的人，而不是线程的隐喻）在`SYSTEM`由`Cookies`.

假设`User A`向服务器发送请求以计算长度为 1000 x 1000 的梯形（系统将此请求分为 4 个部分并将每个部分发送到一个核心）。现在还可以说，出于这个问题的目的，他也`User B`同时登录，`User A`并且他还向系统发送请求以计算不同长度的梯形（系统将其划分为服务器的核心）。

根据我的简要理解，我知道这种情况对于单个用户显然是可能的，但是可能有超过 1 个用户同时访问系统（并让系统同时处理请求）？可以很好地编写一个java程序来处理这个问题吗？或者会在和之间发生一个`bottle neck`或其他事情（因为他们从系统中竞争资源）？？？处理大量数据的并发性是否最好在不同的实例化对象中处理，或者是否可以使用基于 Web 的产品来完成？`User A``User B``User``linear algorithms``parallel algorithms`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:13:58.383

当多个线程同时访问共享数据时，就会出现竞争条件。当多个线程以冲突的顺序锁定资源时，就会发生死锁。

这些在多线程环境中总是可能的，但成千上万的系统具有类似的功能。单击下面的“发布您的答案”按钮后，SO 将使用来自多个用户的答案更新问题。由于比赛条件，您没有看到任何垃圾是吗？

您将受益于对算法进行伪编码并查看在哪里可以实现并发——一种方法是使用线程私有的数据，例如本地和线程本地变量。另一个是识别使用共享数据的（小）代码部分并使用锁定结构来确保它们不会并行执行，从而允许其余代码并行执行。

# regex - 记事本++正则表达式

> ID：14270547
> 
> 赞同：0
> 
> 时间：2013-01-11T02:07:02.457
> 
> 标签：regex, notepad++

我需要更换

```
removeUnderline(getPlayerName(*)); 
```

和

```
getPlayerNameWM(*); 
```

而 * 是括号之间的东西。

例如，替换`removeUnderline(getPlayerName("Daniel"));`

和`getPlayerNameWM("Daniel");`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:18:49.143

寻找 ：`removeUnderline\(getPlayerName\(([^)]*)\)\);`

代替 ：`getPlayerNameVM\($1\);`

# arrays - 如何搜索包含“文本”的特定列并删除所有不包含搜索的行

> ID：14270548
> 
> 赞同：0
> 
> 时间：2013-01-11T02:07:11.910
> 
> 标签：arrays, vba, excel

下面的 VBA 代码是查找文本和删除行。但它是基于整张纸进行搜索。

如何使其仅使用列出的文本数组**搜索“特定列”**并**删除包含 text 的行**。

根据下面的代码，它是搜索我不想要的整个工作表。

```
Sub DeleteSystemMessage()
    Dim varList As Variant
    Dim varQP As Variant
    Dim lngarrCounter As Long
    Dim rngFound As Range, rngToDelete As Range
    Dim strFirstAddress As String

    Application.ScreenUpdating = False

'delete system message
    varList = VBA.Array("XXXXXX", vbTextCompare)

    For lngarrCounter = LBound(varList) To UBound(varList)
        With Sheet1.UsedRange
            Set rngFound = .Find( _
                                What:=varList(lngarrCounter), _
                                Lookat:=xlWhole, _
                                SearchOrder:=xlByRows, _
                                SearchDirection:=xlNext, _
                                MatchCase:=False)

            If Not rngFound Is Nothing Then
                strFirstAddress = rngFound.Address

                If rngToDelete Is Nothing Then
                    Set rngToDelete = rngFound
                Else
                    If Application.Intersect(rngToDelete, rngFound.EntireRow) Is Nothing Then
                        Set rngToDelete = Application.Union(rngToDelete, rngFound)
                    End If
                End If

                Set rngFound = .FindNext(After:=rngFound)

                Do Until rngFound.Address = strFirstAddress
                    If Application.Intersect(rngToDelete, rngFound.EntireRow) Is Nothing Then
                        Set rngToDelete = Application.Union(rngToDelete, rngFound)
                    End If
                    Set rngFound = .FindNext(After:=rngFound)
                Loop
            End If
        End With
    Next lngarrCounter

    If Not rngToDelete Is Nothing Then rngToDelete.EntireRow.Delete
Application.ScreenUpdating = True

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T09:57:47.037

如果您像这样更改搜索代码，它只会在“A”列中搜索。

```
Set rngFound = Sheets(1).Columns("A:A").Find( _
                            What:=varList(lngarrCounter), _
                            LookAt:=xlWhole, _
                            SearchOrder:=xlByRows, _
                            SearchDirection:=xlNext, _
                            MatchCase:=False) 
```

# c++ - 使用 g++ 显示到 cout 停止执行

> ID：14270553
> 
> 赞同：2
> 
> 时间：2013-01-11T02:07:51.197
> 
> 标签：c++, cout

我是 C++ 新手，我正在对输入进行标记。注释行 "cout<< "p: " << p << endl;" 使第二个函数调用不执行，为什么？

```
#include <iostream>
#include <string>
#include <string.h> //for library strtok()
#include <sstream> //for useStringStream()
using namespace std;

void useStrTok(){
    char myString[] = "The quick brown fox";
    char *p = strtok(myString, " ");
    while (p) {
        cout<< "token: " << p<< endl;
        p = strtok(NULL, " ");
        //cout<< "p: " << p << endl;
    }
}    

void useStringStream(){
    string myText("The quick brown fox");
    istringstream iss(myText);
    string token;
    while(getline(iss,token, ' '))
    {
        cout << token << endl;
    }
}

int main(){
    useStrTok();
    useStringStream();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:12:41.543

因为 strtok 可能返回一个空指针并打印空指针导致崩溃。在访问指针之前检查指针的验证：

```
if (p)
{
    cout<< "p: " << p << endl;
} 
```

请参阅[strtok](http://www.cplusplus.com/reference/cstring/strtok/)参考

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:12:16.787

尝试

```
cout<< "p: " << (void*)p << endl; 
```

解决您的问题的最简单的方法，但可能无法达到您的预期。

# php - 表查询mysql

> ID：14270556
> 
> 赞同：-1
> 
> 时间：2013-01-11T02:08:11.407
> 
> 标签：php, mysql

这是非常基本的，我无法弄清楚为什么它不起作用。我认为它与 fetch_mysql_array($row) 有关。这是我的代码并设置了 $user_id：

```
$posts=mysql_query("SELECT title, description FROM posts WHERE user_id = '$user_id'") or die(mysql_error()) ;

while ($row=fetch_mysql_array($posts, MYSQL_NUM)) {

for ($i=0;$i < count($row); $i++) {

    echo $row[$i]."&nbsp;";

}

    echo"<br /> <br />";                
} 
```

提前感谢您的帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:10:39.063

它是`mysql_fetch_array`; not `fetch_mysql_array`，无论如何你都不应该使用它。`mysql_`功能不再维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](http://j.mp/Te9zIL)了吗？改为了解[*准备好的语句*](http://j.mp/T9hLWi)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](http://j.mp/QEx8IB)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://j.mp/PoWehJ)。

您也不需要`for`循环内的`while`循环。

# database-design - 数据库建模 - 未注册成员的表

> ID：14270558
> 
> 赞同：0
> 
> 时间：2013-01-11T02:08:28.970
> 
> 标签：database-design

我正在研究一个概念数据库模型，我想包含用于处理未注册成员的表。我想保存姓名、注销日期、电话、电子邮件和地址。

这通常是怎么做的？我应该把所有东西都放在一张桌子上，还是应该至少再用一张桌子来存储联系信息和类型表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:17:55.477

根据表的大小，您可能希望为未注册成员提供一个单独的表。拥有单独表格的问题在于重复成员（以防成员重新注册）。您可以编写一个触发器来检查另一个表。否则，应该使用一个简单的标志来确定成员是注册还是未注册。

# ruby-on-rails - 控制器和视图关联以及 self.method 仍然让我感到困惑

> ID：14270559
> 
> 赞同：0
> 
> 时间：2013-01-11T02:08:40.360
> 
> 标签：ruby-on-rails

好的，所以在我的控制器的索引部分我设置

```
@patients = Patient.all 
```

然后在patients_helper.rb

```
def race_abrev
 return self.caucasian
end 
```

其中 caucasian 是患者表中的整数数据类型列

然后在视图中 index.html.erb

```
<% @patients.each do |p| %>
  <td><%= p.gender %></td>
  <td><%= p.ethnicity %></td>
  <td><%= p.race_abrev %></td>
<% end %> 
```

我得到一个

```
undefined method `race_abrev' for #<Patient:0xb4d95cd8> 
```

我检查了表格，我期待着 patient.caucasian 返回整数 1，我错过了什么……对我似乎有的基本误解有什么见解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:12:12.013

`race_abrev`是一个助手，而不是一个方法`Patient`：

```
<%= race_abrev(p) %> 
```

并且助手本身会返回`p.caucasian`，尽管看起来你实际上想要用 的值*做*`caucasian`一些事情，比如比较之类的。

所有这一切，我不确定你为什么不在模型上定义它（或者“它”实际上是什么），因为到目前为止它似乎与视图没有任何关系，这是什么视图帮手是为了。

如果您要在数据库中存储某些内容，则您想对其进行转换，它可能属于也可能不属于视图助手；如果要将其变成人类可读的东西，我更有可能将其放入模型中。

# java - ANTLR 是解决此类问题的正确方法吗？

> ID：14270560
> 
> 赞同：2
> 
> 时间：2013-01-11T02:08:47.100
> 
> 标签：java, antlr

所以，我真的被困住了，开始认为这不是正确的方法。考虑这个字符串：“[APPLE|ORANGE] PEAR” 这里的逻辑*应该*是“如果 APPLE 在字符串中，给我它的颜色 ELSE 如果 ORANGE 在字符串中，给我它的颜色 ELSE 返回空字符串。现在总是返回 PEAR 颜色”。

我能够让[Hello World](http://www.certpal.com/blogs/2011/01/antlr-tutorial-hello-antlr/)正常工作。1\. 我正在努力让 ANTLR 理解我的字符串中的条件逻辑。2\. 我正在努力让 ANTLR 为每个标识符调用 getColor()。任何帮助或指导将不胜感激。我现在正气喘吁吁。

```
grammar Test;

@header {
  package org.mytest.Test;
}

@members {
    private String answer = "";

    private void getColor(String fruit)
    {
        //Use java reflection to get Fruit class and invoke method getColor()
        answer = fruit.color;
    }

}

 @lexer::header {
  package org.mytest.Test;
}

/*------------------------------------------------------------------
 * PARSER RULES
 *------------------------------------------------------------------*/

row returns [List<String> list]
@init {list = new ArrayList<String>();}
  :  a=value {list.add($a.val);} (WS b=value {list.add($b.val);})* (EOF)
  ;

conditionalString    returns [String color]:
                (
                a=IDENTIFIER (WS IDENTIFIER)* {getColor($a.text); } 
                )
                {$color=answer;};

//Get the text string for the matched identifier?
value returns [String val]  :  IDENTIFIER {val = $IDENTIFIER.text;}  ;

/*------------------------------------------------------------------
 * LEXER RULES
 *------------------------------------------------------------------*/

IDENTIFIER  :   ('A'..'Z')+;

WS : ( '\t' | ' ')+     { $channel = HIDDEN; } ; 
```

理想的用法如下。“上下文”参数将是一些资源句柄。我会手动编辑构造函数以传递上下文，以便 ANTL 知道如何处理每个令牌。

```
TestLexer lex = new TestLexer(new ANTLRStringStream("[APPLE|ORANGE] PEAR"));
CommonTokenStream tok = new CommonTokenStream(lex);
TestParser par = new TestParser(context,tok);
System.out.println(par.conditionalString()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T04:08:45.130

这是我认为接近您要求的语法。它只处理您指定的情况：`[id|id|id]`是一个简单的条件，条件`id`之外的任何内容都按原样评估。

### 水果.g

```
grammar Fruit;

@parser::members { 

    private StringBuilder output = new StringBuilder();
    private java.util.HashMap<String, String> colors = new java.util.HashMap<String, String>();

    public void addColor(String fruit, String color){
        colors.put(fruit, color);
    }

    private void printColor(String fruit){
        if (colors.containsKey(fruit)){
            output.append(colors.get(fruit));
            output.append(" ");
        } else { 
            output.append("(no color for ").append(fruit).append(")");
        }
    }

    private void printColor(Token id){
        printColor(id.getText());
    }

    private void evaluateCondition(java.util.List<Token> tokens){
        for (Token token : tokens){
            String fruit = token.getText();
            if (colors.containsKey(fruit)){
                printColor(fruit);
                break;
            }
        }
    }
}

conditionalString returns [String result]
@after { result = output.toString();}
            : expr
            ;

expr        : cond_expr+
            ;

cond_expr   : ID
            {printColor($ID);}
            | LSQB values+=ID (OR values+=ID)* RSQB
            {evaluateCondition($values);}
            ;

OR          : '|';
LSQB        : '[';
RSQB        : ']';
ID          : ('A'..'Z')+;
WS          : ('\t'|' ')+ {skip();}; 
```

这里是测试类。存在解析器上的方法`addColor`以简化测试。例如，如果水果“ORANGE”的颜色为“orange”并且输入字符串是“ORANGE ORANGE”，那么输出应该是“orange orange”。

### FruitTest.java

```
public class FruitTest {

    public static void main(String[] args) throws Exception {
        CharStream input = new ANTLRStringStream("[APPLE|ORANGE] PEAR");
        FruitLexer lexer = new FruitLexer(input);
        CommonTokenStream tokens = new CommonTokenStream(lexer);

        FruitParser parser = new FruitParser(tokens);

        parser.addColor("APPLE", "red");
        parser.addColor("ORANGE", "orange");
        parser.addColor("PEAR", "yellow");

        String result = parser.conditionalString();

        if (lexer.getNumberOfSyntaxErrors() > 0 || parser.getNumberOfSyntaxErrors() > 0){
            throw new Exception("Syntax errors encountered!");
        }

        System.out.println(result);
    }
} 
```

### 测试用例 1：大量水果

*   苹果=红色
*   橙色 = 橙色
*   梨 = 黄色

输入： `[APPLE|ORANGE] PEAR`
输出：`red yellow`

### 测试用例 2：大量水果

*   橙色 = 橙色
*   梨 = 黄色

输入： `[APPLE|ORANGE] PEAR`
输出：`orange yellow`

### 测试用例 3：水果少

*   梨 = 黄色

输入： `[APPLE|ORANGE] PEAR`
输出：`yellow`

### 测试用例 4：绝食（未定义水果颜色）

输入： `[APPLE|ORANGE] PEAR`
输出：`(no color for PEAR)`

由于`PEAR`不是条件的一部分，因此需要对其进行定义。

# excel - 使用 FSO 根据满足的条件将文件夹名称插入单元格

> ID：14270561
> 
> 赞同：0
> 
> 时间：2013-01-11T02:08:48.637
> 
> 标签：excel, vba

我在将语法放在一起时遇到了麻烦，我刚开始在 VBA 中使用 FSO，所以请多多包涵。

fsofol.name = test1（这是正确的）

我正在尝试确定每个单元格是否在“A”列中有任何数据，如果有，请将文件夹的名称放在我列出的偏移单元格中。我希望我很接近，但如果有人可以提供建议，我将不胜感激。谢谢！

我在下面的问题行中写了一个注释

```
 Dim fsoFol As Object  

    If fileName Like "V*.xls" Then
         wbkCS.Worksheets("Cut Sheet").Range("S4:S2000").Copy
              With wbkVer.Worksheets("Cutsheets")
              Set firstRange = .Range("A" & .Rows.Count).End(xlUp).Offset(1, 0) 
    firstRange.PasteSpecial xlPasteValues
    If firstRange.Value Like "*" Then
         fsoFol.Name.Copy **'error is here and states object required**
         firstRange.Offset(0, 5).PasteSpecial xlPasteValues
    End If
              End With 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:14:23.450

改变

```
 fsoFol.Name.Copy **'error is here and states object required**
 firstRange.Offset(0, 5).PasteSpecial xlPasteValues 
```

至

```
 firstRange.Offset(0, 5).Value = fsoFol.Name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T03:17:00.743

假设 FSO 是，`Scripting.FileSystemObject`并且您想要处理名为“test1”的文件夹中的所有“V*.xls”文件，那么您缺少几个步骤：

创建文件系统对象

```
Dim fso As Object
Set fso = CreateObject("Scripting.FileSystemObject") 
```

分配文件夹

```
Dim fsoFol As Object
Set fsoFol = fso.GetFolder("C:\Temp\test1") 
```

处理文件

```
Dim fsoFile As Object
For Each fsoFile in fsoFol.Files
  If fsoFile.Name Like "V*.xls" Then
    ' code for working with the Excel files goes here
  End If
Next fsoFile 
```

打开一个特定的 Excel 文件并将其分配给一个变量

```
' Assuming you have Dim wbkCS As Workbook at the start of the module

Set wbkCS = Workbooks.Open(fsoFile.Name)

' code to process the actual file goes here

wbkCS.Close False 
```

我不清楚您要对复制到 wbkVer 的单元格做什么。您正在复制近 2000 个单元格，但只查看复制的第一个单元格的值。此外，该测试`Like "*"`将为空单元格和具有值的单元格返回 True，因此它可能不是您需要的。如果你能澄清这个要求，那么我们可以稍微改变一下

# javascript - 用户完成输入杂货后内容消失

> ID：14270562
> 
> 赞同：0
> 
> 时间：2013-01-11T02:08:59.767
> 
> 标签：javascript, jquery

祝大家新年快乐！我正在通过学​​习 jquery 来庆祝。我在下面的代码中添加了一些 jQuery，并设法添加了一些内容并用它更改了一些 css。getGroceries 函数工作正常，并且正在做它应该做的事情。当用户完成输入杂货时，程序 (printGroceries) 应该打印用户输入的列表。那部分也可以工作....但是，当发生这种情况时，程序会删除标题（我的购物清单）并删除所有样式。

我究竟做错了什么？

编辑代码：删除完整代码并添加我更改的部分（评论旧的）。

```
function printGroceries(groceryItems) {

if (groceryItems.length > 1) {
    $('grocery-list').html('<ol class="items" id="list-items">');
    //document.write("<ol>");
    for(x=0; x < groceryItems.length;x++){
    groceryItems;
    $('#list-items').prepend('<li>' + groceryItems[x] + '</li>');
    //document.write("<li>" + groceryItems[x] + '</li>');
    }
    $('#grocery-list').append('</ol>');
    //document.write("</ol>");
} else {
    $('#grocery-list').prepend('<p>Sorry, your list is empty.</p>');
    //document.write('<p>Sorry, your list is empty.</p>');
}
} 
```

问题：[小提琴](http://jsfiddle.net/arunpjohny/vbJpG/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T03:20:25.503

由于您使用的是 jQuery；这是一个利用`$.each()`. 此外，最好构建您的字符串并仅附加一次，而不是一遍又一遍地附加每个项目。

```
function printGroceries(groceryItems) {
  var listItems = '';
  if (groceryItems.length > 0) {
    $.each(groceryItems, function (i, item) {
      listItems += '<li>' + item + '</li>';
    });
    $('#grocery-list').append('<ol class="items" id="list-items">'+listItems+'</ol>');
  } else {
    $('#grocery-list').prepend('<p>Sorry, your list is empty.</p>');
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T03:10:47.960

尝试这个

```
function printGroceries(groceryItems) {
    if (groceryItems.length > 0) {
        $('#grocery-list').html('<ol class="items" id="list-items">');
        //document.write("<ol>");
        for(x=0; x < groceryItems.length;x++){
        groceryItems;
        $('#list-items').prepend('<li>' + groceryItems[x] + '</li>');
        //document.write("<li>" + groceryItems[x] + '</li>');
        }
        $('#grocery-list').append('</ol>');
        //document.write("</ol>");
    } else {
        $('#grocery-list').prepend('<p>Sorry, your list is empty.</p>');
        //document.write('<p>Sorry, your list is empty.</p>');
    }
} 
```

正如我在评论中建议的那样，您错过了一些事情
1.`if`条件应该检查`groceryItems.length > 0`
​​ 2.`$('grocery-list')`应该是`$('#grocery-list')`，您在这里缺少**id 选择器**

解决方案：[小提琴](http://jsfiddle.net/arunpjohny/vbJpG/1/)

# gnuplot - 限制在 Gnuplot 上绘制的函数的域

> ID：14270563
> 
> 赞同：14
> 
> 时间：2013-01-11T02:09:14.663
> 
> 标签：gnuplot

我正在 Gnuplot 上绘制一组数据，并希望将函数叠加在`x^2`同一个图上。我可以这样做：

```
plot "filename" using 1:2, x**2 
```

这会产生一个图，其中函数`x^2`延伸到图的整个域。我想让函数只显示在图形的一小部分上，比如从 x=1 到 x=2，而图形的大小`filename`由 x=0 到 x=10决定. 我知道要自己绘制函数，我可以这样做：

```
plot [1:2] x**2 
```

但是，鉴于我凭直觉尝试的方法不起作用，我将如何将叠加保持在一起：

```
plot "filename" using 1:2, [1:2] x**2

invalid expression 
```

当涉及到使其工作时，文档似乎很难解释。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-11T02:28:30.823

最简单的方法可能是使用三元运算符定义分段函数`?`：

```
f(x) = (x > 1 && x < 2) ? x**2 : 1/0
plot "filename" using 1:2, f(x) 
```

另一种方法是使用`replot`命令：

```
plot "filename" using 1:2
replot [1:2] x**2 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-09-06T18:20:27.550

我知道这是一个老问题，但对于任何可能正在寻找更简单方法的人来说：

你的第一个想法

```
plot "filename" using 1:2, [1:2] x**2 
```

现在工作。

# c++ - 在 C++ 程序中出现错误消息

> ID：14270566
> 
> 赞同：0
> 
> 时间：2013-01-11T02:09:31.050
> 
> 标签：c++, map, runtime-error

我在以下地图中存储了大约 14GB 的数据：

```
struct data
{
   char* a;
   char* b;
   data(char* _a, char* _b)
   {
        int alen = strlen(a);
        a = new char[alen+1];
        strcpy(a,_a);
        a[alen]='\0';

        int blen = strlen(_b);
        b = new char[ blen+1];
        strcpy(b,_b);
        b[blen]='\0';        
    }

    ~data()
    {
       delete [] a;
       delete [] b;
    }
};

struct ltstr
{
    bool operator()(const char* s1, const char* s2) const
    {
        return strcmp(s1, s2) < 0;
    }
};

map<const char*, data*, ltstr> m; 
```

程序运行一定数量的记录（26293289 中的 10440440），一段时间后我收到以下错误消息。

```
Program terminated with signal SIGKILL, Killed.
The program no longer exists. 
Missing separate debuginfos, use: debuginfo-install glibc-2.12-1.25.el6.x86_64 libgcc- 4.4.5-6.el6.x86_64 libstdc++-4.4.5-6.el6.x86_64 
```

我怎样才能避免上述终止？

服务器规格：

```
 Mem:  24605344k total, 15148556k used,  9456788k free,    20892k buffers
  Swap:  2097144k total,   161364k used,  1935780k free, 14469244k cached 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T02:11:20.067

[*OOM 杀手*](http://en.wikipedia.org/wiki/Out_of_memory)可能正在介入并杀死您的进程 。[看看你的日志](https://stackoverflow.com/questions/624857/finding-which-process-was-killed-by-linux-oom-killer)以确定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T02:14:36.737

在不了解程序的更多细节的情况下，您可能会尝试对文件进行内存映射以减少内存使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T02:31:19.450

*我怎样才能避免上述终止？*

通过重新思考您的设计。你想达到什么目的？特别是，为什么需要一个在内存中有 2700 万个条目的查找表？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-11T02:22:54.137

由于您显然内存不足，显而易见的事情是减少您正在使用的内存量。一种可能性是使用类似 Patricia trie 的东西来存储数据，而不是 a `std::map`（通常使用红黑树）。

确切的收益将取决于您的字符串中有多少冗余。在某种程度上，它还取决于您用作键的字符串的大小，以及您使用它们存储的数据的大小。

根据具体情况，您还可以考虑使用诸如 Huffman 压缩之类的方法和一个固定表来存储您作为与每个键关联的数据的字符串。尽管 Huffman 压缩在其他情况下不一定是最有效的，但使用固定表，它的优点是可以很好地处理单个字符串，就像您在此处使用的那样。如果字符串中的`data`部分很长（例如，两个字符串的平均长度至少为 8K），除了 Huffman 压缩之外，可能还值得应用 LZ* 系列压缩，但如果它们很短（例如，任何小于至少几个千字节）L​​Z 可能不会很好地工作（除非您愿意将字符串组合成块，因此您可能必须解压缩几千字节的其他字符串才能在任何给定时间找到您关心的字符串'正在检索一些数据。

虽然压缩通常比直接从内存访问数据而不压缩/解压缩要慢，但它通常仍然比从磁盘检索数据要快，如果您用完物理内存并最终使用虚拟内存，通常会发生这种情况。

# c# - c#中的不一致的可访问性错误无法调用base

> ID：14270568
> 
> 赞同：0
> 
> 时间：2013-01-11T02:09:40.453
> 
> 标签：c#, winforms, inheritance, layout

我正在创建一个包含大量表单的应用程序，并且设计器需要花费大量时间来应用所需的视觉样式，因此我创建了一个名为 Layout 的类，以将这些属性更改应用于其 Load() 方法上的每个表单。

```
 class Layout : Form
    {
        public void ApplicarLayout(Form frm)
        {
            frm.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(30)))), ((int)(((byte)(30)))), ((int)(((byte)(30)))));
            foreach (Control c in frm.Controls)
            {
                if (c is TextBox)
                {
                    //Apply textBox Formatting
                }
                //Iterate through the controls in the form and add respective format
            }
        }
    } 
```

到目前为止，一切都很好。我的计划是从每个表单继承这个类，然后调用 base.AplicarLayout() 方法。但是，我得到了错误：

```
Inconsistent accessibility: base class 'EntityClub_.Layout' is less accessible than class 'EntityClub_.MainAdminWindow' 
```

在这里你可以看到我是如何做到的。

```
 public partial class MainAdminWindow : Layout
{
    public MainAdminWindow()
    {
        InitializeComponent();
    }

    public void MainAdminWindow_Load(object sender, EventArgs e)
    {
        base.ApplicarLayout(this);//ERROR HERE
    }
} 
```

你知道我怎样才能使用继承来做到这一点吗？我不想实例化该类，也不想用布局方法污染每个窗口的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T02:16:35.193

没有显式访问修饰符（并且没有嵌套）的类被暗示为`internal`.

所以：

```
class Layout : Form 
```

..是内部的，而：

```
public partial class MainAdminWindow : Layout 
```

..是公开的（因为您已经明确表示过）。将 Layout 的声明更改为此可以解决问题：

```
public class Layout : Form 
```

# php - SQL注入同时使用绑定/准备语句？

> ID：14270569
> 
> 赞同：0
> 
> 时间：2013-01-11T02:09:45.543
> 
> 标签：php, mysqli, bind, sql-injection

除了阻止它的过程之外，我对 SQL 注入一无所知。

我想知道，如果攻击者会修改我准备好的语句：

```
$DB = $Con->prepare("SELECT * FROM Test WHERE username=?");

$DB->bind_param('s',$Username);

$DB->execute(); 
```

他输入的声明是：

```
x' DROP TABLE Test 
```

bind/prepared 语句将如何处理这个请求？

它会返回错误还是继续？作为`bind_param`链接特定值到所述 SQL 语句？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:13:11.927

不，数据库只会查找用户名为 的记录，`x' DROP TABLE Test`因此您最终可能会得到一个空的结果集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:11:56.443

使用 bind_param 时，将为您转义这些值。您仍然应该验证数据以确保它是正确的，但它不会被注入

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T02:15:09.240

一旦你准备了一个语句，它就会被预编译。因此，您绑定到它的任何参数都将作为原始数据发送，并且决不能修改 SQL 语句。

您的示例可以正常工作，它将选择所有带有 username 的行`x' DROP TABLE Test`。

# javascript - 从图像中提取 exif 方向数据

> ID：14270574
> 
> 赞同：19
> 
> 时间：2013-01-11T02:10:26.930
> 
> 标签：javascript, html, jpeg, exif

> **可能重复：**
> [在客户端的 Javascript 中访问 JPEG EXIF 旋转数据](https://stackoverflow.com/questions/7584794/accessing-jpeg-exif-rotation-data-in-javascript-on-the-client-side)

我需要使用 Javascript 从 HTML JPEG 图像中提取方向 EXIF 数据。

根据[exiftool 的文档](https://exiftool.org/TagNames/EXIF.html)，方向标志位于 EXIF 标记内的偏移量 0x112 处，占用 2 个字节。

我想我们只需要以良好的偏移量提取数据并“转换”值，但我不知道如何在浏览器中实现这一点。结果值应该是描述方向的 1 到 8 之间的数字。

如何从简单的 IMG 标签中读取该数据？我需要一个仅 webkit 的解决方案，但仅需要浏览器。

谢谢 ！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-11T02:16:10.423

[这个问题](https://stackoverflow.com/questions/7584794/accessing-jpeg-exif-rotation-data-in-javascript-on-the-client-side)可能重复。

谢谢。这是获取方向的最终代码示例：

```
var b64 = "data:image/jpeg;base64,/9j/4AAQSkZJRgABA......";
var bin = atob(b64.split(',')[1]);
var exif = EXIF.readFromBinaryFile(new BinaryFile(bin));
alert(exif.Orientation); 
```

# java - 依赖于 web 模块的 java jar 的 Myeclipse 部署问题

> ID：14270581
> 
> 赞同：0
> 
> 时间：2013-01-11T02:11:39.680
> 
> 标签：java, eclipse, myeclipse

我使用的是WAS 8，在部署文件夹中，我只需要获取x.war-> web-inf-> lib下的依赖java jar项目，.

这可以在 RAD 中使用 j2ee 模块依赖项-> Web 库选项卡轻松完成。如何在 Myeclipse 中做到这一点？

我禁用了部署程序集映射并在 Myeclipse 中尝试了许多选项，但似乎都具有相同的结果..

Eclipse indigo 一些如何在 x.war-> web-inf-> lib 下部署依赖的 java jar 项目。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T07:25:09.873

依赖项目以项目属性（或工作区首选项）中指定的方式进行部署。选择项目，右键单击然后转到 Properties->MyEclipse->Web 并选择 Deployment 选项卡。您可以在此处指定如何部署依赖项目以及如何部署从依赖项目中导出的 jar，等等。

# unix - 为 CURL 命令行设置 nosignal 选项？

> ID：14270582
> 
> 赞同：1
> 
> 时间：2013-01-11T02:11:43.033
> 
> 标签：unix, curl

从 libcurl 文档中，我了解到在使用多线程程序时必须将 NOSIGNAL 设置为 1。

但是，如果我从命令行调用 curl，我看不到 NOSIGNAL 开关/选项。直接调用curl时如何设置nosignal？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T11:08:15.797

您不能：正如您所说，cURL 帮助中没有记录这样的选项（您还可以验证`CURLOPT_NOSIGNAL`命令行源代码中没有引用 - 请参阅`src/tool_operate.c`）。

*现在的问题是你为什么需要这个，正如 Celada 所问的那样。在多线程上下文中使用 libcurl 是有意义的（即，您可能希望从多个线程创建/重用 curl 句柄） - 然后您应该遵循[最佳实践](http://curl.haxx.se/libcurl/c/libcurl-tutorial.html#Multi-threading)，但我没有看到 CLI 工具的意义。*

# ios - 我应该如何创建和传递用户令牌？

> ID：14270590
> 
> 赞同：1
> 
> 时间：2013-01-11T02:12:16.683
> 
> 标签：ios, api, rest, web-applications, flask

我正在编写一个 Web 应用程序（在烧瓶中），它具有 iOS 应用程序将与之通信的 API 后端。创建、传递和验证用户令牌的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T00:18:12.157

查看[flask-oauthprovider](https://github.com/ib-lundgren/flask-oauthprovider)。它可以让您保护这样的视图：

```
@provider.require_oauth()
def view_profile():
    ... 
```

并为您处理令牌请求。

# jasper-reports - 如何根据字段使行不正确重复

> ID：14270595
> 
> 赞同：-2
> 
> 时间：2013-01-11T02:12:46.770
> 
> 标签：jasper-reports

我已经根据性别创建了一份统计报告。字段名称***Jantina***。

删除*打印重复值*时出现问题。我只是希望该字段不会根据***Jantina***字段重复。***但不幸的是，如果没有跟随Jantina***，该行不会重复所有行。

怎么做？有人知道吗？

这是我的 jrxml 代码：

```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="penyata_bulanan_ikut_negeri_jantina_test" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
    <parameter name="bulan" class="java.lang.Integer">
        <defaultValueExpression><![CDATA[new Integer(-1)]]></defaultValueExpression>
    </parameter>
    <parameter name="tahun" class="java.lang.Integer">
        <defaultValueExpression><![CDATA[new Integer(-1)]]></defaultValueExpression>
    </parameter>
    <parameter name="negeri" class="java.lang.Integer">
        <defaultValueExpression><![CDATA[new Integer(00)]]></defaultValueExpression>
    </parameter>
    <parameter name="jantina" class="java.lang.Long">
        <defaultValueExpression><![CDATA[new Long(2)]]></defaultValueExpression>
    </parameter>
    <queryString>
        <![CDATA[SELECT @row := @row + 1 as r,bulan,tahun,negeri,jantina,
bilmale,jds,jumall,
ROUND(CAST((bilmale*100 /(jumall))AS DECIMAL(7,3)),2) as percent,
ROUND(CAST((jds*100 /(jumall))AS DECIMAL(7,3)),2) as p_jdk,
countstate
FROM some_table
group by date_format(X.createDate,'%Y' ),date_format(X.createDate,'%M' ),X.male,X.state
order by 1 asc) as a,(select @row := 0) as r]]>
    </queryString>
    <field name="r" class="java.lang.Long"/>
    <field name="bulan" class="java.lang.String"/>
    <field name="tahun" class="java.lang.String"/>
    <field name="negeri" class="java.lang.String"/>
    <field name="jantina" class="java.lang.String"/>
    <field name="bilmale" class="java.math.BigDecimal"/>
    <field name="jds" class="java.math.BigDecimal"/>
    <field name="jumall" class="java.math.BigDecimal"/>
    <field name="percent" class="java.math.BigDecimal"/>
    <field name="p_jdk" class="java.math.BigDecimal"/>
    <field name="countstate" class="java.lang.Long"/>
    <sortField name="bulan"/>
    <sortField name="tahun"/>
    <sortField name="negeri"/>
    <sortField name="jantina"/>
    <group name="bulan">
        <groupExpression><![CDATA[$F{bulan}]]></groupExpression>
        <groupHeader>
            <band/>
        </groupHeader>
        <groupFooter>
            <band/>
        </groupFooter>
    </group>
    <group name="jantina">
        <groupExpression><![CDATA[$F{jantina}]]></groupExpression>
    </group>
    <background>
        <band splitType="Stretch"/>
    </background>
    <title>
        <band height="48" splitType="Stretch">
            <staticText>
                <reportElement x="237" y="10" width="100" height="20"/>
                <textElement>
                    <font fontName="Arial" size="12"/>
                </textElement>
                <text><![CDATA[Penyata bulanan]]></text>
            </staticText>
        </band>
    </title>
    <pageHeader>
        <band splitType="Stretch"/>
    </pageHeader>
    <columnHeader>
        <band height="20" splitType="Stretch">
            <staticText>
                <reportElement x="0" y="0" width="79" height="20"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial"/>
                </textElement>
                <text><![CDATA[negeri]]></text>
            </staticText>
            <staticText>
                <reportElement x="79" y="0" width="79" height="20"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial"/>
                </textElement>
                <text><![CDATA[jantina]]></text>
            </staticText>
            <staticText>
                <reportElement x="158" y="0" width="79" height="20"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial"/>
                </textElement>
                <text><![CDATA[bilmale]]></text>
            </staticText>
            <staticText>
                <reportElement x="237" y="0" width="79" height="20"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial"/>
                </textElement>
                <text><![CDATA[jds]]></text>
            </staticText>
            <staticText>
                <reportElement x="316" y="0" width="79" height="20"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial"/>
                </textElement>
                <text><![CDATA[percent]]></text>
            </staticText>
            <staticText>
                <reportElement x="395" y="0" width="79" height="20"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial"/>
                </textElement>
                <text><![CDATA[p_jdk]]></text>
            </staticText>
            <staticText>
                <reportElement x="474" y="0" width="79" height="20"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial"/>
                </textElement>
                <text><![CDATA[countstate]]></text>
            </staticText>
        </band>
    </columnHeader>
    <detail>
        <band height="20" splitType="Stretch">
            <textField>
                <reportElement x="0" y="0" width="79" height="20"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial"/>
                </textElement>
                <textFieldExpression class="java.lang.String"><![CDATA[$F{negeri}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="79" y="0" width="79" height="20"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial"/>
                </textElement>
                <textFieldExpression class="java.lang.String"><![CDATA[$F{jantina}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="158" y="0" width="79" height="20"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial"/>
                </textElement>
                <textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{bilmale}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="237" y="0" width="79" height="20"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial"/>
                </textElement>
                <textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{jds}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement isPrintRepeatedValues="false" x="316" y="0" width="79" height="20"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial"/>
                </textElement>
                <textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{percent}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement isPrintRepeatedValues="false" x="395" y="0" width="79" height="20"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial"/>
                </textElement>
                <textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{p_jdk}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement isPrintRepeatedValues="false" x="474" y="0" width="79" height="20"/>
                <textElement textAlignment="Center">
                    <font fontName="Arial"/>
                </textElement>
                <textFieldExpression class="java.lang.Long"><![CDATA[$F{countstate}]]></textFieldExpression>
            </textField>
        </band>
    </detail>
    <columnFooter>
        <band splitType="Stretch"/>
    </columnFooter>
    <pageFooter>
        <band splitType="Stretch"/>
    </pageFooter>
    <summary>
        <band splitType="Stretch"/>
    </summary>
</jasperReport> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T02:52:06.440

答案是我创建组并将这个公式放在“当表达式时打印”的字段中。那是 new Boolean($V{negeri_COUNT}.intValue()==1) 并且我取消选中“打印重复值”

# javascript - 概述的预防方法的利弊元素从提交其封闭形式

> ID：14270599
> 
> 赞同：0
> 
> 时间：2013-01-11T02:13:14.983
> 
> 标签：javascript, ajax, html

我有一个`<button>`元素，我希望它的点击触发表单的 AJAX POST。如果我将`<button>`元素放在表单中，它会以提交表单的默认行为（非 ajax）响应点击。为了防止表单中元素的这种默认行为`<button>`，我可以执行以下任一操作：

1.  分配`type="button"`给`<button>`元素
2.  在事件处理程序中调用 e.preventDefault() `click`（即使用 jQuery）
3.  将按钮移到表单的外部

每种方法的优缺点是什么？

注意：在互联网上找到了无数的 SO 帖子或材料，它们谈论如何防止`<button>`元素提交其封闭形式，但没有一个谈论 WHY。这是一个为什么的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:18:11.823

使用类似于第二种方法的东西：

```
$('form').submit(function(e) {
    e.preventDefault();

    // AJAX stuff
}); 
```

其他两种方法使表单无法用于没有 JavaScript 的浏览器。不做任何事情的按钮会让用户感到沮丧。

# openni - 在 OS X 10.8 上使用 openNI 时出现链接器错误

> ID：14270601
> 
> 赞同：2
> 
> 时间：2013-01-11T02:13:21.270
> 
> 标签：openni

我已经在这个问题上停留了几天。我已经在 OpenNI 论坛和此处进行了搜索，并且尝试了对其他人有用的修复程序，但仍然遇到链接器错误。
我将从头开始：我使用命令行 ./install 为 OSX 安装了 OpenNI 2.0。一切顺利。它创建了环境变量：

```
export OPENNI2_INCLUDE=/Users/Robert/Documents/Kinect/OpenNI-2.0.0/Include
export OPENNI2_REDIST=/Users/Robert/Documents/Kinect/OpenNI-2.0.0/Redist 
```

我进入 xCode 并按照此处的说明[http://cicconet.wordpress.com/2011/03/24/openni-and-xcode-4/](http://cicconet.wordpress.com/2011/03/24/openni-and-xcode-4/) 让 xcode 与 OpenNI SDK 一起工作 我将 /usr/include/ni 添加到“Header Search Paths” 并将 libOpenNI.dylib 添加到框架文件夹中，并将其放在项目目录中。Xcode intellasence 具有所有 OpenNI 方法，并且在编写代码时我没有遇到任何错误。我使用的代码是：

```
#include <OpenNI.h>
using namespace openni;
int main(int argc, const char * argv[])
{
    OpenNI::initialize();
    return 0;
} 
```

我得到的错误是：

```
Undefined symbols for architecture x86_64:
  "_oniInitialize", referenced from:
      openni::OpenNI::initialize() in main.o
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

我是否忘记在某处包含某些内容？

# php - Yii 加入后忽略自定义字段

> ID：14270605
> 
> 赞同：0
> 
> 时间：2013-01-11T02:14:06.937
> 
> 标签：php, mysql, yii

当我添加`$criteria->with=array('profile');`字段时，`revent_datetime`总是返回 NULL，但没有返回权。为什么会发生标准？`with``revent_datetime``with`

控制器.php

```
public function actionIndex()
{
    $dayofweek = date('w');
    $criteria = new CDbCriteria;
    $criteria->select=array("
        CASE 
            WHEN weekday >= $dayofweek
            THEN CONCAT( DATE_ADD(CURDATE(), INTERVAL weekday - $dayofweek DAY), ' ', event_time )
            ELSE CONCAT( DATE_ADD(CURDATE(), INTERVAL 7 - $dayofweek + weekday DAY), ' ', event_time )
        END as revent_datetime,

        CASE 
            WHEN weekday >= $dayofweek AND list_time IS NOT NULL
            THEN CONCAT( DATE_ADD(CURDATE(), INTERVAL weekday - $dayofweek DAY), ' ', list_time )
            ELSE CONCAT( DATE_ADD(CURDATE(), INTERVAL 7 - $dayofweek + weekday DAY), ' ', list_time )
        END as rlist_datetime
    ");

    $criteria->with=array('profile'); // Thats the line w/ problem.

    $dataProvider=new CActiveDataProvider('Eventsreminder', array(
            'criteria' => $criteria
    ));

    $this->render('index',array(
        'dataProvider'=>$dataProvider,
    ));
} 
```

* * *

输出：

```
$dataProvider->profile->name = Profile Test
$dataProvider->revent_datetime = NULL // here is the problem
$dataProvider->rlist_datetime = 2013-01-11 20:00:00 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T05:26:07.007

好吧，如果你在 select 中使用函数，你必须创建 CDbExpression：

```
$criteria->select=array(
    new CDbExpression("CASE 
        WHEN weekday >= $dayofweek
        THEN CONCAT( DATE_ADD(CURDATE(), INTERVAL weekday - $dayofweek DAY), ' ', event_time )
        ELSE CONCAT( DATE_ADD(CURDATE(), INTERVAL 7 - $dayofweek + weekday DAY), ' ', event_time )
    END as revent_datetime"),
    new CDbExpression("CASE 
        WHEN weekday >= $dayofweek AND list_time IS NOT NULL
        THEN CONCAT( DATE_ADD(CURDATE(), INTERVAL weekday - $dayofweek DAY), ' ', list_time )
        ELSE CONCAT( DATE_ADD(CURDATE(), INTERVAL 7 - $dayofweek + weekday DAY), ' ', list_time )
    END as rlist_datetime")
); 
```

# irc - xchat 连接失败。错误：试图以访问权限禁止的方式访问套接字

> ID：14270606
> 
> 赞同：4
> 
> 时间：2013-01-11T02:14:12.283
> 
> 标签：irc

如果你们中的任何人都可以帮助我，那么我会很感激你。

正如我经常做的那样，我打开我的 xchat（irc 客户端），然后当我选择**frrenode**进行连接时，我得到了这个糟糕的错误。我尝试与其他 irc 连接，但我得到了同样的错误。我刚刚在 irc 上检查了我的网络设置，那里一切正常，idk wtf 正在进行。

错误如下图

```
Quote: * Looking up irc.freenode.net
* Connecting to irc.freenode.net (213.232.93.3) port 6667...
* Connection failed. Error: An attempt was made to access a socket in a way forbidden by its access permissions 
```

# c++ - 在 C++ 中包含函数的问题

> ID：14270607
> 
> 赞同：0
> 
> 时间：2013-01-11T02:14:19.907
> 
> 标签：c++, include, function-pointers, header-files

我是 C++ 新手，我不知道为什么我的标头无法正常工作。如果我包含`fitzhough()`主文件中的函数，一切正常。但是，如果我尝试将其添加为单独的文件，则会出现错误：

```
obj\Debug\main.o||In function `main':|
C:\Users\Dan\Documents\C code\RK4\main.cpp|83|undefined reference to `fitzhough(double, Eigen::Matrix<double, 2, 1, 0, 2, 1>, double, double*)'|
||=== Build finished: 1 errors, 0 warnings (0 minutes, 0 seconds) ===| 
```

我的代码如下。任何帮助将不胜感激。

**主文件**

```
# include < iostream >
# include < fstream >
# include < Eigen/Dense >
# include "gnuplot.h"
# include "addfitzhough.h"

using namespace std;

using namespace Eigen;

Vector2d RK4(Vector2d (*f)(double, Vector2d, double, double*), double t, Vector2d z, double h, double u, double *Iion, int d) {

  VectorXd Y1(d), Y2(d), Y3(d), Y4(d), Y1buf(d), Y2buf(d), Y3buf(d);

  Y1 = z;
  Y1buf = (*f)(t,Y1,u, Iion);
  Y2 = z + 0.5*h*Y1buf;
  Y2buf = (*f)(t+.5*h,Y2,u, Iion);
  Y3 = z + 0.5*h*Y2buf;
  Y3buf = (*f)(t+.5*h,Y3,u, Iion);
  Y4 = z + h*Y3buf;

  Vector2d yn = z + (h/6.0)*(Y1buf + 2.0*Y2buf + 2.0*Y3buf + (*f)(t+h,Y4,u, Iion));

  return yn;
}

int main() {

  //int mydims = 2;

  double u = 0;
  double *Iion;
  double h = .5;

  double y1ans[800];
  double y2ans[800];
  double tans[800];

  Vector2d ycurr;

  Vector2d Ynot, yplus;

  Ynot << .2,
          .1;

  y1ans[0] = Ynot(0);
  y2ans[0] = Ynot(1);
  tans[0] = 0.0;

  for(int i = 1;i<800;i++){
    tans[i] = tans[i-1] + h;
    ycurr << y1ans[i-1],
             y2ans[i-1];
    yplus = RK4(fitzhough,tans[i],ycurr,h,u,Iion,2);
    y1ans[i] = yplus(0);
    y2ans[i] = yplus(1);
  }
} 
```

**addfitzhough.h（在单独的文件中）**

```
#ifndef FF
#define FF

using namespace Eigen;

Vector2d fitzhough(double t, Vector2d Y, double u, double * Iion);

#endif // FITZ 
```

**菲州.cpp**

```
#include <Eigen/Dense>

using namespace std;
using namespace Eigen;

Vector2d fitzhough(double t, Vector2d Y, double u, double * Iion) {

  Vector2d dy;

  double v = Y(0);
  double w = Y(1);

  double a = .13;
  double b = .013;
  double c1 = .26;
  double c2 = .1;
  double d = 1.0;

  dy(0) = c1*v*(v-a)*(1-v)-c2*w*v + u;
  dy(1) = b*(v-d*w);

  *Iion = dy(0)-u;

  return dy;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:27:04.383

看起来您没有链接到 fitzhough.o（fitzhough.cpp 的输出）。您是否将 fitzhough.cpp 插入到项目中？

顺便说一句，如果您正在实施 FitzHugh-Nagumo，他的名字拼写为 FitzHugh :p

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:22:23.480

看起来您的构建系统要么没有构建，要么没有在链接阶段`fitzhough.cpp`添加`fitzhough.o`。

如果您还没有，您应该添加`fitzhough.cpp`到代码块项目（或等效项目）中。

# actionscript-3 - SimpleButton 内的自定义 Flash 组件导致编译器错误

> ID：14270620
> 
> 赞同：1
> 
> 时间：2013-01-11T02:15:51.597
> 
> 标签：actionscript-3, flash, button, compiler-errors, flash-component

我对 Flash pro CS5.5 和 CS6 中的按钮有一个奇怪的问题。我正在向按钮添加一个自定义组件，由于某种原因，我收到了这个编译器错误。

> Symbol1_1，第 8 行 1086：语法错误：在右括号之前需要分号。

经过一番研究，我发现 Adob​​e 创建的 FLVPlayback 组件也导致了该错误。要重现它，请创建一个按钮并在任何命名的帧（UP、OVER、DOWN 或 HIT）上放置一个 FLVPlayback 组件，然后编译 fla。我还注意到 Adob​​e 创建的其他组件在按钮中编译得很好，但前提是它们没有预编译。只有预编译的组件似乎在按钮上有问题。不幸的是，我需要一个预编译的组件。

有没有其他人看过这个？有解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T12:39:22.360

我认为最好使用 MovieClip 而不是 Button。对于MovieClips 没有这样的问题。

# linux - 如何在 Linux 中将数组与 awk 一起使用

> ID：14270621
> 
> 赞同：1
> 
> 时间：2013-01-11T02:15:56.363
> 
> 标签：linux, arrays, awk

```
INFO #my-service# #add# id=67986324423 isTrial=true
INFO #my-service# #add# id=43536343643 isTrial=false
INFO #my-service# #add# id=43634636365 isTrial=true
INFO #my-service# #add# id=67986324423 isTrial=true
INFO #my-service# #delete# id=43634636365 isTrial=true
INFO #my-service# #delete# id=56543435355 isTrial=false 
```

我想计算具有唯一 id 且其中具有`#add#`属性的行并具有`isTrial=true`.

这是我当前的解决方案，我想知道为什么我的阵列没有打印

```
BEGIN { print "Begin Processing of various Records"}

{if($3~"add" && $5~"true")
   {
   ++i; 
   if($4 not in arr){arr[i]=$4;++j} 
   }
  {print $0}
}

 END {print "Process Complete:--------"j} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:32:04.897

使用 awk 的一种方法：

```
$ awk '$3 ~ /add/ && $5 ~ /true/{sub(/.*=/,"",$4);a[$4]++;}END{for (i in a)print i, a[i];}' file
43634636365 1
67986324423 2 
```

关于您的解决方案：

1.  当你使用 contains( `~`) 操作符时，模式应该总是在斜杠( `//`) 中提供，而不是直接在双引号中。

2.  当您检查时`$4 not in arr`，它会检查数组键中的 $4，而您将 $4 填充为数组值`arr[i]=$4`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T02:48:58.930

您需要测试以查看第四个字段是否不在数组中，如下所示：

```
BEGIN {
    print "Begin Processing of various Records"
}

$3 ~ /add/ && $5 ~ /true/ && !a[$4]++ {

    i++
    print
}

END {
    print "Process Complete. Records found:", i
} 
```

结果：

```
Begin Processing of various Records
INFO #my-service# #add# id=67986324423 isTrial=true
INFO #my-service# #add# id=43634636365 isTrial=true
Process Complete. Records found: 2 
```

[这里有一些](http://www.gnu.org/software/gawk/manual/html_node/Array-Basics.html#Array-Basics)您可能感兴趣的信息。HTH。

* * *

根据下面的评论，您也可以这样做：

```
BEGIN {
    print "Begin Processing of various Records"
}

$3 ~ /add/ && $5 ~ /true/ && !a[$4] {

    a[$4]++
    print 
}

END {
    print "Process Complete. Records found:", length(a)
} 
```

请注意，这与：

```
BEGIN {
    print "Begin Processing of various Records"
}

$3 ~ /add/ && $5 ~ /true/ && !a[$4] {

    # See the line below. I may not have made it clear in the comments that
    # you can indeed add things to an array without assigning the key a
    # value. However, in this case, this line of code will fail because our
    # test above (!a[$4]) is testing for an absence of value associated
    # with that key. And the line below is never assigning a value to the key!
    # So it just won't work.

    a[$4]

    # Technically, you don't need to increment the value of the key, this would
    # also work, if you uncomment the line:

    # a[$1]=1

    print 
}

END {
    print "Process Complete. Records found:", length(a)
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T02:28:02.510

```
grep '#add#.*isTrial=true' input | sed 's/[^=]*=\([^ ]*\).*/\1/' | sort | uniq -c 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T07:46:29.327

```
awk '$5~/isTrial=true/ && $3~/#add#/{a[$4]}END{for(i in a){count++}print count}' 
```

[在这里](http://ideone.com/r1ao9p)测试

# ruby - 将 x 与 x.method 进行比较时出现奇怪的语法错误

> ID：14270622
> 
> 赞同：0
> 
> 时间：2013-01-11T02:15:58.210
> 
> 标签：ruby, syntax-error

为什么这很好用：

```
t="
"+$<.read;puts t.reverse==t ?"YES":"NO" 
```

但是这个：

```
t="
"+$<.read;puts t==t.reverse ?"YES":"NO" 
```

说：

```
A.rb:2: syntax error, unexpected tCHAR, expecting $end
"+$<.read;puts t==t.reverse ?"YES":"NO"
                              ^ 
```

我使用 ruby​​ 1.9.2p290 (2011-07-09) [i386-mingw32]。
示例 STDIN 字符串是`XX.\n...\n.XX\n`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:27:20.813

看起来 Ruby 正在将后者解析为对`#reverse?`. 当以另一种方式切换时，这种歧义就被消除了。在条件周围添加括号应该允许它双向。

# ios - 从 NSArray 中删除双重（NSManagedObjects）的更好方法（也是逻辑缺陷）

> ID：14270623
> 
> 赞同：0
> 
> 时间：2013-01-11T02:16:01.763
> 
> 标签：ios, nsarray, nsmanagedobject

我做了以下方法来删除双打，但它并不完全有效。有什么建议么？

感谢您的帮助，

```
 -(NSMutableArray*)removeDuplicateCars:(NSMutableArray*)array{
    NSMutableArray *noDuplicates =[[NSMutableArray alloc]init];
    for (int i=0; i<[array count]; i++) {
        int counter =0;
        Car *car =(Car*)[array objectAtIndex:i];
        if ([noDuplicates count]==0) {
            [noDuplicates addObject:car];
        }
        for (int i=0; i<[noDuplicates count]; i++) {
            Car *car2 =(Car*)[array objectAtIndex:i];
            if (![car.name isEqualToString:car2.name]) {
                counter++;
            }
        }
        if (counter==[noDuplicates count]) {
            [noDuplicates addObject:car];
        }
    }
    NSLog(@"number of results = %i",[noDuplicates count]);
    return noDuplicates;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:30:29.820

创建一个名为“ addedCars”的数组 - 您将使用它来存储每辆独特汽车的名称。

在每次迭代中，使用 [NSArray containsObject:] 检查当前名称是否已添加到“addedCars”。如果没有，请将名称添加到“addedCars”，将汽车添加到“noDuplicates”。否则，跳过此项，因为它已添加到 noDuplicates。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:22:30.643

确保`[isEqual:]`并按`[hash]`预期实施

```
-(NSMutableArray*)removeDuplicateCars:(NSMutableArray*)array{
    NSOrderedSet *set = [[NSOrderedSet alloc] initWithArray:array];
    NSMutableArray *newArr = [NSMutableArray arrayWithCapacity:[set count]];
    for (id obj in set) {
        [newArr addObject:obj];
    }
    return newArr;
} 
```

* * *

您曾经`![car.name isEqualToString:car2.name]`比较对象，所以我相信您想过滤具有相同名称的对象？`[isEqual:]`比你需要覆盖`Car`

```
- (BOOL)isEqual:(id)other {
    if ([other isKindOfClass:[self class]]) {
        return [self.name isEuqalToString: [other name]];
    }
    return NO;
}

- (NSUInteger)hash {
    return [self.name hash];
} 
```

* * *

还检查这个问题[The best way to remove duplicate values from NSMutableArray in Objective-C?](https://stackoverflow.com/questions/1025674/the-best-way-to-remove-duplicate-values-from-nsmutablearray-in-objective-c)

# postgresql - cloudfoundry 上的 grails 应用程序，如果定义了多数据源

> ID：14270625
> 
> 赞同：0
> 
> 时间：2013-01-11T02:16:06.240
> 
> 标签：postgresql, grails, datasource, bind, cloud-foundry

**将 grails 应用程序部署到 cloudfoundry 时，如果定义多数据源，则会出现错误：** Cannot create JDBC driver of class 'org.postgresql.Driver' for connect URL 'n/a'

```
 dataSource {
      dialect = "org.hibernate.dialect.MySQLInnoDBDialect"
      driverClassName = 'com.mysql.jdbc.Driver'
      username = 'n/a'
      password = 'n/a'
      url = 'n/a'
      dbCreate = 'update'
   }
   dataSource_postgre {
       dialect = "org.hibernate.dialect.PostgresPlusDialect"
       driverClassName = "org.postgresql.Driver"
       username = 'n/a'
       password = 'n/a'
       url = "n/a"
       dbCreate = 'update'
    } 
```

**但正如我从[http://blog.springsource.com/2011/04/12/one-step-deployment-with-grails-and-cloud-foundry/](http://blog.springsource.com/2011/04/12/one-step-deployment-with-grails-and-cloud-foundry/)知道的 那样：**

当您将服务绑定到 Cloud Foundry 中的应用程序时，您是在告诉云在运行时将该服务的连接设置传递给应用程序。然后，Cloud Foundry 插件会获取该信息并覆盖应用程序中的连接设置。就像变魔术一样，您的应用程序随后可以透明地针对云服务运行，而您无需执行任何操作！这适用于所有可用的服务，而不仅仅是 MySQL

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T08:42:49.693

CloudFoundry will reconfigure the data source and replace your local DataSource definition. The way you notify CloudFoundry about the services you need is interacting with CF with [vmc Tunneling with Caldecott](http://docs.cloudfoundry.com/tools/vmc/caldecott.html) command or [Cloud Foundry Integration for STS](http://docs.cloudfoundry.com/tools/STS/deploying-CF-Eclipse.html).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T11:47:48.590

如果可能，使用 VMC 检查应用程序的日志，在 staging.log 中，您应该会看到已自动配置的服务的摘要。

我必须检查这是否可以使用两种服务，您可能必须使用 VCAP_SERVICES 环境变量手动配置一项。

# servlets - 如何检索现有的 cookie？

> ID：14270626
> 
> 赞同：1
> 
> 时间：2013-01-11T02:16:07.707
> 
> 标签：servlets, cookies

如果 cookie 尚不存在，我必须创建一个新 cookie。如果 cookie 已经存在，那么我不应该覆盖它，而只是返回它。

如何验证 cookie 是否存在？我看过`javax.servlet.http.Cookie`API，但找不到任何线索。

如何检索和验证现有 cookie？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:35:32.657

您可以通过 获取所有 cookie [`HttpServletRequest#getCookies()`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#getCookies%28%29)。

```
Cookie[] cookies = request.getCookies();

if (cookies != null) {
    for (Cookie cookie : cookies) {
        String name = cookie.getName();
        String value = cookie.getValue();
        // ...
    }
} 
```

请注意，这已仅包含有效（未过期）的 cookie。浏览器也不会随请求发送过期的cookies。

# c++ - 子类真的继承私有成员变量吗？

> ID：14270631
> 
> 赞同：12
> 
> 时间：2013-01-11T02:16:19.533
> 
> 标签：c++, inheritance, private, members

基本上据我所知，当您创建一个具有公共、受保护和私有部分以及每个公共和受保护部分中的变量/函数的基类时，将继承到子类的适当部分（由类子类定义：私有基础，它将获取基础的所有公共和受保护成员并将它们公开，将“私有”一词更改为“公开”将它们全部公开，并将其更改为“受保护”将它们全部变为“受保护”）。

因此，当您创建一个子类时，您永远不会从前一个类（在本例中为基类）的私有部分收到任何内容，如果这是真的，那么子类的对象不应该有它自己的版本基类中的私有变量或函数是否正确？

让我们来看一个例子：

```
#include <iostream>

class myClass     // Creates a class titled myClass with a public section and a private section.
{
public:
  void setMyVariable();
  int getMyVariable();
private:
  int myVariable;     // This private member variable should never be inherited.
};

class yourClass : public myClass {};    // Creates a sub-class of myClass that inherits all the public/protected members into  the
// public section of yourClass. This should only inherit setMyVariable()
// and getMyVariable() since myVariable is private. This class does not over-ride any
// functions so it should be using the myClass version upon each call using a yourClass
// object. Correct?

int main()
{
  myClass myObject;           // Creates a myClass object called myObject.
  yourClass yourObject;       // Creates a yourClass object called yourObject
  yourObject.setMyVariable(); // Calls setMyVariable() through yourObject. This in turn calls the myClass version of it    because
  // there is no function definition for a yourClass version of this function. This means that this
  // can indeed access myVariable, but only the myClass version of it (there isn't a yourClass
  // version because myVariable is never inherited).

  std::cout << yourObject.getMyVariable() << std::endl;   // Uses the yourClass version of getMyVariable() which in turn
  // calls the myClass version, thus it returns the myClass myVariable
  // value. yourClass never has a version of myVariable Correct?

  std::cout << myObject.getMyVariable() << std::endl;     // Calls the myClass version of getMyVariable() and prints myVariable.

  return 0;
}

void myClass::setMyVariable()
{
  myVariable = 15;        // Sets myVariable in myClass to 15.
}

int myClass::getMyVariable()
{
  return myVariable;      // Returns myVariable from myClass.
} 
```

现在，根据我的想法，理论上应该打印：15 15 因为它总是使用函数的 myClass 版本（因此使用 myClass myVariable）。但是，奇怪的是，事实并非如此。运行这个程序的结果是：15 0 这让我想知道，我们真的不仅继承了 myVariable，而且我们也有能力去搞砸它吗？显然，这是在以某种方式创建 myVariable 的替代版本，否则 myClass 版本不会有 0。通过执行所有这些操作，我们确实在编辑 myVariable 的第二个副本。

有人可以向我解释这一切吗，这打破了我对继承的理解。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-11T03:03:10.573

> 基本上据我所知，当您创建一个具有公共、受保护和私有部分以及每个公共和受保护部分中的变量/函数的基类时，将继承到子类的适当部分（由类子类定义：私有基础，它将获取基础的所有公共和私有成员并将它们公开，将“私有”一词更改为“公开”将它们全部公开，并将其更改为“受保护”将它们全部置于受保护的状态）。

这个说法有点混乱。

回想一下，继承是为 C++ 中的类和结构定义的。单个对象（即实例）不会从其他对象继承。使用其他对象构造一个对象称为*组合*。

当一个类从另一个类继承时，它会从该类中获取所有内容，但是继承字段的访问级别可能会禁止它们在继承者中的使用。

此外，类有 3 种继承方式：（`private`默认）`protected`、 和`public`. 当被子类继承时，它们中的每一个都会更改类属性和方法的访问级别。

如果我们以这种方式对访问级别进行排序：`public`, `protected`, `private`, 从受保护最少到受保护最多，那么我们可以将继承修饰符定义为将继承的类字段的访问级别至少提高到它们指定的级别，在派生类（即继承的类）。

例如，如果类`B`从`A`具有`protected`继承修饰符的类继承：

```
 class B : protected A { /* ... */ }; 
```

那么来自的所有字段`A`将至少具有以下`protected`级别`B`：

*   `public`字段变为`protected`（`public`级别提升到`protected`），
*   `protected`字段保持`protected`不变（相同的访问级别，所以这里没有修改），
*   `private`字段保持`private`（访问级别已经在修饰符之上）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-11T02:35:48.103

*“当你创建一个子类时，你永远不会从[基类]的私有部分收到任何东西。如果这是真的，那么子类的对象不应该有它自己版本的私有变量或来自基类的函数上课，对吗？”*

不，派生类继承了基类的所有成员，包括私有成员。继承类的对象*具有*这些私有成员，但不能*直接访问*它们。它可以访问可以访问这些成员的基类的公共成员，但它（派生类）可能没有具有此类访问权限的新成员函数：

```
class yourClass : public myClass
{
public:
  void playByTheRules()
  {
    setMyVariable(); // perfectly legal, since setMyVariable() is public
  }

  void tamperWithMyVariable()
  {
    myVariable = 20; // this is illegal and will cause a compile-time error
  }
}; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-11T02:23:22.843

`myObject`并且`yourObject`是两个不同的对象！他们为什么要分享任何东西？

这样想：忘记继承，假设你有一个`Person`带有`private int age;`and的类`public void setAge (int age) {...}`。然后实例化两个对象：

```
Person bob;
Person bill;
bob.setAge(35); 
```

你希望比尔现在也 35 岁吗？你不会的，对吧？同样，您`myObject`不会与`yourObject`.

* * *

回应您的评论：

该类`yourClass`继承自`myClass`. 这意味着两者`yourObject`都有`myObject`自己的`myVariable`，后者显然根据定义，前者继承自`myClass`。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-01-11T03:17:59.230

从物理上讲，基类的每个成员（包括成员函数）都进入了子类。没关系，如果他们是私人的。如果您公开/受保护/私下继承它们都没关系。所以在你的例子中，`yourClass`包含所有三个`getMyVariable()`，`setMyVariable()`和`myVariable`。这一切都很简单，好吗？

重要的是我们如何访问它们。就像在系统上删除文件一样。因此，您应该首先了解成员不存在与成员存在但无法访问之间的区别。现在假设所有继承都是公开进行的。然后，基类的所有公共成员在派生类中都是公共的，受保护的成员是受保护的，私有成员是不可访问的。它们是不可访问的并且不是不存在的，因为在基类的受保护和公共部分中可能有一些成员函数可以访问基类的私有成员。因此，我们需要 base 的所有私有成员，这些私有成员可以被 base 的公共和受保护的成员函数访问，以实现它们的功能。由于我们无法以简单的方式确定哪个成员函数需要哪个成员，我们在派生类中包含基类的所有私有成员。这一切仅仅意味着在派生类中，只能通过基类的成员函数来修改私有成员。

注意：每个私有成员都必须直接或间接地[通过另一个私有成员函数，该函数又被公共/受保护成员函数调用]由公共/受保护成员函数访问，否则它没有用处。

因此，到目前为止，我们知道基类的私有成员变量在派生类中有它的用途，即用于其公共/受保护成员函数的功能。但是它们不能在基类中直接访问。

现在，我们将注意力转向私有/公共继承。对于公共继承，这意味着基类的所有可访问成员（即公共和受保护成员）不能处于比公共更宽松的级别。由于 public 是最宽松的级别，因此 public 和受保护的成员仍然是 public。但是在受保护和私有继承中，在派生类中都分别成为受保护和私有。在后一种情况下，由于所有这些成员都是私有的，因此它们不能在层次结构链中进一步访问，但可以由给定的派生类访问。

因此，派生类中每个基类成员的级别是它们在派生类中的级别（）和继承类型（public/protected/private）中的较小者。

同样的概念也适用于类外的功能。对于他们来说，私有成员和受保护成员是不可访问的，但它们确实存在并且可以被公共成员函数访问。

并以您的案例为最终示例，`setMyvariable()`并且`getMyVariable()`可以`myVariable`在派生类中访问。但是派生类中指定的任何函数都不能访问`myVariable`。修改你的类：

```
class myClass
{
public:
  void setMyVariable();
  int getMyVariable();
private:
  int myVariable;
};

class yourClass : public myClass
{
public:
  // void yourFunction() { myVariable = 1; }
  /*Removing comment creates error; derived class functions can't access myVariable*/
}; 
```

此外：您也可以为继承类型添加例外，例如私有继承，但派生类中公开的成员除外。但这完全是另一个问题。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-01-11T02:21:13.810

你从不打电话`myObject.setMyVariable()`，所以`myObject.getMyVariable()`不会返回 15。

`private`并不意味着`static`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-01T08:12:46.997

后：

```
class yourClass : public myClass {}; 
```

**仍然只有一个成员变量**。但是有两种通过名称访问它的方法：`myClass::myVariable`和`yourClass::myVariable`。

在这些表达式中，类名称为*命名类*。要理解的第二个关键点是**访问权限适用于命名类和成员名的组合**；不仅针对成员名称，也不针对变量本身。

如果在没有显式存在命名类的情况下提及成员，则从该成员左侧的表达式的类型`.`或`->`命名该成员的表达式的类型推断出命名类（`this->`如果没有这样的表达式，则隐含）。

此外，实际上有四种可能的访问类型：`public`、`protected`、`private`和*无访问*。您不能将成员声明为*没有访问权限*，但是当继承私有成员时会出现这种情况。

* * *

将所有这些理论应用于您的示例：

*   名字`myClass::myVariable`是`private`。
*   这个名字`yourClass::myVariable`是*没有权限*的。

重申一下，实际上只有一个变量，但它可能以两种不同的方式命名，并且访问权限因使用的名称而异。

* * *

最后，回到你原来的例子。`myObject`并且`yourObject`是不同的对象。我想你打算写的，或者你心里想象的，其实是这样的情况：

```
yourClass yourObject;
myClass& myObject = yourObject;
//    ^^^ 
```

这意味着`myObject`命名`yourObject`. 然后：

```
yourObject.setMyVariable(); 
```

变量设置为`15`，所以

```
std::cout << myObject.getMyVariable() << std::endl; 
```

会输出`15`，因为确实只有一个变量。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2017-09-12T04:29:08.620

这可能会有所帮助

```
#include<iostream>
using namespace std;

class A
{
int b;  
};

class B : private A
{

};

int main()
{
C obj;
cout<<sizeof(obj);  
return 0;
} 
```

# javascript - 替换两个项目之间的字符串

> ID：14270633
> 
> 赞同：0
> 
> 时间：2013-01-11T02:16:38.503
> 
> 标签：javascript, regex

相当简单的问题，如何在两个和标签之间`\n`替换？`{br}``<blockquote>``</blockquote>`

认为这会起作用，但它没有：

```
val = val.replace(/<blockquote>\b\n\b<\/blockquote>/igm, "{br}"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T02:18:48.127

使用替换回调：

```
val = val.replace(
    /<blockquote>[\s\S]*?<\/blockquote>/i,
    function(m) {return m.replace(/\n/g,"{br}");}
); 
```

# tomcat - 无法连接安卓模拟器查看本地站点和服务

> ID：14270634
> 
> 赞同：0
> 
> 时间：2013-01-10T13:49:55.177
> 
> 标签：tomcat, android

我正在尝试使用 Android 模拟器来使用在我的本地机器上运行的服务。我有一个在 IIS 下运行的站点，它在我的主机文件中如下所示：

```
127.0.0.1       www.local.company.co.uk 
```

我有几个在 Apache Tomcat 下运行的站点。我的 Tomcat 相关站点的主机文件：

```
127.0.0.1       internal.localhost.company.com  # port:8090
127.0.0.2       external.localhost.company.com  # port:8081
127.0.0.3       auth.ws.localhost.company.com  # port:8082
127.0.0.8       mysite.localhost.company.com  # port:8086 
```

到目前为止我尝试过的（在以下步骤中）：

```
adb pull /etc/hosts 
```

编辑安卓主机文件：

```
127.0.0.1        localhost
10.0.2.2         myefc.localhost.efinancialcareers.com

adb remount
adb push hosts /etc/hosts 
```

然后我尝试在浏览器中访问 myefc.localhost.efinancialcareers.com 并被告知找不到网页。我至少希望它可以访问 www.local.company.co.uk。

理想情况下，我希望能够访问上述主机文件示例中指定的本地计算机上的任何站点。

我在 Windows 7 上使用 Tomcat 6。我使用的模拟器是 nexus one。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:43:32.490

I recommend to read this arcticle: [http://developer.android.com/tools/devices/emulator.html#emulatornetworking](http://developer.android.com/tools/devices/emulator.html#emulatornetworking)

'Each instance of the emulator runs behind a virtual router/firewall service that isolates it from your development machine's network interfaces and settings and from the internet. An emulated device can not see your development machine or other emulator instances on the network. Instead, it sees only that it is connected through Ethernet to a router/firewall."

There are some recommendation in there for advanced networking.

# c# - 在 ASP.NET 中转发身份验证

> ID：14270636
> 
> 赞同：2
> 
> 时间：2013-01-11T02:16:53.163
> 
> 标签：c#, asp.net, authentication

在我的 ASP.NET 应用程序中，我使用 WebClient 下载文件。该文件几乎总是在公司内部网上，并且需要访问权限。每当我在 VS 中运行应用程序时，它都能正常工作，因为它是在我自己权限的上下文中运行的。但是，当它部署到 IIS 时，它在“网络服务”权限的上下文中运行，而对于 Intranet，这些权限基本上不存在（如您所料）。

我可以在这里看到一些糟糕的解决方案：

*   专门为应用程序创建一个帐户，其详细信息将位于 web.config 并作为字符串提供给 WebClient。这是次优的，因为并非所有服务用户都具有相同的权限。
*   需要输入用户名和密码。这永远不会被批准，因为公司尽可能使用证书。密码用于登录 Windows，此后几乎所有内容都在 Kerberos 的帮助下使用 Windows 身份验证

最佳解决方案是将当前访问（并通过 Kerberos 提供 Windows 身份验证数据）的人员的凭据直接传递给 WebClient 对象。这可能吗？如果是这样，怎么会？如果有人能告诉我，或者至少让我摆脱痛苦并告诉我这是不可能的，我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T02:00:49.053

模拟被证明是最佳解决方案。谢谢你，JT。

有很多很好的资源可以将 Windows 身份验证与模拟联系起来。一个我实际上并没有使用，但后来发现并且看起来非常全面的，可以在这里找到：

[http://www.codeproject.com/Articles/94612/Windows-Authentication](http://www.codeproject.com/Articles/94612/Windows-Authentication)

在我的情况下也需要委托，这个人解释得很好，并链接到一个有用的 msdn 文档：

[http://blog.reveille.org.uk/2010/01/asp-net-impersonation-delegation-2/](http://blog.reveille.org.uk/2010/01/asp-net-impersonation-delegation-2/)

# java - 超类类型的 Arraylist，用于保存各种子类类型

> ID：14270639
> 
> 赞同：-1
> 
> 时间：2013-01-11T02:17:35.430
> 
> 标签：java, object, arraylist

我的课程中的功能经过测试后已经工作。ColorDrop 创建指定颜色的下降滴。指定速度的 SpeedDrop 等等。我想将我的水滴放在一个列表中，然后在 GUI 中批量生产它们。Drop 是超类，ColorDrop 和 SpeedDrop 是扩展超类的子类。代码编译，但 GUI 是空白的。我组装我的arraylist错了吗？还是我错误地调用了该列表对象的方法？

```
 package advancedobject;

import java.awt.Color;
import java.awt.Graphics2D;
import java.util.ArrayList;

public class MyGooDrop extends Goo {

    Drop testDrop;
    Drop colorDrop;
    Drop fastDrop;
    Drop wavyDrop;
    int random = (int) Math.random()*width; 
    ArrayList<Drop> drops;
    public MyGooDrop() 
    {

        testDrop = new Drop(width/2, -10, 10);
        colorDrop =  new ColorDrop(width/3, -10, 10, Color.BLUE);
        fastDrop = new SpeedDrop ( (width * 3/4), -10, 10, 5);
        wavyDrop = new WavyDrop (-10, height/2, 10);
        drops = new ArrayList<Drop>();
        fillDropList();
    }

      public void fillDropList ()
    {
        for(int i = 0; i<= 12; i++)
        {
           if (i <= 4)
           drops.add(i, new Drop ((int) Math.random()*width, -10, 10));
           else if (i>4 && i<=8)
           drops.add(i, new ColorDrop ((int) Math.random()*width, -10, 10, Color.BLUE)); //drops.get(i).randomPainter()
           else
           drops.add(i, new SpeedDrop ((int) Math.random()*width, -10, 10, (int) Math.random()*10));
        }
    }

    public void draw(Graphics2D g) {

        // Fill background 
        g.setColor(Color.GRAY);
        g.fillRect(0, 0, width, height);

        testDrop.draw(g);
        colorDrop.draw(g);
        fastDrop.draw(g);
        wavyDrop.draw(g);
      for(int i = 0; i<=12; i++)
       drops.get(i).draw(g);
    }

    public void update(){

        testDrop.move(width, height);
        colorDrop.move(width, height);
        fastDrop.move(width, height);
        wavyDrop.move(width, height);
        for(int i = 0; i<=12; i++)
        drops.get(i).move(width, height);
    }

    public static void main(String[] args) {

        MyGooDrop tester = new MyGooDrop();
        tester.go();

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T03:32:40.687

好吧，让我们一点一点地看一些东西。看到您将 AWT 与 Graphics2D 一起使用，我将假设您正在使用 JPanel 或类似的东西。如果是这种情况，那么我也将假设您的

```
public void draw(Graphics2D g) {
   ...
} 
```

在某个时候被某些人调用

```
@Override
public void paint(Graphics g) {
   draw((Graphics2D)g);
} 
```

在你的 Goo 班的某个地方。另外，我假设您的更新方法在线程中被重复调用。它缺少的一件事可能会修复未更新的 GUI 将添加`repaint()`这样的调用

```
public void update(){

    testDrop.move(width, height);
    colorDrop.move(width, height);
    fastDrop.move(width, height);
    wavyDrop.move(width, height);
    for(int i = 0; i<=12; i++)
        drops.get(i).move(width, height);
    //updates the GUI
    repaint();
} 
```

至于你的 for 循环，因为你使用的是 ArrayList 而不是 Array，所以不要在整个代码中使用硬编码的大小值，因为这违背了使用 List 的目的。

```
/**
 * Adds a bunch of new drops to the drop list, a third of each type
 * @param numOfDrops - the amount of drops to add to the list
 */
public void fillDropList (int numOfDrops)
{
    int oneThird = numOfDrops/3;
    int twoThirds = 2*numOfDrops;
    for(int i = 0; i<= numOfDrops; i++)
    {
        if (i <= oneThird)
        {
            drops.add(new Drop ((int)(Math.random()*width), -10, 10));
        }
        else if (i > oneThird && i <= twoThirds)
        {
            drops.add(new ColorDrop ((int)(Math.random()*width), -10, 10, Color.BLUE));
        }
        else
        {
             drops.add(new SpeedDrop ((int)(Math.random()*width), -10, 10, (int)(Math.random()*10)));
        }
    }
} 
```

在任何地方都有 for 循环遍历 drop，使用

```
for (int i = 0; i < drops.size(); i++) 
```

我唯一可以推荐的其他事情是考虑您不同掉落类型的策略模式，并注意您的括号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:37:20.923

这一行：

```
drops.add(new ColorDrop ((int) Math.random()*width, -10, 10, drops.get(i).randomPainter())); 
```

您尝试从与尝试将其添加到 (i) 的位置相同的位置获取对象，并在此（仍然为空对象）上调用 randomPainter() 将导致 NPE。

正如评论中提到的，检查你的 for 循环在 update 和 draw 方法中`i <= 12`，应该是`i < 12`，或者更好，`i < drops.size()`。这些当前将导致 ArrayIndexOutOfBounds 错误。

# php - 配置设置策略

> ID：14270640
> 
> 赞同：1
> 
> 时间：2013-01-11T02:17:35.960
> 
> 标签：php

在我用 PHP 开发的 CMS 中，我有配置设置。它们保持不变。我选择这种方法是因为常量始终具有全局范围，在遵循全部大写约定时很容易在代码中看到，并且不会被意外覆盖。我的理解也是，对常量的引用非常有效；真的吗？。

这些常数有两个子集。有些是硬编码的，因为它们与我的代码或安全性有关。其他存储在设置表（MySQL）中，并在初始化时读入常量。

我担心这些常量的数量正在增加，并且我可能会与我将来使用的第三方 PHP 模块发生冲突。

我想知道是否有更好的方法来处理此类设置。

我的主要想法是创建一个全局变量（例如，$settings），一个关联（键值）数组，它将与我现在拥有的常量一一对应。因此，而不是

```
 define('MY_SETTING, 'setting value'); 
```

我会

```
 $setting['my_setting'] = 'setting value'; 
```

当然，有两种方法可以访问它。最简单的是直接引用 $setting 数组，这将需要在每个访问设置的函数中都有一个全局语句（并且至少是其中的大多数）。另一种方法是使用单个函数（例如，setting('my_setting)）来引用全局数组以返回值。两者在语法上都很紧凑，尽管不如常量那么紧凑。

我最后的想法是为系统中的每个常量添加一个常量前缀。MY_SETTING 将变为 XY_MY_SETTING。这至少降低了碰撞的风险。

您还有其他方法可以推荐吗？关于我到目前为止所做的任何评论？

谢谢。

附加信息：我决定对四种访问方法进行快速性能测试。结果（显示的数字是相对测量值）：

*   常数：32
*   直接引用关联数组：29
*   访问关联数组的函数调用：91
*   类的获取方法：103

显然，处理函数或方法的开销很高，常量和数组引用之间的差异可以忽略不计。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:19:54.827

您可以创建一个设置类。

添加您认为合适的其他属性，并为它们添加 getter 和 setter。

这将使它与程序的其余部分分开，同时保持可见。

# php - 如何在单个 Laravel 框架文件夹中管理多个项目？

> ID：14270650
> 
> 赞同：3
> 
> 时间：2013-01-11T02:19:31.140
> 
> 标签：php, laravel

首先，我不是以英语为母语的人，所以请理解我可能会使用的一些笨拙的表达方式:)

* * *

几天前我刚开始使用这个出色的框架，现在我想将它用于我们公司目前正在运行的许多项目。

用 Laravel 管理一个项目似乎并不难，因为我真的不需要太关心子文件夹、命名空间等。

但是，当涉及多个项目时，我不知道如何为每个项目分离控制器和模型

更具体地说，

当控制器和模型位于子文件夹中时，如何使它们工作？

例如，

```
Route::post('entries','entries@create'); 
```

以上运行良好，因为“entries.php”文件位于“controllers”文件夹，但如果控制器“entries.php”位于子文件夹中怎么办？

如何指定位于子文件夹的文件的路径，以便上面的代码自动找到它？

同样的问题也适用于模型的情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T03:15:00.087

在 routes.php 中

```
Route::post('entries','folder.entries@create'); 
```

“文件夹”文件夹中的“条目”控制器文件。

```
class Folder_Entries_Controller extends Base_Controller {

public function action_index()
{
    // Code Here
}

} 
```

# php - php中的循环或循环分配

> ID：14270655
> 
> 赞同：0
> 
> 时间：2013-01-11T02:20:33.697
> 
> 标签：php

我有一个客户和员工表：

```
Customers
    .account_no
    .zipcode
-----------------------
account_no  |  zipcode
-----------------------
1111000100  |  12345
1222000100  |  25678
1333000100  |  47890
1444000100  |  50000
1555000100  |  53456
1666000100  |  63987 
```

* * *

```
Employees
    .id_e
    .zipcode_a
    .zipcode_b
    .card_id
---------------------------------------------
id_e  |  zipcode_a  |  zipcode_b  |  card_id
---------------------------------------------
1     |   10000     |   64000     |  1011
2     |   10000     |   54000     |  1002
3     |   50000     |   64000     |  1003 
```

假设我有 6 个客户，3 个员工；查询结果会是这样的：

```
---------------------------------
account_no  |  zipcode  |   id_e
---------------------------------
1111000100  |    12345  |     2
1111000100  |    12345  |     1
1222000100  |    25678  |     2
1222000100  |    25678  |     1
1333000100  |    47890  |     2
1333000100  |    47890  |     1
1444000100  |    50000  |     2
1444000100  |    50000  |     3
1444000100  |    50000  |     1
1555000100  |    53456  |     2
1555000100  |    53456  |     3
1666000100  |    63987  |     3
1666000100  |    63987  |     1 
```

我想将这些客户帐户分配给循环或循环的每个员工，看起来像这样：

```
---------------------------------
account_no  |  zipcode  |   id_e
---------------------------------
1111000100  |    12345  |     2
1222000100  |    25678  |     1
1333000100  |    47890  |     2
1444000100  |    50000  |     1
1555000100  |    53456  |     3
1666000100  |    63987  |     1 
```

我一直在尝试使用通常的循环，但结果是随机的并且不可取。

任何想法，人们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:29:59.240

您可以创建一个数组并覆盖前一个键以使其成为每个邮政编码只加载最后一个 id_e 以拥有它，例如：

如果您使用 $myarray = array(); 创建一个数组 在您的查询中，当您将数据库中的值导入数组时...我会给您代码，但我看不到您是如何导入它的；如果您表明我可以帮助您针对这种情况正确格式化它。

然后，您可以在此处覆盖重复的邮政编码案例，并且只使用相同邮政编码的最后一个 id_e。foreach($myarray as $zipcode => $id_e){ $myarray[$zipcode] = $id_e; }

另外我假设您目前是，但请确保您的 mysql 查询在其末尾包含“ORDER BY id_e”。

# javascript - 为什么将这些函数分配给具有“冗余”函数名称的对象？

> ID：14270656
> 
> 赞同：0
> 
> 时间：2013-01-11T02:20:40.063
> 
> 标签：javascript

*如果您认为自己有更好的标题，请随时改写标题。*

如果您查看源代码，[`bravo.js`](http://code.google.com/p/bravojs/source/browse/bravo.js)您会在第 807 行注意到以下内容。

```
module.declare = function main_module_declare(dependencies, moduleFactory) 
```

命名函数有什么好处`main_module_declare`？

**就不能写成下面这样吗？**

```
module.declare = function (dependencies, moduleFactory) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T02:22:24.497

如果您需要在严格模式下引用调用函数，它会很有用。

如果您像我一样，并且不为“ stict模式”折腾，请`arguments.callee`改用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:31:47.657

为函数使用内部局部变量的最大优点是，您的模块代码对函数是否公开无关。例如，如果您想将以前的私有函数转换为公共函数，那么只需添加该`module.publicName = privateName`行就更简单了，然后重命名 `privateName.txt 的所有实例。如果您想从公共接口中删除一个函数，这也适用于其他方式。

但是，这不适用于您链接到的特定情况，因为该函数不会在模块内再次调用。也就是说，评论提到`module.declare`可能会被覆盖，所以我想可能有理由在某处保留对原始函数的引用。

# iphone - 缩小以适应较旧的 iphone

> ID：14270657
> 
> 赞同：1
> 
> 时间：2013-01-11T02:21:03.030
> 
> 标签：iphone, xcode, html, cordova

这是一个棘手的问题：我开发了一个使用 HTML 5 的应用程序，我知道这是愚蠢和错误的，图像大小和位置的硬编码值。我调整了它的大小，使其在分辨率相当低的 Android 上运行良好。我所有的图像都是 540X300。这适用于较旧的机器人，并且在较新的 HTC 和位于角落的平板电脑上还有空间。

尝试在 iPhone 上发布它是一个挑战，因为我发现只有最新的 iPhone 5 才能很好地显示我的应用程序。较旧的手机（至少是模拟器！）裁剪我的应用程序（它是 html！）。

所以我想知道：我可以通过对我目前不理解的 xib 应用一些魔法来“缩放”我的应用程序以适应旧款 iPhone 吗？还有其他方法吗？还是我应该感谢我的星星让我可以在 iphone5 上运行？

哦耶。我正在使用 Cordova/Phonegap。

# mongodb - 在 Mongo shell 中使用未定义的变量

> ID：14270662
> 
> 赞同：2
> 
> 时间：2013-01-11T02:21:40.207
> 
> 标签：mongodb, mongo-shell

我正在设置一个 Mongo 脚本以通过 --eval 获取变量，如下所示：

```
mongo mydb myscript.js --eval "parameter = 'value'" 
```

但是，我希望脚本在不需要`--eval`.

如果这是基于浏览器的 JS，我会做一些`var internalParameter = window.parameter || null`事情来解决通过检查未定义变量而引发的 ReferenceError，但`mongo`没有`window`. 是否可以通过 Mongo 脚本中的全局对象访问变量，或者我只需要将其包装在 try/catch 中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-01-14T12:43:31.010

现在我已经了解了更多关于常见 JavaScript 习惯用法的知识，我知道你也可以这样做：

```
var internalParameter = typeof parameter == "undefined" ? null : parameter 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T02:31:46.967

在 myscript.js 中，您可以执行以下操作：

```
var parameter = parameter || null; 
```

如果`parameter`通过 传入，`--eval`它将具有该值，否则将为`null`.

**更新**

要在不定义输入变量的情况下执行此操作，您可以使用`this`引用 shell 中的全局对象的事实并执行以下操作：

```
var internalParameter = this.parameter || null; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T02:37:02.683

是的。您的脚本可以像这样设置默认值：

```
var parameter = parameter || 'default';
print('parameter = ' + parameter); 
```

然后可以传递参数或保留默认值：

```
% mongo script.js                                           
MongoDB shell version: 2.0.7
connecting to: localhost:27017/test
parameter = default

% mongo script.js --eval "var parameter = 'something else';"
MongoDB shell version: 2.0.7
connecting to: localhost:27017/test
parameter = something else 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-27T18:45:38.550

我做了以下来解决类似的问题：

```
function set_param(name, default_val)
{
    if (typeof this[name] === "undefined")
        this[name] = default_val;
}

set_param("DAYS_BACK", 180);
set_param("BATCH_SIZE", 1000); 
```

现在，如果任何一个参数都带有`--eval`参数，MongoDB shell 将使用提供的参数。否则它将使用第二个参数提供的默认值`set_param()`。无论`set_param()`使用. _`set_param()``--eval`

# javascript - 当图像位于 td 元素中时，如何更改图像在 IE6 中的可见性

> ID：14270667
> 
> 赞同：-1
> 
> 时间：2013-01-11T02:22:18.603
> 
> 标签：javascript, internet-explorer-6

我想要做的是在我将它悬停在 td 元素中时更改 span 元素（具有背景图像）的可见性。

在高级浏览器（包括 IE7,8）中一切正常，但在 IE6 中无法正常工作。

我想不通。大家有遇到和我一样的情况吗？

如下代码：

```
 <html>
 <head>
  <title> New Document </title>
  <style>
     .btn{
        cursor: pointer;
        display: inline-block;
        width: 100px;
        height: 100px;
        background-position: 0 0;
        background-repeat: none;
        background-image: url('http://up.ekoooo.com/uploads2/allimg/091024/9_091024065737_1.jpg');
    }
    .default-hidden{
        visibility: hidden;
    }
    .hover .default-hidden{
        visibility: visible;
    }
  </style>
 </head>
 <body>
    <table>
        <tbody>
            <tr onmouseover="this.className='hover';" onmouseout="this.className='';">
                <td>
                    2222222<span class="btn default-hidden">000000</span>33333
                </td>
            </tr>
        </tbody>
    </table>
 </body>
</html> 
```

我在 tr 元素上注册了内联 mouseover 和 mouseout 事件，当您将鼠标悬停时，然后将`hover`类添加到其中；当您将鼠标移出 tr 时，我只是删除了`hover`类名。

谢谢，哈利勒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:26:42.680

将`onmouseover`and`onmouseout`事件`<td>`改为：

```
<table>
  <tbody>
    <tr>
      <td onmouseover="this.className='hover';" onmouseout="this.className='';">2222222<span class="btn default-hidden">000000</span>33333</td>
    </tr>
  </tbody>
</table> 
```

这是一个[JSFiddle](http://jsfiddle.net/Ez88a/)

**UPDATE** : 为应对 IE6，您可以将表结构更改为 IE6 支持的 DIV & CSS。由于 IE6 不支持`:hover`CSS 选择器，您也可以使用此修复`:hover`在 IE6 中使用：[http ://blog.delivi.com/javascript/updated-hover-for-non-anchor-elements-in-ie6/](http://blog.delivi.com/javascript/updated-hover-for-non-anchor-elements-in-ie6/)

# ios - 在 SLRequest 上处理多个 Twitter 帐户

> ID：14270670
> 
> 赞同：2
> 
> 时间：2013-01-11T02:22:24.687
> 
> 标签：ios, twitter, social, acaccount

在使用 SLRequest 时，有一些很棒的 iOS 应用程序中的 Tweeting 教程。然而，他们中的大多数只是简单地从 Twitter 帐户中提取最后一个对象。由于可以在 iOS 设置上登录多个 Twitter 帐户，开发人员是否需要在发推文之前提供一个选项来选择哪个帐户，或者只使用默认帐户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-22T21:39:10.923

您不是“必须”为用户提供选项，但建议您这样做。

一种选择是给我们一个像这样的行动表：

```
UIActionSheet *sheet = [[UIActionSheet alloc] initWithTitle:@"Choose an Account" delegate:self cancelButtonTitle:nil destructiveButtonTitle:nil otherButtonTitles:nil];
    for (ACAccount *acct in _accounts) {
        [sheet addButtonWithTitle:acct.username];
    }
    sheet.cancelButtonIndex = [sheet addButtonWithTitle:@"Cancel"];
    [sheet showInView:self.view]; 
```

这假设您已经将帐户加载到一个数组中（我命名为我的 _accounts），而不是选择最后一个对象，而是使用此代码显示所有可用的帐户。

然后在您的 UIActionsheet 委托方法中，检查按下了哪个操作表按钮：

```
- (void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex
{
    if (buttonIndex != actionSheet.cancelButtonIndex) {

        self.accountToUse = [_accounts objectAtIndex:buttonIndex];

    }
} 
```

这将根据用户选择的内容设置帐户。这是样板文件，可能需要根据您访问它的位置进行一些更改，但它在很大程度上是您所需要的！

希望能帮助到你！

# c++ - 在 C++ 中命名命名空间的最知名方法 // 名称冲突时该怎么办？

> ID：14270674
> 
> 赞同：3
> 
> 时间：2013-01-11T02:22:48.277
> 
> 标签：c++, namespaces, header-files, libraries

好的，所以我知道我应该将我的代码嵌入命名空间来处理名称冲突。例如

My-Header-Only-Library.hpp

```
 namespace AG {
    namespace My_Header_Only_Library {

    class Foo {
        ...
    };

    }
    } 
```

所以我有 AG::My_Header_Only_Library::Foo。

是的，我经常使用两个级别 - 第一个级别，不同的是 AG、AFG、libAG 等 - 用于“我的”东西（我已经维护了其中的一些库几十年，例如`Valid<T>`）。

而且我经常有各种模块的子命名空间。

问题 #1：命名空间名称有时会发生冲突。

是的：我发现所有名称空间名称 AG、AFG、libAG 的冲突。是的，我遇到过与我姓名首字母相同的公司。

（有一段时间我用GLEW，觉得这是一个比较独特的姓氏。当时我是互联网上唯一的Glew，也是ARPAnet上第48个名字缩写为AG的人。（AG48）。但从那以后，OpenGL Extensions Wrangler 几乎已经从我这里拿走了它。）

我想“命名空间 AG_some_random_stuff_675567”不太可能发生冲突。人是这样的吗？使用一些长命名空间名称，然后使用

```
using AG_lib = AG_some_random_stuff_675567 
```

或者你有没有尝试过像#defining 命名空间的名字这样的把戏。

例如

```
#define AG something_more_unique 
```

问题2：我有时会给予、借出、允许公司使用我的图书馆。位我要求他们回馈更改，即他们不分叉。

它们的编码约定可能不一样。

我不希望他们更改命名空间名称，因为这会使他们的更改更难撤回。

问：怎么办？让他们做

```
using Their_Name = AG_some_random_stuff_675567 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:31:55.473

我通常从命名空间包含的内容、我的全名和创建日期开始——理论上这也不是 100% 不受冲突影响，但它非常接近¹。如果您真的想要更接近免疫的东西，您可以生成一个 GUID 并改用它。

然后，当然是的，对于*大多数*正常使用来说，有一个更短的别名。不幸的是，您不能*总是*使用别名来代替完整的命名空间名称，但这就是生活。

* * *

1.  至少对我来说它非常接近——一个更常见的名字会提供更少的保护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:34:32.827

您处于损坏控制模式。在与其内部名称冲突的状态下接收您的库的公司将需要修改其客户端代码以消除冲突库的歧义。

`AG_some_random_stuff_675567`显然是矫枉过正并且`AG`显然（也许只是回想起来）太可能发生碰撞。选择一些相当独特的东西，以便未来的客户可以在没有`using`别名的情况下使用它。例如`all_good`. （虽然，如果要求客户添加自己的`using`别名不会导致营销或支持问题，那么命名空间`random_stuff`将是完全安全的。）

然后，您可以`using namespace AG = all_good;`在自己的代码中添加代码，并指示旧客户端执行相同的操作，以实现向后兼容。

或许可以使用预处理器标志通过选择谁在全局命名空间中获取指令来帮助迁移客户端`using`，但绝不应该使用预处理器宏来重命名命名空间！像`AG`这样的名字已经被证明会发生冲突。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T02:47:03.280

不要使用缩写，使用已经分配的命名空间。例如，反转您的完全限定域名的 Java 实践非常有效。使用我的代码，我可以安全地使用

```
namespace com {
    namespace benvoigt {
    }
} 
```

并且知道它不会与外部实体发生冲突，因为其他任何人都不可能拥有该域的所有权`benvoigt.com`。

# ios - 如何在 insertText 之前等待 UITextField becomeFirstResponder？

> ID：14270676
> 
> 赞同：0
> 
> 时间：2013-01-11T02:23:00.377
> 
> 标签：ios, objective-c, cocoa-touch

怎么等`UITextField` `becomeFirstResponder`前`insertText`？

*   A`UITextField`是第一响应者。
*   然后弹出一个模态视图并杀死`UITextField`焦点（键盘不见了）
*   模态视图完成并通过`delegate.thingsDone`
*   `delegate.thingsDone`试图`insertText`进入`UITextField`...
*   （糟糕，`UITextField`还不是第一响应者）

情况是，我手头有一个，`NSString *`想***尽快***`insertText`进去。`UITextField` *`becomeFirstResponder`*

 *正确的方法是什么？*

# c# - 将 DependencyProperty 添加到扩展 ObservableCollection 的类

> ID：14270677
> 
> 赞同：2
> 
> 时间：2013-01-11T02:23:06.697
> 
> 标签：c#, wpf, dependency-properties, observablecollection, dependencyobject

我有一个名为的类`ObservableCollectionWithValidState`，用于在其子对象违反验证规则时通知自己。

班级：

```
child
child  <== violated a passed in Predicate and is now invalid.
child 
```

当这种情况发生时，我很想`DependencyProperty`在这个类上有一个我可以设置的可以绑定的类。

问题是我的课程扩展`ObservableCollection<T>`了，但我看不到如何`DependencyObject`进入图片。

我正在粘贴该类的初始声明以及我想添加的属性示例（除非我可以扩展，否则这将不起作用`DependencyProperty`）。

```
public class ObservableCollectionWithIsValidState<T> : ObservableCollection<T> where T : INotifyPropertyChanged,
{
    public static readonly DependencyProperty IsValidPropertyProperty = DependencyProperty.Register("IsValid", typeof(bool), typeof(ObservableCollectionWithIsValidState<T>), new PropertyMetadata(true));

    public bool IsValid
    {
       get { return (bool)GetValue(IsValidPropertyProperty); }
       set { SetValue(IsValidPropertyProperty, value); }
    }
} 
```

我的两个问题：

1.  这可能吗？
2.  如果不可能，您可以建议替代实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T03:33:36.880

这不可能。`DependencyProperty`只能在扩展类中创建`DependencyObject`。

来自[MSDN-DependendyObject](http://msdn.microsoft.com/en-us/library/system.windows.dependencyobject.aspx)

> DependencyObject 服务和特性包括： 依赖属性托管支持。
> 
> *   通过调用 Register 方法注册依赖属性，并将方法的返回值存储为类中的公共静态字段。

* * *

> 这可能吗？

不可能

> 如果不可能，您可以建议替代实现吗？

使用具有普通 CLR 属性的[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)和[IDataErrorInfo](http://msdn.microsoft.com/en-us/library/system.componentmodel.idataerrorinfo.aspx)进行属性验证。[例子](http://codeblitz.wordpress.com/2009/05/08/wpf-validation-made-easy-with-idataerrorinfo/)

# c# - 如何将数据集绑定到数据网格

> ID：14270684
> 
> 赞同：-4
> 
> 时间：2013-01-11T02:24:28.563
> 
> 标签：c#

> **可能重复：**
> [如何在 Windows 应用程序中将数据集绑定到 DataGridView](https://stackoverflow.com/questions/11099619/how-to-bind-dataset-to-datagridview-in-windows-application)

如何将数据集绑定到数据网格视图？并且数据集上已经有数据行。我只想将它绑定到数据网格。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T02:26:53.040

我不得不说这几乎是一个重复的问题，[这](https://stackoverflow.com/questions/11099619/how-to-bind-dataset-to-datagridview-in-windows-application)就是答案。

例如：

```
DataGridView1.AutoGenerateColumns = True;
DataGridView1.DataSource = ds; // dataset
DataGridView1.DataMember = "TableName"; // table name you need to show 
```

# asp.net - 从 html 文件中读取值

> ID：14270685
> 
> 赞同：-1
> 
> 时间：2013-01-11T02:24:30.440
> 
> 标签：asp.net, html, streamreader

我有一个页面，允许用户插入一些信息并保存为 html 文件（不在数据库中）。但是，我需要根据所有 html 文件中的信息重新生成报告。例如，在 html 文件中包含用户的工资，我需要获取该值并将工资总额相加。

我打算使用 StreamReader 读取所有的 html 文件并将所有薪水存储到一个数组中。但我担心它可能会影响我的应用程序的性能。所以，我想知道有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:30:47.063

如果您的应用程序允许用户修改 html 页面内容，那么将用户输入保存到 XML 中，然后使用该 XML 文件进行将来的操作当然更有意义，并且在接下来的操作中保持实际的 HTML 表单不变（？ ) 用户。

此外，您的派生 XML 文件可以根据需要复杂或简单。

# javascript - 制表时未创建引导弹出窗口

> ID：14270687
> 
> 赞同：2
> 
> 时间：2013-01-11T02:25:12.057
> 
> 标签：javascript, jquery, twitter-bootstrap, popover

我有一个带有多个输入的表单，当我单击每个字段时，它会正确触发我与 jQuery 链接的焦点方法（我通过控制台日志记录检查）但是它仅在我实际单击该字段时启动弹出窗口并且在我在它们之间制表符（它仍然调用该函数，但弹出框从未出现）。

这是一些示例代码：

```
// create the popover on focus but does not work when tabbing
$(".tblData").focus(function(){
    $(this).popover({content: "Info!", position: "right"});
}
});
// destroy the popover on blur to be efficient
$(".tblData").blur(function(){
    $(this).popover('destroy');
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T07:57:46.833

解决方案是在创建弹出框时添加一个属性并调用 show ，如下所示：

```
$(this).popover({content: "Info!", position: "right", trigger: "manual"}).popover('show'); 
```

这需要告诉属性您将控制显示和隐藏，并且您将始终显示它。

# python - Python：是在主线程中定义并从主线程或调用线程的另一个运行中调用的函数

> ID：14270688
> 
> 赞同：3
> 
> 时间：2013-01-11T02:25:16.677
> 
> 标签：python, multithreading, function, pygame

假设我有一个这样的程序：

```
import threading

def dosomething():
    print "Something"

class thread2(threading.Thread):
    def run():
        dosomething()

thread2().start() 
```

会`dosomething()`从定义它的主线程运行，还是`thread2`从它被调用的地方运行？

我将它用于`pygame`程序，因为您不能从多个类中调用 pygame 的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:39:21.807

在哪里声明函数并不重要。该函数将由调用它的线程执行。

# data-structures - 大量数据 - 数据组合的操作很少 - 什么数据结构？

> ID：14270697
> 
> 赞同：0
> 
> 时间：2013-01-11T02:27:09.810
> 
> 标签：data-structures

我试图找出解决这个问题的最佳数据结构。我有一个索引文件（约 200000 条记录），其中包含帐号、唯一 ID、日期、pdf 表单名称、税码。根据从文件中读取的这些值，我必须分配一些操作（豁免、删除、征税等）。一旦分配了动作，我就可以调用实现该动作的必要方法。庞大的数据量是我无法决定的原因。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:33:33.510

200,000 条记录根本不是一个庞大的数据量。

除非每条记录都必须引用另一条记录，否则您可以流式传输文件。读取一行，将其转换为对象，根据需要处理该对象，调用必要的操作，然后转到文件中的下一行。

使用此方法，您的数据将占用几乎零内存。

或者，您可以读取文件并在一个线程中每行创建一个对象，将每个对象放在一个队列中，然后使用一个或多个工作线程将对象从队列中取出并处理它们。这将以一些内存为代价更好地利用多核 CPU，具体取决于队列的大小。您当然可以设置最大队列大小以避免内存不足（当队列已满时文件读取器线程将暂停，直到它未满为止）。

# python - 使用 python-requests 获取文件大小，同时只获取标题

> ID：14270698
> 
> 赞同：65
> 
> 时间：2013-01-11T02:27:19.283
> 
> 标签：python, python-requests

我查看了请求文档，但似乎找不到任何东西。我如何只请求标头，以便评估文件大小？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2013-01-11T02:32:49.517

发送[HEAD 请求](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods)：

```
>>> import requests
>>> response = requests.head('http://example.com')
>>> response.headers
    {'connection': 'close',
 'content-encoding': 'gzip',
 'content-length': '606',
 'content-type': 'text/html; charset=UTF-8',
 'date': 'Fri, 11 Jan 2013 02:32:34 GMT',
 'last-modified': 'Fri, 04 Jan 2013 01:17:22 GMT',
 'server': 'Apache/2.2.3 (CentOS)',
 'vary': 'Accept-Encoding'} 
```

HEAD 请求类似于仅下载标头的 GET 请求。请注意，实际上是否满足您的 HEAD 请求取决于服务器。有些服务器只会响应 GET 请求，因此您必须发送 GET 请求并关闭连接而不是下载正文。其他时候，服务器从不指定文件的总大小。

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2017-06-01T06:21:39.270

采用`requests.get(url, stream=True).headers['Content-length']`

`stream=True`表示函数返回时，**只下载响应头，不下载响应体**。

两者都`requests.get`可以`request.head`让你获得标题，但使用有一个优势`get`

1.  `get`更灵活，如果您想在检查长度后下载响应正文，您可以从简单地访问`content`属性开始，或者使用`iterator`将分块下载内容的
2.  *“HEAD 请求应该与响应 GET 请求而发送的信息相同。”* 但并非总是如此。

这是获取[MIT 公开课程视频长度的示例](https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-006-introduction-to-algorithms-fall-2011/lecture-videos/lecture-1-algorithmic-thinking-peak-finding/)

```
MitOpenCourseUrl = "http://www.archive.org/download/MIT6.006F11/MIT6_006F11_lec01_300k.mp4"
resHead = requests.head(MitOpenCourseUrl)
resGet = requests.get(MitOpenCourseUrl,stream=True)
resHead.headers['Content-length'] # output 169
resGet.headers['Content-length'] # output 121291539 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-10-13T08:51:52.230

获取文件大小 -->

```
file.headers.get('Content-Length') 
```

# php - 简单的PHP文件上传更安全

> ID：14270701
> 
> 赞同：0
> 
> 时间：2013-01-11T02:27:28.700
> 
> 标签：php, upload, die

我有这个（非常简单的）PHP 上传脚本：

```
$pic=$_FILES['photo']['name'];
$picc=$_FILES['photo']['tmp_name'];
$tar="".$pic;
move_uploaded_file($picc,$tar);
 $fileName = $_FILES['photo']['name']; 
```

`die`如果脚本不是`image`文件，或者超过了，我将如何制作脚本`1 mb`？

提前谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:29:58.920

要检查文件是否是图像，请参见以下问题：

[PHP如何检查文件是mp3还是图像文件？](https://stackoverflow.com/questions/2006632/php-how-can-i-check-if-a-file-is-mp3-or-image-file)

要检查文件大小，请参阅本教程：

[http://www.phpeasystep.com/phptu/3.html](http://www.phpeasystep.com/phptu/3.html)

# html - 带有 google.com 的 iframe 无法在 w3school tryit 编辑器上运行

> ID：14270702
> 
> 赞同：0
> 
> 时间：2013-01-11T02:27:45.423
> 
> 标签：html

> **可能重复：**
> [如何在 iframe 中显示 google.com？](https://stackoverflow.com/questions/8700636/how-to-show-google-com-in-an-iframe)

我是 html 的新手。我正在学习 html 标签“iframe”。我知道这是将页面嵌入另一个页面的方式。但我尝试在 w3school 编辑器中播放它，将 url 更改为 www.google.com，它不起作用：

[http://www.w3schools.com/tags/tryit.asp?filename=tryhtml_iframe](http://www.w3schools.com/tags/tryit.asp?filename=tryhtml_iframe)

谁能告诉我为什么。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:31:19.540

Google 不允许将其页面提供给框架。更具体地说，它的服务器发送此标头：

```
X-Frame-Options: SAMEORIGIN 
```

支持和兼容的浏览器将阻止页面加载到 iframe 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:35:45.663

实际上页面加载了一些 javascript 和 json 数据，但是 javascript 逻辑首先检查页面是否是主页，如果不是，它不会呈现 DOM 对象或网页。

验证的最佳方法是右键单击 google 应该打开的 iframe，然后单击查看该 iframe 的源代码，您将看到 google java 脚本代码。因此 iframe 在 w3schools 上运行良好，但由于某些原因，谷歌限制自己从 iframe 打开。

# registration - 使用 Ruby Mechanize 的 Dwolla 用户注册端点

> ID：14270705
> 
> 赞同：0
> 
> 时间：2013-01-11T02:28:00.293
> 
> 标签：registration, dwolla

我有一个 Ruby-On-Rails 应用程序，我正在尝试使用 Mechanize 连接到 Dwolla

```
agent = Mechanize.new 
agent.keep_alive = false 
agent.log = Logger.new $stderr 
agent.agent.http.debug_output = $stderr 
ajax_headers = { 'X-Requested-With' => 'XMLHttpRequest', 'Content-Type' => 'application/json; charset=utf-8', 'Accept' => 'application/json, text/javascript, */*'} 
response = agent.post( "https://www.dwolla.com/oauth/rest/tes...", query_string.to_json, ajax_headers) 
```

我得到的回应是：

```
Conn close because of error Connection reset by peer 
```

这些是我发送的参数：

```
{\"password\":\"Password1\",\"confirm_password\":\"Password1\",\"pin\":\"1234\",\"firstName\":\"firstName\",\"lastName\":\"lastName\",\"address\":\"address\",\"address2\":null,\"city\":\"Troy\",\"state\":\"NY\",\"zip\":\"12180\",\"phone\":\"111-123-4567\",\"dateOfBirth\":\"10/15/1970\",\"type\":\"Personal\",\"organization\":null,\"ein\":null,\"acceptTerms\":true,\"client_id\":\"foo\",\"client_secret\":\bar\"}" 
```

这是记录的内容：

```
Net::HTTP::Post: /oauth/rest/testapi/register
request-header: accept => application/json, text/javascript, */*
request-header: user-agent => Mechanize/2.5.1 Ruby/1.9.2p290 (http://github.com/tenderlove/mechanize/)
request-header: connection => close
request-header: accept-encoding => gzip,deflate,identity
request-header: accept-charset => ISO-8859-1,utf-8;q=0.7,*;q=0.7
request-header: accept-language => en-us,en;q=0.5
request-header: host => www.dwolla.com
request-header: content-type => application/json; charset=utf-8
request-header: content-length => 444
opening connection to www.dwolla.com...
opened
<- "POST /oauth/rest/testapi/register HTTP/1.1\r\nAccept: application/json, text/javascript, */*\r\nUser-Agent: Mechanize/2.5.1 Ruby/1.9.2p290 (http://github.com/tenderlove/mechanize/)\r\nConnection: close\r\nAccept-Encoding: gzip,deflate,identity\r\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\nAccept-Language: en-us,en;q=0.5\r\nHost: www.dwolla.com\r\nContent-Type: application/json; charset=utf-8\r\nContent-Length: 444\r\n\r\n"
<- "{\"password\":\"Password1\",\"confirm_password\":\"Password1\",\"pin\":\"1234\",\"firstName\":\"firstName\",\"lastName\":\"lastName\",\"address\":\"address\",\"address2\":null,\"city\":\"Cohoes\",\"state\":\"NY\",\"zip\":\"12047\",\"phone\":\"111-123-4567\",\"dateOfBirth\":\"9/13/1973\",\"type\":\"Personal\",\"organization\":null,\"ein\":null,\"acceptTerms\":true,\"client_id\":\"foo\",\"client_secret\":\"bar\"}"
Conn close because of error Connection reset by peer 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T21:29:34.430

我相信您使用的是旧的 [不受支持的] 端点。尝试从 URL 中删除“/testapi”部分......无论如何，此方法的开发文档还包括一个内联控制台，可以帮助您开始使用：[https ://developers.dwolla.com/dev/docs /注册/注册](https://developers.dwolla.com/dev/docs/register/register)

# python - 访问 python 二维数组

> ID：14270708
> 
> 赞同：0
> 
> 时间：2013-01-11T02:28:23.990
> 
> 标签：python, multidimensional-array

假设我们有：

```
a = [[1, 2, 3], [4, 5, 6]] 
```

除了循环之外，访问数组以获取每个列表中的第一个元素的最快方法是什么。

我希望结果能给我... 1,4

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:30:08.970

使用 zip(*a)

```
a = [[1, 2, 3], [2, 3, 4]]
result = zip(*a)[0]
print result 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T02:32:21.403

一种快速简便的方法是仅提取`a[0][0]`and `a[1][0]`，但取决于您使用它的目的，这可能不会一直有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-11T02:36:08.340

如果没有循环，您需要像 ethg242 那样展开循环。这具有仅适用于固定长度的缺点`a`

这是一个列表理解

```
[i[0] for i in a] 
```

也可以使用`map()`，但这也有一个隐式循环

```
from operator import itemgetter
map(itemgetter(0), a) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-11T02:52:29.773

您可能需要考虑 numpy：

```
>>> import numpy as np
>>> a = [[1, 2, 3], [4, 5, 6]]
>>> b = np.array(a)
>>> b[:,0]
array([1, 4]) 
```

# python - 如何使用 pyserial 从热插拔缓冲区中清除以前的数据

> ID：14270716
> 
> 赞同：2
> 
> 时间：2013-01-11T02:28:56.300
> 
> 标签：python, multithreading, pyserial

我正在编写一个脚本来测试使用 pyserial 模块热插拔串行设备。该脚本有一个处理写入的主线程和一个用于读取数据的读取线程。

主线程发送一个热插拔信号，然后停止读取线程，直到再次启动读取线程时再次检测到设备。主线程等待热插拔成功消息以确认热插拔成功（超时）并从发送热插拔消息重新开始。当串行设备在连接上的第一个热插拔成功消息后发送初始化消息时会出现此问题。

脚本第一次运行良好。但是第二次，输入串行缓冲区仍然有一些数据（初始化消息）需要在读取任何新的成功和初始化消息之前先读取。这样做会使脚本在超时时丢失成功消息。

我希望在热插拔上启动读取线程之前完全刷新串行缓冲区并丢弃任何内容（也就是说，我不在乎在热插拔之前收到了什么消息）。在收到热插拔成功消息后，我尝试使用 ser.flushInput()/flushOutput()/flush() 方法，但它什么也没做。数据仍然从缓冲区中读取。我可以通过在下一次迭代之前引入 time.sleep(5) 来解决问题（从缓冲区中读取所有 init ），但需要一种更简洁的方法。

获得成功消息后，如何完全丢弃输入缓冲区中的先前初始化消息，以便下一次迭代在热交换之前没有可读取的内容。我希望通过下面的序列图可以清楚地说明问题，因为代码太大而无法发布。

更新：我在某处读到无法刷新输入的内容，这是 C 中未定义的行为之一。必须阅读直到 EOF/EOL ...

```
 Device           Main              Read         Device
                            -start->
                <-Hotplug-  -stop->
-DevcieAlive->
                <-open--    -start->
                                             <-( success + init )-
                            <-success-
                    ok

                <-Hotplug-  -stop->
-DeviceAlive->
                <-open-     -start->
                                             <-( old init + success + init )
                  timeout
                <-close-    -stop-> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-02-21T14:19:25.203

`py.flushOutput`您可以使用和刷新值`py.flushInput`。如果这不起作用，只需在关闭串行端口之前将要发送的值设置为任何垃圾值。

# android - Holo Light 在 HTC One X 上呈现全白

> ID：14270718
> 
> 赞同：1
> 
> 时间：2013-01-11T02:29:13.690
> 
> 标签：android

刚开始 Android 开发，Holo Light 主题在我的 styles.xml 中设置为 v14。主题在所有模拟器上都正确显示（它看起来像[http://developer.android.com/design/style/themes.html](http://developer.android.com/design/style/themes.html)上的屏幕截图。但是当我将它加载到我的 HTC One X 上时，ActionBar 和按钮都会出现在白色背景上完全白色。我确定它使用的是 styles.xml v14 文件夹中的主题设置。这怎么可能，我认为 Holo 主题应该在所有设备上都显示相同？关于如何制作的任何建议Holo 灯光主题在我的设备上正确显示？

# javascript - 制作 JavaScript 显示标题

> ID：14270719
> 
> 赞同：1
> 
> 时间：2013-01-11T02:29:15.013
> 
> 标签：javascript, html

我有一个网站，它的`<title>`标签是这样的：`<title>Blog post name &rarr; Site.com</title>`我希望显示它的第一部分。

所以我只想`Blog post name`显示 。这是我为显示整个标题所做的操作：

```
Text blah blah blah: <script>document.write(document.title);</script> blah blah blah. 
```

有没有办法我可以做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:31:24.713

拆分`document.title`以获得第一部分。

所有其他的东西都可以保持不变。

```
<script>document.write(document.title.split("\u2192")[0]);</script> 
```

`\u2192`是`&raar;`字符的代码

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T02:44:04.363

另一种方法是使用`indexOf`and `substring`：

```
<script>document.write(document.title.substring(0, document.title.indexOf('&rarr')));</script> 
```

这是[小提琴](http://jsfiddle.net/hyffd/)。

# java - 有适用于 Android 的轻主题吗？

> ID：14270721
> 
> 赞同：0
> 
> 时间：2013-01-11T02:29:17.203
> 
> 标签：java, android

我正在尝试在我的应用程序上使用轻量级主题，但以某种方式可以自定义它（提示我为什么要创建自己的主题）。尽管使用`AppTheme.NoActionBar`了我的应用程序在顶部加载时仍然看到一个栏。

```
<style name="AppTheme" parent="@android:style/Theme.Holo.Light">

</style>

<style name="AppTheme.NoActionBar" parent="@android:style/Theme.Holo.Light.NoActionBar">

</style> 
```

关于为什么会发生这种情况的任何想法？

我正在使用最新版本的 Android，使用 Nexus_S 作为我的设备。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T03:14:20.463

您使用的是什么设备？如果您使用的是模拟器，那么 API 的级别是多少？

如果 API 低于 3 Android 不支持 actionbar。只有当 API 等于 3 或更高时，才会应用 NoActionBar 主题。

根据我在 Nexus one API 2.3 中移植的经验，即使我想显示操作栏，屏幕顶部也只有一个细条。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T05:45:31.153

我正在使用 Theme.Sherlock.Light。

如果您使用的是 Sherlock 操作栏，您可以使用它。

# javascript - 用闭包循环：不工作？（使用 jqueryui）

> ID：14270722
> 
> 赞同：1
> 
> 时间：2013-01-11T02:29:35.990
> 
> 标签：javascript, jquery, jquery-ui, closures

我相信我的代码中出现了循环关闭问题。我读过[这篇文章](http://enterprisejquery.com/2010/10/how-good-c-habits-can-encourage-bad-javascript-habits-part-3/) ，这对我很有帮助。最近我想出了一个类似于文章中引用的“使用闭包循环”部分的问题。我已经尝试过他们的解决方案，但仍然没有解决我的问题。我一直在到处寻找解决方案，但我总是在文章中找到解决方案。

我正在使用 jqueryui 使一些 lis 可拖动，当我将它们放入容器中时，我需要使用特定于该 li 的变量（节点）。问题是节点（和索引）总是最后一个（因此是闭包问题）。

这是我的代码（我已经简化了一点，以便更容易识别问题）：

```
function makeDraggable(node, i) {
        $("#rightTab li#" + node.id).draggable({
            containment: 'div#container',
            stack: 'div#container',
            scroll: false,
            revert: 'invalid',
            helper: function() {
                return $(this).children().clone();
            },
            start: function(event, ui) {
                $(this).children().css('opacity', 0);
            },
            stop: function(event, ui) {
                $(this).children().css('opacity', 1);
            }
        });

        $("#vis").droppable({
            drop: test(node, i)
        });
    }

    function test(noder, index) {
        return function(event, ui) {
            alert(index);
            //stuff with node.
        }
    }

    function appendInfo(nodes) {
        for(var i = 0; i < nodes.length; i++) {
            $("#rightTab #content ul").append("<li id=" + nodes[i].id + "><div></div></li>");

            if(visualization.hasImageLabel) {
                interfaceHandler.handleImageLabel(nodes[i]);
            }
            if(visualization.hasTextLabel) {
                interfaceHandler.handleTextLabel(nodes[i]);
            }

            makeDraggable(nodes[i], i);
        }
    } 
```

当我提醒索引（在函数测试中）它总是打印 9（最大数组长度）时，节点也总是最后一个。

（抱歉英语不好）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:54:45.800

问题是它`$("#vis").droppable(...)`替换了任何先前定义的可放置功能，因此不能用闭包解决。

如果知道索引很重要，那么尝试使用 让每个可拖动节点知道自己的索引`.data(...)`，并且只调用`$("#vis").droppable(...)`一次 in `appendInfo()`，而不是 in `makeDraggable()`。

```
function appendInfo(nodes) {
    for(var i = 0; i < nodes.length; i++) {
        $("#rightTab #content ul").append("<li id=" + nodes[i].id + "><div></div></li>");
        if(visualization.hasImageLabel) {
            interfaceHandler.handleImageLabel(nodes[i]);
        }
        if(visualization.hasTextLabel) {
            interfaceHandler.handleTextLabel(nodes[i]);
        }
        makeDraggable(nodes[i], i);
        $(node).data('index', i); //<<< node is now aware of its own index
    }
    $("#vis").droppable({
        drop: function(event, ui) {
            alert(ui.draggable.data('index'));//I think???
            //stuff with node.
        }
    });
} 
```

如果不需要知道索引，那么您可以直接访问可拖动的 as `ui.draggable`，而无需设置或获取`.data()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T02:41:29.217

You're calling `$("#vis").droppable({...})` on every iteration through the loop. This sets up 10 `drop` event handlers; only the last one is ever fired, which was passed (node_nine, 9) as its parameters.

Check the value of `ui.draggable` inside your callback; it will tell you what the dropped element is.

# ruby-on-rails - Rails：使自定义 URL 帮助器的行为类似于内置的 _path 和 _url 帮助器

> ID：14270729
> 
> 赞同：5
> 
> 时间：2013-01-11T02:30:22.840
> 
> 标签：ruby-on-rails, routes, helper, urlhelper

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-05-22T01:59:50.813

我最近写了一个助手来将我`_path`的方法转换为`_url`方法。

Rails 用于`ActionDispatch::Http::URL.full_url_for`生成`_url`方法，并传入`Rails.application.routes.default_url_options`设置`host`、`port`和`protocol`.

这意味着您可以使用给定路径生成 URL

```
ActionDispatch::Http::URL.full_url_for(Rails.application.routes.default_url_options.merge(path: path)) 
```

我正在进行的工作助手看起来像：

```
def self.url_helper(route_name)
  define_method("#{route_name}_url") do |*args|
    path = public_send(:"#{route_name}_path", *args)
    options = Rails.application.routes.default_url_options.merge(path: path)
    ActionDispatch::Http::URL.full_url_for(options)
  end
end 
```

然后可以将其与您的路径助手结合使用来构建一个`email_confirm_url`方法：

```
url_helper :email_confirm
def email_confirm_path(token)
  "/confirm/#{token}"
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T03:58:14.497

为了访问请求对象，您应该在您的邮件程序的控制器中实现此功能，并将其传递给带有变量的模板。

应用程序/mailers/emailer.rb

```
@tracking_url = "http://#{request.host}:#{request.port}/confirm/#{token}" 
```

app/view/emailer/template_name.html.erb

```
<%= link_to 'name', @tracking_url %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-04T18:42:34.443

使用已经存在的 url 和连接怎么样？即你可以使用`root_path`and `root_url`，然后你连接并且行为与 rails 完全相同！

例如，您可以这样做：

```
def mystrangemethod_url(option1, option2)
  "#{ root_url }/#{ option1 }/#{ option2 }"
end 
```

你完成了。很简单，唯一的要求是**在 routes.rb 中设置你的根路径**。此外，使用您在 development.rb 中设置的选项，它也可以在邮件程序中使用。

# neo4j - Starting the console with my own graph

> ID：14270730
> 
> 赞同：0
> 
> 时间：2013-01-11T02:30:26.370
> 
> 标签：neo4j

To experiment with Cypher I wanted to load the console with my own graph. Two questions here come:

1.  Can I do it on a locally installed server?
2.  How to provide the graph configuration (the "graph setup" piece) as a default setup?

Thanks!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T00:38:22.893

是的，您可以自己对自己的数据库运行控制台。这假设您正确安装了 git、maven 和 jdk。

1.  `git clone git://github.com/neo4j-contrib/rabbithole.git`
2.  `cd rabbithole`
3.  `mvn assembly:single`
4.  `java -cp "target/neo4j-console-jar-with-dependencies.jar" org.neo4j.community.console.Console <port> <path-to-local-db> expose`

如果您在上面最后一个命令的末尾添加公开，它将使数据库实际上是可写的。如果您想要只读副本，请将其关闭。请注意，您不能在运行 neo4j 服务器的同时运行带有暴露的 rabbithole，因为它们都试图锁定文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T07:51:28.663

不确定您对控制台的意思，但如果您的意思是[http://console.neo4j.org](http://console.neo4j.org)：

1.  是的。[从https://github.com/neo4j-contrib/rabbithole](https://github.com/neo4j-contrib/rabbithole)下载源代码

2.  单击该`share`按钮会打开一个对话框，您可以在其中编辑图形创建语句和初始查询。完成后，单击`click to generate`按钮，将在下面的输入中生成一个 URL。只需将此 URL 加入书签，以便稍后检索。

# java - 用于显示不同对象的自定义列表的 OO 设计

> ID：14270732
> 
> 赞同：0
> 
> 时间：2013-01-11T02:30:30.640
> 
> 标签：java, android, oop

应该相当简单，但我想在开始编码之前把它弄好。假设我编写了一个`CustomLayout`或`CustomListView`类，该类对其包含的元素具有特殊行为（例如，当悬停在触摸屏上的元素上方时突出显示）。

然后我希望它`CustomListView`能够显示不同类型的元素，例如 a `Place`、 a`Bookmark`或 a `SearchResult`。例如，当显示 a时，`Place`它应该只显示名称，当显示 a 时`Bookmark`，它应该显示名称和时间戳。

我知道这样做的错误方法，即`CustomListView`做类似的事情

> **if** (anInstance **instanceof** Bookmark)

设计我的课程的最佳方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T04:49:05.673

或者，您可以通过继承一个通用的 CustomListItem 来实现这些类型中的每一个的类，然后实现一个工厂，它将实例化并返回您想要的项目类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:39:21.683

只需让`CustomLayout`, `Place`,`Bookmark`等包含一个`render()`渲染它包含的元素的方法，或者让它返回某种句柄（如视图或类似的），以便调用的人`render()`可以确定应该放置它的位置。

关于如何渲染的所有逻辑都将包含在此函数中，并且会根据发生的情况而有所不同，正如您所描述的。

有关详细信息，请参阅[复合模式](http://en.wikipedia.org/wiki/Composite_pattern)。

# jquery - 使用 jQuery 的响应式设计方法 - 可能还是疯狂？

> ID：14270738
> 
> 赞同：0
> 
> 时间：2013-01-11T02:31:12.507
> 
> 标签：jquery, if-statement, height, width, responsive-design

所以，我想知道 jQuery 是否可以使用这种方法，如果可以，任何可以指导我解决这个问题的方法都会很棒。

我正在创建一个固定窗口的网络应用程序（即没有浏览器滚动，不需要滚动主页焦点，并且对于确实需要它的项目，它们有可滚动的 div），所以有特定的比例宽度/高度。在这种情况下，比率为 16:9。里面的所有元素都是百分比，基本上都来自最外面的容器。我需要我的外部容器根据浏览器窗口的大小做出响应。我希望我可以为此使用 jQuery。

虽然大多数响应式设计只关注宽度，但我需要确保宽度和高度都发挥作用。事实上，根据屏幕大小/浏览器窗口，高度可能是决定因素。

有两种方法需要采用，它们取决于浏览器窗口的纵横比。

1.  如果比率大于 16:9 或 1.78（即 16:8 或 2），我将需要我的外部容器的高度与浏览器窗口的高度匹配，并且我的外部容器的宽度将基于此高度（即高度 * 1.78）。

2.  如果比例小于 16:9 或 1.78（即 16:10 或 1.6），我不能采用上述方法，因为高度 * 1.78 会导致外部容器对于浏览器窗口来说太宽。因此，在这种情况下，我需要使用宽度，然后使用它来确定高度（即宽度/1.78）。

我的 CSS 的其余部分也应该效仿，因为它是基于百分比的，然后我将拥有一个响应完美的输出容器，该容器可以根据浏览器窗口大小进行缩放。

我真的不知道如何解决这个问题，但至少想知道它是否可能。考虑到我可以在脑海中处理 if / else 语句，看起来是这样，但我对 jQuery 不是非常好，并且想在处理之前获得一些建议。谢谢！

# php - 带有某些变量的 PHP 未定义索引错误

> ID：14270744
> 
> 赞同：1
> 
> 时间：2013-01-11T02:31:35.947
> 
> 标签：php, html, variables

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-11T02:42:01.540

Drew,

Try this:

```
<?php
        $when = 'hello';

        echo $when;
?> 
```

Just to see if your localhost is working. Also try a free web hosting (php hosting) to eliminate your local server issue.

Jim

# python - 在 Python/Pyodbc 中查询 Teradata 的问题

> ID：14270745
> 
> 赞同：10
> 
> 时间：2013-01-11T02:31:39.453
> 
> 标签：python, teradata

我正在尝试使用 PyODBC 在 Python 中查询 Teradata 数据库。与数据库的连接建立正常；但是，当我尝试获取结果时，我遇到了这个错误“十进制的无效文字：u''”。请帮忙。

我在 RHEL6 上，使用 Python 2.7.3

这是代码和结果：

```
import pyodbc

sql = "select * from table"

pyodbc.pooling = False
cnx = pyodbc.connect("DRIVER={Teradata};DBCNAME=host;DATABASE=database;   AUTHENTICATION=LDAP;UID=user;PWD=password", autocommit=True, ANSI=True)
cursor = cnx.cursor()
rows = cursor.execute(sql).fetchone() 
```

* * *

```
InvalidOperation                          Traceback (most recent call last)
<ipython-input-25-f2a0c81ca0e4> in <module>()
----> 1 test.fetchone()

/usr/local/lib/python2.7/decimal.pyc in __new__(cls, value, context)
    546                     context = getcontext()
    547                 return context._raise_error(ConversionSyntax,
--> 548                                 "Invalid literal for Decimal: %r" % value)
    549 
    550             if m.group('sign') == "-":

/usr/local/lib/python2.7/decimal.pyc in _raise_error(self, condition, explanation, *args)
   3864         # Errors should only be risked on copies of the context
   3865         # self._ignored_flags = []
-> 3866         raise error(explanation)
   3867 
   3868     def _ignore_all_flags(self):

InvalidOperation: Invalid literal for Decimal: u'' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-03T18:42:30.690

我遇到了这个错误，我发现原因是pyodbc是64位的，而我的teradata驱动程序是32位。使用unixodbc构建新驱动程序后问题得到解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-07T11:11:41.510

在 setup.py 中强制使用正确的语言环境（在编译之前）对我有用，例如：

```
import locale
locale.setlocale(locale.LC_ALL, 'es_ES.utf8') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-12T22:52:17.860

如果您的空字符设置为“？” （我相信这是默认设置）或任何其他奇怪的东西，这可能是返回的问题，特别是如果您在处理数据时遇到 python。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T00:17:57.453

我发现开箱即用的 pyodbc 可能无法按照[http://code.google.com/p/pyodbc/issues/detail?can=1&q=teradata&id=146工作](http://code.google.com/p/pyodbc/issues/detail?can=1&q=teradata&id=146)

我验证了该线程中的修复工作。查看[https://github.com/mkleehammer/pyodbc](https://github.com/mkleehammer/pyodbc)，向 setup.py 添加额外的命令，重新编译，它似乎可以工作。

# perl - Perl：读取字符串中双引号之间的内容

> ID：14270748
> 
> 赞同：2
> 
> 时间：2013-01-11T02:31:51.417
> 
> 标签：perl

我有一个字符串，字符串的一些内容用双引号引起来。例如：

```
test_case_be "+test+tx+rx+path" 
```

对于上述输入，我想将整个字符串分成两部分：

1.  双引号 [ `test_case_be`] 外的字符串我要存储在`$temp1`.
2.  双引号 [ `+test+tx+rx+path`] 内的字符串我想将它存储在`$temp2`.

有人可以帮助我提供有关如何执行上述操作的示例代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:37:00.483

这可以做到：

```
my $input_string = qq(test_case_be "+test+tx+rx+path");
my $re = qr/^([^"]+)"([^"]+)"/;

# Evaluating in list context this way affects the first variable to the
# first group and so on
my ($before, $after) = ($input_string =~ $re);

print <<EOF;
before: $before
after: $after
EOF 
```

输出：

```
before: test_case_be 
after: +test+tx+rx+path 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T02:35:07.087

```
$str ~= /(.*)\"(.*)\"/; //capture group before quotes and between quotes
$temp1 = $1; // assign first group to temp1
$temp2 = $2; // 2nd group to temp2 
```

这应该做你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T02:43:15.253

One way:

```
my $str='test_case_be "+test+tx+rx+path"';
my ($temp1,$temp2)=split(/"/,$str); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T04:45:57.127

这是另一种选择：

```
use strict;
use warnings;

my $string = 'test_case_be "+test+tx+rx+path"';
my ( $temp1, $temp2 ) = $string =~ /([^\s"]+)/g;

print "\$temp1: $temp1\n\$temp2: $temp2"; 
```

输出：

```
$temp1: test_case_be
$temp2: +test+tx+rx+path 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-11T02:39:33.583

```
$str =~ /"(.*?)"/;
$inside_quotes = $1;
$outside_quotes = $`.$'; 
```

# emacs - 闪烁光标模式更好闪烁？

> ID：14270758
> 
> 赞同：6
> 
> 时间：2013-01-11T02:33:03.947
> 
> 标签：emacs

闪烁的光标可能会很烦人。很容易关闭闪烁`blink-cursor-mode`（或者自定义它......）。但是对于较大的屏幕，通常很难定位光标位置。所以，嗯，眨眼毕竟是有意义的。

然而，视觉上非常令人恼火的是，闪烁是通过在一个完整的矩形（或条形）和什么都没有之间切换来完成的。当您现在`C-x 3`像并排比较两个缓冲区时，选定的缓冲区有时有矩形，有时没有。所以你不能轻易地看向一侧，然后再看另一侧；您必须等待光标“重新出现”。这很烦人。

所以我的问题是：是否有可能在全矩形和相关的东西之间有闪烁的开关？浅色矩形？它不应该是空心矩形，因为它在另一个缓冲区中使用。

（我使用的是 23.1）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T03:51:56.077

从 24.1 开始，这是可能的。

[`blink-cursor-alist`](http://www.gnu.org/software/emacs/manual/html_node/emacs/Cursor-Display.html)为每个指定`on-type`的许可`off-type`。

感谢@RobertHarvey 指出这一点。

# c# - stringbuilder 或 streamwriter 覆盖信息

> ID：14270759
> 
> 赞同：1
> 
> 时间：2013-01-11T02:33:03.603
> 
> 标签：c#, csv, stringbuilder, streamwriter

我正在向流编写器和字符串生成器发送几个字典，但只有一个字典的信息显示在我的输出文件中。我不知道该怎么做才能立即输出所有内容，代码如下，谢谢！

```
public void RunReport()
{
    CSVProfileCreate(genderKeys, genderValues);
    CSVProfileCreate(ageKeys, ageValues);
}

public void CSVProfileCreate<T>(Dictionary<T, string> columns, Dictionary<T, int> data)
{
    using (StreamWriter write = new StreamWriter("c:/temp/testoutputprofile.csv"))
    {
        StringBuilder output = new StringBuilder();

        IEnumerable<string> col = columns.Values.AsEnumerable();
        IEnumerable<int> dat = data.Values.AsEnumerable();

        for (int i = 0; i < col.Count(); i++)
        {
            output.Append(col.ElementAt(i));
            output.Append(",");
            output.Append(dat.ElementAt(i));
            output.Append(",");
            output.Append(Environment.NewLine);
        }

        write.Write(output);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:36:32.730

试着打电话

```
write.Flush(); 
```

写完之后。

编辑：

抱歉，请再次阅读您的问题，

尝试：

```
using (StreamWriter write = new StreamWriter("c:/temp/testoutputprofile.csv", true)) 
```

# c++ - 字符到 QString

> ID：14270760
> 
> 赞同：8
> 
> 时间：2013-01-11T02:33:07.330
> 
> 标签：c++, qt, qstring

我有一个 char 数组，想将其中一个值从 char 转换为 qstring：

```
unsigned char inBuffer[64];

....
QString str= QString(*inBuffer[1]);
ui->counter->setText(str); 
```

这不起作用（我收到编译器错误）。有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T02:40:57.987

请查看[http://qt-project.org/doc/qt-4.8/qstring.html](http://qt-project.org/doc/qt-4.8/qstring.html)

```
QString &   operator+= ( char ch )

QString &   operator= ( char ch ) 
```

您可以使用 operator+= 来附加一个字符，或使用 operator= 来分配一个字符。

但是在您的代码中，它将调用构造函数，而不是 operator=。char 没有构造函数，因此您的代码无法编译。

```
QString str;
str = inBuffer[1]; 
```

QString 有一个构造函数

```
QString ( QChar ch ) 
```

所以你可以使用下面的代码来做到这一点

```
QString str= QChar(inBuffer[1]); 
```

或者

```
QString str(QChar(inBuffer[1])); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-06-22T06:34:39.473

这是最简单的方法：

```
QString x="";
QChar y='a';

x+=y; 
```

所以在这里你有一个带有字符的 QString。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-04-16T12:28:44.247

如果你的 var 是：`char * p = "hi there";`

你刚才`QString myGreet = QString::fromLocal8Bit(p);`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-11T02:37:48.410

你是如何声明**inBuffer 的**？如果您的意思是**outBuffer**，请删除取消引用运算符：

```
QString str = outBuffer[1]; 
```

# java - 使用 Fat Jar 的可执行 Jar 在本地工作空间位置而不是 Jar 根目录中查找 dll

> ID：14270761
> 
> 赞同：0
> 
> 时间：2013-01-11T02:33:07.100
> 
> 标签：java, javafx-2, executable-jar

我是 Java 和 Eclipse 的新手。我的项目使用依赖于本机 dll 的 3rd 方 jar。我将这些 dll 放在 bin 文件夹下，这在 eclipse 中运行良好。

我使用**“Fat Jar Exporter” eclipse 插件** 将我的项目导出为可执行 jar。使用 JDK jar 实用程序，我注意到 jar 正在 fat jar 之外的目标中寻找 javafx dll，**即使这个 dll 存在于 jar 的根目录中**。

如何**修改 jar 清单，以便它从 jar 中选择这些 dll，**或者我应该在将 jar 从 eclipse 中导出时设置一些路径。

我尝试添加**glass.dll；processor=x86;osname=win32,**在 Bundle-NativeCode 但它不起作用。

这是清单文件的外观，

```
Manifest-Version: 1.0
Created-By: Fat Jar Eclipse Plug-In
Main-Class: com.bosch.mvci.ui.UI

Name: com/sun/jna/
Implementation-Title: com.sun.jna
Implementation-Vendor: JNA Development Team
Implementation-Version: 3.4.1 (b671)
Specification-Title: Java Native Access (JNA)
Specification-Vendor: JNA Development Team
Specification-Version: 3
Bundle-ManifestVersion: 2
Bundle-Name: jna
Bundle-Description: JNA Library
Bundle-SymbolicName: com.sun.jna
Bundle-Version: 3
Bundle-RequiredExecutionEnvironment: J2SE-1.4
Bundle-Vendor: JNA Development Team
Bundle-ActivationPolicy: lazy
Export-Package: com.sun.jna,com.sun.jna.ptr,com.sun.jna.win32,javafx
Bundle-NativeCode: com/sun/jna/win32-x86/jnidispatch.dll; processor=x8
 6;osname=win32, com/sun/jna/win32-amd64/jnidispatch.dll; processor=x8
 6-64;osname=win32, com/sun/jna/w32ce-arm/jnidispatch.dll; processor=a
 rm;osname=wince,  com/sun/jna/sunos-x86/libjnidispatch.so; processor=
 x86;osname=sunos, com/sun/jna/sunos-amd64/libjnidispatch.so; processo
 r=x86-64;osname=sunos, com/sun/jna/sunos-sparc/libjnidispatch.so; pro
 cessor=sparc;osname=sunos, com/sun/jna/sunos-sparcv9/libjnidispatch.s
 o; processor=sparcv9;osname=sunos,  com/sun/jna/aix-ppc/libjnidispatc
 h.a; processor=ppc;osname=aix, com/sun/jna/aix-ppc64/libjnidispatch.a
 ; processor=ppc64;osname=aix,  com/sun/jna/linux-ppc/libjnidispatch.s
 o; processor=ppc;osname=linux, com/sun/jna/linux-ppc64/libjnidispatch
 .so; processor=ppc64;osname=linux, com/sun/jna/linux-i386/libjnidispa
 tch.so; processor=x86;osname=linux, com/sun/jna/linux-amd64/libjnidis
 patch.so; processor=x86-64;osname=linux, com/sun/jna/linux-arm/libjni
 dispatch.so; processor=arm;osname=linux, com/sun/jna/linux-ia64/libjn
 idispatch.so; processor=ia64;osname=linux,  com/sun/jna/openbsd-i386/
 libjnidispatch.so; processor=x86;osname=openbsd, com/sun/jna/freebsd-
 i386/libjnidispatch.so; processor=x86;osname=freebsd, com/sun/jna/fre
 ebsd-amd64/libjnidispatch.so; processor=x86-64;osname=freebsd,  com/s
 un/jna/darwin/libjnidispatch.jnilib; osname=macos,glass.dll; processo
 r=x86;osname=win32,javafx-font.dll; processor=x86;osname=win32, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T23:36:02.323

这实际上是正确的：

默认情况下，Windows 在当前用户目录中查找 .dll（在 Java 术语中，这是`user.dir`系统属性）

您的 Java 应用程序无法从 Jar 中加载 DLL。您需要将其复制到 Windows 能够查看的位置（只需复制到 user.dir 就可以了）

# c# - 最佳 ASP.NET MVC 搜索解决方案

> ID：14270766
> 
> 赞同：1
> 
> 时间：2013-01-11T02:34:01.190
> 
> 标签：c#, asp.net, asp.net-mvc, search

[https://addons.heroku.com/#search](https://addons.heroku.com/#search)列出了一些非常酷的搜索插件。我正在为我的 MVC 项目寻找类似的东西。我希望它是：

1.  相当容易实施
2.  准确（好结果）
3.  很棒的 AP​​I
4.  不需要全文搜索，只需按标题搜索（必须像 S/O 问题）

我也想知道我是否应该只使用 Google 搜索 API，因为它似乎非常准确。我很好奇 overflow.com 使用什么搜索系统堆栈？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T08:05:00.410

你要求一个 MVC 解决方案，我会给你一个。

实现接口 ISearchable

```
interface ISearchable{
    SearchResult Search(string query);
} 
```

实现类 SearchResult

```
public class SearchResult{
    SearchResult(string title, string url, string description, int rank){
        this.Title = title;
        this.Url = url;
        this.Description = description;
        this.Rank = rank;
    }
    public string Title { get; set; }
    public string Url { get; set; }
    public string Description { get; set; }
    public int Rank { get; set; }
} 
```

让您的 ViewModel 实现 ISearchable 接口。

```
public class MyViewModel : ISearchable{
    public List<Article> Articles { get; set; }

    #region ISearchable
    public SearchResult Search(string query){
        string title = "";
        string url = "";
        string description = "";
        int rank = 0;
        // Custom logic to search for an article
        ...
        return new SearchResult(title, url, description, rank);
    }
    #endregion
} 
```

在 上注册`ISearchable`ViewModel `Application_Start`，例如在`Unity`.

实施`SearchController`并拥有行动查询。

```
public ActionResult Query(SearchQueryModel model){
   model.Search();
   return View(model);
} 
```

在`model.Search()`中，通过已注册的实现`ISearchable`接口的 ViewModel 进行搜索，使用最适合您的任何搜索 API。或者不要使用 API。

现实情况是，任何搜索都会为您服务一时，但当它不再为您服务时，您可以切换而不会破坏您的实施。

我知道您要求“最佳 ASP.NET MVC 搜索解决方案”。我无法为您挑选任何特定的产品，因为我不知道您的解决方案的内部运作方式、您的预算等。

但严格从 ASP.NET MVC 的角度来看，可以插入到上述场景中的那个应该是一个不错的。如果它符合您的账单等...

# c++ - C++ MatLab 类似构造函数重载

> ID：14270768
> 
> 赞同：1
> 
> 时间：2013-01-11T02:34:07.730
> 
> 标签：c++, matlab, constructor

我有一个类 Sparse_Matrix 可以让我有效地处理稀疏矩阵。

我想通过使用特定（惯用的）关键字（例如 Upper、Identity 等）来实例化一个特定的矩阵。

这是我的类声明（命名空间矩阵）

```
template <typename T>
class Sparse_Matrix
{

  private:
  int rows;
  int cols;
  std::vector<int> col;
  std::vector<int> row;
  std::vector<T> value;
  ... 
```

有没有办法获得一个预初始化的对象？

```
 Sparse_Matrix<int> = Eye(3); 
```

将返回一个 3×3 单位矩阵。

我看过构造函数习语，但那些需要一些与我的类不兼容的软静态类型（尽管我愿意接受建议）。

我也试过这段代码：

```
template <typename T>
Sparse_Matrix<T> Eye(int size)
{
  Sparse_Matrix<T> ma;
  ma.IdentityMatrix(size);
  std::cout << "Eye!" << std::endl;
  return ma;
} 
```

...

```
Sparse_Matrix<int> blah = Eye(10); 
```

但无济于事。

谢谢，

SunnyBoyNY

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:36:37.767

拥有一个构造对象的函数是一个很好的策略。在您的示例中，一种解决方案是专门告诉`Eye`类型：

```
Sparse_Matrix<int> blah = Eye<int>(10); 
```

为了清楚起见，有时这些函数在类中是静态的：

```
template<typename T>
class Sparse_Matrix
{
public:
    static Sparse_Matrix<T> Eye(...) {...}
}; 
```

在这种情况下，您会调用：

```
Sparse_Matrix<int> blah = Sparse_Matrix<int>::Eye(10); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T02:41:52.103

There's only one place in C++ where template parameters can be deduced based on how the expression is used: a user-defined conversion operator.

```
struct Eye
{
    int size;
    explicit Eye(int requestedSize) : size(requestedSize) {}

    template<typename T>
    operator SparseMatrix<T>() const { SparseMatrix<T> ma; ma.IdentityMatrix(size); return ma; }
}; 
```

Now you can write

```
Sparse_Matrix<int> blah = Eye(10); 
```

# algorithm - 对整数链表进行排序？

> ID：14270772
> 
> 赞同：-2
> 
> 时间：2013-01-11T02:34:57.627
> 
> 标签：algorithm, sorting, data-structures, linked-list

我有一个`LinkedList`需要排序的（它包含`int`s），我不知道该怎么做。任何人都可以给我的源代码来对 int Linked List 进行排序吗？

我尝试了我在网上找到的这段代码，但它没有用。

```
 public void sort(LinkedList sortlist)
{
    //Enter loop only if there are elements in list
    boolean swapped = (head != null);

    // Only continue loop if a swap is made
    while (swapped)
    {
        swapped = false;

        // Maintain pointers
        Node curr = head;
        Node next = curr.link;
        Node prev = null;

        // Cannot swap last element with its next
        while (next != null)
        {
            // swap if items in wrong order
            if (curr.data>next.data)
            {
                // notify loop to do one more pass
                swapped = true;

                // swap elements (swapping head in special case
                if (curr == head)
                {
                    head = next;
                    Node temp = next.link;
                    next.link = curr;
                    curr.link = temp;
                    curr = head;
                }
                else
                {
                    prev.link = curr.link;
                    curr.link = next.link;
                    next.link = curr;
                    curr = next;
                }
            }

            // move to next element
            prev = curr;
            curr = curr.link;
            next = curr.link;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T03:25:55.993

斯坦福大学 CS106B 课程的[本讲义中提供了链表上合并排序](http://www.stanford.edu/class/archive/cs/cs106b/cs106b.1126/handouts/200S%20Section%20Solutions%205.pdf)的C++ 实现。它运行时间为 O(n log n)，非常好。

有关其他方法的调查，请查看有关如何对链表进行排序[的旧 SO 答案。](https://stackoverflow.com/a/7168300/501557)那里没有代码，但是很好地描述了如何使现有想法适应链表。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T07:32:32.117

合并排序和快速排序可用于对链接列表（平均 O(n.long)）进行就地排序。此外，如果您的数字是整数，则有一种基数排序的变体，它可以工作 O(n) 并且它已经到位。所以你不满足将链表转换为数组。

以下是 STL 中的实施信息：[http ://www.cplusplus.com/reference/list/list/sort/](http://www.cplusplus.com/reference/list/list/sort/)

# c# - 接收服务器上的 TCP 异步套接字速度慢？

> ID：14270773
> 
> 赞同：0
> 
> 时间：2013-01-11T02:34:59.853
> 
> 标签：c#, sockets, asynchronous, tcp

所以我的问题是我的服务器无法接收客户端发送的所有数据，这导致服务器端几乎没有收到任何数据包。

基本上问题是我需要大量睡眠 CLientLoop ，以便接收发送的数据。如 Thread.Sleep(1000)

（这是在本地测试过的）

我的服务器代码在这里：

```
 public void RecieveAsync()
    {
        socket.BeginReceive(lenBuffer, 0, lenBuffer.Length, SocketFlags.None,recieveCallBack, null);
    }

    private void recieveCallBack(IAsyncResult ar)
    {

            int rec = socket.EndReceive(ar);
            if (rec == 0)
            {
                if (Disconnected != null)
                {
                    Disconnected(this);
                    return;
                }

                if (rec != 4)
                {
                    throw new Exception();
                }
            }
        /

        buffer = new ReceiveBuffer(BitConverter.ToInt32(lenBuffer, 0)); 
```

也是我为那些感兴趣的人准备的缓冲类（可能有帮助）

\ public struct ReceiveBuffer { public const int BUFFER_SIZE = 1024; 公共字节[]缓冲区；公共 int 接收；公共 MemoryStream BufStream；

```
 public ReceiveBuffer(int toRec)
    {
        Buffer = new byte[BUFFER_SIZE];
        ToReceive = toRec;
        BufStream = new MemoryStream(toRec);
    }

    public void Dispose()
    {
        Buffer = null;
        ToReceive = 0;
        Close();
        if (BufStream != null) BufStream.Dispose();
    }

    public void Close()
    {
        if (BufStream != null && BufStream.CanWrite)
        {
            BufStream.Close();
        }
    } 
```

所以我的客户正在用这种方法发送数据

```
 public void Send(byte[] data, int index, int length)
    {
        //add data as state
        socket.BeginSend(BitConverter.GetBytes(length), 0, 4, SocketFlags.None, new AsyncCallback(sendCallback), data);
        socket.BeginSend(data, index, length, SocketFlags.None, new AsyncCallback(sendCallback), null);
    } 
```

发送信息的位置在这里

```
 public void ClientLoop()
    {

        try{

        Console.WriteLine("In Client loop");

            client.DataRecieved +=new Client.DataRecievedEventHandler(Client_DataRecieved);

        while (true)
        {

            byte[] playerData = PreparePlayerData();

            client.Send(playerData, 0, playerData.Length);

            //client.RecieveAsync();

            Thread.Sleep(10);

        }

                   }
        catch (Exception ex)
        {
            System.Windows.Forms.MessageBox.Show(ex.ToString());
        }

    } 
```

和

```
 public byte[] PreparePlayerData()
    {

        BinaryWriter bw = new BinaryWriter(new MemoryStream());
        bw.Write((int)Commands.Text);

        string data = "";

        string Position = Math.Round(MultiplayerScreen.localPlayer.Position.X, 2).ToString() + "|" + Math.Round(MultiplayerScreen.localPlayer.Position.Y, 2).ToString();
        string effects = (MultiplayerScreen.localPlayer.Effects == Microsoft.Xna.Framework.Graphics.SpriteEffects.None) ? "0" : "1";
        string animaton = (MultiplayerScreen.localPlayer.Animation.MoveState).ToString();
        string frame = MultiplayerScreen.localPlayer.Animation.XFrame.ToString();

        data = "P|" + Position + "|" + effects + "|" + animaton + "|" + frame;

        bw.Write(data);

        bw.Close();

        byte[] toSend = ((MemoryStream)bw.BaseStream).ToArray();

        bw.BaseStream.Dispose();

        return toSend;

    } 
```

这也是服务器处理接收到的数据的方法

```
 void Client_DataRecieved(Client sender, ReceiveBuffer e)
    {

        BinaryReader r = new BinaryReader(e.BufStream);

        Commands header = (Commands)r.ReadInt32();

        string s = r.ReadString();

        Console.WriteLine("Client has received " + s);

        switch (header)
        {
            case Commands.Player:
                {

                    HandlePlayerData(s);

                    Console.WriteLine("The player data has been updated");

                }
                break;
            case Commands.Text:
                {
                    if (s.StartsWith("clientAccepted"))
                    {
                        connectedPlayer.isOnline = true;
                    }
                    if (s.StartsWith("P|"))
                    {
                        s = s.Remove(0, 2);
                        HandlePlayerData(s);
                    }
                }
                break;
        }
    }

        socket.BeginReceive(buffer.Buffer, 0, buffer.Buffer.Length, SocketFlags.None, receivePacketCallback, null);

    }

    void receivePacketCallback(IAsyncResult ar)
    {
        int rec = socket.EndReceive(ar);

        if (rec <= 0)
        {
            return;
        }

        buffer.BufStream.Write(buffer.Buffer, 0, rec);

        buffer.ToReceive -= rec;

        if (buffer.ToReceive > 0)
        {
            Array.Clear(buffer.Buffer, 0, buffer.Buffer.Length);

            socket.BeginReceive(buffer.Buffer, 0, buffer.Buffer.Length, SocketFlags.None, receivePacketCallback, null);

            return;

        }

        if (DataRecieved != null)
        {
            buffer.BufStream.Position = 0;
            DataRecieved(this, buffer);
        }

        buffer.Dispose();

    } 
```

# ruby-on-rails - Rails 3.2 根据复杂关系组织报表

> ID：14270777
> 
> 赞同：1
> 
> 时间：2013-01-11T02:35:32.543
> 
> 标签：ruby-on-rails, report, rails-activerecord

我正在为具有以下数据关系的仓储/运输公司开发一个程序。关于以下关系的细枝末节是，仓库从各种承运人（客户）那里接收原材料（产品）并将它们存储起来，直到需要将它们运送到制造工厂。当货物离开仓库时，制造工厂必须知道每种原材料来自哪家公司。看看下面的 ERD。 ![在此处输入图像描述](../Images/963b684ea81b097d7ff268631cf1553a.png)

编辑：我的文本形式的关系。

装运.rb

```
has_many :product_shipments, :dependent => :destroy
has_many :products, :through => :product_shipments 
```

product_shipment.rb

```
belongs_to :product
belongs_to :shipment 
```

产品.rb

```
has_many :product_shipments
has_many :shipments, :through => :product_shipments, :dependent => :destroy
belongs_to :client 
```

客户端.rb

```
 has_many :products, :dependent => :destroy 
```

我无法以符合要求的方式生成查询。发货报告需要一个日期，并且必须遍历每个客户并列出在该给定日期运送到制造工厂的产品。它需要动态生成并格式化如下。

```
Shipment Date: 2013-01-01

Client: 12 Name: ACME Widget Co

Product Name | Product Code | Qty Shipped
_________________________________________ 
nuts & bolts |      gj-3423 |          25
steel sheet  |      4g-2394 |          10
dc Motor     |      cj-c213 |           4

Client: 14 Name: Blah Blah, Inc

Product Name | Product Code | Qty Shipped
_________________________________________ 
spacers      |      gj-3423 |          15
epoxy        |      4g-2394 |          10
dc Motor     |      24-gj19 |           6

Client: 15 Name: Sample Co, Inc

Product Name | Product Code | Qty Shipped
_________________________________________ 
hot roll 48  |      cg-3423 |          15
welding wir  |      4g-2394 |          10
dc Motor     |      c2-1241 |           6
.
.
.
. 
```

问题是使用 ActiveRecord 生成查询。在下面的给定日期获取货物和产品很容易。获取原材料来源的原始客户，然后动态地迭代运送到该客户的制造设施并不容易。

更新：我现在可以像上面那样对客户和货物进行分组。现在我需要排除在指定日期没有发货的客户。下面虽然有些正确，但仍然给出了可怕的 O(n) 查询。这就是我所拥有的。

```
@clients = Client.includes(:products => :shipments)
@clients.each do |c|
  puts c.name
  c.products.each do |p|
    p.shipments.where("ship_date like '#{@ship_date.strftime("%Y-%m-%d")}%'").each do |s|
      s.product_shipments.joins(:product).each do |ps|
        puts s.bill_of_lading + " " + ps.product_id.to_s + " " + ps.product.product_name.to_s + " " + ps.product.product_code + " " +ps.qty_shipped.to_s + " " + s.ship_date.to_s
        end
    end
  end
end 
```

我的问题是如何组织查询以从客户开始，然后列出 2012 年 6 月 30 日发货的产品。从这个角度来看，查询变得古怪。当关系离得太远时，我不确定如何生成带有活动记录的查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T16:37:07.223

更新：好的，看看您在报告中期望的结果，需要从 ProductShipment 中提取值（如数量属性），因此 product_shipments 必须包含在我们急切加载的嵌套关联中，否则 ProductShipments 不会实例化，它仅用作连接表。

因此，而不是`Client.includes(:products => shipments)...`你想要：

```
@clients = Client.includes(:products => {:product_shipments => :shipment}).
                  where("shipments.ship='#{ship_date}'") 
```

现在我不完全理解您的域模型，但是当有很多嵌套关联时，我喜欢在一对一的关系中找出包含最多信息的关联，因为它们可以被视为中心部分。在这种情况下，product 和 shipping 都可以理解为“主模型”product_shipment 的扩展。

因此，您可以写（尊重得墨忒耳定律）：

```
class ProductShipment < AR
  def report_details
    s = shipment; p = product
    "#{s.bill_of_lading} #{p.id} #{p.name} #{p.code} #{quantity} #{s.shipped_on}"
  end
end 
```

棘手的部分来了：正如它所写的那样，`:products => {:product_shipments => :shipment}`Rails 理解

`product_shipments.shipment`但不是`product_shipment.products`

后者实际上会触发一个数据库调用......（我们试图避免）。值得庆幸的是，Rails 的口袋里还有另一个窍门：

```
class ProductShipment < ActiveRecord::Base
  belongs_to :product, inverse_of: :product_shipments
end

class Product < ActiveRecord::Base
  has_many :product_shipments, inverse_of: :product
end 
```

为关联镜像投保后，您现在可以通过产品获取 product_shipments 并获取您的报告，而无需在 DB 上调用 O(n) ：

```
@client.map {|c| c.products.map {|p| p.product_shipments} }.flatten.each do |ps|
  puts ps.details
end 
```

更新结束

* * *

您必须急切加载相关模型，否则您将进入臭名昭著的 O(n) 查询。

```
Shipment.where(:date => someday).includes({:product => :client}).each do |shipmt|
  puts shipmt.date

  shipmt.product.group_by(&:client).each do |client, products|
    puts client

    products.each do |product|
      puts product.details
    end
  end
end 
```

顺便说一句，假设您在此处有`has_many :through`or`has_and_belongs_to_many`关联，则直接从发货到产品进行连接，因此无需使用连接表（又名 product_shipment）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T02:04:25.473

这就是我的做法。也许不是最好的方法，但它很接近。感谢@charlysisto 通过轻松加载关系向我发送正确的方向。我仍然在查找表的连接查询中得到 O(n)，但可能会更糟。任何改进请发表评论，以便我改进答案。

```
@clients = Client.order("clients.id ASC").includes(:products => :shipments).where("shipments.ship_date like '#{ship_date}'")
@clients.each do |c|
  puts c.name
  c.products.each do |p|
    p.shipments.each do |s|
      s.product_shipments.joins(:product).each do |ps|
        puts shipment and products stuff
      end
    end
end 
```

# javascript - 将 HEXADECIMAL（或 base64）输入编码为 base32 输出，将 base32 输入解码为 hex/base64 - 寻找 Javascript 解决方案

> ID：14270782
> 
> 赞同：2
> 
> 时间：2013-01-11T02:35:53.010
> 
> 标签：javascript, encoding, base64, base32

我在 JS 中遇到了一个不错的 base64 编码实现，它的典型工作是采用 utf8 编码的文本输入并给出 base64 输出（反之亦然）。但令我惊讶的是，我从未见过适合 base32 的解决方案！好吧，这就是我发现的全部内容：
1\. [agnoster/base32-js](https://github.com/agnoster/base32-js)。这是针对 nodejs 的，它的主要 base32.encode 函数将输入作为字符串。
2\. [base32-encoding-in-javascript](http://forthescience.org/blog/2010/11/30/base32-encoding-in-javascript/)。这也将输入作为字符串。此外，这缺少解码器。
但我需要脚本将输入作为 HEX（甚至 base64）！如果我的输入是十六进制，那么输出将被缩短；如果我的输入是base64，那么，根据[维基百科](http://en.wikipedia.org/wiki/Base32#Disadvantages)，输出将超大20%——这就是我所期望的。
给定字母“ABCDEFGHIJKLMNOPQRSTUVWXYZ234567”：

```
hexdata: 12AB3412AB3412AB3412AB34;

//RFC 3548 chapter 5: The encoding process represents 40-bit groups of input bits 
//as output strings of 8 encoded characters. 

 bin     b32
00010 --> C
01010 --> K
10101 --> V
10011 --> T
01000 --> I
00100 --> E
10101 --> V
01011 --> L
//+40 bits
00110 --> G
10000 --> Q
01001 --> J
01010 --> K
10110 --> W
01101 --> N
00000 --> A
10010 --> S
//+16 bits
10101 --> V  //RFC 3548 chapter 5 case 3:
01100 --> M  //the final quantum of encoding input is exactly 16 bits; 
11010 --> 2  //here, the final unit of encoded output will be four characters 
0     -->    //followed by four "=" padding characters
//zero bits are added (on the right) to form an integral number of 5-bit groups
--> 
00000 --> A
--> base32data: CKVTIEVLGQJKWNASVM2A==== 
```

我希望看到 javascript`hextobase32("12AB3412AB3412AB3412AB34")`产生**CKVTIEVLGQJKWNASVM2A====**并`base32tohex("CKVTIEVLGQJKWNASVM2A====")`返回**12AB3412AB3412AB3412AB34**。

**更新**
除了似乎无法处理填充问题的[agnoster/base32-js](https://github.com/agnoster/base32-js)
之外，我还遇到了以下库： 1\. [Nibbler](http://www.tumuski.com/2010/04/nibbler/)。根据[维基百科](http://en.wikipedia.org/wiki/Base32#Disadvantages)，有两种编码方式：8 位和 7 位。这个库甚至有一个选项`dataBits`（也许它只适用于base64，而不适用于base32，我不知道）选择8位或7位方式！但是这个项目根本没有发展。还有一件事：阅读评论，我发现这个库也有填充问题！
2\. [Chris Umbel 三十二.js](https://github.com/chrisumbel/thirty-two/blob/master/lib/thirty-two/thirty-two.js)。这个库决定携带整个字节表进行解码。你可以在源代码中看到这个有趣的注释：
/* 逐字节不如 quintet by quintet 漂亮，但测试速度更快。将不得不重新访问。*/
但没有进化。
3.jsliquid .[数据](http://www.jsliquid.com/docs/data/jsl_data.html)。对所谓的[二进制大对象](http://www.jsliquid.com/tutorials/blob_objects.html)进行操作。似乎完成了工作，但由于它的代码被严重混淆，我什至看不到如何定义我的自定义字母表。
现在，我认为质量可靠的全功能 Javascript UTF8/hex/base32/base64 库会很棒，但目前情况令人怀疑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T10:27:14.770

那么第一个 node.js 接受二进制字符串的输入，你想要的是它接受 base-16 或 base-64 的输入。由于您已经有了不错的 base-64 实现，而且 base16 解码器非常简单，我想您已经准备好了。

[https://github.com/agnoster/base32-js/blob/master/lib/base32.js](https://github.com/agnoster/base32-js/blob/master/lib/base32.js)也适用于开箱即用的浏览器。

所以你会在浏览器中这样使用它：

```
var result = base32.encode(base64decode(base64input));
var result2 = base32.encode(base16decode(base16input));
var result3 = base32.encode(binaryInput); 
```

哪里`base16decode`：

```
function base16decode( str ) {
    return str.replace( /([A-fa-f0-9]{2})/g, function( m, g1 ) {
        return String.fromCharCode( parseInt( g1, 16 ));
    });
} 
```

[http://jsfiddle.net/YPuF3/1/](http://jsfiddle.net/YPuF3/1/)

# sql - SQL Server 查询每个 customerID 的订单总金额

> ID：14270783
> 
> 赞同：1
> 
> 时间：2013-01-11T02:35:58.790
> 
> 标签：sql, sql-server, sql-server-2012

我有两个表需要为其创建查询。我相信我也需要加入他们。

我需要从我的表中获取客户的`CustomerName`和，但我还需要查询以显示客户下的所有订单的总美元金额。因此，如果客户今年总共花费了 300 美元，那么这 300 美元就是我想要实现的输出。`Address``Customer`

我有一个名为的表`Order Details`，它使用一个`OrderID`与 a 相关联的表，并且表中`CustomerID`有`unitprice`和`quantity`列`Order Details`。我试图弄清楚如何将这些组合起来，但我快疯了。

我已经尝试过至少从订单中获取总数，但我肯定有语法错误：

```
SELECT unitprice, 
       quantity 
FROM   [Order details] (unitprice * quantity) AS Totalorders, 
       from [Order Details] 
WHERE  orderid > 0 
```

这也没有任何运气：

```
SELECT customers.companyname                                AS 'Company Name', 
       customers.address                                    AS 'Address', 
       [order details].unitprice * [order details].quantity AS 'Orders' 
FROM   customers 
       LEFT JOIN orders 
              ON customers.customerid = orders.customerid 
ORDER  BY customers.companyname, 
          customers.address, 
          orders 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:40:27.907

if it s one-to-many relationship, your query will look something like:

```
SELECT
Customers.CompanyName AS 'Company Name',
Customers.Address AS 'Address',
SUM(O.Unitprice * O.quantity) as 'Orders'
FROM Customers
LEFT JOIN [Order Details] O
ON Customers.CustomerID = O.CustomerID
GROUP BY Customers.CompanyName, Customers.Address
ORDER BY Customers.CompanyName, Customers.Address 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:40:30.170

You need to join in the order details and do a group by aggregation:

```
SELECT c.CompanyName AS "Company Name",
       c.Address AS "Address",
       sum(od.Unitprice * od.quantity) as "Orders"
FROM Customers c LEFT JOIN
     Orders o
     ON c.CustomerID = o.CustomerID left join
     [Order Details] od
     on od.orderid = o.orderid
GROUP BY c.CompanyName, c.Address
ORDER BY c.CompanyName, c.Address 
```

In addition, I made some stylistic changes. I added aliases to the table names. I find it much easier to read `c.CompanyName` rather than `Customers.CompanyName`. I changed the delimiter on the column aliases to use double quotes rather than single quotes. I associate single quotes with string constants inside the statement.

# ruby-on-rails-3 - 错误 500：我们很抱歉...由于 javascript_include_tag

> ID：14270785
> 
> 赞同：0
> 
> 时间：2013-01-11T02:36:10.057
> 
> 标签：ruby-on-rails-3, asset-pipeline

我已经遵循了关于这个问题的所有建议，但是当我在服务器上运行我的应用程序时出现`Error 500: We're sorry...`错误。

该`production.log`文件告诉我这一行是违规者：

```
<%= javascript_include_tag "application" %> 
```

我的`application.js`文件如下所示：

```
//= require jquery
//= require jquery_ujs
//= require turbolinks
//= require jquery.turbolinks
//= require fancybox
//= require bootstrap
//= require bootstrap-wysihtml5
//= require_tree . 
```

（并且删除最后一行没有帮助。）由于它与资产相关，我的`production.rb`文件的相关部分是：

```
config.serve_static_assets = true
config.assets.compress = false
config.assets.compile = true
config.assets.digest = true 
```

任何帮助都会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:55:36.553

我不知道这是否会对任何人有所帮助，但我的 gemfile 中需要这些行：

```
group :assets do
  gem 'coffee-rails'
end 
```

# php - Zend 从文本框中获取值并将其添加到搜索 url

> ID：14270794
> 
> 赞同：-1
> 
> 时间：2013-01-11T02:37:16.560
> 
> 标签：php, html, zend-framework, search

我有疑问，这是以下代码。

```
<form action="" method="post" id="search">
        <div class="row collapse">
        <div class="ten columns mobile-three">
        <input type="text" size="25" name="search" value="<?php echo $this->search ?>"/>
        </div>
        <div class="two columns mobile-three">
        <input type="submit" name="/search/index/keyword/" value="Search"; ?>" class="button   expand postfix" id="search_button"/> 
        </div>
        </div>
</form> 
```

当我点击提交按钮时，网址应该是从`id/`到`id/search/index/keyword/(here's the search key)`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T03:19:54.140

HTML

```
<form action="" method="post" id="search" name="search" onsubmit="submitForm();">
        <div class="row collapse">
        <div class="ten columns mobile-three">
        <input type="text" size="25" name="search" id="search_value" value="<?php echo $this->search ?>"/>
        </div>
        <div class="two columns mobile-three">
        <input type="hidden" value="/search/index/keyword/" id="search_url"/> 
        <input type="submit" name="search" class="button   expand postfix" id="search_button"/> 
        </div>
        </div>
</form> 
```

JS

```
<script>
    function submitForm() 
    {
        var search_button = document.getElementById('search_url').value;
        var search_text = document.getElementById('search_value').value;
        document.searchForm.action = search_button + '/' + search_text;
        document.searchForm.submit();
        return false;
    }

</script> 
```

PHP

```
<?php

if (isset($_POST['search'])) {
    // add action code here
}

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T03:11:49.930

您可以使用 JS 来实现您的目标。

1）制作一个在用户单击提交按钮时运行的功能。

2）功能从搜索框中抓取单词。

3) 函数改变表单元素上的“action”属性

4) 表单提交

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T02:44:15.547

我会为此使用服务器端语言。制作流程页面（除非您熟悉 AJAX），通过 $_POST 获取值并重定向流程页面。

我很确定也可以使用 JavaScript，但我真的不擅长，所以不要指望我的解决方案。

# vb.net - 生成文档（.doc）VB.NET时通过书签获取页码

> ID：14270804
> 
> 赞同：0
> 
> 时间：2013-01-11T02:38:12.957
> 
> 标签：vb.net, printing, ms-word

我目前正在使用参考 Interop.Microsoft.office.interop.word 对 vb.net 项目进行增强。现在我可以打印出一个文档，并且生成的文档中几乎没有书签。有没有办法检索那些书签的页码？总之，我想知道这些书签所在的页码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T05:56:19.440

我找到了如下解决方案：

```
 GetPageNumberOfRange(BookmarkA.Range) 
```

* * *

```
Public Function GetPageNumberOfRange(ByVal range As Microsoft.Office.Interop.Word.Range) As Integer
    Return range.Information(Microsoft.Office.Interop.Word.WdInformation.wdActiveEndPageNumber)
End Function 
```

# c++ - 价值的生命周期

> ID：14270808
> 
> 赞同：2
> 
> 时间：2013-01-11T02:38:51.970
> 
> 标签：c++, c

我对`myname`数组的生命周期感到困惑，它在`if`声明中还活着吗？我们在 c 和 c++ 中得到相同的答案吗？

```
int main (int argc, char* argv[])
{
    char* host;

    if (1 == argc)
    {
/*code below is copied from a book*/
        char myname[256];
        gethostname(myname, 255);
        host = myname;
/*code above is copied from a book*/
    }

    else
    {
        /*        */
    }
    printf("%s\n",host);

    return 0;
} 
```

## 编辑：

代码片段来自本书`Begining Linux Programming 4th edition`，第15章：套接字，很抱歉作者犯了这样的错误。但我认为这本书很好，排除了这段代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T02:40:27.500

> `myname` array's lifetime[;] is it still alive out of the if statement?

**No**

```
Do we get the same answer in C and C++? 
```

**Yes**

*It is ugly, bad code and has UB*, use `std::string` for `host`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T02:41:03.783

The `myname` array is destroyed at the end of the `if`. Printing `host` at this point might just work but is **Undefined behavior**, since you are using a pointer to memory that **has been destroyed**. Its functioning is implementation dependant (and other factors).

It is identical (destroyed => undefined) in both C and C++

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T02:41:28.890

Once you leave that `if` block there are no guarantees for `myname[256]`. There is nothing in the compiler that would keep track of the fact that `host` points to `myname`, in order to "keep it alive".

# android - 我如何为这样的聊天应用创建布局（图像/按钮/表情）？

> ID：14270816
> 
> 赞同：0
> 
> 时间：2013-01-11T02:39:56.253
> 
> 标签：android, layout, chat

我刚刚为 android 创建了一个聊天应用程序，我遇到了一个问题，无法为贴纸、表情符号和图像创建一个位置，该位置受出现的选项卡限制，同时单击按钮，如下图所示.. [http://mydistrosport.com /gab.jpg](http://mydistrosport.com/gab.jpg)

也许你们中的任何人都可以提供帮助，我在哪里可以获得解决此案的链接？

谢谢。。新手。。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:55:46.427

为此，您应该使用`Slidingdrawer`. 您将从以下链接中获得不错的样本

1.  [http://blog.sephiroth.it/2011/03/29/widget-slidingdrawer-top-to-bottom/](http://blog.sephiroth.it/2011/03/29/widget-slidingdrawer-top-to-bottom/)
2.  [http://code.google.com/p/android-misc-widgets/](http://code.google.com/p/android-misc-widgets/)
3.  [http://w2davids.wordpress.com/android-slidingdrawer-top-down-style/](http://w2davids.wordpress.com/android-slidingdrawer-top-down-style/)

# c# - Generic Factory with type parameter

> ID：14270820
> 
> 赞同：2
> 
> 时间：2013-01-11T02:40:32.610
> 
> 标签：c#

I have the following situation.

My Factory class needs to create appropriate Strategy objects based on the input string argument to the CreateStrategy function.

Strategy1, Strategy2 etc are all derived from a common StrategyBase class. However each strategy has a different Validation mechanism which is the type parameter to the Factory class. However, the StrategyValidators are not of any common type and have different interfaces.

Therefore, in the below code, I am unable to specify any common constraint on the StrategyValidator type.

I am new to C# and hence not sure if there exists any mechanism to get over this design issue. Please suggest

```
public class Factory
{
    //Create the appropriate Concrete Implementation class based on the type
    public static StrategyBase CreateStrategy<StrategyValidator>(String Type)
    {
        StrategyBase EnumImp = null;

        // WMI based implementation
        if (Type == "Type1")
        {
            s = Strategy1<StrategyValidator>.Instance;
        }
        else if (Type = "Type2")
        {
            s = Strategy2<StrategyValidator>.Instance;
        }
        return s;
    }

    private StrategyBase s;
} 
```

Here's the intended usage

```
Factory f = new Factory(); 

f.CreateStrategy<WMIValidator>("WMI");
f.CreateStrategy<ABCDValidator>("ABCD"); 
```

where `WMIValidator` and `ABCDValidator` are unrelated types, but the actual classes created by `CreateStrategy` function are related in a hierarchy e.g. having a common base `StrategyBase`

Here is a sample code to illustrate the issue

```
namespace TestCSharp
{
    public interface IStrategy
    {
    };

    public interface S1 : IStrategy
    {
        void f1();
        void f2();
    };

    public class S1Concrete : S1
    {
        public void f1() { }
        public void f2() { }
    }

    public interface S2 : IStrategy
    {
        void f3();
        void f4();
    };

    public class S2Concrete : S2
    {
        public void f3() { }
        public void f4() { }
    };

    public interface ProductBase
    {
    };

    class Product1<T> : ProductBase where T : S1
    {
    };

    class Product2<T> : ProductBase where T : S2
    {
    };

    public class Factory
    {
        public ProductBase Create<T>(String Type)
        {
            if (Type == "P1")
                return new Product1<T>();
            else if (Type == "P2")
                return new Product2<T>();
        }
    };

    class Program
    {
        static void Main(string[] args)
        {
            Factory f = new Factory();
            ProductBase s = f.Create<S1Concrete>("Type1");
        }
    }
} 
```

The error I get is

> The type 'T' cannot be used as type parameter 'T' in the generic type or method 'TestCSharp.Product1'. There is no boxing conversion or type parameter conversion from 'T' to 'TestCSharp.S1'.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T03:52:52.350

我并不完全了解您的情况，但据我所知，您正在使用的工厂模式必须使用反射来实例化产品。这有点难看，因为它没有给消费者任何关于给定产品名称可以使用哪些策略类型的提示。

```
public class Factory
{
    public ProductBase Create<T>(string name)
    {
        Type type;
        switch (name)
        {
            case "P1":
                type = typeof (Product1<>);
                break;
            case "P2":
                type = typeof (Product2<>);
                break;
            case "P3":
                type = typeof (Product3<>);
                break;
            default:
                return null;
        }
        type = type.MakeGenericType(typeof (T));
        return (ProductBase) Activator.CreateInstance(type);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T03:49:29.773

我认为在这种情况下的答案是，这**取决于你想要做什么`Product`和`Strategy`做什么**。你似乎想要做的是将你的逻辑分成两个分支。然后你想通过使用泛型再次耦合它，但正如你所注意到的，它不起作用。

考虑一个场景，类似于你上面的场景——但是每个实现的类`IStrategy`都有一个而不是两个产生副作用的方法（即打印一个字符串）。当允许的类型范围有共同点时，您可以使用泛型。在我刚才提到的情况下，两者都有一个返回 void 并且不接受参数的方法；所以我们可以添加一个方法`IStrategy`，例如：

```
public interface IStrategy
{
    void ExecuteLogic();
};

public class S1 : IStrategy
{
    public void ExecuteLogic()
    {
        OneMethod();
    }

    void OneMethod()
    {
        Console.WriteLine("Hello");
    }
};

public class S2 : IStrategy
{
    public void ExecuteLogic()
    {
        TotallyDifferentMethod();
    }

    void TotallyDifferentMethod()
    {
        Console.WriteLine("World");
    }
}; 
```

现在，您也说过`Strategy1`并且`Strategy2`有不同的验证机制。但是，在我看来，您在相同的方法和上下文中使用它们（因此也使用相同的参数和变量），所以一定有一些东西使它们相似。尽管如此，`IStrategy`按照我们需要的方式定义后，我们可以将其用作`Create<T>`. 所以，`Factory`变成：

```
public class Factory
{
    public ProductBase Create<T>(String Type) where T : IStrategy
    {
        if (Type == "P1")
            return new Product1<T>();
        else if (Type == "P2")
            return new Product2<T>();
        return null;
    }
}; 
```

但还有一种情况。如果您不想`Product1`被称为`S2`泛型类型，或者不想`Product2`拥有`S1`它的泛型，那么为什么首先使用泛型呢？您可以轻松地将产品与其相关策略相结合，并显着简化代码。

如果我错过了某些东西（或整个问题），请发表评论，我会尝试调整我的答案。

**编辑**：因为现在你已经重新定义了你的例子并使用`S1`和`S2`作为接口，我明白你的意思。一种方法是为`Factory.Create`. 例子：

```
public ProductBase Create<T1, T2>(String Type) where T1 : S1 where T2 : S2 
```

正如您正确指出的那样，否则这是不可能的，因为您的班级没有共同的祖先`S1`并且`S2`可以接受。`Product`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T06:13:13.720

您是否考虑过重载 Create<> 函数？我现在没有方便的 VisualStudio，但是以下代码是否适合您的情况？

```
namespace ... {
    // ... other code here...

    public class Factory {
        public Product1<T> Create<T>() where T : S1 {
            return new Product1<T>();
        }
        public Product2<T> Create<T>() where T : S2 {
            return new Product2<T>();
        }
    }

    class Program {
        static void Main(string[] args) {
            Factory f = new Factory();
            ProductBase s = f.Create<S1Concrete>();
        }
    }
} 
```

此外，您可能希望将类型约束移至较低级别。考虑编写一个抽象基类 ProductBase （继承自`IProductBase`接口？），如下所示：

```
class ProductBase<T> : IProductBase where T : IStrategy { } 
```

这可能有助于缓解您的一些头痛。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T04:29:30.310

您可以更改函数以将 StrategyValidator 作为类型。

从

```
public static StrategyBase CreateStrategy<StrategyValidator>(String Type) 
```

至

```
public static StrategyBase CreateStrategy<T>(String Type) where T:StrategyValidator 
```

要回答您的问题，您无法避免条件检查。

为了简化代码，可以将不同的组合（“Type1”、“Type2”等）移动到`dictionary`配置中，如果你使用的话[`Dependency Injection`](http://objectview.wordpress.com/tag/strategy-pattern/)，然后你可以反思。

例子。

```
 if (!dict.ContainsKey(key)) 
       throw New InvalidArgumentException();

    StrategyBase EnumImp = null;

    var instance = dict[key].MakeGenericType(typeOf(type)).GetProperty("Instance",  BindingFlags.Static | BindingFlags.Public ));   //dict is Dictionary<string, Type> 
```

# php - 需要清理垃圾邮件数据库

> ID：14270824
> 
> 赞同：0
> 
> 时间：2013-01-11T02:40:57.440
> 
> 标签：php, mysql, database

所以有几件事。首先，生病了，我似乎无法像我应该的那样专注于弄清楚这一点，其次，这让我对如何处理这个问题感到困惑。

所以我有一个客户，他有一个基于旧代码的旧网站。代码中存在一些允许注入和攻击的极端漏洞——这种情况发生了。自从我进入这个项目以来，我已经大大收紧了事情，并没有真正遇到问题。但我刚刚发现了一些似乎是以前黑客攻击中挥之不去的问题。

所以在数据库中，他们有一个名为“copy”的字段，用于存储文章的内容。好吧，不是最好的名字，但它就在那里。所以这就是问题所在。自黑客攻击以来，有大约 52k 行中包含“伟哥”一词。因此，当我仔细查看复制字段和视图源中的代码时，我发现：

```
for the little kids in the neighborhood.<div style="display: none;"> 
```

基本上打开和关闭的 div 标签具有如上所示的样式集。所以它不会在页面上直观地呈现，但是当您查看源代码或...“搜索引擎蜘蛛”经过时，他们会看到它。直到今晚，我都无法弄清楚为什么上传到 article_image 目录的 .php 文件会在网站管理员工具中被索引。现在我知道为什么了。

所以这就是我需要的。因为数据库中的每一行（其中 52k）都有作为示例（the `<div style...>`）部分给出的内容，并且它们都出现在最初存在的内容之后，所以我需要一些可以添加到循环中的东西来清除废话复制字段，以便清理混乱。我可以采用 str_replace 方法——但这太长了，不能保证我会得到所有的东西。

所以 - 有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T02:44:25.387

试试这个：（假设“内容”是文章内容的列名）

```
UPDATE `copy` SET `content`=
     SUBSTR(`content` FROM 1 FOR LOCATE('<div style="display: none;">',`content`))
     WHERE `content` LIKE '%<div style="display: none;">%'; 
```

由于您已经指出这些注射始终是文章中的最后一件事，因此这将很好地消除它们。不过，我强烈建议先备份一份！

# assembly - dos程序集无法写入文件

> ID：14270831
> 
> 赞同：2
> 
> 时间：2013-01-11T02:41:32.820
> 
> 标签：assembly, dos, createfile, dosbox

我写了一个 16 位的 .com 文件，它创建了一个文件

但它不会创建任何文件。

我在 Windows 7 32 位上试过。和dosbox里面。

源代码在这里

如何写入文件？

```
org 100h

        call open_new_file
        mov ah, 40h;write
        mov bx, [new_file_handle]
        mov cx,2;write 2 bytes
        mov dx, temp
        int 21h

        mov ah, 3eh;close file
        mov bx, [new_file_handle]
        int 21h

        mov ah, 00
        int 16h;wait key

        mov ax, 4c00h
        int 21h;exit

open_new_file:
        push bp
        mov bp, sp
        mov ah, 3dh;open file
        mov al, 02h;write only
        mov dx, new_file_name ;out.kty
        int 21h
        mov [new_file_handle], ax
        leave
        ret

temp:
        dw 0xffaa

new_file_handle:
        dw 0
new_file_name:
        db "out.bin", 0 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T03:12:36.923

看起来像是[`int 21, 3D`](http://spike.scu.edu.au/~barry/interrupts.html#ah3d)“打开文件”。您的意思[`int 21, 3C`](http://spike.scu.edu.au/~barry/interrupts.html#ah3c)是“创建还是截断”？

如果您检查了返回值，您可能会看到`CF`=1 表示错误。我猜[`AX`](http://support.microsoft.com/kb/74463)会是... 2？

# ruby-on-rails - Ruby on Rails - 编辑/新建并显示在同一个部分

> ID：14270834
> 
> 赞同：3
> 
> 时间：2013-01-11T02:41:58.277
> 
> 标签：ruby-on-rails, model, partial-views, dry

我有一个相对简单的地址部分，用于“新”和“编辑”表单，以便在对象上需要地址时使用。它工作得很好。现在的问题是我希望相同的字段显示在我的“显示”视图中。唯一的问题是我的地址部分需要一个“显示”视图中不存在的表单。我会复制它，但是将一个部分用于新/编辑和另一个用于显示似乎不是很干燥。

我想知道是否有人解决了这个问题。我考虑过使用 .new 吗？和.persisted？但这并没有真正的帮助，因为用于编辑的对象会以与显示对象相同的方式传递这两个对象。

任何帮助是极大的赞赏。

**编辑**：这是我的新地址和编辑地址。我想在新的、编辑和显示视图中使用相同的部分，因为重新创建一个全新的部分似乎不是很干。我看到的问题是这个部分需要一个表单：f，这当然在“显示”视图中不可用。

```
<p>
  <%= f.label :address_line_1, 'Address 1' %><br />
  <%= f.text_field :address_line_1 %>
</p>

<p>
  <%= f.label :address_line_2, 'Address 2' %><br />
  <%= f.text_field :address_line_2 %>
</p>

<p>
  <%= f.label :city %><br />
  <%= f.text_field :city %>
</p>
<p class="address_state">
  <%= f.label :state , "State" %><br />
  <%= f.select :state, us_states, :include_blank => true  %>
</p>

<p>
<%= f.label :zip_code, 'Zip Code' %><br />
  <%= f.text_field :zip_code %>
</p> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-11T23:22:06.907

我也有同样的担忧，不仅想干掉新的/编辑，还想干掉节目。模型上有很多属性，在多个视图中并行维护它们变得很痛苦。

翻来覆去，找不到任何东西，除了这个（未解决的）帖子。还有@Valery，fields_for 不是真的用于编辑form_for 中的其他模型吗？

@FlexFiend，我最终以这种方式解决了你的问题（诚然，它很笨拙，但它完成了工作）：也为显示视图使用表单，并创建一个调用助手的部分（由所有操作共享）测试控制器动作，如果“可编辑”，则调用正确的控件类型。否则，如果它是一个显示动作，则只呈现该属性。

例如，起始模板（show、new、edit）简单地调用一个表单部分：

```
<%= render :partial => 'form'  %> 
```

...其中 _form 是通用的：

```
<%= form_for(@myObject) do |f| %>
  <div>
    <%= render :partial => "fields_for_all_actions", :locals => { :f => f  } %>
  </div
<% end %> 
```

...在部分内部，要显示或编辑“名称”属性，请使用帮助程序“render_field”：

```
<div><%= f.label :name %><span><%= render_field("@facility",f,"name", 30)%></span></div> 
```

在助手内部，render_field 看起来像这样：

```
def render_field(object_name, f, attribute, txt_size=20)
  if %w[new edit create update].include? controller.action_name
    f.text_field(attribute.to_sym, :size => txt_size)
  else
    eval(object_name + "." + attribute)
  end
end 
```

我为其他控件（文本区域、收音机、复选框等）创建了其他助手。这些助手不是特定于模型的，它们存在于 application_helper.rb 中并且可以被多个模型使用。

它有效，但我很想知道这个问题的其他解决方案，因为大型模型的维护挑战并非微不足道。当然，这可能是为了将模型重构为组件模型，但那是另一篇文章。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-05T10:54:00.897

`readonly`在您的字段中包含一个属性，例如：

```
<%= f.text_field :name, readonly: @readonly %> 
```

然后放入`@readonly = true`您的`show`方法中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T08:32:22.350

```
 <%= fields_for @object do |f| %>
   <%= render 'your/fields_parial', :f => f %>
 <% end %> 
```

# ruby-on-rails - Trying to keep slugs unique

> ID：14270837
> 
> 赞同：0
> 
> 时间：2013-01-11T02:42:02.510
> 
> 标签：ruby-on-rails, unique, slug

I posted a question similar to this before and it was suggested that I use friendlyIds gem however it was not for me as I had some real issues with it. Moving swiftly on...

I'm trying to create URL's where it points to **whatever.com/first_name-second_name** I've got that working **but** it does not account for when people sign up with the same name.

I found this code online and to me it seems pretty sound - my generate_slug method is within my user_controller but when ever I attempt to sign up to my app again I get the error;

**NoMethodError in UsersController#create undefined method `user' for #**

**Here's the generate_slug method;**

```
 def generate_slug
  if user(:slug => full_name.parameterize).count > 0
    n = 1
    while user(:slug => "#{full_name.parameterize}-#{n}").count > 0
      n += 1
    end
    self.slug= "#{full_name.parameterize}-#{n}"
  else
    self.slug = full_name.parameterize
  end
end 
```

**And heres the users#create;**

```
 def create 
    user = User.find_by_email(params[:sessions][:email])
    if user && user.authenticate(params[:sessions][:password])
      if params[:remember_me]
        cookies.permanent[:auth_token] = user.auth_token
      else
        cookies[:auth_token] = user.auth_token
      end
      redirect_to users_show_path(current_user), notice: "Logged in"
    else
      flash.now.alert = "Email or password is invalid."
      render "new"
    end
  end 
```

Can anyone see what's wrong with this? I've tried various things and hacking away at it but I'm very new to rails and not sure of what I'm doing wrong here.

Any help or pointers is much appreciated,

Thanks for your time!

**Edit**

**1 - Here is the full trace;**

```
activemodel (3.2.10) lib/active_model/attribute_methods.rb:407:in `method_missing'
activerecord (3.2.10) lib/active_record/attribute_methods.rb:149:in `method_missing'
app/models/user.rb:38:in `generate_slug'
activesupport (3.2.10) lib/active_support/callbacks.rb:418:in `_run__4251811508524484974__create__672836159521965693__callbacks'
activesupport (3.2.10) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.10) lib/active_support/callbacks.rb:385:in `_run_create_callbacks'
activesupport (3.2.10) lib/active_support/callbacks.rb:81:in `run_callbacks'
activerecord (3.2.10) lib/active_record/callbacks.rb:268:in `create'
activerecord (3.2.10) lib/active_record/persistence.rb:348:in `create_or_update'
activerecord (3.2.10) lib/active_record/callbacks.rb:264:in `block in create_or_update'
activesupport (3.2.10) lib/active_support/callbacks.rb:403:in `_run__4251811508524484974__save__672836159521965693__callbacks'
activesupport (3.2.10) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.10) lib/active_support/callbacks.rb:385:in `_run_save_callbacks'
activesupport (3.2.10) lib/active_support/callbacks.rb:81:in `run_callbacks'
activerecord (3.2.10) lib/active_record/callbacks.rb:264:in `create_or_update'
activerecord (3.2.10) lib/active_record/persistence.rb:84:in `save'
activerecord (3.2.10) lib/active_record/validations.rb:50:in `save'
activerecord (3.2.10) lib/active_record/attribute_methods/dirty.rb:22:in `save'
activerecord (3.2.10) lib/active_record/transactions.rb:259:in `block (2 levels) in save'
activerecord (3.2.10) lib/active_record/transactions.rb:313:in `block in with_transaction_returning_status'
activerecord (3.2.10) lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
activerecord (3.2.10) lib/active_record/transactions.rb:208:in `transaction'
activerecord (3.2.10) lib/active_record/transactions.rb:311:in `with_transaction_returning_status'
activerecord (3.2.10) lib/active_record/transactions.rb:259:in `block in save'
activerecord (3.2.10) lib/active_record/transactions.rb:270:in `rollback_active_record_state!'
activerecord (3.2.10) lib/active_record/transactions.rb:258:in `save'
app/controllers/users_controller.rb:10:in `create'
actionpack (3.2.10) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.10) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.10) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.10) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.2.10) lib/active_support/callbacks.rb:414:in `_run__1712494193629644471__process_action__997902979293854086__callbacks'
activesupport (3.2.10) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.10) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.10) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.10) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.10) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.10) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.10) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.10) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.10) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.10) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.10) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
activerecord (3.2.10) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.10) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.10) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.10) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.10) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.10) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.10) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.10) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.10) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.10) lib/action_dispatch/routing/route_set.rb:601:in `call'
actionpack (3.2.10) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.3) lib/rack/etag.rb:23:in `call'
rack (1.4.3) lib/rack/conditionalget.rb:35:in `call'
actionpack (3.2.10) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.10) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.10) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.3) lib/rack/session/abstract/id.rb:210:in `context'
rack (1.4.3) lib/rack/session/abstract/id.rb:205:in `call'
actionpack (3.2.10) lib/action_dispatch/middleware/cookies.rb:341:in `call'
activerecord (3.2.10) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.10) lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
actionpack (3.2.10) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.10) lib/active_support/callbacks.rb:405:in `_run__4266248573959168775__call__672836159521965693__callbacks'
activesupport (3.2.10) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.10) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.10) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.10) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.10) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.10) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.10) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.10) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.10) lib/rails/rack/logger.rb:32:in `call_app'
railties (3.2.10) lib/rails/rack/logger.rb:16:in `block in call'
activesupport (3.2.10) lib/active_support/tagged_logging.rb:22:in `tagged'
railties (3.2.10) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.10) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.3) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.3) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.10) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.3) lib/rack/lock.rb:15:in `call'
actionpack (3.2.10) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.10) lib/rails/engine.rb:479:in `call'
railties (3.2.10) lib/rails/application.rb:223:in `call'
rack (1.4.3) lib/rack/content_length.rb:14:in `call'
railties (3.2.10) lib/rails/rack/log_tailer.rb:17:in `call'
rack (1.4.3) lib/rack/handler/webrick.rb:59:in `service'
/usr/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
/usr/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
/usr/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

**2 -** The generate_slug is being created in a before_create in the user model

**3 -** I was having some issues with that as well - it seems to be very temperamental - As you said I tried to change to user but that didn't work - however current_user doesn't work any more - I'll look into that just now

**4 -** No I'm not using an authentication gem - I'm just using this to try and learn some rails and the theory behind it so I'm trying to stay clear of gems :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T12:58:46.907

`user_id`添加到slug中不是很容易吗？

```
def generate_slug
  "#{id}-#{full_name.parameterize}"
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T03:42:55.260

我们需要更多背景知识。

1.  错误不完整。请向我们提供完整的跟踪。
2.  从哪里`generate_slug`调用？在一个`before_create`模型用户？
3.  您正在调用`current_user`on`redirect_to`方法`create`。为什么不是`user`您之前定义的变量？
4.  您是否使用了身份验证 gem，例如 Devise 或 Clearance？

# mysql - 使用 auto_increment 时，如何获取新行的 id？

> ID：14270842
> 
> 赞同：0
> 
> 时间：2013-01-11T02:43:31.983
> 
> 标签：mysql

我的数据库有，

```
mysql> describe students;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| id    | int(11)     | NO   | PRI | NULL    | auto_increment |
| name  | varchar(50) | YES  |     | NULL    |                |
+-------+-------------+------+-----+---------+----------------+ 
```

我想插入 2 个学生 - 但我想立即知道他们的 ID

```
mysql> insert into students values (null, 'tom'), (null, 'larry'); 
```

如果插入实际上返回了 ID 的结果集，我会喜欢它......又名......

```
mysql> select id from (insert into students values (null, 'tom'), (null, 'larry')); 
```

嗯？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T02:46:25.200

您可以使用该`LAST_INSERT_ID()`函数获取`AUTO INCREMENT`批次的第一个值，然后`MAX`获取最大值。

> `LAST_INSERT_ID()`（不带参数）返回一个`BIGINT`（64 位）值，表示`AUTO_INCREMENT`由最近执行的`INSERT`语句为列设置的第一个自动生成的值，以影响这样的列。

[参考](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_last-insert-id)

```
> INSERT INTO students VALUES (NULL, 'tom'), (NULL, 'larry');

> SELECT LAST_INSERT_ID() FROM students LIMI 1 
```

```
| LAST_INSERT_ID() |
--------------------
| 1 |
```

```
> SELECT MAX(id) FROM students 
```

```
| 最大(ID) |
------------
| 2 |
```

```
> INSERT INTO students VALUES (NULL, 'billy'), (NULL, 'jane'), (NULL, 'fred');

> SELECT LAST_INSERT_ID() FROM students LIMIT 1 
```

```
| LAST_INSERT_ID() |
--------------------
| 3 |
```

```
> SELECT MAX(id) FROM students 
```

```
| 最大(ID) |
------------
| 5 |
```

# c++ - How do I make this template argument variadic?

> ID：14270843
> 
> 赞同：2
> 
> 时间：2013-01-11T02:43:34.017
> 
> 标签：c++

Say I have a template declaration like this:

```
template <class A, class B, class C = A (&)(B)> 
```

How would I make it so that I could have a variable amount of objects of type `C`? Doing `class C ...c = x` won't work because variadic template arguments can't have default values. So this is what I've tried:

```
template <typename T>
struct helper;

template <typename F, typename B>
struct helper<F(B)> {
    typedef F (&type)(B);
};

template <class F, class B, typename helper<F(B)>::type ... C>
void f(C ...c) { // error

} 
```

But up to the last part I get error messages. I don't think I'm doing this right. What am I doing wrong here?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T03:38:33.730

我认为您可以使用以下方法。首先，一些类型特征的机制。这使您可以确定参数包中的类型是否是同质的（我想您希望所有函数都具有相同的签名）：

```
struct null_type { };

// Declare primary template
template<typename... Ts>
struct homogeneous_type;

// Base step
template<typename T>
struct homogeneous_type<T>
{
    using type = T;
    static const bool isHomogeneous = true;
};

// Induction step
template<typename T, typename... Ts>
struct homogeneous_type<T, Ts...>
{
    // The underlying type of the tail of the parameter pack
    using type_of_remaining_parameters = typename 
        homogeneous_type<Ts...>::type;

    // True if each parameter in the pack has the same type
    static const bool isHomogeneous = 
        is_same<T, type_of_remaining_parameters>::value;

    // If isHomogeneous is "false", the underlying type is a fictitious type
    using type = typename conditional<isHomogeneous, T, null_type>::type;
};

// Meta-function to determine if a parameter pack is homogeneous
template<typename... Ts>
struct is_homogeneous_pack
{
    static const bool value = homogeneous_type<Ts...>::isHomogeneous;
}; 
```

然后，使用更多类型特征来确定泛型函数的签名：

```
template<typename T>
struct signature;

template<typename A, typename B>
struct signature<A (&)(B)>
{
    using ret_type = A;
    using arg_type = B;
}; 
```

最后，这是定义可变参数函数模板的方式：

```
template <typename... F>
void foo(F&&... f)
{
    static_assert(is_homogeneous_pack<F...>::value, "Not homogeneous!");
    using fxn_type = typename homogeneous_type<F...>::type;

    // This was template parameter A in your original code
    using ret_type = typename signature<fxn_type>::ret_type;

    // This was template parameter B in your original code
    using arg_type = typename signature<fxn_type>::arg_type;

    // ...
} 
```

这是一个简短的测试：

```
int fxn1(double) { }
int fxn2(double) { }
int fxn3(string) { }

int main()
{
    foo(fxn1, fxn2); // OK
    foo(fxn1, fxn2, fxn3); // ERROR! not homogeneous signatures
    return 0;
} 
```

最后，如果您需要在拥有该参数包后做什么的灵感，您可以查看[我编写的一个小型库](https://stackoverflow.com/questions/14261183/how-to-make-generic-computations-over-heterogeneous-argument-packs-of-a-variadic)（取自此答案中使用的机器的哪一部分）。调用参数包中所有函数的简单方法`F... f`如下（感谢@MarkGlisse）：

```
initializer_list<int>{(f(forward<ArgType>(arg)), 0)...}; 
```

您可以轻松地将其包装在宏中（只需查看 Mark 对我发布的链接的回答）。

这是一个完整的、可编译的程序：

```
#include <iostream>
#include <type_traits>

using namespace std;

struct null_type { };

// Declare primary template
template<typename... Ts>
struct homogeneous_type;

// Base step
template<typename T>
struct homogeneous_type<T>
{
    using type = T;
    static const bool isHomogeneous = true;
};

// Induction step
template<typename T, typename... Ts>
struct homogeneous_type<T, Ts...>
{
    // The underlying type of the tail of the parameter pack
    using type_of_remaining_parameters = typename
        homogeneous_type<Ts...>::type;

    // True if each parameter in the pack has the same type
    static const bool isHomogeneous =
        is_same<T, type_of_remaining_parameters>::value;

    // If isHomogeneous is "false", the underlying type is a fictitious type
    using type = typename conditional<isHomogeneous, T, null_type>::type;
};

// Meta-function to determine if a parameter pack is homogeneous
template<typename... Ts>
struct is_homogeneous_pack
{
    static const bool value = homogeneous_type<Ts...>::isHomogeneous;
};

template<typename T>
struct signature;

template<typename A, typename B>
struct signature<A (&)(B)>
{
    using ret_type = A;
    using arg_type = B;
};

template <typename F>
void foo(F&& f)
{
    cout << f(42) << endl;
}

template <typename... F>
void foo(typename homogeneous_type<F...>::type f, F&&... fs)
{
    static_assert(is_homogeneous_pack<F...>::value, "Not homogeneous!");
    using fxn_type = typename homogeneous_type<F...>::type;

    // This was template parameter A in your original code
    using ret_type = typename signature<fxn_type>::ret_type;

    // This was template parameter B in your original code
    using arg_type = typename signature<fxn_type>::arg_type;

    cout << f(42) << endl;
    foo(fs...);
}

int fxn1(double i) { return i + 1; }
int fxn2(double i) { return i * 2; }
int fxn3(double i) { return i / 2; }
int fxn4(string s) { return 0; }

int main()
{
    foo(fxn1, fxn2, fxn3); // OK

    // foo(fxn1, fxn2, fxn4); // ERROR! not homogeneous signatures

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T02:51:10.180

```
template <typename T>
struct helper;

template <typename F, typename B>
struct helper<F(B)> {
    typedef F (*type)(B);
};

template<class F, class B>
void f()
{
}

template <class F, class B, typename... C>
void f(typename helper<F(B)>::type x, C... c)
{
    std::cout << x(B(10)) << '\n';
    f<F,B>(c...);
}

int identity(int i) { return i; }
int half(int i) { return i/2; }
int square(int i) { return i * i; }
int cube(int i) { return i * i * i; }

int main()
{
    f<int,int>(identity,half,square,cube);
} 
```

这是一个可以推断类型的修改版本：

```
template<class F, class B>
void f(F(*x)(B))
{
    x(B());
}

template <class F, class B, typename... C>
void f(F(*x)(B), C... c)
{
    f(x);
    f<F,B>(c...);
}

int identity(int i) { return i; }
int half(int i) { return i/2; }
int square(int i) { return i * i; }
int cube(int i) { return i * i * i; }
int string_to_int(std::string) { return 42; }

int main()
{
    f(identity,half,square,cube);
    // f(identity,half,string_to_int);
} 
```

# c - 在 C 中的回调中传递参数

> ID：14270846
> 
> 赞同：0
> 
> 时间：2013-01-11T02:43:52.293
> 
> 标签：c

> **可能重复：**
> [C 中的函数指针如何工作？](https://stackoverflow.com/questions/840501/how-do-function-pointers-in-c-work)

[在stackoverflow](https://stackoverflow.com/questions/142789/what-is-a-callback-in-c-and-how-are-they-implemented)上冲浪我发现了这个例子：

```
/* Validation functions start */
void populate_array(int *array, size_t arraySize, int (*getNextValue)(void))
{
    for (size_t i=0; i<arraySize; i++)
        array[i] = getNextValue();
}

int getNextRandomValue(void)
{
    return rand();
}

int main(void)
{
    int myarray[10];
    populate_array(myarray, 10, getNextRandomValue);
    ...
} 
```

我想知道，想象 getNextRandomValue 有一个参数 getNextRandomValue(int i)，我将如何包含它并使函数接受输入？

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T06:22:55.377

通常的做法是将指向“数据”的指针与函数一起传递。当函数被调用时，将该“数据”指针传递给函数并假设函数本身知道如何处理该数据。实际上，数据通常是指向结构的指针。所以代码看起来像这样：

```
struct func1_data {
    int a;
    int b;
};

struct func2_data {
    char x[10];
};

int function1(void *data) {
    struct func1_data *my_data = (typeof(my_data)) data;
    /* do something with my_data->a and my_data->b */
    return result;
}

int function2(void *data) {
    struct func2_data *my_data = (typeof(my_data)) data;
    /* do something with my_data->x */
    return result;
} 
```

并假设我们有

```
int caller(int (*callback), void *data) {
    return callback(data);
} 
```

然后你这样称呼这一切：

```
struct func1_data data1 = { 5, 7 };
struct func2_data data2 = { "hello!" };
caller(function1, (void *) &data1);
caller(function2, (void *) &data2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T05:59:09.230

那么你的代码应该是这样的......

```
void populate_array(int *array, size_t arraySize, int (*getNextValue)(unsigned int))
{
    unsigned int seedvalue = 100;

    for (size_t i=0; i<arraySize; i++)
        array[i] = getNextValue(seedvalue);
}

int getNextRandomValue(unsigned int seed)
{
    srand(seed);
    return rand();
}

int main(void)
{
    int myarray[10];
    populate_array(myarray, 10, getNextRandomValue);
    ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T02:45:58.833

熟悉函数指针语法可能是个好主意。您需要将参数更改为`int (*getNextValue)(int)`.

# java - 在android中加载和保存数据文件

> ID：14270852
> 
> 赞同：1
> 
> 时间：2013-01-11T02:44:27.417
> 
> 标签：java, android, file, load, save

我正在做一个简单的应用程序，它可以在 java 中加载和保存文件。我正在尝试将其移植到 Android 上，但无法让它查看文件。

我当前使用的文件路径是

```
private static final String SAVE_FILE_PATH = "data/save"; 
```

这是从文件加载数据的函数：

```
public void loadData() throws FileNotFoundException {
    File file = new File(SAVE_FILE_PATH);

    Scanner scanner;

    if (file.exists()) {

        scanner = new Scanner(new FileInputStream(file));
        try {
            while (scanner.hasNextLine()) {
                allPlayers.add(new Player(scanner.nextLine()));
            }
        } finally {
            scanner.close();
        }
    }
    else {
        System.out.println("No file found");
    }

        } finally {
            scanner.close();
        }
    }

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T03:32:10.937

在`getExternalStorageDirectory()`为您提供 SD 卡的路径时，请考虑使用`Activity.getExternalFilesDir()`which 将返回（并在必​​要时创建）一个名义上对您的应用程序私有的目录。它还有一个优点是，如果应用程序被卸载，它将为您自动删除。这是 API 8 中的新功能，因此如果您支持旧设备，您可能不想使用它。

否则，您将不得不听从 ρяσѕρєя K 的建议。不要忘记创建您要使用的存储目录。我的代码通常如下所示：

```
/**
 * Utility: Return the storage directory.  Create it if necessary.
 */
public static File dataDir()
{
    File sdcard = Environment.getExternalStorageDirectory();
    if( sdcard == null || !sdcard.isDirectory() ) {
        // TODO: warning popup
        Log.w(TAG, "Storage card not found " + sdcard);
        return null;
    }
    File datadir = new File(sdcard, "MyApplication");
    if( !confirmDir(datadir) ) {
        // TODO: warning popup
        Log.w(TAG, "Unable to create " + datadir);
        return null;
    }
    return datadir;
}

/**
 * Create dir if necessary, return true on success
 */
public static final boolean confirmDir(File dir) {
    if( dir.isDirectory() ) return true;
    if( dir.exists() ) return false;
    return dir.mkdirs();
} 
```

现在使用它来指定您的保存文件：

```
File file = new File(dataDir(), "save");

Scanner scanner;

if (file.exists()) {
  // etc.
} 
```

# selenium - 是否可以从特定光标位置键入文本？

> ID：14270853
> 
> 赞同：1
> 
> 时间：2013-01-11T02:44:27.383
> 
> 标签：selenium, selenium-webdriver, robotframework

给定 -> Selenium 版本 1 和表单字段类型 -> 文本框。

我想做的是这个-> 输入字符串 M1，然后发送回车，然后在文本框区域输入字符串 M2。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-08-28T09:57:08.407

如果`driver`是您的 Web 驱动程序实例，这里是 python 中的代码的样子，`switch_to.active_element`是您需要为`send_key`光标下的元素输入的内容（假设您熟悉通过选择器或 xpath 或 id 查找的更常见方法，并且然后`send_to`用于那个）

```
active_ele = driver.switch_to.active_element
active_ele.send_keys("bla bla message") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T02:53:55.667

在 Selenium 中有一个来自 Actions(driver).SendKeys 的调用，您可以在其中发送密钥而无需指定元素。使用它来 SendKeys 到您的 Textbox 元素，然后单独调用以发送 Selenium.Enter 字符。

例如。在 C# 中，_myDriver 是您的 WebDriver。

```
(new Actions(_myDriver)).SendKeys(OpenQA.Selenium.Keys.Enter).Perform(); 
```

或者，如果您在 Windows 机器上，您可以使用[Windows 发送键](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.aspx)然后发送 Enter 击键。

# c# - 确定数组中是否存在一次 int 值

> ID：14270854
> 
> 赞同：3
> 
> 时间：2013-01-11T02:44:43.497
> 
> 标签：c#, linq

我知道您可以将 Any、Exists 和 Single 与 LINQ 一起使用，但不能完全使其正常工作。我需要根据 id 进行查找以查看它是否在数组中，并确保该值只有一个匹配项。因为如果有 2 个它会导致问题..我要检查的要求是该数组只有一个且只有一个数组中的每个 ID。

这是我尝试过的

```
if(someIntArray.Single(item => item = 3)
    //... we found the value 8 in the array only once so now we can be confident and do something 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T03:07:48.240

以下是我将如何解决这个问题：

```
if (someIntArray.Count(item => item == 3) == 1)
{
    //only one '3' found in the array
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T03:05:10.543

我觉得你想多了。

```
var targetNumber = 3;
var hasExactlyOne = someIntArray.Count(i => i == targetNumber) == 1; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T04:10:43.833

我为这种情况创建了一个 One() 扩展方法集：

```
public static bool One<T>(this IEnumerable<T> sequence)
{
   var enumerator = sequence.GetEnumerator();
   return enumerator.MoveNext() && !enumerator.MoveNext();
}

public static bool One<T>(this IEnumerable<T> sequence, Func<T, bool> predicate)
{
   return sequence.Where(predicate).One();
}

//usage
if (someIntArray.One(item => item == 3)) ... 
```

Single() 的问题在于，如果不完全是一个元素，它会引发异常。您可以将它包装在一个 try-catch 中，但在大多数情况下，它们比 Count() 更清洁，更有效，因为有多个匹配元素。不幸的是，没有办法绕过检查整个数组来验证是否没有元素或只有一个与谓词匹配，但如果有两个或更多，这至少会“快速失败”，其中 Count() 总是评估整个 Enumerable 是否有一个匹配元素或五十个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T02:56:03.990

使用 LINQ 表达式：

```
var duplicates = from i in new int[] { 2,3,4,4,5,5 }
                 group i by i into g
                 where g.Count() > 1
                 select g.Key 
```

结果：

```
{4,5} 
```

当然，您可以检查`duplicates.Count() > 0`或记录有问题的问题或您需要做的任何事情。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-01-11T03:11:17.053

让它工作：

```
if(someIntArray.Single(item => item = 3) > 0) 
```

多哈

# objective-c - 对类型比超类中定义的更具体的属性的语义警告

> ID：14270858
> 
> 赞同：1
> 
> 时间：2013-01-11T02:45:30.670
> 
> 标签：objective-c

我对 Objective-C 还很陌生，这是我在 StackOverflow 上的第一个问题。如果我遗漏了一些明显的东西，请提前原谅我。

我收到编译器警告

```
"Semantic Issue: Property type 'B *' is incompatible with type 'A *' inherited from 'X'" 
```

代码仍然可以按预期编译和工作。我想知道我是否应该做一些不同的事情来删除编译器警告。

我有四个类定义如下：

* * *

```
//
// *** In class header file A.h

#import "X.h"

@interface A
@property X *variable1;
@end 
```

* * *

```
//
// *** In class B header file B.h

#import "Y.h"

@interface B : A          // B is a subclass of A
@property Y *variable1;   // More specific type for property defined in superclass
@end 
```

* * *

```
//
// *** In class X header file X.h

@class A;                  // Forward declaration to avoid circular imports

@interface X
@property A *variable2;
@end 
```

* * *

```
//
// *** In class Y header file Y.h

@class B;                  // Forward declaration to avoid circular imports

@interface Y : X           // Y is a subclass of X
@property B *variable2;    // More specific type <-- I'm getting the compiler warning here
@end 
```

* * *

我在 Y 类中 variable2 的属性声明中收到编译器警告。我已将此属性定义为类型 B，它是 A 的子类。此属性在超类中定义为类型 A。

如果我在类 Y 的标头而不是前向声明中 #import "Bh"，编译器会看到 B 是 A 的子类并且警告消失。但是，我进入了#import 循环，因为 B 类的头文件也 #imports "Yh"。因此，我放入了前向声明以使代码编译，但我现在收到此编译器警告。

尽管有警告，代码仍然按我的预期工作。我想知道是否有适当的方法可以做到这一点，这样我就不会收到警告。非常感谢任何帮助或见解。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T03:13:20.090

Since Objective-C is duck-typed, this isn't as serious an issue as it would be in another language, but, basically, if someone creates an object of your B subclass and passes it to code that expects the A superclass, that code might set the property with an X instead of a Y. This would leave the wrong class of object in the property, and subsequent uses of the object, expecting a Y, might malfunction when they fetch an X instead.

# ruby-on-rails - 如何防止 Firefox 以安全模式启动？

> ID：14270859
> 
> 赞同：1
> 
> 时间：2013-01-11T02:45:32.633
> 
> 标签：ruby-on-rails, firefox, selenium

使用 Selenium 运行 Rails 测试套件通常会打开 Firefox 并显示“以安全模式启动？” 对话。有没有办法 1) 禁用此功能，或 2) 添加一个脚本，如果出现对话框，将回答“否”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T08:00:54.250

对于**1) 禁用此功能：**

您可以创建自己的自定义配置文件。

对于**2）添加脚本来回答“否”**

使用**Autoit**编写一个脚本来回答 NO 并在你的 selenium 程序中使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T04:17:14.097

它似乎与一些开放的 Firefox 问题有关。请看这里：

[禁用/更改 Firefox 安全模式热键 (Shift)](https://stackoverflow.com/questions/10111026/disable-change-firefox-safe-mode-hotkey-shift)

如果您正在寻找 selenium 和 Firefox 的替代品，我已经使用 PhantomJS（无头 WebKit 浏览器）和 poltergeist gem 取得了成功。

# javascript - casperjs：如何单击远程 div 然后更新它的类名？

> ID：14270861
> 
> 赞同：0
> 
> 时间：2013-01-11T02:46:10.547
> 
> 标签：javascript, phantomjs, casperjs

作为学习[CasperJS](http://casperjs.org/)的一种方式，我试图在远程页面上的 div 上发起点击事件，然后在点击后更改 div 的类名。这个想法是找到第一个可点击的 div，点击它，然后将其标记为已点击，这样我就可以跳过它到其他可点击的 div。远程页面上 div 标记的标记如下所示：

```
<div class='clickable_div'></div> 
```

我尝试了以下 casperjs 代码：

```
...
casper.then(function() {
    if( this.exists( 'div.clickable_div' ) ) {
        this.evaluate(function() {
            this.click(document.querySelector('div.clickable_div'));
            return document.querySelector('div.clickable_div').setAttribute("className","clicked");
        });
    }
});
... 
```

它似乎不起作用。首先，我认为我没有正确启动 div 上的鼠标单击事件。我错过了什么？其次，当我获取更新后的 html 时，我看不到 div 的类名有任何变化。我是否以错误的方式进行这一步？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-12T09:36:34.183

您正在调用`this.click`within `evaluate()`，它只是无法`evaluate()`在可能没有`window.click`方法的页面 DOM 上下文中执行代码。

这是一个可能有效的脚本：

```
var linkSelector = 'div.clickable_div';

casper.then(function() {
    if (!this.exists(linkSelector)) return;
    this.click(linkSelector);
    this.evaluate(function(linkSelector) {
        __utils__.findOne(linkSelector).setAttribute("className", "clicked");
    }, linkSelector);
}); 
```

您可能希望更好地处理错误和边缘情况，但您明白了。

# php - 如果表单已经提交，如何预加载 html 表单？

> ID：14270862
> 
> 赞同：0
> 
> 时间：2013-01-11T02:46:13.767
> 
> 标签：php, javascript, html

我有一个搜索网站。我希望我主页上的搜索栏表单在结果页面上可见。

有哪些解决方案可用于预加载表单的所有各种元素？有 3 个文本字段、2 个单选按钮和两个复选框。

目前，我不得不用一个 php 函数来中断每个元素，该函数将查看 $_GET['valueName'] 是否等于当前元素选项，但这似乎太复杂和难看，无法成为标准。

并行示例：

```
<select name="section">
<option value="free" selected="<? if($_GET['section'] == 'free'){echo 'selected';} ?>">Free</option>
<option value="under100" selected="<? if($_GET['section'] == 'under100'){echo 'selected';} ?>">Under $100</option>
<option value="under200" selected="<? if($_GET['section'] == 'under200'){echo 'selected';} ?>">Under $200</option>
<option value="any" selected="<? if($_GET['section'] == 'any'){echo 'selected';} ?>">Any price</option>
    </select> 
```

我还没有运行它来知道它甚至可以工作，但是没有填充表单的客户端方式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:59:28.030

就像是：

```
<input type="text" name="search" value="<?php if(isset($_POST['your_var']){ echo htmlspecialchars($_POST['your_var']);}?>"> 
```

然后对于复选框/收音机，我相信你会做一个循环，但我不记得我的头顶了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:54:14.357

如果您希望将表单中的变量传递到另一个页面并显示在该页面上，您可以执行以下操作：

```
<form action="new_page.php" method="POST">
<input type="text" name="search_phrase">
</form> 
```

然后在您的 new_page 上，您可以加载它们并显示它们：

```
<?php
if(isset($_POST['search_phrase'])){ echo $_POST['search_phrase']; }
?> 
```

这可能是将表单数据加载到新页面上的最简单方法；如果您不想使用框架、div 或 AJAX。我会给出更具体的答案，但您没有给出示例代码；但无论哪种方式，这种方法都应该可以正常工作。

如果您希望整个搜索栏本身包含在两个页面中，您可以将搜索栏放在不同的 php 文件中，然后将其导入：

```
include('my_search_bar.php'); 
```

如果您认为 $_GET 丑陋且干扰您可以使用 POST （它不会将变量像 link.php?var=abc...您可以在您的页面上制作它，以便在函数执行和显示变量之前所有这些都是必需的，从而使函数看起来更流畅。

# java - 如何在 TreeMultiSet 中使用自定义比较器？

> ID：14270863
> 
> 赞同：1
> 
> 时间：2013-01-11T02:46:17.923
> 
> 标签：java, guava, comparator

我想为`Comparator`a使用自定义`TreeMultiSet`。这就是我所做的：

```
public static class OccurenceComparator implements Comparator<Multiset.Entry<String>>{
    @Override
    public int compare(Multiset.Entry<String> e1, Multiset.Entry<String> e2) {
        return e2.getCount() - e1.getCount() ;
    }
}

public static void main(String args[]) throws Exception{
    Comparator<Multiset.Entry<String>> occurenceComparator = new OccurenceComparator();
    Multiset<String> treeMultiSet = TreeMultiset.create(occurenceComparator);
} 
```

这是我得到的：

> 未解决的编译问题：`create(Comparator<? super E>)`类型`TreeMultiset`中的方法不适用于参数 `(Comparator<Multiset.Entry<String>>)`

我很难过

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T02:52:00.220

您的 Multiset 是`Multiset<String>`，所以您的比较器不应该比较`String`s 吗？这看起来是编译器所期望的。

```
public static class OccurenceComparator implements Comparator<String>{ 
```

# java - Ajax 和 selenium 间歇性工作

> ID：14270870
> 
> 赞同：0
> 
> 时间：2013-01-11T02:47:10.080
> 
> 标签：java, ajax, xpath, selenium

我正在尝试使用来自[http://www.thoughtworks-studios.com/twist/2.3/help/how_do_i_handle_ajax_in_selenium2.html](http://www.thoughtworks-studios.com/twist/2.3/help/how_do_i_handle_ajax_in_selenium2.html)的以下代码：

```
 String xpathExpr = "//div[@id='contentPane']/div[@class='g-x-Aa  ud-Aa']/div[@class='Nj mu']/div[@class='ez vcard']/div[@class='l-Gy Vra']/div[@class='qga']/div[@class='g-Ua-z9']/div[@class='WAa']/div[@class='Yia']/div[@class='twa Vxa']/div[@class='zD us']/div[@class='hx a-f-e']"; 
    //String xpathExpr = "//div[@id='contentPane']/div[@class='g-x-Aa ud-Aa']";
    By by = By.xpath(xpathExpr);
    WebDriverWait wait = new WebDriverWait(driver, 20);
    WebElement elem1 = wait.until(visibilityOfElementLocated(by));
    System.out.println(Util.getInnerHtml(driver, elem1));

            public static String getInnerHtml(WebDriver driver, WebElement element) {
        return (String)((JavascriptExecutor)driver).executeScript("return      arguments[0].innerHTML;", element); 
    } 
```

测试一些ajax页面。奇怪的是它第一次起作用，但之后就再也不起作用了。除了 DOM 元素在 firefox 中加载并且清晰可见之外，程序卡在 innerhtml 部分，有时还有 wait.until 部分。

知道如何调试和解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T04:23:47.490

好的问题解决了。我认为 xpath 中 CSS 类名的问题。

# jquery - Jquery ajax URL 更改为 # 符号

> ID：14270873
> 
> 赞同：0
> 
> 时间：2013-01-11T02:47:18.083
> 
> 标签：jquery, ajax, jquery-mobile, login

一般来说，我是 JQuery 的新手。我正在使用 JQuery mobile 构建一个网站，但我被困在登录表单上。我只是想将用户名和密码发送到 PHP 文件。

当我输入用户名和密码时，它会将我定向到以下链接：

```
http://www.mydomain.com/mainfolder/#/mainfolder/?username=abc&password=123&myLat=&myLon= 
```

代替：

```
http://www.mydomain.com/mainfolder/php/login.php?username=abc&password=123&myLat=&myLon= 
```

我希望有人可以帮助我。很抱歉，这是我在这个网站上的第一篇文章，我在发布代码时遇到了困难 :)

提前致谢。

代码是：

```
<form id="loginForm">
    <div data-role="fieldcontain">
          <label for="username">username</label>
          <input type="text" name="username" id="username" value="" />
    </div>
    <div data-role="fieldcontain">
          <label for="password">password</label>
          <input type="password" name="password" id="password" value="" />
    </div>
    <input type="hidden" name="myLat" id="myLat" value="">
    <input type="hidden" name="myLon" id="myLon" value="">
    <input type="submit" id ="submit" data-role="button" data-inline="true" value="submit" />
</form>
<p><script type="text/javascript">document.write(new Date());</script></p>
<div id="error"></div>
</div>

<script>
    $(document).ready(function()
        {
            $("#loginForm").submit(function(e)
            { 
                // stop form from submitting normally
                e.preventDefault();
                // clear error html
                $("#error").html('');

                dataString = $("#loginForm").serialize();

                $.ajax(
                {
                    url: "/php/login.php",
                    type: "POST",
                    data: dataString,
                    success: function() 
                    {
                        alert("success");
                        $("#error").html('submitted successfully');
                    },
                    error:function()
                    {
                    alert("failure");
                        $("#error").html('there is error while submit');
                    } 
                });
        });
    });         
    </script> 
```

PHP代码：

```
<?php
    session_start();

    $username = $_post['username'];
    $password = $_post['password'];

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T03:05:24.457

你使用的是什么浏览器？尝试让您的代码标准投诉，然后再试一次。据我所知，基于 w3 规范的表单标签中需要“操作”字段。尽管这在您使用 ajax 时不会在这里发挥作用，但它可能会使浏览器感到困惑。因此，将您的表单开始标记更改为：

```
<form method="POST" action="/mainfolder/php/login.php" id="loginForm"> 
```

还将您的脚本声明更改为：

```
<script type="text/javascript"> 
```

看看是否有帮助。

编辑：刚刚确认操作字段是必需的。请参阅第 17.3 节 [http://www.w3.org/TR/html401/interact/forms.html](http://www.w3.org/TR/html401/interact/forms.html)

# algorithm - 斐波那契堆：插入、提取最小值和性能？

> ID：14270874
> 
> 赞同：1
> 
> 时间：2013-01-11T02:47:26.150
> 
> 标签：algorithm, data-structures, heap, dijkstra, fibonacci-heap

我试图了解斐波那契堆，在堆中插入元素的伪代码是：

```
Fibonacci-Heap-Insert(H,x)
degree[x] := 0
p[x] := NIL
child[x] := NIL
left[x] := x
right[x] := x
mark[x] := FALSE
concatenate the root list containing x with root list H
if min[H] = NIL or key[x]<key[min[H]]
      then min[H] := x
n[H]:= n[H]+1 
```

以下是我不明白的一些事情，

*   什么是`root list containing x`以及如何将它与包含 H 的根列表连接起来？

在提取 min 时，我们执行以下操作：

```
 Fibonacci-Heap-Extract-Min(H)
     z:= min[H]
     if x <> NIL
         then for each child x of z
            do add x to the root list of H
                p[x]:= NIL
            remove z from the root list of H
            if z = right[z]
                then min[H]:=NIL
            else
                  min[H]:=right[z]
                  CONSOLIDATE(H)
            n[H] := n[H]-1
     return z 
```

（这里是其他功能，合并和链接，[http://www.cse.yorku.ca/~aaw/Jason/FibonacciHeapAlgorithm.html](http://www.cse.yorku.ca/~aaw/Jason/FibonacciHeapAlgorithm.html)）

*   在前面的insert函数中，我们将x的child和p设置为nil，在提取min时，`if <> nil`总是为false，所以如果我们多次调用该函数，它永远不会给出准确的min。

*   如果这个结构被称为斐波那契“堆”，它在哪里维护堆属性？

*   如果我们在 Dijkstra 算法中使用二进制堆而不是斐波那契堆，所花费的时间会几乎与使用数组或链表一样慢吗？

谁能解释我遇到的困难？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T03:15:05.590

您在这里有很多问题，所以我会尽力回答所有问题。

对于您的第一个问题：斐波那契堆是作为一个树的集合实现的，所有这些树都以一个循环的双向链表链接在一起。当插入函数要求您将 x 与根列表 H 连接时，它要求您获取一个已创建的单例节点 (x) 并将其连接到所有现有树 H 的循环双向链表。

对于您关于 extract-min 的问题，您的伪代码中有错误。考试

```
x <> NIL 
```

应该

```
z <> NIL 
```

x 没有在函数中定义，所以这段代码不可能像写的那样工作。

至于如何维护堆属性：斐波那契堆中的每棵树都单独服从堆属性。调用 CONSOLIDATE 时，可以将多棵树重新合并为单独的树。这是维护堆属性的地方。当合并两棵树时，斐波那契堆总是取根值较大的树，并使其成为根值较小的树的根的子节点。这样，生成的树就服从堆属性。

最后，Dijkstra 和堆：具有基于堆的优先级队列的 Dijkstra 算法需要时间 O(m log n) 才能完成，而支持 Fibonacci-heap 的 Dijkstra 需要 O(m + n log n)，这对于稀疏图来说渐近更快. 然而，在实践中，斐波那契堆往往比二叉堆慢，因为隐藏在 big-O 项中的常数因子更高，这既是因为实现要复杂得多，也是因为它们的引用局部性更差。然而，Dijkstra 的二进制堆版本在理论上和实践上都比 Dijkstra 的链表或排序数组支持版本快得多。

希望这可以帮助！

# wpf - UserControl 中的 DependencyProperty 未绑定在 ListItem 模板中

> ID：14270876
> 
> 赞同：0
> 
> 时间：2013-01-11T02:47:36.907
> 
> 标签：wpf, xaml, data-binding, dependency-properties

好几个小时的谷歌搜索和 stakoverflow 阅读，我一直无法找到这个问题的答案。我有一个`UserControl`用于显示 a`ProgressBar`类型的`DependencyProperty`a `double`。

MainPage.XAML.cs 包含`DataContext`：

```
void MainPage_Loaded(object sender,RoutedEventArgs e)
{
        setDataContext();
        MainGameListBox.ItemsSource = vm.GameList;
} 
```

这是 MainPage.XAML 中的内容：

```
<ListBox Grid.Row="1" Grid.ColumnSpan="2" x:Name="MainGameListBox"
         SelectionChanged="listBoxGameSearch_SelectionChanged" >
    <!-- set its ItemsPanel to be a WrapPanel -->
    <ListBox.ItemsPanel>
        <ItemsPanelTemplate>
            <toolkit1:WrapPanel />
        </ItemsPanelTemplate>
    </ListBox.ItemsPanel>
    <ListBox.ItemTemplate>
        <DataTemplate>
            <StackPanel>
                <toolkit1:ContextMenuService.ContextMenu>
                    <toolkit1:ContextMenu>
                        <toolkit1:MenuItem Header="Pin to start" Click="PinGameToStart_Click" />
                    </toolkit1:ContextMenu>
                </toolkit1:ContextMenuService.ContextMenu>
                <Grid Width="173" Height="173"
                      Background="{StaticResource PhoneAccentBrush}" Margin="12">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="32"/>                                    
                        <RowDefinition Height="32"/>
                        <RowDefinition Height="32"/>
                        <RowDefinition Height="32"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="86.5"/>
                        <ColumnDefinition Width="86.5"/>    
                    </Grid.ColumnDefinitions>
                    <Border Grid.Row="0" Grid.RowSpan="3" Grid.Column="0" Width="64"
                            Height="64" BorderBrush="#70BC1F" BorderThickness="2"
                            Margin="6,6,0,0" VerticalAlignment="Top"
                            HorizontalAlignment="Left">
                        <Image  Source="{Binding GameTile,
                                Converter={StaticResource imageCacheConverter}}" />
                    </Border>
                    <view:CircularProgressChart x:Name="circularProgChart"
                                                Grid.Row="0" Grid.Column="1"
                                                Grid.RowSpan="3" Grid.ColumnSpan="2"
                                                Margin="6"
                                                Loaded="CircularProgressChart_Loaded"
                                                CompletionPercent="{Binding CompletionPercentage}" />
                </Grid>           
            </StackPanel>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

`CompletionPercent`是 DP，下面`UserControl`是：

```
public partial class CircularProgressChart:UserControl
{

    public double CompletionPercent
    {
        get { return (double)GetValue(CompletionPercentProperty); }
        set { SetValue(CompletionPercentProperty, value); }
    }

    public static readonly DependencyProperty CompletionPercentProperty = DependencyProperty.Register("CompletionPercent", typeof(double), typeof(CircularProgressChart), new PropertyMetadata(0.0, CompletionPercentChanged));

    public CircularProgressChart()
    {
        try
        {
            InitializeComponent();
            DataContext = this;
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
    }
} 
```

这是`CompletionPercentage`物业：

```
public class Progress : INotifyPropertyChanged
{ 
    private double _completionPercentage = 0.0;
    public double CompletionPercentage
    {
        get{return _completionPercentage;}
        set{
            _completionPercentage = value;
            NotifyPropertyChanged("CompletionPercentage");
        }
    }
    protected void NotifyPropertyChanged(string name)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(name));
        }
    }
} 
```

问题，为什么 `CompletionPercent="{Binding CompletionPercentage}"` 不被束缚？它获取默认值 0，但是当`CompletionPercentage`DP 更新时，DP 不会得到更新。我已经检查了该`NotifyPropertyChanged`方法，它可以正确触发并在代码的所有其他部分中工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T04:05:51.313

原因是构造函数中的`DataContext = this`行`CircularProgressChart`。`{Binding CompletionPercentage}`在 中查找`CompletionPercentage`属性`DataContext`，显然在 中不存在`CircularProgressChart`。类的实例`Progress`永远不会到达`CircularProgressChart`（依赖属性的显式分配优先于绑定）。

**解决方案1**（如果您真的想保留依赖属性）：删除该`DataContext = this;`行。如果您需要绑定到`CircularProgressChart`其 XAML 中的属性，请指定正确的绑定源，而不是依赖`DataContext`.

**解决方案 2**（从 派生时很常见`UserControl`）：完全删除`CompletionPercent`依赖属性（包括其绑定 in `MainPage.xaml`）并`CompletionPercentage`直接绑定到 in `CircularProgressChart.xaml`。同时删除`DataContext = this;`线。

**解决方案 3**（真正的 WPF 方式）：将默认`ProgressBar`控件与自定义模板一起使用，而不是创建自己的控件。

# iphone - 如何使用付费帐户 ID 将 iphone 应用程序分发到应用商店

> ID：14270877
> 
> 赞同：0
> 
> 时间：2013-01-11T02:47:37.933
> 
> 标签：iphone

嗨，亲爱的，我已经注册了苹果帐户 ID，您可以指导我如何将应用程序上传到应用商店的步骤吗？

如果可以向我建议在临时级别部署的链接吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:52:43.187

请参阅下面的第一个链接，它涵盖了基本步骤：

```
http://arstechnica.com/apple/2009/04/app-store-lessons-dealing-with-pink-uploads-of-doom/ 
```

另请参阅此链接：`http://developer.apple.com/library/ios/#documentation/ToolsLanguages/Conceptual/YourFirstAppStoreSubmission/AboutYourFirstAppStoreSubmission/AboutYourFirstAppStoreSubmission.html`

# opengl-es-2.0 - libGDX：如何判断着色器日志是指碎片还是垂直着色器错误

> ID：14270880
> 
> 赞同：1
> 
> 时间：2013-01-11T02:48:31.317
> 
> 标签：opengl-es-2.0, glsl, shader, libgdx

编译后`ShaderProgram`如果它不编译我打印日志。但是，我找不到方法来判断错误是在片段还是顶点着色器中。

这里我在片段着色器中放了一个错误：

```
0:1(1): error: syntax error, unexpected NEW_IDENTIFIER 
```

此错误在垂直着色器中：

```
0:1(1): error: syntax error, unexpected NEW_IDENTIFIER 
```

有没有办法显示有关错误位置的更多详细信息？

查看 Libgdx ShaderProgram 源，我似乎看不到一个：[http ://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/glutils/ShaderProgram.html](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/glutils/ShaderProgram.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-20T13:43:00.627

不理想，但是：您可以在两个着色器之一的开头添加一个空白行。然后查看错误的行号是否更改以确定它适用于哪一个。

# ios - 在 iOS 上异步配置 UITableViewCells

> ID：14270886
> 
> 赞同：0
> 
> 时间：2013-01-11T02:49:27.603
> 
> 标签：ios, uitableview

我注意到在几个 iOS 应用程序中，特别是 Facebook 的应用程序，开发人员通过首先显示一个空单元格然后异步配置单元格来提高其表格视图中的滚动性能。这意味着`tableView:cellForRowAtIndexPath:`快速执行允许视图平滑滚动。

我想知道模仿这种效果的最佳方法是什么，有人知道它是如何完成的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T03:17:27.633

如果你的数据获取速度很慢，你也可以使用类似 LazyLoad 的机制。您可以将所有数据设置为默认文本，例如 @"loading" ，并异步加载您的数据。当它回调时，您可以更改默认文本中的数据。或者您可以先将默认数据设置为 nil（如“Evernote”）

# c# - 字符串到日期时间格式

> ID：14270887
> 
> 赞同：0
> 
> 时间：2013-01-11T02:49:33.550
> 
> 标签：c#, sql-server

我正在尝试转换`10/10/2010 12:00:00 a.m.`为 dateTime 。我正在使用这个...

```
DateTime.ParseExact(item.Birthey, "dd/MM/yyyy hh:mm:ss tt", null); 
```

但我明白了`String was not recognized as a valid DateTime.`

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:53:24.123

只需简单地尝试使用`Parse`or`ParseExact`操作字符串命令，例如：

```
string stringDate= "10/10/2010 12:00:00 P.M.";
var myDate = DateTime.Parse(stringDate.Replace(".", "")); 
```

如果您获得的原始数据以“am”结尾，您也可以尝试以下代码示例。只需替换该字符：

```
string stringDate= "10/10/2010 12:00:00 a.m.";
DateTime result = DateTime.ParseExact(stringDate.Replace(".", ""), 
                                 "dd/MM/yyyy hh:mm:ss tt", null); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T02:55:28.793

试试吧

```
 DateTime.ParseExact("10/10/2010 12:00:00 am", "dd/MM/yyyy hh:mm:ss tt", null).Dump(); 
```

在`.`制造`a.m.`问题。您可以使用 Replace 删除`.`（因为您的日期格式`.`只能出现在`a.m.`, 或`p.m.`

```
 DateTime.ParseExact("10/10/2010 12:00:00 a.m.".Replace(".",""), "dd/MM/yyyy hh:mm:ss tt", null).Dump(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T03:09:22.323

尝试指定`CultureInfo.InvariantCulture`而不是`null`. 在您的情况下，它使用`CultureInfo.CurrentCulture`.

# python - Scrapy 错误“没有名为 cmdline 的模块”

> ID：14270889
> 
> 赞同：4
> 
> 时间：2013-01-11T02:50:01.107
> 
> 标签：python, scrapy

我的 Mac 上的 Scrapy 有一些问题，我检查了许多网站以找到答案，但我没有找到任何好的答案。

这是我的错误：

```
Traceback (most recent call last):
   File "scrapy-ctl.py", line 6, in <module>
      from scrapy.command.cmdline import execute
ImportError: No module named cmdline 
```

我实际上有 Scrapy 0.16.3、Twisted 12.3.0、lxml 3.1beta1、libxml2 和 libxslt

感谢您的时间 ！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-11T08:25:57.090

花了一些时间来解决并涉及搜索[scrapy github 存储库](https://github.com/scrapy/scrapy)，但[cmdline](https://github.com/scrapy/scrapy/blob/d788ba8a44e0538188872977a8705c1209a09194/scrapy/cmdline.py)模块已经移动。而不是你当前的导入，试试这个：

```
from scrapy.cmdline import execute 
```

# java - 批量准备好的语句自动提交

> ID：14270890
> 
> 赞同：0
> 
> 时间：2013-01-11T02:50:07.440
> 
> 标签：java, jdbc, prepared-statement

我正在尝试通过`java.sql`准备好的语句批处理执行创建多个表（最多 20 个）。大多数表都是相互关联的。但是我心里有些疑惑。

1）设置连接自动提交是真还是假？2) BatchExecute 有什么特殊的模式吗？喜欢上下。我想父表创建查询必须先执行。3）如果发生错误，所有批次都回滚？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T09:05:56.503

实际上在这种情况下使用批处理执行没有多大意义。一次插入或更新数千行时，批处理执行可以为您提供（大）性能改进。您只需要在事务中包含所有语句：

1.  调用 Connection.setAutoCommit(false)
2.  使用 Statement.executeUpdate 执行您的创建表语句
3.  调用 Connection.commit()

您需要根据它们之间的外键自行订购 create-table 语句。正如 Mark 指出的那样，您使用的数据库可能会立即提交每个创建表并忽略该事务。并非所有数据库都支持表的事务创建。您将需要对此进行测试或进行更多研究。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T08:07:56.347

The behavior of batch execution with auto commit on is implementation defined, some drivers may not even support that. So if you want to use batch execution, set auto commit to false.

That said, some databases implicitly commit each DDL statement; this might interfere with correct working of batched execution. I would advise to take the safe route and not use batched execution for DDL, but to use a normal `Statement` and `execute(String)` for executing DDL.

# css - 如何覆盖特定孩子的 box-align css 属性？

> ID：14270891
> 
> 赞同：1
> 
> 时间：2013-01-11T02:50:12.447
> 
> 标签：css, flexbox

我有一个包含三个孩子的 flexbox 元素：

```
<div class="box">
    <div>un</div>
    <div>deux</div>
    <div>trois</div>
</div> 
```

我想将前两个孩子对齐到盒子的顶部，但是对于第三个孩子，我想将它垂直居中。我似乎无法让它工作。这是我尝试过的：

```
.box {
  width: 350px;
  height: 95px;
  border: 1px solid #555;
  font: 14px Arial;

  display: -webkit-box;
  -webkit-box-align: start;
}

.box > div {
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;

}

.box > div:nth-child(1){ background : #FCC; height: 20px;}
.box > div:nth-child(2){ background : #CFC; height: 25px;}
.box > div:nth-child(3){ background : #CCF; height: 15px; -webkit-box-align: center;} 
```

这是jsfiddle：

[http://jsfiddle.net/TDUd5/15/](http://jsfiddle.net/TDUd5/15/)

请问有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T03:08:12.840

我不确定是否可以更改一个弹性项目的对齐方式，因为这是由父项设置的，因此另一种方法是为每一列设置一个迷你包装器，从那里设置对齐方式：http: [//jsfiddle.net/TDUd5 /30/](http://jsfiddle.net/TDUd5/30/)

```
<div class="box">
  <div class="start"><div>un</div></div>
  <div class="start"><div>deux</div></div>
  <div class="center"><div>trois</div></div>
</div> 
```

CSS：

```
.box {
  width: 350px;
  height: 95px;
  border: 1px solid #555;
  font: 14px Arial;

  display: -webkit-box;
}

.box > div.start { -webkit-box-align: start; }
.box > div.center { -webkit-box-align: center; }

.box div {
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  display: -webkit-box;
}

/* our colors */ 
.box > div:nth-child(1) > div{ background : #FCC; height: 20px;}
.box > div:nth-child(2) > div{ background : #CFC; height: 25px;}
.box > div:nth-child(3) > div{ background : #CCF; height: 15px;} 
```

# java - Activator.getDefault() 给出 null & 激活器无效

> ID：14270892
> 
> 赞同：1
> 
> 时间：2013-01-11T02:50:15.733
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-rcp

我在eclipse中创建了一个简单的插件。当我在导出后运行应用程序时，我在日志文件中收到以下错误。

org.osgi.framework.BundleException : bundle org.xy 的激活器 用于 bundle org.xy 的激活器无效。

但在删除 Bundle-ActivationPolicy: lazy

[捆绑的激活器无效](https://stackoverflow.com/questions/1305307/the-activator-bundle-is-invalid)

导出后它工作正常现在的问题是 Activator.getDefault() 给出 null

# ios - iOS 中的 Plist NSPredicate

> ID：14270893
> 
> 赞同：0
> 
> 时间：2013-01-11T02:50:19.680
> 
> 标签：ios, objective-c, xcode, cocoa-touch, nspredicate

我有一个使用搜索显示控制器的 plist，其中包含一个带有一些数据成员的字典数组。

```
<root> (array)
  <"Item 0"> (dictionary)
    <"Name"></"Name" (String)
    <"Work"></"Work"> (String)
    <"Age"></"Work"> (Number)
  </"Item 0">
  <"Item 1">
    ....
  </"Item 1">
</root> 
```

我想使用 NSPredicate 过滤所有与搜索条件匹配的名称。例如，为所有名称搜索“an”将产生“Sandy”和“Alexander”。

到目前为止，我已经尝试过类似的事情：

```
NSPredicate *p = [NSPredicate predicateWithFormat:@"Name == %@",
                                filterText];
Results = [data filteredArrayUsingPredicate:p]; 
```

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T03:44:00.410

用于`CONTAINS`_`NSPredicate`

下面的代码给出`case sensitive search`

```
NSPredicate *p = [NSPredicate predicateWithFormat:@"Name CONTAINS %@",
                            filterText];
Results = [yourPlistDataArray filteredArrayUsingPredicate:p]; 
```

下面的代码给出`case insensitive search`

```
NSPredicate *p = [NSPredicate predicateWithFormat:@"ANY Name CONTAINS %@",
                            filterText];
Results = [yourPlistDataArray filteredArrayUsingPredicate:p]; 
```

**编辑：**[在这里](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Predicates/Articles/pCreating.html#//apple_ref/doc/uid/TP40001793-CJBDBHCB)参考更多

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T15:57:01.110

这可以向您展示 any 中非常通用的搜索类型`NSArray`。它目前已根据您的`NSDictionary`项目进行调整，但您可以在此处创建更复杂的条件来过滤它。

```
NSArray *originalArray = ...;

NSString *searchText = ...; // this is a parameter only, it can be set freely

NSArray *_filteredArray = [originalArray filteredArrayUsingPredicate:[NSPredicate predicateWithBlock:^BOOL(id evaluatedObject, NSDictionary *bindings) {
            NSDictionary *_dataRow = (NSDictionary *)evaluatedObject;
            return ([[[_dataRow valueForKey:@"Name"] lowercaseString] rangeOfString:[searchText lowercaseString]].location != NSNotFound);
        }]];

NSLog (@"%@", _filteredArray); 
```

# c# - 如何在 C# 中打印全尺寸图像

> ID：14270896
> 
> 赞同：4
> 
> 时间：2013-01-11T02:50:43.723
> 
> 标签：c#, printing

我正在尝试用 C# 打印图像。它是由 Adob​​e Acrobat 从 PDF 创建的完整 8.5x11 大小的 tiff。当我使用下面的代码用 C# 打印它时，它垂直打印正确，但水平打印不正确，它被推过大约半英寸。我将图像的原点设置为 0,0。我错过了什么吗？

```
private FileInfo _sourceFile;
    public void Print(FileInfo doc, string printer, int tray)
    {
        _sourceFile = doc;
        PrintDocument pd = new PrintDocument();
        pd.PrinterSettings.PrinterName = printer;
        pd.DocumentName = _sourceFile.FullName;
        using (Image img = Image.FromFile(_sourceFile.FullName)) {
            if (img.Width > img.Height) {
                pd.DefaultPageSettings.Landscape = true;
            }
        }
        pd.PrintPage += PrintPage;
        foreach (PaperSource ps in pd.PrinterSettings.PaperSources) {
            if (ps.RawKind == tray) {
                pd.DefaultPageSettings.PaperSource = ps;
            }
        }
        pd.Print();
    }

    private void PrintPage(object o, PrintPageEventArgs e)
    {
        using (System.Drawing.Image img = System.Drawing.Image.FromFile(_sourceFile.FullName)) {
            Point loc = new Point(0, 0);
            e.Graphics.DrawImage(img, loc);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T03:02:30.033

查看下面的代码以获得一个很好的示例此代码来自 [Print Image in C#下面的链接](http://social.msdn.microsoft.com/Forums/en-us/csharpgeneral/thread/431371d0-73a5-4d89-a335-0890c3f87135)

```
 private void PrintImage()
        {
            PrintDocument pd = new PrintDocument();

            pd.DefaultPageSettings.Margins = new Margins(0, 0, 0, 0);
            pd.OriginAtMargins = false;
            pd.DefaultPageSettings.Landscape = true;

            pd.PrintPage += new PrintPageEventHandler(pd_PrintPage);

            printPreviewDialog1.Document = pd;
            printPreviewDialog1.ShowDialog();

            //pd.Print();
        }

        void pd_PrintPage(object sender, PrintPageEventArgs e)
        {
            double cmToUnits = 100 / 2.54;
            e.Graphics.DrawImage(bmIm, 100, 1000, (float)(15 * cmToUnits), (float)(10 * cmToUnits));
        }

        private void button5_Click(object sender, EventArgs e)
        {
            PrintImage();
        } 
```

# javascript - 捕获/保存/导出应用了 CSS 滤镜效果的图像

> ID：14270897
> 
> 赞同：19
> 
> 时间：2013-01-11T02:50:51.650
> 
> 标签：javascript, jquery, css

我正在制作一个使用 CSS3 滤镜效果（饱和度、棕褐色、对比度等）的简单图片编辑器

制作图片编辑器是很容易的部分，但是是否可以保存或导出应用了过滤器的图像似乎非常困难..

我原本对[@niklasvh 的 html2canvas 寄予厚望](https://github.com/niklasvh/html2canvas)。不幸的是，它不能捕获大多数 CSS3 属性，更不用说滤镜效果了。

如果有人有解决方案或可悲的是，这是不可能的明确知识，将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-15T23:07:22.110

我知道，您不能将 CSS 应用于 HTML5 画布元素中的图形（因为它们不是 DOM 的一部分）。

不过，没关系！我们仍然可以相对容易地制作基本的滤镜效果，并用几行 JavaScript 将它们保存为图像。

我找到了一篇很好的文章，介绍了[在画布上应用类似棕褐色的效果并将其保存为图像](http://www.script-tutorials.com/html5-image-effects-sepia/)。我不会复制它，而是强调这篇文章的主要内容。

**修改画布图像：**

```
var canvas = document.getElementById('canvasElementId'),
    context = canvas.getContext('2d');

var imageData = context.getImageData(0, 0, canvas.width, canvas.height);

for (var i = 0; i < imageData.data.length; i+=4) {
    ...
} 
```

为了访问某些画布 API，您需要使用上述 JavaScript 在画布上激活 2d 上下文。MDN 有一些关于 API 的很棒的文档，您可以使用[context object](https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D#getImageData())，但这里要注意的重要部分是`getImageData()`调用。基本上，它将抓取您定义的区域中的所有像素值（在上面的例子中，我们抓取的是整个图像）。然后，有了这些数据，我们可以遍历所有像素并根据需要更改它们。在[sepia 文章中](http://www.script-tutorials.com/html5-image-effects-sepia/)，它显然做了一些有趣的调整，但您也可以根据需要进行灰度、模糊或任何其他更改，[Github 上有一个很棒的画布过滤器库](https://github.com/kig/canvasfilters)。

**如何保存画布图像：**

```
var canvas = document.getElementById('canvasElementId'),
    image = document.createElement("img");

image.src = canvas.toDataURL('image/jpeg');

document.body.appendChild(image); 
```

上面的脚本将选择您的画布（假设您已经完成了绘图）并创建了一个图像元素。他们使用它`toDataURL()`来生成一个 url，您可以使用它来在图像元素上设置源。在上面的示例中，图像元素被附加到文档正文中。[您可以在MDN 的画布页面](https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement#Example.3A_Getting_the_data-url_for_a_canvas)上查看更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-14T08:01:56.650

我得到了你的答案。我做了这个程序，终于成功了。

这些步骤是：
1\. 上传图片 (JPG/PNG)
2\. 转换为画布
3\. 使用 CSS 过滤器自定义。
4\. 使用 camanJS 渲染保存为图像。
5\. 完成。

您还可以通过将过滤器的值修改为默认值来重置效果值。

祝你好运！

# winforms - C#：组件无法在 Windows 窗体上显示

> ID：14270898
> 
> 赞同：0
> 
> 时间：2013-01-11T02:51:05.330
> 
> 标签：winforms, c#-4.0

我创建了一个空项目。之后，我添加了新项目是 Windows 窗体，并在设计视图中添加了一些组件，例如按钮或文本框。

在主文件中，我使用以下代码：

```
SimpleForm form = new SimpleForm(); // SimpleForm is my class
form.Show(); 
```

但是，当我运行时，C# 会生成一个表单，但我看不到文本框或按钮。我只看到放置这些组件的空白区域。如下图，白色区域是我的按钮，但我不知道为什么这个按钮不能显示。我认为可能有些问题，那些组件无法在表单上绘制。

![在此处输入图像描述](../Images/a947510aea1248f9b67863dea215c8b6.png)

请帮我解决这个错误。

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T03:01:48.310

如果“主文件”是指您的主要方法（入口点） - 请尝试使用以下代码：

```
Application.EnableVisualStyles();
Application.SetCompatibleTextRenderingDefault(false);
Application.Run(new SimpleForm()); 
```

如果不是，您真的需要发布更多代码以获得合理的答案。

# c++ - 将函数传递给函数并使用头文件时出错

> ID：14270908
> 
> 赞同：0
> 
> 时间：2013-01-11T02:53:03.493
> 
> 标签：c++, function, header, function-pointers, header-files

当我尝试使用头文件添加函数 RK4 时尝试运行以下代码时收到以下错误消息。

C:\Documents\C 代码\RK4\addRK4.h|7|错误：在 '(' 标记 | 之前应为 ')'

之后还有很多其他错误消息，但我认为它们并不重要。我不知道出了什么问题，尤其是当我在 main.cpp 中定义 RK4 的原型时，一切运行良好。相关代码如下。对此问题的任何帮助（或者如果您有任何其他建议，因为我对 c++ 很陌生）将不胜感激！

主文件

```
#include <iostream>
#include <fstream>
#include <Eigen/Dense>
#include "gnuplot.h"
#include "addfitzhough.h"
#include "addRK4.h"

using namespace std;
using namespace Eigen;

int main()
{

//int mydims = 2;

double u = 0;
double *Iion;
double h = .5;

double y1ans[800];
double y2ans[800];
double tans[800];

Vector2d ycurr;

Vector2d Ynot, yplus;

Ynot << .2,
        .1;

y1ans[0] = Ynot(0);
y2ans[0] = Ynot(1);
tans[0] = 0.0;

for(int i = 1;i<800;i++){
tans[i] = tans[i-1] + h;
ycurr << y1ans[i-1],
         y2ans[i-1];
yplus = RK4(fitzhough,tans[i],ycurr,h,u,Iion,2);
y1ans[i] = yplus(0);
y2ans[i] = yplus(1);
}

} 
```

添加RK4.h

```
#ifndef RK4
#define RK4

using namespace Eigen;

VectorXd RK4(VectorXd (*f) (double t, Vector2d Y, double u, double * Iion), double t, VectorXd z, double h, double u, double *Iion, int d);

#endif // RK4 
```

RK4.cpp

```
#include <Eigen/Dense>

using namespace std;
using namespace Eigen;

Vector2d RK4(Vector2d (*f)(double, Vector2d, double, double*), double t, VectorXd z, double h, double u, double *Iion, int d){

VectorXd Y1(d), Y2(d), Y3(d), Y4(d), Y1buf(d), Y2buf(d), Y3buf(d);

Y1 = z;
Y1buf = (*f)(t,Y1,u, Iion);
Y2 = z + 0.5*h*Y1buf;
Y2buf = (*f)(t+.5*h,Y2,u, Iion);
Y3 = z + 0.5*h*Y2buf;
Y3buf = (*f)(t+.5*h,Y3,u, Iion);
Y4 = z + h*Y3buf;

Vector2d yn = z + (h/6.0)*(Y1buf + 2.0*Y2buf + 2.0*Y3buf + (*f)(t+h,Y4,u, Iion));

return yn;
} 
```

菲州.cpp

```
#include <Eigen/Dense>

using namespace std;
using namespace Eigen;
Vector2d fitzhough(double t, Vector2d Y, double u, double * Iion){

Vector2d dy;

double v = Y(0);
double w = Y(1);

double a = .13;
double b = .013;
double c1 = .26;
double c2 = .1;
double d = 1.0;

dy(0) = c1*v*(v-a)*(1-v)-c2*w*v + u;
dy(1) = b*(v-d*w);

*Iion = dy(0)-u;

return dy;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T03:07:57.610

你有一个符号冲突。

您`#define`是符号`RK4`，然后您尝试使用该名称创建一个函数。因为您已将其定义为空宏，所以它将被替换为空。然后编译器将此视为您的函数声明：

```
VectorXd (VectorXd (*f) (double t, Vector2d Y, double u, double * Iion), double t, VectorXd z, double h, double u, double *Iion, int d); 
```

为您的头笼添加额外的字符是个好主意。就像是：

```
#ifndef RK4__H
#define RK4__H 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T03:07:14.240

~~[类型](http://liveworkspace.org/code/2bwS1P%240) `Vector2d`和似乎有问题`VectorXd`。~~

**编辑**：很好的赶上@Paddy。将其余答案留在这里，因为它仍然有效。

此外，您在中的**声明**与中`addRK4.h` **的定义不匹配**`RK4.cpp`。这将是您要修复的**下一个错误。**

# spring - Spring HTTP.DELETE 返回码 415 不支持的媒体类型

> ID：14270910
> 
> 赞同：1
> 
> 时间：2013-01-11T02:53:12.337
> 
> 标签：spring, hibernate, http

```
@ResponseBody
@RequestMapping(method = RequestMethod.DELETE)
public String deleteState(@RequestBody String message) {
        System.out.println("controller");
    int resp = stateService.delete(message);

    return resp == 1 ? "State deleted successfully : HTTP 200"
            : "delete operation failed : HTTP 400";

} 
```

当我发布 json 时`{ stateName: VA}`，它返回 415 错误，有人可以提出建议吗？

```
@Override
@Transactional
public int delete(Object message) {
    System.out.println("service");
    JSONObject jsonObj = null;
    try {
        jsonObj = new JSONObject((String) message);
        Parameters p = new Parameters();
        p.property = "state_name";
        p.value = (String) jsonObj.getString("stateName");
        System.out.println("service");
        return stateDAO.delete(p);
    } catch (Exception e) {
        return 0;
    }

} 
```

这就是我在服务中所做的......

**更新：这是我的弹簧配置：**

```
<context:annotation-config />
<!-- Scans the classpath of this application for @Components to deploy as 
    beans -->
<context:component-scan base-package="com.tutorial.jquery" />

<!-- Configures the @Controller programming model -->
<mvc:annotation-driven />

<bean id="messageSource"
    class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
    <property name="basename" value="classpath:messages" />
    <property name="defaultEncoding" value="UTF-8" />
</bean>

<bean id="propertyConfigurer"
    class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"
    p:location="/WEB-INF/spring/jdbc.properties" />

<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource"
    destroy-method="close" p:driverClassName="org.postgresql.Driver"
    p:url="jdbc:postgresql://localhost:5432/processdb" p:username="postgres"
    p:password="postgres" />

<bean id="sessionFactory"
    class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="configLocation">
        <value>classpath:hibernate.cfg.xml</value>
    </property>
    <property name="configurationClass">
        <value>org.hibernate.cfg.AnnotationConfiguration</value>
    </property>
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">org.hibernate.dialect.PostgreSQLDialect</prop>
            <prop key="hibernate.show_sql">true</prop>
        </props>
    </property>
</bean>

<tx:annotation-driven />

<bean id="transactionManager"
    class="org.springframework.orm.hibernate3.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory" />
</bean>

<!-- >bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver"> 
    <property name="viewClass" value="org.springframework.web.servlet.view.JstlView" 
    /> <property name="order" value="0" /> <property name="prefix"> <value>/WEB-INF/views/</value> 
    </property> <property name="suffix"> <value>.html</value> </property> </bean -->

<bean
    class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
    <property name="order" value="2" />
    <property name="mediaTypes">
        <map>
            <entry key="json" value="application/json" />

        </map>
    </property>

    <property name="defaultViews">
        <list>
            <!-- JSON View -->
            <bean
                class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
            </bean>

        </list>
    </property>

</bean>

<!-- If no extension matched, use JSP view -->
<bean id="htmlView"
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="order" value="1" />
    <property name="prefix">
        <value>/views/</value>
    </property>
    <property name="suffix">
        <value>.html</value>
    </property>
</bean> 
```

我更新了方法以使其正常工作：

```
 @ResponseBody
@RequestMapping(method = RequestMethod.DELETE)
public String deleteState(HttpServletRequest request,
        HttpServletResponse response) {
    Map<String, String[]> parameters = request.getParameterMap();
    //System.out.print("RequestParam: " + state_Name);
    int resp = stateService.delete(parameters.get("state_name")[0]);

    return resp == 1 ? "State deleted successfully : HTTP 200"
            : "delete operation failed : HTTP 400";
} 
```

这解决了问题谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T03:46:36.903

尝试这个，

改变

```
@RequestBody String message 
```

至

```
@RequestParam String stateName 
```

# ruby - $&、$'、$1 等在 Ruby 代码中是什么意思？

> ID：14270914
> 
> 赞同：1
> 
> 时间：2013-01-11T02:53:38.613
> 
> 标签：ruby, eventmachine

我对`$`变量在这部分 EventMachine 代码中的工作方式感到困惑（`strip_op`是一种`String#sub`方法）：

```
def receive_data(data)
      @buf = @buf ? @buf << data : data

      while (@buf && !@closing)
        case @parse_state
        when AWAITING_CONTROL_LINE
          case @buf
          when PUB_OP
            ctrace('PUB OP', strip_op($&)) if NATSD::Server.trace_flag?
            return connect_auth_timeout if @auth_pending
            @buf = $'
            @parse_state = AWAITING_MSG_PAYLOAD
            @msg_sub, @msg_reply, @msg_size = $1, $3, $4.to_i 
```

`$&`, `$'`,等的含义是什么`$1`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T02:59:58.823

那些包含最后一次正则表达式匹配的部分。`$&`：匹配的子字符串，`$'`：匹配后的子字符串，：匹配`$1`的第一个捕获的子字符串。

# javascript - 查找第一次出现的正则表达式字符集

> ID：14270916
> 
> 赞同：0
> 
> 时间：2013-01-11T02:53:56.463
> 
> 标签：javascript, regex, character

我在网上找到了许多正则表达式匹配第一次出现的字符串、某个字符、一个单词等的解决方案，但我还没有找到匹配第一次出现的一组字符的解决方案（或者在我的情况下，不匹配一组字符）。

例如，我有一个如下字符串（在 javascript 中）：

```
var testString = '~!@#$%^&*()_+|}{POIUYTREWQ":?><asdfghjklm,./;[]\=-0987654321`~!@#$%^&*()_+|}{POIUYTREWQ":?><asdfghjklm,./;[]\=-0987654321`~!@#$%^&*()_+|}{POIUYTREWQ":?><asdfghjklm,./;[]\=-0987654321`' 
```

如您所见，testString 中有很多很多很多奇怪的字符。

我提出了一个正则表达式匹配来向我展示哪些是违规字符，如下所示：

```
var regTest = /[^A-Za-z0-9.,?()@\[\]\-\/ ]/g;
var wrongChar = testString.match(regTest); 
```

现在，我的问题是，即使 wrongChar 很好地返回了一个不匹配字符的数组，它也会给我每次出现的字符，如下所示：

```
~,!,#,$,%,^,&,*,_,+,|,},{,",:,>,<,;,\,=,`,~,!,#,$,%,^,&,*,_,+,|,},{,",:,>,<,;,\,=,`,~,!,#,$,%,^,&,*,_,+,|,},{,",:,>,<,;,\,=,` 
```

有没有办法让我快速地只第一次出现每个不需要的字符（例如更改我的正则表达式），或者我是否必须创建 2 个数组来继续测试一个字符是否已经保存在 wrongChar（长方法）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T03:00:19.210

要仅出现一次，请将正则表达式设为非全局。

要仅获取每个字符一次，只需从`wrongChar`结果数组中删除重复项：

```
var singleChars = wrongChar.sort().reduce(function(res, x) {
    if (x != res[res.length-1])
         res.push(x);
    return res;
}, []); 
```

# excel - 为什么这个 CDATE 格式不能转为 mm/yyyy？

> ID：14270923
> 
> 赞同：4
> 
> 时间：2013-01-11T02:54:58.880
> 
> 标签：excel, vba

我想将字符串*“mm/dd/yy hh:mm AM/PM”*转换为日期*“mm/yyyy”*

为什么会输出以下代码`11-2-2015`？

```
Sub Test()

    Dim yourStringDate As String
    Dim yourDateVariable As Date

    yourStringDate = "11/2/15 12:00 AM"        
    yourDateVariable = Format(CDate(yourStringDate), "mm/yyyy")        
    MsgBox yourDateVariable

End Sub 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-11T03:15:29.760

怎么样

```
Dim yourStringDate As Date
yourStringDate = DateValue("11/2/15 12:00 AM")
MsgBox Format(yourStringDate, "mm/yyyy") 
```

或以您的原始格式

```
Dim yourStringDate As String
Dim yourDateVariable As Date
yourStringDate = "11/2/15 12:00 AM"
yourDateVariable = CDate(yourStringDate)
MsgBox Format(yourDateVariable, "mm/yyyy") 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-06-16T14:19:28.203

我认为小写 mm 表示分钟，尝试 MM 表示月份。

# gcc - 如何在一个 Makefile 中使用不同的编译器选项构建两个精灵？

> ID：14270925
> 
> 赞同：0
> 
> 时间：2013-01-11T02:55:20.327
> 
> 标签：gcc, makefile

假设我有一个像这样的 make 文件。我可以通过正常构建`make`并通过`make debug`. 但是如何编写一个目标，以便我可以在一个命令中同时获得正常构建和调试构建`make both`？

```
DST := /data/result
debug: CFLAGS += -DDEBUG -g
debug: DST = /some/dir
target: src1.c src2.c
    gcc -bla -bla -o target
    cp target $(DST)
debug: target 
```

我的最终解决方案如下：</p>

```
DST := /data/result
debug: CFLAGS += -DDEBUG -g
debug: DST = /some/dir
target: src1.c src2.c
    gcc -bla -bla -o target
    cp target $(DST)
debug: target

both:
    make debug && make clean && make all 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T09:47:01.140

```
both : target debug

target debug : src1.c src2.c
    gcc $(CFLAGS) -o $@ $^

debug : CFLAGS += -g 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T04:13:05.290

```
NORMAL := /data/result/target
DEBUG := /some/dir/target

$(NORMAL) $(DEBUG): src1.c src2.c
    gcc -bla -bla $(CFLAGS) $^ -o $@

debug: $(DEBUG)
$(DEBUG): CFLAGS += -DDEBUG -g

both: $(NORMAL) $(DEBUG) 
```

# saml - 关于使用公共 CA 证书保护 SAML 断言的有效性的争议

> ID：14270926
> 
> 赞同：1
> 
> 时间：2013-01-11T02:55:27.050
> 
> 标签：saml, pki, ca

这是问题：

使用 CA 证书保护 SAML 断言有什么好处吗？我了解在建立传输 SAML 断言的 SSL 连接时使用 CA 证书有什么好处，但是当 SP 接受 SAML 断言本身时发生的 PKI 握手的 CA 证书呢？我一方面争辩说，在 SAML 交换中，SP 无法通过信任链迭代到根 CA 证书，而另一方面，我有人说它可以。

如果您可以将我指向支持您的答案的权威来源，则可以加分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T10:51:51.617

如果我对您的理解正确，您想知道在签署 SAML 断言时使用 CA 的证书签名是否有任何意义。

在我看来，你不应该需要这个。当您建立初始信任并交换元数据时，您可以在元数据中包含实体的公钥。如果您可以相信元数据的交换是安全的，您只需根据元数据中的公钥验证签名即可。

我看不出 CA 将如何为这种情况赋予任何价值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T11:39:36.730

我也同意。尽管在[标准的 Shibboleth 元数据共享机制](https://wiki.shibboleth.net/confluence/display/SHIB2/Metadata#Metadata-RemoteBatchesofSignedMetadata)（联邦）中，整个发布的元数据块由联邦证书签名。因此，PKI 可能（并且可能）用于在安全合作伙伴之间分发服务和 IdP 元数据。但正如 Stefan 所写，用受信任的 CA 签署的证书签署断言是没有意义的

# ios - 确定iOS应用平台

> ID：14270928
> 
> 赞同：2
> 
> 时间：2013-01-11T02:55:35.187
> 
> 标签：ios, multiplatform

我有一个被交给测试的应用程序，而我——我们应该说——没有留下深刻的印象吗？

我相信为我的客户构建应用程序的公司并没有将其构建为 iOS 原生应用程序。我的直觉是他们利用了多目标平台之一，因为这是他们所习惯的。该应用程序的可用性特别差，而且它的行为方式不符合 iOS 应用程序应有的方式。

我如何判断这个应用程序是本机的还是构建在某些与操作系统无关的平台上的？有什么大的赠品可以告诉我吗？

FWIW，iPad 是该设备的唯一目标平台。它不需要在其他任何地方运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T05:44:22.517

虽然“某些与操作系统无关的平台”有点宽泛，但有一种简单的方法可以判断应用程序是否使用 PhoneGap 制作，可以说是最流行的与操作系统无关的平台之一。

1.  复制`.ipa`您已发送的文件（或在您的文件系统上找到并复制它）。

2.  重命名副本`WhatEverTheAppNameIs.zip`。

3.  提取压缩文件夹并打开它。

4.  打开名为“Payload”的文件夹（如果还没有的话）。

5.  右键单击`BlahBlah.app`并选择“显示包内容”。

6.  检查捆绑包。

`www`检查文件夹是否存在。如果它的内容相当大（与一般的包内容相比），那么整个应用程序很有可能是用 PhoneGap 制作的。

单击`index.html`文件`www`夹中的文件以查看有多少应用程序在桌面 Safari 中运行也很有启发性。

您还可以通过进一步检查捆绑包来发现与操作系统无关的平台的其他证据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T04:19:57.710

您是说它没有常规 iOS 应用程序的外观和感觉吗？有可能是用AIR、HTML5等开发的。不知道有没有很多方法可以不用越狱设备。

当然，您可以四处询问或张贴屏幕截图，看看其他人的想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T04:25:17.650

使用 DiskAid 之类的软件（该部分免费 - 无需越狱）从设备中取出二进制文件，然后研究它。您可以通过反汇编程序获得重要信息，例如支持 ARM 的 Hopper。

如果您看不懂汇编，请研究应用程序的资源。它也可能会给你一些提示。同样，像 DiskAid 这样的软件将允许这样做。

# c# - 如何使用 StructureMap 有条件地提供构造函数参数？

> ID：14270934
> 
> 赞同：1
> 
> 时间：2013-01-11T02:56:10.047
> 
> 标签：c#, .net, ioc-container, structuremap

我想根据父类型有条件地为 StructureMap 提供构造函数参数。我正在尝试使用下面的代码来实现这一点。

具体类型 ProcessorSettings 是 TypeOne 和 TypeTwo 的构造函数参数。ProcessorSettings 的构造函数采用一个名为“频率”的 int 参数。

当我尝试这个时，我得到一个 StructureMap 错误**StructureMap Exception Code: 202 No Default Instance defined for PluginFamily**。错误消息中没有更多信息。

```
x.ForConcreteType<ProcessorSettings>()
    .Configure.Ctor<int>("frequency")
    .Is(condition => condition.Conditional(y =>
    {
        y.If(t => t.ParentType == typeof(TypeOne))
            .ThenIt.Is.IsThis(intVal1);

        y.If(t => t.ParentType == typeof(TypeTwo))
            .ThenIt.Is.IsThis(intVal2);
    })); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T11:59:42.947

尝试使用命名实例而不是条件。如果您有很多变体，您可以创建一个[约定](http://www.theabsentmindedcoder.com/2010/05/structure-map-26-using-conventions.html)来减少重复。

```
x.For<ProcessorSettings>().Add<ProcessorSettings>().Ctor<int>("frequency")
    .Is(intVal1).Named("ProcessorSetting1");
x.For<ProcessorSettings>().Add<ProcessorSettings>().Ctor<int>("frequency")
    .Is(intVal2).Named("ProcessorSetting2");
x.For<IType>().Add<TypeOne>().Ctor<ProcessorSettings>()
    .Named("ProcessorSetting1");
x.For<IType>().Add<TypeTwo>().Ctor<ProcessorSettings>()
    .Named("ProcessorSetting2"); 
```

# qt - 在 PySide 中连接 QTableView 信号，参数错误？

> ID：14270936
> 
> 赞同：2
> 
> 时间：2013-01-11T02:56:14.300
> 
> 标签：qt, signals, pyside, slot

我有一个创建窗口和树视图的类。创建树视图的代码非常简单，在 **init**方法中：

```
 tableView = QTableView()
    tableView.setModel(model)
    tableView.clicked.connect(self.foo) 
```

其中 'foo' 是应该接受回调的函数（同一类的成员）的名称。该函数的签名如下：

```
def foo(something):
    print something 
```

据我所知（当然很少），“某事”参数应该是 QModelIndex 的一个实例，但事实并非如此。对变量执行 print(something) 表明我已将 foo(...) 发送到窗口类。我在这里想念什么？我认为这是正确的方法，基于：

[http://qt-project.org/wiki/Signals_and_Slots_in_PySide](http://qt-project.org/wiki/Signals_and_Slots_in_PySide)

有任何想法吗？
谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T16:47:15.870

方法的第一个参数是实例本身，它被隐式传递，通常命名为`self`. 在您的版本中，`something`成为实例，而不是传递的参数。您的方法应如下所示：

```
def foo(self, something):
    print something 
```

作为旁注，通常在将参数传递给不接受任何参数的方法时会出错。喜欢：

```
class Foo(object):
    def bar(something):
        print something

f = Foo()
f.bar(1)

#Traceback (most recent call last):
#  File "<stdin>", line 1, in <module>
#TypeError: bar() takes exactly 1 argument (2 given) 
```

但在 Qt 中，您可以将信号连接到接受较少参数的插槽。Qt 将调用没有该参数的插槽。因此，尽管`clicked`信号通过`QModelIndex`，您仍然可以将此信号连接到不接受参数的方法（例如您的`foo`）。结果，您将得到这个无声的“错误”。

# grammar - Chameleon：为什么重复的评论会被截断？

> ID：14270937
> 
> 赞同：0
> 
> 时间：2013-01-11T02:56:15.633
> 
> 标签：grammar, hl7

我在转换 HL7 消息时遇到问题。它有一个带有重复字符串类型字段的 NTE 段。

前任：

```
MSH|^~\&|HOST||TD-SYN||201207031000||ORU^R01|0017|P|2.3
PID|1||0001|
NTE|||Comment 1~Comment 2~Comment3 
```

图形转换后发生的情况是，NTE 只接受注释 1，其余重复的注释被忽略。

```
MSH|^~\&|HOST||TD-SYN||201207031000||ORU^R01|0017|P|2.3
PID|1||0001|
NTE|||Comment 1| 
```

我尝试将 NTE 段语法的“重复”字段设置为 10，但没有任何区别。此外，没有脚本在操纵 NTE 的那个字段，所以我不知道为什么它会以这种方式截断它。有人可以告诉我发生了什么事吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T07:44:45.160

很高兴你找到了。作为一般帮助，有时使用[HAPI TestPanel](http://hl7api.sourceforge.net/hapi-testpanel/)将其转换为 XML，然后您将很好地了解如何循环您的 HL7 元素。然后，您还知道您是否使用了正确的 HL7 结构。

在 NTE 中第三个元素的示例中`<NTE.3>`：

```
<?xml version="1.0" encoding="UTF-8"?>
<ORU_R01 xmlns="urn:hl7-org:v2xml">
    <MSH>
        <MSH.1>|</MSH.1>
        <MSH.2>^~\&amp;</MSH.2>
        <MSH.3>
            <HD.1>HOST</HD.1>
        </MSH.3>
        <MSH.5>
            <HD.1>TD-SYN</HD.1>
        </MSH.5>
        <MSH.7>
            <TS.1>201207031000</TS.1>
        </MSH.7>
        <MSH.9>
            <CM_MSG.1>ORU</CM_MSG.1>
            <CM_MSG.2>R01</CM_MSG.2>
        </MSH.9>
        <MSH.10>0017</MSH.10>
        <MSH.11>
            <PT.1>P</PT.1>
        </MSH.11>
        <MSH.12>2.3</MSH.12>
    </MSH>
    <ORU_R01.RESPONSE>
        <ORU_R01.PATIENT>
            <PID>
                <PID.1>1</PID.1>
                <PID.3>
                    <CX.1>0001</CX.1>
                </PID.3>
            </PID>
            <NTE>
                <NTE.3>Comment 1</NTE.3>
                <NTE.3>Comment 2</NTE.3>
                <NTE.3>Comment3</NTE.3>
            </NTE>
        </ORU_R01.PATIENT>
    </ORU_R01.RESPONSE>
</ORU_R01> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T05:55:06.087

我刚刚从它的文档中找到了答案。它实际上并没有被截断。“value”的默认值是可重复字段中的第一个元素。因此，
我所要做的就是通过 field.repeat_field(index).value 访问重复字段。:)

# php - PHP/MySQL：解析 html 并上传媒体

> ID：14270938
> 
> 赞同：-1
> 
> 时间：2013-01-11T02:56:17.623
> 
> 标签：php, html, mysql, parsing, upload

我有一个使用 PHP 4.3 和 MySQL 创建的网站。我需要一种方法，以便客户端可以将 HTML 文件发送到服务器并对其进行解析并将部分插入数据库。在解析过程中，找到的任何图像或其他媒体都需要上传到服务器。

我不太确定解决此问题的最佳方法是什么。我正在考虑使用 jQuery 和 Ajax 来解析内容，但我能做些什么来获取媒体？

您对如何实现这一点有更好的建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T03:58:19.577

这是一个相当大的问题。我已经向您指出了一些可能会有所帮助的资源。

对于 Html 解析 -> [http://simplehtmldom.sourceforge.net/](http://simplehtmldom.sourceforge.net/)

下载图像和其他媒体的简单方法 -> [http://au1.php.net/manual/en/function.file-get-contents.php](http://au1.php.net/manual/en/function.file-get-contents.php)

上传原始 html5 文件 -> [http://www.w3schools.com/php/php_file_upload.asp](http://www.w3schools.com/php/php_file_upload.asp)

祝你好运

# javascript - 如何用python获取webbrowser的源代码

> ID：14270939
> 
> 赞同：2
> 
> 时间：2013-01-11T02:56:34.150
> 
> 标签：javascript, python, browser

我正在用scrapy写一个蜘蛛，但是，我遇到了一些用js渲染的网站，因此urllib2.open_url不起作用。我发现我可以使用 webbrowser.open_new(url) 打开浏览器，但是，我没有找到如何使用 webbrowser 获取页面的 src 代码。有没有什么方法可以用 webbrowser 来做到这一点，或者有没有其他没有 webbrowser 的解决方案来处理 js 站点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T03:14:43.640

您可以将刮板与可用的 Webkit 引擎一起使用。

其中之一是干刮。

例子：

```
import dryscrape

search_term = 'dryscrape'

# set up a web scraping session
sess = dryscrape.Session(base_url = 'http://google.com')

# we don't need images
sess.set_attribute('auto_load_images', False)

# visit homepage and search for a term
sess.visit('/')
q = sess.at_xpath('//*[@name="q"]')
q.set(search_term)
q.form().submit()

# extract all links
for link in sess.xpath('//a[@href]'):
  print link['href']

# save a screenshot of the web page
sess.render('google.png')
print "Screenshot written to 'google.png'" 
```

查看更多信息：

[https://github.com/niklasb/dryscrape](https://github.com/niklasb/dryscrape)
[https://dryscrape.readthedocs.org/en/latest/index.html](https://dryscrape.readthedocs.org/en/latest/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T03:29:53.687

如果你需要一个完整的 js 引擎，可以通过多种方式从 Python 驱动 webkit。直到最近，这些事情都是用[Selenium](http://seleniumhq.org/ "硒")完成的。Selenium 驱动整个浏览器。

最近有更新和更简单的方法可以从 Python 运行 webkit 引擎（包括 v8 javascript 引擎）。看到这个问题： [Headless Browser for Python (Javascript support REQUIRED!)](https://stackoverflow.com/questions/6025082/headless-browser-for-python-javascript-support-required)

它引用这个博客作为一个例子[Scraping Javascript Webpages with Webkit](http://webscraping.com/blog/Scraping-JavaScript-webpages-with-webkit/)。它看起来或多或少只是你需要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-12T15:10:22.757

几天来，我正试图找到相同问题的答案。

我建议你尝试使用[WebKit的](http://en.wikipedia.org/wiki/Webkit)[QT 框架](http://en.wikipedia.org/wiki/Qt_%28framework%29)。有两个 python 绑定。一个是[PyQt](http://www.riverbankcomputing.com/software/pyqt/intro)，另一个是[PySide](http://qt-project.org/wiki/PySide)。如果你想创建更复杂的东西或者你想 100% 控制你的代码，你可以直接使用它们。

对于像在浏览器环境中执行 JavaScript 这样的琐碎事情，您可以使用[Ghost.py](https://github.com/jeanphix/Ghost.py)。从命令行使用它时，它有[一些文档和一些问题，但除此之外它就很棒。](http://jeanphix.me/Ghost.py/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T03:06:47.920

如果您需要处理 JavaScript，则需要实现 JavaScript 引擎。这使您的蜘蛛更加复杂。主要是因为 JavaScript 几乎总是根据时间或用户采取的操作来修改 DOM。这使得在爬虫中处理 JS 变得极具挑战性。如果你真的需要在你的蜘蛛中处理 JavaScript，你可以看看 Mozilla 的 JavaScript 引擎：[https ://developer.mozilla.org/en/docs/SpiderMonkey](https://developer.mozilla.org/en/docs/SpiderMonkey)

# c++ - 可以在 C++11 lambda 中隐式捕获参数包吗？

> ID：14270941
> 
> 赞同：26
> 
> 时间：2013-01-11T02:57:19.840
> 
> 标签：c++, c++11, lambda, language-lawyer, variadic-templates

有谁知道以下对“ts”的隐式捕获是否格式正确：

```
template<class ... Ts> void bar(Ts ... ts) { }

template<class ... Ts> int foo(Ts ... ts) {
    auto L = [=] () {
       bar(ts...);
    };
    L();
    return 0;
}
int g = foo(1, 2, 3); 
```

标准是否在任何地方明确说明这不应该形成良好的格式？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-11T03:17:47.997

14.5.3/6：

> 不是`sizeof...`表达式的包扩展的实例化生成列表 E1, E2, ..., EN ，其中 N 是包扩展参数中的元素数。每个 Ei 是通过实例化模式并用其第 i 个元素替换每个包扩展参数来生成的。所有的 Ei 都成为封闭列表中的元素。

无论您是否被允许显式捕获一个包（您可以，使用`[ts ...]`），扩展的一般规则将导致捕获列表中的每个元素。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-11T03:53:12.507

我想它的格式很好，我还没有找到一个直截了当的陈述（在某些情况下，措辞有时缺乏清晰/说明），但我想可能是这样推断的：

**§5.1.2/23：**

> 省略号*后*的捕获是包扩展 (14.5.3)。[ 例子：

```
 template<class... Args>
      void f(Args... args) {
        auto lm = [&, args...] { return g(args...); };
        lm();
      } 
```

> —结束示例]

*   *`args`在*lambda-capture*中，*后跟省略号*的捕获是捕获的一个示例（在这种情况下是显式的），值得注意的事实是它`args`是一个参数包*标识符*。这个简短的段落的唯一作用是描述*lambda-captures*如何保持包扩展，这表明参数包可以被捕获，即使它的目的不是*让*它们**被捕获**。*

 ***§5.1.2/12：**

> 如果**实体被****显式**或**隐式**捕获，则该实体被捕获。 [...]

**§3/3：**

> **实体是**值、对象、引用、函数、枚举器、类型、类成员、模板、模板特化、命名空间、**参数包**或 this。

由此我假设*参数包是可以显式或隐式捕获的实体，*因此，应适用与普通变量相同的捕获规则，但参数包应相应扩展。

我想您的问题（以及相同的论点）可以同样适用于参考变量，例如（[未指定参考是否需要存储。§8.3.2/4](http://preney.ca/paul/archives/1051)）。当您被允许或不允许在 lambda中引用参数包*标识符时，您似乎很感兴趣。*

您可以对外部范围内的引用变量进行相同的思考，因为您可能可以访问它们，但甚至不能被允许访问原始变量的标识符。

它们与参数包一样空灵。*

# msbuild - 在 MSbuild 构建期间获取项目版本信息

> ID：14270942
> 
> 赞同：1
> 
> 时间：2013-01-11T02:57:24.327
> 
> 标签：msbuild, continuous-integration, version

我正在尝试通过 MSBuild 自动构建我们的安装程序。我遇到的问题是获取调用自定义 MSBuild 脚本的 C# 项目的版本信息，然后在构建过程中将版本号传递给 Wix。

我想做的是将版本设置为这样的一些属性：

```
<ProductVersion>$(MajorVersion).$(MinorVersion).$(PatchVersion).$(BuildVersion)</ProductVersion>
<InstallerName>"$(ProductName)-$(ProductVersion).msi"</InstallerName> 
```

该版本作为我们持续集成构建的一部分进行更新，并将版本号合并到构建在我们的持续集成服务器上的每个安装程序中，这有助于我们生成可持续部署的应用程序。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T23:51:31.253

我解决这个问题的方法是在我的代码库中创建一个“version.xml”文件。该文件包含以下数据

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="3.5"
         DefaultTargets="Build"
         xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <VersionMajor>0</VersionMajor>
        <VersionMinor>1</VersionMinor>
        <VersionBuild>1</VersionBuild>
        <VersionRevision>0</VersionRevision>
    </PropertyGroup>
</Project> 
```

在我的情况下，此文件已签入，但使用来自构建服务器的信息或任何所需的信息生成此文件应该不会太难。

在构建期间，自定义 MsBuild 任务（类似于[TemplateFile 任务](https://github.com/loresoft/msbuildtasks)）从各自的模板文件创建程序集信息文件和 Wix 包含文件。可以通过将“version.xml”文件包含在 MsBuild 脚本中来访问它。例如像这样：

```
<?xml version="1.0" encoding="utf-8"?>
<Project 
    ToolsVersion="4.0" 
    DefaultTargets="Build" 
    xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

    <!-- Include the version info file so that we can pull the version info from it -->
    <Import 
        Project="$(DirWorkspace)\version.xml" 
        Condition="Exists('$(DirWorkspace)\version.xml')" />

    <!-- Generate a file with the version information -->
    <Target Name="GenerateAssemblyInfoVersionNumber">
    <ItemGroup>
      <VersionTokens Include="Major">
        <ReplacementValue>$(VersionMajor)</ReplacementValue>
      </VersionTokens>
      <VersionTokens Include="Minor">
        <ReplacementValue>$(VersionMinor)</ReplacementValue>
      </VersionTokens>
      <VersionTokens Include="Build">
        <ReplacementValue>$(VersionBuild)</ReplacementValue>
      </VersionTokens>
      <VersionTokens Include="Revision">
        <ReplacementValue>$(VersionRevision)</ReplacementValue>
      </VersionTokens>
    </ItemGroup>
    <TemplateFile 
        Template="$(FileTemplateAssemblyVersion)"
        OutputFileName="$(FileGeneratedAssemblyVersion)" 
        Tokens="@(VersionTokens)" />
  </Target>
</Project> 
```

C# 项目中包含的 AssemblyInfo.VersionNumber.cs 文件是从如下模板文件生成的：

```
//-----------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost
//     if the code is regenerated.
// </auto-generated>
//-----------------------------------------------------------------------

using System.Reflection;

[assembly: AssemblyVersion("${Major}.${Minor}.${Build}.${Revision}")]
[assembly: AssemblyFileVersion("${Major}.${Minor}.${Build}.${Revision}")]

// The AssemblyInformationalVersion stores the version that will be displayed in
// Windows explorer.
[assembly: AssemblyInformationalVersion("${Major}.${Minor}.${Build}.${Revision}")] 
```

在替换过程中，这些`${TEXT_HERE}`部分被替换为它们各自的值。

Wix 包含模板文件如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<Include xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <!--
      This is a generated file.
      Do NOT make changes to this file.
      They will be undone next time the file is generated.
    -->

    <!-- The current version -->
    <?define CurrentVersion = "${Major}.${Minor}.${Build}"?>

    <!-- The install version string -->
    <?define ProductVersionFolder = "${Major}.${Minor}"?>
</Include> 
```

包含此文件后，可以在需要时引用Wix 安装程序中的`CurrentVersion`和变量。`ProductVersionFolder`

通过使用这种方法，版本信息存储在一个位置，并且可以被构建的所有部分访问。

# exchange-server - search-mailbox 命令在我的 Exchange 2010 sp1 中不起作用

> ID：14270943
> 
> 赞同：1
> 
> 时间：2013-01-11T02:57:25.457
> 
> 标签：exchange-server

我的搜索邮箱命令不起作用。问题是这样的：

[PS] C:\Windows\system32>Search-Mailbox -Identity "abc" -SearchQuery "Subject:'test'" 目标邮箱或.pst文件路径为必填项。+ CategoryInfo : InvalidArgument: (:) [], ArgumentException + FullyQualifiedErrorId : 78AF2AE3

同时get-mailbox之类的命令也没有问题。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T03:19:12.777

通过设置目标邮箱和文件夹解决的问题。使用如下命令：

Search-Mailbox -Identity "abc" -SearchQuery "Subject:'test mail'" -TargetMailbox "demo.xw" -TargetFolder "SearchLog"

# ios - 加载一个 UIViewController 并在屏幕上加载视图之前启动另一个 UIViewController

> ID：14270947
> 
> 赞同：0
> 
> 时间：2013-01-11T02:57:44.720
> 
> 标签：ios, objective-c

我有 3 个 UIViewController（V1、V2 和 V3）。从 V1 我想启动 V2，但在 V2 的视图显示在屏幕上之前以及在 V2 被推送到窗口层次结构之后我想启动 V3。如果我尝试从 V2 的 viewDidLoad 或 viewWillAppear 方法启动 V3，我会收到错误“尝试呈现 <>，其视图不在窗口层次结构中！” 如果我从 V2 的 viewDidAppear 执行此操作，则为时已晚，并且 V2 的视图已经在屏幕上。

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T15:36:25.613

在 V1 中，尝试呈现 v2 动画：NO，并在 V2 的 viewWillAppear 中呈现 v3 动画：YES

# java - Libgdx：为什么鼠标点击事件 Buttons.LEFT 没有注册？

> ID：14270948
> 
> 赞同：5
> 
> 时间：2013-01-11T02:57:54.763
> 
> 标签：java, libgdx

出于某种我不知道的原因，当我将 Buttons.LEFT 与事件处理程序一起使用时，什么也没有发生。这是我的代码：

```
if (Gdx.input.isKeyPressed(Buttons.LEFT)) {
        System.out.println("Mouse clicked!");
} 
```

如果我这样做，例如 Keys.LEFT 或 justTouched()，则会打印消息，但在我执行 Buttons.LEFT 时不会打印。是的，我 100% 正在按下鼠标按钮，并且它工作正常。;)

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-11T03:05:38.577

这是因为 Gdx.input.isKeyPressed() 用于键盘输入。如果您想要鼠标按钮输入，您应该这样做

```
if (Gdx.input.isButtonPressed(Buttons.LEFT)){
    System.out.println("Mouse clicked!");
} 
```

按钮和键是不同的类，因此在输入中有匹配的方法。多探索一下他们的 Input API Javadocs，它对我帮助很大。

[http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/Input.html](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/Input.html)

# r - 缺少值时禁止粘贴中的分隔符

> ID：14270950
> 
> 赞同：6
> 
> 时间：2013-01-11T02:58:10.443
> 
> 标签：r, paste, ggplot2

这是我读入数据帧的数据结构。

```
treatment  egf       mean      se
10 uM PP2            -697.25   14124.349
10 uM PP2  1 nM EGF  14715.50  8862.012
DMSO                 58589.25  7204.824
DMSO       1 nM EGF  87852.00  12149.159 
```

treatment 和 egf 列的组合表示每列的唯一 ID。我想创建一个将这些组合在一起的列，以便我可以拥有一个唯一代表每一行的列。但是，由于 EGF 列中的缺失值，当我使用粘贴时，它会做这件烦人的事情：

```
>paste(rawp$treatment, rawp$egf, sep=" + ")
[1] "10 uM PP2 + "         "10 uM PP2 + 1 nM EGF" "DMSO + "             
[4] "DMSO + 1 nM EGF" 
```

当缺少值时，它仍会将分隔符放在那里。我希望它阅读：

```
[1] "10 uM PP2"         "10 uM PP2 + 1 nM EGF" "DMSO"             
[4] "DMSO + 1 nM EGF" 
```

我怎样才能做到这一点？

我想这样做的全部原因是因为我想用 ggplot 绘制数据，并且在指定 x 轴时似乎只需要 1 个唯一列。

```
ggplot(data=rawp, aes(x=treatment, y=mean)) + geom_bar(stat="identity") 
```

因此，如果您还知道使用组合列指定 x 轴上的类别的另一种方法，那将很有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T03:12:25.460

您可以在粘贴后去掉“+”：

```
sub(" \\+ $", "", paste(rawp$treatment, rawp$egf, sep=" + ")) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-11T03:48:04.053

使用起来会很好，`sep = ifelse(egf == "", "", " + ")`但`sep`参数`paste`不能是向量。解决方案：将其作为常规参数传递！

```
with(rawp, paste0(treatment, ifelse(egf == "", "", " + "), egf)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T03:06:01.497

由于很难复制您的示例，因此我自己制作了：

```
d <- data.frame(a=c('a', 'b', ''), b=c('c', 'd', 'e')) 
```

你有什么：

```
paste(d$a, d$b, sep=' + ')
## [1] "a + c" "b + d" " + e" 
```

你想要什么：

```
unlist(apply(d[1:2], 1, function(x) paste(x[x!=''], collapse=' + ')))
## [1] "a + c" "b + d" "e" 
```

如果您有`NA`而不是`''`作为空白值，则解决方案类似。在这种情况下使用`!is.na(x)`而不是。`x!=''`

这扩展到您有两列以上的情况，并且您可能在任何列中缺少值：

```
d1 <- data.frame(a=c('a', 'b', ''), b=c('c', 'd', 'e'), c=c('', 'f', ''))
unlist(apply(d1, 1, function(x) paste(x[x!=''], collapse=' + ')))
## [1] "a + c"     "b + d + f" "e" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-11T05:34:27.850

这是一个很好的例子，说明何时`ifelse`可以很好地工作：

```
ifelse(rawp$egf=="", paste(rawp$treatment), 
                     paste(rawp$treatment, rawp$egf, sep=" + ")) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-11T09:59:24.453

您可以使用`apply`data.frame 的每一行并去掉所有长度为 0 的元素，然后使用`collapse`参数恢复为单个字符串：

```
apply(rawp[1:2],1,function(x) paste(x[nchar(x)>0],collapse=" + "))
[1] "10 uM PP2"            "10 uM PP2 + 1 nM EGF" "DMSO"                
[4] "DMSO + 1 nM EGF" 
```

# git - 我可以在 commit-msg 钩子中切换到另一个分支，提交它，然后切换回来吗？

> ID：14270957
> 
> 赞同：1
> 
> 时间：2013-01-11T02:59:28.707
> 
> 标签：git, github, githooks

我想在提交的任何时候将提交哈希的前几个字符和提交消息自动插入到`gh-pages`分支中的文件中`master`。

目前使用这个`post-commit`钩子：

```
#!/bin/bash
#Ensures we are in master branch
[ `git rev-parse --abbrev-ref HEAD` != "master" ] && exit 1
git checkout gh-pages
git merge master
# update the js file with commit identification information from git
# I can't seem to get this to work without generating a *_bak file. Whatever.
# I have a section in my source that has delimiters #% %# that I use to stuff the
# git commit into, so I can view the version of source I am testing on my device
# very easily (you can't imagine how much more definite and efficient this is compared
# to what we do at my work)
sed -i _bak "s/#%.*%#/#% `git log master -1 --format="%h %s"` %#/" source.js
git commit -a -m"this commit made by a script"
git checkout master 
```

我怀疑将其转换为`commit-msg`钩子可以让我减少生成的额外提交的数量（两个，一个将 master 合并到 gh-pages 中，一个将我用于 master 提交的 commit-msg 写入文件）每当我在 上执行提交时`master`，它至少可以让我通过执行`commit -n`for轻松跳过它`--no-verify`，而使用`post-commit`钩子我必须取消设置钩子文件上的 exec 标志以暂时禁用它。

这行得通吗？我想我应该试试看。不过，Git 会做什么呢？只要我的 bash 脚本发出 0 的返回值，它就会继续执行提交？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T07:14:59.613

如果这不起作用，则您的钩子的解决方案是在不同的本地存储库中执行相同的命令（已签出到`gh-pages`），并为您的 git 命令提供`--git-dir`和`--work-tree`选项（以引用其他存储库）。

然后在你的仓库中取回那个分支（仍然在同一个钩子中）。

* * *

2016 年 8 月更新：**[更简单的 GitHub 页面发布](https://github.com/blog/2228-simpler-github-pages-publishing)**现在允许将页面文件保存在*同一*分支的子文件夹中（不再`gh-pages`需要）：

[![现在您可以在存储库设置中选择一个源，GitHub Pages 将在那里查找您的内容。](../Images/4bfeda5a03d4b7f8c4891f088585c936.png)](https://i.stack.imgur.com/rZkbu.png)

因此，您现在可以简单地更新同一分支中的子文件夹内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T09:21:44.963

提交不是大问题。您不能真正使用`git commit`自己，但您可以使用管道命令创建提交（允许您使用单独的索引文件将提交添加到另一个分支，而无需实际接触工作树）。更大的问题是**合并**，因为它可能会失败并使树处于需要手动干预的状态。

# javascript - Kendo UI Grid 序列号栏

> ID：14270959
> 
> 赞同：5
> 
> 时间：2013-01-11T02:59:33.457
> 
> 标签：javascript, kendo-ui, kendo-grid

我试图将剑道网格的第一列作为序列索引，它不受行记录排序的影响。有什么办法可以做到这一点？谢谢你

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T07:41:50.533

您可以使用模板列来实现这一点。这是一个现场演示，展示了如何做到这一点：http: [//jsbin.com/olutin/10/edit](http://jsbin.com/olutin/10/edit)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-04-04T10:29:06.683

**脚本部分**

```
<script>   
           var rowNumber = 0;
        function resetRowNumber(e) {
            rowNumber = 0;
        }
        function renderNumber(data) {
            return ++rowNumber;
        }
        function renderRecordNumber(data) {
            var page = parseInt($("#Role").data("kendoGrid").dataSource.page()) - 1;
            var pagesize = $("#Role").data("kendoGrid").dataSource.pageSize();
            return parseInt(rowNumber + (parseInt(page) * parseInt(pagesize)));
        } 
     </script>

  **Kendo Grid**------------------------------------------------       

  @(Html.Kendo().Grid()   
            .Name("grid")
            .Columns(columns => {
                columns.Template(t => { }).Title("Record Per page").ClientTemplate("#= renderNumber(data) #");
            columns.Template(t => { }).Title("S.No").ClientTemplate("#= renderRecordNumber(data) #"); 
                );
            })
            .Events(ev => ev.DataBound("resetRowNumber"))
        ) 
```

它将返回两列，例如每页记录＆s.no只需使用jquery隐藏一列（0）

```
 $(document).ready(function () {
            var grid = $("#Role").data("kendoGrid");
            grid.hideColumn(0);
        }); 
```

# iphone - 新的崩溃日志不会出现在特定 iOS 设备的管理器中

> ID：14270964
> 
> 赞同：4
> 
> 时间：2013-01-11T03:00:35.323
> 
> 标签：iphone, ios, xcode, ipad, crash

有谁知道为什么组织者不会为我的一台 iOS 设备找到我的新崩溃报告，但它会为我的其他设备找到？

让我解释一下：我今天在我的 iPad 3 和 iPhone 5 上演示了一个应用程序。该应用程序仍处于测试阶段，所以我在这两种设备上都遇到了崩溃。那天晚些时候我回到家时，iPhone 5 的新崩溃立即出现在 Organizer 窗口中。但是，iPad 3 没有出现新的崩溃日志。出现的唯一日志（即使在等待几分钟并重新启动设备之后）来自一个月前。我在 iPad 3 上运行 iOS 6.01，在 iPhone 5 上运行 iOS 6.1 beta 3。有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-13T15:47:09.460

查看设备的控制台，看看是否有任何额外信息说明为什么会发生这种情况。我已经看到当设备充满崩溃报告时会发生这种情况，如果是这种情况，您将在设备的控制台中获得有关此信息的信息。

# mysql - 为什么这个 MySQL 查询需要这么长时间，我该如何解决？

> ID：14270966
> 
> 赞同：0
> 
> 时间：2013-01-11T03:00:41.260
> 
> 标签：mysql, sql, performance

当我有大约 30 个演员时，这个查询需要 20 多秒。有没有办法显着加快速度？我确信有，我只是不知道以什么方式或从哪里开始。

```
 REPEAT
    FETCH actors INTO a;
      IF a != '' THEN
        IF !(SELECT COUNT(*) FROM movieactor WHERE actor = a) THEN
          INSERT INTO movieactor (actor) 
          VALUES (a);
         END IF;
      END IF;
  UNTIL done END REPEAT; 
```

`movieactor`表只有一个`actor`和一个`id`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T03:07:53.353

您确实需要显示表定义、索引、查询计划和触发器以了解性能。但是，此查询有一些明显的建议。

为什么不使用集合操作，例如：

```
insert into movieactor(actor)
    select a
    from actors
    where a <> '' and
          a not in (select * from (select actor from movieactor)) 
```

（我认为 MySQL 需要双重选择来解析它。）

其次，您应该在movieactor.actor 上有一个索引。这可能会大大加快查询速度。

# puppet - 防止配置管理主/代理设置中的单一入口点

> ID：14270968
> 
> 赞同：1
> 
> 时间：2013-01-11T03:00:51.753
> 
> 标签：puppet, configuration-management

我正在研究像 Puppet 这样的配置管理软件。我主要关心的是阻止我们所有内部服务器的单一入口点。以这个场景为例。

不知何故，获得了对主配置服务器的访问权限。然后，用户将能够从那里获得相对容易的访问权限以操纵或最终获得对由主机控制的其他服务器的访问权限。

主要目标是防止单点进入网络，即使所述主配置不可用于公共互联网。

tl;dr 如何防止单点访问主/代理配置管理设置中的所有其他服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T03:08:01.870

如果您正在考虑将定义 Puppet 规则的任务委托给其他人（例如技术人员），您可以创建一个 Puppet Master（Master A），将一台测试机器连接到 Master A，然后让他们将代码提交给Git 或 SVN。

你控制第二个 Puppet master (Master B)，你从 Git 或 SVN 中提取代码。您在网络中的所有机器都连接到 Master B。一旦您对代码感到满意，您可以要求 Puppet 将其推送到您的所有机器。

这样，只能在 Master B 上访问所有机器配置，只有您自己处理和访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-05T13:45:49.863

您不能使用默认配置。

Puppet 的设计方式是让代理联系主人。即使您位于多个防火墙之后，您也需要允许代理进入您的内部网络。即使您通常允许从 DMZ 连接到内部网络，您仍可能需要管理开放 Internet 中的机器。Puppet 需要的是将您的内部网络开放到开放的互联网。

这种客户端拉动设计的风险在于，如果您可以通过代理入侵机器，您可以联系主机，如果主机有任​​何漏洞，您可以入侵它，您可以通过它们控制所有带有代理的机器，另外您可以对您的内部网络发起攻击。因此，如果在 Puppet Master 与代理的通信通道中利用漏洞，那么 Puppet 就会成为攻击媒介（一个巨大的攻击媒介，因为您可能使用它管理所有基础设施，并且您已允许从外部访问您的 LAN）。

通过主推设计，这可以最小化，因为主节点将是一个需要保护的单点，并且位于安全的内部网络内部，连接仅从内部到外部。

[PuppetLabs ( http://projects.puppetlabs.com/issues/2045](http://projects.puppetlabs.com/issues/2045) )中有一个待处理的功能请求（4 岁！），标题为*将 puppetmaster 中的功能推送到客户端*。阅读有关该功能请求的评论并找到类似以下评论的内容让我想知道 Puppet 开发人员是否真的了解问题所在：

> 最终，它也不是那么高的优先级——几乎所有向主服务器开放端口所暴露的风险也会通过让主服务器接触并联系客户而暴露出来。所提出的模型的实际风险几乎没有变化。

然而，当开发人员意识到这个问题时，其他人正在设计他们自己的解决方案（如[https://github.com/tomas-edwardsson/puppet-push](https://github.com/tomas-edwardsson/puppet-push)）。

*更新：* 我在[http://stroessenreuther.info/pub/Puppet_getting_started.pdf找到了 Bernd Strößenreuther 题为](http://stroessenreuther.info/pub/Puppet_getting_started.pdf)*“如何将您的环境转变为 Puppet 托管环境的最佳实践*”的演示文稿，以 PDF 格式提供

他建议建立从 master 到代理的 ssh 连接，并打开一个反向隧道，以便代理可以连接到 master。这些连接可以在 cron 作业中定期启动。通过这种方式，您不必为传入连接打开内部网络，但代理可以访问主数据。

现在，关于拉取机制，它可能看起来像是一个糟糕的设计，但实际上让非常自动化的环境工作是必不可少的。例如，在服务器自动启动和停止的弹性网络（如具有自动缩放功能的 EC2）中，服务器需要能够立即进行自我配置，因此它们启动并且他们做的第一件事就是联系主服务器以获取更新配置。如果您必须定期将配置推送到每个服务器，这将更加困难，因为它们需要等待主服务器（秒、分钟或小时；这在某些应用程序中是不可接受的）。

# iphone - 如何在 iOS 中使用篮子图像捕捉动画苹果图像？

> ID：14270971
> 
> 赞同：0
> 
> 时间：2013-01-11T03:01:42.507
> 
> 标签：iphone, ios, objective-c, animation, accelerometer

我正在开发一个应用程序。即，使用类似于抓苹果应用程序的篮子抓苹果。苹果从上到下动画，篮子出现在视图的底部。使用该篮子抓苹果。但我没有得到苹果和篮子图像的交点来捕捉苹果。

感谢帮助..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T04:26:43.880

**形状是矩形：**

您可以使用

```
CGRectIntersection((CGRect)r1, (CGRect)r2) 
CGRectIntersectsRect((CGRect)r1, (CGRect)r2)
CGRectContainsPoint((CGRect)rect, (CGPoint)point)
CGRectContainsRect((CGRect)rect1, (CGRect)rect2) 
```

**形状是非矩形的：**

UIKit：

您可能需要一些算法：[here](http://paulbourke.net/geometry) is a very good site for the algorithmes of points,lines,shapes ...[还有](https://stackoverflow.com/questions/2272179/a-simple-algorithm-for-polygon-intersection)一个关于SO的相关问题

Cocos2d：

您可以使用 Box2d 进行碰撞检测，这里有一个很好的 Box2d 教程 -> [How To Use Box2D For Just Collision Detection with Cocos2D iPhone](http://www.raywenderlich.com/606/how-to-use-box2d-for-just-collision-detection-with-cocos2d-iphone)

# javascript - 我如何使用 Filepicker.io 小部件但也使用自定义文件名？

> ID：14270977
> 
> 赞同：0
> 
> 时间：2013-01-11T03:02:45.427
> 
> 标签：javascript, filepicker.io

[我目前正在使用 Filepicker.io 的 Javascript API，并利用使用Store](https://developers.filepicker.io/docs/web/#store)方法的 Path 选项将自定义文件名写入我们的 S3 存储桶的能力。从在线文档来看，Store 方法似乎是唯一可以实际使用自定义文件名的地方。

但是，我们想开始使用一些小部件，甚至只使用 Javascript API 中的 Pick/PickMultiple。有没有办法在使用小部件时也设置自定义文件名？如果是这样，任何指导将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-22T13:13:58.390

您还可以使用 storePath 选项：

```
filepicker.pick({storePath: '/myfiles/file.png'}, function(InkBlob) {
    console.log(InkBlob);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T01:50:15.523

对于这个用例，如果你愿意的话，你将不得不超越小部件并点击“裸机”API。那么那么

```
filepicker.pick(function(FPFile){
     filepicker.store(FPFile, {location:"S3", path: "myFile.png"});
}); 
```

这将是解决问题的方法。

# python - 连续按下事件 Pyqt

> ID：14270979
> 
> 赞同：1
> 
> 时间：2013-01-11T03:03:06.487
> 
> 标签：python, qt, pyqt, pyqt4

我制作了一个脚本，其中有 lineedit 和 tool button 。按钮充当退格键。每当用户单击按钮时，它将从 lineedit 中删除一个字母。

现在我希望如果我继续按下（不释放按钮），它应该继续删除行编辑中的单个字母文本（就像我们在行编辑时按住退格键它将一个一个地删除字母）。

我尝试了 QKeyEvent 并且每次我需要按下按钮删除一个字母时都会这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T08:32:55.277

任何`Q*Button`类都内置了此功能。它被称为[`autoRepeat`](http://qt-project.org/doc/qt-4.8/qabstractbutton.html#autoRepeat-prop)。默认情况下，这是禁用的。但是如果你启用它，`clicked`只要它保持按下状态，按钮就会以一定的间隔连续触发（和类似的信号）。

[`autoRepeatDelay`](http://qt-project.org/doc/qt-4.8/qabstractbutton.html#autoRepeatDelay-prop)您可以使用和微调行为[`autoRepeatInterval`](http://qt-project.org/doc/qt-4.8/qabstractbutton.html#autoRepeatInterval-prop)。

# c# - 替代自动属性中的私有设置器

> ID：14270984
> 
> 赞同：0
> 
> 时间：2013-01-11T03:03:51.170
> 
> 标签：c#, .net, oop

如果您不应该对自动属性使用私有设置器（不好的做法），那么我如何才能从类中私下设置它，并且仍然只向公众公开它？（假设我想在构造函数级别设置它，但仍然允许它通过 get 公开）？

示例类：

```
public class Car
{
    //set the property via constructor
    public SomeClass(LicensePlate license)
    {
         License = license
    }

    public LicensePlate License{get; private set;} // bad practice
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T03:05:37.000

您将属性转换为具有支持字段且没有设置器的属性。

```
public class Car
{
    LicensePlate _license;

    public Car(LicensePlate license)
    {
        _license = license;
    }

    public LicensePlate License
    {
        get { return _license; }
    }
} 
```

# ruby-on-rails - 错误“block_is_haml？” Ruby 1.9 中的 Haml = f.label

> ID：14270986
> 
> 赞同：0
> 
> 时间：2013-01-11T03:04:17.433
> 
> 标签：ruby-on-rails, haml

app/views/users/_form.html.haml，第 10 行

```
= form_for @user do |f|
  - if @user.errors.any?
    #error_explanation
      %h2= "#{pluralize(@user.errors.count, "error")} prohibido que este usuario se guarde:"
      %ul
        - @user.errors.full_messages.each do |msg|
          %li= msg

  .field
    = f.label 'Usuario'
    = f.text_field :username
  .field
    = f.label :email
    = f.text_field :email
  .field
    = f.label 'Teléfono'
    = f.phone_field :phone
  .field
    = f.label 'Contraseña'
    = f.password_field :password
  .field
    = f.label 'Reingresar Contraseña'
    = f.password_field :password_confirmation
  .control-group
    //= f.label 'Permisos'
    %ul.unstyled
      - for role in Role.find(:all)
        %li
          = check_box_tag "user[role_ids][]", role.name, @user.roles.include?(role)
          = role.name
    %br
  .actions
    = f.submit 'Guardar',:class => 'btn btn-primary' 
```

错误似乎在`= f.label`我已经删除了所有`= f.label`并且没有抛出任何错误，也没有运气就改变`= f.label 'Usuario'`了。`= f.label :username`

错误信息：

```
ArgumentError in Users#new

Showing C:/Sites/AutosCostaRica/app/views/users/_form.html.haml where line #10 raised:

syntax error in "<reader>", line 3, column 18:
        next_label: >>
                     ^ 
```

更新：

我刚刚发现它在 Ruby 1.8 上完美运行，但我想成为 1.9。

有任何想法吗？

# mongodb - 尝试更新文档

> ID：14270987
> 
> 赞同：0
> 
> 时间：2013-01-11T03:04:27.120
> 
> 标签：mongodb, mongoose

我想更新一个文档（将用户名“toto”放在模型 id 1 上）。问题是，update() 调用会发生任何事情（例如，如果应用程序正在等待某些东西），我不会去更新回调。

我不明白发生了什么，这是代码：

```
UserSchema : {
    username: {
        type: String,
        required: true,
        unique: true
    },
};

var UserSchema = new mongoose.Schema(UserSchema);
UserSchema
        .virtual('id')
        .get(function(){
            return this.get('_id');
        }).set(function(id){
            return this.set('_id', id);
        });    

var User = db.model('User', UserSchema);
var Entity = new User();

Entity.update({ _id: 1 }, { username: 'toto'}, null, function(error, numAffected){
    if (error){
        console.log("|-->Error Query trying to update model");
    }else{
        console.log("|-->Update model succeed");
    }
}); 
```

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T03:26:40.707

我的问题是实例化一个 Use 并`update()`在其实例上应用`update()`对 UserSchema 的调用。

# c# - DllImport 修饰名称问题 - 无法找到入口点

> ID：14270992
> 
> 赞同：5
> 
> 时间：2013-01-11T03:04:38.993
> 
> 标签：c#, c++, .net, dllimport

我有一个奇怪的问题，我有 C++ DLL，我使用 DLL 导入将其导入 C# 库。如果我指定入口点，一切都会按预期进行，示例如下：

```
internal static class UnsafeMethods
{
    [DllImport("GoodSchool.dll", EntryPoint = @"?AddNum@@YAHHH@Z")]
    public static extern int AddNum(int num1, int num2);
}

class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine(UnsafeMethods.AddNum(4,5));
    }
} 
```

但是，如果我使用像这里这样的简化导入：

```
[DllImport("GoodSchool.dll", CallingConvention = CallingConvention.Cdecl)]
public static extern int AddNum(int num1, int num2); 
```

我收到熟悉的错误消息：

未处理的异常：System.EntryPointNotFoundException：无法在 DLL“GoodSchool.dll”中找到名为“AddNum”的入口点

我使用依赖来验证该方法是否正确公开，并且我解码符号以验证参数和命名约定 - 一切似乎都很好。

C++ 中的函数签名非常简单：

```
 __declspec(dllexport) int AddNum(int num1, int num2); 
```

有什么建议我可以在 C# 中调用此方法而不提供修饰名称作为入口点吗？我做错了什么？我不想使用“C”导出，因为我的理解是修饰的函数名称非常适合与 DllImport 一起使用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T03:10:30.253

C++ 修改函数名称以解决函数名称重载问题。毕竟，如果 DLL 有

```
__declspec(dllexport) int AddNum(int num1); 
__declspec(dllexport) int AddNum(int num1, int num2); 
```

哪个是`AddNum`指？

该符号`?AddNum@@YAHHH@Z`是在非托管 DLL 中公开的重整（又名修饰）名称。

[https://en.wikipedia.org/wiki/Name_mangling#Name_mangling_in_C.2B.2B](https://en.wikipedia.org/wiki/Name_mangling#Name_mangling_in_C.2B.2B)

您的 DLL 不会导出名为`AddNum`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-11T03:13:16.313

修饰的函数名称可以很好地与 一起使用`DllImport`，正如您正在这样做的事实所看到的那样。但这需要您在导入中*指定*修饰函数名称。就链接器（静态或动态）而言，未修饰的名称不存在 -`AddNum`根本不是您的库公开的符号。

如果您想按照您的要求做：

> 在 C# 中调用此方法而不提供修饰名称作为入口点？

那么你不能让C++首先破坏这个名字。您可以*在*C++ 代码中指定修饰名称`DllImport` *或*使用链接。`extern "C"`您必须选择其中之一。

# sql - SQL Server 中区分大小写的变量名？

> ID：14270993
> 
> 赞同：3
> 
> 时间：2013-01-11T03:04:49.900
> 
> 标签：sql, tsql, stored-procedures, collation

当我执行这种格式的 SQL 命令时： `SP_HELPTEXT Sproc1`. 结果集将显示`Could not find stored procedure 'SP_HELPTEXT'`。但是如果我将SQL命令替换为小写`sp_helptext Sproc1`，它肯定会显示Sproc1的内容。

我`Sproc1`在我的程序中使用，当程序执行时`Sproc1`它会返回一条消息：

```
Must declare the variable '@Variable1'. 
```

虽然我已经声明了那个特定的变量。

我有一个提示，该问题与排序规则、区分大小写或不区分大小写的设置有关。有人知道如何解决吗？

* * *

出现区分大小写的变量名的另一种情况：

```
CREATE PROCEDURE Foo @customerID int AS
PRINT @customerId 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T06:53:28.803

您有区分大小写的服务器排序规则。

您的数据库有一个（如您所示）不区分大小写的排序规则，但是当您遇到变量大小写问题时，重要的是服务器排序规则。

这同样适用`sp_helptext`于在数据库主控中以小写形式定义的存储过程。所以当你调用`SP_HELPTEXT`它时没有找到。

要修复您的存储过程以在区分大小写的服务器排序规则中工作，您必须确保对变量`@Variable1`的每个引用都是如此。不是`@variable1`或`@VARIABLE1`。

使用它来检查您拥有的服务器排序规则。

```
SELECT SERVERPROPERTY('collation'); 
```

从[SQL Server 联机丛书](http://technet.microsoft.com/en-us/library/ms184391.aspx)：

> # [整理 (Transact-SQL)](http://technet.microsoft.com/en-us/library/ms184391.aspx)
> 
> 标识符的排序取决于定义它的级别。
> 
> *   实例级对象的标识符（例如登录名和数据库名称）被分配了实例的默认排序规则。
> *   数据库中对象的标识符（例如表、视图和列名）被分配了数据库的默认排序规则。
>     
>     
>     
>     例如，可以在具有区分大小写排序规则的数据库中创建两个名称仅在大小写不同的表，但不能在具有不区分大小写排序规则的数据库中创建。有关详细信息，请参阅[数据库标识符](http://technet.microsoft.com/en-us/library/ms175874.aspx)。
>     
>     
> *   **变量**、**GOTO 标签**、**临时存储过程**和**临时表**的标识符在服务器实例的默认排序规则中。
>     
>     
>     
>     变量、GOTO 标签、临时存储过程和临时表可以在连接上下文与一个数据库关联时创建，然后在上下文切换到另一个数据库时进行引用。

# 也可以看看

*   [MSDN 论坛：为什么我的 SP 在使用 BIN 排序规则推送到数据库时会抛出大小写错误？](http://social.msdn.microsoft.com/Forums/en-US/vstsdb/thread/0d833fab-2b32-4b98-a3ab-cdf8c743e5e0)
*   [SQL Server 中区分大小写的变量](https://stackoverflow.com/questions/6559254/case-sensitive-variables-in-sql-server)
*   [SQL Server 存储过程区分大小写？](https://stackoverflow.com/questions/1399908/sql-server-stored-procedure-case-sensitive)

# ios - 带有 NSPredicate 的 Fetchrequest 不返回正确的值

> ID：14270994
> 
> 赞同：0
> 
> 时间：2013-01-11T03:05:08.687
> 
> 标签：ios, core-data, nspredicate, nsfetchrequest

我对 Core Data 有一个奇怪的问题。问题是我正在寻找属性小于 X 的对象，并且它没有返回所有匹配的值。没有缓存，我没有使用 //[fetchRequest setFetchBatchSize:50];

```
 NSPredicate *pred = [NSPredicate predicateWithFormat:@"self.level <= [cd] %@", [self.filters objectForKey:@"level"]]; 
```

我将它添加到谓词的 MutableArray 中，然后执行 NSPredicate *myPredicate = [NSCompoundPredicate andPredicateWithSubpredicates: subPredicates];

这是一个返回 myPredicate 的函数，称为 preparePredicates。目前没有更多的谓词，只有一个。它的 NSLog 返回：level <=[cd] "30"。我也尝试过使用字符串的 intValue 和 %i 的主要功能：

```
NSError* error;
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription entityForName:@"myEntity"
                                          inManagedObjectContext:self.context];
[fetchRequest setEntity:entity];
NSPredicate* predicate = [self preparePredicates]; 
[fetchRequest setPredicate:predicate];

//[fetchRequest setFetchBatchSize:50];
NSArray *fetchedObjects = [self.context executeFetchRequest:fetchRequest error:&error];
NSLog (@"Error: %@", error);
NSLog(@"los fetchedobjects: %i",[fetchedObjects count]);
return fetchedObjects; 
```

它不返回任何错误。如果我查看结果，没有一个级别为 6，但还有其他匹配（均低于指定值）。我知道有一个 6 级。如果我在 SQLite 数据库浏览器中打开 .sqlite，我可以在那里看到它。如果我使用这个程序

```
SELECT * FROM zmyentity WHERE zlevel <30; 
```

它不会出现，就像在 Core Data 中一样。但是，如果我执行 SELECT * FROM zmyentity WHERE zlevel == 6; 它出现。我真的不知道发生了什么。也许我犯了一个菜鸟错误，所以请指出我正确的方向。非常感谢您提前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T06:17:38.663

可能您已将级别存储为*字符串*属性，因为

```
"30" < "6" 
```

比较字符串时。选择数字属性类型（整数 16/32/64）应该可以解决问题。类中的相应`level`属性`myEntity`则具有`NSNumber`类型。

您还应该`[cd]`在谓词中省略修饰符，因为这会强制进行字符串比较。

您的谓词可能如下所示：

```
[NSPredicate predicateWithFormat:@"self.level <= %d", [[self.filters objectForKey:@"level"] intValue]] 
```