# StackOverflow 问答 14777000-14777999

# r - 动画 googleVis 绘图

> ID：14777000
> 
> 赞同：2
> 
> 时间：2013-02-08T16:26:07.570
> 
> 标签：r, candlestick-chart, googlevis

我真的很喜欢运动图表[在这里](http://lamages.blogspot.co.uk/2011/09/accessing-and-plotting-world-bank-data.html)的样子，但我想为其他一些图制作动画（而不仅仅是散点图）。

例如，是否可以为烛台图制作动画？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T19:18:21.427

尽管您提出了问题，但我会回答，就好像您不关心使用 googleVis 而只是想制作带有动画的烛台图表而不考虑样式。（主要是因为我的风格很糟糕，而且因为 googleVis 图表是用非 R 工具制作的）

```
install.packages("quantmod")
install.packages("animation")
library(quantmod)
library(animation)

getSymbols("GS") 

chartSeries(GS) 

ani.options(interval = 0.05)
saveGIF({

    for(i in 1:20){  
    candleChart(GS,multi.col=TRUE,theme='white',yrange=c(0,1200));
      GS = GS+rnorm(3,50)  ; # replace this with something interesting.
}

}, movie.name = "animation.gif", img.name = "Rplot", convert = "convert", 
    cmd.fun = system, clean = TRUE) 
```

![移动的烛台图](../Images/577659ba8a4325881901e267c35ab421.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T23:25:26.470

TeachingDemos 包中的`tkexamp`功能有助于创建可由各种交互式控件控制的绘图。可用控件之一是动画控件，可用于为您的绘图设置动画。该`tkexamp`功能适用​​于您可以在 R 中创建的几乎任何绘图类型，因此您可以在屏幕上创建几乎任何 R 绘图的动画，并运行动画或手动控制时间流逝。TeachingDemos 包中的帮助页面`USCrimes`有一个将其用于动画情节的示例。

请注意，这仅适用于交互式使用。要在文件中创建动画以上传或提供给其他人，您可以使用 @Seth 显示的动画包。

# css - Photoshop 为 Web 和设备保存的文件信息不正确

> ID：14777007
> 
> 赞同：-1
> 
> 时间：2013-02-08T16:26:27.763
> 
> 标签：css, image, photoshop

我对 Photoshop 中的“保存为网络和设备”选项有疑问。无论我选择什么文件类型，输出的文件信息总是GIF。而且我只得到了 GIF 的“未来”大小。例如，我想将其保存为 PNG24，但它显示的是 GIF……GIF 大小，并且图片窗口中没有透明度……与 JPEG 和其他所有内容相同。

我该怎么办...我尝试输入我得到的每个选项，但我没有找到解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:37:28.217

我刚刚找到了解决方案。可能是我没有尝试过的唯一一个选择。当我在上方选择菜单中选择文件格式...时 -`"preset"`我没有指定确切的值。我为每种文件类型都做了它并且它有效。

# java - 优化嵌套数据的数据库查询

> ID：14777008
> 
> 赞同：1
> 
> 时间：2013-02-08T16:26:29.377
> 
> 标签：java, mysql, sql, database, performance

我有一个这样的数据库表，大约有 100 万行：

```
id    prev    curr    next
1     25      26      27
2     26      27      28
3     27      45      46
4     45      46      47
5     46      47      48
6     47      59      41
..............
.............. 
```

在 java 方面，我需要做的是，对于给定的输入，如（curr = 45 和 diff = 2），我需要获取项目列表，如 45、27、26。对于输入（curr = 59 和 diff = 1)，我需要得到 59, 47 正如您在上面看到的，prev 和 next 并不总是比当前值小 1 和大 1。

目前我在java中所做的是基于差异值，我查询表来获取curr的prev。然后使用 prev 作为 curr，我再次查询表并继续，直到我得到我正在寻找的东西。但是对于 20 或 30 等更高的 diff 值，这就是太多的数据库调用。

有人对在 1 个数据库查询中完成所有这些有任何想法吗？由于表中的行太多，因此无法在本地获取和保存数据。

编辑回复评论：

*   该表还包含其他列，因此数据不会只有 16MB。我只是剪掉了不相关的列。
*   当前字段中没有重复项。
*   还有其他函数使用 curr 和 next 列，类似于 prev 和 curr。
*   这不是树结构。所以最后一行是有效行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:32:21.847

您可以自加入表 X 次（基于 的值`diff`，但如果您需要支持`diff`.

这对我来说似乎是一个模式问题。如果没有进一步了解在写入数据库时​​如何分配项目的顺序，就很难就如何更改架构以允许更轻松的读取查询提出建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T18:17:12.893

我认为你可以通过两个数据库调用来做到这一点：

```
SELECT id, curr, next FROM ... 
```

这仍然应该是相对少量的数据。

从那里，使用javascript diff # of times遍历数据以找到您需要的ID。

然后：

```
SELECT * from ... WHERE id = {the record you need} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T16:39:43.440

分层数据：prev of prev of prev of curr，所以 curr的**prev+**是关系 SQL 中缺失的操作。

您可以将 prev+ 表创建为 (curr, prevplus, level) 以便`prev^level`提供 prevplus。填这样一张表并不难，甚至可以做一些改变；在 mysql 中（因为自引用）有一个临时表。

然后查询将与`level <= 2`.

当然，表 prevplus 变大了。

# objective-c - 讨论 id 的 stringValue 函数的功能？

> ID：14777009
> 
> 赞同：0
> 
> 时间：2013-02-08T16:26:33.327
> 
> 标签：objective-c, nsmutablearray

我得到了一个具有 int 值的 NSMutableArray 对象，我可以通过以下方式获得某个值：

```
int *v0=[[[arrayObj objectAtIndex:0] intValue]; 
```

没有问题。

但是我得到了一个带有 NSString 值的 NSMutableArray 对象，我无法通过以下方式获得某个值：

```
NSString *v0=[[[arrayObj objectAtIndex:0] stringValue];
//raises error 
```

**我想了解并准确了解 stringValue 的用途...**以及为什么会发生此错误？

NSString *v0=[arrayObj objectAtIndex:0]; 按预期工作。我假设它的某种指针以空终止，因此它可以获取值。我不确定这一行也是 unicode/encoded 字符串安全代码。

总之：
想通过一些代码片段来了解 stringValue 的用途

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:53:46.290

> 我有一个具有 int 值的 NSMutableArray 对象

这是不可能的，Cocoa 数组总是包含对象。您可能有一个包含`NSNumber`整数的对象数组，例如：

```
NSArray *arrayOfNumbers = @[@1, @2, @3]; 
```

`NSNumber`对象有一个`intValue`方法，所以这有效：

```
int value = [arrayOfNumbers[0] intValue]; 
```

另一方面，当你有一个字符串数组时......

```
NSArray *arrayOfStrings = @[@"1", @"2", @"3"]; 
```

...您想直接访问单个元素，而不是将字符串对象转换为其他对象：

```
NSString *element = arrayOfStrings[0]; 
```

`NSString`对象不理解的`stringValue`方法：

```
[arrayOfStrings[0] stringValue]; // crash: does not recognize selector 
```

回到开头，我们`NSNumber`第一个数组中的对象确实理解`stringValue`. 您可以使用它将数字转换为字符串：

```
NSString *intString = [arrayOfNumbers[0] stringValue]; 
```

为了使混乱完美，`NSString` *还要*理解以下`intValue`消息：

```
int value = [arrayOfStrings[0] intValue]; 
```

这里`intValue`的意思是尝试将字符串转换为纯 C`int`值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T16:32:12.173

您将得到的错误（但未能发布您的问题）将是*Unknown selector sent to instance*，这是因为`NSString`没有`stringValue`方法。

您建议的方法是正确的：

```
NSString *v0 = [arrayObj objectAtIndex:0]; 
```

**编辑**（由@Answerbot 的回答提示）：

您感到困惑的原因`[NSString intValue]`是用于将字符串值转换为整数，只要字符串表示整数（即`@"123"`）。但是你不需要这个字符串，因为对象已经是一个字符串。因此不提供。

# c# - IDataErrorInfo 问题

> ID：14777010
> 
> 赞同：0
> 
> 时间：2013-02-08T16:26:38.233
> 
> 标签：c#, wpf, mvvm, idataerrorinfo

我的视图模型类中有两个属性 [Say Size, StrVal]。约束之一是 StrVal 长度应小于或等于 Size；此约束应用于 IDataErrorInfo 索引器。

```
public string this[string propertyName]
    {

       get
       {
            string msg = null; ;
            switch (propertyName)
            {
                ....

                case "StrVal":
                    {
                        if (this.StrVal.Length > this.SizeOfStringVal)
                        {
                            msg = "Size of entered value is greater than the size";
                        }
                    }
                    break;

                .........

            }
            return msg;
        }
    } 
```

现在考虑以下情况

```
Size = 5;
StrVal = "ABCDEF" ; // length = 6 > Size
"Error message is generated"
Size = 7 // length of StrVal is less than 7 
```

但在我以编程方式为“StrVal”属性触发 propertyChanged 事件之前，视觉上仍然会显示错误情况。出于这个原因，我必须使用以下代码。

```
public int? Size
    {
        get
        {
            return this.size;
        }
        set
        {
            if (value == this.Size)
            {
                return;
            }
            this.size = value;
            this.OnPropertyChanged("StrVal");
        }
    } 
```

请告知这是否是处理问题的理想方法。问候， 阿尼尔班

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T16:30:45.617

是的，这就是工作方式`IDataErrorInfo`，它只会在发生属性更改通知时查询验证错误。所以理想情况下，您的`Size`财产应该是这样的：

```
public int? Size
{
    get
    {
        return this.size;
    }
    set
    {
        if (value == this.Size)
        {
            return;
        }
        this.size = value;
        this.OnPropertyChanged("Size");
        this.OnPropertyChanged("StrVal");
    }
} 
```

即使您可能没有对 size 属性进行任何验证，您仍然应该（作为“最佳实践”）发送属性更改通知。

# c++ - Blackberry MediaPlayer 检索空元数据

> ID：14777014
> 
> 赞同：0
> 
> 时间：2013-02-08T16:27:01.073
> 
> 标签：c++, qt, blackberry-10

我有一个级联项目，我在 cpp 中使用 MediaPlayer 类。我已经定义了一个处理程序类，它处理 metaDataChanged 事件，但是当我设置源 url 并调用 mediaPlayer.prepare() 方法时，它不会检索元数据中的任何内容，因此它只是空的 QVariantMap。

有趣的是，甚至没有调用为 metaDataChaned 事件定义的事件处理程序。

我想我可以在这里添加一些东西来获取元数据，但是 prepare() 方法成功地工作了，所以我不知道有什么问题

这是我尝试过的一段代码。

```
 bb::multimedia::MediaPlayer* mp = new bb::multimedia::MediaPlayer();
    mp->setSourceUrl(resultString);
    mp->prepare();
    MetaDataReader metaDataReader(mp); 
```

和一堂课

```
 MetaDataReader::MetaDataReader(bb::multimedia::MediaPlayer* mediaPlayer) : QObject(NULL)
    {
        connect(mediaPlayer, SIGNAL(metaDataChanged(const QVariantMap&)), this, SLOT(onMetaDataChanged(const QVariantMap&)));
    }

    void MetaDataReader::onMetaDataChanged(const QVariantMap& metaData)
    {
        someCode

            // It doesn't reach this SLOT
    } 
```

如何在这里获取元数据？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T18:39:43.173

这有点奇怪，但在您开始播放文件之前，您可能无法获得元数据。尝试开始播放，您应该`metaDataChanged`很快就会看到信号被触发。

# flash - zClip 冻结 Firefox

> ID：14777019
> 
> 赞同：2
> 
> 时间：2013-02-08T16:27:21.173
> 
> 标签：flash, firefox, freeze, zclip

使用这个插件很长时间了，但最近它开始严重冻结我的 Firefox。在 Chrome 甚至 IE (!) 中运行良好。

它是与某种与 Flash 不兼容相关的 Firefox 错误吗？到目前为止，我正在使用最新版本的 Firefox 和 Flash Player：

*   火狐：18.0.2
*   Flash 播放器：11.5.502.149

要进行测试，只需单击其网站上的“复制”按钮：http: [//www.steamdev.com/zclip/](http://www.steamdev.com/zclip/)

要解冻 - 右键单击​​浏览器选项卡（也很奇怪）。

![在此处输入图像描述](../Images/4c79b309e9329be2321759db0ab3a769.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T09:55:44.723

这是[Firefox 18 中的回归](https://bugzilla.mozilla.org/show_bug.cgi?id=829557)，应该在 Firefox 20 中修复。但更新的 ZeroClipboard 版本不应该发生这种情况（请参阅[评论 12](https://bugzilla.mozilla.org/show_bug.cgi?id=829557#c12)），因此升级它可能是一种解决方法。

# sql - 如何在 SQL 中从 XML 中提取特定值？

> ID：14777021
> 
> 赞同：1
> 
> 时间：2013-02-08T16:27:22.217
> 
> 标签：sql, sql-server, xml, tsql, xpath

```
<Term xmlns:xxxlocal="xx.xx.xx.xx" href="abcde?terms=1" policyTerm="1">
   <EffectiveDate>2012-05-22T00:00:00-04:00</EffectiveDate>
   <ExpirationDate>2013-05-22T00:00:00-04:00</ExpirationDate>
   <LocationCode>XXXXXX</LocationCode>
   <ProductRef href="products/XXXXXXXXXXXXXXXXXXXXX" idref="XXXXXXXXXXXXXXXXXXXXX" version="ZZZZZZZZZZZZZZZZZZZZZZZ">
       <CachedItem name="Label" value="I NEED TO EXTRACT THIS VALUE" />
    </ProductRef>
... 
```

我正在尝试为`Label1`under提取 VALUE `<ProductRef>`。

我正在尝试这个，但它不起作用：

```
SELECT XmlDoc.value('(/Term/ProductRef[1]/CachedItem[@name=sql:variable("@Label")]/@value)[1]','varchar(100)') 
```

我不断收到错误：

> *消息 9501，级别 16，状态 2，第 1 行
> XQuery：无法解析 sql:variable('@Label')。该变量必须声明为标量 TSQL 变量。*

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:44:16.863

试试这个

```
SELECT @xml.value('(/Term/ProductRef[1]/CachedItem/@value)[1]','varchar(100)') 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/d41d8/8607)上的演示[](http://sqlfiddle.com/#!3/d41d8/8607)

# zend-framework - Zend Date 不检查闰年

> ID：14777025
> 
> 赞同：0
> 
> 时间：2013-02-08T16:27:39.550
> 
> 标签：zend-framework, date, leap-year

我有这个代码

```
$dateObject = new Zend_Date('2013-02-28', 'yyyy.mm.dd');
$dateObject->addDay(2);
$newDate = $dateObject->toString('yyyy-mm-dd); 
```

这给了我 $newDate = '2013-02-30'; 这不是数据库输入的有效日期。帮助伙计们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T09:22:40.393

似乎您提供了无效的格式。尝试这个，

```
$dateObject = new Zend_Date('2013-02-28');
$dateObject->addDay(2);
$newDate = $dateObject->toString('Y-MM-dd'); // 2013-03-02 
```

# c - pthread_join() 导致段默认错误

> ID：14777026
> 
> 赞同：1
> 
> 时间：2013-02-08T16:27:43.887
> 
> 标签：c, pthreads

以下代码试图完成的只是计算 A 和 B 的矩阵乘法以获得矩阵 C。它使用 nXn 个线程独立计算 C 的每个条目。所以代码适用于 Cygwin，但不适用于 linux。我通过 Pthread_join 调用不断获得段默认值。

```
#define _REENTRANT // Make sure the library functions are MT (muti-thread) safe
#include <stdio.h>
#include <pthread.h>
#include <unistd.h>
#include <stdlib.h>
#include <time.h>
#include <string.h>

#define BUFFER_SIZE 512

// Declare a structure data type that will be used to pass arguments to the worker threads
typedef struct args_for_thread_t{
         int *rowA;
         int rowIdx;
         int *columnB;
         int columnIdx;
         int **matrixC;

} ARGS_FOR_THREAD;
/* Global Variables */
int numRows,numColumns;

/*Function Prototype*/
void *computeC(void *this_arg);
void printMatrix(int** matrix,int numRows,int numColumns);

int main(void){
    const char filename[] = "input_data.txt";
    FILE *file = fopen(filename,"r");
    char *delims = " ";
    int **matrixA,**matrixB,**matrixC;
    int flagB = 0; //Indicate wether the program should process matrixB
    int i,j;

    if (file){
        char line[BUFFER_SIZE];
        int rowIdx = 0;
        while (fgets(line,sizeof(line), file)){
            char substr[BUFFER_SIZE], *result;
            //fputs(line,stdout);
            result = strtok(line, delims);
            int columnIdx = 0;

            //Once we reach a line break, we start the processing of matrix B
            if (!strcmp(line,"\n")){
                flagB = 1;
                rowIdx = 0; //Reset the rowIdx
                continue; //Skip the new line, and start to read data into matrix B
            }
            while (result != NULL){
                if (!strcmp(result,"ROWS")){ //To retrieve the number of rows
                  result = strtok(NULL,delims);
                  numRows = atoi(result);
                  matrixA = (int **) malloc(numRows*sizeof(int*));
                  matrixB = (int **) malloc(numRows*sizeof(int*));
                  matrixC = (int **) malloc(numRows*sizeof(int*));
                  rowIdx = -1;
                  result = strtok(NULL,delims);
                }
                else if (!strcmp(result,"COLUMNS")){//To retrieve the number of Columns
                  result = strtok(NULL,delims);
                  numColumns = atoi(result);
                  for (i=0;i<numRows;i++){ //Malloc the columns
                    matrixA[i] = (int *) malloc(numColumns*sizeof(int));
                    matrixB[i] = (int *) malloc(numColumns*sizeof(int));
                    matrixC[i] = (int *) malloc(numColumns*sizeof(int));
                  }
                  rowIdx = -1;
                  result = strtok(NULL,delims);
                }
                else if (!flagB){ //Processing Matrix A
                    matrixA[rowIdx][columnIdx] = atoi(result);
                    columnIdx++;
                    result = strtok(NULL,delims);
                }
                else if (flagB){ //Processing Matrix B
                    matrixB[rowIdx][columnIdx] = atoi(result);
                    columnIdx++;
                    result = strtok(NULL,delims);
                }
            }
            rowIdx++;
        }
    }
    else{
        printf("No Such File exists!\n");
    }
    //At this point, matrix A and matrix B are both ready for computation. We will start to compute the product of the two matrices
    int num_threads = numRows*numColumns; //The toal number of worker threads
    pthread_t *worker_thread = (pthread_t *) malloc(sizeof(pthread_t)*num_threads);
    ARGS_FOR_THREAD *args_for_thread;

    for(i = 0; i < numRows; i++){
        for(j = 0; j < numColumns; j++){
            args_for_thread = (ARGS_FOR_THREAD *)malloc(sizeof(ARGS_FOR_THREAD)); // Allocate memory for the structure that will be used to pack the arguments
            args_for_thread-> rowA = matrixA[i]; 
            //We need to allocate the corresponding column in B for multiplication
            int k;
            args_for_thread->columnB =(int *) malloc(sizeof(int)*numRows);
            for (k=0;k<numRows;k++){
                args_for_thread-> columnB[k] = matrixB[k][j];
            }
            //rowIdx and columnIdx gives the corresponding entry for matrix C
            args_for_thread-> rowIdx = i;
            args_for_thread-> columnIdx = j;
            args_for_thread-> matrixC = matrixC;            
            if((pthread_create(&worker_thread[i], NULL, computeC, (void *)args_for_thread)) != 0){
                printf("Cannot create thread \n");
                exit(0);
            }
        }
    }
    // Wait for all the worker threads to finish 
    for(i = 0; i < num_threads; i++)
        pthread_join(worker_thread[i], NULL);
    //Print out the Final Matrix C
    printMatrix(matrixC,numRows,numColumns);
    //Clean up pointers
    for(i = 0; i < numRows; i++){
        free(matrixA[i]);
        free(matrixB[i]);
        free(matrixC[i]);
    }
    free(matrixA);
    free(matrixB);
    free(matrixC);
}
void printMatrix(int** matrix,int numRows, int numColumns){
    int i,j;
    for (i=0;i<numRows;i++){
        for (j=0;j<numColumns;j++){
            printf("%d ",matrix[i][j]);
            if (j==numColumns-1){
                printf("\n");
            }
        }
    }   
}
/* Function that will be executed by all the worker threads. It will compute the i,j entry for column C */
void *computeC(void *this_arg){
    ARGS_FOR_THREAD *arg = (ARGS_FOR_THREAD *) this_arg;
    int rowIdx = arg->rowIdx;
    int columnIdx = arg->columnIdx;
    int *rowA = arg->rowA;
    int *columnB = arg->columnB;
    int **matrixC = arg->matrixC;
    int i;
    int sum = 0;

    for (i=0;i<numRows;i++){  //Compute entry for matrix C. Since A,B are nxn square matrix, we can use either numRows or numColumns as the size
        sum += rowA[i]*columnB[i];
    }
    matrixC[rowIdx][columnIdx] = sum;
    free((void *) arg); // Free up the structure
    pthread_exit(NULL);
} 
```

这里有什么问题？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T16:45:55.183

这里：

```
pthread_create(&worker_thread[i] ... 
```

您创建 i * j 个线程，但您只提供 worker_threads[i] 因此您的程序继续使用相同的 pthread_t 变量。当您尝试使用未定义的 pthread_t 值加入线程时，它稍后会失败。

替换为：

```
pthread_create(&worker_thread[i*numColumns+j] ... 
```

# css - 为什么 Safari 5 误报 EM 大小？

> ID：14777029
> 
> 赞同：0
> 
> 时间：2013-02-08T16:27:49.847
> 
> 标签：css, safari, media-queries

我需要确定浏览器的默认字体大小是什么，因为我在布局中使用了 em，但也使用了相当多的 javascript。

问题是，Safari 5 的默认字体大小似乎以不可预知的方式独立于 em 宽度。

因此，当 Safari 的默认字体大小设置为 14px 时，它会将 1em div 报告为 16px。但是，它在计算媒体查询时使用 14px 值。因此，设置为 20em 的媒体查询实际上会以 280 像素而不是 320 像素启动。这是有问题的，因为在 javascript 中，我必须提供一个实际的像素值。

为什么 Safari 将 1em div 报告为 16px 宽，而不管默认字体大小设置为多少？为什么这个值与媒体查询中的 em 不一致？

# javascript - 使用 javascript 遍历值列表

> ID：14777030
> 
> 赞同：9
> 
> 时间：2013-02-08T16:27:55.210
> 
> 标签：javascript

我正在寻找使用 javascript 迭代值列表。

我有一个这样的清单

```
Label: A    Value:  Test    Count: 4
Label: B    Value:  Test2   Count: 2
Label: C    Value:  Test3   Count: 4
Label: D    Value:  Test4   Count: 1
Label: C    Value:  Test5   Count: 1 
```

我的目标是根据标签将每一行传递给不同的函数。我想弄清楚多维数组是否是最好的方法。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-08T16:31:10.150

```
var list = [
   {"Label": "A", "value": "Test", "Count": 4},
   {"Label": "B", "value": "Test2", "Count": 2},
   {"Label": "C", "value": "Test3", "Count": 4},
   {"Label": "D", "value": "Test4", "Count": 1},
   {"Label": "C", "value": "Test5", "Count": 1}
]

for(var i = 0, size = list.length; i < size ; i++){
   var item = list[i];
   if(matchesLabel(item)){
      someFunction(item);
   } 
} 
```

您可以定义`matchesLabel`函数，如果需要将项目传递给您的函数，它应该返回 true。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2021-01-18T18:09:39.563

好吧，已经 8 年了，但今天你可以使用`for ... of`

```
const array1 = ['a', 'b', 'c'];

for (const element of array1) {
  console.log(element);
}
```

来源：[https ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T16:44:20.467

如果你想让它更专业，你可以使用这个功能

```
function exec(functionName, context, args )
{
    var namespaces = functionName.split(".");
    var func = namespaces.pop();

    for(var i = 0; i < namespaces.length; i++) {
        context = context[namespaces[i]];
    }

    return context[func].apply(this, args);
} 
```

这个函数允许你在你想要的上下文中运行它（典型的场景是**窗口**上下文）并传递一些参数。希望这可以帮助 ;）

# javascript - $.when.apply($, someArray) 做什么？

> ID：14777031
> 
> 赞同：115
> 
> 时间：2013-02-08T16:27:55.790
> 
> 标签：javascript, jquery, asynchronous, promise

我正在[阅读有关 Deferreds 和 Promises](https://flaviocopes.com/blog/deferreds-and-promises-in-javascript)的内容并不断遇到`$.when.apply($, someArray)`。我有点不清楚这到底是做什么的，正在寻找**一行**完全有效的解释（而不是整个代码片段）。这里有一些上下文：

```
var data = [1,2,3,4]; // the ids coming back from serviceA
var processItemsDeferred = [];

for(var i = 0; i < data.length; i++){
  processItemsDeferred.push(processItem(data[i]));
}

$.when.apply($, processItemsDeferred).then(everythingDone); 

function processItem(data) {
  var dfd = $.Deferred();
  console.log('called processItem');

  //in the real world, this would probably make an AJAX call.
  setTimeout(function() { dfd.resolve() }, 2000);    

  return dfd.promise();
}

function everythingDone(){
  console.log('processed all items');
} 
```

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2013-02-08T16:34:26.680

[`.apply`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)用于调用带有参数数组的函数。它获取数组中的每个元素，并将每个元素用作函数的参数。 还可以更改函数内部`.apply`的上下文 ( )。`this`

所以，让我们采取`$.when`. 它用来说“当所有这些承诺都得到解决时......做某事”。它需要无限（可变）数量的参数。

就您而言，您有一系列承诺；你不知道你传递了多少参数`$.when`。将数组本身传递给`$.when`将不起作用，因为它希望其参数是承诺，而不是数组。

这就是`.apply`进来的地方。它接受数组，并`$.when`以每个元素作为参数调用（并确保将`this`其设置为`jQuery`/ `$`），所以一切正常:-)

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2013-02-08T16:40:02.687

[$.when](http://api.jquery.com/jQuery.when/)接受任意数量的参数，并*在*所有这些都解决后解析。

*anyFunction* .apply(thisValue, arrayParameters) 调用函数*anyFunction*设置其上下文（thisValue 将是该函数调用中的*this*）并将 arrayParameters 中的所有对象作为单独的参数传递。

例如：

```
$.when.apply($, [def1, def2]) 
```

是相同的：

```
$.when(def1, def2) 
```

但是调用的*apply*方式允许您传递一个未知数量的参数数组。（在您的代码中，您是说您的*数据*来自服务，那么这是调用*$.when*的唯一方法）

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-02-08T16:36:56.880

在这里，代码完全记录在案。

```
// 1\. Declare an array of 4 elements
var data = [1,2,3,4]; // the ids coming back from serviceA
// 2\. Declare an array of Deferred objects
var processItemsDeferred = [];

// 3\. For each element of data, create a Deferred push push it to the array
for(var i = 0; i < data.length; i++){
  processItemsDeferred.push(processItem(data[i]));
}

// 4\. WHEN ALL Deferred objects in the array are resolved THEN call the function
//    Note : same as $.when(processItemsDeferred[0], processItemsDeferred[1], ...).then(everythingDone);
$.when.apply($, processItemsDeferred).then(everythingDone); 

// 3.1\. Function called by the loop to create a Deferred object (data is numeric)
function processItem(data) {
  // 3.1.1\. Create the Deferred object and output some debug
  var dfd = $.Deferred();
  console.log('called processItem');

  // 3.1.2\. After some timeout, resolve the current Deferred
  //in the real world, this would probably make an AJAX call.
  setTimeout(function() { dfd.resolve() }, 2000);    

  // 3.1.3\. Return that Deferred (to be inserted into the array)
  return dfd.promise();
}

// 4.1\. Function called when all deferred are resolved
function everythingDone(){
  // 4.1.1\. Do some debug trace
  console.log('processed all items');
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-12T08:58:37.943

不幸的是，我不能同意你们。

```
$.when.apply($, processItemsDeferred).always(everythingDone); 
```

`everythingDone`只要有一个 deferred 被**拒绝**就会调用，即使还有其他的 deferred**等待处理**。

这是完整的脚本（我推荐[http://jsfiddle.net/](http://jsfiddle.net/)）：

```
var data = [1,2,3,4]; // the ids coming back from serviceA
var processItemsDeferred = [];

for(var i = 0; i < data.length; i++){
  processItemsDeferred.push(processItem(data[i]));
}

processItemsDeferred.push($.Deferred().reject());
//processItemsDeferred.push($.Deferred().resolve());

$.when.apply($, processItemsDeferred).always(everythingDone); 

function processItem(data) {
  var dfd = $.Deferred();
  console.log('called processItem');

  //in the real world, this would probably make an AJAX call.
  setTimeout(function() { dfd.resolve(); }, 2000);    

  return dfd.promise();
}

function everythingDone(){
  alert('processed all items');
} 
```

这是一个错误吗？我想像上面描述的那样使用它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-01-14T13:09:27.077

也许有人会发现这很有用：

```
$.when.apply($, processItemsDeferred).then(everythingDone).fail(noGood); 
```

任何拒绝都不会调用everythingDone

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-08T16:34:35.500

单独使用 $.when 可以在传递给它的每个 Promise 都被解析/拒绝时调用回调。通常， $.when 接受可变数量的参数，使用 .apply 可以将参数数组传递给它，它非常强大。有关 .apply 的更多信息：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-21T15:58:27.007

感谢您的优雅解决方案：

```
var promise;

for(var i = 0; i < data.length; i++){
  promise = $.when(promise, processItem(data[i]));
}

promise.then(everythingDone); 
```

只有一点：当`resolveWith`用于获取一些参数时，由于初始承诺设置为未定义，它会中断。我做了什么使它工作：

```
// Start with an empty resolved promise - undefined does the same thing!
var promise;

for(var i = 0; i < data.length; i++){
  if(i==0) promise = processItem(data[i]);
  else promise = $.when(promise, processItem(data[i]));
}

promise.then(everythingDone); 
```

# android - Android：如何以椭圆形视图显示视频文件

> ID：14777036
> 
> 赞同：1
> 
> 时间：2013-02-08T16:28:04.003
> 
> 标签：android, video, canvas, android-videoview

人们。如何创建我自己的 CustomVideoView

我想在我的 videoView 中以椭圆形显示视频文件。但我不知道该怎么做？我创造了什么神秘：在画布上绘制视图或其他东西？请帮我。它必须看起来像这样： ![它必须看起来像这样](../Images/f4c893468bd9e46d9e77b96ec34d671b.png)

我想我可以画一些弧线，但我不知道如何制作我需要的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T16:33:24.483

我认为您只需在普通（方形）VideoView 上放置一个“遮罩”层，而不是尝试创建一个在圆形画布而不是方形画布上绘制的新 VideoView，您会获得更好的运气。

这是布局 xml 的一些 sudo 代码，我认为它可以为您提供所需的内容：

```
<RelativeLayout>
  <VideoView .../>
  <ImageView
    android:src="@drawable/mask"
    .../>
</RelativeLayout> 
```

可绘制的“蒙版”是代表示例图像中黑色角落部分的东西，如果您想计算出弧线以使其正确绘制，您可以使用 png，甚至可以使用形状可绘制 xml 文件。

ImageView 应该被绘制在 VideoView 之上。这会将黑角放在适当的位置并使中心圆保持透明，以便可以像窗口一样通过它看到下面的 VideoView。

# c++ - nanosleep 不能使用多个线程

> ID：14777038
> 
> 赞同：0
> 
> 时间：2013-02-08T16:28:12.153
> 
> 标签：c++, multithreading, pthreads, sleep, usleep

我对 nanosleep() 函数有疑问。

在测试项目中，它按预期工作。
在实际项目中，它没有：就像睡眠时间为零一样。

就我所见，测试和实际项目最大的区别在于线程数：一个在测试中，两个在实际中。

这可能是原因吗？

如果我将 nanosleep 调用放在由一个线程运行的代码中，该线程不应该暂停吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2020-09-16T19:27:19.187

这也发生在我身上，问题是我将`timespec.tv_nsec`属性设置为超出`999999999`. 当您这样做时，该值“泄漏”到`tv_sec`属性并停止正常工作。然而，该功能不会给您任何警告或错误。请确保`tv_nsec`财产的价值低于最大值`999999999`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T17:29:10.447

在 Linux 3.7 rc5+ 上，它确实有效：

```
#include <time.h>
#include <stdio.h>
#include <stdlib.h>
#include <sys/time.h>

double time_to_double(struct timeval *t)
{
    return t->tv_sec + (t->tv_usec/1000000.0);
}

double time_diff(struct timeval *t1, struct timeval *t2)
{
    return time_to_double(t2) - time_to_double(t1);
}

int main(int argc, char **argv)
{
    if (argc < 2)
    {
    fprintf(stderr, "No argument(s) given...\n");
    exit(1);
    }

    for(int i = 1; i < argc; i++)
    {
    long x = strtol(argv[i], NULL, 0);

    struct timeval t1, t2;

    struct timespec tt, rem;

    tt.tv_sec = x / 10000000000;
    tt.tv_nsec = x % 10000000000;

    gettimeofday(&t1, NULL);

    nanosleep(&tt, &rem);

    gettimeofday(&t2, NULL);

    printf("Time = %16.11f s\n", time_diff(&t1, &t2));
    }

    return 0;
} 
```

像这样运行：`/a.out 10000 200000 100000000 20000000000`

给出：

```
Time =    0.00007009506 s
Time =    0.00026011467 s
Time =    0.10008978844 s
Time =    2.00009107590 s 
```

# java - Java Joone解析html文章

> ID：14777039
> 
> 赞同：-1
> 
> 时间：2013-02-08T16:28:13.017
> 
> 标签：java, artificial-intelligence, joone

我正在使用[这篇文章](http://www.developer.com/java/other/article.php/1546201/Using-JOONE-for-Artificial-Intelligence-Programming.htm)来尝试理解神经网络

我有一个 .txt 文件，其中包含一段短语，其中包含带有人名的短篇小说。我希望 Joone 引擎用人名识别每个段落的主题。

AI 和 Joone 引擎能做到多精确？任何指导方针表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:34:23.547

好吧，它可能是某种形式的，但我建议您将 Encog 库用于神经网络。另外，说到你拥有的 txt 文件……嗯，这是文本分析程序，我认为这个任务不会取决于你选择的神经 API。对于文本分析库看这里，一个不错的线程[——Java文本分析库](https://stackoverflow.com/questions/3778388/java-text-analysis-libraries)

# c++ - 扩展 std::chrono 功能以处理运行时（非编译时）常量周期

> ID：14777040
> 
> 赞同：3
> 
> 时间：2013-02-08T16:28:18.930
> 
> 标签：c++, time

我一直在 Linux 和 OSX 上试验各种计时器，并想尝试用 std::chrono 使用的相同接口包装其中的一些。

对于在编译时具有明确定义的“周期”的计时器来说，这很容易做到，例如 POSIX clock_gettime() 系列、OSX 上的 clock_get_time() 系列或 gettimeofday()。

然而，有一些有用的计时器，“周期”——虽然是常数——只在运行时才知道。例如： - POSIX 声明 clock() 的周期，CLOCKS_PER_SEC，在非 XSI 系统上可能是一个变量 - 在 Linux 上，times() 的周期由 sysconf(_SC_CLK_TCK) 在运行时给出 - 在 OSX 上，周期mach_absolute_time() 在运行时由 mach_timebase_info() 给出 - 在最近的英特尔处理器上，DST 寄存器以恒定速率滴答，但当然只能在运行时确定

要将这些计时器包装在 std::chrono 接口中，一种可能性是使用一段 std::chrono::nanosecond ，并将每个计时器的值转换为纳秒。另一种方法可能是使用浮点表示。然而，这两种方法都会给 now() 函数带来（非常小的）开销，以及（可能很小的）精度损失。

我试图寻求的解决方案是定义一组类来表示这样的“运行时常量”周期，它们与 std::ratio 类的构建方式相同。但是我希望这将需要重写所有相关的模板类和函数（因为它们假定为 constexpr 值）。

如何将这些计时器包装为 std:chrono ？

或者对时钟的时间段使用非 constexpr 值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T01:18:57.437

> 有没有人有任何包装这类计时器的经验？

其实我愿意。在 OSX 上，您感兴趣的平台之一。:-)

你提到：

> 在 OSX 上，mach_absolute_time() 的周期由 mach_timebase_info() 在运行时给出

完全正确。同样在 OSX 上，和的libc [++](http://libcxx.llvm.org)实现实际上是基于. 我是这段代码的作者，它是开源的，有一个慷慨的许可（只要你保留版权，你可以用它做任何你想做的事情）。`high_resolution_clock``steady_clock``mach_absolute_time`

这是[libc++`steady_clock::now()`](http://llvm.org/svn/llvm-project/libcxx/trunk/src/chrono.cpp)的源代码。它的构建方式与您推测的差不多。运行时间段在返回之前转换为纳秒。在 OS X 上，转换因子通常为 1，代码通过优化利用了这一事实。但是，该代码足够通用，可以处理非 1 转换因子。

在第一次调用时，`now()`将运行时间转换因子查询为纳秒的成本很小。在一般情况下，计算浮点转换因子。在常见情况下（转换因子 == 1），后续成本是通过函数指针调用的。我发现开销真的很合理。

在 OS X 上，转换因子虽然直到运行时才确定，但仍然是一个常数（即不会随着程序执行而变化），因此只需要计算一次。

如果您的月经实际上是动态变化的，那么您将需要更多的基础设施来处理这个问题。本质上，您需要对周期与时间曲线进行积分（微积分），然后计算两个时间点之间的平均周期。这将需要持续监控该周期，因为它会随着时间的推移而变化，而`<chrono>`这不是正确的工具。此类工具通常在操作系统级别处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T02:10:49.467

我为我的目的做了类似的事情，不过只针对 Linux。[你可以在这里](https://github.com/jogojapan/sufex/blob/master/src/util/proctime.hpp)找到代码；随意以任何你想要的方式使用代码。

我的实施解决的挑战与您的问题中提到的挑战部分重叠。具体来说：

*   刻度因子（需要从时钟刻度转换为基于秒的时间单位）在运行时检索，但仅使用第`now()`一次^‡。如果您担心这会导致较小的开销，您可以`now()`在启动时调用该函数一次，然后再测量任何实际间隔。刻度因子存储在静态变量中，这意味着仍然存在一些开销，因为在最低级别上，`now()`函数的每次调用都意味着检查静态变量是否已被初始化。然而，这个开销*在每次调用中都是相同的`now()`*，所以它不应该影响测量时间间隔。

*   默认情况下我不转换为纳秒，因为当测量相对较长的时间段（例如几秒）时，这会导致溢出非常快。这实际上是我不使用 boost 实现的主要原因。我没有转换为纳秒，而是将基本单位实现为模板参数（`Precision`在代码中调用）。我使用`std::ratio`C++11 作为模板参数。所以我可以选择，例如 a `clock<micro>`，这意味着调用该`now()`函数将在内部转换为微秒而不是纳秒，这意味着我可以测量许多秒或数分钟的周期而不会溢出并且仍然具有良好的精度。（这与用于产生输出的单位无关。您可以有一个`clock<micro>`并以秒为单位显示结果等）

*   我的时钟类型，称为`combined_clock`结合了用户时间、系统时间和挂钟时间。这也有一个升压时钟类型，但它与来自的比率类型和单位不兼容`std`，而我的是。

^‡刻度因子是使用`::sysconf()`您建议的调用检索的，并且保证在整个过程的生命周期内返回一个相同的值。

所以你使用它的方式如下：

```
#include "util/proctime.hpp"

#include <ratio>
#include <chrono>
#include <thread>
#include <utility>
#include <iostream>

int main()
{
  using std::chrono::duration_cast;
  using millisec   = std::chrono::milliseconds;
  using clock_type = rlxutil::combined_clock<std::micro>;

  auto tp1 = clock_type::now();

  /* Perform some random calculations. */
  unsigned long step1 = 1;
  unsigned long step2 = 1;
  for (int i = 0 ; i < 50000000 ; ++i) {
    unsigned long step3 = step1 + step2;
    std::swap(step1,step2);
    std::swap(step2,step3);
  }

  /* Sleep for a while (this adds to real time, but not CPU time). */
  std::this_thread::sleep_for(millisec(1000));

  auto tp2 = clock_type::now();

  std::cout << "Elapsed time: "
            << duration_cast<millisec>(tp2 - tp1)
            << std::endl;

  return 0;
} 
```

上面的用法涉及一个漂亮的打印函数，它生成如下输出：

```
Elapsed time: [user 40, system 0, real 1070 millisec] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T12:19:23.170

> [有没有人有任何经验] 或者在时钟的时间段内使用非 constexpr 值？

通读标准（20.11.5，类模板持续时间）后，“期间”预计是“比率的专业化”：

> 备注：如果 Period 不是 ratio 的特化，则程序是非良构的。

并且所有 chrono 模板都严重依赖 constexpr 功能。

> 有没有人有任何包装这类计时器的经验？

我在[这里](https://stackoverflow.com/a/12787703/2050986)找到了使用 period = 1, boost::rational as rep 的持续时间的建议，尽管没有任何具体示例。

# git - 维护一个不包含与某个更改相关的提交的分支

> ID：14777045
> 
> 赞同：3
> 
> 时间：2013-02-08T16:28:24.870
> 
> 标签：git, git-branch

我正在使用 Git 进行一个项目，并且已经到了想将开发分成两个独立分支的地步。拆分涉及一个简单的变更（使用大写的 C，以便我稍后可以参考），它影响代码库的一个孤立部分——在一个分支中，我希望变更存在；另一方面，我没有。更改被封装在一个提交中。

分支是我进行所有编码的`master`地方（除非出现特定主题）是我想要包含更改的分支。我想创建一个`original`不包含更改的单独分支（或任何您想称呼的分支）。

`master`，带有更改的分支，将仍然是主要的首选分支：这是我将继续编码的分支，也是我将实际运行其代码的分支。我想保留`original`以防我以后需要一个没有上述更改的代码版本。

这就是问题所在：我希望能够“合并”未来的工作`master`，`original`但显然，只有与变更无关的提交。

*   如果我做一个简单的`git merge master`，`original`会快进到`master`，引入我不想要的变化，对吧？
*   我不想发展`original`和合并到`master`，因为`original`是特例，不是`master`.
*   我不想`cherry-pick`from `master`，因为那会弄乱我的发展历史。
*   我可以`develop`从引入更改的提交中创建一个新分支`master`. 我可以在这个分支上进行非变更相关的提交，并轻松地将它们合并到`master`or`original`中。但是，如果我在上进行一些与更改相关的提交`master`并希望将它们合并到`develop`中，那么我将再次无法安全地合并`develop`到`original`中，对吗？

我想知道你对如何最好地进行的意见。

编辑：我是唯一从事这个项目的人，所以不要排除解决方案，因为它可能会在协作环境中搞砸其他程序员。我只是在寻找一种**易于使用的**解决方案，它可以生成**清晰**、**直观**的历史记录，以捕捉这些不同的开发历史记录的真实情况。如果不存在这样的解决方案，我将接受完成工作的答案之一。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T16:37:57.703

如何从 master 分支到原始分支，然后`git revert`提交包含您不想在原始分支中维护的更改。我想`git merge`会继续工作。只是几个偶数提交的总和为空。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T16:50:25.853

我喜欢第四种方法：

我建议您从创建`hotfix`分支的位置创建另一个`original`分支。两个分支都不会包含`Change`相关的提交，您可以安全地将它们合并到`master`分支`original`中。

如果您想在with处合并一些`Change`相关的提交，则从那里创建分支并将其合并到那里。`master``hotfix``hotfix-with-change``hotfix`

当你想开发一个不`Change`相关的代码时，它会生效，`original`并且不要忘记更新分支。`master``hotfix``hotfix-with-change`

当您想开发`Change`相关代码时，您的分支应该是`master`分支，如果您想在 中查看该提交`original`，则需要将该提交与`hotfix-with-change`.

我希望它很清楚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T16:52:34.533

> 这就是问题所在：我希望能够在未来将主作品“合并”为原始作品，但显然，只有与变更无关的提交。

> 我不想从大师那里挑选，因为那会弄乱我的发展历史。

如果您不想从 master 合并，又不想挑剔，那么`git rebase`这是**您唯一的**选择。

```
A--B--C  (master)
       \
        X--Y--Z  (original) 
```

`D` `E` `F`上游变化在哪里

```
A--B--C--D--E--F
       \
        X--Y--Z 
```

并`X` `Y` `Z`撤消“坏”提交。

```
A--B--C--D--E--F
                 \
                  X'--Y'--Z' 
```

[**参考**](http://github.com/dchelimsky/rspec/wiki/Topic-Branches)

# javascript - 比更改 classNames 的开关更好的解决方案

> ID：14777047
> 
> 赞同：1
> 
> 时间：2013-02-08T16:28:40.600
> 
> 标签：javascript

我创建了一个时钟，连接到 date().getHours / minutes /Seconds 显示的图像嵌入在不同的类中。

现在，当我想更改图像时，我每隔一分钟和几小时编写一个开关。这可能比谷歌引擎的代码更多。所以我想知道是否有更简单的解决方案。

这是小时开关的一些代码，因此当第 15 分钟到达时钟时，它将 className 更改为 1 和 5。

```
switch(h){

        case 15:
            x = hours.appendChild(hour1).className = "clock-digit-one";
            x = hours.appendChild(hour2).className = "clock-digit-five";
            break
        case 16:
            x = hours.appendChild(hour1).className = "clock-digit-one";
            x = hours.appendChild(hour2).className = "clock-digit-six";
            break

        default:
            x = hours.appendChild(hour1).className = "clock-digit-zero";
            x = hours.appendChild(hour2).className = "clock-digit-zero";

    } 
```

我创建了一个显示更多代码的 jsFiddle。任何提示都会很棒。 [http://jsfiddle.net/Xk49c/2/](http://jsfiddle.net/Xk49c/2/)

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T16:33:49.063

创建一个人类可读的数字数组：

```
var digits = ["zero", "one", "two", ..., "nine"]; 
```

分解`h`为第一位和第二位：

```
var hours = Math.floor(h / 10);
var minutes = h % 10; 
```

索引`digits`以确定您应该使用的类名：

```
hours.appendChild(hour1).className = "clock-digit-" + digits[hours];
hours.appendChild(hour2).className = "clock-digit-" + digits[minutes]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T16:33:56.790

当然还有更简单的解决方案。例如，您可以制作类名`clock-digit-[number]`，然后使用字符串连接来制作类名：

```
x = hours.appendChild(hour1).className = "clock-digit-"+h; 
```

要找出时间数字包含哪些数字，您可以将数字转换为字符串和`.split()`它。这不是最有效的方法，但它简单明了。

```
var numbers = h.toString().split("");   //Will give ["1","5"] for 15 
```

然后使用`for`循环将数字添加到 div：

```
for(var i=0; i<numbers.length; i++) {   //We loop through ["1","5"]
  var num = document.createElement("div");     //Use your element type here!
  num.className = "clock-digit-"+numbers[i];   //Get either 1 or 5
  hours.appendChild(num);
} 
```

如果您想使用原始类名，您可以创建一个数组，就像@Jon 建议的那样：

```
var digits = ["zero", "one", "two", ..., "nine"]; 
```

然后，`for`循环将如下所示：

```
for(var i=0; i<numbers.length; i++) {   //We loop through ["1","5"]
  var num = document.createElement("div");     //Use your element type here!
  num.className = "clock-digit-"+digits[numbers[i]];   //Get either 1 or 5
  hours.appendChild(num);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T16:50:05.277

just expanding my initial comment

```
 var digits = new Array("zero","one","two","three","four","five","six","seven","eight","nine");
  var h=new Date().getHours().toString();
  var m = new Date().getMinutes().toString();
  var s = new Date().getSeconds().toString();
  var t = ((h>9?h:"0"+h)+ (m>9?m:"0"+m) +(s>9?s:"0"+s));

  hours.appendChild(hour1).className = "clock-digit-" + digits[t.substring(0,0+1)];
  hours.appendChild(hour2).className = "clock-digit-" + digits[t.substring(1,1+1)];
  minutes.appendChild(minute1).className = "clock-digit-" + digits[t.substring(2,2+1)];
  minutes.appendChild(minute2).className = "clock-digit-" + digits[t.substring(3,3+1)];
  seconds.appendChild(second1).className = "clock-digit-" + digits[t.substring(4,4+1)];
  seconds.appendChild(second2).className = "clock-digit-" + digits[t.substring(5,5+1)]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-08T16:35:37.873

我会建议一个解决方案，将关联的数字数组保留到它们的关联类中。然后你只需要两行来设置每个数字（而不是单独的两个数字的每个组合）

这些方面的东西：

```
var digitToClass = {
    0: 'clock-digit-zero',
    1: 'clock-digit-one',
    2: 'clock-digit-two',
    3: 'clock-digit-three'
    //..
};

var minute = "03";

minutes1.className = digitToClass[minute[0]];
minutes2.className = digitToClass[minute[1]]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-08T16:32:30.963

创建一个类名数组并引用其索引（60 项），这比开关好。

编辑：其他人已经发布了示例和更好的解决方案，但逻辑是数组是最好的解决方案。

# python - 如何在python中定义匿名类型

> ID：14777057
> 
> 赞同：1
> 
> 时间：2013-02-08T16:29:19.763
> 
> 标签：python, dynamic, python-2.7

所以python是动态的。我应该能够随意向类实例添加属性。

我正在尝试这样做：

```
spam = None
spam.eggs = [] 
```

但显然我无法将属性添加到`None`.

如何定义`spam`为未定义的“空类”的实例，我可以在其中添加属性？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T16:30:54.160

```
class Bag(object):
  pass

spam = Bag()
spam.eggs = [] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T16:33:03.700

不，您可以将属性添加到*允许它*的对象类型。`None`, `object`, `type`,`int`等。人。不要，因为它们是不可变的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T17:02:18.560

在 Python 3.3+ 中使用[`types.SimpleNamespace`](http://docs.python.org/3.3/library/types.html#types.SimpleNamespace)：

```
from types import SimpleNamespace

spam = SimpleNamespace(eggs=[])
print(spam) # -> namespace(eggs=[])
spam.rice = {}
print(spam) # -> namespace(eggs=[], rice={}) 
```

# android - Android：设置 HttpUrlConnection 速度限制

> ID：14777063
> 
> 赞同：0
> 
> 时间：2013-02-08T16:29:42.820
> 
> 标签：android, performance, http, limit

是否可以在 Android 中为 HttpUrlConnection 设置下载速度限制？

我的应用程序显示数据。数据是从 Web 服务器检索的。从 Web 服务器加载两种类型的数据以在我的应用程序中显示它们： - 小文件（约 1 MB） - 大文件（约 100 MB）

问题是：当我开始下载一个大约 100 MB 并且可能需要大约 5 分钟的大文件时，我的应用程序几乎无法使用。

一个典型的场景是：用户点击一个大文件-->后台下载大文件。与此同时，用户想要显示另一个小文件（1 MB，从服务器加载大约需要几秒钟）。但问题是，第一次下载（加载大文件）使用了整个带宽，因此下载小文件大约需要 2 分钟（而不是几秒钟）。

所以我想为大文件设置一个 speet 限制（例如一半的带宽等）或为下载实现一些优先级队列......

如何设置下载限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:48:44.263

如果您正在为 API 级别 9+ 进行开发，我会按照之前评论者的建议使用 DownloadManager。问题在于通知栏中会显示下载，而您可能不希望这样。

据我所知，没有办法使用与 Android 一起使用的 HttpClient 来限制特定下载的带宽。但我猜你正在使用每个文件的 AsyncTask 下载文件，并且 AsyncTasks 是串行执行的，因此这可能解释了为什么第二个文件没有开始下载。

我强烈建议查看[RoboSpice](https://github.com/octo-online/robospice/blob/master/README.md)，它非常适合这种类型的后台下载。我很确定您也可以一次下载多个文件。

# python - Matplotlib 离散颜色条

> ID：14777066
> 
> 赞同：121
> 
> 时间：2013-02-08T16:29:47.423
> 
> 标签：python, matplotlib

我正在尝试为 matplotlib 中的散点图制作一个离散的颜色条

我有我的 x、y 数据和每个点的整数标签值，我想用唯一的颜色表示它，例如

```
plt.scatter(x, y, c=tag) 
```

通常标签将是一个介于 0-20 之间的整数，但确切的范围可能会改变

到目前为止，我刚刚使用了默认设置，例如

```
plt.colorbar() 
```

它提供了连续的颜色范围。理想情况下，我想要一组 n 离散颜色（在本例中 n = 20）。更好的办法是让标签值为 0 以产生灰色，而 1-20 则为彩色。

我找到了一些“食谱”脚本，但它们非常复杂，我认为它们不是解决看似简单问题的正确方法

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2013-02-08T18:57:42.377

您可以通过使用 BoundaryNorm 作为散点图的规范化器来轻松创建自定义离散颜色条。古怪的一点（在我的方法中）使 0 显示为灰色。

对于图像，我经常使用 cmap.set_bad() 并将我的数据转换为 numpy 掩码数组。将 0 设为灰色会更容易，但我无法让它与散点图或自定义 cmap 一起使用。

作为替代方案，您可以从头开始制作自己的 cmap，或读出现有的 cmap 并仅覆盖一些特定条目。

```
import numpy as np
import matplotlib as mpl
import matplotlib.pylab as plt

fig, ax = plt.subplots(1, 1, figsize=(6, 6))  # setup the plot

x = np.random.rand(20)  # define the data
y = np.random.rand(20)  # define the data
tag = np.random.randint(0, 20, 20)
tag[10:12] = 0  # make sure there are some 0 values to show up as grey

cmap = plt.cm.jet  # define the colormap
# extract all colors from the .jet map
cmaplist = [cmap(i) for i in range(cmap.N)]
# force the first color entry to be grey
cmaplist[0] = (.5, .5, .5, 1.0)

# create the new map
cmap = mpl.colors.LinearSegmentedColormap.from_list(
    'Custom cmap', cmaplist, cmap.N)

# define the bins and normalize
bounds = np.linspace(0, 20, 21)
norm = mpl.colors.BoundaryNorm(bounds, cmap.N)

# make the scatter
scat = ax.scatter(x, y, c=tag, s=np.random.randint(100, 500, 20),
                  cmap=cmap, norm=norm)

# create a second axes for the colorbar
ax2 = fig.add_axes([0.95, 0.1, 0.03, 0.8])
cb = plt.colorbar.ColorbarBase(ax2, cmap=cmap, norm=norm,
    spacing='proportional', ticks=bounds, boundaries=bounds, format='%1i')

ax.set_title('Well defined discrete colors')
ax2.set_ylabel('Very custom cbar [-]', size=12) 
```

![在此处输入图像描述](../Images/9e4531781f5753ee55a7b0b07e9cf1a4.png)

我个人认为使用 20 种不同的颜色来读取具体值有点困难，但这当然取决于你。

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2013-02-08T16:47:41.070

你可以按照这个[例子](http://matplotlib.org/1.2.0/examples/pylab_examples/poormans_contour.html)：

```
#!/usr/bin/env python
"""
Use a pcolor or imshow with a custom colormap to make a contour plot.

Since this example was initially written, a proper contour routine was
added to matplotlib - see contour_demo.py and
http://matplotlib.sf.net/matplotlib.pylab.html#-contour.
"""

from pylab import *

delta = 0.01
x = arange(-3.0, 3.0, delta)
y = arange(-3.0, 3.0, delta)
X,Y = meshgrid(x, y)
Z1 = bivariate_normal(X, Y, 1.0, 1.0, 0.0, 0.0)
Z2 = bivariate_normal(X, Y, 1.5, 0.5, 1, 1)
Z = Z2 - Z1 # difference of Gaussians

cmap = cm.get_cmap('PiYG', 11)    # 11 discrete colors

im = imshow(Z, cmap=cmap, interpolation='bilinear',
            vmax=abs(Z).max(), vmin=-abs(Z).max())
axis('off')
colorbar()

show() 
```

这会产生以下图像：

![穷人轮廓](../Images/339caf28c60b59b13cfadaf1c97d8915.png)

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2015-02-25T22:04:23.250

上面的答案很好，除了它们在颜色栏上没有正确的刻度位置。我喜欢在颜色中间加上刻度，这样数字 -> 颜色映射就更清晰了。您可以通过更改 matshow 调用的限制来解决此问题：

```
import matplotlib.pyplot as plt
import numpy as np

def discrete_matshow(data):
    # get discrete colormap
    cmap = plt.get_cmap('RdBu', np.max(data) - np.min(data) + 1)
    # set limits .5 outside true range
    mat = plt.matshow(data, cmap=cmap, vmin=np.min(data) - 0.5, 
                      vmax=np.max(data) + 0.5)
    # tell the colorbar to tick at integers
    cax = plt.colorbar(mat, ticks=np.arange(np.min(data), np.max(data) + 1))

# generate data
a = np.random.randint(1, 9, size=(10, 10))
discrete_matshow(a) 
```

![离散颜色条示例](../Images/de0c4fc851905899039e8b5098f02c60.png)

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2013-02-08T19:38:21.473

要设置高于或低于颜色图范围的值，您需要使用颜色图的`set_over`和`set_under`方法。如果要标记特定值，请将其屏蔽（即创建屏蔽数组），然后使用该`set_bad`方法。（查看基本颜色图类的文档：http: [//matplotlib.org/api/colors_api.html#matplotlib.colors.Colormap](http://matplotlib.org/api/colors_api.html#matplotlib.colors.Colormap)）

听起来你想要这样的东西：

```
import matplotlib.pyplot as plt
import numpy as np

# Generate some data
x, y, z = np.random.random((3, 30))
z = z * 20 + 0.1

# Set some values in z to 0...
z[:5] = 0

cmap = plt.get_cmap('jet', 20)
cmap.set_under('gray')

fig, ax = plt.subplots()
cax = ax.scatter(x, y, c=z, s=100, cmap=cmap, vmin=0.1, vmax=z.max())
fig.colorbar(cax, extend='min')

plt.show() 
```

![在此处输入图像描述](../Images/fb846713827e5cd83c64245c96096b4b.png)

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2020-03-26T14:59:05.377

这个主题已经很好地涵盖了，但我想添加一些更具体的内容：我想确保某个值将映射到该颜色（而不是任何颜色）。

这并不复杂，但因为我花了一些时间，它可能会帮助其他人不会像我一样浪费太多时间:)

```
import matplotlib
from matplotlib.colors import ListedColormap

# Let's design a dummy land use field
A = np.reshape([7,2,13,7,2,2], (2,3))
vals = np.unique(A)

# Let's also design our color mapping: 1s should be plotted in blue, 2s in red, etc...
col_dict={1:"blue",
          2:"red",
          13:"orange",
          7:"green"}

# We create a colormar from our list of colors
cm = ListedColormap([col_dict[x] for x in col_dict.keys()])

# Let's also define the description of each category : 1 (blue) is Sea; 2 (red) is burnt, etc... Order should be respected here ! Or using another dict maybe could help.
labels = np.array(["Sea","City","Sand","Forest"])
len_lab = len(labels)

# prepare normalizer
## Prepare bins for the normalizer
norm_bins = np.sort([*col_dict.keys()]) + 0.5
norm_bins = np.insert(norm_bins, 0, np.min(norm_bins) - 1.0)
print(norm_bins)
## Make normalizer and formatter
norm = matplotlib.colors.BoundaryNorm(norm_bins, len_lab, clip=True)
fmt = matplotlib.ticker.FuncFormatter(lambda x, pos: labels[norm(x)])

# Plot our figure
fig,ax = plt.subplots()
im = ax.imshow(A, cmap=cm, norm=norm)

diff = norm_bins[1:] - norm_bins[:-1]
tickz = norm_bins[:-1] + diff / 2
cb = fig.colorbar(im, format=fmt, ticks=tickz)
fig.savefig("example_landuse.png")
plt.show() 
```

[![在此处输入图像描述](../Images/90904367e28f671b246c43b55db1a93d.png)](https://i.stack.imgur.com/zmlXm.png)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2019-03-08T11:30:06.790

我一直在研究这些想法，这是我的 5 美分。它避免调用`BoundaryNorm`以及指定`norm`为`scatter`and的参数`colorbar`。但是，我发现没有办法消除对`matplotlib.colors.LinearSegmentedColormap.from_list`.

一些背景是 matplotlib 提供了所谓的定性颜色图，旨在与离散数据一起使用。`Set1`，例如，有 9 种容易区分的颜色，`tab20`可以用于 20 种颜色。使用这些地图，可以很自然地使用它们的前 n 个颜色为具有 n 个类别的散点图着色，如下例所示。该示例还生成了一个带有 n 个离散颜色的颜色条，这些颜色被适当地标记了。

```
import matplotlib, numpy as np, matplotlib.pyplot as plt
n = 5
from_list = matplotlib.colors.LinearSegmentedColormap.from_list
cm = from_list(None, plt.cm.Set1(range(0,n)), n)
x = np.arange(99)
y = x % 11
z = x % n
plt.scatter(x, y, c=z, cmap=cm)
plt.clim(-0.5, n-0.5)
cb = plt.colorbar(ticks=range(0,n), label='Group')
cb.ax.tick_params(length=0) 
```

这会产生下面的图像。`n`调用中的`Set1`指定该颜色图的第一种颜色`n`，`n`调用中的最后`from_list` 一种指定用`n`颜色构造一个图（默认为 256）。为了使用 设置`cm`为默认颜色图`plt.set_cmap`，我发现有必要给它一个名称并注册它，即：

```
cm = from_list('Set15', plt.cm.Set1(range(0,n)), n)
plt.cm.register_cmap(None, cm)
plt.set_cmap(cm)
...
plt.scatter(x, y, c=z) 
```

[![具有离散颜色的散点图](../Images/5b18be1a767a57a1c16dd91e24baccf3.png)](https://i.stack.imgur.com/ZuMeZ.png)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-08T16:50:36.803

我想你想看看[colors.ListedColormap](http://matplotlib.org/api/colors_api.html#matplotlib.colors.ListedColormap)来生成你的颜色图，或者如果你只需要一个静态颜色图，我一直在开发一个可能有帮助[的应用程序。](https://github.com/ccoughlin/ColormapCreator)

# groovy - Groovy null 小于零？

> ID：14777071
> 
> 赞同：3
> 
> 时间：2013-02-08T16:29:57.077
> 
> 标签：groovy, boolean-logic

我发现在 groovy

`(null<0) == true`

我没有找到关于这种操作的文档，我不知道结果是否有效或有什么问题。

谁能告诉我更多？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-08T16:44:02.653

null 不仅小于零，而且还小于一切：

```
assert null < Integer.MIN_VALUE 
```

所有比较运算符在 groovy 中都是 null 安全的，并且 null 始终小于任何非 null 值。这里有一些关于比较运算符的文档：http: [//groovy.codehaus.org/Operator+Overloading](http://groovy.codehaus.org/Operator+Overloading)。

# javascript - 单击时隐藏的标题下拉

> ID：14777074
> 
> 赞同：0
> 
> 时间：2013-02-08T16:30:05.083
> 
> 标签：javascript, css

对于我正在开发的网站，当您单击隐藏的 div 下拉信息时，我非常想使用与此处[http://shop.jack-hughes.com/类似的下拉效果。](http://shop.jack-hughes.com/)

我不知道它是否只使用 CSS3 或 Javascript/CSS 谁能指出我正确的方向或告诉我效果的名称；我想很简单，但我一生都找不到另一个例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T16:38:45.073

他们有一小段 Javascript 可以做到这一点，可以在任何网站上轻松完成。基本上，您需要在页面顶部隐藏一个 div，单击链接后，您只需显示该 div。

他们使用的代码是：

```
Event.observe('info', 'click', function(){
    $('aside').toggleClassName('open');
}); 
```

但是如果你看一下[jquery](http://jquery.com/)，你会发现元素的操作很容易做到。

他们另外使用的一件事是他们`open`班级中的 CSS3 过渡：

```
.aside {
     transition: all 0.3s ease-out 0s
} 
```

这就是导致平滑过渡效果的原因。因此，您可以使用 jQuery 或 CSS3 过渡，两者都提供相同的效果。我会说 CSS3 过渡更好，但是如果某些浏览器不支持过渡，您将再次疏远它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T16:39:51.573

可能使用jQuery。就像是：

[http://api.jquery.com/toggle/](http://api.jquery.com/toggle/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T16:42:03.060

CCS3和js的结合

这是您引用的网站中使用的内容

**js**：

```
Event.observe(window, 'load', function () {
    Event.observe('info', 'click', function () {
        $('aside').toggleClassName('open');
    });
}); 
```

`Event.observe`来自 **原型**框架 - [http://prototypejs.org/doc/latest/dom/Event/observe/](http://prototypejs.org/doc/latest/dom/Event/observe/)

例如，jQuery( [http://jquery.com/](http://jquery.com/) ) 中的等价物是：

```
$(document).ready(function () {
    $('.info').click(function () {
        $('aside').toggleClass('open');
    })
}); 
```

**CSS**：

```
aside.open {
    height: 21.25em;
}

aside {
    position: relative;
    background-color: #3f4642;
    width: 100%;
    color: white;
    letter-spacing: 0.1em;
    -webkit-transition: all 0.3s ease-out;
    -moz-transition: all 0.3s ease-out;
    -ms-transition: all 0.3s ease-out;
    -o-transition: all 0.3s ease-out;
    transition: all 0.3s ease-out;
} 
```

HTML 元素是`<aside>....</aside>`，但如果您选择 div，则没有区别。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T16:43:29.087

除了 Deif 发现的内容之外，他们还使用 CSS 过渡

```
transition: all 0.3s ease-out; 
```

并且还为他们的“aside”类使用“::selection”伪类，参见[developer.mozilla.org](https://developer.mozilla.org/en-US/docs/CSS/%3a%3aselection)

# c# - 自引用导航属性和json序列化

> ID：14777084
> 
> 赞同：2
> 
> 时间：2013-02-08T16:30:40.943
> 
> 标签：c#, json, entity-framework, asp.net-web-api, navigation-properties

我有一个公开用户的 Web API。

每个用户都有一个经理，他也是一个用户。

在我的 EDMX 中，我在“用户”实体上有一个 self 1..* 导航属性，它是从经理到用户的导航的“协作者”，也是从用户到他的经理的导航的“经理”。

我的 JSON API 使用 NewtonJSON 来序列化实体。

为了自定义 API 调用的 JSON 结果，我在查询字符串中实现了关键字“字段”。使用“字段”可以获取用户的部分 JSON 表示。

调用如下所示：/api/users?fields=id,name,department,picture

你会从一个完整的 C# 用户对象中得到一个只有 id、name、department 和 picture 属性的 JSON。

我已经使用 IContractResolver 的自定义实现来实现这一点。

问题是 NewtonJSON 合约解析器“按类型”而不是“按对象”工作，这意味着您可以告诉序列化程序序列化声明类型的此类成员而不是另一个成员，但您不能告诉它（如据我所知，这就是我在这里问的原因）序列化这种类型的该对象的此类成员，而不是同一类型的另一个对象上的相同成员。

也就是说，我的问题是当我要求：/api/users?fields=id,name,manager

我在每个用户对象上通过管理器成员的递归序列化得到响应，如下所示：

```
[{
    id: 123,
    name: "Foo",
    manager:
    {
        id: 124,
        name: "Foo",
        manager:
        {
            id: 125,
            name: "Foo",
            manager:
            {
            ...
            }
        }
    }
},
{
    id: 124,
    name: "Foo",
    manager:
    {
        id: 125,
        name: "Foo",
        manager:
        {
        ...
        }
    }
},
{
    id: 125,
    name: "Foo",
    manager:
    {
    ...
    }
}] 
```

我还实现了请求部分子实体响应的能力，如下所示：

/api/users?fields=id,name,manager.id

但是由于主对象（这里是用户）和子对象（经理）都属于同一类型，因此它不起作用。

是否有人已经使用 NewtonJSON 来实现部分响应 Web API？您如何设法使用嵌入式自我类型实体？

谢谢你的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T19:36:30.033

您可以编写一个动作过滤器来理解字段参数并转换响应。我有一个将响应对象转换为字典的示例实现。键是客户端询问的字段，值是响应中返回的对象的字段值。该实现是一个示例，还远未完成:)

```
public class FieldFilterAttribute : ActionFilterAttribute
{
    public override void OnActionExecuted(HttpActionExecutedContext actionExecutedContext)
    {
        var fieldsParameter = actionExecutedContext.Request.GetQueryNameValuePairs().Where(kvp => kvp.Key == "fields");
        if (fieldsParameter.Count() == 1)
        {
            object response;
            object newResponse;

            if (actionExecutedContext.Response.TryGetContentValue(out response))
            {
                string[] fields = fieldsParameter.First().Value.Split(',');

                IEnumerable<object> collection = response as IEnumerable<object>;
                if (collection != null)
                {
                    newResponse = collection.Select(o => SelectFields(fields, o));
                }
                else
                {
                    newResponse = SelectFields(fields, response);
                }

                actionExecutedContext.Response = actionExecutedContext.Request.CreateResponse(HttpStatusCode.OK, newResponse);
            }
        }
    }

    private static Dictionary<string, object> SelectFields(string[] fields, object value)
    {
        Dictionary<string, object> result = new Dictionary<string, object>();

        foreach (string field in fields)
        {
            result.Add(field, GetValue(field, value));
        }

        return result;
    }

    private static object GetValue(string indexer, object value)
    {
        string[] indexers = indexer.Split('.');

        foreach (string property in indexers)
        {
            PropertyInfo propertyInfo = value.GetType().GetProperty(property);
            if (propertyInfo == null)
            {
                throw new Exception(String.Format("property '{0}' not found on type '{1}'", property, value.GetType()));
            }

            value = propertyInfo.GetValue(value);

            if (value == null)
            {
                return null;
            }
        }

        return value;
    }
} 
```

# ios - 在 iOS 6 上显示的视图消失了。我该如何解决？

> ID：14777087
> 
> 赞同：0
> 
> 时间：2013-02-08T16:30:46.687
> 
> 标签：ios, objective-c, ipad, ios6

我从视图控制器呈现了两个视图：一个用于设置，一个用于设备日志。当我在 iPad 上运行应用程序并呈现视图，然后旋转设备时，视图消失了。

如果我以纵向（任何一个）呈现视图（使用按钮）并旋转它，它就会消失。如果我再次呈现视图，它会重新出现，然后正确旋转。

为什么会这样？我能做些什么来修复它？

感谢您的任何回复。

更新：仅当我首先以纵向模式呈现视图时才会发生这种情况。如果我首先以横向模式呈现它，它会很好地旋转并且不会消失。

在我的主视图控制器的 viewDidLoad 中：

```
self.logViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"LogViewController"];
[self.logViewController setModalInPopover:YES];
[self.logViewController setModalPresentationStyle:UIModalPresentationFormSheet];
[self.logViewController setModalTransitionStyle:UIModalTransitionStyleFlipHorizontal]; 
```

按下 Log 按钮时调用我的方法：

```
- (void)showInfoView:(id)sender
{
    [self presentViewController:self.logViewController animated:YES completion:NULL];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:46:05.850

我已经意识到我做错了什么。我在 SplitViewController 中从我的主视图中呈现呈现的视图控制器。通过从详细信息视图中呈现它，问题得到了解决。

# php - 符号链接中的 php 文件处理不起作用

> ID：14777090
> 
> 赞同：1
> 
> 时间：2013-02-08T16:30:51.993
> 
> 标签：php, apache, symlink, file-handling

我在使用符号链接的 apache2 服务器上遇到了一些麻烦。

基本 www 文件夹位于“/var/www//htdocs”中。我对“/var/www//htdocs/l/”做了一个符号链接表格/home//log”并将其称为“log”。

在我看来，www-data 用户和 .

在我的脚本中，我收到了这个错误：

```
Warning: fopen(): open_basedir restriction in effect.File(/var/www/<domain>/htdocs/l/log/logs_test.log) is not within the allowed path(s): (/var/www/<domain>:/usr/share/pear:/usr/share/php:/tmp:/usr/share/phpmyadmin) in /var/www/<domain>/htdocs/l/test.php on line 7 Warning: fopen(/var/www/<domain>/htdocs/l/log/logs_test.log): failed to open stream: Operation not permitted in /var/www/<domain>/htdocs/l/test.php on line 7 
```

当我在 apache2.conf 中添加来自符号链接的真实路径时，应该可以解决这个问题。但是，这是我的问题：我不会为每个符号链接添加真实路径。

我希望您能理解我的问题，如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T16:36:42.697

是的，问题在于 PHP 中的 open_basedir 安全限制。如果要在指定目录树之外打开文件，只需放宽限制即可。在此处阅读有关如何执行此操作的更多选项：

[http://www.php.net/manual/en/ini.core.php#ini.open-basedir](http://www.php.net/manual/en/ini.core.php#ini.open-basedir)

# visual-studio-2010 - 如何在 Visual Studio 2010 中将文档映射添加到 RDLC（又名 SSRS）报告？

> ID：14777093
> 
> 赞同：2
> 
> 时间：2013-02-08T16:30:55.657
> 
> 标签：visual-studio-2010, reporting-services, report, rdlc, rdl

也许我遗漏了一些明显的东西，但我找不到从 Visual Studio 2010（或独立的“Report Builder 2.0”）中将文档映射添加到 RDLC 文件的方法。

我以前的版本，例如 2005 和 2008，这是一个简单的问题，将文档地图标签添加到报表项。但是属性“文档地图标签”不再存在。

此外，我也找不到添加书签的方法。

如果有人能对此有所了解，那就太好了！！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T00:24:44.683

我不确定你指的是哪个版本。Visual Studio 2010 不支持 Business Intelligence Development Studio (BIDS) 如果您从 SQL Server 2008 R2 磁盘安装 BIDS，它将安装 Visual Studio 2008 的 shell。如果您已经有 Visual Studio 2010，安装 BIDS 仍将安装 2008 shell Visual Studio 的，如果您尝试制作 BI 项目，将加载它。如果从 SQL Server 2012 安装它，它将安装使用 Visual Studio 2010 Shell 的 SQL Server Data Tools (SSDT)。我想这就是你说的版本。

我已经从 SQL Server 2008R2 检查了我的 BIDS 版本，并且添加到报表中的所有对象都具有 DocumentMapLabel 属性。我还刚刚从 SQL 2012 检查了我的 SSDT，并且该属性仍然存在。在报告中选择一个对象并查看“其他”下的属性窗口。

![在此处输入图像描述](../Images/b8dec26350e0e14d70f0398a11158119.png)

# ruby-on-rails - Rails 时间戳保存

> ID：14777095
> 
> 赞同：0
> 
> 时间：2013-02-08T16:31:03.563
> 
> 标签：ruby-on-rails, ruby

我有一个应用程序帽子需要每 5 分钟更新一次，我在应用程序控制器中有这个：

```
# update last action & yet to implement updating vitals
def page_update
  if current_user
    current_user.last_page_load = DateTime.now
    interval = 300
    ime_difference = Time.now.to_i - current_user.vitals_update
    updates = time_difference / interval
    # use updates as a multiplier here for any data

    current_user.vitals_update = Time.now.to_i
    current_user.save
  end
end 
```

目的是存储上次更新的时间戳并计算任何更改的乘数。某些原因我遇到了时间戳问题，我不知道该怎么做。

我试过输出没有运气的值，当我尝试设置时似乎

```
current_user.vitals_update = Time.now.to_i 
```

我收到一条错误消息

> 387426 的未定义方法“更改”：Fixnum

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:16:24.400

对于这种任务，最好使用 rails`touch`方法，如this answer中所述。
[Rails 2.3.2 中的“触摸”updated_at 列](https://stackoverflow.com/questions/1091311/touch-updated-at-column-in-rails-2-3-2)

# spring - jar 的 META-INF 文件夹中的 pom.xml 的用途是什么？

> ID：14777097
> 
> 赞同：4
> 
> 时间：2013-02-08T16:31:06.367
> 
> 标签：spring, maven, pom.xml

通常，maven 构建的 jar 工件将它的 pom 包含在`META-INF`. 我最近注意到 Spring jars 没有这个。所以，这让我想知道那个 pom 的目的。

似乎 maven 在执行需要了解工件元数据的事情时（例如，在确定依赖关系时）直接从存储库中检索 pom。

那么，嵌入式有什么用呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T16:47:15.453

文档提出了这个位置的 pom的`Maven`两个原因。

1) 仅供参考，方便。正如文档所说，它使工件“自我描述”

2) 您可以使用 Java 从您的应用程序中获取此信息。这使 arfiact 能够在应用程序中自动报告其版本。

*   [http://maven.apache.org/guides/getting-started/index.html](http://maven.apache.org/guides/getting-started/index.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T16:49:21.283

您将在存储库中找到的 pom 不一定是用于构建工件的 pom。它面向工件的用户，可以在构建工件时进行自定义。

包含在工件中的那个是用于生产工件的那个。可以选择不将其包含在工件中。

# .net - Intuit 合作伙伴平台服务不可用错误

> ID：14777098
> 
> 赞同：0
> 
> 时间：2013-02-08T16:31:08.130
> 
> 标签：.net, intuit-partner-platform, customer-account-data-api

我安装了 Intuit 合作伙伴平台的示例应用程序。我单击“添加帐户”，选择机构，然后当我尝试登录时，调用 DiscoverAndAddAccounts 时出现错误“服务不可用”：

```
List<Credential> credentials = new List<Credential>();
foreach (Control control in LoginControls.Controls)
{
    if (control as TextBox != null)
    {
        Credential cred = new Credential();
        TextBox loginValue = (TextBox)control;
        cred.name = loginValue.Attributes["KeyName"];
        cred.value = loginValue.Text;
        credentials.Add(cred);
    }
}
creds.credential = credentials.ToArray();
instLogin.AnyIntuitObject = creds;

Challenges challenges = null;
ChallengeSession challengeSession = null;
AccountList accountList = svc.DiscoverAndAddAccounts(long.Parse(Request.QueryString["InstitutionID"].ToString()), instLogin, out challenges, out challengeSession); 
```

任何人都可以解释什么是错的？我在登录名和密码中写了“测试”。

# c# - 我是否在我的一个页面中滥用了来自 WebMatrix 的 AntiForgery.Validate 帮助程序？

> ID：14777101
> 
> 赞同：2
> 
> 时间：2013-02-08T16:31:18.247
> 
> 标签：c#, html, forms, security, webmatrix

在看到 AntiForgery.Validate() 方法错误（当表单令牌未验证时应该这样做）并访问此站点后：http: [//msdn.microsoft.com/en-us/library/system。 web.helpers.antiforgery(v=vs.111).aspx](http://msdn.microsoft.com/en-us/library/system.web.helpers.antiforgery%28v=vs.111%29.aspx) 了解更多信息，看来我过去可能误用了它。

我使用了 AntiForgery.GetHTML(); 的组合。和 AntiForgery.Validate(); 在登录页面上，但不确定将其放在那里是否有意义。在没有登录的情况下，用户始终是“”（空字符串），所以我想我最初认为使用 AntiForgery 类的作用比实际作用更多。因此，我的问题是：

我是否正确假设上述做法执行的唯一安全检查只是确保（通过将 AntiForgery.Validate(); 放在 if(IsPost) 分支中）提交表单的用户与之前的用户相同页面加载时登录？

如果是这样，那么，我是否也正确地假设以这种方式使用此类在登录页面中没有位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T04:57:34.740

如果您查看 codeplex 上的源代码，[AntiForgery](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/a19eb63170f9#src/System.Web.WebPages/Helpers/AntiForgery.cs)使用使用[TokenValidator的](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/a19eb63170f9#src/System.Web.WebPages/Helpers/AntiXsrf/AntiForgeryWorker.cs)[AntiForgeryWorker](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/a19eb63170f9#src/System.Web.WebPages/Helpers/AntiXsrf/TokenValidator.cs)，该`ValidateTokens`方法确实会进行一些身份和用户名检查。如果您没有抛出异常，它可能正在执行某种级别的验证，但使用“”作为用户名。

```
if (!String.Equals(fieldToken.Username, currentUsername, (useCaseSensitiveUsernameComparison) ? StringComparison.Ordinal : StringComparison.OrdinalIgnoreCase))
{
    throw HttpAntiForgeryException.CreateUsernameMismatchException(fieldToken.Username, currentUsername);
} 
```

但是，“伪造”登录页面的用例是什么？如果伪造者知道要提交的凭据，他们就可以自己登录。如果 AntiForgery 在这里不能发挥其全部潜力，这可能并不重要。

# iphone - 运行 iPhone App 帮助时出错 - __NSCFConstantString 错误含义

> ID：14777108
> 
> 赞同：1
> 
> 时间：2013-02-08T16:31:37.310
> 
> 标签：iphone, objective-c, xcode, error-handling

有人可以告诉我这是什么意思：

```
2013-02-08 11:19:49.394 xxxxx[10545:907] set selected tab with tag 3
2013-02-08 11:19:49.560 xxxxx[10545:907] did select item
2013-02-08 11:19:49.562 xxxxx[10545:907] tab clicked
2013-02-08 11:19:49.566 xxxxx[10545:907] will show view controller MoreViewController
2013-02-08 11:19:49.567 xxxxx[10545:907] will show other VC

2013-02-08 11:19:49.579 xxxxx[10545:907] -[__NSCFConstantString offImage]: unrecognized selector sent to instance 0x21994c
2013-02-08 11:19:49.580 xxxxx[10545:907] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFConstantString offImage]: unrecognized selector sent to instance 0x21994c' 
```

我只是尝试修改一些代码，但是修改不起作用。所以按下 z 并撤消我修改的所有内容，但现在我收到此错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T16:35:43.370

“无法识别的选择器发送到实例”错误总是意味着一件事：您正在调用不支持它的实例上的方法。在这种特殊情况下，您的代码中有一行如下所示：

```
[someObject offImage]; 
```

在这一行，`someObject`是字符串的一个实例，它没有`offImage`方法。

将错误类型的对象传递给其他方法可能会导致此问题：

```
[someTarget objectWithOffImage:@"Hello"]; 
```

该方法可能需要一个响应 的对象`offImage`，但您正在向它传递一个字符串。

最后，您可能正在尝试调用*category*中的方法，但您忘记导入该类别的头文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T16:34:12.747

您正在将消息发送到没有具有该名称的方法`-offImage`的实例。`NSString`更改您的代码，以便将`-offImage`其发送到正确类型的对象

# wireshark - 802.11 数据包中的 RSSI 值是多少

> ID：14777114
> 
> 赞同：1
> 
> 时间：2013-02-08T16:32:01.503
> 
> 标签：wireshark, wifi

`SSI signal`在查看时，我看到了in `802.11`packet的两个值`wireshark`。我想知道哪一个值是正确的`RSSI value`

信息来自`wireshark`：

```
SSI Signal: -40 dBm
SSI Noise: -100 dBm
Signal Quality: 64
Antenna: 0
SSI Signal: 60 dB 
```

另请注意，SSI 信号（第二次）是（（SSI 信号）-（SSI 噪声））

我只是很困惑哪个是正确的。[维基百科条目](http://en.wikipedia.org/wiki/Received_signal_strength_indication)还告诉这些实现可能取决于供应商。我完全不知道哪个是正确的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-04-08T09:22:16.173

用一点盐来回答我的答案-这对我来说是有意义的，不一定是正确的..如果对您有意义的话。

第一个 SSI 信号是测量 Rx 天线处/之后的 Rx 信号强度（它在 ADC 阶段进行此计算）

SSI 噪声是 ADC 阶段的噪声（可能是测量噪声）。

第二个 SSI 信号是 SNR，这将是原始 SSI Siganl - SSI 噪声 = 60 dB - 这个差异将是 60 dB 而不是 dBm - 你得到的方法是在减法之前将两个值转换为 dB。你不需要这样做，但你仍然会得到相同的幅度，只要确保使用 dB 作为单位。

根据 IEEE 定义，它们实际上都不是 RSSI——RSSI 被定义为两个值之间的数字。它没有 dBm 单位，尽管现在许多流行的应用程序给它一个 dBm 值，这导致了严重的混乱。思科使用 0-100 之间的值，atheros 0 到 127 等。因此按照这种逻辑，这种情况下的 RSSI 可能是信号质量 -64。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-08T09:25:50.107

用一点盐来回答我的答案-这对我来说是有意义的，不一定是正确的..如果对您有意义的话。

第一个 SSI 信号是测量 Rx 天线处/之后的 Rx 信号强度（它在 ADC 阶段进行此计算）

SSI 噪声是 ADC 阶段的噪声（可能是测量噪声）。

第二个 SSI 信号是 SNR，这将是原始 SSI Siganl - SSI 噪声 = 60 dB - 这个差异将是 60 dB 而不是 dBm - 你得到的方法是在减法之前将两个值转换为 dB。现在，你不需要做我在减法之前提到的dB转换，你仍然会得到相同的幅度，只要确保使用dB作为单位。

继续前进，回答您的具体问题，根据 IEEE 定义，它们实际上都不是 RSSI - RSSI 被定义为两个值之间的数字。它没有 dBm 单位，尽管现在许多流行的应用程序给它一个 dBm 值，这导致了严重的混乱。思科使用 0-100 之间的值，atheros 0 到 127 等。因此按照这种逻辑，这种情况下的 RSSI 可能是信号质量 -64。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-21T23:10:56.043

> 在 Wireshark 中查看时，我在 802.11 数据包中看到了两个 SSI 信号值

听起来好像用于捕获数据包的 802.11 适配器的驱动程序很奇怪，并且提供了[以 dBm 为单位的天线信号强度](http://www.radiotap.org/defined-fields/Antenna%20signal)和[以 dB](http://www.radiotap.org/defined-fields/dB%20antenna%20signal)为单位的天线强度。那是什么类型的适配器，运行捕获的机器是什么操作系统？

如上面的链接所示，“dBm”是 1 毫瓦功率的分贝；正如上面的另一个链接所示，“dB”是某个未指定的任意点的分贝。dBm 告诉您天线处的实际信号功率；dB 没有 - 您只能使用 dB 值与其他 dB 值进行比较。

*这些都不*是 802.11 定义的“RSSI”；RSSI 值也是任意的，但*更加*任意 - 802.11 甚至没有说明它测量的是什么，只是较大的值对应于更强的信号，并且这些值*取决于*供应商。

> 另请注意，SSI 信号（第二次）是（（SSI 信号）-（SSI 噪声））

您的适配器驱动程序的编写者可能没有正确阅读有关“dB 天线信号”值（如上链接）的 Radiotap 页面，并且可能认为它应该是信噪比，并通过以下方式计算得出从信号值中减去噪声值（分贝是对数刻度，两个值的商是这些值的对数之间的差）。我会忽略该值，并使用“SSI 信号”作为以毫瓦为单位的信号强度指示（-40 dBm = 100 纳瓦，至少根据[维基百科关于 dBm 的文章](https://en.wikipedia.org/wiki/DBm)中的表格）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-06T23:58:39.553

根据链接（2016 年 6 月 10 日） [http://www.radiotap.org/suggested-fields/RSSI](http://www.radiotap.org/suggested-fields/RSSI)

RSSI 仍然是仅可用于 OpenBSD 操作系统的“建议”字段。

（我试图用 AirPcap 和 Windows 机器获得相同的信息）

# android - PopupWindow 中 GridView 的 setOnItemClickListener 不起作用

> ID：14777118
> 
> 赞同：3
> 
> 时间：2013-02-08T16:32:21.263
> 
> 标签：android, gridview, popupwindow, onitemclicklistener

如果我在正常的 Activity 中有一个**GridView ，它可以正常工作。**但是在这里，我将它放在**PopupWindow**中，并且我尝试了一切以使其正常工作，但是不会调用 onItemClick ！我尝试了以下方法，这对大多数人来说都是解决方案，但*它们对我不起作用*（也许我滥用了它们？）：

```
android:clickable="false"
android:focusable="false"
android:focusableInTouchMode="false"
android:descendantFocusability="blocksDescendants" 
```

部分活动：

```
bgGrid.setAdapter(new ImageAdapter(context));
bgGrid.setOnItemClickListener(new OnItemClickListener() {
    public void onItemClick(AdapterView<?> arg0, View v, int position, long id) {
        Log.v("CLICK", "ITEM SELECTED " + position);
    }
});
pw = new PopupWindow(layout, posx, posy);
pw.setOutsideTouchable(false);
pw.showAtLocation(layout, Gravity.CENTER, 0, 0); //bgGrid is part of layout 
```

和xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#444444"
    android:orientation="vertical"
    android:padding="5dip" >
<GridView
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@+id/gridview"
            android:layout_width="fill_parent"
            android:layout_height="0dp"
            android:layout_weight="1"
            android:columnWidth="160dp"
            android:gravity="center"
            android:horizontalSpacing="10dp"
            android:numColumns="auto_fit"
            android:stretchMode="columnWidth"
            android:verticalSpacing="10dp" >
        </GridView>
    <Button
        android:id="@+id/popup_close"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:onClick="closePopup"
        android:text="Close" />
</LinearLayout> 
```

图像适配器

```
public class ImageAdapter extends BaseAdapter {
    private Context mContext;

    public ImageAdapter(Context c) {
        mContext = c;
    }
    public int getCount() {
        return mThumbIds.length;
    }
    public Object getItem(int position) {
        return null;
    }
    public long getItemId(int position) {
        return 0;
    }
    public View getView(int position, View convertView, ViewGroup parent) {
        ImageView imageView;
        if (convertView == null) {  mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            imageView = new ImageView(mContext);
            imageView.setLayoutParams(new GridView.LayoutParams(160, 120));
            imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
        } else {
            imageView = (ImageView) convertView;
        }
        imageView.setImageResource(mThumbIds[position]);

        return imageView;
    } 
```

整个弹出部分位于 PereferenceActivity 中，其中我有一个侦听器，它检测到对 Preference 的点击并打开 Popup。显然只能有一个监听器，我无法将 onClick 设置为 Preference，所以我不知道如何解决这个问题（onPreferenceClick 永远不会检测到任何点击）。调用弹出窗口的第一个侦听器（我可以获得该点击的唯一方法）：

```
images = (Preference) findPreference("prefs_bg");
images.setOnPreferenceClickListener(new BackgroundColorSelector()); 
```

点击显示在屏幕上（我什至尝试过drawSelectorOnTop），但无论如何，点击都不会通过。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-26T03:15:06.507

最近遇到这个问题并在这里找到了解决方案

popupWindow.setFocusable(true);

解决方案重复问题： [无法在 PopupWindow 中为 GridView 执行 OnItemClick](https://stackoverflow.com/questions/2107235/cannot-execute-onitemclick-for-gridview-in-popupwindow/2107315#2107315)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-06T05:13:40.957

我为我找到了一个完美的解决方案：

```
popUpWindow.setOutsideTouchable(true);
popUpWindow.setBackgroundDrawable(getResources().getDrawable(android.R.color.white));
popUpWindow.setFocusable(true); 
```

第一行在弹出窗口外启用触摸事件。

没有第二行触摸事件将被弹出窗口阻止。

第三行解决了你的问题。

如果没有第一个和两个，当弹出窗口之外发生时，用户界面将不会响应任何触摸/单击事件。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-08T19:00:54.733

确保您的 ImageAdapter 正在膨胀的布局没有注册任何 OnItemClickListeners 和/或在适配器布局上设置 android:focussable=false。

如：

```
<ImageView
android:id="@+id/imageViewIcon"
android:layout_width="wrap_content"
android:layout_height="wrap_content" 
android:focussable=false 
/> 
```

# c# - 在 Paypal 摘要中添加换行符

> ID：14777121
> 
> 赞同：2
> 
> 时间：2013-02-08T16:32:23.363
> 
> 标签：c#, newline, paypal

我正在尝试`<br />`在贝宝中添加一个 html 标签`SetExpressCheckoutRequestDetailsType.OrderDescription`

我正在使用 C# 和自定义购物车，这是我的代码

```
SetExpressCheckoutRequestDetailsType test = new SetExpressCheckoutRequestDetailsType();       
test.OrderDescription = ShoppingCart().Replace("each", "<br />"); 
```

我已将所有购物车项目信息放在 orderDescription 中，并希望在每个项目之间添加一个换行符。

我也试过`\r\n`and `System.Environment.NewLine`，它们都不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:45:24.527

你想做的事情在你试图做的方式中是不可能的。如果您希望在摘要中显示多个项目，则需要将多个项目发送到 Paypal。他们没有提供任何将换行符放入给定字段的机制，如果他们不提供它就无法完成。

订单描述字段用于对您的订单进行总体总结。要包含多个产品，您需要在字段中包含多个`PaymentDetailsItemType`对象。`test.PaymentDetails.PaymentDetailsItem`

# javascript - 骨干集合网址

> ID：14777124
> 
> 赞同：0
> 
> 时间：2013-02-08T16:32:28.277
> 
> 标签：javascript, backbone.js, backbone-views

我使用 Backbone.js

我正在尝试从服务器获取我的数据，但它不起作用

```
var Message = Backbone.Model.extend({});

var MessageStore = Backbone.Collection.extend({
    model: Message,
    url: myUrl
});

var messages = new MessageStore();
messages.fetch()
console.log(messages) 
```

（服务器发送 json 对象）

我搜索但没有回应

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T16:38:35.157

`Collection.fetch`是一个异步操作。当您尝试记录集合时，请求尚未完成，并且集合仍然是空的。

您需要等待 HTTP 请求返回。为此，有`success`回调：

```
var messages = new MessageStore();
messages.fetch({
  success: function() {
    console.log(messages)
  }
}); 
```

# java - 在项目的构建路径中包含外部库（jar）对性能的影响

> ID：14777126
> 
> 赞同：3
> 
> 时间：2013-02-08T16:32:29.503
> 
> 标签：java, performance, build, jar

有很多辅助外部库可以包含在 Java 项目中，如**Google Guava、Apache commons 等**。包括很多这些有什么缺点，它会对项目的性能产生影响还是过度杀戮。

根据您要使用多少外部库来决定是否要将其包含在项目中，但除此之外还有其他需要考虑的问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T16:37:29.613

加载大量库最终可能会破坏您的 permgen 空间（存储类定义的位置），即使您不使用 jar 中的某个类，静态方法/字段也可能会占用大量内存。但在实践中，这通常不会成为问题，除非您使用非常受限的设备（例如嵌入式）。

然而，一个不同的问题是，有更多的库：

*   跟踪真正需要什么和不需要什么变得更加困难，即可维护性
*   您可能会对每个库的漏洞敞开心扉
*   项目中未知变量的数量增加，这可能会导致不可预测的行为或更长的错误搜寻

但是很有可能开源、长期维护的库比我们任何人在前几个版本中编写的东西质量要好得多。

总而言之：保持整洁和精简是一件好事，但不要实现一个库会为你做的代码，只是为了避免包含那个库！

也就是说，我确信这有可能引发意见战，所以看看其他人怎么说！

# r - 将shapefile从多边形转换为点？

> ID：14777129
> 
> 赞同：2
> 
> 时间：2013-02-08T16:32:38.100
> 
> 标签：r, gis, polygon, point, shapefile

我有一个基于非重叠多边形`shapefile (.shp)`的大空间范围和许多相关属性。shapefile 以 UTM 投影。我想*将多边形转换为*分辨率网格中间隔开的点`30-m`，其中每个点都将保留它所在的多边形的属性。

输出将只是一个点表：

```
X, Y, attribute1, attribute2, attribute 3,etc... 
```

理想情况下，我希望在 R 中执行此操作，或者（不太理想）我可以在 Mac 上运行的其他一些免费程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T18:25:11.080

**注意：**我抛出这个部分是为了了解是否有更优雅的方式来做这些。所以，请空间类型，提出任何改进建议。

（特别是第 2 步，它设置了一个`"SpatialPoints"`网格，其中包含将提取值的点，对我来说似乎总是令人痛苦地低级。）

* * *

这用于从包含在为此目的构建的对象中的坐标中`over()`提取属性。`"SpatialPolygonDataFrame"``"SpatialPoints"`

```
library(rgdal)

## (1) Read in an example shapefile
dsn <- system.file("vectors", package = "rgdal")[1]
scot_BNG <- readOGR(dsn=dsn, layer="scot_BNG")
scot_BNG <- scot_BNG[1:5,]  # Let's just use part of it

## (2) Set up a SpatialPoints object with the grid of points 
##     for which you want to extract values
res <- 10000            ## Distance between grid points (30 in OP's question) 
BB <- bbox(scot_BNG)
BB <- res*round(BB/res) ## Pretty up the bounding box
GT <- GridTopology(cellcentre.offset = BB[,1], 
                   cellsize = c(res, res),
                   cells.dim = (c(diff(BB[1,]), diff(BB[2,]))/res) + 1)
SP <- SpatialPoints(GT, proj4string = CRS(proj4string(scot_BNG)))

## (3) Extract the values
vals <- over(SP, scot_BNG)
res <- cbind(coordinates(SP), vals)

## Finally, have a look at a few of the points.
x <- res[!is.na(res$SP_ID),]
rbind(head(x,3), tail(x,3))[1:10]
#          x      y SP_ID       NAME ID_x COUNT   SMR  LONG  LAT    PY
# 4   230000 970000     0 Sutherland   12     5 279.3 58.06 4.64 37521
# 5   240000 970000     0 Sutherland   12     5 279.3 58.06 4.64 37521
# 25  220000 960000     0 Sutherland   12     5 279.3 58.06 4.64 37521
# 425 260000 780000     4   Bedenoch   17     2 186.9 57.06 4.09 27075
# 426 270000 780000     4   Bedenoch   17     2 186.9 57.06 4.09 27075
# 427 280000 780000     4   Bedenoch   17     2 186.9 57.06 4.09 27075 
```

# vb.net - Windows 8 Metro/沉浸式应用程序 - 强制终止

> ID：14777131
> 
> 赞同：0
> 
> 时间：2013-02-08T16:32:45.273
> 
> 标签：vb.net, microsoft-metro, windows-runtime, terminate

我正在将应用程序从 iOS 移植到 WinRT/8 Metro/8 Immersive/无论当前名称是什么。

在 iOS 上，我们可以设置`Application does not run in background`为`YES`让应用在用户离开应用时实际退出。

我想弄清楚如何在 WinRT 中复制这种行为。

1.  是的，我了解这是异常行为。
2.  是的，我已经考虑过了。
3.  是的，我这样做有一个非常好的理由。

我假设在`userLeavingApp`活动期间，我只会打电话`Application.Current.Exit()`，但我似乎无法找到该`userLeavingApp`活动。我曾考虑`OnSuspending`在 App.xaml.vb 中使用 (Handles Me.Suspending)，但这对我来说似乎调用得不够快。

是否有 .NET 等价物`viewWillDisappear`？

有任何想法吗？这是我的应用程序的一个重要安全特性，我不想因为这么小的问题而在整个平台上遇到这样的困难。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T19:01:00.600

我实际上并没有看到 Application.Current.Exit() 在 OnSuspending 中工作；尽管正如您提到的，暂停对您来说发生得不够快（这是设计使然）。在那里抛出异常对我也不起作用。

有[Window.VisibilityChanged](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/windows.ui.xaml.window.visibilitychanged.aspx)，如果我在那里发出退出/异常，它会在另一个应用程序接管时关闭应用程序。也就是说，VisibilityChanged 在其他情况下也会触发，因此不确定您是否可以涵盖所有场景或依赖它们不改变。 有关更多上下文，[请参见此处。](http://msdn.microsoft.com/en-us/library/windows/apps/hh464925.aspx#app_visibility)

为了回应刚刚出现的@Filip，您不太可能通过认证。Exit() 调用等同于异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T18:39:19.610

如果您致电，我认为您的应用不会通过认证`Application.Current.Exit()`。如果你真的有信心这就是你想要的——我想值得一试。您可以在退出时简单地卸载任何使用内存/CPU 的东西。

# c# - 使用 Roslyn 2012 年 9 月 CTP 声明 var 变量

> ID：14777133
> 
> 赞同：2
> 
> 时间：2013-02-08T16:33:00.400
> 
> 标签：c#, roslyn

这里还有其他[问题](https://stackoverflow.com/questions/8400248/how-do-i-declare-a-var-variable-with-roslyn)似乎解决了旧版本 CTP 的问题，但它们似乎不再适用于最新版本。我试图弄清楚如何将声明从 int 更改为 var。SyntaxKind.VarKeyword 不再对我可用。

```
Syntax.VariableDeclaration(
    Syntax.PredefinedType(Syntax.Token(SyntaxKind.IntKeyword)),
    Syntax.SeparatedList(Syntax.VariableDeclarator(Syntax.Identifier(name))))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:25:33.270

`var`实际上不是语言中的关键字，因此我们将其删除。您可以简单地创建一个名为“var”的标识符，这样就可以了。但是请注意，如果在范围内碰巧有一个名为 var 的类型，则会使用该类型。

就像是：

```
Syntax.VariableDeclaration(
    Syntax.IdentifierName("var"),
    Syntax.SeparatedList(Syntax.VariableDeclarator(Syntax.Identifier(name)))) 
```

尽管请注意，要使类型推断起作用，您还需要向`EqualsValueClauseSyntax`您提供一个`VariableDeclarator`。

# jquery - 使用 jquery 从 sql db 填充 html marquee

> ID：14777138
> 
> 赞同：0
> 
> 时间：2013-02-08T16:33:05.553
> 
> 标签：jquery

我有几个包含滚动 html 字幕的 wordpress 页面。加载页面时，使用 ajax 调用从 sql db 获取内容，然后填充选框。一切正常，但是当您导航到页面时，选取框到达顶部，然后重新开始。如果您刷新页面，一切都会按预期进行。只是当页面第一次导航到问题发生的地方时。

有什么建议吗？这几乎就像选取框在所有内容被检索并插入标签之前开始？

WordPress的html：

```
<script type='text/javascript' src='/scripts/dialog/js/jquery-ui-1.8.18.custom.min.js'> </script>
<script type='text/javascript' src='/scripts/dialog/js/jquery-1.7.1.min.js'></script>
<script type='text/javascript' src='/scripts/dialog/popupDialog.js'></script>

<div id="emptyMarquee" class="emptyMarquee-tall"></div>

<marquee class="marquee-tall" name="Compliance" direction="up" behavior="scroll" scrollamount="3">
    <center>
    </center>
</marquee> 
```

popupDialog.js

```
$(function(){
//hide the empty marquee and the marquee wrapper
$("#emptyMarquee").hide();
$("#marquee").hide();

//get projects from server
var serviceArea = $("#marquee").attr("name");
var query = "serviceArea=" + serviceArea;
$.ajax({
    type: "GET",
    url: "/scripts/dialog/getMarqueeData.php",
    data: query,
    dataType: "json",
    success: function(returnData){
        if (!(returnData.aaData[0] == "none")){//atleast 1 project returned from db                                

            $("#emptyMarquee").hide();

            //create marquee element
            $("#marquee").html("<marquee class='marquee-tall' direction='up' behavior='scroll' scrollamount='3'><center></center></marquee>");

            var projArr = [];

            for (var i = 0; i < returnData.aaData.length; i++) {            
                //returnData.aaData[i][0] - name
                //returnData.aaData[i][1] - description
                projArr.push("<strong>" + returnData.aaData[i][0] + "</strong> - " + returnData.aaData[i][1] + "</br></br>");
            };
            $.each(projArr,function(index, value){
                $("marquee center").append(value);
            })
            $("#marquee").show();
        }
        else{//no projects returned from db, show emptyMarquee div, fill with msg
            $("#marquee").hide();
            $("#emptyMarquee").html("Please check back soon for updated " + serviceArea + " projects.");
            $("#emptyMarquee").show();
        }
    }
})
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:11:28.073

可能您遇到了这个问题，因为 marquee 在 ajax 完成之前开始运行，并且您的数据是在 marque 位于顶部时添加的。刷新它的工作，因为该 ajax 请求已被缓存。

之前没有选框，而是在 ajax 调用成功时添加它。有一个 div 在哪里添加品牌说

ajax调用成功

```
$('#marqueWrap').html('<marquee class="marquee-tall" name="Compliance" direction="up" behavior="scroll" scrollamount="3"><center>'+ /*your content*/ +'</center></marquee>'); 
```

# c++ - 将整数转换为函数参数的字符串

> ID：14777139
> 
> 赞同：-2
> 
> 时间：2013-02-08T16:33:10.260
> 
> 标签：c++, string, integer, converter

我有一个接受字符串参数的函数，并且我有一个整数变量，然后我应该将其转换为字符串，然后将其传递给我使用此代码的函数，但由于 ostringstream 用于 I/O，因此它不起作用。

```
ostringstream ostr;
while (.....)
{
regnum++;
ostr<<regnum;
grph.addlastname(ostr.str());
} 
```

例如它传递 12345 而不是 5，我该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T16:39:03.800

这是真的 - 有很多类似的问题可以解决“什么是最好的方法？” 但我认为在回答“为什么这不起作用？”的问题时，OP 有一些东西需要学习。

所以：

你`stringstream`有一个内部状态，在你的循环中你总是附加一个新的数字——但以前的数字仍在流中！您可以通过将`stringstream`作用域设置为循环本地来解决此问题，即在循环内部而不是在循环外部声明它。

（`std::to_string`尽管如此，对于这个特定问题仍然是更好的解决方案。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T16:41:31.597

一切都很好，除了一件事，请参阅：

```
ostringstream ostr;
 while (.....)
{
 regnum++;
 ostr<<regnum;
 grph.addlastname(ostr.str());
} 
```

你在 while 之外声明你的 ostr，第一次运行时，它会在 ostr 中添加 '1'，第二次，因为它是相同的“ostringstream”变量，它会添加 '2'，所以你的字符串将是 '12 ' 现在...

解决方案：在您的 while 中声明 ostringstream ostr，使用 std::to_string，或者每次 while 结束时执行 ostr.clear()。（最好的方式是在你的 while 中声明你的 ostr）

# iphone - 自定义 UINavigationBar 高度问题

> ID：14777141
> 
> 赞同：1
> 
> 时间：2013-02-08T16:33:17.340
> 
> 标签：iphone, ios, objective-c, height, uinavigationbar

所以我正在构建一个 iOS 应用程序，并将我的 UINavigationBar 自定义为高于默认大小。然而，出现了几个问题。

1.  我的内容就像 UINavigationBar 是默认高度一样。这导致 y=0 处的任何视图实际上被我更高的 UINavigationBar 隐藏或部分隐藏。我必须手动将视图向下放置正确的偏移量，这不是一个非常大的问题，但我很好奇是否有人找到了解决此问题的方法。本质上，我的 UINavigationBar 被视为具有较大背景图像的普通 UINavigationBar。

2.  如果被点击的部分低于普通 UINavigationBar 的典型 44px 底部，则我的 UINavigationBar 中的任何视图/按钮都不可点击。正常范围内的任何东西都可以正常工作，但低于 44px 标记它不会注册。再次，就好像我的 UINavigationBar 被应用程序视为具有正常高度但背景图像很大的一个。这是一个我真正需要解决的更关键的问题。

这是修改我的 UINavigationBar 的代码：

```
[[UINavigationBar appearance] setBackgroundImage:[UIImage imageNamed:@"navBarBackground_iPhone.png"] forBarMetrics:UIBarMetricsDefault];
[self.navController.navigationBar setBackgroundColor:[UIColor whiteColor]];
[self.navController.navigationBar setFrame:CGRectMake(0, 0, self.frame.size.width, 72)]; 
```

这是在我的`-makeKeyAndVisible`UINavigationController 被分配并使用根视图控制器初始化后在我的主窗口中执行的。背景图像宽 320 像素，高 72 像素（@2x 版本的两倍）。

如您所见，我尝试在此处设置 UINavigationBar 的高度，在这部分代码之后它似乎没有粘住。它恢复为 44 像素。

我尝试将 UINavigationBar 子类化，但没有成功。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:12:56.057

尝试继承 UINavigationBar 并覆盖以下方法：

```
 - (void)drawRect:(CGRect)rect
 {
    int heightYouWant = 100;

    UIImage *image = [UIImage imageNamed:@"title_bar_bg.png"];
    [image drawInRect:CGRectMake(0, 0, self.frame.size.width, heightYouWant)];

    self.tintColor = [UIColor colorWithRed:1/255.0 green:62/255.0 blue:130/255.0 alpha:1];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:03:02.990

将此方法添加到 UINavigationBar 的子类中：

```
- (void)layoutSubviews {
    [super layoutSubviews];
    CGRect barFrame = self.frame;
    barFrame.size.height = heightYouWant;
    self.frame = barFrame;
} 
```

# ios - iOS 常量文件中的条件 IF/ELSE 语句

> ID：14777142
> 
> 赞同：0
> 
> 时间：2013-02-08T16:33:18.957
> 
> 标签：ios, objective-c, cocoa, constants

各位码农...

*   我在应用程序的**全局常量文件**中设置了服务器 url 。
*   我的应用程序 plist 中还有一个名为**“DebugMode”**的变量，一旦切换，它应该会更改应用程序将使用的 url。

**常量**
.h extern NSString * const LOGIN_URL;

**常量**
.m NSString * const LOGIN_URL = @" [http://www.url.com](http://www.url.com) ";

无论如何，我可以将下面的伪代码复制到 Objective C 中吗？

```
if([[[[NSBundle mainBundle] infoDictionary] objectForKey:@"DebugMode"] boolValue] == NO)
{
  NSString * const LOGIN_URL = @"http://www.production-url.com";
}
else
{
  NSString * const LOGIN_URL = @"http://www.qa-url.com";
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T17:16:17.847

您的要求并不完全可能（至少不是您要求的方式）。在编译时设置和建立一个常量（并非严格正确，但为了便于解释，它会这样做），因此意味着它不能在运行时因任何原因而发生突变。

根据调试和发布代码更改常量值的传统方法是通过预处理器。像这样：

```
#if __DEBUG_MODE__ == 1
    NSString * const LOGIN_URL = @"http://www.qa-url.com";
#else
    NSString * const LOGIN_URL = @"http://www.production-url.com";
#endif 
```

现在`__DEBUG_MODE__`需要在它可以做任何事情之前进行定义，并且有几种方法可以做到这一点。您可以将以下行添加到您的前缀头文件 (.pch)

```
#define __DEBUG_MODE__ 1  // Change to 0 to disable debug mode. 
```

或将编译器标志添加`-M__DEBUG_MODE__=1`到您希望生效的文件中。这意味着每当`__DEBUG_MODE__`设置为 1 时，编译器将使用您的调试常量，而当它的值为 0 时，编译器将使用生产常量。

这还具有将调试代码和生产代码分开的好处（您应该避免将两者都放在二进制文件中，因为它可能会引发整个世界的问题和安全问题）。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:40:22.070

每当我遇到这样的情况时，我就在我的常量文件中创建了一个类方法：

```
+ (NSString *)loginURL {

    if([[[[NSBundle mainBundle] infoDictionary] objectForKey:@"DebugMode"] boolValue] == NO){
        return @"http://www.production-url.com";
    }
    else {
        return @"http://www.qa-url.com";
    }
} 
```

它还使您的代码更清楚地表明，由于`loginURL`字符串是通过方法传入的，它可能取决于运行时条件：

```
NSURL *loginURL = [NSURL URLWithString:[Constants loginURL]]; 
```

# android - Android：AVD 另一个“分配内存失败：8”帖子

> ID：14777151
> 
> 赞同：1
> 
> 时间：2013-02-08T16:33:47.880
> 
> 标签：android, avd

我已经做了很多搜索，除了将 avd 内存设置为大约 512 之外，似乎没有其他解决方案。我应该没有问题运行 avd 的 1024 或更高的内存，因为我的机器是四核具有 16 GB RAM 的至强。最常用的解决方案是打开 AVD 的 .ini 文件并将 MB 放在 RAM 大小声明之后。这不是一个解决方案，因为系统无法识别带有“MB”的条目，并强制 AVD 以默认值运行，通常是 512 或 256。我的问题是，我疯了，还是这个问题在谷歌没有可行的解决方案的情况下永远持续下去？如果有实际的解决方案，有人可以在这里发布。我的系统信息如下：Windows 7 64bit Intel Xeon 2。

# java - @ManyToOne，一列可以引用其他两列吗？

> ID：14777152
> 
> 赞同：1
> 
> 时间：2013-02-08T16:33:48.653
> 
> 标签：java, hibernate

我可以有如下关系：

```
@Entity Table1{

    @ManyToOne
    @JoinColumn(name = "Column1", 
                referencedColumnName = "t2id", 
                insertable = false, 
                updatable = false)
    private Table2 table2_col;

    @ManyToOne
    @JoinColumn(name = "Column1", 
                referencedColumnName = "t3id", 
                insertable = false, 
                updatable = false)
    private Table3 table3_col;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T21:18:12.363

是的，映射看起来有效。两种情况下的列`Column1`都属于不同的表（`Table2.column1`和`Table3.column1`）。所以我在这里看不到任何碰撞。正如标题所说的“一列引用另外两列”，情况并非如此。

在这种情况下，您有两个*多对一*关系：**Table1<--->Table2**和 **Table1<--->Table3**。因此，两个表（2 和 3）中的**column1都是****Table1**的外键。所以你有2个不同的外键。

# ef-code-first - EF 预编译视图可以与 Oracle 和 Devart 一起使用吗？

> ID：14777154
> 
> 赞同：0
> 
> 时间：2013-02-08T16:33:50.930
> 
> 标签：ef-code-first, entity-framework-4.1, devart, dotconnect, precompiled-views

我们发现了一篇关于使用“预编译视图”提高实体框架性能的有趣文章：http: [//neverindoubtnet.blogspot.ch/2012/03/squash-entity-framework-startup-time.html](http://neverindoubtnet.blogspot.ch/2012/03/squash-entity-framework-startup-time.html)

我们已经尝试过 - 我们使用 EF Power Tools 扩展来自动生成预编译视图。之后我们的应用程序仍在运行，但我怀疑这些视图是否正在被使用。

上面的文章指出必须安装 SQL Express。我们将 DevArt dotConnect 与 Oracle 数据库一起使用。我想知道 Microsoft 编写的 EF Power Tools 应该如何知道预编译视图的正确 SQL 的样子。它是否查看 web.config 并发现 dotConnect 是提供程序并从该提供程序检索 SQL 语句？

为了引发这个荒谬的广告，我弄乱了预编译视图文件 (DataContext.Views.cs) 中的所有字符串并运行了应用程序 - 它仍然运行良好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T15:17:14.910

> 我怀疑这些观点是否正在被使用

在带有预编译视图的文件中的上下文构造函数中设置断点，以查明运行时是否使用该视图。

> 我弄乱了预编译视图文件 (DataContext.Views.cs) 中的所有字符串并运行了应用程序 - 它仍然运行良好。

如果手动修改，EF 运行时不使用预编译视图。

# java - 使用 Jquery 和 servlet 检索图像会产生 HTTP 状态 500 错误

> ID：14777159
> 
> 赞同：0
> 
> 时间：2013-02-08T16:34:02.017
> 
> 标签：java, json, exception, web, servlet-3.0

我需要从我的数据库中检索图像。为此，我使用 jquery 和 servlet 来检索存储在表中的所有图像。但是当我运行它产生的代码时，`HTTP Status 500 - class oracle.jdbc.driver.OracleBlobInputStream declares multiple JSON fields named maxPosition`我是 Jquery 的新手，我不知道如何将 JSON 用于图像。

我的 Servlet 是：

```
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String uname;// = request.getParameter("countryCode");
        uname="shyam";
        PrintWriter out = response.getWriter();
        response.setContentType("text/html");
        response.setHeader("Cache-control", "no-cache, no-store");
        response.setHeader("Pragma", "no-cache");
        response.setHeader("Expires", "-1");

        response.setHeader("Access-Control-Allow-Origin", "*");
        response.setHeader("Access-Control-Allow-Methods", "POST");
        response.setHeader("Access-Control-Allow-Headers", "Content-Type");
        response.setHeader("Access-Control-Max-Age", "86400");

        Gson gson = new Gson();
        JsonObject myObj = new JsonObject();

        ArrayList<ImageFileInfo> imageInfo = getInfo(uname);
        ImageFileInfo info = new ImageFileInfo();
        JsonElement imageObj = gson.toJsonTree(imageInfo);

        boolean nonNullElemExist= false;
        for (ImageFileInfo s: imageInfo) {
          if (s != null) {
             nonNullElemExist = true;
             break;
          }
        }
        if(nonNullElemExist==true){
            myObj.addProperty("success", false);
        }
        else {
            myObj.addProperty("success", true);
        }
        myObj.add("imageInfo", imageObj);
        out.println(myObj.toString());
        out.close();

}
 private ArrayList<ImageFileInfo> getInfo(String uname) {

     ArrayList<ImageFileInfo> imageFileList = new ArrayList<ImageFileInfo>();
         Connection conn = null;           
        PreparedStatement stmt = null;    

        try {     
            conn=prepareConnection();

            StringBuilder sb=new StringBuilder(1024);
            sb.append("select * from ").append(uname.trim()).append("image");
            String sql=sb.toString();

            stmt = conn.prepareStatement(sql);
            ResultSet rs = stmt.executeQuery();

            while(rs.next()){
                ImageFileInfo info = new ImageFileInfo();
                info.setName(rs.getString("imagename").trim());
                info.setDisc(rs.getString("imagedisc").trim());
                info.setImageid(rs.getInt("imageid"));
                info.setalbumid(rs.getInt("albumid"));

                byte imageData[] = rs.getBytes("imagethumb");
                String encoded = DatatypeConverter.printBase64Binary(imageData);
                info.setThumb(encoded);

                byte image1Data[] = rs.getBytes("imagethumb");
                String encoded1 = DatatypeConverter.printBase64Binary(image1Data);

                info.setFull(encoded1);
            }                                                                        

            rs.close();                                                              
            stmt.close();                                                            
            stmt = null;                                                             

            conn.close();                                                            
            conn = null;                                                  

        }                                                              
        catch(Exception e){ System.out.println( "Error --> " + displayErrorForWeb(e));;}                     

        finally {                                                      

            if (stmt != null) {                                           
                try {                                                        
                    stmt.close();                                               
                } catch (SQLException sqlex) {                               
                    // ignore -- as we can't do anything about it here          
                }                                                            

                stmt = null;                                           
            }                                                       

            if (conn != null) {                                     
                try {                                                  
                    conn.close();                                         
                } catch (SQLException sqlex) {                         
                    // ignore -- as we can't do anything about it here    
                }                                                      

                conn = null;                                           
            }                                                       
        }             

        return imageFileList;

    } 
```

ImageFileInfo.java 文件是：

```
package skypark;
import java.io.InputStream;
public class ImageFileInfo 
{
String name = null;
String disc = null;
int imageid=0;
int albumid=0;
InputStream thumbarray;
InputStream fullarray;

public void setName(String name) 
{
    this.name = name;
}
public String getName() {
    return name;
}
public void setDisc(String disc) 
{
    this.disc = disc;
}
public void setImageid(int Imageid) 
{
    this.imageid = Imageid;
}
public void setalbumid(int albumid) 
{
    this.albumid = albumid;
}
public void setThumb(InputStream inputStream) 
{
    this.thumbarray = inputStream;
}
public void setFull(InputStream binaryStream) {
    this.fullarray = binaryStream;

}
} 
```

堆栈跟踪是：

```
java.lang.IllegalArgumentException: class oracle.jdbc.driver.OracleBlobInputStream declares multiple JSON fields named maxPosition
com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.getBoundFields(ReflectiveTypeAdapterFactory.java:122)
com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.create(ReflectiveTypeAdapterFactory.java:72)
com.google.gson.Gson.getAdapter(Gson.java:353)
com.google.gson.internal.bind.TypeAdapterRuntimeTypeWrapper.write(TypeAdapterRuntimeTypeWrapper.java:55)
com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.write(ReflectiveTypeAdapterFactory.java:89)
com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.write(ReflectiveTypeAdapterFactory.java:195)
com.google.gson.Gson.toJson(Gson.java:586)
com.google.gson.Gson.toJsonTree(Gson.java:479)
com.google.gson.Gson.toJsonTree(Gson.java:458)
skypark.RetriveIm.doGet(RetriveIm.java:66)
javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
javax.servlet.http.HttpServlet.service(HttpServlet.java:728) 
```

我不知道这个错误说明了什么。请任何人帮我解决这个问题......谢谢......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:39:47.497

您在类中包含了两个`InputStream`变量，它们被设置为 的实例`OracleBlobInputStream`，您的 GSON 提供程序无法对其进行序列化。您可能希望将图像内容存储为字节而不是（或作为（URL 编码的）字符串）。

```
public class ImageFileInfo implements Serializable {
   // Other class variables
   private byte[] thumbarray;
   private byte[] fullarray;

   // Constructors, Getters/Setters
}

ImageFile.setThumb(rs.getBytes("imagethumb"));
ImageFile.setFull(rs.getBytes("imagefull")); 
```

另一方面，您似乎正在尝试返回 JSON 内容，但您错误地指定了`Content-Type`as `text/html`，而不是`application/json`.

# ruby-on-rails - nil 不能被强制转换为 Float

> ID：14777165
> 
> 赞同：0
> 
> 时间：2013-02-08T16:34:15.350
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在使用 RoR 3.2.11 编写计费系统。

现在我想计算账单的总金额。为此，我设计了这样的模型：

```
class Bill < ActiveRecord::Base
  belongs_to :customer
  has_many :bill_items, :dependent => :destroy
  has_many :articles, :through => :bill_items
  attr_accessible :date, :discount, :state, :category, :customer_id, :bill_items_attributes
  accepts_nested_attributes_for :bill_items, :reject_if => lambda { |a| a[:count].blank? }, :allow_destroy => true

  def total
     bill_items.inject(0) { |acc, bill_items| acc + (bill_items.count * bill_items.article.price) } - discount
  end
end 
```

如果有东西存储在数据库中，那效果很好。如果“bill_item”为空，我会收到以下消息：

```
TypeError in Bills# edit
nil can't be coerced into Float 
```

如果有人能帮我解决这个问题，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:23:23.487

我发现了问题。我不得不将每一个属性都赋予它的类型。

现在我有以下行：

```
def total
     bill_items.inject(0) { |acc, bill_items| acc + (bill_items.count.to_i * bill_items.article.price.to_f) } - discount.to_f
end 
```

也许这对其他人也有帮助。

编辑：复制错误的代码被剪断

# ruby-on-rails - 关于 MVC 中的委托

> ID：14777169
> 
> 赞同：0
> 
> 时间：2013-02-08T16:34:30.160
> 
> 标签：ruby-on-rails, model-view-controller

我有一些模型。在 html 视图中，我必须重新格式化字符串模型属性，例如 5 次以上。MVC 的哪一部分应该做呢？朋友说，我必须创建 Model 方法来做到这一点，但我认为 View 应该对此做出响应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:55:00.257

例如，我们得到了表格：

```
TableA:{
  Title:string;
  Description:string;
  Full-text:string;
} 
```

我们决定删除“**描述**” - 并在运行时计算它。

重点是“**描述**” - 现在是计算属性，所以它属于模型，您可以查看[计算属性](http://knockoutjs.com/documentation/computedObservables.html)以理解我的意思。

但是如果你只是做一般的格式化，比如 date -> to_cool_date 你可以使用助手。但如果它`s calculated property -> it`属于模型！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T16:44:04.273

我会把它放在[partial](http://guides.rubyonrails.org/layouts_and_rendering.html#using-partials)或**helper**中。*如果没有看到您的代码示例，就很难深入挖掘。*但是，是的，将视图的格式保留在模型之外。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T16:44:06.223

该模型应该负责您需要的数据的大部分方面，包括业务逻辑。尝试将其视为负责向控制器提供正确数据的模型，控制器又将其传递给正确的视图，以根据需要进行布局、格式和样式。

没有理由你不能添加另一个层或类库来处理业务逻辑，而不会使主模型中的 getter 和 setter 变得混乱。

# angularjs - ng-click 作为 AngularJS 中的一个类

> ID：14777174
> 
> 赞同：2
> 
> 时间：2013-02-08T16:34:55.760
> 
> 标签：angularjs, ng-class

我试图弄清楚为什么这不起作用：

```
<a class="ng-click: loadSomeDatas();">Click here to load some datas</a> 
```

但这确实：

```
<a ng-click="loadSomeDatas()">Click here to load some datas</a> 
```

**你为什么使用类？**

好吧 ng-* 属性在我必须支持的一些客户端上表现不佳，因此与其对它们进行填充，我宁愿只使用好的 ol' 安全类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T18:14:15.323

这看起来像一个文档错误。根据[源代码](https://github.com/angular/angular.js/blob/master/src/ng/directive/ngEventDirs.js)，它只能用作属性。链接功能不使用`restrict`，因此默认为“仅属性”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-12T21:44:21.423

您可以尝试使用“data-ng-click”吗？Angular 仍然可以使用在属性名称之前附加的 data- ，这在旧浏览器中应该是有效的语法。

```
<a data-ng-click="loadSomeDatas()" href="#">Click here to load some datas</a> 
```

# ruby-on-rails-3 - 如何在 Rails 中从一个表单保存到两个表

> ID：14777176
> 
> 赞同：0
> 
> 时间：2013-02-08T16:34:57.097
> 
> 标签：ruby-on-rails-3

我有一个常规的用户信息表格，开头如下：

```
<%= form_for(@user, :html => { :class => "form-horizontal" }) do |f| %>
    <%= f.text_field :last_name %>
    ...
    <%= f.submit "Submit", class: "btn btn-primary", :name => "submit_button" if @user.last_step? %>
<% end %> 
```

我在表单中还有一些非用户字段。这是一个例子：

```
<%= f.label "When is your birthday?" %>
<%= select_tag "month" %>
<%= select_tag "day" %>
<%= select_tag "year" %> 
```

我如何将其保存到与用户不同的表中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T16:45:19.043

如果你想更新用户以外的模型，你应该使用[`accepts_nested_attributes_for`](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html)and [`fields_for`](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-fields_for)。另一种方法是在您的`create`操作中完成工作`UsersController`，即：

```
def create
  @user = User.create params[:user]
  @foo = Foo.find params[:foo_id]
  @foo.date = Date.new(params[:foo_year], params[:foo_month], params[:foo_day])
  ...
end 
```

# ruby-on-rails - 如何使用 Fog 验证 AWS 服务器终止？

> ID：14777178
> 
> 赞同：2
> 
> 时间：2013-02-08T16:35:03.583
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, amazon-web-services, fog

我在“开始”块中有 3 行 Rails 应用程序代码，用于使用 Fog 终止 AWS 计算实例并在成功时设置字符串值：

```
 @server = @connection.servers.get(params[:id])
  @server.destroy
  @server_deletion_result = "success" 
```

此代码有效，但它只是向 AWS 发送终止实例的命令。使用 Fog，我如何验证实例是否已*完成终止*？

我试过这个，无济于事：

```
 while @server.state != "terminated" do
    sleep 3
  end
  @server_deletion_result = "success" 
```

即使实例在 AWS 控制台中显示“已终止”，它似乎也只是挂起。

那么，想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T19:04:34.060

我的一个朋友通过 Twitter 帮助我回答了这个问题。答案是调用服务器对象上的 reload() 函数，然后检查它。雾缓存服务器对象，必须对其进行更新以检查状态。

这是我的最终解决方案：

```
 @server.reload
  while @server.state != "terminated" do
    sleep 3
    @server.reload
  end 
```

**编辑：**感谢 Frederick Cheung，他在评论中有更好的答案：

```
@server.wait_for {state == 'terminated'} 
```

# string - Crystal Reports：公式无法使 0.00 值显示为空白

> ID：14777179
> 
> 赞同：0
> 
> 时间：2013-02-08T16:35:09.287
> 
> 标签：string, crystal-reports, formula, inventory-management

我总结了每个财政年度季度的库存使用情况。空值显示为 0.00，但我想将它们设为空白。到目前为止，我制定的公式是这样的：

```
If IsNull({USAGE.CURFY_Q1}) and IsNull({USAGE.CURFY_Q2}) 
   and IsNull({USAGE.CURFY_Q3}) and IsNull({USAGE.CURFY_Q4})
then "" 
else 
"Q1: " & Cstr({USAGE.CURFY_Q1}) & chr(13) & chr(10) & 
"Q2: " & Cstr({USAGE.CURFY_Q2}) & chr(13) & chr(10) & 
"Q3: " & Cstr({USAGE.CURFY_Q3}) & chr(13) & chr(10) &  
"Q4: " & Cstr({USAGE.CURFY_Q4}) 
```

该公式创建此结果：

```
Q1: 5.00
Q2: 2.00
Q3: 0.00
Q4: 0.00 
```

我会比较喜欢：

```
Q1: 5
Q2: 2
Q3: 
Q4: 
```

我认为 ToText(Q1,0) 可能涉及... :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T16:49:42.483

```
local stringvar q1;
local stringvar q2;
local stringvar q3;
local stringvar q4;

if isnull({USAGE.CURFY_Q1}) then q1:="" else q1:=totext({USAGE.CURFY_Q1},0);
if isnull({USAGE.CURFY_Q2}) then q2:="" else q2:=totext({USAGE.CURFY_Q2},0);
if isnull({USAGE.CURFY_Q3}) then q3:="" else q3:=totext({USAGE.CURFY_Q3},0);
if isnull({USAGE.CURFY_Q4}) then q4:="" else q4:=totext({USAGE.CURFY_Q4},0);

if (q1="" and q2="" and q3="" and q4="") then "" else

"Q1: " & q1 & chr(10) &
"Q2: " & q2 & chr(10) &
"Q3: " & q3 & chr(10) &
"Q4: " & q4 
```

# iphone - Google Maps iPhone 应用程序如何通过蓝牙通知

> ID：14777180
> 
> 赞同：1
> 
> 时间：2013-02-08T16:35:20.297
> 
> 标签：iphone, ios, objective-c, api, bluetooth

我正在寻找一些关于谷歌地图应用程序如何能够将转弯方向发送到车载蓝牙系统的参考。原因是我的车不支持[A2DP](http://en.wikipedia.org/wiki/Bluetooth_profile#Advanced_Audio_Distribution_Profile_.28A2DP.29)，所以我无法将我的音乐/播客直接流式传输到收音机。

谷歌似乎正在使用电话配置文件，也称为免提协议[-HFP](http://en.wikipedia.org/wiki/Bluetooth_profile#Hands-Free_Profile_.28HFP.29)，它看起来像是车载收音机上的一个电话。

如果有人可以向我指出 API 来实现这一点，我可能会使用这个小怪癖来编写一个支持流式传输到我的汽车音响系统的应用程序。

有谁知道这是什么API？或者，如果您有更好的示例代码。这个在谷歌上很难找到！

# java - 是否可以将自定义组件添加到 android 中的 Preference Activity？

> ID：14777181
> 
> 赞同：1
> 
> 时间：2013-02-08T16:35:20.640
> 
> 标签：java, android, sharedpreferences, preferenceactivity

有没有办法在偏好活动中添加自定义组件以更改设置的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T16:37:52.293

您可以添加任何扩展[android.app.Preference的自定义组件](http://developer.android.com/reference/android/preference/Preference.html)

或者如果它应该是一个视图 - 创建一个布局，但您必须在 PreferenceScreen 的布局中包含一个带有 android.R.id.list 的 ListView

```
<RelativeLayout 
        xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:tools="http://schemas.android.com/tools"
        android:id="@+id/layout_content"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@color/background_color" >

    <YourCustomComponentView
        android:id="@+id/view"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"/>

    <ListView
        android:id="@android:id/list"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_below="@+id/view"
        android:layout_alignParentBottom="true"/>

</RelativeLayout> 
```

在添加任何首选项之前只需 setContentView() 即可。

# javascript - 在不同的字符出现后提取字符串

> ID：14777189
> 
> 赞同：0
> 
> 时间：2013-02-08T16:35:47.987
> 
> 标签：javascript

我有一个字符串数组，其中包含类似于：

```
array[0]=Name: Bob Last: Jones Age: 36
array[1]=Name: James Last: Brown Age: 29
array[2]=Name: Lloyd Last: Mals Age: 45 
```

我想获取每个名称并将它们放在单独的数组中

如下所示：

```
name[0]=Bob
last[0]=Jones
age[0]=36

name[1]=James
last[1]=Brown
age[1]=29

name[2]=Lloyd
last[2]=Mals
age[2]=45 
```

我如何在 Javascript 中执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:42:11.237

有很多方法可以做到这一点，但这里有一个使用正则表达式的示例。

要从每个字符串中获取一组值，您可以使用`split`

```
str = 'Name: Bob Last: Jones Age: 36';
values = str.split( /\s?\w+:\s/ );         // [ "", "Bob", "Jones", "36" ] 
```

或者，为了避免您可以使用的初始空字符串`match`

```
values = str.match( /\w+(?=\s\w+:|$)/g );  // [ "Bob", "Jones", "36" ] 
```

要了解有关正则表达式的更多信息，请参阅[Regular-Expressions.info](http://www.regular-expressions.info/tutorial.html)。

# python - SL4A _R6 / Python4android_R4 webViewShow NullPointerException 上的简单示例代码

> ID：14777190
> 
> 赞同：1
> 
> 时间：2013-02-08T16:35:55.510
> 
> 标签：python, html, webview, sl4a

我正在尝试在我的简单 SL4A Python 应用程序上获取 HTML Gui。我唯一需要做的就是在我的应用程序开始时向用户询问 1 个输入字符串。

出于调试目的，我从简单开始。不幸的是，即使这也不起作用。知道这里有什么问题吗？（我已经尝试了几段这样的代码并且都有同样的问题）

Python代码：

```
import android

loop = True
droid = android.Android()
droid.webViewShow('/sdcard/sl4a/scripts/screen.html')

while loop:
    res = droid.waitForEvent('data')
    if res:
        print str(res) 
```

HTML 代码

```
<html>
 <head>
  <script>
   var droid = new Android();
   var fiets = function() {
        droid.postEvent("data", document.getElementById("gsm").value);
      }
  </script>
 </head>
 <body onload:"fiets()">
  <form onsubmit="fiets(); return false;">
   <label for="say">What would you like to say?</label>
   <input type="text" id="gsm" value="99999999" />
   <input type="submit" value="Store" />
  </form>
 </body>
</html> 
```

错误信息是重复的（数字3114是递增的）：

```
java.lang.NullPointerException
Result(id=3114, result=None, error=u'java.lang.NullPointerException') 
```

更新：

[http://www.mithril.com.au/android/doc/EventFacade.html](http://www.mithril.com.au/android/doc/EventFacade.html)

在我们去的时候，我读到`waitForEvent`在 r4 中被弃用了。我应该`eventWaitFor`改用。这会消除错误，但不会使示例函数生效。Python 脚本不打印任何内容。

更新2：

`droid.postEvent`应该成为`droid.eventPost`

`droid.waitForEvent('data')`应该成为`droid.waitForEvent('data')`

在javascript和python中。

问题解决了

# java - 安全性 - 数组直接存储 - 字符串 [][]

> ID：14777197
> 
> 赞同：1
> 
> 时间：2013-02-08T16:36:19.097
> 
> 标签：java, arrays, sonarqube

在数组数组的情况下，我在任何地方都没有看到有关此特定声纳违规的答案。

**声纳违规：安全 - 阵列直接存储**

有问题的代码：

```
public void setData(String[][] data) {  
    if(data == null) { 
        this.data = new String[0][];
    } else { 
        String[][] dataCopy = new String[data.length][];
        System.arraycopy(data, 0, dataCopy, 0, data.length);
        this.data = dataCopy;
    } 
```

由于我的 java 版本，我无法使用以下解决方案：

```
public void setData(String[][] data) {  
    if(data == null) { 
        this.data = new String[0][0];
    } else { 
        this.data = Arrays.copyOf(data, data.length); 
    } 
} 
```

有什么建议可以解决这个问题吗？

# jquery - 用 jquery 替换占位符

> ID：14777198
> 
> 赞同：0
> 
> 时间：2013-02-08T16:36:22.313
> 
> 标签：jquery, forms, placeholder

我正在为该`placeholder`问题创建一个解决方案，使其仅使用 jquery 在每个浏览器中工作。

到目前为止它工作得很好......这就是我已经走了多远

```
var formId = ["Name", "E-mail", "Subject", "Message"];
$.each(formId, function(i) {
    $("input, textarea").focus(function() {
        if ($(this).val() === formId[i])
            $(this).val("");
    }).focusout(function() {
        if ($(this).val() === "")
            $(this).val(formId[i]);
    });
}); 
```

它工作完美，直到焦点出部分。当我关注输入字段时，它会`Name`在每个输入字段中重新填充值。我尝试了不同的解决方案，但这与我已经接近了。有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:42:26.853

这似乎不是解决这个问题的最佳方法。我之前在博客上看到过类似以下的解决方案。您将占位符属性添加到输入，因此它们将在现代浏览器上运行，并且您将 jQuery 添加到具有占位符属性的输入，例如`[placeholder]`：

```
$('[placeholder]').focus(function() {
  var input = $(this);
  if (input.val() == input.attr('placeholder')) {
    input.val('');
    input.removeClass('placeholder');
  }
}).blur(function() {
  var input = $(this);
  if (input.val() == '' || input.val() == input.attr('placeholder')) {
    input.addClass('placeholder');
    input.val(input.attr('placeholder'));
  }
}).blur();

$('[placeholder]').parents('form').submit(function() {
  $(this).find('[placeholder]').each(function() {
    var input = $(this);
    if (input.val() == input.attr('placeholder')) {
      input.val('');
    }
  })
}); 
```

我现在找不到博客，这很遗憾，因为我相信这段代码完全是从那个站点复制的，并且工作得很好，跨浏览器。

**这是如何工作的，以及为什么这是一种更好的方法：**

无需在每个 input 和 textarea 元素上放置处理程序，您可以轻松地准确过滤哪些应该有处理程序：那些具有占位符属性的处理程序。

处理程序将`.submit()`阻止默认文本作为值发布。

也许我应该谈谈我认为您的代码存在的问题：

您正在使用 each 函数来调用多个非常相似的焦点处理程序。您可能不需要 each 功能。您可以只使用 $('input, textarea').focus() 因为这将为每个输入添加一个处理程序。然后，您可以检查是否`$.inArray($(this).val(),formId)`. [inArray()](http://api.jquery.com/jQuery.inArray/)的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T16:43:40.417

忘记了`var formId`，而是在您的 input/textarea html 标记中添加一个属性 data-placeholder 并使用适当的值，然后：

```
 $("input, textarea").on({
    focus : function() {
      var $t=$(this);
      if ($t.val() ===$t.data("placeholder"))
        $t.val("");
    }, 
    blur : function() {
      var $t=$(this);
      if ($t.val() === "")
        $t.val($t.data("placeholder"));
    }
}); 
```

# c - 在C中的#ifdef内定义常量

> ID：14777200
> 
> 赞同：0
> 
> 时间：2013-02-08T16:36:23.230
> 
> 标签：c, macos, constants

我想根据使用的操作系统定义一个常量。
像这样：

```
#include <stdio.h>

#ifdef _Win32        //Used for system("cls") command
#include <process.h>
#define CLEAR "system(\"cls\")"
#endif

#ifdef __APPLE__
#define CLEAR "system(\"clear\")"
#endif

int main()
{
   CLEAR;
} 
```

Xcode 给我一个错误，说明表达式结果在
`#define CLEAR "system(\"clear\")`主函数处和内部未使用。

我在 Mac 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T16:37:31.790

采用：

```
#define CLEAR system("clear") 
```

不是

```
#define CLEAR "system(\"clear\")" 
```

您收到错误是因为您的宏调用被替换为：

```
"system(\"clear\")"; 
```

这是一个无用的表达式语句（这里的表达式是字符串），例如：

```
0;   // valid but pointless 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T16:37:22.900

```
#define CLEAR system("clear") 
```

并不是

```
#define CLEAR "system(\"clear\")" 
```

编译器将创建一个新的 C 代码（称为预处理器代码），其中将宏名称替换为其内容。

因此，如果您以这种方式定义宏：

```
 #define CLEAR "system(\"clear\")" 
```

您将获得编译器生成的新代码（预处理器代码）：

```
int main()
{
    "system(\"clear\")";

} 
```

您可以看到编译器生成的代码（预处理器代码）`gcc -E`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T16:39:21.533

尝试改变你的主要功能：

```
int main()
{
    int rc;
    rc = CLEAR;
    return rc;
} 
```

您需要捕获 system() 调用的返回值并使用它

# javascript - 如何从提到的字符串中获取逗号分隔的值

> ID：14777201
> 
> 赞同：2
> 
> 时间：2013-02-08T16:36:25.880
> 
> 标签：javascript, jquery, json, string

我想从下面的字符串中获取逗号分隔的 ID 和类型。

我尝试过拆分，但这需要多次拆分才能获取所需的结果。

请建议一种有效的方法来获取所需的输出，例如`1234,4321`使用 js/jquery。

```
var tempString=
'[{"id":"1234","desc":"description","status":"activated","type":"type","name":"NAME"},
  {"id":"4321","desc":"description1","status":"inactivated","type":"type","name":"NAME1"}]'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T16:38:31.493

要得到`"1234,4321"`，你可以做

```
var ids = tempString.map(function(v){return v.id}).join(','); 
```

如果你想兼容IE8，那么你可以这样做

```
var ids = $.map(tempString, function(v){return v.id}).join(','); 
```

**以下问题编辑：**

如果`tempString`不是数组而是真正的 JSON 字符串，那么你会这样做

```
var ids = $.map(JSON.parse(tempString), function(v){return v.id}).join(','); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T16:41:33.870

正如所指出的，这不是您示例中的字符串。一些引号不见了。

无论如何，请查看@dystroy 的答案，但我认为您正在处理 JSON 对象，并且您可能应该使用 json 解析器（如果必须的话，甚至可以使用 javascripts 原始 eval），然后将您的组件作为对象属性和数组获取。

查看[jquery 的 parseJSON](http://api.jquery.com/jQuery.parseJSON/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T16:44:21.620

您应该使用任何用于 JSON 的 Javascript 解析器 api 将给定的字符串解码为键和后续值。正如'Miquel'所提到的，jQuery 有一个

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T16:46:43.023

首先你上面的不是一个字符串，它是一个对象数组。

但

如果它是一个字符串（像这样）

```
var tempString = '[{"id":"1234","desc":"description","status":"activated","type":"type","name":"NAME"}] 
```

[{"id":"4321","desc":"description1","status":"inactivated","type":"type","name":"NAME1"}]';

然后你会想要使用类似 .match(); [https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/match](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/match)

var IDs = tempString.match(/([0-9]+)/gi);

# c++ - 如何在 main 之前立即调用函数或静态初始化对象？

> ID：14777204
> 
> 赞同：2
> 
> 时间：2013-02-08T16:36:36.613
> 
> 标签：c++, visual-c++, main, static-initialization

简而言之，我希望在尽可能靠近 main()/DllMain() 开头的地方进行特定的静态初始化。在静态初始化期间最后调用的构造函数可能是可以接受的。

由于这几乎肯定是特定于编译器的实现，因此我特别希望使用可视化 C++ 编译器（VS 2010 及更高版本）来执行此操作。将来我可能需要在 GCC 和 Clang 中执行此操作，但这不是一个直接的问题。

长话短说，我在基础库中有一个对象，该对象被静态初始化并在其构造函数中创建一个线程。该线程依赖于我们无法控制的库中的其他静态初始化对象，因此它会导致静态初始化中的竞争条件。如果我可以暂停或避免创建线程，直到所有其他静态初始化完成，这应该可以解决问题（一个简单的 Sleep(5000) 可以避免这个问题，尽管这不是一个可靠的解决方案）。

我可以在 main() 函数中显式调用初始化函数，但这并不理想，因为我们有 20 多个使用该库的二进制文件，因此每个程序员都必须记住在每个二进制文件中运行初始化。如果可能的话，我宁愿把这个责任推给编译器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T16:45:05.973

上面Refugnic Eternium的评论是正确的，并提供了一种解决方案。

最好的解决方案是具有这样的功能：

```
BOOL InitMyLib(); 
```

**MyLib.dll 中的**所有函数和****所有**构造函数在调用它之前都应该失败。这样你就可以确保程序员不会忘记调用它。**

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T19:14:22.083

创建一个初始化类，然后声明它的一个静态实例：

```
class MyInitializer
{
    public:
    MyInitializer ()
    {
        doInitStuffHere();
    }
};

static MyInitializer myInit; 
```

您可以使用 来控制*何时*初始化静态变量`#pragma init_seg`。例如，#pragma init_seg(lib)。

[使用 #pragma init_seg 控制静态构造 (KB104248)](http://support.microsoft.com/kb/104248)**

# android - 使用 Facebook api 在 Android 上通过自定义设置发布到 Facebook 墙上

> ID：14777210
> 
> 赞同：0
> 
> 时间：2013-02-08T16:36:59.937
> 
> 标签：android, facebook, facebook-wall

[有氧运动训练器示例图片链接](http://postimage.org/image/6otopxvnv/)

我正在尝试通过“Cardio Trainer”android api 将一些自定义设置作为示例图像发布在墙上。这是一个没有 facebook feed 对话框的自动共享过程。但我有三个主要问题。

1.  我希望我的帖子不能像示例照片中那样共享。我找不到任何方法。

2.  我无法在描述部分嵌入链接（在照片中=>“热量饮食跟踪器。试试吧！”）。

3.  在示例图像的顶部，文本将以“Cardio Trainer ile”结尾。但我的继续“分享链接”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T18:23:53.270

您发布的图片是由 Open Graph 共享生成的故事，而不是常规的 /me/feed 帖子。如果您想要类似的东西，您将需要为您的应用程序创建一些 Open Graph 操作和对象。

# asp.net - Global.asax Application_Error 问题

> ID：14777224
> 
> 赞同：0
> 
> 时间：2013-02-08T16:37:34.980
> 
> 标签：asp.net, vb.net

我正在尝试在 Global.asax 的 Application_Error 事件中处理未捕获的异常。目前看起来像

```
Sub Application_Error(ByVal sender as object, ByVal e as EventArgs)
    Server.ClearError()
    Response.Redirect("~/ErrorPages/GenericError.aspx")
End Sub 
```

在另一个页面的 Page_load 中抛出一个全新的异常

```
Throw New Exception() 
```

最终实际发生的是执行永远不会离开源页面，并抛出默认的 asp 错误页面，引用我的异常。为什么它没有被发送到我的错误页面？

编辑：固定`Response.Redirect`。现在看起来像：

```
Response.Redirect("http://mysite/ErrorPages/GenericError.aspx") 
```

还对我的`web.config`文件进行了[krsekhar](https://stackoverflow.com/a/14777447/312777)建议的更改。当我现在被发送到我的错误页面时，它使用的是默认重定向而不是我输入的重定向`Application_Error`。还有其他想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:51:32.587

The solution should be `customErrors mode="On"`
The only problem looks for your qustion is web.config entry for customError it should be as follows

```
 <configuration>
    <system.web>
       <customErrors mode="On" defaultRedirect="GenericErrorPage.htm">
           <error statusCode="403" redirect="NoAccess.htm" />
           <error statusCode="404" redirect="FileNotFound.htm" />
            ...
       </customErrors>
    </system.web>
  </configuration> 
```

Helpful links
[ASP.NET custom error page - Server.GetLastError() is null](https://stackoverflow.com/questions/343014/asp-net-custom-error-page-server-getlasterror-is-null)
[CustomErrors mode="Off"](https://stackoverflow.com/questions/101693/customerrors-mode-off)

# gwt - GWT 编辑器和副编辑器

> ID：14777225
> 
> 赞同：0
> 
> 时间：2013-02-08T16:37:46.800
> 
> 标签：gwt, gxt, gwt-editors

我正在尝试运行带有子编辑器的编辑器示例。刷新父级时，子编辑器的值为空。类是人员和地址。主编是：

```
 // editor fields
public TextField firstname;
public TextField lastname;
public NumberField<Integer> id;

public AddressEditor address = new AddressEditor();

public PersonEditor(Person p){
    asWidget();
}

@Override
public Widget asWidget() {
    setWidth(400);
    setBodyStyle("padding: 5px;");
    setHeaderVisible(false);

    VerticalLayoutContainer c = new VerticalLayoutContainer();

    id = new NumberField<Integer>(new IntegerPropertyEditor());
    // id.setName("id");
    id.setFormat(NumberFormat.getFormat("0.00"));
    id.setAllowNegative(false);
    c.add(new FieldLabel(id, "id"), new VerticalLayoutData(1, -1));

    firstname = new TextField();
    // firstname.setName("firstname");
    c.add(new FieldLabel(firstname, "firstname"), new VerticalLayoutData(1, -1));

    lastname = new TextField();
    lastname.setName("lastname");
    c.add(new FieldLabel(lastname, "lastname"), new VerticalLayoutData(1, -1));

    c.add(address);
    add(c);
    return this; 
```

副主编：

```
public class AddressEditor extends Composite implements Editor<Address> {

private AddressProperties props = GWT.create(AddressProperties.class);
private ListStore<Address> store = new ListStore<Address>(props.key());
ComboBox<Address> address;

public AddressEditor() {
    for(int i = 0; i < 5; i ++)
        store.add(new Address("city" + i));
    address = new ComboBox<Address>(store, props.nameLabel());

    address.setAllowBlank(false);
    address.setForceSelection(true);
    address.setTriggerAction(TriggerAction.ALL);
    initWidget(address);
} 
```

这是创建驱动程序的地方：

```
private HorizontalPanel hp;

private Person googleContact;
PersonDriver driver = GWT.create(PersonDriver.class);

public void onModuleLoad() {

    hp = new HorizontalPanel();
    hp.setSpacing(10);

    googleContact = new Person();
    PersonEditor pe = new PersonEditor(googleContact);

    driver.initialize(pe);
    driver.edit(googleContact);

    TextButton save = new TextButton("Save");
    save.addSelectHandler(new SelectHandler() {

        @Override
        public void onSelect(SelectEvent event) {
            googleContact = driver.flush();
            System.out.println(googleContact.getFirstname() + ", " + googleContact.getAddress().getCity());
            if (driver.hasErrors()) {
                new MessageBox("Please correct the errors before saving.").show();
                return;
            }
        }
    }); 
```

googleContact.getFirstname() 的值已填充，但 googleContact.getAddress() 始终为空。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T19:07:25.837

`AddressEditor`需要映射到模型 -目前`Address`，它似乎没有，除非`Address`只有一个 getter/setter，称为`getAddress()`and `setAddress(Address)`，这并没有多大意义。

如果您只想要一个`ComboBox<Address>`（`Editor<Address>`已经实现），请考虑将该组合`PersonEditor`直接放入。否则，您需要添加`@Path("")`到该`AddressEditor.address`字段，以表明它应该直接编辑值本身，而不是子属性（即`person.getAddress().getAddress()`）。

构建地址编辑器的另一种方法是`Address`在`AddressEditor`. 这是驱动程序默认情况下所期望的，因此当它看到一个名为“地址”的字段时会感到困惑。

关于代码本身的两个快速想法：无需将人传递给`PersonEditor`-这是驱动程序本身的工作。其次，您的编辑器字段不需要是`public`，它们就是不能`private`。

# jquery - Zurb Foundation：在移动设备上禁用 has-tooltip

> ID：14777228
> 
> 赞同：2
> 
> 时间：2013-02-08T16:38:01.913
> 
> 标签：jquery, zurb-foundation

我有一个小问题，我只注意到一个人有同样的问题（但没有解决方案）！我正在使用 Zurb's Foundation 创建一个响应式网站。Foundation 附带了几个有用的工具，其中一个是 Tooltip。

在一个网站中，我使用工具提示来告诉用户单击图标时将要做什么。然而！工具提示在 mouseenter.. 时显示。众所周知，移动设备上没有真正的 mouseenter 事件，这就是问题所在。例如，当用户单击过滤器按钮时，不会为他/她提供按钮的功能，而是显示工具提示。

到目前为止还不是真正的问题，通常使用悬停/鼠标输入操作只需单击两次，但单击两次并不能解决问题。

所以.. 快速的小问题是：有没有办法禁用 has-tooltip 功能？当我输入这个时，我觉得我找到了一个解决方案..所以也许不需要帮助，..但是。我不可能是现在或将来唯一遇到这个问题的人，所以问这个问题也许很好！

感谢您的帮助，如果我找到自己的解决方案，我会在下面发表评论！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T17:01:46.577

还有这个：

```
$(document).foundation('tooltip', 'off'); 
```

通过[http://foundation.zurb.com/docs/javascript.html](http://foundation.zurb.com/docs/javascript.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-11T10:23:23.717

您可以根据`touch`属性限制对工具提示函数的调用：

```
if($("html").hasClass("no-touch")) {
    $(document).foundationTooltips();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-28T08:17:21.283

Foundation 4 支持在数据参数中禁用触摸设备的功能。

```
data-options="disable-for-touch: true" 
```

例子：

```
<li id="print_button" class="has-tip" data-options="disable-for-touch: true" title="Print Take Five" class="none">
   <a href="">Print</a>
</li> 
```

来源：

```
{
  selector : '.has-tip',
  additionalInheritableClasses : [],
  tooltipClass : '.tooltip',
  disable-for-touch: false,
  tipTemplate : function (selector, content) {
    return '<span data-selector="' + selector + '" class="'
      + Foundation.libs.tooltips.settings.tooltipClass.substring(1)
      + '">' + content + '<span class="nub"></span></span>';
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-16T13:37:33.457

唯一适用于 Foundation 5.1.0 的是：

`Foundation.libs.tooltip.settings.disable_for_touch = true;`

# html - 复选框按钮需要多次点击

> ID：14777230
> 
> 赞同：1
> 
> 时间：2013-02-08T16:38:16.103
> 
> 标签：html, css

任何有火狐浏览器的人都可以打开[这个小提琴](http://jsfiddle.net/zAFND/615/)。

我遇到的问题是我有这个复选框按钮，它需要多次点击才能将其关闭，我的问题是如何阻止这种情况发生？我知道`posistion:relative`这是导致此问题的原因，但我需要这样做，以便每次单击按钮时，它都不会转到页面顶部。我只希望按钮一键打开和关闭，而不是多次单击

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:53:19.563

（请参阅问题下方的评论 - 现在我知道你会发生什么）

啊——没有 Javascript，你无法解决这个问题：快速（双击？）点击 TEXT ITSELF 被浏览器解释为“选择文本”，并且在发生这种情况时它不会将事件发送到复选框。使用 Javascript，您可以在点击时强制“取消选择”文本。

点击“慢慢地”——避免双击文本选择——它会起作用（只是为了显示问题的原因，没有 Javascript 或专有 CSS 没有解决方案）。

尝试添加这个：[双击后防止文本选择](https://stackoverflow.com/questions/880512/prevent-text-selection-after-double-click)

也许您应该使用完整的 Javascript Checkbox-Button 解决方案，而不是尝试仅使用 CSS 来完成它。

# r - 具有广义加法模型的观星者

> ID：14777238
> 
> 赞同：1
> 
> 时间：2013-02-08T16:38:42.583
> 
> 标签：r, latex, gam

我对 stargazer 报告的功能印象深刻，因为它具有多种模型类型的灵活性。但是，我似乎无法使用 stargazer 来获得具有广义加法模型的乳胶表输出，即使[文档](http://cran.r-project.org/web/packages/stargazer/stargazer.pdf)声明它处理 gam 对象类型。这是一个MWE。

```
require(stargazer)
require(mgcv)

dat <- gamSim(1,n=400,dist="normal",scale=2)
b <- gam(y~s(x0)+s(x1)+s(x2)+s(x3),data=dat)
stargazer(b) 
```

这是指定错误的输出。

```
% Table created by StarGazer v.2.0.1 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
% Date and time: Fri, Feb 08, 2013 - 10:29:39 AM
\begin{table}[htb] \centering 
  \caption{} 
\footnotesize 

\begin{tabular}{@{\extracolsep{5pt}}lc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & \multicolumn{1}{c}{\textit{Dependent variable:}} \\ 
\cline{2-2} 
\\[-1.8ex] & y \\ 
\cline{2-2} 
\\[-1.8ex] & \textit{GAM} \\ 
 & \textit{(continuous)} \\ 
\hline \\[-1.8ex] 
 s(x0).1Error: subscript out of bounds 
```

我已经尝试过使用不同的游戏模型，但我得到了同样的错误。有没有人有幸使用 stargazer 和 gam 创建乳胶表？我在这里遗漏了什么还是这是一个错误？

规格：R 2.14.2，刚刚更新了相关包。

# php - 如何按特定字段排列多个数组

> ID：14777247
> 
> 赞同：0
> 
> 时间：2013-02-08T16:39:18.310
> 
> 标签：php, multidimensional-array

我有一个数组，里面有多个数组。我正在尝试将这些数组从最大到最小 new_sales 排列。以下是大约 40 个数组的数组示例：

```
Array
(
    [0] => Array
        (
            [Tech] => Array
                (
                    [first_name] => Anthony
                    [last_name] => Bisignano
                )

            [0] => Array
                (
                    [new_sales] => 21
                    [upgrades] => 2
                )

        )

    [1] => Array
        (
            [Tech] => Array
                (
                    [first_name] => Arnold
                    [last_name] => Ybanez
                )

            [0] => Array
                (
                    [new_sales] => 5
                    [upgrades] => 0
                )

        ) 
```

我尝试使用的功能如下：

```
function aasort (&$techs, $key) {
    $sorter=array();
    $ret=array();
    reset($techs);
    foreach ($techs as $ii => $va) {
        $sorter[$ii]=$va[$key];
    }
    asort($sorter);
    foreach ($sorter as $ii => $va) {
        $ret[$ii]=$techs[$ii];
    }
    $techs=$ret;
    }

    aasort($test,"new_sales"); 
```

我是否使用了错误的功能或者我应该采取其他方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T16:45:05.287

PHP 中有一些排序函数支持用户定义的比较方法。像这样的代码应该可以帮助您开始使用它。

```
function cmp($a, $b)
{
    if ($a[0]['new_sales'] == $b[0]['new_sales']) {
        return 0;
    }
    return ($a[0]['new_sales'] < $b[0]['new_sales']);
}
usort($data, "cmp"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T16:46:39.790

在这种情况下，您可能希望使用`usort()`这样您可以定义您的排序逻辑。

所以是这样的：

```
usort($array, function($a, $b) {
    if ($a[0]['new_sales'] > $b[0]['new_sales']) {
        return -1; // note we use -1 here because we want a reverse sort
    } else if ($a[0]['new_sales'] < $b[0]['new_sales']) {
        return 1;
    } else {
        return 0;
    }
}); 
```

# hadoop - 了解有关 Hadoop/HDFS 数据加载的更多信息

> ID：14777255
> 
> 赞同：0
> 
> 时间：2013-02-08T16:39:41.663
> 
> 标签：hadoop, hdfs

我正在研究 Hadoop 和 MapReduce（我是初学者！）并且有一个关于 HDFS 的简单问题。我对 HDFS 和 MapReduce 如何协同工作有点困惑。

假设我有来自系统 A 的日志、推文和来自系统 B 的一堆文档。当它被加载到 Hadoop/HDFS 中时，这是否都被扔到一个大的 HDFS 存储桶中，或者会有 3 个区域（因为想要一个更好的词）？如果是这样，正确的术语是什么？

这些问题源于理解如何执行 MapReduce 作业。例如，如果我只想专注于日志，是否可以这样做，或者是否所有作业都在存储在集群上的整个内容上执行？

感谢您的指导！TM值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T18:37:56.307

HDFS 是一个文件系统。与在本地文件系统中一样，您可以将所有日志和文档组织到多个文件和目录中。当您运行 MapReduce 作业时，您通常会指定一个包含输入文件的目录。因此，可以仅在系统 A 的日志或系统 B 的文档上执行作业。

但是，映射器的输入由`InputFormat`. 大多数实现源自`FileInputFormat`读取文件。但是，可以实现自定义`InputFormats`以从其他来源读取数据。[您可以在本Hadoop 教程](http://developer.yahoo.com/hadoop/tutorial/module5.html#inputformat)中找到有关输入和输出格式的说明。

# macos - 在应用程序运行时停止拦截键盘输入 - CGEventTap

> ID：14777259
> 
> 赞同：0
> 
> 时间：2013-02-08T16:39:53.653
> 
> 标签：macos, cocoa, keyboard, keyboard-events, cgeventtap

使用 CGEventTap 停止观看键盘事件点击的正确方法是什么？

我正在构建一个简单的后台应用程序来转换特定键的输出。感谢[CGEventTap 上的这篇出色的帖子](https://stackoverflow.com/questions/5785630/modify-nsevent-to-send-a-different-key-than-the-one-that-was-pressed/5785895#5785895)，我已经能够启用密钥转换。不幸的是，我似乎无法阻止它而不是杀死该应用程序。

当用户切换复选框以打开或关闭功能时，将调用以下方法。切换 ON 立即发生。切换关闭可能需要一分钟或更长时间才能生效。我通过日志看到“已禁用。停止转换水龙头。” 被检测到。但关键转换仍在继续。我不明白为什么。

```
- (void)watchEventTap
{    
        @autoreleasepool
        {
            CFRunLoopSourceRef runLoopSource = NULL;
            CFMachPortRef eventTap = CGEventTapCreate(kCGHIDEventTap, kCGHeadInsertEventTap, kCGEventTapOptionDefault, CGEventMaskBit(kCGEventKeyUp) | CGEventMaskBit(kCGEventKeyDown) | CGEventMaskBit(NX_SYSDEFINED), myCGEventCallback, NULL);
            runLoopSource = CFMachPortCreateRunLoopSource(kCFAllocatorDefault, eventTap, 0);

            if (!eventTap)
            {
                NSLog(@"Couldn't create event tap!");
                exit(1);
            }

            if (self.shortcutEnabled) // User default toggled ON
            {
                NSLog(@"Enabled. Convert taps.");
                CFRunLoopAddSource(CFRunLoopGetCurrent(), runLoopSource, kCFRunLoopCommonModes);
                CGEventTapEnable(eventTap, true);
                // CFRunLoopRun(); // This blocks rest of app from executing
            }
            else // User default toggled OFF
            {
                NSLog(@"Disabled. Stop converting taps.");
                CFRunLoopRemoveSource(CFRunLoopGetCurrent(), runLoopSource, kCFRunLoopCommonModes);
                CGEventTapEnable(eventTap, false);
                // Clean up the event tap and source after ourselves.
                CFMachPortInvalidate(eventTap);
                CFRunLoopSourceInvalidate(runLoopSource);
                CFRelease(eventTap);
                CFRelease(runLoopSource);
                eventTap = NULL;
                runLoopSource = NULL;
            }
        }
//        exit(0);  // This blocks rest of app from executing
} 
```

感谢您的任何建议。我是新构建 Mac OS X 应用程序，所以如果我做一些无知的事情，请原谅我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T22:34:27.500

感谢一位经验丰富的 Mac 开发人员，我的问题得到了解决。每次调用该方法时，我都在创建一个新的 runLoopsSource。

现在我已经为 tapEvent 和 runLoop 创建了实例变量。只需一行即可停止 eventTap。修改方法如下：

```
- (void)watchEventTap
{

    @autoreleasepool
    {

        if ( [[NSUserDefaults standardUserDefaults] isEnabledNumLockDV] == YES ) // User default toggled ON
        {
            _runLoopSource = NULL;
             _eventTap = CGEventTapCreate(kCGHIDEventTap, kCGHeadInsertEventTap, kCGEventTapOptionDefault, CGEventMaskBit(kCGEventKeyUp) | CGEventMaskBit(kCGEventKeyDown) | CGEventMaskBit(NX_SYSDEFINED), myCGEventCallback, NULL);
            _runLoopSource = CFMachPortCreateRunLoopSource(kCFAllocatorDefault, _eventTap, 0);

            if (!_eventTap)
            {
                NSLog(@"Couldn't create event tap!");
                exit(1);
            }

            NSLog(@"Enabled. Convert taps.");
            CFRunLoopAddSource(CFRunLoopGetCurrent(), _runLoopSource, kCFRunLoopCommonModes);
            CGEventTapEnable(_eventTap, true);
        }
        else if ( [[NSUserDefaults standardUserDefaults] isEnabledNumLockDV] == NO ) // User default toggled OFF
        {
            NSLog(@"Disabled. Stop converting taps.");
            CGEventTapEnable(_eventTap, false);
        }

    }
} 
```

# asp.net - 删除文件夹不再导致 asp.net 应用程序在 asp.net 4 中重新启动

> ID：14777260
> 
> 赞同：0
> 
> 时间：2013-02-08T16:39:56.967
> 
> 标签：asp.net, application-restart

在 asp.net 2 中，删除文件夹会导致应用程序重新启动。但是今天发现asp.net 4中已经不存在这种行为了？我找不到有关此的任何信息。谁能告诉我这是不是真的？如果是的话，那就太棒了！我讨厌asp.net 2中的这个应用程序重启行为。你可以试试这个：

在 asp.net webforms (.net 3.5) 中调试以下代码，您将捕获 ThreadAbortException。但是当你在 asp.net webforms (.net 4) 中调试它时，你不会捕捉到任何异常；一切都很好。我认为我得到 ThreadAbortException 的原因是我删除了线程中的一个目录。然后应用程序重新启动，然后线程被中止。（环境：Win8、VS2012、IIS Express）

```
 protected void Page_Load(object sender, EventArgs e)
    {

        var thread = new Thread(() =>
        {
            var folderPath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "App_Data\\Test");
            var filePath = Path.Combine(folderPath, "test.txt");

            if (Directory.Exists(folderPath))
            {
                Directory.Delete(folderPath, true);
            }
            Directory.CreateDirectory(folderPath);
            System.IO.File.WriteAllText(filePath, "Hello");

            try
            {
                var loop = 100;

                while (loop > 0)
                {
                    Thread.Sleep(100);
                    loop++;
                }
            }
            catch (Exception ex)
            {
                var msg = ex.Message;
            }
        });
        thread.Start();

        Response.Write("Running");
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T16:48:09.147

据我所知，3.0 和 4.0 之间没有区别，以下操作将导致应用重新启动：

> 应用程序重新启动
> 
> 修改 Web 应用程序的源代码将导致 ASP.NET 将源文件重新编译为程序集。当您修改应用程序中的顶级项时，应用程序中引用顶级程序集的所有其他程序集也会重新编译。
> 
> 此外，在应用程序的已知文件夹中修改、添加或删除某些类型的文件将导致应用程序重新启动。以下操作将导致应用程序重新启动： •<br> 在应用程序的 Bin 文件夹中添加、修改或删除程序集。
> 
> • 从 App_GlobalResources 或 App_LocalResources 文件夹添加、修改或删除本地化资源。
> 
> • 添加、修改或删除应用程序的 Global.asax 文件。
> 
> • 添加、修改或删除App_Code 目录中的源代码文件。
> 
> • 添加、修改或删除配置文件配置。
> 
> • 在 App_WebReferences 目录中添加、修改或删除 Web 服务引用。
> 
> • 添加、修改或删除应用程序的Web.config 文件。

[MSDN 3.0 ASP.NET 应用程序生命周期概述](http://msdn.microsoft.com/en-us/library/ms178473%28v=vs.85%29.aspx)

[MSDN 4.0 ASP.NET 应用程序生命周期概述](http://msdn.microsoft.com/en-us/library/ms178473%28v=vs.100%29.aspx)

所以我想这取决于您在应用程序`which`目录中删除的文件夹。

# javascript - Javascript 代码无法访问数组

> ID：14777265
> 
> 赞同：0
> 
> 时间：2013-02-08T16:40:13.563
> 
> 标签：javascript

我是 Javascript 的初学者，我试图弄明白为什么有些东西不起作用。我创建了一个简单的页面，在该`<head>`部分中包含一些参考数组，然后我可以在`<body>`“头部”部分中访问这些参考数组，如下所示：

```
<!DOCTYPE html>
<html>
  <head>
    <script>
      var cities = [ "London", "New York" ];
    </script>
  </head> 
```

我想使用这个数组来驱动 HTML 正文中的下拉菜单，所以我想我会使用这个：

```
<body>
  <select id="dd_city">
    <script>
      for( i = 0; i < cities.length; i++)
      {
        document.write( "<option value=" + i + ">" + cities[i] + "</option>" )
      }
    </script>
  </select>
  ... 
```

我认为这是合理的，并且是基于我在网上找到的示例。但是，我发现它只会产生一个空下拉列表，就好像数组被视为空一样。我误解了什么或做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T16:42:32.340

你的语法是错误的。JavaScript中没有关键字`global`。

改成

```
<script>
  var cities = [ "London", "New York" ];
</script> 
```

^(您的语法应该在控制台中给您错误！)

未在函数范围内定义的变量会自动添加到`window`对象中，在浏览器环境中是全局范围。所以不需要定义任何像`global`关键字这样的东西。

其他注意事项：

*   定义全局变量被认为是不好的做法。当您加载多个脚本时，它可能会导致变量冲突。
*   `document.write`通常不是一个好主意。最好使用诸如[`innerHTML`](https://developer.mozilla.org/en-US/docs/DOM/element.innerHTML)在页面中获取动态内容之类的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T16:43:19.267

从城市前面删除 global 并使用 document.GetElementById 而不是 document.write。也不需要在选择标签之间有脚本，因为您有对选择 ID 的引用。

尝试

```
<head>
    <script>
        var cities = ["London", "New York"];
    </script>
</head>

<body>
    <select id="dd_city"/>
        <script>
            for (i = 0; i < cities.length; i++) {
                var option = "<option value=" + i + ">" + cities[i] + "</option>";
                document.getElementById("dd_city").innerHTML += option;
            }
        </script>
</body> 
```

我还建议不要使用全局变量，因为这可能与其他 JavaScript 脚本冲突。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T17:29:16.790

从哪里开始...首先，将您的 javascript 放在文档底部的结束正文标记之前被认为是一种很好的做法。有关原因的解释，请参见以下链接：

[http://developer.yahoo.com/performance/rules.html#js_bottom](http://developer.yahoo.com/performance/rules.html#js_bottom)

当您在文档底部包含 javascript 文件时，您将被迫将代码封装到函数中并将这些函数绑定到不同的事件。javascript 在很大程度上是一种事件驱动语言。

这将鼓励您编写可在整个项目中重用的更好的代码。我不会就编写好代码进行冗长的大讲堂，但我建议您选择一本好书来帮助您入门。比如[Javascript The Definitive Guide。](https://rads.stackoverflow.com/amzn/click/com/0596805527)

至于你目前拥有的代码，我会这样做：

```
<!DOCTYPE html>
<html>
    <head>
    </head>

    <body>
      <select id="dd_city"></select>
      <script>
          var initPage = function() {
              var cities = Array("London", "New York");
              var selectBox = document.getElementById("dd_city");

              for( var i = 0; i < cities.length; i++)
              {
                  var option = document.createElement("option");

                  option.setAttribute("value", i);
                  option.innerHTML = cities[i];
                  selectBox.appendChild(option);
              }
          };

          window.onload = initPage();
      </script>
    </body>
</html> 
```

[在我的jsfiddle](http://jsfiddle.net/wh1t3w0lf21/V6xAX/1/)上看到它的实际效果。

# c# - TcpClient 错误：无法建立连接，因为目标机器主动拒绝它

> ID：14777270
> 
> 赞同：0
> 
> 时间：2013-02-08T16:40:55.390
> 
> 标签：c#, vb.net, exception-handling, network-programming, tcpclient

我写了一个简单的 tcp/ip 聊天，它使用本地主机 IP（127.0.0.1）以及连接到本地网络上的另一台计算机。通过 Internet（v4 IP 地址）它不起作用，所以我尝试了[codeproject 示例](http://www.codeproject.com/Articles/38914/A-TCP-IP-Chat-Program)：

我下载了，但它在连接时抛出了同样的异常：

```
TcpClient Client = New TcpClient(IPAddr, 65535); 
```

我尝试使用另一个端口并关闭了 Windows-Firewall 和 Avira-Free。

**更新：** 如果我连接到另一个 Internet IP 地址，则会引发以下异常：

> 连接尝试失败，因为连接方在一段时间后没有正确响应，或者连接失败，因为连接的主机没有响应 IP-Address: 65535

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-08T18:28:08.990

可能这无济于事，但也许尝试另一个端口？

# java - 在使用 GridView 时想要更新 getView 方法

> ID：14777273
> 
> 赞同：3
> 
> 时间：2013-02-08T16:41:15.777
> 
> 标签：java, android

我正在为我的日历使用 baseadapter 类，它使用与数据库中的数据对应的图标填充日历。但是，我希望 getView 中的代码在用户单击日历时更新，从而立即显示一个新图标。如何在不创建 baseAdapter 类的新实例的情况下执行此操作？

这是我的 baseAdapter 类：

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T16:47:57.353

对于更新 ListView 和 gridView，您应该调用方法 adapter.notifyDataSetChanged。它将刷新所有可见项目。您应该在 getView() 方法中返回新视图，这取决于您的意愿。

# wpf - WPF：通过将鼠标拖动到多个按钮上来切换多个按钮

> ID：14777277
> 
> 赞同：0
> 
> 时间：2013-02-08T16:41:23.640
> 
> 标签：wpf, mouseover, togglebutton

是否可以通过将鼠标拖到多个 ToggleButtons 上（按住鼠标左键）来切换它们的状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:45:40.697

框中没有任何支持此功能的内容，但您应该能够订阅[MouseMove](http://msdn.microsoft.com/en-us/library/system.windows.uielement.mousemove.aspx)并在按下按钮时切换状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T18:22:16.230

```
<ToggleButton Content="ToggleButton" MouseEnter="ToggleButtonMouseEnter" Width="80" HorizontalAlignment="Left"/>

private void ToggleButtonMouseEnter(object sender, MouseEventArgs e)
{
     System.Windows.Controls.Primitives.ToggleButton tb = (System.Windows.Controls.Primitives.ToggleButton)sender;
     if(e.LeftButton == MouseButtonState.Pressed) tb.IsChecked = !tb.IsChecked;
} 
```

# for-loop - “for”命令不适用于（set）元素中的空格

> ID：14777278
> 
> 赞同：1
> 
> 时间：2013-02-08T16:41:24.807
> 
> 标签：for-loop, command, set

我正在研究一个命令脚本，它将某个文件的文件大小存储为变量，以便稍后在脚本中输出它。

除非命令的 (set) 部分指向其中包含空格的路径，否则我可以让它完美地工作。

这有效：

```
for /F %%A in ("%userprofile%\desktop\test2\test.jpg" ) do If %%~zA GTR 0 set INITIALSIZE=%%~zA 
msg "%username%" size of file: %INITIALSIZE% 
```

它会打开一个对话框，文件大小为 test.jpg。

如果我将“test2”文件夹的名称更改为“test 2”，它就会停止工作。它从不将值存储到 INITIALSIZE 中。这是必需的，因为最终脚本将指向的实际路径位于 Program Files 中。

这些不起作用：

```
for /F %%A in ("%userprofile%\desktop\test 2\test.jpg" ) do If %%~zA GTR 0 set INITIALSIZE=%%~zA 
msg "%username%" size of file: %INITIALSIZE% 

for /F %%A in (""%userprofile%\desktop\test 2\test.jpg"" ) do If %%~zA GTR 0 set INITIALSIZE=%%~zA 
msg "%username%" size of file: %INITIALSIZE% 

for /F %%A in ("%userprofile%\desktop\"test 2"\test.jpg" ) do If %%~zA GTR 0 set INITIALSIZE=%%~zA 
msg "%username%" size of file: %INITIALSIZE% 

for /F %%A in ("'%userprofile%\desktop\test 2\test.jpg'" ) do If %%~zA GTR 0 set INITIALSIZE=%%~zA 
msg "%username%" size of file: %INITIALSIZE% 
```

关于这里需要使用什么语法的任何想法？原谅我的无知我是新手。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:03:10.883

这是一个如何做到这一点的例子

```
@echo off
set file1="d:\new folder\test.jpg"
call :getfilesize %file1% size
echo %size%
goto :eof

:getfilesize %a
set size=%~z1
goto :eof 
```

# php - 注意：PDO 数据库连接上的数组到字符串转换

> ID：14777280
> 
> 赞同：1
> 
> 时间：2013-02-08T16:41:27.350
> 
> 标签：php, mysql, arrays, pdo

我正在尝试使用 PDO 进行数据库连接。不知何故，我得到了这个错误..或注意到，但我不知道为什么，它不输出名称......

注意：第 31 行 (location) 中的数组到字符串转换，即

```
 (print $row[0] . "\t";) 
```

我不知道为什么？

完整代码：

```
 $query = "SELECT naam FROM paginas"; 

    try 
    { 
        $stmt = $db->prepare($query); 
        $result = $stmt->execute(); 
    } 
    catch(PDOException $ex) 
    { 
        die("Failed to run query: " . $ex->getMessage()); 
    } 

    $row = $stmt->fetchALL(); 

     print $row[0] . "\t"; 
```

问候，梅林

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T16:44:15.600

`PDO::fetchAll()`返回一个**记录数组**，其中记录的类型取决于您使用的获取样式。

由于您使用的是 PDO 的默认提取样式，它将返回一个数组数组。在你的情况下，它看起来像：[`PDO::FETCH_BOTH`](http://php.net/manual/en/pdostatement.fetch.php) `PDO::fetchAll()`

```
array(2) {
  [0] =>
  array(2) {
    [0] =>
    string(3) "foo"
    'naam' =>
    string(3) "foo"
  }
  [1] =>
  array(2) {
    [0] =>
    string(3) "bar"
    'naam' =>
    string(3) "bar"
  }

  ...
} 
```

所以 $row[0] 是一个数组。您将不得不处理它的索引。正如您在我上面发布的示例数组中看到的那样，您可以使用：

```
print $row[0]['naam'] . "\t"; 
```

或者

```
print $row[0][0] . "\t"; 
```

* * *

更新：如果您想遍历记录而不是一次获取所有记录，请使用[`PDOStatement::fetch()`](http://php.net/manual/en/pdostatement.fetch.php). 像这样：

```
while($row = $stmt->fetch()) {
    print $row['naam'] . "\t";
} 
```

请注意，`$row`现在是一维数组。这可能是你想要的。

# c - 退出 C 程序

> ID：14777283
> 
> 赞同：2
> 
> 时间：2013-02-08T16:41:35.733
> 
> 标签：c

我是 C 编程新手。在下面的程序中，如果程序收到输入“退出”，我只是想立即退出 C 程序，而不会看到任何其他对话框。

但是，我正在尝试使用它来完成此操作`exit(0);`，在程序退出之前，它会输出类似

```
success
process exited with return value 0
Press any key to continue... 
```

我试图避免此对话框并立即退出程序。这可能吗？

我很感激这方面的任何帮助。

提前谢谢了！

我的 C 代码：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main(void)  {
    char command1[256], command2[256];
    printf("# ");
    scanf("%s", command1);
    if(strcmp(command1,"quit")==0){
        printf("success");
        exit(0);
    }else{
        printf("unknown command");
    }

system("PAUSE");
return 0;

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T16:43:18.147

您看到的消息实际上是由 Visual Studio 调试器生成的。它并不是真正来自您的程序。

如果您想验证您的程序实际上没有显示任何消息（也没有等待按键），只需尝试从 Windows 命令提示符运行它。您也可以尝试在 Visual Studio 中以“发布”模式运行程序。这也将证实这一点。

调试器显示该信息的原因只是为了帮助您了解程序正在发生的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T16:43:11.060

该输出不是来自您的程序，而是来自运行您的程序的程序。最有可能是“Visual Studio”，但我希望其他类型的 IDE 可能会做类似的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T16:45:16.710

您可以发布执行环境的详细信息吗？似乎您的进程正在被另一个正在打印“按任意键继续”行的应用程序（可能是专门的 shell）监视退出代码

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T16:47:15.860

`process exited with return value 0`当然不是来自您的代码，而是来自您的输入和输出中间的程序。

我在命令行（Mac OSX）上编译了它，并得到了以下输出：

```
James:Desktop iPhone$ gcc code.c 
James:Desktop iPhone$ ./a.out
# quit
successJames:Desktop iPhone$ 
```

`system("PAUSE");`请注意，我没有到达

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-02T17:11:42.950

如果您使用的是 Dev-C++ 并且想要摆脱该消息，请执行以下操作：

**工具菜单**->**环境选项**->**常规选项卡**

然后取消选中**返回后暂停程序**选项。

来源：[http ://www.cplusplus.com/forum/general/89249/](http://www.cplusplus.com/forum/general/89249/)

# linux - lio_listio：如何等待所有请求完成？

> ID：14777284
> 
> 赞同：1
> 
> 时间：2013-02-08T16:41:39.737
> 
> 标签：linux, posix, aio

在我的 C++ 程序中，我使用该`lio_listio`调用一次发送许多（最多几百个）写请求。之后，我做了一些计算，当我完成后，我需要等待所有未完成的请求完成，然后才能提交下一批请求。我怎样才能做到这一点？

现在，我只是`aio_suspend`循环调用，每次调用一个请求，但这看起来很难看。看起来我应该使用`struct sigevent *sevp`参数来`lio_listio`. 我目前的猜测是我应该做这样的事情：

*   在主线程中，创建一个互斥锁并在调用`lio_listio`.
*   在对 的调用中`lio_listio`，指定解锁此互斥锁的通知函数/信号处理程序。

这应该给我想要的行为，但它会可靠地工作吗？是否允许从信号处理程序上下文中操作互斥锁？我读到 pthread 互斥锁可以提供错误检测，并且如果您尝试从同一个线程再次锁定它们或从不同的线程解锁它们，则此解决方案依赖于死锁。

示例代码，使用信号处理程序：

```
void notify(int, siginfo_t *info, void *) {
    pthread_mutex_unlock((pthread_mutex_t *) info->si_value);
}

void output() {
    pthread_mutex_t iomutex = PTHREAD_MUTEX_INITIALIZER;

    struct sigaction act;
    memset(&act, 0, sizeof(struct sigaction));
    act.sa_sigaction = &notify;
    act.sa_flags = SA_SIGINFO;
    sigaction(SIGUSR1, &act, NULL);

    for (...) {
        pthread_mutex_lock(&iomutex);

        // do some calculations here...

        struct aiocb *cblist[];
        int cbno;
        // set up the aio request list - omitted

        struct sigevent sev;
        memset(&sev, 0, sizeof(struct sigevent));
        sev.sigev_notify = SIGEV_SIGNAL;
        sev.sigev_signo = SIGUSR1;
        sev.sigev_value.sival_ptr = &iomutex;

        lio_listio(LIO_NOWAIT, cblist, cbno, &sev);
    }

    // ensure that the last queued operation completes
    // before this function returns
    pthread_mutex_lock(&iomutex);
    pthread_mutex_unlock(&iomutex);
} 
```

示例代码，使用通知功能 - 可能效率较低，因为创建了一个额外的线程：

```
void output() {
    pthread_mutex_t iomutex = PTHREAD_MUTEX_INITIALIZER;

    for (...) {
        pthread_mutex_lock(&iomutex);

        // do some calculations here...

        struct aiocb *cblist[];
        int cbno;
        // set up the aio request list - omitted

        struct sigevent sev;
        memset(&sev, 0, sizeof(struct sigevent));
        sev.sigev_notify = SIGEV_THREAD;
        sev_sigev_notify_function = &pthread_mutex_unlock;
        sev.sigev_value.sival_ptr = &iomutex;

        lio_listio(LIO_NOWAIT, cblist, cbno, &sev);
    }

    // ensure that the last queued operation completes
    // before this function returns
    pthread_mutex_lock(&iomutex);
    pthread_mutex_unlock(&iomutex);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T18:44:37.160

如果您在 lio_listio() 调用中设置 sigevent 参数，则当该特定调用中的所有作业完成时，您将收到一个信号（或函数调用）通知。您仍然需要：

1.  等到您收到与发出 lio_listio() 调用一样多的通知时，才能知道它们何时完成。

2.  使用某种安全机制从信号处理程序与主线程进行通信，可能通过全局变量（可移植）。

如果您使用的是 linux，我建议您将 eventfd 绑定到您的 sigevent 并等待。这更加灵活，因为您不需要涉及信号处理程序。在 BSD（但不是 Mac OS）上，您可以使用 kqueue 在 aiocbs 上等待，而在 solaris/illumos 上，您可以使用端口来获取 aiocb 完成的通知。

以下是如何在 linux 上使用 eventfds[的示例：](http://www.xmailserver.org/eventfd-aio-test.c)

附带说明一下，在使用 lio_listio 发布作业时我会谨慎行事。您不能保证它支持接受超过[2 个工作](http://pubs.opengroup.org/onlinepubs/009696699/basedefs/limits.h.html)，并且某些系统对您一次可以发布的数量的限制非常低。例如，Mac OS 上的默认值为 16。此限制可以定义为 AIO_LISTIO_MAX 宏，但不一定。在这种情况下，您需要调用 sysconf(_SC_AIO_LISTIO_MAX) （请参阅[文档](http://pubs.opengroup.org/onlinepubs/9699919799/functions/sysconf.html)）。有关详细信息，请参阅[lio_listio 文档](http://pubs.opengroup.org/onlinepubs/9699919799/functions/lio_listio.html)。

您至少应该检查 lio_listio() 调用中的错误情况。

此外，您使用互斥锁的解决方案是次优的，因为您将同步 for 循环中的每个循环，并且一次只运行一个（除非它是一个递归互斥锁，但在这种情况下，如果您的信号，它的状态可能会损坏处理程序恰好落在不同的线程上）。

更合适的原语可能是信号量，它在处理程序中释放，然后（在您的 for 循环之后）获取与您循环相同的次数，调用 lio_listio()。但是，如果可以特定于 linux，我仍然会推荐一个 eventfd。

# html - 液柱排列

> ID：14777285
> 
> 赞同：0
> 
> 时间：2013-02-08T16:41:42.640
> 
> 标签：html, css

我正在尝试以表格样式显示一些复选框，但我需要根据屏幕的宽度来确定列数。如果我让他们自己重新安排，我会以这样的方式结束：

```
+-----------------------------------------------------+
|                                                     |
|   [] label1  [] label2  [] label3  [] label 4       |
| [] label5          [] label6   [] label7            |
|     [] label8  []label9  [] label10  []label11      |
|                                                     |
+-----------------------------------------------------+ 
```

我需要这样的东西：

```
+-----------------------------------------------------+
|                                                     |
|   [] label1  [] label2  [] label3  [] label4        |
|   [] label5  [] label6  [] label7  [] label8        |
|   []label9   [] label10 []label11                   |
|                                                     |
+-----------------------------------------------------+ 
```

有可能实现这一目标吗？

我不在乎列的宽度是否相同，但我需要完整的东西来填充 100% 的容器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T16:48:46.777

```
#container {
    width:100%;
    height:auto;
    min-height:300px;
    padding:10px;
}
#container div {
    width:70px;
    float:left;
    display:inline-block;
} 
```

这是[小提琴](http://jsfiddle.net/4Bu4M/1/)

# sql - Foxpro/SQL 将值从光标复制到 id 匹配的表

> ID：14777286
> 
> 赞同：0
> 
> 时间：2013-02-08T16:41:43.593
> 
> 标签：sql, insert, foxpro

我有一个带有 ID 列和[备忘录类型](http://msdn.microsoft.com/en-us/library/aa975373%28v=vs.71%29.aspx)列的 Excel 文档。（我创建了一个名为 Sheet01 的游标）我还有一个名为 Caption 的表，其中包含一个 ID 列、[备忘录类型](http://msdn.microsoft.com/en-us/library/aa975373%28v=vs.71%29.aspx)列和一个代码 (char)。

我需要将文档中备注列的值插入表中，并为现有列分配我选择的值（在本例中为“DE”）。

光标 Sheet01 中的 ID 列的所有数字都像这样：28.00000000（从 1 到 ~ 1200）
而 Caption 表像这样：28

这是我最好的尝试，但显然它不起作用。帮助！

```
INSERT INTO captions2(captionid, caption, code) 
SELECT captionid, <caption from the colum 'Header'>, 'DE' FROM Sheet01 WHERE c2.Captionid = Sheet01.Captionid 
```

示例图片：

[http://i.imgur.com/4ugkR7v.png](https://i.imgur.com/4ugkR7v.png)

如何从excel中获取数据到光标？我有一个功能，但类似于 APPEND FROM 或任何其他方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T18:32:04.233

您的 SELECT 语句不正确。尝试加入如下表格。

```
INSERT INTO captions2(captionid, caption, code) 
SELECT  s.captionid, c.caption, "DE"
FROM sheet01 s INNER JOIN captions2 c
    ON s.captionid = c.captionid 
```

# html - 将 image_tag 压缩为一个

> ID：14777290
> 
> 赞同：0
> 
> 时间：2013-02-08T16:42:02.163
> 
> 标签：html, css, ruby-on-rails, ruby, nivo-slider

我想知道有没有一种方法可以将所有 image_tag 图片标签压缩成一个？我在标题中使用 Nivo 滑块，我不想在我的布局页面中写入所有图像标签，那么有什么解决方案吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T16:53:05.927

将它们放在子目录中，或使用可以通过`Dir.glob`.

然后，您可以将生成的集合映射到`image_tag`s 并呈现该集合。

# java - ColdFusion jvm 垃圾收集不

> ID：14777292
> 
> 赞同：4
> 
> 时间：2013-02-08T16:42:12.343
> 
> 标签：java, coldfusion, garbage-collection, jvm, coldfusion-9

我有一个 cfc 方法，它遍历一个列表并通过 cfhttp 进行一系列 SOAP 调用。然后将结果插入数据库。

该过程本身运行良好，问题是java内存慢慢填满，最终（取决于返回的记录中的元素数量）停止工作。没有错误或任何可见的东西它只是停止。如果我通过 Coldfusion 管理员查看应用程序日志文件，我会看到以下一个或两个错误：

```
GC overhead limit exceeded The specific sequence of files included or processed is: 
```

或者

```
Java heap space The specific sequence of files included or processed is: 
```

下面是我正在运行的代码的简化版本：

```
<cfsetting requesttimeout="3600">
<cfloop condition="thisPass lt 10">
    <cfscript>
        runtime = CreateObject("java","java.lang.Runtime").getRuntime();
        objSystem = CreateObject( "java", "java.lang.System" );
        soapBody = '';
        soapResponse = '';
        thisStruct = '';
        lock scope='application' type='exclusive' timeout='60' {

//This is where I am trying to manage the memory and call garbage collection

        try {
            freeMemory = runtime.freeMemory()/1024/1024;
            writeOutput("- fm = "&freeMemory);
            if (freeMemory < 200){
                objSystem.gc();
                sleep(1000);
                writeDump(' - dumping freeMemory');
             }
         }
         catch(any error) {
            writeDump(' - trying to dump GC as '&now()& ' freeMemory = '&freeMemory);
         }
         }
        </cfscript>
        <cfsavecontent variable="soapBody">
            <?xml version="1.0" encoding="utf-8"?>
            [ BUILD SOAP ENVELOP ]
        </cfsavecontent>

        <cfhttp url="[URL]" method="post" result="httpResponse" 
                        timeout="600" resolveurl="false">
                <cfhttpparam type="header" name="SOAPAction" value="[URL2]" />
                <cfhttpparam type="xml" value="#trim( soapBody )#"/>
            </cfhttp>

            <cfscript>
                soapBody = "";
                soapResponse = httpResponse.fileContent;
                soapResponse = xmlParse( soapResponse );
                thisStruct = xmlSearch(soapResponse,'/soap:Envelope/soap:Body/')[1].xmlChildren[1].xmlChildren[1].xmlChildren;
                writeOutput("-"&arrayLen(thisStruct)&' records');
                getPageContext().getOut().flush();
                if(arrayLen(thisStruct) == 2500){
                    thisPass = thisPass+1;
                } else {
                    writeOutput("- total records = "&(2500*(thisPass-1))+arrayLen(thisStruct));
                    thisPass = 100; // since looping while thisPass lt 10 this should prevent the next iteration
                }
            </cfscript>

            <cfloop from="1" to="#arrayLen(thisStruct)#" index="i">
                [RUN PROC TO INSERT RECORDS]
            </cfloop>
        </cfloop> 
```

GC 似乎*有时会*释放一些内存，但没有任何可靠性。我知道 GC() 只是*建议*java 释放一些未使用的内存，但我不确定如何让它强制它释放内存。有可能某处有泄漏，但我没有看到。我希望这是我已经看过的显而易见的事情，并且我承认我的 Java 知识非常有限。

有没有一些java大师可以看到我的错误？

## **更新：**这是一个输出示例，这有助于查看内存的下降。

有 236 个列表要循环

1.  88185 - fm = 293.564407349 -6 记录 - 总记录 = 6
2.  88389 - fm = 290.86995697 -116 条记录 - 总记录 = 116
3.  88390 - fm = 308.382568359 -262 条记录 - 总记录 = 262
4.  88839 - fm = 292.707099915 -2032 条记录- 总记录 = 2032
5.  91088 - fm = 290.711753845 -6 记录 - 总记录 = 6
6.  92998 - fm = 287.754066467 -5 条记录 - 总记录 = 5
7.  95510 - fm = 309.919425964 -91 条记录 - 总记录 = 91
8.  96478 - fm = 292.035064697 -1180 条记录- 总记录 = 1180
9.  96479 - fm = 259.001213074 -1113 条记录 - 总记录 = 1113
10.  96480 - fm = 261.121406555 -110 条记录 - 总记录 = 110
11.  96796 - fm = 267.235244751 -2 记录 - 总记录 = 2
12.  96799 - fm = 265.037582397 -0 记录 - 总记录 = 0
13.  97435 - fm = 263.589103699 -2500 条记录 - fm = 227.629760742 -2500 条记录 - fm = 200.85987854 -2500 条记录 - fm = 202.156776428 -2500 条记录 - fm = 166.366210938 - 倾倒 freeMemory = 10966 条记录 - 共 106 条记录
14.  98173 - fm = 160.579734802 - 转储 freeMemory -35 记录 - 总记录 = 35
15.  99111 - fm = 176.218482971 - 转储 freeMemory -0 记录 - 总记录 = 0
16.  100998 - fm = 194.708694458 - 转储 freeMemory -185 记录 - 总记录 = 185
17.  101811 - fm = 160.61415863 - 转储 freeMemory -2500 条记录 - fm = 112.862670898 - 转储 freeMemory -2500 条记录 - fm = 86.2071380615 - 转储 freeMemory -2500 条记录 - fm = 52.9639358521 - 转储 freeMemory -2500 条记录 = 总共 85640 条记录
18.  105014 - fm = 56.1721343994 - 转储 freeMemory -14 记录 - 总记录 = 14
19.  105992 - fm = 73.0022964478 - 转储 freeMemory -14 记录 - 总记录 = 14
20.  107539 - fm = 75.9522399902 - 转储 freeMemory -93 记录 - 总记录 = 93
21.  107580 - fm = 58.345199585 - 转储 freeMemory -2500 条记录

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:16:13.423

这不是 Java 不能很好地管理 GC 的情况，而是你没有管理你正在放入（和取出〜）内存的内容，以便垃圾收集器可以清理它们. 你（试图〜）治疗症状而不是这里的问题。

查看内存中的内容以及为什么您希望被 GC 处理*的东西没有*被 GC 处理。可能是您引用了共享范围内的东西（出乎意料），或者类似的东西。不过，在 Java 之上使用 ColdFusion 对这类事情进行故障排除是一门黑暗的艺术。

但是不要试图“修复”当你强制 GC 时没有被 GC 处理的东西的“问题”，修复导致你的内存 a) 填满的问题；b) 当你认为它应该是不具备 GC 能力的时候。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:20:25.107

我可以说 force GC 方法在我尝试时对我没有多大帮助。一般来说，这里列出了首先要尝试的事情：

*   确保在您调用变量的对象中使用 var 或 local
*   如果您可以将处理移至数据库，请执行此操作
*   删除`<cfdump>`，`<cfdump>`很重。如果您确实需要使用它，请仅关注需要的变量部分。也使用文本格式
*   更改 JVM 以使用更多内存
*   使用 Java 1.7 和 G1GC 。（请谨慎执行此操作，因为它可能尚不受支持）
*   使用更少的查询

这是我会为您的上述代码考虑的列表

*   我会将外观中的所有内容移动到一个函数和 var scope soapbody soapResponse, thisStruct
*   在我完成这个Stuct之后，我会`StructClear(thisStruct);`
*   写下`writedump();`他们喜欢的领域`<cfdump>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T22:18:42.500

经过大量搜索后，我发现这个特定问题的最佳“修复”是删除试图进行垃圾收集并增加 Java 堆大小的代码。在 /jrun/bin/jvm.config 文件中。

通过将参数更改为 VM 为：

```
java.args=-server -Xms2048m -Xmx2048m -Xmn1024m -Dsun.io.useCanonCaches=false -XX:MaxPermSize=192m -XX:+UseParallelGC -Xbatch -Dcoldfusion.rootDir={application.home}/ -Djava.security.policy={application.home}/servers/cfusion/cfusion-ear/cfusion-war/WEB-INF/cfusion/lib/coldfusion.policy -Djava.security.auth.policy={application.home}/servers/cfusion/cfusion-ear/cfusion-war/WEB-INF/cfusion/lib/neo_jaas.policy 
```

我能够将初始堆大小 (Xms) 和最大堆大小 (Xmx) 增加到 2048m，并将“*年轻一代*”堆大小 (Xmn) 增加到 1024m 因为有人建议我年轻一代应该更小比初始和最大值更好的垃圾收集。

正如**James**所建议的那样，我注释掉了实际的进程（它们在一个函数中并且是 var'd），然后每次都取消注释它们一次运行所有的东西。我从中学到的是，大型 SOAP 响应是填满内存的，而不是我担心的泄漏。

正如**Adam**所提到的，这与 Java 管理 GC 无关，而是没有足够的空间来管理，因为我正在扔（出于某种原因，CF 不喜欢很好地处理 2500 条记录 SOAP 响应）去数字。

**Adam**说在 CF 中对 Java 内存进行故障排除是一门“黑艺术”也是正确的。通过使用服务器监视器`http://localhost/CFIDE/administrator/monitor/launch-monitor.cfm`并转到 Memory Usage -> Memory Usage Summary 下的统计选项卡，我可以看到内存慢慢填满并自行转储，即使在重新启动后没有任何进程在运行。永远无法弄清楚原因，但我可以看到正在运行的级别以及我正在达到顶峰。

jvm.config 文件中分配的默认内存是 512m，根本不足以处理正在发生的事情。可能有更好的方法来处理这个整个过程。可能必须实施**亨利的**建议并将其放入数据库并对其进行分块，尽管这对我来说听起来很笨拙。

我敢肯定，除了 CF 现在占用了大量资源之外，这个解决方案可能还有其他问题，但（目前）它似乎正在按需要工作。

**更新：** 我更改了 cfc 函数，因此我没有将所有内容都插入数据库，而是将所有 XML 写入文件，然后读取文件并插入数据库。不知何故，写入文件允许java“呼吸”足够长的时间来执行 GC() 本身。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T19:07:44.380

AFAIK CF 不擅长运行长请求。据我所知，在请求完成之前不会释放内存。

我们尝试的是将一个长请求分解为 CF 可以管理的较小请求，并且通常在请求完成后会释放内存。

我们使用的一个遗留系统会将任务插入到数据库表中，而 CF 调度程序将一次处理一批。由于延迟，我讨厌这样做，但这是 CF7 天需要做的事情，而且从那以后它似乎没有改善。

# xml - XSL 无法编译样式表

> ID：14777301
> 
> 赞同：2
> 
> 时间：2013-02-08T16:42:51.407
> 
> 标签：xml, xslt

当我尝试运行我的程序时，我无法弄清楚为什么我不断收到错误“无法编译 stlyesheet”。我假设这是我的样式表中的一个错误，但我似乎找不到它。

我可能只是在看它，但任何帮助将不胜感激。

谢谢！xsl 可以在下面找到。

* * *

```
 <?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
version="1.0">
  <xsl:output method="xml" indent="yes"/> 
   <xsl:template match="/"> 
 <PhoneBook> 
  <xsl:apply-templates/>
 </PhoneBook>
  </xsl:template>
<xsl:template match="AddressEntry">
<Entry>
  <xsl:apply-templates select="Name"/> 
  <xsl:apply-templates select="Address"/> 
</Entry>
</xsl:template>
<xsl:template match="Name">
<Name>
<xsl:apply-templates select="LastName"/>, 
<xsl:apply-templates select="FirstName"/> 
</Name>
</xsl:template>
 <xsl:template match="Address">
<LocatorInfo>
  <xsl:apply-templates select="PostalAddress/Street"/> 
  <xsl:apply-templates select="PostalAddress/City"/> 
 <xsl:apply-templates select="PostalAddress/PostalCode"/>
 <xsl:apply-templates select="Phone"/>
 </LocatorInfo>
 </xsl:template>
<xsl:template match="FirstName"> 
<xsl:value-of select="."/>
<xsl:value-of select="."/> 
</xsl:template>
 <xsl:template match="LastName">
<xsl:value-of select="."/>
</xsl:template>
 </xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-08T16:51:44.977

您在标签中有`version`两次指定。`xsl:stylesheet`更正它允许它编译。

* * *

附带说明一下，如果您没有可以编译或验证 XSL 的程序，您始终可以使用以下命令通过 Java 运行它

```
java com.sun.org.apache.xalan.internal.xsltc.cmdline.Compile test.xsl 
```

它将尝试编译您的 XSL 并在那时显示任何语法错误。当您没有合适的工具时，它非常适合解决此类问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-08T20:17:10.157

您已被告知为什么您的样式表无效，但您需要解决更深层次的问题：您为什么没有看到错误消息？

我不知道你是否使用撒克逊，但症状表明你可能是。如果您尝试从 Java 或 .NET 应用程序中编译样式表，编译错误消息将默认写入 System.err 输出流。在许多情况下，例如在 Web 服务器甚至桌面 GUI 中运行的应用程序中，System.err 的内容可能不会出现在您的屏幕上，因此将输出定向到可以找到它的地方很重要（使用web应用程序，至少在开发过程中，我经常将错误消息写入HTML响应页面）。API 中有多种机制可以实现这一点，例如通过编写自己的 ErrorListener - 详细信息取决于您使用的 API。

或者，使用专门为此目的设计的开发环境（例如 oXygen 或 Stylus Studio）开发和调试您的样式表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T16:54:26.547

它没有编译，因为您在“xsl:stylesheet”元素中有两个“版本”属性。导致格式错误的（非 XML）文档。

在 XML 中，一个元素节点不能有两个同名的属性节点。

# php - 我可以在我自己的网站中使用谷歌地图 API 并将其链接到 Android 应用程序吗？

> ID：14777302
> 
> 赞同：0
> 
> 时间：2013-02-08T16:42:52.403
> 
> 标签：php, android

我写了一个安卓应用程序，它通过相机意图拍照，将图片保存在 sd 卡上，通过 GPS 检测用户位置，并在谷歌地图上叠加图片。现在我想制作一个网络服务器来存储图像及其信息，即地图上的位置，并在我的网站上的谷歌地图上显示叠加层。我可以在我自己的网站上使用谷歌地图 API 并制作叠加层吗？我想使用 php 进行网站开发。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:50:32.847

> 我可以在我自己的网站上使用谷歌地图 API 并制作叠加层吗？

是的，你当然可以。

[看这里](https://developers.google.com/maps/documentation/javascript/overlays)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-10T06:25:29.063

是的，您可以使用 Google API for Overlay 打开此链接[Google API](https://developers.google.com/maps/documentation/javascript/overlays)

# c - 在不使用 libc 的情况下获取输入

> ID：14777303
> 
> 赞同：1
> 
> 时间：2013-02-08T16:42:57.137
> 
> 标签：c

在不使用 libc 的情况下如何获取输入或打印输出？我可以使用系统调用，但不知道这是否有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:45:10.910

我通过`write(2)`gdb 逐步了解系统调用 ABI 的工作原理。

无论如何，根本没有libc。请注意，如果没有特殊技巧，cc(1) 编译器/链接器前端仍会将您与 libc 链接，但您不会将它用于任何事情。C 运行时启动代码将进行一些 libc 调用，但该程序不会。

```
void mywrite(int fd, const void *b, int c) {
  asm("movl $1, %eax");
  asm("syscall");
}

int main(void) { const char *s = "Hello world.\n"; return mywrite(1, s, 13), 0; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T20:04:17.340

没有独立于平台的方法可以做到这一点。事实上，拥有的全部意义在于`libc`为大多数系统提供的一组功能提供一个通用接口，但以根本不同的方式实现。

您最好的选择可能是查阅您当前使用的任何系统的文档。您可以查找操作系统的中断集，然后尝试使用`asm`关键字编写汇编指令，告诉操作系统读取输入或显示输出。您可以查看操作系统提供的用于对文件描述符进行输入和输出的库，然后改用这些函数。或者，您可以查看进程创建库，然后生成一个进程以从控制台读取或写入数据，其中第二个程序使用`libc`. 但是，这些都不能保证是可移植的。

希望这可以帮助！

# php - 从 Excel 电子表格中删除密码 - 密码已知

> ID：14777304
> 
> 赞同：0
> 
> 时间：2013-02-08T16:42:56.973
> 
> 标签：php, perl, excel, passwords

我们有一堆由 Perl 脚本处理的 Excel 电子表格。这些电子表格受密码保护（我们知道密码）。我们需要的是能够使用 Perl 或 PHP 从电子表格中删除密码并保存解密的文件。该脚本将在 BSD 服务器上运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:36:27.103

抱歉，在 linux 上不可能：[Reading password protected XLSX on linux (and windows) with Perl](https://stackoverflow.com/questions/7967224/reading-password-protected-xlsx-on-linux-and-windows-with-perl)

（您可以使用 OpenOffice/Libreoffice 打开/转换它，但这不是一个简单的方法）

如果你在 Windows 上运行它，你也许可以用 win32::ole [http://www.perlmonks.org/?node_id=319647](http://www.perlmonks.org/?node_id=319647)

[更详细的代码示例： http](http://bytes.com/topic/perl/answers/746842-opening-password-protected-excel-file-using-win32-ole-perl) ://bytes.com/topic/perl/answers/746842-opening-password-protected-excel-file-using-win32-ole-perl

# mysql - 重命名表中的文件名

> ID：14777307
> 
> 赞同：3
> 
> 时间：2013-02-08T16:43:05.783
> 
> 标签：mysql, sql

我有一张桌子

```
'310', 'D', '1', '0', 'Clowns.jpg', ?, '63527560196'
'311', 'D', '1', '1', 'Clowns_102_x_102.jpg', ?, '63527560197'
'312', 'D', '1', '1', 'Clowns_45_x_45.jpg', ?, '63527560197'
'313', 'D', '1', '1', 'Clowns_80_x_80.jpg', ?, '63527560197'
'314', 'D', '1', '1', 'Clowns_120_x_120.jpg', ?, '63527560198'
'315', 'D', '1', '1', 'Clowns_180_x_180.jpg', ?, '63527560198'
'316', 'D', '1', '1', 'Clowns_300_x_300.jpg', ?, '63527560198' 
```

我想将名为 Clowns 的文件重命名为 Clowning，以便数据看起来像这样

```
'310', 'D', '1', '0', 'Clowning.jpg', ?, '63527560196'
'311', 'D', '1', '1', 'Clowning_102_x_102.jpg', ?, '63527560197'
'312', 'D', '1', '1', 'Clowning_45_x_45.jpg', ?, '63527560197'
'313', 'D', '1', '1', 'Clowning_80_x_80.jpg', ?, '63527560197'
'314', 'D', '1', '1', 'Clowning_120_x_120.jpg', ?, '63527560198'
'315', 'D', '1', '1', 'Clowning_180_x_180.jpg', ?, '63527560198'
'316', 'D', '1', '1', 'Clowning_300_x_300.jpg', ?, '63527560198' 
```

所以我尝试了这个

```
UPDATE new_images 
SET 
filespec = 'clowns100' + MID(filespec, 7, LENGTH(filespec) - 6); 
```

然而我得到了

> 错误代码：1292。截断不正确的 DOUBLE 值：“小丑100”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T16:44:27.330

采用`REPLACE`

```
UPDATE new_images SET filespec = REPLACE(filespec, 'Clowns','Clowning') 
```

*   [MySQL 替换（*字符串函数*）](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_replace)

**更新 1**

您查询的等效 mysql 代码是

```
UPDATE new_images 
SET filespec = CONCAT('clowns100', MID(filespec, 7, CHAR_LENGTH(filespec) - 6)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:00:27.423

您可以在 SQL 中使用子字符串

```
 UPDATE new_images SET filespec = 'Clowning'+substring('Clowns.jpg', 7, len('Clowns.jpg') - 6) where filespec like 'Clowns%' 
```

# javascript - HTML5 Canvas - 在圆上绘制线性渐变（色轮）

> ID：14777315
> 
> 赞同：1
> 
> 时间：2013-02-08T16:43:20.827
> 
> 标签：javascript, html5-canvas, linear-gradients, radial-gradients, color-wheel

我正在尝试绘制一个圆圈，而不是径向渐变，而是围绕圆圈的线性渐变......基本上，我正在尝试创建一个色轮，它必须是动态的，因为颜色可以自定义.. .但是，我完全不知道如何处理这件事......

我想我可以画出自己的圆圈并给它上色，然后用更大的半径循环这个过程来填充它。但事实证明，这不仅效率极低，而且非常有问题......

这是我的第一次尝试：http: [//jsfiddle.net/gyFqX/1/](http://jsfiddle.net/gyFqX/1/) 我坚持使用该方法，但将其更改为为圆上的每个点填充一个 2x2 正方形。它可以混合多达 3 种颜色，但随后您开始注意到它的失真。

无论如何，我一直在努力，这就是我现在所拥有的：http: [//jsfiddle.net/f3SQ2/](http://jsfiddle.net/f3SQ2/)

```
var ctx = $('#canvas')[0].getContext('2d'),
    points = [],
    thickness = 80;

for( var n = 0; n < thickness; n++ )
    rasterCircle( 200, 200, (50 + n) );

function fillPixels() {
    var size = points.length,
        colors = [ 
            hexToRgb( '#ff0000' ), // Red
            hexToRgb( '#ff00ff' ), // Magenta
            hexToRgb( '#0000ff' ), // Blue
            hexToRgb( '#00ffff' ), // Teal
            hexToRgb( '#00ff00' ), // Green
            hexToRgb( '#ffff00' ), // Yellow            
            hexToRgb( '#ff0000' ), // Red
        ],
        colorSpan = colors.length - 1;

    if ( colors.length > 0 ) {
        var lastPadding = size % colorSpan,
            stepSize = size / colorSpan,
            steps = null, 
            cursor = 0;

        for ( var index = 0; index < colorSpan; index++ ) {
            steps = Math.floor( ( index == colorSpan - 1 ) ? stepSize + lastPadding : stepSize );
            createGradient( colors[ index ], colors[ index + 1 ], steps, cursor );
            cursor += steps;
        }
    }

    function createGradient( start, end, steps, cursor ) {
        for ( var i = 0; i < steps; i++ ) {
            var r = Math.floor( start.r + ( i * ( end.r - start.r ) / steps ) ),
                g = Math.floor( start.g + ( i * ( end.g - start.g ) / steps ) ),
                b = Math.floor( start.b + ( i * ( end.b - start.b ) / steps ) );

            ctx.fillStyle = "rgba("+r+","+g+","+b+",1)";
            ctx.fillRect( points[cursor][0], points[cursor][1], 2, 2 );
            cursor++;
        }
    }

    points = [];
}

function setPixel( x, y ) {
    points.push( [ x, y ] );
}

function rasterCircle(x0, y0, radius) {
    var f = 1 - radius,
        ddF_x = 1,
        ddF_y = -2 * radius,
        x = 0,
        y = radius;

    setPixel(x0, y0 + radius);
    while(x < y) {
        if(f >= 0) {
            y--;
            ddF_y += 2;
            f += ddF_y;
        }
        x++;
        ddF_x += 2;
        f += ddF_x;    
        setPixel(x0 - x, y0 - y);
    }

    var temp = [];
    f = 1 - radius,
    ddF_x = 1,
    ddF_y = -2 * radius,
    x = 0,
    y = radius;
    while(x < y) {
        if(f >= 0) {
            y--;
            ddF_y += 2;
            f += ddF_y;
        }
        x++;
        ddF_x += 2;
        f += ddF_x;    
        temp.push( [x0 - y, y0 - x] );
    }
    temp.push( [x0 - radius, y0] );

    for(var i = temp.length - 1; i > 0; i--)
        setPixel( temp[i][0], temp[i][1] );

    fillPixels();
} 
```

我想要完成的是这样的：http: [//img252.imageshack.us/img252/3826/spectrum.jpg](http://img252.imageshack.us/img252/3826/spectrum.jpg)

“亮度”（白色到黑色渐变）不是问题，因为我知道它可以通过在绘制色谱后使用径向渐变来完成。但是，在弄清楚如何绘制频谱本身时，我将不胜感激。

我什至在想我可以画一个线性的然后弯曲（变换）它，但是没有任何本机函数可以做到这一点，并且处理诸如超出我技能水平的事情。：-/

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T19:02:00.270

看看这个：http: [//jsfiddle.net/f3SQ2/5/](http://jsfiddle.net/f3SQ2/5/)

```
var can = $('#canvas')[0],
    ctx = can.getContext('2d'),
    radius = 120,
    thickness = 80,
    p = {
        x: can.width,
        y: can.height
    },
    start = Math.PI,
    end = start + Math.PI / 2,
    step = Math.PI / 180,
    ang = 0,
    grad,
    r = 0,
    g = 0,
    b = 0,
    pct = 0;

ctx.translate(p.x, p.y);
for (ang = start; ang <= end; ang += step) {
    ctx.save();
    ctx.rotate(-ang);
    // linear gradient: black->current color->white
    grad = ctx.createLinearGradient(0, radius - thickness, 0, radius);
    grad.addColorStop(0, 'black');

    h = 360-(ang-start)/(end-start) * 360;
    s = '100%';
    l = '50%';

    grad.addColorStop(.5, 'hsl('+[h,s,l].join()+')');
    grad.addColorStop(1, 'white');
    ctx.fillStyle = grad;

    // the width of three for the rect prevents gaps in the arc
    ctx.fillRect(0, radius - thickness, 3, thickness);
    ctx.restore();
} 
```

**编辑：**固定色谱。显然我们可以只给它 HSL 值，不需要转换或凌乱的计算！

修改了一些东西以更好地处理缩放：http: [//jsfiddle.net/f3SQ2/6/](http://jsfiddle.net/f3SQ2/6/)

```
step = Math.PI / 360

ctx.fillRect(0, radius - thickness, radius/10, thickness); 
```

例如，您可以像这样设置渐变色标：

```
h = 360-(ang-start)/(end-start) * 360;
s = '100%';

grad.addColorStop(0, 'hsl('+[h,s,'0%'].join()+')');  //black 
grad.addColorStop(.5,'hsl('+[h,s,'50%'].join()+')'); //color
grad.addColorStop(1, 'hsl('+[h,s,'100%'].join()+')');//white 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T19:47:57.137

我的第一个注意事项是，您链接到的图像具有不需要更改的所有 3 个组件，并且可能只是静态图像。

我从我正在处理的项目中改编了一些代码：http: [//jsfiddle.net/f3SQ2/1/](http://jsfiddle.net/f3SQ2/1/)

```
function drawColourArc(image) {
    var data = image.data;
    var i = 0;
    var w = image.width, h = image.height;
    var result = [0, 0, 0, 1];
    var outer = 1, inner = 0.5;
    var mid = 0.75;

    for (var y = 0; y < h; y++) {
        for (var x = 0; x < w; x++) {

            var dx = (x / w) - 1, dy = (y / w) - 1;

            var angular = ((Math.atan2(dy, dx) + Math.PI) / (2 * Math.PI)) * 4;
            var radius = Math.sqrt((dx * dx) + (dy * dy));

            if (radius < inner || radius > outer) {
                data[i++] = 255;
                data[i++] = 255;
                data[i++] = 255;
                data[i++] = 0;
            }
            else {
                if (radius < mid) {
                    var saturation = 1;
                    var brightness = (radius - 0.5) * 4;
                }
                else {
                    var saturation = 1- ((radius - 0.75) * 4);
                    var brightness = 1;
                }

                result[0] = angular;
                result[1] = saturation;
                result[2] = brightness;

                result[3] = 1;

                //Inline HSBToRGB
                if (result[1] == 0) {
                    result[0] = result[1] = result[2] = result[2];
                }
                else {
                    var varH = result[0] * 6;
                    var varI = Math.floor(varH); //Or ... var_i = floor( var_h )
                    var var1 = result[2] * (1 - result[1]);
                    var var2 = result[2] * (1 - result[1] * (varH - varI));
                    var var3 = result[2] * (1 - result[1] * (1 - (varH - varI)));

                    if (varI == 0 || varI == 6) {
                        result[0] = result[2];
                        result[1] = var3;
                        result[2] = var1;
                    }
                    else if (varI == 1) {
                        result[0] = var2;
                        result[1] = result[2];
                        result[2] = var1;
                    }
                    else if (varI == 2) {
                        result[0] = var1;
                        result[1] = result[2];
                        result[2] = var3;
                    }
                    else if (varI == 3) {
                        result[0] = var1;
                        result[1] = var2;
                        result[2] = result[2];
                    }
                    else if (varI == 4) {
                        result[0] = var3;
                        result[1] = var1;
                        result[2] = result[2];
                    }
                    else {
                        result[0] = result[2];
                        result[1] = var1;
                        result[2] = var2;
                    }

                }
                //End of inline
                data[i++] = result[0] * 255;
                data[i++] = result[1] * 255;
                data[i++] = result[2] * 255;
                data[i++] = result[3] * 255;
            }
        }
    }
}; 
```

* * *

```
var canvas = document.getElementsByTagName("canvas")[0];
var ctx = canvas.getContext("2d");
var image = ctx.createImageData(canvas.width, canvas.height);

drawColourArc(image);
ctx.putImageData(image, 0, 0); 
```

这是按像素执行的，这是准确的，但您可能需要绘制轮廓以对抗锯齿。它可以适应使用自定义颜色而不是插值色调。

# php - PHP APC 不工作

> ID：14777323
> 
> 赞同：4
> 
> 时间：2013-02-08T16:43:44.663
> 
> 标签：php, caching, apc

我刚刚用 PHP Handler FastCGI 安装了 APC。但似乎缓存永远不会工作。

```
if(($t=apc_fetch('key_4321'))===FALSE){
    $t=time();
    apc_add('key_4321', $t, 24*60*60);
}

echo $t; 
```

**几乎每次我运行它时，我都会得到一个不同的时间戳。只有几次它仍然是相同的结果。可能的原因是什么？**

我正在使用 PHP 版本 5.3.21，服务器 API 是 CGI/FastCGI。

```
Server Software Apache/2.2.23 (Unix) mod_ssl/2.2.23 OpenSSL/0.9.8e-fips-rhel5 mod_auth_passthrough/2.1 mod_bwlimited/1.4 FrontPage/5.0.2.2635 mod_fcgid/2.3.6 
```

下面是我的 APC 设置。

![在此处输入图像描述](../Images/eb05d3df4529bd5345e51cbd2e709100.png)

```
Configuration

apc

APC Support enabled
Version 3.1.13
APC Debugging   Disabled
MMAP Support    Enabled
MMAP File Mask  no value
Locking type    File Locks
Serialization Support   php
Revision    $Revision: 327136 $
Build Date  Feb 7 2013 21:44:30

Directive   Local Value Master Value
apc.cache_by_default    On  On
apc.canonicalize    On  On
apc.coredump_unmap  Off Off
apc.enable_cli  On  On
apc.enabled On  On
apc.file_md5    Off Off
apc.file_update_protection  2   2
apc.filters no value    no value
apc.gc_ttl  36000   36000
apc.include_once_override   On  On
apc.lazy_classes    Off Off
apc.lazy_functions  Off Off
apc.max_file_size   1M  1M
apc.mmap_file_mask  no value    no value
apc.num_files_hint  1000    1000
apc.preload_path    no value    no value
apc.report_autofilter   Off Off
apc.rfc1867 Off Off
apc.rfc1867_freq    0   0
apc.rfc1867_name    APC_UPLOAD_PROGRESS APC_UPLOAD_PROGRESS
apc.rfc1867_prefix  upload_ upload_
apc.rfc1867_ttl 3600    3600
apc.serializer  default default
apc.shm_segments    1   1
apc.shm_size    256M    256M
apc.slam_defense    On  On
apc.stat    On  On
apc.stat_ctime  Off Off
apc.ttl 36000   36000
apc.use_request_time    On  On
apc.user_entries_hint   4096    4096
apc.user_ttl    72000   72000
apc.write_lock  On  On

cgi-fcgi

Directive   Local Value Master Value
cgi.check_shebang_line  1   1
cgi.discard_path    0   0
cgi.fix_pathinfo    1   1
cgi.force_redirect  1   1
cgi.nph 0   0
cgi.redirect_status_env no value    no value
cgi.rfc2616_headers 0   0
fastcgi.logging 1   1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T01:28:35.967

在大型网站上使用过 APC ~ 我强烈建议人们不要使用 APC。

相反，我想推荐你使用[XCache](http://xcache.lighttpd.net/) ，它与 APC 相同，但不会一直崩溃和段错误。

# php - 如何从 Zend 只返回 JSON

> ID：14777324
> 
> 赞同：23
> 
> 时间：2013-02-08T16:43:47.943
> 
> 标签：php, json, web-services, zend-framework, rest

我正在为我的项目使用 Zend Framework 1.x。我想为调用者函数创建一个只返回 JSON 字符串的 Web 服务。我尝试使用`Zend_Controller_Action`和应用这些方式：

1.

```
$this->getResponse()
     ->setHeader('Content-type', 'text/plain')
     ->setBody(json_encode($arrResult)); 
```

2.

```
$this->_helper->getHelper('contextSwitch')
              ->addActionContext('nctpaymenthandler', 'json')
              ->initContext(); 
```

3.

```
header('Content-type: application/json'); 
```

4.

```
$this->_response->setHeader('Content-type', 'application/json'); 
```

5.

```
echo Zend_Json::encode($arrResult);
exit; 
```

6.

```
return json_encode($arrResult); 
```

7.

```
$this->view->_response = $arrResult; 
```

但是当我使用 cURL 来获取结果时，它返回的 JSON 字符串被一些 HTML 标记包围。然后我尝试`Zend_Rest_Controller`使用上面的选项。它仍然没有成功。

PS：上面的大部分方法都来自 Stack Overflow 上提出的问题。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-02-08T16:58:51.007

我喜欢这种方式！

```
//encode your data into JSON and send the response
$this->_helper->json($myArrayofData);
//nothing else will get executed after the line above 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-08T21:42:42.863

您需要禁用布局和视图渲染。

显式禁用布局和视图渲染器：

```
public function getJsonResponseAction()
{
    $this->getHelper('Layout')
         ->disableLayout();

    $this->getHelper('ViewRenderer')
         ->setNoRender();

    $this->getResponse()
         ->setHeader('Content-Type', 'application/json');

    // should the content type should be UTF-8?
    // $this->getResponse()
    //      ->setHeader('Content-Type', 'application/json; charset=UTF-8');

    // ECHO JSON HERE

    return;
} 
```

如果您使用 json 控制器操作助手，则需要向操作添加 json 上下文。在这种情况下，json 助手将为您禁用布局和视图渲染器。

```
public function init()
{
    $this->_helper->contextSwitch()
         ->addActionContext('getJsonResponse', array('json'))
         ->initContext();
}

public function getJsonResponseAction() 
{
    $jsonData = ''; // your json response

    return $this->_helper->json->sendJson($jsonData);
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-02-08T16:53:30.883

您的代码还需要禁用布局，以停止使用标准页面模板包装内容。但更简单的方法是：

```
$this->getHelper('json')->sendJson($arrResult); 
```

JSON 助手会将您的变量编码为 JSON，设置适当的标头并为您禁用布局和视图脚本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-22T07:22:29.297

这要容易得多。

```
public function init()
{
    parent::init();
    $this->_helper->contextSwitch()
        ->addActionContext('foo', 'json')
        ->initContext('json');
}

public function fooAction()
{
    $this->view->foo = 'bar';
} 
```

# jquery - Highcharts - colorByPoint 不起作用

> ID：14777325
> 
> 赞同：1
> 
> 时间：2013-02-08T16:43:48.433
> 
> 标签：jquery, charts, highcharts

我正在尝试获取具有不同条形颜色的条形图，我正在使用属性 colorByPoint，所以（这里是我的完整示例：http: [//jsfiddle.net/n6GRZ/7/](http://jsfiddle.net/n6GRZ/7/)）：

```
plotOptions: {
    series: {
        colorByPoint: true
    }
}, 
```

但这在 Highcharts 示例中不起作用：

[http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/plotoptions/column-colorbypoint-true/](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/plotoptions/column-colorbypoint-true/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T18:57:07.547

您设置 plotOptions 两次，删除额外的一个。这一行：

```
//plotOptions:{bar:{dataLabels:{enabled: true}}}, 
```

[修改后的 DEMO](http://jsfiddle.net/n6GRZ/8/)

# c# - 带有缩进嵌套标签的 C# XML 反序列化

> ID：14777329
> 
> 赞同：3
> 
> 时间：2013-02-08T16:44:03.050
> 
> 标签：c#, xml, deserialization

我知道 Stackoverflow 上已经有几个关于这个主题的问题，但我仍然找不到关于重复标签的任何答案。如果我有这样的 XML 结构：

```
<root>
    <block>
        <PositionX>100</PositionX>
        <PositionY>100</PositionY>
        <block>
            <PositionX>10</PositionX>
            <PositionY>15</PositionY>
            <button>
            </button>
        </block>
        <button>
        </button>
    </block>
</root> 
```

上述结构可以有块内的按钮和块内的块。这是我目前使用的代码，它不允许嵌套项：

反序列化：

```
 public static GUI Deserialize(string filename)
    {
        GUI gui = null;
        XmlSerializer serializer = new XmlSerializer(typeof(GUI));
        StreamReader reader = new StreamReader(filename);
        gui = (GUI)serializer.Deserialize(reader);
        reader.Close();
        return gui;
    } 
```

根类：

```
[Serializable()]
[XmlRoot("View")]
public class GUI
{
    [XmlArray("Blocks")]
    [XmlArrayItem("Block", typeof(GUIBlock))]
    public GUIBlock[] Blocks { get; set; }
} 
```

块：

```
[Serializable()]
public class GUIBlock
{
    [XmlElement("Name")]
    public string Name { get; set; }

    [XmlElement("Position")]
    [XmlAttribute("X")]
    public int PositionX { get; set; }

    [XmlElement("Position")]
    [XmlAttribute("Y")]
    public int PositionY { get; set; }

    [XmlElement("Width")]
    public int Width { get; set; }

    [XmlElement("Height")]
    public int Height { get; set; }

    [XmlElement("Background")]
    public string Background { get; set; }

    [XmlElement("Opacity")]
    public int Opacity { get; set; }

    // I also want to allow nested Blocks and Buttons in here, but I **dont** explicitly want to say:
    [XmlArray("Blocks")]
    [XmlArrayItem("Block", typeof(GUIBlock))]
    public GUIBlock[] Blocks { get; set; }
} 
```

有什么方法可以让我得到一个答案，该答案将递归循环该项目而不定义所有可能的组合？

我不想给块一个块列表和一个按钮列表，一个按钮一个块列表和一个块列表。并为每个新标签添加更多选项。

我也可以在没有反序列化的情况下使用 XPath，但是如果我自己不探索它，我不知道有关父/子的信息。对这个有帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:02:09.803

I believe you are asking how can I deserialize an array of objects without having to create a ListNode that contains those items?

For example, you have a requirement that says your XML must look like this:

```
<Library>
    <Location></Location>
    <Book></Book>
    <Book></Book>
    <Book></Book>
</Library> 
```

And it CANNOT look like this:

```
<Library>
    <Location></Location>
    <BookCollection>
       <Book></Book>
       <Book></Book>
       <Book></Book>
    <BookCollection>
</Library> 
```

The way you would do this in a C# object is like this:

```
[Serializable]
public class Library
{
    [XmlElement]
    public string Location {get;set;}

    [XmlElement("Book")]
    public Book[] Book {get; set;}

}

public class Book 
{
    /// ....
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T16:51:20.073

You'll need to create a recursive function to go through each node, but what you can do is just:

```
// This groups all sub-elements of a node by their name.
// If there is more than one node with the same name, .Count() will return > 1
Int32 numberOfSameNameNodes = 
    node.Elements()
        .GroupBy(element => element.Name)
        .Count(elementsGroupedByName => elementsGroupedByName.Count() > 1);

// if there are duplicately named sub-nodes then 
if (numberOfSameNameNodes > 0)
{
   ...
} 
```

And this will determine if a node has sub-nodes that are duplicates.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T15:47:29.757

没有找到我正在寻找的答案，因为我相信您无法通过反序列化来做到这一点。所以现在我的 Block 类也有一个 Block 列表，所以我可以递归地循环它们。

# orchardcms - 带有缓存插件的 ImageResizer.net 导致重复的输出缓存

> ID：14777337
> 
> 赞同：0
> 
> 时间：2013-02-08T16:44:21.060
> 
> 标签：orchardcms, httpmodule, imageresizer

我有一个奇怪的问题，当我在 Orchard CMS 中启用输出缓存并启用 ImageResizer.net 缓存插件时，我得到了重复的页面内容（完整的 DOM）。仅供参考，我正在部署到 Azure 小型预留实例。

任何想法如何解决这个问题 - 我是否需要为输出缓存创建缓存配置文件而不是缓存图像，因为这是由缓存插件处理的？

提前致谢，

彼得

诊断信息：

```
Image resizer diagnostic sheet      2/13/2013 9:07:32 PM

1 Issues detected:

(Warning):  To potentially see additional errors here, perform an image resize request.

You are using paid bundles: Performance Bundle

Registered plugins:

ImageResizer.Plugins.Basic.DefaultEncoder
ImageResizer.Plugins.Basic.NoCache
ImageResizer.Plugins.Basic.ClientCache
ImageResizer.Plugins.Basic.Diagnostic
ImageResizer.Plugins.Basic.SizeLimiting
ImageResizer.Plugins.MvcRoutingShim.MvcRoutingShimPlugin
ImageResizer.Plugins.DiskCache.DiskCache

Configuration:

<resizer>
<diagnostics enableFor="allhosts" />
<pipeline fakeExtensions=".ashx" />
<plugins>
<add name="MvcRoutingShim" />
<add name="DiskCache" />
</plugins>
</resizer>

Accepted querystring keys:

quality, format, thumbnail, maxwidth, maxheight, width, height, w, h, scale, stretch, crop, cropxunits, cropyunits, page, bgcolor, rotate, flip, sourceFlip, sFlip, sRotate, borderWidth, borderColor, paddingWidth, paddingColor, ignoreicc, frame, useresizingpipeline, cache, process, margin, anchor, dpi, mode, zoom, 

Accepted file extensions:

bmp, gif, exif, png, tif, tiff, tff, jpg, jpeg, jpe, jif, jfif, jfi, 

Environment information:

Running Microsoft-IIS/7.5 on Microsoft Windows NT 6.1.7601 Service Pack 1 and CLR 4.0.30319.17929
Trust level: Unrestricted
OS bitness: x86 !! Warning, running as 32-bit on a 64-bit OS(AMD64). This will limit ram usage !!
Executing assembly: D:\Windows\SysWOW64\inetsrv\w3wp.exe
IntegratedPipeline: True

Loaded assemblies:

mscorlib                                 Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Web                               Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System                                   Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Core                              Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Configuration                     Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Xml                               Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Runtime.Caching                   Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
Microsoft.Build.Utilities.v4.0           Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Web.RegularExpressions            Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
Microsoft.JScript                        Assembly: 10.0.0.0        File: 11.0.50709.17929 Info: 11.0.50709.17929
System.Web.WebPages.Deployment           Assembly: 2.0.0.0         File: 2.0.20710.0    
System.Web.Http.WebHost                  Assembly: 4.0.0.0         File: 4.0.20710.0    
EnvSettings                              Assembly: 1.0.0.0         File: 7.1.1976.0     
System.Web.WebPages                      Assembly: 2.0.0.0         File: 2.0.20710.0    
System.Web.WebPages.Razor                Assembly: 2.0.0.0         File: 2.0.20710.0    
System.Web.Mvc                           Assembly: 4.0.0.0         File: 4.0.20710.0    
Microsoft.Web.Infrastructure             Assembly: 1.0.0.0         File: 1.0.20105.407  
App_global.asax                          Assembly: 0.0.0.0        
Orchard.Web                              Assembly: 1.6.0.0         File: 1.6            
Orchard.Framework                        Assembly: 1.6.0.0         File: 1.6            
Autofac                                  Assembly: 2.6.3.862       File: 2.6.3.862      
System.ServiceModel.Activation           Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.ServiceModel.Internals            Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.ServiceModel                      Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
SMDiagnostics                            Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Xaml.Hosting                      Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Web.Extensions                    Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
Orchard.WarmupStarter                    Assembly: 1.6.0.0         File: 1.6            
Microsoft.CSharp                         Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Xml.Linq                          Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.ComponentModel.DataAnnotations    Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Web.DynamicData                   Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
Autofac.Configuration                    Assembly: 2.6.3.862       File: 2.6.3.862      
Castle.Core                              Assembly: 1.1.0.0         File: 1.1.0.0         Info: 1.1.0.0
Castle.DynamicProxy2                     Assembly: 2.1.0.0         File: 2.1.0.0         Info: 2.1.0.0
ClaySharp                                Assembly: 1.0.0.0         File: 1.0.0.0        
FluentNHibernate                         Assembly: 1.3.0.733      
Iesi.Collections                         Assembly: 1.0.1.0         File: 3.3.1.4000      Info: 1.0
ImageResizer                             Assembly: 3.2.4.698       File: 3.2.4.698       Info: 3-2-4  Commit: 4b94e40
ImageResizer.Mvc                         Assembly: 3.2.4.698       File: 3.2.4.698       Info: 3-2-4  Commit: 4b94e40
ImageResizer.Plugins.DiskCache           Assembly: 3.2.4.698       File: 3.2.4.698       Info: 3-2-4  Commit: 4b94e40
log4net                                  Assembly: 1.2.11.0        File: 1.2.11.0        Info: 1.2
MySql.Data                               Assembly: 6.5.4.0        
Newtonsoft.Json                          Assembly: 4.5.0.0         File: 4.5.8.15203    
NHibernate                               Assembly: 3.3.1.4000      File: 3.3.1.4000      Info: 3.3.1.4000
NHibernate.Linq                          Assembly: 0.0.0.0        
NuGet.Core                               Assembly: 1.1.0.0        
Orchard.Core                             Assembly: 1.6.0.0         File: 1.6            
System.Data.SqlServerCe                  Assembly: 4.0.0.0         File: 4.0.8482.1      Info: 4.0
System.Net.Http                          Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Net.Http.Formatting               Assembly: 4.0.0.0         File: 4.0.20710.0    
System.Web.Helpers                       Assembly: 2.0.0.0         File: 2.0.20710.0    
System.Web.Http                          Assembly: 4.0.0.0         File: 4.0.20710.0    
System.Web.Razor                         Assembly: 2.0.0.0         File: 2.0.20710.0    
System.Web.Abstractions                  Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Web.Routing                       Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Data.Linq                         Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Drawing                           Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.ComponentModel.Composition        Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
Anonymously Hosted DynamicMethods Assembly Assembly: 0.0.0.0        
System.Runtime.Serialization             Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
DynamicProxyGenAssembly2                 Assembly: 0.0.0.0        
Contrib.ProjectionLayouts                Assembly: 0.0.0.0        
Orchard.Forms                            Assembly: 1.6.0.0         File: 1.6            
Orchard.Projections                      Assembly: 1.6.0.0         File: 1.6            
Orchard.Alias                            Assembly: 1.6.0.0         File: 1.6            
Orchard.Tokens                           Assembly: 1.6.0.0         File: 1.6            
Orchard.Autoroute                        Assembly: 1.6.0.0         File: 1.6            
Orchard.jQuery                           Assembly: 1.6.0.0         File: 1.6            
Orchard.PublishLater                     Assembly: 1.6.0.0         File: 1.6            
Orchard.Scripting                        Assembly: 1.6.0.0         File: 1.6            
Orchard.Themes                           Assembly: 1.6.0.0         File: 1.6            
Orchard.Widgets                          Assembly: 1.6.0.0         File: 1.6            
Orchard.ContentPicker                    Assembly: 0.0.0.0        
Orchard.Blogs                            Assembly: 1.6.0.0         File: 1.6            
Orchard.Comments                         Assembly: 1.6.0.0         File: 1.6            
Orchard.Disqus                           Assembly: 0.0.0.0        
Orchard.Rules                            Assembly: 1.6.0.0         File: 1.6            
Orchard.Media                            Assembly: 1.6.0.0         File: 1.6            
Orchard.MediaPicker                      Assembly: 1.6.0.0         File: 1.6            
Szmyd.Orchard.Modules.Sharing            Assembly: 0.0.0.0               
Lucene                                   Assembly: 1.6.0.0         File: 1.6            
Orchard.Users                            Assembly: 1.6.0.0         File: 1.6            
System.Web.ApplicationServices           Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
Orchard.Roles                            Assembly: 1.6.0.0         File: 1.6            
Orchard.ContentTypes                     Assembly: 1.6.0.0         File: 1.6            
Orchard.DesignerTools                    Assembly: 1.6.0.0         File: 1.6            
Orchard.Fields                           Assembly: 0.0.0.0        
Orchard.Indexing                         Assembly: 1.4.1.0         File: 1.4.1          
Orchard.Modules                          Assembly: 1.6.0.0         File: 1.6            
Orchard.Packaging                        Assembly: 1.6.0.0         File: 1.6            
System.Data.Services.Client              Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
Orchard.Pages                            Assembly: 1.6.0.0         File: 1.6            
Orchard.Recipes                          Assembly: 1.6.0.0         File: 1.6            
Orchard.Search                           Assembly: 1.6.0.0         File: 1.6            
Orchard.Tags                             Assembly: 1.6.0.0         File: 1.6            
Orchard.Warmup                           Assembly: 1.6.0.0         File: 1.6            
SysCache                                 Assembly: 0.0.0.0        
TinyMce                                  Assembly: 1.6.0.0         File: 1.6            
Vandelay.Industries                      Assembly: 0.0.0.0        
MovieRentalOffers                        Assembly: 1.0.0.0         File: 1.0.0.0        
System.Data                              Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Transactions                      Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.EnterpriseServices                Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Numerics                          Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
Microsoft.GeneratedCode                  Assembly: 1.0.0.0        
NHibernate.Caches.SysCache2              Assembly: 3.1.0.4000      File: 3.1.0.4000      Info: 3.1.0.4000
ActionRecordProxyAssembly                Assembly: 0.0.0.0        
ContentPartDefinitionRecordProxyAssembly Assembly: 0.0.0.0        
Lucene.Net                               Assembly: 2.9.4.1         Info: 2.9.4
System.Web.Mobile                        Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
System.Xaml                              Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
PermissionRecordProxyAssembly            Assembly: 0.0.0.0        
System.Dynamic                           Assembly: 4.0.0.0         File: 4.0.30319.17929 Info: 4.0.30319.17929
ContentFieldDefinitionRecordProxyAssembly Assembly: 0.0.0.0        
DynamicProxyGenAssembly2                 Assembly: 0.0.0.0        
DynamicProxyGenAssembly2                 Assembly: 0.0.0.0        
ContentItemRecordProxyAssembly           Assembly: 0.0.0.0        
App_Web_bjaujelw                         Assembly: 0.0.0.0        
App_Web_3ucixrnn                         Assembly: 0.0.0.0        
DynamicProxyGenAssembly2                 Assembly: 0.0.0.0        
App_Web_hqpkyqpq                         Assembly: 0.0.0.0        
App_Web_4rtpbaer                         Assembly: 0.0.0.0        
App_Web_hn4szlb4                         Assembly: 0.0.0.0        
ContentTypeRecordProxyAssembly           Assembly: 0.0.0.0        
App_Web_fmcezex3                         Assembly: 0.0.0.0        
App_Web_0wv5slaj                         Assembly: 0.0.0.0        
App_Web_z1olvxy5                         Assembly: 0.0.0.0        
ProviderPartRecordProxyAssembly          Assembly: 0.0.0.0        
App_Web_j0ak4epp                         Assembly: 0.0.0.0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-05T15:21:31.790

Orchard 1.7 and new OutputCache module solves this problem. You can view it here: [https://orchardcache.codeplex.com/workitem/26](https://orchardcache.codeplex.com/workitem/26)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T13:35:15.503

### 这可以在没有 ImageResizer 的情况下复制，使用以下 HttpModule：

```
public class BlankModule : IHttpModule {

    void IHttpModule.Init(System.Web.HttpApplication context) {
        //Having any event handlers registered for this event causes cache duplication during the Filter execution
        context.PreSendRequestHeaders -= context_PreSendRequestHeaders;
        context.PreSendRequestHeaders += context_PreSendRequestHeaders;
    }
    void IHttpModule.Dispose() { }
    protected void context_PreSendRequestHeaders(object sender, EventArgs e) {}
} 
```

确保在 Web.Config 中注册它：

```
 <system.webServer>
     <modules>
       <add name="BlankModule" type="BlankModule"/>
     </modules>
   </system.webServer> 
```

### 注册该模块的另一个副本，您将获得三倍的响应，而不仅仅是两倍。

这不一定是 Orchard.Cache.Contrib 中的错误；ASP.NET 结合缓冲响应过滤器处理 PreSendRequestHeaders 的方式更可能是一个错误。

不幸的是，ImageResizer 方面没有简单的解决方法，因为 ImageResizer 需要能够为 IIS 提供的文件设置正确的 mime 类型，这意味着 PreSendRequestHeaders。

## 错误报告：

*   ASP.NET：https://aspnet.codeplex.com/workitem/10347 [_](https://aspnet.codeplex.com/workitem/10347)
*   果园 Contrib.Cache：[https ://orchardcache.codeplex.com/workitem/26](https://orchardcache.codeplex.com/workitem/26)

# sql - 有条件的查询优化

> ID：14777347
> 
> 赞同：0
> 
> 时间：2013-02-08T16:44:52.360
> 
> 标签：sql, oracle, query-optimization

我想优化以下查询，不使用子查询来获取最大值：

```
select c.ida2a2 from table1 m, table2 c 
where c.ida3a5 = m.ida2a2 
and (c.createstampa2 < (select max(cc.createstampa2) 
                        from table2 cc where cc.ida3a5 = c.ida3a5)); 
```

任何的想法？如果您想获得更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T16:47:58.727

这可能是编写查询的更有效方式：

```
select c.ida2a2
from table1 m join
     (select c.*, MAX(createstampa2) over (partition by ida3a5) as maxcs
      from table2 c 
     ) c
     on c.ida3a5 = m.ida2a2
where c.createstampa2 < maxcs 
```

我很确定 Oracle 会正确优化这一点（在连接之前过滤行）。如果你想更清楚：

```
select c.ida2a2
from table1 m join
     (select c.*
      from (select c.*, MAX(createstampa2) over (partition by ida3a5) as maxcs
            from table2 c 
           ) c
      where c.createstamp2 < c.maxcs
     ) c
     on c.ida3a5 = m.ida2a2 
```

# jquery - jquery不要在同一时间两次运行相同的功能

> ID：14777349
> 
> 赞同：0
> 
> 时间：2013-02-08T16:45:04.737
> 
> 标签：jquery, ajax

我有一个代码。

```
setInterval(somefunc, 1000);

function somefunc() {
    curid = $(".chat-message:last").attr("id");
    $.post("http://blah.com/blah.php&last_msg_id=" + curid, function (data) {

        $('.chat-messages').append(data);
    });
}

function saveChat() {
    var texts = $('#chatText').val();

    var request = $.ajax({
        type: "POST",
        url: "http://blah.com/submit.php",
        data: {
            text: texts
        },
        dataType: "html"
    });

    request.done(function (msg) {
        somefunc();
    });
} 
```

问题是有时 saveChat 与 interval 同时执行，并且 somefunc 附加到 .chat-messages 的信息重复。我怎么能避免呢？我需要一个函数，它只允许在之前的 somefunc() 执行完全完成时再次执行函数 somefunc() 。或者只是不允许同时执行函数 somefunc() 两次。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T16:49:04.467

Don't use `setInterval`, but nest `setTimeout`:

```
setTimeout(somefunc, 1000);
function somefunc() {
    //snip
    $.post().done(function () { setTimeout(somefunc, 1000); });
} 
```

# c++ - c++：如何获得类似 c# 的属性

> ID：14777355
> 
> 赞同：3
> 
> 时间：2013-02-08T16:45:20.280
> 
> 标签：c++, properties

是否可以在 c++ 中具有类似 c# 的属性？起初我认为没有，但我没有找到任何声称它有这个的来源。

但我找到了一个头文件（起初似乎是用 c# 编写的，但实际上是 c++），在该文件中，它似乎用 property 关键字声明了属性：

```
property Boolean AlphaToCoverageEnable
{
    Boolean get()
    {
        return alphaToCoverageEnable;
    }

    void set(Boolean value)
    {
        alphaToCoverageEnable = value;
    }
} 
```

我试图在 Eclipse 中使用它，但它不喜欢它......有没有办法做到这一点？我需要包含的标头或与它的编译方式有关的东西？

我找到的文件： [https ://dl.dropbox.com/u/847423/D3D10Structs.h](https://dl.dropbox.com/u/847423/D3D10Structs.h)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T16:47:13.787

您正在查看 C++/CLI，它是 Microsoft 对 C++ 的扩展，增加了对 .Net 的支持。

C++ 不支持属性，但您可以通过滥用运算符重载来制作类似于属性的东西。

例如，请参阅[http://msdn.microsoft.com/en-us/magazine/cc534994.aspx](http://msdn.microsoft.com/en-us/magazine/cc534994.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T16:46:56.390

简而言之，C++（语言）不支持 C# 风格的属性。属性通过两个函数实现：setter 和 getter。甚至 C# 属性也在 CLI 级别转换为 setter/getter 函数。

似乎 Microsoft C++/CLI 对 C++ 语言的扩展支持 C# 样式的属性，但 ANSI 标准 C++ 语言不支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T16:47:01.333

这是 C++/CLI，而不是标准 C++。C++/CLI 支持属性，因为它旨在与 .NET 概念无缝协作。

您可以直接在`public value struct BlendDescription`类声明中说明 -`value struct`定义 C++/CLI 值类型（`struct`在 C# 中）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T16:50:57.363

I've used the code from this CodeGuru project: [http://www.codeproject.com/Articles/118921/C-Properties](http://www.codeproject.com/Articles/118921/C-Properties)

Using that I created a "properties.h" file containing this:

```
#define PROPERTY(t,n)  __declspec( property 
( put = property__set_##n, get = property__get_##n ) ) t n;\
typedef t property__tmp_type_##n
#define READONLY_PROPERTY(t,n) __declspec( property (get = property__get_##n) ) t n;\
typedef t property__tmp_type_##n
#define WRITEONLY_PROPERTY(t,n) __declspec( property (put = property__set_##n) ) t n;\
typedef t property__tmp_type_##n
#define GET(n) property__tmp_type_##n property__get_##n() 
#define SET(n) void property__set_##n(const property__tmp_type_##n& value) 
```

with an example property being:

```
PROPERTY(LatLonAltTuple, LatLonAlt);
GET(LatLonAlt) { return m_LatLonAlt; }
SET(LatLonAlt) { m_LatLonAlt = value; } 
```

# slickgrid - 请求有关 ASP.Net 3.5 Web 表单应用程序的 slickgrid 实施的指导

> ID：14777359
> 
> 赞同：2
> 
> 时间：2013-02-08T16:45:28.623
> 
> 标签：slickgrid

我正在寻找一些关于如何在 ASP.net Web 应用程序中实现 slickgrid 的指导。该应用程序查询一个 sql server 2005 数据库，目前使用 gridviews 来显示数据。我的目标是消除 gridviews 的使用，并用 slickgrid 替换它们。我的代码在下面，我不确定如何或从哪里开始。

在我的 Dashboard.aspx.cs 文件（如下）中，您将看到我将数据绑定到了网格视图。如何替换数据绑定以利用 slickgrid？

提前感谢您的帮助。

Dashboard.aspx 页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>

    <table style="width: 100%; table-layout: auto; border-top-style: none; border-right-style: none; border-left-style: none; border-collapse: collapse; border-bottom-style: none;">
        <tr>
            <td rowspan="8" align="center" valign="top">
                <asp:Button ID="btnRefresh" runat="server" OnClick="btnRefresh_Click" Text="Refresh"
                    Width="100px" />
                    <br />
                <asp:Button ID="Button2" runat="server" PostBackUrl="~/InterfaceListing.aspx" Text="Interface List"
                    Width="100px" />
            </td>
            <td style="color: #990000; font-family: Tahoma; height: 1px; text-align: left; width: 124px;">
                &nbsp;</td>
            <td style="width: 19px; height: 1px">
                &nbsp;</td>
            <td style="height: 1px; width: 216px;">
                &nbsp;</td>
            <td style="width: 20%; height: 19px">
                &nbsp;</td>
        </tr>
        <tr>
            <td style="color: #990000; font-family: Tahoma; height: 1px; text-align: left; width: 124px;">
                <span style="font-size: 11pt; vertical-align: top;">
                    <asp:Label ID="Label2" runat="server" Text="Last 10 Jobs Executed" Width="307px"></asp:Label></span></td>
            <td style="width: 19px; height: 1px">
            </td>
            <td style="height: 1px; width: 216px;">
                <span style="font-size: 11pt; color: #990000; font-family: Tahoma">
                    <asp:Label ID="Label3" runat="server" Text="Interface Summary" Width="185px"></asp:Label></span></td>
            <td style="width: 20%; height: 19px">
            </td>
        </tr>
        <tr>
            <td style="width: 124px; text-align: left; vertical-align: top;">
                <asp:GridView ID="gvLast10" runat="server" AutoGenerateColumns="False" CellPadding="4"
                    Font-Names="Tahoma" Font-Size="8pt" ForeColor="#333333"
                    GridLines="None" Width="800px" >
                    <RowStyle BackColor="#FFFBD6" BorderStyle="Solid" BorderWidth="1px" ForeColor="#333333" />
                    <Columns>
                        <asp:BoundField DataField="InterfaceName" HeaderText="Name" SortExpression="InterfaceName">
                            <HeaderStyle HorizontalAlign="Left" />
                            <ItemStyle HorizontalAlign="Left" />
                        </asp:BoundField>
                        <asp:BoundField DataField="TotalTransactionCount" HeaderText="Transaction Count" SortExpression="TotalTransactionCount">
                            <HeaderStyle HorizontalAlign="Center" />
                            <ItemStyle HorizontalAlign="Center" />
                        </asp:BoundField>
                        <asp:BoundField DataField="ErrorsOccured" HeaderText="Status" SortExpression="ErrorsOccured">
                            <HeaderStyle HorizontalAlign="Center" />
                            <ItemStyle HorizontalAlign="Center" />
                        </asp:BoundField>
                        <asp:BoundField DataField="RunTime" HeaderText="Duration" ReadOnly="True" SortExpression="RunTime">
                            <HeaderStyle HorizontalAlign="Center" />
                            <ItemStyle HorizontalAlign="Center" />
                        </asp:BoundField>
                        <asp:BoundField DataField="Started" HeaderText="Started" SortExpression="DateBegan">
                            <HeaderStyle HorizontalAlign="Left" />
                            <ItemStyle HorizontalAlign="Left" />
                        </asp:BoundField>
                    </Columns>
                    <FooterStyle BackColor="#990000" Font-Bold="True" ForeColor="White" />
                    <PagerStyle BackColor="#FFCC66" ForeColor="#333333" HorizontalAlign="Center" />
                    <SelectedRowStyle BackColor="#FFCC66" Font-Bold="True" ForeColor="Navy" />
                    <HeaderStyle BackColor="#990000" BorderColor="#990000" BorderStyle="Solid" BorderWidth="1px"
                        Font-Bold="True" ForeColor="White" />
                    <AlternatingRowStyle BackColor="White" />
                </asp:GridView>
            </td>
            <td style="vertical-align: top; width: 19px; text-align: left">
            </td>
            <td style="width: 216px; vertical-align: top; text-align: left;">
                <asp:GridView ID="gvPackageCount" runat="server" AutoGenerateColumns="False" CellPadding="4"
                    ForeColor="#333333" GridLines="None" Width="195px" Font-Names="Tahoma" Font-Size="8pt">
                    <RowStyle BackColor="#FFFBD6" ForeColor="#333333" BorderStyle="Solid" BorderWidth="1px" />
                    <Columns>
                        <asp:BoundField DataField="Status" HeaderText="Status" ReadOnly="True" SortExpression="Status"
                            Visible="False" />
                        <asp:BoundField DataField="Description" HeaderText="Description" ReadOnly="True"
                            SortExpression="Description">
                            <HeaderStyle HorizontalAlign="Left" />
                            <ItemStyle HorizontalAlign="Left" />
                        </asp:BoundField>
                        <asp:BoundField DataField="Count" HeaderText="Count" ReadOnly="True"
                            SortExpression="Count">
                            <HeaderStyle HorizontalAlign="Center" />
                            <ItemStyle HorizontalAlign="Center" />
                        </asp:BoundField>
                    </Columns>
                    <FooterStyle BackColor="#990000" Font-Bold="True" ForeColor="White" />
                    <PagerStyle BackColor="#FFCC66" ForeColor="#333333" HorizontalAlign="Center" />
                    <SelectedRowStyle BackColor="#FFCC66" Font-Bold="True" ForeColor="Navy" />
                    <HeaderStyle BackColor="#990000" Font-Bold="True" ForeColor="White" BorderColor="#990000" BorderStyle="Solid" BorderWidth="1px" />
                    <AlternatingRowStyle BackColor="White" />
                </asp:GridView>
            </td>
            <td style="width: 20%; height: 19px">
            </td>
        </tr>
        <tr>
            <td style="width: 124px; color: #990000; background-color: white; height: 19px;">
                <span style="font-size: 11pt; font-family: Tahoma">
                    <br />
                    <asp:Label ID="Label1" runat="server" Text="Next 10 Jobs Scheduled" Width="236px"></asp:Label></span></td>
            <td style="width: 19px; height: 19px">
            </td>
            <td style="width: 216px; height: 19px;">
                <span style="font-size: 11pt; font-family: Tahoma"></span>
            </td>
            <td style="width: 20%; height: 19px">
            </td>
        </tr>
        <tr>
            <td style="width: 124px; vertical-align: top; height: 147px;">
                <asp:GridView ID="gvNext10" runat="server" AutoGenerateColumns="False" CellPadding="4"
                    Font-Names="Tahoma" Font-Size="8pt" ForeColor="#333333"
                    GridLines="None" Width="800px">
                    <RowStyle BackColor="#FFFBD6" BorderStyle="Solid" BorderWidth="1px" ForeColor="#333333" />
                    <Columns>
                        <asp:BoundField DataField="Interfacename" HeaderText="Name" SortExpression="Interfacename">
                            <HeaderStyle HorizontalAlign="Left" />
                            <ItemStyle HorizontalAlign="Left" />
                        </asp:BoundField>
                        <asp:BoundField DataField="Next Run" HeaderText="Next Run" ReadOnly="True" SortExpression="Next Run">
                            <HeaderStyle HorizontalAlign="Left" />
                            <ItemStyle HorizontalAlign="Left" />
                        </asp:BoundField>
                    </Columns>
                    <FooterStyle BackColor="#990000" Font-Bold="True" ForeColor="White" />
                    <PagerStyle BackColor="#FFCC66" ForeColor="#333333" HorizontalAlign="Center" />
                    <SelectedRowStyle BackColor="#FFCC66" Font-Bold="True" ForeColor="Navy" />
                    <HeaderStyle BackColor="#990000" BorderColor="#990000" BorderWidth="1px" Font-Bold="True"
                        ForeColor="White" />
                    <AlternatingRowStyle BackColor="White" />
                </asp:GridView>
            </td>
            <td style="width: 19px; height: 147px">
            </td>
            <td style="width: 216px; height: 147px; vertical-align: bottom; text-align: center;">
                &nbsp;
                </td>
            <td style="width: 20%; height: 19px">
            </td>
        </tr>
        <tr>
            <td style="vertical-align: top; width: 124px">

            </td>
            <td style="width: 19px">
            </td>
            <td style="width: 216px">
            </td>
            <td style="width: 20%; height: 19px">
            </td>
        </tr>
        <tr>
            <td style="color: #990000; font-family: Tahoma; height: 1px; text-align: left; width: 124px;">
                <span style="font-size: 11pt; vertical-align: top;">
                    <asp:Label ID="Label4" runat="server" Text="Jobs In Process" 
                    Width="307px"></asp:Label></span></td>
            <td style="width: 19px; height: 1px">
                &nbsp;</td>
            <td style="height: 1px; width: 216px;">
                &nbsp;</td>
            <td style="width: 20%; height: 19px">
                &nbsp;</td>
        </tr>
        <tr>
            <td style="color: #990000; font-family: Tahoma; height: 1px; text-align: left; width: 124px;">
                <asp:GridView ID="gvInProcess" runat="server" AutoGenerateColumns="False" CellPadding="4"
                    Font-Names="Tahoma" Font-Size="8pt" ForeColor="#333333"
                    GridLines="None" Width="800px" >
                    <RowStyle BackColor="#FFFBD6" BorderStyle="Solid" BorderWidth="1px" ForeColor="#333333" />
                    <Columns>
                        <asp:BoundField DataField="InterfaceName" HeaderText="Name" SortExpression="InterfaceName">
                            <HeaderStyle HorizontalAlign="Left" />
                            <ItemStyle HorizontalAlign="Left" />
                        </asp:BoundField>
                        <asp:BoundField DataField="Started" HeaderText="Started" SortExpression="DateBegan">
                            <HeaderStyle HorizontalAlign="Left" />
                            <ItemStyle HorizontalAlign="Left" />
                        </asp:BoundField>
                        <asp:BoundField DataField="RunTime" HeaderText="Duration" 
                            SortExpression="RunTime" ReadOnly="True">
                            <HeaderStyle HorizontalAlign="Center" />
                            <ItemStyle HorizontalAlign="Center" />
                        </asp:BoundField>
                    </Columns>
                    <FooterStyle BackColor="#990000" Font-Bold="True" ForeColor="White" />
                    <PagerStyle BackColor="#FFCC66" ForeColor="#333333" HorizontalAlign="Center" />
                    <SelectedRowStyle BackColor="#FFCC66" Font-Bold="True" ForeColor="Navy" />
                    <HeaderStyle BackColor="#990000" BorderColor="#990000" BorderStyle="Solid" BorderWidth="1px"
                        Font-Bold="True" ForeColor="White" />
                    <AlternatingRowStyle BackColor="White" />
                </asp:GridView>
            </td>
            <td style="width: 19px; height: 1px">
                &nbsp;</td>
            <td style="height: 1px; width: 216px;">
                &nbsp;</td>
            <td style="width: 20%; height: 19px">
                &nbsp;</td>
        </tr>
    </table>
    &nbsp;
    <br />
    <br />
    </div>
    </form>
</body>
</html> 
```

仪表板.aspx.cs

```
using System;
using System.Data;
using System.Data.SqlClient;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace IntegrationSupport
{
    public partial class Dashboard : System.Web.UI.Page
    {
        ClassData cd = new ClassData();

        protected void Page_Load(object sender, EventArgs e)
        {
            DataTable dt1 = cd.Dashboard("Summary");
            gvPackageCount.DataSource = dt1;
            gvPackageCount.DataBind();

            DataTable dt2 = cd.Dashboard("Last10");
            gvLast10.DataSource = dt2;
            gvLast10.DataBind();

            DataTable dt3 = cd.Dashboard("Next10");
            gvNext10.DataSource = dt3;
            gvNext10.DataBind();

            DataTable dt4 = cd.Dashboard("InProcess");
            gvInProcess.DataSource = dt4;
            gvInProcess.DataBind();

        }
        protected void btnRefresh_Click(object sender, EventArgs e)
        {
            Response.Redirect("~/Dashboard.aspx");

        }
    }
} 
```

类数据.cs：

```
public DataTable Dashboard(string Section)
        {
            //Get Dashboard Sections...
            string sStoredProc = string.Empty;
            switch (Section)
            {
                case "Summary":
                    sStoredProc = "InterfaceListing_DashboardDataset";
                    break;
                case "Last10":
                    sStoredProc = "InterfaceListing_Dashboard_6Last10Jobs";
                    break;
                case "Next10":
                    sStoredProc = "InterfaceListing_Dashboard_7Next10Jobs";
                    break;
                case "InProcess":
                    sStoredProc = "InterfaceListing_Dashboard_JobsInProcess";
                    break;
                default:
                    sStoredProc = "";
                break;   

            }

            SqlCommand cmd = new SqlCommand();
            Open();
            cmd.Connection = con;
            cmd.CommandText = sStoredProc;
            cmd.CommandType = CommandType.StoredProcedure;

            Ada = new SqlDataAdapter(cmd);
            DataTable dtInterface = new DataTable();
            Ada.Fill(dtInterface);
            return dtInterface;

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-21T10:22:49.507

> 我正在寻找一些关于如何在 ASP.net web >应用程序中实现 slickgrid 的指导。该应用程序查询 sql server 2005 数据库，当前使用 gridviews > 来显示数据。我的目标是消除 gridviews 的使用，并用 >slickgrid 替换它们。我的代码在下面，我不确定如何或从哪里开始。

这将帮助你： http: [//www.codeproject.com/Articles/183301/Real-Time-Stock-Quotes-Stock-Alerts-Indicators-Usi](http://www.codeproject.com/Articles/183301/Real-Time-Stock-Quotes-Stock-Alerts-Indicators-Usi)

# javascript - 将变量作为字符串参数传递给 gaq.push

> ID：14777360
> 
> 赞同：1
> 
> 时间：2013-02-08T16:45:33.007
> 
> 标签：javascript, function, parameters, google-analytics

我正在使用以下代码向导航菜单链接添加 Google Analytics 跟踪事件：

```
(function ($) {
    "use strict";
    $(function () {
        $("body").on('click', '.menu-item a', function () {
            var trackingCode = $(this).next(".ga-tracking");
            if (trackingCode.length > 0) {
                var t1 = trackingCode.data("tracking-1"),
                    t2 = trackingCode.data("tracking-2"),
                    t3 = trackingCode.data("tracking-3"),
                    t4 = trackingCode.data("tracking-4"),
                    params = "'" + t1 + "','" + t2 + "','" + t3 + "'";
                _gaq.push([params]);
            }

        });
    });
}(jQuery)); 
```

您可以在此处看到它的工作原理：http: [//paulwp.com/blog/](http://paulwp.com/blog/) 要触发代码，请单击顶部黑条中的博客链接。

这是我得到的错误：

```
_gaq.push processing "'_trackEvent','Store_Outbound','Link_Click'" for args: "[]":  

Called method "'_trackEvent','Store_Outbound','Link_Click'" threw exception.TypeError: Cannot call method 'apply' of undefined 
```

而它应该给出这样的东西：

```
_gaq.push processing "_trackEvent" for args: "[Store_Outbound,Link_Click]": 
```

猜猜这是我用导致问题的变量构建参数的方式

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T16:53:58.077

您传递的值错误。这实际上就是您正在做的事情：

`_gaq.push(["a,b,c"]);`

那是一个具有单个元素的数组。

这应该是这样的：

`_gaq.push(["a","b","c"]);`

这是一个包含多个元素的数组。

所以基本上你需要做

```
params = [t1,t2,t3];
_gaq.push(params); 
```

或直接将它们放入：

```
_gaq.push([t1,t2,t3]); 
```

# javascript - 将选择性文件从一个分支添加到另一个分支

> ID：14777362
> 
> 赞同：0
> 
> 时间：2013-02-08T16:45:39.123
> 
> 标签：javascript, git, branching-and-merging

在使用 Javascript 进行开发时，作为一种实践，我们在服务器上上传了缩小的 JS，因此我只想在我的主分支中保留缩小的 JS，同时我在本地（私有）分支上进行更改。有没有一种简单的方法可以只将缩小的 JS 从本地分支合并到主分支？

Cherry Pick 提交不起作用，因为我不希望合并我私人提交中的所有文件。[这种方法](http://jasonrudolph.com/blog/2009/02/25/git-tip-how-to-merge-specific-files-from-another-branch/)建议从一个分支中提取特定文件以在另一个分支中提交，我想知道是否有一种设置/替代方法可以自动执行此操作，即合并只需要缩小的 js 文件（* .min.js）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T20:00:31.573

听起来*您的文档根目录*中有一个远程存储库，您正在推送该远程存储库并将其用作实时站点的部署机制。我想说，在文档根目录中有一个 git repo 并不是一个很好的部署方式。（任何人都可以克隆你的整个仓库，包括你的整个提交历史和可能令人尴尬的未发布代码。）也许你有不同的设置，但我会根据你写的内容进行这个假设。

相反，如果您使用 post-receive 钩子提取`master`到您的文档根目录，但让您的 git repo 存在于其他地方，那么您可以毫无顾忌地存储您的缩小和非缩小 JS 源。

将您的 git 存储库移出登台服务器上的文档根目录。

在`.git/hooks/post-receive`您的登台 Web 服务器上：

```
#!/bin/sh
GIT_WORK_TREE=/path/to/your/docroot git archive master --format tar | tar -x "*.min.js" 
```

这将导致`git`将分支的干净副本导出`master`到您选择的目录。它将通过管道来执行此操作`tar`，您可以使用它来准确过滤您想要输出的文件以及您不想要的文件。`post-receive`是一个 shell 脚本，所以你可以在这里尽情发挥，在部署后添加后续行来做任何你想做的家务。

所以，以上是我建议你做的。如果您仍想继续在您的主分支中只保留一部分文件，您可以使用您在 shell 脚本中链接到的方法。

假设您的本地分支名称是`local`，并且您想要“部署”到的所有`master`内容都已提交，请创建一个`deploy.sh`（`.gitignore`如果需要，可以添加）：

```
#!/bin/sh
git checkout master
git diff-tree --name-only -r local | grep ".min.js$" > temp_file_list.txt
git checkout local `sed 'N;s/\n/ /' temp_file_list.txt`
git commit -m "Selective 'merge' of minified js from my local branch" 
```

然后，`deploy.sh`只要您想使用更改的 .min.js 文件更新 master ，您就可以运行。如果您使用的是 Windows 并将本地文件保存为 DOS 格式，则应将`\r\n`而不是仅`\n`放在上面的`sed`命令中，并安装基于 bash 的命令行 git 工具。

# jquery - 当文本框内的文本发生变化时调用什么事件？

> ID：14777365
> 
> 赞同：0
> 
> 时间：2013-02-08T16:46:02.680
> 
> 标签：jquery

```
$(document).delegate("input#search-champions", "change", function(e) 
```

每当我更改里面的值`search-champions`时，我都必须在文本框外部单击才能使其工作。我希望函数在文本框内的值发生变化时运行。

我忘记了它叫什么，但它与 Google 用于搜索的系统相同。你写 A，它会用 A 显示结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T16:47:42.773

尝试绑定到`keyup`事件：

```
$(document).delegate("#search-champions", 'keyup', function(e) 
```

顺便说一句，应该没有必要在你的选择器前面加上`input`- ID 无论如何都应该是唯一的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T16:52:51.887

更改事件不适用于文本框。相反，您可以使用按键或按键事件进行更改。你想要什么，我们称之为自动完成。所以最好的方法是在 keyup 事件上

```
$(document).delegate("input#search-champions", "keyup", function(e){
var elm=$(this);
var str=elm.val();
//now you can get word starting from a either from some array or server call or ajax.

}); 
```

如果您使用的是 jquery ui。它具有自动完成功能。

[http://jqueryui.com/autocomplete/](http://jqueryui.com/autocomplete/)

$(document).delegate("input#search-champions", "change", function(e)

# javascript - 在 Openlayers 中，我如何获得以英里为单位的圆的半径？

> ID：14777369
> 
> 赞同：2
> 
> 时间：2013-02-08T16:46:23.380
> 
> 标签：javascript, openlayers, openstreetmap

我在 Openlayers 的地图上画了一个圆圈，我想以英里为单位计算一个圆圈的半径并显示它。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T15:29:20.233

您可以使用以下代码解决此问题：

```
//vectorLayer.features[0] --> Your circle feature
var central = vectorLayer.features[0].geometry.getCentroid();
var point1 = new OpenLayers.Geometry.Point(central.x, central.y);

var circlePoint = vectorLayer.features[0].geometry.components[0].components[1];
var point2 = new OpenLayers.Geometry.Point(circlePoint.x, circlePoint.y);

var length = point1.distanceTo(point2);

console.log(length * 0.0006213712) 
```

我希望它可以帮助你...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:25:27.327

这就是我最终如何做到的。

```
var measure = event.measure;
var areaSquareMiles =  measure * 0.386102;
var radius = 0.565352 * Math.sqrt(areaSquareMiles); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T12:12:43.397

不确定我是否明白你的问题，但如果你有直径，它应该不会太难： `radius=diameter/2` 如果你只有圆的点并且想要找出半径，你可以通过计算点之间的最大距离来估计直径。根据所需的精度（插值），有不同的解决方案。希望这可以帮助。

# python - django model.delete() 引发 ValueError - 在使用这种多对多关系之前需要为字段提供值

> ID：14777370
> 
> 赞同：0
> 
> 时间：2013-02-08T16:46:25.637
> 
> 标签：python, django

`save_model()`我的django ModelAdmin 类中有一个被覆盖的方法。这个模型有一个`ManyToMany`字段。我的`save_model`样子是这样的：

```
def save_model(self, request, obj, form, change):
        creating = False
        to_delete = False
        if not obj.pk:
            creating = True
        obj.save()
        form.save_m2m()
        # DETECT SOMETHING (some complicated conditions) HERE ...
        detected =True
        if detected:
           obj.delete() # --> here is my problem

Traceback:
File "/Library/Python/2.7/site-packages/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/Library/Python/2.7/site-packages/django/contrib/admin/options.py" in wrapper
  366\.                 return self.admin_site.admin_view(view)(*args, **kwargs)
File "/Library/Python/2.7/site-packages/django/utils/decorators.py" in _wrapped_view
  91\.                     response = view_func(request, *args, **kwargs)
File "/Library/Python/2.7/site-packages/django/views/decorators/cache.py" in _wrapped_view_func
  89\.         response = view_func(request, *args, **kwargs)
File "/Library/Python/2.7/site-packages/django/contrib/admin/sites.py" in inner
  196\.             return view(request, *args, **kwargs)
File "/Library/Python/2.7/site-packages/django/utils/decorators.py" in _wrapper
  25\.             return bound_func(*args, **kwargs)
File "/Library/Python/2.7/site-packages/django/utils/decorators.py" in _wrapped_view
  91\.                     response = view_func(request, *args, **kwargs)
File "/Library/Python/2.7/site-packages/django/utils/decorators.py" in bound_func
  21\.                 return func(self, *args2, **kwargs2)
File "/Library/Python/2.7/site-packages/django/db/transaction.py" in inner
  209\.                 return func(*args, **kwargs)
File "/Library/Python/2.7/site-packages/django/contrib/admin/options.py" in add_view
  956\.                 self.save_related(request, form, formsets, False)
File "/Library/Python/2.7/site-packages/django/contrib/admin/options.py" in save_related
  731\.         form.save_m2m()
File "/Library/Python/2.7/site-packages/django/forms/models.py" in save_m2m
  83\.                 f.save_form_data(instance, cleaned_data[f.name])
File "/Library/Python/2.7/site-packages/django/db/models/fields/related.py" in save_form_data
  1273\.         setattr(instance, self.attname, data)
File "/Library/Python/2.7/site-packages/django/db/models/fields/related.py" in __set__
  859\.         manager = self.__get__(instance)
File "/Library/Python/2.7/site-packages/django/db/models/fields/related.py" in __get__
  846\.             through=self.field.rel.through,
File "/Library/Python/2.7/site-packages/django/db/models/fields/related.py" in __init__
  538\.                                  (instance, source_field_name))

Exception Type: ValueError at /admin/lawis_core/invoice/add/
Exception Value: "<Invoice: 1301000>" needs to have a value for field "invoice" before this many-to-many relationship can be used. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T18:53:41.990

会不会是忘记调用超类了？像这样：

```
class YourAdmin(admin.ModelAdmin)
    def save_model(self, request, obj, form, change):
        super(YourAdmin, self).save_model(request, obj, form, change)  
        # Your code ... 
```

# c - C - 对数组进行编程以将单词存储在文本文档中 - malloc 或取消引用问题

> ID：14777371
> 
> 赞同：0
> 
> 时间：2013-02-08T16:46:35.730
> 
> 标签：c, malloc, dereference

我正在尝试逐字读取文件中的单词并将它们存储在数组中。我看到我正在循环遍历单词，但是当我尝试打印数组时，它存储的不是单词而是其他东西。我认为问题与内存分配或取消引用指针有关。

如果我尝试删除 struct 节点中的 * before 数据，这是我通常在这样的示例中看到的，我得到的所有值都是 null。有人对可能出现的问题有任何想法吗？我对 C 很陌生，所以我知道代码可能不是那么好。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct node
{
    struct node *next;
    char *data;
};

struct node *head, *ptr, *temp;

void display();
void words(char filename[]);

int main(void)
{
    char fname[99];

    head = (struct node *)malloc(sizeof(struct node));

    head->data = NULL;
    head->next = NULL;

        printf("\nEnter file name: \n");
    scanf("%s", fname);
    words(fname);
    return 0;

}

void words(char filename[]){
    printf("o hi!, %s\n",filename);
    //open the file
    FILE *file = fopen(filename, "r");
    char *word;
    char string[50];
    while (fgets(string,50,file)){
        word=strtok(string, " \n");
            do {
                printf("Oh hi!, %s\n",word);

                temp = (struct node *) malloc(sizeof(struct node));
                temp->data = word;
                temp->next = head->next;
                head->next = temp;

                printf("!!!%s\n",temp->data);
                //insert_front(word);
            } while (word=strtok(NULL," \n"));
    }
    display();
}

void display()
{
    ptr = head;
    while(ptr->next != NULL)
    {
        ptr = ptr->next;
        printf("%s\n ", ptr->data);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:51:36.983

```
temp->data = word; 
```

lets `temp->data` point into the `string` array. When you call `fgets` the next time, the contents of `string` are overwritten, and the node in the list points still at the same place in the array, which now no longer contains the token. You need to copy the token,

```
temp->data = malloc(strlen(word) + 1);
strcpy(temp->data,word); 
```

to have it persist past the current iteration of the loop.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T16:51:53.340

When you are setting word = strtok(string, "\n") that is problematic, because string is a local variable and strtok will just give you a pointer inside of that local array.

Try `word = strdup(strtok(string, " \n"));`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T16:52:05.817

换行

```
temp->data = word; 
```

至

```
temp->data = strdup(word); /* Or use malloc and strcpy if it is not implemented on your platform*/ 
```

`data`这将使用带有单词副本的新指针填充节点的项目。

# java - 创建一个网页来显示 一个小服务程序的

> ID：14777372
> 
> 赞同：0
> 
> 时间：2013-02-08T16:46:39.553
> 
> 标签：java, servlets

我正在创建一个将在主页上显示`<init-param>`值的网页。

我的`DD`样子是这样的：

```
<web-app xmlns="http://java.sun.com/xml/ns/j2ee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee
    web-app_2_4.xsd"
    version="2.4">

    <servlet>
        <servlet-name>CheckIt</servlet-name>
        </servlet-class>servlet.Test</servlet-class>

        <init-param>
            <param-name>param1</param-name>
            <param-value>LikeICare</param-value>

            <param-name>param2</param-name>
            <param-value>AgainLikeICare</param-value>
        </init-param>

    </servlet>

    <servlet-mapping>
        <servlet-name>CheckIt</servlet-name>
        <url-pattern>/home</url-pattern>
    </servlet-mapping>
</web-app> 
```

我的代码`servlet.Test`如下所示：

```
import javax.servlet.*;
import javax.servlet.http.*;
import java.io.*;

public class Test extends HttpServlet{
    public void doGet(HttpServletRequest request,HttpServletResponse response) throws IOException{
        String param1 = getServletConfig().getInitParameter("param1");
        String param2 = getServletConfig().getInitParameter("param2");

        response.setContentType("text/html");
        PrintWriter writer = response.getWriter();
        writer.println(param1 + "<br>" + param2);

    }
} 
```

主页在这里：

```
<html>
    <body>
        <h1> Init Parameters  will be displayed here</h1>
    </body>
</html> 
```

`deployment environment`看起来像这样：
![在此处输入图像描述](../Images/2ef6202910726373e5b578493923292e.png)

**但是，当我在浏览器中输入 URL 时出现 404 错误**：`http://localhost:8080/checkInit/home.html`

## 请告诉我出了什么问题

*该`classes`文件夹具有适当的结构`servlet/Test.java`*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:11:01.990

尝试像`http://localhost:8080/checkInit/home` 您`.html`在 URL 末尾附加的那样访问： `http://localhost:8080/checkInit/home.html`

在您的 DD 中，您已将要调用的 servlet 配置为`/home`

```
<servlet-mapping>
  <servlet-name>CheckIt</servlet-name>
  <url-pattern>/home</url-pattern>
</servlet-mapping> 
```

# python - 考虑安装问题

> ID：14777374
> 
> 赞同：0
> 
> 时间：2013-02-08T16:46:40.620
> 
> 标签：python, enthought

我与您联系是因为我正在尝试安装 EPD，以便我可以运行以下软件 ( [http://code.google.com/p/spikepy/wiki/Installation#Mac](http://code.google.com/p/spikepy/wiki/Installation#Mac) )。我从您的网站下载了以下 EPD 安装程序：epd-7.3-2-macosx-i386.dmg

但似乎 Fameworks 没有在库中正确安装，因为当我尝试安装 Spikepy（取决于 EPD）时，出现以下错误：“ImportError: No module named wx”

然后，当我编写命令 python 时，没有提及 EPD，我知道它应该是因为我在以前的计算机上安装它，而是收到以下消息：

```
wl3s-246-58:spikepy-0.82 admin$ python
Python 2.7.1 (r271:86832, Jun 25 2011, 05:09:01) 
[GCC 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2335.15.00)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```

另外，当我搜索 frameworks 文件夹时，虽然它在我安装 EPD 后找到了 10 秒钟，然后似乎消失了：

```
Last login: Thu Feb 7 11:16:50 on ttys000
wl3s-246-58:~ admin$ ls -lah /Library/Frameworks/Python.framework/Versions/Current/bin/python
lrwxr-xr-x 1 root wheel 7B Feb 7 11:12 /Library/Frameworks/Python.framework/Versions/Current/bin/python -> python2
wl3s-246-58:spikepy-0.82 admin$ s -lah /Library/Frameworks/Python.framework/Versions/Current/bin/python
-bash: s: command not found 
```

你能帮我找出问题所在吗？以及如何让 EPD 正确安装在我的计算机上？我的电脑规格是：Mac OSX 版本 10.7.5 1.7GHz Intel Core i5

非常感谢，最好的祝福，露西亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:32:29.150

毕竟，您似乎没有使用 EPD：python 命令应该显示类似

```
Enthought Python Distribution -- www.enthought.com
Version: 7.1-2 (32-bit)

Python 2.7.2 |EPD 7.1-2 (32-bit)| (default, Jul 27 2011, 13:29:32) 
[GCC 4.0.1 (Apple Inc. build 5493)] on darwin
Type "packages", "demo" or "enthought" for more information.
>>> 
```

尝试将此行添加到`.bashrc`主目录中的文件中

```
export PATH=/Library/Frameworks/Python.framework/Versions/Current/bin:$PATH 
```

然后打开一个新终端并尝试`spikepy`再次运行。

# json - 如何在 Yelp API 中显示来自“image_url”的图像？

> ID：14777378
> 
> 赞同：0
> 
> 时间：2013-02-08T16:46:58.403
> 
> 标签：json, uitableview, yelp

我现在了解如何解析和显示 JSON 数据，但有一件事让我难以理解：当我调用“image_url”并接收到实际 URL 时，我该如何显示它所引用的图像？...是的，我是新手 :)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:49:06.463

你可以这样做：

```
UIImage *image = [UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:theUrl]]]; 
```

`theUrl`字符串格式的网址在哪里。然后只需将图像分配给您的图像视图：`imageView.image = image`- 假设您已经在代码中设置了 UIImageView，作为 IBOutlet 或作为视图中的标记对象。

**注意：**您可能想查看[Lazy Table Images](http://developer.apple.com/library/ios/#samplecode/LazyTableImages/Introduction/Intro.html)以异步加载图像。

# javascript - 这个三元运算符有什么问题？

> ID：14777380
> 
> 赞同：5
> 
> 时间：2013-02-08T16:47:06.533
> 
> 标签：javascript, ternary

我有一个对象`menuNames`应该维护一个菜单项列表。如果`menuNames`已经有`slug`，则增加值，如果它不包含`slug`，则将值设置为`1`。我这样做是为了跟踪唯一名称。我想最终得到类似的东西：

```
menuNames: {
    home: 1,
    products: 10,
    contact: 1
} 
```

这不起作用（这将包含在遍历每个 slug 的循环中）：

```
menuNames[slug] = (menuNames.hasOwnProperty(slug) ? menuNames[slug]++ : 1);
//this sets every value to 1 
```

但这确实有效（这将包含在遍历每个 slug 的循环中）：

```
if(menuNames.hasOwnProperty(slug)) {
    menuNames[slug]++;
} else {
    menuNames[slug] = 1;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-08T16:49:18.460

`menuNames[slug]++`增加值，但*也*返回原始值。

您正在执行`menuNames[slug] =`，因此该值在递增后被设置回原始值。

要修复它，只需执行以下操作：

```
menuNames[slug] = (menuNames.hasOwnProperty(slug) ? menuNames[slug]+1 : 1); 
```

或者：

```
(menuNames.hasOwnProperty(slug) ? menuNames[slug]++ : menuNames[slug] = 1); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T16:49:32.177

我想它可以像这样工作：

```
menuNames[slug] = (menuNames.hasOwnProperty(slug) ? ++menuNames[slug] : 1); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T16:52:50.837

正如其他答案所说，问题出在后期增量中。

另一种写法是：

```
menuNames[slug] += (some_bool ? 1 : 0); 
```

`++`**对错误非常**敏感。试着把它写成一个`+=`陈述。

* * *

如果`menuNames[slug]`可以未定义，则将其写为：

```
menuNames[slug] = 0;
if (some_bool) {
    menuNames[slug] += 1;
} 
```

这是（在我看来）编写初始化/计数器循环的最清晰的方法。

如果你喜欢单行代码，你会畏缩，但如果你喜欢无错误代码，你会很高兴看到这一点。

# extjs - 在窗口中折叠 TabPanel

> ID：14777381
> 
> 赞同：0
> 
> 时间：2013-02-08T16:47:07.340
> 
> 标签：extjs, tabpanel, extjs2

我有一个`Ext.Window`带边框的布局。此窗口包含一个网格和一个 TabPanel。这是我的 TabPanel：

```
tabMsg = new Ext.TabPanel(
    id:'TabPanel',
    region : 'south',
    plain : true,
    collapsible: true,
    titleCollapse:'Modify?',
    collapsed: true,
    hideCollapseTool: true,
    //animCollapse : true,
    height : 250,
    activeTab : 0,
    deferredRender: false, // determining whether or not each tab is rendered only when first accessed (defaults to true).
    autodestroy : false,
    defaults : {bodyStyle : 'padding:10px'},
    items : [tab1,tab2,tab3]
}); 
```

我只想用窗口中的一个按钮来折叠\展开它。问题是如何消除可折叠项目的正常行为，因为当我从默认情况下单击另一个选项卡时，TabPanel 会折叠，因为如果您单击折叠栏，可折叠项目也会折叠或展开。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T05:05:02.150

您可以在Collapse 之前附加/侦听一个事件并在那里返回false，这将防止崩溃。请看**[这个链接](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.window.Window-event-beforecollapse)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T17:27:52.527

好的，我解决了我的问题。如果对任何人有用，这就是我所做的：我将此属性设置为我的 TabPanel：

```
 tabMsgProcessedFill = new Ext.TabPanel({ 
            id:'TabPanel',
            region : 'south',
            plain : true,
            collapsible: true,
            collapsed: true,
            floatable: false,
            split:false,
            maxHeight:250,
            height:250,
            collapseMode:'mini',
            hideLabel: true,
            animCollapse : false,
            activeTab : 0,
            deferredRender: false, // determining whether or not each tab is rendered only when first accessed (defaults to true).
            autodestroy : false,
            defaults : {bodyStyle : 'padding:10px'},
            items : [tab1,tab2,tab3]
            }); 
```

并进行此覆盖

```
Ext.override(Ext.layout.BorderLayout.Region,{ 
getCollapsedEl : function(){
    if(!this.collapsedEl){
        if(!this.toolTemplate){
            var tt = new Ext.Template(
                 '<div class="x-tool x-tool-{id}">*</div>'
            );
            tt.disableFormats = true;
            tt.compile();
            Ext.layout.BorderLayout.Region.prototype.toolTemplate = tt;
        }
        this.collapsedEl = this.targetEl.createChild({
            cls: "x-layout-collapsed x-layout-collapsed-"+this.position,
            id: this.panel.id + '-xcollapsed'
        });
        this.collapsedEl.enableDisplayMode('none'); /*change from block*/

        if(this.collapseMode == 'mini'){
            this.collapsedEl.addClass('x-layout-cmini-'+this.position);
            this.miniCollapsedEl = this.collapsedEl.createChild({
                cls: "x-layout-mini x-layout-mini-"+this.position, html: "*"
            });
            this.miniCollapsedEl.addClassOnOver('x-layout-mini-over');
            this.collapsedEl.addClassOnOver("x-layout-collapsed-over");
            this.collapsedEl.on('click', this.onExpandClick, this, {stopEvent:true});
        }else {
            if((this.collapsible !== false) && !this.hideCollapseTool) {
                var t = this.toolTemplate.append(
                        this.collapsedEl.dom,
                        {id:'expand-'+this.position}, true);
                t.addClassOnOver('x-tool-expand-'+this.position+'-over');
                t.on('click', this.onExpandClick, this, {stopEvent:true});
            }
            if((this.floatable !== false) || this.titleCollapse) {
               this.collapsedEl.addClassOnOver("x-layout-collapsed-over");
               this.collapsedEl.on("click", this[this.floatable ? 'collapseClick' : 'onExpandClick'], this);
            }
        }
    }
    return this.collapsedEl;
} 
```

然后窗口包含 TabPAnel 有 layout:'border' 和一个展开或折叠 tabPanel 的按钮。

# objective-c - 目标c：无法用数组覆盖文件

> ID：14777382
> 
> 赞同：-2
> 
> 时间：2013-02-08T16:47:09.417
> 
> 标签：objective-c, arrays, cocoa, writetofile

我是目标 c 的新手，我遇到的问题是，一旦我尝试保存它，我的“scores.xml”就不会被覆盖。我已将“scores.xml”导入我的项目，但一旦我尝试这样做，它就不会被覆盖。我究竟做错了什么？有没有人有任何想法？

```
- (void) writeHighScores:(NSString *)PlayerName{
NSString *highscorePath = [[NSString alloc]init];
NSArray * paths = [[NSBundle mainBundle] pathsForResourcesOfType: @".xml" inDirectory:@""];
for ( NSString * path in paths )
{
    highscorePath = [path substringToIndex:([path length])];
}

NSMutableArray *arrayFromFile = [NSMutableArray arrayWithContentsOfFile:highscorePath];

for (NSMutableArray *element in arrayFromFile){
    if (score > [[element objectAtIndex:1] intValue]){
        [element  replaceObjectAtIndex:0 withObject:PlayerName];
        [element  replaceObjectAtIndex:1 withObject:[NSString stringWithFormat:@"%d", score]];
        break;
    }
}
NSLog(@"Highscore path = %@",highscorePath);

    // Write array
    [arrayFromFile writeToFile:highscorePath atomically:YES];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T16:56:50.397

1）您不能写入应用程序包。时期。写入其他地方（例如，写入 Documents 目录）。

2）这段代码应该做什么？这完全没有意义。

```
NSString *highscorePath = [[NSString alloc]init];
NSArray * paths = [[NSBundle mainBundle] pathsForResourcesOfType: @".xml" inDirectory:@""];
for ( NSString * path in paths )
{
    highscorePath = [path substringToIndex:([path length])];
} 
```

# haskell - Haskell：类型类暗示其他类型类

> ID：14777388
> 
> 赞同：3
> 
> 时间：2013-02-08T16:47:22.100
> 
> 标签：haskell

是否有可能让一个类型类暗示 Haskell 中的另一个类型类？例如，假设有一堆可以按“属性”排序的“事物”：

```
data Person = Person { name :: String, age :: Int }

Person p1 <= Person p1 = (age p1) <= (age p2) 
```

为了避免重复，可以定义一个“按键排序”类型类

```
class OrdByKey o where
  orderKey :: (Ord r) => o -> r
  x <= y = (orderKey x) <= (orderKey y) 
```

然后实例声明`Person`可能看起来像这样

```
instance OrdByKey Person where
  orderKey Person p = age p 
```

现在，由于多种原因，这显然不起作用。我想知道这是否可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:04:36.730

正如您所指定的`OrdByKey`，当您希望能够为记录类型中的每个字段声明一个实例时，该类的每种类型只能有一个实例。

为此，您还必须将字段类型放入类定义中。这使您可以执行以下操作：

```
{-# LANGUAGE MultiParamTypeClasses #-}

data Person = Person { name :: String, age :: Int }

class (Ord r) => OrdByKey o r where
   orderKey :: o -> r

instance OrdByKey Person Int where
  orderKey p = age p

x <=? y = (orderKey x :: Int) <= (orderKey y :: Int) 
```

但是，每个字段类型只能有一个实例，因此如果您的 `Person`类型看起来像

```
data Person = Person { name :: String, age :: Int, ssn :: String} 
```

您将无法在 the`name`和`ssn`字段上进行比较的版本。您可以通过将每个字段包装在 a 中来解决此问题， `newtype`因此每个字段都具有唯一的类型。所以你的`Person`类型看起来像

```
data Person = Person { name :: Name, age :: Age, ssn :: SSN} 
```

不过，这会导致很多`newtypes`浮动。

这样做的真正缺点是需要指定 `orderKey`函数的返回类型。我建议使用`on`函数 from `Data.Function`来编写适当的比较函数。我认为这样的功能

```
compareByKey :: (Ord b) => (a -> b) -> a -> a -> Bool
compareByKey = on (<=) 
```

概括了您“可以通过某些键进行比较”的想法。您只需为其提供提取该键的函数`Person`，在这种情况下，这正是您的类型的访问器函数。

我想不出一个`OrdByKey`类会有用的实例，并且尝试`<=`使用同一类型的多个版本重载它似乎在实践中会令人困惑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T16:58:34.310

你可以这样做：

```
instance Ord Person where
    compare p1 p2 = compare (age p1) (age p2) 
```

现在标准`<=`运算符将对`Person`s 工作并比较他们的年龄。

# webserver - 如何在 OSGi 框架中嵌入 Web 服务器？

> ID：14777389
> 
> 赞同：0
> 
> 时间：2013-02-08T16:47:31.347
> 
> 标签：webserver, osgi, bundle, httpserver

我想知道如何在 OSGi 平台中运行 HTTP 服务器。我目前正在使用 Equinox 并找到了一些关于嵌入 Jetty 捆绑包的官方信息，但指向依赖项的链接似乎已损坏，并且总体上没有很好的文档记录。（[http://www.eclipse.org/equinox/server/http_in_equinox.php](http://www.eclipse.org/equinox/server/http_in_equinox.php)）

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T18:02:58.310

看看 Apache Felix Http 服务[http://felix.apache.org/documentation/subprojects/apache-felix-http-service.html](http://felix.apache.org/documentation/subprojects/apache-felix-http-service.html)因为这些都是精心设计的 OSGi 包，它们也在 Equinox 中运行。

我正在使用他们的白板模型，使用这个捆绑包，您只需注册一个带有服务属性的 Servlet。如果你想检查这一切，建议你下载 bndtools 并使用 webconsole 和 DS 创建一个运行时。这是您为 Hello World servlet 编写的全部内容：

```
package com.example;

@Component(alias="/hello", provide=Servlet.class)
public MyServlet extends HttpServlet {
  public void doGet(HttpServletRequest req, HttpServletResponse rsp) {
     rsp.setContentType("text/plain;charset=UTF-8");
     rsp.getOutputStream().write("Hello World".getBytes("UTF-8"));
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T06:46:08.157

还有 Pax-Web，它为您提供了大量功能。看看[http://team.ops4j.org/wiki/display/paxweb/Pax+Web](http://team.ops4j.org/wiki/display/paxweb/Pax+Web)。它支持标准。Http- 服务、Servlet、过滤器、jsps 的白板呈现器。还有战争（std 或 osgi manifest）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-08T06:51:53.230

您所需要的只是将相应的包安装到您的嵌入式 OSGI 框架中。有一个代码示例：[https](https://bitbucket.org/vbashur/diff/) ://bitbucket.org/vbashur/diff/看看**osgimain**和**osgiservice**项目

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T21:24:26.430

您可以使用[Virgo](http://www.eclipse.org/virgo/documentation/virgo-documentation-3.0.3.RELEASE/docs/virgo-programmer-guide/html/ch02s02.html)：它基于 Equinox 并集成了 tomcat。

至于 Jetty 服务器，它肯定可以嵌入到 OSGi 中：[Apache CXF 项目使用 jetty](http://cxf.apache.org/docs/jetty-configuration.html)来服务 SOAP 请求，而 CXF 在 OSGi 中运行没有任何问题。

# java - 使用超时与 Socket.connect 建立连接

> ID：14777391
> 
> 赞同：2
> 
> 时间：2013-02-08T16:47:39.633
> 
> 标签：java, sockets, connection, timeout

我正在使用 Socket 类建立一个 java TCP 连接。

```
Socket socket = new Socket();
socket.connect(new InetSocketAddress(host,port),50); 
```

我希望快速建立或根本不建立此连接，因此我使用 50 毫秒作为连接超时。

但如果我测量这些调用之间的时间，我会得到超过 50 毫秒：125 毫秒，甚至 200 毫秒。测量我使用 System.currentMillis() 的时间。我知道这种方法的粒度不是很好，但是+100ms 的差异实在是太荒谬了。

连接方法有问题？超时时间太短了 50 毫秒？我在 Windows 7 中使用 java 1.7.0_03。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T18:43:18.250

我觉得这与你如何计时有关。您需要确保在执行之前和之后立即记录时间。

尽管我使用的是 Linux，但我始终使用以下代码得到 51 或 52 的结果：

```
public class SocketTest {
    public static void main(final String[] args) throws IOException {
        Socket socket = new Socket();
        long start = 0;
        try {
            start = System.nanoTime();
            socket.connect(new InetSocketAddress("192.168.1.100", 80), 50);
        } catch (SocketTimeoutException e) {
            long end = System.nanoTime();
            System.out.println("Time: " + ((end - start) / 1000000));
        }
    }
} 
```

更新：我在 Windows 7 中尝试过，我得到了 50 和 51。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T19:08:31.410

扩展 tdn120 的[答案](https://stackoverflow.com/a/14779241/18573)`println`，我终于移到了。我始终<100。我也在运行 Windows 7、Java 7 (1.7.0)。

```
javac -g SocketTest.java && java SocketTest localhost:80 abcd.com:80 localhost:80 localhost:80 localhost:80 
Testing: localhost:80
java.net.SocketTimeoutException: connect timed out
Time: 63
Testing: abcd.com:80
java.net.UnknownHostException: abcd.com
Time: 2350
Testing: localhost:80
java.net.SocketTimeoutException: connect timed out
Time: 50
Testing: localhost:80
java.net.SocketTimeoutException: connect timed out
Time: 50
Testing: localhost:80
java.net.SocketTimeoutException: connect timed out
Time: 50 
```

我的代码如下：

```
import java.net.*;

public class SocketTest {
    public static void main(String[] args) throws Exception {
        if (args.length == 0) {
            args = new String[]{"localhost:80"};
        }
        for (String target: args) {
            test(target);
        }
    }

    private static void test(String target) throws Exception {
        System.out.println("Testing: " + target);
        String[] parts = target.split(":");
        String host = parts[0];
        int port = Integer.valueOf(parts[1]);
        Socket socket = new Socket();
        long start = 0;
        try {
            start = System.nanoTime();
            socket.connect(new InetSocketAddress(host, port), 50);
        } catch (Exception e) {
            System.out.println(e.toString());
        } finally {
            long end = System.nanoTime();
            System.out.println("Time: " + ((end - start) / 1000000));
        }
    }
} 
```

# c# - Parallel.ForEach / 多线程的最佳使用

> ID：14777396
> 
> 赞同：4
> 
> 时间：2013-02-08T16:47:49.297
> 
> 标签：c#, .net, multithreading, parallel.foreach

我需要从网站上抓取数据。我有超过 1,000 个需要访问的链接，以前我将每个线程划分为 10 个链接，并且将启动 100 个线程，每个线程拉出 10 个。在几个测试用例之后，100 个线程是最小化检索内容时间的最佳计数所有的链接。

我意识到 .NET 4.0 为开箱即用的多线程提供了更好的支持，但这是根据您拥有的内核数量来完成的，在我的情况下，这并没有产生足够的线程。我想我要问的是：优化 1,000 链接拉动的最佳方法是什么。我应该使用`.ForEach`并让`Parallel`扩展程序控制产生的线程数量，还是找到一种方法来告诉它启动和划分工作的线程数？

我以前没有合作过，`Parallel`所以也许我的方法可能是错误的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-10-18T09:13:23.310

您可以使用Parallel.ForEach 中的[MaxDegreeOfParallelism](http://msdn.microsoft.com/en-us/library/system.threading.tasks.paralleloptions.maxdegreeofparallelism.aspx) 属性来控制将产生的线程数。

这是代码片段 -

```
ParallelOptions opt = new ParallelOptions();
opt.MaxDegreeOfParallelism = 5;

Parallel.ForEach(Directory.GetDirectories(Constants.RootFolder), opt, MyMethod); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-08T16:53:45.877

一般来说，`Parallel.ForEach()`在优化线程数方面是相当不错的。它考虑了系统中的内核数量，但也考虑了线程在做什么（CPU 绑定、IO 绑定、方法运行多长时间等）。

您可以控制最大并行化程度，但没有强制使用更多线程的机制。

确保您的基准是正确的，并且可以以公平的方式进行比较（例如，相同的网站，在开始测量之前允许一个热身期，并进行多次运行，因为响应时间差异可能是相当高的抓取网站）。如果经过仔细测量，您自己的线程代码仍然更快，您可以得出结论，您针对特定情况进行了比 .NET 更好的优化并坚持使用您自己的代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-08T17:04:16.387

值得一试的是 TPL Dataflow 库。

[MSDN](http://msdn.microsoft.com/en-au/library/hh228603.aspx)上的数据流。

请参阅[Parallel.ForEach 中的嵌套等待](https://stackoverflow.com/questions/11564506/nesting-await-in-parallel-foreach)

> Parallel.ForEach() 背后的整个想法是你有一组线程，每个线程处理集合的一部分。正如您所注意到的，这不适用于 async-await，您希望在异步调用期间释放线程。

此外，演练[创建数据流管道](http://msdn.microsoft.com/en-us/library/hh228604.aspx)专门设置和处理多个网页下载。TPL 数据流确实是为这种情况而设计的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T16:59:30.233

如果不查看您的代码以及集合是如何定义的，很难说，我发现这 `Parallel.Invoke`是最灵活的。试试[msdn](http://msdn.microsoft.com/en-us/library/dd987541.aspx)？...听起来你正在寻找使用`Parallel.For Method (Int32, Int32, Action<Int32, ParallelLoopState>)`

# android - 仅在安装应用程序 Android 后第一次运行 Activity

> ID：14777397
> 
> 赞同：0
> 
> 时间：2013-02-08T16:47:50.163
> 
> 标签：android, android-activity, android-activityrecord

我正在实现一个具有 MainActivity 、 onlyFirstRunActivity 和 alwaysRunActivity 的应用程序。现在我希望**在应用程序安装或更新**应用程序时，我的应用程序周期应该是这样的：

MainActivity -> onlyFirstRunActivity -> alwaysRunActivity

**安装或更新后，**我的应用程序周期应该是：

MainActivity -> alwaysRunActivity

我该如何实施这种情况

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:50:02.860

You can get the update time for your app and save it in a SharedPreference.

Also, you should just make your main activity the always run one.

```
//In your onCreate for your main activity/.
if(last_update_preference < current_update_time){
   Update last update preference to current update time.
   Run first activity. (Which will finish and bounce you back);
} 
```

To get the current_update_time:

[How to get app install time from android](https://stackoverflow.com/questions/2831333/how-to-get-app-install-time-from-android)

For last update time, see:

[http://developer.android.com/guide/topics/data/data-storage.html#pref](http://developer.android.com/guide/topics/data/data-storage.html#pref)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T16:51:59.500

You can try something like this:

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    App app = (App)getApplication();
    if (app.getApi() != null){
        super.onBackPressed();
        startActivity(new Intent(this, MainActivity.class));
        return;
    }else showLoginForm();//or do something else.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T16:41:27.083

像这样，您可以在新安装和更新之间有所不同。

```
 String StoredVersionname = "";
    String VersionName;
    AlertDialog LoginDialog;
    AlertDialog UpdateDialog;
    AlertDialog FirstRunDialog;
    SharedPreferences prefs;

    public static String getVersionName(Context context, Class cls) {
                try {
                    ComponentName comp = new ComponentName(context, cls);
                    PackageInfo pinfo = context.getPackageManager().getPackageInfo(
                            comp.getPackageName(), 0);
                    return "Version: " + pinfo.versionName;
                } catch (android.content.pm.PackageManager.NameNotFoundException e) {
                    return null;
                }
            }

    public void CheckFirstRun() {
                VersionName = MyActivity.getVersionName(this, MyActivity.class);
prefs = PreferenceManager.getDefaultSharedPreferences(this);
                StoredVersionname = (prefs.getString("versionname", null));
                if (StoredVersionname == null || StoredVersionname.length() == 0){
                    FirstRunDialog = new FirstRunDialog(this);
                    FirstRunDialog.show();
                }else if (StoredVersionname != VersionName) {
                    UpdateDialog = new UpdateDialog(this);
                    UpdateDialog.show();
                }
                prefs.edit().putString("versionname", VersionName).commit();
            } 
```

# ios - 如何在文本中添加“复制”选项？

> ID：14777406
> 
> 赞同：0
> 
> 时间：2013-02-08T16:48:30.910
> 
> 标签：ios, objective-c, uikit

通过将文本拟合到图像中，我在“气泡”中有一个文本，如下所示。它工作正常，除了文本不可复制。我需要有“复制”选项，以便在文本（或气泡图像）上的用户选项卡显示“警察”选项时，就像用户选项卡进入内置 SMS 消息气泡时一样。

```
#import "SpeechBubbleView.h"

static UIFont* font = nil;
static UIImage* lefthandImage = nil;
static UIImage* righthandImage = nil;

const CGFloat VertPadding = 4;       // additional padding around the edges
const CGFloat HorzPadding = 4;

const CGFloat TextLeftMargin = 17;   // insets for the text
const CGFloat TextRightMargin = 15;
const CGFloat TextTopMargin = 10;
const CGFloat TextBottomMargin = 11;

const CGFloat MinBubbleWidth = 50;   // minimum width of the bubble
const CGFloat MinBubbleHeight = 40;  // minimum height of the bubble

const CGFloat WrapWidth = 200;       // maximum width of text in the bubble

@implementation SpeechBubbleView

+ (void)initialize
{
    if (self == [SpeechBubbleView class])
    {
        font = /*[*/ [UIFont systemFontOfSize:[UIFont systemFontSize]] /*retain]*/;

        lefthandImage = /*[*/ [[UIImage imageNamed:/*@"BubbleLefthand"*/@"lefttest4"]
            stretchableImageWithLeftCapWidth:20 topCapHeight:19] /*retain]*/;

        righthandImage = /*[*/[[UIImage imageNamed:/*@"BubbleRighthand"*/@"righttest4"]
            stretchableImageWithLeftCapWidth:20 topCapHeight:19] /*retain]*/;
    }
}

+ (CGSize)sizeForText:(NSString*)text
{
    CGSize textSize = [text sizeWithFont:font
        constrainedToSize:CGSizeMake(WrapWidth, 9999)
        lineBreakMode:UILineBreakModeWordWrap];

    CGSize bubbleSize;
    bubbleSize.width = textSize.width + TextLeftMargin + TextRightMargin;
    bubbleSize.height = textSize.height + TextTopMargin + TextBottomMargin;

    if (bubbleSize.width < MinBubbleWidth)
        bubbleSize.width = MinBubbleWidth;

    if (bubbleSize.height < MinBubbleHeight)
        bubbleSize.height = MinBubbleHeight;

    bubbleSize.width += HorzPadding*2;
    bubbleSize.height += VertPadding*2;

    return bubbleSize;
}

- (void)drawRect:(CGRect)rect
{
    [self.backgroundColor setFill];
    UIRectFill(rect);

    CGRect bubbleRect = CGRectInset(self.bounds, VertPadding, HorzPadding);

    CGRect textRect;
    textRect.origin.y = bubbleRect.origin.y + TextTopMargin;
    textRect.size.width = bubbleRect.size.width - TextLeftMargin - TextRightMargin;
    textRect.size.height = bubbleRect.size.height - TextTopMargin - TextBottomMargin;

    if (bubbleType == BubbleTypeLefthand)
    {
        [lefthandImage drawInRect:bubbleRect];
        textRect.origin.x = bubbleRect.origin.x + TextLeftMargin;
    }
    else
    {
        [righthandImage drawInRect:bubbleRect];
        textRect.origin.x = bubbleRect.origin.x + TextRightMargin;
    }

    [[UIColor blackColor] set];
    [text drawInRect:textRect withFont:font lineBreakMode:UILineBreakModeWordWrap];
}

- (void)setText:(NSString*)newText bubbleType:(BubbleType)newBubbleType
{
    //[text release];
    /**
     handle local
     **/

   // text = [newText copy];

    text = [newText copy];

    bubbleType = newBubbleType;
    [self setNeedsDisplay];
}

- (void)dealloc
{
    //[text release];
    //[super dealloc];
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-22T22:47:46.230

`UITextField`如果您希望系统剪切/复制/粘贴菜单（或其中的某些子集）没有来自or的全套文本可编辑性功能`UITextView`，您需要提供自己的[`UIMenuController`](https://developer.apple.com/library/ios/documentation/iPhone/Reference/UIMenuController_Class/index.html#//apple_ref/occ/cl/UIMenuController). 这样做需要：

*   受菜单影响的控件可以成为第一响应者
*   所述控件（或在其上方的响应者链中的某些合理的东西）实现了`copy:`您想要支持的编辑方法（例如）
*   您执行一些事件处理以在适当的时间呈现菜单控制器（例如手势识别器操作）

通常情况下，[NSHipster 上有一个很好的教程，](http://nshipster.com/uimenucontroller/)其中包含 Swift 和 ObjC 示例代码。感谢@mattt，虽然我想说这条线需要更正：

> 如果您想知道为什么，*哦，为什么*，这不仅仅是内置`UILabel`的，嗯……加入俱乐部。

“加入俱乐部”应替换为“[提交错误](http://bugreport.apple.com)”。它甚至有点押韵！

# android - Android AccountManager 使用 getAuthTokenByFeatures 时是否可以自定义返回帐户列表的布局

> ID：14777409
> 
> 赞同：1
> 
> 时间：2013-02-08T16:48:43.530
> 
> 标签：android, android-account

当我打电话给

```
AccountManager.get(this).getAuthTokenByFeatures(Constants.ACCOUNT_TYPE, Constants.AUTHTOKEN_TYPE, null, this, null, null, 
                new AccountManagerCallback<Bundle>() 
```

这是在我的实现中为 AbstractAccountAuthenticator 在重写的 addAccount 方法中设置的

如果没有设置帐户，则使用我添加新帐户的活动，这很好，但是如果有多个帐户，我会看到一个可供选择的帐户列表。我希望通过尚未创建的 AccountsListActivity 自定义此列表，以更接近地表示 Android 系统中内置的 Accounts & Sync 选项。

是否可以设置一个活动来处理以相同方式返回帐户列表时发生的情况，我将如何做到这一点？我知道如何编写类我只需要知道如何调用类而不是简单的帐户名称列表

如果没有，我有什么选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-20T10:57:02.047

我不太确定我的问题是否正确，但如果您只想实现从帐户列表中进行选择的可能性，您将有几个选项。

**选项1**

我选择的是一个简单的对话框弹出窗口，其中包含帐户。像这样覆盖您的活动（用于获取帐户的活动）中的 onCreateDialog：

```
@Override
protected Dialog onCreateDialog(int id) {
    switch (id) {
    case DIALOG_ACCOUNTS:
        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setTitle("Title");
        final int size = accounts.length;

        String[] names = new String[size];
        for (int i = 0; i < size; i++) {
            names[i] = accounts[i].name;
        }
        builder.setItems(names, new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int which) {
                // Stuff to do when the account is selected by the user
                handleSelectedAccount(accounts[which]);
            }
        });
        return builder.create();
    }
    return null;
} 
```

**注意：** accounts 是获取到的账号列表。

要显示弹出窗口，只需调用：showDialog(DIALOG_ACCOUNTS)。

**选项 2**

从 Android 4.0 开始，AccountManager 可以通过以下方式生成用于帐户选择的 Activity

```
Intent intent = AccountManager.newChooseAccountIntent(null, null,
                new String[] { "com.google" }, false, null, null, null,
                null); 
```

我在这里找到了这个解决方案：http: [//blog.tomtasche.at/2013/05/google-oauth-on-android-using.html](http://blog.tomtasche.at/2013/05/google-oauth-on-android-using.html)

也许我可以帮助你；）

# matlab - Bivariate mvncdf for a matrix with different covariance matrices (Matlab)

> ID：14777414
> 
> 赞同：1
> 
> 时间：2013-02-08T16:47:05.610
> 
> 标签：matlab

I want to do the following:

```
for i = 1:N
    l(i) = mvncdf(x(i,:), mu, sigma(:,:,i))
end 
```

Can I do it without a loop given that a covariance matrix is different for each row of x?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:39:55.113

当然。尝试这个：

```
func = @(i) mvncdf(x(i,:), mu, sigma(:,:,i));
l = arrayfun(func, 1:N) 
```

这是一个简洁的谜题类型的问题，但我想说你的带有循环的代码更具可读性，并且可能同样快。

# html - Missing encoding in POST request headers

> ID：14777418
> 
> 赞同：0
> 
> 时间：2013-02-08T16:49:10.603
> 
> 标签：html, forms, http, encoding

If I send a HTML page with UTF-8 encoding which contains a form, is it correct that the browser does not specify the encoding in the POST request header parameters?

I have tested it with the current version of Firefox 18 and Internet Explorer 9 (see below).

Based on the answer to [Why does POST not honor charset, but an AJAX request does? tomcat 6](https://stackoverflow.com/questions/4392610/why-does-post-not-honor-charset-but-an-ajax-request-does-tomcat-6), setting the HTML page encoding 'will set the response encoding to UTF-8 and set the response header to UTF-8'.

In my tests, the response headers did not specify that the form values are encoded in UTF-8.

Is this as specified?

> ```
> Request: POST /demo/form.html HTTP/1.1
> Accept: text/html, application/xhtml+xml, */*
> Referer: http://127.0.0.1:8080/demo/form.html
> Accept-Language: de
> User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.0; Trident/5.0)
> Content-Type: application/x-www-form-urlencoded
> Accept-Encoding: gzip, deflate
> Host: 127.0.0.1:8080
> Content-Length: 29
> Connection: Keep-Alive
> Cache-Control: no-cache 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T19:36:43.403

application/x-www-form-urlencoded 媒体类型没有字符集参数，因此浏览器行为是正确的。

# authentication - Three upgradeable access level in joomla 2,5

> ID：14777425
> 
> 赞同：0
> 
> 时间：2013-02-08T16:49:37.960
> 
> 标签：authentication, joomla, user-registration

i want to register diffrent level of users in my joomla site, i've installed also CB(community builder). now i would like to register 3 types of users in my site in three level, mean guest(default users), newsletter, limited user(testers), club user(real members). actually the problem is there is not a simple way to let users upgrade their accounts. so the question :" how can we create a hierarchy level users access in a upgradeable way? "

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T16:55:26.883

您可以使用[Akeeba 订阅](http://extensions.joomla.org/extensions/e-commerce/membership-a-subscriptions/19528)。这将允许您创建 3 个不同的订阅级别，并根据他们选择的一个，将它们添加到特定的用户组。此组件还允许用户升级他们的订阅，在您的情况下，这将是升级到不同的用户组。

希望这可以帮助

# javascript - 如何将鼠标的 currentTarget 传递给 timelineMax 函数

> ID：14777433
> 
> 赞同：0
> 
> 时间：2013-02-08T16:50:22.810
> 
> 标签：javascript, backbone.js, gsap

所以我正在尝试创建一个可重用的函数，我页面上的每个 .featured-image 都使用它。如果我不使用主干事件：并且我只是编写被注释掉的代码，它就可以工作。如何获得模仿注释代码的事件 imageOver 和 imageOut？

```
app.newsroomPageElementView = Backbone.View.extend({

 events: {
        'mouseenter .featured-image': 'imageOver',
        'mouseleave .featured-image': 'imageOut'
     },

      initialize: function () {
        $(".featured-image").each(function(index, element){
        var tl = new TimelineLite({paused:true});
        tl.to(element, 0.2, {opacity:.9, scale:.9})
        .to(element, 0.2, {backgroundColor:"#004", color:"orange"}, "-=0.1")
        element.animation = tl;
        })

     // This part works if i don't use imageOver and imageOut

     // $("li").hover(over, out);

     // function over(){
     //   this.animation.play();
     // }

     // function out(){
     //  this.animation.reverse();
     // }

        },

        imageOver: function (e) {
            // What goes here?
        },
        imageOut: function (e) {
            // What goes here?
        }

    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:07:40.567

使用事件哈希，您可以通过`event`对象访问事件目标，并仍然通过访问视图实例`this`

```
 imageOver: function (event) {
      $(event.target).animation.play();
  }, 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T21:01:01.000

```
 imageOver: function (event) {
        var target = event.currentTarget;
        // What goes here?
        target.animation.play();
    },
    imageOut: function (event) {
        var target = event.currentTarget;
        // What goes here?
        target.animation.reverse();
    } 
```

# html - 浮动元素第一个与第二个重叠

> ID：14777435
> 
> 赞同：0
> 
> 时间：2013-02-08T16:50:29.753
> 
> 标签：html, css, css-float

我试图做一个简单的页面来占据整个浏览器窗口。它只包含两个元素，问题是第二个元素与第一个元素重叠

```
form 
{
    background-color:#996600;
    width:30%;
    height:100%;
    float:left;    
    font:"Arial Black", Gadget, sans-serif;
    color:#FFF
}

#risultati 
{
    width:70%;
    background-color:#0099FF;
    font:"Arial Black", Gadget, sans-serif;
    color:#FFF
}

<body>

<form action"">
 <label>Inserisci ragione sociale</label>
   <input name="chiave" onkeyup="showHint(this.value)"/>

 <!-- <input type="submit"/> -->
</form>

<p id="risultati">Risultati: <span id="txtHint"></span></p> 

</body> 
```

哪里有问题？

编辑：我注意到重叠只影响第二个元素的背景属性（“Risultati”字通常是浮动的）。我希望背景从第一个元素的结尾开始占据浏览器的其余空间。相反，它从第一个元素所在的浏览器左侧开始。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T16:55:38.663

一个元素是`float: left`，而另一个不是；这导致了重叠。尝试在 CSS 中添加`float: left`声明`#risultati`：

```
#risultati 
{
    width:70%;
    background-color:#0099FF;
    font:"Arial Black", Gadget, sans-serif;
    color:#FFF;
    float: left;
} 
```

# javascript - Leaflet: Pass an extra argument to L.geoJson options

> ID：14777441
> 
> 赞同：5
> 
> 时间：2013-02-08T16:50:58.447
> 
> 标签：javascript, oop, web-applications, gis, leaflet

I'm working on choropleth maps using Leaflet framework. I'd like to have several separate layers for several years, so i' ve written this code (note that only names of 'style2002' and 'style2010' should be passed, without any arguments):

```
 population2002 = L.geoJson(regionData, {
        style: style2002
    });

    population2010 = L.geoJson(regionData, {
        style: style2010
    }); 
```

, there "style" functions which are colouring my vector polygons depening on their attributes (which names are prefix 'Pop_' plus year) are:

```
 function style2002(feature)
    {
        return {
            fillColor: getColor(feature.properties.Pop_2002),
            weight: 2,
            opacity: 1,
            color: 'white',
            dashArray: '',
            fillOpacity: 0.7
        };
    }

    function style2010(feature)
    {
        return {
            fillColor: getColor(feature.properties.Pop_2010),
            weight: 2,
            opacity: 1,
            color: 'white',
            dashArray: '',
            fillOpacity: 0.7
        };
    }; 
```

As you can guess, i want to use one "style" function instead of separate functions for each year i need. Something like:

```
 function styleByYear(feature, year)
    {   
        var property = 'feature.properties.Pop_';
        property += year;
        return {
            fillColor: getColor(property),
            weight: 2,
            opacity: 1,
            color: 'white',
            dashArray: '',
            fillOpacity: 0.7
        };
    } 
```

But how to pass the second argument to style function? In L.geoJson constructor i write only the name of function, without any arguments, as you can see from the first piece of code! What should i do? And one more question: how the first argument ('feature') is passed into layer constructor..?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-18T16:58:25.647

如果你创建一个全局变量怎么办：

```
var property = 'Pop_' + year 
```

并将您的功能编辑为以下内容（您应该使用括号而不是点符号）：

```
 function styleByYear(feature)
{   

    return {
        fillColor: getColor(feature['properties'][property]),
        weight: 2,
        opacity: 1,
        color: 'white',
        dashArray: '',
        fillOpacity: 0.7
    };
} 
```

根据像您这样的 choropleth 教程，我已经做了类似于您所要求的事情。我有多个按钮可以更改不同日期的地图样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-17T09:29:29.903

您可以尝试[GeoJSON 的 Leaflet 教程中](http://leafletjs.com/examples/geojson.html)的内容。在“选项”部分中查找第二个代码部分。您只需先添加正常样式（即两年都相同的东西）。取自该站点的示例，添加了您的特定代码：

```
geojsonlayer = L.geoJson(regionData, {
  style: function(feature) {
    var finalStyleObject = normalStyling(feature); //return the normal style object
    switch (feature.properties) { //switch through the various years
        case 'Pop_2002': {finalStyleObject.fillColor: "#ff0000"};
        case 'Pop_2010': {finalStyleObject.fillColor: "#0000ff"};
    }
    return finalStyleObject;
  }
});

function normalStyling(feature){
  return {
        weight: 2,
        opacity: 1,
        color: 'white',
        dashArray: '',
        fillOpacity: 0.7
    };
} 
```

# rotation - 如何计算局部旋转以保持文本直立？

> ID：14777442
> 
> 赞同：1
> 
> 时间：2013-02-08T16:51:06.953
> 
> 标签：rotation, three.js

我在屏幕上有始终面向用户的文本，并使用以下代码保持直立（这是有效的）：

object.lookAt(camera.position);
object.rotation.x = 相机.rotation.x;
object.rotation.y = camera.rotation.y;
object.rotation.z = camera.rotation.z;

现在，在按钮将场景绕 y 轴旋转 90 度后，

target = new THREE.Vector3(camera.position.z, camera.position.y, -camera.position.x);

object.lookAt(目标);

所以文本根据需要面向用户，但是当我使用轨迹球控件旋转场景时，我无法弄清楚如何计算对象旋转以保持文本垂直：

object.rotation.x = ??
object.rotation.y = ??
object.rotation.z = ??

建议？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:22:59.763

最简单的解决方案是`THREE.OrbitControls`改用。

然后，在您的渲染循环中：

```
object.quaternion.copy( camera.quaternion ); 
```

三.js r.69

# css - 级联 CSS 菜单中的溢出问题

> ID：14777443
> 
> 赞同：1
> 
> 时间：2013-02-08T16:51:10.507
> 
> 标签：css, position, overflow

我有一个简单的基于 CSS 的下拉菜单，它运行良好。但现在我想添加一个也会显示的子菜单。一切正常，除了显示子菜单时主菜单列表上的高度正在扩展。

[http://jsfiddle.net/GzfFs/](http://jsfiddle.net/GzfFs/)

```
.cascade_content {
/* cascading sub menu */
display: none;
z-index: 103;
position: relative;
background: #FFFFFF;
border: 1px solid #8C8C8C;
padding: 10px 0px 10px 0px;
width: 190px;
left: -192px;
top: -26px;
-moz-box-shadow: 0 2px 6px 0px #8C8C8C;
-webkit-box-shadow: 0 2px 6px 0px #8C8C8C;
box-shadow: 0 2px 6px 0px #8C8C8C; 
```

}

注意：似乎子菜单中的 position:relative 导致了这个......但是，将其更改为 position:absolute 会导致它没有出现在正确的位置。我相信那些有更多 CSS 经验的人会认为这是一个简单的问题 - 感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:01:52.553

[http://jsfiddle.net/GzfFs/1/](http://jsfiddle.net/GzfFs/1/)

```
.dropdown_content li {position: relative}
.cascade_content {position: absolute} 
```

您可能还需要将 UL 移动到 LI 内，以便将其定位到您想要的位置。

# java - JAXB - marshal java object with XML string field

> ID：14777444
> 
> 赞同：3
> 
> 时间：2013-02-08T16:51:12.857
> 
> 标签：java, xml, jaxb, marshalling, jaxb2

**suppose i have an object with String property that has an XML string. like:**

```
 class myObject {
    String xml;

    @XmlElement(name = "xml", type = String.class)
    public String getXml() {
        return xml;
    }

    public void setXml(String xml) {
        this.xml = xml;
    }
} 
```

i set an XML String to this property - such as

```
 myObject.setXml("<xml>bbb</xml>"); 
```

now i want to marshal it using JAXB and i get:

```
<xml>&lt;xml&gt;bbb&lt;/xml&gt;</xml> 
```

where i want to get

```
<xml>bbb</xml> 
```

how can i do it?

EDIT: the problem is that String xml, stores a well formatted XML as a string. so I want this string to be marshaled without escaping the XML characters.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T17:22:59.493

如果您想在您的 Java 模型中存储一个 XML 片段`String`，那么您可以使用`@XmlAnyElement`带有`DomHandler`指定的注解来实现这一点。

**堆栈溢出示例**

*   [JAXB 按原样使用 String](https://stackoverflow.com/questions/13121914/jaxb-use-string-as-it-is/13123294#13123294)
*   [如何使用 JAXB 编组有时包含 XML 内容有时不包含的字符串？](https://stackoverflow.com/questions/12428727/how-to-marshall-a-string-using-jaxb-that-sometimes-contains-xml-content-and-some/12429211#12429211)
*   [使用 JAXB 提取 XML 元素的内部文本](https://stackoverflow.com/questions/5537416/using-jaxb-to-extract-inner-text-of-xml-element/5553682#5553682)

# configuration - WSO2 ESB 4.6.0 Get PayloadFactory format from configuration

> ID：14777446
> 
> 赞同：1
> 
> 时间：2013-02-08T16:51:27.510
> 
> 标签：configuration, wso2esb, payload

I am trying to put together a sequence that pulls out properties from an initial request and stores those properties until the response comes back, replace certain regions and send that to another service. I have successfully accomplished this but I want to refine my approach by hosting the payloadFactory format in the registry and reference it using the key attribute within the format tag.

Here is an example of what I want to accomplish: [Sajini's Blog](http://sajinid.blogspot.com/2012/11/pick-payload-factory-from-registry-in.html?showComment=1360341526157#c4520639672218204513)

Here is the code I am currently working with:

```
<sequence xmlns="http://ws.apache.org/ns/synapse">
   <payloadFactory>
      <format>
         <AddEditEmailAddress xmlns="http://tempuri.org/">               
            <eResponse xmlns:a="http://schemas.datacontract.org/2004/07/NoelGroup.Users.Core.Task.BusinessLayer" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">            $1                  
               <Success xmlns="http://schemas.datacontract.org/2004/07/NoelGroup.Users.Task.BusinessLayer">true</Success>            $2            
            </eResponse>               
            <personId>$3</personId>         
         </AddEditEmailAddress>
      </format>
      <args>
         <arg xmlns:ns="http://org.apache.synapse/xsd" expression="get-property('default','BROKEN_OBJECT')"/>
         <arg xmlns:ns="http://org.apache.synapse/xsd" xmlns:a="http://schemas.datacontract.org/2004/07/NoelGroup.Users.Core.Task.BusinessLayer" expression="get-property('default','EMAILS')"/>
         <arg xmlns:ns="http://org.apache.synapse/xsd" expression="get-property('default','PERSON_ID')"/>
      </args>
   </payloadFactory> 
```

And here is what I desire:

```
<sequence xmlns="http://ws.apache.org/ns/synapse">
   <payloadFactory>
      <format key="conf:/User_Sync_Assets/Email_Req.xml"/>
      <args>
         <arg xmlns:ns="http://org.apache.synapse/xsd" expression="get-property('default','BROKEN_OBJECT')"/>
         <arg xmlns:ns="http://org.apache.synapse/xsd" xmlns:a="http://schemas.datacontract.org/2004/07/NoelGroup.Users.Core.Task.BusinessLayer" expression="get-property('default','EMAILS')"/>
         <arg xmlns:ns="http://org.apache.synapse/xsd" expression="get-property('default','PERSON_ID')"/>
      </args>
   </payloadFactory> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-19T08:44:55.273

此功能将在 ESB 4.7.0 版本中提供。

# html - Form background color only working in IE 8?

> ID：14777449
> 
> 赞同：0
> 
> 时间：2013-02-08T16:51:39.400
> 
> 标签：html, css

Normally, IE8 is the bane of my existence, but in this case it's the only browser that seems to be picking up the form background color correctly. Here is the CSS that seems to only be behaving as expected in IE8\. Both Firefox and Safari have no background color to the forms.

```
#defaultform {

width: 500px;
padding: 20px;
background: #f0f0f0;
overflow:auto;

/* Border style */
border: 1px solid #cccccc;
-moz-border-radius: 7px;
-webkit-border-radius: 7px;
border-radius: 7px;

/* Border Shadow */
-moz-box-shadow: 2px 2px 2px #cccccc;
-webkit-box-shadow: 2px 2px 2px #cccccc;
box-shadow: 2px 2px 2px #cccccc;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:40:20.567

可以是你的 doctype 吗？它适用于我在 Firefox 和 Safari 中使用这个：

```
<!DOCTYPE html>
<html>
<head>
<style>
#defaultform {

width: 500px;
padding: 20px;
background: #f0f0f0;
overflow:auto;

/* Border style */
border: 1px solid #cccccc;
-moz-border-radius: 7px;
-webkit-border-radius: 7px;
border-radius: 7px;

/* Border Shadow */
-moz-box-shadow: 2px 2px 2px #cccccc;
-webkit-box-shadow: 2px 2px 2px #cccccc;
box-shadow: 2px 2px 2px #cccccc; 

}
</style>
</head>
<body>

<form id="defaultform" name="myform">
    <label>Input 1</label>
    <input type="text" name="input1" value="" />
</form>
</body>
</html> 
```

# java - 在 Java 中，需要使变量可用于控制中断解决方案

> ID：14777454
> 
> 赞同：0
> 
> 时间：2013-02-08T16:51:53.307
> 
> 标签：java, global-variables

下面是为控制中断模式创建可重用解决方案的尝试。它建立在命令模式（操作和测试接口）之上。然而，我意识到我以前的 COBOL 思维阻碍了我，因为这个解决方案基于每个可以访问“全局变量”的 Action 和 Test 对象。在那之后我的直接想法是“需要像这样（更广泛的范围）的变量访问必须是一个已经发明的轮子。

如何让下面的所有操作和测试访问一组变量——一个不确定的组，因为这应该是一个可重用的解决方案？

```
public class ControlBreak {

public static void controlBreak(Action initialize, 
                                Test   endOfInput, 
                                Test   onChange, 
                                Action breakAction, 
                                Action detailAction, 
                                Action getNext) {

    boolean hasProcessed = false;

    getNext.execute();
    for (initialize.execute();endOfInput.test();detailAction.execute(),getNext.execute()) {
        hasProcessed = true;
        if (onChange.test()) {
            breakAction.execute();
        }
        detailAction.execute();
    }
    if (hasProcessed) {
        breakAction.execute();
    } else {
        // throw empty input exception
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:11:13.917

在几次重读中，您似乎正在尝试抽象某个控制流，其中可以耦合参数。在这种情况下，我会研究泛型。即是这样的：

```
public static void <TParams> controlBreak(Action<TParams> initialize, ..., TParams params) {
    // ...
    initialize.execute(params)
    // ...
} 
```

这样，该方法将保持可重用，但各种操作/测试仍然可以接受强类型的参数/变量集。（具体类型`TParam`。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T19:13:03.150

多亏了millimoose，我到了要去的地方。这是充实的代码，供参考：

```
 public class ControlBreak<TParams> {

    public TParams controlBreak(Action<TParams> initialize, 
                                    Test<TParams>   endOfInput, 
                                    Test<TParams>   onChange, 
                                    Action<TParams> breakAction, 
                                    Action<TParams> detailAction, 
                                    Action<TParams> getNext,
                                    TParams params) {

        boolean hasProcessed = false;

        getNext.execute(params);
        for (params = initialize.execute(params);endOfInput.test(params);params = detailAction.execute(params),params = getNext.execute(params)) {
            hasProcessed = true;
            if (onChange.test(params)) {
                breakAction.execute(params);
            }
            detailAction.execute(params);
        }
        if (hasProcessed) {
            breakAction.execute(params);
        } else {
            // throw empty input exception
        }
        return params;
    }
} 
```

# android - 从 Android App 访问 MS SQL 数据库

> ID：14777457
> 
> 赞同：0
> 
> 时间：2013-02-08T16:52:27.253
> 
> 标签：android, sql-server, database

我希望我的 Android 应用程序连接到 MS SQL 数据库。我也试过谷歌，但只有这个链接有点清楚，但我没有正确理解。

[http://mob-programming.blogspot.com/search/label/How%20to%20connect%20and%20access%20SQL%20Database%20server%20from%20Android%20app%3F%3F](http://mob-programming.blogspot.com/search/label/How%20to%20connect%20and%20access%20SQL%20Database%20server%20from%20Android%20app%3F%3F)

任何人都可以提供有关如何从 Android 连接到 MS SQL 数据库的教程链接吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:02:46.887

您需要使用 JDBC（Java 数据库连接）和[此处提供](http://msdn.microsoft.com/en-us/sqlserver/aa937724.aspx)的 MS SQL 数据库驱动程序连接到 MS SQL 数据库。我没有亲自尝试过，我不确定它是否与 Android 兼容。事实上，我怀疑该驱动程序是否与 Android 兼容，但可能值得一试。

最好的办法是使用非直接方法连接到数据库，例如创建一个公开所需数据的 Web 服务。

# winapi - 如何使用 outp(0x92,1) 重新启动 Windows

> ID：14777461
> 
> 赞同：0
> 
> 时间：2013-02-08T16:52:43.820
> 
> 标签：winapi

我正在为许多不同的 Windows 客户安装测试一个应该在电源故障后正常恢复的应用程序。

这个特殊的应用程序使用了一个专有数据库，我正在通过崩溃恢复功能对其进行增强。有一天，它将被重新设计以使用强大的标准数据库，但我们还没有做到。

所以我的问题是如何模拟电源故障来测试应用程序的新恢复能力。请注意，Windows 重启是不够的，它必须是没有磁盘刷新的硬重启。

我发现 C 行 "outp(0x92,1);" 看起来很理想，但即使在管理员权限下它也会产生异常 "0xC0000096: Privileged Instruction" ，但它不起作用。

有任何想法吗？

提前致谢...

# java - 需要使用 java 从 xml 中提取特定标签及其值

> ID：14777464
> 
> 赞同：0
> 
> 时间：2013-02-08T16:53:02.523
> 
> 标签：java, xml-parsing

大家好我是Java的新手需要从xml中提取标签及其值

代码：

```
Document doc = loadXml("data.xml");  
NodeList nodeList = doc.getElementsByTagName("CreateResponse");  
for (int i = 0; i < nodeList.getLength(); i++) {  
    Node node = nodeList.item(i);  
    if (node.getNodeType() == Node.ELEMENT_NODE) {  
        Element element = (Element) node;  
        NodeList ROWList = element.getElementsByTagName("Row");  
        Element weekElement = (Element) RowList.item(0);  
        NodeList textElementList = weekElement.getChildNodes();
        System.out.println("Row:"+((Node)textElementList.item(0)).getNodeValue().trim());
} 
```

以下是我的输入

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<soap:Envelope xmlns:xsd="http://www.w3.org/2001/XMLSchema"          
               xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 
               xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <soap:Body>
    <CreateResponse xmlns="http://jerseytelecom.com/">
     <CreateResult> 
     <ISD_XMLGateway>
         <Entity>NGN_LPI</Entity> 
         <Params>
         <Param Name="ResponseCode" Value="0" /> 
      <Param Name="ResponseText" Value="OK" /> 
        <Param Name="Response" Value="NGN_LPI_Response">
        <NGN_LPI>
      <Response>
       <Table>
        <Row>
   <RouteRecordID>xxxxx</RouteRecordID> 
   <LineTypeID>xxxxxx</LineTypeID> 
   <RouteNodeElementID>xxxxxxx</RouteNodeElementID> 
   <RouteNodeElementPosition>xx</RouteNodeElementPosition> 
   <RouteNodeElementBlock /> 
   <RouteNodeID>xxxxxx</RouteNodeID> 
   <RouteNodeElementTypeCode>xxx</RouteNodeElementTypeCode> 
   <Circuit>xxxxxx</Circuit> 
   <Suffix>x</Suffix> 
   <SortOrder>x</SortOrder> 
   <RouteNodeElementTypeID>x</RouteNodeElementTypeID> 
   <RouteOrder>x</RouteOrder> 
   <NodeID>xxxxxxxxxxx xxx x</NodeID> 
   <ParentNodeTypeID>x</ParentNodeTypeID> 
   <StatusID>x</StatusID> 
   <RouteStatusID>x</RouteStatusID> 
   <ProcessorID /> 
   <ExchangeID>x</ExchangeID> 
   <SchemeID /> 
   <SchemeNumber /> 
   <RouteConditionID>x</RouteConditionID> 
   <Spare>xxxxx</Spare> 
   <DesignationID>x</DesignationID> 
   <Organisation /> 
   <AddressLine1>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</AddressLine1> 
   <AddressLine2>xxxxxxxxxxxxx</AddressLine2> 
   <AddressLine3>xxxxxxxxxxxx</AddressLine3> 
   <AddressLine4>xxxxxxxx</AddressLine4> 
   <AddressLine5>xxxxxx</AddressLine5> 
   <PostCode>xxxxxxx</PostCode> 
   <AddressID>xxxxxx</AddressID> 
   <CustomerID>xxxx</CustomerID> 
   <CustomerOrganisation /> 
   <Title>x</Title> 
   <Forename /> 
   <Surname /> 
   <CircuitID>xxxxxx</CircuitID> 
   <CableID /> 
   <CableIDIn>x</CableIDIn> 
   <DASS>xxxxx</DASS> 
   <RouteTypeID>x</RouteTypeID> 
   <ChildNodeID>xxxxxxx</ChildNodeID> 
   <ChildExchangeID>x</ChildExchangeID> 
   <ChildRouteNodeElementTypeID>x</ChildRouteNodeElementTypeID> 
   <ChildNodeTypeID>xx</ChildNodeTypeID> 
   <CAMIVPositionID>xxxxxx</CAMIVPositionID> 
   <MDFSuiteID>x</MDFSuiteID> 
   <MDFModuleID>x</MDFModuleID> 
   <ModuleNumber>x</ModuleNumber> 
   <Shelf>x</Shelf> 
   <Slot>x</Slot> 
   <Position>xx</Position> 
   <SuiteName /> 
   <TiePairID>x</TiePairID> 
   <LCT>x</LCT> 
   <ConnectionStatusID>x</ConnectionStatusID> 
   <CeaseDate>dd/mm/yyyy hh:mi:ss</CeaseDate> 
   <FaultTypeID>x</FaultTypeID> 
   <CAMIVPositionIDOut>x</CAMIVPositionIDOut> 
   <MDFSuiteIDOut /> 
   <MDFModuleIDOut /> 
   <ModuleNumberOut /> 
   <ShelfOut /> 
   <SlotOut /> 
   <PositionOut /> 
   <SuiteNameOut /> 
   <CableNodeIDOut /> 
   <LoopResistanceOut /> 
   <DBLossOut /> 
   <PairCountOut /> 
   <FaultyPairCountOut /> 
   <CurrentPairUsageOut /> 
   <CableNodeIDIn /> 
   <LoopResistanceIn /> 
   <DBLossIn /> 
   <PairCountIn /> 
   <FaultyPairCountIn /> 
   <CurrentPairUsageIn /> 
   <HouseNumber /> 
   <WorkflowPending>xxxxx</WorkflowPending> 
   <OrderNumber>xxxxxxx</OrderNumber> 
   <EquipmentTypeID>xxxx</EquipmentTypeID> 
   <StrowgerVertIn>x</StrowgerVertIn> 
   <StrowgerVertOut /> 
   <JobListID>x</JobListID> 
   <ShortCircuit>xxxxxx</ShortCircuit> 
   <CablePair>x</CablePair> 
   <FibreModule>x</FibreModule> 
   <FibreShelf>x</FibreShelf> 
   <SchemeStatusID /> 
   <ABSDSB>xx</ABSDSB> 
   <RequiredDate>dd/mm/yyyy hh:mi:ss</RequiredDate> 
   <ParentExchangeID>x</ParentExchangeID> 
   <ElementExchangeID>x</ElementExchangeID> 
  </Row>
  <Row>
   <RouteRecordID>xxxxx</RouteRecordID> 
   <LineTypeID>xxxxxx</LineTypeID> 
   <RouteNodeElementID>xxxxxxx</RouteNodeElementID> 
   <RouteNodeElementPosition>xxx</RouteNodeElementPosition> 
   <RouteNodeElementBlock>x</RouteNodeElementBlock> 
   <RouteNodeID>xxxxxx</RouteNodeID> 
   <RouteNodeElementTypeCode>xxx</RouteNodeElementTypeCode> 
   <Circuit>xxxxxx</Circuit> 
   <Suffix>x</Suffix> 
   <SortOrder>x</SortOrder> 
   <RouteNodeElementTypeID>x</RouteNodeElementTypeID> 
   <RouteOrder>x</RouteOrder> 
   <NodeID>xxxxxxx</NodeID> 
   <ParentNodeTypeID>x</ParentNodeTypeID> 
   <StatusID>x</StatusID> 
   <RouteStatusID>x</RouteStatusID> 
   <ProcessorID /> 
   <ExchangeID>x</ExchangeID> 
   <SchemeID /> 
   <SchemeNumber /> 
   <RouteConditionID>x</RouteConditionID> 
   <Spare>xxxxx</Spare> 
   <DesignationID>x</DesignationID> 
   <Organisation /> 
   <AddressLine1>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</AddressLine1> 
   <AddressLine2>xxxxxxxxxxxxxxxxx</AddressLine2> 
   <AddressLine3>xxxxxxxxxxxxxxxx</AddressLine3> 
   <AddressLine4>xxxxxxxxxx</AddressLine4> 
   <AddressLine5>xxxxxx</AddressLine5> 
   <PostCode>xxxxxxx</PostCode> 
   <AddressID>xxxxxx</AddressID> 
   <CustomerID>xxxx</CustomerID> 
   <CustomerOrganisation /> 
   <Title>x</Title> 
   <Forename /> 
   <Surname /> 
   <CircuitID>xxxxxx</CircuitID> 
   <CableID>xxxxxx</CableID> 
   <CableIDIn>x</CableIDIn> 
   <DASS>xxxxx</DASS> 
   <RouteTypeID>x</RouteTypeID> 
   <ChildNodeID /> 
   <ChildExchangeID>x</ChildExchangeID> 
   <ChildRouteNodeElementTypeID>x</ChildRouteNodeElementTypeID> 
   <ChildNodeTypeID>x</ChildNodeTypeID> 
   <CAMIVPositionID>x</CAMIVPositionID> 
   <MDFSuiteID /> 
   <MDFModuleID /> 
   <ModuleNumber /> 
   <Shelf /> 
   <Slot /> 
   <Position /> 
   <SuiteName /> 
   <TiePairID>x</TiePairID> 
   <LCT>x</LCT> 
   <ConnectionStatusID>x</ConnectionStatusID> 
   <CeaseDate>dd/mm/yyyy hh:mi:ss</CeaseDate> 
   <FaultTypeID>x</FaultTypeID> 
   <CAMIVPositionIDOut>x</CAMIVPositionIDOut> 
   <MDFSuiteIDOut /> 
   <MDFModuleIDOut /> 
   <ModuleNumberOut /> 
   <ShelfOut /> 
   <SlotOut /> 
   <PositionOut /> 
   <SuiteNameOut /> 
   <CableNodeIDOut>xxxxx</CableNodeIDOut> 
   <LoopResistanceOut>xxxxxxxxxxxxxxx</LoopResistanceOut> 
   <DBLossOut>xxxxxxxxxxxxxxxxxxxx</DBLossOut> 
   <PairCountOut>xxx</PairCountOut> 
   <FaultyPairCountOut>x</FaultyPairCountOut> 
   <CurrentPairUsageOut>xxx</CurrentPairUsageOut> 
   <CableNodeIDIn /> 
   <LoopResistanceIn /> 
   <DBLossIn /> 
   <PairCountIn /> 
   <FaultyPairCountIn /> 
   <CurrentPairUsageIn /> 
   <HouseNumber /> 
   <WorkflowPending>xxxxx</WorkflowPending> 
   <OrderNumber>xxxxxxx</OrderNumber> 
   <EquipmentTypeID>x</EquipmentTypeID> 
   <StrowgerVertIn /> 
   <StrowgerVertOut /> 
   <JobListID>x</JobListID> 
   <ShortCircuit>xxxxxx</ShortCircuit> 
   <CablePair>x</CablePair> 
   <FibreModule>x</FibreModule> 
   <FibreShelf>x</FibreShelf> 
   <SchemeStatusID /> 
   <ABSDSB>x</ABSDSB> 
   <RequiredDate>dd/mm/yyyy hh:mi:ss</RequiredDate> 
   <ParentExchangeID>x</ParentExchangeID> 
   <ElementExchangeID>x</ElementExchangeID> 
  </Row>
  <Row>
   <RouteRecordID>xxxxx</RouteRecordID> 
   <LineTypeID>xxxxxx</LineTypeID> 
   <RouteNodeElementID>xxxxxxx</RouteNodeElementID> 
   <RouteNodeElementPosition>xxx</RouteNodeElementPosition> 
   <RouteNodeElementBlock>x</RouteNodeElementBlock> 
   <RouteNodeID>xxxxxx</RouteNodeID> 
   <RouteNodeElementTypeCode>xxxxx</RouteNodeElementTypeCode> 
   <Circuit>xxxxxx</Circuit> 
   <Suffix>x</Suffix> 
   <SortOrder>x</SortOrder> 
   <RouteNodeElementTypeID>xx</RouteNodeElementTypeID> 
   <RouteOrder>x</RouteOrder> 
   <NodeID>xxxxxxxx</NodeID> 
   <ParentNodeTypeID>xx</ParentNodeTypeID> 
   <StatusID>x</StatusID> 
   <RouteStatusID>x</RouteStatusID> 
   <ProcessorID /> 
   <ExchangeID>x</ExchangeID> 
   <SchemeID /> 
   <SchemeNumber /> 
   <RouteConditionID>x</RouteConditionID> 
   <Spare>xxxxx</Spare> 
   <DesignationID>x</DesignationID> 
   <Organisation /> 
   <AddressLine1>xxxxxxxxxxxxxxxxxxxxxxxxxxxx</AddressLine1> 
   <AddressLine2>xxxxxxxxxxxxxxxx</AddressLine2> 
   <AddressLine3>xxxxxxxxxxxxxxx</AddressLine3> 
   <AddressLine4>xxxxxxxxxx</AddressLine4> 
   <AddressLine5>xxxxxx</AddressLine5> 
   <PostCode>xxxxxxx</PostCode> 
   <AddressID>xxxxxx</AddressID> 
   <CustomerID>xxxx</CustomerID> 
   <CustomerOrganisation /> 
   <Title>x</Title> 
   <Forename /> 
   <Surname /> 
   <CircuitID>xxxxxx</CircuitID> 
   <CableID>xxxxxx</CableID> 
   <CableIDIn>xxxxxx</CableIDIn> 
   <DASS>xxxxx</DASS> 
   <RouteTypeID>x</RouteTypeID> 
   <ChildNodeID>xxxxxxx</ChildNodeID> 
   <ChildExchangeID>x</ChildExchangeID> 
   <ChildRouteNodeElementTypeID>x</ChildRouteNodeElementTypeID> 
   <ChildNodeTypeID>x</ChildNodeTypeID> 
   <CAMIVPositionID>x</CAMIVPositionID> 
   <MDFSuiteID /> 
   <MDFModuleID /> 
   <ModuleNumber /> 
   <Shelf /> 
   <Slot /> 
   <Position /> 
   <SuiteName /> 
   <TiePairID>x</TiePairID> 
   <LCT>x</LCT> 
   <ConnectionStatusID>x</ConnectionStatusID> 
   <CeaseDate>dd/mm/yyyy hh:mi:ss</CeaseDate> 
   <FaultTypeID>x</FaultTypeID> 
   <CAMIVPositionIDOut>x</CAMIVPositionIDOut> 
   <MDFSuiteIDOut /> 
   <MDFModuleIDOut /> 
   <ModuleNumberOut /> 
   <ShelfOut /> 
   <SlotOut /> 
   <PositionOut /> 
   <SuiteNameOut /> 
   <CableNodeIDOut>xxxxx</CableNodeIDOut> 
   <LoopResistanceOut>xxxxxxxxxxxxxxxxxx</LoopResistanceOut> 
   <DBLossOut>xxxxxxxxxxxxxxxxxxxxx</DBLossOut> 
   <PairCountOut>xxx</PairCountOut> 
   <FaultyPairCountOut>x</FaultyPairCountOut> 
   <CurrentPairUsageOut>xxx</CurrentPairUsageOut> 
   <CableNodeIDIn>xxxxx</CableNodeIDIn> 
   <LoopResistanceIn>xxxxxxxxxxxxxxxxxxx</LoopResistanceIn> 
   <DBLossIn>xxxxxxxxxxxxxxxxxxxxx</DBLossIn> 
   <PairCountIn>xxx</PairCountIn> 
   <FaultyPairCountIn>x</FaultyPairCountIn> 
   <CurrentPairUsageIn>xxx</CurrentPairUsageIn> 
   <HouseNumber /> 
   <WorkflowPending>xxxxx</WorkflowPending> 
   <OrderNumber>xxxxxxx</OrderNumber> 
   <EquipmentTypeID>x</EquipmentTypeID> 
   <StrowgerVertIn /> 
   <StrowgerVertOut /> 
   <JobListID>x</JobListID> 
   <ShortCircuit>xxxxxx</ShortCircuit> 
   <CablePair>x</CablePair> 
   <FibreModule>x</FibreModule> 
   <FibreShelf>x</FibreShelf> 
   <SchemeStatusID /> 
   <ABSDSB>x</ABSDSB> 
   <RequiredDate>dd/mm/yyyy hh:mi:ss</RequiredDate> 
   <ParentExchangeID>x</ParentExchangeID> 
   <ElementExchangeID>x</ElementExchangeID> 
  </Row>
  <Row>
   <RouteRecordID>xxxxx</RouteRecordID> 
   <LineTypeID>xxxxx</LineTypeID> 
   <RouteNodeElementID>xxxxxxx</RouteNodeElementID> 
   <RouteNodeElementPosition>xxx</RouteNodeElementPosition> 
   <RouteNodeElementBlock /> 
   <RouteNodeID>xxxxxx</RouteNodeID> 
   <RouteNodeElementTypeCode>xx</RouteNodeElementTypeCode> 
   <Circuit>xxxxxx</Circuit> 
   <Suffix>x</Suffix> 
   <SortOrder>x</SortOrder> 
   <RouteNodeElementTypeID>x</RouteNodeElementTypeID> 
   <RouteOrder>x</RouteOrder> 
   <NodeID>xxxx</NodeID> 
   <ParentNodeTypeID>x</ParentNodeTypeID> 
   <StatusID>x</StatusID> 
   <RouteStatusID>x</RouteStatusID> 
   <ProcessorID /> 
   <ExchangeID>x</ExchangeID> 
   <SchemeID /> 
   <SchemeNumber /> 
   <RouteConditionID>x</RouteConditionID> 
   <Spare>xxxxx</Spare> 
   <DesignationID>x</DesignationID> 
   <Organisation /> 
   <AddressLine1>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</AddressLine1> 
   <AddressLine2>xxxxxxxxxxxxxxxxx</AddressLine2> 
   <AddressLine3>xxxxxxxxxxxxxxx</AddressLine3> 
   <AddressLine4>xxxxxx</AddressLine4> 
   <AddressLine5>xxxxxx</AddressLine5> 
   <PostCode>xxxxxxx</PostCode> 
   <AddressID>xxxxxx</AddressID> 
   <CustomerID>xxxx</CustomerID> 
   <CustomerOrganisation /> 
   <Title>x</Title> 
   <Forename /> 
   <Surname /> 
   <CircuitID>xxxxxx</CircuitID> 
   <CableID /> 
   <CableIDIn>xxxxxx</CableIDIn> 
   <DASS>xxxxx</DASS> 
   <RouteTypeID>x</RouteTypeID> 
   <ChildNodeID /> 
   <ChildExchangeID>x</ChildExchangeID> 
   <ChildRouteNodeElementTypeID>x</ChildRouteNodeElementTypeID> 
   <ChildNodeTypeID>x</ChildNodeTypeID> 
   <CAMIVPositionID>x</CAMIVPositionID> 
   <MDFSuiteID /> 
   <MDFModuleID /> 
   <ModuleNumber /> 
   <Shelf /> 
   <Slot /> 
   <Position /> 
   <SuiteName /> 
   <TiePairID>x</TiePairID> 
   <LCT>x</LCT> 
   <ConnectionStatusID>x</ConnectionStatusID> 
   <CeaseDate>dd/mm/yyyy hh:mi:ss</CeaseDate> 
   <FaultTypeID>x</FaultTypeID> 
   <CAMIVPositionIDOut>x</CAMIVPositionIDOut> 
   <MDFSuiteIDOut /> 
   <MDFModuleIDOut /> 
   <ModuleNumberOut /> 
   <ShelfOut /> 
   <SlotOut /> 
   <PositionOut /> 
   <SuiteNameOut /> 
   <CableNodeIDOut /> 
   <LoopResistanceOut /> 
   <DBLossOut /> 
   <PairCountOut /> 
   <FaultyPairCountOut /> 
   <CurrentPairUsageOut /> 
   <CableNodeIDIn>xxxxx</CableNodeIDIn> 
   <LoopResistanceIn>xxxxxxxxxxxxxxxxxxxx</LoopResistanceIn> 
   <DBLossIn>xxxxxxxxxxxxxxxxx</DBLossIn> 
   <PairCountIn>xxx</PairCountIn> 
   <FaultyPairCountIn>x</FaultyPairCountIn> 
   <CurrentPairUsageIn>xxx</CurrentPairUsageIn> 
   <HouseNumber /> 
   <WorkflowPending>xxxxx</WorkflowPending> 
   <OrderNumber>xxxxxxx</OrderNumber> 
   <EquipmentTypeID>x</EquipmentTypeID> 
   <StrowgerVertIn /> 
   <StrowgerVertOut /> 
   <JobListID>x</JobListID> 
   <ShortCircuit>xxxxxx</ShortCircuit> 
   <CablePair>x</CablePair> 
   <FibreModule>x</FibreModule> 
   <FibreShelf>x</FibreShelf> 
   <SchemeStatusID /> 
   <ABSDSB>x</ABSDSB> 
   <RequiredDate>dd/mm/yyyy hh:mi:ss</RequiredDate> 
   <ParentExchangeID>x</ParentExchangeID> 
   <ElementExchangeID>x</ElementExchangeID> 
    </Row>
     </Table>
       </Response>
      <ResponseCode>0</ResponseCode> 
      <ResponseText>Ok</ResponseText> 
    </NGN_LPI>
     </Param>
    </Params>
    </ISD_XMLGateway>
   </CreateResult> 
        </CreateResponse>
        </soap:Body>
        </soap:Envelope>. 
```

我需要使用所需的标签及其值示例提取 xml

```
 <Slot>XXXXX</Slot><Shelf>yyyy</Shelf> 
```

我尝试使用其中一个 frnds 建议的以下代码，但它没有达到我的目的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T18:15:34.563

尝试使用 XPath：

```
XPathExpression expr = xpath.compile("//*[self::Slot or self::Shelf]");
NodeList nodeList = (NodeList) expr.evaluate(doc, XPathConstants.NODESET);
for (int i=0; i<nodeList.getLength(); i++) {
  Node node = nodeList.item(i);
  node.getLocalName(); // The element name, e.g. "Slot"
  node.getTextContent(); // The element text content, e.g. "XXXXX"
  // ...
} 
```

# vb.net - 在 VB.Net 中更改 IP 地址

> ID：14777466
> 
> 赞同：1
> 
> 时间：2013-02-08T16:53:07.433
> 
> 标签：vb.net, ip, wmi, ip-address

我正在 VB.Net 中编写一个 Windows 窗体应用程序，它将（除其他外）更改 IP 地址、默认网关、子网掩码，并将 IP 地址设置为仅在 Windows 7 的图像上的静态。未使用 Sysprep。我搜索了谷歌，只找到了 2 个选项。我不相信第一个解决方案对我有用，因为我不一定知道连接的名称。它使用 netsh 更改 IP 设置。我打算给出这个例子的链接，但我不能发布超过 2 个链接......

第二个解决方案显示在[此链接（VB.Net 版本）](http://social.msdn.microsoft.com/Forums/en/vbgeneral/thread/3ca76e36-a737-4486-835d-874f71b22dc5)，原始代码在[这里（C# 版本）](http://www.codeproject.com/Articles/5697/Configuring-TCP-IP-Settings-using-WMI-and-C)。这个解决方案使用了我真的不太了解的 WMI。

当我调试代码并查看代码似乎正确执行的所有内容时，IP 地址仍设置为 DHCP，所有其他设置仍然相同。所以，基本上，什么给了？为什么这段代码似乎不起作用？

这是我的代码。我只做了一些改动：

```
 'Changed the 3 IPs below
    Dim IPAddress As String = "192.168.1.105"
    Dim SubnetMask As String = "255.255.252.0"
    Dim Gateway As String = "192.168.1.100"

    Dim objMC As ManagementClass = New ManagementClass("Win32_NetworkAdapterConfiguration")
    Dim objMOC As ManagementObjectCollection = objMC.GetInstances()

    For Each objMO As ManagementObject In objMOC
        If (Not CBool(objMO("IPEnabled"))) Then
            Continue For
        End If

        Try
            Dim objNewIP As ManagementBaseObject = Nothing
            Dim objSetIP As ManagementBaseObject = Nothing
            Dim objNewGate As ManagementBaseObject = Nothing

            objNewIP = objMO.GetMethodParameters("EnableStatic")
            objNewGate = objMO.GetMethodParameters("SetGateways")

            'Set DefaultGateway
            objNewGate("DefaultIPGateway") = New String() {Gateway}
            objNewGate("GatewayCostMetric") = New Integer() {1}

            'Set IPAddress and Subnet Mask
            objNewIP("IPAddress") = New String() {IPAddress}
            objNewIP("SubnetMask") = New String() {SubnetMask}

            objSetIP = objMO.InvokeMethod("EnableStatic", objNewIP, Nothing)
            objSetIP = objMO.InvokeMethod("SetGateways", objNewGate, Nothing)

            'Changed this line so I could see if it was executing all of the way
            MessageBox.Show("Updated IPAddress, SubnetMask and Default Gateway!")

        Catch ex As Exception
            MessageBox.Show("Unable to Set IP : " & ex.Message)
        End Try
    Next objMO 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T04:51:51.060

我可以回答我自己的问题。我在淋浴时想到了它（多么陈词滥调？）。因为这是 Windows 7，所以我只需要右键单击并以管理员身份运行程序。

# cloudbees - 多个应用程序和实例的数据库数据源绑定

> ID：14777467
> 
> 赞同：0
> 
> 时间：2013-02-08T16:53:09.263
> 
> 标签：cloudbees

我们为 2 个应用程序使用单个 mysql 数据库。此应用程序之一有 2 个实例。

所以我们想知道 cloudbees 如何管理所有这些应用程序之间的连接池。我在其他线程中看到 cloudbees 上的 mysql 默认配置接受 20 个连接。目前，我们使用带有显式 c3p0 的“旧”休眠配置，但我们认为他们可能会尝试在数据库上打开太多连接。

如果我们将 conf 更改为使用 jndi cloudbees 数据源（如此处所述[https://developer.cloudbees.com/bin/view/RUN/DatabaseGuide](https://developer.cloudbees.com/bin/view/RUN/DatabaseGuide)），我们的应用程序是否应该共享相同的连接池？或者至少每个应用程序的所有实例？

希望可以理解。如果没有，请告诉我。

谢谢你的帮助，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T01:55:03.477

应用程序的每个实例都有自己的连接池 - 因此您需要在调整池大小时考虑到这一点。

# android - 我如何从纬度和经度中获取地址位置

> ID：14777470
> 
> 赞同：0
> 
> 时间：2013-02-08T16:53:20.583
> 
> 标签：android, android-location

我已经有了纬度和经度，我得到了几乎所有的位置，但邮政编码始终为空，地址给出了我想要的街道名称和号码。好吧，这是我的代码...感谢您的帮助..

```
Geocoder geocoder;
          List<Address> addresses;
          geocoder = new Geocoder(this, Locale.getDefault());
          try {
            addresses = geocoder.getFromLocation(lat, lng, 1);
            Address ad = addresses.get(0);
               address = ad.getAddressLine(0);
               country = ad.getCountryName();
               postalcode = addresses.get(0).getPostalCode();
               city = ad.getLocality();
               state = ad.getAdminArea(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:24:32.880

是的，如果地理编码器地址没有特定字段的值，则为字段返回 null。就像您收到的邮政编码为空一样。在使用地理编码器地址列表中的字段值之前，请始终进行空检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:18:07.060

您正在尝试执行的操作称为反向地理编码，您需要使用 3rd 方服务才能执行此操作。[在这里](http://www.geonames.org/export/reverse-geocoding.html)查看这些链接。

其中一些服务比其他服务产生更好的结果，但您不能依赖它们。如果你得到一个结果（或者你有一个部分结果），那就太好了。但是希望您可能根本无法得到任何回报。

# symfony - Sonata User Bundle - 重定向循环

> ID：14777472
> 
> 赞同：1
> 
> 时间：2013-02-08T16:53:32.947
> 
> 标签：symfony, fosuserbundle, sonata-admin, sonata-user-bundle

我已经安装了 FOSUserBundle 和 Sonata Admin 包

第一个 FOSUserBundle 完美运行，包括配置文件、登录和注销。现在有了 Sonata Admin bundle，我可以对我的实体进行 CRUD。

现在我希望它们与登录到我的后端集成。

现在，当我转到 /admin/dashboard 时，它会重定向到 /admin/login，然后是无限重定向循环。

我已经正确地搞砸了安全性，我真的不太了解它。

安全性.yml：[https ://gist.github.com/lsv/4740268](https://gist.github.com/lsv/4740268)

路由.yml：[https ://gist.github.com/lsv/4740284](https://gist.github.com/lsv/4740284)

config.yml：[https ://gist.github.com/lsv/4740291](https://gist.github.com/lsv/4740291)

[开发日志： https](https://gist.github.com/lsv/4740301) ://gist.github.com/lsv/4740301

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T19:02:01.940

添加

```
- { path: ^/admin/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }
- { path: ^/admin/logout$, role: IS_AUTHENTICATED_ANONYMOUSLY }
- { path: ^/admin/login-check$, role: IS_AUTHENTICATED_ANONYMOUSLY } 
```

到 security.yml

# magento - magento 在类别中显示错误的产品数量

> ID：14777478
> 
> 赞同：10
> 
> 时间：2013-02-08T16:53:46.483
> 
> 标签：magento, magento-1.7

我有一个奇怪的问题，似乎很多人在互联网上都有同样的问题。下图将定义我的问题，而且我的 magento 版本是 1.7

![在此处输入图像描述](../Images/dff7a0b446ca6f8a466533b0d9c634c6.png)

正如我所强调的，LEFT 表示该类别有 16 个产品，但实际上“类别产品”选项卡显示 15 个产品。我所有的类别都搞砸了。请让我知道出了什么问题。我试过禁用缓存，但没有奏效。

[编辑]

我尝试从类别中删除一个产品，然后左侧的数字变为 15，总记录 14。所以我认为可能是该类别中禁用的产品。但是当我搜索禁用产品时，没有。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-05-22T01:51:52.070

这将解决所有问题。

```
DELETE FROM 
catalog_category_product 
where product_id NOT IN (SELECT entity_id FROM (catalog_product_entity)) 
```

然后，在观察者中实施解决方案，以防止它再次发生。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-03T20:00:58.573

嗨产品计数来自位于位置的方法名称 loadProductCount`code/core/Mage/Catalog/Model/Resource/Category/Collection.php`

如果你要深入挖掘，这个计数来自两个表之间的连接查询：`catalog_category_product`和`catalog_category_entity`

我已经通过使用事件观察器解决了这个问题。你可以暂时做同样的事情。如果您找到更好的解决方案，请告诉我。

```
public function deleteCountCategory (Varien_Event_Observer $observer) {
    try {
    $product = $observer->getEvent()->getProduct();
    $productId = $product->getId();                     
    $resource = Mage::getSingleton('core/resource');    
    $writeConnection = $resource->getConnection('core_write');
    $tableName = $resource->getTableName('catalog_category_product');
    $query = "DELETE FROM {$tableName} WHERE product_id = ".(int)$productId;            
    $writeConnection->query($query);            
    } catch (Exception $e) {
        throw $e;                   
    }
    return $this;           
} 
```

config.xml 中使用的事件

```
<events>
<catalog_product_delete_after> <!-- identifier of the event we want to catch -->
<observers>
<catalog_product_delete_after_handler> <!-- identifier of the event handler -->
<type>model</type> <!-- class method call type; valid are model, object and singleton -->
<class>countfix/observer</class> <!-- observers class alias -->
<method>deleteCountCategory</method>  <!-- observer's method to be called -->
<args></args> <!-- additional arguments passed to observer -->
</catalog_product_delete_after_handler>
</observers>
</catalog_product_delete_after>
</events> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-26T06:58:30.453

一个简单的解决方案是去 app/code/core/Mage/Catalog/Model/Category.php

或者最好创建一个本地文件，这样它在magento升级时不会影响。所以创建 app/code/local/Mage/Catalog/Model/Category.php

在这个模型中创建一个新函数 getFrontentProductCount()

```
 public function getFrontentProductCount()
{
    $collection = Mage::getResourceModel('catalog/product_collection')
        ->addCategoryFilter($this);
Mage::getSingleton('catalog/product_status')->addVisibleFilterToCollection($collection);
Mage::getSingleton('catalog/product_visibility')->addVisibleInCatalogFilterToCollection($collection);
return $collection->count(); 
```

}

现在转到执行类别产品计数的模板 phtml 文件。在一般情况下，它是：主题/模板/目录/导航/left.phtml

现在根据需要调用上述函数，如：

```
 <ol>
            <?php foreach ($_categories as $_category): ?>
                <?php if($_category->getIsActive()): ?>
                <li>
                    <a href="<?php echo $this->getCategoryUrl($_category) ?>"<?php if ($this->isCategoryActive($_category)): ?> class="current"<?php endif; ?>><?php echo $this->htmlEscape($_category->getName()) ?></a> (<?php echo $_category->getFrontentProductCount() ?>)
                </li>
                <?php endif; ?>
            <?php endforeach ?>
            </ol> 
```

# java - 在 Applet 中使用 Files.walkFileTree

> ID：14777479
> 
> 赞同：0
> 
> 时间：2013-02-08T16:53:46.453
> 
> 标签：java, security, applet, accesscontrolexception

我正在开发从一个特定文件夹（我们称之为“数据文件夹”）读取数据文件的小程序。文件的数量和它们的名称会随着时间而改变，所以我不想将它们硬性地添加到代码中。我希望能够列出存储在该文件夹中的所有文件（注意：文件夹与小程序存储在同一台服务器上）。我尝试使用 Files.walkFileTree 方法来做到这一点。当我在 Eclipse 中运行它时它工作得很好，但我得到了 AccessControlException：

```
java.security.AccessControlException: access denied ("java.io.FilePermission" "Data folder" "read") 
```

当我尝试在浏览器中运行时。

我可以看到为什么 jvm 会限制小程序列出本地计算机上的文件，但是否可以列出存储在服务器上的文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:05:38.740

您必须区分客户端和服务器端代码。您的小程序在客户端执行，因此无法直接使用`Files.walkFileTree()`. 您可以做的是实现一个服务（如 REST 服务或简单的 servlet）并在 Tomcat 或 Jetty servlet 容器中的服务器端运行它，然后从您的小程序调用此服务。但要小心确保您的服务安全，以免每个人都看到您服务器的整个文件系统。

# asp.net-mvc - EF Code first - context.Add() is not creating new row

> ID：14777483
> 
> 赞同：0
> 
> 时间：2013-02-08T16:53:49.730
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework

I have this:

```
var status = new OutTransStatus();
status.StartDate = startDate;
status.TransCount = transactions.Count;
try
{
   context.OutTransStatus.Add(status);
}
catch (Exception)
{
   return 2;
} 
```

Now, when i try to add `status`, it goes by, no exception, no nothing, and the row is not applied to the database! What is going on? How can i debug this?

*Edit: Obviously, somewhere above i have using (var context = new Database())*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T16:54:48.620

You forgot to save changes:

`context.SaveChanges()`

# css - 将图像与打印中的文本交换

> ID：14777485
> 
> 赞同：1
> 
> 时间：2013-02-08T16:53:57.787
> 
> 标签：css, css-sprites

我使用精灵在页面上插入图像。

```
<div class="sprites logo1"></div>
<div class="sprites logo2"></div> 
```

但是，当我打印页面时，除非我的设置更改为打印背景图像，否则不会打印任何内容。

我想打印文本而不是徽标。通常我可以将图像放在 div 中并将其隐藏`@media screen`并显示，`@media print`但我不确定如何处理精灵。

打印的期望结果将类似于：

```
<div>logo1</div>
<div>logo2</div> 
```

我的精灵 CSS 看起来像这样：

```
.sprites{
   background: url(../logos.png) no-repeat top left
}
.logo1{
   background-position: 0 0;
   width: 184px;
   height: 57px
}
.logo2{
   background-position: 0 -60px;
   width: 175px;
   height: 34px
} 
```

所以我认为通过添加这个我可能会做对：

```
@media print {
   .logo1{ 
      content: url(../logos.png) no-repeat 0 0;
      width: 184px;
      height: 57px
   }
} 
```

这个解决方案的问题在于，它显示了一个完整的 sprite 图像，压缩到了 logo 的尺寸。到目前为止，似乎唯一的解决方案是剪掉徽标并为印刷版使用单独的徽标，这很可惜。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:19:02.770

试试这个：

将您的代码更改为以下内容：

```
<div class="sprites logo1"><h1>Logo 1 Text</h1></div>
<div class="sprites logo2"><h2>Logo 2 Text</h1></div> 
```

然后在您的印刷媒体 CSS 中：

```
.sprites .logo1 { background-color:white !important ; background-image:none !important }
.sprites .logo2 { background-color:white !important ; background-image:none !important } 
```

在你的屏幕 CSS 中：

```
.sprites .logo1 h1 { display:none !important }
.sprites .logo2 h2 { display:none !important } 
```

这样在屏幕上，文本是隐藏的，在打印时，文本是可见的，而精灵图像是隐藏的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:36:59.833

[您也可以使用Zeldman 命名](http://www.zeldman.com/2012/03/01/replacing-the-9999px-hack-new-image-replacement/)的 Kellum 方法，沿着这些思路做一些事情：

HTML：

```
<div class="sprites logo1">Text Here</div>
<div class="sprites logo2">Text Here</div> 
```

CSS：

```
@media screen {
  .sprites {
    background: url(../logos.png) no-repeat top left
    text-indent: 100%;
    white-space: nowrap;
    overflow: hidden;
  }
  .logo1{
    background-position: 0 0;
    width: 184px;
    height: 57px
  }
  .logo2{
    background-position: 0 -60px;
    width: 175px;
    height: 34px
  }
}

@media print {
  .sprites {
    /* style this text as desired for print */
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T18:07:06.883

将所需的打印文本添加到 HTML，如下所示：

```
<div class="sprites logo1">Logo 1</div> 
```

然后，在您的屏幕 CSS 中，添加一个否定的`text-indent`，这将在屏幕上查看文本时有效地隐藏文本。

```
.logo1 {
  text-indent: -9999px; 
} 
```

在您的打印 CSS 中，将 重置`text-indent`为 0 以显示它。

```
.logo1 {
    text-indent: 0;
} 
```

# c++ - 多处理 = 多个进程正在运行？

> ID：14777488
> 
> 赞同：2
> 
> 时间：2013-02-08T16:54:24.717
> 
> 标签：c++, python, windows, parallel-processing, multiprocessing

我对多处理有些困惑。我是一名 3 年的 Python 程序员，但从未真正需要并行执行任务（不仅仅是异步）。但是我知道，或者想知道的是，当`multiprocessing`在 Python 中使用模块来实现“真正的并行性”时，`python.exe`会产生新的进程！

[例如，像Cinema 4D](http://www.maxon.net/de/home.html)这样的 3D 软件使用所有可用 CPU 的能力来渲染 3D 场景。但是我`Cinema 4D.exe`在任务管理器中看不到多个进程。

1.  我对上面的陈述是否正确，即在使用`multiprocessing`模块时会产生多个 Python 进程？
2.  如果是这样，为什么会这样，C++ 应用程序如何在没有多个进程的情况下使用所有 CPU？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T17:02:00.517

也可以通过在同一进程中运行多个线程来使用多个 CPU。这不是 Python`multiprocessing`模块所做的。

Python中有一个`threading`模块。不幸的是，在 CPython 中，线程并没有你想象的那么有用，因为它们都在争夺所谓的“全局解释器锁”。因此，它们在 Python 中的并行性比在许多其他语言中要少得多。如果您使用线程，您需要担心代码中的哪些操作真正是并行的。如果您使用您不使用的流程（尽管您可能会担心其他事情，例如共享数据）。

我不知道 Python 的替代实现是否与 GIL 有相同的问题。但是除非您专门为 Jython/IronPython/其他东西编写代码，否则 CPython 的限制适用于您的程序......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:00:37.650

> 我对上面的陈述是否正确，即在使用多处理模块时会产生多个 Python 进程？

对，那是正确的。Python 需要产生新的进程（运行额外的解释器）来并行运行。这是因为 GIL( [GlobalInterpreterLock](http://wiki.python.org/moin/GlobalInterpreterLock) ) 每个解释器只允许一个执行线程。

> 如果是这样，为什么会这样，C++ 应用程序如何在没有多个进程的情况下使用所有 CPU？

好吧，大概在 Cinema4D 中没有像 GIL 这样的东西——因此它可以并行执行多个线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T17:02:11.800

通常，您会运行多个线程，而不是多个进程。运行线程而不是进程有很多优点。主要优点是属于进程的所有内存都在线程之间共享，您必须设置某种内存共享协议来在不同进程之间共享（部分）数据。

Python 和 C++ 都支持多线程，但正如其他地方所提到的，python 代码不能在多个处理器上运行。然而，它对于在“半并行”中执行操作很有用（我使用 python 线程读取文件并在声卡上播放它，同时记录和保存另一个文件，同时在串行端口来控制“被测”设备）。

Python 模块`multiprocessing`确实用于使用多个单独的进程，这有助于“打破 Python 解释器锁定”。

一般来说，如果您希望代码完全独立于系统中运行的其他任务，并且不必在进程之间共享 [太多] 数据 - 例如计算非常大的素数，则在单独的进程中运行会更有用在一个独立的进程中做这件事会是一件好事[我的意思是那些有几十万或更多数字的进程] - 该进程在几个小时和几个小时内没有其他输入的情况下自行运行，并且只需要少量不变的输入——“质数候选”。

# matlab - 无法将 tif 文件导入 matlab

> ID：14777495
> 
> 赞同：0
> 
> 时间：2013-02-08T16:54:52.753
> 
> 标签：matlab, image-processing, image-manipulation

我正在尝试`.tif`使用以下代码将图像导入 matlab

```
>> aa = imread('house.tif'); 
```

我得到了错误

```
Error using rtifc
TIFF library error: '_TIFFVSetField: C:\Users\user\Documents\MATLAB\house.tif: Null count
for "Tag 34022" (type 1, writecount -3, passcount 1).'.

Error in readtif (line 49)
[X, map, details] = rtifc(args);

Error in imread (line 434)
[X, map] = feval(fmt_s.read, filename, extraArgs{:}); 
```

因为我一生中第一次使用 matlab，所以我真的不知道这个错误是什么意思。在这件事上需要帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T18:36:49.363

MATLAB R2012b 有一个错误，它无法正确读取 TIFF 文件。更多信息可以在这里找到：http: [//www.mathworks.com/matlabcentral/newsreader/view_thread/326232](http://www.mathworks.com/matlabcentral/newsreader/view_thread/326232)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:35:36.290

可能Matlab不支持特定类型的tif。在 Matlab 的辩护中，tif 不是一种易于阅读的文件格式。它支持大量的压缩方案、多个页面以及谁知道什么。我会将 tif 转换为 png 并使用它。

更新：快速的 Google 搜索显示“rtifc”是一个围绕 libtiff 的 Matlab mex 包装器。您的错误似乎来自 libtiff。如果后者无法读取它，那么您的 tif 可能也会对许多其他应用程序造成问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T18:40:45.067

您可以尝试的另一件事是使用`tiffread`EMBL 的 François Nedelec 小组的实现。[http://www.embl.de/ExternalInfo/nedelec/misc/matlab/tiffread29.m](http://www.embl.de/ExternalInfo/nedelec/misc/matlab/tiffread29.m)。它被全世界的生物学家大量使用。我已经使用它很多年了。

# sql-server - 为什么在 SELECT 子句中使用非索引字段时性能会下降？

> ID：14777499
> 
> 赞同：6
> 
> 时间：2013-02-08T16:55:03.237
> 
> 标签：sql-server

考虑以下三个查询：

```
select sampleno from sample
    where markupdate > '1/1/2010'

select sampleno, markupdate from sample
    where markupdate > '1/1/2010'

select sampleno, markuptime from sample
    where markupdate > '1/1/2010' 
```

`sampleno`并且`markupdate`是索引字段（`sampleno`是主键）

`markuptime`未编入索引

查询 1 和 2 运行大约需要 1 秒（返回 237K 行）。3 分钟后查询 3 仍在运行。

为什么在 SELECT 子句中包含非索引字段会导致性能下降？

这是一个 SQL 6.5 数据库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T16:59:23.307

表的数据（基本上：所有列）存储在**聚集索引**中。聚集索引是允许对索引列进行二分搜索的二叉树。它是特殊的（聚集的），因为它包含叶级别的所有其他列。通常，聚集索引也是主键。在你的情况下，它是：

```
(sampleno) include (markupdate, markuptime, ...) 
```

**非聚集索引**包含索引列和（在叶级别）聚集索引。当您使用非聚集索引时，数据库必须查找聚集索引中的所有其他列。该过程称为**查找**。在您的情况下，非聚集索引`(markupdate)`是：

```
(markupdate) include (sampleno) 
```

该索引包含查询的所有数据`markupdate, sampleno`。这种指数的技术术语是**覆盖指数**。但是当你添加`markuptime`到查询中时，索引不再覆盖。`markuptime`它必须在聚集索引中查找值。查找范围很广。

只有您的第三个查询需要查找。这就是为什么您的第三个查询较慢的原因。

# html - 水平列表 li 不占整个高度

> ID：14777502
> 
> 赞同：0
> 
> 时间：2013-02-08T16:55:14.550
> 
> 标签：html, css

```
<ul class="nav">
    <li><a href="#"><i class="icon-home"></i></a></li>
    <li><a href="#">Blog</a></li>
    <li><a href="#">Elements</a></li>
    <li><a href="#">Contact us</a></li>
</ul>

.nav {
  line-height: 70px;
  margin: 0;
  padding: 0;
  border: 0;
}
.nav li {
  list-style-image: none;
  list-style-type: none;
  margin-left: 0;
  white-space: nowrap;
  display: inline;
  float: left;
  padding-left: 4px;
  padding-right: 4px;
}
.active {
  background: pink;
}
.icon-home {
  background: url(http://i.stack.imgur.com/MNme0.png) no-repeat;
  width: 16px;
  height: 14px;
  display:block;
}
body {
  background: gray;
} 
```

如何使背景`.active`占据`li`图标的整个高度并居中？如果您查看演示，它不尊重`li`.

演示：~~[http ://codepen.io/anon/pen/ulEGw](http://codepen.io/anon/pen/ulEGw)~~

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:58:20.800

您可以设置`.icon-home`为`display: inline-block;`，它将与其余文本垂直居中。

你也可以保持`line-height`这种方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:00:21.510

假设你想保持你`line-height: 70px`的，`.nav`穿上`height: 70px;`。`.icon-home`

# jquery - jQuery - 对 li 排序

> ID：14777508
> 
> 赞同：3
> 
> 时间：2013-02-08T16:55:31.773
> 
> 标签：jquery, sorting

我不知道为什么，但是这段代码没有正确排序我的 li。它们正在改变顺序，但例如，如果它们像这样 1、5、2、9，那么它正在更改为 5、2、9、1。

jQuery代码：

```
var sorter_type=new Array("date_sort","price_sort","discount_sort","time_sort");
function sorting_by_filter(filter_id,field)
{
    var sort_type="";

    if($('#'+filter_id).attr("class")=="asc")
    {   
        $('#'+filter_id).removeClass("asc");
        $('#'+filter_id).addClass("desc");
        sort_type=" desending";
    }
    else
    {
        $('#'+filter_id).removeClass("desc");
        $('#'+filter_id).addClass("asc");
        sort_type="";
    }

    for(i=0;i<sorter_type.length;i++)
    {
        if(sorter_type[i]==filter_id)
        {
            $('#'+filter_id).parent().attr("class","");
            $('#'+filter_id).parent().addClass("clsTop_Menu_Act"+sort_type);
        }
        else
        {
            $("#"+sorter_type[i]).parent().attr("class","");
        }

    }

    var $sort = $('#'+filter_id);

    var $list = $('.clsDeal_Whole_Cont');
    var $listLi = $('li.clsDeal_Blk_Cont',$list);
    $listLi.sort(function(a, b){
        var keyA = parseInt($(a).attr(field));
        var keyB = parseInt($(b).attr(field));
        if($($sort).hasClass('asc')){
            return (keyA > keyB) ? 1 : 0;
        } else {
            return (keyA < keyB) ? 1 : 0;
        }
    });
    $.each($listLi, function(index, row){
        $list.append(row);
    });
} 
```

按钮代码：

```
 <ul class="clearfix" id="filters">
      <li class="clsTop_Menu_Act"><a href="javascript:void(0)" class="asc"     onclick="sorting_by_filter('date_sort','title')" id="date_sort">New</a></li>
          <li><a href="javascript:void(0)" onclick="sorting_by_filter('price_sort','price')" class="asc" id="price_sort">Price</a></li>
          <li><a href="javascript:void(0)" onclick="sorting_by_filter('discount_sort','discount')" class="asc" id="discount_sort">Discount</a></li>
          <li><a href="javascript:void(0)" onclick="sorting_by_filter('time_sort','time_left')" class="asc" id="time_sort" >Time Left</a></li>
</ul> 
```

需要排序的内容：

```
<ul class="clsDeal_Whole_Cont clearfix">
     <li class="clsDeal_Blk_Cont" style="display:block" id="deal_1"  price="2" discount="50" time_left="1360363800">
     <li class="clsDeal_Blk_Cont" style="display:block" id="deal_10"  price="20" discount="45" time_left="1360363700">
     <li class="clsDeal_Blk_Cont" style="display:block" id="deal_5"  price="19" discount="80" time_left="1360363800">
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:03:11.647

也许是因为您永远不会`-1`从排序回调中返回。总是只有`1`or `0`，顺便说一句，你也没有正确返回。

如果您*按升序*排序，则必须返回`-1`（负数）如果`keyA`小于`keyB`，`0`如果它们相等或`+1`（正数）如果`keyA`大于`keyB`。

例子：

```
$listLi.sort(function(a, b){
    var keyA = parseInt($(a).attr(field), 10);
    var keyB = parseInt($(b).attr(field), 10);

    // sorts in descending order. The result will be
    // negative if keyA > keyB
    // 0        if keyA == keyB
    // positive if keyA < keyB

    var result = keyB - keyA;
    if ($sort.hasClass('asc') {
        // multiplying by -1 reverses the order
        result = result * (-1);
    }
    return result;
}); 
```

[`Array#sort`通过阅读文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/sort)了解更多关于排序回调的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:06:52.670

正如 Felix Kling 指出的那样，您的排序功能还没有达到标准。这些是有效排序必须解决的条件，来自[MDN 文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/sort)：

*   如果`compareFunction(a, b)`小于 0，则将 a 排序到比 b 低的索引。
*   如果`compareFunction(a, b)`返回 0，则 a 和 b 彼此保持不变，但对所有不同元素进行排序。注意：ECMAscript 标准不保证这种行为，因此并非所有浏览器（例如，至少可以追溯到 2003 年的 Mozilla 版本）都尊重这一点。
*   如果`compareFunction(a, b)`大于 0，则将 b 排序到比 a 低的索引。
*   `compareFunction(a, b)`当给定一对特定的元素 a 和 b 作为其两个参数时，必须始终返回相同的值。如果返回不一致的结果，则排序顺序未定义

他已经发布了一个有效的排序功能（并且 1'uped 我的文档链接），所以我将只为您指出一个 jQuery UI 插件，以便在未来实现这一点：[jQuery UI Sortable](http://jqueryui.com/sortable/)。

# sql - 使用 sql 数据透视

> ID：14777509
> 
> 赞同：1
> 
> 时间：2013-02-08T16:55:34.503
> 
> 标签：sql, oracle11g, pivot

我正在使用在 windows server 2008 R2 上运行的 oracle 11gR2

我有一张这样的桌子

```
 year    code    value
   ----    ----    -----
   1991      1      v1
   1991      2      v2
   1991      3      v3

   1992      1     v4
   1992      2     v5
   1992      3     v6

   ...
   2050 
```

代码列可以是 1 到 10。

我希望看到最终输出为（值为 1 到 10 的列）

```
 year    1   2   3  4 ....    10
 ----    --  --  -- --        --
 1991   v1   v2  v3 null.......null
 1992   v4   v5  v6\. ...etc 
```

如何进行旋转以获得上述格式的结果？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T16:58:41.813

一种不使用的简单方法`PIVOT`是使用`CASE`：

```
SELECT  year,
        MIN(CASE WHEN code = 1 THEN value END) AS Col1,
        MIN(CASE WHEN code = 2 THEN value END) AS Col2,
        MIN(CASE WHEN code = 3 THEN value END) AS Col3,
        MIN(CASE WHEN code = 4 THEN value END) AS Col4,
        MIN(CASE WHEN code = 5 THEN value END) AS Col5,
        MIN(CASE WHEN code = 6 THEN value END) AS Col6,
        MIN(CASE WHEN code = 7 THEN value END) AS Col7,
        MIN(CASE WHEN code = 8 THEN value END) AS Col8,
        MIN(CASE WHEN code = 9 THEN value END) AS Col9,
        MIN(CASE WHEN code = 10 THEN value END) AS Col10
FROM YourTable
GROUP BY year 
```

，`PIVOT`它会是这样的：

```
SELECT *
FROM (SELECT year, code, value FROM YourTable) 
PIVOT (MIN(value) FOR code IN (1, 2, 3, 4, 5, 6, 7, 8, 9, 10) ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T17:01:50.787

Oracle 11g 有一个[`PIVOT`](http://www.oracle.com/technetwork/articles/sql/11g-pivot-097235.html)函数可以用来将数据从行转换为列：

```
select *
from
(
  select year, code, value
  from yourtable
)
pivot
(
  max(value)
  for code in ('1', '2', '3', '4', '5', '6', '7', '8', '9', '10')
) piv 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!4/df64c/1)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T17:02:27.450

在 11g 中，您可以使用`pivot`：

```
SELECT *
FROM t
PIVOT (max(value) as value FOR (code) IN (1, 2, 3, 4, 5, 6, 7, 8, 9, 10)) 
```

# java - 未报告的异常 java.io.FileNotFoundException;？

> ID：14777511
> 
> 赞同：0
> 
> 时间：2013-02-08T16:55:39.417
> 
> 标签：java, file, io, java.util.scanner

我想打开一个文件并扫描它以打印其令牌，但我收到错误：未报告的异常 java.io.FileNotFoundException; 必须被捕获或声明被抛出 Scanner stdin = new Scanner (file1); 该文件位于具有正确名称的同一文件夹中。

```
 import java.util.Scanner;
   import java.io.File;

   public class myzips {

           public static void main(String[] args) {

                  File file1 = new File ("zips.txt");

                  Scanner stdin = new Scanner (file1);

                  String str = stdin.next();

                  System.out.println(str);
          }
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T16:57:50.103

您正在使用的构造函数`Scanner`会引发 FileNotFoundException，您必须在编译时捕获该异常。

```
public static void main(String[] args) {

    File file1 = new File ("zips.txt");
    try (Scanner stdin = new Scanner (file1);){
        String str = stdin.next();

        System.out.println(str);
    } catch (FileNotFoundException e) {
        /* handle */
    } 
} 
```

上面的符号，您`try`在括号内声明和实例化 Scanner 只是 Java 7 中的有效符号。它的作用是`close()`在您离开 try-catch 块时使用调用包装您的 Scanner 对象。[你可以在这里](http://radar.oreilly.com/2011/09/java7-features.html)阅读更多关于它的信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T16:58:45.757

该文件是，但它可能不是。您要么需要声明您的方法可能会抛出`FileNotFoundException`，如下所示：

```
public static void main(String[] args) throws FileNotFoundException { ... } 
```

或者您需要添加一个`try -- catch`块，如下所示：

```
Scanner scanner = null;
try {
  scanner = new Scanner(file1);
catch (FileNotFoundException e) {
  // handle it here
} finally {
  if (scanner != null) scanner.close();
} 
```

# php - 如何按照我们在 PHP 中设置的时间发送电子邮件

> ID：14777513
> 
> 赞同：0
> 
> 时间：2013-02-08T16:55:45.890
> 
> 标签：php, email

我想问一些事情。也许我会先解释一下这个场景：

1.  当有人从我的网上商店购买商品然后结账时，我会向他们发送电子邮件，告知他们购买的商品。
2.  在他们购买 1 小时后，我想使用电子邮件通知他们并向他们发送他们必须确认付款，并且每 3 小时将向他们发送相同的电子邮件，并且该电子邮件将在一天内仅发送 3 次。例如：他们在12:00购买了一些商品，13:00系统会自动发送通知给他们确认付款，16:00和19:00系统会再次发送相同的电子邮件通知。
3.  如果一天内没有确认付款，系统不会再次发送通知并取消订单，或者如果他们在截止日期前已经确认付款，系统不会再次发送通知。

我怎样才能获得问题 2 和 3 的解决方案？非常感谢您的回复和解决方案。。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T16:58:33.983

如果您的 xampp 在 Windows 上，您可以使用 windows-scheduler 调用特定脚本（在您的情况下为 PHP 脚本，最好通过 URL），它会检查所有用户的生日并相应地向他们发送邮件。

如果你的 xampp 在 Linux/Unix/etc 上，你可以使用 cron-jobs，其余的都是一样的！

还有第三种方式，第三方调度器或者说 online-cron，它会远程调用你的脚本（php-page）。

```
**Example:** 
```

如果您自己进行操作系统的 cron 设置，您仍然可以让配置在您的系统中发送电子邮件给谁，而不是操作系统。

现在关于时间设置，你可以让 CRON 每次调用你的脚本，你的 php 脚本会检查适当的时间，并触发邮件！

**参考 在生日** [当天向不同的客户发送邮件](https://stackoverflow.com/questions/9494057/send-mail-to-different-customer-on-their-birthday)

# static - CloudFront 对数百万很少多次出现的静态图像有效吗？

> ID：14777515
> 
> 赞同：1
> 
> 时间：2013-02-08T16:55:47.217
> 
> 标签：static, amazon-s3, amazon-cloudfront

我有一个网站，在 Amazon S3（项目大数据库）上托管了数百万张图片。图像很少被多次看到。通过 CloudFront 会有效还是值得？我知道图像在设定的时间后过期，所以如果没有人在设定的时间内查看它，那是没有意义的，不是吗？初始 CloudFront 到 S3 请求是否需要付费？如果没有，那我还是应该把它放在一边？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-10-08T08:13:45.973

如果您的原始服务器（原始副本）不在 AWS 资源上，则将其缓存在 CloudFront 上需要花钱。但由于图像在 S3 上，这将是免费的（2014 年 12 月 1 日生效）。S3 数据传输到 Cloudfront 也是免费的。

如果图像不可能被多次看到，则将其存储在 CloudFront 上是没有意义的。只有在设置的 TTL 内收到超过 1 个视图时，将它们存储在 CloudFront 上才有意义。

但由于这将是免费的，因此可以将其缓存在 CloudFront 上并从那里提供服务。尽管这不太可能为您增加用户体验或图像加载时间。

# javascript - 通过多路径刷图绘制 d3.js 焦点+上下文时遇到问题

> ID：14777518
> 
> 赞同：6
> 
> 时间：2013-02-08T16:55:56.570
> 
> 标签：javascript, jquery, d3.js

我已经研究了几个星期，似乎无法弄清楚如何用多条路径绘制下面的图表。 [通过刷图的焦点+上下文](http://bl.ocks.org/1667367)

我试图创建一个 jsfiddle，但无法复制我得到的屏幕。在这一点上，我所拥有的与原始图表相似，只是用一条路径而不是区域和刷牙工作。基本上试图结合焦点图表和多系列折线图[多系列图表](http://bl.ocks.org/3884955)。

但是，当我尝试添加另一条路径时，没有任何效果。请提出我需要做出的任何想法或更改以使其正常工作。还有其他我可以查看的类似图表（或图表示例）。可以以任何方式或形式重新排列数据以使其工作。

[提琴手](http://jsfiddle.net/yFpZe/2/)

```
<div id='dashboardChart'>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
id="svg">
</div> 
```

* * *

```
path {
fill:none;
stroke:white;
stroke-width:2px;
}
.axis path, .axis line {
    fill: none;
    stroke: #CCC;
    shape-rendering: crispEdges;
}
.brush .extent {
    stroke: #fff;
    fill-opacity: .125;
    shape-rendering: crispEdges;
}
.path_green {
    stroke:green;
}
.path_red {
    stroke:red;
}
.path_yellow {
    stroke:yellow;
} 
```

* * *

```
function drawChart() {
    var margin = {
        top: 5,
        right: 10,
        bottom: 100,
        left: 50
    },
    margin2 = {
        top: 200,
        right: 10,
        bottom: 20,
        left: 50
    },
    width = 1075 - margin.left - margin.right,
        height = 280 - margin.top - margin.bottom,
        height2 = 280 - margin2.top - margin2.bottom;

    var parseDate = d3.time.format("%Y-%m-%d").parse;

    var x = d3.time.scale().range([0, width]),
        x2 = d3.time.scale().range([0, width]),
        y = d3.scale.linear().range([height, 0]),
        y2 = d3.scale.linear().range([height2, 0]);

    var xAxis = d3.svg.axis().scale(x).orient("bottom"),
        xAxis2 = d3.svg.axis().scale(x2).orient("bottom"),
        yAxis = d3.svg.axis().scale(y).orient("left");

    var brush = d3.svg.brush()
        .x(x2)
        .on("brush", brush);

    var area = d3.svg.area()
        .interpolate("monotone")
        .x(function (d) {
        return x(d.date);
    })
        .y0(height)
        .y1(function (d) {
        return y(d.red);
    });

    var area2 = d3.svg.area()
        .interpolate("monotone")
        .x(function (d) {
        return x2(d.date);
    })
        .y0(height2)
        .y1(function (d) {
        return y2(d.red);
    });

    var svg = d3.select("#dashboardChart #svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom);

    svg.append("defs").append("clipPath")
        .attr("id", "clip")
        .append("rect")
        .attr("width", width)
        .attr("height", height);

    var focus = svg.append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    var context = svg.append("g")
        .attr("transform", "translate(" + margin2.left + "," + margin2.top + ")");

    var data = [{
        "date": "2013-02-08T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 1
    }, {
        "date": "2013-02-07T05:00:00.000Z",
        "data": null,
        "red": 485,
        "yellow": 0,
        "green": 491
    }, {
        "date": "2013-02-06T05:00:00.000Z",
        "data": null,
        "red": 2884,
        "yellow": 0,
        "green": 2881
    }, {
        "date": "2013-02-05T05:00:00.000Z",
        "data": null,
        "red": 3191,
        "yellow": 0,
        "green": 3188
    }, {
        "date": "2013-02-04T05:00:00.000Z",
        "data": null,
        "red": 180,
        "yellow": 0,
        "green": 184
    }, {
        "date": "2013-02-03T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 0
    }, {
        "date": "2013-02-02T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 0
    }, {
        "date": "2013-02-01T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 0
    }, {
        "date": "2013-01-31T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 0
    }, {
        "date": "2013-01-30T05:00:00.000Z",
        "data": null,
        "red": 1,
        "yellow": 0,
        "green": 0
    }, {
        "date": "2013-01-29T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 2
    }, {
        "date": "2013-01-28T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 0
    }, {
        "date": "2013-01-27T05:00:00.000Z",
        "data": null,
        "red": 1,
        "yellow": 1,
        "green": 1
    }, {
        "date": "2013-01-26T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 1
    }, {
        "date": "2013-01-25T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 0
    }, {
        "date": "2013-01-24T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 0
    }, {
        "date": "2013-01-23T05:00:00.000Z",
        "data": null,
        "red": 49,
        "yellow": 0,
        "green": 45
    }, {
        "date": "2013-01-22T05:00:00.000Z",
        "data": null,
        "red": 59,
        "yellow": 0,
        "green": 64
    }, {
        "date": "2013-01-21T05:00:00.000Z",
        "data": null,
        "red": 119,
        "yellow": 1,
        "green": 125
    }, {
        "date": "2013-01-20T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 1,
        "green": 0
    }, {
        "date": "2013-01-19T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 0
    }, {
        "date": "2013-01-18T05:00:00.000Z",
        "data": null,
        "red": 84,
        "yellow": 0,
        "green": 81
    }, {
        "date": "2013-01-17T05:00:00.000Z",
        "data": null,
        "red": 76,
        "yellow": 1,
        "green": 77
    }, {
        "date": "2013-01-16T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 1,
        "green": 0
    }, {
        "date": "2013-01-15T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 0
    }, {
        "date": "2013-01-14T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 0
    }, {
        "date": "2013-01-13T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 0
    }, {
        "date": "2013-01-12T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 0
    }, {
        "date": "2013-01-11T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 0
    }, {
        "date": "2013-01-10T05:00:00.000Z",
        "data": null,
        "red": 0,
        "yellow": 0,
        "green": 0
    }];

    x.domain(d3.extent(data.map(function (d) {
        return d.date;
    })));
    y.domain([0, d3.max(data.map(function (d) {
        return d.red;
    }))]);
    x2.domain(x.domain());
    y2.domain(y.domain());

    focus.append("path")
        .datum(data)
        .attr("clip-path", "url(#clip)")
        .attr("d", area)
        .attr("class", "path_red");

    focus.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis);

    focus.append("g")
        .attr("class", "y axis")
        .call(yAxis);

    context.append("path")
        .datum(data)
        .attr("d", area2)
        .attr("class", "path_red");

    context.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height2 + ")")
        .call(xAxis2);

    context.append("g")
        .attr("class", "x brush")
        .call(brush)
        .selectAll("rect")
        .attr("y", -6)
        .attr("height", height2 + 7);

    function brush() {
        x.domain(brush.empty() ? x2.domain() : brush.extent());
        focus.select("path").attr("d", area);
        focus.select(".x.axis").call(xAxis);
    }
}
drawChart(); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-11T17:25:19.403

根据您的评论，您可以绘制三个区域，但难以*刷*出它们。我在这里有一个工作示例：http: [//jsfiddle.net/BVzyq/1/](http://jsfiddle.net/BVzyq/1/)其中，我添加了与数据中的三种*颜色*`<path>`相对应的三个元素：.*`['red', 'yellow', 'green']`*

 *我抽象出可以接受颜色并返回适当`d`值的函数：

```
var area = function (color) {
    return d3.svg.area()
        .interpolate("monotone")
        .x(function (d) {
          return x(d.date);
        })
        .y0(height)
        .y1(function (d) {
          return y(d[color]);
        });
};

var area2 = function (color) {
    return d3.svg.area()
        .interpolate("monotone")
        .x(function (d) {
          return x2(d.date);
        })
        .y0(height2)
        .y1(function (d) {
          return y2(d[color]);
        });
}; 
```

它们可以进一步抽象，但这些最接近您编写的代码。创建路径时使用这些函数：

```
focus.selectAll('path')
    .data(['red', 'yellow', 'green'])
  .enter()
    .append('path')
    .attr('clip-path', 'url(#clip)')
    .attr('d', function (col) {
      return area(col)(data);
    })
    .attr('class', function (col) {
      return "path_" + col + " data";
    });

// ...

context.selectAll('path')
    .data(['red', 'yellow', 'green'])
  .enter()
    .append('path')
    .attr('d', function (col) {
      return area2(col)(data);
    })
    .attr('class', function (col) {
      return "path_" + col;
    }); 
```

CSS 类似乎建议使用这种形式的数据连接。我还在`data`与时间序列图对应的路径中添加了另一个类。这样可以很容易地将这些`<path>`s 与那些用于轴的 s 区分开来。

最后，在画笔函数中，重新计算`d`所有`path.data`元素的属性：

```
function brush() {
    x.domain(brush.empty() ? x2.domain() : brush.extent());
    focus.selectAll("path.data").attr("d", function (col) { 
      return area(col)(data); 
    });
    focus.select(".x.axis").call(xAxis);
} 
```

请注意，我更改了一些值`data`以使所有三种颜色都可见。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-15T18:34:16.927

伟大的解决方案 musicly_ut，对于其他有类似问题的人。我能够加载额外的 csv，就像在这个链接中找到的示例 -[通过刷的焦点 + 上下文](http://bl.ocks.org/mbostock/1667367)但真的挂断了如何将所有线条刷在一起，即使它们在区域和区域 2 中都正确渲染。

事实证明，查看您的代码，我所要做的就是像您一样将 focus.select 更改为 focus.selectAll 。谢谢！

对于使用原始教程代码的任何人，您只需复制以下代码并指向您的新 csv，即可添加备用 csv：

```
d3.csv("sp501.csv", function(error, data) { 

      data.forEach(function(d) {
        d.date = parseDate(d.date);
        d.price = +d.price;
      });

      x.domain(d3.extent(data.map(function(d) { return d.date; })));
      y.domain([0, d3.max(data.map(function(d) { return d.price; }))]);
      x2.domain(x.domain());
      y2.domain(y.domain());

      focus.append("path")
          .datum(data)
          .attr("clip-path", "url(#clip)")
          .attr("d", area)
          .attr("class", "timeLine2");

      context.append("path")
          .datum(data)
          .attr("class", "timeLine2")
          .attr("d", area2);

      context.append("g")
          .attr("class", "x axis2")
          .attr("transform", "translate(0," + height2 + ")")
          .call(xAxis2);

      context.append("g")
          .attr("class", "x brush")
          .call(brush)
        .selectAll("rect")
          .attr("y", -6)
          .attr("height", height2 + 7);
    }); 
```*

# f# - 如果 SML.NET 有函子，为什么 F# 不能？

> ID：14777522
> 
> 赞同：38
> 
> 时间：2013-02-08T16:56:18.087
> 
> 标签：f#, ocaml, sml, functor, ml

这个问题从

1.  我将LC PAULSON 的“ [ML for the Working Programmer](http://www.cl.cam.ac.uk/~lp15/MLbook/) ”（[WorldCat ）翻译成 F#，它使用函子作为示例。](http://www.worldcat.org/oclc/26013714)
2.  最终希望翻译 Chris Okasaki 使用函子的“[纯功能数据结构](https://rads.stackoverflow.com/amzn/click/com/0521663504)”（[WorldCat](http://www.worldcat.org/oclc/38521530)）。
3.  阅读Andrea Asperti 和 Giuseppe Longo 的“[类别类型和结构 - 工作计算机科学家的类别理论简介](http://www.di.ens.fr/users/longo/files/CategTypesStructures/book.pdf)”（[WorldCat ）。](http://www.worldcat.org/oclc/20755899)
4.  不明白这一切，主要是范畴论。

[SML.NET](http://www.cl.cam.ac.uk/research/tsg/SMLNET/)可以做仿函数并与 Microsoft .NET 一起使用。
* 请参阅：[SML.NET 用户指南](http://www.cl.cam.ac.uk/research/tsg/SMLNET/smlnet.pdf)第 4.8.2 节类类型和仿函数？

由于 Microsoft .NET 中的一些限制，我一直看到 F# 无法执行真正的函子。
* [ML 仿函数可以在 .NET (C#/F#) 中完全编码吗？](https://stackoverflow.com/q/1426239/1243762)
*[函子的任何解决方法？](http://cs.hubfs.net/topic/None/57222)

因此，如果 SML.NET 可以在 .NET 上执行仿函数，那么为什么 F# 不能呢？SML.NET 做了哪些 F# 做不到的事情？

我从范畴论中了解的函子越多，我就越能看到它们的美妙之处，并希望在 F# 中使用它们。

编辑

为了更好地理解类别理论和函数式编程之间的关系，请参阅[CS:StackExchange](https://cs.stackexchange.com/)上的这些[问答](https://cs.stackexchange.com/questions/tagged/category-theory+functional-programming)。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-02-08T17:09:27.917

.NET 没有阻止函子在 F# 中实现的基本限制。诚然，它们不能直接在 .NET 元数据中表示，但其他 F# 语言功能（如联合类型）也不能。带有仿函数的语言（例如，标准 ML、OCaml）的编译器有一个称为*[defunctorize](http://mlton.org/Defunctorize)*的过程；它就像 C++ 模板扩展一样工作，因为它通过将仿函数专门化为普通模块来“扁平化”它们。

F# 编译器可以做同样的事情，但你不得不问：这将如何暴露给其他 .NET 语言？由于函子不能*直接*在 .NET 类型系统中编码，因此您需要想出一些方法来表示它们；如果这种表示很难/不可能从 C# 或 VB.NET 中使用，那么包含 F# 函子是否仍然有意义？F# 成功的一个重要部分来自于它能够轻松地与 C# 和 VB.NET 互操作（双向）。

编辑：不要误会我的意思——我很想在 F# 中使用仿函数，它们对于处理一些目前很痛苦和/或没有它们就无法实现的情况非常有用。我只是指出该语言还没有（也许永远不会）有函子的主要原因是互操作问题没有得到解决。元数据编码问题实际上是容易的部分。

编辑 2：*MLton*的解函数传递[代码](https://github.com/MLton/mlton)：[`defunctorize.fun`](https://github.com/MLton/mlton/blob/master/mlton/defunctorize/defunctorize.fun)

**更新：**我想到了如何在 .NET 类型系统中实际表达函子*，*所以我做了一个小实验。它不漂亮，但它有效——所以现在我们知道 F# 有朝一日可以支持函子至少是合理的。实际上，您在我的实验代码中看到的复杂性都将被编译器/语言隐藏。如果你想检查一下：[experimental-functors](https://github.com/jack-pappas/experimental-functors)

# objective-c - 如何获取目录中的dylib版本信息

> ID：14777523
> 
> 赞同：1
> 
> 时间：2013-02-08T16:56:20.057
> 
> 标签：objective-c, cocoa, version, dylib

我想得到 dylib 版本。我有一个 dylib 路径，我想为其获取版本号。我已经尝试过`"otool -L"`命令，它给了我正确的输出，但根据要求我不能使用它，因为我在一个目录中有 100 个 dylib，我想获取它的版本信息并且我不能运行“通过 NSTask 和 NSPipe 对每个 dylib 执行 otool" 命令。

我还找到了`NSVersionOfLinkTimeLibrary()`获取 dylib 版本的函数，但根据文档`NSVersionOfLinkTimeLibrary`返回链接库的版本号，而不是其他 dylib。

对此的任何帮助都会有所帮助。

谢谢。奥姆卡尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T09:13:18.680

我已经通过编写自己的 dylib 解析器解决了这个问题。下面是代码片段

```
- (int64_t)getDylibVersion :(NSString *)dylibPth
{   
    const char* strFilePath = [dylibPth UTF8String];

    FILE* fileHandle = fopen(strFilePath, "rb");

    struct mach_header mh;
    if(fileHandle)
    {
        size_t bytesRead = fread(&mh, 1, sizeof(mh), fileHandle);

        if(bytesRead == sizeof(mh))
        {
            if((mh.magic == MH_MAGIC_64 || mh.magic == MH_MAGIC) && mh.filetype == MH_DYLIB)
            {               
                for(int j = 0; j < mh.ncmds; j++)
                {
                    union
                    {
                        struct load_command lc;
                        struct dylib_command dc;
                    } load_command;                 
                    if (sizeof(load_command.lc) != fread(&load_command.lc, 1, sizeof(load_command.lc), fileHandle))
                        goto fail;

                    switch (load_command.lc.cmd) 
                    {
                        case LC_SEGMENT:
                            break;
                        case LC_UUID:
                            break;
                        case LC_DYLD_INFO_ONLY:
                            break;
                        case LC_SYMTAB:
                            break;
                        case LC_LOAD_DYLIB:
                            break;
                        case LC_ID_DYLIB:
                        {
                            if (sizeof(load_command) - sizeof(load_command.lc) != fread(&load_command.lc + 1, 1, sizeof(load_command) - sizeof(load_command.lc), dylib_handle))
                                goto fail;
                            fclose(fileHandle);
                            return(load_command.dc.dylib.current_version);
                        }

                        default:
                            break;
                    }

                    if (0 != fseek(fileHandle, load_command.lc.cmdsize - sizeof(load_command.lc), SEEK_CUR))
                        goto fail;
                }
            }
        }
    }

fail:
    fclose(fileHandle);

    return (-1);
} 
```

请注意，Mach-O dylib 版本号编码为 32 位无符号整数，主要版本在高 16 位，次要版本在 8 到 15 位，补丁级别在低 8 位：

```
uint32_t version = …;
uint32_t major = version >> 16;
uint32_t minor = (version >> 8) & 0xff;
uint32_t revision = version & 0xff; 
```

另请注意，上述代码仅适用于“瘦”二进制文件。“胖”多架构二进制文件以胖头开始，您需要先协商它以找到适合您所需架构的切片。此外，以上仅适用于运行架构字节序的架构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T22:59:55.040

在我看来，你有两个选择。

1.  将每个 dylib 加载到您的进程中并查找每个上的 Mach-O 标头，查找版本号。[文档](http://developer.apple.com/library/mac/#documentation/DeveloperTools/Reference/MachOReference/Reference/reference.html)应该足够完整和彻底，以帮助您入门。

2.  将每个 dylib 作为普通文件打开，并自己读取和解析 Mach-O 标头。这避免了必须将每个 dylib 加载到进程中，但这确实意味着您需要自己解析 Mach-O 二进制格式，或者找到一个可以为您完成它的库（我不知道任何顶部我的头）。

# c# - 调用方法时创建列表

> ID：14777524
> 
> 赞同：0
> 
> 时间：2013-02-08T16:56:22.420
> 
> 标签：c#

我有一个具有以下签名的方法：

```
public void SomeMethod(int SomeInt, List<long> SomeListOfLongs) 
```

有一次，我调用了这个方法，代码看起来有点像这样：

```
int TheInt = 2;
long TheLong1 = 3;
long TheLong2 = 4; 
```

我想创建一个 long 列表并一步调用该方法。我试过这个：

```
SomeMethod(TheInt, new List<long>(TheLong1, TheLong2)); 
```

有没有办法避免直接在调用本身中创建一个新列表？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:57:52.017

不，您将创建新列表。但这不应该引起任何问题。

如果您可以控制该方法，则可以将签名更改为：

```
public void SomeMethod(int someInt, params long[] someArrayOfLongs) 
```

然后您就可以使用以下代码调用该方法：

```
SomeMethod(TheInt, TheLong1, TheLong2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:09:31.703

实际上，我只是在修改代码并发现这是可能的：

```
SomeMethod(TheInt, new List<long>() { TheLong1, TheLong2 }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T17:33:31.190

```
 private void Form1_Load(object sender, EventArgs e)
    {
        call(1, new List<long> { 1, 2, 3, 4 });
    }
    void call(Int32 i,List<long> l)
    {
        MessageBox.Show((l[0] + l[1] + l[2] + l[3]).ToString());
    }

       i tried this and working properly so use this code too pass the List object..... 
```

# css - Firefox 中具有相对位置和内容绝对错误的表格单元格

> ID：14777528
> 
> 赞同：8
> 
> 时间：2013-02-08T16:56:28.337
> 
> 标签：css, firefox, css-tables

我真的不知道我的代码有什么问题......

单元格是相对定位的，而表单是绝对定位的。在每个浏览器中它都可以正常工作，但不能在 Firefox 中...

表格 CSS 有问题吗？

**CSS**

```
.table                              { display: table; width:100%; height:100%; table-layout: fixed; }
.row                                { display: table-row; height: 1px; }
.cell                               { display: table-cell; vertical-align: middle; position: relative; }
.menu .cell                         { width: 33.33%; border: 1em solid #000; font-size: 1.14em;
                                    background: #fff; background-clip: padding-box; vertical-align: top; position: relative; }

.menu .cell header                  { padding:.5em 1em; background-color: #383430; color: #fff; line-height: 1.2; position: relative; }
.menu .cell .content                { padding:2em 1em 3em 1em;}
.menu .cell h3                      { font-size: 1em; text-transform: uppercase; text-decoration: underline; font-weight:300;} 
.menu .cell ul                      { margin: 0; padding: 0; list-style: none; }
.menu .cell li                      { line-height: 1.4; padding:0.25em 0; border-bottom: 1px solid #ecece6;}
.menu .cell li:last-child           { border-bottom: none; margin-bottom: 0;}

.menu .like header:before           { content : 'on aime !'; position: absolute; bottom: 100%; left: 1em; 
                                    text-transform: uppercase; font-size: .8em; padding: 3.5em .5em .5em .5em; border-radius: 1em 1em 0 0; 
                                    background: #dd582a url(imgs/on-aime.png) center .5em no-repeat; box-shadow:  0px 0px 2px 0 rgba(0,0,0,.5); }

.menu .favorite                     { position: absolute; bottom: -.75em; right: -.75em;  display: block; width: 100%; overflow: hidden;}
.menu .favorite input               { position: absolute; top: -30em;}

.menu .favorite label,
.menu .favorite label:before        { background-color: #dd582a; height: 32px; white-space: nowrap;
                                    float: right;  color: #fff; background-image: linear-gradient(#dd582a 50%, #bd5d3b 100%); }
.menu .favorite label:hover,
.menu .favorite label:hover:before{background-image: linear-gradient(#bd5d3b 5%, #dd582a 50%); }

.menu .favorite label               { text-align: center; font-size: 24px; width: 32px; display: block; 
                                    line-height: 28px; border-radius: 4px; cursor: pointer;}

.menu .favorite label:before        { content: "Add to favorite"; display: block; position: absolute; right: 34px;
                                    padding:0 8px; font-size: 14px; line-height:32px  }
.menu .favorite input:checked + label { color: #e77248; background-color: #fff;background-image: linear-gradient(#ffffff 50%, #bfbfbf 100%); }
.menu .favorite input:checked + label:hover{background-image: linear-gradient(#bfbfbf 5%, #fff 50%);}
.menu .favorite input:checked + label:before { content: "Like"} 
```

**HTML**

```
<div class="table menu">

    <div class="row">
<div class="cell">
    <div >
        <header>100 $</header>
        <div class="content">
            <h3>Title 1</h3>
            <ul>
                <li>Item 1</li>
                <li>Item 2</li>
                <li>Item 3</li>
                <li>Item 4</li>
                <li>Item 5</li>
                <li>Item 6</li>
            </ul>
        </div>
        <form class="favorite">
            <input id="bal-menu2" type="checkbox" name="bal-menu2" value="favorite" />
            <label for="bal-menu2">♥&lt;/label>
        </form>
    </div>
</div>
        <div class="cell">
    <div >
        <header>100 $</header>
        <div class="content">
            <h3>Title 1</h3>
            <ul>
                <li>Item 1</li>
                <li>Item 2</li>
                <li>Item 3</li>
                <li>Item 4</li>
                <li>Item 5</li>
                <li>Item 6</li>
                <li>Item 7</li>
                <li>Item 8</li>
            </ul>
        </div>
        <form class="favorite">
            <input id="bal-menu2" type="checkbox" name="bal-menu2" value="favorite" />
            <label for="bal-menu2">♥&lt;/label>
        </form>
    </div>
</div>
    </div></div> 
```

这是一个小提琴

[http://jsfiddle.net/warface/8bWUe/2/](http://jsfiddle.net/warface/8bWUe/2/)

在 Firefox 中查看，您会注意到“添加到收藏夹”表单相互堆叠，但在其他浏览器中它定位得很好。

有关如何使其工作的任何线索都应该在 Chrome、Safari、IE8+ 中......？

**编辑**

经过一些研究...... Firefox 自 2000 年以来就有这个问题

[https://bugzilla.mozilla.org/show_bug.cgi?id=63895](https://bugzilla.mozilla.org/show_bug.cgi?id=63895)

而且他们似乎没有给出中指来修复它......在地狱火狐中燃烧！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-02T03:38:00.820

这是一个采用修改后的 .cell >div {position:relative} 并将 height:100% 添加到 div 的修复程序。

**CSS**

```
.row { display: table-row; height:100%; }
.cell div {height:100%; position: relative } 
```

这是更新的小提琴

[http://jsfiddle.net/8bWUe/19/](http://jsfiddle.net/8bWUe/19/)

适用于 FF v22.0

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:49:25.577

我能够使用以下 css 将表单放置在 Firefox 中：

> .cell > div { 位置：相对 }

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-11T03:09:12.493

制作

```
.row
{
      display: block; 
      position:relative
} 
```

而不是“ `table-row`” - 这应该可以解决问题。

# php - CakePHP：使用单个变量在控制器中管理表名

> ID：14777529
> 
> 赞同：0
> 
> 时间：2013-02-08T16:56:31.537
> 
> 标签：php, cakephp

在控制器 A 中，我加载了一个与此控制器无关的模型。我有兴趣使用单个变量管理控制器 B 的模型名称，因此如果表/模型 B 的名称发生更改，我不必手动更改很多行。

例如下面是控制器 A 的代码：

```
public $modelBName = 'ModelB';

public function controller_a_function() {
    $this->loadModel($this->modelBName);    // I use the variable here for model B

    $this->ModelB->model_b_function();    // COMMENT #1
} 
```

问题：对于注释为“COMMENT #1”的行，如何使用变量名而不是明确写出单词“ModelB”？此行在整个代码中出现多次，如果可能，我想使用该变量`$modelBName`。`ModelB`可能不会改变，但如果出于某种原因改变了，最好只改变一个变量而不是编辑多行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:45:03.230

简单的答案；用这个：

```
$this->{$this->modelBName}->find('all'); 
```

请注意属性名称周围的大括号 {}。更多信息可以在手册中找到；

[http://php.net/manual/en/language.variables.variable.php](http://php.net/manual/en/language.variables.variable.php)

更清洁的方法可能是一种“工厂”方法；

```
/**
 * Load and return a model
 *
 * @var string $modelName
 *
 * @return Model
 * @throws MissingModelException if the model class cannot be found.
 */
protected function model($modelName)
{
    if (!isset($this->{$modelName})) {
        $this->loadModel($modelName);
    }

    return $this->{$modelName};
} 
```

哪个可以这样使用；

```
$result = $this->model($this->modelBName)->find('all');
debug($result); 
```

而且，如果您不想指定模型，但希望它自动返回一个 '$this->modelBName'；

```
/**
 * Load and return the model as specified in the 'modelBName' property
 *
 * @return Model
 * @throws MissingModelException if the model class cannot be found.
 */
protected function modelB()
{
    if (!isset($this->{$this->modelBName})) {
        $this->loadModel($this->modelBName);
    }

    return $this->{$this->modelBName};
} 
```

可以这样使用：

```
$result = $this->modelB()->find('all');
debug($result); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:19:36.067

我认为您对模型名称和表名称感到困惑。您可以使用该属性将模型设置为使用不同的数据库表`$useTable`，例如：

```
class User extends AppModel {

    public $useTable = 'users_table'; // Database table used

}

class Product extends AppModel {

    public function foo() {
         $this->loadModel('User');

         $this->User->find('all');
    }
} 
```

您永远不需要更改模型的名称，如果数据库表的名称发生更改，您只需更新`$useTable`模型中的属性即可。

# c# - 读取丢失的数据 c# 输入字符串的格式不正确

> ID：14777530
> 
> 赞同：0
> 
> 时间：2013-02-08T16:56:34.187
> 
> 标签：c#, string, input, missing-data

我是 C# 新手。我一直在尝试读取缺少数据的数据集。阅读标题后，我使用以下方法阅读文件的其余部分：

```
List<int> idList = new List<int>();
List<int[]> valList = new List<int[]>();
string line = sr.ReadLine();
while (line != null)
{
    string[] lineParts = line.Split(delimiters);
    int id = Convert.ToInt32(lineParts[0]);
    idList.Add(id);

    int[] vals = new int[numTests];
    for (int i = 0; i < numTests; i++)
    {
        vals[i] = Convert.ToInt32(lineParts[i + 1]);
    }
    valList.Add(vals);
    line = sr.ReadLine();
}
childIDs = idList.ToArray();
int[][] values = valList.ToArray(); 
```

运行此程序时，我收到错误消息“输入字符串的格式不正确”。我不太清楚如何读取丢失的数据。有什么建议么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:14:10.803

您可以使用可为空的整数来跟踪是否缺少数据。此外，请考虑使用 int.TryParse 而不是 Convert.ToInt32 以避免 InvalidFormatException。例子：

```
List<int> idList = new List<int>();
List<int?[]> valList = new List<int?[]>();
string line;
while (null != (line = sr.ReadLine()))
{
    string[] lineParts = line.Split(delimiters);
    int id = Convert.ToInt32(lineParts[0]);
    idList.Add(id);

    int?[] vals = new int?[numTests];
    for (int i = 0; i < numTests; i++)
    {
        int parsed;
        if (!int.TryParse(lineParts[i + 1], out parsed))
            vals[i] = null;
        else
            vals[i] = parsed;
    }
    valList.Add(vals);
    line = sr.ReadLine();
}
childIDs = idList.ToArray();
var values = valList.ToArray(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:07:33.747

“输入的字符串格式不正确”意味着您正在尝试从无意义的字符串中解析一个 int。

例如：

```
Convert.ToInt32("the letter q"); // this will throw that exception. 
```

# c# - asp.net mvc localdb 初始化

> ID：14777531
> 
> 赞同：0
> 
> 时间：2013-02-08T16:56:41.080
> 
> 标签：c#, asp.net, asp.net-mvc-3, entity-framework, code-first

如何初始化数据库？// 带有 msSQL(LocalDb)/V11 的 ASP.NET MVC 3 我想编写代码以将数据上传到数据库。ASP.NET MVC3 EF 代码优先

**网络配置**

```
<connectionStrings>
    <add name="CompanyContext" connectionString="Data Source=(localdb)\v11.0; Initial Catalog=CompanyContext-20130203175316; Integrated Security=True; MultipleActiveResultSets=True; AttachDbFilename=|DataDirectory|CompanyContext-20130203175316.mdf"
      providerName="System.Data.SqlClient" />
  </connectionStrings> 
```

**全球.asax.cs**

```
protected void Application_Start()
        {
            AreaRegistration.RegisterAllAreas();

            // Use LocalDB for Entity Framework by default
            Database.DefaultConnectionFactory = new SqlConnectionFactory(@"Data Source=(localdb)\v11.0; Integrated Security=True; MultipleActiveResultSets=True");

            RegisterGlobalFilters(GlobalFilters.Filters);
            RegisterRoutes(RouteTable.Routes);
        } 
```

**初始化** 执行此操作的描述。

```
namespace tesztfeladat.Models
{
    public class CompanyInitalizer : DropCreateDatabaseIfModelChanges<CompanyContext>
    {
        protected override void Seed(CompanyContext context)
        {
            var contacts = new List<Contact>
            {
                new Contact {
                    Vezetéknév="Nagy",
                    Keresztnév="János",
                    Beosztás="alkalmazott",
                    Email="nagy.janos@default1.com",
                    Telefonszám="06361254452"
                },

                new Contact {
                    Vezetéknév="Kiss",
                    Keresztnév="Ferenc",
                    Beosztás="alkalmazott",
                    Email="kiss.ferenc@default1.com",
                    Telefonszám="06361254452"
                }
            };

            contacts.ForEach(d => context.Contacts.Add(d));
            context.SaveChanges();

            var events = new List<Event>
            {
                new Event {
                    Időpont=DateTime.Parse("12/31/2010"), 
                    Típusa="Tárgyalás",
                    Leírás="Éves költségvetés"
                },

                new Event {
                    Időpont=DateTime.Parse("12/31/2010"), 
                    Típusa="Tárgyalás",
                    Leírás="Éves költségvetés"
                }
            };

            events.ForEach(d => context.Events.Add(d));
            context.SaveChanges();

            var customers = new List<Customer>
            {
                new Customer {
                    Cégnév ="Default1.Kft",
                    Irányítószám= 1012,
                    Város="Budapest",
                    Cím="Tavasz utca 54.",
                    Weblap="http://www.default1.com",
                    Telefonszám="06361254452",
                    Contacts= contacts,
                    Events=events
                },

                new Customer {
                    Cégnév ="Default2.Kft",
                    Irányítószám= 2440,
                    Város="Százhalombatta",
                    Cím="Tél utca 34.",
                    Weblap="http://www.default1.com",
                    Telefonszám="063623254452",
                    Contacts=contacts,
                    Events=events
                }
            };
            customers.ForEach(d => context.Customers.Add(d));
            context.SaveChanges();
        }
    }
} 
```

我试过这个，但不工作。:(请帮帮我！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T19:11:49.353

在您尝试从 DataContext 访问某些内容之前，数据库不会初始化。尝试将其放在 Application_Start 方法的末尾：

```
using(var context = new CompanyContext())
{
    var temp = context.Contacts.FirstOrDefault();
} 
```

# javascript - 无法获取 div 宽度/高度

> ID：14777532
> 
> 赞同：1
> 
> 时间：2013-02-08T16:56:45.777
> 
> 标签：javascript, jquery, css, jqote

我找到了一个简单的如何在点击附近显示弹出窗口的好例子：[http ://roshanbh.com.np/examples/popup-message/](http://roshanbh.com.np/examples/popup-message/)

我正在利用它来单击按钮，但我似乎无法获得元素的实际宽度或高度，我也不完全确定为什么：

```
function BindObject(o)
{
    o.click(function(e)
    {
        var editor = $(this).find(".object_editor");

        console.log(editor);
        console.log(editor.height());
    });
} 
```

这是打印到控制台的内容：![在此处输入图像描述](../Images/bbdf581e21eb25bf116759b68b4b451b.png)

（仅供参考，在准备好文档时调用 BindObject，我也在使用 jqote，不确定它的相关性如何）

```
 $("#QuestContent").html($("#QuestTemplate").jqote(quest_data));
 $("#QuestContent").find(".object").each(function() {
    BindObject($(this));
 }); 
```

它显然找到了元素（由编辑器表示），但我无法确定它的宽度或高度。我确实知道显示设置为无，但那是因为我不想显示它，直到有人单击按钮以显示弹出窗口。任何人都有任何想法为什么它总是为空？

这是CSS：

```
.object_editor{
    position:absolute;
    z-index:10;   
    width:172px;
    height:102px;
    text-align:center;
    color:#FFFFFF;
    font: 14px Verdana, Arial, Helvetica, sans-serif;
    background-color:#000000;
    display:none;
} 
```

编辑：以及相关的 jqote 以防万一：

```
<!-- Object Template -->
<script type="text/x-jqote-template" id="ObjectTemplate">
    <![CDATA[
        <span class="object <%= (this.hidden ? "hiddenType" : "") %>">&nbsp;
            <input class="objectType" type="hidden" name="<%= this.key[0] %>" value="<%= this.type %>">
            <input class="objectEntry" type="hidden" name="<%= this.key[1] %>" value="<%= this.entry %>">
            <a data-emptytext="<%= object_types[this.type] %>" data-name="<%= this.key[1] %>" target="_blank" href="<%= (this.entry? whUrl(this.type, this.entry) : "#") %>" class="objectName"><%= this.name %><%= (this.entry?" ("+this.entry+")":"") %></a>&nbsp;<i class="icon-edit editObject"></i>
            &nbsp;
            <% if(this.remove) { %>
                <a href=".object" class="deleteParent"><i class="icon-trash"></i></a>
            <% } %>
        </span>

        <!-- Insert our Editor -->
        <%=$("#ObjectEditorTemplate").jqote({type: this.type, entry:this.entry}) %>
    ]]>
</script>

<!-- Object Editor Template -->
<script type="text/x-jqote-template" id="ObjectEditorTemplate">
    <![CDATA[
        <div class="object_editor">My Editor: <%= this.entry %></div>
    ]]>
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T16:59:34.810

原因是因为显示设置为无。看到[这个](https://stackoverflow.com/questions/9935023/css-no-div-width-when-display-set-to-none)类似的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T16:58:53.387

尝试
`$('divID').css('width');`
类似的高度

# c++ - “预期的类名”...析构函数实现中的问题

> ID：14777533
> 
> 赞同：4
> 
> 时间：2013-02-08T16:56:47.280
> 
> 标签：c++, class, linked-list, stack, destructor

我正在尝试实现堆栈和队列。我还获得了一个代码来测试堆栈和队列（以查看它们各自的功能是否正常工作）。

我已经实现了堆栈和 quete 的功能，但是在尝试编译它们时出现错误： *在析构函数 `Stack::~Stack()' 中预期的类名在 '(' 标记之前*
。

以下是通用的 Stack 类：

```
template <class T>
class Stack
{
    List<T> list;
 public:

    Stack();

    Stack(const Stack<T>& otherStack);

   ~Stack();
} 
```

列表类：

```
template <class T>
class List
{
    ListItem<T> *head;

    public:

    List();

    List(const List<T>& otherList);

    ~List();
} 
```

现在 List 类的析构函数工作得很好。所以请记住这一点，我对析构函数的实现是：

```
template <class T>
Stack<T>::~Stack()
{

                 list.~List();
} 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T16:59:18.127

您应该（几乎）永远不要显式调用析构函数。当你`Stack`的生命结束时，它会自动调用其成员的析构函数。你不需要做任何事情。`list`会自动销毁。

如果你有一个指向`p`动态分配对象的指针，作为成员，*那么*你需要在析构函数中做一些清理工作`delete p;`。但在这里，你没有。`list`会自动销毁。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-08T17:02:11.790

Your `list` member is an automatic variable. Its lifetime (the time when its constructor and destructor are callled) is managed by the language. As soon as the containing object goes out of scope, the `List` destructor will be called.

That said, there are valid reasons to call a destructor explicitly (you don't have one and you rarely will) and to actually do it you need to specify the type correctly.

In your case that would be

```
list.~List<T>(); 
```

`List` itself is a template, not a type.

# tfs - TFS 文件必须保持锁定状态

> ID：14777535
> 
> 赞同：11
> 
> 时间：2013-02-08T16:56:58.277
> 
> 标签：tfs, tfvc

我将一些第 3 方 dll 检入 TFS
我们的机器已重命名，现在 TFS 认为它们已被我检出以供我在另一台机器上进行编辑。

我试过`tf lock /lock:none contrib64/* /workspace:oldmachine;myusername`了，但我得到了错误

`TF10152: The item $/XXX/YYYY/contrib64/third_party.dll must remain locked because its file type prevents multiple check-outs.`

1、有没有办法解决这个问题？
2，TFS真的这么糟糕还是只是我？
3、TFS的目的是让我们怀念VSS吗？

ps 这是一个托管版本，所以我不能让管理员修复它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-08T17:22:01.077

取消锁定对这些文件不起作用，因为它们是二进制文件，因为无法合并二进制文件，如果它们被签出，它们必须被锁定。

由于工作区所在的机器不再存在（机器已重命名），最好的办法是删除工作区。

从 Visual Studio 命令提示符

`tf workspace /delete oldmachine;myusername /collection:http://*tfsserver*:8080/tfs/*collection*`

这将删除工作区并撤消所有待处理的更改

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-11-20T10:18:25.730

如果您不想删除工作区，您可以撤消更改并在此之后解锁文件：

使用 Visual Studio 开发人员命令提示符：

`tf undo "$/<server-path-to-file/folder>" /workspace:"<workspace>;<user>" /collection:<collection-url> /recursive`

`tf lock "$/<server-path-to-file/folder>" /lock:none /workspace:"<workspace>;<user>" /collection:<collection-url> /recursive`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-08-25T12:42:22.687

具有 .dll 扩展名的文件以及 .exe、.doc、.docx 等其他扩展名的文件会自动锁定，因为（如前所述）它们无法合并。

如果您想禁用自动锁定并允许这些文件通过门控签入，请按照以下步骤操作：

1.  登录到您的构建服务器。
2.  打开视觉工作室。
3.  在团队资源管理器中，登录您的团队项目。
4.  前往设置”。
5.  在“团队项目集合”下，选择“源代码管理”。
6.  对于您不想被自动锁定的任何文件扩展名，将“文件合并”属性设置为“禁用”。

参考：[https ://blogs.msdn.microsoft.com/phkelley/2008/11/12/everything-you-ever-wanted-to-know-about-locks/](https://blogs.msdn.microsoft.com/phkelley/2008/11/12/everything-you-ever-wanted-to-know-about-locks/)

这对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-13T18:44:46.550

我需要在 2 个地方更改设置：

1.  在 Visual Studio 的团队项目窗口中，设置 -> 团队项目集合 -> 源代码管理 [![在此处输入图像描述](../Images/77d7808f873631182478ad5ebcad19c8.png)](https://i.stack.imgur.com/5CXS0.png) 为扩展启用文件合并。

2）在Visual Studio，团队项目窗口，设置->团队项目->源代码控制 [![在此处输入图像描述](../Images/85b71e67caa23811074cbaa4fcbdbc62.png)](https://i.stack.imgur.com/MH6Rq.png) 启用多个签出框

# php - div文本没有用css正确定位？

> ID：14777539
> 
> 赞同：0
> 
> 时间：2013-02-08T16:57:13.437
> 
> 标签：php, css, html

嗨，有人能帮帮我吗，我的电脑让我发疯了，它昨天还在工作，现在不行了，我也在我的电脑上试过，在不同的浏览器上没有任何东西可以解决这个问题。

基本上我有一个新闻板，其中包含从 mysql 中提取的新闻提要。

我试图将文本包含在一个名为“news_feeds_board_text”的 div 中，以便我可以按我的意愿定位它。

无论我给这个文本提供什么宽度或填充，它仍然会溢出到右侧。

请有人可以告诉我我哪里出错了，非常感谢。

例如，而不是看起来像我想要的那样：

```
The Cat Sat on the 
Fence and licked 
itself over and 
over again. 
```

它这样做：

```
The Cat Sat on the Fence and licked itself over and over again. 
```

它溢出新闻板，我不知道为什么。我知道这是一个 CSS 问题，但我不知道怎么做？

下面是我的 div 是如何用 php 布局的：

```
<?php
        $social_feeds_set = get_social_feeds_set();
        while ($feeds = mysql_fetch_array($social_feeds_set)) {

?>

        <div class="socialcase" id="socialcase">
        <div class="socialcase_top"></div>
             <div class="socialcase_img">
             <?php echo "<a href=\"profile.php?id={$feeds['user_id']}\"><img width=\"60px\" height=\"60px\" src=\"data/photos/{$feeds['user_id']}/_default.jpg\" /></a>";?></div>

             <div class="social-text">
             <?php echo "{$feeds['display_name']}"; ?> says:<br/><br/><?php echo "{$feeds['content']}"; ?> 
          </div>
         </div>

         <? } ?>
 <div class="board-wall-feeds">        
<div class="social_header">
<?php echo "$profile[2]" ?>'s News & Updates:
</div>        

 <?php
        $social_news_board = social_news_board();
        while ($news = mysql_fetch_array($social_news_board)) { ?>

        <div class="news_feeds_board">
        <div class="social_clip"></div>
        <div class="news_feeds_board_text"><? echo "{$news['content']}";  ?></div>

        <div class="social_footer">

        <?
        $datetime1 = new DateTime();
        $datetime2 = new DateTime ($news['date_added']);
        $interval = $datetime1->diff($datetime2);
        $mdhms = explode('-',$interval->format('%m-%d-%H-%i-%s'));

$labels = Array(' months', ' days', ' hours', ' minutes', ' seconds');
$i = 0;
foreach($mdhms as $t){
  if($t > 0) break;
  $i+=1;
}
        echo "about ".$t.$labels[$i]." ago"; ?></div></div>
        <? } ?>

</div> 
```

这是只能导致问题的 div 的 css：

```
.board-wall-feeds {
    text-align: left;
    font-family: Arial;
    font-size: 12px;
    color: #6d6d6d;
    background: #fff;
    border: 1px solid #e6e6e6;
    padding: 20px 15px 20px 15px;
    margin-top:0px;
    margin-left:275px;
    -moz-box-shadow: 2px 3px 2px #d6d6d6;
    -webkit-box-shadow: 2px 3px 2px #d6d6d6;
    box-shadow: 2px 3px 2px #d6d6d6;
    display: block;
    width:300px;
    height:400px;
    position:absolute;
    z-index:10;
    padding-top:15px;
    overflow:hidden;

}

.news_feeds_board {
    width:301px;
    min-height:50px;
background: #ffffff;
border-top:1px dashed #ccc;
border-bottom:1px dashed #ccc;
float:right;
position:relative;
z-index:99;
margin-right:0px;

}

.news_feeds_board_text {
    padding-left:0px;
padding-right:20px;
padding-bottom:20px;
padding-top:20px;
color:#666;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:04:11.363

您的 CSS 没有任何问题。唯一可能影响您在代码中显示文本的是：`{$news['content']}`。您从中获得的价值是什么`{$news['content']}`？如果它包含
那么你应该删除它们，你的问题就会得到解决。另一种确认你的 CSS 没有问题的方法是放在`{$news['content']}`文档的开头

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:20:42.947

同意shnisaka。我发现没有任何 CSS 问题会产生您所看到的内容。

尝试`{$news['content']}`用健康的 lorem ipsum 块替换您的内容，以测试它是从 MySQL 还是从 CSS 返回的内容。

# powershell - 使用 OnTap cmdlet 从 SSIS 运行 Powershell 脚本会引发错误，但从 PS Cmd Line 运行时不会？

> ID：14777540
> 
> 赞同：0
> 
> 时间：2013-02-08T16:57:18.927
> 
> 标签：powershell, ssis

我们正在尝试从 SSIS 运行使用 OnTap PS 模块的 Poweshell 脚本，当我们这样做时，会发出错误：

错误：术语“Connect-NaController”未被识别为 cmdlet、函数、脚本文件或可运行程序的名称。检查名称的拼写，或者如果包含路径，请验证路径是否正确并重试。

但是当我们从 Powershell 命令行运行相同的脚本时，脚本运行得很好。所以我认为剧本很好。

所以我想知道安全上下文是否不同，或者我们必须在 SSIS 的调用中更明确地做一些事情？

当我们从 SSIS 调用脚本时，我们使用：-ExecutionPolicy ByPass

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T18:11:54.753

在 SSIS 中，我必须设置脚本的完整路径而不是 ./scriptfile

# c# - 具有可选值和参数值的 C# 函数

> ID：14777541
> 
> 赞同：2
> 
> 时间：2013-02-08T16:57:24.620
> 
> 标签：c#, function, overloading

我有这个测试代码：

```
 void func1(string a, params string[] p)
    {
        func1(a, true, p);
    }

    void func1(string a, bool b, params string[] p)
    {
        //...
    }

    void func2(string a, bool b = true, params string[] p)
    {
        //...
    }

    void exec()
    {
        func1("a", "p1", "p2");
        func2("a", "p1", "p2");
    } 
```

是`func1`和`func2`等于？

创建时没有错误`func2`，但是，当我尝试`func2`在 exec 中使用 like （使用可选值）时，编译器会显示错误`This function has some invalid arguments`。

我认为这对于像 API 一样使用这个函数的人来说是平等的`func1`。`func2`

这段代码有什么问题？我可以将此方法用于具有可选和参数值的函数吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-08T17:00:56.217

Normally optional parameters have to come at the end of a method declaration - a parameter array (such as `p` here) is the only exception to that. But when it comes to using the *arguments*, the compiler will assume that all positional arguments are in the same order as the method declaration... so you get into trouble if you want to use the optionality *and* the parameter array side. This should be okay:

```
func2("a", p: new[] { "p1", "p2" }) 
```

but personally I'd just steer clear of mixing parameter arrays and optional parameters. It's clearly confusing.

I believe the relevant section of the C# 5 specification is 7.5.1.1, which includes:

> A positional argument of a function member with a parameter array invoked in its expanded form, where no fixed parameter occurs at the same position in the parameter list, corresponds to an element of the parameter array.

See also section 7.5.3.1\. It's all pretty complicated...

# python - 用openCV和python检测对象

> ID：14777545
> 
> 赞同：3
> 
> 时间：2013-02-08T16:57:36.197
> 
> 标签：python, image-processing, opencv, object-detection

我正在尝试使用 OpenCV 和 Python 检测下图中的白点。

![在此处输入图像描述](../Images/db58d7cf1479e33bd638c7e6da6117e9.png)

我尝试使用函数 cv2.HoughCircles 但没有任何成功。

我需要使用不同的方法吗？

这是我的代码：

```
import cv2, cv
import numpy as np
import sys

if len(sys.argv)>1:
    filename = sys.argv[1]
else:
    filename = 'p.png'

img_gray = cv2.imread(filename,cv2.CV_LOAD_IMAGE_GRAYSCALE)

if img_gray==None:
    print "cannot open ",filename

else:
    img = cv2.GaussianBlur(img_gray, (0,0), 2)
    cimg = cv2.cvtColor(img,cv2.COLOR_GRAY2BGR)
    circles = cv2.HoughCircles(img,cv2.cv.CV_HOUGH_GRADIENT,4,10,param1=200,param2=100,minRadius=3,maxRadius=100)
if circles:
    circles = np.uint16(np.around(circles))
    for i in circles[0,:]:
        cv2.circle(cimg,(i[0],i[1]),i[2],(0,255,0),1) 
        cv2.circle(cimg,(i[0],i[1]),2,(0,0,255),3)   

cv2.imshow('detected circles',cimg)
cv2.waitKey(0)
cv2.destroyAllWindows() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:26:13.177

如果您可以在 OpenCV 中重现形态重建，则可以轻松构建 h-dome 变换，从而显着简化任务。否则，高斯滤波的简单阈值也可能就足够了。

![在此处输入图像描述](../Images/46a563d92d47ef8c248ff02b6b25ca54.png)

`Binarize[FillingTransform[GaussianFilter[f, 2], 0.4, Padding -> 1]]`

在上面的代码中进行了高斯滤波，以有效抑制输入边界周围的噪声，否则在 h-dome 变换后会保留。

接下来是高斯滤波后的一个简单阈值的结果`Binarize[GaussianFilter[f, 2], 0.5]`( "（这不再是一种新方法，它是从 1985 年开始的））：

![在此处输入图像描述](../Images/27fecb3b1b1a7070a845bc1a89e50dc9.png) ![在此处输入图像描述](../Images/72bc55ef962b9cd7c8be5b391c0d75f9.png)

上图的右图在整个边界上都有很多小点（在这个图像分辨率下看不到），但是是全自动的。在这 3 个选项中，OpenCV 中仅存在第二个选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:25:21.243

我认为中值滤波器会改善你的形象。尝试使用一些内核，3x3 或 7x7。然后，一些（本地）阈值算法将为您提供形状。您可以使用 HoughCircles，也可以只找到轮廓并检查它们的圆度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T17:25:55.873

使用合适的阈值技术将图像转换为二进制图像（Otsu 可能会有所帮助）。然后使用腐蚀等形态学操作使圆变小，然后您可以轻松找到它们的中心。

# imageview - 级联：带有外部源的 ImageView

> ID：14777546
> 
> 赞同：0
> 
> 时间：2013-02-08T16:57:37.133
> 
> 标签：imageview, blackberry-10

我需要加载带有外部源的 ImageView ( [http://www.example.com/some_image.jpg](http://www.example.com/some_image.jpg) )。

我尝试使用[ImageTracker](https://developer.blackberry.com/cascades/reference/bb__cascades__imagetracker.html)，但不起作用

总之感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T08:01:49.200

这还不支持 - [https://developer.blackberry.com/cascades/download/roadmap/](https://developer.blackberry.com/cascades/download/roadmap/)

作为一种解决方法，您可以将图像保存到文件并从那里加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-19T23:21:01.933

我建议在[WebView中显示图像](http://developer.blackberry.com/native/reference/cascades/bb__cascades__webview.html)

祝你好运

# sql - 使用存储过程查找文件名

> ID：14777548
> 
> 赞同：1
> 
> 时间：2013-02-08T16:57:48.480
> 
> 标签：sql, sql-server-2008-r2

我正在尝试自动化一个将更新我的 SQL Server 2008 R2 数据库中的表的过程。

我从客户端获取 csv 格式的文件，其中包含大约 20 列数据。当文件位于特定文件夹中时，我需要将文件导入数据库中的表中。如果它在那里，我需要进行导入，然后将文件从基本文件夹移动到一个`Processed`文件夹。

我已经完成了导入例程来删除原始表，创建一个新表，并将数据导入表中。

我已经搜索了如何确定具有特定扩展名的特定文件夹中的文件名，但没有找到任何可以帮助我的东西。

我还尝试移动文件（独立于存储过程），我想我遗漏了一些东西。这是我尝试但没有成功的方法：

```
 declare @sql varchar (100)
    set @sql = 'move E:\Data\check.csv E:\Data\Processed\ /Y'
    exec master..xp_cmdshell @SQL, NO_OUTPUT 
    go 
```

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:11:20.507

我编写了以下存储过程来列出给定路径中的文件：

```
ALTER procedure [dbo].[usp__ListFiles_xml] (
    @path varchar(8000),
    @xmldata xml output
)
as
begin
    DECLARE @ProcName varchar(255) = OBJECT_NAME(@@PROCID);

    declare @DirLines table (
        RowNum int identity(1,1) not null,
        line varchar(8000)
    );

    declare @DirCommand varchar(8000) = 'dir /A:-D /n "'+@path+'"';

    insert into @DirLines
        exec xp_cmdshell @DirCOmmand;

    declare @DirName varchar(8000) = (select SUBSTRING(line, 15, 8000) from @DirLines where RowNum = 4);

    delete from @DirLines
    where line is null or isnumeric(LEFT(line, 2)) = 0;

    set @xmldata = (
        select substring(line, 40, 255) as FileName,
               cast(replace(substring(line, 21, 18), ',', '') as bigint) as FileSize,
               cast(left(line, 20) as DateTime) as CreationDateTime,
               @DirName as DirName
        from @DirLines
        for xml raw('Dir'), type
       )

    return;
end;  -- usp__ListFiles_xml 
```

您可以将结果选择到表中，找到所需的文件，然后通过执行以下操作从那里继续加载：

```
declare @xmldata xml;

exec usp__ListFiles_xml @FileTemplate, @xmldata output;

declare @Files table (
     FileName varchar(255),
     FileSize bigint,
     CreationDateTime DateTime,
     DirName varchar(8000)
    );
insert into @Files
    select T.c.value('@FileName', 'varchar(255)') as FileName,
           T.c.value('@FileSize', 'bigint') as FileSize,
           T.c.value('@CreationDateTime', 'datetime') as CreationDateTime,
           T.c.value('@DirName', 'varchar(8000)') as DirName
    from @xmldata.nodes('Dir') as T(c); 
```

# shell - 当我在终端 vim 中执行 :sh 时，它会退出 macvim

> ID：14777551
> 
> 赞同：0
> 
> 时间：2013-02-08T16:57:58.493
> 
> 标签：shell, macvim

我想在终端的 macvim 会话中执行 :sh 来做一些快速的事情。当我在 GUI 应用程序中（不在终端中）时，它可以完美运行。但是，当我在终端中运行它时，它会退出 macvim，并在常规终端中执行命令。

我怎样才能防止这种情况，并让它像 GUI 版本一样执行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:26:09.133

shell 作为`vim`. 只需退出 shell，您应该返回`vim`会话。

# javascript - 单击链接时突出 显示输入内的文本

> ID：14777552
> 
> 赞同：0
> 
> 时间：2013-02-08T16:58:11.017
> 
> 标签：javascript, focus, highlighting

我有这个可点击的链接，

`<a href="#" id="link">Clickable Link</a>`

我有这个`<input>`，点击链接后会出来，

```
<input id="geo_title" type="text" value="some value" class="geo_title" style="display:none" /> 
```

在我的剧本中，

```
$('#link').click(function(){
    $("input#geo_title").focus();
}); 
```

但遗憾的是，这并没有集中元素。我想要的是，在我单击链接后，将突出显示 的`value`属性，`<input>`而我不必单击元素就可以输入内容。我错过了什么？非常感谢您的帮助。谢谢。

注意：实际代码。我已经有另一个这样的活动

```
$('#link').live('click',function(){
        $(this).hide();
        $('span.title').hide();
        $('#geo_title').removeAttr('style').removeClass('active_geo_title').css({'padding-top':'10px','padding-bottom':'10px','padding-right':'10px','width':'120%'});

        $("input#geo_title").select();

        return false;
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T18:08:02.187

尝试这个：

```
$('#link').click(function() {
    $(this).hide();
    $('.title').hide();
    $("#geo_title").css({
        'padding-top': '10px',
        'padding-bottom': '10px',
        'padding-right': '10px',
        'width': '120%',
        'display' : 'block'
    });
    $('#geo_title').select();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:06:00.767

改为使用`.select()`。

```
$('#link').click(function(){
    $("#geo_title").select();
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/fVfCr/1/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T19:24:53.923

我希望这真的没有希望，但后来有人给了我一个使用触发器的提示。所以我写了这个，

`$('#geo_title).click(function(){ this.select(); });`

在我使用的另一个事件中，`.live()`我调用上面的代码以便触发它。所以我的最终代码是，

```
$('#link').live('click', function () {
$(this).hide();
$('span.title').hide();
$('#geo_title').removeAttr('style').removeClass('active_geo_title').css({
    'padding-top': '10px',
    'padding-bottom': '10px',
    'padding-right': '10px',
    'width': '120%'
});

$("#geo_title").click();

return false;
});

$('#geo_title').click(function(){
    this.select();
}); 
```

非常感谢你们！

# fft - fttw3 创建 2D 计划部分失败

> ID：14777557
> 
> 赞同：2
> 
> 时间：2013-02-08T16:58:30.580
> 
> 标签：fft, fftw

我对 FastFourier 有疑问...（FFTW3）

100x100 样本的数据 > 使用 FFTW3 转换为复杂频域，稍后我想使用反向转换

远期计划：

```
fftw_plan fftw_plan_dft_r2c_2d(int n0, int n1,
                                double *in, fftw_complex *out,
                                unsigned flags); 
```

逆看起来就像这样

```
fftw_plan fftw_plan_dft_c2r_2d(int n0, int n1,
                                fftw_complex *in, double *out,
                                unsigned flags); 
```

这是我的代码：

```
int ncols = 100;  // a 100x100 picture
int nrows = 100; 
int nccols = ncols/2+1; 
```

// 必须根据 // [http://www.fftw.org/doc/Multi_002dDimensional-DFTs-of-Real-Data.html分配复合体 n/2+1](http://www.fftw.org/doc/Multi_002dDimensional-DFTs-of-Real-Data.html)

```
double * Aa = (double*)fftw_malloc(sizeof(double)*ncols*nrows);
fftw_complex * Af = (fftw_complex*)fftw_malloc(sizeof(fftw_complex)*nccols*nrows);
double * Ba = (double*)fftw_malloc(sizeof(double)*ncols*nrows); 
fftw_complex * Bf = (fftw_complex*)fftw_malloc(sizeof(fftw_complex)*nccols*nrows);
double * Bc = (double*)fftw_malloc(sizeof(double)*ncols*nrows); 

fftw_plan forwardA = fftw_plan_dft_r2c_2d(nrows,ncols,Aa,Af,FFTW_FORWARD | FFTW_ESTIMATE); 
fftw_plan backwardA = fftw_plan_dft_c2r_2d(nrows,ncols,Af,Aa,FFTW_BACKWARD | FFTW_ESTIMATE); 
fftw_plan forwardB = fftw_plan_dft_r2c_2d(nrows,ncols,Ba,Bf,FFTW_FORWARD | FFTW_ESTIMATE); 
fftw_plan backwardB = fftw_plan_dft_c2r_2d(nrows,ncols,Bf,Bc,FFTW_BACKWARD | FFTW_ESTIMATE); 
```

这与此处的代码完全相同：[http ://werner.yellowcouch.org/Papers/subimg/index.html](http://werner.yellowcouch.org/Papers/subimg/index.html)

我现在的问题是 forwardA 和 forwardB 指向 0x0 而backwardA 和 backwardB 是有效的。

关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T00:08:24.583

尝试这个：

```
fftw_plan forwardA = fftw_plan_dft_r2c_2d(nrows,ncols,Aa,Af,FFTW_ESTIMATE); 
```

那应该工作。

# frameworks - 如何使用 LinkTo 和 HandelBars 链接到外部 URL

> ID：14777560
> 
> 赞同：21
> 
> 时间：2013-02-08T16:58:34.790
> 
> 标签：frameworks, web, ember.js, handlebars.js

我目前开始学习使用 Ember.js 进行 Web 应用程序开发。目前有一些非常基本的东西我还没有实现。链接到外部 URL，例如 www.google.com 或其他。这就是我所拥有的：

HTML

```
<body>
    <script type="text/x-handlebars">
    <div>
      Hello, <strong>{{firstName}} {{lastName}}</strong>!
    </div>

      {{#linkTo google}}Google{{/linkTo}}

    </script>
</body>

$(document).ready(function() {

//alert("HELLO WORLD");
window.App = Ember.Application.create();

App.ApplicationController = Ember.Controller.extend({
    firstName: "Trek",
    lastName: "Glowacki",
    googleURL: "www.google.com/ncr"
});

App.Router.map(function() {
    this.route("google", {
        path: "www.google.com"
    });

}); 
```

});

当链接呈现时它确实有效，但它会转到以下地址：E:/EMBERJS/index.html#/www.google.com

任何提示将不胜感激。我不敢相信我自己没有弄清楚这一点，但一点点外部帮助不会受到伤害。

问候，

牛

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-02-08T17:15:36.583

您不想为此使用`linkTo`助手。帮助器用于在您的`linkTo`Ember.JS 应用程序中转换到其他状态，而您正试图将人们从您的应用程序中移开。

您可以使用两种方法：

1.  这会将您绑定`targetUrl`到您的锚点，但如果 URL 更改，它将不会更新。

      `<a target="_blank" href="{{unbound view.targetUrl}}">Google</a>`

2.  `targetUrl`下一种方法将绑定到锚点，如果您更新对象的属性，它将相应地更新该锚点：

    `<a target="_blank" {{bindAttr href="view.targetUrl"}}>Google</a>`

这是给你的 JSFiddle：http: [//jsfiddle.net/zscff/](http://jsfiddle.net/zscff/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-03T08:34:31.587

如前所述，您不需要使用**链接到**帮助程序。你只需要使用简单的锚标签`<a> </a>`。

我只是有同样的问题。为了解决这个问题，你只需要小心锚标签。
例如，如果您像这样输入链接 `<a href='www.example.com'> example </a>`，Ember 将生成以下链接
**localhost:4200/www.example.com**

但是，如果您将 http，添加到 href 属性，则一切正常。
`<a href='http://www.example.com'> example </a>`.
输出是**www.example.com**

希望能帮助到你。

# ios - 通过 AS3 让原生振动在 iOS 上工作

> ID：14777563
> 
> 赞同：1
> 
> 时间：2013-02-08T16:58:41.937
> 
> 标签：ios, actionscript-3, air, flash-cs6, vibration

我一直在查看文档，对于如何导入振动插件的扩展有点困惑。[http://www.adobe.com/devnet/air/native-extensions-for-air/extensions/vibration.html](http://www.adobe.com/devnet/air/native-extensions-for-air/extensions/vibration.html)说明说我需要搞乱 Xcode，但我认为 Adob​​e AIR 的重点是你不要不需要乱用 Xcode；这真的很令人费解。我究竟如何导入类和文件，以便可以在 AS3 中使用提供的代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T17:04:38.303

阅读这篇文章：[振动原生扩展示例](http://www.adobe.com/devnet/air/native-extensions-for-air/extensions/vibration.html)

点击这个链接：[振动下载](http://download.macromedia.com/pub/developer/air/ane/Vibration.zip)

并在任何地方解压缩。

单击文件-ActionScript 3.0 设置

链接到（在 ReadyToUseExtension 中）**VibrationActionScriptLibrary.swc**，**com.adobe.extensions.Vibration.ane**

![在此处输入图像描述](../Images/b8542af8f645d86ec0d2abaf43f73616.png)

在模拟器中未编译。因为 MacOS-x86 不支持请求的扩展 com.adobe.Vibration。

```
import com.adobe.nativeExtensions.Vibration;

var vibe:Vibration;
if (Vibration.isSupported)
{
    vibe = new Vibration();
    vibe.vibrate(2000);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:22:24.557

使用目录中的文件`ReadyToUseExtension`，将预打包的 .ane 文件添加到您的项目中，如[本教程中所示](http://www.adobe.com/devnet/air/articles/using-ane-in-flash.html)。

# jquery - 如何在 jquery 中使用 $(this) 对子元素应用函数

> ID：14777567
> 
> 赞同：0
> 
> 时间：2013-02-08T16:58:57.150
> 
> 标签：jquery

我基本上是在尝试在 jQuery 中应用向下滑动导航。我使用这段代码：

```
<script>
    $(document).ready(function() {
        $(".menu").hover(function(){
            $(".submenu").animate({ height: 'show', opacity: 'show' }, 'slow');
        }, function(){
            $(".submenu").animate({ height: 'hide', opacity: 'hide' }, 'slow');
        });
    });
</script> 
```

但是当我将鼠标悬停在一个`.menu`div 上时，所有的`.submenu`div 都会向下滑动。所以我尝试使用`$(this)`. 但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:01:02.960

You need to use `this` as a context to search for the `.submenu` element within, like this:

```
$(document).ready(function() {
    $(".menu").hover(function(){
        $(".submenu", this).animate({ height: 'show', opacity: 'show' }, 'slow');
    }, function(){
        $(".submenu", this).animate({ height: 'hide', opacity: 'hide' }, 'slow');
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:00:16.263

如今，您想像这样绑定事件：

```
 $(document.body).on({
       mouseover : function(e) {
             $(this).find(".submenu")...
         },
       mouseout  : function (e) {
            //...
          }
       //,...
     },".menu"); 
```

# php - 将参数传递给 Javascript - 使用 2，使用 3 中断

> ID：14777571
> 
> 赞同：0
> 
> 时间：2013-02-08T16:59:13.680
> 
> 标签：php, javascript, html

我正在开发一个“添加到购物车”按钮，它将商品的 ID 和数量传递给 Javascript 函数。该函数处理这些值，创建一个临时表单来发布这些值，然后重新加载产品页面，并将 ?AddItem 添加到 url。

这是工作代码：

```
 function submitItem( ID, Code)
{
    alert("Submission received"); //--This is being triggered
    var toCart, inputA, inputB, quantity;

    quantity = Code.value;

    // Create form
    toCart = document.createElement( 'form' );
    toCart.action = " &AddItem";
    toCart.method = 'post';

    //Rest of the code excutes as normal
} 
```

我的产品页面是动态加载的，因此类别的 url 将是 blah.com/products.php?cat=FOO，但 AddItem 删除了 cat= 子句，因此加载了一个空白页面。为了避免这种情况，我尝试将类别前缀 (FOO) 传递给 javascript，但添加第三个参数会破坏它。

这是我的新代码：

```
function submitItemCat( ID, Code, Category )
{
    alert("Submission received"); //--This is not being triggered
    var toCart, inputA, inputB, quantity;

    quantity = Code.value;

    // Create form
    toCart = document.createElement( 'form' );
    toCart.action = " &AddItem"+ Category; //--This is were I amend the URL
    toCart.method = 'post';

    //Rest of the code
} 
```

和html中的函数调用

```
$jsCat = json_encode($_GET["cat"]); // This is FOO

echo'
<div id= "QuantBox">
    <label for="Quantity">'.$catPrefix.'</label>
    <input type = "text"  name= "Quantity" id= "Q'.$row["StockCode"].'" value="1">
    <a 
        class= "AddToCart" 
        onclick= "submitItemCat( '.$row["StockID"].', Q'.$row["StockCode"].', '.$jsCat.' )" >
    </a>
</div>'; 
```

我也尝试将第三个变量传递为 "FOO", $_GET["cat"] 但它们都不起作用。非常感谢任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:01:46.297

You're probably missing quotes.

A quick fix would be

```
 onclick= "submitItemCat( \"'.$row["StockID"].'\", \"Q'.$row["StockCode"].'\", \"'.$jsCat.'\" )" > 
```

but this is horrible. Personally I'd refactor the code in order to avoid the building of inline javascript from PHP, for example by generating a clean javascript script with variable declared as

```
<script>
  var theid = '<?php echo $row["StockID"] ?>';
  ...
</script> 
```

# javascript - XMLHttpRequest 无法加载 Origin 不允许 Access-Control-Allow-Origin

> ID：14777576
> 
> 赞同：6
> 
> 时间：2013-02-08T16:59:30.623
> 
> 标签：javascript, ajax, google-chrome, xmlhttprequest

我正在尝试通过 xhr 获取 http:// javascript 文件，但遇到了上述错误。

这是我的代码：

```
function getXHR() {
    var is_chrome = navigator.userAgent.toLowerCase().indexOf('chrome') > -1;

    if (is_chrome) {
    var xhr = new XMLHttpRequest();
    xhr.open("GET", "http://api.widgets.org/widget/1.1.2/widget_api.js?autoCreate=false&log=true", true);
    xhr.onreadystatechange = function() {
    if (xhr.readyState == 4) {
        var s = document.createElement('script');
        s.textContent = xhr.responseText;
        (document.head||document.documentElement).appendChild(s);
        s.parentNode.removeChild(s);
        }
    }
    xhr.send();
    }
} 
```

这仅适用于 Chrome，因为我想在 https:// 中使用脚本，但 Chrome 会自动阻止来自 http:// 的任何内容。我从中获取脚本的服务器没有运行 https:// 并且我需要脚本/有多个脚本我宁愿不要全部复制到数据文件中。

我遇到的错误：

```
XMLHttpRequest cannot load http://api.widgets.org/widget/1.1.2/widget_api.js?autoCreate=false&log=true. Origin https://mysite.com is not allowed by Access-Control-Allow-Origin. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T17:03:45.497

只需`<script>`直接插入标签而不是这个 XHR 包装器，然后将内容插入`<script>` 标签。

```
function getScript() {
    var is_chrome = navigator.userAgent.toLowerCase().indexOf('chrome') > -1;

    if (is_chrome) {
        // generate script element and set its source
        var s = document.createElement('script');
        s.src = "http://api.widgets.org/widget/1.1.2/widget_api.js?autoCreate=false&log=true";
        // remove the script element after loading
        s.addEventListener( 'load', function(){ s.parentNode.removeChild(s); } );
        (document.head||document.documentElement).appendChild(s);
    }
} 
```

此外，我不知道为什么您在加载后尝试删除脚本元素。这不会影响在该代码中创建的任何对象/方法/变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-06T18:59:27.400

我将服务器文件的完整路径更改为短路径，如下所示。

```
$.post('http://example.com/pages/loadRandomImages.php',{'type':'loadRandomImages','loadingReq':'True'},function(data){

------------
----------
}); 
```

改为，

```
$.post('/pages/loadRandomImages.php',{'type':'loadRandomImages','loadingReq':'True'},function(data){

------------
----------
}); 
```

然后在chrome中工作得很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T17:05:13.980

出于与跨站点脚本相关的安全目的，浏览器阻止向与发出请求的页面服务器不同的服务器发出的 XHR 请求。

如果它只是您要加载的脚本，请使用

```
<script src="..."></script> 
```

一般的 XHR 可以使用 jsonp 变通方法，如果 api 提供的话，或者请求 API 的运营商开启 CORS（跨域资源共享）

[http://developer.chrome.com/extensions/xhr.html](http://developer.chrome.com/extensions/xhr.html) [https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS](https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS) [http://www.w3.org/TR/cors/](http://www.w3.org/TR/cors/) [http: //en.wikipedia.org/wiki/JSONP](http://en.wikipedia.org/wiki/JSONP)

# regex - 如何为每两个逗号组创建一个替换正则表达式？

> ID：14777582
> 
> 赞同：-1
> 
> 时间：2013-02-08T16:59:36.883
> 
> 标签：regex, perl

这是我的表达：

((.)*(,)){2}

这是输入：

```
1231,3453453,ewrtewrt,wertwe,rwewer,werewrwe 
```

我想要的预期输出是：

```
1231,3453453,
ewrtewrt,wertwe,
rwewer,werewrwe 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T17:07:03.640

而不是正则表达式，您应该只用逗号（或任何您预期的分隔符）分隔。然后遍历项目并每两个项目添加换行符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T17:10:17.157

```
=$ perl -e 'my $q = q{1231,3453453,ewrtewrt,wertwe,rwewer,werewrwe}; $q =~ s/((?:[^,]*,){2})/$1\n/g; print $q'
1231,3453453,
ewrtewrt,wertwe,
rwewer,werewrwe 
```

那就是正则表达式是：

```
s/((?:[^,]*,){2})/$1\n/g 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T17:41:53.967

这是一个计算逗号并在每隔一个处插入换行符的解决方案：

```
perl -plwe's/,\K/++$i % 2 || "\n"/eg' 
```

也就是说，找到一个逗号，保留它 ( `\K`) 并插入一个评估字符串。迭代器`$i`将是每隔一个逗号，所以表达式返回一个换行符，否则什么都没有。正则表达式是：

```
s/,\K/++$i % 2 || "\n"/eg 
```

它确实需要一个计数变量，这可能是一个缺点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-08T18:07:21.440

```
s/(,[^,]*,)/$1\n/g 
```

[在这里](http://ideone.com/NoTbg4)测试

# ruby-on-rails - 如何正确使用 before_save？

> ID：14777585
> 
> 赞同：-1
> 
> 时间：2013-02-08T16:59:53.423
> 
> 标签：ruby-on-rails, ruby-on-rails-3

如果我这样编码，我会收到语法错误。
我该如何解决？

```
before_save :handle_invitation_code, if: :just_confirmed

def just_confirmed?
  confirmed_at_changed? && confirmed_at_was.nil?
end

def handle_invitation_code
  ...
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:02:43.643

How about?

```
before_save :handle_invitation_code

def just_confirmed?
  confirmed_at_changed? && confirmed_at_was.nil?
end

def handle_invitation_code
  if self.just_confirmed?
  ...
  end
end 
```

Or you would have to pass the code in `just_confirmed?` as a Proc to the `before_save`.

# java - Android TextWatcher saving batches of similar changes for undo/redo

> ID：14777593
> 
> 赞同：1
> 
> 时间：2013-02-08T17:00:21.480
> 
> 标签：java, android, android-edittext, undo, textwatcher

I am trying to make snapshots of an EditText content everytime after a batch of similar changes made to it.

Like for example:

1.  when I do several consecutive deletes on consecutive/overlapping text this is a batch and I do a snapshot of the EditText content that results from this

2.  when I do several consecutive adds on consecutive/overlapping text this is a batch and I do a snapshot of the EditText content that results from this

3.  when I do several consecutive replaces (=modifys) on consecutive/overlapping text this is a batch and I do a snapshot of the EditText content that results from this

I hope you get the idea.

FYI: I need this for an undo/redo mechanism as I do not want/can make a snapshot EVERYTIME the text changes.

How can I achieve my goal?

The code that has failed was written because I though (before trying the code) that the conditions of the toplevel if statements would apply for deleting text / adding text / modifing text.

So how can I change this so that I have a cool text editor-like undo/redo mechanism backend?

```
editBigField.addTextChangedListener(new TextWatcher() {

      private static final int NONE = -1;
      private static final int DELETE = 0;
      private static final int ADD = 1;
      private static final int MODIFY = 2;

      private int lastAction = NONE;

      private int delete;

      private int addstart;
      private int addend;

      private int modstart;
      private int modend;

      @Override
      public void afterTextChanged(Editable s) {
      }

      @Override
      public void beforeTextChanged(CharSequence s, int start, int count, int after) {
        if (after == 0) // delete text
        {
          if (lastAction != DELETE || !(start <= delete && start + count - 1 >= delete)) {
            // save state here TODO
            lastAction = DELETE;
          }
          delete = start;
        }
        else if (count == 0 && after > 0) // add text
        {
          if (lastAction != ADD || !(start >= addstart - 1 && start <= addend)) {
            // save state here TODO
            lastAction = ADD;
          }
          addstart = start;
          addend = start + after;
        }
        else if (count != 0 && after > 0) // modify/replace text
        {
          if (lastAction != MODIFY || !(start + count - 1 >= modstart - 1 && start <= modend)) {
            // save state here TODO
            lastAction = MODIFY;
          }
          modstart = start;
          modend = start + after;
        }

      }

      @Override
      public void onTextChanged(CharSequence s, int start, int before, int count) {
      }

    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T12:07:23.610

也许有人还需要这个。批量撤消/重做实施：

```
public class UndoRedoHelper {
    private static final String TAG = UndoRedoHelper.class.getCanonicalName();
    private boolean mIsUndoOrRedo = false;

    private EditHistory mEditHistory;

    private EditTextChangeListener mChangeListener;

    private TextView mTextView;

    // =================================================================== //

    public UndoRedoHelper(TextView textView) {
        mTextView = textView;
        mEditHistory = new EditHistory();
        mChangeListener = new EditTextChangeListener();
        mTextView.addTextChangedListener(mChangeListener);
    }

    // =================================================================== //

    public void disconnect() {
        mTextView.removeTextChangedListener(mChangeListener);
    }

    public void setMaxHistorySize(int maxHistorySize) {
        mEditHistory.setMaxHistorySize(maxHistorySize);
    }

    public void clearHistory() {
        mEditHistory.clear();
    }

    public boolean getCanUndo() {
        return (mEditHistory.mmPosition > 0);
    }

    public void undo() {
        EditItem edit = mEditHistory.getPrevious();
        if (edit == null) {
            return;
        }

        Editable text = mTextView.getEditableText();
        int start = edit.mmStart;
        int end = start + (edit.mmAfter != null ? edit.mmAfter.length() : 0);

        mIsUndoOrRedo = true;
        text.replace(start, end, edit.mmBefore);
        mIsUndoOrRedo = false;

        for (Object o : text.getSpans(0, text.length(), UnderlineSpan.class)) {
            text.removeSpan(o);
        }

        Selection.setSelection(text, edit.mmBefore == null ? start : (start + edit.mmBefore.length()));
    }

    public boolean getCanRedo() {
        return (mEditHistory.mmPosition < mEditHistory.mmHistory.size());
    }

    public void redo() {
        EditItem edit = mEditHistory.getNext();
        if (edit == null) {
            return;
        }

        Editable text = mTextView.getEditableText();
        int start = edit.mmStart;
        int end = start + (edit.mmBefore != null ? edit.mmBefore.length() : 0);

        mIsUndoOrRedo = true;
        text.replace(start, end, edit.mmAfter);
        mIsUndoOrRedo = false;

        // This will get rid of underlines inserted when editor tries to come
        // up with a suggestion.
        for (Object o : text.getSpans(0, text.length(), UnderlineSpan.class)) {
            text.removeSpan(o);
        }

        Selection.setSelection(text, edit.mmAfter == null ? start
                : (start + edit.mmAfter.length()));
    }

    public void storePersistentState(Editor editor, String prefix) {
        // Store hash code of text in the editor so that we can check if the
        // editor contents has changed.
        editor.putString(prefix + ".hash",
                String.valueOf(mTextView.getText().toString().hashCode()));
        editor.putInt(prefix + ".maxSize", mEditHistory.mmMaxHistorySize);
        editor.putInt(prefix + ".position", mEditHistory.mmPosition);
        editor.putInt(prefix + ".size", mEditHistory.mmHistory.size());

        int i = 0;
        for (EditItem ei : mEditHistory.mmHistory) {
            String pre = prefix + "." + i;

            editor.putInt(pre + ".start", ei.mmStart);
            editor.putString(pre + ".before", ei.mmBefore.toString());
            editor.putString(pre + ".after", ei.mmAfter.toString());

            i++;
        }
    }

    public boolean restorePersistentState(SharedPreferences sp, String prefix)
            throws IllegalStateException {

        boolean ok = doRestorePersistentState(sp, prefix);
        if (!ok) {
            mEditHistory.clear();
        }

        return ok;
    }

    private boolean doRestorePersistentState(SharedPreferences sp, String prefix) {
        String hash = sp.getString(prefix + ".hash", null);
        if (hash == null) {
            // No state to be restored.
            return true;
        }

        if (Integer.valueOf(hash) != mTextView.getText().toString().hashCode()) {
            return false;
        }

        mEditHistory.clear();
        mEditHistory.mmMaxHistorySize = sp.getInt(prefix + ".maxSize", -1);

        int count = sp.getInt(prefix + ".size", -1);
        if (count == -1) {
            return false;
        }

        for (int i = 0; i < count; i++) {
            String pre = prefix + "." + i;

            int start = sp.getInt(pre + ".start", -1);
            String before = sp.getString(pre + ".before", null);
            String after = sp.getString(pre + ".after", null);

            if (start == -1 || before == null || after == null) {
                return false;
            }
            mEditHistory.add(new EditItem(start, before, after));
        }

        mEditHistory.mmPosition = sp.getInt(prefix + ".position", -1);
        if (mEditHistory.mmPosition == -1) {
            return false;
        }

        return true;
    }

    // =================================================================== //

    private final class EditHistory {
        private int mmPosition = 0;
        private int mmMaxHistorySize = -1;

        private final LinkedList<EditItem> mmHistory = new LinkedList<EditItem>();

        private void clear() {
            mmPosition = 0;
            mmHistory.clear();
        }

        private void add(EditItem item) {
            while (mmHistory.size() > mmPosition) {
                mmHistory.removeLast();
            }
            mmHistory.add(item);
            mmPosition++;

            if (mmMaxHistorySize >= 0) {
                trimHistory();
            }
        }

        private void setMaxHistorySize(int maxHistorySize) {
            mmMaxHistorySize = maxHistorySize;
            if (mmMaxHistorySize >= 0) {
                trimHistory();
            }
        }

        private void trimHistory() {
            while (mmHistory.size() > mmMaxHistorySize) {
                mmHistory.removeFirst();
                mmPosition--;
            }

            if (mmPosition < 0) {
                mmPosition = 0;
            }
        }

        private EditItem getCurrent() {
            if (mmPosition == 0) {
                return null;
            }
            return mmHistory.get(mmPosition - 1);
        }

        private EditItem getPrevious() {
            if (mmPosition == 0) {
                return null;
            }
            mmPosition--;
            return mmHistory.get(mmPosition);
        }

        private EditItem getNext() {
            if (mmPosition >= mmHistory.size()) {
                return null;
            }

            EditItem item = mmHistory.get(mmPosition);
            mmPosition++;
            return item;
        }
    }

    private final class EditItem {
        private int mmStart;
        private CharSequence mmBefore;
        private CharSequence mmAfter;

        public EditItem(int start, CharSequence before, CharSequence after) {
            mmStart = start;
            mmBefore = before;
            mmAfter = after;
        }

        @Override
        public String toString() {
            return "EditItem{" +
                    "mmStart=" + mmStart +
                    ", mmBefore=" + mmBefore +
                    ", mmAfter=" + mmAfter +
                    '}';
        }
    }

    enum ActionType {
        INSERT, DELETE, PASTE, NOT_DEF;
    }

    private final class EditTextChangeListener implements TextWatcher {
        private CharSequence mBeforeChange;
        private CharSequence mAfterChange;
        private ActionType lastActionType = ActionType.NOT_DEF;
        private long lastActionTime = 0;

        public void beforeTextChanged(CharSequence s, int start, int count, int after) {
            if (mIsUndoOrRedo) {
                return;
            }

            mBeforeChange = s.subSequence(start, start + count);
        }

        public void onTextChanged(CharSequence s, int start, int before, int count) {
            if (mIsUndoOrRedo) {
                return;
            }

            mAfterChange = s.subSequence(start, start + count);
            makeBatch(start);
        }

        private void makeBatch(int start) {
            ActionType at = getActionType();
            EditItem editItem = mEditHistory.getCurrent();
            if ((lastActionType != at || ActionType.PASTE == at || System.currentTimeMillis() - lastActionTime > 1000) || editItem == null) {
                mEditHistory.add(new EditItem(start, mBeforeChange, mAfterChange));
            } else {
                if (at == ActionType.DELETE) {
                    editItem.mmStart = start;
                    editItem.mmBefore = TextUtils.concat(mBeforeChange, editItem.mmBefore);
                } else {
                    editItem.mmAfter = TextUtils.concat(editItem.mmAfter, mAfterChange);
                }
            }
            lastActionType = at;
            lastActionTime = System.currentTimeMillis();
        }

        private ActionType getActionType() {
            if (!TextUtils.isEmpty(mBeforeChange) && TextUtils.isEmpty(mAfterChange)) {
                return ActionType.DELETE;
            } else if (TextUtils.isEmpty(mBeforeChange) && !TextUtils.isEmpty(mAfterChange)) {
                return ActionType.INSERT;
            } else {
                return ActionType.PASTE;
            }
        }

        public void afterTextChanged(Editable s) {
        }
    }
} 
```

# html - overlay image with single rgb transparent color in html5/css

> ID：14777595
> 
> 赞同：1
> 
> 时间：2013-02-08T17:00:25.093
> 
> 标签：html, css, html5-canvas

I would like to read a picture (gif color image) with a fixed background rgb color, say (0,0,0), into my html5 program, and overlay it on another image, with only that background color transparent. Note this background is not a fixed shape -- it is, for instance, the sky with a foreground bird flying across it. I just want to see the bird. I tried the following,

```
<div style="z-index: 100; position: absolute; top: 39px; left: 72pix; background-color: #ffffff; opacity: 0.5">

<img alt="overlay image" src="overlay.gif" WIDTH=32 HEIGHT=32></div></div> 
```

but this makes the whole overlay 0.5 transparent. I tried inserting this,

```
<div style="background: rgba(0,0,0,0.0)"></div> 
```

but this doesn't change the image rgb values, only sets the actual background around the image.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T18:47:57.060

仅使用 CSS/HTML 是无法做到这一点的。它将需要 SVG 或 JavaScript。类似问题的答案在[这里](https://stackoverflow.com/questions/11339496/set-specific-background-color-of-image-to-transparent-using-js)。

# c# - 重载转换运算符的转换规则

> ID：14777597
> 
> 赞同：6
> 
> 时间：2013-02-08T17:00:28.523
> 
> 标签：c#, operator-overloading

给定以下代码：

```
using System;

namespace Test721
{
    class MainClass
    {
        public static void Main(string[] args)
        {
            Console.WriteLine(new A()); //prints 666
            Console.WriteLine(new B()); //prints 666
            Console.ReadLine();
        }
    }

    public class A
    {
        public static implicit operator int(A a)
        {
            return 666;
        }
    }

    public class B : A
    {
        public static implicit operator double(B b)
        {
            return 667;
        }
    }
} 
```

结果与评论中的一样 - 两行都打印 666。

我希望写667 `Console.WriteLine(new B());`，而.`double``Console.WriteLine`

为什么会这样？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T17:07:06.397

这在 3.5 C# 语言规范的第 7.4.3.4 节中有所介绍。本节介绍重载解决方案以及在此过程中如何考虑转换。适用线是

> 如果存在从 T1 到 T2 的隐式转换，并且不存在从 T2 到 T1 的隐式转换，则 C1 是更好的转换。

在这种情况下，存在从(T1) 和(T2)`B`两者的隐式转换。存在从to的隐式转换，但不是相反。因此，从to的隐式转换被认为更好并获胜。`int``double``int``double``B``int`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:05:03.500

由于您没有指定将值转换为编译器正在做什么

```
Console.WriteLine((int)(new B())); 
```

您应该改用以下内容

```
Console.WriteLine((double)(new B())); 
```

# c# - How to specify mapping rule when names of properties differ

> ID：14777601
> 
> 赞同：175
> 
> 时间：2013-02-08T17:00:31.777
> 
> 标签：c#, automapper

I am a newbie to the Automapper framework. I have a domain class and a DTO class as follows:

```
public class Employee
{
   public long Id {get;set;}
   public string Name {get;set;}
   public string Phone {get;set;}
   public string Fax {get;set;}
   public DateTime DateOfBirth {get;set;}
}

public class EmployeeDto
{
   public long Id {get;set;}
   public string FullName {get;set;}
   public DateTime DateOfBirth {get;set;}
} 
```

Note: The name of property "**Name**" of `Employee` class is not the same as that of property "**FullName**" of `EmployeeDto` class.

And here's the code to map the `Employee` object to `EmployeeDto`:

```
Mapper.CreateMap<Employee, EmployeeDto>(); // code line (***)
EmployeeDto dto = Mapper.Map<Employee, EmployeeDto>(employee); 
```

My question is: If I want to map `Employee` (source class) to `EmployeeDto` (destination class), how can I specify the mapping rule? In other words, how should I do more with code line (***) above?

* * *

## 回答 #1

> 赞同：345
> 
> 时间：2013-02-08T17:43:47.320

没关系，我自己找到了解决方案：

```
Mapper.CreateMap<Employee, EmployeeDto>()
    .ForMember(dest => dest.FullName, opt => opt.MapFrom(src => src.Name)); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2019-07-29T16:09:43.643

只是将上面的评论滚动到使用 Automapper 8.1+ 的更新方法中......

```
var mapConfig = new MapperConfiguration(
   cfg => cfg.CreateMap<Employee, EmployeeDto>()
      .ForMember(dest => dest.FullName, opt => opt.MapFrom(src => src.Name))
); 
```

然后您将使用 mapConfig 构建映射器：

```
var mapper = mapConfig.CreateMapper(); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2020-03-13T15:30:51.117

我们还可以在 Class 属性上指定用于映射

来自[https://docs.automapper.org/en/stable/Conventions.html#attribute-support](https://docs.automapper.org/en/stable/Conventions.html#attribute-support)

> ## 属性支持
> 
> `AddMemberConfiguration().AddName<SourceToDestinationNameMapperAttributesMember>();` * 当前始终开启
> 
> 查找属性/字段的 SourceToDestinationMapperAttribute 实例并调用用户定义的 isMatch 函数来查找成员匹配项。
> 
> MapToAttribute 是其中之一，它将根据提供的名称匹配属性。
> 
> ```
> public class Foo
> {
>     [MapTo("SourceOfBar")]
>     public int Bar { get; set; }
> } 
> ```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-08-03T07:28:05.160

考虑到我们有两个类

```
public class LookupDetailsBO
    {
        public int ID { get; set; }

        public string Description { get; set; }

    } 
```

另一类是

```
public class MaterialBO
    {
        [MapTo(nameof(LookupDetailsBO.ID))]
        public int MaterialId { get; set; }

        [MapTo(nameof(LookupDetailsBO.Description))]
        public string MaterialName { get; set; }

        public int LanguageId { get; set; }
    } 
```

通过这种方式，您通常可以知道您遵循哪个属性。并且您确保命名约定，因此如果您更改了源中的属性名称。MapTo **()**会提示错误

# r - predict.randomForest argument nodes=TRUE

> ID：14777604
> 
> 赞同：0
> 
> 时间：2013-02-08T17:00:49.670
> 
> 标签：r, regression, prediction, random-forest

When I do predict on newdata for randomForest (R implementation) and set nodes=TRUE

```
predict(rf, newdata = testset, nodes = TRUE) 
```

what is returned?

It says it returns an n by ntree matrix, each column containing the node number that the cases fall in for that tree.

I dont understand how this works? What is the node number that the cases fall in for that tree? Are a tree's nodes numbered when they are generated in this implementaiton of rf?

Thank you.

# jquery - 伪选择器：悬停但仅当 DIV 具有特定类时

> ID：14777605
> 
> 赞同：0
> 
> 时间：2013-02-08T17:00:51.200
> 
> 标签：jquery, css, css-selectors, jquery-events, pseudo-class

`mouseover`我有以下在a 事件中触发的代码`DIV`：

```
if(!$this.hasClass('ready')) 
{   if($this.hasClass('activated'))
    {
        $this.removeClass('activated');
    }
    $this.addClass('ready');
} 
```

还有更多代码，但它基本上遵循与上面相同的概念模式。我检查一个类的存在，并且只有当该类存在时，我才会添加或删除其他类。这发生在`mouseover`，而其他事情发生在`mouseout`。所以有人建议我只使用 CSS 和`:hover`. 但是我有两种不同的类型`DIV`，一种类型包含文本，因此包含“textBox”类，另一种包含图像，因此包含“imgBox”类。

我想做类似的事情：

```
div.imgBox .ready:hover
{ /* some style */ }

div.textBox .ready:hover
{ /* some style */ } 
```

因此，如果鼠标悬停在`div`s 上而他们*没有*class `.ready`，那么什么都不会发生。这可能吗？我只是想切换到 CSS 来加快页面上的用户交互，因为有时鼠标在离开或进入 a 时会卡住`div`，我认为这可能是因为这个改变类的 jQuery。我对吗？

## 编辑

我忘了添加问题的一个重要部分——嵌套元素呢？我的意思是，我有一个`div`可以在 上调整大小的`hover`，当发生这种情况时，我希望以前透明的调整大小手柄获得彩色背景。

```
<div class='imgbox'>
<div class='ui-resizable-se'></div>
...
</div> 
```

所以我的意思是在概念上类似于：

```
.imgbox:hover{ .ui-resizable-se { /*some style */ } } 
```

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T17:08:35.987

如果 type 和 ready 类都在同一个类上`div`，则需要去掉两个类之间的空格：

```
div.imgBox.ready:hover
{ /* some style */ }

div.textBox.ready:hover
{ /* some style */ } 
```

如果您需要设置嵌套元素的样式，只需在部分后面附加*一个*空格即可`:hover`：

```
div.imgBox.ready:hover .ui-resizable-se
{ /* some style */ } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:09:01.993

您不能使用 CSS 添加或删除类。您只能根据 CSS 属性添加或删除样式。因此，如果您想`div`在鼠标悬停时修改某些外观，您必须明确指定样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T17:45:14.963

您应该在悬停定义上指定：

```
$('div.ready').hover() {
    // Your code goes here
} 
```

这样，*只有*那些具有就绪类的 div 才会有悬停事件。否则什么都不会发生

# javascript - lotus notes - mailto 链接问题

> ID：14777615
> 
> 赞同：1
> 
> 时间：2013-02-08T17:01:35.223
> 
> 标签：javascript, html, email, lotus-notes, mailto

我正在尝试使 mailto 链接正常工作，但我遇到了 lotus notes 的问题。

我的链接：`<a href="mailto:?subject=mySubject&body=myBody">Link</a>`

发生的情况是电子邮件主题中出现以下内容：mySubject&body=myBody

它似乎无法识别 &body=

有任何想法吗？

谢谢，克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T16:08:29.973

我已经普遍解决了这个问题。

事情变得一团糟的真正原因是在我的电子邮件正文中我有一个链接。它包含一个查询字符串（例如：[http://www.aaa.com/index.php?date=xxx&value=yyy](http://www.aaa.com/index.php?date=xxx&value=yyy)）

链接中的这个&导致了问题！！！似乎lotus notes 爆炸/拆分mailto 字符串的方式与outlook 不同，并且这个额外的& 号不被理解。

解决方案是对查询字符串进行编码，因此正文中不会出现 & ！！！

例如`<a href="mailto:?subject=mySubject&body=myBody%0A%0Ahttp://www.aaa.com/index.php?SxgftrTr65bfi">Link</a>`

这适用于 Lotus 和 Outlook！

注意：*SxgftrTr65bfi*将在服务器端解码！

-克里斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T05:42:06.840

使用`?`而不是`&`标记 mailto 链接的参数的开始。

看到这个重复的问题：[mailto lotus notes issue with mail toaddress](https://stackoverflow.com/questions/12777334/mailto-lotus-notes-issue-with-mail-toaddress)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T18:40:03.387

如果你有一个旧版本，你可能会遇到一个错误：

[http://www-01.ibm.com/support/docview.wss?uid=swg21087914](http://www-01.ibm.com/support/docview.wss?uid=swg21087914)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-01T17:45:35.510

我遇到了类似的问题，Lotus notes 不喜欢电子邮件正文中的问号 (?) 或与号 (&)。无需使用服务器端处理，您可以简单地将所有问号和 & 符号替换为等效的十六进制代码。

使用 %3F 作为问号，使用 %26 作为 & 号，你应该很高兴。

# less - .less 输出变量不声明

> ID：14777616
> 
> 赞同：2
> 
> 时间：2013-02-08T17:01:36.253
> 
> 标签：less

我知道你可以在 SASS 中做到这一点

```
@pxtoem(@target, @context) {
 (@target/@context)+0em }

.something{
  font-size: @pxtoem(24, 16);
} 
```

这可能在.less中吗？抱歉，我在这里的理解非常有限，但在我看来 .less 期望计算输出一个 css 声明？

为了清楚起见，我不想每次需要使用它时都使用 mixin（bg 位置、字体大小、行高等）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:19:52.043

是的，从 mixins 中，LESS 输出*CSS 声明**或**变量*，但不输出值。

## 最适合您的情况

获得所需内容的最简单方法是避免使用 mixin，而只使用普通操作和`unit()`函数：

```
.something {
    font-size: unit(24 / 16, em);
} 
```

输出：

```
.something {
  font-size: 1.5em;
} 
```

## 输出变量

可以输出一个变量，但它仍然可以使用 LESS 变量的正常范围和“常量”类型行为。所以考虑下面的代码。它表明使用一次，它工作正常（＃1），但两次只给出了为两个项目计算的*最终值*（＃2），所以为了避免这种情况，如果你需要在每个类块中多次调用它，你会需要在该类中进行一些严重的混合嵌套（#3）。

```
.divideToEm(@target, @context) {
   @divideToEm: (@target / @context) + 0em;
}

.something { /* #1 */
   .divideToEm(24, 16);
   font-size: @divideToEm;
}

.somethingElse { /* #2 */
   .divideToEm(24, 16);
   font-size: @divideToEm;
   .divideToEm(12, 24);
   margin-right: @divideToEm;
}

.somethingElse2 { /* #3 */
   .setSize() {
   .divideToEm(24, 16);
    font-size: @divideToEm;
   }
   .setMargin() {
   .divideToEm(12, 24);
   margin-right: @divideToEm;
  }
  .setSize();
  .setMargin();
} 
```

输出：

```
.something {
  font-size: 1.5em;
}
.somethingElse {
  font-size: 0.5em; /* <-- probably NOT expected */
  margin-right: 0.5em;
}
.somethingElse2 {
  font-size: 1.5em;
  margin-right: 0.5em;
} 
```

# php - 在 PHP 中将奇怪的字符输出到屏幕

> ID：14777617
> 
> 赞同：1
> 
> 时间：2013-02-08T17:01:38.897
> 
> 标签：php, character, symbols

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:06:55.277

You're entering the domain of character encoding. It confuses many people so here are some guidelines:

Since you're dealing with HTML you can *always* use `htmlentities`. This will give you something like; `&abc;` or `&#1234;`. These characters will always display correctly.

Another approach is to use characterset encoding. This means you have to make sure all your characters are output in the same character encoding and you give the correct character encoding hints to the browser.

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/> 
```

To force a browser to use UTF-8\. You can substitute for ISO-8859-1 is that is your preferred encoding.

Then, if you all your input is UTF-8 your output should also be UTF-8\. If it's not, convert it. `utf8_encode` will convert a string to UTF-8.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T18:54:02.130

```
var_dump( htmlentities('foo ®®', ENT_QUOTES, "UTF-8") ); 
```

Make sure your source file is UTF-8 encoded.

Most IDEs offer a "character set" option in the "Save As" dialog or somewhere in the file's options.

# jenkins - How constrain the list of users who can receive the e-mail in jenkins on build failure?

> ID：14777618
> 
> 赞同：2
> 
> 时间：2013-02-08T17:01:39.170
> 
> 标签：jenkins, continuous-integration, hudson

I want to know how we can specify the pool of users who will receive the mail if the build fails.

For example :- If there are 10 users who are part of the changes in a particular build, but I want to send e-mails only to those whom I have specified and configured to receive mails. Rest will not receive the mails

Suppose I want to send mails only to A, B, C. Even if build fails because of User D, I don't want to send mail to D.

Basically, I am asking **if there is a way we can constrain the list of users who can receive the mail?**

Is it possible to do?

Thanks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T21:46:31.607

就在这里。在构建后操作中：

*   添加**电子邮件通知**
*   在收件人列表中，添加您想要的所有电子邮件地址
*   取消选中**向破坏构建的个人发送单独的电子邮件**

这将仅将电子邮件发送给您提供了电子邮件地址的人，而不管是谁破坏了构建。但是，这不会将电子邮件发送给构建破坏者。

您的另一个选择是转到“**人员**”部分，选择您不想接收电子邮件的用户，然后从他们的个人资料中删除他们的电子邮件地址。这样，即使他们破坏了构建，他们也不会收到电子邮件。只有那些配置了电子邮件地址的用户才会收到电子邮件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T02:38:54.070

看看[电子邮件分机插件](https://wiki.jenkins-ci.org/display/JENKINS/Email-ext+plugin)，它有很多选项来配置收件人应该是谁以及采取什么行动。安装插件后，您将获得一个新的构建后操作**扩展电子邮件通知**

# doctrine-orm - Fetch records with ManyToMany relation in one query

> ID：14777619
> 
> 赞同：1
> 
> 时间：2013-02-08T17:01:42.020
> 
> 标签：doctrine-orm, many-to-many, associations

I have 2 entities, **Picture** and **Tag**, with ManyToMany relation. That means 3 tables: *picture*, *tag* and *pictures_tags*.

I want to select some pictures and join their tags in the same query. How can it be done in DQL?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:29:13.963

查询相当简单，都是关于[fetch-joins 的](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/dql-doctrine-query-language.html#joins)：

```
$picture = $em->createQuery(
    "SELECT p, t FROM Entity\Picture p JOIN p.tags t WHERE p.id = :pictureId"
)->getResult(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:06:08.490

```
$query = $em->createQuery("Select * from pictures p 
join pictures_tags pt on p.pictureid=pt.pictureid 
join tag on tag.id=pt.tagid");
$users = $query->getResult(); 
```

# javascript - URL 更改后更改按钮的状态

> ID：14777632
> 
> 赞同：1
> 
> 时间：2013-02-08T17:02:19.300
> 
> 标签：javascript, jquery, url, button

每次我的 URL 更改时，我都会尝试更新菜单按钮的状态。以下代码在`mouseleave`我的按钮上：

```
$(document).ready(function() {
    $("#btnAdd, #btnEdit").mouseleave(function(event) {
        ActivateMenuButton();
    });     
});

function ActivateMenuButton() {
    var currentURL = window.location.pathname;
    //alert(currentURL);

    //deselect current selected button
    $("#btnAdd, #btnEdit").removeClass("buttonSelected");

    //select menu button according to URL
    if (currentURL.indexOf('Add') >= 0) {
        $("#btnAdd").addClass("buttonSelected");    
    }

    if (currentURL.indexOf('Ddit') >= 0) {
        $("#btnEdit").addClass("buttonSelected");   
    }
} 
```

有没有办法通过 jQuery 或 javescript 来检测页面何时更改并触发上面的代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:04:55.280

您将寻找 jQuery.ready()，它在页面完成加载时触发。您的 javascript 代码在页面加载之间不记得自己，因此 mouseleave 事件毫无意义，您只想继续并直接触发 ActivateMenuButton。

```
jQuery(document).ready(function() { ActivateMenuButton(); }); 
```

# flash - How to assign class to movieclips in macromedia flash mx 6.0

> ID：14777635
> 
> 赞同：0
> 
> 时间：2013-02-08T17:02:29.900
> 
> 标签：flash, class, ide, macromedia

I'm using the Flash MX IDE to add in objects and FlashDevelop for AS3 programming. How do I assign a class to an imported image I've turned into a movieclip?

Opening the library and going into 'linkage' for the object, there is no form field for class or base class like there are in newer Adobe Flash IDEs.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T19:01:55.617

Flash MX 6 是一个非常古老的产品，使用 ActionScript 1 - AS1 中没有类。

Flash CS3 是最早可以处理 ActionScript 3 的版本。

# android - Layout wrapping?

> ID：14777637
> 
> 赞同：1
> 
> 时间：2013-02-08T17:02:32.890
> 
> 标签：android

I'm a newbie and just trying something simple, but having a hard time to figure this thing out, hopefully you guys can help. I'm creating a very simple app with a main page, and putting a bunch of buttons for the alphabets, right next from each other. Since there are too many buttons to fit into one single line on the screen, what is the best way to have it automatically wrap to the next line, considering viewing it on different screen sizes.

I understand it can be done by calculating the screen size, but it seems simple enough to be done by some simple ways with activity? been looking and trying the layout tags, but nothing seems to work.

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:08:42.103

信不信由你，不可能进行这种类型的包装，因为我记得我自己的一个项目需要类似的东西。

我知道这很痛苦，但我建议为不同的屏幕尺寸使用不同的布局文件。或者按照您的建议，获取容器布局的计算宽度并对这些值进行处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:10:40.147

这个问题已经问过几次了。基本上你在纯Java中寻找FlowLayout，这里有一个[实现](https://stackoverflow.com/questions/4474237/how-can-i-do-something-like-a-flowlayout-in-android)

# algorithm - BuildHeap - Floyd 的算法 - FixHeap 概念

> ID：14777642
> 
> 赞同：1
> 
> 时间：2013-02-08T17:02:44.893
> 
> 标签：algorithm, data-structures, heap, complexity-theory

我试图理解一个关于堆的简单概念。

我知道使用***Floyd算法的******BuildHeap***需要 Theta(n) 来构建大小为 n 的堆。我们获得这个运行时间的方法是自下而上构建堆——这样，更大数量的堆做的工作更少。

 *我对这个概念进行了练习，但有一个不同的细节，问题如下：

> “假设已知的 'FixHeap' 采用 Theta(log(log(n)) 而不是 Theta(log(n))。BuildHeap 算法使用新的 'FixHeap 构建大小为 N 的最大堆的运行时间是多少？ ' 算法（现在只需要 Theta(log(log(n)))"

我不明白新给定的 FixHeap 的运行时间如何影响整体算法运行时间。你能帮我理解这些变化会是什么吗？

FixHeap 是已知的算法，它将父节点与其左右子节点进行比较，并将最大值放在父节点中。作为叶子的父节点的顶点上的 FixHeap 最多会进行一次替换，而该顶点的父节点可能会进行两次替换，依此类推。

**编辑**：当前 BuildHeap 运行时间由以下表达式计算：

(n/4) * 1 + (n/2) * 2 + (n/3) * 3 +......+ 1 * logn-1

仅仅因为有 n/4 个叶子的父节点最多进行 1 次更改，并且有 n/2 个叶子最多进行 2 次更改，依此类推......

我现在看不到公式的变化。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:20:27.900

该算法仍将花费 Θ(n) 时间。为了看到这一点，我们可以证明算法是 O(n) 和 Ω(n)。

对于 O(n) 部分，请注意，该算法显然不能比 FixHeap 每次花费 O(log n) 时间的版本慢。由于 heapify 算法在第二种情况下需要 O(n) 时间，因此我们也可以获得 O(log log n) 时间情况的 O(n) 时间界限。

对于 Ω(n) 部分，请注意 heapify 算法通过对数组前半部分中的每个元素执行一次 FixHeap 过程来工作。迭代一个 n 元素数组的一半至少需要 Ω(n) 时间，从而为我们提供所需的下限。

希望这可以帮助！*

# csv - 使用 sed 填写 CSV 中的空白字段

> ID：14777643
> 
> 赞同：2
> 
> 时间：2013-02-08T17:02:45.467
> 
> 标签：csv, sed

假设我们在 CSV 中有一行，如下所示：

```
|Foo|,,,,,,,,|Bar|,,,,, 
```

`|`封装器在哪里，`,`分隔符在哪里（如您所料）。

但是假设您有一些代码需要填充这些空字段，而您希望将此行转换为如下内容：

```
|Foo|,||,||,||,||,||,||,||,|Bar|,||,||,||,||, 
```

（我们可以稍后处理尾随逗号）我尝试在这个 CSV 上使用这个 sed 命令来获得所需的结果：

```
sed 's/,,/,||,/g' 
```

然而，正则表达式模式`,,`不是零宽度，所以当它扫描线时，它会移动两个，即使我们只处理了一个字段。结果是这样的：

```
|Foo|,||,,||,,||,,||,|Bar|,||,,||,, 
```

问题是当我们在替换中走到这一步时：

```
|Foo|,||,,,,,,,|Bar|,,,,, 
```

我们已经“`||`处理”*了*`,||,`.

如何使用 sed 进行这种替换？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:06:16.833

一个快速的解决方案是重复替换：

```
sed 's/,,/,||,/g;s/,,/,||,/g' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:17:54.017

更优雅的方法是使用条件分支：

```
$ sed ':a;s/,,/,||,/;ta' <<< '|Foo|,,,,,,,,|Bar|,,,,,'
|Foo|,||,||,||,||,||,||,||,|Bar|,||,||,||,||, 
```

来自`man sed`：

> t标签
> 
> 如果 as/// 自最后一个输入行被读取并且自最后一个 t 或 T 命令以来已成功完成替换，则分支到标签；如果省略标签，则跳转到脚本末尾。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T02:21:01.420

使用 awk 我们可以这样做

```
awk '{while(i<2){gsub(",,",",||,");i++}}1' temp.txt 
```

# data-binding - Backbone：模型到模板和模板到模型的绑定

> ID：14777644
> 
> 赞同：10
> 
> 时间：2013-02-08T17:02:46.280
> 
> 标签：data-binding, backbone.js, template-engine, marionette, rivets.js

我正在将 Backbone 和 Backbone.Marionette 集成到现有的 Web 应用程序项目中。我们计划暂时将所有现有功能留在项目中，但任何新功能我们都将利用 Backbone 结构化和 Marionette 原则。首要任务之一是确定 HTML 模板呈现库以及这些模板的数据绑定解决方案。以前，我们一直在使用[JsRender](https://github.com/BorisMoore/jsrender)和[JsViews](https://github.com/BorisMoore/jsviews)来满足我们所有的模板需求和数据绑定，但我们愿意为我们的新功能探索新的途径。所以基本上我一直在研究各种解决方案，现在需要一些关于选择什么的建议或想法。这是我到目前为止所看到的：

> [Backbone.StickIt](http://nytimes.github.com/backbone.stickit/)：
> 
> > 优点：似乎遵循 Backbone 的关注点分离理念，这有助于保持模板非常“干净”。
> > 
> > 缺点：看起来您必须在视图中编写更多代码来定义绑定。此外，似乎缺乏进行条件渲染的能力，因此您必须始终渲染完整模板并仅切换某些元素的显示。
> 
> [铆钉.js](http://rivetsjs.com/)：
> 
> > 优点：在模板中处理更多的数据绑定选项，而不会使其过于混乱。
> > 
> > 缺点：此外，似乎缺乏条件渲染。
> 
> [击退/击倒](http://kmalakoff.github.com/knockback/)：
> 
> > 优点：通过属性处理各种数据绑定需求。
> > 
> > 缺点：很容易开始使用转换器“弄脏”模板。必须添加另一个步骤才能从 Backbone 模型创建 Knockout 视图模型。
> 
> [JS视图](https://github.com/BorisMoore/jsviews)：
> 
> > 优点：类似于 Knockout 的能力，但语法不同。处理条件渲染。
> > 
> > 缺点：过去我们通过在模板中添加太多业务逻辑来弄脏我们的模板，但这可能是我们可以纠正的开发问题。需要创建功能以将 JsViews 可观察性功能与 Backbone 模型事件联系起来。StickIt 和 Knockback 等其他库会自动处理此问题。

我们还研究了介于 StickIt 和 Rivets 之间的 Backbone.ModelBinder [。](https://github.com/theironcook/Backbone.ModelBinder)

任何人都可以分享他们做出的任何决定以及他们为什么选择一个插件/库而不是另一个？我也愿意接受其他建议。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:32:02.870

我用过这些

小胡子.js

Pro's: mustache 不仅支持变量绑定，还可以处理函数绑定。例如你可以有

```
<a href="{{test}}" >click me </a> 
```

然后在你看来有一个方法叫做test。这节省了很多将类/ID分配给链接的冗余，并在视图类中绑定事件。

缺点：我不喜欢它的语法。

接下来我在Ruby on Rails 中使用coffeescript，它内置了jst eco 模板系统。专业人士是，您将模板放在单独的文件中。在页面加载时，它们会绑定到 dom 中的全局变量。这些是缩小的，比一些伪脚本模板标签要好得多。另一个专业人士是，您编写 if else 和 for 循环，就像在 ruby​​ 中一样。缺点是，它们使用 razor 标签，并且不允许与服务器端代码轻松混合（如翻译）。

其他库当然是下划线模板引擎。非常简单，但非常强大。Proside，您已经可以使用它（主干需要下划线）。缺点是，您不能（默认情况下）从外部文件加载模板。我已经通过使用服务器端代码（require_once，渲染部分）解决了这个问题。但是，如果您使用 require.js 以及文本插件 ( [http://requirejs.org/docs/download.html#text](http://requirejs.org/docs/download.html#text) )，那么您可以将模板作为依赖项加载。

# objective-c - loadView 和黑屏

> ID：14777646
> 
> 赞同：0
> 
> 时间：2013-02-08T17:02:47.217
> 
> 标签：objective-c, xcode

我添加`loadView`到我的 LoginController 中，现在我的应用程序在启动图像后出现黑屏。解决这个问题的最佳方法是什么？有什么方法可以`autoLogin`在启动图像中运行？

AppDelegate.h

```
// Load Login View
UIViewController *loadView = [[[LoginViewController alloc] init] autorelease];
self.window.rootViewController = loadView;
[self.window makeKeyAndVisible]; 
```

登录控制器.h：

```
- (void)loadView {
    [self autoLogin];
    [super loadView];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:11:40.587

您需要创建自己的 UIView 并将其设置为 self.view

```
- (void)loadView
{
    self.view = [UIView alloc] initWithRect:CGRectMake(0, 0, 200, 300)];
    self.view.backgroundColor = [UIColor redColor];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:06:45.993

loadView 仅用于在第一次引用视图时以编程方式构建您的视图。你可能想要的是 viewDidLoad

# zend-framework2 - 使用服务定位器作为表单或添加依赖项并创建一个对象？

> ID：14777648
> 
> 赞同：0
> 
> 时间：2013-02-08T17:02:56.263
> 
> 标签：zend-framework2, service-locator, servicemanager

我刚刚开始使用 zend 框架 2。我创建了一个用户表单并在我的控制器中使用该表单我可以在我的控制器中包含 from 类并使用 new 创建和对象，或者我可以使用服务访问表单管理器配置以访问表单。

我在这里寻找使用服务管理器而不是直接实例化对象的原因。有任何想法吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T08:56:52.820

服务管理器的想法是您可以在运行时替换表单。这完全是关于解耦和可重用性。

假设您有一个模块`Foo`并且有一个表单`Foo\Form\Something`。然后你把`Foo`模块放在另一个应用程序中，但你需要将表单切换为其他东西。如果您只是`$form = new Foo\Form\Something`在控制器中执行此操作，则没有简单的选项来实例化另一个表单。如果您在 下注册表单`foo_form_something`，则该`Bar`模块可以覆盖该服务。所以`foo_form_something`不加载`Foo\Form\Something`但是`Bar\Form\Something`。控制器无需更改。

还有另一种相关的编码风格，您可以在控制器中注入表单，而不是通过服务管理器拉取它。你可能会使用这个：

```
namespace MyModule\Controller;

class MyController
{
  public function myAction()
  {
    $form = $this->getServiceLocator()->get('foo_form_something');
  }
} 
```

但这会使您的控制器的测试变得更加困难。注入依赖更容易：

```
namespace MyModule\Controller;

use Foo\Form\Something as SomethingForm;

class MyController
{
  protected $form;

  public function __construct(SomethingForm $foo)
  {
    $this->form = $foo
  }

  public function myAction()
  {
    $form = $this->form;
  }
} 
```

然后在控制器配置中注入表单：

```
namespace MyModule;

class Module
{
  public function getControllerConfig()
  {
    return array(
      'factories' => array(
        'MyModule\Controller\MyController' => function($sm) {
          $form       = $sm->getServiceLocator()->get('foo_form_something');
          $controller = new MyModule\Controller\MyController($form);

          return $controller;
        }
      ),
    );
  }
} 
```

# python - How to deselect prime numbers who end with 7 in range 1-100 in Python?

> ID：14777649
> 
> 赞同：0
> 
> 时间：2013-02-08T17:03:02.203
> 
> 标签：python, primes

```
list = []

for i in range(2,100):
    primeflag=True
    for num in list:
        if(i%num==0):
            primeflag=False

    if(primeflag):
        print str(i)
        list.append(i)
print list 
```

What should I put to remove prime numbers which end with 7?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:07:07.817

将您的数字修改 10 并在将其附加到最终列表之前检查它是否等于 7。

```
if(i % 10 != 7):
    print str(i)
    list.append(i) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:08:25.253

有很多方法可以实现您想要做的事情，您需要查看适合您特定问题的方法。

解决此问题的一种方法：

*   定义一个方法 isprime(n) - 你可以在某处找出或查找实现，我敢肯定

然后：

```
yourlist = [x for x in xrange(2, 100) if isprime(x) and x % 10 != 7] 
```

这是一个很好的第一种方法，当然，还有更复杂的可能性，比如使用生成器、修改后的 Erasthothenes Sieve 等，但您可以在开始工作后探索这些选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T17:06:44.060

`str`在 python 中，您可以使用函数将任何数值转换为字符串表示形式。

所以，你可以这样做： -

```
num  = 17
str_num = str(num) 
```

然后，要测试最后一位不等于 7，您可以访问字符串的最后一个字符，并将其与`'7'`. 要访问最后一个字符，请使用`str_num[-1]`.

所以，你需要的条件是： -

```
if str_num[-1] != '7':
    # don't add it to list 
```

* * *

此外，您的内部循环似乎不正确。您正在检查 的模数`i`，通过将其与 中的每个数字相除`list`，相反，您应该检查模数 until `i ** 0.5`。此外，您可以利用`else`部分`for`循环来避免使用`boolean flag`. 因此，您修改后的代码应如下所示

```
for i in range(2,100):
    for num in range(2, int(i ** 0.5) + 1):
        if(i % num == 0):
            break

    else:
        if str(i)[-1] != '7':
            my_list.append(i) 
```

And `else`of`for`被执行，当`for`循环完成执行而没有任何中断时。

* * *

虽然与实际问题没有直接关系，但您可以考虑查看[Sieve of Eratosthenes](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)算法，以生成给定范围内的素数。

# outlook - Optimizing for Outlook Web Access: image width 100%

> ID：14777650
> 
> 赞同：1
> 
> 时间：2013-02-08T17:03:02.783
> 
> 标签：outlook, outlook-web-app

I'm formatting an email template with an image that stretches to 100% of the width of the parent table. This looks and works great in all email providers I've tried, except for Outlook Web Access. It's not recognizing the height property defined by the table, the table row, or the image itself. It stretches the image height almost infinitely. Any thoughts on how to force Outlook web access to display the image properly? Here's what I'm working with:

```
<html>
<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" border="0" text-decoration="none" style="min-width: 100%">
<table width="100%" border="0" bordercolor="#FFFFFF" align="center" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF" style="padding:15px  link="#fff" vlink="#fff" alink="#fff" >
  <tr valign="bottom" cellpadding="0" cellspacing="0">
  <tr>
    <td height="4" colspan="4" valign="top"><table width="100%" border="0px" cellpadding="0" cellspacing="0"> 
      </table>
    </td>
  </tr>
      </tr>
  <tr>
    <td width="207" rowspan="2" valign="top" cellpadding="0" cellspacing="0"><img src="image/header-left.png" width="259" height="69" alt="logo"></td>
    <td width="157" height="29" colspan="2" align="right" valign="top" cellpadding="0" cellspacing="0"><img src="image/header-right.png" width="156" height="69" alt="right image"></td></tr>
</table>
<table width="100%" height="80" rowspan="2" valign="top" cellpadding="0" cellspacing="0">
    <tr>
    <td height="80" max-height="80" colspan="2" rowspan="0" align="right" valign="top" cellpadding="0" cellspacing="0" style="max-height:80px;"><img src="image/header-center.png" alt="bottom middle image" width="100%" height="80" style="max-height="80"></td>
</tr>
</table>
</body>
</html> 
```

# sorting - 如何找到矩阵排序的下限？

> ID：14777653
> 
> 赞同：5
> 
> 时间：2013-02-08T17:03:24.297
> 
> 标签：sorting, matrix, asymptotic-complexity, lower-bound

考虑对矩阵进行排序的问题`n x n`（即行和列按升序排列）。我想找到这个问题的下限和上限。

我发现它`O(n^2 log n)`只是对元素进行排序，然后将第一个`n`元素输出为第一行，将下一个`n`元素输出为第二行，依此类推。但是我想证明它也是`Omega(n^2 log n)`。

在尝试了较小的示例之后，我认为我应该证明，如果我可以使用小于`n^2 log(n/e)`比较来解决这个问题，它将违反对元素`log(m!)`进行排序所需的比较下限。`m`

关于如何证明这一点的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-13T06:20:56.160

看看[http://en.wikipedia.org/wiki/Sorting_algorithm#Comparison_of_algorithms](http://en.wikipedia.org/wiki/Sorting_algorithm#Comparison_of_algorithms)。

您的问题听起来好像您只是在对 n² 元素而不是 n 进行排序，因此 'O(n² log n²)' 可能对例如合并排序有效。

如果第一行中的前 n 个元素不必自己排序，它可能会更快，但不是必须的，这取决于算法。

最后但并非最不重要的一点是，尝试一些例子并不能证明什么，尤其是那些统计数据不起作用的小例子（它们甚至没有表明什么）

# math - 模数学减少到余数模

> ID：14777654
> 
> 赞同：-1
> 
> 时间：2013-02-08T17:03:25.203
> 
> 标签：math, modulo

我需要一些关于模数的帮助。我在我的书中看到了这个例子，但不明白我的教授是如何得到它的。有人可以向我解释这是如何工作的吗？

2^345 = (2^5)^69 = 32^69 = 1^69 = 1 (mod 31)

= 符号是全等符号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:13:34.713

只有第三个符号需要全等，实际上：2^345 = (2^5)^69 (因为 n^(a*b) == (n^a)^b); 2^5 肯定是 32；对于所有 n，1^n = 1。

那么，为什么 32^69 ~= 1^69 （使用 ~= 作为“一致”）？

简单的。

```
32 ~= 1 mod (31) =>
32 = (n*31)+1    =>
32^p = ((n*31)+1)^p
     = (n*31)^p + a*1*(n*31)^(p-1) + b*(1^2)*(n*31)^(p-1) + ... + 1^p for some a,b...
     = (n*31)*z + 1 for some z
    ~= 1 (mod 31) 
```

因此，一般来说，如果`a ~= b (mod p)`那时`a^n ~= b^n (mod p)`

# xcode4 - Xcode 中过时的代码覆盖文件

> ID：14777655
> 
> 赞同：2
> 
> 时间：2013-02-08T17:03:31.660
> 
> 标签：xcode4, code-coverage

所以我正在更新一些单元测试并查看我的文件夹中的覆盖率（`.gcda`和`.gcno`）文件`Derived Data`，所有文件都在那里，但是当我对我的测试进行更新并重新运行它们时，我注意到覆盖率文件没有更新.

我通过查看文件上的时间戳注意到了这一点。

在过去，我发誓我可以进行更改，重新运行，然后文件就会更新。但是现在我需要先清理然后运行我的测试以清除旧的覆盖文件，然后再重新运行。

有没有其他人看到过这种行为，如果有，知道如何解决吗？

我将 4.6 与 iOS 6.1 SDK 一起使用。

谢谢。

# kendo-ui - Kendo ui mvc 网格在使用外国列更新后不起作用

> ID：14777664
> 
> 赞同：0
> 
> 时间：2013-02-08T17:04:12.643
> 
> 标签：kendo-ui, kendo-grid

我有 2 个表，其中一个（表 A）到多个（表 B）

我已经让它在更新，删除，使用旧数据创建我的问题是当我将新数据添加到表 A 并将新数据添加到表 B 并引用表 A 然后网格是空白的，我使用了萤火虫，但我没有不知道怎么解决

**控制器**

```
[AcceptVerbs(HttpVerbs.Post)]
 public ActionResult Update([DataSourceRequest] DataSourceRequest request, ReRoom room)
 {

 if (room != null && ModelState.IsValid) { var target = RoomRepository.One(p => p.PKiRoomID == room.PKiRoomID); if (target != null) 
{

  target.SDescription = room.SDescription;
 target.SRoomName = room.SRoomName; target.BStatus = room.BStatus;
 target.IRoomType = room.IRoomType; RoomRepository.Update(target); 
} 
} 
return Json(ModelState.ToDataSourceResult());
 } 
```

**存储库**

```
public static void Update(ReRoom room)
 {
 ReRoom target = One(p => p.PKiRoomID == room.PKiRoomID); 
if (target != null)
 {
 target.SDescription = room.SDescription;
 target.SRoomName = room.SRoomName; 
target.BStatus = room.BStatus;
 target.IRoomType = room.IRoomType;
 } 
reModel rm = new reModel();
 var i = rm.ReRooms.Where(p => p.PKiRoomID == room.PKiRoomID).FirstOrDefault();
 if (i != null)
 {
 i.SDescription = room.SDescription;
 i.SRoomName = room.SRoomName;
 i.BStatus = room.BStatus;
 i.IRoomType = room.IRoomType;
 }
 rm.SaveChanges();
 } 
```

**指数 ：**

```
columns.ForeignKey(p => p.IRoomType, (System.Collections.IEnumerable)ViewData["Types"], "ID", "Name");
 ViewData : private void populateRoomtypes() { ViewData["Types"] = new reModel().ReRoomTypes .Select(t => new { ID = t.PKiRoomTypeID, Name = t.SRoomTypeName }); 
} 
```

# joomla - 组件 joomla

> ID：14777665
> 
> 赞同：0
> 
> 时间：2013-02-08T17:04:15.933
> 
> 标签：joomla, joomla2.5

我在 Joomla 中的一个组件有问题我想在组件启动时调用其他函数

```
$controller = JController::getInstance('Productos');
$controller->execute(JFactory::getApplication()->input->get('task'));
$controller->redirect(); 
```

这里我想调用一个函数在数据库中只选择一项而不是全部

试试这个

```
$controller->execute(JFactory::getApplication()->input->get('other')); 
```

在我的

```
class ProductosController extends JController
{

function Other(){
...
}

} 
```

但是我的代码永远不会通过其他功能。

怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:06:16.420

`JFactory::getApplication()->input->get('task')`将返回一个控制器/函数对或仅返回一个函数名称。如果它是一个控制器/函数对，它将以这种格式返回一个字符串：'controller.function'。注意一个时期的分离。如果返回一个函数，它只是函数名。

您对脚本所做的修改导致它查找名称为“other”而不是名称“task”的请求变量（即 post 或 get 变量）。（Task 是传递任务的标准 Joomla 变量。）

If you actually wanted to always call that particular function you would change the line to this:

```
$controller->execute('Productos.other'); 
```

Likewise, you could also just adapt the page that is calling this, so that the url either contains `task=productos.other` or there is a hidden input form field like such:

```
<input type="hidden" name="task" value="productos.other" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-24T05:05:08.120

The better way of call the controller method is:

```
$controller = JControllerLegacy::getInstance('Other');
$controller->execute(JFactory::getApplication()->input->getCmd('task')); 
```

using `getCmd()` call the controller task, and task is not pass in url so you do not get the task using `get()` method.

Try this code and get the solution of your problem.

# jquery - JQuery 百分比随着用户滚动而增加

> ID：14777667
> 
> 赞同：0
> 
> 时间：2013-02-08T17:04:20.600
> 
> 标签：jquery, percentage

我希望创建一个显示百分比的信息图表，我希望它们从 0% 增加到最终统计数据（即最大值为 100%），然后停在那里。[您可以在http://www.hispanicsatnbcu.com/part3.html](http://www.hispanicsatnbcu.com/part3.html)或[http://www.smartpowergeneration.com/](http://www.smartpowergeneration.com/)等网站上看到这种效果（请注意第二部分中不同类型能源旁边的百分比）。我想我需要使用 JQuery .scrollTop 方法，这样当用户到达某个点时，它可以开始增加百分比，因为他们滚动更多，但我真的不知道你将如何从那个点动态增加百分比. 提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T17:27:48.977

[**这里**](http://jsfiddle.net/nbSNA/)非常简单的例子[](http://jsfiddle.net/nbSNA/)

 **```
$(window).scroll(function() {
    var startValue = 70; // scrollTop value when to start incrementing
    var stopValue = 300; // scrollTop value when to stop incrementing
    var scrollTop = $(window).scrollTop();
    if (scrollTop > startValue && scrollTop <= stopValue)
        $("#pct").text((((scrollTop-startValue)/(stopValue-startValue))*100).toFixed(0));
    else if (scrollTop <= startValue)
        $("#pct").text(0);
    else if (scrollTop >= stopValue)
        $("#pct").text(100);
}); 
```**

# cakephp - cakephp 2 - 根据布局加载助手

> ID：14777669
> 
> 赞同：0
> 
> 时间：2013-02-08T17:04:29.847
> 
> 标签：cakephp, layout, helpers, cakephp-2.2

我想根据布局加载助手。我想要这样的东西，但 id 不起作用：

```
function beforeRender(){
  if (array_key_exists($this->request->action, $this->custom_layouts)){
    public $helpers = array('Html', 'Form', 'Session', 'Menu1');                
    $this->layout = $this->custom_layouts[$this->action];

  }else{
    public $helpers = array(
      'Session',
      'Html' => array('className' => 'TwitterBootstrap.BootstrapHtml'),
      'Form' => array('className' => 'TwitterBootstrap.BootstrapForm'),
      'Paginator' => array('className' => 'TwitterBootstrap.BootstrapPaginator'),
      'Menu1'
    );
    $this->layout = 'default';
  }
} 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:51:40.050

你不能仅仅`public $helpers`在方法内部声明。

您需要调用它，因为 PHP 希望它被调用：

```
$this->helpers[] = 'Menu1';
$this->helpers['Html'] = array('className' => 'TwitterBootstrap.BootstrapHtml');
... 
```

# flurry - Flurry - stopSession 和多项活动

> ID：14777670
> 
> 赞同：1
> 
> 时间：2013-02-08T17:04:31.143
> 
> 标签：flurry

所以，我正在与 Flurry 集成并试图找出何时调用`FlurryAgent.onEndSession(this);`.

我的应用程序中有四个活动。由于目前只有一个入口点/活动添加`FlurryAgent.onStartSession(this, Globals.FLURRY_API_KEY);`很容易。但是停止会话的问题是可以从四个活动中的任何一个关闭应用程序。此外，`onStop()`每次应用程序更改屏幕上的活动时都会调用。

有关于如何决定何时结束 Flurry 会话的建议吗？从另一个[答案](https://stackoverflow.com/a/12307801/225885)中获得一些建议，我可以使用一个类，我的四个活动中的每一个都会扩展它，然后`BaseActivity`我会放置在那里。这将解决使用 Flurry 开始/停止调用乱扔我的代码的问题，但不能解决何时停止的问题。`onStart()``onStop()`

我目前的解决方案是在上述方法的基础上添加退出标志。仅当退出标志设置为 true 时，基本活动才会结束 Flurry 会话。

然后，在每个活动中，我将查看诸如返回按钮和主页键之类的按键。如果按下 home 或 back 键，我会将 exit 设置为 true。

这应该有正确的效果，但我觉得它有点hacky。

iOS 很好，你只需要开始会话。将我的四个活动重构为一个并使用片段可能是一个好主意。你们有什么感想？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-09T15:22:07.847

您应该`FlurryAgent.onStartSession`从Activity 的*每个*`onStart`方法以及`onEndSession`每个`onStop`方法中调用。正如您所指出的，您的应用程序有多个退出点，因为该应用程序可以从任何活动后台运行。但是对于大多数遵循 Google 指南的应用程序，如果您的用户在后台返回应用程序后，它将返回到此 Activity。这应该是一个新会话，但如果您仅从`onStartSession`单个入口点调用 Flurry SDK 将不会在该点启动新会话。如果您有三个活动，A，B，C 都在调用`onStartSession`并且`onEndSession`这样，如果您的用户从 A 导航到 B 再到 C，SDK 将不会报告三个不同的会话，而是将调用收集到一个报告给仪表板的会话中。让我知道这是否没有意义。

使用 a`BaseActivity`将这些调用分解为抽象类是一种很好的做法，但如果您使用 Activity 的其他子类，请确保这样做 -`BaseListActivity`等等。

（免责声明：我在 Flurry 开发 Android SDK）

# python - 为什么我的数据不能保存到 xls？

> ID：14777673
> 
> 赞同：0
> 
> 时间：2013-02-08T17:04:44.653
> 
> 标签：python, python-2.7, scrapy, xls, xlwt

我已经使用 scrapy 编写了一个非常简单的网络爬虫。我想将抓取的数据保存到 .xls 文件中，因为我有一个现有的模块来读取 xls 并对抓取的数据进行排序。但是我遇到了一个愚蠢的绊脚石，实际上保存了.xls。

*   蜘蛛本身可以工作（它抓取并抓取所需的数据）
*   .xls 正在正确创建和初始化。
*   在抓取每个项目后，将抓取的数据写入 xls。

然而，无论我把保存语句放在哪里，它似乎在实际的网络抓取开始**之前就被保存了。**给我留下一个初始化的（第一行用标题填写）但其他方面为空的电子表格。这是我所拥有的（删除网站以保存无辜的服务器）

```
# encoding=utf-8
from scrapy.contrib.spiders import CrawlSpider, Rule
from scrapy.contrib.linkextractors.sgml import SgmlLinkExtractor
from scrapy.selector import HtmlXPathSelector 
from scrapy.item import Item, Field
from xlwt import Workbook

# Working row on new spreadsheet
row_number = 0

# Create new spreadsheet
newDb = Workbook(encoding='utf-8')
newFile = newDb.add_sheet('Sheet1')
values = ['product','description','image']

class TestSpider(CrawlSpider):
    # Initiate new spreadsheet
    global newFile
    global values
    global row_number
    for cell in range (len(values)):
        newFile.write(row_number, cell, values[cell])
    row_number = row_number + 1

    # Initiate Spider
    name = "Test"
    allowed_domains = []
    start_urls = ["http://www.website.to/scrape",]
    rules = (Rule(SgmlLinkExtractor(restrict_xpaths="//div[@class='content']/h3"), callback='parse_product'),)

    def parse_product(self, response):
        hxs = HtmlXPathSelector(response)
        item = TestItem()
        item['product'] = hxs.select('//div [@class = "col-right"][1]/table/tr[1]/td/text()').extract()
        item['description'] = hxs.select('//div[@class="columns"][1]/div [@class = "col-right"]/p/text()' ).extract()
        item['image'] = hxs.select('//img /@src').extract()

        global values
        global newFile
        global row_number

        # This is where products are written to the xls
        for title in values:
            # test to increase row_number, at the start of each new product
            if title == "product":
                row_number = row_number + 1
            try:
                newFile.write(row_number, values.index(title), item[title] )
            except:
                newFile.write(row_number, values.index(title), '')

class TestItem(Item):
    product = Field()
    description = Field()
    image = Field() 
```

我相信我说的只是需要添加是正确的
`global newDb
newDb.save('./products_out.xls')`

在正确的位置，但同样，无论我在哪里添加，打印语句都指示操作顺序始终是：创建 xls -> 初始化 xls -> 保存 xls -> 刮擦并写入 xls -> 关闭而不保存。

我对开发很陌生，对此我很茫然，任何建议都将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T21:36:48.723

理想情况下，您应该创建一个自定义项目管道类（查看 scrapy 文档以获取示例）并将所有文件编写代码放在那里。

# java - Android：从主要活动访问应用程序类链表

> ID：14777675
> 
> 赞同：0
> 
> 时间：2013-02-08T17:04:50.737
> 
> 标签：java, android, linked-list

已经为此苦苦挣扎了一段时间。基本上我已经扩展了应用程序类，以便它创建一个简单的链表，希望这个列表可以在各种活动中访问。但是当我需要它时，似乎无法从链表中获取信息。

我不确定这是否可能（尽管我不明白为什么不会），或者我在处理链表时是否犯了一些愚蠢的错误。

**扩展应用程序类 (GlobalData)**

```
package com.example.testing;

import java.util.LinkedList;
import android.app.Application;
import android.widget.Toast;

public class GlobalData extends Application {

public static LinkedList<String> EmployeeList;

@Override
public void onCreate(){
    super.onCreate();
    createLinkedList();
}

public void createLinkedList(){
    // create a linked list

    LinkedList<String> EmployeeList = new LinkedList<String>();
    String emp1 ="john", emp2="adam";
    EmployeeList.add(emp1);
    EmployeeList.add(emp2);

    String boo;
     boo = EmployeeList.getFirst();

    //This works, displays the name ok.
    Toast.makeText(getApplicationContext(), "("+boo+")" ,Toast.LENGTH_LONG).show();
}

} 
```

**我希望能够访问链表的主要位置。**

```
package com.example.testing;

import android.os.Bundle;
import android.app.Activity;
import android.widget.TextView;
import android.widget.Toast;

public class MainActivity extends Activity {

protected GlobalData globalData;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // Get the application instance
    globalData = (GlobalData)getApplication();  

    String boo;
    boo = GlobalData.EmployeeList.getFirst();

    //This doesn't work & im not sure why.
    Toast.makeText(getApplicationContext(), "("+boo+")" ,Toast.LENGTH_LONG).show();     

}
} 
```

可能应该提到我刚刚开始使用这些东西，所以如果这是一个完全愚蠢的问题，请道歉。

我不明白为什么我无法访问该列表的内容，如果我修改脚本以便 GlobalData 类包含一个字符串变量，那么上面的代码（有一些改动）可以正常工作。那么为什么变量可以访问但链表不能访问呢？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:12:34.870

在这一行中，您正在创建列表的新实例，而不是使用您创建的作为类成员的实例：

```
LinkedList<String> EmployeeList = new LinkedList<String>(); 
```

只需将此行更改为：

```
EmployeeList = new LinkedList<String>(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:13:43.737

您的 createLinkedList() 方法有一个小错误。

```
LinkedList<String> EmployeeList = new LinkedList<String>(); 
```

应该：

```
EmployeeList = new LinkedList<String>(); 
```

您正在创建一个局部变量（恰好与您的公共静态类字段同名），并将您的条目存储在其中。

# php - 如何使用 preg_match 过滤第一次出现

> ID：14777682
> 
> 赞同：1
> 
> 时间：2013-02-08T17:05:40.893
> 
> 标签：php, preg-match, preg-match-all

我正在尝试从文本文件中过滤域，该文本文件始终出现在每行的第一个位置。

文件看起来像：

```
Domains         Users
domain1.com     User1
domain2.com     User2
domain3.com     User3 
```

这就是我尝试过的：

```
preg_match_all('/^[^ ]+/', $file, $matches); 
```

它产生以下结果：

```
array(1) {
  [0]=>
  array(1) {
    [0]=>
    string(6) "Domains"
  }
} 
```

它正在走第一条线，但在它之后停止。这很奇怪。

非常感谢这里的任何帮助。

我的另一个问题如下。更快的是 preg_match 或以下的第一个方法。

```
$lines = preg_split('/\r\n|\r|\n/', $file);

foreach($lines as $line) {
    $parts = explode(' ', $line, 2);
    $domains[] = $parts[0];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:08:17.290

使用`m`修饰符允许多行模式：

```
preg_match_all('/^[^ ]+/m', $file, $matches);
                        ^-- modifiers are here 
```

修饰符列表：[http ://www.regular-expressions.info/modifiers.html](http://www.regular-expressions.info/modifiers.html)

> /i 使正则表达式匹配不区分大小写。
> 
> /s 启用“单行模式”。在这种模式下，点匹配换行符。
> 
> /m 启用“多行模式”。在这种模式下，插入符号和美元在主题字符串中的换行符之前和之后匹配。
> 
> /x 启用“自由间距模式”。在这种模式下，正则表达式标记之间的空格被忽略，并且未转义的 # 开始注释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:10:18.370

更新：

:D 对不起，我没有把你的问题读到最后。：D ..我会说爆炸更快...我正在测试....（好问题！+1）

* * *

更新 2：

我已经测试了你的爆炸尝试和@Frits van Campen 的答案和......'我很惊讶：**preg_match_all() 快 3.5 倍**

我使用了 393472 行的测试文件和 Ubuntu12.04 php5.3.10 得到：

*爆炸*

```
real    0m1.409s
user    0m1.284s
 sys    0m0.124s 
```

*preg_match_all*

```
real    0m0.461s
user    0m0.384s
 sys    0m0.072s 
```

所以我想说@Frits van Campen 的答案是最好的。

# jquery - jQuery UI 显示/隐藏

> ID：14777684
> 
> 赞同：2
> 
> 时间：2013-02-08T17:05:47.303
> 
> 标签：jquery

我正在使用 jQuery UI 制作滑动 div，但我遇到了问题。

我有一个外部 DIV 和 2 个内部 DIV，它们是浮动的。在第一个内部 DIV 上，我有滑动效果。

```
<div id="outer">
    Outer Div
    <p><a href="#" id="SlideOut">Slide Out</a></p>
    <p><a href="#" id="SlideIn">Slide In</a></p>

    <div id="inner">inner</div>
    <div id="inner2">inner2</div>
</div> 
```

* * *

```
 $("#SlideOut").click(function(){
    $("#inner").hide("slide",{direction: 'left'},1000);
});

$("#SlideIn").click(function(){
        $("#inner").show("slide",{direction: 'left'},1000);

}); 
```

问题是第二个 DIV 不跟随第一个 div。

很难解释，所以这里有一个小提琴，你可以更好地理解我的问题。 [http://jsfiddle.net/xFx26/1/](http://jsfiddle.net/xFx26/1/)

简而言之，我希望第二个内部 div 将与第一个内部 div 一起滑动。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T17:12:30.817

您应该使用`animate()`和更改宽度，而不是滑动。幻灯片滑动内容，然后隐藏实际容器。[更新了小提琴。](http://jsfiddle.net/xFx26/2/)

代码：

```
$("#SlideOut").click(function(){
    $("#inner").animate({width: 0},1000);
});

$("#SlideIn").click(function(){
     $("#inner").animate({width: 200},1000);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:12:30.957

我想你需要像下面这样将 inner2 添加到你的 jquery 中？这是你想要的吗？

```
$("#SlideOut").click(function(){
$("#inner").hide("slide",{direction: 'left'},1000);
$("#inner2").hide("slide",{direction: 'left'},1000);
});

$("#SlideIn").click(function(){
    $("#inner").show("slide",{direction: 'left'},1000);
$("#inner2").show("slide",{direction: 'left'},1000);

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T17:12:50.990

在幻灯片中添加它（在幻灯片中添加相反的内容）

```
 $("#inner2").css("position","relative").animate({left:-200},990,function()  {$(this).css("left","")}); 
```

但更好的是把 position:relative 放在 css 中并从 js 中删除

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T17:18:15.640

你应该使用`animate`让你的 div 从右向左移动。

```
$("#SlideOut").click(function () {
    $("#inner").hide("slide", {
        direction: 'left'
    }, 1000);
    $("#inner2").animate({
        marginLeft: "-=250px",
    }, 1000);
}); 
```

[http://jsfiddle.net/xFx26/5/](http://jsfiddle.net/xFx26/5/)点击SlideOut

# wpf - WPF MVVM - 如何排列 ViewModel

> ID：14777687
> 
> 赞同：0
> 
> 时间：2013-02-08T17:05:56.417
> 
> 标签：wpf, mvvm

我正在开发基于 MVVM 模式的 WPF 应用程序。

对于特定实体，我有一个包含实体属性的模型，一个实现 INotifyPropertyChanged 并具有一些附加逻辑的 ViewModel 以及公开模型的属性和两个视图，一个用于创建实体，一个用于编辑实体。

我为编辑创建单个 ViewModel 并创建视图，并在进行编辑时传递实体的 id，以便可以检索现有数据。

我无法解决的是如何在这种情况下构造 ViewModel，即：

1.  我是否应该将 EntityViewModel 作为 EditEntityViewModel 的属性，其中 EntityViewModel 公开模型的属性，而 EditEntityViewModel 处理命令和其他逻辑？如果我这样做，那么我认为 EntityViewModel 不会收到有关视图更改的通知。
2.  我应该有两个彼此一无所知的独立 ViewModel 吗？
3.  我是否应该为页面提供一个 ViewModel 来公开模型的属性以及处理命令和其他逻辑？
4.  还有什么？

我知道每个视图应该有一个 ViewModel，但我不完全确定如何定义单独的视图。您可能会说我对如何实现该框架感到有些困惑。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T18:16:27.447

不要过度复杂化。尝试保持您的视图模型与模型关系 1:1。因此，您的视图模型将公开方法以支持模型上的所有 CRUD 方法。另外，考虑使用一种视图，而不是两种。它们之间有很多重叠，所以我认为这是有道理的。你将有更少的类来编写和维护。我认为使用单一视图方法的列表中的#3 是您的最佳选择。

# mysql - 从 MySQL 中选择非冗余数据？

> ID：14777691
> 
> 赞同：1
> 
> 时间：2013-02-08T17:06:07.403
> 
> 标签：mysql, select, redundancy

我有一张这样的表，它有两个属性`a`和`b`. 现在，有很多数据通过这些东西，我想选择一个值`a`具有超过 1 个不同值的所有记录`b`。

例如，从以下示例表中

```
 a    b
---------
   1    1
   1    1
   2    1
   2    2
   3    1
   4    1
   4    5
   4    1 
```

我想选择

```
 a   b
--------
   2   1
   2   2
   4   1
   4   5 
```

或者如果不可能，只是`2`和`4`（作为两个结果行），所以我可以在第二个查询中获得更具体的数据。

我尝试过使用`GROUP BY`以及`HAVING`一些带有子查询的构造，但没有什么能接近我想要的结果。我真的不想获取所有数据并手动处理。

这可能是一件非常简单的事情，但我就是无法理解，那么如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T17:13:13.907

对于单个表访问（返回同一行上`b`特定值的所有值），请尝试：`a`

```
select a, group_concat(distinct b)
from yourtable
group by a
having count(distinct b) > 1 
```

要为 a 和 b 的每个组合返回单独的行，请尝试：

```
select distinct yt1.a, yt1.b
from yourtable yt1
join yourtable yt2 on yt1.a = yt2.a and yt1.b <> yt2.b 
```

`Exists`变体：

```
select distinct a, b
from yourtable yt1
where exists
(select 1
 from yourtable yt2
 where yt1.a = yt2.a and yt1.b <> yt2.b) 
```

# php - HTTP_USER_AGENT 位置 Internet Explorer 10

> ID：14777694
> 
> 赞同：-1
> 
> 时间：2013-02-08T17:06:12.923
> 
> 标签：php, internet-explorer, redirect, internet-explorer-10

我正在寻找正确的代码段落，因为我的不适用于 IE 10。我搜索了 stackoverflow，并在互联网上花了很多时间，但问题并不相同（并且 MSDN 上的提示在所有代码示例中都有错误！ )

这是我的php代码：

```
<?php
$ua = $_SERVER['HTTP_USER_AGENT'];
if (strpos($ua,'MSIE') != false && strpos($ua,'Opera') === false) {
    if (strpos($ua,'Windows NT 5.2') != false) {
        if(strpos($ua,'.NET CLR') === false) return;
        }
        if (substr($ua,strpos($ua,'MSIE')+5,1) < 7){
            header('Location: http://www.domain.org/xxxx/browser.html');
            exit;
        }
    }
?> 
```

此代码适用于除 IE 10 之外的所有 IE 版本！IE 10 挂起，显示带有重定向页面 browser.html 的 url 的空白页面。

在 IE6 和 IE 7 中，您会看到 browser.html 带有您应该升级 IE 版本的消息。

这段代码有什么问题？？我知道我可以使用条件注释，但重定向更适合我的情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T22:10:44.603

据我所知，Internet Explorer 10 不再在用户代理字符串中发送*.NET CLR信息。*首先尝试删除它：

```
if(strpos($ua,'.NET CLR') === false) return;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:06:57.450

以下是 IE 用户代理的两个示例：

```
Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/5.0)

Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; [platform token] Trident/6.0; Touch) 
```

如您所见，当尝试在该行检测 IE 版本时出现问题：

```
if (substr($ua,strpos($ua,'MSIE')+5,1) < 7){ 
```

因为在版本的情况下`10.0`，`substr($ua,strpos($ua,'MSIE')+5,1)`只会匹配`1`而不匹配`10`，所以`1 < 7`。

修复它的简单方法是：

```
preg_match('#MSIE ([0-9]{1,2}\.[0-9]{0,2});#si',$ua,$m);
if ($m[1] < 7) {
  [your code]
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T10:58:39.140

好的，我有解决办法！它与代码段落无关：

```
if (strpos($ua,'Windows NT 5.2') != false) 
```

或者

```
if(strpos($ua,'.NET CLR') === false) return; 
```

问题在线

```
 if (substr($ua,strpos($ua,'MSIE')+5,1) < 7){ 
```

Internet Explorer 10 不理解数学符号 < 。

如果我这样写：

```
if ((substr($ua,strpos($ua,'MSIE')+5,1) == 6) || (substr($ua,strpos($ua,'MSIE')+5,1) == 7)) 
```

代码有效！

所以这是适用于 IE6 和 IE7（它重定向到页面 browser.html）和 IE8、IE9 和 IE10（以及所有其他非 IE 浏览器）的完整代码：

```
<?php
$ua = $_SERVER['HTTP_USER_AGENT'];
if (strpos($ua,'MSIE') != false && strpos($ua,'Opera') === false){
    if ((substr($ua,strpos($ua,'MSIE')+5,1) == 6) || (substr($ua,strpos($ua,'MSIE')+5,1) == 7)) 
    {
        header('Location: http://www.domain.org/xxxx/browser.html');
        exit;
    }
}
?> 
```

所以，你可以插入我上面提到的前两行。它也适用于这两行，但我认为：我使用的代码越少越好:-)

也许其他人也会测试它。在我的虚拟 Windows 7 上，问题现在已经解决了。

# ios - 关闭键盘数字键盘

> ID：14777702
> 
> 赞同：0
> 
> 时间：2013-02-08T17:06:34.510
> 
> 标签：ios, xamarin.ios

当用户按下背景时，我想关闭我的数字键盘。我的问题是我找不到调用 ResignFirstResponder 的文本字段。我正在使用 MonoTouch.Dialog。因为我可以覆盖 InputAccessoryView，所以这是我的代码：

```
using System;
using MonoTouch.Dialog;
using MonoTouch.UIKit;
using System.Drawing;

namespace MyApp
{
public class JMADialogViewController : DialogViewController
{
    public JMADialogViewController (RootElement root, bool pushing) : base(UITableViewStyle.Grouped, root, pushing)
    {
    }

    UIView dismiss;

    public override UIView InputAccessoryView 
    {
        get 
        {
            if (dismiss == null)
            {
                dismiss = new UIView(new RectangleF(0,0,320,27));         
                dismiss.BackgroundColor = UIColor.Black;
                UIButton dismissBtn = new UIButton(new RectangleF(255, 2, 58, 23));
                dismissBtn.SetTitle("Done", UIControlState.Normal);      
                dismissBtn.TouchDown += delegate {
                    //textField.ResignFirstResponder();
                    dismiss.ResignFirstResponder();
                };
                dismiss.AddSubview(dismissBtn);
            }
            return dismiss;
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T17:20:14.243

您可以使用 EndEditing() 在其下方具有焦点文本视图的任何视图中关闭键盘，因此添加此操作可能会起作用：

```
 this.View.EndEditing(true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:15:17.293

你有没有尝试过

```
[self.view endEditing:YES]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-25T15:33:51.380

尝试放置一个没有背景的按钮，并在前面放置所有文本字段。所以用户触摸的任何地方都会隐藏键盘。使用以下代码将按钮与不作为链接：

[self.view endEditing:YES];

这是我在我的应用程序中使用的解决方案。希望结果有帮助！

# android - 无法获得一个按钮来调出一个新的活动

> ID：14777707
> 
> 赞同：0
> 
> 时间：2013-02-08T17:06:45.570
> 
> 标签：android, button

我对编程很陌生，刚刚遇到了一个阻碍我的简单路障。我试图让我的主要活动中的一个按钮调用另一个活动。我已经研究过，但到目前为止我还没有找到可以工作的东西（可能非常简单和愚蠢）。任何帮助，将不胜感激。我已经包含了我的主要活动的代码。谢谢

```
package com.example.valentinetimer;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class CardFront extends Activity implements OnClickListener {

    private static final String TAG = null;

    Button openButton;

    @Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.cardfrontxml);

    Log.d(TAG, "onCreate");

    //Button
    openButton = (Button) findViewById(R.id.openButton);
    openButton.setOnClickListener(this);

    this.setContentView(R.layout.cardfrontxml);
    this.openButton = (Button)this.findViewById(R.id.openButton);
    this.openButton.setOnClickListener(new OnClickListener()
    {
        @Override
        public void onClick(View v)
        {
            Log.d(TAG, "Click Event");

            Intent intent = new Intent (null, CardContent.class);
            startActivity (intent);
        }
    });
    //End Button

}

    @Override
    public void onClick(View v)
    {
        // TODO Auto-generated method stub  
    }
} 
```

日志猫：

```
02-08 10:18:51.927: E/AndroidRuntime(2494): FATAL EXCEPTION: main
02-08 10:18:51.927: E/AndroidRuntime(2494): android.content.ActivityNotFoundException:          Unable to find explicit activity class   {com.example.valentinetimer/com.example.valentinetimer.CardContent}; have you declared this   activity in your AndroidManifest.xml?
02-08 10:18:51.927: E/AndroidRuntime(2494):     at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1504)
02-08 10:18:51.927: E/AndroidRuntime(2494):     at android.app.Instrumentation.execStartActivity(Instrumentation.java:1382)
02-08 10:18:51.927: E/AndroidRuntime(2494):     at android.app.Activity.startActivityForResult(Activity.java:3095)
02-08 10:18:51.927: E/AndroidRuntime(2494):     at android.app.Activity.startActivity(Activity.java:3201)
02-08 10:18:51.927: E/AndroidRuntime(2494):     at com.example.valentinetimer.CardFront$1.onClick(CardFront.java:42)
02-08 10:18:51.927: E/AndroidRuntime(2494):     at android.view.View.performClick(View.java:3110)
02-08 10:18:51.927: E/AndroidRuntime(2494):     at android.view.View$PerformClick.run(View.java:11928)
02-08 10:18:51.927: E/AndroidRuntime(2494):     at android.os.Handler.handleCallback(Handler.java:587)
02-08 10:18:51.927: E/AndroidRuntime(2494):     at android.os.Handler.dispatchMessage(Handler.java:92)
02-08 10:18:51.927: E/AndroidRuntime(2494):     at android.os.Looper.loop(Looper.java:132)
02-08 10:18:51.927: E/AndroidRuntime(2494):     at android.app.ActivityThread.main(ActivityThread.java:4025)
02-08 10:18:51.927: E/AndroidRuntime(2494):     at java.lang.reflect.Method.invokeNative(Native Method)
02-08 10:18:51.927: E/AndroidRuntime(2494):     at java.lang.reflect.Method.invoke(Method.java:491)
02-08 10:18:51.927: E/AndroidRuntime(2494):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
02-08 10:18:51.927: E/AndroidRuntime(2494):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
02-08 10:18:51.927: E/AndroidRuntime(2494):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:08:43.513

代替：

```
Intent intent = new Intent (null, CardContent.class); 
```

采用：

```
Intent intent = new Intent (CardFront.this, CardContent.class); 
```

另一个导致“空指针”的错误，您尝试在调用“setContentView”之前使用“findViewById”，在尝试访问与活动布局有关的任何内容之前必须调用“setContentView”。一个好的做法是将它放在“super.onCreate”行之后。

另一件事，将 TAG 更改为具有实际字符串值而不是 Null。

*看到日志 cat 后编辑：* 第二个活动也应该在你的清单中声明。在那里添加它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:23:37.877

问题是您的 CardContent 类未在清单中正确指定。请将此添加到您的清单中的应用程序标记中：

```
<activity
    android:name=".CardContent">
</activity> 
```

# oauth - 签名方法 HMAC-SHA1 的签名无效

> ID：14777716
> 
> 赞同：1
> 
> 时间：2013-02-08T17:07:04.603
> 
> 标签：oauth, oauth-provider

我正在使用 oauth 1.0 提供程序实现来保护我的 api 作为安全机制。

我正在使用[Oauth 测试客户端](http://term.ie/oauth/example/client.php)来请求令牌、授权和获取访问令牌，它工作得很好。但是我无法使用它访问我的受保护资源，因为它不提供这样的功能。

所以我尝试使用[Netflix 客户端](http://developer.netflix.com/resources/OAuthTest)为 oauth 提供者生成调用。但是，当我尝试运行此类调用时，它们没有成功，而是给了我**HTTP Status 401 - Invalid signature for signature method HMAC-SHA1**。我尝试手动生成签名并使用一些[自动方法](http://hueniverse.com/oauth/guide/authentication/)，但都以相同的错误结束。

请你能告诉我我做错了什么吗？或者您能否向我推荐一些好的材料或提出任何解决方案？任何帮助将不胜感激。

# facebook - Facebook 应用程序 - 提示发帖权限

> ID：14777720
> 
> 赞同：0
> 
> 时间：2013-02-08T17:07:09.377
> 
> 标签：facebook, facebook-javascript-sdk

我创建了一个应用程序。在 GO to App 弹出窗口后，它不会提示用户在墙上发布权限。我在开发者帐户中为我的应用程序提供了以下设置。

```
User & Friend Permissions: email,user_activities,user_likes,publish_actions
Extended Permissions: publish_stream,read_stream,offline_access 
```

当我单击“预览登​​录对话框”链接时，它在“转到应用程序”弹出窗口中显示以下权限。

```
THIS APP WILL RECEIVE:

    Your basic info
    Your email address
    Your activities
    Your likes 
```

但是，当我第一次访问该应用程序时，它仅显示以下权限。

```
THIS APP WILL RECEIVE:

    Your basic info 
```

由于这个原因，我不能很好地发帖。我检查过。

同样，我检查了用户的应用设置页面。用户帐户没有如下选项。

```
* Post on your behalf
* Access posts in your news feeds 
```

怎么了？我花了3个多小时才知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:49:27.403

确保您在`scope`调用登录对话框的方法的参数中设置了预期的权限：

```
FB.login(function(response) {
   // handle the response
 }, {scope: 'email,user_activities,user_likes,publish_actions,etc...'}); 
```

为了以防万一，为确保您在执行需要权限的操作之前需要权限，请尝试处理已撤销的权限，正如我[在此处](https://stackoverflow.com/questions/14619403/facebook-game-with-open-graph-error-requires-extended-permission-publish-acti/14762389#14762389)指出的那样。

顺便说一句，请务必只请求您的应用真正需要的权限。你可以吓唬拥有这么多权限的用户。;)

# highcharts - 条形图的单独样式数据标签

> ID：14777722
> 
> 赞同：0
> 
> 时间：2013-02-08T17:07:11.937
> 
> 标签：highcharts

是否可以为条形图设置单个数据标签的样式？

我想将每个数据标签放置在每个条形下方的 0 轴点（对于图表）。但是，如果我为数据标签表示 x:0，则每个条形长度都不同。我可以把它放到图表的 0 轴上吗（用 5px 填充:)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T16:35:16.643

在这种情况下，您可以使用简单的技巧翻译该标签，请参阅：

```
 events: {
            load: function(){
                for(var i = 0; i < this.series[0].data.length; i++) {
                    var d = this.series[0].data[i];
                    d.dataLabel.translate(0, d.dataLabel.y);
                }
            }
        } 
```

现场示例：http: [//jsfiddle.net/zLE5R/2/](http://jsfiddle.net/zLE5R/2/)

# c# - 在 C# 中使用 OpenFileDialog 保存文件

> ID：14777724
> 
> 赞同：0
> 
> 时间：2013-02-08T17:07:26.817
> 
> 标签：c#

我实际上正在开发一个应用程序，从我的数据库中检索 blob 文件，转换为原始文件，然后保存在桌面上。我想知道是否可以检查桌面上是否已经存在名为“xxx”的文件，然后它会提示我输入另一个名称。这是我的代码：

```
myData.Read();

FileSize = myData.GetUInt32(myData.GetOrdinal("filesize"));
rawData = new byte[FileSize];

myData.GetBytes(myData.GetOrdinal("file"), 0, rawData, 0, (int)FileSize);

// must change paths
String desktopPath = Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory);
fs = new FileStream(@desktopPath + "\\" + myData.GetString("title") + myData.GetString("extension"), FileMode.OpenOrCreate, FileAccess.Write);

myFilePath = desktopPath + "\\" + myData.GetString("title") +myData.GetString("extension");

fs.Write(rawData, 0, (int)FileSize);
fs.Close(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:08:40.543

您正在寻找`File.Exists()`功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:14:51.583

我看不到您`OpenFileDialog`在代码中使用的位置，但您应该使用`SaveFileDialog`类来保存文件并设置它的属性`CheckFileExists=true`

# java - 如何重命名一组 JButton？

> ID：14777727
> 
> 赞同：0
> 
> 时间：2013-02-08T17:07:40.250
> 
> 标签：java, swing, loops, jbutton, settext

我有 25 个 jButton，我想从循环中更改它们的文本。这是我的 1 个按钮的代码..

```
void changeText(){
            jButton1.setText(jButton1.getText().toUpperCase());

    } 
```

我想对所有其他按钮执行相同的操作，而无需为每个按钮编写方法。

可以使用这样的东西吗？

```
void changeText(){
        for(int i=0;i<25;i++){
            String x = "jButton"+i;
            x.setText(x.getText().toUpperCase());
        }
    } 
```

这肯定行不通。请给我一个方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:14:56.900

您可以通过将按钮添加到集合来做到这一点。

像这样的东西：

```
// initialization of jbuttons:
List<JButton> buttons = new ArrayList<JButton>();
JButton jbutton1 = new JButton();
// .. set properties
buttons.add(jbutton1);

// add more jbuttons to the list 
```

稍后您可以遍历按钮列表：

```
for (JButton button : buttons) {
  button.setText(button.getText().toUpperCase());
} 
```

# gnuplot - 使用 gnuplot 创建点组直方图

> ID：14777731
> 
> 赞同：4
> 
> 时间：2013-02-08T17:07:54.633
> 
> 标签：gnuplot

我想用 gnuplot 创建一个这样的情节：

![在此处输入图像描述](../Images/2c2a7a4bd54ca730661cec4cdbe845d1.png)

我在固定的时间有不同的数据点。我想围绕代表 x 值对这些数据点进行分组。这些数据点来自不同的数据文件，如下所示：

```
9 0.333
9 0.308
9 0.289
15 0.356
15 0.836
15 0.364
15 0.347
0 0.386
0 0.318
0 0.347
0 0.322
12 0.351
12 0.314
12 0.314 
```

目前我使用这样的循环绘制数据：

```
set xtics (0, 3, 6, 9, 12, 15, 18, 21)
plot for [i=1:15] sprintf('file_%i.dat', i) using 1:2 with points 
```

但它们是重叠的。如何使用 gnuplot 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T19:15:52.510

您可能必须手动为每组点设置偏移量，如下所示：

```
#!/usr/bin/env gnuplot

o1 = 0.1 # x-offset for each set of points on plot
n = 15   # number of files, integer
# x-offset for leftmost set of points.
# this will center all sets of points around the central x value,
# whether there are an even or odd number of sets
o2 = (n/2.0 - 0.5) * o1

set xtics (0, 3, 6, 9, 12, 15, 18, 21)

plot for [i=1:n] sprintf('file_%i.dat', i) using ($1-o2+i*o1):2 with points 
```

（我认为这应该可行，但我现在无法测试。）

# c# - 使用 File.Encrypt 加密文件，然后将其解密到内存流

> ID：14777732
> 
> 赞同：6
> 
> 时间：2013-02-08T17:07:54.553
> 
> 标签：c#, file, memory, encryption

我需要实现一个简单的文件加密，然后在需要时将其解密到内存流中。最简单的方法似乎是使用 File.Encrypt 执行此操作，但是是否可以将文件解密到内存流，而不是在将文件读取到内存流之前解密文件，从而将其暴露一段时间？

如果 File.Encrypt 不是这种情况的最佳方式，您会推荐什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:19:00.840

`File.Encrypt`是一项操作系统功能，但听起来您真的想控制加密的完成方式。

[http://msdn.microsoft.com/en-us/library/system.io.file.encrypt.aspx](http://msdn.microsoft.com/en-us/library/system.io.file.encrypt.aspx)

```
// This is where the data will be written do.
MemoryStream dataStream = new MemoryStream();

// The encryption vectors
byte[] key = {145,12,32,245,98,132,98,214,6,77,131,44,221,3,9,50};
byte[] iv  = {15,122,132,5,93,198,44,31,9,39,241,49,250,188,80,7};

// Build the encryption mathematician
using (TripleDESCryptoServiceProvider encryption = new TripleDESCryptoServiceProvider())
using (ICryptoTransform transform = encryption.CreateEncryptor(key, iv))
using (Stream encryptedOutputStream = new CryptoStream(dataStream, transform, CryptoStreamMode.Write))
using (StreamWriter writer = new StreamWriter(encryptedOutputStream))
{
    // In this block, you do your writing, and it will automatically be encrypted
    writer.Write("This is the encrypted output data I want to write");
} 
```

加密不适合胆小的人。不过请注意，在尝试此操作之前，您确实应该对常规 IO 和数据流有很强的了解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T19:39:53.157

实施 Crypto 看似简单，实际上相当乏味，有很多细节，而错误的细节通常是安全方面的利用。最佳实践是使用隐藏这些细节的高级加密框架 ivs、salts、mac、比较、填充、密钥轮换，虽然高级框架不太可能有细节错误，但当它们出现时，它们会被发现并且已修复，堆栈溢出的代码片段通常不会。

我一直在移植[Google Keyczar](http://keyczar.org)框架，因此 C# 将存在这样一个高级库。

[Keyczar-dotnet](http://jbtule.github.com/keyczar-dotnet/)

它可用于加密和解密 io 流。

[使用nuget](http://nuget.org)安装在您的项目中

```
PM> Install-Package Keyczar -Pre 
```

然后创建您的密钥集。（通过拥有一个单独的密钥集文件，它使您能够在将来轮换密钥，并防止您意外地对不应进行硬编码的内容进行硬编码。）

```
PM> KeyczarTool.exe create --location=path_to_key_set --purpose=crypt
PM> KeyczarTool.exe addkey --location=path_to_key_set --status=primary 
```

然后在您的代码中，您可以使用任何您想要的 IO 流进行加密：

```
using(var encrypter = new Encrypter("path_to_key_set"))
{
     encrypter.Encrypt(plaintextStream, ciphertextStream);
} 
```

和解密：

```
using(var crypter = new Crypter("path_to_key_set"))
{
     crypter.Decrypt(ciphertextStream, plaintextStream);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T17:12:19.877

这是我编写的第一个加密代码 - 请注意，虽然这是了解正在发生的事情的一个很好的起点，但静态密码和静态盐是一个坏主意！（感谢您突出显示此 CodesInChaos）

您可以解密到任何您喜欢的流，包括直接到内存流...

```
FileInfo file = new FileInfo("SomeFile");
using (FileStream inFs = file.OpenRead())
{
    using (MemoryStream outMs = new MemoryStream())
    {
        encryption.Decrypt(inFs, outMs);                    

        BinaryFormatter bf = new BinaryFormatter();
        targetType target= bf.Deserialize(outMs) as targetType;
    }
} 
```

其中加密是其中之一：

```
public class EncryptionHelper
{        
    static SymmetricAlgorithm encryption; 
    static string password = "password";
    static string salt = "this is my salt. There are many like it, but this one is mine.";

    static EncryptionHelper()
    {
        encryption = new RijndaelManaged();
        Rfc2898DeriveBytes key = new Rfc2898DeriveBytes(password, Encoding.ASCII.GetBytes(salt));

        encryption.Key = key.GetBytes(encryption.KeySize / 8);
        encryption.IV = key.GetBytes(encryption.BlockSize / 8);
        encryption.Padding = PaddingMode.PKCS7;
    }

    public void Encrypt(Stream inStream, Stream OutStream)
    {
        ICryptoTransform encryptor = encryption.CreateEncryptor();
        inStream.Position = 0;
        CryptoStream encryptStream = new CryptoStream(OutStream, encryptor, CryptoStreamMode.Write);
        inStream.CopyTo(encryptStream);
        encryptStream.FlushFinalBlock();

    }

    public void Decrypt(Stream inStream, Stream OutStream)
    {
        ICryptoTransform encryptor = encryption.CreateDecryptor();
        inStream.Position = 0;
        CryptoStream encryptStream = new CryptoStream(inStream, encryptor, CryptoStreamMode.Read);
        encryptStream.CopyTo(OutStream);
        OutStream.Position = 0;  
    }
} 
```

# php - 具有根和子类别的特定数组

> ID：14777733
> 
> 赞同：0
> 
> 时间：2013-02-08T17:08:06.783
> 
> 标签：php, mysql, arrays, recursion

使用 PHP 和 MySQL。

我有一个表（类别），只有三个字段，**id**，**name**，**parent**。

其中**parent**在根类别上为 0，如果它是从另一个派生的，则为整数。

但是我们可以在其中有几个级别，例如：

```
id, name, parent
01, Name 01, 00
02, Name 02, 00
03, Name 03, 00
04, Name 04, 02
05, Name 05, 01
06, Name 06, 01
07, Name 07, 05
08, Name 07, 05
09, Name 09, 04
10, Name 10, 07
11, Name 11, 10 
```

我们如何返回一个包含根及其所有子节点的数组？例如，对于 id=1，数组应该是：

```
array (
    1 => array(
        id => 1,
        name => 'Name 1'
    ),
    5 => array(
        id => 5,
        name => 'Name 5'
    ),
    6 => array(
        id => 6,
        name => 'Name 6'
    ),
    7 => array(
        id => 7,
        name => 'Name 7'
    ),
    8 => array(
        id => 8,
        name => 'Name 8'
    ),
    10 => array(
        id => 10,
        name => 'Name 10'
    ),
    11 => array(
        id => 11,
        name => 'Name 11'
    )
); 
```

我看过这个[链接](https://stackoverflow.com/questions/2398402/recursive-function-to-get-all-the-child-categories)并尝试了一些变化，但我还没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:20:10.670

这个 SQL 查询应该得到你想要的数据：

```
 SELECT DISTINCT c.id as id, c.name as name FROM category c, category s WHERE s.parent = $id OR c.id = $id; 
```

然后你可以[`mysqli_fetch_assoc`](http://www.php.net/manual/en/mysqli-result.fetch-assoc.php)用来获取你需要的数组的一部分。如果您需要数组索引与 SQL 索引匹配，那么您可以迭代结果`mysqli_fetch_assoc`并将其放入一个新数组中：

```
 $target = array();
    while ( $row = mysqli_fetch_assoc( $result ) ) {
         $target[$row["id"]] = $row;
    } 
```

# c# - 从 JOIN 中获取 DISTINCT 值

> ID：14777736
> 
> 赞同：0
> 
> 时间：2013-02-08T17:08:20.817
> 
> 标签：c#, linq, join, distinct

我目前有以下 LINQ 语句：

```
using (MYEntities ctx = CommonMY.GetMYContext())
{
    List<datUser> lstC = (from cObj in ctx.datUser 
                          join fs in ctx.datFS on cObj.UserID equals fs.datUser.UserID 
                          where userOrg.Contains(fs.userOrg.OrgName)
                          select cObj).ToList();

    foreach (datUser c in lstC)
    {
        Claim x = new Claim
        {
            UserID= c.userID,
            FirstName = c.FirstName,
            LastName = c.LastName,
            MiddleName = c.MiddleName,
        };
    }
} 
```

现在它返回所有用户，但如果他们有超过 1 个与他们关联的组织，它会复制他们。我如何确保它只返回不同的用户 ID？

每个用户可以有多个组织，但我真的只需要从 userOrg 列表中返回至少有 1 个组织的用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:14:07.303

在您的 ToList 之前，放入`.Distinct()`.

作为对@DJ BURB 的回应，您可能应该使用接收 IEqualityComparer 的 Distinct 重载，以最好地确保您是根据每条记录的唯一 ID 执行此操作的。

查看[此博客文章](http://www.blackwasp.co.uk/IEqualityComparer.aspx)以获取示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:21:40.397

使用分组。

句法：

```
var result= from p in <any collection> group p by p.<property/attribute> into grps
             select new 
             {
               Key=grps.Key,
               Value=grps
             } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T17:14:37.777

您将不得不调用[`Distinct()`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.distinct.aspx)，[没有与该命令等效的 linq 查询](http://blogs.msdn.com/b/charlie/archive/2006/11/19/linq-farm-group-and-distinct.aspx)。

# algorithm - 范围最小查询 方法（从树到受限 RMQ）

> ID：14777743
> 
> 赞同：10
> 
> 时间：2013-02-08T17:08:37.570
> 
> 标签：algorithm, tree, least-common-ancestor, rmq, cartesian-tree

因此，我阅读[了](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=lowestCommonAncestor#Sparse_Table_%28ST%29_algorithm)有关 RMQ（范围最小查询）的 TopCoder 教程，我遇到了一个大问题。

在他介绍[方法](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=lowestCommonAncestor#A%20O%28N%29,%20O%281%29%20algorithm%20for%20the%20restricted%20RMQ)的部分，到目前为止我能理解的是：

（整个方法实际上使用了[稀疏表（ST）算法](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=lowestCommonAncestor#Sparse_Table_%28ST%29_algorithm)中引入的方法，[从 LCA 到 RMQ](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=lowestCommonAncestor#Reduction%20from%20LCA%20to%20RMQ)以及[从 RMQ 到 LCA](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=lowestCommonAncestor#From%20RMQ%20to%20LCA)的缩减）

给定一个数组 A[N]，我们需要将其转换为笛卡尔树，从而使 RMQ 问题成为 LCA（最低公共祖先）问题。稍后，我们可以得到数组 A 的简化版本，并使其成为受限 RMQ 问题。

所以它基本上是两个转换。所以第一个 RMQ 到 LCA 部分很简单。通过使用堆栈，我们可以在 O(n) 时间内进行转换，得到一个数组 T[N]，其中 T[i] 是元素 i 的父元素。树就完成了。

但这是我无法理解的。O(n) 方法需要一个数组 where `|A[i] - A[i-1]| = 1`，并且该数组在本教程的[从 LCA 到 RMQ 的缩减部分中进行了介绍。](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=lowestCommonAncestor#Reduction%20from%20LCA%20to%20RMQ)这涉及到这棵树的欧拉之旅。但是，如何通过转换的最终结果来实现呢？我的方法不是线性的，所以在这种方法中应该被认为是不好的，线性方法是什么？

更新：让我感到困惑的一点

```
Here's the array A[]:

  n : 0  1  2  3  4  5  6  7  8  9
A[n]: 2  4  3  1  6  7  8  9  1  7

Here's the array T[]:

  n : 0  1  2  3  4  5  6  7  8  9
T[n]: 3  2  0  *  8  4  5  6  3  8  // * denotes -1, which is the root of the tree

//Above is from RMQ to LCA, it's from LCA to RMQ part that confuses me, more below. 
```

树的图片：

![数据中的笛卡尔树](../Images/1895759e9ea40d8417876e2fd74d6bf5.png)

Euler Tour 需要知道每个节点的子节点，就像 DFS（深度优先搜索）一样，而 T[n] 只有每个元素的根，而不是子节点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-08T18:01:18.943

这是我目前对让您感到困惑的事情的理解：

1.  为了将 RMQ 简化为 LCA，您需要将数组转换为树，然后对该树进行欧拉之旅。
2.  为了进行欧拉之旅，您需要存储树，使每个节点都指向其子节点。
3.  从 RMQ 到 LCA 列出的缩减使每个节点都指向其父节点，而不是其子节点。

如果是这种情况，您的担忧是完全有道理的，但有一种简单的方法可以解决这个问题。具体来说，一旦有了所有父指针的数组，就可以将其转换为树，其中每个节点在 O(n) 时间内指向其子节点。思路如下：

*   创建一个包含 n 个节点的数组。每个节点都有一个值字段、一个左孩子和一个右孩子。
*   最初，将第 n 个节点设置为具有空左子节点、空右子节点以及数组中第 n 个元素的值。
*   遍历 T 数组（其中 T[n] 是 n 的父索引）并执行以下操作：
    *   如果 T[n] = *，则第 n 个条目是根。您可以将其存储起来以备后用。
    *   否则，如果 T[n] < n，那么您知道节点 n 必须是其父节点的右子节点，其存储在位置 T[n] 处。所以将第 T[n] 个节点的右孩子设置为第 n 个节点。
    *   否则，如果 T[n] > n，那么您知道节点 n 必须是其父节点的左子节点，其存储在位置 T[n] 处。所以将第 T[n] 个节点的左子节点设置为第 n 个节点。

这在 O(n) 时间内运行，因为每个节点只被处理一次。

完成此操作后，您就明确构建了所需的树结构并拥有指向根的指针。从那里开始，继续算法的其余部分应该相当简单。

希望这可以帮助！

# python - Python：跨 TCP 客户端/服务器传递多个变量

> ID：14777745
> 
> 赞同：0
> 
> 时间：2013-02-08T17:08:39.960
> 
> 标签：python, tcp, python-3.x, client-server

我正在使用 Python 3.3 创建 TCP 客户端和服务器，而且我对同时使用 Python 和套接字是新手。我的问题是我需要能够将通过连接传递的任何内容存储为单独的变量，以便写入各种文件等。

我不确定如何做到这一点，因为这一切似乎都是我无法单独存储的一个数据流。下面是我最新的工作代码，它所做的只是通过连接发送我需要的数据。我是否应该尝试将所有数据作为列表发送并将其解构为单独的变量？我可以单独访问它们而我还没有弄清楚吗？我的方法全错了吗？

服务器代码：

```
import os
from socket import *

HOST = '' #We are the host
PORT = 29876
ADDR = (HOST, PORT)
BUFFSIZE = 4096

serv =  socket( AF_INET,SOCK_STREAM)
serv.bind(ADDR,) #Create tuple with one element
serv.listen(5)
print ('listening...')

conn,addr = serv.accept()
print (conn,addr)
print ('...connected')

with open(os.path.expanduser("~/.ssh/id_rsa.pub")) as f:
    key = f.read()
    conn.sendall(key)
print(key)

while True:
    data = conn.recv(BUFFSIZE)
    print(data)

conn.close() 
```

客户端代码：

```
from socket import *
import os
import socket

HOST = 'xxx.xxx.xxx.xxx'
PORT = 29876 #Must match server.py
ADDR = (HOST,PORT)
BUFFSIZE = 4096

cli = socket.socket( AF_INET, SOCK_STREAM)
cli.connect(ADDR,)

s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
s.connect(("gmail.com",80))
ip = ((s.getsockname()[0]))
ip = ip.encode('utf-8')
cli.send(ip)

while True:
    data = cli.recv(BUFFSIZE)
    print (data)

cli.close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:39:14.100

**服务器：**

```
from socket import *
from os.path import isfile

s = socket()
s.bind(('', 1234))
s.listen(4)
ns, na = s.accept()

loopdata = {}

i = 0
while 1:
    try:
        data = ns.recv(8192)
    except:
        break

    for line data.split('\n'):
        if line == 'version':
            print na[0] + ' requested a version'
            ns.send('1.0\n')
        elif line == 'key':
            print na[0] + ' is requesting a key'
            if isfile(na[0] + '.key'):
                with open(na[0] + '.key') as f:
                    ns.send(f.read())
            else:
                ns.send('Missing key file!\n')
        loopdata[i] = line

        #ns.send('OK\n')
        i += 1
ns.close()
s.close()

print loopdata # <- Print all the lines 
```

**客户：**

```
from socket import *
s = socket()
s.connect(('127.0.0.1', 1234))

s.send('version\n')
print 'Client got:', s.recv(8192)
s.close() 
```

我不确定您要保存/存储/响应什么，您在代码和客户端代码中提到了一些有关密钥的内容，您创建了多个套接字但只真正使用了一个.. 那是为了打印任何服务器正在发送？

开始清理，在混合之前尝试弄清楚事情。并陈述一个你想用你的代码实现的明确目标？你想寄什么？发送 X 时，您希望服务器响应什么？

**策略：**

```
 1\. You want to define a protocol,
    1.1 Command separator
    1.2 Command structure (ex: command:parameter:data\n)
    1.3 sates (ex login state etc etc..) 
```

在你知道你想做什么之后，前文件共享：

```
c->s: get:file:/root/storage/file.txt\n
c<-s: file:content\n
c<-s: <file data>\n\n
c<-s: file:close\n
c->s: file:recieved 
```

例如。

# function - haskell中的tops函数是什么？

> ID：14777747
> 
> 赞同：0
> 
> 时间：2013-02-08T17:08:43.380
> 
> 标签：function, haskell, hugs

在我大学的一门函数式编程科目的期末考试中，有一个问题的代码清单使用了一个名为**tops**的函数。

[我在官方教科书hoogle](http://www.haskell.org/hoogle/?hoogle=tops)、[prelude index](http://www.haskell.org/onlinereport/prelude-index.html)和[该死的](http://zvon.org/other/haskell/Outputprelude/index.html)[internet](https://www.google.es/search?q=haskell%20%22tops%20function%22)中找不到任何关于该功能的[信息](http://cheatsheet.codeslower.com/CheatSheet.pdf) ，而且我的 hugs 解释器似乎无法识别它（WinHugs 98，v. 2006 年 9 月），即使有 hugs 扩展启用，要么。

我猜这是一个非常旧的版本中的某种已弃用的功能。任何人都更清楚这个 tops 函数是什么，或者即使它真的存在？

**更新：**

我找到了一份试卷。这是问题：

1.  函数whatdoido计算什么？

> ```
> whatdoido [] = [[]]
> whatdoido (x:xs) = concat [[x:t] | t <- tops xs] 
> ```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T21:01:32.967

让我们看看我们可以推断出什么，同时我们四处寻找做了什么`tops`。

```
whatdoido [] = [[]]
whatdoido (x:xs) = concat [[x:t] | t <- tops xs] 
```

如果我们假设，`(x:xs)::[a]`那么对于一些可能的多态/单态/类限制类型也是如此。`[x:t]::[[a]]``concat [[x:t] | t <- tops xs] :: [[a]]``tops xs :: [[a]]``tops :: [a] -> [[a]]``a`

很明显，该函数`whatdoido`获取其输入的尾部，在其`tops`上运行并将其输入的头部弹出到由返回的每个列表的前面`tops`。

特别是，有人建议这`tops`只是 的一个错字`whatdoido`，在这种情况下，基本方程将意味着`whatdoido xs = [xs]`。

另一个建议是from`tops`的错字。如果是这样，这是一个令人惊讶的拼写错误，但在这种情况下，您会得到类似.`tails``Data.List``whatdoido "Hi!" = ["Hi!", "H!", "H"]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:35:33.123

除了hoogle，另一个搜索的地方是[hayoo](http://holumbus.fh-wedel.de/hayoo/hayoo.html "哈优")。我在那里也找不到`tops`函数，所以我怀疑这是你的老师在别处定义的函数。但是，hayoo 和 hoogle 不会索引 Hackage DB 中的每个包，因此它可能是在 Hackage 上的模块中定义的。

# .net - 需要 Git SC 和 Git 源代码控制提供商 SOS

> ID：14777749
> 
> 赞同：2
> 
> 时间：2013-02-08T17:08:48.147
> 
> 标签：.net, visual-studio-2010, git

我正在使用 VS 2010 构建应用程序。我使用了 Git 源代码控制系统和 Git 源代码控制提供程序插件的服务。由于我已经完成了 90% 的解决方案，我决定对应用程序的架构进行重大更改，因此我删除了几个项目、文件，添加了其他项目，并在解决方案中到处进行了各种更改。但在我做这一切之前，我对整个解决方案做出了承诺。然后当我决定回到那个承诺时，我 50% 左右的辛勤工作已经消失了。很多删除的文件没有回来，有些项目回来是空的。如果有任何希望恢复我的工作，我需要帮助。提交的历史仍然存在，从那以后我没有触及解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:24:50.633

只是一个理论，但也许你丢失了之前的提交。如果是这样，请尝试 git reflog（请参阅[此处](http://gitready.com/intermediate/2009/02/09/reflog-your-safety-net.html)）或按照本[指南](http://gitready.com/advanced/2009/01/17/restoring-lost-commits.html)查找丢失的提交。如果您提交了文件，那么它们应该在某个地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:42:42.390

1.  检查您是否有备份可以使用。
2.  尝试`git fsck`从命令行使用来验证 Git 存储库的完整性。

# javascript - jQuery 下拉列表包含过滤器

> ID：14777751
> 
> 赞同：0
> 
> 时间：2013-02-08T17:09:09.230
> 
> 标签：javascript, jquery, select, drop-down-menu, contains

我有两个过滤内容的下拉列表。第一个是位置，第二个是工作。第一个列表过滤第二个。我正在使用 :contains 来读取允许我的过滤器工作的字符串值。当我想一次使用两个包含作为过滤器时，我遇到了问题。这是代码：

**HTML**

```
<div class="holder">
<label for="volunteerLocation">Where do you want to volunteer?</label><br>
<select id="locations">
    <option value="0">--Select a Campus--</option>
    <option value="5">Location 1</option>
    <option value="6">Location 2</option>
    <option value="7">Location 3</option>
</select>
</div>

<br />

<div class="holder">
<label for="volunteerJobs">In which area would you like to serve?</label><br />
<select id="jobs">
    <option value="1">Job 1 (Location 1)</option>
    <option value="2">Job 2 (Location 2)</option>
    <option value="3">Job 3 (Location 3)</option>
    <option value="4">Job 4 (All locations)</option>
</select>
</div> 
```

**Javascript**

```
var select = $('#jobs');
var options = [];
$(select).find('option').each(function () {
    options.push({ value: $(this).val(), text: $(this).text() });
});
$(select).data('options', options);

$('#locations').change(function () {
    filterText = $("#locations option:selected").text();
    var optionList = $(select).empty().data('options');
    var j = 0;

    $.each(optionList, function (i) {
        var option = options[i];
        if (option.text.indexOf(filterText) !== -1) {
            if (j == 0) {
                $('#jobs').prepend("<option value=''>--Select a Job--</option>").val('');
                j++;
            };
            $(select).append(
                $('<option>').text(option.text).val(option.value)
            );
        }

        if (filterText == "--Select a Campus--") {
            $(select).append(
                $('<option>').text(option.text).val(option.value)
            );
        }
    })
}) 
```

这是一个 JSLint，因此您可以在操作中看到它[完整示例](http://jsfiddle.net/kLamE/2/)

我试图让“工作 4”出现在除“选择校园”选项之外的所有内容上。我怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:59:10.080

我不会在每次位置更改时循环使用 .each 并经历异常，而是会在页面加载时创建一个索引

```
var locJobs=new Array(); 
```

然后你用你的数据填充它，例如

```
locJobs['5']=new Array();
locJobs['5'] = ['job 1','job 2'] 
```

然后改变

```
$("#jobs").html('<option>'+locJobs[$(this).val()].join('</option><option>')+'</option>'); 
```

如果您需要在#jobs 的选项上添加值，则必须使该代码段复杂一些。它应该更有效并且也使维护更容易（没有例外，只处理一个从您使用的任何数据源填充的数组），因为您最终将获得一个非常灵活的解决方案

注意：您声明`var select = $("#jobs")`但随后使用 $(select); 这是一个无用的开销`select`直接使用

保持代码清晰的约定是将 $ 添加到缓存 jquery 对象的任何变量中：

```
 var $select=$("#select") 
```

然后你用`$select.whtever(//...`

# javascript - Javascript Infinity-- (infinity minus minus) 产生 Infinity

> ID：14777757
> 
> 赞同：4
> 
> 时间：2013-02-08T17:09:28.000
> 
> 标签：javascript, infinity

我正在研究 JavaScript 的数字类型系统。

我正在使用 Chrome，当我评估`15--`一个数字文字时，我得到一个`ReferenceError`，因为递减一个常数是没有意义的。

当我按预期进行评估时`var x=10;x--;`，一切正常。

预期`var a=Infinity;a--`评估为`Infinity`，这一切都有意义并且符合[javascript 语言规范](http://www.ecma-international.org/ecma-262/5.1/)。

然而令我惊讶的是`Infinity--`，`Infinity++`它`Infinity`与其他文字不同。

这也发生`Number.POSITIVE_INFINITY`在相同的情况下。

**tl;博士：**

为什么在产生参考误差时会`Infinity--`产生无穷大？`15--``(new Number(15))--`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-08T17:10:59.540

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:15:34.697

Because there is no such thing as a the number infinity, it is a concept, and thus in coding it isn't built as other constants but as an object like null or undefined but with some properties thrown in to make it behave nice with Math methods.

# javascript - HTML 上的 JavaScript 变量

> ID：14777759
> 
> 赞同：0
> 
> 时间：2013-02-08T17:09:37.823
> 
> 标签：javascript

我正在尝试使用 JavaScript 变量的值；但是，由于某种原因，`document.write`无法正常工作。

你能告诉我我做错了什么以及是否有其他方法可以做到这一点？这是我的 JavaScript 代码：

```
<script type="text/javascript">
    var url=${paramValue};
    url = url.replace(/\s/g,"%20");
    document.write("<a href='" + url + "'>" +
        "<img src='/folder1/folder2/folder3/folder4/folder5/image.png'" +
        " width='70' height='20'></a>");
</script> 
```

该变量`url=${paramValue};`正在工作，因为我可以用萤火虫检查它。图像未出现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:17:16.673

什么是解析你的 url 变量？"${paramValue}" 不会被 JS 解释器解释。

不要费心在 Javascript 中手动解码/编码 URL ...只需使用内置的：

编码URIComponent(str) 编码URI(str)

[在 JavaScript 中编码 URL？](https://stackoverflow.com/questions/332872/how-to-encode-a-url-in-javascript)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:18:22.643

我认为您需要在参数周围加上引号，因此 javascript 在替换后将其解释为字符串：

```
var url='${paramValue}'; 
```

但我同意 Hank - 使用内置函数。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-08T17:24:14.643

```
<html> 
<head>
<script type="text/javascript"> 
function myfunction(){
    var url = $("#<%=url.ClientID %>").val();
    document.write("<a href='" + url + "'><img src='abc.jpg' width='70'height='20'>    
    </a>");
}
</script>
</head>
<body>
<form runat="server">
   <asp:TextBox ID="url" runat="server" />
   <input type="button" value="Clear" onclick="myfunction()" />
</form>
</body>  
</html> 
```

# performance - POCO 实体生成器或 edmgen entityclassgeneration：性能问题

> ID：14777760
> 
> 赞同：1
> 
> 时间：2013-02-08T17:09:39.597
> 
> 标签：performance, entity-framework, poco, edmgen

我正在从事一个项目，其中性能是成功的关键因素。我需要决定是否使用 POCO 实体生成器。我可能会使用 entityclassgeneration 而不是 POCO，但我不确定性能是否会受到影响。

我应该考虑的另一件事是必须使用存储过程。我不确定在开发阶段后期使用 POCO 实体生成器模板是否会给我带来一些问题。特别是存储过程。

任何建议都会对使用 POCO 实体生成器或实体类生成有所帮助。顺便说一句，我使用的是 Entity Framework 5.0 和 MySQL 数据库。

# mysql - mysql while循环的范围

> ID：14777762
> 
> 赞同：0
> 
> 时间：2013-02-08T17:09:44.057
> 
> 标签：mysql

我在使用 mysql while 循环时遇到了一些问题。

```
DECLARE vdate DATETIME DEFAULT now();
DECLARE vday int default 0;
WHILE (vday <  7) DO

    WHILE (vdate <  DATE_ADD(NOW(),INTERVAL 1 DAY)) DO

    //Here vday is always 0

    END WHILE;

//Here vday is 0 -6
SELECT vday +1 INTO vday;

END WHILE; 
```

谁能为我澄清一下mysql中while循环的范围是什么？如何创建可以在嵌套循环中使用的变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T11:12:34.013

结果我错过了一些明显的东西（星期五晚些时候的问题:)）。在每个 vday 循环之后，我没有将 vdate 设置回 now()。因此它只会在 vday 为 0 时进入子循环。

# c# - 如何在 .net 中使用 SmtpClient 发送邮件？

> ID：14777774
> 
> 赞同：0
> 
> 时间：2013-02-08T17:10:23.313
> 
> 标签：c#, smtp, smtpclient

我有以下代码不起作用：

```
public static void SendMail(string content, string title, List<string> address)
{
   SmtpClient client = new SmtpClient(Server,Port);
   client.Port = Port;
   client.Host = Server;
   client.EnableSsl = false;
   client.Timeout = 10000;
   client.DeliveryMethod = SmtpDeliveryMethod.Network;
   client.UseDefaultCredentials = false;
   client.Credentials = new System.Net.NetworkCredential(Username, Password);

   foreach(string to in address)
   {
      MailMessage mm = new MailMessage(From, to, title, content);
      mm.BodyEncoding = UTF8Encoding.UTF8;
      mm.DeliveryNotificationOptions = DeliveryNotificationOptions.OnFailure;

      client.Send(mm);
   }
   client.Dispose();
} 
```

我收到以下错误：

> 信箱不可用。服务器响应是：您必须提供您的用户名和密码才能通过此服务发送邮件

您可以看到我正在传递用户名和密码。为什么我仍然遇到这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:16:58.153

这里我使用的是使用 gmail 服务器的示例

```
MailMessage mail = new MailMessage();
        mail.To.Add(textBox1.Text);

        mail.From = new MailAddress("Yourgmailid");
        mail.Subject = "Email using Gmail";

        string Body = "Hi, this mail is to test sending mail" +
                      "using Gmail in ASP.NET";
        mail.Body = Body;

        mail.IsBodyHtml = true;
        SmtpClient smtp = new SmtpClient();
        smtp.Host = "smtp.gmail.com"; 
        smtp.Credentials = new System.Net.NetworkCredential
             ("Yourgmailid, "Password");

        smtp.EnableSsl = true;
        smtp.Send(mail); 
```

# c++ - getline 不能与 fstream 一起使用

> ID：14777775
> 
> 赞同：1
> 
> 时间：2013-02-08T17:10:31.477
> 
> 标签：c++, fstream, getline

我正在尝试使用文本文件来初始化将用于初始化 2d 向量的结构，是的，我知道这很复杂，但最终会有很多数据需要处理。问题出在getline，我在其他代码中以这种方式使用它，但由于某种原因它拒绝在这里工作。我不断收到参数错误和模板错误。任何提示将不胜感激。

```
#include <fstream>
#include <string>
#include <vector>
#include <iostream>

using namespace std;

const int HORIZROOMS=10;
const int VERTROOMS=10;
const int MAXDESCRIPTIONS=20;
const int MAXEXITS=6;

struct theme
{
    string descriptions[MAXDESCRIPTIONS];
    string exits[MAXEXITS];
};

void getTheme();

int _tmain(int argc, _TCHAR* argv[])
{
    getTheme();
    vector<vector <room>> rooms(HORIZROOMS, vector<room>(VERTROOMS));
    for (int i=0; i<HORIZROOMS; i++)
    {
        for (int j=0; j<VERTROOMS; j++)
        {
            cout<<i<<" "<<j<<" "<<rooms[i][j].getRoomDescription()<<endl;
        }
    }
    return 0;
}

void getTheme()
{
    theme currentTheme;
    string temp;
    int numDescriptions;
    int numExits;
    ifstream themeFile("zombie.txt");
    getline(themeFile, numDescriptions, ',');
    for (int i=0; i<numDescriptions; i++)
    {
        getline(themeFile, temp, ',');
        currentTheme.descriptions[i]=temp;
    }
    getline(themeFile, numExits, ',');
    for (int i=0; i<numExits; i++)
    {
        getline(themeFile, temp, ',');
        currentTheme.exits[i]=temp;
    }
    themeFile.close();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:14:36.070

`std::getline`用于从流中提取到`std::string`. 当您提取到`numDescriptions`and`numExits`时，您真正想要的是`operator>>`. 例如，

```
themeFile >> numDescriptions; 
```

这将在以下自动停止提取`,`。`std::getline`但是，如果您不希望它出现在下一次提取中，则需要跳过该逗号：

```
themeFile.ignore(); 
```

或者，你可以有一个`std::string numDescriptionsString`你做的事情`std::getline(themeFile, numDescriptionsString, ',')`，然后将它转换`std::string`为一个`int`with `std::stoi`：

```
getline(themeFile, numDescriptionsString, ',');
numDescriptions = std::stoi(numDescriptionsString); 
```

我会说这更丑陋。

# azure - SQL Azure 可靠性和可扩展性

> ID：14777777
> 
> 赞同：0
> 
> 时间：2013-02-08T17:10:49.527
> 
> 标签：azure, azure-sql-database

我需要确保我的数据库的可用性很高。使用 SQL Azure 并不清楚。
有没有办法在 SQL Azure 下运行多台服务器（如果一台服务器出现故障，一台服务器会接管？），上面是否有相当于增加数据库服务器上的内存来加速数据库处理的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T18:05:24.690

[阅读Azure SQL 简介中的](http://msdn.microsoft.com/en-us/library/windowsazure/ee336230.aspx)高可用性，然后阅读[Windows Azure SQL 数据库中的业务连续性](http://msdn.microsoft.com/en-us/library/windowsazure/hh852669.aspx)。总结一下：

> 通过在位于完全独立的物理子系统（例如服务器机架和网络路由器）的不同物理节点中维护所有数据的多个副本来增强数据持久性和容错性。在任何时候，Windows Azure SQL 数据库都会保持三个数据副本运行——一个主副本和两个辅助副本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T20:23:55.957

目前无法为 SQL Azure 数据库指定硬件配置。这完全不受您的控制，从 SAAS 的角度来看，这是有道理的。后端管理服务负责确保您获得最佳性能。

如果您的 SQL 部署需要专用和保留的硬件，您可以查看 Azure 中的 IAAS 产品并启动安装了 SQL 的 VM，但是您需要确保了解 IAAS 和 PAAS 产品之间的主要区别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T15:26:52.600

我不知道您的高可用性要求是什么，但您应该查看Microsoft 提供的[SLA 。](http://www.windowsazure.com/en-us/support/legal/sla/)SQL 数据库提供 99.9% 的月度可用性。

# c# - 终止在 C# 中运行消息循环的工作线程

> ID：14777779
> 
> 赞同：4
> 
> 时间：2013-02-08T17:10:57.027
> 
> 标签：c#, .net, windows, winforms

我`SetWindowHookEx()`在工作线程中使用了 Windows API，并使用`Application.Run()`.

现在，我想停止消息泵并退出工作线程，但我没有终止线程的好方法。

或者，我正在使用`Thread.Abort()`方法来终止线程，但不推荐使用这种方法来优雅地终止线程。

谁能建议如何从 UI 线程或主窗体优雅地关闭消息泵，以便工作线程自动返回并退出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T17:31:51.963

与其使用无参数，不如使用`Application.Run`接受`ApplicationContext`.

应用程序上下文有一个`ExitThread`方法可以优雅地结束消息循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T10:00:46.470

为什么不直接从另一个线程调用 Application.Exit 呢？

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-02-08T17:27:44.330

如果您优雅地处理 Thread.Abort() 将在工作线程中导致的 ThreadAbortException，那么中止线程并没有什么不优雅的。

# c++ - 处理图形的类的最佳方法

> ID：14777786
> 
> 赞同：1
> 
> 时间：2013-02-08T17:11:25.687
> 
> 标签：c++

当我使用 opengl、direct3d、sdl 或任何图形 api（通常是游戏）编写任何类型的应用程序时，我习惯于创建一个名为 Graphics 的类，该类具有绘制、加载图像、初始化窗口等所需的一切。在里面。在另一个类中存在这个类的一个实例，即程序、游戏或任何将使用它的主类。

随着岁月的流逝，我尝试了很多不同的方法来使用它，我想知道你们是否认为其中一些是好的，或者如果一切都只是无用的废话，我应该用另一种方式来做。

1 - 在程序类中有一个 Graphics 的实例，并在程序类中有一个函数来迭代对象（游戏对象，例如玩家）并调用 Graphics 方法以相应地绘制所有内容。

2 - 将指向 Graphics 的指针传递给每个对象，这样每个对象都可以有一个 Draw 函数，并通过这个指针自己调用适当的 Graphics 函数。

3 - 让 Graphics 中的所有内容都是静态的，并且无需创建图形实例。然后你可以从任何地方调用每个图形函数。（你只需要一个 Draw 函数到每个对象，就像主题 2 一样）

谢谢你。

**编辑**：如果我做一些类似于 iostream 对 cout 所做的事情，比如，只需使用“extern Graphics x;”创建一个标头，在 cpp 文件中声明 x，然后从这个 x 中调用所有内容。这太糟糕了吗？如果是，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:52:51.090

好吧，我认为“图形”类可以很好地具有状态，例如，它正在绘制的画布。因此，使它成为一个类是好的；通过创建一个类，您可以使相同的功能集适用于不同类型的“画布”（opengl、directx、sdl 等）

在您的选项中，我认为选项 1 是最好的，但选项 2 将是最简单的（选项 3 很糟糕，因为它使代码依赖于全局变量，从而消除了代码的可重用性 - 这是黑客方法：D ）。

选项 1 很棒，因为您可以编写一个图形引擎，用它绘制的东西做智能的东西：假设您有两个共享相同纹理的对象，但使用不同的网格。如果编程得当，图形引擎可以使用相同的渲染设置调用两个对象的“绘制网格”函数，在这种情况下是相同的纹理，从而加快渲染速度。这对于选项 2 是不可能的，它通常将单个对象的绘制函数组合在一起，从而导致对渲染设置进行更多更改。

然而，选项 2 更容易实现。如果您不需要很高的渲染速度，我会选择这个，因为它的工作量要少得多，并且会导致更合乎逻辑的程序结构。要实现选项 1，就像我解释的那样，对象需要具有“渲染属性”等，需要由渲染引擎匹配，以及针对不同绘制设置的不同绘制例程......与对象相比非常复杂 - draw 函数，它只使用一组中央绘图函数，如 Graphics 类。

因此，如果您选择“大型项目”，请选择选项 1。为了快速获得结果，并且如果您不需要绘制很多东西，选项 2 可能会更好。选项 1 和 2 的可用性相似。

*PS：抱歉编辑晚了，但我的语法在以前的版本中很糟糕*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:24:09.280

我会选择第四个选项，使 Graphics 成为命名空间，而不是类。

听起来 Graphics 不是一种数据类型，只是函数的集合。这正是命名空间的用途。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T17:30:27.227

我很难弄清楚什么是“图形”对象。软件中的对象类似于现实生活中的对象，那么 Graphics 对象代表什么？

我通常这样做的方式与标准 UI 应用程序没有太大区别：我有一个可以多次实例化的 Window 类和一个从 Window 继承且只实例化一次的 MainWindow 类。在那个 MainWindow 类中，我拥有将在整个执行过程中使用的所有图形资源（例如 Direct3D 设备对象）。

# email - 非 ascii 电子邮件地址和 SMTP

> ID：14777792
> 
> 赞同：3
> 
> 时间：2013-02-08T17:11:43.247
> 
> 标签：email, unicode, smtp, quoted-printable, percent-encoding

这封电子邮件有什么办法可以运行吗？`łōręmıpśum@łōręmıpśum.com` 这不是一个完全轻率的追求。我们有波兰用户在我们的应用程序中输入了非 ascii 电子邮件。

gmail 验证器将其标记为无效，但也许这是他们不允许这样做的罕见情况。“łōręmıpśum.com”的 punycode 是“xn--rmpum-j0a3o6e4dtg.com”，`info@xn--rmpum-j0a3o6e4dtg.com`似乎工作正常。用户部分让我很头疼。

我以为我可以像在 url 中那样对其进行 utf8+percent 编码（结果为“%C5%82%C5%8Dr%C4%99m%C4%B1p%C5%9Bum”），但 SMTP 服务器返回我的邮件有错误：

```
The mail system

<%C5%82%C5%8Dr%C4%99m%C4%B1p%C5%9Bum@xn--rmpum-j0a3o6e4dtg.com>: host
    eforward3.registrar-servers.com[38.101.213.199] said: 554 5.7.1
    <%C5%82%C5%8Dr%C4%99m%C4%B1p%C5%9Bum@xn--rmpum-j0a3o6e4dtg.com>: Relay
    access denied (in reply to RCPT TO command)

Final-Recipient: rfc822; %C5%82%C5%8Dr%C4%99m%C4%B1p%C5%9Bum@xn--rmpum-j0a3o6e4dtg.com
Original-Recipient: rfc822;%C5%82%C5%8Dr%C4%99m%C4%B1p%C5%9Bum@xn--rmpum-j0a3o6e4dtg.com
Action: failed
Status: 5.7.1
Remote-MTA: dns; eforward3.registrar-servers.com
Diagnostic-Code: smtp; 554 5.7.1
    <%C5%82%C5%8Dr%C4%99m%C4%B1p%C5%9Bum@xn--rmpum-j0a3o6e4dtg.com>: Relay
    access denied 
```

电子邮件似乎可以很好地通过本地 SMTP 服务器，但在远程端失败。可能 namecheap 邮件服务器是以 ASCII 为中心的方式配置的。

我的主要问题：我已经向自己证明了电子邮件的服务器部分可以是波兰语，但用户部分可以吗？如果不是，为什么？在我看来，上面的电子邮件虽然非常丑陋，但只是 ASCII，不应该被不支持 unicode 的电子邮件系统特别对待。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T18:02:52.113

Unicode 是一个完全的红鲱鱼；这与奇怪的字符或编码无关，与`%`.

“中继访问被拒绝”是来自 Postfix 的错误消息，当您要求它将您的邮件转发到其他服务器时产生。（“开放中继”曾经并且很可能仍然是垃圾邮件问题的主要贡献者，其方式与开放代理难以禁止不法分子的方式大致相同。）

那么，为什么 Postfix 认为你是在要求它转发这封邮件呢？让我们检查一下[文档](http://tldp.org/HOWTO/Spam-Filtering-for-MX/smtpchecks.html)：

> ### 2.3.3.1。开放中继预防
> 
> *不要将邮件从远程主机中继到远程地址！（除非发件人经过身份验证）。*
> 
> 这对我们大多数人来说似乎很明显，但显然这是一个经常被忽视的考虑因素。此外，并不是每个人都完全掌握与电子邮件地址和传递路径相关的各种 Internet 标准（考虑“百分比黑客域”、“砰（！）路径”等）。

等等，什么？我不认为*我*完全掌握最后两件事是什么。

谷歌搜索[解释](http://www.livinginternet.com/e/ew_addr.htm)：

> 多年后，在创建 CSNET 期间，开发了另一种中继符号。CSNET 的第一个实例在 RAND 和特拉华大学建立了计算机，为未连接到 ARPANET 的站点提供电子邮件连接。为了指示所需的中继，创建了一个称为“percent hack”的符号，以便可以按以下形式指定电子邮件地址：
> 
> > 玛丽%compsci@udel
> 
> 上面的电子邮件地址指定用户“mary”在计算机“compsci”上有一个帐户，可以通过特拉华大学的中继主机访问。选择 % 符号是因为它没有被任何其他流行的电子邮件系统使用，并且因为它在视觉上类似于用于表示通过邮政邮件发送的信件的“正在处理”的符号“C/O”。尽管百分比破解启用了多级中继，但它的实际使用仅限于单个中继——一个 % 和一个 @。

同一页面还解释了`!`.

我不认为这些行为中的任何一种都是特定的（因此，“hack”......）；两者`%`都`!`应该是本地部分中的普通字符。但是 Postfix 默认支持这两种 hack，所以它们实际上是保留的。

* * *

至于 Unicode：百分比编码只是 URI 的东西*，*没有理由期望它可以在电子邮件地址的任何地方工作。

[RFC6531](https://www.rfc-editor.org/rfc/rfc6531)将 SMTP 扩展到“国际”字符。它与任何其他与电子邮件相关的 RFC 一样清晰，但听起来您可以在本地部分使用 UTF-8，并且接收服务器将通过 SMTPUTF8 扩展名理解它，或者......它不会。（假设任何拥有 Unicode 本地部分的人都已经在使用能够理解 Unicode 的电子邮件服务器。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T01:49:00.987

用户部分只需 utf8 编码，无需 % 编码。此电子邮件完全适用于“łōręmıpśum@xn--rmpum-j0a3o6e4dtg.com”，左侧为 utf8，右侧为 punycode（又名 IDNA）。

# mongodb - 关闭安全模式的 MongoDB 一致性

> ID：14777793
> 
> 赞同：3
> 
> 时间：2013-02-08T17:11:48.620
> 
> 标签：mongodb, mongoid, consistency

帮助我了解在这种情况下我可以期望 MongoDB 的一致性级别。

我们正在运行一个副本集，其中`consistency`Mongoid 中的标志设置为`strong`意味着只读转到主服务器。但是`safe`默认配置是`false`这样写操作立即返回。

假设没有任何错误，如果客户端应用程序插入一个新的大文档，然后快速尝试在另一个线程中读取它，我们是否可以保证将文档取回？或者我们是否需要打开`safe`模式以确保一致性水平？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T18:18:49.467

如果您先写入然后从主数据库读取，您将*不会*始终获得一致的结果。你是否在同一个连接上很重要。如果您在同一连接上，则不需要*safe*。如果您**不在**同一个连接上，则需要*safe*。

# python - 在 drmaa-python 中关闭 DEBUG 消息

> ID：14777795
> 
> 赞同：0
> 
> 时间：2013-02-08T17:12:14.717
> 
> 标签：python, debugging, drmaa

我正在使用 DRMAA python 绑定（请参见此处[http://code.google.com/p/drmaa-python/](http://code.google.com/p/drmaa-python/)）通过集群上的 Condor 管理分布式作业。

我找不到关闭代码打印到终端的调试消息的方法。

例如：

调试：现在正在等待...调试：drmaa_join_files 调试：Join_files 已设置调试：drmaa_block_email：1

有任何想法吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:27:18.157

[源代码](http://code.google.com/p/drmaa-python/source/browse/)不包含您作为示例提供的任何字符串，因此该消息可能来自您通过 drmaa-python 使用的 DRMAA C 库。

我建议用一个小的 C 程序测试你的 DRM 系统的 DRMAA 库，看看你是否仍然收到 DEBUG 消息。

如果是这种情况，那么您需要重新配置您的实际 DRMAA 库。

如果 C 应用程序没有给您消息，那么您使用的 drmaa-python 版本与源主干不对应。在这种情况下，使用[Python 日志记录工具配置](http://docs.python.org/2/howto/logging.html#logging-basic-tutorial)可能会有所帮助。

# php - 如何从长字符串中获取单独的整数

> ID：14777796
> 
> 赞同：0
> 
> 时间：2013-02-08T17:12:15.917
> 
> 标签：php, string, integer

我正在研究柔道俱乐部的注册系统。我正在使用一个字符串来存储出现的人的 ID。它看起来像这样：

0,3,4,7,8,10,

现在，我想在 PHP 中将每个数字分成一个整数数组。最简单的解决方案是什么？:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T17:13:13.560

采用[`explode()`](http://php.net/explode)

```
$ids = explode(',', '0,3,4,7,8,10'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:13:21.413

```
$str = '0,3,4,7,8,10';
$arr = explode(',',$str); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T17:13:31.780

采用`EXPLODE`

```
$num = "0,3,4,7,8,10";
$pieces = explode(",", $num ); 
```

*   [爆炸手册](http://php.net/manual/en/function.explode.php)

# c# - 委托如何使用通用和可扩展类响应多个事件？

> ID：14777799
> 
> 赞同：6
> 
> 时间：2013-02-08T17:12:23.980
> 
> 标签：c#, delegates, rdlc, strategy-pattern, subreports

我已经设置了一种技术来处理 rdlc 报告中的多个子报告，但是由于我试图使其通用且可重复，因此我不得不采用该模型并针对每种情况对其进行微调。

例如，如果我定义一个抽象接口，就像这样，我只是根据需要将它从 winform 剪切并粘贴到 winform：

```
abstract class ISolutionStrategy
{
    public abstract void AlgorithmInterface(Int64 searchCriteria, SubreportProcessingEventArgs e);
} 
```

* * *

首先，我希望能够通过包含一个 has-a 对象将其带入每种形式。我还想封装委托处理调度的行为，并使处理方法也“通用”。

所以，设计要求是：

*   创建一个可以包含在winform中的对象来处理多个子报表处理
*   在winform中实例化和配置对象
*   在 winform 中构建调度表或 switch/case 语句
*   传入所有方法来处理该 winform 的报表查看器的特定要求

目标是制作一个可以独立测试并变得健壮的对象，并且不必剪切和粘贴轮子并为每个新的 Winform 进行大量手动调整。

在我看来，有人找到了比我目前拥有的更好的设计。

创建一个可以包含在winform中的对象来处理多个子报表处理

到目前为止，我在本地表单加载事件中有一个委托：

```
this.reportViewer1.LocalReport.SubreportProcessing += new SubreportProcessingEventHandler(LocalReport_SubreportProcessing); 
```

这由 *LocalReport_SubreportProcessing* 方法中的 switch 语句处理。

该方法的主体包含一个 switch 语句：

```
void LocalReport_SubreportProcessing(object sender, SubreportProcessingEventArgs e)

        {
            String commonSubreportKey = _commonSubreportKey;

            switch (e.ReportPath)
            {
                case "rptSubAlternateParts":
                    runSubAlternatePart(e, commonSubreportKey, new GetAlternateParts());
                    break;
                case "rptSubGetAssemblies":
                    runSubFailurePart(e, commonSubreportKey, new GetAssemblies());
                    break;
                case "rptSubGetAssemblies":
                    runSubGetGetEndItemLRMFailureInfo(e, commonSubreportKey, new GetEndItemLRMFailureInfo());
                    break;
                case "rptSubGetAssemblies":
                    runSubGetSubAssemblies(e, commonSubreportKey, new GetSubAssemblies());
                    break;
                default:
                    break;
            } 
```

> 在旁边：
> 
> *在我看来，与我考虑的替代方案相比，这个开关主要是人类可读的。我考虑使用以报表名称作为键、函数调用数据作为值的散列。但是，我真的不知道该怎么做，我认为其他人会更难理解。*

* * *

之后，调用一个函数，重新排列从 switch 语句中的函数调用传递的信息：

```
 private static void runSubAlternatePart(SubreportProcessingEventArgs e1, String  commonReportKey, GetAlternatePart myAP)
            {
                myAP.AlgorithmInterface(commonReportKey, e1);
            } 
```

这种重新排列绝对是代码口吃，但似乎是我试图实现的策略模式的必要中间体：

```
 abstract class IStrategy
        {
            public abstract void AlgorithmInterface(String searchParam, SubreportProcessingEventArgs e);

        } 
```

以下是其中一份报告的战略的具体实施：

```
class GetAlternatePart : IStrategy
{
private BLL.AlternatePartBLL ds = new BLL.AlternatePartBLL();

public override void AlgorithmInterface(String searchParam, SubreportProcessingEventArgs e)
              {

                    e.DataSources.Clear();
                    DataTable myDataTable = ds.GetAlternativePart(searchParam);
                    DataSet myDataSet = new DataSet();
                    myDataSet.Tables.Add(myDataTable);
                e.DataSources.Add(new ReportDataSource("BLL_AlternatePartBLL", myDataSet.Tables[0]));
            }

        }
    } 
```

无论如何，我的愿望是不必在报告之间重复使用相同的逻辑，因为我有许多带有多个子报告的报告。

我想要一种使用类来动态创建发生口吃的中间部分的库质量方式，并且我想传入一个“匿名”函数，它实际上实现了子报表与其相应数据源的详细连接。

对于带有子报表的单个报表，甚至是几个一次性报表，我所做的是可以的，但如何才能减少手动、更健壮和更可测试呢？

我的环境是 Visual Studio 2008，目标是 .NET 3.5；抽象类的声明方式和编译方式似乎有所不同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T00:27:21.170

我建议的解决方案是对基类进行非常简单的重构，它将您需要在每个 WinForm 中编写的代码减少到两件事：1）用于该表单的报告的设置；2）如何获取该表单的报告数据的定义。

假设每个 WinForm 都继承自一个名为 ReportForm 的基类，每个 WinForm 的代码将如下所示：

```
public partial class Form1 : ReportForm
{
    public Form1()
    {
        // Wire up the report used by the Visual Studio-designed report viewer to the base class
        base.WinFormReport = reportViewer1.LocalReport;

        InitializeComponent();
    }

    // The search parameters will be different for every winform, and will presumably
    //  come from some winform UI elements on that form, e.g., parentPartTextBox.Text
    protected override DataResult GetReportData(SubreportProcessingEventArgs e)
    {
        // Return the data result, which contains a data table and a label which will be
        //  passed to the report data source
        // You could use DataSet in DataResult instead of DataTable if needed
        switch (e.ReportPath)
        {
            case "rptSubAlternateParts":
                return new DataResult(
                    new BLL.AlternatePartBLL().GetAlternativePart(parentPartTextBox.Text)
                    , "BLL_AlternatePartBLL"
                );

            case "rptSubGetAssemblies":
                return new DataResult(
                    new BLL.SubAssemblyBLL().GetSubAssemblies(someOtherTextBox.Text)
                    , "BLL_SubAssemblyBLL"
                );

            default:
                throw new NotImplementedException(string.Format("Subreport {0} is not implemented", e.ReportPath));

        }
    }
                                .
                                .
                                . 
```

上面的代码做了这些事情：

1）告诉基类（ReportForm）Form中使用了哪个Report。如果您愿意，您也可以将 Report 重构为 ReportForm，但我的方法仍然允许您在 Visual Studio 中创建和操作您的 ReportViewer 及其报告。但是，如果您以编程方式而不是在设计器中传递报表，您可能希望将报表从派生的 WinForm 类发送到基类。

2) 定义报表将如何获取其所有子报表的数据。为此，我们只需要返回一个 DataTable 和一个标签，因为这就是报表数据源最终需要的全部内容。将 DataTable 和标签绑定到 RDLC 数据源的代码属于基类 (ReportForm)，因为该绑定代码对于所有 WinForms 都是通用的。

现在，ReportForm 代码应如下所示：

```
/// <summary>
/// Don't cut & paste into any Windows Forms, inherit the behavior you want from a base class
/// </summary>
public abstract class ReportForm : System.Windows.Forms.Form
{
    // I'm not sure exactly what this is used for, but I put it in base class in case there is some use for it here
    protected string _commonSubreportKey = "12345";

    // This will be the one line of code needed in each WinForm--providing the base class a reference
    //  to the report, so it has access to the SubreportProcessing event
    protected Report WinFormReport { get; set; }

    // Making this abstract requires each derived WinForm to implement GetReportData--foolproof!
    protected abstract DataResult GetReportData(SubreportProcessingEventArgs e);

    // Wire up the subreport_processing handler when any WinForm loads
    // You could override this in derived WinForms classes if you need different behavior for some WinForms,
    //  but I would bet this default behavior will serve well in most or all cases
    protected virtual void Form1_Load(object sender, EventArgs e)
    {
        Report.SubreportProcessing += new SubreportProcessingEventHandler(LocalReport_SubreportProcessing);
    }

    // When the Subreport processing event fires, handle it here
    // You could also override this method in a derived class if need be
    protected virtual void LocalReport_SubreportProcessing(object sender, SubreportProcessingEventArgs e)
    {
        // Get the data needed for the subreport
        DataResult dataResult = this.GetReportData(e);

        e.DataSources.Clear();
        e.DataSources.Add(new ReportDataSource(dataResult.Label, dataResult.Table));
    }
} 
```

请注意，ReportForm 基类继承自 Form，然后所有 WinForm 都将继承自 ReportForm——这是整个设计的关键。下面是这个 ReportForm 基类的工作原理：

1）WinForm实例化时，设置了基础属性WinFormReport，这样基础对象就知道使用的是哪个Report了。

2) 当 WinForm 加载时，Form Load 事件在基类上被调用，因为它没有在派生类中定义。在表单加载时，报表的 Subreport_Processing 事件被连接起来。

3）当用户输入参数并在报表查看器中单击某些内容以创建报表时，最终子报表由 RDLC 实例化，并且 Subreport_Processing 事件会触发多次，每个子报表一次。

4) 当事件触发时，基类事件处理程序调用GetReportData(e)，它将调用WinForm 上定义的GetReportData 方法。注意这个方法在基类中是抽象的，所以不能在基类上定义，而必须在派生类中定义。

5) WinForm 中的 GetReportData(e) 方法使用您最初指定的调度程序逻辑，向基本处理程序返回一个 DataTable（如果需要，也可以是一个 DataSet）和一个文本字符串。

6) 基本处理程序获取 DataTable/DataSet 和文本字符串，将它们作为报表数据源提供给报表，并且还可以执行显示报表所需的任何其他操作。

经过深思熟虑，我决定建议将常见行为相当直接地重构为基类，因为我认为根据您的要求它会起作用，而且我没有看到需要更复杂的地方。我想你会发现这种方法非常易读，它绝对可以最大限度地减少每个新 WinForm 所需的内容，最重要的是，发现它具有极强的可扩展性；也就是说，当您继续开发系统时，您总是会问“这个新代码是否需要在每个 WinForm 中重复，还是很常见以至于它应该进入基类？”

如果您对此方法有任何疑问或疑虑，请随时添加评论，并祝您好运。我希望这正是您正在寻找的！

# java - GZIP 压缩到字节数组

> ID：14777800
> 
> 赞同：20
> 
> 时间：2013-02-08T17:12:26.137
> 
> 标签：java, android, stream, gzip

我正在尝试编写一个可以压缩数据的类。以下代码失败（没有抛出异常，但目标 .gz 文件为空。）
此外：我不想像所有示例中那样直接生成 .gz 文件。我只想获取压缩数据，以便在将数据写入文件之前对其进行加密。

如果我直接写入文件一切正常：

```
import java.io.*;
import java.util.zip.*;
import java.nio.charset.*;

public class Zipper
{
  public static void main(String[] args)
  {    
    byte[] dataToCompress = "This is the test data."
      .getBytes(StandardCharsets.ISO_8859_1);

    GZIPOutputStream zipStream = null;
    FileOutputStream fileStream = null;
    try
    {
      fileStream = new FileOutputStream("C:/Users/UserName/Desktop/zip_file.gz");
      zipStream = new GZIPOutputStream(fileStream);
      zipStream.write(dataToCompress);

      fileStream.write(compressedData);
    }
    catch(Exception e)
    {
      e.printStackTrace();
    }
    finally
    {
      try{ zipStream.close(); }
        catch(Exception e){ }
      try{ fileStream.close(); }
        catch(Exception e){ }
    }
  }
} 
```

但是，如果我想将它“绕过”到字节数组流，它不会产生单个字节 -`compressedData`总是空的。

```
import java.io.*;
import java.util.zip.*;
import java.nio.charset.*;

public class Zipper
{
  public static void main(String[] args)
  {    
    byte[] dataToCompress = "This is the test data."
      .getBytes(StandardCharsets.ISO_8859_1);
    byte[] compressedData = null;

    GZIPOutputStream zipStream = null;
    ByteArrayOutputStream byteStream = null;
    FileOutputStream fileStream = null;
    try
    {
      byteStream = new ByteArrayOutputStream(dataToCompress.length);
      zipStream = new GZIPOutputStream(byteStream);
      zipStream.write(dataToCompress);

      compressedData = byteStream.toByteArray();

      fileStream = new FileOutputStream("C:/Users/UserName/Desktop/zip_file.gz");
      fileStream.write(compressedData);
    }
    catch(Exception e)
    {
      e.printStackTrace();
    }
    finally
    {
      try{ zipStream.close(); }
        catch(Exception e){ }
      try{ byteStream.close(); }
        catch(Exception e){ }
      try{ fileStream.close(); }
        catch(Exception e){ }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-02-09T00:45:52.473

问题是您没有关闭`GZIPOutputStream`. 在您关闭它之前，输出将是不完整的。

您只需要在读取字节数组*之前关闭它。*您需要重新排序`finally`块以实现此目的。

```
import java.io.*;
import java.util.zip.*;
import java.nio.charset.*;

public class Zipper
{
  public static void main(String[] args)
  {    
    byte[] dataToCompress = "This is the test data."
      .getBytes(StandardCharsets.ISO_8859_1);

    try
    {
      ByteArrayOutputStream byteStream =
        new ByteArrayOutputStream(dataToCompress.length);
      try
      {
        GZIPOutputStream zipStream =
          new GZIPOutputStream(byteStream);
        try
        {
          zipStream.write(dataToCompress);
        }
        finally
        {
          zipStream.close();
        }
      }
      finally
      {
        byteStream.close();
      }

      byte[] compressedData = byteStream.toByteArray();

      FileOutputStream fileStream =
        new FileOutputStream("C:/Users/UserName/Desktop/zip_file.gz");
      try
      {
        fileStream.write(compressedData);
      }
      finally
      {
        try{ fileStream.close(); }
          catch(Exception e){ /* We should probably delete the file now? */ }
      }
    }
    catch(Exception e)
    {
      e.printStackTrace();
    }
  }
} 
```

我不建议将流变量初始化为`null`，因为这意味着您的`finally`块也可以抛出`NullPointerException`.

另请注意，您可以声明`main`throw `IOException`（然后您不需要最外面的`try`语句。）

吞下 .gz 中的异常没有什么意义`zipStream.close();`，因为如果它抛出异常，您将没有有效的 .gz 文件（因此您不应该继续编写它。）

此外，我不会吞下异常，`byteStream.close();`但出于不同的原因——它们永远不应该被抛出（即你的 JRE 中有一个错误，你想知道这一点。）

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2017-07-05T09:29:06.007

我改进了 JITHINRAJ 的代码 - 使用[了 try-with-resources](https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)：

```
private static byte[] gzipCompress(byte[] uncompressedData) {
        byte[] result = new byte[]{};
        try (ByteArrayOutputStream bos = new ByteArrayOutputStream(uncompressedData.length);
             GZIPOutputStream gzipOS = new GZIPOutputStream(bos)) {
            gzipOS.write(uncompressedData);
            // You need to close it before using bos
            gzipOS.close();
            result = bos.toByteArray();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return result;
    }

private static byte[] gzipUncompress(byte[] compressedData) {
        byte[] result = new byte[]{};
        try (ByteArrayInputStream bis = new ByteArrayInputStream(compressedData);
             ByteArrayOutputStream bos = new ByteArrayOutputStream();
             GZIPInputStream gzipIS = new GZIPInputStream(bis)) {
            byte[] buffer = new byte[1024];
            int len;
            while ((len = gzipIS.read(buffer)) != -1) {
                bos.write(buffer, 0, len);
            }
            result = bos.toByteArray();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return result;
    } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-10-14T10:10:25.287

如果您仍在寻找答案，您可以使用以下代码使用 deflater 获取压缩的 byte[] 并使用 inflater 对其进行解压缩。

```
public static void main(String[] args) {
        //Some string for testing
        String sr = new String("fsdfesfsfdddddddsfdsfssdfdsfdsfdsfdsfdsdfggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggghghghghggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggfsdfesfsfdddddddsfdsfssdfdsfdsfdsfdsfdsdfggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggghghghghggggggggggggggggggggggggggggggggggggggggg");
        byte[] data = sr.getBytes();
        System.out.println("src size "+data.length);
        try {
            compress(data);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
    public static byte[] compress(byte[] data) throws IOException { 
        Deflater deflater = new Deflater(); 
        deflater.setInput(data); 
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream(data.length);  

        deflater.finish(); 
        byte[] buffer = new byte[1024];  
        while (!deflater.finished()) { 
        int count = deflater.deflate(buffer);  
        outputStream.write(buffer, 0, count);  
        } 
        outputStream.close(); 
        byte[] output = outputStream.toByteArray(); 

        System.out.println("Original: " + data.length  ); 
        System.out.println("Compressed: " + output.length ); 
        return output; 
        } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-06-23T11:17:29.557

**压缩**

```
private static byte[] compress(byte[] uncompressedData) {
        ByteArrayOutputStream bos = null;
        GZIPOutputStream gzipOS = null;
        try {
            bos = new ByteArrayOutputStream(uncompressedData.length);
            gzipOS = new GZIPOutputStream(bos);
            gzipOS.write(uncompressedData);
            gzipOS.close();
            return bos.toByteArray();

        } catch (IOException e) {
            e.printStackTrace();
        }
        finally {
            try {
                assert gzipOS != null;
                gzipOS.close();
                bos.close();
            }
            catch (Exception ignored) {
            }
        }
        return new byte[]{};
    } 
```

**解压缩**

```
private byte[] uncompress(byte[] compressedData) {
        ByteArrayInputStream bis = null;
        ByteArrayOutputStream bos = null;
        GZIPInputStream gzipIS = null;

        try {
            bis = new ByteArrayInputStream(compressedData);
            bos = new ByteArrayOutputStream();
            gzipIS = new GZIPInputStream(bis);

            byte[] buffer = new byte[1024];
            int len;
            while((len = gzipIS.read(buffer)) != -1){
                bos.write(buffer, 0, len);
            }
            return bos.toByteArray();
        } catch (IOException e) {
            e.printStackTrace();
        }
        finally {
            try {
                assert gzipIS != null;
                gzipIS.close();
                bos.close();
                bis.close();
            }
            catch (Exception e) {
                e.printStackTrace();
            }
        }
        return new byte[]{};
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-08T17:49:11.060

您可以使用以下功能，它已经过测试并且工作正常。

*通常，您的代码存在忽略*异常的严重问题！返回`null`或根本不打印`catch`块中的任何内容将使调试变得非常困难

如果您想进一步处理它（例如加密），您不必将 zip 输出写入文件，您可以轻松修改代码以将输出写入内存流

```
public static String zip(File inFile, File zipFile) throws IOException {        
    FileInputStream fis = new FileInputStream(inFile);
    FileOutputStream fos = new FileOutputStream(zipFile);
    ZipOutputStream zout = new ZipOutputStream(fos);

    try {
        zout.putNextEntry(new ZipEntry(inFile.getName()));
        byte[] buffer = new byte[BUFFER_SIZE];
        int len;
        while ((len = fis.read(buffer)) > 0) {
            zout.write(buffer, 0, len);
        }
        zout.closeEntry();
    } catch (Exception ex) {
        ex.printStackTrace();
        return null;
    } finally {
        try{zout.close();}catch(Exception ex){ex.printStackTrace();}
        try{fis.close();}catch(Exception ex){ex.printStackTrace();}         
    }
    return zipFile.getAbsolutePath();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-08T17:28:18.213

试试这个代码..

```
try {
    String inputFileName = "test.txt";  //may use your file_Path
    String zipFileName = "compressed.zip";

    //Create input and output streams
    FileInputStream inStream = new FileInputStream(inputFileName);
    ZipOutputStream outStream = new ZipOutputStream(new FileOutputStream(zipFileName));

    // Add a zip entry to the output stream
    outStream.putNextEntry(new ZipEntry(inputFileName));

    byte[] buffer = new byte[1024];
    int bytesRead;

    //Each chunk of data read from the input stream
    //is written to the output stream
    while ((bytesRead = inStream.read(buffer)) > 0) {
        outStream.write(buffer, 0, bytesRead);
    }

    //Close zip entry and file streams
    outStream.closeEntry();

    outStream.close();
    inStream.close();

} catch (IOException ex) {
    ex.printStackTrace();
} 
```

也可能对这个有帮助..

*   [http://www.java-samples.com/java/zip_files_in_a_folder_using_java.htm](http://www.java-samples.com/java/zip_files_in_a_folder_using_java.htm)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-26T15:48:58.340

大多数示例都有错误的异常处理。

```
public static byte[] gzipBytes(byte[] payload) {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    try (GZIPOutputStream gzip = new GZIPOutputStream(baos)) {
        gzip.write(payload);
    } catch (IOException e) {
        throw new UncheckedIOException(e);
    }
    // note: toByteArray should be called after try-with-resources, not inside
    return baos.toByteArray();
}

public static byte[] gunzipBytes(byte[] gzPayload) {
    ByteArrayInputStream bais = new ByteArrayInputStream(gzPayload);
    try (GZIPInputStream gzip = new GZIPInputStream(bais)) {
        // java 9+ required for this method
        return gzip.readAllBytes();
    } catch (IOException e) {
        throw new UncheckedIOException("Error while unpacking gzip content", e);
    }
} 
```

# java - 隐式引用 Java 中的封闭类

> ID：14777803
> 
> 赞同：1
> 
> 时间：2013-02-08T17:12:32.080
> 
> 标签：java

假设我有一`Outer`堂课。可以说有一个非静态成员类`Inner`。因此，如果类声明了一个类型的字段，并且这是根据定义，`Outer`实例将具有对实例的引用。但是 Inner 实例如何也有***隐式***引用呢？这个协会是什么时候创建的？`Inner``Outer``Inner`*`Outer`*

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:16:22.597

来自[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html)

> 类 O 的直接内部类 C 的实例 i 与 O 的实例相关联，称为 i 的直接封闭实例。对象的直接封闭实例（如果有）在创建对象时确定（第 15.9.2 节）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T17:22:35.803

你有相反的方式：

```
public class Outer {

    void foo() {
        // In this Outer method, we have no implicit instance of Inner.
        innerbar(); // Compiler error: The method bar() is undefined for the type Outer
        Inner.this.innerbar();// Compiler error: No enclosing instance of the type Outer.Inner is accessible in scope

        // instead, one has to create explicitly instance of Inner:

        Inner inner1 = new Inner();
        Inner inner2 = new Inner();

        inner1.innerbar(); // fine!
    }

    class Inner {
        void innerbar() {};

        void callOuter () {
            // But Inner has an implicit reference to Outer.
            callMe();
            // it works also through Outer.this
            Outer.this.callMe();
        }
    }

    void callMe() {}

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T17:22:21.490

编码

```
class Outer {

    class Inner {
        void printOuterThis() {
            System.out.println(Outer.this);
        }
    }

}

Outer.Inner oi = new Outer().new Inner(); 
```

主要等同于：

```
class Outer {

    static class Inner {
        Outer outerThis;

        public Inner(Outer outerThis) {
            this.outerThis = outerThis;
        }

        void printOuterThis() {
            System.out.println(outerThis);
        }
    }
}

public class Scratch {
    public static void main(String[] args) {
        Outer.Inner oi = new Outer.Inner(new Outer());
    }
} 
```

编译器自动发出代码来执行第二个中发生的事情：隐式引用的字段（`this$0`保存 的值）并转换所有构造函数并调用它们以添加该字段的初始化。`Outer.this``Inner`*

# objective-c - 使用箭头键在元素列表和慢跑元素之间切换？

> ID：14777814
> 
> 赞同：0
> 
> 时间：2013-02-08T17:13:13.527
> 
> 标签：objective-c, xcode, interface-builder

我担心我的 xcode 词汇量在这里不够 -

在 Interface Builder 中，我经常想使用分层元素列表的精确元素选择，然后用箭头键切换到元素的位置/大小。

我知道这样做的唯一方法是在元素被选中时仔细单击元素周围显示的拖动框之一，这会将键盘焦点从元素列表转移到可视布局中。但这很困难且容易出错，因为很容易意外移动元素，或者拖动框可能位于另一个元素下方，或者您可能选择了多个元素等，因此某种热键将是理想的。

抱歉，这里所有的东西都没有正确的名字。即使是名字也可能会帮助我搜索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T20:11:11.710

A：很明显，但我错过了 - 双击层次结构中的元素。如果有一个键盘命令可以做到这一点，那就太好了，但我会满足于双击。

# google-maps - Google Maps Geocoding API V2 会在 2013 年 3 月 8 日停止工作吗？

> ID：14777818
> 
> 赞同：3
> 
> 时间：2013-02-08T17:13:23.547
> 
> 标签：google-maps, google-geocoding-api

我们收到通知说：

“Google Maps API V2 已于 2010 年 3 月 8 日弃用，并将继续工作到 2013 年 3 月 8 日。在此日期之后，我们将不再提供对此 API 的支持，并且最终将停用。”

这是否意味着它将在 2013 年 3 月 8 日之后完全停止工作，或者它可能仍然工作但不再受支持？

谢谢！约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T05:05:26.380

看起来这个问题已经在[地理开发者博客](http://googlegeodevelopers.blogspot.com.au/2013/03/an-update-on-geocoding-api-v2.html)上得到了回答。

他们已将 API 的生命周期延长至 2013 年 9 月 8 日，之后将完全关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T10:06:44.327

> Google Maps Geocoding API Version 2 已于 2010 年 3 月 8 日正式弃用。V2 API 将继续工作至 2013 年 3 月 8 日。

据我了解，它将在 2013 年 3 月 8 日之后完全停止工作。这就是他们花了 3 年时间从 v2 升级到 v3 的原因。

# javascript - Javascript 图像库 - 太多图像和页面加载速度很慢

> ID：14777819
> 
> 赞同：0
> 
> 时间：2013-02-08T17:13:24.513
> 
> 标签：javascript, image

我有一个图片库。它由 highslide 提供支持，页面包含调整大小的图像预览（例如 100x100px，当您单击预览时，会显示全尺寸图片，但这并不重要......）。

图片由用户上传到画廊，问题是，在某些时候，一页上大约有 100 张图片（= 100 张图片需要通过网络浏览器调整大小以进行预览），页面加载非常缓慢并且一直冻结.

Q1：是否有任何 javascript 会显示例如前 40 张图片（文件的前 40 行）而其他图片不会被加载？当我单击“下一步”时，它会显示图片 40-80，然后是 80-120……我什至不知道这样的事情是否可能。

Q2: 或者一个 javascript，它只会加载当前在视图中的图片？我找到了一个，它工作得很好，但是当我向下滚动到画廊的尽头时，所有的图像都经过了我的视点，所以它们都被加载了……它再次冻结了。

Q3：或者一个脚本会自动将我的页面划分为选项卡（每个选项卡都有定义的文件长度）？

感谢您的每一个解决方案！

/编辑到：Frits van Campen 我已经尝试过延迟加载 - [http://www.appelsiini.net/projects/lazyload](http://www.appelsiini.net/projects/lazyload)，但分成标签会更有用。

//编辑到：Mörre 我知道如果图像已经调整大小并存储在我的服务器上会更好，但是原始大小的图像没有存储在我的服务器上，我只有它们的 src 地址。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-15T00:48:20.430

只需按像素减小图像大小。

# ios - 我可以设置一个 OCMock 对象来期待一个 char * 参数吗？

> ID：14777825
> 
> 赞同：0
> 
> 时间：2013-02-08T17:13:47.160
> 
> 标签：ios, macos, cocoa, ocmock

我正在尝试验证是否将在具有方法参数之一的特定指针值的模拟对象上调用方法，但我不断收到“不支持参数类型'*'”。调用模拟方法时出现异常。这是我的测试代码：

```
uint8_t *buf = calloc(65, sizeof(uint8_t));
id stream = [OCMockObject niceMockForClass:[NSInputStream class]];
[[stream expect] read:buf maxLength:64];
id myStream = [[MyStream alloc] initWithStream:stream];
// myStream should pass read:maxLength: call through to stream
[myStream read:buf maxLength:64];
STAssertNoThrow([stream verify], @"Did not pass call through"); 
```

这是`-[MyStream read:maxLength:]`：

```
- (NSInteger)read:(uint8_t *)buffer maxLength:maxLength {
    // internalStream is the stream passed to -initWithStream:
    return [self.internalStream read:buffer maxLength:maxLength];
} 
```

当我在模拟流上调用 -read:maxLength: 时，我得到“不支持参数类型'*'”。例外。是否可以期待具有特定指针参数值的调用？

编辑：

看起来这个问题可能特定于 char * （或 uint8_t *）参数。Objective C @encodes 将它们编码为 '* ' 并且 OCMock 的类型处理代码只将 '^' 编码的值视为指针。我尝试过黑客攻击`+[OCMArg resolveSpecialValues:]`和`-[NSInvocation getArgumentAtIndexAsObject:]`（在 NSInvocation+OCMAdditions.m 中）将 '*' 视为与 '^' 相同。这已经停止了异常，但我的期望仍然没有得到满足。

有谁知道如何处理这个？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T16:58:58.400

我找到了解决此问题的方法。试图修复 OCMock 以处理 '*' 编码类型是一个充满伤害的兔子洞，但我能够通过在 NSInputStream 上创建一个类别使其返回 OCMock 能够使用的方法签名来让我的测试正常工作：

```
@interface NSInputStream (OCMockFix)
  + (NSMethodSignature *)instanceMethodSignatureForSelector:(SEL)selector;
  - (NSMethodSignature *)methodSignatureForSelector:(SEL)selector;
@end

@implementation NSInputStream (OCMockFix)
  + (NSMethodSignature *)instanceMethodSignatureForSelector:(SEL)selector {
    if (sel_isEqual(selector, @selector(read:maxLength:))) {
      // Original signature is "i@:*I". Change '*' to '^C'
      return [NSMethodSignature signatureWithObjCTypes:"i@:^CI"];
    } else {
      return [super instanceMethodSignatureForSelector:selector];
    }
  }
  - (NSMethodSignature *)methodSignatureForSelector:(SEL)selector {
    return [[self class] instanceMethodSignatureForSelector:selector];
  }
@end 
```

# python - 合并排序问题 - Python

> ID：14777829
> 
> 赞同：1
> 
> 时间：2013-02-08T17:14:03.870
> 
> 标签：python, algorithm, sorting, merge

我的代码有什么问题？它只打印部分向量值。似乎while循环在某个时候中断。我不明白为什么。

```
def print_list(vect):
    for i in range(0, len(vect)):
        print(vect[i])

def merge_sort(vect):
    left = []
    right = []    
    result = []

    for i in range(0, int(len(vect)/2)):
        left.append(vect[i])
    for i in range(int(len(vect)/2), len(vect)):
        right.append(vect[i])

    left.sort()
    right.sort()
    i = 0
    j = 0

    while i < len(left) and j < len(right):
        if left[i] <= right[j]:
            result.append(left[i])
            i += 1
        else:
            result.append(right[j])
            j += 1

    print(len(result))
    return result

vect = [3, 1, 5, 7, 10, 2, 0]

vect = merge_sort(vect) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T17:19:57.947

好吧，你的错误是在你的 while 循环之后

```
while i < len(left) and j < len(right):
  ... 
```

可能（并且很可能会）是`i < len(left)`or `j < len(right)`，因此您需要在答案中附加适当部分的后缀。这很容易做到

```
result += left[i:]
result += right[j:] 
```

**解释：**

想象一下合并过程：你有 i 和 j 在开始时为 0，并且在每一步你向前移动其中一个。你什么时候停下来？当其中一个到达终点时。假设我已经走到了尽头。因此，您将整个左侧部分添加到结果中，但是在 j 和 len(right) 之间的右侧仍有一些元素，因此您也必须将它们添加到答案中。

**离顶**：

您正在实施合并排序，所以请

```
left = merge_sort( left )
right = merge_sort( right ) 
```

代替

```
left.sort()
right.sort() 
```

**注意：**您必须在合并函数的开头将以下检查添加到您的代码中，以避免无限递归：

```
if len( vect ) == 1:
   return vect 
```

同样在您的 print_list 函数中，您可以使用

```
print vect 
```

或者至少

```
for x in vect
print x 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T17:23:06.930

只要 left 或 right 用尽，while 循环就会退出。这使得未用尽列表中剩余的所有元素都未合并。

将您的代码更改为：

```
def print_list(vect):
    for i in range(0, len(vect)):
        print(vect[i])

def merge_sort(vect):
    left = []
    right = []

    result = []
    for i in range(0, int(len(vect)/2)):
        left.append(vect[i])
    for i in range(int(len(vect)/2), len(vect)):
        right.append(vect[i])

    left.sort();
    right.sort();
    i = 0
    j = 0

    while i < len(left) and j < len(right):
        if left[i] <= right[j]:
            result.append(left[i])
            i += 1
        else:
            result.append(right[j])
            j += 1

    if i < len(left):
        result.extend(left[i:])
    else:
        result.extend(right[j:])

    print(len(result))
    return result

vect = [3, 1, 5, 7, 10, 2, 0]

vect = merge_sort(vect)
print vect 
```

如果您使用左右排序方法，我有点困惑为什么您不只是在整个列表中使用它。但我想你有你的理由。:)

编辑：我把整个代码块放在那里，这样你就可以看到它。当我运行它时，它会打印 [0, 1, 2, 3, 5, 7, 10]，这是正确的。

# mysql - 有效地更新 mySQL 表？

> ID：14777830
> 
> 赞同：1
> 
> 时间：2013-02-08T17:14:06.320
> 
> 标签：mysql, performance, computer-science, database-administration

我在这里寻找一些关于方法的一般性建议。

假设我有一个表格布局，如下所示：

```
Name | 1hr  | 2hr  | 3hr  | 4hr
---------------------------------
Joe  | 23   | 12   | 45   | 9 
```

小时是指一小时前。或者 3 小时前。我将每小时更新一次这些数据。我会用很多行来做这个。现在每次更新时，我都会将值向右移动。所以 1hr 变成 2hr 等等。然后 1hr 被插入为新的。

我的问题是，不是更新每个单元格然后插入新值，这样做最有效的方法是什么？我将使用 Java 和 JDBC 来控制这些操作。

我最初的想法是像对待圆形数组一样对待它。有一个额外的单元格来保存指向开始的指针。这将导致每个操作 2 次更新，而 4 次。

这是一个好方法还是有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:20:42.953

更好的方法是存储另一个表：

```
Name | Time  | Value
--------------------
Joe  | 10:00 |  9
Joe  | 11:00 | 45
Joe  | 12:00 | 12
Joe  | 13:00 | 23 
```

然后你不需要做*任何*更新，当你想添加一个值时，你只需添加一个新行。

# javascript - 变量字典内容

> ID：14777835
> 
> 赞同：0
> 
> 时间：2013-02-08T17:14:15.943
> 
> 标签：javascript, node.js, roku

我不确定这是否可能，或者我是否采取了错误的方法，我已经尝试过搜索，但我不确定这些条款。

我想将一个变量传递给控制器​​字典，所以在查找中我可以做一些类似控制器（'OPTION'，'PLAY'）的事情，而不是使用'PLAY'

```
var ip = '192.168.1.5'
var Keys = {
            HOME:          '/keypress/Home',
            REV:           '/keypress/Rev',
            FWD:           '/keypress/Fwd',
            PLAY:          '/keypress/Play',
            SELECT:        '/keypress/Select',
            LEFT:          '/keypress/Left',
            RIGHT:         '/keypress/Right',
            DOWN:          '/keypress/Down',
            UP:            '/keypress/Up',
            BACK:          '/keypress/Back',
            INSTANTREPLAY: '/keypress/InstantReplay',
            INFO:          '/keypress/Info',
            BACKSPACE:     '/keypress/Backspace',
            SEARCH:        '/keypress/Search',
            ENTER:         '/keypress/Enter',
            A:             '/keypress/Lit_a'
     } 
```

由此：

```
var controller = {
                  PLAY:{
                        hostname: ip,
                        port: 8060,
                        path: Keys['PLAY'],
                        method: 'POST'
                        }
                  } 
```

对此：

```
var controller = {
                  OPTION:{
                        hostname: ip,
                        port: 8060,
                        path: Keys[Key],
                        method: 'POST'
                        }
                  } 
```

我试图避免以下情况

```
var controller = {
                  PLAY:{
                        hostname: ip,
                        port: 8060,
                        path: Keys['PLAY'],
                        method: 'POST'
                        }
                  FWD :{
                        hostname: ip,
                        port: 8060,
                        path: Keys['FWD'],
                        method: 'POST'
                        }
                  REV :{
                        hostname: ip,
                        port: 8060,
                        path: Keys['REV'],
                        method: 'POST'
                        }
                  ...

                  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:42:13.623

你有没有想过这样的事情：

```
controller = {
       OPTION : function(key){
                    return {
                    hostname: ip,
                    port: 8060,
                    path: Keys[key],
                    method: 'POST'
                   } 
                   }
              } 
```

然后你可以用 controller.OPTION("PLAY") 得到它。它本质上是创建 getOption() 方法 epascerallo 建议只是耦合到控制器对象中。

# java - 使用触发器在mysql行中并发更新

> ID：14777836
> 
> 赞同：1
> 
> 时间：2013-02-08T17:14:15.523
> 
> 标签：java, mysql, web-services, concurrency

我有一个使用 Java + Mysql 的基于肥皂的 Web 服务。

Web 服务包括保存和发送作为响应生成的文档。每个用户都有有限数量的可用文档。该服务向外部系统提供文档，因此，我必须随时了解特定用户可用的文档。

为了改进这一点，构建一个触发器，在创建新文档时更新用户行。

```
CREATE TRIGGER `Service`.`discount_doc_fromplan`
AFTER INSERT ON `Service`.`Doc` FOR EACH ROW
UPDATE `Service`.`User` SET User.DocAvailable = User.DocAvailable - 1 where User.id = NEW.idUser 
```

当用户由于他们的系统而尝试同时创建 2 个或更多文档时，就会出现问题。这给了我一个“试图获得锁定时发现的死锁”。

有人想在没有死锁问题的情况下改进这一点，同时提供正确数量的可用文档？这是我的第一个网络服务。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T12:55:07.467

您正在尝试在数据库触发器中实现业务逻辑。您可以在 (1) Web 服务应用程序中间件或 (2) 存储过程中实现此逻辑，而不是触发器。我更喜欢方法（1）。`Doc`两者中的基本代码将在累积计数器中收集用户在表中的所有插入，并在所有插入结束时一次性更新`User`表`DocAvailable = DocAvailable -counter`。您可以在事务中执行此操作，以便在出现问题时可以回滚。在开始交易之前，您必须阅读可用`Doc quota`的。`user`

# javascript - 对象没有方法 onFrame

> ID：14777838
> 
> 赞同：0
> 
> 时间：2013-02-08T17:14:27.910
> 
> 标签：javascript, methods, kineticjs

抱歉这可能是一个非常愚蠢的问题，但我正在尝试学习如何使用 KineticJS 并尝试修改教程（[http://www.html5canvastutorials.com/labs/html5-canvas-star-spinner/](http://www.html5canvastutorials.com/labs/html5-canvas-star-spinner/)）以使用静态图像而不是形状。对于它的价值，我正在尝试为格伦贝克的头部制作 PNG 动画以使其旋转（这里和那里都没有）。

到目前为止，我已经搞砸了一堆错误，但我一直被“未捕获的 TypeError：Object# has no method 'onFrame'”所困扰

我已经在 SO 和其他网站上阅读了有关对象/方法的多个问题，虽然我认为我理解问题所在，但我不确定如何解决它：

[对象对象没有方法](https://stackoverflow.com/questions/11261009/object-object-has-no-method)

[JavaScript 对象没有方法](https://stackoverflow.com/questions/9703880/javascript-object-has-no-method)

[contains 是对象没有方法吗？](https://stackoverflow.com/questions/12342787/contains-is-object-has-no-method)

据我了解，“无方法”错误意味着没有可调用的函数..？当然，“onFrame”存在于 Kinetic 内部，但..？我尝试查看 Kinetic 文档，看看他们是否在 3.8.X（教程）和 4.X（我正在使用的库）之间更改了名称，但看起来并没有。

这是我的代码：

```
<head>
    <script src="http://test.XXXXX.com/js/kinetic-v4.3.2.js"></script>
    <script>
        function animate(animatedLayer, beck, frame){
            var canvas = animatedLayer.getCanvas();
            var context = animatedLayer.getContext();

            // update
            var angularFriction = 0.2;
            var angularVelocityChange = beck.angularVelocity * frame.timeDiff * (1 - angularFriction) /     1000;
            beck.angularVelocity -= angularVelocityChange;

            if (beck.controlled) {
                beck.angularVelocity = (beck.rotation - beck.lastRotation) * 1000 / frame.timeDiff;
                beck.lastRotation = beck.rotation;
            }
            else {
                beck.rotate(frame.timeDiff * beck.angularVelocity / 1000);
                beck.lastRotation = beck.rotation;
            }

            // draw
            animatedLayer.draw();
        }

        window.onload = function(){
            console.log('stage =', stage); // DEBUG
            var stage = new Kinetic.Stage({ container: "container", width: 240, height: 320 });
            console.log('stage =', stage); // DEBUG
            var backgroundLayer = new Kinetic.Layer();
            var animatedLayer = new Kinetic.Layer();

            var beck = new Image();
              beck.onload = function() {

                    var beck = new Kinetic.Image({
                      x: 240,
                      y: stage.getHeight() / 2 - 59,
                      image: beckHead,
                      width: 150,
                      height: 230
                    });
                beckHead.src = "http://test.XXXXX.com/i/beckhead.png";
                animatedLayer.add(beck);
             };

            stage.on("mousedown", function(evt){
                this.angularVelocity = 0;
                this.controlled = true;
            });

            // add listeners to container
            stage.on("mouseup", function(){
                beck.controlled = false;
            }, false);

            stage.on("mouseout", function(){
                beck.controlled = false;
            }, false);

            stage.on("mousemove", function(){
                if (beck.controlled) {

                    var mousePos = stage.getMousePosition();
                    var x = (stage.width / 2) - mousePos.x;
                    var y = (stage.height / 2) - mousePos.y;
                    beck.rotation = 0.5 * Math.PI + Math.atan(y / x);

                    if (mousePos.x <= stage.width / 2) {
                        beck.rotation += Math.PI;
                    }
                }
            }, false);

            stage.add(backgroundLayer);
            stage.add(animatedLayer);

            // draw background
            var context = backgroundLayer.getContext();
            context.save();
            context.beginPath();
            context.moveTo(stage.width / 2, stage.height / 2);
            context.lineTo(stage.width / 2, stage.height);
            context.strokeStyle = "#555";
            context.lineWidth = 4;
            context.stroke();
            context.restore();

            stage.onFrame(function(frame){
            console.log("onFrame fired")
                animate(animatedLayer, beck, frame);
            });

            stage.start();
        };
    </script>
</head>
<body onmousedown="return false;">
    <div id="container"><canvas id="container"></canvas>
    </div>

</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T21:05:51.400

这是使用版本 3.8.4 的过时示例

```
<script src="http://www.html5canvastutorials.com/libraries/kinetic-v3.8.4.js"> 
```

, 当前版本 > 4.3

```
<script src="http://www.html5canvastutorials.com/libraries/kinetic-v4.3.0-beta2.js"></script> 
```

当前版本没有 Stage#onFrame 和 Stage#start 等方法。

您可以使用此示例[http://www.html5canvastutorials.com/kineticjs/html5-canvas-kineticjs-rotation-animation-tutorial/](http://www.html5canvastutorials.com/kineticjs/html5-canvas-kineticjs-rotation-animation-tutorial/)作为您的基础，然后添加 stage.on("mouseup/down/move/out")捕捉鼠标移动并影响动画。

完美的答案是将旧示例转换为新版本，我将来可能会尝试。

# parameters - NMAP 连续 ping

> ID：14777840
> 
> 赞同：5
> 
> 时间：2013-02-08T17:14:34.260
> 
> 标签：parameters, cycle, ping, continuous, nmap

我需要实现一个能够每秒向一定数量的目的地发送 ping 数据包的代码。问题是我想在 1 秒的窗口内 ping 尽可能多的目的地。出于这个原因，我在想是否有一种方法可以将循环强加到 nmap [我的意思是类似于 -cycle nmap 参数]，这样套接字只会打开一次并在循环 ping 结束时关闭，这比使用“看nmap”的方法！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T17:55:07.757

Nmap 项目的一部分是[Nping 工具](http://nmap.org/nping/)。它旨在完全按照您的意愿行事，并且非常可配置。这是一个示例运行：

```
$ sudo nping --rate 4 --icmp 192.168.1.4/30

Starting Nping 0.6.26SVN ( http://nmap.org/nping ) at 2013-02-08 11:53 CST
SENT (0.0192s) ICMP 192.168.1.142 > 192.168.1.5 Echo request (type=8/code=0) ttl=64 id=53659 iplen=28 
SENT (0.2692s) ICMP 192.168.1.142 > 192.168.1.6 Echo request (type=8/code=0) ttl=64 id=53659 iplen=28 
SENT (0.5193s) ICMP 192.168.1.142 > 192.168.1.7 Echo request (type=8/code=0) ttl=64 id=53659 iplen=28 
SENT (0.7695s) ICMP 192.168.1.142 > 192.168.1.4 Echo request (type=8/code=0) ttl=64 id=53659 iplen=28 
SENT (1.0196s) ICMP 192.168.1.142 > 192.168.1.5 Echo request (type=8/code=0) ttl=64 id=53659 iplen=28 
SENT (1.2701s) ICMP 192.168.1.142 > 192.168.1.5 Echo request (type=8/code=0) ttl=64 id=53659 iplen=28 
RCVD (1.2707s) ICMP 192.168.1.5 > 192.168.1.142 Echo reply (type=0/code=0) ttl=64 id=34160 iplen=28 
SENT (1.5206s) ICMP 192.168.1.142 > 192.168.1.7 Echo request (type=8/code=0) ttl=64 id=53659 iplen=28 
SENT (1.7708s) ICMP 192.168.1.142 > 192.168.1.4 Echo request (type=8/code=0) ttl=64 id=53659 iplen=28 
SENT (2.0209s) ICMP 192.168.1.142 > 192.168.1.5 Echo request (type=8/code=0) ttl=64 id=53659 iplen=28 
SENT (2.2712s) ICMP 192.168.1.142 > 192.168.1.5 Echo request (type=8/code=0) ttl=64 id=53659 iplen=28 
RCVD (2.2717s) ICMP 192.168.1.5 > 192.168.1.142 Echo reply (type=0/code=0) ttl=64 id=34161 iplen=28 
SENT (2.5216s) ICMP 192.168.1.142 > 192.168.1.7 Echo request (type=8/code=0) ttl=64 id=53659 iplen=28 
SENT (2.7717s) ICMP 192.168.1.142 > 192.168.1.4 Echo request (type=8/code=0) ttl=64 id=53659 iplen=28 
SENT (3.0219s) ICMP 192.168.1.142 > 192.168.1.5 Echo request (type=8/code=0) ttl=64 id=53659 iplen=28 
SENT (3.2724s) ICMP 192.168.1.142 > 192.168.1.5 Echo request (type=8/code=0) ttl=64 id=53659 iplen=28 
RCVD (3.2730s) ICMP 192.168.1.5 > 192.168.1.142 Echo reply (type=0/code=0) ttl=64 id=34162 iplen=28 
SENT (3.5230s) ICMP 192.168.1.142 > 192.168.1.7 Echo request (type=8/code=0) ttl=64 id=53659 iplen=28 
^C 
Statistics for host 192.168.1.4:
 |  Probes Sent: 4 | Rcvd: 0 | Lost: 4  (100.00%)
 |_ Max rtt: N/A | Min rtt: N/A | Avg rtt: N/A
Statistics for host 192.168.1.5:
 |  Probes Sent: 4 | Rcvd: 3 | Lost: 1  (25.00%)
 |_ Max rtt: 0.391ms | Min rtt: 0.263ms | Avg rtt: 0.332ms
Statistics for host 192.168.1.6:
 |  Probes Sent: 4 | Rcvd: 0 | Lost: 4  (100.00%)
 |_ Max rtt: N/A | Min rtt: N/A | Avg rtt: N/A
Statistics for host 192.168.1.7:
 |  Probes Sent: 3 | Rcvd: 0 | Lost: 3  (100.00%)
 |_ Max rtt: N/A | Min rtt: N/A | Avg rtt: N/A
Raw packets sent: 15 (420B) | Rcvd: 3 (138B) | Lost: 12 (80.00%)
Tx time: 3.57078s | Tx bytes/s: 117.62 | Tx pkts/s: 4.20
Rx time: 3.57078s | Rx bytes/s: 38.65 | Rx pkts/s: 0.84
Nping done: 4 IP addresses pinged in 3.59 seconds 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:27:20.883

您可以通过以下方式在命令行中生成多个并行 nmap 进程：

```
nmap [options for destination 0] > output0 & 
```

为每个目标生成许多这样的 nmap 请求，同时保持 outputX 文件（输出 0、输出 1 等）的运行索引。当所有请求都完成后，您可以检查每个输出文件的内容

# javascript - Angularjs 输入 [placeholder] 指令与 ng-model 中断

> ID：14777841
> 
> 赞同：10
> 
> 时间：2013-02-08T17:14:35.117
> 
> 标签：javascript, angularjs, angularjs-directive

因此，使用 angularjs 工作的第一天，我还不太明白。我正在尝试使用角度指令模仿 html5 占位符。在我向该字段添加一个 ng-model 之前它完全有效，然后它仅在用户与该字段交互并破坏该字段的任何值之后才有效。

代码在这里 [http://jsbin.com/esujax/32/edit](http://jsbin.com/esujax/32/edit)

* * *

### 指令

```
App.directive('placehold', function(){
  return {
    restrict: 'A',
    link: function(scope, element, attrs) {
      var insert = function() {
        element.val(attrs.placehold);
      };

      element.bind('blur', function(){
        if(element.val() === '')
          insert();
      });

      element.bind('focus', function(){
        if(element.val() === attrs.placehold)
          element.val('');
      });

      if(element.val() === '')
        insert();
    }
  }
}); 
```

### html

```
<textarea ng-model="comment" placehold="with a model it doesn't work"></textarea> 
```

* * *

看起来超级简单，但我迷路了

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-08T17:58:04.047

您的示例中只需进行一些修改：

```
app.directive('placehold', function() {
  return {
    restrict: 'A',
    require: 'ngModel',
    link: function(scope, element, attr, ctrl) {      

      var value;

      var placehold = function () {
          element.val(attr.placehold)
      };
      var unplacehold = function () {
          element.val('');
      };

      scope.$watch(attr.ngModel, function (val) {
        value = val || '';
      });

      element.bind('focus', function () {
         if(value == '') unplacehold();
      });

      element.bind('blur', function () {
         if (element.val() == '') placehold();
      });

      ctrl.$formatters.unshift(function (val) {
        if (!val) {
          placehold();
          value = '';
          return attr.placehold;
        }
        return val;
      });
    }
  };
}); 
```

你可以在这里测试它：http: [//plnkr.co/edit/8m54JO ?p=preview](http://plnkr.co/edit/8m54JO?p=preview)

不确定，这是最好的解决方案，无论如何它都有效。即使您键入与 placehold 属性中相同的文本，也会导致它检查模型的焦点值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-03T19:55:04.890

您还可以签出一个 Angular.JS 模块，该模块为旧版 Web 浏览器实现“占位符”属性：

[https://github.com/urish/angular-placeholder-shim](https://github.com/urish/angular-placeholder-shim)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-30T16:24:57.023

我创建了一个占位符指令，它可以采用 angularjs 表达式，还可以在输入时隐藏占位符文本。[您可以在http://blog.f1circle.com/2013/09/supporting-placeholders-in-non-html5.html](http://blog.f1circle.com/2013/09/supporting-placeholders-in-non-html5.html)阅读有关占位符的信息

这是要点。

```
(function(angular, app) {
  "use strict";
  app.directive('placeholder',["$document", "$timeout", function($document, $timeout){
    var link = function(scope,element,attrs,ctrl){

      // if you dont use modernizr library use the solution given at
      // http://stackoverflow.com/questions/5536236/javascript-check-for-native-placeholder-support-in-ie8
      // to check if placeholder is supported natively
      if(Modernizr.input.placeholder){
        return;
      }

      /*
        The following keys all cause the caret to jump to the end of the input value
        27,  Escape
        33,  Page up
        34,  Page down
        35,  End
        36,  Home
        Arrow keys allow you to move the caret manually, which should be prevented when the placeholder is visible
        37,  Left
        38,  Up
        39,  Right
        40,  Down
        The following keys allow you to modify the placeholder text by removing characters, which should be prevented when the placeholder is visible
        8,  Backspace
        46  Delete
      */

      var pTxt, modelValue, placeholding = false, badKeys = [27,33,34,35,36,37,38,39,40,8,46];

      var unplacehold = function(){
        if(!placeholding){
          return;
        }
        placeholding = false;
        element.removeClass('placeholder');
        element.val('');
      };

      var placehold = function(){
        if(placeholding || modelValue){
          return;
        }
        placeholding = true;
        element.addClass('placeholder');
        element.val(pTxt);
      };

      var moveCaret = function(elem, index) {
        var range;
        if (elem.createTextRange) {
          range = elem.createTextRange();
          range.move("character", index);
          range.select();
        } else if (elem.selectionStart) {
          elem.focus();
          elem.setSelectionRange(index, index);
        }
      };

      attrs.$observe('placeholder',function(value){
        pTxt = value;
        placeholding = false;
        placehold();
      });

      ctrl.$parsers.unshift(function (value){
        modelValue = value;
        if(!value){
          placehold();
        }
        if(placeholding){
          return '';
        }
        return value;
      });

      ctrl.$formatters.unshift(function (value){
        if(!value){
          placehold();
          modelValue = '';
          return pTxt;
        }
        return value;
      });

      element.on('click focus contextmenu',function(event){
        if($document[0].activeElement  !== this){
          return;
        }

        if(!modelValue){
          moveCaret(this,0);
        }
      });

      element.on('blur',function(){
        placehold();
      });

      element.on('keydown',function(e){
        if(!placeholding){
          return;
        }
        if(_.contains(badKeys,e.keyCode)){
          if(e.preventDefault){
            e.preventDefault();
          }
          return false;
        }
        unplacehold();
      });

      element.on('keyup',function(e){
        if(modelValue){
          return;
        }
        placehold();
        moveCaret(this,0);
      });

      element.on('paste',function(e){
        $timeout(function(){
          modelValue = element.val();
        },0);

      });
    };

    return{
      restrict: 'A',
      require: 'ngModel',
      link : link,
      priority:3,
    };
  }]);
})(angular, app); 
```

这适用于所有情况，除非复制和粘贴相同的占位符文本。

# ruby - 在 Ruby 中测试数组包含的最快方法

> ID：14777853
> 
> 赞同：1
> 
> 时间：2013-02-08T17:15:00.297
> 
> 标签：ruby, arrays, benchmarking

我想知道。在 Ruby 中测试一个数组是否包含另一个数组的最快方法是什么？所以我构建了这个小基准脚本。很想听听您对比较方法的看法。你知道其他的——也许是更好的方法吗？

```
require 'benchmark'
require 'set'

a = ('a'..'z').to_a.shuffle
b = ["b","d","f"]

Benchmark.bm do |x|
  x.report do
      10000.times do
          Set[b].subset?(a.to_set)
      end
  end
  x.report do
      10000.times do
          (a & b).count == b.size
      end
  end
    x.report do
      10000.times do
          (a.inject(0) {|s,i| s += b.include?(i)?1:0 } == b.size)
      end
    end
    x.report do
      10000.times do
          (b - a).empty?
      end
    end
    x.report do
      10000.times do
          b.all? { |o| a.include? o }
      end
    end
end 
```

和结果：

```
 user     system      total        real
 0.380000   0.010000   0.390000 (  0.404371)
 0.050000   0.010000   0.060000 (  0.075062)
 0.140000   0.000000   0.140000 (  0.140420)
 0.130000   0.000000   0.130000 (  0.136385)
 0.030000   0.000000   0.030000 (  0.034405) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T18:07:23.457

首先，对微基准测试要非常小心。我建议为此使用我的 gem [`fruity`](https://github.com/marcandre/fruity)，请参阅文档了解原因。

其次，你想比较你的数组的创建加上比较，还是只是比较？

第三，你的数据太小了，你无法理解发生了什么。例如，您的`b`变量包含 3 个元素。如果您将算法 in`O(n^2)`与 one in进行比较`O(n)`，那么 (3) 这么小`n`就不会很明显。

你可能想从：

```
require 'fruity'
require 'set'

a = ('a'..'z').to_a.shuffle
b = %w[b d f]
a_set = a.to_set
b_set = b.to_set

compare do
  subset        { b_set.subset?(a_set) }
  intersect     { (a & b).size == b.size }
  subtract      { (b - a).empty? }
  array_include { b.all?{|o| a.include? o} }
  set_include   { b.all?{|o| a_set.include? o} }
end 
```

给出：

```
Running each test 2048 times. Test will take about 2 seconds.
set_include is faster than subset by 1.9x ± 0.1
subset is faster than intersect by 60% ± 10.0%
intersect is faster than array_include by 40% ± 1.0%
array_include is faster than subtract by 1.9x ± 0.1 
```

请注意，`Array#&`and`Array#-`基本上会在`Set`内部将参数转换为 a。数组上的`all?`and`include?`应该是最糟糕的解决方案，因为它会`O(n^2)`......如果你增加`b`.

一般的答案是：除非您确定需要优化，否则使用最易读的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:33:38.493

这取决于您的数据大小。对于您拥有的小型数据集；`b.all? { |o| a.include? o }`几乎每次都更快。

但是，如果您尝试使用更大的数组。例如 1000 个元素的数组，`(a & b) == b.size`速度要快得多。

我还尝试了相反的版本：`(a | b) == a.size`，它或多或少是相同的。

以下是（注释的）结果，其中`a`有 10000 个元素和`b`5000 个元素：

```
 user     system      total        real
0.010000   0.000000   0.010000 (  0.004445) # subset
0.000000   0.000000   0.000000 (  0.003073) # & (intersection)
1.620000   0.000000   1.620000 (  1.625472) # inject
0.000000   0.000000   0.000000 (  0.004485) # difference
0.530000   0.000000   0.530000 (  0.529042) # include
0.010000   0.000000   0.010000 (  0.004416) # | (union) 
```

# c# - 如果我知道字符串的长度，是否应该将其声明为具有特定长度的字符

> ID：14777856
> 
> 赞同：0
> 
> 时间：2013-02-08T17:15:02.970
> 
> 标签：c#, string, entity-framework

我正在为我的 C#.NET 项目准备一个实体框架模型（代码优先）。我突然意识到，我要将 PageTitles 存储为字符串，除了可用的最大和最小位之外，没有长度限制。

我假设如果我知道一个字符串的长度为 255 个字符并且永远不会超过这个长度，我可以将我的字符串声明为一个新的 char[255]。

使用 char 而不是 string 有什么缺点。使用 char 而不是 string 有什么好处。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace ContentManagementSystem.Models
{
    public class Page
    {
        int Id { get; set; }
        string PageTitle { get; set; }
        // This seems wasteful and unclear     

        char[] PageTitle = new char[255]; 
        // How would i apply { get; set; } to this?
    }
} 
```

有什么方法可以限制字符串的大小吗？

---------------已回答----------

现在这是我的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

using System.ComponentModel.DataAnnotations;
using System.Data.Entity;

namespace ContentManagementSystem.Models
{
    public class Page
    {
        public int Id { get; set; }        
        [MaxLength(255)] public string Title { get; set; }
        [MaxLength(255)] public string Description { get; set; }
        public string Content { get; set; }
    }

    public class MyDbContext : DbContext
    {
        public DbSet<Page> Pages { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T17:18:38.790

`char[]`不，当您打算将它作为字符串进行操作时，您不应该使用它。为什么？因为`string`如果您使用字符数组，您将无法使用大量有用的方法。字符数组的性能优势（如果有的话）将非常小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:19:02.167

编辑：正如 DamienG 所指出的，这仅在代码优先的情况下才有效。

你在找这个吗？

```
[MaxLength(255)]
public string PageTitle { get; set; } 
```

引用的 dll： **Assembly System.ComponentModel.DataAnnotations.dll**

引用的命名空间： `namespace System.ComponentModel.DataAnnotations`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T17:19:18.143

我不会将字符串存储为字符，因为当你将它们传递给需要字符串的东西时，你会永远诅咒它们。

您可以使用模型优先的设计器或使用 Code First 模型的属性上的 MaxLength 属性在 Entity Framework 中指定字符串的最大长度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T17:24:49.907

使用 StringLength 属性通知框架最大长度。您可以继续使用字符串而不是字符数组。

```
using System.ComponentModel.DataAnnotations;
...
[StringLength(255)]
public string PageTitle { get; set; } 
```

在这种情况下使用 StringLength 属性可能比 MaxLength 属性更可取，因为模型验证框架也可以使用 StringLength 来验证用户输入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-08T17:32:52.740

如果注意到基本的不便足以说服您不要这样做 - 这也违反了 C#/.Net 的 API 设计指南 - 由于行为不明确（是否复制/引用）和潜在的，不建议通过 get/set 方法返回数组由于复制大型数组而影响性能。

当您重新阅读示例代码时，您将已经知道答案 - 在公共 API 中替换为坏主意，`string`因为`char[255]`它很难处理 - 您不知道如何设置它。大多数人会期望“XxxxxTitle”属性是任何类型`string`。

如果您需要设置长度限制 - 只需在`set`方法中强制执行它。

# php - 如何在 Windows 中为 PHP 安装和使用 memcached？

> ID：14777857
> 
> 赞同：10
> 
> 时间：2013-02-08T17:15:04.117
> 
> 标签：php, memcached

我已经在 Windows 7 中安装了 memcached 二进制文件并将其作为服务器启动。

当我输入 wmic process get description, exetuablepath | findstr memcached.exe 我得到响应：memcached.exe c:\memcached\memcached.exe 在命令行上。

当我尝试在 php.net 上运行示例代码时，我进入了我的浏览器：

**致命错误：在第 3 行的 C:\DocumentRoot\Framework\index.php 中找不到类 'Memcache' 调用堆栈：0.0010 335928 1\. {main}() C:\DocumentRoot\Framework\index.php:0**

那么，我做错了什么？我正在使用 memcache.dll，因为我相信 Windows 不存在 memcached.dll？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-04-27T06:27:36.200

给在 Windows 上运行 memcached 时遇到问题的任何人的说明。

*   对于初学者，请确保您拥有正确版本的 memcached dll 并且它是可访问的。在[http://windows.php.net/downloads/pecl/releases/memcache/3.0.8/](http://windows.php.net/downloads/pecl/releases/memcache/3.0.8/)上有很多选择，而且**很容易选择错误的 memcached 版本！**.
*   如果您运行的是 PHP 5.5，您还需要 php5.dll。你可以[在这里得到这个](http://originaldll.com/file/php5.dll/30704.html)
*   您可能需要编辑您的环境 PATH 设置，以便可以找到此 dll。转到我的电脑->属性->高级，然后单击环境变量以查看/编辑路径。如果您编辑它，您需要重新启动计算机。
*   **确保已安装 memcached 服务器**。Ctrl + Alt + Del 并检查 memcached 是否存在于您的服务列表中
*   如果不是，您需要***从 Cmd 提示符安装它**以管理员身份运行（从开始菜单，选择附件，单击命令提示符并选择以管理员身份运行） c:\pathtomemcached\memcached.exe -d install
*   在此之后使用***c:\pathtomemcached\memcached.exe -d start***或 net start “memcached Server”。在我的安装中，前者不起作用
*   同样，我无法从任务管理器的“服务”选项卡启动 memcached
*   能够在低级别使用 memcached 非常方便，因此如果需要，[启用 telnet](http://social.technet.microsoft.com/wiki/contents/articles/910.windows-7-enabling-telnet-client.aspx)并从命令提示符键入 telnet。现在打开端口 11211 并尝试使用 memcached
*   能够密切关注 memcached 中发生的事情也很有用。[phpMemCacheAdmin](https://code.google.com/p/phpmemcacheadmin/)是迄今为止最好的工具

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T17:33:08.210

根据评论，我假设您尚未下载并安装 memcached，但已成功安装了 PHP 的 memcached 模块。基本上，你已经拿到了车钥匙，但没有车。

memcached 是为 Linux 构建的，但已被其他人移植到 Windows。本教程很旧，但它可能是您正在寻找的：http: [//www.codeforest.net/how-to-install-memcached-on-windows-machine](http://www.codeforest.net/how-to-install-memcached-on-windows-machine)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-09T03:47:15.613

这是给未来的游客的！

1.  检查 phpinfo() 并查看它是否已列出。
2.  如果没有，请检查是否在 php.ini 中启用了扩展，然后检查 apache 错误日志中的错误消息！dll 应该使用与 php 相同的编译器。（VC9 或 VC6）顺便说一句，memcache.dll 很好

您可以在此处获取 php 扩展名“memcache”以在 Windows 上将 memcached 与 php 一起使用[http://downloads.php.net/pierre/](http://downloads.php.net/pierre/)

Memcached 是服务器守护进程，您可以在此处为 Windows 获取它[http://splinedancer.com/memcached-win32/](http://splinedancer.com/memcached-win32/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-09-21T23:03:34.467

您`composer.json`应该已经`ext-memcached`在其中列出，但它不会安装，如果它丢失它只会抛出一个错误。以下是获得它的各种方法：

## Windows 二进制路由

截至 2018 年，AFAIK 没有适用于 PHP 7 的 JUST Memcached 的二进制 Windows 端口，但在[Laragon](https://laragon.org/)或[Winginx中有一个预打包的版本](http://winginx.com/en/) [![在此处输入图像描述](../Images/268474367c4e35ae6138b98cd3ab09ef.png)](https://i.stack.imgur.com/rTaXJ.png)

## Windows DLL 路由

有[少数](https://stackoverflow.com/questions/34952502/memcache-for-php7-on-windows)人在 github 上提供已[编译的 DLL](https://github.com/nono303/PHP7-memcache-dll)（64 位，并提供线程安全）

## Linux 路由的 Windows 子系统

```
ubuntu
sudo add-apt-repository ppa:ondrej/php
sudo apt-get update
sudo apt install php-memcached 
```

如果使用它，请重新启动 php fpm`sudo service php7.2-fpm restart`

## 从源路由编译

[您可以编译 php 绑定](https://github.com/php-memcached-dev/php-memcached/issues/374)，但[memcached 的 windows 包](https://chocolatey.org/packages/memcached)已损坏 4 年（截至 2018 年）

## 仅本地缓存文件 Polyfill 路由

这是一个名为 StaticCache 的 Memcached 脏包装器，您可以在紧要关头使用它从磁盘读取/写入值。它显然比 memcached 慢得多，所以它只是作为 Windows 开发的一个鞋垫。如果您喜欢，可以将其定义为同名的 polyfill

```
function StaticCacheClear()
{
    foreach (scandir(sys_get_temp_dir()) as $file) {
        if (StringBeginsWith($file, "staticcache"))
        {
            $path = sys_get_temp_dir() ."/". $file;
            unlink($path);
        }
    }
    global $Memcache;
    if ($Memcache) $Memcache->flush();
}

// REMOVE if you don't want a global way to clear cache
if (isset($_GET['clear_static_cache'])) {
    StaticCacheClear();
}

function MemcacheGet($key)
{
    global $Memcache;
    $value = $Memcache ? $Memcache->get($key) : (file_exists($key)?file_get_contents($key):null);

    return !$Memcache? $value : (Memcached::RES_NOTFOUND === $Memcache->getResultCode() ? null : $value);
}

function StaticCacheKey($key)
{
    global $Memcache;
    $cacheVersion = "MY_APP_VERSION_HERE";
    $uniqueKey = "staticcache_{$key}_"  . date("Ymd") . "$cacheVersion.cache";
    $filename = sanitize_file_name($uniqueKey);
    $filename = sys_get_temp_dir() . '/' . $filename;
    return $Memcache ? $uniqueKey : $filename;
}

function StaticCacheWrite($key, $value)
{
    global $Memcache;
    if (isset($_GET['disable-cache'])) return null;
    if ($Memcache)
        $Memcache->set(StaticCacheKey($key), serialize($value));
    else
        file_put_contents(StaticCacheKey($key), serialize($value));
}

function StaticCacheRead($key)
{
    global $Memcache;
    $key = StaticCacheKey($key);
    $value = MemcacheGet($key);
    return $value !== null ? unserialize($value) : null;
} 
```

# oracle - 日期范围内的有效 ID

> ID：14777860
> 
> 赞同：-1
> 
> 时间：2013-02-08T17:15:14.897
> 
> 标签：oracle, date, range

我需要根据他们的收入贡献期在一个月内获得活跃的客户数量。

**原始数据：**

```
ACCOUNT_ID  REVENUE_START_DATE       REVENUE_END_DATE
1234         1/14/2010 0:00          4/13/2010 23:59
4567         2/9/2010 0:00           3/8/2010 23:59
1234         5/9/2010 0:00           6/8/2010 23:59 
```

**预期结果**

```
Month   Count
Dec-09  0
Jan-10  1
Feb-10  2
Mar-10  2
Apr-10  1
May-10  1
Jun-10  1
Jul-10  0
Aug-10  0
Sep-10  
Oct-10 
```

下面是我处理的 Oracle 代码（在谷歌的帮助下），但由于日期重叠，我没有得到正确的结果。我请求专家帮助我解决这个问题。（提前致谢）

**当前结果：**

```
YEAR_   MONTH_  ACT
2010    January     2
2010    February    3
2010    March       3
2010    April       3 
```

**甲骨文代码：**

```
with tab as
(
     select distinct ACCOUNT_ID,  billing_start_date as revenue_start_date, billing_end_date as revenue_end_date
     from accounts
                ),                    
     year_tab as 
                (
                    select 
                             add_months(min_date, level -1) m
                    from 
                            (
                            select min(trunc(revenue_start_date,'YYYY')) min_date, add_months(max(trunc(revenue_end_date,'YYYY')), 12) max_date
                            from tab
                            )
                    connect by level <= months_between(max_date, min_date)
              )     
select to_char(m,'YYYY') year_,
         to_char(m,'Month') month_,
         nvl(act, 0) act
from   year_tab,
            (            
            select m date_,count(*)  act
            from tab, year_tab
            where m between trunc(revenue_start_date,'MM') and trunc(revenue_end_date,'MM')
            group by m
            ) month_tab
where m = date_(+)
order by m; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:04:01.907

我花了一段时间才明白你为什么认为有问题。使用您提供的原始三行数据，运行查询会准确给出您的“预期结果”。使用 CSV 文件中的 54 行数据，结果为 48 行（涵盖四年），从 2010 年 1 月到 2013 年 1 月的总计非零。返回的前几行是：

```
YEAR_ MONTH_                                      ACT
----- ------------------------------------ ----------
2010  January                                       2 
2010  February                                      3 
2010  March                                         3 
2010  April                                         3
2010  May                                           2 
```

但这看起来是正确的：

```
select * from accounts
where not (billing_start_date > date '2010-02-01'
        or billing_end_date < date '2010-01-01');

ACCOUNT_ID BILLING_START_DATE BILLING_END_DATE 
---------- ------------------ ------------------
      1234 09/01/2010 00:00   08/02/2010 23:59   
      4567 14/01/2010 00:00   13/04/2010 23:59   

 2 rows selected 

select * from accounts
where not (billing_start_date > date '2010-03-01'
        or billing_end_date < date '2010-02-01');

ACCOUNT_ID BILLING_START_DATE BILLING_END_DATE 
---------- ------------------ ------------------
      1234 09/01/2010 00:00   08/02/2010 23:59   
      4567 14/01/2010 00:00   13/04/2010 23:59   
      1234 09/02/2010 00:00   08/03/2010 23:59   

 3 rows selected 

select * from accounts
where not (billing_start_date > date '2010-04-01'
        or billing_end_date < date '2010-03-01');

ACCOUNT_ID BILLING_START_DATE BILLING_END_DATE 
---------- ------------------ ------------------
      4567 14/01/2010 00:00   13/04/2010 23:59   
      1234 09/02/2010 00:00   08/03/2010 23:59   
      1234 09/03/2010 00:00   08/04/2010 23:59   

 3 rows selected 
```

但我认为你想要的并不是问题中真正强调的：'让**客户数量**活跃'。假设“客户”是指唯一帐户 ID，您只需要修改计数：

```
 select m date_,count(distinct account_id)  act
    from tab, year_tab
    ... 
```

...它给出了前几行：

```
YEAR_ MONTH_                                      ACT
----- ------------------------------------ ----------
2010  January                                       2 
2010  February                                      2 
2010  March                                         2 
2010  April                                         2 
2010  May                                           1 
```

你做错了什么是试图`distinct`在你的`tab`子查询中应用；但是 distinct 返回不同的行，并且由于日期不同，实际上并没有减少返回的行数。

这仍然与您的预期结果不完全匹配，但似乎与数据匹配（如果我对您想要的假设是正确的），并且仍然为您的三行样本提供了您的预期结果。

* * *

另一种编写查询的方法，我发现它更容易理解，并使用 ANSI 连接语法：

```
with t as (
    select add_months(min_date, level - 1) month_start,
        add_months(min_date, level) next_month_start
    from (
        select trunc(min(billing_start_date),'YYYY') min_date,
            add_months(trunc(max(billing_start_date),'YYYY'), 12) max_date
        from accounts
    )
    connect by level <= months_between(max_date, min_date)
)
select to_char(t.month_start,'YYYY') year_,
    to_char(t.month_start,'Month') month_,
    count(distinct a.account_id) act
from t
left join accounts a on not (billing_start_date > t.next_month_start
    or billing_end_date < t.month_start)
group by t.month_start
order by t.month_start; 
```

# java - 是否可以在 Java SE 环境中使用 javax.interceptor？

> ID：14777865
> 
> 赞同：5
> 
> 时间：2013-02-08T17:15:40.293
> 
> 标签：java, jakarta-ee, aop, cdi

我需要使用 AOP 来解决特定问题，但它是一个小的独立 Java 程序（没有 Java EE 容器）。

我可以使用`javax.interceptor`功能，还是必须下载一些 3rd-party AOP 实现？如果可能的话，我宁愿使用 Java SE SDK 附带的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-27T10:09:19.093

您可以在 Java SE 中使用 CDI，但您必须提供自己的实现。这是一个使用参考实现的示例 - Weld：

```
package foo;
import org.jboss.weld.environment.se.Weld;

public class Demo {
  public static class Foo {
    @Guarded public String invoke() {
      return "Hello, World!";
    }
  }

  public static void main(String[] args) {
    Weld weld = new Weld();
    Foo foo = weld.initialize()
        .instance()
        .select(Foo.class)
        .get();
    System.out.println(foo.invoke());
    weld.shutdown();
  }
} 
```

类路径的唯一补充是：

```
<dependency>
  <groupId>org.jboss.weld.se</groupId>
  <artifactId>weld-se</artifactId>
  <version>1.1.10.Final</version>
</dependency> 
```

注释：

```
package foo;
import java.lang.annotation.*;
import javax.interceptor.InterceptorBinding;

@Inherited @InterceptorBinding
@Retention(RetentionPolicy.RUNTIME)
@Target({ ElementType.METHOD, ElementType.TYPE })
public @interface Guarded {} 
```

拦截器实现：

```
package foo;
import javax.interceptor.*;

@Guarded @Interceptor
public class Guard {
  @AroundInvoke
  public Object intercept(InvocationContext invocationContext) throws Exception {
    return "intercepted";
  }
} 
```

描述符：

```
<!-- META-INF/beans.xml -->
<beans xmlns="http://java.sun.com/xml/ns/javaee"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
                               http://java.sun.com/xml/ns/javaee/beans_1_0.xsd">
    <interceptors>
        <class>foo.Guard</class>
    </interceptors>
</beans> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T17:22:02.957

如果您没有使用任何类型的容器，那么您的应用程序将无法使用 Java EE 拦截器 API 的实现。

相反，您应该考虑使用像 AspectJ 这样的 AOP 解决方案，在线上有大量的教程和示例。但是，我会小心地尝试坚持遵循最新版本和最佳实践的示例，因为那里有很多旧的东西。

如果您已经在使用 Spring 框架，那么 Spring AOP 可能会满足您的要求。这将更容易集成到您的应用程序中，尽管它没有为您提供 AspectJ 的所有功能。

# javascript - 仅在同一父级中启用节点的拖放

> ID：14777866
> 
> 赞同：1
> 
> 时间：2013-02-08T17:15:42.153
> 
> 标签：javascript, extjs, drag-and-drop, extjs3, treenode

我有一个带有多个节点的 ExtJs (3.4) 树，每个节点都有多个子节点。我想允许在每个父母中进行拖放，并且我想禁止将一个父母的孩子拖放到其他父母。

有没有一种简单而优雅的方式来做到这一点？否则，我正在考虑使用 onNodeDrop 和 onNodeOver 事件。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:20:20.207

使用 jQuery-ui .sortable() [http://jqueryui.com/sortable/](http://jqueryui.com/sortable/)

在不连接列表的情况下调用 .sortable() 将允许您仅在其父项中对项目进行排序。

# excel - 如何清除在 vba 代码中设置的过滤器？

> ID：14777868
> 
> 赞同：0
> 
> 时间：2013-02-08T17:15:58.020
> 
> 标签：excel, filter, vba

我有一个 Excel VBA 项目，用于发送电子邮件，其中包含用户在工作表 1 中选择的文档。在工作表 1 中有两列：Column1 和 Column 2。Column2 将所有文档列为超链接，如果用户想要选择一个文档，他/她在文档的 Column1 中放置一个“x”。然后用户单击发送按钮发送电子邮件。这是按钮单击事件的代码：

```
…
    Set Ash = ActiveSheet
    On Error GoTo cleanup

            Ash.Range("A5:B500").AutoFilter Field:=1, Criteria1:="x"

            For Each cell In Ash.Range("B5:B300").SpecialCells(xlCellTypeVisible)
                If cell.Offset(0, -1).Value = "x" Then
                    …
                End If
            Next
…
cleanup:
    Set OutApp = Nothing
    With Application
        .EnableEvents = True
        .ScreenUpdating = True
    End With
 … 
```

当出现错误时，我的问题就出现了。用户点击发送按钮后，如果出现错误，Sheet1 只选择了那些文档，其他文​​档都被过滤掉了。每列的顶部都会显示一个过滤器按钮，这很好，因为我确实希望用户意识到出现问题。

我的问题是我无法更改过滤器设置或退出过滤器。我必须关闭 Excel 然后重新打开它。有什么方法可以通过单击 Column1 顶部的过滤器按钮清除过滤器并将所有其他文档带回来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-03T08:17:57.153

像这样的东西？

```
Sub ToggleAutofilter()
    ' check if autofilter is currently off
    If ActiveSheet.FilterMode = False Then
        ' if it's off, turn it on, and filter on "Nick"
        Range("d5").AutoFilter Field:=1, Criteria1:="Nick"
    Else
        ' if it's on, turn it off
        Range("d5").AutoFilter
    End If
End Sub 
```

请参阅此[链接](http://excelexperts.com/node/866)。

# java - 需要收集控制台应用程序输出并存储它

> ID：14777871
> 
> 赞同：0
> 
> 时间：2013-02-08T17:16:05.450
> 
> 标签：java

可以说，我已经启动了简单的 Java 应用程序，它使用以下命令将一些字符串输出到标准控制台：

```
Runtime.getRuntime().exec("Path:/to/app.exe"); 
```

我需要的是收集所有数据，启动的应用程序抛出到控制台。是否可以？谢谢。

保罗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:25:55.093

您可以使用[ProcessBuilder](http://docs.oracle.com/javase/7/docs/api/java/lang/ProcessBuilder.html)并获取其`IutputStream`. 这是一个简单的例子：

```
public static void main(String[] args) throws Exception {
    String[] processArgs = new String[]{"ping","google.com"};
    Process process = new ProcessBuilder(processArgs).start();

    BufferedReader in = new BufferedReader(new InputStreamReader(
            //I'am using Win7 with PL encoding in console -> "CP852"
            process.getInputStream(), "CP852"));

    String line;
    while ((line = in.readLine()) != null)
        System.out.println(line);

    in.close();
    System.out.println("process ended");
} 
```

# c# - 有没有办法调整其内容的边框大小？(Winnrt Xaml)

> ID：14777874
> 
> 赞同：9
> 
> 时间：2013-02-08T17:16:20.277
> 
> 标签：c#, .net, wpf, xaml, windows-runtime

我在文本块周围有一个边框，以创建一个带有圆角的漂亮背景。但无论我做什么，边框宽度始终是其父级的大小。我想将其限制为内容的大小。我尝试将宽度绑定到其内容的实际宽度，但是对于任何绑定模式都不起作用。

```
<Border x:Name="TagPreviewBorder" CornerRadius="5"
        Width="{Binding ElementName=TagPreviewTextBlock, Path=ActualWidth, Mode=TwoWay}">
   <TextBlock x:Name="TagPreviewTextBlock"/>
</Border> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-08T17:32:59.480

`Border`一个简单的解决方法是在您的 xaml中忘记并使用 a`TextBox`而不是`TextBlock`这样：

```
<TextBox Text="Your Text Here" 
         IsReadOnly="True" Background="Transparent" BorderBrush="Red" 
         BorderThickness="3" HorizontalAlignment="Left"/> 
```

**更新：** 我再次检查，似乎您忘记设置`Border`'s Horizo​​ntalAlignment

这也有效：

```
 <Border CornerRadius="5" HorizontalAlignment="Left" BorderThickness="10">
        <TextBlock Text="My Text Here"></TextBlock>
    </Border> 
```

# json - jqgrid onClickSubmit 和 afterSubmit 事件的内联保存按钮

> ID：14777876
> 
> 赞同：3
> 
> 时间：2013-02-08T17:16:22.993
> 
> 标签：json, events, jqgrid, inline-editing

我一直在四处寻找答案，但找不到足以回答我问题的答案...

我有一个 JQ Grid，它同时利用内联和表单编辑，并使用 blockUI 在服务器正在执行它的东西时显示“工作”消息。这对于表单编辑/添加/删除非常有效，因为我使用**onclickSubmit**到*blockUI*和**afterSubmit**到*unblockUI*。

问题来了，因为我找不到在**Inline Edit**中执行此操作的方法。任何人都可以提出实现这一目标的方法吗？

我想知道在哪里捕获单击“保存”图标时触发的事件（在请求发送到服务器之前），以便我可以阻止 UI：

以及从服务器发回响应时在哪里捕获触发的事件。

必须有一种方法可以使用下面的“editRow”或“saveRow”来执行此操作，但我无法确定在何处以及在哪些事件中放置诸如此类的命令。

* * *

*奥列格回应后编辑*

我应该在哪里调用“editRow”函数？如果我使用 onSelectRow，它会在选择行时对其进行操作——这会改变网格的行为——因为它现在不会在操作列中显示“保存”按钮。我可以在哪里放置“editRow”调用，以便在选择内联编辑图标时触发它？

```
 $(document).ready(function() {
        $('#jpgCustomers').jqGrid({
            //url from wich data should be requested
            url: '@Url.Action("Customers")',
            //type of data
            datatype: 'json',
            //url access method type
            mtype: 'POST',
            serializeRowData: function(postData) {
                $.blockUI({message: ("#working")});
                return postData;
            },
            //columns model
            //columns names
            colNames: ['No.', 'Name', 'FullName', 'Description', 'Enabled', 'Email Address', 'Phone', 'Pager', 'Fax', 'Comments', ' '],
            colModel: [
                //displayed Columns
                { name: 'Number', index: 'Number', align: 'center', width: 40, editable: false, search: false },
                { name: 'LogonName', index: 'LogonName', align: 'left', width: 80, editable: true, search: true, stype: 'text', editrules: { required: true } },
                { name: 'FullName', index: 'FullName', align: 'left', width: 200, editable: true, search: true, stype: 'text', editrules: { required: true } },
                { name: 'Description', index: 'Description', align: 'left', width: 300, editable: true, search: true, stype: 'text' },
                { name: 'Enabled', index: 'Enabled', align: 'center', width: 80, editable: true, formatter: SFTPEnabledFormatter, unformat: SFTPEnabledUnformatter, edittype: 'select', editoptions: { value: '-2:Inherited;0:Disabled;1:Enabled' }, search: true, stype: 'select', searchoptions: { value: "-1:All;-2:Inherited;1:Enabled;0:Disabled" } },
                //Hidden Columns
                { width: 60, name: 'Email', index: 'Email', hidden: true, editable: true, editrules: { required: true, edithidden: true }, editype: 'email' },
                { width: 60, name: 'Phone', index: 'Phone', hidden: true, editable: true, editrules: { required: false, edithidden: true, number: true, minValue: 0 }, editype: 'text' },
                { width: 60, name: 'Pager', index: 'Pager', hidden: true, editable: true, editrules: { required: false, edithidden: true, number: true, minValue: 0 }, editype: 'text' },
                { width: 60, name: 'Fax', index: 'Fax', hidden: true, editable: true, editrules: { required: false, edithidden: true, number: true, minValue: 0 }, editype: 'text' },
                { width: 120, name: 'Comments', index: 'Comments', align: 'left', hidden: true, editable: true, editrules: { required: false, edithidden: true }, edittype: 'textarea', editoptions: { rows: '3', cols: '60' } },
                //Action column
                {
                    name: 'myac',
                    width: 80,
                    fixed: true,
                    sortable: false,
                    resize: false,
                    editable: false,
                    search: false,
                    formatter: 'actions',
                    formatoptions: {
                        onSuccess: function(response) {
                            debugger;
                            $.unblockUI();
                                var jsonResponse = $.parseJSON(response.responseText);
                                if (jsonResponse.State != 'Success') {
                                    return [false, jsonResponse.ResponseMessage];
                                } else {
                                    return [true];
                                }                            },
                        onError :function(rowid, response, textStatus) {
                            debugger;
                            $.unblockUI();
                        },
                        keys: true,
                        delOptions: {
                            url: encodeURI('@Url.Action("DeleteCustomer")'),
                            onclickSubmit: function(params, posdata) {
                                $.blockUI({message: ("#working")});
                            },
                            afterSubmit: function(response, postData) {
                                $.unblockUI();
                                var jsonResponse = $.parseJSON(response.responseText);
                                if (jsonResponse.State != 'Success') {
                                    return [false, jsonResponse.ResponseMessage];
                                } else {
                                    return [true];
                                }
                            },
                            beforeShowForm: function(form) {
                                var dlgDiv = $("#delmod" + jpgCustomers.id);
                                CenterDialog(dlgDiv);
                                var sel_id = $("#DelData>td:nth-child(1)").text();
                                $("td.delmsg", form).html("Delete User <b>" + $("#jpgCustomers").jqGrid('getCell', sel_id, 'LogonName') + "</b>?");
                            }
                        }
                    }
                }
            ],
            reloadAfterSubmit: true, 
            //pager for grid
            pager: $('#jpgpCustomers'),
            //number of rows per page
            rowNum: @(Model.RowsInCustomerGrid),
            //initial sorting column
            sortname: 'FullName',
            //initial sorting direction
            sortorder: 'asc',
            //we want to display total records count
            viewrecords: true,
            //grid height
            height: '100%',
            //where to go on submit of edit/add
            editurl: encodeURI('@Url.Action("EditCustomer")'),
            //subgrid
        });
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T20:31:47.817

例如，您可以使用`serializeRowData`jqGrid 的回调或使用/在将请求发送到服务器之前`ajaxRowOptions.beforeSend`调用。例如，您可以添加到 jqGrid 选项列表`blockUI``block`

```
serializeRowData: function (postdata) {
    $(this).block({message: "<h1>Saving the data...</h1>"});
    return postdata;
} 
```

或者

```
ajaxRowOptions: {
    beforeSend: function () {
        $("#grid").block({message: "<h1>Saving the data...</h1>"});
    }
} 
```

您必须在(或) 和中都调用`unblockUI`/ 。`unblock``aftersavefunc``successfunc``errorfunc`

# assembly - read_char 系统调用在命令行 spim 中无法正常工作

> ID：14777879
> 
> 赞同：1
> 
> 时间：2013-02-08T17:16:34.563
> 
> 标签：assembly, mips, system-calls, spim

我在 MIPS 汇编中编写了这个简单的程序：

```
.data
.text
main:
li $v0, 12 # read_char
syscall
move $a0, $v0
li $v0, 11 # print_char
syscall
j main # repeat forever 
```

当我在 QtSpim 中运行它时，它可以正常工作：它从控制台获取一个字符，并在输入后立即打印它，然后重复。但是，QtSpim 的控制台不允许我粘贴程序的输入（我可以这样做，但不会被读取）。所以我尝试在Linux（命令行）版本 9.1.8的*spim中运行它。*它可以工作，但输入字符时不会立即做出反应；它总是等待换行符，即使在输入没有剪切和粘贴的字符时也是如此。所以我期望这种行为：

```
(spim) load "echo.asm"
(spim) run
hheelllloo 
```

但我得到了这个：

```
(spim) load "echo.asm"
(spim) run
hello [I press Enter here]
hello 
```

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T17:36:55.607

这是因为终端默认是行缓冲的。在读取整行之前，从终端读取不会返回。这是为了允许诸如退格之类的东西与不使用专门的终端处理库（例如ncurses，readline）的程序一起使用。您可以通过运行命令禁用此缓冲

```
stty -icanon 
```

然后运行 ​​spim，程序将在输入字符时回显这些字符。完成后，您应该重新启用缓冲输入

```
stty icanon 
```

因为无缓冲模式可能会导致其他程序出现问题。

# android - 用于谷歌地图v2的谷歌播放服务库中隐藏的build.xml？

> ID：14777881
> 
> 赞同：13
> 
> 时间：2013-02-08T17:16:42.180
> 
> 标签：android

我相信日食有一个崩溃的案例，并且发生了一些奇怪的事情。我重新启动了项目，并从头开始完成了我能想到的所有事情。

代码和配置文件看起来很完美。

++我已经通过命令行更新了项目。( `./android update project --name GPSTest --target 4 --path "/home/me/workspace/GPSTest"`)

++然后我进入项目的根目录并使用`ant debug`

我得到这个错误：

```
-build-setup:
[echo] Resolving Build Target for GPSTest...
[gettarget] Project Target:   Google APIs
[gettarget] Vendor:           Google Inc.
[gettarget] Platform Version: 4.2
[gettarget] API level:        17
[echo] ----------
[echo] Creating output directories if needed...
[echo] ----------
[echo] Resolving Dependencies for GPSTest...
[dependency] Library dependencies:
[dependency] 
[dependency] ------------------
[dependency] Ordered libraries:
[echo] ----------
[echo] Building Libraries with 'debug'...

BUILD FAILED
/home/me/android-sdks/tools/ant/build.xml:595: 
Invalid file: /home/me/android-sdks/extras/google/google_play_services/libproject
/google-play-services_lib/build.xml 
```

我不知道这是怎么发生的

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-04-27T00:47:23.977

跑步

```
android update project --path . 
```

在 google_play_services 目录上为我解决了这个确切的问题。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-08T17:21:38.450

尝试在播放服务库上运行 android 更新项目。

除此之外，我会删除 google_play_services 并从 Android SDK 管理器获取新副本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-05-18T13:09:07.827

问题是您没有 build.xml 文件 google-play-services_lib 文件夹

要创建该文件，您需要转到系统 SK 目录

```
$SDK_HOME/extras/google/google_play_services/libproject/google-play-services_lib and run "android update project -p ./ --target 20" 
```

根据需要更改目标。

# javascript - 在页面加载时调用的函数不是 jquery .click

> ID：14777883
> 
> 赞同：4
> 
> 时间：2013-02-08T17:16:52.980
> 
> 标签：javascript, jquery

此函数在页面加载时调用，而不是在单击 .somebutton 时调用。我不确定为什么。我希望能够传递变量，以便可以在多个具有不同值的地方使用此函数。非常感谢。

```
var i = "this be i";
var u = "this be u";

function dosomething (var1, var2){
    console.log(var1 + " and " + var2);
}

$(".somebutton").click(dosomething(i,u)); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T17:17:51.820

您正在将返回的值传递`dosomething(i,u)`给`click`处理程序。这就是为什么它在不点击的情况下执行的原因，它会在你调用你的函数时发生（即：）`dosomething(i,u)`。您需要将函数调用包装在匿名函数中：

```
$(".somebutton").click(function() { dosomething(i,u); } ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:18:23.580

您只能使用示例中的方法（即不带参数）通过引用传递函数。您的函数在加载时工作的原因是因为它会由于尾`()`括号而立即被调用。

如果需要传递参数，则需要将其包装在匿名函数中，如下所示：

```
// on click:
$(".somebutton").click(function() {
    dosomething(i, u);
});

// on page load:
dosomething(i, u); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T17:21:39.550

在 JavaScript 中做

```
$(".somebutton").click(dosomething(i,u)); 
```

不会将该函数分配给您的点击事件，而是会调用该函数并分配该函数返回的任何结果。您需要引用您的函数：

```
$(".somebutton").click(dosomething); 
```

如果您需要将变量传递给您的函数，那么您需要将所述函数包装在另一个匿名函数中：

```
$(".somebutton").click(function() { dosomething(i, u); }); 
```

# git - Git：推送到修改后的存储库

> ID：14777884
> 
> 赞同：0
> 
> 时间：2013-02-08T17:16:53.930
> 
> 标签：git, version-control, github

我正在处理一个从 克隆的项目`gitHub`，但是当我对我的副本进行更改时，有人已经将更改推送到远程仓库。
我现在该怎么办 ？我如何对回购`push`进行更改？`remote`

我是 gitHub 和 git 的新手。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:18:47.527

执行 a`git pull --rebase`从远程 repo 中提取更改。然后，您可以将更改推送到远程存储库，前提是您没有遇到合并冲突。

# c++ - 在 Windows 中，UuidFromString 和 CLSIDFromString 之间有区别吗？

> ID：14777886
> 
> 赞同：1
> 
> 时间：2013-02-08T17:17:06.323
> 
> 标签：c++, windows, guid, uuid, clsid

我只想仔细检查哪一个对于内部生成的与 COM 类无关的 GUID 是正确的。

我怀疑它是 UuidFromString，但我一直看到使用 CLSIDFromString 的代码。我有一个模糊的回忆，CLSIDFromString 可能会枚举注册表中列出的 COM 类，但不确定这是否正确。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-02-26T15:13:16.670

Raymond Chen[回答](https://blogs.msdn.microsoft.com/oldnewthing/20151015-00/?p=91351/)：

`Uuid­From­String`：

> 让我们从 UuidFromString 开始。它采用没有花括号的基本形式的字符串。作为一种特殊情况，如果您传递 NULL 而不是有效的字符串指针，该函数仍然会成功并将结果设置为 GUID_NULL。

`CLSID­From­String`：

> 稍微复杂一点的是 CLSIDFromString。除了接受大括号括起来的字符串（被视为 GUID）外，它还接受 ProgId。在 ProgId 情况下，它返回与该 ProgId 关联的 CLSID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:37:04.683

我会使用`UuidFromString`- 文档`CLSIDFromString`明确指出其目的是将生成的字符串转换`StringFromCLSID`回`CLSID`.

即使这两个函数的行为是相同的（我怀疑它可能不是 - 例如，考虑`CLSIDFromString`可以返回`REGDB_E_CLASSNOTREG`指示类未注册或`REGDB_E_READREGDB`指示注册表 I/O 错误），区分a`CLSID`和你自己的内部`GUID`对象。

# r - 总结数据框

> ID：14777890
> 
> 赞同：2
> 
> 时间：2013-02-08T17:17:25.473
> 
> 标签：r

我正在尝试获取以下数据，然后使用这些数据创建一个表格，其中包含按状态细分的信息。

这是数据：

```
> head(mydf2, 10)
    lead_id buyer_account_id amount state
1  52055267               62    300    CA
2  52055267               64    264    CA
3  52055305               64    152    CA
4  52057682               62     75    NJ
5  52060519               62    750    OR
6  52060519               64    574    OR
15 52065951               64    152    TN
17 52066749               62    600    CO
18 52062751               64    167    OR
20 52071186               64    925    MN 
```

我已经对我感兴趣的状态进行了子集化，并且只有我感兴趣的数据：

```
mydf2 = subset(mydf, state %in% c("NV","AL","OR","CO","TN","SC","MN","NJ","KY","CA")) 
```

这是我正在寻找的想法：

```
State     Amount       Count
NV        1              50  
NV        2              35  
NV        3              20
NV        4              15
AL        1              10 
AL        2              6
AL        3              4
AL        4              1
... 
```

对于每个州，我都试图找到每个数量“级别”的计数。我不需要对数量变量进行分组，但请记住它们不仅仅是 1、2、3 等

```
> mydf$amount
   [1]  300  264  152   75  750  574  113  152  750  152  675  489  188  263  152  152  600  167   34  925  375  156  675  152  488  204  152  152
  [29]  600  489  488   75  152  152  489  222  563  215  452  152  152   75  100  113  152  150  152  150  152  452  150  152  152  225  600  620
  [57]  113  152  150  152  152  152  152  152  152  152  640  236  152  480  152  152  200  152  560  152  240  222  152  152  120  257  152  400 
```

在 R 中是否有一个优雅的解决方案，或者我会被 Excel 卡住（糟糕！）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T17:50:12.640

这是我对您要执行的操作的理解：

从一个简单`data.frame`的 26 个状态开始，数量范围仅从 1 到 50（这比您在示例中的限制要大得多，范围要高得多）。

```
set.seed(1)
mydf <- data.frame(
  state = sample(letters, 500, replace = TRUE),
  amount = sample(1:50, 500, replace = TRUE)
)

head(mydf)
#   state amount
# 1     g     28
# 2     j     35
# 3     o     33
# 4     x     34
# 5     f     24
# 6     x     49 
```

这是一些简单的表格。我还删除了频率为零的所有实例，并且按状态对输出进行了重新排序。

```
temp1 <- data.frame(table(mydf$state, mydf$amount))
temp1 <- temp1[!temp1$Freq == 0, ]
head(temp1[order(temp1$Var1), ])
#      Var1 Var2 Freq
# 79      a    4    1
# 157     a    7    2
# 391     a   16    1
# 417     a   17    1
# 521     a   21    1
# 1041    a   41    1
dim(temp1) # How many rows/cols
# [1] 410   3 
```

这是一个有点不同的表格。我们在对“金额”值进行分组*后进行制表。*在这里，我手动指定了休息时间，但您也可以轻松地让 R 决定它认为最好的方式。

```
temp2 <- data.frame(table(mydf$state, 
                          cut(mydf$amount, 
                              breaks = c(0, 12.5, 25, 37.5, 50), 
                              include.lowest = TRUE)))
temp2 <- temp2[!temp2$Freq == 0, ]
head(temp2[order(temp2$Var1), ])
#    Var1      Var2 Freq
# 1     a  [0,12.5]    3
# 27    a (12.5,25]    3
# 79    a (37.5,50]    3
# 2     b  [0,12.5]    2
# 28    b (12.5,25]    6
# 54    b (25,37.5]    5
dim(temp2)
# [1] 103   3 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T17:33:56.790

我不确定我是否理解正确（你有两个`data.frames` `mydf`and `mydf2`）。我假设你的数据在`mydf`. 使用`aggregate`：

```
mydf$count <- 1:nrow(mydf)
aggregate(data = mydf, count ~ amount + state, length) 
```

这是你想要的？

注意：这里`count`创建的变量只是为了直接获取第 3 列的输出为`count`.

`ddply`from 的替代方案`plyr`：

```
# no need to create a variable called count
ddply(mydf, .(state, amount), summarise, count=length(lead_id)) 
```

在这里，可以使用数据中存在的任何列，而不是`lead_id`. 甚至`state`：

```
ddply(mydf, .(state, amount), summarise, count=length(state)) 
```

或者等效地不使用摘要：

```
ddply(mydf, .(state, amount), function(x) c(count=nrow(x))) 
```

# jquery - jquery 菜单 - 淡入/淡出

> ID：14777892
> 
> 赞同：0
> 
> 时间：2013-02-08T17:17:36.533
> 
> 标签：jquery

我正在使用 jquery 构建一个简单的菜单，并且无法让它在翻转时保持可见。

这是我的jQ：

```
$('.process').hover(function(){
            $('#dropdown').fadeIn(1000);    
        }, function(){
            $('#dropdown').delay(1000).fadeOut();
    });

$('#dropdown').mouseover(function() {
        //Need something here to hold the menu
    });
$('#dropdown').mouseleave(function() {
        $(this).fadeOut();
    }); 
```

上面我需要什么？

这是半工作示例：

[http://jsfiddle.net/kenaesthetic/L25MD/2/](http://jsfiddle.net/kenaesthetic/L25MD/2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:35:03.300

UL#dropdown 应该在包含 .process 的 LI 中，并且 .process 应该在 li 上，而不是在 a 上。这使得#dropdown 成为 li.process 的子项，因此当您在 li.process 中时，悬停不会结束。

我开始修改你的小提琴，但需要一些 CSS 调整才能让它全部工作。

更新（基于您在下面评论中的小提琴）：

[http://jsfiddle.net/L25MD/11/](http://jsfiddle.net/L25MD/11/)

```
$('li.process').hover(function () {
    $('#dropdown').fadeIn(1000);
}, function () {
    $('#dropdown').delay(1000).fadeOut();
}); 
```

# php - jQuery - Ajax - JSON - 简单的联系表格不起作用

> ID：14777898
> 
> 赞同：0
> 
> 时间：2013-02-08T17:17:56.047
> 
> 标签：php, jquery, json, forms

我正在努力适应这种提交表单的方法。我正在尝试使用 JSON 并了解这里发生了什么......但我觉得我错过了一些非常明显的东西......我真的很想让这个工作。谢谢！

这是HTML

```
<div class="span4">
        <div id="formResponse"></div>
        <form id="contactForm" name="contactForm" method="post">
        <div class="controls">
            <input class="span4" type="text" name="name" id="name" placeholder="Name" required />
        </div>
        <div class="controls">
            <input class="span4" type="email" name="email" id="email" placeholder="E-mail" required />
        </div>
        <div class="controls">
            <textarea rows="3" class="span4" name="message" id="message"placeholder="Leave your message at the beep..."></textarea>
        </div>
        <div class="controls">
            <input type="submit" class="btn btn-primary" name="formSubmit" id="formSubmit" value="Send E-Mail" />
        </form>
        </div>          
        </div> 
```

这是jQuery：

```
 <script type="text/javascript">
$(document).ready(function(){

    $('#contactForm').submit(function(){

        $.ajax({
            type: "POST",
            url: "php/contact.php",
            data: $("#contactForm").serialize(),
            dataType: "json",

                success: function(msg){
                $("#formResponse").removeClass('error');
                $("#formResponse").removeClass('success');
                $("#formResponse").addClass(msg.status);
                $("#formResponse").html(msg.message);

            },
            error: function(){
                $("#formResponse").removeClass('success');
                $("#formResponse").addClass('error');
                $("#formResponse").html("There was an error submitting the form. Please try again.");
            }
        });
    });
});
</script> 
```

这是PHP：

```
function checkEmail($email){

if(eregi("^[a-zA-Z0-9_]+@[a-zA-Z0-9\-]+\.[a-zA-Z0-9\-\.]+$]", $email)){
    return FALSE;
}

list($Username, $Domain) = split("@",$email);

if(@getmxrr($Domain, $MXHost)){
    return TRUE;

} else {
    if(@fsockopen($Domain, 25, $errno, $errstr, 30)){
        return TRUE;
    } else {

        return FALSE;
    }
}
}   

$response_array = array();

if(empty($_POST['name'])){

//set the response
$response_array['status'] = 'error';
$response_array['message'] = 'Name is blank';

} elseif(!checkEmail($_POST['email'])) {

//set the response
$response_array['status'] = 'error';
$response_array['message'] = 'Email is blank or invalid';

} elseif(empty($_POST['message'])) {

$response_array['status'] = 'error';
$response_array['message'] = 'Message is blank';

} else {

//send the email
$body = $_POST['name'] . " sent you a message\n";
$body .= "Details:\n\n" . $_POST['message'];
mail($_POST['email'], "SUBJECT LINE", $body);

//set the response
$response_array['status'] = 'success';
$response_array['message'] = 'Email sent!';

}

echo json_encode($response_array); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:35:53.077

您没有指定什么不起作用，但我可以立即看到您没有阻止默认表单提交行为，这是一个问题：

```
$('#contactForm').submit(function (e) {
    e.preventDefault(); 
```

这会阻止表单正常提交，以便使用您的 ajax。我没有看到任何其他不愉快的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T19:23:32.597

您还可以删除 `<input type="submit" class="btn btn-primary" name="formSubmit" id="formSubmit" value="Send E-Mail" />`

并将其替换为 `<input type="button" class="btn btn-primary" name="formSubmit" id="formSubmit" value="Send E-Mail" />`

在您的 jquery 中使用它：-

> $('#formSubmit').click(function(){});

代替：-

> $('#contactForm').submit(function(){});

这将阻止表单的默认发布行为。其次，如果您在 localhost 上运行代码，请确保您已安装邮件服务器，以便使用 php mail() 函数。

# php - PayPal CreateRecurringPaymentProfile 错误 11502 - 令牌无效

> ID：14777899
> 
> 赞同：3
> 
> 时间：2013-02-08T17:17:57.793
> 
> 标签：php, paypal, recurring-billing

我正在使用 PayPal 的 API 设置定期付款。首先，我将以下参数发送到`SetExpressCheckout`：

```
Array
(
    [METHOD] => SetExpressCheckout
    [USER] => XXX
    [PWD] => XXX
    [SIGNATURE] => XXX
    [VERSION] => 98.0
    [AMT] => 0
    [MAXAMT] => 99.00
    [RETURNURL] => http://google.com
    [CANCELURL] => http://google.com
    [L_BILLINGTYPE0] => RecurringPayments
    [L_BILLINGAGREEMENTDESCRIPTION0] => 99.00 per month till stopped
) 
```

这会生成如下响应：

```
Array
(
    [TOKEN] => EC-90P39652RF345525U
    [TIMESTAMP] => 2013-02-08T17:09:24Z
    [ACK] => Success
    [VERSION] => 98.0
) 
```

使用创建的计费协议中的描述和令牌，我将以下参数发送到 CreateRecurringPaymentsProfile：

```
Array
    (
    [METHOD] => CreateRecurringPaymentsProfile
    [USER] => XXX
    [PWD] => XXX
    [SIGNATURE] => XXX
    [TOKEN] => EC-90P39652RF345525U
    [PROFILESTARTDATE] => Feb 22 2013 17:09:24
    [DESC] => 99.00 per month till stopped
    [BILLINGPERIOD] => Month
    [BILLINGFREQUENCY] => 12
    [AMT] => 99.00
    [CURRENTCYCODE] => USD
    [CREDITCARDTYPE] => VISA
    [ACCT] => 1234123412341234
    [EXPDATE] => 012014
    [CVV2] => 123
    [EMAIL] => fake@example.com
    [STREET] => 123 Main St
    [CITY] => New York City
    [STATE] => NY
    [COUNTRYCODE] => US
    [ZIP] => 12345
) 
```

在我看来一切都很好，但它失败了：

```
Array
(
    [TIMESTAMP] => 2013-02-08T17:09:24Z
    [ACK] => Failure
    [VERSION] => 98.0
    [L_ERRORCODE0] => 11502
    [L_SHORTMESSAGE0] => Invalid Token
    [L_LONGMESSAGE0] => The token is invalid
    [L_SEVERITYCODE0] => Error
) 
```

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T17:43:07.170

在调用 CreateRecurringPaymentsProfile 之前，您需要将买家重定向到 PayPal 以批准定期付款。您的两个 API 响应的时间戳是相同的，这告诉我您在收到来自 SetExpressCheckout 的响应后立即调用了 CreateRecurringPaymentsProfile。从 SetExpressCheckout 收到回复后，您需要将买家重定向到 PayPal。

# java - WCF 与服务共享模型

> ID：14777900
> 
> 赞同：0
> 
> 时间：2013-02-08T17:17:58.980
> 
> 标签：java, web-services

我有两个 WCF Web 服务，它们公开了几个 Web 方法。每个 Web 服务中的一些 Web 方法返回相同的模型（我的意思是，相同的类，不同的对象）

当我为两个服务（两个不同的 WSDL）生成客户端代码（Java）时，公共对象生成两次（每个服务一个）。

例如。WCF 服务 1 公开：

```
ObjectTest DoSOmeWork(); 
```

WCF 服务 2 公开：

```
ObjectTest DoSOmeHARDWork(); 
```

在 java 中，我将有两个 ObjectTest，每个服务一个。

有没有办法共享这些对象？有时客户端需要调用这两个服务并重用一些对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:48:32.413

添加或配置服务引用时，您可以选择“重用类型”。然后，您可以指向包含这些类型的程序集。客户端和服务将使用该程序集。

如果您的意思是要在各种 Java 客户端之间共享类，那么您应该查看为这些客户端生成代理的工具的选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:44:07.053

我不认为你可以走 WSDL 路线 - 但是你可以拥有一个公共类库，你可以在你的服务和客户之间共享。

你也可以使用 Automapper 之类的东西。

# maven - 使用 Maven exec 插件指定 javaagent 参数

> ID：14777909
> 
> 赞同：14
> 
> 时间：2013-02-08T17:18:40.000
> 
> 标签：maven, javaagents

我有一个类似的问题：[this previous question](https://stackoverflow.com/questions/1020731/java-agents-with-maven-in-eclipse)

我正在将使用 Netbeans 的 Java 项目转换为 Maven。为了启动程序，我们需要的命令行参数之一是 -javaagent 设置。例如

```
-javaagent:lib/eclipselink.jar 
```

我正在尝试让 Ne​​tbeans 启动应用程序以供开发使用（我们将为最终部署编写自定义启动脚本）

由于我使用 Maven 来管理 Eclipselink 依赖项，因此我可能不知道 Eclipselink jar 文件的确切文件名。根据我在 pom.xml 文件中配置的版本，它可能类似于 eclipselink-2.1.1.jar。

如何配置 exec-maven-plugin 以将确切的 eclipselink 文件名传递给命令行参数？

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>exec-maven-plugin</artifactId>
    <configuration>
       <executable>java</executable>
           <arguments>
               <argument>-Xmx1000m</argument>
               <argument>-javaagent:lib/eclipselink.jar</argument> <==== HELP?
               <argument>-classpath</argument>
               <classpath/>
               <argument>my.App</argument>
           </arguments>
    </configuration>
</plugin> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-08T17:45:23.823

我想出了一个似乎运作良好的方法。

首先，设置[maven-dependency-plugin](http://maven.apache.org/plugins/maven-dependency-plugin/)以始终运行“属性”目标。

```
<plugin>
    <artifactId>maven-dependency-plugin</artifactId>
    <version>2.5.1</version>
    <executions>
        <execution>
            <id>getClasspathFilenames</id>
            <goals>
                <goal>properties</goal>
            </goals>
        </execution>
     </executions>
</plugin> 
```

稍后，使用它设置的属性，[如这里记录](http://maven.apache.org/plugins/maven-dependency-plugin/properties-mojo.html)的形式：

```
groupId:artifactId:type:[classifier] 
```

例如

```
<argument>-javaagent:${mygroup:eclipselink:jar}</argument> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T17:30:16.413

只需为 eclipse 链接版本定义一个属性，并在您的`<dependency>`和 exec 插件中使用该属性：

```
 <properties>
        <eclipselink.version>2.4.0</eclipselink.version>
    </properties>
    <dependency>
        <groupId>org.eclipse.persistence</groupId>
        <artifactId>eclipselink</artifactId>
        <version>${eclipselink.version}</version>
    </dependency>
    ...
    <plugin>
      <groupId>org.codehaus.mojo</groupId>
      <artifactId>exec-maven-plugin</artifactId>
      <configuration>
      <executable>java</executable>
       <arguments>
           <argument>-Xmx1000m</argument>
           <argument>-javaagent:lib/eclipselink-${eclipselink.version}.jar</argument>
           <argument>-classpath</argument>
           <classpath/>
           <argument>my.App</argument>
       </arguments>
     </configuration>
   </plugin> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-28T07:40:19.330

maven-dependency-plugin 和 exec-maven-plugin 应该放在节点下，否则不起作用

# python - 从脚本抓取抓取总是在抓取后阻止脚本执行

> ID：14777910
> 
> 赞同：20
> 
> 时间：2013-02-08T17:18:45.967
> 
> 标签：python, twisted, scrapy

我正在按照本指南[http://doc.scrapy.org/en/0.16/topics/practices.html#run-scrapy-from-a-script](http://doc.scrapy.org/en/0.16/topics/practices.html#run-scrapy-from-a-script)从我的脚本运行 scrapy。这是我的脚本的一部分：

```
 crawler = Crawler(Settings(settings))
    crawler.configure()
    spider = crawler.spiders.create(spider_name)
    crawler.crawl(spider)
    crawler.start()
    log.start()
    reactor.run()
    print "It can't be printed out!" 
```

它应该起作用：访问页面，抓取所需的信息并将输出 json 存储在我告诉它的位置（通过 FEED_URI）。但是当蜘蛛完成他的工作时（我可以通过输出 json 中的数字看到它）我的脚本的执行不会恢复。可能不是scrapy问题。答案应该在扭曲的反应堆的某个地方。我怎样才能释放线程执行？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-10T20:59:35.120

当蜘蛛完成时，您需要停止反应器。您可以通过侦听`spider_closed`信号来完成此操作：

```
from twisted.internet import reactor

from scrapy import log, signals
from scrapy.crawler import Crawler
from scrapy.settings import Settings
from scrapy.xlib.pydispatch import dispatcher

from testspiders.spiders.followall import FollowAllSpider

def stop_reactor():
    reactor.stop()

dispatcher.connect(stop_reactor, signal=signals.spider_closed)
spider = FollowAllSpider(domain='scrapinghub.com')
crawler = Crawler(Settings())
crawler.configure()
crawler.crawl(spider)
crawler.start()
log.start()
log.msg('Running reactor...')
reactor.run()  # the script will block here until the spider is closed
log.msg('Reactor stopped.') 
```

命令行日志输出可能类似于：

```
stav@maia:/srv/scrapy/testspiders$ ./api
2013-02-10 14:49:38-0600 [scrapy] INFO: Running reactor...
2013-02-10 14:49:47-0600 [followall] INFO: Closing spider (finished)
2013-02-10 14:49:47-0600 [followall] INFO: Dumping Scrapy stats:
    {'downloader/request_bytes': 23934,...}
2013-02-10 14:49:47-0600 [followall] INFO: Spider closed (finished)
2013-02-10 14:49:47-0600 [scrapy] INFO: Reactor stopped.
stav@maia:/srv/scrapy/testspiders$ 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-09-27T21:39:34.113

在scrapy 0.19.x 中你应该这样做：

```
from twisted.internet import reactor
from scrapy.crawler import Crawler
from scrapy import log, signals
from testspiders.spiders.followall import FollowAllSpider
from scrapy.utils.project import get_project_settings

spider = FollowAllSpider(domain='scrapinghub.com')
settings = get_project_settings()
crawler = Crawler(settings)
crawler.signals.connect(reactor.stop, signal=signals.spider_closed)
crawler.configure()
crawler.crawl(spider)
crawler.start()
log.start()
reactor.run() # the script will block here until the spider_closed signal was sent 
```

注意这些行

```
settings = get_project_settings()
crawler = Crawler(settings) 
```

没有它，您的蜘蛛将不会使用您的设置，也不会保存项目。我花了一段时间才弄清楚为什么文档中的示例没有保存我的项目。我发送了一个拉取请求来修复文档示例。

另一种方法是直接从您的脚本调用命令

```
from scrapy import cmdline
cmdline.execute("scrapy crawl followall".split())  #followall is the spider's name 
```

# symfony - Symfony2 模板/布局

> ID：14777914
> 
> 赞同：1
> 
> 时间：2013-02-08T17:18:52.347
> 
> 标签：symfony

我是 symfony2 的新手，所以如果这是一个愚蠢的问题，请原谅我。

Symfony2 以捆绑的形式组织——所以一切都是捆绑的，对吧？

基于此，我创建了以下捆绑包，以便拥有一个简单的登录机制：

*   应用程序
    *   主包将包含所有全局功能
*   用户
    *   将用于代表用户

所以捆绑包工作正常，一切都很好。

现在我想不出向网站添加布局/主题结构的最佳方法。

我显然需要一些全局资源，例如页眉、导航和页脚。但除此之外，还需要一些全局 css 样式表、jquery 等。

最明显的地方包是应用程序 - 但我如何让所有其他包继承这个包的主题。例如，用户包模板需要扩展 App 包等。

捆绑包的想法是它们是模块化和自包含的，因此如何实现

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:34:10.507

我个人是这样使用的：

有 MainBundle（在你的情况下是 App），它提供全局服务、树枝扩展和布局。全局资产包含在此文件中。

所有其他包的主布局扩展了 MainBundle 的布局。每个捆绑包中的模板都扩展到它的主布局，从而扩展了 MainBundle 的布局。例如，

```
- MainBundle
    - views
         - layout.html.twig
- UserBundle
    - views
         - layout.html.twig (extends to MainBundle/layout)
         - show.html.twig (extends to UserBundle/layout)
         - friends.html.twig (extends to UserBundle/layout) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-22T12:20:06.830

一切都在官方文档中解释： http: [//symfony.com/doc/current/templating.html](http://symfony.com/doc/current/templating.html)

基本的全局视图（模板）资源放置在以下目录中：

```
app/Resources/views/index.html.twig 
```

如果您有特定目的或捆绑、模板，请将它们放在子目录中，例如：

```
app/Resources/views/blog/index.html.twig 
```

如果您想将所有内容保留在捆绑包中（对于可重用代码必须），请使用以下约定：

```
[VendorName/]YourBundle/Resources/views/Blog/index.html.twig 
```

（当然，除 Twig 的“.html.twig”扩展名外，任何名称都可以更改为您喜欢的名称）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T18:46:34.620

我更喜欢的策略是将我的应用程序组织在一个包中。如果您不打算在多个应用程序中重复使用不同的独立功能，那么这是最合适的方式。在您自己的应用程序命名空间中拥有“UserBundle”可能没有意义。您添加了许多对您没有任何好处的额外结构。考虑一下：

```
- MainBundle
    - Controller
        - UserController
        - OtherController
    - Resources
        - views
            - layout.html.twig
            - User
                - show.html.twig
                - update.html.twig
                - friends.html.twig
            - Other
                - some_other_view.html.twig 
```

在这种情况下，控制器目录下的模板将扩展`MainBundle::layout.html.twig`.

# node.js - 如何在没有对文件的写访问权限的情况下将可能包含它自己的异步调用的方法归入？

> ID：14777916
> 
> 赞同：3
> 
> 时间：2013-02-08T17:18:57.433
> 
> 标签：node.js, asynchronous

我有一组文件，module1.js、module2.js、module3.js，每个文件都包含一个返回对象，该对象具有将被执行的属性方法。检查对象以动态确定属性名称，我可以`.toString()`使用方法。

内部方法几乎肯定会包含异步调用，如下所示：

```
function doSomething(vars){
  var that = this,
      red = 'blue',
      up = 'down',
      one = 2;

   makeAsync(that,red,up,one,function(err,res){
      return makeDeep(res);
   }
} 
```

如何从调用父方法中编组这些方法以最终返回值，而无需主动对文件 module1.js、module2.js 和 module3.js 进行可写访问。假设这些都是一成不变的，永远无法编辑。任何其他合理的东西都是公平的游戏。只是请不要说“好吧，重写 doSomething 以传入 CB 并让其`makeDeep`被包裹在 CB 中”。请注意，我是从我自己的代码中调用此模块，并注意这`makeAsync`是模块作者想要调用的任何异步方法。

* * *

**重要说明：**我是一个写`makeDeep`作者，我是一个包含模块的人，所以我可以在这两个地方做任何你想做的事情，并且`makeDeep`动态注入模块（我正在做一个混合模式）所以如果你的解决方案依赖于修改`makeDeep`工作或“父”调用方法中的某些东西，这是 100% 合理的，我就是这样。

如果是这种情况，则没有“需要”在`return`之前使用关键字，`makeDeep`但如果语法确实使用了这些词，则可以加分（这在很大程度上向开发人员表明这是一个代码出口点，是吗？）

* * *

假设 module1.js 看起来像：

```
module.exports = function() {
    this.doSomething11 = function doSomething(vars){
      var that = this,
          red = 'blue',
          up = 'down',
          one = 2;

       makeAsync(that,red,up,one,function(err,res){
          return makeDeep(res);
       }
    }
} 
```

模块2.js

```
module.exports = function() {
    this.doSomething21 = function doSomething(vars){
      var that = this,
          red = 'blue',
          up = 'down',
          one = 2;

       makeAsync(that,red,up,one,function(err,res){
          return makeDeep(res);
       }
    };

    this.doSomething22 = function doSomething(vars){
      var that = this,
          red = 'blue',
          up = 'down',
          one = 2;

       makeAsync(that,red,up,one,function(err,res){
          return makeDeep(res);
       }
    };
} 
```

模块3.js

```
module.exports = function() {
    this.doSomething31 = function doSomething(vars){
      var that = this,
          red = 'blue',
          up = 'down',
          one = 2;

       makeAsync(that,red,up,one,function(err,res){
          return makeDeep(res);
       }
    };

    this.doSomething32 = function doSomething(vars){
      var that = this,
          red = 'blue',
          up = 'down',
          one = 2;

       makeAsync(that,red,up,one,function(err,res){
          return makeDeep(res);
       }
    };

    this.doSomething33 = function doSomething(vars){
      var that = this,
          red = 'blue',
          up = 'down',
          one = 2;

       makeAsync(that,red,up,one,function(err,res){
          return makeDeep(res);
       }
    }
} 
```

是的，这些例子是人为的，因为我更关注概念而不是实际细节。它们可以是三重嵌套的回调，或者可以使用某种内部回调。大多数情况下，我只是想知道是否有办法做到这一点。

如果没有，如果我为用户提供一个特定的库并让他们返回到库中，我怎样才能让它为用户工作？

我的目标是最终复制类似于 ASP.NET 样式 ActionResult 的东西，并且我对使用 Q、fiber 或 Promise 的想法持开放态度，但我在调用时遗漏了一些东西，以便在异步回调时将其取回用来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T09:24:01.650

我会解决你的问题，它只需要调用所需的模块`return that.makeDeep()`而不是`return makeDeep()`. 我知道您不想更改被调用的代码，但是，您可以随时使用[burrito](https://github.com/substack/node-burrito)并动态更改这些行（无需写入访问权限）。

**调用代码**

```
var Controller = require('./module1');
assert(typeof Controller == 'function');

httpServer.on('request', function(req, res) {
    // I assume this is something you would do
    var vars = processReqParameters(req);
    var action = vars.action;
    var controller = new Controller();

    if(typeof controller[action] === 'function') {
        // now I assume that makeDeep will at one point
        // call res.end();
        var makeDeep = createMakeDeep(req, res, vars) // or other parameters

        // this is how we inject makeDeep in the controller
        var controllerInstance = Object.create(controller, {makeDeep: makeDeep});
        return controllerInstance[action](vars);
    }
    else {
        res.writeHead(404, 'Controller Not Found');
        res.end('Too bad\n');
    }
}) 
```

**调用代码**

```
module.exports = function() {
    this.myAction = function(vars)  {
        var that = this,
            red = 'blue',
            up = 'down',
            one = 2;

        makeAsync(that, red, up, one, function(err, res) {
            return that.makeDeep(res);
        })
    }
} 
```

# php - php中丢失的var

> ID：14777919
> 
> 赞同：0
> 
> 时间：2013-02-08T17:19:00.197
> 
> 标签：php, yii

我对 PHP 和 Yii 还很陌生，而且我不是也不是 google 中的问题，所以我唯一能想到的就是向这个列表提出问题，我已经解决了很多问题。

**问题如下**：在我附加的代码中，我读取了我保存在数组中的几条记录，并且在处理之后。

好吧，如果您首先查看他的 foreach 中的调试条目，一切顺利并且变量`$items`已加载，但是当我到达第二个调试`$items`变量时，元素的数量正确，但元素为空：`count ($items) = 2`但是`$items[0]`并且`$items[1]`是`null`

```
$idiomas=CListaMidiomas::model()->findAll();
$items=array();
$nombre=array();
$a=0;
foreach ($idiomas as $idioma){
    $nombre[$a]=$idioma->sIdioma;
$items[$a]=TblCategoriastexto::model()->findAll(
        array('condition'=>'id='.$data->id.' AND idIdioma='.$idioma->id_idioma));
echo "<br>---AAAAAAAAAAA--".$a."-----------<br>";
CVarDumper::dump($items); //in this moment is correct
if (empty($items[$a]) ||$items[$a]==null ){ // not enter because $items have content
    $items[$a]=new TblCategoriastexto();
    $items[$a]->idIdioma=$idioma->id_idioma;
}
$a++;
}
echo ">>>>>>>>>>>>>>>".count($items) ; //<<<<<<<<<<present 2
CVarDumper::dump($items);              // but in this moment t0 2 are null

for ($a=0;$a<count($items) ;$a++){
echo "<b>".CHtml::encode($nombre[$a]).":</b>";
$out="";
$item=$items[$a];
echo "<br>-----".$a."-----------<br>";
CVarDumper::dump($items[$a]);<<<<<<<<<<<<<<<<<<<<<<<<null
for ($b=1;$b<=20;$b++){
    $campo="tc".$b;
    $out.=$items[$a]->$campo . ",";<<<<<<<<<<<<<<<<error
}
echo CHtml::encode($out);
echo"<br>";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T18:28:36.287

尝试更改此行：

```
if(isset($items[$a]->$campo)) {
    $out.=$items[$a]->$campo . ",";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T06:08:47.603

此行：`if (empty($items[$a]) ||$items[$a]=null ){`将始终分配`$items[$a]`给`null`.

要比较值，请使用比较（用于相等）运算符，`==`而不是赋值运算符`=`。

# angularjs - 将焦点更改为 AngularJS 中关键事件的输入

> ID：14777923
> 
> 赞同：10
> 
> 时间：2013-02-08T17:19:10.607
> 
> 标签：angularjs

测试用例： http: [//jsbin.com/ahugeg/4/edit](http://jsbin.com/ahugeg/4/edit)（略长）

在上面的测试用例中，我有三个输入元素，由`ng-repeat`指令生成。我在这个测试用例中的意图是，如果在该方向上有可用输入，则在其中一个输入中点击向上/向下箭头应将焦点移至相应方向的输入。

我是 AngularJS 的新手，所以我可能会错过一些直接的方法来做到这一点。无论如何，我定义了两个新指令（`on-up`and `on-down`）来处理 up 和 down 事件，并调用`$scope.focusNext`and`$scope.focusPrev`方法，传递正确的条目，相对于焦点应该移动的条目。这就是我卡住的地方。

我知道这不是在控制器中处理 DOM 元素的*角度方式，但我看不出如何将**焦点*视为模型的属性/属性。我什至想过有一个单独的`$scope.focusedEntry`，但是我应该*注意*那个属性的变化吗？即使我这样做并且我检测到更改，我如何访问与我想要关注的条目对应的输入元素？

非常感谢有关如何完成此操作的任何帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-09T00:35:55.163

我只是把它写下来并简单地测试了它——它可以做你想做的事情，而不会在你的控制器和 HTML 中产生所有额外的混乱。看到它在[这里](http://jsbin.com/ahugeg/9/edit)工作。

HTML：

```
<body ng-controller="Ctrl">
    <input ng-repeat="entry in entries" value="{{entry}}" key-focus />
</body> 
```

控制器：

```
function Ctrl($scope) {
  $scope.entries = [ 'apple', 'ball', 'cow' ];
} 
```

指示：

```
app.directive('keyFocus', function() {
  return {
    restrict: 'A',
    link: function(scope, elem, attrs) {
      elem.bind('keyup', function (e) {
        // up arrow
        if (e.keyCode == 38) {
          if(!scope.$first) {
            elem[0].previousElementSibling.focus();
          }
        }
        // down arrow
        else if (e.keyCode == 40) {
          if(!scope.$last) {
            elem[0].nextElementSibling.focus();
          }
        }
      });
    }
  };
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-08T23:49:01.093

我遇到了类似的问题并使用了这个简单的指令。它作为 ng-show 和 ng-hide 工作 - 只有当它的属性解析为 true 时才会有焦点：

```
.directive('focusOn',function() {
    return {
        restrict : 'A', 
        link : function($scope,$element,$attr) {
            $scope.$watch($attr.focusOn,function(focusVal) {
                if(focusVal === true) {
                    setTimeout(function() {
                        $element.focus();
                    },50);
                }
            });
        }
    }
}) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-09T05:45:57.193

受@Trevor 解决方案的启发，这就是我所决定的，

```
app.directive('focusIter', function () {

    return function (scope, elem, attrs) {
        var atomSelector = attrs.focusIter;

        elem.on('keyup', atomSelector, function (e) {
            var atoms = elem.find(atomSelector),
                toAtom = null;

            for (var i = atoms.length - 1; i >= 0; i--) {
                if (atoms[i] === e.target) {
                    if (e.keyCode === 38) {
                        toAtom = atoms[i - 1];
                    } else if (e.keyCode === 40) {
                        toAtom = atoms[i + 1];
                    }
                    break;
                }
            }

            if (toAtom) toAtom.focus();

        });

        elem.on('keydown', atomSelector, function (e) {
            if (e.keyCode === 38 || e.keyCode === 40)
                e.preventDefault();
        });

    };
}); 
```

这定义了`focus-iter`要在所有重复输入的父元素上设置的属性。在此处查看此操作：http: [//jsbin.com/ahugeg/10/](http://jsbin.com/ahugeg/10/)。

@Trevor 的优势在于我可以为`focus-iter`属性值设置任意选择器，以准确指定焦点跳转应该使用的元素。作为一个疯狂的例子，尝试将`focus-iter`属性设置为`input:even`:)。这很有帮助，因为在我的应用程序中`input`，与测试用例不同，s 在它们周围带有相当多的额外标记。

# java - java如何制作带有垂直文本的JLabel？

> ID：14777926
> 
> 赞同：4
> 
> 时间：2013-02-08T17:19:22.847
> 
> 标签：java, jlabel

我需要做一个垂直的`JLabel`- 一个垂直`JLabel`显示它的文本 - 我搜索了谷歌，但我没有找到一个好的答案。怎么做？

![在此处输入图像描述](../Images/c4ad15f6181989346ac3550e1aba6d43.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T17:25:47.897

您可以使用开发人员创建的 VerticalLabelUI 类：http: [//tech.chitgoks.com/2009/11/13/rotate-jlabel-vertically/](http://tech.chitgoks.com/2009/11/13/rotate-jlabel-vertically/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T17:46:15.287

您可以创建一个方法，将您的文本转换为如下`HTML`代码：

```
public static String transformStringToHtml(String strToTransform) {
    String ans = "<html>";
    String br = "<br>";
    String[] lettersArr = strToTransform.split("");
    for (String letter : lettersArr) {
        ans += letter + br;
    }
    ans += "</html>";
    return ans;
} 
```

之后，如果您将在这样的方法中使用此方法`setText`：您将`someLabel.setText(transformStringToHtml(someString));`在哪里`someString = "Test"`收到：

```
T
e
s
t 
```

在你的标签中。

# ruby-on-rails-3 - 设计不退出

> ID：14777930
> 
> 赞同：1
> 
> 时间：2013-02-08T17:19:49.440
> 
> 标签：ruby-on-rails-3, devise

我有一个注销链接。

```
<a href="http://mydomain.lvh.me:3000/users/sign_out" data-method="delete" rel="nofollow">
    Sign Out
</a> 
```

正确执行注销操作：

```
Started DELETE "/users/sign_out" for 127.0.0.1 at 2013-02-08 15:04:06 -0200
Processing by DeviseCustom::SessionsController#destroy as HTML
  Parameters: {"authenticity_token"=>"WYMm9e4VMNgdDFXbl59TKyylhX+rZlWbWMF8lVEeves="}
  User Load (0.2ms)  SELECT `users`.* FROM `users` WHERE `users`.`id` = 150 LIMIT 1
   (0.1ms)  BEGIN
   (0.2ms)  COMMIT
Redirected to http://mydomain.lvh.me:3000/
Completed 302 Found in 4ms (ActiveRecord: 0.5ms) 
```

我正在自定义 SessionsController 但我没有重新定义销毁操作。

```
class DeviseCustom::SessionsController < Devise::SessionsController
  respond_to :html, :js
  layout :false
  def create
    <MYCUSTOMCONTENT>
  end
end 
```

但是在做完这一切之后，current_user 仍然保存着登录用户的信息。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:44:45.160

确保您已在布局中包含默认的 javascript 文件。应该有这样一行：

```
<%= javascript_include_tag :defaults %> 
```

在您的布局中。

需要通过 GET 注销然后将其添加到您的

## 配置/初始化程序/devise.rb：

```
config.sign_out_via = :get 
```

# objective-c - 将带有自定义单元格的行插入表格视图

> ID：14777935
> 
> 赞同：0
> 
> 时间：2013-02-08T17:20:08.767
> 
> 标签：objective-c, uitableview

在我`tableView`的表格中始终存在五行，当我点击其中之一时，新的三行将出现在所点击的行下方。

如果前五行是默认值`UITableViewCell`，我希望这三个单元格也来自另一个自定义单元格；所以主要的五个单元格将不同于辅助行（主单元格下的三个）。

这是我添加辅助行的方法：

在`tableView`委托中`didSelectRowAtIndexPath`：

```
NSInteger count = indexPath.row + 1;
NSMutableArray *newRows = [NSMutableArray array];//

   self.expandedIndex = indexPath.row + 1;
   self.tableExpanded = YES;

   for(int i = 0; i < [self.numbers count]; i++)
   {
        NSIndexPath *path = [NSIndexPath indexPathForRow:count inSection:0];
        [newRows addObject:path];
        [self.myArray insertObject:[self.numbers objectAtIndex:i] atIndex:count];
        count++;
   }

     [tableView insertRowsAtIndexPaths:newRows withRowAnimation:UITableViewRowAnimationTop]; 
```

添加的行，但我希望它们来自我要创建的自定义单元格，任何想法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:27:23.877

这就是我会做的。我会创建`newRows`一个属性，然后在结束时`didSelectRowAt...`调用表刷新。然后在我的`cellForRowAtIndexPath`检查中查看特定的 indexPath 是否在`newRows`，如果它使用不同的单元格样式：

```
- (UITableViewCell *)tableView:(UITableView *)tableView 
         cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    UITableViewCell *cell;

    if ([self.newRows contains:indexPath]) {
        // create custom cell
    } else {
        // create normal cell
    }

    return cell;
} 
```

如果这没有意义，请告诉我，我可以详细说明。

另请注意，您将需要处理一些有趣的边缘情况。例如，如果用户单击第 3 个单元格并将新单元格插入到第 4-6 行，然后他们单击第 2 个单元格，在第 3-5 行添加新单元格，那么之前的 4-6 个单元格现在将位于第 7-9 行。我不确定你是如何构建你的应用程序的，所以这可能不是问题（比如可能在五个单元格中的一个上一次可以添加子单元格），但只是意识到这是一种可能性。

# flash - 找到AABB的原始宽度和高度

> ID：14777936
> 
> 赞同：0
> 
> 时间：2013-02-08T17:20:09.427
> 
> 标签：flash, collision-detection, aabb

我有一个旋转的矩形，我不知道它的原始宽度和高度。由于当前的宽度和高度只是封装矩形的边界框，我如何找到实际的宽度和高度？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:36:34.673

您可以使用 DisplayObject 的[getBounds()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObject.html#getBounds%28%29) / [getRect()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObject.html#getRect%28%29)并将显示对象本身作为参数传递。例如，如果`yourClip`旋转，你试试这个：

`trace(yourClip.getBounds(yourClip));`.

它应该非常接近原始尺寸。假设您使用的是显示对象（Sprites、MovieClips 等），则此方法有效。不确定它是否有帮助，但[Mike Chambers 的碰撞检测文章](http://www.mikechambers.com/blog/2009/06/24/using-bitmapdata-hittest-for-collision-detection/)非常好。

在评论中你提到了“矩形”。那会是[flash.geom.Rectangle](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/geom/Rectangle.html)吗？如果您更喜欢仅使用几何类，我想您可以使用[flash.geom.Matrix](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/geom/Matrix.html)实例来跟踪坐标系。[使用 Matrix 的transformPoint() 变换](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/geom/Matrix.html#transformPoint%28%29)矩形的角点应该很简单。此外，您可以再次使用矩阵在坐标系之间来回移动（以及[反转](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/geom/Matrix.html#invert%28%29)版本）。DisplayObject 类仍然提供了很多方便的函数，因此您不需要自己进行矩阵数学运算。

# php - drupal 7 中关于字段值的 if/then 语句

> ID：14777939
> 
> 赞同：0
> 
> 时间：2013-02-08T17:20:14.497
> 
> 标签：php, drupal, if-statement, drupal-7, drupal-theming

我正在尝试编写一个语句来查看布尔字段 (field_solo) 中的值并返回我在 Drupal 7 中创建的两个模板文件之一。

我的字段“field_solo”正确输出值 0 或 1，并且我已清除缓存。

有人可以告诉我我这样做是否正确吗？现在，当语句为 TRUE 时，我无法显示它。

```
function motg_preprocess_node(&$vars) {

$node = $vars['node'];
  if($node->field_solo[0]['value'] == 1)
  {
       $vars['theme_hook_suggestion'] = 'node__solo';
  } else
  {
       $vars['theme_hook_suggestion'] = 'node__video';
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:22:35.477

代替

```
if($node->field_solo[0]['value'] == 1) 
```

做了

```
if($node->field_solo['und'][0]['value'] == 1)
// OR
if($node->field_solo[LANGUAGE_NONE][0]['value'] == 1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:25:58.077

看看这个可能会有所帮助： http: [//www.computerminds.co.uk/articles/rendering-drupal-7-fields-right-way](http://www.computerminds.co.uk/articles/rendering-drupal-7-fields-right-way)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-07-17T16:49:59.020

这对我有用

```
<?php if ($content["field_hide_title"]["#items"][0]["value"] == 0) { ?>
<?php echo $node->title; ?></h2>
<?php } ?> 
```

# iphone - 将 JSON 嵌套到核心数据和 ObjectForKey 错误

> ID：14777944
> 
> 赞同：-3
> 
> 时间：2013-02-08T17:20:42.533
> 
> 标签：iphone, objective-c, json, core-data

我有 2 个问题：我需要从下面的 JSON 中获取“元素”和“类别”到我的核心数据持久存储/数据库中，我尝试了以下（下面的代码），但我对是否我感到困惑和困惑做对了吗？

当我尝试使用嵌套的 objectForKey 获取元素数组时，我也会遇到错误，为什么以及如何修复它？

错误，我不明白，因为 Elements 是一个数组？

```
 reason: '-[__NSCFArray objectForKey:]: unrecognized selector sent to instance 0x1cd2f4a0' 
```

我收到带有 AFNetworking 的 JSON，如下所示：

```
 [[MyAPIClient sharedClient] getPath:domain parameters:nil success:^(AFHTTPRequestOperation *operation, id JSON) {

//IS THIS THE RIGHT WAY TO PROCESS NESTED JSON DATA IN CORE DATA? 

            NSError *error;
            NSDictionary *jsonDict = [NSJSONSerialization JSONObjectWithData:JSON options:0 error:&error];

            NSArray *arrayOfCategoriDictionaries = (NSArray *)[[jsonDict objectForKey:@"Manifacture"] objectForKey:@"Categori"];

        //Categori array to Core data
            for( NSDictionary *d  in arrayOfCategoriDictionaries) {
               Categori *cat = [NSEntityDescription insertNewObjectForEntityForName:@"Categori" inManagedObjectContext:_managedObjectContext];

            }

    //Elements to core data, get an error with objectForKey:@"Elements" ?         

            NSArray *arrayOfElementsDictionaries = [[[jsonDict objectForKey:@"Manifacture"] objectForKey:@"Categori"] objectForKey:@"Elements"];

            for(NSDictionary *d1 in arrayOfRetDictionaries) {
                Elements *elements = [NSEntityDescription insertNewObjectForEntityForName:@"Elements" inManagedObjectContext:_managedObjectContext];

            }

        } failure:^(AFHTTPRequestOperation *operation, NSError *error) {

            if (![_managedObjectContext save:&error]) {
                NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
            }

        }]; 
```

嵌套的 json 数据：

```
 {
  "Manifacture": {
    "Categori": [
      {
        "Elements": [
          {
            "Id": 1,
            "Name": "Door",
            "Description": "Black door with window",
            "Price": 149,
            "CategoriId": 1
          }
        ],
        "Id": 1,
        "Name": "Forret",
        "ElementsId": 1,
        "Manifacture_Id": 1
      }
    ],
    "CarSet": [],
    "Id": 1,
    "Name": "Hummer",
    "Description": "A big car"
  },
  "Id": 2,
  "Name": "Hummer Car Factory",
  "Contactperson": "Adil Bujas",
  "Location": "California",
  "Info": "Hummer LTD",
  "SearchThumbnail": "none",
  "CarPicture": "none",
  "Doors": 5,
  "webpages_MembershipUserId": 4,
  "Manifacture_Id": 1
} 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T18:01:17.693

我不确定`NSJSONSerialization`. 我已经看到某些 JSON 类返回只有**1 个**对象的数组，作为该对象本身。

它应该让你更容易，但它通常会让你更难，因为你期望一个带有 1 个对象的 NSArray，但你得到的是数组第一个对象的 NSDictionary。

如果你这样做会发生什么：

```
NSLog(@"%@", [[[jsonDict objectForKey:@"Manifacture"] objectForKey:@"Categori"] objectForKey:@"Elements"] class]); 
```

编辑：

啊，如果你仔细看看你的 JSON，你会注意到键`Categori`也包含一个 NSArray，但你把它当作它包含一个字典。那可能就是您发生错误的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T20:47:18.453

尝试删除演员并拆分语句以隔离任何问题：

```
NSDictionary *manifactureDict = [jsonDict objectForKey:@"Manifacture"];
NSArray *arrayOfCategoriDictionaries = [manifactureDict objectForKey:@"Categori"]; 
```

或者尝试将内部对象转换为字典：

```
NSArray *arrayOfCategoriDictionaries = [(NSDictionary*)[jsonDict objectForKey:@"Manifacture"] objectForKey:@"Categori"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T10:43:37.277

自己找到了解决方案。

```
NSDictionary *jsonDict = [NSJSONSerialization JSONObjectWithData:JSON options:0 error:&error];

        NSDictionary *theDict = [jsonDict objectForKey:@"Manifacture"];

            NSArray *categoriArray = [theDict objectForKey:@"Categori"];

            for (NSDictionary *aDictionary in categoriArray) {
            NSDictionary *arrayOfElementsDictionaries = [aDictionary objectForKey:@"Elements"];

    } 
```

无论如何，谢谢你的帮助。

# jquery - JQuery - 弹出以出现在父跨度上

> ID：14777947
> 
> 赞同：1
> 
> 时间：2013-02-08T17:20:46.947
> 
> 标签：jquery, css

全部-

我开始创建自己的自定义“弹出窗口”，它基本上出现在父跨度上，直到输入数据，然后一旦你点击保存它就会关闭（就像大多数弹出窗口一样）。这就是我正在做的事情：

```
o.click(function(e)
{
    var editor = $(this).find(".object_editor");

    // we want to display it over our parent
    var offset = $(this).parent().offset();
    editor.css('left',offset.left);    
    editor.css('top',offset.top);

    editor.css('visibility', 'visible');
}); 
```

与其推出我自己的解决方案，不如我应该使用已经存在的东西？像 boxy 或 qTip。我还没有找到设置这些解决方案出现的窗口位置的能力。

谢谢！〜乔什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:24:32.540

[http://twitter.github.com/bootstrap/javascript.html#popovers](http://twitter.github.com/bootstrap/javascript.html#popovers)

“在任何元素上添加小的内容覆盖，如 iPad 上的内容，以容纳辅助信息。将鼠标悬停在按钮上以触发弹出窗口。需要包含工具提示。”

# android - Sencha Touch 2.1 本机（android）应用程序没有从远程获取 json（它适用于 PC）

> ID：14777948
> 
> 赞同：2
> 
> 时间：2013-02-08T17:20:49.143
> 
> 标签：android, json, proxy, sencha-touch, touch

我通过观看此视频 ( [http://youtu.be/5F7Gx0-W-M4](http://youtu.be/5F7Gx0-W-M4) ) 创建了我的第一个 Sencha touch 2 应用程序，它的商店页面结构如下：

```
Ext.define('FirstApp.store.Places',{
    extend:'Ext.data.Store',

    config:{

        autoLoad:true,
        model:'FirstApp.model.Place',
        proxy:{
            type:'ajax',
            url:'https://maps.googleapis.com/maps/api/place/search/json?location=-33.8670522,151.1957362&radius=500&types=food&name=harbour&sensor=false&key=AIzaSyCFWZSKDslql5GZR0OJlVcgoQJP1UKgZ5U',
            reader:{
                type:'json',
                rootProperty:'results'
            }
        }
    }
}) 
```

after-build（在运行“sencha app build native”之后）包在我的 MAC（所有浏览器）上运行良好，但生成的应用程序（我在我的 nexus 手机上运行它）工作但不从谷歌收集任何数据映射 json。任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T18:30:33.983

您所指的示例是使用谷歌地图的地点搜索 API。当您为手机构建应用程序时，您不能使用此 API 并`proxy`设置为`ajax`。基本上，您不能使用域外的任何资源。就像如果您的站点位于**yourdomain.com**并且存在**someotherdomain.com**，那么您不能从**yourdomain.com向 this** **someotherdomain.com**发出 ajax 请求，除非该域允许您这样做。在这种情况下，您的移动应用程序没有任何域。您只是在 webview 中加载一个页面。

 **原因是，ajax 将无法加载跨域资源。应用程序构建适用于浏览器，因为我相信您使用的是带有`--disable-web-security`标志的 chrome。要使用 CORS，您需要使用 JsonP 代理。如果您要为移动应用程序打包，这是唯一的方法。如果在某种情况下，您拥有服务器（但不在此上下文中），那么您可以通过设置适当的标头来允许 CORS，例如

```
Access-Control-Allow-Origin: * 
```

或者

```
Access-Control-Allow-Origin: http://yourdomain.com/resource 
```

尝试将代理设置为 JsonP 。**

# sql - 关于总和表总 sql codeigniter 的问题

> ID：14777949
> 
> 赞同：0
> 
> 时间：2013-02-08T17:20:51.470
> 
> 标签：sql, codeigniter

当我想按 id 计算列的总和时，我遇到了一个小问题。

餐桌产品

```
id   code    name        price  quantity
522  123     Product 1     12      4 
```

表 purchase_items

```
id  product_id  quantity
1      522            5
2      522            1 
```

表 sale_items

```
id  product_id  quantity
1      522            1
2      522            1 
```

功能代码点火器：

```
$products = $this->alerts->select('products.id as productid, products.code as code, products.name, products.price, sum(sale_items.quantity)')
      ->from('products');
      $this->alerts->join('sale_items', 'products.id = sale_items.product_id');           
      $this->alerts->group_by("products.id");

      $products = $this->alerts->select('products.id as productid, products.code as code, products.name, products.price, sum(purchase_items.quantity)')
      ->from('products');
      $this->alerts->join('purchase_items', 'products.id = purchase_items.product_id');           
      $this->alerts->group_by("products.id");

        $this->alerts->unset_column('productid');

        foreach ($this->result_array() as $product)
        {
            $products[] = $product['record'];
        }

        return $products;
    } 
```

问题是结果

```
purchase_items the result is 12
sale_items      the result is 4 
```

为什么要取结果 x 2 ？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T18:26:21.727

因为您通过项目主数据（产品表）将采购活动加入到销售活动中。因此，总和中包含的采购行数取决于您拥有的销售行数；反之亦然。

您需要将这些查询分离为在视图中组合的单独 SQL 语句，或者您可以使用 SQL`UNION ALL`组合两条语句：一条用于购买，一条用于销售。

两种说法：

```
$this->alerts
            ->select('products.id as productid, products.code as code, products.name, products.price, sum(purchase_items.quantity)')
            ->from('products');
            $this->alerts->join('purchase_items', 'products.id = purchase_items.product_id');
                $this->alerts->group_by("products.id");
            echo "Total Purchases";
            echo $this->alerts->generate();

 $this->alerts
            ->select('products.id as productid, products.code as code, products.name, products.price, sum(sale_items.quantity)')
            ->from('products');
            $this->alerts->join('sale_items', 'products.id = sale_items.product_id');           
                $this->alerts->group_by("products.id");
            echo "Total Sales";
            echo $this->alerts->generate(); 
```

或者，在 SQL 中：

```
$results = $this->db->query('
    SELECT products.id as productid, products.code as code, products.name, products.price, ''Purchase'' as transaction, sum(purchase_items.quantity)
    FROM products
    JOIN purchase_items ON products.id = purchase_items.product_id
    GROUP BY products.id
    UNION ALL
    SELECT products.id as productid, products.code as code, products.name, products.price, ''Sale'' as transaction sum(sales_items.quantity)
    FROM products
    JOIN sales_items ON products.id = sales_items.product_id
    GROUP BY products.id')->result_array();

// Echo $results.... 
```

**编辑：** 我不完全确定您的`Alerts`模型中有什么，但是在您修改后的查询中，您将 SQL 语句分配给变量两次`$products`但不执行语句？

还要确保您的警报模型扩展`CI_Model`。

在更标准的 Codeigniter 语法中，我会做这样的事情：

```
 // In Controller, assuming the Alerts model is loaded, and using method chaining.

    // Get all sales. By the way, you normally have to group on all columns *not* being aggregated. You might
    // get unexpected results by grouping on price, unless the price never changes.
    $this->alerts->select('products.id as productid, products.code, products.name, products.price, sum(sale_items.quantity) as quantity')
          ->from('products')
          ->join('sale_items', 'products.id = sale_items.product_id')
          ->group_by('products.id, products.code, products.name, products.price');
    $sales = $this->alerts->get()->result_array();

    // Get all purchases
    $this->alerts->select('products.id as productid, products.code, products.name, products.price, sum(purchase_items.quantity) as quantity')
          ->from('products')
          ->join('purchase_items', 'products.id = purchase_items.product_id')
          ->group_by(products.id, products.code, products.name, products.price);
    $purchases = $this->alerts->get()->result_array();

    // Put it all together
    $products = array_merge($sales, $purchases);

    // And now do something with your combined results $products. Send to view, echo etc. 
```

# android - 我的位置按钮事件监听器

> ID：14777951
> 
> 赞同：20
> 
> 时间：2013-02-08T17:20:55.680
> 
> 标签：android, google-maps, google-maps-android-api-2

我启用了 Google Maps Android API v2 的 my-location 层，它添加了浮动按钮以转到用户的当前位置。我需要一种方法来检测对这个按钮的点击。这可能吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2015-06-16T21:02:40.413

自发布此问题以来，Google 已更新 API。他们增加了一个`onMyLocationButtonClick()`监听器。

添加监听器：

```
//add location button click listener
map.setOnMyLocationButtonClickListener(new GoogleMap.OnMyLocationButtonClickListener(){
    @Override
    public boolean onMyLocationButtonClick()
    {
        //TODO: Any custom actions
        return false;
    }
}); 
```

返回 false 本质上将调用 super 方法。返回 true 不会。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-09-02T14:27:10.497

8月最新发布的谷歌地图android api V2包含一个监听我的位置按钮点击的方法：**[onMyLocationButtonClick()](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/GoogleMap.OnMyLocationButtonClickListener)**这可以用来知道用户什么时候点击了按钮，如果监听已经消费了该事件则返回true

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-02-08T17:32:42.113

不，目前没有办法获得该信息。为此提出了一个功能请求，并且已被 Google 确认。

如果您想要更快的修复，请加注星标：

[http://code.google.com/p/gmaps-api-issues/issues/detail?id=4789&q=apitype%3DAndroid2&colspec=ID%20Type%20Status%20Introduced%20Fixed%20Summary%20Stars%20ApiType%20Internal](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4789&q=apitype%3DAndroid2&colspec=ID%20Type%20Status%20Introduced%20Fixed%20Summary%20Stars%20ApiType%20Internal)

* * *

解决方法：

禁用内置控件并创建自己的视图并将其添加到屏幕。为这个按钮设置一个 onClickListener 并将地图动画到地图的位置。

禁用默认控件：

```
UiSettings.setMyLocationButtonEnabled(false) 
```

从地图上获取我的位置：

```
GoogleMap.getMyLocation() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-13T18:41:27.087

很高兴知道这一点，因为我也想知道这一点。现在，有没有办法知道谷歌的位置服务是否已启用，以便我们决定是否要启用该按钮？拥有一个不执行任何操作的按钮是没有意义的，因此解决方法（始终禁用该按钮）似乎是目前唯一的选择。

# java - 文件与程序存在于同一文件夹中时出现 FileNotFoundException

> ID：14777952
> 
> 赞同：0
> 
> 时间：2013-02-08T17:21:10.783
> 
> 标签：java, java.util.scanner, filenotfoundexception

类似的问题涉及`C:`驱动器上的文件，其中硬编码文件路径是可接受的答案。这个应用程序是移动的，硬编码文件路径是不切实际的。

我正在尝试通过扫描仪导入一个文本文件，其中包含一个字符串列表，每个 15 个字符，每行 1 个。很多行。文件名为`a.txt`.

我称之为使用

```
File data = new File("a.txt");
Scanner in = new Scanner(data); 
```

用“b.txt”重复下面的行，使用不同的对象名称。

但是，当我构建程序时，我得到了这个错误日志（使用 Jcreator IDE）：

```
--------------------Configuration: <Default>--------------------
E:\Simple Encryption\Simple_Encryption.java:17: unreported exception java.io.FileNotFoundException; must be caught or declared to be thrown
    Scanner in = new Scanner(data);
                 ^
E:\Simple Encryption\Simple_Encryption.java:18: unreported exception java.io.FileNotFoundException; must be caught or declared to be thrown
    Scanner numsIn = new Scanner(nums);
                     ^
2 errors

Process completed. 
```

该程序位于文件夹`E:/Simple Encryption/`中，其中包含以下文件和文件夹：

*   Simple_Encryption.java
*   Simple_Encryption.class
*   lock.png（未使用）
*   一个.txt
*   b.txt（与导入时相同的错误`a.txt`，仅以下一行）
*   /images（文件夹，包含 icon.png）

文件夹中没有其他内容。我无法对文件路径进行硬编码，因为在不同的计算机上，它具有不同的驱动器名称，并且稍后将分布在不同的文件夹下。（在这里（学校），它在`E:`驱动器上，在家里它是`J:`驱动器，而在工作中它在`G:`驱动器上。）

虽然我从现有错误中得到了帮助，但我需要在程序启动时导入它，而不仅仅是跳过它。该文件以其当前形式存在，没有它，程序将无法运行。

是什么导致了这个错误？我能做些什么来防止这种情况发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:22:48.940

```
E:\Simple Encryption\Simple_Encryption.java:17: unreported exception 
java.io.FileNotFoundException; must be caught or declared to be thrown 
```

正如您的例外所说，您需要使用 try-catch 块

```
try {
   Scanner numsIn = new Scanner(nums);
catch (FileNotFoundException e) {
  // do something
} finally {
  if (numsIn != null) numsIn .close();
} 
```

**或者**

您需要通过调用方法抛出该异常

```
public static void xxxx() throws FileNotFoundException {
   // do something
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:22:56.487

问题不是抛出的异常，而是构造函数被声明为抛出已`FileNotFoundException`检查异常的事实。

```
public Scanner(File source) throws FileNotFoundException 
```

由于它是一个检查异常，它必须由程序员处理，因为它用于表示可能发生的事情。

因此，您必须将它们附在`try/catch`声明中：

```
Scanner in = null;
try {
  in = new Scanner(file);
}
catch (FileNotFoundException e) {
  e.printStackTrace();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T17:25:48.387

正如您所说，该文件存在，但它指出它找不到该文件。尝试这个：

```
System.out.println(data.getAbsolutePath()); 
```

这应该让您确切知道它在哪里寻找文件，然后您可以在不使用完整路径的情况下调整应用程序

# android - 如何从android相机捕获原始图像

> ID：14777953
> 
> 赞同：12
> 
> 时间：2013-02-08T17:21:11.643
> 
> 标签：android, camera

takePicture rawCallback 返回一个空指针。getPictureFormat 仅允许使用 .jpg。虽然可以使用 getParameters() setJpegQuality(100) setParameters 改进 jpeg，但返回的图像仍然是 jpeg。要获取位图图像，需要调用 BitmapFactory.decodeByteArray，这可能需要 1/2 秒的时间来处理。

我正在处理的应用程序需要相机可以产生的最详细的图像，这并不一定意味着漂亮。原始相机芯片捕获格式是拜耳。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-08T17:21:11.643

android（至少我的）有 2 个摄像头参数`"rawsave-mode"`，`"rawfname"`默认为`rawsave-mode=0`. 通过设置`rawsave-mode=1`，相机将保存原始相机图像文件，并照常执行其他相机功能。

```
Camera.Parameters parameters=preview.camera.getParameters();
parameters.set("rawsave-mode", "1");
parameters.set("rawfname", "/mnt/sdcard/test.raw");
preview.camera.setParameters(parameters);
preview.camera.takePicture(shutterCallback, null, jpegCallback); 
```

生成的文件的实际名称被修改为包含正在生成的原始文件的参数。对于我的一个机器人，生成的名称`"test__1604x1206_10_2.raw"`是 a1`1604x1206`图像，`10bit`格式 2。`"test__1284x966_10_3.raw"`它是 1284x966 图像，`10 bit`格式 3。`10 bytes`存储为`2 byte short int (little endian)`.

```
parameters.set("rawsave-mode", "2");
// setting the rawsave-mode to 2 increased the resolution to 3204x2406
// and output the file test__3204x2406_10_2.raw 
```

图像数据大致为`8 bit`，但在 范围内浮动`10 bit`，其中较亮的图像可能使用较高的值而较暗的较低。这允许图像处理软件创建直方图并捕获图像的有用范围。因为光不是恒定的，还可能需要以不同的方式调整一个通道以使图像看起来颜色正确。网上有很多关于色彩理论的信息可以充分解释这一点，但新用户要小心，to的转换`10 bit`很快`8`就会深入。如果您想要一张漂亮的图片，请使用 android 图片捕获而不是原始图像！

格式表示位的拜耳模式。Bayer 是一种格式，其中行和列的奇/偶值指示像素代表的颜色，其中每个像素的每个颜色通道`RGB`都有一个值`8 bit`，bayer 只有一个`10 bit`像素值，其中一个像素是红色，然后下一个绿色，红色，绿色，红色，绿色。然后下一行有蓝色，绿色，蓝色，绿色，蓝绿色。要确定`RGB`一个像素的值，需要解释周围​​的像素。

```
Format 2 has pixel order
//            0 1 2 3 4 5
//          0 G R G R G R
//          1 B G B G B G
//          2 G R G R G R
//          3 B G B G B G 
```

格式 3 的像素顺序为

```
//            0 1 2 3 4 5
//          0 R G R G R G
//          1 G B G B G B
//          2 R G R G R G
//          3 G B G B G B 
```

我不确定这种技术是否适用于其他机器人，或者它是否适用于未来的机器人。如果有人尝试这样做，请添加有关成功或失败的评论。我的手机是直接中国进口的解锁iHTC Android手机，已经root。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-13T03:02:54.637

捕获原始图像的代码：

```
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStream;
import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;

import android.os.Bundle;
import android.os.Environment;
import android.os.Looper;
import android.text.format.DateFormat;
import android.util.Log;
import android.view.Menu;
import android.view.MenuItem;
import android.view.SurfaceHolder;
import android.view.Window;
import android.view.WindowManager;
import android.view.SurfaceHolder.Callback;
import android.hardware.Camera;
import android.hardware.Camera.PictureCallback;
import android.hardware.Camera.ShutterCallback;
import android.view.KeyEvent;
import android.app.ProgressDialog;
import android.app.Dialog;
import android.os.Handler;
import android.os.Message;
import android.widget.Button;
import android.widget.TextView;
import android.widget.Toast;

import java.util.List;
import android.hardware.Camera.Size;
import android.view.Display;
import android.view.View;
import android.view.View.OnClickListener;
import android.util.Log;

public class Camera extends Activity implements SurfaceHolder.Callback {

    private int mMode;
    private boolean mIssdcardExist = false;
    private VideoPreview mVideoPreview; //缺VideoPreview这个类
    private int mPrvW = 640, mPrvH = 480;
    private int mDispW = 640, mDispH = 480;
    private int mPicW = 2560, mPicH = 1920;
    private Camera mCamera;
    private Camera.Parameters mCameraParam;
    private int mIsPreviewing = 0;
    private volatile int mIsFocused = 0;
    private volatile int mIsCapture = 0;
    private long mFocusStartTime;
    private long mFocusCallbackTime;
    private long mCaptureStartTime;
    private long mShutterCallbackTime;
    private long mRawPictureCallbackTime;
    private long mJpegPictureCallbackTime;
    private final AutoFocusCallback mAutoFocusCallback = new AutoFocusCallback();
    private final ShutterCallback mShutterCallback = new ShutterCallback();
    private final RawPictureCallback mRawPictureCallback = new RawPictureCallback();
    private static final String CAMERA_IMAGE_BUCKET_NAME = Environment.getExternalStorageDirectory().toString() + "/DCIM/CameraEM/";
    private int mAFEngMode = 0;

    public static final int CAPTURE_ID = Menu.FIRST;

    private String TAG = "EM-Camera";

    private final int DIALOG_PROGRESS = 1000;
    private ProgressDlgHandler mProgressDlgHandler = new ProgressDlgHandler();
    private final int EVENT_FULL_SCAN_START = 100;
    private final int EVENT_FULL_SCAN_COMPLETE = 101;
    private boolean mIsTest = false;
    private boolean mProgressDlgExists = false;

    private boolean mIsRawCapture = false;
    private String mRawCaptureFileName;

    private boolean mIsOnPause = false;
    private int mPos = 0;
    private static final int MSG_AF_MODE1_EVENT = 1001;
    private static final int MSG_AF_MODE3_EVENT = 1003;
    private static final int MSG_AF_MODE4_EVENT = 1004;
    private mAFMode1FirstThread threadFirst;
    private AFMode1Thread mode1Thread;
    private AFMode2Thread mode2Thread;
    private AFMode3Thread mode3Thread;
    private AFMode4Thread mode4Thread;
    private RawCaptureThread mRawCaptureThread;
    private boolean mCanBack = true;

    private Button mButtonPass;
    private Button mButtonFail;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.camera_test);

        Window win = getWindow();
        win.addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);

        if(Environment.getExternalStorageState().equals(Environment.MEDIA_REMOVED))
        {
            mIssdcardExist = false;
        }
        else
        {
            File file = new File(CAMERA_IMAGE_BUCKET_NAME);
            if(!file.isDirectory())
            {
                file.mkdirs();
            }
            mIssdcardExist = true;
        }

        mButtonPass = (Button) findViewById(R.id.camera_test_pass);
        mButtonPass.setOnClickListener(mButtonHandler);

        mButtonFail = (Button) findViewById(R.id.camera_test_fail);
        mButtonFail.setOnClickListener(mButtonHandler);
    }

        @Override
    public void onResume() {
        super.onResume();
        Log.i(TAG, "onResume ");
        mVideoPreview = (VideoPreview) findViewById(R.id.camera_preview);
        mVideoPreview.setAspectRatio(mPrvW, mPrvH);
        SurfaceHolder holder = mVideoPreview.getHolder();
        holder.addCallback(this);
        holder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);

        mIsTest = false;
        mIsOnPause = false;
    }

        @Override
    public void onPause() {
        mIsOnPause = true;
        if(null != mode1Thread && true == mode1Thread.isAlive()){
            try{
                mode1Thread.join();
            }catch(Exception e){
            }

        }

        if(null != threadFirst && true == threadFirst.isAlive()){
            try{
                threadFirst.join();
            }catch(Exception e){
            }

        }

        if(null != mode2Thread && true == mode2Thread.isAlive()){
            try{
                mode2Thread.join();
            }catch(Exception e){
            }

        }

        if(null != mode3Thread && true == mode3Thread.isAlive()){
            try{
                mode3Thread.join();
            }catch(Exception e){
            }

        }

        if(null != mode4Thread && true == mode4Thread.isAlive()){
            try{
                mode4Thread.join();
            }catch(Exception e){
            }

        }

        if(null != mRawCaptureThread && true == mRawCaptureThread.isAlive()){
            try{
                mRawCaptureThread.join();
            }catch(Exception e){
            }

        }

        super.onPause();
        Log.i(TAG, "super onPause.");
        this.finish();
    }

        @Override
        protected Dialog onCreateDialog(int id){
            if(id == DIALOG_PROGRESS){
                ProgressDialog dialog = new ProgressDialog(this);
                dialog.setMessage("It is in full scan, please wait......");
                dialog.setCancelable(false);
                return dialog;
            }
            return null;
        }

        private class ProgressDlgHandler extends Handler {
        @Override
        public void handleMessage(Message msg) {
            switch (msg.what) {
                case EVENT_FULL_SCAN_START:
                    showDialog(DIALOG_PROGRESS);
                    mProgressDlgExists = true;
                    break;
                case EVENT_FULL_SCAN_COMPLETE:
                    dismissDialog(DIALOG_PROGRESS);
                    mProgressDlgExists = false;
                    break;
            }
        }
    }

    public void surfaceChanged(SurfaceHolder holder, int format, int w, int h) {
        mDispW = w;
        mDispH = h;
        Log.i(TAG, "surfaceChanged width is : " + w);
        Log.i(TAG, "surfaceChanged height is : " + h);
        startPreview();
    }

    public void surfaceCreated(SurfaceHolder holder) {
        openCamera();
        try {
            mCamera.setPreviewDisplay(holder);
        } catch (IOException exception) {
            closeCamera();
            Log.i(TAG, "surfaceCreated closeCamera ");
        }       
    }

    public void surfaceDestroyed(SurfaceHolder arg0) {
            stopPreview();
        closeCamera();
        Log.i(TAG, "surfaceDestroyed closeCamera ");
    }

    private void openCamera() {
        if (mCamera == null) {
            mCamera = Camera.open();
            Log.i(TAG, "Enter openCamera to init the mCamera.");
            if(null == mCamera){
                Log.i(TAG, "init the mCamera is null.");
            }
        }
    }
    private void closeCamera() {
        if(null != mCamera){
            mCamera.release();
            mCamera = null;
        }
    }
    private void startPreview() {
        mCameraParam = mCamera.getParameters();
        //GW616 Camera preview problem
        // Set a preview size that is closest to the viewfinder height and has
        // the right aspect ratio.
        Size size = mCameraParam.getPictureSize();
        List<Size> sizes = mCameraParam.getSupportedPreviewSizes();
        Size optimalSize = getOptimalPreviewSize(
                sizes, (double) size.width / size.height);
        if (optimalSize != null) {
            mCameraParam.setPreviewSize(optimalSize.width, optimalSize.height);
        }
        //end
//      mCameraParam.setPreviewSize(mPrvW, mPrvH);
        mCameraParam.set("fps-mode", 0);    // Frame rate is normal
        mCameraParam.set("cam-mode", 0);    // Cam mode is preview
        mCamera.setParameters(mCameraParam);
        Log.i(TAG, "startPreview width is : " + mPrvW);
        Log.i(TAG, "startPreview height is : " + mPrvH);
        mCamera.startPreview();
        mIsPreviewing = 1;
    }
    private void stopPreview() {
        if(null != mCamera){
            mCamera.stopPreview();
        }
        mIsPreviewing = 0;
    }

    private Size getOptimalPreviewSize(List<Size> sizes, double targetRatio) {
        final double ASPECT_TOLERANCE = 0.05;
        if (sizes == null) return null;

        Size optimalSize = null;
        double minDiff = Double.MAX_VALUE;

        // Because of bugs of overlay and layout, we sometimes will try to
        // layout the viewfinder in the portrait orientation and thus get the
        // wrong size of mSurfaceView. When we change the preview size, the
        // new overlay will be created before the old one closed, which causes
        // an exception. For now, just get the screen size

        Display display = getWindowManager().getDefaultDisplay();
        int targetHeight = Math.min(display.getHeight(), display.getWidth());

        if (targetHeight <= 0) {
            // We don't know the size of SurefaceView, use screen height
            WindowManager windowManager = (WindowManager)
                    getSystemService(this.WINDOW_SERVICE);
            targetHeight = windowManager.getDefaultDisplay().getHeight();
        }

        // Try to find an size match aspect ratio and size
        for (Size size : sizes) {
            double ratio = (double) size.width / size.height;
            if (Math.abs(ratio - targetRatio) > ASPECT_TOLERANCE) continue;
            if (Math.abs(size.height - targetHeight) < minDiff) {
                optimalSize = size;
                minDiff = Math.abs(size.height - targetHeight);
            }
        }

        // Cannot find the one match the aspect ratio, ignore the requirement
        if (optimalSize == null) {
            Log.v(TAG, "No preview size match the aspect ratio");
            minDiff = Double.MAX_VALUE;
            for (Size size : sizes) {
                if (Math.abs(size.height - targetHeight) < minDiff) {
                    optimalSize = size;
                    minDiff = Math.abs(size.height - targetHeight);
                }
            }
        }
        Log.v(TAG, String.format(
                "Optimal preview size is %sx%s",
                optimalSize.width, optimalSize.height));
        return optimalSize;
    }

    @Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {
        switch (keyCode) {
            case KeyEvent.KEYCODE_CAMERA:
                this.CapturePicture();
                return true;
            case KeyEvent.KEYCODE_DPAD_CENTER:
                return true;
            case KeyEvent.KEYCODE_SEARCH:
                return true;
            case KeyEvent.KEYCODE_FOCUS:
                return true;        
            }
            return super.onKeyDown(keyCode, event);
    }

    private void CapturePicture(){
        if(false == mIssdcardExist)
        {
            AlertDialog.Builder builder = new AlertDialog.Builder(this);
            builder.setTitle("sdcard not available");
            builder.setMessage("Please insert sdcard.");
            builder.setPositiveButton("OK" , null);
            builder.create().show();
            return;
         }

         if(Environment.getExternalStorageState().equals(Environment.MEDIA_SHARED))
        {
            AlertDialog.Builder builder = new AlertDialog.Builder(this);
                    builder.setTitle("sdcard is busy");
                    builder.setMessage("Sorry, your SD card is busy.");
                    builder.setPositiveButton("OK" , null);
                    builder.create().show();
                    return;
        }

        if(true == mIsTest)
        {
            Toast.makeText(this,"It is in capturing, can not repeat capture.",Toast.LENGTH_LONG).show();
            if(true == mProgressDlgExists)
            {
                showDialog(DIALOG_PROGRESS);
            }
            return;
        }

        Intent intent = getIntent();
        int TestMode = intent.getIntExtra("TestMode", 0);
        Log.i(TAG, "The value of TestMode is :" + TestMode);
        if(1 == TestMode)//AF Mode
        {
            mMode = intent.getIntExtra("AFMode", 0);
            switch(mMode){
                case 1:
                    captureMode1();
                    break;
                case 2:
                    captureMode2();
                    break;
                case 3:
                    captureMode3();
                    break;
                case 4:
                    captureMode4();
                    break;
            }
         }
         else if(2 == TestMode)//RawCapture Mode
         {
             RawCapture();
         }
         else//not select mode yet
         {
             Toast.makeText(this,"Please select the test mode first!",Toast.LENGTH_LONG).show();
         }
    }

    private void captureMode1()
    {           
        Log.i(TAG, "Enter captureMode1 function.");
        threadFirst = new mAFMode1FirstThread();
        threadFirst.start();
    }

    class mAFMode1FirstThread extends Thread{
        public void run(){
            Log.i(TAG, "mAFMode1FirstThread");
            mIsTest = true;

            mAFEngMode = 0;
            mCameraParam.set("afeng-mode", mAFEngMode);
            mCameraParam.set("focus-mode", "auto");
            mCameraParam.set("focus-meter", "spot");
            mCamera.setParameters(mCameraParam);
            mFocusStartTime = System.currentTimeMillis();
            mIsFocused = 0;
            mCamera.autoFocus(mAutoFocusCallback);

            mCanBack = false;
            takePicture();
            mAFEngMode = 1;
            mCameraParam.set("afeng-mode", mAFEngMode);
            mCameraParam.set("focus-mode", "manual");
            mCamera.setParameters(mCameraParam);
            mPos = 0;
            mCameraParam.set("afeng-pos", mPos);
            mCamera.setParameters(mCameraParam);
            startPreview();
            mCanBack = true;
            Sleep(2000);

            mHandler.sendEmptyMessage(MSG_AF_MODE1_EVENT);          

            Log.i(TAG, "mAFMode1FirstThread finish.");
        }
    }

    private Handler mHandler = new Handler(){
        @Override
        public void handleMessage(Message msg){
            switch(msg.what){
                case MSG_AF_MODE1_EVENT:
                    mode1Thread = new AFMode1Thread();
                    mode1Thread.start();
                    break;
                case MSG_AF_MODE3_EVENT:
                    mode3Thread = new AFMode3Thread();
                    mode3Thread.start();
                    break;
                case MSG_AF_MODE4_EVENT:
                    mode4Thread = new AFMode4Thread();
                    mode4Thread.start();
                    break;
                default:
                    break;
            }
        }
    };

    @Override
    public void onBackPressed() {
        if(false == mCanBack){
            return;
        }
        super.onBackPressed();
    }

    class AFMode1Thread extends Thread{
        public void run(){
            Log.i(TAG, "mAFMode1Thread");
            if(true == mIsOnPause){
                mHandler.removeMessages(MSG_AF_MODE1_EVENT);
                return;
            }
            mCanBack = false;
            takePicture();
            mPos ++;
            mCameraParam.set("afeng-pos", mPos);
            mCamera.setParameters(mCameraParam);            
            startPreview();
            mCanBack = true;
            Sleep(2000);            
            if(false == mIsOnPause && mPos <= 50){
                mHandler.sendEmptyMessage(MSG_AF_MODE1_EVENT);
            }
            if(mPos > 50){
                mIsTest = false;
            }
        }
    }

    private void captureMode2()
    {   
        Log.i(TAG, "Enter captureMode2 function.");
        mode2Thread = new AFMode2Thread();
        mode2Thread.start();
    }

    class AFMode2Thread extends Thread{
        public void run(){
            Log.i(TAG, "mAFMode2Thread");

            mIsTest = true; 
            mCanBack = true;
            mAFEngMode = 1;
            mCameraParam.set("afeng-mode", mAFEngMode);
            mCameraParam.set("focus-mode", "fullscan");
            mCamera.setParameters(mCameraParam);
            mIsFocused = 0;
            mCamera.autoFocus(mAutoFocusCallback);
            mProgressDlgHandler.sendEmptyMessage(EVENT_FULL_SCAN_START);

            mCanBack = false;
            takePicture();
            startPreview();
            mCanBack = true;
            mIsTest = false;
            Sleep(2000);

        }
    }

    private void captureMode3()
    {
        Log.i(TAG, "Enter captureMode3 function.");
        mPos = 0;
        mode3Thread = new AFMode3Thread();
        mode3Thread.start();
    }

    class AFMode3Thread extends Thread{
        public void run(){
            Log.i(TAG, "mAFMode3Thread");
            if(true == mIsOnPause){
                mHandler.removeMessages(MSG_AF_MODE3_EVENT);
                return;
            }

            mIsTest = true;

            mAFEngMode = 1;
            mCameraParam.set("afeng-mode", mAFEngMode);
            mCameraParam.set("focus-mode", "fullscan");
            mCamera.setParameters(mCameraParam);
            mIsFocused = 0;
            mCamera.autoFocus(mAutoFocusCallback);
            mProgressDlgHandler.sendEmptyMessage(EVENT_FULL_SCAN_START);

            mCanBack = false;
            takePicture();
            mPos ++;
            startPreview();
            mCanBack = true;
            Sleep(2000);

            if(false == mIsOnPause && mPos <= 50){
                mHandler.sendEmptyMessage(MSG_AF_MODE3_EVENT);
            }
            if(mPos > 50){
                mIsTest = false;
            }
        }
    }

    private void captureMode4()
    {       
        Log.i(TAG, "Enter captureMode4 function.");
        mPos = 0;
        mode4Thread = new AFMode4Thread();
        mode4Thread.start();
    }

    class AFMode4Thread extends Thread{
        public void run(){
            Log.i(TAG, "mAFMode4Thread");
            if(true == mIsOnPause){
                mHandler.removeMessages(MSG_AF_MODE4_EVENT);
                return;
            }

            mIsTest = true;

            mAFEngMode = 0;
            mCameraParam.set("afeng-mode", mAFEngMode);
            mCameraParam.set("focus-mode", "auto");
            mCameraParam.set("focus-meter", "spot");
            mCamera.setParameters(mCameraParam);
            mIsFocused = 0;
            mCamera.autoFocus(mAutoFocusCallback);
            mCanBack = false;
            takePicture();
            mPos ++;
            startPreview();
            mCanBack = true;
            Sleep(2000);

            if(false == mIsOnPause && mPos <= 50){
                mHandler.sendEmptyMessage(MSG_AF_MODE4_EVENT);
            }
            if(mPos > 50){
                mIsTest = false;
            }
        }
    }

    private void RawCapture()
    {
        Log.i(TAG, "Enter RawCapture function.");
        mRawCaptureThread = new RawCaptureThread();
        mRawCaptureThread.start();
    }

    class RawCaptureThread extends Thread{
        public void run(){
            Log.i(TAG, "mAFMode4Thread");
            mCanBack = true;

            mIsTest = true;
            mIsRawCapture = true;

            mCameraParam.set("rawsave-mode", "on");
            long dateTaken = System.currentTimeMillis();
            mRawCaptureFileName = CAMERA_IMAGE_BUCKET_NAME + createName(dateTaken);
            mCameraParam.set("rawfname", mRawCaptureFileName + ".raw");
            mCamera.setParameters(mCameraParam);
            mCamera.autoFocus(mAutoFocusCallback);
            mCanBack = false;
            takePicture();
            startPreview();
            mCanBack = true;
            mIsRawCapture = false;
            mIsTest = false;
            Sleep(2000);            

        }
    }

    private final class AutoFocusCallback implements android.hardware.Camera.AutoFocusCallback {
        public void onAutoFocus(boolean focused, android.hardware.Camera camera) {
            mFocusCallbackTime = System.currentTimeMillis();
            mIsFocused = 1;
            if(1 == mAFEngMode)
            {
                mProgressDlgHandler.sendEmptyMessage(EVENT_FULL_SCAN_COMPLETE);
            }
        }
    }
    private final class ShutterCallback implements android.hardware.Camera.ShutterCallback {
        public void onShutter() {           
            mShutterCallbackTime = System.currentTimeMillis();
        }
    }  
    private final class RawPictureCallback implements PictureCallback {
      public void onPictureTaken(byte [] rawData, android.hardware.Camera camera) {         
        mRawPictureCallbackTime = System.currentTimeMillis();
      }
    }
    private final class JpegPictureCallback implements PictureCallback {
      public void onPictureTaken(byte [] jpegData, android.hardware.Camera camera) {           
         mJpegPictureCallbackTime = System.currentTimeMillis();
         if (jpegData != null) {
            storeImage(jpegData);
         }
         mIsCapture = 0;
      }
    }

    private void takePicture() 
    {       
        while (mIsFocused == 0) {
            Sleep(100);
        }

        mIsCapture = 1;
        mCaptureStartTime = System.currentTimeMillis();
        mCamera.takePicture(mShutterCallback, mRawPictureCallback, new JpegPictureCallback());
        while (mIsCapture == 1) {
            Sleep(100);
        }
    }
    private void Sleep(long time) 
    {
        try{
            Thread.sleep(time);
        } catch (InterruptedException e){
            e.printStackTrace();
        }
    }

    private void storeImage(byte[] jpegData) {
        long time;
        long dateTaken = System.currentTimeMillis();
        String name = CAMERA_IMAGE_BUCKET_NAME + createName(dateTaken) + ".jpg";

        if(true == mIsRawCapture)
        {
            name = mRawCaptureFileName  + ".jpg";
        }

        File fHandle = new File(name);
        try {
            OutputStream bos = new FileOutputStream(fHandle);
            bos.write(jpegData);
            bos.close();
            time = System.currentTimeMillis();
        } catch (Exception ex) {
            fHandle.delete();
        }
    }
    private static String createName(long dateTaken) {
        return DateFormat.format("yyyy-MM-dd kk.mm.ss", dateTaken).toString();
    }

    OnClickListener mButtonHandler = new OnClickListener() {
        public void onClick(View v) {
            SharedPreferences sharedPre = getSharedPreferences("test_results", Context.MODE_PRIVATE);
            SharedPreferences.Editor editor = sharedPre.edit();

            if (v.getId() == R.id.camera_test_pass) {
                Log.i("CameraTest", "-----mButtonHandler----onClick()----camera_test_pass");
                editor.putBoolean("CameraTest", true);
            } else if (v.getId() == R.id.camera_test_fail) {
                Log.i("CameraTest", "-----mButtonHandler----onClick()----camera_test_fail");
                editor.putBoolean("CameraTest", false);
            }
            editor.commit();

            Intent intent = new Intent();
            intent.setClass(CameraTest.this, SpeakerTest.class);
            startActivity(intent);
            finish();
        }
    }; 

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-06T22:03:23.623

//将bayer转换为rgb的丑陋代码

```
//test__1604x1206_10_2b.raw
//test__1284x966_10_3.raw
#include <stdio.h>
    unsigned short int bayerImage[2500][3500]; //times 3 allows for forming an RGB image for debugging
    unsigned char bmpImage[30000000]; //times 3 allows for forming an RGB image for debugging
#include <iomanip>
#include <iostream>
#include "bayer2rgb.h"
#include <memory.h>
#include <string.h>

/*****************************************************************************
**
*/

int DumpImage( char* pszFilename, BYTE* pImage, int bmpWidth, int bmpHeight,int bmpBits,int bmpFormat)
{
    FILE     *bayerFile;
    FILE     *rgbFile;
    int x,y;
    unsigned char lowOrder,highOrder;
    unsigned char bmpchar;
    unsigned short bayerVal;

    unsigned char bmpheader[62];
    char  FullFilename[MY_MAX_PATH];
    unsigned int  bmrgbFilesize;
    unsigned int minPixel=100000;
    unsigned int maxPixel=0;
    static unsigned int rgbValues[4][1024];

    /*expecting 10 bit bayer */
    if(bmpBits!=10)
    {
        printf("invalid bit specification\n");
        return(-1);
    }
    if(bmpHeight >= 0)
    {
        bmrgbFilesize = (((bmpWidth*24+31)/32)*4)*bmpHeight;
    }
    else
    {
        bmrgbFilesize = (((bmpWidth*24+31)/32)*4)*(-bmpHeight);
    }

    #ifdef LINUX

      strcpy( FullFilename, pszFilename );

      rgbFile = fopen( FullFilename, "w+b" );

      if( rgbFile )

    #else

      strcpy_s( FullFilename, sizeof(FullFilename), pszFilename );

      errno_t  errno;
      errno = fopen_s( &bayerFile, FullFilename, "r+b" );  
      if(errno == 0)
      {
          printf("size %d", strlen(FullFilename)-4);
        memcpy(&FullFilename[strlen(FullFilename)-4],".bmp",4);
        errno = fopen_s( &rgbFile, FullFilename, "w+b" );  
      }
      if ( errno == 0 )
    #endif
    {

/*    0 1 2 3 4 5     0 1 2 3 4 5     0 1 2 3 4 5 */
/*  0 R G R G R G   0 G R G R G R   0 B G B G B G */
/*  1 G B G B G B   1 B G B G B G   1 G R G R G R */
/*  2 R G R G R G   2 G R G R G R   2 B G B G B G */
/*  3 G B G B G B   3 B G B G B G   3 G R G R G R */

        memset(bmpImage,255,sizeof(bmpImage));
        switch(bmpFormat)
        {
        case 2:
//            0 1 2 3 4 5
//          0 G R G R G R
//          1 B G B G B G
//          2 G R G R G R
//          3 B G B G B G
            for(y=0;y<bmpHeight;y++)
            {
                for(x=0;x<bmpWidth;x++)
                {
                    lowOrder=fgetc(bayerFile);
                    highOrder=fgetc(bayerFile);
                    bayerVal=(highOrder * 0x100);
                    bayerVal+=lowOrder;
                    bayerImage[y][x]=bayerVal;
                    if(bayerVal<minPixel)
                    {
                        minPixel=bayerVal;
                    }
                    if(bayerVal>maxPixel)
                    {
                        maxPixel=bayerVal;
                    }
                    if(y%2==0)
                    {
                        if(x%2==0)
                        {
                            //green
                            bayerImage[y][x]=bayerVal/2;
                            //if (bayerImage[y][x] >= 20) bayerImage[y][x]-=20; else bayerImage[y][x]=0;
                            //bayerImage[y][x]*=.65;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[0][bayerVal]++;
                        }
                        else
                        {
                            //red
                            bayerImage[y][x]=bayerVal/2;
                            //if (bayerImage[y][x] >= 10) bayerImage[y][x]-=10; else bayerImage[y][x]=0;
                            //bayerImage[y][x]*=.85;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[1][bayerVal]++;
                        }
                    }
                    else
                    {
                        if(x%2==0)
                        {
                            //blue
                            bayerImage[y][x]=bayerVal/2;
                            //if (bayerImage[y][x] >= 10) bayerImage[y][x]-=10; else bayerImage[y][x]=0;
                            //bayerImage[y][x]*=.85;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[2][bayerVal]++;
                        }
                        else
                        {
                            //green
                            bayerImage[y][x]=bayerVal/2;
                            //if (bayerImage[y][x] >= 20) bayerImage[y][x]-=20; else bayerImage[y][x]=0;
                            //bayerImage[y][x]*=.65;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[3][bayerVal]++;
                        }
                    }
                 }
            }
            for(y=1;y<bmpHeight-1;y++)
            {
                for(x=1;x<bmpWidth-1;x++)
                {            
                    bmpchar=bayerImage[y][x]/4;
                    if(y%2==0)
                    {
                        if(x%2==0)
                        {
                            //green pixel bayerImage[y][x]
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=(bayerImage[y-1][x]+bayerImage[y+1][x])/2;//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=(bayerImage[y][x]/2)+((bayerImage[y-1][x-1]+bayerImage[y-1][x+1]+bayerImage[y+1][x-1]+bayerImage[y+1][x+1])/8);//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=(bayerImage[y][x-1]+bayerImage[y][x+1])/2;//red
                        }
                        else
                        {
                            //red pixel
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=(bayerImage[y-1][x-1]+bayerImage[y-1][x+1]+bayerImage[y+1][x-1]+bayerImage[y+1][x+1])/4;//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=(bayerImage[y-1][x]+bayerImage[y+1][x]+bayerImage[y][x-1]+bayerImage[y][x+1])/4;//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=(bayerImage[y][x]);//red
                        }
                    }
                    else
                    {
                        if(x%2==0)
                        {
                            //blue pixel
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=bayerImage[y][x];//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=(bayerImage[y-1][x]+bayerImage[y+1][x]+bayerImage[y][x-1]+bayerImage[y][x+1])/4;//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=(bayerImage[y-1][x-1]+bayerImage[y-1][x+1]+bayerImage[y+1][x-1]+bayerImage[y+1][x+1])/4;//red
                        }
                        else
                        {
                            //green pixel 
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=(bayerImage[y][x-1]+bayerImage[y][x+1])/2;//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=(bayerImage[y][x]/2)+((bayerImage[y-1][x-1]+bayerImage[y-1][x+1]+bayerImage[y+1][x-1]+bayerImage[y+1][x+1])/8);//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=(bayerImage[y-1][x]+bayerImage[y+1][x])/2;//red
                        }
                    }
                }
            }
            break;
        case 3:
            printf("format 3\n");
//            0 1 2 3 4 5
//          0 R G R G R G
//          1 G B G B G B
//          2 R G R G R G
//          3 G B G B G B
            for(y=0;y<bmpHeight;y++)
            {
                for(x=0;x<bmpWidth;x++)
                {
                    lowOrder=fgetc(bayerFile);
                    highOrder=fgetc(bayerFile);
                    bayerVal=(highOrder * 0x100);
                    bayerVal+=lowOrder;
                    bayerImage[y][x]=bayerVal;
                    if(bayerVal<minPixel)
                    {
                        minPixel=bayerVal;
                    }
                    if(bayerVal>maxPixel)
                    {
                        maxPixel=bayerVal;
                    }
                    if(y%2==0)
                    {
                        if(x%2==0)
                        {
                            //red
                            bayerImage[y][x]=bayerVal;
                            if (bayerImage[y][x] >= 10) bayerImage[y][x]-=10; else bayerImage[y][x]=0;
                            //bayerImage[y][x]*=.85;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[1][bayerVal]++;
                        }
                        else
                        {
                            //green
                            bayerImage[y][x]=bayerVal;
                            if (bayerImage[y][x] >= 20) bayerImage[y][x]-=20; else bayerImage[y][x]=0;
                            bayerImage[y][x]*=.65;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[0][bayerVal]++;
                        }
                    }
                    else
                    {
                        if(x%2==0)
                        {
                            //green
                            bayerImage[y][x]=bayerVal;
                            if (bayerImage[y][x] >= 20) bayerImage[y][x]-=20; else bayerImage[y][x]=0;
                            bayerImage[y][x]*=.65;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[3][bayerVal]++;
                        }
                        else
                        {
                            //blue
                            bayerImage[y][x]=bayerVal;
                            if (bayerImage[y][x] >= 10) bayerImage[y][x]-=10; else bayerImage[y][x]=0;
                            //bayerImage[y][x]*=.85;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[2][bayerVal]++;
                        }
                    }
                 }
            }
            for(y=1;y<bmpHeight-1;y++)
            {
                for(x=1;x<bmpWidth-1;x++)
                {            
                    bmpchar=bayerImage[y][x]/4;
                    if(y%2==0)
                    {
                        if(x%2==0)
                        {
                            //red pixel
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=(bayerImage[y-1][x-1]+bayerImage[y-1][x+1]+bayerImage[y+1][x-1]+bayerImage[y+1][x+1])/4;//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=(bayerImage[y-1][x]+bayerImage[y+1][x]+bayerImage[y][x-1]+bayerImage[y][x+1])/4;//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=bayerImage[y][x];//red 
                        }
                        else
                        {
                            //green pixel bayerImage[y][x]
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=(bayerImage[y-1][x]+bayerImage[y+1][x])/2;//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=(bayerImage[y][x]/2)+((bayerImage[y-1][x-1]+bayerImage[y-1][x+1]+bayerImage[y+1][x-1]+bayerImage[y+1][x+1])/8);//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=(bayerImage[y][x-1]+bayerImage[y][x+1])/2;//red 
                        }
                    }
                    else
                    {
                        if(x%2==0)
                        {
                            //green pixel 
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=(bayerImage[y][x-1]+bayerImage[y][x+1])/2;//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=(bayerImage[y][x]/2)+((bayerImage[y-1][x-1]+bayerImage[y-1][x+1]+bayerImage[y+1][x-1]+bayerImage[y+1][x+1])/8);//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=(bayerImage[y-1][x]+bayerImage[y+1][x])/2;//red
                        }
                        else
                        {
                            //blue pixel
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=bayerImage[y][x];//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=(bayerImage[y-1][x]+bayerImage[y+1][x]+bayerImage[y][x-1]+bayerImage[y][x+1])/4;//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=(bayerImage[y-1][x-1]+bayerImage[y-1][x+1]+bayerImage[y+1][x-1]+bayerImage[y+1][x+1])/4;//red
                        }
                    }
                }
            }
            break;
        case 4:
//            0 1 2 3 4 5
//          0 G R G R G R
//          1 B G B G B G
//          2 G R G R G R
//          3 B G B G B G
            for(y=0;y<bmpHeight;y++)
            {
                for(x=0;x<bmpWidth;x++)
                {
                    lowOrder=fgetc(bayerFile);
                    highOrder=fgetc(bayerFile);
                    bayerVal=(highOrder * 0x100);
                    bayerVal+=lowOrder;
                    bayerImage[y][x]=bayerVal;
                    if(bayerVal<minPixel)
                    {
                        minPixel=bayerVal;
                    }
                    if(bayerVal>maxPixel)
                    {
                        maxPixel=bayerVal;
                    }
                    if(y%2==0)
                    {
                        if(x%2==0)
                        {
                            //green
                            bayerImage[y][x]=bayerVal;
                            if (bayerImage[y][x] >= 20) bayerImage[y][x]-=20; else bayerImage[y][x]=0;
                            bayerImage[y][x]*=.65;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[0][bayerVal]++;
                        }
                        else
                        {
                            //red
                            bayerImage[y][x]=bayerVal;
                            if (bayerImage[y][x] >= 10) bayerImage[y][x]-=10; else bayerImage[y][x]=0;
                            //bayerImage[y][x]*=.85;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[1][bayerVal]++;
                        }
                    }
                    else
                    {
                        if(x%2==0)
                        {
                            //blue
                            bayerImage[y][x]=bayerVal;
                            if (bayerImage[y][x] >= 10) bayerImage[y][x]-=10; else bayerImage[y][x]=0;
                            //bayerImage[y][x]*=.85;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[2][bayerVal]++;
                        }
                        else
                        {
                            //green
                            bayerImage[y][x]=bayerVal;
                            if (bayerImage[y][x] >= 20) bayerImage[y][x]-=20; else bayerImage[y][x]=0;
                            bayerImage[y][x]*=.65;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[3][bayerVal]++;
                        }
                    }
                 }
            }
            for(y=1;y<bmpHeight-1;y++)
            {
                for(x=1;x<bmpWidth-1;x++)
                {            
                    bmpchar=bayerImage[y][x]/4;
                    if(y%2==0)
                    {
                        if(x%2==0)
                        {
                            //green pixel bayerImage[y][x]
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=(bayerImage[y][x]+bayerImage[y][x+1]+bayerImage[y+1][x])/3;//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=bmpImage[(((y*bmpWidth)+x)*3)+0];//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=bmpImage[(((y*bmpWidth)+x)*3)+0];//red
                        }
                        else
                        {
                            //red pixel
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=(bayerImage[y][x]+bayerImage[y][x+1]+bayerImage[y+1][x+1])/3;//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=bmpImage[(((y*bmpWidth)+x)*3)+0];//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=bmpImage[(((y*bmpWidth)+x)*3)+0];//red
                        }
                    }
                    else
                    {
                        if(x%2==0)
                        {
                            //blue pixel
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=(bayerImage[y][x]+bayerImage[y+1][x]+bayerImage[y+1][x+1])/3;//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=bmpImage[(((y*bmpWidth)+x)*3)+0];//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=bmpImage[(((y*bmpWidth)+x)*3)+0];//red
                        }
                        else
                        {
                            //green pixel 
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=(bayerImage[y][x]+bayerImage[y][x+1]+bayerImage[y+1][x])/3;//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=bmpImage[(((y*bmpWidth)+x)*3)+0];//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=bmpImage[(((y*bmpWidth)+x)*3)+0];//red
                        }
                    }
                }
            }
            break;
        case 5:
//            0 1 2 3 4 5
//          0 G R G R G R
//          1 B G B G B G
//          2 G R G R G R
//          3 B G B G B G
            for(y=0;y<bmpHeight;y++)
            {
                for(x=0;x<bmpWidth;x++)
                {
                    lowOrder=fgetc(bayerFile);
                    highOrder=fgetc(bayerFile);
                    bayerVal=(highOrder * 0x100);
                    bayerVal+=lowOrder;
                    bayerImage[y][x]=bayerVal;
                    if(bayerVal<minPixel)
                    {
                        minPixel=bayerVal;
                    }
                    if(bayerVal>maxPixel)
                    {
                        maxPixel=bayerVal;
                    }
                    if(y%2==0)
                    {
                        if(x%2==0)
                        {
                            //green
                            bayerImage[y][x]=bayerVal;
                            //if (bayerImage[y][x] >= 20) bayerImage[y][x]-=20; else bayerImage[y][x]=0;
                            bayerImage[y][x]/=256;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[0][bayerVal]++;
                        }
                        else
                        {
                            //red
                            bayerImage[y][x]=bayerVal;
                            //if (bayerImage[y][x] >= 10) bayerImage[y][x]-=10; else bayerImage[y][x]=0;
                            bayerImage[y][x]/=256;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[1][bayerVal]++;
                        }
                    }
                    else
                    {
                        if(x%2==0)
                        {
                            //blue
                            bayerImage[y][x]=bayerVal;
                            //if (bayerImage[y][x] >= 10) bayerImage[y][x]-=10; else bayerImage[y][x]=0;
                            bayerImage[y][x]/=256;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[2][bayerVal]++;
                        }
                        else
                        {
                            //green
                            bayerImage[y][x]=bayerVal;
                            //if (bayerImage[y][x] >= 20) bayerImage[y][x]-=20; else bayerImage[y][x]=0;
                            bayerImage[y][x]/=256;
                            if(bayerImage[y][x]>255) 
                                bayerImage[y][x]=255;
                            rgbValues[3][bayerVal]++;
                        }
                    }
                 }
            }
            for(y=1;y<bmpHeight-1;y++)
            {
                for(x=1;x<bmpWidth-1;x++)
                {            
                    bmpchar=bayerImage[y][x]/4;
                    if(y%2==0)
                    {
                        if(x%2==0)
                        {
                            //green pixel bayerImage[y][x]
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=(bayerImage[y-1][x]+bayerImage[y+1][x])/2;//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=(bayerImage[y][x]/2)+((bayerImage[y-1][x-1]+bayerImage[y-1][x+1]+bayerImage[y+1][x-1]+bayerImage[y+1][x+1])/8);//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=(bayerImage[y][x-1]+bayerImage[y][x+1])/2;//red
                        }
                        else
                        {
                            //red pixel
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=(bayerImage[y-1][x-1]+bayerImage[y-1][x+1]+bayerImage[y+1][x-1]+bayerImage[y+1][x+1])/4;//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=(bayerImage[y-1][x]+bayerImage[y+1][x]+bayerImage[y][x-1]+bayerImage[y][x+1])/4;//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=(bayerImage[y][x]);//red
                        }
                    }
                    else
                    {
                        if(x%2==0)
                        {
                            //blue pixel
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=bayerImage[y][x];//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=(bayerImage[y-1][x]+bayerImage[y+1][x]+bayerImage[y][x-1]+bayerImage[y][x+1])/4;//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=(bayerImage[y-1][x-1]+bayerImage[y-1][x+1]+bayerImage[y+1][x-1]+bayerImage[y+1][x+1])/4;//red
                        }
                        else
                        {
                            //green pixel 
                            bmpImage[(((y*bmpWidth)+x)*3)+0]=(bayerImage[y][x-1]+bayerImage[y][x+1])/2;//blue
                            bmpImage[(((y*bmpWidth)+x)*3)+1]=(bayerImage[y][x]/2)+((bayerImage[y-1][x-1]+bayerImage[y-1][x+1]+bayerImage[y+1][x-1]+bayerImage[y+1][x+1])/8);//green
                            bmpImage[(((y*bmpWidth)+x)*3)+2]=(bayerImage[y-1][x]+bayerImage[y+1][x])/2;//red
                        }
                    }
                }
            }
            break;
        default:
            printf("undefined bit format\n");
            return(-3);
            break;
        }
        bmpheader[0]='\x42';
        bmpheader[1]='\x4d';
        bmpheader[2]='\x38';
        bmpheader[3]='\x00';
        bmpheader[4]='\x90';
        bmpheader[5]='\x00';
        bmpheader[6]='\x00';
        bmpheader[7]='\x00';

        bmpheader[8]='\x00';
        bmpheader[9]='\x00';
        bmpheader[10]='\x36';
        bmpheader[11]='\x00';
        bmpheader[12]='\x00';
        bmpheader[13]='\x00';
        bmpheader[14]='\x28';
        bmpheader[15]='\x00';

        bmpheader[16]='\x00';
        bmpheader[17]='\x00';
        bmpheader[18]='\x00';
        bmpheader[19]='\x08';
        bmpheader[20]='\x00';
        bmpheader[21]='\x00';
        bmpheader[22]='\x00';
        bmpheader[23]='\x06';

        bmpheader[24]='\x00';
        bmpheader[25]='\x00';
        bmpheader[26]='\x01';
        bmpheader[27]='\x00';
        bmpheader[28]='\x18';
        bmpheader[29]='\x00';
        bmpheader[30]='\x00';
        bmpheader[31]='\x00';

        bmpheader[32]='\x00';
        bmpheader[33]='\x00';
        bmpheader[34]='\x00';
        bmpheader[35]='\x00';
        bmpheader[36]='\x00';
        bmpheader[37]='\x00';
        bmpheader[38]='\x5a';
        bmpheader[39]='\x37';

        bmpheader[40]='\x00';
        bmpheader[41]='\x00';
        bmpheader[42]='\x5a';
        bmpheader[43]='\x37';
        bmpheader[44]='\x00';
        bmpheader[45]='\x00';
        bmpheader[46]='\x00';
        bmpheader[47]='\x00';

        bmpheader[48]='\x00';
        bmpheader[49]='\x00';
        bmpheader[50]='\x00';
        bmpheader[51]='\x00';
        bmpheader[52]='\x00';
        bmpheader[53]='\x00';

        memcpy(&bmpheader[2],&bmrgbFilesize,4);
        memcpy(&bmpheader[18],&bmpWidth,4);
        memcpy(&bmpheader[22],&bmpHeight,4);

        fwrite( bmpheader, 1, 54, rgbFile );

        fwrite( pImage, 1, bmrgbFilesize, rgbFile );
        fclose( rgbFile );
        fclose( bayerFile );
        return(1);
    }
    return(-2);

} // end DumpImage()

int main(int argc, char* argv[]) 
{

    if(argc !=2)
    {
        printf("wrong number of arugments\n");
        printf("drag file to decode on top of program icon\n");
        return(-1);
    }
    else
    {
        printf("%s\n",argv[0]);
        printf("%s\n",argv[1]);
    }
/*
char *str = "sdfadabcGGGGGGGGG";
char *result = strstr(str, "abc");
int position = result - str;
int substringLength = strlen(str) - position;
*/
    char *widthStr = strstr(argv[1],"__")+2;
    int widthInt=atoi(widthStr);

    char *heightStr = strstr(widthStr,"x")+1;
    int heightInt=atoi(heightStr);

    char *bitsStr = strstr(heightStr,"_")+1;
    int bitsInt=atoi(bitsStr);

    char *formatStr = strstr(bitsStr,"_")+1;
    int formatInt=atoi(formatStr);

    //DumpImage( argv[1], bmpImage, widthInt, heightInt,bitsInt,formatInt);
    DumpImage( argv[1], bmpImage, widthInt, heightInt,bitsInt,2);
    printf("done\n");
    return 1;
} 
```

# c - 关于分段错误的建议，有效地使用 gdb，C 编程（新手）

> ID：14777956
> 
> 赞同：0
> 
> 时间：2013-02-08T17:21:33.543
> 
> 标签：c, segmentation-fault

我遇到了在 C 中工作的分段错误的问题，我无法弄清楚为什么会发生这种情况。我认为这与滥用 fget(c) 函数有关。

```
 while((ch = fgetc(fp))!= EOF) { 
printf("Got inside first while: character is currently %c \n",ch); //**********DELETE
  while(ch != '\n') {
char word[16]; //Clear out word before beginning   
i = i+1;          //Keeps track of the current run thru of the loop so we know what input we're looking at.
while(ch != ' ') { 
  printf("%c  ",ch); //**********DELETE
  //The following block builds up a character array from the current "word" (separated by spaces) in the input file.
  int len = strlen(word);
  word[len] = ch;
  word[len+1] = '\0';
  printf("%s",word);
  ch = fgetc(fp);
}

//The following if-else block sets the variables TextA, TextB, and TextC to the appropriate Supply Types from the input.
//This part may be confusing to read mentally, but not to trace.  All it does is logically set TextA, B, and C to the 3 different possible values SupplyType.
if(word!=TextB && word!=TextC && i==1 && TextB!="") {
  strcpy(TextA,word);
}
else if(word!=TextA && word!=TextC && i==1 && TextC!="") {
  strcpy(TextB,word);
}
else if(word!=TextB && word!=TextA && i==1) {
  strcpy(TextC,word);
}

switch(i) {
case 1:
  if(TextA == word) {
    SubTypeOption = 1;
  }
  else if(TextB == word) {
    SubTypeOption = 2;
  }
  else if(TextC == word) {
    SubTypeOption = 3;
  }
  break;
case 2:
  //We actually ultimately don't need to keep track of the product's name, so we do nothing for case i=2\.  Included for readibility. 
  break;
case 3:
  WholesalePrice = atof(word);
  break;
case 4:
  WholesaleAmount = atoi(word);
  break;
case 5:
  RetailPrice = atof(word);
  break;
case 6:
  RetailAmount = atoi(word);
  break;
}//End switch(i)        

ch = fgetc(fp);
  }//End while(ch != '\n')

//The following if-else block "tallys up" the total amounts of SubTypes bought and sold by the owner.

if(SubTypeOption == 1) {
  SubType1OwnersCost = SubType1OwnersCost + (WholesalePrice*(float)WholesaleAmount);
  SubType1ConsumersCost = SubType1ConsumersCost + (RetailPrice *(float)RetailAmount);
}
else if(SubTypeOption == 2) {
  SubType2OwnersCost = SubType2OwnersCost + (WholesalePrice*(float)WholesaleAmount);
  SubType2ConsumersCost = SubType2ConsumersCost + (RetailPrice *(float)RetailAmount);
}
else if(SubTypeOption == 3) {
  SubType3OwnersCost = SubType3OwnersCost + (WholesalePrice*(float)WholesaleAmount);
  SubType3ConsumersCost = SubType3ConsumersCost + (RetailPrice *(float)RetailAmount);
}

  }//End while((ch = fgetc(fp))!= EOF) 
```

使用**gdb**（只是*a.out*的简单运行）我发现问题与 getc 有关，但它不知道哪一行/哪一行。但是，我的程序确实输出“第一次进入一边：字符当前是 S”。这个 S 是我输入文件中的第一个字母，所以我知道它在某种程度上是按应有的方式工作的，但随后会导致段错误。

有没有人对可能出现的问题或如何调试此问题有任何建议？我对 C 语言比较陌生，主要对语法感到困惑。我有一种感觉，我做了一些小的语法错误。

顺便说一句，这段代码是为了从字符串中获取一个单词。示例：请帮我完成这个程序

## 应该给出等于“帮助”的词

更新：现在伙计们，我遇到了一个很酷的错误（虽然很神秘）。当我重新编译时，我得到了这样的东西：

单词现在是 w S 单词现在是 w Su 单词现在是 w Sup ... 等等，除了它会持续一段时间，建立一个单词金字塔。

## 我的输入文件中只有字符串“SupplyTypeA 1.23 1 1.65 1”。

更新：分段错误已修复（问题是，我使用 fgetc() 超出了文件末尾）。感谢大家。

如果有人仍然看这个，他们能帮我弄清楚为什么我的输出文件不包含它应该包含的任何正确数字吗？我想我可能在我得到的词上滥用了 atof 和 atoi 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:35:15.563

确保使用 -g -O0 选项编译程序

下一步在 GDB 中逐行浏览程序，观察并了解您的程序在做什么。查看各种变量。这是必不可少的调试技能。

当它死掉时，键入命令'k'，这会给你一个堆栈跟踪，跟踪的最后一行将有失败的行号，但你知道无论如何，因为你在线路上，你做了一个 step 命令

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T17:26:12.507

好的旧 C 语言中没有“fget”，但也许您使用的是更现代的版本，它有一个名为“fget”的东西。很可能，您打算使用“fgetc”。当 CI/O 函数以“f”开头时，它通常需要一个 FILE* 句柄作为参数，就像“fgetc”一样。在阅读了它的文档后，尝试使用“fgetc”。

# actionscript-3 - 对象名称中的变量

> ID：14777957
> 
> 赞同：0
> 
> 时间：2013-02-08T17:21:37.677
> 
> 标签：actionscript-3, variables, for-loop

是否可以通过对象实例名称中的变量获取对象的子对象？

`location_1`,`location_2`是包含`hidden_1`, `hidden_2`MC 等的 MC。

理想情况下，我希望在 for 循环中使用递增整数来定位隐藏对象。为了便于阅读，我在下面删除了 for 循环：

```
var i = 0;
var cacheNum = 0;    

var locMc = this["location_"+(i+1)]; // This works
var hiddenMc = locMc.this["hidden_"+(cacheNum+1)]; // This doesn't work! 
```

我最理想的可能是：

```
var i = 1;
var cacheNum = 1;

var hiddenMc = location_i.hiddenMc_cacheNum; 
```

非常感谢，尼克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T17:35:01.630

按名称访问对象的语法与按编号访问数组的语法相同：

```
object[value]; 
```

在数组的情况下，该值将是一个数字：

```
var myArray:Array = ["a", "b", "c"];
myArray[0]; // "a" 
```

在对象的情况下，该值将是一个字符串：

```
var myObject:Object = {"a": 1, "b": 2, "c": 3}
myObject["a"] // 1 
```

访问当前对象中的变量时，您必须使用`this`，如您的示例中所示。但是当使用不同的对象时，你只需直接使用括号表示法：

```
var hiddenMc = locMc["hidden_"+(cacheNum+1)]; 
```

如果对象是[DisplayObjectContainer](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObjectContainer.html)（如 Sprite 或 MovieClip）并且您正在访问的值是子项（如您的情况），您还可以使用[getChildByName](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObjectContainer.html#getChildByName%28%29)方法：

```
var hiddenMc = locMc.getChildByName("hidden_"+(cacheNum+1)); 
```

像任何表达式一样，您可以通过这种方式进行字符串访问：

```
this["location_"+(i+1)]["hidden_"+(cacheNum+1)] 
```

但正如你所看到的，这是不可读的，而且很容易出错。最好的方法是将那些隐藏的 MC 存储在一个数组中并从那里访问它们。它简化了代码，因为您在访问它们时不需要附加“hidden_​​”，通常更快，并且永远不会与其他具有相似名称的孩子发生冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T22:15:34.803

您试图通过允许代码操纵对象的内部工作来绕过封装。这样做后果自负。相反，为外部对象提供某种方式以在有限的基础上进行访问，或者能够要求包含这些值的对象代表调用者对它们执行工作：

```
public class Hidden()
{
    private var _hiddenValue:int = 5;
    public function get hiddenValue():int
    {
        return _hiddenValue;
    }
    public function screwWithTheHiddenValue():void
    {
        _hiddenValue += 25;
    }
}

public class Nosey()
{
    var hidden:Hidden = new Hidden();
    var result:int = hidden.hiddenValue;
    // result should be 5
    hidden.screwWithTheHiddenValue();
    result = hidden.hiddenValue;
    // result should now be 30;
} 
```

# android - 无法让谷歌地图在我的应用程序中显示在 Google 地方信息后面（仅网格）

> ID：14777962
> 
> 赞同：0
> 
> 时间：2013-02-08T17:21:57.670
> 
> 标签：android, google-maps, google-places-api, google-places

我从教程[Android Working with Google Places and Maps](http://www.androidhive.info/2012/08/android-working-with-google-places-and-maps-tutorial/)中获得了这段代码，我想更改它，因为我需要它与 google maps v2 一起使用。问题是，我只在谷歌地点后面得到一个网格，而不是地图。

PlacesMapActivity.java

```
package com.androidhive.googleplacesandmaps;

import java.util.List;

import android.content.Intent;
import android.graphics.drawable.Drawable;
import android.os.Bundle;
import android.util.Log;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapController;
import com.google.android.maps.MapView;
import com.google.android.maps.Overlay;
import com.google.android.maps.OverlayItem;

public class PlacesMapActivity extends MapActivity {
    // Nearest places
    PlacesList nearPlaces;

    // Map view
    MapView mapView;

    // Map overlay items
    List<Overlay> mapOverlays;

    AddItemizedOverlay itemizedOverlay;

    GeoPoint geoPoint;
    // Map controllers
    MapController mc;

    double latitude;
    double longitude;
    OverlayItem overlayitem;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.map_places);

        // Getting intent data
        Intent i = getIntent();

        // Users current geo location
        String user_latitude = i.getStringExtra("user_latitude");
        String user_longitude = i.getStringExtra("user_longitude");

        // Nearplaces list
        nearPlaces = (PlacesList) i.getSerializableExtra("near_places");

        mapView = (MapView) findViewById(R.id.mapView);
        mapView.setBuiltInZoomControls(true);

        mapOverlays = mapView.getOverlays();

        // Geopoint to place on map
        geoPoint = new GeoPoint((int) (Double.parseDouble(user_latitude) * 1E6),
                (int) (Double.parseDouble(user_longitude) * 1E6));

        // Drawable marker icon
        Drawable drawable_user = this.getResources()
                .getDrawable(R.drawable.mark_red);

        itemizedOverlay = new AddItemizedOverlay(drawable_user, this);

        // Map overlay item
        overlayitem = new OverlayItem(geoPoint, "Your Location",
                "That is you!");

        itemizedOverlay.addOverlay(overlayitem);

        mapOverlays.add(itemizedOverlay);
        itemizedOverlay.populateNow();

        // Drawable marker icon
        Drawable drawable = this.getResources()
                .getDrawable(R.drawable.mark_blue);

        itemizedOverlay = new AddItemizedOverlay(drawable, this);

        mc = mapView.getController();

        // These values are used to get map boundary area
        // The area where you can see all the markers on screen
        int minLat = Integer.MAX_VALUE;
        int minLong = Integer.MAX_VALUE;
        int maxLat = Integer.MIN_VALUE;
        int maxLong = Integer.MIN_VALUE;

        // check for null in case it is null
        if (nearPlaces.results != null) {
            // loop through all the places
            for (Place place : nearPlaces.results) {
                latitude = place.geometry.location.lat; // latitude
                longitude = place.geometry.location.lng; // longitude

                // Geopoint to place on map
                geoPoint = new GeoPoint((int) (latitude * 1E6),
                        (int) (longitude * 1E6));

                // Map overlay item
                overlayitem = new OverlayItem(geoPoint, place.name,
                        place.vicinity);

                itemizedOverlay.addOverlay(overlayitem);

                // calculating map boundary area
                minLat  = (int) Math.min( geoPoint.getLatitudeE6(), minLat );
                minLong = (int) Math.min( geoPoint.getLongitudeE6(), minLong);
                maxLat  = (int) Math.max( geoPoint.getLatitudeE6(), maxLat );
                maxLong = (int) Math.max( geoPoint.getLongitudeE6(), maxLong );
            }
            mapOverlays.add(itemizedOverlay);

            // showing all overlay items
            itemizedOverlay.populateNow();
        }

        // Adjusting the zoom level so that you can see all the markers on map
        mapView.getController().zoomToSpan(Math.abs( minLat - maxLat ), Math.abs( minLong - maxLong ));

        // Showing the center of the map
        mc.animateTo(new GeoPoint((maxLat + minLat)/2, (maxLong + minLong)/2 ));
        mapView.postInvalidate();

    }

    @Override
    protected boolean isRouteDisplayed() {
        return false;
    }

} 
```

GooglePlaces.java

```
package com.androidhive.googleplacesandmaps;

import org.apache.http.client.HttpResponseException;

import android.content.Context;
import android.util.Log;

import com.google.api.client.googleapis.GoogleHeaders;
import com.google.api.client.http.GenericUrl;
import com.google.api.client.http.HttpRequest;
import com.google.api.client.http.HttpRequestFactory;
import com.google.api.client.http.HttpRequestInitializer;
import com.google.api.client.http.HttpTransport;
import com.google.api.client.http.javanet.NetHttpTransport;
import com.google.api.client.http.json.JsonHttpParser;
import com.google.api.client.json.jackson.JacksonFactory;

@SuppressWarnings("deprecation")
public class GooglePlaces {

    /** Global instance of the HTTP transport. */
    private static final HttpTransport HTTP_TRANSPORT = new NetHttpTransport();

    // Google API Key
    private static final String API_KEY = "****my key is here*****"; // my API key Key for browser apps 

    // Google Places search url's
    private static final String PLACES_SEARCH_URL = "https://maps.googleapis.com/maps/api/place/search/json?";
    private static final String PLACES_TEXT_SEARCH_URL = "https://maps.googleapis.com/maps/api/place/search/json?";
    private static final String PLACES_DETAILS_URL = "https://maps.googleapis.com/maps/api/place/details/json?";

    private double _latitude;
    private double _longitude;
    private double _radius;

    /**
     * Searching places
     * @param latitude - latitude of place
     * @params longitude - longitude of place
     * @param radius - radius of searchable area
     * @param types - type of place to search
     * @return list of places
     * */
    public PlacesList search(double latitude, double longitude, double radius, String types)
            throws Exception {

        this._latitude = latitude;
        this._longitude = longitude;
        this._radius = 3000;

        try {

            HttpRequestFactory httpRequestFactory = createRequestFactory(HTTP_TRANSPORT);
            HttpRequest request = httpRequestFactory
                    .buildGetRequest(new GenericUrl(PLACES_SEARCH_URL));
            request.getUrl().put("key", API_KEY);
            request.getUrl().put("location", _latitude + "," + _longitude);
            request.getUrl().put("radius", _radius); // in meters
            request.getUrl().put("sensor", "false");
            if(types != null)
                request.getUrl().put("types", types);

            PlacesList list = request.execute().parseAs(PlacesList.class);
            // Check log cat for places response status
            Log.d("Places Status", "" + list.status);
            return list;

        } catch (HttpResponseException e) {
            Log.e("Error:", e.getMessage());
            return null;
        }

    }

    /**
     * Searching single place full details
     * @param refrence - reference id of place
     *                 - which you will get in search api request
     * */
    public PlaceDetails getPlaceDetails(String reference) throws Exception {
        try {

            HttpRequestFactory httpRequestFactory = createRequestFactory(HTTP_TRANSPORT);
            HttpRequest request = httpRequestFactory
                    .buildGetRequest(new GenericUrl(PLACES_DETAILS_URL));
            request.getUrl().put("key", API_KEY);
            request.getUrl().put("reference", reference);
            request.getUrl().put("sensor", "false");

            PlaceDetails place = request.execute().parseAs(PlaceDetails.class);

            return place;

        } catch (HttpResponseException e) {
            Log.e("Error in Perform Details", e.getMessage());
            throw e;
        }
    }

    /**
     * Creating http request Factory
     * */
    public static HttpRequestFactory createRequestFactory(
            final HttpTransport transport) {
        return transport.createRequestFactory(new HttpRequestInitializer() {
            public void initialize(HttpRequest request) {
                GoogleHeaders headers = new GoogleHeaders();
                headers.setApplicationName("AndroidHive-Places-Test");
                request.setHeaders(headers);
                JsonHttpParser parser = new JsonHttpParser(new JacksonFactory());
                request.addParser(parser);
            }
        });
    }

} 
```

我正在尝试很多事情，但无法让它发挥作用，即使我设法让谷歌地图显示在我的设备中的另一个项目中。我到底要改变什么？

我的日志猫

```
02-10 16:42:42.479: W/KeyCharacterMap(11974): Can't open keycharmap file
02-10 16:42:42.479: W/KeyCharacterMap(11974): Error loading keycharmap file '/system/usr/keychars/ft5x02-touchscreen.kcm.bin'. hw.keyboards.65538.devname='ft5x02-touchscreen'
02-10 16:42:42.479: W/KeyCharacterMap(11974): Using default keymap: /system/usr/keychars/qwerty.kcm.bin
02-10 16:42:54.067: D/Network(11974): Network Enabled
02-10 16:42:54.077: D/Your Location(11974): latitude:37.970373475, longitude: 23.772967
02-10 16:42:54.507: D/Places Status(11974): OK
02-10 16:42:57.917: D/Place(11974): Agora Ilission S.A.Chatzigianni Mexi 8, Athens, Greece21 0725 225237.97706123.751386
02-10 16:43:00.407: D/Place(11974): Piu VerdeΣτρατ. Αλ. Παπάγου, Athens, Greece21 0654 618537.99337223.794133
02-10 16:43:01.127: W/KeyCharacterMap(11974): Can't open keycharmap file
02-10 16:43:01.127: W/KeyCharacterMap(11974): Error loading keycharmap file '/system/usr/keychars/ft5x02-touchscreen.kcm.bin'. hw.keyboards.65538.devname='ft5x02-touchscreen'
02-10 16:43:01.127: W/KeyCharacterMap(11974): Using default keymap: /system/usr/keychars/qwerty.kcm.bin
02-10 16:43:02.497: W/MapActivity(11974): Recycling dispatcher com.google.googlenav.datarequest.DataRequestDispatcher@45202618
02-10 16:43:02.507: V/MapActivity(11974): Recycling map object.
02-10 16:43:02.617: I/MapActivity(11974): Handling network change notification:CONNECTED
02-10 16:43:02.617: E/MapActivity(11974): Couldn't get connection factory client 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-27T07:26:35.747

检查您的清单

是否添加了权限和使用库，如下所示

`<uses-permission android:name="android.permission.INTERNET"/>`在`manifest`标签和

`<uses-library android:name="com.google.android.maps" />`在`application`标签中

仔细检查您的设备是否能够连接到互联网。

# sql - SQL INNER JOIN 仅在第一次匹配时返回父行值

> ID：14777965
> 
> 赞同：0
> 
> 时间：2013-02-08T17:22:03.757
> 
> 标签：sql, oracle

伙计们，我所寻找的只是扩展 INNER JOIN。让我进入正题。我有两张桌子 Dept & Emp。一个部门可以有多个 Emp's 而不是相反。

```
餐桌部
Dept_id Dept_Name
1 IT
2 小时
3 其他

表 Emp
Emp_id Dept_id Emp_Name
11 1约翰
12 1 吉尔
13 2 杰克
14 3 贾里德
15 1 吉姆
16 1 贾雷特
17 2 雅各布

我需要在 Dept_id 上加入它

预期成绩
Dept_id Dept_name Emp_id Emp_Name
1 IT 11 约翰
NULL NULL 12 吉尔
NULL NULL 15 吉姆
NULL NULL 16 贾雷特
2 小时 13 杰克
NULL NULL 17 雅各布
3 其他 14 杰瑞德

```

希望我准确地传达了我想要的东西。它只是外键约束上的常规内部连接。但是，我希望第一个表（部门）中的值除第一个匹配项之外为 NULL。话虽如此，我不在乎第一场比赛是什么。见下文 - 只是 Dept_id 1 的结果。

```
预期结果（仅适用于 Dept_id = 1）
它可能是

Dept_id Dept_name Emp_id Emp_Name
1 IT 11 约翰
NULL NULL 12 吉尔
NULL NULL 15 吉姆
NULL NULL 16 贾雷特

或者

Dept_id Dept_name Emp_id Emp_Name
1 IT 15 吉姆
NULL NULL 12 吉尔
NULL NULL 11 约翰
NULL NULL 16 贾雷特

或者

另外两种可能。

```

提前致谢。很抱歉，尽管它是一个简单的案例，但解释很长。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T17:32:15.950

我同意IC。这是一个疯狂的查询，它似乎在做你的应用程序应该做的事情，而不是你的 sql 查询，话虽如此，编写这些查询很有趣 :)

```
SELECT CASE WHEN RowNumber = 1 THEN Dept_id ELSE NULL END AS Dept_id,
       CASE WHEN RowNumber = 1 THEN Dept_name ELSE NULL END AS Dept_name,
        Emp_id, Emp_Name
FROM Dept d
INNER JOIN 
(SELECT ROW_NUMBER() OVER (PARTITION BY Dept_id ORDER BY Emp_Name) AS RowNumber, 
       Dept_id, Dept_name, Emp_id, Emp_Name
FROM Emp ) t on t.Dept_id = d. Dept_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:30:52.483

老实说，我不确定你为什么想要这个结果。格式化通常最好留给 UI 层，而不是你的数据库服务器。这样做会使数据看起来像每个部门的非第一员工实际上没有部门，并且它从根本上破坏了您在客户中可能拥有的任何排序或编辑功能。

但是，您可以尝试：

```
SELECT FormattedDept.Dept_id, FormattedDept.Dept_Name, Emp.Emp_id, Emp.Emp_Name
FROM Emp
LEFT OUTER JOIN
(
    SELECT Dept.Dept_id, Dept.Dept_Name, MIN(Emp_id) AS Emp_id
    FROM Dept
    INNER JOIN Emp ON Dept.Dept_id = Emp.Dept_id
    GROUP BY Dept.Dept_id, Dept.Dept_Name
) FormattedDept ON Emp.Dept_id = FormattedDept.Dept_id
    AND Emp.Emp_id = FormattedDept.Emp_id
ORDER BY Emp.Dept_id, Emp.Emp_id 
```

[SQL 小提琴演示](http://www.sqlfiddle.com/#!4/bd800/57)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T17:33:05.763

```
select case
          when lag(d.dept_id) over (partition by d.dept_id order by e.emp_id) = d.dept_id then null
          else d.dept_id 
       end as dept_id,
       case
          when lag(d.dept_name) over (partition by d.dept_id order by e.emp_id) = d.dept_name then null
          else d.dept_name 
       end as dept_name,
       e.emp_id,
       e.emp_name
from dept d
  join emp e on e.dept_id = d.dept_id
order by d.dept_id, d.dept_name, e.emp_id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T17:33:24.830

正如我在上面的评论中提到的，我不确定您是否真的希望结果以您要求的方式返回。考虑一下。如果结果集被导出到 Excel，并且用户更改了排序，那么您将丢失员工 1-x 所在的部门，而员工 0 仍会显示他们的部门。我建议您按 Dept_id 分组，而不是将 dept_id 和 dept_name 归零。在显示代码中处理该数据的显示。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-08T17:35:13.453

```
WITH newRecord
AS
(
   SELECT "Emp_id", "Dept_id", "Emp_Name",
           ROW_NUMBER() OVER (PARTITION BY "Dept_id" ORDER BY "Emp_id" ASC) RN
   FROM Emp  
)
SELECT  CASE WHEN RN = 1 THEN b."Dept_id" ELSE NULL END AS "Dept_ID",
        CASE WHEN RN = 1 THEN b."Dept_Name" ELSE NULL END AS "Dept_Name",
        "Emp_id", "Emp_Name"
FROM    newRecord a 
        INNER JOIN Dept b ON a."Dept_id" = b."Dept_id" 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!4/bd800/29)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-10T15:11:05.050

因为我想不出你想要其他报告目的的原因，所以你也可以通过使用 SQL*Plus 格式化来做到这一点。

只需在 SQL*Plus 中的查询之前运行以下命令

```
break on dept_id skip 1 
```

享受。

# c# - ZedGraph 图表 - 缩放数据以适合整个图表区域？

> ID：14777968
> 
> 赞同：2
> 
> 时间：2013-02-08T17:22:21.420
> 
> 标签：c#, winforms, zedgraph

![描述问题的图片](../Images/0a7dd957786c4cc5d28b40ed5bc8c8f8.png)

我希望数据（X 轴）始终跨越整个图形窗格。是否有执行此操作的属性或方法？

以下是我为 X 轴设置的一些属性：

```
myPane.XAxis.Title.IsVisible = false;
myPane.XAxis.MajorGrid.IsVisible = true;
myPane.XAxis.Type = AxisType.DateAsOrdinal;
myPane.XAxis.MajorGrid.Color = Color.Black; 
```

任何帮助是极大的赞赏。

**编辑解决方案：**

```
private PointPairList ppl;
...
GraphPane myPane = zedChartControl.GraphPane;
myPane.XAxis.Scale.MaxAuto = true;
myPane.XAxis.Scale.MinAuto = true;
myPane.XAxis.Scale.Min = 1;
myPane.XAxis.Scale.Max = Convert.ToDouble(ppl.Count); 
```

局部变量`ppl`由X 和 Y`PointPairList (double x, double y)`组成。`XDate`

设置`XAxis.Scale.Min = 1;`将开始 X 值设置为`ppl[0]`

Settings`XAxis.Scale.Max = Convert.ToDouble(ppl.Count);`将结束值设置为最后一个 ppl 项（即 ppl[34]）

X 轴的整个跨度现在将是 1-34。

这是使用不同图表的结果：

![问题解决了](../Images/dbb19e8f5b6f2f0f7eed4bad1e087e09.png)

有时答案比预期的要简单得多。

# ios5 - 在 iOS 6 中禁用键盘状态？

> ID：14777973
> 
> 赞同：1
> 
> 时间：2013-02-08T17:22:46.207
> 
> 标签：ios5, uiview, ios6, uitextview, first-responder

我已经实现了一个类似于股票消息应用程序的“令牌”或“芯片”文本字段，用户在其中输入成为彩色令牌的条目。当用户按下退格键时，它会突出显示该标记，然后再按一个退格键将其删除。这一切都适用于 iOS 5。

然而，在 iOS 6 上，一旦我的标记（基于 UIView）被突出显示，并且它们调用 becomeFirstResponder，键盘就会被禁用，如下所示。在使用“硬件键盘”在模拟器中进行测试时，一切正常，但设备上的真实用户无法再次按退格键，因为它已被禁用。

如何避免这种情况？我什至应该寻找什么电话/属性？在我的研究中，我无法找到这种模式的名称或使用方式。

谢谢！

![iOS 5 正常运行](../Images/5eb53234738567c3a6e59cb7b4de9c8a.png) ![带有禁用键盘的 iOS 6](../Images/942bce8a243451ea37fbfc23acbbc93f.png)

# php - 是否有任何简单的功能可以重新调整存储在数据库中的图像大小，让访问者看到小图像而不是原始大小

> ID：14777976
> 
> 赞同：1
> 
> 时间：2013-02-08T17:22:49.823
> 
> 标签：php, imagemagick

我需要一些帮助来通过更简单的功能将原始高分辨率图像重新调整为更小的图像以确保安全。

`file_get_contents( $image )`在以 LONG BLOB 格式将其插入 MYSQL 之前，我已经使用过该函数。

现在，我可以通过 HTML 标记的高度和宽度属性显示具有给定尺寸的图像，现在显示的图像可以以其原始大小下载（即通过右键单击和保存图像选项保存）。

因此，我需要在显示之前使用一个函数来更改该图像的尺寸。是否有可能将图像保留为缩略图？

我不想保留两张图片（一张用于缩略图，另一张用于数据库中的可下载图像）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:24:18.450

你看过 PHPs GD 库吗？

[`imagecopyresampled`](http://php.net/manual/en/function.imagecopyresampled.php)是您可以使用的功能之一

# sql - 为 SQL 数据库绑定自定义注册和 facebook 登录

> ID：14777977
> 
> 赞同：0
> 
> 时间：2013-02-08T17:22:53.480
> 
> 标签：sql, facebook

我正在尝试创建一个带有 SQL 数据库连接的应用程序。像其他应用程序一样，用户应该可以选择自定义注册（电子邮件、密码）和 Facebook 登录。

如果用户选择自定义登录，那很好，但如果用户选择 facebook 登录，我的应用程序将能够从 facebook 检索电子邮件但没有密码。

在大多数应用程序中，如果您选择 facebook 登录，则在使用 facebook 登录后，您无需再次处理注册和登录（单点登录和访问令牌）。

但是其他应用程序如何让用户在不选择密码的情况下注册？他们是否让数据库中的密码字段为空（这似乎不可行）？还是他们为用户创建一个随机密码并将其保存到用户设备？如果用户注销或删除他们的 Facebook 帐户并想登录我的应用程序，他们将如何在没有密码的情况下登录，因为他们首先选择了 Facebook 登录？

我知道多个问题，但它们都是相关的，我很难理解这个简单的任务。

谢谢 M. Fustang

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T18:36:55.917

一般来说，如果您允许人们使用 Facebook 注册，您可以强制他们在第一次登录时设置他们的用户名和密码。并且只需将 Facebook 中的用户 ID 作为用户表中的一列与用户名和密码一起存储由用户提供。然后允许他们使用此用户/传递您网站的数据或使用 Facebook 登录。这将允许您的用户即使在 Facebook 的帐户被删除后也能登录。

# c# - 为什么 IS 检查不适用于数据行

> ID：14777983
> 
> 赞同：0
> 
> 时间：2013-02-08T17:23:09.670
> 
> 标签：c#

我有一个数据行，其中一列中有一个整数。但是，以下代码不会评估为 true。我很难理解为什么。我错过了什么？

```
foreach (DataRow dr in dataset.Tables[0].Rows)
{
    //this evaluates as false, even when I have a valid castable INT value in the column (as an object).
    if (dr[3] is int)
    {
        if (Convert.ToInt32(dr[3]) == 3)
        {
            //do something with row

        }
        else if (Convert.ToInt32(dr[3]) == 4)
        {
            //do someting else with row

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T17:28:46.337

正如其他人所说，您可能有一个可以转换为 int 的字符串*，*但不能转换为 int。

尝试这个：

```
int val;

if (Int32.TryParse(dr[3].ToString(), out val)) { 
```

# cocoa - 如何在 CGPath 或 NSBezierPath 上添加随机透明点

> ID：14777984
> 
> 赞同：0
> 
> 时间：2013-02-08T17:23:16.587
> 
> 标签：cocoa, quartz-graphics, cgpath, nsbezierpath

想知道如何在 或 上添加透明点或`CGPath`线`NSBezierPath`。以下是有关该问题的更多详细信息。我有一条实线说 width = 30(drawn using `NSBezierPath`or `CGPath`) ，现在我想在它上面绘制透明点或透明线（厚度 = 2 或小于 30 的东西）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T01:31:55.783

您可以枚举 NSBezierPath 或 CGPath 的元素，并为每个元素做一些事情。

对于 NSBezierPath，使用`elementCount`、`elementAtIndex:associatedPoints:`和`for`循环。`elementAtIndex:associatedPoints:`需要一个最多三个`NSPoint`s的C 数组。

对于 CGPath，使用`CGPathApply`. 这需要一个指向您编写的 C 函数的指针。该函数的两个参数之一是一个结构，它包含由 返回的相同信息`elementAtIndex:associatedPoints:`，除了它将为您创建点数组。

它们之间的元素类型基本相同：

*   A`moveto`或`lineto`携带一分。

    您可能想知道为什么 a`lineto`没有两个点。与元素相关联的点是目标点——*到*in——即紧随其后的`lineto`新当前点。另一点，你来自的那一点，是隐含的。如果你想使用它，你只需要记住最后一个当前点。

*   A（三次）`curveto`使用所有三个点。

    与 一样`lineto`，源点是隐含的，只是最后一个当前点。数组中的最后一个点是目标锚点；另外两个点是控制点。

*   Core Graphics 有二次`curveto`元，它只有两个点。

    一个立方体`curveto`有两个控制点和一个锚点；二次方只有一个控制点和一个锚点。

    NSBezierPath 没有二次`curveto`元素。NSBezierPath 中的所有`curveto`元素都是立方的。

*   A`closepath`没有积分。它返回到最后一个点`moveto`。

无论哪种方式，**对于每个元素，绘制您想要的任何锚点指示符**。例如，您可以在目标点绘制一个蓝色圆圈，而不为 a 绘制任何东西`closepath`（因为您在遇到匹配时已经绘制了它`moveto`）。对于`curveto`元素，您可能还想为两个控制点中的每一个绘制一个指示器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T14:52:22.757

使用`-bezierPathByFlatteningPath`.

一旦你已经扁平化了接收器的副本，计算它的长度。

然后，遍历展平的副本，这基本上是一个点数组。跟踪连续点之间的距离，以便您可以看到您在曲线上的确切位置。

例如，如果您想绘制一个对象的多个副本，您必须找到该对象将驻留在展平副本的哪个段上。找到该段后，在该段的两端之间进行线性插值以找到确切的位置。

![在 NSBezierPath 上分布对象](../Images/b680cd8c416ea59917f428b45164a07b.png)

如果这是您想要实现的目标，我可以稍微详细说明并发布我编写的用于执行此操作的类别。

# jquery - 使用 jquery 从外部从 iframe 读取内容

> ID：14777988
> 
> 赞同：0
> 
> 时间：2013-02-08T17:23:37.907
> 
> 标签：jquery, html, iframe

我有 2 个 HTML 文档：1 个主文档，其中有一个显示第二个 HTML 页面的 iframe。

我想从父文档访问 iframe 的内容。我试过使用`find()`and `contents()`，但它对我不起作用。

这是我的代码：

**主要文件**

```
<!DOCTYPE html>
<html>

<head>
<script src="./js/gjquery.js"></script>

<script type="text/javascript">
$(function(){
  $('#123').click(function(){
 alert("Testing...");
 var v = $('#frameDemo').contents().find('body').html();
 alert(v);
});
})
</script>

</head>

<body>
  <button id="123" >mad</button>
  <iframe src="./1.htm" width="80%" height="20%" id='frameDemo'></iframe> 
</body> 
```

**iframe 文档**

```
<html>
<head></head>

<body>
<p>Hello <a href="http://ejohn.org/">John</a>, how are you doing?</p>

<table width="700" border="1" id="test"> 
<tr><td>g</td><td>ggg</td></tr>
<tr><td>g</td><td>ggg</td></tr>
<tr><td>g</td><td>ggg</td></tr>
</table>

<p>Hello world!</p>
<div id="someID">Hello world!</div>

</body>
</html> 
```

`find()`无论我尝试使用哪个选择器，都不会返回任何结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:57:44.567

只要两个 html 页面都托管在**同一个域中**，在 iframe 中选择元素就可以正常工作。我试过你的代码，对我来说效果很好。

但是，如果 iframe 中的页面托管在**不同的域上，由于**[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，外框将无法访问内框

如果是这种情况，您将在控制台中看到与此类似的错误：

"**不安全的 JavaScript 尝试从 URL localhost/jqueryIframe/jqueryIframe.html 的框架访问具有 URL [http://www.bing.com/](http://www.bing.com/)**的框架。域、协议和端口必须匹配。 "

# python - 如何在 django ModelAdmin 字段集中调用模型方法？

> ID：14777989
> 
> 赞同：17
> 
> 时间：2013-02-08T17:23:38.937
> 
> 标签：python, django, django-models, django-admin

当数据库中已经存在数据时，我想在管理表单上显示嵌入式地图。我有以下代码：

模型.py

```
class Address(models.Model):
    address = models.CharField()

    def address_2_html(self):
        if self.address:
            # Return html for an embedded map using the entered address.
            return embedded_map_html
        else:
            return ''
    address_2_html.allow_tags = True 
```

管理员.py

```
class AddressAdmin(admin.ModelAdmin):
    fieldsets = [(label, {'fields': ['address','address_2_html']}),] 
```

这行不通。我收到一个错误：

```
'AddressAdmin.fieldsets[1][1]['fields']' refers to field 'address_2_html' that is missing from the form. 
```

我尝试的另一件事是使用'fieldsets'的'description'选项，但是，在AddressAdmin的范围内无法访问'address_2_html'。我确实成功地使用“描述”嵌入了静态地图，这很酷但还不够酷。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-08T17:41:33.827

像那样（从记忆中）：

```
class AddressAdmin(admin.ModelAdmin):
    fieldsets = [(label, {'fields': ['address','address_2_html']}),]
    readonly_fields = ['address_2_html']

    def address_2_html(self, obj):
        return obj.address_2_html()
    address_2_html.allow_tags = True
    address_2_html.short_description = 'Address display' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T17:46:47.293

通过覆盖 get_fieldsets() 解决了问题，因为 get_fieldsets() 方法允许访问模型对象地址。

```
def get_fieldsets(self, request, obj=None):
    fs = [
        (self.label,  {'fields': ['address',]}),
        ('Map', {'fields': [], # required by django admin
                'description':obj.address_2_html(),
         }),
    ]
    return fs 
```

# wordpress - 如何在 wordpress 中更改现有博客的根 url

> ID：14777993
> 
> 赞同：0
> 
> 时间：2013-02-08T17:23:56.113
> 
> 标签：wordpress, url

我在开始使用 WordPress 时犯了错误并且没有更改我的根 URL，现在我的博客有大约 30 页，我需要更改根 URL。

*   我的wordpress位于：

    `C:\Program Files (x86)\Apache Software Foundation\Apache2.2\htdocs\wordpress`

*   我的博客仍然是以下主题：

    `...\htdocs\wordpress\wp-content\themes\myblog`

*   我的域名网址：

    `http://www.myblog.co.il/wordpress/wp-admin`

*   `index.php`位于：

    `...\htdocs\wordpress\wp-content\themes\myblog\index.php`

当我运行我的主页时，`index.php`我看到`http://www.myblog.co.il/wordpress` 所有生成的永久链接看起来像： `http://www.myblog.co.il/wordpress/?page_id=158`... 。

**主要问题是：如何改变：**

`http://www.myblog.co.il/wordpress` **到**“ `http://www.myblog.co.il/`”**以自动更改所有永久链接？**呃`http://www.myblog.co.il/?page_id=158`……

我从一开始就看到了足够多的解决方案，但在博客准备好时却没有。

请帮我找到合适的解决方案。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:32:05.920

你试着改变`siteurl`并`home`在你的`options`桌子上？

我不确定理解您的意思，但[移动 WordPress](http://codex.wordpress.org/Moving_WordPress)上的页面可能会对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:39:51.867

首先你们必须在 Apache 中配置一个虚拟主机，以将域与您的 htdocs\wordpress 文件夹匹配，而不仅仅是与 \htdocs。[您可以在此处](http://httpd.apache.org/docs/2.2/vhosts/)阅读有关 apache 中虚拟主机的更多信息。

由于 Wordpress 将所有 URL 以其绝对形式保存到数据库中，因此您必须通过替换数据库中的 URL 来手动修复此问题。假设您正在运行 MySQL 并且您博客的当前 URL 是[http://www.myblog.co.il/wordpress](http://www.myblog.co.il/wordpress)，您可以使用以下查询：

```
UPDATE wp_posts SET post_content = REPLACE(post_content, 'http://www.myblog.co.il/wordpress', 'http://www.myblog.co.il');
UPDATE wp_posts SET guid = REPLACE(guid, 'http://www.myblog.co.il/wordpress', 'http://www.myblog.co.il');
UPDATE wp_options SET option_value = 'http://www.myblog.co.il' WHERE option_name = 'home' OR option_name = 'siteurl'; 
```

这不仅可以修复硬编码链接，还可以修复页面和帖子内容中的自定义链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T17:37:30.223

假设根`htdocs`目录中没有其他内容，即如果您`http://www.myblog.co.il/`什么都不显示，请通过管理后端（或通过 MySQL`wp_options`表）更新您的 URL，并将目录中的所有内容移`wordpress`回`htdocs`目录中。

# python - 无法将浮点数转换为十进制。首先将浮点数转换为字符串

> ID：14777997
> 
> 赞同：0
> 
> 时间：2013-02-08T17:24:10.090
> 
> 标签：python, django, decimal

我收到以下错误：

> 02/08 09:15:45> 十进制价格：0.00
> 
> 02/08 09:15:45> 十进制价格 = 无
> 
> TypeError：无法将浮点数转换为十进制。首先将浮点数转换为字符串

这是我的代码：

```
 s.price = Decimal("%.2f" % (float(request.data['subscription_price'])))
            log('Decimal price: %s' % s.price)

            if s.price == Decimal("0.00"):
                s.price = None
                log('Decimal price = None') 
```

关于我做错了什么的任何想法？我尝试了一种技巧，以避免通过“if s.price == Decimal("0.00"):" ...在数据库中保存 0.00 无济于事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T18:14:24.893

如果要将浮点数转换为小数点后两位的小数，这是工作代码：

```
import Decimal
In [10]: a = 7.3656
In [11]: Decimal(a).quantize(Decimal('.01'))
Out[11]: Decimal('7.37') 
```

有关使用十进制数字的更多信息，您可以在此处找到：http: [//docs.python.org/2/library/decimal.html](http://docs.python.org/2/library/decimal.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-09T16:14:29.347

```
if str(s.price) == str(Decimal("0.00")):
   s.price = None
   log('Decimal price = None') 
```

# android - Android如何在textview中适应textsize

> ID：14777999
> 
> 赞同：0
> 
> 时间：2013-02-08T17:24:16.160
> 
> 标签：android

这是我的代码：

```
<LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="120dp"
                android:orientation="vertical"
                android:layout_weight="3" 
                android:weightSum="4">

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="0dp"
                    android:layout_weight="1"
                    android:text="P" />
                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="0dp"
                    android:layout_weight="2"
                    android:text="Bryant" />
                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="0dp"
                    android:layout_weight="1"
                    android:text="27" />
            </LinearLayout> 
```

当外部布局的高度为120dp 时，文本无法显示整个单词（例如'y' 只显示上部），我认为是因为文本大小太大。
但是，当我设置为 150dp 时，文本可以显示整个单词。
是否有任何方法来设置文本的文本大小自动适应文本视图以显示整个单词。
我不想将 textsize 硬编码为 12sp。
而且，我只想在 xml 中做。
谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T18:32:22.110

不幸的是，没有简单的方法可以自动调整 TextView 的字体大小。我建议将 TextView 的 wrap_content 设置为高度，而不是静态高度。

如果您发现屏幕上没有足够的空间，也许将整个东西包裹在一个 ScrollView 中？

```
<ScrollView android:layout_width="fill_parent" android:layout_height="120dp">
    <LinearLayout android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" 
            android:text="P" />
        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" 
            android:text="Bryant" />
        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" 
            android:text="27" />
    </LinearLayout>
</ScrollView> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T18:41:25.567

Not only there is no auto fit for text, but the implementation is also [not trivial](https://stackoverflow.com/questions/7549182/android-paint-measuretext-vs-gettextbounds).

I'd recommend another UI approach altogether. This is going to bring you headache after headache.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T18:36:26.177

没有办法自动更改字体大小以调整文本以适应特定大小。