# StackOverflow 问答 14947000-14947999

# java - 如何在 Junit 中调用数据源

> ID：14947007
> 
> 赞同：0
> 
> 时间：2013-02-18T23:11:50.560
> 
> 标签：java, jsf, testing, junit

我有一个带有 JSF 页面的 Maven WAR 包。通常我使用

```
@Resource(name = "jdbc/Oracle")
    private DataSource ds; 
```

在 Glassfish 服务器上部署 WAR 包时调用数据库。但是，当我在笔记本电脑上使用 netbeans 构建包时，如果进行 JUnit 测试，我将无法使用此数据源。我该如何解决这个问题？我想在构建包后立即使用数据库表运行 JUnit 测试，但我没有数据源。有哪些可能的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T23:29:28.903

你真的想对数据库运行单元测试吗？我个人会尽量避免这种情况，因为它通常将测试与数据库状态联系得太紧密，并且经常阻止您实际测试“单元”以及您可能想要处理的所有可能状态。它还可能使您的单元测试需要一些时间才能运行，这并不理想。

另一种方法是创建一个模拟`DataSource`，例如使用[EasyMock](http://www.easymock.org/)或[Mockito](http://code.google.com/p/mockito/)。`DataSource`或者，如果您知道要为`DataSources`许多测试定义一些通用行为，您可以创建自己的接口模拟实现。

如果您真的想使用数据库，您将不得不查看手动实例化`DataSource`您正在使用的任何实现（例如`OracleDataSource`），然后在您的类中使用它。

在任何一种情况下，您可能都必须切换到使用[构造函数或方法注入](http://docs.oracle.com/javaee/6/tutorial/doc/bncjk.html)，以便更容易`DataSource`在您正在测试的实例上设置。（否则你将不得不使用反射来设置私有变量。）

例如，您的课程可能如下所示：

```
public class DatabaseOperations {
    private DataSource dataSource;

    @Resource(name = "jdbc/Oracle")
    public void setDataSource(DataSource dataSource) {
        this.dataSource = dataSource;
    }
} 
```

然后您的测试可能如下所示：

```
public class DatabaseOperationsTest {
    public void testSomeOperation() {
        DatabaseOperations databaseOperations = new DatabaseOperations();
        databaseOperations.setDataSource(new MockDataSource());
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T02:37:32.190

如果您确实需要使用注入的 DataSource 运行测试，您可以考虑使用 Arquillian，它将为您创建一个部署单元，将其部署到嵌入式或远程 Glassfish 容器，如果您愿意，还可以配置一个专门用于测试的 DataSource。他们有针对这种特定情况的[指南。](http://arquillian.org/guides/testing_java_persistence/)

优点是您将拥有一个带有 CDI 的成熟容器。您可以控制获取包的内容，以便为 CDI 类提供测试存根。您还可以控制部署配置（测试与生产配置）。它是非侵入性的。

# model-view-controller - MVC 和 Crud Coldfusion 10

> ID：14947012
> 
> 赞同：4
> 
> 时间：2013-02-18T23:12:00.970
> 
> 标签：model-view-controller, coldfusion, coldfusion-10

我是 ColdFusion 的忠实粉丝，只是有一段时间没有使用它。当我过去构建站点时，我会使用 Illudium PU-36 代码生成器来创建基于 MYSQL 的 MVC 编码。它工作得很好，但是当我回到 ColdFusion 时，它不适用于 CF10。离开 ColdFusion 世界有一段时间了，我不确定事情是如何完成的。

我喜欢 PU-36 生成器从数据库中布局基本结构 (MVC) 的方式，我可以从那里开始——即使每次更改都需要一些工作。我仍然了解起始结构以及如何从那里进行更改。它提供了一个良好的开端。

ColdFusion的休眠部分是我应该看的。

我喜欢基于生成器的 MVC 基础知识。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T04:35:08.260

据我所知，PU-36 只处理数据抽象层，与 MVC 没有任何关系。如今，CF10 中的 Hibernate 包装器将为您取代所有这些。

就 MVC 方面而言，有一堆框架，最适合你的是主观的东西，所以你可能需要在那里进行自己的调查。我对[Coldbox](http://www.coldbox.org/)有点搞砸了，但我觉得它有点重（它做得太多了）。然而，其他人对此发誓。[我对Framework One](http://fw1.riaforge.org/)有一个肤浅的了解，它更轻巧，更符合我想要的框架（主要是不碍事的）。还有很多其他的，谷歌会帮你调查。

# .net - Sharepoint 2010 .net 3.5 与 win 7 上的 .net 4.0 Web 应用程序位于同一默认网站的问题

> ID：14947013
> 
> 赞同：0
> 
> 时间：2013-02-18T23:12:06.973
> 
> 标签：.net, windows-7, sharepoint-2010

我在 Windows 7 上安装了 SharePoint 2010 (.net 3.5)。但问题是我在默认网站中有其他不相关的 .net 4.0 Web 表单应用程序。那里存在 SharePoint 2010 的东西。我在尝试创建 SharePoint 网站页面时遇到错误。Web 表单应用程序也不运行。我认为原因是 .net 3.5（SharePoint 虚拟目录）和 .net 4.0 Web 应用程序混合在默认网站下。

注意：Sharepoint 2010 位于具有 v2.0 .net 框架版本的 DefaultAppPool 中

如何将 .net 4.0 Web 应用程序或 SharePoint 内容移动到另一个默认网站？如何创建默认网站2？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T23:26:47.473

为了让 Sharepoint 2010 正确安装，我必须将 IIS appPool 默认设置从 .net 4 更改为 .net 2、Integrated 并将 32 位设置为 false。然后安装顺利。

# data-structures - 有没有类似 BidiMap 的东西？

> ID：14947014
> 
> 赞同：3
> 
> 时间：2013-02-18T23:12:07.510
> 
> 标签：data-structures, go

嗨，我需要做一些双向锁定，并且需要一些地图结构，比如 map[key][key]，Go 中有这样的想法吗？或者最好的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T23:14:49.297

语言或库 (AFAIK) 中没有这样的东西，但它们很容易实现：只需将两个映射组合在一起`struct`并确保它们保持同步。唯一的问题是很难以通用方式编写这些，但*可以*使用`interface{}`：

```
type BidirMap struct {
    left, right map[interface{}]interface{}
}

func (m *BidirMap) Insert(key, val interface{}) {
    if _, inleft := left[key]; inleft {
        delete(left, key)
    }
    if _, inright := right[val]; inright {
        delete(right, val)
    }
    m.left[key] = val
    m.right[val] = key
} 
```

等等

# c - 动态内存分配功能

> ID：14947016
> 
> 赞同：-2
> 
> 时间：2013-02-18T23:12:07.577
> 
> 标签：c

```
int **Matrix_B1;  

Matrix_B1 = (int**)malloc(RowB*(sizeof(int*)));  

for (int p=0; p<RowB; p++)  
{  
    Matrix_B1[p] = (int*)malloc(ColumnB*(sizeof(int)));   
} 
```

如何在 c 中创建一个函数来执行动态内存分配？

我有很多这样的矩阵，我不想继续写同样的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T23:24:04.350

诠释 *Matrix_B1;

int matrixSize = Rowb * ColumnB; Matrix_B1 = int(*)malloc(matrixSize*sizeof(int));

// 将值写入矩阵 - Matrix_B1[4] = $Value;

// 如果有很多矩阵，你可以将每个矩阵的指针存储在一些数组 pf 指针中。每个矩阵都实现为二维数组，其内存是动态分配的。您可以以行或列的方式访问数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T23:26:36.533

只需像往常一样使用函数。请记住跟踪尺寸。还记得完成后释放！

```
#include <stdlib.h>

int **Create2x2Matrix(int rowB, int columnB)
{
    int **matrix = (int**)malloc(rowB*(sizeof(int*)));
    for (int p=0; p<rowB; p++)  
    {  
        matrix[p] = (int*)malloc(columnB*(sizeof(int)));   
    }
    return matrix;
}

void Destroy2x2Matrix(int **matrix, int rowB)
{
    for (int p=0; p<rowB; p++)  
    {  
        free(matrix[p]);
    }
    free(matrix);
}

int main()
{
    int rowB = 10;
    int columnB = 11;
    int **matrix_B1 = Create2x2Matrix(rowB, columnB);
    Destroy2x2Matrix(matrix_B1, rowB);
    return 0;
} 
```

# php - 浏览器不显示 utf-8 字符

> ID：14947017
> 
> 赞同：0
> 
> 时间：2013-02-18T23:12:14.467
> 
> 标签：php, utf-8, character-encoding, mysqli

我有一些`php`包含 utf-8 字符的文件。这些文件使用`utf-8`编码保存。我还专门将页面设置`charset`为 UTF-8。如果直接在源代码中输出，浏览器会正确显示它们。但是当从我的表中获取字段数据`MySQL`（使用`mysqli`连接）时，会显示问号而不是内容。有谁知道它可能是什么？我假设它与数据库交互有关？

HTTP 响应标头：

```
HTTP/1.1 200 OK
Date: Mon, 18 Feb 2013 23:05:13 GMT
Server: Apache/2.2.22 (Unix) DAV/2 PHP/5.4.9
X-Powered-By: PHP/5.4.9
Content-Length: 2161
Keep-Alive: timeout=15, max=100
Connection: Keep-Alive
Content-Type: text/html; charset=utf-8 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T23:50:23.763

重新安装 mysql 服务器并启用 utf-8 支持，这通常发生在 localhost

# ios - 在 UIView 之外绘图

> ID：14947020
> 
> 赞同：13
> 
> 时间：2013-02-18T23:12:56.910
> 
> 标签：ios, uiview

我有一个 UIView，我想在其中绘制一个延伸到 UIView 框架之外的 Circle，我已将 maskToBounds 设置为 NO - 期望我可以在 UIView 的边界之外在右侧和底部绘制 5 个像素。

我希望椭圆不会被剪裁，但它会被剪裁并且不会超出界限？

```
- (void)drawRect:(CGRect)rect
{

    int width = self.bounds.size.width;
    int height = self.bounds.size.height;
    self.layer.masksToBounds = NO;

    //// Rounded Rectangle Drawing
    //// Oval Drawing
    UIBezierPath* ovalPath = [UIBezierPath bezierPathWithOvalInRect: CGRectMake(0, 0, width+5, height+5)];
    [[UIColor magentaColor] setFill];
    [ovalPath fill];
    [[UIColor blackColor] setStroke];
    ovalPath.lineWidth = 1;
    [ovalPath stroke];

} 
```

![在此处输入图像描述](../Images/215252de961e29015c581851a1491247.png)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-18T23:57:24.023

来自[http://developer.apple.com/library/ios/#documentation/general/conceptual/Devpedia-CocoaApp/DrawingModel.html](http://developer.apple.com/library/ios/#documentation/general/conceptual/Devpedia-CocoaApp/DrawingModel.html)

> UIView 和 NSView 在调用 drawRect: 方法之前自动配置视图的绘制环境。（在 AppKit 框架中，配置绘图环境称为锁定焦点。）作为此配置的一部分，视图类为当前绘图环境创建图形上下文。
> 
> 此图形上下文是一个 Quartz 对象 (CGContext)，其中包含绘图系统所需的信息，例如要应用的颜色、绘图模式（笔触或填充）、线宽和样式信息、字体信息和合成选项。（在 AppKit 中，NSGraphicsContext 类的对象包装了 CGContext 对象。）图形上下文对象与窗口、位图、PDF 文件或其他输出设备相关联，并维护有关该实体的绘图环境当前状态的信息. 视图使用与视图窗口关联的图形上下文进行绘制。**对于视图，图形上下文将默认剪切区域设置为与视图边界重合，并将默认绘图原点置于视图边界的原点。**

一旦设置了剪辑区域，您只能将其缩小。所以，你想要做的事情在 UIView drawRect 中是不可能的：。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T23:17:16.850

我不确定这是否会解决您的问题，但需要研究一下。您`self.layer.masksToBounds = NO`每次输入时都在设置`drawRect`。您应该尝试在 init 方法中设置一次，A）因为没有必要多次这样做，B）因为在`drawRect`已经调用之后设置它可能存在问题 - 谁知道。

# git - 虚拟卷上的 Git init

> ID：14947022
> 
> 赞同：2
> 
> 时间：2013-02-18T23:13:01.370
> 
> 标签：git, ftp, osx-mountain-lion

我在我的 Mac 上通过 Transmit 安装了一个（FTP）文件夹作为一个卷。它是完全可访问的，我可以使用终端应用程序浏览目录。

但是我不能`git init`在没有收到错误消息的情况下打电话：

```
/Volumes/FTPVolume/doc/.git: No such file or directory 
```

该`.git`文件夹应通过此调用创建，因此错误消息对我来说没有多大意义。我可以通过这个调用在我的本地卷上设置一个 git 存储库。

当我尝试将文件夹连接到 git 时，例如

```
git remote add origin https://username@bitbucket.org/repositoryowner/project.git 
```

然后我收到错误消息

```
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set). 
```

一个问题与另一个问题有关吗？更重要的是，是否可以在虚拟卷上初始化 git 存储库？

我正在使用 Mac Mountain Lion 并通过应用程序 Transmit 创建音量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T06:35:37.087

您描述的症状表明您没有对 FTP 挂载的写访问权限，或者该挂载不支持 git 用于管理文件/目录的文件系统挂钩。第二个错误虽然听起来很神秘，但只是意味着“git remote”命令也找不到 .git 文件夹。造成具体错误的原因是当 git 在当前目录中没有找到它时，它会向上遍历并检查所有父目录，直到找到文件系统边界。因此，这应该可以帮助您理解错误。

为了帮助您到达我认为您正在尝试的地方：我猜您真正想要做的是通过 git push 将 FTP 服务器上的代码获取到您的远程存储库中。为此，请从您的主目录或已挂载的 FTP 卷以外的其他位置尝试以下操作：

```
mkdir my_ftp_project
cd my_ftp_project
git init
git remote add origin https://username@bitbucket.org/repositoryowner/project.git
export GIT_DIR=`pwd`/.git/
cd /Volumes/FTPVolume/doc/
git add .
git commit -m "Initial commit"
git push 
```

这里的关键是使用“GIT_DIR”环境变量将 git 指向一个工作存储库。与其尝试在 ftp 服务器上创建 git 存储库（无论如何我认为这是一个坏主意），上述方法将在您的主文件夹中的 HD 上创建存储库，然后将 git 指向该存储库而不是拥有它尝试在 ftp 上创建一个新的。

请注意，您应该在完成后“取消设置 GIT_DIR”，以防您需要在同一个 shell 的其他地方正常使用 git。此外，当您回来并希望在 ftp 挂载上针对此存储库运行更多 git 命令时，请务必再次设置 GIT_DIR。

# xcode - 没有 tableview 控制器的故事板导航控制器

> ID：14947026
> 
> 赞同：14
> 
> 时间：2013-02-18T23:13:19.183
> 
> 标签：xcode, storyboard

每当我将导航控制器添加到 xcode 故事板时，都会添加一个 tableviewcontroller，其中添加了一个连接两者的“关系”，我不想要 tableviewcontroller，我想要一个常规的 viewcontroller。我怎么得到它？我正在尝试在情节提要中重现以下 Apple PhotoPicker 示例。

![Apple PhotoPicker 示例](../Images/dedf7377acb8e2f5667a3e3c0b9454d2.png)

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-02-18T23:22:31.597

简单：将 ViewController 拖到情节提要上，然后单击“编辑器”和“嵌入”。选择导航控制器。完毕。

# java - NullPointerException 与 Owasp.CsrfGuard.Test

> ID：14947028
> 
> 赞同：3
> 
> 时间：2013-02-18T23:13:31.633
> 
> 标签：java, nullpointerexception, listener, csrf, owasp

为什么我会得到：

```
java.lang.NullPointerException org.owasp.csrfguard.CsrfGuardFilter.doFilter(CsrfGuardFilter.java:53) 
```

尝试在 Tomcat 5.5 上运行[0wasp.CsrfGuard.Test示例应用程序时？](https://github.com/esheri3/OWASP-CSRFGuard/tree/master/Owasp.CsrfGuard.Test)

我使用的示例应用程序与下载时完全一样，但进行了以下更改以规避`listener`错误：

*   我下载了 CsrfGuard 3.0.0 包并将其复制`Owasp.CsrfGuard.jar`到`WEB-INF/lib`以绕过未找到的侦听器。

*   我更改了 web.xml 文件以使用附带的侦听器，`Owasp.CsrfGuard.jar`而不是原始`web.xml`中不存在的两个侦听器。

当我启动应用程序时没有错误，但是当我将浏览器指向该`/Owasp.CsrfGuard.Test/index.html`页面时，出现上述错误。

有什么想法可以尝试吗？

更新...

几个小时后，我让它正常工作。我不明白为什么，但即使在停止并重新启动 web 应用程序（至少在 Tomcat 中）之后，过滤器错误似乎仍然存在。我不得不重命名该 webapp 的目录，等待 10 秒钟让 Tomcat 自动取消部署它，将它重命名回原来的目录名称，然后等待 10 秒钟让 Tomcat 将其识别为新的 webapp。我还从 web.xml 文件中删除了“x-requested-with”init-param，因为我不使用 AJAX。不知道这是否真的需要出来，但它有效，所以我把它排除在外。

现在，“protect.html”文件确实受到了保护，但它被保护得太好了。我根本无法理解。如果我尝试直接进入protect.html 页面，它不应该允许这样做，它不允许。但是，它应该允许我通过正确的网页流程到达那里，所有页面都获得正确的令牌。

现在的问题是如何访问protect.html 页面？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T02:37:41.673

知道了！万一其他人有问题，这就是我想出的让 JavaScript DOM Manipulation 工作的方法。

.properties 文件中的所有引用都必须是绝对引用 Web 容器（在我的例子中是 Tomcat）。即使您将 .js 和 .jar 文件放在特定的 webapp 中并使用 CSRFGuard 的正确设置修改该 webapp 的 web.xml 文件（顺便说一下相对引用），.properties 文件中的条目也必须包含对网络应用名称。例如，它必须是这样的：

org.owasp.csrfguard.unprotected.Index=/someapp/index.html

而不仅仅是

org.owasp.csrfguard.unprotected.Index=index.html

这并不直观，因为除非您正在处理整个 Tomcat 容器（即主 web.xml 文件），否则您通常可以删除 webapp 名称，因为它是针对该 webapp 的。

现在我将研究 JSP 标记注入的另一种 CSRFGuard 方法，因为如果用户在浏览器中关闭了 JavaScript，JavaScript 机制将无法工作。

# if-statement - 带有递归的 Prolog if/else 语句

> ID：14947029
> 
> 赞同：0
> 
> 时间：2013-02-18T23:13:35.580
> 
> 标签：if-statement, recursion, prolog

我是 prolog 的新手，我正在尝试弄清楚如何使用 if/else 语句和递归。为了说明，我编写了一个简单的 prolog 程序。该程序是无用的（因为它的功能是无用的），但它可以帮助我说明我的问题。程序获取一个列表，检查列表的头部，看看它是否是最后一个元素；如果不是，它将头部添加到临时列表变量中，并使用列表的尾部以递归方式运行程序。它应该在最后输出列表。该程序：

```
 gothrough([H|T], B, C):-
      append(B,H,B),
      (  (T == [])
      -> C=B
      ;  gothrough(T, B, C)
      ). 
```

来电：`gothrough([sample, phrase, here], [], C).`

预期输出：`C = [sample, phrase, here]`

电流输出：`no`

对我做错了什么有帮助吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T00:01:23.107

从您的评论中，我了解到您误解了`append`（以及一般的 Prolog）是如何工作的。

这根本不是真的：“如果 B = [昨天] 和 H = [今天]，那么 append(B, H, B) = [昨天，今天]”。

`append(B, H, B)`表示“将 H 附加到 B 再次产生 B”。这只有在 H 是一个空列表时才有可能。

要理解的关键是两个 B`append(B, H, B)`是相同的，它们必须具有相同的值。这就像代数中的变量——方程中的所有 X 表示相同的值。

您应该为输出变量使用不同的名称，例如`append(B, H, Bnew)`- 这样会更有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T23:24:53.373

你得到一个 no 因为 append(B,H,B) 失败，除非 H 是 []; 请记住，这些是从句，而不是赋值。而且由于您从不将任何内容绑定到 C，因此如果您的陈述被证明，它将永远不会有价值。

这将完成您的任务：

```
gothrough([],L,L).
gothrough([H|T], B, C) :- gothrough(T,B,Cx), append([H],Cx,C). 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T23:22:27.450

第一个问题是`append(B, H, B)`对于大多数输入没有意义。

第二个问题是 if-then-else 的结果和替代，即之后`->`和之后的部分`;`都必须是 Prolog 目标（语句）。`C`不是目标。您的意思可能是`C=B`，虽然很难说，因为我发现很难理解您的程序在做什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T18:23:31.803

这可以更简单地完成：

```
gothrough([], []).
gothrough([H|T], [H|X]) :-
    gothrough(T, X). 
```

第一条规则匹配您的空列表条件，然后强制递归/要构建的列表结束。

The second rule matches everything but an empty list, in which case the head H is appended onto X, where X is the result of list obtained from recursing the tail. ie. you don't need to use the append predicate - list appending is built into prolog.

```
?- gothrough([simple, phrase, here], X).
X = [simple, phrase, here]. 
```

This solution also uses one less variable.

# javascript - 动态更新 pointStart 和 pointInterval

> ID：14947031
> 
> 赞同：4
> 
> 时间：2013-02-18T23:13:43.490
> 
> 标签：javascript, highcharts

我正在使用 highcharts 来显示每日统计数据，我希望用户能够选择一个日期范围。

```
function requestData(chart, from, to, group) {
    $.ajax({
        url: '/stats/chart?from='+from+'&to='+to+'&group='+group,
        success: function(data) {
            chart.series[0].setData(data.data);
            chart.series[0].pointStart = data.start;
            chart.series[0].pointInterval = data.interval;
        },
        cache: false
    });
} 
```

js 函数执行 ajax 调用并返回如下内容：-

```
{
"start":1358467200000,
"interval":86400000,
"data":[24,9,46,66,19,93,11,10,66,75,70,52,35,91,69,0,50,24,5,14,83,9,26,5,53,32,27,30,34,25,57,100]
} 
```

如何更新图表 pointStart 和 pointInterval 值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-22T13:55:51.810

从 Highcharts 3 开始，您可以使用[series.update()](http://api.highcharts.com/highcharts#Series.update%28%29)：

```
chart.series[0].update({
    pointStart: data.start
    pointInterval: data.interval,
    data: data.data
}, false); // true if you want redraw 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T20:25:21.510

我编辑了原始问题以显示解释该问题的 jsFiddle 示例，但我将提供一个可行的解决方案。

使用我的解决方案，图表不必完全重新初始化，而是删除所有系列，然后通过该`Chart.addSeries()`方法添加新系列。我有一种感觉`Series.setData()`会更有效率，但我不知道如何让它工作 - 也许有人会！

我目前的解决方案（糟透了）：[jsFiddle 解决方案](http://jsfiddle.net/mmuelle4/dg5Ks/2/)

因此，在对原始海报的回答中，正如@jacobdalton 的回答所述，您必须更改 json 对象以匹配对象的形式`options`，然后将这些对象提供给`Chart.setData()`函数。

此外，您可能会注意到这些`false`参数`Series.remove(false)`和`Chart.addSeries(false)`- 这些参数确保每次进行这些调用时都不会重新呈现图表，并且`Chart.redraw()`可以在之后调用单个参数以节省处理时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T01:23:43.570

`chart.series[0]` doesn't have an editable `pointStart` or a `pointInterval` property. You need to assign these through a dynamic method like `chart.series[0].setData()` and create a full `options` object (right now you're only sending the value `data.data` which is an acceptable parameter to the function but it can also take an object -- [check out the docs for setData()](http://api.highcharts.com/highcharts#Series.setData%28%29) and for [series options](http://api.highcharts.com/highcharts#plotOptions)).

I would suggest changing your json object to match the form of the `options` object:

```
{
    "pointStart":1358467200000,
    "pointInterval":86400000,
    "data":[24,9,46,66,19,93,11,10,66,75,70,52,35,91,69,0,50,24,5,14,83,9,26,5,53,32,27,30,34,25,57,100]
} 
```

Then send the json object directly to `chart.series[0].setData(data)`.

# php - PHP PDO mysql_data_seek

> ID：14947033
> 
> 赞同：0
> 
> 时间：2013-02-18T23:13:47.563
> 
> 标签：php, mysql, pdo, prepared-statement

我正在将一些代码转换为 PDO 访问数据库。我遇到了以下情况：

```
mysql_data_seek($result, 0);
$row0 = mysql_fetch_assoc($result); 
```

根据我在 Google 等上的阅读，我知道这应该是：

```
$row0 = $result->fetch(PDO::FETCH_ASSOC, PDO::FETCH_ORI_ABS, 0); 
```

但是这不起作用。任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T23:44:43.420

查询的第一个选项：

您可以直接迭代`query`结果..

```
foreach ($db->query($sql) as $row) {
    echo $row['FirstName'];
} 
```

执行的第二个选项：

```
$sth = $db->prepare($sql);
$sth->execute();
$row = $sth->fetch(PDO::FETCH_ASSOC); // fetch the next row from statement
echo $row['FirstName']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T23:48:24.283

从手册；

> 从与 PDOStatement 对象关联的结果集中获取一行。fetch_style 参数确定 PDO 如何返回行。

你需要一个`stmt`由`PDO::prepare`方法创建的。

让我们看看这个；

```
// assuming $pdo was created before as well
$sth = $pdo->prepare("SELECT name, colour FROM fruit");
// exec here
$sth->execute();
// get a row here
$row = $sth->fetch(PDO::FETCH_ASSOC);
// here probably you'll get a print out like
// Array([name] => Banana, [color] => Yellow)
print_r($row); 
```

在此处查看更多详细信息：[PHP PDOStatement::fetch](http://php.net/manual/en/pdostatement.fetch.php)

# c# - 合并多对多链接实体的集合

> ID：14947037
> 
> 赞同：0
> 
> 时间：2013-02-18T23:14:06.977
> 
> 标签：c#, entity-framework, linq-to-entities

我有两个对象之间的多对多关系：

```
[Table("AEntities")]
public abstract class AEntity { 
 public int AEntityID { get; set; } 
 public string Description { get; set; }
 public virtual ICollection<Tag> Tags { get; set; }
} 
```

和标签：

```
public class Tag {
 public int TagID { get; set; }
 public int AEntityID { get; set; }
 public string TagValue { get; set; }
} 
```

映射表：

```
public class AEntityTags {
    public int AEntityTagID { get; set; }
    public int TagID { get; set; }
    public int AEntityID { get; set; }
} 
```

流利的代码来定义映射：

```
 modelBuilder.Entity<AEntity>() 
            .HasMany(t => t.Tags)
            .WithMany(p=>p.AEntity) 
            .Map(t => t.MapLeftKey("AEntityID") 
                .MapRightKey("TagID") 
                .ToTable("AEntityTags")); 
```

接下来，我试图获取给定集合的不同标签列表`AEntities`。因此，如果我最后有三个`AEntity`对象，我想要这三个实体中任何一个上的所有标签的列表。

我目前可以使用以下查询来完成此操作：

```
 public IEnumerable<Tag> getTagsOnAEntities(IEnumerable<AEntities> aEntities) {
        IEnumerable<Tag> results = _context.Tags
            .AsEnumerable()
            .Where(p => p.AEntities.Any(o=>aEntities.Contains(o)));
        return results;
    } 
```

当使用这些时，我们将强制进行额外的查找以提取项目中使用的次数（即，我正在打印使用时的`t.TagValue`和`t.AEntities.Count()`）。

但正如预期的那样，随着 AEntities（几千个）和标签（千个映射的 10 个）数量的增长，速度非常慢（约 10 秒）。我了解效率低下的地方（数以千计的数据库调用），并且正在寻找有关方法的建议，因为我很难确定最佳方法应该是什么。我有以下困难：

1.  如果我在数据库中使用标签的总次数之后我尝试单独查询`AEntityTags`表以获取计数`TagID`（更快，因为它跳过加载任何内容，但仍然很慢） - 有没有比这更好的方法留在 EF ?

2.  有没有一种有效的方法来确定 a`Tag`在某个子集中使用的次数`AEntities`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T22:27:19.717

我没有与您的数据库类似的东西可以方便地测试，但您可能想尝试这个以提高查询的性能：

```
IEnumerable<Tag> results = aEntities.SelectMany(e=>e.Tags).Distinct(); 
```

# sql - SQL Server：在外键的最大日期更新标志

> ID：14947045
> 
> 赞同：1
> 
> 时间：2013-02-18T23:14:39.980
> 
> 标签：sql, sql-server, sql-update, inner-join

我正在尝试进行此更新，但由于某种原因，我无法完全掌握 SQL 子查询。

我的表结构如下：

```
 id  fk    date     activeFlg
---  --  -------    ---------
 1   1   04/10/11      0
 2   1   02/05/99      0
 3   2   09/10/11      0
 4   3   11/28/11      0
 5   3   12/25/98      0 
```

理想情况下，我想将所有具有最近日期的不同外键的 activeFlg 设置为 1。例如，在运行我的查询 id 1,3 和 4 后，活动标志将设置为 1。

我想出的最接近的事情是返回每个不同 fk 的所有最大日期的查询：

```
SELECT MAX(date)
FROM table
GROUP BY fk 
```

但是由于我什至无法提出子查询，所以我无法继续：/

有人可以给我一些见解。我正在尝试真正了解有关子查询的更多信息，因此将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T23:18:16.633

您需要选择 fk to 然后限制它，所以

```
SELECT fk,MAX(date)
FROM table
GROUP BY fk 
```

到

```
With Ones2update AS
(
  SELECT fk,MAX(date)
  FROM table
  GROUP BY fk
)
Update table
  set Active=1
from table t
join Ones2update u ON t.fk = u.fk and t.date = u.date 
```

我也会先测试所以先做这个查询

```
With Ones2update AS
(
  SELECT fk,MAX(date)
  FROM table
  GROUP BY fk
)
selct fk, date, active 
from table t
join Ones2update u ON t.fk = u.fk and t.date = u.date 
```

以确保你得到你所期望的，我没有做任何错别字。

附加说明：我使用连接而不是子查询——它们在逻辑上是相同的，但我总是发现连接更清晰（一旦我习惯了使用连接）。根据优化器，它们可以更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T23:50:37.420

这是一般的想法。你可以充实细节。

```
update t
set activeFlg = 1
from yourTable t
join (
select id, max([date] maxdate
from TheForeignKeyTable
group by [date]
)  sq on t.fk = sq.id and t.[date] = maxdate 
```

# objective-c - exc_bad_access（代码= 2 地址=0x0）

> ID：14947046
> 
> 赞同：2
> 
> 时间：2013-02-18T23:14:46.400
> 
> 标签：objective-c, c, exc-bad-access

我是新手，正在尝试制作扫雷 iphone 应用程序

我使用 IBButton 来重置雷区，这是一个 2 x 2 结构矩阵

```
- (IBAction) Reset {
    for (int x = 0 ; x < 10 ; x ++) {
       for (int y = 0 ; y < 10 ; y++ ) {
           f[x][y]->isOpen = NO;
           f[x][y]->display = 0; //Going to make a search function for finding Number of mines next to it
           int random = arc4random()%10;
           if (random < 2) {
               f[x][y]->isMine = YES;
           } else {
               f[x][y]->isMine = NO;
           }
        }
    } 
```

所以我在我的 for 循环 f[x][y]->.... 的第一行得到了错误。

我在这里做错了什么？

/编辑

这就是我宣布我的 f

```
struct feild *f[10][10];
struct feild{
    bool isOpen;
    bool isMine;
    int display;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:11:37.213

您还没有为 f 分配任何空间，所以`f[x][y]`只会包含垃圾内存，然后`->isOpen = NO`访问就会崩溃。

你需要做类似的事情

```
for (int i = 0; i < 10; i++) {
    for (int j = 0; j < 10; j++) {
        f[i][j] = malloc(sizeof(struct feild));
    }
 } 
```

在你的代码之前。

# c++ - 编译器错误与链接器错误？

> ID：14947050
> 
> 赞同：6
> 
> 时间：2013-02-18T23:14:54.303
> 
> 标签：c++, c, compiler-construction, linker

只是阅读 Effective C++，他多次提到“链接器错误”，而不是编译器错误。

什么构成“链接器错误”，它们与“编译器错误”有何不同？规则/解释是否基于一组类别以在逻辑上记住这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-18T23:17:50.360

*编译器错误*意味着编译器无法将您提供的源代码转换为目标代码。这通常意味着您自己的程序中存在语法或语义错误，您必须在程序表现出您希望它具有的行为之前解决该错误。

*链接器错误*意味着链接器无法从您提供的目标代码构建可执行程序。这通常意味着您的程序没有正确地与它自己的依赖项或与外部世界（例如外部库）交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T01:27:25.970

`gcc -c`编译但不链接：

> ```
>  -c  Compile or assemble the source files, but do not link.  The linking
>        stage simply is not done. 
> ```

您可以编译一个文件，然后将其链接到`-o`：

```
$ gcc -c hello.s
$ gcc -o test hello.o 
$ ./test 
Hi World 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T23:20:53.323

编译器错误是与编译期间代码语义相关的一类错误，即在将源文件转换为目标文件的过程中。`pthread_create`在这里，您可能已经定义了某些假定可用的符号（例如）。

链接器错误是在创建最终目标文件期间验证这些依赖关系时遇到的错误。使用上面的示例，为了创建可执行文件，您需要定义`pthread_create`如果未找到将给出链接器错误的定义。

# php - PHP curl 的 SSL 错误

> ID：14947064
> 
> 赞同：4
> 
> 时间：2013-02-18T23:16:19.680
> 
> 标签：php, api, ssl, curl

各位程序员好，

我正在制作一个带有 https 连接的 API。我想通过证书检查来保护 API 调用。现在我已经从 curl 下载了 cacert.pem 并将其放在我的文件夹中，但它不起作用并给了我这个错误：

```
SSL certificate problem: unable to get local issuer certificate 
```

好吧，我真的很确定 cacert.pem 文件的位置正确，但是对于你们来说，我一直在编写一些代码以使其正常工作：

```
 $ch = curl_init($url);
 curl_setopt($ch, CURLOPT_POST      ,1);
 curl_setopt($ch, CURLOPT_USERPWD, $this->api_key . ":" . $this->api_secret);
 curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 1);
 curl_setopt($ch, CURLOPT_CAINFO, dirname(__FILE__) . "/cacert.pem");
 curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
 curl_setopt($ch, CURLOPT_POSTFIELDS    ,$post_vars);
 curl_setopt($ch, CURLOPT_FOLLOWLOCATION  ,0);
 curl_setopt($ch,CURLOPT_HTTPHEADER,array('Accept: application/json'));
 curl_setopt($ch, CURLOPT_RETURNTRANSFER  ,1);  // RETURN THE CONTENTS OF THE CALL
 $data = curl_exec($ch); 
```

我希望你们中的一些人能回答我的问题，因为我真的不太了解 SSL 连接。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T23:40:47.267

在确保您正在运行的脚本可以读取您的证书包之后，下一步是调查服务器本身。

如果这是您自己的服务器，那么您很可能忘记安装中间证书，即介于已颁发证书和捆绑包随附的证书颁发机构之一之间的证书。

如果您使用的是自签名证书，`cacert.pem`则应包含您要连接的服务器的公共证书；这可以从[此处](http://www.akadia.com/services/ssh_test_certificate.html)概述的私有证书生成，称为`.crt`文件。

# css - 如何有效地选择多个 CSS 父子组

> ID：14947069
> 
> 赞同：6
> 
> 时间：2013-02-18T23:16:43.070
> 
> 标签：css, css-selectors

有没有更有效的方法来选择多个父组和后代组？

我现在拥有的：

```
aside p, aside h1, aside h2, aside h3, aside h4,
article p, article h1, article h2, article h3, article h4,
section p, section h1, section h2, section h3, section h4 {
  width: 75%;
  padding: 15px 0;
  margin: 0 auto;
  text-align: center;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-11-10T01:56:37.853

### ：火柴（）

您可以使用[`:matches()`](https://developer.mozilla.org/en-US/docs/Web/CSS/:matches)CSS 伪类函数对您的父母和后代进行分组：

```
:matches(aside, article, section) :matches(p, h1, h2, h3, h4) 
```

请注意，在撰写本文时，这仍是一项实验性技术，因此您可能希望在生产中使用它之前查看[浏览器兼容性](https://developer.mozilla.org/en-US/docs/Web/CSS/:matches#Browser_compatibility)。

较旧的浏览器可能需要使用以供应商为前缀的伪类`:any()`：

```
:-moz-any(aside, article, section) :-moz-any(p, h1, h2, h3, h4),
:-webkit-any(aside, article, section) :-webkit-any(p, h1, h2, h3, h4),
:matches(aside, article, section) :matches(p, h1, h2, h3, h4) 
```

根据[CSSWG 问题 #3258](https://github.com/w3c/csswg-drafts/issues/3258)，将来`:matches()`可能会重命名为`:is()`：

```
:is(aside, article, section) :is(p, h1, h2, h3, h4) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T00:10:34.390

最高效、简洁和具体的选择器就是：

```
.selector {
    width: 75%;
    padding: 15px 0;
    margin: 0 auto;
    text-align: center;
} 
```

可能会污染您的标记，但就 CSS 性能而言，就是这样。

关于`*`选择器，它的性能很差，添加父选择器不会改善这种情况，如此[处所示](https://developer.mozilla.org/en-US/docs/CSS/Writing_Efficient_CSS?redirectlocale=en-US&redirectslug=Writing_Efficient_CSS#How_the_Style_System_Matches_Rules)

> 样式系统从键选择器开始匹配规则，然后向左移动（在规则的选择器中查找任何祖先）。只要选择器的子树继续检出，样式系统就会继续向左移动，直到它匹配规则，或者因为不匹配而放弃。

最后一点，`aside, article, section`在 IE < 8 中不支持，因此这些浏览器不会选择任何样式（除非使用 polyfill，但这是 JS 唯一的方式）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T23:19:15.120

您可以删除所有标签特异性。

```
p, h1, h2, h3, h4 {
width: 75%;
padding: 15px 0;
margin: 0 auto;
text-align: center;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-18T23:21:45.727

使用纯 CSS，除了在所有 h 标签上设置类之外，您当前的方法可能是最有效的方法。

使用[LESS](http://lesscss.org/)，您可以执行以下操作：

```
aside, article, section {
  h1, h2, h3, h4 { ... }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-18T23:21:50.957

如果父母中只有 (p, h1-h4) 你可以这样做：

```
aside > *, article > *, section > * {
width: 75%;
padding: 15px 0;
margin: 0 auto;
text-align: center;
} 
```

它只会影响直接的孩子。

# ruby-on-rails - 通过 Rotten Tomatoes API 搜索非英文片名电影。Ruby on Rails

> ID：14947073
> 
> 赞同：1
> 
> 时间：2013-02-18T23:17:30.617
> 
> 标签：ruby-on-rails, ruby-on-rails-3, httparty, rotten-tomatoes

[我有以下功能，可以通过Rotten Tomatoes API](http://developer.rottentomatoes.com/iodocs)按标题搜索电影，这可能会不小心拼写为非基本英语。我使用[HTTParty gem](https://github.com/jnunemaker/httparty)来包装 API。

```
def self.search_by_title(title)
    options = {query: {apikey: "secret", page_limit: "1" }}
    response = self.get("http://api.rottentomatoes.com/api/public/v1.0/movies.json?q=#{CGI.escape(title)}", options)

    movie = JSON.parse(response.body)
end 
```

因此，如果我提出以下请求（搜索“Rashômon”电影）：

```
http://api.rottentomatoes.com/api/public/v1.0/movies.json?q=#{CGI.escape(Rashômon)}&apikey=apikey 
```

它返回空哈希

```
{"total"=>0, "movies"=>[], "links"=>{"self"=>"http://api.rottentomatoes.com/api/public/v1.0/movies.json?q=Rash%C3%83%C2%B4mon&page_limit=1&page=1"} 
```

如果我只使用“罗生门”就可以了。但我通过 3d 派对 API 获得这些标题，有时它会提供这种格式的标题。

我知道我可能应该通过其他标识（imdb_id、英文名称等）进行搜索，但有时我无法提供这些变量并使用 search_by_title 作为后备函数。

有没有办法绕过它？

# doctrine-orm - Doctrine2：多对多，在参考表中有额外的列（添加记录）

> ID：14947080
> 
> 赞同：2
> 
> 时间：2013-02-18T23:17:54.433
> 
> 标签：doctrine-orm, entity-relationship, one-to-many, symfony-2.1, many-to-one

**剧透**：我想我找到了答案，但我不是 100% 确定；）

我一直在研究这个[问题](https://stackoverflow.com/questions/3542243/doctrine2-best-way-to-handle-many-to-many-with-extra-columns-in-reference-table)一段时间，但我无法让它发挥作用。所以我创建了虚拟实体来测试关系，它们是：

*   A`Product`可以在很多`Cart`
*   一个`Cart`罐头包含几个`Product`
*   `Product`in a`Cart`是按 a 排序的`position`

**产品**

```
<?php

namespace Acme\DemoBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Doctrine\Common\Collections\ArrayCollection;
use Symfony\Component\Validator\Constraints as Assert;

/**
 * @ORM\Entity
 * @ORM\Table(name="demo_product")
 */
class Product
{
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
     * @ORM\OneToMany(targetEntity="CartHasProduct", mappedBy="product", cascade={"all"})
     */
    protected $productCarts;

    /**
     * Constructor
     */
    public function __construct()
    {
        $this->productCarts = new \Doctrine\Common\Collections\ArrayCollection();
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Add productCarts
     *
     * @param \Acme\DemoBundle\Entity\CartHasProduct $productCarts
     * @return Product
     */
    public function addProductCart(\Acme\DemoBundle\Entity\CartHasProduct $productCarts)
    {
        $this->productCarts[] = $productCarts;

        return $this;
    }

    /**
     * Remove productCarts
     *
     * @param \Acme\DemoBundle\Entity\CartHasProduct $productCarts
     */
    public function removeProductCart(\Acme\DemoBundle\Entity\CartHasProduct $productCarts)
    {
        $this->productCarts->removeElement($productCarts);
    }

    /**
     * Get productCarts
     *
     * @return \Doctrine\Common\Collections\Collection 
     */
    public function getProductCarts()
    {
        return $this->productCarts;
    }
} 
```

**大车**

```
<?php

namespace Acme\DemoBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Doctrine\Common\Collections\ArrayCollection;
use Symfony\Component\Validator\Constraints as Assert;

/**
 * @ORM\Entity
 * @ORM\Table(name="demo_cart")
 */
class Cart
{
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
     * @ORM\OneToMany(targetEntity="CartHasProduct", mappedBy="cart", cascade={"all"})
     */
    protected $cartProducts;

    /**
     * Constructor
     */
    public function __construct()
    {
        $this->cartProducts = new \Doctrine\Common\Collections\ArrayCollection();
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Add cartProducts
     *
     * @param \Acme\DemoBundle\Entity\CartHasProduct $cartProducts
     * @return Cart
     */
    public function addCartProduct(\Acme\DemoBundle\Entity\CartHasProduct $cartProducts)
    {
        $this->cartProducts[] = $cartProducts;

        return $this;
    }

    /**
     * Remove cartProducts
     *
     * @param \Acme\DemoBundle\Entity\CartHasProduct $cartProducts
     */
    public function removeCartProduct(\Acme\DemoBundle\Entity\CartHasProduct $cartProducts)
    {
        $this->cartProducts->removeElement($cartProducts);
    }

    /**
     * Get cartProducts
     *
     * @return \Doctrine\Common\Collections\Collection 
     */
    public function getCartProducts()
    {
        return $this->cartProducts;
    }
} 
```

最后**是 CartHasProduct**参考表

```
<?php

namespace Acme\DemoBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Doctrine\Common\Collections\ArrayCollection;
use Symfony\Component\Validator\Constraints as Assert;

/**
 * @ORM\Entity
 * @ORM\Table(name="demo_cartHasProduct")
 */
class CartHasProduct
{
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
     * @ORM\ManyToOne(targetEntity="Cart", inversedBy="productCarts")
     */
    protected $cart;

    /**
     * @ORM\ManyToOne(targetEntity="Product", inversedBy="cartProducts")
     */
    protected $product;

    /**
     * @ORM\Column(type="integer")
     */
    protected $position;

    public function __construct(Cart $cart, Product $product, $position=0) {
        $this->cart = $cart;
        $this->product = $product;
        $this->setPosition($position);
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set position
     *
     * @param integer $position
     * @return CartHasProduct
     */
    public function setPosition($position)
    {
        $this->position = $position;

        return $this;
    }

    /**
     * Get position
     *
     * @return integer 
     */
    public function getPosition()
    {
        return $this->position;
    }

    /**
     * Set cart
     *
     * @param \Acme\DemoBundle\Entity\Cart $cart
     * @return CartHasProduct
     */
    public function setCart(\Acme\DemoBundle\Entity\Cart $cart = null)
    {
        $this->cart = $cart;

        return $this;
    }

    /**
     * Get cart
     *
     * @return \Acme\DemoBundle\Entity\Cart 
     */
    public function getCart()
    {
        return $this->cart;
    }

    /**
     * Set product
     *
     * @param \Acme\DemoBundle\Entity\Product $product
     * @return CartHasProduct
     */
    public function setProduct(\Acme\DemoBundle\Entity\Product $product = null)
    {
        $this->product = $product;

        return $this;
    }

    /**
     * Get product
     *
     * @return \Acme\DemoBundle\Entity\Product 
     */
    public function getProduct()
    {
        return $this->product;
    }
} 
```

我手动创建了实体，添加 @ORM 注释来设置关系，然后我用来`app/console generate:doctrine:entities AcmeDemoBundle`填充`getter`,`setter`和`__construct`

现在我是一个控制器，我必须遵循代码：

```
<?php

namespace Acme\DemoBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;

class WelcomeController extends Controller
{
    public function indexAction()
    {
        // Create a Cart Entity
        $cart = new \Acme\DemoBundle\Entity\Cart();

        // Create a Product Entity
        $product = new \Acme\DemoBundle\Entity\Product();

        // Add the Product into the Cart
        $cart->getCartProducts()->add($product);

        // Save the Cart
        $em = $this->getDoctrine()->getManager();
        $em->persist($cart);
        $em->flush();

        return $this->render('AcmeDemoBundle:Welcome:index.html.twig');
    }
} 
```

这样做我会出现以下错误：

> 在关联 Acme\DemoBundle\Entity\Cart#cartProducts 上找到类型为 Acme\DemoBundle\Entity\Product 的实体，但期待 Acme\DemoBundle\Entity\CartHasProduct

所以我的问题是如何将产品添加到购物车中？我是否需要手动创建关系对象 ( `CartHasProduct`)？我认为 Doctrine 会做到的。我到处查看 Doctrine 文档，但找不到与额外字段相​​关的示例。

我还查看了供应商的测试，有很多模型（非常有趣）但没有任何额外的关系。

我在想像这样在购物车中创建我自己的方法：

```
public function addProduct(Product $product, $position=0) {
    $relation = new CartHasProduct($this, $product, $position);
    if (!$this->cartProducts->contains($relation)) {
        $this->cartProducts->add($relation);
    }
} 
```

但我想知道我是否需要实现它，或者它是否意味着自动处理？

####**更新 1** ####

所以我最终添加了这个方法`addProduct`。问题是它`contains()`没有按预期工作。所以我试图从中删除所有`Product`并`Cart`添加一个新的。

这是我删除产品的功能：

```
/**
 * Reset the product for the cart
 *
 * @return bool
 */
public function resetCart() {
    foreach ($this->getCartProducts() as $relation) {
        $relation->getProduct()->removeProductCart($relation);
        $this->removeCartProducts($relation);
    }
} 
```

这就是我所说的：

```
 $em = $this->getDoctrine()->getManager();
    $cart->resetCart();
    $em->persist($cart);
    $em->flush(); 
```

但是 CartHasProduct 表中的记录不会被删除。

**更新 2**

我发现问题出在哪里，如果要删除 2 个主要实体（和）之间的关系，则需要添加`orphanRemoval=true`OneTwoMany 关系（在两侧）：`Cart``Product`

```
/**
 * @ORM\Entity
 * @ORM\Table(name="demo_product")
 */
class Product
{
...

    /**
     * @ORM\OneToMany(targetEntity="CartHasProduct", mappedBy="product", cascade={"persist", "remove"}, orphanRemoval=true)
     */
    protected $productCarts; 
```

和

```
/**
 * @ORM\Entity
 * @ORM\Table(name="demo_cart")
 */
class Cart
{
    ...

    /**
     * @ORM\OneToMany(targetEntity="CartHasProduct", mappedBy="cart", cascade={"persist", "remove"}, orphanRemoval=true)
     */
    protected $cartProducts;

    ...

    /**
     * Reset the product for the cart
     */
    public function resetCart() {
        $this->getCartProducts()->clear();
    } 
```

干杯，

马克西姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T04:15:00.830

可以通过使用第三个中间实体来实现与额外参数的多对多关联。您有正确的方法，但定义了错误的关联。应该是这样的。

以您的 3 个实体`Product`, `Cart`,`CartProducts`

`Cart`应该有`one-to-many`关系`CartProducts`

`CartProducts`应该`many-to-one`与`Product`_ `Many-to-one`_`Cart`

所以你首先初始化 a `Cart`，然后`Cart`像这样添加产品：

对于每一个`Product`

*   `CartProduct`使用您需要的`Product`and`Cart`和其他额外参数初始化 a 。
*   将其添加到`Cart`

# erlang - Erlang：进程与死线程保持联系

> ID：14947081
> 
> 赞同：2
> 
> 时间：2013-02-18T23:17:55.857
> 
> 标签：erlang, hyperlink

我有一个进程，许多线程都链接到该进程，以便将自己与该进程相关联。我以这种方式制作系统，以便在任何时候我都可以轻松查看谁与中央进程相关联，而不必跟踪应用程序本身内部的任何列表。我可以简单地做`process_info(self(),links)`，而 erlang 会跟踪哪些进程仍然存在或不存在，等等......

至少，我是这么认为的，直到我发现这个线程上返回的列表此时不准确：

```
% P is my central pid
(node@host)212> P.
<0.803.0>

% Get all the links to it
(node@host)213> {links,L} = process_info(P,links).
{links,[<0.29179.155>,<0.6492.250>,<0.29990.293>|...]}

% Counting out all the links
(node@host)214> length(L).
31154

% Filtering out all of the dead processes, put them in Lf
(node@host)215> Lf = lists:filter(fun(Pid) -> try process_info(Pid,links) of {links,_} -> true; _ -> false catch _:_ -> false end end, L).
[<0.29179.155>,<0.6492.250>,<0.29990.293>,<0.23619.530>|...]

% Lf is only about half the size, half the linked processes are dead!
(node@host)216> length(Lf).
15654

% Proof that the links haven't changed in the interim
(node@host)217> {links,L} = process_info(P,links).
{links,[<0.29179.155>,<0.6492.250>,<0.29990.293>|...]} 
```

我能想到的唯一会导致这种情况的是网络连接问题，因为某些链接可能来自另一台机器上节点上的线程。这是一个可能的解释吗？有没有办法让线程清理它的链接列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T03:50:21.637

这是我的错。这实际上是我如何检查进程是否已死的问题。process_info 不适用于远程节点上的线程。哦！

# javascript - jQuery创建的元素不能通过post发送

> ID：14947088
> 
> 赞同：0
> 
> 时间：2013-02-18T23:18:26.177
> 
> 标签：javascript, jquery

我正在我的表单中动态创建文本类型的输入，其中包含一个值。我可以看到新的输入，但是每次我通过 ajax 将它发送到我的 php 文件时，它都不会获得新创建的输入。

输入被放入一个表格中，该表格是一个表格。

我尝试使用 javascript 和 jQuery，但这两个示例**不使用相同的数据**，因为 javascript 方式仅用于测试目的

# Javascript方式

```
var input = document.createElement("input");
input.setAttribute("type","text");
input.setAttribute("name","moi");
input.setAttribute("disabled","disabled");
input.setAttribute("value","HEY");

$('#actor_form').append(input); 
```

* * *

# jQuery方式

```
var r_name = "<td>" + "<input type='text' name='role[]' disabled value=" +$('#role_name').val()+ " ></td>" ;
var a_name = "<td>" + "<input type='text' name='name[]' disabled value=" +$('#actor_list').val()+  "></td>";
var r_gender = "<td>" + "<input type='text' name='gender[]' disabled value=" +$('#role_gender').val()+"></td>";
var tr = a_name + r_name  + r_gender;

$('#actor_table').append("<tr>"+tr +"</tr>"); 
```

* * *

# 发送数据

```
$.post("assign_roles.php",   $("#actor_form").serialize()  ,function(data){
    alert(data);
}); 
```

* * *

# PHP 文件

```
echo $_POST['element']; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T23:28:24.383

输入被禁用，因此它们不会包含在序列化数据中。

参考：[http ://api.jquery.com/serialize/](http://api.jquery.com/serialize/)

> “注意：只有“成功的控件”被序列化为字符串。”

参考：[http ://www.w3.org/TR/html401/interact/forms.html#h-17.13.2](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.2)

> “被禁用的控件不能成功。”

# jquery - 试图让这个响应式导航隐藏次要

> ID：14947090
> 
> 赞同：0
> 
> 时间：2013-02-18T23:18:27.020
> 
> 标签：jquery, jquery-mobile, navigation

好的，我有这个响应式导航，这太棒了：http: [//media02.hongkiat.com/responsive-web-nav/demo/index.html](http://media02.hongkiat.com/responsive-web-nav/demo/index.html)

适用于所有东西，直到 Crackberry。出于本演示的目的，我只是在用户的视口小于 480 左右时启动它（换句话说，目前，如果您的视口大于该值，您将看不到导航）。

我正在写作是因为我正在开发一个带有辅助导航的站点（基本上是 ul 中的 ul），但除非用户单击主导航，否则我们不会显示辅助导航。所有这些都是为了保持更短的页面以提高可用性。这是我正在处理的框架：

[http://email.gerarddesign.com/nav/index.html](http://email.gerarddesign.com/nav/index.html)

HTML：

```
<nav class="clearfix">
  <ul class="clearfix">
    <li><a href="#">services</a>
      <ul>
        <li><a href="#">branding</a></li>
        <li><a href="#">communications</a></li>
        <li><a href="#">interactive</a></li>
      </ul>
    </li>
    <li><a href="#">contact</a></li>
  </ul>
  <a href="#" id="pull">Menu</a> 
</nav> 
```

CSS：

```
/* Clearfix */
.clearfix:before,
.clearfix:after {
content: " ";
display: table;
}
.clearfix:after {
clear: both;
}
.clearfix {
*zoom: 1;
}

/* Basic Styles */
body {
    background-color: #ece8e5;
}
nav {
height: 40px;
width: 100%;
background: #fff;
font-size: 11pt;
font-family: 'PT Sans', Arial, sans-serif;
position: relative;
}
nav ul {
padding: 0;
margin: 0 auto;
width: 600px;
height: 40px;
}

nav li {
display: inline;
float: left;
}
nav a {
color: #FBA03A;
display: inline-block;
width: 100px;
text-align: center;
text-decoration: none;
line-height: 40px;
/*  text-shadow: 1px 1px 0px #999; */
text-transform: uppercase;
}
nav li a {
border-right: 1px solid #576979;
box-sizing:border-box;
-moz-box-sizing:border-box;
-webkit-box-sizing:border-box;
}
nav li:last-child a {
border-right: 0;
}
nav a:hover, nav a:active {
background-color: #FBA03A;
color:white;
}
nav a#pull {
display: none;
}

nav ul li ul li {background: url("../images/arroworange.png") 33px center #F2F2F2 no-            repeat;
}
nav ul li ul li a {padding-left:25px;}

/*Styles for screen 600px and lower*/
@media screen and (max-width: 600px) {
nav { 
    height: auto;
}
nav ul {
    width: 100%;
    display: block;
    height: auto;
}
nav li {
    width: 100%;
    float: left;
    position: relative;
}

nav ul li ul li {
    width: 100%;
    float: left;
    position: relative;
    }

nav li a {
    border-bottom: 1px solid #576979;
    border-right: 1px solid #576979;
}
nav a {
    text-align: left;
    width: 100%;
    text-indent: 25px;
}
}

/*Styles for screen 515px and lower*/
@media only screen and (max-width : 480px) {
nav {
    border-bottom: 0;
}
nav ul, nav ul ul {
    display: none;
    height: auto;
}

nav a#pull {
    display: block;
    background-color: #FBA03A;
    width: 100%;
    position: relative;
    color:#fff;
}
nav a#pull:after {
    content:"";
    background: url('nav-icon.png') no-repeat;
    width: 30px;
    height: 30px;
    display: inline-block;
    position: absolute;
    right: 15px;
    top: 10px;
}

nav li {
    display: block;
    float: none;
    width: 100%;
}
nav li a {
    border-bottom: 1px solid #D4862F;
}
} 
```

请让我知道您是否可以帮助我扩展这个惊人的导航使其更加强大，提前谢谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T03:22:28.443

我真的很喜欢这个导航的行为方式，它与[twitter bootstrap](http://twitter.github.com/bootstrap/javascript.html#dropdowns)不同。您可以阅读 css 并查看他们做了什么。

它们很好，但我认为它们没有“*双层*”导航。就像你想做的那样。

我的建议是在另一个可折叠的内部构建一个可折叠的。

编辑：我试着快速看一下，他们称之为嵌套可折叠，这里有一些例子

*   [jQuery 实验：嵌套手风琴](http://www.adipalaz.com/experiments/jquery/nested_accordion.html)
*   [扩展嵌套在 parent.collapsible 中的子可折叠会触发 parent.collapsible.expand](http://forum.jquery.com/topic/expand-of-child-collapsible-nested-in-parent-collapsible-fires-parent-collapsible-expand)
*   [如何使用 jQuery 折叠嵌套列表？](https://stackoverflow.com/questions/2730899/how-can-i-collapse-a-nested-list-using-jquery)

让我们了解您的最新进展。

您可以开设一个 github 帐户并让 peolpe 为该项目做出贡献:)。当我有时间时很乐意提供帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T03:08:08.547

您是在创建自己的框架还是只是创建一个网站？如果是后者，不要浪费时间解决现有框架已经很好地解决的问题。试试 Bootstrap（来自 Twitter），它在处理响应式设计（包括菜单和子菜单）方面做得非常出色。我发现 Bootstrap 非常易于使用，并且可以很容易地添加到现有网站中。

这是网址：http: [//twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/)。

# http - cfhttp 在 CF9 上返回 415 Unsupported Media Type

> ID：14947091
> 
> 赞同：2
> 
> 时间：2013-02-18T23:18:31.143
> 
> 标签：http, coldfusion, coldfusion-9

以下代码在 CF10 上运行良好。

```
httpSvc = New http();
httpSvc.setMethod("post"); 
httpSvc.setCharset("utf-8"); 
httpSvc.setUrl(svcLocation);
httpSvc.setClientCert(certLocation);
httpSvc.setClientCertPassword(certPassword);
httpSvc.addParam(type="body", name="body",value=requestParameters);
result = httpSvc.send().getPrefix(); 
```

requestParameters 的值为：

```
<?xml version="1.0" encoding="UTF-8"?> 
<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/"> 
<S:Body> 
<ns2:processCreditCard xmlns:ns2="urn:com.qvalent.payway.api"> 
<requestParameters>customer.orderNumber=5396&amp;card.CVN=070&amp;order.amount=101&amp;customer.merchant=xxxx&amp;card.expiryMonth=08&amp;card.expiryYear=20&amp;order.ECI=SSL&amp;card.PAN=0000000000000008&amp;card.currency=AUD&amp;customer.username=xxxxxx&amp;order.type=capture&amp;customer.password=xxxxxxx</requestParameters> 
</ns2:processCreditCard> 
</S:Body> 
</S:Envelope> 
```

但是，当我将它放在 CF9 服务器上时，响应 FileContent 为空，我得到以下状态代码：

```
415 Unsupported Media Type 
```

这是显示完整响应的链接：[http ://www.onoffezy.com/_testing/gateway/](http://www.onoffezy.com/_testing/gateway/)

Trawling Google，415 状态代码表明客户端请求的 mime 类型在服务器上不可用。但是，我找不到可以为请求设置 mime 类型的任何地方。cf9 和 cf10 之间的默认 mimetype 有区别吗？

我仔细查看了这两个版本的文档，但找不到可以解释这一点的差异。

如果有人能对此有所了解并让我知道我需要在 CF9 上做些什么不同的事情，我将不胜感激。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T00:16:51.867

感谢所有帮助。我发现了问题。

```
httpSvc.addParam(type="body", name="body",value=requestParameters); 
```

需要改为：

```
httpSvc.addParam(type="xml", name="body",value=requestParameters); 
```

cf9 似乎将 type='body' 作为二进制发送，但 cf10 将其作为字符串发送，或者认为它是 xml 并按此方式处理。一旦我将类型更改为“xml”，cf9 就开始将其作为 xml 字符串发送，而不是二进制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T04:08:52.417

虽然我不能肯定这会解决您的问题，但您是否尝试将“接受”请求标头设置为响应的内容类型？

例如：

`acceptType = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8" httpSvc.addParam(name="Accept", value=acceptType, type="header");`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T14:16:16.607

根据此处的文档，[指定](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d85.html)`type="body"` *HTTP 请求的正文。ColdFusion 不会自动设置内容类型标头或 URL 编码正文内容。要指定内容类型，请使用带有 type=header 的单独 cfhttpparam 标记。* 因此，为您的请求指定此标头可能会有所帮助。

就像是：

```
httpSvc.addParam(type="header", name="Content-Type", value="application/x-www-form-urlencoded"); 
```

您没有提供正文内容的示例。您可能必须使用特定内容类型的值。 [以下是可用 MIME 类型的列表](http://en.wikipedia.org/wiki/MIME_type)。

`requestParamaters`您在示例中的变量中拼错了单词参数。它的价值是什么？

# python - 从主机字符串中删除最后一个句点

> ID：14947092
> 
> 赞同：8
> 
> 时间：2013-02-18T23:18:34.653
> 
> 标签：python, regex, replace

我很难弄清楚如何从主机名中删除最后一个句点......

电流输出：

*   域名.com。
*   suddomain.com。
*   域名.com。
*   subdomain.subdomain.com。
*   子域.com。

所需的输出：

*   域名.com
*   subdomain.com
*   域名.com
*   subdomain.subdomain.com

尝试1：

```
print string[:-1]  #it works on some lines but not all 
```

尝试2：

```
 str = string.split('.')
 subd = '.'.join(str[0:-1])
 print subd    # does not work at all 
```

代码：

```
global DOMAINS

if len(DOMAINS) >= 1:
  for domain in DOMAINS:
    cmd = "dig @adonis.dc1.domain.com axfr %s |grep NS |awk '{print $1}'|sort -u |grep -v '^%s.$'" % (domain,domain)
    p = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.STDOUT,   shell=True)
    string = p.stdout.read()
    string = string.strip().replace(' ','')
    if string:
      print string 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-18T23:20:15.157

你这样做：

```
hostname.rstrip('.') 
```

其中 hostname 是包含域名的字符串。

```
>>> 'domain.com'.rstrip('.')
'domain.com'
>>> 'domain.com.'.rstrip('.')
'domain.com' 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-02-18T23:31:53.053

我放弃了，只是用 sed 代替....

```
cmd = "dig @adonis.dc1.domain.com axfr %s |grep NS |awk '{print $1}' |sort -u |grep -v '^%s.$'|sed -e 's/.$//'" 
```

# c++ - 下面的代码会产生什么？

> ID：14947094
> 
> 赞同：0
> 
> 时间：2013-02-18T23:18:53.833
> 
> 标签：c++

我不知道这是一个技巧问题还是什么，但是当我尝试运行这段代码时，我得到了一些错误。您认为老师忘记添加#include 行了吗？

```
#include <iostream>
#include <vector>
using namespace std;

int display(int val) {
    cout << val << ",";
}

int main() {
    int a[] = {1, -4, 5, -100, 15, 0, 5};
    vector<int> v(a, a + 7);

    sort(v.begin(), v.end(), greater<int>());
    for_each(v.begin(), v.end(), display);
} 
```

.

```
g++ -ggdb  -c test.cpp
test.cpp: In function 'int main()':
test.cpp:13:41: error: 'sort' was not declared in this scope
test.cpp:14:38: error: 'for_each' was not declared in this scope
make: *** [test.o] Error 1 
```

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-18T23:20:02.493

> 您认为老师忘记添加#include 行了吗？

**是的。**

他肯定忘记了：

```
#include <algorithm> 
```

那是`std::sort`和等算法的标准库头文件`std::for_each`，这正是您的编译器所抱怨的。

顺便说一句，尽管您的编译器（还）*没有*抱怨这一点，但他也忘记了：

```
#include <functional> 
```

`std::greater<>`这是您在此处使用的仿函数的标准库标头，例如。

此外，您的 (teacher's?)`display()`函数应该有`void`它的返回类型，因为它目前不返回任何值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-18T23:20:12.480

是的，您需要`#include <algorithm>`for `std::sort`and `std::for_each`，这很可能是您在说`sort`and时试图调用的内容`for_each`。该算法的效果是对数组`a`进行升序排序并将元素打印到标准输出。

# jquery - jQuery 1.9.1 几个复选框选择

> ID：14947100
> 
> 赞同：1
> 
> 时间：2013-02-18T23:19:48.177
> 
> 标签：jquery, checkbox, jquery-1.9

我有此代码 [1] 用于选中/取消选中页面中的多个复选框元素。它适用于 1.9.1 之前的 jQuery 版本，但由于某种原因它不适用于 1.9.1 或更高版本

基本上，我所做的是：

```
$('.cbx').attr('checked', false); 
```

[1] [http://jsfiddle.net/qNPCH/4/](http://jsfiddle.net/qNPCH/4/)

您知道如何使用较新版本的 jQuery 来实现这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T23:20:32.787

使用[`.prop()`](http://api.jquery.com/prop/)：

```
$('.cbx').prop('checked', false); 
```

# c# - 条件线程锁定

> ID：14947101
> 
> 赞同：-1
> 
> 时间：2013-02-18T23:19:58.393
> 
> 标签：c#, multithreading, thread-safety

# 设想

我要下载资源。我不希望资源被多次下载。如果线程*a*下载资源`1`，则应将其缓存，如果线程*b*`1`尝试同时下载资源，则应等待并使用缓存的资源`1`。如果线程*c*想要下载资源`2`，它应该不受线程*a*和*b*的影响。

# 试图

我试图实现以下场景：

```
using System;
using System.Collections.Generic;
using System.Threading;

namespace ConsoleApplication1
{
    class ConditionalThreadLockingProgram
    {
        private static readonly object _lockObject = new object();
        private static readonly Dictionary<int, string> Locks =
            new Dictionary<int, string>();
        private static readonly Dictionary<int, string> Resources =
            new Dictionary<int, string>();

        public static string GetLock(int resourceId)
        {
            lock (_lockObject)
            {
                if (Locks.ContainsKey(resourceId))
                {
                    return Locks[resourceId];
                }
                return Locks[resourceId] = string.Format(
                    "Lock #{0}",
                    resourceId
                );
            }
        }

        public static void FetchResource(object resourceIdObject)
        {
            var resourceId = (int)resourceIdObject;
            var currentLock = GetLock(resourceId);
            lock (currentLock)
            {
                if (Resources.ContainsKey(resourceId))
                {
                    Console.WriteLine(
                        "Thread {0} got cached: {1}",
                        Thread.CurrentThread.Name,
                        Resources[resourceId]
                    );
                    return;
                }
                Thread.Sleep(2000);
                Console.WriteLine(
                    "Thread {0} downloaded: {1}",
                    Thread.CurrentThread.Name,
                    Resources[resourceId] = string.Format(
                        "Resource #{0}",
                        resourceId
                    )
                );
            }
        }

        static void Main(string[] args)
        {
            new Thread(FetchResource) { Name = "a" }.Start(1);
            new Thread(FetchResource) { Name = "b" }.Start(1);
            new Thread(FetchResource) { Name = "c" }.Start(2);
            Console.ReadLine();
        }
    }
} 
```

# 问题

它有效吗？有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:00:52.897

C# 现在包含[Lazy](http://msdn.microsoft.com/en-us/library/dd642331.aspx)、[Concurrent Collections](http://msdn.microsoft.com/en-us/vstudio/gg274329.aspx)和[MemoryCache](http://msdn.microsoft.com/en-us/library/system.runtime.caching.memorycache.aspx) - 为 MemoryCache 添加对 System.Runtime.Caching 的引用。

这就是我要做的 - 不需要额外的锁定，并且 Lazy 实现会处理竞争条件。

```
/// <summary>
/// Summary description for ResourceFactory
/// </summary>
public static class ResourceFactory
{
    private const string _cacheKeyFormat = "AppResource[{0}]";

    private static readonly ObjectCache _cache = MemoryCache.Default;

    private static readonly CacheItemPolicy _policy = new CacheItemPolicy() 
    { 
        SlidingExpiration = TimeSpan.FromMinutes(Int32.Parse(ConfigurationManager.AppSettings["AppResourceTimeout"] ?? "20")), 
        RemovedCallback = new CacheEntryRemovedCallback(AppResourceRemovedCallback) 
    };

    private static void AppResourceRemovedCallback(CacheEntryRemovedArguments args)
    {
        // item was removed from cache
    }

    #region Extensions to make ObjectCache work with Lazy

    public static TValue GetOrAdd<TKey, TValue>(this ObjectCache @this, TKey key, Func<TKey, TValue> valueFactory, CacheItemPolicy policy)
    {
        Lazy<TValue> lazy = new Lazy<TValue>(() => valueFactory(key), true);
        return ((Lazy<TValue>)@this.AddOrGetExisting(key.ToString(), lazy, policy) ?? lazy).Value;
    }

    public static TValue GetOrAdd<TKey, TParam1, TValue>(this ObjectCache @this, TKey key, TParam1 param1, Func<TKey, TParam1, TValue> valueFactory, CacheItemPolicy policy)
    {
        Lazy<TValue> lazy = new Lazy<TValue>(() => valueFactory(key, param1), true);
        return ((Lazy<TValue>)@this.AddOrGetExisting(key.ToString(), lazy, policy) ?? lazy).Value;
    }

    #endregion

    public static AppResourceEntity GetResourceById(int resourceId)
    {
        #region sanity checks

        if (resourceId < 0) throw new ArgumentException("Invalid parameter", "resourceId");

        #endregion

        string key = string.Format(_cacheKeyFormat, resourceId);

        AppResourceEntity resource = _cache.GetOrAdd(
            key, 
            resourceId, 
            (k, r) =>
            {
                return AppResourceDataLayer.GetResourceById(r);
            }, 
            _policy
        );

        return resource;
    }
} 
```

# uitableview - 如何在不创建内存泄漏的情况下为 UITableViewCell 分配资源

> ID：14947119
> 
> 赞同：2
> 
> 时间：2013-02-18T23:21:10.713
> 
> 标签：uitableview, avplayer

我有一个要添加单元格的 UITableView。每个单元格包含一个图像、一个标题和一个 AVPlayer。我正在执行如下

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    static NSString *CellIdentifier = @"MyCell";
    VideoFeedCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"MyCell" owner:self options:nil];
        cell = [topLevelObjects objectAtIndex:0];
    }
    NSDictionary *row = [myobj  objectAtIndex:indexPath.row];

    AVURLAsset *asset = [AVURLAsset URLAssetWithURL:url options:nil];
    AVPlayerItem *playerItem = [AVPlayerItem playerItemWithAsset:asset];
    AVPlayer *player = [AVPlayer playerWithPlayerItem:playerItem];
    AVPlayerLayer *playerLayer = [AVPlayerLayer playerLayerWithPlayer:player];
    playerLayer.frame = CGRectMake(0.0, 0.0, 300.0, 300.0);       
    player.actionAtItemEnd = AVPlayerActionAtItemEndNone;
    [cell.myViewContainer.layer addSublayer:playerLayer];
    return cell
} 
```

我担心的原因有很多，为每个单元创建一个 AVPlayer 似乎会占用大量内存。我也不清楚 dequeueReusableCellWithIdentifier:CellIdentifier 是如何工作的。如果我在这中间抛出一个 NSLog，每次我上下滚动时都会调用它，这让我相信我也创建了一个新的 AVPlayer 实例，这就像一个巨大的内存泄漏。基本上，我如何正确地执行此操作，分配一个类（如 AVPlayer）以在 UITableviewCell 中使用，但确保在下次调用 cellForRowAtIndexPath 时不会重新分配它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T07:26:46.583

您需要将任何分配代码放入`if (cell == nil)`块中。所以拿你的代码，试试这个：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    static NSString *CellIdentifier = @"MyCell";
    VideoFeedCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"MyCell" owner:self options:nil];
        cell = [topLevelObjects objectAtIndex:0];
        AVURLAsset *asset = [AVURLAsset URLAssetWithURL:url options:nil];
        AVPlayerItem *playerItem = [AVPlayerItem playerItemWithAsset:asset];
        AVPlayer *player = [AVPlayer playerWithPlayerItem:playerItem];
        AVPlayerLayer *playerLayer = [AVPlayerLayer playerLayerWithPlayer:player];
        playerLayer.frame = CGRectMake(0.0, 0.0, 300.0, 300.0);       
        player.actionAtItemEnd = AVPlayerActionAtItemEndNone;
        [cell.myViewContainer.layer addSublayer:playerLayer];
    }
    NSDictionary *row = [myobj  objectAtIndex:indexPath.row];
    return cell
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-15T19:22:10.880

您可以清理不必要的实例：

```
-(void)prepareForReuse{
    [super prepareForReuse];
    [playerLayer removeFromSuperlayer];
    playerLayer = nil;
    playerItem = nil;
    asset = nil;
    player = nil;
} 
```

# android - 根据时间表显示通知

> ID：14947121
> 
> 赞同：0
> 
> 时间：2013-02-18T23:21:26.233
> 
> 标签：android, notifications, alarmmanager, schedule

我真的需要一些指导。我实现了一个触发通知服务的警报管理器。如果我必须只显示一个通知，它就可以工作。但我现在需要的是一种根据时间安排（即 11:00、13:00、18:20）显示通知的方法。

任何帮助，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T23:30:01.577

如果你想在“11:00, 13:00, 18:20”获得控制权，那么用唯一的对象调用`set()`或`setRepeating()`3 次。`PendingIntent`获取“唯一`PendingIntent`对象”的最简单方法是将唯一值传递给工厂方法的第二个参数（例如，`getService()`）。

# twitter-bootstrap - 如何在手机上使用脚手架 twitter 引导程序？

> ID：14947122
> 
> 赞同：0
> 
> 时间：2013-02-18T23:21:27.083
> 
> 标签：twitter-bootstrap

可以`scaffolding twitter bootstrap`和手机一起使用吗？因为当我尝试构建一个时，下面的代码显示了 2 个不同的行。

```
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span1">Single</div>
    <div class="span1">line</div>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T02:38:01.093

请用两列检查这个[JSfiddle](http://jsfiddle.net/shail/fez34/)

在此处查看结果[Result With 2 col](http://jsfiddle.net/shail/fez34/show)

```
 <div class="container">  
       <div class="row">  
          <div class="span12">  
             <h1>Bootstrap 12 col spanning full page</h1>   
   </div>
           <div class="span6">  
              <p> Paragraph test col1</p>   
       </div>  
       <div class="span6">  
               <p> Paragraph test col2.</p>   
        </div>  
       </div>  
    </div> 
```

上面的示例显示了列的排列方式，当您调整浏览器的大小时，列会重新排列在彼此下方以获得最佳可读性。

# jquery - jQuery点击没有功能

> ID：14947124
> 
> 赞同：2
> 
> 时间：2013-02-18T23:21:32.660
> 
> 标签：jquery

我有以下代码：

```
$(document).ready(function(){    
    $("button.continue").click(function(){
        $(this).html("Hello!");
    });
}); 
```

这很完美，但我想把整个事情变成这样：

```
$(document).ready(function(){    
    $("button.continue").click().html("Hello!");
}); 
```

我的问题是：

1.  我可以使用 click() 和以下事件，在这种情况下 html() 以这种方式（不转向功能部分）吗？
2.  如果没有，为什么我不能这样做，因为我会想到这背后的工作原理，例如：当用户单击所选元素时，将其中的 HTML 文本更改为其他内容。
3.  如果这不是思考或推理其背后逻辑的方式，我应该如何处理

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T23:27:42.060

jQuery 函数返回对象本身，因此您可以链接方法，例如：

```
element.css('attribute', 'value').html('value').append('element').click(function() {}); 
```

但是，当绑定事件处理程序时`.click()`，它必须将逻辑存储在事件发生时*调用的回调中。*

链接实际如何工作的示例：

```
var testObject = {
    methodA : function() {
        // some logic
        return this;
    },
    methodB : function() {
        // some logic
        return this;
    }
}
// you can than simply call
testObject.methodA().methodB(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T23:45:37.910

*可以*构建一个按照您的意愿工作的 API，但实际上这不是 jQuery 的工作方式，它是您正在使用的特定库。jQuery click 方法采用一个事件侦听器函数，只要单击匹配的元素就会调用该函数。这是一种典型的函数式程序员模式，通常用于现代的基于事件的 UI。

如果您认为这种代码风格有点不可读，请尝试使用 CoffeeScript，它是一种编译为 javascript 的语言，并且使此类常见模式更易于实现。CoffeeScript 中的等价物类似于：

```
$(document).ready ->
    $('button.continue').click ->
        $(this).html "Hello" 
```

欲了解更多信息，请查看：[http ://coffeescript.org/](http://coffeescript.org/)

# asp.net - 使用 ASPX 页面调用 Web 参考

> ID：14947128
> 
> 赞同：0
> 
> 时间：2013-02-18T23:21:56.113
> 
> 标签：asp.net, soap, wsdl

在 Visual Studio 中，我添加了一个 WSDL Web 参考，它加载了各种用于调用 SOAP api 的“方法”。我有一个空白的 aspx 页面。如何调用 Web 引用加载的这些方法？我已将网络参考称为 mywsdl。

到目前为止，这是我的代码：

```
<%@ Page Language="vb" AutoEventWireup="false" CodeBehind="WebForm1.aspx.vb" Inherits="WebApplication1.WebForm1" %>

<%@ Import Namespace="WebApplication1" %>
<%
End Sub
Private Sub Call_Web_Service_Method()
    Dim output
    Dim CallWebService As New ServerName.mywsdl()
    Dim sGetValue As String = CallWebService.GetSomeValue()
    output = sGetValue
End Sub
%>
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
    <%=output%>
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T23:28:53.497

在网页后面的代码顶部添加 Web 服务作为引用，在需要的地方实例化它的新实例并使用它。当您成功导入 .asmx 我相信这些方法应该已经公开，但是如果您没有取回数据，则可能需要身份验证。

```
using mywsdl;

mywsdl my = new mywsdl(); 
```

或者

```
Imports mywsdl

Dim my = new mywsdl() 
```

# performance - 比较计算机算术算法的时间和时间复杂度

> ID：14947130
> 
> 赞同：1
> 
> 时间：2013-02-18T23:22:07.780
> 
> 标签：performance, time, verilog, computer-architecture

我目前正在从事一个项目，我试图找出在芯片级设计中实施时哪种算法更好。我将这些推到我的 FPGA 板上。我正在用 Verilog 编写代码。我需要的是一个比较量规

a) 2 个函数的时间复杂度。

b) 最坏情况时序

c) 功耗

例如，

方法一：prod = mult1 * mult2;

其中 mult1 和 mult2 是两个 8 位输入。

方法二：prod = ((mult1+mult2-100) * 100) + ((100-mult1) * (100-mult2))

其中 mult1 和 mult2 是两个 8 位输入。

所以我有兴趣知道芯片计算产品所需的总时间，从传入 2 个输入到计算产品的时间。

我正在处理的算法都是 O(n)。所以我知道渐近无关紧要。但是，我有兴趣了解在 FPGA 或 ASIC 板上实现时所采用的确切的最坏情况时序，以便我可以尝试改进功能。我也知道这些计算需要纳秒来计算，但是，这就是我想要改进的。

我看到一些声称有更快算法的期刊出版物。然而，当我使用 Xilinx 和综合报告实现相同的功能时，我得到了不同的结果。

是否有计算功耗和最坏情况时序的软件？或者任何人都可以向我指出一些可以帮助我的文章吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T00:56:00.260

关于时间复杂度和最坏情况的时序，这些将取决于您编写算法的方式以及您使用的目标 fpga。

要了解执行计算所需的时间长度，这取决于 FPGA 的时钟频率，以及执行算法所需的时钟周期数。如果您的乘法算法是单周期的，那么计算所需的时间将只是 fpga 的时钟周期。然而，由于其复杂性，大型乘法电路通常不是单周期的。您获得的确切内容取决于您的输入代码、合成器以及您使用的 fpga 类型。

通常，您的 FPGA 综合工具可以在综合后报告中告诉您设计的最坏情况时序。如果您想改善最坏情况的时序，那么您可以在乘法中添加流水线级以分解工作并提高时钟频率。

测量功耗还很大程度上取决于您使用的 fpga 和您正在加载的综合网表。[Altera](http://www.altera.com/support/devices/estimator/pow-powerplay.jsp)和[Xilinx](http://www.xilinx.com/products/design_tools/logic_design/xpe.htm)为其 fpgas 提供了功率估算器（可能还有其他供应商），但我不确定是否有任何与供应商无关的功率估算器。

长话短说，要获得所需的指标，您需要使用您计划使用的 FPGA 的综合工具。

# c++ - 如何计算信息增益值以减少浮点逼近误差？

> ID：14947132
> 
> 赞同：2
> 
> 时间：2013-02-18T23:22:25.320
> 
> 标签：c++, math, floating-point, floating-accuracy, numerical-methods

我有一个数据集，其中包含一些属于由*1*和*2*表示的两个类标签的特征。该数据集的处理是为了构建决策树：在树的构建过程中，我需要计算信息增益以找到数据集的最佳分区。

*假设标签1*有*N1*个特征，标签2*有**N2*个特征，那么**熵**可以用以下公式计算：

 *****`Entropy = - (N1/N)*log2(N1/N) - (N2/N)*log2(N2/N)`, 其中*N = N1 + N2*

我需要计算三个熵值以获得信息增益：

*   `entropyBefore`，即当前数据集划分前的熵；
*   `entropyLeft`，即分割后左分裂的熵；
*   `entropyRight`，即分区后右拆分的熵。

因此，信息增益等于`entropyBefore - (S1/N)*entropyLeft - (S2/N)*entropyRight`，其中*S1*是属于分割 1的类别*1的特征的数量，而**S2*是属于分割 2的类别*2的特征的数量。*

如何计算信息增益值以减少浮点逼近误差？当我在信息增益必须为零的情况下应用上述公式时，计算值等于一个非常小的负值。

**更新**（示例代码）

```
double N = static_cast<double>(this->rows());   // rows count of the dataset

double entropyBefore = this->entropy();   // current entropy (before performing the split)

bool firstCheck = true;
double bestSplitIg;

for each possible split
{
    // ...

    pair<Dataset,Dataset> splitPair = split(...,...);
    double S1 = splitPair.first.rows();
    double S2 = splitPair.second.rows();

    double entropyLeft = splitPair.first.entropy();
    double entropyRight = splitPair.second.entropy();

    double splitIg = entropyBefore - (S1/N*entropyLeft + S2/N*entropyRight);
    if (firstCheck || splitIg > bestSplitIg)
    {
        bestSplitIg = splitIg;
        // ...

        firstCheck = false;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T00:48:11.040

如果你只是用熵来确定哪个方案更好，这样你只需要比较两个熵的结果而不需要它们的实际值，那么你可以省去一些计算。

你有这个函数：熵（N1，N2，N）->-N1/N*log2（N1/N）-N2/N*log2（N2/N）。

假设 N 在您的问题期间是一个常数，让我们将表达式乘以 N：

> *   N1*log2(N1/N)-N2*log2(N2/N)

接下来，将“/N”从对数中分离出来：

> *   N1*(log2(N1)-log2(N)) - N2*(log2(N2)-log2(N))

并展开：

> *   N1*log2(N1) - N2*log2(N2) - (N1+N2)*log2(N)

并简化：

> *   N1*log2(N1) - N2*log2(N2) - N*log2(N)

显然 N*log2(N) 是一个常数，不会影响一个熵是否大于另一个熵，因此我们可以丢弃它。

此外，乘以 ln(2)，这也不会改变一个熵是否大于另一个熵。这具有将 log2 函数更改为 ln 函数的效果，并且可以通过数学库稍微更准确地计算 ln（这是“自然”对数的原因）：

> E(N1, N2, N) -> - N1*ln(N1) - N2*ln(N2)

该函数的操作较少，因此它的计算可能比熵函数更准确，并且它具有（当精确计算时）E(N1, N2, N) < E(M1, M2, N) iff Entropy(N1 , N2, N) < 熵(M1, M2, N)。*****

# java - 通过 HTTP POST 方法调用 API，不使用正文的参数名称

> ID：14947135
> 
> 赞同：2
> 
> 时间：2013-02-18T23:22:35.413
> 
> 标签：java, api, http, post, nimble

我正在使用 Java。如何进行 HTTP POST 调用 API 并仅在正文中通知“JSON”值（没有参数名称）？

每个示例调用此 URL：[https](https://api.nimble.com/api/v1/contact?access_token=12123486db0552de35ec6daa0cc836b0) ://api.nimble.com/api/v1/contact?access_token=12123486db0552de35ec6daa0cc836b0 （POST METHOD）并且正文中只有这个（没有参数名称）：

```
{'fields':{'first name': [{'value': 'Jack','modifier': '',}],'last name': [{'value': 'Daniels','modifier': '',}],'phone': [{'modifier': 'work','value': '123123123',}, {'modifier':'work','value': '2222',}],},'type': 'person','tags': 'our customers\,best'} 
```

如果这是正确的，有人可以给我一个例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:40:10.393

将此库用于网络部分：[http ://hc.apache.org/](http://hc.apache.org/)

将此库用于 json 部分：[http ://code.google.com/p/google-gson/](http://code.google.com/p/google-gson/)

例子 ：

```
public String examplePost(DataObject data) {
        HttpClient httpClient = new DefaultHttpClient();

        try {
            HttpPost httppost = new HttpPost("your url");
            // serialization of data into json
            Gson gson = new GsonBuilder().serializeNulls().create();
            String json = gson.toJson(data);
            httppost.addHeader("content-type", "application/json");

            // creating the entity to send
            ByteArrayEntity toSend = new ByteArrayEntity(json.getBytes());
            httppost.setEntity(toSend);

            HttpResponse response = httpClient.execute(httppost);
            String status = "" + response.getStatusLine();
            System.out.println(status);
            HttpEntity entity = response.getEntity();

            InputStream input = entity.getContent();
            StringWriter writer = new StringWriter();
            IOUtils.copy(input, writer, "UTF8");
            String content = writer.toString();
            // do something useful with the content
            System.out.println(content);
            writer.close();
            EntityUtils.consume(entity);
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        } finally {
            httpClient.getConnectionManager().shutdown();
        }
    } 
```

希望能帮助到你。

# apache-flex - 如何在flex中播放位于不同文件夹中的声音？

> ID：14947136
> 
> 赞同：0
> 
> 时间：2013-02-18T23:22:54.863
> 
> 标签：apache-flex

我可以访问和播放位于项目根目录中的名为“Song.mp3”的文件，但是当我将其放入“assets”目录时出现错误。

这是我的项目目录：

```
- Test
-- src
--- Homeview.mxml
-- assets
--- Song.mp3
-- Song.mp3 
```

我可以访问和播放位于根文件夹中的 Song.mp3，但是当我想播放 assets/Song.mp3 时出现错误。

这有效：

```
var req:URLRequest = new URLRequest('../Song.mp3'); 
```

这不会：

```
var req:URLRequest = new URLRequest('../assets/Song.mp3'); 
```

我收到以下运行时错误：

```
Error #2044: Unhandled ioError:. text=Error #2032: Stream Error. URL: app:/assets/Song.mp3 
```

我认为根目录中的 Song.mp3 会在最终的 swf 文件中导出，但 assets/Song.mp3 不会。如果是这种情况，有没有办法强制 Flex 导出 assets/Song.mp3？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T04:24:04.260

您可以使用文件类，即 File.applicationStorageDirectory.resolvepath("your url") 或 File.applicationDirectory.resolvepath("your url")。将其存储在文件类型变量中；使用 file.url 或 file.nativePath 访问文件. 这将能够检索应用程序文件夹中的外部文件。

# java - deleteRange 函数只删除第一个和最后一个

> ID：14947138
> 
> 赞同：0
> 
> 时间：2013-02-18T23:22:56.873
> 
> 标签：java, arrays, range

目前正在开发一个执行一系列功能的java程序，其中一个功能是删除一系列按字母顺序排列的单词。我以动物为例。

这是执行 deleteRange 函数之前的显示列表：

```
cat
chinchilla
horse
mouse
rat 
```

我要求程序将栗鼠删除到鼠标，但它不包括马。

```
public boolean deleteRange(String start, String stop){
    boolean result = false;
    int begin = Find(start);
    int end = Find(stop);
    while(begin<end){
        Delete(storage[begin]);
        begin++;
        result = true;
    }
    return result;
} 
```

我的删除功能：

```
public boolean Delete(String value){
    boolean result = false;
    int location;
    location = Find(value);
    if (location >= 0) {
        moveItemsUp(location);
        numUsed--;
        result = true;
    }
    return result;
} 
```

我的查找功能：

```
public int Find(String value) {
    int result = -1;
    int index = 0;
    boolean found = false;
    while ((index < numUsed) && (!found)) {
        found = (value.equals(storage[index]));
        if (!found)
            index++;
    }
    if (found)
        result = index;
    return result;
} 
```

我的 moveitemsup 函数：

```
private void moveItemsUp(int start){
    int index;
    for (index = start; index < numUsed-1; index++){
        storage[index] = storage[index+1];
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T23:47:10.257

我能看到的问题是：

**问题1**

`begin`在每次删除后，您同时增加索引并“缩小（不是真正缩小）”数组。

例如

`[a,b,c,d,e,f]`, 说你要删除`b-e`索引`1-4`

首先你删除`b (index 1)`然后你`moveItemsUp`删除后。所以数组是： `[a,c,d,e,f,f]`，那么你`begin++`开始是2，指向哪个`d`，跳过`c`

**问题 2**

如果您解决了问题 1，那么您应该考虑另一件事，删除后，数组将`[a,f,f,f,f,f]`是您想要的。

顺便说一句，为什么不考虑使用`LinkedList`？删除应该快得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T02:38:26.410

```
 int begin = Find(start);
    int end = Find(stop);
    int count = end - begin;
    for (int i=0; i <= count; i++){
        Delete(storage[begin]);
        result = true; 
```

将一些代码更改为此，使其工作=）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T23:31:58.433

因此，您正在删除数组索引 1 -3 --

删除数组索引 1 后，您以前的索引 3 现在变为 2，并且您正在递增“开始”..所以现在您删除索引 2.. 在这种情况下是鼠标.. 所以马会被跳过。

相反，您希望保留要删除的元素数量（ end - begin + 1 ）

```
int count = end - begin + 1;
while ( count > 0 ) {
Delete(storage[begin]);
} 
```

类似的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T23:41:40.607

如果您的列表在 ArrayList 中，您为什么不尝试这样的事情（这个盒子上没有 Java 的东西，所以这还没有经过测试）。

```
public boolean deleteRange( String start, String stop ) {
    for(Iterator<String> iter = storage.iterator();iter.hasNext();) {  
        String element = iter.next();  
        if(element.compareTo(start) >= 0 && element.compareTo(stop) <= 0 ) {  
            iter.remove();  
        }  
    }
} 
```

# ios - xcodebuild 失败 clang:error 没有这样的文件或目录：

> ID：14947139
> 
> 赞同：17
> 
> 时间：2013-02-18T23:23:04.363
> 
> 标签：ios, xcode, xcodebuild, adhoc

使用 xcodebuild 构建时遇到问题。我的项目/应用程序使用 Xcode - gui 构建得很好。它根本没有找到/构建作为构建过程一部分的 libcryptopp 库。

错误是：

```
clang: error: no such file or directory: '/Users/builder/repo/ioskpay/xcode-cryptopp/cryptopp/build/Release-iphoneos/libcryptopp.a' 
```

这个特定的文件应该来自主应用程序中的另一个项目 - xcodebuild 根本没有正确指向正确的文件夹，应该是：

```
~/Library/Developer/Xcode/DerivedData 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-10T17:51:07.570

要解决此问题，请转到您的项目设置，转到`Targets`并选择您的主要项目目标。然后去`Build phases`。在`Target dependencies`添加静态库项目下。

这样，当你编译主项目时，静态库子项目在主项目之前被编译，你的静态库将可用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-05-25T14:12:46.853

我有同样的问题，但是对于资源文件 .m

我打开了目标-> 构建阶段-> 编译源

我发现编译器告诉它找不到重复的文件：一个带有奇怪图标，另一个带有普通图标。我只是删除了带有奇怪图标的那个，它起作用了。（我多次添加了文件，在此之前我遇到了合并冲突，导致项目文件出现问题）

对于您的情况，我认为您需要从目标依赖项列表中删除该库并再次添加它。这可能对你有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-05-27T10:15:28.750

我的 xCode 信息是：

![图片](../Images/f6b5b65f2026bef05e1c155007c31a04.png)

我在 xcode 构建项目（**native swift、flutter、react native、native script**）中遇到了类似的错误，其中我收到了与 clang 编译器相关的错误消息。像这样的错误：

*   clang-4.0：错误：没有这样的文件或目录：'/Users/xxxxxxxx/Library/Developer/Xcode/DerivedData/xxxxxxxxxxxxxxx/Index/Data Store'
*   clang-4.0：错误：生成多个输出文件时无法指定 -o
*   其他

尽管与本机应用程序的 DerivedData 相关的错误可以通过删除目录并最终重新启动 xCode 甚至重新启动机器来修复......在这种情况下，您将看到在删除目录并再次开始构建过程后，错误回来。

然后，是通过运行检查 clang 安装的时刻`clang --version`。正常输出将类似于：

![图片](../Images/1a3ffb689286c3ecbedc3e1cec44bcae.png)

如您所见`InstalledDir`，xCode 不正确。就我而言，几天前我需要安装 Anaconda 应用程序（R、Python 等），现在，我记得我必须安装一些依赖项，其中一个是 clang 并且它的安装被改变了。要解决这个问题（在我的情况下，我不再需要 anaconda）：（已编辑）

> 1.- 删除 anaconda 及其所有依赖项（我建议使用 App Cleaner）。2.- 重新安装 xCode

重新安装 xCode 后，如果再次输入`clang --version`，您将得到：

![图片](../Images/ef8c5bf8e827347d0386387d704f729d.png)

更多信息：[https ://github.com/flutter/flutter/issues/32457#issuecomment-496161092](https://github.com/flutter/flutter/issues/32457#issuecomment-496161092)

希望此信息对其他人有所帮助。

最好的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-25T02:10:10.240

在 Xcode 版本 9.2 (9C40b) 中，当我将一堆文件放入项目中时发生了这种情况，其中一些文件是重复的。它不是简单地不添加重复项，而是再次添加它们，并且只添加名称，而不是路径。

在`Target`> `Build Phases`>`Compile Sources`每个重复项后面都没有“...in”。每一个都导致了clang错误。

[![在此处输入图像描述](../Images/2ef392da4286c4f348ded0a767463d08.png)](https://i.stack.imgur.com/9idpG.png)

删除 Xcode 收集的所有重复项后，项目编译并运行。

它使您可以使用 Project Navigator 而不是在 Finder 中管理源文件。然后项目导航器不能像任何像样的文件管理系统（ahem Finder）那样替换重复项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-19T11:15:50.343

有时 Xcode 的表现很奇怪。你必须找到那个静态库项目，例如。在构建阶段的“将二进制文件与库链接”下的“filename.a”，然后将其删除并再次添加。

我在归档目标时遇到了同样的问题。我删除了库，构建成功。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-19T03:13:07.283

好的，只需添加正确的 -target -configuration 和 -scheme 参数，我就可以正常运行。然而，由于我在 Jenkins 中出于自动构建目的运行它，它仍然无法按我的意愿工作 - 卡在完全相同的地方。这很奇怪，因为我在另一个没有这个问题的工作中构建了完全相同的代码。在这一点上没有押韵或理由。我会继续向它射击橡皮筋并在我有答案时更新......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-01-09T22:55:02.327

在 Xcode 项目中查找丢失的文件，即文件可能被删除或丢失。

![在此处输入图像描述](../Images/d9cc469d53d21ac59f3f2abb127032b2.png)

将丢失的文件添加到 xcode，然后一切正常。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-10-14T20:26:21.827

对我来说，这是因为我删除了一个包裹或吊舱。我跑了`pod install`，它修好了

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-08-05T07:24:42.787

运行此命令：

```
$ conda deactivate 
```

# c++ - 类错误，预期；之前（令牌

> ID：14947142
> 
> 赞同：-1
> 
> 时间：2013-02-18T23:23:13.103
> 
> 标签：c++, class, nested

我收到错误：

> 预期的 ';' 在 '(' 标记之前。

为什么会这样？我该如何解决？

```
#include <iostream>

class AB {
int n;
AB(int x) { n = x;}
};

class ED {

AB blee(1);
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T23:25:35.833

这很可能被解析错误并失败：

```
AB blee(1); 
```

如果您尝试初始化 type 的数据成员`AB`，则不能那样做。在 C++11 中，您可以这样做：

```
AB blee{1}; 
```

或者

```
AB blee = 1; 
```

或者，您可以在`ED`的构造函数中执行此操作。这适用于 C++11 和 C++03。

```
class ED {
  ED() : blee(1) {}
  AB blee;
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-18T23:26:35.880

您必须由构造函数通过*member-initialization*进行实例化：

```
class ED {
    ED() : blee(1) {}

    AB blee;
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T23:25:44.683

你想用你的 做`AB blee(1);`什么？它既不是函数声明也不是函数调用。

要调用一个函数，你可以把它放在 的某个成员的主体中`ED`，然后去掉`AB`，只剩下`blee(1);`。

要声明一个函数，您需要`int`在括号内放置一个类型（例如，）：`AB blee(int);`

# python - 在 python 2.7 中，如何比较列表中的特定项目？

> ID：14947145
> 
> 赞同：1
> 
> 时间：2013-02-18T23:23:34.470
> 
> 标签：python, python-2.7

例如，我有一个 for 循环，它将在列表中附加 10 个随机数。我想知道下一个附加项目在每个和每个先前项目的 +- 0.1 内有多少次（不仅仅是前一个连续项目）。

有没有办法将下一个附加项目与列表中的其余项目进行比较？

多谢你们。，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T23:38:53.187

也许是这样的（以 +- 1 作为最大距离）：

```
import random

target = []
for x in (random.randint (1, 10) for _ in range (10) ):
    count = len ( [42 for y in target if abs (x - y) <= 1] )
    print ('{} has {} neighbors.'.format (x, count) )
    target.append (x)

print (target) 
```

使用浮点数和最大距离 0.1：

```
import random

target = []
for x in (random.random () for _ in range (10) ):
    count = len ( [42 for y in target if abs (x - y) <= .1] )
    print ('{} has {} neighbors.'.format (x, count) )
    target.append (x) 
```

# bash - 在一个脚本中 Ping 数百

> ID：14947146
> 
> 赞同：1
> 
> 时间：2013-02-18T23:23:39.420
> 
> 标签：bash, shell, ping

我想在一个游戏上ping一些服务器，它们都是相同的格式，只有可能有数百个。这是我目前使用的：

```
ping server1.servername.com -n 20 | grep Minimum | awk '{print $3}' | sed s/,// >> Output.txt 
```

这将 ping 服务器 20 次，并切断除最小 ping 量之外的所有内容。如果我想对这些服务器中的 300 台进行 ping 操作，我将不得不将同一行粘贴 300 次......是否可以让它在一行中指定类似 1-300 的内容，而不需要 300 行相同的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T23:25:38.523

您可以使用循环：

```
while read line
do
    ping $line.servername.com -n 20 | grep Minimum | awk '{print $3}' | sed s/,// >> Output.txt
done < servers_list 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T23:53:53.013

听起来像是[xargs](http://en.wikipedia.org/wiki/Xargs)的工作，例如，

```
$ cat server-list | xargs -I% ping % -n 20 ... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-18T23:34:43.623

```
rojo@aspire:~$ help for

<snip...>

for ((: for (( exp1; exp2; exp3 )); do COMMANDS; done
    Arithmetic for loop.

    Equivalent to
        (( EXP1 ))
        while (( EXP2 )); do
            COMMANDS
            (( EXP3 ))
        done
    EXP1, EXP2, and EXP3 are arithmetic expressions.  If any expression is
    omitted, it behaves as if it evaluates to 1. 
```

尝试这样的事情：

```
for (( x=1; $x<=300; x++ )); do ( ping server$x.servername.com -n 20 | grep Minimum | awk '{print $3}' | sed s/,// >> Output.txt ); done 
```

**更新：**

这是我在下面对这个答案的评论中提到的骇人听闻的想法。警告：我认为我的 ping 命令必须与您的不同。我正在 Debian 机器上构思这个想法。

而不是`-n count`我的`ping`语法是`-c count`，而不是包含“Minimum”的行，我有“min/avg/max/mdev”。因此，您可能需要使用`grep`语法等。无论如何，考虑到这一点，根据需要修改以下内容以按顺序执行每个服务器的 ping 从 1 到任何直到错误为止。

```
#!/bin/bash
i=0
while [ $? -eq 0 ] && i=$(( i + 1 )); do (
        echo -n "server$i min: "
        ping server$i.servername.com -c 20 -i 0.2 | grep -P -o -e '(?<=\= )\d\.\d+'
); done
echo "n/a" 
```

基本上用简单的英语，这意味着当退出代码 = 0 并递增 i 时，回显服务器名称而不使用换行符，并以 200 毫秒的间隔 ping 它 20 次，用（从 ping 结果中刮取）前面的十进制数完成回显等空间。（该模式与 Linux iputils 摘要中的最小 ping 时间结果匹配`ping`。）如果 ping 失败，退出代码将不等于 0，并且循环将中断。

# c# - 将 WPF 控件绑定到对象

> ID：14947147
> 
> 赞同：0
> 
> 时间：2013-02-18T23:23:47.440
> 
> 标签：c#, .net, wpf

我有一个名为“Employee”的对象，如下：

```
class Employee
{
    public string EmpName { get; set; }
    public string Surname { get; set; }

    public Employee(string Name, string Surname) : base()
    {
        this.EmpName = EmpName;
        this.Surname = Surname;
    }

    public Employee()
    {
    }
} 
```

我这里也有这个简单的“EmployeeControl”。网格中只有两个标签：

```
<UserControl x:Class="LabelBindingTest.EmployeeCtrl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             Name="EmpCtrl"
             d:DesignHeight="120" d:DesignWidth="411">
    <Grid>
        <Label Content="{Binding ElementName=EmpCtrl, Path=EmpName}" Height="28" HorizontalAlignment="Left" Name="label1" VerticalAlignment="Top" Width="81" />
        <Label Content="{Binding ElementName=EmpCtrl, Path=Surname}" Height="28" HorizontalAlignment="Right" Name="label2" VerticalAlignment="Top" Width="81" />
    </Grid>
</UserControl> 
```

（编辑）EmployeeControl 代码隐藏：

```
 public partial class EmployeeCtrl : UserControl
    {
        Employee thisEmployee = new Employee();

        public string EmpName
        {
            get
            {
                return thisEmployee.EmpName;
            }

            set
            {
                thisEmployee.EmpName = value;
            }
        }

        public string Surname
        {
            get
            {
                return thisEmployee.EmpName;
            }

            set
            {
                thisEmployee.EmpName = value;
            }
        }

        public EmployeeCtrl()
        {
            InitializeComponent();
        }
    } 
```

现在，我要做的是将“EmployeeControl”添加到我的窗口并将它们绑定到 Employee 对象。这是我的“窗口”代码：

```
<Window x:Class="LabelBindingTest.MainWindow"
        Name="myWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525" xmlns:my="clr-namespace:LabelBindingTest">
    <Grid>
        <my:EmployeeCtrl EmpName="Daniel" Surname="Hammond" HorizontalAlignment="Left" Margin="23,26,0,0" x:Name="employeeCtrl1" VerticalAlignment="Top" Height="97" Width="429" />
    </Grid>
</Window> 
```

我已经尝试了很多东西，但我就是无法让它发挥作用。它编译得很好，但标签是空的。我只想将我的“Employee”对象附加到“EmployeeCtrl”控件。关于我如何解决这个问题的任何想法？我今天读了很多关于装订的书，但我还在摸不着头脑。我不确定是否需要实现 INotifyPropertyChanged，因为我现在只在运行时之前设置员工姓名。

（编辑）：我已经下载了 Caliburn.Micro 并在上一个答案中使用了相同的代码。同样的结果，空的窗口。

这是整个项目。不过，它的所有代码都应该粘贴在这个问题中。这只是为了方便。

[http://www.mediafire.com/?gux3573rz64mupe](http://www.mediafire.com/?gux3573rz64mupe)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T23:34:02.223

好的，首先我强烈建议您考虑 MVVM，因为您的应用程序变得更加复杂，[如果您使用的是 MVVM，请使用 MVVM 框架](http://www.lhotka.net/weblog/UsingTheMVVMPatternRequiresAFramework.aspx)。我会推荐[Caliburn.Micro](http://caliburnmicro.codeplex.com/)，它可以让你的视图组合变得更容易。还有其他可用的 MVVM 框架，因此请评估它们。

对于您的问题，问题在于您的用户控件没有将其属性实现为依赖项属性。在 XAML 中，您正在设置用户控件的`EmpName`和`Surname`属性，但 UI 不知道在构造用户控件后它们的值已更改，因此不会自行更新。

您`INotifyPropetyChanged`在使用 MVVM 模式时在视图模型上实现，并在用户控件上实现[依赖属性。](http://msdn.microsoft.com/en-gb/library/ms752914.aspx)这两种技术都将通知 UI 更改并强制其自行更新。

因此，对于您的用户控制，您可以执行以下操作：

```
public partial class EmployeeCtrl : UserControl
{
    public static readonly DependencyProperty EmpNameProperty = 
       DependencyProperty.Register("EmpName", typeof(string),
       typeof(EmployeeCtrl), new FrameworkPropertyMetadata(null));

    public static readonly DependencyProperty SurnameProperty = 
       DependencyProperty.Register("Surname", typeof(string),
       typeof(EmployeeCtrl), new FrameworkPropertyMetadata(null));

    public EmployeeCtrl()
    {
        this.InitializeComponent();
    } 

    public string EmpName
    {
       get { return (string)GetValue(EmpNameProperty); }
       set { SetValue(EmpNameProperty, value); }
    }

    public string Surname
    {
       get { return (string)GetValue(SurnameProperty); }
       set { SetValue(SurnameProperty, value); }
    }
} 
```

在这个阶段你实际上根本不需要你的`Employee`类，因为你没有使用它，但理想情况下，`INotifyPropertyChanged`如果它的属性值在构造后会发生变化并且你有一个它的实例绑定到 UI 并且你希望它应该实现待更新的用户界面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T07:14:11.357

您需要在 EmployeeCtrl 的 EmpName 和 Surname 属性上实现 INotifyPropertyChanged，因为此用户控件中的 Label 需要更新此属性值中的值更改，以便标签可以更新其值。因此，您必须在 EmployeeCtrl 的 EmpName 和 Surname 属性上实现 Notify 更改，或者简单地为这两个属性使用依赖属性。希望这可以帮助！！！

# ruby-on-rails - 使用 AFNetworking 的 iOS 客户端正在向服务器发送带有“%”字符的 JSON 参数

> ID：14947152
> 
> 赞同：0
> 
> 时间：2013-02-18T23:24:13.017
> 
> 标签：ruby-on-rails, json, urlencode, afnetworking, params

当我将内容输出到控制台时，我的 iOS 设备正在向我的 Rails 服务器发送 JSON 参数。我看到参数哈希中有奇怪的字符。然后，服务器方法无法使用这些参数创建对象。并且没有任何内容保存在数据库中。我该如何解决？谢谢

从 iOS 设备发送 JSON 的代码：

```
 //Create a Dictionary of Parameters which will be convertedto JSON object
     NSMutableDictionary *mutableParameters = [NSMutableDictionary dictionary];

    [mutableParameters setObject:_entryID forKey:@"id"];
    [mutableParameters setObject:fnameExt forKey:@"image_file_name"];
    [mutableParameters setObject:_lat forKey:@"lat"];
    [mutableParameters setObject:_longitude forKey:@"lng"];
    [mutableParameters setObject:_description forKey:@"description"];

     NSMutableDictionary *photoDict = [NSMutableDictionary dictionaryWithObjects:[NSArray arrayWithObject:mutableParameters]
      forKeys:[NSArray arrayWithObject:@"photo"]];

     //Create a Request Object
      NSMutableURLRequest *mutableURLRequest = [[appAPIClient sharedClient]
                                          multipartFormRequestWithMethod:@"POST"
                                          path:@"/photos"
                                          parameters:photoDict

      constructingBodyWithBlock:^(id<AFMultipartFormData> formData)
                                          { .....} 
```

我的 Rails 服务器

```
 # POST /photos
 # POST /photos.json
 def create
    @photo = Photo.new(params[:photo])
    puts "Photo ="
    puts "Server received Photo with attributes= #{@photo.inspect}"
    @photo.save
 end 
```

服务器上的控制台输出

```
 15:11:19 web.1  | Photo =
 15:11:20 web.1  | Server received Photo with attributes= #<Photo id: nil, lat: nil, 
  lng: nil, created_at: nil, updated_at: nil, image_file_name: "someFile.jpg", 
  image_content_type: "image/jpeg", image_file_size: 0, image_updated_at: "2013-02-
 18 23:11:17">

  15:11:20 web.1  | Started POST "/photos" for 127.0.0.1 at 2013-02-18 15:11:17 -0800
  15:11:20 web.1  | Processing by PhotosController#create as JSON
  15:11:20 web.1  |   Parameters: {"photo%5BentryID%5D"=>"1", 
  "photo%5Blng%5D"=>"-122.406417", "photo%5Blat%5D"=>"37.785834", 
  "photo%5Bimage_file_name%5D"=>"someFile.jpg", 
  "photo%5Bdescription%5D"=>"Description", "photo"=>{"image"=>#
  <ActionDispatch::Http::UploadedFile:0x007fa314c07768 
  @original_filename="someFile.jpg", @content_type="image/jpeg", @headers="Content-
  Disposition: form-data; name=\"photo[image]\"; 
 filename=\"someFile.jpg\"\r\nContent-Type: image/jpeg\r\n", @tempfile=#
  <File:/var/folders/dh/1k2rdp_51yd2k43xzkc2pmdh0000gn/T/RackMultipart20130218-2872-
  13gqqo5>>}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T23:30:02.743

iOS 客户端将参数名称编码为 URL。例如 "photo%5BentryID%5D" 是 "photo[entryID]" 你需要取消编码，虽然这个过程应该在服务器端自动完成，你应该检查你的 iOS 客户端没有对它们进行双重编码。

# android - Android：除非活动正在运行，否则 GCMIntentReceiver 会发出通知

> ID：14947154
> 
> 赞同：0
> 
> 时间：2013-02-18T23:24:20.890
> 
> 标签：android, google-cloud-messaging

所以在我的应用程序中，用户处于某种等待屏幕上，服务器可能会在几秒钟或几分钟内推送他的结果。

所以我希望 GCMIntentReceiver 检查活动是否正在运行。如果是，我想开始其他活动。如果不是，它应该发出通知。

但我不知道该怎么做^^

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T23:28:24.600

第 1 步：让您的活动`BroadcastReceiver`为一些自定义操作字符串实现一个高优先级注册`IntentFilter`，您可以在其中更新您的 UI 并调用`abortBroadcast()`.

第 2 步：`BroadcastReceiver`在清单中为相同的自定义操作字符串设置另一个`Notification`.

第 3 步：从您的`GCMIntentReceiver`.

# c - OpenMP：任务中的竞争条件

> ID：14947157
> 
> 赞同：2
> 
> 时间：2013-02-18T23:24:35.450
> 
> 标签：c, multithreading, parallel-processing, openmp

鉴于此代码示例，练习是使用任务将代码与 OpenMP*并行。*这是一组项目，我们想计算那些好的。

```
int count_good (item_t* item)
{
    int n = 0;
    while (item) {
       if (is_good(item))
          n++;
       item = item->next;
    }
    return n;
} 
```

这不完全是家庭作业。这是为了准备考试。我的想法如下：

```
int count_good (item_t* item)
{
    int n = 0;
    while (item) {
       #pragma omp task
       {
       if (is_good(item))
          n++;
       }
       item = item->next;
    }
    #pragma omp taskwait
    return n;
}
...

int main ()
{
...
#pragma omp parallel
{
#pragma omp single
    count_good(some_times);
}
} 
```

一个问题是，`n`它是单个线程的私有变量，但它可以被不同的任务同时增加。这会产生竞争条件吗？可以避免`#pragma omp critical`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T09:55:38.433

您可以使用`reduction`计数“好”项目。以下代码将为您完成这项工作。你可能想阅读[这个来减少](http://msdn.microsoft.com/en-us/library/88b1k8y5%28v=vs.80%29.aspx)和[这个遍历链表](http://msdn.microsoft.com/en-us/magazine/cc163717.aspx)

```
int nCount = 0;
#pragma omp parallel reduction(+ : nCount)
{       
    for(struct item_t *listWalk = some_items; listWalk != NULL; 
      listWalk = listWalk->next)
    {
        #pragma omp single nowait
        {
            if( isGood(listWalk) ){
            nCount += 1;
            }
        }           
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T12:21:40.527

您必须显式声明`n`为`shared`，否则`firstprivate`默认情况下（因为它隐含`private`在封闭上下文中）。然后为了确保 的原子增量`n`，您应该应用该`atomic update`构造。最后，您的代码应如下所示：

```
int count_good (item_t* item)
{
    int n = 0;
    while (item) {
       #pragma omp task shared(n)
       {
       if (is_good(item))
          #pragma omp atomic update
          n++;
       }
       item = item->next;
    }
    #pragma omp taskwait
    return n;
} 
```

`critical`至少在 x86 上，该构造的开销比原子增量高得多。

# sql - 查询链接多个表上的多对多关系

> ID：14947160
> 
> 赞同：0
> 
> 时间：2013-02-18T23:24:48.690
> 
> 标签：sql, database, oracle, many-to-many, subclass

我正在制作一个测验程序。在测验中，我有很多参与者，但另一方面参与者可以输入许多测验（随着时间的推移）。所以我用链接表克服了这种多对多的关系。到目前为止，我能理解.. 现在我的困难是：参与者可以是一个小组，也可以是一个单独的玩家。

所以一个测验有一个参与者（带有一个链接表），这个参与者或者是一个有几个人的小组，或者这个参与者是一个玩家并且只有一个人。

```
table Quiz : PrimaryKey = quiz_id, (name, date,... )
table QuizParticipant : PrimaryKey = quiz_participant_id, quiz_id 
table ParticipantGroup : PrimaryKey = quiz_participant_id, group_id
table participantPlayer : PrimaryKey = quiz_participant_id, person_id 
```

我的问题是：如何通过 quiz_id 查询测验的所有参与者，最好按类型（组或玩家）对他们进行排序？

关于如何用谷歌搜索这些东西的提示也很有用:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T23:33:33.400

我的建议是始终将您的测验链接到组（多对多）并将单个玩家视为一组 1。因此您的组与玩家相关联（也是多对多）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T23:37:10.833

如果一个人可以属于多个群体，一个群体可以有很多人，那就是另一种多对多关系。既然您知道如何创建这些链接表，请为这种关系创建一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T10:12:57.667

这是一个有趣的设计决定。您进行的方式可以塑造您的整个应用程序。

我的建议是在每次参与时记录参与者类型。这可以是“GROUP”或“PLAYER”，并将定义 ParticipantID 是指 GroupID 还是 PlayerID。这将最终产生最干净的数据库设计和应用程序逻辑。

所以你的表看起来像：

Quiz (QuizID,QuizName) QuizParticipation (ParticipationID, ParticipantType, ParticipantID) Group (GroupID,GroupName) GroupMembers(GroupID,PlayerID) Player(PlayerID,Name)

您可能需要进行自定义约束，以确保不会在 QuizParticipation 表的 ParticipantID 和 ParticipationType 组合字段中创建重复项，或者仔细管理主键的生成。

# ruby - multi_json 适配器逻辑中的堆栈级别太深

> ID：14947163
> 
> 赞同：0
> 
> 时间：2013-02-18T23:25:04.780
> 
> 标签：ruby, ubuntu, rspec, sinatra

我有一个在 OS X 上完美运行的 rspec 套件，但在 ubuntu 上对于调用特定方法的所有规范都失败了。

我看到的错误是：
`SystemStackError - stack level too deep: /home/ubuntu/.rvm/gems/ruby-1.9.3-p194@testset/gems/multi_json-1.5.0/lib/multi_json.rb:75`

如图所示，我依赖于 active_support，它需要 multi_json。该行需要适配器`json_gem`，所有这些似乎都是请求解析的内部内容。实际错误发生在 sinatra 内部某处的端点的请求解析中。我的任何代码都没有被命中（我的调试语句永远不会被命中）。

至于方法，它使用一个包含一个小的预设 JSON 字符串作为主体的 POST 来访问一个正在运行的测试端点。

非常感谢帮助！

# python - 如何用 python 优雅地按部分组合/连接文件？

> ID：14947165
> 
> 赞同：2
> 
> 时间：2013-02-18T23:25:19.327
> 
> 标签：python, perl, concatenation

像我之前的许多不幸的程序员一样，我目前正在处理一种拒绝死亡的古老文件格式。我说的是~1970 年的格式规范过时了。如果完全由我决定，我们会抛弃文件格式和任何知道如何处理它的工具，从头开始。我可以梦想，但不幸的是，这不会解决我的问题。

**格式：**定义很松散，因为多年的荒谬修订几乎破坏了它曾经拥有的所有向后兼容性。基本上，唯一不变的是有部分标题，对于这些行之前或之后的内容几乎没有规则。标题是连续的（例如，HEADING1、HEADING2、HEADING3、...），但没有编号并且不是必需的（例如，HEADING1、HEADING3、HEADING7）。值得庆幸的是，所有可能的航向排列都是已知的。这是一个假的例子：

```
# Bunch of comments

SHOES # First heading
# bunch text and numbers here

HATS # Second heading
# bunch of text here

SUNGLASSES # Third heading
... 
```

**我的问题：**我需要通过这些部分标题连接多个这些文件。我有一个 perl 脚本可以很好地做到这一点：

```
while(my $l=<>) {

    if($l=~/^SHOES/i) { $r=\$shoes; name($r);}
    elsif($l=~/^HATS/i) { $r=\$hats; name($r);}
    elsif($l=~/^SUNGLASSES/i) { $r=\$sung; name($r);}
    elsif($l=~/^DRESS/i || $l=~/^SKIRT/i ) { $r=\$dress; name($r);}
    ...
    ...
    elsif($l=~/^END/i) { $r=\$end; name($r);}
    else {
        $$r .= $l;
    }
    print STDERR "Finished processing $ARGV\n" if eof;
} 
```

正如您所看到的，使用 perl 脚本，我基本上只是在获得某个模式匹配时更改引用指向的位置，并将文件的每一行连接到其各自的字符串，直到获得下一个模式匹配。然后将这些作为一个大的连接文件打印出来。

我会并且可以坚持使用 perl，但我的需求每天都变得越来越复杂，我真的很想看看如何用 python 优雅地解决这个问题（可以吗？）。到目前为止，我在 python 中的方法基本上是将整个文件加载为字符串，搜索标题位置，然后根据标题索引拆分字符串并连接字符串。这需要大量的正则表达式、if 语句和变量来处理在另一种语言中看起来如此简单的东西。

看来这真的归结为一个基本的语言问题。与其他按引用调用的语言相比，我发现了一个关于 python 的“按对象调用”样式的非常好的 SO 讨论。 [如何通过引用传递变量？](https://stackoverflow.com/questions/986006/python-how-do-i-pass-a-variable-by-reference) 然而，我仍然想不出一种优雅的方式在 python 中做到这一点。如果有人可以帮助我朝着正确的方向前进，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T23:47:34.260

这甚至不是优雅的 Perl。

```
my @headers = qw( shoes hats sunglasses dress );

my $header_pat = join "|", map quotemeta, @headers;
my $header_re = qr/$header_pat/i;

my ( $section, %sections );
while (<>) {
    if    (/($header_re)/) { name( $section = \$sections{$1     } ); }
    elsif (/skirt/i)       { name( $section = \$sections{'dress'} ); }
    else { $$section .= $_; }

    print STDERR "Finished processing $ARGV\n" if eof;
} 
```

或者，如果您有很多例外：

```
my @headers = qw( shoes hats sunglasses dress );
my %aliases = ( 'skirt' => 'dress' );

my $header_pat = join "|", map quotemeta, @headers, keys(%aliases);
my $header_re = qr/$header_pat/i;

my ( $section, %sections );
while (<>) {
    if (/($header_re)/) {
       name( $section = \$sections{ $aliases{$1} // $1 } );
    } else {
       $$section .= $_;
    }

    print STDERR "Finished processing $ARGV\n" if eof;
} 
```

使用散列可以保存`my`您未显示的无数声明。

你也可以这样做`$header_name = $1; name(\$sections{$header_name});`，`$sections{$header_name} .= $_`以获得更多的可读性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T23:36:19.147

我不确定我是否理解您的整个问题，但这似乎可以满足您的所有需求：

```
import sys

headers = [None, 'SHOES', 'HATS', 'SUNGLASSES']
sections = [[] for header in headers]

for arg in sys.argv[1:]:
    section_index = 0
    with open(arg) as f:
        for line in f:
            if line.startswith(headers[section_index + 1]):
                section_index = section_index + 1
            else:
                sections[section_index].append(line) 
```

显然，您可以将其更改为读取或`mmap`整个文件，然后`re.search`或仅`buf.find`用于下一个标题。像这样的东西（未经测试的伪代码）：

```
import sys

headers = [None, 'SHOES', 'HATS', 'SUNGLASSES']
sections = defaultdict(list)

for arg in sys.argv[1:]:
    with open(arg) as f:
        buf = f.read()
    section = None
    start = 0
    for header in headers[1:]:
        idx = buf.find('\n'+header, start)
        if idx != -1:
            sections[section].append(buf[start:idx])
            section = header
            start = buf.find('\n', idx+1)
            if start == -1:
                break
    else:
        sections[section].append(buf[start:]) 
```

还有很多其他选择。

但关键是，我看不到在任何这些解决方案中需要通过引用传递变量的任何地方，所以我不确定你在哪里绊倒了你选择的任何一个。

* * *

那么，如果您想将两个不同的标题视为同一个部分怎么办？

简单：创建`dict`到部分的映射标题。例如，对于第二个版本：

```
headers_to_sections = {None: None, 'SHOES': 'SHOES', 'HATS': 'HATS',
                       'DRESSES': 'DRESSES', 'SKIRTS': 'DRESSES'} 
```

现在，在执行 的代码中`sections[section]`，只需执行`sections[headers_to_sections[section]]`.

首先，只需将其设为从字符串到索引而不是字符串到字符串的映射，或者替换`sections`为`dict`. 或者只是使用`collections.OrderedDict`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T23:47:02.797

我最深切的同情！

这是一些代码（请原谅小的语法错误）

```
 def foundSectionHeader(l, secHdrs):
    for s in secHdrs:
      if s in l:
        return True
    return False

  def main():
    fileList = ['file1.txt', 'file2.txt', ...]
    sectionHeaders = ['SHOES', 'HATS', ...]
    sectionContents = dict()
    for section in sectionHeaders:
      sectionContents[section] = []
    for file in fileList:
      fp = open(file)
      lines = fp.readlines()
      idx = 0
      while idx < len(lines):
        sec = foundSectionHeader(lines[idx]):
        if sec:
          idx += 1
          while not foundSectionHeader(lines[idx], sectionHeaders):
            sectionContents[sec].append(lines[idx])
            idx += 1 
```

这假设您没有看起来像“SHOES”/“HATS”等的内容行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T23:37:00.007

假设您正在从标准输入读取，就像在 perl 脚本中一样，应该这样做：

```
import sys
import collections
headings = {'SHOES':'SHOES','HATS':'HATS','DRESS':'DRESS','SKIRT':'DRESS'} # etc...
sections = collections.defaultdict(str)
key = None
for line in sys.stdin:
    sline = line.strip()
    if sline not in headings:
        sections[headings.get(key)].append(sline)
    else:
        key = sline 
```

你最终会得到一个像这样的字典：

```
{
    None: <all lines as a single string before any heading>
    'HATS' : <all lines as a single string below HATS heading and before next heading> ],
    etc...
} 
```

该`headings`列表不必以某种顺序定义，因为标题出现在输入中。

# jsf - 如何为 HelloWorld JSF 配置 web.xml

> ID：14947166
> 
> 赞同：0
> 
> 时间：2013-02-18T23:25:22.577
> 
> 标签：jsf, web.xml

我在使用 JSF 的简单 HelloWorld 项目时遇到问题

我猜问题出在我的 web.xml 文件（如下）中，除了welcome-file-list 标记和子项之外，所有内容都是自动生成的。

我的主要问题是：
1）我如何知道哪个 url 将启动用户浏览网络应用程序的过程？
2）运行应用程序时如何更改默认网址（我注意到更改 web.xml 中的显示名称标签并*没有*阻止它显示为 /Hello/）？
3）我需要像我一样在welcome-file-list中的web.xml中注册jsps吗？
4）我需要在其他地方注册吗？

```
#######Behavior######## 
```

当我右键单击项目（名为 Hello） -> 运行方式 -> 在服务器上运行 -> 选择 JBoss7 时，我被定向到页面 localhost:8080/Hello/ 并收到 404 错误

我希望能够导航到页面 localhost:8080/faces/HelloWorld.jsp 来查看文件，但是这样做会导致 404 错误

我可以通过导航到 localhost:8080/Hello/HelloWorld.jsp 得到 500 错误

$JBossHome/standalone/deployments 中有 Hello.war 和 Hello.war.deployed 而不是 Hello.war.failed

```
#####Notes###### 
```

*我在项目中没有其他 jsp，也没有导航规则（我假设我不需要/想要它们只有一个 jsp）
*我正在使用 JBoss7 和 Eclipse，除了 JSF 之外，我没有对“项目”进行任何添加facets"
*该项目是一个“动态网络项目”
*我使用的是 JSF 2.1.6 Mojarra

我确定我需要发布其他信息/日志文件/等。让我知道

```
#################################
##########HelloWorld.jsp#########
###note this is within body tag##
###all autogenerated stuff I ####
#####didn't bother to post#######

<f:view>
    <h:form>
        Hello, World!
    </h:form>
</f:view>

#################################
#############web.xml#############
#################################

    <?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" version="3.0">
  <display-name>Hello</display-name>
  <context-param>
    <description>State saving method: 'client' or 'server' (=default). See JSF Specification 2.5.2</description>
    <param-name>javax.faces.STATE_SAVING_METHOD</param-name>
    <param-value>client</param-value>
  </context-param>
  <context-param>
    <param-name>javax.servlet.jsp.jstl.fmt.localizationContext</param-name>
    <param-value>resources.application</param-value>
  </context-param>
  <listener>
    <listener-class>com.sun.faces.config.ConfigureListener</listener-class>
  </listener>
  <servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>/faces/*</url-pattern>
  </servlet-mapping> 
    <welcome-file-list>
        <welcome-file>/HelloWorld.jsp</welcome-file>
    </welcome-file-list>
</web-app> 
```

# apache - 在 Mac 上运行 tomcat

> ID：14947175
> 
> 赞同：0
> 
> 时间：2013-02-18T23:26:10.640
> 
> 标签：apache, terminal, tomcat7

嗨，我试图在 mac 中的终端上运行 tomcat，所以我输入 ./startup.sh 来执行脚本。终端然后给我以下信息：

使用 CATALINA_BASE：/Users/kimmy/Documents/Apache/tomcats/apache-tomcat-7.0.35 使用 CATALINA_HOME：/Users/kimmy/Documents/Apache/tomcats/apache-tomcat-7.0.35 使用 CATALINA_TMPDIR：/Users/kimmy/ Documents/Apache/tomcats/apache-tomcat-7.0.35/temp 使用 JRE_HOME：/System/Library/Frameworks/JavaVM.framework/Versions/1.6/Home 使用 CLASSPATH：/Users/kimmy/Documents/Apache/tomcats/apache- tomcat-7.0.35/bin/bootstrap.jar:/Users/kimmy/Documents/Apache/tomcats/apache-tomcat-7.0.35/bin/tomcat-juli.jar

当我尝试访问本地主机以检查 tomcat 服务器是否正在运行时，浏览器显示无法连接到服务器。

有谁知道问题是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-15T11:44:13.870

默认情况下，tomcat 服务器在 mac 上的 9999 端口上运行。

要知道运行tomcat的端口号，请在服务器打开后检查终端。检查“服务器开始于......”行

不使用此端口，您可以通过以下方式请求

[http://localhost:9999](http://localhost:9999)

这将打开服务器页面。

希望这可以帮助。

# java - 比较日期忽略 Joda 中 DateTime 的秒数和毫秒瞬间

> ID：14947176
> 
> 赞同：8
> 
> 时间：2013-02-18T23:26:14.507
> 
> 标签：java, datetime, jodatime, date-comparison

假设我有两个日期，如下所示。

```
DateTimeFormatter formatter = DateTimeFormat.forPattern("dd-MMM-yyyy HH:mm:ss").withZone(DateTimeZone.forID("Asia/Kolkata"));
DateTime firstDate = formatter.parseDateTime("16-Feb-2012 12:03:45");
DateTime secondDate = formatter.parseDateTime("17-Feb-2013 12:03:45"); 
```

我想比较这两个日期，看看`firstDate`是早、晚还是等于`secondDate`。

我可以尝试以下。

```
System.out.println("firstDate = "+firstDate+"\nsecondDate = "+secondDate+"\ncomparison = "+firstDate.isBefore(secondDate));
System.out.println("firstDate = "+firstDate+"\nsecondDate = "+secondDate+"\ncomparison = "+firstDate.isAfter(secondDate));
System.out.println("firstDate = "+firstDate+"\nsecondDate = "+secondDate+"\ncomparison = "+firstDate.equals(secondDate)); 
```

这段代码产生的正是我想要的。

它产生以下输出。

```
firstDate = 2012-02-16T12:03:45.000+05:30
secondDate = 2013-02-17T12:03:45.000+05:30
comparison = true

firstDate = 2012-02-16T12:03:45.000+05:30
secondDate = 2013-02-17T12:03:45.000+05:30
comparison = false

firstDate = 2012-02-16T12:03:45.000+05:30
secondDate = 2013-02-17T12:03:45.000+05:30
comparison = false 
```

* * *

我需要忽略这些日期的秒和毫秒部分。我尝试使用如下的`withSecondOfMinute(0)`和`withMillis(0)`方法。

```
DateTimeFormatter formatter = DateTimeFormat.forPattern("dd-MMM-yyyy HH:mm:ss").withZone(DateTimeZone.forID("Asia/Kolkata"));
DateTime firstDate = formatter.parseDateTime("16-Feb-2012 12:03:45").withSecondOfMinute(0).withMillis(0);
DateTime secondDate = formatter.parseDateTime("17-Feb-2013 12:03:45").withSecondOfMinute(0).withMillis(0); 
```

但它产生了以下输出。

```
firstDate = 1970-01-01T05:30:00.000+05:30
secondDate = 1970-01-01T05:30:00.000+05:30
comparison = false

firstDate = 1970-01-01T05:30:00.000+05:30
secondDate = 1970-01-01T05:30:00.000+05:30
comparison = false

firstDate = 1970-01-01T05:30:00.000+05:30
secondDate = 1970-01-01T05:30:00.000+05:30
comparison = true 
```

该`withSecondOfMinute()`方法的文档描述。

> 返回此日期时间的副本，其中第二分钟字段已更新。DateTime 是不可变的，因此没有设置方法。相反，此方法返回一个更改了 second of minute 值的新实例。

该方法的文档`withMillis()`说。

> 返回具有不同毫秒的此日期时间的副本。返回的对象将是一个新实例或 this。只有毫秒会改变，年表和时区保持不变。

通过完全忽略时间部分来比较日期可以很容易地使用[`DateTimeComparator.getDateOnlyInstance()`](http://joda-time.sourceforge.net/api-release/org/joda/time/DateTimeComparator.html#getDateOnlyInstance%28%29)大致如下来完成。

```
if(DateTimeComparator.getDateOnlyInstance().compare(firstDate, secondDate)==0){}
if(DateTimeComparator.getDateOnlyInstance().compare(firstDate, secondDate)<0){}
if(DateTimeComparator.getDateOnlyInstance().compare(firstDate, secondDate)>0){} 
```

如何比较两个忽略特定时刻的日期`DateTime`（在这种情况下为秒和毫秒）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-18T23:58:56.623

另一种方法是创建一个以分钟为下限的 DateTimeComparator：

```
DateTimeComparator comparator = DateTimeComparator.getInstance(
         DateTimeFieldType.minuteOfHour()); 
```

这将忽略被比较对象的秒和毫秒部分。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-18T23:35:02.737

我认为您想使用[`DateTime#withMillisOfSecond()`](http://joda-time.sourceforge.net/apidocs/org/joda/time/DateTime.html#withMillisOfSecond%28int%29)而不是[`DateTime#withMillis()`](http://joda-time.sourceforge.net/apidocs/org/joda/time/DateTime.html#withMillis%28long%29)：

```
DateTimeFormatter formatter = DateTimeFormat.forPattern("dd-MMM-yyyy HH:mm:ss").withZone(DateTimeZone.forID("Asia/Kolkata"));
DateTime firstDate = formatter.parseDateTime("16-Feb-2012 12:03:45").withSecondOfMinute(0).withMillisOfSecond(0);
DateTime secondDate = formatter.parseDateTime("17-Feb-2013 12:03:45").withSecondOfMinute(0).withMillisOfSecond(0); 
```

设置[`DateTime#withMillis()`](http://joda-time.sourceforge.net/apidocs/org/joda/time/DateTime.html#withMillis%28long%29)为`0`, 会将您的日期都重置为`1/1/1970`，因此您可以`true`访问`equals`它们。

同样，设置[`DateTime#withMillisOfDay()`](http://joda-time.sourceforge.net/apidocs/org/joda/time/DateTime.html#withMillisOfDay%28int%29)为`0`, 会将时间设置为`midnight`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-08T02:30:07.393

```
public static String getFromatDateTime(Date date) {
    SimpleDateFormat sdfDate = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.S");
    final GregorianCalendar gc = new GregorianCalendar();
    gc.setTime( date );
    //gc.set( Calendar.HOUR_OF_DAY, 0 );
    //gc.set( Calendar.MINUTE, 0 );
    //block ignore second and millisecond
    gc.set( Calendar.SECOND, 0 );
    gc.set( Calendar.MILLISECOND, 0 );
    String strDate = sdfDate.format(gc.getTime());
    return strDate;
}
public static void main(String[] args) throws ParseException {
    SimpleDateFormat sdfDate = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.S");
    Date now = new  Date();
    String currentDate = Testing.getFromatDateTime(now);
    String fullDate = "2015-12-07 14:53:39.30";
    String effDateStr = Testing.getFromatDateTime(sdfDate.parse(fullDate));

    System.out.println("Currennt Date: " + currentDate);
    System.out.println("Effective Date: " + effDateStr);
    System.out.println(currentDate.compareTo(effDateStr)==0);
} 
```

# scala - 在 Scala 工作表中使用自定义枚举我收到一个错误：java.lang.ExceptionInInitializerError

> ID：14947179
> 
> 赞同：2
> 
> 时间：2013-02-18T23:26:26.017
> 
> 标签：scala, enums, scala-ide

**更新**- 2014 年 9 月 17 日

事实证明，如果一个地方作为第一个命令，即使**之前更新（从 2013 年 2 月 19 日起）中的解决方案也无法工作；**`println(Value.Player2)`即序数仍然分配不正确。

从那以后，我创建了一个[可验证的工作解决方案作为 Gist](https://gist.github.com/chaotic3quilibrium/57add1cd762eb90f6b24)。实现等待分配序数，直到*所有*JVM 类/对象初始化完成。它还有助于使用附加数据扩展/装饰每个枚举成员，同时对于（反）序列化仍然非常有效。

我还创建了一个[StackOverflow 答案](https://stackoverflow.com/a/25923651/501113)，详细说明了 Scala 中使用的所有不同枚举模式（包括我上面提到的 Gist 中的解决方案）。

* * *

我正在使用全新安装的[TypeSafe IDE](http://typesafe.com/stack/downloads/scala-ide)（预装了 ScalaIDE 的 Eclipse）。我在 Windows 7-64 位。我在 Scala Worksheet 上取得了喜忧参半的成功。在不到一个小时的时间内，它已经使我的机器三度崩溃（完全重置或一次蓝屏死机）。因此，这可能是 Scala 工作表中的错误。我还不确定，也没有时间追查这个问题。但是，这个枚举问题阻止了我进行测试。

我在 Scala 工作表中使用以下代码：

```
package test

import com.stack_overflow.Enum

object WsTempA {
  object Value extends Enum {
    sealed abstract class Val extends EnumVal
    case object Empty   extends Val; Empty()
    case object Player1 extends Val; Player1()
    case object Player2 extends Val; Player2()
  }

  println(Value.values)
  println(Value.Empty)
} 
```

以上工作正常。但是，如果注释掉第一个 println，则第二行会引发异常：java.lang.ExceptionInInitializerError。而且我只是一个 Scala 新手，不明白它为什么会发生。任何帮助将不胜感激。

这是 Scala 工作表右侧的堆栈跟踪（左侧被剥离以便在这里很好地显示）：

```
java.lang.ExceptionInInitializerError
    at test.WsTempA$Value$Val.<init>(test.WsTempA.scala:7)
    at test.WsTempA$Value$Empty$.<init>(test.WsTempA.scala:8)
    at test.WsTempA$Value$Empty$.<clinit>(test.WsTempA.scala)
    at test.WsTempA$$anonfun$main$1.apply$mcV$sp(test.WsTempA.scala:14)
    at org.scalaide.worksheet.runtime.library.WorksheetSupport$$anonfun$$exe
 cute$1.apply$mcV$sp(WorksheetSupport.scala:76)
    at org.scalaide.worksheet.runtime.library.WorksheetSupport$.redirected(W
 orksheetSupport.scala:65)
    at org.scalaide.worksheet.runtime.library.WorksheetSupport$.$execute(Wor
 ksheetSupport.scala:75)
    at test.WsTempA$.main(test.WsTempA.scala:11)
    at test.WsTempA.main(test.WsTempA.scala)
 Caused by: java.lang.NullPointerException
    at test.WsTempA$Value$.<init>(test.WsTempA.scala:8)
    at test.WsTempA$Value$.<clinit>(test.WsTempA.scala)
    ... 9 more 
```

com.stack_overflow.Enum 类来自[这个 StackOverflow 线程](https://stackoverflow.com/a/8620085/501113)。为了简单起见，我在此处粘贴了我的版本（以防我在复制/粘贴操作期间遗漏了一些关键内容）：

```
package com.stack_overflow

//Copied from https://stackoverflow.com/a/8620085/501113
abstract class Enum {

  type Val <: EnumVal

  protected var nextId: Int = 0

  private var values_       =       List[Val]()
  private var valuesById_   = Map[Int   ,Val]()
  private var valuesByName_ = Map[String,Val]()

  def values       = values_
  def valuesById   = valuesById_
  def valuesByName = valuesByName_

  def apply( id  : Int    ) = valuesById  .get(id  )  // Some|None
  def apply( name: String ) = valuesByName.get(name)  // Some|None

  // Base class for enum values; it registers the value with the Enum.
  protected abstract class EnumVal extends Ordered[Val] {
    val theVal = this.asInstanceOf[Val]  // only extend EnumVal to Val
    val id = nextId
    def bumpId { nextId += 1 }
    def compare( that:Val ) = this.id - that.id
    def apply() {
      if ( valuesById_.get(id) != None )
        throw new Exception( "cannot init " + this + " enum value twice" )
      bumpId
      values_ ++= List(theVal)
      valuesById_   += ( id       -> theVal )
      valuesByName_ += ( toString -> theVal )
    }
  }
} 
```

任何形式的指导将不胜感激。

* * *

**更新**- 2013/Feb/19

在使用 Rex Kerr 的几个周期之后，这里是现在可以工作的代码的更新版本：

```
package test

import com.stack_overflow.Enum

object WsTempA {
  object Value extends Enum {
    sealed abstract class Val extends EnumVal
    case object Empty   extends Val {Empty.init}   // <---changed from ...Val; Empty()
    case object Player1 extends Val {Player1.init} // <---changed from ...Val; Player1()
    case object Player2 extends Val {Player2.init} // <---changed from ...Val; Player2()
    private val init: List[Value.Val] = List(Empty, Player1, Player2) // <---added
  }

  println(Value.values)
  println(Value.Empty)
  println(Value.values)
  println(Value.Player1)
  println(Value.values)
  println(Value.Player2)
  println(Value.values) 
```

* * *

```
package com.stack_overflow

//Copied from https://stackoverflow.com/a/8620085/501113
abstract class Enum {

  type Val <: EnumVal

  protected var nextId: Int = 0

  private var values_       =       List[Val]()
  private var valuesById_   = Map[Int   ,Val]()
  private var valuesByName_ = Map[String,Val]()

  def values       = values_
  def valuesById   = valuesById_
  def valuesByName = valuesByName_

  def apply( id  : Int    ) = valuesById  .get(id  )  // Some|None
  def apply( name: String ) = valuesByName.get(name)  // Some|None

  // Base class for enum values; it registers the value with the Enum.
  protected abstract class EnumVal extends Ordered[Val] {
    val theVal = this.asInstanceOf[Val]  // only extend EnumVal to Val
    val id = nextId
    def bumpId { nextId += 1 }
    def compare(that: Val ) = this.id - that.id
    def init() {   // <--------------------------changed name from apply
      if ( valuesById_.get(id) != None )
        throw new Exception( "cannot init " + this + " enum value twice" )
      bumpId
      values_ ++= List(theVal)
      valuesById_   += ( id       -> theVal )
      valuesByName_ += ( toString -> theVal )
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T00:51:02.570

这里有两个问题：一个是由于初始化问题导致代码无法工作，另一个是您遇到了IDE问题。我将只解决代码故障。

问题是您需要`Empty()`在实际访问之前运行`Empty`，但访问内部案例对象不会在外部对象上运行初始化程序，因为它们只是假装是内部对象的成员。（里面没有变量`Value`持有`Empty`。）

`apply()`您可以通过将该方法作为初始化程序的一部分运行来绕过此问题`Empty`：

```
object Value extends Enum {
  sealed abstract class Val extends EnumVal
  case object Empty   extends Val { apply() }
  case object Player1 extends Val { apply() }
  case object Player2 extends Val { apply() }
} 
```

现在您的初始化错误应该消失了。（因为你必须这样做，我建议这`apply()`实际上是一个错误的名称选择；也许`set`或者这样会更好（更短）。

如果你坚持`println`一个`main`方法，这是字节码打印的样子`Value.values`：

```
public void main(java.lang.String[]);
  Code:
   0:   getstatic   #19; //Field scala/Predef$.MODULE$:Lscala/Predef$;
   3:   getstatic   #24; //Field WsTempA$Value$.MODULE$:LWsTempA$Value$;
   6:   invokevirtual   #30; //Method Enum.values:()Lscala/collection/immutable/List;
   9:   invokevirtual   #34; //Method scala/Predef$.println:(Ljava/lang/Object;)V
   12:  return 
```

注意第 3 行，您在其中获得了一个静态字段（这意味着 JVM 确保该字段已初始化）`Values`。但是如果你去`Empty`你会得到

```
public void main(java.lang.String[]);
  Code:
   0:   getstatic   #19; //Field scala/Predef$.MODULE$:Lscala/Predef$;
   3:   getstatic   #24; //Field WsTempA$Value$Empty$.MODULE$:LWsTempA$Value$Empty$;
   6:   invokevirtual   #28; //Method scala/Predef$.println:(Ljava/lang/Object;)V
   9:   return 
```

现在第3行不是指`Values`内部对象而是指内部对象，这意味着首先调用内部对象的初始化程序，然后调用外部对象的初始化程序，然后看到内部对象的初始化程序应该完成（但实际上并没有完成） ......它调用了一个方法然后......繁荣。

如果你把初始化器放在`apply`里面`Empty`，你会被保存，因为`Value`初始化器，即使它被乱序调用，也不会再调用方法了`Empty`。所以奇迹般地成功了。（只要确保你没有引入任何其他方法调用！）

# oracle - UTL_FILE.get_line 返回额外字节 ORACLE

> ID：14947184
> 
> 赞同：0
> 
> 时间：2013-02-18T23:26:41.517
> 
> 标签：oracle

我需要使用 UTL_FILE 检查 .csv 文件的标题

我需要将标题行与数据库中的值进行比较。

```
UTL_FILE.get_line(file_handle, buffer); 
```

例如。

```
 dbms_output.put_line( length(buffer_db)); 20
 dbms_output.put_line( length(buffer)); 21 
```

来自 csv 的 varchar 的长度比来自 db 的值长一个字节。我试过修剪它，什么都不做，末端没有空格。

如果我强制使用最大行大小，它会起作用。

例如。

```
UTL_FILE.get_line(file_handle, buffer, 20); 
```

由于我必须检查多个不同的标题，我不能完全这样做。

我似乎无法弄清楚这个额外的字节是从哪里来的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T00:25:23.460

您可以使用[该`dump()`函数](http://docs.oracle.com/cd/E11882_01/server.112/e10592/functions055.htm)以十进制或十六进制显示字符串中每个字符的数字表示，这样您就可以看到不可打印的字符：

```
select dump(<some string>) from dual; 
```

您不能在调用中`dump`直接`dbms_output`调用 - 它只能在 SQL 语句 (PLS-00204) 中使用 - 但您可以将其分配给另一个变量，然后显示：

```
declare
    ...
    buffer_dump varchar2(4000);
begin
    ...
    utl_file.get_line(file_handle, buffer);
    select dump(buffer) into buffer_dump from dual;
    dbms_output.put_line(buffer_dump);
    ... 
```

由于您正在处理 CSV 文件，因此猜测它具有 Windows 样式的行终止符 (CRLF) 可能是合理的，并且`get_line()`结果中包含回车符，这将由末尾的额外字符表示由`13`（十进制ASCII）表示。

```
declare
    buffer varchar2(4000);
    buffer_dump varchar2(4000);
begin
    buffer := 'Field1,Field2^M'; -- terminated with \r
    select dump(buffer) into buffer_dump from dual;
    dbms_output.put_line(buffer_dump);
end;
/

Typ=1 Len=14: 70,105,101,108,100,49,44,70,105,101,108,100,50,13 
```

如果是这种情况，您可以使用[`replace(<string>, chr(13), '')`](http://docs.oracle.com/cd/E11882_01/server.112/e10592/functions153.htm), 或[`trim(trailing chr(13) from <string>`](http://docs.oracle.com/cd/E11882_01/server.112/e10592/functions219.htm), or 删除它 - 正如您自己发现的那样 - 正则表达式。

```
...
    buffer := trim(trailing chr(13) from buffer);
    select dump(buffer) into buffer_dump from dual;
    dbms_output.put_line(buffer_dump);
...

Typ=1 Len=13: 70,105,101,108,100,49,44,70,105,101,108,100,50 
```

# c# - 如何在 EF 5 的 C# Code-First 中制作自定义验证器

> ID：14947187
> 
> 赞同：-1
> 
> 时间：2013-02-18T23:27:00.970
> 
> 标签：c#, entity-framework, ef-code-first

我试过这个： [How to create Custom Data Annotation Validators](https://stackoverflow.com/questions/3413715/how-to-create-custom-data-annotation-validators) 但是 Visual Studio 说命名空间： using System.ComponentModel.DataAnnotations.ValidationAttribute; 不存在。我使用 EF 5 ..... 我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T23:31:05.050

添加对 System.Componentmodel.DataAnnotations 命名空间的引用。

# hibernate - Hibernate 将 ID 设置为 null

> ID：14947190
> 
> 赞同：0
> 
> 时间：2013-02-18T23:27:35.193
> 
> 标签：hibernate, jakarta-ee, jpa

我有一个问题，即使我明确设置了实体，Hibernate 也会重置实体的 ID。

这是我的两个实体：

```
@Entity
@Table(name="game")
public class Game implements Serializable {

    private String token;

    private Set<DealersCard> dealersCards;

    @Id
    @Size(min=36, max=36)
    @Column(name="token")
    public String getToken() {
        return token;
    }

    public void setToken(String token) {
        this.token = token;
    }

    @OneToMany(fetch=FetchType.EAGER,  cascade={CascadeType.ALL})
    public Set<DealersCard> getDealersCards() {
        return dealersCards;
    }

    public void setDealersCards(Set<DealersCard> dealersCards) {
        this.dealersCards = dealersCards;
    }

} 
```

和

```
@Entity
@Table(name="dealers_card")
public class DealersCard implements Serializable {

    private String token;
    private int id;

    public void setVisible(boolean visible) {
        this.visible = visible;
    }

    @ManyToOne
    @MapsId("token")
    @JoinColumn(name="token", referencedColumnName="token")
    public Game getGame() {
        return game;
    }

    public void setGame(Game game) {
        this.game = game;
    }

    @Id
    @Size(min = 36, max = 36)
    public String getToken() {
        return token;
    }

    public void setToken(String token) {
        this.token = token;
    }

    @Id
    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }
} 
```

当我使用通过 EntityManager::persist 分配的两个 DealersCard 创建 Game 的实例时，对象会在数据库中正确创建，我可以稍后检索它们，但是如果我检索 Game 的实例，请添加 DealersCard 的另一个实例并尝试更新具有 EntityManager::merge 的数据库，休眠，出于某种原因，将令牌字段设置为 null 并将 id 设置为 0，我得到

> javax.persistence.PersistenceException：org.hibernate.exception.ConstraintViolationException：错误：“令牌”列中的空值违反非空约束详细信息：失败行包含（null，0）。

我尝试了 MySQL 和 PostgreSQL，但仍然遇到同样的错误。我正在运行 Glassfish 3.1.2.2、Hibernate Entity Manager 4.1.2、Java EE 6。

任何帮助表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T23:48:24.863

我不相信你的映射是完全正确的。你可能应该有：

```
@OneToMany(fetch=FetchType.EAGER,  cascade={CascadeType.ALL}, mappedBy = "game")
private Set<DealersCard> 
```

在许多方面：

```
@ManyToOne
@JoinColumn(name="token")
private Game game; 
```

然后从多方面删除令牌字段，并只有一个整数，即您的@Id。

确保当您将新的 DealerCards 添加到您的集合时，您在每张卡片上都设置了游戏并将它们添加到集合中。

# c - 多线程等待的“pthread_mutex_lock()”唤醒顺序 是什么？

> ID：14947191
> 
> 赞同：10
> 
> 时间：2013-02-18T23:27:37.033
> 
> 标签：c, multithreading, pthreads

假设我有多个线程在调用`pthread_mutex_lock()`. 当互斥锁可用时，第一个调用的线程是否`pthread_mutex_lock()`获得锁？也就是说，是否`pthread_mutex_lock()`按 FIFO 顺序调用？如果不是，它们的顺序是什么（如果有的话）？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-18T23:30:53.840

> 当互斥锁可用时，第一个调用的线程是否`pthread_mutex_lock()`获得锁？

不会。其中一个等待线程获得了锁，但不确定是哪一个获得了锁。

> 先进先出顺序？

FIFO 互斥体已经是一种模式。请参阅[在 pthreads 中实现 FIFO 互斥锁](https://stackoverflow.com/questions/5385777/implementing-a-fifo-mutex-in-pthreads)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T23:37:47.917

“如果调用 pthread_mutex_unlock() 时 mutex 引用的 mutex 对象上有线程阻塞，导致 mutex 可用，则调度策略应确定哪个线程应获取 mutex。”

除此之外，POSIX 标准并未指定您的问题的答案。它可能是随机的，也可能是 FIFO 或 LIFO 或任何其他顺序，这取决于实现所做的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T23:34:27.460

FIFO 排序可能是效率最低的互斥唤醒顺序。只有真正糟糕的实现才会使用它。最近运行的线程可能能够在没有上下文切换的情况下再次运行，并且最近运行的线程，其更多的数据和代码将在缓存中处于热状态。合理的实现会尝试将互斥锁提供给大多数时间最近持有它的线程。

考虑两个执行此操作的线程：

1.  获取互斥体。
2.  调整一些数据。
3.  释放互斥锁。
4.  转到步骤 1。

现在想象两个线程在单核 CPU 上运行此代码。应该清楚的是，FIFO 互斥体行为会导致每次上下文切换“调整一些数据”——这是最坏的结果。

当然，合理的实现通常确实对公平性有所帮助。我们不希望一个线程没有任何进展。但这很难证明 FIFO 实现是合理的！

# java - 如何在 Java 中将命名空间添加到 XML？

> ID：14947195
> 
> 赞同：-1
> 
> 时间：2013-02-18T23:27:46.517
> 
> 标签：java, xml

我有以下xml。以下 xml 中缺少命名空间。

```
<?xml version="1.0" encoding="UTF-8"?>
<policy>
  <num-drivers>123</num-drivers>
  <risk-policy-ind>false</risk-policy-ind>
  <premium-amt>23.00</premium-amt>
</policy> 
```

正在寻找将上述 xml 作为输入并向其中添加命名空间 (xmlns) 元素的 java 代码？预期的输出xml如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<policy xmlns="http://aaa.bbb.com">
  <num-drivers>123</num-drivers>
  <risk-policy-ind>false</risk-policy-ind>
  <premium-amt>23.00</premium-amt>
</policy> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T11:38:33.860

首先，在上面的 xml 中，risk-policy-ind 标签没有正确关闭。在 XML 中，所有标签都是自定义标签，它们应该关闭。此外，在 xml 中，标签是在没有命名空间的情况下执行的。

如果您只想将 xmlns 属性添加到策略标签，请使用 w3c.dom.Element 创建策略元素并使用 setAttribute 函数设置属性

# types - 什么是相互递归类型？

> ID：14947203
> 
> 赞同：1
> 
> 时间：2013-02-18T23:28:29.017
> 
> 标签：types, sml, ml, recursive-datastructures, mutual-recursion

如果在 ML 中，递归数据类型的示例是：

```
datatype llist = Nil | Node of int * llist 
```

在 ML 中，什么是相互递归的数据类型以及它的一个例子？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T23:56:20.993

一个这样的例子可能是这些愚蠢的数据类型。

```
datatype a = A | Ab of b
and      b = B | Ba of a 
```

它们没有任何意义，但它们表明可以使用`and`关键字（就像函数一样）来引用“提前”的东西，这通常是不可能的

它们是相互的*（因为它们都是......）*递归的*（......相互引用）*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-28T06:15:31.707

相互递归数据类型的标准基本示例是树和森林：森林是树的列表，而树是值和森林（根及其子树的子树的值）。在标准 ML 中，这可以定义如下，允许空树：

```
datatype 'a tree = Empty | Node of 'a * 'a forest
and      'a forest = Nil | Cons of 'a tree * 'a forest 
```

摘自“<a href="http://www.cs.cmu.edu/~rwh/introsml/core/datatypes.htm" rel="nofollow">数据类型”，标准 ML 编程，作者：Robert Harper（2000 ）。

另一个例子是通过产生式规则在形式语法中定义表达式，例如以下用于带括号的整数算术表达式：

```
datatype int_exp = plus of int_term * int_term
                 | minus of int_term * int_term
and     int_term = times of int_factor * int_factor
                 | divide of int_factor * int_factor
                 | modulo of int_factor * int_factor
and   int_factor = int_const of int
                 | paren of int_exp; 
```

来自“<a href="http://homepages.inf.ed.ac.uk/stg/NOTES/node41.html" rel="nofollow">定义数据类型”。

我在 Wikipedia 上更新了“<a href="https://en.wikipedia.org/wiki/Mutual_recursion" rel="nofollow">相互递归”以给出示例（包括标准 ML）。

# python - 在命令行或 Python 中将 CSV 导入 SQLite 数据库

> ID：14947204
> 
> 赞同：0
> 
> 时间：2013-02-18T23:28:42.743
> 
> 标签：python, sqlite

应伯尼的要求，我试图将其浓缩为一个更简单的例子：

我有一个 CSV 文件，其中包含一个月份，其中星期几是列标题：

```
Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday
1,2,3,4,5,6,7
8,9,10,11,12,13,14
15,16,17,18,19,20,21
22,23,24,25,26,27,28 
```

在命令行中，我创建了一个 SQLite 表，天数：

```
sqlite> CREATE TABLE days(
   ...> Monday int,
   ...> Tuesday int,
   ...> Wednesday int,
   ...> Thursday int,
   ...> Friday int,
   ...> Saturday int,
   ...> Sunday int
   ...> ); 
```

尝试从 csv 导入数据时，我得到以下信息：

```
sqlite> .import example.csv days
Error: example.csv line 1: expected 7 columns of data but found 1 
```

如何将此 csv 文件导入数据库，以便识别每个新行？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-14T16:43:47.563

在执行 .import 命令之前，您需要包含以下行：

```
.separator , 
```

这告诉导入命令查找分隔符（在本例中为逗号）。

您可以在此处找到有关 sqlite 命令行命令的更多信息：[http ://www.sqlite.org/sqlite.html](http://www.sqlite.org/sqlite.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-15T03:54:14.730

SQLite shell 相当繁琐。当前版本不包含行标题，其行为在标准 (RFC 4180) 和常见做法之间存在差异。即将发布的 3.8 版本将包含行标题。

由于您使用的是 Python，您可能会发现[APSW Shell](http://apidoc.apsw.googlecode.com/hg/shell.html)很有用（披露：我是作者）。您可以像 SQLite shell 一样从命令行使用它，也可以通过编程方式使用它，包括添加您自己的命令。

值得注意的是，它有一个自动导入命令，可以计算出所有内容，包括标题、分隔符、数据类型等。

```
sqlite> .help autoimport

.autoimport FILENAME ?TABLE?  Imports filename creating a table and
                              automatically working out separators and data
                              types (alternative to .import command)

The import command requires that you precisely pre-setup the table and schema,
and set the data separators (eg commas or tabs).  In many cases this information
can be automatically deduced from the file contents which is what this command
does.  There must be at least two columns and two rows.

If the table is not specified then the basename of the file will be used.

Additionally the type of the contents of each column is also deduced - for
example if it is a number or date.  Empty values are turned into nulls.  Dates
are normalized into YYYY-MM-DD format and DateTime are normalized into ISO8601
format to allow easy sorting and searching.  4 digit years must be used to
detect dates.  US (swapped day and month) versus rest of the world is also
detected providing there is at least one value that resolves the ambiguity.

Care is taken to ensure that columns looking like numbers are only treated as
numbers if they do not have unnecessary leading zeroes or plus signs.  This is
to avoid treating phone numbers and similar number like strings as integers.

This command can take quite some time on large files as they are effectively
imported twice.  The first time is to determine the format and the types for
each column while the second pass actually imports the data. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-03T01:38:01.277

查看 termsql，它是为类似目的而设计的工具。有了它，您的任务将非常轻松。

手册：[http ://tobimensch.github.io/termsql/](http://tobimensch.github.io/termsql/)

检查页面底部的示例。那里有一个用于 CSV 导入，并检查不同的选项是什么。

项目：[https ://github.com/tobimensch/termsql](https://github.com/tobimensch/termsql)

# dos - Ping 和远程命令在两台 Windows 计算机之间不起作用

> ID：14947206
> 
> 赞同：-1
> 
> 时间：2013-02-18T23:28:50.530
> 
> 标签：dos, ping

我有两台电脑。一个是名为 orla-pc 的旧 windows vista，另一个是名为 homelaptop-hp 的新 windows 7
如果我在 orla-pc 上运行命令提示符并键入 `ping homelaptop-hp`
ping 发出四个数据包，但没有收到来自 homelaptop-hp 的任何数据包。
当从 homelaptop-hp ping 到 orla-pc 时也会发生同样的事情，它发送数据包但没有收到它们。我尝试了该命令`tracert`（以跟踪我的 ping 路由）
，结果是： `* * * Request timed out`
我应该怎么做才能使远程命令正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T23:42:09.223

你确定这台电脑的 IP 是 10.0.0.4 吗？你有 DHCP 服务器在运行吗？都在同一个子网掩码中？

如果电脑在 ARP 表中有条目，请尝试使用 cmd 命令“arp -a”查看

也许您的路由器或防火墙阻止了 ICMP 数据包？你能ping通你的路由器吗？

问候

# c++ - 3d 立方体 opengl - 重叠边

> ID：14947210
> 
> 赞同：1
> 
> 时间：2013-02-18T23:29:09.530
> 
> 标签：c++, opengl, 3d, textures

我想用 openGL 创建一个 3d 立方体。另外，我想用我在纹理中转换的图像覆盖每一面。

我在 2D 中找到立方体坐标，并`QUADS`为每一面创建一个。

我的问题是，当我渲染对应立方体侧面的纹理时，我看到这些纹理相互重叠，正如您在这张图片中看到的那样：

![在此处输入图像描述](../Images/3b8ed21f79ea0de9547513dc91b221db.png)

我的代码是：

初始化：

```
glGenTextures(2, textures);
glClearColor (0.0, 0.0, 0.0, 0.0);
glClearDepth(1.0f);                         // Depth Buffer Setup
glEnable(GL_DEPTH_TEST);                        // Enables Depth Testing
glDepthFunc(GL_ALWAYS); 
```

在 xture 中转换图像：

```
up = imread("up.png");

glHint(GL_PERSPECTIVE_CORRECTION_HINT,GL_NICEST);
    glPixelStorei(GL_UNPACK_ALIGNMENT, 1);
    glBindTexture(GL_TEXTURE_2D, textures[1]);
    glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_LINEAR);
    glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_LINEAR);
    gluBuild2DMipmaps(GL_TEXTURE_2D, GL_RGB, up.cols, up.rows, GL_RGB, GL_UNSIGNED_BYTE, up.data); 
```

显示立方体：

```
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glEnable(GL_TEXTURE_2D);

    // Set Projection Matrix
    glMatrixMode (GL_PROJECTION);
    glLoadIdentity();
    gluOrtho2D(0, WIDTH, HEIGHT, 0); 

    // Switch to Model View Matrix
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity(); 

glBindTexture(GL_TEXTURE_2D, textures[1]);
        glBegin(GL_QUADS);
        //sopra
        glTexCoord2f(0.0f, 0.0f); glVertex2f((GLfloat)((coord[6].x)),(GLfloat)(coord[6].y));
        glTexCoord2f(1.0f, 0.0f); glVertex2f((GLfloat)((coord[5].x)),(GLfloat)(coord[5].y));
        glTexCoord2f(1.0f, 1.0f); glVertex2f((GLfloat)((coord[4].x)),(GLfloat)(coord[4].y));
        glTexCoord2f(0.0f, 1.0f); glVertex2f((GLfloat)((coord[7].x)),(GLfloat)(coord[7].y)); 
        glEnd(); 
```

我对立方体的另一面做同样的事情。我渲染纹理的顺序是：

底（地）侧

上边

背后

前面

左边

右边

有什么问题或我错过了什么？或者，Maybe 无法创建具有 2d 坐标 ( `glVertex2f (...)`) 的 3d 立方体？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T23:36:19.990

您无法创建具有 2d 坐标的立方体。边是重叠的，因为它们都在空间的同一平面上。立方体位于 3d 空间中，因此需要 3 个坐标，x、y 和 z。

所以尝试使用：

```
glVertex3f(x, y, z); 
```

并根据您想要每个面的位置使用一些适当的 z 值。

对于纹理，您仍然可以使用：

```
glTexCoord2f(x, y); 
```

因为纹理在二维空间中。

如果您仍然对坐标使用什么感到困惑，我建议您阅读本文以帮助您了解 openGL 中的 3d 空间：

[http://www.falloutsoftware.com/tutorials/gl/gl0.htm](http://www.falloutsoftware.com/tutorials/gl/gl0.htm)

# php - 创建一个按钮以允许用户将页面保存为文件？

> ID：14947211
> 
> 赞同：3
> 
> 时间：2013-02-18T23:29:13.663
> 
> 标签：php, javascript, html, css, printing

有没有什么好的方法可以让用户将页面保存为文件以供以后干净查看，可能是PDF？需要尊重@media print CSS。

考虑的选项：

1.  [http://www.web2pdfconvert.com](http://www.web2pdfconvert.com) - 样式是超基本的并且不考虑@media print - 如果它使用@media print CSS 是可以接受的
2.  触发打印到文件的“打印”按钮，例如 Microsoft XPS Document Writer - 我的理解是这是不可行的，如果用户理解他们可以轻松打印到文件，他们就不需要按钮
3.  Word doc - 具有可编辑的优点，但我的理解是这非常复杂，尤其是动态格式
4.  按钮打开一个单独的 PHP 文件，该文件提供 pdf，就像使用[http://www.fpdf.org/](http://www.fpdf.org/)一样- 我的理解是重新创建我已经用 CSS 制作的格式会有大量工作，并且可能无法100% 到达那里
5.  使用 Word 保存可查看的 html - 因为 CSS 在单独的文件中，所以很难通过电子邮件发送，而且 Word 无论如何处理 CSS 都很差

有没有我想念的更简单的方法？或者是克服我在这些选项之一中发现的障碍的好方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T02:40:17.720

我以前不得不这样做，所以我知道你的痛苦。让我告诉你我的解决方案，然后给你正确的代码。

我决定让用户下载整个页面的 PDF。我想要一个将 HTML 呈现为 PDF 的库。此外，我知道我需要与我的核心站点不同的 CSS。但是，我不想复制它（比如媒体查询支持......用于制作新的换行符等）。因此，我最终使用了投影仪的媒体类型 dompdf，并通过使用 Zend Framework 的一些内置工具加载我的同一页面来加载我的网站。（此解决方案不需要 ZF）。

让我们这样做（哦 - 是的，这不是完美的，但它会让你非常接近！）

1）下载[domPDF](http://code.google.com/p/dompdf/)

2) 在 dompdf_config.custom.inc.php 文件中，取消注释或添加或任何以下行（是的，这并不完美，但我不知道有多少投影仪使用这种媒体类型）：

```
define("DOMPDF_DEFAULT_MEDIA_TYPE", "projection"); 
```

3）然后，修改您的 CSS 以具有媒体查询：

```
@media projection {
    // all of your css to make sure this works fine - like page breaks
} 
```

4) 当然，最后使用 file_get_contents() 或 curl 之类的方法获取整个页面。

这是我最后一段代码的样子（$html = 要保存的页面的全部内容）

```
require_once(APPLICATION_PATH . '/../library/dompdf/dompdf_config.inc.php');
$dompdf = new DOMPDF();
$dompdf->set_protocol('http://');
$dompdf->set_host($options->domain);
$dompdf->load_html($html);
$dompdf->render();
$dompdf->stream('Printed.pdf'); 
```

# android - 手动访问 Android Back Stack

> ID：14947212
> 
> 赞同：0
> 
> 时间：2013-02-18T23:29:19.707
> 
> 标签：android, android-fragments

我在想出解决此问题的方法时遇到问题。

基本上，我的 ActionBar 中有很多选项卡。当每个都被触摸时，前一个选项卡中的片段被分离，新选项卡的片段使用替换（如果它们还没有被实例化）或附加（如果它们有）添加。我想我从谷歌那里得到了这个方法，直到现在它工作得很好。

添加选项卡片段的示例：

```
if(tab.getText().equals(context.getString(R.string.title_class_tab))) {         
        if(browser == null) {
            browser = CourseBrowserFragment.newInstance(false);
            fragmentTransaction.replace(leftContainerId, browser);
        } else {
            fragmentTransaction.attach(browser);
        }

        if(lessonViewer == null) {
            lessonViewer = LessonViewerFragment.newInstance(false);
            fragmentTransaction.replace(rightContainerId, lessonViewer);
        } else {
            fragmentTransaction.attach(lessonViewer);
        }
} 
```

并删除：

```
if(tab.getText().equals(context.getString(R.string.title_class_tab))) {         
        if(browser != null) {
            fragmentTransaction.detach(browser);
        }
        if(lessonViewer != null) {
            fragmentTransaction.detach(lessonViewer);
        }
} 
```

问题来自我需要其中一个选项卡的布局。基本上它就像 Gmail 应用程序。有两个片段（假设面板 A 和面板 B），当您按下按钮面板 A 滑出时，面板 B 滑到面板 A 的旧位置，而新的第三个（面板 C）从右侧滑入。

我的工作正常，但现在我已将滑入 FragmentTransaction 添加到后退堆栈，以便用户可以触摸后退按钮，面板 C 将滑出，面板 A 将返回。同样，就像 Gmail。

除非用户转到不同的选项卡，否则此事务仍在后台堆栈中，并且如果用户按回则执行。碎片最终出现在疯狂的地方。我需要做的是当用户导航到不同的选项卡时将其从后台堆栈中删除。有什么办法可以做到这一点吗？FragmentManager 似乎不允许您手动从后台堆栈中删除内容，并且使用 popBackStack() 方法不仅会删除事务，还会执行它。我想在用户离开时将其删除，并在用户返回时将其放回。

我想我可以使用“getBackStackEntryAt”来获取该事务的“Back Stack Entry”，但如果我不能将其删除并在用户返回选项卡时将其放回原位，那就不好了。

我能想到的唯一可能的解决方案是不使用返回堆栈并覆盖 onBackButtonPressed 。如有必要，我可以从那里进行反向交易。

感谢您的帮助，如果我语无伦次，我们深表歉意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T13:15:24.667

不确定这是否有资格作为解决方案，但我最终只是没有将事务添加到后台堆栈，而只是在用户滑动或按下时进行新事务。该交易只是用动画等与原始交易相反。

我管理后退按钮的方式是，如果我在显示面板 C 的布局中，我将布尔值设置为 true。如果用户滑回面板 A 布局或导航离开，则布尔值设置为 false。然后我覆盖了 Activity 中的 onBackButtonPressed 方法，如果布尔值为真（即：我们在 Panel C 布局中），我运行反向事务，否则我只调用 super.onBackButtonPressed()（即：执行标准后退按钮行为） .

# ios - NSTimeZone：“UTC”和“GMT”有什么区别吗？

> ID：14947213
> 
> 赞同：38
> 
> 时间：2013-02-18T23:29:25.973
> 
> 标签：ios, utc, gmt, nstimezone

这五个陈述是否可以互换，或者是否有人知道使用它们会产生不同结果的情况？从我收集的信息来看，它们是等价的，但我还没有发现任何结论，GMT 和 UTC 变体之间的潜在差异让我担心。

```
[NSTimeZone timeZoneWithName:@"GMT"];
[NSTimeZone timeZoneWithName:@"UTC"];
[NSTimeZone timeZoneWithAbbreviation:@"GMT"];
[NSTimeZone timeZoneWithAbbreviation:@"UTC"];
[NSTimeZone timeZoneForSecondsFromGMT:0]; 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-02-19T00:45:22.213

根据[文档](https://developer.apple.com/library/mac/#documentation/CoreFoundation/Conceptual/CFDatesAndTimes/Concepts/TimeZones.html#//apple_ref/doc/uid/20001140-CJBEJBHH)，`CFTimeZone`（以及扩展， ）使用来自[TZ（或“Olsen”）数据库](http://en.wikipedia.org/wiki/Tz_database)`NSTimeZone`的时区名称、缩写、GMT 偏移量和 DST 信息。

查看[源代码](http://www.opensource.apple.com/source/ICU/ICU-461.12/icuSources/tools/tzcode/)，您会发现虽然语义上的“GMT”和“UTC”截然不同，但实际上它们并没有什么不同：“GMT”只是一个零偏移时区。

**更新**：虽然这个答案对于 1968 年 4 月 9 日之后的日期仍然有效，但在处理历史日期时，Cocoa 似乎使用了在相关日期有效的 GMT 过去定义（而不是现代定义）。这意味着 1968 年 4 月 9 日之前的日期的 GMT 和 UTC 可能不同。有关详细说明，请参阅[此内容丰富的博客文章](http://oleb.net/blog/2011/11/working-with-date-and-time-in-cocoa-part-2/)的末尾。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-19T12:34:33.100

GMT 在几乎所有情况下都意味着 UTC。
但今天，它的本意是错误的。
不幸的是，Apple 使用术语 GMT，而它应该使用 UTC。

GMT 在 UTC 的意义上不再存在（自 1928 年以来），但不幸的是，在英国和非洲，该术语仍用于表示西欧时间或西欧夏令时。今天真正的 GMT 称为 UT，与 UTC 最多相差 0.9 秒。

维基百科上的文章：[英文](https://en.wikipedia.org/wiki/Greenwich_Mean_Time)| [德语](http://de.wikipedia.org/wiki/Greenwich_Mean_Time)

但是在某些计算机程序（邮件标题）中，由于历史原因（unix），它仍然被称为 GMT（在 UTC 的意义上）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-02-19T05:54:16.867

[Apple 的 NSDateFormatter 和 Internet 日期文章](https://developer.apple.com/library/ios/qa/qa1480/_index.html)使用`[NSTimeZone timeZoneForSecondsFromGMT:0]`：

```
static NSDateFormatter *    sRFC3339DateFormatter;
NSString *                  userVisibleDateTimeString;
NSDate *                    date;

// If the date formatters aren't already set up, do that now and cache them
// for subsequence reuse.

if (sRFC3339DateFormatter == nil) {
    NSLocale *                  enUSPOSIXLocale;

    sRFC3339DateFormatter = [[NSDateFormatter alloc] init];

    enUSPOSIXLocale = [NSLocale localeWithLocaleIdentifier:@"en_US_POSIX"];

    [sRFC3339DateFormatter setLocale:enUSPOSIXLocale];
    [sRFC3339DateFormatter setDateFormat:@"yyyy'-'MM'-'dd'T'HH':'mm':'ss'Z'"];
    [sRFC3339DateFormatter setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:0]];
} 
```

# opengl - 将流提示传递给现有纹理？

> ID：14947215
> 
> 赞同：0
> 
> 时间：2013-02-18T23:29:32.817
> 
> 标签：opengl, textures

我有一个由我的代码的另一部分创建的纹理（使用 QT5 的 bindTexture，但这不相关）。

如何设置 OpenGL 提示该纹理将经常更新？

```
 glBindTexture(GL_TEXTURE_2D, textures[0]);
    //Tell opengl that I plan on streaming this texture
    glBindTexture(GL_TEXTURE_2D, 0); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T23:39:10.890

没有机制来指示纹理将被重复更新；仅通过*使用*参数与缓冲区（例如，VBO 等）相关。但是，有两种可能性：

1.  将您的纹理附加为帧缓冲区对象并以这种方式更新它。这可能是完成您所要求的最有效的方法。与纹理关联的内存仍然驻留在 GPU 上，您可以以渲染速度对其进行更新。
2.  尝试使用*像素缓冲区对象*（通常称为 PBO，并且具有 OpenGL 缓冲区类型`GL_PIXEL_UNPACK_BUFFER`）作为 Qt 将其生成的纹理写入的缓冲区，并将该缓冲区标记为`GL_DYNAMIC_DRAW`. 对于每次更新，您仍然需要`glTexImage*D()`使用 PBO 的缓冲区偏移量（即可能为零）进行调用，但这种方法可能比直接通过`glTexImage*D()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T23:39:12.583

没有这样的提示。OpenGL 定义的是功能，而不是性能。只需在需要时上传即可。

# sublimetext2 - Sublime Text 2 图片预览插件

> ID：14947217
> 
> 赞同：6
> 
> 时间：2013-02-18T23:29:47.147
> 
> 标签：sublimetext2

有谁知道 Sublime Text 2 的插件可以让你预览图像？我现在倾向于将 Sublime 用于一切，但我想念 Coda 的一件事是无需离开程序即可查看图片的能力。

如果这已经在其他地方得到回答，我们深表歉意。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-22T06:03:10.030

Sublime Text 3 dev build 3055 在打开图像时实现了图像预览。

[您可以在官方网站](http://www.sublimetext.com/3dev)上下载开发版本。

Sublime Text 3 开发版本目前仅对注册用户可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-18T13:00:21.583

这个打开默认图像查看器 [Sublime-Text-2-Image-Viewer](https://github.com/rmaksim/Sublime-Text-2-Image-Viewer)

# python - 如何使用 BeautilSoup 提取表信息？

> ID：14947218
> 
> 赞同：2
> 
> 时间：2013-02-18T23:29:48.193
> 
> 标签：python, web-scraping, beautifulsoup

我正在尝试从此类[页面](http://www.drexelmed.edu/Home/AboutOurFaculty/SandeepAggarwal.aspx)中抓取信息。

我需要`Internship`, `Residency`,下包含的信息`Fellowship`。我可以从表中提取值，但在这种情况下，我无法决定使用哪个表，因为标题（如`Internship`）`div`作为简单的纯文本出现在表外的标记下，然后表出现了我需要的值提取。而且我有很多这样的页面，没有必要每个页面都有这些值，就像在某些页面中`Residency`可能根本不存在一样。（这会减少页面中的表格总数）。此类页面的一个示例是[this](http://www.drexelmed.edu/Home/AboutOurFaculty/NabilAbaza.aspx)。在此页面`Internship`中根本不存在。

我面临的主要问题是所有表都具有相同的属性值，因此我无法决定将哪个表用于不同的页面。如果页面中不存在我感兴趣的任何值，我必须为该值返回一个空字符串。

我在 Python 中使用 BeautifulSoup。有人可以指出，我该如何继续提取这些值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T02:48:53.670

看起来标题和数据的 id 都有唯一的值和标准的后缀。您可以使用它来搜索适当的值。这是我的解决方案：

```
from BeautifulSoup import BeautifulSoup

# Insert whatever networking stuff you're doing here. I'm going to assume
# that you've already downloaded the page and assigned it to a variable 
# named 'html'

soup = BeautifulSoup(html)
headings = ['Internship', 'Residency', 'Fellowship']
values = []
for heading in headings:
    x = soup.find('span', text=heading)
    if x:
        span_id = x.parent['id']
        table_id = span_id.replace('dnnTITLE_lblTitle', 'Display_HtmlHolder')        
        values.append(soup.find('td', attrs={'id': table_id}).text)
    else:
        values.append('')

print zip(headings, values) 
```

# r - 在 Rcpp (cppFunction) 中使用用户定义的函数

> ID：14947219
> 
> 赞同：2
> 
> 时间：2013-02-18T23:29:56.283
> 
> 标签：r, rcpp

我在 r 中有一个用户定义的函数：

```
blacksch<-function(s_0,k,sigma,r,t)
{
  d1=(log(s_0/k) + (r + (sigma^2)/2)*(t))/(sigma*sqrt(t))
  d2=(log(s_0/k) + (r - (sigma^2)/2)*(t))/(sigma*sqrt(t))

  p=(pnorm(-d2)*k*exp(-r*t))-pnorm(-d1)*s_0
} 
```

我想在使用 Rcpp 和 cppFunction 编写的 c++ 代码中使用这个函数。我已经通过文档和示例几次，但没有成功。

```
bs_martin<-cppFunction('NumericMatrix compMartin (NumericMatrix st, NumericMatrix dv, double s_0, double k, 
                       double t, double sigma, double r, int steps, int paths, Function blacksch(fun)) {

                       // Ensure RNG scope set
                       RNGScope scope;

        int min_bs_step=0;
        double minbsvalue=0;
        vector<double> u[0]=100.0;
        for(int i=1;i<=paths; i++)
        {
          min_bs_step=0;
          for(int j=1;j<=steps;j++)
          {
            if (dv[i,j]>0 && min_bs_step==0)
            {
                min_bs_step=i;
                minbsvalue=blacksch(s_0,k,sigma,r,t);
            }
            else if (min_bs_step!=0)
            {
                dv[i,j]=1 - minbsvalue;
            }
          }

        }
      return dv;
                       }') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T23:46:57.460

我建议如下：

*   研究我们的文档和示例。我们也展示了如何传递函数，即使我们不推荐它（出于明显的性能原因，从 C++ 调用 R 并不快）。

*   如果您有些复杂的示例不起作用，请尝试使用较小的示例。归根结底，您可能只需要一个接收两个数字并将其传递给提供的函数的测试器。

*   最后：你真的`blacksch`也想要 C++。所有统计功能都可以在相同的名称下使用。

# php - Codeigniter：如何判断模型是否已加载？

> ID：14947220
> 
> 赞同：7
> 
> 时间：2013-02-18T23:29:59.160
> 
> 标签：php, codeigniter, class, model

是否有可以用来判断某个模型是否已加载的本机 codeigniter 函数？可以使用 php`class_exists()`来判断模型是否已经加载？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-19T03:00:15.393

我很想扩展`CI_Loader`核心类。（见[扩展核心类](http://ellislab.com/codeigniter/user-guide/general/core_classes.html)）

```
class MY_Loader extends CI_Loader {

    function __construct()
    {
        parent::__construct();
    }

    /**
     * Returns true if the model with the given name is loaded; false otherwise.
     *
     * @param   string  name for the model
     * @return  bool
     */
    public function is_model_loaded($name) 
    {
        return in_array($name, $this->_ci_models, TRUE);
    }
} 
```

您将使用以下内容检查给定模型：

```
$this->load->is_model_loaded('foobar'); 
```

[该策略](https://github.com/EllisLab/CodeIgniter/blob/2.1-stable/system/core/Loader.php#L264)已被`CI_Loader`班级使用。

此解决方案支持 CI 的模型命名功能，其中模型可以具有与模型类本身不同的名称。该`class_exists`解决方案不支持该功能，但如果您不重命名模型，应该可以正常工作。

注意：如果您更改了`subclass_prefix`配置，它可能不再是`MY_`。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-06-14T11:13:25.427

最简单的解决方案是使用 PHP 函数**class_exists**

[http://php.net/manual/en/function.class-exists.php](http://php.net/manual/en/function.class-exists.php)

例如。如果要检查 Post_model 是否已定义。

```
$this->load->model('post_model');

/*

     a lot of code

*/

if ( class_exists("Post_model") ) {
    // yes
}
else {
    // no
} 
```

最简单的就是最好的。。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-19T01:13:58.737

编辑：

您可以使用 log_message() 函数。

把它放在你模型的构造函数中（parent::Model()）

```
log_message ("debug", "model is loaded"); 
```

不要忘记在 config.php 文件中将日志配置设置为调试模式

```
$config['log_threshold'] = 2; 
```

并将system/logs目录权限设置为可写（默认CI会在此处创建日志文件）

或在另一个目录中设置日志目录

```
$config['log_path'] = 'another/directory/logs/'; 
```

然后 CI 将在目录中创建日志文件。根据需要监视日志文件。您可以获取调试消息以查看您的模型是否已加载或不在日志文件中。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-12-20T11:55:18.910

引用 Maxime Morin 和 Tomexsans 所写的内容，这是我的解决方案：

```
<?php 
class MY_Loader extends CI_Loader { 
    /**
     * Model Loader
     *
     * Overwrites the default behaviour
     *
     * @param   string  the name of the class
     * @param   string  name for the model
     * @param   bool    database connection
     * @return  void
     */
    function model ($model, $name = '', $db_conn = FALSE) {
        if (is_array($model) || !class_exists($model)) {
            parent::model($model, $name, $db_conn);
        }
    }
}
?> 
```

这样，您就不需要（有意识地）检查模型是否已加载:)

# c# - 为什么 Emit 中具有显式重载的接口实现对于公共和非公共的表现不同？

> ID：14947225
> 
> 赞同：1
> 
> 时间：2013-02-18T23:30:07.707
> 
> 标签：c#, .net, reflection, reflection.emit

我已经使用 Reflection.Emit 很长时间了，但这次它没有任何意义......在我的程序的某个地方，我正在使用 emit 实现接口。例如：

```
typeBuilder.AddInterfaceImplementation(intf); 
```

因为我正在实现多个接口并且接口可以从其他接口继承，所以我对方法/接口进行了重复数据删除。（虽然这里不相关，但我将在我的示例中使用一些众所周知的接口）。例如，如果我同时实现 IList 和 IDictionary，它们都实现 ICollection，而我只实现 ICollection 一次。

之后，我开始使用生成的方法和接口列表向 typeBuilder 添加方法。没什么特别的，只是：

```
MethodBuilder mb = typeBuilder.DefineMethod(
    name,
    MethodAttributes.HideBySig | MethodAttributes.NewSlot | MethodAttributes.Virtual |
    MethodAttributes.Final | specialAttributes, CallingConventions.HasThis,
    returnType,
    parameterTypes);

// [...] emit code that doesn't really matter here

typeBuilder.DefineMethodOverride(mb, baseMethodFromInterface); 
```

请注意，我明确定义了方法覆盖。我这样做是因为名字可能会发生冲突，f.ex。在上面的示例中，IList 和 ICollection 都公开了一个 Count getter (name = get_Count)，这将导致名称冲突。

现在假设我在生成方法时使用名称“Count”。正如我之前注意到的，有几个从 IList 派生的接口实现了这个属性。我感到困惑的是，显然现在“Count”也隐式地继承自其他 Count 方法——即使我没有将其定义为 Override……但前提是我将属性公开为公共。（例如 specialAttributes = MethodAttributes.Public）。发生的情况是 PEVerify 会给出一个错误，但代码会运行得很好：

```
[IL]: Error: [c:\tmp\emit\Test.dll : Test::get_Count][offset 0x00000012] Method is not visible. 
```

为了解决这个问题，我尝试更改 specialAttributes = MethodAttributes.Private - 但由于一个小错误，我没有显式地实现所有 Count 事物（使用 DefineMethodOverride）。奇怪的是，CreateType 现在告诉我“Count [...] 没有实现”。- 例如，它找不到充当覆盖的 Count 方法。

但是，由于我使用的是 DefineMethodOverride，我想知道为什么它首先会起作用？换句话说：“私人”错误是有道理的，它在使用公共方法时起作用的事实并不在 IMO 中。

所以对于我的问题：为什么.NET 会隐式地覆盖具有相同名称的公共方法，即使您将覆盖*显式*定义为另一个方法的覆盖（这对我来说听起来像是 .NET 中的一个错误......）？为什么这行得通？当您将方法公开为公共时，为什么 PEVerify 会给出错误？

**更新**

显然 PEVerify 错误是不相关的：在将所有内容设为私有并显式实现所有方法之后，PEVerify 仍然给出相同的错误。该错误与调用错误的方法有关，例如：

```
// Incorrect: attempt to call a private member -> PEVerify error
callvirt instance void [mscorlib]System.Collections.Generic.Dictionary`2<string, int32>::System.Collections.IDictionary.Remove(object)

// Correct: call the interface using a vtable lookup
callvirt instance void [mscorlib]System.Collections.IList::Remove(object) 
```

尽管如此，这只是一个偏题，问题仍然存在。

**更新 +1**

我做了我认为最小的测试用例。这基本上会生成一个 DLL，您应该使用您喜欢的工具对其进行检查。请注意，我在这里只实现 1 个方法，而不是 2 个（！）第二个方法被“自动”覆盖，即使我明确告诉 .NET 该方法实现了第一个方法。

```
public interface IFoo
{
    int First();
    int Second();
}

public class FooGenerator
{
    static void Main(string[] args)
    {
        CreateClass();
    }

    public static void CreateClass()
    {
        // Create assembly
        var assemblyName = new AssemblyName("test_emit.dll");
        var assemblyBuilder =
            AppDomain.CurrentDomain.DefineDynamicAssembly(assemblyName,
            AssemblyBuilderAccess.RunAndSave, @"c:\tmp");

        // Create module
        var moduleBuilder = assemblyBuilder.DefineDynamicModule("test_emit", "test_emit.dll", false);

        // Create type : IFoo
        var typeBuilder = moduleBuilder.DefineType("TestClass", TypeAttributes.Public);
        typeBuilder.AddInterfaceImplementation(typeof(IFoo));

        ConstructorBuilder constructorBuilder = typeBuilder.DefineConstructor(
            MethodAttributes.Public | MethodAttributes.HideBySig |
            MethodAttributes.SpecialName | MethodAttributes.RTSpecialName,
            CallingConventions.HasThis, Type.EmptyTypes);

        // Generate the constructor IL. 
        ILGenerator gen = constructorBuilder.GetILGenerator();

        // The constructor calls the constructor of Object
        gen.Emit(OpCodes.Ldarg_0);
        gen.Emit(OpCodes.Call, typeof(object).GetConstructor(
            BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Instance, Type.DefaultBinder, Type.EmptyTypes, null));
        gen.Emit(OpCodes.Ret);

        // Add the 'Second' method
        var mb = typeBuilder.DefineMethod("Second",
            MethodAttributes.HideBySig | MethodAttributes.NewSlot | MethodAttributes.Virtual |
            MethodAttributes.Final | MethodAttributes.Public, CallingConventions.HasThis,
            typeof(int), Type.EmptyTypes);

        // Implement
        gen = mb.GetILGenerator();

        gen.Emit(OpCodes.Ldc_I4_1);
        gen.Emit(OpCodes.Ret);

        typeBuilder.DefineMethodOverride(mb, typeof(IFoo).GetMethod("First"));

        typeBuilder.CreateType();
        assemblyBuilder.Save("test_emit.dll");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T18:24:33.053

如果您有多个具有相同名称和签名的方法，则您的类型无效。如果您想显式实现一个接口，那么通常您会使用具有不同名称的私有方法（例如，C# 编译器使用类似的东西`IList.Count`代替`Count`）。

**更新**

在您更新后，我现在看到我的诊断有点倒退。如果一个类被声明为实现一个接口并且有一个没有匹配方法覆盖的接口方法，则 CLR 将搜索具有相同名称和签名的方法。没有办法告诉 CLR 不要这样做（除了为该接口方法提供不同的特定覆盖），并且相同的具体方法可以覆盖多个接口方法，设计。`Third`同样，调用您的具体方法并显式覆盖`First`and也是非常好的`Second`。

**更新 2**

我会尝试回答你的另一个问题，但“为什么”问题总是很难。首先，向接口添加方法是一个严重的重大变化，基本上永远不会发生 - 如果您向接口添加新方法，那么您会期望所有实现该接口的类（如果您的接口是公共的）将中断，因为他们声称实现了接口但缺少方法。

能够用单个具体实现覆盖多个接口方法似乎没有什么缺点。通常，这些方法来自不同的接口，因此这将是一种避免创建多个相同实现的便捷方法（假设不同的接口方法具有相同的语义，因此通过单个方法覆盖它们是有意义的）。同样，CLR 可以方便地通过名称+签名查找方法，而不需要显式映射。您的案例基本上是这些更通用机制的一个非常奇怪的极端案例实例，其中来自同一接口的多个方法由一个插槽实现，一次通过显式覆盖，一次通过默认查找。这很奇怪，看起来不像'

# javascript - SVG - 根据不同角度获得点的三角函数

> ID：14947226
> 
> 赞同：0
> 
> 时间：2013-02-18T23:30:10.543
> 
> 标签：javascript, svg

我正在使用 vivagraph 库，我试图得到一个取决于两个节点的角度的点。

但我不知道我是如何得到这一点的。我得到两个节点之间的角度，但不知道我如何计算点。

我使用程序员的示例，并在此处上传了我的扩展

[http://jsbin.com/umepoq/3/](http://jsbin.com/umepoq/3/)

我试图在草图中说得更清楚 [http://imageshack.us/a/img844/3904/stackoverflowfrage.png](http://imageshack.us/a/img844/3904/stackoverflowfrage.png)

也许有人可以给我一个提示。：） 提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T14:02:23.187

假设黑白图片是 A 点，蓝色背景图片保持固定并且是 B 点，黑点是 C 点。如果我理解正确，您希望角度 ABC 在 A 点移动时保持不变。

如果当您将组旋转一个角度时，图片的三个部分都属于同一组，则该组中的所有部分都将旋转相同的角度。这应该保留角度 ABC。

# c# - 实现接口的 MVC 控制器

> ID：14947228
> 
> 赞同：1
> 
> 时间：2013-02-18T23:30:37.920
> 
> 标签：c#, asp.net-mvc, castle-windsor

有没有人设法在 MVC 4 中使用 Castle Windsor 做到以下几点？在观看有关六边形架构的视频并尝试更多地驱动领域后，我目前正在尝试 - 即专注于对象之间的消息。

```
public class UserController : Controller, ICreatedUser
{
   public IUserCreator _creator;

   public class UserController(IUserCreator creator)
   {
      _creator = creator;
   }

   public void Create(CreateUserModel model)
   {
      _creator.Create(model);
   }

   public ViewResult Successful(User user)
   {
       return View(user);
   }

   public ViewResult Unsuccessful()
   {
      return View();
   }
}
public interface ICreatedUser
{
   ViewResult Successful(User user);
   ViewResult Unsuccessful();
}

public class UserCreator : IUserCreator
{
  private ICreatedUser _createdUser;

  public class UserCreator(ICreatedUser createdUser)  // I want the controller injected here
  {
      _createdUser = createdUser;
  }
} 
```

我知道其中一个问题是 ICreatedUser 上的“ViewResult”对 UI 来说太具体了——可能是 C# 的限制。

# c# - 逐行浏览文件流（不使用 StreamReader）（Visual C#）

> ID：14947233
> 
> 赞同：0
> 
> 时间：2013-02-18T23:31:03.887
> 
> 标签：c#, file, io

我有一个文件，我必须从中跳过 4 行，然后跳过 2 个字节问题是如果我使用 StreamReader，我不能移动 2 个字节，因为没有按字节读取。如果我使用 FileStream，我无法移动它逐行

我尝试使用 StreamReader 逐行读取，然后使用 BaseStream 属性获取流并向上移动 2 个字节，但是当我获取 BaseStream 时，位置又回到了文件的前面。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T23:56:26.390

您可以使用 逐字节读取`FileStream`并计算换行符吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:09:03.637

如果您使用 TextReader，您可以像这样逐行读取文件：

```
TextReader rdr = File.OpenText(sourceFile);
string line;
while ((line = rdr.ReadLine()) != null)
{
    ProcessLine(line);
} 
```

跳过一行只是简单地调用`ReadLine`而不对结果做任何事情。

# python - 在python中更改文件的第一行

> ID：14947238
> 
> 赞同：33
> 
> 时间：2013-02-18T23:31:21.967
> 
> 标签：python

我只需要读取一个大文件的第一行并进行更改。

是否有只更改文件的第一行并使用 Python 将其保存为另一个文件的技巧？我所有的代码都是用 Python 完成的，可以帮助我保持一致性。

这个想法是不必读取然后写入整个文件。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-02-18T23:45:32.987

[`shutil.copyfileobj()`](https://docs.python.org/3/library/shutil.html#shutil.copyfileobjeobj)应该比逐行运行快得多。来自文档的注释：

> 注意如果[from_file]对象的当前文件位置不为0，则只会复制从当前文件位置到文件末尾的内容。

因此：

```
from_file.readline() # and discard
to_file.write(replacement_line)
shutil.copyfileobj(from_file, to_file) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-18T23:37:04.363

如果要修改文件的第一行并将其保存为新文件名，则不可能简单地修改第一行而不迭代整个文件。从好的方面来说，只要你不打印到终端，修改文件的第一行是非常非常快的，即使在非常大的文件上也是如此。

假设您正在使用基于文本的文件（不是二进制文件），这应该满足您的需求并且对于大多数应用程序来说表现得足够好。

```
import os
newline = os.linesep # Defines the newline based on your OS.

source_fp = open('source-filename', 'r')
target_fp = open('target-filename', 'w')
first_row = True
for row in source_fp:
    if first_row:
        row = 'the first row now says this.'
        first_row = False
    target_fp.write(row + newline) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-18T23:51:03.683

不需要遍历不感兴趣的行的替代解决方案。

```
def replace_first_line( src_filename, target_filename, replacement_line):
    f = open(src_filename)
    first_line, remainder = f.readline(), f.read()
    t = open(target_filename,"w")
    t.write(replacement_line + "\n")
    t.write(remainder)
    t.close() 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-18T23:34:03.687

除非新行与旧行长度相同，否则不能这样做。如果是，您可以通过[mmap](http://docs.python.org/2/library/mmap.html)解决此问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-01-26T02:34:36.497

该`sh`模块对我有用：

```
import sh

first = "new string"
sh.sed("-i", "1s/.*/" + first + "/", "file.x") 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-19T11:06:41.907

我将使用的解决方案是使用创建一个缺少旧第一行的文件

`from_file.readline() # and discard shutil.copyfileobj(from_file, tail_file)`

然后用新的第一行创建一个文件

然后使用以下内容连接 newfirstline 文件和 tail_file

```
for f in ['newfirstline.txt','tail_file.txt']:
with open(f,'rb') as fd:
    shutil.copyfileobj(fd, wfd, 1024*1024*10 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-21T09:58:25.770

这是“Nacho”答案的工作示例：

```
import subprocess

cmd = ['sed', '-i', '-e', '1,1s/.*/' + new_line + '/g', 'filename.txt']

subprocess.call(cmd) 
```

# spring - spring 在哪里存储 xml 配置文件

> ID：14947247
> 
> 赞同：0
> 
> 时间：2013-02-18T23:32:17.757
> 
> 标签：spring, jakarta-ee, configuration-files, directory-structure

我正在开发一个 spring 项目，我刚刚在 junit 中加载 XML 配置文件时遇到了严重问题（但它们可以从 Web 控制器访问） - 无法加载 XML 文件。

我列出了我的类路径（在 junit 测试中），发现其中包括 2 个目录：

```
/var/www/Java/lyricsBase/build/web/WEB-INF/classes/
/var/www/Java/lyricsBase/build/test/classes/ 
```

我只想在测试中包含一个文件：

*   /WEB-INF/lyricsBaseApp-servlet.xml

它导入以下 3 个文件：

*   /WEB-INF/hibernate.xml
*   /WEB-INF/dataSource.xml
*   /WEB-INF/beans.xml

我可以清楚地看到，在 tomcat 上部署我的项目会将 confg 文件复制到`/var/www/Java/lyricsBase/build/web/WEB-INF/ABC.xml`但该目录不在类路径中，`/var/www/Java/lyricsBase/build/web/WEB-INF/classes`而是包含在内。我读到 WEB-INF 不应该在类路径中（这只是 Java EE 原则）。好的 - 那么我应该把我的配置文件放在哪里，以便从 web 控制器和 junit 测试中轻松访问它们？有什么好的做法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T01:13:08.440

将配置文件放在war包的WEB-INF/classes下，它们将被加载到类路径中。考虑将您的代码部署为一场爆炸式战争，以便可以轻松更改配置文件。

还可以考虑使用 maven war 项目进行打包。如果你这样做了，你可以把你的配置文件放在源代码下的 src/main/resources 下，它们会被打包到 WEB-INF/classes 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T23:41:29.523

我遇到了同样的问题，从那时起开始将它们放在 META-INF 下的资源中。这是不在 Tomcat 中运行的 spring 模板项目放置它们并且似乎解决了我的问题的地方。

# c# - 水晶报表文本对象控件左属性测量

> ID：14947249
> 
> 赞同：0
> 
> 时间：2013-02-18T23:32:24.720
> 
> 标签：c#, .net, winforms, crystal-reports

当我想在 .rpt 文件中设计报告时，我添加了一个文本对象。我想由用户设置位置。所以我使用了下面的代码：

```
 ReportDocument rd = new ReportDocument();
        rd.Load(Environment.CurrentDirectory + "\\CrystalReport1.rpt");
        TextObject to = ((CrystalDecisions.CrystalReports.Engine.TextObject)rd.ReportDefinition.ReportObjects["txt"]);
        to.Text = "Hello World!!!";
        to.Left= 500;
        crystalReportViewer1.ReportSource = rd;
        crystalReportViewer1.Show(); 
```

但是“to”的 Left 属性不是按像素配置的。我不知道测量值是多少。当我在 .rpt 文件中移动控件时，Left 属性从 0 变为 10920！这个尺寸是多少？我怎样才能以厘米为单位？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T00:22:22.293

iirc，水晶单位是 TWIPS，或[二十分之一点](http://en.wikipedia.org/wiki/Twip)，1 twip = 1/1440 英寸。它们与屏幕上的像素数无关；要了解您的文档有多少缇宽，请检查您在报告中设置的页面大小（例如，以英寸为单位，然后乘以 1440）。而且我不确定您是否可以通过编程方式进行更改。

无论如何：如果 1 英寸 = 1440 缇，1 厘米 = 576 缇。

希望有帮助...

# php - 将 PHP IF 语句合并为单个语句或函数

> ID：14947251
> 
> 赞同：0
> 
> 时间：2013-02-18T23:32:39.773
> 
> 标签：php

所以我有一些代码，似乎我必须一遍又一遍地重复 $round == P,1,2 和 A。有没有我可以在不产生冗余代码的情况下实现这一点？

我正在考虑编写一个函数，它可以简单地交换所有 3 个可用的 $round 变量并回显相关信息。关于如何实现这一目标的任何想法？

其他信息将保持不变 - 它唯一的 $round 会改变，

```
// determine previous round

      if($round == "P") echo "";

            // if we are in round 1, look up round P bookings

            if($round == "1")
            { 
      $sql = "SELECT 
                            *
                            FROM ts_request
                            INNER JOIN ts_day
                            ON ts_request.day_id = ts_day.id
                            INNER JOIN ts_period
                            ON ts_request.period_id = ts_period.id
                            INNER JOIN ts_allocation
                            ON ts_request.id = ts_allocation.request_id
                            WHERE ts_request.round=:round
                            AND ts_request.dept_id=:dept
                            ORDER BY ts_request.module_id ASC";

            $stm = $pdo->prepare( $sql );
            $stm->execute( array( ':round' => 'P', ':dept' => $loggedin_id  ) );
            $rows = $stm->fetchAll();   

      foreach ($rows as $row) 
            {               
            echo '<tr align="center">'; 
            echo '<td>'.$row['module_id'].'</td>';
            echo '<td>'.$row['day'].'</td>';    
            echo '<td>'.$row['period'].'</td>';
            echo '<td>';

                $sql = "SELECT * FROM ts_roompref
                                WHERE request_id=:id";
                $stm = $pdo->prepare( $sql );
                $stm->execute( array( ':id' => $row['request_id']) );
                $rows2 = $stm->fetchAll();                  

                foreach ($rows2 as $row2) 
                {               
                        if ($row2['room_id']=="0")
                        {
                            echo "Any<br>";
                        }
                            else
                        {
                            echo $row2['room_id'].'<br>';
                        }   
                }

            echo '</td>';           
            echo '<td>'.$row['status'].'</td>';
            echo '</tr>';
            }
            }

            // if we are in round 2, look up round 1 bookings

            if($round == "2")
            { 
      $sql .= "";
            }   
      foreach ($rows as $row) 
            {
            // echo results here
            };

            // if we are in round A, look up round 2 bookings

            if($round == "A")
            { 
      $sql .= "";
            }           
      foreach ($rows as $row) 
            {

            // echo results here

            }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T23:40:27.210

我认为您正在寻找的是 php 中的 switch() 函数。

这是一个关于如何使用它的漂亮而简单的教程： [http ://www.tizag.com/phpT/switch.php](http://www.tizag.com/phpT/switch.php)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T23:41:43.397

“交换”已经存在，它被称为“切换语句”。在您的情况下，它应该如下所示：

```
switch($round) {
    case "P": 
        //code
    break;

    case "1": 
        //code
    break;

    case "2": 
        //code
    break;

    case "A": 
        //code
    break;

    default: 
        //code, when value of $round doesn't match any case
    break;

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T02:48:47.783

这可能会有所帮助。

```
$roundsInOrder = array('P', '1', '2', 'A');
$roundKey = array_search($incomingRoundLetter, $roundsInOrder);
if ($roundKey !== false || $roundKey != 0) { 
    $roundToQuery = $roundsInOrder[$roundKey - 1];
    // your other code snipped
    $stm->execute( array( ':round' => $roundToQuery, ':dept' => $loggedin_id  ) );
    //more code here
} 
```

这段代码的作用：

它按顺序设置回合​​。然后，它在轮次中搜索即将到来的轮次。我们真的想要钥匙。然后，if 语句检查 a) 确保我们确实找到了该轮和 b) 该轮不是第一个轮 (0 = P)，因为那时我们不想进行任何查询。最后， $roundToQuery 从当前键之前的轮次中获取值。

# php - ajax php GET / POST不刷新

> ID：14947256
> 
> 赞同：0
> 
> 时间：2013-02-18T23:33:32.593
> 
> 标签：php, jquery, ajax, post, get

我需要在不刷新页面的情况下执行以下代码...此代码已经包含 ajax 但是在不刷新页面的情况下执行它在哪里出错...？.vote 类附加到我的 index.php 文件中的锚点，如果可能的话，我需要这一切在单击锚点时仍然有效。将其重新编码以在单击按钮时执行并不理想。

```
$(".vote").click(function() {
    var id = $(this).attr("id");
    var name = $(this).attr("name");
    var eData = $(this).attr("data-options");
    var dataString = 'id='+ id + '&' + eData ;
    var parent = $(this);

    if(name=='up')
    {
       $(this).fadeIn(200).html('');
       $.ajax({
          type: "POST",
          url: "up.php",
          data: dataString,
          cache: false,
          success: function(html){
             parent.html(html);
          }
       });
    }
    else
    {
       $(this).fadeIn(200).html('');
       $.ajax({
          type: "POST",
          url: "down.php",
          data: dataString,
          cache: false,
          success: function(html){
             parent.html(html);
          }
       });
    }
}); 
```

这是我的 index.php 中的 html

```
<div id="main">
<div id="left">
<span class='up'><a href="" class="vote" name="up" data-options="key1=<?php echo $mes_id1;?>&key2=<?php echo $mes_id2;?>"><img src="up.png" alt="Down" /></a></span><br />
<?php echo $totalvotes1; ?><br />
</div>
<div id="message">
    <?php echo $message1; ?>
</div>
<div class="clearfix"></div>
 </div>
<div id="main">
<div id="right">
<br />
<?php echo $totalvotes2; ?><br />
<span class='down'><a href="" class="vote" name="down" data-options="key1=<?php echo $mes_id1;?>&key2=<?php echo $mes_id2;?>"><img src="down.png" alt="Down" /></a></span>
</div>
<div id="message">
    <?php echo $message2; ?>
</div>
<div class="clearfix"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T23:59:02.450

您需要将代码用 括起来`$(document).ready(function() {});`，或者将代码粘贴在`<body>`标签的末尾。就个人而言，我没有让浏览器在 DOM 加载之前解析同步 javascript（在本`<head>`节中），而是将其粘贴到最后。这也是 Bootstrap 推荐的。

如果没有加载 DOM，就没有为 jQuery 创建用于注册事件的元素，因此您的代码在被解析后实际上就坐在那里什么都不做。

除此之外，该`.click()`功能在点击时执行。它绑定到什么元素并不重要。如果它是可点击的，它是可执行的。

还要正确回答您的问题：`<a href="">`将刷新页面。你想用
`<a href="#">`. 但是，这将使您跳到页面顶部。您也可以定义 a`<label>`并改为使用`#labelname`来避免这种情况。或者根本不使用`href`。这不是必需的。

此外，将变量回显到 HTML 中的一个小技巧是使用`<?= $var ?>`

# php - 在 laravel 4 的包中自动使用外观

> ID：14947257
> 
> 赞同：1
> 
> 时间：2013-02-18T23:33:41.033
> 
> 标签：php, laravel, laravel-4

我正在开发一些包，其中很多都是基于主应用程序中的代码，或者来自基于在应用程序而不是包中编写代码的示例。我一直忘记在各种文件中添加`Use View;`或`Use Controller;`，我不得不手动检查并将它们添加到包中的每个 PHP 脚本（需要它们）中。

有没有一种自动化的方法，这样我只需要在一个包中声明一次，或者更好地让它们传递到主应用程序的外观？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T14:06:45.400

恐怕没有。

这是因为你的包代码有自己的命名空间，Illuminate 核心也是如此。PHP 的使用语句仅基于每个文件。当您的脚本使用来自另一个命名空间的类时，您有 2 个选项。

*   添加use-statements（到Facades）以将类别名到当前命名空间
*   引用外观的完整命名空间（从全局命名空间开始），可以是 Laravel 自动创建的全局命名空间中的别名（\View），也可以是外观的原始完整命名空间（\Illuminate\Support\Facades\View）

引用完整命名空间的示例：

```
<?php

namespace My\Package;

class SomeClass
{
    public function doSomething()
    {
        // reference full namespace
        $view = \Illuminate\Support\Facades\View::make('someview');
        // or
        $view = \View::make
    }
}

?> 
```

这似乎是一种不必使用 use 语句的方法，但在我看来，情况更糟。所以我建议你习惯于添加这些使用语句。

您应该将其视为最佳实践：这些使用语句清楚地说明了您的类（或文件）的依赖关系。尝试减少这些数量总是更好的。

# php - 使用 in_category 过滤器循环浏览 Wordpress 帖子并不能获得所有帖子

> ID：14947258
> 
> 赞同：0
> 
> 时间：2013-02-18T23:33:52.903
> 
> 标签：php, arrays, wordpress, loops, multidimensional-array

我正在尝试将特定类别中的一些帖子放入多维数组中，如下所示：

```
wp_reset_query();
query_posts();
while (have_posts()) : the_post();

    if (in_category('videos')) {
        $postAttribute["permalink"] = get_permalink();
        $postAttribute["image_url"] = wp_get_attachment_url(get_post_thumbnail_id($post->ID));
        $postAttribute["title"] = get_the_title();
        $postAttribute["comments_number"] = get_comments_number();
        array_push($videos, $postAttribute);
    };

endwhile; 
```

然后检查我运行的数组：

```
echo count($videos); 
```

结果，我一直得到 2，尽管我知道面试类别中的帖子要多得多。

我检查了最大帖子数设置，将其设置得更高只是为了查看，但仍然一无所获。

知道我可能会错过什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T23:40:09.623

看起来您依赖于主查询，默认情况下每页只有 20 个帖子左右。

改为执行自定义查询：

```
$my_query = new WP_Query(array(
  'posts_per_page' => -1, // all
  'category_name' => 'videos',
));

while($my_query->have_posts()){
  $my_query->the_post();

  // do your thing here
} 
```

`in_category()`不需要检查，因为查询只会让您获得来自“视频”类别的帖子

# c++ - 遍历链表列表

> ID：14947259
> 
> 赞同：0
> 
> 时间：2013-02-18T23:33:55.040
> 
> 标签：c++, struct, linked-list

我是 C++ 的新手，对这个指针和东西感到头疼！

我需要遍历链表的结构列表，读取结构的数据并弹出该条目！

这是我的结构：

```
struct node {
    map<string,double> candidates;
    double pathCost;
    string source;
    node *next;             // the reference to the next node
}; 
```

通过阅读[这篇](https://stackoverflow.com/questions/1085489/stl-list-to-hold-structure-pointers)文章，我创建了我的列表，例如：

```
list<node*> nodeKeeper; 
```

然后初始化第一个值：

```
 node *head;
    head= new node;
    head->pathCost = 0.0;
    head->source="head";
    head->next = NULL; 
```

细填充列表和结构：

```
for(unsigned int i = 0; i < sourceSentence.size(); i++){

    node *newNode= new node;             //create a temporary node

    //DO STUFF HERE

    //push currunt node to stack
    nodeKeeper.push_back(newNode);

    head = newNode;

} 
```

现在我有结构列表，我想遍历它并弹出元素：

```
for (list<node*>::const_iterator it=nodeKeeper.begin();it!=nodeKeeper.end();it++){

    it->pop_front();

} 
```

这给了我这个错误：

> 错误：在'* it.std::_List_const_iterator<_Tp>::operator->()'中请求成员'pop_front'，它是指针类型'node* const'（也许你打算使用'->'？ ) make: *** [main3.o] 错误 1

看起来我的迭代器指向列表内部，而不是列表本身！

你能告诉我这里有什么问题吗？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T23:44:50.587

如果您需要做的就是删除元素，请使用[`std::list::clear`](http://en.cppreference.com/w/cpp/container/list/clear)：

```
nodeKeeper.clear(); 
```

* * *

要读取元素的内容，然后删除，试试这个：

```
for (std::list<node*>::const_iterator it = nodeKeeper.begin(); it != nodeKeeper.end(); ++it) {
    std::cout << (*it)->source;
    // do more reading

    nodeKeeper.pop_front();
} 
```

或使用 C++11：

```
for (const auto& a : nodeKeeper) {
    std::cout << a->source;

    nodeKeeper.pop_front();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T23:49:47.497

如果您的目标是拥有一个节点结构列表，则无需自己管理下一个指针。插入将保持不变（减去该`head =`行）

要弹出列表的所有元素，您可以执行以下操作

```
int sizeOfList = nodeKeeper.size();
for( int i =0; i < sizeOfList; i++) {
    //if you want to do something with the last element
    node * temp = nodeKeeper.back();
    //do stuff with that node

    //done with the node free the memory
    delete temp;
    nodeKeeper.pop_back();
} 
```

在此处编译/运行示例：http: [//ideone.com/p6UlyN](http://ideone.com/p6UlyN)

# php - codeigniter+HMVC 跨模块调用控制器->方法

> ID：14947261
> 
> 赞同：11
> 
> 时间：2013-02-18T23:33:59.347
> 
> 标签：php, codeigniter, hmvc

我正在拔掉我所有的头发......一直在搜索每一个线程，如果有人能指出我的工作示例，我将不胜感激。

根据文档：[https](https://bitbucket.org/wiredesignz/codeigniter-modular-extensions-hmvc) ://bitbucket.org/wiredesignz/codeigniter-modular-extensions-hmvc 我可以调用另一个模块-> 控制器使用

```
modules::run('module/controller/method', $params);
modules::load('module/controller/method', $params);
or
$this->load->module('module/controller');
$this->controller->method(); 
```

**问题：**永远不会调用“method()”。每次只调用控制器的构造函数。

目标是将独立的 MVC 构建为模块并供其他控制器使用。但不管我做什么，它只调用构造函数，不调用方法。几周前我开始使用 HMVC，是我遗漏了文档中的某些内容还是没有以这种方式使用？
这是设置：

```
modules
  |--ztest1
  |   |--controller/c1.php
  |--ztest2
      |--controller/c2.php

class C1 extends MX_Controller {
  function __construct() {
    parent::__construct();
  }
  function index () {
    Modules::run('ztest2/c2/testc2/');
    //Modules::load('ztest2/c2/testc2/');
    //$this->load->module('ztest2/c2/testc2/');
    //$this->c2->testc2();
  }
}

class C2 extends MX_Controller {
  function __construct() {
    parent::__construct();
    echo __FILE__." // ".__CLASS__."/".__FUNCTION__.PHP_EOL;
  }
  function testc2(){
    echo __FILE__." // ".__CLASS__."/".__FUNCTION__.PHP_EOL;
  }
}

output:
/app/modules/ztest2/controllers/c2.php // C2/__construct 
```

附加说明：脚本没有错误或警告。它只是悄悄地调用构造函数。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-19T15:12:11.663

感谢MC的提示，我终于找到了原因。HMVC 文档确实缺少一些初学者的例子。

对于将来可能会找到此线程的任何人，请在此处正确使用：

```
to call module01/controller01/method00:

//method 1 CORRECT:
$ctlObj = modules::load('module01/controller01/');
$ctlObj->method00();
//or you could use chaining:
modules::load('module01/controller01/')->method00();

//method 1 WRONG:
modules::load('module01/controller01/method00');  //this will only load contructor

---
//method 2 CORRECT:
modules::run('module01/controller01/method00');   //no trailing slash!

//method 2 WRONG:
modules::run('module01/controller01/method00/');  

---
//method 3 CORRECT:
$this->load->module('module01/controller01');
$this->controller01->method00(); 
```

我不明白为什么我第一次尝试时方法 3 失败了……也许是因为我重新启动了 HTTPD？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T01:15:34.283

这个 HMVC 很适合我。我现在正在使用这个 HMVC 做一个项目。只需`third_party/MX/Modules.php`按照下面的链接中所示进行编辑并告诉我回复即可。

[https://bitbucket.org/wiredesignz/codeigniter-modular-extensions-hmvc/pull-request/5/return-error-messages-instead-of-logging/diff](https://bitbucket.org/wiredesignz/codeigniter-modular-extensions-hmvc/pull-request/5/return-error-messages-instead-of-logging/diff)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-27T17:55:04.223

我遇到了同样的问题。确保检查目录和控制器的大小写。模块和控制器名称之间的区别不区分大小写。

```
//In my case the below did not work
$this->load->module('dashboard/Dashboard');
$this->Dashboard->method();

//but 
$this->load->module('dashboard');
$this->Dashboard->method();
//worked 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-17T03:41:22.063

经过一些尝试来实现调用一个不在任何模块内的控制器。

```
Modules::run('../Controller/method'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-28T13:38:22.763

我也是 CI 的新手，我以为我遇到了同样的问题。脚本似乎没有运行。（没有 html 输出）。

```
//This did NOT work (did not produce output)
modules::run('module_name/method_name',$data); 

// but this DID work???  didn't know why
modules::run('module_name/method_name',$data); 
exit();

// turns out you need the echo for output
echo modules::run('templates/login_template',$data); 
```

这对你们中的许多人来说可能是显而易见的——但我浪费了两个小时来寻找答案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-09T06:19:39.680

所以根据文档，他们说将控制器复制到默认控制器文件夹中并移至模块控制器。

所以现在我如何运行已经移动到模块的控制器，当我从默认控制器文件运行它时，如果删除不起作用，那么如何让它运行模块内的控制器作为默认控制器运行。

那么我是否需要在路线中提及模块名称

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-19T10:46:35.043

```
 /*echo Modules::run("controller name of a module which you want to call/and its.. function name");*/

echo Modules::run("Second/callit"); 
```

或者

```
$this->load->module('Second');

$this->second->callit(); 
```

但是..控制器名称应该不同..从一个模块到另一个模块..

```
 **(parameter passing)**

        echo "<hr>";

       //echo Modules::run("controller name of a module which you want to call/and its.. function name");

         $data="peter";

      echo Modules::run("Second/callit",$data);

      echo "<hr>";

      $this->load->module('Second');

     $this->second->callit($data);

      echo "<hr>"; 
```

# ios - iOS 5.1.1、iPhone 3GS 未处理 WiFi 802.11 Deauthentication

> ID：14947263
> 
> 赞同：1
> 
> 时间：2013-02-18T23:34:02.183
> 
> 标签：ios, objective-c, wifi

我正在开发一个与 WiFi 设备上的 UDP 套接字通信的 iOS 应用程序，该套接字创建一个（软）接入点。

WiFi 设备在一段时间不活动（如 60 秒）后通过发送 802.11 Deauthentication 消息来丢弃所有连接的设备。显然，运行 iOS 5.1.1 的 iPhone 3GS 没有正确响应此 Deauthentication 并且“认为”它仍然连接到 WiFi 网络。断开连接后发送的来自 iPhone 的 UDP 命令会得到来自设备的 802.11 Deauthentication 消息的回复。没有发送关联请求（可能是由于 iPhone 认为仍然连接到接入点。（-> Wireshark 嗅探）

其他设备/其他 iOS 版本确实会发送关联请求并且行为正确。

知道如何解决这个问题或如何检查 iPhone 3GS 是否*真的*连接到 WiFi 网络？

顺便说一句：我正在使用 CocoaAsyncSocket 进行通信，但这可能无关紧要。

# soundcloud - 是否可以从非 HTTPS 域使用 SoundCloud HTML5 Widget API？

> ID：14947265
> 
> 赞同：0
> 
> 时间：2013-02-18T23:34:10.147
> 
> 标签：soundcloud

因此，显然由于最近的一次切换，所有 SoundCloud API 和小部件请求都通过 HTTPS 路由。因此，任何尝试从非 HTTPS 域使用 Widget API ( [http://developers.soundcloud.com/docs/api/html5-widget ) 都会在 Chrome 中引发以下错误：](http://developers.soundcloud.com/docs/api/html5-widget)

```
Unsafe JavaScript attempt to access frame with URL http://foobar.com/ from 
frame with URL https://w.soundcloud.com/player/?
url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F7659975\. The frame requesting 
access has a protocol of 'https', the frame being accessed has a protocol of 
'http'. Protocols must match. 
```

显然有一个关于这个问题的 Chromium[问题](http://code.google.com/p/chromium/issues/detail?id=17325)正在被跟踪。所以，我的问题是：目前是否可以使用 HTML5 Widget API，或者这是一个阻塞问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T10:06:59.720

虽然这*是*Chromium 的一个问题，但它并不能真正阻止对 iframe 的任何使用，包括`postMessage`用于控制 HTML5 小部件的 iframe。

# jquery - 使用 Sha512 的 jQuery 验证引擎和散列

> ID：14947266
> 
> 赞同：0
> 
> 时间：2013-02-18T23:34:16.830
> 
> 标签：jquery, sha512, jquery-validation-engine

我在让密码散列与 jQuery 验证引擎一起工作时遇到问题。问题是我似乎无法散列给定的密码。

这就是我到目前为止所拥有的。

```
 <script>
    jQuery(document).ready( function() {
    jQuery("#form").validationEngine('attach', 
    {onValidationComplete: function(form, status){
        if (status == true) {
             $("form#form").bind('submit', function(e) {
                  e.preventDefault();
             });

             function formhash(form, password) {
               var p = document.createElement("input");
               form.appendChild(p);
               p.name = "p";
               p.type = "hidden";
               p.value = hex_sha512(password.value);
               password.value = "";
               form.submit();
              }
         }
     }  
    })
    };
    </script> 
```

通过在提交后运行处理脚本，我可以找到并使用未散列的密码，但这对我来说还不够好。

我究竟做错了什么？

编辑：我通过隔离函数（formhash）应用了更多的javascript和一个额外的“背景验证”并放入一个单独的文件中，添加了 onsubmit="return validate(this);" 在表单标题中。它不是那么漂亮，但它似乎可以解决问题。

不过，仍然欢迎任何有关改进的建议。

```
 <script type="text/javascript"> 
    function validate(form) {
    var reason = "";

    reason += validatePassword(form.password);

    if (reason != "") {
    return false;
    }
    formhash(form, form.password)
    return true;
    }

    function validatePassword(fld) {
    var error = "";

    if (fld.value == "") {
       error = "";
    }
    return error;
    }
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-09T22:22:00.717

有点晚了，但是我有同样的问题，没有找到答案，所以我想分享一下我解决它的方法：

```
function reghash(form, password, confirmation) {
 var p = document.createElement("input");
 form.appendChild(p);
 p.name = "p";
 p.type = "hidden";
 p.value = hex_sha512(password.value);
 password.value = "123456";
 confirmation.value = "123456"; } 
```

我正在`form.submit();`从此函数中删除并使用`onclick`提交按钮调用该函数。通过简单地匹配 jquery 表单验证中允许的最小长度，我将密码和确认更改为安全值。这样验证功能不会阻止提交表单。

# .htaccess - 所有重写都必须启用 RewriteEngine？

> ID：14947271
> 
> 赞同：8
> 
> 时间：2013-02-18T23:34:44.713
> 
> 标签：.htaccess, mod-rewrite

我只是想知道是否有必要在每次添加重写时都包含 RewriteEngine On 和 Rewrite Base /？例如，我想同时使用“从 URL ^ 中删除 QUERY_STRING”和“在一天中的特定时间阻止对文件的访问 ^”（引用自 askapache.com 的示例）

从 URL 中删除 QUERY_STRING

```
RewriteEngine On
RewriteBase /
RewriteCond %{QUERY_STRING} .
RewriteRule ^login.php /login.php? [L] 
```

在一天中的特定时间阻止对文件的访问 ^

```
Options +FollowSymLinks
RewriteEngine On
RewriteBase /
# If the hour is 16 (4 PM) Then deny all access
RewriteCond %{TIME_HOUR} ^16$
RewriteRule ^.*$ - [F,L] 
```

我可以将它们组合成以下内容吗？

```
Options +FollowSymLinks
RewriteEngine On
RewriteBase /
RewriteCond %{QUERY_STRING} .
RewriteRule ^login.php /login.php? [L]
# If the hour is 16 (4 PM) Then deny all access
RewriteCond %{TIME_HOUR} ^16$
RewriteRule ^.*$ - [F,L] 
```

在此先感谢您的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T23:42:29.070

是的，`RewriteEngine`并且`RewriteBase`只需要指定一次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T23:49:09.943

您需要`RewriteEngine On`在每个具有重写规则的 htaccess 文件中，但只需要一次。否则规则将被忽略。

至于`RewriteBase`，您只需要将相对 URI 作为目标，或者如果您希望您的规则可移植（因此，如果您将规则从一个目录移动到另一个目录，您只需要更改基础）。例如：

不需要`RewriteBase`这些规则：

```
RewriteRule ^login.php /login.php? [L]

RewriteRule ^.*$ - [F,L] 
```

因为`/login.php`不是相对 URI，所以可以理解，您指的是字面意思，`http://domain.com/login.php`而`-`just 表示传递，因此无论如何都会忽略基数。

您可能想要使用的实例`RewriteBase`：

```
RewriteRule ^dir/(.*)$ dir2/$1 [L,R=301] 
```

如果没有`RewriteBase /`apache，可能会错误地猜测`dir2/$1`是文件还是 URI 路径，并将您重定向到错误的位置。`RewriteBase /`然后它将正确重定向。

# scala - scala“删除”不起作用

> ID：14947273
> 
> 赞同：4
> 
> 时间：2013-02-18T23:34:46.020
> 
> 标签：scala

根据“Scala编程”一书的第44页，数据结构存在一个`remove`函数。`list`但是，当我在解释器中尝试该示例时，我不断收到错误消息。有谁知道为什么？这是一个示例

```
scala> val x = List(1,2,3,4,5,6,7,8,9)
x: List[Int] = List(1, 2, 3, 4, 5, 6, 7, 8, 9)

scala> x.remove(_ < 5)
<console>:9: error: value remove is not a member of List[Int]
              x.remove(_ < 5)
                ^

scala> x.remove(s => s == 5)
<console>:9: error: value remove is not a member of List[Int]
              x.remove(s => s == 5)
                ^

scala> val y = List("apple","Oranges","pine","sol")
y: List[String] = List(apple, Oranges, pine, sol)

scala> y.remove(s => s.length ==4)
<console>:9: error: value remove is not a member of List[String]
              y.remove(s => s.length ==4) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-18T23:41:03.767

`List`在早期版本中有一个 remove 方法，但在 2.8 中已弃用并在 2.9 中删除。改为使用`filterNot`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-18T23:39:51.927

[ListBuffer](http://www.scala-lang.org/api/current/index.html#scala.collection.mutable.ListBuffer)有一个 remove 方法，但没有[List](http://www.scala-lang.org/api/current/index.html#scala.collection.immutable.List)。[有关如何以惯用方式从不可变列表中删除的信息，](https://stackoverflow.com/questions/5636717/what-is-an-idiomatic-scala-way-to-remove-one-element-from-an-immutable-list)请参见此处（显然是创建一个新列表！）

# php - 多个 JavaScript 倒计时

> ID：14947275
> 
> 赞同：0
> 
> 时间：2013-02-18T23:34:54.777
> 
> 标签：php, javascript, wordpress, countdown

```
<?php wpsc_start_category_query(array('category_group'=>get_option('wpsc_default_category'), 'show_thumbnails'=> 1)); ?>

<script>
window.onload = function() {
    countdown('countdown<?php wpsc_print_category_id(); ?>');
}
var interval;

var seconds = 5;
function countdown(element) {
    interval = setInterval(function() {
        var el = document.getElementById(element);
        if(seconds == 0) {
         el.innerHTML = "countdown's over!";                    
         clearInterval(interval);
         return;
        }
        el.innerHTML = seconds + ' seconds remaining';
        seconds--;
    }, 1000);
}
</script>

<div id='countdown<?php wpsc_print_category_id(); ?>'></div>
<?php wpsc_end_category_query(); ?> 
```

我的任务是为每个 wp 查询显示这样的倒计时。问题是它只显示最后一个查询的对象。我的猜测是因为window.onload，但我想不出任何替代方案

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T02:46:13.590

我不是 100% 理解 WP 的东西是做什么的，所以这可能完全是垃圾！

我的代码有 2 部分，一部分用于代替您当前的代码，模板，以及一部分代码在您的页面`<head>`中，倒计时功能。

还有一个功能可以将秒转换为天、小时、分钟和秒，如果你的间隔在未来不是恒定在 5 秒。

倒计时功能将更新模板代码设置的所有倒计时。

希望能帮助到你 ：）

**更新**

我的代码不会在您的服务器上编辑或删除任何内容，显然我的变量对您来说有点离家太近了:) 正如我的评论所说，该`delete`调用仅从包含计数器信息的列表中删除计数器，删除删除语句将完成的计数器留在列表中（不是问题，只是效率较低，因为它们在被调用时会被迭代`tick()`）

我将尝试在底部描述我的代码的作用，以便您更好地理解发生了什么。

WPSC 模板

```
<?php   wpsc_start_category_query(array('category_group'=>get_option('wpsc_default_category'), 'show_thumbnails'=> 1)); ?>
<script type="text/javascript">
if (!wpsc_categories) { wpsc_categories = {}; }
wpsc_categories['countdown_<?php wpsc_print_category_id(); ?>'] = 5; // this value is the countdown in seconds
</script>
<div id="countdown_<?php wpsc_print_category_id(); ?>"></div>
<?php wpsc_end_category_query(); ?> 
```

如果您想要 1 周倒计时并且倒计时在页面浏览量中持续存在（因此刷新时不会重置为 1 周），您需要在服务器上存储计数器开始日期，计算当时和现在之间的差异（用php）并使用它代替5（我想这就是你计划做的事情！）

倒计时功能 - 这应该包含在页面的标题中

```
<script type="text/javascript">
var wpsc_categories = [];

// the following function will update all counters using one timer (hopefully)
function tick() {
    var element;
    for (category in wpsc_categories) {
        if (wpsc_categories.hasOwnProperty(category)) {
            element = document.getElementById(category);
            if (wpsc_categories[category] == 0) {
                element.innerHTML = "countdown over!";
                delete wpsc_categories[category];
            } else {
                // MODIFIED THIS LINE, SEE NOTE
                //element.innerHTML = formatTime(wpsc_categories[category]--);
                element.innerHTML = formatTime(wpsc_categories[category]);
                wpsc_categories[category] -= 1;
            }
        }
    }
    //return setInterval(tick, 1000); //this line is bad :D
}

var interval = setInterval(tick, 1000) // start it running

// return formatted time from seconds (if required)
function formatTime(seconds) {
    var numdays = Math.floor(seconds / 86400);
    var numhours = Math.floor((seconds % 86400) / 3600);
    var numminutes = Math.floor(((seconds % 86400) % 3600) / 60);
    var numseconds = ((seconds % 86400) % 3600) % 60;
    return (numdays>0?numdays+" days ":"")+(numhours>0?numhours+" hours ":"")+(numminutes>0?numminutes+" minutes ":"")+(numseconds>0?numseconds+" seconds":"")
}
</script> 
```

**笔记**

我更改了剩余时间的更新方式，使其更加清晰。我使用了一个减量运算符`--`，这可能有点烦人。

**描述**

您的原始模板为每个类别复制了一大块代码，包括倒计时代码和调用它的调用，这就是为什么只有最后一个类别计时器在工作的原因。`window.onload`被每个后续类别覆盖。

是的，您可以使用匿名函数来启动函数滚动，它应该可以工作，但它可能不是最好的解决方案。

现在我的代码

您对`if (!wpsc_categories) { wpsc_categories = {}; }`wpsc_categories 是一个存储有关计数器信息的对象有疑问。这会检查对象是否存在，如果不存在则创建它，以便下一个喜欢可以添加有关计数器的信息。

在浏览器中，您的客户端将获得以下 3 个示例组。

```
<script type="text/javascript">
if (!wpsc_categories) { wpsc_categories = {}; }
wpsc_categories['countdown_example1'] = 5;
</script>
<div id="countdown_example1"></div>
<script type="text/javascript">
if (!wpsc_categories) { wpsc_categories = {}; }
wpsc_categories['countdown_example2'] = 5;
</script>
<div id="countdown_example2"></div>
<script type="text/javascript">
if (!wpsc_categories) { wpsc_categories = {}; }
wpsc_categories['countdown_example3'] = 5;
</script>
<div id="countdown_example3"></div> 
```

一旦此块中的代码由 javascript 执行，wpsc_categories 变量将填充有关 3 个所需计数器的信息。此信息`tick()`用于更新计时器。

**更新 2** 我`setInterval`在函数内部使用的示例`tick()`，这很糟糕！因为 setInterval 是一个重复的计时器，所以每次调用 tick 都会创建一个新的计时器，所以它会以指数方式改变时间：D

`setTimeout()`是一击，`setInterval()`一直到你停下来！

# objective-c - 如何使用带有“未使用变量”警告的类型常量？

> ID：14947276
> 
> 赞同：9
> 
> 时间：2013-02-18T23:34:57.370
> 
> 标签：objective-c, c, xcode

我正在使用 Xcode 4.6，并且我有一个头文件，其中包含我在整个代码中使用的一些常量。我不想使用预处理器指令，因为我希望它们被正确输入等等。

例如，我的 .h 文件之一中有此代码：

```
static NSString *kErrorCannotDivideByZero = @"Error: Cannot divide by zero"; 
```

我在相应的 .m 文件中使用它：

```
[self showToast:kErrorCannotDivideByZero]; 
```

我收到警告：

```
/path/to/my/headerFile.h:32:18: Unused variable 'kErrorCannotDivideByZero' 
```

我知道这只是一个警告，但我有大约 50 个这样的警告阻塞了我的编译器输出。

为什么我会收到此警告，我该如何正确解决？

***我对简单地抑制所有未使用的变量警告不感兴趣，因为我确实想获得合法的警告。***

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-18T23:50:53.847

在您的标题中进行声明，`extern`而不是`static`. 您正在做的是为包含您的标题的每个翻译单元创建一个变量，这就是 Clang 警告您的原因，因为它是合法的未使用的已定义变量。关键字告诉编译器变量的`extern`定义在其他地方找到（它可能在同一个翻译单元中，也可能在另一个翻译单元中）。

在您的标题中，有：

```
// declare that the constant exists somewhere
extern NSString * const kErrorCannotDivideByZero; 
```

在您的**一个**`.m`文件中（通常是与标题同名的文件），放入

```
// define the constant, i.e. this is where it exists
NSString * const kErrorCannotDivideByZero = @"Error: Cannot divide by zero"; 
```

声明变量`extern`允许编译器确保您正确处理变量，即使它不知道它是在哪里定义的（例如，您不能将它用作`NSArray`）。链接器的任务是确保您确实在某处定义了它。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-18T23:40:07.883

Clang 将允许您将警告标志推入和弹出“诊断”堆栈：[“通过编译指示控制诊断”](http://clang.llvm.org/docs/UsersManual.html#controlling-diagnostics-via-pragmas)。您可以像这样包装某些代码：

```
#pragma clang diagnostic push
#pragma clang diagnostic ignored "-Wunused-variable"

static NSString *kErrorCannotDivideByZero = @"Error: Cannot divide by zero";

#pragma clang diagnostic pop 
```

告诉 Clang 你知道这些没有被使用，在这个特定的例子中没关系。

顺便说一句，您可能不想在导入到许多不同位置的文件中*定义*这些变量——这是导致关于变量重新定义的链接器错误的好方法（尽管这只会在变量被全局链接时发生——声明/定义*没有* `static`）。像这样的常量的通常模式是在标题中放置一个`extern` *声明*，并在另一个文件中*定义变量。*有关详细信息，请参阅[引用另一个类的静态 NSString * const](https://stackoverflow.com/questions/11942458/referencing-a-static-nsstring-const-from-another-class/11942513#11942513)。

正如dreamlax 指出的那样，您实际上收到了这些警告，因为每个导入您的标头的文件都获得了自己的`static`变量副本；当我提出上述`#pragma`技术时，我误解了您的要求。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-18T23:45:21.757

制作你的常量`const`：

```
static NSString * const kErrorCannotDivideByZero = @"Error: Cannot divide by zero"; 
```

（正如其他人指出的，`extern`在实现文件中使用和定义）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-18T23:51:11.263

也许，与其将它们初始化为字符串文字，不如运行一个初始化函数，该函数从特定于语言环境的文件中加载这些值，以便错误出现在翻译的语言中。当您的初始化函数分配给该变量时，您的编译器可能会相信该变量需要存在才能使编译成功。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-03T11:10:48.143

GCC（我假设是clang）不会警告未使用的常量。这里要注意的一个陷阱是指针必须是 const 指针，而不仅仅是指向 const 的指针；因此，要正确声明不会触发任何警告的未使用字符串常量，您需要：

```
const char * const myConst = "myConst"; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-21T23:35:52.217

您可以将所有静态变量声明移动到您各自的 .m 文件中。这应该消除所有那些“未使用的变量”警告。原因是静态变量仅限于文件级范围。

# php - 在php中获取电子邮件附件cron作业

> ID：14947277
> 
> 赞同：0
> 
> 时间：2013-02-18T23:35:00.393
> 
> 标签：php, email, fgetcsv

谁能指出我如何使用 php 从电子邮件中获取附件的正确方向？我已经在使用 php 成功处理一个相当大的 .csv 文件并根据条件执行不同的操作。它工作得很好，但我现在被要求每天多次自动下载包含新 .csv 文件的电子邮件。

使用它作为我的代码的开始，一旦我下载了 .csv 文件中的信息，我将按照自己的意愿去做，并将其放在我的服务器上。那么我可以直接打开电子邮件中的附件，跳过下载它的步骤，然后将它放在我的服务器上吗？

```
 $handle = fopen("updateaccounting.csv", "r");
        // loop content of csv file, using comma as delemiter
        while (($data = fgetcsv($handle, 1000, ",")) !== false) {
        $compareid = $data[0];
        $date = $data[1];
        $first = $data[5];
        $last = $data[6];
        $city = $data[7];
        $fundedamount = $data[10];
        $xmlstatus = $data[13];
        $custtestid = substr($compareid, 0, 11); 
```

我的问题是如何使用在 cronjob 上运行的 php 来获取 .csv 文件。这样我就可以使用我现有的代码来处理文件以及我正在寻找的内容，如何自动化获取文件的过程。任何帮助都会很棒！太感谢了。杰森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T02:53:24.890

对于此解决方案，您需要使用 IMAP 访问邮箱。很有可能，这已经得到支持。

接下来，您可以将文件附件抓取到 $data 变量中（无需保存）。请参阅此丰富的答案：[检索文件附件](https://stackoverflow.com/a/11405595/2030153)。然后，您应该能够使用您的代码创建您的 csv（当然，您现在已经将其放入一个函数中，对吗？:)）如果您对通过 IMAP 访问邮件有疑问，请搜索 StackOverflow，使用示例中的示例进行尝试[PHP 手册](http://php.net/imap)，然后发布任何新问题。

# image - Adobe Flex：图像和火花列表

> ID：14947279
> 
> 赞同：0
> 
> 时间：2013-02-18T23:35:09.880
> 
> 标签：image, actionscript-3, apache-flex, list, adobe

我正在尝试在火花列表中显示图像。我尝试了很多方法，但似乎都没有奏效。这是我的代码：

```
 var list:List = new List();
list.width = 200;
list.height = 300;
list.labelField = "LabelName";

var array:ArrayCollection = new ArrayCollection;
array.addItem(new BitmapImage().source="/assets/appLogo.png");
array.addItem(new BitmapImage().source="/assets/companyLogo.png");

list.dataProvider = list; 
```

列表显示在屏幕上，但图像未出现在列表中。代替行中的图像，它在一行中显示“/assets/appLogo.png”，在另一行中显示“/assets/companyLogo.png”。我花了几个小时试图解决这个问题，但没有运气。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T23:48:21.113

这些行看起来不正确：

```
array.addItem(new BitmapImage().source="/assets/appLogo.png");
array.addItem(new BitmapImage().source="/assets/companyLogo.png"); 
```

它似乎在做的是创建一个新的 BitMapImage 并在其上设置源属性。您添加到数组中的项目不会是分配的结果吗？或者——听起来你得到了——实际的源值。如果你想要一个 BitMapImages 数组，你可以像这样创建它：

```
var tempImage :BitMapImage = new BitmapImage()
tempImage.source="/assets/appLogo.png"
array.addItem(tempImage);
tempImage = new BitmapImage()
tempImage.source="/assets/companyLogo.png"
array.addItem(tempImage); 
```

但是，除非您构建一个知道如何显示它的自定义 itemRenderer，否则 List 将不知道如何处理 BitmapImage：

```
<s:List dataProvider="array">
 <s:itemRenderer>
   <s:ItemRenderer dataChange="onDataChange()">
     <fx:Script>
       protected function onDataChange():void{
        this.removeChild(data); 
        this.addChild(data as BitMapImage);
       }
     </fx:Script>
   </s:ItemRenderer>
 </s:itemRenderer>
</s:List> 
```

但是，我怀疑拥有一个表示源的字符串数组然后在渲染器中创建 BitMapImage 会更有益。如果您不打算一次使用所有 BitMapImage 组件，则无需创建大量 BitMapImage 组件。有点像这样：

```
array.addItem("/assets/appLogo.png");
array.addItem("/assets/companyLogo.png");

<s:List dataProvider="array">
 <s:itemRenderer>
   <s:ItemRenderer dataChange="onDataChange()">
     <fx:Script>
       protected function onDataChange():void{
        this.bitMapImage = data;
       }
     </fx:Script>
     <s:BitMapImage id="bitMapImage" />
   </s:ItemRenderer>
 </s:itemRenderer>
</s:List> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-18T04:44:00.480

我建议您编写一个纯 ActionScript 渲染器类，它扩展了包含私有 Image 对象的 LabelItemRenderer，然后覆盖 set data() 并创建并加载图像（如果不存在），如果存在则仅加载它。

您传递到列表中的数据应该只是一组带有图像文件 url 路径的字符串，然后将其用作图像的 .source 属性。

然后，您可以覆盖 layoutContents 以根据列表行的大小定位和缩放图像。

我已经这样做了，但目前我没有一个超级简单的干净示例可以发布。如果您仍然不明白，请告诉我，我会上传一些代码。

# node.js - node.js websocket.io 示例不起作用？

> ID：14947280
> 
> 赞同：1
> 
> 时间：2013-02-18T23:35:20.223
> 
> 标签：node.js, websocket

我是 node.js 的新手，并且正在通过“smashing node.js”书的示例进行工作。在 websockets 章节中，我正在努力让这个示例正常工作。原谅我这是一个非常简单的错误！我不确定`ws.onopen`事件处理程序是否正常工作？

代码如下：（首先是`server.js`文件）：

```
var express = require('express') , wsio = require('websocket.io');

var app = express.createServer().listen(3000);

var ws = wsio.attach(app);

app.use(express.static('public'));

ws.on('connection', function (socket) {

    socket.on('message', function(msg) {
        console.log(' \033[96mgot:\033[39m ' + msg);
        socket.send('pong');
    });
}); 
```

其次是`./public/index.html`文件的脚本内容：

```
var lastMessage;

window.onload = function () {
    var ws = new WebSocket('ws://localhost');

    ws.onopen = function () {
        ping();
    }
    ws.onmessage = function(ev) {
        console.log(' got: ' + ev.data);
        document.getElementById('latency').innerHTML = new Date - lastMessage;
        ping();
    }

    function ping() {
        lastMessage =+ new Date;
        ws.send('ping');
        document.getElementById('latency').innerHTML = 'test';
    };
}; 
```

我已经使用`package.json`文件安装了节点模块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T11:03:11.497

在您的*index.html*中，您需要连接到端口*3000*即`var ws = new WebSocket('ws://localhost:3000');`。

# python - 处理 id 和数据库行的异构列表的 pythonic 方式是什么

> ID：14947282
> 
> 赞同：2
> 
> 时间：2013-02-18T23:35:31.927
> 
> 标签：python, isinstance

我的情况是我正在编写一个允许用户从数据库中删除记录的函数。为了提高效率，函数本身必须能够获取用于批量删除的参数列表。此外，为简单起见，该列表可以包含 ID（可以是`strings`或`ints`）*或*行对象（被荣耀`dicts`）

如果您好奇，允许完整行背后的原因是存在检查行数据的安全检查，以确保允许用户删除有问题的行。允许传入行可以减少访问数据库的次数。

`isinstance`目前，我通过以下方式使用经常受到批评的功能：

```
def deleteRows(rowsToDelete):
    ids = set()
    rows = []
    for r in rowsToDelete:
        if isistance(r, basestring) or isinstance(r, int):
            ids.add(r)
        else:
            rows.append(r)
    # Some logic that SELECTS based on the data in ids and appends the
    # result into rows...
    # ... then security ...
    # ... then DELETE 
```

我可以看到为什么这是危险的（如果可以将类型强制转换为不是`int`or的 id`basestring`怎么办？），但是对于不以某种方式涉及 isinstance 的更清洁的解决方案，我感到茫然，或依赖可能与我的实际代码相关或不相关的异常。

问题是，**在 python 中执行此操作的最有效方法是什么？**或者，或者，**对调用者这么多只是一个灾难的秘诀**，即我应该只要求参数是强制到一个`int` *或*行列表的类型列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T00:35:34.047

我建议不要让界面变得如此灵活。您的代码将更简单，有单独的 delete_rows(*row_objs) 和 delete_rows_by_id(*int_ids) 前者调用后者。

# java - 地图渲染错误 slick2d

> ID：14947286
> 
> 赞同：-3
> 
> 时间：2013-02-18T23:35:57.383
> 
> 标签：java, lwjgl, slick2d, slick

我最近一直在用java编写平台游戏，当我尝试使用单独的类来存储我的地图（平铺）时遇到了问题。然后我尝试通过将地图移动到主类来修复它，但它没有帮助。

这是导致问题的代码（当*world.map1.render(0,0)*被删除时，不存在问题） - 我知道我应该使用 getter 和 setter。我只是觉得他们很痛苦。

```
public void render(GameContainer arg0, Graphics arg1) throws SlickException {
    world.map1.render(0, 0);
} 
```

这是主要方法

```
public static void main(String[] args) throws SlickException{
    AppGameContainer app = new AppGameContainer(new Game());
    app.setDisplayMode(864, 480, false);
    app.setVSync(true);
    app.start();
    playerSheet = new SpriteSheet("resources/images/link3goldstudmod.png", 64, 64);
    player = new Player(playerSheet);
    world = new World();

} 
```

这是世界级的

```
import org.newdawn.slick.SlickException;
import org.newdawn.slick.tiled.TiledMap;

public class World {
    TiledMap map1;
    World() throws SlickException{
        map1 = new TiledMap("resources/maps/map1.tmx");
    }
} 
```

编辑：我忘了发布问题/堆栈废话/无论如何。我真傻。

```
Mon Feb 18 16:33:58 MST 2013 INFO:Slick Build #264
Mon Feb 18 16:33:58 MST 2013 INFO:LWJGL Version: 2.8.5
Mon Feb 18 16:33:58 MST 2013 INFO:OriginalDisplayMode: 1920 x 1080 x 32 @60Hz
Mon Feb 18 16:33:58 MST 2013 INFO:TargetDisplayMode: 864 x 480 x 0 @0Hz
Mon Feb 18 16:33:58 MST 2013 INFO:Starting display 864x480
Mon Feb 18 16:33:58 MST 2013 INFO:Use Java PNG Loader = true
WARNING: Found unknown Windows version: Windows 8
Attempting to use default windows plug-in.
Loading: net.java.games.input.DirectAndRawInputEnvironmentPlugin
Mon Feb 18 16:33:59 MST 2013 INFO:Found 3 controllers
Mon Feb 18 16:33:59 MST 2013 INFO:0 : USB Receiver
Mon Feb 18 16:33:59 MST 2013 INFO:1 : USB Receiver
Mon Feb 18 16:33:59 MST 2013 INFO:2 : Logitech Speaker
Mon Feb 18 16:33:59 MST 2013 ERROR:null
java.lang.NullPointerException
    at zeldaplatform.Game.render(Game.java:36)
at org.newdawn.slick.GameContainer.updateAndRender(GameContainer.java:703)
at org.newdawn.slick.AppGameContainer.gameLoop(AppGameContainer.java:456)
at org.newdawn.slick.AppGameContainer.start(AppGameContainer.java:361)
at zeldaplatform.Game.main(Game.java:27)
Mon Feb 18 16:33:59 MST 2013 ERROR:Game.render() failure - check the game code.
org.newdawn.slick.SlickException: Game.render() failure - check the game code.
at org.newdawn.slick.GameContainer.updateAndRender(GameContainer.java:706)
at org.newdawn.slick.AppGameContainer.gameLoop(AppGameContainer.java:456)
at org.newdawn.slick.AppGameContainer.start(AppGameContainer.java:361)
at zeldaplatform.Game.main(Game.java:27) 
```

这不是什么大错误，因为它编译得很好，然后控制台给了我这个。窗口出现片刻，然后消失。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:17:03.323

这是一个`NullPointerException`。*NPE的原因只有*一个；您尝试使用的东西没有被实例化并且是`null`. 在这种情况下，要么`world`在你的`Game`班级，要么在`map1`你的`World`班级。

考虑到你在你的开头实例化一个新`Game`的`Game.main()`，启动它，然后继续为所述类`World`的一个`static`字段分配一个新的（你不发布你的`Game`类，但这是你可以从`main()`堆栈跟踪中做到这一点的唯一方法表明它是`Game.main()`)，它是前者。

`AppGameContainer`( `app`) 正在被启动，`start()`然后该线程在您实例化并将您分配给静态字段之前继续调用该方法`Game`的实例。`render()``World`

不要使用`static`这样的字段；这真的不是他们的目的。您应该将这些实例（`playerSheet`、`player`和`world`）传递给 的构造函数`Game`并将它们分配给私有实例变量。

```
...
Game myGame = new Game(playerSheet, player, world);
AppGameContainer app = new AppGameContainer(myGame);
... 
```

# c# - 如何控制管理多个数据选择器中的最小值和最大值？

> ID：14947290
> 
> 赞同：1
> 
> 时间：2013-02-18T23:36:15.263
> 
> 标签：c#, jquery, asp.net-mvc, jquery-ui, razor

在我看来，我有一个扣环，每个日期都显示 a`startdate`和`enddate`。每个日期选择器都有一个范围限制（我的意思是，`StartDate`不能大于`EndDate`）。

这是我的剃刀观点

```
<h2>Configure Sixweeks</h2>

@for (int i = 0; i < Model.Count; i++) {
<div>
    <span>@Model[i].Position</span>
    @Html.TextBoxFor(model => model[i].StartDate, new { id = "from" + i })
    @Html.TextBoxFor(model => model[i].EndDate, new { id = "to" + i })
</div>
} 
```

这是大问题，我不知道指定最小值和最大值。例如，如果我在 STARTDATE 中选择 2 月 2 日，则 ENDDATE 中的最小值应该是 2 月 2 日。而这我还没有完成。

所以我从这个网站上使用了这个概念：http: [//api.jquery.com/attribute-starts-with-selector/](http://api.jquery.com/attribute-starts-with-selector/)但它仍然不起作用，我在下面的 jquery 代码中缺少什么？

```
$("[id^='from']").datepicker({
    defaultDate: "+1w",
    numberOfMonths: 1,
    onClose: function(selectedDate)
    {
        $(this).next("[id^='to']").datepicker("option", "minDate", selectedDate);
    }
});

$("[id^='to']").datepicker({
    defaultDate: "+1w",
    numberOfMonths: 1,
    onClose: function (selectedDate) {
        $(this).prev("[id^='from']").datepicker("option", "maxDate", selectedDate);
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:27:03.223

如果它不是直接的兄弟姐妹，但仍然是兄弟姐妹，则可以使用`nextAll()`查找与选择器匹配的所有下一个兄弟姐妹，然后`first()`获取第一个，这将是最接近当前日期选择器的兄弟，如下所示：

```
$("[id^='from']").datepicker({
    defaultDate: "+1w",
    numberOfMonths: 1,
    onClose: function(selectedDate)
    {
        $(this).nextAll("[id^='to']")
               .first()
               .datepicker("option", "minDate", selectedDate);
    }
}); 
```

还有一个`prevAll()`相反的方向等等。

# web-applications - 在 Angular 中加载脚本和资源时，实现加载器动画的最佳方法是什么？

> ID：14947295
> 
> 赞同：3
> 
> 时间：2013-02-18T23:36:58.877
> 
> 标签：web-applications, angularjs, angularjs-directive

**我希望我的 Web 应用程序的用户看到一个进度条，指示当前加载文件和所需脚本的进度。**

最好显示百分比，但简单的加载器 gif 是可接受的解决方案。

如果可能的话，实现加载器的最佳方法是什么？

我正在考虑拥有一个小型应用程序，其唯一目的是加载资源并指示进度，并且当所有脚本和资源完成后，触发一些回调以引导角度（angular.bootstrap（））。

我的猜测是，有很多聪明人可以提出更好的解决方案，我希望并认为比我更多的人可以从一些好的建议中受益。

能够为加载程序的正确性指定估计的文件大小也很好：

```
<script load-src="//somehost.com/file.js" filesize="100"/>
<img load-src=sprite.png" filesize="50"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T00:41:28.737

您是在谈论`<script>`标签和`<link>`标签等的加载吗？如果是这样，您可以使用 ng-cloak。使用 ng-cloak CSS 隐藏所有内容，并默认显示微调器。然后在角度完全加载后移除微调器。[有关 ng-cloak 的更多信息](https://stackoverflow.com/questions/14927073/footer-template-blinks-even-using-ng-cloak-in-angularjs)

如果您的意思是在完成一组您自己的 HTTP 请求之前加载微调器，您可以使用[angular-promise-tracker](https://github.com/ajoslin/angular-promise-tracker)跟踪 HTTP 请求并捕获“开始”和“完成”事件以提高百分比。

这是加载微调器的 http 请求示例：http: [//plnkr.co/edit/SHtk7eSrbs1dfoQawPCW ?p=preview](http://plnkr.co/edit/SHtk7eSrbs1dfoQawPCW?p=preview)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-30T09:47:15.630

对于一个简单的骨骼，简单的加载器 gif：

HTML：

```
<div ng-show="displayLoadingIndicator" class="LoadingIndicator">
</div> 
```

CSS：

```
.LoadingIndicator {
  display: block;
  background: url(../img/loading.gif) center center no-repeat;
  position:absolute;
  top:0;
  left:0;
  width: 100%;
  height: 100%;
} 
```

控制器 JS：

```
function MyCtrl($scope, $http) {
    $scope.displayLoadingIndicator = true;
    $scope.loadStuff = function (serverResponse) {
        // load my stuff
        $scope.displayLoadingIndicator = false; 
```

# javascript - Javascript - 预编译的正则表达式性能

> ID：14947307
> 
> 赞同：4
> 
> 时间：2013-02-18T23:38:12.317
> 
> 标签：javascript, regex, performance, precompile

在[这篇](http://www.levihackwith.com/javascript-performance-tip-precompile-your-regular-expressions/)文章中，据说预编译正则表达式将提高脚本性能。作者通过[性能测试](http://jsperf.com/regex-performance-testing/2)证明了这一点。但是，据我了解，这篇文章是在讨论重复使用正则表达式的情况。如果脚本中有很多正则表达式，但每个都只使用一次怎么办？预编译在整个脚本中只使用一次的正则表达式是否会带来性能优势？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-20T15:06:14.193

我不相信您链接的性能测试是决定性的。如果查看结果，差异可以忽略不计，因为正则表达式不够复杂。看看[这个](http://jsperf.com/regexp-indexof-perf)测试以获得更好的答案。

无论哪种方式，如果多次使用正则表达式，存储正则表达式值只会提高性能。这种性能提升完全是由于正则表达式本身的初始编译开销。如果您将正则表达式存储在变量中，那么它仍然会在第一次被编译，就像第一次编译文字一样。当*第二*次使用存储的正则表达式并且它已经编译时，就会发生差异，而文字正则表达式必须再次编译。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-01-23T07:36:03.277

我认为这取决于浏览器的实现，我们不能肯定地说一种方法更好。

在 Firefox 和 chrome 中查看不同的结果。

[![在此处输入图像描述](../Images/999690ae79cf26f0160c117232ca30b3.png)](https://i.stack.imgur.com/O5VzG.png)

我很困惑为什么 chrome 会为非重新编译的正则表达式提供更快的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T23:40:16.550

如果它只使用一次 - 那么只需使用正则表达式文字。

你的观点是正确的——只有当你经常使用相同的正则表达式时才有意义。

# c# - PrintDialog.ShowDialog() 导致所有控件上的视觉样式被禁用

> ID：14947308
> 
> 赞同：1
> 
> 时间：2013-02-18T23:38:14.580
> 
> 标签：c#, .net, winforms, visual-studio, printing

我正在使用带有 Visual Studio 2012 的 Windows 7 x64。显示打印对话框会导致应用程序中所有表单中的所有控件失去其视觉样式。我的意思是按钮失去了它们的圆角边缘，变成了 Windows XP 中的矩形。在显示打印对话框后，复选框也会在将鼠标悬停在它们上方时失去其视觉样式。

以下代码行导致问题：

```
pdlg.ShowDialog(); 
```

pdlg 是一个打印对话框。这只发生在一个项目中；使用同一行代码的其他项目可以正常工作。PrintDialog 甚至不必连接到 PrintDocument 即可发生问题（无需触发 BeginPrint/PrintPage 事件）。没有抛出任何错误。我没有在应用程序中将任何首选项保存到磁盘。

我努力了：

*   清洁/重建解决方案
*   删除并重新创建 PrintDocument 控件和 PrintDialog 控件
*   重新启动计算机
*   转换为不同的 .NET Framework 版本
*   以不同用户身份在同一台机器上运行应用程序 -**视觉样式保持正确启用**
*   在不同的机器上运行应用程序 -**视觉样式保持正确启用**
*   清空用户的 Temp 目录
*   重命名程序集
*   将应用程序移动到不同的目录

我的猜测是 .NET 以某种方式在内部保存了某些文件或注册表设置，它仅适用于一个应用程序/用户。或者某些缓存或某些东西已损坏。我已经用完了简单的故障排除想法。有没有人见过这个？接下来我应该尝试什么？

# c# - 修改成员时未调用 C# 对象设置器

> ID：14947309
> 
> 赞同：0
> 
> 时间：2013-02-18T23:38:22.153
> 
> 标签：c#, properties, setter

我有以下包装类：

```
public class Wrapper
{
    public int Member;
} 
```

在一个单独的课程中，我有以下内容：

```
public class ContainerClass
{
    private Wrapper data;
    public Wrapper Property
    {
        get { return data; }
        set { data = value; }
    }

    public void Foo()
    {
        Property.Member = 42;
    }
} 
```

当在`Property.Member`中修改时`Foo()`，没有任何反应（设置器被跳过）。但是，我仍然可以执行以下操作，例如：

```
 public void Foo()
    {
        Property = Property;
    } 
```

并输入所需的二传手。所以我的问题是，为什么不修改对象属性的成员调用该属性的设置器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T23:42:55.450

因为您没有修改参考。您正在修改引用的成员。

例如，假设我站在房间的角落说“拿着这个苹果”。如果我进来用香蕉换苹果..我没有换你，所以你很高兴。但如果我把你换成别人，你会抱怨我要代替你。

..无论如何，这就是我的类比。

此外，您已经为类添加前缀`I`.. 这通常用于 .NET 领域的接口。

编辑：我意识到，如果我让你拿着一块水果站在角落里……当我换掉你时，你可能不会抱怨……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T23:43:47.133

因为您没有设置`Property`. 您的代码只是调用 的 getter `Property`，然后设置`Member`字段的值（如果它是一个属性，它将调用 setter，`Member`这里不是这种情况）。

如果要在`Member`设置时执行代码，则需要

```
public class Wrapper
{
    private int member;
    public int Member
    {
        get { return this.member; }
        set 
        {
            this.member = value;
            DoSomething();
        }
    }
} 
```

* * *

或者也许更优雅的解决方案是使用事件。内置的[INotifyProperyChanged](http://msdn.microsoft.com/en-us/library/ms743695.aspx)接口为您提供了一个很好的模板来处理这类事情。

```
using System.ComponentModel;

public class Wrapper : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    private int member;
    public int Member
    {
        get { return this.member; }
        set 
        {
            this.member = value;
            this.OnPropertyChanged("Member");
        }
    }

    protected void OnPropertyChanged(string name)
    {
      PropertyChangedEventHandler handler = PropertyChanged;
      if (handler != null)
      {
          handler(this, new PropertyChangedEventArgs(name));
      }
    }
}

public class ContainerClass
{
    private Wrapper data;
    public Wrapper Property
    {
        get { return data; }
        set { data = value; }
    }

    public void Foo()
    {
        data.PropertyChanged += data_PropertyChanged;
        Property.Member = 42;
    }

    private void data_PropertyChanged(object sender, PropertyChangedEventArgs e)
    {
        if (e.PropertyName == "Member")
        {
            DoStuff();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T23:46:50.190

在 foo 的构造函数中，您正在设置类 Wrapper 的字段。

```
public void Foo()
{
    Property.Member = 42; // No property set, you are accessing a field.
} 
```

在第二个示例中，您正在设置一个属性

```
public void Foo()
{
    // Setting Property "Property" to the value of "Property"
    // You should see both the getter and the setter called.
    Property = Property; 
} 
```

我不知道你想做什么，但也许你希望 Wrapper 也有一个属性。

```
public class Wrapper
{
private int member;
public int Member
{
    get { return data; }
    set { data = value; }
}
} 
```

然后当您执行 Property.Member = 42 时，将在 Wrapper.Member 上调用 setter

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-22T07:32:05.537

通常人们直接通过 Add() 方法将对象添加到列表中，而这又不会触发 setter。

```
private List<string> _namesList = new List<string>();
// list of names
public List<string> NamesList
{    
    get
    {
    return _namesList;
    }
    set
    {
    if (value == _namesList)
    {
    return;
    }
    _namesList = value;
    }
} 
```

在上面的 NamesList 属性中，如果您调用 NamesList.Add("test") 它不会调用 setter。简单的解决方案是将列表存储在一个新变量中并逐渐将该变量设置为 NamesList 例如

```
List<string> lst = new List<string>{ "test1" };
d.NamesList = lst;              // setter will fire. 
```

但是直接将对象添加到列表/集合中是一个常见的错误。:)

# maple - 使用 stats[importdata]( ) 导入文件

> ID：14947311
> 
> 赞同：0
> 
> 时间：2013-02-18T23:38:42.797
> 
> 标签：maple

我想使用 statsimportdata 导入一个文件并做一个直方图，但是当我这样做时：

```
with(stats);
newdata:=importdata("data1.dat"):
histogram(newdata) 
```

它给了我一个：错误，（在 stats/statplots/functions/histogram 中）直方图 95.0 的错误参数我认为问题在于它将数据保存到序列中而不是列表中，但我需要使用导入数据。知道该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T01:53:31.737

您可以通过将表达式序列括在方括号中来快速将其转换为列表。

例如，

```
newdata := [ importdata("data1.dat") ]: 
```

仅从您引用的错误消息来看，您的问题似乎是您传递的是序列而不是列表。

顺便说一句，命令`Statistics:-Histogram`处理大量数据的速度比命令快得多`stats[statplots,histogram]`。前者已经使用了几年（Maple 的几个主要版本），并且通常更强大。

# java - 使用用户输入删除重复的单词或字符

> ID：14947321
> 
> 赞同：1
> 
> 时间：2013-02-18T23:39:21.693
> 
> 标签：java

我正在尝试从输入中删除重复项。有很多方法可以做到这一点，使用 ArrayList、LinkedList、Hash set 等。我知道如何做到这一点，如果输入指定为 say{“apple”、“ball”、“apple”、“cat”}在问题中。但我想使用扫描仪类并获取输入说一行并希望删除字符中的重复项，或删除重复的单词。你有一个简单的方法来做到这一点。我已经为之前的场景包含了我的工作代码。

```
public static void main(String[] args) {
        // TODO code application logic here

        Scanner scan= new Scanner(System.in);
        String[] str= {"a", "b", "c", "a"};
        System.out.println("enter text");
        List<String> l= 
                Arrays.asList(str);
        System.out.println(l);
        Set<String> set= new HashSet<String>(l);
        System.out.println(set);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:04:36.280

The following will read each word and add it to the hashset (which removes dups automatically which you figured out) and will stop when a word is ! and print out the set..

```
 Scanner scan= new Scanner(System.in);
    HashSet<String> set = new HashSet<String>();
    String s;
    while (!(s = scan.next()).equals("!")) {
        set.add(s);
    }
    System.out.println(set); 
```

# java - 如何确定要使用哪个版本的 Jetty？

> ID：14947322
> 
> 赞同：3
> 
> 时间：2013-02-18T23:39:24.490
> 
> 标签：java, maven, jetty

在我的 maven java webapp 构建中，我有以下插件：

```
<plugin>
   <groupId>org.mortbay.jetty</groupId>
   <artifactId>jetty-maven-plugin</artifactId>
   <version>8.1.8.v20121106</version>
</plugin> 
```

但是我正在使用的 Jetty 版本有那个烦人的“空身份服务”的东西，所以我想升级我正在使用的版本，但我想不出任何好的方法来确定哪个版本的 jetty 是最好的让我跑。

我发现[这个 Jetty 文档](http://www.eclipse.org/jetty/documentation/current/what-jetty-version.html)显示了一些信息，但仅关于大版本号，如 6、7、8 和 9。我使用的是 javax.servlet 3.0.1，所以我想我想要 8 或 9 .

[这个 Jetty 文档](http://www.eclipse.org/jetty/documentation/current/quickstart-jetty-coordinates.html)似乎告诉我如何找出要使用的各个版本，但我并不完全明白。看起来也许我应该使用 9.0.0.RC0？

在[jetty的maven repo页面上，](http://mvnrepository.com/artifact/org.eclipse.jetty/jetty-server)我可以看到一堆版本，但最新的版本8是我使用的带有错误身份服务的版本，而9s都是“里程碑”，我认为它们是比较不靠谱？我真的不知道“里程碑”是什么意思。

我会很感激一些指导或建议！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-05-28T10:44:18.187

在您的发行版中找到 start.jar。然后使用“--version”标志：java -jar start.jar --version

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T00:40:23.840

如果您不需要 WebSockets 或 SPDY，您可以坚持使用最新版本的 Jetty 8。查看此页面并选择最高的 8.1.x 版本：

[http://search.maven.org/#search%7Cgav%7C1%7Cg%3A%22org.eclipse.jetty%22%20AND%20a%3A%22jetty-server%22](http://search.maven.org/#search%7Cgav%7C1%7Cg%3A%22org.eclipse.jetty%22%20AND%20a%3A%22jetty-server%22)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-07T08:12:28.060

[这个Jetty_Version_Comparison_Table](http://wiki.eclipse.org/Jetty/Starting/Jetty_Version_Comparison_Table)和这个[Feature list](http://wiki.eclipse.org/Jetty/Feature)怎么样。如果您需要 xxx 功能，请查看它，它会显示您需要哪个版本来支持此功能。

# actionscript-3 - 关于加工

> ID：14947325
> 
> 赞同：2
> 
> 时间：2013-02-18T23:39:38.610
> 
> 标签：actionscript-3, flash, processing, osc

我想知道 OSC 你能告诉我更多关于它的信息吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T12:16:27.833

[在一些项目](http://www.hirschandmann.com/2013/siemens-crystal/)中，我使用[TUIO-AS3 的 UDPConnector](http://code.google.com/p/tuio-as3/source/browse/trunk/org/tuio/connectors/UDPConnector.as)与 as3 进行了一些最小的 OSC 交互，并且没有任何问题。这里有一个最小的片段来说明我所做的事情：

```
package
{
    import flash.display.Sprite;
    import flash.utils.getDefinitionByName;

    import org.tuio.connectors.UDPConnector;
    import org.tuio.osc.*;

    public class BasicOSC extends Sprite implements IOSCConnectorListener
    {
        private var oscSocket:UDPConnector;
        private const OSCSERVER:String = "127.0.0.1";
        private const PORT:int = 8082;

        public function BasicOSC()
        {
            try{    
                oscSocket = new UDPConnector(OSCSERVER,PORT);
                oscSocket.addListener(this);
                trace(this,"OSC ready");
            }catch(e:Error){    trace(e.getStackTrace());   }   
        }
        public function acceptOSCPacket(oscPacket:OSCPacket):void{
            //handle OSC here
            var message:OSCMessage = oscPacket as OSCMessage;
            trace("message from :",message.address,"at",new Date());
            for(var i:int = 0; i < message.arguments.length; i++)
                trace("\targs["+i+"]",message.arguments[i]);
        }
    }
} 
```

**更新：** 请注意，我将 OSCPacket 转换为[OSCMessage](http://bubblebird.at/tuioflash/doc/org/tuio/osc/OSCMessage.html)，它在幕后处理解析并轻松使地址和参数可用，这就是您所追求的。

作为参考，这是我用来模拟您的设置的最小处理草图：

```
import oscP5.*;
import netP5.*;

OscP5 osc;
NetAddress where;

void setup() {
  frameRate(25);text("click to send\nOSC",5,50);

  osc = new OscP5(this,12000);
  where = new NetAddress("127.0.0.1",8082);
}
void draw() {}
void mousePressed() {
  OscMessage what = new OscMessage("/straps");
  what.add(193.4509887695313);
  osc.send(what, where); 
} 
```

高温高压

![预防火灾](../Images/a6ae2ac595248c07b364dce5c2365ca8.png)

![城市监视器](../Images/fa3f62fbcc0ca34f728c980d7f779958.png)

# ios4 - UITapGestureRecognizer 在 Xcode 4.1/iOS 4.3 上不起作用

> ID：14947338
> 
> 赞同：1
> 
> 时间：2013-02-18T23:41:01.457
> 
> 标签：ios4, uibutton, uitableview, uitapgesturerecognizer, xcode4.1

我正在尝试使用以下示例实现一个可扩展的表视图单元：
[http](http://blog.paxcel.net/blog/expandablecollapsible-table-for-ios/)
://blog.paxcel.net/blog/expandablecollapsible-table-for-ios/ 在这里，他们使用 Xcode 4.3 和 iOS 5，但是我必须使用 Xcode4.1 和 iOS 4.3 来实现它。使用这个版本，当点击按钮时，我的视图/按钮无法识别，但我编译了我的项目，使用相同的类，但使用 Xcode 4.3/iOS 5，并且点击它被识别，所以类很好。
下面是使用按钮创建 UIView 的代码：
SectionView.m

```
-(id)initWithFrame:(CGRect)frame withTitle:(NSString *)title section:(NSInteger)sectionNumber delegate:(id<SectionView>)Delegate{
    self = [super initWithFrame:frame];
    if(self){
        UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(discButtonPressed:)];
        [tapGesture setNumberOfTapsRequired:1];
        tapGesture.cancelsTouchesInView = NO;
        [self addGestureRecognizer:tapGesture];

        self.userInteractionEnabled = YES;

        self.section = sectionNumber;
        self.delegate = Delegate;

        CGRect labelFrame = self.bounds;
        labelFrame.size.width -= 50;
        CGRectInset(labelFrame, 0.0, 5.0);

        UILabel *label = [[UILabel alloc] initWithFrame:labelFrame];
        label.text = title;
        label.font = [UIFont boldSystemFontOfSize:16.0];
        label.backgroundColor = [UIColor clearColor];
        label.textColor = [UIColor blackColor];
        label.textAlignment = UITextAlignmentLeft;
        [self addSubview:label];
        self.sectionTitle = label;

        CGRect buttonFrame = CGRectMake(labelFrame.size.width, 0, 50, labelFrame.size.height);
        UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
        button.frame = buttonFrame;
        [button addTarget:self action:@selector(discButtonPressed:) forControlEvents:UIControlEventTouchUpInside];

        [self addSubview:button];
        self.discButton = button;
    }

    return self;
 } 
```

这是从 SectionView 创建/委托的类：
TableDropViewController.h

```
#import <UIKit/UIKit.h>
#import "SectionView.h"

@interface TableDropViewController : UITableViewController <SectionView>

@end 
```

并且这个方法创建了对象SectionView：
TableDropViewController.m

```
-(UIView*)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section{
    SectionInfo *si = [self.sectionInfoArray objectAtIndex:section];
    if(!si.sectionView){
        NSString *title = si.category;
        si.sectionView = [[SectionView alloc] initWithFrame:CGRectMake(0, 0, self.tableView.bounds.size.width, 45) withTitle:title section:section delegate:self];
    }
    return si.sectionView;
} 
```

我将非常感谢您的帮助。谢谢

# python - 为什么此代码仅在我使用 'x,y = y,x + y 格式而不是 'x = y; y = x + y'？

> ID：14947340
> 
> 赞同：0
> 
> 时间：2013-02-18T23:41:08.407
> 
> 标签：python, variables

我正在研究 euler 项目，不过这无关紧要。我正在编写一个快速代码来打印出斐波那契数列。实际上，我对项目欧拉方程有不同的代码，但这本质上是我正在使用的算法：

```
x = 1
y = 0
while x < 4000000:
    print x
    x = y
    y = x + y 
```

这让我困扰了一段时间，这应该有效。然后我研究了一下，发现几乎相同的代码，但格式有点不同。它奏效了！唯一的区别是将 x 和 y 赋值放在一行中，用逗号分隔。所以我试了一下：

```
x , y = 1 , 0
while x < 4000000:
    print x
    x,y = y, x + y 
```

显然，正如我所说，它奏效了。这真的让我很困扰，因为除了聪明并在第二个中使用更少的行之外，我无法弄清楚两者之间的区别。我不明白为什么输出不同。为什么输出不一样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-18T23:44:50.410

在您的第一个代码中：

```
x = y
y = x + y 
```

您实际上是分配`y + y`给`y`. 由于 的值`x`已经被覆盖。这不是你想要的吗？

* * *

在您的第二个代码中：

```
x, y = y, x + y 
```

首先在 RHS`y`上`x + y`进行评估，然后将评估值分配给`x, y`LHS。因此，不会像第一种情况那样`x + y`对新分配的值产生任何副作用。`x`所以，你的`y`意志只有`x + y`.

因此，在实际分配完成之前，这只是`evaluation`两个表达式 on的情况。`RHS`

是的，您的 while 循环之外的分配不会有任何区别。但是第二种方式看起来更有吸引力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T23:43:15.280

我猜想在第二个版本中，当它评估时，`y, x+y`它使用 x+y 中 x 的原始值。

在两行版本中，当它评估时`x+y`x 已设置为 y 这导致 x+y 与`y+y`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T23:44:47.847

你重新分配 x。

让我们举一个数字示例

情况1：

```
x = 4
y = 2
x = y = 4
y = x + y = 4 + 4 = 8 
```

案例二：

```
x = 4
y = 2
x, y = y, x + y = 2, 4 + 2 = 2, 6 
```

因此，在第一种情况下，x 为 4，y 为 8，而在第二种情况下，x 为 2，y 为 6。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T23:45:11.990

在第一个版本中，第一个赋值改变了 x 的值。这会影响下一行赋值中的值。这意味着`y = x + y`更像是`y = y+y`因为您已经更改了 x。

在第二个版本中，两个赋值是同时完成的，所以两个值同时更新。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-18T23:52:21.877

这是因为在 行之后`x = y`，第二行 ( `y = x + y`) 被评估为`y = y + y`。例如，假设 x = 2 和 y = 3。

然后，

```
x = y          # i.e. x = 3 now
y = x + y      # i.e. y = 3 + 3 = 6 (while you wanted it to be 5) 
```

另一方面，

```
x, y = y, x + y  # this first assigns values to the right hand side 
```

所以，

```
x, y = 3, 2 + 3  # i.e x, y = 3, 5 
```

# python - 如何根据defaultdict中的键累积值

> ID：14947341
> 
> 赞同：2
> 
> 时间：2013-02-18T23:41:14.600
> 
> 标签：python, map, iterator, key, defaultdict

如果我有一个 defaultdict(list)

```
d =defaultdict(list)
such as 1: 0
        1:0.2
        1: 0.3
        2: 0.2
        2: 0.4
        2: 0.1 
```

......我如何将其转换为类似的 defaultdict(list) 其值是具有相同键的第一个 dict 的值的累积，但从不大于 1

```
 1: 0
        1: 0.2
        1: 0.5
        2: 0.2
        2: 0.6
        2: 0.7 
         ..... 
```

到目前为止我只有以下代码，它不太正确:-(

```
 d2 = defaultdict(list)
 for k in d.iterkeys()
          v +=d(k)
          d2[k]. append(v) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T23:49:51.107

原始帖子有点令人困惑：这些示例看起来像一个多图而不是列表的字典。

我假设您有一个带有数字列表的 defaultdict，并且您想创建一个新的 defaultdict，其中包含每个列表中值的累积总和。尝试这个：

```
d2 = defaultdict(list)
for k, v in d.iteritems():
    sum = 0.0
    v2 = []
    for x in v:
        sum += x
        v2.append(sum)
    d2[k] = v2 
```

请注意，当您添加新值时，新的 defaultdict 不会自动计算累积总和。

如果您安装了 numpy 之类的库，则可以使用`numpy.cumsum`而不是使用 python 循环来计算累积和。

我不清楚“从不大于 1”到底是什么意思。累积和达到 1 后是否要忽略元素？您是否要忽略大于 1 的单个值，但继续累积较小的值，即使总和超过 1？您是否希望每个输出列表中的元素数量相同，但将元素值限制为 1？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-25T09:56:01.370

作为参考，您可以更优雅地执行此操作：

```
d2 = defaultdict(float)
for k, v in d.iteritems():
    d2[k] += v 
```

# algorithm - 计算圆圈中的点 - 步长？

> ID：14947345
> 
> 赞同：2
> 
> 时间：2013-02-18T23:41:39.257
> 
> 标签：algorithm, math, trigonometry, geometry, angle

我想计算一个圆圈中的所有点。我已经知道我可以使用`x = r * cos(theta) + x0`, `y = r * sin(theta) + y0`- 但是我想知道是否有一种很好的方法可以根据我的像素画布（或我的 LCD）的分辨率和圆的半径来找到合适的 theta 步长。

这是我已经拥有的代码（`_arange()`就像`range()`但也需要一个浮点值`step`）：

```
def circle(x0, y0, r):
    step = 2 * math.pi / 1000
    for theta in _arange(0, 2 * math.pi, step):
        x = x0 + r * math.cos(theta)
        y = y0 + r * math.sin(theta)
        set(round(x), round(y)) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-18T23:43:27.867

听起来[中点圆算法](http://en.wikipedia.org/wiki/Midpoint_circle_algorithm)可能*更*适合您想要的。

> 中点圆算法是一种用于确定画圆所需点的算法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T23:58:24.320

对于不同的方法，从顶点在 (x0+-r,y0) 和 (x0,y0+-r) 的正方形开始，然后在中点递归划分每条边并将其投影到圆上。当边的长度小于一个像素时停止递归。也许不是最快的算法，但它确实避免了三角函数，尽管它需要平方根和除法。

这是 Lua 中实现此策略的一些代码。作为递归组织方式的额外结果，它以正确的循环顺序输出点。

```
local tolerance=1e-2

local function explore(x0,y0,r,x1,y1,x2,y2)
    local x=x1+x2
    local y=y1+y2
    local s=r/math.sqrt(x^2+y^2)
    x=s*x
    y=s*y
    if math.sqrt((x1-x2)^2+(y1-y2)^2)<tolerance then
        print(x+x0,y+x0)
    else
        explore(x0,y0,r,x1,y1,x,y)
        explore(x0,y0,r,x,y,x2,y2)
    end
end

local function circle(x0,y0,r)
    explore(x0,y0,r,r,0,0,r)
    explore(x0,y0,r,0,r,-r,0)
    explore(x0,y0,r,-r,0,0,-r)
    explore(x0,y0,r,0,-r,r,0)
end

circle(0,0,2) 
```

# mysql - 已收到 Securepay 付款但未创建 Magento 订单

> ID：14947355
> 
> 赞同：0
> 
> 时间：2013-02-18T23:42:24.573
> 
> 标签：mysql, magento

我们最近遇到了一个问题，Securepay 收到了客户的付款，但订单不是在 Magento 中创建的。当下一个订单通过时，订单 ID 实际上也在 Magento 中被跳过，但我们在网格中看不到它。

任何人都可以对可能发生的事情有所了解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T07:53:45.983

您可以查看订单是否在 sales_flat_order 表中。否则，您可以启用错误日志记录，并且在向支付网关发出请求或用户没有返回支付网关的响应后可能会发生一些 php 错误。

# c# - 如何以编程方式触发 WinRT/C#/XAML 中的按键事件？

> ID：14947357
> 
> 赞同：3
> 
> 时间：2013-02-18T23:42:40.193
> 
> 标签：c#, xaml, input, windows-runtime, keypress

今天的任务是使 WinRT 应用程序能够被远程控制。所有接线到位后，是时候实施远程控制操作了。这些动作的最简单实现是简单地模拟进程内的按键。

不幸的是，我无法找到一种方法来做到这一点。我确信它正盯着我看，但我在网上找到的每个解决方案都是通过 PInvoke、Windows 窗体或 WPF 的方言，这些在 WinRT 中不可用。

有谁知道魔法咒语吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-12T03:11:05.597

不允许在 WinRT XAML 中以编程方式触发用户启动的事件。原因是，某些 API 被限制为只能由用户交互调用。以编程方式引起此类事件将绕过此安全机制。

# c# - 找出已写入文件流的字节数

> ID：14947360
> 
> 赞同：1
> 
> 时间：2013-02-18T23:43:09.287
> 
> 标签：c#, filestream

我正在使用`FileStream.Write()`服务器\客户端程序的方法。我试图`FileStream`通过使用“ `int byteswritten = FileStream.Write(bytes1,0,bytes1.length);`”来确定是否所有字节都已写入。我注意到 FileStream.Read() 方法支持此功能，但 FileStream.Write() 方法不支持。这种方法总是写字节吗？如果不支持，为什么不支持？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T23:47:14.390

`Stream.Write()`指定始终写入整个输入，或抛出异常。

因此，返回这个值是没有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T23:54:18.633

它总是会写入整个字节。

[MSDN FileStream.Write](http://msdn.microsoft.com/en-us/library/system.io.filestream.write%28v=vs.90%29.aspx)：使用缓冲区中的数据将字节块写入此流。

> 如果写入操作成功，则流的当前位置将提前写入的字节数。如果发生异常，则流的当前位置不变。

# java - 自定义 JButton 子类 setIcon 方法不起作用

> ID：14947361
> 
> 赞同：1
> 
> 时间：2013-02-18T23:43:09.807
> 
> 标签：java, swing, jbutton, embedded-resource, imageicon

*编辑：这是一个 Netbeans 项目。* 所以我创建了一个名为 Card 的 JButton 子类。我正在尝试为创建按钮设置一个图标。

```
package matchinggame;

public class Card extends JButton {

    final static ImageIcon defaultIcon = new ImageIcon("cardback.jpg");

    ...

    public Card(int secretIconIndex) { 
        //Set the button's icon to the default icon
        setIcon(defaultIcon);
        ... 
    }

    ...

} 
```

如果您想知道，“cardback.jpg”图像的位置是：

```
C:\Users\Jesse\SkyDrive\Documents\RCS\Grade 12\ICS4U\M9\MatchingGame\src\matchinggame\cardback.jpg 
```

它与所有类都在同一个文件夹/包中，所以我相信我可以这样保留相对文件路径。当我运行程序时，所有按钮都是空白的（没有文本或图标）。这是构造函数问题还是文件路径问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T23:56:20.903

如果这是一个 Eclipse 项目，则将图像存储在`resources/`文件夹中的`src/`文件夹中。

```
setButtonIcon("cardback.jpg");

public void setButtonIcon(String filename) {
  ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
  InputStream input = classLoader.getResourceAsStream("/"+filename);
  ImageIcon icon = new ImageIcon(ImageIO.read(input));
  super.setIcon(icon);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T00:13:11.447

我的问题在问题评论中得到了回答。brano88 和 Hovercraft Full of Eels 说使用资源而不是文件路径。以下解决了我的问题：

```
final ImageIcon defaultIcon = new ImageIcon(getClass().getResource("/resources/cardback.jpg")); 
```

我把它放在我的卡片课上。

**注意：**我将图像移动到 Eclipse 中的“src”文件夹或 Netbeans 中的“Source Packages”文件夹中的新“资源”包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T23:55:47.537

如果使用“eclipse”，则图像必须在文件夹“src”内才能使用绝对路径。利用：
`new File("cardback.jpg").exists() // to see if the file is in the right place`

# google-drive-api - 在 Google 云端硬盘公共视图中对文件进行排序

> ID：14947363
> 
> 赞同：2
> 
> 时间：2013-02-18T23:43:18.800
> 
> 标签：google-drive-api

通过 Google Drive 的 Web 界面，我知道如何对目录中的文件进行排序。但是，当我通过向某人​​发送“共享链接”来共享文件夹时（因为他们没有 Google Drive 帐户），他们可以查看公共共享目录中的文件，但文件总是按字母顺序排序。在这个有限的界面中似乎没有菜单来指定如何排序。用户如何排序，或者我如何为文件夹指定默认排序？（我想按文件修改时间排序。）我正在使用 Google Drive API，并且对需要使用它的解决方案很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-13T11:42:12.127

可悲的是，目前没有办法做到这一点。我提出了一个功能请求，欢迎您投票。该链接位于[https://www.google.com/moderator/#15/e=c81a2&t=c81a2.4c&f=c81a2.6af5c7&q=c81a2.6af5c7](https://www.google.com/moderator/#15/e=c81a2&t=c81a2.4c&f=c81a2.6af5c7&q=c81a2.6af5c7)

# ios - 自动调整蒙版和全屏视图

> ID：14947368
> 
> 赞同：3
> 
> 时间：2013-02-18T23:44:06.723
> 
> 标签：ios, autoresizingmask

我正在尝试一些奇怪的东西。我想创建一个适合我所有屏幕的视图（减去状态栏减去导航栏）。这是我在我的内部所做的`viewDidLoad`：

```
CGFloat navHeight = self.navigationController.navigationBar.frame.size.height;
UIView *test = [[UIView alloc] initWithFrame:CGRectMake(0, 0, screenWidth, screenHeight-20-navHeight)];
test.backgroundColor = [UIColor greenColor];
//test.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
[self.view addSubview:test]; 
```

如果我留下 autoresizing 行的注释，这工作正常，但是当我旋转时，它不再适合（这是预期的）。

如果我取消注释自动调整大小行，当我第一次以纵向模式启动时，我的视图大小类似于 320x430，而当我第一次以横向模式启动时，它就像 480x200 ......对于“首次启动”，我的意思是“来自另一个视图”。

我尝试添加灵活的边距，但没有解决（无论如何我希望它是全屏的，所以（x，y）将永远是（0,0）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-18T23:48:37.647

UINavigationController 将为您调整其子视图的大小，因此您不必考虑导航或状态栏。您只需要将此视图添加到 VC 的视图并将其设置为灵活的宽度/高度，这样它就会填充父视图。

```
 UIView *test = [[UIView alloc] initWithFrame:self.view.bounds];
    test.backgroundColor = [UIColor greenColor];
    test.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
    [self.view addSubview:test]; 
```

# php - 显示用户在线状态

> ID：14947373
> 
> 赞同：0
> 
> 时间：2013-02-18T23:44:48.007
> 
> 标签：php, sql

我希望显示我网站用户的在线状态。我不需要显示上次活动的确切时间。但肯定会显示用户过去是否有任何活动，比如 5-10 分钟。

我在考虑创建这个系统时遇到的问题如下：

*   如果我要使用 onlineUsers 创建一个 sql 表，并在每个特定页面或每个 x 页上更新表（以防止过多的 sql 更新），那肯定会给我一个非常精确的自上次活动以来的分钟数。但这会导致与数据库的连接过多，最终会降低网站速度。

*   我可以通过制定一些智能方程式以某种方式最小化这个问题，只让用户更新他们的 onlineUsers 行，每次点击 100 页，这不需要太多 php 资源，但这仍然是一种脾气暴躁的方式。

*   我还可以以某种方式集成某种作物列表系统，每 10 分钟检查一次哪些用户在线，并更新所有表格。但我不确定这将如何解决，如何检查哪些用户在过去 10 分钟内完全处于活动状态，而实际上没有使用他们的 id 更新任何表行。

那好吧。我确信这样的系统之前已经制作了数百次。所以应该有人能够告诉我制作这样一个系统的最佳方法，这将需要尽可能少的数据库资源。

*   编辑 * 我正在使用 Cookie 来设置用户登录。

谢谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:26:32.430

通常使用的方法是向用户表中添加一列，该表`last_activity`在页面加载时更新。这是您可能设法创建的最简单、最可靠的方法。

为了加快速度，您可以创建一个会话变量来保存您上次更新活动列的时间。您可以读取每个用户的信息并检查最后一次更新是否太远（比如说 3 分钟），然后在那个时候更新。如果用户在一分钟内刷新页面 100 次，这将避免 100 次数据库调用/分钟。

> 我可以通过制定一些智能方程式以某种方式最小化这个问题，只让用户更新他们的 onlineUsers 行，每次点击 100 页。

通过 page click 我假设您的意思是*page requests*。恕我直言，这不是一个坏主意：如果用户每 8 分钟在一段时间内加载页面 3 次，则每个请求都应该更新。

> 我还可以以某种方式集成某种作物列表系统，每 10 分钟检查一次哪些用户在线，并更新所有表格。但我不确定这将如何解决，如何检查哪些用户在过去 10 分钟内完全处于活动状态，而实际上没有使用他们的 id 更新任何表行。

那只是矫枉过正。

# objective-c - 在objective-c中使用二维数组语法的双指针元素访问

> ID：14947383
> 
> 赞同：2
> 
> 时间：2013-02-18T23:45:25.400
> 
> 标签：objective-c, arrays, pointers, syntax, double-pointer

我是objective-c的新手，并且正在做一些暂时有效的事情，但我担心有一天会坏掉。

在我的一个对象中，我将一个整数矩阵声明为实例变量。由于我还不知道矩阵的大小，所以我这样声明：

```
int **_matrix; 
```

稍后在代码中，当我知道矩阵的行数和列数时，我将其初始化如下：

```
_matrix = malloc(sizeof(*_matrix) * columns * lines);
for (i = 0; i < columns; i++) {
    _matrix[i] = malloc(sizeof(int) * lines);
    for(j = 0; j < lines; j++)
        _matrix[i][j] = -1;
} 
```

假设我的分配是正确的（如果它实际上是错误的，请随时告诉我），我可以自信地使用二维数组语法访问元素吗？

我之所以问，是因为根据我的阅读，当您创建一个实际的二维数组时，内存会连续保留，但使用双指针可能并非如此。所以我害怕打电话

```
_matrix[i][j] 
```

实际上会指向内存中的一个随机位置（而不是我分配的位置）。

谢谢您的回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:08:10.493

是的，它是安全的。的确，堆栈上的二维数组通常是连续分配的，但您不必担心这一点。重要的是括号一次被评估一对，而不是作为一些特殊的`[][]`运算符，并且括号取消引用指针。所以它会取消引用你的第一个指针，然后它会取消引用第一次取消引用产生的“行”指针。

更多信息：数组访问和指针取消引用是等效的。表达式`x[y]`等价于`*(x+y)`。因此，您的代码首先取消引用指针 value `(matrix + i)`，从而为您提供另一个指针值（因为您有一个指针数组）。在此之后，您的代码取消引用指针`(matrix[i] + j)`并将其分配值 -1。如您所见，这正是您想要它做的事情。

# android - 应用程序使用非常简单的代码意外关闭

> ID：14947385
> 
> 赞同：0
> 
> 时间：2013-02-18T23:45:35.420
> 
> 标签：android, eclipse, audio, media-player, android-mediaplayer

我想通过按一下按钮来播放声音，但应用程序却以非常简单的代码意外关闭。 **MainActivity.java：**

```
 package com.example.zvuki;

import android.media.MediaPlayer;
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.View;
import android.widget.Button;

public class MainActivity extends Activity {

    protected Object MediaPlayer1 ;
public class TestSonido extends Activity{
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Button br = (Button) findViewById(R.id.button1);
        br.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
            MediaPlayer mp = MediaPlayer.create(TestSonido.this, R.raw.poeb);
            mp.start();

            }
        });
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

}

} 
```

**活动主.xml：**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/texture_10_by_night_fate_stock"
    android:onClick="onClick"
    tools:context=".MainActivity" >

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_marginLeft="61dp"
        android:layout_marginTop="73dp"
        android:onClick="onClick"
        android:text="POEBEN" />

</RelativeLayout> 
```

该项目没有给出任何错误，因为我不知道问题是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T23:51:57.520

删除 android:onClick="onClick"，这将在您的活动中查找 onClick 方法以在单击时调用，因为您正在设置点击监听器，这是多余的。

另一种方法是删除 setOnClickListener 代码并将 onClick(View view) 代码移动到类的主体，例如：

```
public class MainActivity extends Activity {

    protected Object MediaPlayer1 ;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);           
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public void onClick(View v) {
        MediaPlayer mp = MediaPlayer.create(TestSonido.this, R.raw.poeb);
        mp.start();   
    }

} 
```

# asp.net-mvc - 我应该如何缓存在 ASP.NET MVC 中构建的复杂对象？

> ID：14947388
> 
> 赞同：3
> 
> 时间：2013-02-18T23:46:05.360
> 
> 标签：asp.net-mvc, caching

我正在建立一个网站，以允许用户创建由多个任务组成的时间表。计划和任务信息存储在数据库中。

创建计划时，用户可以在最终保存计划之前添加、编辑或删除任意数量的任务。这些更改将持久保存到数据库中，以便用户可以在以后恢复编辑（如果他们的会话意外结束或被中断）。

每次收到更新任务的请求时，网站都会从我的数据访问层调用适当的方法，然后从数据库中重新请求整个计划数据对象以显示给用户。

当只编辑一个任务时，这似乎有点矫枉过正。我想在 HttpContext.Session 中缓存计划对象及其任务列表，并且只更新正在更改的单个任务（或更改时的计划对象）。

只要我在确认编辑操作成功时才​​更新我的缓存对象，我的两个版本不同步有什么危险吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T23:54:47.670

如果会话被重置，这可能是由于更新 web.config、修改 dll，甚至 IIS 自动应用程序池回收等原因导致的，都会导致您的会话被清除。如果您有多个 Web 服务器，您将不得不担心跨多个 Web 服务器和数据库中的一个同步会话。就我个人而言，我尽量不在会话中存储任何可以避免的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T23:57:19.567

> 我的两个版本不同步有什么危险吗

只要您在成功编辑后从服务器拉下新状态并更新缓存，那么应该没有问题。

要记住的一件事是，如果您要允许协作编辑，则必须引入轮询以确保您的本地副本不会过时。不过，从你的描述来看，可能性不大。

# c++ - OpenGL 绘制图像。图片库

> ID：14947394
> 
> 赞同：0
> 
> 时间：2013-02-18T23:46:31.147
> 
> 标签：c++, c, opengl, glut

我正在尝试在屏幕上绘制图像。我正在使用 PIC 库来获取图像。

现在，我有一个像素强度数组，每个值看起来像这样

```
currentImage->pix[currentRow * x * bytesPerPixel] = number from 0 to 256. 
```

我正在尝试使用以下方式绘制图像：

```
// initialize the most basic image
for (int y = currentImage->ny; y >= 0; y--) {

    // draw out each row of pixels
            // line 18 -- this following line throws the error on compile
            glReadPixels(0, 479-y, 640, 1, GL_RGB, GL_UNSIGNED_BYTE, &image->pix[y*image->nx*image->bpp]);

} 
```

但这不起作用。当我尝试编译时，我不断收到此错误：

```
g++ -O3 -I/usr/local/src/pic -Iinclude -o current src/main.cpp src/modules/*.cpp -L/usr/local/src/pic -framework OpenGL -framework GLUT -lpicio -ljpeg
src/modules/application.cpp: In function ‘void application::idle()’:
src/modules/application.cpp:18: error: invalid conversion from ‘int’ to ‘const GLvoid*’
make: *** [all] Error 1 
```

以前有没有人遇到过类似的问题？我现在只是尝试在屏幕上绘制最基本的图像。

这是我初始化 gl 显示函数的 main.cpp 函数。

```
 // set up the main display function
  glutDisplayFunc(application::display);

  // set the various callbacks for the interaction with opengl
  glutIdleFunc(application::display); 
```

Application.cpp 完整文件：

```
namespace application {

    void init() {

        idle();     
    }

    // implement idle function -- responsible for working with the image on a consistent basis to continually ensure its integrity
    void idle() {

        // initialize the most basic image
        for (int y = currentImage->ny; y >= 0; y--) {

            // draw out each row of pixels
            glDrawPixels(currentImage->nx, 1, GL_RGBA, GL_UNSIGNED_BYTE, currentImage->pix[y * currentImage->nx * currentImage->bpp]);  
        }

    }   

    // display is for drawing out the elements using our scaled frame etc
    void display() {

        // rotate, scaling and translation should take place before this code in the future
        // draw a quick cube around the origin of the screen
        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); 
        glClearColor(000.0, 0.0, 0.0, 1.0);
        glutSwapBuffers();

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:02:01.877

我最好的猜测是你的问题在这里：

```
glDrawPixels(currentImage->nx, 1, GL_RGBA, GL_UNSIGNED_BYTE, currentImage->pix[y * currentImage->nx * currentImage->bpp]); 
```

glDrawPixels 的最后一个参数需要是 const GLVoid*

[http://www.opengl.org/sdk/docs/man2/xhtml/glDrawPixels.xml](http://www.opengl.org/sdk/docs/man2/xhtml/glDrawPixels.xml)

但是你将它传递给一个int。

# php - 获取属于团队的成员

> ID：14947396
> 
> 赞同：1
> 
> 时间：2013-02-18T23:46:52.377
> 
> 标签：php, mysql, codeigniter

我正在尝试获取与登录用户在同一团队中的所有成员。

表格示例：

队表：

```
id     name
1      Test team
2      Second team 
```

成员表：

```
uid     team_id
4       1
10      2
1       2 
```

登录用户的 uid = 4。

在这个例子中，它应该只返回 1 个用户，因为登录的用户 (uid = 4) 只属于 1 个团队。

这是我目前拥有的代码，但它占用了所有用户（无论他们是否属于同一团队）

```
$this->db->select('*');
$this->db->from('teams');
$this->db->join('members', 'members.team_id = teams.id');
$this->db->join('users', 'members.uid = users.id');
$this->db->group_by('uid'); 
```

希望有人对如何解决这个问题有任何意见:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T01:07:28.920

我不确定，但我猜你想从登录用户所在的团队中获取所有成员。在这种情况下尝试：

```
$user_id = 4 or  $this->session->userdata('user_id');
$sql = "SELECT * FROM ( SELECT team_id FROM members WHERE uid = $user_id) tid
        JOIN members m ON m.team_id = tid.team_id
        LEFT JOIN team_table tt ON tt.id = m.team_id
        GROUP BY m.uid";
$query = $this->db->query($sql); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T23:58:05.007

我们重新来过吧：

```
SELECT * 
FROM member
WHERE team_id=(SELECT team_id FROM member WHERE uid=4) 
```

见[SQLfiddle](http://sqlfiddle.com/#!2/f5629/7)

# java - 从 Object[] 转换为 String[] 会产生 ClassCastException

> ID：14947399
> 
> 赞同：3
> 
> 时间：2013-02-18T23:47:03.120
> 
> 标签：java, swing, java-7, jogl

方法`getStrings()`是给我一个. `ClassCastException`谁能告诉我应该如何获得模型？谢谢！

```
public class HW3model extends DefaultListModel<String>
{           
    public HW3model()
    {
        super();
    }

    public void addString(String string)
    {
        addElement(string);
    }

    /**
     * Get the array of strings in the model.
     * @return
     */
    public String[] getStrings()
    {
         return (String[])this.toArray();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T23:55:24.783

返回的值`toArray`是一个`Object`数组。

也就是说，它们被声明为`Object[]`, not `String[]`，然后通过 a 返回`Object[]`。

这意味着您永远不能将其大小写为`String`数组，它根本无效。

您将不得不自己复制这些值......例如

```
public String[] getStrings()
    Object[] oValues= toArray();
    String[] sValues = new String[oValues.length];
    for (int index = 0; index < oValues.length; index++) {
        sValues[index] = oValues[index].toString();
    }
    return sValues;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T23:51:45.077

您不能将一个数组转换为另一个数组的类型，因此您必须确保创建自己的数组：

```
public String[] getStrings() {
    String[] result = new String[getSize()];
    copyInto(result);
    return result;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T23:57:24.383

试试这个，看看是否可行

```
String[] stringArrayX = Arrays.copyOf(objectArrayX, objectArrayX.length, String[].class); 
```

# asp.net - Webforms 应用程序上的客户端表单发布

> ID：14947406
> 
> 赞同：0
> 
> 时间：2013-02-18T23:47:20.650
> 
> 标签：asp.net, jquery, post, webforms, dotnetnuke

我发现自己陷入了困境。我正在使用 CMS DotNetNuke，它是一个基于 Web 表单的应用程序，我发现自己需要创建一个不允许将数据传递到服务器的信用卡支付页面。我的第一个虽然是“AJAX”，所以我写了一个 POST 调用，只是发现提供者没有实施跨源策略.... 跨源请求的实施可能需要一段时间让公司实施，所以我想知道还有哪些其他客户端发布选项？

我已经看到 asp.net 按钮上有 postbackURL 选项，但我不确定如何定义要使用的帖子的特定字段，因为我无法将字段包装在表单标签中。

# java - 如何从网站下载整个文件

> ID：14947413
> 
> 赞同：0
> 
> 时间：2013-02-18T23:47:59.117
> 
> 标签：java, io, inputstream

我遵循这个例子：[http ://www.mkyong.com/java/how-to-download-file-from-website-java-jsp](http://www.mkyong.com/java/how-to-download-file-from-website-java-jsp)

```
File file = new File("path/to/file/test.txt");
FileInputStream fis= new FileInputStream(file);
ServletOutputStream out = response.getOutputStream();

byte[] outputByte = new byte[4096];
//copy binary contect to output stream
while(fis.read(outputByte, 0, 4096) != -1)
{
    out.write(outputByte, 0, 4096);
}
fis.close();
out.flush();
out.close(); 
```

问题是下载文件仍然不完整。在文件末尾仍然缺少一些字符

所以我尝试另一个例子：

```
File file = new File("path/to/file/test.txt");
FileInputStream fis= new FileInputStream(file);

IOUtils.copy(fis,response.getOutputStream());
fis.close(); 
```

下载文件完成。所以我的问题是为什么第一个例子不起作用而第二个例子是正确的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T23:58:36.993

返回的值`InputStream.read()`很重要，使用它！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T00:00:10.407

不确定这是否是原因，但你可以更换这个

```
//copy binary contect to output stream
while(fis.read(outputByte, 0, 4096) != -1)
{
    out.write(outputByte, 0, 4096);
} 
```

和

```
int length=-1;
while ( (length = fis.read(outputByte, 0, 4096)) != -1) {
    out.write(outputByte, 0, length);
} 
```

让我们知道进展如何？

# django - Cloud9 ide 和运行 Django 项目的单元测试

> ID：14947416
> 
> 赞同：2
> 
> 时间：2013-02-18T23:48:08.197
> 
> 标签：django, unit-testing, cloud9-ide

谁能告诉我在使用 Cloud9 IDE 时如何在 Python/Django 项目上运行单元测试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T06:57:39.527

目前 Cloud9 支持 Python 2.6.6，因此您将没有可用的单元测试测试框架。

unittest2 是 Python 2.4+ 的后向端口，您可以在 Cloud9 中使用它。[请参阅https://pypi.python.org/pypi/unittest2](https://pypi.python.org/pypi/unittest2)上的文档

只需从终端类型“easy_install unittest2”

确保在编写测试时使用 unittest2 模块

```
import unittest2

class MyTest(unittest2.TestCase):

#tests in here

if __name__ == '__main__':
    unittest2.main() 
```

希望有帮助！

# java - Java中与RS232端口的通信

> ID：14947417
> 
> 赞同：0
> 
> 时间：2013-02-18T23:48:08.263
> 
> 标签：java, io, serial-port, communication, code-assist

我正在尝试使用 Java 解决“与 RS232 通信”端口的一个问题，因为我的 C 技能不是那么好！

**问题：**

我有一个测功机（如果您关心我使用的机器是什么），它通过 RS232 将数据发送到我的电脑。主要思想是，当我向它发送 ASCII 代码“S”时，测功机应该返回我 -

18 个字节如下： 0,1,2,3,4 - 混乱力 F；5,6,7,8,9 - Fmax；10,11,12,13,14 - 确定的速度 dF/dT 和字节 15,16,17 - 状态（每个 0/1 - MaxHold、Nulled、Overload）。所有字节都是标准的 ASCII 字符串。

所以我的问题是我将制作其余的代码，发送'S'的循环，一开始的机器的Null命令......我没有问题将这些信息保存到文件中，例如.txt任何一个。

**我的问题是**我无法理解，并且我找不到可能已经完成且已知的通过此 RS232 发送/接收命令或信息的方法。

据我所见......我将不得不使用不受支持的类 javax.comm，因为......年龄，另一种方法是使用我在谷歌中找不到的 rxtx 库，因为它告诉我他们的网页不知何故……不工作。恐怕这个库不会有任何好的文档，无论我得到与否，我都会失败。

我知道我的问题可能不是那么容易，但这是我期末教育考试的一部分，我真的需要帮助。我会很感激的！

从现在开始非常感谢那些试图帮助我的人！

PS：对不起我的语法不好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T23:54:38.517

[java-simple-serial-connector](http://code.google.com/p/java-simple-serial-connector/)看起来是 RxTx 的合适替代品

# c - 很奇怪... 由于 int 的 NAME 导致的分段错误？

> ID：14947429
> 
> 赞同：0
> 
> 时间：2013-02-18T23:48:59.543
> 
> 标签：c

当我运行这段代码时，我得到一个分段错误，但如果我改变`result`它`blah`运行得很好。我已经尝试了有符号/无符号、sscanf/atoi、初始化/非、int/char 的所有排列，甚至直接使用指针而不是作为参数。

我知道这是 char* 不为空。唯一的变化是变量的名称。

有谁知道这是什么原因？简直太诡异了……

编辑：此文件的范围内没有其他变量。

编辑：它似乎与`return`. 如果我返回使用的值，我会得到一个错误，但控制在崩溃之前永远不会离开函数。

```
unsigned int getHashValue(char* key, char** table, unsigned int tableCount) 
{
    int i = 0;
    //unsigned int length = strnlen(key,1024);
    unsigned int length = 1024;
    printf("Hashing...\n");
    unsigned int blah;
    int result;

    for (i=0;i<tableCount;i+=2) 
    {
        printf("i: %i\n",i);
        if (strncmp(key,table[i],length)==0) 
        {
            printf("found %s\n", table[i+1]);
            /*sscanf()*/
            result = (unsigned int) atoi(table[i+1]);
            //blah = atoi(table[i+1]);
            //sscanf(table[i+1],"%i",&result);
            return result;
        }
    }

    printf("..done\n");

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:30:27.937

`if (strncmp(key,table[i],length)==0)`由于循环继续 while `i < tableCount`，因此可以保证 i 在 table 的范围内，但不能保证这`table[i]`是 strncmp 期望的指向字符串的指针。我建议`if (table[i] != NULL && strncmp(key, table[i], length) == 0) ...`为了解决这种未定义的行为。

当一个程序使用未定义的行为时，它可能会以非常奇怪的方式失败。

不能保证它`i+1`在 指向的数组的范围内`table`。为了解决未定义的行为，请实施适当的边界检查。

此外，似乎不能保证它指向一个字符串。考虑`printf("found %s\n", table[i+1]);`如果`i+1`在 的范围内`table`但`table[i+1]`为 NULL 会发生什么。atoi 也是如此。

# r - 如何在 RcppEigen 中使用 pi？

> ID：14947431
> 
> 赞同：4
> 
> 时间：2013-02-18T23:49:05.617
> 
> 标签：r, rcpp, pi

我对如何在我的代码中用作常量非常陌生`Rcpp`，或者更具体地说，我正在苦苦挣扎。该代码在 MCMC 算法中运行了很多次，因此任何速度改进都是完美的。目前，我每次调用该函数时都会交出 pi，如以下代码所示：`RcppEigen``pi`

```
require(RcppEigen)
require(inline)

I.Cpp <- "
using Eigen::Map;
using Eigen::MatrixXd;
using Eigen::VectorXd;
using Rcpp::NumericVector;

const Map<MatrixXd> delta(as<Map<MatrixXd> >(delta0));
const Map<VectorXd> d(as<Map<VectorXd> >(DD));
const Rcpp::NumericVector tpi(pie);
double pi = tpi[0];

const MatrixXd I = delta.transpose() * d.asDiagonal() * pi * pi;
return wrap(I);
"

I.cpp <- cxxfunction(signature(delta0 = "matrix", DD = "numeric", pie = "numeric"), I.Cpp, plugin = "RcppEigen")

delta0 <- matrix(rnorm(25), 5)
DD <- rnorm(5)

I.cpp(delta0, DD, pi) # this piece of code gets called multiple times? 
```

我的问题：如何在每次调用时使用常量`pi`而不`RcppEigen`传递它`I.cpp`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T23:52:12.107

首先，grep for `pi`in`/usr/share/R/include/`你会发现例如

> ```
>  #define M_PI        3.141592653589793238462643383280    /* pi */ 
> ```

这样你就有了使用 R 的地方，例如这里使用 Rcpp 和 RcppEigen。

例子：

```
R> getpi <- cppFunction('double twopi() { return M_PI; } ')
R> getpi()
[1] 3.142
R> print(getpi(), digits=20)
[1] 3.141592653589793116
R> 
```

我相信这也在数学标题中。[检查：是的，从`math.h`. ] 可能多次。通过其他来源进行搜索也可以取得丰硕的成果。

# mysql - SQL statement to retrieve several Counts

> ID：14947433
> 
> 赞同：0
> 
> 时间：2013-02-18T23:49:18.383
> 
> 标签：mysql, sql, count

```
table account:
    acID (pri, uni, a-i)
    ...

table patient:
    paID (pri, uni, a-i)
    paAccountID (int, foreign key)
    ...

table test:
    tsID (pri, uni, a-i)
    tsAccountID (int, foreign key)
    tsPatientID (int, foreign key)
    tsStatus (int, ranges 0 to 3)
    tsFlag (int, ranges 0 to 1) 
```

Retrieving data from `patient` and number of `tsID` for each patient:

```
SELECT patient.*, Count(tsID) as tsCount   
FROM account 
LEFT JOIN patient ON acID = paAccountID
LEFT JOIN test ON paID = tsPatientID
WHERE paAccountID=1
GROUP BY paID 
```

Now, I would like to retrieve number of `tsFlag=1`, number of `tsStatus=0`, number of 'tsStatus=1' ... number of `tsStatus=3`.

Thanks to Explosion Pill's answer:

```
SELECT patient.*, Count(tsID), SUM(tsStatus=0), 
SUM(tsStatus=1), SUM(tsStatus=2), SUM(tsStatus=3), SUM(tsFlag=1)
FROM account 
LEFT JOIN patient ON acID = paAccountID
LEFT JOIN test ON paID = tsPatientID
WHERE paAccountID=1
GROUP BY paID 
```

Is working like a charm, BUT giving `NULL` for the `SUM` if the `Count=0` - how can I get `0` instead?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T23:53:38.000

You can get the count of X = Y by using a `SUM`:

```
SELECT patient.*, SUM(tsStatus = 1) AS tsStatus1
FROM ... 
```

You can do this for the other columns as well.

You can use `IFNULL` or `COALESCE` to specify a default non-null value:

```
IFNULL(SUM(tsStatus = 3), 0); 
```

# enunciate - 发音 JSON Doc 示例不显示根元素

> ID：14947435
> 
> 赞同：1
> 
> 时间：2013-02-18T23:49:31.647
> 
> 标签：enunciate

我正在使用发音 1.26.2。在 XML/JSON 示例中，XML 代码示例是正确的，但 JSON 示例缺少根 (SerialPorts)

XML:

```
<SerialPorts> 
    <serialport> 
     <ns1:portId xmlns:ns1="serialPorts">1</ns1:portId> 
     <ns1:portname xmlns:ns1="serialPorts">/dev/tty/foo - Serial</ns1:portname> 
     <ns1:status xmlns:ns1="serialPorts">Port is Active</ns1:status>
    </serialport> 
    <serialport> 
    <!--...-->
    </serialport>
     <!--...more "serialport" elements...--> 
</SerialPorts> 
```

JSON：

```
{ "serialport" : [ 
{ "portId" : "1", "portname" : "/dev/tty/foo - Serial", "status" : "Port is Active " }, 
... ] } 
```

JSON 和 XML 的真实 Rest 调用（使用 CXF）的输出是正确的。我想我缺少正确的文档输出的清晰 JSON 注释/配置？

# jquery - 分页后，简单的 javascript 函数似乎在 jQuery Datatables 上中断

> ID：14947443
> 
> 赞同：0
> 
> 时间：2013-02-18T23:50:33.730
> 
> 标签：jquery, jquery-datatables

我有一个有趣的问题，我希望有一个简单的解决方案。我正在使用 jQuery Datatables 插件（datatables.net），并且我将分页设置为全数。在我的行中，我有一个删除按钮，单击该按钮会执行 jQuery 函数。该函数只是调用外部源来处理数据库中的删除，并使用 .remove() 从 UI 中删除行。

在我使用分页之前，这完美无缺。如果我有超过 10 条记录，然后单击到下一页，它将不再有效。这是一些代码：

```
jQuery('.deleterecord').click(function(){
    var conf = confirm('Continue delete?');
        if(conf)
            jQuery(this).parents('tr').fadeOut(function(){
            jQuery(this).remove();
            jQuery.jGrowl("Record has been removed!");
        });

    return false;
 }); 
```

所以我在行中有一个链接：

```
<a class="deleterecord">Delete</a> 
```

这调用了 click 函数。因此，如果我通过表格上的分页单击到下一页，我可以让此功能再次工作的唯一方法是如果我刷新页面并启用 cookie 以记住该页面。

我希望有什么想法？？？:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:39:26.583

Datatables 具有用于删除行的内置函数[fnDeleteRow (documentation-link)](http://datatables.net/ref#fnDeleteRow)。这将处理分页的正确状态，更重要的是，插件本身的实际数据。

我[在 jsBin 上创建了一个小例子](http://jsbin.com/aliqar/1/edit)来展示给你看。

我使用了其中一个示例中的标记，因此它可能看起来有点乱。

所以基本上，您在一行上绑定一个点击处理程序并将事件委托给一个 td，您可以对您的按钮执行相同的操作，只需`.center`将处理程序中的更改为`.deleterecord`并阻止默认事件。

唯一的区别是`this`调用`fnGetPosition`以获取行的实际 id 时使用的 -variable，这是 deleteRow-Function 所需的。您可能需要使用类似的东西`$(this).parent()[0]`来传递`td`- 元素而不是您的按钮。

为了完整起见，这是处理程序的代码和数据表插件的初始化调用：

```
 $('#example tbody tr').on('click', '.center', function () {
    var aPos = oTable.fnGetPosition(this);
    oTable.fnDeleteRow(aPos[0]);
  });

  // Init DataTables
  oTable = $('#example').dataTable({
    "sPaginationType": "full_numbers"
  }); 
```

在处理程序内部，如果服务器返回肯定结果，您需要启动 ajax - 调用数据库以删除正确的行并在回调中执行此代码片段。

# java - Graphics.drawImage() 方法中的尾随图像

> ID：14947444
> 
> 赞同：0
> 
> 时间：2013-02-18T23:50:33.200
> 
> 标签：java, graphics, java-3d

我有一个需要通过调用移动的图像：

```
int Y = 100;
Graphics g = Canvas().getGraphics(); //Canvas is a Java 3D Canvas 3D
g.drawImage(Image, 400, Y, Canvas); 
```

我还有一个移动图像的 keylistener，但是每当图像移动时，它都会留下一连串图像。有没有什么办法解决这一问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T23:52:00.240

您的问题中遗漏了许多重要信息，迫使我们猜测，这不是一件好事。我的猜测：如果你是在`paint(...)`or`paintComponent(...)`方法中绘制这个，那么你必须首先调用 super 方法。

# jquery - 判断所有单选按钮组是否有一个复选框

> ID：14947446
> 
> 赞同：1
> 
> 时间：2013-02-18T23:50:36.943
> 
> 标签：jquery, radio-button, validation

我正在做一个测验，每个问题都有一组单选按钮，如下所示：

```
<input type="radio" name="quid16" value="answid53" />Answer 1 : foo
<input type="radio" name="quid16" value="answid54" />Answer 2 : bar
<input type="radio" name="quid16" value="answid55" />Answer 3 : joe
<input type="radio" name="quid16" value="answid56" />Answer 4 : blogs 
```

每个组都有一个 id，`quid16`如上；这个 id 是由 PHP 生成的，不是固定的。

当我验证表单提交时，我需要检查所有组是否都有一个选中的单选按钮。

问题是我事先不知道组 ID。我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-18T23:56:10.057

您可以使用所有单选框，以“quid”开头，然后：

1.  过滤唯一名称
2.  过滤检查的值
3.  比较 1\. 与 2。

代码：

```
var radios = $('[name^=quid]'),
names = $.unique(radios.map(function() {
    return this.name;
})),
checked = radios.filter(function() {
    return this.checked;
});

if (names.length == checked.length) {
    alert('all answers are checked');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:09:40.087

使用[Attribute Starts With Selector](http://api.jquery.com/attribute-starts-with-selector/)获取前缀为 'quid' 的元素，使用[jQuery.is](http://api.jquery.com/is/)来选择`:checked`. 例如：

```
$('[name^=quid]').is(':checked'); //Returns true if any radio buttons are 'checked' 
```

这是一个示例 JSFiddle：http: [//jsfiddle.net/SDXSf/](http://jsfiddle.net/SDXSf/)

```
<input type="radio" name="quid16" value="answid53" />Answer 1 : foo <br/>
<input type="radio" name="quid16" value="answid54" />Answer 2 : bar <br/>
<input type="radio" name="quid16" value="answid55" />Answer 3 : joe <br/>
<input type="radio" name="quid16" value="answid56" />Answer 4 : blogs <br/>
<br/>
<button>Test</button>
<script type="javascript">
    $(function(){

    function isOneChecked(selector)
    {
       return $(selector).is(':checked')
    }

    $('button').click(function(){
        alert(isOneChecked('[name^=quid]') ? 'Validated' : 'Please select a radio    button');
    });
});
</script> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-19T00:03:17.287

```
if ($('input:radio').is(':checked')) {function()} else {function()} 
```

# javascript - 如何在 jwplayer 中设置 flash 模式下的全屏选项？

> ID：14947447
> 
> 赞同：1
> 
> 时间：2013-02-18T23:50:51.130
> 
> 标签：javascript, jquery, jwplayer

正如我所说，我有一个简单的 jwplayer 视频

```
var video1 = jwplayer('vid1').setup(
    'flashplayer': 'js/jwplayer/jwplayer.flash.swf',
    'id': 'playerVid1',
    'width': VIDPLAYER_CTRL.BIGVIDEO_WIDTH,
    'height': VIDPLAYER_CTRL.BIGVIDEO_HEIGHT,
    'controlbar': 'over',
    'file': VIDPLAYER_MODEL.MAIN_VIDEO['path'],
    'provider': 'http',
    'startparam': 'start'
}).setVolume(VIDPLAYER_CTRL.BIGVIDEO_VOLUME); 
```

我需要用一个链接把它放在全屏模式`<a id="aFullVideo1" href="#">Set fullscreen</a>` 这个链接与这个代码相关联

```
$('#aFullVideo1').on("click", function(){
     jwplayer('vid1').setFullscreen(true);
     return false;
}); 
```

我知道这个论点已经被多次面对。我知道在**闪存**模式下，出于安全原因，不允许使用此命令。我检查了一些插件，比如[这个](http://tutorialzine.com/2012/02/enhance-your-website-fullscreen-api/)。我几乎在所有不可能的地方阅读。

但是 swf 对象和 javascript 应该能够通信，所以我问自己，真的是不可能，还是我失去了一些东西并且有解决方案？谢谢大家！

# html - 寻找像这个 wordpress 一样的三面板 css 布局

> ID：14947450
> 
> 赞同：-1
> 
> 时间：2013-02-18T23:50:57.067
> 
> 标签：html, css, wordpress, templates, background-image

我喜欢 Wordpress 上的 Day Dream 主题。[http://theme.wordpress.com/themes/daydream/](http://theme.wordpress.com/themes/daydream/)。我无法使我的一栏页面具有沿左右边缘垂直运行的线条设计。我正在尝试将背景图像居中。这是正确的方法吗？如果有人免费看到这样的模板，我也会接受。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T23:57:46.407

我会推荐 blueprint CSS 框架，它在处理这样的布局时非常有用。

[http://www.blueprintcss.org/](http://www.blueprintcss.org/)

如果你在哪里使用它，你所需要的就是这样的东西。

```
<div class="container">
 <div class="span-8"></div>
 <div class="span-8"></div>
 <div class="span-8"></div>
</div> 
```

在这些列中的每一列中，您都可以添加任何您喜欢的内容，但这不是一个流畅的设计。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:54:54.047

我不会用勺子喂这个答案。[使用Firebug](https://getfirebug.com/) for firefox 或使用 Chrome 中的[元素面板](https://developers.google.com/chrome-developer-tools/docs/elements)5 分钟应该可以让您在页面中拥有足够的内部空间来创建您自己的版本。这个模板的 HTML 和 CSS 都非常简单。

Firebug 的一些起点：

*   [https://getfirebug.com/html](https://getfirebug.com/html)
*   [https://getfirebug.com/css](https://getfirebug.com/css)

# opengl - 是否可以在操作之间设置 GLSL 变量？

> ID：14947459
> 
> 赞同：1
> 
> 时间：2013-02-18T23:51:39.820
> 
> 标签：opengl, glsl

我的目标是以下情况：

```
bind shader
set uniform variable
..draw box..
set uniform variable to different value
..draw another box, with the new variable applied in the vertex shader.. 
```

是否可以在操作之间设置 GLSL 变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T09:54:14.757

是的，您可以在编译后自由设置制服，并将设置与绘图调用混合。

# csv - 将 csv 数据写入命名空间内的矩阵时，TCL 抛出无效的命令名称

> ID：14947460
> 
> 赞同：2
> 
> 时间：2013-02-18T23:51:41.717
> 
> 标签：csv, tcl

这是一个奇怪的问题，我似乎无法弄清楚。我正在使用 TCL 8.5，我正在尝试使用`csv::read2matrix`命令将 CSV 文件中的数据读取到矩阵中。但是，每次我这样做时，它都会说我要写入的矩阵是无效命令。我在做什么的片段：

```
package require csv
package require struct::matrix

namespace eval ::iostandards {
    namespace export *
}

proc iostandards::parse_stds { io_csv } {
    # Create matrix
    puts "Creating matrix..."
    struct::matrix iostdm

    # Add columns
    puts "Adding columns to matrix..."
    iostdm add columns 6

    # Open File
    set fid [open $io_csv r]
    puts $fid

    # Read CSV to matrix
    puts "Reading data into matrix..."
    csv::read2matrix $fid iostdm {,}

    close $fid
} 
```

当我在 TCLSH 中运行此代码时，我收到此错误：

```
invalid command name "iostdm" 
```

据我所知，我的代码是正确的（当我没有将它放在命名空间中时。我尝试了`namespace import ::csv::* ::struct::matrix::*`它并没有做任何事情。

这些包裹有什么我缺少的吗？wiki.tcl.tk 网站上没有任何内容提及此类内容，并且所有软件包的 man 包都没有提及在另一个名称空间中调用的任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T08:20:20.570

问题是**iostdm**是在**iostandards**命名空间内定义的。这意味着，它应该被引用为**iostandards::iostdm**，这就是你应该如何传递给`csv::read2matrix`：

```
 csv::read2matrix $fid iostandards::iostdm {,} 
```

### 更新

我注意到您在阅读之前对矩阵添加 6 列进行了硬编码。更好的方法是告诉`csv::read2matrix`自动扩展矩阵：

```
 csv::read2matrix $fid iostandards::iostdm , auto 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-10T15:42:32.830

我想添加到 Hai Vu 的答案

根据我的测试，对于诸如 csv::read2matrix 和 csv::write2matrix 之类的命令，如果您有嵌套的命名空间，看来您必须转到最高的命名空间。

我有一个结构是......

```
csv::read2matrix $fid ::highest::higher::high::medium::low::iostdm , auto 
```

# performance - LinkedList 与 HashMap 的摊销性能

> ID：14947467
> 
> 赞同：1
> 
> 时间：2013-02-18T23:52:01.567
> 
> 标签：performance, algorithm, data-structures, computer-science

对于大多数操作，哈希表的摊销性能通常被认为是 O(1)。

在标准 LinkedList 实现上的搜索操作的摊销性能是多少？是 O(n) 吗？

我对如何计算它有点困惑，因为在最坏的情况下（假设说一个总是冲突的哈希函数），就搜索操作而言，哈希表几乎等同于 LinkedList（假设一个标准桶实现）。

我知道在实践中这永远不会发生，除非散列函数被破坏，因此平均性能在一系列操作中几乎是恒定的时间，因为冲突很少见。但是在计算摊销的最坏情况性能时，我们不应该考虑最坏情况下的最坏情况序列吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T23:53:50.093

没有“摊销的最坏情况表现”这样的东西。摊销性能是长序列操作的一种“平均”性能。

使用哈希表，有时需要在长序列插入后调整哈希表的大小，这将花费 O(n) 时间。但是，由于它只发生在每个 O(n) 插入，因此该操作的成本分散在所有插入上以获得 O(1) 摊销时间。

是的，在散列函数损坏的最坏情况下，对于每个操作，散列表可能是 O(n)。但是，分析这样的哈希表是没有意义的，因为它不是典型的使用情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T00:29:04.163

“最坏情况”有时取决于“在什么约束下的最坏情况”。

具有有效但愚蠢的哈希函数将所有键映射到 0 的哈希表的情况通常不是有意义的“最坏情况”，它不够有趣。因此，您可以在最小假设下分析哈希表的平均性能，即（出于实际目的）哈希函数将所有键的集合均匀地分布在所有哈希值的集合中。

如果散列函数相当合理但在密码学上不安全，则需要考虑单独的“最坏情况”。恶意或不知情的用户可以系统地提供哈希冲突的数据。对于“最坏情况输入”与“假设输入具有良好分布的散列”的最坏情况，您会得出不同的答案。

在对哈希表的给定插入序列中，其中一个可能会引发重新哈希。然后，您会认为那是该特定情况下的“最坏情况”。这与整体输入数据几乎没有关系——如果负载因子变得足够高，您*最终*会重新散列，但*很少*。这就是为什么“摊销”运行时间是一个有趣的衡量标准，只要您可以对总`n`运营成本设置更严格的上限，而不是仅`n`乘以一次操作的最严格上限。

即使散列函数在密码学上是安全的，您获得散列全部冲突的输入的可能性也可以忽略不计。这就是“对所有可能的输入进行平均”和“对具有最坏情况输入的一系列操作进行平均”之间存在差异的地方。所以“摊销”这个词也带有小字。根据我的经验，这通常意味着一系列操作的平均值，数据是好还是坏的问题*不是*摊销的一部分。nneonneo 说“没有摊销的最坏情况性能”，但根据我的经验，肯定存在最坏情况的摊销性能。所以准确地说，

当哈希表提出`O(1)`分期插入时，它们意味着`n`插入需要`O(n)`时间，要么（a）假设散列函数没有发生任何病理性不良事件，要么（b）`n`假设随机输入的预期插入时间。因为无论哪种方式，您都对哈希表得到相同的答案，所以很容易懒得说您在谈论哪个。

# json - 通过 CKAN 的 API (1.8) 上传文件：怎么做？

> ID：14947468
> 
> 赞同：1
> 
> 时间：2013-02-18T23:52:10.383
> 
> 标签：json, bash, file-upload, curl, ckan

我正在尝试在我的 CKAN 实例中自动上传数据集和资源。我使用的是 Ubuntu Linux 10.04 64 位，我的 CKAN 实例版本是 1.8。

我可以使用如下命令创建一个新数据集：

```
$ curl http://ckan.installation.com/api/rest/dataset -H "Authorization:<my api key>" -d '{"name": "dataset-name", "title": "The Name of the Dataset"}'
{... JSON text recieved in response, including the id of the dataset ...} 
```

现在，如何使用命令行在我的 CKAN 实例中创建和上传资源（如图像文件）？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T19:09:58.133

通过 FileStore API 上传文件有些复杂。你会更好地重用[ckanclient 的 upload_file 方法](https://github.com/okfn/ckanclient/blob/master/ckanclient/__init__.py#L546-L583)。使用它的简单 Python 脚本可以解决您从命令行上传的问题。

或者，如果您有勇气，那是开始了解如何使用 cURL 上传文件的最佳起点。

# android - 在应用程序中执行 HTTP 请求

> ID：14947470
> 
> 赞同：0
> 
> 时间：2013-02-18T23:52:11.093
> 
> 标签：android, html, hyperlink, arduino

我想知道我是否可以打开它但不打开android浏览器，我只需要它访问：（假装这是ip）http;//91.91.91.91:2228?1，它会在我的arduino上触发动作兆。我试图让它只是用这段代码来做到这一点

```
onclick(Intent websiteIntent = new Intent(Intent.ACTION_VIEW);
    Uri uri = Uri.parse("http;//91.9.91.91:?1");
    websiteIntent.setData(uri);
    startActivity(websiteIntent);) 
```

但我不知道如何让它这样做

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T23:57:25.787

HttpClient 将允许您在应用程序中调用任意 URL：

```
DefaultHttpClient client = new DefaultHttpClient();
HttpGet request = new HttpGet("http;//91.9.91.91:?1");
HttpResponse response = client.execute(request); 
```

不过不要忘记包裹在 try catch 中。

编辑：

```
new Thread(){
    public void run(){
        try{
            DefaultHttpClient client = new DefaultHttpClient();
            HttpGet request = new HttpGet("http;//91.9.91.91:?1");
            HttpResponse response = client.execute(request);
        }catch(Exception e){
            // Handle the exception
            e.printStackTrace();
        }
    }
}; 
```

# c - 运行时错误指针的行为

> ID：14947472
> 
> 赞同：2
> 
> 时间：2013-02-18T23:52:36.703
> 
> 标签：c, pointers

我一直在用指针进行一些测试，并遇到了以下两种情况。谁能向我解释发生了什么？

```
void t ();
void wrong_t ();

void t () {
        int i;
        for (i=0;i<1;i++) {
                int *p;
                int a = 54;
                p = &a;
                printf("%d\n", *p);
        }
}

void wrong_t() {
        int i;
        for (i=0;i<1;i++) {
                int *p;
                *p = 54;
                printf("%d\n", *p);
        }
} 
```

考虑以下两个版本的 main：

```
int main () {
        t();
        wrong_t();
} 
```

打印：54\n54\n，如预期的那样

```
int main () {
        wrong_t();
} 
```

产量：分段错误：11

我认为问题出在“wrong_t()”中的“int *p”是一个“坏指针”，因为它没有正确初始化（cfr.：cslibrary.stanford.edu/102/PointersAndMemory.pdf，第 8 页）。但是我不明白为什么在某些情况下会出现这样的问题（例如：如果我在 wrong_t() 之前调用 t() 或者如果我删除了 wrong_t() 中代码周围的 for 循环，则不会发生这种问题）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T23:56:03.917

因为取消引用未初始化的指针（正如您正确猜测的那样）会调用**未定义的行为**。什么事情都可能发生。

如果您想了解您正在观察的精确行为，那么唯一的方法是查看编译器生成的汇编代码。但这通常不是很有成效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T00:02:44.313

What happens is almost certainly:

In both `t` and `wrong_t`, the definition `int *p` allocates space for `p` on the stack. When you call only `wrong_t`, this space contains data left over from previous activity (e.g., from the code that sets up the environment before `main` is called). It happens to be some value that is not valid as a pointer, so using it to access memory causes a segment fault.

When you call `t`, `t` initializes this space for `p` to contain a pointer to `a`. When you call `wrong_t` after this, `wrong_t` fails to initialize the space for `p`, but it already contains the pointer to `a` from when `t` executed, so using it to access memory results in accessing `a`.

This is obviously not behavior you may rely on. You may find that compiling with optimization turned on (e.g., `-O3` with GCC) alters the behavior.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T23:57:47.623

在`wrong_t`功能上，这种说法`*p = 54;`很有趣。您正在尝试将值存储到`p`尚未为其分配内存的指针中，因此出现错误。

# service - AngularJS ng-repeat 与来自服务的数据

> ID：14947478
> 
> 赞同：6
> 
> 时间：2013-02-18T23:53:05.090
> 
> 标签：service, angularjs, apply, resolve, ng-repeat

最初在我的应用程序中，我使用非常基本的 $http 调用创建了控制器，以通过从 url ($routeParams) 获取对象的 ID 来获取资源。Ng-repeat 正确显示结果。

但是，我注意到在稍后的视图中刷新（不同的控制器）会清除数据并破坏页面。因此，我在服务上创建了一个函数，以便在多个控制器中使用，以检查数据是否可用并做出如下反应：

1）如果资源已定义，则返回（无API调用） 2）如果资源未定义，则从url获取id并从API中获取 3）如果资源未定义&您无法获取ID，只返回false。

但是，这破坏了代码：在服务返回数据之前渲染的模板，并且 ng-repeat 没有更新。代码如下所示：

```
angular.module('myApp', ['ngCookies'])
    .config(...)
    .service('myService', ['$cookies', '$http', function($cookies, $http) {
        myData = {};

        return {
            getData:function(dataID) {
                if(myData.name) {return myData);
                else if (dataID && dataID !== '') {
                    $http.get('/api/data/' + dataID)
                        .success(function(data) {
                            myData = data.object;
                            $cookies.dataID = data.object.id;
                            return myData;
                        }
                }
                else { return false; }
            }
        }
    }]);

function myCtrl($scope, $http, $routeParams, myService) {
    $scope.data = myService.getData($routeParams.dataID);

    ...
} 
```

这是模板。它在jade中，这意味着您只需在括号中列出带有参数的元素，而不是尖括号，然后在括号后列出内容。

```
h2 My heading
ul
    li(ng-repeat='option in data')
        a(href="#", ng-click='someFuncInCtrl(option.name)')  {{ option.name }} 
```

当控制器自己执行 $http.get 时，ng-repeat 工作正常，因为 $scope 已在“.success”回调中更新。现在有一个服务在稍微延迟后返回数据，“$scope.data”只是未定义，ng-repeat 列表是空的。

我在返回“return myData”之前使用console.log检查了myData，并且myData正在工作，只是没有及时返回，并且无论出于何种原因，只要$scope确实获取了数据，列表就不会更新。

我查看了使用 $routeProvider 的解析...但这使得从 url 获取 ID 具有挑战性，因为解析对象似乎无法访问 $routeParams。我知道 $scope.$apply 应该在被外部函数更改时帮助更新范围......但我不知道把它放在哪里。SO上最[类似的问题](https://stackoverflow.com/questions/13163227/angularjs-ngrepeat-not-updating-display-properly)没有使用服务。

我试过：

```
$scope.$apply($scope.data = myService.getData($routeParams.dataID)); 
```

和

```
$scope.$apply(function() {
    $scope.data = myService($routeParams.dataID);
}); 
```

两次我都只得到错误：$digest 已经在进行中。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-19T00:25:53.913

问题在于您与服务交互的方式。由于您的`getData`函数可以返回**同步和/或异步**信息，因此您不能只使用普通`return`（s）。

```
$http.get('/api/data/' + dataID)
    .success(function(data) {
        myData = data.object;
        $cookies.dataID = data.object.id;
        return myData;
    }); 
```

上面的`return`代码片段不会返回任何内容，`getData`因为它将在`$http.get`成功回调的上下文中执行（而不是在`getData`调用堆栈上）。

处理同步和异步服务请求的最佳方法是使用[promises](http://docs.angularjs.org/api/ng.$q)。

您的`getData`函数应如下所示：

```
getData:function(dataID) {
    var deferred = $q.defer();
    if(myData.name) {
       deferred.resolve(myData);
    } else if (dataID && dataID !== '') {
        $http.get('/api/data/' + dataID)
            .success(function(data) {
                 myData = data.object;
                 $cookies.dataID = data.object.id;
                 deferred.resolve(myData);
                 // update angular's scopes
                 $rootScope.$$phase || $rootScope.$apply();
             });
    } else { 
       deferred.reject();
    }

    return deferred.promise;
} 
```

注意：您需要`$rootScope`在您的服务上注入。

在你的控制器上：

```
function myCtrl($scope, $http, $routeParams, myService) {
    myService.getData($routeParams.dataID).then(function(data) {
        // request was successful
        $scope.data = data;        
    }, function() {
        // request failed (same as your 'return false')
        $scope.data = undefined;
    });
} 
```

# javascript - 如何在轮播 Bootstrap.js 中为子元素设置动画

> ID：14947481
> 
> 赞同：0
> 
> 时间：2013-02-18T23:53:10.067
> 
> 标签：javascript, twitter-bootstrap, callback, carousel

使用 twitter bootstrap.js 中的回调“slid”，我试图在从幻灯片转换到幻灯片后单独为片段设置动画：

```
<div class="carousel">
    <div class="item active">
        <img src="animatefirst.png">
        <h1> second </h1>
        <p> third <p>
    </div>

    <div class="item">
        <img src="animatefirst.png">
        <h1> second </h1>
        <p> third <p>
    </div>

    <div class="item">
        <img src="animatefirst.png">
        <h1> second </h1>
        <p> third <p>
    </div>

</div> 
```

如您所见，我想按顺序制作以下动画：

1.  图像
2.  h1
3.  p

我该怎么做？

到目前为止，这就是我所能做的：

```
$('#carousel2').bind('slid', function(){
    $('img').fadeIn();
}); 
```

但是上面的问题是它在第一张幻灯片上一次淡入所有图像，被“滑入”。有没有办法让我在 div 中定位图像并将它们一个一个淡入淡出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:18:20.393

对于那里的任何人，我找到了解决方案：

Bootstrap 将一个名为“active”的类附加到轮播中的当前项目。

我只是使用了一个后代选择器来定位我需要动画的所有子元素，瞧，动画！

# javascript - 动态修改 HighChart 布局选项

> ID：14947484
> 
> 赞同：1
> 
> 时间：2013-02-18T23:53:49.057
> 
> 标签：javascript, highcharts

我找不到更新已创建图表的 marginTop 值的方法。

看看我的例子：

[http://jsfiddle.net/TZaEV/4/](http://jsfiddle.net/TZaEV/4/)

```
var btn = $('#btn');
btn.click(function(){
// do changes
}); 
```

我需要更改 chart.marginTop 值而不再次创建图表对象。（例如，当我单击触发按钮时）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:39:43.130

```
var btn = $('#btn');
btn.click(function(){
    chart.optionsMarginTop += 20;
    chart.isDirtyBox = true; // this makes your chart redraw
    chart.redraw();
}); 
```

[**演示**](http://jsfiddle.net/TZaEV/7/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-26T12:26:38.797

使用 Chart.update() 函数怎么样？

```
chart.update({
  chart: {
    marginTop: 30
  }
}); 
```

API 参考：[http :](http://api.highcharts.com/highcharts/chart.marginTop)
[//api.highcharts.com/highcharts/Chart.update http://api.highcharts.com/highcharts/chart.marginTop](http://api.highcharts.com/highcharts/Chart.update)

示例：http:
[//jsfiddle.net/neo0xb2w/](http://jsfiddle.net/neo0xb2w/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-26T11:16:41.000

这个对我有用：

```
const chart = $("#container").highcharts();
chart.options.chart.marginTop = 100;
chart.isDirtyBox = true;
chart.redraw(); 
```

# grails - Grails 无法识别 Java 类

> ID：14947488
> 
> 赞同：2
> 
> 时间：2013-02-18T23:53:54.170
> 
> 标签：grails

我在 Windows 7（32 位）上使用 Groovy/Grails Tool Suite 3.1.0。我一辈子都无法让 Grails 识别我在 Grails 应用程序的 /src/java 目录中创建的简单 Java 类。

这是我的java类：

```
public class PleaseWork {

    public static void hello()
    {
        System.out.println("Hello from a java class.");
    }
} 
```

我正在从我创建的服务中调用 java 类：

```
package mypackage
class CreatePdfService {

    def serviceMethod() {

        PleaseWork.hello()
    }
} 
```

我检查了我的项目的 .classpath，我看到以下内容：

```
<classpath>
<classpathentry kind="src" path="src/java"/>
<classpathentry kind="src" path="src/groovy"/>
<classpathentry kind="src" path="grails-app/conf"/>.... 
```

看起来我的 java 源目录已包含在内，并且没有排除它的设置。一切看起来都很好。

我的理解是我应该能够毫无问题地调用那个java类。我可以毫无问题地做一个 grails run-app。但是......当我运行我的应用程序并且代码尝试调用 PleaseWork.hello() 我得到以下信息：

```
| Error 2013-02-18 15:59:10,898 [http-bio-8080-exec-4] ERROR errors.GrailsExceptionResolver  -   
MissingPropertyException occurred when processing request: [POST] /mypackage/main/createPdf
No such property: PleaseWork for class: mypackage.CreatePdfService. Stacktrace follows:
Message: No such property: PleaseWork for class: mypackage.CreatePdfService 
```

我已经完成了 grails 刷新依赖项，但没有任何效果。是什么赋予了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T02:43:30.493

您不能从包中的类访问“默认”包中的类。要么将类移动到与服务相同的包中，要么将其放在不同的包中并添加导入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T15:49:06.890

啊...谢谢伯特。我做了以下......

我在该 /src/java 文件夹中创建了一个包。我称这个包为“this.works”

这是我更新的 Java 类：

```
package this.works;

public class PleaseWork 
{

    public static void hello()
    {
       System.out.println("Hello from a java class.");
    }
} 
```

这是我更新的调用 Java 类的 Groovy 类：

```
package myPackage

import this.works.PleaseWork

class CreatePdfService {

   def serviceMethod() {
         PleaseWork.hello()
   }
} 
```

这现在有效。我可以做一个 grails run-app 并调用我的 Java 类中的方法。

# iphone - 在 iPhone 上再次点击外部时是否可以隐藏 :hover 元素（纯 CSS）？

> ID：14947492
> 
> 赞同：5
> 
> 时间：2013-02-18T23:54:21.733
> 
> 标签：iphone, css, hover

我在 :hover 元素上使用双击（在 iPhone 上）来显示额外信息，没有 javascript，只是简单的 css :hover 伪类。现在我的问题是，出现在 :hover 上的 div 不再消失，只有当我点击另一个 :hover 元素时。iOS 中的 :hover 功能是否发生了变化？

```
li.to-be-hovered {
  position:relative;
}
li.to-be-hovered div.hidden {
  display:none;
}
li.to-be-hovered:hover div.hidden {
  display:block;
  position:absolute;
} 
```

还有一些像宽度、顶部、左侧、边距、背景、z-index 等等......

```
<div>
  <ul>
    <li class="to-be-hovered">
      <div class="hidden">
        lots of extra information with image, span, link elements
      </div>
    </li>
  </ul>
</div> 
```

在我的 iPhone (4S) 上，div.hidden 出现在 div.to-be-hovered 的第一个选项卡上，但在点击元素外的其他位置时不再消失。有人知道这个效果吗？是否可以使用纯 CSS 使其再次消失，或者我必须对所有这些元素使用 Javascript？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-03T06:44:12.557

简单，不需要javascript。这是修复

将此添加到您的 CSS 媒体查询

> 正文 {光标：指针}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-02T01:26:19.563

JS：

```
var hidestuff = function() {
    // Hide lots of extra information with image, span, link elements
    // $(elm).hide();
}

$('html').touch(hidestuff).click(hidestuff); 
```

CSS：

```
.hidestuff { position: absolute; z-index:1} 
```

因此，如果用户触摸除了需要点击的元素之外的任何地方，“隐藏的东西”将被隐藏

希望这可以帮助 ：/

# php - soundcloud api 中使用的流派的完整列表

> ID：14947494
> 
> 赞同：1
> 
> 时间：2013-02-18T23:54:41.500
> 
> 标签：php, api, soundcloud

任何人都可以通过提供与 soundcloud api 一起使用的所有“流派”的列表来帮助我吗？

我假设通过访问 soundcloud.com/tags/$genre 您可以获得正确的流派以在 api 中使用，但结果不匹配。

因此，如果有人对此有任何信息，将非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T12:52:56.300

我认为 soundcloud 上没有“流派列表”之类的东西，因为每个作者都可以为流派添加任何他想要的东西。

如果你按标签去，也许这是一个更好的主意。在 next.soundcloud 上查看此链接：[https ://soundcloud.com/explore/tags](https://soundcloud.com/explore/tags)

还有这个经典 soundcloud 上的[http://soundcloud.com/tags](http://soundcloud.com/tags)（这个现在不工作，但在过去，有一个列表最近/使用的标签。

*   更新：右边是一些流行的标签：[http ://soundcloud.com/tracks](http://soundcloud.com/tracks)

# sql - SQL：级联“插入”并在更新时插入（如果不存在）

> ID：14947497
> 
> 赞同：4
> 
> 时间：2013-02-18T23:54:48.247
> 
> 标签：sql, sql-server, tsql

实现这一目标的最佳方法是什么？

表 A 和表 B 通过表 B 上的 FK 具有“主从”关系。密钥设置用于级联删除和更新。

表 B 是新的，因此没有 A 那么多的记录。

插入表 A 时，我希望表 B 有一个新记录，其中表 A 的 ID 字段已完成，其他所有内容都为空白，以供用户输入。

随着表 A 的更新，我希望表 B 有一个新记录，其中表 A 的 ID 字段已完成，如果表 B 中尚不存在表 A 的 ID，则其他所有内容都为空白以供用户输入。

触发器，我猜？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T00:23:02.930

我认为您需要在表 A 上使用插入触发器。

每当您插入A时，请检查该ID是否存在于B中，如果不存在，则插入B中。

# c - C 语言 K&R 练习 1-8

> ID：14947501
> 
> 赞同：0
> 
> 时间：2013-02-18T23:55:28.853
> 
> 标签：c

我现在坐在 K&R The C programming Language 上。我在 1 个练习 1-8 上有筹码。
锻炼它自己。

**编写一个程序，将每个制表符替换为三个字符序列 >、退格、-，巫婆打印为 →，每个退格替换为类似的 ←。这使制表符和退格键可见。**

据我了解，该练习要求我在制表符和退格键中制作指向箭头。但我不知道如何在 C 中将 2 个字符剪辑在一起
这是它自己的程序

```
#include <stdio.h>
main ()  
{  

int c;

while ((c=getchar()) !=EOF)
{
    if (c == '\t')
        printf(">->->\b");
    if (c == '\b')
        printf("<-<-<-\b");
     if (c !='\t')
         if (c !='\b')
              putchar(c);

}   

  getchar();
} 
```

那么我的错误在哪里，你能在这里帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T00:01:11.573

所需的顺序是

```
>\b- 
```

请注意，这可能不适用于现代终端仿真器，因为大多数不支持叠印字符。最初的想法是模仿旧的打字机技术，打印一个字符，让一个字符支持头部，然后在前一个字符的顶部敲击另一个字符。

如果您的终端支持 UTF-8，您可以替换 '→' Unicode 字形（U+2192 RIGHTWARDS ARROW），它以 UTF-8 编码为

```
\xe2\x86\x92 
```

类似地，'←' (U+2190) 是

```
\xe2\x86\x90 
```

# php - 在 Heroku 上使用 MySQL 和 PHP

> ID：14947506
> 
> 赞同：2
> 
> 时间：2013-02-18T23:55:56.113
> 
> 标签：php, heroku

如何将我的 MySQL 数据库上传到 Heroku 以与 PHP 应用程序一起使用？我在 Heroku 上找到的唯一文档是：

**将 ClearDB 与 PHP 一起使用**

从 PHP 连接到 ClearDB 非常简单，只需要解析 CLEARDB_DATABASE_URL 即可连接，如下所示：

```
<?php
  $url=parse_url(getenv("CLEARDB_DATABASE_URL"));

  $server = $url["host"];
  $username = $url["user"];
  $password = $url["pass"];
  $db = substr($url["path"],1);

  mysql_connect($server, $username, $password);

  mysql_select_db($db);
?> 
```

我不明白如何在没有 SSH 连接的情况下用我的数据填充 ClearDB，或者如何创建数据库或如何连接到它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T15:40:53.327

来自 [ClearDB 的开发人员中心常见问题解答：](http://www.cleardb.com/developers/help/faq)

> 要将数据导入 MySQL 数据库，我们建议您同时使用 mysql 命令行客户端和 mysqldump 数据库备份实用程序。

假设您有可用的连接信息，请使用本地计算机上的`mysql`和`mysqldump`实用程序远程直接连接到 ClearDB 并导入数据。这个其他的答案可能会有所帮助：[如何在 PHP 中将数据库从一台服务器复制到另一台服务器？](https://stackoverflow.com/questions/2972453/how-to-copy-a-database-from-one-server-to-another-server-in-php/2972492#2972492)

您可以在本地导出数据库转储`mysql_dump`，然后从 给出用户名/密码/主机信息`heroku config`，您可以在本地使用它们`mysql`的实用程序导入远程主机，如下所示：

```
$ mysqldump --user=db1user --password=db1pass local_database > db.sql  
$ mysql --host=remote_host --user=db2user --password=db2pass myschema < db.sql 
```

# java - 多个服务器上的 Java 锁定

> ID：14947509
> 
> 赞同：3
> 
> 时间：2013-02-18T23:56:16.763
> 
> 标签：java, locking, synchronized

我很少有座位可以由用户保留。一次，只有一个用户可以参与预订过程，因此同一座位不会被多个用户预订。在我的 Java 代码中，我使用了“同步”关键字来完成它。这行得通。

但是，现在我的代码部署在两台服务器上，比如 S1 和 S2。假设，假设有最后一个座位可用。两个用户，比如 U1 和 U2，想要保留最后一个座位。负载均衡器可能会将用户 U1 发送到服务器 S1，将用户 U2 发送到服务器 S2。现在，“本地”同步仍然可以以相同的方式工作，但在进行预订时将无法阻止其他用户。这将使两个用户都保留最后一个座位，这是有问题的。

所以问题是如何确保多个用户在多服务器环境中保留席位而不会发生任何冲突？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T01:31:03.323

在语言层面上很难做到。一些分布式缓存可能会有所帮助，例如**Terracotta**确实处理集群环境中的同步关键字，但我还没有尝试过，而且肯定会造成性能损失。我会非常小心地让实例等待一些重要的时间，就像你的情况一样。

否则，分布式 JNDI、分布式单例或类似的东西可以使服务器实例进行通信并在此过程中检查是否有帮助。

但在实践中，通常通过乐观锁定来避免这个问题。您可能会简单地假设这只发生在一些不寻常/不太可能的时刻，并像在一个实例中那样做事情。并找出一种方法，当它没有时该怎么做。这变得更像是业务逻辑场景，最好的方法就是找到一种让用户最不可能不满意的方法。

通常在持久性/数据库级别保证一致性，所以你可以把它写在那里。我当然不会使用 synchronized 关键字来阻止可能保持几分钟或更长时间的实例，因为它要求内存泄漏或任何其他资源耗尽。

我个人喜欢在使用处理此问题的 JPA/Hibernate 时使用**L2 缓存。**当 OpenJPA 只通知其他实例实体已更改并且他们应该从其 L1 缓存中撤消它时，它有一种性能友好的方式来执行 L2 工作。在您的情况下，这可能是比使用同步 Java 语言关键字“同步”更好的方法。

考虑如何处理它是一种很好的态度，因为根据我的经验，它在许多应用程序中都被忽略了。它经常成为一种低概率的情况，业务导向的经理很难理解为什么应该投资它。但它具有强烈反弹的能力，以防生产中出现问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T01:07:27.593

分布式系统基本上有四种通信方式：

1.  共享数据库。
2.  远程过程调用
3.  消息传递。
4.  共享文件系统。

考虑共享数据库方法。. 如果您不需要大规模扩展，最简单的方法是使用关系数据库，因为它们几乎都提供了一定程度的 ACID（原子性、一致性、隔离性和持久性）。. .

您可以设置事务，并在发生冲突时回滚/处理 - 这称为乐观锁定策略。

如果你使用 Spring + JPA/Hibernate，所有的辛苦工作都已经为你完成了，你只需要在你的更新方法中添加一个 @Transactional 注释。. . 一本关于 Spring 的好书是《Spring in Action》。

另一种选择是使用分布式缓存。

# sql - Sql server 日期约束

> ID：14947513
> 
> 赞同：0
> 
> 时间：2013-02-18T23:56:21.340
> 
> 标签：sql, sql-server

```
alter table dbo.transactions
add constraint tk_paiement check ([Date_paiementdu]=[dateTransaction] +(30)) 
```

我想`date_paiementdu`在 datetransaction 后 30 天设置，但它不起作用

需要一些帮助！谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T00:00:53.880

您已经定义了一个 CHECK 约束，但您似乎想要的是一个[计算列](http://msdn.microsoft.com/en-us/library/ms191250%28v=sql.105%29.aspx)：

```
alter table dbo.transactions 
add tk_Date_paiementdu as (DateAdd(day, 30, [dateTransaction]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T00:01:27.227

听起来您想要一个[计算列](http://msdn.microsoft.com/en-us/library/ms191250%28v=sql.105%29.aspx)而不是检查约束：

```
ALTER TABLE yourTable 
ADD Date_paiementdu AS DATEADD(DAY, 30, dateTransaction); 
```

如果您希望该列不可为空或索引，那么您将需要使用`PERSISTED`DateTransaction 也需要不可为空：

```
ALTER TABLE yourTable 
ADD Date_paiementdu AS DATEADD(DAY, 30, dateTransaction) PERSISTED NOT NULL; 
```

为了进一步澄清，使用 PERSISTED 实际上将存储要在列中显示的数据，省略它将将该列保留为每次需要时计算的虚拟列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T00:40:00.327

数据库规范化的原则之一是不存储计算值。考虑到这一点，您可能可以通过以下方式实现您的目标：

```
where datediff(day, dateTransaction, Date_paiementdu) <= 30 
```

如何完成此操作的详细信息是 RDBMS 特定的，您没有指定您的。

# html - 为什么浮动会在 div 上方搞乱？

> ID：14947514
> 
> 赞同：2
> 
> 时间：2013-02-18T23:56:21.227
> 
> 标签：html, css

我有完美的工作代码，它不能像我想要的那样工作......但是工作。

我想居中而不是浮动

这是工作代码：

我的.css：

```
* {
 margin: 0;
 padding: 0;
}
body { background: #ededed url(../images/bg.gif) repeat-x; }
p {
 color: #999;
 padding: 0;
 margin: 10px 0;
 font: 12px/18px Arial, Helvetica, sans-serif;
}
#container {
 margin: auto;
 width: 950px;
}
#header {
 height: 302px;c
 width: 950px;
 float: left;
 background: url(../images/header.gif) no-repeat;
}
#logo { margin-top: 60px; }
#logo h1 {
 display: block;
 float: left;
 width: 503px;
 height: 57px;
 text-indent: -9999px;
}
#logo h1 a {
 display: block;
 width: 100%;
 height: 100%;
 outline: none;
 background: url(../images/logo.png) no-repeat 0 0;
}
#navigation {
 height: 38px;
 width: 950px;
 margin-top: 152px;
 float: left;
}
.nav-links li {
 display: inline;
 padding: 3px 25px 0 0;
 float: left;
}
.nav-links li a {
 text-transform: capitalize;
 color: #fff;
 text-decoration: none;
 letter-spacing: -1px;
 font: bold 14px Arial, Helvetica, sans-serif;
}
.nav-links li a:hover { color: #ff0; }
.phone-number li {
 float: right;
 list-style-type: none;
 text-transform: capitalize;
 color: #fff;
 letter-spacing: -1px;
 padding-top: 3px;
 font: normal 14px Arial, Helvetica, sans-serif;
}
h2 {
 text-transform: capitalize;
 color: #666;
 letter-spacing: -1px;
 padding-top: 7px;
 font: bold 16px Arial, Helvetica, sans-serif;
}
.content-middle p { text-align: justify; }
#content-center {
 float: right;
 width: 322px;
 margin-top: 20px;
}
.login-top {
 float: left;
 height: 32px;
 width: 292px;
 background: url(../images/sidebar_top.png) no-repeat;
 padding: 4px 15px;
}
.login-middle {
 float: left;
 width: 290px;
 padding: 5px 15px 0 15px;
 border-right: 1px solid #d3d3d3;
 border-left: 1px solid #d3d3d3;
 background: #fff;
}
.login-middle p { text-align: justify; }
.login-bottom {
 float: left;
 height: 16px;
 width: 322px;
 margin-bottom: 15px;
 background: url(../images/sidebar_bottom.png) no-repeat;
}
#footer {
 clear: both;
 height: 111px;
 background: url(../images/footer.gif) repeat-x bottom;
}
#footer-content {
 height: 91px;
 width: 950px;
 padding-top: 20px;
 margin: auto;
}
#footer-content p {
 color: #fff;
 text-align: center;
 padding-top: 35px;
}

.divbuttons{text-align: center;
}

.login{width:25%;}

.button {
    background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #89c403), color-stop(1, #77a809) );
    background:-moz-linear-gradient( center top, #89c403 5%, #77a809 100% );
    filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#89c403', endColorstr='#77a809');
    background-color:#89c403;
    -moz-border-radius:9px;
    -webkit-border-radius:9px;
    border-radius:9px;
    border:1px solid #74b807;
    display:inline-block;
    color:#ffffff;
    font-family:Verdana;
    font-size:14px;
    font-weight:bold;
    padding:6px 30px;
    text-decoration:none;
    text-shadow:0px 1px 0px #528009;
}.button:hover {
    background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #77a809), color-stop(1, #89c403) );
    background:-moz-linear-gradient( center top, #77a809 5%, #89c403 100% );
    filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#77a809', endColorstr='#89c403');
    background-color:#77a809;
}.button:active {
    position:relative;
    top:1px;} 
```

我的HTML：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="icon" type="image/x-icon" href="images/favicon.ico" />
<title>Pachonk - Home</title>
<base href="http://alex.piechowski.org/school/"></base>
<link href="css/admin.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
<script type="text/javascript" src="js/noty/jquery.noty.js"></script>
<script type="text/javascript" src="js/noty/layouts/top.js"></script>
<script type="text/javascript" src="js/noty/layouts/inline.js"></script>
<script type="text/javascript" src="js/noty/themes/default.js"></script>
<script type="text/javascript" src="js/script.js"></script>
</head>
<body>
<div id="container">
  <div id="header">
    <div id="logo">
      <h1><a href="home">Pachonk - Your Assignments, anywhere!</a></h1>
    </div>
    <div id="navigation">
      <ul class="nav-links">
        <li><a href="home">home</a></li>
        <li><a href="#">our schools</a></li>
        <li><a href="#">applications</a></li>
        <li><a href="#">about us</a></li>
        <li><a href="contact">contact us</a></li>
      </ul>
      <ul class="phone-number">
        <li>free quotation - 0800 123 456</li>
      </ul>
    </div>
  </div>
  <div id="content-center">
  <div class="login-top">
  <h2>Administrator Login:</h2>
  </div>
    <div class="login-middle">
        <p>> Email confirmation upon register theming</p>
        <p>> Dynamic nav bar</p>
        <p>> Contact me form active</p>
        <p>> Make logout.php a json response</p>
        <p>> Error checking both server side and client side registration</p>
        <p>> Log in using email OR username</p>
        <p>> login box display more detials</p>
        <p>> Password reset</p>
        <p>> include files to memory save</p>
        <p>> inline noty's on login/register.</p>
        <p>> clean code</p>
        <p>> admin side</p>
        <p>> library for logcheck/admin check</p>
    </div>
    <div class="login-bottom">
    </div>
  </div>
  </div>
 <div id="footer">
  <div id="footer-content">
<p>&copy; Copyright
2013
 Pachonk</p> 
  </div>
</div>
</body>
</html> 
```

然后我尝试通过以下方式使 div 成为中心：

```
#content-center {
 margin-left: auto ;
 margin-right: auto ;
 width: 322px;
 margin-top: 20px;
} 
```

但是它弄乱了上面的div。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-18T23:58:17.803

添加这个：

```
#content_center {
    margin-left: auto ;
    margin-right: auto ;
    width: 322px;
    margin-top: 20px;
    clear: both;
} 
```

左侧或右侧都不允许浮动元素（由于`clear: both`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T23:59:58.927

您需要删除：

```
margin-top: 20px; 
```

来自#content-center，因为这会推动该 div 中的所有内容。

编辑：上面的答案告诉你添加

```
clear:both; 
```

这也有效，我想我误解了你的问题以及为什么你首先需要margin-top。仍然完全不知道为什么你首先需要保证金顶部，如果有人不介意解释，这真的让我烦恼吗？:)

# apache - PKIX 路径构建失败：sun.security.provider.certpath.SunCertPathBuilderException：无法找到请求目标的有效证书路径

> ID：14947517
> 
> 赞同：7
> 
> 时间：2013-02-18T23:56:36.733
> 
> 标签：apache, tomcat, ssl

我在 Tomcat 7.x 中通过 TLS 连接（https）进行 Web 服务调用

调用 WebService 时，出现以下错误。会是什么问题？我尝试过创建证书和 CA。

仅供参考 - [https://sites.google.com/site/ddmwsst/create-your-own-certificate-and-ca](https://sites.google.com/site/ddmwsst/create-your-own-certificate-and-ca)

我导入了 CA 证书和其他证书，但仍然遇到此问题。请指教。

```
Caused by: javax.wsdl.WSDLException: WSDLException: faultCode=PARSER_ERROR: Problem parsing 'https://localhost:8443/myDomain/MyService?wsdl'.: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
at com.ibm.wsdl.xml.WSDLReaderImpl.getDocument(Unknown Source)
at com.ibm.wsdl.xml.WSDLReaderImpl.readWSDL(Unknown Source)
at com.ibm.wsdl.xml.WSDLReaderImpl.readWSDL(Unknown Source)
at org.apache.cxf.wsdl11.WSDLManagerImpl.loadDefinition(WSDLManagerImpl.java:262)
at org.apache.cxf.wsdl11.WSDLManagerImpl.getDefinition(WSDLManagerImpl.java:205)
at org.apache.cxf.wsdl11.WSDLServiceFactory.<init>(WSDLServiceFactory.java:92)
... 37 more
Caused by: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
    at sun.security.ssl.Alerts.getSSLException(Alerts.java:192)
    at sun.security.ssl.SSLSocketImpl.fatal(SSLSocketImpl.java:1902)
    at sun.security.ssl.Handshaker.fatalSE(Handshaker.java:276)
    at sun.security.ssl.Handshaker.fatalSE(Handshaker.java:270)
    at sun.security.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1341)
    at sun.security.ssl.ClientHandshaker.processMessage(ClientHandshaker.java:153)
    at sun.security.ssl.Handshaker.processLoop(Handshaker.java:868)
    at sun.security.ssl.Handshaker.process_record(Handshaker.java:804)
    at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:1032)
    at sun.security.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1328)
    at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1355)
    at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1339)
    at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:515)
    at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:185)
    at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1299)
    at sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:254)
    at com.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntity(XMLEntityManager.java:632)
    at com.sun.org.apache.xerces.internal.impl.XMLVersionDetector.determineDocVersion(XMLVersionDetector.java:189)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:799)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:764)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:123)
    at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:237)
    at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:300)
    ... 43 more
Caused by: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
    at sun.security.validator.PKIXValidator.doBuild(PKIXValidator.java:385)
    at sun.security.validator.PKIXValidator.engineValidate(PKIXValidator.java:292)
    at sun.security.validator.Validator.validate(Validator.java:260)
    at sun.security.ssl.X509TrustManagerImpl.validate(X509TrustManagerImpl.java:326)
    at sun.security.ssl.X509TrustManagerImpl.checkTrusted(X509TrustManagerImpl.java:231)
    at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:126)
    at sun.security.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1323)
    ... 61 more
Caused by: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
    at sun.security.provider.certpath.SunCertPathBuilder.engineBuild(SunCertPathBuilder.java:196)
    at java.security.cert.CertPathBuilder.build(CertPathBuilder.java:268)
    at sun.security.validator.PKIXValidator.doBuild(PKIXValidator.java:380) 
```

我正在通过本地创建来测试证书。所以我遵循了这些步骤。

密钥>keytool -genkey -alias TLS -keystore TLSKeyStore.jks -keyalg RSA -sigalg SHA1withRSA Keys>keytool -export -alias TLS -file TLS.cer -keystore TLSKeyStore.jks 密钥>keytool -certreq -alias TLS -keystore TLSKeyStore.jks -文件 TLS.csr

CA>设置 RANDFILE=rand

CA>openssl req -new -keyout TLSkey.pem -out TLSreq.pem -config C:\OpenSSL-Win64\bin\openssl.cfg

CA>openssl x509 -signkey TLSkey.pem -req -days 3650 -in TLSreq.pem -out TLSroot.cer -extensions v3_ca

CA>openssl x509 -CA TLSroot.cer -CAkey TLSkey.pem -CAserial serial.txt -req -in ../Keys/TLS.csr -out ../Keys/TLSTestCA.cer -days 365

密钥>keytool -import -alias TLSCA -file ../CA/TLSroot.cer -keystore TLSKeyStore.jks 密钥>keytool -import -alias TLS -file TLSTestCA.cer -keystore TLSKeyStore.jks

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T21:28:04.327

最后我找到了解决这个问题的方法。

请参阅此链接中的此[InstallCert.java](http://www.eclipse.org/forums/index.php/m/698088/#msg_698088)。通过将参数传递为**localhost:9443**作为独立程序运行此程序，程序在 eclipse 下创建**jssecacerts**文件。将此**jssecacerts**文件复制到 JDK_HOME\jre\lib\security\ 文件夹中。那应该可以解决问题

快乐的 TLS 设置！！！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-10-18T17:51:58.660

**以下是如何导入证书以修复以下错误的总体摘要：**

> 尝试执行请求时出错。javax.net.ssl.SSLHandshakeException：sun.security.validator.ValidatorException：PKIX 路径构建失败：sun.security.provider.certpath.SunCertPathBuilderException：无法找到请求目标的有效证书路径

**如何导入证书**

1.  在浏览器中转到 URL，单击 HTTPS 证书链（URL 地址旁边的小锁符号）以**导出证书**
    *   单击“更多信息”>“安全”>“显示证书”>“详细信息”>“导出..”。
    *   另存为**`.der`**
    *   对您需要导入的任何证书重复此操作
2.  找到**$JAVA_HOME/jre/lib/security/cacerts**
3.  **使用以下命令将所有 *.der 文件**导入 cacerts 文件：

    ```
    sudo keytool -import -alias mysitestaging -keystore $JAVA_HOME/jre/lib/security/cacerts -file staging.der
    sudo keytool -import -alias mysiteprod -keystore  $JAVA_HOME/jre/lib/security/cacerts -file prod.der
    sudo keytool -import -alias mysitedev -keystore  $JAVA_HOME/jre/lib/security/cacerts -file dev.der 
    ```

4.  默认密钥库**密码是“changeit”**

5.  您可以查看使用显示证书指纹的此命令所做的更改。

    ```
    keytool -list -keystore $JAVA_HOME/jre/lib/security/cacerts 
    ```

6.  如果这不能解决问题，请尝试将这些 java 选项添加为参数：

    ```
    -Djavax.net.ssl.trustStore="$JAVA_HOME/jre/lib/security/cacerts"
    -Djavax.net.ssl.trustStorePassword="changeit" 
    ```

我的猜测是你可能错过了一步。我遇到了同样的错误，直到我意识到我导入了错误的证书

# webmatrix-2 - 在 Webmatrix 2 中嵌套 @foreach

> ID：14947518
> 
> 赞同：1
> 
> 时间：2013-02-18T23:56:57.163
> 
> 标签：webmatrix-2

我在这里有点生疏，所以请耐心等待。我正在尝试像这样在他们的组中获取我的项目列表。

```
 <h2>Category Heading 1</h2>
   <ul>
     <li>Item list 1</li>
    <li>Item list 2</li>
   </ul>

  <h2>Category Heading 2</h2>
   <ul>
     <li>Item list 1</li>
    <li>Item list 2</li>
   </ul> 
```

我的代码是 - 我收到错误

```
 @foreach (var group in db.Query(GroupName)){
    <h3>@group.Name</h3>
<ul>
    @foreach(var row in db.Query(queryList)){
  <li><a href="/DataVideo?id=@row.ID"> @row.title</a></li> 
  }
 </ul>
} 
```

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T07:45:54.803

您应该能够通过一次性获取所有数据并使用 LINQ GroupBy 运算符来做到这一点。这是我写的一篇关于显示这样的分层数据的文章：http: [//www.mikesdotnetting.com/Article/189/Efficiently-Displaying-Hierarchical-Data-With-The-jQuery-Accordion-In-Razor-Web-Pages](http://www.mikesdotnetting.com/Article/189/Efficiently-Displaying-Hierarchical-Data-With-The-jQuery-Accordion-In-Razor-Web-Pages)

你可以忽略我介绍 jQuery 手风琴的第二半...

# android - 尝试构建 Cyanogenmod 7 - 找不到 wifi.h

> ID：14947519
> 
> 赞同：2
> 
> 时间：2013-02-18T23:57:18.067
> 
> 标签：android, build, cyanogenmod

我尝试为我的 ZTE Tureis 构建 Cyanogenmod 7 (Android 2.3.7)。

构建停止于

```
frameworks/base/core/jni/android_net_wifi_Wifi.cpp:26:18: error: wifi.h: No such file or directory 
```

当我打开 cpp 文件并更改

```
<include "wifi.h"> 
```

至

```
<#include "../../../hardware/libhardware_legacy/include/hardware_legacy/wifi.h"> 
```

构建通过了这个，但它稍后又抱怨其他文件中缺少标题。

这里有什么想法吗？我已经做了一个新的 repo 同步，所有文件都应该到位。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T11:34:37.340

将此行复制粘贴到您尝试包含的 Android.mk 文件中`"wifi.h"`

```
LOCAL_C_INCLUDES += $(call include-path-for, libhardware_legacy)/hardware_legacy 
```

# java - 如何将整行元素输入二维数组

> ID：14947525
> 
> 赞同：0
> 
> 时间：2013-02-18T23:57:36.213
> 
> 标签：java, arrays, numbers, user-input

我正在尝试使用数组，虽然我可以弄清楚如何根据用户输入输入二维数组的元素，但我无法弄清楚如何提示用户分别输入二维数组的整行（在在每个数字之间），而不是输入每个数字，然后按 Enter。我可以在这里得到一些帮助吗？我知道这将在我的下一次测试中，谢谢大家！

这是我的代码：

```
import java.util.Scanner;

public class NewArray
{
    public static void main(String[] args)
    {
        Scanner input = new Scanner(System.in);
        System.out.print("Enter the number of rows: ");
        int Rows = input.nextInt();
        System.out.print("Enter the number of columns: ");
        int Columns = input.nextInt();

        int[][] array = new int[Rows][Columns];

        System.out.println("Enter the numbers in array: ");
        for (int i = 0; i < array.length; i++) 
        {
            for (int j = 0; j < array[i].length; j++)
                array[i][j] = input.nextInt();
        }
        System.out.println(isConsecutiveFour(array));
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-22T05:50:12.517

您也可以将每一行作为输入，然后使用分隔符逐个字符地获取输入。例如

```
String s = sc.next();

        for(int j=0;j<s.length();j++)
        {
          array[i][j] = Character.getNumericValue(s.charAt(j));

        } 
```

或者你可以做

数组[i][j] = s.charAt(j) - '0';

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:14:54.907

循环`rows`时间，和`String l = input.nextLine();`

用分隔符分割字符串（空格或逗号或分号，你可以定义它）。

当然，实现验证逻辑。例如 Nan 大小写、拆分数组大小与大小写不匹配`columns`等。

顺便说一句，基于 java 命名约定，最好使用`rows`,`columns`作为名称。否则它们看起来像类....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T00:15:01.820

好吧，你可以提示他们每一行......

```
for (int i = 0; i < array.length; i++) {
  // Prompt user to enter column values for each row
  System.out.printf("Enter %d integers for row %d/%d (delimeted by spaces): ",
    columns, i+1, rows);
  for (int j = 0; j < array[i].length; j++)
    array[i][j] = input.nextInt();
} 
```

**输出**

```
user@ubuntu:~$ java NewArray 
Enter the number of rows: 4
Enter the number of columns: 3
Enter the numbers in array: 
Enter 3 integers for row 1/4 (delimeted by spaces): 1 2 3
Enter 3 integers for row 2/4 (delimeted by spaces): 4 5 6
Enter 3 integers for row 3/4 (delimeted by spaces): 7 8 9
Enter 3 integers for row 4/4 (delimeted by spaces): 10 11 12 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T00:16:59.493

执行您要求的一种方法是将他们输入的内容作为一整行输入。然后，您查看该行并检查是否有足够的值，如果它们没有按照您的方式输入，则以某种方式失败。

问题在于，这对用户来说真的很烦人。如果它需要 10 个数字并且由于计数错误或句号应该有多余的空格而输入 9 或 11 怎么办？你会怎样做？

很大程度上取决于您的程序如何响应用户没有“正确”执行它。

因此，如果他们输入太多，您可以回显第一个数字（直到所需的数字）并询问是否可以只使用这些数字。然后他们回答 Y 或 N。

如果他们输入的太少，您可以回显他们输入的数字，然后要求更多的数字来填写所需的计数。

所有这一切都变成了要编写的大量代码，而且可能很挑剔——你必须把它弄得恰到好处，否则，它又会使用户感到困惑。

另一种可能的解决方案是让他们一个一个地输入它们，然后您将信息回显给他们，以便他们知道自己在哪里。诸如“请在第 3 行输入元素 4：”之类的内容将帮助他们跟踪它。

也许您对此研究得越多，您就越能看到当今通用用户界面的价值，无论是对于独立应用程序还是 Web 应用程序。例如，在网络上，您可以向他们展示一个包含文本框行和列的表单，并且如果某些框没有正确填写，则可以轻松地重新显示该页面。基于控制台的用户界面已在多年前使用，但仍有很多不足之处。

# java - 测试是否发出了良好的查询

> ID：14947537
> 
> 赞同：3
> 
> 时间：2013-02-18T23:58:26.207
> 
> 标签：java, unit-testing, mocking

发现自己针对数据库调用编写单元测试是很常见的，而且我总是遇到同样的问题：*如何验证是否将一个好的查询发送到数据库？*

例如，我有这个类，它将以下列形式向数据库发送最终更新：

```
update credential set password_hash = ?, password_crypt = ?, password_plain = ? where id = ? 
```

（这是一个密码迁移工具，请不要介意该`password_plain`字段的安全问题）

为这个类编写测试类，我已经模拟了数据库访问类（在这种情况下我使用的是 Spring JDBCTemplate）并捕获了发出的 sql。获得 sql 后，我会进行以下检查：

```
String space = "\\s+";
String optSpace = "\\s*";
String something = ".+";
String optSomething = ".*";

sql = sql.toLowerCase();
assertTrue(sql.matches(optSpace + "update" + space + "credential" + space + "set" + space + something));
assertTrue(sql.matches(something + space + "set" + space + optSomething + "password_hash" + optSpace + "=" + optSpace + "\\?" + something + "where" + something));
assertTrue(sql.matches(something + space + "set" + space + optSomething + "password_crypt" + optSpace + "=" + optSpace + "\\?" + something + "where" + something));
assertTrue(sql.matches(something + space + "set" + space + optSomething + "password_plain" + optSpace + "=" + optSpace + "\\?" + something + "where" + something));
assertTrue(sql.matches(something + space + "where" + space + optSomething + "id" + optSpace + "=" + optSpace + "\\?" + optSomething)); 
```

通过这些检查，我确实在验证发布的 SQL 是否包含更新的最重要部分，例如：

*   正在更新正确的表
*   所有 3 个字段都被更新为作为参数传递的值
*   正在语句`id`中使用`where`，其值作为参数

我可以简单地验证发出的查询是否正是上面的预期查询，但这会使测试对未来的更改过于限制，并且如果查询的任何部分被更改，即使更新保持正确，也会强制失败。因为我认为编写的测试主要用于将来（当您更改软件并且需要更多保证时）而不是现在，所以这个选项会使测试有点无用。

好吧，最后，我声明我的问题：我们有哪些更好的选择来验证已发布的 SQL？

我看到很多项目创建带有少量数据的小型嵌入式数据库来测试处理数据库的类，但我想编写一个更*纯粹*的单元测试替代方案（如果我可以称之为）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T00:01:41.883

我认为没有一个很好的替代方法来测试真实的数据库（即使它是嵌入式的等）。目前，您正在测试您的 SQL 在语法上是否有效，但它是否真的*可以工作*。例如，您知道它是否会违反约束等...

模拟等一切都很好，但是在某些阶段您必须针对数据库进行测试。我会确保您尽可能不对数据库进行测试，然后硬着头皮围绕一个小型数据库构建测试（具有适当的回滚/重建等），以实际确认正确的数据库功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T05:56:33.467

我恳请您重新考虑这些测试的好处，因为

*   它正在验证实现而不是行为
*   当您将来更改 SQL 查询时（或者有人只是错误地添加了一个无害的空间），即使您保留了行为，您也会有一个失败的测试。

对于最终的 DataAccessLayer，我建议编写一个集成测试。一个与真实但最小的数据库运行的数据库。当然，这些测试会很慢，但它们提供的信心是值得的。

因此，针对 GetCustomers() 编写测试并验证返回的 DTO 是否包含正确的数据，而不是验证您发出的 SQL 查询是 X。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T17:30:52.457

不要断言你的 sql。这是毫无意义。您最终会将传递的 sql 字符串与另一个字符串（也由您创建，因此没有验证）进行比较，或者您必须实现自己的数据库。而是只使用现有的。检查是查询返回正确的数据或正确更改数据库中的数据。使用 dbunit 或类似的东西。

# wordpress - Wordpress：更改永久链接后如何重定向旧链接？

> ID：14947538
> 
> 赞同：0
> 
> 时间：2013-02-18T23:58:28.750
> 
> 标签：wordpress, .htaccess, redirect, permalinks

wp旧永久链接：

/%category%/%postname%/

我把它改成了：（新的永久链接）

/%邮递名称%/

永久链接更改后如何重定向旧链接？与 HTACCESS？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-26T05:38:59.153

These lines in your htaccess should take care of it:

```
RewriteEngine On
RewriteRule ^(?:[\w|\-]*)/(.*)$ http://example.com/$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-19T09:22:08.997

大多数情况下，wordpress 会记住您的永久链接更改，并将流量从您的旧网址重定向到新网址

# java - 在hadoop中找到最大的整数值（使用java编程）

> ID：14947542
> 
> 赞同：-4
> 
> 时间：2013-02-18T23:58:37.747
> 
> 标签：java, hadoop, mapreduce

我最近开始在hadoop工作，我刚刚学习了一些关于它的基本理论知识。我正在尝试解决应在文本文件中给出输入的任务，例如 input.txt (1 10 37 5 4 98 100 等)

我需要在给定的输入中找到最大的整数（即整数类型）。我正在尝试传递数组列表中的输入，以便我可以将第一个整数与所有整数的其余部分进行比较（使用 for 循环）。

程序应该读取输入文件说一些随机数 100 20 40 90 70，然后输出应该显示为 100。我刚刚尝试使用 map 和 reduce 函数中的 wordcount 示例修改代码。但是由于我是新手，开始使用 hadoop 编码，所以我无法弄清楚我错在哪里。

1）是否有可能以这种方式找到解决方案？如果是，我无法在 hadoop 中创建数组列表，需要一些提示:-)

2）我们可以只打印“键”而不是键值对吗？如果是这样，请帮助我。我试图在 reduce 函数中编写代码以不打印它，但我遇到了一些错误。

请指导我一些提示，我可以通过这些提示继续前进。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:02:54.530

阅读 Hadoop Java API 并编写以下函数：

```
Map: Identity function

Reduce (or Combine): (K, List<V>) -> (K, max(List<V>)) 
```

关于您的评论，`ArrayLists`MapReduce 中没有，那些不适合内存。值列表作为迭代器传递，并且对象通常被重用以节省内存 - 因此您不能依赖它们的内容保持不变。

映射器 API：[http ://hadoop.apache.org/docs/r1.1.1/api/org/apache/hadoop/mapreduce/Mapper.html](http://hadoop.apache.org/docs/r1.1.1/api/org/apache/hadoop/mapreduce/Mapper.html)

对于您的映射器，您可以编写以下函数，或者只使用预先实现的`IdentityMapper`.

```
public void map(K key, V val, Context context)
throws IOException {
    context.collect(key, val);
} 
```

减速器 API：[http ://hadoop.apache.org/docs/r1.1.1/api/org/apache/hadoop/mapreduce/Reducer.html](http://hadoop.apache.org/docs/r1.1.1/api/org/apache/hadoop/mapreduce/Reducer.html)

您的 reduce 函数将是（假设`V implements Comparable<V>`），为简洁起见，我们会说 values 至少包含一项：

```
public void reduce(K key, Iterator<V> values, Context context)
throws IOException {
    V max = values.next();
    while( values.hasNext() ) {
        V current = values.next();
        if( current.compareTo(max) > 0 )
            max = current;
    }
    context.collect(key, max);
} 
```

# mysql - Mysql Replication Master-Master

> ID：14947547
> 
> 赞同：1
> 
> 时间：2013-02-18T23:59:03.990
> 
> 标签：mysql, replication, database-replication

我正在研究一种解决方案，在不同位置的服务器中进行 Mysql 复制主控，以实现冗余、负载平衡和容错。到目前为止，我发现主-主复制插入可以在任何服务器中完成，它将被复制到第二个、第三个……主。我已经检查了所有关于复制的教程，并准备好实施和测试。但是有一个问题我还没有找到解决方案。想象一下数据库上的所有主键都是 INT 并且自动递增的场景。如果在不同的主-主 Mysql 复制服务器上同时进行两次插入，会发生什么情况，我有机会失去诚信吗？db 结构是否应该有另一个列来标识复制服务器的 id？我应该对主-主复制上的数据库结构有什么顾虑？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:04:27.883

Using a combination of `auto_increment_increment` and `auto_increment_offset` you can control which keys are created on which master and there should be no overlap.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T07:47:35.057

使用整数以外的东西怎么样？还有可能使用 UUID/GUID。这样，您就不会遇到主键冲突。

# dynamics-crm-2011 - 自定义活动的默认父实体

> ID：14947549
> 
> 赞同：1
> 
> 时间：2013-02-18T23:59:10.993
> 
> 标签：dynamics-crm-2011

这应该是一件简单的事情，但正如我在 CRM 2011 中很快发现的那样，简单的事情几乎从来都不是……

无论如何，我有一个自定义活动类型，一个“旅行”。一次旅行代表服务技术人员对客户站点的一次访问。旅行*总是*与案例（事件）相关联而*不是*任何其他实体类型创建，因此实体作为自定义活动存在，不会“在活动菜单中显示”。这允许我将 Trips 的子网格放入主 Case 视图，使其成为唯一可以创建这些东西的地方。

问题是，当我尝试从“案例”表单创建新旅行时（通过单击子网格并从功能区中选择“添加新旅行”），“关于”字段没有填充我当时所在的案例我点击了“添加”。任何“内置”活动类型都将默认它们对应的字段没有问题，所以在我看来，我可以在这里做同样的事情。一旦这个默认值起作用，该字段应该是只读的，但是我可以在创建新旅行时设置参考，我已经使它可编辑，当然当您弹出查找时，您可以将此旅行分配给任何东西（这就是为什么我首先希望该字段只读）。

**当 Trip 表单加载时，我需要表单来默认父 Case。**它必须在第一次创建时就存在，因为如果它在第一次保存时不存在，那么一些设置其他默认值的插件代码（即与同一案例可能存在或不存在的其他旅行相关的数据）将获胜不能正常工作。

我读到了关系字段映射，您可以在其中根据父实体的字段默认各种字段的值，但是事件和我的旅行之间的关系没有从任何一方列为可映射的，我不知道如何使其可映射。我也知道可以使用 JavaScript 设置默认值，但是如果有一种不那么“自定义”的方式来设置这个特定的行为，我很想知道如何。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:55:16.597

作为基于迈克评论的墓志铭，微软似乎确实不希望这样做。但是，它仍然可以做到。基本步骤是：

*   下载 Ribbon Workbench 解决方案并将其导入 CRM。
*   创建一个新的解决方案，其中包含您希望能够自定义的一个或多个实体。
*   创建一个 JavaScript 文件，其中包含将打开所需表单并将所需信息作为参数传递的函数。有两种方法可以指定参数；您可以在表单上定义自定义参数，也可以将 Microsoft 未记录的参数用于“相关”字段：

    ```
    function OpenNewTripFromCase()
    {
        var entityId = Xrm.Page.data.entity.getId();
        var entityTypeCode= Xrm.Page.context.getQueryStringParameters().etc;
        var entityDisplayName = Xrm.Page.getAttribute("title").getValue();

        var params = {};
        params["pId"] = entityId;
        params["pType"] = entityTypeCode;
        params["pName"] = entityDisplayName;

        Xrm.Utility.openEntityForm("cst_trip", null, params);
    } 
    ```

*   将此 JavaScript 文件作为 Web 资源导入，并将其添加到解决方案中，以便 Ribbon Workbench 可以使用它。
*   打开 Ribbon Workbench 并打开您使用实体和资源创建的解决方案。单击解决方案元素选项卡，然后找到“命令”项。右键单击并选择“添加新”。现在展开列表，找到并单击您的新命令。在“属性”窗格中，将命令的名称更改为更具描述性（建议您只更改第三个“Command#”术语），然后单击“操作”字段右侧的放大镜按钮。

*   在弹出的窗口中，单击“添加”，然后选择“JavaScript 函数操作”。一个新项目将添加到操作列表中。单击它，然后在右侧的属性窗格中，找到包含您的函数的库，然后输入函数名称。我在这里没有得到任何类型的 IntelliSense，所以要小心输入函数名称。如果需要，请添加参数（您不需要使用上面的代码），然后单击 OK

*   现在单击 Ribbon Workbench 的实体列表中的自定义活动实体，然后在功能区布局右上角的下拉列表中，选择 SubGrid 功能区。在此功能区中创建一个按钮，为其提供所需的图标和文本，然后在“属性”窗格中，将命令设置为您刚刚创建的命令。

发布定制的解决方案，如果你做的一切都正确，你应该有一个新按钮，当你选择一个子网格时，它会与“添加新”按钮做同样的事情，但会另外填充相关字段。

# css - 状态变化的不同转换延迟

> ID：14947552
> 
> 赞同：0
> 
> 时间：2013-02-18T23:59:39.517
> 
> 标签：css, css-transitions

尝试在 :hover 上应用过渡，并为事件的开始和结束提供不同的延迟。下面的 CSS 在 0.35 秒延迟后更改颜色超过 0.25 秒 - 我想在悬停状态结束时将延迟更改为 1.5 秒......有什么建议吗？

```
span {
    transition:.25s linear .35s;
    color:white
}

span:hover {
    color:black
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T02:34:28.193

已排序 - 需要将过渡分解为每个过渡元素的逗号分隔列表，然后指定不同的延迟值。事后看来，真的很容易。

# linux - 我应该在关闭主机之前关闭 lxc 容器吗？

> ID：14947555
> 
> 赞同：1
> 
> 时间：2013-02-18T23:59:52.970
> 
> 标签：linux, ubuntu, system-shutdown, lxc

我正在运行一个带有一些 lxc 容器的 ubuntu 精确主机。在关闭主机之前我应该​​还是必须关闭容器？或者主机关闭会自动传播到容器？我知道如果我使用 lxc 自动启动功能，那么它将关闭容器，但我不想使用自动启动。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T05:34:50.170

容器本身通常运行在主机系统的文件系统上，并且没有自己的文件系统。这意味着从文件系统的角度来看，您可以直接杀死 LXC 而不会冒任何文件系统损坏的风险。

但是，如果您有在 LXC 中运行的服务，例如 MySQL，或其他需要完全关闭其自己的数据存储的服务，那么这些进程完全停止是很重要的。否则，您可能会导致这些服务的数据存储损坏。

如果你使用 /etc/init.d 中的脚本来启动你的 LXC，一旦你关闭你的主机系统，它们应该会收到自动关闭的信号，因为 init 会调用 /etc/init.d/stop。如果您手动启动它们，例如通过 CLI 上的 lxc-start，并且您希望确保它们完全关闭，最好在关闭主机系统之前手动执行。

希望有帮助。

# matlab - 在 64 位 Ubuntu 12.10 中使用 32 位库编译代码的符号链接

> ID：14947557
> 
> 赞同：3
> 
> 时间：2013-02-19T00:00:04.177
> 
> 标签：matlab, 64-bit, symlink, 32-bit, mex

我正在尝试在 64 位 Ubuntu 12.10 上使用 32 位 2012a Matlab 混合 C 代码

我已经下载了所有可能的库（gcc 4.7、build-essential、libs-32 等）但是我收到以下错误

```
/usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-linux-gnu/4.7/libstdc++.so when searching for -lstdc++
/usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-linux-gnu/4.7/libstdc++.a when searching for -lstdc++
/usr/bin/ld: cannot find -lstdc++
/usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-linux-gnu/4.7/libgomp.so when searching for -lgomp
/usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-linux-gnu/4.7/libgomp.a when searching for -lgomp
/usr/bin/ld: cannot find -lgomp
/usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-linux-gnu/4.7/libgcc_s.so when searching for -lgcc_s
/usr/bin/ld: cannot find -lgcc_s
collect2: error: ld returned 1 exit status 
```

我发现这个问题可以通过将符号链接从 64 位库设置为 32 位库来解决。我尝试创建不同的链接，但无法完成编译。

先感谢您。

**更新 1**

gcc-multilib 丢失了，所以之后

```
sudo apt-get install gcc-multilib 
```

我收到以下错误

```
Warning: You are using gcc version "4.7.2-2ubuntu1)".  The version
     currently supported with MEX is "4.4.6".
     For a list of currently supported compilers see: 
     http://www.mathworks.com/support/compilers/current_release/

/usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-linux-gnu/4.7/libstdc++.so when searching for -lstdc++
/usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-linux-gnu/4.7/libstdc++.a when searching for -lstdc++
/usr/bin/ld: cannot find -lstdc++
collect2: error: ld returned 1 exit status 
```

我的 mexopts.sh 看起来像

```
CC='gcc'
CFLAGS='-ansi -D_GNU_SOURCE'
CFLAGS="$CFLAGS -fPIC -pthread -m32"
CFLAGS="$CFLAGS  -fexceptions"
CFLAGS="$CFLAGS -D_FILE_OFFSET_BITS=64" 
CLIBS="$RPATH $MLIBS -lm"
COPTIMFLAGS='-O -DNDEBUG'
CDEBUGFLAGS='-g'
CLIBS="$CLIBS -lstdc++" 
```

-m32 在那里，但是我不确定是否应该以这种方式编写。有人可以详细说明如何编辑 mexopts.sh 以使 matlab 查看 32 位库吗？

**更新 2**

在查看[使用 g++ 进行链接后，搜索 -lstdc++ 失败](https://stackoverflow.com/questions/2086072/linking-using-g-fails-searching-for-lstdc)

我试图安装 g++-multilib

```
sudo apt-get install g++-multilib 
```

现在，错误具有以下形式：

```
/usr/bin/ld: i386:x86-64 architecture of input file `bin/fv_cache.o' is incompatible with i386 output
/usr/bin/ld: i386:x86-64 architecture of input file `bin/obj_func.o' is incompatible    with i386 output
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T08:54:26.180

*   首先确保您可以通过执行 gcc 从命令提示符构建 32 位可执行文件（更多信息：[64 位 Linux 上的 32 位应用程序](http://www.cyberciti.biz/tips/compile-32bit-application-using-gcc-64-bit-linux.html)）
*   在 matlab 命令提示符下执行`mex -setup`并选择`gcc`作为编译器。最后，您将收到一条有关“mexopts.sh”位置的消息（通常为 ~/.matlab//mexopts.sh）
*   尝试“墨西哥”。
*   如果不成功打开`mexopts.sh`并检查选项`-m32`是否在`CFLAGS`. 如果没有，请添加它。

# c# - 如何加速此代码以将字符添加到字符串并将其扩展到所需的长度（所有排列）？

> ID：14947561
> 
> 赞同：-2
> 
> 时间：2013-02-19T00:00:31.353
> 
> 标签：c#

我有以下代码：给定一个长度为 m 的字符串，将“-”添加到任何可能的位置（包括原始字符串的不同字符之间）以将其扩展到长度 n。例如，给定“ABC”，将其扩展为 6。它将是“---ABC”、“--A-BC”、“--AB-C”、“--ABC-”、...。 ..，“AB---C”，“ABC---”。

```
class Program
{
    // <summary>
    /// Grow a string to desired length with time limitation
    /// </summary>
    /// <param name="s"></param>
    /// <param name="length"></param>
    /// <param name="pad"></param>
    /// <param name="Padded"></param>
    public static bool ExtendToLen(string s, int length, char pad, ref List<string> Padded, ref Stopwatch timer, int timeOut)
    {
        if (s.Length == length)
        {
            Padded.Add(s);
            return true;
        }
        else if (s.Length > length)
        {
            return true;
        }
        else
        {
            List<int> pos = GetExceptPos(s, pad.ToString());
            pos.Sort();

            int count = -1;
            foreach (int p in pos)
            {
                if (timer.Elapsed.TotalSeconds > timeOut)
                {
                    return false;
                }

                //Debug.WriteLine(string.Format("pos:{0}", p), "PadToLength");
                count++;

                // Pad left 
                string leftPadStr = s.Substring(0, p) + pad + s.Substring(p);
                //Debug.WriteLine(string.Format("\tLeftPadStr:{0}", leftPadStr));
                bool go = ExtendToLen(leftPadStr, length, pad, ref Padded, ref timer, timeOut);
                if (go == false) { return false; }

                // Pad right at the last pos
                if (count == pos.Count - 1)
                {
                    string rightPadStr = s + pad;
                    go = ExtendToLen(rightPadStr, length, pad, ref Padded, ref timer, timeOut);
                    if (go == false) { return false; }
                }
            }
            return true;
        }
    }

    /// <summary>
    /// Find indexes of elements different from target str
    /// </summary>
    /// <param name="str"></param>
    /// <param name="excludeStr"></param>
    /// <returns></returns>
    private static List<int> GetExceptPos(string str, string excludeStr)
    {
        List<int> allIndexes = new List<int>();
        for (int i = 0; i < str.Length; i++)
        {
            allIndexes.Add(i);
        }

        return allIndexes.Except(str.IndexesOf(excludeStr)).ToList();
    }

    static void Main(string[] args)
    {
        string old = "ACGUA";
        List<string> newList = new List<string>();
        Stopwatch timer = new Stopwatch();
        timer.Start();
        bool isGood = ExtendToLen(old, 12, '-', ref newList, ref timer, 100);
        timer.Stop();

        foreach (string s in newList)
        {
            Console.WriteLine(s);
        }

        Console.WriteLine("Elapsed time: {0}", timer.Elapsed);
        Console.ReadLine();
    }
}

public static class ExtensionMethods
{
    /// <summary>
    /// Return all indeces
    /// </summary>
    /// <param name="haystack"></param>
    /// <param name="needle"></param>
    /// <returns></returns>
    public static IEnumerable<int> IndexesOf(this string haystack, string needle)
    {
        int lastIndex = 0;
        while (true)
        {
            int index = haystack.IndexOf(needle, lastIndex);
            if (index == -1)
            {
                yield break;
            }
            yield return index;
            lastIndex = index + needle.Length;
        }
    }
} 
```

它运行缓慢，例如，如果我想将一个字符串 (len = 5) 扩展到 20，它会运行 long long long time。结果似乎是多余的。

所以问题是如何加快速度并消除这些冗余。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:37:30.357

这是一个非常粗略的技巧，应该可以帮助您入门。

它基本上通过一次填充一个字符来向后移动字符串。

```
static unsafe void performPaddedBubbleSort(string s, char c, int padCount, IList<string> list) {
        s = new string(c, padCount) + s;
        bool complete = false;
        int index = 0;
        int count = 0;
        fixed (char* p = s) {
            while (count < s.Length && *p == c) {
                while (index < s.Length) {
                    if (*(p + index) != c) {
                        // flip them
                        char tempChar = *(p + index);
                        if (index != 0)
                            *((p + index) - 1) = tempChar;
                        *(p + index) = c;

                        list.Add(new string(p));
                    }

                    index++;
                }
                index = 0;
                count++;
            }
        }
    } 
```

填充为 3 的“ABC”的输入（使其宽度为 6 个字符）是：

```
--A-BC
--AB-C
--ABC-
-A-BC-
-AB-C-
-ABC--
A-BC--
AB-C--
ABC---
Elapsed time: 00:00:00.0008663 
```

不确定这是否正是您所追求的……但我想这是一个开始。如您所见，它在几分之一秒内执行。

# c# - 表 UserProfile 的 UserName 长度

> ID：14947565
> 
> 赞同：1
> 
> 时间：2013-02-19T00:00:53.467
> 
> 标签：c#, asp.net, entity-framework, asp.net-mvc-4, entity-framework-5

下面显示了`UserProfile`创建新的 Asp.Net MVC 4 Web 应用程序时自动生成的类的代码。table 的列`UserProfile`将具有`nvarchar(56) not null`. 但是，它没有`MaxLength(56)`and的属性`Required`？为什么它的长度为 56 且可空性为`not null`？

我需要在类中添加一个 email 属性并使用迁移来更新表。我应该添加属性`[Required, MaxLength(256)] string Email`吗？

```
[Table("UserProfile")]
public class UserProfile
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }
    public string UserName { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:18:11.150

答案是肯定的，继续添加所需的属性。[在此处](http://msdn.microsoft.com/en-us/data/gg193958.aspx)进一步阅读有关数据注释的信息

此外，用户名字段几乎不超过 56 个字符。例如，adil.mughal 是一个用户名，我不确定在会员 API 中如何准确识别 56 号，但它很可能足以满足需要。

# c# - ASP .net Web Api 下载和查看图像

> ID：14947574
> 
> 赞同：4
> 
> 时间：2013-02-19T00:01:50.933
> 
> 标签：c#, rest, asp.net-web-api

我想从服务器下载图像并在浏览器中显示它们。但是当我在浏览器中输入 url (localhost:port/api/service/imageID) 时，会出现下载框，询问我是保存还是打开图像。但我希望图像直接显示在浏览器中。这是我的控制器“获取”方法：

```
public HttpResponseMessage Get(int id)
{
  HttpResponseMessage response;
  var image = _repository.RetrieveImage(id);

  if (image == null)
  {
    response = new HttpResponseMessage(HttpStatusCode.NotFound);
  }
  else
  {
    response = new HttpResponseMessage(HttpStatusCode.OK);

    response.Content = new StreamContent(new MemoryStream(image.ImageData));
    response.Content = new ByteArrayContent(image.ImageData);
    response.Content.Headers.ContentDisposition = new ContentDispositionHeaderValue("attachment");
    response.Content.Headers.ContentDisposition.FileName = image.OriginalFileName;
    response.Content.Headers.ContentType = new MediaTypeHeaderValue(image.Mime);
    response.Content.Headers.ContentLength = image.ImageData.Length;
  }
  return response; 
```

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T00:07:55.457

不要使用“附件”内容处置标头。使用该标头指示浏览器下载指定的文件，而不是内联显示它。

```
 response.Content.Headers.ContentDisposition = new ContentDispositionHeaderValue("attachment"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-07-23T20:18:03.170

为完整起见，请注意，`Content-Disposition`使用“另存为”上下文菜单保存时，删除文件名也会删除文件名的任何提示，并且将根据 URL 建议文件名，在这种情况下将类似于“42.jpg” ，因为 URL 的最后一部分是一个 ID。如果要在保存期间保留文件名，请将其更改`Content-Disposition`为“内联”：

```
response.Content.Headers.ContentDisposition = new ContentDispositionHeaderValue("inline")
{
    FileName = image.OriginalFileName,
    Size = image.ImageData.Length
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T00:15:59.107

对于您的情况，我认为您可以只返回一个 StreamContent 并提供此内容的适当内容类型标头。（例如：图像/jpeg）

# perl - 这个 IO::Socket::UNIX 示例有什么问题？

> ID：14947575
> 
> 赞同：0
> 
> 时间：2013-02-19T00:01:52.490
> 
> 标签：perl, io-socket

我正在尝试通过 Unix 套接字实现一个简单的回显客户端/服务器。（我的最终目标是交换 JSON 数据，但这个例子是为了简单起见）。我不知道为什么客户端进程在第二次尝试打印到套接字时会消失在黑洞中。

服务器.pl：

```
use IO::Socket::UNIX;

my $socket_path = '/tmp/mysocket';
unlink $socket_path if -e $socket_path;

my $socket = IO::Socket::UNIX->new(
    Local  => $socket_path,
    Type   => SOCK_STREAM,
    Listen => SOMAXCONN,
);

die "Can't create socket: $!" unless $socket;

while (1) {
    next unless my $connection = $socket->accept;
    chomp( my $line = <$connection> );
    print $connection "$line\n";
} 
```

客户端.pl：

```
use IO::Socket::UNIX;

my $socket = IO::Socket::UNIX->new(
    Type => SOCK_STREAM,
    Peer => '/tmp/mysocket',
);

die "Can't create socket: $!" unless $socket;

my $line;

print $socket "one\n";
chomp( $line = <$socket> );
say $line;

print $socket "two\n";
chomp( $line = <$socket> );
say $line;

say "three"; 
```

预期输出：

```
> ./client.pl
> one
> two
> three 
```

实际输出：

```
> ./client.pl
> one 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T00:17:06.203

你把`$socket->accept`调用放在你的`while`循环中。在您的服务器建立连接并从客户端接收到一些输入后，它要做的下一件事就是建立一个新连接。

将`accept`呼叫移到`while`循环外

```
my $connection = $socket->accept;
$connection->autoflush(1);
while (my $line = <$connection> ) {
    chomp($line);
    print $connection "$line\n";
} 
```

或者，如果您确实想接受多个连接，

```
while (1) {
    next unless my $connection = $socket->accept;
    $connection->autoflush(1);
    while (my $line = <$connection>) {
        chomp($line);
        print $connection "$line\n";
    }
} 
```

您当前的解决方案也可能会“遭受缓冲”，因此服务器和客户端都应`autoflush(1)`在其套接字处理程序上进行设置。

现在要处理*同时*连接，服务器通常会`fork`在获得连接后调用，并在子进程中处理该连接。

```
while (1) {
    my $connection = $socket->accept;
    if (fork() == 0) {
        $connection->autoflush(1);
        while (my $line = <$connection>) {
            chomp($line);
            print $connection "$line\n";
        }
        close $connection;
        exit;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-11-08T07:47:35.960

对于任何人来说，一个完整的双向示例：

服务器：

```
#! /usr/bin/perl -w

use strict;

use IO::Socket::UNIX qw( SOCK_STREAM SOMAXCONN );

my $SOCK_PATH = '/tmp/test.sock';
unlink($SOCK_PATH) if -e $SOCK_PATH;

my $server = IO::Socket::UNIX->new(
   Type => SOCK_STREAM(),
    Local => $SOCK_PATH,
   Listen => SOMAXCONN,
)
   or die("Can't create server socket: $!\n");

while (1) {
    my $connection = $server->accept;
    if (fork() == 0) {
        print "** New connection received **\n";
        $connection->autoflush(1);
        my $count = 1;
        while (my $line = <$connection>) {
            if ($line){
                chomp($line);
                $connection->print($count . ' -> ' . $line . "\n"); # Sent response back to client, \n terminates
                print "Received and replied to $count '$line'\n";
                $count++;
            }
        }
        close $connection;
        exit;
    }
} 
```

客户：

```
#!/usr/bin/perl -w

use strict;

use IO::Socket::UNIX qw( SOCK_STREAM );

my $SOCK_PATH = '/tmp/test.sock';

my $client = IO::Socket::UNIX->new(
   Type => SOCK_STREAM(),
   Peer => $SOCK_PATH
)
   or die("Can't connect to server: $!\n");

$client->autoflush(1);

## Listen for replies
if (fork() == 0) {
    while (my $line = <$client>) {
        if ($line){
            chomp($line);
            print("Recv: '" . $line . "'\n");
        }
    }
}

## Send something
for my $itm ('Alpha','Beta','Gamma','Delta'){
    print("Send: " . $itm . "\n");
    print($client $itm . "\n") or warn("Can't send: $!\n"); # send to server, \n terminates
}

print "** Client Finished **\n"; 
```

# ios - changing a UITableView's frame in a UINavigationController after the view is loaded

> ID：14947579
> 
> 赞同：0
> 
> 时间：2013-02-19T00:02:38.113
> 
> 标签：ios, cocoa-touch, uitableview

I am trying to change the frame size and position for two UITableViews that are inside a UIViewController that is the rootviewcontroller for UINavigationController.

I want the frame size to change upon a user action. I have everything set up and the following code is executing upon the user's action:

```
CGRect firstTableFrame = [myTableView frame];
firstTableFrame.size.height = 290;  
[self.myTableView setFrame:firstTableFrame];
NSLog(@"%f",self.myTableView.frame.size.height);
[self.myTableView reloadData]; 
```

I can confirm that the NSLog outputs 290\. However, nothing on screen changes. I found one answer on here that I thought might solve it (unchecking autolayout) for the .xib file but this results in all sorts of other layout issues with my .xib when I run it.

Is there a way to solve this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T07:30:17.283

我可以通过转到视图控制器的 .xib 文件并在“文件检查器”窗格中取消选中“使用自动布局”来解决此问题。取消选中时，约束被删除，我能够以编程方式调整框架的大小和重新定位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T02:35:22.750

这是因为导航控制器有一个视图，其中包含您要添加到其中的视图（您的表视图）。您必须适当地调整该视图的大小

# linux-kernel - 将 DMA 映射转换为虚拟地址

> ID：14947587
> 
> 赞同：2
> 
> 时间：2013-02-19T00:03:31.903
> 
> 标签：linux-kernel, linux-device-driver

我有一个有点不寻常的情况，我正在为以太网设备开发一个模拟模块。理想情况下，模拟层在寄存器集方面与真实硬件相同。我遇到的问题是硬件中的 DMA 寄存器加载了数据的 DMA 映射（物理）地址。我需要使用这些物理地址将数据从源设备上的 Tx 缓冲区复制到目标设备上的 Rx 缓冲区。要在模块代码中做到这一点，我需要指向虚拟内存的指针。我查看了 phys_to_virt() 并没有理解手册页中的这条评论：

```
This function does not handle bus mappings for DMA transfers. 
```

这是否意味着无法使用 phys_to_virt() 将通过 dma_map_single 检索到的物理地址转换回虚拟地址？还有其他方法可以完成这种转换吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T13:44:38.760

我对这个问题不太清楚，但如果您正在使用`"phys_to_virt()"`可能是总线上可用的地址不能被此功能转换为虚拟的原因。我不确定只是尝试`bus_to_virt(bus_addr);` [功能](https://stackoverflow.com/questions/5748492/is-there-any-api-for-determining-the-physical-address-from-virtual-address-in-li)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T17:37:37.360

没有任何通用方法可以将 DMA 地址映射到虚拟地址。dma_map_single() 函数可能正在对 IOMMU（例如 Intel x86 系统上的 VT-d）进行编程，这会导致 DMA 地址与原始物理或虚拟地址完全无关。然而，[这个演示文稿](http://www.linuxplumbersconf.org/2011/ocw/sessions/243)和链接的幻灯片提供了一种将模拟硬件模型连接到真实驱动程序的方法（基本上，使用虚拟化）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-10T16:39:31.193

尝试`dma_virt = virt_to_phys(bus_to_virt(dma_handle))`

它对我有用。它提供了与 . 映射的相同虚拟地址`dma_coherent_alloc()`。

# visual-studio-2010 - 构建游戏内编辑器，需要加载和保存方面的帮助

> ID：14947588
> 
> 赞同：0
> 
> 时间：2013-02-19T00:04:09.653
> 
> 标签：visual-studio-2010, xml-parsing, xna, save, methodaccessexception

我已经和一个小组一起做一个游戏项目已经有一段时间了，我们遇到了一个障碍。该游戏的特色之一是用户能够通过使用游戏内编辑器生成自己的关卡。编辑器会创建一个 Level 对象，该对象存储关卡的长度和宽度以及 Tile 对象的二维数组。我们已经成功实现了相机系统，并且可以毫无困难地一起编辑一个简单的概念关卡，但是成功保存关卡并稍后重新加载它的过程是一个困难的概念，我希望你们中的一个人可以提供一些指导以降低预期的功能。

在当前状态下，当用户按下“S”键时，我们的 LevelManager 类运行下面的 SaveLevel 方法：

```
 public static void SaveLevel()
    {
        XmlWriterSettings settings = new XmlWriterSettings();
        settings.Indent = true;

        using (XmlWriter writer = XmlWriter.Create("example.xml", settings))
        {
            IntermediateSerializer.Serialize(writer, CurrentLevel, null);
        }
    } 
```

它将我们的关卡 (CurrentLevel) 序列化为项目中的一个 XML 文件（在我们完成这个基本设置后，我们会担心保存到不同的文件。）我运行了程序，创建了一个小地图并保存了它，这是输出在生成的 XML 文件中：

```
 <?xml version="1.0" encoding="utf-8"?>
    <XnaContent>
      <Asset Type="LevelEditorPrototype.Level">
        <TileGrid>
          <Item>
            <Item Type="LevelEditorPrototype.TileFloor">
              <X>0</X>
              <Y>0</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FFFFFFFF</Tint>
            </Item>
            <Item Type="LevelEditorPrototype.TileBlock">
              <X>0</X>
              <Y>32</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FF0000FF</Tint>
            </Item>
            <Item Type="LevelEditorPrototype.TileVoid">
              <X>0</X>
              <Y>64</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FFFF0000</Tint>
            </Item>
            <Item Type="LevelEditorPrototype.TileFloor">
              <X>0</X>
              <Y>96</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FFFFFFFF</Tint>
            </Item>
          </Item>
          <Item>
            <Item Type="LevelEditorPrototype.TileVoid">
              <X>32</X>
              <Y>0</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FFFF0000</Tint>
            </Item>
            <Item Type="LevelEditorPrototype.TileFloor">
              <X>32</X>
              <Y>32</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FFFFFFFF</Tint>
            </Item>
            <Item Type="LevelEditorPrototype.TileBlock">
              <X>32</X>
              <Y>64</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FF0000FF</Tint>
            </Item>
            <Item Type="LevelEditorPrototype.TileVoid">
              <X>32</X>
              <Y>96</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FFFF0000</Tint>
            </Item>
          </Item>
          <Item>
            <Item Type="LevelEditorPrototype.TileBlock">
              <X>64</X>
              <Y>0</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FF0000FF</Tint>
            </Item>
            <Item Type="LevelEditorPrototype.TileVoid">
              <X>64</X>
              <Y>32</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FFFF0000</Tint>
            </Item>
            <Item Type="LevelEditorPrototype.TileFloor">
              <X>64</X>
              <Y>64</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FFFFFFFF</Tint>
            </Item>
            <Item Type="LevelEditorPrototype.TileBlock">
              <X>64</X>
              <Y>96</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FF0000FF</Tint>
            </Item>
          </Item>
          <Item>
            <Item Type="LevelEditorPrototype.TileFloor">
              <X>96</X>
              <Y>0</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FFFFFFFF</Tint>
            </Item>
            <Item Type="LevelEditorPrototype.TileBlock">
              <X>96</X>
              <Y>32</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FF0000FF</Tint>
            </Item>
            <Item Type="LevelEditorPrototype.TileVoid">
              <X>96</X>
              <Y>64</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FFFF0000</Tint>
            </Item>
            <Item Type="LevelEditorPrototype.TileFloor">
              <X>96</X>
              <Y>96</Y>
              <Width>32</Width>
              <Height>32</Height>
              <Origin>0 0</Origin>
              <Depth>0</Depth>
              <Tint>FFFFFFFF</Tint>
            </Item>
          </Item>
        </TileGrid>
      </Asset>
    </XnaContent> 
```

所以至少我们确实有关于在关卡中生成的图块的数据信息，所以这就是一些东西。我们希望我们的用户也能够在运行时加载保存的关卡，因此我们映射了“L”键来加载保存的 XML 文件，这就是问题出现的地方。我们的阅读看起来像这样：

```
 public static void LoadLevel()
    {
        using (FileStream stream = new FileStream("example.xml", FileMode.Open))
        {
            using (XmlReader reader = XmlReader.Create(stream))
            {

                currentLevel = IntermediateSerializer.Deserialize<Level>(reader, null);
            }
        }
    } 
```

当我们尝试测试该功能时，我们会收到以下错误：

```
 System.MethodAccessException was unhandled
      HResult=-2146233072
      Message=Attempt by method 'DynamicClass.ReflectionEmitUtils(System.Object, System.Object)' to access method 'DynamicClass.ReflectionEmitUtils(System.Object, System.Object)' failed. 
```

我暗中怀疑 IntermediateSerializer 并不能完全按照我们希望的方式工作，但我不确定如何有效地解析和存储数据。我应该在这里使用不同的设置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T10:15:49.207

根据我的经验，100% 确定保存和加载基于磁贴的关卡的最有效方法是使用 BinaryWriter 和 BinaryReader。

不过，我们的关卡结构与你们的有很大不同；我们有很多层。每个层都使用一个tileset，并由Tile 的实例组成。Tile 保存它的位置（Vector2D）和一个 TileId（tileset-texture 中的 tile 的索引）。

我们在关卡中放置对象的方式是使用加载时被真实对象替换的图块集。

无论如何，保存和加载数据的适当通用方法是让您的类有一个可以将 BinaryReader 作为参数的构造函数，以及将自身写入 BinaryWriter 的方法。

像这样：

```
public Tile(BinaryReader reader)
{
    Position.X = reader.ReadFloat();
    Position.Y = reader.ReadFloat();
    TileId = reader.ReadInt32();
}

public void WriteToStream(BinaryWriter writer)
{
    writer.Write(Position.X);
    writer.Write(Position.Y);
    writer.Write(TileId);
} 
```

如果您只有一个类要加载，那么您可以简单地：

加载：

```
var tiles = new List<Tile>();
var reader = new BinaryReader(File.Open("level.bin"));

while (reader.BaseStream.Position < reader.BaseStream.Length)
{
    var tile = new Tile(reader);
    tiles.Add(tile);
}
reader.Close(); 
```

为了节省：

```
var tiles; //lets pretend this is the level
var writer = new BinaryWriter(File.Create("level.bin"));

foreach (var tile in tiles)
{
    tile.WriteToStream(writer);
}

writer.Flush(); //IMPORTANT!!!
writer.Close(); 
```

但是，如果您的列表包含不同类型的项目，则还需要存储该类型。一种非常通用的方法是插入：

```
writer.Write(tile.GetType().FullName); 
```

在 tile.WriteToStream(writer); 之前

然后在加载时您需要：

```
var tileType = Type.GetType(reader.ReadString()); //Read the type from the stream
var constructor = tileType.GetConstructor(new [] { typeof(BinaryReader)}); //get a constructor that can use a binaryreader
var tile = constructor.Invoke(new [] { reader }); //use said constructor to create an instance 
```

希望这可以帮助。请注意，我是在内存不足的情况下写的，所以很可能有语法错误....

# git - github remotes/origin prefixes

> ID：14947589
> 
> 赞同：0
> 
> 时间：2013-02-19T00:04:14.760
> 
> 标签：git, branch, git-remote

I noticed that, for some reason, some of my git branches are prefixed with "remotes/origin":

```
BZ9
 * master   
 remotes/origin/BZ8   
 remotes/origin/BZ9   
 remotes/origin/HEAD -> origin/master   
 remotes/origin/junit1   
 remotes/origin/master 
```

What is the difference between, for example, the "remotes/origin/BZ9" branch and the BZ9 branch? Clearly, they both originate from the same conceptual branch, but git is considering them to be distinct.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T02:40:03.840

在您的列表中，“BZ9”和“master”都是您可以自由移动更新和删除的本地分支。当您在其中一个分支上执行提交时，分支会更新以指向您的最新提交。

但是，当您键入时显示的远程/来源前缀名称`git branch -a`就像分支一样，但您可以将它们视为“只读”。这些分支不是您直接控制的，它们会在您获取时自动设置，并且在您再次获取（或拉取）之前它们不会改变。

这是因为与跟踪本地开发的本地分支不同，remote/origin 分支跟踪您从中提取的服务器上的远程开发（“origin”）。

例如，“remotes/origin/junit1”是说：“最后一次 git 从远程源 repo 获取，那里有一个名为 junit1 的分支，它指向这个提交哈希”。

您可以像其他任何分支一样签出该远程分支，但是当您提交到该分支时，分支指针不会更新，因为它不是要跟踪您的本地进度，而是要跟踪远程仓库的进度。

您的本地进度由您的本地分支机构跟踪，您可以根据需要自由创建、更新、删除。

同样，如果其他人从您的存储库中克隆，那么当他们从您那里获取时，他们会从您那里获得两个远程分支：“remotes/origin/BZ9”和“remotes/origin/master”。换句话说，您的本地分支成为您下游某人的远程/原始分支。

这就是你所有的远程/源分支，它们是你上游仓库本地分支的只读副本。

# c# - 使用 XDocument 写入 XML，但知道在哪里写入

> ID：14947590
> 
> 赞同：6
> 
> 时间：2013-02-19T00:04:19.610
> 
> 标签：c#, xml, winforms, linq, linq-to-xml

希望你能帮助我一点。我正在尝试写入 XML 文件，但正在努力编写写入 XML 文件的方法。这是手动编写的 XML 文件（使用 Notepad++ 等）：

```
<software>
    <software_entry
    name="Adobe Acrobat X Standard"
    path="Applications\Acrobat\Acrobat X Standard\AcroStan.msi" 
    type="msi"
    switches="/qn ALLUSERS=1"
    />

    <software_entry
    name="Adobe Acrobat X Professional"
    path="Applications\Acrobat\Acrobat X Pro\AcroPro.msi"
    type="msi"
    switches="/qn ALLUSERS=1"
    />
</software> 
```

应用程序这一部分的目的是使用 GUI 编写它。

在应用程序中，用户选择 XML 文件的名称。然后将其保存在临时文件夹中，直到在该过程中进一步询问用户要将其保存在何处。输入所需的文件名称并单击“创建”后，运行名为“createAndLoadXML”的方法。顾名思义，它创建并加载一个 XML 文件（以在表单上填充列表视图控件）。代码可以在下面看到。

```
private void createAndLoadXML()
{
    // Method to create XML file based on name entered by user
    string tempPath = Path.GetTempPath();
    string configFileName = fileNameTextBox.Text;
    string configPath = tempPath + configFileName + ".xml";
    // Create XDocument
    XDocument document = new XDocument(
        new XDeclaration("1.0", "utf8", "yes"),
        new XComment("This XML file defines the software selections for use with the Software Installer"),
        new XComment("XML file generated by Software Installer"),
        new XElement("software",
            new XElement("software_entry",
                new XAttribute("name", ""),
                new XAttribute("path", ""),
                new XAttribute("type", ""),
                new XAttribute("switches", ""))
                )
        );
    document.Save(configPath);
    configCreateLabel.Visible = true;
    document = XDocument.Load(configPath);
} 
```

现在，这个表单的下方是 4 个用于用户输入的文本框，每个文本框都与创建的属性（名称、路径、类型和开关）有关。想法是用户将在这些文本框中输入内容，单击“添加”按钮，然后程序会将这 4 个字段作为属性写入此 XML 文件。到目前为止，我有这段代码，它非常不完整，甚至没有使用 LINQ to XML。

```
private void writeToXML()
{
    // Method to write lines to XML file based on user input
    // Sets string variables
    string fileName = softwareNameTextBox.Text;
    string filePath = filePathTextBox.Text;
    string fileType = installerType.Text.ToString();
    string installSwitches = installSwitchesTextBox.Text;
    using (XmlWriter xw = XmlWriter.Load(configPath)) //This line is wrong, I know
    {
        xw.WriteStartElement("software");
        xw.WriteElementString("name", fileName);
        xw.WriteElementString("path", filePath);
        xw.WriteElementString("type", fileType);
        xw.WriteElementString("switches", installSwitches);
        xw.WriteEndElement();
    }
} 
```

基本上，任何人都可以帮助我使用上述将用户输入文本框控件的数据写入 XML 的方法吗？我不确定如何加载先前创建的 XML 文档（通过我的 createAndLoadXML 方法），以及如何使用 LINQ to XML 在根元素（软件）中进行编写。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-19T00:51:04.410

试试这个。我认为这应该会得到你想要的，假设 XML 事先存在，因为你`createAndLoadXML`在这个方法之前调用。我是用 NotePad++ 写的，所以我可能有一两个错误。

```
private void writeToXML()
{
    // Method to write lines to XML file based on user input
    // Sets string variables
    string fileName = softwareNameTextBox.Text;
    string filePath = filePathTextBox.Text;
    string fileType = installerType.Text.ToString();
    string installSwitches = installSwitchesTextBox.Text;

    string FILE_PATH = "bla.xml";

    XDocument xDoc = XDocument.Load(FILE_PATH);

    xDoc.Root.Add(new XElement("software_entry",
                    new XAttribute("name", fileName),
                    new XAttribute("path", filePath),
                    new XAttribute("type", fileType),
                    new XAttribute("switches", installSwitches)
                ));
    xDoc.Save(FILE_PATH);
} 
```

# javascript - 使用 JavaScript 在 TextArea 中检测自动缩进

> ID：14947596
> 
> 赞同：1
> 
> 时间：2013-02-19T00:05:24.543
> 
> 标签：javascript, html

我有一个文本区域，用户可以在其中输入文本。

如果当前行以 3 个空格开头并且用户按回车键，它将自动插入 3 个空格并将光标设置在空格之后。（前后可能有文字）

如何使用 JavaScript 检测这种模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T01:04:30.180

[textarea 中的插入符号位置，从一开始的字符中](https://stackoverflow.com/questions/263743/how-to-get-caret-position-in-textarea)解释了如何确定用户按 Enter 键时插入符号的位置，以便您可以检查左侧是否有三个空格和一个换行符。

[在 textarea 中输入键](https://stackoverflow.com/questions/2099661/enter-key-in-textarea)解释了如何检测textarea`Enter`中的键并采取行动。

一旦你连接了一个监听器并知道插入符号的位置`caret`，你可以做类似的事情

```
if (/(?:^|[\r\n])   (?:[^\r\n ][^\r\n]*)?$/
    .test(myTextArea.value.substring(0, caret)) {
  ...
} 
```

当当前行的开头正好有三个空格时采取行动。

要插入 3 个额外的空格，您可以执行类似的操作

```
myTextArea.value = myTextArea.value.substring(0, caret)
    + "\n    " + myTextArea.value.substring(caret); 
```

# javascript - 如何处理仅由一个功能使用的功能

> ID：14947598
> 
> 赞同：0
> 
> 时间：2013-02-19T00:05:42.573
> 
> 标签：javascript, function, language-agnostic

当一个函数调用一个或多个其他函数，并且这些被调用的函数只被一个调用函数使用时，代码应该如何构造？

例如，如果您有`funcB()`并且`funcC()`仅由`funcA()`应该调用`funcB()`并且`funcC()`是匿名函数或嵌套函数，或者如果它们是类的一部分，它们是否应该简单地声明为私有或放置在内部类中？

我目前正在使用 JavaScript，但在使用 C++ 和 Java 等其他语言时遇到了同样的情况。

根据[维基百科](http://en.wikipedia.org/wiki/Nested_function#Languages)， JavaScript 确实有嵌套函数，虽然我从未见过它使用过？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:11:57.890

如果`funcB()`并且`funcC()`在概念上没有意义，`funcA()`那么你不应该公开。

传统的 OOP 会说您应该将它们设为私有。

我认为几乎总是有另一个概念属于哪个`funcB()`概念`funcC()`。您应该将它们设为不同类的公共方法。任何持有者都`funcA()`持有该类的私有实例。

在抽象地谈论 A、B 和 C 时，很难为此提出令人信服的理由。但我想说，如果它们在概念上不属于，`funcA()`那么它们在概念上确实属于其他东西。如果你同意这个前提并且同意组合比继承更好，那么结论就是让它们在其他类上公开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T00:48:31.183

当我开始一个项目时，我倾向于避免封装功能，直到事情变得稳定。

正如 Dancrumb 指出的那样，函数调用不是免费的，因此您可能需要进行一些小的重构。但是，当您查看几个月未接触过的代码时，那个干净整洁的组织将对您的心理健康有益。当你在一个团队中工作时，这会成倍地真实:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T00:19:43.953

这里有很多方法。

Javascript 支持可以在代码中的任何位置定义和分配给变量的匿名函数。

因此，您可以编写：

```
function foo() {
  var bar = function() { /* some code */ };

  bar();
} 
```

并且`bar`不会在其他任何地方可用。这对于封装功能*可能*很有用，但我认为这不是一个非常可扩展的开发模型。

有一种观点认为，任何只被调用一次的函数在未来都可能成为值得多次调用的东西。在这种情况下，您*可以*创建“私有”函数：

```
var Foo = (function() {

  var Foo = function() {
    /* some constructor code */
  };

  var private = function() { /* a private function */ };

  Foo.prototype.public = function() {
    private();
    /* And some other stuff */
  };

  return Foo;

})();

var foo = new Foo();
foo.public(); /* Includes a call to the private method */ 
```

在这种情况下，您的`private`方法是真正私有的，因此您不必将内部工作原理暴露给世界。

但实际上，这更多的是关于如何实现访问修改的讨论。有很多信息可以回答这个问题。更大的设计问题是是否实现单独的功能，或者是否只是内联它们。

我的选择通常是将有凝聚力的功能块塞进……嗯，塞进函数中。函数调用的成本是非零的，但*事后*担心......如果您确定函数调用是性能瓶颈，那么您可以担心是否调用过多以及是否应该重构您的代码使用更少的调用。

在那之前，编写你的函数，调用它们并陶醉于清晰的代码。只要确保你使用好的方法名:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T01:03:04.337

如果 funcB 和 funcC 在您的类中创建为闭包，并且您没有将它们“公开”到接口，那么它们可以更改（被删除、添加、返回不同的值等）而不必担心它们如何已经在课堂之外实施。

一旦他们暴露出来，所有的赌注都被取消了，他们可能需要进行单元测试、支持等。这是一个众所周知的规则。

闭包只是在将要使用的范围内声明的函数。

方法A

```
function MyClass(){

    function funcA(i){
        funcB(i);
        funcC(i);
    }
    function funcB(i){
        //...
    }
    function funcC(i){
        //...
    }
    return {funcA:funcA}
}
va mc = new MyClass()
for(var i = 0;i<100000;i++){    
    mc.funcA(i);
} 
```

方法B：

```
function MyClass(){
    function funcA(){
        function funcB(){
        }
        function funcC(){
        }
        for(var i = 0;i<100000;i++){
            funcB();
            funcC();
        }
        // funcB, funcC are created before and then released after this
    }
    return {funcA:funcA}
}
va mc = new MyClass()
mc.funcA(); 
```

当 funcA 被多次调用时，方法 B 可能不太受欢迎，因为分配最昂贵。

考虑内存时，可能首选方法 B。虽然这值得商榷，因为 funcA 和 funcB 都驻留在 MyClass 和 MyClass.funcA 中。

# clojure - 为什么我的 Ring 中间件在请求中看不到 :params 映射？

> ID：14947600
> 
> 赞同：2
> 
> 时间：2013-02-19T00:05:49.363
> 
> 标签：clojure, compojure, ring

我正在编写一个`Ring`中间件，并且还使用`Compojure`. 我希望我的中间件查看 :params 映射以查看用户是否提供了特定密钥。不过，在我的中间件函数中，请求映射不包含 :params 映射。在最终的请求处理程序中，有一个`:params`映射。我在想`:params`地图没有在我的自定义中间件之前设置，但我不知道如何让它实际设置。

有任何想法吗？

```
(ns localshop.handler
  (:use [ring.middleware.format-response :only [wrap-restful-response]]
        [compojure.core])
  (:require [localshop.routes.api.items :as routes-api-items]
            [localshop.middleware.authorization :as authorization]
            [compojure.handler :as handler]))

;; map the route handlers
(defroutes app-routes
  (context "/api/item" [] routes-api-items/routes))

;; define the ring application
(def app
  (-> (handler/api app-routes)
      (authorization/require-access-token)
      (wrap-restful-response))) 
```

上面是我的 handler.clj 文件，下面是中间件本身。

```
(ns localshop.middleware.authorization)

(defn require-access-token [handler]
  (fn [request]
    (if (get-in request [:params :token])
      (handler request)
      {:status 403 :body "No access token provided"}))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T02:36:02.300

我实际上想通了这一点。如果您调整`(def app ... )`代码部分以使其与以下内容匹配，则此方法有效：

```
(def app
  (-> app-routes
      (wrap-restful-response)
      (authorization/require-access-token)
      (handler/api))) 
```

# php - 设置动态音频播放列表

> ID：14947604
> 
> 赞同：1
> 
> 时间：2013-02-19T00:06:31.027
> 
> 标签：php, html, mp3, media-player

我正在使用 HTML5 音频播放器（扬声器）。我已经创建了一个动态创建播放列表的函数，但是我不确定一旦创建了播放列表如何实现它。这似乎是有更多经验的人可能认为理所当然的事情。我希望是这样。

创建播放列表。查看。

```
 <?php $playlist= "{\"playlist\": [";?>
    <?php foreach ($items as $item){
        $titlemetadata= metadata($item, array('Dublin Core', 'Title'));
            foreach($item->Files as $file) {
                // print_r($file);
                $sourcemetadata= metadata($file, 'uri');
                $imagemetadata= metadata($file, 'thumbnail_uri');
                if (strpos($file["filename"], 'mp3') !== false) {
                    $playlist .=
                    "\"0\": {\"src\":\"$sourcemetadata\", \"type\":\"audio/mp3\"}, 
                    \"config\": 
                    {\"title\": \"$titlemetadata\",
                    \"poster\": \"$imagemetadata\"}";
                }
            }       
    }?>
    <?php $playlist .= "]}";?>
    <?php echo $playlist;?> 
```

实施播放列表？没有。

`<audio class="projekktor speakker dark"> <source src= ??THE PLAYLIST?? type="application/json"/> </audio>`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T23:10:34.857

我搞定了。这是一个解决方案：

```
<?php $collections=get_records("collection", array("public"=>"true","featured"=>"true"));
  $current_collection=end($collections);
  $items=get_records("item", array("collection"=>$current_collection));

  $playlist= "[";
  foreach ($items as $item){
    $titlemetadata= metadata($item, array("Dublin Core", "Title"));
        foreach($item->Files as $file) {
            $sourcemetadata= metadata($file, "uri");
            $imagemetadata= metadata($file, "thumbnail_uri");
            if (strpos($file["filename"], "mp3") !== false) {
                $playlist .=
                "{\"0\": {\"src\":\"$sourcemetadata\", \"type\":\"audio/mp3\"}, 
                \"config\": 
                {\"title\": \"$titlemetadata\",
                \"poster\": \"$imagemetadata\"}},";
            }
        }       
   }
   $playlist .= "]";?>
<?php 
    $string = '$(document).ready(function() {projekktor(".projekktor").setFile(' . $playlist . ');});';
queue_js_string($string);?> 
```

# r - ggplot2 lm lines with categorical variables

> ID：14947608
> 
> 赞同：1
> 
> 时间：2013-02-19T00:06:47.580
> 
> 标签：r, ggplot2

I have some data from a R course class. The professor was adding each line kind of manually using base graphics. I'd like to do it using `ggplot2`.

So far I've created a `facet`'d plot in `ggplot` with `scatter plots` of `hunger` in different regions and also separately fitted a model to the data. The specific model has interaction terms between the `x` variable in the plot and the `group/colour` variable.

What I want to do now is **plot the lines resulting for that model one per panel**. I could do this by using `geom_abline` and defining the `slope` and the `intercept` as the sum of 2 of the coefficients (as the categorical variables for group have 0/1 values and in each panel only some values are multiplied by 1) - but this seems not easy.

I tried the same equation I used in lm in `stat_smooth` with no luck, I get an error.

Ideally, I'd think one can put the equation somehow into the `stat_smooth` and have `ggplot` do all the work. How would one go about it?

```
download.file("https://sparkpublic.s3.amazonaws.com/dataanalysis/hunger.csv", 
                  "hunger.csv", method = "curl")
hunger <- read.csv("hunger.csv")
hunger <- hunger[hunger$Sex!="Both sexes",]
hunger_small <- hunger[hunger$WHO.region!="WHO Non Members",c(5,6,8)]
q<- qplot(x = Year, y = Numeric, data = hunger_small, 
            color = WHO.region) + theme(legend.position = "bottom")
q <- q + facet_grid(.~WHO.region)+guides(col=guide_legend(nrow=2))
q

 # I could add the standard lm line from stat_smooth, but I dont want that
 #  q <- q + geom_smooth(method="lm",se=F)

#I want to add the line(s) from the lm fit below, it is really one line per panel
lmRegion <- lm(hunger$Numeric ~ hunger$Year + hunger$WHO.region + 
                  hunger$Year *hunger$WHO.region)

# I also used a loop to do it, as below, but all in one panel
# I am not able to do that
# with facets, I used a function I found to get the colors 

ggplotColours <- function(n=6, h=c(0, 360) +15) {
  if ((diff(h)%%360) < 1) h[2] <- h[2] - 360/n
  hcl(h = (seq(h[1], h[2], length = n)), c = 100, l = 65)
}

n <- length(levels(hunger_small$WHO.region))
q <- qplot(x = Year, y = Numeric, data = hunger_small, 
         color = WHO.region) + theme(legend.position = "bottom")
q <- q + geom_abline(intercept = lmRegion$coefficients[1], 
         slope = lmRegion$coefficients[2], color = ggplotColours(n=n)[1])
for (i in 2:n) {
  q <- q +  geom_abline(intercept = lmRegion$coefficients[1] + 
            lmRegion$coefficients[1+i], slope = lmRegion$coefficients[2] + 
              lmRegion$coefficients[7+i], color = ggplotColours(n=n)[i])
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-09T02:52:40.753

如果您有一个分类数据：

```
geom_point() 
```

不管用，

```
geom_boxplot() 
```

将工作。

```
ggplot(hunger, aes(x = sex, y = hunger)) + geom_boxplot() + labs(x="sex") + geom_smooth(method = "lm",se=FALSE, col = "blue"). Susy 
```

# java - How to destroy a thread in Java

> ID：14947612
> 
> 赞同：2
> 
> 时间：2013-02-19T00:07:08.767
> 
> 标签：java, eclipse, multithreading, sockets, runnable

I'm writing a client/server application in Java using sockets. In the server, I have a thread that accepts client connections, this thread runs indefinitely. At some point in my application, I want to stop accepting client connection, so I guess destroying that thread is the only way. Can anybody tell me how to destroy a thread?

Here's my code:

```
class ClientConnectionThread implements Runnable {

    @Override
    public void run() {
        try {
            // Set up a server to listen at port 2901
            server = new ServerSocket(2901);

            // Keep on running and accept client connections
            while(true) {
                // Wait for a client to connect
                Socket client = server.accept();
                addClient(client.getInetAddress().getHostName(), client);

                // Start a new client reader thread for that socket
                new Thread(new ClientReaderThread(client)).start();
            }
        } catch (IOException e) {
            showError("Could not set up server on port 2901\. Application will terminate now.");
            System.exit(0);
        }
    }
} 
```

As you can see, I have an infinite loop while(true) in there, so this thread will never stop unless somehow I stop it.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T00:08:33.443

The right way to do this would be to close the server socket. This will cause the `accept()` to throw an `IOException` which you can handle and quit the thread.

I'd add a `public void stop()` method and make the socket a field in the class.

```
private ServerSocket serverSocket;

public ClientConnectionThread() {
    this.serverSocket = new ServerSocket(2901);
}
...
public void stop() {
    serverSocket.close();
}
public void run() {
     while(true) {
         // this will throw when the socket is closed by the stop() method
         Socket client = server.accept();
         ...
     }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T00:15:00.213

一般你不会。您要求它使用`Thread.interrupt()`.

[Javadoc](http://java.sun.com/j2se/1.5.0/docs/guide/misc/threadPrimitiveDeprecation.html)中有一个很好的解释。

从链接：

> 停止的大多数用法应该由简单地修改一些变量以指示目标线程应该停止运行的代码替换。目标线程应该定期检查这个变量，如果变量指示它要停止运行，则以有序的方式从它的run方法返回。（这是 Java 教程一直推荐的方法。）为了确保停止请求的及时通信，变量必须是 volatile 的（或者对变量的访问必须是同步的）。

应该注意的是，在等待线程不响应的所有情况下`Thread.interrupt`，它也不会响应`Thread.stop`。

对于您的具体情况，您将不得不致电`serverSocket.close`，因为它不会响应`Thread.interrupt`。

# asp.net-mvc - MVC 4 - 脚手架 - 为什么我的 1:1 和 1:M 属性被跳过？

> ID：14947615
> 
> 赞同：2
> 
> 时间：2013-02-19T00:07:35.317
> 
> 标签：asp.net-mvc, entity-framework, asp.net-mvc-4, scaffolding

我对 MVC 4 很陌生，我有以下课程：

```
public class BicycleSellerListing
{
    public int BicycleSellerListingId { get; set; }
    public UserProfile UserProfile { get; set; }
    public System.DateTimeOffset ListingDate { get; set; }
    public double ListingPrice { get; set; }
    public string BicycleModel { get; set; }
    public string Color { get; set; }
    public string Comments { get; set; }
    public BicycleManufacturer BicycleManfacturer { get; set; }
    public BicycleType BicycleType { get; set; }
    public BicycleFrameSize BicycleFrameSize { get; set; }
    public DateTime ModelYear { get; set; }
    public ICollection<BicycleAttribute> BicycleAttributeList { get; set; }
} 
```

当我为这个类创建一个新的控制器时，我使用实体框架脚手架选项选择了**具有读/写操作和视图的 MVC 控制器。**在 Create.cshtml 中，它跳过了为我的所有 1:1 和 1:M 属性（BicycleManufacturer、BicycleType 等）创建编辑器。理想情况下，我希望 VS 为这些属性创建下拉列表编辑器。

是否可以为这些属性创建编辑器，还是我需要手动完成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T06:19:30.963

复杂的对象需要一些帮助。值得庆幸的是，这并不难做到，而且 MVC 框架在这方面是完全可定制的。

您要做的第一件事是创建视图来处理编辑和显示。这些位于 Views\Shared 下的 Editor 和 Display 模板文件夹中。

> [https://github.com/MisterJames/BootstrappingMvc/tree/master/BootstrappingMvc/Views/Shared](https://github.com/MisterJames/BootstrappingMvc/tree/master/BootstrappingMvc/Views/Shared)

接下来，您需要在视图模型上装饰您的属性，`UIHint`以告诉 MVC 使用哪些视图。

> [https://github.com/MisterJames/BootstrappingMvc/blob/master/BootstrappingMvc/Models/MoviePass.cs](https://github.com/MisterJames/BootstrappingMvc/blob/master/BootstrappingMvc/Models/MoviePass.cs)

这将有助于照顾您的 1:1。你会想看看像 MvcScaffolding 这样的东西来处理你的列表项，它做得很好

这里有一个完整的演练：

> [http://jameschambers.com/2012/07/bootstrapping-mvc-say-no-to-checkboxes/](http://jameschambers.com/2012/07/bootstrapping-mvc-say-no-to-checkboxes/)

干杯。

# sql - SQL Server 变更日志创建、标识语法和无效列

> ID：14947617
> 
> 赞同：1
> 
> 时间：2013-02-19T00:08:02.607
> 
> 标签：sql, sql-server, tsql, database-design, triggers

我目前正在创建一个 SQL Server 触发器，它在更新后应该填充一个更改日志，其中包含所做的任何工资更改以及由哪个用户更改。

我制作的应该接收更新的变更日志表可以在这里看到：

```
CREATE TABLE ChangeLog
(
ChangeID int identity(1,1) primary key,
EmpID int,
[User] nvarchar(30),
[Date] smalldatetime,
OldRate money,
NewRate money
) 
```

据我所知，表的一切都很好，但是当我去创建触发器时，我开始收到一些错误（以及一大堆混乱。）我已经尝试研究几种做触发器的方法用新行更新不同的表，据我所知，它的结构是正确的，但是我不确定我是如何弄乱内容的。

```
CREATE TRIGGER payrate_change ON Employees FOR UPDATE
As
DECLARE @originalPay VARCHAR(100)
DECLARE @newPay VARCHAR(100)
If UPDATE (PayRate)
BEGIN
SELECT @originalPay = (SELECT PayRate FROM deleted)
SELECT @newPay = (SELECT PayRate FROM inserted)
INSERT INTO [dbo].[ChangeLog]
        (ChangeID, EmpID, [User], [Date], OldRate, NewRate)
    VALUES
        identity(1,1), 
        Employees.EmployeeID, 
        SUSER_SNAME(), 
        SYSDATETIME(), 
        @originalPay, 
        @newPay
    FROM inserted
END 
```

两个 select 语句的 payrate 部分给出了一个错误，指出它们是无效的列，即使它上面的两行调用 PayRate 就好了。然后对于 Insert Into 语句的值部分，尽管我在创建表时以完全相同的方式使用它，但 identity 声称语法不正确。

有人对此触发器可能存在什么问题有任何想法吗？任何投入将不胜感激。

编辑：

在下面建议的更改之后，我将 ChangeID（主键）重新添加到触发器中，但是现在 IDENTITY 给了我一个不正确的语法错误：

```
CREATE TRIGGER payrate_change ON Employees FOR UPDATE
As

If UPDATE (PayRate)
BEGIN

INSERT INTO [dbo].[ChangeLog]
        (ChangeID, EmpID, [User], [Date], OldRate, NewRate)
    select
        IDENTITY(1,1),
        i.EmployeeID, 
        SUSER_SNAME(), 
        SYSDATETIME(), 
        d.PayRate, 
        i.PayRate
    FROM inserted i
    JOIN deleted d on i.EmployeeID = d.deleted
END 
```

EDIT2：为有兴趣的人添加最终结果：

```
CREATE TRIGGER payrate_change2 ON Employees FOR UPDATE
AS

If UPDATE (Pay)
BEGIN

INSERT INTO [dbo].[ChangeLog]
        (EmpID, [User], [Date], OldRate, NewRate)
    select
        i.EmployeeID, 
        SUSER_SNAME(), 
        SYSDATETIME(), 
        d.Pay, 
        i.Pay
    FROM inserted i
    JOIN deleted d on i.EmployeeID = d.EmployeeID
END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:12:34.117

省略标识列，它将自行填充

您的触发器不处理多行更新，请查看[最佳实践：为多行操作编码 SQL Server 触发器](http://blogs.lessthandot.com/index.php/DataMgmt/DBProgramming/MSSQLServer/best-practice-coding-sql-server-triggers)

你可以JOIN删除和插入伪表，我假设EmployeeID是关键？

试试这个

```
CREATE TRIGGER payrate_change ON Employees FOR UPDATE
As

If UPDATE (PayRate)
BEGIN

INSERT INTO [dbo].[ChangeLog]
        (EmpID, [User], [Date], OldRate, NewRate)
    select
        i.EmployeeID, 
        SUSER_SNAME(), 
        SYSDATETIME(), 
        d.PayRate, 
        i.PayRate
    FROM inserted i
    JOIN deleted d on i.EmployeeID = d.deleted
END 
```

另外请注意，`If UPDATE (PayRate)`即使您执行类似的操作也会触发`SET PayRate = PayRate` 因此您可能想检查该值是否实际已更改，您可以在插入和删除之间的 JOIN 中添加它，并确保检查 NULLS

# verilog - Oring of outputs in Verilog

> ID：14947618
> 
> 赞同：2
> 
> 时间：2013-02-19T00:08:06.117
> 
> 标签：verilog

I have generated 15 modules using generate having `m[0:14]` outputs. I want to `or` them together. Will this work?

```
if (m == 1)begin
result = 1;
end 
```

Or, if not, then what is the optimum way to do it.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T00:33:51.007

您正在寻找 verilog 中的归约操作。

```
( |m ) = m[1] | m[2] | m[3] ... 
```

[http://www.ee.ed.ac.uk/~gerard/Teach/Verilog/manual/Operators/reduction.html](http://www.ee.ed.ac.uk/~gerard/Teach/Verilog/manual/Operators/reduction.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T00:33:41.687

`assign result = |m;`应该管用。The`|`是一元归约 or，它`or`是 m 的所有位在一起。

您所拥有的将不起作用，因为它将与 比较`m`，`'d1`如果 m 是 ，这将是正确的`000000000000001`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T11:32:31.050

请注意，这也将起作用：

```
if (m) result = 1; 
```

由于`|m`被隐式执行以将值转换为布尔值

# node.js - nodejs phantomjs bridge, to send form and to get results

> ID：14947621
> 
> 赞同：1
> 
> 时间：2013-02-19T00:08:21.743
> 
> 标签：node.js, phantomjs, bridge

I'm using node.js with phantomjs by phantomjs-node bridge. The question: I open a page, e with the page.evaluate function I fill a form and I submit it. Now I need to retrieve data from the page which have received form data, when this page is fully loaded. How should I do?

Thanks

The bridge: [https://github.com/sgentle/phantomjs-node](https://github.com/sgentle/phantomjs-node)

# javascript - Knockout.js 2.2.1 找不到可观察数组

> ID：14947628
> 
> 赞同：2
> 
> 时间：2013-02-19T00:08:51.917
> 
> 标签：javascript, mvvm, knockout.js, knockout-2.0

不知道这里出了什么问题，但是 KnockoutJS 在查找我的`MasterViewModel`. `2.2.1`与 jQuery 一起使用，`1.8.x`而不是我的第一个 KJS 应用程序。这里是：

**初始化**

```
$(function() {
  window.vm = new MasterViewModel();
  ko.applyBindings(vm);
}); 
```

**视图模型**

```
function MasterViewModel(data) {
  var self = this;
  self.currentAppView = ko.observable();

  // Users
  self.userList = ko.observableArray([]);
  self.templateListGetter = ko.computed(function() {
    $.getJSON("/user/list"), function(data) {
      var mapped = $.map(data, function(item) { return new userModel(item) });
      self.userList(mapped);
    };
  });

  self.goToAppView = function(appView) { 
    location.hash = '!/' + appView;
  };    
  Sammy(function() {
      this.get('#!/:appView', function() {
        self.currentAppView(this.params.appView);
        $('.appview').hide();
        ko.applyBindings(new window[this.params.appView+'VM']());
      });
      this.notFound = function(){
        location.hash = "!/dashboard";
      }
      //this.raise_errors = true;
  }).run();
} 
```

**风景**

```
 <table class="table table-bordered table-striped">
    <tbody data-bind="foreach: userList">
      <tr>
        <td data-bind="text: guid"></td>
        <td data-bind="text: firstName"></td>
        <td data-bind="text: lastName"></td>
        <td data-bind="text: email"></td>
        <td data-bind="text: updated"></td>
        <td data-bind="text: suspended"></td>
      </tr>
    </tbody>
  </table> 
```

我有一个正在加载的简单表格

即使在仔细检查了几件事（例如添加`defer="defer"`到我的 JS 标记并确保`userList`存在）之后，它也根本找不到 observableArray。它给出了错误：

```
Message: ReferenceError: userList is not defined;
Bindings value: foreach: userList Error {} 
```

有人知道发生了什么吗？

## 更新

对于那些想知道每次哈希更改时调用什么的人：

```
function usersVM() {
    // Data
    var self = this;
    // Behaviours
    $('#users').show();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:16:38.027

看起来您正在使用未定义的视图模型初始化淘汰赛？

`ko.applyBindings(new window[this.params.appView+'VM']());`，但您的实际视图模型是`window.vm`. 区分大小写ftw。此外，窗口上的视图模型已经创建/初始化。所以你不需要`new`运营商。

因此，将 applyBindings 行更改为

`ko.applyBindings(window[this.params.appView+'vm']());`

## 更新答案：通过海报

`ko.applyBindings`每次路由更改时都没有必要继续运行，因为它已经在页面加载时应用了绑定。所以 Sammy.js 被改为：

```
 Sammy(function() {
      this.get('#!/:appView', function() {
        self.currentAppView(this.params.appView);
        $('.appview').hide();
        window[this.params.appView+'Route']();
      });
      this.notFound = function(){
        location.hash = "!/dashboard";
      }
      //this.raise_errors = true;
  }).run(); 
```

它确实看起来`ko.computed`或常规函数调用`window.vm.getUserList()`没有正常运行，但这将被保存以用于不同的问题。

```
function usersRoute() {
    // Data
    var self = this;
    // Behaviours
    $('#users').show();
    window.vm.getUserList();
} 
```

# visual-studio - 使用发行说明 2.1 更改 NuGet 包的位置不起作用

> ID：14947629
> 
> 赞同：3
> 
> 时间：2013-02-19T00:09:03.247
> 
> 标签：visual-studio, visual-studio-2012, nuget, nuget-package

我正在尝试更改 NuGet 的默认包文件夹的位置

我阅读了许多帖子，包括[NuGet 2.1 Release Notes](http://docs.nuget.org/docs/release-notes/nuget-2.1#Specify_%E2%80%98packages%E2%80%99_Folder_Location)的文档，NuGet 2.1 版的新配置如下：

```
<configuration>
  <config>
    <add key=" repositoryPath" value=" C:\myteam\teampackages" />
  </config>
  ... 
</configuration> 
```

我还阅读了以下线程，[是否可以更改 NuGet 包的位置？](https://stackoverflow.com/questions/4092759/is-it-possible-to-change-the-location-of-packages-for-nuget)

**但是这个配置不行？**

唯一的配置工作是旧的，如下所示：

```
<settings>
  <repositoryPath>C:\myteam\teampackages</repositoryPath>
</settings> 
```

我正在使用包含 NuGet Package 2.1 版的 Visual Studio 2012 Update 1

重现步骤：

*   在解决方案目录中，创建一个文件“nuget.config”
*   编辑 nuget.config 并添加：

> <settings>
> <repositoryPath>C:\myteam\teampackages</repositoryPath>
> </settings>

*   删除默认包文件夹

*   在 Visual Studio 中，右键单击解决方案，然后选择管理 NuGet 包安装包（任何包）

*   验证包已下载到 *C:\myteam\teampackages*

*   删除*C:\myteam\teampackages中下载的包*

*   将 nuget.config 更改为以下内容：

> <configuration>
> <config>
> <add key="repositoryPath" value="C:\myteam\teampackages" />
> </config>
> </configuration>

尝试再次安装任何库。

我发现安装在包文件夹中的库不是我的文件夹？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T19:19:41.947

>>重现步骤：

>>在解决方案目录中，创建一个文件“nuget.config” 从发行说明中它按以下顺序查找 nuget.config .nuget\nuget.config 从项目 (.nuget) 文件夹递归遍历到根全局 nuget.config ( %appdata%\NuGet\nuget.config)

因此，如果 nuget.config 位于项目/解决方案文件夹中，它将不会被兑现。您可以尝试将其移动到 .nuget 文件夹并重新加载解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-02T10:10:03.523

当您在路径末尾放置 \ 时，它会起作用：

```
<add key=" repositoryPath" value="C:\myteam\teampackages\" /> 
```

# spring - Spring + Hibernate + H2 Embedded DB. How is the data saved?

> ID：14947633
> 
> 赞同：5
> 
> 时间：2013-02-19T00:09:28.387
> 
> 标签：spring, hibernate, spring-mvc, h2, embedded-database

Im new to embedded databases but I got it running at least. What confuses me is that my data is not saved between runs. I mean wouldn't that be nice for testing? I don't wanna add data to my database every time i run the application

So I searched for a way to do this and I found that I shall configure a hibernate connection URL which I tried like this

```
props.put("hibernate.connection.url", "jdbc:h2:~/test"); 
```

in my HibernateConfiguration.java. Without success though, no errors but also nothing saved, and I did not find that test file that should be created from that URL. (Running windows and checked my user folder)

I also saw that its possible to do like this

```
<jdbc:embedded-database id="dataSource" type="H2">
    <jdbc:script location="classpath:db-schema.sql"/>
    <jdbc:script location="classpath:db-test-data.sql"/>
</jdbc:embedded-database> 
```

And execute the scripts every time i run the application, but the thing is that I want hibernate to handle all the creating of tables etc.

How is this normally done?

I searched for some hours now but haven't still got it.

Ps. if it's needed i'll post all my configs.

**Edit:** Updated my question to contain focus on one question and included my configs.

HibernateConfiguration.java package com.courseinfo.project;

```
import java.util.Properties;

import javax.sql.DataSource;

import org.hibernate.dialect.H2Dialect;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.orm.hibernate3.HibernateTransactionManager;
import org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean;

import com.courseinfo.project.model.Course;

@Configuration
public class HibernateConfiguration {

    @Value("#{dataSource}")
    private DataSource dataSource;

    @Bean
    public AnnotationSessionFactoryBean sessionFactoryBean() {
        Properties props = new Properties();
        props.put("hibernate.dialect", H2Dialect.class.getName());
        props.put("hibernate.format_sql", "true");
        props.put("hibernate.connection.url", "jdbc:h2:~/test");

        AnnotationSessionFactoryBean bean = new AnnotationSessionFactoryBean();
        bean.setAnnotatedClasses(new Class[]{Course.class});        
        bean.setHibernateProperties(props);
        bean.setDataSource(this.dataSource);
        bean.setSchemaUpdate(true);
        return bean;
    }

    @Bean
    public HibernateTransactionManager transactionManager() {
        return new HibernateTransactionManager( sessionFactoryBean().getObject() );
    }

} 
```

servlet-context.xml where i only added the embedded database tag.

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/mvc"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:jdbc="http://www.springframework.org/schema/jdbc"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
        http://www.springframework.org/schema/jdbc
        http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd"
        default-lazy-init="true">

    <!-- DispatcherServlet Context: defines this servlet's request-processing infrastructure -->

    <!-- Enables the Spring MVC @Controller programming model -->
    <annotation-driven />

    <!-- Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources directory -->
    <resources mapping="/resources/**" location="/resources/" />

    <!-- Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory -->
    <beans:bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <beans:property name="prefix" value="/WEB-INF/views/" />
        <beans:property name="suffix" value=".jsp" />
    </beans:bean>

    <context:component-scan base-package="com.courseinfo.project" />

    <jdbc:embedded-database id="dataSource" type="H2"/>

</beans:beans> 
```

There of course also a pom where i got all dependencies but i don't think that is necessary.

I'm creating a object (Course.java) and saving that to the db, that's fine and i can load it again. But when I change my code and the application is reloaded the object doesn't exist anymore.

**Edit2**: I'm adding data like this.

Binding a session factory.

```
@Autowired
private SessionFactory sessionFactory; 
```

Adding a my Course object to the database like this.

```
Course course = new Course();
course.setCourseId("IDA512");
Session s = sessionFactory.openSession();
s.saveOrUpdate(course);
s.flush();
s.clear();
Course course2 = (Course) s.get(Course.class, "IDA511");
s.close(); 
```

This works fine and i can get that course. However, when I run the application next time there is no course with id IDA511 and i getting a null pointer exception. Does this mean that the course is only saved in the session maybe? hum

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-18T07:16:12.013

由于您在 Windows 上运行应用程序，因此使用波浪号“~”运算符可能找不到主目录。

尝试给你的 hibernate.connection.url 属性一个绝对路径，例如。“C:\test”并在您运行应用程序时签入该文件夹以查看 H2 是否为您创建了文件。

# iphone - HTML5 地理定位 iphone

> ID：14947639
> 
> 赞同：1
> 
> 时间：2013-02-19T00:09:54.690
> 
> 标签：iphone, html, geolocation, gps, geo

嘿人，

我写了一些东西来找到我的 iphone 的 gps 位置。如果找到我的位置，它应该在警报框中显示我的位置。

但显然它一遍又一遍地向我显示我的 iphone 上的警报框。

我已经编写了我的类，以便我可以设置一个回调函数。因为当您尝试获取您的位置时，直到您找到它才设置。

找到您的位置后，将执行回调函数。

谁能告诉我在我被发现后如何停止位置跟踪器？

我的课：

```
GPS = function() {
this.constructor();

}

var gpsLatitude = 0.0, gpsLongitude = 0.0, gpsCallback;

GPS.prototype.constructor = function(){ 
    this.getLocation();
}

 var afterNotification = function(){
    //Do something
};

GPS.prototype.setCallback = function(myfunction){ 
    gpsCallback = myfunction;
}

GPS.prototype.getLocation = function(){
    if (navigator.geolocation)
    {
        navigator.geolocation.getCurrentPosition(this.showPosition, this.showError);
    }
    else{
        Lungo.Notification.error(
                "Error",                      //Title
                "Your device doesnt support GPS",     //Description
                "cancel",                     //Icon
                7,                            //Time on screen
                afterNotification             //Callback function
            );
    }
  }

GPS.prototype.showPosition = function(position)
{
    gpsLatitude = position.coords.latitude;
    gpsLongitude = position.coords.longitude;
    gpsCallback();

}

GPS.prototype.getLatitude = function()
{
    return gpsLatitude; 
}

GPS.prototype.getLongitude = function()
{
    return gpsLongitude;    
}

GPS.prototype.showError = function(error)
  {
  switch(error.code) 
    {
    case error.PERMISSION_DENIED:
          Lungo.Notification.error(
                    "Error",                      //Title
                    "Gebruiker staat geolocatie niet toe",     //Description
                    "cancel",                     //Icon
                    7,                            //Time on screen
                    afterNotification             //Callback function
                );
      break;
    case error.POSITION_UNAVAILABLE:
          Lungo.Notification.error(
                    "Error",                      //Title
                    "Locatie niet beschikbaar",     //Description
                    "cancel",                     //Icon
                    7,                            //Time on screen
                    afterNotification             //Callback function
                );
      break;
    case error.TIMEOUT:
        Lungo.Notification.error(
                "Error",                      //Title
                "Locatie timeout",     //Description
                "cancel",                     //Icon
                7,                            //Time on screen
                afterNotification             //Callback function
            );
      break;
    case error.UNKNOWN_ERROR:
        Lungo.Notification.error(
                "Error",                      //Title
                "Unkown location error",     //Description
                "cancel",                     //Icon
                7,                            //Time on screen
                afterNotification             //Callback function
            );
      break;
    }
  }

var GPS = new GPS(); 
```

我使用课程的方式：

```
var callback = function()
            {
                alert(GPS.getLongitude() + ", " + GPS.getLatitude());
            }
            GPS.setCallback(callback); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T07:29:15.250

我发现了我的问题，我在 getLattitude 方法中再次请求了我的位置。删除后这是完美的。

# highslide - 通过 jQuery 推进 highslide 画廊

> ID：14947642
> 
> 赞同：0
> 
> 时间：2013-02-19T00:10:13.790
> 
> 标签：highslide

这是支持论坛的后续内容（感谢“RoadRash”的初步帮助！）。

我有一个 highslide 画廊，我正在尝试使用以下 javascript/jquery 推进。画廊里有大约 70 张图片。

```
function changeImage()
{
  var theValue = $('#lstOptions2').val();
  $('#thumb' + theValue).trigger('click');
} 
```

这在一段时间内效果很好，但在 10 或 11 次函数调用后图像不再前进。使用 chrome 调试器我无法确定发生了什么。

我的问题是：

1.  画廊中的图像数量是否有实际限制。
2.  我正在使用非连续锚的命名约定。例如，我可能有一个名为“thumb3456”，然后下一个将是“thumb5678” highslide 是否期望锚是连续的？
3.  我在 API 中错过了按索引选择图像的方法调用吗？

如果没有快速明显的答案，我很乐意发布测试链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:48:53.030

我可以从您发送给我的开发图库中看到，您正在使用页内图库，除了拇指条中的常规缩略图之外，您还使用下拉列表更改图像。

这是我们常规的页内画廊：[http](http://highslide.com/examples/gallery-in-page.html) ://highslide.com/examples/gallery-in-page.html 这个画廊和所有 Highslide 画廊一样，浮动在页面顶部，但页内画廊有代码以防止它被关闭。

这是我在旧论坛中为您创建的演示画廊：http: [//jsfiddle.net/roadrash/y5nZA/](http://jsfiddle.net/roadrash/y5nZA/) 请注意，`onchange`每次我们从下拉列表中选择新图像时，画廊都会关闭。

```
onchange="document.getElementById(this.options[this.selectedIndex].value).onclick(); hs.close()" 
```

为了能够从 关闭画廊`onchange`，我们必须在 highslide 设置中删除这部分：

```
// Under no circumstances should the static popup be closed
hs.Expander.prototype.onBeforeClose = function() {
    if (/in-page/.test(this.wrapper.className)) return false;
} 
```

并添加这个，因为 Highslide 也可以从 ESC 键关闭 - 我们想要防止：

```
// Prevent to close the gallery from ESC key
hs.onKeyDown = function (sender, e) {
    if( e.keyCode == 27 ) return false;
}; 
```

您可能没有注意到常规页内画廊和我的演示画廊之间的这些重要区别。您的开发图库的问题在于，每次在下拉列表中选择新图像时，您实际上都会打开一个新图库。您可以从拇指条中缩略图下方的小箭头看到这一点；它不应该超过一个箭头，但是每次我们在下拉列表中选择新图像时，在您的图库中都会添加一个新箭头。

我创建了一个类似于您的开发库的 jsFiddle：http: [//jsfiddle.net/7tSBE/](http://jsfiddle.net/7tSBE/)在这里，使用下拉列表打开新图像时，更容易看到画廊堆叠在一起，因为我使用的图像具有不同的大小。（此演示没有像您在开发图库中那样从 onImageClick 打开顶部图库。）

我不能把你需要的所有代码都放在这里，所以我创建了一个与你的开发画廊非常相似的新演示画廊（顶部画廊从 onImageClick 打开）。HTML 标记与您的相同。重要的变化是在 Highslide 设置中，而且还有比我上面提到的变化更多的变化。[http://jsfiddle.net/roadrash/y5nZA/1/](http://jsfiddle.net/roadrash/y5nZA/1/)

这是您需要`hs.close();`在代码中添加的部分（后面的行`ChangeImage();`）。此代码在我的演示页面中看起来不一样。

```
function SetImageSwatchEvents() {
    $('#lstOptions').bind('change', function () {
        SetImageSwatches(1);
    });

    $('#lstOptions2').bind('change', function () {
        SetImageSwatches(2);
        ChangeImage();
        hs.close();
    });
} 
```

# c# - 以编程方式查找损坏的图像

> ID：14947644
> 
> 赞同：0
> 
> 时间：2013-02-19T00:10:46.080
> 
> 标签：c#, image

我有大约 300,000 张图像，我需要浏览这些图像以找出损坏的图像。通过腐败，我必须解释问题所在：

![](../Images/9344cc6ee10d9fecd9d3ef19dac1622b.png)

一些图像具有显示此问题的图像的特定部分。我不知道该怎么称呼它，因此也可以找到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:26:56.127

我同意 Mitch 的评论，即这是一个需求描述，因为我不认为这是一个已知问题，而且我以前也从未见过它。您可能必须自己找到一种方法来检测这些图像。

（它不像图片中的红眼睛，你可以拿起一个工具立即修复它）。

您可以从使用构造函数创建一个[`Bitmap`](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.aspx)对象开始[`Bitmap(String)`](http://msdn.microsoft.com/en-us/library/0cbhe98f.aspx)，该构造函数接受文件的路径。

您可以读取[`Bitmap.GetPixel(Int32, Int32)`](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.getpixel.aspx)用于检测这些图像的像素（不过，您将不得不想出某种算法来做到这一点。也许读取底部的行，看看它是否仅包含图像中的两种颜色（那个棕色和黄色）**编辑：**我刚刚用缩放查看了图像，它可能不会像那样简单，因为图像有[抗锯齿](http://en.wikipedia.org/wiki/Spatial_anti-aliasing)。但是你可以检查大部分像素是否都在这些颜色，这应该工作）。

**边注：**

现在，如果您想实际编辑它们（例如，如果您将图像的其余部分放在不同的文件中），您可以[`Graphics`](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.aspx)使用静态方法创建一个对象[`Graphics.FromImage(Image)`](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.fromimage.aspx)。 *警告：`Graphics`物品是一次性的。不要忘记在保存文件或刚刚修改完图形后处理它们。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:18:27.683

[在这个问题](https://stackoverflow.com/a/211154/1760335)中有检测损坏图像的代码

真正的问题是这些图像是如何损坏的？如果存储它们的机器上有故障磁盘或其他硬件，则也需要解决。

# maps - 如何在 iOS 6 中的 MKMapView 上显示交通数据

> ID：14947645
> 
> 赞同：2
> 
> 时间：2013-02-19T00:10:55.750
> 
> 标签：maps, mkmapview, ios6-maps

有没有办法在不使用 3rd-party API（没有 Google API）的情况下在 iOS 6 中的 MKMapView 上显示流量数据？

我想既然 iOS6 中的地图数据是由 Apple 提供的，应该有办法做到这一点，但我似乎找不到合适的 API 来做到这一点。

谢谢，

# jquery - jquery实时更改和默认加载，默认不工作

> ID：14947648
> 
> 赞同：0
> 
> 时间：2013-02-19T00:11:13.663
> 
> 标签：jquery

我有这个，所以当页面加载获取值时，如果为 true，则显示一个有效的 msg，但是当我使用更改时，更改没有，所以我使用实时更改功能，当你更改时有效，但现在默认的负载检查没有？有什么想法吗？

```
$(document).ready(function() {
                var target = $('.product-options select').find(":selected").val();
                if(target == "2" || target == "4"){
                        $(".beans-msg").html("would you like beans?").show();
                } else {
                    $(".beans-msg").hide();
                }
                console.log(target);
                $('.product-options select').live('change',function(){
                    var changedVal = $(this).find(":selected").val();
                    if(changedVal == "2" || changedVal == "4"){
                        $(".beans-msg").html("would you like beans?").show();
                    } else {
                        $(".beans-msg").hide();
                    }
                    console.log(changedVal);
                });
            }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:19:29.237

如果是 jQuery 1.5.2，则不支持 on()，但请尝试以下操作：

```
$(document).ready(function () {
    $('.product-options select').live('change', function() {
        var beans = $.trim( this.value );
        if (beans == "2" || beans == "4") {
            $(this).closest('tr')
                   .find(".beans-msg")
                   .html("would you like beans?").show();
        } else {
            $(this).closest('tr')
                   .find(".beans-msg")
                   .hide();
        }
        console.log(beans);
    }).trigger('change');
}); 
```

如果更改功能有效，只需在页面加载时触发它？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T01:18:26.817

```
$(document).ready(function() {   
var x = $('.product-options').find(':selected').val();        
        if (x == "2" || x == "4")
            $('.beans-msg').html("would you like beans?").show();
        $('.product-options').live('change',function(){                
            var changedVal = $(this).find(':selected').val();                
                if(changedVal == "2" || changedVal == "4"){
                    $('.beans-msg').html("would you like beans?").show();
                } else {
                    $('.beans-msg').hide();
                }
            });
        }); 
```

[在这里](http://jsfiddle.net/UTHsg/)摆弄

# php - 提取 $_POST 数据

> ID：14947651
> 
> 赞同：0
> 
> 时间：2013-02-19T00:11:53.257
> 
> 标签：php, ajax, arrays, post

我正在开发一个项目，在该项目中，我使用 jquery/ajax 从选定的复选框中检索了名称和值。我已经在主页上使用 php 设置了复选框的名称和值。我想在单独的 php 脚本中使用 $_POST 提取名称，以便我可以使用这些名称从 MySQL 中删除项目。

```
$("#deleteproject").click(function () {
    var names = [];
    $('#projectcheckbox input:checked').each(function() {
        //all checkbox names are put in array
        names.push({name: $(this).attr('name'), value: $(this).val()});
    });
    alert($.param(names));
    return false;
}); 
```

上面的 alert($.param) 以 val1.name 和 val1.value 格式返回选中的复选框。

```
//run delete_project.php to erase projects from database
$.ajax({
    type: "post",
    url:"delete_project.php",
    data: names,
    cache: false,
    success:function() {
        alert(names + ' deleted')
    }
}); 
```

在过去的几天里，我一直在寻找答案，如果能帮助我解决这个问题，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T00:28:50.887

我更喜欢首先以这种方式使用 html 部分，因为在您的情况下它更加灵活和容易；

```
<input type="checkbox" name="projectcheckbox[]" value="foo_project" />
<input type="checkbox" name="projectcheckbox[]" value="bar_project" />
... 
```

或者首先打印出数据库结果；

```
foreach ($projects as $project) {
   print '<input type="checkbox" name="projectcheckbox[]" value="'.$project.'" />';
} 
```

然后调用`jQuery.serialize`会给你一个数据，比如；

```
projectcheckbox[]=foo_project&projectcheckbox[]=bar_project ... 
```

PHP部分（发布后）；

```
foreach ((array) $_POST['projectcheckbox'] as $pro) {
   // do something with $pro = foo_project or bar_project etc...
   // THIS PART FOR SECURITY GUYS :)
   // BUT! DO NOT FORGET TO SECURE YOUR DATA ($pro) HERE!!!!!
} 
```

# facebook - 尝试删除 Facebook Like 框中的空白

> ID：14947656
> 
> 赞同：0
> 
> 时间：2013-02-19T00:12:00.427
> 
> 标签：facebook, facebook-likebox

我在一个客户的网站上工作，并决定添加一个“Facebook Like Box”（[示例](http://www.ordwaybuildingsupply.com/Joomla_258/)）。我在 Facebook 开发者页面工作。我是一名 Joomla 开发人员（2.5x 平台）我正在尝试弄清楚如何从类似框的标题中删除空白区域直到我的图片所在的位置......关于如何执行此操作或我需要的位置的任何建议进入 Facebook 来纠正这个？

我试图重新调整高度，但是一旦我这样做以使其变小，它就会切断我的照片。

您在这件事上的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:19:34.720

编辑：好的，堆栈溢出不理解 URL，因此您必须复制和粘贴或使用短链接。

那是一个框架，短链接： http: [//on.fb.me/152cjgH](http://on.fb.me/152cjgH)

`http://www.facebook.com/plugins/likebox.php?api_key=&locale=en_US&sdk=joey&channel=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D18%23cb%3Df108e873a75ab52%26origin%3Dhttp%253A%252F%252Fwww.ordwaybuildingsupply.com%252Ff211d31607a9c7e%26domain%3Dwww.ordwaybuildingsupply.com%26relation%3Dparent.parent&height=558&header=false&show_faces=true&stream=true&width=200&href=http%3A%2F%2Fwww.facebook.com%2Fhome.php%3Fclk_loc%3D5%23!%2FOBS75%3Ffref%3Dts&colorscheme=light`

大空白是流，因此请更改您请求的值，即

消除`&stream=true`

并更改`&height=558`为`&height=300`或某事

[http://on.fb.me/152co4e](http://on.fb.me/152co4e) > `http://www.facebook.com/plugins/likebox.php?api_key=&locale=en_US&sdk=joey&channel=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D18%23cb%3Df108e873a75ab52%26origin%3Dhttp%253A%252F%252Fwww.ordwaybuildingsupply.com%252Ff211d31607a9c7e%26domain%3Dwww.ordwaybuildingsupply.com%26relation%3Dparent.parent&height=300&header=false&show_faces=true&width=200&href=http%3A%2F%2Fwww.facebook.com%2Fhome.php%3Fclk_loc%3D5%23!%2FOBS75%3Ffref%3Dts&colorscheme=light`

# python - 复杂结构词干

> ID：14947659
> 
> 赞同：0
> 
> 时间：2013-02-19T00:12:18.823
> 
> 标签：python, nltk

我有一个元组列表。这些元组包含一个标签和一个列表。它看起来像这样：

```
[('neg', ['watching', 'by', 'myself', 'tweetdebate', 'not', ...]), ('pos', ['here', 'we', 'go', 'tweetdebate', 'tweetdebate', ...])] 
```

它可以通过这个迭代

```
for label, words in labeled_words: 
```

我怎样才能改变这些词以获得它们的小写词干？

我猜是这样的循环（词干分析器是 PorterStemmer() ）：

```
stemmer.stem(word.lower()) 
```

这不起作用：

```
labeled_words = [( label, [stemmer.stem(word.lower()) for words]) for label, words in labeled_words ] 
```

感谢您的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T00:45:46.407

这主要是一个“我如何处理循环和变量”的问题。最主要的是不要尝试修改您正在迭代的列表。相反，建立一个新列表。

我认为这就是你要找的：

```
labeled_words = [('neg', ['watching', 'by', 'myself', 'tweetdebate', 'not']), ('pos',     ['here', 'we', 'go', 'tweetdebate', 'tweetdebate'])]
stemmedWords = []
for label, words in labeled_words:
    stemmed = []
    for word in words:
        stemmed.append(porter2.stem(word))
    stemmedWords.append((label,stemmed)) 
```

输出如下所示：

```
>>> stemmedWords
[('neg', ['watch', 'by', 'myself', 'tweetdeb', 'not']), ('pos', ['here', 'we', 'go', 'tweetdeb', 'tweetdeb'])] 
```

# ruby-on-rails - Activeadmin：为所有选择字段设置默认提示

> ID：14947660
> 
> 赞同：1
> 
> 时间：2013-02-19T00:12:21.043
> 
> 标签：ruby-on-rails, activeadmin, formtastic

我有两个选择字段，它们的默认选项是空白的，所以我想将它们全部设置为“选择一个”。我可以为单个字段执行此操作，但我想以某种方式在配置中执行此操作（避免冗余）。

```
 form do |f|
    f.inputs "Item" do
      f.input :field_1, :prompt => 'Choose one', :foo
      f.input :field_2, :prompt => 'Choose one', :bar
    end
  end 
```

我该怎么做呢？:)

编辑：这些提示将用于许多表单。它真的需要一个配置的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T05:27:05.570

尝试使用数组：

```
fields = [:field_1, :field2]

  form do |f|
      f.inputs "Item" do
        fields.each { |field| f.input field, :prompt => 'Choose one' }        
      end
  end 
```

# c# - ListBox wpf 上是否有 SelectionChanging 事件？

> ID：14947665
> 
> 赞同：0
> 
> 时间：2013-02-19T00:12:41.983
> 
> 标签：c#, wpf

我想要一个 ListBox 上的 SelectionChanging 事件，我可以根据某些条件取消它......有没有办法做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T00:25:40.340

您可能可以在 SelectedItem 内完成此操作

例子：

```
 private string _selectedItem;
    public string SelectedItem
    {
        get { return _selectedItem; }
        set
        {
            if (value != WhatIWant)
            {
                return;
            }
            _selectedItem = value; 
        }
    } 
```

这样，如果您不喜欢选择的值，则可以保释，或更改为其他值。

DependancyProperites 有一个很酷的小回调 (CoerceValueCallback)，您可以在其中更改值，然后再将其传播到 propertyChanged 事件。

```
public static readonly DependencyProperty SelectedItemProperty =
    DependencyProperty.Register("SelectedItem", typeof(string), typeof(MainWindow), 
    new UIPropertyMetadata(string.Empty,new PropertyChangedCallback(PropertyChanged),
    new CoerceValueCallback(CoerceValue)));

private static void PropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
{

}

private static object CoerceValue(DependencyObject d, object baseValue)
{
    if (baseValue != WhatIWasExpecting)
    {
        return WhatIWant;
    }
    return baseValue;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T00:19:19.570

`ListBox`不，在更改允许您取消更改的选择之前触发的普通 WPF 控件中没有事件。

但是，`SelectionChangedEventArgs`您在 a 期间收到的类会`SelectionChangedEvent`为您提供旧值（被取消选择）和新值（被选择）。您可以在该事件中应用您的逻辑，并在失败时重新设置选择。

如果您采用这种方法，我认为用户可能会注意到选择的闪烁，但是AFAIK 最好不要继承控件并实现您自己的`SelectionChanging`事件。

# functional-programming - 无法在 Ocaml TopLevel 中使用 FindLib 加载电池

> ID：14947667
> 
> 赞同：1
> 
> 时间：2013-02-19T00:12:56.907
> 
> 标签：functional-programming, ocaml, ocaml-batteries

我成功安装`ocaml-batteries-included`和`findlib`.

我可以毫无问题地执行“ocamlfind ocamlc -package battery -c mycode.ml”。

另外，如果我这样做`ocamlfind list`，我会得到

```
$ ocamlfind list
batteries           (version: 2.0)
batteries.pa_comprehension (version: 2.0)
batteries.pa_comprehension.syntax (version: 2.0)
batteries.pa_llist  (version: 2.0)
batteries.pa_llist.syntax (version: 2.0)
batteries.pa_string (version: 2.0)
batteries.pa_string.syntax (version: 2.0)
batteries.syntax    (version: 2.0)
bigarray            (version: [distributed with Ocaml])
camlp4              (version: [distributed with Ocaml])
... 
```

* * *

问题`using batteries`出在`ocaml (toplevel)`.

我已经按照说明进行了设置`.ocamlinit`：

```
#use "topfind";;

Toploop.use_silently
             Format.err_formatter (Filename.concat (Findlib.package_directory
             "batteries") "battop.ml");; 
```

但是当我启动时`ocaml`，我得到了这个：

```
$ ocaml
        OCaml version 4.00.1

Findlib has been successfully loaded. Additional directives:
  #require "package";;      to load a package
  #list;;                   to list the available packages
  #camlp4o;;                to load camlp4 (standard syntax)
  #camlp4r;;                to load camlp4 (revised syntax)
  #predicates "p,q,...";;   to set these predicates
  Topfind.reset();;         to force that packages will be reloaded
  #thread;;                 to enable threads

Exception: Fl_package_base.No_such_package ("batteries", ""). 
```

此外，如果我这样做`#list`，`ocaml toplevel`我会得到

```
# #list;;
bigarray            (version: [distributed with Ocaml])
camlp4              (version: [distributed with Ocaml])
camlp4.exceptiontracer (version: [distributed with Ocaml])
camlp4.extend       (version: [distributed with Ocaml])
... 
```

**我看不到`batteries`包裹。**

* * *

**有什么问题？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T07:24:27.820

您不使用 OPAM 是否有原因？（[https://github.com/OCamlPro/opam](https://github.com/OCamlPro/opam)）

安装 OPAM，切换到您最喜欢的 4.0x 编译器版本（例如`opam switch 4.00.1`），然后运行：`opam install batteries`. 我建议做`opam install utop`和使用`utop`而不是香草顶层。在任一情况下：

将以下内容放入您的`~/.ocamlinit`

```
#use "topfind";;
#require "batteries";;
open Batteries;; 
```

这就是让电池工作所需的一切。

# javascript - 如何从控制台清除集合或屏幕上的评论和名称

> ID：14947668
> 
> 赞同：3
> 
> 时间：2013-02-19T00:13:03.867
> 
> 标签：javascript, mongodb, meteor

我正在使用以下代码将数据插入到 mongo 中，并且想知道如何从控制台中将其全部擦除，这样我的页面就不会变得杂乱无章。我想我也想知道如何选择性地删除，以便我可以选择评论名称条目并删除它们。

住在[http://tuts.meteor.com](http://tuts.meteor.com)

```
Messages = new Meteor.Collection('messages');

if (Meteor.is_client){

   ////////// Helpers for in-place editing //////////

  // Returns an event_map key for attaching "ok/cancel" events to
  // a text input (given by selector)
  var okcancel_events = function (selector) {
    return 'keyup '+selector+', keydown '+selector+', focusout '+selector;
  };

  // Creates an event handler for interpreting "escape", "return", and "blur"
  // on a text field and calling "ok" or "cancel" callbacks.
  var make_okcancel_handler = function (options) {
    var ok = options.ok || function () {};
    var cancel = options.cancel || function () {};

    return function (evt) {
      if (evt.type === "keydown" && evt.which === 27) {
        // escape = cancel
        cancel.call(this, evt);
      } else if (evt.type === "keyup" && evt.which === 13) {
        // blur/return/enter = ok/submit if non-empty
        var value = String(evt.target.value || "");
        if (value)
          ok.call(this, value, evt);
        else
          cancel.call(this, evt);
      }
    };
  };//added as test

    Template.entry.events = {};

  /*  Template.entry.events[okcancel_events('#messageBox')] = make_okcancel_handler({
      ok:function(text, event){
        var nameEntry = document.getElementById('name');
        if(nameEntry.value != ""){
          var ts = Date.now() / 1000;
          Messages.insert({name: nameEntry.value, message: text, time: ts});
          event.target.value = "";
        }//if statment ends
      }
    });
  */

    Template.entry.events['click #submit'] = function() {
        var nameEntry = document.getElementById('name');
        if(nameEntry.value != ""){
            var ts = Date.now() / 1000;
            Messages.insert({name: nameEntry.value, message: $('#messageBox').val(), time: ts});
        }
    }

  Template.messages.messages = function () {
    return Messages.find({}, { sort: {time: -1} });
  };
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-19T00:44:11.580

[要全部删除：](http://docs.meteor.com/#meteorreset)

```
meteor reset 
```

使用 os 控制台通过查询删除每一个

```
meteor mongo
db.collectionname.remove({query}) 
```

或者，如果您的收藏暴露给客户端，您可以从您的 chrome/safari/firebug 控制台执行此操作，您可以构建一个 UI 并使用：

```
collectionname.remove({query}) 
```

*提示*：

您可以使用正则[表达式](http://docs.mongodb.org/manual/reference/operator/regex/)来加速和删除与正则表达式匹配的文档集。例如，如果我想删除字段中包含“the”的所有值`name`。这将在 mongo 控制台、服务器和客户端中工作。

```
collectionname.remove({ name : { $regex: 'the', $options: 'i' }}); 
```

该`i`选项使查询不区分大小写。

当然`collecionname`，这只是您决定点击的任何集合的占位符。

# python - huey消费配置在哪里？

> ID：14947671
> 
> 赞同：7
> 
> 时间：2013-02-19T00:13:12.237
> 
> 标签：python, django, task-queue, python-huey

我正在尝试为 python 运行 Huey 任务队列（它是 Celery 的替代品），并且我坚持使用 main.Configuration 启动消费者（正如它在[教程](http://huey.readthedocs.org/en/latest/getting-started.html)中所写的那样）。我知道 huey_consumer 正在 python 中的某处寻找配置文件，但我无法根据教程让它工作，我不知道为什么我应该编写一个配置文件并将其作为模块（而不是文件）加载。

当我运行`huey_consumer.py main.Configuration`它返回`Unable to import "main"`。

Huey 也将这个问题写在了他们的[常见](http://huey.readthedocs.org/en/latest/troubleshooting.html)问题中，但这也没有真正的帮助。

如果有人在使用 Huey，请帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-20T08:30:15.223

我遇到了同样的问题，并通过将包含 main.py 的目录添加到 PYTHONPATH 来解决它。无需复制 huey_consumer.py

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T01:18:33.417

所以它的工作方式是尝试导入模块“main”。这相当于打开一个 python shell 并运行：

```
>>> from main import Configuration 
```

也许您可以回复有关您的环境、文件布局、正在运行的内容等的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T11:08:52.750

我认为您需要将文件添加`__init__.py`到包含 main.py, ... 的文件夹中，否则您无法导入任何内容，因为 python 不会将此文件夹视为模块。

[Python 模块和 Python 包有什么区别？](https://stackoverflow.com/questions/7948494/whats-the-difference-between-a-python-module-and-a-python-package)

参见 giulio-piancastelli 的评论

# css - CSS3 中媒体查询的最佳实践是什么？

> ID：14947672
> 
> 赞同：5
> 
> 时间：2013-02-19T00:13:31.443
> 
> 标签：css, media-queries

我正在寻找有关 CSS3 功能的一些问题的答案 - **`Media Queries`**：

1.  哪种方式**更好**（对于浏览器由于性能）为不同的分辨率声明 css 规则？

    ```
    //this in head:
    <link rel="stylesheet/less" href="/Content/site1024.less" media="screen and (max-width: 1024px)" />

    //or this in css file:
    @media only screen and (max-width: 1024px){
        //styles here
    } 
    ```

2.  **`max-device-width`**和有什么区别**`max-width`**？它只是针对移动（`max-device-width`）或桌面（`max-width`）浏览器的规则吗？

3.  如果我为具有分辨率的平板电脑编写媒体查询规则`1280x800`，用户也可以使用纵向/横向模式，它应该看起来如何？`max-width: 800px`我应该为和`max-width: 1280px`或有另一种方式编写规则？

4.  如果我写规则，我应该写这样的东西：

    ```
    <link ... media="only screen and (min-device-width: 481px) and (max-device-width: 1024px)... /> 
    ```

    或者这两个：

    ```
    <link ... media="only screen and (max-device-width: 480px) ... />
    <link ... media="only screen and (max-device-width: 1024px) ... /> 
    ```

* * *

*PS 请原谅任何拼写或语法错误，英语不是我的第一语言*

*P.SS 在我发布这个问题之前，我花了一段时间在 stackoverflow 上搜索并没有找到关于这个问题的信息。如果我错了并且有类似的问题，我将删除我的帖子。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T10:39:19.060

1.  css 文件中的规则以减少请求数量（提高性能）。

2.  *   `max-width`是目标显示区域的宽度

    *   `max-device-width`是设备整个渲染区域的宽度

3\. 我知道的另一种定位纵向或横向的方法是这样添加`orientation`：

```
/* portrait */
@media only screen 
and (min-device-width: 768px) 
and (max-device-width: 1024px) 
and (orientation: portrait) {
    /* styles here */
}

/* landscape */
@media only screen 
and (min-device-width: 768px) 
and (max-device-width: 1024px) 
and (orientation: landscape) {
    /* styles here */
} 
```

4\. 要为宽度在 320 到 480 像素之间的移动设备定义样式表，您必须编写：

```
<link rel="stylesheet" media="screen and (min-width: 320px) and (max-width: 480px)" href="mobile.css"> 
```

// 1 个等号丢失，< 6 个字符限制。模组，请删除这个。谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-18T17:10:01.907

我正在寻找有关响应式设计最佳实践的良好信息，我会给你一个建议。

在[这个问题](https://stackoverflow.com/questions/8883163/css-media-query-soft-keyboard-breaks-css-orientation-rules-alternative-solut)中，开发人员在使用 CSS 肖像条件时遇到问题，并在选择文档的输入文本时出现键盘。我不知道为什么，但它打破了肖像条件。

在[这个网站](https://css-tricks.com/logic-in-media-queries/)中，您可以找到有关创建媒体查询时的更好做法的信息，我认为这是最好的。Personaly 我将在我的网站中使用 Exclusive 类型的媒体查询。

但另一方面，您可以遵循[本网站](http://bradfrost.com/blog/post/7-habits-of-highly-effective-media-queries/)的建议。我认为他们是对的，但我更喜欢自己创建和使用流行的设备维度媒体查询。

这是列表：

*   < 480 像素（适用于较旧、较小的智能手机屏幕尺寸）
*   < 768px，非常适合较大的智能手机和较小的平板电脑
*   > 768px，适用于所有更大的屏幕，例如大平板电脑屏幕和台式机屏幕。

此外，如果您有精力和时间，也可以使用这些：

*   <320px，非常适合老式的小型低分辨率手机
*   > 用于桌面宽屏的 1024px 样式表。

我希望它对你有帮助。

# r - 计算测试特性

> ID：14947675
> 
> 赞同：-4
> 
> 时间：2013-02-19T00:13:50.633
> 
> 标签：r

我有一个来自更大数据集的 2x2 列联表：

```
> ct
        disease
    test   0   1
     no  118  12
     yes  24  46 
```

我想快速检索不同的（医学）诊断测试特征，例如

*   灵敏度
*   特异性
*   似然比 +
*   似然比 -
*   误报率
*   假阴性率
*   疾病概率
*   预测值为正
*   预测值负
*   p（否定测试错误）
*   p（测试阳性）
*   p（测试阴性）
*   整体准确度

与它们各自的 95% CI。是否有一个包/功能可以做到这一点？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T02:43:43.100

您可能可以为这些测试特征中的每一个编写自定义函数。它将确保您的特定问题的正确格式，并且可能比您已经在做的所有谷歌搜索更快。每一个都应该很快。例如，灵敏度：

```
sens <- function(ct) { ct[2,2] / sum(ct[,2]) } 
```

和特异性：

```
spec <- function(ct) { ct[1,1] / sum(ct[,1]) } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T02:55:36.940

好的，`epi.tests(t, verbose=T)`是的。

# c++ - C++ 系统文件 bits/stat.h 突然中断，出现“错误：字段 'st_atim' 的类型不完整”

> ID：14947691
> 
> 赞同：5
> 
> 时间：2013-02-19T00:15:12.723
> 
> 标签：c++, stat, incomplete-type, time.h

我正在将一个已知可以工作的大型旧系统移植到 Ubuntu 64 位 Linux 上。系统使用FLTK，升级到1.3.2，我用的是NetBeans。文件包括基本通用 /FL/Fl.H 作为其第一行。这包括较新的 unicode 启用程序 /FL/fl_utf8.h。这包括系统文件`<sys/stat.h>`，然后包括系统文件`<bits/stat.h>`。当把它连接起来，并且 -I 包括各种不同的目录时，突然系统文件在编译时中断：

```
In file included from /usr/include/sys/stat.h:107,
/usr/include/bits/stat.h:88: error: field ‘st_atim’ has incomplete type
/usr/include/bits/stat.h:89: error: field ‘st_mtim’ has incomplete type
/usr/include/bits/stat.h:90: error: field ‘st_ctim’ has incomplete type
/usr/include/bits/stat.h:149: error: field ‘st_atim’ has incomplete type
/usr/include/bits/stat.h:150: error: field ‘st_mtim’ has incomplete type
/usr/include/bits/stat.h:151: error: field ‘st_ctim’ has incomplete type 
```

最新的 FLTK 不工作了吗？对 64 位过敏？互联网提示系统头文件中的错误？glibc 不兼容？添加_GNU_SOURCE？不要 USE_MISC 吗？博客里有很多乱七八糟的东西，这是怎么回事？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-19T00:15:12.723

简短的回答：某人在某处创建了一个名为“ **time.h** ”的随机文件。您的包含路径已包含此目录。这以不明显的方式使系统短路。该文件甚至不必*使用*，它可能是一个随机测试暂存文件，其中一个程序员放在一边，而不是包含在其中。它只需要*存在*，并且可以在您的更大包含路径中访问。这足以让你流连忘返。根本不是 FLTK 问题。

更长的答案： `stat.h`从基于`__time_t st_atime`等升级到基于 `struct timespec st_atim`等[注意末尾缺少 e] 用于处理纳秒级分辨率时间戳。但是 timespec 是在系统的`time.h`. 如果您在路径中的某处包含一个随机 time.h，这会影响包含，从而消除 struct timespec 的定义。

显然，同样的问题也是 FFMpeg v1.0 和 /include/libavutil 的问题。

底线：坚持没有人制作过名为“ **time.h** ”的文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-03-25T19:18:28.450

实际上，当我在 Centos 6.5 中遇到此问题时，我使用了一个非常可靠的快速修复程序。以为我会分享以防其他人偶然发现此线程。有一个由[https://github.com/tony2001](https://github.com/tony2001)制作和维护的存储库，它解决了 time.h 文件冲突的问题。

请按照以下方法修复它：

```
git clone https://github.com/tony2001/ffmpeg-php.git
cd ffmpeg-php
phpize
./configure
make && make install 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-10-29T13:33:28.963

我意识到这个问题已经过时了，但我会发布我的经验，因为我现在刚刚浏览这本书，这发生在我身上。我能够通过重新启动运行磁盘的虚拟计算机来解决此问题。

我认为发生在我身上的是我通过将磁盘映像安装到我计算机的一个虚拟驱动器来运行虚拟机。当我完成一天的工作后，我会保存我的虚拟机状态，然后加载该状态并在以后继续处理它。但是，有时我会重新启动物理计算机，这会从驱动器中卸载 cd 映像，但我没有注意到这一点，因为虚拟机启动时没有问题，因为我只是重新加载保存状态，直到你的问题发生在我身上.

重新挂载磁盘映像，然后重新启动虚拟机为我解决了这个问题，对于通过虚拟机运行 livecd 映像的其他人来说可能也是如此。我认为可以解释这一点的唯一另一件事是，书中的某些程序可能会弄乱某些包含内容，并且重新启动只会将机器恢复到其原始的工作状态。

如果您在物理上运行磁盘，这可能对您没有帮助，但重新启动计算机可能是一个不错的尝试。附带说明一下，我最初是在我的旧笔记本电脑上实际运行 cd，并且书中的所有程序都运行良好。这令人沮丧，因为虚拟机给我带来了我最初没有物理运行实际磁盘的问题。

# python - 将 matplotlib 3d 图导出到模型

> ID：14947694
> 
> 赞同：3
> 
> 时间：2013-02-19T00:15:47.013
> 
> 标签：python, 3d, matplotlib

我在 matplotlib 中生成 3d 图，并且对结果普遍感到满意。然而，我注意到的一件事是默认 3d 查看器的性能非常慢，只有几百个数据点。有没有办法将生成的图形导出到可以在其他 3d 模型查看器中查看的模型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T05:10:48.207

不，除非你写它；）。 `mayavi` [(docs)](http://docs.enthought.com/mayavi/mayavi/index.html)这是一个基于 openGL 的渲染器可能会做得更好。您可能还想查看[vtk](http://www.vtk.org/)。

社区维基，因为这基本上是乔金顿从评论中得到的答案。

# c# - 链接到 SSRS 报告并在 URL 中设置参数

> ID：14947695
> 
> 赞同：2
> 
> 时间：2013-02-19T00:15:56.540
> 
> 标签：c#, reporting-services

我有这段代码：

```
ErrorLogging.WriteLog(string.Format("Username = {0}, userkey = {1}, userID = {2}", CurrentUser.Username, CurrentUser.UserKey, CurrentUser.Username + CurrentUser.UserKey.ToString()));
ssrsRV.ProcessingMode = ProcessingMode.Remote;
ssrsRV.ServerReport.ReportServerUrl = new Uri(SystemConfig.SSRSServerURI);
ssrsRV.ServerReport.ReportPath = report.REPORT ?? string.Empty;
ssrsRV.ServerReport.SetParameters(new ReportParameter("UserID", CurrentUser.Username + CurrentUser.UserKey.ToString())); 
```

第一行只是向我自己证明，我在这些变量中获得了有效信息。用户 ID 最终类似于“jsmith162e4aa1-d8d3-427b-bd3d-71b7f0307856”

ssrsRV 是一个`Microsoft.Reporting.WebForms.ReportViewer`对象。

当我尝试运行此代码时，我收到此错误消息：

> 项目 '/MyFolder/MyExampleReport.rdl~!@~!@' 的路径无效。完整路径的长度必须少于 260 个字符；其他限制适用。如果报表服务器处于本机模式，则路径必须以斜杠开头。(rsInvalidItemPath)

异常是由`SetParameters`方法抛出的，所以我确定这就是问题所在，但我没有测试过根本不传递参数。

任何线索我做错了什么？接下来我应该尝试什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T15:04:59.123

我很笨。

代码很完美，应用程序将“~！@~！@”添加到数据库中的报告路径中，而不向用户显示。如果我编写一条 SQL 语句从数据库中的报告路径中删除这些字符，它会完美运行。

谢谢，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T10:25:48.967

您需要先声明报告参数：

```
ReportParameter[] RptParameters = new ReportParameter[1]; 
```

然后赋值参数：

```
RptParameters[0] = new ReportParameter("UserID", CurrentUser.Username + CurrentUser.UserKey.ToString()); 
```

然后设置参数：

```
ssrsRV.ServerReport.SetParameters(RptParameters); 
```

看看这是怎么回事。

# asp.net - 值不能为空。参数名称：上下文

> ID：14947698
> 
> 赞同：1
> 
> 时间：2013-02-19T00:16:16.690
> 
> 标签：asp.net, wcf, enumeration

我有一个 WCF 网络服务，我正在努力使用 netTcpBinding 成功运行它。

我收到的错误是

```
Value cannot be null.
Parameter name: context 
```

在我收到的有关此错误消息的第一个搜索结果中，有[以下帖子](https://stackoverflow.com/questions/12120297/request-error-with-wcf-data-services)表明发生此错误是因为 WCF 不支持枚举（我的服务确实包含）。

然而，花了一些时间创建另一个测试 WCF 服务后，我已经能够通过我的 web 服务成功地提供包含枚举的响应，这似乎与该帖子所说的相矛盾。

这是我的服务定义的外观。

```
 <service name="Implementations.CourseService" behaviorConfiguration="metadataBehavior">
    <endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange" />
    <endpoint address="/CourseService.svc" binding="wsHttpBinding" contract="Contracts.ICourseService" />
    <endpoint address="" binding="netTcpBinding" contract="Contracts.ICourseService">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>

    <host>
      <baseAddresses>
        <add baseAddress="net.tcp://localhost:808/CourseService.svc" />
      </baseAddresses>
    </host>
  </service>

 <serviceBehaviors>
   <behavior name="metadataBehavior" >
     <serviceMetadata httpGetEnabled="true" />
     <serviceDebug includeExceptionDetailInFaults="true" />
   </behavior>
 </serviceBehaviors>

 <netTcpBinding >
    <binding name="tcpBinding" />
 </netTcpBinding> 
```

这是调用此服务的最终结果。

![在此处输入图像描述](../Images/1f7cf2e70333168ab67396f46a47682d.png)

任何帮助将不胜感激。我也会定期查看这篇文章，所以如果有人需要我可能没有提供的任何进一步信息，请询问，因为我不确定什么是相关的，什么不是。

# c# - 如何在数据库中存储每周可用时间？

> ID：14947699
> 
> 赞同：1
> 
> 时间：2013-02-19T00:16:31.053
> 
> 标签：c#, asp.net, sql-server-2008

我正在为医生办公室编写预约系统。我需要存储每周可用的医生。像这样的东西： -

```
 DoctorID | 10AM | 11AM |     12AM  | 1PM | 2PM |    3PM    | 4PM | 
        ------------------------------------------------------------------
 [MON]  5477J    |  1   |  0   | AppointID |   1 |   1 | AppointID | 0   |
        ------------------------------------------------------------------
 [TUE]  5477J    |  0   |  1   | AppointID |   1 |   1 | AppointID | 0   | 
        ------------------------------------------------------------------ 
```

我将时间段存储为`numeric` `1 implies **avaialble**` `0 implies **will not be in office**`，如果有预约，则时间段将替换为`AppointmentID`.

可用性每天都会有所不同。我的问题是如何存储每天的可用性？我应该每周安排 5 行吗？有人可以指点我一些简单的模式还是有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T00:23:26.880

我过去使用的一个模型是这样的：

```
TABLE [AppointmentBlock]
  - [DoctorID] INT
  - [StartTime] DATETIME
  - [EndTime] DATETIME
  - [IsAvailable] BIT
  - [IsRecurring] BIT
  - [AppointmentID] INT 
```

如果`[IsRecurring] = 1`，这将表示每周在同一时间重复出现的块，并且您应该假设开始/结束时间是从一周开始计算的偏移量。

如果`[IsRecurring] = 0`，这只是一次发生，并且开始/结束时间是绝对的。

因此，医生日程表中的每个时间段都被计算在内，即使它并不精确地落在每个小时。一些严格的业务逻辑需要在此之上分层，以确保不会创建重叠（除非出于某种原因您希望允许这样做）。

为了使您的示例适合此模型，您将拥有以下内容：

```
DoctorID | Start    | End      | IsAvailable | IsRecurring | AppointmentId | 
----------------------------------------------------------------------------
5477J    | 10AM Mon | 11AM Mon |           1 |           1 |          NULL |
5477J    | 11AM Mon | 12PM Mon |           0 |           1 |          NULL |
5477J    | 12PM Mon |  1PM Mon |           0 |           1 |     AppointID |
5477J    |  1PM Mon |  3PM Mon |           1 |           1 |          NULL |
5477J    |  3PM Mon |  4PM Mon |           0 |           1 |     AppointID |
5477J    |  4PM Mon |  5PM Mon |           0 |           1 |          NULL |
5477J    | 10AM Tue | 11AM Tue |           0 |           1 |          NULL |
5477J    | 11AM Tue | 12PM Tue |           1 |           1 |          NULL |
5477J    | 12PM Tue |  1PM Tue |           0 |           1 |     AppointID |
5477J    |  1PM Tue |  3PM Tue |           1 |           1 |          NULL |
5477J    |  3PM Tue |  4PM Tue |           0 |           1 |     AppointID |
5477J    |  4PM Tue |  5PM Tue |           0 |           1 |          NULL | 
```

# actionscript-3 - FB 4.6 - 列表组件 - 在标签前添加项目计数？

> ID：14947700
> 
> 赞同：0
> 
> 时间：2013-02-19T00:16:34.530
> 
> 标签：actionscript-3, apache-flex, flash-builder4.5

我有一个使用 sqlite 数据库作为 dataProvider 的列表组件，并且能够使用 labelField 来显示数据标签就好了......但是，我想在标签字段之前附加一个增量计数，以便将其列为

1.) 项目编号 1 2.) 项目编号 2 ... 等等...

我发现了 labelFunct 并写了以下代码来测试它：

```
private function lblFunct(value:Object):String
{
   return value.id + ") " + value.question;
} 
```

并且在标签文本之前显示自动分配的数据库ID就好了....我的目标是尝试获取每个项目的计数...我可以通过以下方式获取数据提供者的长度

```
myListComponentID.dataProvider.length 
```

但找不到有关如何实现增量计数的任何信息。是否可以为 labelFunct 中的每个循环构造某种类型？任何人都可以对此有所了解吗？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T00:40:06.350

您使用 labelFunction 走在正确的轨道上。您可以在 dataProvider 上使用[getItemIndex](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/collections/ListCollectionView.html#getItemIndex%28%29)方法来确定显示项目的 itemIndex：

```
private function lblFunct(value:Object):String
{
   return myListComponentID.dataProvider.getItemIndex(value) + ") " + value.question;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T01:02:24.550

在回复者的帮助下，我找到了解决方案…… fabel 函数最终看起来像这样：

```
private function lblFunct(value:Object):String
{
    return (myListComponentID.dataProvider.getItemIndex(value)+1) + ") " + value.question;
} 
```

我添加了 +1 以弥补它基于零的事实。不过，感谢响应者，您帮助我找到了答案。非常感激！

# javascript - Javascript mousemove 事件队列

> ID：14947703
> 
> 赞同：1
> 
> 时间：2013-02-19T00:16:44.377
> 
> 标签：javascript, mousemove, eventqueue

在 Javascript 中，是否可以在 mousemove 事件处理程序中确定队列中是否有任何挂起的 mousemove 事件？

或者，最好是，是否可以让事件队列跳过队列中的所有 mousemove 事件，除了最近的事件？

我正在使用 mousemove 和其他鼠标事件来允许用户在屏幕上拖动元素，并且我不需要浪费 CPU 和 GPU 周期在每个 mousemove 事件上重绘拖动的项目（在其中我更新顶部和左侧 CSS 属性)，只要我能足够快地跳过中间事件。

我的网站目前没有遇到任何性能或可视化问题；我只是想让我的 JavaScript 尽可能高效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:18:27.870

使用事件去抖动。[这个小型节流/去抖动库](http://benalman.com/projects/jquery-throttle-debounce-plugin/)无论有无 jQuery 都可以很好地工作。

例子：

```
function someCallback() {
    // snip
}

// don't fire more than 10 times per second
var debouncedCallback = Cowboy.debounce(100, someCallback);
document.getElementById('some-id').addEventListener('mousemove', debouncedCallback); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:19:28.527

您可以跟踪上次处理鼠标移动的时间，如果太早，则跳过当前的。

例如：

```
elem.onmousemove = function() {
    var lastcalled = arguments.callee.lastCallTime || 0,
        now = new Date().getTime();
    if( now-lastcalled < 250) return;
    arguments.callee.lastCallTime = now;
    // rest of code here
}; 
```

# google-apps-script - 序列化延续 Google Apps 脚本时出现意外异常

> ID：14947708
> 
> 赞同：2
> 
> 时间：2013-02-19T00:17:32.130
> 
> 标签：google-apps-script, google-calendar-api, google-sheets, google-cloud-sql

我最近在尝试调试时开始在电子表格 Google Apps 脚本上收到错误“序列化延续时出现意外异常”。在我创建与 Google CloudSQL api 的连接后，错误似乎开始了。即使在注释掉 jdbc 对象构造函数后，仍然会出现此错误。其他人似乎遇到了这个问题，需要 Google 技术人员来解决这个问题。

我已经搜索了所有讨论板以找到解决此问题的方法，但没有成功。有没有可能有谷歌技术人员可以帮我看看引擎盖下的情况？如果我能确定是哪一行实际触发了错误，我会发布代码。

编辑：

好的，我想我已经发现了错误发生的位置。似乎是

```
var response = UrlFetchApp.fetch(url + nextPage,oauth_options); 
```

在while循环中。这是整个功能代码。

```
function retrieveEvents(endTimeMinimum, updatedAfter, orderBy){      
//var url = 'https://www.googleapis.com/calendar/v3/calendars/' + source_cal + '/events?key=' + api_key + "&futureevents=true&orderBy=updated&sortOrder=descending&updatedMin=" + last_sync_date_formated;
//var url = 'https://www.googleapis.com/calendar/v3/calendars/' + source_cal + '/events?key=' + api_key + "&orderBy=updated&sortOrder=descending&updatedMin=" + last_sync_date_formated;

   var url = 'https://www.googleapis.com/calendar/v3/calendars/' + source_cal + '/events?key=' + api_key + "&singleEvents=true";

   if ((orderBy != null) && (orderBy != "")){
     url += "&orderBy=" + orderBy;
   }
   else url += "&orderBy=updated";

   if ((updatedAfter != null) && (updatedAfter != "")){
     url += "&updatedMin=" + updatedAfter;
   }
   else url += "&updatedMin=" + last_sync_dateTime;

   //if no endTimeMinimum is specified, the current time will be used.
   if (endTimeMinimum ==  null || endTimeMinimum == ""){
     endTimeMinimum = date_rfc339("Today");
   }

   url += "&timeMin=" + endTimeMinimum;

   Logger.log("Request URL:" + url);

   var largeString = "";
   var events = new Array();
   var nextPage = "";
   var jsonObj

   while(true){
     var response = UrlFetchApp.fetch(url + nextPage,oauth_options);
     largeString = response.getContentText();

     if ((largeString != null) && (largeString != "")) {
       jsonObj = JSON.parse(largeString);  
     }
     if ('items' in jsonObj) events = events.concat(jsonObj.items);
     if ('nextPageToken' in jsonObj){
       nextPage = "&pageToken=" + jsonObj.nextPageToken;
       continue;
     }
     break;
   }

   if (events.length == 0)return null;
     return events;
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-25T14:26:31.790

好的，所以我能够通过删除从主函数中的 try catch 块内部调用的函数内的 try catch 块来解决问题。从调试器运行程序时，我不再看到“序列化延续时出现意外异常”。

我希望我对导致此错误的原因以及如何纠正它有一个更可靠的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T11:16:40.107

根据我的经验，这不是由该行（或任何其他行）引起的错误，而是因为在循环中触发了错误。我还没有确定确切的可复制原因，但 GAS 似乎丢失了循环指针某些错误。

我可以建议的最好的方法是，您怀疑在 while 循环中导致错误的任何行都使用 try-catch 进行包装，该 try-catch 将错误记录到记录器并继续。然后循环指针不会丢失，并将按预期进行调试。

# c# - 在后台运行课程

> ID：14947710
> 
> 赞同：0
> 
> 时间：2013-02-19T00:17:40.807
> 
> 标签：c#, asp.net, multithreading

我有一个 win 表单，它启动一个迷你服务器类型的东西来为本地浏览器提供网页，现在的问题是，当我启动它时，应用程序显然不会运行，因为有一个等待请求的循环，因为每个请求我都会创建一个新线程。现在我应该为整个过程创建一个完整的新线程还是有其他方法？该类位于我创建的单独的 dll 文件中。单独它可以按预期完美运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:30:53.023

这里有两种方法：

1.  异步服务器。难度更高，性能更高。[http://robjdavey.wordpress.com/2011/02/12/asynchronous-tcp-server-example/](http://robjdavey.wordpress.com/2011/02/12/asynchronous-tcp-server-example/)

2.  每个客户端一个线程。易于编写，但如果您有很多客户，则不适用。[http://tech.pro/tutorial/704/csharp-tutorial-simple-threaded-tcp-server](http://tech.pro/tutorial/704/csharp-tutorial-simple-threaded-tcp-server)

在请求之前不要使用循环

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T00:37:51.153

我建议你看看[ThreadPool 类](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.aspx)。这是处理多个线程的易于使用的选项：

> 线程池通过为您的应用程序提供由系统管理的工作线程池，使您能够更有效地使用线程。

要将方法排队等待执行，只需使用[QueueUserWorkItem 方法](http://msdn.microsoft.com/en-us/library/4yd16hza.aspx)：

```
ThreadPool.QueueUserWorkItem(state =>
{
    // do some work!
}); 
```

如果您意识到需要更多活动的并发线程来为您的客户端提供服务，请调用[SetMaxThreads 方法](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.setmaxthreads.aspx)：

```
ThreadPool.SetMaxThreads(50, 10); 
```

工作线程和 I/O 线程的所有高于这些数字的请求都将保持排队，直到线程池线程可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T01:47:04.747

我会遵循@Thomas 的建议，但会添加`waitHandles`到您的 ThreadPool 以管理回调周期。

```
WaitCallback classMethod1= new WaitCallback(DoClassMethod1);
bool isQueued = ThreadPool.QueueUserWorkItem(classMethod1, waitHandle[0]);

WaitCallback classMethod2= new WaitCallback(DoClassMethod2);
bool isQueued = ThreadPool.QueueUserWorkItem(classMethod2, waitHandle[1]);

// do this if you want to wait for all requests complated
if (WaitHandle.WaitAll(waitHandles, 5000, false))
  // request completed, show your result. 
else
  // problem.

void DoClassMethod1(object state)
{
  // do your work
  ManualResetEvent mre = (ManualResetEvent)state;
  mre.Set();
} 
```

# java - 实现类，等腰三角形

> ID：14947711
> 
> 赞同：0
> 
> 时间：2013-02-19T00:17:47.700
> 
> 标签：java, geometry, implementation

我需要实现一个三角形类，我坚持比较边的长度以确定三角形是否确实是等腰。这是我到目前为止所拥有的：

```
public class TriangleIsosceles {

    private Point cornerA;
    private Point cornerB;
    private Point cornerC;
    private int x1;
    private int y1;
    private int x2;
    private int y2;
    private int x3;
    private int y3;

    public TriangleIsosceles(){
        cornerA = new Point(0,0);
        cornerB = new Point(10,0);
        cornerC = new Point(5,5);
    }

    public TriangleIsosceles(int x1,int y1,int x2,int y2,int x3,int y3){
        cornerA = new Point(x1,y1);
        cornerB = new Point(x2,y2);
        cornerC = new Point(x3,y3);
    }

    public String isIsosceles(String isIsosceles){
        return isIsosceles;
    }

} 
```

我使用的`Point`对象是这样的：

```
public class Point {

    private int x;
    private int y;

    public Point(){
        this(0,0);
    }

    public Point(int x, int y){
        this.x = x;
        this.y = y;
    }
    public void setX(int x){
        this.x=x;
    }
    public void setY(int y){
        this.y=y;
    }
    public void printPoint(){
        System.out.println(x + y);
    }

    public String toString(){
        return "x = "+x+" y = "+y;
    }

} 
```

在另一个类 ( `LineSegment`) 中，我创建了一个`length()`确定两点距离的方法。看起来像：

```
public double length() {
    double length = Math.sqrt(Math.pow(x1-x2,2) + Math.pow(y1-y2,2));
    return length;
} 
```

我如何使用这种方法来帮助我在`TriangleIsosceles`课堂上找到三角形的长度？

我知道我需要看看是否`(lenghtAB == lengthBC || lengthBC == lenghtCA || lengthAB == lengthCA)`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:28:41.463

一个快速、完全有效的解决方案是使您的长度方法成为静态实用程序方法，即

```
public static double length(x1, y1, x2, y2)
{
    return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));
}

or

public static double length(Point p1, Point p2)
{
    return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));
} 
```

您还可以将方法添加到 Point 本身，即在 Point 类中添加：

```
public double calcDistance(Point otherPoint)
{
   return Math.sqrt(Math.pow(this.x - otherPoint.x, 2) + Math.pow(this.y - otherPoint.y, 2));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:27:24.383

假设您的`LineSegment`类有一个带有两个对象的构造函数`Point`，您应该创建三个`LineSegment`对象（您可以在`Triangle`类中缓存它们）。然后使用`LineSegment#getLength()`您可以确定任何两条边是否相同长度。

由于这看起来像家庭作业，我不会给你完整的解决方案。

# android - Android：如何禁用 CalendarView 的滚动

> ID：14947712
> 
> 赞同：4
> 
> 时间：2013-02-19T00:18:07.573
> 
> 标签：android, scroll, calendarview

有没有办法在不完全禁用日历日期选择事件的情况下禁用日历视图中的滚动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-03T16:53:39.227

我搜索了两天，唯一能远程工作的就是禁用 CalendarView 对象。

```
CalendarView cal = (CalendarView) view.findById(R.id.calView);
cal.setEnabled(false); 
```

它并不完美，但我在相同的布局中有箭头可以逐月移动。如果您找到更好的解决方案，我将非常高兴听到它。祝你好运。

# c# - 布尔逻辑 - 为输出选择真值

> ID：14947718
> 
> 赞同：0
> 
> 时间：2013-02-19T00:18:28.660
> 
> 标签：c#

我目前正在使用布尔逻辑和真值表。我已经能够创建一个将生成 2 个变量`(a,b)`表的类。我的主要兴趣是在表中选择某些输入并为其输出设置“真实”值。我已经能够对上述内容进行硬编码，`override bool GetTruthValue()`并将这些`true`值输出结果显示在名为`OutputTextBox`. 我希望用户提供计算真值的逻辑。我目前的方法是由代码提供逻辑。如何让用户选择哪个输入的输出值为“真”？通过复选框或单独的 texboxes（带 1 或 0）指示？或者其他建议？

```
namespace table_outputs
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

    public abstract class TwoItemTruthRow
        {
            protected TwoItemTruthRow(bool a, bool b)
            {
                A = a; B = b;
            }

            public bool A { get; protected set; }
            public bool B { get; protected set; }

            public abstract bool GetTruthValue();
        }

    public class MyCustomTwoItemTruthRow : TwoItemTruthRow
        {
            public MyCustomTwoItemTruthRow(bool a, bool b)
                : base(a, b)
            {
            }

            public override bool GetTruthValue()
            {
                // My custom logic- Hard coded
                return (A && B) || (A && !B) || (!A && !B);
            }
        }

    private static string GetHorizontalLineText()
        {
            return "-----------------------------------------------\r\n";
        }
        private static string GetFormattedTwoItemText(MyCustomTwoItemTruthRow item)
        {
            return string.Format("{0}\t{1}\r\n", item.A, item.B);
        }

    private static IEnumerable<MyCustomTwoItemTruthRow> GenerateTruthTableTwo()
        {
            for (var a = 0; a < 2; a++)
                for (var b = 0; b < 2; b++)
                    yield return new MyCustomTwoItemTruthRow(
                        Convert.ToBoolean(a),
                        Convert.ToBoolean(b));
        }

    private void GenerateTableButton_Click(object sender, EventArgs e)
        {
            InputTextBox.Clear();
            InputTextBox.Text += "A\tB\r\n";
            InputTextBox.Text += GetHorizontalLineText();

            var myTruthTable = GenerateTruthTable().ToList();
            foreach (var item in myTruthTable)
            {
                InputTextBox.Text += GetFormattedTwoItemText(item);
                InputTextBox.Text += GetHorizontalLineText();
            }
        }
        private void ShowTrueValuesButton_Click(object sender, EventArgs e)
        {
            OutputTextBox.Clear();
            OutputTextBox.Text += "True Values\r\n";
            OutputTextBox.Text += "A\tB\r\n";
            OutputTextBox.Text += GetHorizontalLineText();

            var myTruthTable = GenerateTruthTableTwo().ToList();
            foreach (var item in myTruthTable)
            {

                if (item.GetTruthValue())
                    OutputTextBox.Text += GetFormattedTwoItemText(item);
            }
        }

    }
} 
```

**当前的 WinForm** ![在此处输入图像描述](../Images/29a9958ebb2ca5ef6564c7133fe138c9.png)

![在此处输入图像描述](../Images/86998b225214791fd377cba547c6d4fa.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T01:18:39.333

You can bind a list of objects to a `DataGridView` on your form and create columns for each of the input and output fields. Using `DataGridViewCheckBoxColumn` for the columns gives you a set of check boxes that the user can interact with. Set ReadOnly on the input columns, and maybe change the background color to indicate that they are fixed.

You can either define the columns dynamically or create as many columns as you might ever need and hide the ones you're not using. Depends on how you want to define the data you're attaching them to more than anything.

Here's a mockup I did in VS2010:

![enter image description here](../Images/1732aeea0ab6c28fd43323cfb8730d08.png)

This is bound to a list of the following object type:

```
public class TruthTableEntry
{
    public bool A { get; set; }
    public bool B { get; set; }
    public bool C { get; set; }
    public bool D { get; set; }
    public bool Out { get; set; }
} 
```

Here's the form code for my mockup:

```
public partial class Form1 : Form
{
    List<TruthTableEntry> table;

    public Form1()
    {
        // generate a 3-input truth table (8 input variations)
        table = GenerateTruthTable(3);

        // setup DataGridView
        dataGridView1.DataSource = table;
        dataGridView1.Columns[0].DataPropertyName = "A";
        dataGridView1.Columns[1].DataPropertyName = "B";
        dataGridView1.Columns[2].DataPropertyName = "C";
        dataGridView1.Columns[3].DataPropertyName = "D";
        dataGridView1.Columns[4].DataPropertyName = "Out";
        // hide column 3 ('D') as unused
        dataGridView1.Columns[3].Visible = false;
    }
}

// Create a truth table for 1-4 inputs
static List<TruthTableEntry> GenerateTruthTable(int numInputs)
{
    // range-check number of inputs
    if (numInputs < 1 || numInputs > 4)
        return null;

    // calculate number of input states
    int permutations = 1 << numInputs;

    // create result list of input states
    List<TruthTableEntry> res = new List<TruthTableEntry>();
    for (int i = 0; i < permutations; ++i)
    {
        // use bit manipulation to initialize a TruthTableEntry:
        TruthTableEntry ent = new TruthTableEntry 
            {
                A = (i & (1 >> (NumInputs - 1))) != 0,
                B = (i & (1 >> (NumInputs - 2))) != 0,
                C = (i & (1 >> (NumInputs - 3))) != 0,
                D = (i & (1 >> (NumInputs - 4))) != 0,
                Out = false,
            };
        res.Add(ent);
    }
    return res;
} 
```

`dataGridView1` is a `DataGridView` with 5 `DataGridViewCheckBoxColumn` columns defined, with first 4 columns set to ReadOnly and colored.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:47:46.690

我建议使用带有单独文本框的动态 DataGridView 来指示变量的数量。

默认值可以是 2 个变量，并且在启动时会生成一个 DataGridView 作为真值表，并带有一个额外的最后一列，用于编辑每行的所需输出。

如果用户更改了变量的数量，请相应地调整您的 DataGridView。（您可能需要添加一个按钮来更改 DataGridView）

无论如何，我建议将界面设计为需要尽可能少的点击/击键。

# functional-programming - 为什么 ocamlc 说我不匹配 {} 而我没有？

> ID：14947719
> 
> 赞同：2
> 
> 时间：2013-02-19T00:18:40.320
> 
> 标签：functional-programming, ocaml

我已经写了`myPercolation.ml`。

```
open MyUnionFind

module type MyPercolationSig = sig
  type percolation
  val create_percolation : int -> percolation
  val open_site : percolation -> int -> int -> unit
  val is_open : percolation -> int -> int -> bool
  val is_full : percolation -> int -> int -> bool
  val can_percolates : percolation -> bool
end

module MyPercolation : MyPercolationSig = struct

  exception IndexOutOfBounds;;

  type percolation = 
      {n : int; 
       sites: bool array; 
       union : MyUnionFind.union_find};;

  let create_percolation n = 
    {n = n; sites = Array.make (n*n) false; union = MyUnionFind.create_union (n*n)};;

  let open_site p i j = 
    let {n;_;union} = p 
    in 
    if not (is_open p i j) then
      begin 
    sites.(index_of n i j) <- true;
    if i - 1 >= 1 && i - 1 <= n && is_open n (i-1) j then
      MyUnionFind.union union (index_of n i j) (index_of n (i-1) j)
    else  if i + 1 >= 1 && i + 1 <= n && is_open n (i+1) j then
      MyUnionFind.union union (index_of n i j) (index_of n (i+1) j)
    else  if j - 1 >= 1 && j - 1 <= n && is_open n i (j-1) then
      MyUnionFind.union union (index_of n i j) (index_of n i (j-1))
    else  if j + 1 >= 1 && j + 1 <= n && is_open n i (j+1) then
      MyUnionFind.union union (index_of n i j) (index_of n i (j+1))
      end;;

  let index_of n i j = n * (i - 1) + j;;

  let is_open {n;sites;_} i j = 
    if i < 1 || i > n || j < 1 || j > n then 
      raise IndexOutOfBounds
    else 
      sites.(index_of n i j);;

  let is_full {n;_;union} i j =
    let rec is_connected_top j' =
      if j = 0 then false
      else 
    if MyUnionFind.is_connected union (index_of n i j) (index_of n 0 j') then true
    else is_connected_top (j'-1)
    in is_connected_top n;;

  let can_percolates p =
    let {n;_;_} = p 
    in  
    let rec is_full_bottom j =
      if j = 0 then false
      else 
    if is_full p n j then true
    else is_full_bottom (j-1)

end 
```

* * *

请忽略`MyUnionFind`包包。它只是`union-find`算法的自制实现。

当我尝试编译时`myPercolation.ml`，出现这样的错误：

```
$ ocamlc -c myPercolation.ml
File "myPercolation.ml", line 25, characters 11-12:
Error: Syntax error: '}' expected
File "myPercolation.ml", line 25, characters 8-9:
Error: This '{' might be unmatched 
```

`let {n;_;union} = p`我认为错误是在谈论`let open_site p i j`.

我已经多次阅读该行和所有代码，但我仍然看不到`{}`该行有任何不匹配的地方。

**有人可以帮忙吗？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T01:00:07.563

另一个可能的错误：`{n;_;_}`应该`{n;_}`只有 1 个下划线是必需的。把它想象`_`成匹配语句中的通配符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T00:37:17.840

该表达式`let {n; _; union} = p`不是格式良好的 OCaml。我想你想要的是`let {n; union} = p`。在记录模式中处理您不关心的字段的方法是不要提及它们。

**更新**：

正如 rgrinberg 指出的那样，描述问题的更好方法是`_`必须出现在最后一个字段中。这就是编译器期望`}`之后看到的原因。`_`将 包括在内作为您有意仅匹配记录字段的子集的指示符可能是一种很好的风格。事实上，您可以打开一个编译器选项来检查这一点。

**更新 2**：

不完整记录模式的警告是警告编号 9，并且与字母 R 相关联。以下是 R 的使用方法：

```
$ ocaml -w +R
        OCaml version 4.00.0

# type r = { a: int; b: char };;
type r = { a : int; b : char; }
# let {a} = {a=3; b='x'} in a;;
Warning 9: the following labels are not bound in this record pattern:
b
Either bind these labels explicitly or add '; _' to the pattern.
- : int = 3 
```

编译器的命令行语法相同。

# c# - C# - 强制 String.Format 使用小数和从不逗号

> ID：14947720
> 
> 赞同：6
> 
> 时间：2013-02-19T00:18:40.537
> 
> 标签：c#, string.format

基本上我意识到我的应用程序使用的是逗号而不是小数，我从不想允许这样做。有谁知道我该如何纠正？我无法通过谷歌找到强制小数的一件事，这完全是强制逗号。

```
 return String.Format("{0}f, {1}f, {2}f, {3}f, {4}f, {5}f, {6}f, {7}f, {8}f, {9}f, {10}f, {11}f, {12}f, {13}f, {14}f, {15}f", M.M11, M.M12, M.M13, M.M14, M.M21, M.M22, M.M23, M.M24, M.M31, M.M32, M.M33, M.M34, M.OffsetX, M.OffsetY, M.OffsetZ, M.M44); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-19T00:24:19.940

您可以使用其他重载：

```
return String.Format(
    CultureInfo.InvariantCulture // <<== That's the magic
,   "{0}f, {1}f, {2}f, {3}f, {4}f, {5}f, {6}f, {7}f, {8}f, {9}f, {10}f, {11}f, {12}f, {13}f, {14}f, {15}f"
,   M.M11, M.M12, M.M13, M.M14, M.M21, M.M22, M.M23, M.M24, M.M31, M.M32, M.M33, M.M34, M.OffsetX, M.OffsetY, M.OffsetZ, M.M44
); 
```

这种调用方式确保不变的文化作为格式提供者传递给`String.Format`，确保您得到数字的圆点、货币符号的美元、月份和日期的英文名称等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T00:23:39.807

尝试将 String.Format 函数的文化设置为美国英语：

```
String.Format(new CultureInfo("en-US"), "{0}f, {1}f, {2}f", etc) 
```

# java - ConcurrentHashMap 完全安全吗？

> ID：14947723
> 
> 赞同：58
> 
> 时间：2013-02-19T00:18:59.493
> 
> 标签：java, multithreading, synchronized, java.util.concurrent

这是 JavaDoc 中关于`ConcurrentHashMap`. 它说检索操作通常不会阻塞，因此可能与更新操作重叠。这是否意味着该`get()`方法不是线程安全的？

> “然而，尽管所有操作都是线程安全的，但检索操作并不需要锁定，并且不支持以阻止所有访问的方式锁定整个表。这个类与依赖程序中的 Hashtable 完全互操作它的线程安全，但不是它的同步细节。
> 
> 检索操作（包括 get）一般不会阻塞，因此可能与更新操作（包括 put 和 remove）重叠。检索反映了最近完成的更新操作开始时的结果。”

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-02-19T00:33:18.657

该`get()`方法是线程安全的，其他用户为您提供了有关此特定问题的有用答案。

然而，虽然`ConcurrentHashMap`它是一个线程安全*的*替代品`HashMap`，但重要的是要意识到，如果您正在执行多个操作，您可能必须大幅更改您的代码。例如，使用以下代码：

```
if (!map.containsKey(key)) 
   return map.put(key, value);
else
   return map.get(key); 
```

在多线程环境中，这是一种竞争条件。您必须使用[`ConcurrentHashMap.putIfAbsent(K key, V value)`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ConcurrentHashMap.html#putIfAbsent%28K,%20V%29)并注意返回值，它会告诉您 put 操作是否成功。阅读文档以获取更多详细信息。

* * *

回答要求澄清为什么这是竞争条件的评论。

想象一下有两个线程`A`，`B`它们将在映射中放置两个不同的值，`v1`并且`v2`分别具有相同的键。密钥最初不存在于地图中。它们以这种方式交错：

*   线程`A`调用`containsKey`并发现密钥不存在，而是立即挂起。
*   线程`B`调用`containsKey`并发现键不存在，并有时间插入其值`v2`。
*   线程`A`恢复并插入`v1`，“和平地”覆盖（因为`put`是线程安全的）线程插入的值`B`。

现在线程`B`“认为”它已经成功插入了自己的值`v2`，但地图包含`v1`. 这确实是一场灾难，因为线程`B`可能会调用`v2.updateSomething()`并且会“认为”地图的消费者（例如其他线程）可以访问该对象并且会看到可能重要的更新（“例如：这个访问者 IP 地址正在尝试执行DOS，从现在开始拒绝所有请求”）。相反，该对象将很快被垃圾收集并丢失。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-02-19T02:41:02.330

它是线程安全的。但是，线程安全的方式可能不是您所期望的。您可以从中看到一些“提示”：

> 此类与`Hashtable`依赖其线程安全但不依赖其同步细节的程序完全可互操作

要更全面地了解整个故事，您需要了解`ConcurrentMap`界面。

原文`Map`提供了一些非常基本的读取/更新方法。甚至我也能够对 ; 进行线程安全的实现`Map`。在很多情况下，如果不考虑我的同步机制，人们就无法使用我的 Map。这是一个典型的例子：

```
if (!threadSafeMap.containsKey(key)) {
   threadSafeMap.put(key, value);
} 
```

这段代码不是线程安全的，尽管映射本身是。同时调用`containsKey()`的两个线程可能认为没有这样的键，因此它们都插入到`Map`.

为了解决这个问题，我们需要明确地进行额外的同步。假设我的 Map 的线程安全是通过同步关键字实现的，您需要执行以下操作：

```
synchronized(threadSafeMap) {
    if (!threadSafeMap.containsKey(key)) {
       threadSafeMap.put(key, value);
    }
} 
```

这样的额外代码需要你了解地图的“同步细节”。在上面的例子中，我们需要知道同步是通过“synchronized”来实现的。

`ConcurrentMap`界面更进一步。它定义了一些常见的“复杂”操作，涉及对地图的多次访问。例如，上面的例子被暴露为`putIfAbsent()`. 使用这些“复杂”操作，`ConcurrentMap`（在大多数情况下）用户不需要同步操作与对地图的多次访问。因此，Map 的实现可以执行更复杂的同步机制以获得更好的性能。 `ConcurrentHashhMap`是一个很好的例子。线程安全实际上是通过为映射的不同分区保持单独的锁来维护的。它是线程安全的，因为对 map 的并发访问不会破坏内部数据结构，或者导致任何更新丢失意外等。

考虑到以上所有，Javadoc的含义会更清楚：

“检索操作（包括获取）通常不会阻塞”，因为`ConcurrentHashMap`它没有使用“同步”来保证其线程安全。本身的逻辑`get`负责线程安全；如果您进一步查看 Javadoc：

> 该表在内部进行了分区，以尝试允许指定数量的并发更新而不会发生争用

不仅检索是非阻塞的，甚至更新也可以同时发生。但是，非阻塞/并发更新并不意味着它是线程不安全的。它只是意味着它使用了一些不同于简单“同步”的方式来保证线程安全。

`ConcurrentMap`但是，由于内部同步机制没有暴露出来，如果你想做一些除了`ConcurrentHashMap`. 例如：

```
// only remove if both key1 and key2 exists
if (map.containsKey(key1) && map.containsKey(key2)) {
    map.remove(key1);
    map.remove(key2);
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-02-19T00:26:48.857

`ConcurrentHashmap.get()`是线程安全的，在某种意义上

*   它不会抛出任何异常，包括`ConcurrentModificationException`
*   它将返回在过去某个（最近）时间为真的结果。这意味着两次对 get 的背靠背调用可以返回不同的结果。当然，其他任何`Map`情况也是如此。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-02-19T00:54:03.147

`HashMap`被划分为基于 的[“桶”](https://stackoverflow.com/a/18492835/1393766)`hashCode`。`ConcurrentHashMap`使用这个事实。它的同步机制是基于阻塞桶而不是整个`Map`. 这样，很少有线程可以同时写入几个不同的存储桶（一个线程一次可以写入一个存储桶）。

`ConcurrentHashMap` *从几乎*不使用同步读取。当获取 key 的 value 时使用同步，它看到`null` *value*。由于`ConcurrentHashMap`不能存储`null`为值（是的，除了键，值也不能是`null`s），这表明读取时获取发生在另一个线程初始化映射*条目*（键值对）`null`的中间：当键被分配时，但值还没有，它仍然保持*默认*的空值。 在这种情况下，读取线程将需要等到条目被完全写入。

 **因此，结果`read()`将基于地图的当前状态。如果您读取处于更新过程中的键值，您可能会获得旧值，因为写入过程尚未完成。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-08-20T05:22:26.920

> ConcurrentHashMap 中的 get() 是线程安全的，因为它读取的是 Volatile 的值。如果任何键的值为 null，则 get() 方法会一直等待，直到它获得锁，然后读取更新的值。

当`put()`方法正在更新 CHM 时，它将该键的值设置为 null，然后它创建一个新条目并更新 CHM。该空值被`get()`方法用作另一个线程正在使用相同键更新 CHM 的信号。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-02-19T00:30:35.053

这只是意味着当一个线程正在更新并且一个线程正在读取时，并不能保证第一个调用 ConcurrentHashMap 方法的线程及时将其操作首先发生。

考虑一下关于告诉 Bob 在哪里的项目的更新。如果一个线程询问 Bob 在哪里，而另一个线程更新说他来到了“内部”，则您无法预测阅读器线程会将 Bob 的状态设为“内部”还是“外部”。即使更新线程首先调用该方法，读取线程也可能获得“外部”状态。

线程不会导致彼此的问题。代码是线程安全的。

一个线程不会进入无限循环或开始生成奇怪的 NullPointerExceptions 或获得具有一半旧状态和一半新状态的“itside”。**

# asp.net-mvc - 带有 Razor 的 ASP.NET MVC，自定义 HtmlHelper 仅输出文本

> ID：14947730
> 
> 赞同：2
> 
> 时间：2013-02-19T00:20:02.157
> 
> 标签：asp.net-mvc, razor

我正在尝试使用自定义 HtmlHelpers，但即使是基本的 HtmlHelpers 也无法正常工作。我的代码（只是为了测试）看起来像这样 -

我的课 -

```
namespace HtmlHelpers.Extensions
{
    public static class Helpers
    {
        public static string MySubmitButton(this HtmlHelper helper)
        {
            return String.Format("<input type=\"submit\" value=\"Submit This\">");
        }
    }
} 
```

在我看来 -

```
@using HtmlHelpers.Extensions;
@Html.MySubmitButton() 
```

我认为这应该生成一个简单的提交按钮，但它只是将以下**文本**写入屏幕 -

```
<input type="submit" value="Submit"> 
```

我检查了元素，由于某种原因，整个输入元素都被双引号括起来。有谁知道为什么？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T00:23:50.887

我相信你应该返回一个 MvcHtmlString 类。尝试

```
public static MvcHtmlString MySubmitButton(this HtmlHelper helper)
{
    return MvcHtmlString.Create("<input type=\"submit\" value=\"Submit This\">");
} 
```

尽管如果您查看在线示例或 MVC 源代码（因为它是开源的）可能有更好的方法来执行此操作`TagBuilder`，但您可以查看他们的 html 帮助程序（尽管由于它们的分层方式，它们非常复杂）。

要直接回答您的“为什么”问题，它会像显示字符串一样显示，Razor 是否会尝试确保安全并将您显示的任何内容转换为文本而不是 HTML/脚本。例如，@Model.PeronName 将使用 HTML 字符代码转义 peron 名称中的任何字符。考虑如果没有这样的保护，并且您的一个用户将他们的名字更改为`<script>someDangerousJavascriptThatWouldChangeCurrentUsersPassword()</script>`，然后在您的论坛或任何出现他们名字的地方发布，然后其他用户访问该页面，并且 javascript 运行并发布更改密码表单将当前用户的密码改成黑客在脚本中选择的某个密码。像这样的复杂攻击种类繁多，或者用户可能会不小心输入尖括号（虽然如果将其视为 HTML 则相当无害，但它们会弄乱您的页面显示）。

出于这个原因，MVC 将假定几乎任何字符串都不是 HTML，因此`<script>`用`&lt;script&gt;`它替换基本上是一种说法，即“这不是 html/脚本，我希望你显示小于符号和大于符号”。如果您想将某些内容显示为 HTML，则有一个`@Html.Raw()`帮助程序，它不会清除输出，因此不应与您从用户提供的任何数据连接在一起的字符串一起使用。

# java - Lucene xml 检索

> ID：14947731
> 
> 赞同：1
> 
> 时间：2013-02-19T00:20:17.310
> 
> 标签：java, xml, solr, lucene

我有一个包含 500 个字段的 xml 文件，我研究了 apache digester 选项，但涉及很多工作。我必须创建许多类来涵盖这 500 个字段。假设我搜索 10013，我可以获取匹配的文档名称，但我可以获取以下 xml 语法中的名称字段吗？

```
<contact type="individual"> <name>name feild</name>
    <address>999 W. Prince St.</address>
    <city>New York</city>
    <province>NY</province>
    <postalcode>10013</postalcode>
    <country>USA</country>
    <telephone>1-212-345----</telephone>
</contact> 
```

或者 apache solr 是否为此提供了更好的 api。

# asp.net-mvc - POST 后显示查询字符串

> ID：14947732
> 
> 赞同：0
> 
> 时间：2013-02-19T00:20:38.543
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, asp.net-mvc-4

我正在使用 MVC4/Razor。在 GET 请求之后，视图显示查询字符串，在 POST 请求之后，视图不显示查询字符串 - 两者都符合预期。

但是，我有一个操作`[AcceptVerbs(HttpVerbs.Get | HttpVerbs.Post)]`，我需要向它发布一个表单，并显示相应的查询字符串。

我怎样才能在服务器端做到这一点？*我知道这可以通过转换为 GET 请求在客户端完成，我很想知道如何做到这一点，但前提是这是完成这项工作的唯一方法。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:33:42.900

您可以`return RedirectToAction`使用发布的参数

```
return RedirectToAction("About", "Create", 
                      new { id = PId, Name=PName }); // more params if needed 
```

参数将包含在查询字符串中。

# html - 如果 IE 语句不起作用

> ID：14947733
> 
> 赞同：0
> 
> 时间：2013-02-19T00:20:47.713
> 
> 标签：html, css, margins

```
<!--[if lt IE 7]>  <html class="ie ie6 lte9 lte8 lte7"> <![endif]-->
<!--[if IE 7]>     <html class="ie ie7 lte9 lte8 lte7"> <![endif]-->
<!--[if IE 8]>     <html class="ie ie8 lte9 lte8"> <![endif]-->
<!--[if IE 9]>     <html class="ie ie9 lte9"> <![endif]-->
<!--[if gt IE 9]>  <html> <![endif]-->
<!--[if !IE]><!--> <html>             <!--<![endif]--> 
```

上面的代码，似乎一点也不工作。[我的网站（ The Randy](http://therandy.tk/ "兰迪")）似乎可以使用的唯一 IE 版本是 IE9。由于我在上面输入的条件语句，我认为它可以工作，但它在没有这些语句的情况下也可以在 IE9 中工作。如果我在 IE8 和 IE7 中查看它，我会得到一个看起来很糟糕的网站。非常感激任何的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T00:23:33.997

IE 10 不支持条件注释，而且无论如何都是一个坏主意，尤其是在标准已经制定之后。

您应该始终使用特征检测而不是浏览器检测。

* * *

编辑：阅读控制台也有帮助：

> HTML1513：`<html>`发现额外的“”标签。每个文档只能`<html>`存在一个“”标签。
> therandy.tk，第 9 行字符 20
> 
> HTML1503：意外的开始标记。
> therandy.tk，第 12 行字符 1
> 
> HTML1512：结束标记不匹配。
> therandy.tk，第 245 行字符 208
> 
> HTML1514：`<body>`发现额外的“”标签。每个文档只能`<body>`存在一个“”标签。
> therandy.tk，第 247 行字符 1
> 
> HTML1519：无效的嵌套。一个“ `<a>`”标签不应放置在另一个“ `<a>`”中。
> therandy.tk，第 364 行字符 97

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T00:23:21.820

在您的标记中，您在标签打开`<script>`之前有一个标签。`<html>`这不是有效的代码，IE 可能不喜欢这样。移动它`<script>`，使其位于您的文档中`<head>`。

# coronasdk - 用于 Corona SDK 游戏的背景图像与重复图案/图像？

> ID：14947737
> 
> 赞同：1
> 
> 时间：2013-02-19T00:22:00.493
> 
> 标签：coronasdk

对于基于 2D 滚动的游戏，在 Corona re 静态背景中什么是更好的方法？

假设游戏关卡“大小”相当于两个屏幕宽和两个屏幕深。

Q1 - 一个大的背景图像是一种好的方法吗？这可能会更容易，因为您可以在 Photoshop 中进行准备工作。或者在 Corona 中有一个显着的优势（重新性能）来拥有一个小的图像“图案”并在 Corona （[Lua](http://en.wikipedia.org/wiki/Lua_%28programming_language%29)代码）中重复这个来创建背景？

Q2 - 如果一个大的背景图像方法是可以的，我会假设一个人可能不得不牺牲图像的分辨率，注意尺寸（2xscreens 宽，2xscreens 深）对于更高分辨率的设备是正确的？那是对于[iPad 3](http://en.wikipedia.org/wiki/IPad_%283rd_generation%29)来说，假设您的配置通常会尝试拾取 3x 图像版本（对于其他图像，例如较小的播放图标等），对于背景，您可能必须保持 1x 或 2x 图像大小. 否则，它可能会达到纹理限制（我读过“大多数设备的最大纹理大小为 2048x2048”）。这是正确的/这有意义吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T14:00:00.740

我在我的游戏中使用了这两种方法。

平铺模式的优点：

1.  你可以制作巨大的背景。
2.  可以使用更少的内存（特别是具有大量重复的小瓷砖，如真实世界的壁纸）
3.  允许一些有趣的效果（如视差滚动）。

平铺模式的问题：

1.  使用更多的 CPU 性能
2.  可能有问题并且难以正确运行（例如，我的一个游戏间隙显示在图块之间，但仅在 iPad Retina 上......它需要一些繁重的数学黑客才能使其工作）
3.  很难制作复杂而令人敬畏的背景（为什么我的点击冒险游戏不使用平铺背景）。

请注意，某些设备对纹理大小（以像素为单位）有限制，这可能是单个纹理背景最大的极限。

# sql-server-2008 - 如何在 SQL Server 2008 中的表中搜索给定的行序列

> ID：14947746
> 
> 赞同：1
> 
> 时间：2013-02-19T00:23:18.240
> 
> 标签：sql-server-2008, sequence

问题：

我们在一个表中有许多条目，但我们只对出现在给定序列中的条目感兴趣。例如，我们正在寻找三个特定的“GFTitle”条目（'Pearson Grafton'、'Woolworths (P and O)'、'QRX - Brisbane'），但是它们必须以特定顺序出现才能被视为有效路线。（见下图）

```
RowNum  GFTitle
------------------------------
   1    Pearson Grafton
   2    Woolworths (P and O)
   3    QRX - Brisbane
   4    Pearson Grafton
   5    Woolworths (P and O)
   6    Pearson Grafton
   7    QRX - Brisbane
   8    Pearson Grafton
   9    Pearson Grafton 
```

因此行 (1,2,3) 满足此规则，但行 (4,5,6) 不满足，即使前两个条目 (4,5) 满足。

我确信有办法通过 CTE 做到这一点，但一些帮助会很棒。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:53:39.070

即使使用好的旧工具，这也非常简单:-) 假设您的表名`GFTitles`和`RowNumber`值是连续的，请尝试这个快速而肮脏的解决方案：

```
SELECT a.[RowNum]
      ,a.[GFTitle]
      ,b.[GFTitle]
      ,c.[GFTitle]
 FROM [dbo].[GFTitles] as a
      join [dbo].[GFTitles] as b on b.RowNumber = a.RowNumber + 1
      join [dbo].[GFTitles] as c on c.RowNumber = a.RowNumber + 2
WHERE a.[GFTitle] = 'Pearson Grafton' and
      b.[GFTitle] = 'Woolworths (P and O)' and
      c.[GFTitle] = 'QRX - Brisbane' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:24:37.937

假设`RowNum`既没有重复也没有空白，您可以尝试以下方法。

1.  将行号分配给寻找的序列的项目，并将行集加入到您的表中`GFTitle`。

2.  对于每个匹配项，计算表的行号与序列的行号之间的差异。如果您的表中有匹配的序列，则相应行的`RowNum`差异将是相同的。

3.  计算每个差异的行数，并仅返回计数与序列项数匹配的行。

这是一个实现上述逻辑的查询：

```
WITH SoughtSequence AS (
  SELECT *
  FROM (
    VALUES
      (1, 'Pearson Grafton'),
      (2, 'Woolworths (P and O)'),
      (3, 'QRX - Brisbane')
  ) x (RowNum, GFTitle)
)
, joined AS (
  SELECT
    t.*,
    SequenceLength = COUNT(*) OVER (PARTITION BY t.RowNum - ss.RowNum)
  FROM atable t
  INNER JOIN SoughtSequence ss
  ON t.GFTitle = ss.GFTitle
)
SELECT
  RowNum,
  GFTitle
FROM joined
WHERE SequenceLength = (SELECT COUNT(*) FROM SoughtSequence)
; 
```

[您也可以在 SQL Fiddle](http://sqlfiddle.com/#!3/d36c5/1)上尝试一下。

# android - 一键更新android facebooksdk登录和状态

> ID：14947750
> 
> 赞同：2
> 
> 时间：2013-02-19T00:23:32.997
> 
> 标签：android, facebook-android-sdk

我需要通过 android 应用程序中的 facebook 按钮实现共享。我阅读了官方的 facebook sdk 文档，我能找到的唯一方法是首先让用户使用登录按钮进行身份验证，然后让他更新状态。由于 facebook 的东西在应用程序中真的很边缘，我想找到一种方法让用户只单击一次按钮（自定义按钮，而不是 com.facebook.widget.LoginButton），然后如果已经登录，更新时间线，否则，登录并直接更新时间线。

我真的需要让用户在这些步骤中完成任务： -
单击我的按钮
-如果未登录，请登录对话框、新活动或其他任何内容-
打开对话框（自定义或来自 facebook sdk，没关系）带有消息的编辑文本和更新/取消按钮

我[阅读](http://www.androidhive.info/2012/03/android-facebook-connect-tutorial/)了本教程，但似乎不推荐使用那里使用的所有内容（即使尝试初始化 com.facebook.android.Facebook 对象时也收到了不推荐使用的警告），所以我想知道是否有一种实现一键状态更新的好方法。

我已经在 Twitter 上这样做了，Facebook 也必须有一些方法！

# c# - 自定义 Web Config Collection 需要全新的视角

> ID：14947753
> 
> 赞同：0
> 
> 时间：2013-02-19T00:23:36.407
> 
> 标签：c#, web-config

我已经看这个太久了。我知道我只是在做一些愚蠢的事情，但我看不到。在添加异常之前，我的集合始终为空。添加后，它总是被抛出。我错过了什么？

我有一个如下所示的 Web 配置集合：

```
 <section name="WorkOutGroups" type="System.Configuration.WorkOutGroupsSection"/>

<WorkoutGroups>
    <Workouts>
        <add url="something.asp" />
        <add url="/subfolder/another.asp" />
        <add url="../default.asp" />
    </Workouts>
</WorkoutGroups> 
```

我的课程如下所示：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Configuration;
using System.Collections;

namespace MySite.Configuration
{
    public class WorkOutsGroupsSection : ConfigurationSection
    {
        [ConfigurationProperty("WorkOut", IsDefaultCollection = false)]
        [ConfigurationCollection(typeof(WorkOutCollection))]
        public WorkOutCollection WorkOut
        {
            get
            {
                var WorkOut = (WorkOutCollection)base["WorkOut"];
                return WorkOut;
            }
        }
    }

    public class WorkOutCollection : ConfigurationElementCollection
    {
        protected override ConfigurationElement CreateNewElement()
        {
            return new WorkOutElement();
        }

        protected override object GetElementKey(ConfigurationElement element)
        {
            object result = null;
            if (element is WorkOutElement)
            {
                result = ((WorkOutElement)element).WorkOut;
            }
            return result;
        }

        public WorkOutElement this[int index]
        {
            get { return (WorkOutElement)BaseGet(index); }
        }
    }

    public class WorkOutElement : ConfigurationElement
    {
        [ConfigurationProperty("url", IsRequired = true, IsKey = true)]
        public string WorkOut
        {
            get
            {
                return (string)this["url"];
            }
            set
            {
                this["url"] = value;
            }
        }
    }

    public static class WorkOutsGroups
    {
        static WorkOutsGroupsSection WorkOutsGroupsSection
        {
            get
            {
                var section = ConfigurationManager.GetSection("WorkOutsGroups")
                    as WorkOutsGroupsSection;
                if (section != null)
                {
                    return section;
                }
                throw new ConfigurationErrorsException("WorkOutsGroups Configuration not found");
            }
        }

        public static IEnumerable<string> GetWorkOut()
        {
            var results = WorkOutsGroupsSection.WorkOut
                     .OfType<WorkOutElement>()
                     .Select(p => p.WorkOut);

            return results.ToArray();
        }
    }
} 
```

我正在像这样实现它：

```
foreach (var url in Workout.GetWorkout())
{
    if (link.Value.Contains(url.ToString()))
        returnValue = true;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T12:40:34.937

你有

```
var WorkOut = (WorkOutCollection)base["WorkOut"]; 
```

在您的 C# 代码中，但 WorkOut在您**的**配置中。

也许这就是原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T12:38:54.803

拼写：

```
ConfigurationManager.GetSection("WorkOutsGroups") 
```

部分名称`WorkOutGroups`不是`WorkOutsGroups`

# date - 使用修改后的日期自动更新谷歌电子表格

> ID：14947757
> 
> 赞同：1
> 
> 时间：2013-02-19T00:24:01.353
> 
> 标签：date, google-apps-script, google-sheets

一直在尝试让谷歌电子表格在编辑另一个单元格时自动将数据添加到一个单元格中，但是我似乎只能让 onedit 函数在全局范围内工作。

具体来说，如果编辑了 B2、B3、B4 等，我希望 N2、N3、N4 等自动填充时间戳或用户名。

我已经能够让触发器工作，但我无法将输出输出到我的单元格。这是我设置的宏-

```
function onedit(event) 
{
  var ss = SpreadsheetApp.getActiveSheet();
  var rr  = SpreadsheetApp.getActiveRange();

  if(ss.getIndex()!= 2)
   return;

  var firstRow = rr.getRow();
  var lastRow = rr.getLastRow();

  ss.getActiveCell().setValue(today());
} 
```

使用 setValue(today) 似乎不会自动更新单元格。任何帮助将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-24T20:32:02.713

```
function onEdit(e) {
  var s = e.source.getActiveSheet();

  if( s.getIndex()== 2 ) {
    var r = s.getActiveRange();
    if( r.getColumn() == 2) {
      s.getRange(r.getRow(),14).setValue(new Date());

    }
  }
} 
```

# objective-c - 为新类添加新类别时，您将代码放在哪里？

> ID：14947758
> 
> 赞同：0
> 
> 时间：2013-02-19T00:24:07.847
> 
> 标签：objective-c

如果我需要声明和定义一个类别，假设我有：

```
@interface Calculator (Trig)

-(double) sin;
-(double) cos;
-(double) tan;

@end 
```

我想实现和定义这些方法，我应该把它们放在计算器文件的什么地方？我的意思是这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:47:47.837

一种常见的风格是将类别放在名为`ClassName+CategoryName.h`(and .m) 的文件中，例如`Calculator+Trig.h`(and .m)。但是使用任何你喜欢的风格，真的。我个人发现有时在同一个文件中包含多个相关类别是有益的。

# db2 - WinSQL 和 DB2 导出

> ID：14947760
> 
> 赞同：0
> 
> 时间：2013-02-19T00:24:19.953
> 
> 标签：db2, winsql

我正在尝试使用将一行导出到 DEL 文件；

```
EXPORT TO ExportedFile.DEL OF DEL SELECT * From MyTable 
```

但是，当我执行查询时，我得到了这个；

```
Error: SQL0104N  An unexpected token "ExportedFile" was found following "EXPORT TO ".  Expected tokens may include:  "JOIN".  SQLSTATE=42601 
```

我了解 Export 不是 WinSQL 中受支持的命令，但是否有受支持的命令？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-29T19:17:17.467

WinSQL 仅通过 ODBC 将其信息传递给后端数据库。因此，我想添加到@Ian Bjorhovde 的答案，并建议您将该调用输入到 WinSQL 中 DB2 的查询窗口中，即：

call sysproc.admin_cmd('export to /tmp/file.del of del select * from table')

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T06:25:32.357

`EXPORT`是一个实用程序——不是 SQL 语句——由 DB2 命令行处理器处理。

`EXPORT`IBM通过使用`ADMIN_CMD`存储过程可以在 SQL 语句中执行该实用程序：

```
call sysproc.admin_cmd('export to /tmp/file.del of del select * from table') 
```

请注意，与`EXPORT`直接在带有 DB2 客户端的机器上使用该实用程序不同，这会将文件写入数据库服务器上的指定路径。您必须手动从服务器检索文件。

# django - django-registration 与管理员激活帐户的临时注册实现

> ID：14947764
> 
> 赞同：3
> 
> 时间：2013-02-19T00:25:02.253
> 
> 标签：django, django-registration, user-registration

我需要实现一个相当简单的注册工作流程：

*   用户填写注册请求（表格）。
*   管理员收到有关注册请求的通知。（也许）
*   管理员从 django-admin 界面激活所需的用户。
*   用户收到有关其帐户激活的通知。

我一直在阅读有关[django-registration](https://django-registration.readthedocs.io/en/3.0.1/)应用程序的信息。

从我读过的内容来看，这个应用程序似乎使用频率很高，但我不确定它的优势。

所以，我的问题是：从以下选项中（我也对其他选择持开放态度），在这种情况下什么会更好？

*   从头开始实施所有注册。
*   在 django-registration 上扩展后端之一。
*   从头开始编写 django-registration 后端。

另外，请支持选择的**原因。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T02:17:41.623

您可能想看看[django 检查注册](http://pypi.python.org/pypi/django-inspectional-registration)它非常适合您的用例。它是 django 注册的增强版本，因为后者没有批准/拒绝用户注册的功能。

# image - 尝试上传图片时出现 CORS 错误

> ID：14947767
> 
> 赞同：0
> 
> 时间：2013-02-19T00:25:24.400
> 
> 标签：image, wcf, cors, access-control

我正在开发一个基于 Backbone.js 的 Web 应用程序，它与 WCF 服务通信并将“投诉”上传到 SQL 数据库。投诉模型具有各种属性，如标题、描述等。它还具有 ImageByte 属性，因此用户可以上传与该投诉相关的图像。我将图像作为 Base64 字符串发送到 WCF 服务。

我已经解决了有关解决这些跨域错误的所有相关问题并尝试了它们。我的问题的奇怪和不同之处在于，当我发送没有图像的投诉模型时，一切正常且顺利。但是当我将 ImageByte 添加到模型中时，我得到了同样的旧错误。

```
Origin http://localhost:55708 is not allowed by Access-Control-Allow-Origin. 
```

我不明白这里发生了什么。如果是跨域通信问题，即使没有图像字符串，它也应该给我错误。这与发送内容的长度有关吗？我将整个模型作为 JSON 发送。

任何形式的解释/帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:44:11.093

没关系。我发现这是因为传递的 JSON 数据的长度。仍然不明白为什么会这样，但是当我将以下内容添加到 web.config 文件时，错误得到了解决

```
<bindings>
  <webHttpBinding>
    <binding maxReceivedMessageSize="10485760">
      <readerQuotas maxArrayLength="100000000" maxBytesPerRead="100000000" />
    </binding>
  </webHttpBinding>
</bindings> 
```

希望这对将来的其他人有所帮助。

# javascript - 在 JavaScript 中查找与字符串不匹配的行

> ID：14947772
> 
> 赞同：2
> 
> 时间：2013-02-19T00:26:14.710
> 
> 标签：javascript, regex, match

我只需要找到不匹配字符串的第一行 - 这可能比找到所有字符串更容易。到目前为止，我发现的唯一解决方案是删除包含字符串的行，然后我选择其余的行。

例如，在以下文本中，我需要找到不包含字符串的行`"line"`- 那将是第四行：`Lazy Bear`.

> 一线
> 二线
> 三线
> 懒熊

测试它的最简单方法是在书签中，所以这里是：

```
var myText = "First line" + "\n";
var myText = myText + "Second line" + "\n";
var myText = myText + "Third line" + "\n";
var myText = myText + "Lazy Bear" + "\n";

var p = prompt("My Text = ", myText);

var x = myText.replace(/.*line.*/g, "");
var x = x.replace(/\n/g, "");
var p = prompt("Result:", x); 
```

笔记：

1.  “提示”行仅用于调试目的

2.  如果我在 Bookmarklets 中只使用“myvar=..”而不是“var myvar=..”，它将修改当前页面，打印变量。)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T00:45:40.850

正则表达式`/^(?!.*line).*$/m`匹配不包含模式“line”的行。

`null`如果没有这样的行，则返回以下代码，否则返回第一行：

```
myText.match(/^(?!.*line).*$/m); 
```

完整的代码如下所示：

```
var x = (myText.match(/^(?!.*line).*$/m)||['no result found'])[0]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T04:31:22.667

由于没有一个答案提到这一点：

```
str.match(/^(?!.*line).*$/gm); 
```

该`m`标志使`^`and`$`匹配一行的开头和结尾，而不是整个字符串。

由于`.`不匹配换行符，负前瞻包含在同一行中。

请注意，如果字符串以 结尾`\n`，则结果中的最后一个元素将有一个空字符串，这是完全正常的，因为该空字符串是单独的一行。如果您只想捕获非空字符串（即使在输入字符串的中间），那么您可以对正则表达式进行一些小改动：

```
str.match(/^(?!.*line).+$/gm); 
```

从`*`强制`+`正则表达式匹配非空行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T00:32:59.803

我跳过了提示内容，因为我不确定你在做什么。

```
var myText = "First line" + "\n";
var myText = myText + "Second line" + "\n";
var myText = myText + "Third line" + "\n";
var myText = myText + "Lazy Bear" + "\n";
var myTextAsArrayOfLines = myText.split("\n");
for(var i = 0; i < myTextAsArrayOfLines.length; i++)
{
  if(myTextAsArrayOfLines[i].indexOf("line") === -1)
  {
    window.alert("The first line that didn't contain 'line' was " + ((i + 1) + '');
    //end looping
    i = i.length;
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T00:34:20.383

```
var myText = "First line" + "\n";
var myText = myText + "Second line" + "\n";
var myText = myText + "Third line" + "\n";
var myText = myText + "Lazy Bear" + "\n";
var p = prompt("My Text = ", myText);

var lines = myText.split("\n"), result; // split the text into an array to loop through it

for(var i = 0, len = lines.length; i < len; i++) {
    if(lines[i].indexOf("line") < 0) { // if we find a line that doesn't match
        result = lines[i];
        break; // if we find a result break the loop
    }
}

console.log("Result: " + result); // log the line containing the result 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-19T00:35:12.380

您可以拆分行`\n`，然后使用 Array`.filter`方法仅获取不匹配的行：

```
myText.split("\n").filter(function (elem) {
    return elem.indexOf(p) === -1;
}); 
```

[http://jsfiddle.net/ExplosionPIlls/S7B5f/1/](http://jsfiddle.net/ExplosionPIlls/S7B5f/1/)

# javascript - 在 IE9 中浏览时在 javascript 中获取未定义的 Datakey 值

> ID：14947773
> 
> 赞同：0
> 
> 时间：2013-02-19T00:26:17.360
> 
> 标签：javascript, asp.net, internet-explorer

我有一个网页，其中的 javascript 在 IE7 上运行良好。现在我们必须使用 IE9 并且页面无法正常工作。在页面上，我们使用 javascipt 将 datakey 作为 cookie 存储在 datagrid 中。然而，javascript 获取 datakey 的值是未定义的。有人会告诉我如何解决这个问题。提前致谢。

数据网格有 aspx 页面：

```
 <asp:datagrid id="dgrdLocationWeeks" runat="server" ShowFooter="True"                
           autogeneratecolumns="false"   cssclass="dgrid2" cellpadding="5" width="550" 
          datakeyfield="LocationId"> 
```

源视图中有一行数据网格。

```
<input name="dgrdLocationWeeks$ctl02$chkHideLocation" type="checkbox" 
    id="dgrdLocationWeeks_ctl02_chkHideLocation" locationID="7" /> 
```

我的 javascript 来获取 datakey 的值是这样的：

```
strHideLocations += document.getElementById(ctrlPrefixName + rowIndex + 
    ctrlSuffixName).locationID 
```

我知道我可以将数据键放入列中，但是这样的页面中有很多数据网格。我认为最好在javascript上修复它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T01:38:08.223

试试这个对浏览器更友好的方法：

```
var elem = document.getElementById(elemId); //in your case: ctrlPrefixName + rowIndex + ctrlSuffixName
var locID = elem.locationID || elem.getAttribute('locationID');
//alert(locID); 
```

# ios - 无法从 iOS 应用程序将大型视频上传到 Facebook

> ID：14947776
> 
> 赞同：0
> 
> 时间：2013-02-19T00:26:34.943
> 
> 标签：ios, facebook, video, upload, afnetworking

我正在尝试将大文件视频文件上传到 Facebook，但无论采用何种方法，结果总是相同的。该过程会上传 5-35mb 的数据，然后超时。这发生在 WiFi 上。

我尝试过使用 Facebook SDK 3.1.1、iOS 社交库（即 SLRequest）和 AFNetworking。

社交库和 afnetworking 会出现超时错误，而 Facebook SDK 只返回代码 5，无法完成操作，HTML 错误 200，但如果我通过仪器观看网络活动，它具有相同的签名，即一定数量的在停止之前上传兆字节。

请注意，使用这三种方法中的任何一种，我都可以毫无问题地上传较小的视频。

**有没有人遇到过这个问题并找到任何解决方案或原因？**

ps 我相信它是一个 Facebook 错误，如果其他人想订阅它以鼓励他们调查它，我已经在那里记录了一个问题（[https://developers.facebook.com/bugs/265409976924087](https://developers.facebook.com/bugs/265409976924087)）。

**Facebook SDK 代码**

```
NSData *videoData = [NSData dataWithContentsOfFile:videoUrlStr options:NSDataReadingMappedAlways error:&lError];
NSString *description = self.streamToShare.videoDescription;

    if (description == nil){
        description = @"";
    }
NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObjectsAndKeys:videoData, self.streamToShare.publishedStoryFileName,
                                       @"video/quicktime", @"contentType",
                                       self.streamToShare.name, @"title",
                                       description,@"description",
                                       nil];
[FBRequestConnection startWithGraphPath:@"me/videos" parameters:params HTTPMethod:@"POST" completionHandler:^(FBRequestConnection *connection, id result, NSError *error) {
            if (error) {
                self.errorMessage = [NSString stringWithFormat:@"error: domain = %@, code = %d, description = %@", error.domain, error.code, error.localizedDescription];
            } 
} 
```

**iOS 原生库和 AFNetworking 代码**

```
[accountStore requestAccessToAccountsWithType:facebookTypeAccount
                                              options:@{ACFacebookAppIdKey: appID,ACFacebookPermissionsKey: @[@"publish_stream"],ACFacebookAudienceKey:ACFacebookAudienceFriends} completion:^(BOOL granted, NSError *error) {
  if(granted){
    NSArray *accounts = [accountStore accountsWithAccountType:facebookTypeAccount];
    facebookAccount = [accounts lastObject];
    NSLog(@"Facebook Login Success");
    NSURL *videourl = [NSURL URLWithString:@"https://graph.facebook.com/me/videos"];
    NSURL *pathURL = [[NSURL alloc]initFileURLWithPath:self.streamToShare.publishedStoryURL isDirectory:NO];
    NSDictionary *params = @{
      @"title": self.streamToShare.name,
      @"description": description
    };
    SLRequest *uploadRequest = [SLRequest requestForServiceType:SLServiceTypeFacebook requestMethod:SLRequestMethodPOST URL:videourl parameters:params];
    [uploadRequest addMultipartData:videoData withName:@"source" type:@"video/quicktime" filename:[pathURL absoluteString]];
    uploadRequest.account = facebookAccount;
    NSURLRequest *urlRequest = [uploadRequest preparedURLRequest];
    NSMutableURLRequest *mutableUrlRequest = [urlRequest mutableCopy];
    [mutableUrlRequest setCachePolicy:NSURLRequestReloadIgnoringLocalAndRemoteCacheData];
    [mutableUrlRequest setTimeoutInterval:60]; // adjusting this does not fix the issue

    // AF Networking Code                                                
    NSInputStream *stream = [[NSInputStream alloc] initWithData:videoData];
    [mutableUrlRequest setHTTPBodyStream:stream];
    AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc]initWithRequest:mutableUrlRequest];
    [operation setUploadProgressBlock:^(NSUInteger bytesWritten, long long totalBytesWritten, long long totalBytesExpectedToWrite) {
       NSLog(@"%lld bytes out of %lld sent", totalBytesWritten, totalBytesExpectedToWrite, progress);
     }];
    [operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
      NSLog(@"Facebook upload success");
      }   failure:^(AFHTTPRequestOperation *operation, NSError *error) {
      NSLog(@"Facebook upload error %@",error.localizedDescription);
      }
     }];
     [operation start];

     // iOS Native Library Upload - Commented out so AFNetworking could be tested                                               
     //NSURLResponse *urlResponse = nil;
     //NSError *urlRequestError = nil;
     /*[NSURLConnection sendSynchronousRequest:mutableUrlRequest returningResponse:&urlResponse error:&urlRequestError];
    if (urlResponse == nil) {
      // Check for problems
      if (urlRequestError != nil) {
         NSLog(@"Error %@", urlRequestError.localizedDescription);
      }
     }
     else {
       // Data was received.. continue processing
       NSLog(@"Worked!");
     }*/

  }else{
    // ouch
    NSLog(@"Permission not granted. Error: %@", error);
  }
}]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T16:35:28.967

graph.facebook.com 似乎只接受小视频。尝试发布到**graph-video.facebook.com/me/videos**

```
NSURL *videourl = [NSURL URLWithString:@"https://graph-video.facebook.com/me/videos"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-15T22:15:01.913

这已在最新的 SDK 中得到解决。它现在可以正常工作。

# javascript - 在画布元素上旋转精灵

> ID：14947777
> 
> 赞同：5
> 
> 时间：2013-02-19T00:26:36.280
> 
> 标签：javascript, html, canvas

我有一个带有精灵的玩家类，我想让它面向我的鼠标指针。

我正在使用它来计算精灵的旋转应该是什么：

```
this.rotation = -(Math.atan2(this.x - mouseState.x, this.y - mouseState.y) * 180 / Math.PI); 
```

然后在我`Player`班级的 draw 方法中，我正在这样做：

```
Player.prototype.draw = function() {
    window.ctx.save();
    window.ctx.translate(this.x + this.sprite.width / 2, this.y + this.sprite/height / 2);
    window.ctx.rotate(this.rotation);
    window.ctx.drawImage(this.sprite, this.x, this.y);
    window.ctx.restore();
} 
```

它做了一些事情，但不是我想要的。精灵似乎在画布的左上角（`x:0, y:0`）周围疯狂地移动。

如何使精灵面向鼠标光标，同时使用其中心点作为原点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T02:52:05.323

你没有翻译回来。请注意我在下面添加的额外`window.ctx.translate`调用，并注意我如何为 x 和 y 值添加负数。

```
Player.prototype.draw = function() {
    window.ctx.save();
    window.ctx.translate(this.x + this.sprite.width / 2, this.y + this.sprite/height / 2);
    window.ctx.rotate(this.rotation);
    window.ctx.translate(-this.x + this.sprite.width / 2, -this.y + this.sprite/height / 2);
    window.ctx.drawImage(this.sprite, this.x, this.y);
    window.ctx.restore();
} 
```

基本上，这样做是将画布上下文中心移动（平移）到您的对象中心，旋转（旋转），然后您需要将中心点从您那里移回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:35:16.697

> Math.atan2(y,x)

请注意，`y`参数首先出现，*然后*是`x`. 交换你的论点。

此外，它返回一个以弧度表示的值，如果您尝试调用`Math.atan2(1,0)`. 删除度数的转换。

> 这是以弧度为单位的顺时针旋转

意思是，你不希望你的 rad-deg 转换。

```
this.rotation = Math.atan2(this.y-mouseState.y, this.x-mouseState.x);

window.ctx.rotate(this.rotation); 
```

# macos - 带有 SLF4J 参考的空 maven 项目具有 log4j“找不到附加程序”警告

> ID：14947780
> 
> 赞同：0
> 
> 时间：2013-02-19T00:27:00.853
> 
> 标签：macos, maven, log4j, slf4j

这个问题似乎与[Using Logback 有关，但 Log4j 开始显示 WARN no Appenders](https://stackoverflow.com/questions/14325508/using-logback-but-log4j-started-displaying-warn-no-appenders)，但那里的答案似乎并没有为我解决这个问题。

当我创建一个除了 slf4j 之外没有依赖项的 maven 项目时，我收到一个警告：

```
log4j:WARN No appenders could be found for logger (com.example.App).
log4j:WARN Please initialize the log4j system properly. 
```

脚步：

在一个空目录中，执行

```
mvn archetype:generate -DarchetypeGroupId=org.apache.maven.archetypes -DarchetypeArtifactId=maven-archetype-quickstart

Define value for property 'groupId': : com.example
Define value for property 'artifactId': : slf4jtest
Define value for property 'version':  1.0-SNAPSHOT: : 
Define value for property 'package':  com.example: : 
```

将 SLF4J 添加到 pom.xml：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <groupId>com.example</groupId>
  <artifactId>slf4jtest</artifactId>
  <version>1.0-SNAPSHOT</version>
  <packaging>jar</packaging>

  <name>slf4jtest</name>
  <url>http://maven.apache.org</url>

  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
  </properties>

  <dependencies>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>3.8.1</version>
      <scope>test</scope>
    </dependency>
    <dependency>
          <groupId>org.slf4j</groupId>
          <artifactId>slf4j-api</artifactId>
          <version>1.7.2</version>
      </dependency>
<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>slf4j-simple</artifactId>
    <version>1.7.2</version>
</dependency>
  </dependencies>
</project> 
```

在 App.java 中调用记录器

```
package com.example;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

/**
 * Hello world!
 *
 */
public class App 
{
    public static void main( String[] args )
    {
        Logger logger = LoggerFactory.getLogger(App.class);
        logger.debug("hello");
        System.out.println( "Hello World!" );
    }
} 
```

执行：

```
mvn package 
```

执行：

```
mvn exec:java -Dexec.mainClass="com.example.App" 
```

输出：

```
log4j:WARN No appenders could be found for logger (com.example.App).
log4j:WARN Please initialize the log4j system properly.
Hello World! 
```

log4j 未列为依赖项：

```
$ mvn dependency:tree
[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building slf4jtest 1.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-dependency-plugin:2.1:tree (default-cli) @ slf4jtest ---
[INFO] com.example:slf4jtest:jar:1.0-SNAPSHOT
[INFO] +- junit:junit:jar:3.8.1:test
[INFO] \- org.slf4j:slf4j-api:jar:1.7.2:compile
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1.872s
[INFO] Finished at: Tue Feb 19 11:23:33 EST 2013
[INFO] Final Memory: 5M/81M
[INFO] ------------------------------------------------------------------------ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T06:42:03.350

所以我没有意识到 Mac OS X 在 /Library/Java/Extensions 下预装了 log4j 和 slf4j... 我通过运行以下命令发现了这一点：

```
java -verbose:class -cp ~/.m2/repository/junit/junit/3.8.1/junit-3.8.1.jar:~/.m2/repository/org/slf4j/slf4j-api/1.7.2/slf4j-api-1.7.2.jar:./target/classes com/example/App 
```

...并发现（在许多其他类中）这些类被优先加载和使用，而不是我通过 maven 包含的类。

```
/Library/Java/Extensions/log4j-1.2.15.jar
/Library/Java/Extensions/slf4j-log4j12-1.5.8.jar
/Library/Java/Extensions/slf4j-api-1.5.8.jar 
```

不确定这个问题的“正确”解决方案是什么，但从该目录中删除所有这些文件似乎可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T02:43:33.320

不能复制。我得到了预期的 SLF4J 绑定失败：

```
SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
Hello World! 
```

我的依赖树看起来和你的一样：

```
[INFO] --- maven-dependency-plugin:2.1:tree (default-cli) @ slf4jtest ---
[INFO] com.example:slf4jtest:jar:1.0-SNAPSHOT
[INFO] +- junit:junit:jar:3.8.1:test
[INFO] \- org.slf4j:slf4j-api:jar:1.7.2:compile
[INFO] ------------------------------------------------------------------------ 
```

系统信息：

```
$ mvn -version
Apache Maven 3.0.4 (r1232337; 2012-01-17 02:44:56-0600)
Maven home: d:\dev\tools\maven
Java version: 1.7.0_03, vendor: Oracle Corporation
Java home: d:\dev\tools\java\jre
Default locale: en_US, platform encoding: Cp1252
OS name: "windows 7", version: "6.1", arch: "amd64", family: "windows" 
```

# java - 存储在数组和打印数组中

> ID：14947786
> 
> 赞同：0
> 
> 时间：2013-02-19T00:27:22.157
> 
> 标签：java, arrays

我必须创建一个程序，向用户询问一系列数字，并将输入保存在一个数组中。然后稍后允许用户在数组中搜索一个数字并打印该数组。我被卡住了，因为它不允许我将输入存储在数组中。我还需要帮助打印数组。

我正在上 Java 课，我们使用的教科书根本没有帮助，有没有人推荐一本好的 Java 教科书？

到目前为止，这是我的代码：

```
import java.util.Scanner;
public class MyContainer  {

  private int [] values;
  private int size;

 public MyContainer() {
    values = new int[50];
    size=0;
  }

  public static void main(String [] args)
  {

//load()
Scanner input = new Scanner(System.in);
double sum = 0;
System.out.print("Enter a positive number, negative number will end entry.");
double number = input.nextDouble();
int count = 0;
double average = 0;
int numofinput = 0;

 while (number >= 0)
{
  count++;
  numofinput ++;
  sum += number;
  System.out.print("Enter a positive number, negative number will end entry.");
  number = input.nextDouble();
}
 sum = sum + number;
 average = sum/numofinput;
    System.out.print("The average of the numbers as of right now is "
+ average);

}

//search() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:53:57.340

简要总结一下我所做的更改：

1）你有 3 个变量做同样的事情，所以我去掉了其中的 2 个。（numOfInputs 和计数）。

2）您正在通过循环向用户询问数字，但您从未将数字添加到数组中。

3）我在循环中添加了一个条件，以便在 50 个数字后循环停止，这样你就永远不会超过数组的大小。

4）将大部分主要内容移至另一种方法。Java（和大多数其他语言）不允许静态方法访问非静态变量。所以 main 创建了一个 MyContainer 的新实例，然后调用一个方法来进行添加。

5）我添加了一个打印列表方法，它只是使用循环遍历列表。

导入 java.util.Scanner；

公共类 MyContainer {

```
private double[] values;
private int size;
public MyContainer() {
    values = new double[50];
    size = 0;
}

public void run(){
    // load()
    Scanner input = new Scanner(System.in);
    double sum = 0;
    System.out.print("Enter a positive number, negative number will end entry.");
    double number = input.nextDouble(); 
```

// 整数计数 = 0; //计数去除双重平均= 0;

```
 while (number >= 0 && size < values.length) {
        values[size] = number; //Line added
        size++;
        sum += number;
        System.out.print("Enter a positive number, negative number will end entry.");
        number = input.nextDouble();
    }

    sum = sum + number;
    average = sum / size;
    System.out.println("The average of the numbers as of right now is " + average);

}

public void printList(){
    System.out.print("[");
    for (int i = 0; i <= size; i++){
        System.out.print(values[i]+", ");
    }
    System.out.println("end]");
}

public static void main(String[] args) {
    MyContainer cont = new MyContainer();
    cont.run();
    cont.printList();
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:41:14.827

你真的应该搜索这样的东西，有很多关于如何使用这样的数组的例子：[How to put a Scanner input into an array... 例如几个数字](https://stackoverflow.com/questions/2795350/how-to-put-a-scanner-input-into-an-array-for-example-a-couple-of-numbers)

# git - 从拉取请求克隆 GitHub？

> ID：14947789
> 
> 赞同：166
> 
> 时间：2013-02-19T00:27:28.673
> 
> 标签：git, github, pull-request

我想从 GitHub 克隆一个存储库。问题是我不想要主分支；我想要[这个未经批准的拉取请求](https://github.com/dweldon/frappe/pull/2)中的版本。

我是否可以克隆拉取请求版本而不是主存储库？

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2013-02-20T00:04:48.470

最简单的方法是这样的：

```
git fetch origin pull/2/head
git checkout -b pullrequest FETCH_HEAD 
```

您现在将位于处于拉取请求状态的新分支上。

您可能希望通过运行设置别名

```
git config --global alias.pr '!f() { git fetch -fu ${2:-origin} refs/pull/$1/head:pr/$1 && git checkout pr/$1; }; f' 
```

现在你可以通过运行检查任何 PR `git pr <pr_number>`，或者`git pr <pr_number> <remote>`如果你的 github 远程没有命名`origin`。

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2013-02-19T00:42:41.277

您可以使用`-b`选项克隆您想要的分支，并用于拉取请求：

```
git clone https://github.com/user_name/repo_name.git -b feature/pull_request_name dir_name 
```

在您的情况下，您要克隆的分支是拉取请求的源分支（`feature/mongoose-support`）：

```
git clone https://github.com/berstend/frappe.git -b feature/mongoose-support ./mongoose-support 
```

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2015-02-20T05:12:21.130

```
git fetch origin refs/pull/PR_NUMBER/head:NEW_LOCAL_BRANCH 
```

例如：

```
git fetch origin pull/611/head:pull_611
git checkout pull_611 
```

在 GitHub 上从你的 fork 进行更改、提交、推送和打开新 PR

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-02-19T00:45:26.613

您可以按照[此要点](https://gist.github.com/kennethreitz/3709868)中的说明直接签出远程，而无需弄清楚它们的存储库和分支。

**示例用法**

对于我的一个项目（github3.py），我在我的`github3.py/.git/config`

```
[remote "github"]
    fetch = +refs/heads/*:refs/remotes/github/*
    fetch = +refs/pull/*/head:refs/remotes/github/pr/*
    url = git@github.com:sigmavirus24/github3.py 
```

第一行是每个遥控器的标准，但`github`被遥控器名称替换的例外。这意味着远程头（或该服务器上的分支头）被“映射”到前缀为`github/`. 因此，如果我`git fetch github`在 GitHub 上有一个在我的机器上本地尚未注意到的分支，它会下载该分支，我可以像这样切换到它`git checkout -t github/branch_name`：

第二行做同样的事情，但它是为拉取请求而不是标准的 git 分支做的。这就是你看到的原因`refs/pull/*/head`。它获取 GitHub 上每个拉取请求的头部并将其映射到`github/pr/#`. 因此，如果有人发送一个拉取请求并且它的编号为 62（例如），你会这样做：

```
git fetch github
git checkout -t github/pr/62 
```

然后你会在一个名为的本地分支上`pr/62`（假设它不存在）。这很好，意味着您不必跟踪其他人的遥控器或分支机构。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2015-09-08T00:29:03.517

```
git clone git://github.com/dweldon/frappe
cd frappe
git pull origin pull/2/head 
```

[如何为我不拥有的分支获取未合并的拉取请求？](https://stackoverflow.com/q/6743514/#32443551)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-02-19T00:43:50.737

当用户提交拉取请求时，他们要求将一些更改从其分叉克隆上的分支合并回另一个用户的存储库。

您想要的更改可以从拉取请求的来源获得。为此，请克隆用户的存储库 ( `git://github.com/berstend/frappe.git`)，然后检查他从 ( `feature/mongoose-support`) 创建拉取请求的分支。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2020-04-27T14:05:42.830

使用 Github 的官方新[命令行界面](https://cli.github.com/)：

```
gh repo clone org/repo
cd repo
gh pr checkout 44 
```

其中`44`是 PR 编号，但也可以是分支名称。

* * *

请参阅其他[详细信息和选项](https://cli.github.com/manual/gh_pr_checkout)以及[安装说明](https://cli.github.com/manual/installation)。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2021-09-08T18:13:30.873

要将 PR 拉到您当前的分支，请使用：

`git pull origin pull/418/head`

这里`pull/{no. of PR}/head`

[![在此处输入图像描述](../Images/b53292b2001b7d53f3e82488432ceb93.png)](https://i.stack.imgur.com/MVlpc.png)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-02-03T01:44:13.273

对我来说，这很简单

```
git fetch origin pull/4/head 
```

在`4`这里找到的地方：

[![在此处输入图像描述](../Images/75084b34c770ba1f0287939799ec6a71.png)](https://i.stack.imgur.com/XkHKNm.png)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-01-11T03:22:06.717

安装[git-extras后](https://github.com/tj/git-extras)

```
(cd /tmp && git clone --depth 1 https://github.com/tj/git-extras.git && cd git-extras && sudo make install) 
```

你可以简单地使用[`git pr`](https://github.com/tj/git-extras/wiki/Commands#git-pr)

```
$ git pr 62 [remote] 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-06-02T10:37:22.527

列出和获取 PR 的 BitBucket 约定：

```
git ls-remote origin 'refs/pull-requests/*'
git fetch origin refs/pull-requests/998/from:local-branch-name 
```

全文在这里：[https ://www.atlassian.com/git/articles/pull-request-proficiency-fetching-abilities-unlocked](https://www.atlassian.com/git/articles/pull-request-proficiency-fetching-abilities-unlocked)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-11-12T16:50:24.817

带有“-b”选项的公认答案对我不起作用，所以这就是我最终得到的。在 Github 中创建拉取请求后，您将被带到可以看到如下内容的页面，其中“ogryb”是我的用户名，“patch-1”是分配给它的自动生成的名称。

[![在此处输入图像描述](../Images/6f5fd5125d9976d8d93158094805804e.png)](https://i.stack.imgur.com/LNUZu.png)

您现在需要做的就是单击右侧突出显示的名称，这将带您进入带有以下链接的页面：

[![在此处输入图像描述](../Images/cbb19e45ed721c5a9794fd3dedbd1823.png)](https://i.stack.imgur.com/WvDkq.png)

单击绿色“代码”按钮的右侧，可以看到一个漂亮的个性化 git 链接，可用于克隆或对现有拉取请求添加更多更改。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2013-02-19T00:36:15.273

该拉取请求显示来自该人的分支的提交，因此您可以看到他正在从`feature/mongoose-support`分支推送他的更改。

您可以克隆他的存储库并签出该分支

# bitbucket - 如何在 bitbucket wiki 上自动发布 sphinx 生成的文档？

> ID：14947790
> 
> 赞同：19
> 
> 时间：2013-02-19T00:27:46.423
> 
> 标签：bitbucket, python-sphinx

我有一个带有 sphinx 生成文档的 python 包（使用 automodules 功能），它可以制作成一组静态 html 页面，位于项目的 git 存储库中的 _build 目录中。我想在 bitbucket 上以漂亮且*私密的方式查看此文档。*似乎作为 git repo 的 wiki 本身可能可以用于此目的。

是否有一个简单的序列步骤可以将我的 html 文档制作/转换为标记并将其推送到 bitbucket wiki 存储库？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-29T08:24:09.840

Unfortunately this is not really possible...

You can push your _build dir to the wiki repo and create links in the wiki (Home.rst) to your html files like so:

```
`Sphinx docs <_build/html/index.html>`_ 
```

And it will display them but inclusion of _static css/js files won't work, so your docs will look ugly :(

You could also [publish your docs as a website on BitBucket](https://confluence.atlassian.com/display/BITBUCKET/Publishing+a+Website+on+Bitbucket) but there's no privacy, your docs will be public even if your repo is private, so this is not very useful, then you can just go with [read the docs](https://readthedocs.org/)...

Read the docs actually [supports privacy](http://docs.readthedocs.org/en/latest/privacy.html) so you could add your docs in a private mode and add a [Webhook](http://docs.readthedocs.org/en/latest/webhooks.html#bitbucket) in BitBucket. This unfortunately only works with public repos so not a great solution either...

P.S. There's a reusable app that allows you to privately serve your sphinx docs from django (protected): [django-docs](http://django-docs.readthedocs.org/en/latest/) ;) And you can build those from your bitbucket *.rst files...

# c++ - 将字符与西班牙语字符进行比较

> ID：14947791
> 
> 赞同：0
> 
> 时间：2013-02-19T00:27:46.363
> 
> 标签：c++, char, compare, character

我有一个包含任何字符的输入，我需要一个数组来分隔输入中的单词。该数组需要只有字母（是西班牙语，所以它包括重音字母）。我的代码做到了，它只是无法将特殊的西班牙语字符识别为“¡”、“¿”等。

我该如何解决这个问题？...这是我的代码。

```
string x[100];
int n = 0;
while (entrada){
    entrada>>x[n];
    n++;
}
n--;
for(int j = 0;j<n;j++){
    cout<<x[j]<<"/";
}
string y[100];
for(int i = 0;i<n;i++)
    for(int j = 0; j<x[i].length();j++){
        if(!ispunct(x[i][j]))
            y[i]+=x[i][j];
    } 
```

使用这段代码，我得到了这个输入和输出：

```
input
=======
Hola,
Cómo estás?
Espero que muy bien. ¡!!!
El otro día que fui al cine me acordé de la
película que vimos el año pasado.

output
========
Hola/Cómo/estás/Espero/que/muy/bien/¡/El/otro/día/que/fui/al/cine/me/acordé/de/la/película/que/vimos/el/año/pasado/ 
```

输出只是打印的由“/”分隔的数组

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:45:28.080

尝试设置语言环境，如下所示：

```
 #include <clocale>
  ...
    std::setlocale(LC_ALL, "es_ES"); 
```

它应该可以`ispunct()`识别西班牙标点符号。

# sql - where子句sql server中的用例

> ID：14947796
> 
> 赞同：7
> 
> 时间：2013-02-19T00:28:25.203
> 
> 标签：sql, sql-server, case

我想做的是让查询考虑或不考虑日期时间值，所以我不必在存储过程中这样做

```
if @considerDate =1
    begin
        select * from table 
        where dateCol = @date
    end
else
    begin 
        select * from table
    end 
```

我想做一些像

```
select * from table
where   dateCol = ( case 
                    when  @date is not null
                    then @date
            ) 
```

在单个查询中

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-19T00:30:01.817

你只需要添加`END`关键字

```
SELECT * 
FROM    tableName
WHERE   dateCol =   CASE WHEN @considerDate =1
                         THEN @date 
                         ELSE dateCol 
                    END 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-19T00:29:49.590

如果我理解正确，这应该有效：

```
SELECT * 
FROM Table
WHERE dateCol = 
   CASE WHEN @date is not null then @date ELSE dateCol END 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-16T22:28:12.803

```
if @considerDate =0
    begin
        -- set the variable to null so the select will return all rows from table
        set @date = null
    end

SELECT *
FROM table
WHERE dateCol = IsNull(@date, dateCol) 
```

如果您不想在查询中包含日期参数，请将值设置为 null，然后在查询中您可以使用 null 检查来决定是否应用过滤器。

# opengl - 2d 游戏中的自定义 zbuffer / 从片段着色器 (glsl) 中的帧缓冲区读取像素

> ID：14947800
> 
> 赞同：-1
> 
> 时间：2013-02-19T00:28:43.177
> 
> 标签：opengl, glsl, depth-buffer, 2d-games

我正在用 OpenGL 编写一个 2D（实际上是 2.5D）等距游戏。为了避免对在某些情况下可能非常复杂的图块进行排序，我正在尝试模拟某种深度缓冲区。对于每个图块，我有两张图像，一张带有颜色信息，一张带有深度信息。

图片1：http : [//dl.dropbox.com/u/91457585/depth_buffer_test.png](http://dl.dropbox.com/u/91457585/depth_buffer_test.png)

作为第一种方法，我创建了这些图片。这个想法是将它们相互叠加并使用着色器进行深度测试。在这种情况下，我知道这没有多大意义，但这只是查看它在技术上是否可行的第一种方法。

所以现在我的问题！

下面你会看到着色器的代码。应该将帧缓冲区的深度信息与对象的深度信息进行比较。但是它似乎不起作用，现在我在某处读到这不可能像我那样。

清单：

```
#version 130
uniform sampler2D colorMap;
uniform sampler2D zMap;  
uniform float level;

out vec4 gs_FragColor[ 2 ];

void main(void) { 
    float z = texture2D( zMap, gl_TexCoord[0].st ).r; 
    if ( z > gs_FragColor[ 1 ].r ){
      gs_FragColor[ 1 ] = vec4( z, 0, 0, 1 );
      gs_FragColor[ 0 ] = texture2D( colorMap, gl_TexCoord[0].st ).rgba;
    }
} 
```

那么有没有更好的方法来模拟深度缓冲区呢？也许通过写入真正的深度缓冲区？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T10:36:33.537

有（复杂且可能非常慢）模拟深度缓冲区的方法，但我不明白为什么你需要这样的东西。我建议使用常规的 OpenGL 深度测试：对于图块的每个片段，您在纹理中查找相应的深度值并将其写入`gl_FragDepth`. 如果您在主机代码 ( `glEnable( GL_DEPTH_TEST)`) 中启用了深度测试，OpenGL 将为您完成所有工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-27T06:30:34.953

1.  您可以模拟 Z 缓冲区，但它会太慢，因为您需要退回到它，这将导致多次通过（1\. 通过每个重叠的瓦片块），更好更快的解决方案是直接在没有 OpenGL 的情况下进行到 Canvas 并将 Screen 和 Z 缓冲区存储为 DIB 位图或 1D/2D 数组。但是如果你有很多瓷砖要绘制到大分辨率，它也会很慢（但仍然比 OpenGL 的实现要快）。

2.  您将瓦片深度图用作深度纹理并在深度测试开启的情况下正常渲染 - 这是解决您问题的最快最简单和最好的解决方案。（纹理中的 z 值被添加到每个片段的实际 z 坐标值中，因此您只能通过实际顶点坐标指定图块层）

强烈推荐第二选择...

# ruby - 让 Mongoid 忘记观察者

> ID：14947802
> 
> 赞同：0
> 
> 时间：2013-02-19T00:28:50.373
> 
> 标签：ruby, rspec, mongoid, observers

我正在分别为我的 Mongoid 文档和观察者编写测试。当我在我的 spec 目录上运行 rspec 时，我的测试失败了，因为观察者仍然附加到我的文档类。

我的观察者的 Mongoid 配置代码：

```
describe 'UserObserver' do
before :all do
    Mongoid.load! "#{File.dirname(__FILE__)}/../../mongoid.yml", :test

    Mongoid.observers = UserObserver
    Mongoid.instantiate_observers
end
...
end 
```

还有我的文档的 Mongoid 配置代码：

```
describe User do
before :all do
    Mongoid.load! "#{File.dirname(__FILE__)}/../../mongoid.yml", :test
end
...
end 
```

我尝试添加`Mongoid.observers.clear`到一个`after:all`块，但没有奏效。我也尝试过`Mongoid::config.reset`，但没有奏效。

那么，是否可以在实例化后从 Mongoid 中删除观察者？

# java - Java中较大的光标

> ID：14947807
> 
> 赞同：3
> 
> 时间：2013-02-19T00:29:20.953
> 
> 标签：java, swing, cursor, awt

是否有可能（通过方法`createCustomCursor()`）创建比 Windows 中预定义的 32x32（例如 64x64 甚至更多）更大的光标？

```
Toolkit toolkit = Toolkit.getDefaultToolkit();
final Image cursor = toolkit.getImage(getClass().getClassLoader().getResource("images/cursor.png"));
toolkit.getBestCursorSize(64, 64);
Cursor mycursor=toolkit.createCustomCursor(cursor, new Point(0,0), "cursor");
setCursor(mycursor); 
```

我尝试了以下方法：

```
 Cursor emptyCursor = Toolkit.getDefaultToolkit().createCustomCursor(new BufferedImage(16, 16, BufferedImage.TYPE_INT_ARGB), new Point(0, 0), "empty"); 
        setCursor(emptyCursor);

        this.addMouseMotionListener(new MouseMotionListener(){
            public void mouseDragged(MouseEvent e) {
            }

            public void mouseMoved(MouseEvent e) {
                xCursor = e.getX();
                yCursor = e.getY();
                repaint();
                //e.consume();
            }
        });

 public void paint( Graphics g ) {
           g.drawImage(cursor, xCursor, yCursor, null);
       } 
```

但它不起作用，整个 GUI 消失了，光标在每个点都被绘制，所以我必须以某种方式删除它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:31:55.637

有没有一种方法可以使光标小于预定义的 32x32？如果是这样，只需将光标制作得如此之小以至于真的无法注意到，或者制作一个透明光标......然后，只需将图像移动到光标当前位置的坐标（在此处插入所需的时间间隔）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T00:32:43.113

Windows 似乎只允许大小为 32x32 像素的光标，所以如果你想要另一个大小，你必须解决它。

为了制作更大的光标，我相信这会起作用：

*   创建一个完全透明的自定义光标。

*   使用 a`mouseMotionListener`获取光标的位置。

*   在真实（透明）光标的位置绘制光标图像。

# android - Android：链接两个活动并相应地更改清单

> ID：14947814
> 
> 赞同：0
> 
> 时间：2013-02-19T00:30:15.280
> 
> 标签：android

我正在尝试学习 android/java 编程的基础知识。我根据教程创建了一个基本的 RSS android 应用程序。我添加了另一个活动来创建一个新的开始屏幕，我试图链接到教程中的主要 RSS 活动，但是当我运行应用程序时，当我点击新开始屏幕上的按钮时它总是崩溃。我在这里做明显错误的事情吗？

这是我创建的新开始屏幕的 XML “firstscreen”

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center_horizontal"
    android:onClick="gotorssfunction"
    android:text="@string/rssfeed" />

</LinearLayout> 
```

这是我创建的新活动作为新的开始屏幕

```
package com.testproject.newsapp2;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;

public class MainScreen extends Activity{

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.firstscreen);
}

public void gotorssfuction(View v){

    Intent i = new Intent(this, NewsApp2Activity.class);
    startActivity(i);

     }   

} 
```

这是教程中的主要 RSS 活动（以前是开始屏幕）

```
package com.testproject.newsapp2;

import java.util.List;

import com.testproject.newsapp2.data.RssItem;
import com.testproject.newsapp2.listeners.ListListener;
import com.testproject.newsapp2.util.RssReader;

import android.app.Activity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.widget.ArrayAdapter;
import android.widget.ListView;

/**
* Main application activity.
*
* Update: Downloading RSS data in an async task
*/
public class NewsApp2Activity extends Activity {

// A reference to the local object
private NewsApp2Activity local;

/**
 * This method creates main application view
 */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    // Set view
    setContentView(R.layout.main);

    // Set reference to this activity
    local = this;

    GetRSSDataTask task = new GetRSSDataTask();

    // Start download RSS task
    task.execute("http://rss.nytimes.com/services/xml/rss/nyt/Arts.xml");

    // Debug the thread name
    Log.d("ITCRssReader", Thread.currentThread().getName());
}

private class GetRSSDataTask extends AsyncTask<String, Void, List<RssItem> > {
    @Override
    protected List<RssItem> doInBackground(String... urls) {

        // Debug the task thread name
        Log.d("ITCRssReader", Thread.currentThread().getName());

        try {
            // Create RSS reader
            RssReader rssReader = new RssReader(urls[0]);

            // Parse RSS, get items
            return rssReader.getItems();

        } catch (Exception e) {
            Log.e("ITCRssReader", e.getMessage());
        }

        return null;
    }

    @Override
    protected void onPostExecute(List<RssItem> result) {

        // Get a ListView from main view
        ListView itcItems = (ListView) findViewById(R.id.listMainView);

        // Create a list adapter
        ArrayAdapter<RssItem> adapter = new ArrayAdapter<RssItem>  (local,android.R.layout.simple_list_item_1, result);
        // Set list adapter for the ListView
        itcItems.setAdapter(adapter);

        // Set list view item click listener
        itcItems.setOnItemClickListener(new ListListener(result, local));
    }
}  
} 
```

这是清单

```
<uses-sdk
    android:minSdkVersion="7"
    android:targetSdkVersion="17" />
<uses-permission android:name="android.permission.INTERNET"/>

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="com.testproject.newsapp2.MainScreen"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
           <activity
        android:name=".NewsApp2Activity"
        android:label="@string/app_name" >
   </activity>
</application>

</manifest> 
```

这是日志猫

```
02-18 16:37:09.638: E/Trace(8930): error opening trace file: No such file or directory (2)
02-18 16:37:09.638: D/ActivityThread(8930): setTargetHeapUtilization:0.25
02-18 16:37:09.638: D/ActivityThread(8930): setTargetHeapIdealFree:8388608
02-18 16:37:09.638: D/ActivityThread(8930): setTargetHeapConcurrentStart:2097152
02-18 16:37:09.778: D/libEGL(8930): loaded /system/lib/egl/libEGL_adreno200.so
02-18 16:37:09.778: D/libEGL(8930): loaded /system/lib/egl/libGLESv1_CM_adreno200.so
02-18 16:37:09.788: D/libEGL(8930): loaded /system/lib/egl/libGLESv2_adreno200.so
02-18 16:37:09.818: I/Adreno200-EGLSUB(8930): <ConfigWindowMatch:2087>: Format RGBA_8888.
02-18 16:37:09.828: E/(8930): <s3dReadConfigFile:75>: Can't open file for reading
02-18 16:37:09.838: E/(8930): <s3dReadConfigFile:75>: Can't open file for reading
02-18 16:37:09.838: D/OpenGLRenderer(8930): Enabling debug mode 0
02-18 16:37:16.916: D/AndroidRuntime(8930): Shutting down VM
02-18 16:37:16.916: W/dalvikvm(8930): threadid=1: thread exiting with uncaught exception    (group=0x41c2a438)
02-18 16:37:16.926: E/AndroidRuntime(8930): FATAL EXCEPTION: main
02-18 16:37:16.926: E/AndroidRuntime(8930): java.lang.IllegalStateException: Could not find a method gotorssfunction(View) in the activity class com.testproject.newsapp2.MainScreen for onClick handler on view class android.widget.Button with id 'button1'
02-18 16:37:16.926: E/AndroidRuntime(8930):     at android.view.View$1.onClick(View.java:3661)
2-18 16:37:16.926: E/AndroidRuntime(8930):  at android.view.View.performClick(View.java:4198)
02-18 16:37:16.926: E/AndroidRuntime(8930):     at android.view.View$PerformClick.run(View.java:17158)
02-18 16:37:16.926: E/AndroidRuntime(8930):     at  android.os.Handler.handleCallback(Handler.java:615)
02-18 16:37:16.926: E/AndroidRuntime(8930):     at android.os.Handler.dispatchMessage(Handler.java:92)
02-18 16:37:16.926: E/AndroidRuntime(8930):     at android.os.Looper.loop(Looper.java:137)
02-18 16:37:16.926: E/AndroidRuntime(8930):     at android.app.ActivityThread.main(ActivityThread.java:4918)
02-18 16:37:16.926: E/AndroidRuntime(8930):     at java.lang.reflect.Method.invokeNative(Native Method)
02-18 16:37:16.926: E/AndroidRuntime(8930):     at java.lang.reflect.Method.invoke(Method.java:511)
02-18 16:37:16.926: E/AndroidRuntime(8930):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1004)
02-18 16:37:16.926: E/AndroidRuntime(8930):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:771)
02-18 16:37:16.926: E/AndroidRuntime(8930):     at dalvik.system.NativeStart.main(Native Method)
2-18 16:37:16.926: E/AndroidRuntime(8930): Caused by: java.lang.NoSuchMethodException: gotorssfunction [class android.view.View]
02-18 16:37:16.926: E/AndroidRuntime(8930):     at java.lang.Class.getConstructorOrMethod(Class.java:460)
02-18 16:37:16.926: E/AndroidRuntime(8930):     at java.lang.Class.getMethod(Class.java:915)
 02-18 16:37:16.926: E/AndroidRuntime(8930):    at android.view.View$1.onClick(View.java:3654)
2-18 16:37:16.926: E/AndroidRuntime(8930):  ... 11 more
02-18 16:37:25.517: I/Process(8930): Sending signal. PID: 8930 SIG: 9 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:45:57.060

错字。方法签名应该`public void gotorssfunction(View v)`代替`public void gotorssfuction(View v)`.

# sql - 在 Active Record 中选择所有具有 Inner Join 的列

> ID：14947820
> 
> 赞同：1
> 
> 时间：2013-02-19T00:30:46.377
> 
> 标签：sql, ruby-on-rails, ruby-on-rails-3, join, rails-activerecord

在 Ruby on Rails 指南中，我看到了使用联接的示例。例如

```
Category.joins(:posts) 
```

导致查询

```
SELECT categories.* FROM categories
  INNER JOIN posts ON posts.category_id = categories.id 
```

这一切都很好，但是如何使用 Active Record 返回类别和帖子列？还是我完全错过了 SQL 的一些东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T00:33:45.703

您需要致电`#includes`：

```
Category.includes(:posts) 
```

# c - 如何使用 strdup？

> ID：14947821
> 
> 赞同：12
> 
> 时间：2013-02-19T00:30:48.950
> 
> 标签：c, malloc, strdup

我正在调用`strdup`并且必须在调用之前为变量分配空间`strdup`。

```
char *variable;
variable = (char*) malloc(sizeof(char*));
variable = strdup(word); 
```

我这样做对吗？或者这里有什么问题？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-19T00:35:16.550

如果您使用的是 POSIX 标准[`strdup()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/strdup.html)，它会计算所需的空间并分配它并将源字符串复制到新分配的空间中。你不需要`malloc()`自己做；事实上，如果你这样做，它会立即泄漏，因为你用指向已分配空间的指针覆盖了指向你分配的空间的唯一指针`strdup()`。

因此：

```
char *variable = strdup(word);
if (variable == 0) …process out of memory error; do not continue…
…use variable…
free(variable); 
```

如果您确实需要进行内存分配，那么您需要在其中分配`strlen(word)+1`字节，`variable`然后您可以复制`word`到新分配的空间中。

```
char *variable = malloc(strlen(word)+1);
if (variable == 0) …process out of memory error; do not continue…
strcpy(variable, word);
…use variable…
free(variable); 
```

或者计算一次长度并使用`memmove()`或者也许`memcpy()`：

```
size_t len = strlen(word) + 1;
char *variable = malloc(len);
if (variable == 0) …process out of memory error; do not continue…
memmove(variable, word, len);
…use variable…
free(variable); 
```

不要忘记确保您知道`free()`每个`malloc()`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-19T00:44:25.497

你不需要分配空间来使用 strdup，strdup 会为你做这件事。但是，您应该在使用后释放它。

```
#include <string.h>
#include <stdio.h>
#include <stdlib.h>
#include <assert.h>

int main (){

    const char* s1= "Hello World";
    char* new = strdup (s1);
    assert (new != NULL);

    fprintf( stdout , "%s\n", new);

    free (new);
    return 0;
} 
```

**编辑**：使用 C++ 时要小心，因为变量名 new 在 C 中很好，而在 C++ 中则不行，因为它是运算符 new 的保留名称。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-19T01:18:35.100

你似乎很困惑。忘记你对指针的了解。让我们使用整数。

```
int x;
x = rand();    // Let us consider this the "old value" of x
x = getchar(); // Let us consider this the "new value" of x 
```

有什么方法可以让我们找回旧值，或者它是否从我们的视图中“泄露”了？作为一个假设，假设您希望让操作系统知道您已完成该随机数，以便操作系统执行一些清理任务。

生成新值是否需要旧值？怎么可能，什么时候`getchar`看不到x？

现在让我们考虑您的代码：

```
char *variable;
variable = (char*) malloc(sizeof(char*)); // Let us consider this the "old value" of variable
variable = strdup(word);                  // Let us consider this the "new value" of variable 
```

有什么方法可以让我们找回旧值，或者它是否从我们的视图中“泄露”了？您应该`malloc`通过调用`free(variable);`.

生成新值是否需要旧值？怎么可能，什么时候`strdup`看不到变量？

仅供参考，这是一个如何实现 strdup 的示例：

```
char *strdup(const char *original) {
    char *duplicate = malloc(strlen(original) + 1);
    if (duplicate == NULL) { return NULL; }

    strcpy(duplicate, original);
    return duplicate;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-19T00:38:22.403

就目前而言，您总是会泄漏 4 到 8 个字节（取决于您的架构）。无论`strdup`哪个[会自行分配所需的动态内存，](https://stackoverflow.com/a/14947862/430766)您都在重新分配唯一的变量来保存指向新分配的内存区域的指针。

简单地说

```
char* const variable = strdup(word); 
```

# jquery - 使用 jquery click 函数获取图片链接的 url

> ID：14947822
> 
> 赞同：1
> 
> 时间：2013-02-19T00:30:51.807
> 
> 标签：jquery, url, click, href

我正在尝试使用 jquery 和 click() 在单击后获取图像链接的 url。html 看起来像这样。

```
<div class="lp-element lp-pom-image" id="lp-pom-image-167" >
<a href="http://url.com/page" target=""><img src="/image.jpg" alt=""></a>
</div> 
```

到目前为止，我使用的 javascript 看起来像这样，但它没有获取点击的图像链接的 url。url 需要传递到变量所在的`this`位置。

```
jQuery(function() {
jQuery("#lp-pom-image-167").click(function() {
trackOutboundLink(this, 'AddToCart', 'Bottom CTA');
return false;
});
}); 
```

如何使用适当的基本 URI 提取 href url？IE。“ [http://url.com/page](http://url.com/page) ”？

编辑：澄清了我要提取的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:46:00.373

我建议（尽管未经测试）：

```
$('.lp-pom-image').click(function(e){
    e.preventDefault(); // stops the default action,
                        // without preventing propagation/bubbling
    trackOutboundLink($(this).find('img').prop('src'), 'AddToCart', 'Bottom CTA');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:45:41.950

```
jQuery(".lp-pom-image").click(function() {
  console.log($("img", this).attr("src"));
  return false;
}); 
```

[请参阅http://jsbin.com/ebicax/4/](http://jsbin.com/ebicax/4/)上的工作演示

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T00:48:35.333

`this`如果您想获取`a`url ，请使用下面的代码：

```
$(this).find("a").attr('href') 
```

或者如果你想获取`img`src，请使用此代码：

```
$(this).find("a img").attr('src') 
```

# ruby-on-rails - Ruby on Rails 的 API 回调

> ID：14947824
> 
> 赞同：0
> 
> 时间：2013-02-19T00:30:53.663
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, callback, get

几周以来，我一直在使用 Echosign API，除了回调的最后一点，我已经完全弄清楚了我一直想做的所有事情。我以前从未使用过回调，也没有遇到过关于 HTTP GET 请求/回调等的 ruby​​/ruby on rails 的好教程。我尝试在我的 rails 应用程序的视图文件夹中使用可公开访问的文本文件但是没运气。如果有人能指出我正确的方向，甚至翻译此描述中的含义，我将不胜感激。谢谢！

```
xml.callbackInfo do
  xml.signedDocumentUrl 'http://myserver.com/partners/web.txt'
end 
```

EchoSign 将使用最终签名的 PDF 执行 HTTP PUT 操作的可公开访问的 URL。使用标准嵌入式语法支持 HTTP 身份验证 - 即[http://username:password@your.server.com/path/to/file](http://username:password@your.server.com/path/to/file)。每次有新的协议事件时，EchoSign 还可以使用 HTTP GET ping 您的系统。如果您希望使用此选项，请联系 support@echosign.com。

[回显回调信息](https://secure.echosign.com/public/docs/EchoSignDocumentService15#CallbackInfo)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T01:02:37.160

因此，根据我从该描述中了解到的情况，您可以处理这种情况，在您现有的一个控制器中创建一个操作来处​​理 PUT 请求。在该操作中，您可以拦截他们将发送给您的 PDF 并相应地进行处理。

在你的 routes.rb 上

`put "my_controller_name/my_action"`

确保特定操作不使用身份验证，并将其提供给回调 URL。例如：

xml.callbackInfo 做 xml.signedDocumentUrl ' [http://myserver.com/my_controller/my_action](http://myserver.com/my_controller/my_action) ' 结束

希望这可以帮助。

问候，

# caching - 如何禁用/关闭/刷新couchdb缓存

> ID：14947825
> 
> 赞同：2
> 
> 时间：2013-02-19T00:30:54.317
> 
> 标签：caching, couchdb

我有一个对文档进行一些基本身份验证的列表。我遇到的问题是列表正在缓存，因此除非我更新修订 ID，否则用户将看不到他们有权访问。如何显示非缓存列表？

```
if (req.userCtx.name === doc.permissions.owner) {
    return 'you have permission';   
}
else {
    return 'you do not';
} 
```

我如何想象它是通过在标题中传递 no-cache 或更新 ETAG 或类似的东西来完成的，但似乎没有任何效果。这是我每次在头部发送一个新日期以使其不缓存的尝试，但这不起作用。

```
var date = new Date().getTime() + 'x';
start({code: 200, headers: {'Content-Type': 'text/html', 'date': date}}); 
```

任何想法都非常感谢！

顺便说一句，我正在寻找一个纯粹的沙发解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-12T22:55:30.910

幸运的是，CouchDB 源代码可用！我能够在以下位置找到此算法`couch_mrview_show.erl`：

```
show_etag(#httpd{user_ctx=UserCtx}=Req, Doc, DDoc, More) ->
    Accept = couch_httpd:header_value(Req, "Accept"),
    DocPart = case Doc of
        nil -> nil;
        Doc -> couch_httpd:doc_etag(Doc)
    end,
    couch_httpd:make_etag({couch_httpd:doc_etag(DDoc), DocPart, Accept,
        {UserCtx#user_ctx.name, UserCtx#user_ctx.roles}, More}). 
```

在这里，我们可以看到节目被缓存，除非以下事情之一发生变化：

*   设计文档，包含显示功能
*   用于渲染节目的文档
*   “接受”HTTP 请求标头
*   用户名（这意味着节目至少为每个用户呈现一次）
*   用户上下文中的用户角色集

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T03:29:32.950

所以经过更多的挖掘，我发现了这个：

[http://wiki.apache.org/couchdb/Formatting_with_Show_and_List#ETags](http://wiki.apache.org/couchdb/Formatting_with_Show_and_List#ETags)

**切割到重要部分：**

*   ETag 由 List 和 Shows 处理
*   最高版本 1.2 您的用户必须具有角色，然后他们将获得不同的 ETag。
*   1.3 将为每个用户名引入新的 ETag。

希望这可以帮助某人。

# 32-bit - 一台机器有一个 32 位地址和一个 8KB 机器

> ID：14947828
> 
> 赞同：2
> 
> 时间：2013-02-19T00:31:14.450
> 
> 标签：32-bit, memory-address, virtual-memory, page-tables

> 一台机器有一个 32 位的地址空间和一个 8KB 的页面大小。页表完全在硬件中，每个条目有一个 32 位字。当一个进程被调度时，它的页表会以一个字/100 ns 的速率从内存中复制到硬件中。如果每个进程运行 100 毫秒（包括加载页表的时间），那么用于加载页表的 CPU 时间是多少？

是的; 这是一个家庭作业问题。我调查了一下，到目前为止我发现

页表大小（字节）=条目数*条目大小。因此 x= 32*8192(位) = 262144

我知道这是错误的答案，它是 52；4288ms 我将在后一个方程中使用

加载页表的时间/总时间 = CPU 使用率

在这里发布了一个我不太明白的解决方案。

[http://www.cs.inf.ethz.ch/ssw/exercises/solution_04.pdf](http://www.cs.inf.ethz.ch/ssw/exercises/solution_04.pdf)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T00:41:15.010

这里棘手的部分是计算页表的大小。一旦你有了它，将它乘以加载每个表条目所需的时间。表条目有多大无关紧要 - 只是加载它需要多长时间。

所以考虑一个 32 位地址空间。其中有多少个 8K 块？那是您引用的文档中减去位的部分。描述 8K 需要 13 位。请注意 2 ^ 13 = 8K（通过注意 1024 需要 10 位来快速计算它。它有点助记符且易于记忆。8 需要 3 位和 10 + 3 = 13。或者使用计算器查看 2 的幂等于多少8K。）

整个地址空间的 32 位减去 13 得到 19，因此有 2 ^ 19 页。

现在只需将 2 ^ 19 乘以 100 ns 和宾果游戏。你拥有了它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-02-17T18:14:36.153

“32 位地址空间和 8 KB 页面”意味着有 13 位（8 KB）用于页面偏移，其余 19 位用于索引页表条目。

[参考图像](https://i.stack.imgur.com/o239V.png)

如果上面的图像不起作用，那么你可以在这里看到：

[https://www.slideshare.net/kumar_vic/computer-memory-management/14?src=clipshare](https://www.slideshare.net/kumar_vic/computer-memory-management/14?src=clipshare)

```
<----------------------32 bits(word)---------------------->
<-----19 bits(index)----- ><-----13 bits(page offset)-----> 
```

因此，页表中有 2^19 个条目。

每个条目需要 100 ns 才能从磁盘复制到内存。

复制一张页表的总时间需要 2^19 * 100 ns = 52.42 ms。

一个进程花费的总时间为 100 毫秒，因此用于加载页表的 CPU 时间的比例为 (52.42)/(100) = 52.42 %

# c# - 使用 iTextSharp 阅读 PDF 文件附件注释

> ID：14947829
> 
> 赞同：3
> 
> 时间：2013-02-19T00:31:23.957
> 
> 标签：c#, pdf, annotations, itextsharp, attachment

我有以下问题。我有一个 PDF，其中附有一个 XML 文件作为注释。不是作为嵌入文件，而是作为注释。现在我尝试使用以下链接中的代码阅读它：

[iTextSharp - 如何打开/读取/提取文件附件？](https://stackoverflow.com/questions/3007780/itextsharp-how-to-open-read-extract-a-file-attachment)

它适用于嵌入式文件，但不适用于作为注释的文件附件。

我谷歌从 PDF 中提取注释并找到以下链接： [Reading PDF Annotations with iText](https://stackoverflow.com/questions/5474210/reading-pdf-annotations-with-itext)

所以注释类型是“文件附件注释”

有人可以展示一个工作示例吗？

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-19T06:57:56.897

~~在有关 iText 和 iTextSharp 的问题中，人们应该首先查看[itextpdf.com 上的关键字列表](http://itextpdf.com/themes/keywords.php)。在这里您可以找到[文件附件，从](http://itextpdf.com/themes/keyword.php?id=490)[iText in Action — 第 2 版中](http://itextpdf.com/book/)提取引用两个 Java 示例的附件：~~

旧的关键字列表已不复存在；itextpdf.com 网站现在提供了其他搜索示例的方法，但我不会描述它们，以免网站再次更改并且我再次出现死链接...

基于[iText in Action - Second Edition](https://itextpdf.com/de/resources/books/itext-action-second-edition/itext-action-second-edition)的相关 iText 示例有：

*   part4.chapter16.KubrickDvds

*   [Java、iText 5.x](https://git.itextsupport.com/projects/I5JS/repos/book/browse/src/part4/chapter16/KubrickDvds.java)
*   [Java、iText 7.x](https://git.itextsupport.com/projects/I7JS/repos/book/browse/src/main/java/com/itextpdf/samples/book/part4/chapter16/Listing_16_05_KubrickDvds.java)
*   [.Net，iText 5.x](https://git.itextsupport.com/projects/I5NS/repos/book/browse/iTextExamplesWeb/iTextExamplesWeb/iTextInAction2Ed/Chapter16/KubrickDvds.cs)

*   part4.chapter16.Kubrick纪录片

*   [Java、iText 5.x](https://git.itextsupport.com/projects/I5JS/repos/book/browse/src/part4/chapter16/KubrickDocumentary.java)
*   [Java、iText 7.x](https://git.itextsupport.com/projects/I7JS/repos/book/browse/src/main/java/com/itextpdf/samples/book/part4/chapter16/Listing_16_06_KubrickDocumentary.java)
*   [.Net，iText 5.x](https://git.itextsupport.com/projects/I5NS/repos/book/browse/iTextExamplesWeb/iTextExamplesWeb/iTextInAction2Ed/Chapter16/KubrickDocumentary.cs)

这是[来自 iText5的示例](https://kb.itextpdf.com/home/it5kb/examples/itext-in-action-chapter-16-pdf-streams)

（我还没有找到 .Net 和 iText 7 的示例端口，但基于其他来源，这个端口应该不会太难......）

KubrickDvds 包含以下方法`extractAttachments`/`ExtractAttachments`来提取文件附件注释：

Java，iText 5.x：

```
/**
 * Extracts attachments from an existing PDF.
 * @param src   the path to the existing PDF
 */
public void extractAttachments(String src) throws IOException {
    PdfReader reader = new PdfReader(src);
    PdfArray array;
    PdfDictionary annot;
    PdfDictionary fs;
    PdfDictionary refs;
    for (int i = 1; i <= reader.getNumberOfPages(); i++) {
        array = reader.getPageN(i).getAsArray(PdfName.ANNOTS);
        if (array == null) continue;
        for (int j = 0; j < array.size(); j++) {
            annot = array.getAsDict(j);
            if (PdfName.FILEATTACHMENT.equals(annot.getAsName(PdfName.SUBTYPE))) {
                fs = annot.getAsDict(PdfName.FS);
                refs = fs.getAsDict(PdfName.EF);
                for (PdfName name : refs.getKeys()) {
                    FileOutputStream fos
                        = new FileOutputStream(String.format(PATH, fs.getAsString(name).toString()));
                    fos.write(PdfReader.getStreamBytes((PRStream)refs.getAsStream(name)));
                    fos.flush();
                    fos.close();
                }
            }
        }
    }
    reader.close();
} 
```

Java，iText 7.x：

```
public void extractAttachments(String src) throws IOException {
    PdfDocument pdfDoc = new PdfDocument(new PdfReader(src));
    PdfReader reader = new PdfReader(src);
    PdfArray array;
    PdfDictionary annot;
    PdfDictionary fs;
    PdfDictionary refs;
    for (int i = 1; i <= pdfDoc.getNumberOfPages(); i++) {
        array = pdfDoc.getPage(i).getPdfObject().getAsArray(PdfName.Annots);
        if (array == null) continue;
        for (int j = 0; j < array.size(); j++) {
            annot = array.getAsDictionary(j);
            if (PdfName.FileAttachment.equals(annot.getAsName(PdfName.Subtype))) {
                fs = annot.getAsDictionary(PdfName.FS);
                refs = fs.getAsDictionary(PdfName.EF);
                for (PdfName name : refs.keySet()) {
                    FileOutputStream fos
                            = new FileOutputStream(String.format(PATH, fs.getAsString(name).toString()));
                    fos.write(refs.getAsStream(name).getBytes());
                    fos.flush();
                    fos.close();
                }
            }
        }
    }
    reader.close();
} 
```

C#，iText 5.x：

```
/**
 * Extracts attachments from an existing PDF.
 * @param src the path to the existing PDF
 * @param zip the ZipFile object to add the extracted images
 */
public void ExtractAttachments(byte[] src, ZipFile zip) {
  PdfReader reader = new PdfReader(src);
  for (int i = 1; i <= reader.NumberOfPages; i++) {
    PdfArray array = reader.GetPageN(i).GetAsArray(PdfName.ANNOTS);
    if (array == null) continue;
    for (int j = 0; j < array.Size; j++) {
      PdfDictionary annot = array.GetAsDict(j);
      if (PdfName.FILEATTACHMENT.Equals(
          annot.GetAsName(PdfName.SUBTYPE)))
      {
        PdfDictionary fs = annot.GetAsDict(PdfName.FS);
        PdfDictionary refs = fs.GetAsDict(PdfName.EF);
        foreach (PdfName name in refs.Keys) {
          zip.AddEntry(
            fs.GetAsString(name).ToString(), 
            PdfReader.GetStreamBytes((PRStream)refs.GetAsStream(name))
          );
        }
      }
    }
  }
} 
```

KubrickDocumentary 包含以下方法`extractDocLevelAttachments`/`ExtractDocLevelAttachments`来提取文档级附件：

Java，iText 5.x：

```
/**
 * Extracts document level attachments
 * @param filename     a file from which document level attachments will be extracted
 * @throws IOException
 */
public void extractDocLevelAttachments(String filename) throws IOException {
    PdfReader reader = new PdfReader(filename);
    PdfDictionary root = reader.getCatalog();
    PdfDictionary documentnames = root.getAsDict(PdfName.NAMES);
    PdfDictionary embeddedfiles = documentnames.getAsDict(PdfName.EMBEDDEDFILES);
    PdfArray filespecs = embeddedfiles.getAsArray(PdfName.NAMES);
    PdfDictionary filespec;
    PdfDictionary refs;
    FileOutputStream fos;
    PRStream stream;
    for (int i = 0; i < filespecs.size(); ) {
      filespecs.getAsString(i++);
      filespec = filespecs.getAsDict(i++);
      refs = filespec.getAsDict(PdfName.EF);
      for (PdfName key : refs.getKeys()) {
        fos = new FileOutputStream(String.format(PATH, filespec.getAsString(key).toString()));
        stream = (PRStream) PdfReader.getPdfObject(refs.getAsIndirectObject(key));
        fos.write(PdfReader.getStreamBytes(stream));
        fos.flush();
        fos.close();
      }
    }
    reader.close();
} 
```

Java、iText 7.x

```
public void extractDocLevelAttachments(String src) throws IOException {
    PdfDocument pdfDoc = new PdfDocument(new PdfReader(src));
    PdfDictionary root = pdfDoc.getCatalog().getPdfObject();
    PdfDictionary documentnames = root.getAsDictionary(PdfName.Names);
    PdfDictionary embeddedfiles = documentnames.getAsDictionary(PdfName.EmbeddedFiles);
    PdfArray filespecs = embeddedfiles.getAsArray(PdfName.Names);
    PdfDictionary filespec;
    PdfDictionary refs;
    FileOutputStream fos;
    PdfStream stream;
    for (int i = 0; i < filespecs.size(); ) {
        filespecs.getAsString(i++);
        filespec = filespecs.getAsDictionary(i++);
        refs = filespec.getAsDictionary(PdfName.EF);
        for (PdfName key : refs.keySet()) {
            fos = new FileOutputStream(String.format(PATH, filespec.getAsString(key).toString()));
            stream = refs.getAsStream(key);
            fos.write(stream.getBytes());
            fos.flush();
            fos.close();
        }
    }
    pdfDoc.close();
} 
```

C#，iText 5.x：

```
/**
 * Extracts document level attachments
 * @param PDF from which document level attachments will be extracted
 * @param zip the ZipFile object to add the extracted images
 */
public void ExtractDocLevelAttachments(byte[] pdf, ZipFile zip) {
  PdfReader reader = new PdfReader(pdf);
  PdfDictionary root = reader.Catalog;
  PdfDictionary documentnames = root.GetAsDict(PdfName.NAMES);
  PdfDictionary embeddedfiles = 
      documentnames.GetAsDict(PdfName.EMBEDDEDFILES);
  PdfArray filespecs = embeddedfiles.GetAsArray(PdfName.NAMES);
  for (int i = 0; i < filespecs.Size; ) {
    filespecs.GetAsString(i++);
    PdfDictionary filespec = filespecs.GetAsDict(i++);
    PdfDictionary refs = filespec.GetAsDict(PdfName.EF);
    foreach (PdfName key in refs.Keys) {
      PRStream stream = (PRStream) PdfReader.GetPdfObject(
        refs.GetAsIndirectObject(key)
      );
      zip.AddEntry(
        filespec.GetAsString(key).ToString(), 
        PdfReader.GetStreamBytes(stream)
      );
    }
  }
} 
```

（出于某种原因，c# 示例将提取的文件放在一些 ZIP 文件中，而 Java 版本将它们放入文件系统中......哦，好吧......）

# ormlite - MySQL/MariaDB 中的 ORMLite 日期，精度为毫秒

> ID：14947832
> 
> 赞同：1
> 
> 时间：2013-02-19T00:32:16.817
> 
> 标签：ormlite, mariadb

ORMLite 问题。我有一组 POJO，Android 应用程序和 Java Web 服务都使用这些 POJO 来保存数据（分别保存到 SQLite 和 MariaDB）。我相信从 5.3 开始，MariaDB 支持带有长度的时间戳/日期时间，这将字段的精度扩展到微秒（MySQL 本身在新的 dev 5.6 版本中支持这一点）。

但是，即使我从命令行手动修改字段以将列设置为 DATETIME(6)，我也无法让 ORMLite 以毫秒精度保存我的日期字段。我知道我可以在 POJO 中使用 DATE_LONG 或 DATE_STRING 的数据类型，但我想在 MariaDB 中使用实际的 DATETIME 类型。

有什么办法可以以毫秒精度做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T04:44:30.217

看看问题下的评论以了解这里发生了什么......基本上你需要一个新的 DatabaseType （如果使用 MariaDB，那么显然只是子类化 MySQL 一个）：

```
public class MariaDBType extends MysqlDatabaseType {

    private final static String DATABASE_URL_PORTION = "mysql";
    private final static String DRIVER_CLASS_NAME = "org.mariadb.jdbc.Driver";
    private final static String DATABASE_NAME = "MariaDB";

    @Override
    public boolean isDatabaseUrlThisType(String url, String dbTypePart) {
        return DATABASE_URL_PORTION.equals(dbTypePart);
    }

    @Override
    protected String getDriverClassName() {
        return DRIVER_CLASS_NAME;
    }

    @Override
    public String getDatabaseName() {
        return DATABASE_NAME;
    }

    @Override
    protected void appendDateType(StringBuilder sb, FieldType fieldType, int fieldWidth) {
        /**
         * TIMESTAMP in MySQL does some funky stuff with the last-modification time. Values are 'not null' by default
         * with an automatic default of CURRENT_TIMESTAMP. Strange design decision.
         */
        if (isDatetimeFieldWidthSupported()) {
            sb.append("DATETIME(").append(fieldWidth).append(")");
        } else {
            sb.append("DATETIME");
        }
    }

    public boolean isDatetimeFieldWidthSupported() {
        return true;
    }
} 
```

现在我可以像正常一样使用日期数据类型并获得毫秒或微秒精度......在我的例子中，我使用 Gray 现有的注释参数作为宽度（适用于这种情况，我只需要毫秒精度，而不是微秒）。

```
@DatabaseField(columnName = Constants.TIMESTAMP, dataType = DataType.DATE, width = 3)
private Date timestamp; 
```

最后，如果您正在尝试解决这个特定问题，请不要忘记小数秒标志：

```
private static JdbcPooledConnectionSource cSource = new JdbcPooledConnectionSource();
    cSource.setDatabaseType(new MariaDBType());
    cSource.setUrl("jdbc:mysql://localhost:3306/database?useFractionalSeconds=true");
    cSource.setUsername("username");
    cSource.setPassword("password"); 
```

# ruby-on-rails - 删除 staging.rb 和 production.rb 之间的重复

> ID：14947833
> 
> 赞同：14
> 
> 时间：2013-02-19T00:32:20.590
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我的 Rails 应用程序（在 Heroku 上运行）有一个登台和生产环境。目前，staging.rb 和 production.rb 中有很多东西我必须在每个文件中单独定义，例如：

```
 # Code is not reloaded between requests
  config.cache_classes = true

  # Full error reports are disabled and caching is turned on
  config.consider_all_requests_local       = false
  config.action_controller.perform_caching = true

  # Disable Rails's static asset server (Apache or nginx will already do this)
  config.serve_static_assets = false

  # Compress JavaScripts and CSS
  config.assets.compress = true

  # Don't fallback to assets pipeline if a precompiled asset is missed
  config.assets.compile = false

  # Generate digests for assets URLs
  config.assets.digest = true 
```

这不是`DRY`。有没有一种优雅的方法可以有效地将 production.rb 中的设置导入到 staging.rb 中，然后只覆盖我希望为暂存环境更改的设置？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-19T01:39:16.557

我过去所做的是有一个包含共享设置的文件，然后在生产和登台环境文件中需要它。这很有效，因为它允许您在一个地方定义通用设置，然后在各个文件中定义唯一设置：

**配置/环境/shared_production.rb**

```
MyApp::Application.configure do
  # Code is not reloaded between requests
  config.cache_classes = true

  # Full error reports are disabled and caching is turned on
  config.consider_all_requests_local       = false
  config.action_controller.perform_caching = true
end 
```

**配置/环境/production.rb**

```
require Rails.root.join('config/environments/shared_production')

MyApp::Application.configure do
  # Raise exception on mass assignment protection for Active Record models
  config.active_record.mass_assignment_sanitizer = :logger

  # Url to be used in mailer links
  config.action_mailer.default_url_options = { :host => "production.com" }
end 
```

**配置/环境/staging.rb**

```
require Rails.root.join('config/environments/shared_production')

MyApp::Application.configure do
  # Raise exception on mass assignment protection for Active Record models
  config.active_record.mass_assignment_sanitizer = :strict

  # Url to be used in mailer links
  config.action_mailer.default_url_options = { :host => "mysite-dev.com" }
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T01:27:41.783

我认为这就是它变得多么好。这些是配置设置，旨在单独设置。您实际上可以定义一个函数来传递配置。在该功能上，您可以设置默认值，但我不想这样做。在项目的生命周期中，您只使用少于 5 个（或 10 个）环境，因此您最多需要 10 个这些文件，您不会一直在编辑这些文件。

# git - Git创建一个分支而不从默认合并

> ID：14947834
> 
> 赞同：0
> 
> 时间：2013-02-19T00:32:23.753
> 
> 标签：git

首先，我对 Git 很陌生。

我的仓库中有一个默认分支`master`，我创建了一个名为的新分支`bugs`并向其中添加了一个`known_bugs.txt`文件。问题在于，Git 不仅会添加`known_bugs.txt`到`bugs`分支，而且还会显示`master`分支内部的所有其他文件`bugs`。有没有办法在创建新分支时不将默认分支中的文件合并到新分支中？

先谢谢了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T01:06:12.147

我也是 git 新手。我用谷歌搜索了一段时间，找到了三种可能的解决方案。希望能有所帮助。不过，您可能不应该以这种方式使用分支。

首先，您可以创建一个新分支`bugs`并签出该分支，然后从该`master`分支中​​删除所有文件，然后创建您自己的文件`knownbugs.txt`并进行提交。

```
git branch bugs
git checkout bugs
rm *
echo XXXX > knownbugs.txt
git commit -a -m "New branch with file knownbugs.txt" 
```

其次，您可以创建一个空的初始提交并从中派生您的分支。

```
git commit --allow-empty 
```

会做的工作。

更多细节：[在 git 中的空项目上创建分支](https://stackoverflow.com/questions/5678699/creating-branches-on-an-empty-project-in-git)

第三，您可以在 git 中手动管理 refs 和 index：

```
git symbolic-ref HEAD refs/heads/bugs
rm .git/index
echo XXX > knownbugs.txt; git add knownbugs; git commit -m
git checkout -f master
git checkout bugs 
```

有关更多信息，请参阅[创建没有祖先的 git 分支](http://madduck.net/blog/2007.07.11:creating-a-git-branch-without-ancestry/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T17:16:45.940

发生的事情是当您在 git 中创建一个分支时，它是从您当前的上下文中创建的。如果您在创建分支时没有向 master 提交任何内容，那么您新创建的分支也将是空的。如果您在分支时有 2 个文件提交给 master，它将接受该提交（2 个文件）并将它们移动到您新创建的分支中。

所以，如果你想创建一个空分支，你有几个选择......

*   **简单**：在提交任何内容之前创建所有空分支。
*   **适度**：一旦您创建+签出您的分支删除（git rm）所有内容，然后添加您的文件。对新分支的第一次提交将删除并添加您的所有文件。
*   **专家**：使用孤儿标志创建一个没有父提交的分支，然后如前所述删除所有文件。

`git checkout --orphan NEWBRANCH`

（其中 NEWBRANCH 是您的分支名称）

`git rm -rf .`

（删除所有文件）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T00:35:11.647

您可以重新设置您的错误分支以从 master 开始。这样，它的文件就不会出现在另一个分支中。

# c - C中多线程程序中的错误

> ID：14947836
> 
> 赞同：0
> 
> 时间：2013-02-19T00:32:46.610
> 
> 标签：c, multithreading, matrix-multiplication

谁能建议我为什么会出现以下错误以及我的程序是否正确？我的程序出现以下错误。我没有得到任何结果输入文件是
2 3
1 2 3
3 4 5
3 4
3 5 6 7
1 3 4 8
2 3 5 6
我的程序是

```
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>
int m,p,q,n; Matrix A has dimensions m, n and B has dimensions p,q
int **a, ** b, **c;
void *mulrow(void* row);

void print(int** a,int _i, int _j) 
{
int i,j;
for (i = 0; i < _i; ++i) {
    for (j = 0; j < _j; ++j)
    printf("%d  ",a[i][j]);
    printf("\n");
    }
}

void writeMat(int** a,int _i, int _j, FILE* f)
{
    int i,j;
    for (i = 0; i < _i; ++i) {
        for (j = 0; j < _j; ++j)
            fprintf(f,"%d ",a[i][j]);
        fprintf(f,"\n");
    }
}

void matrix_multiply()
{
    // Every row of matrix is computed 
    int i,r;
    pthread_t** threads = (pthread_t**) malloc(sizeof(pthread_t*)*m);
    int* rows = (int*) malloc(sizeof(int)*m);

    for (i = 0; i < m; ++i) {
        threads[i] =(pthread_t*) malloc(sizeof(pthread_t));
        rows[i] = i;
        r = pthread_create(threads[i], NULL, mulrow, (void*) &rows[i]);
        if (r<0)
            printf("failed to create thread at mul2 at i =  %d\n",i);
    }

    for (i = 0; i < m; ++i)
        pthread_join(*threads[i],NULL);
    free(threads);
    free(rows);
}

void *mulrow(void* row)
{
    int j, i = *((int*)row) ,k;

    for (j = 0 ; j < n ; j ++)
        for (k = 0 ; k < p ; k++)
            c[i][j] += a[i][k] * b[k][j];
    pthread_exit(NULL);
}

int **read_matrix(FILE *f,int m, int n)
{
    int i,j;
    int **a = (int**) malloc(sizeof(int *)*m);
    for (i = 0; i < m; ++i) {
        a[i] = (int *) malloc(sizeof(int)*n);
        for (j = 0; j < n; ++j) {
        fscanf(f,"%d",&a[i][j]);
    }
    return a;
}

int main(void)  
{
    int i,j;
    FILE* in  = fopen("input.txt","r");
    fscanf(in,"%d %d",&m,&p);
    a = read_matrix(in,m,p);
    fscanf(in,"%d %d",&q,&n);
    b = read_matrix(in,q,n);
    if (p!=q){
        printf("incompatible matrices --not supported\n");
        return 0;
    }
    c = (int**) malloc(sizeof(int *)*m);
    for (i = 0; i < m; ++i){
        c[i] = (int *) malloc(sizeof(int)*n);
        for (j = 0; j < n; ++j)
            c[i][j] = 0;
    }
    printf("Result of multiplication \n");
    matrix_multiply();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T23:01:28.223

线

```
int j, i = *((int*)row) ,k; 
```

正在给你带来问题。C 不允许多个初始化程序，并且不能在同一语句中的 decalrartions 之间进行赋值。在 = 的右侧，您使用的是逗号运算符，它执行左边的语句，然后执行并返回右边的结果。所以你将 j 和 i 都设置为 k （不管是什么）

我想你想要的是：

```
void *mulrow(void* row)
{
    int i = *((int*)row);
    int j;
    int k;

    for (j = 0 ; j < n ; j ++)
        for (k = 0 ; k < p ; k++)
            c[i][j] += a[i][k] * b[k][j];
    pthread_exit(NULL);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:37:52.667

在您的程序中，您需要注释掉一个语句。

```
int m,p,q,n; //Matrix A has dimensions m, n and B has dimensions p,q 
```

最后一行缺少一个右大括号，即之后`return 0;`

通过此更改并与 pthread 库链接应该可以编译您的程序。

```
gcc -o test_exe file.c -lpthread 
```

我已经成功编译了你的代码。

# asp.net - 启用迁移到另一个上下文？

> ID：14947839
> 
> 赞同：4
> 
> 时间：2013-02-19T00:33:03.963
> 
> 标签：asp.net, .net, entity-framework, entity-framework-5, nuget

我在一个应用程序中有两个 DBContext 类。`MyMvcContext`和自动生成的`UserContext`.

我一直在开发一个使用`MyMvcContext`一段时间的网络应用程序。现在我需要修改`UserProfile`在 context 中的类`UsersContex`。我尝试将类更改迁移到数据库并运行以下命令。但是，我在运行时收到错误消息`Enable-Migrations -ContextTypeName MyMvc.Models.UsersContext`？

```
PM> Enable-Migrations 
More than one context type was found in the assembly 'MyMvc'.
To enable migrations for MyMvc.Models.UsersContext, use Enable-Migrations -ContextTypeName MyMvc.Models.UsersContext.
To enable migrations for MyMvc.Models.MyMvcContext, use Enable-Migrations -ContextTypeName MyMvc.Models.MyMvcContext.
PM> Enable-Migrations -ContextTypeName MyMvc.Models.UsersContext
Migrations have already been enabled in project 'MyMvc'. To overwrite the existing migrations configuration, use the -Force parameter. 
```

**更新：**`UsersContext`我应该`MyMvcContext`在我的项目文件中 找到并替换所有内容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-20T13:22:41.340

一旦为项目启用了迁移。你不使用`Update-Database`- 请参阅[实体框架迁移](http://msdn.microsoft.com/en-us/data/jj554735.aspx)

这就是您收到错误消息的原因，迁移已启用...一旦启用，您就可以使用上述命令更新数据库。

# python - 尝试使用 tkinter 运行线程（tkinter 在主线程上）执行任务，但它停止了主线程

> ID：14947846
> 
> 赞同：0
> 
> 时间：2013-02-19T00:33:21.857
> 
> 标签：python, multithreading, python-3.x, tkinter

我是 Python 新手，目前正在开发一个供个人使用的小型应用程序。我正在为我的 gui 使用 tkinter。

我想要做的是创建一个带有标签的顶级弹出窗口，它根据登录尝试的方式更改文本。因此，当运行 tk 的主线程显示带有动态文本的弹出窗口时，我想启动一个线程以尝试最多登录 5 次，并通过设置名为“logindata”的全局变量向主线程报告。

AuctioneerGUI 中的 _login() 方法和 LoginThread 类实际上是唯一重要的事情，您可以忽略其余的事情，但它们可能认为相关。

_login() 方法在登录按钮被按下时被调用。所有这一切都是尝试登录并设置登录数据。与此同时，主线程正在循环，直到它注意到 LoginThread 已经设置了变量，并且当它收集了所有三个变量时，它将进入其余的逻辑（尚未完全实现，但与问题无关）

现在发生的情况是主线程在 LoginThread 启动后停止，只有在它完成后才会继续。即使 LoginThread 应该在单独的线程中运行，因此不会停止主线程。因此，只有在 LoginThread 执行的任务完成后才会显示弹出窗口。我希望弹出窗口只出现并显示为用户提供更新的标签。我该怎么做呢？

我确定问题是线程停止了主线程，因为我使用打印确定了这一点。

我还有一个小问题。popup.destroy() 似乎没有做任何事情。TopLevel 只是停留在那里。

对不起文字墙，并提前感谢您帮助我。我已经花了比我应该尝试几种不同的东西更多的时间，但我没有设法让它发挥作用。

让我知道是否有不清楚的地方，并且不介意有时效率低下或愚蠢的逻辑，我首先想让它至少能正常工作，然后再让它变得漂亮。

-大安

```
global logindata
logindata = {"counter": -1, "status": -1, "success": -1}

class AuctioneerGUI:
    def __init__(self):
        root = Tk()
        root.title("Path of Exile Auctioneer")
        self._setupGUI(root)
        self._loggingin = False

        root.protocol("WM_DELETE_WINDOW", lambda: root.quit())
        root.mainloop()           

    def _setupGUI(self, root):            
        frame = Frame(root)

        email = StringVar()
        pass_ = StringVar()
        thread = StringVar()

        email.set("email")
        pass_.set("password")
        thread.set("76300")

        email_label = Label(frame, text="email")
        self._email_box = Entry(frame, takefocus=True, width=50, textvariable=email)
        self._email_box.focus_set()
        pass_label = Label(frame, text="password")
        self._pass_box = Entry(frame, takefocus=True, show="*", width=50, textvariable=pass_)
        thread_label = Label(frame, text="thread id")
        self._thread_box = Entry(frame, takefocus=True, width=10, textvariable=thread)
        self._login_button = Button(frame, text="login", command=lambda: self._login(root), takefocus=True)

        frame.pack()
        email_label.pack()
        self._email_box.pack()
        pass_label.pack()
        self._pass_box.pack()
        thread_label.pack()
        self._thread_box.pack()
        self._login_button.pack()

    def _login(self, root):
        self._login_button.configure(command=None)
        email = self._email_box.get()
        pass_ = self._pass_box.get()
        thread = self._thread_box.get()
        # Check email validity
        # no whitespaces, 1 @ sign 1 . after the @ sign
        try:
            thread = int(thread)
        except ValueError:
            return -1
            #invalid thread

        if not re.match(r"[^@]+@[^@]+\.[^@]+", email) or not email.find(" ") == -1:
            return -1
            #invalid mail

        self._sm = SessionManager(email, pass_, thread)    

        self._message = StringVar()
        self._message.set("Attempt 1/5.")

        popup = Toplevel(root)
        popup.title("Logging in...")
        message_label = Label(popup, text = self._message.get(), textvariable = self._message)
        message_label.pack()

        _thread = LoginThread(self._sm)        
        _thread.start()

        loop = True                

        while loop:
            counter = -1
            success = -1
            status = -1
            while counter == -1:
                counter = logindata["counter"]
                print(counter)
            while success == -1:
                success = logindata["success"]
            print(success)
            while status == -1:
                status = logindata["status"]
            print(status)
            if success:
                self._message.set("Attempt {}/5\. Success.".format(counter))
            elif status == 200:
                self._message.set("Attempt {}/5\. Failed: wrong password.".format(counter))
            else:
                self._message.set("Attempt {}/5\. Failed: connection error. {}".format(counter, status))
            updatebar = not success
            logindata["counter"] = -1
            logindata["status"] = -1
            logindata["success"] = -1
            if counter == 5:
                break

        popup.destroy()
        self._login_button["command"] = lambda: self._login(root)
        self._setup_main_layout(root)

    def _setup_main_layout(self, root):
        pass

class LoginThread(threading.Thread):

    def __init__(self, sessionmanager):
        threading.Thread.__init__(self)
        self._sm = sessionmanager

    def run(self):
        success = False
        counter = 1
        while not success:
            if counter > 5:
                break

            data = self._sm.login()
            status = data[1]
            success = data[0]
            logindata["counter"] = counter
            logindata["success"] = success
            logindata["status"] = status
            counter += 1
            print("done") 
```

更新：

经过一些研究，我将通过创建一个继承自标签的 ThreadSafeLabel 来解决该问题，该标签通过管道传输到 Widget 并通过队列进行通信，如下例所示：

[http://effbot.org/zone/tkinter-threads.htm](http://effbot.org/zone/tkinter-threads.htm)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T00:41:09.903

启动 a 的正确方法`threading.Thread`是调用`start`方法，而不是`run`方法。它是`start`产生一个新线程的方法。没有它，你实际上是`LoginThread.run`在主线程中运行。

所以改为尝试：

```
 _thread = LoginThread(self._sm)        
    _thread.start() 
```

* * *

从[文档](http://docs.python.org/2/library/threading.html#thread-objects)：

> 创建线程对象后，必须通过调用线程的 start() 方法来启动其活动。这会在单独的控制线程中调用 run() 方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T00:45:06.030

Zeroth，正如 unutbu 指出的那样，你只是`run`在主线程中运行另一个线程的函数，所以在它完成之前什么都不会发生。

* * *

一旦你解决了这个问题，你就永远不会想要在等待变量更改时让线程旋转，就像你在这里所做的那样：

```
while counter == -1:
    counter = logindata["counter"]
    print(counter) 
```

主线程除了在此处旋转之外，不可能做任何其他事情，直到后台线程设置`logindata["counter"]`为其他内容。如果你强制主线程等到另一个线程完成，你还不如在主线程中运行其他代码。您的代码与单线程执行操作具有相同的效果，除了它*还会*无缘无故地一遍又一遍地检查值会消耗尽可能多的 CPU。

如果您需要等到某事完成，您需要使用某种跨线程信号，例如 a`threading.Condition`或 a `queue.Queue`。

* * *

但是，这仍然不能解决您的问题，因为在登录完成之前，主线程*仍将*卡在函数内部。`_login`这意味着它不能做其他事情，比如重绘屏幕、处理鼠标点击等。

因此，即使您解决了前两个问题并让事情正常运行，这仍然与不产生线程并仅在主线程中进行登录完全相同。

您需要的是一个`_login`在启动后台线程后立即返回的函数，然后使用其他一些机制从后台线程触发 tkinter 循环上的事件。

# android - 端点用户认证

> ID：14947854
> 
> 赞同：3
> 
> 时间：2013-02-19T00:34:31.890
> 
> 标签：android, authentication, google-cloud-endpoints

我正在尝试在我的一个端点中访问用户，但无法从 Android 中获得魔法。该文档似乎处于某种损坏的状态，看看它是如何从受信任的测试程序过渡的，而且我看到的信息相互矛盾，所以我希望这里有人可以帮助我。

我在 API 控制台中为 Android 创建了我的客户端 ID。我将其指定为端点中的客户端 ID 和受众，如下所示：

```
@Api(
name = "tictactoe",
clientIds = {"myAndroidClientId.apps.googleusercontent.com"},
audiences = {"myAndroidClientId.apps.googleusercontent.com"}
) 
```

在我的 Android 活动中，我正在创建我的凭据：

```
credential =  GoogleAccountCredential.usingAudience(this, "server:client_id:myAndroidClientId.apps.googleusercontent.com");
credential.setSelectedAccountName(myAccountName); 
```

并在 AsyncTask 中进行网络调用之前使用它来构建我的服务：

```
Builder builder = new MyService.Builder(transport, jsonFactory, credential);
MyService service = builder.build();
thing = service.things().get().execute(); 
```

然后引发此异常：

```
com.google.api.client.googleapis.extensions.android.gms.auth.GoogleAuthIOException
Caused by: 
com.google.android.gms.auth.GoogleAuthException: Unknown
com.google.android.gms.auth.GoogleAuthUtil.getToken(Unknown Source)
com.google.android.gms.auth.GoogleAuthUtil.getToken(Unknown Source)
com.google.api.client.googleapis.extensions.android.gms.auth.GoogleAccountCredential.getToken(GoogleAccountCredential.java:192) 
com.google.api.client.googleapis.extensions.android.gms.auth.GoogleAccountCredential$RequestHandler.intercept(GoogleAccountCredential.java:217) 
```

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T01:04:38.077

弄清楚我哪里出错了：

您必须在 @API 和 Android 中将 WEB 客户端 ID 指定为受众。android 客户端 ID 仅在 @API clientIds 中使用。

# python - 如何禁用 Google App Engine python SDK 导入钩子？

> ID：14947860
> 
> 赞同：1
> 
> 时间：2013-02-19T00:35:14.380
> 
> 标签：python, google-app-engine

我正在玩 GAE python SDK 的本地部署。我尝试运行的代码包含许多不属于 GAE 导入白名单的外部库。我想禁用导入限制并让 GAE 应用程序导入任何本地安装的模块。

浏览完代码后，我发现他们使用自定义**导入钩子**来限制导入。但是，我无法弄清楚如何禁用覆盖的导入挂钩。

如果您知道如何实现这一点，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T04:48:51.630

最简单的方法是修改 google/appengine/tools/dev_appserver_import_hook.py 并将您想要的模块添加到白名单中。

这将允许您导入任何您想要的内容。

现在有充分的理由在开发服务器中限制导入。受限制的导入与生产环境中可用的内容相匹配。因此，如果您将库添加到白名单中，您的代码可能会在本地开发服务器上运行，但不会在生产环境中运行。

不，您不能在生产中导入受限模块。

# javascript - 如何在javascript中获取文本框值

> ID：14947864
> 
> 赞同：1
> 
> 时间：2013-02-19T00:35:25.293
> 
> 标签：javascript, asp.net

我在 aspx.cs 页面中有这个，并试图在我的 js 函数中获取文本框的值。这不起作用：

```
result += result.Replace(sOptionText.ToString(), "<input type='text' id=\"txtSS_" + Version + "\" size='10' value=\"" +"\" runat = \"server\" style=\"display:none;\"  />"); 
```

我的js函数在这里：

```
var sOptionList = "";

var $obj = $('#txtSS_' + VersionID);
if ($('#txtSS_' + VersionID).length > 0)
    sOptionList = $obj.val(); 
```

我得到一个空值。我究竟做错了什么？另外，想知道我在 .cs 页面中的文本框声明是否正确。当我触发它时，它仍然显示 value="" 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:39:12.260

这可能是因为未解析的客户端 ID。根据页面/控件的[ClientIDMode](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientidmode.aspx)，控件将以限定值作为前缀。所以实际的 ID 可能更像`"ctrl0_ctrl1_txtABC"`而不是`txtABC`.

```
// javascript
var tb = $('#<%= this.txtMyTextbox.ClientID %>');
alert(tb.length);
alert(tb.val()); 
```

但是，您还将`input`元素构建为字符串，而不是将其实例化为新控件。控制可能甚至没有被执行。

```
// c#
var tb = new TextBox();
tb.ID = "txtABC";

// Add the control to a container on the page. Any server control can be
// a container. This makes it part of the page lifecycle.
this.Controls.Add( tb ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T23:13:03.783

我没有在我的点击或我的 jsfunction 中做一个 document.ready。所以，这样做修复了它：

```
 $(document).ready(function () {
       var $Opt = $("#txtSS_" + VersionID).val(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T00:44:59.157

有几件事：

1.  $obj 是一个数组。所以你必须使用 $obj[] 访问数组中的一个元素，其中是一个数字
2.  一旦你有了元素，然后使用属性 .value

因此，对于第一个元素，您将拥有

```
 sOptionList = $obj[0].value; 
```

# java - 数组列表 不确定如何使用？

> ID：14947866
> 
> 赞同：0
> 
> 时间：2013-02-19T00:35:35.370
> 
> 标签：java, android, arraylist, parse-platform

我知道这是一个菜鸟问题，但我在其他任何地方都找不到任何答案。我是编程新手，所以请彻底解释。

我正在使用 parse.com。我正在尝试获取包含 3-20 个对象的查询。我需要显示对象。在尝试、调试和研究之后，我意识到它是以`ArrayList`. 我不知道如何将对象取出并正确显示它们。我在 parse.com 上的文档中找不到任何示例。这是我的代码，我注意到了什么是`ArrayList`但现在不知道该去哪里。

```
ParseQuery query = new ParseQuery("FightersDB");
query.findInBackground(new FindCallback() {

    @Override
    public void done(List<ParseObject> FightersDB/*This is my ArrayList*/, ParseException e) {
    if (e==null){
        Log.d("Info", "No Errors");

        //This is where I don't know what to do to retrieve my objects.
        //Inside each object, I have strings named "Name" "WeightClass" "Record" "Age"
        TextView tv; 
        tv = (TextView) findViewById(R.id.tv);
        tv.setText(name + " " + fightersWeight + " " + record + " " + age);

    }else {
        Log.d("Info", "Not Retrieved successfully");
    }
    }

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:53:14.583

首先创建您的 ArrayList ：

```
ArrayList<ParseObject> FightersDB = new ArrayList<ParseObject>(); 
```

然后使您的项目适应布局：

```
ArrayAdapter<ParseObject> adapter = new ArrayAdapter<ParseObject>(this,android.R.layout.simple_list_item_1, R.id.id1, FightersDB );
setListAdapter(adapter); 
```

[android http://developer.android.com/reference/android/R.layout.html](http://developer.android.com/reference/android/R.layout.html)有一些默认布局

您还需要通过添加 ListView View 来更改您的 xml 布局文件：

```
<ListView
android:id="@android:id/id1"
android:layout_width="fill_parent"
android:layout_height="fill_parent" /> 
```

# math - 如何求解单位向量

> ID：14947868
> 
> 赞同：-2
> 
> 时间：2013-02-19T00:35:52.097
> 
> 标签：math, vector, linear-algebra

```
uvec1 = (vec3 - vec1).normalize3() 
uvec2 = (vec3 - vec2).normalize3()

   Vec normalize3()
   {
      double length = sqrt(x^2 + y^2 + z^2);
      return new Vec(x/length, y/length, z/length);      
   } 
```

仅给定 uvec2、vec1 和 vec2，是否可以求解 uvec1？

样本数据：

```
vec1 = (3994349.6104437034, -2525024.5798455356, 4270768.558174166, 1.0)    
vec2 = (3994350.7884981344, -2525023.416923353, 4270767.502702763, 1.0)    
vec3 = (3994403.673228261, -2525050.920923162, 4270738.823082169, 1.0) 
uvec1 = (0.8058476404228322, -0.3926341461126214, -0.44322455677835176, 1.0)
uvec2 = (0.7994702158645208, -0.415784076265458, -0.43355619689910574, 1.0) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T04:13:12.520

在数学上，你有以下

```
u1 = (v3 - v1)/||v3 - v1||
u2 = (v3 - v2)/||v3 - v2|| 
```

您想在不知道的情况下求解给`u1`定`v1`的`v2`, 和。让我们把第一个方程写成`u2``v3`

```
u1 = ((v3 - v2) + (v2 - v1))/||v3-v1|| 
```

将底部方程代入：

```
u1 = (u2*||v3 - v2|| + (v2 - v1))/||v3 - v1|| 
```

最后一个等式似乎表明，即使 、 和 的值相同，具有不同`v3`也会定义不同。因此，仅凭您给出的值不能唯一确定。`u1``v1``v2``u2``u1`

# java - 意外的运行时错误：无法加载主类

> ID：14947870
> 
> 赞同：0
> 
> 时间：2013-02-19T00:36:09.547
> 
> 标签：java

我正在尝试一些代码以更好地理解访问修饰符。我只添加了一行代码后一切都运行良好

```
class SomeClass2 {

  protected static void method4() { }
  protected static int x=0;
}
class SomeClass3 extends SomeClass2{

    int c=SomeClass2.x;
    public void somemethod() //Everything was compiling fine until
    {                        //Until I added this method
    SomeClass2.method4();
    }
}
class DemoClass1{
      public static void main(String[] parameters) {
    SomeClass2 sc = new SomeClass2();
    SomeClass3 sc1 = new SomeClass3();

    sc.method4();
    System.out.println(sc1.c);
sc1.somemethod();

  }
} 
```

我收到一个错误：`Could not find or load main class DemoClass1` 所有类都属于相同的目录和相同的包。环境变量也都设置好了。在我添加`somemethod()`. 它编译得很好，但不运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T00:47:56.347

我看不出您提供的代码有任何明显错误。

你重命名文件了吗？

JVM 将在与文件名完全相同的类中查找 main 方法。在这种情况下，您的文件应命名为

```
DemoClass1.java 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:51:20.023

你的代码没有错。将每个类保存在其各自的文件（`DemoClass1.java`和`SomeClass2.java`）`SomeClass3.java`中。

一切编译和执行都很好，无论有没有`somemethod`.

# c++ - 如何检测未使用的临时对象，最好是在编译时

> ID：14947871
> 
> 赞同：1
> 
> 时间：2013-02-19T00:36:10.550
> 
> 标签：c++, multithreading, visual-studio

我很想知道 MSVC 编译器是否有任何选项可能会在首次编写时（一年多前）出现以下错误。在那段时间，该错误已被复制并粘贴到代码中的其他几个地方。按本应每隔几秒就导致崩溃的权利。幸运的是，它每隔几个小时就会崩溃一次，而且通常很少有证据可供调试。错误代码的本质是这样的：

```
int someDataSubjectToMultiThreadAccess;
CCriticalSection someSyncObject;
...
int SomeFunction( void )
{
  CSingleLock( someSyncObject, TRUE );
  return someDataSubjectToMultiThreadAccess;
} 
```

我不会强调错误——Visual Studio 编译器肯定不会！如果看不到错误，请创建一个测试文件，编译它，然后查看 .cod 文件以查看生成的汇编程序。使用我的优化设置，它调用`CSingleLock`构造函数来创建一个临时对象，然后立即调用相应的析构函数，它（通过优化？）是`CSingleLock::Unlock()`函数。最后，共享数据被访问而不被实际锁定。

因此，这是一个关于如何通过省略将在整个函数范围内持续存在的变量来创建完全无效的锁定机制的警示故事 - `CSingleLock vitalLockVariable( someLock, TRUE );`。令我惊讶的是有多少眼睛看到了这段代码，却没有注意到这个错误。

我将为你们中的一些人省去输入以下建议的工作：“改用 boost 同步原语”。是的-谢谢-有一天我可能会的。但这种失误可能同样适用于他们。

我真正想知道的是有哪些工具可以捕获这类事情，最好是在输入的那一刻，但通过代码审查或尝试分析令人费解的崩溃以外的任何方式。

# java - 如何使用 Netbeans Design IDE 功能

> ID：14947873
> 
> 赞同：-1
> 
> 时间：2013-02-19T00:36:33.400
> 
> 标签：java, swing, user-interface, netbeans, jframe

我开始在 Netbeans 下使用 JFrame“设计器”，但我不知道如何将实际功能添加到我创建的按钮中。我正在尝试制作一个单击按钮的程序，它会打开您刚刚选择的任何程序。（例如，您点击显示“Interent”的按钮并打开 chrome/firefox）我已经制作了 GUI，但我不知道如何向按钮添加代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:44:30.343

启用表单编辑器后，选择要将事件附加到的元素。在控件的“属性”表中，单击“事件”以查看直接可用的事件列表。

对于按钮之类的东西，您只需双击它们，Netbeans 就会自动`actionPerformed`为您生成代码。

这在所有情况下都没有帮助（例如文本字段，其中`Document`有它的所有者侦听器），在这些情况下，您将必须了解事件侦听器的工作原理。

![在此处输入图像描述](../Images/e6b889fb40d3a8058113c670f31fc74f.png)

# playframework - 为什么 RequireJS 从主模块名称中截断“.js”，之后找不到文件？

> ID：14947874
> 
> 赞同：2
> 
> 时间：2013-02-19T00:37:02.117
> 
> 标签：playframework, requirejs, playframework-2.1

我在使用 Play 时发生了这种情况！[框架，但我认为在使用RequireJS](http://requirejs.org/)时通常会发生这种情况。

在模板中，我使用了以下语句：

```
 <script>require = {
      // The path where your JavaScripts are located
      baseUrl: "assets/js/",
    ...
};</script>
@helper.requireJs(core = routes.Assets.at("js/require-jquery.js").url, module = routes.Assets.at("js/main.js").url) 
```

编译为：

```
<script> require = ... </script>
<script type="text/javascript" data-main="/assets/js/main.js" src="/assets/js/require-jquery.js"></script> 
```

当我在浏览器中点击重新加载时，我可以在控制台中看到以下错误：

```
GET http://localhost:9000/assets/js/main?bust=1361232944505 404 (Not Found) require-jquery.js:1843
Uncaught Error: Script error
http://requirejs.org/docs/errors.html#scripterror 
```

如您所见，请求的文件的扩展名`.js`被截断。为什么？如何避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:37:02.117

问题是 RequireJS config 包含该字段，并且在标签的属性中`baseUrl`重复了相同的路径。改变玩法！框架助手语句：`data-main``script`

```
@helper.requireJs(core = routes.Assets.at("js/require-jquery.js").url, module = "main") 
```

或在一般情况下：

```
<script type="text/javascript" data-main="main" src="/assets/js/require-jquery.js"></script> 
```

消除了问题。

为什么会发生这种情况并以模糊的方式表现出来是 RequireJS 开发人员的问题。无论如何玩！应更正[此处](http://www.playframework.com/documentation/2.1.0/RequireJS-support)或[此处](https://github.com/playframework/Play20/wiki/RequireJS-support)的文档中描述的框架示例，并且还应更新[RequireJS 页面上的常见错误部分。](http://requirejs.org/docs/errors.html)

# emacs - 为什么 emacs Tuareg 模式在 Ocaml 中为函数显示不同的颜色？

> ID：14947879
> 
> 赞同：3
> 
> 时间：2013-02-19T00:37:20.973
> 
> 标签：emacs, ocaml, tuareg

只是想知道为什么`Tuareg mode`功能显示不同的颜色？

例如，如下图所示，功能`create_percolation`和`index_of`显示`blue`颜色`is_open`为棕色。

**为什么？？**

![在此处输入图像描述](../Images/4c085daa3934eed9816c662661c47657.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-28T17:13:11.847

这只是图阿雷格的一个错误。如果 function 的第一个 arg 是一条记录，则 Tuareg 无法将其识别为函数定义。Tuareg 是用 emacs lisp 编写的，它本身对 OCaml 语法树一无所知，就像 OCaml 编译器一样。所以你不应该期望它有完美的东西。如果不喜欢，不如向 tuareg 模式开发网站提交 bug 报告？

# java - java链接激活事件行为区别

> ID：14947887
> 
> 赞同：1
> 
> 时间：2013-02-19T00:38:30.077
> 
> 标签：java, swing, event-handling, batik

各位晚上好;

我有 JSVGCanvas（来自蜡染框架的组件），我在画布上显示带有链接的 svg 文档。单击链接时，我想在我的挥杆上打开一个新窗口（jframe）。因此我使用的是 linkActivated 事件。但是，我的问题是

```
private JPanel contentPane;
File f;
JSVGCanvas svgCanvas;

/**
 * Launch the application.
 */
public static void main(String[] args) {
    EventQueue.invokeLater(new Runnable() {
        public void run() {
            try {
                trialgui frame = new trialgui();
                frame.setVisible(true);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    });
}

/**
 * Create the frame.
 */
public trialgui() {
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setBounds(100, 100, 452, 418);
    contentPane = new JPanel();
    contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
    contentPane.setLayout(new BorderLayout(0, 0));
    setContentPane(contentPane);
    f = new  File("./links.svg");

    svgCanvas = new JSVGCanvas();

    if(f.exists()==true){System.out.println("file is ok");}
    try {

        svgCanvas.setURI(f.toURL().toString());

    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    svgCanvas.setDocumentState(JSVGCanvas.ALWAYS_DYNAMIC);
    contentPane.add(svgCanvas, BorderLayout.CENTER);
    svgCanvas.setMySize(new Dimension(100,100));

    JButton btnNewButton = new JButton("New button");
    btnNewButton.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent arg0) {
            try {
                svgCanvas.setURI(f.toURL().toString());
            } catch (MalformedURLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        }
    });
    contentPane.add(btnNewButton, BorderLayout.NORTH);

    svgCanvas.addLinkActivationListener(new LinkActivationListener() {

        @Override
        public void linkActivated(LinkActivationEvent arg0) {
            System.out.println("here is working");

            try {

                JFrame gh = new JFrame();
                gh.setVisible(true);
                f = new  File("./links.svg");
                svgCanvas.setURI(f.toURL().toString());
            } catch (MalformedURLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } 
            System.out.println("here");
        }
    });
} 
```

当用户单击链接时，svgcanvas 会在同一画布中显示链接。所以为了防止这种情况，我设置了初始 svg svgCanvas.setURI(f.toURL().toString()); 当链接激活触发。但是，由于方法不起作用，引用的链接出现在同一画布中。如果我在单击按钮时将相同的方法放在按钮事件中，它会将初始 svg 带回我的 svgcanvas。

谁能告诉我为什么这个事件的行为与按钮事件不同，我该如何解决这个问题？

问候 ....

# php - 使用 PNG 掩码的 PHP 图像层

> ID：14947889
> 
> 赞同：1
> 
> 时间：2013-02-19T00:38:51.370
> 
> 标签：php, web, layer, mask

我们正在尝试实现一个 PHP 服务器脚本，该脚本将允许用户更改部分产品图像的颜色。例如，如果您有一把带红色织物座椅的木椅，并且只想更改织物颜色。

我们之前在 Flash 中实现了一个系统；产品图像是 JPG，颜色可编辑区域由存储为具有透明度的单独 PNG 的掩码定义。使用蒙版的 alpha 值制作原始图像的副本，并将其放置在原始图像上方的新图层上，实际上是将可编辑颜色的区域复制到新图层上。然后用户可以对这个新层进行颜色编辑。

由于我们已经有了 PNG 掩码，因此我们正尝试在 PHP 中完成相同的功能，以使其可供更多最终用户使用。我尝试从[PHP GD 修改脚本 Use one image to mask another image, including contrast](https://stackoverflow.com/questions/7203160/php-gd-use-one-image-to-mask-another-image-including-transparency)，并提出以下

```
<?php
// Load source and mask
$source = imagecreatefromjpeg( 'source' );
$mask = imagecreatefrompng( 'destination' );
// Apply mask to source
imagealphamask( $source, $mask );
// Output
header( "Content-type: image/png");
imagepng( $source );

function imagealphamask( &$picture, $mask ) {
    // Get sizes and set up new picture
    $xSize = imagesx( $picture );
    $ySize = imagesy( $picture );
    $newPicture = imagecreatetruecolor( $xSize, $ySize );
    imagesavealpha( $newPicture, true );
    imagefill( $newPicture, 0, 0, imagecolorallocatealpha( $newPicture, 0, 0, 0, 127 ) );

    // Resize mask if necessary
    //if( $xSize != imagesx( $mask ) || $ySize != imagesy( $mask ) ) {
       // $tempPic = imagecreatetruecolor( $xSize, $ySize );
       // imagecopyresampled( $tempPic, $mask, 0, 0, 0, 0, $xSize, $ySize, imagesx( $mask ), imagesy( $mask ) );
       // imagedestroy( $mask );
       // $mask = $tempPic;
    //}

    // Perform pixel-based alpha map application
    for( $x = 0; $x < $xSize; $x++ ) {
        for( $y = 0; $y < $ySize; $y++ ) {
            $alpha = imagecolorsforindex( $mask, imagecolorat( $mask, $x, $y ) );
            $alpha = $alpha['alpha'];
            $color = imagecolorsforindex( $picture, imagecolorat( $picture, $x, $y ) );
            //preserve alpha by comparing the two values
            //if ($color['alpha'] > $alpha)
               //$alpha = $color['alpha'];
            //kill data for fully transparent pixels
            if ($alpha == 127) {
                $color['red'] = 0;
                $color['blue'] = 0;
                $color['green'] = 0;
            }
        imagesetpixel( $newPicture, $x, $y, imagecolorallocatealpha( $newPicture, $color[ 'red' ], $color[ 'green' ], $color[ 'blue' ], $alpha ) );
        }
    }

    //TODO: colorize the new layer in some way here, e.g. imagefilter($newPicture, IMG_FILTER_COLORIZE, 150, 90, 0);

    //place the new layer above the original image
   imagecopymerge($picture,$newPicture,0,0,0,0,$xSize,$ySize,100);

}

?> 
```

我不知道任何 PHP，但上面的脚本似乎应该做我们想要的。相反，它会切掉正确的区域，但用黑色包围它。

我真的不知道问题是什么，除非它与源图像是 JPG 而不是 PNG 有关。我尝试转换为真彩色，但不影响输出。

另外......这段代码太慢了。生成图像需要五秒钟以上。我们应该采取完全不同的方法/使用不同的框架吗？我对 Web 开发一无所知，但我被分配了这项工作并且必须完成它。

# macos - 在applescript中将一个窗口放在前面

> ID：14947890
> 
> 赞同：8
> 
> 时间：2013-02-19T00:38:56.443
> 
> 标签：macos, applescript

这可能是一个完全新手的问题，但在这里。我正在制作一个纯 AppleScript 应用程序。它激活另一个应用程序，然后键入。问题是当它激活应用程序时，它不会将应用程序窗口带到前面。我试着告诉应用程序激活：

```
tell application "app_name.app"
activate
tell application "System Events" to keystroke "test"
end tell 
```

有什么帮助吗？谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-19T19:58:49.890

如果目标应用程序没有打开的窗口，您必须重新打开一个默认窗口：

```
tell application "Terminal"
    reopen
    activate
end tell 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-08-07T21:39:53.347

要在前台打开终端，您需要运行：

```
tell application "Terminal"
    do script "echo hi"
    activate
end tell 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T03:59:28.817

在终端中执行命令的正确方法是：

```
tell application "Terminal"
    do script "echo hi"
end tell 
```

# networking - 在网络上阻止 Youtube，但仍访问特定视频

> ID：14947897
> 
> 赞同：0
> 
> 时间：2013-02-19T00:39:28.677
> 
> 标签：networking, web-applications, filter, youtube, youtube-api

场景：企业想要屏蔽 youtube.com，但仍通过桌面应用程序或网站提供已批准的视频。有没有办法阻止人们访问 youtube.com，但仍通过桌面应用程序中的嵌入式播放器或无铬播放器提供视频流量？

也许是代理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:51:39.443

您可以使用 youtube-dl sh 脚本下载已批准的视频，并将其作为 mp4 或 flv 托管在您自己的页面上，并阻止对 youtube 本身的访问。 [http://rg3.github.com/youtube-dl/](http://rg3.github.com/youtube-dl/)

# regex - 正则表达式在某个字符R Perl之前抓取单词

> ID：14947898
> 
> 赞同：7
> 
> 时间：2013-02-19T00:39:42.370
> 
> 标签：regex, perl, r

我需要在 R 中的字符串中获取唯一字符（在我的情况下为：&）之前和之后的单词。

我需要从这样的东西中得到'word1'：“...something something word1 & word2 something...”

在 R 中使用 Perl 正则表达式后，我可以得到这个词：（`(?<=& )[^ ]*(?= )` 它似乎表现得像我想要的那样。我通过梳理我在这个网站上找到的答案得到它）

我现在需要获取`&`符号前面的单词。单词的长度发生变化，其他前面单词的数量以及空格也会发生变化。一个单词可以是字母和数字，只是两边有空格。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-19T00:46:08.813

如果你使用`(\S+)\s*&\s*(\S+)`，那么双方的单词`&`都会被捕获。这允许在＆符号周围使用可选的空格。

您需要将 R 字符串中的反斜杠加倍，并使用`regexec`and`regmatches`函数应用模式并提取匹配的子字符串。

```
string  <- "...something something word1 & word2 something..."
pattern <- "(\\S+)\\s*&\\s*(\\S+)"
match   <- regexec(pattern, string)
words   <- regmatches(string, match) 
```

现在`words`是一个包含三项向量的单元素列表：整个匹配字符串后跟第一个和第二个反向引用。`words[[1]][2]`也是如此。`word1`_ `words[[1]][3]`_`word2`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-19T00:48:47.677

```
(?<=&)(\w*)(?=&)" 
```

将匹配符号之间的任何单词字符`&`。使用正向后视和正向前瞻。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T00:41:50.190

```
\b(.*?)\b& 
```

该单词将在第 1 组中捕获。这是包含在由两个边界包围的任何字符串中的不情愿匹配；第二个边界之后是`&`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-19T02:19:48.827

可以使用[gsubfn 包](https://cran.r-project.org/package=gsubfn)`strapplyc`中的相对简单的正则表达式来完成。假设是你的字符串：`s`

```
library(gsubfn)
strapplyc(s, "(\\w+) & (\\w+)") 
```

# ruby - 如何编写能够匹配一两行文本的正则表达式

> ID：14947905
> 
> 赞同：2
> 
> 时间：2013-02-19T00:40:22.433
> 
> 标签：ruby, regex

我试图匹配一些可以是单行或两行的文本。我希望能够以有效的方式处理这两种情况。文本字符串将采用一致的格式并包含多个选项卡。我正在尝试用红宝石进行比赛。正文如下：

单线：

```
#3  Hello Stormy    Scratched - Reason Unavailable                           11:10 AM ET 
```

两行：

```
#3  Hello Stormy    Scratched - Reason Unavailable                            11:10 AM ET   
                    Scratch Reason - Reason Unavailable changed to Trainer     2:19 PM ET 
```

我不得不使用空格来格式化这里的字符串，但实际的文本使用制表符来分隔各个部分：数字和名称、划痕以及原因和时间。

样本输出：

一行：#3 Hello Stormy Scratched - Reason Unavailable 美国东部时间上午 11:10

两行 #3 Hello Stormy Scratched - Reason Unavailable 更改为 Trainer 下午 2:19

注意：理想情况下，两行输出将包括第一行的数字和名称。

我能够构建一个匹配各个部分的表达式，但是选项卡、第二行以及在两行输出中包含数字和马名的要求给我带来了麻烦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T05:23:56.023

你不需要花哨的正则表达式来做你想做的事，你只需要知道如何去做。

Ruby 的 Enumerable 有一个称为[`slice_before`](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-slice_before)正则表达式的方法，用于确定数组中的哪些元素被组合在一起。Array 继承自 Enumerable。例如：

```
text = '#3  Hello Stormy    Scratched   -   Reason Unavailable          11:10 AM ET
#3  Hello Stormy    Scratched   -   Reason Unavailable          11:10 AM ET
                        Scratch Reason  -   Reason Unavailable changed to Trainer   2:19 PM ET
'

data = text.split("\n").slice_before(/\A\S/).to_a

require 'pp'
pp data 
```

输出：

```
[["#3\tHello Stormy\tScratched\t-\tReason Unavailable\t\t\t11:10 AM ET"],
["#3\tHello Stormy\tScratched\t-\tReason Unavailable\t\t\t11:10 AM ET",
  "\t\t\tScratch\tReason\t-\tReason Unavailable changed to Trainer\t2:19 PM ET"]] 
```

换句话说，通过拆分文本创建的数组`"\n"`按不以空格开头的行分组，这就是模式`/\A\S/`。所有单行都在单独的子阵列中。作为前一行的延续的行与该行分组。

如果您正在从磁盘读取文件，则可以使用`IO.readlines`将文件作为数组读取，从而避免拆分文件的需要。

如果需要，您可以进一步处理该数组以重建行和续行，使用类似：

```
data = text.split("\n").slice_before(/\A\S/).map{ |i| i.join("\n") } 
```

变成`data`：

```
["#3\tHello Stormy\tScratched\t-\tReason Unavailable\t\t\t11:10 AM ET",
"#3\tHello Stormy\tScratched\t-\tReason Unavailable\t\t\t11:10 AM ET\n\t\t\tScratch\tReason\t-\tReason Unavailable changed to Trainer\t2:19 PM ET"] 
```

如果您需要将每一行拆分为其组件字段，请使用`split("\t")`. 如何在子阵列中执行此操作留给您作为练习，但我会涉及`map`.

* * *

编辑：

> ...我喜欢你的解决方案，但我得到了 slice_before 的未定义方法。

尝试这个：

```
require 'pp'
require 'rubygems'

class Array

  unless Array.respond_to?(:slice_before)
    def slice_before(pat)
      result = []
      temp_result = []
      self.each do |i|

        if (temp_result.empty?)
          temp_result << i
          next
        end

        if i[pat]
          result << temp_result
          temp_result = []
        end

        temp_result << i
      end
      result << temp_result

    end
  end

end 
```

这么称呼：

```
ary = [
  '#3  Hello Stormy    Scratched - Reason Unavailable                           11:10 AM ET',
  '#3  Hello Stormy    Scratched - Reason Unavailable                            11:10 AM ET',
  '                    Scratch Reason - Reason Unavailable changed to Trainer     2:19 PM ET',
]

pp ary.slice_before(/\A\S/) 
```

好像：

```
[
  ["#3  Hello Stormy    Scratched - Reason Unavailable                           11:10 AM ET"],
  ["#3  Hello Stormy    Scratched - Reason Unavailable                            11:10 AM ET",
   "                    Scratch Reason - Reason Unavailable changed to Trainer     2:19 PM ET"]
] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T02:05:45.640

如果您可以假设“#”字符不出现在字符串中的任何其他位置，它会变得相当简单。然后像这样的事情应该这样做：

```
 /^#[^#]*/m 
```

另一种更通用的方法是匹配以 # 开头的第一行，以及之后以空格或制表符开头的任何行：

```
 /^#.*?$(\n^[ \t].*?$)*/m 
```

如果该行并不总是以 # 开头，您可以将其替换为`[^ \t]`（不是空格或制表符）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T02:40:23.913

RE 的乐趣！这很老套，但里面有几种不同类型的匹配策略。

```
# Two-line example
s = <<-EOS
  #3\tHello Stormy\t\tScratched - Reason Unavailable\t\t\t11:10 AM ET\t
  \t\t\tScratch Reason - Reason Unavailable changed to Trainer\t2:19 PM ET
EOS
# allow leading/trailing whitespace, get the number, name, last reason and time
s =~ /\A\s*(#\d)\t+([^\t]+)(?:\t+.*)?(?:\t+(.*))\t+(\d+:\d+ (?:AM|PM) ET)\s*\Z/m
# ["#3", "Hello Stormy", "Scratch Reason - Reason Unavailable changed to Trainer", "2:19 PM ET"]
a = $1, $2, $3, $4 
```

注意：这假设您匹配的字符串中只有一条消息
注意：未针对单行案例进行测试:)

# python - Python：检查值属于哪个bin

> ID：14947909
> 
> 赞同：16
> 
> 时间：2013-02-19T00:41:09.370
> 
> 标签：python, range, binning

我有一个值列表和一个 bin 边缘列表。现在我需要检查它们所属的 bin 的所有值。有没有比遍历值然后遍历 bin 并检查值是否属于当前 bin 更 Pythonic 的方法，例如：

```
my_list = [3,2,56,4,32,4,7,88,4,3,4]
bins = [0,20,40,60,80,100]

for i in my_list:
    for j in range(len(bins)):
        if bins(j) < i < bins(j+1):
            DO SOMETHING 
```

这对我来说看起来不太漂亮。谢谢！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-06-02T11:36:46.933

可能为时已晚，但为了将来参考，numpy 有一个功能可以做到这一点：

> [http://docs.scipy.org/doc/numpy/reference/generated/numpy.digitize.html](http://docs.scipy.org/doc/numpy/reference/generated/numpy.digitize.html)

```
>>> my_list = [3,2,56,4,32,4,7,88,4,3,4]
>>> bins = [0,20,40,60,80,100]
>>> np.digitize(my_list,bins)
array([1, 1, 3, 1, 2, 1, 1, 5, 1, 1, 1]) 
```

结果是一个索引数组，对应于来自 my_list 的每个元素也属于的 bin 中的 bin。请注意，该函数还将对位于您的第一个和最后一个 bin 边缘之外的值进行 bin 处理：

```
>>> my_list = [-5,200]
>>> np.digitize(my_list,bins)
array([0, 6]) 
```

Pandas 也有类似的东西：

> [http://pandas.pydata.org/pandas-docs/dev/basics.html#discretization-and-quantiling](http://pandas.pydata.org/pandas-docs/dev/basics.html#discretization-and-quantiling)

```
>>> pd.cut(my_list, bins)
Categorical: 
array(['(0, 20]', '(0, 20]', '(40, 60]', '(0, 20]', '(20, 40]', '(0, 20]',
       '(0, 20]', '(80, 100]', '(0, 20]', '(0, 20]', '(0, 20]'], dtype=object)
Levels (5): Index(['(0, 20]', '(20, 40]', '(40, 60]', '(60, 80]',
                   '(80, 100]'], dtype=object) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-19T00:45:33.820

也许这会帮助你走上正轨：

```
>>> import itertools
>>> my_list = [3,2,56,4,32,4,7,88,4,3,4]
>>> for k, g in itertools.groupby(sorted(my_list), lambda x: x // 20 * 20):
...     print k, list(g)
... 
0 [2, 3, 3, 4, 4, 4, 4, 7]
20 [32]
40 [56]
80 [88] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-19T00:46:35.080

首先，当值等于 bin 边界时，您的代码将失败——

改变

```
if bins(j) < i < bins(j+1): 
```

在某处有一个`<=`标志。

之后，使用`bisect`模块

```
import bisect
bisect.bisect(x, bins) 
```

或者 `bisect.bisect_right`

当值位于 bin 边界时，取决于您是更喜欢采用较高的 bin 还是较低的 bin。

# sqlite - 将 CSV 导入 SQLite

> ID：14947916
> 
> 赞同：143
> 
> 时间：2013-02-19T00:41:57.253
> 
> 标签：sqlite

我正在尝试将 csv 文件导入 SQLite 表。

示例 csv：

```
1,2
5,6
2,7 
```

示例命令：

```
sqlite> create table foo(a, b);
sqlite> .separator ,
sqlite> .import test.csv foo
Error: test.csv line 1: expected 2 columns of data but found 4 
```

我什至不确定为什么它会找到四列，其中包含六条数据和两列。

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2014-07-05T00:46:31.253

评论中还说了什么，SQLite 将您的输入视为 1、25、62、7。我也遇到了问题，在我的情况下，它通过将“分隔符”更改为“.mode csv”来解决。所以你可以尝试：

```
sqlite> create table foo(a, b);
sqlite> .mode csv
sqlite> .import test.csv foo 
```

第一个命令为表创建列名。但是，如果您想要从 csv 文件继承的列名，您可以忽略第一行。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2017-05-04T14:52:50.357

我正在将以前答案中的信息与我自己的经验合并。最简单的方法是将逗号分隔的表头直接添加到您的 csv 文件中，然后是一个新行，然后是您的所有 csv 数据。

如果您再也不会做 sqlite 的事情（像我一样），这可能会为您节省一两次网络搜索：

在 Sqlite 外壳中输入：

```
$ sqlite3 yourfile.sqlite
sqlite>  .mode csv
sqlite>  .import test.csv yourtable
sqlite>  .exit 
```

如果你的 Mac 上没有安装 Sqlite，运行

```
$ brew install sqlite3 
```

您可能需要进行一次网络搜索以了解如何安装 Homebrew。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2015-04-03T18:49:01.437

这就是我的做法。

*   制作/转换 csv 文件以由制表符 (\t) 分隔，并且不被任何引号括起来（sqlite 从字面上解释引号 - 旧文档说）
*   进入需要添加数据的db的sqlite shell

    `sqlite> .separator "\t" ---IMPORTANT! should be in double quotes sqlite> .import afile.csv tablename-to-import-to`

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2019-05-28T04:40:48.660

如何将csv文件导入sqlite3

1.  创建数据库

    ```
    sqlite3 NYC.db 
    ```

2.  设置模式和表名

    ```
    .mode csv tripdata 
    ```

3.  将csv文件数据导入sqlite3

    ```
    .import yellow_tripdata_2017-01.csv tripdata 
    ```

4.  查找表

    ```
    .tables 
    ```

5.  查找您的表架构

    ```
    .schema tripdata 
    ```

6.  查找表数据

    ```
    select * from tripdata limit 10; 
    ```

7.  计算表中的行数

    ```
    select count (*) from tripdata; 
    ```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-03-11T06:59:46.267

在 .import 命令之前，输入“.mode csv”

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-11-23T19:52:43.623

使用[Termsql](https://github.com/tobimensch/termsql)，您可以在一行中完成：

`termsql -i mycsvfile.CSV -d ',' -c 'a,b' -t 'foo' -o mynewdatabase.db`

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-01-12T13:51:48.140

我遇到了完全相同的问题（在 OS X Maverics 10.9.1 和 SQLite3 3.7.13 上，但我认为 SQLite 与原因无关）。我试图导入从 MS Excel 2011 保存的 csv 数据，顺便说一句。用作`';'`列分隔符。我发现 Excel 中的 csv 文件仍然使用 Mac OS 中的换行符 9 次，将其更改为 unix 换行符解决了这个问题。AFAIR BBEdit 和 Sublime Text 2 都有这个命令。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-08-18T13:51:02.030

就我而言，我必须查看我试图添加的文件，它有标题，分隔符是分号`;`。

我先试过：

```
.mode csv
.import myfile.csv mytable 
```

但它没有用，所以我尝试了：

```
.separator ";"
.import myfile.csv mytable 
```

它确实有效，所以我不得不手动设置分隔符。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-04-22T20:02:16.110

正如一些网站和其他文章所指出的，这很简单。 [https://www.sqlitetutorial.net/sqlite-import-csv/](https://www.sqlitetutorial.net/sqlite-import-csv/)

我们不需要为`csv`文件指定分隔符，因为 csv 表示逗号分隔。

`sqlite> .separator ,`不需要这条线。

```
sqlite> create table cities(name, population);
sqlite> .mode csv
sqlite> .import c:/sqlite/city_no_header.csv cities 
```

这将完美无缺:)

PS：我的 city.csv 带有标题。

```
 name,population
Abilene,115930
Akron,217074
Albany,93994
Albuquerque,448607
Alexandria,128283
Allentown,106632
Amarillo,173627
Anaheim,328014 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-04-22T11:34:09.563

按照步骤：-

1] sqlite3 名称

2] .mode csv 表名

3] .import Filename.csv 表名

# java - 如何将 Hashtable 添加到 NameValuePair 中？

> ID：14947918
> 
> 赞同：1
> 
> 时间：2013-02-19T00:42:24.750
> 
> 标签：java, android, httpclient, hashtable

我想添加一个 Hashtable 作为 NameValuePair 的值，如下所示：

`name= credit_card`

`value(this is the hashtable)= {expirationDate="2013/02/18", ownerName="Jack Sparrow", typeOfCard="C2"}`

或像这样：

新的 BasicNameValuePair("credit_card",{expirationDate="2013/02/18", ownerName="Jack Sparrow", typeOfCard="C2"})。

这是我的代码的一部分，您可以看到我如何添加一个简单的 NameValuePair：

```
HttpClient client = new DefaultHttpClient();
HttpPost post = new HttpPost("https://example.com/register");
try {
  List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
  nameValuePairs.add(new BasicNameValuePair("user", user));
  nameValuePairs.add(new BasicNameValuePair("password", password));
  post.setEntity(new UrlEncodedFormEntity(nameValuePairs));

  HttpResponse response = client.execute(post); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T00:48:08.317

您可以使用[Apache DigestUtils](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/digest/DigestUtils.html)轻松计算哈希：

```
String hash = DigestUtils.sha512Hex(json);
nameValuePairs.add(new BasicNameValuePair("credit_card", hash)); 
```

或者您可以直接使用 Java Cryptography API：

```
final Charset charset = Charset.forName("UTF-8");
final MessageDigest digest = MessageDigest
        .getInstance("SHA-512");
final byte[] hashData = digest
        .digest(json.getBytes(charset));
final String hash = new String(hashData, charset);
nameValuePairs.add(new BasicNameValuePair("credit_card", hash)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T01:03:50.027

我不确定我是否正确理解了您的问题。但我在这里试一试——

`String message = "hello";`

`System.out.println( DigestUtils.md5Hex(message) );`

所以你可以修改你的`add`方法，`nameValuePairs`如下所示。

`new BasicNameValuePair("credit_card", DigestUtils.md5Hex(your_json))`

这是[手册](http://commons.apache.org/codec/api-release/org/apache/commons/codec/digest/DigestUtils.html)

**问题更新后更新答案**

如果您的 HashTable 值是一个字符串，那么您可以像这样在您的`nameValuePair`

`new BasicNameValuePair("credit_card", (your_json))`

# python - 如何创建滑动窗口生成器 python 3.3

> ID：14947922
> 
> 赞同：1
> 
> 时间：2013-02-19T00:42:42.840
> 
> 标签：python, python-3.x

```
[0, 1, 1, 1, -1, -1, -1, -1, 1] 
```

您如何使用 5 的滑动窗口生成器添加它？所以它将是 0 + 1 + 1 + 1 + -1，然后是 1 + 1 + 1 + -1 + -1，等等。我正在尝试计算它们，但我无法计算出每次如何移动我的范围数到 5。

```
 for num in range(len(value)+1):
        print(sum(map(int, value[num-n_day:num]))) 
```

其中 value 是列表，n_day 是 5

对不起，我的意思是我想做：0

```
0+1 = +1
0+1+1 = +2
0+1+1+1 = +3
0+1+1+1-1 = +2
1+1+1-1-1 = +1
1+1-1-1-1 = -1
1-1-1-1-1 = -3
-1-1-1-1+1 = -3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T00:56:17.623

我会用切片和列表理解来做到这一点：

```
>>> value = [0, 1, 1, 1, -1, -1, -1, -1, 1]
>>> n_day = 5
>>> [sum(value[i:max(i-n_day, 0):-1]) for i in range(len(value))]
[0, 1, 2, 3, 2, 1, -1, -3, -3] 
```

# iphone - 让我的 iPhone 对 iTunes 不可见，密码保护连接

> ID：14947927
> 
> 赞同：1
> 
> 时间：2013-02-19T00:42:57.860
> 
> 标签：iphone, ios, itunes, jailbreak

我想知道，App Store 中是否有任何应用程序可以让我的 iPhone 对 iTunes 不可见？这意味着，当我通过 USB 电缆将我的 iPhone 连接到 PC 时，iTunes 会自动检测我的 iPhone。但是，我想要一个受密码保护的连接，因为当 iPhone 被盗时，任何人都可以将 iPhone 连接到 iTunes 并恢复所有数据。

所以我想保护它......当我的 iPhone 连接到 iTunes 时，它应该要求输入密码。

**有没有办法通过使用私有 API**或越狱 API 来做到这一点，或者是否有现成的应用程序可用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-10T19:33:46.517

iTunes 使用 AFC 守护程序通过 USB 与 iPhone 通信。显而易见的事情是防止这个守护进程自动启动。您可以使用它`launchctl`来执行此操作。

在设备启动时（或 iPhone 连接到 PC 之后），您需要执行

```
launchctl unload /System/Library/LaunchDaemons/com.apple.afcd.plist 
```

当您将您的设备连接到 PC 时，iTunes 将显示错误，指出无法连接到该设备。然后您的应用程序可以要求输入密码，当输入正确时，您可以像这样启动 AFC 守护进程

```
launchctl load /System/Library/LaunchDaemons/com.apple.afcd.plist
launchctl start com.apple.afcd 
```

此方法的唯一问题是您需要重新启动 iTunes，否则即使您启动 AFC 守护程序，他也不会检测到设备。

**更新**

找到了合适的解决方案。有 IOKit.framework API 可以打开/关闭 USB - [http://www.opensource.apple.com/source/IOKitUser/IOKitUser-502/usb_device.subproj/IOUSBDeviceControllerLib.h](http://www.opensource.apple.com/source/IOKitUser/IOKitUser-502/usb_device.subproj/IOUSBDeviceControllerLib.h)

这是代码：

```
//Declarations
IOReturn IOUSBDeviceControllerCreate(CFAllocatorRef allocator, IOUSBDeviceControllerRef* deviceRef);
IOReturn IOUSBDeviceControllerForceOffBus(IOUSBDeviceControllerRef device, int enable);    

...

//Create controller
IOUSBDeviceControllerRef device = NULL;
IOUSBDeviceControllerCreate(NULL, &device);

//Turn USB off
IOUSBDeviceControllerForceOffBus(device, 1);

//Turn USB on
IOUSBDeviceControllerForceOffBus(device, 0);

//Free controller
CFRelease(device); 
```

当 USB 关闭时，您的 mac/PC 将不再看到该设备。就像您在物理上断开了它一样。iTunes、Xcode、文件浏览器——它们都将不再看到它。

当 USB 打开时，您的 mac/PC 将检测到该设备。你不需要重新插入它。所有软件都会自动检测到它，就像设备被物理插入一样。

我应该警告您，当 USB 关闭时，如果不使用上面的代码，您将无法重新打开它。如果您坚持使用它，则只有设备重启会有所帮助。

仅在 iOS 7 上测试，但看起来这些功能自 iOS 4 起可用。

# python - 在 Python 中解析“返回路径：”

> ID：14947929
> 
> 赞同：1
> 
> 时间：2013-02-19T00:43:02.153
> 
> 标签：python, google-app-engine, email-parsing

使用 Python 解析邮件标头并在“返回路径”字段中获取电子邮件地址的最佳方法是什么？

```
Return-Path: <bob@example2.com>
Date: Sat, 16 Feb 2013 14:14:32 -0500
Subject: Hello World!
From: Robert Jones <robert.jones@example2.com>
To: Steve <steve@example.com> 
```

PS 我有点像 Python n00b，这段代码需要在 AppEngine 上运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T01:08:01.500

首先，您可能希望使用 stdlib 的[`email`](http://docs.python.org/2/library/email)包来解析消息。

我不确定您是如何获取消息的——stdlib`imaplib`或 gmail API 之类的东西为您提供了一种将标头与正文分开获取的方法，但其他方法可能会为您提供整个消息。无论哪种方式，您都可以将整个内容传递[`email.parser.HeaderParser`](http://docs.python.org/2/library/email.parser.html#parser-class-api)给解析标题并忽略其他任何内容：

```
>>> from email.parser import HeaderParser

>>> msg = HeaderParser().parsestr(header) # or parsestr(msg) if you have the whole msg
>>> return_path = msg.get('Return-Path') 
```

现在，`return_path`是字符串`"<bob@example2.com>"`，您可以将其解析为电子邮件地址（或者`None`，如果没有）。

```
>>> from email.utils import parseaddr
>>> realname, emailaddr = parseaddr(return_path) 
```

现在，`realname`是`""`，`emailaddr`是`'bob@example2.com'`。

之所以有两部分，是因为这也是完全有效的：

```
Return-Path: "Bob Example" <bob@example.com> 
```

现在，这可能不太正确。你可以有两个`Return-Path`标题吗？或者`Return-Path`标题可以包含多个地址吗？我不记得了。我可以在相关的 RFC 中查找它，但随后我还必须进行一些搜索，以确定是否有任何受欢迎的客户端违反了这些特定规则。我不记得这一切了。所以，为了方便起见，我通常假设任何东西都可以是多头和多值，并以这种方式做事：

```
>>> return_paths = msg.get_all('Return-Path') 
```

这将返回`list` `["<bob@example2.com>"]`. （如果没有`Return-Path`标题，你会得到一个空`list`的，而不是`None`，这样。）你可以一次解析所有的，得到一个`list`名称，地址对而不是一个：

```
>>> from email.utils import getaddresses
>>> for realname, emailaddr in getaddresses(returnpaths):
...     print(realname, emailaddr) 
```

如果事实证明 Return-Path 只允许单个值，则相同的代码将按原样工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:56:50.197

您可以使用该`split()`功能，然后`strip()`：

```
line = "Return-Path: <bob@example2.com>"
header, value = line.split(":")
value = value.strip() 
```

PS如果需要去掉大括号，再使用strip函数即可：

```
value = value.strip('<>') 
```

# ruby-on-rails - 从非常规页面提交表单

> ID：14947932
> 
> 赞同：1
> 
> 时间：2013-02-19T00:43:32.090
> 
> 标签：ruby-on-rails

我有一个应用程序，用户可以在其中创建调查问题。如果表单是从您期望的页面提交的，那么一切正常，如果您设置如下网址，我有

```
resources :surveys 
```

当我将表单提交到创建操作时，这就是服务器中发生的情况。

```
Started POST "/surveys" for 127.0.0.1 at 2013-02-18 16:32:39 -0800
Processing by SurveysController#create as HTML 
```

但是，在用户控制器的显示操作中，我还包含了您希望在调查控制器的“新”操作中找到的代码。这样做是为了让用户可以从他们自己的个人资料中创建调查问题。但是，当表单提交时，它现在作为“GET”请求提交，并且正在用户控制器的显示操作中进行处理，因此显然没有创建调查

```
Started GET "/twitterusers/1? whole bunch of data-passed-in-the-url-bar-via-GET-ommitted
Processing by TwitterusersController#show as HTML 
```

这就是表单的样子（我没有包括部分）。

```
<%= form_for @survey do |f| %>
  <%= f.error_messages %>
  <p>
    <%= f.label :name, "Name your Quiz" %><br />
    <%= f.text_field :name %>
    <%#= @survey.questions %>
  </p>

  <%= f.fields_for :questions do |builder| %>
       <%= render "question_fields", :f => builder %>
  <% end %>
  <p><%= link_to_add_fields "Add Question", f, :questions %></p>
  <p><%= f.submit %></p>
<% end %> 
```

我想知道是否可以对表单进行更改以完成我想要做的事情。如果这是不可取的（违反 Rails 约定），请解释在我的情况下你会做什么。

更新——来自用户控制器的显示操作的代码。调查 has_many questions (accepts_nested_attributes_for) 和问题对答案的作用相同。它创建了一个包含两组问题的表单（每组都有四个答案字段）

```
 def show
      @twitteruser = Twitteruser.find(params[:id])
      2.times do
      questions = @survey.questions.build
      4.times { questions.answers.build }
      end
    end 
```

这是调查控制器的创建操作（如果我从显示操作提交，它不会提交）

```
 def create
    @survey = current_user.surveys.build(params[:survey])

    if @survey.save
      redirect_to twitteruser_path(current_user), :notice => "Successfully created"
      # redirect_to @survey, :notice => "Successfully created survey."
    else
      render :action => 'new'
    end
 end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T01:00:42.150

尝试以下方法之一：

1.) 在您看来，更改`@survey`为`Survey.new`

或者

2.) 在您的`Users#show`操作中，添加`@survey = Survey.new`

# javascript - 带有xml文件IE的跨域ajax

> ID：14947935
> 
> 赞同：1
> 
> 时间：2013-02-19T00:43:55.227
> 
> 标签：javascript, xml, ajax, internet-explorer, xmlhttprequest

我已经构建了一个脚本来使用 jquery 的 ajax 函数来拉一个 xml 文件跨域。xml 文件是 iTunes 的 RSS 提要。在创建 xml 文件的 php 中，我添加了这个：

```
header('Access-Control-Allow-Origin: *'); 
```

我已经调查了这个问题，它适用于除 IE 之外的所有浏览器。据说它可以在 10 中工作，但我只测试了 9。我在网上查了一下，发现也许我可以破解一个 XDomainRequest，但它不是很稳定并且有很多限制，让我觉得它不值得它。

如果对于 IE 9 及以下版本无法解决此问题，那么我将简单地进行功能检测并建议用户更新到 ie 10 或下载另一个浏览器。

有谁知道在 IE 9 及以下版本中拉 xml 跨域的稳定方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T00:53:05.800

最近我自己经历了这个，我发现以下 jQuery 插件运行良好：

[https://github.com/MoonScript/jQuery-ajaxTransport-XDomainRequest](https://github.com/MoonScript/jQuery-ajaxTransport-XDomainRequest)

API 与常规 jQuery ajax 无缝协作，我只在 IE8 或 IE9（通过 requirejs）中拉入脚本。

XDomainRequest 需要记住的几件事

*   无法设置自定义标头（因此，如果您要传递数据，则必须是查询字符串）
*   无法跨越安全边界（即，无法从 HTTPS 转到 HTTP）

除了上述两点之外，我没有遇到任何问题，并且代码已经在生产环境中运行了几周。

# jquery - 使用 jquery load 来创建变量

> ID：14947939
> 
> 赞同：0
> 
> 时间：2013-02-19T00:44:17.143
> 
> 标签：jquery, variables, load

我有一个 jQuery`.load()`函数，可以在另一个页面中找到特定的 DIV，我想将该 DIV 的 ID 存储到一个变量中，但我不完全确定该怎么做。

```
$('#bow_1_img').load('http://www.klossal.com/klossviolins/inventory.html .bow:first'); 
```

所以这会将第一个 div 的内容与类 bow, `.bow:first`, 一起加载到`#bow_1_img`但我想将它加载`ID`到一个变量中，关于如何做到这一点的任何想法？

```
$.get('http://www.klossal.com/klossviolins/inventory.html', function(data) {
    var elem = $(data).find('.bow:first'),
          bow_id = elem.attr('id');
}); 
$("#bow_1").click(function() {
        window.location.href = "http://www.klossal.com/klossviolins/inventory.html#" + bow_id;
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T00:49:23.397

`load()`只是一个快捷方式`$.get`，如果您只需要 ID，请使用 $.get

```
$.get('http://www.klossal.com/klossviolins/inventory.html', function(data) {
    var elem = $(data).find('.bow:first'),
          ID = elem.attr('id');
     $("#bow_1").click(function() {
        window.location.href = "http://www.klossal.com/klossviolins/inventory.html#" + bow_id;
     });
}); 
```

请记住，它是异步的，因此只有在 ajax 函数完成后才能使用 ID。

# mysql - 将 SQL 查询从一个条件更改为多个条件

> ID：14947940
> 
> 赞同：0
> 
> 时间：2013-02-19T00:44:21.450
> 
> 标签：mysql

我有一个 SQL 查询，它检查名为 ts_allocation 的表中的值，以查看匹配的房间是否已“分配”（次要条件）。如果它们是“分配的”，那么它不会在结果中返回它们。不幸的是，由于设计限制，我的表中不能再出现这种情况了。

我现在想更改它，以便查看房间的值是否不是“待定”、“失败”或“拒绝”。如果它是三个中的任何一个，那么结果将被返回并且不会被忽略（与以前不同）。

在第一个 where 子句中获取房间后，系统需要在 ts_allocation 表中检查它们是否为“Pending”、“Failed”或“Declined”。房间可以预订特定日期或时间段 - 但如果其状态仍为“待定”、“失败”或“已拒绝”，则会查看该房间。其他任何事情都意味着房间已被预订。

我希望我在这里有意义......到目前为止，这是我的代码：

```
SELECT 
  COUNT(*) totalCount 
FROM 
  ts_room rm
WHERE building_id=:building_id AND  
  NOT EXISTS (
    SELECT 1
    FROM ts_roompref rp
      JOIN ts_request rq
      ON rp.request_id = rq.id
      AND day_id = 4
      AND period_id = ".$i."
    WHERE 
      rm.id = rp.room_id)
AND NOT EXISTS (
    SELECT 1
    FROM ts_roompref rp
      JOIN ts_allocation a
      ON rp.request_id = a.request_id
      AND a.status = 'Allocated'
    WHERE 
      rm.id = rp.room_id) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T02:43:56.777

我假设你想要房间钥匙作为查询的结果......

```
SELECT DISTINCT rm.Id as RoomId
FROM ts_room rm LEFT JOIN ts_roompref rp ON rp.room_id = rm.id
  LEFT JOIN ts_request rq ON rq.id = rp.request_id
  LEFT JOIN ts_allocation a ON a.request_id = rq.id
WHERE building_id = :building_id
  AND (a.status IS NULL OR a.status IN ('Pending', 'Failed', 'Declined')) 
```

# c# - 是否可以捕获线程开始和结束事件？

> ID：14947944
> 
> 赞同：2
> 
> 时间：2013-02-19T00:44:36.113
> 
> 标签：c#, vb.net, multithreading, winforms, visual-studio-2012

我在 C# 和 VB.Net 中继承了一个相当大的 Visual Studio WinForms 项目

当我使用它时，我在调试窗口中收到如下消息：

```
The thread '<No Name>' (0x1194) has exited with code 0 (0x0).
The thread '<No Name>' (0x664) has exited with code 0 (0x0).
The thread '<No Name>' (0x14b0) has exited with code 0 (0x0). 
```

为了更好地理解该软件，我很想研究这些线程是什么。是否有任何我可以使用的工具或我可以打开的调试选项允许我在创建/终止新线程时中断？

注意：我在我能找到的所有“... = new Thread”和“... .RunWorkerAsync()”代码上都设置了断点，但它们都没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T01:02:45.440

我知道这不是您问题的确切答案，但这里有一些已发布到另一个问题的相关信息：[Break on thread creation in Visual Studio debugger](https://stackoverflow.com/questions/3820854/break-on-thread-creation-in-visual-studio-debugger)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-13T23:19:43.280

在 Thread 类中有一个可以设置的 name 属性。当您更改它时，输出中的“No Name”文本将替换为您在此处设置的内容。这将使您更容易看到正在发生的事情。

```
Thread MyThread = new Thread(...);
MyThread.Name = "MyName"; //Can only be set once.
MyThread.Start(....); 
```

# sql - 使用 collat e nocase 字段的 SQLite 区分大小写搜索

> ID：14947945
> 
> 赞同：4
> 
> 时间：2013-02-19T00:44:39.237
> 
> 标签：sql, sqlite, collation

我有一个具有 collat​​e nocase 字段的数据库（我无法更改）：

```
 name string collate nocase 
```

我需要在这个区分大小写的字段上进行搜索。'collat​​e nocase'可以做到这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T08:25:42.907

只需[将排序规则切换](http://www.sqlite.org/lang_expr.html#collateop)回该查询：

```
SELECT * FROM MyTable WHERE name COLLATE BINARY = 'Nick' 
```

# matlab - 在不修改数据的情况下创建非线性 MATLAB 颜色图

> ID：14947946
> 
> 赞同：0
> 
> 时间：2013-02-19T00:44:47.723
> 
> 标签：matlab

我在创建自定义 MATLAB 颜色图和颜色条时遇到了一些麻烦。我想显示一个图像（`imagesc`例如），我想通过 Nx4 矩阵定义一个颜色图

```
cMap = [ x(1) r(1) g(1) b(1); ...
         x(2) r(2) g(2) b(2); ...
         ...
         x(N) r(N) g(N) b(N)]; 
```

使得图像值介于`x(i)`和之间`x(i+1)`具有颜色`r(i),g(i),b(i)`。向量`x`需要增加，但不一定以线性方式增加。另外，我希望能够用GUI点击图像并查看每个像素的实际图像值，所以我不想在显示之前重新分配像素值。最后，我想要一个颜色条，其中每种颜色都由一段等长的线段表示。

我可以通过找到 的最小公倍数`diff(x)`并将几个恒定颜色行连接到一个颜色图中来完成这些事情的 2/3，但是这使得颜色条的颜色大小与沿 x 的差异成正比，它看起来不好且难以阅读。

为了解决颜色条问题，我尝试在 中制作几个颜色的补丁对象`cMap`，将它们放置在`[inf inf]`然后调用`legend`这些对象，但是设置所有所需的图例和轴属性以使所有大小的颜色图看起来都很好很难，我一直在调试这个，因为多个用户都在使用这个工具。如果可以的话，我很想使用 MATLAB colorbar。

有没有人处理过这样的问题？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-20T15:43:48.933

您将无法让 MATLAB 颜色条以您想要的方式进行非线性拉伸和压缩。不过，您可以做的一件事是在颜色边界处设置刻度线。您可以像这样更改刻度位置：

```
>> imagesc(peaks);
>> h = colorbar;
>> set(h, 'YTick', [-5 -1.5 0 1 3.5 6.2]); 
```

另一种选择是将颜色条绘制为另一个图像，这本质上就是 MATLAB 颜色条。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T05:34:08.093

我在想，这样的事情可能会奏效......

```
 xi=floor(x/max(x));
       cMap = [ r(xi(1)) g(xi(1)) b(xi(1)); ...
                r(xi(2)) g(xi(2)) b(xi(2)); ...
                ...
                r(xi(N)) g(xi(N)) b(xi(N))]; 
```

# ios - UISearchBar 使用 prepareForSegue

> ID：14947948
> 
> 赞同：0
> 
> 时间：2013-02-19T00:44:51.563
> 
> 标签：ios, search, searchbar

我正在做一个小项目，我遇到了一个问题。我有一个带有 UISearcBar 的 UITableView。一切正常，搜索给了我正确的结果，但现在我想使用 prepareForSegue 方法来为每个搜索结果转到 detailViewController。

例如。if I search for product "A", and found it, when choose that produt it goes for a ViewController_A, if I search and chose product "B" it should go for ViewControler_B.

此刻，这段代码没有我选择的任何东西，它总是转到同一个 Viewcontroller。

```
#pragma mark - TableView Delegate
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    // Perform segue to candy detail
    [self performSegueWithIdentifier:@"candyDetail" sender:tableView];

}

#pragma mark - Segue
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([[segue identifier] isEqualToString:@"candyDetail"]) {
        UIViewController *candyDetailViewController = [segue destinationViewController];

        // In order to manipulate the destination view controller, another check on which table (search or normal) is displayed is needed
        if(sender == self.searchDisplayController.searchResultsTableView) {
            NSIndexPath *indexPath = [self.searchDisplayController.searchResultsTableView indexPathForSelectedRow];
            NSString *destinationTitle = [[filteredCandyArray objectAtIndex:[indexPath row]] name];
            [candyDetailViewController setTitle:destinationTitle];
        }
        else {
            NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];
            NSString *destinationTitle = [[candyArray objectAtIndex:[indexPath row]] name];
            [candyDetailViewController setTitle:destinationTitle];
        }

    }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:59:53.467

那是因为你总是调用相同的 segueId，“candyDetail”。

相反，您应该在您的 中连接两个手动 segue `UIStoryBoard`，每个都指向不同的场景（一个 id 为“showViewControllerA” `ViewControllerA`，另一个“showViewControllerB”指向`ViewControllerB`）。然后您可以执行以下操作：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if ([[self.candyArray objectAtIndex:indexPath.row] isKindOfClass:[CandyA class]]) {
        [self performSegueWithIdentifier:@"showViewControllerA" sender:self];
    } else if ([[self.candyArray objectAtIndex:indexPath.row] isKindOfClass:[CandyB class]]) {
        [self performSegueWithIdentifier:@"showViewControllerB" sender:self];
    };
}

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"showViewControllerA"]) {
        ViewControllerA *viewControllerA = [segue destinationViewController];
        // configure viewControllerA here...
    } else if ([[segue identifier] isEqualToString:@"showViewControllerA"]) {
        ViewControllerB *viewControllerB = [segue destinationViewController];
        // configure viewControllerB here...
    }
} 
```

另一种选择是您可以将动作转场直接连接到不同的单元格，并`-tableView:cellForRowAtIndexPath:`根据源数组中的糖果类型切换出列的单元格类型。无论哪种方式，您都需要两个指向不同场景的转场。

# python - 为什么 lista.sort() + listb.sort() 在 python 中不起作用？

> ID：14947949
> 
> 赞同：0
> 
> 时间：2013-02-19T00:44:52.200
> 
> 标签：python, list, sorting

我在 python 中尝试了这段代码，它运行良好：

```
listX.sort()
list1.sort()

result = listX + list1 
```

但以下代码不起作用：

```
result = listX.sort() + list1.sort() 
```

它给了我这个错误信息：

```
TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType' 
```

我怎样才能解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T00:46:33.547

因为该`list.sort`方法在原地对列表进行操作，所以返回`None`. 相反，`sorted`是一个内置函数，它确实*返回*排序后的输出。

```
result = sorted(listX) + sorted(list1) 
```

那会做你想要的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-19T00:47:29.770

这是因为`list.sort()`返回`None`，所以你实际上是在做：

```
None + None 
```

这甚至没有意义。

如果你想连接两个列表的排序元素，你可以这样做：

```
listA.sort()
listB.sort()
listC = listA + listB 
```

或者，（推荐）：

```
listC = sorted(listA) + sorted(listB) 
```

和返回值`sorted()` *一样。*

# c# - ajax 总是进入代码的错误部分

> ID：14947950
> 
> 赞同：1
> 
> 时间：2013-02-19T00:44:55.703
> 
> 标签：c#, asp.net-mvc, jquery

我对 ajax 不是很好，但要使用我的一个 jquery 插件，我必须在 ajax 中做一些调用。问题是它总是在函数的错误处理中，我不知道为什么。由于我使用的是 Visual Web Developper Express，因此 JavaScript 调试不起作用。

这是jquery函数：

```
$('.auto-submit-star').rating({
            callback: function (value, link) {
                $.ajax({
                    type: "POST",
                    url: "/Recipe/Rate",
                    data: $("#rate").serialize(),
                    dataType: "text/plain",
                    success: function (response) {
                        if (response != 'false') {
                            alert('Your vote has been saved');
                        } else {
                            alert('You already voted for this recipe!');
                        }
                    },
                    error: function (response) {
                        alert('There is an error');
                    }
                });
            }
        }); 
```

然后，它进入控制器。我已经调试了这部分并且它可以工作，它将好的值保存在数据库中，然后根据用户是否已经投票返回“false”或“”。

这是代码：

```
[HttpPost]
        [Authorize]
        public ActionResult Rate(FormCollection form)
        {
            var rate = Convert.ToInt32(form["Score"]);
            var id = Convert.ToInt32(form["IDRecipe"]);

            //On valide si l'utilisateur a déja voté
            Guid userGuid = (Guid)Membership.GetUser().ProviderUserKey;
            var existingVote = db.StarRatings.Where(a => a.IDRecipe == id).Where(b => b.IDUser == userGuid).FirstOrDefault();

            if (existingVote != null)
                return Content("false");

            StarRating rating = new StarRating();
            rating.IDRecipe = id;
            rating.IDUser = (Guid)Membership.GetUser().ProviderUserKey;
            rating.Score = rate;

            var recipe = db.Recipes.Where(a => a.IDRecipe == id).First();
            recipe.StarRatings.Add(rating);
            db.SaveChanges();

            return Content("");
        } 
```

任何人都可以告诉我为什么我总是收到“有错误”的消息，而它从来没有进入 ajax 调用的“成功”部分？我需要在控制器中返回一些特殊的东西吗？

***编辑***

这是 Internet Explorer 调试器中响应变量的屏幕截图，其中一条评论让我发现。

![截屏！](../Images/8e26abbb794434760b0e808810e4a2bf.png)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T02:09:48.553

我建议进行以下更改：

```
[HttpPost]
[Authorize]
public JsonResult Rate(int Score, int IDRecipe)
{
    //On valide si l'utilisateur a déja voté
    Guid userGuid = (Guid)Membership.GetUser().ProviderUserKey;
    var existingVote = db.StarRatings.Where(a => a.IDRecipe == IDRecipe).Where(b => b.IDUser == userGuid).FirstOrDefault();

    if (existingVote != null)
        return Json(false);

    StarRating rating = new StarRating();
    rating.IDRecipe = IDRecipe;
    rating.IDUser = (Guid)Membership.GetUser().ProviderUserKey;
    rating.Score = Score;

    var recipe = db.Recipes.Where(a => a.IDRecipe == IDRecipe).First();
    recipe.StarRatings.Add(Score);
    db.SaveChanges();

    return Json(true);
} 
```

你的 JavaScript 调用：

```
$('.auto-submit-star').rating({
    callback: function (value, link) {
        $.ajax({
            type: "POST",
            url: "/Recipe/Rate",
            data: { IDRecipe: GetRecipeID(), Score: GetScore() },
            cache: false,
            success: function (response) {
                alert(response);
            },
            error: function (xhr, error) {
                alert(error);
            }
        });
    }
}); 
```

`data`传递给调用的对象值`$.ajax`将作为一组查询参数附加到 URL，从而产生一个类似于该 URL 的 URL `/Recipe/Rate?IDRecipe=123&Score=123`，MVC 代码会解释该 URL 以找到适当的参数以在对该`Rate`方法的调用中进行初始化。同样，方法中的`Json(true)`and`Json(false)`返回`Rate`将被转换为 JSON 编码的字符串并作为响应的主体返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T02:21:52.533

我能够重现此问题并通过使用`text`而不是`text/plain`. 我对原因的理解是浏览器首先将响应解释为 HTML 并因此引发错误。我可以在控制台中运行代码并在遇到我的控制器返回的文本“Blah”并显示“意外的令牌 B”时看到解析错误。

除了对 Firefox 中问题的引用之外，我找不到任何可靠的文档，但我使用的是 Chrome 并且遇到了同样的问题。解决方法是使用`xhr.overrideMimeType("text/plain; charset=x-user-defined");`此处提到的[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)如果您的浏览器仍然不喜欢文本，您可能需要这样做。

```
 $.ajax({
                    type: "POST",
                    url: "/Recipe/Rate",
                    data: $("#rate").serialize(),
                    dataType: "text",
                    success: function (response) {
                        if (response != 'false') {
                            alert('Your vote has been saved');
                        } else {
                            alert('You already voted for this recipe!');
                        }
                    },
                    error: function (response) {
                        alert('There is an error');
                    }
                }); 
```

# javascript - 为什么此页面与移动浏览器不兼容？

> ID：14947955
> 
> 赞同：1
> 
> 时间：2013-02-19T00:45:20.113
> 
> 标签：javascript, android, ios, css

我正在开发一个混合应用程序并创建了以下页面：[http](http://api.babelmatch.com:3000/learn) ://api.babelmatch.com:3000/learn （粘贴下面的代码以防此 URL 将来脱机）。当我在我的 Mac 上的 Chrome 和 Safari 中测试它时，它加载得很好。但是，当我使用 iPhone（Safari 和 Chrome）或三星 Galaxy S2（Chrome）访问相同的 URL 时，页面不会加载。相反，浏览器会加载一个空白页面。

我是否使用了一些可能导致此问题的不受支持的 javascript 或 CSS？

```
<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-2.2.1.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
        }
        #content {
            height: 100%;
            width: 100%;
        }
        #row1 {
            width: 100%;
            height: 50%;
        }
        #row2 {
            width: 100%;
            height: 50%;
        }
        #q1 {
            float:left;
            background-color:red;
        }
        #q2 {
            float:left;
            background-color:yellow;
        }
        #q3 {
            float:left;
            background-color:blue;
        }
        #q4 {
            float:left;
            background-color:green;
        }
        #leftmargin {
            height: 100%;
            float: left;
            background-color:orange;
        }
        #rightmargin {
            height: 100%;
            float: left;
            background-color:purple;
        }
        #imageGrid {
            height: 100%;
            float: left;
        }
        .qImage {
            width: 100%;
        }
        .circle {
            border-radius: 1000px;
            background-color: rgb(0, 162, 232);
            z-index:100;
            top: 50% left: 50% position: fixed;
        }
    </style>
</head>

<body>
    <div id="content">
        <div id="leftmargin"></div>
        <div id="imageGrid">
            <div id="row1">
                <div id="q1">
                    <img id="q1Image" data-bind="attr:{src: q1ImagePath}" class="qImage" />
                </div>
                <div id="q2">
                    <img id="q2Image" data-bind="attr:{src: q2ImagePath}" class="qImage" />
                </div>
            </div>
            <div id="row2">
                <div id="q3">
                    <img id="q3Image" data-bind="attr:{src: q3ImagePath}" class="qImage" />
                </div>
                <div id="q4">
                    <img id="q1Image" data-bind="attr:{src: q4ImagePath}" class="qImage" />
                </div>
            </div>
            <div class="circle"></div>
        </div>
        <div id="rightmargin"></div>
    </div>
    <script type="text/javascript">
        //Set up the layout
        var viewportWidth = document.documentElement.clientWidth,
            viewportHeight = document.documentElement.clientHeight,
            q1 = document.getElementById("q1"),
            leftmargin = document.getElementById("leftmargin"),
            rightmargin = document.getElementById("rightmargin"),
            squareSize;
        if (viewportHeight <= viewportWidth) {
            //landscape
            squareSize = viewportHeight / 2;
            leftmargin.style.width = (viewportWidth - squareSize - squareSize) / 2;
            rightmargin.style.width = leftmargin.style.width;
        } else {
            //portrait
            squareSize = viewportWidth / 2;
            leftmargin.style.display = none;
            rightmargin.style.display = none;
        }
        q1.style.height = squareSize;
        q1.style.width = squareSize;
        q2.style.height = squareSize;
        q2.style.width = squareSize;
        q3.style.height = squareSize;
        q3.style.width = squareSize;
        q4.style.height = squareSize;
        q4.style.width = squareSize;
        //style the circle play button
        function upd() {
            var h = $("body").height();
            $(".circle").height(h / 5);
            $(".circle").width(h / 5);
        }
        upd();
        window.onresize = upd;
        //UI control logic
        //knockoutjs stuff
        function GridViewModel() {
            //data
            var self = this;
            self.q1ImagePath = ko.observable();
            self.q2ImagePath = ko.observable();
            self.q3ImagePath = ko.observable();
            self.q4ImagePath = ko.observable();

            // Load initial state from server, convert it to Grid instances, then populate self.tasks
            $.getJSON("http://api.babelmatch.com:3000/image?language=Cantonese&count=4", function (allData) {
                var baseUrl = "http://d22a3fhj26r1b.cloudfront.net/";
                self.q1ImagePath(baseUrl + allData[0].imageFileName);
                self.q2ImagePath(baseUrl + allData[1].imageFileName)
                self.q3ImagePath(baseUrl + allData[2].imageFileName)
                self.q4ImagePath(baseUrl + allData[3].imageFileName)
            });

            //operations

            self.refreshImages = function () {
                $.getJSON("http://api.babelmatch.com:3000/image?language=Cantonese&count=" + count, function (allData) {
                    var baseUrl = "http://d22a3fhj26r1b.cloudfront.net/";
                    self.q1ImagePath(baseUrl + allData[0].imageFileName);
                    self.q2ImagePath(baseUrl + allData[1].imageFileName)
                    self.q3ImagePath(baseUrl + allData[2].imageFileName)
                    self.q4ImagePath(baseUrl + allData[3].imageFileName)
                });
            }

        }
        ko.applyBindings(new GridViewModel());
    </script>
</body> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T00:56:00.530

页面没有`doctype`，这迫使它在浏览器中进入怪癖模式。jQuery 不支持 quirks 模式，你会遇到意想不到的行为

通过 w3c 验证器服务运行页面并使其干净

[http://validator.w3.org/check?verbose=1&uri=http%3A%2F%2Fapi.babelmatch.com%3A3000%2Flearn](http://validator.w3.org/check?verbose=1&uri=http%3A%2F%2Fapi.babelmatch.com%3A3000%2Flearn)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:58:25.047

`height:100%`大多数浏览器通常都不能很好地支持。 [http://www.tutwow.com/htmlcss/quick-tip-css-100-height/](http://www.tutwow.com/htmlcss/quick-tip-css-100-height/)

# c# - 在启动时检索 Outlook 功能区扩展中的资源管理器窗口对象？

> ID：14947963
> 
> 赞同：0
> 
> 时间：2013-02-19T00:45:39.677
> 
> 标签：c#, outlook, vsto, outlook-2010

我在尝试检索默认收件箱文件夹时遇到问题，因为我没有实例可以从中检索它。

最终，我试图检索一年或更长时间的邮件列表，以便我可以在表单中显示这些邮件并让用户知道这些邮件即将过期，因此要么移动它们，要么保存它们，否则将被删除。有一项新的企业电子邮件保留政策，即在一年后删除电子邮件并且不让用户知道。

然而，在我这样做之前，我需要一个 MailItems 列表。当 Outlook 启动时，Outlook 调用以下代码：

```
/// <summary>
/// Overridden method to allow Outlook to look for and load extensions.
/// </summary>
/// <returns>A <see cref="MailExpiryAlert"/> class containing the extension logic</returns>
protected override Office.IRibbonExtensibility CreateRibbonExtensibilityObject()
{
    if (Application.Explorers.Count > 0)
    {
        string breakPoint = "this break point will never be reached on initial startup";
    }
    return new MailExpiryAlert();
} 
```

但是，我收到以下错误： NullReferenceExceptoin：对象引用未设置为对象的实例。这是因为资源管理器窗口尚未加载，因此为空。但是，我应该如何在 Outlook 本身加载之前加载我的扩展程序（它取决于资源管理器和其中的文件夹）？我知道我在这里遗漏了一些非常基本的东西，但任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T02:41:23.907

你需要Application.Session.GetDefaultFolder(olFolderInbox)，不管有没有活跃的资源管理器。

# css - CSS图像背景大小

> ID：14947977
> 
> 赞同：0
> 
> 时间：2013-02-19T00:46:38.017
> 
> 标签：css, image, background

我一直在我网站的 CSS 中工作，但背景图片有问题。一开始图像还可以，但是当我滚动时，它就消失了。我尝试使用 100% 大小的图像来解决问题。它可以工作，但是当我进行更多滚动时，它会再次关闭。我的CSS是这样的：

```
background-image: url("../images/bg.jpg")
background-repeat: no-repeat
background-position: auto
webkit-background-size: cover
moz-background-size: cover
o-background-size: cover
background-size: 100% auto 
```

任何人都可以帮助我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:48:30.590

您可以使用：Backstretch 一个 jQuery 插件。

[http://srobbin.com/jquery-plugins/backstretch/](http://srobbin.com/jquery-plugins/backstretch/)

里面的演示:)

# elasticsearch - ElasticSearch：是否可以使用地理空间偏差进行查询？

> ID：14947983
> 
> 赞同：0
> 
> 时间：2013-02-19T00:47:06.417
> 
> 标签：elasticsearch

我想根据与geo_point的距离来查询带有偏差的文档，目前我正在使用geo_distance过滤器来过滤所有距离较大的文档，但我想要某种偏差。

例如，如果我要查询 10 个文档并且只有 6 个落在 geo_distance 过滤器内，则还返回 4 个距离更大的文档。

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T01:23:38.277

将您的主要查询包装到[自定义过滤器分数查询](http://www.elasticsearch.org/guide/reference/query-dsl/custom-filters-score-query.html)中，并将您的 geo_distance 过滤器作为过滤器之一。

# html - 从父框架中的 iframe 打开锚标记

> ID：14947986
> 
> 赞同：8
> 
> 时间：2013-02-19T00:47:42.507
> 
> 标签：html

给定以下 HTML，iframe 中的锚标记是否可以定位父窗口？

```
<div>
  <iframe src="/pageview.html"></iframe>
</div> 
```

iframe (pageview.html) 内容：

```
<a href="http://www.google.com">link</a> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-19T00:54:21.157

你想要的[`target`属性](https://developer.mozilla.org/en-US/docs/HTML/Element/a#attr-target)：

```
<a href="something" target="_parent">go</a> 
```

使用`_parent`将针对框架的直接父窗口。要定位顶部窗口，请使用`_top`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T00:53:42.820

```
<div>
  <iframe src="/pageview.html">
    <a onclick="javascript:window.parent.location.href='http://www.google.com'; return false;">link</a>
  </iframe>
</div> 
```

应该是这样的...

# linux - 比较bash中的整数和浮点数

> ID：14947990
> 
> 赞同：1
> 
> 时间：2013-02-19T00:47:56.213
> 
> 标签：linux, bash

我正在尝试比较 bash 脚本中的整数和浮点数。我尝试了以下方法：

`if [ $? -eq 4.189 ];`

这不起作用，因为它希望 4.189 是一个整数，并且

`if [ $? = 4.186 ];`

因为我认为这可能会奏效。我也试过公元前。关于如何做到这一点的任何提示？在这里抨击新手。非常感谢。

注意：$? 是计算球体体积的可执行文件的输出。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T00:58:01.713

这将起作用

```
#!/bin/bash
volume=4.189
if [[ $(echo "$volume == 4.189" | bc) -eq "1" ]]; then
    echo Equal
else
    echo Not Equal
fi 
```

或者简单地将文字放在引号中

```
#!/bin/bash
volume=4.189
if [[ $volume == "4.189" ]]; then
    echo Equal
else
    echo Not Equal
fi 
```

请注意，在我展示的两种比较浮点的方法中，首选是使用 bc，它会告诉您 4.1890 等于 4.189，而第二种方法是哑字符串比较，它们将比较不相等。

# entity-framework-5 - 设置 EF5 和查找表时出现问题

> ID：14947993
> 
> 赞同：0
> 
> 时间：2013-02-19T00:48:09.730
> 
> 标签：entity-framework-5, table-per-hierarchy

我正在尝试设计一个带有 TPH 查找表的代码优先模型，如下所示：

```
public abstract class LookupValue
{
   [Key]
   public string Value { get; set; }
}

public class PaymentTerm : LookupValue {}
public class ShippingCode : LookupValue {}
public class ReviewStatus : LookupValue {}
public class RecordStatus : LookupValue {} 
```

我希望 Entity Framework 生成一个带有鉴别器的表，它会这样做，如下所示；

```
CREATE TABLE [LookupValues] (
    [Value] [nvarchar](30) NOT NULL,
    [Discriminator] [nvarchar](128) NOT NULL,
    CONSTRAINT [PK_dbo.LookupValues] PRIMARY KEY ([Value])
) 
```

在我的上下文 OnModelCreating 覆盖中，我定义了以下内容：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<PaymentTerm>()
                .Map(m => m.Requires("Discriminator").HasValue("PaymentTerm"));
    modelBuilder.Entity<ShippingCode>()
                .Map(m => m.Requires("Discriminator").HasValue("ShippingCode"));
    modelBuilder.Entity<ReviewStatus>()
                .Map(m => m.Requires("Discriminator").HasValue("ReviewStatus"));
    modelBuilder.Entity<RecordStatus>()
                .Map(m => m.Requires("Discriminator").HasValue("RecordStatus"));
} 
```

我想按如下方式使用这些查找对象：

```
public class Customer {
     ....
     [Required]
     public virtual PaymentTerm Terms { get; set; }

     [Required]
     public virtaul ShippingCode ShippingCode { get; set; }

     [Required]
     public virtual ReviewStatus ReviewStatus { get; set; }

     [Required]
     public virtual RecordStatus RecordStatus { get; set; }
     ...
} 
```

我可以创建 Code-First 迁移，但是当我尝试更新数据库时，出现错误

**引用关系会导致循环引用是不允许的……**

我发现这是由于`ON DELETE CASCADE`SQL 脚本生成如下：

```
ALTER TABLE [Customer] ADD CONSTRAINT [FK_dbo.Customer_dbo.LookupValues_ShippingCode_Value] FOREIGN KEY ([ShippingCode_Value]) REFERENCES [LookupValues] ([Value]) ON DELETE CASCADE
ALTER TABLE [Customer] ADD CONSTRAINT [FK_dbo.Customer_dbo.LookupValues_PaymentTerms_Value] FOREIGN KEY ([PaymentTerms_Value]) REFERENCES [LookupValues] ([Value]) ON DELETE CASCADE
ALTER TABLE [CustomerClinicDoctors] ADD CONSTRAINT [FK_dbo.Customer_dbo.LookupValues_RecordStatus_Value] FOREIGN KEY ([RecordStatus_Value]) REFERENCES [LookupValues] ([Value]) ON DELETE CASCADE
ALTER TABLE [Customer] ADD CONSTRAINT [FK_dbo.Customer_dbo.LookupValues_ReviewStatus_Value] FOREIGN KEY ([ReviewStatus_Value]) REFERENCES [LookupValues] ([Value]) ON DELETE CASCADE 
```

我读过我应该把它`.WillCascadeOnDelete(false)`放在流利的api中，但我不能让它接受它。希望得到一些帮助...

如何关闭这些关系上的 DELETE CASCADE。我并不打算真的需要删除查找值的能力，而只是想在我的存储库中有一个简单的代码接口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T09:16:08.347

您需要为每个关系定义流畅的映射。尝试这个：

```
public class YourContext : DbContext {
    protected override void OnModelCreating(DbModelBuilder modelBuilder) {
        modelBuilder.Entity<Customer>()
                    .HasRequired(c => c.Terms)
                    .WithMany()
                    .WillCascadeOnDelete(false);

        modelBuilder.Entity<Customer>()
                    .HasRequired(c => c.ShippingCode)
                    .WithMany()
                    .WillCascadeOnDelete(false);

        modelBuilder.Entity<Customer>()
                    .HasRequired(c => c.ReviewStatus)
                    .WithMany()
                    .WillCascadeOnDelete(false);

        modelBuilder.Entity<Customer>()
                    .HasRequired(c => c.RecordStatus)
                    .WithMany()
                    .WillCascadeOnDelete(false);
    }
} 
```

# c++ - cpp中的“::function()”是什么意思？

> ID：14947996
> 
> 赞同：2
> 
> 时间：2013-02-19T00:48:17.130
> 
> 标签：c++

在源文件中，例如我们有 A 类。

```
A::b() {
  ::c();
} 
```

“::c()”是什么意思？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T00:49:23.983

这意味着«`c()`从全局命名空间调用函数»；`::`通常在存在具有相同名称的类方法时使用，如果未指定将调用该方法。

通常在 C 库包装类中看到，当包装方法与“原始”C 函数具有相同的名称时。

请注意，这只是命名空间解析运算符的一个特例，您经常会看到像`namespace::name`（例如`std::cout`）这样使用它；要指定您想要来自全局命名空间的名称，您只需省略该`namespace`部分。

# c++ - 函数c ++中指针之间的相等性

> ID：14947997
> 
> 赞同：0
> 
> 时间：2013-02-19T00:48:17.767
> 
> 标签：c++, pointers

您能告诉我在函数中的指针之间进行相等时有什么问题吗？让我们看看这个例子：

```
void fun(int *array1)
{
    int array2[5];
    for(int i=0;i<5;i++)
    {
        array2[i]=3;
    }
    array1=array2;
}

int main(){
    int x[5]; int n=5;
    for(int i=0;i<5;i++){
    x[i]=i; // --------> x[i]=i;
    }

    fun(x); //--------> x[i]=3

    for(int i=0;i<5;i++){
    cout<< x[i]<<" "; //-------> x[i]=i?????????? I expected x[i]=3;
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T00:54:22.107

```
void fun(int *array1)
{
    int array2[5];
    for(int i=0;i<5;i++)
    {
        array2[i]=3;
    }
    array1=array2; // **HERE**
} 
```

当这个函数返回时，`array2`不再存在。因此，即使这确实将值返回`array1`给调用者，调用者也只会有一个指向不再存在的数组的指针。

当然，它甚至不这样做。`array1=array2;`将`array1`变量设置为指向`array2`。但它们都是局部变量，所以无论如何这对调用者没有影响。

也许你想要：

```
 memcpy(array1, array2, sizeof(array2)); 
```

但这是 C++，您应该使用像[std::array](http://en.cppreference.com/w/cpp/container/array)这样的合理容器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T01:00:11.437

您在有趣的函数中使用 int[5] 创建一个新数组，我认为您打算这样做：

```
/**
  * not every array is 5 items long, thus it is unsafe
  */

void fun(int *array1)
{
    int* array2 = array1;
    for(int i=0;i<5;i++)
    {
        array2[i]=3;
    }
} 
```

现在 int* array2 指向你在主函数中调用的数组

# vba - 如何将单元格 vlookup 转换为 VBA

> ID：14947998
> 
> 赞同：3
> 
> 时间：2013-02-19T00:48:17.750
> 
> 标签：vba, excel, lookup-tables, vlookup

目前，我的单元格中有一个公式：

```
=IFERROR(VLOOKUP(A:A,'Daily Report'!A:Z,2,FALSE),"")

=IFERROR(VLOOKUP(A:A,'Daily Report'!A:Y,7,FALSE)&", "&VLOOKUP(A:A,'Daily Report'!A:Y,8,FALSE)&", #"&VLOOKUP(A:A,'Daily Report'!A:Y,9,FALSE)&"-"&VLOOKUP(A:A,'Daily Report'!A:Y,10,FALSE)&", Singapore "&VLOOKUP(A:A,'Daily Report'!A:Y,11,FALSE),"") 
```

如何将其转换为 VBA，以便使用此公式对整个列进行加密？

我的公式总是被那些使用我的 Excel 表格的人所取代。

我避免锁定单元格，因此查看 VBA 来执行此操作。

编辑：

**宏**

```
Sub vlookup()
Dim LR As Long
LR = Cells(Rows.Count, "A").End(xlUp).Row
    Range("D2").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(VLOOKUP(C[-3],'Daily Report'!C[-3]:C[22],2,FALSE),"""")"
    Selection.AutoFill Destination:=Range("D2:D" & LR), Type:=xlFillDefault
End Sub 
```

现在如何制作数据，例如09-02-18022013-03383-A，当输入到A列时，它将运行宏来输入正确的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T01:16:46.923

如果必须使用 VBA，最简单的方法是在受影响的单元格中重新编写公式：

首先，将它放在工作表的模块中。这将导致每次对 A 列进行更改时触发宏。

```
Private Sub Worksheet_Change(ByVal Target as Range)
If Not Intersect(Target,Me.Range("A:A")) Is Nothing Then
Application.EnableEvents = False   'to disable infinite loop
    InsertFormula
Application.EnableEvents = True
End If
End Sub 
```

然后，把它放在一个普通的代码模块中：

```
Sub InsertFormula()
Dim rng as Range   'this will set the range in which you want this formula to appear
Dim cl as Range    'cell iterator within rng variable
Dim strFormula1 as String  `string to hold the formula text

set rng = Range("B2:B39")   'Change this range to the desired range
strFormula = "=IfError(Vlookup(A:A,'Daily Report'!A:Z,2,False),"")"

For Each cl in rng
    cl.Formula = strFormula
Next

End Sub 
```

因此，以编程方式插入普通公式相当容易。

那么问题就变成了你想多久强制/覆盖这些单元格？您可以将此宏绑定到“事件”，例如，无论何时打开工作簿文件，或每当工作表上的值发生更改，或每当有人手动更改您不希望它们更改的单元格时，等等。

你的第二个公式你可以用它做同样的事情，只需添加另一个 Range 变量（例如，`Dim rng2 as Range`）和另一个字符串变量来保存公式文本（例如，`strFormula2`）。

或者，您可以纯粹在 vba 中“重写公式”。替换`cl.Formula = strFormula`为`cl.Value = MyLookupFormula`并将此函数添加到包含上述子例程的代码模块中：

```
Function MyLookupFormula() as Variant
'Performs equivlanet to worksheet function
If Not IsError(Application.WorksheetFunction.Vlookup(Range("A:A"),Sheets("Daily Report").Range("A:Z"),2,False)) Then

myLookupFormula = (Application.WorksheetFunction.Vlookup(Range("A:A"),Sheets("Daily Report").Range("A:Z"),2,False))

Else: myLookupFormula = vbNullString
End Function 
```

但这需要更多地了解触发此宏的频率/事件，因为单元格将没有任何公式（公式/计算仅在用户或事件触发器请求时在内存中执行）。