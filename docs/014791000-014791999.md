# StackOverflow 问答 14791000-14791999

# java - 使用 dbus 调用 java 方法

> ID：14791000
> 
> 赞同：2
> 
> 时间：2013-02-09T20:04:56.593
> 
> 标签：java, dbus

如何使用 dbus 导出 java 方法或对象？

我写这篇文章是因为官方文档很差，我花了几个小时才弄清楚如何去做。

理想情况下，DBus 接口应该放在 java 包中

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T20:04:56.593

**DBus.java**

```
import org.freedesktop.dbus.DBusInterface;
import org.freedesktop.dbus.DBusInterfaceName;    

@DBusInterfaceName("org.printer")
public interface DBus extends DBusInterface {
    //Methods to export
    public void Print(String message);
} 
```

**主.java**

```
import org.freedesktop.dbus.DBusConnection;
import org.freedesktop.dbus.exceptions.DBusException;

public class Main {    
    public static void main(String[] args) {
        Printer p = new Printer();

        try {
            DBusConnection conn = DBusConnection.getConnection(DBusConnection.SESSION);
            //Creates a bus name, it must contain some dots.
            conn.requestBusName("org.printer");
            //Exports the printer object
            conn.exportObject("/org/printer/MessagePrinter", p);
       } catch (DBusException DBe) {
           DBe.printStackTrace();
           conn.disconnect();
           return;
       }
    }
}

//Printer object, implements the dbus interface and gets
//called when the methods are invoked.
class Printer implements DBus {
    public boolean isRemote() {
        return false;
    }

    public void Print(String message) {
        System.out.println(message);
    }
} 
```

您可以在 shell 中使用 qdbus 进行尝试，运行：

```
qdbus org.printer /org/printer/MessagePrinter org.printer.Print test 
```

# android - 安卓纹理文本

> ID：14791012
> 
> 赞同：4
> 
> 时间：2013-02-09T20:06:04.103
> 
> 标签：android, text, textures

如何制作带有纹理而不是文本颜色或渐变的文本（例如 png 文件）？像[这样](http://pe-images.s3.amazonaws.com/type/effects/texture-text/photo-in-text.jpg)的东西。我理解逻辑，我应该使文本颜色透明并放在文本位图下。我想我无法用`Textview`. 而且我不知道如何使用画布或 OpenGL 来做到这一点。请问有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T22:17:44.243

这是一种使用`PorterDuffXfermode`.

```
public class MainActivity extends Activity {
    private EditText mEditText;
    private ImageView mImageView;
    private Bitmap mTexture;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        mEditText = (EditText) findViewById(R.id.activity_main_edittext);
        mImageView = (ImageView) findViewById(R.id.activity_main_image);

        mTexture = BitmapFactory.decodeResource(getResources(),
                R.drawable.texture);
    }

    public void onTextCreate(View v) {
        final String text = mEditText.getEditableText().toString();

        Bitmap result = Bitmap.createBitmap(mTexture.getWidth(),
                mTexture.getHeight(), Bitmap.Config.ARGB_8888);
        Canvas canvas = new Canvas(result);
        Paint paint = new Paint();
        paint.setAntiAlias(true);
        paint.setTextSize(200);
        paint.setARGB(255, 0, 0, 0);

        canvas.drawText(text, 200, 200, paint);
        paint.setXfermode(new PorterDuffXfermode(Mode.SRC_IN));
        canvas.drawBitmap(mTexture, 0, 0, paint);
        paint.setXfermode(null);

        mImageView.setImageBitmap(result);
    }
} 
```

布局非常简单：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity">

    <EditText
        android:id="@+id/activity_main_edittext"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:hint="Write a sample text" />

    <ImageView
        android:id="@+id/activity_main_image"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true" />

    <Button
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:onClick="onTextCreate"
        android:text="Do it!" />

</RelativeLayout> 
```

此代码使用`canvas.drawText()`. 如果你想使用一个常规的`TextView`，你可以：

*   创建`TextView`
*   设置文本
*   使用`TextView`_`textView.draw(canvas);`
*   而不是`canvas.drawText()`使用`canvas.drawBitmap()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T21:38:06.657

这是来自[http://teamyoda.wordpress.com/2012/07/23/drawing-text-in-opengl-for-android/](http://teamyoda.wordpress.com/2012/07/23/drawing-text-in-opengl-for-android/)的片段- JVitela 的回答

```
 // Create an empty, mutable bitmap
Bitmap bitmap = Bitmap.createBitmap(256, 256, Bitmap.Config.ARGB_4444);

// get a canvas to paint over the bitmap
Canvas canvas = new Canvas(bitmap);
bitmap.eraseColor(0);

// get a background image from resources
// note the image format must match the bitmap format
Drawable background = context.getResources().getDrawable(R.drawable.background);
background.setBounds(0, 0, 256, 256);
background.draw(canvas); // draw the background to our bitmap

// Draw the text
Paint textPaint = new Paint();
textPaint.setTextSize(32);
textPaint.setAntiAlias(true);
textPaint.setARGB(0xff, 0×00, 0×00, 0×00);

// draw the text centered
canvas.drawText(“Hello World”, 16,112, textPaint);

//Generate one texture pointer…
gl.glGenTextures(1, textures, 0);

//…and bind it to our array
gl.glBindTexture(GL10.GL_TEXTURE_2D, textures[0]);

//Create Nearest Filtered Texture
gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MIN_FILTER, GL10.GL_NEAREST);
gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MAG_FILTER, GL10.GL_LINEAR);

//Different possible texture parameters, e.g. GL10.GL_CLAMP_TO_EDGE
gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_S, GL10.GL_REPEAT);
gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_T, GL10.GL_REPEAT);

//Use the Android GLUtils to specify a two-dimensional texture image from our bitmap
GLUtils.texImage2D(GL10.GL_TEXTURE_2D, 0, bitmap, 0);

//Clean up
bitmap.recycle(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-15T20:44:11.967

很抱歉发布这么晚，但我想我会有所帮助。因此，要制作带纹理的文本，例如，您的*layout/文件夹中有一个名为**my_layout.xml*的 文件，其定义如下：

 *```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent">

    <TextView
    android:id="@+id/some_text_id"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerInParent="true"
    android:text="@string/some_text"/>

</RelativeLayout> 
```

在您的*drawable/* 文件夹中，您有一张名为*texture.png*的图片，您只需在 java 代码中引用（例如在 MainActivity 类中）这样：

```
public class MainActivity extends Activity
{
    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.my_layout);
        TextView welcome = (TextView) findViewById(R.id.some_text_id);
        Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.texture);
        Shader shader = new BitmapShader(bitmap,Shader.TileMode.REPEAT, Shader.TileMode.REPEAT);
        welcome.getPaint().setShader(shader);

    }
} 
```*

# php - Laravel 未处理异常未定义索引：core.php 第 218 行上的 argv

> ID：14791015
> 
> 赞同：1
> 
> 时间：2013-02-09T20:06:14.100
> 
> 标签：php, laravel, laravel-3

我喜欢认为我的 Google-fu 技能相当不错，但我找不到解决这个特定问题的方法。我在本地服务器上的开发盒上运行 laravel。我在 Debian Mint 机器上运行 nginx，PHP 版本 5.4.6-1。

当我将浏览器指向本地框时，我收到以下错误消息：

```
Unhandled Exception

Message:

Undefined index: argv
Location:

/var/www/laravel/laravel/core.php on line 218 
```

该特定代码片段如下所示：

```
/*
|--------------------------------------------------------------------------
| Set The CLI Options Array
|--------------------------------------------------------------------------
|
| If the current request is from the Artisan command-line interface, we
| will parse the command line arguments and options and set them the
| array of options in the $_SERVER global array for convenience.
|
*/

if (Request::cli())
{
    $console = CLI\Command::options($_SERVER['argv']);

    list($arguments, $options) = $console;

    $options = array_change_key_case($options, CASE_UPPER);

    $_SERVER['CLI'] = $options;
} 
```

关于如何解决这个特别烦人的问题有什么建议吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:27:16.937

感谢马里奥的提醒，不认为问题出在 PHP 配置设置上，现在我知道从更广泛的角度来研究它。我找到了设置并在 php.ini 上切换了它。我重新启动了 php 服务（因为它与 nginx 分开运行，与 Apache 不同），它就像一个魅力。

# javascript - Android查询中的多个嵌入式运算符（（a AND b）OR（c AND not b））

> ID：14791020
> 
> 赞同：1
> 
> 时间：2013-02-09T20:06:53.953
> 
> 标签：javascript, android, arguments, android-query

我正在尝试使用以下命令在 Android 中执行查询：return query(selection, null, null, null)，但在使用多个运算符和括号时无法返回所需的结果。这就是我想要做的：

```
 selection = "(KEY_VARIABLE > '5' AND KEY_VARIABLE2 = 'Yes') OR (KEY_VARIABLE < '5' AND KEY_VARIABLE2 = 'No')" 
```

但是，该查询返回 0 个结果，因为该查询无法识别括号。

有没有一种方法可以在 Android 中使用多个运算符和一个嵌入在运算符语句中的运算符来形成查​​询？

更新：logcat 中也不例外。一切正常，除了嵌入式 OR(AND) 语句。这是代码：

```
 public Cursor getTierSchools() {

    String range = "";
    String range2 = "";
    String range3 = "";
    double score = LabValues.myscore;
    double scoreplustwo = score + 2;
    double scoreminustwo = score - 2;
    double scoreplusfive = score + 5;
    double scoreminusfive = score - 5;
    double scoreminusone = score - 1;

    range = "( " + KEY_SCHOOLSCORE + " > " + "'" + scoreplusfive + "'" + " AND " + KEY_SCHOOLSTATEBIAS + " = 'Yes' AND " + KEY_SCHOOLSTATELONG + " = " + "'" + LabValues.mystate + "'" + " )";
    range2 = " OR " + "( " + KEY_SCHOOLSCORE + " > " + "'" + scoreminusone + "'" + " AND " + KEY_SCHOOLSTATEBIAS + " = 'Yes' AND " + KEY_SCHOOLSTATELONG + " != " + "'" + LabValues.mystate + "'" + " )";
    range3 = " OR " + "( " + KEY_SCHOOLSCORE + " > " + "'" + scoreplustwo + "'" + " AND " + KEY_SCHOOLSTATEBIAS + " = 'No'" + " )";         

    String selection = range + range2 + range3;
    return query(selection, null, null, sorting); 
```

}

```
private Cursor query(String selection, String[] selectionArgs, String[] columns, String sortOrder) {
    SQLiteQueryBuilder builder = new SQLiteQueryBuilder();
    builder.setTables(FTS_VIRTUAL_TABLE);
    builder.setProjectionMap(mColumnMap);

    Cursor cursor = builder.query(mDatabaseOpenHelper.getReadableDatabase(),
            columns, selection, selectionArgs, null, null, sortOrder);

    if (cursor == null) {
        return null;
    } else if (!cursor.moveToFirst()) {
        cursor.close();
        return null;
    }
    return cursor;
} 
```

基本上，我试图在括号内整合 AND 语句，类似于你如何形成一个等式： (4+4)/8 = 1 IS NOT EQUAL TO 4+4/8 = 4.5 。

解决方案：

```
 range = "(( " + KEY_SCHOOLSCORE + " > " + "'" + scoreplusfive + "'" + " AND " + KEY_SCHOOLSTATEBIAS + " = 'Yes' AND " + KEY_SCHOOLSTATELONG + " = " + "'" + LabValues.mystate + "'" + " )";
    range2 = " OR " + "( " + KEY_SCHOOLSCORE + " > " + "'" + scoreminusone + "'" + " AND " + KEY_SCHOOLSTATEBIAS + " = 'Yes' AND " + KEY_SCHOOLSTATELONG + " != " + "'" + LabValues.mystate + "'" + " )";
    range3 = " OR " + "( " + KEY_SCHOOLSCORE + " > " + "'" + scoreplustwo + "'" + " AND " + KEY_SCHOOLSTATEBIAS + " = 'No'" + " ))"; 
```

# javascript - 无法在函数中更改 JSON 变量

> ID：14791021
> 
> 赞同：-1
> 
> 时间：2013-02-09T20:06:59.637
> 
> 标签：javascript, json, ros

以下代码段更改 JSON 变量失败：

```
var data = {status: ''};

rosconnection.setOnOpen(function (e) {
        data.status = 'Succeeded';
        alert('success');
});

rosconnection.setOnError(function (e) {
        data.status = 'Failed';
        alert('fail');
}); 
```

`data`保持为空，但在`alert`内被调用`rosconnection.setOnOpen`。该错误很难复制，因此它在 a 上使用`ros connection`，但我 100% 确定它成功进入了至少一个功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:09:06.590

你没有告诉我们你是怎么知道状态没有改变的，所以......

我敢打赌：如果没有`data`更改，您将无法看到警报，因此您的代码可能看起来像这样：

```
var data = {status: ''};

rosconnection.setOnOpen(function (e) {
        data.status = 'Succeeded';
        alert('success');
});

rosconnection.setOnError(function (e) {
        data.status = 'Failed';
        alert('fail');
});

alert(data.status); 
```

所以还没有设置状态。在回调中检查它。AJAX...
AJAX 是什么意思？A 代表异步，这意味着它会在未来的某个时间（近或远）触发，你不知道什么时候，有时甚至不知道它是否会被调用。

**更新后的版本：**

```
var data = {status: ''};

rosconnection.setOnOpen(function (e) {
        data.status = 'Succeeded';
        alert(data.status);
});

rosconnection.setOnError(function (e) {
        data.status = 'Failed';
        alert(data.status);
}); 
```

# objective-c - iphone xCode 使用未声明的标识符

> ID：14791023
> 
> 赞同：2
> 
> 时间：2013-02-09T20:07:12.970
> 
> 标签：objective-c

我刚开始在 Objective-C 中编程，我遇到了“使用未声明的标识符 'uneImage'；你的意思是 '_uneImage' 吗？”的问题。很多帖子都在谈论这个，但我还没有找到解决方案。

。H ：

```
 #import 

    @interface ViewController : UIViewController 
    {
        UIImagePickerController *picker;
    }

    @property (weak, nonatomic) IBOutlet UIImageView *uneImage;

    - (IBAction)album:(id)sender;
    @end 
```

.m

```
 #import "ViewController.h"

    @interface ViewController ()

    @end

    @implementation ViewController

    - (IBAction)album:(id)sender
    {
        picker = [[UIImagePickerController alloc] init];
        picker.delegate = self;
        picker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
        [self presentViewController:picker animated:YES completion:nil];
    }

    - (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
    {
        uneImage.image = [info objectForKey:UIImagePickerControllerOriginalImage];
        [picker dismissViewControllerAnimated:YES completion:nil];
    }

    - (void)viewDidLoad
    {
        [super viewDidLoad];
        // Do any additional setup after loading the view, typically from a nib.
    }

    - (void)didReceiveMemoryWarning
    {
        [super didReceiveMemoryWarning];
        // Dispose of any resources that can be recreated.
    }

    @end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T20:12:26.310

当你定义一个属性`xyz`时，默认情况下它的名字被转换为`_xyz`命名它的支持变量。`@synthesize name;`您可以使用or 甚至覆盖它，但不再需要`@synthesize name = someOtherName;`使用 of 。`@synthesize`

属性本身从外部可见，但它不会像变量那样在范围内引入非限定名称。换句话说，你不能在没有前缀的情况下使用该属性`self`，但你可以使用它的支持变量。

长话短说，替换

```
uneImage.image = [info objectForKey:UIImagePickerControllerOriginalImage]; 
```

和

```
_uneImage.image = [info objectForKey:UIImagePickerControllerOriginalImage]; 
```

或者

```
self.uneImage.image = [info objectForKey:UIImagePickerControllerOriginalImage]; 
```

让它工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T20:12:17.200

您没有名为`uneImage`. 您有一个具有该名称的属性和一个名为 的自动合成实例变量`_uneImage`。

所以改变：

```
uneImage.image = ... 
```

到：

```
self.uneImage.image = ... // use the property 
```

或者：

```
_uneImage.image = ... // use the generated instance variable 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T20:12:10.423

您正在访问一个属性，因此您需要将“self”放在变量前面：

```
self.uneImage.image = .... 
```

# enthought - 如何查看所有模块而不是帮助（'modules'）？

> ID：14791026
> 
> 赞同：1
> 
> 时间：2013-02-09T20:07:30.557
> 
> 标签：enthought

[鉴于由于这个 python 错误](https://stackoverflow.com/questions/12223953/python-help-modules-gives-segmentation-fault-how-to-fix)，已经禁用了 help('modules') ，那么如何获得他们拥有的所有模块的列表？我知道 enpkg --list 显示了使用 Enthought 安装的所有包，但是有没有办法查看所有包或模块？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T23:29:18.973

在 ipython 终端中，如果您键入“import”，然后键入一个空格并按 Tab 键，您将看到 ipython 对您可以导入的所有模块的最佳猜测。此列表可能不完整，因为 python 允许开发人员[自定义导入命令的行为](http://www.doughellmann.com/PyMOTW/sys/imports.html#custom-importers)。该列表还将包括您不应该实际导入的内部模块。如果您在制表符之前添加其他字符，这些字符会将列表过滤到以这些字符开头的模块。

请注意，大多数复杂的包都包含许多模块。查看 python site-packages 目录中的子目录以及文件 site-packages/easy-install.pth 的内容是查看通常安装的第三方安装包的另一种方法。

# javascript - imacros jave 循环读取新的 csv 行？

> ID：14791028
> 
> 赞同：-2
> 
> 时间：2013-02-09T20:07:44.693
> 
> 标签：javascript, firefox, scripting, imacros

如果我在 javascript 中将此代码用于 imacros

`for(var i=0;i<10;i++)`

并将其放在开头（我将填写 10 张表格）

`macro +-= SET !DATASOURCE input.csv`

`macro +-= SET !DATASOURCE_COLUMNS 7`

将每个循环，从我的下一行读取

`{{!COL1}} {{!COL2}} {{!COL3}}`..ETC

还是我必须放

`{{!LOOP}}`某处？

所以...如果我想填写表格 10 次，每个循环是否会从下一个 csv 行读取，如果我只是使用

`for(var i=0;i<10;i++)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:09:45.833

您只能在 imacros 中切换这样的行，而不是列。试试这个代码示例：

```
 var load;
    load =  "CODE:";
    load +=  "set !extract null" + "\n"; 
    load +=  "SET !DATASOURCE input.csv" + "\n"; 
    load +=  "SET !DATASOURCE_COLUMNS 7" + "\n"; 
    load +=  "SET !DATASOURCE_LINE {{i}}" + "\n"; 
    load +=  "SET !extract {{!col1}}" + "\n";
    var load2;
    load2 =  "CODE:";
    load2 +=  "set !extract null" + "\n"; 
    load2 +=  "SET !DATASOURCE input.csv" + "\n"; 
    load2 +=  "SET !DATASOURCE_COLUMNS 7" + "\n"; 
    load2 +=  "SET !DATASOURCE_LINE {{i}}" + "\n"; 
    load2 +=  "SET !extract {{!col2}}" + "\n";
    var load3;
    load3 =  "CODE:";
    load3 +=  "set !extract null" + "\n"; 
    load3 +=  "SET !DATASOURCE input.csv" + "\n"; 
    load3 +=  "SET !DATASOURCE_COLUMNS 7" + "\n"; 
    load3 +=  "SET !DATASOURCE_LINE {{i}}" + "\n"; 
    load3 +=  "SET !extract {{!col3}}" + "\n";
    for(i=1;i<10;i++){
    iimSet("i",i);
    iimPlay(load);
    var content=iimGetLastExtract(0);
    iimSet("i",i);
    iimPlay(load2);
    var content2=iimGetLastExtract(0);
    iimSet("i",i);
    iimPlay(load3);
    var content3=iimGetLastExtract(0);
...
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T01:58:23.457

您还可以通过将整个 CSV 文件加载到变量中来存储 CSV 中的数据。然后您可以使用 split() 方法以逗号分隔并存储在各个变量中。这个代码太长了，但如果你想使用不同的方法，这是一个想法。

# asp.net - Asp.net msgbox 在不是服务器的浏览器中没有触发

> ID：14791029
> 
> 赞同：0
> 
> 时间：2013-02-09T20:07:46.183
> 
> 标签：asp.net, .net, sql-server, vb.net

我在触发 Msgbox 时遇到问题。它不适用于 iis 服务器以外的其他浏览器。这是我的代码

```
Protected Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        If (Not Session("user") = 1) Then
            MsgBox("You are not signed in!")
            Exit Sub
  End If
End Sub 
```

如何解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:36:33.390

既然您在浏览器中说，我假设您使用的是 WinForms 或 MVC 等。MessageBox 在该上下文中不存在。研究使用 Javascript 或一些客户端代码向用户发送消息。这样的事情应该很接近：

```
String cstext = "You are not signed in!";
Page.ClientScript.RegisterStartupScript(this.GetType(), "PopupScript", cstext, true); 
```

或者：

```
ScriptManager.RegisterStartupScript 
```

祝你好运。

# php - 通过批处理文件发送电子邮件

> ID：14791038
> 
> 赞同：1
> 
> 时间：2013-02-09T20:08:29.973
> 
> 标签：php, html, email, batch-file, ip

好的，所以我的最终目标是拥有一个可以放置在外部驱动器或闪存盘甚至 cd 中的自动运行文件，如果运行将执行一堆废话，最终将计算机的 ip 信息发送回我。到目前为止，这就是我所拥有的......

一个批处理文件

*   打开一个 cmd 窗口并运行 ipconfig /all > tcpinfo.txt 将所有 ipconfig 存储在一个文件中
*   然后文件创建一个html文件

    回声 ^http://anthonyrussell.info/scripts/sendmail.php? computerinfo="这是 ipconfig 信息应该去的地方"^>^^^ >>sendEmail.html`

--批处理文件做的最后一件事是执行html文件

HTML 文件重定向到我创建的一个 php 页面，该页面使用我们创建的 html 文件传递​​的 GET 信息发送一封电子邮件。

所以这一切都有效，除了我无法将 ipconfig 信息放入 html 代码中......

有任何想法吗？

下面是我正在使用的 bat 代码。随意运行它。我已将其配置为如果您在电子邮件中添加 altEmail= 的位置，它会将其发送到您想要进行测试的任何地方。否则它会被路由给我。

将此保存为anynameyouwant.bat

```
cd desktop
ipconfig /all > tcpinfo.txt
echo ^<html^>^<head^>^<meta HTTP-EQUIV="REFRESH"content="0;url=http://anthonyrussell.info/scripts/sendmail.php?computerinfo=ip:127.0.0.1&altEmail="^>^</head^>^</html^> >> sendEmail.html
sendEmail.html 
```

## 更新

所以有时最简单的答案确实是最好的。这个场景的重点是从可能或可能没有盗窃驱动器或磁盘的人那里获取计算机信息。

想法是让它自动运行->启动批处理文件->捕获comp信息->创建html文件->带信息的电话回家

我最终做的不是从命令提示符捕获公共 IP（我现在确信无法完成），我只是创建一个 html 文件，启动它，然后在我的服务器上捕获访问者 ID，然后通过电子邮件发送它在正文中以及我在命令提示符中捕获的计算机名称。

感谢大家的意见。这是一个有趣的练习

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:11:17.013

使用卷曲。你可以做 GET、POST 和许多其他有用的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T20:58:18.507

您可以将 IP 地址 from`ipconfig`放入 for 语句中以获取如下变量：

```
for /f "tokens=2 delims=:" %%a in ('ipconfig ^| find "IPv4"') do set ipaddress=%%a 
```

然后将您的回声更改为

```
echo ^<html^>^<head^>^<meta HTTP EQUIV="REFRESH"content="0;url=http://anthonyrussell.info/scripts/sendmail.php computerinfo=ip:%ipaddress%&altEmail="^>^</head^>^</html^> >> sendEmail.html 
```

话虽如此，这可能是一个本地 IP 地址，而不是公共的，因此没有用。如果我没记错的话，没有本地方法可以获取公共 IP 地址。

**编辑：**

您可以混合使用 VBS 和批处理

*获取ip.vbs*

```
Dim o
Set o = CreateObject("MSXML2.XMLHTTP")
o.open "GET", "http://ifconfig.me/ip", False
o.send
CreateObject("Wscript.Shell" ).Run "getip.bat" & o.responseText,0 
```

*获取ip.bat*

```
cd desktop
echo ^<html^>^<head^>^<meta HTTP-EQUIV="REFRESH"content="0;url=http://anthonyrussell.info/scripts/sendmail.php?computerinfo=ip:%1&altEmail="^>^</head^>^</html^> >> sendEmail.html
sendEmail.html 
```

这只是[此处](https://superuser.com/questions/404926/how-to-get-my-external-ip-address-over-nat-from-the-windows-command-line)提供的解决方案的略微修改版本。请注意，这是未经测试的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T20:41:40.067

您可以使用反引号将 ipconfig（或任何其他命令）的输出放入变量中：

```
<?php
$ipconfig=`ipconfig`;
print $ipconfig; 
```

然后，您可以使用 php 邮件发送输出（确保首先在 php 配置中将 smtp 服务器设置为有效，或者使用 pear mail 之类的 php smtp 库）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T20:48:03.947

好的，答案如下。

我还不能让它正确地发送计算机输出，但这就是你将两者结合在一起的方式。诀窍是使用 COPY 命令。所以创建一半的html文件。追加计算机信息，然后追加 HTML 文件的其余部分。现在只是让它工作......

```
echo computerinfoblah >> computerInfoFile.txt
echo ^<html^>^<head^>^<meta HTTP-EQUIV="REFRESH"content="0;url=http://anthonyrussell.info/scripts/sendmail.php?computerinfo=" >> sendemail.html
COPY sendemail.html + computerInfoFile.txt
echo &altEmail="^>^</head^>^</html^> >> sendemail.html
sendemail.html 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-09T21:25:22.343

我这样做的方法是首先解决您将保存 txt 文件的位置...如果它在驱动器上，让我们说 E:\ 然后保存它。

```
cd E:\ 
```

然后，我会将数据保存到文本文件中。

```
ipconfig /all > tcpinfo.txt 
```

之后我会调用它来声明每一行这样的变量（假设我想要主机行，在我的情况下是我的文本文件中的第 4 行）

```
< tcpinfo.txt (
set /p notimportant=
set /p notimportant=
set /p notimportant=
set /p hostname=
) 
```

然后，如果您想将数据发送到您的网站并且您的页面正确处理它，那么您可以直接将用户发送到该网站，并提供以下信息：

```
start http://anthonyrussell.info/scripts/sendmail.php?hostname=%hostname% 
```

您必须根据您想要的字段来指定 GET 的内容。然后，您从网页中获取该数据并使用它将数据发送到您的电子邮件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-09T23:40:26.193

如果您的客户端可以连接到 smtp 服务器，那么就这样做而不是使用您的 Web 服务器。如果安装了 powershell，则内置 cmdlet 用于发送电子邮件。只需让你的批处理脚本运行 powershell.exe 并给它一个脚本块来执行。

# boost - Boost Asio，异步服务器和视频跟踪

> ID：14791040
> 
> 赞同：0
> 
> 时间：2013-02-09T20:08:34.910
> 
> 标签：boost, asynchronous, boost-asio, boost-thread, artoolkit

我需要通过 ARToolKit 视频跟踪库实时收集的 (Boost) tcp 服务器信息进行传输。

哪种方法是正确的？

我实际上是用 Boost 线程和 asio 做的，但我认为我所做的事情做得不好（即使它有效）

这是我运行服务器的方法（Server 类的源代码来自 Boost 教程）：

```
 boost::asio::io_service io_service;
 Server s(io_service, 2345);
 boost::thread bt(boost::bind(&boost::asio::io_service::run, &io_service)); //server in background in a second thread 
```

然后我开始视频跟踪

```
 startTracking(); //blocking call in the main thread 
```

以这种方式定义

```
 void startTracking(){
 glutInit(&argc, argv); //global and reachable
 if ((gArglSettings = arglSetupForCurrentContext()) == NULL) {
    fprintf(stderr, "main(): arglSetupForCurrentContext() returned error.\n");
    exit(-1);}

 ... //init a lot of artoolkit parameters
 arVideoCapStart();
 argMainLoop( NULL, keyEvent, mainLoop );
 } 
```

以这种（可怕的）方式，一切正常。但是我想避免为 asio 服务器生成第二个线程（它不应该被扔在那里，正如我从 Boost 文档中读到的那样）。

否则，试图将视频拖出主线程会使 ARToolKit 库崩溃，即：

```
 boost::thread workerThread(startTracking);  
 workerThread.join(); 
```

当`join()`运行时，程序在 glutInit 调用时出现段错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T03:26:30.853

你认为 workerThread.join() 方法有什么作用？看看这个[问题](https://stackoverflow.com/questions/6241738/what-exactly-is-join-in-boost-c)的答案。因此，调用 join 方法将导致调用它的线程（主线程）阻塞并等待工作线程完成。那是你要的吗？如果您已将 ASIO 设置为在该主线程上运行，那么任何 ASIO I/O 套接字处理程序都将无法执行，因此它看起来会挂起，因为它所在的线程已被 join 方法冻结。同样对于 ARToolKit 库，如果已在此主线程上启动了对它的调用，那么它也会显示为冻结，因为在调用 join 方法时该线程被冻结。

如果这不是您的问题，请提供更多代码。

# mysql - 找到一定的价值并增加新的价值

> ID：14791042
> 
> 赞同：0
> 
> 时间：2013-02-09T20:08:54.400
> 
> 标签：mysql, character

我在 mysql 数据库中有一本字典，里面有国际词汇。我想找到这些词并插入一个新版本。不换。

**IE**当用户对“货币”值运行 PHP 查询时，搜索结果中会出现以下两种拼写。

**¥en - 日元**

我有一个想法，搜索所有包含 ¥ 的行并将它们替换为 Y 并导出到新的数据库/表，然后再次将它们导入到旧数据库，但必须有一个更简单的解决方案，对吧？

`mysql> SELECT * FROM money WHERE name LIKE '%¥%';`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:14:49.393

我认为这样的事情应该适用于您的具体示例：

```
INSERT INTO money (Field1, Field2, Name)
SELECT Field1, Field2, REPLACE(name, '¥', 'Y') n 
FROM money 
WHERE name LIKE '%¥%'; 
```

这将在您的 Money 表中插入一条新记录，将 ¥ 替换为 Y。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:15:41.993

[http://dev.mysql.com/doc/refman/5.1/en/insert-select.html](http://dev.mysql.com/doc/refman/5.1/en/insert-select.html)

例如

```
 INSERT INTO money
      SELECT REPLACE(name,'¥','Y') FROM money WHERE name like '%¥%'; 
```

# eclipse - 资源文件夹不在类路径上

> ID：14791045
> 
> 赞同：2
> 
> 时间：2013-02-09T20:09:09.087
> 
> 标签：eclipse, maven, log4j2

我[之前](https://stackoverflow.com/questions/14526772/log4j2-auto-config)关于我遇到的问题的问题导致我更改了许多文件路径，以便找到导致 Maven 无法正常工作[的答案（显然 Maven 不喜欢子源文件夹）。](https://stackoverflow.com/a/14660613/641586)
我更改了项目文件夹以遵循[Maven 的标准目录布局](http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html)，并将 log4j2.xml 放在*src/main/resources/META-INF*下，问题又回来了。
由于某种原因，eclipse 中的文件夹不在类路径中。

我如何使它工作？

**编辑：**
我正在使用最新的 m2e 来管理项目的构建和包。
该项目（目前）由几个子项目组成。
父 pom 定义了不同的模块和 Java 的编译器版本。包含 META-INF 文件夹的模块的 pom 声明了几个依赖项，仅此而已。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T20:05:54.170

右键单击您的项目-> 添加源文件夹-> 选择您的资源文件夹。完毕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-20T14:57:54.823

Eclipse Oxygen.3a 中的解决方案是右键单击文件夹 -> 构建路径 -> 用作源文件夹。

# sql-server - 使用 TextBox、ComboBox 和 RadioButton 的搜索引擎

> ID：14791050
> 
> 赞同：0
> 
> 时间：2013-02-09T20:09:16.293
> 
> 标签：sql-server, vb.net, search, search-engine

我正在 WindowsForms 中开发一个搜索引擎，我使用的是 VB.Net 2010 和 SQL Server 2008，我的连接是 ADO.Net

每当我使用文本框、组合框和单选按钮从数据库中检索记录时，我都会遇到连接字符串的困难。

我想根据这些对象的值检索记录，

```
Dim Condition1 As String = TextBox1.Text
Dim Condition2 As String = ComboBox1.Text
Dim Condition3  As String = RadioButton.Text 
```

当我尝试连接时，我使用运算符 AND..

```
SELECT * FROM TableName WHERE (Condition1 AND Condition2 AND Conditon3) 
```

当某些对象没有值时，它会给我一个错误。

```
Incorrect syntax near the word AND. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:12:19.510

切勿连接字符串进行查询！使用[SQL 参数](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.aspx)！您发布的查询很容易发生[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)。

```
Dim query as String = "SELECT * FROM TableName WHERE Column1 = @Column1 AND 
                             Column2 = @Column2 AND Column3 = @Column3"
Dim cmd As SqlCommand
cmd.Parameters.AddWithValue("@Column1", textBox1.Text)
cmd.Parameters.AddWithValue("@Column2", comboBox1.Text)
cmd.Parameters.AddWithValue("@Column3", radioButton1.Text) 
```

除上述情况外，您尝试连接的条件无效。该子句之后的任何内容`WHERE`都应指定列名和值，就像我在上面所做的那样。所以条件1应该是例如：

```
// If the column type is varchar then single quotes must be used
Dim Condition1 As String = String.Format("Name = '{0}'", TextBox1.Text) 
```

# vb.net - 在 VB 中加载顺序文件

> ID：14791054
> 
> 赞同：0
> 
> 时间：2013-02-09T20:10:00.307
> 
> 标签：vb.net, file

几年前我编写了一个 vb 程序，现在当我再次开始使用 vb 时，我遇到了一个“障碍”。带有顺序文件。我正在尝试使用文件对话框将文件加载到 vb 程序中。

注意：我正在使用结构

```
Dim FileDialog as new openFileDialog
Dim MyStream as Stream = nothing
Dim FileLocation as string  'this is to save the file location
if( FileDialog.ShowDialog() = DialogResults.OK)Then
FS = new FileStream(FileLocation, FileMode.open, fileaccess.Read)
BF = new BinaryFromatter

While FS.Position < FS.Length 
   Dim temp as unit
    ...'Please note that this is where the file reads the structures data.It is to much code to write in. 
```

当我运行程序时，我可以创建一个文件并将其与数据一起保存，然后我可以使用对话框加载它，问题是当我再次运行程序并尝试加载它时。它只是不会运行文件或加载它（记住我用这个程序创建了文件并保存了）

我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T07:42:49.117

确保在第一次写入和读取数据后关闭文件，并确保使用正确的路径 ( `FileLocation`)。

在第一次和第二次运行程序之间退出 Visual Studio。如果它有效，那么你知道你没有正确关闭文件。

`new FileStream`在赋值处设置断点并检查`FileLocation`. 它与写入文件时相同吗？

检查错误消息，如果有的话，看看它是否告诉你什么。

# ios - iOS：如何检测硬件蓝牙键盘上的转义/控制键？

> ID：14791056
> 
> 赞同：23
> 
> 时间：2013-02-09T20:10:22.717
> 
> 标签：ios, ipad, ios6, keyboard

我试图弄清楚如何检测在连接到 iOS 设备的蓝牙键盘上是否按下了 Escape（以及其他组合键，如 Ctrl 和 alt）。

一些答案似乎表明这是不可能的。但是，Appstore 中有一些应用程序可以执行此操作（例如 iSSH），因此我认为可以以某种方式使用公共 API。

我已经尝试创建自己的 UITextInput 但是当按下 Escape 键时它什么也没有收到。我可以看到 iPad 可能响应的 API 的唯一部分是启用 VoiceOver 时（Escape 就像在 Safari 中一样工作），所以我想知道是否有办法通过辅助功能 API 进入？

我还尝试查看是否可以从 NSNotificationCenter 观察到一些可能有帮助的东西，但还没有找到任何东西。

欢迎提出建议，我已经为此苦苦挣扎了一天，现在我有点不知所措。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-01-03T19:38:19.457

您现在可以在 iOS 7 中执行此操作。例如，要实现转义键，请覆盖 UITextView 并将以下方法放在您的类中：

```
- (NSArray *) keyCommands {
    UIKeyCommand *esc = [UIKeyCommand keyCommandWithInput: UIKeyInputEscape modifierFlags: 0 action: @selector(esc:)];
    return [[NSArray alloc] initWithObjects: esc, nil];
}

- (void) esc: (UIKeyCommand *) keyCommand {
    // Your custom code goes here.
} 
```

您无需检查以确保您使用的是 iOS 7，因为早期版本的操作系统不会调用 keyCommands 方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-18T16:26:49.023

您打算完成的工作没有公共 API，因此这可能会导致拒绝。

如果你愿意冒险，你可以试试[这个](http://nacho4d-nacho4d.blogspot.de/2012/01/catching-keyboard-events-in-ios.html)。Wich 基本上通过覆盖`sendEvent:`您的`UIApplication`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-18T16:30:52.213

AFAIK 使用公共 API 是不可能的。我做了一些搜索，但`esc`无法识别密钥。我唯一没有做的就是尝试`iSSH`（花费 9 欧元 :-)，但是如果您阅读 AppStore 上的说明，很明显`ESC`硬件（蓝牙）键盘上的键不起作用：

*   详尽的密钥配置支持。有`arrow`键（通过弹出窗口或工具栏）。`ctrl`, `alt`, `esc`, `tab`, `shift`,`Fn`键 ( `1-10`),```键, `PgUp`,`PgDown`和为那些未列出的键提供了多种添加方式。

*   通过服务器或终端中的选项键映射，蓝牙键盘支持`arrow`键、`function`键和键的重新映射。启用后，+按下映射到等效的+按下。`ctrl``X11/VNC``Option``key``Ctrl``key`

如您所见，在第二行`ESC`中没有提到密钥。此外，我发现了这个（旧）[帖子](https://groups.google.com/forum/?fromgroups=#!topic/issh/U5t7THbJ9bM)。

编辑：

作为您的最后一次更新，我找到了一种“隐藏”`_gsEvent`二进制文件内部的方法。但是，我不知道 Apple 静态分析器是否可以找到它。诀窍很简单……`_gsEvent`在运行时创建选择器（和其他私有选择器）！

```
-(void)sendEvent:(UIEvent *)event
{

    SEL aSelector = NSSelectorFromString([self theSelector]);
    if ([event respondsToSelector:aSelector]) {

        NSLog(@"Event: %@", event.description);
    }

    [super sendEvent:event];
}

-(NSString *)theSelector
{
    // compose the keyword as you prefer
    NSString *sel = [NSString stringWithFormat:@"%@g%@%@ent", @"_", @"s", @"Ev"];
    return sel;
} 
```

我尝试在二进制文件中搜索，但没有找到`_gsEvent`关键字，显然是因为它仅在运行时创建。
希望这可以帮助。

# javascript - 使用 getImageData 的 JS 画布碰撞检测

> ID：14791057
> 
> 赞同：1
> 
> 时间：2013-02-09T20:10:28.460
> 
> 标签：javascript, canvas, colors, collision, getimagedata

作为一个非常缺乏经验的程序员，我正在尝试编写一个游戏来检测玩家何时与画布上的某些颜色发生碰撞。我有一个黑色方块，坐标为“player.x”和“player.y”，尺寸为 50x50，当您按下箭头键时会四处移动。我在画布的其他地方也有一个固定的红色 (255,0,0) 正方形。

下面的函数应该在“玩家”方格周围抓取一个稍大的方格，并找出其中是否有任何红色。如果有，它将发送警报。问题是，这似乎不起作用。

```
function collideTest(){
    var canvas = document.getElementById("canvas");
    var c = canvas.getContext("2d");

    var whatColor = c.getImageData(player.x - 5, player.y - 5,60,60);

    for (var i = 0; i < 3600; i++) {
        if (whatColor.data[i] == 255) {
            alert("red");
        }
    }
} 
```

我半意识到这不是检测红色像素的最有效方法，但我想在将代码发布到此处之前简化代码。该功能是否有明显问题？

问题可能在于调用函数的方式。它在另一个函数的末尾被调用，该函数检测用户输入并更改“玩家”方块的坐标。在画布上绘制所有内容之前调用该函数。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-03-05T16:36:28.457

```
var whatColor = c.getImageData(player.x - 5, player.y - 5,60,60); 
```

`player.x`并且`player.y`不能是小数，请确保它们是四舍五入的，否则 getImageData 会生气，玩不好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:43:29.027

对于画布上的每个像素，whatColor.data 数组包含 4 条连续的颜色信息：红色、绿色、蓝色、alpha（不透明度）。所以每个像素的 whatColor.data 看起来像这样：

whatColor.data[i] 是颜色的红色分量。

whatColor.data[i+1] 是颜色的绿色分量。

whatColor.data[i+2] 是颜色的蓝色分量。

whatColor.data[i+3] 是颜色的 alpha（不透明度）分量。

所以你的迭代看起来像这样（每个像素 4 个索引）：

```
 for(var i = 0, n = whatColor.data.length; i < n; i += 4) {
      var red = whatColor.data[i];
      var green = whatColor.data[i + 1];
      var blue = whatColor.data[i + 2];
      var alpha = whatColor.data[i + 3];
      if(red==255){ ... it's a hit, do your thing! ... }
 } 
```

有关 imageData.data 数组的迷你教程，请参见此处：http: [//www.html5canvastutorials.com/advanced/html5-canvas-get-image-data-tutorial/](http://www.html5canvastutorials.com/advanced/html5-canvas-get-image-data-tutorial/)

顺便说一句，您可能会查看使用画布简化游戏制作的画布库之一。这里只是一些：画架Js、KineticJs、FabricJs 等等！

# xml - 在 xml 文档中简单使用 xinclude

> ID：14791058
> 
> 赞同：0
> 
> 时间：2013-02-09T20:10:28.913
> 
> 标签：xml, xsd, xinclude

我发现了一些与 xinclude 相关的问题，但没有一个专门回答我关于如何包含外部文档的基本问题

这里有几个我想互相参考的 xml 文档：

```
<?xml version="1.0" encoding="UTF-8"?>
<t:person xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://test test-schema.xsd"
    xmlns:t="http://test">

    <t:first-name>Wilma</t:first-name>
    <t:last-name>Flintstone</t:last-name>
    <t:spouse>
        <xi:include xmlns:xi="http://www.w3.org/TR/xinclude" href="fred.xml"/>
    </t:spouse>

</t:person>

<?xml version="1.0" encoding="UTF-8"?>
<t:person xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://test test-schema.xsd"
 xmlns:t="http://test">
    <t:first-name>Fred</t:first-name>
    <t:last-name>Flintstone</t:last-name>
    <t:spouse>
        <xi:include xmlns:xi="http://www.w3.org/TR/xinclude" href="wilma.xml"/>
    </t:spouse>
</t:person> 
```

和架构：

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://test"
    targetNamespace="http://test" elementFormDefault="qualified"> 

<xs:element name="person" type="personType"/>

<xs:complexType name="personType">
    <xs:sequence>
        <xs:element name="first-name" type="xs:string"/>
        <xs:element name="last-name" type="xs:string"/>
        <xs:element name="spouse" type="personType"/>
    </xs:sequence>
</xs:complexType>

</xs:schema> 
```

xi:include 元素出现无效。我一直在四处寻找，找不到像这样的简单示例。xi:include 只是应该存在的元素的替代品，对吗？

谢谢，bp

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-10T04:55:11.063

您为 Xinclude 设置了错误的命名空间。

在您的任何一个 xml 文件上运行`xmllint --xinclude`都不会产生任何更改，因为它不被识别为 xinclude 语句。

将命名空间更改为：`xmlns:xi="http://www.w3.org/2001/XInclude"`

它会在输出中做出一些改变，但你也会在相互递归中得到一个错误：

```
$xmllint --xinclude wilma.xml 
fred.xml:8: element include: XInclude error : detected a recursion in wilma.xml
<?xml version="1.0" encoding="UTF-8"?>
<t:person xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:t="http://test" xsi:schemaLocation="http://test test-schema.xsd">
    <t:first-name>Wilma</t:first-name>
    <t:last-name>Flintstone</t:last-name>
    <t:spouse>
        <t:person xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:t="http://test" xsi:schemaLocation="http://test test-schema.xsd">
    <t:first-name>Fred</t:first-name>
    <t:last-name>Flintstone</t:last-name>
    <t:spouse>
        <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="wilma.xml"/>
    </t:spouse>
</t:person> 
    </t:spouse>
</t:person> 
```

XInclude 应该递归处理 xincludes，但是根据[http://www.w3.org/TR/xinclude/#loops](http://www.w3.org/TR/xinclude/#loops)：

> 当递归处理一个 xi:include 元素时，如果处理另一个 xi:include 元素，其包含位置和 xpointer 属性值已经在包含链中处理过，则这是一个致命错误。

此外，当您尝试根据架构对其进行验证时，除了递归错误之外，您还会得到：

```
fred.xml:4: element person: Schemas validity error : Element '{http://test}person': This element is not expected. Expected is ( {http://test}first-name ).
wilma.xml fails to validate 
```

我相信这是因为您的架构说配偶 IsA personType，但在您的 xml 中，配偶包含一个 personType 元素：person。

加上上面 cm-sperberg-mcqueen 所说的话。

如果您希望在进行 xinclude 扩展之前对其进行验证，那么您需要在模式中包含 xi:include 元素及其属性。

如果您希望它在执行 xinclude 扩展后验证，xinclude 处理器将（除非您以某种方式告诉它不要）通常将 xml:base 属性添加到包含的元素，因此您需要将 xml:base 添加为允许架构中的属性。（我最初以为，既然 xml 命名空间是保留的，那么 xml: 属性不需要包含在架构中，但事实并非如此。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T19:01:51.240

想要同时执行验证和 XInclude 处理的人可能希望先执行 XInclude，然后验证，或者先验证，然后执行 XInclude，或者先验证，然后执行 XInclude 处理，然后再次验证。在当前的读心技术状态下，如果没有人类的帮助，软件无法判断出哪些是需要的。你知道你希望事情发生的顺序，但是你告诉你的软件了吗？根据您的描述，听起来您的处理器默认为先验证，然后执行 XInclude；如果你想要一个非默认的处理顺序，你必须告诉你的处理器。你如何做到这一点取决于处理器；阅读文档。

# windows-phone-8 - 覆盖 WP8 导航 - PhoneApplicationPage 崩溃

> ID：14791060
> 
> 赞同：5
> 
> 时间：2013-02-09T20:11:06.243
> 
> 标签：windows-phone-8, windows-phone

我正在尝试做一些可以说是个坏主意的事情，但我认为这仍然是可能的。我正在尝试覆盖 WP8 如何处理后退按钮并自己实现它。我推测如果我：

### 计划

1.  只在整个应用程序中创建一个“框架”和“页面”
2.  `PhoneApplicationPage.BackKeyPress`除非他们即将退出应用程序，否则请始终处理好自己。

### 复制品

[这是一个崩溃的示例项目](http://cl.ly/3R3F3L1X1Y0q)

### 编码

..那么它*应该*工作。然而，我的尝试被 Windows Phone 挫败了。[这是代码](https://github.com/reactiveui/ReactiveUI/blob/master/ReactiveUI.Mobile/WP8AutoSuspendApplication.cs)：

```
// This basically happens on PhoneApplicationService.OnLaunched
_viewModelChanged.StartWith(ViewModel).Where(x => x != null).Subscribe(vm => {
    var page = default(IViewFor);
    var frame = RootVisual as PhoneApplicationFrame;

    // Find the initial PhoneApplicationPage for the app
    page = RxApp.GetService<IViewFor>("InitialPage");

    // Depending on how we're being signalled (i.e. if this is cold start 
    // vs. resume), we need to create the PhoneApplicationFrame ourselves
    if (frame == null) {
        frame = new PhoneApplicationFrame() {
            Content = page,
        };
    }

    page.ViewModel = vm;
    var pg = page as PhoneApplicationPage;
    if (pg != null) {
        pg.BackKeyPress += (o, e) => {
            if (ViewModel.Router.NavigationStack.Count <= 1 ||
                ViewModel.Router.NavigateBack.CanExecute(null)) {
                return;
            }

            e.Cancel = true;
            ViewModel.Router.NavigateBack.Execute(null);
        };
    }

    // Finally, set Application.RootVisual
    RootVisual = frame;
}); 
```

### 悲伤

这很好用，直到此代码执行后，框架排队的 DispatcherItem 使应用程序崩溃*：*

```
System.NullReferenceException occurred
Message: A first chance exception of type 'System.NullReferenceException' occurred in Microsoft.Phone.ni.dll
Microsoft.Phone.ni.dll!Microsoft.Phone.Controls.PhoneApplicationPage.InternalOnNavigatedFrom(System.Windows.Navigation.NavigationEventArgs e)   Unknown
Microsoft.Phone.ni.dll!Microsoft.Phone.Controls.PhoneApplicationPage.Microsoft.Phone.Controls.IPhoneApplicationPage.InternalOnNavigatedFromX(System.Windows.Navigation.NavigationEventArgs e)   Unknown
Microsoft.Phone.ni.dll!System.Windows.Navigation.NavigationService.RaiseNavigated(object content, System.Uri uri, System.Windows.Navigation.NavigationMode mode, bool isNavigationInitiator, Microsoft.Phone.Controls.IPhoneApplicationPage existingContentPage, Microsoft.Phone.Controls.IPhoneApplicationPage newContentPage) Unknown
Microsoft.Phone.ni.dll!System.Windows.Navigation.NavigationService.CompleteNavigation(System.Windows.DependencyObject content, System.Windows.Navigation.NavigationMode mode)   Unknown
Microsoft.Phone.ni.dll!System.Windows.Navigation.NavigationService.ContentLoader_BeginLoad_Callback(System.IAsyncResult result) Unknown
Microsoft.Phone.ni.dll!System.Windows.Navigation.PageResourceContentLoader.BeginLoad_OnUIThread(System.AsyncCallback userCallback, System.Windows.Navigation.PageResourceContentLoader.PageResourceContentLoaderAsyncResult result) Unknown
Microsoft.Phone.ni.dll!System.Windows.Navigation.PageResourceContentLoader.BeginLoad.AnonymousMethod__0(object args)    Unknown
[Native to Managed Transition]  
mscorlib.ni.dll!System.Delegate.DynamicInvokeImpl(object[] args)    Unknown
System.Windows.ni.dll!System.Windows.Threading.DispatcherOperation.Invoke() Unknown
System.Windows.ni.dll!System.Windows.Threading.Dispatcher.Dispatch(System.Windows.Threading.DispatcherPriority priority)    Unknown
System.Windows.ni.dll!System.Windows.Threading.Dispatcher.OnInvoke(object context)  Unknown
System.Windows.ni.dll!System.Windows.Hosting.CallbackCookie.Invoke(object[] args)   Unknown
System.Windows.RuntimeHost.ni.dll!System.Windows.RuntimeHost.ManagedHost.InvokeDelegate(System.IntPtr pHandle, int nParamCount, System.Windows.Hosting.NativeMethods.ScriptParam* pParams, System.Windows.Hosting.NativeMethods.ScriptParam* pResult)   Unknown 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T23:32:55.770

所以，我已经解决了这个问题——我的代码有问题，因为我没有理解 WP8 是如何工作的 :) 这就是我现在所理解的，这也可能是错误的，但我还是会写

## 您的 WP8 应用程序是如何初始化的：

1.  操作系统通过重新水化 App.xaml.cs 创建您的 App 类
2.  这意味着，您的构造函数开始运行，作为其中的一部分，您创建了一个`PhoneApplicationFrame`
3.  创建 a`PhoneApplicationFrame`似乎*还*`PhoneApplicationService`设置了一个全局静态变量（在 App.xaml 中创建时会发生同样的事情，它设置了`PhoneApplicationService.Current`）。
4.  `NavigationService`然后尝试通过资源字符串（即`'/MainPage.xaml'`）重新创建 XAML 视图。要么它会重新创建以前被墓碑化的那个，或者如果没有，**它会默认为你的 WMAppManifest 中的那个**（这是我不明白的部分）。
5.  `PhoneApplicationFrame.Navigated`由 NavigationService 调用 - 这是您可以实际开始做的事情，包括最重要的**设置 Application.RootVisual**，这将发送 Loading... 屏幕
6.  `PhoneApplicationService.Launched`或者`PhoneApplicationService.Activated`最终触发，一旦基本上一切都设置好了，这取决于您的应用程序是如何被唤醒的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-10T00:31:56.800

发现问题。嗯，冰山一角。

InternalOnNavigatedFrom 方法的代码是：

```
internal override void InternalOnNavigatedFrom(NavigationEventArgs e)
{
    PhoneApplicationPage content = e.Content as PhoneApplicationPage;
    string str = ((content == null) || (content.Title == null)) ? string.Empty : content.Title;
    PerfUtil.BeginLogMarker(MarkerEvents.TH_ONNAVIGATEDFROM_PAGE, string.Format("{0},{1},{2}", (base.Title == null) ? "" : base.Title, e.NavigationMode, str));
    this.OnNavigatedFrom(e);
    PerfUtil.EndLogMarker(MarkerEvents.TH_ONNAVIGATEDFROM_PAGE, string.Format("{0},{1},{2}", (base.Title == null) ? "" : base.Title, e.NavigationMode, str));
    DeviceStatus.KeyboardDeployedChanged -= new EventHandler(this.OnKeyboardDeployedChanged);
    Task rootTask = ApplicationHost.Current.RootTask;
    rootTask.OnVisibleRegionChange = (ITask.VisibleRegionChanged) Delegate.Remove(rootTask.OnVisibleRegionChange, new ITask.VisibleRegionChanged(this.OnVisibleRegionChange));
    Task task2 = ApplicationHost.Current.RootTask;
    task2.OnSipVisibilityChange = (ITask.SipVisibilityChange) Delegate.Remove(task2.OnSipVisibilityChange, new ITask.SipVisibilityChange(this.OnSipVisibilityChange));
    this._lastSipHeight = 0.0;
    this._dictionary = null;
} 
```

经过一番调试，我得出的结论是两者都不`e`为`Application.Current.RootTask`空。挠头后，我查看了`KeyboardDeployedChanged`事件处理程序的代码：

```
public static  event EventHandler KeyboardDeployedChanged
{
    [SecuritySafeCritical] add
    {
        if (KeyboardDeployedSubscription == null)
        {
            KeyboardDeployedSubscription = new SubscriptionHandler(DeviceTypes.KeyBoard);
        }
        KeyboardDeployedSubscription.Changed += value;
    }
    [SecuritySafeCritical] remove
    {
        KeyboardDeployedSubscription.Changed -= value;
    }
} 
```

这段代码写得不好。如果在`remove`, 之前调用处理程序的部分`add`，`KeyboardDeployedSubscription`则将为 null 并且将引发异常。`App`为了测试我的理论，我在的构造函数中订阅了事件：

```
 public App()
    {
        // Global handler for uncaught exceptions.
        UnhandledException += Application_UnhandledException;

        DeviceStatus.KeyboardDeployedChanged += (sender, e) => { }; 
```

果然，异常消失了。现在，为了理解为什么您的代码会触发此问题，我回溯到框架的哪一部分应该订阅该事件。唯一的候选者是`InternalOnNavigatedTo`方法。

因此，您的问题是`OnNavigatedFrom`即使`OnNavigatedTo`从未被调用过，也会被调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T05:42:14.853

由于您对 Windows Phone 的内置自动导航到 WMAppManifest.xml 中定义的页面感到困惑，因此我尝试删除自动导航，它基本上可以正常工作（没有例外）。

我刚换

```
<DefaultTask Name="_default" NavigationPage="MainPage.xaml" /> 
```

和

```
<DefaultTask Name="_default" /> 
```

不确定这是否能解决您的问题，但至少不会再崩溃了。

# python - 无效的 default_markup_type Django

> ID：14791063
> 
> 赞同：0
> 
> 时间：2013-02-09T20:11:33.920
> 
> 标签：python, django, exception, django-models

启动 Django 服务器时出现异常。我`python manage.py runserver 0.0.0.0:80`用来启动服务器。

我得到了这个例外：`ValueError: Invalid default_markup_type for field 'None', allowed values: html, plain`

这是堆栈跟踪：

```
Validating models...

Failed to setup thread-interrupt handler. This is usually not critical
Unhandled exception in thread started by <bound method Command.inner_run of <django.contrib.staticfiles.management.commands.runserver.Command object at 0x2274c90>>
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/django/core/management/commands/runserver.py", line 91, in inner_run
    self.validate(display_num_errors=True)
  File "/usr/local/lib/python2.7/dist-packages/django/core/management/base.py", line 266, in validate
    num_errors = get_validation_errors(s, app)
  File "/usr/local/lib/python2.7/dist-packages/django/core/management/validation.py", line 30, in get_validation_errors
    for (app_name, error) in get_app_errors().items():
  File "/usr/local/lib/python2.7/dist-packages/django/db/models/loading.py", line 158, in get_app_errors
    self._populate()
  File "/usr/local/lib/python2.7/dist-packages/django/db/models/loading.py", line 64, in _populate
    self.load_app(app_name, True)
  File "/usr/local/lib/python2.7/dist-packages/django/db/models/loading.py", line 88, in load_app
    models = import_module('.models', app_name)
  File "/usr/local/lib/python2.7/dist-packages/django/utils/importlib.py", line 35, in import_module
    __import__(name)
  File "/home/kcastillo/NMCSVs/nmcsv/models.py", line 29, in <module>
    class Description(UserData):
  File "/home/kcastillo/NMCSVs/nmcsv/models.py", line 30, in Description
    text = MarkupField("Description", default_markup_type='markdown')
  File "/usr/local/lib/python2.7/dist-packages/markupfield/fields.py", line 106, in __init__
    (name, ', '.join(self.markup_choices_list)))
ValueError: Invalid default_markup_type for field 'None', allowed values: html, plain 
```

例外是这行代码：

`text = MarkupField("Description", default_markup_type='markdown')`

这些都在工作。从我们的 svn 中检查出来后，我无法让它在我的虚拟机上运行。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T00:45:09.680

显然，我错过了`markdown`Django 的模块。由于Django一开始并没有抱怨我没有这个模块，所以我对错误感到困惑。

解决方案是安装模块。

`pip install markdown`

# php - 使用 PHP 将文本添加到图像（动画 gif）

> ID：14791067
> 
> 赞同：1
> 
> 时间：2013-02-09T20:11:53.177
> 
> 标签：php, javascript, jquery, html, gif

我想让我的网站访问者用他们的名字个性化他们的横幅。

1）横幅是动画GIF，但脚本似乎只输出GIF图像的第一帧

2）我需要添加一个文本字段以允许用户输入他们想要的文本。提交表单后，将生成带有文本的图像

谢谢！

index.php（下）

```
<img src="image.php?text=MyNameHere" alt="" /> 
```

image.php（下）

```
<?php

//Image
$rImg = ImageCreateFromGIF("image.gif");

//Definir cor
$cor = imagecolorallocate($rImg, 0, 0, 0);

//Text
imagestring($rImg,5,126,22,urldecode($_GET['nome']),$cor);

//Header output
header('Content-type: image/gif');
imagegif($rImg,NULL,100);

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:24:26.123

也许结合了这些：

[https://github.com/Sybio/GifFrameExtractor](https://github.com/Sybio/GifFrameExtractor)

[https://github.com/Sybio/GifCreator](https://github.com/Sybio/GifCreator)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:57:08.667

这是一个包含大量文本覆盖和/或图像覆盖选项的类文件。 [类上传.php](http://www.verot.net/php_class_upload.htm)

# python - Python将一个列表中的值添加到另一个列表中

> ID：14791069
> 
> 赞同：0
> 
> 时间：2013-02-09T20:11:53.433
> 
> 标签：python, list

我有一系列格式的列表：

```
a = [1,2,3,4,5,6,7]
b = [1,2,3,4,5,6,7] 
```

如何将相应的值加在一起以创建一个新列表，例如：

1加1，2加2...

```
c = [2,4,6,8,10,12,14] 
```

注意：每个列表中有相同数量的值。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-09T20:14:45.890

与`zip`：`list comprehension`-

```
>>> [x+y for x, y in zip(a, b)]
[2, 4, 6, 8, 10, 12, 14] 
```

`zip`与列表一起使用时，创建一个`list`由 n 个元素组成的元组。`n`所以，在这里你会得到一个`2-element`元组列表：

```
>>> zip(a, b)
[(1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (6, 6), (7, 7)] 
```

# jquery - 如何在 Internet Explorer 中加入背景图像和渐变

> ID：14791071
> 
> 赞同：2
> 
> 时间：2013-02-09T20:12:00.563
> 
> 标签：jquery, css, internet-explorer, gradient

我正在使用 CSS 在元素上放置渐变和背景图像。我从去 Colorzilla 开始渐变，它给了我这个。

```
background: rgb(250,250,250);
background: -moz-linear-gradient(left,  rgba(250,250,250,1) 0%, rgba(236,236,236,1) 100%);
background: -webkit-gradient(linear, left top, right top, color-stop(0%,rgba(250,250,250,1)), color-stop(100%,rgba(236,236,236,1)));
background: -webkit-linear-gradient(left,  rgba(250,250,250,1) 0%,rgba(236,236,236,1) 100%);
background: -o-linear-gradient(left,  rgba(250,250,250,1) 0%,rgba(236,236,236,1) 100%);
background: -ms-linear-gradient(left,  rgba(250,250,250,1) 0%,rgba(236,236,236,1) 100%);
background: linear-gradient(to right,  rgba(250,250,250,1) 0%,rgba(236,236,236,1) 100%);
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#fafafa', endColorstr='#ececec',GradientType=1 ); 
```

这适用于所有主要的浏览器，包括 Internet Explorer（至少在 IE9 中）。

然后我手动添加了背景图像。

```
background: url('/public/src/images/features_arrow_fade.png') no-repeat 260px center, rgb(250,250,250);
background: url('/public/src/images/features_arrow_fade.png') no-repeat 260px center, -moz-linear-gradient(top,  rgba(250,250,250,1) 0%, rgba(236,236,236,1) 100%);
background: url('/public/src/images/features_arrow_fade.png') no-repeat 260px center, -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(250,250,250,1)), color-stop(100%,rgba(236,236,236,1)));
background: url('/public/src/images/features_arrow_fade.png') no-repeat 260px center, -webkit-linear-gradient(top,  rgba(250,250,250,1) 0%,rgba(236,236,236,1) 100%);
background: url('/public/src/images/features_arrow_fade.png') no-repeat 260px center, -o-linear-gradient(top,  rgba(250,250,250,1) 0%,rgba(236,236,236,1) 100%);
background: url('/public/src/images/features_arrow_fade.png') no-repeat 260px center, -ms-linear-gradient(top,  rgba(250,250,250,1) 0%,rgba(236,236,236,1) 100%);
background: url('/public/src/images/features_arrow_fade.png') no-repeat 260px center, linear-gradient(to bottom,  rgba(250,250,250,1) 0%,rgba(236,236,236,1) 100%);
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#fafafa', endColorstr='#ececec',GradientType=0 ); 
```

这可以在除 IE 之外的所有主要浏览器中正确显示带有图像的渐变。IE 只显示渐变。我怎样才能让它在 IE 中也能工作？如果有帮助，我愿意使用 jQuery！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:15:14.830

您将需要创建另一个元素，在 =<IE9 中不可能使用多个背景

# r - R：格式化数据框总结

> ID：14791075
> 
> 赞同：8
> 
> 时间：2013-02-09T20:12:10.913
> 
> 标签：r

**摘要：摘要（dataFrame）**调用的控制输出格式。

给定数据框**dataFrame**，**summary(dataFrame)**创建一个输出，该输出仅在**dataFrame**中的列数较少时易于阅读。

问题：

如何一次生成包含 1 个事实的输出？

例如：

```
dataFrame  <- data.frame(x=rnorm(100), y=rnorm(100), z=rnorm(100));
summary(dataFrame); 
```

给出：

```
 x                  y                  z          
 Min.   :-2.13427   Min.   :-2.12077   Min.   :-2.4453  
 1st Qu.:-0.53324   1st Qu.:-0.78915   1st Qu.:-0.4100  
 Median : 0.05675   Median :-0.22321   Median : 0.1356  
 Mean   : 0.09102   Mean   :-0.04939   Mean   : 0.1306  
 3rd Qu.: 0.69685   3rd Qu.: 0.58358   3rd Qu.: 0.7847  
 Max.   : 2.48204   Max.   : 2.65971   Max.   : 2.0504 
```

并且期望的输出是：

```
 x          
Min.   :-2.13427 
1st Qu.:-0.53324 
Median : 0.05675 
Mean   : 0.09102 
3rd Qu.: 0.69685 
Max.   : 2.48204 

      y
Min.   :-2.13427 
1st Qu.:-0.53324 
Median : 0.05675 
Mean   : 0.09102 
3rd Qu.: 0.69685 
Max.   : 2.48204 

      z
Min.   :-2.13427 
1st Qu.:-0.53324 
Median : 0.05675 
Mean   : 0.09102 
3rd Qu.: 0.69685 
Max.   : 2.48204 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-09T20:27:46.360

您可以使用函数`lapply()`将函数`summary()`应用于每一列，然后`cbind()`将数据显示为列。

```
 lapply(dataFrame,function(x) cbind(summary(x)))
$x
            [,1]
Min.    -2.09200
1st Qu. -0.56240
Median   0.07069
Mean    -0.04267
3rd Qu.  0.54060
Max.     2.07800

$y
            [,1]
Min.    -2.55200
1st Qu. -0.62190
Median  -0.07336
Mean    -0.06966
3rd Qu.  0.58540
Max.     2.07100

$z
            [,1]
Min.    -2.80800
1st Qu. -0.52890
Median  -0.03279
Mean    -0.06263
3rd Qu.  0.53730
Max.     2.88500 
```

# java - 使用 ffmpeg、php 函数获取视频时长

> ID：14791082
> 
> 赞同：3
> 
> 时间：2013-02-09T20:12:39.020
> 
> 标签：java, php, ffmpeg

我安装了 FFMpeg 并且我知道它可以正常工作，但是我试图通过 PHP 从 flv 视频中获取持续时间，但是当我使用此代码时：

函数 mbmGetFLVDuration($file){

```
/*  
* Determine video duration with ffmpeg   
* ffmpeg should be installed on your server.  
*/  

//$time = 00:00:00.000 format   
$ffmpeg = "../ffmpeg/ffmpeg";

$time =  exec("$ffmpeg -i $file 2>&1 | grep 'Duration' | cut -d ' ' -f 4 | sed s/,//");   

$duration = explode(":",$time);   
$duration_in_seconds = $duration[0]*3600 + $duration[1]*60+ round($duration[2]);   

return $duration_in_seconds; 
```

}

和：

$duration = mbmGetFLVDuration(' [http://www.videoaddsite.com/videos/intro.flv](http://www.videoaddsite.com/videos/intro.flv) '); 回声$持续时间；

我得到 220 的输出。视频是 3:40。任何人都可以帮助我解决我做错了什么，或者我可以使用其他东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T20:18:23.823

我看不出有什么问题。220 秒是 3:40。

要获得分钟和秒，请使用此转换：

```
<?php
$seconds = 220;
$minutes = $seconds/60;
$real_minutes = floor($minutes);
$real_seconds = round(($minutes-$real_minutes)*60);
?> 
```

`$real_minutes`将是 3，`$real_seconds`将是 40。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-22T12:14:09.360

```
$ffmpeg = "../ffmpeg/ffmpeg";

$time = exec("$ffmpeg -i $file 2>&1 | grep 'Duration' | cut -d ' ' -f 4 | sed s/,//");   

$duration = explode(":", $time);   
$duration_in_seconds = ($duration[0] * 3600) + ($duration[1] * 60) + round($duration[2]);   

return $duration_in_seconds; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-04T10:12:30.583

以下代码适用于我

```
$file='http://techslides.com/demos/sample-videos/small.mp4';

$dur = shell_exec("ffmpeg -i ".$file." 2>&1");
if(preg_match("/: Invalid /", $dur)){
  return false;
}
preg_match("/Duration: (.{2}):(.{2}):(.{2})/", $dur, $duration);
if(!isset($duration[1])){
  return false;
}
$hours = $duration[1];
$minutes = $duration[2];
$seconds = $duration[3];

echo $seconds + ($minutes*60) + ($hours*60*60); 
```

[参考](https://mikedombrowski.com/2017/04/php-get-duration-of-a-media-file-using-ffmpeg/)

# c# - 图像未显示在 ASP.NET 上

> ID：14791083
> 
> 赞同：1
> 
> 时间：2013-02-09T20:12:54.243
> 
> 标签：c#, asp.net

我在文件夹中有一张图片，当我尝试`ImageUrl`从后面的代码设置时，我得到一个看起来分成两半而不是图片的小符号。如果我`ImageUrl`在图像属性中设置它就可以了。我究竟做错了什么？

```
var imagepath = Server.MapPath(@"~/images/candidates/small/image.jpg");
System.Drawing.Image image = System.Drawing.Image.FromFile(imagepath);
int ActualWidth = image.Width;
int ActualHeight = image.Height;
candImage.ImageUrl = imagepath;
candImage.Height = ActualHeight; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T20:14:52.847

`ImageUrl`应该是图像的 URL，因为您可以从浏览器中获取它，而不是它在硬盘驱动器上的位置，这是返回`Server.MapPath`的内容。

你应该使用：

```
candImage.ImageUrl = @"~/images/candidates/small/image.jpg"; 
```

# android - 带有部分/样式列表的列表，例如首选项

> ID：14791085
> 
> 赞同：0
> 
> 时间：2013-02-09T20:13:04.837
> 
> 标签：android, android-layout

我试图实现以下目标：

[http://www.izujar.com/wp-content/uploads/2013/02/carbon.jpg](http://www.izujar.com/wp-content/uploads/2013/02/carbon.jpg)

正如您在右侧的屏幕截图中看到的那样，您可以看到像 PreferenceScreen 这样的窗口，这真的是 PreferenceScreen 还是样式化的？我想放在“部分”中的是自定义视图而不是 PreferenceScreen 视图。是否有任何本机组件来创建它，或者是需要为这个“列表”设置样式的开发人员？我还在开发者 android 门户中看到以下内容：[https://developer.android.com/design/building-blocks/lists.html](https://developer.android.com/design/building-blocks/lists.html)这就是我想要的，但我找不到控件。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T20:16:52.377

> 是否有任何本机组件来创建这个

`ListView`可以处理这个问题，就像`ListView`偏好系统使用的一样。

关键在于您将其`ListView`作为适配器传递给适配器，因为除了其余行之外，适配器还需要处理您的部分标题。[我`MergeAdapter`](https://github.com/commonsguy/cwac-merge)可以帮助解决这个问题，还有其他适配器实现也提供开源部分。

# ruby-on-rails - 无法安装 Intercom.io gem Ubuntu 12.04 LTS

> ID：14791087
> 
> 赞同：0
> 
> 时间：2013-02-09T20:13:10.850
> 
> 标签：ruby-on-rails

我正在尝试将 intercom.io 安装到我的 rails 应用程序中，但是在生成配置文件时我得到了这个：

```
/var/lib/gems/1.8/gems/intercom-rails-0.2.14/lib/intercom-rails/config.rb:13:in `send': undefined method `define_singleton_method' for IntercomRails::Config:Class (NoMethodError)
from /var/lib/gems/1.8/gems/intercom-rails-0.2.14/lib/intercom-rails/config.rb:13:in `config_reader'
from /var/lib/gems/1.8/gems/intercom-rails-0.2.14/lib/intercom-rails/config.rb:8:in `config_accessor'
from /var/lib/gems/1.8/gems/intercom-rails-0.2.14/lib/intercom-rails/config.rb:74
from /var/lib/gems/1.8/gems/intercom-rails-0.2.14/lib/intercom-rails.rb:9:in `require'
from /var/lib/gems/1.8/gems/intercom-rails-0.2.14/lib/intercom-rails.rb:9
from /var/lib/gems/1.8/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `require'
from /var/lib/gems/1.8/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `require'
from /var/lib/gems/1.8/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `each'
from /var/lib/gems/1.8/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `require'
from /var/lib/gems/1.8/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `each'
from /var/lib/gems/1.8/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `require'
from /var/lib/gems/1.8/gems/bundler-1.2.3/lib/bundler.rb:128:in `require'
from /home/ian/SB/config/application.rb:7
from /var/lib/gems/1.8/gems/railties-3.2.11/lib/rails/commands.rb:24:in `require'
from /var/lib/gems/1.8/gems/railties-3.2.11/lib/rails/commands.rb:24
from script/rails:6:in `require'
from script/rails:6 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T00:34:59.043

看起来您使用的是 ruby​​ 1.8，我们的 gem 当前使用 ruby​​ 1.9 功能[Object#define_singleton_method](http://apidock.com/ruby/Object/define_singleton_method)

我们在[intercom/intercom-rails github repo](https://github.com/intercom/intercom-rails/issues/30)上创建了一个问题来跟踪修复此问题。有新版本时我会通知你的。

如果可能，[建议在 ruby​​ >= 1.9.3 上运行 rails 3+](http://rubyonrails.org/download)（这对我们来说至少意味着不从源代码安装）。

谢谢让我们注意到这个。

# mvvm-light - MVVM Light 程序集与 Microsoft.Practices.ServiceLocation 冲突

> ID：14791089
> 
> 赞同：0
> 
> 时间：2013-02-09T20:13:33.417
> 
> 标签：mvvm-light

我遇到了无法使用 ClickOnce 发布我的 WPF 应用程序的问题。

该应用程序使用 Nuget 包 MVVM Light 4.1.26.1、Unity 2.1.505.2、CommonServiceLocator 1.0。

问题是，当我发布时，一切正常，但是当我尝试安装 clickonce 包时出现此错误：

**无法安装或运行应用程序。该应用程序要求首先将程序集 Microsoft.Practices.ServiceLocation 版本 1.0.0.0 安装到全局程序集缓存 (GAC) 中。**

我做了一些挖掘，发现清单中有两个对该程序集的引用，其中一个被标记为我无法摆脱的先决条件：

```
<dependency>
    <dependentAssembly dependencyType="preRequisite" allowDelayedBinding="true">
      <assemblyIdentity name="Microsoft.Practices.ServiceLocation" version="1.0.0.0" publicKeyToken="59D6D24383174AC4" language="neutral" processorArchitecture="msil" />
    </dependentAssembly>
  </dependency> 

<dependency>
    <dependentAssembly dependencyType="install" allowDelayedBinding="true" codebase="Microsoft.Practices.ServiceLocation.dll" size="29760">
      <assemblyIdentity name="Microsoft.Practices.ServiceLocation" version="1.0.0.0" publicKeyToken="31BF3856AD364E35" language="neutral" processorArchitecture="msil" />
      <hash>
        <dsig:Transforms>
          <dsig:Transform Algorithm="urn:schemas-microsoft-com:HashTransforms.Identity" />
        </dsig:Transforms>
        <dsig:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha256" />
        <dsig:DigestValue>eee+a+dQmhpSY/ApLxRipXdEp8UsTaZHXHClBU0Iwyc=</dsig:DigestValue>
      </hash>
    </dependentAssembly>
  </dependency> 
```

我很确定 ClickOnce 的问题在于有两个对具有相同版本的程序集的引用（但请注意不同的公钥令牌）。

我创建了一个非常简单的复制品，如下所示：

1.  创建一个新的 WPF 应用程序
2.  添加 Nuget 包 MVVM Light
3.  添加 Nuget 包 Unity（还添加了名为 CommonServiceLocator 的依赖包）
4.  构建和发布 WPF 应用程序
5.  尝试安装已发布的 MyApp.application clickOnce 包....获取上面详细说明的错误

这是一个复制项目：

[Skydrive 复制项目](http://sdrv.ms/Xj9SDP)

有什么想法我可以克服这个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2019-03-06T23:02:07.587

现在是 2019 年，我遇到了类似的问题，发现这个问题是第一个条目，但发现了另一个（更新的）问题和解决方案，可以让 MVVMLight 和 Microsoft.Practices.ServiceLocation 一起工作。

*Mvvmlight 5.4.1.1*不适用于 CommonServiceLocater *2.0.4*（这是 2019 年 3 月最新的稳定版本），mvvmlight 引导它的方式`ViewModelLocator.cs`

*有两件事起作用：*
要么降级到CommonServiceLocater
1.3.0
Mvvmlight 5.3.0.0

或更改参考

```
using Microsoft.Practices.ServiceLocation; 
```

到

```
using CommonServiceLocator; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T16:17:47.073

是的。MVVMLight ServiceLocation 程序集使用与其他所有公共实现不同的公钥令牌。很长一段时间以来，它使我的生活成为噩梦。我终于不得不删除我所有的 nuget 程序集并暂时返回到公共目录中的文件引用。我正在等待 Laurent 解决这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T20:27:40.283

请再试一次。我刚刚将一个新版本（4.1.27.0）推送到 Nuget，这取决于可用的官方 CommonServiceLocator 包。这应该可以解决您的问题。如果您有更多问题，请务必让我知道。

干杯劳伦特

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-21T14:29:49.687

尽管安装了 MVVMLight nuget 包的 4.1.27 版本，但我也遇到了这个问题。经过数小时的挫折后，我发现这是因为我安装了 MVVMLight 工具包（Visual Studio 2012 的 v.4.1）。卸载它后，我的部署又开始工作了。

只是想我会把它留在这里，以防其他人遇到这种特殊情况。

# javascript - 如何使用 JavaScript 设置通用 CSS 选择器？

> ID：14791094
> 
> 赞同：5
> 
> 时间：2013-02-09T20:14:14.400
> 
> 标签：javascript, css, css-selectors

我经常使用 CSS 通用选择器来重置 HTML 文档中的尺寸：

```
* {
    border: 0;
    margin: 0; 
    padding: 0; 
} 
```

这也可以用 JavaScript 完成吗？

对于普通的 HTML 元素，有该`style`属性。但是如何与通用选择器对话呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T20:46:53.640

您不需要迭代所有元素。您可以向浏览器的 CSS 引擎请求此操作。像这样的东西：

```
;(function(exports) {
  var style = document.querySelector("head")
                      .appendChild(document.createElement("style"));

  var styleSheet = document.styleSheets[document.styleSheets.length - 1];
  styleSheet.insertRule("* {}", 0);

  exports.universal = styleSheet.cssRules[0];
}(window)); 
```

从现在开始，您就有了一个`window.universal`可以用来设置所有元素样式的对象。例如：

```
window.universal.style.border = "1px solid red"; 
```

当然你不需要在运行时创建`<style>`标签。您也可以始终使用纯 HTML 格式。

您可以运行以下代码段对其进行测试：

```
;(function(exports) {
  var style = document.querySelector("head")
                      .appendChild(document.createElement("style"));

  var styleSheet = document.styleSheets[document.styleSheets.length - 1];
  styleSheet.insertRule("* {}", 0);

  exports.universal = styleSheet.cssRules[0];
}(window));

console.log("universal" in window); // true

window.universal.style.border = "1px solid red";
```

```
<div>
  Hello
  <span>World</span>
</div>
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-09T20:15:34.383

`getElementsByTagName("*")`将从 DOM 返回所有元素。然后您可以为集合中的每个元素设置样式：

```
var allElements = document.getElementsByTagName("*");
for (var i = 0, len = allElements.length; i < len; i++) {
    var element = allElements[i];
    // element.style.border = ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T20:17:36.333

在原始 javascript 中，您可以这样做：

```
document.getElementsByTagName('*') 
```

但我不建议使用 js 将 css 添加到所有元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T20:25:56.407

感谢**Vision**的解决方案！我只记得你可以用新的 JavaScript 查询选择器 API 做同样的事情：

```
var allElements = document.querySelectorAll('*');

for (var i = 0; i < allElements.length; i++) {
  var element = allElements[i];        
  element.style.border = '0px';
  element.style.margin = '0px';
  element.style.padding = '0px';
} 
```

# kinect - 深度校准目标

> ID：14791100
> 
> 赞同：1
> 
> 时间：2013-02-09T20:14:39.437
> 
> 标签：kinect, camera-calibration, kinect-sdk

我正在尝试尽可能多地收集有关 Kinect 相机深度校准的资源。

对我来说不是那么微不足道的一个问题是：

Microsoft Kinect 相机应使用哪种校准目标。

我正在考虑使用一种基于棋盘的模式，但不确定深度传感器是否能够检测到它。我对吗？

也许高精度 3-D 物体对深度相机的校准更有利？

非常感谢！

PS 请考虑我将仅在 Kinect 上使用深度传感器而不是 RGB 传感器这一事实，正如我所提到的。

# perl - perl 在 binmode 中以不同的偏移量查找和删除

> ID：14791108
> 
> 赞同：2
> 
> 时间：2013-02-09T20:15:08.320
> 
> 标签：perl, seek, vary

这是我正在写的剧本。

```
#usr/bin/perl
use warnings;

open(my $infile, '<', "./file1.bin") or die "Cannot open file1.bin: $!";
binmode($infile);
open(my $outfile, '>', "./extracted data without 00's.bin") or die "Cannot create extracted data without 00's.bin: $!";
binmode($outfile);

local $/; $infile = <STDIN>;
   print substr($infile, 0, 0x840, '');
   $infile =~ s/\0{16}//;
   print $outfile; 
```

我正在用 perl 加载一个二进制文件。我已经能够在某些偏移量处寻找和修补，但我想做的是，现在能够找到“ `00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00`”的任何实例（16 个字节？）并将其从文件中删除，但不少于 16 个字节。任何低于我想离开的东西。在某些文件中，00 开始的偏移量将位于不同的偏移量，但如果我的想法正确，如果我可以搜索`00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00`并删除它的任何实例，那么 00 的偏移量就无关紧要了。我会首先从特定的偏移量中提取数据，然后搜索文件并从中删除 00。我已经可以提取我需要的特定偏移量，我只需要打开提取的文件并刮掉`00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00`

```
EF 39 77 5B 14 9D E9 1E 94 A9 97 F2 6D E3 68 05
6F 7B 77 BB C4 99 67 B5 C9 71 12 30 9D ED 31 B6 
AB 1F 81 66 E1 DD 29 4E 71 8D 54 F5 6C C8 86 0D 
5B 72 AF A8 1F 26 DD 05 AF 78 13 EF A5 E0 76 BB 
8A 59 9B 20 C5 58 95 7C E0 DB 44 6A EC 7E D0 10 
09 42 B1 12 65 80 B3 EC 58 1A 2F 92 B9 32 D9 07 
96 DE 32 51 4B 5F 3B 50 9A D1 09 37 F4 6D 7C 01 
01 4A A4 24 04 DC 83 08 17 CB 34 2C E5 87 26 C1 
35 38 F4 C4 E4 78 FE FC A2 BE 99 48 C9 CA 69 90 
33 87 09 A8 27 BA 91 FC 4B 77 FA AB F5 1E 4E C0        I want to leave everything from
F2 78 6E 31 7D 16 3B 53 04 8A C1 A8 4B 70 39 22 <----- here up
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 <----- I want to prune everything
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00        from here on
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00<---- this IS the end of the file, and
                                                     just need to prune these few rows
                                                     of 00's 
```

假设`F2 78 6E`上面示例中的“”位于偏移量，`0x45000` **但**在另一个文件中，00 00 将从不同的偏移量开始，我该如何对其进行编码以便`00 00's`修剪。在我打开的任何文件中？如果我需要更具体，请问。似乎我会一直窥视文件，直到我击中一个长的 00 00 字符串，然后修剪任何剩余的行。这有意义吗？我要做的就是在文件中搜索任何实例`00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00`并删除/修剪/截断它。我想保存除 00 年代以外的一切

**编辑＃2** 这样做了：

```
open($infile, '<', './file1') or die "cannot open file1: $!";
binmode $infile;
open($outfile, '>', './file2') or die "cannot open file2: $!";
binmode $outfile;

local $/; $file = <$infile>;
$file =~ s/\0{16}//g;
print $outfile $file;

close ($infile);
close ($outfile); 
```

**感谢您`ikegami`的所有帮助和耐心:)**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T20:20:48.640

没有从文件中删除之类的东西。你必须要么

1.  复制没有不需要的位的文件，或
2.  `read`文件的其余部分，`seek`返回，`print`在不需要的位上，然后`truncate`是文件。

我选择了选项 1。

```
$ perl -e'
   binmode STDIN;
   binmode STDOUT;
   local $/; $file = <STDIN>;
   $file =~ s/\0{16}//;
   print $file;
' <file.in >file.out 
```

我正在将整个文件加载到内存中。任何一个选项都可以分块完成，但它会使事情变得复杂，因为你的 NUL 可以跨越两个块。

* * *

在措辞不佳的更新中，您似乎要求避免更改前 0x840 字节。两种解决方案：

```
$ perl -e'
   binmode STDIN;
   binmode STDOUT;
   local $/; $file = <STDIN>;
   substr($file, 0x840) =~ s/\0{16}//;
   print $file;
' <file.in >file.out

$ perl -e'
   binmode STDIN;
   binmode STDOUT;
   local $/; $file = <STDIN>;
   print substr($file, 0, 0x840, '');
   $file =~ s/\0{16}//;
   print $file;
' <file.in >file.out 
```

# javascript - 停止变量在画布中递减

> ID：14791110
> 
> 赞同：0
> 
> 时间：2013-02-09T20:15:19.223
> 
> 标签：javascript, variables, canvas

我正在制作一个游戏，我有一个基于时间的简单积分系统，其中日期存储在一个称为`start`关卡开始时调用的变量中（我有几个关卡），然后当关卡结束时，另一个日期存储在一个名为 的变量`stop`。然后在一个名为 的变量中计算经过的时间`elapsed`。最后，这些点显示在名为 的最终变量中`points`。起始值为 300000，每毫秒减少一次，5 分钟后达到零（这是一个短水平）。我唯一的问题是，一旦关卡完成并显示积分，积分就会不断减少。我以前也遇到过类似的问题，但我似乎总是找到一种解决方法，因为价值通常很小。相关代码如下：
`start = new Date().getTime();
stop = new Date().getTime();
elapsed = stop - start;
points = 300000 - elapsed;`
所有变量都是在全局之前声明的。在某种程度上，这是意料之中的，因为该`points`变量每秒更新 1000 次。那么，有什么办法可以阻止它减少呢？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:21:42.087

只需在分配新位置之前检查值。

您应该使用`global` `var`using`window`前缀：`window.points`

```
start = new Date().getTime();
stop = new Date().getTime();
var elapsed = stop - start;
if(elapsed < 300000)
    points = 300000 - elapsed; 
```

# cordova - PhoneGap 2.4.0，Windows Phone 8，更改 index.html 的位置

> ID：14791111
> 
> 赞同：1
> 
> 时间：2013-02-09T20:15:22.903
> 
> 标签：cordova, indexing, location, windows-phone-8, rename

快速提问（希望如此）。如何在“Windows Phone 8”应用程序中更改 index.html 的位置 (www/index.html)？我正在使用 PhoneGap 2.4.0。

第一次使用 Windows Phone 8 应用程序，如果答案很明显，我很抱歉 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T18:58:39.577

在 MainPage.cs 中编辑 MainPage 构造函数

```
 public MainPage()
    {
        InitializeComponent();
        this.CordovaView.StartPageUri = new Uri("/www/html/initializeconnection.html", UriKind.Relative);
        this.CordovaView.Loaded += CordovaView_Loaded;
    } 
```

# java - 使用现有的mongo数据库快速开发java web-app

> ID：14791114
> 
> 赞同：1
> 
> 时间：2013-02-09T20:15:36.210
> 
> 标签：java, spring, mongodb, spring-roo

想要使用以下方法快速实现小网络应用程序：

*   春季MVC
*   前端的 GWT
*   休眠
*   马文

（发现 Spring Roo 提供了大部分需要的架构）

问题是，我已经退出 Mongo 数据库。

有什么方法可以从现有的 mongo 数据库创建数据模式（找到关系数据库的逆向工程）？或者我必须根据 mongo db 手动定义实体？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:35:08.137

我们曾经尝试为基于现有 MongoDB 数据库的自动生成后端寻求一种快速原型设计方法。该代码是开源的，可在[http://sourceforge.net/projects/springmorphia/获得](http://sourceforge.net/projects/springmorphia/)

免责声明：

*   这是学生的学士论文，因此您可能需要查看代码。
*   我们从未将它用于预期目的，因为我们对 Spring Roo 并不太感兴趣（特别是 API 的稳定性、我们遇到的错误数量……）。
*   然而，这个项目已经有一年多了，所以情况可能会有所改善。这也意味着 Spring Roo 版本已经严重过时。

如果您想朝那个方向前进，这可能是一个很好的起点。

如果您不打算使用快速原型制作方法，我仍然会重建一次数据库并导入现有数据。仅当您想基于不断发展的数据库不断生成代码时，恕我直言。

# android - 查询 MediaStore.Images.Media ，如何同时查询 EXTERNAL_CONTENT_URI 和 INTERNAL_CONTENT_URI？

> ID：14791115
> 
> 赞同：2
> 
> 时间：2013-02-09T20:15:38.457
> 
> 标签：android, android-image, mediastore

首先感谢您的帮助。

我认为对于不熟悉查询内容提供程序的人来说，这应该是一个相当微不足道的问题。

我需要查询**MediaStore.Images.Media**以获取设备上的所有图像，包括内部存储和 sd 卡上的图像。

这是我想到的查询：

```
String[] proj = { MediaStore.Images.Media.DATA };

actualimagecursor = 
managedQuery(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, proj,null, null, null); 
```

关键是我想同时查询**EXTERNAL_CONTENT_URI**和INTERNAL_CONTENT_URI。

是否可以使用单个查询来执行它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-09-10T03:54:10.507

抱歉，这太旧了，无法提供帮助，但您可以使用 MergeCursor 组合这两个查询。

```
Cursor[] cursors = new Cursor[2];
cursors[0] = mActivity.getContentResolver().query(
    MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
    new String[]{
            MediaStore.Images.Media._ID,
            MediaStore.Images.Media.DATA,
            MediaStore.Images.Media.ORIENTATION,
            MediaStore.Images.Media.BUCKET_DISPLAY_NAME,
            MediaStore.Images.Media.BUCKET_ID,
            MediaStore.Images.Media.MIME_TYPE ,
    },
    null,
    null,
    MediaStore.Images.ImageColumns.DATE_TAKEN + " DESC"
);
cursors[1] = mActivity.getContentResolver().query(
    MediaStore.Images.Media.INTERNAL_CONTENT_URI,
       new String[]{
            MediaStore.Images.Media._ID,
            MediaStore.Images.Media.DATA,
            MediaStore.Images.Media.ORIENTATION,
            MediaStore.Images.Media.BUCKET_DISPLAY_NAME,
            MediaStore.Images.Media.BUCKET_ID,
            MediaStore.Images.Media.MIME_TYPE
       },
       null,
       null,
       MediaStore.Images.ImageColumns.DATE_TAKEN + " DESC"
);
Cursor cursor = new MergeCursor(cursors); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T20:47:59.053

由于查询是在特定位置（内部或外部）执行的，因此无法通过单个查询检索两个结果。您需要实例化两个 dirretent `Cursors`。

# java - Hibernate Bean Validation 在类路径中不可用

> ID：14791118
> 
> 赞同：3
> 
> 时间：2013-02-09T20:15:53.580
> 
> 标签：java, hibernate, classpath, bean-validation

我今天决定尝试 Hibernate，它看起来很有希望，尽管设置可能更容易。在为前一百万个左右的配置错误找到解决方案后，我现在陷入了这个问题：

```
Exception in thread "main" javax.persistence.PersistenceException: [PersistenceUnit: manager1] Unable to build EntityManagerFactory
    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:915)
(...)
Caused by: org.hibernate.HibernateException: Bean Validation not available in the class path but required in javax.persistence.validation.mode
    at org.hibernate.cfg.beanvalidation.BeanValidationIntegrator.applyHibernateListeners(BeanValidationIntegrator.java:281)
    at org.hibernate.cfg.beanvalidation.BeanValidationIntegrator.integrate(BeanValidationIntegrator.java:134)
    at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:303)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1750)
    at org.hibernate.ejb.EntityManagerFactoryImpl.<init>(EntityManagerFactoryImpl.java:94)
    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:905)
    ... 5 more 
```

持久性.xml：

```
<?xml version='1.0' encoding='utf-8' ?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
             version="2.0">
   <persistence-unit name="manager1" transaction-type="JTA">
      <provider>org.hibernate.ejb.HibernatePersistence</provider>
      <class>net.zomis.hibernate.Game</class>
      <class>net.zomis.hibernate.TestFields</class>
      <shared-cache-mode>ENABLE_SELECTIVE</shared-cache-mode>
      <validation-mode>CALLBACK</validation-mode>
      <properties>
          <property name="javax.persistence.validation.mode" value="NONE" />  
         <property name="hibernate.dialect" value="org.hibernate.dialect.HSQLDialect"/>
         <property name="hibernate.hbm2ddl.auto" value="validate"/>
      </properties>
   </persistence-unit>
</persistence> 
```

（据我所知）的相关部分`hibernate.cfg.xml`

```
<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE hibernate-configuration PUBLIC
"-//Hibernate/Hibernate Configuration DTD//EN"
"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
    <session-factory>
        (...)
        <property name="hbm2ddl.auto" >validate</property>
        <mapping class="net.zomis.hibernate.Game" />
        <mapping class="net.zomis.hibernate.TestFields" />
    </session-factory>
</hibernate-configuration> 
```

我已尝试将[其](https://repository.jboss.org/nexus/content/groups/public-jboss/org/hibernate/hibernate-validator-annotation-processor/4.3.1.Final/hibernate-validator-annotation-processor-4.3.1.Final.jar)添加到构建路径中而没有任何更改。我已经用谷歌搜索了`Bean Validation not available in the class path but required in javax.persistence.validation.mode`，也只是`Bean Validation not available in the class path`. 我找到了源代码，但这对我没有多大帮助。

我还尝试从 xml 配置文件中删除属性，但没有任何运气。

我**不**使用 Maven。我只是使用 Eclipse 并直接从 Eclipse 构建和运行项目。

显而易见的问题是：我该如何解决这个问题？我是否需要在我错过的构建路径中添加一个 jar？（在那种情况下是哪一个？）还有：为什么需要它？我可以更改某些内容以使其不再需要吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-09T21:03:35.820

你需要在你的类路径中有[validation-api](http://mvnrepository.com/artifact/javax.validation/validation-api/1.0.0.GA)（你可以使用一个下载JAR 链接，因为你不使用maven）。

Hibernate 在类路径中搜索 javax.validation.Validation 类。如果它没有找到它，它会抛出`Bean Validation not available in the class path but required in javax.persistence.validation.mode`错误。

*   如果您不使用 maven，则需要自己构建类路径，并且很容易错过 jar。仅使用 maven 引导您的项目并确保您拥有所有 jar 文件可能是值得的。
*   如果您使用的是 maven，validation-api 将作为 hibernate-validator 的传递依赖项引入。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-11T09:39:24.373

您需要 Hibernate Validator 工件：

```
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-validator</artifactId>
    <version>4.3.1.Final</version>
</dependency> 
```

这也将包括 Bean Validation API，在这种情况下，这确实也是一个要求。

如果您没有使用任何 Bean 验证约束（例如 @NotNull、@Before、@Pattern 等），您也可以删除

```
<validation-mode>CALLBACK</validation-mode> 
```

或将其设置为 NONE。Hibernate 使用不需要 Bean Validation，它只是 JPA 规范中定义的附加组件。如果 Bean Validation 在基于类路径生命周期的验证（在更新前、预持久等时验证实体）会自动启用（另请参见[http://docs.jboss.org/hibernate/stable/validator/reference/ en-US/html_single/#d0e3096](http://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/#d0e3096)，当然还有 JPA 2 规范）。

另一方面，如果您在类路径上没有 Bean Validation，但通过*persistence.xml*中的配置选项明确要求它，您会得到您描述的错误。

# python - 不能将序列乘以“列表”类型的非整数

> ID：14791119
> 
> 赞同：6
> 
> 时间：2013-02-09T20:15:58.940
> 
> 标签：python

```
def evalPolynomial(coeffs,x):
        return sum([n for n in coeffs] * [x**(m-1)for m in range(len(coeffs),0,-1)]) 
```

TypeError：不能将序列乘以“列表”类型的非整数

不确定是什么导致了错误？当我分别打印每个语句时，它们每个都会给我一个列表，但是当我尝试将它们相乘时它不起作用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-09T20:23:23.267

Python `list`s 只能乘以一个整数，在这种情况下 s 的元素`list`会重复：

```
>>> [1,2,3] * 3
[1, 2, 3, 1, 2, 3, 1, 2, 3] 
```

如果您想要矢量运算，请`numpy.ndarray`改用：

```
>>> import numpy as np
>>> ar = np.array([1,2,3])
>>> ar * 3
array([3, 6, 9]) 
```

特别是卷积有一个numpy函数（即多项式乘法）：

```
>>> a = np.array([1,2,3]) # 1 + 2x + 3x^2
>>> b = np.array([4,5,6]) # 4 + 5x + 6x^2
>>> np.convolve(a, b)     # (1 + 2x + 3x^2) * (4 + 5x + 6x^2)
array([ 4, 13, 28, 27, 18]) # 4 + 13x + 28x^2 + 27x^3 + 18x^4 
```

如果您想评估多项式，则可以使用`numpy.polyval`执行此操作的函数。

请记住，使用 numpy 会限制整数的大小，因此如果系数太大以至于溢出，您可能会得到错误的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T20:24:48.950

表达式`[n for n in coeffs]`是一个`list`, 的整数。
列表确实支持乘以整数，但这意味着“制作一个包含 n 个起始列表副本的列表”；在这个数学环境中，这不是你想要的。

我建议您查看`numpy`（或`scipy`很大程度上是 的超集`numpy`）包来帮助解决这个问题。它具有[`polyval`](http://docs.scipy.org/doc/numpy/reference/routines.poly.html)准确评估您想要的功能，还提供基于类的表示`polynomial`。一般来说，要在 Python 中进行数值计算，您应该查看这些包。

但是，如果您想自己动手，则需要在列表理解中进行数学运算，一种方法是：

```
return sum( [ n*x**(i-1) for (n,i) in zip( coeffs, xrange(len(coeffs),0,-1)) ] ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T20:22:31.703

您正在尝试将多个两个列表放在一起。这不是 python 中的有效操作。

如果您想将两个列表中的每个相应元素相乘，您可以使用如下内容：

```
def evalPolynomial(coeffs,x):
        return sum(x * y for x, y in zip(coeffs, (x**(m-1)for m in range(len(coeffs),0,-1)))) 
```

# java - HTTPClient 实例是否不打算被重用？

> ID：14791129
> 
> 赞同：1
> 
> 时间：2013-02-09T20:16:37.053
> 
> 标签：java, web-services

为每个请求重复使用单个 HTTPClient 实例是一种不好的做法吗？我`request`从 yahoo 获取数据`webservice`，现在在另一个页面中我`webservice`打电话给 google。

我可以在这两个不同的页面中使用相同的 HTTPClient 实例，还是应该为两者创建新的 HTTPClient 对象？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T20:25:12.140

您绝对应该重用它们并将其`HttpClient`视为单例。在整个应用程序中重用单个实例可以利用保持活动连接并在调用之间保留 cookie。

引用 3.x 的[官方文档](http://hc.apache.org/httpclient-legacy/performance.html#Reuse_of_HttpClient_instance)：

> 通常建议每个通信组件甚至每个应用程序都有一个 HttpClient 实例。但是，如果应用程序很少使用 HttpClient，并且不保证在内存中保留一个空闲的 HttpClient 实例，那么强烈建议在释放 HttpClient 实例之前显式关闭多线程连接管理器。这将确保正确关闭连接池中的所有 HTTP 连接。

这同样适用于 4.x，只要确保使用[`PoolingClientConnectionManager`](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/conn/PoolingClientConnectionManager.html).

# c++ - 没有运算符 >> 匹配这些操作数

> ID：14791132
> 
> 赞同：2
> 
> 时间：2013-02-09T20:16:47.153
> 
> 标签：c++, iostream, istream

我一直在尝试使`>>`运算符超载。我有一个有两个私有变量的类：

```
Class Complex
{
 private:
    double real;
    double imaginary;
}; 
```

此外，我还有一个重载`>>`运算符的友元函数：

```
friend istream & operator>>(istream &is, Complex &c) 
```

在函数的实现中，我尝试了很多方法来写入对象的变量，`c`但我一直收到错误`no operator >> matches these operands`

我环顾四周，读到我需要写入一个`reference`变量，所以我尝试了以下方法：

```
istream & operator>>(istream &is, Complex &c)
{
using std::cout;
double &r = c.real;
cout << "real: "  << is >> r;
    return is;
} 
```

然而，这仍然给了我同样的错误。当我尝试`is >> c.real`但没有工作时，我有点困惑。

在类似的 SO question 中的一个答案中，有人建议写入局部变量并设置对象变量，例如：

```
double d;
cin >> d;
setReal(d); 
```

我试图找到一种更简单的方法来实现这一点，而不是使用方法或将变量设置为本地变量。

解决方案可能很简单，但我真的只是 C++ 的初学者，所以请放轻松：P。

测试用例：

```
using std::cin;
Complex c;
cin >> c; 
```

确切的错误信息：

```
Error   1   error C2678: binary '>>' : no operator found which takes a left-hand operand of type 'std::basic_ostream<_Elem,_Traits>' (or there is no acceptable conversion) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T20:35:13.377

错误在这一行：

```
cout << "real: "  << is >> r; 
```

这被解释为

```
((cout << "real: ") << is) >> r 
```

这里的问题是你不能有这样一条线，你可以从输出切换`cout`到`is`. 更好的方法是

```
cout << "real: ";
is >> r; 
```

也就是说，这是一个*非常糟糕的主意*。您不应该`operator >>`显示提示，因为这意味着如果您想从文件中读取您的类型的对象，每次您这样做时都会`real`在屏幕上显示提示“”。您应该`operator >>`刚刚阅读了该表示，并在阅读之前明确提示您是否想要这样做。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T20:35:31.470

错误在这一行：

```
cout << "real: "  << is >> r; 
```

您的意思是在最后一个上使用 << 而不是 >> 吗？由于您使用了 >>，它试图将“is”写入**cout**，但没有运算符 << 的重载，它需要一个 basic_ostream 和一个 basic_istream。

# tcl - 如何在 tcl 中调用函数的上下文中对字符串执行扩展

> ID：14791134
> 
> 赞同：1
> 
> 时间：2013-02-09T20:16:56.047
> 
> 标签：tcl

如何`expand`在下面的脚本中实现（在 tcl 中正常扩展命令和变量），我希望它打印出来：

```
'
    hello {
        $b
    }
    {tcl world}
' 
```

这就是我想象的脚本的样子：

```
proc clever_func {script} {
    set script [uplevel 1 expand [list $script]]
    puts "'$script'"
}

proc isolated_client_function {} {
    set a hello
    set b difficult
    set c tcl
    set d world

    clever_func {
        $a {
            $b
        }
        [list $c $d]
    }
}

isolated_client_function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:39:54.140

示例不足以替代规范，但似乎没有内置的 TCL 工具可以满足您的需求。可以对单个*命令尾部*执行替换（通过添加`list`到命令并将`eval`其置于您想要的任何级别），但不能用于具有两个“命令”的伪脚本。（也可以使用 进行字符串插值`subst`，但您可能已经知道为什么它不是您想要的：它也会扩展`$b`）。

我看到两种可能性来获得你想要的东西：

1.  使用 标记您的输入[`sugar::scriptToList`](http://wiki.tcl.tk/11158)，然后在标记列表中手动执行替换，然后使用 将结果转换回文本形式`sugar::listToScript`。宏处理器的这些功能`sugar`旨在让您在保留格式、注释和布局的同时，在语义上修改脚本。

2.  将您的输入分解为单独的“命令”：首先在每个换行符和分号处拆分，然后用于`info complete`收集与完整“命令”相对应的部分（IIRC 会有一些带有反斜杠换行符延续的极端情况：当心）。在每个完整的“命令”上使用前置的技巧，`"list "`在必要的上下文 ( `uplevel`) 中评估结果。因此，对于每个命令，您将获得一个*列表*，其中在适当的时候已经执行了替换。您将丢失每个“命令”内部格式的细微差别（例如分隔单词的空格数和空格类型），并且您将丢失原始命令分隔符，除非您自己注意记住它们。如果目标是获得一种“`eval`稍后在其他一些情况下使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T01:39:54.580

该[`subst`](http://tcl.tk/man/tcl8.5/TclCmd/subst.htm)命令将带你去那里的大部分地方。

```
proc expand {script} {
    uplevel 1 [list subst $script]
}

set a hello
set b difficult
set c tcl
set d world

expand {
    $a {
        $b
    }
    [list $c $d]
} 
```

输出

```
 hello {
        difficult
    }
    tcl world 
```

我不确定如何防止`$b`被替换。您可能必须自己解析脚本。

如果您希望最后一部分有您演示的引用，您需要另一个级别的列表

```
expand {
    $a {
        $b
    }
    [list [list $c $d]]
} 
```

输出

```
 hello {
        difficult
    }
    {tcl world} 
```

# php - 解析 URL 以提取 ID

> ID：14791137
> 
> 赞同：0
> 
> 时间：2013-02-09T20:17:07.110
> 
> 标签：php

我目前正在使用我的功能提取 youtube 视频 ID `getYoutubeId`。该函数通常会解析链接以找到其各自的 ID。但是我无法为输入文本框分配一个 php 变量，然后将其传递给`url`函数并最终提取 ID。将 url 粘贴到文本框中时，会回显视频 ID 或什么都没有。这是一个示例：[样机站点](http://webprolearner2346.zxq.net/testYTvid/test.php)

```
 <input type="text" name="youtube" value="<? $sYoutubeUrl ?>">
    <input type="submit" value="Parsen">

    <?

    function getYoutubeId($sYoutubeUrl) {

        # set to zero
        $youtube_id = "";
        $sYoutubeUrl = trim($sYoutubeUrl);

        # the User entered only the eleven chars long id, Case 1
        if(strlen($sYoutubeUrl) === 11) {
            $youtube_id = $sYoutubeUrl;
            return $sYoutubeUrl;
        }

        # the User entered a Url
        else {

            # try to get all Cases
            if (preg_match('~(?:youtube\.com/(?:user/.+/|(?:v|e(?:mbed)?)/|.*[?&]v=)|youtu\.be/)([^"&?/ ]{11})~i', $sYoutubeUrl, $match)) {
                $youtube_id = $match[1];
                return $youtube_id;
            }
            # try to get some other channel codes, and fallback extractor
            elseif(preg_match('~http://www.youtube.com/v/([A-Za-z0-9\-_]+).+?|embed\/([0-9A-Za-z-_]{11})|watch\?v\=([0-9A-Za-z-_]{11})|#.*/([0-9A-Za-z-_]{11})~si', $sYoutubeUrl, $match)) {

                for ($i=1; $i<=4; $i++) {
                    if (strlen($match[$i])==11) {
                        $youtube_id = $match[$i];
                        break;
                    }
                }
                return $youtube_id;
            }
            else {
                $youtube_id = "No valid YoutubeId extracted";
                return $youtube_id;
            }
        }
    }

   echo (getYoutubeId($sYoutubeUrl));

    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:23:45.603

您需要将输入标签放在表单中，如下所示：

```
<form action="" method="POST">
  <input type="text" name="youtube" value="" />
  <input type="submit" value="Parsen" />
</form> 
```

然后检查表单是否已提交并显示您的信息：

```
?>

if(isset($_POST['youtube'])){

  // include that function here

  print 'Result: ' . getYoutubeId($_POST['youtube']);
} 
```

考虑使用[`parse_url()`](http://php.net/manual/en/function.parse-url.php)从 URL 获取视频 ID，而不是正则表达式。

# ocaml - 结合折叠和过滤

> ID：14791144
> 
> 赞同：1
> 
> 时间：2013-02-09T20:17:43.823
> 
> 标签：ocaml

所以我正在为 fold 编写一个组合函数，让它执行过滤。

```
let filter_combine (pred: 'a -> bool) : a' list -> 'a list -> 'a list =
fun (x: 'a) (y: 'a list) -> x :: (filter pred y) 
```

我没有任何编译问题，但我的两个测试用例中有一个失败了。我的实施有什么问题？

这是失败的测试用例......

```
[-1; 1] = fold (filter_combine (fun (x: int) -> (abs x) mod 2 <> 0)) [] [-2; -1; 0; 1; 2] 
```

这是一个有效的...

```
[-2; 2] = fold (filter_combine (fun (x: int) -> (abs x) > 1)) [] [-2; -1; 0; 1; 2] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:46:25.423

我在理解这个问题时遇到了一些麻烦。我认为您的意思是您要编写一个函数，该函数接受一个谓词并返回一个适合与折叠一起使用的函数，以便结果将根据谓词进行过滤。

问题的一些问题：

*   没有名为`fold`.

*   如果您应该实现过滤，那么`filter`在您的实现中使用它似乎很奇怪。

如果我假设你正在使用`fold_right`，那么在我看来你想要返回一个 type 的函数`a -> a list -> a list`。它想看一件事来决定做什么，而不是看一整套事情。由于您说您没有收到编译错误，这表明您的命名`fold`函数无法按我的预期工作。如果您展示了`fold`实际的工作原理，它可能会有所帮助。

# salesforce - 尝试在 Salesforce 的页面布局中插入自定义链接时出错

> ID：14791150
> 
> 赞同：0
> 
> 时间：2013-02-09T20:18:21.810
> 
> 标签：salesforce, force.com

我刚刚创建了一个指向 salesforce 报告的自定义链接

```
/xxxxxx/?pv0={!Account.Id} 
```

但是当我在帐户页面布局上插入此自定义链接并单击该链接时，它会显示错误

```
URL No Longer Exists 
```

我什至尝试预览自定义链接，但它也显示相同的错误。任何人都可以指出什么可能是错的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:52:42.883

我认为您不需要最后一个“/” :)

试试看`/xxxxxx?pv0={!Account.Id}`？

# php - 如何在 PHPUnit 的 Webdriver 框架中使用自定义的 firefox 配置文件？

> ID：14791156
> 
> 赞同：2
> 
> 时间：2013-02-09T20:19:33.507
> 
> 标签：php, firefox, phpunit, selenium-webdriver

我知道使用 selenium RC，我曾经通过命令行运算符... -firefoxProfileTemplate 并且可以。现在使用 Selenium2 (Webdriver)，这似乎不再起作用了。

由于我正在使用 PHPUnit 进行其他测试，因此我想继续使用它。任何人都知道如何为它定义一个自定义的 Firefox 配置文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T16:42:18.507

这并没有明确回答上面的问题，但是，它确实有助于解决眼前的问题，因为我的 selenium 设置只会使用 1 个 Firefox 实例，而不会尝试即时加载它们。

话虽如此，这将对那里的大多数用户有所帮助，因此我将其作为“答案”放在这里，而不是选择它作为正确答案的原因。

我[在 github 上的 phpunit-selenium 问题队列中](https://github.com/sebastianbergmann/phpunit-selenium/issues/207)找到了答案。谢谢埃马克。

只需使用命令行选项加载您的 selenium 服务器

`-Dwebdriver.firefox.profile=PROFILE_NAME`

**注意：** PROFILE_NAME 是位于 Firefox 应用程序数据目录中的 profiles.ini 中的机器名称。这不是一条路径或什么不是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-10T14:42:53.637

假设您将**php-webdriver**与**FirefoxDriver**一起使用。并且您想**使用特定的 Firefox 配置文件启动 FirefoxDriver**。（用于在每次 selenium 运行时保持登录并保存您的登录名和 cookie）

首先，找到包含您的 Firefox 配置文件数据的目录。对我来说，在 Win 10 上它是 C:/Users/MyWinProfile/AppData/Roaming/Mozilla/Firefox/Profiles/pivdau5sa.selen

之后使用这样的代码打开firefox php-webdriver：

```
namespace Facebook\WebDriver;
use Facebook\WebDriver\Remote\DesiredCapabilities;
use Facebook\WebDriver\Remote\RemoteWebDriver;
use Facebook\WebDriver\Firefox\FirefoxDriver;
use Facebook\WebDriver\Firefox\FirefoxOptions;
require_once('vendor/autoload.php');

$firefoxOptions = new FirefoxOptions();
$firefoxOptions->addArguments(['-profile', 'C:/Users/<MyUserName>/AppData/Roaming/Mozilla/Firefox/Profiles/pivdau5sa.selen']);
$capabilities = DesiredCapabilities::firefox();
$capabilities->setCapability(FirefoxOptions::CAPABILITY, $firefoxOptions);
putenv('WEBDRIVER_FIREFOX_DRIVER=C:\PHP\geckodriver.exe'); // you may dont need this line

$driver = FirefoxDriver::start($capabilities); 
```

# javascript - Javascript SetTimeout 和循环

> ID：14791158
> 
> 赞同：4
> 
> 时间：2013-02-09T20:19:39.990
> 
> 标签：javascript, settimeout

专家。Javascript 没有产生所需的延迟效果。
从其他问题中，我了解到，问题在于 settimeout 和我使用它的方式。但我仍然无法理解 Settimeout 是如何工作的。所以我把代码放在这里。由于知识目的，只需要使用 Javascript。
实际上，我正在尝试清除我**对此的概念，即 javascript 中的闭包**。它们是 Javascript 的一种扭曲的东西吗？

```
var objImg = new Object();
var h;
var w;

var no = 100;
while (no != 500) {
    setTimeout(function () {
        size(no, no);
    }, 2000);

    /* it's get executed once, instead of repeating with while loop
    Does it leave loop in mid? I get image with 500px height and
    width, but effect is not acheived.
    */

    no = no + 50;
}

function size(h, w) {
    var objImg = document.getElementsByName('ford').item(0);
    objImg.style.height = h + 'px';
    objImg.style.width = w + 'px';
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T20:22:24.570

你有两个问题：

*   `no`调用回调时将具有循环结束的值
*   您正在从同一时间（即循环运行的时间）开始对所有超时 2000 毫秒进行编程。

这是您可以解决的方法：

```
var t = 0
while (no != 500) {
   (function(no) {
      t += 2000;
      setTimeout(function() { size(no,no);} ,t);
   })(no);
   no  = no+50; // could be written no += 50
} 
```

立即执行的函数创建了一个保护`no`.

* * *

关于`(function(no) {`：

变量的范围是

*   全局范围
*   一个函数

上面的代码可以写成

```
var t = 0
while (no != 500) {
   (function(no2) {
      t += 2000;
      setTimeout(function() { size(no2,no2);} ,t);
   })(no);
   no += 50;
} 
```

这里可能更清楚我们有两个变量：

*   `no`，其值随着每次迭代而变化，并且在调用超时时为 500
*   `no2`, 实际上`no2`每次调用内部匿名函数都会有一个变量

每次调用内部匿名函数时，它都会声明一个新`no2`变量，其值是`no`在调用时（迭代期间）。因此，此变量`no2`受到保护，并由给定的回调使用`setTimeout`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T20:37:25.870

为什么不直接使用 setInterval() 呢？

```
var objImg = new Object();
var h;
var w;

var no = 100;
var myInterval = window.setInterval(function() {
    size(no, no);
    no = no + 50;
    if (no >= 500) clearInterval(myInterval);
}, 2000);

function size(h, w) {
    var objImg = document.getElementsByName('ford').item(0);
    objImg.style.height = h + 'px';
    objImg.style.width = w + 'px';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T20:41:38.180

您的问题在于您的 size() 函数语法和算法：

```
var objImg = new Object();
var h;
var w;

var no = 100;

var int = window.setInterval(function () {
    size(no,no);
    no += 50;
},2000)

function size(h, w) {
    if (h == 500){
        window.clearInterval(int);
        return;
    }
    var height = h + 'px';
    var width = w + 'px';
    document.getElementsByName('ford').item(0).style.height = height;
    document.getElementsByName('ford').item(0).style.width = width;
} 
```

[http://jsfiddle.net/AQtNY/2/](http://jsfiddle.net/AQtNY/2/)

# java - Android 自定义运营商标签 nullpointerexception

> ID：14791167
> 
> 赞同：0
> 
> 时间：2013-02-09T20:21:05.523
> 
> 标签：java, android

我已将 AOKP 的自定义运营商标签选项添加到我的 rom 中，除了在对话框窗口中单击“确定”时获取设置 fc 外，一切正常... customlabeltextsummary 已正确更新，并且运营商已按应有的方式更改.. .

设置.java：

```
package com.android.settings.cyanogenmod;

import android.app.AlertDialog;
import android.content.ContentResolver;
import android.content.Context;
import android.content.pm.PackageManager.NameNotFoundException;
import android.os.Bundle;
import android.content.ContentResolver;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.os.RemoteException;
import android.os.ServiceManager;
import android.view.IWindowManager;
import android.preference.CheckBoxPreference;
import android.preference.Preference;
import android.preference.PreferenceScreen;
import android.provider.Settings;
import android.preference.CheckBoxPreference;
import android.preference.ListPreference;
import android.preference.Preference;
import android.preference.PreferenceActivity;
import android.preference.PreferenceGroup;
import android.preference.PreferenceScreen;
import android.preference.Preference.OnPreferenceChangeListener;
import android.provider.Settings;
import android.text.Spannable;
import android.util.Log;
import android.view.IWindowManager;
import android.view.Display;
import android.view.LayoutInflater;
import android.widget.EditText;

import com.android.settings.R;
import com.android.settings.SettingsPreferenceFragment;
import com.android.settings.Utils;

import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class SystemSettings extends SettingsPreferenceFragment implements
    Preference.OnPreferenceChangeListener{

private static final String TAG = "SystemSettings";

private static final String KEY_POWER_BUTTON_TORCH = "power_button_torch";

private CheckBoxPreference mPowerButtonTorch;
private static final String KEY_CHRONUS = "chronus";
private static final String PREF_FORCE_DUAL_PANEL = "force_dualpanel";
private static final String PREF_CUSTOM_CARRIER_LABEL = "custom_carrier_label";

Preference mCustomLabel;

Context mContext;

String mCustomLabelText = null;

CheckBoxPreference mDualpane;
private boolean torchSupported() {
    return getResources().getBoolean(R.bool.has_led_flash);
}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    // Load the preferences from an XML resource
    addPreferencesFromResource(R.xml.system_settings);

    mCustomLabel = findPreference(PREF_CUSTOM_CARRIER_LABEL);
    updateCustomLabelTextSummary();

    // Dont display the lock clock preference if its not installed
    removePreferenceIfPackageNotInstalled(findPreference(KEY_CHRONUS));

    mPowerButtonTorch = (CheckBoxPreference) findPreference(KEY_POWER_BUTTON_TORCH);
    if (torchSupported()) {
        mPowerButtonTorch.setChecked((Settings.System.getInt(getActivity().
                getApplicationContext().getContentResolver(),
                Settings.System.POWER_BUTTON_TORCH, 0) == 1));
    } else {
        getPreferenceScreen().removePreference(mPowerButtonTorch);
    }

    mDualpane = (CheckBoxPreference) findPreference(PREF_FORCE_DUAL_PANEL);
        mDualpane.setOnPreferenceChangeListener(this);

}

@Override
public void onResume() {
    super.onResume();
}

@Override
public void onPause() {
    super.onPause();
}

@Override
public boolean onPreferenceTreeClick(PreferenceScreen preferenceScreen, Preference preference) {
    if (preference == mPowerButtonTorch) {
        boolean enabled = mPowerButtonTorch.isChecked();
        Settings.System.putInt(getContentResolver(), Settings.System.POWER_BUTTON_TORCH,
                enabled ? 1 : 0);
        return true;
    } else if (preference == mCustomLabel) {
        AlertDialog.Builder alert = new AlertDialog.Builder(getActivity());

        alert.setTitle(R.string.custom_carrier_label_title);
        alert.setMessage(R.string.custom_carrier_label_explain);

        // Set an EditText view to get user input
        final EditText input = new EditText(getActivity());
        input.setText(mCustomLabelText != null ? mCustomLabelText : "");

        alert.setView(input);
        alert.setPositiveButton(getResources().getString(R.string.ok), new DialogInterface.OnClickListener() {

            public void onClick(DialogInterface dialog, int whichButton) {
                String value = ((Spannable) input.getText()).toString();
                Settings.System.putString(getActivity().getContentResolver(),
                        Settings.System.CUSTOM_CARRIER_LABEL, value);
                updateCustomLabelTextSummary();
                Intent i = new Intent();
                i.setAction("com.android.settings.LABEL_CHANGED");
                mContext.sendBroadcast(i);
            }
        });

        alert.setNegativeButton(getResources().getString(R.string.cancel), new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int whichButton) {
                // Canceled.
            }
        });

        alert.show();   
    }
    return super.onPreferenceTreeClick(preferenceScreen, preference);
}

public boolean onPreferenceChange(Preference preference, Object objValue) {
    ContentResolver cr = getActivity().getContentResolver();

    if (preference == mDualpane) {
        Settings.System.putInt(getActivity().getContentResolver(),
                Settings.System.FORCE_DUAL_PANEL,
                ((CheckBoxPreference)preference).isChecked() ? 0 : 1);
        return true;
    }
    return false;
}

private boolean removePreferenceIfPackageNotInstalled(Preference preference) {
    String intentUri=((PreferenceScreen) preference).getIntent().toUri(1);
    Pattern pattern = Pattern.compile("component=([^/]+)/");
    Matcher matcher = pattern.matcher(intentUri);

    String packageName=matcher.find()?matcher.group(1):null;
    if(packageName != null) {
        try {
            getPackageManager().getPackageInfo(packageName, 0);
        } catch (NameNotFoundException e) {
            Log.e(TAG,"package "+packageName+" not installed, hiding preference.");
            getPreferenceScreen().removePreference(preference);
            return true;
        }
    }
    return false;
}

private void updateCustomLabelTextSummary() {
    mCustomLabelText = Settings.System.getString(getActivity().getContentResolver(),
            Settings.System.CUSTOM_CARRIER_LABEL);
    if (mCustomLabelText == null || mCustomLabelText.length() == 0) {
        mCustomLabel.setSummary(R.string.custom_carrier_label_notset);
    } else {
        mCustomLabel.setSummary(mCustomLabelText);
    }
} 
```

}

日志猫：

```
W/System.err(13551): Removed 2131231241
W/System.err(13551): Removed 2131231255
D/dalvikvm( 3528): GC_CONCURRENT freed 384K, 16% free 2993K/3552K, paused 2ms+4ms, total 33ms
D/dalvikvm(13551): GC_CONCURRENT freed 190K, 10% free 3282K/3644K, paused 2ms+8ms, total   37ms
D/AndroidRuntime(13551): Shutting down VM
W/dalvikvm(13551): threadid=1: thread exiting with uncaught exception (group=0x40d12600)
E/AndroidRuntime(13551): FATAL EXCEPTION: main
E/AndroidRuntime(13551): java.lang.NullPointerException
E/AndroidRuntime(13551):    at com.android.settings.cyanogenmod.SystemSettings$1.onClick(SystemSettings.java:143)
E/AndroidRuntime(13551):    at com.android.internal.app.AlertController$ButtonHandler.handleMessage(AlertController.java:166)
E/AndroidRuntime(13551):    at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime(13551):    at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime(13551):    at android.app.ActivityThread.main(ActivityThread.java:5191)
E/AndroidRuntime(13551):    at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(13551):    at java.lang.reflect.Method.invoke(Method.java:511)
E/AndroidRuntime(13551):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:795)
E/AndroidRuntime(13551):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:562)
E/AndroidRuntime(13551):    at dalvik.system.NativeStart.main(Native Method)
W/ActivityManager( 1108):   Force finishing activity com.android.settings/.SubSettings
W/ActivityManager( 1108): Activity pause timeout for ActivityRecord{40ff74b8 u0 com.android.settings/.SubSettings}
D/dalvikvm(13124): GC_FOR_ALLOC freed 411K, 22% free 3616K/4608K, paused 28ms, total 34ms
I/Process (13551): Sending signal. PID: 13551 SIG: 9
W/InputDispatcher( 1108): channel '41188140 com.android.settings/com.android.settings.SubSettings (server)' ~ Consumer closed input channel or an error occurred.  events=0x9
I/WindowState( 1108): WIN DEATH: Window{41369d90 u0 com.android.settings/com.android.settings.SubSettings}
I/ActivityManager( 1108): Process com.android.settings (pid 13551) has died.
E/InputDispatcher( 1108): channel '41188140 com.android.settings/com.android.settings.SubSettings (server)' ~ Channel is unrecoverably broken and will be disposed!
W/InputDispatcher( 1108): channel '40ffd998 com.android.settings/com.android.settings.Settings (server)' ~ Consumer closed input channel or an error occurred.  events=0x9
E/InputDispatcher( 1108): channel '40ffd998 com.android.settings/com.android.settings.Settings (server)' ~ Channel is unrecoverably broken and will be disposed!
W/InputDispatcher( 1108): Attempted to unregister already unregistered input channel '41188140 com.android.settings/com.android.settings.SubSettings (server)'
W/InputDispatcher( 1108): Attempted to unregister already unregistered input channel '40ffd998 com.android.settings/com.android.settings.Settings (server)'
I/WindowState( 1108): WIN DEATH: Window{41188140 u0 com.android.settings/com.android.settings.SubSettings}
I/WindowState( 1108): WIN DEATH: Window{40ffd998 u0 com.android.settings/com.android.settings.Settings}
I/ActivityManager( 1108): Start proc com.android.settings for activity com.android.settings/.Settings: pid=13575 uid=1000 gids={41000, 1015, 1028, 3002, 3001, 3003, 3007}
W/WindowManager( 1108): Rebuild removed 7 windows but added 6
W/WindowManager( 1108): This window was lost: Window{41369d90 u0 com.android.settings/com.android.settings.SubSettings EXITING}
W/WindowManager( 1108): mDisplayId=0 mSession=Session{41e7d3b0 13551:1000} mClient=android.os.BinderProxy@4108dde8 
```

第 143 行如下：

```
mContext.sendBroadcast(i); 
```

有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:25:53.023

`mContext`是`null`，因为它是在您的班级顶部声明的，但从未给予任何保留。

您可能可以使用`getActivity()`代替，`mContext`因为这是一个`Fragment`并且`Activity`是一个`Context`子类。

这表示

```
mContext.sendBroadcast(i); 
```

应该

```
getActivity().sendBroadcast(i); 
```

# c++ - 方法需要多个参数？

> ID：14791168
> 
> 赞同：0
> 
> 时间：2013-02-09T20:21:08.947
> 
> 标签：c++, methods, arguments, signature

所以，我不能像这样编译我的代码：

```
std::vector<std::string> split = split("A String Blah"); 
```

使用此方法签名：

```
std::vector<std::string> split(const std::string& s) 
```

因为它说它需要不止一个论据。为什么仅仅一个字符串还不够？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T20:25:31.277

当你有这条线时：

```
std::vector<std::string> split = split("A String Blah"); 
```

C++ 编译器认为`split`右侧所指的与`split`左侧所声明的相同。结果，它给你一个错误，因为事实上， a`std::vector<std::string>`不是一个接受一个参数的函数。

要解决此问题，请考虑重命名变量：

```
std::vector<std::string> theSplit = split("A String Blah"); 
```

希望这可以帮助！

# ios - 将 Web 服务从 GET 转换为 POST

> ID：14791169
> 
> 赞同：3
> 
> 时间：2013-02-09T20:21:17.927
> 
> 标签：ios, web-services, post, joomla, get

我创建了一个 Web 服务来在 iOS 应用程序和 Joomla 网站之间进行通信，并且我使用 GET 方法在移动应用程序和 Web 服务之间以及 Web 服务和控制器之间进行通信（PHP 文件确实工作并返回数据），但我没有找到如何将实现转换为 POST 方法这里是实际系统：

**ws.php**：这是网络服务（简单示例）

```
<?php 
      $id = $_GET['id'] ; // get the data from the URL

// here i make testes

// then I redirect to the controller of the Joomla component that receive 
// the call of the request the URL is actually the attribute "action" of 
// an existing HTML Form that implement the login system, I added a 
// parameter called web service to help me to modify the controller 
// to make the difference between a normal call and a web service call

header("Location: index.php?option=com_comprofiler&task=login&ws=1&id=1");
?> 
```

**Controller.php**：网络服务调用和网络调用的接收者（来自浏览器）

```
<?php 
// code added by me, in the existent controller of the component
// it was waiting for a form submitting, so I got to convert my data to POST here

if (isset($_GET['ws'])) // it's a web service call 
{
   $_POST['id'] = $_GET['id'] ; 

   // do the task ... 

   if ($correctLogin) // just an example 
     echo "1"
   else 
     echo '0';
}
?> 
```

我没有放真正的实现，只是系统的一个简单的例子，但都是一样的

**从手机拨打**

```
 NSURL *url = [[NSURL alloc]initWithString:@"http://localhost/ws.php?id=1"];

 NSData *dataUrl= [NSData dataWithContentsOfURL:url];

 NSString *str = [[NSString alloc]initWithData:dataUrl 
                                      encoding:NSUTF8StringEncoding];

if(![str isEqualToString:@"0"])
    NSLog(@"connected");
else
    NSLog(@"not connected"); 
```

所以我不想使用 GET 方法，我只想使用 POST 从手机接收我的数据，并使用 POST 将数据发送到控制器，最好的解决方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:06:16.047

如果您希望您的应用程序使用 POST 方法发送数据，那么我就是这段代码。我希望它会有所帮助。

它需要在字典对象中发送数据。将要发送的数据编码为 POST，然后返回响应（如果您想要字符串格式的结果，您可以使用 [[NSString alloc] initWithData:dresponse encoding: NSASCIIStringEncoding]; 返回数据时）

```
-(NSData*) getData:(NSDictionary *) postDataDic{

    NSData *dresponse = [[NSData alloc] init];

    NSURL *nurl = [NSURL URLWithString:url];
    NSDictionary *postDict = [[NSDictionary alloc] initWithDictionary:postDataDic];
    NSData *postData = [self encodeDictionary:postDict];

    // Create the request
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:nurl];
    [request setHTTPMethod:@"POST"]; // define the method type
    [request setValue:[NSString stringWithFormat:@"%d", postData.length] forHTTPHeaderField:@"Content-Length"];
    [request setValue:@"application/x-www-form-urlencoded charset=utf-8" forHTTPHeaderField:@"Content-Type"];
    [request setHTTPBody:postData];

        // Peform the request
        NSURLResponse *response;
        NSError *error = nil;

        dresponse = [NSURLConnection sendSynchronousRequest:request  
                                                     returningResponse:&response
                                                                 error:&error];

    return dresponse;
} 
```

此方法为 POST 准备 Dictionary 数据

```
- (NSData*)encodeDictionary:(NSDictionary*)dictionary {
    NSMutableArray *parts = [[NSMutableArray alloc] init];
    for (NSString *key in dictionary) {
        NSString *encodedValue = [[dictionary objectForKey:key] stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
        NSString *encodedKey = [key stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]; 
        NSString *part = [NSString stringWithFormat: @"%@=%@", encodedKey, encodedValue];
        [parts addObject:part];
    }
    NSString *encodedDictionary = [parts componentsJoinedByString:@"&"];
    return [encodedDictionary dataUsingEncoding:NSUTF8StringEncoding];
} 
```

# ruby-on-rails - 从 select_date 和 select_time 在控制器中获取并构建日期

> ID：14791177
> 
> 赞同：0
> 
> 时间：2013-02-09T20:22:18.630
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

在我看来，我有这个表格：

```
 <tr>
      <td>Date</td>
      <td>
        <%= select_date(@min_date, { :order => [:day, :month, :year], start_year: @start_year, end_year: @end_year }, style: "width: auto;") %>
      </td>
    </tr>
    <tr>
      <td>Time</td>
      <td>
        <%= select_time(@min_date, {}, style: "width: auto;") %>
      </td>
    </tr> 
```

我在我的控制器中得到它是这样的：

```
unless params[:date].nil?
  params[:event][:date] = DateTime.new(
    params[:date][:year].to_i, params[:date][:month].to_i,
    params[:date][:day].to_i, params[:date][:hour].to_i,
    params[:date][:minute].to_i, 0
  )
end 
```

问题是输入这样的示例日期： ![在此处输入图像描述](../Images/c597b81ea73c892ebf9aee69308c6c79.png)

正在设置小时和分钟，但不设置日期：

```
(rdb:369) pp date
Sat, 09 Feb 2013 16:37:00 UTC +00:00 
```

我不知道我错过了什么......我会很感激任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:42:57.467

您不必在控制器中执行此操作。如果这是数据库中的日期时间字段，rails 将自动完成所有这些操作。您可以在从数据库中获取格式时更改格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:43:52.940

我已经弄清楚了，在我的视图中设置了 select_date 和 select_time 助手中的前缀属性，就像这样。

```
 <tr>
      <td>Date</td>
      <td>
        <%= select_date(@min_date, { :prefix => "date", :order => [:day, :month, :year], start_year: @start_year, end_year: @end_year }, style: "width: auto;") %>
      </td>
    </tr>
    <tr>
      <td>Time</td>
      <td>
        <%= select_time(@min_date, { :prefix => "time" }, style: "width: auto;") %>
      </td>
    </tr> 
```

并建立日期，如下：

```
unless params[:date].nil?
  params[:event][:date] = DateTime.new(
    params[:date][:year].to_i, params[:date][:month].to_i,
    params[:date][:day].to_i, params[:time][:hour].to_i,
    params[:time][:minute].to_i, 0
  )
end 
```

# mysql - 使用 WHERE 和 BETWEEN 从两列排序

> ID：14791178
> 
> 赞同：0
> 
> 时间：2013-02-09T20:22:21.857
> 
> 标签：mysql, sorting, select, where

困扰着你必须按类别和价格寻找的项目：我得到了以下mysql代码： `$query = " SELECT * FROM filmi WHERE $id3 = '1' $orderby_query "`

`filmi`是主表， `$id3 = '1'`是类别的副表。并且`$orderby_query`是按价格降序/升序的简单顺序

如何按价格范围搜索？在 10 到 100 之间？我不能用`WHERE seriq BETWEEN 50000 AND 1000000 ORDER by seriq asc`，因为已经到了:(

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:46:50.923

试试这个

```
 WHERE $id3 = '1'
   AND seriq BETWEEN 50000 AND 1000000
   ORDER by seriq asc 
```

或者像那样

```
 WHERE $id3 = '1'
   HAVING seriq >= 50000 AND  seriq <= 1000000
   ORDER by seriq asc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:24:06.187

`WHERE`只需使用以下命令，您的条件中就可以包含多个子句`AND`：

```
SELECT * FROM filmi
WHERE $id3 = '1' AND
   seriq BETWEEN 50000 AND 1000000
ORDER by seriq 
```

祝你好运。

# windows - 在 Windows 注册表上注册程序，使其出现在控制面板的“卸载程序”中

> ID：14791188
> 
> 赞同：9
> 
> 时间：2013-02-09T20:23:32.230
> 
> 标签：windows, installation, registry

假设我有一个简单的程序：这些程序`SomeProgram.exe`与 几个 dll 和资源一起存在。 `Uninstaller.exe``C:\ProgramFiles\MyProgram`

无论如何，我有一个简单的安装程序，可以为该路径安装几个先决条件。**现在我的问题是**如何`SomeProgram.exe`在窗口注册表上注册，以便我可以让它出现在控制面板的添加或删除程序中。我想`Uninstaller.exe`在用户点击删除我的程序时执行。此外，我想在 Windows 启动菜单上创建一个文件夹，以便用户可以从那里启动程序，以防他不想在桌面上有快捷方式。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-11T07:38:56.780

您需要做的就是创建注册表项，如“sergmat”的第二个链接中所述。这将使程序出现在控制面板的列表中。 [http://msdn.microsoft.com/en-us/library/windows/desktop/aa372105(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa372105(v=vs.85).aspx)

# dbcontext - 实体框架 - AuditLog 和 CreatedOn/ModifiedOn 以及 DB 建模团队时的 ObjectContext 或 DbContext

> ID：14791197
> 
> 赞同：0
> 
> 时间：2013-02-09T20:23:58.870
> 
> 标签：dbcontext, objectcontext

选择哪一个，`ObjectContext`或者`DbContext`，当有要求时，

1.  数据建模由 Modeler 完成，并为 DEV 团队提供 sql 脚本。因此，我们选择了模型优先。这是一个正确的选择吗？
2.  现有的非规范化数据库将迁移到建模器创建的新数据库
3.  需要从 UI 维护字段级别的所有更新的审核日志
4.  每个表都有`CreatedBy`, `CreatedOn`, `ModifiedBy`, `ModifiedOn`。这些字段应由 during 自动填充 `context.SaveChanges()`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:47:39.270

如果您正在启动一个新应用程序，只需使用 DbContext。如果需要，您可以随时深入到 ObjectContext。

1.  如果您不喜欢设计器，您可以将 Code First 与 Migrations 一起使用，并通过 update-database -script 创建 SQL 脚本。

2.  听起来像是 DBA 的任务？

3.  逐个字段更改..如果这是一个断开连接的应用程序，您最好在 EF 之外处理它（恕我直言）

4.  您可以为此轻松覆盖 SaveChanges。你在推文中说你有 dbcontext 书。有一个例子，我们使用基类来做到这一点。但是，如果您要先使用模型，请务必避免此问题：http: [//msdn.microsoft.com/en-us/magazine/jj553510.aspx](http://msdn.microsoft.com/en-us/magazine/jj553510.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T11:37:22.657

```
Thanks a lot Julie for your super quick response. You are The-EF-Angel.
I have read your MSDN article on Logging in EF.
To your reponse:

1\. As a mandate, We need to use sql scripts provided by our Modeler to create our db. Also these scripts will be keep changing(With addition of new tables & update of exising schema) for each sprints. Hope DataFirst Model is fine. Whenever new we get new sql scripts, we plan to recreate the DB and update our EDMX. Do you see any issues with this approach ?

2\. Ya we have a migration specialist for this task. I justed pointed that in question as an FYI.

3\. We use MVC app and for field by field changes in audit log table, we planned to let EF decide what fields have changed(using change tracking ideas from your book) and capture that info into a DTO(we borrow your repository ideas from the course "EF in enterprise course" you authored in PS). And push that DTO into our messaging infrastructure and that will insert the audit logs to the DB.
Is this fine ? Do you foresee any issues ?

4\. As you pointed out, we could change our interface for our needs by referring to your MSDN article and there "Figure 3 Setting the Interface’s DateCreated Property During SaveChanges"

I plan to use,
public interface ITheBaseType 
{

  DateTime DateCreated { get; set; }
  DateTime DateModified { get; set; }
  string   CreatedBy { get; set; }
  string   ModifiedBy { get; set; }
} 
```

# java - 检查域是否存在时的不良行为

> ID：14791205
> 
> 赞同：0
> 
> 时间：2013-02-09T20:24:31.340
> 
> 标签：java

我想检查一个域是否存在，所以这是我的代码：

```
try {
    InetAddress inetAddress = InetAddress.getByName("ouestfrance-ecole.com");
    System.out.println(inetAddress.getHostName());
    System.out.println(inetAddress.getHostAddress());
} catch (UnknownHostException e) {
    e.printStackTrace();
} 
```

回应是：

```
java.net.UnknownHostException: ouestfrance-ecole.com
at java.net.Inet6AddressImpl.lookupAllHostAddr(Native Method)
at java.net.InetAddress$1.lookupAllHostAddr(InetAddress.java:849)
at java.net.InetAddress.getAddressFromNameService(InetAddress.java:1202)
at java.net.InetAddress.getAllByName0(InetAddress.java:1153)
at java.net.InetAddress.getAllByName(InetAddress.java:1083)
at java.net.InetAddress.getAllByName(InetAddress.java:1019)
at java.net.InetAddress.getByName(InetAddress.java:969)
at MainApp.main(MainApp.java:18) 
```

但是，如果我将 ouestfrance-ecole.com 放在浏览器中或执行，`host ouestfrance-ecole.com`我会收到响应，因为该域确实存在并托管了一个网站。

原因是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:32:58.183

```
InetAddress.getByName("www.ouestfrance-ecole.com") 
```

工作正常（注意`www`子域）。这是`ouestfrance-ecole.com`不起作用的（也在我的浏览器中）。

# android - 阿拉伯语的 DOM 解析器

> ID：14791206
> 
> 赞同：0
> 
> 时间：2013-02-09T20:24:36.433
> 
> 标签：android, parsing, dom

我在 DOM 解析阿拉伯字母时遇到问题，我得到了奇怪的字符。我尝试更改为不同的编码，但我做不到。

完整的代码在这个链接上： http: [//test11.host56.com/parser.java](http://test11.host56.com/parser.java)

```
public Document getDomElement(String xml) {
    Document doc = null;
    DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
   try {
       Reader reader = new InputStreamReader(new ByteArrayInputStream(
       xml.getBytes("UTF-8")));
       InputSource is = new InputSource(reader);

       DocumentBuilder db = dbf.newDocumentBuilder();

       //InputSource is = new InputSource();
       is.setCharacterStream(new StringReader(xml));
       doc = db.parse(is);

       return doc;
   }
} 
```

我的xml文件

```
<?xml version="1.0" encoding="UTF-8"?>
<music>
<song>
    <id>1</id>    
    <title>اهلا وسهلا</title>
    <artist>بكم</artist>
    <duration>4:47</duration>
    <thumb_url>http://wtever.png</thumb_url>
</song>
</music> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:37:33.303

您已经拥有 xml as `String`，因此除非该字符串已经包含奇数字符（即，它已使用错误的编码读入），否则您可以通过使用 StringReader 来避免此处的编码疯狂；例如，而不是：

```
Reader reader = new InputStreamReader(new ByteArrayInputStream(
   xml.getBytes("UTF-8"))); 
```

采用：

```
Reader reader = new StringReader(xml); 
```

**编辑**：现在我看到了更多代码，似乎在解析 XML 之前已经发生了编码问题，因为该部分包含：

```
HttpResponse httpResponse = httpClient.execute(httpPost);
HttpEntity httpEntity = httpResponse.getEntity();
xml = EntityUtils.toString(httpEntity); 
```

的 javadoc[`EntityUtils.toString`](http://hc.apache.org/httpcomponents-core-ga/httpcore/apidocs/org/apache/http/util/EntityUtils.html#toString%28org.apache.http.HttpEntity%29)说：

> 使用来自实体的字符集（如果有）转换内容，否则使用“ISO-8859-1”。

似乎服务器没有与实体一起发送正确的编码信息，然后 HttpUtils 使用默认值，它不是 UTF-8。

修复：使用采用显式默认编码的变体：

```
xml = EntityUtils.toString(httpEntity, "utf-8"); 
```

这里我假设服务器发送 UTF-8。如果服务器使用不同的编码，则应设置该编码而不是 UTF-8。（但是，正如 XML 也声明的那样，`encoding="UTF-8"`我认为是这种情况。）如果服务器使用的编码未知，那么您只能求助于疯狂的猜测并且不走运，对不起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-30T08:40:11.203

如果 XML 包含 Unicode 字符，例如阿拉伯或波斯字母，`StringReader`则会例外。在这些情况下，`InputStream`直接将 传递给`Document`对象。

# javascript - 事件ID，事件绑定开关类

> ID：14791216
> 
> 赞同：0
> 
> 时间：2013-02-09T20:25:24.193
> 
> 标签：javascript, backbone.js, jquery, backbone-events

每个触发的事件都有一个 id 吗？

我还没有深入研究事件，现在我有一个带有一些按钮的视图（div），单击 div 本身应该与单击其中一个按钮相同。当我单击任何按钮时，事件会提升并且绑定到“单击 div”的函数也被调用。

对于我所做的快速修复，我保存事件对象并在“单击 div”上检查调用事件是否与我保存的相同，然后什么也不做。这样做的更好方法是什么？而且我也无法在事件中找到 id，有没有可以将它们添加到事件对象中？

```
if( arguments ){
    if( arguments[0] ){ // jquery event
        if( this.lastEvent == arguments[0] ){ //already processed event
            return;
        }
        this.lastEvent = arguments[0];
    }
} 
```

**更新：** 按照建议- id 做了什么，鉴于：

```
events: {
    'click .btn-mark-saw': 'mark_saw',
    'click .btn-mark-circle': 'mark_circle',
    'click':'mark_circle'
},
mark_saw: function(event){
    event.stopPropagation();
    //...
    this.render();

},
mark_circle: function(event) {
    event.stopPropagation();
    //...
    this.render();
}, 
```

它有效，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:23:09.960

这应该符合您的目的。

```
$(document).ready(function(){
  $("#divID").live("click", function(){
      //div click action..
  });
  $("#buttonID").live("click", function(event){
      //button click action..
      event.stopPropagation();

  });
}); 
```

谢谢..

# database - Codeigniter 在数据库中存储会话

> ID：14791222
> 
> 赞同：4
> 
> 时间：2013-02-09T20:25:59.007
> 
> 标签：database, codeigniter, session, frameworks

我无法使用 codeigniter 在数据库中存储会话。

当用户登录时，会创建一个会话并将其存储在数据库中。数据被填充到数据库中。当用户使用注销按钮时，会话数据被清空，但是会话仍然存在于数据库中。

问题是当用户不使用注销按钮而只是关闭网络浏览器时。会话数据未清空，但用户仍处于注销状态。（我已经在我的配置文件中设置了这个）会话应该在数据库中被销毁，但事实并非如此！

当用户在单击“注销”按钮后重新登录时，用户第一次登录时创建的会话将再次填充数据。所以这没有问题。

但是当用户在关闭浏览器后重新登录时，它会创建一个新会话。

这个问题最终导致会话无休止，每次用户关闭浏览器时都会创建会话。

其他让我感到困惑的事情：当我使用帐户登录时，会创建一个会话。然后，当我使用该帐户注销并使用另一个帐户登录时，会话将存储在与另一个帐户相同的记录中。会话表中的新记录何时创建？

我正在使用 2.1.3 版的 codeigniter。

我究竟做错了什么？

```
//Session config:

$config['sess_cookie_name']     = 'ci_session';
$config['sess_expiration']      = 7200;
$config['sess_expire_on_close'] = TRUE;
$config['sess_encrypt_cookie']  = FALSE;
$config['sess_use_database']    = TRUE;
$config['sess_table_name']      = 'ci_sessions';
$config['sess_match_ip']        = FALSE;
$config['sess_match_useragent'] = TRUE;
$config['sess_time_to_update']  = 300; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T14:05:48.823

您已`sess_expire_on_close`设置为`TRUE`，因此这是预期的行为，并且在大多数情况下您*通常*都希望这样做。问题是，当浏览器关闭并再次打开时，会生成一个新的 cookie（因此是会话）。从[CI 会话类文档](http://ellislab.com/codeigniter/user-guide/libraries/sessions.html)（转到底部讨论在数据库中保存会话）：

> 注意： Session 类具有内置的垃圾收集功能，可以清除过期的会话，因此您无需编写自己的例程来执行此操作。

因此，您不必担心解决问题，孤立的会话将由会话类自动从数据库中收集垃圾。如果你愿意，你可以通过 cron 实现代码来清除它，但你真的不需要。

现在，如果这给*特定*的登录用户（例如“记住我”）带来了问题，*但*您希望会话在关闭时对其他人来说过期，您可以通过手动设置另一个比您的会话 cookie 和相关性更长的 cookie 来解决它会话数据库中的一个项目。这使您可以确定用户“是谁”并重建会话是否应该为他们神奇地持续存在。在这个对一个有点相关的问题的[回答](https://stackoverflow.com/a/3988774/50049)中，还有更多关于这一点的内容。

# android - 如何在没有 singleTop 的情况下使用 Android SearchView？

> ID：14791224
> 
> 赞同：5
> 
> 时间：2013-02-09T20:26:09.310
> 
> 标签：android, android-intent

我有一个活动，我通常希望在多个任务中存在，以便 [Back] 按钮恢复以前的状态；但是，我还想将[SearchView](http://developer.android.com/reference/android/widget/SearchView.html)与现有活动一起使用，而不将新活动推入任务堆栈（因为我想搜索当前显示的内容）。这是我的问题：

*   如果我将活动的启动模式设置为“singleTop”，SearchView 将与当前活动一起使用，但[Context.startActivity](http://developer.android.com/reference/android/content/Context.html#startActivity(android.content.Intent))不会将新活动添加到堆栈中。
*   如果我将活动的启动模式设置为“标准”，则*startActivity*会将新活动添加到堆栈中，但 SearchView 还会创建一个新的（空）活动，而不是搜索现有活动。

我找不到任何方法让 SearchView 使用意图标志（例如[FLAG_ACTIVITY_SINGLE_TOP](http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_SINGLE_TOP)。我尝试反过来，将启动模式设置为“singleTop”，然后将 FLAG_ACTIVITY_NEW_TASK 添加[到](http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_TASK)每个意图，但这仅在从不同的活动类启动时有效；当我尝试从它自己的类中启动一个新的活动实例时，Android 不尊重 FLAG_ACTIVITY_NEW_TASK 并且没有将新任务推送到堆栈上。

也许我可以在[Activity.onNewIntent](http://developer.android.com/reference/android/app/Activity.html#onNewIntent(android.content.Intent))中做一些事情来强制活动克隆自己。

我即将放弃 SearchView 并只是编写自己的自定义小部件，尽管*“从 Android 3.0 开始，使用 SearchView 小部件作为操作栏中的项目是在您的应用中提供搜索的首选方式"*（[来源](http://developer.android.com/training/search/setup.html)）- 到目前为止，它似乎太不灵活且不可配置，无法在非平凡的情况下使用。

有没有人找到解决这个问题的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T23:09:11.057

经过大量的反思和错误的开始，我意识到 SearchView 对这项任务来说是完全错误的。Google 在设计 SearchView 时考虑了一种非常特定类型的搜索活动：

*   用户键入搜索查询。
*   该应用程序推送一个显示结果列表的新活动。

那不是我使用的搜索模型；相反，我想使用查询细化当前显示在屏幕上的列表——它更像是一种过滤搜索，而不是同步查询和响应模型。SearchView 不是为此而设计的，所以我继续编写自己的小部件（并将其绑定到搜索菜单项和搜索按钮）。

我很惊讶没有人对这个问题发表任何评论——通常 Android 问题会引起很多讨论。我想这离那里太远了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-25T11:13:06.667

我遇到了与 OP 相同的问题，但有一个解决方案并不意味着放弃使用`SearchView`. 这不是完美的解决方案，但它相当干净并且似乎运行良好。

正如OP所说...

> 当我尝试从它自己的类中启动一个新的活动实例时，Android 不尊重 FLAG_ACTIVITY_NEW_TASK 并且没有将新任务推送到堆栈上

...所以我的解决方案是通过中介活动。为此，我创建了一个`DummyActivity`类，它基本上采用原始意图并将其转发到您的目标活动。

所以，从我原来的活动中，而不是打电话...

```
Intent destinationIntent = new Intent(getActivity(), DestinationActivity.class);
startActivity(destinationIntent); 
```

...我打电话...

```
/*
 * Create the intent as normal, but replace our destination Activity with DummyActivity
 */
Intent dummyIntent = new Intent(getActivity(), DummyActivity.class);

/*
 * This will make it so that if user clicks back from the next activity, they won't be shown DummyActivity
 */
dummyIntent.setFlags(Intent.FLAG_ACTIVITY_NO_HISTORY);

/*
 * Tell DummyActivity about the destination Activity
 */
dummyIntent.putExtra(DummyActivity.EXTRA_DESTINATION_ACTIVITY, YourDestinationActivity.class); //IMPORTANT - the destination Activity must implement Serializable

/*
 * If you want, you can add any other extras to dummyIntent (which will be passed through to the destination activity). Launch DummyActivity.
 */
startActivity(dummyIntent); 
```

在我的清单中，DesinationActivity 被定义为 singleTop。

你应该需要的唯一另一件事是 DummyActivity 类，它不需要任何主要的定制......

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;

public class DummyActivity extends Activity {

    public static final String EXTRA_DESTINATION_ACTIVITY = "uk.co.mobilewebexpert.EXTRA_DESTINATION_ACTIVITY";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        //setContentView(R.layout.activity_dummy);

        Intent intent = getIntent();

        /*
         * Get destination activity info
         */
        @SuppressWarnings("unchecked")
        Class<Activity> destinationActivity = (Class<Activity>) intent.getSerializableExtra(EXTRA_DESTINATION_ACTIVITY);
        Bundle destinationActivityExtras = intent.getExtras();

        /*
         * Launch destination activity
         */
        Intent destinationActivityIntent = new Intent(this, destinationActivity);
        destinationActivityIntent.putExtras(destinationActivityExtras);
        destinationActivityIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        startActivity(destinationActivityIntent);
    }

    /**
     * Override super.onNewIntent() so that calls to getIntent() will return the latest
     * intent, rather than the first intent.
     */
    @Override
    public void onNewIntent(Intent intent){
        super.onNewIntent(intent);
        setIntent(intent);
    }

} 
```

希望这也对你有用。欢迎提出建议。干杯。

# linux - 在这个例子中 /proc/self/fd/4 会发生什么？

> ID：14791225
> 
> 赞同：1
> 
> 时间：2013-02-09T20:26:12.740
> 
> 标签：linux, proc

使用 bash 3.00.15(1)：

```
$ ls /proc/self/fd 4<&1
0 1 2 3 4
$ echo | ls /proc/self/fd 4<&1
0 1 2 3 4
$ ls() { /bin/ls $*; }
$ ls /proc/self/fd 4<&1
0 1 2 3 4
$ echo | ls /proc/self/fd 4<&1   # Unexpected output
0 1 2 3 
```

这似乎是一个 bash 错误，因为 dash 和 zsh 中的行为不同（并且 bash 中的行为不是我所期望的）。将 dup'd 描述符更改为 5，最终输出如预期。

关于导致这种行为的原因有什么想法吗？

# spring - Spring DI 演示的 ClassNotFoundException 问题

> ID：14791226
> 
> 赞同：0
> 
> 时间：2013-02-09T20:26:26.230
> 
> 标签：spring

我无法运行该程序。

线程“主”org.springframework.beans.factory.CannotLoadBeanClassException 中的异常：找不到类路径资源 [beans.xml] 中定义的名称为“hello”的 bean 的类 [com.tutorialspoint.HelloWorld]；嵌套异常是 java.lang.ClassNotFoundException：

![在此处输入图像描述](../Images/651152437999366320b7bf9fafd52574.png)

![在此处输入图像描述](../Images/bf92c1c3e0d8cc4333d33fcc4b389d4f.png)

![在此处输入图像描述](../Images/ef6a0c616871abe45270c28e05eba88f.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T21:51:58.150

您的 bean 定义必须指向类而不是包名

```
<bean id="hello" class="com.tutorialspoint.HelloWorld.MainApp">
    <property name="message" value="Hello Man"></property>
</bean> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T13:24:45.357

您的 Spring Beans 配置是完美的，但您必须根据您的代码在 MainApp 类中为 ApplicationContext 提供正确的路径，您的路径应该是**"main/resource/beans.xml"**。希望这会奏效...

# c++ - 函数返回值的顺序

> ID：14791228
> 
> 赞同：0
> 
> 时间：2013-02-09T20:26:58.453
> 
> 标签：c++, function, return

这是我在 C++ 中的代码：

```
 MyClass foo1() {
     return MyClass();
 }

 int MyClass::foo2() {
     return 54;
 } 
```

问题是，什么是价值：

```
foo1().foo2(); 
```

值是 54 还是 MyClass 对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T20:29:05.110

由于点`.`运算符是从左到右计算的（即首先`foo1()`调用以确定调用的目标，然后调用它的`foo2()`成员），所以答案是 54。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T20:32:14.897

`foo1().foo2();`表示`foo1()`返回一个对象或对允许您调用`foo2()`它的对象的引用。

类似的是将返回值存储`foo1()`在一个变量中：

```
MyClass obj = foo1();
int ret = obj.foo2(); 
```

示例（延迟加载的单例）：

```
class MyClass
{
public:
    static MyClass& getInstance(){ static MyClass m; return m; }
    int getNumber(){ return 54; }
};

int main()
{
    std::cout << MyClass::getInstance().getNumber();
} 
```

# c# - 如何在 MonoTouch 中代理 UIKit 代表？

> ID：14791230
> 
> 赞同：0
> 
> 时间：2013-02-09T20:26:59.750
> 
> 标签：c#, ios, xamarin.ios, uikit, xamarin

我需要链接到一个`UIScrollView`的委托（它不在我的代码中，我无法控制它）并处理它的一些方法，同时将所有事件传递给前一个委托。

我天真的实现是这个代理类：

```
public class ScrollViewProxyDelegate : UIScrollViewDelegate
{
    private UIScrollViewDelegate _realDelegate;

    public ScrollViewProxyDelegate (UIScrollViewDelegate realDelegate)
    {
        _realDelegate = realDelegate;
    }

    public override void DecelerationStarted (UIScrollView scrollView)
    {
        _realDelegate.DecelerationStarted (scrollView);
    }

    public override void DecelerationEnded (UIScrollView scrollView)
    {
        _realDelegate.DecelerationEnded (scrollView);
    }

    // ...
 } 
```

这没有成功，因为`scrollView.Delegate`我传递给`ScrollViewProxyDelegate`构造函数原来是`null`因为这个特定的委托位于不同的类树中。我追求的属性是`WeakDelegate`，但它是`NSObject`.

我读[了这个](http://docs.xamarin.com/ios/Guides/Application_Fundamentals/Delegates%252C_Protocols%252C_and_Events)，我仍然很困惑。我想我可以`NSObject`在每个方法中对此调用 Objective C 选择器，但有没有更简洁的方法？

### 更新 1

我刚刚尝试了代理`PerformSelector`，`RespondsToSelector`但它导致无法识别的选择器崩溃。

### 更新 2

好的，显然[`NSProxy`是人们为此使用的](http://www.jayway.com/2009/03/06/proxy-based-aop-for-cocoa-touch/)。调查。

### 更新 3

`NSProxy`哎呀，在 MonoTouch 中没有。

### 更新 4

我最终使用 Key Value Observing 来观看我的视图`contentOffset`。我早该想到的！不过，如果我需要它，我很好奇如何实现代理。

挂钩视图委托的最简单方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T06:08:10.133

如果您尝试代理的委托为空，我无法完全满足您对代理的需求，或者您的意思是您需要代理的委托是滚动视图的 WeakDelegate？

WeakDelegate 本质上是任何 NSObject，您需要实现的任何方法都必须“导出”，以便委托的所有者能够调用它们。

```
[Export("scrollViewDidEndDecelerating:")]
public void MyDecelerationEndedMethod(UIScrollView scrollView)
{
  ...
} 
```

您可以将这样的方法添加到任何 NSObject 上，例如视图控制器。如果您需要使用 Wea​​kDelegate 作为代理的主题，您必须查询它以查看它是否响应选择器然后执行选择器 - 我认为这就是您的意思。

但是，我认为您无法编写可以处理任何委托的通用代理，因为尽管代理调用了 RespondsToSelector，但它没有调用 PerformSelector - 选择器直接发送到代理而不是通过 PerformSelector . 您必须编写一个代理，该代理实现与您要代理的委托完全相同的方法。

我能想到的最好的方法是如下所示，您必须实现委托实现的每个方法。

```
public class TestProxy : NSObject
{
    private NSObject realDelegate;

    public TestProxy(NSObject realDelegate)
    {
        this.realDelegate = realDelegate;
    }

    public override bool RespondsToSelector(MonoTouch.ObjCRuntime.Selector sel)
    {
        Console.WriteLine("Query : " + sel.Name);
        return this.realDelegate.RespondsToSelector(sel);
    }

    [Export("tableView:didSelectRowAtIndexPath:")]
    public void RowSelected(UITableView tableView, NSIndexPath indexPath)
    {
        // invoke method on realDelegate either by casting to the correct type or by using
        // reflection to find the method that matches the export and pass this method's arguments.
        // which way you implement depends on your needs and what you know about the delegate being
        // proxied - casting would be much faster than reflection.
    }
} 
```

因为您正在实现委托实现的所有方法，所以 RespondsToSelector 是多余的，而不是必需的。

# android - 使用 Android 应用程序扩展现有的 Web 应用程序

> ID：14791236
> 
> 赞同：0
> 
> 时间：2013-02-09T20:28:01.130
> 
> 标签：android, web-services, rest

我有一个新项目，涉及为远足俱乐部的网站构建 Android 应用程序。该网站具有登录功能，之后用户可以浏览可用的徒步旅行、订阅徒步旅行、查看其他订阅者、联系组织者等。原始网站基于 MySQL 数据库，前端为 .asp 页面。大多数数据作为查询字符串上的 GET 参数通过页面传递。

刚接触 Android 开发，有些事情真的让我很困惑，即使在阅读了几篇教程之后。我正在考虑建立一个基于 REST Web 服务的架构，但是有几个障碍需要克服和选择。

除了使用 REST，还有一些其他选项可用：

1.  从应用程序调用原始 .asp 页面，而不是构建专用的 Web 服务。这使我可以编写更少的代码，可以使用原始业务逻辑（查询 ea）以及登录系统（使用基于 cookie 的“记住我”功能）。缺点是响应中的 (X)HTML 代码需要解析以显示在应用程序 GUI 中，其中大部分响应代码是无用的镇流器代码。此外，从架构的角度来看，感觉也不是很好。

2.  使用基于 SOAP 的 Web 服务。我对 SOAP 完全不熟悉，它对于移动设备来说似乎太重了。

3.  使用 REST 服务。我倾向于这个选项，并且已经使用 SLIM 框架提供了一些已经工作的服务。但也有一些问题。首先，REST 根据定义是无状态的，似乎不支持会话。但是第一次登录后应用程序需要“记住我”选项，用户无需再次登录，除非他明确退出。

但是我们怎样才能做到这一点呢？

第一种选择是设计一些完全客户端站点登录/注销系统，该系统将凭据保存在本地，直到用户注销。并将每个请求的凭据作为 POST 参数发送到 Web 服务，或者以某种方式在 HTTP 授权请求标头中发送，尽管我对此并不熟悉。

第二种选择是稍微偏离 REST 原则并使用会话机制。将凭据发送到 Web 服务后，会创建一个 cookie 并将其发送到客户端应用程序。dartabase 无法扩展，因此无法在用户表中保存令牌。也许用户名/密码可以加密并作为 cookie 发送到应用程序，并在每个后续请求时解密？

我对此有点迷茫，期待认真的建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T00:05:13.400

我相信从长远的角度来看，向 REST 接口倾斜是很重要的。虽然 JSoup 和/或 WebView 方法肯定会起作用，但以完全不依赖于服务器端的方式灵活地重新定义/设计移动应用程序非常重要。REST 将在那里为您提供帮助，您无需在每次更改 HTML 页面等时赶上服务器端。

如果您的路线图包含，使用 REST 还将有助于将来编写其他移动应用程序，甚至在 iOS 等不同平台上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:51:12.797

您可以使用[jsoup](http://jsoup.org/)从您的 Android 应用程序中解析 html 页面并重新组织网页的信息，此选项将使您能够快速开发应用程序，稍后您可能会考虑将 REST 接口添加到您的网站并在其中填充数据json。如果您不想解析 html 页面，也可以使用 WebView 来加载您的网页。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T08:58:00.250

我建议您使用 REST 架构，如您所说。您可以将 Android 的 REST 客户端库用作[RESTDroid](https://github.com/PCreations/RESTDroid/)，请查看指南，因为有一个实现示例，其中包含使用的特定 Web 服务（本例中为 Parse.com）所需的特殊标头。

# ios - 强大的色彩跟踪与曝光和白平衡变化

> ID：14791240
> 
> 赞同：2
> 
> 时间：2013-02-09T20:28:53.377
> 
> 标签：ios, opencv, image-processing, image-enhancement

当曝光设置和白平衡不断变化时，有没有人有过视频的色彩匹配和逐帧跟踪的经验？

我正在开发使用 iPad 2 前置摄像头捕捉视频的颜色跟踪应用程序。我需要在每一帧上检测彩色对象（我们之前采用的预定义颜色）。我的问题是相机软件喜欢调整 WB 和 Exposure 每一帧。因此，如果我们在 N 帧记住一种颜色，那么在 N+10 帧上，WB 会有所不同，这会导致颜色的巨大差异。

为了计算颜色距离，我使用**LAB**颜色空间和**CIE76**公式： ![在此处输入图像描述](../Images/0dab031a0a5a4a679561b71e4187ff0b.png)

是的，我知道 CIEDE2000 距离函数要好得多，但我正在使用 ARM 处理器，恐怕即使对于我已经使用的 ARM NEON 手动优化的汇编代码，这个公式也会太重。

CIE76 总体上提供了良好的效果，但在光线不佳或非常明亮的场景中，相机要么产生过多的噪点，要么使图像过度饱和，从而使颜色与原始颜色相差太远。除了使用颜色距离的简单阈值化之外，我还根据校准颜色的标准偏差实现了 LAB 像素值的每个分量阈值化。这也提高了检测的正确性，但是，这并不能解决主要问题。

相机本身提供 RGB 颜色空间的帧，但 API 不提供获取当前帧的白点或色温的函数。目前我假设 D50 光源执行 RGB -> LAB 转换。

这是我的主要疑问。**我的想法是计算给定 RGB 图像的白点，然后将其转换为 XYZ 颜色空间，然后使用计算的白点将 XYZ 转换为 LAB。**可能吗？

> **来自维基百科：白点**
> 
> 将颜色表示为 LMS 颜色空间中的三色坐标，可以根据 von Kries 变换简单地通过将 LMS 坐标按两个白点处三色值的最大值之比缩放 LMS 坐标来“转换”对象的颜色。这提供了一个简单但粗略的估计。

[http://en.wikipedia.org/wiki/White_point](http://en.wikipedia.org/wiki/White_point)

这会奏效吗？或者有更好的方法来计算白点（甚至是粗略的）？顺便说一句，我是[Retinex](http://en.wikipedia.org/wiki/Color_constancy)算法出来的，它在阴影中表现出很好的色彩增强，有人用过吗？它的优点和缺点是什么？

# c# - 如何使用 IEnumerable 链接排序器，每个排序器都尊重前一个排序器产生的排序？

> ID：14791242
> 
> 赞同：0
> 
> 时间：2013-02-09T20:29:21.287
> 
> 标签：c#, .net, linq, sorting

基本上，我有一个小程序，我想在对象列表上执行一系列排序。每个排序都应该对对象的不同属性进行操作，并遵守前一个排序产生的排序。这是我到目前为止所拥有的：

```
class Program
{
    static void Main(string[] args)
    {
        List<Person> people = new List<Person>();
        people.Add(new Person { Name = "John",   Age = 43 });
        people.Add(new Person { Name = "Ringo",  Age = 73 });
        people.Add(new Person { Name = "John",   Age = 32 });
        people.Add(new Person { Name = "Paul",   Age = 38 });
        people.Add(new Person { Name = "George", Age = 16 });
        people.Add(new Person { Name = "John",   Age = 80 });
        people.Add(new Person { Name = "Ringo",  Age = 22 });
        people.Add(new Person { Name = "Paul",   Age = 64 });
        people.Add(new Person { Name = "George", Age = 51 });
        people.Add(new Person { Name = "George", Age = 27 });
        people.Add(new Person { Name = "Ringo",  Age = 5 });
        people.Add(new Person { Name = "Paul",   Age = 43 });

        Print(Sort(people));
    }

    static IEnumerable<Person> Sort(IEnumerable<Person> people)
    {
        //order by name first, then order by age
        return people.OrderBy(p => p.Name).OrderBy(p => p.Age);
    }

    static void Print(IEnumerable<Person> people)
    {
        foreach (Person p in people)
            Console.WriteLine("{0} {1}", p.Name, p.Age);
    }

    class Person
    {
        public string Name {get; set;}

        public int Age { get; set; }
    }
} 
```

这会产生以下输出：

```
林戈 5
乔治 16
林戈 22
乔治 27
约翰 32
保罗 38
约翰 43
保罗 43
乔治 51
保罗 64
林戈 73
约翰 80
```

但我希望它产生*这个*输出：

```
乔治 16
乔治 27
乔治 51
约翰 32
约翰 43
约翰 80
保罗 38
保罗 43
保罗 64
林戈 5
林戈 22
林戈 73
```

换句话说，我希望它按 排序`Name`，然后`Age`在每个`Name`“组”中执行本地化排序。显然，`Sort()`我到目前为止的方法并没有这样做，它只是执行两个链式`OrderBy`'s。

我能做到这一点的最好方法是什么`IEnumerable`？理想情况下，我希望解决方案能够扩展和支持尽可能多的链式排序，每个排序都会产生一组“组”，下一个排序器必须将其排序本地化。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T20:39:39.150

尝试使用它应该重新排序而不破坏第一顺序

[http://msdn.microsoft.com/en-us/library/bb534743.aspx](http://msdn.microsoft.com/en-us/library/bb534743.aspx)

```
return people.OrderBy(p => p.Name).ThenBy(p => p.Age); 
```

# java - 我的 JFrame 大小与设置的大小不匹配

> ID：14791246
> 
> 赞同：1
> 
> 时间：2013-02-09T20:29:44.040
> 
> 标签：java, swing, jframe, collision-detection, game-physics

我`frame.setSize(480, 400)`用来设置我的 JFrame 的大小。尽管如此，当我进行一些碰撞检查（我正在制作一个突破游戏）时，球完全离开了屏幕底部，然后最终反弹。这是我正在使用的碰撞代码：`if (YPos + height >= MainClass.height) { YVel = YVel * -1; }`. 静态高度变量设置为 400，并在`frame.setSize`调用中使用。这也发生在我的乒乓球比赛中，尽管我用一些硬设置值修复了它。我不想重复这一点，因为这是不好的做法。

感谢您的任何回复，里斯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:35:29.047

1.  不要设置`frame.setSize(480, 400)`或`frame.setPreferredSize(480, 400)`

2.  绘画使用`JPanel`/ `JComponent`，然后从这个容器返回坐标

3.  默认情况下，在 Swing 中绘画从不返回任何`PreferredSize` [必须覆盖`PreferredSize`的`JPanel`/`JComponent`](https://stackoverflow.com/a/9258934/714968)，（请参阅`dim.width`，`dim.height`此方法返回添加到/的`Object`(s) 的正确坐标，在调整大小之后）`JPanel``JComponent`

4.  然后调用（最后的代码行）`JFrame.pack()`和`JFrame.setVisible(true)`

5.`JFrame`不返回适当的坐标必须与其`Borders`and计算`Toolbar`，而是`ContentPane`返回内部适当的大小

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T20:42:29.957

框架有边框。这些边框位于提供的可用空间内，这意味着内容的可用空间是`frame size - border insets`

相反，设置内容的首选大小并用于`JFrame#pack`计算帧大小

查看

*   [我如何设置在中间？](https://stackoverflow.com/questions/13734069/how-can-i-set-in-the-midst/13734319#13734319)
*   [标题栏中的图形渲染](https://stackoverflow.com/questions/13313084/graphics-rendering-in-title-bar/13316131#13316131)

有关一些示例和更多详细信息

# php - 如何创建带预览的图片上传器

> ID：14791247
> 
> 赞同：0
> 
> 时间：2013-02-09T20:29:45.113
> 
> 标签：php, html, mysql, image, preview

我想要一个包含多个部分的表格。

第一部分是图像，多个文件上传，并在实际上传之前预览图像。

第二部分有各种文本表单域。

我使用 PHP 和 MySQL 构建了第二部分并且可以正常工作，并且图像上传也可以正常工作。但我不知道如何在提交表单之前显示图像预览。

**编辑：**

使用代码形成答案：

```
 <input type='file' onchange="readURL(this);" />
     <img id="blah" src="#" alt="your image" /> 
```

和：

```
function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $('#blah')
                    .attr('src', e.target.result)
                    .width(150)
                    .height(200);
            };

            reader.readAsDataURL(input.files[0]);
        }
    } 
```

效果很好，但它只显示 1 个缩略图。我想为每个文件动态创建一个图像缩略图。

我正在努力 ：

```
function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
          var container = $('#previews');
          var image = $('<img>').attr('src', e.target.result).width(150);
          image.appendTo(container);
            };

            reader.readAsDataURL(input.files[0]);
        }
    } 
```

和：

```
 <input type='file' name="files[]" onchange="readURL(this);" multiple />
    <div id="previews"></div> 
```

哪个有效，但是如何为每个输入的文件循环它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:34:52.057

看看那个：

[http://jsbin.com/uboqu3/1/edit](http://jsbin.com/uboqu3/1/edit)

来自stackoverflow上的这篇文章： [在上传之前预览图像](https://stackoverflow.com/questions/4459379/preview-an-image-before-it-is-uploaded)

卢西安

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:31:16.610

在服务器上有图像之前，您不能显示预览，除非您在界面上使用 java

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T20:38:07.067

您可以使用`HTML5`画布和`FileReader`组件来执行此操作

在这里看看[js fiddle](http://jsfiddle.net/revathskumar/kGYc7/)

# android - 如何在多项选择列表视图中删除选中的项目

> ID：14791248
> 
> 赞同：1
> 
> 时间：2013-02-09T20:29:46.503
> 
> 标签：android, android-listview

如何使用删除的上下文操作删除多项选择列表视图中的选中项目 -

```
ArrayList<String> liveNames = new ArrayList<String>() {
        {
            add("dani");
            add("john");
            add("dave");
            add("alen");
            add("deno");
            add("feliks");
            add("jupi");

        }
    }; 
```

适配器=新的ArrayAdapter（这个，android.R.layout.simple_list_item_multiple_choice，liveNames）；

```
 setListAdapter(adapter); 
```

…………

```
 @Override
        public boolean onActionItemClicked(ActionMode mode, MenuItem item) {
            lv = getListView();
            // Respond to clicks on the actions in the CAB
            switch (item.getItemId()) {
                case R.id.item1:
                    if(lv.getCheckedItemCount() > 0){
                        removeItems = lv.getCheckedItemIds();
                        deleteSelectedItems(removeItems);
                    }
                    mode.finish(); // Action picked, so close the CAB
                    return true;

                default:
                    return false;
            }
        } 
```

现在我应该如何在 deleteSelectedItems(long[] delItms) 方法中实现它，以便在“名称”ArrayList 中删除 ListView 中选定的项目 ID。请给一些提示

我知道我可以更新适配器列表

```
adapter.notifyDataSetChanged(); 
```

但是如何使用它们的 ID 获取列表视图中项目的位置，这样我就可以

```
name.remove(position) - but I have only the IDs. 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T20:40:07.217

我猜这个方法应该为你解决问题：

```
/* returns item's position in ArrayList by ID */
public int getItemPositionById(int id)
{
   for(int i = 0; i < names.size(); i++) {
      if(names.get(i).getId() == id) {
         return i;   // if found item with specified id, return it's position
      }
   }
   return -1;        // didn't find item with specified id
} 
```

只需为您拥有的所有 id 调用它并将这些位置存储在某处即可。然后您可以删除这些位置的所有项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T11:32:58.850

无论如何，我无法使用此方法检索检查的 ID

```
removeItems = lv.getCheckedItemIds(); 
```

因为适配器需要有稳定的 ID ...或类似的东西

所以我试图检索检查项目的位置

```
SparseBooleanArray checkedItemPositions = getListView().getCheckedItemPositions(); 
```

然后删除它们并更新数组列表和适配器

```
 public void removeSelectedItems(){
    int count = lv.getCount();
    SparseBooleanArray checkedItemPositions = getListView().getCheckedItemPositions();
    for (int i=0;i<count;i++){
        if(checkedItemPositions.get(i))

        Log.e("TEST", liveNames.get(i));
        liveNames.remove(i);
    }

    adapter.notifyDataSetChanged();
} 
```

问题是我认为 liveNames ArrayList 每次删除一个元素时都会动态更改其元素索引，因此最终结果会出错。

这是此类问题的讨论链接，但没有解决方案- [如何从多选列表视图中获取所选项目](https://stackoverflow.com/questions/4590856/how-to-get-selected-items-from-multi-select-list-view)

我是如何解决这个问题的：

1.  创建了第二个 ArrayList 实例
2.  用 UNCHECKED 项更新了 ArrayList 实例
3.  将它添加到我的列表适配器 - 这是方法

    ```
    public void removeSelectedItems(){

    updatedList = new ArrayList<String>(); //initialize the second ArrayList

    int count = lv.getCount();  //number of my ListView items
    SparseBooleanArray checkedItemPositions = getListView().getCheckedItemPositions();
    for (int i=0;i < count;i++){
        if(!checkedItemPositions.get(i))

        updatedList.add(liveNames.get(i));  
        Log.e("TEST", liveNames.get(i));
    }

    adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_multiple_choice, updatedList);

    setListAdapter(adapter);} 
    ```

希望它会有所帮助:)

# java - Heroku错误运行播放框架2

> ID：14791249
> 
> 赞同：1
> 
> 时间：2013-02-09T20:30:12.383
> 
> 标签：java, heroku, playframework-2.0

我不知道为什么我的 Heroku 应用程序处于崩溃状态。

日志和代码位于[https://github.com/jstar88/LibreTitan/blob/master/log.txt](https://github.com/jstar88/LibreTitan/blob/master/log.txt)

[在http://libretitan.herokuapp.com/](http://libretitan.herokuapp.com/)运行应用程序

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T07:14:58.540

问题是您的数据库处于不一致状态，因此 Play 想要运行 DOWNS 进化，但您尚未使用`-DapplyEvolutions.default=true`and启动服务器`-DapplyDownEvolutions.default=true`。如果这是一个生产系统，我不建议这样做，直到阅读并完全理解[Play 的演变](http://www.playframework.com/documentation/2.1.0/Evolutions)是如何工作的，因为 DOWNS 可能会对您的数据造成破坏性更改。文档可以在这里找到：

[http://www.playframework.com/documentation/2.1.0/Evolutions](http://www.playframework.com/documentation/2.1.0/Evolutions)

由于您在 Heroku 上运行，因此请务必进行设置`evolutions.use.locks=true`，以便如果您扩展到多个测功机，进化仍然有效。

# c++ - C++ 套接字服务器仅响应 localhost 请求，而不响应网络上的其他请求

> ID：14791250
> 
> 赞同：0
> 
> 时间：2013-02-09T20:30:15.513
> 
> 标签：c++, sockets

奇怪的。我可以使用本地机器上包含的代码发出 GET 请求，它就像一个魅力。从本地机器命令行，使用`GET -Ue 192.168.2.106:8129`我得到

```
200 OK
Content-Length: 296
Content-Type: text/html
Client-Date: Sat, 09 Feb 2013 20:26:09 GMT
Client-Response-Num: 1

<html><body><h1>Directory</h1><a href=/.>.</a><br/><a href=/..>..</a><br/><a href=/bldg.jpg>bldg.jpg</a><br/><a href=/hello.txt>hello.txt</a><br/><a href=/world.gif>world.gif</a><br/><a href=/index.html>index.html</a><br/><a href=/testing>testing</a><br/><a href=/favicon.ico>favicon.ico</a><br/> 
```

从我得到的远程机器那里

```
200 OK
Content-Length: 328
Content-Type: text/html
Client-Aborted: die
Client-Date: Sat, 09 Feb 2013 20:25:16 GMT
Client-Response-Num: 1
X-Died: read failed: Connection reset by peer at /usr/share/perl5/LWP/Protocol/http.pm line 414. 
```

第二个看起来想要工作，但不稳定的“X-Died”标题很奇怪。我偷偷怀疑我的 GetLine 方法已关闭，但我不太确定。知道什么可能导致这个问题吗？

主功能：

```
int main(int argc, char* argv[])
{
    // First set up the signal handler
    struct sigaction sigold, signew;

    signew.sa_handler = handler;
    sigemptyset(&signew.sa_mask);
    sigaddset(&signew.sa_mask, SIGPIPE);
    signew.sa_flags = SA_RESTART;
    sigaction(SIGPIPE, &signew, &sigold);

    int     hSocket,hServerSocket;  /* handle to socket */
    struct  hostent* pHostInfo;     /* holds info about a machine */
    struct  sockaddr_in Address;    /* Internet socket address stuct */
    int     nAddressSize=sizeof(struct sockaddr_in);
    char    pBuffer[BUFFER_SIZE];
    int     nHostPort;

    q = new myQueue();

    // THREAD POOL!
    pthread_t thread_id[NUMTHREADS];
    int i=0;
    for(i=0; i < NUMTHREADS; i++)
    {
        threadParams param;
        param.a = i;
        pthread_create(&thread_id[i], 0, &WorkerHandler, NULL);
    }

    if(argc < 2)
    {
        printf("\nUsage: server host-port\n");
        return 0;
    }
    else
    {
        nHostPort = atoi(argv[1]);
    }

    printf("\nStarting server");
    printf("\nMaking socket");

    /* make a socket */
    hServerSocket=socket(AF_INET,SOCK_STREAM,0);

    if(hServerSocket == SOCKET_ERROR)
    {
        printf("\nCould not make a socket\n");
        return 0;
    }

    /* fill address struct */
    Address.sin_addr.s_addr=INADDR_ANY;
    Address.sin_port=htons(nHostPort);
    Address.sin_family=AF_INET;

    printf("\nBinding to port %d",nHostPort);

    int optval = 1;
    setsockopt(hServerSocket, SOL_SOCKET, SO_REUSEADDR, &optval, sizeof(optval));

    /* bind to a port */
    if(bind(hServerSocket,(struct sockaddr*)&Address,sizeof(Address)) == SOCKET_ERROR)
    {
        printf("\nCould not connect to host\n");
        return 0;
    }

    /*  get port number */
    getsockname( hServerSocket, (struct sockaddr *) &Address,(socklen_t *)&nAddressSize);
    printf("opened socket as fd (%d) on port (%d) for stream i/o\n",hServerSocket, ntohs(Address.sin_port) );

    printf("Server\n\
             sin_family        = %d\n\
             sin_addr.s_addr   = %d\n\
             sin_port          = %d\n"
             , Address.sin_family
             , Address.sin_addr.s_addr
             , ntohs(Address.sin_port));

    /* establish listen queue */
    if(listen(hServerSocket, 1000) == SOCKET_ERROR)
    {
        printf("\nCould not listen\n");
        return 0;
    }

    while(1)
    {
        int socket = accept(hServerSocket, (struct sockaddr*)&Address, (socklen_t *)&nAddressSize);
        q->enqueue(socket);
    }
}

void handler (int status)
{
} 
```

处理套接字上的请求：

```
int handleRequest(int socket)
{
    cout << "handling a request..." << endl;

    // Get the URL
    char * line = GetLine(socket);

    //char * line = "GET /bldg.jpg HTTP/1.1";
    char * url;
    url = strtok(line, " "); // Splits spaces between words in str
    url = strtok(NULL, " "); // Splits spaces between words in str

    // build filename
    ostringstream fullpathstream;
    fullpathstream << dirpath << url;
    string fullpath = fullpathstream.str();

    //Use the stat function to get the information
    struct stat fileAtt;
    if (stat(fullpath.c_str(), &fileAtt) != 0) //start will be 0 when it succeeds
    {
        cout << "File not found:" << fullpath.c_str() << endl;
        writeError(socket);
        return 0;
    }

    // Make correct filetypes
    if (S_ISREG (fileAtt.st_mode))
    {
        printf ("%s is a regular file.\n", fullpath.c_str());

        char * contentType;
        if(strstr(url, ".jpg"))
        {
            cout << "JPEG" << endl;
            contentType = "image/jpg";
        }
        else if(strstr(url, ".gif"))
        {
            contentType = "image/gif";
            cout << "GIF" << endl;
        }
        else if(strstr(url, ".html"))
        {
            contentType = "text/html";
            cout << "HTML" << endl;
        }
        else if(strstr(url, ".txt"))
        {
            cout << "TXT" << endl;
            contentType = "text/plain";
        }
        else if(strstr(url, ".ico"))
        {
            cout << "ICO" << endl;
            contentType = "image/ico";
        }
        serveFile(fullpath, socket, fileAtt.st_size, contentType);
    }

    if (S_ISDIR (fileAtt.st_mode))
    {
        printf ("%s is a directory.\n", fullpath.c_str());
        serveDirectory(socket, url);
    }

    return 0;
}; 
```

GetLine 函数用于获取请求的第一行，因此我知道请求的 URL：

```
// Read the line one character at a time, looking for the CR
// You dont want to read too far, or you will mess up the content
char * GetLine(int fds)
{
   char tline[MAX_MSG_SZ];
   char *line;

   int messagesize = 0;
   int amtread = 0;
   while((amtread = read(fds, tline + messagesize, 1)) < MAX_MSG_SZ)
   {
       if (amtread > 0)
           messagesize += amtread;
       else
       {
           perror("Socket Error is:");
           fprintf(stderr, "Read Failed on file descriptor %d messagesize = %d\n", fds, messagesize);
           exit(2);
       }
       //fprintf(stderr,"%d[%c]", messagesize,message[messagesize-1]);
       if (tline[messagesize - 1] == '\n')
           break;
   }
   tline[messagesize] = '\0';
   chomp(tline);
   line = (char *)malloc((strlen(tline) + 1) * sizeof(char));
   strcpy(line, tline);
   //fprintf(stderr, "GetLine: [%s]\n", line);
   return line;
} 
```

我发生了多线程，这就是我关闭套接字的地方。

```
void * WorkerHandler(void *arg)
{
    threadParams* params = (threadParams*)arg;
    while(1)
    {
        int socket = q->dequeue();
        handleRequest(socket);
        if(close(socket) == SOCKET_ERROR)
        {
            printf("\nCould not close socket\n");
            return 0;
        }
    }
} 
```

# java - 在 QT 中重写 Java 方法 draw()

> ID：14791251
> 
> 赞同：0
> 
> 时间：2013-02-09T20:30:32.470
> 
> 标签：java, qt, porting

我有方法`draw(Graphics g)`

```
public void draw(Graphics g){
    switch(id){
        default:
            System.out.println("Please enter a valid id in contructor");
            break;
        case 1:
            g.setColor(Color.WHITE);
            g.fillRect(paddle.x, paddle.y, paddle.width, paddle.height);
            break;
        case 2:
            g.setColor(Color.LIGHT_GRAY);
            g.fillRect(paddle.x, paddle.y, paddle.width, paddle.height);
            break;
    }
} 
```

如何为 QT 重写它？或者我应该改用什么方法（就像`keyReleased(KeyEvent e)`Java中的方法`keyReleaseEvent(QKeyEvent *e)`在QT中一样）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:38:26.027

这取决于你在画什么。

如果您正在绘制 a `QWidget`，则可能是`QWidget::paintEvent()`

如果你在画 a `QGraphicsItem`，它应该是 a`QGraphicsItem::paint()`

此外，这些方法采用不同类型的参数。它可以分别是a`QPaintEvent`或a `QPainter`。请参考相应的文档

# java - 通过使用 Java 使用 dom 或 sax 复制元素（包括子元素）来创建巨大的 xml 文件的最佳方法

> ID：14791253
> 
> 赞同：0
> 
> 时间：2013-02-09T20:30:37.047
> 
> 标签：java, xml, dom, sax, stax

我有一个 xml 文件（ABC.xml），我只需要复制

```
<Transaction>...</Transaction> 
```

多次（超过 100000 次）保持 Header 和 Trailer 完整，创建最终大小可能高达 1GB 的 NEW.xml。此外，我必须按顺序为每笔交易增加 Uniqueid。

作为 xml 的新手，我一直在寻找最好的方法，但我很困惑。谁能帮助我最好的方法（使用DOM或SAX）和一些代码。你也可以给我一些关于它的链接。

```
ABC.xml
========
<?xml version="1.0" encoding="UTF-8"?>
<Header><Datetime><date>20130209</date><Time>01:12</Time></Datetime></Header>
<Transaction>
    <Uniqueid>1230001</Uniqueid>
<Affiliate>
    <Name>abc</Name>
    <Address>
        <line1>aaaa</line1>
        <line2>bbbb</line2>
        <line3>cccc</line3>
    </Address>
    <Amount>123.00</Amount>
    <Currency>USD</Currency>
    <Purpose>
        <line1>aaaa</line1>
        <line2>bbbb</line2>
        <line3>cccc</line3>
    </Purpose>
</Affiliate>
</Transaction>
<Trailer><TotalTransactions>1</TotalTransactions><TotalAmount>123<TotalAmount>    </Trailer>

NEW.xml
=======
<?xml version="1.0" encoding="UTF-8"?>
<Header><Datetime><date>20130209</date><Time>01:12</Time></Datetime></Header>
<Transaction>
<Uniqueid>1230001</Uniqueid>
<Affiliate>
    <Name>abc</Name>
    <Address>
        <line1>aaaa</line1>
        <line2>bbbb</line2>
        <line3>cccc</line3>
    </Address>
    <Amount>123.00</Amount>
    <Currency>USD</Currency>
    <Purpose>
        <line1>aaaa</line1>
        <line2>bbbb</line2>
        <line3>cccc</line3>
    </Purpose>
</Affiliate>
</Transaction>
<Transaction>
<Uniqueid>1230002</Uniqueid>
<Affiliate>
    <Name>abc</Name>
    <Address>
        <line1>aaaa</line1>
        <line2>bbbb</line2>
        <line3>cccc</line3>
    </Address>
    <Amount>123.00</Amount>
    <Currency>USD</Currency>
    <Purpose>
        <line1>aaaa</line1>
        <line2>bbbb</line2>
        <line3>cccc</line3>
    </Purpose>
</Affiliate>
</Transaction>
<Trailer><TotalTransactions>2</TotalTransactions><TotalAmount>246<TotalAmount></Trailer> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T23:54:27.090

如果您的源 XML 格式正确会有所帮助 - 它需要一个外部包装器元素。

Java 中有许多可用的 XQuery 处理器，例如 Saxon。只需执行查询

```
<doc>{doc/Header, for $i in 1 to 100000 return doc/Transaction, doc/Footer}</doc> 
```

在提供的输入文档上，假设`<doc>`为外部包装元素。

# c# - 如何检查列表长度是否大于上次？

> ID：14791254
> 
> 赞同：-4
> 
> 时间：2013-02-09T20:30:59.723
> 
> 标签：c#

我有这个代码：

```
int LRLength = LR.Count;
            for (int i = 0; i < LR.Count; i++)
            {
                LRLength = LR.Count;
                LR = merge(LR);
                if (LR.Count < LRLength)
                {
                    LR = merge(LR);
                    if (LR.Count == LRLength)
                    {
                        break;
                    }
                }
            } 
```

这是函数合并：

```
private List<Lightnings_Extractor.Lightnings_Region> merge(List<Lightnings_Extractor.Lightnings_Region> Merged)
        {
            List<Lightnings_Extractor.Lightnings_Region> NewMerged = new List<Lightnings_Extractor.Lightnings_Region>();
            Lightnings_Extractor.Lightnings_Region reg;
            int dealtWith = -1;
            for (int i = 0; i < Merged.Count; i++)
            {
                if (i != dealtWith)
                {

                    reg = new Lightnings_Extractor.Lightnings_Region();

                    if (i < Merged.Count - 1)
                    {

                        if (Merged[i].end + 1 >= Merged[i + 1].start)
                        {
                            reg.start = Merged[i].start;
                            reg.end = Merged[i + 1].end;
                            NewMerged.Add(reg);
                            dealtWith = i + 1;
                        }
                        else
                        {
                            reg.start = Merged[i].start;
                            reg.end = Merged[i].end;
                            NewMerged.Add(reg);
                        }
                    }
                    else
                    {

                        reg.start = Merged[i].start;
                        reg.end = Merged[i].end;
                        NewMerged.Add(reg);

                    }
                }
            }
            return NewMerged;
        } 
```

在这个类中：Lightnings_Extractor.Lightnings_Region 我只有两个 int 变量。这个函数的想法是获取一个列表并合并一致的区域。

例如，一旦我调用该函数并且列表 LR 长度为 8，现在我会少取回它。例如，如果需要将两个索引合并为一个，那么我将得到的列表返回长度为 7。如果需要合并另一个索引，那么长度将为 6，依此类推。

我想检查上面的第一个代码是什么时候应该停止调用函数来合并索引。

如果长度是 8 并且下一次它仍然是 8 ，那么什么都不做停止循环。如果长度为 8，下一次为 7，则再次调用该函数。如果长度为 7，则停止循环。但如果长度为 6，请再次调用它。

直到最后的长度与之前的长度相同！！！

所以我尝试了这段代码，但效果不佳：

```
int LRLength = LR.Count;
                for (int i = 0; i < LR.Count; i++)
                {
                    LRLength = LR.Count;
                    LR = merge(LR);
                    if (LR.Count < LRLength)
                    {
                        LR = merge(LR);
                        if (LR.Count == LRLength)
                        {
                            break;
                        }
                    }
                } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:51:06.730

尝试对您要完成的工作做出一些假设。下面将基本捕获列表的原始长度进行比较。它将至少运行一次，并一直运行直到 LRLength == LR.Count

```
int LRLength = LR.Count;
do{ 
    LR = merge(LR); 
} while(LR.Count != LRLength); 
```

如果您尝试运行循环，直到连续两次获得相同的计数：

```
int prevCount;
do{
    prevCount = LR.Count;
    LR = merge(LR); 
} while(prevCount != LR.Count); 
```

# xcode - 如何在屏幕上触摸特定次数后创建动作？

> ID：14791255
> 
> 赞同：0
> 
> 时间：2013-02-09T20:31:03.817
> 
> 标签：xcode, touch, save, screen

我正在制作一个必须保存屏幕的应用程序，例如屏幕截图，当屏幕被点击或触摸特定次数时。我已经尝试了其他用户建议的与我的问题相关的所有解决方案，但没有任何帮助......

我会感谢所有建议。：） 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:53:38.683

以下博客文章很好地解释了用于识别连续多次点击的内置选项（并解释了缺点）：[Detecting tap and double-tap with Gesture Recognizers](http://iphonedevsphere.blogspot.com/2010/09/detecting-tap-and-double-tap-with.html)。

如果您需要比内置手势识别器提供的更多自定义逻辑，您将实现自己的自定义子类，`UIGestureRecognizer`或者将您的逻辑添加到点击输入的`UIResponder`（超类`UIViewController`，`UIView`等）回调中：`touchesBegan:withEvent:`，`touchesMoved:withEvent:`, 和`touchesEnded:withEvent:`.

我对后一种方法有更多经验（不是`UIGestureRecognizer`）。`UITouch`传递给各种回调的事件`UIResponder`每个都包含有关触摸位置和触摸时间的信息。您可以将此信息与 a 结合使用，`NSTimer`以确定用户是否在一定时间内轻按两次（或更多次）。如果计时器在第二次（或`n`第一次触摸）之前触发，那么您可以将其视为单次触摸事件。

我不知道这是否是最好的方法，但它肯定比内置的`UIGestureRecognizer`s 为您提供更精细的控制。

# python - Python：如何对文本文件中的数字求和

> ID：14791256
> 
> 赞同：0
> 
> 时间：2013-02-09T20:31:04.690
> 
> 标签：python, python-2.7

如何在python中对文本文件中的数字求和？假设我们有一些具有如下数字的文本文档：

```
320
5203
5246 
```

我们希望 python 打开该文件并将这些数字相加得到结果：10769。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:37:25.837

如果文件不是太大，您可以将文件读入数组，使用列表推导将行转换为整数列表，然后计算总和：

```
sum([int(s.strip()) for s in open('foo.txt').readlines()]) 
```

但是，这会将整个文件读入内存。如果您的文件很大，那么以命令式方式累积总和可能会减少内存密集型：

```
result = 0
for s in open('foo.txt'): result += int(s.strip()) 
```

或者作为生成器表达式，以便列表不需要存储在内存中

```
sum(int(s.strip()) for s in open('foo.txt')) 
```

# php - Composer 和 packagegist - 如何避免恶意代码注入

> ID：14791258
> 
> 赞同：1
> 
> 时间：2013-02-09T20:31:51.443
> 
> 标签：php, security, composer-php, code-injection, packagist

是否有任何机制可以确保上传到 packagist.org 的包没有恶意代码。是否有人查看已安装/上传的软件包中的源代码。

例如：如果有人上传了具有主要功能的包并将我的配置文件发送到外部服务器怎么办？

当安装包很容易，比如在 composer.json 中添加一行时，我有点担心会发生上述情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:38:08.223

这就是开源软件的福与祸。您通常可以检查整个源代码。这意味着任何人都很难包含恶意代码并使其未被检测到，尽管这并不是针对它的完全保险。衡量包装周围的氛围，有多少人在使用它，问题跟踪器中的评论或票证说什么。

归结为：不要使用您不信任的软件。通过自己评估或相信社区已经这样做来信任它。

# asp.net - 查询 sql 数据库

> ID：14791262
> 
> 赞同：0
> 
> 时间：2013-02-09T20:32:00.057
> 
> 标签：asp.net

请帮忙查询

我的`Student_Master Table`：-

```
ID Name  
1  AAA
2  BBB  
3  CCC
4  DDD

My Student Details Table

ID MastID Address
1   1     Address 1   
2   2     Address 2 
```

现在我有一个绑定到学生主表的网格视图，现在我想在我的网格视图中调用一个自定义列，以便“具有地址状态的学生应该是“地址存在”并且地址不存在于表中的学生对他们来说，状态将是“地址不存在”，例如。

```
ID Name  Status
1  AAA   Address Present
2  BBB   Address Present 
3  CCC   Address NOT Present  
4  DDD  Address NOT Present 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:38:20.890

尝试这个：

```
SELECT
    M.ID, 
    M.Name,
    CASE WHEN D.Id IS NULL
         THEN 'Address NOT Present'
         ELSE 'Address Present'
    END Status
FROM Master M
    LEFT JOIN Details D
        ON M.Id = D.MastID 
```

# wpf - 父母衡量孩子的大小

> ID：14791263
> 
> 赞同：-1
> 
> 时间：2013-02-09T20:32:00.710
> 
> 标签：wpf, wpf-controls

我正在编写一个自定义面板，我想知道如何告诉我的孩子，当他们需要重新测量时，他们的父母也应该进行重新测量。

例如，其中一个孩子改变了它的宽度，父母也应该再次重新测量，导致他的父母也做重新测量，然后他的父母和他父母的父母等等..就像上升`VisualTree`. 我怎么做？

这是面板的测量代码..但是如何告诉父母也重新测量

```
protected override Size MeasureOverride(Size availableSize)
{
 double x;
 double y;
 var children = this.InternalChildren;
 for (int i = 0; i < children.Count; i++)
     {
       UIElement child = children[i];
       child.Measure(new Size(double.PositiveInfinity, double.PositiveInfinity);
       y += child.DesiredSize.Height;
       x = Math.Max(x, child.DesiredSize.Width);
      }
 return new Size(x, y);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:49:49.067

看看这个在左上角排列子元素的非常简单的自定义面板：

```
public class MyPanel : Panel
{
    protected override Size MeasureOverride(Size availableSize)
    {
        Trace.TraceInformation("MeasureOverride");

        var size = new Size();

        foreach (UIElement element in InternalChildren)
        {
            element.Measure(availableSize);

            size.Width = Math.Max(size.Width, element.DesiredSize.Width);
            size.Height = Math.Max(size.Height, element.DesiredSize.Height);
        }

        return size;
    }

    protected override Size ArrangeOverride(Size finalSize)
    {
        Trace.TraceInformation("ArrangeOverride");

        foreach (UIElement element in InternalChildren)
        {
            element.Arrange(new Rect(element.DesiredSize));
        }

        return finalSize;
    }
} 
```

如果您将它与 Button 子项一起使用，如下所示

```
<local:MyPanel>
    <local:MyPanel>
        <Button Width="100" Height="100" Click="Button_Click"/>
    </local:MyPanel>
</local:MyPanel> 
```

和一个调整按钮大小的 Button_Click 处理程序

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    ((FrameworkElement)sender).Width += 20;
} 
```

您会观察到，在每个按钮上单击都会测量和排列父面板和祖父面板。跟踪输出如下所示：

```
CustomPanelTest.vshost.exe Information: 0 : MeasureOverride
CustomPanelTest.vshost.exe Information: 0 : MeasureOverride
CustomPanelTest.vshost.exe Information: 0 : ArrangeOverride
CustomPanelTest.vshost.exe Information: 0 : ArrangeOverride 
```

因此无需在父面板上调用`Measure`或手动操作。`Arrange`

# javascript - 设置 this 的范围

> ID：14791264
> 
> 赞同：0
> 
> 时间：2013-02-09T20:32:02.353
> 
> 标签：javascript, jquery

嗨，我正在尝试学习使用 jQuery 库 1.9 在 javascript 中以更加面向对象的方式工作。我正处于一个小项目中，我必须更改这个对象的范围。这是我的 html：

```
<div id="contact">
<h2>Contact Me</h2>
<form action="#">
    <ul>
        <li>
            <label for="name">Name: </label>
            <input name="name" id="name">
        </li>

        <li>
            <label for="email">Email Address: </label>
            <input name="email" id="email">
        </li>

        <li>
            <label for="comments">What's Up?</label>
            <textarea name="comments" id="comments" cols="30" rows="10"></textarea>
        </li>
        <li>
            <input type="submit" value="Submit">
        </li>
    </ul>
</form> 
```

这是我的 javascript

```
var contactForm = {
    contact : $('div#contact'),

    init : function(){
        this.contact.hide();
        $('<button></button>' , { 
            text : "Display Contact"
        }).insertAfter('article')
          .on('click' , this.show);
    },

    show : function(){
       $.proxy(contactForm , this)
       this.contact.slideDown();

    }
};

contactForm.init(); 
```

问题出在我的 show 方法上。我知道我可以使用 $.proxy() 设置“this”的范围。但我一定做错了，因为即使在 settign $.proxy 之后，“this”关键字仍然指按钮。

如何使这个“this”关键字引用“contactForm”对象

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:38:00.093

阅读有关代理的文档，它不会更改当前方法中的“this”上下文。proxy 的签名`$.proxy( myFunction, thisVar )`意味着 proxy 将返回该函数`myFunction`，并且当它执行时`myFunction`this 值将引用`thisVar`.

这能解决您的问题吗？

这意味着您想将显示功能更改为：

```
show : function(){
   $.proxy( function(){ this.slideDown() }, contactForm )();

} 
```

这是一个简单的例子，说明它是如何工作的

```
 f = $.proxy( function(){ console.log(this.msg); } , { msg: "hello world" });
 f(); // ==> should log to console "hello world" 
```

这是一个[小提琴，可以看到它的实际效果](http://jsfiddle.net/uZB3A/3/)

您还可以将参数传递给函数。例如：

```
 f = $.proxy( function(msg){ console.log([this,msg]); }, { topic:"my topic" } )
 f("hello world"); 
```

看看[小提琴](http://jsfiddle.net/BKage/)也能看到这个。

最后但并非最不重要的一点是，这是[您的代码按我建议的那样工作的小提琴。](http://jsfiddle.net/Brnv2/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:50:44.080

这应该有效：

```
.on('click', $.proxy(this.show, this)); 
```

并显示：

```
show: function() {
   this.contact.slideDown();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T20:51:46.233

你的错误在这里：

```
.on('click' , this.show) 
```

尽管 this 指的是`this.show`，但它不会将上下文设置为`this`随后`show`作为事件处理程序调用的时间。您有一个函数引用，但它最终与最初包含它的对象分离。

你应该使用：

```
.on('click', $.proxy(this.show, this)) 
```

并从内部删除`$.proxy`呼叫`.show`

请注意，`$.proxy()`它旨在*返回*一个新的函数引用，该引用在调用时将始终具有给定的上下文。*它对当前*函数的上下文没有任何作用。

# css - 位置固定与相对位置

> ID：14791268
> 
> 赞同：0
> 
> 时间：2013-02-09T20:32:23.267
> 
> 标签：css, position, positioning, css-position

我有以下代码：

```
<div class="main">
   <!-- CONTENT --> 
 <div class="tabs">
   <!-- CONTENT --> 
 </div>  <!-- Closing div for .tabs -->
 </div>  <!-- Closing div for .main -->

.tabs{
  position: fixed;
  top:110px;
  left:0px;
  width:40px;
  z-index:999
}
.main{
  overflow: hidden;
  margin: 0 0 100px;
  box-shadow: 0 10px 16px rgba(0,0,0,0.33);
  border-radius: 0px 0px 25px 25px;
  position:relative;
} 
```

据我了解`position:fixed`，总是相对于浏览器窗口而不是包含元素。但是，我希望`.tabs`div 是固定的，但相对于包含的 div。无论如何要固定位置*并*使其相对于包含元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:48:45.577

正如所指出的，这是重复的。然而，所提到的问题假设包含元素的宽度是已知的。如果不是这种情况，您将需要一些 javascript。我在这里做了一个例子：http: [//jsfiddle.net/6TyL4/](http://jsfiddle.net/6TyL4/)

请注意，由于固定基本上将元素从容器中取出，因此容器元素不会调整高度宽度等，因此实际上并不“包含”该元素。

```
$(function(){
    var t = $('.main').position().top;
    var l = $('.main').position().left;
    $('.tabs').css('top', t + 100).css('left', l + 100);
}); 
```

这将使 .tabs 相对于“.main”从顶部和左侧偏移 100px。

# javascript - 将 jQuery parseXml 约束到一定数量的循环

> ID：14791273
> 
> 赞同：0
> 
> 时间：2013-02-09T20:32:42.957
> 
> 标签：javascript, jquery, xml, for-loop, parsexml

我正在使用 jQuery 解析一些 xml 天气信息，但我不知道如何限制此代码仅解析前 7 个天气预报日，xml 中共有 10 个 forecastdays 节点，但我只想显示7\. 我当前的 for 循环使其每个 forecastdays 节点输出 7 次，而不是将其限制为仅循环 7 次。提前致谢。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {
  $.ajax({
  type: 'GET',
  url: 'Poole.xml',
  dataType: 'xml',
  success: parseXml
  });
});

function parseXml(xml) {
    $(xml).find('response forecast simpleforecast forecastdays forecastday').each(function() {
        for (var i=0; i<7; i++) {    
          var weekday = $(this).find("date weekday").text();
          var icon_url = $(this).find("icon_url").text();
          var conditions = $(this).find("conditions").text();
          var high = $(this).find("high celsius").text();
          var low = $(this).find("low celsius").text();
          $('<li><span><strong>' + weekday + '</strong></span><span><img src="' + icon_url + '" width="75" height="75" /></span><span>' + conditions + '</span><span>High ' + high + '&#176;C / Low ' + low + '&#176;C</span></li>').appendTo('#weatherContent');   
        }
    });
}
</script>

<ul id="weatherContent"></ul> 
```

您可以下载我在此处解析的 xml 文件的副本：[http](http://temp-share.com/show/2gFHqr478) ://temp-share.com/show/2gFHqr478 (Poole.xml)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:34:49.193

使用[`:lt()`](http://api.jquery.com/lt-selector/)选择器：

```
$("response forecast simpleforecast forecastdays forecastday:lt(7)", xml)
    .each(function() { ... }); 
```

# php - PHP fork 和处理 MySQL 数据库没有冲突

> ID：14791275
> 
> 赞同：2
> 
> 时间：2013-02-09T20:32:58.423
> 
> 标签：php, mysql, parallel-processing, fork, pcntl

我有一个需要处理的 MySQL 数据库表。处理 3 行大约需要 1 秒（由于我需要为每一行建立 CURL 连接）。因此，我需要分叉 PHP 脚本以获得合理的时间（因为我将处理多达 10,000 行的一批）。

我将一次运行 10-30 个进程，显然我需要一些方法来确保进程不重叠（就它们正在检索和修改的行而言）。

根据我的阅读，有三种方法可以实现这一点。我正在尝试确定哪种方法最适合这种情况。

**选项 1：**开始事务并使用`SELECT ... FOR UPDATE`并限制每个进程的行数。将数据保存到数组中。使用“处理”状态标志更新选定的行。提交事务，然后将选定的行更新为“已完成”状态。

**选项 2：**使用“处理”状态标志和进程 ID 更新一定数量的行。选择该进程 ID 和标志的所有行。像平常一样处理数据。更新这些行并将标志设置为“完成”。

**选项 3：**为每个进程的查询设置一个`LIMIT ... OFFSET ...`子句`SELECT`，以便每个进程都可以使用唯一的行。然后存储行 ID 并`UPDATE`在完成后执行。

我不确定哪个选项最安全。我认为选项 3 似乎很简单，但我想知道有什么方法会失败吗？选项2似乎也很简单，但我不确定是否由于锁定`UPDATE`导致一切变慢。选项 1 似乎是最好的选择，但我对`FOR UPDATE`交易不是很熟悉，可以使用一些帮助。

**更新：**为清楚起见，我目前只有一个文件 process.php，它选择所有行并通过 Curl 将数据一一发布到第三方。我想在这个文件中有一个 fork，所以 10,000 行可以分成 10-30 个子进程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T05:38:36.227

另一种处理方式是将需要处理的 id 放入 redis 队列（列表）中。然后，您可以从列表中弹出/推送项目。当 len(list) 为空时，您知道没有任何东西需要处理。

还有一个 php resque 项目，它将实现一些你想做的工作排队。

[https://github.com/chrisboulton/php-resque](https://github.com/chrisboulton/php-resque)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T16:45:23.123

我最终使用 mult_curl 函数（由 Brad 提出）来完成这项任务。我使用 array_chunk() 将行数组分成 100 个组，然后配置一个 multi_curl 任务来处理它们。我开始使用 ParallelCurl，但最终没有正常工作，所以我自己编写了 mult_curl。

处理 10,000 个 curl 连接需要将近 2 个小时，而现在只需几分钟。

# multithreading - 线程：为什么必须将所有用户线程映射到内核线程？

> ID：14791278
> 
> 赞同：43
> 
> 时间：2013-02-09T20:33:25.077
> 
> 标签：multithreading, concurrency, operating-system

所以这里真的有两个问题。首先，（是的，我已经搜索过了，但想要澄清一下），用户线程和内核线程有什么区别？仅仅是一个由用户程序生成，另一个由操作系统生成，后者可以访问特权指令吗？它们在概念上是相同的还是线程本身存在实际差异？

其次，我的问题的真正问题是：我正在使用的书说“用户线程和内核线程之间必须存在关系”，然后列出了这种关系的不同模型。但是这本书未能清楚地解释**为什么**用户线程**必须始终**映射到特定的内核线程。为什么是这样？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-02-09T20:42:25.200

*内核线程*是由操作系统维护的线程对象。它是一个能够被处理器调度和执行的实际线程。通常，内核线程是具有权限设置、优先级等的重量级对象。内核线程调度程序负责调度内核线程。

用户程序也可以制作自己的线程调度程序。他们可以创建自己的“线程”并模拟上下文切换以在它们之间切换。但是，这些线程不是内核线程。每个用户线程实际上不能独立运行，用户线程运行的唯一方法是，如果内核线程实际上被告知执行用户线程中包含的代码。也就是说，用户线程比内核线程有很大的优势。它们可以更轻量级，因为它们不一定需要有自己的优先级，可以由单个进程管理（可能有更好的关于何时需要运行哪些线程的信息），并且不会创建很多出于安全和锁定目的的内核对象。

用户线程必须与内核线程相关联的原因是用户线程本身只是用户程序中的一堆数据。内核线程是系统中的真正线程，因此用户线程要取得进展，用户程序必须让其调度程序获取用户线程，然后在内核线程上运行它。用户线程和内核线程之间的映射不必是一对一的（1:1）；您可以让多个用户线程共享同一个内核线程（一次只有一个用户线程运行），并且您可以拥有一个在 1 : n 映射中跨不同内核线程轮换的用户线程。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-01-23T06:11:14.753

我认为一个真实世界的例子会消除混乱，所以让我们看看在 Linux 中是如何完成的。

首先Linux不区分进程和线程，可以调度的实体在Linux中称为任务，用`task_struct`. 因此，每当您执行`fork()`系统调用时，`task_struct`都会创建一个新的来保存与新任务相关的数据（或指针）。

## 所以在 Linux 世界中，内核线程意味着一个`task_struct`对象。

因为调度程序只知道这些可以分配给不同 CPU（逻辑或物理）的实体。换句话说，如果您希望 Linux 调度程序安排您的进程，您必须创建一个`task_struct`.

用户线程是由某些**执行环境（从现在开始的EE）**（例如JVM）在内核之外支持和管理的东西。这些 EE 将为您提供一些创建新线程的功能。

## 但是为什么用户线程必须始终映射到特定的内核线程。

假设您使用 EE 创建了一些线程。最终它们必须由 CPU 执行，从上面的解释我们知道线程必须有一个`task_struct`才能分配给某个 CPU。这就是映射必须存在的原因。EE 的职责是创建`task_structs`.

如果您的 EE 使用多对一模型，那么它将只`task_struct`为所有线程创建一个模型，并将所有这些线程调度到该模型上`task_struct`。将其想象为有一个 CPU ( `task_struct`) 和许多进程（在 EE 中创建的线程），您的操作系统（EE）将在单个 CPU 上多路复用这些进程。

如果它使用一对一模型，那么`task_struct`在 EE 中创建的每个线程都会有一个模型。因此，当您在 EE 中创建新线程时，`task_struct`会在内核中创建相应的线程。

Windows 做的事情不同（进程和线程不同），但总体思路保持不变，内核线程是 CPU 调度程序考虑分配的实体，因此用户线程必须映射到相应的内核线程（如果您希望 CPU 执行它们）。

# java - 使用 joda time 播种然后比较

> ID：14791280
> 
> 赞同：2
> 
> 时间：2013-02-09T20:33:45.537
> 
> 标签：java, datetime, jodatime

我正在尝试为 Joda-Time 创建一个种子点。我想要实现的是，我将`datetime`在 Joda-Time 中提供一个种子，这应该生成两个不同的随机数`datetime`，例如`datetime1`之前的`datetime2`，这`datetime`将只为种子点的特定小时生成值。

例如

```
time- 18:00:00  followed by date-2013-02-13

Random1 - 2013-02-13 18:05:24 

Random2 - 2013-02-13 18:48:22 
```

时间从一个 DB 接收，日期由用户选择。我需要以指定格式随机生成的两次 可以看到只有分秒会改变，其他都不会修改。

这可能吗？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:32:10.407

下面的代码应该做你想做的事。如果种子时间中的分钟或秒可能不为零，则应在方法调用后添加[.withMinuteOfHour(0)](http://joda-time.sourceforge.net/apidocs/org/joda/time/DateTime.html#withMinuteOfHour%28int%29) [.withSecondOfMinute(0) 。](http://joda-time.sourceforge.net/apidocs/org/joda/time/DateTime.html#withSecondOfMinute%28int%29)`.parseDateTime(inputDateTime)`

```
import java.util.Random;
import org.joda.time.DateTime;
import org.joda.time.format.DateTimeFormat;
import org.joda.time.format.DateTimeFormatter;

public class RandomTime {

DateTimeFormatter inputFormat = DateTimeFormat.forPattern("HH:mm:ss yyyy-MM-dd");
DateTimeFormatter outputFormat = DateTimeFormat.forPattern("yyyy-MM-dd HH:mm:ss");

public TwoRandomTimes getRandomTimesFromSeed(String inputDateTime) {
    DateTime seed = inputFormat.parseDateTime(inputDateTime);
    Random random = new Random();
    int seconds1 = random.nextInt(3600);
    int seconds2 = random.nextInt(3600 - seconds1);

    DateTime time1 = new DateTime(seed).plusSeconds(seconds1);
    DateTime time2 = new DateTime(time1).plusSeconds(seconds2);
    return new TwoRandomTimes(time1, time2);
}

public class TwoRandomTimes {
    public final DateTime random1;
    public final DateTime random2;

    private TwoRandomTimes(DateTime time1, DateTime time2) {
        random1 = time1;
        random2 = time2;
    }

    @Override
    public String toString() {
        return "Random1 - " + outputFormat.print(random1) + "\nRandom2 - " + outputFormat.print(random2);
    }
}

public static void main(String[] args) {
    RandomTime rt = new RandomTime();
    System.out.println(rt.getRandomTimesFromSeed("18:00:00 2013-02-13"));
}
} 
```

在这个解决方案中，第一个随机时间确实用作第二个随机时间的下限。另一种解决方案是只获取两个随机日期，然后对它们进行排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:41:48.963

我可能会选择以下内容：

```
final Random r = new Random();
final DateTime suppliedDate = new DateTime();
final int minute = r.nextInt(60);
final int second = r.nextInt(60);

final DateTime date1 = new DateTime(suppliedDate).withMinuteOfHour(minute).withSecondOfMinute(second);
final DateTime date2 = new DateTime(suppliedDate).withMinuteOfHour(minute + r.nextInt(60 - minute)).withSecondOfMinute(second + r.nextInt(60 - second)); 
```

假设这`suppliedDate`是您数据库中的日期。然后，您根据种子时间生成两个具有随机分钟和秒数的新时间。您还将通过更改计算的随机数的范围来保证第二次在第一次之后。

# c++ - 通过 FLASCC 从 C++ 到 Actionscript

> ID：14791281
> 
> 赞同：4
> 
> 时间：2013-02-09T20:33:48.197
> 
> 标签：c++, actionscript-3, gesture-recognition, flascc

我希望从熟悉 C++ 和 Actionscript 的任何人那里得到一些反馈。不幸的是，我不是 C++ 编码员。

我正在使用 AIRKinect 框架开发 Kinect 应用程序。不幸的是，这个框架的一个限制是缺乏任何有用的手势检测算法。

我遇到了这个用 C++ 构建的手势识别库。 [http://www.nickgillian.com/wiki/pmwiki.php?n=GRT.FAQ](http://www.nickgillian.com/wiki/pmwiki.php?n=GRT.FAQ)

还有 Flash C++ 交叉编译器（以前称为 Alchemy） [http://gaming.adobe.com/technologies/flascc/](http://gaming.adobe.com/technologies/flascc/)

我想知道是否可以将此手势识别库转换为 swc（Flash 格式）以便我可以将它与 AIRKinect 一起使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:56:45.383

这是可能的。

> FlasCC 使用带有自定义 LLVM 后端的 LLVM-GCC 4.2 版本，该后端生成能够在 Flash 运行时中运行的 ActionScript 字节码。更具体地说，字节码在 ActionScript 虚拟机 (AVM) 中运行。这使您可以将任意 C/C++ 代码编译为托管字节码格式，从而能够在 Mac、Windows 或 Linux 上的 Flash 运行时内高性能执行

更多信息请阅读 FlasCC 文档：[FlasCC](http://www.adobe.com/devnet-docs/flascc/README.html)

如果你想下载 FlasCC。重新加入此站点（Adobe 更名）：[https ://creative.adobe.com/apps?trial=GAME&promoid=KBYQD](https://creative.adobe.com/apps?trial=GAME&promoid=KBYQD)

并单击下载。![在此处输入图像描述](../Images/d7de31e90ac07b19045a8cda2694e2e8.png)

重定向到这个网站。下载 Flascc 工具。 ![在此处输入图像描述](../Images/3dd5e677936334ac5d31799d3d9f97fd.png)

# node.js - 如何在第三方 node.js 模块中隐藏调试消息？

> ID：14791284
> 
> 赞同：0
> 
> 时间：2013-02-09T20:34:07.813
> 
> 标签：node.js, debugging, node-modules, nodemailer

我正在使用`nodemailer`npm 模块，它引用了`mailcomposer`npm 模块，而后者又引用了`mime`npm 模块。`process.env.DEBUG`如果为真，mime 模块会输出一堆丑陋、垃圾邮件的调试消息。

是的，我想要调试消息，但仅适用于我的代码。如何阻止 mime 模块输出自己的调试消息？

在需要模块之前，我尝试将`process.env.DEBUG`（mime 模块查看的）设置为`false`正确`nodemailer`，但它似乎不会影响 mime 模块的状态。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:46:21.943

您是否尝试过覆盖 process.stdout.write 函数？

像这样的东西：

```
var log = process.stdout.write;
process.stdout.write = function (){}; 
```

然后，当你需要输出一些东西时：

```
log ("my message to console"); 
```

# enthought - 如何将 /Library/Frameworks/Python.frameowork/Versions/7.3/bin 符号链接到 /usr/local

> ID：14791292
> 
> 赞同：0
> 
> 时间：2013-02-09T20:35:01.477
> 
> 标签：enthought

有没有办法让所有的`packages/folders/etc`in`/Library/Frameworks/Python.framework/Versions/7.3/bin`符号链接到`/usr/local`使它像其他 python 安装一样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T15:06:26.707

尝试

```
ln -s  source-directory  destination-directory 
```

# php - 尝试删除 HTML 中的脚本标签

> ID：14791299
> 
> 赞同：0
> 
> 时间：2013-02-09T20:35:43.443
> 
> 标签：php, javascript, html, dom, tags

我正在尝试使用 PHP 从 HTML 中删除脚本标签，但如果 javascript 中有 HTML，它就不起作用。

例如，如果脚本标签包含如下内容：

```
function tip(content) {
        $('<div id="tip">' + content + '</div>').css 
```

它将停止，`</div>`脚本的其余部分仍将被考虑在内。

这是我用来删除脚本标签的方法：

```
foreach ($doc->getElementsByTagName('script') as $node)
{
    $node->parentNode->removeChild($node);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:53:28.680

一些基于正则表达式的预处理怎么样？

示例`input.html`：

```
<html>
  <head>
    <title>My example</title>
  </head>
  <body>
    <h1>Test</h1>
    <div id="foo">&nbsp;</div>
    <script type="text/javascript">
      document.getElementById('foo').innerHTML = '<span style="color:red;">Hello World!</span>';
    </script>
  </body>
</html> 
```

脚本标签删除 php 脚本：

```
<?php

    // unformatted source output:
    header("Content-Type: text/plain");

    // read the example input file given above into a string:
    $input = file_get_contents('input.html');

    echo "Before:\r\n";
    echo $input;
    echo "\r\n\r\n-----------------------\r\n\r\n";

    // replace script tags including their contents by ""
    $output = preg_replace("~<script[^<>]*>.*</script>~Uis", "", $input);

    echo "After:\r\n";
    echo $output;
    echo "\r\n\r\n-----------------------\r\n\r\n";

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-03T07:04:47.830

你可以使用[`strip_tags`](http://php.net/manual/en/function.strip-tags.php)函数。您可以在其中允许`HTML`您希望允许的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-03T07:16:20.287

我认为这是“此时此地”的问题，你不需要什么特别的东西。只需执行以下操作：

```
$text = file_get_content('index.html');
while(mb_strpos($text, '<script') != false) {
$startPosition = mb_strpos($text, '<script');
$endPosition = mb_strpos($text, '</script>');
$text = mb_substr($text, 0, $startPosition).mb_substr($text, $endPosition + 7, mb_strlen($text));
}
echo $text; 
```

只为类似“mb_”的函数设置编码

# javascript - 为什么我需要在 JavaScript 中冻结一个对象？

> ID：14791302
> 
> 赞同：43
> 
> 时间：2013-02-09T20:35:59.870
> 
> 标签：javascript, immutability

我不清楚何时有人需要`Object.freeze`在 JavaScript 中使用。MDN 和 MSDN 在有用时不会给出现实生活中的示例。我知道在运行时更改此类对象的尝试**意味着崩溃**。问题是，我什么时候会欣赏这次崩溃？

对我来说，不变性是一种设计时间约束，应该由类型检查器来保证。

那么在动态类型语言中出现运行时崩溃还有什么意义呢？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-09T20:38:42.657

该`Object.freeze`函数执行以下操作：

*   使对象不可扩展，因此无法向其添加新属性。
*   将对象的所有属性的可配置属性设置为 false。当-configurable 为false 时，属性属性不能更改，也不能删除。
*   将对象的所有数据属性的可写属性设置为 false。当 writable 为 false 时，无法更改数据属性值。

那是**什么**部分，但**为什么**有人会这样做呢？

好吧，在面向对象的范式中，存在这样一种观念，即现有 API 包含某些不打算在当前上下文之外扩展、修改或重用的元素。各种语言中的`final`关键字是最合适的类比。即使在未编译并因此容易修改的语言中，它仍然存在，即 PHP，在这种情况下是 JavaScript。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-09T20:43:26.180

当您有一个表示逻辑上不可变数据结构的对象时，您可以使用它，尤其是在以下情况下：

*   更改对象的属性或更改其“鸭子类型”可能会导致应用程序其他地方出现不良行为
*   该对象类似于可变类型或看起来是可变的，并且您希望在尝试更改它而不是获得未定义的行为时警告程序员。

作为 API 作者，这可能正是您想要的行为。例如，您可能有一个内部缓存的结构，它表示您通过引用提供给 API 用户的规范服务器响应，但仍在内部用于各种目的。您的用户可以引用此结构，但更改它可能会导致您的 API 具有未定义的行为。在这种情况下，您希望在您的用户尝试修改它时引发异常。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-08-09T16:21:16.667

在我的 nodejs 服务器环境中，我使用冻结的原因与使用“使用严格”的原因相同。如果我有一个我不想被扩展或修改的对象，我会冻结它。如果有东西试图扩展或修改我的冻结对象，我希望我的应用程序抛出错误。

对我来说，这与一致、高质量、更安全的代码有关。

此外， [Chrome 在处理冻结对象时表现出显着的性能提升。](http://jsperf.com/freeze-vs-seal-vs-normal/21)

编辑：在我最近的项目中，我在政府实体之间发送/接收加密数据。有很多配置值。我正在为这些值使用冻结的对象。修改这些值可能会产生严重的不良副作用。此外，正如我之前链接的那样，Chrome 显示了冻结对象的性能优势，我认为 nodejs 也是如此。

为简单起见，示例如下：

```
var US_COIN_VALUE = {
        QUARTER: 25,
        DIME: 10,
        NICKEL: 5,
        PENNY: 1
    };

return Object.freeze( US_COIN_VALUE ); 
```

没有理由修改此示例中的值。并享受速度优化带来的好处。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-09-12T07:26:34.523

`Object.freeze()`主要用于**函数式编程（不变性）**

**不变性**是函数式编程的核心概念，因为没有它，程序中的数据流是有损的。状态历史被遗弃，奇怪的错误可能会潜入您的软件。

在 JavaScript 中，重要的是不要将`const`, 与不变性混淆。`const`创建一个变量名绑定，创建后不能重新分配。`const`不创建不可变对象。您无法更改绑定引用的对象，但您仍然可以更改对象的属性，这意味着使用创建的绑定`const`是可变的，而不是不可变的。

不可变对象根本无法更改。您可以通过深度冻结对象来使值真正不可变。JavaScript 有一种方法可以**将对象冻结到一级深度**。

```
const a = Object.freeze({
 foo: 'Hello',
 bar: 'world',
 baz: '!'
}); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-06-20T06:31:38.100

在[V8 版本 v7.6](https://v8.dev/blog/v8-release-76#frozen%2Fsealed-array-improvements)中，冻结/密封阵列的性能得到了极大的改进。因此，您想要冻结对象的一个​​原因是您的代码对性能至关重要。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-01-13T03:19:52.167

这是一个老问题，但我认为我有一个很好的例子，冻结可能会有所帮助。我今天遇到了这个问题。

* * *

**问题**

```
class Node {
    constructor() {
        this._children = [];
        this._parent = undefined;
    }

    get children() { return this._children; }
    get parent() { return this._parent; }

    set parent(newParent) {
        // 1\. if _parent is not undefined, remove this node from _parent's children
        // 2\. set _parent to newParent
        // 3\. if newParent is not undefined, add this node to newParent's children
    }

    addChild(node) { node.parent = this; }
    removeChild(node) { node.parent === this && (node.parent = undefined); }
    ...
} 
```

如您所见，当您更改父节点时，它会自动处理这些节点之间的连接，使子节点和父节点保持同步。但是，这里有一个问题：

```
let newNode = new Node();
myNode.children.push(newNode); 
```

现在，`myNode`有`newNode`它的`children`，但`newNode`没有`myNode`它的`parent`。所以你刚刚打破了它。

**（题外话）你为什么要暴露孩子呢？**

是的，我可以创建很多方法：countChildren()、getChild(index)、getChildrenIterator()（它返回一个生成器）、findChildIndex(node) 等等......但这真的是比仅仅返回更好的方法吗？一个数组，它提供了一个所有 javascript 程序员都知道的接口？

1.  您可以访问它`length`以查看它有多少个孩子；
2.  您可以通过他们的索引（即）访问孩子`children[i]`；
3.  `for .. of`您可以使用;对其进行迭代。
4.  您可以使用 Array 提供的其他一些不错的方法。

注意：返回数组的副本是没有问题的！它花费线性时间，并且对原始数组的任何更新都不会传播到副本！

* * *

**解决方案**

```
 get children() { return Object.freeze(Object.create(this._children)); }

    // OR, if you deeply care about performance:
    get children() {
        return this._PUBLIC_children === undefined
            ? (this._PUBLIC_children = Object.freeze(Object.create(this._children)))
            : this._PUBLIC_children;
    } 
```

完毕！

1.  `Object.create`：我们创建一个继承自`this._children`（即`this._children`作为它的`__proto__`）的对象。仅此一项就几乎解决了整个问题：
    *   简单快速（恒定时间）
    *   您可以使用 Array 接口提供的任何内容
    *   如果修改返回的对象，它不会改变原来的！
2.  `Object.freeze`：但是，您可以修改返回的对象但更改不影响原始数组的事实对于该类的用户来说非常混乱！所以，我们只是冻结它。如果他尝试修改它，则会引发异常（假设为严格模式），并且他知道他不能（以及为什么）。遗憾的是，`myFrozenObject[x] = y`如果您不在严格模式下，不会抛出异常，但`myFrozenObject`无论如何都没有修改，所以它仍然不那么奇怪。

当然，程序员可以通过访问绕过它`__proto__`，例如：

```
someNode.children.__proto__.push(new Node()); 
```

但我喜欢认为，在这种情况下，他们实际上知道自己在做什么，并且有充分的理由这样做。

**重要提示**：请注意，这对于对象来说效果不佳：在 for .. in 中使用 hasOwnProperty 将始终返回 false。

* * *

**更新：使用[代理](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Proxy)解决对象的相同问题**

只是为了完成：如果你有一个对象而不是一个数组，你仍然可以通过使用代理来解决这个问题。实际上，这是一个通用的解决方案，应该适用于任何类型的元素，但由于性能问题，我建议不要（如果可以避免的话）：

```
 get myObject() { return Object.freeze(new Proxy(this._myObject, {})); } 
```

这仍然返回一个无法更改的对象，但保留它的所有只读功能。如果您真的需要，您可以`Object.freeze`在代理中删除并实现所需的陷阱（set、deleteProperty、...），但这需要额外的努力，这就是`Object.freeze`代理可以派上用场的原因。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-05-11T13:27:18.773

当您可能想要冻结对象时，实际情况是什么？例如，在应用程序启动时，您创建一个包含应用程序设置的对象。您可以将该配置对象传递给应用程序的各个模块。但是一旦创建了该设置对象，您就想知道它不会被更改。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-05-23T09:01:06.600

当您在 JS 中编写库/框架并且您不希望某些开发人员通过重新分配“内部”或公共属性来破坏您的动态语言创建时。这是不变性最明显的用例。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-07-12T16:48:26.837

唯一的实际用途`Object.freeze`是在开发过程中。对于生产代码，冻结/密封对象绝对没有任何好处。

**愚蠢的错别字**

它可以帮助您在开发过程中发现这个非常常见的问题：

```
if (myObject.someProp = 5) {
    doSomething();
} 
```

`myObject`在严格模式下，如果被冻结，这将引发错误。

**执行编码协议/限制**

它还有助于在团队中执行某种协议，尤其是对于可能与其他人没有相同编码风格的新成员。

很多 Java 人喜欢给对象添加很多方法，让 JS 感觉更熟悉。冻结物体会阻止他们这样做。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-09T20:43:32.867

当您使用交互式工具时，我可以看到这很有用。而不是：

```
if ( ! obj.isFrozen() ) {
    obj.x = mouse[0];
    obj.y = mouse[1];
} 
```

你可以简单地做：

```
obj.x = mouse[0];
obj.y = mouse[1]; 
```

仅当对象未冻结时，属性才会更新。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-02-18T21:55:40.177

我可以想到 Object.freeze 会派上用场的几个地方。

第一个可以使用的现实世界实现`freeze`是在开发需要服务器上的“状态”以匹配浏览器中的内容的应用程序时。例如，假设您需要为函数调用添加一定级别的权限。如果您在一个应用程序中工作，那么开发人员可能会在没有意识到的情况下轻松更改或覆盖权限设置（特别是如果对象是通过引用传递的！）。但总的来说，权限永远不会改变，并且在更改时出错是首选。所以在这种情况下，权限对象可能会被冻结，从而限制开发人员错误地“设置”权限。对于类似用户的数据，例如登录名或电子邮件地址，也可以这样说。这些东西可能会被错误的代码错误地或恶意地破坏。

另一个典型的解决方案是在游戏循环代码中。您需要冻结许多游戏状态设置以保持游戏状态与服务器保持同步。

将 Object.freeze 视为使对象成为常量的一种方式。任何时候你想要一个变量常量，你可以有一个冻结的对象常量，出于类似的原因。

有时您希望通过函数和数据传递传递不可变对象，并且只允许使用 setter 更新原始对象。这可以通过克隆和冻结“getters”对象并仅使用“setters”更新原始对象来完成。

这些都是无效的吗？也可以说，由于缺少动态变量，冻结对象可能会更高效，但我还没有看到任何证据。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-02-22T11:08:20.157

不知道这是否有帮助，但我用它来创建简单的枚举。它让我希望不会在数据库中获取 duff 数据，因为我知道数据的来源已被尝试为不可更改，而没有故意尝试破坏代码。从静态类型的角度来看，它允许对代码构造进行推理。

# database-design - 在关系数据库中有循环外键依赖关系可以吗？

> ID：14791309
> 
> 赞同：6
> 
> 时间：2013-02-09T20:36:42.760
> 
> 标签：database-design, foreign-keys, directed-acyclic-graphs

我正在编写代码以将 MySQL 数据库备份到二进制文件中。我知道`mysqldump`但由于某些原因我不能使用琐碎的方法。我目前在做什么：

1.  读取架构定义
2.  按外键依赖对表进行排序
3.  选择所有表中的行（每次 100 行）并将它们写入二进制文件

依赖关系的定义：一个表`T1`依赖于表的存在`T2`当且仅当至少有一个外键`T1`指向`T2`的键。

为每个表分配一个数值。此值指定表的顺序。对于没有依赖关系的表，这个值`0`对于其他表来说是当前表依赖的表的最大值；加一。如果`-1`依赖表的值集合中有 a，则当前表的值保持未定义（`-1`）。所有表的初始值都是`-1`未指定的。

这是 C++ 代码：

```
// tablesQueue: Queue of all tables
// orderedQueue: Resulting order

while(! tablesQueue.isEmpty())
{
    bool satisfied = true;
    foreach(TableNode* parent, tablesQueue.head()->referencedTables)
    {
        if(parent->degreeOfFreedom == -1)
        {
            satisfied = false;
            break;
        }
        else
           // handle error blah blah ... 
    }
    if(satisfied)
    {
        int max =0;
        foreach(TableNode* parent, tablesQueue.head()->referencedTables)
        max = (max < parent->degreeOfFreedom+1) ? 
                  parent->degreeOfFreedom+1 : max;
        tablesQueue.head()->degreeOfFreedom = max;
        orderedQueue.enqueue(tablesQueue.dequeue());
    }
    else
    {
        tablesQueue.enqueue(tablesQueue.dequeue());
    }
} 
```

如果表的依赖图中存在循环，则该算法不会终止。

通常这样的桌子设计可以吗？例如，两个表彼此具有外键。令人惊讶的是，我发现 Oracle 为 MySQL ( `sakila`) 提供的示例数据库有很多这样的循环。我假设可以通过添加第三个表来删除所有循环 [?]

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-09T22:42:41.147

循环依赖相当普遍。一些例子：

*   [实现“邻接列表”](https://stackoverflow.com/a/14671930/533120)层次结构时，表引用自身。
*   ^(实现 1:1 *)关系时，两个表相互引用。
*   相互引用的两个表是 1:N 关系的可能实现之一（其中“N”侧的行之一是“特殊”）。
*   此外，我见过多个表形成“环”的情况......

所以是的，拥有循环依赖是“可以的”。

* * *

^*严格来说，*真正*的1:1 需要延迟约束来解决鸡和蛋问题（MySQL 不支持），否则只能有 1:0..1 或 0..1:0..1 . 但在所有这些情况下，您都有两个相互引用的表。

# css - 如何仅将 css 应用于顶级元素

> ID：14791311
> 
> 赞同：3
> 
> 时间：2013-02-09T20:36:49.920
> 
> 标签：css, css-selectors

在我的 HTML 中，我在单独的部分中有一些页脚元素，然后是页面的一个全局页脚元素。我只想让全局页脚出现在视口的底部。

如果我这样做，它将影响所有页脚：

```
footer {
    position: fixed;
    bottom: 0px;    
} 
```

如果我这样做，它会按预期工作，但`body`语法看起来很糟糕：

```
body > footer {
    position: fixed;
    bottom: 0px;    
} 
```

有没有更好的方法来指定顶级页脚？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-09T20:52:57.197

将一个类添加到您的页脚并将您的 css 应用于该特定类。正如其他人指出的那样，这并没有什么问题`body > footer`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T20:39:10.207

将一个类添加到全局页脚将是最简单的解决方法，或者您可以这样做：

```
body > footer:last-child 
```

# javascript - 带有嵌套对象数组的 Mustache 模板

> ID：14791312
> 
> 赞同：6
> 
> 时间：2013-02-09T20:36:58.897
> 
> 标签：javascript, mustache

可以使用一点帮助来找出我的 Mustache 模板无法正确呈现的原因。我很困惑为什么以下不起作用。我敢肯定这是我的一个小错误或什么的......

```
 var tableRows = [
    {name: 'name1',
     values: ['1','2','3']},
    {name: 'name2',
     values: ['1','2','3']},
    {name: 'name3',
     values: ['1','2','3']}
    ];

var template = $('#mustache-template').html();

$('#target').append(Mustache.render(template, {rows: tableRows})); 
```

HTML 模板：

```
<div id="mustache-template">
    <table>
        <tbody>
              {{#rows}}
                <tr class="">
                  <td>{{name}}</td>
                  {{#values}}
                    <td>{{.}}</td>
                  {{/values}}
                </tr>
              {{/rows}}
        </tbody>
    </table>
</div> 
```

我期待一个表，每个数组项都是它自己的行，但我得到的是：

`[object Object]`

这是一个 jsFiddle 来说明：http: [//jsfiddle.net/gF9ud/](http://jsfiddle.net/gF9ud/)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-09T21:09:07.830

问题是浏览器将您的模板作为无效的表格元素处理。将模板存储在这样的页面上并不是一个好主意，`<script type="text/template">`用于包装它们：

```
<script id="mustache-template" type="text/template">
    <table>
      {{#rows}}
        <tr class="">
          <td>{{name}}</td>
          {{#values}}
            <td>{{.}}</td>
          {{/values}}
        </tr>
      {{/rows}}
    </table>
</script> 
```

[http://jsfiddle.net/zHkW5/](http://jsfiddle.net/zHkW5/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-27T21:03:55.997

我发现的另一个解决方案是像这样注释掉小胡子：

```
<div id="mustache-template">
    <table>
        <tbody>
             <!--  {{#rows}} -->
                <tr class="">
                  <td>{{name}}</td>
                  {{#values}}
                    <td>{{.}}</td>
                  {{/values}}
                </tr>
              <!-- {{/rows}} -->
        </tbody>
    </table>
</div> 
```

对我来说，它完全按照我的希望呈现。我认为浏览器会在标签之间看到代码`tr`。

# javascript - Knockout Js 绑定到具有撤消功能的编辑模式

> ID：14791323
> 
> 赞同：4
> 
> 时间：2013-02-09T20:38:06.573
> 
> 标签：javascript, knockout.js

我正在使用 ko.js 来显示场地表。

每个场地都有一个编辑按钮，它会弹出一个显示可编辑数据的对话框。

当按下编辑按钮时，我将场地绑定到对话框，并将数据的副本存储在撤消对象中。

当我编辑对话框上的字段时，对话框和表格都会更新。

当我取消编辑时，我将场地绑定到撤消对象状态。这会更新对话框，但不会在表上更新。

知道我在这里做错了什么吗？

这是我的视图模型。

```
VenueViewModel = function(venues) {
    var self = this;

    var venueModal = $("#venueModal");
    this.venues = ko.mapping.fromJS(venues);
    this.venue = ko.observable();
    this.venueUndo = null;

    //Cancel an edit                
    this.cancel = function() {
        self.venue(ko.mapping.fromJS(self.venueUndo));
        venueModal.modal("hide");
    }

    //Edit an existing venue
    this.edit = function(venue) {
        self.venue(venue);
        self.venueUndo = ko.mapping.toJS(venue);
        venueModal.modal("show");
    };

    //Create a new venue
    this.create = function() {
        self.venue(new Venue());
        venueModal.modal("show");
    };
};

ko.applyBindings(new VenueViewModel(venues)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-21T21:08:21.770

您可以考虑为此使用[KO-UndoManager](https://github.com/bago/knockout-undomanager)。这是注册视图模型的示例代码：

```
VenueViewModel.undoMgr = ko.undoManager(VenueViewModel, {
  levels: 12,
  undoLabel: "Undo (#COUNT#)",
  redoLabel: "Redo"
}); 
```

然后，您可以在 html 中添加撤消/重做按钮，如下所示：

```
 <div class="row center-block">
    <button class="btn btn-primary" data-bind="
      click: undoMgr.undoCommand.execute, 
      text: undoMgr.undoCommand.name, 
      css: { disabled: !undoMgr.undoCommand.enabled() }">UNDO</button>
    <button class="btn btn-primary" data-bind="
      click: undoMgr.redoCommand.execute, 
      text: undoMgr.redoCommand.name, 
      css: { disabled: !undoMgr.redoCommand.enabled() }">REDO</button>
  </div> 
```

这是一个[Plunkr](http://plnkr.co/edit/nB2129?p=preview)展示它的实际应用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T11:54:00.140

他评论中链接的文章 nemesv 就是答案。

[http://www.knockmeout.net/2013/01/simple-editor-pattern-knockout-js.html](http://www.knockmeout.net/2013/01/simple-editor-pattern-knockout-js.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T21:06:16.540

你像这样设置 Knockout observables：

```
self.venue(ko.mapping.fromJS(self.venueUndo)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-02T13:29:03.037

我们对 Knockout.js 做了一个小扩展，作为扩展 observables 的项目的一部分，因此它们可以注册到不同的历史堆栈。

也许它可以帮助你。

[淘汰赛纪念品](https://github.com/mmjr/Knockout-Memento)

# android - 设置重复警报以自动更新 appwidget listview

> ID：14791325
> 
> 赞同：1
> 
> 时间：2013-02-09T20:38:11.597
> 
> 标签：android, android-widget

Android ICS：使用自定义列表视图创建了一个应用小部件，现在我想定期更新视图，例如每天早上 7 点。我试过`AlarmManager.setRepeating()`了，但没有用。有没有其他方法可以做到这一点？我正在使用`RemoteViewsServices`并`RemoteViewsFactory`为 appwidget 构建视图。

# compiler-construction - 使用clang提取符号表

> ID：14791329
> 
> 赞同：6
> 
> 时间：2013-02-09T20:38:36.167
> 
> 标签：compiler-construction, clang

我正在寻找一种方法来获取 C 程序的符号表。我正在寻找全局和局部变量，以及它们的范围等。

clang 是否有选项或 API 可以转储此信息？或任何其他使此操作变得容易的编译器框架。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:53:04.423

我确信 Clang 有一组接口来提供对符号表信息的访问。我的理解是没有很多文档，所以你只需要检查源代码。

[GCCXML](http://www.gccxml.org/)为顶级定义执行此操作。它不报告函数的内容（例如，你不可能得到本地人）。您获得了 XML，然后您就可以自己动手了。

我们的 DMS Software Reengineering Toolkit 具有针对各种 C 方言的完整解析器，并构建符号表。如果您想转储它们，[well-documented 恕我直言] 符号表 API 提供了简单的方法来枚举成员。通常人们想用这些信息*做*一些事情，比如生成或修改代码。DMS 提供了庞大的基础架构来支持进行更复杂的分析（包括或由该符号表结构驱动）和/或修改代码。

# google-apps-script - 如何为我的所有 Google 电子表格提供一组脚本？

> ID：14791331
> 
> 赞同：3
> 
> 时间：2013-02-09T20:38:43.093
> 
> 标签：google-apps-script, google-sheets

Excel 支持 PERSONAL.XLS 文件的概念，其中包含我的个人脚本，我希望能够在我打开的任何电子表格/工作簿上使用该文件。

我如何在 Google Docs 中做类似的事情，即有一组脚本，无论我打开哪个 Google 电子表格，都会导致 onOpen 事件运行并因此添加我的额外菜单？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T03:55:00.543

您无法在 Google 电子表格中执行此操作。但是最好的做法是

1.  使用您的 onOpen 和其他功能编写一个独立的脚本。
2.  将此作为库发布
3.  在您手动创建的每个电子表格中编写一个 shell onOpen。:( 这个 shell 函数将调用库的 onOpen。

但是，如果您创建具有关联脚本的电子表格副本，则该副本中也将包含该脚本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-23T18:59:38.890

1) 您可以打开您的脚本，然后从“发布”菜单中选择“测试为附加组件”。

2) 现在在“配置新测试”下，您可以选择一个文档，然后为该文档运行插件。

不幸的是，您必须一次为每个文档执行此操作。如果有一种方法可以告诉我的所有电子表格都可以使用脚本，或者至少有一种简单的方法可以在每张工作表的基础上安装个人插件，就像你可以安装插件一样，我会非常喜欢它。从市场开始，有点像个人市场。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-17T15:36:22.970

虽然不推荐，但您也可以使用[AppsScriptApi以编程方式将一组脚本复制到所有其他谷歌电子表格](https://developers.google.com/apps-script/api/reference/rest/v1/projects/create)

# clojure - Clojure :: 获取列表的单个元素，如果列表有超过 1 个元素，则抛出异常

> ID：14791332
> 
> 赞同：7
> 
> 时间：2013-02-09T20:38:46.287
> 
> 标签：clojure

我知道在我的代码中的某个点，一个列表只有一个元素，所以我用

```
(first alist) 
```

但如果列表有多个元素提醒我错误情况，我也希望代码中断。在 Clojure 中实现这一目标的惯用方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-09T22:24:41.457

`first`用一个（或其他诗意命名的）函数替换`only`为您想要做出断言的前提条件：

```
(defn only [x] {:pre [(nil? (next x))]} (first x))

(only [1])
=> 1

(only [1 2])
=> AssertionError Assert failed: (nil? (next x))  user/only (NO_SOURCE_FILE:1) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-13T10:34:18.367

这将在一个包含除一个元素之外的任何元素的集合上爆炸。在惰性序列上也能正常工作。

```
(defn only
 "Gives the sole element of a sequence"
 [coll]
 (if (seq (rest coll))
   (throw (RuntimeException. "should have precisely one item, but had at least 2"))
   (if (seq coll)
     (first coll)
     (throw (RuntimeException. "should have precisely one item, but had 0"))))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T21:13:32.077

我无法立即想到一个简洁、惯用的方法来做到这一点。

选项 1 是没有，因为这有点奇怪。如果您知道应该只有一个元素，为什么它首先在列表中？

选项 2 是有一个，有人会过来告诉你没有看到它:)

也就是说，在您的情况下，我可能会写如下内容：

```
(let [[item & rest] alist]
  (if (nil? rest)
    (throw (IllegalArgumentException. "Expected a single-element list"))
    item)) 
```

可能更简单，您也可以只做`(count alist)`并确保它只有一个项目。不过，上面的代码有一个很好的属性，它不会强制评估超出列表的头部，但取决于您的用例，这可能不是问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-08T21:42:00.203

[Tupelo 库](https://github.com/cloojure/tupelo#extracting-only-values)将此功能定义为核心完整性检查，允许从长度为 1 的向量/列表中“解包”标量值并记录预期结果。定义本身就是简单性：

```
(defn only
  "(only coll)
  Ensures that a sequence is of length=1, and returns the only value present.
  Throws an exception if the length of the sequence is not one.
  Note that, for a length-1 sequence S, (first S), (last S) and (only S) are equivalent."
  [coll]
  (let [coll-seq  (seq coll)
        num-items (count coll-seq)]
    (when-not (= 1 num-items)
      (throw (IllegalArgumentException. (str "only: num-items must=1; num-items=" num-items))))
    (clojure.core/first coll-seq))) 
```

[您可以在SuchWow 库](https://crossclj.info/fun/such.sequences/only.html)和其他地方找到类似的功能。

# numpy - Numpy 安装 Mac Osx Python

> ID：14791335
> 
> 赞同：7
> 
> 时间：2013-02-09T20:39:37.737
> 
> 标签：numpy, python-2.7, terminal, python-idle, nose

我在我的线性代数课程中使用 Python 进行编程。对于我们需要的工具，我正在尝试安装 NumPy。我使用[这个网站](http://math.berkeley.edu/~shaowei/python.html)来指导我完成安装过程。

我从[SciPy 的 OS X 页面](http://www.scipy.org/Installing_SciPy/Mac_OS_X)上的链接开始，最终到达[SourceForge 下载站点](http://sourceforge.net/projects/numpy/files/NumPy/1.6.1/)。

从那里，我选择了 Mac OS X 安装程序`numpy-1.6.1-py2.7-python.org-macosx10.3.dmg`。

当我去空闲并输入

```
>>> import numpy as np 
```

这是我收到的错误：

```
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/numpy/__init__.py", line 137, in <module>
    import add_newdocs
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/numpy/add_newdocs.py", line 9, in <module>
    from numpy.lib import add_newdoc
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/numpy/lib/__init__.py", line 4, in <module>
    from type_check import *
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/numpy/lib/type_check.py", line 8, in <module>
    import numpy.core.numeric as _nx
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/numpy/core/__init__.py", line 5, in <module>
    import multiarray
ImportError: dlopen(/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/numpy/core/multiarray.so, 2): no suitable image found.  Did find:
    /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/numpy/core/multiarray.so: no matching architecture in universal wrapper 
```

我也从终端尝试过，得到了同样的错误。我安装了一个虚拟环境 - 虚拟环境包装器。我通过以下方式调用终端中的环境：

```
source my_new_env/bin/activate 
```

然后我尝试以这种方式在终端中导入 numpy，但随后出现错误：

```
(my_new_env) $ sudo python  -c 'import numpy; numpy.test()'
Traceback (most recent call last):
  File "<string>", line 1, in <module>
ImportError: No module named numpy 
```

我不确定我是否错误地安装了 NumPy，或者我的虚拟环境是否与 Nose 冲突。如果有人有建议，请告诉我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-11-12T00:51:36.260

我会跳过 MacOS 包安装并使用“pip install”说明，因为您已经熟悉 virtualenvs。请改用这些说明：[http ://www.scipy.org/install.html#installing-via-pip](http://www.scipy.org/install.html#installing-via-pip)

使用 virtualenv 和 pip 更容易，这将确保安装后您的 virtualenv 可以访问您已安装的模块。使用您下载的外部包（或 .dmg）需要做更多的工作。不是不可能，只是更多的工作。HTH。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-04T09:54:07.040

试试这些命令：

`brew update`,`brew doctor`

，因为就我而言，我什至不必`numpy`单独安装。`numpy`但是我可以轻松导入。同时你可以尝试从[这个网站](https://sourceforge.net/projects/numpy/files/NumPy/)`numpy`下载包。

# python - 重新排序数组中的值对，使它们按顺序排列

> ID：14791338
> 
> 赞同：1
> 
> 时间：2013-02-09T20:39:39.020
> 
> 标签：python, c, sorting

我正在尝试构建一个解决方案来正确排序一组值对，以便它们以正确的顺序结束。考虑一下 Python 中的这个例子：

```
theArray = [['Dempster St','Main St'],['Dempster St','Church St'],['Emerson St','Church St']] 
```

我需要订购数组，使其最终看起来像这样：

```
theArray = [['Emerson St','Church St'],['Church St','Dempster St'],['Dempster St','Main St']] 
```

一些考虑：

*   不能保证每对中的顺序指向相同的方向。例如：在上面的示例中，第二个数组元素的对的顺序指向与其余元素相反的方向（Dempster 到 Church 而不是 Church 到 Dempster）

*   应该构建代码以便它可以在 Python 和 C 中使用，因此理想情况下应该在没有任何特定于语言的技巧的情况下完成

*   最后，构建最终数组的顺序无关紧要，只要元素遵循正确的顺序即可。例如，下面的解决方案也可以工作：

    `theArray = [['Main St','Dempster St'],['Dempster St','Church St'],['Church St','Emerson St']]`

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:44:54.250

我设法使它工作。我通过使用多个嵌套循环相互迭代每对的每个元素 - 这样我就可以检查它们的唯一性（为了做到这一点，每当一个项目被发现不止一次时，我都会增加一个关联的变量，比如引用计数） ; 最后，计数最少的两个元素是路线的开始和结束。从那里很容易找到剩余的连接。

# haskell - 为什么我会收到 EitherT 类型错误？

> ID：14791340
> 
> 赞同：0
> 
> 时间：2013-02-09T20:39:41.923
> 
> 标签：haskell, heist

当我尝试使用此功能加载我的 Heist (0.11) 模板时：

```
load :: MonadIO n => FilePath -> [(Text, Splice n)] -> IO (HeistState n)
load baseDir splices = do
    tmap <- runEitherT  $ do
        templates <- loadTemplates baseDir
        let hc = HeistConfig [] defaultLoadTimeSplices splices [] templates
        initHeist hc
    either (error . concat) return tmap 
```

我收到此错误：

```
Couldn't match expected type `EitherT e0 m0 t0'
            with actual type `either-3.1:Control.Monad.Trans.Either.EitherT
                                [String] IO Heist.TemplateRepo'
In the return type of a call of `loadTemplates'
In a stmt of a 'do' block: templates <- loadTemplates baseDir
In the second argument of `($)', namely
  `do { templates <- loadTemplates baseDir;
        let hc
              = HeistConfig [] defaultLoadTimeSplices splices [] templates;
        initHeist hc }' 
```

对我来说，`loadTemplate`似乎返回了预期的类型，除了用具体类型填充的类型参数。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:04:12.773

这种情况发生在安装了同一个包的多个版本的情况下。使用 ghc-pkg 删除除一个版本之外的所有`either`软件包，然后重新安装并重试。

我一次又一次地对此感到困惑。当类型正确并且您开始认为这是 GHC 错误时，请检查重复的包。

# linux - crosstool-ng、目录结构和 sysroot

> ID：14791341
> 
> 赞同：7
> 
> 时间：2013-02-09T20:39:43.480
> 
> 标签：linux, crosstool-ng

多亏了 crosstool-ng，我有一个可以工作的交叉编译器工具链 :) -- 然而，crosstool-ng 的文档非常稀少，而且我对交叉编译是全新的。我认为，在这种情况下，特定的主机和目标并不重要。

我有一些关于目录结构的基本问题。工具链安装到以目标命名的目录中。里面是一组目录：

```
arm-unknown-linux-gnueabi
bin
include
lib
libexec
share 
```

我认为这是针对实际的交叉编译器位，因为 bin/ 中的编译器确实为此目的工作。注意里面有一个 arm-unknown-linux-gnueabi/ 目录，即里面的路径是`../arm-unknown-linux-gnueabi/arm-unknown-linux-gnueabi`. 里面还有一棵树：

```
bin
debug-root
include
lib
lib32
lib64
sysroot 
```

lib* 目录是指向 sysroot/ 的符号链接。bin 中的东西似乎与父目录 /bin 中的交叉编译工具集相同：

```
> bin/gcc -v
Using built-in specs.
COLLECT_GCC=./gcc
Target: arm-unknown-linux-gnueabi
Configured with: /usr/x-tool/.build/src/gcc-4.7.2/configure 
--build=x86_64-build_unknown-linux-gnu 
--host=x86_64-build_unknown-linux-gnu 
--target=arm-unknown-linux-gnueabi 
```

所以我的**第一个问题**是：这些是干什么用的？这个目录是干什么用的？

那么我的**第二个问题**是：应该如何使用 sysroot/ ？它显然是用于目标平台原生的支持库，所以*我假设*如果我正在构建这样一个库，我应该将它用作`--prefix`，尽管它与使用父目录相同，因为 lib* 是符号链接的......这个带有 bin 和符号链接到 sysroot 的“中间目录”令人困惑。我相信（某些）autotools 样式的包可以配置为“--with-sysroot”。 **那有什么意义**？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-06-16T12:30:37.830

**对于您的第一个问题**，作为工具链安装目录：

*   bin/arm-unknown-linux-gnueabi-gcc
*   arm-unknown-linux-gnueabi/bin/gcc

它们是相同的，确实是硬链接。

您可以通过 CC=arm-unknown-linux-gnueabi-gcc 使用 arm-unknown-linux-gnueabi-gcc，例如

```
export PATH=<toolchain installed dir>/bin:$PATH
CC=arm-unknown-linux-gnueabi-gcc ./configure 
make 
```

或者

```
export PATH=<toolchain installed dir>/arm-unknown-linux-gnueabi/bin:$PATH
./configure 
make 
```

我总是使用第一种形式，我不确定后一种形式是否有效。

**对于您的第二个问题**，根据我的经验，您无需担心 sysroot。交叉编译器会自动在 sysroot/usr/include 中找到正确的 C 头文件。

除了你想交叉编译一些库并将它们安装到 sysroot 之外，你可以通过

```
export PATH=<toolchain installed dir>/bin:$PATH
CC=arm-unknown-linux-gnueabi-gcc ./configure --prefix=<toolchain installed dir>/arm-unknown-linux-gnueabi/arm-unknown-linux-gnueabi/sysroot
make
make install 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-07-29T10:51:22.803

从 Thomas Petazzoni 的演讲[Anatomy of Cross-Compilation Toolchains](https://www.youtube.com/watch?v=Pbt330zuNPc&t=2671s)的 38:39 开始，演讲者深入介绍了输出目录结构。

# linux - linux脚本测试连接IP

> ID：14791343
> 
> 赞同：0
> 
> 时间：2013-02-09T20:39:54.437
> 
> 标签：linux

知道如何创建脚本以测试与代表默认网关的 IP 的连接性。在连接的情况下，打印消息“默认网关打开”，如果未连接，则显示消息“默认网关关闭”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:46:21.710

```
#!/bin/bash 
ping -c 1 192.168.1.1 2>&1 > /dev/null
if [ $? -ne 0 ]
then 
       echo -e "host does not respond to ping" 
fi 
```

Put this script in crontab and let it run every min or whatever frequency you want.

# ios - 核心图：在 x 轴上显示每日值的年度标签

> ID：14791346
> 
> 赞同：0
> 
> 时间：2013-02-09T20:40:06.903
> 
> 标签：ios, objective-c, cocoa-touch, charts, core-plot

对于我的核心绘图图表中的绘图值，我`NSDate`在 - 轴上显示基于值`x`。这些值涵盖多年，并每天绘制。

我想在`x`-axis 上显示每年或每月的标签，但不是每天。这就是为什么我不能使用 Core Plot 示例应用程序中显示的标记方法的原因`DatePlot`。

目前我正在手动创建标签（如以下代码片段所示）。不幸的是，这个解决方案导致了下面屏幕截图中显示的问题（2001 年的标签与 2002 年太接近了）。

```
[sortedArray enumerateObjectsUsingBlock:  
   ^(Price *priceItem, NSUInteger idx, BOOL *stop) {

NSDateComponents *yearComponents = 
   [gregorian components:NSYearCalendarUnit 
   fromDate:price.dateTime];
NSDateComponents *monthComponents =
   [gregorian components:NSMonthCalendarUnit 
   fromDate:price.dateTime];       
NSInteger year = [yearComponents year];
NSInteger month = [monthComponents month];
if (month != previousMonth) {
   [minorTickLocations addObject:
   [NSDecimalNumber numberWithUnsignedInteger:idx]];
   previousMonth = month;
}
if (year != previousYear) {
   CPTAxisLabel *newLabel = [[CPTAxisLabel alloc] 
   initWithText: [NSString stringWithFormat:@"%u", year]
   textStyle: axisTitleTextStyle];
   newLabel.tickLocation = CPTDecimalFromUnsignedInteger(idx);
   newLabel.offset = x.labelOffset + x.majorTickLength / 2.0;
   [xAxisLabels addObject:newLabel];
   [majorTickLocations addObject:
       [NSDecimalNumber numberWithUnsignedInteger:idx]];
   previousYear = year;
   }
}]; 
```

![在此处输入图像描述](../Images/faddf2f7382cd03b43b3385518af5a8f.png)

我想知道是否有更好的方法来使用标准的 Core Plot 方法对此进行编码。

如果可以使用日期格式化程序行为仅显示年 ( `YYYY`)、月和年 ( `MMM-YYYY`) 或仅显示月 ( `MMM`)，那就太好了。

## 编辑

正如 Eric 在他的帖子中建议的那样，我将日期转换为年份的小数部分，以便能够使用`CPTDateFormatter`. 这就是我设置图表的方式（最初，我只想绘制每个日历年的刻度）：

```
x.labelingPolicy = CPTAxisLabelingPolicyFixedInterval;
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"yyyy"];
CPTCalendarFormatter *calendarFormatter = [[CPTCalendarFormatter alloc]
   initWithDateFormatter:dateFormatter];
calendarFormatter.referenceDate = [sortedPrices[0] 
   valueForKey:@"dateTime"];
calendarFormatter.referenceCalendarUnit = NSYearCalendarUnit;
x.labelFormatter = calendarFormatter; 
```

这就是我如何将基于整数的初始索引转换为基于“年分数”的索引：

```
- (NSArray*)indexArrayOfDatesArray:(NSArray*)dates
{
NSCalendar *gregorian = [[NSCalendar alloc] 
   initWithCalendarIdentifier:NSGregorianCalendar];
NSDate *startDate = [sortedCommonSharePrices[0] valueForKey:@"dateTime"];
NSDateComponents *yearComponents = [gregorian components: NSYearCalendarUnit
   fromDate:startDate];
NSUInteger startYear = yearComponents.year;
NSMutableArray *array = [NSMutableArray arrayWithCapacity:dates.count];
[dates enumerateObjectsUsingBlock:^(NSDate *date, NSUInteger idx, BOOL *stop) {
   NSDateComponents *yearComponents = [gregorian 
        components:NSYearCalendarUnit fromDate:date];
   NSInteger years = [yearComponents year];
   NSUInteger numberOfDaysSinceStartOfYear =
        [gregorian ordinalityOfUnit:NSDayCalendarUnit
         inUnit:NSYearCalendarUnit forDate:date];

   NSUInteger totalNumberOfDaysInYear = 365;

   double fractionOfYear = (double)numberOfDaysSinceStartOfYear /
      (double)totalNumberOfDaysInYear + (double)years - (double)startYear;

   [array addObject:[NSNumber numberWithDouble:fractionOfYear]];
}];    
return array;
} 
```

这似乎工作正常，但似乎有很多代码（关于改进代码的任何想法？）。

## 问题

缩放和平移（使用`plotSpace:willChangePlotRangeTo`）时，我想将 x 轴标签设置为新的日期范围（基于新绘图范围中的天数。但是，我得到不正确的刻度数和错误的标签（请参阅下面的截图）。

我需要如何设置标签参数才能获得正确的标签？

谢谢你的帮助！

代码片段来自`plotSpace:willChangePlotRangeTo`：

```
NSDateComponents *components = [gregorian components:NSDayCalendarUnit 
   fromDate:newStartDate toDate:newEndDate options:0];
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
CPTCalendarFormatter *calendarFormatter = 
   [[CPTCalendarFormatter alloc] initWithDateFormatter:dateFormatter];
calendarFormatter.referenceDate = [sortedPrices[0] valueForKey:@"dateTime"];

if (components.day < 365) {
   dateFormatter.dateFormat = @"ddd-MMM-yyyy";
   calendarFormatter.referenceCalendarUnit = NSDayCalendarUnit;
} else if (components.day < 365 * 2) {
   dateFormatter.dateFormat = @"MMM yyyy";
   calendarFormatter.referenceCalendarUnit = NSYearCalendarUnit;
} else if (components.day < 365 * 4) {
   dateFormatter.dateFormat = @"qqq yyyy";
   calendarFormatter.referenceCalendarUnit = NSYearCalendarUnit;
} else {
   dateFormatter.dateFormat = @"yyyy";
   calendarFormatter.referenceCalendarUnit = NSYearCalendarUnit;
}
CPTXYAxis *x = axisSet.xAxis;
x.preferredNumberOfMajorTicks = 10;
x.majorIntervalLength = CPTDecimalFromDouble(0.1);
x.minorTicksPerInterval = 1;
x.labelFormatter = calendarFormatter; 
```

![错误的刻度和标签](../Images/e5c9dced9212b245fbb48c6f4dbc3aab.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T22:30:27.820

提供您自己的标签政策，如下所示：

```
...
CPTXYAxis *x = axisSet.xAxis;
int totalNumberOfYearsToShow = 3;
int startYear = 2010;
int i = 0;
NSMutableSet *xLabels = [NSMutableSet setWithCapacity:totalRecords];
NSMutableSet *xLocations = [NSMutableSet setWithCapacity:totalRecords];

while (i < totalNumberOfYearsToShow)
{
    NSNumber *xData = [NSNumber numberWithInt:(i + startYear)];
    CPTAxisLabel *label = [[CPTAxisLabel alloc] initWithText:[xData stringValue] textStyle:x.labelTextStyle];
    label.tickLocation = CPTDecimalFromInt([xData intValue]);
    label.offset = x.majorTickLength;

    if (label)
    {
        [xLabels addObject:label];
        [xLocations addObject:xData];
    }

    i ++;
}

x.labelingPolicy = CPTAxisLabelingPolicyNone;
x.axisLabels = xLabels;
x.majorTickLocations = xLocations;
... 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T14:06:29.743

> 我无法使用 Core Plot 示例应用程序 DatePlot 中显示的标记方法。

为什么不？使用固定间隔标签策略，只需将 设置`majorIntervalLength`为相当于一年并使用`CPTCalendarFormatter`or`CPTTimeFormatter`来格式化标签。

# algorithm - 线段旅行的面试题

> ID：14791348
> 
> 赞同：5
> 
> 时间：2013-02-09T20:40:13.927
> 
> 标签：algorithm

这是我遇到的一个有趣的问题：

假设在长度为 的数轴上`M`，`0 < M <= 1,000,000,000`您给出了`N`( `1 < N <= 100,000`) 个整数对点。在每一对中，第一个点表示对象当前所在的位置，第二个点表示对象应移动的位置。（请记住，该点`second`可能*小于*`first`）。

现在，假设您从该点开始`0`并且有一个可以容纳`1`物体的手推车。您希望将所有对象从它们的初始位置移动到它们各自的最终位置，同时沿着数轴移动最短距离（*而不是*位移）。你必须结束在点`M`。

现在，我一直在尝试将这个问题简化为一个更简单的问题。老实说，我什至想不出一个蛮力（*可能是*贪婪的）解决方案。然而，我的第一个想法是将向后运动退化为两个向前运动，但这似乎并不适用于所有情况。

我`3`在![在此处输入图像描述](../Images/a293c3789929f9936cdcde16b04a557f.png)

第一个测试用例的答案是`12`。`red`首先，您在 点拿起物品`0`。然后移动到点`6`（距离 = `6`），暂时放下`red`物品，然后拿起`green`物品。然后您移动到点`5`(distance = `1`) 并放下该`green`项目。然后你回到点`6`(distance = `1`) 并捡起`red`你放下的物品，移动到点 9 (distance = `3`)，然后移动到点`10`(distance = `1`) 完成序列。

行驶的总距离为`6 + 1 + 1 + 3 + 1 = 12`，这是可能的最小距离。

`12`我相信其他两个案例的答案是。但是，我找不到解决它的一般规则。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:36:29.187

[这就是不对称旅行商问题](http://en.wikipedia.org/wiki/Traveling_salesman_problem)。你可以把它想象成一个图表。边将是每个（开始，完成）对，每个（0，开始）和所有其他（完成，开始）对。

假设 NP!=P，它将有一个指数的预期运行时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:05:16.867

假设你有这些动作`(a, b), (c, d), (e, f), ...`，那么你必须走的最小距离是`abs(b - a) + abs(d - c) + abs(f - e) + ...`，而你实际走的距离是`abs(b - a) + abs(c - b) + abs(d - c) + abs(e - d) + ...`。
基本上，给定一系列移动，关键是通过交换元素来最小化“旅行距离”功能。如果您将特定组合视为一个节点，并且您可以从它获得的所有组合作为边，您可以使用许多使用启发式的图形搜索算法之一。一个例子是[束搜索](http://en.wikipedia.org/wiki/Beam_search)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T20:55:05.330

可能是我误解了这个问题，但以下情况如何：

1.  按当前位置的对的第一个数字对对进行排序
2.  沿线将元素交换到正确的位置（您有一个临时变量）

它已排序的事实保证您不会来回移动元素以将它们放置在正确的位置（无论该行是否表示为数组或列表）

**@templatetypedef 注释后更新：**
使用 a`HashTable`存储所有对。使用每对的当前位置作为索引键。
在对上使用第二个索引。

```
 1\. Get next pair according to index from the line.
 2\. If current pair exists in hashtable then place element to its target location.  
    2.a Remove pair from hashtable.  
    2.b Make current pair the target location. Then go to step 1  
 ELSE 
        Increment current index until you get a pair present in the hashtable. Go to step 2 
```

# c - 对受我系统字节序影响的单个整数进行 fread

> ID：14791349
> 
> 赞同：2
> 
> 时间：2013-02-09T20:40:34.387
> 
> 标签：c, file, endianness

我目前正在研究一些任意值的二进制文件格式，包括一些字符串和字符串长度值，它们存储为`uint32_t`'s.

但我想知道，如果我将字符串长度写入`fwrite`小端系统上的文件，并在大端系统上从同一个文件中读取该值，`fread`字节的顺序会反转吗？如果是这样，解决这个问题的最佳做法是什么？

编辑：肯定有一些 GNU 功能可以为我做这件事，并且已经使用、测试和验证了 20 年？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T21:00:49.060

是的，`fwrite`并且`fread`在整数上使您的文件格式无法移植到另一个字节序，正如其他答案正确说明的那样。

作为最佳实践，我完全*不鼓励任何有条件的字节翻转和字节序测试*。确定*文件格式*的字节顺序，而不是写入和读取*字节*，并通过 ORing 和移位从它们中生成整数。

换句话说，[我同意 Rob Pike](http://commandcenter.blogspot.ru/2012/04/byte-order-fallacy.html)在这个问题上的看法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T20:41:33.437

> 如果我使用 fwrite 将字符串长度写入 little-endian 系统上的文件，并在 big-endian 系统上使用 fread 从同一个文件中读取该值，字节的顺序是否会反转？

是的。 `fwrite`简单地将内存内容以线性顺序写入文件。 `fread`只是以线性顺序从文件读取到内存。

> 解决这个问题的最佳做法是什么？

决定您的文件的顺序。然后编写包装函数来向/从文件中写入和读取整数。在此函数中，如果您在具有相反顺序的系统上，则有条件地翻转字节顺序。

（这里有[很多](https://stackoverflow.com/search?q=%5Bc%5D+determine+endianness)关于确定系统字节序的问题。）

> 当然必须有一些 GNU 功能来为我做这件事

标准库中什么都没有。但是，POSIX 为此定义了一堆函数：[`ntohl`、`htonl`等](http://linux.die.net/man/3/htonl)。它们通常用于网络传输，但同样可以用于文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-09T20:42:51.517

是的，它会，因为`fread()`对~~战争~~原始字节进行操作。如果内存中的字节顺序不同，文件中的字节顺序也会不同。

> 如果是这样，解决这个问题的最佳做法是什么？

检测系统的字节序，如果它与文件格式的字节序不匹配，则翻转字节。

```
int is_little_endian()
{
    uint32_t magic = 0x00000001;
    uint8_t black_magic = *(uint8_t *)&magic;
    return black_magic;
}

uint32_t to_little_endian(uint32_t dword)
{
    if (is_little_endian()) return dword;

    return (((dword >>  0) & 0xff) << 24)
         | (((dword >>  8) & 0xff) << 16)
         | (((dword >> 16) & 0xff) <<  8)
         | (((dword >> 24) & 0xff) <<  0);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-12T15:27:04.983

Linux 提供

htobe16, htole16, be16toh, le16toh, htobe32, htole32, be32toh, le32toh, htobe64, htole64, be64toh, le64toh - 在主机和大/小端字节顺序之间转换值

[ [https://linux.die.net/man/3/le32toh]](https://linux.die.net/man/3/le32toh])

# php - header('location:index.php') 在第一次运行时不起作用

> ID：14791350
> 
> 赞同：0
> 
> 时间：2013-02-09T20:41:00.993
> 
> 标签：php, session, header, location, href

我有一个 index.php 页面，里面设置了一个会话（$_SESSION['expire']）。此会话应在 30 分钟后取消设置，我们应重定向到 index.php（再次验证用户）。

我的 index.php 代码的一部分：

```
<?php
session_start();
//if user name and password are valid do the following:
$_SESSION['start'] = time(); 
$_SESSION['expire'] = $_SESSION['start'] + (30 * 60) ;
?>

<a href="index.php?action=ContentManager">
    content 
</a>

<?php    
if(isset($_REQUEST['action']))

{
    //if the expiration time has not reached yet do the following
    $now=time();
    if (isset($_SESSION['expire']) && ($now<= $_SESSION['expire'])) 
    {
        switch($_REQUEST['action'])
        {
            case 'ContentManager' : 
              include('model/content.php');
              $contents = getContent($conn, ' where 1=1');
              include('view/contentmanager.php');
              break;
        }
    }

    else if($now > $_SESSION['expire'])
    {
        unset($_SESSION['expire']);
        session_destroy();
        header('location:index.php');
       exit();
    }   
}
?> 
```

问题是，当我在 30 分钟后单击 contentmanager 链接时，我们将重定向到带有 url 的空页面： index.php?action=contentmanager

只有当我再次刷新页面时，我们才会重定向到 index.php 本身并出现登录表单。

简而言之：我必须刷新页面两次才能重定向到正确的页面。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:46:27.043

利用`ob_start();`

```
<?php
session_start();
ob_start();
//if user name and password are valid do the following:
$_SESSION['start'] = time(); 
$_SESSION['expire'] = $_SESSION['start'] + (30 * 60) ;
?>

<a href="index.php?action=ContentManager">
    content 
</a>

<?php    
if(isset($_REQUEST['action']))

{
    //if the expiration time has not reached yet do the following
    $now=time();
    if (isset($_SESSION['expire']) && ($now<= $_SESSION['expire'])) 
    {
        switch($_REQUEST['action'])
        {
            case 'ContentManager' : 
              include('model/content.php');
              $contents = getContent($conn, ' where 1=1');
              include('view/contentmanager.php');
              break;
        }
    }

    else if($now > $_SESSION['expire'])
    {
        unset($_SESSION['expire']);
        session_destroy();
        header('location:index.php');
       exit();
    }   
}
ob_end_flush();
?> 
```

# asp.net - 将多项目 MVC4 解决方案部署到 Azure 失败

> ID：14791352
> 
> 赞同：1
> 
> 时间：2013-02-09T20:41:08.093
> 
> 标签：asp.net, asp.net-mvc, git, deployment, azure

这是我第二次部署到 Azure。首先是一个带有数据库的简单 MVC4 网站，我通过 git 部署了它。像魅力一样工作。

现在我得到了以下内容： 一个包含三个项目的解决方案。

*   Web -> 哪个是 MVC4 前端
*   模型 -> 包含模型和数据库上下文
*   后端 -> 用于数据管理的 MVC4 项目

所有项目都是 MVC4（不知道如何更好地管理 Models 项目）。在我的模型项目中，我正在运行代码适配迁移。后端在虚拟目录中运行：localhost:80/Backend（在 localhost 上完美运行） Web 和 Backend 项目都引用了 Models 项目。

文件夹结构：解决方案文件夹包含： *Web / Models / Backend / MySolution.sln*

第一次部署时，我在 Projects 文件夹中创建了一个 git repo（因为它是一个项目）。现在我的仓库在解决方案文件夹中。

我还在后端上传文件并通过以下路径将其移动到另一个项目（Web）：

```
Directory.GetParent(HttpContext.Current.Server.MapPath("~")).ToString() + DirSeperator + "Web" + DirSeperator + "Store" + DirSeperator; 
```

这会在 Azure 上出现问题吗？

**所以我现在的问题是，我如何部署这个解决方案？**

* * *

我在 Azure 中创建了一个带有源代码控制的网站，并向其中添加了一个 SQL 数据库。

我已设法将解决方案推送到 Azure，但在 Azure 上有消息

> 找到解决方案......没有可部署的项目。而是部署文件。

现在。

* * *

关于这个问题，你有什么好的教程吗？

我做错了吗？（我认同）

我对 ASP.NET 和 Azure 比较陌生，所以我有点难以理解。

谢谢，托比

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:35:43.810

**后续编辑：**我现在看到，这与配置 2 个项目部署有关。您将需要创建部署脚本

我没有做研究，但看看这些帖子：

[http://blog.amitapple.com/post/38419111245/azurewebsitecustomdeploymentpart3](http://blog.amitapple.com/post/38419111245/azurewebsitecustomdeploymentpart3)

[http://kellyhpdx.wordpress.com/2012/04/11/deploying-multiple-web-applications-to-a-single-azure-instance-and-applying-web-config-transforms-correctly/](http://kellyhpdx.wordpress.com/2012/04/11/deploying-multiple-web-applications-to-a-single-azure-instance-and-applying-web-config-transforms-correctly/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T09:31:11.453

**我设法解决了我的问题。** 抱歉，我正在回答我自己的问题 - 希望这不会冒犯任何人。

Azure 网站无法实现我想要实现的目标，而 Web 角色则无法实现。如在[CloudCover](http://channel9.msdn.com/Shows/Cloud+Cover/Cloud-Cover-Episode-37-Multiple-Websites-in-a-Web-Role)和[StructureTooBig](http://blog.structuretoobig.com/post/2012/01/17/One-Azure-Web-Role-Multiple-Websites.aspx)上所见。

因此，我在 Visual Studio 中创建了一个新的 Azure 云应用程序（由 Azure 工具提供），具有默认的 Web 角色，这是我的 Web 前端项目。我已将一个名为“后端”的 VirtualApplication 添加到 Web 角色，并将物理目录设置为我的后端项目路径。然后我添加了一个 VirtualDirectory“存储”，我可以从两个项目中访问它以进行文件上传。

我的 WebRole 现在看起来像这样：

```
<WebRole name="MvcWebRole1" vmsize="ExtraSmall">
<Sites>
  <Site name="Web" physicalDirectory="[projectpath]">
    <VirtualApplication name="backend" physicalDirectory="[projectpath]">
    </VirtualApplication>
    <VirtualDirectory name="store" physicalDirectory="[projectpath]">
    </VirtualDirectory>
    <Bindings>
      <Binding name="Endpoint1" endpointName="Endpoint1" />
    </Bindings>
  </Site>
</Sites>
<Endpoints>
  <InputEndpoint name="Endpoint1" protocol="http" port="80" />
</Endpoints>
<Imports>
  <Import moduleName="Diagnostics" />
  <Import moduleName="RemoteAccess" />
  <Import moduleName="RemoteForwarder" />
</Imports> 
```

我现在通过以下方式访问（读+写）商店：

```
HttpContext.Current.Request.MapPath("/Store" + DirSeperator); 
```

代替

```
Directory.GetParent(HttpContext.Current.Server.MapPath("~")).ToString() + DirSeperator + "Web" + DirSeperator + "Store" + DirSeperator; 
```

这在这两个项目上都非常有效。

所以，这个解决方案有效，我已经将它部署到生产中！

**新出现的问题：**

*   网站使用*git*集成，但云服务不会（这对我的工作流程非常不利）。
*   部署大约需要 30-45 分钟。圣...
*   我不得不再次发布所有内容以激活远程访问和 WebDeploy 功能。我希望，WebDeploy 将节省部署更新的时间......因为每次我现在更新时，完整的解决方案都会在服务器上被替换（在提到的时间跨度内）。
*   有没有办法通过 FTP 访问数据？

再见

# python - Python：导入 graphutil 模块

> ID：14791353
> 
> 赞同：0
> 
> 时间：2013-02-09T20:41:11.870
> 
> 标签：python, python-2.7

我正在修改一个导入 graphutil 模块的旧 python 代码。但是我无法找到模块的源包并将其安装在 ubuntu 上。在这个方向上的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T00:47:51.430

我怀疑是这样，但 pywafo 中有一个[文件](https://code.google.com/p/pywafo/source/browse/trunk/pywafo/src/wafo/graphutil.py?spec=svn64&r=64)可能已为您的项目解除。这是我能找到的最好的。

# syntax-highlighting - QML 中的 Qt5 语法高亮

> ID：14791360
> 
> 赞同：16
> 
> 时间：2013-02-09T20:41:45.497
> 
> 标签：syntax-highlighting, qml, qt5, qtquick2

我正在做一个`QtQuick 2.0`演示文稿，我想嵌入一些代码示例。是否可以轻松创建语法突出显示 QML 元素。

有问题的目标是将语法突出显示应用于 a`TextEdit`或 a `TextArea`。我知道 Qt 有 a `QSyntaxHighlighter`，但文档不是很清楚如何将它应用到 a`TextEdit`或 a `TextArea`。

你能举例说明它是如何完成的吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-11-14T10:00:10.337

Qt Quick 的`TextEdit`项目公开了一个`textDocument`类型为 的属性`QQuickTextDocument`。这是明确公开的，因此您可以`QSyntaxHighlighter`直接与文档一起使用。

[QtQuick textEdit 文档 Qt 5.3](http://qt-project.org/doc/qt-5/qml-qtquick-textedit.html#textDocument-prop)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-07-12T04:38:13.463

我有两个答案：

1.  一个纯粹的 QML 答案
2.  一个涉及 QSyntaxHighlighter 的 C++ 答案

对于纯 QML 答案，我们可以使用`TextArea`一个可以`textFormat: TextEdit.RichText`用于格式化的。我们可以使用`TextArea::getText()`获取纯文本并设置`TextArea::text`富文本。这是一个模拟示例：

*   将大写标识符（例如按钮）颜色为紫色
*   将小写标识符（例如 xyz）着色为红色
*   颜色编号（例如 123 456）为蓝色
*   但将符号（例如 = + ;）保留为黑色

这是片段：

```
 TextArea {
        id: output

        property bool processing: false

        text: "<p>x = 123;</p><p>y = 456;</p><p>z = x + y;</p>"
        textFormat: TextEdit.RichText
        selectByMouse: true

        onTextChanged: {
            if (!processing) {
                processing = true;
                let p = cursorPosition;
                let markUp = getText(0, length).replace(
                  /([A-Z][A-Za-z]*|[a-z][A-Za-z]*|[0-9]+|[ \t\n]|['][^']*[']|[^A-Za-z0-9\t\n ])/g,
                    function (f) {
                        console.log("f: ", JSON.stringify(f));
                        if (f.match(/^[A-Z][A-Za-z]*$/))
                            return "<span style='color:#800080'>" + f + "</span>";
                        if (f.match(/^[a-z][A-Za-z]*$/))
                            return "<span style='color:#800000'>" + f + "</span>";
                        else if (f.match(/^[0-9]+$/))
                            return "<span style='color:#0000ff'>" + f + "</span>";
                        else if (f.match(/^[ ]/))
                            return "&nbsp;"
                        else if (f.match(/^[\t\n]/))
                            return f;
                        else if (f.match(/^[']/))
                            return "<span style='color:#008000'>" + f + "</span>";
                        else
                            return f;
                    }
                );
                text = markUp;
                cursorPosition = p;
                processing = false;
            }
        }
    } 
```

要使用 Qt 的 QSyntaxHighlighter，您需要以下内容：

1.  在 QML 中，在您的应用程序中使用 TextEdit QML 类型
2.  在 C++ 中，定义一个 QSyntaxHighlighter 并通过 textDocument 属性将 TextEdit QML 类型连接到它
3.  在 C++ 中，`QSyntaxHighlighter::highlightBlock( const QString& text )`在派生类中实现，`setFormat()`根据需要经常调用以标记找到的文本。

为了让事情变得更简单，我创建了一个示例应用程序`https://github.com/stephenquan/QtSyntaxHighlighterApp`，它包含`QSyntaxHighlighter`和`QTextFormat`as`SyntaxHighlighter`和`TextFormat`QML 类型。这样，可以处理 onHighlightBlock 信号并将语法高亮的业务逻辑放在 Javascript 而不是 C++ 中：

```
TextEdit {
    id: textEdit
    selectByMouse: true
    text: [
        "import QtQuick 2.12",
        "",
        "Item {",
        "    Rectangle {",
        "        width: 50",
        "        height: 50",
        "        color: '#800000'",
        "    }",
        "}",
    ].join("\n") + "\n"
    font.pointSize: 12
}

SyntaxHighlighter {
    id: syntaxHighlighter
    textDocument: textEdit.textDocument
    onHighlightBlock: {
        let rx = /\/\/.*|[A-Za-z.]+(\s*:)?|\d+(.\d*)?|'[^']*?'|"[^"]*?"/g;
        let m;
        while ( ( m = rx.exec(text) ) !== null ) {
            if (m[0].match(/^\/\/.*/)) {
                setFormat(m.index, m[0].length, commentFormat);
                continue;
            }
            if (m[0].match(/^[a-z][A-Za-z.]*\s*:/)) {
                setFormat(m.index, m[0].match(/^[a-z][A-Za-z.]*/)[0].length, propertyFormat);
                continue;
            }
            if (m[0].match(/^[a-z]/)) {
                let keywords = [ 'import', 'function', 'bool', 'var',
                                'int', 'string', 'let', 'const', 'property',
                                'if', 'continue', 'for', 'break', 'while',
                    ];
                if (keywords.includes(m[0])) {
                    setFormat(m.index, m[0].length, keywordFormat);
                    continue;
                }
                continue;
            }
            if (m[0].match(/^[A-Z]/)) {
                setFormat(m.index, m[0].length, componentFormat);
                continue;
            }
            if (m[0].match(/^\d/)) {
                setFormat(m.index, m[0].length, numberFormat);
                continue;
            }
            if (m[0].match(/^'/)) {
                setFormat(m.index, m[0].length, stringFormat);
                continue;
            }
            if (m[0].match(/^"/)) {
                setFormat(m.index, m[0].length, stringFormat);
                continue;
            }
        }
    }
}

TextCharFormat { id: keywordFormat; foreground: "#808000" }
TextCharFormat { id: componentFormat; foreground: "#aa00aa"; font.pointSize: 12; font.bold: true; font.italic: true }
TextCharFormat { id: numberFormat; foreground: "#0055af" }
TextCharFormat { id: propertyFormat; foreground: "#800000" }
TextCharFormat { id: stringFormat; foreground: "green" }
TextCharFormat { id: commentFormat; foreground: "green" } 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-14T10:43:27.620

在 QML 中没有明显的方法来实现语法高亮。

可以实现自己的声明性项目，执行实际的突出显示， [`QSyntaxHighlighter`](http://qt-project.org/doc/qt-5.0/qtgui/qsyntaxhighlighter.html)但随后必须为相关源代码的语言定义自己的突出显示规则。我不会为演示文稿做那么多编码。

相反，我会在一个[`WebView`](http://qt-project.org/doc/qt-5.0/qtwebkit/qml-qtwebkit3-webview.html)项目中显示代码，其中突出显示已经应用为静态 HTML 标记或借助 JavaScript 突出显示库，例如[highlight.js](http://softwaremaniacs.org/soft/highlight/en/)。

## 更新 1

如果该`WebView`项目确实无法使用，那么即使是[`Text`](http://qt-project.org/doc/qt-5.0/qtquick/qml-qtquick2-text.html)具有[基本 HTML 支持](http://qt-project.org/doc/qt-5.0/qtgui/richtext-html-subset.html)的简单项目也应该足以处理源代码突出显示用例（如果提供静态 HTML）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-06-24T15:21:16.323

在您的应用文件中：

```
QApplication app(argc, argv);
QQmlApplicationEngine engine;
engine.load(QUrl(QStringLiteral("qrc:/main.qml")));
QQuickTextDocument* doc = childObject<QQuickTextDocument*>(engine, "textEditor", "textDocument");
Q_ASSERT(doc != 0);

// QSyntaxHighlighter derrived class
MySyntaxHighlighter* parser = new MySyntaxHighlighter(doc->textDocument());
// use parser, see QSyntaxHighlighter doc...
int ret = app.exec();
delete parser;
return ret; 
```

获取子对象的模板函数（返回第一次出现的 objectName，因此使用唯一名称来标识 qml 文件中的对象）：

```
template <class T> T childObject(QQmlApplicationEngine& engine,
                                 const QString& objectName,
                                 const QString& propertyName)
{
    QList<QObject*> rootObjects = engine.rootObjects();
    foreach (QObject* object, rootObjects)
    {
        QObject* child = object->findChild<QObject*>(objectName);
        if (child != 0)
        {
            std::string s = propertyName.toStdString();
            QObject* object = child->property(s.c_str()).value<QObject*>();
            Q_ASSERT(object != 0);
            T prop = dynamic_cast<T>(object);
            Q_ASSERT(prop != 0);
            return prop;
        }
    }
    return (T) 0;
} 
```

在您的 qml 文件中使用正确设置 objectName 属性的 TextEdit（在 Flickable 或任何您想要的内容中）：

```
.... 
TextEdit {
    id: edit
    objectName: "textEditor"
    width: flick.width
    height: flick.height
    focus: true
    font.family: "Courier New"
    font.pointSize: 12
    wrapMode: TextEdit.NoWrap
    onCursorRectangleChanged: flick.ensureVisible(cursorRectangle)
}
.... 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-02-14T08:31:59.900

看看[QSyntaxHighlighter](http://qt-project.org/doc/qt-4.8/qsyntaxhighlighter.html)。

`QDeclarativeItem`如果您需要一个 QML 项目来进行语法高亮，您可以通过扩展和使用上面的实用程序来简单地创建自己的项目。

# javascript - 如何在 angularjs 应用程序中实现安全（！）身份验证系统？

> ID：14791361
> 
> 赞同：58
> 
> 时间：2013-02-09T20:41:50.600
> 
> 标签：javascript, security, authentication, cookies, angularjs

我是angularjs的新手...

我阅读了文档，并完成了教程；我自己也尝试了其他东西，事情开始对我有意义。

现在我想知道如何制作一个**安全的身份验证系统**。

简单的部分：没有代码，我将描述我的代码执行的操作：

> 我有一个经典的形式：用户名和密码文本输入。
> 
> 用户填写表单，然后按 ENTER。
> 
> ajax 请求开始，响应是一个 JSON，告诉我“好的，我知道你”或“我不知道你是谁”。

**我现在需要的是在我的应用程序的不同视图之间维护访问者的记录状态（或未记录）。**

我在互联网上读到，为了实现这个目标，有人设置了一个变量（$scope.isLogged = true），其他人使用 cookie；但是 javascript 变量和 cookie 可以使用 firebug 或类似的开发工具轻松编辑。

...最后是问题：

那么，**您有什么建议可以在 angularjs 应用程序中实现安全的身份验证系统吗？**

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-02-09T22:44:01.470

您不能在 angularjs 中授权任何东西，因为用户可以完全控制执行环境（即浏览器）。每张支票，每一个案例，如果——任何你能想到的——都可以被篡改。有一些 javascript 库使用非对称密钥来执行本地加密以稍微安全地存储本地数据，但它们并不是您真正想要的。

你可以而且你应该在服务器上授权——这是你在普通应用程序中做的标准方式——使用会话；不需要特殊代码，ajax 调用使用普通会话 cookie。应用程序不需要知道它是否经过身份验证。它只需要检查服务器的想法。

从您的 angularjs 应用程序的角度来看，“登录”或“注销”只是用户的 gui 提示。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2013-05-18T05:40:02.103

可能您找到了解决方案，但目前我制定了一个正在我的 Angular 应用程序中实施的身份验证方案。

在 .run 上，应用注册时 ActiveSession 设置为 false。然后它检查浏览器是否有一个带有令牌和用户 ID 的 cookie。

如果是，请检查服务器上的 token+userId 并更新服务器和本地上的令牌（令牌是服务器生成的每个用户唯一的密钥）

如果 NO 显示登录表单，请检查凭据，如果它们有效，服务器请求是否获取新令牌并在本地保存。

该令牌用于进行持久登录（记住我 3 周）或当用户刷新浏览器页面时。

谢谢

![Angular.js 中的身份验证方案](../Images/740f1bc10688e663397280072d4a3ccc.png)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-05-21T11:33:14.733

三个月前我问过这个问题。

当我必须在基于 AngularJS 构建的 Web 应用程序中处理用户身份验证时，我想分享一下我最喜欢的方法。

当然 fdreger 的回答仍然是一个很好的答案！

> 您不能在 angularjs 中授权任何东西，因为用户可以完全控制执行环境（即浏览器）。
> 
> 从您的 angularjs 应用程序的角度来看，“登录”或“注销”只是用户的 gui 提示。

因此，简要地说，我的方法包括：

1)**绑定到每条路由关于路由本身的附加信息。**

```
$routeProvider.when('/login', { 
    templateUrl: 'partials/login.html', controller: 'loginCtrl', isFree: true
}); 
```

2）**使用服务来维护有关每个用户的数据及其身份验证状态。**

```
services.factory('User', [function() {
    return {
        isLogged: false,
        username: ''
    };
}]); 
```

3）**每次用户尝试访问新路由时，检查他们是否有访问权限。**

```
$root.$on('$routeChangeStart', function(event, currRoute, prevRoute){
    // prevRoute.isFree tell me if this route is available for all the users, or only for registered user.
    // User.isLogged tell me if the user is logged
}) 
```

我还在我的博客“[使用 angularjs 进行用户身份验证](http://blog.brunoscopelliti.com/deal-with-users-authentication-in-an-angularjs-web-app)”上写了关于这种方法的文章（更详细地） 。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-09T20:48:38.960

首先：客户端数据总是可以被操纵或篡改。

只要有效的会话 ID 不容易被猜到，并且像将会话令牌与客户端的 IP 相关联这样的措施，这没什么大不了的。

理论上，您也可以加密 cookie，只要您在服务器端这样做。

有关如何加密 cookie 的详细信息，请参阅服务器端的文档（例如[http://expressjs.com/api.html#res.cookie](http://expressjs.com/api.html#res.cookie) for Express.js）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-31T17:00:10.390

您需要了解它的服务器端/数据库端。

用户登录需要存储在某个地方——99.9% 的时间是在服务器端数据库中。

理想情况下，对于真正安全的系统，您需要一个后端（服务器端）成员系统，该系统将会话存储在与包含加密密码的成员表相关的数据库表中，但还提供一个 RESTful 接口，您可以在其中构建您的 api 调用到。

我成功使用的一个脚本是 Amember [https://www.amember.com/](https://www.amember.com/)。尽管还有很多其他脚本，但这是一种非常经济有效的方式，我在这个方面取得了很大的成功。它也是 PHP，所以你可以为你的 Angular http 调用构建一个 API容易地。

所有这些 javascript 框架都很棒，但效果是现在太多人过于关注事物的前端——也要学习数据库/后端！:-)

# mysql - INFILE MySQL - TIMESTAMP 不起作用

> ID：14791363
> 
> 赞同：0
> 
> 时间：2013-02-09T20:42:08.033
> 
> 标签：mysql

我正在尝试使用 INFILE 语句从制表符分隔的文件中导入数据。但是，其中一种数据类型是 TIMESTAMP。我尝试在平面文件中使用 NULL，但执行语句后的结果值为 '0000-00-00 00:00:00'。我可以使用什么值来使 TIMESTAMP 起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:04:25.980

你的表定义应该是

```
timestamp_column TIMESTAMP DEFAULT CURRENT_TIMESTAMP 
```

那么在插入 timestamp_column 时应该是插入时间。

# regex - 正则表达式匹配字符串中的非整数值

> ID：14791367
> 
> 赞同：0
> 
> 时间：2013-02-09T20:42:29.760
> 
> 标签：regex

我想匹配以下规则：

*   数字开头允许有一个破折号。
*   只应允许 0 到 9 之间的值。

我目前有以下正则表达式模式，我正在匹配相反的模式，以便在找到不符合规则的匹配项时抛出异常：

[^-0-9]

这种模式的缺点是它适用于所有情况，除了字符串中间的连字符仍然会通过。例如：

“-2304923”是正确允许的，但“9234-342”也是允许的，不应该是。

请告诉我如何将第一个字符指定为 [^-0-9] 并将其余字符指定为 [^0-9]。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:51:48.540

你可以这样做：

```
(?:^|\s)(-?\d+)(?:["'\s]|$)

 ^^^^^                        non capturing group for start of line or space
         ^^^^^                capture number
                 ^^^^^^^^^    non capturing group for end of line, space or quote 
```

[看它工作](http://regexr.com?33ngh)

这将捕获一行中的所有数字字符串，前面有一个可选的连字符。

```
-2304923"  "9234-342"   1234 -1234 
++++++++                                   captured
            ^^^^^^^^                       NOT captured
                        ++++               captured
                             +++++         captured 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T20:49:19.367

此正则表达式将为您工作：

```
^-?\d+$ 
```

解释：开始字符串`^`，然后`-`可选（`?`），`\d`重复几次的数字（`+`），字符串必须在这里结束`$`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T20:46:38.537

我不明白你的模式`[^-0-9]`是如何匹配你正在谈论的那些字符串的。这种模式与你想要的正好相反。您只是简单地通过`caret(^)`在开头使用来否定字符类。因此，此模式将匹配除`hyphen`和之外的任何内容`digits`。

无论如何，根据您的要求，首先您需要`hyphen`在开始时匹配一个。所以，只要把它放在字符类之外。然后以后要匹配任意数量的数字，您可以使用`[0-9]+`or `\d+`。

因此，与所需格式匹配的模式应该是：

```
-[0-9]+  // or -\d+ 
```

上面的正则表达式用于在一些大字符串中查找模式。如果您希望整个字符串与此模式匹配，则可以在正则表达式的末尾添加锚点：-

```
^-[0-9]+$ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T21:34:11.493

对于像这样的正则表达式，有时从两种情况下考虑它会有所帮助。

*   第一个字符是否以某种方式搞砸了？
*   如果不是，其他角色是否以某种方式搞砸了？
*   将这些与`|`

```
 (^[^-0-9]|^.+?[^0-9]) 
```

![在此处输入图像描述](../Images/bcc9d4751c3148450836a4f91a7c9377.png)

# ember.js - “没有方法'属性'”被抛出函数

> ID：14791368
> 
> 赞同：0
> 
> 时间：2013-02-09T20:42:38.863
> 
> 标签：ember.js

我正在创建以下对象：

```
Ember.Object.create({
  value: function() {
    return 'text';
  }.property()
}); 
```

但是我遇到了`has no method 'property'`错误。不知道为什么，我认为`property`它适用于所有功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:52:18.177

如果您打开 JavaScript 控制台，您会注意到以下错误：

**未捕获的错误：断言失败：Ember.Object.create 不再支持定义计算属性。**

试试这个：

```
App.Object = Ember.Object.extend({
  value: function() {
    return 'text';
  }.property()
});

alert(App.Object.create().get('value')); 
```

在 Ember 中，您应该创建对象，而不是实例。如果您发现自己创建了这样的对象实例，那么您*可能*做错了什么。当然，在某些情况下，您需要立即创建`Ember.Object`s，但要让它们具有计算属性并调用`_super`? 我想不出任何有效的案例，因为它们已经被**@deprecated**，你必须找到替代解决方案。更好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:39:43.393

事实证明我禁用了原型扩展：

[http://emberjs.com/guides/configuring-ember/disabling-prototype-extensions/](http://emberjs.com/guides/configuring-ember/disabling-prototype-extensions/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-09T20:48:34.637

尝试使用模型的文档示例：http: [//emberjs.com/api/classes/Ember.ComputedProperty.html#method_property](http://emberjs.com/api/classes/Ember.ComputedProperty.html#method_property)

# javascript - 如何在jQuery中延迟鼠标悬停事件

> ID：14791371
> 
> 赞同：1
> 
> 时间：2013-02-09T20:42:44.310
> 
> 标签：javascript, jquery, events, delay, mouseover

我正在尝试在下面的 jQuery 中延迟 mousehouver 事件

```
document.observe('mouseover', (function (event) {
    var target = event.findElement('a[rel^=lightbox]') || event.findElement('area[rel^=lightbox]');
    if (target) {
        event.stop();
        this.start(target);
    }
}).bind(this));
}, 
```

我试过这样

```
document.observe('mouseover', (function (event), 2000) {
    var target = event.findElement('a[rel^=lightbox]') || event.findElement('area[rel^=lightbox]');
    if (target) {
        event.stop();
        this.start(target);
    }
}).bind(this));
}, 
```

但它没有用。

请问我怎么做这个工作？

谢谢

我也试过这个，但是悬停不起作用。

```
 var hoverTimeout;
       document.observe('mouseenter', (function(event){
        hoverTimeout = setTimeout(function(){
    document.observe('mouseover', (function(event){
        var target = event.findElement('a[rel^=lightbox]') ||                                                             event.findElement('area[rel^=lightbox]');
        if (target) {
            event.stop();
            this.start(target);
        }
    }).bind(this));
},
 }, 2000); 
```

});

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T20:47:12.873

您需要执行此操作（可能稍作修改，因为我没有测试此代码）以覆盖 Lightbox 事件处理程序中的行为，这应该在您加载 Lightbox 脚本后立即放置：

```
<script src="js/lightbox.js" type="text/javascript"></script>
<script type="text/javascript">
Lightbox.prototype.updateImageList = function() {
    this.updateImageList = Prototype.emptyFunction; 

    var hoverTimeout, delayMilliseconds = 2000;
    document.observe('mouseover', (function(event){
        var target = event.findElement('a[rel^=lightbox]')
            || event.findElement('area[rel^=lightbox]');
        if (target) {
            hoverTimeout = setTimeout(function(){
                event.stop();
                this.start(target);
            }, delayMilliseconds);
            target.one('mouseleave', function(){
                clearTimeout(hoverTimeout);
            });
        }
    }).bind(this));
};
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T20:45:20.330

查看 hoverIntent 插件，我认为这正是您正在寻找的:)。 [http://cherne.net/brian/resources/jquery.hoverIntent.html](http://cherne.net/brian/resources/jquery.hoverIntent.html)

# ruby - Jekyll 的漂亮打印 html 输出

> ID：14791373
> 
> 赞同：5
> 
> 时间：2013-02-09T20:42:54.483
> 
> 标签：ruby, jekyll, pretty-print

有什么方法可以漂亮地打印 Jekyll 的 html 输出？

例如，下面是 Jekyll 生成的 html 片段。请注意`<p>`标签如何没有缩进并且在它们之后有不必要的换行符。

```
 ...
      <div id="content">

<p class="flush">Post 1</p>

<p class="flush">Post 2</p>

<p class="flush">Post 3</p>

      </div>
      ... 
```

我正在想象一个可以像这样打印的选项或插件：

```
 ...
      <div id="content">
        <p class="flush">Post 1</p>
        <p class="flush">Post 2</p>
        <p class="flush">Post 3</p>
      </div>
      ... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T05:59:13.743

我建议您选择一个[tidy-maker](http://rubygems.org/search?utf8=%E2%9C%93&query=tidy)`:tidy`并在特定于 jekyll 的任务链的末尾编写自己的任务。或者，更简单：

```
desc "Tidy jekyll output"
task :tidy do
  `find _site -name "*.html" -exec tidy {} \;`
end 
```

请注意，您新创建的任务或任何可能在互联网上找到的插件都不会应用到*github 页面*上，因为它们有运行 jekyll 的限制策略。

# asp.net - MasterPage，如何避免调用相同的操作？

> ID：14791379
> 
> 赞同：0
> 
> 时间：2013-02-09T20:43:12.273
> 
> 标签：asp.net, master-pages

我有一个代表成员部分的母版页。为了访问它，您必须登录。

我还有几个使用该母版页的 asp.net 页面。在其中的每一个中，我都调用了一个函数来检查用户是否登录。如果没有，他将被重定向到主页。

我可以在母版页中而不是在每个子页中实现该调用吗？如果是这样，怎么做？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:52:31.923

创建一个 BasePage 类并从中派生所有页面。例如：

```
class BasePage : System.Web.Page
{
    protected bool IsUserLoggedIn { get { /* ... */ } }
    protected void RedirectToLogin()
    {
        /* ... */
    }
}

class Home : BasePage
{
    /* ... */
} 
```

# ruby-on-rails - 如何告诉 ActiveRecord 特定列属于某个类并获取关联的类？

> ID：14791383
> 
> 赞同：-1
> 
> 时间：2013-02-09T20:44:04.137
> 
> 标签：ruby-on-rails, rails-activerecord

我有一个名为 Conversation 的类和一个名为“assigned_to”的列，用于存储 User.id。

我想加载所有对话，还要加载关联的用户，我该怎么做？

我的会话课是：

```
class Conversation < ActiveRecord::Base
  attr_accessible :description, :name, :assigned_to
end 
```

所以我需要添加`has_one :user`，但是如何链接到该`:assigned_to`字段？我目前正在控制器中填充assigned_to 字段，但现在我正在尝试显示包含用户信息的列表并好奇如何执行此操作。

似乎是基本的 ActiveRecord 功能，但我对它比较陌生，文档似乎没有重命名列的示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:47:55.583

我认为应该是这样的：

```
belongs_to :user, foreign_key: :assigned_to 
```

如果您想了解有关可用选项的更多信息，可以查看[API](http://apidock.com/rails/ActiveRecord/Associations/ClassMethods/has_one)

# php - php xml 通过 http 从 xml 获取值，然后将其存储为字符串

> ID：14791389
> 
> 赞同：1
> 
> 时间：2013-02-09T20:44:33.343
> 
> 标签：php, xml, string, select

好的，我确实对这个 XML / php 脚本有一些问题

我有以下要通过 http 加载的 xml

```
<WowzaMediaServer>
<ConnectionsCurrent>3</ConnectionsCurrent>
<ConnectionsTotal>26</ConnectionsTotal>
<ConnectionsTotalAccepted>20</ConnectionsTotalAccepted>
<ConnectionsTotalRejected>6</ConnectionsTotalRejected>
<MessagesInBytesRate>3248.0</MessagesInBytesRate>
<MessagesOutBytesRate>1054.0</MessagesOutBytesRate>
<VHost>
<Name>_defaultVHost_</Name>
<TimeRunning>28752.989</TimeRunning>
<ConnectionsLimit>0</ConnectionsLimit>
<ConnectionsCurrent>3</ConnectionsCurrent>
<ConnectionsTotal>26</ConnectionsTotal>
<ConnectionsTotalAccepted>20</ConnectionsTotalAccepted>
<ConnectionsTotalRejected>6</ConnectionsTotalRejected>
<MessagesInBytesRate>3248.0</MessagesInBytesRate>
<MessagesOutBytesRate>1054.0</MessagesOutBytesRate>
<Application>
<Name>zahlio</Name>
<Status>loaded</Status>
<TimeRunning>3339.479</TimeRunning>
<ConnectionsCurrent>3</ConnectionsCurrent>
<ConnectionsTotal>14</ConnectionsTotal>
<ConnectionsTotalAccepted>14</ConnectionsTotalAccepted>
<ConnectionsTotalRejected>0</ConnectionsTotalRejected>
<MessagesInBytesRate>31595.0</MessagesInBytesRate>
<MessagesOutBytesRate>32045.0</MessagesOutBytesRate>
<ApplicationInstance>
<Name>_definst_</Name>
<TimeRunning>3339.478</TimeRunning>
<ConnectionsCurrent>3</ConnectionsCurrent>
<ConnectionsTotal>14</ConnectionsTotal>
<ConnectionsTotalAccepted>14</ConnectionsTotalAccepted>
<ConnectionsTotalRejected>0</ConnectionsTotalRejected>
<MessagesInBytesRate>31594.0</MessagesInBytesRate>
<MessagesOutBytesRate>32045.0</MessagesOutBytesRate>
<Stream>
<Name>zahlio</Name>
<SessionsFlash>2</SessionsFlash>
<SessionsCupertino>0</SessionsCupertino>
<SessionsSanJose>0</SessionsSanJose>
<SessionsSmooth>0</SessionsSmooth>
<SessionsRTSP>0</SessionsRTSP>
<SessionsTotal>2</SessionsTotal>
</Stream>
</ApplicationInstance>
</Application>
</VHost>
</WowzaMediaServer> 
```

我要加载的数据是`<SessionsFlash>`来自`2`以`<stream>`x 为名称且 x 为变量的数据，在本例中为 zahlio。

我使用这个http加载它：[http://username:pwd@mydomian.com:8086/connectioncounts](http://username:pwd@mydomian.com:8086/connectioncounts)

这是我当前的 php 脚本：

```
$sxe = new SimpleXMLElement('http://username:pwd@mydomian.com:8086/connectioncounts');
    $propNode = $sxe->xpath('/WowzaMediaServer/VHost/Application/ApplicationInstance/Stream');
    $count = $propNode->getChildren("SessionsFlash"); 
```

它不起作用，我不知道如何从名为 x 的孩子那里选择 trh 数据

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T20:57:07.450

如果我理解正确，您正试图从您发布的 XML 中提取数据。以下代码从提供的 XML中获取`Name`and ：`SessionsFlash`

```
$dom = new DOMDocument();
@$dom->loadXML($xml);
$xpath = new DOMXPath($dom);
$search_name = 'zahlio';
$items = $xpath->query('/WowzaMediaServer/VHost/Application[Name="' . $search_name . '"]/ApplicationInstance/Stream[Name="' . $search_name . '"]');
for ($i = 0; $i < $items->length; $i++)
{
    $temp = $xpath->query('SessionsFlash', $items->item($i));
    $SessionsFlash = $temp->item(0)->nodeValue;
    echo $SessionsFlash;
} 
```

您的服务器正在使用[Digest](http://en.wikipedia.org/wiki/Digest_access_authentication)身份验证，您的浏览器会自动处理它，PHP 需要一些帮助。这是有效的代码：

```
$ch = curl_init('http://user:pwd@website.net:8086/connectioncounts');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_DIGEST);
$xml = curl_exec($ch); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-20T07:30:40.883

我也为 Wowza 媒体服务器构建脚本。这就是我在 php 中读取 XML 的方式，也许它可以帮助

```
 $dom=new DOMDocument;
        $dom->preserveWhiteSpace = false;
        $dom->load('/home/vichea/wowza_visitor/wowza_serverinfo.xml');
        $date=date("d/m/Y");
        $date_file=date('mY');

        $dataset0=$dom->getElementsByTagName("VHost");
        foreach($dataset0 as $row){
            $xmlC=$row->getElementsByTagName("ConnectionsTotal");
            $xmlConn=$xmlC->item(0)->nodeValue;

            $st[]=$xmlConn;
        } 
```

# python - 仅显示反应时间的第 6 位

> ID：14791390
> 
> 赞同：0
> 
> 时间：2013-02-09T20:44:42.867
> 
> 标签：python

我正在做一个反应时间实验。我对python很陌生，我正在使用一个名为psychopy的包（尽管我猜这是一个python问题）。我有一个反应时间，**我只想始终显示小数点后的第 6 位（微秒）**。

此代码将 RT 显示为 6 位数字：

`msg="Correct! RT=%.6f" %(resp.rt)`在显示器上产生这个：0.427716

但我只想显示最后一位数字，在本例中为 6。

我已成功使用此代码：

```
msg= str(resp.rt)[-7] 
```

但是，显示的相应数字有时是第 5 位，有时是第 6 位。而不是总是第 6 个。我不知道为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:48:33.530

您可以直接索引到字符串：

```
>>> val = 0.427716
>>> print str(val)[7]
6 
```

...但这可能会导致缺少数字的意外：

```
>>> val = 0.5
>>> str(val)[7]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
IndexError: string index out of range 
```

...因此，您最好将字符串输出格式化为指定的位数，然后对其进行索引：

```
>>> def GetSixthDigit(f):
...    s = "%2.6f" % f
...    return s[7]
... 
>>> GetSixthDigit(0.427716)
'6'
>>> GetSixthDigit(0.5)
'0' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T20:52:51.217

```
tests = [
    0.4277169,    
    0.427716,
    0.42771,
    999.42771,
    999.427716    
    ]

for rt in tests:
    print('Correct! RT = %d' % (rt*10**6 % 10, )) 
```

产量

```
Correct! RT = 6    # This shows the correct digit if rt has more than 6 significant digits
Correct! RT = 6
Correct! RT = 0    # This shows a zero is used if rt has < 6 significant digits
Correct! RT = 0
Correct! RT = 6 
```

# java - 让 Java Exception 子类的 getMessage() 工作

> ID：14791393
> 
> 赞同：2
> 
> 时间：2013-02-09T20:44:59.147
> 
> 标签：java, exception, tostring

我正在尝试实现我的第一个自定义`RuntimeException`：

```
public class MyException extends RuntimeException {
    private static final long serialVersionUID = 1L;

    private boolean isFizz;
    private boolean isBuzz;
    private Widget widget;

    public class MyException(boolean isFizz, boolean isBuzz, Widget widget) {
        super();

        setIsFizz(isFizz);
        setIsBuzz(isBuzz);
        setWidget(widget);
    }

    // Getters and setters for all 3 properties...

    @Override
    public String toString() {
        System.out.println("MyException is now in string form.");
    }
} 
```

当我去测试这个时：

```
MyException exc = new MyException(false, true, new Widget());

System.out.println(exc.toString());
System.out.println(exc.getMessage()); 
```

我得到：

```
MyException is now in string form.
null 
```

所以`getMessage()`行不通。我希望两者都`toString()`生成`getMessage()`相同的字符串，我*认为*这`Throwable#getMessage()`只是简单地返回了`toString()`.

所以我问：*什么是“正常”的覆盖方式`getMessage()`？*我真的必须像这样覆盖它吗`toString()`，就像这样：

```
@Override
public String getMessage() {
    return toString();
} 
```

或者，还有更好的方法？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:48:48.463

您还没有*设置*消息，因此`getMessage()`肯定会返回`null`。

`RuntimeException`在您的构造函数中，您正在调用via ...的无参数构造函数，`super()`您需要调用`super(message)`（或其他两个接受消息的构造函数之一）并提供消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T20:48:55.247

> 我*以为*`Throwable#getMessage()`索性回来了`toString()`。

你搞错了。 `getMessage()`返回传递给超类构造函数的任何消息：

```
 public MyException(boolean isFizz, boolean isBuzz, Widget widget) {
    super("This is the message"); 
```

并且默认实现`toString()`返回异常类名，后跟消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T20:48:17.133

您可以在构造函数中将消息传递给您的父`Exception`类，例如

```
public class MyException(boolean isFizz, boolean isBuzz, Widget widget) {     
 super("MyException is now in string form.");

} 
```

# ios - NSNotificationCenter - 观察者模式：好的，但是在移动应用程序中？

> ID：14791398
> 
> 赞同：-2
> 
> 时间：2013-02-09T20:45:23.823
> 
> 标签：ios

为什么在移动应用程序中使用 NSNotificationCenter(ios)。我的意思是我没有很多 UI 控件可以在视图上更新。此外，如果我需要传递给视图的调用者，我只会使用委托。

如果我在导航控件中有许多视图，并且我想让每个视图在导航中更新某些内容，这在逻辑意义上可能是合理的 - 它是在这种 NSNotificationCenter 发挥作用的情况下？

感谢和问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:58:58.507

在您提到的情况下，您可能不应该使用通知——它实际上与移动应用程序没有任何关系，同样的标准也适用于桌面应用程序。如果您需要多个对象来侦听一个事件，或者在某些情况下，如果两个视图控制器在控制器的整体方案中相距很远，则最好使用通知，这样很难让一个视图控制器将自己设置为另一个视图控制器的委托。

# r - 代码中的不一致数组错误

> ID：14791399
> 
> 赞同：22
> 
> 时间：2013-02-09T20:44:56.840
> 
> 标签：r

我被困在以下代码中：

```
y = c(2.5, 6.0, 6.0, 7.5, 8.0, 8.0, 16.0, 6.0, 5.0, 6.0, 28.0, 5.0, 9.5, 
      6.0, 4.5, 10.0, 14.0, 3.0, 4.5, 5.5, 3.0, 3.5, 6.0, 2.0, 3.0, 4.0, 
      6.0, 5.0, 6.5, 5.0, 10.0, 6.0, 18.0, 4.5, 20.0) 

x2 = c(650, 2500, 900, 800, 3070, 2866, 7500, 800, 800, 650, 2100, 2000, 
       2200, 500, 1500, 3000, 2200, 350, 1000, 600, 300, 1500, 2200, 900, 
       600, 2000, 800, 950, 1750, 500, 4400, 600, 5200, 850, 5000) 

x1 = c(16.083, 48.350, 33.650, 45.600, 62.267, 73.2170, 204.617, 36.367, 
       29.750, 39.7500, 192.667, 43.050, 65.000, 44.133, 26.933, 72.250, 
       98.417, 78.650, 17.417, 32.567, 15.950, 27.900, 47.633, 17.933, 
       18.683, 26.217, 34.433, 28.567, 50.500, 20.950, 85.583, 32.3830, 
       170.250, 28.1000, 159.8330)

library(MASS) 
n = length(y) 
X = matrix(nrow = n, ncol = 2) 
for (i in 1:n) {
    X[i,1] = x1[i]
}

for (i in 1:n) {
    X[i,2] = x2[i]
} 
gibbs = function(data, m01 = 0, m02 = 0, k01 = 0.1, k02 = 0.1, 
                     a0 = 0.1, L0 = 0.1, nburn = 0, ndraw = 5000) {
    m0      = c(m01,m02) 
    C0      = matrix(nrow=2,ncol=2) 
    C0[1,1] = 1/k01 
    C0[1,2] = 0 
    C0[2,1] = 0 
    C0[2,2] = 1/k02 
    beta    = mvrnorm(1,m0,C0) 
    omega   = rgamma(1,a0,1)/L0 
    draws   = matrix(ncol=3,nrow=ndraw) 
    it      = -nburn 

    while (it < ndraw) {
        it    = it + 1 
        C1    = solve(solve(C0)+omega*t(X)%*%X) 
        m1    = C1%*%(solve(C0)%*%m0+omega*t(X)%*%y) 
        beta  = mvrnorm(1,m1,C1) 
        a1    = a0 + n/2 
        L1    = L0 + t(y-X%*%beta)%*%(y-X%*%beta) / 2 
        omega = rgamma(1, a1, 1) / L1 
        if (it > 0) { 
            draws[it,1] = beta[1]
            draws[it,2] = beta[2]
            draws[it,3] = omega
        }
    }
    return(draws)
} 
```

当我运行它时，我得到：

```
Error in omega * t(X) %*% X : non-conformable arrays 
```

但是当我`omega * t(X) %*% X`在函数外部检查时，我得到一个结果，这意味着数组是一致的，我不知道为什么会出现这个错误。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-09T21:11:17.660

问题是`omega`你的情况是`matrix`维度`1 * 1`。如果您希望乘以`t(X) %*% X`标量（即`omega`） ，则应将其转换为向量

特别是，您必须替换此行：

```
omega   = rgamma(1,a0,1) / L0 
```

和：

```
omega   = as.vector(rgamma(1,a0,1) / L0) 
```

在您的代码中无处不在。它发生在两个地方（一次在循环内，一次在循环外）。您可以替换`as.vector(.)`或`c(t(.))`。两者是等价的。

这是应该可以工作的修改后的代码：

```
gibbs = function(data, m01 = 0, m02 = 0, k01 = 0.1, k02 = 0.1, 
                     a0 = 0.1, L0 = 0.1, nburn = 0, ndraw = 5000) {
    m0      = c(m01, m02) 
    C0      = matrix(nrow = 2, ncol = 2) 
    C0[1,1] = 1 / k01 
    C0[1,2] = 0 
    C0[2,1] = 0 
    C0[2,2] = 1 / k02 
    beta    = mvrnorm(1,m0,C0) 
    omega   = as.vector(rgamma(1,a0,1) / L0)
    draws   = matrix(ncol = 3,nrow = ndraw) 
    it      = -nburn 

    while (it < ndraw) {
        it    = it + 1 
        C1    = solve(solve(C0) + omega * t(X) %*% X) 
        m1    = C1 %*% (solve(C0) %*% m0 + omega * t(X) %*% y)
        beta  = mvrnorm(1, m1, C1) 
        a1    = a0 + n / 2 
        L1    = L0 + t(y - X %*% beta) %*% (y - X %*% beta) / 2 
        omega = as.vector(rgamma(1, a1, 1) / L1)
        if (it > 0) { 
            draws[it,1] = beta[1]
            draws[it,2] = beta[2]
            draws[it,3] = omega
        }
    }
    return(draws)
} 
```

# heroku - 我安装了 Zerigo，但我的 Heroku 管理面板中没有 Zerigo 仪表板

> ID：14791401
> 
> 赞同：1
> 
> 时间：2013-02-09T20:45:34.753
> 
> 标签：heroku, dns

我使用命令行安装了 Zerigo DNS Basic。

```
$ heroku addons:add zerigo_dns:basic

cjmac:~ cj$ idt
cjmac:idt2 cj$ heroku addons:add zerigo_dns:basic
Adding zerigo_dns:basic to idt... done, v91 (free) 
```

当我转到 Zerigo ( ) 的插件页面时`.../addons/zerigo_dns:basic`，有一个链接指向“在自定义域插件仪表板中添加或删除域 →”。

该链接将我带到`.../addons/custom_domains`. 没有仪表板，只有 Heroku 文档的链接 ( [https://devcenter.heroku.com](https://devcenter.heroku.com) )。

仪表盘怎么了？它在我的其他网站上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T04:50:20.403

您可以在 Heroku 仪表板上添加自定义域，网址为：[https](https://dashboard.heroku.com/apps/:your_app_name/settings) ://dashboard.heroku.com/apps/:your_app_name/settings 。然后它们将显示在您的 Zerigo 附加组件页面上。

我正在打开一个内部问题来修复 Zerigo 文档和重定向。感谢您引起我们的注意！

# clojure - Clojure :: 将配置数据存储在外部文件中

> ID：14791402
> 
> 赞同：2
> 
> 时间：2013-02-09T20:45:42.143
> 
> 标签：clojure

在我的 Clojure 程序开始时，我做了一个：

```
(def db-coords
    {:classname "org.postgresql.Driver"
     :subprotocol "postgresql"
     :subname (str "//" host ":" port "/" dbname) ;; host, port and dbname are defd above
     :user      "foo"
     :password  "bar"}) 
```

我想将这些值存储在类路径上的外部文件（.clj 或其他文件）中并从那里加载它们。显然，一种方法是使用**java.util.Properties**，但我怀疑 Clojure 中有一种惯用的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T22:48:42.133

考虑将**[spit](http://clojuredocs.org/clojure_core/clojure.core/spit)**和**[slurp](http://clojuredocs.org/clojure_core/clojure.core/slurp)**与**[read-string](http://clojuredocs.org/clojure_core/clojure.core/read-string)**一起使用。

Clojure 具有序列化和反序列化其数据结构的内置能力。

序列化到文件：

```
(spit "./coords.txt" db-coords) 
```

要将文件作为字符串重新加载并反序列化：

```
(read-string (slurp "./coords.txt")) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T20:23:22.763

clj-config 是一个很好的库，它封装了 spit、read-string api

[https://github.com/Raynes/clj-config](https://github.com/Raynes/clj-config)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-30T01:05:05.137

我创建了一个库，用于通过 Clojure 映射和 JVM 系统属性处理 env 特定的配置区域：

[https://github.com/bbbates/confijulate](https://github.com/bbbates/confijulate) 这是我发现自己在每个项目中一遍又一遍地重复的模式。

# iphone - 在 UITableView 中基于 indexPath 获取对象的替代方法

> ID：14791407
> 
> 赞同：0
> 
> 时间：2013-02-09T20:46:10.973
> 
> 标签：iphone, objective-c, xcode, uitableview, mpmediaitem

我正在学习一个教程： http: [//www.devx.com/wireless/Article/43374](http://www.devx.com/wireless/Article/43374) 所以我可以在歌曲的 UITableView 中添加字母排序和平移，我已经完成了编码，但是我遵循的这种方法减慢了 UITableView在 cellForRowAtIndexPath 方法中过滤数组和检索值。我不知道如何删除多余的编码以提高速度。所有 MPMediaItems 都存储在 tableTracks 数组中。在 viewDidLoad 中初始化。你的 musicIndex 是一个字母数组（每首歌曲的第一个字母）。我扩展了 MPMediaItem 以包含一个 NSString firstLetter，它是歌曲的第一个字母。

**任何帮助加快它？**

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

   //--Create Cell--\\    
    .........

   //--Load Info--\\
    NSString *alphabet = [musicIndex objectAtIndex:[indexPath section]];
    NSPredicate *predicate =
    [NSPredicate predicateWithFormat:@"firstLetter beginswith[c] %@", alphabet];
    NSArray *songs = [tableTracks filteredArrayUsingPredicate:predicate];

   //Needed Object    
    MPMediaItem *item = [songs objectAtIndex:indexPath.row];

    //--Rest of Method--\\
    ...........

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:09:57.083

如果您要显示单独的部分，一个用于字母表的每个字母，我会从我的数据中创建一个字典数组，在 viewDidLoad 中，而不是在这里。字典将以歌曲的第一个字母作为键，以歌曲数组作为值。这样，所有过滤和排序都是预先完成的，而不是在填充表格时在每一行中完成。

# regex - 正则表达式 - 从链接中提取数字

> ID：14791412
> 
> 赞同：1
> 
> 时间：2013-02-09T20:46:48.963
> 
> 标签：regex

我有这个链接`www.xxx.yy/yyy/zzzzzz/xyz-z-yzy-/93797038`，我想把这个数字`93797038`传递给另一个链接。

例如：之后我想要`www.m.xxx.yy/93797038`与以前相同但在其移动版本中的页面。

一般来说，我知道我必须键入`www.xxx.yy/(.*)`以提取主 url 中的任何内容，然后将结果分组`www.m.xxx.yy/%1`，重定向到同一页面但在移动版本中。

任何想法如何做到这一点？

***编辑**：*链接`www.xxx.yy/yyy/zzzzzz/xyz-z-yzy-/93797038`是自动的。每次都相同的部分只有`www.xxx.yy`. 每次系统运行时都会产生不同的 url。我希望每次都从这些网址中获取数字，例如`93797038`在我的情况下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:49:13.717

`\/(\d+?)$`将在 final 之后获得尾随数字`/`。

![在此处输入图像描述](../Images/b2ac7e2089f868cb728b67dd3d153dcd.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:06:44.280

为什么你想要正则表达式？您可以使用

```
string str = @"www.xxx.yy/yyy/zzzzzz/xyz-z-yzy-/93797038";
string digit = str.Split('/').Last(); 
```

反而。

# javascript - 在 jCanvascript 中转换为图像

> ID：14791413
> 
> 赞同：1
> 
> 时间：2013-02-09T20:46:49.020
> 
> 标签：javascript, canvas, jcanvascript

我应用 jcanvaScript（JavaScript 库）

在画布元素上有一些图像如何交换位置图像（例如单击鼠标后）？

```
 function start(){   

// Add mouse listener.
canvas = document.getElementById('firstCanvas');

canvas.addEventListener('click',coordinateClick);

    var img =[];
    for(var i=0;i<16;i++){
    img[i]=new Image;
    img[i].src="./image/"+i+".png";
    }

    jc.start('firstCanvas',true);

        function allOnloadImages(){//initialization by canvas id

            for(var i=0;i<16;i++){

            jc.image(img[i],cordinaImg[i][0],cordinaImg[i][1]).id('img'+i);

            };              

    };              

    jc.start('firstCanvas');

    for(var i=0;i<img.length;i++){
        img[i].onload=allOnloadImages;          
    }

}
function coordinateClick(e){

 ...    
//here we interchange the position of pictures 

    jc('#img'+i).translateTo(cordinaImg[numberFieldEmpty][0],cordinaImg[numberFieldEmpty][1]+11);
 jc('#img15').translateTo(cordinaImg[i][0],cordinaImg[i][1]+11);
...

    } 
```

因此存在图片的分叉，即同一张图片的两个副本……例如，如果是这样，则不会删除任何内容

```
jc('#img'+i).del();// 
```

# java - 什么是“&”和“|” 用于此颜色生成代码？

> ID：14791416
> 
> 赞同：3
> 
> 时间：2013-02-09T20:47:03.813
> 
> 标签：java, colors, 2d-games

刚刚在 YouTube 上偶然发现了 designsbyzephy 的 2d 游戏开发视频系列，并决定学习和理解视频中的代码将是我的下一个 Java 学习冒险。

最大的障碍是试图自己破译代码，因为视频制作者有一种令人难以置信的新手不友好的方式来解释一切。

所以这是我的问题和视频

视频：[http ://www.youtube.com/watch?v=7eotyB7oNHE](http://www.youtube.com/watch?v=7eotyB7oNHE)

5:31，他输入代码

```
int index = 0;
    for (int r = 0; r < 6; r++){
        for (int g = 0; g < 6; g++){
            for (int b = 0; b < 6; b++){

                int rr = (r * 255/5);
                int gg = (g * 255/5);
                int bb = (b * 255/5);

                colors[index++] = rr << 16 | gg << 8 | bb;
            }
        }
    }
colors[index++] = rr << 16 | gg << 8 | bb; 
```

据我了解，他正在用每种颜色的 6 种色调创建的所有组合填充数组，但我不明白`|`符号代表什么。他在视频中提到他在之前的视频中谈到过它，但他没有，我检查过，我确信他误解了他的解释`&`，`|`因为他确实触及`&`了一点操作，但从未`|`提及他以前的任何视频。我不明白的另一件事是为什么我们要改变颜色。他在视频中解释了它，但对我来说仍然没有意义。基本上他所说的只是我们改变它，因为`bb`, `gg`, 和`rr`都有 2 和 8 位数据，但这不足以作为我的解释。我需要知道我们为什么要这样做，为什么我们需要向左移动只是因为`bb`, `gg`,`rr`颜色中有 2^8 位的数据，以及首先有 2^8 位的数据意味着什么?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-09T21:13:43.360

在`|`java中是按位或运算符：[按位运算](http://en.wikipedia.org/wiki/Bitwise_operation#OR) 没有看整个视频，我猜他正在尝试做的是将所有颜色值（RGB）放入一个32Bit整数中。由于 rr,gg,bb 只能有 0-255 的值，只需要 8 位，他可以通过移位和或操作将它们放入一个变量中。例如：

```
rr:       00000000 00000000 00000000 10101010
rr<<16:   00000000 10101010 00000000 00000000

gg:       00000000 00000000 00000000 11110000
gg<<8:    00000000 00000000 11110000 00000000

bb:       00000000 00000000 00000000 00001111

value = rr << 16 | gg << 8 | bb 

rr<<16:   00000000 10101010 00000000 00000000
gg<<8:    00000000 00000000 11110000 00000000
bb:       00000000 00000000 00000000 00001111

value:    00000000 10101010 11110000 00001111
                      ^        ^        ^
                      rr       gg       bb 
```

所以现在我们在一个整数变量中拥有所有三种颜色值。

# c++ - 终止无尽的 while 循环

> ID：14791420
> 
> 赞同：0
> 
> 时间：2013-02-09T20:47:16.810
> 
> 标签：c++

好的，所以我是 C++ 的新手。我确实有 java 背景，但是使用 c++ 我知道我现在必须自己进行垃圾收集。

这是我的场景：

```
int main(){
float * pt;
while(true){
 // some code
}
delete pt;
return 0; 
```

假设您处于无休止的 while 循环中，然后您决定通过单击窗口上的关闭按钮来结束程序。关闭程序有什么作用？它会终止while循环，然后执行删除命令吗？或者它只是在没有完成删除命令的情况下终止程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T20:50:31.137

像这样的简单 C++ 程序没有“单击关闭按钮”的概念。在您开始使用 GUI 工具包之前，您甚至不会处理这个问题。终止此程序的不同方式完全取决于您运行它的方式。您很可能在某种终端或命令行窗口中运行它。如果该终端提供关闭按钮，则单击关闭按钮实际上会触发终端应用程序中的某些事件。它如何处理您仍在运行的程序完全取决于该应用程序。通常，终端会强制终止任何子进程。然而，这是非常特定于平台的。（对于 Linux，请参阅[终端关闭时 bash 收到的信号](https://stackoverflow.com/q/5546223/150634)）

如果您担心`delete`如果您的程序被强制终止，您的资源可能不会被删除，请不要这样做。任何现代操作系统都会在进程结束时清理进程分配的资源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T20:54:54.940

这取决于窗口是控制台窗口还是普通 UI 窗口，以及操作系统。如果您关闭 UI 窗口，该过程实际上不会终止，您将有机会执行其他操作（如清理）。对于控制台窗口，该进程将被强制终止，但这更依赖于操作系统。

**无论哪种方式，最后是否执行删除**命令都无关紧要，因为进程无论如何都会终止，并且进程的堆将被完全回收，无论其中还有什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T21:17:38.957

like sftrabbit said before, you don't have to worry your about delete, when terminating the process. but if you have to do something more complicated, like sending a signoff message to a server, or committing database stuff, there's atexit().

```
void mycleanup() {
    // do something here.
    // downside is ofc, that you can only use global stuff ;(
}

int main(){

atexit(mycleanup);

while(true){
 // some code
}

return 0; 
```

# php - Laravel 4 数据库种子不起作用

> ID：14791421
> 
> 赞同：10
> 
> 时间：2013-02-09T20:47:27.293
> 
> 标签：php, laravel, eloquent, laravel-4

我遵循本教程： http://fideloper.com/post/41750468389/laravel-4-uber-quick-start-with-auth-guide?utm_source=nettuts&utm_medium=article&utm_content=api& [utm_campaign=guest_author](http://fideloper.com/post/41750468389/laravel-4-uber-quick-start-with-auth-guide?utm_source=nettuts&utm_medium=article&utm_content=api&utm_campaign=guest_author)

而本教程： http: [//laravelbook.com/laravel-database-seeding/](http://laravelbook.com/laravel-database-seeding/)

但是，当我尝试运行时`php artisan db:seed`，什么也没有发生。

我试试这个：

```
<?php
    // app/database/seeds/groups.php
    return array(
        'table' => 'groups',
        array(
            'name' => 'Administrador',
            'description' => '<p>Permissão total no sistema</p>',
            'created_at' => new DateTime,   
            'updated_at' => new DateTime
        ),
        array(
            'name' => 'Moderadores',
            'description' => '<p>Podem apenas postar e moderar comentários</p>',
            'created_at' => new DateTime,   
            'updated_at' => new DateTime
        )
    ); 
```

接下来：`php artisan db:seed`。

```
php artisan db:seed --env=local
Database seeded! 
```

但：

```
mysql> select * from groups;
Empty set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-02-10T07:13:35.330

教程中的示例是错误的 - 因为种子在 Beta 1 和 Beta 2 之间的工作方式发生了变化。

将您的`DatabaseSeeder.php`文件更改为此 - 它适用于本教程：

```
<?php

class DatabaseSeeder extends Seeder {

    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        $this->call('UserTableSeeder');
    }

}

class UserTableSeeder extends Seeder {

    public function run()
    {
        DB::table('users')->delete();
        User::create(array(
                'id' => 1,
                'username' => 'firstuser',
                'password' => Hash::make('first_password'),
                'created_at' => new DateTime,
                'updated_at' => new DateTime
        ));
        User::create(array(
                'id' => 2,
                'username' => 'seconduser',
                'password' => Hash::make('second_password'),
                'created_at' => new DateTime,
                'updated_at' => new DateTime
        ));    
    }
} 
```

现在运行`php artisan db:seed`- 它会工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-12-11T16:18:50.547

**创建你的播种机：**

```
<?php

// NoticesTableSeeder.php    
class NoticesTableSeeder extends Seeder {

    public function run()
    {
        DB::table('notices')->truncate();

        $notices = [
            ['title' => 'Our Web Page Is Back Online!', 'body' => 'Our web site is online again. Thanks for visiting.', 'created_at' => new DateTime],
            ['title' => 'Sample New Notice 1', 'body' => 'Sample new notice content.', 'created_at' => new DateTime],
            ['title' => 'Sample New Notice 2', 'body' => 'Sample new notice content.', 'created_at' => new DateTime],
            ['title' => 'Sample New Notice 3', 'body' => 'Sample new notice content.', 'created_at' => new DateTime],
            ['title' => 'Sample New Notice 4', 'body' => 'Sample new notice content.', 'created_at' => new DateTime]
        ];
        DB::table('notices')->insert($notices);
    }

} 
```

**将其添加到 DatabaseSeeder.php**

```
// DatabaseSeeder.php
class DatabaseSeeder extends Seeder {

    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        ...
        $this->call('NoticesTableSeeder');
        $this->command->info('Notices table seeded!');
        ...
    }

} 
```

**更新您的自动装载机：**

```
composer dump-autoload 
```

**为数据库播种：**

```
php artisan db:seed 
```

**太好了，你完成了！**

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-07-28T23:07:48.970

如果@The Shift Exchange 返回诸如**“找不到类用户”之类的**错误，您可以尝试

```
DB::table('users')->insert(array(...)) 
```

代替

```
User::create(array(...)) 
```

# python - 在 Python 中使用 smtplib 通过 SMTP 连接到 Google Mail 时出错

> ID：14791430
> 
> 赞同：1
> 
> 时间：2013-02-09T20:48:20.363
> 
> 标签：python, gmail, smtplib

我的问题是，当我运行以下代码时，我得到一个 WinError 10061，从我的所有搜索来看，这似乎是由于没有正确设置外国机器，但我认为谷歌已经处理好了对于gmail，所以错误就在我这边。我能找到的所有其他示例都是使用 localhost 并出现此错误，这是因为他们没有设置本地邮件服务器。这个问题还会出现这种情况吗？我确定我遗漏了一些明显的东西。此外，错误代码是完整的。先感谢您！

```
import smtplib

fromaddr = 'email@email.com'
toaddrs  = 'otheremail@email.com'
msg = 'Random stuff!'

username = 'username'
password = 'pass'

server = smtplib.SMTP('smtp.gmail.com', 587)
server.starttls()
server.login(username,password)
server.sendmail(fromaddr, toaddrs, msg)
server.quit() 
```

错误：

```
Traceback (most recent call last):
  File "C:/Users/Brett/PycharmProjects/Texting/sendMessage.py", line 13, in <module>
    server = smtplib.SMTP('smtp.gmail.com')
  File "C:\Python33\lib\smtplib.py", line 238, in __init__
    (code, msg) = self.connect(host, port)
  File "C:\Python33\lib\smtplib.py", line 317, in connect
    self.sock = self._get_socket(host, port, self.timeout)
  File "C:\Python33\lib\smtplib.py", line 288, in _get_socket
    self.source_address)
  File "C:\Python33\lib\socket.py", line 424, in create_connection
    raise err
  File "C:\Python33\lib\socket.py", line 415, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-09T00:06:13.007

过去使用过 Gmail SMTP 服务器，我只能指出 SMTP 端口的编号实际上默认为适合 Gmail 的编号，因此端口参数（也可以用冒号附加到服务器名称上）可以被省略。鉴于此，您可能应该尝试另一台机器以确保您没有遇到网络错误等。此外，端口 587 要求进行 ID 检查，这意味着 Gmail 可能会认为您在发送垃圾邮件或其他一些废话。未输入端口号时采用的默认端口 25，不执行此类检查。

# xslt - XSLT 从平面结构到嵌套结构的转换

> ID：14791434
> 
> 赞同：4
> 
> 时间：2013-02-09T20:48:33.097
> 
> 标签：xslt

我无法使用简单的 (?) XSLT 转换进行管理。

有一个输入扁平结构的 XML：

```
<root>
    <attribute_a>abc</attribute_a>
    <attribute_b>def</attribute_b>
    <attribute_c>ghi</attribute_c>
    <attribute_a>123</attribute_a>
    <attribute_b>456</attribute_b>
    <attribute_c>789</attribute_c>
    <attribute_a>xxx</attribute_a>
    <attribute_b>xxx</attribute_b>
    <attribute_c>xxx</attribute_c>
</root> 
```

我应该将它转换为这样的 XML：

```
<root>
    <attribute>
        <attribute_a>abc</attribute_a>
        <attribute_b>def</attribute_b>
        <attribute_c>ghi</attribute_c>
    </attribute>
    <attribute>
        <attribute_a>123</attribute_a>
        <attribute_b>456</attribute_b>
        <attribute_c>789</attribute_c>
    </attribute>
    <attribute>
        <attribute_a>xxx</attribute_a>
        <attribute_b>xxx</attribute_b>
        <attribute_c>xxx</attribute_c>
    </attribute>
</root> 
```

但问题是在这样的转换之后：

```
<?xml version="1.0" encoding="UTF-8" ?>
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes" />

    <xsl:template match="/">
        <root>
            <xsl:for-each select="root/attribute_a">
                <attribute>
                    <attribute_a>
                        <xsl:value-of select="../attribute_a" />
                    </attribute_a>
                    <attribute_b>
                        <xsl:value-of select="../attribute_b" />
                    </attribute_b>
                    <attribute_c>
                        <xsl:value-of select="../attribute_c" />
                    </attribute_c>
                </attribute>
            </xsl:for-each>
        </root>
        <xsl:apply-templates />
    </xsl:template>
</xsl:stylesheet> 
```

我得到了这样的东西：

```
<?xml version="1.0" encoding="UTF-8"?>
<root>
    <attribute>
        <attribute_a>abc</attribute_a>
        <attribute_b>def</attribute_b>
        <attribute_c>ghi</attribute_c>
    </attribute>
    <attribute>
        <attribute_a>abc</attribute_a>
        <attribute_b>def</attribute_b>
        <attribute_c>ghi</attribute_c>
    </attribute>
    <attribute>
        <attribute_a>abc</attribute_a>
        <attribute_b>def</attribute_b>
        <attribute_c>ghi</attribute_c>
    </attribute>
</root> 
```

我在 XSLT 方面不是很有经验 - 你有什么想法吗？:(

问候，上午

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:13:13.023

这应该可以解决问题：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()" />
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/">
    <root>
      <xsl:for-each select="root/attribute_a">
        <xsl:variable name="pos" select="position()"/>
        <attribute>
          <xsl:apply-templates
            select="../attribute_a[$pos] | 
                    ../attribute_b[$pos] |
                    ../attribute_c[$pos]" />
        </attribute>
      </xsl:for-each>
    </root>
  </xsl:template>
</xsl:stylesheet> 
```

我建议更进一步，使用单独的模板而不是`for-each`：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()" />
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/">
    <root>
      <xsl:apply-templates select="root/attribute_a" mode="group" />
    </root>
  </xsl:template>

  <xsl:template match="attribute_a" mode="group">
    <xsl:variable name="pos" select="position()"/>
    <attribute>
      <xsl:apply-templates
        select="../attribute_a[$pos] | ../attribute_b[$pos] | ../attribute_c[$pos]" />
    </attribute>
  </xsl:template>
</xsl:stylesheet> 
```

当这些 XSLT 中的任何一个在您的示例输入上运行时，它都会产生以下输出：

```
<root>
  <attribute>
    <attribute_a>abc</attribute_a>
    <attribute_b>def</attribute_b>
    <attribute_c>ghi</attribute_c>
  </attribute>
  <attribute>
    <attribute_a>123</attribute_a>
    <attribute_b>456</attribute_b>
    <attribute_c>789</attribute_c>
  </attribute>
  <attribute>
    <attribute_a>xxx</attribute_a>
    <attribute_b>xxx</attribute_b>
    <attribute_c>xxx</attribute_c>
  </attribute>
</root> 
```

# rest - 使用 SharePoint 2013 REST API 添加列表项

> ID：14791444
> 
> 赞同：24
> 
> 时间：2013-02-09T20:49:40.517
> 
> 标签：rest, sharepoint, sharepoint-api, sharepoint-2013

我正在尝试使用带有 REST API 的 SharePoint 2013 在现有列表中添加新项目。

这里有很好的文档：http: [//msdn.microsoft.com/en-us/library/jj164022 (office.15).aspx#ListItems](http://msdn.microsoft.com/en-us/library/jj164022%28office.15%29.aspx#ListItems)

我尝试添加项目的列表称为“资源”，因此我执行以下 http POST 操作来添加新项目：

```
POST https://<site>/apps/reserve/_api/lists/getbytitle('Resources')/items
    X-RequestDigest: <digest_key>
    Content-Type: application/json;odata=verbose

    {
        "__metadata":    {"type": "SP.Data.ResourcesListItem"},
        "Title":         "New Title",
        "Description":   "New Description",
        "Location":      "Sunnyvale"
    } 
```

但我得到以下错误：

```
A type named 'SP.Data.ResourcesListItem' could not be resolved by the model.
When a model is available, each type name must resolve to a valid type. 
```

所以我认为我没有正确的资源名称。在文档中，它说：

```
To do this operation, you must know the ListItemEntityTypeFullName property of the list
and pass that as the value of type in the HTTP request body. 
```

但我不知道如何为我的列表获取 ListItemEntityTypeFullName，并且文档似乎没有解释如何 - 我从文档 (SP.Data.< LIST_NAME >ListItem") 复制了模式，但我想这是不对的.

如何找到我的列表的名称？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-09T21:44:35.130

您可以按如下方式获取名称：

```
GET https://<site>/apps/reserve/_api/lists/getbytitle('Resources')?$select=ListItemEntityTypeFullName 
```

列表名称将位于： content -> m:properties -> d:ListItemEntityTypeFullName

# java - 电子配置逻辑

> ID：14791445
> 
> 赞同：2
> 
> 时间：2013-02-09T20:49:45.363
> 
> 标签：java, algorithm, recursion, logic, chemistry

我正在尝试创建一个方法（在 java 中）来找出元素的电子配置。

前任。
He（第 2 元素：2 电子） 电子配置：1s ²
O（第 8 元素 8 电子） 电子配置：1s ² 2s ² 2p ⁴
Zr（第 40 元素 40 电子） 电子配置：1s ² 2s ² 2p ⁶ 3s ² 3p ⁶ 4s ² 3d ^(10) 4p ⁶ 5s ² 4d ²

我怎样才能弄清楚计算这个的逻辑？何时增加 s、p、d 和 f 壳，以及计算每个壳的上标。

S 最大 2 个电子（上标最大 2）
P 最大 6 个电子（上标最大 6）
D 最大 10 个电子（上标最大 10）
F 最大 14 个电子（上标最大 14）

也许是递归？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:12:08.823

您可以创建一个类来表示具有以下属性的配置：

```
private final boolean[] K = new boolean[ 2];
private final boolean[] L = new boolean[ 8];
private final boolean[] M = new boolean[18];
private final boolean[] N = new boolean[32];
private final boolean[] O = new boolean[32];
private final boolean[] P = new boolean[32]; 
```

`true`对于分配的位置，对于空闲位置为 false。

钾的例子：

```
K[0] = true;
K[1] = true;
L[0] = true;
...
L[7] = true;
M[0] = true;
...
M[7] = true;
N[0] = true; 
```

# javascript - Three.js 控件的 Javascript

> ID：14791448
> 
> 赞同：0
> 
> 时间：2013-02-09T20:49:58.557
> 
> 标签：javascript, mouse, three.js

我正在尝试用three.js 制作一个小游戏。控制javascript代码如下：

```
window.onmouseover = function (ev) {
    down = true;
    sx = ev.clientX;
    sy = ev.clientY;
};
window.onmouseout = function () {
    down = false;
};
window.onmousemove = function (ev) {
    if (down) {
        var dx = ev.clientX - sx;
        var dy = ev.clientY - sy;
        camera.rotation.y += -dx / 100;
        //camera.rotation.x += -dy/100;
        sx += dx;
        sy += dy;
    }
} 
```

我的问题是：如何防止鼠标离开窗口并继续移动？

我有一个想法，即在每个滴答声中将它重新定位在中心，这样它就不会移动那么远，但我也不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:15:22.423

[Pointer Lock API](http://updates.html5rocks.com/2012/02/Pointer-Lock-API-Brings-FPS-Games-to-the-Browser)没有得到很好的支持，但您就是这样做的。

# php - 使用 PHP 获取服务器上文件的 URL

> ID：14791449
> 
> 赞同：0
> 
> 时间：2013-02-09T20:50:00.903
> 
> 标签：php, url, path, getcwd

假设我想在脚本的父目录之一中找到一个文件。考虑这个文件树：

```
Folder0
    Folder1
        needle.php
        Folder2
            Folder3
                script.php 
```

我正在运行`script.php`，我需要找到哪个目录包含`needle.php`. 我这样做：

```
while (!file_exists($nameFile)) {
    chdir('..');
    }
return getcwd(); 
```

这将返回“Folder0\Folder1\”；

**将此路径转换为该文件的 URL 的正确方法是什么？**（例如``http://hostname.com/Folder0/Folder1/needle.php"`）

还是有**更好的方法来获取服务器上文件的 URL？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T21:04:21.790

```
getcwd() 
```

从服务器根目录为您提供当前目录，例如**/home/vincent/public_html/folder**您可以获得 DOCUMENT_ROOT 通过

```
 $_SERVER['DOCUMENT_ROOT'];//  /home/vincent/public_html 
```

您必须从 getcwd 的第一个中删除 DOCUMENT_ROOT 并与主机名连接。像这样

```
 echo str_replace("\\",'/',"http://".$_SERVER['HTTP_HOST'].substr(getcwd(),strlen($_SERVER['DOCUMENT_ROOT']))); 
```

输出：

```
 http://www.domain.com/folder 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T20:59:49.343

您可以使用[RecursiveDirectoryIterator 类](http://php.net/manual/en/class.recursivedirectoryiterator.php)

这是一个很好的[教程](http://www.techrepublic.com/blog/programming-and-development/how-do-i-recursively-scan-directories-with-phps-directoryiterators/417)，可以帮助你

我希望这能有所帮助，如果需要更多帮助，我们会在这里很高兴为您提供帮助 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T21:01:27.343

```
while (!file_exists($nameFile)) {
    chdir('..');
}
return "http://".$_SERVER['HTTP_HOST'].str_replace('\\', '/', getcwd()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T21:02:06.133

> $basePath="http://hostname.com/"; $fileName="needle.php"; $folderPath="文件夹0\文件夹1\";
> 
> $path=str_replace("\","/",$folderPath); $pathToFile=$basePath.$path.$fileName;
> 
> 回声 $pathToFile;

用它做一个功能！

卢西安

# sql - 通过变量引用表

> ID：14791451
> 
> 赞同：0
> 
> 时间：2013-02-09T20:50:03.280
> 
> 标签：sql, sql-server, tsql, sql-server-2012-express

我确定这是非常基本的，但是如何使用表名的变量设置 INSERT 语句？

例如，我有许多输入文件，所有配置都相同（输入 1、输入 2、输入 3，...）都将进入 INSERT 或 MERGE 语句。

我想做一个循环，处理所有输入文件，或者将 INSERT 语句作为函数调用

```
INSERT INTO [OutputFile]
SELECT i.*
FROM   [<Input Variable>] i
     LEFT JOIN [OutputFile] OP
         ON CONCAT(i.Field1, i.Field6) = CONCAT(OP.Field1, OP.Field6) 
     WHERE OP.Field1 IS NULL 

PRINT 'Number of rows added is ' + CAST(@@ROWCOUNT as char(6)); 
```

我实际上会使用 MERGE 语句，但我认为过程是相同的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T20:52:51.120

> 如何使用表名的变量设置 INSERT 语句？

你没有，不是直接用SQL。表名和列名不能是变量。

您可以通过使用[动态 SQL](http://www.sommarskog.se/dynamic_sql.html)来实现这一点，但您必须小心不要引入[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)。

[The Curse and Blessings of Dynamic SQL](http://www.sommarskog.se/dynamic_sql.html)是一篇精彩的深入讨论动态 SQL 的文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T01:49:50.983

您可以使用动态 SQL。该`QUOTENAME()`函数将使用和转义方括号来帮助防止 SQL 注入。

```
declare @table sysname = 'MyTable';

declare @sql nvarchar(max) = '
    INSERT INTO [OutputFile]
    SELECT i.*
    FROM {{table}} i
    LEFT JOIN [OutputFile] OP
        ON (CONCAT(i.Field1, i.Field6)
            = CONCAT(OP.Field1, OP.Field6))
    WHERE OP.Field1 IS NULL
    ';

set @sql = REPLACE(@sql, '{{table}}', QUOTENAME(@table));

exec(@sql); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T20:58:45.133

为什么要做一个循环？只需使用`union all`：

```
insert into OutputFile
    select i.*
    from ((select * from input1) union all
          (select * from input2) union all
          . . .
          (select * from inputn)
         ) i left outer join
         OutputFile op
         on CONCAT(i.Field1, i.Field6) = CONCAT(OP.Field1, OP.Field6) 
    WHERE OP.Field1 IS NULL 
```

如果有很多表，您可以将它们放在 Excel 中的一列中，并使用 Excel 公式来创建查询。

# c - 在 C 中获取 %ebp ,%esp 并在堆栈中输出值

> ID：14791453
> 
> 赞同：2
> 
> 时间：2013-02-09T20:50:19.603
> 
> 标签：c, x86

目前，我正在处理一个需要在调用堆栈中输出一些值的问题。这是我所做的：

```
int funcA() 
{ 
    int a = 1;
    int b = 2;
    char c = '3';
    asm("mov %ebp, ebp");
    asm("mov %esp, esp");
    printf("&a = %x\n", &a);
    printf("&b = %x\n", &b);
    printf("&c = %x\n", &c);
    printf("esp = %X  ebp = %X\n", esp, ebp);
} 
```

esp 和 ebp 已提前声明。上面代码的输出是：

```
&a = ff7f7c
&b = ff7f78
&c = ff7f77
esp = FF7F68  ebp = FF7F88 
```

1.  为什么 &c = ff7f77？在堆栈中，无论其类型如何，每个块都应该等于 4 个字节，对吧？
2.  为什么 esp = ff7f68？我认为它应该等于 &c-4
3.  另一个问题是，如果我这样做：

    ```
    printf("%x", ebp-4); 
    ```

输出是

```
ff7f78 
```

谁能解释为什么我的输出不是 ff7f84 ？

谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:59:44.917

1.  不，编译器可以为所欲为。

2.  不，编译器可以为所欲为。

3.  您可能声明`ebp`为`char *`. 您正在看到指针运算的结果。在这种情况下，它看起来像是一个指向 4 字节类型的指针。无论如何，您不应该使用`%x`打印指针。这`%p`就是为了。

# c# - 我可以使用两个带有 DetailsView 控件的下拉列表来插入新记录吗

> ID：14791454
> 
> 赞同：0
> 
> 时间：2013-02-09T20:50:30.237
> 
> 标签：c#, asp.net, controls, detailview

我认为以前没有人问过这个问题（或者至少我找不到类似的问题），如果是这样，我很抱歉。

我有一个我正在构建的 asp.net 网页，其中有两个下拉列表绑定到两个不同的对象数据源。第一个 ddl 显示客户名称列表，一旦选择，第二个 ddl 列表显示客户已购买的产品名称。该页面旨在插入“事件”记录，因此一旦选择了客户和产品，我喜欢使用详细视图（默认模式设置为 INSERT 并绑定到第三个对象数据源（事件表））来创建一个新的记录。

那么我的问题是，是否有可能以某种方式从两个 ddl 中获取值并将这些值与 detailsview insertitem 模板一起使用以插入新记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T05:48:39.993

如果您像我一样是新的 Web 开发人员，那么以下链接可以帮助您纠正将 ddl 放入 insertitem 模板的过程中的错误，以防您的过程出现错误。 [https://www.youtube.com/watch?v=k1jdrRoqJ6w](https://www.youtube.com/watch?v=k1jdrRoqJ6w)

[https://www.youtube.com/watch?v=03stYtlAemU](https://www.youtube.com/watch?v=03stYtlAemU)

我希望这将有所帮助。

# android - 从win7复制adt-bundle到win8

> ID：14791456
> 
> 赞同：0
> 
> 时间：2013-02-09T20:50:39.967
> 
> 标签：android, windows, eclipse-adt

我正在尝试将我的 adt-bundle 目录从 win7 复制到 win8，包括 sdk。以前有人试过吗？这是个好主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:54:17.743

到目前为止，一切都很好。我复制了 ADT 捆绑包（eclipse + adt + sdk）和我的旧工作区，不得不将几个项目中的依赖项更改为新路径，现在一切都按预期工作。

# php - Phalcon：使用问号接收动作参数或如何从 GET 方法获取变量

> ID：14791457
> 
> 赞同：0
> 
> 时间：2013-02-09T20:50:40.593
> 
> 标签：php, apache, mod-rewrite, routes, phalcon

我必须使用 http GET 方法从另一台服务器（令牌）接收信息。我可以在我得到它的时候更改 URL，所以我想我可以尝试让 GET 成为这样的操作中的参数：

```
start/tokenize/token?code=doekoedjorcfoehof 
```

事实证明，在“？”之后的一切 被忽略。我也尝试定义一条路线：

```
$di->getRouter()->add("/tokenize?code={code}", "Start::tokenize"); 
```

所以这也被忽略了......

我认为 '？' 与 apache mod_rewrite 有关，是否可以使用特殊的 mod_rewrite 规则检索 GET？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T03:32:14.490

Router 组件无法从查询字符串中进行路由，它只解析路由 uri：

```
start/tokenize/token?code=doekoedjorcfoehof 
```

该 URL 的路由如下：

```
$di['router'] = function() {

    $router = new Phalcon\Mvc\Router(false);

    $router->add('/start/tokenize/token', array(
        'controller' => 'tokenize',
        'action' => 'parse'
    ));

    return $router;
}; 
```

在您的控制器中：

```
<?php

class TokenizeController extends Phalcon\Mvc\Controller
{
    public function parseAction()
    {
        $code = $this->request->getQuery('code');
    }
} 
```

# ruby - 哪个 ruby 测试库使用（或已经使用）类级语法 `expect {}`？

> ID：14791464
> 
> 赞同：0
> 
> 时间：2013-02-09T20:51:16.823
> 
> 标签：ruby, testing, shoulda

我正在翻新一些旧测试，它们似乎是 Test::Unit with Shoulda。有些部分有语法`expect {block}`，但我在当前的 Shoulda 代码中找不到任何期望的引用。 `expect`出现在班级级别，在那里我看到其他`setup`或`should`陈述。

# javascript - 重置 RaphaelJS 转换

> ID：14791467
> 
> 赞同：1
> 
> 时间：2013-02-09T20:51:37.603
> 
> 标签：javascript, svg, raphael

我有一张纸，其中包含一些用户可以拖动和调整大小的元素。有没有办法重置这些元素信息，以便后续转换从那里开始？

如果我使用`transform('T')`，那么位置或大小的变化是从用户会话开始的，如果我使用`transform('...T')`，那么它是从上一个转换开始的。我想在某些时候从根本上重置原点，以便`transform('T')`从这些保存的状态中工作。希望这是有道理的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T10:02:33.977

根据[Raphael 的文档，](http://raphaeljs.com/reference.html#Element.transform)使用以下内容：

```
// to reset transformation call method with empty string
el.transform(""); 
```

# javascript - 如何使用 Javascript 在 pdf 上打印表格？

> ID：14791471
> 
> 赞同：2
> 
> 时间：2013-02-09T20:51:49.193
> 
> 标签：javascript, pdf, html-table, jspdf

使用 JavaScript 以 PDF 格式打印表格的最佳方法是什么？

例如，我有下一个代码，如果您点击“显示 PDF”，表格会在新窗口中以 PDF 格式出现。是否可以使用 jsPDF 库来实现这一点？

```
<body>
    <table>
        <tr>
            <th>example</th>
            <th>example2</th>
        </tr>
        <tr>
            <td>value1</td>
            <td>value2</td>
        </tr>
    </table>
    <br>
    <input type="button" value="Show PDF">
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T20:57:56.540

Bytescout 有新的 javascript 产品“PDF Generator SDK for Javascript”，它能够在客户端 100% 生成 PDF 文件，可能您可以生成带有文本、图像、图形的 PDF。不支持完整的 HTML 格式，但您可以在文本中使用 , , html 标签来使用富格式（新版本将支持文本中的 和 html 标签）

生成带有徽标和表格的发票演示：http: [//bytescout.com/products/developer/pdfgeneratorsdkjs/create_pdf_invoice_javascript.html](http://bytescout.com/products/developer/pdfgeneratorsdkjs/create_pdf_invoice_javascript.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-11T16:41:51.117

我有同样的问题，这是我解决它的方式。

```
//inputs starts here

var T_X =20 //Starting X of Table
var T_Y =25 //Starting Y of Table
var T_W =170 //Width of Table
var T_H =10 //Height of each cell
var Px  =7 // Scale of width in each columns
var Fs  =17 //Font size
var Tp  =7 //Y of all cells text, must change with `Fs`

var c = new Array() //Input Each Row by Adding new c[i]
c[0] = new Array("1","2","3","4","5","6","7");
c[1] = new Array("a","b","c","d","e","f","g");
c[2] = new Array("A","B","C","D","E","F","G");
//c[3] = new Array("Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta");

//inputs ends here
//From This Part to bottom, there is no more inputs, no need to read them.

//i found this function here "http://stackoverflow.com/questions/118241/calculate-text-width-with-javascript"
String.prototype.width = function() {
  var f = Px+'px arial',
      o = $('<div>' + this + '</div>')
            .css({'position': 'absolute', 'float': 'left', 'white-space': 'nowrap', 'visibility': 'hidden', 'font': f})
            .appendTo($('body')),
      w = o.width();

  o.remove();

  return w;
}

var doc = new jsPDF();
doc.text(85, 15, "Table example");

doc.setDrawColor(50,215,50);
doc.setLineWidth(0.5);

var i
var rows = c[0].length
var cols = c.length
var max = new Array()

for(i=0;i<cols;i++)
    max[i]=0

doc.setFontSize(Fs);

for(i=0;i<rows;i+=1)
{
    doc.line(T_X, T_Y+T_H*i,T_W + T_X, T_Y+T_H*i);

    for(var j=0;j<cols;j+=1)
        if(c[j][i].width()>max[j])
            max[j]=c[j][i].width(); 

}
    doc.line(T_X, T_Y+T_H*rows,T_W + T_X, T_Y+T_H*i);

var m = 0
for(i=0;i<cols;i+=1)
{
    for(var j=0;j<rows;j+=1)
        doc.text(T_X + 0.5 + m, Tp+T_Y+T_H*j,c[i][j]);
    doc.line(T_X + m, T_Y ,T_X + m, T_Y + rows * T_H);

    m += max[i];   
}
doc.line(T_X + T_W, T_Y ,T_X + T_W, T_Y + rows * T_H); 
```

希望对您有所帮助，但是为时已晚！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-16T13:03:22.903

试一试 TCPDF
TCPPDF 是一个 PHP 类，用于即时生成 PDF 文件，无需外部扩展。该库还包括一个从现有 PDF 文档中提取数据的类，以及生成各种格式的一维和二维条码的类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-11T14:32:45.493

jsPDF 的 AutoTable 插件可以自动完成制作表格或列表所需的许多任务。您的示例唯一需要的是首先将表转换为 json，然后将其传递给`autoTable()`方法。查看[演示](https://someatoms.github.io/jsPDF-AutoTable)或[repo](https://github.com/someatoms/jsPDF-AutoTable)以获得更高级的示例。

```
function generatePdf() {
    var doc = new jsPDF('p', 'pt');
    var json = doc.autoTableHtmlToJson(document.getElementById("table"));
    doc.autoTable(false, json);
    doc.save('table.pdf');
} 
```

```
function generatePdf() {
   var doc = new jsPDF('p', 'pt');
   var json = doc.autoTableHtmlToJson(document.getElementById("table"));
   doc.autoTable(false, json);
   doc.save('table.pdf');
}
```

```
<table id="table">
  <tr>
    <th>example</th>
    <th>example2</th>
  </tr>
  <tr>
    <td>value1</td>
    <td>value2</td>
  </tr>
</table>
<br>
<input type="button" onclick="generatePdf()" value="Show PDF">

<script src="https://rawgit.com/MrRio/jsPDF/master/dist/jspdf.debug.js"></script>
<script src="https://rawgit.com/someatoms/jsPDF-AutoTable/master/jspdf.plugin.autotable.js"></script>
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-02-09T20:52:18.570

你应该使用 DOMPDF
，： dompdf 是一个 HTML 到 PDF 的转换器。从本质上讲，dompdf 是（大部分）用 PHP 编写的符合 CSS 2.1 的 HTML 布局和渲染引擎。它是一个样式驱动的渲染器：它将下载和读取外部样式表、内联样式标签以及单个 HTML 元素的样式属性。它还支持大多数表现形式的 HTML 属性。

下载domPDF

[http://code.google.com/p/dompdf/](http://code.google.com/p/dompdf/)

```
<?
require  "dompdf_config.inc.php";
$html = <<<STY
<table>
<tr>
<th>example</th>
<th>example2</th>
</tr>
<tr>
<td>value1</td>
<td>value2</td>
</tr>
</table>
</body>
STY;
$dompdf = new DOMPDF();
$dompdf->load_html($html);
$dompdf->render();    
$dompdf->stream("mypdf.pdf", array("Attachment" => 0));
?> 
```

# linux - Linux Shell - 查找前 k 个进程

> ID：14791473
> 
> 赞同：1
> 
> 时间：2013-02-09T20:51:51.093
> 
> 标签：linux, shell, command

我试图弄清楚如何在 linux shell 中获得前 k 个进程。显然，我脑海中浮现的第一件事是`top`，但它似乎没有任何参数来指定要打印的进程数。

使用批处理模式和迭代次数参数，我可以让它产生所有进程的一次迭代并存储输出，但我找不到将列表缩减为某个数字的方法。（当然，我可以获取整个列表并将其裁剪掉，但我使用它的系统有 27000 个进程正在运行，因此检索列表需要几秒钟）。

例子：

```
>top -b -n1
>... (lots more processes here)
>26416 mcm101    20   0  4188  176   96 S  0.0  0.0   0:00.00 character_count
>26604 root      20   0  180m 5684 3532 S  0.0  0.0   0:00.54 sshd
>26616 pwf7      20   0  105m 1792 1432 S  0.0  0.0   0:00.10 bash 
```

我想要的是这样的：

```
>top k
>1 mcm101    20   0  4188  176   96 S  0.0  0.0   0:00.00 character_count
>2 pwf7      20   0  105m 1792 1432 S  0.0  0.0   0:00.10 bash
>... (more processes here)
>k root      20   0  180m 5684 3532 S  0.0  0.0   0:00.54 sshd 
```

有谁知道如何使用`top`或任何其他命令来实现此结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:01:17.780

这个怎么样：

```
top -b -n1 | grep '^ *[0-9]' | head -n $k 
```

`top`将按照 CPU 使用率的顺序输出所有进程，`grep`从输出中选择那些以数字开头的行（即那些以 PID 开头的行），并从该输出中输出`head`第一`k`行。

# javascript - 将数组传递给 Javascript 函数

> ID：14791477
> 
> 赞同：1
> 
> 时间：2013-02-09T20:52:17.860
> 
> 标签：javascript, jquery, ajax

我正在使用 Web 服务来填充选择列表，现在我需要对许多选择列表执行相同的操作，最好使用相同的方法来尝试限制代码量。这是我用来进行 Web 服务调用的方法：

```
function GetColourReferences(self) {
    $.ajax({
        async: false,
        cache: false,
        type: 'GET',
        url: '/GetColourReferences',
        success: function (data) {
            self.colourReferences(data);
        }
    });
} 
```

我已经尝试过类似于以下的方法，但我无法让它工作 - 甚至可能吗？

```
function GetReferences(self, list, refUrl) {
    $.ajax({
        async: false,
        cache: false,
        type: 'GET',
        url: refUrl,
        success: function (data) {
            list(data);
        }
    });
} 
```

我是这样称呼它的（我正在使用 Knockout）：

```
GetReferences(self, self.colourReferences, '/GetColourReferences'); 
```

谢谢你看:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T12:53:11.997

1）不管你的借口是什么，听听别人的提示永远不要使用同步调用，特别是如果你的后端处理速度很慢或者你有一些凌乱的用户界面要求。

2）理清你的闭包并学习如何确定对象的范围方法，你会解决你的问题，但我会很好，并为你指明正确的方向。

3）这不起作用，因为您传递了对函数的引用，而不是对对象方法的引用，所以巧妙地称为 self （WTF 你听说过语义）那个备用列表是失去对象范围的函数，并且这就是问题所在！

```
function GetReferences(self, list, refUrl) {
    $.ajax({
        async: false,
        cache: false,
        type: 'GET',
        url: refUrl,
        success: function (data) {
            list.call(self, data);
        }
    });
} 
```

希望有所帮助。

# c++ - 使用 c/c++ 以编程方式从 html 文件中提取表

> ID：14791480
> 
> 赞同：2
> 
> 时间：2013-02-09T20:52:22.190
> 
> 标签：c++, html, c, xml-parsing, html-parsing

我正在寻找从 html 文件中提取表格的更好的想法。现在我正在使用 tidy ( [http://tidy.sourceforge.net/](http://tidy.sourceforge.net/) ) 将 html 文件转换为 xhtml，然后我使用 rapidxml 来解析 xml。在解析时，我将查找`<table>`、`<tr>`和`<td>`节点，从而创建我的表数据结构。

它工作得很好，但我想知道是否有更好的方法来完成我的任务。此外，整洁的库似乎是一个废弃的项目。

还有大家有没有试过整洁源代码中的“实验性”补丁？

谢谢，克里斯蒂安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T00:58:23.840

我觉得你的方法还可以。我认为最好的方法是整理并将html转换为xhtml并解析xml。看不到如何简化。

你没有提到任何问题，所以我不确定问题是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-10T14:59:53.713

你可以使用 htmlparser ( [https://github.com/HamedMasafi/htmlparser](https://github.com/HamedMasafi/htmlparser) ) 这个库可以解析、读取和修改 html 和 css

例如，在您阅读表格的情况下

```
 html_parser html;
    html.set_text(html_text);
    auto table = html.query("#table_id").at(0);
    for (auto tr : table->childs()) {
        for (auto td : tr->childs()) {
            //now here you have a td and you are free to any modify are data read
            //e.g:
            auto td_tag = dynamic_cast<html_tag*>(td);
            td_tag->set_attr("id", "new_id"); // change attr
            auto id = td_tag->attr("id");
            auto test = td_tag->innser_text();
            auto html = td_tag->outter_html();
        }
    } 
```

快速入门示例在[这里](https://github.com/HamedMasafi/htmlparser/blob/master/main.cpp)

# python - Python中的矩阵问题

> ID：14791485
> 
> 赞同：0
> 
> 时间：2013-02-09T20:52:38.177
> 
> 标签：python, class, methods, matrix, outofrangeexception

我正在尝试将我的 Java 类转录为 Python。最后一个是 Warshall 算法，但是当我运行应用程序时，我得到了这个错误：

```
C:\Python33\python.exe C:/Users/Joloch/PycharmProjects/Varios/Warshall.py
Inserte un valor para n (la matriz será cuadrada, por lo que es nxn):
3
Inserte un dato en la posición 0 0 :
Inserte un dato en la posición 0 1 :

Traceback (most recent call last):
  File "C:/Users/Joloch/PycharmProjects/Varios/Warshall.py", line 93, in <module>
    Warshall().main()
  File "C:/Users/Joloch/PycharmProjects/Varios/Warshall.py", line 59, in main
    obj.Matriz[x][y] = Dato
IndexError: list assignment index out of range

Process finished with exit code 1 
```

这是代码，如果您能告诉我我做错了什么，我将不胜感激：

```
from Tools.Scripts.treesync import raw_input

class Warshall(object):
    pass

    Matriz = [],[]
    Lado = 0

    def __init__(self):
        return

    @classmethod
    def Funcion(self, A, B, C):
        if ((self.Matriz[A][B] == 1) ^ (self.Matriz[A][C] == 1) & (self.Matriz[C][B] == 1)):
            return 1
        else:
            return 0

    def main(self):
        obj = Warshall()
        Dato = 0
        x = 0
        y = 0
        z = 0
        Uno = 0
        Dos = 0
        Tres = 0
        Cuatro = 0
        print("Inserte un valor para n (la matriz será cuadrada, por lo que es nxn): ")
        obj.Lado = int(raw_input(""))
        obj.Matriz = [obj.Lado],[obj.Lado]
        while x < obj.Lado:
            while y < obj.Lado:
                print("Inserte un dato en la posición", x, y,": ")
                try:
                    Dato = int(raw_input())
                except TypeError:
                    print()
                obj.Matriz[x][y] = Dato
                y += 1

            while z <= obj.Lado - 1:
                while Uno <= obj.Lado - 1:
                    while Dos <= obj.Lado - 1:
                        obj.Matriz[Uno][Dos] = obj.Funcion(Uno, Dos, z)
                        Dos += 1
                    Uno += 1
                z += 1

            print()
            print("Matriz de adyacencia correspondiente: ")

            while Tres < obj.Lado:
                while Cuatro < obj.Lado:
                    print(obj.Matriz[Tres][Cuatro])
                    print()
                    Cuatro += 1
                Tres += 1

if __name__ == '__main__':
    Warshall().main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:02:45.070

这段代码的结构，啊，奇怪的方式使得很难理清到底发生了什么。

您的错误的根源是其中`obj.Matriz`包含两个长度为 1 的列表的元组，而不是您期望的`Lado`by `Lado`by 数组。如果你打印出来，`obj.Matriz`你会得到`([5], [5])`（如果`Lado == 5`）。

尝试更多类似的东西

```
obj.Matriz = [[0 for j in range(obj.Lado)] for k in range(obj.Lado)] 
```

这将为您提供填充`Lado`的长度列表。如果你正在做数字工作，你可能也想研究一下。`Lado``0``numpy`

# printf - 关于使用 printf 函数绘制矩形类的练习

> ID：14791490
> 
> 赞同：1
> 
> 时间：2013-02-09T20:53:07.377
> 
> 标签：printf

所以问题如下：

“为 Rectangle 类编写一个名为 draw 的方法，该方法使用破折号和竖线字符绘制一个矩形。以下代码序列

```
Rectangle *myRect = [[Rectangle alloc]init];
[myRect setWidth : 10 andHeight : 3];
[myRect draw]; 
```

将产生以下输出：“

（我无法向您展示图片，但它是由“-”破折号和“|”条形字符组成的矩形。破折号用于宽度，条形字符用于高度。）

我已经开始做这样的方法：

```
{
int n;

for ( n = 1 ; n <= self.width ; ++n)
    printf ("-");

for ( n = 1 ; n <= self.height ; ++n){
    printf ("\n|");
        }
    printf("\n");

for ( n = 1 ; n <= self.width ; ++n){
    printf ("-");
} 
```

但它似乎不会那样工作，我无法让它显示外部 (|) 行。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:06:19.413

我相信您正在使用 Objective-C，但这里有一组简单的代码，我在 C 中测试过，应该很容易翻译：

```
void printRectangle(int width, int height)
{
     int n;
     int z;

     printf(" ");

     for (n = 1 ; n <= width ; n++)
        printf ("-");

     printf("\n");

     for ( n = 1 ; n <= height ; n++)
     {
        printf ("|");

        for(z = 1; z <= width; z++)
             printf(" ");

        printf("|\n");
     }

     printf(" ");

     for ( n = 1 ; n <= width ; ++n)
         printf ("-");

     printf("\n");
} 
```

输出宽度 = 10，高度 = 5

```
 ----------
|          |
|          |
|          |
|          |
|          |
 ---------- 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:07:22.817

抱歉，我没有看到上面接受的答案。但是，我会留下这个以防万一。

我还没有在目标 C 中测试过它。但是试一试:)

```
for (int y = 0; y <= self.width; y++) {
    for (int x = 0; x <= self.width; x++) {
        if (x == 0 || y == 0 || x == self.width || y == self.height) {
            if (y == 0 || y == self.height) {
                printf("-");
            }
            else if (x == 0 || x == self.width) {
                printf("|");
            }
            if (x == 10) {
                printf("\n");
            }
        } else {
            printf(" ");
        }
    }
  } 
```

这是用java编写的，我只是更改了一些单词以匹配您的单词。:)

输出：

```
-----------
|         |
|         |
|         |
|         |
|         |
|         |
----------- 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-17T16:19:23.047

```
//  Created by Victor Diaz  on 11/10/13.
//  Copyright (c) 2013 Victor Diaz . All rights reserved.
//  lines of code are submitted but  i have just inputed here the function draw

-(void)draw{
    int i=0;
    printf(" ");
    for(i=0; i<=width;i++){
        printf("-");
    }
    printf("\n");
    for(i=0;i<=height;i++){
        printf("|");
        for (int z=0; z<width; z++)
            printf(" ");
            printf(" |\n");
    }
    printf(" ");
    for (i=0; i<=width; i++) {
        printf("-");
    }
    printf("\n");
}
@end 
```

# iphone - 如何检测点击/单击 UIImageView？

> ID：14791494
> 
> 赞同：1
> 
> 时间：2013-02-09T20:54:11.103
> 
> 标签：iphone, ios, objective-c, uiimageview

我正在尝试开发一个包含一些图像的应用程序，所以我做了这样的事情：

`@property (nonatomic, retain) IBOutletCollection(UIImageView)NSArray* photos;`

我正在用以下内容填充这些`UIImageView`数组：

`[self.photos[i] setImage:[UIImage imageWithData:data]];`

现在，我需要执行 segue，这会将用户重定向到另一个视图，即单击哪个图像。

例子 ：

假设我有 20 张图片和视图，如果用户点击第一张图片，那么他应该被重定向到查看，如果用户点击第二张，那么相同的视图等等......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T11:02:47.213

我喜欢在 UIImageView 上添加遮罩按钮以响应用户触摸，但请注意 UIImageView 的 userInteractionEnabled 是`NO`默认设置的。

下面是示例代码，实际上我们总是将按钮设置为透明。

```
CGRect imageRect = (CGRect){100, 100, 100, 100};
UIImageView *imageView = [[[UIImageView alloc] initWithFrame:imageRect] autorelease];
imageView.backgroundColor = [UIColor yellowColor];
[self.view addSubview:imageView];
imageView.userInteractionEnabled = YES;

UIButton *maskBtn = [UIButton buttonWithType:UIButtonTypeCustom];
maskBtn.frame = imageView.bounds;
maskBtn.backgroundColor = [UIColor redColor];
[maskBtn addTarget:self action:@selector(maskBtnDidClick:) forControlEvents:UIControlEventTouchUpInside];
[imageView addSubview:maskBtn]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T21:10:01.460

如果您使用 UIImageView，那么要处理点击，您必须创建 UITapGestureRecognizer，给它们一个选择器方法，并将它们添加到 imageViews，并处理相应选择器中的点击。

更好的方法是使用自定义 UIButtons 而不是 UIImageView，并将它们与直接来自 storyboard/xib 的操作挂钩，并处理这些操作中的按钮按下事件。因此，您可以防止在每个 imageViews 中添加 UITapGestures。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T04:28:39.280

有三种方法
1）您可以使用 TapGestures
2）您可以使用 UIControl 并在 UIControl 中添加 ImageView 并将 Selector 提供给 UIControl
3）将您的图像添加到自定义 UIButton

# c++ - 使用 atomic_flag 自旋锁进行内存排序

> ID：14791495
> 
> 赞同：5
> 
> 时间：2013-02-09T20:54:12.210
> 
> 标签：c++, c++11, atomic

我正在尝试熟悉 c++11 的新内存排序概念，并相信我实际上对它们有很好的掌握，直到我偶然发现了自旋锁的这种实现：

```
#include <atomic>

namespace JayZ
{
    namespace Tools
    {
        class SpinLock
        {
        private:
            std::atomic_flag spin_lock;
        public:
            inline SpinLock( void ) : atomic_flag( ATOMIC_FLAG_INIT ) {}

            inline void lock( void )
            {
                while( spin_lock.test_and_set( std::memory_order_acquire ) )
                    ;
            }

            inline void unlock( void )
            {
                lock.clear( std::memory_order_release );
            }
        };
    }
} 
```

[例如，在http://en.cppreference.com/w/cpp/atomic/atomic_flag](http://en.cppreference.com/w/cpp/atomic/atomic_flag)
和“Concurrency in Action”一书中等价地提到了它。我还在 SO 的某个地方找到了它。

但我就是不明白为什么它会起作用！
想象一下线程 1 调用 lock() 并且 test_and_set() 返回 0 作为旧值 --> 线程 1 获得了锁。
但随后线程 2 出现并尝试相同。现在由于没有发生“存储同步”(release,seq_cst_acq_rel) 线程 1 到 spin_lock 的存储应该是放松类型。
但由此得出，它不能与线程 2 对 spin_lock 的读取同步。这应该使线程 2 可以从 spin_lock 读取值 0 并因此也获取锁。
我的错误在哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T20:58:32.690

您的错误在于忘记了这`spin_lock`是一个原子操作`atomic_flag`，因此`test_and_set`是一个原子操作。`memory_order_acquire`需要and`memory_order_release`来防止读取迁移到锁定操作之前或写入迁移到解锁之后。锁本身受到原子性的保护，原子性始终包括可见性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-04T04:02:35.137

对于给定的原子变量，它有一个“修改顺序”。一旦线程 1 test_and_set 将值从 0 设置为 1，线程 2 就不可能看到 0。

内存顺序会影响所有其他内存地址的“同步”方式。如果一个线程使用 memory-order_release 修改了一个原子变量，那么任何使用 memory_order_acquire 读取相同变量的线程都会“看到”第一个线程在释放之前所做的每个内存更改。

获取和释放与原子无关。这是为了确保成功锁定自旋锁的每个线程“看到”之前锁定它的每个线程的更改。

修改顺序是使算法无锁的关键。线程 1 和线程 2 都试图对同一个变量执行 test_and_set，因此按照规则，一个修改“发生在”另一个修改之前。因为“发生在”另一个“进展”之前的 test_and_set，所以至少一个线程必须始终取得进展。这是lockfree的定义

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T23:23:15.017

`test_and_set`原子标志上的操作被指定为具有特殊特征*的读-修改-写*操作，其中之一是：

> 原子读-修改-写操作应始终读取在与读-修改-写操作关联的写之前写入的最后一个值（按修改顺序）。[n3337 § 29.3/12]

这也是为什么`fetch_add`，例如，可以工作，而简单的加载操作不需要读取修改顺序中的最新值。

# c++ - C++：类和构造函数的使用

> ID：14791496
> 
> 赞同：0
> 
> 时间：2013-02-09T20:54:29.797
> 
> 标签：c++, class, quantlib

我在使用 QuantLib 库中的 QuantLib::TimeSeries 类时遇到了麻烦。我的问题与 QuantLib 及其复杂性无关，但我认为在更一般的 C++ 类使用中。

[此处](http://quantlib.org/reference/class_quant_lib_1_1_time_series.html)描述了 QuantLib::TimeSeries 。在我的代码中（现在绝对不返回任何内容），我在 std::vector 中提供了一系列日期，在 std::vector 中提供了一系列价格。QuantLib::TimeSeries 对象应该将日期和价格联系在一起。

```
#include<ql\quantlib.hpp>

int main()
{
    std::vector<QuantLib::Date> dates;
    std::vector<std::double> quotes;

        dates.push_back(Date(12,Nov, 2012));
    dates.push_back(Date(13,Nov, 2012));
    dates.push_back(Date(14,Nov, 2012));

    quotes.push_back(40.05);
    quotes.push_back(40.84);
    quotes.push_back(41.03);

    // Below is the line I am stuck at 
    QuantLib::TimeSeries<std::vector<QuantLib::Date>, std::vector<double>> series(dates.begin(), dates.end(), quotes.begin());

    // Now do something with all the stuff above
    // ... ...

    return 0;
} 
```

我很感激有人提供指导，帮助我完成这项工作。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:02:11.273

我认为你的困难线应该是这样的：

```
QuantLib::TimeSeries<double> series(dates.begin(), dates.end(), quotes.begin()); 
```

从您链接的文档中：

```
template<class T, class Container = std::map<Date, T>>
class QuantLib::TimeSeries< T, Container >; 
```

第一个参数是您存储的类型，在您的情况下`double`，第二个参数可能是容器用作实现的一个，并且它已经有一个默认实现，所以什么都不需要。

# java - JFileChooser 作为 JDialog 父级

> ID：14791501
> 
> 赞同：0
> 
> 时间：2013-02-09T20:55:39.453
> 
> 标签：java, swing, jdialog, jfilechooser

在 JFileChooser 中，当尝试覆盖文件时，我希望我的程序提示用户他将要这样做。

这是在用户按下 JFileChooser 中的 APPROVE_OPTION 时完成的。

但是，我不希望 JFileChooser 立即关闭，但如果这样的文件已经存在，则显示一个 JDialog，如果用户想要覆盖，覆盖，否则关闭 JDialog 并返回到 JFileChooser。

我知道我可以在打开 JDialog 之前保存 JFileChooser 条件，如果用户选择不覆盖，只需使用我保存的信息重新创建整个 JFileChooser。

但我想知道是否有更简单的方法。在那儿？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T21:05:27.750

您应该能够覆盖approveSelection() 方法。

```
final JFileChooser chooser = new JFileChooser( new File(".") )
{
    public void approveSelection()
    {
        if (getSelectedFile().exists())
        {
            System.out.println("Do You Want to Overwrite File?");
            return;
        }
        else
            super.approveSelection();
    }
}; 
```

您可以使用 JOptionPane 提示用户，而不是显示消息。如果用户接受，那么您调用 super.approveSelection();

# pointers - 派生类型的 Fortran 90/95 指针

> ID：14791502
> 
> 赞同：0
> 
> 时间：2013-02-09T20:55:40.407
> 
> 标签：pointers, fortran, derived-types

我有一个派生类型，它带有指向第二个派生类型数组的指针

```
TYPE vertex
   REAL :: x, y, z
END TYPE

TYPE path
   TYPE(vertex), DIMENSION(:), POINTER :: vertices => NULL()
END TYPE 
```

目的是使顶点数组可调整大小，以便可以将任意数量的顶点添加到数组中。我已经创建了将顶点附加到该指针的代码。

```
SUBROUTINE path_append_vertex(this, x, y, z)
IMPLICIT NONE

!-------------------------------------------------------------------------------
!  Variable declarations.
!-------------------------------------------------------------------------------
TYPE(path), INTENT(inout) :: this
REAL, INTENT(in)   :: x, y, z

!-------------------------------------------------------------------------------
!  Local Variable declarations.
!-------------------------------------------------------------------------------
INTEGER :: status
TYPE(vertex), DIMENSION(:), ALLOCATABLE :: vertices

!-------------------------------------------------------------------------------
!  Start of executable code
!-------------------------------------------------------------------------------
IF (ASSOCIATED(this%vertices)) THEN
! Create a temporary array the same size as current number of vertices. Copy the
! contents of the old array to the new array then delete the old array.
   ALLOCATE(vertices(SIZE(this%vertices)), STAT = status)
   CALL check_status(status)
   vertices = this%vertices
   DEALLOCATE(this%vertices)

! Create a new array with one extra element. Copy the contents of the temporary
! array to the new one the delete the temporary array.
   ALLOCATE(this%vertices(SIZE(vertices) + 1), STAT = status)
   CALL check_status(status)
   this%vertices(1:SIZE(vertices)) = vertices
   DEALLOCATE(vertices)

   this%vertices(SIZE(this%vertices))%x = x
   this%vertices(SIZE(this%vertices))%y = y
   this%vertices(SIZE(this%vertices))%z = z
ELSE
   ALLOCATE(this%vertices(1), STAT = status)
   CALL check_status(status)

   this%vertices(1)%x = x
   this%vertices(1)%y = y
   this%vertices(1)%z = z
ENDIF

END SUBROUTINE 
```

我创建了一些路径对象。

```
TYPE ipch_desc
   ...
   TYPE(path) :: chordPath
END TYPE

SUBROUTINE ipch_desc_construct(this, ...)
...
TYPE (ipch_desc), INTENT(inout)          :: this
...
!  Must NULL out the vertices array or else it will point to the last
!  integration_path created in memory. Not sure why these are defaulting
!  to NULL
this%chordPath%vertices => NULL()

CALL path_append_vertex(this%chordPath, xcart_i(1), xcart_i(2), xcart_i(3))
CALL path_append_vertex(this%chordPath, xcart_f(1), xcart_f(2), xcart_f(3))

!  Check the value of the path vertices.
write(*,*) this%chordPath%vertices

END SUBROUTINE 
```

一切都很好，我得到了每个顶点的正确值。例如，对于创建的三个路径对象，我得到

```
 -0.33808113528699218        1.0467574437103653       0.10713720000000000      -0.16057879084545851       0.49717960298733294       0.10713720000000000     
 -0.33322243268266594        1.0483142707971911       1.42240000000000010E-003 -0.14945358419461796       0.47017940500485894       1.42240000000000010E-003
 -0.33656460666251325        1.0472460386853264      -0.10629900000000000      -0.15821659220752302       0.49230280357365630      -0.10629900000000000 
```

稍后在代码中使用这些路径对象时，

```
SUBROUTINE ipch_mc_model_compute(a_ipch, ...)
...
TYPE (ipch_desc), INTENT (inout)     :: a_ipch
...
!  Check the value of the path vertices again.
write(*,*) a_ipch%chordPath%vertices
...
END SUBROUTINE 
```

只有前 N-1 个值保持正确。对于上面创建的相同值，我得到，

```
 -0.33808113528699218        1.0467574437103653       0.10713720000000000      -0.16057879084545851       0.49717960298733294       0.10713720000000000     
 -0.33322243268266594        1.0483142707971911       1.42240000000000010E-003 -0.14945358419461796       0.47017940500485894       1.42240000000000010E-003
  0.15094203233057696       6.94277920927416864E-310 -0.10629900000000000       1.63041663127611360E-322  3.01884064661153912E-003  6.94277920927179713E-310 
```

无论`path`我创建多少个对象，第 N 个总是以错误的值结束。这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:30:03.307

您的代码似乎正确。你可以稍微简化一下。为什么派生类型 PATH 包含单个变量？您可以直接调整类型为 VERTEX 的数组的大小，而无需此附加类型。另外，我认为没有理由使用指针。allocatable 看起来就足够了。Fortran 2003 提供 MOVE_ALLOC，它还将提供简化（如果在您使用的编译器中可用）（请参阅[在分配的向量 fortran 中插入值更改形状](https://stackoverflow.com/questions/14607020/insert-a-value-changing-shape-in-allocated-vector-fortran)）。

```
module vertex_stuff

TYPE vertex
   REAL :: x, y, z
END TYPE

contains

SUBROUTINE path_append_vertex(this, x, y, z)
IMPLICIT NONE

!-------------------------------------------------------------------------------
!  Variable declarations.
!-------------------------------------------------------------------------------
TYPE(vertex), dimension (:), allocatable, INTENT(inout) :: this
REAL, INTENT(in)   :: x, y, z

!-------------------------------------------------------------------------------
!  Local Variable declarations.
!-------------------------------------------------------------------------------

TYPE(vertex), DIMENSION(:), ALLOCATABLE :: tmp_vertices

!-------------------------------------------------------------------------------
!  Start of executable code
!-------------------------------------------------------------------------------
IF (allocated(this)) THEN
! Create a temporary array the same size as current number of vertices. Copy the
! contents of the old array to the new array then delete the old array.
   ALLOCATE(tmp_vertices(SIZE(this)))
   tmp_vertices = this
   DEALLOCATE(this)

! Create a new array with one extra element. Copy the contents of the temporary
! array to the new one the delete the temporary array.
   ALLOCATE(this(SIZE(tmp_vertices) + 1))
   this(1:SIZE(tmp_vertices)) = tmp_vertices
   DEALLOCATE(tmp_vertices)

   this(SIZE(this))%x = x
   this(SIZE(this))%y = y
   this(SIZE(this))%z = z
ELSE
   ALLOCATE(this(1))

   this(1)%x = x
   this(1)%y = y
   this(1)%z = z
ENDIF

END SUBROUTINE

SUBROUTINE output_vertices (this)
IMPLICIT NONE

TYPE(vertex), dimension (:), INTENT(in) :: this
integer :: i

write (*, '(// "Current vertices:" )' )

do i=1, size(this)
   write (*, '( 3F5.2 )' ) this (i) % x, this (i) % y, this (i) % z
end do

end SUBROUTINE output_vertices

end module vertex_stuff

program vertices

use vertex_stuff

implicit none

TYPE (vertex), dimension (:), allocatable :: this

call path_append_vertex(this, 1.0, 1.1, 1.2)
call output_vertices (this)

call path_append_vertex(this, 2.0, 2.1, 2.2)
call output_vertices (this)

call path_append_vertex(this, 3.0, 3.1, 3.2)
call output_vertices (this)

call path_append_vertex(this, 4.0, 4.1, 4.2)
call output_vertices (this)

call path_append_vertex(this, 5.0, 5.1, 5.2)
call output_vertices (this)

end program vertices 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:55:20.783

我弄清楚问题出在哪里。该`ipch_desc`对象被构造为一个临时对象，然后分配给数组中的一个元素。

```
ipch_desc_arr(icount_chords) = ipch_desc_temp 
```

我要么需要删除这个临时的，要么需要重载默认的赋值运算符来修复它。

# java - 如何在图像（背景）上获取 JButton？

> ID：14791506
> 
> 赞同：0
> 
> 时间：2013-02-09T20:56:43.233
> 
> 标签：java, swing, user-interface, jbutton

我使用一个图像作为背景，然后我有另一个图像作为 JButton。背景图像当前与按钮重叠，因此您看不到它。当我注释掉 repaint() 时，按钮在前面，但是因为我重新定位了按钮，所以该空间从背景图像中淡出。所以基本上，我必须如何处理我的代码才能将按钮放在背景图像前面（背景图像仍然完好无损）？

```
public class Start extends JFrame {

JPanel jp = new JPanel();
JButton startButton = new JButton();
private Image dbImage;
private Graphics dbg;
Image backgroundFirst;
int backx;
int backy;

public Start() {
    ImageIcon i = new ImageIcon(
            "C:/Users/Mel/workspace/camptycoon/javagame/src/javagame/background1.png");
    backgroundFirst = i.getImage();

    startButton
            .setIcon(new ImageIcon(
                    "C:/Users/Mel/workspace/camptycoon/javagame/src/javagame/start.png"));
    jp.add(startButton);
    startButton.setLayout(getLayout());
    add(jp);
    validate();

    // Frame Properties
    setTitle("Counselor Training");
    setVisible(true);
    setSize(755, 600);
    setDefaultCloseOperation(EXIT_ON_CLOSE);

}

public LayoutManager getLayout() {
    int x = 540;
    int y = 475;
    startButton.setLocation(x, y);
    startButton.setBorder(null);

    return null;

}

public void paint(Graphics g) {
    dbImage = createImage(getWidth(), getHeight());
    dbg = dbImage.getGraphics();
    paintComponent(dbg);
    g.drawImage(dbImage, 0, 0, this);
}

public void paintComponent(Graphics g) {
    backx = 10;
    backy = 30;

    g.setColor(Color.BLUE);
    g.drawImage(backgroundFirst, backx, backy, this);
    //repaint();
}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T20:59:04.480

我知道一些常用的解决方案：

*   使用将图像保存在其 ImageIcon 中的 JLabel 作为您的 contentPane，确保为其提供体面的布局管理器，或者
*   使用 JPanel 作为 contentPane 并在其`paintComponent(...)`方法中绘制图像。
*   将 JLayeredPane 与最底层的组件（可能是 JLabel）保存的图像一起使用。我主要将其用于动画工作，我想将组件/精灵从一层提升到另一层。

* * *

补充说明：

*   不要忘记为`@Override`您认为是覆盖的所有方法使用注释，因为您可能会惊讶地发现实际上不是（例如，您上面的 `paintComponent(...) 方法）。
*   您几乎从不重写 JFrame 的`paint(...)`方法，因为它可能没有按照您认为的那样做，而且您有可能产生不必要的副作用。
*   事实上，避免覆盖*任何*组件的`paint(...)`方法是个好主意。
**   您应该努力避免使用空布局。*   你的`getLayout()`方法覆盖对我来说看起来很恶心。不要这样做。*   如果您想将 JPanel 嵌套在图像显示组件的顶部，请确保通过调用它们将覆盖的 JPanel（或其他组件）设置为不透明`setOpaque(false)`。*

# jquery - 如何在 jQuery 事件处理程序中获取父节点？

> ID：14791510
> 
> 赞同：0
> 
> 时间：2013-02-09T20:56:50.047
> 
> 标签：jquery

考虑这段代码：

```
<div id="div1">
    <input type="radio" class="a" />
    <input type="radio" class="b"/>
    //....
    <input type="radio"  class="n" />
</div>
<div id="div2">
    <input type="radio" class="a" />
    <input type="radio" class="b"/>
    //....
    <input type="radio"  class="n" />
</div> 
```

现在我想将委托事件处理程序绑定到这些单选按钮，如下所示：

```
$("div").on("change","input",myHandler);

function myHandler(e)
{
  alert($(this).prop("class"));
  alert($(e.currentTarget).prop("class"));  // same results...
} 
```

我的问题是：我如何引用**div**或从 MyHandler 函数获取 div **Id**（它不是通过使用：$(this)、$(e.target) 或 $(e.currentTarget)）所以如何引用**分区**？_

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T20:58:23.463

看看[`event.delegateTarget`](http://api.jquery.com/event.delegateTarget/)。它引用了您将处理程序附加到的 DOM 元素。所以要抓住它的`id`财产：

```
function myHandler(e) {
  alert(e.delegateTarget.id);
} 
```

[**小提琴**](http://jsfiddle.net/fNLvv/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T21:09:09.017

jQuery 有一个 .parent() 函数：[http ://api.jquery.com/parent/](http://api.jquery.com/parent/)

在您的事件处理程序内部：

`$(this).parent()`

# c# - 简化 C# 运行时类型识别的方法，避免 NULL 检查？

> ID：14791514
> 
> 赞同：2
> 
> 时间：2013-02-09T20:57:09.740
> 
> 标签：c#, null, rtti

我发现自己使用一种常见的运行时类型识别模式，尤其是在编写处理不同类型控件的代码时。这是模式：

```
if (ctrl is ControlTypeEtc)
    (ctrl as ControlTypeEtc).SomeMethod(); 
```

我这样做是为了避免在*as*运算符返回 NULL 的情况下进行 NULL 检查。有没有办法将其简化为单个操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T20:59:46.223

没有办法在一次操作中做到这一点。

但是，使用`as`和检查`null`更便宜，因为只有一种情况，而不是代码示例中的两种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T21:03:13.080

我会把它写成：

```
ControlTypeEtc ctrl2 = ctrl as ControlTypeEtc;
if (ctrl2 != null)
    ctrl2.SomeMethod(); 
```

这样可以避免双重检查（可能会优化为一个，但我不确定）。

其他方式：

```
try
{
    ControlTypeEtc ctrl2 = (ControlTypeEtc)ctrl;
    ctrl2.SomeMethod();
}
catch (InvalidCastException e)
{
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T21:07:52.747

底线是“大图”，在您继续编码之前，您应该知道您的实例是否为空。确实没有理由在该步骤周围找到捷径。

也就是说，如果您使用的是 C# 3 或更好的版本，则可以使用 Extensions 方法从代码的主要逻辑中“隐藏”此细节。请参见下面的示例，其中包含“SomeType”和“SomeMethod”，然后是一个名为“SomeMethodSafe”的扩展方法。您可以在 Null 引用上调用“SomeMethodSafe”而不会出错。

不要在家里尝试这个。

```
namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            SomeType s = null;
            //s = new SomeType();
            // uncomment me to try it with an instance

            s.SomeMethodSafe();

            Console.WriteLine("Done");
            Console.ReadLine();
        }
    }

    public class SomeType
    {
        public void SomeMethod()
        {
            Console.WriteLine("Success!");
        }
    }

    public static class SampleExtensions
    {
        public static void SomeMethodSafe(this SomeType t)
        {
            if (t != null)
            {
                t.SomeMethod();
            }
        }
    }
} 
```

# dart - 如何使用 Dart Web UI 处理按键 Enter？

> ID：14791526
> 
> 赞同：6
> 
> 时间：2013-02-09T20:58:44.593
> 
> 标签：dart

我想使用 Dart 的 Web UI 以声明方式在输入字段中侦听 ENTER 按键？如果按下 ENTER，我只想运行一个方法，我不关心任何其他键。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-09T20:58:44.593

**概括**

Dart 的 Web UI 包可以声明式地注册各种事件的处理程序，例如 click 和 keyUp。keyUp 事件将为每个键盘向上事件触发。要过滤这些事件并仅监听特定键，您需要查看 keyCode 属性。幸运的是，Dart 有一个方便的类来规范跨浏览器的键码。您可以在声明性绑定属性中使用所有这些。继续阅读以了解如何操作！

**监听按键**

该类`InputElement`有一个 keyUp 事件的事件流，称为`onKeyUp`( [docs](http://api.dartlang.org/docs/releases/latest/dart_html/InputElementBase.html#onKeyUp) )。流`onKeyUp`发出`KeyboardEvent`( [doc](http://api.dartlang.org/docs/releases/latest/dart_html/KeyboardEvent.html) ) 实例。

```
final Stream<KeyboardEvent> onKeyUp; 
```

**旧的'n Busted**

`KeyboardEvent`提供`keyCode`返回系统特定键码的访问器。不幸的是，一些系统对于相同的语义键有不同的键码。幸运的是，Dart 有一个修复方法！

**新热点**

使用`KeyEvent.wrap(KeyboardEvent parent)`( [doc](http://api.dartlang.org/docs/releases/latest/dart_html/KeyEvent.html) ) 来模拟`KeyEvent`和规范令人困惑的关键代码！

```
new KeyEvent.wrap(keyboardEvent) 
```

现在您有了 的实例`KeyEvent`，您可以查询它`keyCode`以合理地查看按下的键。`keyCode`getter 返回一个，但您可以将其`int`与`KeyCode`( [doc](http://api.dartlang.org/docs/releases/latest/dart_html/KeyCode.html) ) 类中的键列表进行比较。

```
var keyEvent = new KeyEvent.wrap(keyboardEvent);
if (keyEvent.keyCode == KeyCode.ENTER) {
  // enter was pressed
} 
```

**跨浏览器按键 FTW**

`KeyEvent`和类有助于规范跨系统和浏览器的`KeyCode`关键代码，因此您无需担心各种不兼容问题。

**使用网页界面**

Web UI 允许您以声明方式注册事件处理。您可以侦听按键事件并检查是否按下了回车键。这是一个例子：

```
<input type="text" id="new-todo" on-key-up="if (new KeyEvent($event).keyCode == KeyCode.ENTER) createNewTodo()"> 
```

请注意如何`on-key-up`注册 if 语句，该语句使用`KeyEvent`和`KeyCode`来规范化键码。该`createNewTodo`方法仅在按下回车键时调用。

达达！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-12-20T18:13:59.740

不是 Web UI，但这是侦听和使用键盘输入的另一种方式。

1）听按键：

```
void main() {
  ...    
  input.onKeyPress.listen(handleKeyEvent);    
  ...
} 
```

**2) 使用KeyEvent.wrap(keyboardEvent)**构造函数将生成的 KeyboardEvent 转换为 KeyEvent 。然后，您可以通过将 KeyEvent.keyCode 与 KeyCode.Enter 进行比较来执行上述操作：

```
void handleKeyEvent(KeyboardEvent event) {
  KeyEvent keyEvent = new KeyEvent.wrap(event);
  if (keyEvent.keyCode == KeyCode.ENTER) {
    handleInput();       
  }   
} 
```

# php - 在php中获取类定义的目录

> ID：14791529
> 
> 赞同：0
> 
> 时间：2013-02-09T20:58:50.310
> 
> 标签：php

我知道`dirname(__FILE__)`，它返回调用该函数的脚本的目录。有没有办法获取`get_called_class()`定义返回的类的目录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:03:39.837

使用[`ReflectionClass`](http://www.php.net/manual/en/reflectionclass.getfilename.php)：

```
$reflector = new ReflectionClass(get_called_class());
print dirname($reflector->getFileName())); 
```

（这不适用于内部类:)

# sbt - 如何为本地发布指定 Scala 和 SBT 版本？

> ID：14791532
> 
> 赞同：6
> 
> 时间：2013-02-09T20:59:07.970
> 
> 标签：sbt

我正在使用 Scala 2.9.2 和 SBT 0.12.0 开发 SBT 编译器插件。

我的项目使用以下内容`build.sbt`：

```
name := "myplugin"

version := "0.1-SNAPSHOT"

scalaVersion := "2.9.2"

organization := "com.my.org"

sbtVersion := "0.12.0"

libraryDependencies += "org.scala-lang" % "scala-compiler" % "2.9.2" 
```

编写插件后，我将使用该插件将其发布到本地 Ivy 存储`publish-local`库`~\.ivy2\local\com.my.org\myplugin\0.1-SNAPSHOT`。

为了测试插件，我创建了一个简单的“Hello-World”项目并添加了以下 `project/build.sbt`文件：

```
addSbtPlugin("com.my.org" %% "myplugin" % "0.1-SNAPSHOT") 
```

尝试使用该插件加载项目时`sbt`出现`Unresolved Dependency`错误。我注意到`sbt`在`~\.ivy2\local\com.my.org\myplugin\scala_2.9.2\sbt_0.12\0.1-SNAPSHOT`.

我的问题是如何更正配置以包含 Scala 和 SBT 版本？或者，或者，我如何解决插件分辨率以查看正确的位置？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-10T11:41:38.567

我想说你所缺少的只是`sbtPlugin := true`插件中的设置`build.sbt`。这应该使您的插件正确发布。

# javascript - iframe 未调整到内容高度

> ID：14791542
> 
> 赞同：0
> 
> 时间：2013-02-09T21:00:08.453
> 
> 标签：javascript, html, iframe

我一直试图让它工作一段时间，但无济于事。我尝试了各种脚本，但我显然做错了什么:(

我在页面左侧有一个菜单，其中包含（同一服务器）href 链接，其目标是页面右侧的 iframe。

它将页面发送到 iframe 很好，但 iframe 高度不会改变。

有人可以帮助我吗:(

这是我的代码：

html

```
<link rel="stylesheet" type="text/css" href="jquery.pageslide.css">
<script type="text/javascript" src="jquery/jquery-1.8.3.min.js"></script>
<script type="text/javascript">

function sizeIframeToContent(id) {
    // resize iframe to be the height of the content
    try {
        var frame = document.getElementById(viewcontent);
        innerDoc = (frame.contentDocument) ?
                   frame.contentDocument : frame.contentWindow.document;
        var objToResize = (frame.style) ? frame.style : frame;
        objToResize.height = innerDoc.body.scrollHeight + 10 + 'px';
        //objToResize.width = innerDoc.body.scrollWidth + 10 + 'px';
    }
    catch (err) {
        console.log(err.message);
    }
} 
```

....菜单链接

```
<div class="menuOut" onMouseOver="this.className='menuIn'" onMouseOut="this.className='menuOut'">
          <a href="forum_frame.php?forum=guest" target="viewcontent">- Forum Adverts </a></div> 
```

.... iframe html

```
<div id=maincontain>
<iframe id="viewcontent" frameborder="0">
</iframe>
</div> 
```

CSS

```
#maincontain {
    width: 85%;
    float: none;
    margin-left: 12%;
}
#viewcontent {
    width: 100%;
    padding-top: 15px;
    float: none;
} 
```

除非我手动指定更大的高度，否则 iframe 只会保持大约 300px 的高度。

正在加载的页面都具有 800 像素以上的高度。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T15:41:45.470

你试过 jQuery 吗？

你可以使用：

```
$("#viewcontent").height($("#viewcontent").contents().find("html").height()); 
```

只需在您希望 iframe 调整大小的任何事件上调用它即可。我已经为我自己的一个项目进行了 keyup 工作。这是[jsFiddle](http://jsfiddle.net/maddest_march_hare/ume3v/3/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:25:12.957

iframe 的高度不受内容的影响。这就是 iframe 的工作原理。如果您需要缩小或扩大它们，则需要手动进行。在这里阅读更多：

*   [http://www.mattcutts.com/blog/iframe-height-scrollbar-example/](http://www.mattcutts.com/blog/iframe-height-scrollbar-example/)
*   [http://www.456bereastreet.com/archive/201112/how_to_adjust_an_iframe_elements_height_to_fit_its_content/](http://www.456bereastreet.com/archive/201112/how_to_adjust_an_iframe_elements_height_to_fit_its_content/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T11:39:58.920

**请尝试以下脚本：**

```
<script language="JavaScript">
<!--
function autoResize(id){
    var newheight;
    var newwidth;

    if(document.getElementById){
        newheight=document.getElementById(id).contentWindow.document .body.scrollHeight;
        newwidth=document.getElementById(id).contentWindow.document .body.scrollWidth;
    }

    document.getElementById(id).height= (newheight) + "px";
    document.getElementById(id).width= (newwidth) + "px";
}
//-->
</script>

<iframe src="test.html" width="100%" height="200px" id="my_frame" marginheight="0" frameborder="0" onLoad="autoResize('my_frame');"></iframe> 
```

你应该在你的域中有源文件。这已经讨论过了 点击[这里](https://stackoverflow.com/questions/819416/adjust-width-height-of-iframe-to-fit-with-content-in-it)

跨域 iframe 调整大小请点击[这里](http://css-tricks.com/cross-domain-iframe-resizing/)

# php - 什么最适合性能批量插入或切片多个批量插入？

> ID：14791544
> 
> 赞同：1
> 
> 时间：2013-02-09T21:00:17.920
> 
> 标签：php, mysql, codeigniter, codeigniter-2

我注意到，当我使用 db->insert_batch 函数 Codeigniter 每 100 个插入切片行时。

这背后的原因是什么？一次做所有事情不是更有收益吗？

同样从 Codeigniter 的角度来看，据我所知，不可能在一个连接中对多个表进行多次插入。

这三种情况之间的性能比较是什么？

1- 在一个连接中执行 2220 插入。20 到一张桌子，200 到另一张桌子，2200 到最后一张桌子。

2- 相同的插入，因为 CodeIgniter ActiveRecord 库建议 (?) 10 到一个表一次查询，200 到第二个表在 2 个不同的查询，2000 次插入到 20 个查询中的第三个表。

每行 3-2220 个不同的查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:07:16.840

据我所知，你一次只能插入一张桌子，所以#1 和#3 对我来说没有意义（而且你的数字不加起来）

批量插入的原因是因为它们会导致高度限制的写锁。根据数据库引擎，插入可能会导致表级写锁，建立请求队列并最终在池达到其限制时拒绝请求

批处理允许完成插入并偶尔释放锁，从而允许更快的查询在再次锁定之前获得时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:16:50.643

如果您可以将所有内容包装在事务中，它将提高性能。还要查看延迟插入。

# expressionengine - ExpressionEngine 控制面板中缺少“通道”

> ID：14791545
> 
> 赞同：0
> 
> 时间：2013-02-09T21:00:27.583
> 
> 标签：expressionengine

我对表达式引擎相当陌生，我注意到我的管理页面缺少此页面上的“频道”“模板”和“模板组”

[http://ellislab.com/expressionengine/user-guide/how_to/building_a_simple_news_site.html#before-you-begin](http://ellislab.com/expressionengine/user-guide/how_to/building_a_simple_news_site.html#before-you-begin)

有人可以建议吗？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T21:10:44.727

在您创建频道、模板组或模板之前，这三者都不会在控制面板中包含任何内容 - 默认情况下，表达式引擎会作为空白板安装。你创造了这三个中的任何一个吗？

# c++ - ID2D1Bitmap1::Map，什么时候可以用？

> ID：14791546
> 
> 赞同：0
> 
> 时间：2013-02-09T21:00:31.730
> 
> 标签：c++, windows-8, direct2d

所以我最近通过并转换了我编写的一个简单的测试应用程序以使用新版本的 Direct2D，这意味着我基本上复制了[Direct2D Quickstart for Windows 8](http://msdn.microsoft.com/en-us/library/windows/desktop/hh780340%28v=vs.85%29.aspx)的相关部分。那行得通，因为我的应用程序表现得像以前一样（只是绘制了一堆像素。）

以前，为了更新位图，我正在执行以下操作：

```
for(int i = 0; i < 1000; ++i )
{
    int x = rand()%600;
    int y = rand()%600;
    int index = 4 * ( x + ( y * 600 ) );
    imageData[index] = rand()%256;
    imageData[index+2] = 0;
}

D2D1_RECT_U rect2 = RectU(0,0,600,600);
pBitmap->CopyFromMemory(&rect2, imageData, 600*4); 
```

其中 imageData 只是：

```
imageData = new byte[600*600*4]; 
```

这仍然有效，但我认为既然我在闪亮的新 ID2D1Bitmap1 接口上有这个漂亮的 Map 方法，我可以摆脱那个 CPU 端数组并执行以下操作：

```
D2D1_MAPPED_RECT* mapped = NULL;
ThrowIfFailed( pBitmap->Map( D2D1_MAP_OPTIONS_WRITE, mapped ) );

for(int i = 0; i < 1000; ++i)
{
    int x = rand()%600;
    int y = rand()%600;
    int index = 4 * ( x + ( y * 600 ) );
    mapped->bits[index] = rand()%256;
    mapped->bits[index+2] = 0;
}

ThrowIfFailed(pBitmap->Unmap()); 
```

这在每次使用 E_INVALIDARG 调用 Map 时都失败了，使用D2D1_BITMAP_PROPERTIES1中传递给 CreateBitmap 的[D2D1_BITMAP_OPTIONS和调用 Map 中的](http://msdn.microsoft.com/en-us/library/windows/desktop/hh447006%28v=vs.85%29.aspx)[D2D1_MAP_OPTIONS](http://msdn.microsoft.com/en-us/library/windows/desktop/hh446984%28v=vs.85%29.aspx)的各种组合。

[查看D2D1_MAP_OPTIONS 枚举](http://msdn.microsoft.com/en-us/library/windows/desktop/hh447006%28v=vs.85%29.aspx)的描述，似乎这 3 个选项（READ、WRITE、DISCARD）实际上都不能用于我使用 Direct2D 上下文创建的位图......

在 Direct2D 中，如何获得可以映射、写入、取消映射和绘制的位图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T12:39:35.513

您的问题是您的映射指针不应该是空指针。我建议根据以下内容更改您的代码：

D2D1_MAPPED_RECT 映射；

ThrowIfFailed(pBitmap->Map(D2D1_MAP_OPTIONS_WRITE, &mapped));

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-14T09:50:33.133

最近我研究了这个并面临同样的问题。据我了解，D2D 位图无法锁定为 CPU 写入。不仅如此，您无法创建位图以用于使用 D2D 写入和使用 CPU 读取。

我想用 CPU 和 D2D api 读写一些字节数组。但不幸的是，我必须使用 2 个不同的位图`bitmapOptions`。首先适用于 D2D api，可以作为上下文的渲染目标

```
props.bitmapOptions = D2D1_BITMAP_OPTIONS_CANNOT_DRAW | D2D1_BITMAP_OPTIONS_TARGET; 
```

秒可以用 CPU 读取

```
props.bitmapOptions = D2D1_BITMAP_OPTIONS_CANNOT_DRAW | D2D1_BITMAP_OPTIONS_CPU_READ; 
```

使用场景是“将原语渲染到第一个，用于`ID2D1Bitmap1::CopyFromBitmap`从第二个获取数据（使用 map/unmap）”

# typescript - 如何在打字稿中实现数组签名方法

> ID：14791550
> 
> 赞同：1
> 
> 时间：2013-02-09T21:00:50.683
> 
> 标签：typescript

**试图让它编译：**

```
interface ListInterface {
    getObject(index: number): Object;
    [index: number]: Object;
}

class List123 implements ListInterface {
    private list: Object[] = [1,2,3];
    getObject(index: number) { return this.list[index] }
    [index: number] { return this.getObject(index) }
} 
```

**但 tsc 正在发出：**

> [ ] 方法声明的类定义中出现意外的“[”。

[Typescript Playground Link](http://www.typescriptlang.org/Playground/#src=interface%20ListInterface%20%7B%0A%09getObject%28index%3a%20number%29%3a%20Object;%0A%09%5Bindex%3a%20number%5D%3a%20Object;%0A%7D%0A%0Aclass%20List123%20implements%20ListInterface%20%7B%0A%09private%20list%3a%20Object%5B%5D%20=%20%5B1,2,3%5D;%0A%09getObject%28index%3a%20number%29%20%7B%20return%20this.list%5Bindex%5D%20%7D%0A//?%09%5Bindex%3a%20number%5D%20%7B%20return%20this.getObject%28index%29%20%7D%0A%7D%0A%0Avar%20list%20=%20new%20List123%28%29;%0A%0Aalert%28list.getObject%281%29.toString%28%29%29)（取消注释 //? 我遇到的问题）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T13:14:25.297

一些类型注释用于定义 JavaScript 行为并且无法实现 - 索引器注释就是这样一个示例。

请参考[codeplex 的相关讨论](http://typescript.codeplex.com/discussions/398379)。

对于问题中提供的代码示例，有一个部分解决方案，因为 JavaScript 对象自然支持索引器表示法。因此可以写：

```
interface ListInterface {
    getObject(index: number): Object;
}

class List123 implements ListInterface {

    getObject(index: number) { 
        return <Object> this[index] 
    }
}

var list  = new List123();
list[1] = "my object";

console.log(list[1]); // "my object"
console.log(list.getObject(1)); // "my object"; 
```

# java - Java - 通过添加新类而不修改任何其他内容来添加功能

> ID：14791553
> 
> 赞同：2
> 
> 时间：2013-02-09T21:01:10.703
> 
> 标签：java, reflection

怎么可能拥有具有功能 F 的类`A`, `B`, ,`C`然后在不修改或以任何方式将类添加`D`到`bin/`F 并获得与 F 不同的功能？`A``B``C`

我已经在[ModLoader](http://www.minecraftforum.net/topic/75440-v147-risugamis-mods-updated/ "模组加载器") for Minecraft 中看到了这一点。使用 ModLoader，您可以将类从 ModLoader 复制到 Minecraft。然后，您可以简单地将一个以“mod_”开头的新类放入 Minecraft jar 中，它会为游戏添加新内容。绝不会有任何类直接引用您的“mod_Foobar”类。

一个小的工作示例，以及任何进一步阅读的链接是可取的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:45:31.947

```
public class Reflection {

    public void sayHello(String theClass){
        //Since Mod classes are in package 'mod', we precede their name accordingly.
        Class aClass = Class.forName("mod." + theClass);
        aClass.getMethod("sayHi").invoke(aClass.newInstance());
    }

    public static void main(String[] args) {
        //Get a list of the compiled classes in the 'mod' folder
        String path = "./bin/mod";
        String fileName;
        File folder = new File(path);
        List<File> fileList = Arrays.asList(folder.listFiles());
        //Iterate through the list of classes to invoke their methods
        Iterator<File> it = fileList.iterator();        
        while(it.hasNext()){
            fileName = it.next().getName();     
            //When invoking the sayHello method, we remove the file extension
            new Reflection().sayHello(fileName.replace(".class", ""));
        }

    }
} 
```

ModA 类：

```
public class ModA {
    public void sayHi(){
        System.out.println("Hi! I'm ModA.");        
    }   
} 
```

ModB 类：

```
public class ModB {
    public void sayHi(){
        System.out.println("Hi! I'm ModB.");        
    }   
} 
```

请注意：

*   为了阐明示例，我删除了一些必要的异常处理。
*   Mod 类位于一个名为“mod”的包中。编译后，它们存在于 bin/mod 中。可能有一种更清洁的方式来扫描它们。
*   Mod 类被编译、打包到一个 jar 中并包含在构建路径中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:22:11.453

类路径用于加载类并且它是有序的，因此如果您将类放在原始类之前，则将加载您的类而不是原始类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T21:23:56.117

我想这都是关于应用基本的 OO 原则。

简单的继承允许您实现[多态性](http://en.wikipedia.org/wiki/Polymorphism_%28computer_science%29)。在设计良好的系统中，这是将新行为引入系统的良好起点。

[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)是工具箱中的另一种软件设计模式，可以在运行时选择算法的行为。

[工厂模式](http://www.oodesign.com/factory-pattern.html)（结合反射和上面提到的模式）可以创建一个系统，您可以在其中将类“拖放”到现有系统中，以便在不改变其核心的情况下添加新功能。

您还可以在启动时进行[类路径扫描](http://bill.burkecentral.com/2008/01/14/scanning-java-annotations-at-runtime/)以查找有趣的（带注释的）类以修改运行时行为。

我确信 MindCraft 是一个设计良好的系统，它应用了比这里描述的更多的模式。

最终，这一切都归结为良好的设计并在正确的位置应用正确的模式。

# java - 使用 Spring Security 成功登录后如何将用户转发回所需的受保护页面

> ID：14791555
> 
> 赞同：1
> 
> 时间：2013-02-09T21:01:19.980
> 
> 标签：java, jsp, spring-security

我正在使用 Spring Security 来处理我的 Web 应用程序的所有身份验证。情况如下，假设我有三个 JSP 页面：

1）登录页面
2）默认主页（需要认证）
3）用户账户页面（需要认证）

标准流程工作得很好：

1) 用户从登录页面成功登录
2) 用户被带到默认主页

**这是我无法弄清楚的用例**

1) 用户尝试访问他们的帐户页面（但它受密码保护） - 有效
2) 用户被重定向以输入他们的凭据 - 有效
3) 用户成功提供凭据 - 有效
4) 用户被重定向到他们的帐户页面 - 不工作（它将它们重定向到默认主页）

我正在使用 custom `AuthenticationSuccessHandler`，但问题是，每当我查看请求以查看它们来自哪里时，它总是来自`/j_spring_security_check`.

有没有一些简单的方法来隔离它们来自哪个页面？

这是我的 applicationContext.xml 中与我的 Spring Security 设置相关的内容：

```
<bean id="successfulLoginService" class="com.service.SuccessfulLoginService">
    <property name="defaultTargetUrl" value="/listings/add_listing.htm"/>
  </bean>

  <security:http pattern="/**.html" security="none" />
  <security:http pattern="/login/*.htm" security="none" />
  <security:http pattern="/listings/listing.htm" security="none" />
  <security:http pattern="/listings/viewListing.htm" security="none" />
  <security:http pattern="/search/keyword/*.htm" security="none" />

  <security:http auto-config="true">
    <security:intercept-url pattern="/**.htm" access="ROLE_USER" />
    <security:intercept-url pattern="/**/**.htm" access="ROLE_USER" />
    <security:form-login login-page="/login/login.htm" authentication-failure-handler-ref="failedLoginService" authentication-success-handler-ref="successfulLoginService"/>
  </security:http>

  <security:authentication-manager>
    <security:authentication-provider
      user-service-ref="userDetailsService" />
  </security:authentication-manager> 
```

这是我的成功登录服务.java：

```
@Service("successfulLoginService")
public class SuccessfulLoginService extends SimpleUrlAuthenticationSuccessHandler
{
  @Autowired
  UserDao userDao;

  @Override
  public void onAuthenticationSuccess(HttpServletRequest request,
      HttpServletResponse response, Authentication authentication)
      throws IOException, ServletException
  {
    Users user = null;
    String username = ((SpringSecurityUser) authentication.getPrincipal()).getUsername();
    try
    {
      user = userDao.getUserByEmail(username);
    } catch (Exception e)
    {
      e.printStackTrace();
      throw new ServletException("Failed to login", e);
    }
    request.getSession().setAttribute("user", user);

    response.sendRedirect("/MyApplication" + determineTargetUrl(request, response));
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-11T11:55:58.353

您可以从 获取保存的请求`org.springframework.security.web.savedrequest.RequestCache`。

在您的自定义成功处理程序内部：

```
RequestCache requestCache = new HttpSessionRequestCache();
SavedRequest savedRequest = requestCache.getRequest(request, response);
String targetUrl = savedRequest.getRedirectUrl(); 
```

查看默认值`SavedRequestAwareAuthenticationSuccessHandler`以获取更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:11:09.980

您在寻找[default-target-url](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#nsa-form-login-default-target-url)吗？您可以使用它在成功登录后将用户重定向到某个位置。

# ios - LibStatusBar 图标在第 3 方应用程序启动时消失

> ID：14791556
> 
> 赞同：152
> 
> 时间：2013-02-09T21:01:21.153
> 
> 标签：ios, ios7, jailbreak, cydia, libstatusbar

我为 Cydia 写了一个调整，它在状态栏上添加了一个图标。它在主屏幕上工作正常，当 SpringBoard 启动时，如果一个应用程序已经启动，那么它工作正常，但是，如果一个应用程序（如 Facebook 或 Twitter）被关闭（完全）并且图标正在显示，当启动应用程序，它会导致图标消失。使用以下代码使用 libStatusBar 显示图标：

```
if(icon) // if icon needs to be removed
{
    [icon release];
    icon = nil;
}

...

// add the icon to the status bar
icon = [[%c(LSStatusBarItem) alloc] initWithIdentifier:[NSString stringWithFormat:@"muteIconLablabla"] alignment:StatusBarAlignmentRight];
icon.imageName = [NSString stringWithFormat:@"Mute"]; 
```

我也尝试使用`libStatusBar`自述文件中建议的方法

```
[[UIApplication sharedApplication] addStatusBarImageNamed:@"ON_Mute"]; // and removeStatusBarImageNamed:... 
```

我尝试在那里覆盖`-(id)init`和更新图标，但结果相同。

上面显示的代码是从`static void`函数调用的。这个函数被多次调用，例如从`-(void)applicationDidFinishLaunching:(id)application` 下面`%hook SpringBoard`和`-(void)ringerChanged:(int)changed`

都在里面`Tweak.xm`。问题也发生在`iOS7`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-06-21T14:22:07.093

自从我使用 libstatusbar 已经有一段时间了，但是如果您绝对确定`LSStatusBarItem`它没有被发布，那么它可能被 Springboard 或其他应用程序隐藏了。考虑`icon.visible = YES`明确设置。您可能还需要考虑通过调用显式设置`timeHidden`为.`LSStatusBarServer``NO``[item setHidesTime:NO]`

此外，如果您没有对图标进行任何更改，请设置`icon.manualUpdate = NO`.

参考：

*   [iPhoneDevWiki 上的 Libstatusbar](http://iphonedevwiki.net/index.php/Libstatusbar)
*   [LSStatusBarItem.mm 源](https://github.com/phoenix3200/libstatusbar/blob/master/LSStatusBarItem.mm)

# .net - 为 Wix 安装程序构建项目

> ID：14791559
> 
> 赞同：4
> 
> 时间：2013-02-09T21:01:34.070
> 
> 标签：.net, wix

我正在尝试为我们的应用程序创建一个 Wix 安装程序。Wix Project 收获不起作用，因为它只将主 exe 文件复制到安装目录，所有 dll 等都不会被复制。

所以我想有一个预构建事件来构建应用程序并使用来自 Wix 的输出。

问题是输出将包含 .pdb、vchost.exe 等文件。我可以配置构建以使其仅输出所需的文件吗？

**编辑：最终解决方案可以在这里找到** [https://github.com/AndersMalmgren/FreePIE/blob/master/BuildTools](https://github.com/AndersMalmgren/FreePIE/blob/master/BuildTools)

首先查看 [https://github.com/AndersMalmgren/FreePIE/blob/master/BuildTools/build_installer.bat](https://github.com/AndersMalmgren/FreePIE/blob/master/BuildTools/build_installer.bat)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-09T22:18:07.807

当我为我的项目创建任何类型的安装程序/zip 文件/任何东西时，我从不在 Visual Studio 的“标准”构建中，即在`.csproj`文件中这样做。
*（我知道这就是您尝试放置预构建事件的地方 - 对吗？）*
原因是我不想在我编程时对我所做的每个构建都重新构建安装程序/zip。

**我一直在做的事情：**
我创建了一个[MSBuild 项目文件](http://msdn.microsoft.com/en-us/library/dd576348.aspx)，我可以从资源管理器手动执行*（通常通过批处理文件）*，它编译 Visual Studio 解决方案，然后创建 zip 文件、安装程序、NuGet 包或我需要的任何东西。
因此，创建设置完全脱离了 Visual Studio 解决方案，但我可以从源代码管理中提取最新更改，然后构建所有内容并单击一下即可创建设置。
*（[Joel Test](http://www.joelonsoftware.com/articles/fog0000000043.html)，第二个问题：“你能一步完成构建吗？”）*

当我不需要 Visual Studio 放入输出文件夹的所有内容时，我只需先将需要的文件复制到不同的文件夹。

**这是我的一个项目中的一个示例：**

1.  [MSBuild 文件](https://github.com/christianspecht/bitbucket-backup/blob/8f5d8de0d145c075b03495f5b76f04118e870cf7/build.proj)
    最后一段（“将文件复制到发布文件夹”）将文件夹的内容`\bin\Release`（但不包括`*.pdb`和`*.xml`文件）和一些文件从根文件夹复制到单独的“发布”目录：

    ```
     <!-- copy files to release folder -->
     <Target Name="CopyRelease">
             <MakeDir Directories="$(ReleaseDir)"/>
             <ItemGroup>
                     <ReleaseFiles
                             Include="$(OutDir)\**\*.*;
                                     README.md;
                                     License.rtf"
                             Exclude="$(OutDir)\*.pdb;
                                     $(OutDir)\*.xml">
                     </ReleaseFiles>
             </ItemGroup>
             <Copy SourceFiles="@(ReleaseFiles)" DestinationFiles="@(ReleaseFiles -> '$(ReleaseDir)\%(RecursiveDir)%(Filename)%(Extension)')"/>

     </Target> 
    ```

2.  [我用来执行 MSBuild 文件](https://github.com/christianspecht/bitbucket-backup/blob/8f5d8de0d145c075b03495f5b76f04118e870cf7/build.bat)
    的批处理文件 批处理文件中有更多代码*（用于处理版本号等内容）*，但我执行 MSBuild 文件的重要部分是：

    ```
     rem path to msbuild.exe
     path=%path%;%windir%\Microsoft.net\Framework\v4.0.30319

     rem go to current folder
     cd %~dp0

     msbuild build.proj 
    ```

* * *

我实际上是在使用 WiX 为这个项目构建安装程序，但我没有使用您正在使用的“收获”功能（我以前不知道）。[我只是在WiX 项目文件](https://github.com/christianspecht/bitbucket-backup/blob/8f5d8de0d145c075b03495f5b76f04118e870cf7/wix/bitbucket-backup.wxs)
中为安装程序指定每个文件，然后我使用[另一个批处理文件](https://github.com/christianspecht/bitbucket-backup/blob/8f5d8de0d145c075b03495f5b76f04118e870cf7/build-setup.bat)来构建项目*（通过调用上面提到的第一个批处理文件）*，然后是 WiX 设置。

 *即使我对实际 WiX 工具的使用与您的不同，您仍然可以使用类似于上面解释的方法来为 WiX 的收获功能创建“源文件夹”：
调用一个批处理文件来准确复制您需要的文件另一个文件夹，并将**其**用作创建安装程序的源。
如果您不想创建 MSBuild 文件，您甚至可以使用[Robocopy](http://en.wikipedia.org/wiki/Robocopy)之类的东西（它能够镜像完整的文件夹，但排除某些文件扩展名）。

* * *

**编辑：**

1.  尝试构建您的完整解决方案，而不仅仅是一个项目。
    将包含以下内容的批处理文件放在文件所在的`.sln`文件夹中：

    ```
     set PATH=%PATH%;%WINDIR%\Microsoft.Net\Framework64\v4.0.30319

     rem go to current folder
     cd %~dp0

     msbuild YourSolution.sln /p:Configuration=Release 
    ```

2.  第二个错误说明了关于 a `PreBuildEvent target`
    --> 你是否已经在你的预构建事件中放入了一些东西`.csproj`？也许那行不通。

* * *

**编辑2：**

我正在做类似的事情：
我只有一个[批处理文件](https://github.com/christianspecht/bitbucket-backup/blob/8f5d8de0d145c075b03495f5b76f04118e870cf7/wix/version_number.bat)，它将版本号（在我的情况下是硬编码的）放入环境变量中，然后在进行实际构建之前从我的[主构建批处理中调用该批处理文件。](https://github.com/christianspecht/bitbucket-backup/blob/8f5d8de0d145c075b03495f5b76f04118e870cf7/build.bat)
在`.csproj`我的. [_](https://github.com/christianspecht/bitbucket-backup/blob/8f5d8de0d145c075b03495f5b76f04118e870cf7/src/BitbucketBackup/BitbucketBackup.csproj#L148) *（当我从 Visual Studio 构建时，我不关心版本号 - 我使用批处理文件创建所有发布版本，所以我只需要那里的版本号）*`0.0`

 ** * *

**编辑 3：**

> 最后一步，将整个输出放入 Wix，链接每个文件，这在 mu 项目中不实用。它的几个子文件夹和数千个文件。关于如何在wix中链接整个输出文件夹的任何好主意？

抱歉，我以前从未尝试过。使用 WiX 的正确方法是[从一开始就逐步构建设置](http://wix.tramontana.co.hu/tutorial/getting-started/the-files-inside)。

引用链接（我强调）：

> 当然，将所有这些成百上千个组件输入到 WiX 源文件中是另一个挑战。该工具集有一个 [小实用程序](http://wix.tramontana.co.hu/tutorial/com-expression-syntax-miscellanea/components-of-a-different-color)可以帮助解决这个问题（稍后会详细介绍），但真正的解决方案是概念上的改变。**不要将安装程序视为一个单独的应用程序，当主应用程序已经完成时，它必须匆忙编写。由于 WiX 源文件和工具集本身可以轻松集成到您的开发环境中，因此您应该始终保持它们同步。一旦您开始处理新模块或向程序添加新的注册表引用，请同时修改相应的 WiX 源文件。**这样，设置将与应用程序本身一起完成，并且无需提取以后安装所需的所有文件和其他信息。由于 WiX 项目可以模块化（稍后将详细介绍），因此如果您有一个大型团队而不是单个开发人员来开发应用程序，这种方法也同样适用。

[引用文本中](http://wix.tramontana.co.hu/tutorial/com-expression-syntax-miscellanea/components-of-a-different-color)的链接指向描述该`Heat`工具的页面，这似乎是您之前提到的“收获”工具，并且已经尝试过但没有成功。**

# ruby-on-rails - has_one 关系取决于用户类型

> ID：14791561
> 
> 赞同：2
> 
> 时间：2013-02-09T21:01:39.200
> 
> 标签：ruby-on-rails, has-one

我正在尝试为我的用户创建不同的配置文件类型。

我有一个用户模型。

`User`类型有一个`Profile`相关的，所以它`has_one :profile`但是，`Page`类型有一个`Page`相关的，所以它`has_one :page`

但是，我`User`对两者都使用同一张表，并且我正在设置帐户类型。

我想知道，如何根据我的用户帐户类型确定这种关系

## 编辑

用户模型 has_one :profile Profile belongs_to :user Page belongs_to :user 账户类型要么是“User”（进入 Profile 模型），要么是“Page”（进入 Page 模型）。

```
class User < ActiveRecord::Base
  has_one :profile, :class_name => 'Here it should be either PROFILE or PAGE'
end

class Profile < ActiveRecord::Base
  belongs_to :user
end

class Page < ActiveRecord::Base
  belongs_to :user
end 
```

我一直在通过 API 阅读，发现 :class_name，现在我的挑战是动态确定它。

## 编辑

稍微修改了 Page 模型和 User 模型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:51:43.323

也许是`proc`作品？

```
class User < ActiveRecord::Base
  TYPES = { 'user' => 'Profile', 'page' => 'Page' }
  has_one :profile, :class_name => proc { TYPES[self.type].constantize }
end 
```

如果这可行，请考虑添加一个表来存储用户类型：

```
class User < ActiveRecord::Base
  TYPES = { 'user' => 'Profile', 'page' => 'Page' }
  has_one :profile, :class_name => proc { TYPES[self.type].constantize }
  belongs_to :user_type
end

class UserType < ActiveRecord::Base
  has_many :users
end 
```

# actionscript-3 - System.setClipBoard 在浏览器上不起作用

> ID：14791567
> 
> 赞同：0
> 
> 时间：2013-02-09T21:01:58.573
> 
> 标签：actionscript-3

我尝试使用 As3 将文本复制到剪贴板，当我在 Flash Player 上运行它时它可以工作，但如果我将它包含在页面中并上传它，它就不起作用。

编码：

```
import flash.external.ExternalInterface;

ExternalInterface.addCallback("sendTextFromJS", receiveTextFromJS);

function receiveTextFromJS(t:String):void {
    System.setClipboard(t);
} 
```

Flash 从 JavaScript 接收文本，但不会将其插入剪贴板。有人知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T11:55:45.877

我猜，安全。FP 10 之后的安全更改。

阅读这篇文章： http: [//www.adobe.com/devnet/flashplayer/articles/fplayer10_security_changes.html#head31](http://www.adobe.com/devnet/flashplayer/articles/fplayer10_security_changes.html#head31)

我建议。使用[剪贴板类实现](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/desktop/Clipboard.html)

# xslt - 使用 xslt 将 xml 转换为 xml：递归匹配和创建像树一样的层次结构

> ID：14791580
> 
> 赞同：1
> 
> 时间：2013-02-09T21:03:43.823
> 
> 标签：xslt, xslt-1.0

我对 xslt 完全陌生。请帮我写样式表。我输入了这样的xml

输入 XML：

```
 <elements>
     <e1>
       <pid>1</pid>
       <cid>2</cid>
     </e1>

     <e1>
      <pid>1</pid>
      <cid>3</cid>
     </e1>

     <e1>
      <pid>2</pid>
      <cid>4</cid>
    </e1>
    </elements> 
```

所需的 XML：

```
 <tree>
      <unit id="1">
        <unit id="2">
           <unit id="4">
             <data></data>
           </unit>
           <data></data>
        </unit>

        <unit id="3">
           <data></data>
        </unit>

        <data></data>

      </unit>
    </tree> 
```

我觉得这应该很容易，但我很难找到有关如何执行此操作的信息。我的 XSLT 知识不是很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:28:38.597

我不是 100% 确定您希望 XSLT 如何从该输入中确定顶部 id 为 1（是因为它是唯一`pid`没有对应`cid`值的值，还是始终为 1？）。尽管如此，这应该可以完成工作：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>
  <xsl:key name="kItemsByC" match="e1" use="cid" />
  <xsl:key name="kItemsByP" match="e1" use="pid" />

  <xsl:template match="/">
    <tree>
      <xsl:call-template name="Unit">
        <!-- This will be the value of the <pid> that has no <cid> references to
             it (assuming there is only one top-level <pid>) -->
        <xsl:with-param name="id" 
                        select="string(/elements/e1/pid[not(key('kItemsByC', .))])" />
      </xsl:call-template>
    </tree>
  </xsl:template>

  <xsl:template match="e1" name="Unit">
    <xsl:param name="id" select="cid" />

    <unit id="{$id}">
      <xsl:apply-templates select="key('kItemsByP', $id)" />
      <data />
    </unit>
  </xsl:template>
</xsl:stylesheet> 
```

当这在您的示例输入上运行时，这会产生：

```
<tree>
  <unit id="1">
    <unit id="2">
      <unit id="4">
        <data />
      </unit>
      <data />
    </unit>
    <unit id="3">
      <data />
    </unit>
    <data />
  </unit>
</tree> 
```

**注意：**上述 XSLT 具有尝试动态定位顶级 ID 的逻辑。如果可以假设顶层单元的 ID 总是为 1，那么一键和上面 XSLT 的（有点）复杂的公式就可以省去：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>
  <xsl:key name="kItemsByP" match="e1" use="pid" />

  <xsl:template match="/">
    <tree>
      <xsl:call-template name="Unit">
        <xsl:with-param name="id" select="1" />
      </xsl:call-template>
    </tree>
  </xsl:template>

  <xsl:template match="e1" name="Unit">
    <xsl:param name="id" select="cid" />

    <unit id="{$id}">
      <xsl:apply-templates select="key('kItemsByP', $id)" />
      <data />
    </unit>
  </xsl:template>
</xsl:stylesheet> 
```

当在您的示例输入上运行时，这也会产生请求的输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T00:06:21.093

啊，看了JLRishe，我想我明白了：“pid”表示“父ID”，“cid”表示“子ID”，e1表示父子关系。出色的侦探工作，我永远不会为自己解决这个问题。

基本模型是，当您定位在父元素上时，您会将模板应用到其子元素。如果父/子关系由主键/外键表示，这与使用 XML 层次结构表示时一样适用。所以本质是：

```
<xsl:template match="e1">
  <unit id="{pid}">
    <xsl:apply-templates select="//e1[pid=current()/cid]"/>
    <data/>
  </unit>
</xsl:template> 
```

这本质上是 JLRishe 的解决方案，只是他添加了使用键的优化。

# mobile - 响应式移动设计视口

> ID：14791582
> 
> 赞同：1
> 
> 时间：2013-02-09T21:04:18.707
> 
> 标签：mobile, viewport

我正在尝试让移动网站正常运行。我正在使用`viewport`元标记使网站适合所有屏幕并具有可扩展性。我已将所有表格和所有图像（超过 200 像素宽）设为 100% 宽度，并将`viewport`标签设置为：

```
content="width=device-width, initial-scale=1, maximum-scale=2, user-scalable=yes" 
```

因为我希望它能够放大那些需要阅读文本的人，但最初打开它以适合屏幕（任何屏幕）的中心。

它*几乎*适合`iphones`纵向的机器人（在`iphone`4 和 5 以及 Galaxy iii 机器人上进行测试）。但是右边还是看不到一部分？它非常适合 ipad 或手机的横向模式。这让我发疯，而且一定是我在看的简单的东西。实时视图是：`password-reset.com/mobileusers/`

我`jquery colorbox`在页面上使用 - 这会干扰吗？我以为`colorbox`反应灵敏？

任何帮助或建议将不胜感激 - 我需要发布什么代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:16:10.203

你的桌子上有,`More Info`上面有。这就是搞砸一切的原因。`Purchase``Testimonials``width="340"`

# android - Android adb无线调试带USB配件

> ID：14791583
> 
> 赞同：4
> 
> 时间：2013-02-09T21:04:19.923
> 
> 标签：android, usb, adb, wireless, accessory

我有 adb 无线连接可用于在 Eclipse 中调试应用程序，但我遇到了一个使用 USB 电缆连接到附件的应用程序的问题。

该应用程序设计为在插入附件时启动，所以我建立了我的 ADB 连接，然后在 eclipse 上运行调试、代码加载等。现在，当我将附件插入应用程序时，应用程序启动并运行但失去了与 eclipse 的通信。所以我无法调试！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T21:28:18.243

`adb connect <device ip>:5555`在平板电脑插入 FT311 后，在命令提示符下再次运行（我假设它是您其他问题中的 FT311）。然后它将重新连接，然后`adb logcat`再次运行并完成。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-20T05:29:55.057

这只是部分解决方案。是的，您可以通过 WiFi 重新建立连接（效果很好，顺便说一句），但是当您断开或重新连接 USB 电缆时，您将再次失去与 ADB 的关联——即使它通过 WiFi 运行并且不应该依赖 USB一点也不。

所以请注意，这可行，但不会解决问题，例如，如果您尝试调试与 USB 连接/分离 Intent 相关的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-30T12:08:46.723

此处的 Android 官方开发者文档中的[USB 主机和附件概述提醒我们注意：](https://developer.android.com/guide/topics/connectivity/usb/)

### 调试注意事项

在调试使用 USB 附件或主机功能的应用程序时，您很可能会将 USB 硬件连接到您的 Android 设备。这将阻止您通过 USB 与 Android 供电设备建立 adb 连接。您仍然可以通过网络连接访问 adb。通过网络连接启用 adb：

*   通过 USB 将 Android 供电设备连接到您的计算机。
*   在您的 SDK中，在命令提示符处 `platform-tools/ directory`输入。`adb tcpip 5555`
*   Enter`adb connect <device-ip-address>:5555`您现在应该已连接到 Android 驱动的设备，并且可以发出通常的 adb 命令，例如`adb logcat`.
*   要将您的设备设置为在 USB 上收听，请输入`adb usb`。

> ***请记住：Android 官方文档会让您对 Android 有更好的基本了解，不是有时，而是几乎每次。***

# stata - Stata - 搜索一组字符的特定部分是否具有特定字符

> ID：14791589
> 
> 赞同：2
> 
> 时间：2013-02-09T21:04:52.783
> 
> 标签：stata

我如何在Stata中做到这一点？

说我的数据是：

```
Var1
Whoareyou
Whoisme
Idontknow
Isthatyou
Isyoume 
```

我怎么知道第 6 个和第 7 个字符是不是“我”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T01:24:54.780

以前的答案只是偶然的正确。

```
substr(var1, 6, 2) == "me" 
```

的最后一个参数`substr()`是提取的子字符串的最大长度，而不是选择的最后一个字符的位置。

在给出的示例中，`me`出现在字符串的末尾，因此`6, 7`在这些情况下 using 将起作用。

# actionscript-3 - 完全卸载外部 swf 和声音

> ID：14791590
> 
> 赞同：2
> 
> 时间：2013-02-09T21:05:13.083
> 
> 标签：actionscript-3, flash

我正在使用此代码为按钮加载和卸载外部 swf。当我单击按钮时，swf 加载，当我再次单击按钮时，swf 卸载，但声音仍然存在，只是 swf 屏幕消失了。

请更正此代码，我希望 swf 完全卸载。

```
printer.addEventListener(MouseEvent.CLICK, fl_ClickToLoadUnloadSWF);

var fl_Loader:Loader;

//This variable keeps track of whether you want to load or unload the SWF
var fl_ToLoad:Boolean = true;

function fl_ClickToLoadUnloadSWF(event:MouseEvent):void
{
    if(fl_ToLoad)
    {
        fl_Loader = new Loader();
        addChild(fl_Loader);
        fl_Loader.load(new URLRequest("quiz.swf"));

printer.x=100;
printer.y=100;
    }
    else

    {       fl_Loader.unloadAndStop();

        removeChild(fl_Loader);
        fl_Loader = null;

printer.x=155;
printer.y=334;
    }
    // Toggle whether you want to load or unload the SWF
    fl_ToLoad = !fl_ToLoad;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T17:04:48.343

如果您可以访问加载的 swf 中的代码，则可以添加`Event.UNLOAD`侦听器。在事件处理程序中，您可以进行一些清理：

*   停止所有声音，
*   停止视频，
*   删除事件监听器（特别是这些附加到`Stage`）

这样，卸载应该是顺利和容易的。

# html - 在每个标记属性上换行并在 Visual Studio HTML 代码编辑器中保持对齐

> ID：14791592
> 
> 赞同：23
> 
> 时间：2013-02-09T21:05:20.933
> 
> 标签：html, visual-studio, tags, formatting, line-breaks

## 如果您希望在 VS 的下一个版本中实现这一点，请在[此处](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/3657691-break-line-on-each-tag-attribute-and-keep-them-ali)投票。

* * *

假设以下横向冗长的`<button>` `HTML`声明：

```
<button type="submit" class="btn btn-primary" id="save" name="action:@ViewContext.RouteData.Values["action"]"><i class="icon-save icon-large"></i> @Localization.Save</button> 
```

如您所见，所有标记属性都是内联的，因此它们在代码编辑器中延伸了很长一段路……

您是否知道任何允许使用`Ctrl`+`K`然后`Ctrl`+对其进行格式化的 Visual Studio 选项或扩展，`F`如下所示：

```
<button type="submit"
        class="btn btn-primary"
        id="save"
        name="action:@ViewContext.RouteData.Values["action"]">
<i class="icon-save icon-large"></i>@Localization.Save
</button> 
```

我认为上述格式可以很容易地发现一个给定的属性，尽管它显然会使垂直滚动条更长一点。:)

我尝试摆弄 Visual Studio 选项，`TOOLS => Options... => Text Editor => HTML`但没有找到控制此行为的选项。

当然我可以手动对齐它，但是如果我错误地点击`Ctrl`+`K`然后`Ctrl`+`F`我会丢失所有自定义格式。

如果没有这样的东西可用，我认为这对于 Visual Studio 扩展来说是个好主意。作为一个加号，它甚至可以按字母顺序排列属性。:)

* * *

做更多的谷歌搜索，我发现`XAML`Visual Studio 中的编辑器具有我希望在 HTML 编辑器中具有的功能：

[将每个属性放在单独的行上](http://msdn.microsoft.com/en-us/library/bb763100.aspx)

![在此处输入图像描述](../Images/63c9a9bf6ad95ece7bf07147144983eb.png)

* * *

我在 Visual Studio 可扩展性论坛上问了同样的问题：

[http://social.msdn.microsoft.com/Forums/en-US/vsx/thread/0d97c205-9f29-4ba7-9d0b-253413077dce/](http://social.msdn.microsoft.com/Forums/en-US/vsx/thread/0d97c205-9f29-4ba7-9d0b-253413077dce/)

* * *

## 如果您希望在 VS 的下一个版本中实现这一点，请在[此处](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/3657691-break-line-on-each-tag-attribute-and-keep-them-ali)投票。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T01:56:02.487

好吧，我在 ASP.NET 论坛上发现了一个技巧：

[将每个属性定位在单独的行上](http://forums.asp.net/t/1376524.aspx/1)

它不像`XAML`我的问题中描述的功能，但它有效。

> 在选项/文本编辑器/HTML/格式中，您可以选中“超过特定长度时换行标签”并将长度设置为 1。这将导致格式化程序疯狂换行。

* * *

另一种选择是：

1.  转到`TOOLS => Options... => Text Editor => XML => Formatting`=> 将每个属性对齐在单独的行上。

2.  关闭 .cshtml 文件。在解决方案资源管理器中右键单击它并选择打开方式...，然后选择 XML（文本）编辑器。选择所有内容并执行`Ctrl`+`K`然后`Ctrl`+ `F`。

    ***这第二个选项很乏味！:(

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T02:38:29.270

如果你觉得勇敢，你可以编写一个编辑器扩展来为你做这件事。看看 Noah 前​​段时间为想法写的 align 扩展：[https ://github.com/NoahRic/AlignAssignments](https://github.com/NoahRic/AlignAssignments)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-28T16:53:28.940

这已在已发布的 Visual Studio 2013 Preview 中的新 HTML 编辑器中实现。这只是新编辑器的一个功能，它适用于 html 和 cshtml 文件，但不适用于 aspx/ascx 文件。如果在每个值后点击 [return]，属性将在第一个属性定义下叠加。格式化文档将不再撤消这些更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-03-14T22:20:40.510

将 html 复制到 xml 编辑器，让它为您格式化，然后将其保存回 html 文件

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-08-22T10:34:52.130

`<`您可以使用+查找/替换`/n<`不要忘记单击**使用正则表达式**设置

# java - 无法指定类型

> ID：14791593
> 
> 赞同：-1
> 
> 时间：2013-02-09T21:05:24.887
> 
> 标签：java, android, class, assign

我hame类GameManager（），int类变量：

```
public GameView view; 
```

它是类构造函数：

```
public GameManager (GameView view) 
   {
         this.view = view;
   } 
```

在我创建的 GameView 类中：

```
private GameManager gameLoopThread;
....
public GameView(Context context) {
    super(context);
    gameLoopThread = new GameView(this);// HERE IS ERROR ; 
```

我不知道为什么要将 gameLoopThread 更改为 GameView() 类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:12:48.973

`gameLoopThread = new GameManager(this);`

# c# - 从 LINQ 查询返回对象而不将其转换为列表

> ID：14791597
> 
> 赞同：1
> 
> 时间：2013-02-09T21:06:11.473
> 
> 标签：c#, asp.net, linq

当我将返回值设置为 a 时，我有一个 LINQ 查询有效`List`，但是我只想返回一个`IQueryable<Post>`. 我该怎么做？

```
public List<Post> GetPostByID(int id)
{
    var thePost = (from p in _context.Posts
                   where p.Id == id
                   select p).ToList();
    return thePost;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-09T21:07:59.127

```
 public IQueryable<Post> GetPostByID(int id)
 {
        return (from p in _context.Posts
                       where p.Id == id
                       select p);
 } 
```

自然由于延迟执行，这个查询将在调用者试图枚举结果的地方执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T21:07:47.957

```
var thePost = (from p in _context.Posts
                   where p.Id == id
                   select p);
    return thePost; 
```

# multithreading - BackgroundWorker 中的异步错误处理

> ID：14791603
> 
> 赞同：2
> 
> 时间：2013-02-09T21:06:47.303
> 
> 标签：multithreading, winforms, exception-handling, event-handling, backgroundworker

*`BackgroundWorker.Error`当`DoWork`必须调用可能引发异常的委托时，如何获得有意义的信息？*

我正在实现一个静态`MsgBox`类，它公开了向用户传达自定义消息的各种方式（使用自定义消息表单）。

公开的方法之一`ShowProgress`，实例化一个`ProgressMessageBoxForm`（派生自 custom `MessageBoxForm`），它在一些后台操作发生时显示一个进度条（让用户一直取消操作）。如果在模态表单上运行后台任务听起来很尴尬，请考虑这样的签名：

```
public static DialogResult ShowProgress(string title, string message, _
    Action<AsyncProgressArgs> progressAction) 
```

这个想法是封装一个后台工作程序，将其“工作”委托给任何提供的方法（/处理程序），同时允许该方法“对话”并报告进度和取消......以及理想情况下的错误状态。在这种情况下，表单是否是模态的，在可取消的模态表单上的进度条中显示正在运行的任务的进度的能力，除非取消选中复选框以保持可见和显示，否则该表单也会自动关闭完成后的成功状态是必需的功能。

这是有`AsyncProgressArgs`问题的课程：

```
public class AsyncProgressArgs
{
    private readonly Action<int, string> _update;
    private readonly BackgroundWorker _worker;
    private readonly DoWorkEventArgs _workEventArgs;

    public AsyncProgressArgs(Action<int, string> updateProgress, BackgroundWorker worker, DoWorkEventArgs e)
    {
        _update = updateProgress;
        _worker = worker;
        _workEventArgs = e;
    }

    /// <summary>
    /// Reports progress to underlying <see cref="BackgroundWorker"/>.
    /// Increments <see cref="ProgressBar"/> value by specified <see cref="int"/> amount and
    /// updates the progress <see cref="Label"/> with specified <see cref="string"/> caption.
    /// </summary>
    public Action<int, string> UpdateProgress { get { return _update; } }

    /// <summary>
    /// Verifies whether asynchronous action is pending cancellation,
    /// in which case asynchronous operation gets cancelled.
    /// </summary>
    public void CheckCancelled()
    {
        _workEventArgs.Cancel = _worker.CancellationPending;
    }
} 
```

的事件处理程序然后调用传递给自定义消息框的`BackgroundWorker`方法`DoWork`

```
protected virtual void worker_DoWork(object sender, DoWorkEventArgs e)
{
    // *** If RunWorkerCompletedEventArgs.Error caught exceptions,
    //     then this try/catch block wouldn't be needed:
    // try
    // {
           _startHandler(this, new AsyncProgressArgs(UpdateProgressAsync, _worker, e));
    // }
    // catch(Exception exception)
    // {
    //     if (MsgBox.Show(exception) == DialogResult.Retry)
    //     {
    //         BeginWork(_startHandler);
    //     }
    //     else
    //     {
    //         Hide();
    //     }
    // }
} 
```

给定这样的方法：

```
private void AsyncProgressAction(AsyncProgressArgs e)
{
    // do some work:
    Thread.Sleep(200);

    // increment progress bar value and change status message:
    e.UpdateProgress(10, "Operation #1 completed.");

    // see if cancellation was requested:
    e.CheckCancelled();

    // do some work:
    Thread.Sleep(500);

    // increment progress bar value and change status message:
    e.UpdateProgress(30, "Operation #2 completed.");

    // see if cancellation was requested:
    e.CheckCancelled();

    // ...

    // throw new Exception("This should be caught by the BackgroundWorker");
} 
```

调用代码可能如下所示：

```
MsgBox.ShowProgress("Async Test", "Please wait while operation completes.", _
    AsyncProgressAction); 
```

一切都按预期工作（进度条移动，进程可以取消），直到在 action 方法中抛出异常。通常`BackgroundWorker`会捕获它并将其存储在它的`Error`属性中，但这里不会发生这种情况。

因此，传递的操作方法中的代码需要处理它自己的异常，如果不处理，它就会保持未处理状态，程序会以可怕的方式死去。

`Error`问题是，是否有可能拥有这样的构造，并且在过程完成时仍然能够以某种方式拥有有意义的属性？我希望能够`Throw new Exception()`在操作方法中的任何位置，并在封装的工作人员中处理它。

旁注，我之所以使用，是`BackgroundWorker`因为`Task`在完成所有工作之前我无法移动进度条，并且我想避免`Thread`直接处理对象实例。

**编辑** 这是一个非问题，编译的应用程序不会爆炸。实际上，我对调试器中断委托方法中抛出的异常感到困惑。正如下面评论中所指出的，执行/调试*可以*在之后继续，并且任何打算运行的错误处理逻辑都会运行。我期待`BackgroundWorker`以某种方式`catch`异常和调试器继续运行，但事实证明异常被捕获并且调试器仍然中断。

我之前应该读过这个：[BackgroundWorker 中的未处理异常](https://stackoverflow.com/questions/1044460/unhandled-exceptions-in-backgroundworker)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T01:11:11.403

我之前应该读过这个：[BackgroundWorker 中的未处理异常](https://stackoverflow.com/questions/1044460/unhandled-exceptions-in-backgroundworker)。

这是一个非常非常长的问题，其中包含很多关于一个简单的非问题的上下文：VS 调试器停止并误导性地说“用户代码未处理异常”，就像未处理的异常一样......当它实际上意味着**“BackgroundWorker任务引发了异常，调试器正在让你知道它，否则你会认为 BackgroundWorker 正在吞噬它。”**

异常可以 F5'd / 忽略以恢复执行，异常*确实*`RunWorkerCompletedEventArgs.Error`按预期结束，并且部署的应用程序*不会*在用户面前爆炸。

发布此答案以从（溢出？）一堆未回答的问题中删除此问题...

# c# - 作为最佳实践，存储库是否应该作为单例实现？

> ID：14791606
> 
> 赞同：0
> 
> 时间：2013-02-09T21:07:15.900
> 
> 标签：c#, entity-framework, repository

我有一个小型 web 应用程序，用于`EntityFramework`通过存储库将内容存储到数据库中。

到目前为止，我所做的（基于我阅读的所有教程）是在我需要的地方创建一个存储库，如下所示：

在`CustomMembershipProvider`：

```
 public CustomMembershipProvider()
    {
        _userRepository = new UserRepository(new TenantApplicationContext());
    } 
```

在我的`RegisterController`：

```
 public TenantRepository TenantRepository { get; set; }
    public UserRepository UserRepository { get; set; }

    protected override void Initialize(RequestContext requestContext)
    {
        if (MembershipService == null) { MembershipService = new AccountMembershipService(); }
        if (TenantRepository == null) { TenantRepository = new TenantRepository(TenantApplicationContext); }
        if (UserRepository == null) { UserRepository = new UserRepository(TenantApplicationContext); }

        base.Initialize(requestContext);
    } 
```

关键是，我实例化了`UserRepository`两次。`User`当我在一个实例中创建一个并尝试在另一个实例中检索它**并且我没有在两者之间调用** 时，这成为一个问题`SaveChanges`。

问题出在这里：

```
// Snippet from the register controller class

if (!UserRepository.Exists(model.AccountableEmailAddress))
{
    // 1 - Create the user via a custom MembershipProvider
    // Note, the CustomMembershipProvider has it's own instance of UserRepository

    var createStatus = MembershipService.CreateUser(
        model.AccountableUser,
        model.Password,
        model.AccountableEmailAddress);

    if (createStatus == MembershipCreateStatus.Success)
    {
        // Left out irrelevant code

        AdministerUserAndTenant(tenant.Name, model.AccountableEmailAddress);
    }
}

private void AdministerUserAndTenant(string tenantName, string emailAddress)
{
    // 2 - Try to retrieve the user from a different (!) instance of UserRepository
    var user = UserRepository.GetUser(emailAddress);
    var tenant = TenantRepository.GetTenantByName(tenantName);
    tenant.Users.Add(user);
    TenantApplicationContext.SaveChanges();
} 
```

我希望你仍然可以跟随，尽量省略不必要的部分。

处理此类问题的最佳方法是什么？

PS：我不是很喜欢这种`Singleton`模式，所以如果可能的话不要去那里:)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:11:28.320

究竟什么时候会成为问题？因为这就是答案所在。应该知道彼此未保存更改的类应该使用相同的存储库实例。由于它们可能是相关的，因此您将管理在它们之间传递引用。

如果您的所有应用程序都应该有一个存储库是有原因的，请使用依赖注入。

# visual-studio - 在 Visual Studio 中同时使用垂直和水平拆分的最简单方法是什么？

> ID：14791614
> 
> 赞同：6
> 
> 时间：2013-02-09T21:07:54.893
> 
> 标签：visual-studio, ide, visual-studio-2012, editor

如下面的屏幕截图所示，用红色箭头标记：

![截屏](../Images/7d3e7d9bd76a8a313c5fc77441e8ce89.png)

如果我使用`Vertical Tab Split`子窗口，我将无法拆分插入另一个选项卡并水平拆分它。是否有任何插件或设置我可以更改以便能够将我的代码选项卡放在矩形网格中？

只是为了澄清-我不想两次看到相同的文件内容。我希望每个选项卡都显示不同的文件。我找不到引入这种对 ide 的过度简化的原因。

我知道它可以通过打开许多独立的窗口来解决，但这对我来说几乎不是答案。

[这是 Sublime 2 中的示例](https://i.imgur.com/GvjOxId.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-25T10:26:08.950

正如您所发现的，它不是 VS shell 的一个特性。作为参考，在 VS2010 中也不可能。

您可以在 Visual Studio 开发人员社区网站上投票支持此功能 - 此处[有具体要求](https://developercommunity.visualstudio.com/idea/351247/split-visual-studio-windows-horizontally-and-verti.html)

# node.js - 在 Localhost 上运行后关闭 Node.js 服务器

> ID：14791616
> 
> 赞同：5
> 
> 时间：2013-02-09T21:08:01.217
> 
> 标签：node.js

这可能是一个简单的问题，但我无法在任何地方找到明确的答案。我正在 node.js 上尝试 Hello World。我有一个 node.js 服务器在 localhost 的 8000 端口上运行，通过命令行打开，例如“node helloworld.js”。Helloworld.js 通过 localhost:8000 运行良好。现在，当我尝试在端口 8000 上打开另一台服务器时，虽然我收到错误“listen EADDRINUSE”，因为第一台服务器仍在运行。那么如何关闭第一个节点服务器呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-09T21:17:13.420

只需通过执行 ctrl-c 来终止进程...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-07-14T03:56:02.390

如果您仍然拥有运行 Nodejs 服务器的原始终端，则只需按 ctrl + C 即可终止该进程。

但是，如果您丢失了终端，则可以打开另一个终端并运行`taskkill /F /IM node.exe`. （/F 强制终止，/IM 指定要终止的脚本）。请注意，该命令会杀死所有正在运行的节点服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-10T17:41:18.627

如果您无法再访问终端，请转到 Windows 上的任务管理器或 Mac 上的“强制退出”并结束“Node.Js ...”进程。

在我看来，这是最干净的方法（如果没有终端窗口）。

# android - 如何从外部将方法调用到 AsyncTask 类中？

> ID：14791617
> 
> 赞同：2
> 
> 时间：2013-02-09T21:08:02.203
> 
> 标签：android, sockets, android-asynctask

我有两个简单的类：

```
public class MainActivity extends Activity {
    NetworkTask task;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        [...]       
        task = new NetworkTask();
        task.execute();
    }

public void myClickHandler(View view) {
    switch(view.getId()) {
        case R.id.button1:
            // Why this line crash?
            task.connection("127.0.0.1");
        break;
        }
    }
} 
```

和

```
public class NetworkTask extends AsyncTask<String, Void, String> {
    Socket sock;
    volatile boolean running = true;

    public int connection(String url){
        try{
            sock = new Socket(url, 4567)
        }
        catch (IOException ex){
            Logger.getLogger(NetworkTask.class.getName()).log(Level.SEVERE, null, ex);
            return -1;
        }
    }

    public String doInBackground(String... strings) {

        // If I do this, it works well
        //connection(127.0.0.1);

        while(running)
        {
            [...]
        }

        return null;
    }   
} 
```

正如我在从 AsyncTask 方法外部调用连接方法时评论的那样，应用程序崩溃更特别 « sock = new Socket(...) » 行。但是当在 AsynTask 方法内完成连接调用时，会创建套接字。我不明白为什么。

发生了什么？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T21:11:29.610

这是因为当你这样做

```
task.connection("127.0.0.1"); 
```

您仍在主（UI）线程中工作 - 您没有正确使用 AsyncTask。相反，您像普通课程一样使用它，因此，您可以获得`NetworkOnMainThreadException`新的 Android 版本。

但是，当您调用 from 时`doInBackground()`，这意味着您通过启动 AsyncTask`execute`并且工作在*单独*的线程中完成，让一切正常工作。

请记住，如果你在做非网络的事情，你仍然可以从外面打电话。但是，我建议让您的 AsyncTask 尽可能少地依赖外部，因为 AsyncTasks 只运行一次。如果你想做更多的工作，你必须创建一个新实例，这意味着如果你依赖于 setter 方法或类似方法，你必须确保再次调用这些方法，这使得这个简单的类比需要的更复杂。

对于如何使用 AsyncTask，[这](http://androidresearch.wordpress.com/2012/03/17/understanding-asynctask-once-and-forever/)是一个很好的来源。当然还有[官方文档](http://developer.android.com/reference/android/os/AsyncTask.html)。

# javascript - 检测IE10兼容模式

> ID：14791619
> 
> 赞同：14
> 
> 时间：2013-02-09T21:08:09.180
> 
> 标签：javascript, jquery, html, internet-explorer, internet-explorer-10

我有一些适用于 IE 10 和其他 IE 版本的特定代码路径。如果 IE10 在兼容模式下运行，则浏览器版本设置为 7.0。无论使用 JavaScript/JQuery 的标准/兼容模式如何，有没有办法检测它是否是 IE 10？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-11T09:32:01.313

您可以使用`navigator.userAgent`字符串检测到这一点，例如

> “Mozilla/4.0（兼容；MSIE 7.0；Windows NT 6.2；WOW64； **Trident/6.0**；.NET4.0E；.NET4.0C；InfoPath.3；.NET CLR 3.5.30729；.NET CLR 2.0.50727；.NET CLR 3.0.30729；Zune 4.7)"

Trident/6.0 表示 IE10

MSIE 7.0 表示兼容模式

更多详情：[https ://stackoverflow.com/a/5825518/255654](https://stackoverflow.com/a/5825518/255654)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-08-07T13:46:54.150

这应该可以检测 MSIE 的兼容模式。

**即检查.js**

```
function trueOrFalse() {
    return true;
}

function IeVersion() {
    //Set defaults
    var value = {
        IsIE: false,
        TrueVersion: 0,
        ActingVersion: 0,
        CompatibilityMode: false
    };

    //Try to find the Trident version number
    var trident = navigator.userAgent.match(/Trident\/(\d+)/);
    if (trident) {
        value.IsIE = true;
        //Convert from the Trident version number to the IE version number
        value.TrueVersion = parseInt(trident[1], 10) + 4;
    }

    //Try to find the MSIE number
    var msie = navigator.userAgent.match(/MSIE (\d+)/);
    if (msie) {
        value.IsIE = true;
        //Find the IE version number from the user agent string
        value.ActingVersion = parseInt(msie[1]);
    } else {
        //Must be IE 11 in "edge" mode
        value.ActingVersion = value.TrueVersion;
    }

    //If we have both a Trident and MSIE version number, see if they're different
    if (value.IsIE && value.TrueVersion > 0 && value.ActingVersion > 0) {
        //In compatibility mode if the trident number doesn't match up with the MSIE number
        value.CompatibilityMode = value.TrueVersion != value.ActingVersion;
    }
    return value;
} 
```

**即检查.html**

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Testing IE Compatibility Mode</title>
    <script src="iecheck.js" type="text/javascript"></script>
</head>
<body>
<div id="results">Results: </div>
</br>
<script type="text/javascript">

var ie = IeVersion();

document.write("IsIE: " + ie.IsIE + "</br>");
document.write("TrueVersion: " + ie.TrueVersion + "</br>");
document.write("ActingVersion: " + ie.ActingVersion + "</br>");
document.write("CompatibilityMode: " + ie.CompatibilityMode + "</br>");

</script>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-19T02:34:36.317

用户代理字符串中的 Trident 值表示正在运行的 IE 的实际版本。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-08-29T21:24:09.233

这是我从 JQuery .ready 中使用的

```
 $(document).ready(function () {
    var iec = new IECompatibility();
    alert('IsIE: ' + iec.IsIE + '\nVersion: ' + iec.Version + '\nCompatability On: ' + iec.IsOn);
  });

  function IECompatibility() {
    var agentStr = navigator.userAgent;
    this.IsIE = false;
    this.IsOn = undefined;  //defined only if IE
    this.Version = undefined;

    if (agentStr.indexOf("MSIE 7.0") > -1) {
      this.IsIE = true;
      this.IsOn = true;
      if (agentStr.indexOf("Trident/6.0") > -1) {
        this.Version = 'IE10';
      } else if (agentStr.indexOf("Trident/5.0") > -1) {
        this.Version = 'IE9';
      } else if (agentStr.indexOf("Trident/4.0") > -1) {
        this.Version = 'IE8';
      } else {
        this.IsOn = false; // compatability mimics 7, thus not on
        this.Version = 'IE7';
      }
    } //IE 7
  } 
```

本霍布古德

# c - 将错误文本与 C 中的错误代码相关联

> ID：14791621
> 
> 赞同：3
> 
> 时间：2013-02-09T21:08:22.790
> 
> 标签：c, algorithm, data-structures

我将编写一个将错误消息转换为错误代码的函数。所以我有一系列错误消息

```
const char *arr_error_message[] = 
{
    "Critical error",
    "Unexpected error",
    ...
} 
```

和错误代码的枚举：

```
typedef enum error_code
{
    FIRST = 0,
    CRITICAL_ERROR = FIRST,
    UNEXPECTER_ERROR,
    ...
    LAST,
    NOT_FOUND_ERROR
} error_code_t; 
```

并且功能将是

```
error_code_t translate_error_code(const char *err)
{
error_code_t e = FIRST;
do
{
        if ( strcmp(arr_error_message[e], err) == 0 ) return e;
} while (++e != LAST);

return NOT_FOUND_ERROR;
} 
```

函数实现的更有效方式是什么，有什么方法（技巧）可以实现复杂度 O(1) 的函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:11:40.130

我认为这只是获得正确数据结构的问题。如果您希望能够从错误代码直接映射到字符串表示，您可以只返回存储在适当数组索引中的错误代码：

```
return arr_error_message[err]; 
```

另一方面，如果您想从错误消息映射到错误代码，您可以考虑使用哈希表。由于您的错误代码集（可能）将相对恒定，您可以考虑使用该[`gperf`工具生成一个完美的哈希表](http://www.gnu.org/software/gperf/)，这样可以非常快速地将错误消息映射到错误代码。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:15:49.703

如果您打算从错误代码中获取错误字符串，那么一个简单的数组就足以获得 O(1) 算法。

但是由于您想要错误字符串中的错误代码，所以我知道的最好的方法是使用哈希表来存储和检索节点。使用 gnu gperf。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T22:56:11.523

这只是乞求一个[基数树](http://en.wikipedia.org/wiki/Radix_tree)结构。C 并没有真正的字符串，所以所有的字符串比较无论如何都将是比较单个字符的循环。字符串都是常量。因此，您不妨将字符串拆分为它们的复合字符，并从中手动构建树，然后一次遍历树一个字符。

# php - 在执行 php 索引页面时出现错误“mysql_error() 期望参数 1 是资源”

> ID：14791622
> 
> 赞同：-1
> 
> 时间：2013-02-09T21:08:24.433
> 
> 标签：php, mysql

我正在尝试在 Xampp 服务器上部署 php 应用程序并在 index.php 上出现错误

```
Warning: mysql_connect(): Access denied for user 'root'@'localhost' (using password: YES) in C:\xampp\htdocs\xampp\php-inventory\lib\database.php on line 85
Warning: mysql_error() expects parameter 1 to be resource, boolean given in C:\xampp\htdocs\xampp\php-inventory\lib\database.php on line 85
CDatabase::Connect() error 
```

这是错误的功能：

```
function Connect($connect_params = "") {
    extract($connect_params);
    //resource mysql_connect ( [string server [, string username [, string password [, bool new_link !!! [, int client_flags ]]]]] )
    $this - > conn_id = mysql_connect($server, $login, $password, True) or die("CDatabase::Connect() error ".mysql_error($this - > conn_id));

    if ($default != "") $this - > SelectDB($default);
} 
```

我尝试将“true”更改为 1 仍然相同。我是 php 新手，找不到任何有用的东西。没有为mysql设置密码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:15:47.723

您的密码错误。修复它。您可能也不应该使用 root 作为用户。另外，不要使用`ext/mysql`

您在 mysql_error 上收到警告的原因是连接错误不会返回资源（它们毕竟无法建立连接）。Mysql_error 需要资源来从数据库连接中获取错误。没有连接，它不能。幸运的是，mysql_connect 会自行报告错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:50:02.527

1.  “... 用户'root'@'localhost' 的访问被拒绝（使用密码：YES）...” 用户名或密码错误。
2.  “没有为 mysql 设置密码”是什么意思。?
3.  为什么是root用户？
4.  第二个警告：

> mysql_error() 期望参数 1 是资源，给定的布尔值

因为：“成功时返回 MySQL 链接标识符，失败时返回 FALSE。” [http://php.net/manual/en/function.mysql-connect.php](http://php.net/manual/en/function.mysql-connect.php) 5\. 更改`or die ( ... )`为

`if(!$this->conn_id) { // Error }`

# networking - 在 Netlogo 上的图中提取子图（集团）

> ID：14791624
> 
> 赞同：0
> 
> 时间：2013-02-09T21:08:39.787
> 
> 标签：networking, netlogo, subgraph, clique

我有一个 netlogo 问题。我有一些与（无向）链接连接的节点的图形结构。我需要找出其中一个结构中最小的子图。基本上子图意味着哪些节点都相互连接。因此，如果我有 5 个节点的结构并且节点 1 连接到 2 和 3；节点 2 到 3、1 和 4；和节点 3 到 1、2 和 5 我需要检测节点 1、2 和 3 的子图，因为它们都是互连的。

有没有一种简单的方法可以做到这一点，或者它基本上在计算上是不可能的？

编辑：我发现如果我使用 netlogo 扩展 nw 我可以使用 nw:maximal-cliques 方法来计算我想要的。虽然现在我有另一个问题。我正在尝试以这种方式填写集团列表

```
let lista-cliques [nw:maximal-cliques] of turtles with [guild = g] 
```

lista-cliques 通常长度为 2，但第一个元素应该是 clique 的海龟列表，是这样的列表

```
[[[nobody] [nobody] [nobody] [nobody]...etc 
```

当 guild = g 的海龟制作的图的长度约为 2-8 只海龟时，长度为 300。对 nw:maximal-cliques 的调用做得好吗？

关于我做错了什么的任何想法？

编辑2：我想出了如何通过这样做来修复列表的长度

```
let lista-cliques (list ([nw:maximal-cliques] of turtles with [guild = g])) 
```

现在该列表不是 300 个节点，而是等于图中具有 guild = g 的节点的节点数量。

这意味着

```
length item 1 lista-cliques 
```

等于

```
count turtles with [guild = g] 
```

这显然也是错误的，因为我可以看到节点仅连接到一个或两个节点的图形。我想我越来越近了，但我不知道为什么 nw:maximal-cliques 没有创建最大集团的列表，而是创建图表上所有节点的列表。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T16:10:52.447

您的用法`nw:maximal-cliques`不太正确。

我认为您试图通过指定来表达的`of turtles with [guild = g]`内容类似于“仅考虑属于公会*g*的海龟”，但它对 NetLogo 的实际含义是“运行`of`作为每个海龟一部分的报告器公会*g*并从中列出清单”。（就像，例如，`[color] of turtles`将为每个海龟运行`[color]`一次报告程序块，并使用结果构建一个颜色列表。）

`nw:maximal-cliques`是一个*在整个网络*上运行的原语，所以你不想为每个海龟运行一次。就像`nw`扩展中的大多数原语一样，您需要使用`nw:set-snapshot`原语告诉它要操作哪些海龟和链接。

我认为您只需执行以下操作即可实现您想要的：

```
nw:set-snapshot (turtles with [guild = g]) links
let lista-cliques nw:maximal-cliques 
```

（请注意，它`nw:set-snapshot`会为您的网络拍摄一张静态“图片”，在该图片上进一步调用`nw`原语。如果您的网络发生变化，您需要调用`nw:set-snapshot`以拍摄一张新照片。这可能会在扩展的未来版本中发生变化。）

# apache - 在我的专用服务器上安装 litespeed 后重新启动 Apache 时，我收到此消息：

> ID：14791642
> 
> 赞同：1
> 
> 时间：2013-02-09T21:11:21.380
> 
> 标签：apache, whm, litespeed

在我的专用服务器上安装 litespeed 后尝试重新启动 Apache 时出现此错误：

```
 Apache restarted, but pid file does not match process list pids.

If apache restart reported success but it failed soon after, 
it may be caused by   oddities with mod_ssl.

You should run /usr/local/cpanel/scripts/ssl_crt_status as part of your 
troubleshooting process. Pass it --help for more details.

Also be sure to examine apache's various log files.
Apache Restart Output:

Log:
2013-02-09 20:54:17.062 [NOTICE] [Child: 15131] Shut down successfully! 
2013-02-09 20:54:17.066 [NOTICE] [AutoRestarter] cleanup children  
processes and unix sockets of process with pid=15132 !
2013-02-09 20:54:17.070 [NOTICE] [AutoRestarter] child process with 
pid=15132 exited with status=0!
2013-02-09 20:54:17.070 [NOTICE] [AutoRestarter] cleanup children processes 
and unix sockets of process with pid=15131 !
2013-02-09 20:54:17.170 [NOTICE] [AutoRestarter] child process with 
pid=15131 exited with status=0!
2013-02-09 20:54:17.170 [NOTICE] [PID:15129] Server Stopped!
2013-02-09 20:54:18.200 [NOTICE] [AutoUpdate] Checking for new releases..., pid=15272
2013-02-09 20:54:18.201 [NOTICE] Start to clean up cache directory, pid=15273
2013-02-09 20:54:18.518 [INFO] [AutoUpdate] No new update.
[Sat Feb 09 20:54:19 2013] [notice] suEXEC mechanism enabled  
(wrapper: /usr/local/apache/bin/suexec)
[Sat Feb 09 20:54:19 2013] [notice] Apache/2.0.64 (Unix) 
mod_ssl/2.0.64 OpenSSL/1.0.0-fips mod_auth_passthrough/2.1 
mod_bwlimited/1.4 FrontPage/5.0.2.2635 configured -- resuming normal operations 
```

我没有足够的经验来解决问题所在，但我正在努力学习......任何帮助将不胜感激......谢谢

眼镜：

*   CENTOS 6.3 x86_64
*   WHM 11.34
*   PHP 版本 5.3.21
*   光速 4.2.1
*   服务器版本：Apache/2.0.64 (Unix) mod_ssl/2.0.64 OpenSSL/1.0.0-fips mod_auth_passthrough/2.1 mod_bwlimited/1.4 FrontPage/5.0.2.2635
*   LiteSpeed 正在运行 (PID = 15263)。Apache 正在运行 (PID = 15335)。
*   启用suEXE

# visual-studio-2012 - 为什么影子任务找不到引用的 DLL？

> ID：14791643
> 
> 赞同：1
> 
> 时间：2013-02-09T21:11:23.787
> 
> 标签：visual-studio-2012

从 VS2010 迁移的单元测试项目仍然使用自动生成的私有属性访问器。

在对包含类库项目、类库项目的单元测试项目和 Web 项目的解决方案进行数小时编码和测试后，突然出现错误。Web 项目在 IIS Express 下执行。

> 错误 24 无法加载文件或程序集“The.ClassLibrary，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null”或其依赖项之一。该系统找不到指定的文件。.ClassLibrary.Tests

事实

*   The.ClassLibrary.Tests 有一个对 The.ClassLibrary 的项目引用。
*   没有其他构建错误（检查构建输出而不仅仅是错误窗口）
*   DLL 以当前时间戳在物理上存在`bin\debug`
*   我重新启动了 IIS Express
*   我重新启动了 Visual Studio
*   清理/重建解决方案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:11:23.787

**选项 A**

*解决这个问题。它可能会再次发生。*

除了尝试的步骤之外，还需要搜索并删除磁盘上*所有*出现的 The.ClassLibrary.Dll。所以，完整的程序是：

*   停止 IIS Express
*   退出 Visual Studio 2012
*   搜索并删除“缺失”DLL 的*所有*实例。
*   启动 Visual Studio 2012

我希望这可以帮助别人。

**选项 B**

*正确修复问题*

私有访问器在 VS2012 中折旧。相反，将需要对单元测试可见的*私有内容改为**内部*，并使用正在测试的项目中的[InternalsVisibleTo](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)属性`AssemblyInfo.cs`来允许测试项目访问测试对象的内部属性、方法和字段。

*AssemblyInfo.cs*（MyProject 的）

```
[assembly: InternalsVisibleTo("MyNs.MyProject.Tests")] 
```

# .net - webClient.DownloadData 到 byte[]

> ID：14791654
> 
> 赞同：0
> 
> 时间：2013-02-09T21:12:21.120
> 
> 标签：.net

我有一个用于测量互联网速度的代码。该代码在本地看起来运行良好，但是当我在服务器上使用它时会出现错误“尝试除以零”。temp.tostring() 也返回“byte[]0”

```
System.Diagnostics.Stopwatch sw;
Byte[] temp;
protected void Page_Load(object sender, EventArgs e)
{
    System.Net.WebClient webClient = new System.Net.WebClient();

    sw = System.Diagnostics.Stopwatch.StartNew();
    try
    {
        temp = webClient.DownloadData("http://www.xxx.com/yyy.rar");
    }
    catch (Exception ex)
    {
        Response.Write(ex.Message);
    }
    sw.Stop();

    long speed = temp.Length / sw.Elapsed.Seconds;

    Response.Write(Convert.ToInt32((speed / 1000)).ToString());
} 
```

更新！

事实证明，我对像这样测量用户的互联网速度的逻辑是错误的。此代码在本地下载数据，因此在几毫秒内完成。我应该怎么做来衡量用户的互联网速度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:16:12.783

你可能被零除，因为

```
sw.Elapsed.Seconds 
```

为零。 `Seconds`是 type `int`，所以如果响应很快，它将为零。使用*毫秒*以获得合理的精度，并在任何情况下检查为零。

如果`temp`不包含数据，则您的请求中未返回任何数据，因为 URL 无法解析（异常处理程序是否运行？），或者因为 Web 服务器返回的 HTTP 代码为 200，但响应正文为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:16:17.980

你的意思是`sw.Elapsed.TotalSeconds`。`Seconds`是挂钟秒数（环绕到零，或从零开始一秒）。

堆栈跟踪会告诉你。我被迫猜测。不是一个好的调试策略。

如果发生异常，您也会继续前进。您还需要在本地测试异常情况 - 您会发现错误。

# ruby-on-rails - CarrierWave_Direct gem：在 S3 上保留当前目录结构

> ID：14791655
> 
> 赞同：4
> 
> 时间：2013-02-09T21:12:32.607
> 
> 标签：ruby-on-rails, image, amazon-s3, carrierwave

所以我有一个网站已经在生产中，它使用存储在亚马逊 s3 上的图像的carrierwave gem。我的上传者使用该`store_dir`方法指定特定结构以放入处理后的图像。

好吧，现在在我的开发环境中，我添加了carrierwave_direct gem 以开始直接上传到S3。问题是这个 gem 完全覆盖了我的上传器中的 store_dir 和文件名默认值。我无法实时推送我完全正常工作的上传器，因为我所有的旧图片链接都会被破坏。

据我了解，CWdirect gem 会将原始图像文件上传到 S3 上的“临时”目录，然后 S3 会响应并为您提供一个`key`变量，以便您可以获取该文件并按照您认为合适的方式处理它。那么，我应该在carrierwave中使用一个完全独立的图像上传器类来处理图像并将它们放在正确的文件夹中吗？这意味着我将有一个专门用于carrierwave_direct 的上传器，可以上传这个gem 似乎想要上传到的任何地方；我将使用另一个链接到我的真实模型的 uploader.rb 类来保持我当前的 store_dir 和文件名结构？

无论如何，我的基本问题是，如果我已经在生产中运行 CW，并且图像在特定文件夹结构中，我该如何使用 CarrierWave_Direct gem？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T22:13:18.493

好的，所以我确实想出了如何做到这一点，我将在下面解释。我的直觉是使用两个不同的 CarrierWave 上传器类是正确的——一个类专门用于上传到 S3（使用 CarrierWave_Direct gem），第二个类仅用于图像处理（我已经在生产中使用的类）。我会尝试在下面发布相关代码，但如果有人有问题请告诉我。我不确定为什么我没有看到其他人使用这样的单独类，但它似乎对我有用。

我的图片上传器类`app\uploaders\image_uploader.rb`使用carrierwave_direct gem：

```
class ImageUploader < CarrierWave::Uploader::Base
  include CarrierWaveDirect::Uploader

  include ActiveModel::Conversion
  extend ActiveModel::Naming

  include CarrierWave::MimeTypes
  process :set_content_type

  # Add a white list of extensions which are allowed to be uploaded.
  # For images you might use something like this:
  def extension_white_list
    %w(jpg jpeg gif png)
  end

  # Include the Sprockets helpers for Rails 3.1+ asset pipeline compatibility:
  include Sprockets::Helpers::RailsHelper
  include Sprockets::Helpers::IsolatedHelper

  # Override the directory where uploaded files will be stored.
  # CarrierWaveDirect::Uploader puts raw uploaded files in this directory on S3 as a first step
  def store_dir
    "unprocessed_uploads"
  end
end 
```

**注意在这个类中没有进行任何处理

我的图像处理类`app\uploaders\image_processor.rb`（生产中已经存在的）：

```
class ImageProcessor < CarrierWave::Uploader::Base

  # Include RMagick or MiniMagick support:
  # include CarrierWave::RMagick
  include CarrierWave::MiniMagick
  include CarrierWave::MimeTypes
  process :set_content_type

  # Include the Sprockets helpers for Rails 3.1+ asset pipeline compatibility:
  include Sprockets::Helpers::RailsHelper
  include Sprockets::Helpers::IsolatedHelper

  # Choose what kind of storage to use for this uploader:
  storage :fog

  # Override the directory where uploaded files will be stored.
  # This is a sensible default for uploaders that are meant to be mounted:
  def store_dir
    "uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}"
    # "uploads/#{model.class.to_s.underscore}/path/#{model.id}"
  end

  # Provide a default URL as a default if there hasn't been a file uploaded:
  def default_url
    "logos/" + [version_name, "default.png"].compact.join('_')
  end

  # Process files fetched from S3 after they are uploaded:

  def make_thumbnail(width, height)
    # uses MiniMagick classes to get a square, centered thumbnail image
    manipulate! do |img|
      if img[:width] < img[:height]
        remove = ((img[:height] - img[:width])/2).round
        img.shave("0x#{remove}")
      elsif img[:width] > img[:height]
        remove = ((img[:width] - img[:height])/2).round
        img.shave("#{remove}x0")
      end

      img.resize("#{width}x#{height}")
      img
    end        
  end

  # Create different versions of your uploaded files:
  # the process statement below isn't defined within a version block on purpose--this means the ORIGINAL uploaded photo is constrained to 1050 pics
  process :resize_to_limit => [1050, 1050]
  process :quality => 85 # this reduces filesize greatly and saves space

  version :thumb do
    process :make_thumbnail => [100, 100]
    process :quality => 85 # this reduces filesize greatly and saves space
  end

  version :big_thumb do
    process :make_thumbnail => [350, 350]
    process :quality => 85 # this reduces filesize greatly and saves space
  end

  # Add a white list of extensions which are allowed to be uploaded.
  # For images you might use something like this:
  def extension_white_list
    %w(jpg jpeg gif png)
  end

  # Override the filename of the uploaded files:
  # Avoid using model.id or version_name here, see uploader/store.rb for details.
  def filename
    if original_filename
      if model && model.read_attribute(:image).present?
        model.read_attribute(:image)
      else
        "#{secure_token}.#{file.extension}"
      end
    end
  end

protected
  def secure_token
    var = :"@#{mounted_as}_secure_token"
    model.instance_variable_get(var) or model.instance_variable_set(var, SecureRandom.uuid)
  end

end 
```

我的照片模型（总结）：

```
class Photo < ActiveRecord::Base
  mount_uploader :image, ImageProcessor

  def save_and_process_image(options = {})
    s3_unprocessed_image_url = self.image.asset_host + '/' + self.key
      # this next line downloads the image from S3
      # and this save line below will process the image and reupload to S3 according to ImageProcessor settings
      self.remote_image_url = s3_unprocessed_image_url
      save
  end

end 
```

我也有可用的照片控制器和查看代码，如果你想要它让我知道。基本上，我使用 ImageUploader 类将初始上传到 S3 到一个名为 unprocessed_uploads 的文件夹。然后 S3 用`key`我传递给 ImageProcessor 类的 URL 中的一个字段进行响应——它附加到照片并处理缩略图和其他图像，然后将它们重新上传到我在 S3 上的上传文件夹。

这种分离意味着我在添加carrierwave_direct gem 时不需要更改我在S3 上的当前文件夹结构。希望这对其他人有帮助。如果您需要更多代码，请告诉我，我有点厌倦了打字:)

***更新——添加更多代码：***

照片控制器：

```
class PhotosController < ApplicationController

  def index
    @photos = @photos.sort_by(&:created_at)

    @uploader = ImageUploader.new
    @uploader.success_action_redirect = new_tank_photo_url(@tank)

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @photos }
    end
  end

  def create
    respond_to do |format|

      if @photo.save_and_process_image
        format.html { redirect_to tank_photos_path(@tank), notice: 'Photo uploaded successfully and is being processed...' }
        format.json { render json: @photo, status: :created, location: @photo }
      else
        format.html { render :new }
        format.json { render json: @photo.errors, status: :unprocessable_entity }
      end
    end
  end 
```

照片索引视图，带有上传按钮的表单：

```
 <%= direct_upload_form_for @uploader, :html => {:class => "form-inline"} do |f| %>
        <%= f.file_field :image %>
        <%= f.submit "Upload", :class => "btn btn-primary btn-medium" %>
    <% end %> 
```

因此，添加了上述视图/控制器代码后，这里是所采取步骤的摘要。`ImageUploader`请注意类和类之间的区别`ImageProcessor`：

1.  在我的照片控制器中，我创建了属于 ImageUploader 类的 @uploader 变量——这意味着在使用 @uploader 的索引/视图表单中提交的图像会将图像上传到“临时”文件夹——因为它使用 ImageUploader 类然后在上传此图像时（尚未）不进行任何处理。
2.  当用户单击表单上的“上传”按钮时，会调用照片>>创建操作。此操作调用@photo.save_and_process_image - 查看模型以查看此方法实际上从 S3 的“临时”文件夹中获取最近上传的图像，对其进行处理，然后将处理后的图像重新上传到其最终目的地。这一切都是可能的，因为我的 Photo 模型链接到*ImageProcessor*类，该类进行处理/上传。它没有链接到单独的 ImageUploader 类。

希望这有助于解释我正在发生的事情

# php - 从 mysql 数据库中获取事件并放置在日历上

> ID：14791658
> 
> 赞同：2
> 
> 时间：2013-02-09T21:13:10.993
> 
> 标签：php, mysql, calendar

我有一个 php 日历，可以准确显示我想要的方式。现在我需要获取存储在 mysql 数据库中的事件并将它们放在日历上。我以为我的代码是这样做的，但我不知道出了什么问题。

日历代码：

```
 <?php

    $db = mysql_connect("***", "***", "***") or die("Could not connect.");
    $link = mysql_select_db("***",$db);

  /* draws a calendar */
  function draw_calendar($month,$year,$events = array()){

/***********************************************CONTROLS************************************************/
    /* date settings */
    $month = (int) ($_GET['month'] ? $_GET['month'] : date('m'));
    $year = (int)  ($_GET['year'] ? $_GET['year'] : date('Y'));

    if($month < 10){
            $month = str_pad($month, 2, '0', STR_PAD_LEFT);
        }
    /* select month control */
    $select_month_control = '<select name="month" id="month">';
    for($x = 1; $x <= 12; $x++) {
      $select_month_control.= '<option value="'.$x.'"'.($x != $month ? '' : ' selected="selected"').'>'.date('F',mktime(0,0,0,$x,1,$year)).'</option>';
    }
    $select_month_control.= '</select>';
    /* select year control */
    $year_range = 7;
    $select_year_control = '<select name="year" id="year">';
    for($x = ($year-floor($year_range/2)); $x <= ($year+floor($year_range/2)); $x++) {
      $select_year_control.= '<option value="'.$x.'"'.($x != $year ? '' : ' selected="selected"').'>'.$x.'</option>';
    }
    $select_year_control.= '</select>';
    /* "next month" control */
    $next_month_link = '<a href="?month='.($month != 12 ? $month + 1 : 1).'&year='.($month != 12 ? $year : $year + 1).'" class="control">Next Month >></a>';
    /* "previous month" control */
    $previous_month_link = '<a href="?month='.($month != 1 ? $month - 1 : 12).'&year='.($month != 1 ? $year : $year - 1).'" class="control"><<   Previous Month</a>';
    /* bringing the controls together */
    $controls = '<form method="get">'.$select_month_control.$select_year_control.'&nbsp;<input type="submit" name="submit" value="Go" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'.$previous_month_link.'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'.$next_month_link.' </form>';
    echo $controls;

/*******************************************START CALENDAR*******************************************/
    /* draw table */
    $calendar = '<table cellpadding="0" cellspacing="0" class="calendar">';
    /* table headings */
    $headings = array('Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday');
    $calendar.= '<tr class="calendar-row"><td class="calendar-day-head">'.implode('</td><td class="calendar-day-head">',$headings).'</td></tr>';
    /* days and weeks vars */
    $running_day = date('w',mktime(0,0,0,$month,1,$year));
    $days_in_month = date('t',mktime(0,0,0,$month,1,$year));
    $days_in_this_week = 1;
    $day_counter = 0;
    $dates_array = array();
    /* row for week one */
    $calendar.= '<tr class="calendar-row">';
    /* print "blank" days until the first of the current week */
    for($x = 0; $x < $running_day; $x++):
        $calendar.= '<td class="calendar-day-np">&nbsp;</td>';
        $days_in_this_week++;
    endfor;
    /* keep going with days */
    for($list_day = 1; $list_day <= $days_in_month; $list_day++):
        if($list_day == date("d") && $month == date("n") && $year == date("Y")) {
            $calendar.= '<td class="calendar-day current">';
        }
        else {
            $calendar.= '<td class="calendar-day">';
        }
        /* add in the day number */
        if($list_day < 10){
            $list_day = str_pad($list_day, 2, '0', STR_PAD_LEFT);
        }
        $calendar.= '<div class="day-number">'.$list_day.'</div>';

        /******************************************CHECK FOR 

EVENTS*******************************/
            $event_day = $year.'-'.$month.'-'.$list_day;
            if(isset($events[$event_day])) {
                foreach($events[$event_day] as $event) {
                  $calendar.= '<div class="event">'.$event['title'].'</div>';
                }
            }
            else {
                $calendar.= str_repeat('<p>&nbsp;</p>',2);
            }
            /*****************************************************************************************/

            $calendar.= '</div></td>';  
            if($running_day == 6):
                $calendar.= '</tr>';
                if(($day_counter+1) != $days_in_month):
                    $calendar.= '<tr class="calendar-row">';
                endif;
                $running_day = -1;
                $days_in_this_week = 0;
            endif;
            $days_in_this_week++; $running_day++; $day_counter++;
        endfor;
        /* finish the rest of the days in the week */
        if($days_in_this_week < 8):
            for($x = 1; $x <= (8 - $days_in_this_week); $x++):
                $calendar.= '<td class="calendar-day-np">&nbsp;</td>';
            endfor;
        endif;
        /* final row */
        $calendar.= '</tr>';
        /* end the table */
        $calendar.= '</table>';
        /** DEBUG **/
      $calendar = str_replace('</td>','</td>'."\n",$calendar);
      $calendar = str_replace('</tr>','</tr>'."\n",$calendar);
        /* all done, return result */
        return $calendar;
      }

    /* get all events for the given month */
    $events = array();
    $query = "SELECT Name, DATE_FORMAT(Date,'%Y-%m-%d') AS Date FROM events WHERE Date LIKE '$year-$month'";
    $result = mysql_query($query) or die('cannot get results!');
    while($row = mysql_fetch_assoc($result)) {
      $events[$row['Date']][] = $row;
    }

    echo '<h2 style="float:left; padding-right:30px;">'.date('F',mktime(0,0,0,$month,1,$year)).' '.$year.'</h2>';
    echo '<div style="float:left;">'.$controls.'</div>';
    echo '<div style="clear:both;"></div>';
    echo draw_calendar($month,$year,$events);
    echo '<br /><br />';

?> 
```

我的数据库表称为 events，字段是 id、Name、Description、Date、Time 和 Place。

为了让事件显示在日历上，我需要修复什么？

编辑：这是回显查询：SELECT Name, DATE_FORMAT(Date,'%Y-%m-%d') AS Date FROM events WHERE Date LIKE '2013-02'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:57:15.593

尝试使用以下查询修改您的选择语句：

```
SELECT Name, DATE_FORMAT(Date,'%Y-%m-%d') AS Date 
   FROM events 
 WHERE Date LIKE '$year-$month%' 
```

另外，您正在使用已弃用的 MySQL php 函数。看看以下链接：

[为什么我不应该在 PHP 中使用 mysql_* 函数？](https://stackoverflow.com/questions/12859942/why-shouldnt-i-use-mysql-functions-in-php)

[我可以用什么来代替 mysql_ 函数？](http://php.net/mysqli)

[准备好的陈述](http://en.wikipedia.org/wiki/Prepared_statement)

[使用 MySQLi 准备的语句](http://php.net/manual/en/mysqli.quickstart.prepared-statements.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T19:43:08.523

请在查询前添加以下代码。还要查看查询以进行更改。它的工作......经过测试

```
$year=$_REQUEST['year'];
$month=$_REQUEST['month'];
$month = sprintf("%02s", $month);
//echo $year;
$query = "SELECT Name, DATE_FORMAT(Date,'%Y-%m-%d') AS Date FROM events WHERE Date LIKE '$year-$month-%'"; 
```

# javascript - 根据复选框更改 HTML 值

> ID：14791666
> 
> 赞同：2
> 
> 时间：2013-02-09T21:13:46.820
> 
> 标签：javascript, html

我想为我的图形设计网站创建一个价目表。

基本上，我的网站设计基本价格为 150 美元，我想创建一个模块，用户可以在其中选中可选框，以增加价格。例如：

价格从 150 美元起，总计在页面底部。用户可以检查选项升级成本，我将使用 20 美元作为示例。选中该框后，页面底部的总金额将升至 170 美元。

我经常从事编程工作，但很少使用 JavaScript。我以前从来没有做过这样的事情，并希望它都是客户端的。我应该从哪里开始？

**编辑 -**

这是我拥有的基本页面的一些 HTML。选中复选框后，应将其值添加到文本区域中的值中。

[http://pastie.org/private/avwkmaqztfqxma5lg6y8q](http://pastie.org/private/avwkmaqztfqxma5lg6y8q)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T00:39:47.093

我能看到的最简单的方法是：

*   在 JavaScript 中将基本价格设置为变量
*   选中或取消选中复选框时调用函数
*   从基本价格中添加或减去复选框的值

我在您的示例代码中添加了两件事。首先，对于每个复选框，我添加了一个 onchange 函数，我们将调用 update()。其次，我给“Total”一个total id。

HTML：

```
Piecemaker - 
<input name="piecemaker" type="checkbox" value="20" onchange="update(this);">
<br>
Network Bar - 
<input name="netbar" type="checkbox" value="15" onchange="update(this);">
<br>
10 Tags - 
<input name="tags" type="checkbox" value="5" onchange="update(this);">
<br>
Shopping System - 
<input name="shop" type="checkbox" value="20" onchange="update(this);">
<br>
<br>
Total: <input id='total' name="total" type="text" value="$150" readonly> 
```

JavaScript 非常简单。设置基本价格 (running_total)，然后从 running_total 中添加或减去复选框的值。

JavaScript：

```
var running_total = 150;

function update(feature) {
    // Check
    if(feature.checked == true){
        // Add value to running_total
        running_total += parseInt(feature.value);
        document.getElementById('total').value = '$' + running_total;
    }
    // Uncheck
    if(feature.checked == false){
        // Subtract value from running_total
        running_total -= parseInt(feature.value);
        document.getElementById('total').value = '$' + running_total;
    }
} 
```

这是 jsfiddle.net 上一个工作示例的链接：http: [//jsfiddle.net/dnA7q/1/](http://jsfiddle.net/dnA7q/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:20:33.497

这是一个非常简单的问题（没有冒犯）。我要做的是将价格放在复选框值中

```
<input type=checkbox value=20 id=feature> 
```

然后，当它被点击时，使用这个值来计算总数：

```
document.gelElementById('feature').addEventListener('click', function () {
    document.getElementById('total') += this.value;
}); 
```

你必须做一些小的字符串操作和使用`parseInt`，但我相信你能解决这个问题。

# actionscript-3 - 声音播放延迟错误

> ID：14791668
> 
> 赞同：3
> 
> 时间：2013-02-09T21:14:00.333
> 
> 标签：actionscript-3, apache-flex, media

我正在使用 Flex + AS3 编写简单的节拍器组件。例如，我希望它在每 500 毫秒后播放“tick1”声音，并且每 4 次播放另一个声音“tick2”。但实际上声音之间的延迟并不相等 - 有时更小，有时更大。我在最新的 Chrome 上测试它。

这是我的代码：

```
//Somewhere here button bound to the 'toggle' function

import flash.utils.Timer;
import flash.events.TimerEvent;
import flash.media.SoundTransform;
import flash.media.SoundChannel;

private var bpm:Number = 120; //2 bit per second, delay=500ms
private var period:Number = 4;
private var timer:Timer = new Timer(bpm, period);

[Embed(source='sounds/1.mp3')]
private var tickSound1Class:Class;
private var tickSound1:Sound;

[Embed(source='sounds/2.mp3')]
private var tickSound2Class:Class;
private var tickSound2:Sound;

private var trans:SoundTransform = new SoundTransform(1);

private function init():void {
    ....

    tickSound1 = new tickSound1Class() as Sound;
    tickSound2 = new tickSound2Class() as Sound;

    update();

    timer.addEventListener(TimerEvent.TIMER, onTimerEvent);

    ....
}

private function update():void {
    timer.delay = 1000 * 60/bpm;
    timer.repeatCount = 0;
}

private function toggle():void {
    if (timer.running) {
        timer.reset();
        startStopButton.label = "Start";
    } else {
        update();
        timer.start();
        startStopButton.label = "Stop";
    }
}

private function onTimerEvent(event:TimerEvent):void {
    var t:Timer = event.currentTarget as Timer;

    if (t.currentCount % period == 0)
        tickSound1.play(0, 0, trans);
    else
        tickSound2.play(0, 0, trans);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:54:51.677

我认为主要有两个原因：

1.  众所周知，`Timer`Flash Player 中的对象不准确，其触发之间的延迟会波动。
2.  `Sound.play()`方法还在声音真正开始播放之前引入了一些延迟，理论上这个延迟是可以波动的。在 Chrome 中使用的 PPAPI 版本的 Flash Player 中，延迟尤其明显。

有几种解决方案。我会建议其中之一：

1.  使用整个节拍器循环（tick1-pause1-tick2-pause2）的预先组合的声音，并使用`Sound.play()`方法的第二个参数循环它；
2.  使用动态声音生成。

第二种选择更灵活，但更难实施。基本上，您需要创建一个新的`Sound`对象实例，订阅它的`SAMPLE_DATA`事件并调用它的`play()`方法。在处理程序中，您将检查`event.position / 44.1`，这将为您提供声音生成的当前位置（以 ms 为单位）。然后，如果您决定是时候播放 tick1 或 tick2 声音，您将调用`tickN.extract(event.data, ...)`，其中`tickN`是 tick1 或 tick2`Sound`对象，否则写入静音。

[您可以在此处](http://www.adobe.com/devnet/flash/articles/dynamic_sound_generation.html)阅读有关动态声音生成的更多信息。

另外，请注意，当您调用`Sound.play()`它时，它会返回一个`SoundChannel`具有该`position`属性的对象。是否是当前正在播放（*未生成*）的声音的毫秒位置，它是准确的。因此，使用此属性，您可以提出第三种方法：创建一个`Sound`对象并设置一个`SAMPLE_DATA`处理程序，就像在动态声音生成解决方案中一样，但始终将静音（零）写入`event.data`处理程序内的对象。这是在不实际播放声音的情况下获得声音通道所必需的。然后，使用高帧率 (60 FPS) 和`Timer`尽可能小的延迟 (1 ms)。每次`Timer`发生火灾时，检查`soundChannel.position`确定是否是时候播放滴答声了，如果是的话，就像你在示例中所做的那样播放它。这种方法很可能解决了`Timer`不准确的问题，但无法处理`tickSound.play()`方法造成的延迟。

# autohotkey - 需要帮助尝试创建一个简单的脚本

> ID：14791672
> 
> 赞同：0
> 
> 时间：2013-02-09T21:14:18.777
> 
> 标签：autohotkey

所以我不知道我到底在做什么，但我需要一个非常简单的脚本的帮助。

基本思想是按一个键，例如 k，每秒四次，重复直到使用命令 (Alt-x) 关闭脚本。

我正在使用 Autohotkey 脚本编辑器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:20:45.197

您可以使用[计时器](http://www.autohotkey.com/docs/commands/SetTimer.htm)。

示例代码：

```
F1::                          ;key that launches this code
    SetTimer, SendKeyK,250    ;set timer to repeat every 250 miliseconds
return                        ;end

F2::
    SetTimer, SendKeyK,Off    ;turn of the timer
return

SendKeyK:
    Send, {k}    ;timer sends (presses) the key k
return 
```

如您所见，无需退出脚本。

# f# - VS Express 2012 for Web 中没有“F# 应用程序”的项目

> ID：14791674
> 
> 赞同：6
> 
> 时间：2013-02-09T21:14:33.597
> 
> 标签：f#

我安装了[F# Tools for Visual Studio Express 2012 for Web](http://www.microsoft.com/web/gallery/install.aspx?appid=FSharpVWD11)。当我选择*New Project*时，我希望在 Visual F# 模板列表中看到*F# Application*，但我看到的只是*F# Library*和*F# Tutorial*。

我说我期待它，因为我在 Chris Smith 的 Programming F# 3.0 一书中看到了它。

有关在列表中获取*F# 应用程序*模板的任何建议？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-09T21:21:02.747

VS Express 2012 Web 版中没有 F# 应用程序模板，但您应该能够通过添加 F# 库项目然后转到项目属性并在应用程序选项卡中将输出类型指定为控制台应用程序来轻松创建一个。

以下来自 Jon Harrop 的简短视频展示了如何创建 Windows 应用程序：[WPF desktop GUI app development in F# with VS Express 2012 for Web](http://www.youtube.com/watch?v=e4R9EfFNgLU)

对于控制台应用程序，该过程是相同的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-10T07:31:03.573

我从此[链接](http://www.microsoft.com/en-gb/download/details.aspx?id=34675)获得了 F# ，并安装了如下所示的扩展（工具 -> 扩展和更新）：

![扩展和更新](../Images/a0790c1b855d36a65491d8eff5ba471d.png)

我现在可以在 Visual Studio Express 2012 for Web 中创建以下类型的项目：

![项目模板](../Images/053139bd53bf25a53ef008e5ed459734.png)

当然，Jon Harrop 的视频非常值得一看。

**编辑**

第二张图片按比例缩小，文字难以辨认。下面的项目模板`Visual F# -> Windows`是：

1.  F# 库
2.  F# 库（类库）
3.  F# Windows 应用程序（服务）
4.  F# Windows 应用程序 (WinForms)
5.  F# Windows 应用程序 (WPF)
6.  F# Windows 控制台应用程序
7.  F# 教程

只是为了完成列表，以下是其他项目类型：

`Visual F# -> Silverlight`

1.  F# Silverlight 库

`ASPNET`

1.  F# 和 C# Web 应用程序 (ASP.NET MVC 4)

`Service`

1.  F# 和 C# Web 服务（ASP.NET、WSDL）

# magento - Magento - Sage 支付系统错误

> ID：14791676
> 
> 赞同：0
> 
> 时间：2013-02-09T21:15:08.387
> 
> 标签：magento, opayo

最近我们移动了托管服务提供商，一旦您尝试提交付款，我们的 Sage Pay 模块就会开始抛出错误。

Sage pay错误日志包含：

```
The error details are: 2003 : An ERROR has occurred on the Sage Pay System. 
```

以前有没有人遇到过这个错误？

[Magento 版本。1.5.1.0]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:56:52.070

您已更改主机，因此您的站点现在位于新 IP 上 - 旧服务器的 IP 是 MySagePay 面板中列出的 IP，因此您需要登录 Sage 并将其更改为新服务器的 IP。无论如何，这是我的猜测。

# java - 在 Android 中访问他人的 Google 日历

> ID：14791681
> 
> 赞同：0
> 
> 时间：2013-02-09T21:15:37.900
> 
> 标签：java, android, google-calendar-api

我正在为我的大学俱乐部开发一个 Android 应用程序（2.3+）。我们的俱乐部将 Google Apps 用于日历、电子邮件等。其中一个帐户托管了我们俱乐部所有即将举行的活动的日历。

在我的应用程序中，我想查询此日历，以便显示下周或下月即将发生的事件。我可以访问日历的“magic cookie”地址。

到目前为止，我看到的每个教程/示例都提供了访问用户日历的说明。如何使用日历 API 访问*不*属于用户的日历？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T19:38:01.810

域的超级管理员有权访问所有用户的日历和日历事件详细信息。

[http://support.google.com/a/bin/answer.py?hl=en&answer=33326](http://support.google.com/a/bin/answer.py?hl=en&answer=33326)

# oracle - ORACLE IIF 声明

> ID：14791684
> 
> 赞同：48
> 
> 时间：2013-02-09T21:15:58.400
> 
> 标签：oracle, conditional-operator, iif

在编写 IIF 语句、表格和下面给出的语句时出现错误。

陈述：

```
SELECT IIF(EMP_ID=1,'True','False') from Employee; 
```

桌子：

```
CREATE TABLE SCOTT.EMPLOYEE
(
   EMP_ID       INTEGER                          NOT NULL,
   EMP_FNAME    VARCHAR2(30 BYTE)                NOT NULL,
   EMP_LNAME    VARCHAR2(30 BYTE)                NOT NULL,
   EMP_ADDRESS  VARCHAR2(50 BYTE)                NOT NULL,
   EMP_PHONE    CHAR(10 BYTE)                    NOT NULL,
   EMP_GENDER   CHAR(1 BYTE)
) 
```

错误：

> 00907-缺少右括号

请提供您的意见。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2013-02-09T21:31:44.893

Oracle 不提供这样的 IIF 功能。相反，请尝试使用以下替代方法之一：

[解码功能](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions040.htm)：

```
SELECT DECODE(EMP_ID, 1, 'True', 'False') from Employee 
```

[案例功能](http://docs.oracle.com/cd/B19306_01/server.102/b14200/expressions004.htm)：

```
SELECT CASE WHEN EMP_ID = 1 THEN 'True' ELSE 'False' END from Employee 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-02-10T08:40:07.843

其他两种选择：

3.  [`NULLIF`](https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions102.htm)和的组合[`NVL2`](https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions106.htm)。你只能使用这个 if `emp_id`is `NOT NULL`，在你的情况下：

    ```
    select nvl2(nullif(emp_id,1),'False','True') from employee; 
    ```

4.  简单[`CASE`表达式](http://docs.oracle.com/cd/B19306_01/server.102/b14200/expressions004.htm)（Mt. Schneiders 使用所谓的搜索`CASE`表达式）

    ```
    select case emp_id when 1 then 'True' else 'False' end from employee; 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-01T16:55:11.770

在 PL/SQL 中，有一个使用未记录`OWA_UTIL.ITE`函数的技巧。

```
SET SERVEROUTPUT ON

DECLARE
    x   VARCHAR2(10);
BEGIN
    x := owa_util.ite('a' = 'b','T','F');
    dbms_output.put_line(x);
END;
/

F

PL/SQL procedure successfully completed. 
```

# jquery - 如何使用 jquery 自动完成获取不在源列表中的文本以发出警报？

> ID：14791687
> 
> 赞同：0
> 
> 时间：2013-02-09T21:16:13.260
> 
> 标签：jquery, jquery-ui

鉴于此示例，[http://jsfiddle.net/CezarisLT/KHqQm/](http://jsfiddle.net/CezarisLT/KHqQm/)

```
 <div class="ui-widget">
   <label for="tags">Tags: </label>
   <input id="tags" />
 </div>

 $(function() {
                var availableTags = ["ActionScript", "AppleScript","Asp","BASIC","C",
  "C++",
  "Clojure",
  "COBOL",
  "ColdFusion",
  "Erlang",
  "Fortran",
  "Groovy",
  "Haskell",
  "Java",
  "JavaScript",
  "Lisp",
  "Perl",
  "PHP",
  "Python",
  "Ruby",
  "Scala",
  "Scheme"];
   $( "#tags" ).autocomplete({
                                 source: availableTags,
                                 select: function( event, ui ) {
                                  }
    });
  }); 
```

如何让不在自动完成源列表中的文本在按下回车键后发出警报？例如，如果我在文本区域中输入了“hello world”，但它不在选项列表中，我如何才能在按回车键后让 hello world 发出警报？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:28:53.263

添加一个事件处理程序来检查输入中按下的键，并在输入键上提醒输入值：

```
$( "#tags" ).on('keyup', function(e) {
      if (e.which == 13) alert(this.value);
  }).autocomplete({
      source: availableTags,
      select: function( event, ui ) {

      }
}); 
```

# android - ADT 中的语言字符串视图

> ID：14791692
> 
> 赞同：0
> 
> 时间：2013-02-09T21:16:41.500
> 
> 标签：android, eclipse

我有一个带有多个语言字符串文件的 android 应用程序，如下所示：

res: -> 值 -> strings.xml -> values-da -> strings.xml

我曾经能够获得一个特殊的视图，我可以在同一个窗口/网格中查看和编辑两个文件。有点像 Excel 表格 - 但现在我无法让它工作。

我所看到的只是以下两个我不想使用的屏幕之一。你有答案吗？

![在此处输入图像描述](../Images/58934eff1f7e7dde23694df9da2d0c72.png)

![在此处输入图像描述](../Images/05eff2c09b0ef57cc62af03223ea7cee.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T09:29:59.850

要执行您描述的操作，您需要安装`Sequoyah`插件。它具有`Sequoyah Android Localization Editor`在一个表中显示不同语言的所有字符串键和相应值的工具。有关 Sequoyah 项目的信息位于此处：[http](http://eclipse.org/sequoyah) ://eclipse.org/sequoyah安装指南位于此处：http: [//eclipse.org/sequoyah/downloads/index.php#update_site](http://eclipse.org/sequoyah/downloads/index.php#update_site)。

# c - 需要澄清malloc

> ID：14791695
> 
> 赞同：0
> 
> 时间：2013-02-09T21:16:59.990
> 
> 标签：c

我有以下代码，在 64 位 linux 上，内核 2.6.x。据我了解，第一个 malloc`rrr=malloc(8)`在堆上分配 8 个字节，而 rrr 现在包含这 8 个字节的起始地址的值。然后，我做一些疯狂的事情。我尝试将 8 字节指针存储在单个字节中，如`*rrr = malloc(8)`. 然后我在第 5 个字节做同样的事情。单个字节最多只能容纳 255 的值，但是当我打印存储在这些字节中的值时，值大于 255。你能解释一下吗？

```
#include <stdlib.h>
#include <stdio.h>

void ** rrr;
int main(int argc, char ** argv)
{
  rrr = malloc(8); // rrr should point to the starting address of an 8 byte block
  *rrr = malloc(8);
  *(rrr+5) = malloc(8);

  for(int i =0;i< 8;i++)
    printf("*rrr%d: %p\n", i, *(rrr+i)); // should print what is stored in each byte

 return 0;
} 
```

一次以上回报

```
*rrr0: 0x9ae030
*rrr1: (nil)
*rrr2: (nil)
*rrr3: 0x21
*rrr4: (nil)
*rrr5: 0x9ae050
*rrr6: (nil)
*rrr7: 0x21 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:18:42.653

> 我尝试将一个 8 字节指针存储在一个字节中

您的代码中没有单个字节。 `rrr`是一个指针，所以也是`*rrr`（因为你声明`rrr`为一个指向指针的指针）。

但是，您几乎可以肯定在这里调用了**未定义的行为**。除非`sizeof(void *)`是 1（这极不可能！），然后写入`*(rrr+5)`将超出您分配的内存范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T21:19:21.033

> 单个字节最多只能保存 255 个值，但是当我打印存储在这些字节中的值时，这些值大于 255

但是`*rrr`是 a `void *`，它在您的机器上可能是 8 个字节，并且能够根据定义保存任何对象指针。

此外，由于您只为 分配了 8 个字节`rrr`，因此第一个元素之后的任何内容（分配或读取）都是非法的。

* * *

您似乎认为分配 8 个字节会以某种方式在元素之间平均分配它们，但事实并非如此。在分配`rrr`指向您可以使用的 8 个字节之后，您可以使用`*rrr = malloc...`. 这一切都是正确的和预期的：`*rrr`是一个空，因此能够保存任何地址，因此能够保存大于你提到的 255 的东西。

当您走得更远`rrr + 1`或更远的时候，您就会陷入未定义的行为，并且会发生意想不到的事情。

### 编辑

> 但我反驳说，如果我打印一个 8 字节块的每个字节值，那么任何字节都可以保存大于 255 的值

但是你不是在打印字节！您正在打印指针并添加`i`到将其`rrr` **推进到下一个指针**。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T21:23:45.267

由于`rrr`is a `void**`，`rrr+5`将 40 字节指向您分配的 8 字节内存，因为 `sizeof(void *) == 8`在 64 位 linux 机器上。

每当您将整数添加到 C 中的指针时，整数总是按（乘以）指针指向的任何大小（`sizeof(*rrr)`此处为`sizeof(void *)`）

# php - 在php代码中插入div和span

> ID：14791696
> 
> 赞同：0
> 
> 时间：2013-02-09T21:17:12.207
> 
> 标签：php, html

我正在尝试让我的网上商店评级通过微数据输出到谷歌。但我不太擅长 php 编码。

我需要在代码中放置 1 个 div 和 2 个 span。

这是原始工作代码：

```
if ($avgratings > 0) {
        $final_avgreview_data = '<img src="'.REDSHOP_ADMIN_IMAGES_ABSPATH.'star_rating/'.$avgratings.'.gif" />';
        $final_avgreview_data .= JText::_('COM_REDSHOP_RATING' )." ".$avgratings." ".JText::_(' ' );
        $final_avgreview_data .= JText::_('COM_REDSHOP_AVG_RATINGS_1' )." ".$totalreviews." ".JText::_('COM_REDSHOP_AVG_RATINGS_2' );
    }
    return $final_avgreview_data;
} 
```

这里只是将 div 和 span 转储到代码中，但需要正确交换才能工作。

```
if ($avgratings > 0) {
        <div itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating">
        $final_avgreview_data = '<img src="'.REDSHOP_ADMIN_IMAGES_ABSPATH.'star_rating/'.$avgratings.'.gif" />';
        $final_avgreview_data .= JText::_('COM_REDSHOP_RATING' )." <span itemprop="ratingValue"> ".$avgratings." </span> ".JText::_(' ' );
        $final_avgreview_data .= JText::_('COM_REDSHOP_AVG_RATINGS_1' )." <span itemprop="reviewCount"> ".$totalreviews." </span> ".JText::_('COM_REDSHOP_AVG_RATINGS_2' );
        </div>
    } 
```

我希望有一个人可以帮助我 ：-）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:35:56.740

这将在评级周围添加 div 和跨度：

```
if ($avgratings > 0) {
    $final_avgreview_data = '<div itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating">';
    $final_avgreview_data .= '<img src="'.REDSHOP_ADMIN_IMAGES_ABSPATH.'star_rating/'.$avgratings.'.gif" />';
    $final_avgreview_data .= JText::_('COM_REDSHOP_RATING' ).' <span itemprop="ratingValue"> '.$avgratings.' </span> '.JText::_(' ' );
    $final_avgreview_data .= JText::_('COM_REDSHOP_AVG_RATINGS_1' ).' <span itemprop="reviewCount"> '.$totalreviews.' </span> '.JText::_('COM_REDSHOP_AVG_RATINGS_2' );
    $final_avgreview_data .= '</div>';
} 
```

# c++ - 如何将一个类的对象用于另一个类的定义或声明

> ID：14791698
> 
> 赞同：-2
> 
> 时间：2013-02-09T21:17:32.643
> 
> 标签：c++, class, object

这是体现问题的一段代码：

```
class Apples {
    Apples() {
        color = 5;
    }
    int color;
};
Apples jonathan;
class Fruit {
    Fruit() {
        type = jonathan.color;
    }
    int type;
}; 
```

给出的错误是：'jonathan' 未声明（首先使用此函数）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:21:05.400

您发布它的方式不会导致该错误。如果它们位于不同的文件中，您只需确保必要的部分位于头文件中并包含（使用#include）必要的头文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:23:27.113

您发布的代码将导致编译时错误（例如构造函数是私有的）。所以这不是真正的代码。

但是，使用全局变量被认为是一种不好的做法，相反，您必须使用成员变量，并根据需要传递引用。

请注意，您的`Apple()`构造函数是私有的。构造函数也是如此`Fruit()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-28T20:15:08.780

在 c++
苹果乔纳森；在 main 中声明

```
int main()
{
    Apples jonathan;
} 
```

现在你在一个不可能的类中调用对象（jonathan.color）的方法

# python - 向数据存储对象添加动态属性

> ID：14791699
> 
> 赞同：1
> 
> 时间：2013-02-09T21:17:37.090
> 
> 标签：python, google-app-engine, properties

我对 Python 比较陌生，来自 PHP 世界。在 PHP 中，我会例行地获取一行，该行对应于数据库中的对象，比如用户，并在将用户对象传递给我的视图页面之前为其添加属性。例如，用户具有属性 email、name 和 id。我从数据库中获取了 5 个用户，并在一个 for 循环中为用户分配了一个动态属性，比如图像。

这似乎不适用于 for 循环中的 Python/Google App Engine 数据存储模型（我认为它对数据存储模型的作用比 python 更多）。它在 for 循环中工作（这意味着我可以在 for 循环中引用 user.image，但是一旦 for 循环结束，所有对象似乎都不再具有新的属性 image 了。

这是一个代码示例：

```
# Model
Class User(ndb.Model):
   email = ndb.StringProperty()
   name = ndb.StringProperty()

# And then a function that returns a list of users
users = User.get_users()

user_list = []
# For loop 
for user in user:
   # For example, get image
   user.image = Image.get_image(user.key)
   user_list.append(user)

   # If I print or log this user in the for loop, I see a result
   logging.info(user.image) # WORKS!

for ul in user_list:
   print ul.image # Results in None/ATTR Error 
```

谁能向我解释为什么会发生这种情况以及如何实现这一目标？

我已经搜索了表格，但我找不到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:22:14.213

尝试使用[Expando 模型](https://developers.google.com/appengine/docs/python/ndb/entities#expando)

> 有时您不想提前声明您的属性。一个特殊的模型子类 Expando 会更改其实体的行为，以便将分配的任何属性（只要它不以下划线开头）保存到数据存储区。

# android - NETWORK_PROVIDER 在 Galaxy Young 中不起作用？

> ID：14791703
> 
> 赞同：0
> 
> 时间：2013-02-09T21:17:45.230
> 
> 标签：android

我有一个我使用的应用程序`isProviderEnabled(LocationManager.NETWORK_PROVIDER` 但是当我将此应用程序放入 Samsung Galaxy Young 时，即使在“设置”中启用了`false`该选项，它也会始终返回。`Packet Data`

为什么会出错？

这是我的代码的一部分：

```
boolean isNetworkEnabled = false;

    locationManager = (LocationManager) c
            .getSystemService(this.c.LOCATION_SERVICE);

    // getting network status
    isNetworkEnabled = locationManager
            .isProviderEnabled(LocationManager.NETWORK_PROVIDER);

Toast.makeText(c.getApplicationContext(), "Obteniendo network provider = "+isNetworkEnabled, Toast.LENGTH_SHORT).show();

    if (isNetworkEnabled) { 
        Log.i(LOGTAG, "obtiene localizaciones de network provider NET.... ");
        ret = 0;
        LocationManager lm = (LocationManager) c
                .getSystemService(c.LOCATION_SERVICE);
        myloc = null;
        myloc = new mylocationlistener();
        LocationListener locationListener = myloc;
        Log.i(LOGTAG, "myloc.... latitude=" + myloc.getLatitude()
                + " Longitude=" + myloc.getLongitud());
        Toast.makeText(c.getApplicationContext(), "conectandose AGPS...lat = "+myloc.getLatitude()+ " Longitud = "+myloc.getLongitud(), Toast.LENGTH_SHORT).show();
        lm.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0,
                locationListener);                  
    } else {

        ret = -1;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:20:32.580

您确定启用定位服务了吗？您可以通过设置应用程序（在我的 S3 上的个人下）进行配置。

# django - Django - 如何让表单模板运行（获取'命名空间未注册错误'）

> ID：14791705
> 
> 赞同：5
> 
> 时间：2013-02-09T21:17:51.660
> 
> 标签：django, forms, namespaces

我是 Django 的新手。让 Django 1.4.2 在 Windows 7 上与 Python 2.7 一起工作。

我正在学习一个教程，我需要一个带有单选按钮的表单模板。选择一个按钮会发送数据，页面应该会询问您是否要“再次投票？”。此外，如果您没有选择按钮并提交表单，它应该会显示一条消息，要求您做出选择。

到目前为止，这是 HTML 表单：

```
<h1>{{ poll.question }}</h1>

{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

<form action="{% url 'polls:vote' poll.id %}" method="post">
{% csrf_token %}
{% for choice in poll.choice_set.all %}
    <input type="radio" name="choice" id="choice{{ forloop.counter }}" value="{{ choice.id }}" />
    <label for="choice{{ forloop.counter }}">{{ choice.choice_text }}</label><br />
{% endfor %}
<input type="submit" value="Vote" />
</form> 
```

现在，当我键入时，`http://localhost:8000/polls/1/`我应该得到表单，但我得到以下错误消息：

```
NoReverseMatch at /polls/1/
u"'polls" is not a registered namespace 
```

我将 polls 注册为命名空间，请参见下面的项目 urls.py：

```
from django.conf.urls import patterns, include, url
from django.contrib import admin

admin.autodiscover()

urlpatterns = patterns('',
    url(r'^polls/', include('polls.urls', namespace="polls")),
    url(r'^admin/', include(admin.site.urls)),
) 
```

为了回答凯茜的好心请求，这里是投票网址：

```
from django.conf.urls import patterns, url

from polls import views

urlpatterns = patterns('',
    url(r'^$', views.index, name='index'),
    # ex: /polls/5/
    url(r'^(?P<poll_id>\d+)/$', views.detail, name='detail'),
    # ex: /polls/5/results/
    url(r'^(?P<poll_id>\d+)/results/$', views.results, name='results'),
    # ex: /polls/5/vote/
    url(r'^(?P<poll_id>\d+)/vote/$', views.vote, name='vote'),
) 
```

..如果有帮助，我会在下面包含项目文件夹的网址：

```
from django.conf.urls import patterns, include, url
from django.contrib import admin

admin.autodiscover()

urlpatterns = patterns('',
    url(r'^polls/', include('polls.urls', namespace="polls")),
    url(r'^admin/', include(admin.site.urls)),
    # Uncomment the admin/doc line below to enable admin documentation:
    # url(r'^admin/doc/', include('django.contrib.admindocs.urls')),

) 
```

我刚刚注意到浏览器上显示了以下错误消息（因为 Debug = True）：

```
Error during template rendering

In template C:\Python27\Scripts\mysite\mytemplates\polls\index.html, error at line 4

u"'polls" is not a registered namespace
    {% if latest_poll_list %}
        <ul>
        {% for poll in latest_poll_list %}
            <li><a href="{% url 'polls:detail' poll.id %}">{{ poll.question }}</a></li>
        {% endfor %}
        </ul>
    {% else %}
        <p>No polls are available.</p>
    {% endif %} 
```

任何帮助使该表格正常运行将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-11T04:46:16.483

```
urlpatterns = patterns('polls.views',
    url(r'^$', 'index', name='index'),
    url(r'^(?P<poll_id>\d+)/$', 'detail', name='detail'),
    url(r'^(?P<poll_id>\d+)/results/$', 'results', name='results'),
    url(r'^(?P<poll_id>\d+)/vote/$', 'vote', name='vote'),
)

{% url polls:detail poll.id %} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T04:47:05.333

转到您的 settings.py 文件并检查您的模板加载器。您可能需要切换他们的顺序。

正确的顺序应该是：

```
TEMPLATE_LOADERS = (
    'django.template.loaders.filesystem.Loader',
    'django.template.loaders.app_directories.Loader',

) 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T04:34:07.850

尝试放在`{% load url from future %}`html 文件的顶部。它应该可以解决您的问题。

# python - cPickle - 仅当稍后使用未腌制的东西时才会出现错误

> ID：14791708
> 
> 赞同：0
> 
> 时间：2013-02-09T21:18:20.070
> 
> 标签：python, pickle

我现在编写的代码工作正常，我什至可以毫无错误地打印反序列化的对象，所以我确实知道里面有什么。

```
@staticmethod
def receiveData(self):
    '''
    This method has to be static, as it is the argument of a Thread.
    It receives Wrapperobjects from the server (as yet containing only a player)
    and resets the local positions accordingly
    '''

    logging.getLogger(__name__).info("Serverinformationen werden nun empfangen")
    from modules.logic import game
    sock = self.sock
    time.sleep(10)
    self.myPlayer = game.get_player()
    while (True):
        try:
            wrapPacked = sock.recv(4096)
            self.myList = cPickle.loads(wrapPacked)
         #   self.setData(self.myList)             
        except Exception as eload:            
            print eload 
```

但是，如果我尝试实际使用此处注释中的行（self.setData（self.myList），

我明白了

```
unpickling stack underflow 
```

和

```
invalid load key, ' '. 
```

只是为了记录，setData的代码是：

```
def setData(self, list):    
    if (list.__sizeof__()>0):
        first = list [0]
        self.myPlayer.setPos(first[1])
        self.myPlayer.setVelocity(first[2]) 
```

我已经坚持了 3 天了，真的，我不知道出了什么问题。你能帮助我吗？完整追溯：

```
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python2.7/threading.py", line 551, in __bootstrap_inner
    self.run()
  File "/usr/lib/python2.7/threading.py", line 504, in run
    self.__target(*self.__args, **self.__kwargs)
  File "mypath/client.py", line 129, in receiveData
    self.myList = cPickle.loads(wrapPacked)
UnpicklingError: unpickling stack underflow – 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T00:07:51.123

当您尝试访问腌制数据时总是发生异常这一事实似乎表明您正在遇到`cPickle`库中的错误。

可能发生的情况是 C 库忘记处理异常。异常信息被存储，而不是处理，并且一直存在于解释器中，直到发生*另一个*异常或另一段 C 代码*确实*检查异常。此时会抛出旧的未处理异常。

您的错误显然是`cPickle`相关的，它对您提供的数据非常不满意，但是异常本身是在不相关的位置引发的。这*可能*与线程相关，也可能是常规的非线程相关错误。

您需要查看是否可以在测试设置中加载数据。写入`wrapPacked`文件以供以后测试。在解释器 shell 会话中加载该文件，加载它`cPickle.loads()`并查看会发生什么。`pickle`对模块执行相同的操作。

如果您在此测试会话中确实遇到了类似的问题，并且您可以重现它（在会话的稍后时间点抛出奇怪的异常），您需要在 Python 项目中提交一个错误以进行查看。

# tomcat - Heroku Java Tomcat ServletContextListener 没有在 slugc 上调用 contextDestroyed 或重新启动

> ID：14791715
> 
> 赞同：1
> 
> 时间：2013-02-09T21:19:41.810
> 
> 标签：tomcat, servlets, heroku, sigterm

Heroku 使用 SIGTERM 允许进程正常关闭。但是，Tomcat 进程不响应 SIGTERM，并且从不在我的 ServletContextListener 上调用 contextDestroyed。

如何让 Tomcat 使用 Heroku 重新启动或当 Heroku 为我的应用程序进行 slug 编译时调用 contextDestroyed。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T15:57:28.887

你是对的。关闭挂钩未注册以触发 Tomcat 的正常关闭，因此上下文不会在关闭生命周期事件中循环。最新版本的 webapp-runner 解决了这个问题：[https ://github.com/jsimone/webapp-runner/issues/22](https://github.com/jsimone/webapp-runner/issues/22)

# c++ - 好问（不是编译时强制）子类创建者做某些事情吗？

> ID：14791716
> 
> 赞同：0
> 
> 时间：2013-02-09T21:19:48.350
> 
> 标签：c++

要求特定基类的子类程序员做事（没有编译时强制）是否被认为是 C++ 中的好习惯？例如...

> 这个类的正确子类应该做这些事情：
> 
> *   在每次调用重写的虚函数 bar() 结束时正确填充受保护的变量 m_foo - 请参阅上面的注释（此 SO 问题中未显示一些 c++ 注释）
>     
>     
> *   如果满足这些条件： [某些条件] 然后在每次调用被覆盖的虚函数 bar() 时，调用在此基类中实现的非虚函数 baz()。这是为了执行一些所有子类都应该通用的逻辑。

像这样的子类指令是否被认为是可以接受的，或者我没有在编译时强制执行这一事实是否表明我的代码设计存在缺陷？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:30:09.407

您的两种情况听起来都可以通过调用 bar() 的基类包装器来解决，例如：

```
 class base
   {
      public:
        virtual void vbar() = 0;

      protected:
        void bar()
        {
            vbar();
            m_foo = x;
            baz();
        }

        void baz()
        {
             ... do stuff ... 
        }
      private:
        T m_foo;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T21:21:38.033

[*您可以通过使用模板方法模式*](http://en.wikipedia.org/wiki/Template_method_pattern)来强制执行这种事情（派生类的作者不需要做任何事情）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T21:42:36.380

与我一起工作的高级开发人员（我想我们可以称他为架构师）喜欢说“永远不要问，什么时候知道”。

他的意思是，我碰巧非常同意，就是当你的基类可以强制一个子类以你应该的方式做某事时。

出现这种情况：
1）如果一个变量应该总是由派生类初始化（比如类的“名称”），它应该是所有构造函数的必需参数。
2）如果您需要在某事之前/之后执行某种逻辑，请将虚函数包装在一个具体的函数中，以强制之前/之后发生。
3) 如果您发送的是相同类型的 msg，则 msg 的打包应该在基类中，使用纯虚方法从类的实例中提取数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T21:23:51.397

前置条件和后置条件是方法契约的一部分（软件工程而言）。所以不，要求实施者遵守某些规则并不是坏事。只要确保它们被清楚地记录在案。无论如何，这些条件中的大多数都无法在编译时检查（尽管在运行时检查它们并不是一件坏事......）

# process - Erlang进程事件错误

> ID：14791717
> 
> 赞同：1
> 
> 时间：2013-02-09T21:20:02.793
> 
> 标签：process, erlang

我基本上是按照这个网站上的教程[学习一些 Erlang:Designing a concurrent application](http://learnyousomeerlang.com/designing-a-concurrent-application#understanding-the-problem)我尝试使用以下命令运行下面的代码并在第 48 行出错。我确实关闭了我的防火墙以防万一问题，但没有运气。我在 windows xp SP3 上。

9> c（事件）。

{好的，事件}

10> f()。

好的

11> 事件：开始（“事件”，0）。

=错误报告==== 2013 年 2 月 9 日::15:05:07 === 进程 <0.61.0> 出错，退出值：{function_clause,[{event,time_to_go,[0],[{file ,"event.erl"},{line,48}]},{event,init,3,[{file,"event.erl"},{line,31}]}]}

<0.61.0>

12>

```
-module(event).
-export([start/2, start_link/2, cancel/1]).
-export([init/3, loop/1]).
-record(state, {server,
                name="",
                to_go=0}).

%%% Public interface
start(EventName, DateTime) ->
    spawn(?MODULE, init, [self(), EventName, DateTime]).

start_link(EventName, DateTime) ->
    spawn_link(?MODULE, init, [self(), EventName, DateTime]).

cancel(Pid) ->
    %% Monitor in case the process is already dead
    Ref = erlang:monitor(process, Pid),
    Pid ! {self(), Ref, cancel},
    receive
        {Ref, ok} ->
            erlang:demonitor(Ref, [flush]),
            ok;
        {'DOWN', Ref, process, Pid, _Reason} ->
            ok
    end.

%%% Event's innards
init(Server, EventName, DateTime) ->
    loop(#state{server=Server,
                name=EventName,
                to_go=time_to_go(DateTime)}).

%% Loop uses a list for times in order to go around the ~49 days limit
%% on timeouts.
loop(S = #state{server=Server, to_go=[T|Next]}) ->
    receive
        {Server, Ref, cancel} ->
            Server ! {Ref, ok}
    after T*1000 ->
        if Next =:= [] ->
            Server ! {done, S#state.name};
           Next =/= [] ->
            loop(S#state{to_go=Next})
        end
    end.

%%% private functions
time_to_go(TimeOut={{_,_,_}, {_,_,_}}) ->
    Now = calendar:local_time(),
    ToGo = calendar:datetime_to_gregorian_seconds(TimeOut) -
           calendar:datetime_to_gregorian_seconds(Now),
    Secs = if ToGo > 0  -> ToGo;
              ToGo =< 0 -> 0
           end,
    normalize(Secs).

%% Because Erlang is limited to about 49 days (49*24*60*60*1000) in
%% milliseconds, the following function is used
normalize(N) ->
    Limit = 49*24*60*60,
    [N rem Limit | lists:duplicate(N div Limit, Limit)]. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T02:46:11.573

它纯粹在您的机器上本地运行，因此防火墙不会影响它。

问题是您在开始时给出的第二个参数`event:start("Event",0).`

错误原因：

```
{function_clause,[{event,time_to_go,[0],[{file,"event.erl"},{line,48}]},{event,init,3,[{file,"event.erl"},{line,31}]}]} 
```

表示这是一个`function_clause`错误，这意味着函数定义中没有与参数匹配的子句。它还告诉您，是第`event:time_to_go/1`48 行的函数失败了，并且使用参数调用了它`0`。

如果您查看该函数`time_to_go/`，您将看到它希望其参数是 2 个元素的元组，其中每个元素是 3 个元素的元组：

```
time_to_go(TimeOut={{_,_,_}, {_,_,_}}) -> 
```

这个论点的结构是`{{Year,Month,Day},{Hour,Minute,Second}}`。如果您向后遵循此参数，则从`time_to_go/`,`init/3`的参数调用的位置是 的第三个参数。现在差不多了。现在是进程产生的函数（和 start_link/2 init/3 start/2`.`time_to_go/1``DateTime``init/3``init/3``start/2``) and the 3rd argument to``is the second argument to`

因此，当您调用`event:start("Event",0).`它时，`0`这里将传递给`time_to_go/1`新进程中的调用函数。而且格式不对。你应该用类似的东西来调用它`event:start("Event", {{2013,3,24},{17,53,62}}).`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T13:36:12.043

要为 rvirding 的答案添加背景，您会收到错误消息，因为据我所知，该示例一直有效，直到最终代码片段。该`normalize`函数首先使用，它处理问题。然后在上面问题中的示例之后的段落中，文字说：

> 它有效！事件模块的最后一件烦人的事情是我们必须输入以秒为单位的剩余时间。`{{Year, Month, Day}, {Hour, Minute, Second}}`如果我们可以使用标准格式，例如 Erlang 的 datetime ( ) ，那就更好了。只需添加以下函数，该函数将计算您计算机上的当前时间与您插入的延迟之间的差异：

下一个片段介绍了只需要一个日期/时间并将其更改为最后剩余时间的代码位。

我无法轻松链接到该文件的所有过渡版本，这就是为什么在这种情况下直接使用示例尝试链接文件并不容易。如果代码是一步一步地按照代码片段进行的，那么一切都应该可以正常工作。对困惑感到抱歉。

# cocoa - 在 MonoTouch 中绘制带有色调的图像

> ID：14791719
> 
> 赞同：0
> 
> 时间：2013-02-09T21:20:09.190
> 
> 标签：cocoa, xamarin.ios

我需要阅读什么才能用预定义的颜色为我绘制的图像着色。或者只是调整 alpha 值？我玩过 BlendMode，但我基本上不知道我在做什么。:)

下面的简化代码

```
_backgroundImage = UIImage.FromFile ("whiteblock.png"); 

var ctx = UIGraphics.GetCurrentContext ();

// What do I do here to tint or adjust alpha of the image       
ctx.DrawImage (rect, _backgroundImage.CGImage); 
```

谢谢

安克曼宁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T05:39:27.973

我建议从[Core Image Filter](https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CoreImageFilterReference/Reference/reference.html)参考文档开始（另请参阅**[CIFilter](http://developer.apple.com/library/ios/#Documentation/GraphicsImaging/Reference/QuartzCoreFramework/Classes/CIFilter_Class/Reference/Reference.html)**）。
（请注意，根据操作系统的版本，并非所有过滤器都可用。）

您可能希望专注于 CICategoryColorAdjustment 类别中的过滤器。具体来说，**CITemperatureAndTint**过滤器可以根据您的要求调整图像的色调。但是，使用起来并不简单。* StackOverflow 上还有其他问题对其进行了描述，例如：[CITemperatureAndTint (CIFilter) 的输入参数](https://stackoverflow.com/questions/8629411/input-parameters-of-citemperatureandtint-cifilter)

最后查看 MonoTouch 文档以获取带有[CITemperatureAndTint](http://docs.go-mono.com/index.aspx?link=C:MonoTouch.CoreImage.CITemperatureAndTint)的代码示例。（我认为附在示例中的图像是错误的，因为它们显示的是缩放图像，而不是着色图像。）

*它需要两个参数，每个参数都是一个 2D CIVector。我相信向量的第一个分量是温度，应该在（1k ... 30k）的范围内。我相信第二个分量是波长，所以在（380 ... 700）的范围内。如果有人知道更好，请纠正我。

# php - PHP 代码不会将表单输入保存在 .csv 文件中

> ID：14791720
> 
> 赞同：0
> 
> 时间：2013-02-09T21:20:13.173
> 
> 标签：php, csv

我正在尝试将一些变量保存在在线的 .csv 文件中，但它不起作用。我尝试自己创建文件并运行代码，并让代码在运行时创建文件。但是，在这两种情况下它都不起作用

```
<html>
<body>
<?php

    $name = $_POST['name'];
    $gender = $_POST['gender'];
    $nationality = $_POST['nationality'];

    if($nationality == "Other")
    $nationality = $_POST['otherNationality'];

    $job = $_POST['job'];
    $country = $_POST['country'];
    $years = $_POST['years'];

    $fh = fopen("results.csv", "a");
    $personalInfo = $name. ", " . $gender . ", " . $nationality . ", " . $job . ", " . $country . ", " .  $years; 

if($fh){
        fwrite($fh, $personalInfo);
        fclose($fh);
    } 
```

?>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:33:58.467

在 csv 写入方面似乎没有任何问题 - 只要表单字段被初始化。

您要确保您有权写入该文件
_如果这是Windows，请创建文件并授予所有人写入权限
_如果这是Linux：

```
touch results.csv;  
chmod 777 results.csv 
```

或者，尝试从命令行 php csvscript.php 执行它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T09:29:49.063

正如我所说，这是一个权限问题，由于您无权访问 CLI，您可以使用以下命令

```
$name = $_POST['name'];
$gender = $_POST['gender'];
$nationality = $_POST['nationality'];

if($nationality == "Other")
$nationality = $_POST['otherNationality'];

$job = $_POST['job'];
$country = $_POST['country'];
$years = $_POST['years'];

$opr = chmod ( "results.csv" , 0755 ); 
if($opr)
{
$fh = fopen("results.csv", "a");
$personalInfo = $name. ", " . $gender . ", " . $nationality . ", " . $job . ", " . $country . ", " .  $years; 

 if($fh){
    fwrite($fh, $personalInfo);
    fclose($fh);
}

}
else 
{
     echo "Not able to change the permission :( "; 
} 
```

我希望这有帮助

# python - 加速 NumPy 的 where 函数

> ID：14791724
> 
> 赞同：5
> 
> 时间：2013-02-09T21:20:40.003
> 
> 标签：python, performance, numpy, scientific-computing

我正在尝试提取超过某个阈值的一维数字数组的所有值的索引。该数组是`1e9`长的顺序。

我的方法如下`NumPy`：

```
idxs = where(data>threshold) 
```

这需要 20 分钟以上的时间，这是不可接受的。我怎样才能加快这个功能？或者，有更快的替代方案吗？

（具体来说，在运行 10.6.7、1.86 GHz Intel、4GB RAM 的 Mac OS X 上需要很长时间。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T21:41:30.120

尝试一个[掩码数组](http://docs.scipy.org/doc/numpy/user/basics.indexing.html#boolean-or-mask-index-arrays)。这将创建相同数据的视图。

所以语法是：

```
 b=a[a>threshold] 
```

b 不是一个新数组（与 where 不同），而是 a 的视图，其中元素与索引中的布尔值相遇。

例子：

```
import numpy as np
import time

a=np.random.random_sample(int(1e9))

t1=time.time()
b=a[a>0.5]
print(time.time()-t1,'seconds') 
```

在我的机器上，打印`22.389815092086792 seconds`

* * *

*编辑*

我对 np.where 进行了同样的尝试，并且速度一样快。我很怀疑：你是从数组中删除这些值吗？

# c - 如何访问指向在另一个结构中声明的结构的指针？

> ID：14791729
> 
> 赞同：-1
> 
> 时间：2013-02-09T21:21:14.203
> 
> 标签：c, pointers, structure

我的代码是这样的：

```
struct a{
           ....
           ....
           };
    struct a c[MAXNODES];

    struct b{
           int k;
           struct a *p;
           };
    struct b d[MAXNODES]; 
```

所以，如果我需要访问指向`struct a`in的指针，`struct b`我应该使用间接运算符还是不使用。

```
some_variable=*(d.[i-1].p); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:35:07.797

因此，您有 2 个结构，其中一个保存指向另一个实例的指针：

```
typedef struct a {
    int i;
} A;

typedef struct b {
    A *pA;
} B; 
```

然后在某个地方，您有一个结构数组，其中包含以下实例`struct a`：

```
A arr[10];

B b;
b.pA = &arr[0]; // makes b.pA to point to the address of first element of arr
b.pA->i = 2;    // equivalent to (*b.pA).i = 2;

A a = *b.pA;    // creates a copy of an element that b.pA points to
A* pA = b.pA;   // stores the reference (copies the pointer) 
```

# google-apps-script - 为什么第一次出现的处理程序调用返回一个未定义的值作为参数

> ID：14791731
> 
> 赞同：0
> 
> 时间：2013-02-09T21:21:20.487
> 
> 标签：google-apps-script

我一直在玩这个小测试代码——我承认——它不是很有用，但我注意到`callBackElement`当第一次调用这个处理程序时，第一个处理程序中返回的值是未定义的。

我不知道为什么......所以我添加了一个解决问题的条件，但我仍然想了解为什么它会这样工作......

该脚本来自[今天早些时候这篇文章](https://stackoverflow.com/questions/14785576/call-function-after-uiapp-is-loaded-javascript-onload-equivalent)中显示的一个想法，我评论了导致下面脚本中错误的行（它有点长，对此感到抱歉）并作为一种计时器/计数器运行以说明触发的能力以编程方式使用复选框的处理程序。

如果有人可以解释为什么这个条件是必要的？

```
 var nn=0;
    //
    function doGet() {
      var app = UiApp.createApplication().setHeight('120').setWidth('200').setTitle('Timer/counter test');
      var Panel = app.createVerticalPanel()
      var label = app.createLabel('Initial display')
                     .setId('statusLabel')
      app.add(label);
      var counter = app.createTextBox().setName('counter').setId('counter').setValue('0')
      var handler1 = app.createServerHandler('loadData1').addCallbackElement(Panel);
      var handler2 = app.createServerHandler('loadData2').addCallbackElement(Panel);
      var chk1 = app.createCheckBox('test1').addValueChangeHandler(handler1).setVisible(true).setValue(true,true).setId('chk1');
      var chk2 = app.createCheckBox('test2').addValueChangeHandler(handler2).setVisible(true).setValue(false,false).setId('chk2');
      app.add(Panel.add(chk1).add(chk2).add(counter));
      SpreadsheetApp.getActive().show(app)
    }

    function loadData1(e) {
      var app = UiApp.getActiveApplication();
      var xx = e.parameter.counter
//*******************************************************
      if(xx){nn = Number(xx)}; // here is the question
    //  nn = Number(xx);       // if I use this line the first occurence = undefined
      nn++
      var cnt = app.getElementById('counter').setValue(nn)
      Utilities.sleep(500);
      var chk1 = app.getElementById('chk1').setValue(false,false)
      var chk2 = app.getElementById('chk2').setValue(true,true)
      var label = app.getElementById('statusLabel');
      label.setText("Handler 1 :-(");

      return app;
    }

    function loadData2(e) {
      var app = UiApp.getActiveApplication();
      var xx = Number(e.parameter.counter)
      xx++
      var cnt = app.getElementById('counter').setValue(xx)
      Utilities.sleep(500); 
      var chk1 = app.getElementById('chk1').setValue(true,true)
      var chk2 = app.getElementById('chk2').setValue(false,false)
      var label = app.getElementById('statusLabel');
      label.setText("Handler 2 ;-)");

      return app;
    } 
```

该应用程序如下所示：

![在此处输入图像描述](../Images/fa9b78ba69c9b5461e3b5df36d01e647.png)

并且[可以在这里测试](https://script.google.com/macros/s/AKfycbwm-LMtqr_PcZHKJBksKVDc8pFoPUVkfRxjd5D9u0YHLCHaeq4f/exec)

**编辑：**工作解决方案是在将小部件添加到面板后触发处理程序（参见菲尔的回答），如下所示：

```
 var chk1 = app.createCheckBox('test1').addValueChangeHandler(handler1).setVisible(true).setId('chk1');
  var chk2 = app.createCheckBox('test2').addValueChangeHandler(handler2).setVisible(true).setId('chk2');
  app.add(Panel.add(chk1).add(chk2).add(counter));
  chk1.setValue(true,true);
  chk2.setValue(false,false);
  return app 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T03:12:47.553

您为该处理程序 ( `Panel`) 指定的回调元素在调用时没有任何元素。因此，您实际上是将一个空面板传递给该处理程序。因此，由于`chk1`尚未将其添加到面板中，因此它的值不会作为参数添加到处理程序中。

调用`chk1.setValue(true,true)` *后*放`Panel.add(chk1)`.

如[本例所示](http://pastebin.com/QxF6xmUe)，处理程序在被调用时*排队。*`setValue(true,true)`这意味着将收集所有将传递给处理程序的参数。它查看回调元素，读取它们的值，然后**继续执行`doGet`**. 完成后`doGet`，处理程序被执行。

# c# - 有没有办法可以将两个单独的迭代器块合并为一个？

> ID：14791735
> 
> 赞同：2
> 
> 时间：2013-02-09T21:21:37.720
> 
> 标签：c#, iterator, refactoring, ienumerable, yield-return

我几乎知道这是不可能和毫无意义的，但只是想学习..我有：

```
public IEnumerable<IEnumerable<object>> GetMany()
{
    while (someCondition)
        yield return GetFew();
}

static IEnumerable<object> GetFew()
{
    while (someOtherCondition)
        yield return new object();
} 
```

我可以将两者结合起来形成一种方法吗？两个不同的迭代器块可以存在于一种方法中吗？

**编辑：**我不是在问如何解决我手头的问题。我正在尝试学习新东西，所以更大的问题是“有一种方法可以使两个单独的块在一个功能中工作”？我问是因为 C# 中有匿名类型和闭包，您可以在方法本身内部定义一些新的东西，而无需命名类型或方法。同样适用于块？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T21:42:09.857

简而言之，不，您不能`yield`在同一方法中嵌套迭代器。

`yield`在方法级别编译。每次您这样做时`yield return`，它都会退出该方法，然后从停止的地方继续。这意味着如果您嵌套`yield`语句，它们仍将在方法级别而不是块级别运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T23:07:21.400

您要的是匿名迭代器块。Eric Lippert[不久前就该主题发表了博客](http://blogs.msdn.com/b/ericlippert/archive/2009/08/24/iterator-blocks-part-seven-why-no-anonymous-iterators.aspx)。简而言之，他说这将是一个很棒的功能，他很想看到，但是要真正实现这样的功能非常困难，所以到目前为止还没有添加到语言中（将来添加它是不太可能）。

# javascript - 堆积面积图 SVG 路径 d=NaNNaNNaN

> ID：14791739
> 
> 赞同：1
> 
> 时间：2013-02-09T21:22:06.217
> 
> 标签：javascript, d3.js

现场示例：[http ://bl.ocks.org/4747134/a702cf79bf10b1438cc665a2438b3f5cf9ab8bf0](http://bl.ocks.org/4747134/a702cf79bf10b1438cc665a2438b3f5cf9ab8bf0)

代码：

```
var raw_series = [{"note": "TEXAS LONGHORN", "date": "2013-01-10T00:00:00", "amount": 110.0, "id": 74, "account_id": 1}, {"note": "GOOGLE *FEO Medi", "date": "2013-01-10T00:00:00", "amount": 22.0, "id": 73, "account_id": 1}, {"note": "Pressbyran 5122", "date": "2013-01-10T00:00:00", "amount": 13.0, "id": 77, "account_id": 1}, {"note": "ICA SUPERMARKET", "date": "2013-01-10T00:00:00", "amount": 106.0, "id": 76, "account_id": 1}, {"note": "H\u00c5R 3000", "date": "2013-01-10T00:00:00", "amount": 345.0, "id": 75, "account_id": 1}, {"note": "Pressbyran 5122", "date": "2013-01-11T00:00:00", "amount": 19.0, "id": 72, "account_id": 1}, {"note": "BIRKA PUNKTEN", "date": "2013-01-11T00:00:00", "amount": 79.0, "id": 71, "account_id": 1}, {"note": "DROPBOX", "date": "2013-01-11T00:00:00", "amount": 67.0, "id": 70, "account_id": 1}, {"note": "KAFFESTUGAN", "date": "2013-01-11T00:00:00", "amount": 165.0, "id": 69, "account_id": 1}, {"note": "BIRKA PUNKTEN", "date": "2013-01-12T00:00:00", "amount": 79.0, "id": 67, "account_id": 1}, {"note": "GOOGLE *Chozabu", "date": "2013-01-13T00:00:00", "amount": 15.0, "id": 63, "account_id": 1}, {"note": "VIDEO RULLEN", "date": "2013-01-13T00:00:00", "amount": 171.0, "id": 66, "account_id": 1}, {"note": "\u00c5SGATAN 2 K\u00d6K &", "date": "2013-01-13T00:00:00", "amount": 224.0, "id": 65, "account_id": 1}, {"note": "ICA SUPERMARKET", "date": "2013-01-13T00:00:00", "amount": 209.0, "id": 64, "account_id": 1}, {"note": "GOOGLE *Camel Ga", "date": "2013-01-13T00:00:00", "amount": 7.0, "id": 62, "account_id": 1}, {"note": "THE RACKSPACE CL", "date": "2013-01-16T00:00:00", "amount": 252.0, "id": 59, "account_id": 1}, {"note": "Pressbyran 8535", "date": "2013-01-16T00:00:00", "amount": 33.0, "id": 61, "account_id": 1}, {"note": "BIRKA PUNKTEN", "date": "2013-01-16T00:00:00", "amount": 79.0, "id": 60, "account_id": 1}, {"note": "KAFFESTUGAN", "date": "2013-01-16T00:00:00", "amount": 75.0, "id": 58, "account_id": 1}, {"note": "ICA SUPERMARKET", "date": "2013-01-18T00:00:00", "amount": 80.0, "id": 56, "account_id": 1}, {"note": "STATION", "date": "2013-01-18T00:00:00", "amount": 89.0, "id": 55, "account_id": 1}, {"note": "FREE SOFTWARE FO", "date": "2013-01-19T00:00:00", "amount": 132.0, "id": 52, "account_id": 1}, {"note": "\u00d6verf\u00f6ring 100/m\u00e5n", "date": "2013-01-19T00:00:00", "amount": 100.0, "id": 53, "account_id": 1}, {"note": "ICA SUPERMARKET", "date": "2013-01-19T00:00:00", "amount": 321.0, "id": 51, "account_id": 1}, {"note": "VIDEO RULLEN", "date": "2013-01-21T00:00:00", "amount": 179.0, "id": 46, "account_id": 1}, {"note": "Automatuttag", "date": "2013-01-21T00:00:00", "amount": 300.0, "id": 49, "account_id": 1}, {"note": "\u00c5SGATAN 2 K\u00d6K &", "date": "2013-01-21T00:00:00", "amount": 26.0, "id": 48, "account_id": 1}, {"note": "ICA SUPERMARKET", "date": "2013-01-21T00:00:00", "amount": 174.0, "id": 47, "account_id": 1}, {"note": "MSFT   *XBOX LIV", "date": "2013-01-22T00:00:00", "amount": 69.0, "id": 45, "account_id": 1}, {"note": "ICA SUPERMARKET", "date": "2013-01-23T00:00:00", "amount": 293.0, "id": 43, "account_id": 1}, {"note": "PIZZERIA CUOCO P", "date": "2013-01-23T00:00:00", "amount": 140.0, "id": 42, "account_id": 1}, {"note": "ICA SUPERMARKET", "date": "2013-01-24T00:00:00", "amount": 283.0, "id": 41, "account_id": 1}, {"note": "HOTELL NORRTULL", "date": "2013-01-25T00:00:00", "amount": 98.0, "id": 38, "account_id": 1}, {"note": "MAT P\u00c5 JOBB", "date": "2013-01-25T00:00:00", "amount": 80.0, "id": 39, "account_id": 1}, {"note": "\u00d6verf\u00f6ring LOVA/peng", "date": "2013-01-26T00:00:00", "amount": 9000.0, "id": 37, "account_id": 1}, {"note": "Pressbyran 5122", "date": "2013-01-26T00:00:00", "amount": 18.0, "id": 33, "account_id": 1}, {"note": "ICA SUPERMARKET", "date": "2013-01-26T00:00:00", "amount": 373.0, "id": 34, "account_id": 1}, {"note": "J\u00c4RNA W\u00c4RDSHUS", "date": "2013-01-26T00:00:00", "amount": 60.0, "id": 35, "account_id": 1}, {"note": "GETSENTRY LLC", "date": "2013-01-26T00:00:00", "amount": 59.0, "id": 36, "account_id": 1}, {"note": "ICA SUPERMARKET", "date": "2013-01-27T00:00:00", "amount": 556.0, "id": 31, "account_id": 1}, {"note": "WWW.NETFLIX.COM", "date": "2013-01-27T00:00:00", "amount": 79.0, "id": 30, "account_id": 1}, {"note": "DIREKTEN GOTTCEN", "date": "2013-01-27T00:00:00", "amount": 175.0, "id": 32, "account_id": 1}, {"note": "\u00c5SGATAN 2 K\u00d6K &", "date": "2013-01-28T00:00:00", "amount": 154.0, "id": 27, "account_id": 1}, {"note": "HYRESG\u00c4STF\u00d6R", "date": "2013-01-28T00:00:00", "amount": 80.0, "id": 26, "account_id": 1}, {"note": "Automatuttag", "date": "2013-01-28T00:00:00", "amount": 800.0, "id": 25, "account_id": 1}, {"note": "REST KINA MUREN", "date": "2013-01-28T00:00:00", "amount": 428.0, "id": 24, "account_id": 1}, {"note": "KOLINGSBORG", "date": "2013-01-28T00:00:00", "amount": 200.0, "id": 23, "account_id": 1}, {"note": "KOLINGSBORG", "date": "2013-01-28T00:00:00", "amount": 105.0, "id": 22, "account_id": 1}, {"note": "ICA SUPERMARKET", "date": "2013-01-28T00:00:00", "amount": 199.0, "id": 21, "account_id": 1}, {"note": "SPOTIFY PREMIUM", "date": "2013-01-28T00:00:00", "amount": 99.0, "id": 19, "account_id": 1}, {"note": "7-Eleven 16110 G", "date": "2013-01-28T00:00:00", "amount": 136.0, "id": 20, "account_id": 1}, {"note": "\u00d6verf\u00f6ring Spar, 3k", "date": "2013-01-28T00:00:00", "amount": 3000.0, "id": 29, "account_id": 1}, {"note": "\u00c5SGATAN 2 K\u00d6K &", "date": "2013-01-28T00:00:00", "amount": 235.0, "id": 28, "account_id": 1}, {"note": "FREE SOFTWARE FO", "date": "2013-01-30T00:00:00", "amount": 65.0, "id": 17, "account_id": 1}, {"note": "PAYPAL *SQUAD-KS", "date": "2013-01-30T00:00:00", "amount": 154.0, "id": 18, "account_id": 1}, {"note": "SJ REGIONAL STOC", "date": "2013-01-31T00:00:00", "amount": 56.0, "id": 16, "account_id": 1}, {"note": "CIAO CIAO QUATTR", "date": "2013-02-01T00:00:00", "amount": 220.0, "id": 13, "account_id": 1}, {"note": "ICA SUPERMARKET", "date": "2013-02-01T00:00:00", "amount": 50.0, "id": 15, "account_id": 1}, {"note": "APOTEKET DRAKEN", "date": "2013-02-01T00:00:00", "amount": 48.0, "id": 14, "account_id": 1}, {"note": "GRET INDIAN REST", "date": "2013-02-01T00:00:00", "amount": 85.0, "id": 12, "account_id": 1}, {"note": "LINODE.COM", "date": "2013-02-02T00:00:00", "amount": 613.0, "id": 11, "account_id": 1}, {"note": "ICA SUPERMARKET", "date": "2013-02-03T00:00:00", "amount": 110.0, "id": 10, "account_id": 1}, {"note": "ICA SUPERMARKET", "date": "2013-02-04T00:00:00", "amount": 196.0, "id": 9, "account_id": 1}, {"note": "VIDEO RULLEN", "date": "2013-02-04T00:00:00", "amount": 169.0, "id": 8, "account_id": 1}, {"note": "OLEARYS 917", "date": "2013-02-06T00:00:00", "amount": 309.0, "id": 4, "account_id": 1}, {"note": "GRET INDIAN REST", "date": "2013-02-06T00:00:00", "amount": 85.0, "id": 6, "account_id": 1}, {"note": "TAXI STOCKHOLM", "date": "2013-02-06T00:00:00", "amount": 875.0, "id": 5, "account_id": 1}, {"note": "BURGER KING ODEN", "date": "2013-02-06T00:00:00", "amount": 89.0, "id": 3, "account_id": 1}, {"note": "\u00c5SGATAN 2 K\u00d6K &", "date": "2013-02-07T00:00:00", "amount": 226.0, "id": 2, "account_id": 1}, {"note": "Loopia AB", "date": "2013-02-07T00:00:00", "amount": 178.0, "id": 1, "account_id": 1}];

var margin = {top: 20, right: 30, bottom: 30, left: 40},
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

var format = d3.time.format('%Y-%m-%dT%H:%M:%S')

raw_series.forEach(function (d) { d.date = format.parse(d.date); })

var x = d3.time.scale()
        .range([0, width]);

var y = d3.scale.linear()
        .range([height, 0]);

var z = d3.scale.category20c();

var xAxis = d3.svg.axis()
    .scale(x)
    .orient('bottom')
    .ticks(d3.time.days)

var yAxis = d3.svg.axis()
    .scale(y)
    .orient('left');

var stack = d3.layout.stack()
    .offset('zero')
    .values(function (d) { return d.values; })
    .x(function (d) { return d.date; })
    .y(function (d) { return d.amount; });

var nest = d3.nest()
    .key(function (d) { return d.note })
    .key(function (d) { return d.date })

var area = d3.svg.area()
        .interpolate('monotone')
        .x(function (d) { return x(d.date); })
        .y0(function (d) { return y(d.y0); })
        .y1(function (d) { return y(d.y0 + d.y); });

var svg = d3.select('#chart').append('svg')
    .attr('width', width + margin.left + margin.right)
    .attr('height', height + margin.top + margin.bottom)
  .append('g')
    .attr('transform', 'translate(' + margin.left + ', ' + margin.top + ')');

var layers = stack(nest.entries(raw_series));

x.domain(d3.extent(raw_series, function (d) { return d.date; }));
y.domain([0, d3.max(raw_series, function (d) { d.y0 + d.y; })]);

svg.selectAll(".layer")
    .data(layers)

  .enter().append("path")
    .attr("class", "layer")
    .attr("d", function(d) { return area(d.values); })
    .style("fill", function(d, i) { return z(i); });

svg.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0," + height + ")")
    .call(xAxis);

svg.append("g")
    .attr("class", "y axis")
    .call(yAxis); 
```

输出：

```
<g transform="translate(40, 20)">
  <path class="layer" d="MNaN,NaNLNaN,450Z" style="fill: #3182bd;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #6baed6;"/>
  <path class="layer" d="MNaN,NaNCNaN,NaN,NaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNLNaN,NaNCNaN,NaN,NaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNZ" style="fill: #9ecae1;"/>
  <path class="layer" d="MNaN,NaNCNaN,NaN,NaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNLNaN,NaNCNaN,NaN,NaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNZ" style="fill: #c6dbef;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #e6550d;"/>
  <path class="layer" d="MNaN,NaNCNaN,NaN,NaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNLNaN,NaNCNaN,NaN,NaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNZ" style="fill: #fd8d3c;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #fdae6b;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNZ" style="fill: #fdd0a2;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #31a354;"/>
  <path class="layer" d="MNaN,NaNCNaN,NaN,NaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNLNaN,NaNCNaN,NaN,NaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNZ" style="fill: #74c476;"/>
  <path class="layer" d="MNaN,NaNCNaN,NaN,NaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNLNaN,NaNCNaN,NaN,NaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNSNaN,NaN,NaN,NaNZ" style="fill: #a1d99b;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #c7e9c0;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #756bb1;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #9e9ac8;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #bcbddc;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNZ" style="fill: #dadaeb;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #636363;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNZ" style="fill: #969696;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #bdbdbd;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #d9d9d9;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #3182bd;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #6baed6;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #9ecae1;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #c6dbef;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #e6550d;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #fd8d3c;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #fdae6b;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #fdd0a2;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #31a354;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #74c476;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #a1d99b;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #c7e9c0;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #756bb1;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #9e9ac8;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #bcbddc;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #dadaeb;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #636363;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNZ" style="fill: #969696;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #bdbdbd;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #d9d9d9;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #3182bd;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #6baed6;"/>
  <path class="layer" d="MNaN,NaNLNaN,NaNZ" style="fill: #9ecae1;"/>
  <g class="x axis" transform="translate(0,450)">
    <g class="tick major" style="opacity: 1;" transform="translate(0,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Thu 10
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(31.785714285714285,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Fri 11
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(63.57142857142857,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Sat 12
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(95.35714285714286,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Jan 13
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(127.14285714285714,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Mon 14
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(158.92857142857144,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Tue 15
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(190.71428571428572,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Wed 16
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(222.5,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Thu 17
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(254.28571428571428,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Fri 18
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(286.0714285714286,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Sat 19
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(317.8571428571429,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Jan 20
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(349.6428571428571,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Mon 21
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(381.42857142857144,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Tue 22
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(413.2142857142857,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Wed 23
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(445,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Thu 24
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(476.7857142857143,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Fri 25
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(508.57142857142856,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Sat 26
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(540.3571428571429,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Jan 27
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(572.1428571428572,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Mon 28
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(603.9285714285714,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Tue 29
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(635.7142857142858,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Wed 30
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(667.5,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Thu 31
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(699.2857142857142,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        February
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(731.0714285714287,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Sat 02
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(762.8571428571429,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Feb 03
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(794.6428571428572,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Mon 04
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(826.4285714285714,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Tue 05
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(858.2142857142858,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Wed 06
      </text>
    </g>
    <g class="tick major" style="opacity: 1;" transform="translate(890,0)">
      <line x2="0" y2="6"/>
      <text dy=".71em" style="text-anchor: middle;" x="0" y="9">
        Thu 07
      </text>
    </g>
    <path class="domain" d="M0,6V0H890V6"/>
  </g>
  <g class="y axis">
    <path class="domain" d="M-6,0H0V450H-6"/>
  </g>
</g> 
```

我一直在研究这个特殊的堆积面积图。我对 d3 还很陌生，所以我需要一些关于在哪里放置什么的指针，以便 d3 获得正确的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:04:10.680

输入数据不正确：

> 请注意，每个系列的每个系列必须具有相同数量的值，并且每个值必须具有相同的 x 坐标；如果每个系列的数据缺失或 x 坐标不一致，则必须在计算堆叠布局之前重新采样和插值数据。
> — [https://github.com/mbostock/d3/wiki/SVG-Shapes#wiki-area](https://github.com/mbostock/d3/wiki/SVG-Shapes#wiki-area)

# jquery - jquery each('.someclass') 可见计数

> ID：14791740
> 
> 赞同：0
> 
> 时间：2013-02-09T21:22:09.080
> 
> 标签：jquery, count, each, visible

作为 jQuery 新手，我有一个简单的问题：

给定一组缩略图，共享同一个类，有些是可见的，有些是不可见的。

计算共享同一类和 is(':visible') 的元素数量的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T21:22:48.913

不需要循环，你可以这样做：

```
var visible_images = $('.myClass:visible').length; 
```

或者

```
var visible_images = $('.myClass').filter(':visible').length; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T21:24:33.277

```
$('.myclass:visible').length 
```

伪类选择器可以用作元素/类/id 选择器字符串的一部分

# c# - 在实体框架中重新选择已更改但未保存的项目

> ID：14791745
> 
> 赞同：0
> 
> 时间：2013-02-09T21:22:17.520
> 
> 标签：c#, .net, entity-framework, .net-4.5

```
 TestEntities context = new TestEntities();

        var item = context.TestTables.Single(s => s.ID == 1);//item.Name is "Giorgi"

        item.Name = "Hello";

        var item1 = context.TestTables.Single(s => s.ID == 1);

        Console.WriteLine(item1.Name);

        context.SaveChanges(); 
```

你希望写什么？你好写！**为什么？**

```
 TestEntities context = new TestEntities();

        var item = context.TestTables.Single(s => s.ID == 1);//item.Name is "Giorgi"

        item.Name = "Hello";

        var item1 = context.TestTables.Single(s => s.ID == 1);

        context.SaveChanges();

        Console.WriteLine(item1.Name); 
```

你希望写什么？你好写！**为什么？** * *有两个不同的问题**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:44:00.483

您的更改会在上下文中注册，但在调用 SaveChanges 之前不会保存到数据库中。如果您需要原始值，您可以打开一个新上下文、[重新加载实体](http://msdn.microsoft.com/en-us/library/system.data.entity.infrastructure.dbentityentry.reload%28v=vs.103%29.aspx)或检查更改跟踪器是否有更改。

添加了测试：

```
[Fact]
public void TestUsingNewContext()
{
    using (var context = new TestEntities())
    {
        var item = context.TestTables.Single(s => s.ID == 1);
        item.Name = "Hello";

        using (var newContext = new TestEntities())
        {
            var item1 = newContext.TestTables.Single(s => s.ID == 1);

            Assert.Equal("Giorgi", item1.Name);
        }
    }
}

[Fact]
public void TestUsingReload()
{
    using (var context = new TestEntities())
    {
        var item = context.TestTables.Single(s => s.ID == 1);
        item.Name = "Hello";

        context.Entry(item).Reload();

        var item1 = context.TestTables.Single(s => s.ID == 1);

        Assert.Equal("Giorgi", item1.Name);
    }
}

[Fact]
public void TestUsingChangeTracker()
{
    using (var context = new TestEntities())
    {
        var item = context.TestTables.Single(s => s.ID == 1);
        item.Name = "Hello";

        foreach (var entry in context.ChangeTracker.Entries<TestTable>().Where(e => e.State == EntityState.Modified))
        {
            entry.CurrentValues.SetValues(entry.OriginalValues);
        }

        var item1 = context.TestTables.Single(s => s.ID == 1);

        Assert.Equal("Giorgi", item1.Name);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:38:37.933

在这两种情况下，item 和 item1 都与上下文中的相同实体链接。EntityFramework 为您在上下文中存储实体。我想当您再次选择它时，它会返回缓存副本。当您在上下文中更改某些实体时，使用此上下文的任何人都会看到这种变化。更改仅在提交后才进入数据库。

```
using(TestEntities context = new TestEntities())
{
       var item = context.TestTables.Single(s => s.ID == 1);//item.Name is "Giorgi"

       item.Name = "Hello";

       using(TestEntities context = new TestEntities())
       {
           var item1 = context.TestTables.Single(s => s.ID == 1);
           Console.WriteLine(item1.Name); // you will get old value here
       }
} 
```

尝试在 msdn 中阅读有关它的信息。因为这里水下有很多石头。例如：如果有人更改了您在 db 中的实体，然后您尝试提交更改，将会发生什么？

[http://msdn.microsoft.com/en-us/data/ee712907](http://msdn.microsoft.com/en-us/data/ee712907) [http://msdn.microsoft.com/en-us/data/jj592904.aspx](http://msdn.microsoft.com/en-us/data/jj592904.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T21:48:19.580

“上下文”存在于内存中，因此当您在上下文中更改内容时，它们不会在数据库中更改，而是在“上下文”（内存）中更改，只有当您调用 context.SaveChanges() 时，您才会真正持久化更新/更改数据库。

如果不实际保存更改，为什么需要 SaveChanges() ..

# jquery - 多个ajax调用不能异步工作

> ID：14791747
> 
> 赞同：3
> 
> 时间：2013-02-09T21:22:29.440
> 
> 标签：jquery, webmethod

我已经在页面上创建了 webMethod，这些方法将在客户端使用 $.ajax() 调用。第一个 Webmethod 正在处理耗时的任务。任务需要 8 分钟以上才能完成。在对第一个方法进行 ajax 调用后，我立即调用另一个 Web 方法，该方法在一秒或 2 内完成。所以我应该立即从第二个 WebMethod ajax 调用中获得响应。但是在这里，在这种情况下，第二个 Web 方法直到第一次调用完成才执行。下面的示例模拟我的场景。

```
[WebMethod]
public static string PullData(int snapshotId)
{
    string str = "Pull Started: " + DateTime.Now.ToString() + "\n";
    Thread.Sleep(30000);
    str += "Pull End: " + DateTime.Now.ToString();
    return new JavaScriptSerializer().Serialize(str);
}

[WebMethod]
public static string CheckStatus(int snapshotId)
{
    return new JavaScriptSerializer().Serialize("Check Status" + DateTime.Now.ToString());
} 
```

下面是点击按钮时的 Javascript 调用。

```
 <script src="Scripts/jquery-1.4.1.min.js" type="text/javascript"></script>

    <script language="javascript" type="text/javascript">

         function pullData(){

             $.ajax({ type: 'POST',
                 url: 'Default.aspx/PullData',
                 data: '{ snapshotId: 101 }',
                 contentType: 'application/json; charset=utf-8',
                 dataType: 'json',
                 success: function (msg) {
                     var curMsg = $("#message").attr("innerHTML") + "<br />";
                     $("#message").attr("innerHTML", curMsg + msg.d);
                 },
                 error: function (jqXHR, textStatus, errorThrown) {
                     alert(jqXHR.responseText);
                 }
             });

            CheckStatus();
            return false;
        }

        function CheckStatus() {
            //alert("this is check status");
            $.ajax({ type: 'POST',
                url: 'Default.aspx/CheckStatus',
                data: '{ snapshotId: 101 }',
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (msg) {
                    var curMsg = $("#message").attr("innerHTML") + "<br />";
                    $("#message").attr("innerHTML", curMsg + msg.d);
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert(jqXHR.responseText);
                }
            });

            return false;
        }

    </script> 
```

在上面调用**CheckStatus**方法应该返回响应，在**PullData**方法返回响应之前。但是**CheckStatus在****PullData**完成其工作后执行。

我可能在这里失踪或不知道完整的行为。请帮忙！！！

有人遇到过这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T20:20:45.553

我发现不能同时执行多个 AJAX 请求。但是，请求是异步的，但那些进入队列。在第一个请求以任何状态成功/失败完成之前，下一个请求不会发送到服务器。最终，我们同时执行了多个请求，但它直到之前的完成才进入服务器。

# java - 从纯文本文件创建 csv 文件的逻辑帮助

> ID：14791756
> 
> 赞同：0
> 
> 时间：2013-02-09T21:23:42.793
> 
> 标签：java, csv

实际上我有一个 .rtf 文件，并且我试图创建一个 csv 文件。在搜索时，我看到我已将其转换为纯文本，然后转换为 csv 文件。但现在我有点被逻辑困住了。我不知道要申请什么才能继续前进。

我有以下要转换为 csv 的数据。

输入 ：

```
Search Target Redmond40_MAS  Log Written 01/18/2013 9:13:19 Number of attempts 1
Search Target Redmond41_MAS  Log Written 01/19/2013 9:15:16 Number of attempts 0 
```

输出 ：

```
Search Target,Log Written,Number of attempts
Redmond40_MAS,01/18/2013 9:13:19,1
Redmond41_MAS,01/19/2013 9:15:16,0 
```

如果有任何分隔符，那么我会这样做，但在这种情况下，我知道是“键”，即标题值，但不知道如何提取相应的内容。

任何建议都会有所帮助。

```
import java.io.*;
import javax.swing.text.BadLocationException;
import javax.swing.text.Document;
import javax.swing.text.rtf.RTFEditorKit;

public class Rtf2Csv {

    public static void main(String[] args) {
        RTFEditorKit rtf = new RTFEditorKit();
        Document document = rtf.createDefaultDocument();
        try {
            FileInputStream fi = new FileInputStream("test.rtf");
            rtf.read(fi, document, 0);
        } catch (FileNotFoundException e) {
            System.out.println("File not found");
        } catch (IOException e) {
            System.out.println("I/O error");
        } catch (BadLocationException e) {
        }
        String output = "Search Target,Log Written,Number of attempts";
        try {
            String text = document.getText(0, document.getLength());
            text = text.replace('\n', ' ').trim();
            String[] textHeaders = text
                    .split("===================================================================================");

            String[] header = { "Search Target", "Log Written",
                    "Number of attempts"};
            System.out.println(textHeaders.length);
            int headLen = header.length;
            int textLen = textHeaders.length;
            for (int i = 0; i < textLen; i++) {
                String finalString = "";
                String partString = textHeaders[i];
                for (int j = 0; j < headLen; j++) {
                    int len = header[j].length();
                    if (j + 1 < header.length)
                        finalString += partString.substring(
                                partString.indexOf(header[j]) + len,
                                partString.indexOf(header[j + 1])).trim()
                                + ",";
                    else
                        finalString += partString.substring(
                                partString.indexOf(header[j]) + len).trim();
                }
                output += "\n" + finalString;
            }
        } catch (BadLocationException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        try {
            FileWriter writer = new FileWriter("output.csv");
            writer.append(output);
            writer.flush();
            writer.close();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }

} 
```

我已经写了这段代码。有没有更好的改进方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:44:25.823

我建议使用 Scanner 或 StringTokenizer。这里有一个深入的解释：

[Scanner vs. StringTokenizer vs. String.Split](https://stackoverflow.com/questions/691184/scanner-vs-stringtokenizer-vs-string-split)

这样的事情应该这样做：

```
StringTokenizer s = new StringTokenizer("Search Target Redmond40_MAS  Log Written 01/18/2013 9:13:19 Number of attempts 1"
);

String out = new String();

while (s.hasMoreTokens()) {
   out =  s.nextToken() + "," + out ;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:33:54.510

如果您感兴趣的列是固定宽度的，您可以在 Excel 中打开 txt 文件并在需要的位置放置列分隔符。

从 Excel 导出为 csv 会很简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T23:37:54.767

如果您**确定**它是固定宽度，则只需计算字段的长度。否则，我建议编写一个简单的解析器。您可能会因为正确的正则表达式而感到幸运，但根据我的经验，这可能会有很多线索和错误。

解析它应该不会太难......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T14:59:26.207

如果您想逐行阅读，可以使用以下内容：

```
public int countLines(File inFile)
{
   int count = 0;
   Scanner fileScanner = new Scanner(inFile);

   while(fileScanner.hasNextLine()) //if you are trying to count lines
   {                                //you should use hasNextLine()
       fileScanner.nextLine() //advance the inputstream
       count++;
   }

   return count;
} 
```

这回答了你的问题了吗？

# c - C：在 BST 打印输出上取消引用指向不完整类型错误的指针

> ID：14791760
> 
> 赞同：0
> 
> 时间：2013-02-09T21:23:56.493
> 
> 标签：c, printf, binary-search-tree

我正在尝试打印存储在 BST 链接列表中的单词。当我尝试打印这个词时，它给了我“取消引用指向不完整类型的指针”错误。

我的打印功能在我的 BST 结构的头文件中。在我的主要功能中，我可以毫无问题地像这样打印出来，但它似乎不想在这个功能中打印。

```
//linked list struct
struct ll_node
{
    char * word;
    struct ll_node * next;  
};

//BST struct
struct bst_node
{
    int occurs;
    int diffOccurs;

    struct bst_node * left;
    struct bst_node * right;

    struct ll_node * words;
};

//printout function
void * printTree(struct bst_node * currBST)
{
    if(currBST == NULL)
    {
        return;
    }

    printf("%s\n", currBST->words->word);

    printTree(currBST->left);
    printTree(currBST->right);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:34:32.817

`struct bst_node`并且`struct ll_node`都应该在使用*之前*`currBST->words->word`定义。

# ios - UITableView 插入控件不应该是可重新排序的

> ID：14791762
> 
> 赞同：0
> 
> 时间：2013-02-09T21:24:12.420
> 
> 标签：ios, uitableview, insertion

我有一个 UITableView，我希望能够通过插入控件（绿色加号图标）插入行。（我最初使用导航栏上的“添加”控件，但使用“返回”、“添加”和“编辑”控件时，我觉得导航栏有点混乱）。

我得到了这个工作，但我不喜欢它与重新排序控件交互的方式。我的桌子只有一个部分；插入行将始终显示为表中的最后一行，并且不应重新排序。

我实现了 canMoveRowAtIndexPath: 为插入控制行返回 false，但这只是部分解决方案。这消除了拖动插入行的能力。但是，没有什么能阻止用户选择可移动行并将其拖到插入控制器行下方。（如果允许，这会使应用程序崩溃）。

我实施的解决方法是检查 moveRowAtIndexPath:toIndexPath 中的 to 位置。如果目标位置在插入行的下方，我不执行移动，调用[tableView reloadData]重绘之前的表格状态。这行得通，但外观很笨拙——该行只是突然回到之前的位置，没有说明原因。

这是这里的正确行为 - 还是有更优雅的解决方案？理想情况下，我希望用户首先不能将该行拖到非法位置，但我不确定是否有任何机制可以防止它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:53:33.153

您需要实现`tableView:targetIndexPathForMoveFromRowAtIndexPath:toProposedIndexPath:`委托方法。实现应该根据行是否可以定位到所需的行来返回适当的索引路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T19:16:52.370

这是实现：

```
// Don't allow dragging any moveable row below the insertion control
- (NSIndexPath *)tableView:(UITableView *)tableView targetIndexPathForMoveFromRowAtIndexPath:   (NSIndexPath *)sourceIndexPath toProposedIndexPath:(NSIndexPath *)proposedDestinationIndexPath
{
    int proposedRow = proposedDestinationIndexPath.row;
    int maxRow = [[[SADeckStore sharedStore] allDecks] count] - 1;
    if (proposedRow < maxRow)
        return proposedDestinationIndexPath;
    else
        return [NSIndexPath indexPathForRow:maxRow inSection:[proposedDestinationIndexPath section]];
} 
```

# ios6 - 在 iOS 6 中使用自动布局调整单元格大小

> ID：14791764
> 
> 赞同：3
> 
> 时间：2013-02-09T21:24:29.363
> 
> 标签：ios6, uicollectionview, autolayout

`UICollectionView`当设备从纵向变为横向时，有没有办法调整单元格的大小？使用新的 iOS 6 自动布局？我不想重新加载整个`UICollectionView`.

如果有人想知道，我找到了解决方案。解决方案：

```
- (CGSize)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout sizeForItemAtIndexPath:(NSIndexPath *)indexPath {

    if ([indexPath row] == 0 && ([UIApplication sharedApplication].statusBarOrientation == UIInterfaceOrientationPortrait || [UIApplication sharedApplication].statusBarOrientation == UIInterfaceOrientationPortraitUpsideDown )){
        return CGSizeMake(768, 400);
    }else if ([indexPath row] == 0 && ([UIApplication sharedApplication].statusBarOrientation == UIInterfaceOrientationLandscapeLeft || [UIApplication sharedApplication].statusBarOrientation == UIInterfaceOrientationLandscapeRight)){
        return CGSizeMake(1024, 400);
    }

return CGSizeMake(255, 200); 
```

}

因此方法 sizeForItemAtIndexPath 使用 CGSize 为每个单元格指定宽度和高度。您需要做的就是检测单元格的方向，并返回您想要的特定高度。请记住，出于设计目的，我只更改了一个单元格。

之后，我在以下位置调用了 [invalidate layout]：

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration { 
```

它基本上再次获得了每个单元格的布局，也不会重新加载 UICollectionView 的数据！

# javascript - 如何循环这个函数？

> ID：14791766
> 
> 赞同：1
> 
> 时间：2013-02-09T21:24:47.850
> 
> 标签：javascript, jquery, loops

多亏了这里的一些帮助，我有一种方法可以预览选择的图像并使用以下方法上传：

```
<input type='file' name="files[]" onchange="readURL(this);" multiple />
<div id="previews"></div>

<script>
    function readURL(input) {
        if (input.files && input.files[0]) {

            var reader = new FileReader();

            reader.onload = function (e) {
                var container = $('#previews');
                var image = $('<img>').attr('src', e.target.result).width(150);
                image.appendTo(container);
            };
            reader.readAsDataURL(input.files[0]);
        }
    }
</script> 
```

我想知道如何为输入中选择的每个文件循环这个函数？我只是看不到在哪里使用 .each() 之类的东西

**编辑：**

我正在尝试这个..但它在某个地方是错误的，因为它显示 2 个预览但都是相同的图像？

```
function readURL(input) {
    $.each(input.files,function(i) {
        var reader = new FileReader();
        reader.onload = function (e) {
            var container = $('#previews');
            var image = $('<img>').attr('src', e.target.result).width(150);
            image.appendTo(container);
        };
        reader.readAsDataURL(input.files[0]);
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:31:10.133

[`input.files`](http://www.w3.org/TR/html5/forms.html#dom-input-files)是 a [`FileList`](http://www.w3.org/TR/FileAPI/#dfn-filelist)，它就像一个数组。
您可以[`jQuery.each`](http://api.jquery.com/jQuery.each/)像使用任何其他阵列一样使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:26:35.043

您只需要遍历选择文件的最后一行。

```
function readURL(input) {
    var reader = new FileReader();
    reader.onload = function (e) {
        var container = $('#previews');
        var image = $('<img>').attr('src', e.target.result).width(150);
        image.appendTo(container);
    };

    $.each(input.files,function(i) {
        reader.readAsDataURL(input.files[i]);
    });
} 
```

# doctrine - Doctrine 查询 count() 和 groupBy() 日期

> ID：14791767
> 
> 赞同：1
> 
> 时间：2013-02-09T21:24:58.573
> 
> 标签：doctrine, doctrine-orm, dql

我需要找到每天的登录总数，但是如何在 DQL 中选择 count() 和按天分组？我正在使用 Doctrine 2.3。

```
public function getLoginCount()
{
    return $this->createQueryBuilder('i')
            ->select('i') // and count(*)
            ->groupBy('i.timestamp') // group by day
            ->getQuery()
            ->execute()
        ;
} 
```

我需要这样的东西：

```
Date | count
2013-01-01 | 6
2013-01-02 | 7
2013-01-03 | 3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:17:42.730

从 Doctrine IRC 频道的帮助中，您需要创建自定义 DQL 函数。

示例： [https ://github.com/beberlei/DoctrineExtensions/blob/master/lib/DoctrineExtensions/Query/Mysql/Day.php](https://github.com/beberlei/DoctrineExtensions/blob/master/lib/DoctrineExtensions/Query/Mysql/Day.php)

文档： http: [//www.doctrine-project.org/blog/doctrine2-custom-dql-udfs.html](http://www.doctrine-project.org/blog/doctrine2-custom-dql-udfs.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-12T01:36:24.430

OP 有点晚了，但也许有人会觉得它很方便。我能够通过下面的 DQL 查询来实现这一点：

```
 $dql = '
        SELECT
            SUBSTRING(i.timestamp, 1, 10) as date,
            COUNT(i) as count
        FROM Entity i
        GROUP BY date
    ';
    $query = $entityManager->createQuery($dql);
    return $query->getResult(); 
```

我认为类似的应该可以使用 Doctrine 查询生成器。

# php - 如何在PHP中的两个单词之间找到一个单词

> ID：14791773
> 
> 赞同：-1
> 
> 时间：2013-02-09T21:25:33.190
> 
> 标签：php

我只是在寻找一种在两个静态单词之间找到字符串的方法。

例如：

要么是

Subbed string-I-want Online

或者

配音字符串-我要在线

我试过像 substr 这样的函数，我可以让它找到第一个空格，然后打印出字符串的其余部分。

这将导致以下结果

string-我要在线

但我也想删除 Online 所以它使它

我想要的字符串

最好找到第一个空格并删除它之前的所有内容，然后找到第一个“在线”并删除它之后的所有内容以及“在线”一词。所以只给出了中间部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:29:20.633

正则表达式虽然不是每项任务的理想选择，但可以很好地解决这个问题：

```
preg_match('/(S|D)ubbed (.*?) Online/', $your_string, $matches);
$text = $matches[2]; 
```

# google-apps-script - 如果 Google 表格中的单元格发生更改，则触发电子邮件

> ID：14791777
> 
> 赞同：1
> 
> 时间：2013-02-09T21:25:51.753
> 
> 标签：google-apps-script

我有一张表格，我们可以在其中跟踪 Google 表格中的部门指标。当指标发生变化时，我试图将其发送到电子邮件中。我正在使用 counta（在 P2 范围内）来监控是否有新指标进入，如果范围内的值发生变化，我想触发一封电子邮件。

```
function onEdit() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var value = ss.getSheetByName("EmailServices").getRange("P2").getValue().toString();
  var last = ScriptProperties.getProperty("last");

  if(value != last) 

  {
  ScriptProperties.setProperty("last",value);
  MailApp.sendEmail("dave@mydomain.com", "cell P2 changed",
    "new value: " + value + "\n\n" + ss.getUrl())
  }
} 
```

我有趋势图表，最终我想通过电子邮件发送实际趋势图表已更改（输入新的月度值），但我想我会在跑步之前先走。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T03:51:56.063

由于公式而更改的单元格不符合触发 onEdit 函数的“编辑”条件。您应该监视源单元格（如果它们是手动编辑的），或者第二种选择是让一个函数在每分钟运行一次（或任何您喜欢的频率）运行的触发器下运行并发送电子邮件。您编写的函数看起来很适合在触发器下运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T10:59:58.803

戴夫·拉兰德。看看这段代码。

```
function getTimeEditRange(Range){
  return YourFunction(Range);
} 
```

如果值相同，则事件不会发生。

此致！

# java - 无法使用 SQLite db 在 Android 应用上验证登录

> ID：14791780
> 
> 赞同：0
> 
> 时间：2013-02-09T21:26:08.853
> 
> 标签：java, android, database, sqlite

我在验证我的 Android 应用程序登录时遇到问题。我有 2 个字段需要用户输入电子邮件和密码，如果两者都存在于数据库中，那么如果出现不正确的错误，它们将被带到主屏幕（登录成功）。我已经尝试了一切，但仍然无法正常工作！请帮助我在下面发布了我的代码。

```
package com.example.finalproject;

import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class LoginActivity extends Activity implements OnClickListener{

    EditText mEmailAdd;
    EditText mPassword;
    private SQLiteAdapter mydb = null;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.login_activity);
        //addListenerOnButton();
    }

    public void onCreateMainscreen(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.screenmain_activity);

         Button mNewUser = (Button)findViewById(R.id.btnLogMain);
            mNewUser.setOnClickListener(this);
    }

    public void onClick(View v) {

        switch(v.getId()){

        case R.id.btnLogMain:
            mEmailAdd = (EditText)findViewById(R.id.email);
            mPassword = (EditText)findViewById(R.id.password);

            String uname = mEmailAdd.getText().toString();
            String pass = mPassword.getText().toString();

            if(uname.equals("") || uname == null){
                Toast.makeText(getApplicationContext(), "email Empty", Toast.LENGTH_SHORT).show();
            }else if(pass.equals("") || pass == null){
                Toast.makeText(getApplicationContext(), "Password Empty", Toast.LENGTH_SHORT).show();
            }else{
                boolean validLogin = validateLogin(uname, pass, LoginActivity.this);
                if(validLogin){
                    System.out.println("In Valid");
                    Intent i = new Intent(LoginActivity.this, MainMenuActivity.class);
                    startActivity(i);
                    finish();
                }
            }
            break;

        }
    }

        //  @SuppressWarnings("deprecation")

    public boolean validateLogin(String uemail, String pass, Context context) {

        mydb = new SQLiteAdapter(this);
        SQLiteAdapter db = mydb.openToWrite();
        //SELECT
        String[] columns = {"_id"};

        //WHERE clause
        String selection = "email=? AND password=?";

        //WHERE clause arguments
        String[] selectionArgs = {uemail,pass};

        Cursor cursor = null;
        try{
        //SELECT _id FROM login WHERE email=uemail AND password=pass
        cursor = db.query(SQLiteAdapter.MYDATABASE_TABLE, columns, selection, selectionArgs, null, null, null);

        //  startManagingCursor(cursor);

        }catch(Exception e){
            e.printStackTrace();
        }
        int numberOfRows = cursor.getCount();

        if(numberOfRows <= 0){

            Toast.makeText(getApplicationContext(), "Failed..\nTry Again", Toast.LENGTH_SHORT).show();
            return false;
        }

        return true;
    }

    public void onDestroy(){
        super.onDestroy();
        mydb.close();
    }

} 
```

数据库类

```
package com.example.finalproject;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.database.sqlite.SQLiteDatabase.CursorFactory;

public class SQLiteAdapter {

 public static final String MYDATABASE_NAME = "MY_PROJECT_DATABASE";
 public static final String MYDATABASE_TABLE = "MY_USERS_TABLE";
 public static final int MYDATABASE_VERSION = 1;
 public static final String KEY_ID = "_id";
 public static final String KEY_NAME = "name";
 public static final String KEY_EMAIL = "email";
 public static final String KEY_PASSWORD = "password";

 //create table MY_DATABASE (ID integer primary key, Content text not null);
 private static final String SCRIPT_CREATE_DATABASE =
  "create table " + MYDATABASE_TABLE + " ("
  + KEY_ID + " integer primary key autoincrement, "
  + KEY_NAME + " text not null, "
  + KEY_EMAIL + " text not null, "
  + KEY_PASSWORD + " text not null);";

 private SQLiteHelper sqLiteHelper;
 private SQLiteDatabase sqLiteDatabase;

 private Context context;

 public SQLiteAdapter(Context c){
  context = c;
 }

 public SQLiteAdapter openToRead() throws android.database.SQLException {
  sqLiteHelper = new SQLiteHelper(context, MYDATABASE_NAME, null, MYDATABASE_VERSION);
  sqLiteDatabase = sqLiteHelper.getReadableDatabase();
  return this; 
 }

 public SQLiteAdapter openToWrite() throws android.database.SQLException {
  sqLiteHelper = new SQLiteHelper(context, MYDATABASE_NAME, null, MYDATABASE_VERSION);
  sqLiteDatabase = sqLiteHelper.getWritableDatabase();
  return this; 
 }

 public void close(){
  sqLiteHelper.close();
 }

 public long insert(String name, String email, String password){

  ContentValues contentValues = new ContentValues();
  contentValues.put(KEY_NAME, name);
  contentValues.put(KEY_EMAIL, email);
  contentValues.put(KEY_PASSWORD, password);
  return sqLiteDatabase.insert(MYDATABASE_TABLE, null, contentValues);
 }

 public int deleteAll(){
  return sqLiteDatabase.delete(MYDATABASE_TABLE, null, null);
 }

 public Cursor queueAll(){
  String[] columns = new String[]{KEY_ID, KEY_NAME, KEY_EMAIL,KEY_PASSWORD};
  Cursor cursor = sqLiteDatabase.query(MYDATABASE_TABLE, columns,
    null, null, null, null, null);

  return cursor;
 }

 public class SQLiteHelper extends SQLiteOpenHelper {

  public SQLiteHelper(Context context, String name,
    CursorFactory factory, int version) {
   super(context, name, factory, version);
  }

  @Override
  public void onCreate(SQLiteDatabase db) {
   // TODO Auto-generated method stub
   db.execSQL(SCRIPT_CREATE_DATABASE);
  }

  @Override
  public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
   // TODO Auto-generated method stub
  }
 } 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:30:31.933

不是你的错误，而是改变

`if(uname.equals("") || uname == null){ // throws nullpointerexception if uname == null`

至

`if(uname == null || uname.length() == 0 ){ // throws no exception and also checks the " "`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:31:19.650

不确定这是否只是复制粘贴错误，但提供的代码不仅无法编译，而且也从未为登录按钮设置点击侦听器。这是我修改的内容，使其既可以编译又可以查询数据库。

在**SQLiteAdapter 中**：

```
public SQLiteDatabase openToWrite() throws android.database.SQLException {
    sqLiteHelper = new SQLiteHelper(context, MYDATABASE_NAME, null,
            MYDATABASE_VERSION);
    sqLiteDatabase = sqLiteHelper.getWritableDatabase();
    return sqLiteDatabase;
} 
```

在**LoginActivity**：

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.login_activity);
    //addListenerOnButton();

    Button mNewUser = (Button)findViewById(R.id.btnLogMain);
    mNewUser.setOnClickListener(this);
}

public void onCreateMainscreen(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.screenmain_activity);

     Button mNewUser = (Button)findViewById(R.id.btnLogMain);
     mNewUser.setOnClickListener(this);
}
 public boolean validateLogin(String uemail, String pass, Context context) {

    mydb = new SQLiteAdapter(this);
    SQLiteDatabase db = mydb.openToWrite();
    //SELECT
    String[] columns = {"_id"};

    //WHERE clause
    String selection = "email=? AND password=?";

    //WHERE clause arguments
    String[] selectionArgs = {uemail,pass};

    Cursor cursor = null;
    try{
    //SELECT _id FROM login WHERE email=uemail AND password=pass
    cursor = db.query(SQLiteAdapter.MYDATABASE_TABLE, columns, selection, selectionArgs, null, null, null);

    //  startManagingCursor(cursor);

    }catch(Exception e){
        e.printStackTrace();
    }
    int numberOfRows = cursor.getCount();

    if(numberOfRows <= 0){

        Toast.makeText(getApplicationContext(), "Failed..\nTry Again", Toast.LENGTH_SHORT).show();
        return false;
    }

    return true;
} 
```

另请注意，此代码也永远不会将任何内容插入数据库。我认为这将在其他地方完成。此外，这里打破了许多命名约定和一般的良好实践。

几个问题：

*   永远不要在主线程上做数据库工作。
*   以“m”为前缀的变量表示它们是类的成员变量。
*   确保在适当的时候使用@Override 表示法。

# php - PHP：值未保存在 foreach 循环中

> ID：14791787
> 
> 赞同：0
> 
> 时间：2013-02-09T21:27:01.330
> 
> 标签：php, foreach

PHP代码：

```
$file = file_get_contents('example.com/index/');
$array = array();
preg_match_all('!href=\\"(/img/[0-9]+.jpg)\\"!u', $file, $array);
$results = array_unique($array[1]);

foreach ( $results as $value ) {
    $value = 'imgaes.example.com/' . $value;
    echo "$value\n"; // imgaes.example.com/838.jpg
}

var_dump($results); // 838.jpg 
```

错误在哪里？我试着做一个小抓手。它的所有细节，我想。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T21:30:55.293

通过引用分配值：

```
foreach ( $results as &$value ){
  ...
}

unset($value); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T21:32:46.210

或者

```
foreach ( $results as $key => $value ) {
    $results[$key] = 'imgaes.example.com' . $value;
    echo "$value\n"; // imgaes.example.com/img/838.jpg
}

var_dump($results); 
```

# php - 上传表单中的空字节注入

> ID：14791790
> 
> 赞同：7
> 
> 时间：2013-02-09T21:27:38.800
> 
> 标签：php, forms, security, exploit

我正在尝试在上传表单上重现空字节注入攻击。我有这个代码：

```
<?php
if(substr($_FILES['file']['name'], -3) != "php") { 
  if(move_uploaded_file($_FILES['file']['tmp_name'], $_FILES['file']['name']))
    echo '<b>File uploaded</b>';
  else
    echo '<b>Can not upload</b>';
}
else
  echo '<b>This is not a valid file/b>';
?> 
```

我正在尝试上传一个像这样命名的文件：*file.php%00jpg*，因此它将绕过 substr() 并将作为 file.php 上传，因为 move_uploaded_file() 应该在空字节 (%00) 处停止。

问题是上传的文件在服务器上不是名为*file.php*，而是*file.php%00jpg*（可以在url栏中输入*/file.php%2500jpg访问）。*
看来 move_uploaded_file() 并不关心空字节，那么它是如何工作的呢？是否可以使用我的代码上传扩展名为 .php 的文件？

谢谢 ：）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-09T22:05:48.280

HTML 表单将文件名 urlencode 为 %2500，PHP 再次将其解码为 %00（百分号、零、零）。在任何地方的测试中都没有空字节，您必须使用实际的空字节命名文件（不可能）或手动处理 HTTP 请求，而不是使用 HTML 表单。尽管如此，当前的 PHP 版本**并不**容易受到这种攻击，PHP 在内部将变量装箱在一个所谓的 ZVal 容器中，并允许字符串中间的空字节没有任何影响。

# windows - 文件列表循环中的迭代器子字符串

> ID：14791793
> 
> 赞同：0
> 
> 时间：2013-02-09T21:27:45.777
> 
> 标签：windows, batch-file

```
for %%a in (*.en.srt) do (
   echo %%~na
) 
```

此脚本列出所有以`.en.srt`结尾但没有扩展名 ( `.srt`) 的文件。

**如何获取不包含 .en 部分的子字符串？**

我试图应用这个建议：

[http://www.dostips.com/DtTipsStringOperations.php#Snippets.MidString](http://www.dostips.com/DtTipsStringOperations.php#Snippets.MidString)

但我不能让这个工作`%%a`和`%%~na`变量。

显然我不了解批处理语法基础知识，所以现在我在这里寻求帮助；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:55:03.877

只有`.`名称中最后一个字符之后的字符才被视为扩展名的一部分。最后一个字符之前的所有字符`.`（包括任何附加字符`.`）都被视为基本名称的一部分。

您可以使用第二个 FOR 循环来剥离`.en`

```
for %%a in (*.en.srt) do for %%b in ("%%~na") do echo %%~nb 
```

如果您有一个名为 的文件`part1.part2.en.srt`，那么它将回显`part1.part2`。如果您只想要第一个之前的字符`.`，那么您可以使用 FOR /F 循环。

```
for %%a in (*.en.srt) do for /f "eol=. delims=." %%b in ("%%a") do echo %%b 
```

但是，如果文件名为`.en.srt`. **编辑：**这可以通过一个简单的修改来解决。

```
for %%a in (*.en.srt) do for /f "eol=. delims=." %%b in ("\%%a") do echo(%%~nb 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:49:46.223

如果您知道一个事实，它将永远是 .en

```
setlocal EnableDelayedExpansion
for %%a in (*.en.srt) do (
    set tempstr=%%~na
    set tempstr=!tempstr:.en=!
    echo !tempstr!
) 
```

或者，如果您知道所有文件名都没有句点，则可以按句点分隔。

```
for /f "tokens=1 delims=." %%a in ('dir /B *.en.srt') do echo %%a 
```

**编辑**

为了清楚起见更改了代码，也为了回答您的评论，这将起作用：

```
for %%a in (*.en.srt) do (
    set tempstr=%%~na
    set tempstr=!tempstr:.en=!
    del !tempstr!
) 
```

# java - 类型安全的服务获取器类（返回参数化类型）

> ID：14791794
> 
> 赞同：0
> 
> 时间：2013-02-09T21:27:47.533
> 
> 标签：java, parameterized

我想获得的是可以安全地返回输入类实例的东西。在我的情况下被用作服务提供者。代码示例：

```
 public class MyClass {

    private Map<String, Object> mServices;

    public MyClass() {
        mServices = new HashMap<String, Object>();
        mServices.put(XmlService.class.getName(), new XmlService());
    }

    public <E extends Object> E getService(Class<?> service) {
        return (E) mServices.get(service.getName());
    }
} 
```

我承认我对参数化类型不是那么熟练，在这里我需要一些帮助。我没有从地图中获取对象吗？为什么我需要强制转换为 E，从而失去类型安全性？有没有办法避免强制转换和/或抑制警告？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:34:15.213

不，不幸的是，没有办法避免这种额外的沮丧。请注意，您的地图类型是`Map<String, Object>`. `Object`- 这就是 Java 编译器对值的全部了解。您必须以某种方式声明地图具有不同类型的每个键。不可能的。

但是您的代码可以简化一点：

```
public <E> E getService(Class<E> service) {
    return (E) mServices.get(service.getName());
} 
```

另一个轻微的改进涉及使用`Class`as key：

```
private Map<Class<?>, Object> mServices;

public <E> E getService(Class<E> service) {
    return (E) mServices.get(service);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:45:33.040

这应该在没有沮丧的情况下工作：

```
public class ServiceLoader<T extends AbstractService> {

private Map<String, T> services = new HashMap<String, T>();

T getService(Class<T> componentType) {
    return services.get(componentType.getName());
} 
```

# html - 在 Rails 中添加指令以下拉选择框？

> ID：14791795
> 
> 赞同：0
> 
> 时间：2013-02-09T21:28:03.543
> 
> 标签：html, ruby-on-rails-3, select, helper

我正在我的 Rails 3 应用程序中显示所有用户的列表（来自用户模型）。在助手中（在这种情况下是故障）我有以下内容：

```
def user_all_select_options
  User.all.map{ |user| [user.name, user.id] }
end 
```

在视图中，我有以下内容：

```
<%= f.select :user_id, user_all_select_options %> 
```

这只是创建了一个下拉列表，其中预先选择了第一个用户名，因为它位于列表的顶部。我想要做的是在列表顶部添加一条指令（？），这是不可选择的。这个想法是为了防止顶级用户经常被意外设置为所需用户，即使他们不想成为。

因此，而不是看起来像这样的选择框：

![安东尼用户](../Images/a002df41f034cc24a328d641476c7e48.png)

我希望它看起来像这样：

![选择用户](../Images/78c69acab5ab270ffe2bfc46b6339d51.png)

这可能吗，如果可以，如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:07:25.800

通过`:prompt`选项。

```
<%= f.select :user_id, user_all_select_options, :prompt => 'Select a user' %> 
```

# android - Android：如何计算 func(X) 其中 x 是一个矩阵？

> ID：14791797
> 
> 赞同：1
> 
> 时间：2013-02-09T21:28:09.490
> 
> 标签：android, math

我正在尝试计算诸如 sin(X)、cos(X) 之类的函数，其中 X 在 Android 上是一个有效的矩阵。知道我可以使用什么库吗？我看过 org.apache.common.math3 但我无法找到一种方法来做我需要的事情。帮助表示赞赏。谢谢

这是我想做的事情：

```
function Matrix process(Matrix X, Matrix Y) {
    Matrix result = SomeLib.add(SomeLib.sin(X), SomeLib.cos(Y), SomeLib.log(Y));
    return result;
} 
```

# multithreading - 用户级线程 (ULT) 和内核级线程 (KLT) 在并发执行方面有何不同？

> ID：14791801
> 
> 赞同：12
> 
> 时间：2013-02-09T21:28:47.547
> 
> 标签：multithreading, concurrency, parallel-processing, operating-system

这是我的理解；请更正/添加：

在纯 ULT 中，多线程进程本身执行线程调度。因此，内核本质上没有注意到差异，并认为它是一个单线程进程。如果一个线程进行阻塞系统调用，则整个进程都会被阻塞。**即使在多核处理器上，一次也只能运行一个进程线程，除非进程被阻塞。**不过，我不确定 ULT 有多大帮助。

在纯 KLT 中，即使一个线程被阻塞，内核也会调度同一进程的另一个（就绪）线程。（在纯 KLT 的情况下，我假设内核创建了进程的所有线程。）

此外，使用 ULT 和 KLT 的组合，如何将 ULT 映射到 KLT？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-09T21:52:42.543

你的分析是正确的。操作系统内核不知道用户级线程。从它的角度来看，进程是一个不透明的黑匣子，偶尔会进行系统调用。因此，如果该程序有 100,000 个用户级线程但只有一个内核线程，那么该进程一次只能运行一个用户级线程，因为只有一个内核级线程与之关联。另一方面，如果一个进程有多个内核级线程，那么如果有一个多核机器，它就可以并行执行多个命令。

一个常见的折衷方案是让程序请求一些固定数量的内核级线程，然后让其自己的线程调度程序将用户级线程酌情分配到这些内核级线程上。这样，多个 ULT 可以并行执行，并且程序可以对线程的执行方式进行细粒度控制。

至于这个映射是如何工作的——有很多不同的方案。您可以想象用户程序使用多种不同调度系统中的任何一种。事实上，如果你做这个替换：

> 内核线程 <---> 处理器内核
> 
> 用户线程 <---> 内核线程

那么操作系统可以用来将内核线程映射到内核的任何方案也可以用来将用户级线程映射到内核级线程。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-26T21:36:58.297

首先，[templatetypedef](https://stackoverflow.com/questions/14791801/how-do-user-level-threads-ults-and-kernel-level-threads-klts-differ-with-reg/14792010#14792010)的答案很漂亮；我只是想稍微扩展他的回答。

我觉得有一个领域需要扩展一点：**ULT 和 KLT 的组合**。要了解重要性（维基百科标记[混合线程](http://en.wikipedia.org/wiki/Thread_%28computer_science%29#M:N_.28Hybrid_threading.29)），请考虑以下示例：

考虑一个多线程程序（多个 KLT），其中 KLT 多于可用逻辑内核。为了有效地使用每个内核，正如您所提到的，您希望调度程序将阻塞的 KLT 切换到处于就绪状态且未阻塞的 KLT。这可确保核心减少其空闲时间。不幸的是，切换 KLT 对调度程序来说代价高昂，并且会消耗相对大量的 CPU 时间。

这是混合线程可以提供帮助的一个领域。考虑一个具有多个 KLT 和 ULT 的多线程程序。正如**templatetypedef**所指出的，每个 KLT 一次只能运行一个 ULT。如果 ULT 被阻塞，我们仍然希望将其切换为没有阻塞的 ULT。幸运的是，ULT 比 KLT 轻得多，因为分配给 ULT 的资源更少，并且它们不需要与内核调度程序交互。从本质上讲，切换 ULT 几乎总是比切换 KLT 更快。因此，相对于第一个示例，我们能够显着减少核心空闲时间。

现在，当然，所有这些都取决于用于实现 ULT 的线程库。有两种方法（我可以想出）将 ULT 映射到 KLT。

1.  **所有**KLT 的ULT 集合

    这种情况在共享内存系统上是理想的。本质上，每个 KLT 都可以访问 ULT 的“池”。理想情况下，线程库调度程序将根据请求将 ULT 分配给每个 KLT，而不是 KLT 单独访问池。如果不使用锁或类似的东西实现，后者可能会导致竞争条件或死锁。

2.  **每个**KLT的 ULT 集合（ [Qthreads](http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=4536359)）

    这种情况在分布式内存系统上是理想的。每个 KLT 都会有一组 ULT 来运行。缺点是用户（或线程库）必须在 KLT 之间划分 ULT。这可能会导致负载不平衡，因为不能保证所有 ULT 将完成相同数量的工作，并且完成大致相同的时间。解决方案是允许 ULT 迁移；也就是说，在 KLT 之间迁移 ULT。

# geometry - 如何找到与 2D 视口相交的线段

> ID：14791803
> 
> 赞同：0
> 
> 时间：2013-02-09T21:28:54.053
> 
> 标签：geometry

在无限的二维空间中，有一组线，每条线都有一个起点和终点，以及一个创建时间：`Line(p0, p1, t)`.

我想找到应该在这个 2D 空间的自上而下视图中渲染的线条（更高的 t 值显示更接近视口，而不是它应该是相关的。）

直观的答案是“检查任一点是否在视口坐标内”，但是当这些点与视口区域覆盖的距离更远时，它就会下降。

我的另一个想法是使用类似[geohash](https://en.wikipedia.org/wiki/Geohash)的东西，这会限制精度，即视口的最大缩放级别。这个想法是枚举相交的单元格的哈希值并存储它们。这种查询方式就是提出正确的问题。

有没有理想的解决方案？这个问题以前解决过吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:42:16.683

我认为您需要检查两个条件：一个是视口矩形与带角的矩形重叠 (p0,p1)，第二个是视口矩形的某些角位于包含线段 (p0, p1)。

[使用 R-tree ( http://en.wikipedia.org/wiki/R-tree](http://en.wikipedia.org/wiki/R-tree) )可以非常有效地解决大量矩形的查找矩形重叠的任务。

第二个任务可以简化为检查 (p1-p0) x (corner_coordinate-p0) 的叉积的符号（所有三个量都被视为第三个坐标等于 0 的 3-d 向量，结果将是沿垂线的向量方向）。应该有与此叉积相反符号的角。

# matlab - 如何根据来自两个单独数据表的输入在 matlab 中创建排名（降序）表？

> ID：14791806
> 
> 赞同：-2
> 
> 时间：2013-02-09T21:29:10.747
> 
> 标签：matlab, ranking, bucket-sort

我有四个数据集（请耐心等待）：

*   第一表：matlab 中一列 txt 格式的 10 个股票代码（股票代码）列表。
*   第二个表：一列中数字格式的日期（双格式为 10 天）。
*   第三张表：我有 10*10 的随机数数据集（为简单起见假设 0-1）。（例如每股收益增长每股收益）——所以我希望在我的投资组合构建排名中实现高每股收益增长。
*   第 4 表：我还有另一个 10*10 的随机数数据集（为简单起见假设 0-1）。（例如每天的市盈率）。-所以我希望我的投资组合构建排名中的市盈率较低。

现在：我想对每天由表一中的 3 只股票（最大值）和表 2 中的底部三只股票（最小值）组成的股票组合进行排名。输出必须是基于两个因素的组合排名（如所述的表 3 和 4）的每天的代码列表（在这种情况下为 3 个）。

有任何想法吗？简而言之，我最终需要一个带有三个股票代码的顶级桶......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T23:02:46.670

从帖子中您要达到的目标并不完全清楚。这是一个基于猜测的观点，有多种选择。

您的前两个“表格”存储股票和日期的符号（与排名无关）。你的第三和第四是按某种方式排列的分数`stock x day`。让我们假设股票是垂直的，天是水平的，股票的符号是`[1:10]`.

```
N = 10; % num of stocks
M = 10; % num of days   
T3 = rand(N,M); % table 3 stocks x days
T4 = rand(N,M); % table 4 stocks x days 
```

按升序和降序对分数表进行排序（以获得每天的高低分数，即每列）：

```
[Sl,L] = sort(T3, 'descend'); 
[Ss,S] = sort(T4, 'ascend'); 
```

保持三个最大和最小：

```
largest = L(1:3,:);  % bucket of 3 largest per day
smallest = S(1:3,:); % bucket of 3 smallest per day 
```

如果您需要两者中的那些（0是nan）：

```
% Inter-section of both buckets
indexI = zeros(3,M);
for i=1:M
    z = largest(ismember(largest(:,i),smallest(:,i)));
    if ~isempty(z)
        indexI(1:length(z),i) = z;
    end
end 
```

如果您需要其中任何一个（0 是 nan）：

```
% Union of both buckets
indexU = zeros(6,M);
for i=1:M
    z = unique([largest(:,i),smallest(:,i)]);
    indexU(1:length(z),i) = z;
end 
```

如果您需要从 maximum_of_3 和 minimum_of_4 集合中对分数/股票进行排名：

```
scoreAll = [Sl(1:3,:); Ss(1:3,:)];
indexAll = [largest;smallest];

[~,indexSort] = sort(scoreAll,'descend');
for i=1:M
    indexBest(:,i) = indexAll(indexSort(1:3,i),i);
end 
```

**更新**

要获得最终分数的加权排名，请在排序之前定义权重向量（1 x 分数）并使用以下两个选项之一，`scoreAllW`而不是`scoreAll`：

```
w = [0.3 ;0.3; 0.3; 0.7; 0.7; 0.7];
scoreAllW = scoreAll.*repmat(w,1,10);    % Option 1
scoreAllW = bsxfun(@times, scoreAll, w); % Option 2 
```

# programming-languages - 有人能以最简单的方式解释第 110 条规则吗？

> ID：14791807
> 
> 赞同：24
> 
> 时间：2013-02-09T21:29:12.763
> 
> 标签：programming-languages, turing-complete

我无法理解**[维基百科文章](http://en.wikipedia.org/wiki/Rule_110)**或**[这里的答案](https://stackoverflow.com/a/5239256/759019)**所说的内容。有人可以简单地解释第 110 条规则吗？它如何保证图灵完备？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-18T23:27:02.370

我尝试用简洁的外行术语解释：

*   规则 110 是一个基本的元胞自动机：将 1 和 0 的有限模式转换为 1 和 0 的另一种模式的规则。
*   当规则 110 迭代地应用于某些输入位序列时，模式会根据输入位中的子序列出现。给定足够的迭代次数，可能会发生以下情况：
    *   原始子序列出现在与原始输入相同的位置。
    *   原始子序列被保留，但“移动”到位域中的不同位置。
    *   朝向彼此移动的两个子序列相互作用并“穿过”彼此。
    *   两个子序列结合起来创建一个新的子序列。
*   不同的子序列可以被赋予符号含义，如“1”、“0”、“时钟脉冲”或“生产规则”，它们对应于循环标签系统的元素。
*   通过在精心构造的输入位域上对规则 110 进行多次迭代，子序列的交互模拟了循环标签系统的行为。
*   循环标签系统可用于模拟通用图灵机。因此，循环标签系统是图灵完备的。
*   由于规则 110 可以模拟循环标签系统，因此它也是图灵完备的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-18T18:32:05.240

我将尝试详细说明：我不认为您正在寻找文章中已经相当复杂的证明的更多细节，尽管它显然省略了许多细节。

[引用您引用](http://en.wikipedia.org/wiki/Rule_110)的文章：*“在基本元胞自动机中，0 和 1 的一维模式根据一组简单的规则演变。模式中的点是 0 还是 1 取决于新一代它的当前值，以及它的两个邻居的值。规则 110 自动机具有以下规则集……”*（参见下面的[维基百科表格](http://en.wikipedia.org/wiki/Rule_110#Definition)）

起点，您可以将其视为数据，但可以将其视为代码的表示（将代码表示为数据对于任何图灵完备性的证明都是必要的；这可以追溯到图灵的原始结果），是一系列0 和 1 通常但不一定在两侧被仅包含 0 的单元包围。规则 110 显示了该序列如何演变。例如，如果一行中有 3 个 1 的模式，则中间的 1 将在下一行中“死亡”（变成 0）。它的两个邻居会发生什么取决于模式如何超越它们。你看到的三角图是自动机从原始状态演化的图形表示，编码 1 为黑色，编码 0 为白色，代表从上到下的演化。

图灵完备性证明的两个不同寻常的特点是，首先，这样一个非常简单的规则看起来不太可能完成你最喜欢的编程语言可以做的所有事情，其次，这使得第一个事实变得不那么令人惊讶的是，证明需要一个无限长的重复背景来发挥它的魔力。不过，我看不出有什么根本不诚实的地方；只不过是假设一个潜在的无限或半无限的空白磁带，就像图灵最初所做的那样。

要正确理解证明，您需要掌握数据（以及后来的代码）是如何在起始模式中编码的，而且看起来熟悉循环标签系统也会有很大帮助。我不是解释这些的人。

[尽管使用 2-D 元胞自动机（例如康威的“生命游戏”](http://en.wikipedia.org/wiki/Conway%27s_Game_of_Life) ）似乎更难理解这种情况，但我发现玩那个游戏很有启发性，研究“滑翔机”、“滑翔机枪”和“河豚火车”和其他有趣的建筑。（河豚列车制造滑翔机枪，滑翔机枪发射滑翔机）。这些也可以用来建立这个自动机的图灵完备性。

您可能还会发现[讨论页](http://en.wikipedia.org/wiki/Talk%3aRule_110)内容丰富（您不是唯一一个没有抓住重点，请参阅开头的条目*“这些图片对我没有任何意义......”*）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-19T07:24:01.767

1970 年，约翰康威发明[了生命游戏](http://en.wikipedia.org/wiki/Conway%27s_Game_of_Life)。

从那以后，我认为几乎每个程序员都尝试编写它的实现——我当然很久以前就这样做了，而且很有趣。

这个游戏实际上是元[胞自动机](http://en.wikipedia.org/wiki/Cellular_automaton)，它在无限二维平面上的几代细胞之间设定简单的规则。例如，如果在当前一代中，存活的邻居少于 2 个（位值`1`），那么它应该在下一代孤独中死亡。如果它有 3 个以上的邻居活着，它应该死于过度拥挤。如果空（位值`0`，或死）单元格恰好有 3 个邻居，它将导致它诞生（成为`1`）。

从那以后，人们发现生命游戏异常复杂——它可以产生许多非常复杂的模式，并且不断进化。此外，它被证明是图灵完备的，也就是说，您可以使用起始单元组合作为程序来编码任意复杂的算法，并作为结果进行最终组合。然而，花了几年的时间才找到如何真正生成复杂的形式，比如[滑翔机或枪](http://en.wikipedia.org/wiki/Gun_%28cellular_automaton%29)。

现在回到规则 110 是什么。简单地说，规则 110 是生命游戏的一维变体。

110 只是二进制字符串[01101110](http://en.wikipedia.org/wiki/Rule_110#Definition)的十进制数字表示，它是当前一代细胞（位）如何[转换为下一个](http://en.wikipedia.org/wiki/Rule_110#Definition)细胞的规则系统的简写形式，类似于生命游戏的细胞死于孤独或过度拥挤的规则系统出生时正好有三个邻居。

就像生命游戏一样，已经证明规则 110 是图灵完备的。您可以使用起始单元（位）组合作为程序编码任意复杂的算法，并使用最终位组合作为结果。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-06-28T20:44:29.947

python中的一个实现：

（请注意：实际的 python 程序员会为此杀死你）

```
import time

seed = raw_input("Feed me a string! (At least 3 characters long please)\n>")

lastline = '>'
iterator = 0

while (iterator<len(seed)):
    temp = (ord(seed[iterator]))%2
    if (temp == 1):
        lastline += '#'
    else:
        lastline += ' '
    iterator += 1

stop = 0
while (stop != 1): #Keep printing as long as CTRL-C isn't pressed
    #dummy = raw_input(lastline)
    print lastline
    iterator = 0
    nextline = '>'

    while (iterator<len(seed)):    #Convert entire string

        if (len(seed) < 3): # if wrong
            print "You had ONE JOB!"
            stop = 1

        elif (iterator == 0): # if at start
            if (lastline[1] == ' '):
                nextline += ' '
            else:
                nextline += '#'

        elif (iterator+1 == len(seed)): # if at end
            if (lastline[iterator+1] == ' '):
                nextline += ' '
            else:
                nextline += '#'

        else: #if in middle
            if (lastline[iterator] == '#' and lastline[iterator+1] == '#' and lastline[iterator+2] == '#'): #111
                nextline += ' '
            elif (lastline[iterator] == '#' and lastline[iterator+1] == '#' and lastline[iterator+2] == ' '): #110
                nextline += '#'
            elif (lastline[iterator] == '#' and lastline[iterator+1] == ' ' and lastline[iterator+2] == '#'): #101
                nextline += '#'
            elif (lastline[iterator] == '#' and lastline[iterator+1] == ' ' and lastline[iterator+2] == ' '): #100
                nextline += ' '
            elif (lastline[iterator] == ' ' and lastline[iterator+1] == '#' and lastline[iterator+2] == '#'): #011
                nextline += '#'
            elif (lastline[iterator] == ' ' and lastline[iterator+1] == '#' and lastline[iterator+2] == ' '): #010
                nextline += '#'
            elif (lastline[iterator] == ' ' and lastline[iterator+1] == ' ' and lastline[iterator+2] == '#'): #001
                nextline += '#'
            else: # (lastline[iterator-1] == ' ' and lastline[iterator] == ' ' and lastline[iterator+1] == ' '): #000
                nextline += ' '

        iterator += 1

    lastline = nextline
    time.sleep(0.02) 
```

# apache - htaccess RewriteRules 2 个子文件夹到 2 个单独的文件

> ID：14791808
> 
> 赞同：0
> 
> 时间：2013-02-09T21:29:15.010
> 
> 标签：apache, .htaccess, mod-rewrite

我正在尝试使用 htaccess 中的重写器将 2 个单独的虚拟目录重定向到文件

第**一个虚拟**目录是`admin`并且应该重定向到`admin.php`

`http://dev.int/shop/admin`>`http://dev.int/shop/admin.php/`

`http://dev.int/shop/admin/`>`http://dev.int/shop/admin.php/`

`http://dev.int/shop/admin/products`>`http://dev.int/shop/admin.php/products`

`http://dev.int/shop/admin/products/add`>`http://dev.int/shop/admin.php/products/add`

第二**个虚拟**目录是其他任何东西，应该重定向到`index.php`

`http://dev.int/shop/anything`>`http://dev.int/shop/index.php/anything`

`http://dev.int/shop/anything/else`>`http://dev.int/shop/index.php/anything/else`

还有一些其他标准，目录`assets`和`_test`文件`robots.txt`不`sitemap.xml`应该被重定向

这是我到目前为止所拥有的，但它不起作用:(

```
RewriteEngine on
RewriteCond $1 !^(assets|_test)
RewriteCond $1 !^(index\.php|admin\.php|robots\.txt|sitemap\.xml)
RewriteRule ^admin/?(.*)$ /shop/admin.php/$1 [L]
RewriteRule ^(?:admin)/?(.*)$ /shop/index.php/$1 [L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T00:25:24.200

You may try this:

```
Options +FollowSymlinks
RewriteEngine On
RewriteBase /

# "admin" string is present
RewriteCond %{REQUEST_URI} !(assets|_test|robots\.txt|sitemap\.xml)  [NC]
RewriteCond %{REQUEST_URI}  ^/shop/admin(.*)?/? [NC]
RewriteCond %{REQUEST_URI} !admin\.php          [NC]
RewriteRule .              shop/admin.php%1     [R=301,L]

# "admin" string is NOT present
RewriteCond %{REQUEST_URI} !(assets|_test|robots\.txt|sitemap\.xml|admin)  [NC]
RewriteCond %{REQUEST_URI}  ^/shop(.*)?/?       [NC]
RewriteCond %{REQUEST_URI} !index\.php          [NC]
RewriteRule .              shop/index.php%1     [R=301,L] 
```

When `admin` string is present after the `/shop/` folder, redirects permanently:

`http://dev.int/shop/admin/any/number/of/folders` with or without trailing slash.

To:

`http://dev.int/shop/admin.php/any/number/of/folders`

Replacing `admin` with `admin.php` in the path stream without any other modification.

* * *

When `admin` string is NOT present at all, redirects permanently:

`http://dev.int/shop/any/number/of/folders` with or without trailing slash.

To:

`http://dev.int/shop/index.php/any/number/of/folders`

Inserting `index.php` after the `/shop/` folder in the path stream without any other modification.

* * *

None of the above rules is applied when the incoming URL contains:

`assets`, `_test`, `robots.txt` or `sitemap.xml` in the path stream.

For silent mapping, remove `R=301` from `[R=301,L]`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T09:32:50.920

感谢@faa 的支持和指导。以下是工作答案。

```
RewriteEngine On

# backend
RewriteCond $1 !^(\.php)  [NC]
RewriteRule ^admin(.*)$ /itmanx/shop/draytek/admin.php$1 [R=301,L]

# frontend
RewriteCond $1 !^(index\.php|admin|assets|__test|robots\.txt|sitemap\.xml)  [NC]
RewriteRule ^(.*)$ /itmanx/shop/draytek/index.php/$1 [R=301,L] 
```

# mysql - 根据另一个表中的 id 存在更新 MySQL 表中的多行

> ID：14791811
> 
> 赞同：2
> 
> 时间：2013-02-09T21:29:26.863
> 
> 标签：mysql

我通常会以编程方式执行此操作，但今天我处于学习状态......我环顾四周，但没有发现任何与我的问题完全一样的东西。

我有两个表`item`,`person`和第三个包含关联的表 , `item_person`。不是每个人都有一个项目，因此该关联并不总是存在。现在，我想`status`在表中维护一个列，该列`item`部分基于一个项目是否与一个人相关联。所以...

```
Table: item
    item_id
    description
    status

Table: person
    person_id
    name

Table: item_person
    item_id
    person_id 
```

想象一下`UPDATE`，`1`如果关联存在于`item_person`......

*   是否有一个 MySQL 查询可以处理这个问题？

*   `UPDATE`如果关联不**存在**于`item_person`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T21:35:45.877

```
-- If the association exists...
update item i
join item_person ip
    on ip.item_id = i.item_id
set i.status = 1

-- If the association does not exist...
update item i
left join item_person ip
    on ip.item_id = i.item_id
set i.status = 0
where ip.item_id is null 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:34:07.863

1.  更新项目集 item_status = 1 其中存在 item_person.item = item.item_id
2.  更新项目集 item_status = 1 不存在 item_person.item = item.item_id

请注意，这两个查询都未经测试，因为我无法从这里访问 mysql 并且您没有给出[fiddle](http://sqlfiddle.com)。如果您需要帮助调试，请随时发表评论。

# smlnj - 如何对函数进行模式匹配？

> ID：14791813
> 
> 赞同：0
> 
> 时间：2013-02-09T21:29:29.343
> 
> 标签：smlnj

H，

我正在尝试进行模式匹配，但函数的输入是一个柯里化函数，你怎么能匹配这样的东西？

谁能给我一些例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:03:46.470

如果我对您的理解正确，那么您是在尝试对作为输入的函数进行模式匹配？

这是不可能的。函数没有结构，因此尝试这样做没有任何意义。

# android - Android：按下按钮时启动计算器

> ID：14791825
> 
> 赞同：1
> 
> 时间：2013-02-09T21:30:54.760
> 
> 标签：android, calculator

我正在开发一个应用程序，当用户单击计算器按钮时，我需要它启动 android 计算器。有没有办法做到这一点，还是我需要自己创建一个计算器？

如果我必须自己创建计算器，并且只在屏幕的特定部分显示，比如 android 计算器，这是什么类型的东西（显示对话框、弹出窗口、吐司等）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:38:36.457

您可以像这样启动计算器应用程序：

```
Intent i = new Intent(); 
i.setClassName("com.android.calculator2", "com.android.calculator2.Calculator"); 
startActivity(i); 
```

这样，您将在另一个包中启动 Activity，`setClassName(...)`将包和类作为参数。

请注意，这不适用于不使用默认计算器应用程序的设备。

# ios - 自动布局UILabels

> ID：14791831
> 
> 赞同：5
> 
> 时间：2013-02-09T21:31:28.107
> 
> 标签：ios, xcode, cocoa-touch, ios6, autolayout

`UILabels`我的自定义中有三个`UITableViewCell`。可能有些`UILabels`是空的（`label.text == @""`）

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"EventCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

        NSString *key = [[keysArray objectAtIndex:indexPath.section] description];

        UILabel *nameLabel = (UILabel *)[cell viewWithTag:100];
        namelabel.text = @"Label 1";

        UILabel *locationLabel = (UILabel *)[cell viewWithTag:101];
        location.text = @"Label 2";

        UILabel *timeLabel = (UILabel *)[cell viewWithTag:102];
        timeLabel.text = @"";

        return cell;
} 
```

如何`UILabels`使用自动布局在单元格中垂直居中所有非空？

**这是三个标签的样子**

![这是使用三个标签的外观：](../Images/100751775a2ba3af3802fccc1d985ec5.png)

**`UILables`其中一个为空时的外观**

![<code>UILables</code> 之一为空时的外观](../Images/d37bb999d1311f979fe009902565d5e1.png)

**这就是我希望它看起来的样子：**

![这就是我希望它看起来的样子：](../Images/63cefaf9a0e47b132824f4099425610d.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T09:26:37.703

这很难实现，但一个简单的捷径可能是使用单个标签，其中包含三行文本，限制为填充单元格的整个高度。然后标签将自动将其内容垂直居中。

您将在单元格上拥有三个字符串属性而不是三个标签，并且您的设置器将构建最终字符串（`\n`用于新行）并设置标签的文本。

如果每一行文本都有不同的样式，没问题，因为您可以使用属性字符串。

# php - 将网站 http 根目录指向带有 htaccess 的子文件夹？

> ID：14791835
> 
> 赞同：0
> 
> 时间：2013-02-09T21:31:51.923
> 
> 标签：php, regex, .htaccess, mod-rewrite, apache

如何使用 RewriteRule 将网站 http 根目录指向子文件夹？

我总是使用下面的规则，但现在升级到最新的 wamp 服务器后，它不再工作了。为什么？

```
RewriteRule ^/?$  local/applications/bin/oldsite/index.htm [L,QSA] 
```

例如，我想指出，

`http://mysite.com/`至`http://mysite.com/local/applications/bin/oldsite/index.htm`

或者在 localhost wamp 服务器中，应该是这样的，

`http://localhost/mysite/`至`http://localhost/mysite/local/applications/bin/oldsite/index.htm`

有任何想法吗？

并且，

`http://localhost/mysite/contact.htm`至 `http://localhost/mysite/local/applications/bin/oldsite/contact.htm`

`http://localhost/mysite/about.htm`至 `http://localhost/mysite/local/applications/bin/oldsite/about.htm`

**编辑**

我设法使用以下规则将其他页面指向特定位置，

```
RewriteRule ^([a-zA-Z0-9\-]+)\.htm/?$  local/applications/bin/oldsite/$1.htm [L,QSA] 
```

但我仍然无法指出

`http://localhost/mysite/`至`http://localhost/mysite/local/applications/bin/oldsite/index.htm`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T02:56:16.257

### 更新

你可以试试这个：

```
Options +FollowSymlinks
RewriteEngine On
RewriteBase /

#### localhost sets of rules
# No target file, go to index.php
RewriteCond %{HTTP_HOST}   localhost     [NC]
RewriteCond %{REQUEST_URI} ^/mysite/?$
RewriteCond %{REQUEST_URI} !index\.htm   [NC]
RewriteRule  .  mysite/local/applications/bin/oldsite/index.htm  [R=301,L]

# Target file, go to file
RewriteCond %{HTTP_HOST}     localhost     [NC]
RewriteCond %{REQUEST_URI}  ^/mysite/([^\.]+)\.htm [NC]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule  .  mysite/local/applications/bin/oldsite/%1.htm  [R=301,L]

#### Live site set of rules
RewriteCond %{HTTP_HOST}   (?:www\.)?mysite\.com  [NC]
RewriteCond %{REQUEST_URI} !index\.htm            [NC]
RewriteCond %{REQUEST_URI} ^/?$
RewriteRule  .  local/applications/bin/oldsite/index.htm [R=301,L] 
```

第一组规则适用于本地主机并永久重定向：

`http://localhost/mysite/filename.htm`

至：

`http://localhost/mysite/local/applications/bin/oldsite/filename.htm`

当`filename.htm`传入 URL 中不存在时，`filename.htm`替换 URL 中始终为`index.htm`

该字符串`mysite`被假定为固定字符串，而`filename`被假定为变量。

* * *

第二个规则集用于 Web 服务器，仅永久重定向

`http://mysite.com/`

至：

`http://mysite.com/local/applications/bin/oldsite/index.htm`

在最后一种情况下，如果传入 URL 包含任何其他路径，则不应用该规则。

对于静默映射，请`R=301`从`[R=301,L]`.

将上述规则集复制到本地和远程根目录中的 .htaccess 文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:12:32.830

这可能会让您开始（未经测试）：检查请求是否*不*指向特定子文件夹的条件。如果是这样，请将请求重定向到子文件夹。如果需要，您可以在目标中使用。如果更合适，您可以使用另一种来代替 HTTP 状态 301。

```
RewriteCond %{REQUEST_URI} !^/(local/applications/bin/oldsite/.*)$
RewriteRule ^(.*)$ http....n/subfolder/%1 [R=301,L] 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-09T21:51:53.727

似乎您想将“oldsite”目录设为您的[文档根](http://httpd.apache.org/docs/2.2/mod/core.html#documentroot)目录- 对吧？

# java - 有效的 Java - 尽管创建了多个实例，但相同的方法调用时间

> ID：14791836
> 
> 赞同：2
> 
> 时间：2013-02-09T21:32:09.690
> 
> 标签：java, performance, object, static

我正在学习有效的 Java，在本书的第 5 项中，Joshua Bloch 谈到了避免创建不必要的对象。一个示例演示了可变的 Date 对象，一旦它们的值被计算出来就永远不会被修改。

这里的“坏习惯”：

```
public Person(Date birthDate) {
    this.birthDate = new Date(birthDate.getTime());
}

// DON'T DO THIS!
public boolean isBabyBoomer() {
    // Unnecessary allocation of expensive object
    Calendar gmtCal = Calendar.getInstance(TimeZone.getTimeZone("GMT"));
    gmtCal.set(1946, Calendar.JANUARY, 1, 0, 0, 0);
    Date boomStart = gmtCal.getTime();
    gmtCal.set(1965, Calendar.JANUARY, 1, 0, 0, 0);
    Date boomEnd = gmtCal.getTime();
    return birthDate.compareTo(boomStart) >= 0
            && birthDate.compareTo(boomEnd) < 0;
} 
```

isBabyBoomer 方法在每次调用时都会不必要地创建一个新的 Calendar、TimeZone 和两个 Date 实例——这对我来说显然是有意义的。

这里是改进的代码：

```
public Person(Date birthDate) {
    this.birthDate = new Date(birthDate.getTime());
}

/**
 * The starting and ending dates of the baby boom.
 */
private static final Date BOOM_START;
private static final Date BOOM_END;

static {
    Calendar gmtCal = Calendar.getInstance(TimeZone.getTimeZone("GMT"));
    gmtCal.set(1946, Calendar.JANUARY, 1, 0, 0, 0);
    BOOM_START = gmtCal.getTime();
    gmtCal.set(1965, Calendar.JANUARY, 1, 0, 0, 0);
    BOOM_END = gmtCal.getTime();
}

public boolean isBabyBoomer() {
    return birthDate.compareTo(BOOM_START) >= 0
            && birthDate.compareTo(BOOM_END) < 0;
} 
```

Calendar、TimeZone 和 Date 实例在初始化时只创建一次。`isBabyBoomer()`Bloch 解释说，如果频繁调用该方法，这会显着提高性能。

在他的机器上：
错误版本：1000 万次调用需要 32,000 毫秒
改进版本：1000 万次调用需要 130毫秒

但是当我在我的系统上运行示例时，性能完全相同（14 毫秒）。这是实例只创建一次的编译器功能吗？

编辑：
这是我的基准：

```
 public static void main(String[] args) {
    Calendar cal = Calendar.getInstance();
    cal.set(1960, Calendar.JANUARY, 1, 1, 1, 0);
    Person p = new Person(cal.getTime());
    long startTime = System.nanoTime();
    for (int i = 0; i < 10000000; i++) {
        p.isBabyBoomer();
    }
    long stopTime = System.nanoTime();
    long elapsedTime = stopTime - startTime;
    double mseconds = (double) elapsedTime / 1000000.0;
    System.out.println(mseconds);
} 
```

干杯，马库斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T21:53:25.933

你的基准是错误的。使用最新的 Java 7 和适当的预热，我得到了两种方法之间的巨大差异：

```
Person::main: estimatedSeconds 1 = '8,42'
Person::main: estimatedSeconds 2 = '0,01' 
```

这是完整的可运行代码：

```
import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

public class Person {
    private Date birthDate;
    static Date BOOM_START;
    static Date BOOM_END;

    public Person(Date birthDate) {
        this.birthDate = new Date(birthDate.getTime());
    }

    static {
        Calendar gmtCal = Calendar.getInstance(TimeZone.getTimeZone("GMT"));
        gmtCal.set(1946, Calendar.JANUARY, 1, 0, 0, 0);
        BOOM_START = gmtCal.getTime();
        gmtCal.set(1965, Calendar.JANUARY, 1, 0, 0, 0);
        BOOM_END = gmtCal.getTime();
    }

    public boolean isBabyBoomerWrong() {
        // Unnecessary allocation of expensive object
        Calendar gmtCal = Calendar.getInstance(TimeZone.getTimeZone("GMT"));
        gmtCal.set(1946, Calendar.JANUARY, 1, 0, 0, 0);
        Date boomStart = gmtCal.getTime();
        gmtCal.set(1965, Calendar.JANUARY, 1, 0, 0, 0);
        Date boomEnd = gmtCal.getTime();
        return birthDate.compareTo(boomStart) >= 0
                && birthDate.compareTo(boomEnd) < 0;
    }

    public boolean isBabyBoomer() {
        return birthDate.compareTo(BOOM_START) >= 0
                && birthDate.compareTo(BOOM_END) < 0;
    }

    public static void main(String[] args) {
        Person p = new Person(new Date());

        for (int i = 0; i < 10_000_000; i++) {
            p.isBabyBoomerWrong();
            p.isBabyBoomer();
        }

        long startTime = System.nanoTime();

        for (int i = 0; i < 10_000_000; i++) {
            p.isBabyBoomerWrong();
        }

        double estimatedSeconds = (System.nanoTime() - startTime) / 1000000000.0;
        System.out.println(String.format("Person::main: estimatedSeconds 1 = '%.2f'", estimatedSeconds));

        startTime = System.nanoTime();

        for (int i = 0; i < 10_000_000; i++) {
            p.isBabyBoomer();
        }

        estimatedSeconds = (System.nanoTime() - startTime) / 1000000000.0;
        System.out.println(String.format("Person::main: estimatedSeconds 2 = '%.2f'", estimatedSeconds));

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T22:04:07.340

你的问题原来只是另一个错误的微基准测试。

但是，在某些特殊情况下（主要是简单的数据保存类），确实存在一种 JVM 优化，它丢弃了大多数对象实例化。您可能想查看下面的链接。

那里描述的方法显然不适用于您的情况，但它可能会在其他一些奇怪的情况下有所不同，其中对象实例化似乎没有任何时间。因此，当您实际遇到问题的工作示例时，请记住这一点：

*   [标量替换：java 虚拟机中的自动堆栈分配 (stefankrause.net)](http://www.stefankrause.net/wp/?p=64)
*   [分配比您想象的要快，而且越来越快 (ibm.com/developerworks)](http://www.ibm.com/developerworks/java/library/j-jtp09275/index.html)。

最相关的部分：

> 返回复合值的典型防御性复制方法（不要真正担心代码，只是在调用`Point`方法时将实例化并通过 getter 方法访问 `getDistanceFrom()`）：
> 
> ```
> public class Point {
>     private int x, y;
>     public Point(int x, int y) {
>         this.x = x; this.y = y;
>     }
>     public Point(Point p) { this(p.x, p.y); }
>     public int getX() { return x; }
>     public int getY() { return y; }
> }
> 
> public class Component {
>     private Point location;
>     public Point getLocation() { return new Point(location); }
>     public double getDistanceFrom(Component other) {
>         Point otherLocation = other.getLocation();
>         int deltaX = otherLocation.getX() - location.getX();
>         int deltaY = otherLocation.getY() - location.getY();
>         return Math.sqrt(deltaX*deltaX + deltaY*deltaY);
>     }
> } 
> ```
> 
> 该`getLocation()`方法不知道它的调用者将如何处理`Point`它返回的；它可能会保留对它的引用，例如将其放入集合中，因此进行了`getLocation()`防御性编码。但是在这个例子中，`getDistanceFrom()`不会这样做；它只是要使用`Point`一小段时间然后丢弃它，这似乎是在浪费一个完美的对象。
> 
> 智能 JVM 可以看到正在发生的事情并优化防御性副本的分配。首先，对的调用`getLocation()`将被内联，对`getX()`和的调用也将被内联，`getY()`从而 `getDistanceFrom()`有效地表现如下：
> 
> （描述应用内联优化结果的伪代码`getDistanceFrom()`）
> 
> ```
> public double getDistanceFrom(Component other) {
>     Point otherLocation = new Point(other.x, other.y);
>     int deltaX = otherLocation.x - location.x;
>     int deltaY = otherLocation.y - location.y;
>     return Math.sqrt(deltaX*deltaX + deltaY*deltaY);
> } 
> ```
> 
> 此时，逃逸分析可以表明，第一行分配的对象永远不会从其基本块中逃逸，也 `getDistanceFrom()`不会修改其他组件的状态。（通过转义，我们的意思是对它的引用不会存储到堆中或传递给可能保留副本的未知代码。）鉴于它 `Point`是真正的线程本地的，并且已知它的生命周期受基本块的限制它被分配，它可以被堆栈分配或完全优化，如下所示：
> 
> 描述优化分配结果的伪代码 `getDistanceFrom()`：
> 
> ```
> public double getDistanceFrom(Component other) {
>     int tempX = other.x, tempY = other.y;
>     int deltaX = tempX - location.x;
>     int deltaY = tempY - location.y;
>     return Math.sqrt(deltaX*deltaX + deltaY*deltaY);
> } 
> ```
> 
> 结果是，如果所有字段都是公共的，我们将获得完全相同的性能，同时保持封装和防御性复制（以及其他安全编码技术）给我们的安全性。

# c# - 在特定坐标处打印出一个字符串，c# Console Application

> ID：14791838
> 
> 赞同：2
> 
> 时间：2013-02-09T21:32:33.240
> 
> 标签：c#, string, printing

我想创建一个在任何给定坐标处打印出字符串的程序。我有一个主类和一个我创建的名为 ConsoleText 的类。以下是每个类的代码：

```
class ConsoleText
{
    public int x, y; // Coordinates
    public string Text = "Hello!";
    ConsoleColor color;

    public ConsoleText(int x, int y, string Text)
    {
        Console.ForegroundColor = color;
        Console.SetCursorPosition(x, y);
        Console.Write(Text);
        Console.ResetColor();
    }
} 
```

这是程序（主）类：

```
class Program
{
    static void Main(string[] args)
    {
        ConsoleText obj = new ConsoleText(19, 1, "Hello!");
        Console.Read();
    }
} 
```

我现在的问题是，当我调试程序时，我得到了坐标的位置，但是字符串并没有在那个特定的坐标处写出。关于我可能做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:37:37.610

以下代码非常适合我：

```
Console.SetCursorPosition(20, 0);
Console.WriteLine("Hello");
Console.SetCursorPosition(20, 2);
Console.WriteLine("World");
Console.ReadLine(); 
```

您可能想探索为什么要使用自定义类。

编辑：此外，ConsoleObj 类中 x 和 y 的值从未被引用。只是指出这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T21:55:11.557

尝试更改此行：

```
Console.ForegroundColor = color; 
```

对此：

```
Console.ForegroundColor = ConsoleColor.Gray; 
```

您无意中将前景色设置为黑色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T22:49:16.263

如果我理解您的问题，您正在尝试同时打印*消息*和*协调*。

```
 class Program
    {
        static void Main(string[] args)
        {
            ConsoleText(19, 1, "Hello!");
            Console.Read();
        }
    }

    public static void ConsoleText(int x, int y, string Text)
    {
        Console.ForegroundColor = ConsoleColor.Red;
        Console.SetCursorPosition(x, y);
        Console.Write(string.Format("x:{0}, y:{1}, message:{2}", x, y, Text));
        Console.ResetColor();
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T21:40:31.973

查看 MSDN 中的[SetCursorPosition](http://msdn.microsoft.com/en-us/library/system.console.setcursorposition.aspx) API 文档。显然，光标位置必须相对设置。使用 Console.Clear() 重置光标位置，然后获取顶部、左侧。API Doc 展示了如何做到这一点。

```
Console.SetCursorPosition(x + ConsoleCursor.Left, y + ConsoleCursor.Top); 
```

# coffeescript - 使用 Grunt 连接和缩小 RequireJS

> ID：14791840
> 
> 赞同：7
> 
> 时间：2013-02-09T21:32:42.290
> 
> 标签：coffeescript, requirejs, gruntjs

我有一个使用 AngularJS 用 CoffeeScript 编写的项目。我的供应商依赖项是使用 Bower 安装的，我的文件结构是这样的：

```
- assets
 - js
  - app
   - model
    - *.coffee
   - factory
    - *.coffee
   ...
   - app.coffee
   - config.coffee
   - routes.cofeee
  - vendor
   - angular
   - lodash
   ...
  - dist 
```

我想要做的是以下几点：

1.  我正在尝试弄清楚如何使用 RequireJS`r.js`来优化我的应用程序文件，以便我基本上得到一个有序的串联文件（因此供应商依赖项、我的配置和路由，以及我的应用程序文件）。
2.  将其集成到我的 Grunt 文件中。

我试过使用`r.js`优化器，但也许我太傻了，因为它似乎只是将我的应用程序文件（减去供应商依赖项）复制到 dist 文件夹中；但是，它确实设法优化了`coffee`生成的`js`文件。

有没有人有这方面的经验？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-10T09:18:24.143

我想通了：`r.js`通过阅读您`mainConfigFile`的配置和您在配置中命名的任何模块来工作，这里的重要注意事项是`r.js`只查看您命名模块中的第一个`require`/`define`并开始寻找它们；因此，例如，我有一个名为的模块`app`：

```
require ['config'], (cfg) ->
  require ['angular'], (A) ->
    A.module cfg.ngApp, []

    require ['routes'], () ->
      require [
        'factory/a-factory',

        'service/a-service',

        'controller/a-controller'
      ], () ->
        A.bootstrap document, [cfg.ngApp] 
```

这里的问题是`r.js`从未通过第一个`require`语句，因此连接不起作用。当我将其更改为（我的`app.coffee`）时：

```
require ['config'], (cfg) ->
  require ['angular'], (A) ->
    A.module cfg.ngApp, []

    require ['bootstrap'], (bootstrap) ->
      bootstrap() 
```

我的`bootstrap.coffee`：

```
define [
  'config',
  'angular',
  'routes',

  'factory/a-factory',

  'service/a-service',

  'controller/a-controller'
], (cfg, A, routes) ->
  class Bootstrap
    constructor: () ->
      routes()

      A.bootstrap document, [cfg.ngApp] 
```

这意味着我只需要在我的配置中定义`angular`和，然后就可以完成其余的工作，如下所示：`bootstrap``r.js``includes``r.js`

```
baseUrl: 'assets/js/app',
mainConfigFile: 'assets/js/app/config.js',
name: 'app',
include: [
  '../vendor/requirejs/require',
  'bootstrap'
],
out: 'assets/js/dist/app.js' 
```

现在一切正常！~~很遗憾，我不得不告诉`r.js`包括在内`requirejs`，也许我在那里做了一些愚蠢的事情？~~

**天哪，我真是个笨蛋！**

因此，在我的 HTML 中，我将连接的脚本加载为：

```
<script src="assets/js/dist/app.js"></script> 
```

当它真的*应该*像这样加载时：

```
<script src="assets/js/vendor/requirejs/require.js" data-main="assets/js/dist/app"></script> 
```

哦！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-23T00:42:30.250

**来自 r.js 文档**

[https://github.com/jrburke/r.js/blob/master/build/example.build.js#L322](https://github.com/jrburke/r.js/blob/master/build/example.build.js#L322)

嵌套依赖可以捆绑在 requireJS > v1.0.3

```
//Finds require() dependencies inside a require() or define call. By default
//this value is false, because those resources should be considered dynamic/runtime
//calls. However, for some optimization scenarios, it is desirable to
//include them in the build.
//Introduced in 1.0.3\. Previous versions incorrectly found the nested calls
//by default.
findNestedDependencies: false, 
```

# eclipse - Eclipse 添加 Tomcat 7 空白服务器名称

> ID：14791843
> 
> 赞同：264
> 
> 时间：2013-02-09T21:32:46.263
> 
> 标签：eclipse, jakarta-ee, tomcat

我试图在 Ubuntu 的 Eclipse 中添加 Tomcat 7。当我在 Eclipse 中单击“添加新服务器”并选择“Tomcat v7.0 服务器”时，“服务器名称”字段为空白，我无法在该文本框中输入任何内容，如下所示：

![Eclipse 添加 Tomcat 服务器](../Images/6f8c4fb81e0699e0ab1f67e3aff61f9f.png)

我之前所做的是我从 Eclipse 中删除了一个 Tomcat 7 服务器，我试图重新安装 Tomcat 7。但它不允许我在该文本框中输入任何内容，并且我无法继续到“下一步”按钮。我的环境是 Ubuntu Linux 和 Eclipse for JavaEE。

* * *

## 回答 #1

> 赞同：538
> 
> 时间：2013-03-01T17:26:07.757

这是 Eclipse 中的一个错误。我也遇到了同样的问题，在带有 Eclipse Java EE Juno 的 Ubuntu 上也是如此。

这是对我有用的解决方法：

1.  关闭日食
2.  在`{workspace-directory}/.metadata/.plugins/org.eclipse.core.runtime/.settings`删除以下两个文件：
    *   `org.eclipse.wst.server.core.prefs`
    *   `org.eclipse.jst.server.tomcat.core.prefs`
3.  重启 Eclipse

来源：[eclipse.org 论坛](http://www.eclipse.org/forums/index.php/t/453143/)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-02-27T20:36:25.247

我在 ubuntu 中运行开普勒，并且在让 eclipse 识别 tomcat7 服务器时遇到了同样的问题。我的安装目录路径很好，只是删除/重命名文件也没有修复它。

这对我有用：

在终端中运行以下命令：

```
cd ~/workspace/.metadata/.plugins/org.eclipse.core.runtime/.settings/    
rm org.eclipse.jst.server.tomcat.core.prefs    
rm org.eclipse.wst.server.core.prefs
cd /usr/share/tomcat7
sudo service tomcat7 stop
sudo update-rc.d tomcat7 disable
sudo ln -s /var/lib/tomcat7/conf conf
sudo ln -s /etc/tomcat7/policy.d/03catalina.policy conf/catalina.policy
sudo ln -s /var/log/tomcat7 log
sudo chmod -R 777 /usr/share/tomcat7/conf
sudo ln -s /var/lib/tomcat7/common common
sudo ln -s /var/lib/tomcat7/server server
sudo ln -s /var/lib/tomcat7/shared shared 
```

重启eclipse，删除tomcat7服务器。重新添加服务器，然后一切正常。

这是我使用的链接。 [http://linux.mjnet.eu/post/1319/tomcat-7-ubuntu-13-04-and-eclipse-kepler-problem-to-run/](http://linux.mjnet.eu/post/1319/tomcat-7-ubuntu-13-04-and-eclipse-kepler-problem-to-run/)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-07-06T13:26:10.043

*除了“服务器名称”字段被禁用*之外，我遇到了类似的问题。

发现这是由于 Apache Tomcat v7.0 运行时环境指向了错误的文件夹。通过转到 Window - Preferences - Server - Runtime Environments，单击运行时环境条目并单击“编辑...”，然后修改 Tomcat 安装目录，可以解决此问题。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-03-24T04:02:19.477

**我之前遇到过同样的问题：使用 eclipse 配置时服务器名称没有出现在服务器中**

**我尝试了这里提供的所有解决方案，但它们对我不起作用。**

> 我通过简单地遵循这些简单的提示解决了它
> 
> Step1: Windows --> Preferences --> Server --> Run time Environments --> Add --> 选择之前不可用的tomcat版本 --> next --> 浏览相同版本的服务器位置
> 
> 步骤2：转到服务器并选择您的服务器版本-->下一步-->完成
> 
> 问题解决了！！！:)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-11-12T07:25:57.333

我遇到了同样的问题，我将工作区更改为新位置，并且它起作用了。我希望这有帮助 ：）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-12-17T15:54:30.627

太奇怪了，但这对我有用。

1.  关闭日食

2.  开始日食`eclipse --clean`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-02-17T11:23:56.633

在尝试**了@Philipp Claßen**步骤之后，即使当时没有用，

**更改 eclipse、workspace 和 tomcat 目录。**[仅针对 Windows7 测试]

我知道有人可能会说这是不正确的，但是在@Phillipp 的步骤对我不起作用之后，这确实对我有用。

我花了 4 个小时才找到这个蛮力方法的解决方案。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-06-30T05:47:57.513

我今天也遇到了这个问题，删了文件`org.eclipse.jst.server.tomcat.core.prefs`也`org.eclipse.wst.server.core.prefs`没用。

最后我发现它的权限问题：

默认情况下`<apache-tomcat-version>/conf/*`只能由所有者阅读，在我让它对所有人都可读之后，它就可以工作了！所以运行这个命令：

```
chmod a+r <apache-tomcat-version>/conf/* 
```

这是我找到根本原因的链接：

[http://www.thecodingforums.com/threads/eclipse-cannot-create-tomcat-server.953960/#post-5058434](http://www.thecodingforums.com/threads/eclipse-cannot-create-tomcat-server.953960/#post-5058434)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-02-25T00:01:18.613

在我的例子中，tomcat 目录归 root 所有，我没有以 root 身份运行 eclipse。

所以我不得不

```
sudo chown -R  $USER apache-tomcat-VERSION/ 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-06-20T16:10:12.007

最简单的解决方案是在 eclipse/STS 中创建一个新的工作区。

```
File -> Switch Workspace -> Others... 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-01-26T04:08:31.570

删除/移动文件 org.eclipse.jst.server.tomcat.core.prefs 和 org.eclipse.wst.server.core.prefs 对我有用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-05-29T09:59:35.210

在带有 Tomcat 8.0 的 Ubuntu 17.04 上的 Eclipse Neon.3 Release (4.6.3) 中，问题仍然存在。对我有帮助的是删除首选项文件的组合：

```
rm ~/workspace/.metadata/.plugins/org.eclipse.core.runtime/.settings/org.eclipse.jst.server.tomcat.core.prefs    
rm ~/workspace/.metadata/.plugins/org.eclipse.core.runtime/.settings/org.eclipse.wst.server.core.prefs 
```

并链接到`catalina.policy`（与@michael-brooks 为他的配置建议的方式有些不同）：

```
sudo ln -s /var/lib/tomcat8/policy/catalina.policy conf/catalina.policy 
```

# antlr4 - TestRig - 从 TDA4R 第 1 章运行示例

> ID：14791845
> 
> 赞同：2
> 
> 时间：2013-02-09T21:33:10.903
> 
> 标签：antlr4

多年来，我在 ANTLR3 上花费了很多时间，我非常希望 ANTLR4 能够正常工作。我从 TDA4R 书第 1 章中的示例开始。我到了尝试运行TestRig的地步，我得到了......

```
C:\ANTLR4\tpantlr2-code\code\install>java -cp C:\ANTLR4\antlr-4.0-complete.jar;
org.antlr.v4.runtime.misc.TestRig Hello r -tokens
Exception in thread "main" java.lang.UnsupportedClassVersionError: HelloLexer :
Unsupported major.minor version 51.0 
```

我正在运行 Windows 7 - 64 位，但我认为 jar 文件是 32 位的。这可能是问题吗？还是我没有使用正确的 Java 版本 - java version = "1.6.0_24"？

我该怎么办？我真的不想编译整个系统。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T22:53:31.953

使用 java 1.7.0_13 或更新版本。如果您将 NetBeans 与 antlrworks2 插件一起使用，则必须完全使用“NetBeans 7.3 Beta 2”。如果您发现其他问题，此讨论可能会有所帮助： [NoClassDefFoundError: wrong name](https://stackoverflow.com/questions/7509295/noclassdeffounderror-wrong-name)

# php - 使用 htacess 将 ical 文件同步到 iOS 设备保护

> ID：14791846
> 
> 赞同：0
> 
> 时间：2013-02-09T21:33:13.630
> 
> 标签：php, ios, lamp, icalendar

我在服务器上生成了一个 ical 文件。我希望它与 ios 设备同步。如果保持打开状态，它可以正常工作，但是一旦我添加了类似 htaccess 文件的内容，它就会中断。

是否可以与 iphone 同步 ical 文件并在幕后提供某种身份验证以保护 ics 文件。我在 LAMP 环境中。

谢谢，巴特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:39:48.170

您似乎拥有[PHP](http://php.net)及其简单的[基本身份验证设置](http://php.net/manual/en/features.http-auth.php)。请注意，这不是特别安全，但它会完成这项工作：

```
<?php
if (!isset($_SERVER['PHP_AUTH_USER'])) {
    header('WWW-Authenticate: Basic realm="My Realm"');
    header('HTTP/1.0 401 Unauthorized');
    echo 'Text to send if user hits Cancel button';
    exit;
} else {
  # lookup $_SERVER['PHP_AUTH_USER'] and the hash of {$_SERVER['PHP_AUTH_PW']} on the backend.
  # return the contents of your ical file
} 
```

我希望这会有所帮助，如果没有，请留下评论说明需要澄清的内容，我将添加相关代码。

# jquery - Symfony 1.4 jQuery 不知道用户是否因为缓存而登录？

> ID：14791852
> 
> 赞同：0
> 
> 时间：2013-02-09T21:34:04.097
> 
> 标签：jquery, symfony-1.4, sfguard

我对通过 jQuery 进行的图像评论有疑问。当我发现动作被缓存时，当 jQuery 调用动作时，由于缓存，它不知道 sfGaurd 用户已通过身份验证，因此我无法在没有 user_id 的情况下插入评论（关系问题）

所以这是它的完成方式：

路由：

```
commentimage:
  url:     /commentimage/:image_id.:sf_format
  class:   sfDoctrineRoute
  options: { model: imagecomments, type: object }
  param:   { module: profile, action: commentimage, sf_format: html }
  requirements:
    id: \d+
    sf_method: [get, post]
    sf_format: (?:html|js) 
```

行动 ：

```
public function executeCommentimage(sfWebRequest $request)  {

    $imgId   = $request->getParameter('image_id');
    $commentPost = $request->getParameter('comment');

    $user_id = $this->getContext()->getUser()->getAttribute('user_id','','sfGuardSecurityUser');

    $comment = new Imagecomments();

    $comment->setComment($commentPost);
    $comment->setImageId($imgId);
    $comment->setProfileId($user_id);
    $comment->setFirmbrandId(1);
    $comment->setPublished(1);
    $comment->save();

    $this->setLayout(false);      
} 
```

模板/表格：

```
 <form name="form" id="form<?php echo $photo->getId();?>" method="POST">
   <input type="hidden" id="image_id" name="image_id" value="<?php echo $photo->getId();?>" />
   <input type="text" id="comment" name="comment" value="" />
   <button name="submit" class="submit botunlink">KOMENTIRAJ</button>
 </form> 
```

和 jQuery：

```
$(".submit").click(function(e){
        e.preventDefault();
        var parent = $(this).parent();
        var imageId = get_numbers(parent.attr('id'));
        var theexactForm = "#form"+imageId;
        $(theexactForm).submit(function() {
            alert($(this).serialize());
            return false;
          });
        $.ajax({
           data: $(theexactForm).serialize(),
           url: 'http://partytime.hr/commentimage/'+imageId,
           type: "POST", 
           success: function () {
               $("#allComments"+imageId).html("");
               $("#allComments"+imageId).load("http://partytime.hr/showimagecomments/"+imageId);
               //alert('imageID||'+imageId+'Forma||'+theexactForm+'COMMENT:'+data);
           },
           complete: function() { 
            //$(".allComments").mCustomScrollbar();
        }
        });
         return false;
    }); 
```

当我登录并清除 symfony 缓存时它可以工作，但后来它不会工作，因为它无法更新 PROFILE_ID 因为缓存说它没有登录（这是我的结论）。

我怎样才能解决这个问题？

# ruby - RSepc 测试显示“待处理”，但我没有待处理的命令

> ID：14791856
> 
> 赞同：0
> 
> 时间：2013-02-09T21:34:23.097
> 
> 标签：ruby, rspec

我刚拿起一本 RSpec 书来阅读，我有这个例子，都在一个文件中：

```
class RSpecGreeter
  def greet
    'howdy purdy'
  end
end

describe 'RSpec Greeter' do
  it 'should say howdy purdy when it receives the greet() message'
    greeter = RSpecGreeter.new
    greeting = greeter.greet
    greeting.should == 'howdy purdy'
end 
```

所以当我运行它时，这本书说它应该通过并且它是有道理的，它应该通过。但对我来说，它显示为“待定”

> 待定：RSpec Greeter 在收到 greet() 消息时应该说再见 purdy # 尚未实现 # ./greeter_spec.rb:8
> 
> 在 0.00012 秒内完成 1 个示例，0 个失败，1 个待处理

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T21:52:10.313

这是因为您没有将 it 语句包装在一个块中。为了纠正这个你写

```
describe 'RSpec Greeter' do
  it 'should say howdy purdy when it receives the greet() message' do
    greeter = RSpecGreeter.new
    greeting = greeter.greet
    greeting.should == 'howdy purdy'
  end
end 
```

有关[未决示例](https://github.com/dchelimsky/rspec/wiki/Pending-Examples)的更多信息。

[还有更高级的未决测试](https://www.relishapp.com/rspec/rspec-core/v/2-0/docs/pending/pending-examples)示例。

# javascript - 跨多个页面的草坪椅

> ID：14791857
> 
> 赞同：1
> 
> 时间：2013-02-09T21:34:26.423
> 
> 标签：javascript, json, lawnchair

我一直在 phonegap 中使用 Lawnchair，但只能将数据加载到保存的同一页面上。

这就是草坪椅的工作原理吗？

我已经尝试使用 console.log 在保存数据的页面上记录我使用 Lawnchair 保存的数据，但是一旦我移动到具有相同检索代码的另一个页面，它就不会显示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T09:57:10.350

在构建基于本地存储的两页 HTML5“应用程序”时，我遇到了类似的问题。

`lawnchair.js`我犯了一个错误，没有在文件旁边包含“dom”插件。（我认为它已经以某种方式内置，`Lawnchair`因为它是默认存储系统）。

[请参阅这篇文章](http://brian.io/lawnchair/downloads/)的第一段..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T11:15:17.303

这是一个例子：

```
var res = Lawnchair({name:'key',adapter:'dom'},function(e){
});

res.all(function(data){
    for(var i = 0; i<data.length;i++)
    {
      Get data using data[i].value.fieldname.....
    }
  });
}); 
```

# ruby-on-rails - 多态关联的质量分配错误

> ID：14791859
> 
> 赞同：1
> 
> 时间：2013-02-09T21:34:37.017
> 
> 标签：ruby-on-rails, model, associations, polymorphic-associations, mass-assignment

为 has_one 多态模型提交嵌套表单时出现批量分配错误。该表单试图基于[多态关联 Rails 指南](http://edgeguides.rubyonrails.org/association_basics.html#polymorphic-associations)创建 Employee 和 Picture 实例。

对于 has_one 多态模型的嵌套创建表单的**任何**功能示例，我将不胜感激！我知道有大量关于批量分配错误的问题，但我从未见过多态关联的工作示例。

**楷模**

```
class Picture < ActiveRecord::Base
    belongs_to :illustrated, :polymorphic => true
    attr_accessible :filename, :illustrated
end

class Employee < ActiveRecord::Base
    has_one :picture, :as => :illustrated
    accepts_nested_attributes_for :picture
    attr_accessible :name, :illustrated_attribute
end 
```

**迁移**

```
create_table :pictures do |t|
    t.string :filename
    t.references :illustrated, polymorphic: true
end

create_table :employees do |t|
    t.string :name
end 
```

**控制器/employees_controller.rb**

```
...
def new
    @employee = Employee.new
    @employee.picture = Picture.new
end

def create
    @employee = Employee.new(params[:employee])
    @employee.save
end
... 
```

**错误**

```
Can't mass-assign protected attributes: illustrated

app/controllers/employees_controller.rb:44:in `create'

{"utf8"=>"✓", "authenticity_token"=>"blah"
 "employee"=>{"illustrated"=>{"filename"=>"johndoe.jpg"},
 "name"=>"John Doe"},
 "commit"=>"Create Employee"} 
```

在模型中，我尝试了 :illustrated、:picture、:illustrated_attribute、:illustrated_attributes、:picture_attribute、:picture_attributes 等的所有排列。有什么提示或示例吗？

编辑：

**_form.html.erb**

```
<%= form_for(@employee) do |f| %>

  <%= f.fields_for :illustrated do |form| %>
    <%= form.text_field :filename %>
  <% end %>

    <%= f.text_field :name %>
    <%= f.submit %>

<% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T22:28:43.453

You need to specify the nested_attributes appropriately. `accepts_nested_attributes_for` takes the name of the association as parameter and then you need to add the same `assoc_attributes` to your `attr_accessible`. So change your Employee model to

```
class Employee < ActiveRecord::Base
  has_one :picture, :as => :illustrated
  accepts_nested_attributes_for :picture
  attr_accessible :name, :picture_attribute
end 
```

And change the `field_for` line in the view code to

```
<%= f.fields_for :picture do |form| %> 
```

# scala - 使用 scala 提取器将字符串转换为 Int

> ID：14791861
> 
> 赞同：2
> 
> 时间：2013-02-09T21:34:44.883
> 
> 标签：scala, type-conversion, implicit-conversion, unapply

我正在尝试`String`使用`Int`提取器。我的代码如下所示。

```
object Apply {
  def unapply(s: String): Option[Int] = try {
    Some(s.toInt)
  } catch {
    case _: java.lang.Exception => None
  }
}

object App {
  def toT[T](s: AnyRef): Option[T] = s match {
    case v: T => Some(v)
    case _ => None
  }
  def foo(param: String): Int = {
    //reads a Map[String,String] m at runtime
    toT[Int](m("offset")).getOrElse(0)
  }
} 
```

我收到运行时错误：`java.lang.String cannot be cast to java.lang.Integer`. 似乎根本没有使用提取器。我应该怎么办？

**编辑：**我的用例如下。我正在使用 play，我想解析在 url 中传递的查询字符串。我想获取查询字符串值（String）并将其用作 Int、Double 等。例如，

```
val offset = getQueryStringAs[Int]("offset").getOrElse(0) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T22:34:40.450

我认为这里最大的问题是，您似乎混淆了转换和转换。您有 a `Map[String, String]`，因此您不能将值转换为`Int`. 你必须转换它们。幸运的是，Scala`toInt`通过对 StringOps 的隐式转换将该方法添加到字符串中。

这应该适合你：

```
m("offset").toInt 
```

请注意，如果字符串无法转换为整数，`toInt`则会抛出 a 。`java.lang.NumberFormatException`

**编辑**：

您想要的将 afaik 仅适用于类型类。

这是一个例子：

```
trait StringConverter[A] {
  def convert(x: String): A
}

implicit object StringToInt extends StringConverter[Int] {
  def convert(x: String): Int = x.toInt
}

implicit object StringToDouble extends StringConverter[Double] {
  def convert(x: String): Double = x.toDouble
}

implicit def string2StringConversion(x: String) = new {
  def toT[A](implicit ev: StringConverter[A]) = ev.convert(x)
} 
```

用法：

```
scala> "0.".toT[Double]
res6: Double = 0.0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T22:12:30.507

您的代码中存在问题，您应该收到编译器警告：

```
def toT[T](s: AnyRef): Option[T] = s match {
  case v: T => Some(v) // this doesn't work, because T is erased
  case _ => None
} 
```

现在......应该在哪里`Apply`使用？我看到它声明了，但我没有看到它在任何地方使用。

**编辑**

关于警告，请查看Stack Overflow 上关于*类型擦除的讨论。*例如，我写的[这个答案](https://stackoverflow.com/a/1094214/53013)是关于如何绕过它——尽管它现在已被 Scala 2.10.0 弃用。

为了解决你的问题，我会使用类型类。例如：

```
abstract class Converter[T] {
  def convert(s: String): T
}

object Converter {
  def toConverter[T](converter: String => T): Converter[T] = new Converter[T] {
    override def convert(s: String): T = converter(s)
  }

  implicit val intConverter = toConverter(_.toInt)
  implicit val doubleConverter = toConverter(_.toDouble)
} 
```

然后你可以像这样重写你的方法：

```
val map = Map("offset" -> "10", "price" -> "9.99")

def getQueryStringAs[T : Converter](key: String): Option[T] = {
  val converter = implicitly[Converter[T]]
  try {
    Some(converter convert map(key))
  } catch {
    case ex: Exception => None
  }
} 
```

正在使用：

```
scala> getQueryStringAs[Int]("offset")
res1: Option[Int] = Some(10)

scala> getQueryStringAs[Double]("price")
res2: Option[Double] = Some(9.99) 
```

# php - 本地主机渲染页面很慢

> ID：14791862
> 
> 赞同：5
> 
> 时间：2013-02-09T21:34:45.460
> 
> 标签：php, apache, pdo, localhost

我的本地主机渲染页面很慢。一切甚至简单的 html 渲染都需要大约 2-5 秒。我对其进行了研究并通过替换来修复它：

```
new \PDO(... ':host=localhost' ...); 
```

至

```
new \PDO(... ':host=127.0.0.1' ...); 
```

任何人都可以向我解释或给我一个链接来阅读为什么 localhost 变慢以及如何将其更改为 IP 使其非常快。现在，它甚至可以在不到一秒的时间内呈现复杂的查询，而之前它需要大约 5-10 秒。

用 IP 替换 localhost 是否有任何安全问题？我的意思是，如果我实时托管我的项目并将 localhost 替换为主机的 IP，它会影响任何类型的安全性吗？

多谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T21:39:42.713

我认为这可能与在您运行脚本的服务器上启用 IPv6 有关。我对网络话题不是很擅长，但是这样的问题已经讨论过好几次了。

我找了一篇可以给出更好解释的文章，我想我找到了一篇：[MySQL and Localhost Performance](http://www.borngeek.com/2011/04/05/mysql-performance-and-localhost-performance/)（它来自 2011 年，但在许多情况下仍然适用）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-22T08:49:25.173

对我有用的解决方案是编辑**httpd.conf**并通过注释此行来禁用 CGI 模块的加载：

```
LoadModule cgi_module modules/mod_cgi.so 
```

评论只是在前面添加一个**#**，如下所示：

```
#LoadModule cgi_module modules/mod_cgi.so 
```

重新启动 Apache 服务，您应该一切顺利。

# jquery - 动态添加的链接不起作用

> ID：14791866
> 
> 赞同：0
> 
> 时间：2013-02-09T21:35:35.703
> 
> 标签：jquery

我在尝试在我的脚本上触发事件（警报）时遇到问题。这是html：

```
<div class="dynamic-form">
    <form>
      <div class="inputs"></div>
      <a href="#" id="add">ADD</a>
      <input name="submit" type="button" class="submit" value="Submit">
    </form>
</div> 
```

和 JS：

```
$(document).ready(function(){

    var i = 1;

    $('#add').click(function() {
        $('<div id="d' + i + '" class="fielddiv"><input type="text" class="field" name="dynamic[]" value="' + i + '" /><a href="#" id="remove_question">Cancella</a><hr></div>').fadeIn('slow').appendTo('.inputs');
        i++;
    });

    $('#remove_question').on("click", function(event) {
        alert('dsfsfd');
        //$('#d' + $this.attr('todel')).remove();
    });

    // here's our click function for when the forms submitted

    $('.submit').click(function(){

        var answers = [];
        $.each($('.field'), function() {
            answers.push($(this).val());
        });

        if(answers.length == 0) {
            answers = "none";
        }  

        alert(answers);

        return false;                     
    });

}); 
```

点击功能上的删除问题应该触发警报但没有做任何事情，甚至没有错误，我做错了什么？这也是一个[jsfiddle](http://jsfiddle.net/Z6x8X/)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:38:57.063

您必须具有委托语法。此外，请使用 CLASSES NOT ID，否则您将拥有重复的 ID。

工作JSfiddle：

[http://jsfiddle.net/Z6x8X/2/](http://jsfiddle.net/Z6x8X/2/)

代码：

```
$(document).ready(function(){

    var i = 1;

    $('#add').click(function() {
        $('<div id="d' + i + '" class="fielddiv"><input type="text" class="field" name="dynamic[]" value="' + i + '" /><a href="#" class="remove_question">Cancella</a><hr></div>').fadeIn('slow').appendTo('.inputs');
        i++;
    });

    $(document).on("click", ".remove_question", function(event) {
        alert('dsfsfd');
        //$('#d' + $this.attr('todel')).remove();
    });

    // here's our click function for when the forms submitted

    $('.submit').click(function(){

    var answers = [];
    $.each($('.field'), function() {
        answers.push($(this).val());
    });

    if(answers.length == 0) {
        answers = "none";
    }  

    alert(answers);

    return false;

    });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:37:20.780

对于动态添加的元素，您需要委托的事件处理程序：

```
$(document).on('click', '#remove_question', function(event) {
    alert('dsfsfd');
}); 
```

此外，使用您的代码可以添加无限数量的具有相同 ID 的锚点，但这也不起作用，因为 ID 应该是唯一的。

# jsoup - Jsoup 解析器问题

> ID：14791867
> 
> 赞同：0
> 
> 时间：2013-02-09T21:35:39.250
> 
> 标签：jsoup

我正在使用 Jsoup 解析简短的 html 文档，其中包含一些自定义标签，这些标签是对结果进行一些逻辑操作所需的

像这样：

```
<table><showif field="xxx"><tr><td>test</test></td></tr></showif><tr><td>xyz</td></tr></table>

Document doc = Jsoup.parse(html);
Elements showif_fields = doc.select("SHOWIF[field]"); 
```

在这种情况下，内部内容似乎丢失了，outerHtml() 方法显示了这一点：

```
<showif value="xxx"></showif> 
```

但如果“showif”标签包含一个简单的文本，如 hello，它会按预期工作。

有任何想法吗？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T20:03:03.467

您遇到的问题是表格内容的 HTML 规范非常严格，因此您的未知标签正在表格之外培养。（Jsoup 这样做是为了匹配 HTML 规范，以便它尽可能地匹配浏览器行为。）

在这种情况下，您知道自己在做什么并且正在创建 HTML，因此您可以将 jsoup 设置为忽略 HTML 规范，只处理它看到的标签。[使用XML 解析器](http://jsoup.org/apidocs/org/jsoup/parser/Parser.html#xmlParser%28%29)执行此操作：

```
Document doc = Jsoup.parse(html, baseUri, Parser.xmlParser()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T00:46:54.727

问题是 Jsoup 已经“清理”了您的 HTML。作为一个快速测试，我将您的 HTML 粘贴到一个页面中并使用我的浏览器（也倾向于对其进行清理）查看它，它告诉我 HTML 实际上看起来像：

```
<showif value="xxx"/>
<table><tbody><tr><td>test</td></tr><tr><td>xyz</td></tr></tbody></table> 
```

那是因为只有少数元素可以直接放在 a`<table>`中，浏览器会认为你在其中放置了一个`<showif>`标签是错误的，并为你修复了这个问题。我认为 Jsoup 做了类似的事情。

（**编辑**：现在让 Jsoup 运行，如果我查看它确实会创建类似的输出`doc.outerHtml()`）

如果您确实需要使用非标准的东西来注释您的页面，那么使用非标准属性可能会更好，例如：

```
<table>
  <tr showif="xxx"><td>test</test></td></tr>
  <tr><td>xyz</td></tr>
</table> 
```

那么你可以说：`Elements showif_fields = doc.select("*[showif]");`。这创造了

```
<tr showif="xxx">
   <td>test</td>
</tr> 
```

作为`showif_fields.outerHtml()`.

然后你可能会更好地使用不同的方法，例如像 jQuery 模板或 Mustache（以及许多其他）这样的 javascript 模板引擎，它在执行一些逻辑后插入生成的 HTML，而不是在页面上加载内容并修复它们然后。这当然取决于您的要求，我对这些要求还不够了解，无法判断此建议是否有意义。**编辑**：不，这没有意义，因为 Jsoup 是服务器端，请参阅下面的评论。

# objective-c - 连续数字传递到标签中，结果很奇怪

> ID：14791868
> 
> 赞同：0
> 
> 时间：2013-02-09T21:35:41.057
> 
> 标签：objective-c

我有 2 个按钮，每个按钮都有一个标签号，我将其传递到这个字符串中，我只是想在其中输入 1,1,1,1,1,1,1,1,1 或 2,2,2， 2,2,2,2 或射击 - 偶数，1,2,2,1,1,1。

一切正常，直到第 8 次或第 9 次按下按钮“1”，标签显示为 111111112。然后，如果我再次按下 1，标签显示为 111111168。

也许我完全错了？在我的脑海中是有道理的——但现在我只是感到困惑。任何帮助都会很棒，谢谢！

```
-(IBAction)buttonDigitPressed:(id)sender {

    currentNumber=currentNumber * 10 + (float)[sender tag];

    NSLog(@"currentNumber: %.f", currentNumber);

    phoneNumberLabel.text = [NSString stringWithFormat:@"%.f",currentNumber];

} 
```

这张图片显示我多次击中 1.. 你会认为它会一直显示 1，不是吗？

![在此处输入图像描述](../Images/bf81147d10494d68cd424668ecad1183.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:54:57.017

如果这是一个字符串操作，则不应使用数字进行操作。错误的可能原因：超出范围（因为`float`不够大），精度损失（因为 的性质`float`）等。你应该做的是

```
phoneNumberLabel.text = [phoneNumberLabel.text stringByAppendingFormat:@"%d", [sender tag]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:53:39.213

（单精度）浮点数使用 23 位作为尾数，因此可以用 a 精确表示的最大整数`float`是 2^24 = 16777216。

所有较大的整数都不能用 a 精确表示`float`，因此使用 8 位或更多位数的数字的计算`float`不准确。

双精度浮点数可以精确地表示高达 2^53 = 9007199254740992 的数字。

更好的解决方案可能是使用整数类型（例如`uint64_t`），或者使用 H2CO3 的答案中建议的字符串。

# ios - 使用 QLPreviewController 显示 ALAsset

> ID：14791869
> 
> 赞同：3
> 
> 时间：2013-02-09T21:35:40.967
> 
> 标签：ios, alasset, qlpreviewcontroller

我想使用 QLPreviewController 显示照片流中的 ALAsset QLPreviewController 需要一个 NSURL 来显示该项目

当它是文件 URL（例如 /var/mobile/Applications/5374......9E0/Documents/image33.png）时，这非常有用

我有 ALAsset 但是使用 [[asset defaultRepresentation] url] 给了我一个 NSURL 类型
assets-library://asset/asset.JPG?id=00000000-0000-0000-0000-000000000075&ext=JPG

但这不显示 QLPreviewController 只是一直显示加载？

有任何想法吗 ？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-30T17:53:05.400

也许不是最快和最有效的方法，但它解决了问题。请使用 NSFilemanager 代替 NSTemporaryDirectory ，如文档中所示 :-) 确保链接到 ImageIO.framework

```
 #import <ImageIO/ImageIO.h>

    ....
    NSURL *outURLToUseWithQLPreviewController = nil;

    ALAsset *myAsset = ... // received somehow
    ALAssetRepresentation *represent = myAsset.defaultRepresentation;
    CGImageRef representFullScreen = represent.fullScreenImage;

    NSString *tempDir = NSTemporaryDirectory();
    NSString *imagePath = [tempDir stringByAppendingPathComponent:represent.filename];
    NSURL *tempURL = [NSURL fileURLWithPath:imagePath];

    CGImageDestinationRef destination = CGImageDestinationCreateWithURL((__bridge CFURLRef)(tempURL), (__bridge CFStringRef)(represent.UTI), 1, NULL);
    CGImageDestinationAddImage(destination, representFullScreen, nil);
    if ( CGImageDestinationFinalize(destination) ) {
        outURLToUseWithQLPreviewController = tempURL;
    }
    return outURLToUseWithQLPreviewController; 
```

# android - 来自可绘制资源的图像 png -> 巨大的字节分配和 OOM

> ID：14791870
> 
> 赞同：0
> 
> 时间：2013-02-09T21:35:41.743
> 
> 标签：android, android-imageview, out-of-memory, android-resources

我构建了一个具有 6 页 ViewPager 的 Android 应用程序。对于每个页面都有一个我使用的小图像（不是背景，仅用于 ImageView）。

这些图像每个大约 130KB。我注意到，当这个活动开始时，我会收到这样的消息：

`02-09 21:23:58.755: I/dalvikvm-heap(6478): Grow heap (frag case) to 49.015MB for 2457616-byte allocation`

玩了一会儿，我也得到了一个OOM异常。

我不明白为什么这样大小的图像在加载时会占用太多空间。

有没有人遇到过这样的问题？有什么解决办法吗？

提前致谢！

[更新]

抱歉没有添加代码:)

下面是我在 ViewPager 中使用的 Fragment 的 onCreateView：

```
@Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {

        ViewGroup rootView = (ViewGroup) inflater.inflate(
                R.layout.fragment_selection, container, false);

        mSelectionImage = (ImageView) rootView
                .findViewById(R.id.selection_image);

        switch (mPageNumber) {
        case 0:
            mSelectionImage.setImageResource(R.drawable.img_sel_0);
            break;
        case 1:
            mSelectionImage
                    .setImageResource(R.drawable.img_sel_1);
            break;
        case 2:
            mSelectionImage.setImageResource(R.drawable.img_sel_2);
            break;
        case 3:
            mSelectionImage
                    .setImageResource(R.drawable.img_sel_3);
            break;
        case 4:
            mSelectionImage.setImageResource(R.drawable.img_sel_4);

            break;
        case 5:
            mSelectionImage
                    .setImageResource(R.drawable.img_sel_5);
            break;
        default:
            break;
        }

        return rootView;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T23:23:15.727

您有 6 张图片，每张都是 png 格式，尺寸为 398x538 。

这意味着，默认情况下，它们都使用 6*4*398*538= 5,138,976 字节，大约为 5 MB。

这看起来不像您的 OOM 的真正原因。

您能否告诉我们更多有关该应用程序和可能导致此问题的其他事情的信息？

您是否有可能将文件放在 drawable-ldpi 或 drawable-mdpi 中？

在这种情况下，图像会占用更多时间，具体取决于您正在运行的设备的密度。

例如，如果您将它们全部放在 drawable-mdpi 中，但设备在 xdpi 屏幕上运行，这将占用 4 倍的内存（因为我们将宽度和高度都加倍）。它仍然没有接近你所拥有的 50MB。

# opengl - OpenGL：它会自行将图像保留在屏幕上吗？

> ID：14791875
> 
> 赞同：0
> 
> 时间：2013-02-09T21:36:09.013
> 
> 标签：opengl

以 Windows 为例，当通过 GDI 绘制图形时，必须在每次发生 WM_PAINT 时重新绘制场景（+validate 等）。这个要求非常明显，否则图形很容易损坏。

然而，对于 OpenGL，似乎一旦通过交换缓冲区显示场景，无论对窗口做什么，它都会持续存在。这可能是一个有用的功能。

问题：这种行为是否跨平台且可靠？或者这只是一个不能依赖的常见但非强制性的驱动程序特性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:53:56.643

> 然而，对于 OpenGL，似乎一旦通过交换缓冲区显示场景，无论对窗口做什么，它都会持续存在。

绝对不是这样的。交换缓冲区后，后缓冲区的内容未定义，前缓冲区的内容与使用其他方法绘制的内容受到相同的损害。

> 问题：这种行为是否跨平台且可靠？

我不知道你的意思，因为你描述的行为不存在。

# uitableview - 在后台渲染图像

> ID：14791876
> 
> 赞同：-1
> 
> 时间：2013-02-09T21:36:20.817
> 
> 标签：uitableview, image-processing, calayer, grand-central-dispatch, nscache

我有一个 tableview，它有 5-6 个子视图，并不复杂，但是 imageview 在其中呈现高分辨率图像，显示在 200X174 大小的 imageview 中。图像被异步下载并缓存到磁盘。但是，当用户在 tableview 中滚动时，当滚动即将稳定下来时，滚动会出现卡顿。我希望制作自己的自定义单元格，通过覆盖 drawrect 方法使用 calayers 进行绘图。是否可以在异步背景队列中渲染这些图像，以便用户获得流畅的滚动体验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:46:31.597

首先要做的是使用 Instruments 找出问题所在。到目前为止，听起来你只是在猜测。从您的问题中甚至不清楚问题是下载还是绘图。也可以观看关于这个主题的 WWDC 2012 视频；他们谈论了很多关于获得流畅的表格滚动体验的问题。导致问题的细胞可能还有很多其他问题。例如，您也许可以通过光栅化来解决它。您的问题没有详细说明您的绘图方式以及延迟的实际位置，因此猜测意义不大。

# python - 在多对多关系中添加记录会导致 sqlalchemy 中出现重复错误

> ID：14791878
> 
> 赞同：3
> 
> 时间：2013-02-09T21:36:35.913
> 
> 标签：python, sql, sqlalchemy, many-to-many

我有 2 个表：`Book`和`Author`辅助表`books_authors`，类似于此代码：

```
book=Book()
for author in authors:
     a = Author()
     a.books.append(book)
     session.merge(a) #1

session.merge(book) #2
session.commit() 
```

此代码导致错误

```
sqlalchemy.exc.IntegrityError: 
(IntegrityError) (1062, "Duplicate entry '1234' for key 'id'") 
'INSERT INTO `Book` (title, id)  VALUES (%s, %s)' ('test', u'1234') 
```

我想这是因为合并进行了两次（#1，#2）。

所以我决定删除`#1`。没有发生错误，但表 Author 中没有任何内容。当我决定删除`#2`时，表格 Book、Author 和 books_authors 填写正确，只要只有一位作者被添加到书中。

更多作者导致与以前的错误类似。

`#2`合并不合并添加的作者是否正常？它只在一个方向上起作用吗？如果是，如何通过合并两个作者条目来不重复书籍条目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:51:46.357

我不熟悉您的应用程序代码，但您尝试的要点应该是这样的：

插入图书记录，如果它不存在的话。

插入作者记录，如果它不存在的话。

如果 book_authors 记录不存在，则插入它。

要防止重复条目，请使用这种类型的语法。

```
insert into yourtable
(field1, field2, etc)
select distinct value1, value2, etc
from some_small_table
where not exists
(subquery to check for existing records) 
```

根据您的数据库引擎，可能不需要 from some_small_table 部分。

# php - PHP构造函数参数混淆

> ID：14791879
> 
> 赞同：0
> 
> 时间：2013-02-09T21:36:39.797
> 
> 标签：php, parameters, constructor

[在阅读有关 PHP 构造函数的信息时，我在此](http://php.net/manual/en/language.oop5.decon.php)页面上遇到了以下示例。

```
<?php
    class MyClass {
        // use a unique id for each derived constructor,
        // and use a null reference to an array, 
        // for optional parameters
        function __construct($id="", $args=null) {
            // parent constructor called first ALWAYS
            /*Remaining code here*/
        }
    } 
```

我无法理解为什么`$id`设置为`""`和。我什么时候会使用这样的东西？为什么我们不能只使用.`$args``null``function __construct($id, $args) {`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T21:38:51.117

这些是[默认参数](http://www.php.net/manual/en/functions.arguments.php#functions.arguments.default)。当调用者未提供它们时，它们将被设置为这些值。否则，它将被设置为调用者的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T21:38:47.770

这样两者`$x = MyClass("12", array(1, 2, 3))`和`$y = MyClass()`都是有效的。

如果没有这些默认参数，`MyClass()`将产生错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-09T21:44:23.493

这些是默认参数值。

这意味着您可以在不传递任何参数的情况下调用构造函数，然后构造函数会将这些值添加到参数中。

因此，您可以像这样创建一个实例：

```
$mc = MyClass(); 
```

那么这什么时候有用呢？好吧，假设您有一个通常具有相同参数的类，假设您有一个`Door`通常是 type 的类`normal`。然后你可以省略传递那个值，但有时你想要一个`Door`安全类型的，然后你想传递它。澄清：

```
class Door {
  private $door_type;
  public function __construct($type='normal') {
    $this->door_type = $type;
  }
}

//Create a 'normal' door
$normal_door = new Door();
$normal_door = new Door('normal'); //the same as above

//Create a 'safe' door
$safe_door = new Door('safe'); 
```

这个例子显然不是你在现实世界中实现它的方式，但我希望你能看到它的用途。

请注意，并非所有语言都支持这一点，例如 Java 不支持。

# tomcat7 - tomcat server v7.0 启动失败

> ID：14791881
> 
> 赞同：0
> 
> 时间：2013-02-09T21:36:50.370
> 
> 标签：tomcat7

我正在 Java EE 中开发一个 Web 应用程序并将其部署在 Tomcat 7 上。一切正常，现在我收到此错误。我尝试重新启动 Eclipse，删除服务器并重新安装它。我正在使用Windows机器。

```
Feb 09, 2013 4:30:06 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-8080"]
Feb 09, 2013 4:30:06 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["ajp-bio-8009"]
Feb 09, 2013 4:30:06 PM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 705 ms
Feb 09, 2013 4:30:06 PM org.apache.catalina.core.StandardService startInternal
INFO: Starting service Catalina
Feb 09, 2013 4:30:06 PM org.apache.catalina.core.StandardEngine startInternal
INFO: Starting Servlet Engine: Apache Tomcat/7.0.34
Feb 09, 2013 4:30:07 PM org.apache.catalina.core.ContainerBase startInternal
SEVERE: A child container failed during start
java.util.concurrent.ExecutionException: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/AppDynamics]]
    at java.util.concurrent.FutureTask$Sync.innerGet(Unknown Source)
    at java.util.concurrent.FutureTask.get(Unknown Source)
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1123)
    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:800)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/AppDynamics]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    ... 7 more
Caused by: java.lang.NoClassDefFoundError: org/json/JSONException
    at java.lang.Class.getDeclaredFields0(Native Method)
    at java.lang.Class.privateGetDeclaredFields(Unknown Source)
    at java.lang.Class.getDeclaredFields(Unknown Source)
    at org.apache.catalina.util.Introspection.getDeclaredFields(Introspection.java:87)
    at org.apache.catalina.startup.WebAnnotationSet.loadFieldsAnnotation(WebAnnotationSet.java:261)
    at org.apache.catalina.startup.WebAnnotationSet.loadApplicationServletAnnotations(WebAnnotationSet.java:140)
    at org.apache.catalina.startup.WebAnnotationSet.loadApplicationAnnotations(WebAnnotationSet.java:67)
    at org.apache.catalina.startup.ContextConfig.applicationAnnotationsConfig(ContextConfig.java:405)
    at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:881)
    at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:369)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5173)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more
Caused by: java.lang.ClassNotFoundException: org.json.JSONException
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1714)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1559)
    ... 21 more

Feb 09, 2013 4:30:07 PM org.apache.catalina.core.ContainerBase startInternal
SEVERE: A child container failed during start
java.util.concurrent.ExecutionException: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost]]
    at java.util.concurrent.FutureTask$Sync.innerGet(Unknown Source)
    at java.util.concurrent.FutureTask.get(Unknown Source)
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1123)
    at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:302)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.StandardService.startInternal(StandardService.java:443)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:732)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:684)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:322)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:451)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: org.apache.catalina.LifecycleException: A child container failed during start
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1131)
    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:800)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more

Feb 09, 2013 4:30:07 PM org.apache.catalina.startup.Catalina start
SEVERE: Catalina.start: 
org.apache.catalina.LifecycleException: Failed to start component [StandardServer[8005]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:684)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:322)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:451)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardService[Catalina]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:732)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.StandardService.startInternal(StandardService.java:443)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 9 more
Caused by: org.apache.catalina.LifecycleException: A child container failed during start
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1131)
    at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:302)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 11 more

Feb 09, 2013 4:30:07 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 486 ms 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:42:51.027

确保[org.json.JSONException](http://www.jarfinder.com/index.php/java/info/org.json.JSONException)在您的类路径中以解决眼前的问题。不过，您的最终问题很可能是不同的。例如，您是否包含了在 WEB-INF/lib 中的链接中给出[的 jar 之一？](http://www.jarfinder.com/index.php/java/info/org.json.JSONException)

# wcf - 指定多个基地址时如何绑定

> ID：14791883
> 
> 赞同：2
> 
> 时间：2013-02-09T21:37:24.723
> 
> 标签：wcf, binding

我有一个 WCF 服务，它的配置文件如下所示：

```
<system.serviceModel>
  <services>
    <service name="WCFService.ServiceClass" behaviorConfiguration="metaDataSupport">
      <host>
        <baseAddresses>
          <add baseAddress="net.pipe://localhost/WCFService"/>
          <add baseAddress="net.tcp://localhost:8100/WCFService"/>
          <add baseAddress="http://localhost:8101/WCFService"/>
        </baseAddresses>
      </host>
      <endpoint address="tcpmex"
                binding="mexTcpBinding"
                contract="IMetadataExchange" />
      <endpoint address="namedpipemex"
                binding="mexNamedPipeBinding"
                contract="IMetadataExchange" />
      <endpoint address=""
                binding="wsHttpBinding"
                contract="WCFService.IServiceClass" />
    </service>
  </services>
  <behaviors>
    <serviceBehaviors>
      <behavior name="metaDataSupport">
        <serviceMetadata httpGetEnabled="false" httpGetUrl="" />
      </behavior>
    </serviceBehaviors>
  </behaviors>
</system.serviceModel> 
```

我这里有 3 种类型的绑定：NamedPipeBinding、TcpBinding 和 wsHttpBinding。

我可以在以下位置添加带有元数据的引用

1.  net.tcp://localhost:8100/WCFService/tcpmex

2.  net.pipe://localhost/WCFService/namedpipemex

我已经为行为中的服务禁用了 httpGet。

添加了服务引用，**但在客户端具有以下配置**：

```
<system.serviceModel>
  <bindings>
    <wsDualHttpBinding>
      <binding name="WSHttpBinding_IServiceClass" />
    </wsDualHttpBinding>
  </bindings>
  <client>
    <endpoint address="http://localhost:8101/WCFService" binding="wsHttpBinding"
      bindingConfiguration="WSHttpBinding_IServiceClass" contract="TCP.IServiceClass"
      name="WSHttpBinding_IServiceClass">
    </endpoint>
  </client>
</system.serviceModel> 
```

**但是由于我使用 TCP Binding 端点添加了一个引用，所以我期望：**

**地址=net.tcp://localhost:8100/WCFService**

**和绑定="mexTcpBinding"**

该服务正在运行，但我想知道，这里发生了什么。这是什么原因。是由于 baseAddress 还是对 wsHttpBinding 的某些偏好？

想法受到赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:32:18.050

The `mex` binding (short for Metadata EXchange) is not an endpoint which can be used to consume your service. Instead, it's used only used to expose information (or meta information) about all the "real" endpoints of your service - notice that your service class doesn't implement the `IMetadataExchange` contract which you defined in your TCP/Pipe endpoints.

In your case, your service has only one "real" endpoint - the one using `wsHttpBinding`, which implements the `WCFService.IServiceClass` interface. That's why there's only one endpoint in your client configuration.

Now, if you had another endpoint using a non-metadata binding (and not the `IMetadataExchange` contract), they would show up in the client config as well:

```
<system.serviceModel>
  <services>
    <service name="WCFService.ServiceClass" behaviorConfiguration="metaDataSupport">
      <host>
        <baseAddresses>
          <add baseAddress="net.pipe://localhost/WCFService"/>
          <add baseAddress="net.tcp://localhost:8100/WCFService"/>
          <add baseAddress="http://localhost:8101/WCFService"/>
        </baseAddresses>
      </host>
      <endpoint address="tcpmex"
                binding="mexTcpBinding"
                contract="IMetadataExchange" />
      <endpoint address="namedpipemex"
                binding="mexNamedPipeBinding"
                contract="IMetadataExchange" />
      <endpoint address=""
                binding="netNamedPipeBinding"
                contract="WCFService.IServiceClass" />
      <endpoint address=""
                binding="netTcpBinding"
                contract="WCFService.IServiceClass" />
      <endpoint address=""
                binding="wsHttpBinding"
                contract="WCFService.IServiceClass" />
    </service>
  </services>
  <behaviors>
    <serviceBehaviors>
      <behavior name="metaDataSupport">
        <serviceMetadata httpGetEnabled="false" httpGetUrl="" />
      </behavior>
    </serviceBehaviors>
  </behaviors>
</system.serviceModel> 
```

# html - 如何使网页在桌面和移动设备上可读而不用拧字体大小？

> ID：14791889
> 
> 赞同：3
> 
> 时间：2013-02-09T21:37:45.927
> 
> 标签：html, css, mobile

我希望能够以一种可用于桌面和移动设备的方式格式化我的博客，而无需尝试检测移动浏览器。作为网络标准的拥护者，我认为如果我只使用基本的 HTML 而不使用任何样式，它应该是可用的，但事实证明 iPhone 和 Android 浏览器都以微小的文本呈现（显然是复制布局在桌面浏览器上看到）。

我知道我可以使用媒体查询和十几种其他技术在移动浏览器上获得我想要的外观。我很想知道是否有任何方法可以让移动浏览器以设备默认字体大小显示某些内容，而无需求助于 font-size: 20pt; 在样式表中。有没有一种“是的，这只是普通的 HTML，所以不要试图假装你有桌面浏览器的宽度”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-09T21:43:13.273

这`viewport` `meta`确实为移动设备创造了奇迹。这将使视口成为设备的大小，而不是试图将其放大并缩小：

```
<meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"> 
```

您可能会看到其他版本的 this with `width=device-width`and such。这会起作用，但是当它处于横向模式时它也会扩大您的网页（我认为这是不受欢迎的）。使用所有这些比例约束将确保视口对于两个方向都是合适的大小。

创建. `viewport` `meta`_ [_](https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html#//apple_ref/html/const/viewport)

# django - 保存 Django FormWizard

> ID：14791892
> 
> 赞同：5
> 
> 时间：2013-02-09T21:38:22.883
> 
> 标签：django, forms, save

我一直在努力创建一个 django `FormWizard`。我认为我非常接近，但我不知道如何保存到数据库。

我尝试了[这里](https://stackoverflow.com/questions/5769347/easiest-way-to-save-djangos-formwizard-form-list-in-db)建议的解决方案：

```
def done(self, form_list, **kwargs):
    instance = MyModel()
    for form in form_list:
        for field, value in form.cleaned_data.iteritems():
            setattr(instance, field, value)
    instance.save()

    return render_to_response('wizard-done.html', {
        'form_data': [form.cleaned_data for form in form_list],
    }) 
```

但是将其放在 done 方法中会导致`No Exception Supplied`错误。`save`另一方面，将此代码放在方法中不会保存信息。

我也尝试了[这里](https://groups.google.com/forum/?fromgroups=#!topic/django-users/UKev69_vM_0)建议的解决方案：

```
def done(self, form_list, **kwargs):
    for form in form_list:
        form.save()
    return render_to_response('wizard-done.html', {
        'form_data': [form.cleaned_data for form in form_list],
    }) 
```

但这会返回另一个错误：`AttributeError at /wizard/ 'StepOneForm' object has no attribute 'save'`. 你遇到过这个问题吗？向导提交后如何将信息保存到数据库中？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T08:58:53.177

```
def done(self, form_list, **kwargs):
    new = MyModel()
    for form in form_list:
        new = construct_instance(form, new, form._meta.fields, form._meta.exclude)
    new.save()
    return redirect('/') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-15T09:12:26.667

您需要先获取一个实例：

```
def get_form_instance( self, step ):
    if self.instance is None:
        self.instance = MyModel()
    return self.instance

def done(self, form_list, **kwargs):
    self.instance.save()
    return HttpResponseRedirect(reverse('mymodel_finish')) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T08:46:36.783

试试这个方法

```
def done(self,request,form_list):
    if request.method=='POST':
        form1 = F1articles(request.POST)    
        form2 = F2articles(request.POST)
        form_dict={}
        for x in form_list:
            form_dict=dict(form_dict.items()+x.cleaned_data.items())
        insert_db = Marticles(heading = form_dict['heading'],
        content = form_dict['content'],
        created_by = request.session['user_name'],  
        country = form_dict['country'],
        work = form_dict['work'])
        insert_db.save()
        return HttpResponse('data saved successfully') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-22T08:33:28.953

即使使用文件字段，这项工作也很好

```
 ....
    template_name = "..."
    file_storage = FileSystemStorage(location=os.path.join(settings.MEDIA_ROOT,'tmp'))

    def done(self, form_list, **kwargs):
        form_data, form_files = process_data(form_list)        
        form = MyModelForm(data=form_data, files=form_files)
        if form.is_valid():
            obj.save()
            return redirect('some_success_page')

def process_data(form_list):
    """ the function processes and return the field data and field files as a tuple """
    fields = {}
    files = {}
    for form in form_list:
    ## loop over each form object in the form_list list object
        for  field, (clean_field, value) in zip(form, form.cleaned_data.items()):
            ## loop over each field in each form object
            if field.widget_type == 'clearablefile':
                ## if field type == "clearablefile" add to files dict and continue to next iteration
                files.update({clean_field:value})
                continue
            ## else add to the field dict  
            fields.update({clean_field:value})
    return fields, files 
```

# c - 使用 ZwQuerySystemInformation 获取 SystemKernelDebuggerInformation

> ID：14791901
> 
> 赞同：1
> 
> 时间：2013-02-09T17:07:01.700
> 
> 标签：c, windows, debugging, winapi

我一直在尝试通过使用 ZwQuerySystemInformation 函数调用来确定程序是否在系统模式调试器下运行。

到目前为止，我有以下代码，我正在加载 ntdll.dll 库并获取 ZwQuerySystemInformation 的地址。然后我必须使用适当的参数调用我返回的句柄以获取 SystemKernelDebuggerInformation 信息。

```
#include "stdafx.h"
#include <stdio.h>
#include <windows.h>
#include <Winternl.h>

int _tmain(int argc, _TCHAR* argv[])
{
    /* load the ntdll.dll */
    HMODULE lib = LoadLibrary(_T("ntdll.dll"));
    FARPROC fun = GetProcAddress(lib, "ZwQuerySystemInformation");
    if(fun == NULL) {
        printf("Error: could not find the function ZwQuerySystemInformation in library ntdll.dll.");
        exit(-1);
    }
    printf("ZwQuerySystemInformation is located at 0x%08x in ntdll.dll.\n", (unsigned int)fun);

    SYSTEM_INFORMATION_CLASS sic = SystemKernelDebuggerInformation;
    SYSTEM_BASIC_INFORMATION sbi;

    NTSTATUS WINAPI temp = NtQuerySystemInformation(sic, &sbi, sizeof(sbi), NULL);

    /* wait */
    getchar();

    return 0;
} 
```

您能告诉我如何调用该函数来获取包含 SystemKernelDebuggerInformation 信息的系统信息吗？那就够了，剩下的我来处理。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T07:06:40.083

看看[CheckDebugger_Method3](http://shangdi.googlecode.com/svn-history/r343/trunk/code/LicenseLib/AntiDebug.cpp)

```
 int main(){
    typedef long NTSTATUS; 
    #define STATUS_SUCCESS    ((NTSTATUS)0L) 
    HANDLE hProcess = GetCurrentProcess();
    typedef struct _SYSTEM_KERNEL_DEBUGGER_INFORMATION { 
                 BOOLEAN DebuggerEnabled; 
                 BOOLEAN DebuggerNotPresent; 
    } SYSTEM_KERNEL_DEBUGGER_INFORMATION, *PSYSTEM_KERNEL_DEBUGGER_INFORMATION; 
    enum SYSTEM_INFORMATION_CLASS { SystemKernelDebuggerInformation = 35 }; 
    typedef NTSTATUS  (__stdcall *ZW_QUERY_SYSTEM_INFORMATION)(IN SYSTEM_INFORMATION_CLASS SystemInformationClass, IN OUT PVOID SystemInformation, IN ULONG SystemInformationLength, OUT PULONG ReturnLength); 
    ZW_QUERY_SYSTEM_INFORMATION ZwQuerySystemInformation;
    SYSTEM_KERNEL_DEBUGGER_INFORMATION Info;
    HMODULE hModule = GetModuleHandle("ntdll.dll");
    if (!hModule) {
        return FALSE;
    }
    ZwQuerySystemInformation = (ZW_QUERY_SYSTEM_INFORMATION)GetProcAddress(hModule, "ZwQuerySystemInformation");
    if (ZwQuerySystemInformation) {
        if (STATUS_SUCCESS == ZwQuerySystemInformation(SystemKernelDebuggerInformation, &Info, sizeof(Info), NULL)) {
            if (Info.DebuggerEnabled&&!Info.DebuggerNotPresent) {
                return TRUE;
            }
        }
    }
    return FALSE;
} 
```

[ZwQuerySystemInformation](http://msdn.microsoft.com/en-us/library/windows/desktop/ms725506%28v=vs.85%29.aspx)自 Windows 8 起不再可用

# vim - Vim :: 如何禁用 FileType 的交换文件

> ID：14791902
> 
> 赞同：0
> 
> 时间：2013-02-09T21:39:32.400
> 
> 标签：vim

我正在尝试专门为文本文件禁用交换。但是，autocmd 尝试无法正常工作。是否可以基于文件类型禁用交换？

_vimrc

```
call pathogen#runtime_append_all_bundles()
call pathogen#helptags()
call pathogen#infect()
filetype plugin indent on
... 
autocmd FileType text set noswapfile // fails ... 
```

# c++ - C++ 返回数组语法

> ID：14791907
> 
> 赞同：0
> 
> 时间：2013-02-09T21:40:25.127
> 
> 标签：c++, arrays, syntax

我在 C++ 中有一个关于返回数组的语法问题。当我们传入一个数组时，什么时候可以这样做：

```
void merge_sort(int input_array[], int size);//notice the first parameter 
```

我知道这有效：

```
int* merge_sort(int input_array[], int size){
    //do something with input_array
    return new int[2]; //dummy array
} 
```

问题：

```
int[] merge_sort(int input_array[], int size){ //Question is on return type, wont compile
     //do something with input_array
    return new int[2]; //dummy array
} 
```

返回 int* 成功。为什么返回 int [] 失败？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:25:59.910

在 C 和 C++ 中，您既不能将数组作为参数传递给函数，也不能将数组作为函数结果返回。

是的，语法可以使它*看起来*像你在传递一个数组参数：

```
void func(int param[]) {
    // ...
}

...

int arr[10];
func(arr); 
```

但实际上这只是将指针传递给数组的第一个元素。`int param[]`参数定义*调整*；它完全等同于`int *param`. 在大多数情况下，数组类型的表达式会隐式转换为其第一个元素的指针。

这就是为什么您需要将大小作为单独的参数传递。

仅使用 C 功能，有几种方法可以执行返回数组之*类的操作：*

*   函数可以返回指向`static`数组第一个元素的指针。这有一些缺点：大小必须固定，并且多个调用者获得指向同一个对象的指针。
*   函数可以接收由调用者传入的指向数组第一个元素的指针。这将分配和释放数组的负担放在调用者身上。
*   函数可以返回指向动态分配（`malloc()`在 C 中，`new`在 C++ 中）数组的第一个元素的指针。这需要调用者释放数组。

C++ 提供了一组丰富的库类，可以为您处理所有这些问题。

[推荐阅读： comp.lang.c FAQ](http://www.c-faq.com/)的第 6 节。

您*可以*将结构作为参数传递，并将它们作为函数结果返回，并且结构可以包含数组作为成员。但这并不像你想象的那么有用。作为结构成员的数组必须具有固定大小；对数组进行操作的最有用的代码可以处理动态大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T22:07:11.930

你为什么要首先退回任何东西？

数组并没有真正“传递”给函数（没有复制元素），只有指向它开始的指针。当函数重新排列数组元素时，它是在**原始**数组中这样做的。函数退出后，调用代码可以简单地继续使用旧的（现在排序的）数组。

换句话说，该函数会产生副作用。

> 我知道这有效：

```
int* merge_sort(int input_array[], int size){
    //do something with input_array
    return new int[2]; //dummy array
} 
```

*（假设您实际上需要返回......）*

好吧，它“有效”，但非常危险。调用者需要知道它需要**释放**返回的数组（否则会发生内存泄漏），并且它需要知道它必须使用`delete[]`而不仅仅是`delete`（否则会出现未定义的行为），这显然仅基于返回类型（它只是一个指针）。调用者也可能怀疑 是否在`input_array`函数内部被释放。

即使您已经记录了所有这些，调用者也很容易出错。使用现代 C++ 提供的工具会更好：例如，您可以返回一个`std::vector`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T00:59:31.847

您应该在这种方法中使用向量，在您的项目中包含然后几乎像使用数组一样使用向量。

您可以在这里查看向量：http: [//msdn.microsoft.com/en-us/library/vstudio/9xd04bzs.aspx](http://msdn.microsoft.com/en-us/library/vstudio/9xd04bzs.aspx)

矢量的好处是它们可以为您的项目动态缩放，并且不会由于缓冲区溢出而造成任何内存泄漏等，它很像 ArrayList

# c# - 将图形添加到运行时创建的组件

> ID：14791914
> 
> 赞同：0
> 
> 时间：2013-02-09T21:41:21.657
> 
> 标签：c#

对于任何可以在这里帮助我的人，我将不胜感激！

我有一个非常小的应用程序，它在运行时使用 for LOOP 创建多个面板。目前，要创建的面板数量来自文本框中输入的值，但最终将由从数据库中读取的整数确定

每个面板都有一个在同一循环中创建的标签

我的问题是，我想在每个面板创建时（在 FOR 循环的每次迭代中）绘制 120 条线，并且我正在使用嵌套的 WHILE 循环来执行此操作

我可以让一切正常工作，面板与标签标题一起创建，但由于某种原因，我无法绘制线条

这是一种测试方法，有人可以帮助我吗？

我目前拥有的代码如下：

```
public void CreatePanels()
{
    int PanelPosX = 50;
    int PanelPosY = 500;
    int LabelPosX = 10;
    int LabelPosY = 10;

    for (int i = 0; i < (Convert.ToInt32(textBox2.Text)); i++)
    {
        Panel pnlOverview = new Panel();
        pnlOverview.Name = "InspectorPanel" + i.ToString();
        pnlOverview.Text = "Inspector Panel " + i.ToString();
        pnlOverview.Location = new Point(PanelPosX, PanelPosY);
        pnlOverview.Size = new Size(974, 136);
        pnlOverview.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;
        Controls.Add(pnlOverview);
        PanelPosY += 170;

        Label lblInspectorName = new Label();
        lblInspectorName.Name = "InspectorName" + i.ToString();
        lblInspectorName.Text = " Inspector " + i.ToString();
        lblInspectorName.Width = 100;
        lblInspectorName.Height = 13;
        lblInspectorName.Location = new Point(LabelPosX, LabelPosY);
        lblInspectorName.Size = new Size(974, 136);
        pnlOverview.Controls.Add(lblInspectorName);

        // Draw the Overview Chart

        int x = 10;
        int y = 0;

        Pen OVTable = new Pen(Color.Black, 0);

        while (y < 120)
        {
            Graphics mp = pnlOverview.CreateGraphics();
            mp.DrawLine(OVTable, x, 40, x, 100);
            y++;
            x += 8;
        }
    }
    return;
} 
```

谢谢伊万

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:54:59.110

您可能需要创建一个空图像并在其中绘制，然后将其添加到面板中。另一种选择是从面板派生并覆盖 OnPaint 方法，此时您将绘制图表。

也许有一个 C# Chart 组件可以为您实现这一点。

这是关于呈现自定义控件的 MSDN 参考的[链接，这就是您所追求的。](http://msdn.microsoft.com/en-us/library/kxys6ytf%28v=vs.71%29.aspx)

# perl - Perl 中定义/取消定义的使用

> ID：14791915
> 
> 赞同：12
> 
> 时间：2013-02-09T21:41:22.520
> 
> 标签：perl

我打算将两个变量传递给一个 perl 函数，其中一个可能是可选的。我正在尝试检查第二个是否已定义，但它无法正常工作。当我将该函数称为 myFunction(18) 时，它假定变量 $optional 已定义并转到 else 语句。但是在 else 语句中，当访问 $optional 变量时，它会引发“未初始化”错误。这与我的预期完全相反。任何帮助是极大的赞赏。

```
sub myFunction {
    my ($length, $optional) = (@_);

    if (undef($optional) {
        more code..
    }
    else {
        more code...
    }
}

myFunction(18); 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-09T21:47:29.277

正确的函数是`defined`。 `undef`取消定义`$optional`。你想要做的是这样的：

```
sub myFunction {
    my($length, $optional) = @_;

    if (!defined $optional) {
        # Do whatever needs to be done if $optional isn't defined.
    }
    else {
        # Do whatever can be done if $optional *is* defined.
    }
} 
```

处理它的另一种方法（尤其是 Perl 5.10+）是使用“定义或”运算符 , `//`，如下所示：

```
sub MyFunc {
    my $length = shift;
    my $optional = shift // 'Default Value';
    # Do your stuff here.
} 
```

这样做是检测是否`shift @_`定义了返回值。由于您已经调用了一次 shift，我们现在正在测试第二个参数。如果已定义，请将值分配给`$optional`. 如果未定义，则分配`'Default Value'`给`$optional`. 当然，您必须提出自己的理智默认值。

如果您陷入 Perl 5.10 之前的黑暗时代，您可以通过以下方式完成相同的操作：

```
my $optional = shift;
$optional = defined $optional ? $optional : 'Default value'; 
```

...或者...

```
my $length = shift;
my $optional = defined( $_[0] ) ? shift : 'Default value'; 
```

无论哪种方式，我通常更喜欢有一个健全的默认值，而不是一个完全独立的控制流路径。这通常是简化代码的好方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-16T15:58:20.173

```
my $optional = defined( $_[0] ) ? shift : 'Default value'; 
```

这是危险的代码，因为它只会在定义时关闭参数，如果你有第三个参数，当你调用时会变得混乱

```
MyFunc( 10, undef, 20 ) 
```

# javascript - jQuery 中的 Object.values()

> ID：14791917
> 
> 赞同：8
> 
> 时间：2013-02-09T21:41:30.090
> 
> 标签：javascript, jquery, prototypejs

prototypeJS 库有一个 Object.values() 方法，它返回对象中的值数组。

例如：

```
 var myObj = {
   "key1" : "val1"
   "key2" : "val2"
 }
 Object.values(myObj) //returns ["val1", "val2"] 
```

有没有做同样事情的jQuery方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-09T21:43:16.770

我认为没有直接的方法，但您可以使用[`$.map()`](http://api.jquery.com/jquery.map/)：

```
$.map(myObj, function(val, key) { return val; }); //returns ["val1", "val2"] 
```

（请注意，如果回调返回`null`或`undefined`对于给定属性，则该项目将不会包含在新数组中，因此如果您的对象可能具有具有这些值的属性，则必须以另一种方式进行。从不过，用一个[`for..in`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for...in)循环来刮擦。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-09T22:35:22.093

prototypejs 的`values`方法扩展了 JavaScript 的内置`Object`对象。没有什么能阻止你做同样的事情：

```
Object.values = function(object) {
  var values = [];
  for(var property in object) {
    values.push(object[property]);
  }
  return values;
}

var foo = {a:1, b:2, c:3};
console.log(Object.values(foo));
// [1, 2, 3] 
```

或者，如果您不想篡改，可以将上述方法添加到 jQuery 对象`Object`：

```
$.values = function() { ... } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-26T10:13:45.097

使用 ES6，您可以执行以下操作：

```
Object.values = x =>
        Object.keys(x).reduce((y, z) =>
            y.push(x[z]) && y, []); 
```

这只是返回一个包含对象值的数组。不需要 JQuery、_ 或其他任何东西。

* * *

**注意：** `Object.values()`目前处于 ES7 草案中

使用 babel，安装

*   babel-preset-es2017
*   babel-plugin-transform-runtime

提供支持`Object.values/Object.entries`以及其他`ES2017`功能。

根据模块的建议，`.babelrc`使用以下内容配置文件：

```
{
  "plugins": ["transform-runtime"],
  "presets": ["es2017"]
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T23:21:29.410

[Underscorejs](http://underscorejs.org/#values)有`_.values`方法： `_.values({one : 1, two : 2, three : 3}); => [1, 2, 3]`

这个库很好地增强了 JQuery - 以及在prototypejs 中出色地工作。

# python - 对直方图进行采样，使得样本上的总和是一致的

> ID：14791918
> 
> 赞同：3
> 
> 时间：2013-02-09T21:41:48.283
> 
> 标签：python, numpy, statistics, sampling

我有一个项目列表，我想从中随机抽取一个子集，但每个项目都与 D 个 bin 上的直方图配对，我想以总和直方图近似一致的方式对项目进行抽样。

因此它应该作为下面的示例函数工作：

```
>>> import numpy
>>> #The histograms from which to sample (each having 5 bins):
>>> data = numpy.random.randint(100, size=(10000,5))
>>> #The function which I'm trying to program:
>>> samples = sample(data,500)
>>> samples.shape
(500,5)
>>> summed_histogram = samples.sum(axis=0)
>>> #Each bin should have approximately equal value
>>> summed_histogram / float(summed_histogram.sum())
array([ 0.2,  0.2,  0.2,  0.2,  0.2]) 
```

总和直方图的绝对值并不重要，也不需要完全一致，只需大致一致即可。另外，我不在乎返回的样本量是否不完全是指定的样本量。取样应无更换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T18:01:49.290

要扩展@Ilmari Karonen 的解决方案，您要做的是计算每个直方图的权重，然后根据这些权重进行采样。在我看来，根据您的目标，最有效的方法是使用[线性程序](http://en.wikipedia.org/wiki/Linear_programming)。

令 D_ij 为第 i 个项目的直方图中第 j 个 bin 的权重。然后，如果每个项目的权重为 w_i，则“总和直方图”的权重 sum(i in items) w_i D_ij。获得“近似均匀”分布的一种方法是最小化箱之间的最大差异，因此我们将解决以下 LP：

```
minimize z
subject to (for all j, k) 
    z >= (sum i in items) w_i D_ij - (sum i in items) w_i D_ik
    z >= (sum i in items) w_i D_ik - (sum i in items) w_i D_ij 
```

The above is basically saying that `z >=` absolute value of difference across all weighted pairs of bins. To solve this LP you will need a separate package since numpy does not include a LP solver. See [this gist](https://gist.github.com/mizzao/4961762) for a solution using `cplex` or [this gist](https://gist.github.com/cvanweelden/4961033) for a solution using `cvxpy`. Note that you will need to set some constraints on the weights (e.g. each weight is larger or equal to 0) as these solutions do. Other python bindings for GLPK (GNU Linear Programming kit) can be found here: [http://en.wikibooks.org/wiki/GLPK/Python](http://en.wikibooks.org/wiki/GLPK/Python).

Finally you just sample from histogram `i` with weight `w_i`. This can be done with an adaptation of roulette selection using `cumsum` and `searchsorted` as suggested by @Ilmari Karonen, see [this gist](https://gist.github.com/cvanweelden/4971289).

If you wanted the resulting weighted distribution to be "as uniform as possible", I would solve a similar problem with weights, but maximize the weighted entropy across the weighted sum of bins. This problem would appear to be nonlinear although you could use any number of nonlinear solvers such as BFGS or gradient-based methods. This would probably be a bit slower than the LP method but it depends on what you need in your application. The LP method would approximate the nonlinear method very closely if you have a large number of histograms, because it would be easy to reach a uniform distribution.

When using the LP solution, a bunch of the histogram weights may bind to 0 because the number of constraints is small, but this will not be a problem with a non-trivial number of bins, since the number of constraints is O(n^2).

Example weights with 50 histograms and 10 bins:

```
[0.006123642775837011, 0.08591660144140816, 0.0, 0.0, 0.0, 0.0, 0.03407525280610657, 0.0, 0.0, 0.0, 0.07092537493489116, 0.0, 0.0, 0.023926802333318554, 0.0, 0.03941537854267549, 0.0, 0.0, 0.0, 0.0, 0.10937063438351756, 0.08715770469631079, 0.0, 0.05841899435928017, 0.016328676622408153, 0.002218517959171183, 0.0, 0.0, 0.0, 0.08186919626269101, 0.03173286609277701, 0.08737065271898292, 0.0, 0.0, 0.041505225727435785, 0.05033635148761689, 0.0, 0.09172214842175723, 0.027548495513552738, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0259929997624099, 0.0, 0.0, 0.028044483157851748, 0.0, 0.0, 0.0] 
```

With 50 histograms each with 50 bins, now very few zero values:

```
[0.0219136051655165, 0.0, 0.028325808078797768, 0.0, 0.040889043180965624, 0.04372501089775975, 0.0, 0.031032870504105477, 0.020745831040881676, 0.04794861828714149, 0.0, 0.03763592540998652, 0.0029093177405377577, 0.0034239051136138398, 0.0, 0.03079554151573207, 0.0, 0.04676278554085836, 0.0461258666541918, 9.639105313353352e-05, 0.0, 0.013649362063473166, 0.059168272186891635, 0.06703936360466661, 0.0, 0.0, 0.03175895249795131, 0.0, 0.0, 0.04376133487616099, 0.02406633433758186, 0.009724226721798858, 0.05058252335384487, 0.0, 0.0393763638188805, 0.05287112817101315, 0.0, 0.0, 0.06365320629437914, 0.0, 0.024978299494456246, 0.023531082497830605, 0.033406648550332804, 0.012693750980220679, 0.00274892002684083, 0.0, 0.0, 0.0, 0.0, 0.04465971034045478, 4.888224154453002] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T17:35:06.473

你能抽取一些完整的随机样本（500 个），然后选择最均匀的一个（即最低的`sample.sum(axis=0).std()`）吗？这避免了在绘制增量样本时出现奇怪的偏差。

# javascript - 页面上任何复选框更改的功能

> ID：14791921
> 
> 赞同：0
> 
> 时间：2013-02-09T21:42:21.850
> 
> 标签：javascript, jquery

一般来说，我是 JQuery 的新手，我希望在页面上的任何复选框被选中或不选中时激活一个功能。然后它应该检查复选框是否处于“选中”状态。

我不确定如何执行此操作，因为我看到的所有示例都需要复选框的名称才能工作。如果这也是在 Javascript 中，我会很好。

有人有想法么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T21:44:06.603

`$('input[type="checkbox"]')`将选中您页面上的所有复选框。

当您的任何复选框被更改并被选中时，以下将运行一个函数：

```
$('input[type="checkbox"]').change(function(){
    if($(this).is(':checked')) {//do something}
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T21:45:28.253

动态绑定您的复选框以更改事件，并检查它们是否被选中，然后执行您选择的功能。

```
$(document).on("change", ".chkelement", function(){
   if( $(this).is(":checked") )
   {
      //DO SOMETHING
   }
}); 
```

我建议使用“文档”以外的容器，尽可能靠近复选框的位置，但你明白吗？

# f# - 使用自定义版本的 FSharp.Core.dll

> ID：14791925
> 
> 赞同：3
> 
> 时间：2013-02-09T21:43:08.937
> 
> 标签：f#, mono, portable-class-library

我一直在研究 fsharp 编译器源代码以尝试构建 FSharp.Core 的 wp7 版本（[适用于 Windows Phone 7.1 和 F# 3.0](https://stackoverflow.com/questions/14694577/fsharp-core-for-windows-phone-7-1-and-f-3-0)的 FSharp.Core ），有一次我放弃并开始尝试制作便携式版本与 wp7 一起工作。我将`FX_NO_STRUCTURAL_EQUALITY`定义添加到`portable-net4+sl4+wp71+win8`目标框架，这似乎是导致它在运行时不起作用的原因，并尝试`C:\Program Files (x86)\Reference Assemblies\Microsoft\FSharp\3.0\Runtime\.NETPortable`用我的自定义版本替换 FSharp.Core.dll。但是在 Visual Studio 中编译时出现此错误：

```
Warning 1   The primary reference "FSharp.Core" could not be resolved because it has an indirect dependency on the framework assembly "mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" which could not be resolved in the currently targeted framework. ".NETPortable,Version=v4.0,Profile=Profile47". To resolve this problem, either remove the reference "FSharp.Core" or retarget your application to a framework version which contains "mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089".    C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets  1578    5   FSharp.Data.Portable
Warning 3   The primary reference "FSharp.Core" could not be resolved because it has an indirect dependency on the framework assembly "System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" which could not be resolved in the currently targeted framework. ".NETPortable,Version=v4.0,Profile=Profile47". To resolve this problem, either remove the reference "FSharp.Core" or retarget your application to a framework version which contains "System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089".    C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets  1578    5   FSharp.Data.Portable
Warning 2   The primary reference "FSharp.Core" could not be resolved because it has an indirect dependency on the framework assembly "System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" which could not be resolved in the currently targeted framework. ".NETPortable,Version=v4.0,Profile=Profile47". To resolve this problem, either remove the reference "FSharp.Core" or retarget your application to a framework version which contains "System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089".  C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets  1578    5   FSharp.Data.Portable 
```

问题是VS2012自带的可移植FSharp.Core依赖于mscorlib.dll、System.dll和System.Core.dll这些程序集的可移植2.0.5.0版本，但我从源代码编译的依赖于不可移植4.0.0.0 版本。有没有人从源代码成功构建了便携式版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T10:57:12.130

你可以做的是添加：

`<OtherFlags>$(OtherFlags) --simpleresolution -r:"pathToTheCorrectmscorlib/mscorlib-runtime.dll" </OtherFlags>`

到`FSharp.Source.Targets`文件。`<DefineConstants>`在元素之后执行此正确文件。这应该会导致编译阶段使用`mscorlib`您指定的版本，而不是 msbuild 目标指定的默认版本。（显然替换`pathToTheCorrectmscorlib/mscorlib-runtime.dll`为正确的:)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T14:27:17.887

经过几次更改后，将portable-net4+sl4+wp71+win8目标从F#源编译为Profile88 [https://github.com/ovatsus/fsharp](https://github.com/ovatsus/fsharp)

不过，仍然需要在运行时彻底测试

# javascript - Jquery 无法与任何浏览器一起使用

> ID：14791929
> 
> 赞同：-1
> 
> 时间：2013-02-09T21:43:40.093
> 
> 标签：javascript, jquery, html

我的代码是这样的。但它不适用于任何浏览器。此代码已从 w3scools 复制粘贴。我的其他代码也是如此。

```
<!DOCTYPE html>
<html>
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js">
</script>
<script>
$(document).ready(function(){
  $("button").click(function(){
     $("p").hide();
  });
});
</script>
</head>

<body>
<h2>This is a heading</h2>
<p>This is a paragraph.</p>
<p>This is another paragraph.</p>
<button>Click me</button>
</body> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T21:49:30.083

我不知道这是否可行，但请尝试添加`http:`到链接参考的开头。此外，正如其他人指出的那样，关闭您的`<html>`标签。

```
<!DOCTYPE html>
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js">
</script>
<script>
$(document).ready(function(){
  $("button").click(function(){
     $("p").hide();
  });
});
</script>
</head>

<body>
<h2>This is a heading</h2>
<p>This is a paragraph.</p>
<p>This is another paragraph.</p>
<button>Click me</button>
</body>
</html> 
```

我建议的另一件事是使用 jQuery 的 CDN 进行 jQuery 托管。URL 要短得多，它可以让您获得最新版本，而无需定义版本：

```
<script src="http://code.jquery.com/jquery.min.js"></script> 
```

但是，我看到您使用的是 1.8.3 版本，这可能是出于特定原因，因此只需`jquery`在 url 中添加您想要的版本即可。`jquery-1.8.3.min.js`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T21:45:12.447

指向您的 jQuery 脚本的链接不起作用。将其替换为：

```
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script> 
```

反而。

旧链接对我不起作用，但是用另一个链接替换它后它就可以正常工作了。

（我假设你注意到了丢失的`</html>`.）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T22:50:25.823

您的代码确实可以工作（即使没有缺少 html 结束标记 :-P），但前提是它是从服务器运行的。这与 jQuery 文件的 URI 有关。

如果你在本地运行文件，浏览器猜测它应该使用文件协议下载文件，所以：

```
file://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js 
```

如果您打开浏览器的开发工具（通常按 F12 键），它应该会显示一个错误，指出浏览器无法从 file:// URL 加载 jQuery 文件。如果您将 http（或 https）作为协议，它知道从哪里获取 jQuery 并且一切正常。

有趣的是，如果您在服务器上运行该文件（我猜这是 w3schools 的意图），那么浏览器会猜测它应该是 http 或 https 协议并找到 jQuery 文件。

如果你想不费吹灰之力地尝试运行一个网络服务器，Python（因为它很棒）让你只用一个命令就可以运行一个网络服务器：

```
python -m SimpleHTTPServer 
```

它在以下位置运行服务器：

```
http://0.0.0.0:8000 
```

并从您运行它的目录中提供文件。这个网址有更多关于它的细节：[http ://www.linuxjournal.com/content/tech-tip-really-simple-http-server-python](http://www.linuxjournal.com/content/tech-tip-really-simple-http-server-python)

我不知道服务器要求（感谢您的提问！），我在旅行中发现了这一点，我认为这很有趣。它讨论了缺少的协议如何有效 html [StackOverflow：在脚本标签中用 // 替换 http:// 是否有效？](https://stackoverflow.com/questions/550038/is-it-valid-to-replace-http-with-in-a-script-src-http)

# listview - 设置所选项目的最大数量

> ID：14791935
> 
> 赞同：1
> 
> 时间：2013-02-09T21:44:09.400
> 
> 标签：listview, gridview, windows-runtime, max, selecteditem

这可能是一个愚蠢的问题，但是......我如何在列表视图/网格视图中实现最大数量的选定项目？

我有一个包含 9 个项目的列表视图，我希望用户只能从中选择 5 个。

到目前为止，我已经在`SelectionChanged`事件中实现了这个：

```
if (MyListView.SelectedItems.Count >5)
    MyListView.SelectedItems.RemoveAt(0); 
```

这是一种有趣但回避的方法，当第 6 项被选中时，第 1 项被取消选择，因此它们始终保持为 5。

不过，我想要的是，当我已经选择了 5 个项目时，无法再选择其他项目，除非我同时取消选择一个项目并且我满足`SelectedItems.Count`< 5 的条件。

非常感谢任何建议、想法、代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:49:55.270

这确实是一个愚蠢的问题......我想了很多，但我完全没有想法，在我发布这个之后只有 5 分钟......并且代码看起来像这样：

```
if (MyListView.SelectedItems.Count >5)
    MyListView.SelectedItems.RemoveAt(MyListView.SelectedItems.Count-1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:35:03.633

事件处理程序：

```
 this.MyListView.ItemSelectionChanged += new  System.Windows.Forms.ListViewItemSelectionChangedEventHandler(this.MyListView_ItemSelectionChanged); 
```

代码：

```
 private void MyListView_ItemSelectionChanged(object sender,     ListViewItemSelectionChangedEventArgs e)
    {
        if (MyListView.SelectedItems.Count > 5)
        { MyListView.SelectedItems[0].Selected = false; }
    } 
```

# mysql - MySQL 使用 Group By 来限制结果

> ID：14791936
> 
> 赞同：1
> 
> 时间：2013-02-09T21:44:19.523
> 
> 标签：mysql, sql

好的，所以我正在尝试执行一个包含 4 个表、用户、事件、event_roles、user_event_role 的查询。

用户可以填充多个角色。我想要做的是得到一个看起来更像这样的结果：用户、事件、角色

因此，如果用户 'Bill' 与事件 'Meeting' 相关联，并且 'Bill' 填充多个角色而不是得到这样的结果：

```
user   event     role
--------------------------
bill   Meeting   admin
bill   Meeting   director 
```

我怎样才能得到这样的结果

```
user   event     role    role
----------------------------------
bill   Meeting   admin   director 
```

这是我正在尝试构建的查询。

```
Select * 
  FROM `users` u 
LEFT JOIN `event_role` er ON u.user_id = er.user_id 
LEFT JOIN `events` e ON er.event_id = e.event_id 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T21:53:36.253

你寻求的结果是不可能的。

但是有一些接近的东西：

```
SELECT
  user,
  event,
  group_concat(role SEPARATOR ',') as roles
FROM
  `users` u 
  LEFT JOIN `event_role` er
    ON u.user_id = er.user_id 
  LEFT JOIN `events` e
    ON er.event_id = e.event_id
GROUP BY u.user_id 
```

这将产生：

```
user   event     roles
----------------------
bill   Meeting   admin,director 
```

无论哪种情况，您都需要调整逻辑以正确解析它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T21:56:34.920

您无法得到这样的结果，因为您不知道可能有多少个角色（即列数），但您可以使用`GROUP_CONCAT`这种方式：

```
SELECT *,
GROUP_CONCAT(event_roles.role SEPARATOR ',') as roles
FROM users
LEFT JOIN event_role USING(user_id)
LEFT JOIN events USING(user_id)
GROUP BY user_id 
```

使用此查询，您将获得所有角色与`,`. 但请注意 的限制`GROUP_CONCAT`，默认值设置为 1024 个字符，这可能还不够（请参阅`my.cnf`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T22:15:29.503

像这样使用 Group_concat ( [http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html) )。为了快速展示这一点，我使用了 Ben Forta 的优秀 MySQL 介绍书 ( [http://www.forta.com/books/0672327120/](http://www.forta.com/books/0672327120/) ) 中的数据库，没有隶属关系。

```
SELECT v.vend_id, GROUP_CONCAT(p.prod_id)
FROM products p 
JOIN  vendors v ON v.vend_id= p.vend_id
JOIN  orderitems oi ON oi.prod_id = p.prod_id
GROUP BY v.vend_id; 
```

# c# - 将 Entity Framework 4.1 数据库迁移到 EF5 以进行升级，为新安装创建新数据库

> ID：14791942
> 
> 赞同：3
> 
> 时间：2013-02-09T21:44:45.523
> 
> 标签：c#, .net, entity-framework

我目前正在开发具有版本 1 用户现有代码库的应用程序的版本 2，但我还需要向新用户推出新版本（即全新安装）。版本 1 使用实体框架 4.1。版本 2 使用实体框架 5。

我的问题是我需要能够将现有的版本 1 用户升级到版本 2 并将他们的数据库迁移到新版本的架构。新模式添加了许多新表，保留了几个现有表不变并删除了其他表。

我在旅行中发现 EF4.1 不包含`_MigrationHistory`表格。所以我回到了我的原始版本 1 代码，将其升级到 EF5 并运行初始迁移，如下所示：

```
Add-Migration Initial -IgnoreChanges 
```

这可以很好地使原始版本 1 (EF4.1) 数据库为迁移做好准备（即添加`_MigrationHistory`表）。然后我将它移植到我的版本 2 代码并运行：

```
Update-Database 
```

它创建了`_MigrationHistory`表，然后我运行：

```
Add-Migration Version2 
```

这会很好地将数据库迁移到版本 2。

如果数据库已经存在于版本 1 架构或版本 2 架构中（在后一种情况下不应用迁移），这将非常有效，因为我正在使用以下初始化程序：

```
Database.SetInitializer(new MigrateDatabaseToLatestVersion<MyDbContext, Configuration>()); 
```

但是，如果数据库不存在，则`Initial`迁移成功运行，但`Version2`迁移失败，因为某些迁移步骤会删除空数据库中显然不存在的表、索引和外键。

所以我完全不知所措——如何将现有的版本 1 用户迁移到版本 2（并保留他们的数据），而且还支持需要完全从头开始创建数据库的新安装？

我已经看到很多关于创建和运行 SQL 脚本以进行迁移的想法，但我确实需要在我的应用程序启动时自动完成。最终用户应该只需要运行一个 MSI 文件就可以升级。

**更新**：这是 w.brian 下面建议的解决方案（对不起，我还不能投票）：

```
string connectionString = ConfigurationManager.ConnectionStrings["DbContext"].ConnectionString;
if (Database.Exists(connectionString))
{
    Database.SetInitializer(new MigrateDatabaseToLatestVersion<DbContext, Migrations.Configuration>());
}
else
{
    Database.SetInitializer(new DefaultDataInitialiser());
} 
```

**UPDATE2**：以上似乎是第一次通过新创建工作。但是，下一次运行通过`Database.Exists()`检查并尝试迁移数据库。但是，由于表中只有一个条目`_MigrationHistory`（由新安装/全新安装生成）并且迁移有两个条目（一个用于 EF4.1 迁移；一个用于新模式），因此迁移逻辑从头开始并尝试应用每个迁移。

这失败了，因为它试图创建数据库中已经存在的表——它创建了这些表作为全新安装的一部分！

所以关键是，这种方法搞乱了迁移逻辑。

**UPDATE3**：所以我想我已经弄清楚如何创建初始数据库并允许后续运行仅应用迁移。从上面看，如果数据库已经存在，继续迁移代码。

如果数据库尚不存在，请`DefaultDataInitialiser`在方法中使用 and `Seed()`，执行以下操作：

```
context.Database.ExecuteSqlCommand(@"DELETE FROM [__MigrationHistory]");

byte[] version1Model = ConvertHexStringToByteArray("1F8B...");
context.Database.ExecuteSqlCommand(@"INSERT INTO [__MigrationHistory]
                                        ([MigrationId]
                                        ,[Model]
                                        ,[ProductVersion])
                                    VALUES
                                        ('201302082120145_Initial'
                                        ,{0}
                                        ,'5.0.0.net40')", new object[] { version1Model });

byte[] version2Model = ConvertHexStringToByteArray("1F8B...");
context.Database.ExecuteSqlCommand(@"INSERT INTO [__MigrationHistory]
                                        ([MigrationId]
                                        ,[Model]
                                        ,[ProductVersion])
                                    VALUES
                                        ('201302082200350_Version-2'
                                        ,{0}
                                        ,'5.0.0.net40')", version2Model); 
```

从迁移逻辑的角度来看，这使新数据库“完全迁移”。下次运行应用程序时，数据库存在并且`MigrateDatabaseToLatestVersion`魔法运行，看到数据库是最新版本（或将来升级到下一次迁移）并且很高兴。

`Seed()`不幸的是，将来从头开始创建数据库时，每次新的迁移都需要添加到此方法中。

我从哪里得到用于模型的十六进制字符串？我从数据库的迁移版本中从 SQL Server Management Studio 复制了它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:09:58.923

我只会`MigrateDatabaseToLatestVersion`在升级时使用初始化程序，而不是在新安装时使用。这将要求您直接查询 SQL Server 以查看数据库是否存在，但我认为这应该不会太难，因为您可以访问连接字符串。

# crystal-reports - 详细信息部分中的水晶报表文本对象

> ID：14791943
> 
> 赞同：0
> 
> 时间：2013-02-09T21:44:45.223
> 
> 标签：crystal-reports

**我希望报告在详细信息部分**中像这样打印：

```
 [textObject]                      [textObject]  (1) database field [textObject]
 [textObject]                      [textObject]  (2) database field [textObject]   
 [textObject]                      [textObject]  (3) database field [textObject] 
```

但它最终打印如下：

```
[textObject]                       [textObject](1)                  [textObject]
[textObject]                       [textObject](2) <database field> [textObject]
[textObject]                       [textObject](3) <database field> [textObject]
[textObject]                       [textObject](4) <database field> [textObject] 
```

似乎它正在打印没有数据库记录的额外行。它是一封将大量文本对象与介于两者之间的数据库字段组合在一起的申请书。请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:48:16.473

右键单击文本字段并选择属性，如果空白则选择抑制。希望这会奏效

除了抑制选项，您将看到公式按钮。单击它并将公式写为

如果数据库字段名称 = null

让我知道它是否有帮助

# java - 在不同包的子类中将 super() 用于 equals()

> ID：14791945
> 
> 赞同：0
> 
> 时间：2013-02-09T21:45:08.090
> 
> 标签：java, inheritance, compilation, nullpointerexception, package

我有一个位于包 A 中的类 Vehicle 和一个位于包 B 中的类 Car，我想使用 equals 方法并通过使用 super() 来利用继承，但我不知道该怎么做。

当我尝试在 main 中运行文件时，我得到了这个：

```
Exception in thread "main" java.lang.NullPointerException
    at vehicle.Vehicle.equals(Vehicle.java:97)
    at car.Car.equals(Car.java:104)
    at Main.main(Main.java:48) 
```

这是代码：

```
public boolean equals(Vehicle other) {
    if (this.type.equals(other.type)) {
        if (this.year == other.year && this.price == other.price) {
            return true;
        } else {
            return false;
        }
    } else {
        return false;
    }
}
//equals in Car
public boolean equals(Car other) {
    if (this.type.equals(other.type)) {
        if (this.speed == other.speed && this.door == other.door) {
            if (super.equals(other)) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:47:35.813

`equals()`当作为参数传递时，按照[合同的](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#equals%28java.lang.Object%29)方法应该返回：`false``null`

> 对于任何非空引用值`x`，`x.equals(null)`应该返回`false`。

在每个`equals()`方法的最开始添加：

```
if(other == null) {
  return false;
} 
```

其次，您必须覆盖`equals()`，而不是重载它：

```
public boolean equals(Object other) 
```

最后，您需要`instanceof`向下转换才能使这一切正常工作。

顺便说一句：

```
if (this.speed == other.speed && this.door == other.door)
{
    if(super.equals(other))
    {
        return true;
    }
    else
    {
        return false;
    }
}
else
{
    return false;
} 
```

相当于：

```
if (this.speed == other.speed && this.door == other.door)
{
    return super.equals(other);
}
else
{
    return false;
} 
```

反过来又可以简化为：

```
return this.speed == other.speed && this.door == other.door && super.equals(other); 
```

# xml - 使用 xslt 将 xml 文档导入开放式办公室

> ID：14791947
> 
> 赞同：2
> 
> 时间：2013-02-09T21:45:21.480
> 
> 标签：xml, xslt, import, libreoffice

我正处于构建 xslt 文档以将 xml 数据导入自由办公电子表格的早期阶段。xml 数据表示 xgmml 格式的图（带有节点和边）。在这个阶段，我只是（？）尝试选择图中的所有节点，提取“标签”属性，并将每个标签放在电子表格中单行的单元格中。

我能够在 libre-office 中安装 .xslt 并打开 .xgmml 文件。

我可以使用 .xslt 从 .xgmml 中提取一些数据并将其添加到电子表格中

但是，由于某种原因，我无法选择节点并提取标签。

有人可以指出我的（无疑）愚蠢的错误吗？

参考....

*   [http://www.w3schools.com/xpath/xpath_syntax.asp](http://www.w3schools.com/xpath/xpath_syntax.asp)
*   [http://www.w3schools.com/xsl/xsl_for_each.asp](http://www.w3schools.com/xsl/xsl_for_each.asp)
*   [http://forum.openoffice.org/en/forum/viewtopic.php?f=45&t=3490](http://forum.openoffice.org/en/forum/viewtopic.php?f=45&t=3490)

我正在处理的 .xgmml .xslt 和 .odt 文档如下：

XGMML------------------------------------------------------

```
<?xml version="1.0" encoding="UTF-8"?>
<graph directed="1" label="Graph:-1" xmlns="http://www.cs.rpi.edu/XGMML/" xmlns:cy="http://www.cytoscape.org/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#/" xmlns:xlink="http://www.w3.org/1999/xlink/"
xmlns:dc="http://purl.org/dc/elements/1.1/">
    <node id="204g-1" label="204g-1" start="441940">
        <att name="RTC" type="real" value="12.45 " start="443028"/>
        <att name="LTD" type="real" value="1.53 " start="443495"/>
        <att name="LTD" type="real" value="1.63 " start="721167"/>
        <att name="LOD" type="real" value="1.23 " start="721200"/>
        <att name="LOD" type="real" value="1.32 " start="104941642"/>
        <att name="RTC" type="real" value="7.31 " start="106070988"/>
        <att name="LTD" type="real" value="1.76 " start="106071018"/>
        <att name="LTD" type="real" value="1.81 " start="107270843"/>
        <att name="LOD" type="real" value="1.20 " start="107270868"/>
    </node>
    <edge source="204g-1" target="202g-1" label="0e0" start="443681">
        <att name="ITB" type="integer" value="256" start="445896"/>
        <att name="LTD" type="real" value="1.84 " start="445934"/>
        <att name="ITB" type="integer" value="256" start="721217"/>
        <att name="LTD" type="real" value="1.60 " start="721250"/>
        <att name="ITB" type="integer" value="256" start="1047946"/>
        <att name="LTD" type="real" value="1.59 " start="1048117"/>
        <att name="ITB" type="integer" value="256" start="1611675"/>
        <att name="LTD" type="real" value="1.57 " start="1611810"/>
    </edge>
    <node id="202g-1" label="202g-1" start="443660"/>
    <edge source="204g-1" target="84g-1" label="1e1" start="445960" end="9443711">
        <att name="ITB" type="integer" value="148" start="445968"/>
        <att name="LTD" type="real" value="1.98 " start="721301"/>
        <att name="LTD" type="real" value="2.35 " start="1612024"/>
        <att name="LTD" type="real" value="1.99 " start="4159942"/>
        <att name="LTD" type="real" value="1.91 " start="6158290"/>
        <att name="ITB" type="integer" value="3" start="7201361"/>
        <att name="LTD" type="real" value="2.67 " start="8339315"/>
    </edge>
    <node id="84g-1" label="84g-1" start="445959" end="9443711"/>
    <edge source="204g-1" target="27g-1" label="2e2" start="446016" end="876899">
        <att name="ITB" type="integer" value="148" start="446021"/>
        <att name="LTD" type="real" value="1.91 " start="446043"/>
        <att name="ITB" type="integer" value="163" start="721316"/>
        <att name="LTD" type="real" value="1.76 " start="721348"/>
    </edge>
    <node id="27g-1" label="27g-1" start="446015"/>
    <edge source="204g-1" target="17g-1" label="3e3" start="446066" end="2926490">
        <att name="ITB" type="integer" value="148" start="446072"/>
        <att name="LTD" type="real" value="1.71 " start="721396"/>
        <att name="ITB" type="integer" value="168" start="1612329"/>
        <att name="ITB" type="integer" value="218" start="2344316"/>
        <att name="LTD" type="real" value="2.00 " start="2344594"/>
    </edge>
</graph> 
```

XSLT------------------------------------------------ -------------

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="/"> 

<office:document-content 
    xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" 
    xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" 
    xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" 
    xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" 
    xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" 
    xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" 
    xmlns:xlink="http://www.w3.org/1999/xlink" 
    xmlns:dc="http://purl.org/dc/elements/1.1/" 
    xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" 
    xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" 
    xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" 
    xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" 
    xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" 
    xmlns:math="http://www.w3.org/1998/Math/MathML" 
    xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" 
    xmlns:ooo="http://openoffice.org/2004/office" 
    xmlns:ooow="http://openoffice.org/2004/writer" 
    xmlns:oooc="http://openoffice.org/2004/calc" 
    xmlns:dom="http://www.w3.org/2001/xml-events" 
    xmlns:xforms="http://www.w3.org/2002/xforms" 
    xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" office:version="1.0">

   <office:body>
    <office:spreadsheet>
     <table:table table:name="nodes">

      <!-- Insert column labels,  -->
      <table:table-row>
       <xsl:for-each select="graph/node">
        <table:table-cell>
         <text:p><xsl:value-of select="@label"/></text:p>
        </table:table-cell>
       </xsl:for-each>
      </table:table-row>    

      <table:table-row>
       <table:table-cell>
        <text:p>the column labels are missing above</text:p>
       </table:table-cell>
      </table:table-row>    

      <table:table-row>
       <table:table-cell>
        <text:p>but this works</text:p>
       </table:table-cell>
      </table:table-row>    

      <table:table-row>
       <xsl:for-each select="//@label">
        <table:table-cell>
         <text:p><xsl:value-of select="."/></text:p>
        </table:table-cell>
       </xsl:for-each>
      </table:table-row>    

      <table:table-row>
       <table:table-cell>
        <text:p>not very useful unfortunately .....</text:p>
       </table:table-cell>
      </table:table-row>    

     </table:table>
    </office:spreadsheet>
   </office:body>
  </office:document-content>
</xsl:template>
</xsl:stylesheet> 
```

ODT-------------------------------------- -----------------

```
 A       B       C       D       E       F
1   204g1   202g-1  84g-1
2
3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T13:43:50.817

Because your `graph` element has `xmlns="http://www.cs.rpi.edu/XGMML/"`, all the unprefixed elements in your source XML are in this namespace, but in XPath expressions, an unprefixed name matches elements that are *not* in a namespace. Therefore you need to bind the `http://www.cs.rpi.edu/XGMML/` namespace URI to a prefix in your stylesheet and use that prefix in the XPaths:

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:g="http://www.cs.rpi.edu/XGMML/" exclude-result-prefixes="g">

  <xsl:template match="/">
    <!-- ... --> 
    <xsl:for-each select="g:graph/g:node">
     <table:table-cell>
      <text:p><xsl:value-of select="@label"/></text:p>
     </table:table-cell>
    </xsl:for-each>
    <!-- ... --> 
  </xsl:template>
</xsl:stylesheet> 
```

# scala - 使用 sbt-assembly 的程序集合并策略问题

> ID：14791955
> 
> 赞同：28
> 
> 时间：2013-02-09T21:46:15.463
> 
> 标签：scala, deployment, sbt, executable-jar, sbt-assembly

我正在尝试使用[sbt-assembly](https://github.com/sbt/sbt-assembly)将 scala 项目转换为可部署的 fat jar 。当我在 sbt 中运行我的组装任务时，我收到以下错误：

```
Merging 'org/apache/commons/logging/impl/SimpleLog.class' with strategy 'deduplicate'
    :assembly: deduplicate: different file contents found in the following:
    [error] /Users/home/.ivy2/cache/commons-logging/commons-logging/jars/commons-logging-1.1.1.jar:org/apache/commons/logging/impl/SimpleLog.class
    [error] /Users/home/.ivy2/cache/org.slf4j/jcl-over-slf4j/jars/jcl-over-slf4j-1.6.4.jar:org/apache/commons/logging/impl/SimpleLog.class 
```

现在来自 sbt-assembly 文档：

> 如果多个文件共享相同的相对路径（例如，多个依赖 JAR 中名为 application.conf 的资源），默认策略是验证所有候选文件是否具有相同的内容，否则会出错。可以使用以下内置策略之一或编写自定义策略基于每个路径配置此行为：
> 
> *   `MergeStrategy.deduplicate`是上面描述的默认值
> *   `MergeStrategy.first`按类路径顺序选择第一个匹配的文件
> *   `MergeStrategy.last`选择最后一个
> *   `MergeStrategy.singleOrError`使用有关冲突的错误消息退出
> *   `MergeStrategy.concat`简单地连接所有匹配的文件并包含结果
> *   `MergeStrategy.filterDistinctLines`也连接，但沿途遗漏重复项
> *   `MergeStrategy.rename`重命名源自 jar 文件的文件
> *   `MergeStrategy.discard`简单地丢弃匹配的文件

通过这个我设置我的 build.sbt 如下：

```
import sbt._
import Keys._
import sbtassembly.Plugin._
import AssemblyKeys._
name := "my-project"
version := "0.1"
scalaVersion := "2.9.2"
crossScalaVersions := Seq("2.9.1","2.9.2")

//assemblySettings
seq(assemblySettings: _*)

resolvers ++= Seq(
    "Typesafe Releases Repository" at "http://repo.typesafe.com/typesafe/releases/",
    "Typesafe Snapshots Repository" at "http://repo.typesafe.com/typesafe/snapshots/",
    "Sonatype Repository" at "http://oss.sonatype.org/content/repositories/releases/"
)

libraryDependencies ++= Seq(
    "org.scalatest" %% "scalatest" % "1.6.1" % "test",
    "org.clapper" %% "grizzled-slf4j" % "0.6.10",
    "org.scalaz" % "scalaz-core_2.9.2" % "7.0.0-M7",
    "net.databinder.dispatch" %% "dispatch-core" % "0.9.5"
)

scalacOptions += "-deprecation"
mainClass in assembly := Some("com.my.main.class")
test in assembly := {}
mergeStrategy in assembly := mergeStrategy.first 
```

在 build.sbt 的最后一行，我有：

```
mergeStrategy in assembly := mergeStrategy.first 
```

现在，当我运行 SBT 时，我收到以下错误：

```
error: value first is not a member of sbt.SettingKey[String => sbtassembly.Plugin.MergeStrategy]
    mergeStrategy in assembly := mergeStrategy.first 
```

有人可以指出我在这里可能做错了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-03-25T15:28:32.440

对于当前版本0.11.2（2014-03-25），定义合并策略的方式不同。

这[在此处](https://github.com/sbt/sbt-assembly)记录，相关部分是：

> 注意：程序集中的 mergeStrategy 需要一个函数，你不能这样做
> 
> ```
> mergeStrategy in assembly := MergeStrategy.first 
> ```

新方法是（从同一来源复制）：

```
mergeStrategy in assembly <<= (mergeStrategy in assembly) { (old) =>
  {
    case PathList("javax", "servlet", xs @ _*)         => MergeStrategy.first
    case PathList(ps @ _*) if ps.last endsWith ".html" => MergeStrategy.first
    case "application.conf" => MergeStrategy.concat
    case "unwanted.txt"     => MergeStrategy.discard
    case x => old(x)
  }
} 
```

这可能也适用于早期版本，我不知道它是什么时候改变的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-10T11:46:27.080

我觉得应该是`MergeStrategy.first`带资本的`M`，所以`mergeStrategy in assembly := MergeStrategy.first`。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-01-04T22:06:31.727

这是合并大多数常见 java/scala 项目的正确方法。它负责 META-INF 和类。

还负责 META-INF 中的服务注册。

```
assemblyMergeStrategy in assembly := {
case x if Assembly.isConfigFile(x) =>
  MergeStrategy.concat
case PathList(ps @ _*) if Assembly.isReadme(ps.last) || Assembly.isLicenseFile(ps.last) =>
  MergeStrategy.rename
case PathList("META-INF", xs @ _*) =>
  (xs map {_.toLowerCase}) match {
    case ("manifest.mf" :: Nil) | ("index.list" :: Nil) | ("dependencies" :: Nil) =>
      MergeStrategy.discard
    case ps @ (x :: xs) if ps.last.endsWith(".sf") || ps.last.endsWith(".dsa") =>
      MergeStrategy.discard
    case "plexus" :: xs =>
      MergeStrategy.discard
    case "services" :: xs =>
      MergeStrategy.filterDistinctLines
    case ("spring.schemas" :: Nil) | ("spring.handlers" :: Nil) =>
      MergeStrategy.filterDistinctLines
    case _ => MergeStrategy.first
  }
case _ => MergeStrategy.first} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-07-04T09:21:38.407

我刚刚设置了一个需要重新连接一些 mergeStrategies 的小 sbt 项目，发现答案有点过时，让我添加我的版本工作代码（截至 2015 年 4 月 7 日）

*   sbt 0.13.8
*   斯卡拉 2.11.6
*   组装 0.13.0

    ```
    mergeStrategy in assembly := {
      case x if x.startsWith("META-INF") => MergeStrategy.discard // Bumf
      case x if x.endsWith(".html") => MergeStrategy.discard // More bumf
      case x if x.contains("slf4j-api") => MergeStrategy.last
      case x if x.contains("org/cyberneko/html") => MergeStrategy.first
      case PathList("com", "esotericsoftware", xs@_ *) => MergeStrategy.last // For Log$Logger.class
      case x =>
         val oldStrategy = (mergeStrategy in assembly).value
         oldStrategy(x)
    } 
    ```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-07-15T10:53:26.573

对于新的 sbt 版本（sbt-version :0.13.11），我收到了 slf4j 的错误；暂时采取简单的方法：还请在此处检查答案[Scala SBT Assembly cannot merge due to deduplication error in StaticLoggerBinder.class](https://stackoverflow.com/questions/29245669/scala-sbt-assembly-cannot-merge-due-to-de-duplication-error-in-staticloggerbinde) 其中提到了[sbt-dependency-graph](https://github.com/jrudolph/sbt-dependency-graph)工具，手动执行此操作非常酷

```
assemblyMergeStrategy in assembly <<= (assemblyMergeStrategy in assembly) {
  (old) => {
    case PathList("META-INF", xs @ _*) => MergeStrategy.discard
    case x => MergeStrategy.first
  }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-02-22T18:01:58.980

快速更新：mergeStrategy 已弃用。使用 assemblyMergeStrategy。除此之外，早期的反应仍然可靠

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-09-20T07:48:27.643

将以下内容添加到 build.sbt 以将 kafka 添加为源或目标

```
 assemblyMergeStrategy in assembly := {
 case PathList("META-INF", xs @ _*) => MergeStrategy.discard
 //To add Kafka as source
 case "META-INF/services/org.apache.spark.sql.sources.DataSourceRegister" => 
 MergeStrategy.concat
 case x => MergeStrategy.first
 } 
```

# android - 如何从 Android shell 中的 PS 命令输出中获取 PID

> ID：14791956
> 
> 赞同：0
> 
> 时间：2013-02-09T21:46:15.520
> 
> 标签：android, shell

谁能告诉我如何从 Android shell 中 PS 命令的输出中获取 PID。例如从输出：

```
u0_a51    20240 38    132944 22300 ffffffff 40037ebc S com.example.poc_service 
```

pid 值`20240`是要得到的。我试过了

```
ps -ef | grep com.example.poc_service 
```

但无济于事。也不`pgrep`被认可。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-06T01:05:49.573

如果您在 Android 中有 shell 访问权限，您还可以使用`pidof`：

```
# pidof com.example.poc_service
20240 
```

但是，要小心，因为可能有多个进程匹配......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-09T09:30:48.900

它非常讨厌，但它有效：

```
for pid in `ls /proc`; do 
   cmd=`cat $pid/cmdline 2> /dev/null`;

   if [ "X$cmd" == "Xcom.example.poc_service" ]; then
       echo $pid;
   fi 
done 
```

或一行：

```
for pid in `ls /proc`; do cmd=`cat $pid/cmdline 2> /dev/null`; if [ "X$cmd" == "X/system/bin/mm-qcamera-daemon" ]; then echo $pid; fi done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-06T01:49:41.067

`grep`, `egrep`, `fgrep`,`rgrep`在 Android 中均不可用。

如果您正在处理`Unix`、或`Linux`，则可以通过管道输出命令以获得所需的结果。`Mac``Cygwin``adb shell`

```
$ adb shell ps |grep settings
system    23846 71    111996 22676 ffffffff 00000000 S com.android.settings
$ adb shell ps |grep settings |awk '{print $2}'
23846 
```

# ruby-on-rails - Guard + spork + Rspec 问题 - 如何删除挂钩到 Test::Unit？

> ID：14791957
> 
> 赞同：7
> 
> 时间：2013-02-09T21:46:20.567
> 
> 标签：ruby-on-rails, rspec, guard, testunit, spork

我在 Ubuntu 12.04 上的 rails 3.2.11 项目上运行了guard-spork。

我从[railstutorial.org](http://ruby.railstutorial.org/chapters/static-pages#sec-guard)获得了我的配置。

Spork 启动，然后守卫说找不到 spork 启动，等待 30 秒，然后 60 秒，然后工作。

它可以工作，但每次启动时都会出错。只是想知道我是否做错了什么。

如何删除 Test::Unit 的挂钩？

错误信息：

```
16:31:58 - INFO - Starting Spork for RSpec, Test::Unit
Using RSpec
Preloading Rails environment
Couldn't find a supported test framework that begins with 'testunit'

Supported test frameworks:
( ) Cucumber
(*) RSpec

Legend: ( ) - not detected in project   (*) - detected
Loading Spork.prefork block...
Rack::File headers parameter replaces cache_control after Rack 1.5.
Spork is ready and listening on 8989!
16:32:28 - ERROR - Could not start Spork server for RSpec, Test::Unit after 30 seconds. I will continue waiting for a further 60 seconds.

16:33:28 - ERROR - Could not start Spork server for RSpec, Test::Unit. Make sure you can use it manually first. 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-01T21:18:30.250

或者您可以将`test_unit: false`选项添加到guard-spork，即在您的Guardfile 中：

```
guard 'spork', :rspec_env => { 'RAILS_ENV' => 'test' }, :test_unit => false do 
```

我的“测试”目录中确实有一些性能测试，因此删除 test/ 并不总是一种选择。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-10T16:11:40.327

弄清楚了。. .

只需擦除 rails 应用程序根目录中的测试文件夹

**rm -r 测试/**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-31T06:00:33.103

仅由于应用程序根目录中的 /test 目录而发生此错误。删除 /test 目录，它应该可以解决错误。

# java - 调用控制器方法时的 InvocationTargetException - JavaFX

> ID：14791961
> 
> 赞同：1
> 
> 时间：2013-02-09T21:46:33.410
> 
> 标签：java, controller, javafx-2, invocationtargetexception

当我尝试从控制器（JavaFX）调用方法时，我得到一个 InvocationTargetException，代码如下：

```
 public void start(Stage stage) throws Exception {

    URL location = getClass().getResource("startScreen.fxml");
    FXMLLoader loader = new FXMLLoader();

    loader.setLocation(location);
    loader.setBuilderFactory(new JavaFXBuilderFactory());

    //Getting hte controller
    StartScreenController s = (StartScreenController)loader.getController();

    //Where error occurs
    s.setParent(this);

    Parent root = (Parent) loader.load(location.openStream());

    Scene scene = new Scene(root);
    stage.setScene(scene);
    stage.show();
} 
```

当我删除“setParent”行时它工作正常。

这似乎对其他人有用（就我自己尝试解决这个问题时所看到的而言）。

任何帮助将不胜感激，谢谢。

我得到的错误（s.setParent 是第 38 行）

```
 Exception in Application start method
java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.javafx.main.Main.launchApp(Main.java:642)
    at com.javafx.main.Main.main(Main.java:805)
Caused by: java.lang.RuntimeException: Exception in Application start method
    at com.sun.javafx.application.LauncherImpl.launchApplication1(LauncherImpl.java:403)
    at com.sun.javafx.application.LauncherImpl.access$000(LauncherImpl.java:47)
    at com.sun.javafx.application.LauncherImpl$1.run(LauncherImpl.java:115)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.NullPointerException
    at johnsoft.dndcommunication.DndCommunication.start(DndCommunication.java:38)
    at com.sun.javafx.application.LauncherImpl$5.run(LauncherImpl.java:319)
    at com.sun.javafx.application.PlatformImpl$5.run(PlatformImpl.java:206)
    at com.sun.javafx.application.PlatformImpl$4.run(PlatformImpl.java:173)
    at com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
    at com.sun.glass.ui.win.WinApplication.access$100(WinApplication.java:29)
    at com.sun.glass.ui.win.WinApplication$3$1.run(WinApplication.java:73)
    ... 1 more
Java Result: 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T14:46:31.917

我猜，
您正试图在加载 FXML 文件之前访问控制器类。

```
StartScreenController s = (StartScreenController)loader.getController();

// so StartScreenController s is null here thus NPE
s.setParent(this);

// here loading is happening after getting the controller class, which is wrong. 
// Get the controller after loading is completed.

Parent root = (Parent) loader.load(location.openStream()); 
```

# php - Mediawiki 刷新我的会话变量

> ID：14791967
> 
> 赞同：0
> 
> 时间：2013-02-09T21:47:29.867
> 
> 标签：php, mediawiki

我有自己的登录系统。我正在使用现有的 AuthPlugin 框架构建一个扩展，以便在 Mediawiki 上登录我的系统时自动登录用户。

```
// Instanciating a user object
$User = new User() ;

// Mediawiki does not start a session for unsigned users
wfsetupSession();

die($_SESSION['test']); 
```

我之前在自己的登录系统上设置了 $_SESSION['test'] ，但我所有的会话变量似乎都被 Mediawiki 刷新了。有什么方法可以检索这些变量吗？我仍然使用可用的 PHPSESSID cookie，但 MW 在另一个 cookie 中创建了自己的会话 ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T21:55:13.120

在调用函数之前将会话保存在另一个变量中

```
// Instanciating a user object
$User = new User() ;

$session['test'] = $_SESSION['test'];
// Mediawiki does not start a session for unsigned users
wfsetupSession();

$_SESSION['test'] = $session['test']; 
```

# python - 如何在没有 k 的情况下进行随机样本，直到产生某个整数？（Python）

> ID：14791968
> 
> 赞同：1
> 
> 时间：2013-02-09T21:47:35.367
> 
> 标签：python, loops, while-loop, random-sample

我在 Python 中工作，基本上我有一个整数列表：

```
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 6, 6, 6, 6, 6, 7, 7, 7, 7, 8, 8, 8, 8, 8, 9, 9, 9, 9, 10] 
```

使用变量`total`，我试图弄清楚如何从这个列表中产生随机数（不替换），直到产生 10，然后停止。我想这会`random.shuffle`在一个while循环中使用，但我不确定。任何提示或建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:49:54.633

你 pop() 一个随机元素`total`，然后检查它是否是`10`. 例如：

```
while total.pop(random.randrange(len(total))) != 10:
     ... # do your stuff until the 10 is chosen 
```

total.pop(i) 从`total`index 的元素中删除`i`，因此**无需替换即可使用**。另外，[请查看此答案](https://stackoverflow.com/questions/10048069/what-is-the-most-pythonic-way-to-pop-a-random-element-from-a-list)。

**编辑：**
也许你试图通过多次使用相同的元素来实现加权随机选择；那将是一个相当丑陋的解决方案。在这种情况下，看看这个问题（**[Weighted random selection with and without replacement](https://stackoverflow.com/questions/352670/weighted-random-selection-with-and-without-replacement?rq=1)**）是否有帮助。干杯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T22:03:58.253

使用`random.shuffle`甚至不需要循环。

```
random.shuffle(l)
random_selection = l[ :l.index(10) ] 
```

# c++ - 从单独的线程发送 UDP

> ID：14791974
> 
> 赞同：0
> 
> 时间：2013-02-09T21:48:31.263
> 
> 标签：c++, c, sockets, udp

我有一个通过 UDP 记录状态切换的程序。我需要记录功能尽可能快，但知道网络被认为很慢。从单独的线程发送 UDP 数据有什么好处，或者发送 UDP 只是一个快速调用，因为不需要设置或等待（假设我预先打开了套接字）？
如果它立即返回，我可以接受，但如果它在内部等待一些 I/O 资源，这可能是个问题。可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:54:24.210

如果您没有发送大量 [我的意思是每分钟兆字节] 数据 [或非常频繁]（每分钟数百个数据包），我希望`send`(or `write`) 相当快。

需要很长时间的唯一原因是，如果您提供的数据多于网络可以接收的数据，因此内核必须等待空闲的缓冲槽可用。

与与性能相关的所有事情一样，测量总是比在互联网上询问要好......我希望，在现代 PC 上，`sendmsg`对于一个小数据包，调用大约是几百纳秒，大约如果数据包超过几十个字节，则每 8 个字节额外增加一纳秒，最大为几千字节。当您达到数百 KB 时，时间会增加 3-10 倍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:52:15.047

它可能。为了防止它等待，只需将套接字设置为非阻塞。
您可能有兴趣[了解 Python 如何设置适当的标志](http://hg.python.org/cpython/file/99795d711a40/Modules/socketmodule.c#l591)。

# javascript - Firefox 画布中的字符串异常错误

> ID：14791975
> 
> 赞同：0
> 
> 时间：2013-02-09T21:49:12.323
> 
> 标签：javascript, firefox, canvas

我试图在画布上制作飘落的雪花。该代码在 Chrome 中运行正常，但在 FF18 中没有显示任何内容。

[http://dharman.eu/flakes/](http://dharman.eu/flakes/)

当我在控制台中检查它时，Firebug 抛出此错误：
*指定了无效或非法字符串*
`var s = flakes[flake].chara;`
`ctx.fillText(s,flakes[flake].x, flakes[flake].y);`

任何想法我的代码有什么问题？

此外，画布元素的宽度似乎太大，即使它被指定为 100%。为什么？

```
var screenH = window.innerHeight;
var screenW = window.innerWidth;
canvas.width = screenW;
canvas.height = screenH; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:08:04.327

移动`init();`到代码的底部，然后它将起作用：

```
//...

$('#canvas').dblclick(function () {
    RunPrefixMethod(canvas, "RequestFullScreen");
});

//width/height 100%
var screenH = window.innerHeight;
var screenW = window.innerWidth;
canvas.width = screenW;
canvas.height = screenH;

init();  //<--here 
```

因为`screenH`没有定义。（奇怪的...）

演示：http: [//jsfiddle.net/DerekL/jNf47/](http://jsfiddle.net/DerekL/jNf47/)

* * *

# 奖励：调试

首先，我知道其中一个变量`ctx.fillText`没有定义，所以我必须找出它是哪一个：

```
console.log(s,flakes[flake].x, flakes[flake].y);
//[some number], [some number], undefined) 
```

所以问题出在`flakes[flake].y`. 似乎`flakes[flake].y`是指`screenH`，所以这意味着`screenH`是问题所在。通常变量必须在调用之前定义`init()`，所以我只是将它移到底部并且它可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:13:49.890

问题是您的代码的顺序。

您调用 init() 在设置这些变量之前开始运行动画

```
var screenH = window.innerHeight;
var screenW = window.innerWidth; 
```

然后在 drawFlakes 循环中，您尝试将薄片 y 值分配给 screenH （未定义）

```
else
{   
  flakes[flake].y=screenH;
  flakes[flake].die-=33;
} 
```

然后最后在渲染薄片时

```
ctx.fillText(s,flakes[flake].x, flakes[flake].y); 
```

y 未定义并导致错误。

# c - CUDA 2D 数组分配

> ID：14791976
> 
> 赞同：2
> 
> 时间：2013-02-09T21:49:16.343
> 
> 标签：c, cuda

我在处理 CUDA 设备上的 2D 数组时遇到了一个奇怪的问题。

```
 #define VR 100 // rows
    #define ST 13 // columns
    __global__ void test(float *arr, curandState *globalState, size_t pitch, unsigned long seed) {
    int id = (blockIdx.x * blockDim.x)  + threadIdx.x;
    curand_init ( seed, id, 0, &globalState[id] );
    cuPrintf("Thread id: %d \n", id);

    float* row = (float*)(((char*)arr) + id * pitch);
    for (int j = 0; j < ST; ++j) {
        row[j] = generate(globalState, id);
    }

}

int main() {
    float *d_arr;
    float *h_arr = new float[VR*ST];
    size_t pitch;
    cudaMallocPitch(&d_arr, &pitch, ST* sizeof(float), VR);

    dim3 dimBlock(VR); 
    dim3 dimGrid(1,1);

    curandState* devStates;
    cudaMalloc ( &devStates, VR*ST*sizeof( curandState ) );

    test <<< dimGrid, dimBlock >>> (d_arr, devStates, pitch, unsigned(time(NULL)));
    cudaMemcpy(h_arr, d_arr,VR*ST*sizeof(float),cudaMemcpyDeviceToHost);

    for (int i=0; i<VR; i++) {
        for (int j=0; j<ST; j++) {
            cout << "N["<<i<<"]["<<j<<"]=" << h_arr[(i*ST)+j]<<endl;
        }
    } 
```

我没有得到均匀分布的数字，而是它们以 13 的顺序出现，中间有一堆零。见： http: [//pastie.org/6106381](http://pastie.org/6106381)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T00:30:45.590

问题是原始数据数组是使用分配的，`cudaMallocPitch`而复制是使用普通的`cudaMemcpy`。这将产生意想不到的结果，因为该`cudaMallocPitch`操作会创建“填充”行以满足对齐要求，而 cudaMemcpy 假定所有内容都是连续存储的。以下是我认为具有更正功能的代码：

```
 #include <stdio.h>
    #include <iostream>
    #include <curand_kernel.h>

    #define VR 100 // rows
    #define ST 13 // columns

__device__ float generate(curandState* globalState, int id)
{
    //int id = (blockIdx.x * blockDim.x)  + threadIdx.x;
    curandState localState = globalState[id];
    float rand;
    do {
        rand = curand_uniform( &localState );
    } while(rand == 0); //
    globalState[id] = localState;
    return rand;
}

    __global__ void test(float *arr, curandState *globalState, size_t pitch, unsigned long seed) {
    int id = (blockIdx.x * blockDim.x)  + threadIdx.x;
    curand_init ( seed, id, 0, &globalState[id] );
    //cuPrintf("Thread id: %d \n", id);

    float* row = (float*)(((char*)arr) + id * pitch);
    for (int j = 0; j < ST; ++j) {
        row[j] = generate(globalState, id);
    }

}

    using namespace std;
int main() {
    float *d_arr;
    float *h_arr = new float[VR*ST];
    size_t pitch;
    cudaMallocPitch(&d_arr, &pitch, ST* sizeof(float), VR);

    dim3 dimBlock(VR);
    dim3 dimGrid(1,1);

    curandState* devStates;
    cudaMalloc ( &devStates, VR*ST*sizeof( curandState ) );

    test <<< dimGrid, dimBlock >>> (d_arr, devStates, pitch, unsigned(time(NULL)));
    cudaMemcpy2D(h_arr, ST*sizeof(float),  d_arr, pitch, ST*sizeof(float), VR ,cudaMemcpyDeviceToHost);

    for (int i=0; i<VR; i++) {
        for (int j=0; j<ST; j++) {
            cout << "N["<<i<<"]["<<j<<"]=" << h_arr[(i*ST)+j]<<endl;
        }
    }
} 
```

使用以下代码编译上述代码：

```
nvcc -arch=sm_20 -lcurand  -o t70 t70.cu 
```

然后运行我得到看似“正常”的输出：

```
N[0][0]=0.876772
N[0][1]=0.550017
N[0][2]=0.49023
N[0][3]=0.530145
N[0][4]=0.501616
N[0][5]=0.326232
N[0][6]=0.438308
N[0][7]=0.857651
N[0][8]=0.462743
N[0][9]=0.38252
N[0][10]=0.258212
N[0][11]=0.194021
N[0][12]=0.895522
N[1][0]=0.559201
N[1][1]=0.257747
N[1][2]=0.430971
N[1][3]=0.707209
N[1][4]=0.599081
N[1][5]=0.0457626
N[1][6]=0.702412
N[1][7]=0.88791
N[1][8]=0.508877
N[1][9]=0.702734
N[1][10]=0.379898
N[1][11]=0.138841
N[1][12]=0.540869 
```

（结果被截断）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:22:38.753

我认为这是错误的，您应该分配 VR 线程数或块数，因为您已经在内核中循环了 ST。

也许这会解决它。

# c++ - 将 std::vector 附加到自身，未定义的行为？

> ID：14791984
> 
> 赞同：15
> 
> 时间：2013-02-09T21:49:52.350
> 
> 标签：c++, vector, language-lawyer

[这个问题](https://stackoverflow.com/q/14781264/237483)让我不确定将向量附加到自身。所以问题是：下面的代码行符合我的期望，但它符合标准吗？

```
vec.reserve(vec.size() * 2):
vec.insert(vec.end(), vec.begin(), vec.end()); 
```

跟随（没有`reserve()`）仍然有效，它甚至符合标准吗？

```
vec.insert(vec.end(), vec.begin(), vec.end()); 
```

或实施取决于？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-09T22:11:19.603

根据 C++03 ISO 规范（第 23.1.1 节，表 67）（正如@AndyProwl 提到的，在第 23.2.3 节，C++11 ISO 规范的表 11 中），作为序列要求的一部分，序列容器中的操作`a.insert(p, i, j)`具有以下前提条件：

> `i`,`j`不是迭代器`a`。

换句话说，允许序列容器安全地假设，如果您执行范围插入操作，则该范围将不会从该原始容器上的迭代器中定义。

因此，如果您尝试将容器的元素插入到自身中，您就是在调用标准库函数并破坏了先决条件。这会导致未定义的行为，这意味着如果库实现者是好人，它*可能会在某些平台上工作，但它可能会在没有任何理由的情况下发生可怕的灾难性失败。*

希望这可以帮助！

# javascript - JavaScript 应用

> ID：14791987
> 
> 赞同：0
> 
> 时间：2013-02-09T21:49:58.400
> 
> 标签：javascript

[JavaScript Ninja](https://rads.stackoverflow.com/amzn/click/com/193398869X)的秘密中有一个示例，它提供了以下代码来绕过 JavaScript 的`Math.min()`函数，该函数需要一个可变长度的列表。

```
Example: Math.min(1,2,3,4,5); 
```

但是，如果你有一个问题`list: [1,2,3,4,5]`，因为你宁愿不必遍历列表，跟踪当前的最小值。

书中说使用以下代码来解决这个问题。

```
function smallest(arr) {
   return Math.min.apply(Math, arr);   
}

alert(smallest([1,2,3,4,5,6,-33])); 
```

`Math.min.apply(Math, arr)`引擎盖下会发生什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:53:43.480

该[`.apply`方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)“调用具有给定`this`值和作为数组（或类似对象的数组）提供的参数的函数。”

所以基本上它就像你在直接调用函数时将数组的每个项目作为单独的参数传递一样。

第一个参数`.apply()`设置`this`函数要使用的值，因此您的示例通过`Math`，因此它的工作方式与您直接调用它时一样`Math.min(...)`。

*请注意，您可以对任何*函数执行相同的操作：

```
function someFunc(a,b,c,d) { ... }

someFunc(1,2,3,4);
// or
someFunc.apply(null, [1,2,3,4]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T21:53:54.560

允许您在[`apply`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)给定实例上调用方法并将参数作为数组提供。所以当你写

```
Math.min.apply(Math, arr); 
```

您正在调用类`min`上的方法并作为参数`Math` 传递。`arr`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T21:53:55.437

根据 MDN 文档[`Function.prototype.apply`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)：

> 使用给定的 this 值和作为数组（或类似对象的数组）提供的参数调用函数。

# symfony - 如何将表单视图放在继承的树枝视图中？

> ID：14791990
> 
> 赞同：1
> 
> 时间：2013-02-09T21:50:09.717
> 
> 标签：symfony, twig

在与 ViciousAmateur:Default:Index Controller/acction 相关的视图中，我想添加一个表单来过滤分页结果（KnpPaginatorBundle）。在我的控制器中，我创建表单并返回带有表单变量的视图。（啊……如果我将表单直接放在视图中，它会按预期工作）。

```
/**
 * @Route("/{page}", defaults={"page" = 1}, name="homepage")
 * @Route("/")
 * @Template()
 */
public function indexAction(Request $request, $page)
{
    $filters = new Filters();
    $form = $this->createForm(new FiltersType(), $filters);
    if ($request->isMethod('POST')) {
        $form->bind($request);

        if ($form->isValid()) {
            // Do something with form submited data
        }
    }

    // Do something when index action loads, pagination etc...

    return $this->render('ViciousAmateurBundle:Default:index.html.twig', array(
        'form' => $form->createView(),
        'pagination' => $pagination
        )
    );
} 
```

但是，如果我尝试将表单放入树枝包含（以使视图继承/分离）将表单变量传递给该视图......那么它就不起作用了。我收到此响应**“错误 101 (net::ERR_CONNECTION_RESET)：Se ha restablecido la conexión。”** （有些词是西班牙语）这是我的观点：

```
// file: ViciousAmateurBundle:Default:index.html.twig
{% extends '::base.html.twig' %}

{% block body %}
    {{ include('ViciousAmateurBundle:Default:filters.html.twig', {'form': form}) }}

    {% block filters %}
    {% endblock %}

    // Stuff in the body
{% endblock %} 
```

如您所见，表单视图是从索引继承（扩展子句）并将代码添加到其“过滤器”树枝块中......

```
// file: ViciousAmateurBundle:Default:filters.html.twig
{% extends 'ViciousAmateurBundle:default:index.html.twig' %}

{% block filters %}
<section class="filters">
    <form action="{{ path('homepage') }}" method="post" {{ form_enctype(form) }} class="filters">
        {{ form_errors(form) }}

            {{ form_errors(form.country) }}
            {{ form_widget(form.country, { 'attr': { 'placeholder': 'País', 'class': 'input-block-level' } }) }}

            // Some more form fields...

        {{ form_rest(form) }}

        <input type="submit" class="filters_submit btn btn-large btn-block" />
    </form>
</section>
{% endblock %} 
```

那么......有可能做那件事吗？将表单放入继承的视图（索引中的过滤器视图）中，将控制器给出的表单变量传递给它？？？它应该工作吗？我错过了什么或做错了什么？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T11:22:08.170

那是因为 Symfony2.1 中的语法是：

```
{% include "ViciousAmateurBundle:Default:filters.html.twig" with { form: form} %} 
```

[树枝包含功能](http://twig.sensiolabs.org/doc/tags/include.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T00:17:30.697

我所做的是将 extends 子句和 twig 块删除到 filters.html.twig 视图中。并将其包含在过滤器树枝块中的 index.html.twig 页面中。

index.html.twig

```
...
{% block filters %}
    {{ include('ViciousAmateurBundle:Default:filters.html.twig', {'form': form}) }}
{% endblock %}
... 
```

过滤器.html.twig

```
<section id="filters">
<form action="{{ path('homepage') }}" method="post" {{ form_enctype(form) }} class="filters">
    {{ form_errors(form) }}

        {{ form_errors(form.country) }}
        {{ form_widget(form.country, { 'attr': { 'placeholder': 'País', 'class': 'input-block-level' } }) }}

        {{ form_errors(form.city) }}
        {{ form_widget(form.city, { 'attr': { 'placeholder': 'Ciudad', 'class': 'input-block-level' } }) }}

        {{ form_errors(form.gender) }}
        {{ form_widget(form.gender, { 'attr': { 'placeholder': 'Género', 'class': 'input-block-level' } }) }}

        {{ form_errors(form.sexual_orientation) }}
        {{ form_widget(form.sexual_orientation, { 'attr': { 'placeholder': 'Orientación sexual', 'class': 'input-block-level' } }) }}

    {{ form_rest(form) }}

    <input type="submit" id="toggleFilters1" class="filters_submit btn btn-large btn-block" value="Filtrar" />
</form> 
```

# css - 根据前一个相同类型的元素选择元素

> ID：14791991
> 
> 赞同：0
> 
> 时间：2013-02-09T21:50:17.927
> 
> 标签：css, next

我正在尝试根据相同类型的先前元素的类来选择元素。

例如，给定以下 HTML，选择第三个 span 元素：

```
<div>
  <span class="red"></span>
  <span class="red"></span>
  <p>
    <span id="select me"></span>
  </p>
  <span id="don't select me"></span>
</div> 
```

我希望该 span 元素具有与前一个 span 元素相同的属性，因为它具有类“red”。

另一种说法是：选择一个具有“红色”类的元素以及相同类型的下一个元素，而不管类如何。

我很难解决这个问题。总比没有好是一种选择相同类型的下一个兄弟而不是任何后续元素的方法。例如，如果**span.red ~ span**不表示*“具有任何先前 span 同级且具有红色类的 span 元素”，则可以。*

谢谢你的帮助。

以下是更多示例：

```
<div>
  <span class="red"></span>
  <span id="select me"></span>
  <p>
    <span class="red"></span>
  </p>
  <span id="select me"></span>
</div> 
```

在上面的示例中，选择第二个 span 元素是因为第一个 span 有一个类“red”。

选择最后一个 span 元素是因为第三个 span 有一个类“red”。

```
<div>
  <span class="red"></span>
  <span class="red"></span>
  <p>
    <b></b>
  </p>
  <span id="select me"></span>
</div> 
```

主要原因是我在可编辑的 div 中有元素。它们用 CSS 计数器编号。有些元素可能像图形一样组合在一起，即 2a 和 2b，而另一些则不是，所以我最终可能会得到元素 1、2a、2b、2c、3 等。我使用的类名只是告诉我它是“子”元素并增加子计数器但不增加主元素计数器。在一堆子元素告诉我它是最后一个子元素之后没有下一个元素的类，我应该重置子计数器。我以这种方式设置它的原因是因为我希望能够在元素周围移动并自动更新编号。此外，只需切换类名即可轻松更改某物是否为子元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:59:08.297

我想要另外一两个案例来测试它，但这似乎适用于您的示例：

```
span.red ~* span {
    background: red;
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/qbwY6/1/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:08:54.800

如果它只嵌套在级别上，你可以试试这个：

```
.red + * > span {
  color: red;
} 
```

这个的用例是什么？为什么不将红色添加到您想要以相同方式设置样式的所有元素？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T21:57:13.323

没有办法在选择器中说“相同类型的兄弟姐妹”。但是您可以在您选择的选择器之后使用兄弟选择器，并将它们组合成一个满足您需求的选择器，例如：

```
span.red + span, div.red + div
{

} 
```

# c++ - 我可以制作一个宏来执行调试或发布代码吗？

> ID：14791995
> 
> 赞同：1
> 
> 时间：2013-02-09T21:51:06.530
> 
> 标签：c++, c-preprocessor

例如，如果我有这个代码：

```
#ifdef _DEBUG
    mPluginsCfg = "plugins_d.cfg";
#else
    mPluginsCfg = "plugins.cfg";
#endif 
```

我可以定义一个看起来像的宏吗

```
#define DEBUG_RELEASE(debug_code, release_code) 
```

然后像这样使用它；

```
DEBUG_RELEASE(mPluginsCfg = "plugins_d.cfg";,mPluginsCfg = "plugins.cfg";) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T21:56:24.353

我确信它可以工作，而且我*几乎*可以肯定它被*定义*为可以工作。

```
#ifdef _DEBUG
#define DEBUG_RELEASE(d,r) d
#else
#define DEBUG_RELEASE(d,r) r
#endif 
```

我不确定我是否在预处理器宏的美妙世界中看到过更丑陋的东西。

# java - 输出文件不断在 Java 中被覆盖

> ID：14791996
> 
> 赞同：0
> 
> 时间：2013-02-09T21:51:14.720
> 
> 标签：java, file, text, io, append

我尝试过使用 BufferWriter 格式以及 FileWriter 和 PrintWriter，每个都带有一个 boolean true 语句，但它们的行为就像我只是使用一个简单的新文件一样。每次程序运行结束时，我都会调用写入要附加的已保存数据的函数。最终发生的是它覆盖了最后保存的数据。我还有其他代码块也可以处理该文本文件，并且重新格式化它们也无济于事。

```
//saves user information to "Users.txt" which will be called in the finally block after choice switch
public void writeUsers()
{
    try{

        File userFile = new File("Users.txt");
        PrintWriter output = new PrintWriter(userFile);
        for(User i: userList) {    
        output.append("Name:");    
        output.println(i.getrealName());
        output.append("UID:");
        output.println(i.getidName());
        output.append("Password:");
        output.println(i.getpassword());
        output.println(" ");
        }
        output.close();
        System.out.print("Information has been saved to Users.txt\n");

    }
    catch(FileNotFoundException fnf) {
        System.err.println("FileNotFoundException: File Users.txt does not exist " + fnf);
    }
    catch(IOException eyeoh) {
        System.err.println("IOException: Error writing to Users.txt " + eyeoh);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T21:54:37.760

默认情况下，构造函数`PrintWriter(File)`会截断输出文件。`PrintWriter`' 方法被调用的事实`append()`并不意味着它改变了正在打开的文件的模式。的行为 [描述](http://docs.oracle.com/javase/7/docs/api/java/io/PrintWriter.html#append%28java.lang.CharSequence%29)`append`为：

> 形式为 out.append(csq) 的此方法的调用与调用的行为方式完全相同

```
 out.write(csq.toString()) 
```

在这里，您可以使用构造函数`PrintWriter`来`FileOutputStream`追加

```
PrintWriter output = 
   new PrintWriter(new FileOutputStream(userFile, true /* append = true */)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-25T20:48:17.893

默认的 PrintWriter 会截断所有现有数据。正如其他答案所建议的那样，要追加您可以向构造函数添加一个“true”参数，表示“append = true”

但是，使用 java.nio.file 可以更优雅地完成此操作。[文件](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html)连同 java.nio.file。[StandardOpenOption](http://docs.oracle.com/javase/7/docs/api/java/nio/file/StandardOpenOption.html)，您可以在其中指定`StandardOpenOption.APPEND`而不是`StandardOpenOption.TRUNCATE_EXISTING` 您还可以指定诸如`StandardOpenOption.CREATE`如果文件不存在则创建文件之类的内容。

此外，请记住将您的`output.close()`语句放在一个`finally`块中，或使用 try-with-resources。否则，如果程序的流程被中断（即抛出异常），`output`将保持未关闭状态。我个人使用 try-with-resources，因为它不那么麻烦：只需声明所有资源，它们会自动为您关闭，无论程序流程是否中断。

此外，作为一般提示，打印或传递块`Exception`中的实际对象`catch`，而不仅仅是“自定义字符串”，以免丢失`Exception`抛出的原始内容。然后，您可以将它与您还想打印的任何字符串连接起来。

```
try(BufferedWriter bufWriter =
        Files.newBufferedWriter(Paths.get("Users.txt"),
            Charset.forName("UTF8"),
            StandardOpenOption.WRITE, 
            StandardOpenOption.APPEND, //Makes this BufferedWriter append to the file, not truncate
            StandardOpenOption.CREATE);
    PrintWriter output = new PrintWriter(bufWriter, true);)
{ 

    output.println("Text to be appended.");

}catch(FileNotFoundException e){
    System.err.println(e + "Custom string");
}catch(IOException e){
    System.err.println(e + "Something eyeoh occurred...");
} 
```

这使用了一个 try-with-resources 语句来声明和创建一个`BufferedWriter`using `java.nio.file.Files`，它接受`StandardOpenOption`参数，以及一个来自 resultant 的自动刷新`PrintWriter`（在构造函数中用“true”表示）`BufferedWriter`。`PrintWriter`的`println()`方法，然后可以调用写入文件。

此代码中使用的`StandardOpenOption`参数：打开文件进行写入，仅追加到文件，如果文件不存在则创建文件。

`Paths.get("path here")``new File("path here").toPath()`如果您只使用`File`对象（即，如果您正在使用`JFileChooser.getSelectedFile()`） ，则可以替换为并且`Charset.forName("charset name")`可以修改以适应所需的`Charset`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T21:54:36.610

您必须创建`PrintWriter`附加模式。否则，当它第一次打开文件时，它会清除它。您可以使用以下命令以附加模式打开它：

```
new PrintWriter(new FileWriter(userFile,true)) // the `true` argument opens it in append mode 
```

# java - java - 如何知道java文本文件中行首的偏移量？

> ID：14791997
> 
> 赞同：0
> 
> 时间：2013-02-09T21:51:16.000
> 
> 标签：java, text-files, offset

我想知道文本文件中每一行的偏移量。

目前我已经尝试过，

```
path=FileSystems.getDefault().getPath(".",filename);
br=Files.newBufferedReader(path_doc_title_index_path, Charset.defaultCharset());
int offset=0; //offset of first line.       
String strline=br.readline();
offset+=strline.length()+1; //offset of second line 
```

通过这种方式，我可以遍历整个文件以了解整个文本文件中行首的偏移量。但是，如果我使用`RandomAccessFile`通过上述方法计算的偏移量来查找文件并访问一行，那么我发现自己处于某行的中间。也就是说，偏移量似乎不正确。

怎么了？这种方法计算偏移量是否不正确？请问有更好更快的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:15:37.237

您的代码仅适用于 ASCII 编码文本。由于某些字符需要超过一个字节，因此您必须更改以下行

```
offset += strline.length() + 1; 
```

到

```
offset += strline.getBytes(Charset.defaultCharset()).length + 1; 
```

正如我在您问题下方的评论中所述，您必须指定文件的正确编码。例如`Charset.forName("UTF-8")`这里以及你初始化你的`BufferedReader`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T22:15:00.357

显然，这给了我预期的结果。在下面的程序中，我通过一组通过 BufferedReader 收集的偏移量打印出文件的每一行。这是你的情况吗？

```
public static void main(String[] args) {
    File readFile = new File("/your/file/here");
    BufferedReader reader = null;
    try
    {
        reader = new BufferedReader( new FileReader(readFile) );
    }
    catch (IOException ioe)
    {
        System.err.println("Error: " + ioe.getMessage());     
    }
    List<Integer> offsets=new ArrayList<Integer>(); //offset of first line.       
    String strline;
    try {
        strline = reader.readLine();
        while(strline!=null){
            offsets.add(strline.length()+System.getProperty("line.separator").length()); //offset of second line
            strline = reader.readLine();
        }
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    try {
        RandomAccessFile raf = new RandomAccessFile(readFile, "rw");
        for(Integer offset : offsets){
            try {
                raf.seek(offset);
                System.out.println(raf.readLine());
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }   
} 
```