# StackOverflow 问答 15277000-15277999

# javascript - 想要使用 oauth.js 插件从 Twitter Oauth api 获取 access_token

> ID：15277005
> 
> 赞同：0
> 
> 时间：2013-03-07T16:51:35.323
> 
> 标签：javascript, twitter, oauth, token

我正在尝试从他们的 oauth api 获取 Twitter 访问令牌。我使用的插件是这个[https://code.google.com/p/oauth/source/browse/#svn%2Fcode%2Fjavascript](https://code.google.com/p/oauth/source/browse/#svn%2Fcode%2Fjavascript)。到目前为止，我只收到“401 无法验证签名和令牌”。

奇怪的是，即使我设置了 type:'POST'，我的 ajax 调用也变成了 'GET' 请求。似乎 jquery 正在将类型从 POST 更改为 GET。我不知道为什么会这样。我在我的 Mac 上运行它。感谢您的帮助/提示/建议/建议。谢谢！

```
$（函数（）{

    函数 myCallback(resp) {
    控制台.log(resp);
    }
    var TwitterAPI;

    TwitterAPI = (函数() {
    var consumer_key = null;
    var consumer_secret = null;

    函数 TwitterAPI(cons_key, cons_secret) {
        this.consumer_key = cons_key;
        this.consumer_secret = cons_secret;
    }

    TwitterAPI.prototype._url = 函数（数据）{
            if (typeof data == 'array') {
        return array_map([ // TODO
            这个，'_url']，数据）；
            } else if ((/boolean|number|string/).test(typeof data)) {
        return encodeURIComponent(data).replace(/!/g, '%21').replace(/'/g, '%27').replace(/\(/g, '%28').replace(/\ )/g, '%29').replace(/\*/g, '%2A');
            } 别的 {
        返回 '​​';
            }
    }

    TwitterAPI.prototype.myCallback = function(resp) {
        控制台.log(resp);
    }

    TwitterAPI.prototype.getRequestToken = function() {
        var 访问器 = {
        consumerSecret: this.consumer_secret, //this.consumer.consumerSecret,
        令牌秘密：''
        };

        变量消息 = {
        方法：“POST”，
        行动：“https://api.twitter.com/oauth/request_token”，
        参数： {
            oauth_signature_method：“HMAC-SHA1”，
            oauth_consumer_key: this.consumer_key, //this.consumer.consumerKey
            oauth_callback: this._url("http://127.0.0.1/foobar/libs/oauth/wtf.html"),
        }
        };
        OAuth.setTimestampAndNonce（消息）；
        OAuth.SignatureMethod.sign（消息，访问者）；
        var target = OAuth.addToURL(message.action, message.parameters);
        message.parameters.oauth_signature = this._url(message.parameters.oauth_signature);

        console.log(message.parameters);

        $.ajax("https://api.twitter.com/oauth/request_token",
           { 网址：“https://api.twitter.com/oauth/request_token”，
               类型：'POST'，
               数据类型：'jsonp'，
               jsonp: '回调',
               jsonpCallback：“我的回调”，
               数据：消息.参数，
               成功：函数（数据，textResp，xhr）{
               控制台.log（数据）；
               },
               错误：函数（xhr，文本，错误）{
               控制台.log（文本）；
               }
           });

    };
    返回推特API；
     })();

     api = 新的 TwitterAPI（密钥，秘密）；
     $('button#request').on('click', function(e) {
     e.stopPropagation();
     api.getRequestToken();
     });

```

# python - 修改 Matplotlib 多色直方图脚本使其具有累积性

> ID：15277006
> 
> 赞同：1
> 
> 时间：2013-03-07T16:51:36.577
> 
> 标签：python, matplotlib, plot, histogram

我试图制作不同条形颜色不同的直方图。我很高兴找到[这个页面](http://matplotlib.1069221.n5.nabble.com/1D-and-2D-histograms-using-numpy-and-matplotlib-tt12502.html#none)，它提供了为我完成这一切的脚本。只有一个问题 - 它似乎不支持累积直方图，就像您可以通过在常规 Matplotlib 直方图中添加“cumulative=True”来做到的那样。有人能告诉我如何修改[这个文件](http://matplotlib.1069221.n5.nabble.com/file/n12502/histogram.py)让我绘制累积的、多色的直方图吗？非常感谢，亚历克斯

编辑：我认为最好的解决方案是在直方图类中添加一个函数，如下所示：

```
def make_cumulative(self):
  self.occurrences = np.cumsum(self.occurrences) 
```

但我不知道事件被存储为什么，或者即使以这种方式将其视为参数是否有意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T03:00:12.400

事后看来，解决方案非常简单明了。直方图对象只是每个 bin 出现的数组，所以我只取了直方图本身的 cumsum。

所以基本上

```
import histogram, numpy 
y = range(0, 100) #Except I used real data
Hist = histogram(y, bins=100, range=[0,100])
colors = ['red', 'blue', 'green', ]
ranges = [[0,30], [30,31], [31,100]]
fig = pyplot.figure(figsize=(8,6))
ax, plt, _ = fig.plothist(Hist, alpha=0) # plot for spacing
for c, r in zip(colors, ranges):
    plt = ax.overlay(Hist, range=r, facecolor=c)
print y

CumulativeHist = numpy.cumsum(h6)
colors = ['red', 'blue', 'green', ]
ranges = [[0,30], [30,31], [31,100]]
fig = pyplot.figure(figsize=(8,6))
ax, plt, _ = fig.plothist(CumulativeHist, alpha=0) # plot for spacing
for c, r in zip(colors, ranges):
    plt = ax.overlay(CumulativeHist, range=r, facecolor=c)

pyplot.show() 
```

会做两个情节，其中第二个是第二个的累积版本。谢谢您的帮助。

亚历克斯

# javascript - 带有同位素的 Javascript/Jquery 图像预加载器

> ID：15277008
> 
> 赞同：2
> 
> 时间：2013-03-07T16:51:45.047
> 
> 标签：javascript, jquery-isotope, preloader

我正在使用同位素 jQuery 插件作为一种画廊过滤器。

我有 80 张图片，大小为 300 像素 x 200 像素或 200 像素 x 300 像素，我遇到的问题是单击图库选项卡时保存图像的同位素容器在加载时会以某种方式与它们重叠。它有时无法在页面停止加载之前加载所有图像，您可以看到我在这里建立的我的网站[蛋糕颓废](http://statics.site44.com)。我正在阅读有关预加载图像的信息，我[在这里](https://stackoverflow.com/questions/13876156/jquery-isotope-with-infinite-scroll-and-image-preloader)阅读了此堆栈溢出问题，他推荐了我尝试过但无法正常工作的图像预加载器。

我的 html 看起来像这样

```
<div id="image_container">
  <div id="container">
    <img class="box wed cake" src="/images/gallery/wed2.png" />
    <img class="box wed cake" src="/images/gallery/wed1.png" />
    <img class="box wed cake" src="/images/gallery/wed13.png" />
    ...
  </div>
</div> 
```

我把它放在页面的同位素文件中

```
$(document).ready(function(){
var $container = $('#container');
$container.isotope({
  filter: '',
   animationOptions: {
   duration: 750,
   easing: 'linear',
   queue: false,
   }
 });

$('#filter a').click(function(){
  var selector = $(this).attr('data-filter');
  $container.isotope({ 
  filter: selector,
  animationOptions: {
  duration: 750,
  easing: 'linear',
  queue: false,
  }
 });
return false;
});

$('.box').preloader({
  loader: '/images/loading.gif',
  fadeIn: 700,
  delay : 200 
});
}); 
```

有什么方法可以让我在整个`container`div 中预加载图像并让微调器浮动在 div 中`container`，或者我可以得到它以便`container`预加载图像大小，这样它们就不会坐在彼此上？

抱歉，如果这是一个菜鸟问题，我最近一段时间一直在阅读同位素文档并且无法理解它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T07:03:02.940

我正在破解它，我想出了如何去做。

```
$('#container').preloader({
  loader: '/images/loading.gif',
  fadeIn: 700,
  delay : 200 
}); 
```

预加载器插件可以在容器类型的 div 上工作，只需选择 div 将一次预加载其所有子项。要让图像停止相互叠加，只需使用 js

```
$(window).load(function(){ ... 
```

像这样加载将解决该问题。

向所有试图帮助我的数据用完的人致敬。:)

# objective-c - 当我拥有的唯一关系信息是 JSON 结构时，如何在 RestKit 中设置关系？

> ID：15277011
> 
> 赞同：0
> 
> 时间：2013-03-07T16:51:49.423
> 
> 标签：objective-c, cocoa-touch, core-data, restkit

我正在尝试基于从 Web 服务检索到的 JSON 在 Core Data 中创建节点实体的层次结构。

这是我的 JSON 结构的示例

[http://cl.ly/image/0r2x3E210m1U](http://cl.ly/image/0r2x3E210m1U)

我无法弄清楚如何为映射设置关系。

有人可以帮我吗？我正在使用最新的 RestKit 版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T18:31:22.830

如果失败：

```
RKEntityMapping *nodeMapping = [RKEntityMapping mappingForEntityForName:@"Node" inManagedObjectStore:managedObjectStore];
[locationIconMapping addAttributeMappingsFromDictionary:@{
    @"name": @"name",
    @"type": @"type",
}];
[nodeMapping addPropertyMapping:[RKRelationshipMapping relationshipMappingFromKeyPath:@"nodes" toKeyPath:@"nodes" withMapping:nodeMapping]]; 
```

那么怎么样：

```
RKEntityMapping *nodeMapping1 = [RKEntityMapping mappingForEntityForName:@"Node" inManagedObjectStore:managedObjectStore];
[nodeMapping1 addAttributeMappingsFromDictionary:@{
    @"name": @"name",
    @"type": @"type",
}];

RKEntityMapping *nodeMapping2 = [RKEntityMapping mappingForEntityForName:@"Node" inManagedObjectStore:managedObjectStore];
[nodeMapping2 addAttributeMappingsFromDictionary:@{
    @"name": @"name",
    @"type": @"type",
}];

[nodeMapping1 addPropertyMapping:[RKRelationshipMapping relationshipMappingFromKeyPath:@"nodes" toKeyPath:@"nodes" withMapping:nodeMapping2]];
[nodeMapping2 addPropertyMapping:[RKRelationshipMapping relationshipMappingFromKeyPath:@"nodes" toKeyPath:@"nodes" withMapping:nodeMapping1]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T15:03:00.230

你不能。在 JSON / RESTKIT 中，您不能提供递归结构 ob 对象。如果您想深入研究，请尝试一次获取对象级别并进行新查询。

如果有人访问此属性，您的“节点”类应该具有一种延迟加载的“节点”属性。

# prestashop - PrestaShop：生产前删除所有测试数据

> ID：15277017
> 
> 赞同：4
> 
> 时间：2013-03-07T16:52:13.253
> 
> 标签：prestashop

我正在搜索要在 MySql 上运行的脚本，以删除（截断表）PrestaShop 数据库版本 1.4.9 上的所有测试数据（客户、订单、购物车等）。感谢 Pascal

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-01-09T13:53:33.593

安装 Prestashop Cleaner 并在配置中您可以选择删除目录、订单和客户

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-25T10:37:45.790

对于 1.5.6.2（可能适用于 1.5.6*，甚至可能适用于 1.5.*）：

```
TRUNCATE `ps_access`;
TRUNCATE `ps_address`;
TRUNCATE `ps_alias`;
TRUNCATE `ps_attribute`;
TRUNCATE `ps_attribute_group`;
TRUNCATE `ps_attribute_group_lang`;
TRUNCATE `ps_attribute_group_shop`;
TRUNCATE `ps_attribute_lang`;
TRUNCATE `ps_attribute_shop`;
TRUNCATE `ps_carrier`;
TRUNCATE `ps_carrier_group`;
TRUNCATE `ps_carrier_lang`;
TRUNCATE `ps_carrier_shop`;
TRUNCATE `ps_carrier_tax_rules_group_shop`;
TRUNCATE `ps_carrier_zone`;
TRUNCATE `ps_cart`;
TRUNCATE `ps_cart_product`;
TRUNCATE `ps_category`;
TRUNCATE `ps_category_group`;
TRUNCATE `ps_category_lang`;
TRUNCATE `ps_category_product`;
TRUNCATE `ps_category_shop`;
TRUNCATE `ps_cms`;
TRUNCATE `ps_cms_block`;
TRUNCATE `ps_cms_block_lang`;
TRUNCATE `ps_cms_block_page`;
TRUNCATE `ps_cms_block_shop`;
TRUNCATE `ps_cms_category`;
TRUNCATE `ps_cms_category_lang`;
TRUNCATE `ps_cms_lang`;
TRUNCATE `ps_cms_shop`;
TRUNCATE `ps_connections`;
TRUNCATE `ps_contact_lang`;
TRUNCATE `ps_contact_shop`;
TRUNCATE `ps_customer`;
TRUNCATE `ps_customer_group`;
TRUNCATE `ps_delivery`;
TRUNCATE `ps_feature`;
TRUNCATE `ps_feature_lang`;
TRUNCATE `ps_feature_shop`;
TRUNCATE `ps_feature_value`;
TRUNCATE `ps_feature_value_lang`;
TRUNCATE `ps_guest`;
TRUNCATE `ps_homeslider`;
TRUNCATE `ps_homeslider_slides`;
TRUNCATE `ps_homeslider_slides_lang`;
TRUNCATE `ps_image`;
TRUNCATE `ps_image_lang`;
TRUNCATE `ps_image_shop`;
TRUNCATE `ps_image_type`;
TRUNCATE `ps_manufacturer`;
TRUNCATE `ps_manufacturer_lang`;
TRUNCATE `ps_manufacturer_shop`;
TRUNCATE `ps_orders`;
TRUNCATE `ps_order_carrier`;
TRUNCATE `ps_order_cart_rule`;
TRUNCATE `ps_order_detail`;
TRUNCATE `ps_order_detail_tax`;
TRUNCATE `ps_order_history`;
TRUNCATE `ps_order_invoice`;
TRUNCATE `ps_order_invoice_payment`;
TRUNCATE `ps_order_invoice_tax`;
TRUNCATE `ps_order_message`;
TRUNCATE `ps_order_message_lang`;
TRUNCATE `ps_order_return_state`;
TRUNCATE `ps_order_return_state_lang`;
TRUNCATE `ps_order_state`;
TRUNCATE `ps_order_state_lang`;
TRUNCATE `ps_page`;
TRUNCATE `ps_page_type`;
TRUNCATE `ps_product`;
TRUNCATE `ps_product_attribute`;
TRUNCATE `ps_product_attribute_combination`;
TRUNCATE `ps_product_attribute_image`;
TRUNCATE `ps_product_attribute_shop`;
TRUNCATE `ps_product_lang`;
TRUNCATE `ps_product_shop`;
TRUNCATE `ps_product_supplier`;
TRUNCATE `ps_product_tag`;
TRUNCATE `ps_range_price`;
TRUNCATE `ps_range_weight`;
TRUNCATE `ps_reinsurance`;
TRUNCATE `ps_reinsurance_lang`;
TRUNCATE `ps_scene`;
TRUNCATE `ps_scene_category`;
TRUNCATE `ps_scene_lang`;
TRUNCATE `ps_scene_products`;
TRUNCATE `ps_scene_shop`;
TRUNCATE `ps_search_index`;
TRUNCATE `ps_search_word`;
TRUNCATE `ps_specific_price`;
TRUNCATE `ps_stock_available`;
TRUNCATE `ps_stock_mvt_reason`;
TRUNCATE `ps_stock_mvt_reason_lang`;
TRUNCATE `ps_store`;
TRUNCATE `ps_store_shop`;
TRUNCATE `ps_supplier`;
TRUNCATE `ps_supplier_lang`;
TRUNCATE `ps_supplier_shop`;
TRUNCATE `ps_supply_order_state`;
TRUNCATE `ps_supply_order_state_lang`;
TRUNCATE `ps_tag`; 
```

在你开始之前会给你一个干净、准备好的数据库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-09T06:15:10.213

请注意，此站点不适用于为您的任何类型的工作寻找脚本。这只是提供建议，并基于该建议提供逐步指导和示例脚本/代码。如何从 PS 安装中删除测试数据很简单。

1) 转到管理面板。2）删除类别和产品 3）删除客户 4）删除购物车和订单。

这是最简单的方法。但是，如果您想为它们截断表格，请按照以下步骤操作

1) 在您的服务器上访问 PhpMyAdmin。2) 找到您的 PS 安装使用的数据库 3) 对于客户，截断 ps_customers、ps_address 4) 对于购物车，截断 ps_cart、ps_cart_products 5) 对于订单，截断 ps_order、ps_order_details、

请注意，上述截断只会从管理员和数据库中删除这些数据，但还有一些其他表也可以被截断。但必须的，因为如果你不这样做，那么数据将不会显示在管理员中，所以根本不需要。我不能列出它们，因为有了新的 PS 版本，表格会改变。

# c# - 通过 c# 代码更改 Windows Phone 应用程序中的系统托盘颜色

> ID：15277020
> 
> 赞同：0
> 
> 时间：2013-03-07T16:52:25.090
> 
> 标签：c#, visual-studio, windows-phone-8, windows-phone-7.1, windows-phone

我知道我可以使用以下方法通过 xaml 更改系统托盘颜色：

```
 shell:SystemTray.BackgroundColor="#D2D9AE" 
```

但是如果我想通过c#更改系统托盘颜色怎么办？有没有办法通过c#代码改变systemtray的前景色/背景色？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T17:21:08.027

只需设置属性。例如：

```
public MainPage()
{
    InitializeComponent();

    this.Loaded += MainPage_Loaded;
}

void MainPage_Loaded(object sender, RoutedEventArgs e)
{
    Microsoft.Phone.Shell.SystemTray.BackgroundColor = Colors.Cyan;
    Microsoft.Phone.Shell.SystemTray.ForegroundColor = Colors.Green;
} 
```

# css - 骨架等高柱

> ID：15277021
> 
> 赞同：2
> 
> 时间：2013-03-07T16:52:27.283
> 
> 标签：css, skeleton-css-boilerplate

Skeleton 对所有列使用 float:left 和 display:inline。我需要使我的列高度相等，但仍保持 float:left 和 display:inline 以便在浏览器窗口调整大小时它们的行为符合预期。任何想法？

# php - 未定义索引 php mvc 模型

> ID：15277026
> 
> 赞同：-2
> 
> 时间：2013-03-07T16:52:40.177
> 
> 标签：php

未定义索引：first_name

```
$view = $user->VIEW_EMP($connect);
    if (is_array($view)) {
        foreach($view as $key => $value){
            echo $view['first_name'];
        }
    } 
```

功能：

```
static function VIEW_EMP($db){
    $sql = "SELECT * from employees LIMIT 0, 30 ";
    if($output = mysql_query($sql)):
            $columns = array();
            while($result = mysql_fetch_assoc($output)):
                $columns[] = $result;
            endwhile;
        endif; 
       return $columns;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T16:55:16.093

似乎错字。

```
echo $view['first_name']; 
```

应该

```
echo $value['first_name']; 
```

# c# - 如何根据为模型创建的 checkboxfor 创建对象列表

> ID：15277032
> 
> 赞同：1
> 
> 时间：2013-03-07T16:52:54.793
> 
> 标签：c#, asp.net-mvc, list

我有这个基于模型列表的视图，在该列表中，我根据布尔值为模型的每个项目创建强类型复选框。

这是我的看法：

```
@using MyApp.Models
@model IList<MyApp.Models.ObjInfo>

@{
    ViewBag.Title = "Obj Inventory";
}

<h2>Search Inventory</h2>

<p>
    @using (Html.BeginForm())
    {
        (Many search filters which are non-relevant)
        <p>
            Send Items: @Html.ActionLink("Click Here", "SendItems")
        </p>
    }
<table>
    <tr>
        <th>
            Obj Name
        </th>
        <th>
            Number In Stock
        </th>
        (...)
        <th>
            Select Item
        </th>
    </tr>
@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.OtherObj.m_Name)
        </td>
        (...)
        <td>
            @Html.CheckBoxFor(modelItem => item.m_IsSelected)
        </td>
    </tr>
}

</table> 
```

整个过程运行良好，我实际上可以为我的模型列表中的每个项目生成一个带有复选框的视图。

现在我的问题是我想创建一个列表，该列表仅重新组合列表中已检查的项目并将它们发送到控制器。我怎么能那样做？任何人都可以帮助我或建议我的工作方式吗？

谢谢！

*** 编辑 ***

这是用于获取项目列表的 HttpPost 方法，如下所述：

```
//
        // GET: /Inventory/SendItems
        [HttpPost]
        public ActionResult SendItems(IList<ObjInfo> listToSend)
        {
            m_ListObjToSend = new List<ObjInfo>();

            foreach (var item in listToSend.Where(item => item.m_IsSelected))
            {
                m_ListObjToSend .Add(item);
            }

            return View(m_ListObjToSend );
        } 
```

但是我遇到了很多问题：

*   如果我放置 [HttpPost] 属性，此方法不起作用（它将显示为“未找到”）；
    *   我应该收到的列表是空的；
    *   即使选中的值显示为 true，与复选框链接的每个隐藏字段的默认值为 false；
    *   我正在使用 actionlink，因为我不想使用按钮，已经有一个按钮正在做另一项工作。

我愿意接受任何可用的评论/帮助，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T16:55:17.837

如果您使用 CheckBoxFor 帮助器来生成复选框，您会注意到它会随每个复选框生成一个附加隐藏字段。这意味着所有值都将发送到控制器，您必须在控制器中过滤那些被检查的值。

此外，我建议您使用索引来确保正确的模型绑定。在将其传递给视图之前，您只需要使用`IList<ObjInfo>`或通过在视图模型上`ObjInfo[]`调用`.ToList()`或扩展方法即可轻松实现：`.ToArray()`

```
@using MyApp.Models
@model IList<ObjInfo>
...
@for (var i = 0; i < Model.Count; i++) 
{
    <tr>
        <td>
            @Html.DisplayFor(x => x[i].OtherObj.m_Name)
        </td>
        (...)
        <td>
            @Html.CheckBoxFor(x => x[i].m_IsSelected)
        </td>
    </tr>
}
... 
```

现在您的控制器操作可以直接获取项目列表：

```
[HttpPost]
public ActionResult SomeAction(IEnumerable<ObjInfo> model)
{
    ...
} 
```

如果您想找到选定的值，您可以简单地通过 LINQ 获取它们：

```
[HttpPost]
public ActionResult SomeAction(IEnumerable<ObjInfo> model)
{
    var selectedItems = model.Where(x => x.m_IsSelected);
    ...
} 
```

备注：`m_Name`and`m_IsSelected`是 C# 中属性的一个非常**糟糕的**命名约定。

* * *

更新：

您的代码存在的另一个问题是您的代码`Html.BeginForm`不包含任何输入字段。它只有一个 ActionLink 显然只做一个 GET 请求。如果你想提交值，你应该用表单包裹你的整个表格并使用提交按钮而不是一些操作链接：

```
@using MyApp.Models
@model IList<ObjInfo>

@{
    ViewBag.Title = "Obj Inventory";
}

<h2>Search Inventory</h2>

<p>
    @using (Html.BeginForm("SendItems", null, FormMethod.Post))
    {
        (Many search filters which are non-relevant)

        <table>
            <tr>
                <th>Obj Name</th>
                <th>Number In Stock</th>
                (...)
                <th>Select Item</th>
           </tr>
        @for (var i = 0; i < Model.Count; i++) 
        {
            <tr>
                <td>
                    <!-- 
                    This will not be sent to your controller because it's only a label.
                    You will need a corresponding hidden field if you want to get that value back
                    -->
                    @Html.DisplayFor(x => x[i].OtherObj.m_Name)
                </td>
                (...)
                <td>
                    @Html.CheckBoxFor(x => x[i].m_IsSelected)
                </td>
            </tr>
        }
        </table>

        <p>
            Send Items: <button type="submit">Click Here</button>
        </p>
    }
</p> 
```

所以真的，你应该学习两件事：

1.  [`naming convention`](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)绑定到列表时默认模型绑定器所期望的
2.  如何使用 javascript 调试工具（例如 FireBug 和/或 Chrome Developper Toolbar），它允许您检查发送到您的服务器的所有值，并立即识别您是否遵守您在 1 中学到的约定。

# c# - ListBox.SelectedIndex = -1 未取消设置选定项

> ID：15277033
> 
> 赞同：3
> 
> 时间：2013-03-07T16:52:56.833
> 
> 标签：c#, wpf, listbox, selecteditem

我在 XAML 中定义了一个列表框，如下所示：

```
<ListBox x:Name="listLeagues" DisplayMemberPath="LeagueName" 
         SelectionChanged="listLeagues_SelectionChanged"
         SelectedItem="{Binding SelectedObject, Mode=TwoWay}"
         SelectionMode="Single"    
         BorderBrush="{StaticResource noBrush}" Background="{StaticResource noBrush}"
         ScrollViewer.HorizontalScrollBarVisibility="Disabled">
</ListBox> 
```

在代码中，我将 DataContext 设置如下： `listLeagues.ItemsSource = Leagues;`其中 'Leagues' 是自定义集合。我正在尝试使用以下代码更改代码中的选定项目：

```
 private void addButton_Click(object sender, MouseButtonEventArgs e)
    {
        FantasyLeague addedLeague = new FantasyLeague();
        Random rnd = new Random();
        addedLeague.LeagueName = "New Leauge " + rnd.Next(100).ToString();

        Leagues.Add(addedLeague);

        listLeagues.SelectedIndex = -1;
        listLeagues.SelectedItem = addedLeague;
        LeagueDetailsClickHelper();
    } 
```

我的列表框有 SelectionMode = Single。该行`listLeagues.SelectedIndex = -1;`没有任何影响，并且当将 SelectedItem 更改为新值时，即使模式是单一的，它也将两个项目都作为 SelectedItems。有人可以解释出了什么问题吗？

非常感谢你的帮助。

编辑

我已经`SelectedItem="{Binding SelectedObject, Mode=TwoWay}"`从 XAML 中删除了 ，发现一切正常[大部分时间]。我正在更新 ListBox 的基础源，当将影响 == 运算符评估的值更改为与原始值不同时，我注意到 SelectionChanged 事件不包括 RemovedItems 中的任何内容。我将尝试制作对象的深层副本并更改深层副本，看看是否能解决我的问题。

最后更新

我制作了联盟收藏中的 FantasyLeague 的深层副本。我将 FantasyLeauge 的成员绑定到一个可以更改的表单。当我将此深层副本作为允许更改 Leagues 集合而不是原始表单的来源时，没有任何问题。我不确定为什么更改与 == 和 .Equals 的评估相关的值会导致这种行为，而不仅仅是正确更新目标/源，但是，我已经解决了这个问题。如果有人对导致这种行为的原因有意见，我将不胜感激。感谢所有提出建议的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:50:36.260

```
listLeagues.SelectedIndex = -1;
    listLeagues.SelectedItem = addedLeague;
**listLeagues.UpdateLayOut();** 
```

I hope this will help.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:13:33.483

好吧，首先你应该使用`ObservableCollection`for 绑定。

其次，您将实际 UI 设置`SelectedIndex`为 -1（这完全违背了绑定的目的）。您需要设置的索引`DataSource`。

尝试一下，并可能发布您的其余代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-25T16:18:55.887

我意识到这很旧，但由于它在我的搜索中显示很高，我想更新答案。我认为您应该使用 .ClearSelected() 方法，[MSDN info](http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.clearselected(v=vs.110).aspx)。这应该清除列表框 C# 或 VBA (.net) 中的任何选择。

干杯，

# shopify - Shopify API 重复 PUT 有不同的结果（选项不是唯一的）

> ID：15277038
> 
> 赞同：1
> 
> 时间：2013-03-07T16:53:06.387
> 
> 标签：shopify

当我更新具有多个变体的产品时，我收到错误响应：

```
{"errors":{"base":["Options are not unique"]}} 
```

或者有时：

```
{"errors":{"variants":["is invalid"], "base":["Options are not unique"]}} 
```

我正在向 /admin/products/122821632.json 之类的东西发出 PUT 请求，其中包含以下数据：

```
{"product":{"id":"122821632",
           "body_html":"test",
           "vendor":"Acme",
           "title":"Monkey T-Shirt",
           "variants":[{"option1":"LARGE",
                        "sku":"test-sku-2",
                        "product_id":"122821632",
                        "id":"282988194",
                        "price":"21.99",
                        "grams":"200"},
                       {"option1":"TINY",
                        "sku":"test-sku-1",
                        "product_id":"122821632",
                        "id":"282990692",
                        "price":"21.99",
                        "grams":"200"}],
           "options":[{"position":1,
                       "name":"Size",
                        "product_id":"122821632"}]}} 
```

但是我注意到，如果我放置一个变体，然后放置多个变体数据 JSON，它就可以工作。这确实意味着删除一个变体并重新创建它，我认为这对于插件来说是不可接受的行为，特别是因为我没有存储有关变体的所有数据，因此无法投入生产。

为此，我提出了这些 PUT 请求：

```
{"product":{"id":"122821632",
           "body_html":"test",
           "vendor":"Acme",
           "title":"Monkey T-Shirt",
           "variants":[{"option1":"LARGE",
                        "sku":"test-sku-2",
                        "product_id":"122821632",
                        "id":"282988194",
                        "price":"21.99",
                        "grams":"200"}],
           "options":[{"position":1,
                       "name":"Size",
                       "product_id":"122821632"}]}} 
```

返回 200。其次是：

```
{"product":{"id":"122821632",
           "body_html":"test",
           "vendor":"Acme",
           "title":"Monkey T-Shirt",
           "variants":[{"option1":"LARGE",
                        "sku":"test-sku-2",
                        "product_id":"122821632",
                        "id":"282988194",
                        "price":"21.99",
                        "grams":"200"},
                       {"option1":"TINY",
                        "sku":"test-sku-1",
                        "product_id":"122821632",
                        "id":"282990692",
                        "price":"21.99",
                        "grams":"200"}],
           "options":[{"position":1,
                       "name":"Size",
                       "product_id":"122821632"}]}} 
```

返回 200。其次是：

```
{"product":{"id":"122821632",
           "body_html":"test",
           "vendor":"Acme",
           "title":"Monkey T-Shirt",
           "variants":[{"option1":"LARGE",
                        "sku":"test-sku-2",
                        "product_id":"122821632",
                        "id":"282988194",
                        "price":"21.99",
                        "grams":"200"},
                       {"option1":"TINY",
                        "sku":"test-sku-1",
                        "product_id":"122821632",
                        "id":"282990692",
                        "price":"21.99",
                        "grams":"200"}],
           "options":[{"position":1,
                       "name":"Size",
                       "product_id":"122821632"}]}} 
```

这给了我错误。我删除并重新创建的变体的 ID 也发生了变化（我可以通过获取请求来判断）：

```
{"product":{"body_html":"test",
            "handle":"69",
            "images":[],
            "template_suffix":null,
            "product_type":"Shirts",
            "updated_at":"2013-03-07T11:36:51-05:00",
            "variants":[{"position":1,
                         "option1":"LARGE",
                         "option2":null,
                         "option3":null,
                         "updated_at":"2013-03-07T07:30:15-05:00",
                         "inventory_quantity":1,
                         "title":"LARGE",
                         "product_id":122821632,
                         "created_at":"2013-03-06T11:03:36-05:00",
                         "compare_at_price":"24.99",
                         "fulfillment_service":"manual",
                         "inventory_management":"",
                         "sku":"test-sku-2",
                         "taxable":true,
                         "requires_shipping":true,
                         "price":"21.99",
                         "inventory_policy":"deny",
                         "id":282988194,
                         "grams":200},
                        {"position":2,
                         "option1":"TINY",
                         "option2":null,
                         "option3":null,
                         "updated_at":"2013-03-07T11:36:51-05:00",
                         "inventory_quantity":1,
                         "title":"TINY",
                         "product_id":122821632,
                         "created_at":"2013-03-07T11:36:51-05:00",
                         "compare_at_price":null,
                         "fulfillment_service":"manual",
                         "inventory_management":null,
                         "sku":"test-sku-1",
                         "taxable":true,
                         "requires_shipping":true,
                         "price":"21.99",
                         "inventory_policy":"deny",
                         "id":283397624,
                         "grams":200}],
            "title":"Monkey T-Shirt",
            "created_at":"2013-02-22T05:35:02-05:00",
            "options":[{"id":147204272,
                        "name":"Size",
                        "position":1,
                        "product_id":122821632}],
            "vendor":"Acme",
            "id":122821632,
            "published_at":"2013-02-22T05:35:02-05:00",
            "tags":"mens t-shirt example"}} 
```

我的印象是，对相同 URL 的相同数据的第二次 PUT 请求应该不会导致任何变化。

我究竟做错了什么？这是 Shopify API 中的错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-27T10:25:53.693

我昨天遇到了和你一样的问题。看起来您不能使用 PUT /admin/products/122821632.json 来修改变体。

使用变体创建产品后，您必须使用[http://docs.shopify.com/api/product_variant#update](http://docs.shopify.com/api/product_variant#update)更新各个变体，否则如果您在产品 PUT 中包含变体数据，则会出现该错误。

如果您想在设置变体后对其进行更新，则必须错过产品 PUT 中的所有变体信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T01:31:53.087

我的朋友，当我这样做时，我曾经也通知选项 id ......所以选项部分将保持这样的状态：

```
"options":[{"id":147204272,"position":1,"name":"Size","product_id":"122821632"}]}} 
```

选项在 json 方面类似于变体，它们也有 id。图像也会发生同样的情况。

让我知道它是否有帮助。

# c++ - Qt 5.0 在带有父级的 QWidget 上拖动文件时崩溃

> ID：15277042
> 
> 赞同：1
> 
> 时间：2013-03-07T16:53:20.827
> 
> 标签：c++, qt, drag-and-drop, segmentation-fault

从 qt4.8 拖放到 qt 5.0.1 时，我遇到了一个非常奇怪的崩溃。旧的 qt 4.8 一切正常，但是当我进入 qt 5.0 时，在主窗口上拖动文件时似乎总是崩溃。

所以我开始了一个完全干净的项目，在中央小部件中创建了一个布局，然后在布局中创建了一个小部件。像这样的小部件树：

主窗口 - centralWidget - 布局 - newWidget

每次我在窗口上拖动文件时，Qt 似乎都会加载很多库来查找模板，这肯定没有问题（除了需要一些时间）。现在出现了奇怪的部分，当我放下文件时（注意没有 QWidget 不可放置，根本没有特殊设置）程序崩溃，每次都会发生这种情况，当我将文件放在窗口中或将文件拖到窗口外时会发生这种情况.

它每次都给我一个分段错误和这个反汇编代码：

```
 Function: lstrlenA
0x74dcad83  <+0x0006>         jge    0x74dcad6d <lstrcpynA+112>
0x74dcad85  <+0x0008>         sti
0x74dcad86  <+0x0009>         roll   $0x0,(%edx)
0x74dcad89  <+0x000c>         mov    0x8(%ebp),%eax
0x74dcad8c  <+0x000f>         test   %eax,%eax
0x74dcad8e  <+0x0011>         je     0x74dcadc7 <lstrlenA+74>
0x74dcad90  <+0x0013>         andl   $0x0,-0x4(%ebp)
0x74dcad94  <+0x0017>         lea    0x1(%eax),%edx
0x74dcad97  <+0x001a>         mov    (%eax),%cl
0x74dcad99  <+0x001c>         inc    %eax
0x74dcad9a  <+0x001d>         test   %cl,%cl
0x74dcad9c  <+0x001f>         jne    0x74dcad97 <lstrlenA+26>
0x74dcad9e  <+0x0021>         sub    %edx,%eax
0x74dcada0  <+0x0023>         movl   $0xfffffffe,-0x4(%ebp)
0x74dcada7  <+0x002a>         jmp    0x74dcadc9 <lstrlenA+76>
0x74dcada9  <+0x002c>         mov    -0x14(%ebp),%eax
0x74dcadac  <+0x002f>         mov    (%eax),%eax
0x74dcadae  <+0x0031>         mov    (%eax),%eax
0x74dcadb0  <+0x0033>         xor    %ecx,%ecx
0x74dcadb2  <+0x0035>         cmp    $0xc00000fd,%eax
0x74dcadb7  <+0x003a>         setne  %cl
0x74dcadba  <+0x003d>         mov    %ecx,%eax
0x74dcadbc  <+0x003f>         ret
0x74dcadbd  <+0x0040>         mov    -0x18(%ebp),%esp
0x74dcadc0  <+0x0043>         movl   $0xfffffffe,-0x4(%ebp)
0x74dcadc7  <+0x004a>         xor    %eax,%eax
0x74dcadc9  <+0x004c>         call   0x74df6fc9 <KERNELBASE!IsNLSDefinedString+1209>
0x74dcadce  <+0x0051>         ret    $0x4
0x74dcadd1  <+0x0054>         int3
0x74dcadd2  <+0x0055>         int3
0x74dcadd3  <+0x0056>         int3
0x74dcadd4  <+0x0057>         int3
0x74dcadd5  <+0x0058>         int3
        Function: lstrcmpW
0x74dcadd6  <+0x0000>         mov    %edi,%edi
0x74dcadd8  <+0x0002>         push   %ebp
0x74dcadd9  <+0x0003>         mov    %esp,%ebp
0x74dcaddb  <+0x0005>         push   %esi
0x74dcaddc  <+0x0006>         mov    0xc(%ebp),%esi
0x74dcaddf  <+0x0009>         push   %edi
0x74dcade0  <+0x000a>         mov    0x8(%ebp),%edi
0x74dcade3  <+0x000d>         push   $0xffffffff
0x74dcade5  <+0x000f>         push   %esi
0x74dcade6  <+0x0010>         push   $0xffffffff
0x74dcade8  <+0x0012>         push   %edi
0x74dcade9  <+0x0013>         push   $0x0
0x74dcadeb  <+0x0015>         push   $0x400
0x74dcadf0  <+0x001a>         call   0x74de2e93 <KERNELBASE!CopySid>
0x74dcadf5  <+0x001f>         test   %eax,%eax
0x74dcadf7  <+0x0021>         jne    0x74dcae54 <lstrcmpW+126>
0x74dcadf9  <+0x0023>         push   $0xffffffff 
```

系统是：Windows 7 x64 Qt 版本：Qt 5.0.1 with MinGW compiler

任何人对此有任何想法，似​​乎是一个 Qt 错误或？

编辑：尝试在发布模式下构建小应用程序，它工作正常，所以它与编译器有关。这是完整的堆栈跟踪：

```
Thread 6 (Thread 5248.0x1d48):
#0  0x77121f26 in ntdll!LdrQueryProcessModuleInformation () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#1  0x77121f26 in ntdll!LdrQueryProcessModuleInformation () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#2  0x77153352 in ntdll!RtlCreateTagHeap () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#3  0x75ea33aa in KERNEL32!BaseCleanupAppcompatCacheSupport () from C:\Windows\syswow64\kernel32.dll
No symbol table info available.
#4  0x77139ef2 in ntdll!RtlpNtSetValueKey () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#5  0x77139ec5 in ntdll!RtlpNtSetValueKey () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#6  0x00000000 in ?? ()
No symbol table info available.

Thread 5 (Thread 5248.0x1278):
#0  0x7711fd71 in ntdll!RtlFindSetBits () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#1  0x74dd4498 in Sleep () from C:\Windows\syswow64\KernelBase.dll
No symbol table info available.
#2  0x7620d98d in ole32!CoIsOle1Class () from C:\Windows\syswow64\ole32.dll
No symbol table info available.
#3  0x7620d87a in ole32!CoIsOle1Class () from C:\Windows\syswow64\ole32.dll
No symbol table info available.
#4  0x75ea33aa in KERNEL32!BaseCleanupAppcompatCacheSupport () from C:\Windows\syswow64\kernel32.dll
No symbol table info available.
#5  0x77139ef2 in ntdll!RtlpNtSetValueKey () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#6  0x77139ec5 in ntdll!RtlpNtSetValueKey () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#7  0x00000000 in ?? ()
No symbol table info available.

Thread 4 (Thread 5248.0x1978):
#0  0x77121f26 in ntdll!LdrQueryProcessModuleInformation () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#1  0x77121f26 in ntdll!LdrQueryProcessModuleInformation () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#2  0x77153352 in ntdll!RtlCreateTagHeap () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#3  0x75ea33aa in KERNEL32!BaseCleanupAppcompatCacheSupport () from C:\Windows\syswow64\kernel32.dll
No symbol table info available.
#4  0x77139ef2 in ntdll!RtlpNtSetValueKey () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#5  0x77139ec5 in ntdll!RtlpNtSetValueKey () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#6  0x00000000 in ?? ()
No symbol table info available.

Thread 3 (Thread 5248.0x1d90):
#0  0x77121f26 in ntdll!LdrQueryProcessModuleInformation () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#1  0x77121f26 in ntdll!LdrQueryProcessModuleInformation () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#2  0x77153352 in ntdll!RtlCreateTagHeap () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#3  0x75ea33aa in KERNEL32!BaseCleanupAppcompatCacheSupport () from C:\Windows\syswow64\kernel32.dll
No symbol table info available.
#4  0x77139ef2 in ntdll!RtlpNtSetValueKey () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#5  0x77139ec5 in ntdll!RtlpNtSetValueKey () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#6  0x00000000 in ?? ()
No symbol table info available.

Thread 2 (Thread 5248.0x84):
#0  0x7712013d in ntdll!RtlEnableEarlyCriticalSectionEventCreation () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#1  0x75ea33aa in KERNEL32!BaseCleanupAppcompatCacheSupport () from C:\Windows\syswow64\kernel32.dll
No symbol table info available.
#2  0x77139ef2 in ntdll!RtlpNtSetValueKey () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#3  0x77139ec5 in ntdll!RtlpNtSetValueKey () from C:\Windows\system32\ntdll.dll
No symbol table info available.
#4  0x00000000 in ?? ()
No symbol table info available.

Thread 1 (Thread 5248.0x1a10):
#0  0x74dcad97 in lstrlenA () from C:\Windows\syswow64\KernelBase.dll
No symbol table info available.
#1  0x525bb9b9 in D3DStripShader () from C:\Qt\Qt5.0.1\5.0.1\mingw47_32\bin\D3DCompiler_43.dll
No symbol table info available.
#2  0x00000100 in ?? ()
        qt_meta_stringdata_QPropertyAnimation = {data = {{ref = {atomic = {_q_value = -1}}, size = 18, alloc = 0, capacityReserved = 0, offset = 48, static shared_null = {{ref = {atomic = {_q_value = -1}}, size = 0, alloc = 0, capacityReserved = 0, offset = 16, static shared_null = <same as static member of an already seen type>}, {ref = {atomic = {_q_value = 0}}, size = 0, alloc = 0, capacityReserved = 0, offset = 0, static shared_null = <same as static member of an already seen type>}}}, {ref = {atomic = {_q_value = -1}}, size = 12, alloc = 0, capacityReserved = 0, offset = 51, static shared_null = {{ref = {atomic = {_q_value = -1}}, size = 0, alloc = 0, capacityReserved = 0, offset = 16, static shared_null = <same as static member of an already seen type>}, {ref = {atomic = {_q_value = 0}}, size = 0, alloc = 0, capacityReserved = 0, offset = 0, static shared_null = <same as static member of an already seen type>}}}, {ref = {atomic = {_q_value = -1}}, size = 12, alloc = 0, capacityReserved = 0, offset = 48, static shared_null = {{ref = {atomic = {_q_value = -1}}, size = 0, alloc = 0, capacityReserved = 0, offset = 16, static shared_null = <same as static member of an already seen type>}, {ref = {atomic = {_q_value = 0}}, size = 0, alloc = 0, capacityReserved = 0, offset = 0, static shared_null = <same as static member of an already seen type>}}}}, stringdata = "QPropertyAnimation\000propertyName\000targetObject\000"}
        qt_meta_data_QPropertyAnimation = {7, 0, 0, 0, 0, 0, 2, 14, 0, 0, 0, 0, 0, 0, 1, 12, 610563, 2, 39, 610563, 0}
        QPropertyAnimation::staticMetaObject = {d = {superdata = 0x6bae8ff0, stringdata = 0x6bae9a80, data = 0x6bae9ae0, static_metacall = 0x6b788a4e <QPropertyAnimation::qt_static_metacall(QObject*, QMetaObject::Call, int, void**)>, relatedMetaObjects = 0x0, extradata = 0x0}}
#3  0x19fe0000 in ?? ()
No symbol table info available.
#4  0x7efdb800 in ?? ()
No symbol table info available.
#5  0x76457a36 in wvsprintfW () from C:\Windows\syswow64\user32.dll
No symbol table info available.
#6  0x003bd676 in HydraDMH!HookMessages () from C:\Program Files (x86)\ATI Technologies\HydraVision\HydraDMH.dll
No symbol table info available.
warning: (Internal error: pc 0xff in read in psymtab, but not in symtab.)

warning: (Internal error: pc 0xff in read in psymtab, but not in symtab.)

warning: (Internal error: pc 0xff in read in psymtab, but not in symtab.)

warning: (Internal error: pc 0xff in read in psymtab, but not in symtab.)

warning: (Internal error: pc 0xff in read in psymtab, but not in symtab.)

warning: (Internal error: pc 0x0 in read in psymtab, but not in symtab.) 
```

编辑 2：经过大量测试后，我发现这似乎是我的 ATI 驱动程序的问题，当程序崩溃时，dll“ATI Technologies\HydraVision\HydraDMH.dll”总是在那里。我在没有 ATI 的笔记本电脑上测试了同一个小项目，它运行良好。只有在调试模式下才会发生崩溃。

真的不知道该去哪里，但拖放在 Qt 4.8.4 中有效，所以这可能是 Qt 5.0.1 中的一个问题。

# perl - perl中文件的映射和排序数组

> ID：15277055
> 
> 赞同：0
> 
> 时间：2013-03-07T16:53:49.173
> 
> 标签：perl, map, sorting

我有这个看起来像这样的文件数组：

```
my @html_pages_files = ("html.17", "html.9", "html.0", "html.10"); 
```

我会将文件的扩展名放在排序部分之后。基本上文件名是/html.\d/。问题是我正在尝试使用 map 和 sort 函数对其进行排序：

```
map { $_->[1] }
  sort { $a->[0] <=> $b->[0] }
     map { /html\.(.*)/; [$1, $_] }
        @html_pages_files;
print "@html_pages_files\n"; 
```

但是输出与原始数组相同。我一步一步地跟着@Chas。欧文斯在这里回答：[使用 Perl，如何使用每个数组元素内的数字值对数组进行排序？](https://stackoverflow.com/questions/809804/using-perl-how-can-i-sort-an-array-using-the-value-of-a-number-inside-each-arra). 请注意，我对 perl 很陌生，所以我没有得到所有的细节。

有人播种错误在哪里吗？谢谢！！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T17:02:36.833

您永远不会保存排序结果！

```
@html_pages_files =
   map { $_->[0] }
    sort { $a->[1] <=> $b->[1] }
     map { /html\.(.*)/; [$_, $1] }
      @html_pages_files; 
```

（为了保持一致性，我总是将整个字符串放在数组的第一个元素中。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-07T16:59:47.470

您的排序逻辑看起来正确，但您没有将操作结果分配给任何东西，所以您没有更改`@html_pages_files`. 尝试

```
@html_pages_files = map {$_->[1] } 
                    sort {$a->[0] <=> $b->[0]} 
                    map {/html\.(.*)/; [$1, $_]} @html_pages_files; 
```

# c# - 更改 WPF DatePicker 以一次选择一周

> ID：15277056
> 
> 赞同：0
> 
> 时间：2013-03-07T16:53:51.597
> 
> 标签：c#, wpf, date, user-interface, datepicker

我想修改标准 WPF DatePicker 以允许选择一周。如果我返回单个 DateTime 作为 SelectedDate 很好，但是当鼠标悬停时我需要 UI 来选择整个星期行。

我继承并附加到 SelectedDateChanged 以便它将 StartDayOfWeek 作为 SelectedDate 返回（下面的代码）。

我对如何突出显示整个星期有一个想法（使用鼠标事件）。我希望有一个更简单的方法。

```
 // force selection to be for first previous start DOW
        this.SelectedDateChanged += (sender, args) => {
            var newDate = (DateTime) args.AddedItems[0];

            while (newDate.DayOfWeek != FirstDayOfWeek)
                newDate = newDate.AddDays(-1);

            SelectedDate = newDate;
        }; 
```

**编辑**

我添加了我当前的解决方案作为答案。仍在寻找一种突出范围的好方法，而不是我目前的做法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:02:26.800

想我会添加我当前的解决方案，即涂黑不属于 FirstDayOfWeek 的任何日期，并确保如果它们超出我的 10 年范围，则无论如何都会选择正确的日期。

```
public class LocalizedWeekPicker : LocalizedDatePicker
{
    /// <summary>
    /// An LocalizedDatePicker that disallows selecting any date that does not have the same DOW as the FirstDayOfWeek property.
    /// It does this by disabling the dates N (currently=10) years forward and backward from today as well as automatically updating the date
    /// if you choose something more than 10 years away from today.
    /// </summary>
    public LocalizedWeekPicker() : base()
    {
        this.Loaded += (s1, a1) => {
            this.IsTodayHighlighted = false;

            if (SelectedDate.HasValue)
            {
                var tempDate = new DateTime(SelectedDate.Value.Ticks);
                SelectedDate = DateTimeUtils.GetPreviousDateOnDayOfWeek(FirstDayOfWeek, tempDate);
            }

            DisableDays();

            this.SelectedDateChanged += (s2, a2) => {
                var tempDate = new DateTime(((DateTime)a2.AddedItems[0]).Ticks);
                SelectedDate = DateTimeUtils.GetPreviousDateOnDayOfWeek(FirstDayOfWeek, tempDate);
            };
        };
    }

    // goes forward and back n years and disables dates that don't have the same start DOW as the FirstDayOfWeek
    private void DisableDays()
    {
        int years = 10;

        var current = DateTimeUtils.GetPreviousDateOnDayOfWeek(FirstDayOfWeek, DateTime.Now);
        for (int weeks = 0; weeks < (52 * years); weeks++)
        {
            this.BlackoutDates.Add(new CalendarDateRange {Start = current.AddDays(1), End = current.AddDays(6)});
            current = current.AddDays(7);
        }

        current = DateTimeUtils.GetPreviousDateOnDayOfWeek(FirstDayOfWeek, DateTime.Now);
        for (int weeks = 0; weeks < (52 * years); weeks++)
        {
            this.BlackoutDates.Add(new CalendarDateRange { Start = current.AddDays(1), End = current.AddDays(6) });
            current = current.AddDays(-7);
        }
    }
} 
```

# c# - 从 iframe 中的页面检索会话的 PageMethods 不起作用

> ID：15277062
> 
> 赞同：2
> 
> 时间：2013-03-07T16:53:56.867
> 
> 标签：c#, asp.net

2 页。Uploader.aspx 和 Uploadee.aspx。

Uploadee.aspx 位于 Uploader.aspx 上的 iframe 中。

这是 Uploader.aspx 的标记：

```
 <%@ Page Language="C#" AutoEventWireup="true" CodeFile="Uploader.aspx.cs" Inherits="Uploader" EnableEventValidation="false" %>

    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title></title>
<script type="text/javascript">
    function doupload()
    {
        document.getElementById('spFN').innerHTML = 'Document upload in progress.';
        window.frames[0].document.forms[0].submit();

        intervalID = window.setInterval(function ()
        {
            PageMethods.GetUploadStatus(function (result)
            {
                if (result)
                {
                    alert(result.fileNumber);
                    document.getElementById('spFN').innerHTML = 'Uploading file ' + result.fileNumber;
                }
            });
        }, 500);
    }  
</script>
</head>
<body>

    <form id="form1" runat="server">
    <asp:ScriptManager ID="ScriptManager1" runat="server" EnablePageMethods="true"></asp:ScriptManager>
    <div>
    <span onclick="doupload();">Try it</span> <span id="spFN"></span>
    <iframe id="uploadFrame" frameborder="0" height="400" width="800" scrolling="yes" src="Uploadee.aspx"></iframe>
    </div>
    </form>
</body>
</html> 
```

我正在尝试从 iframe 中的页面读取会话变量的值。这是iframe中页面后面的页面中的代码（uploadee.aspx）。

```
 public partial class Uploadee : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (IsPostBack)
        {
            for (int i = 0; i < 3; i++)
            {
                Session["FN"] = i.ToString();
                Thread.Sleep(1000);
            }
        }
    }
} 
```

所以，我在一个循环中将会话变量 - Session [“FN”] - 每次迭代增加1。

在包含 iframe 的页面后面的代码中，我有这个：

```
 #region Web Methods
[System.Web.Services.WebMethod]
[System.Web.Script.Services.ScriptMethod]
public static object GetUploadStatus()
{
    string fileNumber = HttpContext.Current.Session["FN"].ToString();
    return new
    {
        fileNumber = fileNumber
    };

}
#endregion 
```

所以，过程是：我点击包含页面上的“试用”跨度 - Uploader.aspx - 这会调用 javascript 函数 doupload()

这会在 iframe 中的页面上提交表单。当此表单提交时，将运行增加 Session["FN"] 变量值的循环。同时，PageMethods.GetUploadStatus 应该每 500 毫秒查询一次 Session["FN"] 的值。

但是，PageMethods.GetUploadStatus 中唯一一次显示警报是在循环的所有迭代之后。它可以检索 Session["FN"] 的值 - 但只有一次且仅在 iframe 中的页面完成处理之后。

我一直在阅读，我应该能够做我想做的事情......非常感谢任何帮助。这让我发疯了。为帖子的长度道歉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:07:47.713

asp.net 会话状态以特殊方式处理对同一会话的并发请求：

> 如果对同一会话发出两个并发请求（通过使用相同的 SessionID 值），则第一个请求获得对会话信息的独占访问权。第二个请求仅在第一个请求完成后执行。

以上来自[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms178581.aspx)。

您可以创建自己的[SessionStateProvider](http://msdn.microsoft.com/en-us/library/ms178587.aspx)以不同的方式处理并发。

# c++ - 在 C++ 中读取键盘输入的最合适方法

> ID：15277063
> 
> 赞同：-1
> 
> 时间：2013-03-07T16:53:57.157
> 
> 标签：c++, keyboard, device

我正在尝试编写一个可以读取键盘按钮的键盘类。我看过这个链接 - [http://www.daniweb.com/software-development/cpp/code/216732/reading-scan-codes-from-the-keyboard](http://www.daniweb.com/software-development/cpp/code/216732/reading-scan-codes-from-the-keyboard)但正如那里所说，它不是很准确所有计算机（我不知道这是不是真的）。因此，我的问题是实现键盘类的最佳方法是什么？这将用于 Windows

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T21:20:31.053

读取键盘输入的三种方法：

1.  通过从您的链接中描述的控制台窗口读取输入。对于初学者来说，确实很难让它正常工作，因为它读取的是 ANSI 字符而不是 Unicode 字符，但还有其他问题。控制台输入/输出有点晦涩，它的文档也是如此
2.  通过处理与普通窗口关联的 UI 事件。在这种情况下，您将在窗口过程中处理 WM_KEYDOWN 消息
3.  通过使用 SetWindowsHookEx 等函数深入了解 Win32 API。在这种情况下，您甚至不需要窗口（普通或控制台），您可以读取在任何应用程序或桌面中按下的击键

在不知道您打算如何使用此 Keyboard 类的情况下，很难建议使用哪一个。

# android - 如果我的应用程序在 API 8 模拟器上运行，互联网连接将无法正常工作

> ID：15277064
> 
> 赞同：4
> 
> 时间：2013-03-07T16:54:02.217
> 
> 标签：android, api, compatibility

您好，感谢您的帮助，我有一个在 Eclipse 中针对 API 17 编译的应用程序。

该应用程序执行一些简单的互联网连接。

现在，当我使用 API 17 在模拟器上进行测试时，一切正常。

如果我针对具有 API 8 的模拟器对其进行测试，则应用程序显然无法执行网络连接（adMob 不显示，HttpGet 显然没有检索任何内容......）形成我的应用程序（模拟器上的网络浏览器工作正常并正常加载）。

* * *

并且 adMob 也不会在具有 API 8 或 10 的模拟器上加载（它会在 API 17 模拟器上加载）。

* * *

非常感谢任何帮助！

这是我的主要活动：

```
public class QuotesActivity extends Activity implements MyInterface {

private String url2;

public static ArrayList<Stock> lt;
public static ArrayList<Stock> favQ;

public MyAdapter myAdap;

public Intent intent;
public ListView lv;
public FavManager fm;
private AdView adView;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.search);
    AdRequest request = new AdRequest();

    // request.addTestDevice(AdRequest.TEST_EMULATOR);
    request.setGender(AdRequest.Gender.MALE);
    boolean tabletSize = getResources().getBoolean(R.bool.isTablet);
    if (tabletSize) {
        // Create the adView
        adView = new AdView(this, AdSize.SMART_BANNER, "a151388079e47d1");
    } else {
        // Create the adView
        adView = new AdView(this, AdSize.BANNER, "a151388079e47d1");
    }

    // Lookup your LinearLayout assuming it's been given
    // the attribute android:id="@+id/mainLayout"
    LinearLayout layout = (LinearLayout) findViewById(R.id.ad);

    // Add the adView to it
    layout.addView(adView);

    // Initiate a generic request to load it with an ad
    adView.loadAd(request);

    lt = new ArrayList<Stock>();
    favQ = new ArrayList<Stock>();
    fm = new FavManager(getApplicationContext());
    favQ.clear();
    favQ.addAll(fm.ritiraFav());
    PreferenceManager.setDefaultValues(this, R.xml.preferences, false);
    lt.clear();
    // ////////////
    try {
        InputStream in = getResources().openRawResource(R.raw.markets3);

        if (in != null) {
            InputStreamReader tmp = new InputStreamReader(in);
            BufferedReader reader = new BufferedReader(tmp);
            String str;
            String str1 = null;
            String str2 = null;
            boolean flag = true;
            while ((str = reader.readLine()) != null) {
                if (flag) {
                    str1 = str;
                    flag = false;
                } else {
                    str2 = str;
                    lt.add(new Stock(str1, str2, "0", "0"));
                    flag = true;
                }
            }
            in.close();
        }
    }

    catch (Throwable t) {
        // Log.e("", "Exception: " + t.toString());
    }
    // ///////
    Collections.sort(lt, new Comparator<Stock>() {
        public int compare(Stock s1, Stock s2) {
            return s1.nome.compareToIgnoreCase(s2.nome);
        }
    });
    lv = (ListView) findViewById(android.R.id.list);
    lv.setScrollbarFadingEnabled(false);
    Button favourites = (Button) findViewById(R.id.favoritesbtn);
    favourites.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            Intent intent = new Intent(QuotesActivity.this,
                    QuotesActivityFavourites.class);
            startActivity(intent);

        }
    });

    Button search = (Button) findViewById(R.id.googsearch);
    search.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // Log.e("", "Chiamo onSearchRequested()");
            onSearchRequested();

        }
    });

    myAdap = new MyAdapter(lt, this, this);
    myAdap.l = lt;
    lv.setAdapter(myAdap);

    Button preference = (Button) findViewById(R.id.preferencebutton);
    preference.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            Intent intent = new Intent(QuotesActivity.this,
                    SettingsActivity.class);
            startActivity(intent);

        }
    });

    lv.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> parent, View view,
                final int position, long id) {
            for (Stock item : favQ) {
                if (item.simbolo.equals(lt.get(position).simbolo)) {
                    AlertDialog.Builder builder = new AlertDialog.Builder(
                            QuotesActivity.this);
                    builder.setPositiveButton("Yes", new OnClickListener() {
                        public void onClick(DialogInterface arg0, int arg1) {
                            deleteFromFavorites(lt.get(position));
                        }
                    });
                    builder.setNegativeButton("No", new OnClickListener() {
                        public void onClick(DialogInterface arg0, int arg1) {
                            // Quotes.layoutSchermo(2);
                        }
                    });
                    builder.setMessage("Stock Already in Portfolio. Delete from it?");
                    builder.setTitle(lt.get(position).nome);

                    AlertDialog dialog = builder.create();
                    builder.show();
                    return;
                }

            }

            AlertDialog.Builder builder = new AlertDialog.Builder(
                    QuotesActivity.this);
            final int pos = position;

            builder.setPositiveButton("Yes", new OnClickListener() {
                public void onClick(DialogInterface arg0, int arg1) {
                    addToFavorites(lt.get(pos));
                }
            });
            builder.setNegativeButton("No", new OnClickListener() {
                public void onClick(DialogInterface arg0, int arg1) {
                    // Quotes.layoutSchermo(2);
                }
            });
            builder.setMessage("Add to Portfolio?");
            builder.setTitle(lt.get(position).nome);
            AlertDialog dialog = builder.create();
            builder.show();
            // dialog.show();
        }
    });

}

@Override
public void onResume() {
    super.onResume();
    RelativeLayout focuslayout = (RelativeLayout) findViewById(R.id.RequestFocusLayout);
    focuslayout.requestFocus();
    favQ.clear();
    favQ.addAll(fm.ritiraFav());
}

public void addToFavorites(final Stock toadd) {

    fm.addFav(toadd);
    favQ.clear();
    favQ.addAll(fm.ritiraFav());
    return;
}

public void deleteFromFavorites(Stock todel) {
    fm.removeFav(todel);
    favQ.clear();
    favQ.addAll(fm.ritiraFav());
    return;
}

public void UpdateLine(Integer position) {
    UpdateTask up = new UpdateTask();
    up.execute(position, null, null);
}

public class UpdateTask extends AsyncTask<Integer, Void, Void> {

    @Override
    protected void onProgressUpdate(Void... progress) {
    }

    @Override
    protected void onPostExecute(Void result) {
        myAdap.l = lt;
        myAdap.notifyDataSetChanged();
    }

    @Override
    protected Void doInBackground(Integer... position) {
        DefaultHttpClient client = new DefaultHttpClient();
        String srt = "";
        // ///////////API SEGRETO DI GOOGLE ORIGINARIO
        // String url
        // =getString(R.string.dettaglio1).concat("'"+fav.get(i).simbolo+"'").concat(getString(R.string.dettaglio2));
        // ///////////API ALTERNATIVO
        String url = getString(R.string.urlaternativo).concat(
                lt.get(position[0]).simbolo);

        HttpGet getMethod = new HttpGet(url);
        try {
            ResponseHandler<String> responseHandler = new BasicResponseHandler();
            srt = client.execute(getMethod, responseHandler);
            int inizio = srt.indexOf("<last data=\"");
            int fine = srt.indexOf("\"/>", inizio + 12);
            lt.get(position[0]).setPrezzo(srt.substring(inizio + 12, fine));

            inizio = srt.indexOf("<perc_change data=\"");
            fine = srt.indexOf("\"/>", inizio + 19);
            lt.get(position[0]).setCambiamento(
                    srt.substring(inizio + 19, fine));

        } catch (Throwable t) {
            // Log.e("ERRORE INTERNET", "ERRORE INTERNET", t);
        }

        return null;
    }
}

@Override
public void onDestroy() {
    if (adView != null) {
        adView.destroy();
    }
    super.onDestroy();
}
} 
```

这是我的清单：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.quotes" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

<application android:debuggable="true" >
    <activity
        android:name=".QuotesActivity"
        android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize"
        android:icon="@drawable/ic_launcher"
        android:label="Markets in your pocket !" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>

        <meta-data
            android:name="android.app.default_searchable"
            android:value=".QuotesActivitySearch" />
    </activity>
    <activity
        android:name=".QuotesActivitySearch"
        android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize"
        android:icon="@drawable/ic_launcher"
        android:label="Markets in your pocket !" >
        <intent-filter>
            <action android:name="android.intent.action.SEARCH" />
        </intent-filter>

        <meta-data
            android:name="android.app.searchable"
            android:resource="@xml/searchable" />
    </activity>
    <activity
        android:name=".QuotesActivityFavourites"
        android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize"
        android:icon="@drawable/ic_launcher"
        android:label="Markets in your pocket !" >
    </activity>
    <activity
        android:name=".SettingsActivity"
        android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize"
        android:label="Settings" >
    </activity>
    <activity
        android:name="com.google.ads.AdActivity"
        android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize" />
</application> 
```

这是我的 LogCat：

```
03-15 14:16:05.554: D/dalvikvm(1466): GC_EXPLICIT freed 909K, 43% free 4716K/8135K,    external 1170K/1682K, paused 7ms
03-15 14:16:07.185: E/ActivityThread(1466): Failed to find provider info for    com.google.plus.platform
03-15 14:16:07.185: D/szipinf(1466): Initializing inflate state
03-15 14:16:07.185: D/szipinf(1466): Initializing zlib to inflate
03-15 14:16:07.214: I/Ads(1466): To get test ads on this device, call    adRequest.addTestDevice("6EA1DCF3A944D7B947BC304C7A9E933D");
03-15 14:16:07.268: D/dalvikvm(1466): GC_CONCURRENT freed 395K, 36% free 5315K/8263K,    external 1121K/1603K, paused 1ms+0ms
03-15 14:16:07.290: I/Ads(1466): adRequestUrlHtml: <html><head><script     src="http://media.admob.com/sdk-core-v40.js"></script>   <script>AFMA_getSdkConstants();AFMA_buildAdURL({"preqs":3,"session_id":"1145804483122245265 2","seq_num":"4","slotname":"a151388079e47d1","u_w":320,"msid":"com.marketsinyourpocket","cap":"m,a","js":"afma-sdk-a-    v6.3.0","bas_off":0,"net":"ed","app_name":"1.android.com.marketsinyourpocket","hl":"en","gnt":3,"cust_gender":1,"carrier":"310260","u_audio":1,"u_sd":1.5,"ms":"Qqlgt9Kwv7BZOnio6PfLHi5mVs5ayp77VGIIyJ3Y7sojTNwIZfi0LHn2PZquoJTqpJx8NtOvTzGKWYlbxvU8fOjXkArCoqoQnGrLKZ57CTZOOt2WWrL9k8pyN4P-nBwIvuZDvijR0reHDyhcqwAoMtPdOeUV_cwIe3jk-6BMm_IgvGs8EKWVZESeqrSuExAStQMMsUYcC6p-XkB8KegxEX4FS2Q2CibdMk3CMKoAzfF58Sxp6DvRObm662IVwImzFWGdQ22UVx4ViQqz_ensdg1bXk5jgpyBOpV0jMFHgoEv5SwD5zpoeJfo-a1f0d5GR35f2bDAb3iXucuGB723lA","isu":"6EA1DCF3A944D7B947BC304C7A9E933D","format":"320x50_mb","oar":0,"ad_pos":{"height":0,"visible":0,"y":0,"x":0,"width":0},"u_h":533,"pt":1,"bas_on":0,"ptime":143736});</script></head><body></body></html>
03-15 14:16:07.358: W/webcore(1466): Can't get the viewWidth after the first layout
03-15 14:16:07.448: D/dalvikvm(1466): GC_CONCURRENT freed 338K, 33% free 6141K/9031K,  external 1121K/1603K, paused 1ms+0ms
03-15 14:16:13.494: V/URL I USE(1466): http://www.google.com/ig/api?stock=SHY
03-15 14:16:33.614: E/EXCEPTION I GET(1466): java.net.UnknownHostException: www.google.com 
```

编辑 编辑 编辑 编辑

甚至在 API 10 Intel 加速仿真器上进行了尝试，但没有更好的运气 ![请参阅模拟器配置](../Images/f781ca80a71858c3e360ecbcf80f756b.png)

代理设置正确，

启用数据传输

……我有点绝望！

编辑 编辑 编辑

发布了整个活动

**编辑 编辑 编辑**

**该应用程序可以在具有 API 10 的真实电话上正常工作（而不是在我的具有 API 10 的模拟器上）！！！**

**我发现的错误是**

```
03-15 13:14:43.299: E/Exception(1318): java.net.UnknownHostException: www.google.com 
```

确实我使用了 Google REST 服务

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T23:53:49.967

我很确定这是代理设置问题。尝试显式设置代理（从 Android 系统获取值）。

在默认的 HttpClient 上，这将是：

```
HttpClient client = new DefaultHttpClient();

//Get the default settings from APN
  String proxyHost = android.net.Proxy.getDefaultHost();
  int proxyPort = android.net.Proxy.getDefaultPort();
//Set Proxy params of client, if they are not the standard
    if (proxyHost != null && proxyPort > 0) {
        HttpHost proxy = new HttpHost(proxyHost, proxyPort);
        client.getParams().setParameter(ConnRoutePNames.DEFAULT_PROXY, proxy);
    }
HttpGet request = new HttpGet("http://www.google.com"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T08:46:04.810

也许模拟器中的互联网已关闭？顶部应该有一个3G小图标，尝试按F8，它会打开和关闭它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T20:55:56.053

猜测：

*   “代理设置正确”尝试不设置任何代理。
*   尝试使用另一个 cpu 而不是 intel atom

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-15T06:28:44.153

由于网络访问适用于 AVD 的浏览器，因此我将关注问题的其他潜在来源。

如果我是你，我会简单地尝试针对 API 8 进行编译。当你这样做时，你将被指向你在代码中使用的任何方法和其他构造，这些方法和其他构造不适用于 API 8。（你没有提供所有代码，例如 MyAdapter 中可能隐藏了一些东西。此外，您还没有提到您的`catch`日志消息是否出现在 LogCat 中。）

另一个可能值得关注的方面是您没有正确使用 AsyncTask，并且它在不同的 API 版本上的行为会有所不同。

根据 API 版本，当您没有明确选择 Executor 时，您的 AsyncTask 将按顺序或并行运行，从而导致许多或很少的 http 连接，并导致对数据结构的并发操作。

您只能在主/UI 线程上操作您的适配器。否则，例如当用户滚动您的列表时，UI 将调用您的适配器的 getView()，这可能会被您的 AsyncTask 中断，修改当前由 getView() 处理的条目，从而导致不一致和/或崩溃。

您已尝试通过`lt`异步操作和调用`myAdap.l = lt`UI 线程来实现此目的。

这是个好主意，但它有两个问题。首先，在 API 8 上，许多 AsyncTask 可以并行运行，而在 API 17 上只能是一个。[报价](http://developer.android.com/reference/android/os/AsyncTask.html)：

> 从 DONUT 开始，这被更改为允许多个任务并行运行的线程池。从 HONEYCOMB 开始，任务在单个线程上执行，以避免并行执行导致的常见应用程序错误。

因此，在某些版本的 Android 上，您会遇到一个竞争条件，在该条件下，副本`lt`将被并行操作，从而导致分配时数据丢失。*如果*这些是实际的*副本*，那就是——它们不是。通过`lt`在它已被分配为适配器的底层数据结构时进行异步操作，您打破了不异步操作 UI 对象的规则。

因此，您需要将获取的数据从`doInBackground`to传递`onPostExecute`并在那里更新 Adapter 的数据结构。

我提到的两点可能不是问题的最终原因，但它们很可能会导致观察到的行为，无论如何都需要解决，并且可以更容易地识别任何其他潜在的根本原因。

希望这可以帮助。

**更新**您也可能以错误的方式使用 HttpClient。例如，请参见[此处](https://stackoverflow.com/questions/5377941/unknownhostexception-with-apache-httpclient)。也许并非所有 API 级别都（正确）支持所有组合（过去有几个错误）。您可能还想阅读[Android 的 HTTP 客户端](http://android-developers.blogspot.de/2011/09/androids-http-clients.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-15T11:15:27.723

如果你是在eclipse中开发，可以试试

窗口>首选项>Android>启动

默认模拟器选项：-dns-server 8.8.8.8,8.8.4.4

编辑：

转到：运行->运行配置-> android应用程序

然后选择您的项目 -> 目标，向下滚动选项页面并将 -dns-server 8.8.8.8,8.8.4.4 粘贴到 Additional Emulator Command Line Options

# c# - 为 TextBox 或代码解决方法寻找 DisplayMemberPath 的替代方法

> ID：15277066
> 
> 赞同：1
> 
> 时间：2013-03-07T16:54:13.290
> 
> 标签：c#, wpf, mvvm, textbox, custom-controls

查看来自的继承层次结构`TextBox`，我发现它`TextBox`没有`DisplayMemberPath`属性。这是有道理的，因为它没有`ItemsSource`要绑定到的 Items，因此没有`DisplayMemberPath`. 但是，我需要 a `DisplayMemberPath`for a`TextBox`或可编辑的东西，我正在根据下面的情况寻找选项。

我正在使用的类/视图/视图模型：

**`Test.cs`**- 代码优先实体

```
public class Test : BaseModel
{
    public int Id { get; set; }
    public int GasProfileId { get; set; }
} 
```

**`GasProfile.cs`**- 代码优先实体

```
public class GasProfile : BaseModel
{

    public int Id { get; set; }
    public double H2O { get; set; }
    public double CO2 { get; set; }

    private ObservableCollection<Test> _tests;
    public virtual ObservableCollection<Test> Tests
    {
        get { return _tests; }
        set
        {

            if (_tests != value)
            {
                _tests = value;
                Notify("Tests");
            }
        }
    }
} 
```

**`TestGasView.xaml`**- 查看（用户控制）

这就是 TestGasView.xaml**现在的样子**：

```
<Grid>
    <ListBox ItemsSource="{Binding SelectedTechnician.Test}"
             DisplayMemberPath="TestName">
             selectedItem="SelectedTest"
    </ListBox>

    <Label Content="H20"/>
    <TextBox></TextBox>
    <Label Content="CO2"/>
    <TextBox></TextBox>
</Grid> 
```

这就是**我希望**它看起来/表现的样子（警告：损坏的代码/伪代码）：

```
<Grid>
    <ListBox ItemsSource="{Binding SelectedTechnician.Test}"
             DisplayMemberPath="TestName"
             SelectedItem="SelectedTest">
    </ListBox>

    <Label Content="H20"/>
    <TextBox Text="{Binding SelectedTest.GasProfile}"
             DiaplayMemberPath="H20"></TextBox>
    <Label Content="CO2"/>
    <TextBox Text="{Binding SelectedTest.GasProfile}"
             DiaplayMemberPath="CO2"></TextBox>
</Grid> 
```

**`TestGasViewModel.cs`**- 视图模型

具有获取/设置 SelectedTest 的属性。

如您所见，我想要在`TextBox`es 上的数据绑定是错误的，就像 的位置一样`DisplayMemberPath`，但这表明我非常希望显示的值是 1) 可编辑 2) 通过单击测试和绑定到 SelectedTest 具有键的 GasProfile 上的“gas 属性”。

所以我的问题是，“是否有一些我缺少的属性`TextBox`可以让我将`Text`属性绑定到 GasProfile 并获取我想要显示的气体的值？” 如果没有，也许有一些方法可以创建一个代理类，可以像这样绑定：

```
<Grid>
    <ListBox ItemsSource="{Binding SelectedTechnician.Test}"
             DisplayMemberPath="TestName"
             SelectedItem="SelectedTest">
    </ListBox>

    <Label Content="H20"/>
    <TextBox Text="{Binding SelectedTestGasProfile.H20}"></TextBox>
    <Label Content="CO2"/>
    <TextBox Text="{Binding SelectedTestGasProfile.CO2}"></TextBox>
</Grid> 
```

如果它不是“哦，请将此属性用于`TextBox`”，那么我正在寻找代码建议以实现上述目标。

谢谢

**编辑**

这是一个屏幕截图，显示我确实有一个选定的测试，并且 FieldGasProfileID（我的意思是 GasProfile）确实有一个值：

![选择测试](../Images/9d23f096d88b9d72e0c4971bf3f84c3d.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:45:07.827

```
<TextBox Text="{Binding SelectedTest.GasProfile.H20}"</TextBox>
<Label Content="CO2"/>
<TextBox Text="{Binding SelectedTest.GasProfile.CO2}"</TextBox> 
```

我希望这将有所帮助。

# excel - 在某个点之后查找文本的最佳方法是什么

> ID：15277068
> 
> 赞同：3
> 
> 时间：2013-03-07T16:54:17.487
> 
> 标签：excel, excel-formula

在名为“资产名称”的 Excel 列中，我的值如下

```
LDNWSW-LXP17KZ
ADFHGW-WXP17KZ
ASDWSW-DXP17KZ 
```

我需要一个公式来获取另一列中每个值的连字符右侧的第一个字符。连字符可以出现在**任何**位置（除了第一个）。

任何指针？提前致谢

我试过公式`=RIGHT([AssetName],LEN([AssetName])-SEARCH("-",[AssetName]))`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T08:26:04.500

假设输入，您`AssetName`在表中有数据列，所以这个公式：

```
=MID([AssetName],FIND("-",[AssetName])+1,1) 
```

应该为你做这项工作。在表格的任何列中键入它并更好地将其存储为`Calculated Column`- 如果您在表格列中输入公式，Excel 会建议您这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:12:18.967

```
=LEFT(RIGHT(D6,FIND("-",D6)),1) 
```

数据在 D6 中的位置

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:06:26.527

你可以使用这样的东西；

```
=MID(A1,FIND("-",A1,1)+1,1) 
```

该`FIND`函数返回“-”在其中的位置，`A1`并且该`MID`函数从指定的起始位置返回字符，在本例中为连字符。

# python - 从字典列表中获取键和值

> ID：15277070
> 
> 赞同：-1
> 
> 时间：2013-03-07T16:54:22.633
> 
> 标签：python, list, dictionary, key

我有一个包含许多字典的列表，我需要获取每个字典的键和值：

```
[{'keys1.1' = 'value1.1','key1.2'='values1.2'},{'keys2.1'='value2.1'},{'key3.1'='value3.1'}] 
```

我怎样才能得到这些键和值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T16:56:34.963

您需要遍历 a 中的`dict`s `for-loop`：

```
list_of_dicts = [{'keys1.1' : 'value1.1',
                   'key1.2':'values1.2'},
                 {'keys2.1':'value2.1'},
                 {'key3.1':'value3.1'}]

for item in list_of_dicts:
  for key, value in item.iteritems()
    print key, value
    print "The key is {0} with a value of {1}".format(key, value)
#or
for item in list_of_dicts:
  for key in item.keys():
    print item[key]
    print "The key is {0} with a value of {1}".format(key, item[key]) 
```

# c# - 如何使用可观察的集合并更改通知属性

> ID：15277075
> 
> 赞同：0
> 
> 时间：2013-03-07T16:54:35.633
> 
> 标签：c#, wpf, xaml

我是 wpf 的新手，我目前正在尝试使用网格并将减法、删除元素添加到最终绑定到网格的 db 表中。

所以从网格中选择，更新可观察的集合，刷新。

我无法理解如何使用可观察集合的更改通知。

这是我的代码

绑定到网格的类

```
 public class students
{
   ObservableCollection<GetStudents_Result> stdb = new ObservableCollection<GetStudents_Result>();

   //public event NotifyCollectionChangedEventHandler CollectionChanged;

   public students()
   {

       AbcdEntities abcdEnt=new AbcdEntities();

       List<GetStudents_Result> studentColl = abcdEnt.GetStudents().ToList();
       foreach (var item in studentColl)
       {
           stdb.Add(item);
       }
   }

   //public  void onCollectionChange(object sender,NotifyCollectionChangedEventHandler e)
   //{

   //}

   public ObservableCollection<GetStudents_Result> std {get {return stdb;}}
} 
```

我的xml。

```
 <Canvas>
    <TextBox Height="23" Canvas.Top="5" Canvas.Left="10" HorizontalAlignment="Left" Margin="10,10,0,0" Name="textBox1" VerticalAlignment="Top" Width="120" />
    <TextBox Height="23" Canvas.Top="30" Canvas.Left="10" HorizontalAlignment="Left" Margin="10,10,0,0" Name="textBox2" VerticalAlignment="Top" Width="120" />
    <Button Canvas.Left="90" Canvas.Top="65" Content="Remove" Click="button2_Click" Height="23" Name="button2" Width="75" />
    <Button Canvas.Left="10" Canvas.Top="65" Content="Save" Height="23" Name="button1" Width="75" Click="button1_Click" />

    <ListView Name="listviewStudents" Canvas.Top="100" ItemsSource="{Binding std}" SelectionChanged="ListView_SelectionChanged">
        <ListView.View>
            <GridView>                     
                <GridViewColumn Header="fname" DisplayMemberBinding="{Binding Path=fname}"></GridViewColumn>
                <GridViewColumn Header="lname" DisplayMemberBinding="{Binding Path=lname}"></GridViewColumn>
                <GridViewColumn DisplayMemberBinding="{Binding Path=address}"></GridViewColumn>
                <GridViewColumn DisplayMemberBinding="{Binding Path=phno}"></GridViewColumn>
                <GridViewColumn DisplayMemberBinding="{Binding Path=radio}"></GridViewColumn>

            </GridView>

        </ListView.View>

    </ListView>

</Canvas> 
```

我的代码在后面

```
public MainWindow()
    {
        InitializeComponent();
        students std = new students();
        this.DataContext = std;
    }

    private void ListView_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {

        GetStudents_Result selectedItem = listviewStudents.SelectedItem as GetStudents_Result;
        textBox1.Text = selectedItem.fname;
        textBox2.Text = selectedItem.lname;

    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {
        GetStudents_Result selecteditem = listviewStudents.SelectedItem as GetStudents_Result;
        selecteditem.fname = textBox1.Text;
        selecteditem.lname = textBox2.Text;
        listviewStudents.Items.Refresh();
    }

    private void button2_Click(object sender, RoutedEventArgs e)
    {
        listviewStudents.Items.Remove(listviewStudents.SelectedItem);
        listviewStudents.Items.Refresh();
    }
} 
```

}

原谅任何愚蠢的错误..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T20:59:31.493

这里有一些问题，你不应该`UI`从后面的代码中触摸控件，你应该使用数据绑定。

这是基于您的帖子的模型绑定的工作示例。

```
public partial class MainWindow : Window, INotifyPropertyChanged
{
    public MainWindow()
    {
        InitializeComponent();

        // set the DataContext to the code in this window
        this.DataContext = this;

        // create youe Student model
        StudentModel = new students();
    }

    // Create a public property of your student Model
    private students _studentModel;
    public students StudentModel
    { 
        get { return _studentModel; }
        set { _studentModel = value; NotifyPropertyChanged("StudentModel"); }
    }

    // create a public property to use as the selected item from your models "std" collection
    private GetStudents_Result _selectedResult;
    public GetStudents_Result SelectedResult 
    {
        get { return _selectedResult; }
        set { _selectedResult = value; NotifyPropertyChanged("SelectedResult"); }
    }

    private void button2_Click(object sender, RoutedEventArgs e)
    {
        // if you want to remove an item you just have to remove it from
        // the model, the INotifyPropertyChanged interface will notify the UI
        // to update, no need to call Refresh, same works for Add etc
        StudentModel.std.Remove(SelectedResult);
    }

    public event PropertyChangedEventHandler PropertyChanged;
    public void NotifyPropertyChanged(string property)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(property));
        }
    }
} 
```

现在`xaml`我们可以将 绑定`ListView`到您的`StudentModel`收藏和`SelectedResult`

```
 <ListView ItemsSource="{Binding StudentModel.std}" SelectedItem="{Binding SelectedResult}" > 
```

而对于`TextBoxes`你可以绑定到`SelectedResult`所以它会为你更新详细信息

**注意：**在此示例中，它会在文本更改时更新 SelectedResult，您可以根据需要进行更改。

```
<TextBox Text="{Binding SelectedResult.Fname, UpdateSourceTrigger=PropertyChanged}" />
<TextBox Text="{Binding SelectedResult.Lname, UpdateSourceTrigger=PropertyChanged}" /> 
```

因此，现在当您从这些项目中选择一个项目时，`ListView`这些项目`TextBoxes`将被填充，并且当它们被更改时，`SelectedResult`项目将被更改。

现在，要在您`ListView`的`StudentModel`.

```
private void button2_Click(object sender, RoutedEventArgs e)
{
    StudentModel.std.Remove(SelectedResult);
} 
```

**注意：**这个事件处理程序应该是一个`ICommand`绑定，但我会让你搜索它:)

这是一个完整的示例，希望有助于解释`WPF MVVM`

代码：

```
public partial class MainWindow : Window, INotifyPropertyChanged
{
    public MainWindow()
    {
        InitializeComponent();
        this.DataContext = this;
        StudentModel = new students();
    }

    private students _studentModel;
    public students StudentModel
    { 
        get { return _studentModel; }
        set { _studentModel = value; NotifyPropertyChanged("StudentModel"); }
    }

    private GetStudents_Result _selectedResult;
    public GetStudents_Result SelectedResult 
    {
        get { return _selectedResult; }
        set { _selectedResult = value; NotifyPropertyChanged("SelectedResult"); }
    }

    private void button2_Click(object sender, RoutedEventArgs e)
    {
        StudentModel.std.Remove(SelectedResult);
    }

    public event PropertyChangedEventHandler PropertyChanged;
    public void NotifyPropertyChanged(string property)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(property));
        }
    }
}

public class students
{
    public students()
    {
        std = new ObservableCollection<GetStudents_Result>();
        for (int i = 0; i < 100; i++)
        {
            std.Add(new GetStudents_Result { Fname = "FirstName" + i, Lname = "LasrName" + i });
        }
    }
    public ObservableCollection<GetStudents_Result> std { get; set; }
}

public class GetStudents_Result : INotifyPropertyChanged
{
    private string _fname;
    private string _lname;

    public string Fname
    {
        get { return _fname; }
        set { _fname = value; NotifyPropertyChanged("Fname"); }
    }

    public string Lname
    {
        get { return _lname; }
        set { _lname = value; NotifyPropertyChanged("Lname"); }
    }

    public event PropertyChangedEventHandler PropertyChanged;
    public void NotifyPropertyChanged(string property)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(property));
        }
    }
} 
```

xml:

```
 <Canvas>
    <TextBox Text="{Binding SelectedResult.Fname, UpdateSourceTrigger=PropertyChanged}" />
    <TextBox Text="{Binding SelectedResult.Lname, UpdateSourceTrigger=PropertyChanged}" />
    <Button Canvas.Left="90" Canvas.Top="65" Content="Remove" Click="button2_Click" Height="23" Name="button2" Width="75" />
    <Button Canvas.Left="10" Canvas.Top="65" Content="Save" Height="23" Name="button1" Width="75"  />
    <ListView Name="listviewStudents" Canvas.Top="100" ItemsSource="{Binding StudentModel.std}" SelectedItem="{Binding SelectedResult}" >
        <ListView.View>
            <GridView>
                <GridViewColumn Header="fname" DisplayMemberBinding="{Binding Path=Fname}"></GridViewColumn>
                <GridViewColumn Header="lname" DisplayMemberBinding="{Binding Path=Lname}"></GridViewColumn>
            </GridView>
        </ListView.View>
    </ListView>
</Canvas> 
```

我希望这些信息有帮助:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T18:11:12.723

好的，首先，如果我回答这个问题做得不好，我深表歉意。这是我的第一次尝试。

所以看起来你的想法是正确的，你所拥有的大部分东西都会起作用。但看起来您可能忘记实施`INotifyPropertyChanged`. 而且您可能只是考虑使用类似的东西`List<GetStudent_Result>`，因为您将自己实现 NotifyPropertyChanged 东西，所以开销比 ObservableCollection 少得多。

```
public class students : INotifyPropertyChanged
{

    #region PropertyChanged EventHandler
    public event PropertyChangedEventHandler PropertyChanged;

    void NotifyPropertyChanged(String Property)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(Property));
    }
    #endregion

    private List<GetStudents_Result> stdb;
    public List<GetStudents_Result> std
    {
        get { return stdb; }
        set { stdb = value; NotifyPropertyChanged("std"); }
    }

    ... 
```

# javascript - 如何对选择列表中的选项进行排序但将其保留在顶部

> ID：15277076
> 
> 赞同：1
> 
> 时间：2013-03-07T16:54:38.103
> 
> 标签：javascript, jquery, html, sorting, select

现在我有以下代码通过我的列表并按字母顺序排序：

```
<select id="country" class="inputList" name="country">
    <option value="">Select your country</option>
    <option value='0'>Afghanistan</option>
    <option value='1'>Albania</option>
    <option value='2'>Algeria</option>
    <option value='3'>Andorra</option>
    ...
</select> 
```

如何使脚本排除没有价值的选项（第一个“选择您的国家”）？

```
$("#country").html($("#country option").sort(function (a, b) {
return a.text == b.text ? 0 : a.text < b.text ? -1 : 1
})) 
```

非常感谢！

编辑：Offbeatmammal 指出的解决方案在这里： [在没有第一项的下拉列表中对项目进行排序](https://stackoverflow.com/questions/2048762/sort-items-in-a-dropdown-list-without-the-first-item?rq=1)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:45:43.197

[将评论变成答案，因为它解决了问题]

我可能会作弊...剥去最上面的，做排序然后放回去...事实上，这个答案 -[在没有第一个项目的下拉列表中排序项目](https://stackoverflow.com/questions/2048762/sort-items-in-a-dropdown-list-without-the-first-item?rq=1)- 就是这样做的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T16:56:54.040

我通常将该项目从列表中拉出，对其余的进行排序，然后重新插入。

# clearcase - 由于在目标视图中不可见，Clearcase 是否可以找到合并它报告为已被跳过的元素？

> ID：15277077
> 
> 赞同：1
> 
> 时间：2013-03-07T16:54:38.287
> 
> 标签：clearcase

我正在软件发布流之间执行大型（即许多更改集，每个更改集许多元素）传播。有时，Clearcase findmerge 报告

> cleartool：警告：某些更改集元素被跳过，因为它们在目标视图中不可见。

我已经阅读了这个警告的根本原因并理解了它。 **我正在寻找的是一种让 Clearcase 报告跳过元素名称的方法。** 当一个元素被跳过时，我需要手动挖掘问题以查看是否需要进一步的工作。但是，我目前无法确定需要检查哪些元素，因为 Clearcase 没有命名它们。

正如我在一开始提到的那样，我正在处理大型传播，因此尝试手动查找跳过的元素的工作量非常大，如果 Clearcase/findmerge 可以命名它警告的元素，则没有必要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:09:56.600

`findmerge`意味着非UCM合并，对吗？（虽然你也可以`findmerge`用来合并 UCM 流之间的变更集......）

在我看到的每一次合并中，获得这种信息的唯一方法（这意味着最初打算合并的文件往往在源分支中被 rmname'd，如“[关于处理不可见](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.hlp.doc/cc_main/about_elements_not_visible.htm)“）是通过解析findmerge（或UCM的或）`cleartool deliver`的日志`rebase`

简而言之，在合并*结束时会提到该警告，但在合并**期间*可能会列出跳过的实际文件（grep on ' `skipped`'）。

# asp.net - ASP.NET 剃须刀 Html.TextArea

> ID：15277078
> 
> 赞同：12
> 
> 时间：2013-03-07T16:54:47.053
> 
> 标签：asp.net, textarea, html-helper

1）在使用该行编辑视图时：

```
 @Html.TextArea(name: "Message", rows: 10, columns: 40) 
```

我在编译时收到此错误：

```
ERR: "The best overload for 'TextArea' does not have a parameter of type 'rows'" 
```

即使有以行和列作为参数的签名。

2) 所以我尝试使用签名：@Html.TextArea(string name, object htmlAttributes)

调用函数如下

```
 @Html.TextArea(name: "Message", new { rows=10, columns=40 } 
```

但我收到另一个错误：

```
ERR: "Named Argument Specifications must appear after all fixed arguments have been specified" 
```

任何人都知道为什么以及如何解决它们？

先感谢您！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-07T17:00:00.493

只需将代码更改为：

```
@Html.TextArea("Message", new { rows=10, columns=40 }) 
```

没有命名参数

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-07T17:00:44.250

您是否尝试过从名称参数中删除名称标签？

```
@Html.TextArea("Message", new { rows = 10, cols = 40}) 
```

`textarea`此外，a上的列的 HTML 属性`cols`不是`columns`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-07T17:00:11.413

我相信您需要将其添加为像这样的属性...

```
@Html.TextArea("Message", new { rows=10, columns=40 }) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-03-11T16:05:19.780

为什么不只是：

```
@Html.TextAreaFor(model => model.Body, new { cols = 35, @rows = 3 }) 
```

# java - 你能在 Mule ESB 中写一个“if”语句吗？

> ID：15277084
> 
> 赞同：4
> 
> 时间：2013-03-07T16:54:51.857
> 
> 标签：java, mule, esb

我有一个我构建的抽象消息处理器，我想将其封装在布尔评估中，以便在某些条件下将其关闭。我正在寻找这样的东西：

```
<flow name="myFlow">
    <if expression="${myFlag} == true">
        <mynamespace:myCustomMessageProcessor .../>
    </if>
</flow> 
```

这在 Mule ESB 中可行吗？有我可以回顾的例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T20:55:19.623

这是一种标准的基于内容的路由模式，存在于所有**ESB**产品中。

在**Mule**中，您想使用**选择路由器**- 参见例如[Mule School：使用流控制 - 选择路由器](http://blogs.mulesoft.org/mule-school-using-flow-controls-choice-router/)教程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-25T17:36:22.880

如果要使用 IF 条件从属性文件中读取值，可以执行以下操作：-

```
<scripting:component doc:name="Groovy" doc:description="This component is used to check the value from properties file" >
  <scripting:script engine="Groovy">
     // use your if else code here like  
     if(${myFlag} == true)
         {      
         return message.payload
         }
   </scripting:script>
 </scripting:component> 
```

让我知道它是否有效....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-17T01:27:23.433

Mule Choice Router 是使用 if else 或 if elseif 实现的最佳选择。即使您使用表达式来实现相同的目的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-23T15:32:21.000

Mule 允许使用`<choice>`路由器进行条件检查。您可以为后备决策定义不同`<when>`的一个`<othterwise>`条件。

```
<choice doc:name="Choice condition">
  <when expression="#[flowVars.myVar = 'on']">
    <logger level="INFO" message="Case: myVar is on" />
  </when>
  <when expression="#[flowVars.myVar = 'off']">
    <logger level="INFO" message="Case: myVar is off" />
  </when>
  <otherwise>
    <logger level="INFO" message="Case: otherwise the default route is used" />
  </otherwise>
</choice> 
```

# asp.net-mvc - 带有 MVC 的 WebAPI - 我应该使用 PUT 更新对象的布尔值吗？

> ID：15277087
> 
> 赞同：1
> 
> 时间：2013-03-07T16:54:56.457
> 
> 标签：asp.net-mvc, asp.net-mvc-3, web-applications, asp.net-web-api

我有一个像“setAsViewed”这样的方法，它需要一个 Id 并只是翻转一个布尔值，但我不确定这里的四个选项中哪一个最好。我的想法是我想发送尽可能少的数据，所以 {id} 选项之一是最好的。而且由于 PUT 通常对应于更新，所以我倾向于第一个。这里有什么约定？

**翻转给定对象的布尔字段的选项（我能想到的）：**

```
1\. PUT /api/objects/setasviewed/1
2\. PUT /api/object/setasviewed
3\. POST /api/objects/setasviewed/1
4\. POST /api/object/setasviewed 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-07T17:04:36.990

REST 快速指南：

> **GET /api/objects** : 列出对象
> 
> **GET /api/objects/1**：获取 id == 1 的对象
> 
> **POST /api/objects**：使用发布的数据创建一个新对象（完整模型）
> 
> **PUT /api/objects/1**：使用已发布的数据更新 id == 1 的对象（完整模型）
> 
> **PATCH /api/objects/1**：使用部分数据（部分模型）更新 id == 1 的对象
> 
> **POST /api/objects/1/someprocedure**：在 id == 1 的对象上运行一些过程

所以在你的场景中，它应该是：

```
POST /api/objects/1/setasviewed 
```

也许：

```
PATCH /api/objects/1 
```

使用发布的数据：

```
{ "viewed" : true } 
```

# sql - 为什么 Sqlite 不使用这个 ORDER BY 的索引？

> ID：15277089
> 
> 赞同：0
> 
> 时间：2013-03-07T16:55:12.827
> 
> 标签：sql, sqlite, optimization, database-indexes

我有这个查询：

```
SELECT * FROM Events e 
  INNER JOIN Telemetry ss ON ss.Id = e.TelemetryId 
  INNER JOIN Services s ON s.Id = ss.ServiceId 
  WHERE s.AssetId = @AssetId AND e.TimestampTicks >= @StartTime 
  ORDER BY e.TimestampTicks LIMIT 1000 
```

我有这个索引：

```
CREATE INDEX [IX_Events_TelemetryId_TimestampTicks] ON [Events] ([TelemetryId],[TimestampTicks]) 
```

但是，索引不用于 ORDER BY 子句。我得到这个查询解释：

```
0|0|2|SCAN TABLE Services AS s (~44 rows)
0|1|1|SEARCH TABLE Telemetry AS ss USING AUTOMATIC COVERING INDEX (ServiceId=?) (~5 rows)
0|2|0|SEARCH TABLE Events AS e USING INDEX IX_Events_TelemetryId_TimestampTicks (TelemetryId=? AND TimestampTicks>?) (~1816 rows)
0|0|0|USE TEMP B-TREE FOR ORDER BY 
```

为什么是 B-TREE？如果我反转索引，我实际上会得到更差的性能。这是查询计划：

```
0|0|0|SEARCH TABLE Events AS e USING INDEX IX_Events_TimestampTicks_TelemetryId (TimestampTicks>?) (~4031303 rows)
0|1|1|SEARCH TABLE Telemetry AS ss USING INTEGER PRIMARY KEY (rowid=?) (~1 rows)
0|2|2|SEARCH TABLE Services AS s USING INTEGER PRIMARY KEY (rowid=?) (~1 rows) 
```

我不知道为什么该排序不允许使用 TelemetryId。我真的需要这个查询更快。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T18:27:47.673

*   指定的索引在 ([TelemetryId],[TimestampTicks]) 上，而不是 ([TimestampTicks])，并且 [TelemetryId] 上没有过滤条件。
*   如果测试数据库没有完整的工作数据卷，则测试中的执行计划可能无法反映生产中的执行计划。
*   在选择使用索引之前，数据库引擎会尝试对索引使用是否比表扫描更有效进行建模。如果预期数据量 > ~10% 的表，通常可能会忽略看起来有用的索引。（虽然在这种情况下不太可能。）
*   追查想象中的性能问题是浪费时间。在这种情况下是否存在真正的性能问题？

# mongodb - 带有标签和排序的搜索系统的提示（关于数据库设计的问题、性能问题......）

> ID：15277094
> 
> 赞同：0
> 
> 时间：2013-03-07T16:55:20.043
> 
> 标签：mongodb, search, database-design

我正在开发一个围绕在 Java/Scala 中共享文本的网站，使用 Play Framework 2 和 MongoDB 进行存储。我目前正在开发搜索页面。当然会有经典的文本字段搜索，但也有两种类型的过滤器：

*   标签
*   最高评价/每年/每月/每周观看次数最多

例如，有可能在带有“幻想”标签的文本中获得本周的 xxx 个最佳文本。如果你不明白我的意思，想想 Pornhub。;)

我知道如何进行查询，但我担心性能问题。我是一个关于性能和查询优化的真正菜鸟，也是一个 MongoDB 初学者，所以我害怕会在数以万计的文本中寻找、排序和排名的大查询的影响。自然，我想到了一个缓存系统，但我不知道如何实现它，因为每个查询可能不同。我还想到了每天午夜（例如）与工作更新的临时集合，但同样有太多不同的组合。

那么我可以用来建模的技术和“技巧”是什么？你有什么想法吗？是否有为此设计的搜索框架？还是我太担心了，而 MongoDB 可以很好地处理这种排序和排名？

我希望清楚。非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:35:07.273

一些注意事项：

1.  MongoDB 即将推出全文搜索。(v2.4)
2.  您始终可以在将数据写入 Mongo 的同时将数据发送到 Elastic Search 或 Solr。然后您可以使用 Elastic 或 Solr 进行搜索。
3.  您绝对可以在 Mongo 中标记文本文档，然后对它们进行索引和搜索。例如：

```
{ "_id" : 123, "content" : "...", "tags" : [ "fun", "cool read" ] } 
```

您索引“标签”字段，然后您可以搜索“标签：'fun'”，Mongo 将非常快速地检索该文档。

你没有描述你是如何获得最高评价的，但你绝对可以将这些信息写入文本并对此进行查询。

# c# - Backgroundworker 正在冻结我的 GUI

> ID：15277096
> 
> 赞同：0
> 
> 时间：2013-03-07T16:55:25.220
> 
> 标签：c#, .net, backgroundworker

我有一个验证用户的 WPF 应用程序。当该用户成功通过身份验证时，界面会更改并向用户打招呼。我希望欢迎消息在 5 秒内出现，然后用其他内容更改。这是我的欢迎信息，它启动`BackgroundWorker`：

```
LabelInsertCard.Content = Cultures.Resources.ATMRegisterOK + " " + user.Name;
ImageResult.Visibility = Visibility.Visible;
ImageResult.SetResourceReference(Image.SourceProperty, "Ok");
BackgroundWorker userRegisterOk = new BackgroundWorker
   {
        WorkerSupportsCancellation = true,
        WorkerReportsProgress = true
   };
userRegisterOk.DoWork += userRegisterOk_DoWork;
userRegisterOk.RunWorkerAsync(); 
```

这是我`BackgroundWorker`的延迟五秒：

```
void userRegisterOk_DoWork(object sender, DoWorkEventArgs e)
    {
        if (SynchronizationContext.Current != uiCurrent)
        {
            uiCurrent.Post(delegate { userRegisterOk_DoWork(sender, e); }, null);
        }
        else
        {
            Thread.Sleep(5000);

            ImageResult.Visibility = Visibility.Hidden;
            RotatoryCube.Visibility = Visibility.Visible;
            LabelInsertCard.Content = Cultures.Resources.InsertCard;
        }
    } 
```

但是 Backgroundworker 将我的 GUI 冻结了五秒钟。显然，我想做的是在欢迎消息后 5 秒启动工作人员内部的代码。

为什么会冻结 GUI？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T16:57:33.927

您明确破坏了后台工作人员的目的。

您的代码在回调中切换回 UI 线程并在那里执行所有操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T17:00:00.763

也许这就是你想要的：

```
void userRegisterOk_DoWork(object sender, DoWorkEventArgs e)
{
    if (SynchronizationContext.Current != uiCurrent)
    {
        // Wait here - on the background thread
        Thread.Sleep(5000);
        uiCurrent.Post(delegate { userRegisterOk_DoWork(sender, e); }, null);
    }
    else
    {
        // This part is on the GUI thread!!
        ImageResult.Visibility = Visibility.Hidden;
        RotatoryCube.Visibility = Visibility.Visible;
        LabelInsertCard.Content = Cultures.Resources.InsertCard;
    }
} 
```

# java - 我如何识别网络应用程序的多个命令（Java）

> ID：15277097
> 
> 赞同：2
> 
> 时间：2013-03-07T16:55:26.197
> 
> 标签：java, sockets, networking, chat, protocols

我想为一些实践构建一个客户端-服务器-应用程序。我从一个简单的聊天开始，这并不难。我还可以通过简单地拆分字符串来识别不同的命令，例如“command:msg”。但我认为这可能有点不方便。所以我想知道是否有更好的方法来实现这一点。我偶然发现了那一面： [http](http://www.javaworld.com/jw-01-1997/jw-01-chat.html?page=6) ://www.javaworld.com/jw-01-1997/jw-01-chat.html?page= 6 最后它说：

> 然而，另一种更优雅的解决方案是在一组流类后面抽象协议。头构造和插入的细节可以由流类自动处理，然后客户端留下与以前大致相同的接口：客户端将消息写入流，但不是刷新流，而是调用附加的方法适当的标头并发送封装的消息。

我真的不知道那是什么意思。有人可以解释一下，或者更好的是，给我一个代码示例。也许还有其他方法可以做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:25:35.320

假设您要发送封装为您发送的链接的消息：

| 身份证 | 伦 | 留言内容|。

他们所说的“抽象一组流类背后的协议”的意思是创建扩展流类的类，这些类将为您在封装的消息上放置正确的 ID 和长度。

例如，对于您发送两种消息的扩展 PrintWriter：

ID 1 - 正常消息。

ID 2 - 错误消息。

```
class MyProtocolPrintWriter extends PrintWriter {

    public static final int NORMAL_MESSAGE = 1;
    public static final int ERROR_MESSAGE = 2;

    //put the constructor

    public void writeMessage(String message) {
        println(
            String.format(
            "%02x%02d%s", NORMAL_MESSAGE, message.length(), message));
    }

    public void writeErrorMessage(String message) {
        println(
            String.format(
            "%02x%02d%s", ERROR_MESSAGE, message.length(), message));
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:13:11.080

这是一个相当成功的聊天网络用于协议的内容。

[互联网中继聊天](http://en.wikipedia.org/wiki/Internet_Relay_Chat)

这是使用 IRC 协议实现的命令的列表。

[互联网中继聊天命令列表](http://en.wikipedia.org/wiki/List_of_Internet_Relay_Chat_commands)

您可以将这些命令实现为一组流类。用户发出命令，您的流类处理标头构造和插入流的细节。

# asp.net - 如何在 web.config 中配置作为服务属性值提供的类型？

> ID：15277101
> 
> 赞同：0
> 
> 时间：2013-03-07T16:55:35.863
> 
> 标签：asp.net, visual-studio-2010, wcf, c#-4.0

我在`<system.serviceModel>`web.config 文件的标签中配置了以下内容：

```
<system.serviceModel>
  <bindings/>
  <client/>
  <behaviors>
    <serviceBehaviors>
      <behavior name="serviceTypeBehaviors">
        <serviceMetadata httpGetEnabled="true"/>
        <serviceDebug includeExceptionDetailInFaults="true"/>
      </behavior>
    </serviceBehaviors>
  </behaviors>
  <serviceHostingEnvironment multipleSiteBindingsEnabled="true">
  </serviceHostingEnvironment>
  <services>
    <service behaviorConfiguration="serviceTypeBehaviors" name="AcpService.MainFrameData">
      <endpoint address="" binding="basicHttpBinding" contract="AcpService.IMainFrameService" />
      <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
    </service>
  </services>
</system.serviceModel> 
```

我的服务的 XML 是这样的：

```
<%@ ServiceHost Language="C#" Debug="true" Service="AcpService.MainFrameData" CodeBehind="MainFrameWoData.svc.cs" %> 
```

我的应用程序在**Default Web Site**的应用程序池中运行，**Enable 32-Bit Applications**设置为**True**（因为该服务使用一些旧的数据访问库）。

当我运行它时，我得到这个错误：

## “/大型机”应用程序中的服务器错误。

**找不到类型“AcpService.MainFrameData”，作为 ServiceHost 指令中的服务属性值提供，或在配置元素 system.serviceModel/serviceHostingEnvironment/serviceActivations 中提供。**

**异常详细信息：** System.InvalidOperationException：类型“AcpService.MainFrameData”，作为 ServiceHost 指令中的服务属性值提供，或在配置元素 system.serviceModel/serviceHostingEnvironment/serviceActivations 中提供。

**版本信息：** Microsoft .NET Framework 版本：4.0.30319；ASP.NET 版本：4.0.30319.272

我几乎修改了我的`<serviceHostingEnvironment>`标签以包含`<serviceActions>`参数，但我真的不明白如何做到这一点。

这是我走了多远：

```
<serviceHostingEnvironment multipleSiteBindingsEnabled="true">
  <serviceActivations>
    <add factory="System.ServiceModel.Activation.ServiceHostFactory"
      relativeAddress="~/mainframe/MainFrameWoData.svc"
      service="AcpService.MainFrameData" />
  </serviceActivations>
</serviceHostingEnvironment> 
```

我不确定我是否正确执行此操作，并且我不知道要为**service=**参数插入什么。这MSDN上的信息似乎没用。

这个项目最初有一个不同的名称，但我不得不向服务中添加功能。我不想编辑活动服务，因为这样做意味着所有试图访问我们内部网络上的数据的员工现在都会遇到该错误，因此该服务被复制到一个新项目中，并且正在发布到我们服务器上的新位置。我最好的猜测是`web.config`文件中的某些内容（或???）与项目本身的内容不匹配。

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T21:52:03.693

看起来我的项目想要**MainFrameService**而不是**MainFrameData**。

我开始删除这篇文章，但是......谁知道呢？也许其他人可以从中得到一些用处。

# c++ - 如何使用 ASM 将 FARPROC 的内存地址移动到另一个函数？

> ID：15277105
> 
> 赞同：2
> 
> 时间：2013-03-07T16:55:52.727
> 
> 标签：c++, c, dll, assembly

我有 2 个 FARPROC，我想使用 ASM 将其中一个的地址替换为另一个。

什么是 FARPROC？"[int (FAR WINAPI * FARPROC) () ] 在 C 中，FARPROC 声明表示具有未指定参数列表的回调函数。然而，在 C++ 中，声明中的空参数列表表示函数没有参数。这细微的区别可能会破坏粗心的代码。以下是处理这种情况的一种方法："

现在已经涵盖了，这是我的代码：

```
 HMODULE h = LoadLibrary("myDLL.dll");
  FARPROC p = GetProcAddress(h, "_GetHelloMessage@0");

  if(!p) MessageBox(hwnd, "injected, but function not found", "Loader", NULL);

  HMODULE dllHmodule = GetModuleHandle("InjectFunctions.dll");
  FARPROC injproc = GetProcAddress(dllHmodule, "_GetHelloMessage@0");

  if(!injproc) MessageBox(hwnd, "injproc is null", "Loader", NULL);

  __asm{
        mov eax, p
        ADD injproc [EAX],8
    } 
```

我的问题是如何做到这一点，所以每当加载此 DLL 的程序调用 p 时，它将改为调用 injproc？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:49:05.183

外部 DLL 中每个引用的函数都在可执行文件头区域的导入地址表中获得一个条目。该条目的一部分是函数的地址。这就是您修补以使呼叫转到其他地方的方法。应该有很多关于如何在开放的互联网上执行此操作的示例，尽管我碰巧没有方便的链接。

如果您想自己执行此操作，请从 msdn 下载 Portable Executable 规范以查看这些标头的格式。

# wordpress - wordpress 不复制帖子

> ID：15277108
> 
> 赞同：0
> 
> 时间：2013-03-07T16:55:58.967
> 
> 标签：wordpress, duplicates

我知道如何在没有重复帖子的情况下使用几个循环。

但我的问题是：

假设我有两个循环，每个两个循环只显示 1 个帖子，它们都有相同的最新帖子。如果我使用下面的代码，重复的帖子将不会在第二个循环中显示，但它也会停止继续下一个帖子。如何解决它。百万谢谢！

代码：

```
<?php $my_query = new WP_Query('cat=1,2&posts_per_page=1');
    while ($my_query->have_posts()) : $my_query->the_post();
    $do_not_duplicate = $post->ID; ?>
    first loop
<?php endwhile; ?>

<?php query_posts('cat=10&posts_per_page=1'); if (have_posts()) : while (have_posts()) : the_post(); if (in_array($post->ID, $do_not_duplicate)) continue;?>
    second loop
<?php endwhile; endif; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-31T20:10:58.360

我认为您需要稍微清理一下示例：

你有`$do_not_duplicate = $post->ID;`，假设你的变量是**字符串**post_id，那么你检查`if (in_array($post->ID, $do_not_duplicate)) continue;`

此时`$do_not_duplicate`不是**数组**（）。

如果你想存储一个数组（），试试这个：`$do_not_duplicate[] = $post->ID;`，然后你可以执行你当前的检查。

# c# - C# 中的用户控件文本框验证

> ID：15277110
> 
> 赞同：0
> 
> 时间：2013-03-07T16:56:04.593
> 
> 标签：c#, winforms, user-controls, textbox, dialog

我有一个文本框用户控件。我为最大长度的文本框创建了一个动态属性。

```
public int MaximumLength { get; set; }

    private void txtLocl_KeyPress(object sender, KeyPressEventArgs e)
    {
        txtLocl.MaxLength = MaximumLength;//txtLocl is a Usercontrol Textbox..,
        //txtLocl maxLength should be given by the user in WindowsForm
        //that should be come to here...,
    } 
```

我向您展示了 Windows 窗体中的 UserControl 属性的图像

![我向您展示了 Windows 窗体中 UserControl 属性的图像。](../Images/dc33660da530937f1b27b0ad7525b110.png)

现在我想验证用户何时更改该属性中的值...，

![我想要那个对话框](../Images/1bfb405d573e627869a0b646506eb727.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:00:43.480

实现一个自定义设置器来检查值是否有效。

```
public int MaximumLength
{
  get
  {
    return this.maximumLength;
  }

  set
  {
    if(value <= 4)
    {
      MessageBox.Show("Value is too small.");
    }
    else this.maximumLength = value;
  }
} 
```

编辑：所以实现一个吸气剂。

# vector - 在 openlayers 中重新激活拖动控制失败

> ID：15277111
> 
> 赞同：0
> 
> 时间：2013-03-07T16:56:07.033
> 
> 标签：vector, controls, openlayers, drag

全部。我有这个小问题，我正在寻求帮助：

首先我有一个包含以下内容的函数：

```
var point = new OpenLayers.Geometry.Point(imageConfig.XPos, imageConfig.YPos);
var imageFeature = new OpenLayers.Feature.Vector(point);
layers.imageLayer.addFeatures([imageFeature]); 
```

因此在图层上绘制了一个点。在这一层上还有一个 openlayers 拖动控件。它在绘制点后被激活。现在我可以拖动这个点了。奇迹般有效。

这是用户驱动的逐步过程的一小部分。因此，在拖动完成后，接下来的步骤将对该点进行一些操作。在执行这些其他步骤时，拖动控件被停用。在该过程中，可以在步骤之间跳转，因此需要取消/激活拖动控制。这工作正常。

在所有步骤结束时，该点将从图层中移除。这也很好用。

但是：如果我再次调用在图层上绘制点的函数（因为现在它是一个新点）并激活拖动控件，即使我尝试用鼠标单击选择点，我也无法再拖动新点？ ！

我用 firbug 控制：

*   功能在那里
*   功能在正确的图层上
*   控制在那里
*   控制在正确的层
*   控制被激活

也许我在这里遗漏了一件简单的事情。但是我现在已经打破了这两天的头脑，找不到答案。

顺便说一句，我发现在第一步序列中（当一切正常时），控件特性属性是用点特性设置的。但在第二个没有。在控件拖动处理程序功能属性中相同。

我尝试通过以下方式手动设置它：

```
control.feature = imageFeature 
```

和：

```
control.handler.drag.feature = imageFeature 
```

我正在寻找一个功能来设置控件的新功能。但在 openlayers 文档上找不到任何内容。其他控件同时不活动（用萤火虫控制）。

但没有运气。没有帮助。为什么这个？我确信这应该有效。站在这里我做错了什么或想念？？？

每一个帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T11:22:44.113

我自己想出来的。问题是我使用 geoext 特征存储在网格中显示点。这个网格是用 geoext 特征选择模型配置的。我刚刚复制了这个......选择模型还在地图上分配了一个特征选择控件。在第一轮中，这与拖动控件没有冲突，因为它是在之后加载的。

当工具再次进入第一步时，所有控件都加载到地图中。选择控件和拖动控件已启用。这不能由开放层处理。似乎最后一个映射添加的控制是具有优先级的。因此，您可以一次又一次地启用拖动控制。选择控件获胜。

诀窍是使选择控件失效。然后一切都很完美。

# java - 如何计算字符串中每个字母出现的次数？

> ID：15277112
> 
> 赞同：0
> 
> 时间：2013-03-07T16:56:09.767
> 
> 标签：java, string

我不确定如何计算每个字母的出现次数。有人可以指出我这样做的正确方向吗，谢谢:)

```
if(icanreadstrings.equals ("start")){ 

            String strten = Console.readLine("Enter 10 letters (no spaces,commas between each letter and no numbers): "); // Asks the user to enter 10 letters which is then saved as a string "strten".
            Console.println(strten);// Prints out whatever the user entered.

            if(strten.matches("[a-zA-Z]+") && strten.length() == 10){ // if whatever the user enters is letters (not numbers) and if it matches to the length, which is 10.
                Console.println("There are " + strten.length() + " letters that you've wrote."); // lets the user continue if they've wrote 10 letters, yes 10!

            }else{
                Console.println("There are more than or less than 10 letters that you've wrote or you have numbers in your list of letters. Please rewrite 10 different LETTERS for this program to continue."); // Checks to see if you wrote more than  10 letters if you did then it prompts a message and the user can't continue until he writes 10 letters.
                }

         } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T16:59:12.850

使用`Map<Character, Integer>`, 并遍历字符串。在字符第一次出现时，将字符和 1 放入地图中。在所有后续出现的情况下，将地图中已存在的该字符的值加一。

然后，地图的条目集将为您提供所需的数据。

# sql - 根据时间戳组合相似的行

> ID：15277115
> 
> 赞同：1
> 
> 时间：2013-03-07T16:56:15.320
> 
> 标签：sql, sql-server-2008, group-by

我有一个这样的sql查询：

```
SELECT Name, Text as Value, UpdateDate from A WHERE UserID = @userId
UNION 
SELECT Name, STR(Value), UpdateDate FROM B WHERE UserID = @userId 
```

表`A`和`B`两者可能有也可能没有给定名称的行。他们都有一个名字，我只希望我的结果集中有最新的行。

目前我的结果集将如下所示：

```
Name | Value | UpdateDate
Foo    '23'    Jan-1-2012
Foo    'A'     Feb-7-2013
Bar    '42'    Jan-3-2011 
```

我想将其浓缩为：

```
Name | Value
Foo    'A'
Bar    '42' 
```

我意识到我可以在客户端中相当容易地做到这一点，但如果某种`Group-By`魔法可以在单个查询中做到这一点，那就太棒了。希望也不会太贵。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T16:59:03.820

```
WITH unionTB
AS
(
    SELECT Name, Text as Value, UpdateDate 
    from A WHERE UserID = @userId
    UNION 
    SELECT Name, STR(Value), UpdateDate 
    FROM B WHERE UserID = @userId
),
recordList
AS
(
    SELECT  Name, Value, UpdateDate,
            ROW_NUMBER() OVER (PARTITION BY Name
                                ORDER BY UpdateDate DESC) rn
    FROM    unionTB
)
SELECT  Name, Value, UpdateDate
FROM    recordList
WHERE   rn = 1 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!3/2dd29/1)

# jquery - 不希望 div 的背景图片通过表格出现

> ID：15277116
> 
> 赞同：1
> 
> 时间：2013-03-07T16:56:15.830
> 
> 标签：jquery, html, css

说我有以下代码

```
<div class='mydiv'>
   <table class='mytable'>
      ....
   </table>

</div> 
```

在CSS中，我设置

```
.mydiv {
   background-image: someurl
   background-position: center;
   background-repeat: no-repeat;    
} 
```

对于我的表，我为偶数行设置了备用颜色。

```
$(".mytable tr:nth-child(even)").addClass("even"); 
```

在CSS中，我有

```
.even {background-color: #EDEDED;} 
```

现在发生的事情是我仍然可以看到奇数行中的背景图像，默认情况下为白色。我该怎么做才能完全隐藏 div 背景图像？我只想在表格为空时显示背景图像。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T17:03:15.007

为没有偶数类的行添加一个选择器：

```
.mytable tr {
    background-color: white;
} 
```

这**必须**出现在*.even*规则之前，因此级联规则将使其优先。如果根本没有行（空表），则应显示 div 背景图像。

# delphi - 如何在 Delphi XE2 上添加对 HTML 帮助文件 (.chm) 的支持？

> ID：15277118
> 
> 赞同：1
> 
> 时间：2013-03-07T16:56:20.857
> 
> 标签：delphi, delphi-xe2, html-help

如何在 Delphi XE2 上添加对 HTML 帮助文件 (.chm) 的支持？我们需要在`HelpContext`每个控件的属性上使用 A 链接（A 关键字）来查找帮助页面。Delphi XE2 按单元原生支持 HTML 帮助文件`HTMLHelpViewer`。但是如何使用呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T14:04:59.643

`F1`跳转到上下文并不难。

选择 Edit1 并按`F1`。帮助打开并显示 Overview.htm。

![在此处输入图像描述](../Images/f3d3f787731ad6f976ebb2a5a62fe4cd.png)

先决条件。

![在此处输入图像描述](../Images/987c4a3b6f9f548e9f8a23395984c7c2.png)

Edit1 帮助设置：

![在此处输入图像描述](../Images/8c7d6f96ca72fd03475263573614e246.png)

**sample.chm 源设置。**

示例.ali

```
IDH_Overview=Overview.htm
IDH_welcom=FirstTopic.htm
IDH_UsingtheMenus=Overview.htm 
```

样本.h

```
#define IDH_Creating_Projects_and_Topics 1005
#define IDH_Overview 1003
#define IDH_UsingtheMenus 1009 
```

单元1.pas

```
unit Unit1;

interface

uses Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, HTMLHelpViewer, Vcl.ExtCtrls;

type
  TForm1 = class(TForm)
    HHALINKLOOKUP: TButton;
    JumpAnchor: TButton;
    Edit1: TEdit;
    Label1: TLabel;
    procedure FormCreate(Sender: TObject);
    procedure HHALINKLOOKUPClick(Sender: TObject);
    procedure JumpAnchorClick(Sender: TObject);
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}
var
hpPath : string;
link : HH_AKLINK;

procedure TForm1.FormCreate(Sender: TObject);
begin
  hpPath := ExtractFilePath(Application.ExeName) +
    'HelpFile\sample.chm';
  Application.HelpFile := hpPath;
end;

procedure TForm1.HHALINKLOOKUPClick(Sender: TObject);
var
link : HH_AKLINK;
szUrl,szKey,szMsgText,szMsgTitle,szWindow : AnsiString;
begin
   szKey      := Edit1.Text; // 'UsingtheMenus';
   szUrl      :='Overview.htm';
   szMsgText  :='Error: Can''t find "'+Edit1.Text+'"!';
   szMsgTitle :='Error: HH_ALINK_LOOKUP';
   szWindow   :='main';

   with link do begin
   cbStruct    := sizeof(HH_AKLINK) ;
   fReserved   := False;
   pszKeywords := PChar(szKey);
   pszUrl      := nil;
   pszMsgText  := PChar(szMsgText);
   pszMsgTitle := PChar(szMsgTitle);
   pszWindow   := PChar(szWindow);
   fIndexOnFail:= False;
   end;
   HtmlHelpW(0, hpPath+'>main', HH_DISPLAY_TOPIC, DWORD_PTR(nil));
   HtmlHelpW(0, hpPath, HH_ALINK_LOOKUP, DWORD_PTR(@link));
end;

procedure TForm1.JumpAnchorClick(Sender: TObject);
begin
  HtmlHelpW(0, hpPath+'::/Overview.htm#'+Edit1.Text+'>main', HH_DISPLAY_TOPIC, DWORD(nil));
end;
end. 
```

这是一个可以使用的 sample.chm 和源[下载](http://moskito-x.de/stack/stackdwl1.html)

有一个技巧如何轻松地跳转，不仅可以跳转到 .htm 文件，还可以直接跳转到锚点。

更改 sample.ali

```
IDH_Overview=Overview.htm
IDH_welcom=FirstTopic.htm
IDH_UsingtheMenus=Overview.htm#UsingtheMenus 
```

**在Overview.htm**中你想跳转的地方插入一个锚点

 **```
[...]
<A NAME="UsingtheMenus" </A>
<P><STRONG>Using the Menus and Toolbars</STRONG>
<P>The menus and toolbars provide a complete set of tools 
[...] 
```

现在可以使用`F1`, 直接跳转到 overview.htm 中的所需点。

![在此处输入图像描述](../Images/ac0e49d6b82ca2b576df5aa352acb9b3.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:02:00.410

我怀疑要使用 A 链接，您需要执行以下操作：

1.  `Application.OnHelp`如下所述分配处理程序。
2.  `Application.HelpFile`在程序启动期间分配。
3.  `Application.HelpKeyword`如果您希望使用 A 链接调用帮助系统，请致电。
4.  `HelpKeyword`为您希望响应上下文相关`F1`按键的任何 GUI 控件设置属性。

`OnHelp`处理程序如下所示：

```
function TMainForm.ApplicationHelp(Command: Word; 
  Data: THelpEventData; var CallHelp: Boolean): Boolean;
var
  Link: THH_AKLink;
  ALink: string;
begin
  CallHelp := False;
  Result := True;
  //argh, WinHelp commands
  case Command of
  HELP_COMMAND:
    begin
      ZeroMemory(@Link, SizeOf(Link));
      Link.cbStruct := SizeOf(Link);
      ALink := PChar(Data); // we are going to re-purpose the keyword as an A-link
      Link.pszKeywords := PChar(AnsiString(ALink)); // seems we have to pass a PAnsiChar ..
      Link.fIndexOnFail := True;
      HtmlHelp(GetDesktopWindow, Application.HelpFile, HH_ALINK_LOOKUP, 
        DWORD_PTR(@Link));
    end;
  end;
end; 
```

该`HtmlHelpViewer`单元包含名称`LookupALink`相同的方法。但我不明白他们怎么可能被调用。

上述方法有点hacky，因为它将关键字解释为A-Links。如果您需要上下文相关的帮助，我看不出您还能做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T10:54:54.063

不确定 Xe2 查看器的工作原理（我在 2007 年），但我只使用 Microsoft HTML 帮助 API 的 Eric Granges 端口，不出所料，它被称为 HTMLhelpAPI.pas。

您可以使用该函数调用 Alink

ChmShowTopic（常量文件名，主题：字符串）：HWND；**

# objective-c - 基于coreData信息在objective-c中以编程方式创建图像

> ID：15277119
> 
> 赞同：-1
> 
> 时间：2013-03-07T16:56:22.340
> 
> 标签：objective-c, xcode, uitableview, uiimageview

我的 ViewController 中有一个表，在这个表中我将从 webService 和 CoreData 获取一些信息，这些信息出现在每一行中，当我在每一行中按下时，我想转到详细视图并创建图像，

我有卡片，每张卡片都有不同的印章，当我要查看详细信息时，我想创建这些图像，我的意思是，如果我的卡有 2 个印章，我想创建 2 个图像，如果有 3 个印章，我想创建 3 个图像,

请您在此实施中帮助我，在此先感谢！

这是我从网络服务获得的信息：

```
createdAt = 1362412409;
id = 2;
stampNumber = 2;
   },
   {
        createdAt = 1362069567;
        id = 1;
        stampNumber = 10;
   } 
```

这是我的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath
    *)indexPath
{
    static NSString *CellIdentifier = @"CardsCell";
    CardCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];    
    if (cell == nil){
         NSArray *objects = [[NSBundle mainBundle] loadNibNamed:@"CardCell" owner:nil 
    options:nil];
        for (id currentObject in objects)
                    {
                        if([currentObject isKindOfClass:[UITableViewCell class]])
                        {
                            cell = (CardCell *) currentObject;

                            break;
                        }
                    }
    }
    card = self.cards[indexPath.row];

    cell.stampId.text = [[NSString alloc] initWithFormat:@"%@",card.stampNumber];
    cell.createdAt.text = [[NSString alloc] initWithFormat:@"%@",card.createdAt];
    cell.CardId.text = [[NSString alloc] initWithFormat:@"Carte %d",(indexPath.row+1)];
    return cell;

}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath
     *)indexPath
{
    [tableView deselectRowAtIndexPath:indexPath animated:YES];
    [[NSNotificationCenter defaultCenter] postNotificationName:@"cardDetail" object:nil 
    userInfo:nil];
} 
```

我的问题是我应该如何根据我的印章以编程方式创建这些图片..

**编辑：** 我有这张图片：

```
UIImageView *stampIMG = [[UIImageView alloc] initWithFrame:self.view.frame];
stampIMG = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"1.jpg"]];
stampIMG.frame = CGRectMake(0, 0, 122, 122); 
```

我只想使用这张图片

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:55:36.927

您应该存储图像位置的路径，而不是图像的 NSData。然后使用 stampId 获取该图像路径并加载到您的图像中。如果图像在服务器上，则下载图像。您可以将图像作为 NSData 存储在 CoreData 中，但这个 blob 可能很大，这就是为什么通常最好只存储图像的路径。因此，在 CoreData 中，您可以拥有一个具有 stampId 和 ImagePath 的对象 Stamp。然后通过 stampId 获取对象，然后从对象中获取 imagePath。

我可能会尝试这样的事情来通过戳 id 获取图像。如果您的图像已下载，则替换文档目录与主包。

```
NSFetchRequest * stampById = [[NSFetchRequest alloc] init];
[stampById setEntity:[NSEntityDescription entityForName:@"Card" inManagedObjectContext:self.managedObjectContextBKG]];
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"stampId == %@", stampId];
[stampById setPredicate:predicate];

NSError *error = nil;
NSArray * stampResults = [self.managedObjectContext executeFetchRequest:stampById error:&error];

if(nil != stampResults && [stampResults count]){
    Stamp *stamp = [stampResults objectAtIndex:0];
    UIImage *image = [[UIImage alloc] initWithContentsOfFile:[[NSBundle mainBundle] pathForResource: stamp.imagePath ofType:@"png"]];
} 
```

# java - 使用 for 循环编写文件。但我做不到

> ID：15277124
> 
> 赞同：-4
> 
> 时间：2013-03-07T16:56:30.203
> 
> 标签：java, for-loop, iterator, filewriter

我必须将一些数据写入文件。我尝试使用循环将数据写入文件。但是当我使用这段代码时，每个文件只写一行。

帮我处理这段代码

```
 Vector[] v = jca.getClusterOutput();
    for (int i=0; i<v.length; i++)
    {
        Vector tempV = v[i];
        System.out.println("-----------Cluster"+i+"---------");
        Iterator iter = tempV.iterator();

        while(iter.hasNext())
        {
            File file = new File("e://filename"+i+".txt");   
             FileWriter fw = new FileWriter(file.getAbsoluteFile());
            DataPoint dpTemp = (DataPoint)iter.next();
            System.out.println(dpTemp.getObjName()+"["+dpTemp.getX()+","+dpTemp.getY()+"]");
            BufferedWriter bw = new BufferedWriter(fw);
            bw.write("\n"+dpTemp.getObjName()+"["+dpTemp.getX()+","+dpTemp.getY()+"]");

            //bw.close();
            bw.flush();

            System.out.println("Done");
        }

    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T17:00:16.617

好吧，您在每次迭代中都覆盖了文件。将文件创建、编写器创建等移出循环：

```
File file = new File("e://filename"+i+".txt");   
FileWriter fw = new FileWriter(file.getAbsoluteFile());
BufferedWriter bw = new BufferedWriter(fw);

while(iter.hasNext())
{           
        DataPoint dpTemp = (DataPoint)iter.next();
        System.out.println(dpTemp.getObjName()+"["+dpTemp.getX()+","+dpTemp.getY()+"]");

        bw.write("\n"+dpTemp.getObjName()+" ["+dpTemp.getX()+","+dpTemp.getY()+"]");                        
}
//bw.close();
bw.flush();
System.out.println("Done"); 
```

或者，您可以重新创建`FileWriter`and 作为第二个构造函数参数传递`true`，以便附加到文件而不是替换其内容。但是，我仍然建议只创建一次作家。

# javascript - 需要转换 %amp; 只是为了让脚本正常工作

> ID：15277126
> 
> 赞同：0
> 
> 时间：2013-03-07T16:56:36.237
> 
> 标签：javascript, modx

我在 modx 中转换了一个网站，它使用 java 包装器来动态拉入内容并在不重新加载任何页面的情况下显示它。该网站的基础知识在那里，但我对生成的链接有一个小问题，我不确定绕过它的最佳方法是什么。

我没有编写该站点使用的原始 javascript，我只是想稍微重构它，以便 modx 利用正确的部分。

这是我用来分页下一页/上一页的模板示例

```
 <div id="next"></div>
 <script type="text/javascript">
 $(function() 
    {
    setNext('[[+href]]');
    var page_content_height = $('#page_content').height();
    }
 );
 </script> 
```

基本上 modx 生成的链接在页面中采用以下格式：

```
 setNext('nb/index.php?id=17&amp;page=2'); 
```

为了让他们工作，他们需要：

```
 setNext('nb/index.php?id=17&page=2'); 
```

使用 jquery 的网站，我在想可能有一种方法可以在呈现页面之前转换文本字符串？

希望有人能指出我正确的方向，因为我有点难过 atm。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:04:06.337

```
setNext(htmlDecode('nb/index.php?id=17&amp;page=2'));

function htmlDecode(input){
  var e = document.createElement('div');
  e.innerHTML = input;
  return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
} 
```

在 javascript 中查看[unescape html 实体](https://stackoverflow.com/questions/1912501/unescape-html-entities-in-javascript)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T16:59:24.003

这可以解决问题

```
var str = 'nb/index.php?id=17&amp;page=2'
str = str.replace(/&amp;/g, '&');
setNext(str); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T20:08:10.210

IMO最好从源头纠正它，而不是在浏览器中“修补”。

最坏的情况，你可以在 PHP 中这样做：

```
$href = 'nb/index.php?id=17&amp;page=2';
$modx->setPlaceholder('href', str_replace('&amp;', '&', $href)); 
```

但是，如果链接是使用 MODX 的`makeUrl()`方法生成的，那么它应该已经正确格式化。

# highcharts - Highcharts - 在 MouseOver 上更改系列颜色

> ID：15277127
> 
> 赞同：2
> 
> 时间：2013-03-07T16:56:37.577
> 
> 标签：highcharts, linechart

我知道以前有人问过这个问题，并且我大量使用了其他人提供的很多答案，但仍然不是 100% 的方式。

我希望所有系列线都是灰色的，并且该线的一个鼠标悬停，“打开”它们的颜色，在鼠标移出时恢复为灰色。

[我已经在这里](http://jsfiddle.net/matthewnye/f3Wq2/3/)部分工作了，但是有一些明显的问题：

1.  我知道，我已经硬编码了系列数组的位置。我无法弄清楚如何确定鼠标在哪个系列上。最好的方法是什么？

    ```
     plotOptions: {
            series: {
                events: {
                    mouseOver: function() {chart.series[0].graph.attr('stroke', '#0000FF');
                        $report.html('Moused over')
                        .css('color', 'green');
                    },
                    mouseOut: function() {chart.series[0].graph.attr('stroke', '#C0C0C0');
                        $report.html('Moused out')
                        .css('color', 'red');
                    }
                }
            }
    } 
    ```

2.  鼠标离开直到光标离开图表区域才会触发。如何更精确地跟踪系列行的鼠标事件？

高度赞赏对我当前代码的任何改进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T18:25:50.400

您可以使用：

```
 this.graph.attr('stroke', '#0000FF'); 
```

而不是硬编码一个系列：http: [//jsfiddle.net/jlbriggs/f3Wq2/5/](http://jsfiddle.net/jlbriggs/f3Wq2/5/)

不久前我有类似的事情，使用复选框而不是鼠标悬停事件。以防万一里面有什么有用的东西：http: [//jsfiddle.net/jlbriggs/57SR9/21/](http://jsfiddle.net/jlbriggs/57SR9/21/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T17:41:16.183

我相信这个例子可能是mouseout问题的解决方案：

[http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/plotoptions/series-events-mouseover-no-sticky/](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/plotoptions/series-events-mouseover-no-sticky/)

这个参数可能是你需要的：

```
stickyTracking: false, 
```

在文档中：

[http://api.highcharts.com/highcharts#plotOptions.series.events.mouseOut](http://api.highcharts.com/highcharts#plotOptions.series.events.mouseOut)

# c++ - C++ 除以零

> ID：15277129
> 
> 赞同：2
> 
> 时间：2013-03-07T16:56:42.073
> 
> 标签：c++

我开始学习 C++ 编程并且有一个关于错误处理的问题。

我编写了一个从函数计算 x 的代码`ax+b=0`（所以我必须除以`-b`）`a`。这些值由用户通过`cin >>`

如果我除以 0，我得到`-int`我的输出。是否有可能捕获错误（例如在`if`声明中）？

我知道除以零是不可能的，而且我也知道如果它不检查用户的输入（例如`if ((a != 0)){calculate}`），它不会是一个程序的好行为。问题是我想知道它是否/如何工作来捕获这个错误;-) 它是否取决于硬件、操作系统或编译器？

我的老师帮不了我；）

顺便提一句。我在 Mac OS X 10.8.2 上使用 Eclipse Juno IDE for C/C++

```
#include <iostream>
#include <iomanip>
using namespace std;

int main() {
    float a, b, x;   //float da Kommazahlen erwartet werden
    cout << "ax + b = 0" << '\n'<< endl;
    cout << "Bitte geben Sie einen Wert für a ein:" << endl;
    cin >> a;
    cout << "Bitte geben Sie einen Wert für b ein:" << endl;
    cin >> b;

    x = -b/a;
    cout << "Ergebnis:" << x << endl;

    if (x == #INF )
    {
        cout << "Du bist a Volldepp - durch Null kann man nicht teilen!" << endl;
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T17:37:38.450

是的：

在 C++03 中

```
 if ((x == +std::numeric_limits<float>::infinity()) || 
     (x == -std::numeric_limits<float>::infinity())
    ) 
```

在 C++11 中

```
 if (std::isinf(x)) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-07T17:00:07.323

`a == 0`在尝试除法之前检查是否：

```
if (a == 0) {
    std::cerr << "I'm not even going to try\n";
    return 1;
} else {
    std::cout << "-b/a = " << (-b/a) << std::endl;
} 
```

不过，这可能仍然会产生`inf`一些非常小的数字。

（请注意，一般来说，检查 a`float`是否等于某个值是[不可靠的，因为舍入错误](http://floating-point-gui.de/errors/comparison/)，但对于零是可以的。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T17:00:46.707

您应该在计算之前检查输入的正确性，而不是之后：

```
if ( a == 0 ) {
 if ( b == 0 )
   cout << "equation valid for all x" << endl;
 else
   cout << "no x satisfies this equation" << endl;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-07T17:15:07.397

是的，处理这种情况的最佳方法是 a==0 条件。除以零也不例外，它是在硬件级别处理的。硬件向操作系统和操作系统发送中断到您的应用程序，从而使其崩溃。可以用信号捕获：

```
#include <csignal>
#include <iostream>

using namespace std;

void handler(int nVal) 
{
    cout << "Divid By Zero Error" << endl;
}

int main() 
{
    signal(SIGFPE, handler);
    int nVal = 1/0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-07T17:30:04.203

我回应其他海报说你应该检查你的论点，但还有另一种选择：[http ://en.cppreference.com/w/cpp/numeric/math/math_errhandling](http://en.cppreference.com/w/cpp/numeric/math/math_errhandling)

根据该链接，在 C++11 中，您可以设置 a`#define`以使其在除以零时抛出 type 的异常`FE_DIVBYZERO`。但是该页面上的文档不清楚，因此请检查您自己的编译器是否支持这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-07T17:00:44.940

您无法捕获异常，`C`但可以通过检查值来避免它。

试试这样，它会帮助你

```
if (a == 0) {
  x = 0;
} else {
  x = b/a;
} 
```

# ruby - 错误：在 ruby 2.0.0 中安装 vagrant gem

> ID：15277135
> 
> 赞同：4
> 
> 时间：2013-03-07T16:56:54.103
> 
> 标签：ruby, rubygems, gem, vagrant, ruby-2.0

当我尝试在**ruby​​ 2.0.0-p0中安装****vagrant** gem时，出现以下错误：

 **```
~ ruby -v
ruby 2.0.0p0 (2013-02-24 revision 39474) [x86_64-linux]
~ gem -v
2.0.0.rc.2
~ gem list json
*** LOCAL GEMS ***
json (1.7.7)

~ gem install vagrant
Building native extensions.  This could take a while...
ERROR:  Error installing vagrant:
    ERROR: Failed to build gem native extension.

    /home/user_name/.rvm/rubies/ruby-2.0.0-p0/bin/ruby extconf.rb
checking for ruby/re.h... yes
checking for ruby/encoding.h... yes
creating Makefile
make
compiling generator.c
generator.c: In function ‘cState_aref’:
generator.c:736:5: warning: variable ‘state’ set but not used [-Wunused-but-set-variable]
linking shared-object json/ext/generator.so
make install
/usr/bin/install -c -m 0755 generator.so /home/user_name/.rvm/gems/ruby-2.0.0-p0/gems/json-1.5.5/ext/json/ext/json/ext
/usr/bin/install: cannot create regular file `/home/user_name/.rvm/gems/ruby-2.0.0-p0/gems/json-1.5.5/ext/json/ext/json/ext': No such file or directory
make: *** [install-so] Error 1
Gem files will remain installed in /home/user_name/.rvm/gems/ruby-2.0.0-p0/gems/json-1.5.5 for inspection.
Results logged to /home/user_name/.rvm/gems/ruby-2.0.0-p0/gems/json-1.5.5/ext/json/ext/generator/gem_make.out 
```

我想，它在构建 gem 并得到上述错误时使用来自 /home/user_name/.rvm/gems/ruby-2.0.0-p0/gems/ 的**json-1.5.5 。**

我尝试重新安装最新的**json-1.7.7** gem，但仍然无法安装。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-13T21:21:26.217

使用以下命令更新您的 ruby​​gems：`gem update --system`

这是解决此问题的提交：[https ://github.com/rubygems/rubygems/commit/1ca11d00833bbca33215ff581303d1fee8f2d1ef](https://github.com/rubygems/rubygems/commit/1ca11d00833bbca33215ff581303d1fee8f2d1ef)**

# c++ - 找出一个 c++ 项目中有多少个 goto

> ID：15277136
> 
> 赞同：0
> 
> 时间：2013-03-07T16:56:55.477
> 
> 标签：c++, regex, grep, goto

我正在尝试查看`goto`c++ 项目中有多少指令。现在我使用一个简单的匹配来`grep`搜索`"goto "`：

```
grep -r --exclude-dir "third_party" --include "*.cpp" --include "*.h" --include "*.C" --include "*.cxx" --include "*.hcc" --include "*.c" --include "*.cc" "goto " . 
```

我得到了很多假阳性，尤其是内部评论：

```
// Perform stack overflow check if this goto needs it before jumping. 
```

或内部文字：

```
stream->Add(" goto ("); 
```

避免它们的最简单方法是什么？我不需要完美的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:04:08.730

您可能会考虑使用静态分析工具，例如[cppcheck](http://cppcheck.sourceforge.net/)来执行此操作。仅使用正则表达式处理所有可能的情况可能会变得不适用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T17:05:13.997

将您的正则表达式更改为：`'goto[ \t]+[_A-Za-z0-9]+[ \t]*;'`这将在同一行搜索单词 goto、它的目标标签和一个分号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:07:52.927

我建议使用`awk`可以使用多个正则表达式或编写脚本的其他工具。

比较困难的情况是：

```
/*****
 * Goto system failure if this point is reached.
 */ 
```

意味着 C 样式注释中的任何内容。

# android - 设置 Surface View 的背景颜色

> ID：15277140
> 
> 赞同：11
> 
> 时间：2013-03-07T16:57:03.723
> 
> 标签：android, surfaceview

我想为我的相机表面视图设置表面视图的背景颜色。

我正在使用[它](https://stackoverflow.com/questions/8104789/how-to-set-backgroundcolor-to-a-surfaceview-in-android)来实现相同的功能。但是这个例子并不完整。谁能帮我提供一些其他有用的链接。

谢谢

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2015-01-15T08:46:52.207

有一种解决方法可以做到这一点。

1.  为surfaceview添加一个父viewgroup，将背景颜色设置为这个viewgroup而不是surfaceview；

    ```
    <FrameLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@android:color/holo_blue_dark">

        <com.example.surfacetest.MySurface
            android:id="@+id/surface"
            android:layout_width="match_parent"
            android:layout_height="match_parent" />

    </FrameLayout> 
    ```

2.  为 SurfaceView 实例添加以下内容；

    ```
    surfaceView.setZOrderOnTop(true);
    surfaceView.getHolder().setFormat(PixelFormat.TRANSLUCENT); 
    ```

现在你得到了你想要的背景颜色，并且表面视图是 tanslucent。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-07T17:15:33.600

使用 surfaceview_obj.setBackgroundColor (int color) 设置背景颜色..

将白色设置为背景使用此代码

```
surfaceview_obj.setBackgroundColor(0Xffffffff); 
```

[检查这个](http://developer.android.com/reference/android/view/View.html#setBackgroundColor%28int%29)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-04-24T12:18:36.787

只需使用 canvas.drawRect() 绘制一个 Rect 对象。将坐标设置为 0,0,screenX,screenY

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-20T13:06:59.467

您必须做一些修改才能使 SurfaceView 中的任何后台工作，如下所示：

覆盖`setBackground`and`setBackgroundDrawable`方法

```
 Drawable background

   @Override
   public void setBackgroundDrawable(Drawable background) {
      this.background = background;
   }

   @Override
   public void setBackground(Drawable background) {
      this.background = background;
   } 
```

不要忘记调用`setBounds`drawable

```
 @Override
   protected void onLayout(boolean changed, int left, int top, int right, int bottom) {
      super.onLayout(changed, left, top, right, bottom);
      matrix = null;
      if (background != null)
         background.setBounds(left, top, right, bottom);
   } 
```

然后在你锁定的代码上，绘制，解锁和发布你添加背景的画布

```
 Canvas c = holder.lockCanvas();
   if (background != null)
      background.draw(c);

   // do your stuff here

   holder.unlockCanvasAndPost(c); 
```

适用于 XML 和 Java 背景。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-07T17:57:40.433

用这个

```
surfaceview.getHolder().setFormat(PixelFormat.TRANSLUCENT); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-04T14:15:48.780

只需在绘图之前将 ARGB 值放入绘图方法中（例如矩形、圆形等）。我已将其设置为白色。最后一个参数是透明度。

c.drawARGB(255, 255, 255, 255);

# c - 访问和存储结构元素

> ID：15277142
> 
> 赞同：-1
> 
> 时间：2013-03-07T16:57:04.630
> 
> 标签：c

我是编码新手，在一个事件中遇到了这个片段，这个代码到底是做什么的？提前致谢 。

```
 #include <stdio.h>
 #define OFFSETOF(TYPE,ELEMENT) ((size_t)&(((TYPE *)50)->ELEMENT))
 typedef struct PodTag
 {
 char i;
 int  d;
 int c;
 } PodType;
 int main()
 {
  printf("%d\n", OFFSETOF(PodType,c) );
  printf("%d\n", OFFSETOF(PodType,d) );
  printf("%d\n", OFFSETOF(PodType,i) );
  printf("%d \n %d",(&((PodType*)0)->d),sizeof(((PodType*)0)->i));
  getchar();
  return 0;
 } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T17:17:47.210

这段代码演示了结构是如何存储在 C 中的内存中的。

以这种方式编写代码会更好：

```
#include <stdio.h>

#define OFFSETOF(TYPE,ELEMENT) ((size_t)&(((TYPE *)100)->ELEMENT))

typedef struct PodTag {
    char c;
    int  i;
    int  j;
} PodType;

int main()
{
    printf("The size of a char is %d\n", sizeof(((PodType*)0)->c));
    printf("The size of an int is %d\n", sizeof(((PodType*)0)->i));
    printf("The size of a PodType is %d\n", sizeof(PodType));
    printf("The size of a pointer to a PodType is %d\n\n", sizeof(PodType*));

    printf("If there was a PodType at location 100, then:\n");
    printf("    the memory location of char c would be: %d\n",
        OFFSETOF(PodType,c));
    printf("    the memory location of int  i would be: %d\n",
        OFFSETOF(PodType,i));
    printf("    the memory location of int  j would be: %d\n",
        OFFSETOF(PodType,j));

    return 0;
} 
```

这段代码的输出是：

```
The size of a char is 1
The size of an int is 4
The size of a PodType is 12
The size of a pointer to a PodType is 8

If there was a PodType at location 100, then:
    the memory location of char c would be: 100
    the memory location of int  i would be: 104
    the memory location of int  j would be: 108 
```

# ruby-on-rails - Rabl缓存与嵌套对象

> ID：15277146
> 
> 赞同：4
> 
> 时间：2013-03-07T16:57:19.437
> 
> 标签：ruby-on-rails, caching, ruby-on-rails-3.1, rabl

以下是我的观点：

**学生/show.json.rabl**

```
object @student
cache @student
attribute :name, :gender, :age

node :school do |student|
  partial("shared/school", :object => student.school)
end 
```

**共享/_school.json.rabl**

```
object @school
cache @school

attributes :id, :name 
```

**学生.rb：**

```
class Student < ActiveRecord::Base

  belongs_to :school, :touch => true

end 
```

**学校.rb**

```
class School < ActiveRecord::Base

  has_many :students

end 
```

因此，当我更新学生时，缓存会按预期失效。问题是当我更新学校时，学生没有得到更新的学校属性。当我更新学校模型时，我原以为部分中的缓存@school 会失效，但似乎并非如此。

**编辑：增加了对学生的触摸以在更新时使学校无效。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T20:33:16.090

为了帮助别人，这就是我现在正在做的事情：

我将学生展示视图拆分为：

**学生/show.json.rabl：**

```
extends "students/min_show"

node :school do |student|
  partial("shared/school", :object => student.school)
end 
```

**和学生/min_show.json**

```
object @student
cache @student
attribute :name, :gender, :age 
```

这样我仍然会为学生读取缓存，但学校总是从模板中呈现并单独缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T11:44:26.517

您需要在更新`School`时自动使缓存过期`Student`：

> 学生类 < ActiveRecord::Base
> 
> ```
> belongs_to :school, :touch => true 
> ```
> 
> 结尾

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T19:59:09.220

我对你的问题发表了评论，我建议在学校下筑巢学生。一个适合您的简单解决方法是：

```
cache [@student, @student.school] 
```

这样，它会检查两个对象上的 cache_key。

# html - M4V Mimetype - 视频/mp4 还是视频/m4v？

> ID：15277147
> 
> 赞同：43
> 
> 时间：2013-03-07T16:57:20.873
> 
> 标签：html, video, mime-types

我通过 HTML5`video`元素提供视频。我发现有关`m4v`视频的适当 MIME 类型的信息相互矛盾。大多数演示将`type`属性设置`video/mp4`为`source`标记中的标记。我读过的一些文章指出`video/m4v`了 Web 服务器 Mimetype，而另一些则指出了`video/mp4`. 哪个是对的？

例如，这篇文章指出了`video/m4v`mimetype：[http ://html5center.sourceforge.net/make-your-html5-video-play-on-mobile-devices](http://html5center.sourceforge.net/make-your-html5-video-play-on-mobile-devices)

这篇文章指出`video/mp4`： http: [//www.coolestguyplanettech.com/use-html-5-video-on-all-browsers/](http://www.coolestguyplanettech.com/use-html-5-video-on-all-browsers/)

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-03-07T18:58:37.083

标准媒体类型是`video/mp4`.

标准 mp4 容器格式通常用于 AAC 音频和 H.264 视频 + AAC 音频。它们具有不同的媒体类型，`audio/mp4`并且`video/mp4`通常您需要不同的音频和视频应用程序，并且在某些系统上，只能将默认应用程序与文件扩展名相关联。`.m4a`因此，在某些圈子中，在 mp4 容器中分别使用扩展和`.m4v`音频和视频（+音频）变得流行。但是，这不会影响媒体类型，它已经使用音频或视频前缀区分这些。

然而，一个转折是，Apple 开始使用他们自己的媒体类型 ,`video/x-m4v`用于他们商店中的视频，这些视频位于 mp4 容器中并使用`.m4v`扩展名。默认情况下设置为在 iTunes 中打开视频。有时这是必要的，因为视频使用 DRM、AC-3 杜比数字音频或 mp4 容器中通常不支持的其他功能，但 iTunes 支持[带有`.m4v`扩展名](https://handbrake.fr/docs/en/latest/technical/containers.html)的文件。如果您依赖此类功能，那么您可能希望使用此媒体类型而不是标准媒体类型。

没有的媒体类型`x-`在 RFC 中标准化并由 IANA 跟踪。`video/m4v` [没有标准化](https://www.iana.org/assignments/media-types/media-types.xhtml#video)名称的媒体类型。非标准媒体​​类型有一个`x-`前缀。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-10-15T04:38:22.293

我只为特殊项目编写 HTML5，但我遇到了一个问题，我很偶然地解决了这个问题。在我的块中，我正在编写这样的视频代码：

```
 <source src="Videos/myvideo.mp4" type="video/mp4">
        <source src="Videos/myvideo.webm" type="video/webm"> 
```

这是我的问题：如果我把 mp4 线放在第一位，谷歌浏览器会播放视频部分，但不会有**声音**。如果我把 webm 线放在第一位，谷歌浏览器会正确播放视频和声音，但苹果 Safari 根本不会检测到视频。即使我在 type= 语句中添加了编解码器信息，也没有效果。

我正要屈服并尝试使用 Flash，但我碰巧找到了解决方案，主要是偶然的。在 mp4 行中，我将 type="video/mp4" 替换为 type="video/m4v"。彻底解决了问题！注意：我没有**将视频文件扩展**名从 mp4 更改为 m4v——我只在 type= 语句中使用了 m4v。

我找不到任何文档来告诉我这样做，我只是对 .mp4 和 .m4v 文件扩展名之间的区别感兴趣，并开始玩弄。我使用 Linux (Xubuntu)，并使用 Openshot Video Editor 将视频创建为 webm 和 H.264 mp4 文件。也许 Openshot 的内部工作导致了这个问题，但无论如何——这就是我解决这个问题的方法。我的 mp4 视频播放完美。我希望这对其他人有所帮助——明尼苏达乔恩

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-04T20:12:40.160

8 年后通过在 Linux 上的 Brave`Version 1.22.70 Chromium: 89.0.4389.105 (Offizieller Build) (64-Bit)`和 Firefox进行实际测试来回答这个问题。`86.0.1 (64-Bit)`

```
<video controls="" controlslist="" preload="metadata">
    <source type="video/m4v" src="https://example.com/v.m4v">
</video> 
```

不工作。

但是`video/x-m4v`，`video/mp4`两者都适用于我正在测试的 m4v 文件。我想最好`x-m4v`根据接受的答案使用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-07T17:26:34.617

实际上，这完全取决于您使用的视频容器。大多数浏览器都支持 webm 和/或 mp4 文件格式。提供这两个源文件的组合可确保浏览器可以查看文件。如果您想包含它，还有 .ogg 格式。

不太确定 m4v 格式，但听起来它不是网络上常用的格式。无论如何，我会说为 m4v 提供视频/m4v MimeType 和 mp4 作为视频/mp4 MimeType。

# jquery-mobile - 使用 jQuery Mobile 触发复选框事件

> ID：15277149
> 
> 赞同：1
> 
> 时间：2013-03-07T16:57:26.363
> 
> 标签：jquery-mobile, checkbox, jquery

我正在使用 jQuery 1.8.3 和 jQuery Mobile 1.2.0。

我正在尝试实现[垂直分组的复选框](http://jquerymobile.com/demos/1.2.0/docs/forms/checkboxes/)。

我需要检测复选框上的更改。[此处](http://jsfiddle.net/Maxbester/z4UQC/)提供了一个示例。

但是，它在我的页面上不起作用（我没有给出，因为它包含太多依赖项但代码是相同的）。

基本上，当我单击复选框时，控制台中应显示以下消息：

```
INPUT
module1
----- 
```

而在我的页面中，我有：

```
FIELDSET
moduleListTitle
-----
DIV
moduleContainer
-----
DIV
(an empty string)
----- 
```

我花了几个小时试图找出事件未正确触发的原因。

有没有人已经面临这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T18:38:06.693

在实时测试代码之后 - 而不是在 JSfiddle 上 - 我已经达到了以下解决方案。

由于项目是动态添加的，因此您应该将事件绑定到`$(document)`并将处理程序绑定到`'input:checkbox.module'`.

下面是代码，希望能解决你的问题。

```
$(document).on('change','input:checkbox.module', function(){
 console.log(this.tagName);
 console.log(this.id);
 console.log("-----");
}); 
```

`trigger.('refresh')`这里不需要。

# javascript - 让一个简单的 javascript 在我在 Windows 中创建的 Linux 中工作

> ID：15277155
> 
> 赞同：0
> 
> 时间：2013-03-07T16:57:31.653
> 
> 标签：javascript, cross-platform

因此，我一直在尝试使用 .csv 文件作为数据源制作手机游戏脚本。它们在 Windows XP 到 Windows 8 中都可以正常工作。我在安装了 Imacros/Greasemonkey 的 Firefox 中使用它。然后我决定在 Linux Mint 14 中尝试并使用最新版本的 FF 和所有与之配套的应用程序进行设置。以下是我们（其他人和我，我被选为豚鼠）运行它时它只是冻结的脚本。没有错误或任何 FF 冻结并变得无响应，我必须强制关闭应用程序。我想就可能的原因获得一些反馈，如果有可用的修复方法，也许还有一些方向。

```
var numberOfUrls = 1591
var code = prompt("JUST CLICK OK DATA WILL OUTPUT UNDER iMacros/Downloads/extract.csv.")
while(true){
for(var i=1;i<numberOfUrls;i++){
var macro = "CODE: "
macro+= "SET !ERRORIGNORE YES"+"\n"
macro+= "SET !REPLAYSPEED fast"+"\n"
macro+= "SET !TIMEOUT_STEP 1"+"\n"
macro+= "SET !DATASOURCE ww_fresh_urls2.csv"+"\n"
macro+= "SET !DATASOURCE_COLUMNS 1" +"\n"
macro+= "SET !VAR1 "+code+"\n"
macro+= "SET !LOOP "+i+"\n"
macro+= "SET !DATASOURCE_LINE {{!LOOP}}"+"\n"
macro+= "URL GOTO={{!COL1}}"+"\n"
macro+= "WAIT SECONDS=.5"+"\n"
macro += "TAG POS=1 TYPE=DIV ATTR=CLASS:profileName EXTRACT=TXT" + "\n";
macro+= "WAIT SECONDS=.5"+"\n"
macro += "TAG POS=1 TYPE=SPAN ATTR=CLASS:codeCode EXTRACT=TXT" + "\n";
macro+= "WAIT SECONDS=.5"+"\n"
macro += "TAG POS=1 TYPE=DIV ATTR=CLASS:levelFrontTopArea EXTRACT=TXT" + "\n";
macro+= "WAIT SECONDS=.5"+"\n"
macro += "TAG POS=1 TYPE=SPAN ATTR=ID:cashCurrent EXTRACT=TXT" + "\n";
macro+= "WAIT SECONDS=.5"+"\n"
macro += "TAG POS=5 TYPE=SPAN ATTR=* EXTRACT=TXT" + "\n";
macro+= "WAIT SECONDS=.5"+"\n"
macro += "TAG POS=1 TYPE=A ATTR=TXT:home" + "\n"
macro+= "WAIT SECONDS=.5"+"\n"
macro+= "URL GOTO=http://wwar.storm8.com/setting.php?selectedTab=storm8"+"\n"
macro+= "WAIT SECONDS=.5"+"\n"
macro += "TAG POS=1 TYPE=TD FORM=ACTION:/setting.php?  formNonce=*&setTab1Badge=1&*                                                               ATTR=CLASS:usernameText EXTRACT=TXT" + "\n";
macro+= "WAIT SECONDS=.5"+"\n"
macro += "SAVEAS TYPE=EXTRACT FOLDER=* FILE=*" + "\n";
iimPlay(macro)
}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T17:07:41.340

> 当我运行它时它只是冻结。没有错误或任何 FF 冻结并变得无响应，我有

那么这是你的问题：

```
 while(true){ 
```

无限循环阻塞浏览器。你做了一些非常糟糕的事情，现在糟糕的事情发生了。

做点好事。我不知道你想做什么，但除非这是一个状态机，否则你不应该有一个无限循环。

# android - ListView getItemViewType() 的复杂示例

> ID：15277164
> 
> 赞同：10
> 
> 时间：2013-03-07T16:57:54.133
> 
> 标签：android, listview

我有一个`ListView`复杂的情况，因为有 4 种视图类型的可能场景，例如`{ book, movie, music cd, concert }`

目前，为了决定要膨胀的对象等，我得到了与列表行相关的项目。然后，我将对`switch()`对象的类型字段执行一个操作。

这给我留下了很多代码和繁重的`getView()`.

我是否正确地说`getItemViewType()`用于返回当前项目的正确视图类型？

我在哪里可以找到`ListAdapter`使用这种方法的示例？注意：这是为了消除我`ListView`现在非常缓慢的问题。

谢谢

**编辑：我的适配器**

```
public class MyListAdapter extends BaseAdapter implements ListAdapter {

    private Context ctx;
    private int layoutResourceId;
    private ArrayList<ItemType> items;

    public MyListAdapter(Context context, ArrayList<ItemType> data) {

        this.layoutResourceId = R.layout.timeline_item_row;
        this.ctx = context;
        this.setitems(data);
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        View row = convertView;
        TimelineHolder holder = null;
        ItemType transaction = getitems().get(position);

        if (row == null) {

            LayoutInflater inflater = ((Activity) ctx).getLayoutInflater();
            row = inflater.inflate(layoutResourceId, parent, false);

            holder = new TimelineHolder();
            holder.imgActivityIcon = (ImageView)row.findViewById(R.id.imgActivityImageIcon);
            holder.imgActivityLabel = (ImageView)row.findViewById(R.id.imgActivityImageLabel);
            holder.lblMerchantName = (TextView)row.findViewById(R.id.lblMerchantName);
            holder.lblLocation = (TextView)row.findViewById(R.id.lblLocation);
            holder.lblActivityType = (TextView)row.findViewById(R.id.lblActivityType);
            holder.lblActivityLabelUpper = (TextView)row.findViewById(R.id.lblActivityTypeLabel);
            holder.lblTimeSinceActivity = (TextView)row.findViewById(R.id.lblTimeSinceActivity);
            holder.lblActivityAmount = (TextView)row.findViewById(R.id.lblActivityAmount);

            row.setTag(holder);

        }
        else {

            holder = (TimelineHolder) row.getTag();
        }

        // Get/Populate common values here

        String address = "";

        Date hostTime = Helper.parse8601UTC(transaction.getCurrentHostTime());
        Date transactionTime = Helper.parse8601UTC(transaction.getHostTransactionTime());
        String merchantName = transaction.getMerchant().getName();

        holder.lblMerchantName.setText(merchantName);
        holder.lblLocation.setText(address);
        holder.lblTimeSinceActivity.setText(Helper.timeSince(transactionTime, hostTime));
        holder.lblActivityAmount.setText(Helper.doubleToCurrency(transaction.getAmount(), transaction.getCurrency()));

        switch (transaction.getTransactionTypeId()) {

        case TYPE_ONE:

            holder.imgActivityIcon.setImageResource(R.drawable.redemmedicon_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.earned_flag);
            holder.lblActivityType.setText(R.string.Loyalty_Earned);
            holder.lblActivityLabelUpper.setText(R.string.EARNED);
            holder.lblActivityAmount.setText(transaction.getResponsePoints() + " pts");

            break;

        case TYPE_TWO:

            holder.imgActivityIcon.setImageResource(R.drawable.prepay_icon_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.earned_flag);
            holder.lblActivityType.setText(R.string.Prepay_Redeem_Refund);
            holder.lblActivityLabelUpper.setText(R.string.REDEEMED);

            break;

        case TYPE_THREE:

            holder.imgActivityIcon.setImageResource(R.drawable.prepay_icon_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.earned_flag);
            holder.lblActivityLabelUpper.setText(R.string.REFUND);
            holder.lblActivityType.setText(R.string.Prepay_Purchase_Refund);

            break;
        case TYPE_FOUR:

            holder.imgActivityIcon.setImageResource(R.drawable.prepay_icon_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.earned_flag);
            holder.lblActivityLabelUpper.setText(R.string.REFUND);
            holder.lblActivityType.setText(R.string.Prepay_Deposit_Refund);

            break;

        case TYPE_FIVE:

            holder.imgActivityIcon.setImageResource(R.drawable.reward_earned_icon_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.earned_flag);
            holder.lblActivityType.setText(R.string.Reward_Redeemed);
            holder.lblActivityLabelUpper.setText(R.string.REDEEMED);
            holder.lblActivityAmount.setText("");

            break;

        case TYPE_SIX:

            holder.imgActivityIcon
                    .setImageResource(R.drawable.reward_earned_icon_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.redeemed_flag);
            holder.lblActivityType.setText(R.string.Points_Redeemed);
            holder.lblActivityLabelUpper.setText(R.string.REDEEMED);
            holder.lblActivityAmount.setText(transaction.getResponsePoints()
                    + " pts");

            break;

        case TYPE_SEVEN:

            holder.imgActivityIcon.setImageResource(R.drawable.stamp_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.redeemed_flag);
            holder.lblActivityType.setText(R.string.Checked_In);
            holder.lblActivityLabelUpper.setText(R.string.CHECK_IN);
            holder.lblActivityAmount.setText("");

            break;

        case TYPE_EIGHT:

            holder.imgActivityIcon.setImageResource(R.drawable.shared_icon_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.redeemed_flag);
            holder.lblActivityType.setText(R.string.Shared_Coupon);
            holder.lblActivityLabelUpper.setText(R.string.SHARED);
            holder.lblActivityAmount.setText("");

            break;

        case TYPE_NINE:

            holder.imgActivityIcon.setImageResource(R.drawable.prepay_icon_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.earned_flag);
            holder.lblActivityType.setText(R.string.Prepay_Deposit);
            holder.lblActivityLabelUpper.setText(R.string.DEPOSIT);

            break;

        case TYPE_TEN:

            holder.imgActivityIcon.setImageResource(R.drawable.prepay_icon_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.redeemed_flag);
            holder.lblActivityType.setText(R.string.Prepay_Purchase);
            holder.lblActivityLabelUpper.setText(R.string.PURCHASE);

            break;

        case TYPE_ELEVEN:

            holder.imgActivityIcon.setImageResource(R.drawable.prepay_icon_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.earned_flag);
            holder.lblActivityType.setText(R.string.Prepay_Redeemed);
            holder.lblActivityLabelUpper.setText(R.string.REDEEMED);

            break;

        case TYPE_TWELVE:

            holder.imgActivityIcon.setImageResource(R.drawable.prepay_icon_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.earned_flag);
            holder.lblActivityType.setText(R.string.Refund);
            holder.lblActivityLabelUpper.setText(R.string.REFUND);
            holder.lblActivityAmount.setText("");

            break;

        case TYPE_THIRTEEN:

            holder.imgActivityIcon.setImageResource(R.drawable.prepay_icon_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.earned_flag);
            holder.lblActivityType.setText(R.string.reversal);
            holder.lblActivityLabelUpper.setText(R.string.REVERSAL);
            holder.lblActivityAmount.setText("");

            break;

        case TYPE_FOURTEEN:

            holder.imgActivityIcon.setImageResource(R.drawable.unlocked_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.earned_flag);
            holder.lblActivityType.setText(R.string.Check_In_Reward_Unlocked);
            holder.lblActivityLabelUpper.setText(R.string.UNLOCKED);
            holder.lblActivityAmount.setText("");

            break;

        case TYPE_FIFTEEN:

            holder.imgActivityIcon.setImageResource(R.drawable.reward_earned_icon_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.earned_flag);
            holder.lblActivityType.setText(R.string.Coupon_Received);
            holder.lblActivityLabelUpper.setText(R.string.RECEIVED);
            holder.lblActivityAmount.setText("");

            break;

        default:

            holder.imgActivityIcon.setImageResource(R.drawable.stamp_2x);
            holder.imgActivityLabel.setImageResource(R.drawable.earned_flag);
            holder.lblActivityType.setText("");
            holder.lblActivityLabelUpper.setText("");
            holder.lblActivityAmount.setText("");

            break;
        }

        return row;
    }

    @Override
    public int getCount() {

        return getitems() == null ? 0 : getitems().size();
    }

    @Override
    public Object getItem(int position) {

        return getitems() == null ? null : getitems().get(
                position);
    }

    @Override
    public long getItemId(int position) {

        return layoutResourceId;
    }

    public void addItem(ItemType item, boolean addFirst) {

        if (addFirst) {

            getitems().add(0, item);
        } else {

            getitems().add(item);
        }

        notifyDataSetChanged();
    }

    public ArrayList<ItemType> getitems() {
        return items;
    }

    public void setitems(ArrayList<ItemType> items) {
        this.items = items;
    }

    public int getFirstTransactionId() {

        int result = 0;

        if (items != null && !items.isEmpty()) {

            ItemType txn = items.get(0);
            result = txn.getId();
        }

        return result;
    }

    public int getLastTransactionId() {

        int result = 0;

        if (items != null && !items.isEmpty()) {

            ItemType txn = items.get(items.size() - 1);
            result = txn.getId();
        }

        return result;
    }

    @Override
    public int getViewTypeCount() {

        return 1;
    }

    @Override
    public int getItemViewType(int position) {

        return 0;
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-07T17:05:22.653

*** 更新提示 ***
您没有正确实现 getViewTypeCount() 和 getItemViewType()。

阅读我在下面的链接中提供的教程。我不想重新解释它们，因为我会做得更糟。但请先阅读以下内容，因为您实际上并不需要它，因为您只有一种视图类型。

***选项 1***：使用正确的资源图像创建 16 个不同的行。然后在 getView() 方法中调用 getItemViewType(position)。在它上面做一个开关，并根据它返回的视图类型膨胀正确的行。（教程将对此进行解释）。这样你就不必一直调用“setImageResource”调用，这很昂贵。

***选项 2***：根据您的视图持有者，您似乎只有 1 个视图，而您只是更改 3 个文本字段和 2 个位图。但是每个位图调用都很繁重，你需要创建一个 HashMap 来缓存这些图标。每次调用时，引用哈希映射，如果该项目不存在，则创建它，添加它，然后继续。这很重要，因为对 setImageResource() 的每次调用都在进行位图解码，并且需要时间。***那是您真正错误的地方，***请参见下面的伪代码。

```
private static HashMap<Integer, Bitmap> cache;
static class BitmapCache {
    public static Bitmap get(Integer id) {
        if (cache.containsKey(id)) {
            return cache.get(id);
        } else {
            Bitmap t = BitmapFactory.decodeResource(getContext(), id);
            cache.put(key, t);
            return t;
        }
    }
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    ViewHolder item = null;
    Object o = getItem(position);

    View mRow = convertView;
    if (mRow == null) {
        LayoutInflater li = LayoutInflater.from(getContext());
        switch (getItemViewType(position)) {
        case VIEW_ONLINE:
            mRow = li.inflate(R.layout.row_online, parent, false);
            break;
        default:
            // default to sortable
            mRow = li.inflate(R.layout.row_offline, parent, false);
            break;
        }

        item = new ViewHolder(mRow);
        mRow.setTag(item);
    } else {
        item = (ViewHolder) mRow.getTag();
    }

    item.icon.setImageBitmap(BitmapCache.get(object.key));

    return mRow;
} 
```

*** 带有教程的旧答案 ***
我昨天刚刚浏览过的 StackOverflow 上已经有几篇与此相关的帖子。（见下面的链接）。

1.  是的，使用 getItemViewType() 检索正​​确的视图类型。据我了解，这里的真正好处在于 getView() 调用期间的视图优化。实现 getItemViewType() 允许 getView() 类型返回正确的缓存视图。
2.  将静态视图支架模式用于膨胀视图内的文本和图像视图。您不应该每次都夸大视图，您应该重用 getView() 调用提供的 convertView。
3.  一定要实现 getViewTypeCount()

这是一个教程，深入解释了如何执行自定义列表视图，包括优化。 [http://www.vogella.com/articles/AndroidListView/article.html](http://www.vogella.com/articles/AndroidListView/article.html)

这里有两个 stackoverflow 帖子，它们还讨论了您要做什么：
1\. [Android 编程教程 - 教程 5](https://stackoverflow.com/questions/11905689/android-programming-tutorials-tutorial-5)
2.[餐厅程序教程](https://stackoverflow.com/questions/12504306/restaurant-program-tutorial)

# sql-server - 全文未返回预期结果

> ID：15277165
> 
> 赞同：2
> 
> 时间：2013-03-07T16:57:54.430
> 
> 标签：sql-server, tsql, full-text-search

我对我们目前遇到的这个问题感到非常困惑。

我以前从未见过这种情况……也不知道为什么会这样。

```
SELECT DISTINCT p.MY_ID , MY_NAME
FROM MYTABLE p
WHERE CONTAINS( (p.MY_NAME), '"nn11"' ); 
```

my_name 列是全文索引的，并且`varchar(100)`

*   与`nn11`- 我得到 15 个结果都包含`11`在其中，但`nn`名称中没有字符......
*   与`n11`- 我得到 0 个结果
*   与`11`我得到与相同的 15 个结果`nn11`

问题是，结果中没有任何`n`字符，所以从技术上讲，我应该得到 0 个结果，但我有时得到结果的事实对我来说毫无意义......

我需要重建索引吗？有可能它已损坏吗？

提前致谢

这是附加信息

这些是我目前得到的结果....对于nn11和11，但对于n11 0结果...

```
MYID    MYNAME
------- ------- 
18546   11
18693   11
18747   11
18781   11
18799   11
18800   11
18873   11
18958   11
18989   11
18993   11
19069   11
19122   11
19124   11-B
19186   11-A
19407   11-A 
```

以及每次运行的结果：

```
nn11 - 0x006E006E00310031  1 0 1 Exact Match    nn11    0   nn11
n11 -  0x006E00310031      1 0 1 Exact Match    n11     0   n11
11-    0x00310031          1 0 1 Exact Match    11      0   11
       0x006E006E00310031  1 0 1 Exact Match    nn11    0   11 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T23:11:44.843

数字实际上以 nn 前缀存储在 FTI 中，这就解释了为什么搜索 nn11 会返回与 11 相同的结果，但不会返回 n11。似乎没有直接的解决方法，但在[http://social.msdn.microsoft.com/Forums/en-US/sqlsearch/thread/8592ea09-fcfb-4fec-a3a4-5e03dedcee3a/中描述了一种解决方法](http://social.msdn.microsoft.com/Forums/en-US/sqlsearch/thread/8592ea09-fcfb-4fec-a3a4-5e03dedcee3a/)

# sass - 有没有办法在 sublime 中自动保存每次击键？

> ID：15277166
> 
> 赞同：4
> 
> 时间：2013-03-07T16:57:55.280
> 
> 标签：sass, sublimetext2, frontend, sublimetext

我希望 sublime 在每次击键时保存我的文件，以用于实时重新加载。

最简洁的操作是在每次击键时自动保存，前提是文件具有有效的语法。

如果指南针任务足够快，那就像直接在 chrome 检查器中工作一样。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T19:24:02.453

您可以编写一个使用`on_modified`侦听器保存文件的插件。类似以下的东西可能会起作用（注意未经测试）

```
import sublime_plugin

class SaveOnModifiedListener(sublime_plugin.EventListener):
    def on_modified(self, view):
        view.run_command("save") 
```

如果你有一个 linter，你可以验证它，并且只保存干净的 lints。请注意，根据我发布的内容，对 sublime 中任何文件的任何编辑都将在每次击键时保存。您可能想要添加一些额外的检查，例如文件类型、是否存在于磁盘上等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-12T22:39:46.510

前段时间，当我尝试做一些非常快速的反馈原型设计时，我也有同样的需求，需要先保存文件，然后才能分析其输出。但是，这不是我在所有项目中都需要的东西。

幸运的是，我发现有一个优雅的插件可以满足需要 - 在每次修改后保存给定的文件 - 并通过简单的添加来做到这一点！您可以通过简单的组合键轻松启用和禁用适合您的功能。尽管与答案的其他地方相比，这只是一个小小的改进，但我希望它会帮助那里的人。

[有问题的插件是 auto-save](https://packagecontrol.io/packages/auto-save)，当然也可以通过 Sublime Package Control 安装。

# asp.net-mvc - 如何使用 Nunit 单元测试测试传递给 ASP .Net MVC4 中的函数的 Nullable 参数

> ID：15277171
> 
> 赞同：0
> 
> 时间：2013-03-07T16:58:09.117
> 
> 标签：asp.net-mvc, asp.net-mvc-4, nunit

我有一个看起来像这样的方法。

```
public ActionResult Index(int ? page)
    {
        List<Request> reqList = re.DisplayAll();
        const int pageSize = 5;

        if (!string.Equals(Request.HttpMethod,"GET"))
        {
            page = 1;
        }

        int pageNumber = page ?? 1;

        return View(reqList.ToPagedList(pageNumber,pageSize));
    } 
```

我的测试方法如下所示。

```
 public void testReviewReturn()
      {

          var controller = CreateReviewController();
          var reviewResult = controller.Index(1);

          Assert.IsInstanceOf( typeof(ViewResult), reviewResult);
      } 
```

现在，当我将 1 传递给 Index 函数时，它给了我一个异常，即存在空引用异常并且测试失败。我不确定如何测试这种方法。需要一些建议。我是使用 Nunit 和 ASP .Net MVC4 进行单元测试的新手

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T18:26:48.923

When you call the action method from your test project, Your ***Request*** will be null. So your If statement will throw an exception when running from the test project. Your code will work fine when you execute your action method using a browser.

What you should do is to mock the Request using some mocking frameworks. [This](https://stackoverflow.com/a/970272/40521) answers shows how to do it with Moq.

# linux - 如何使emacs在一个窗口中打开所有缓冲区（debian/linux/gnome）

> ID：15277172
> 
> 赞同：0
> 
> 时间：2013-03-07T16:58:10.797
> 
> 标签：linux, emacs, debian

在 osx 中，我通过将其放入 .emacs 中，使所有新的 emacs 缓冲区在同一个窗口/框架中打开。

(setq ns-pop-up-frames nil)

[使emacs在新缓冲区（非帧）中打开文件并被激活/出现在前面的别名？](https://stackoverflow.com/questions/6068819/alias-to-make-emacs-open-a-file-in-a-new-buffer-not-frame-and-be-activated-com)

我希望能够在 debian (gnome) 中做同样的事情。是否可以？非常感谢一个也适用于 xmonad（和类似的 wms）的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T18:21:32.873

`pop-up-frames`是一个标准的 emacs 变量：

```
pop-up-frames is a variable defined in `window.el'.
Its value is nil

Documentation:
Whether `display-buffer' should make a separate frame.
If nil, never make a separate frame.
If the value is `graphic-only', make a separate frame
on graphic displays only.
Any other non-nil value means always make a separate frame.

You can customize this variable. 
```

使用`customize`或放置这个

```
(custom-set-variables '(pop-up-frames nil)) 
```

进入你的`.emacs`.

当然，这只会影响 Emacs 显示缓冲区。如果您启动一个新的 Emacs，新进程将创建一个新窗口。显然，要实现您想要的，您需要将[Emacs 作为守护程序运行](http://www.emacswiki.org/emacs/EmacsAsDaemon)并使用`emacsclient`.

# ios - 如何设置 UIButton 图像的大小和位置

> ID：15277177
> 
> 赞同：0
> 
> 时间：2013-03-07T16:58:21.047
> 
> 标签：ios, objective-c, uibutton

UIButton，如何设置背景图片的大小和位置？

例如，如何更改大小并将图像放置在顶部`UIButton`

编辑：使用`setImageEdgeInsets:`例如修复的问题：

```
[button setTitleEdgeInsets:UIEdgeInsetsMake(0, -image.size.width, 0, 0)];
[button setImageEdgeInsets:UIEdgeInsetsMake(0, button.titleLabel.bounds.size.width, 0, 0)]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:21:09.197

如果您真的想缩放图像，请执行此操作，但您应该在使用之前调整它的大小。在运行时调整它的大小只会丢失 CPU 周期。

这是我用来缩放图像的类别：

UIImage+Extra.h

```
@interface UIImage (Extras)
- (UIImage *)imageByScalingProportionallyToSize:(CGSize)targetSize;
@end; 
```

UIImage+Extra.m

```
@implementation UIImage (Extras)

- (UIImage *)imageByScalingProportionallyToSize:(CGSize)targetSize {

UIImage *sourceImage = self;
UIImage *newImage = nil;

CGSize imageSize = sourceImage.size;
CGFloat width = imageSize.width;
CGFloat height = imageSize.height;

CGFloat targetWidth = targetSize.width;
CGFloat targetHeight = targetSize.height;

CGFloat scaleFactor = 0.0;
CGFloat scaledWidth = targetWidth;
CGFloat scaledHeight = targetHeight;

CGPoint thumbnailPoint = CGPointMake(0.0,0.0);

if (!CGSizeEqualToSize(imageSize, targetSize)) {

        CGFloat widthFactor = targetWidth / width;
        CGFloat heightFactor = targetHeight / height;

        if (widthFactor < heightFactor) 
                scaleFactor = widthFactor;
        else
                scaleFactor = heightFactor;

        scaledWidth  = width * scaleFactor;
        scaledHeight = height * scaleFactor;

        // center the image

        if (widthFactor < heightFactor) {
                thumbnailPoint.y = (targetHeight - scaledHeight) * 0.5; 
        } else if (widthFactor > heightFactor) {
                thumbnailPoint.x = (targetWidth - scaledWidth) * 0.5;
        }
}

// this is actually the interesting part:

UIGraphicsBeginImageContext(targetSize);

CGRect thumbnailRect = CGRectZero;
thumbnailRect.origin = thumbnailPoint;
thumbnailRect.size.width  = scaledWidth;
thumbnailRect.size.height = scaledHeight;

[sourceImage drawInRect:thumbnailRect];

newImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

if(newImage == nil) NSLog(@"could not scale image");

return newImage ;
}

@end 
```

您可以将其用于您想要的大小。喜欢 ：

```
[self.itemImageButton setImage:[stretchImage imageByScalingProportionallyToSize:CGSizeMake(20,20)]]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:17:37.930

AFAIK 没有这样的属性，但在我看来，您必须根据`UIButton`.

例如，您可以使用此代码

```
 UIImage *resultImage = [self imageByScalingAndCroppingForSize:CGSizeMake(button.frame.size.height,button.frame.size.width) : sourchImage]; 
```

缩放方法

```
- (UIImage*)imageByScalingAndCroppingForSize:(CGSize)targetSize:(UIImage *)srcimage
{
    UIImage *sourceImage = srcimage;
    UIImage *newImage = nil;        
    CGSize imageSize = sourceImage.size;
    CGFloat width = imageSize.width;
    CGFloat height = imageSize.height;
    CGFloat targetWidth = targetSize.width;
    CGFloat targetHeight = targetSize.height;
    CGFloat scaleFactor = 0.0;
    CGFloat scaledWidth = targetWidth;
    CGFloat scaledHeight = targetHeight;
    CGPoint thumbnailPoint = CGPointMake(0.0,0.0);

    if (CGSizeEqualToSize(imageSize, targetSize) == NO) 
    {
        CGFloat widthFactor = targetWidth / width;
        CGFloat heightFactor = targetHeight / height;

        if (widthFactor > heightFactor) 
            scaleFactor = widthFactor; // scale to fit height
        else
            scaleFactor = heightFactor; // scale to fit width
        scaledWidth  = width * scaleFactor;
        scaledHeight = height * scaleFactor;

        // center the image
        if (widthFactor > heightFactor)
        {
            thumbnailPoint.y = (targetHeight - scaledHeight) * 0.5; 
        }
        else 
            if (widthFactor < heightFactor)
            {
                thumbnailPoint.x = (targetWidth - scaledWidth) * 0.5;
            }
    }       

    UIGraphicsBeginImageContext(targetSize); // this will crop

    CGRect thumbnailRect = CGRectZero;
    thumbnailRect.origin = thumbnailPoint;
    thumbnailRect.size.width  = scaledWidth;
    thumbnailRect.size.height = scaledHeight;

    [sourceImage drawInRect:thumbnailRect];

    newImage = UIGraphicsGetImageFromCurrentImageContext();
    if(newImage == nil) 
        NSLog(@"could not scale image");

    //pop the context to get back to the default
    UIGraphicsEndImageContext();
    return newImage;
} 
```

# regex - 使用 RewriteCond %{QUERY_STRING} 而不将查询字符串附加到新地址

> ID：15277182
> 
> 赞同：11
> 
> 时间：2013-03-07T16:58:46.020
> 
> 标签：regex, .htaccess, mod-rewrite

我尝试使用 .htaccess 进行 301 重定向。

问题：

```
/?view=products&id=12345 -> /8831 
```

旧地址和新地址之间没有关系。

由于某些原因

```
Redirect 301 /?view=products&id=12345 /8831 
```

不起作用。如果我删除问号，它会在没有问号的情况下工作。

我也试过：

```
RewriteCond %{QUERY_STRING} view=products&id=12345
RewriteRule .*$ /8831 [L,R=301] 
```

但它会将我重定向到`/8831?view=products&id=12345`，这对我不利。我不需要新网址中的查询字符串-

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-07T17:00:54.680

```
RewriteCond %{QUERY_STRING} view=products&id=12345 
RewriteRule .*$ /8831? [L,R=301] 
```

结尾`?`将阻止附加原始查询参数，除非您也`[QSA]`再次给出标志。

从[手册](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewriterule)：

> 注意：查询字符串 Pattern 不会与查询字符串匹配。相反，您必须使用带有 %{QUERY_STRING} 变量的 RewriteCond。但是，您可以在包含查询字符串部分的替换字符串中创建 URL。只需在替换字符串中使用问号，即可指示应将以下文本重新注入到查询字符串中。***当您想删除现有的查询字符串时，只用问号结束替换字符串。***要将新查询字符串与旧查询字符串组合，请使用 [QSA] 标志。

# c# - 根据行内容对 DataGrid 中的各个行进行颜色编码

> ID：15277185
> 
> 赞同：0
> 
> 时间：2013-03-07T16:58:48.890
> 
> 标签：c#, sql, datagrid

我继承了一个 .NET 2.0 c# 项目，它执行以下操作：

*   执行 SQL 查询
*   将 SQL 结果绑定到 DataGrid

我找到了一些关于如何在 DataGridView 中实现这一点的信息，但这似乎不适用于 DataGrid（缺少 DataGridViews 所具有的方法/事件处理程序）。

我想要实现的是基于列的结果将列的背景颜色设置为红色（例如）。

有没有人有任何建议，转换为 DataGridView 将是唯一现实的选择（如果可能，我想避免这种情况！）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:07:06.280

您可以在 DataGrid 样式中使用多个`DataTriggers`。

```
<DataGrid Grid.Row="1" AutoGenerateColumns="True" VerticalAlignment="Top"  ItemsSource="{Binding Items}">
        <DataGrid.RowStyle>
            <Style TargetType="DataGridRow">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding ItemIndex}" Value="True">
                        <Setter Property="Background"  Value="Red"/>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ItemIndex}" Value="False">
                        <Setter Property="Background"  Value="Blue"/>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </DataGrid.RowStyle>
     ...
   ...
</DataGrid> 
```

更多信息在`DataTriggers`这里：http: [//msdn.microsoft.com/en-us/library/system.windows.datatrigger.aspx](http://msdn.microsoft.com/en-us/library/system.windows.datatrigger.aspx)

# ios - 从 mac 到 iPhone 的自动化 ssh

> ID：15277186
> 
> 赞同：0
> 
> 时间：2013-03-07T16:58:49.377
> 
> 标签：ios, macos, ssh

我正在为 iOS 开发一个工具，它基于 shell 脚本，将各种东西推送到设备，然后根据设备上推送的内容执行各种操作。

在这种情况下，该设备将是越狱的 iPhone。我想从 mac 连接到它。所以，我使用“usbmux”通过 USB 进行 ssh，效果很好。（干杯：D）

现在，问题是，假设密码是默认的“alpine”，我想完全自动化 ssh-ing 过程。避免用户交互。

这是我尝试过的，它没有给我预期的结果。

```
expect <<< 'spawn ssh root@localhost -p 2222; expect "*?password:*"; send "alpine\r";' 
```

我阅读了 ssh-keygen 和其他一些选项，但它们似乎需要初始手动交互。请帮我完全自动化这个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:09:18.950

找到解决方案..执行以下脚本

```
#!/usr/bin/expect
spawn ssh -q user@hostname
expect "assword"
send "alpine\r"
interact 
```

奇迹般有效！！:)

# logic - Double to Int 四舍五入，逻辑问题

> ID：15277192
> 
> 赞同：0
> 
> 时间：2013-03-07T16:59:05.010
> 
> 标签：logic

这更像是一个谜题/逻辑类型的问题，而不是一个编程问题——但我希望有人能提供帮助，因为我很难过。

我从一个整数开始，需要取其​​中的 X%。一旦我得到那个双数，我需要将它四舍五入到一个整数（称之为 Y）。我是否将它舍入实际上并不重要，而且我并不真正关心它的走向（向上或向下），因此使用地板/天花板将是一个可接受的解决方案——我只需要一个 int。

稍后在系统中，我将看到 int Y，并且需要知道原始数字是什么。在这一点上，如果我知道百分比是多少，并且我知道我用什么方法将 double 转换为 int - 我如何确定原始数字。

这需要适用于每个原始数字/百分比组合。

例子：

```
Original number: 997
Percentage: 90
Int-Conversion Method: Floor

997 * .90 = 897.3
floor(897.3) = 897
Y = 897 
```

.. .. 给定 897，并且知道百分比和 int 转换方法，我如何确定原始数字是 997？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:05:18.027

```
997 * .90 = 897.3
floor(897.3) = 897
Y = 897 
```

鉴于您建议的方法，我将解释为什么无法返回确切的数字，鉴于您提供的方法和数据。

计算百分比很好，你只剩下这个`double`值了。然后，您可以使用该`floor`函数有效地截断一些数据。截断不是[双射](http://en.wikipedia.org/wiki/Bijection)，所以你不能从 897 -> 897.3 回去，所以在一定程度上不可能重现原始数字。考虑到您提供的数据的规模，您不会大错特错，但是对于更大的值，或者对于需要更高精度的情况，您可能会发现这种方法很像猜测工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:05:10.423

你会使用公式

```
original number = calculated number / percentage 
```

使用您的号码

```
997 = 897 / 0.90 
```

在原计算和逆计算中，需要对答案进行四舍五入。

如果你不这样做，当你进行反向计算时，你会经常偏离。

# icalendar - 将评论/网址添加到 VCALENDAR

> ID：15277194
> 
> 赞同：1
> 
> 时间：2013-03-07T16:59:12.150
> 
> 标签：icalendar

我正在寻找一种在 icalendar 文件中指定 URL 或注释的方法，这些文件将由用户代理在某种详细信息或属性窗口中显示。（强调由用户代理显示）

我不想为单个事件指定它，而是为整个`VCALENDAR`元素指定。它应该适用于所有常见的用户代理。

我想用它来包含一个反馈 URL/电子邮件地址，用户无需检查原始文件即可发现。（ical 文件是我唯一的沟通渠道）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-08T14:45:23.763

I switched to using `X-WR-CALDESC` (and `X-WR-CALNAME`) to specify my description (and human readable name).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T09:42:45.357

您可能已经注意到，VCALENDAR 组件上定义的属性很少（[https://www.rfc-editor.org/rfc/rfc5545#section-3.7](https://www.rfc-editor.org/rfc/rfc5545#section-3.7)）。

有一个新的 IETF 草案扩展了这个列表。请参阅[https://datatracker.ietf.org/doc/html/draft-daboo-icalendar-extensions](https://datatracker.ietf.org/doc/html/draft-daboo-icalendar-extensions) 其中，一个 URL 属性是在 VCALENDAR 级别定义的，但它被定义为指向 iCalendar 流的源，而不是到一个解释性 URL。另一方面，您可能会在新定义的DESCRIPTION 属性中同时填充反馈URL 和电子邮件地址（或者如果您认为应该将反馈URL 属性添加到草稿中，则回复作者）。

至于使用这些属性的用户代理，这当然是另一回事了。我们在谈论哪些用户代理？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-04-06T21:12:28.043

关于我使用不同日历客户端的经验的一些笔记可能对其他人有所帮助。

iOS iCalendar 应用程序似乎可以识别 vCalendar 项目的描述字段中的 URL，并将它们转换为可点击的超链接。MS Outlook 也可以识别这些。例如

```
DESCRIPTION:Go here: http://stackoverflow.com \n 
```

一些客户端支持 vcalendar URL 属性，例如

```
URL:http://stackoverflow.com 
```

在 iOS iCalendar 应用程序中，这些会清楚地显示在 URL 字段中。

您可能还可以在 X-ALT-DESC 的 html 文档中嵌入锚标记，例如

```
X-ALT-DESC;FMTTYPE=text/html:<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//E
    N">\n<HTML><BODY><A HREF="http://stackoverflow.com">http://stackoverflo
    w.com</A></BODY>\n</HTML> 
```

显然，您需要在需要支持的所有客户端上测试 vcalendar 约会中的 URL。

可能还有其他方法可以添加 URL。

# java - 如何接收特定枚举的类型特定类？

> ID：15277196
> 
> 赞同：0
> 
> 时间：2013-03-07T16:59:19.843
> 
> 标签：java, generics, enums, converter

我需要某种 Converter-Mapper 并且没有想出任何好主意，如何轻松地使用特殊转换器附加枚举。我尝试了以下方法：

```
//ConverterInterface:
public interface PropertyConverter<T>
{
  public String convertObjectToString( T object );

  public T convertStringToObject( String string );
}

//Concrete Converter
public class FooConverter implements PropertyConverter<Foo>
{

  @Override
  public String convertObjectToString( Foo object )
  {
    throw new UnsupportedOperationException( "Not implemented yet." );
  }

  @Override
  public Foo convertStringToObject( String string )
  {
    throw new UnsupportedOperationException( "Not implemented yet." );
  }
}

//Dataclass
public class Foo
{
} 
```

Boo 也是如此，这里是枚举，我想将转换器附加到特定类型：

```
public enum PropEnum
{
  BOO(new BooConverter()),

  FOO(new FooConverter());

  PropertyConverter<?> converter;

  private PropEnum( PropertyConverter<?> converter )
  {
    this.converter = converter;
  }

  public PropertyConverter<?> getConverter()
  {
    return converter;
  }
} 
```

但是由于我的 PropertyConverter 使用通配符，当我像下面这样使用它时，我只得到对象到字符串和字符串到对象方法而不是具体类型，例如 Foo 到字符串和字符串到 Foo：

![枚举转换器](../Images/028de4a15ff3a618fbc1c9ba402b7815.png)

有没有办法从转换器实现中接收具体类型？

# javascript - 侦听器检测用户而不是 API 所做的地图更改

> ID：15277202
> 
> 赞同：3
> 
> 时间：2013-03-07T16:59:30.880
> 
> 标签：javascript, google-maps, google-maps-api-3

我需要检测用户在 Google 地图中所做的任何更改（放大、缩小、移动等），但当我通过 map.setZoom(zoom) 或 map.panTo(centerLocation) 等 API 更改地图时不会启动）。

我现在有了：

```
google.maps.event.addListener(map, 'idle', function ()
{
    var search = $("#Search").val();
    var categoryId = $("#Category_Id").val();

    if (search != "" && categoryId > 0)
        companyGetAllByCategoryOnMapMoveSubmit();
}); 
```

但它会通过用户缩放和 javascript map.setZoom(8) 启动，我只想听用户事件。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:11:28.927

保留一个状态变量，它可以识别监听器是如何被调用的。如果您调用了 API，则假设状态变量为真，否则为假。在您的侦听器中检查该状态变量，如果为真，则不执行任何操作并将状态变量设置为假。我是说

```
var globalState = false;
google.maps.event.addListener(map, 'idle', function ()
{
    if(!globalState) {
        var search = $("#Search").val();
        var categoryId = $("#Category_Id").val();

        if (search != "" && categoryId > 0)
            companyGetAllByCategoryOnMapMoveSubmit();
    }
    globalState = false;
}); 
```

现在，每当您调用 API 时，将 globalState 设置为 true

```
globalState = true;
map.setZoom(8) /* or any other API */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T21:31:29.137

我不知道 API 提供的可能性。

如果您必须处理多个事件（并且需要在 API 调用中跳过它们），另一种解决方案可能是在 API 调用之前禁用所有事件（从而删除它们）并在 API 调用完成后重新启用它们。

看看我的示例代码：

```
<!DOCTYPE html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <style>
        html, body, #map_canvas {
            margin: 0;
            padding: 0;
            height: 100%;
        }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
    <script>

        function initialize() {

            var mapOptions = {
                zoom: 8,
                center: new google.maps.LatLng(51.518998, -0.148315),
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };

            var map = new google.maps.Map(document.getElementById('map_canvas'),
                    mapOptions);

            var changeListener;

            function handleMapChange() {
                console.log("Handle map change done by user!");
            }

            function zoomOut(mouseEvent) {
                // disable all events that should not get fired
                disableUserEvents();
                // do API call
                map.setZoom(map.getZoom() - 1);
                // re-enable temporary disabled events when API operation finished
                google.maps.event.addListenerOnce(map, "idle", enableUserEvents);
            }

            function disableUserEvents() {
                console.log("disable User Events");
                google.maps.event.removeListener(changeListener);
                changeListener = undefined;
            }

            function enableUserEvents() {
                console.log("enable User Events");
                changeListener = google.maps.event.addListener(map, "idle", handleMapChange);
            }

            // enable user triggered events
            enableUserEvents();

            // the following rightclick listener will trigger an API call (zoomOut)
            google.maps.event.addListener(map, "rightclick", zoomOut);

        }

        google.maps.event.addDomListener(window, 'load', initialize);

    </script>
</head>
<body>
    <div id="map_canvas"></div>
</body> 
```

# sql - to_date ora-01847 月份中的某天必须介于 1 和该月的最后一天之间

> ID：15277203
> 
> 赞同：0
> 
> 时间：2013-03-07T16:59:32.783
> 
> 标签：sql, oracle, runtime-error

我正在尝试执行以下查询，但收到此错误：

`to_date ora-01847 day of month must be between 1 and last day of month`

查询是检查两个不同表中日期和时间的重叠

`table1 (emp_num1 number,start_date1 date,start_time1 varchar2,end_date1 date,end_time2 varchar2)`

`table2(emp_num2 number,start_date2 date,start_time2 varchar2,end_date2 date,end_time2 varchar2)`

```
select *
  from table1 t1
      ,table2 t2
 where t1.emp_num 1 = t2.emp_num2
   and to_timestamp(to_char(start_date1,'DD-MON-YYYY')||' '||NVL(start_time1,'00:00'),'DD-MON-YYYY HH24:MI')
       between
      to_timestamp(to_char(start_date2,'DD-MON-YYYY')||' '||NVL(start_time2,'00:00'),'DD-MON-YYYY HH24:MI')
       and
      to_timestamp(to_char(end_date2,'DD-MON-YYYY')||' '||NVL(end_time2,'00:00'),'DD-MON-YYYY HH24:MI')
      or
      to_timestamp(to_char(end_date1,'DD-MON-YYYY')||' '||NVL(end_time1,'00:00'),'DD-MON-YYYY HH24:MI')
       between
      to_timestamp(to_char(start_date2,'DD-MON-YYYY')||' '||NVL(start_time2,'00:00'),'DD-MON-YYYY HH24:MI')
       and
      to_timestamp(to_char(end_date2,'DD-MON-YYYY')||' '||NVL(end_time2,'00:00'),'DD-MON-YYYY HH24:MI') 
```

上述查询导致错误：

`to_date ora-01847 day of month must be between 1 and last day of month`

我尝试运行查询

```
select to_timestamp(to_char(start_date1,'DD-MON-YYYY')||' '||NVL(start_time1,'00:00'),'DD-MON-YYYY HH24:MI') from table1 
```

没有遇到错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T18:02:18.903

要重现错误：

```
SELECT NVL(SYSDATE,'00:00')
FROM DUAL 
```

> ORA-01847: 月中的某天必须介于 1 和月的最后一天之间

[NVL() 描述](http://docs.oracle.com/cd/E11882_01/server.112/e17118/functions119.htm)说：

> 参数 expr1 和 expr2 可以具有任何数据类型。如果它们的数据类型不同，那么 Oracle 数据库会隐式地将一种转换为另一种。如果它们不能被隐式转换，那么数据库会返回一个错误。隐式转换实现如下：
> 
> *   如果 expr1 是字符数据，则 Oracle 数据库将 expr2 转换为 expr1 的数据类型，然后再进行比较，并以 expr1 的字符集返回 VARCHAR2。
>     
>     
> *   如果 expr1 是数字，则 Oracle 数据库确定哪个参数具有最高的数字优先级，将另一个参数隐式转换为该数据类型，并返回该数据类型。

所以我们可以简化重现情况：

```
SELECT TO_DATE('00:00')
FROM DUAL 
```

由于您没有提供格式，因此假设`NLS_DATE_FORMAT`为 ，因此错误：'00' is not a valid day。

*（我真的不知道您要做什么，但您可以尝试使用纯日期函数。）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T19:47:26.447

您的格式需要修复。这是您的初始设置：

```
SELECT '07-MAR-2013' start_date -- char
     , NULL          start_time -- char
 FROM dual
/ 
```

最终格式 - 不需要 NVL。但是，如果您必须添加 NVL(start_time, '00:00')：

```
SELECT to_timestamp(start_date||' '||start_time, 'DD-MON-YYYY HH24:MI:SS') t_stamp
  FROM
  (
   SELECT '07-MAR-2013'      start_date -- char
        , NVL(NULL, '00:00') start_time -- char - NVL is optional 
    FROM dual
  )
 /

 3/7/2013 12:00:00.000000000 AM 
```

如果您删除 start_time compl，您将得到相同的结果。通常要比较日期，您应该使用 TRUNC 删除时间部分。

```
SELECT to_timestamp('07-MAR-2013', 'DD-MON-YYYY HH24:MI:SS') start_date_only 
  FROM dual
/   

3/7/2013 12:00:00.000000000 AM

 SELECT trunc(to_timestamp('07-MAR-2013', 'DD-MON-YYYY HH24:MI:SS')) start_date_only FROM dual
 /

3/7/2013 
```

# ios - 在登录时存储用户信息以供以后使用

> ID：15277208
> 
> 赞同：4
> 
> 时间：2013-03-07T16:59:46.843
> 
> 标签：ios, objective-c, xcode

我正在构建一个应用程序，在登录时，用户名/密码的正确组合会返回一些基本用户信息（名字、姓氏、用户类型、公司 ID 等）。

我将需要在整个应用程序中使用这些值和字符串来检索特定于用户的数据。

我可以在登录时将所有这些值和字符串存储在 NSObject 或 NSData 子类中，以便稍后调用它来检索我需要的项目吗？我怎样才能做到这一点？还是有更好的选择？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T17:12:47.897

如果您只是存储从成功登录返回的数据，如您所说的，名字，姓氏等。我会使用 NSUserDefaults。如果您打算存储任何敏感信息，例如用户名或密码或其他任何需要额外保密的信息，我建议您使用钥匙串。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-07T17:13:10.643

我会使用钥匙串，因为它是安全的。检查这个[STKeychain](https://github.com/ldandersen/STUtils/blob/master/Security/STKeychain.h)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-07T17:24:27.163

您可以使用`NSUserDefaults`. 创建用户模型。实施`NSCoding`协议。存储时存档，从 获取时取消存档`NSUserDefaults`。

```
@interface User: NSObject<NSCoding>

    @property (nonatomic, copy)   NSString *firstName;
    @property (nonatomic, copy) NSString *lastName;

    - (void)save;
    + (id)savedUser; 
```

//用户.m

```
#define kSavedUser @"SavedUser"

#pragma mark - Encoding
- (void)encodeWithCoder:(NSCoder *)encoder
{
    [encoder encodeObject:self.firstName forKey:@"FirstName"];
    [encoder encodeObject:self.lastName forKey:@"LastName"]

}

#pragma mark - Decoding
- (id)initWithCoder:(NSCoder *)decoder
{
    self = [super init];
    if (self)
    {
        _firstName   = [decoder decodeObjectForKey:@"FirstName"];
        _lastName   = [decoder decodeObjectForKey:@"LastName"];

    }
    return self;
}

-(void)save
{
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSData *data = [NSKeyedArchiver archivedDataWithRootObject:self];
    [defaults setObject:data forKey:kSavedUser];
    [defaults synchronize];
}

+ (id)savedUser
{
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSData *data = [defaults objectForKey:kSavedUser];
    if (data)
    {
        return [NSKeyedUnarchiver unarchiveObjectWithData:data];
    }
    return nil;
}

+ (void)clearUser
{
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    [defaults removeObjectForKey:kSavedUser];
    [defaults synchronize];
} 
```

现在您可以创建一个实例

```
User *user = [[User alloc]init];
user.firstName = @"";
user.lastName = @"";
[user save]; 
```

当你想找回

```
User *user = [User savedUser]; 
```

编辑：如果要清除数据，请调用静态方法以删除保存的用户信息

```
[User clearUser]; 
```

# java - Clojure REPL 未在 Windows 命令提示符下启动

> ID：15277210
> 
> 赞同：6
> 
> 时间：2013-03-07T16:59:52.847
> 
> 标签：java, emacs, clojure, classpath, read-eval-print-loop

我已将 clojure-1.4.0.jar 路径 (C:\clojure-1.4.0\clojure-1.4.0.jar) 放在我的 CLASSPATH 环境变量中。现在，当我尝试使用以下代码从命令行启动 REPL 时：

> `java -cp clojure-1.4.0.jar clojure.main`

我收到一个错误：

```
Error: Could not find or load main class clojure.main 
```

在我设置 emacs 之前它曾经工作过。有任何想法吗。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T20:04:47.940

您可以将 clojure jar 文件添加到`CLASSPATH`环境变量：

```
/some/where % CLASSPATH=/tmp/clojure-1.4.0.jar java clojure.main 
```

或直接在`java`参数中指定：

```
/some/where % java -cp /tmp/clojure-1.4.0.jar clojure.main 
```

设置`CLASSPATH`变量并同时`-cp`为命令提供参数`java`是没有意义的，因为`-cp`参数完全覆盖`CLASSPATH`。这是您的问题的原因：您似乎`java`不是从所在目录调用命令`clojure-1.4.0.jar`，因此`-cp clojure-1.4.0.jar`switch 使`java`程序尝试`clojure-1.4.0.jar`在当前目录中定位并忽略`CLASSPATH`。由于`clojure-1.4.0.jar`当前目录中没有，所以命令失败。

# jquery - 需要遍历 HTML 表单中的 id 并更改值

> ID：15277211
> 
> 赞同：0
> 
> 时间：2013-03-07T17:00:00.087
> 
> 标签：jquery, html, clone

我有一个表格，为了这个论坛，我已经简化了：

```
<form id="data0">
    <input id="name0" />
    <input id="address0" />
</form> 
```

使用 jQuery 我需要 clone() ，然后将克隆表单的 id 更改为 name1、address1 等。

有没有办法在不单独更改它们的情况下做到这一点：

```
$('#data0').children('#name0').attr('id', 'name1'); 
```

就像遍历所有输入并将“0”更改为“1”一样。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:18:50.043

您将首先使用`.clone()`jQuery 中的 api 来克隆表单`#data0`。然后迭代表单内部的输入元素，替换id并清除值，包括表单id。之后，将新表格放置到正文中。因此，您应该有一个计数器，用于在单击添加按钮时增加表单 ID。

以下示例使用`data0`表单作为克隆新表单的基础。

HTML

```
<input type="button" value="Add form" id="addBtn"/>

<form id="data0">
    <input id="name0" />
    <input id="address0" />
</form> 
```

JavaScript

```
function ReplaceID(element, suffix) {
 var newId = $(element).attr('id').replace(/0/,suffix);
 $(element).attr('id', newId);
 $(element).val(newId); // for demo use, change to '' to reset value
}
var formNewId = 1;
$("#addBtn").on('click', function(){
    var newForm = $("#data0").clone();
    $('input', newForm).each(function(index,element){ // iterate input element inside the form
        ReplaceID(this, formNewId); // replace id

    }); 
    ReplaceID(newForm, formNewId); // replace the id of cloned form
    $("body").append(newForm);
    formNewId++;
}); 
```

工作示例：http: [//jsfiddle.net/TfDUE/1/](http://jsfiddle.net/TfDUE/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:18:25.347

像这个例子一样使用：

```
<form id="old">
    <textarea>Some Value</textarea>
    <input type="text" value="Some Value" />
    <input type="checkbox" value="bob" checked />
    <br />
</form>

<input type="button" value="Clone" id="clone" /> 
```

这个 jQuery 工作，包括 textareas：

```
$( 'input#clone' ).click(
    function()
    {
      $( 'form#old textarea' ).text( $( 'form#old textarea' ).val() )
      $("form#old").clone().attr( 'id', 'new_form' ).appendTo("body")

    }

  ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:37:03.593

这是解决方案只需取出`console.log`and `alert`：

```
$(":input").each(function() { //get all inputs

newId = $(this).attr('id');

   $(this).attr('id', newId.replace('0', '1')); 
    console.log($(this).attr('id'));
    alert($(this).attr('id'));
}); 
```

[http://jsfiddle.net/yKZPK/](http://jsfiddle.net/yKZPK/)

# python - 搜索 Shodan API 时的错误处理

> ID：15277215
> 
> 赞同：0
> 
> 时间：2013-03-07T17:00:06.280
> 
> 标签：python, python-2.7, shodan

我正在尝试编写一个 Python 脚本来搜索 Shodan API 并返回 ID、CVE 和描述。由于我的一些搜索结果（例如“java”）没有已建立的 CVE（或 CVE 密钥），因此我的脚本会阻塞。我知道我需要将搜索包装在 try/except 错误处理中，但我没有任何运气能够找到研究网络的内容。这是我得到的错误，下面是代码。首先十分感谢。

- - - - 错误 - - - -

```
 print '%s: %s: %s' % (exploit['id'], exploit['cve'], exploit['description'])
KeyError: 'cve 
```

--------我的代码------

```
from shodan import WebAPI
api = WebAPI("my shodan key")

user_selection = raw_input("Enter something: ")
print "searching for", (user_selection),"....."

results = api.exploitdb.search(user_selection)

for exploit in results['matches']:
    print '%s: %s: %s' % (exploit['id'], exploit['cve'], exploit['description']) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:25:48.203

看起来您想要使用`dict.get`并为其提供一个默认值，以便在密钥不存在的情况下返回：

```
print '%s: %s: %s' % (exploit.get('id', '[blank]'), exploit.get('cve', '[blank]'), exploit.get('description', '[blank]')) 
```

# javascript - 在 $(document).ready(...) 旁边加载一次？jQuery

> ID：15277220
> 
> 赞同：-2
> 
> 时间：2013-03-07T17:00:14.173
> 
> 标签：javascript, jquery

我在触发一个只需要加载一次的函数时遇到问题。但我不想将其放入：

```
jQuery(document).ready(function ($) {

}); 
```

我想单独运行它。

我努力了：

```
 jQuery(document).one(function () {
        myfunction();
    }); 
```

和其他一些东西。但无法解决。

**更新：**

我在 ready() 上有我的网络服务：

```
jQuery(document).ready(function ($) {
    PageMethods.myWebSer(suc, fail);
});

function suc(){
//I want to run my function here , but only one time
//Examplle
 //jQuery(document).one(function () {
          //  myfunction();
       // });
} 
```

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:02:46.343

只需添加另一个`ready`或`load`函数：您可以拥有任意数量的函数，它们都将按顺序调用：

```
jQuery(document).ready(function() {
   // this will be run
});
jQuery(document).ready(function() {
   // and this one too (after the other one)
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:02:07.633

您希望它运行`onload`使用：

```
jQuery(window).load(function () {
    // run
}); 
```

请记住，`ready`fires*之前* `load`。

# angularjs - 从AngularJS中的指令加载HTML时手表不起作用

> ID：15277224
> 
> 赞同：0
> 
> 时间：2013-03-07T17:00:20.447
> 
> 标签：angularjs

我根据 URL 的路由在 Angular 中加载部分内容。

当我加载部分时，它会加载并响应控制器功能。但是我有一个有观察者的指令。这在我使用时不起作用

当我在主页中加载 HTML 时，它工作正常。我在这里有一个 Plunker [http://plnkr.co/edit/DK33pIrp0HyhUOjwm5X2?p=preview](http://plnkr.co/edit/DK33pIrp0HyhUOjwm5X2?p=preview)

基本上点击“hello”应该改变 $scope.origin 并且观察者应该触发它的事件。它不是。

我的 HTML：

```
<!DOCTYPE html>
<html ng-app="App">

  <head lang="en">
    <meta charset="utf-8">
    <title>Custom Plunker</title>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.3/angular.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <script>
      document.write('<base href="' + document.location + '" />');
    </script>
    <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/coffee-script/1.1.2/coffee-script.min.js"></script>
    <script src="app.js"></script>
    <script src="directive.js"></script>
  </head>

  <body ng-controller="MapCtrl">
    <ng-view></ng-view>
  </body>

</html> 
```

应用程序.js

```
var app;

app = angular.module("App", []);

app.config(function($routeProvider) {
  return $routeProvider.when("/", {
    templateUrl: "home.html",
    controller: MapCtrl
  });
});

this.MapCtrl = function($scope) {
  return $scope.clicked = function() {
    console.log("clicked");
    $scope.origin = Math.floor(Math.random() * 11);
    return console.log($scope.origin);
  };
}; 
```

指令.js

```
(function(angular) {
  var app;
  app = angular.module("App");
  return app.directive("leaflet", function() {
    return {
      restrict: "E",
      replace: true,
      transclude: true,
      template: "<section id='map' class='map'></section>",
      scope: {
        origin: "=origin"
      },
      controller: function($scope, $attrs) {
        return $scope.$watch("origin", (function(newValue, oldValue) {
          return alert("its changed");
        }), true);
      }
    };
  });
})(angular); 
```

主页.html

```
<button ng-click="clicked()">hello</button> 
```

我怎样才能让它工作？

编辑：我刚刚制作了这个纯 JS 而不是咖啡脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T11:46:42.640

感谢所有帮助我找到问题的人。

这可以通过设置

```
<button ng-click="clicked()">hello</button> 
```

至

```
<button ng-click="$parent.clicked()">hello</button> 
```

这是因为 ng-view 将是一个孩子。这个简单的修复程序现在正在工作。

# ios - 从 iPhone 检索最后几张照片

> ID：15277225
> 
> 赞同：1
> 
> 时间：2013-03-07T17:00:25.597
> 
> 标签：ios, objective-c

了解如何通过以下链接从 iOS 设备中检索最后一张照片

[如何从 iOS 上的相机胶卷中检索最近的照片？](https://stackoverflow.com/questions/10200553/how-to-retrieve-the-most-recent-photo-from-camera-roll-on-ios)

但是我想检索最后 20 张左右的照片，因为我不想降低性能，也不想让用户以相反的顺序查看他们的照片

我试过了

```
long index = group.numberOfAssets - 2; 
```

并以这个错误结束

> 由于未捕获的异常“NSRangeException”而终止应用程序，原因：“*** -[NSIndexSet initWithIndexesInRange:]：范围 {4294967294, 1} 超过 NSNotFound - 1 的最大索引值”

任何人都可以在这里提供帮助吗？谢谢

ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];

```
[library enumerateGroupsWithTypes:ALAssetsGroupSavedPhotos usingBlock:^(ALAssetsGroup *group, BOOL *stop) {

    [group setAssetsFilter:[ALAssetsFilter allPhotos]];

    ***long index              = group.numberOfAssets - 2;***
    [group enumerateAssetsAtIndexes:[NSIndexSet indexSetWithIndex:index]
                            options:0
                         usingBlock:^(ALAsset *alAsset, NSUInteger index, BOOL *innerStop) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:10:13.947

可能是您以错误的方式枚举。`This code gets the last image`

```
 ALAssetsGroup* group = [groups lastObject]; // get all assets groups, i think you know how to get them.
    [group enumerateAssetsAtIndexes:[NSIndexSet indexSetWithIndex:(group.numberOfAssets - 1)] options:NSEnumerationConcurrent usingBlock:^(ALAsset *result, NSUInteger index, BOOL *stop)
     {
         if(result) {
                  // result is your needed last asset
             }

     }]; 
```

# c# - 创建大量系统线程并等待 MRE 的影响？

> ID：15277228
> 
> 赞同：2
> 
> 时间：2013-03-07T17:00:32.803
> 
> 标签：c#, .net, multithreading, threadpool, manualresetevent

我正在尝试修复一个非常大的应用程序中的内存峰值。虽然我不确定这会对记忆产生多大影响，但我注意到以下几点：

*   应用程序使用自定义线程池来完成所有昂贵的任务
*   应用程序将执行所有传入的任务
*   任务可以由数千个子任务组成
*   虽然线程池一次只会执行 {T} 个任务，并在开始新任务之前完全完成一个任务，但它确实会创建一个新的系统线程（线程类）并为添加到其中的每个子任务启动它
*   子任务系统线程以线程启动方式启动，该线程启动会立即阻塞手动重置事件 (MRE)，等待线程池插槽释放

因此，这个线程池可以创建数千个线程，但是在其他任务完成时，除了 30 个（或您配置的任何内容）之外的所有线程都将在 MRE 上被阻塞。

**我的问题：**

* * *

在 MRE 上阻塞的一千个线程会对内存/处理器产生什么影响？我没有太多时间来修复这个峰值，所以如果它是最小的，我宁愿留下这个问题，并在我有更多时间的时候在以后的补丁中修复它。

此外，这种行为在线程池中是典型的，还是听起来有缺陷（我倾向于有缺陷，但我没有足够好的背景来确定）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:38:49.183

> 在 MRE 上阻塞的一千个线程会对内存/处理器产生什么影响？我没有太多时间来修复这个峰值，所以如果它是最小的，我宁愿留下这个问题，并在我有更多时间的时候在以后的补丁中修复它。

每个线程在手动创建时都有自己的堆栈分配给它。默认情况下，这将是每个线程 1MB，尽管可以[通过构造函数参数使线程具有更小的堆栈](http://msdn.microsoft.com/en-us/library/5cykbwz4.aspx)。

你最好重新设计这个，从你的问题的描述，使用标准的 ThreadPool 和一个喜欢`BlockingCollection<T>`处理你的节流的类。这旨在直接允许边界输入，并带有阻塞。与使用框架中包含的高度调整的 ThreadPool 相比，制作无限数量的线程的自定义“线程池”效率要低得多。

> 此外，这种行为在线程池中是典型的，还是听起来有缺陷（我倾向于有缺陷，但我没有足够好的背景来确定）。

这绝对是有缺陷的。ThreadPool 的全部意义在于避免为每个请求创建一个线程，并为多个请求“池化”线程（重用它们）而无需重新创建它们。

# mysql - 用户作为数据库用户或用户作为用户表、审计表中的一行。

> ID：15277238
> 
> 赞同：2
> 
> 时间：2013-03-07T17:00:55.267
> 
> 标签：mysql, triggers, audit

所以，我一直在开发一个网络应用程序并遇到了这个问题......

我需要审核对数据库表所做的每一项更改，但由于我只有一个数据库用户，但我的用户表中有很多用户，我不知道如何将执行该操作的确切用户保存到审核表中更改（因为我使用 mysql 触发器执行此操作，并且触发器保存了登录的数据库用户）。

如果我不了解细节，例如，我将无法知道哪个员工更改了某些数据，我只会知道它是由员工制作的。

解决这个问题的最佳方法是什么？

每个用户拥有一个数据库用户是一种好习惯吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:06:05.640

*每个用户拥有一个数据库用户是一种好习惯吗？*

不

有一个用户表，并在审计表中使用用户 ID（来自用户表）标记项目。

# java - JSP 在我的 WEB-INF/lib 和构建路径中找不到 JDBC 驱动程序

> ID：15277239
> 
> 赞同：1
> 
> 时间：2013-03-07T17:00:58.687
> 
> 标签：java, jsp, servlets

早上好，

这是我的 JSP 代码（注意，它只是来自 Oracle 示例应用程序页面的稍微修改的源代码：http: [//docs.oracle.com/cd/A97336_01/buslog.102/a83726/sampapp2.htm](http://docs.oracle.com/cd/A97336_01/buslog.102/a83726/sampapp2.htm)）

```
<%@ page import="java.sql.*" %>

<HTML>
<HEAD> <TITLE> The JDBCQuery JSP  </TITLE> </HEAD>
<BODY BGCOLOR=white>

<% String searchCondition = request.getParameter("cond"); 
if (searchCondition != null) { %>
  <H3> Search results for : <I> <%= searchCondition %> </I> </H3>
  <%= runQuery(searchCondition) %>
  <HR><BR>
  <% }  %>

<B>Enter a search condition:</B>
<FORM METHOD=get> 
<INPUT TYPE="text" NAME="cond" SIZE=30>
<INPUT TYPE="submit" VALUE="Ask Oracle">
</FORM>
</BODY>
</HTML>
<%! 
 private String runQuery(String cond) throws SQLException {
Connection conn = null; 
 Statement stmt = null; 
 ResultSet rset = null; 
 try {
    DriverManager.registerDriver(new oracle.jdbc.driver.OracleDriver());
    conn = DriverManager.getConnection((String)session.getAttribute  ("url"),
                                             "username", "pw");
          stmt = conn.createStatement();
          rset = stmt.executeQuery ("SELECT ename, sal FROM scott.emp "+ 
                                    (cond.equals("") ? "" : "WHERE " + cond ));
         return (formatResult(rset));
      } catch (SQLException e) { 
          return ("<P> SQL error: <PRE> " + e + " </PRE> </P>\n");
      } finally {
               if (rset!= null) rset.close(); 
               if (stmt!= null) stmt.close();
               if (conn!= null) conn.close();
      }
        }

   private String formatResult(ResultSet rset) throws SQLException {
     StringBuffer sb = new StringBuffer();
     if (!rset.next())      
       sb.append("<P> No matching rows.<P>\n");
     else {  sb.append("<UL><B>"); 
          do {  sb.append("<LI>" + rset.getString(1) + 
                             " earns $ " + rset.getInt(2) + ".</LI>\n");
             } while (rset.next());
          sb.append("</B></UL>"); 
     }
     return sb.toString();
   }
 %> 
```

错误发生在以下行：

```
 DriverManager.registerDriver(new oracle.jdbc.driver.OracleDriver());
    conn = DriverManager.getConnection((String)session.getAttribute("url"),
                                             "username", "pw"); 
```

session 抛出异常的地方。请注意，在 oracle 代码中使用 getValue 而不是 getAttribute，但 get Value 是贬值的。我试过使用 Class.forName() 语句；但是，这似乎并不能解决问题。这段代码有什么我忽略的吗？任何帮助将不胜感激。我使用 ojdbc14.jar 包。

编辑包括错误：

```
org.apache.jasper.JasperException: Unable to compile class for JSP: 

An error occurred at line: 28 in the jsp file: /PGS/JDBCQuery.jsp
session cannot be resolved
 25:      ResultSet rset = null; 
 26:      try {
 27:         DriverManager.registerDriver(new oracle.jdbc.driver.OracleDriver());
 28:      conn = DriverManager.getConnection((String)session.getAttribute       ("url"),
 29:                                            "username", "pw");
 30:         stmt = conn.createStatement();
 31:         rset = stmt.executeQuery ("SELECT ename, sal FROM scott.emp"+ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T17:20:00.183

问题与驱动无关。您的代码无法编译，因为您正在定义一个使用`session`不存在变量的方法。它不是局部变量，也不是方法的参数，也不是 JSP 的字段。

我的建议：停止使用 scriptlet，并将此代码放在 Java 类中。JSP 是视图组件。它们只能用于生成标记，使用 JSP EL、JSTL 和其他自定义标记。数据访问代码应该在单独的类中，从实现为 servlet 的控制器调用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T17:25:54.013

问题与驱动无关。

您的所有数据逻辑都在 JSP 声明标记 (<%! %>) 内。里面的代码将被添加到将由您的代码生成的 servlet。在这种情况下，**会话**变量不存在。

如果您将声明 (<%! %>) 更改为简单的脚本 (<% %>)，那么您尝试完成的工作将起作用，因为在该上下文中**会话**变量确实存在并且会按您的预期工作。

但是，正如大家已经告诉过您的，您不应该将 scriptlet 添加到您的 jsp 页面中。对 jsp 文件使用带有 RequestDispatcher 的 servlet，并避免将任何类型的 java 代码添加到 jsp 文件中。

# vim - 改变 vim '排水沟' 颜色

> ID：15277241
> 
> 赞同：66
> 
> 时间：2013-03-07T17:01:14.443
> 
> 标签：vim

请参阅下面我如何配置 vim 的屏幕截图。'gutter' 即 '+' 和 '~' 符号出现的地方显示了我的 git 状态，使用这个惊人的 vim 崇高文本端口：[https ://github.com/airblade/vim-gitgutter](https://github.com/airblade/vim-gitgutter)

![](../Images/9773526a4bb3a419498566ed967a39d2.png)

如何更改没有“+”/“~”符号的装订线颜色？即灰色部分？这是您更改数字列的方式：[VIM 初始设置：更改左侧行号的背景颜色？](https://stackoverflow.com/questions/250652/vim-initial-settings-change-backgound-color-for-line-number-on-the-left-side)但我找不到如何更改“排水沟”颜色。

有任何想法吗？

非常感谢。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2013-03-07T18:02:24.200

这个“排水沟”被称为标志栏。（有关`:help signs`详细信息，请参阅。）与此列关联的突出显示组称为`SignColumn`，并且可以像这样设置（使用帮助部分中的示例）：

```
:highlight SignColumn guibg=darkgrey 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2015-02-05T00:14:13.700

要更改您的颜色，`~/.vimrc`以便您的排水沟与您的行号显示的颜色相同，请执行以下操作：

```
highlight clear SignColumn 
```

![在此处输入图像描述](../Images/a2d413f8688c20aec07f0c4ea405cced.png)

[git-gutter 文档](https://github.com/airblade/vim-gitgutter#sign-column)还有一些其他有用的建议。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2020-06-13T21:41:30.437

另一个没有提到的选择是完全消除符号列并将符号放入数字列。

将此添加到您的`~/.vimrc`

```
set signcolumn=number 
```

生产

[![签到号码栏](../Images/c8ec93c7ba776fac5b856900ea9a42f9.png)](https://i.stack.imgur.com/PEC5s.png)

[（这是在 iterm Vim 中使用带有Ale](https://github.com/dense-analysis/ale#faq-change-signs)插件的自定义符号）。

这在包含该功能的“完整”Vim 版本 7.4.2201 或更高版本中[可用](https://superuser.com/a/558885/476802)`+signs`（我使用 Homebrew 在 MacOS 上安装的版本）。

# c# - Membership.ValidateUser 很慢

> ID：15277242
> 
> 赞同：3
> 
> 时间：2013-03-07T17:01:16.973
> 
> 标签：c#, asp.net, performance, authentication, membership

我正在使用这些`System.Web.Sercurity.Membership`方法来处理我们网络服务的用户。在测试期间我对它非常满意，因为我们的数据库和 Web 服务驻留在同一台服务器上。

当数据库和 Web 服务移动到不同的服务器时，我们在使用`Membership.ValidateUser(username, password)`命令对用户进行身份验证时会遇到巨大的延迟。

配置文件详细信息：

```
type="System.Web.Providers.DefaultMembershipProvider, 
      System.Web.Providers, Version=1.0.0.0, Culture=neutral,    
      PublicKeyToken=*********" 
connectionStringName="BlaBlaConnection" 
enablePasswordRetrieval="false" enablePasswordReset="true" 
RequiresQuestionAndAnswer="false" requiresUniqueEmail="false"       
maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6"   
minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" 
applicationName="/" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T10:03:40.907

问题与数据库框的权限有关这篇文章有帮助：[https ://elgg.leeds.ac.uk/webteam/weblog/15385.html](https://elgg.leeds.ac.uk/webteam/weblog/15385.html)

我们的数据库人员将应用程序池标识和域机器标识添加到数据库框和授予读/写访问权限的 .NET 根目录中。

当服务器重新映像时，这些目录的 UNC 路径不在 C: 驱动器上，因此它们没有继承“正常”ACL 权限

当这被纠正时，时间下降了， **但**对于我想要的来说它仍然有点慢（平均大约 4 秒， `Membership.ValidateUser(username, password);` 并且`Roles.IsUserInRole(username, item.Role)`每小时负载为 10,000）

# c# - 从 C# 到 MySQL 执行 INSERT 语句的正确方法

> ID：15277244
> 
> 赞同：0
> 
> 时间：2013-03-07T17:01:17.823
> 
> 标签：c#, mysql, optimization, sql-insert

我创建了这个插入新记录的函数——我直接向它提交查询。我的问题 - 它是最优的吗？它是万无一失的并保证正常运行吗？如果不; 请指教。

```
static String Server = "";
static String Username = "";
static String Name = "";
static String password = "";

static String conString = "SERVER=" + Server + ";DATABASE=" + Name + ";UID=" + Username + ";PASSWORD=" + password + ";connect timeout=500000;Compress=true;";

public bool InsertSQL(String Query)
{
    int tmp = 0;
    try
    {
        using (MySqlConnection mycon = new MySqlConnection(conString))
        {
            using (MySqlCommand cmd = new MySqlCommand(Query, mycon))
            {
                mycon.Open();
                try
                {
                    tmp = cmd.ExecuteNonQuery();
                }
                catch
                {
                    if (mycon.State == ConnectionState.Open)
                    {
                        mycon.Close();
                    }
                }
                mycon.Close();
            }
        }
    }
    catch { return tmp > 0 == true ? true : false; }
    return tmp > 0 == true ? true : false;
} 
```

这是我在其他函数中创建并作为文本传递给插入函数的 SQL 插入。我愿意接受所有建议！

```
String insertSql = @"INSERT INTO `gps_unit_location`
            (`idgps_unit`,`lat`,`long`,`ip`,`unique_id`,
            `loc_age`,`reason_code`,`speed_kmh`,
            `VehHdg`,`Odometer`,`event_time_gmt_unix`,`switches`, `engine_on_off`, `dt`)
                VALUES
            (
            (Select idgps_unit from gps_unit where serial=" + serial + "),'" + lat + "','" + lon + "','" + IP + "','" + unique_id + @"',
            '" + LocAge_mins + "','" + ReasonCode + "','" + Speed + @"',
            '" + VehHdg + "','" + Odometer + "','" + EventTime_GMTUnix + "','" + Switches + "', '" + engine_on_off + @"', DATE_ADD(NOW(), INTERVAL 1 HOUR))
            "; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:29:22.273

我以您的代码为例构建了这个答案。请注意以下行：

```
cmd.Parameters.AddWithValue("@queryParam", Query); 
```

为潜在的 SQL 注入攻击编写代码始终是最佳实践，*即使它们不太可能发生*。

```
static String Server = "";
static String Username = "";
static String Name = "";
static String password = "";

static String conString = "SERVER=" + Server + ";DATABASE=" + Name + ";UID=" + Username  + ";PASSWORD=" + password + ";connect timeout=500000;Compress=true;";

public bool InsertSQL(String Query)
{
   int tmp = 0;
   try
   {
      using (MySqlConnection mycon = new MySqlConnection(conString))
      {
         using (MySqlCommand cmd = new MySqlCommand(Query, mycon))
         {
            mycon.Open();
            try
            {
                cmd.Parameters.AddWithValue("@queryParam", Query);
                tmp = cmd.ExecuteNonQuery();
            }

            catch
            {
                if (mycon.State == ConnectionState.Open)
                {
                    mycon.Close();
                }
            }
            mycon.Close();
         }
     }
 }
 catch { return tmp > 0 == true ? true : false; }
 return tmp > 0 == true ? true : false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T17:03:21.393

通过使这个如此通用，您将自己对[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)开放。我猜你必须直接构建查询并插入值。SQL 参数在这里会更好，您可能会传入 a `params`of `SqlParameters`，但这仍然依赖于发送的通用文本，并且仍然让您可以进行注入。

[这是一个 SQL 参数示例](http://www.dotnetperls.com/sqlparameter)

# c# - 使用 ClientBuildManager.CompileFile 就地编译

> ID：15277249
> 
> 赞同：13
> 
> 时间：2013-03-07T17:01:24.547
> 
> 标签：c#, asp.net, iis-7, .net-4.0

我正在一个网站上工作，我想在该网站上使用就地编译以使第一次点击速度更快。我想使用[`ClientBuildManager`](http://msdn.microsoft.com/en-us/library/system.web.compilation.clientbuildmanager.aspx). [`CompileFile`](http://msdn.microsoft.com/en-us/library/ms223215.aspx)进行就地编译的方法，以便我可以控制编译过程。由于各种原因，这是编译本网站的理想方式。

## 为什么 IIS 构建到“临时 ASP.NET 文件”下的不同子目录？

当我通过[`ClientBuildManager`](http://msdn.microsoft.com/en-us/library/system.web.compilation.clientbuildmanager.aspx). [`CompileFile`](http://msdn.microsoft.com/en-us/library/ms223215.aspx)为此目的构建的 exe 中的方法，输出将转到“临时 ASP.NET 文件”下的子目录。但是，当网站稍后被点击时，IIS 会在“临时 ASP.NET 文件”下的不同子目录下重建控件，从而使之前的就地编译变得毫无价值。

**注意**：在“临时 ASP.NET 文件”下的就地编译期间创建的程序集被单独保留（仍然存在）。

**注意**：就地编译程序集文件夹和 IIS 生成的程序集文件夹都在同一个“临时 ASP.NET 文件”目录下。

例子：

*   C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files\root\2ba591b9\[**就地编译文件夹名称**]
*   C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files\root\2ba591b9\[ **IIS 为网站生成的程序集**]\

## [`ClientBuildManager`](http://msdn.microsoft.com/en-us/library/system.web.compilation.clientbuildmanager.aspx). [`CompileFile`](http://msdn.microsoft.com/en-us/library/ms223215.aspx)配置

```
var buildParameter = new ClientBuildManagerParameter
   {
      PrecompilationFlags = PrecompilationFlags.Default,
   };
var clientBuildManager = new ClientBuildManager(
   RootVirtualPath, RootPhysicalPath, null, buildParameter);
...
clientBuildManager.CompileFile(relativeVirtualPath, callback); 
```

`RootVirtualPath`默认网站的“” 在哪里。`RootPhysicalPath`指向网站磁盘上的位置。 `relativeVirtualPath`格式为“~/myFile.aspx”。回调用于跟踪进度。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-12T00:57:46.057

我认为您所看到的实际上与`CompileFile`vs的使用无关`PrecompileApplication`。即，如果您要做同样的事情但调用`PrecompileApplication()`，您仍然会得到一个文件夹不匹配。

请注意，从技术上讲，您没有正确创建 CBM 对象。调用它的正确方法是依靠 IIS 信息来定位文件。去做这个：

*   `/LM/W3SVC/7/ROOT/`通过类似的东西`appVirtualDir`
*   为`appPhysicalSourceDir`

请注意，“7”只是一个示例。要获得正确的号码：

*   运行 inetmgr
*   转到站点的高级设置
*   查找站点 ID。这就是你想要的号码`/LM/W3SVC/ID/ROOT/`

我在记录中解释这一点，因为不幸的是，即使以这种方式，我也无法让文件夹匹配。这种情况可能只是在 ASP.NET 中被破坏了（它曾经可以工作！）。

另一种可能性是在服务器端进行。例如

*   在您的站点中包含一个页面，您将使用它来触发选择性预编译。
*   在那里，`BuildManager.GetCompiledType("~/myfile.aspx")`您要预编译的每个页面（或用户控件等）的 call 和类似调用。
*   当您想触发自定义预编译时，只需请求该页面

当然，还有一种低技术替代方案，只需提前请求您想要编译的页面来预热您的网站。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T16:42:21.523

Sam，答案是 David Ebbo 的答案和您的原始代码之间的交叉。

```
var buildParameter = new ClientBuildManagerParameter
   {
      PrecompilationFlags = PrecompilationFlags.Default,
   };
var clientBuildManager = new ClientBuildManager(
   RootVirtualPath, RootPhysicalPath, null, buildParameter);
...
clientBuildManager.CompileFile(relativeVirtualPath, callback); 
```

如果您按照 David Ebbo 所说的去做，并在构建 ClientBuildManager 时将其用于 RootVirtualPath：

`/LM/W3SVC/7/ROOT/`

然后，您必须为 RootPhysicalPath 传入 null。

这应该可以解决其他问题，并且应该构建到 IIS 正在寻找的同一目录中。

# javascript - 使用javascript检测选择结束位置

> ID：15277253
> 
> 赞同：5
> 
> 时间：2013-03-07T17:01:33.677
> 
> 标签：javascript, html, selection, right-to-left

我编写了一个代码来使用 javascript 检测选择的结束，并在结束位置放置一个标记。看到这个jsfiddle：http: [//jsfiddle.net/vCwwN/](http://jsfiddle.net/vCwwN/)

上面的代码执行以下操作：

*   它正确处理所有 LTR 脚本（例如英语）（正确显示末尾的标记）。
*   对于 LTR 脚本（例如英语）它处理选择是向前（从左/上到右/下）还是向后（从右/下到左/上）正确显示选择停止的标记（使用鼠标或键盘） .
*   它用于`getClientRects`查找所有选择矩形边界，并用于检测选择方向（是否向后）。根据这两个信息，它将标记放置在末尾。

您可以尝试为英文脚本选择上面描述的内容，没有任何问题。唯一的问题是当您尝试处理 RTL 脚本（例如阿拉伯语）时，标记会显示在所选 RTL 脚本的开头而不是结尾（鼠标/键盘实际停止的位置）。这些会导致问题：

*   在 RTL 脚本中开始选择（阿拉伯语），在 RTL 脚本中结束选择（阿拉伯语）。这会在选择开始时显示标记。
*   在 LTR 脚本（英语）中开始选择，在 RTL（阿拉伯语）脚本中结束选择。这会在 RTL 脚本选择的开头（而不是结尾）显示标记。

基本上，从任何地方开始（LTR 或 RTL）并以 RTL 脚本结束的选择是不正确的。任何其他情况都得到了正确处理（例如，以 LTR 或 RTL 开头并以 LTR 结尾，甚至在途中通过 RTL 脚本）。

问题是 RTL 脚本的流向是翻转的，因此向后是向前，向前是向后。这就是为什么我的代码无法正确处理 RTL 并且反向破解的原因。

我想到的一种解决方案是检测选择的最后一个字符，并查看它是否具有 RTL 脚本，然后基于此翻转后向标志。我已经放置了一个函数来检测文本是否以 RTL 字符结尾（它在同一个未使用的 jsfiddle 中）。它可能会帮助你，帮我解决它:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T18:53:01.790

看看这是否是朝着正确方向迈出的一步。

它利用以下代码从[Tim Down](https://stackoverflow.com/users/96100/tim-down)发布[的用户选择中返回 HTML](https://stackoverflow.com/a/6252212/2034234)：

```
function getSelectionHtml() {
    var html = "";
    if (typeof window.getSelection != "undefined") {
        var sel = window.getSelection();
        if (sel.rangeCount) {
            var container = document.createElement("div");
            for (var i = 0, len = sel.rangeCount; i < len; ++i) {
                container.appendChild(sel.getRangeAt(i).cloneContents());
            }
            html = container.innerHTML;
        }
    } else if (typeof document.selection != "undefined") {
        if (document.selection.type == "Text") {
            html = document.selection.createRange().htmlText;
        }
    }
    return html;
} 
```

一旦定义好了，你就可以调用`lastCharTRL`你定义的方法来检查最后一个字符是否是 RTL 并采取相应的行动。

```
if (lastCharRTL(getSelectionHtml()))
    $('#pointer').css({top: rects[n].top + 10, left: rects[n].left - 10}).show();
else if(backwards)
    $('#pointer').css({top: rects[0].top + 10, left: rects[0].left - 10}).show();
else
    $('#pointer').css({top: rects[n].top + 10, left: rects[n].right}).show(); 
```

**[演示](http://jsfiddle.net/64dtg/)**

# c# - 在两个不同的项目之间共享一个列表容器的可能性

> ID：15277254
> 
> 赞同：0
> 
> 时间：2013-03-07T17:01:34.123
> 
> 标签：c#, visual-studio-2010

我目前面临一个问题，我似乎无法解释。在我的 C# 解决方案中，我有三个项目 A、B 和 C。A 和 B 都引用项目 C，其中包含一个静态列表容器。现在，当项目 A 添加到容器时，项目 B 无法在容器中找到内容。有什么建议为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:05:13.700

`static`项目仅*在同一个 AppDomain*中共享。如果 A 和 B 在不同的空间中运行（两个不同的网站、控制台应用程序、WinForms 等等），它们将不会共享相同的内存空间。

如果你需要在两个不同的进程之间共享数据，你需要想出一种不同的方法来做到这一点。一些选项是：

*   使用数据库
*   使用文件
*   创建*托管*共享数据的 Web 服务
*   创建托管数据的 Windows 服务

每个人在开发时间/复杂性/可维护性/等方面都有其优点/缺点。

~~如果它们是两个不同的网站，您可以将它们设置为使用相同的 AppPool，并且它们*可以*共享静态变量（尽管我从未尝试过）。~~

编辑：根据进一步的研究，即使两个 Web 应用程序共享一个 AppPool，它们也会有不同的 AppDomains。（一个 AppPool 可以托管多个独立的 AppDomain）。

# vba - 保存并转到新记录后如何重置表单的格式

> ID：15277255
> 
> 赞同：2
> 
> 时间：2013-03-07T17:01:40.800
> 
> 标签：vba, ms-access, ms-access-2010

我有将记录添加到表中的表单。我有一些关于`AfterUpdate`组合框事件的 VBA 代码，它根据选择的值更改其他一些表单控件的可见性。

我还有一个保存按钮，单击时会运行此代码：

```
Private Sub btnSave_Click()

    On Error Resume Next
    DoCmd.RunCommand acCmdSaveRecord
    DoCmd.GoToRecord , "", acNewRec
    If (MacroError <> 0) Then
        Beep
        MsgBox MacroError.Description, vbOKOnly, ""
    End If

End Sub 
```

当我单击“保存”按钮时，在最后一条记录中可见的控件仍然可见。可以这么说，我想将所有控件“重置”为默认可见性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:14:27.377

使用表单`On Current`事件的过程。当您导航到不同的记录时，您可以将控件的可见性重置为您的默认选择。您还可以有条件地设置可见性......因此您可以根据当前记录的值设置给定控件的可见性。

# javascript - 帮助浏览器窗口会合 window.postmessage

> ID：15277261
> 
> 赞同：3
> 
> 时间：2013-03-07T17:01:48.727
> 
> 标签：javascript, html

我想让两个窗口使用 window.postMessage 进行通信。但是这些窗口没有初始连接——一个不是另一个的 iframe。有没有什么办法可以让这两个窗口“找到”对方，以便他们可以通信？窗口似乎没有任何方法可以通过“名称”查找另一个窗口。我可以安排两者在同一个域中设置 cookie，但无法将对象/指针放入 cookie。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T13:34:56.377

我错了！[HTML5 周刊](http://html5weekly.com/)刚刚问世，并包含了一篇文章的链接，[该文章解决了这个确切的问题](http://bens.me.uk/2013/localstorage-inter-window-messaging)。

该技术利用`localStorage`同一域上的所有窗口共享的可观察和可修改资源。事实证明，Facebook 和 Google 多年来一直在这样做！

[有一个演示](http://bens.me.uk/resources/localstorage-messaging/index.html)（并排在几个窗口中打开，这非常令人兴奋），代码非常易读，但核心机制如下：

广播事件

```
window.localStorage.setItem('key', value); 
```

监听事件

```
window.addEventListener('storage', function(event){
    var message = event.newValue;
} 
```

被这个吓坏了。我将不得不以某种方式自己实现这一点。

# eclipse - Eclipse OSX 键盘快捷键查找/替换

> ID：15277269
> 
> 赞同：0
> 
> 时间：2013-03-07T17:02:16.263
> 
> 标签：eclipse, macos, keyboard-shortcuts

在 Windows 中使用 Eclipse 多年，当我进行查找/替换时，我使用键盘组合，如 alt+d 和 alt+n 用于“替换下一个”/“查找下一个”。在 Mac 上似乎没有办法通过键盘快速完成此操作。我必须在我想要的按钮上跳动，这通常比使用鼠标要慢。怎么能有一个直接的键盘快捷键来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T18:48:40.950

不鼓励使用助记词：[https ://developer.apple.com/library/mac/#documentation/Java/Conceptual/Java14Development/07-NativePlatformIntegration/NativePlatformIntegration.html#//apple_ref/doc/uid/TP40001909-212166](https://developer.apple.com/library/mac/#documentation/Java/Conceptual/Java14Development/07-NativePlatformIntegration/NativePlatformIntegration.html#//apple_ref/doc/uid/TP40001909-212166)

我也讨厌

# asp.net-mvc - MVC 4：构建复合视图模型

> ID：15277272
> 
> 赞同：-4
> 
> 时间：2013-03-07T17:02:27.383
> 
> 标签：asp.net-mvc, linq

我是 ASP.NET MVC 的新手。我需要从三个嵌套或级联类中构建一个复合视图模型：Sport>Tournament>TournamentEvent

```
public class Sport
{
    public int Id { get; set; }
    public string SportName { get; set; }
    public virtual ICollection<Tournament> Tournaments { get; set; }
}

public class Tournament
{
    public int Id { get; set; }
    public string TournamentName { get; set; }
    public int SportId { get; set; }
    public virtual ICollection<TournamentEvent> TournamentEvents { get; set; }
}

public class TournamentEvent
{
    public int Id { get; set; }
    public string EventName { get; set; }
    public int TournamentId { get; set; }
} 
```

如您所知，每项运动都包含一组锦标赛，每项锦标赛都包含一组赛事。我需要构造一个无序列表，如下所示：

```
 <li> Soccer
        <li>English Premier League
            <li>Chelsea v Arsenal</li>
        </li>
    </li> 
```

我需要使用 linq 构建一个复合视图模型来传递给我的视图，但我就是想不通。请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T06:35:34.950

我认为这行不通，汤姆。我需要访问 Tournament 和 TournamentEvent 类，我需要将它们加载到我的对象中，这是 linq 的来源。在 SportsController 中：

```
public partial class SportsController : Controller
{
    private MyDb db = new MyDb();

public virtual ActionResult Index()
    {
      var menuObject = from s in db.Sports
                         select s;

      return View(menuObject);
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:06:52.030

你不只需要一个包含 Sport 列表的父 vie 模型吗？

```
public class Sport
{
    public List<Sport> Sports { get; set; }
} 
```

您可以使用 razor 遍历集合。

你能澄清一下你认为 linq 的作用吗？我可能弄错了棍子的一端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T14:10:22.980

创建一个名为 SportTournamentEventViewModel.cs 的类

使用“图书馆名称”。模型；

```
public class SportTournamentEventViewModel
{
    public List<Sport> Sports {get;set;}
    public List<Tournament> Tournaments {get;set;}
    public List<TournamentEvent> Events {get;set;}
} 
```

在你的行动中

```
private NameOfEntities db = new NameOfEntities();

public ActionResult "ActionResultName"()
{
    db.Configuration.LazyLoading = false;

    var sportList = db.Sport.ToList();
    var tournamentList = db.Tournament.ToList();
    var eventList = db.TournamentEvents.ToList();

    var viewModel = new SportTournamentViewModel
    {
        Sports = sportList,
        Tournaments = tournamentList,
        Events = eventList,
    };

    return View(viewModel);
} 
```

# iphone - 在两个选项之间进行选择？

> ID：15277275
> 
> 赞同：1
> 
> 时间：2013-03-07T17:02:39.743
> 
> 标签：iphone, cocoa-touch, uitableview, uisegmentedcontrol, uiswitch

在我当前应用程序的选项屏幕上，我想允许用户选择单位是否以“公制”或“英制”显示。我查看了 Google Maps 应用程序，他们使用分组的 UITableView 执行此操作，这对我的应用程序实际上不起作用，因为我正在 ITabBar 上的“选项”选项卡中显示各种配置选项。

![在此处输入图像描述](../Images/529bdc340d9356aa53fd4ee409b097ac.png)

我看过段控制，这似乎相当不错，但在阅读 Apple HIG 时，我注意到点击时每个段都旨在显示不同的视图。

![在此处输入图像描述](../Images/54a8c9c627079e84421ead5b3d6d8535.png)

我想我也可以使用默认值，然后使用 UISwitch 切换备用选项。

![在此处输入图像描述](../Images/15e01a890d2934f2d1356cfe3540bdf2.png)

我的问题是：在无 UITableView 中执行此操作的最佳方法是什么，是否有我缺少的控件，任何帮助/信息将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:52:04.157

使用分段控件会很好，我已经看到许多使用它进行选择的应用程序，并且我已经在几个应用程序中使用它以及 tableView 不适合的地方。

您也可以查看 UIPicker，但分段控件的优点是可以在较少的点击次数中设置选项，这始终是一个受欢迎的可用性特征。

# database - 使用 Zend Framework 2 和 DoctrineORMModule 连接到多个数据库

> ID：15277277
> 
> 赞同：4
> 
> 时间：2013-03-07T17:02:43.707
> 
> 标签：database, doctrine-orm, zend-framework2

您好，我正在使用 Zend Framework 2 和 DoctrineORMModule。我需要访问不同的数据库连接并映射两组不同的模式。

```
'doctrine' => array(
    'connection' => array(
        'orm_default' => array(
            'driverClass' => 'Doctrine\DBAL\Driver\PDODblib\Driver',
            'params' => array(
                'host'     => 'HOST',
                'port'     => '1433',
                'user'     => 'USER',
                'password' => 'PASS',
                'dbname'   => 'DBNAME',
            )
        )
    )
),
/////////////

'doctrine' => array(
        'connection' => array(
            'orm_default' => array(
                'driverClass' => 'Doctrine\DBAL\Driver\PDOMySql\Driver',
                'params' => array(
                    'host'     => '127.0.0.1',
                    'port'     => '3306',
                    'user'     => 'root',
                    'password' => 'root',
                    'dbname'   => 'test',
                )
            )
        ),
    ), 
```

我在文档中找到了这个： [https](https://github.com/doctrine/DoctrineORMModule/blob/master/docs/configuration.md#how-to-use-two-connections) ://github.com/doctrine/DoctrineORMModule/blob/master/docs/configuration.md#how-to-use-two-connections 但它的描述性不是很强。

谁能帮我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-30T11:11:16.743

```
use Doctrine\DBAL\DriverManager;
use Doctrine\ORM\EntityManager;
use Doctrine\ORM\Configuration;
use Doctrine\DBAL\Connection;

/**
 * @author  Rafał Książek
 */
class DbFactory
{

    /**
     * @var array 
     */
    protected $config;

    /**
     * @return array
     */
    public function getConfig()
    {
        return $this->config;
    }

    /**
     * @param array $config
     */
    public function __construct(array $config)
    {
        $this->config = $config;
    }

    /**
     * Create connection to database
     * 
     * @param string $dbName
     * @return \Doctrine\DBAL\Connection
     * @throws \InvalidArgumentException
     * @throws \Exception
     */
    public function getConnectionToDatabase($dbName)
    {
        $config = $this->getConfig();

        if (empty($config['doctrine']['connection']['orm_default']['params'])) {
            throw new \InvalidArgumentException('There is insufficient data in the configuration file!');
        }

        $params           = $config['doctrine']['connection']['orm_default']['params'];
        $params['dbname'] = $dbName;
        $params['driver'] = 'pdo_mysql';

        if (!($dbConnection = DriverManager::getConnection($params)))
            throw new \Exception('There was a problem with establish connection to client db');

        return $dbConnection;
    }

    /**
     * 
     * @param \Doctrine\DBAL\Connection $dbConnection
     * @param \Doctrine\ORM\Configuration $config
     * @return \Doctrine\ORM\EntityManager
     */
    public function getEntityManager(Connection $dbConnection, Configuration $config)
    {
        return EntityManager::create($dbConnection, $config);
    }

} 
```

如何使用：

```
$applicationConfig = $sm->get('config');
$em = $sm->get('Doctrine\ORM\EntityManager');
$emDefaultConfig = $em->getConnfiguration();

$dbFactory = new DbFactory($applicationConfig);
$anotherConnection = $dbFactory->getConnectionToDatabase('another_db');
$anotherEntityManager = $dbFactory->getEntityManager($anotherConnection, $emDefaultConfig);

$usersOnAnotherDb = $anotherEntityManager->getRepository('Application\Entity\User')->findAll(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-20T12:47:56.220

看看[链接](https://github.com/doctrine/DoctrineORMModule/issues/122)和[链接](https://github.com/doctrine/DoctrineORMModule/blob/master/docs/configuration.md)。不幸的是，似乎缺少使用语句。这些是具有 FQDN 的工厂：

```
'factories' => array(
        'doctrine.connection.orm_alternative' => new \DoctrineORMModule\Service\DBALConnectionFactory('orm_alternative'),
        'doctrine.configuration.orm_alternative' => new \DoctrineORMModule\Service\ConfigurationFactory('orm_alternative'),
        'doctrine.entitymanager.orm_alternative' => new \DoctrineORMModule\Service\EntityManagerFactory('orm_alternative'),
        'doctrine.driver.orm_alternative' => new \DoctrineModule\Service\DriverFactory('orm_alternative'),
        'doctrine.eventmanager.orm_alternative' => new \DoctrineModule\Service\EventManagerFactory('orm_alternative'),
    ), 
```

如果您只想访问另一个数据库（在同一服务器、同一用户等），您可以轻松地在实体中定义您的表，如下所示：

```
@ORM\Table(name="database.table") 
```

并为自己省去很多麻烦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T18:09:37.340

你可以在你的模块配置文件中为每个单独的模块设置这个数组配置

```
return array(
    'doctrine' => array(
        'orm_autoload_annotations' => true,

        'connection' => array(
            'orm_default' => array(
                'configuration' => 'orm_default',
                'eventmanager'  => 'orm_default',

                'params' => array(
                    'host'     => 'localhost',
                    'port'     => '3306',
                    'user'     => 'username',
                    'password' => 'password',
                    'dbname'   => 'database',
                )
            ),
        ),

        'configuration' => array(
            'orm_default' => array(

                'driver'            => 'orm_default',

                'generate_proxies'  => true,
                'proxy_dir'         => 'data/DoctrineORMModule/Proxy',
                'proxy_namespace'   => 'DoctrineORMModule\Proxy',
                'filters'           => array()
            )
        ),

        'driver' => array(
            'orm_default' => array(
                'class'   => 'Doctrine\ORM\Mapping\Driver\DriverChain',
                'drivers' => array()
            )
        ),

        'entitymanager' => array(
            'orm_default' => array(
                'connection'    => 'orm_default',
                'configuration' => 'orm_default'
            )
        ),

        'eventmanager' => array(
            'orm_default' => array()
        ),

        'sql_logger_collector' => array(
            'orm_default' => array(),
        ),

        'entity_resolver' => array(
            'orm_default' => array()
        ),

        'authentication' => array(
            'orm_default' => array(
                'objectManager' => 'doctrine.entitymanager.orm_default',
                //'identityClass' => 'Application\Model\User',
                //'identityProperty' => 'username',
                //'credentialProperty' => 'password'
            ),
        ),
    ),

    // zendframework/zend-developer-tools specific settings

    'view_manager' => array(
        'template_map' => array(
            'zend-developer-tools/toolbar/doctrine-orm' => __DIR__ . '/../view/zend-developer-tools/toolbar/doctrine-orm.phtml',
        ),
    ),

    'zenddevelopertools' => array(
        'profiler' => array(
            'collectors' => array(
                'orm_default' => 'doctrine.sql_logger_collector.orm_default',
            ),
        ),
        'toolbar' => array(
            'entries' => array(
                'orm_default' => 'zend-developer-tools/toolbar/doctrine-orm',
            ),
        ),
    ),
); 
```

# java - 来自扩展的 Java 类型转换

> ID：15277278
> 
> 赞同：3
> 
> 时间：2013-03-07T17:02:44.830
> 
> 标签：java, types, casting, extends

我有以下代码：

```
public static <T extends User> void addUser(String username,
        String passwordHash, Class<T> userClass, File usersDir) {

    T user = (T) new User(username, passwordHash);
    UserManager.toFile(user, usersDir);
} 
```

Eclipse 给了我以下警告：

`Type safety: Unchecked cast from User to T`

**如果我将T**定义为扩展用户，为什么我会收到未检查的警告`<T extends User>`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T17:04:48.167

你误解了泛型。

`T extends User`并不意味着那`T` **是** `User`；这意味着`T`可以是任何继承的类`User`。

如果`T`是`FunkyUser`，您的代码将不起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T17:04:50.280

`T`可以是任何扩展类`User`。您正在实例化一个新的`User`，即超类。因此，如果`T`不**完全**是`User`类型（即子类），则强制转换是不安全的，并且 a`ClassCastException`将被抛出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:09:48.507

最小 T 可以是 User ，实际上也可以是 AdvancedUser

```
class AdvancedUser extends User{} 
```

如果您将 T 声明为高级用户，那么您的程序将失败，因为您将真实的 User 对象向上转换为 AdvancedUser 类型。因此它会给你一个关于不安全演员的警告

# objective-c - 使用 XCode 构建时变量

> ID：15277282
> 
> 赞同：1
> 
> 时间：2013-03-07T17:02:47.820
> 
> 标签：objective-c, xcode, jenkins-plugins

我有以下情况：

1.  构建我的 iOS XCode 项目的 Jenkins 服务器
2.  应用程序从需要指向不同位置的 URL 获取数据，具体取决于构建是用于生产还是开发

我需要能够在构建时指定我想要构建应用程序的环境，以便代码中使用的 URL (re `#define DATA_URL @"http://..."`:) 适合正在构建的环境。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:13:18.810

我做了一些更简单的事情，为此我们在标题下的构建设置中设置了一个宏，`Preprocessor Macros`然后为每种类型的构建（DEBUG、RELEASE 等）设置类似（DEBUG）`APP_CONFIG=1`和（RELEASE）之类的东西`APP_CONFIG=2`，等等。你有。然后在你的`***-Prefix.pch`你可以做类似的事情（注意这不必进入`***-Prefix.pch`它可以进入你的代码中的任何地方）

```
#if(APP_CONFIG==1)
    #define DATA_URL @"http://..."
#else
    #define DATA_URL @"http://..."
#endif 
```

我问了一些更简单的事情，这里是[iPhone 应用程序的链接设置包](https://stackoverflow.com/questions/8743914/settings-bundle-for-iphone-app)

如果这不是您想要的评论，希望这会有所帮助，我会尽力修改以提供帮助。

# sql-server - 切换到 UTF-8 时最大的风险是什么？

> ID：15277283
> 
> 赞同：3
> 
> 时间：2013-03-07T17:02:48.413
> 
> 标签：sql-server, database, encoding

我们的团队正计划将 SQL Server 数据库上的排序规则编码更新为 UTF-8。我们还计划更新我们的表模式以`nvarchar()`支持真正的 Unicode 字符。然而，我们试图确定的是，这样做会遇到哪些潜在的地雷？

例如，我们的查询会运行得更慢吗？数据库中的当前数据是否有可能损坏？

作为参考，SQL Server 被用作 PHP Web 应用程序的后端，该应用程序在 Linux 主机上的 Apache 上运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:13:58.120

请参阅[NVARCHAR 上的 MSDN SQL Server 联机丛书](http://msdn.microsoft.com/en-us/library/ms186939.aspx)- SQL Server 仅支持 UCS-2（每个字符 2 个字节 = UTF-16），但正如您所说，这是**真正的 Unicode 。**

另请参阅[dba.stackexchange.com 上的此问题（及其答案）以](https://dba.stackexchange.com/questions/7346/sql-server-2005-2008-utf-8-collation-charset)获得更全面的解释和背景。

使用所有列的主要**缺点**`nvarchar`是，这只是普通的使用两倍的存储空间`varchar`- 所有字符都存储为 2 个字节。除此之外-我没有看到使用`nvarchar`而不是`varchar`...的任何大问题

# perl - 为什么这个地图块包含一个明显无用的+？

> ID：15277284
> 
> 赞同：11
> 
> 时间：2013-03-07T17:02:51.717
> 
> 标签：perl, map

在浏览源代码时，我看到了以下几行：

```
my @files_to_keep = qw (file1 file2);
my %keep = map { + $_ => 1 } @files_to_keep; 
```

此代码段中的作用是什么`+`？我曾经`Data::Dumper`看看取出加号是否有任何作用，但结果是一样的：

```
 $ perl cleanme.pl
$VAR1 = {
          'file1' => 1,
          'file2' => 1
        }; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-07T17:08:25.073

这用于防止解析问题。加号强制解释器表现得像一个普通的块，而不是一个表达式。

担心的是，也许您正试图使用​​类似的其他（表达式）公式来创建哈希引用`map`。

```
@array_of_hashrefs = map {  "\L$_" => 1  }, @array 
```

注意逗号。然后，如果解析器根据 OP 中的语句猜测您正在执行此操作，则会出现缺少逗号的语法错误！要查看差异，请尝试引用`"$_"`. 无论出于何种原因，解析器都认为这足以触发表达式行为。

是的，它很奇怪。因此，许多偏执狂的 Perl 程序员比需要更频繁地使用额外的加号（包括我在内）。

以下是[`map`](http://perldoc.perl.org/functions/map.html)文档中的示例。

```
%hash = map {  "\L$_" => 1  } @array  # perl guesses EXPR.  wrong
%hash = map { +"\L$_" => 1  } @array  # perl guesses BLOCK. right
%hash = map { ("\L$_" => 1) } @array  # this also works
%hash = map {  lc($_) => 1  } @array  # as does this.
%hash = map +( lc($_) => 1 ), @array  # this is EXPR and works!
%hash = map  ( lc($_), 1 ),   @array  # evaluates to (1, @array) 
```

对于有趣的阅读（风格上）和解析器出错的情况，请阅读以下内容：http: [//blogs.perl.org/users/tom_wyant/2012/01/the-case-of-the-overloaded-curlys.html](http://blogs.perl.org/users/tom_wyant/2012/01/the-case-of-the-overloaded-curlys.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-07T17:25:06.143

一元加运算符只是简单地返回其操作数不变。添加一个甚至不会改变上下文。

在您给出的示例中，它完全没用。但是在某些情况下，将下一个令牌制作成无可否认的运算符是有用的。

* * *

例如，`map`有两种语法。

```
map EXPR, LIST 
```

和

```
map BLOCK LIST 
```

块以 开头`{`，但表达式也可以。例如，`{ }`可以是块或哈希构造函数。

那么如何`map`区分呢？它猜测。这意味着它有时是错误的。

猜测错误的一种情况如下：

```
map { $_ => 1 }, @list 
```

`+`您可以使用or来促使它正确猜测`;`。

```
map {; ...     # BLOCK
map +{ ...     # EXPR 
```

所以在这种情况下，你可以使用

```
map +{ foo => $_ }, @list 
```

请注意，您还可以使用以下内容：

```
map({ foo => $_ }, @list) 
```

* * *

另一个示例是当您省略参数周围的括号时，第一个参数表达式以括号开头。

```
print ($x+$y)*2;    # Same as: 2 * print($x+$y) 
```

它可以使用固定

```
print +($x+$y)*2; 
```

但是，为什么要为了避免括号而增加黑客攻击呢？我更喜欢

```
print(($x+$y)*2); 
```

# django - Django 多类 Meta：正在执行

> ID：15277288
> 
> 赞同：-3
> 
> 时间：2013-03-07T17:03:02.870
> 
> 标签：django, tastypie

```
class A(ModelResource):
    Meta:
    resource_name = 'urlA'
    print helloA
class B(ModelResource):
    Meta:
    resource_name = 'urlB'
    print helloB 
```

当我访问 /urlA 时，我会打印出 helloA 和 helloB。我只期待helloA。这是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:24:50.923

1.  希望这不是您的实际缩进
2.  整个模块（包含这些类的文件）正在服务器启动时加载（或稍后，由于延迟加载）。它与正在加载（调用）的 url**无关。**
3.  不知道您所说的“被执行”是什么意思……也不知道您想用该代码实现什么。请退后几步，学习python的基础知识，这将使您的生活更轻松。

# r - 轴标签分组 ggplot2

> ID：15277292
> 
> 赞同：4
> 
> 时间：2013-03-07T17:03:19.960
> 
> 标签：r, graphics, ggplot2

我正在尝试使用 ggplot2 绘制一个绘图，在 X 轴上我可以找到某种方法来为变量组添加标签。这是我的代码的最小版本：

```
Bzero   <-100*matrix(runif(100),ncol=10,nrow=10)

B   <-99
LNtype  <-c(1,1,1,1,2,2,2,3,3,3)
LNnames <-c('grp1','grp2','grp3')

tB  <-t(Bzero)/(B+1)
dfB <-data.frame(tB)
dfB$grp <-LNtype
dfB$vid <-1:nrow(tB)

mB0 <- melt(dfB,id.vars=c('grp','vid'))
mB0 <- mB0[order(mB0$grp,mB0$vid),]

gg0 <- ggplot(mB0,aes(x=vid,y=variable))
gg0 <- gg0 + geom_tile(aes(fill = value),colour = "white")
gg0 <- gg0 + scale_fill_gradient(low = "green", high = "red",na.value='white',limits=c(0,1),name='p0i')
gg0 <- gg0 + xlab('Equation')+ylab('Covariate') 
```

这是结果图：

![结果图：](../Images/a6bd7438eb43f723c44dbfa14647618b.png)

这是我想要的： ![在此处输入图像描述](../Images/2e29811f6f5dece262c5ec1e25ddb94f.png)

我一直在修改比例、中断和标签，但无济于事。即使是大量的谷歌搜索也确实揭示了具有这种轴的任何情节。有什么办法可以得到我想要的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T17:06:52.550

您可以使用组替换数字`scale_x_continuous()`并在所需位置设置中断。您可以将`geom_segment()`这些黑线添加到分组数据中。

```
gg0+
 geom_segment(aes(x=0.5,y=0.5,xend=10.5,yend=0.5))+
 geom_segment(aes(x=c(0.5,4.5,7.5,10.5),
                  xend=c(0.5,4.5,7.5,10.5),y=rep(0.5,4),yend=rep(1,4)))+
  scale_x_continuous("",breaks=c(2.5,6,9),labels=c("Group1","Group2","Group3")) 
```

![在此处输入图像描述](../Images/62a40bdb9e06e3f3a31502f0b43a8fda.png)

# perl - Perl：如何拆分文件

> ID：15277294
> 
> 赞同：2
> 
> 时间：2013-03-07T17:03:20.897
> 
> 标签：perl

我有一个文本文件，我想使用 perl 将其拆分为多个文本文件并输出

例如：

数据开始于：

```
[TABLE]

DATA........
DATA........

[/TABLE]

[PAGE]

[TABLE]

DATA........
DATA........

[/TABLE] 
```

***期望的输出：***

文件1.txt

```
DATA........
DATA........ 
```

文件2.txt

```
DATA........
DATA........ 
```

所以基本上介于`[TABLE]`&之间的任何东西都`[/TABLE]`应该是一个新的文本文件等等。新文本文件的命名约定可以是 File1.txt、File2.txt 等……

请指出我正确的方向。

感谢你的帮助。

```
 #!usr/bin/perl
 my $fi, $fi2;
 my $line;
 my $i;
 my @lines;
 my @filenameparts;
 my $filename = "file1.txt";

 open($fi, "< complex.txt");
 @lines = <$fi>;
 open ($fi2, " > $filename");

 foreach (@lines)
 {
    if (($i > 0) and $_ =~ /[TABLE]/)
 {
            @filenameparts = split("_", $filename);
            foreach (@filenameparts)
            {

             print "-----------------------------\n";
             print .$_;
             print "-----------------------------\n";               
            }
            @filenameparts[1] = substr(@filenameparts[1], 0,            @filenameparts[1].length() - 5);
            @filenameparts[1] = ($filenameparts[1] + 1);
            $filename = @filenameparts[0]."_".@filenameparts[1].".txt";
            print $filename;
            close($fi2);
            open ($fi2, " > $filename");
            $i = 0;
            print $fi2 $_;

    }
    else
    {
         print $fi2 $_;
    }
    $i++;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:55:36.263

这怎么样，

```
#!/usr/bin/env perl
use strict;
use warnings;
use feature ':5.10';
while ( defined( my $_ = <DATA> ) ) {

  my ( $start_tag, $end_tag );
  if ( index($_,'[TABLE]') != -1 ) {
    $start_tag = 1;
  }
  elsif ( index($_,'[/TABLE]') != -1 ) {
    $end_tag = 1;
  }

  if ( $start_tag .. $end_tag ) {
    state $fileno //= 1;
    state $fh_gen = sub {
      state $fh;
      return $fh if defined $fh;
      open ( $fh, '>', "file_$fileno.txt" ) or die $!;
      $fh;
    };

    if ( $start_tag ) {}
    elsif ( $end_tag ) {
      $fileno++;
      $fh_gen = sub {
        state $fh;
        return $fh if defined $fh;
        open ( $fh, '>', "file_$fileno.txt" ) or die $!;
        $fh;
      };
    }
    else {
      my $fh = $fh_gen->();
      print $fh $_;
    }

  }

}

__DATA__

[TABLE]

DATA........
DATA........

[/TABLE]

[PAGE]

[TABLE]

DATA........
DATA........

[/TABLE] 
```

# java - 分析同步和锁的区别

> ID：15277301
> 
> 赞同：2
> 
> 时间：2013-03-07T17:03:40.757
> 
> 标签：java, multithreading

我是线程世界的新手，我正在通过线程了解最新的 util 包可重入锁机制，我正在了解同步机制和新添加的锁机制之间的基本差异，正如文章中的这些差异..

1.  ReentrantLock 和 synchronized 关键字之间的另一个显着区别是公平性。synchronized 关键字不支持公平。任何线程一旦释放就可以获取锁，不能指定偏好，另一方面可以通过指定公平属性使 ReentrantLock 公平，同时创建 ReentrantLock 的实例。公平属性为最长等待线程提供锁，以防发生争用。如果你能提供一个小程序来证明这一点 sp，我可以掌握更多

2.  synchronized 和 ReentrantLock 之间的主要区别是能够以中断方式尝试锁定，并且具有超时。线程不需要无限阻塞，synchronized就是这种情况，如果你能提供一个小程序来证明这一点sp，我可以掌握更多

3.  ReentrantLock 和 Java 中的 synchronized 关键字之间另一个值得注意的区别是，在等待 Lock 时可以中断 Thread。在 synchronized 关键字的情况下，线程可以无限期地阻塞等待锁定，并且无法控制。ReentrantLock 提供了一个叫做 的方法`lockInterruptibly()`，可以用来在线程等待锁的时候中断它。同样`tryLock()`，如果在某个时间段内没有锁可用，可以使用 timeout 来超时。如果你能提供一个小程序来证明这一点 sp ，我可以掌握更多

伙计们，你能不能提供一个小程序来显示以上三点

我已经尝试过这个程序，请告知需要在其中进行哪些更改以证明以上 3 点..

```
public class ReentrantLockHowto {

    private final ReentrantLock lock = new ReentrantLock();
    private int count = 0;

     //Locking using Lock and ReentrantLock
     public int getCount() {
        lock.lock();
        try {
            System.out.println(Thread.currentThread().getName() + " gets Count: " + count);
            return count++;
        } finally {
            lock.unlock();
        }
     }

     //Implicit locking using synchronized keyword
     public int getCountTwo() {
            return count++;
     }

    public static void main(String args[]) {
        final ThreadTest counter = new ThreadTest();
        Thread t1 = new Thread() {

            @Override
            public void run() {
                while (counter.getCount() &lt; 6) {
                    try {
                        Thread.sleep(100);
                    } catch (InterruptedException ex) {
                        ex.printStackTrace();                    }
                }
            }
        };

        Thread t2 = new Thread() {

            @Override
            public void run() {
                while (counter.getCount() &lt; 6) {
                    try {
                        Thread.sleep(100);
                    } catch (InterruptedException ex) {
                        ex.printStackTrace();
                    }
                }
            }
        };

        t1.start();
        t2.start();

    }
} 
```

输出：

```
Thread-0 gets Count: 0
Thread-1 gets Count: 1
Thread-1 gets Count: 2
Thread-0 gets Count: 3
Thread-1 gets Count: 4
Thread-0 gets Count: 5
Thread-0 gets Count: 6
Thread-1 gets Count: 7 
```

# powershell - 按日期从 CSV 获取行

> ID：15277302
> 
> 赞同：0
> 
> 时间：2013-03-07T17:03:44.657
> 
> 标签：powershell, csv

我有一个包含几行和一个日期列的 CSV 文件。我想获取日期超过 30 天的所有行。这是我最好的尝试：

```
$Data = Import-CSV "H:\Data.csv"
$CutoffDate = (Get-Data).AddDays(-30)
$Data | Where-Object {$_.Date -lt $CutoffDate} 
```

这不会返回任何内容，并且肯定有日期超过 30 天的行。我的猜测是这`$_.Date`不被认为是一个日期，但在这种情况下，我很难做到如何做到这一点。有人可以在这里指出我正确的方向吗？谢谢。-铝

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:27:22.547

使用 导入数据时`Import-CSV`，所有属性都创建为字符串。要按日期过滤，您需要将日期设为`datetime`对象。该示例在第二行也有错字（`Get-Data`而不是`Get-Date`）。尝试这个：

```
$Data = Import-CSV "H:\Data.csv"
$CutoffDate = (Get-Date).AddDays(-30)
$Data | Where-Object {$_.Date -as [datetime] -lt $CutoffDate} 
```

如果你愿意，你可以将它与它结合起来`Import-CSV`，像这样：

```
$CutoffDate = (Get-Date).AddDays(-30)
$Data = Import-CSV "H:\Data.csv" | Where-Object {$_.Date -as [datetime] -lt $CutoffDate} 
```

# haskell - 值列表中的组合列表？

> ID：15277306
> 
> 赞同：0
> 
> 时间：2013-03-07T17:03:54.653
> 
> 标签：haskell, combinations, cartesian-product

如何从列表列表中获取组合列表？

例如：

```
ghci> getCombinations [[1,2,3],[10,20,30],[100,200,300]]

[[1,10,100],[1,10,200],[1,10,300],[1,20,100],[1,20,200],[1,20,300],[1,30,100],
[1,30,200],[1,30,300],[2,10,100],[2,10,200],[2,10,300],[2,20,100],[2,20,200],
[2,20,300],[2,30,100],[2,30,200],[2,30,300],[3,10,100],[3,10,200],[3,10,300],
[3,20,100],[3,20,200],[3,20,300],[3,30,100],[3,30,200],[3,30,300]] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:04:23.280

```
import Control.Applicative

getCombinations :: [[a]] -> [[a]]
getCombinations values =
foldl (\acc values -> (\list value -> list ++ [value]) <$> acc <*> values) [[]] values

getCombinations [[1,2,3],[10,20,30],[100,200,300]] 
```

[[1,10,100],[1,10,200],[1,10,300],[1,20,100],[1,20,200],[1,20,300],[1,30,100],[1,30,200],[ 1,30,300],[2,10,100],[2,10,200],[2,10,300],[2,20,100],[2,20,200],[2,20,300],[2,30,100],[2, 30,200],[2,30,300],[3,10,100],[3,10,200],[3,10,300],[3,20,100],[3,20,200],[3,20,300],[3,30,100] ,[3,30,200],[3,30,300]]

# python - 用另一个字典更新一个字典，但只更新非无值

> ID：15277307
> 
> 赞同：10
> 
> 时间：2013-03-07T17:03:58.853
> 
> 标签：python

从 python[文档](http://docs.python.org/2/library/stdtypes.html#mapping-types-dict)中我看到它`dict`有一个`update(...)`方法，但它似乎不会出现我可能不想用新值更新旧字典的例外情况。例如，当值为`None`.

这是我目前所做的：

```
for key in new_dict.keys():
  new_value = new_dict.get(key)
  if new_value: old_dict[key] = new_value 
```

有没有更好的方法来使用新字典更新旧字典。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-07T17:07:44.307

你可以使用类似的东西：

```
old = {1: 'one', 2: 'two'}
new = {1: 'newone', 2: None, 3: 'new'}

old.update( (k,v) for k,v in new.items() if v is not None)

# {1: 'newone', 2: 'two', 3: 'new'} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-29T17:12:07.817

**更新：**我想我在这里试图回答错误的问题（请参阅下面的评论），因为这显然不能回答所提出的问题。万一有什么有用的东西，无论如何我都会把它留在这里（除非有人明确表示最好删除它）。

以[乔恩的回答为基础，但按照](https://stackoverflow.com/a/15277395/3780389)[此处](https://stackoverflow.com/a/18554081/3780389)的建议使用[设置交集](https://docs.python.org/2/library/stdtypes.html#frozenset.intersection)：

在python 3中：

```
old.update((k, new[k]) for k in old.keys() & new.keys()) 
```

在 python 2.7 中：

```
old.update((k, new[k]) for k in old.viewkeys() & new.viewkeys()) 
```

在 python 2.7 或 3 中使用[`future`](http://python-future.org/)包：

```
from future.utils import viewkeys
old.update((k, new[k]) for k in viewkeys(old) & viewkeys(new)) 
```

或者在 python 2 或 3 中`future`通过创建新集合而不使用包：

```
old.update((k, new[k]) for k in set(old.keys()) & set(new.keys())) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-13T23:22:28.927

对于 python 3.x 迭代整个字典键值使用`for k,v in new.items()`

```
IN: 
old = {1: 'one', 2: 'two'}
new = {1: 'new_one', 2: None, 3: 'new_three'}

old.update((k,v) for k,v in new.items() if v is not None)

Out:
old = {1: 'new_one', 2: 'two'} 
```

# c# - 在 .NET 中合并部署混合项目类型

> ID：15277311
> 
> 赞同：0
> 
> 时间：2013-03-07T17:04:12.490
> 
> 标签：c#, visual-studio-2008, deployment, msbuild

我正在使用 VS 2008 / .NET 3.5 我有以下构成我们产品的项目组合：

*   多个后端 c# 类库
*   5 窗口服务
*   4 Web 应用项目

我有一个 MSBUILD proj.xml，它以正确的顺序列出了上述每个文件的所有 .sln 文件，我可以一次构建所有内容。但是，在部署方面，我目前从 VS2008 发布每个 Web 应用程序，然后必须手动安装每个服务。此外，我每次都需要将一些配置文件和其他位复制到服务器，这很痛苦。

有没有办法将所有上述部署操作合并到一个可以自动化部署过程的项目中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:06:20.420

看看 WebDeploy。尽管我们在 TFS 中使用它，但它会从批处理文件中执行您需要的操作。

[http://www.iis.net/downloads/microsoft/web-deploy](http://www.iis.net/downloads/microsoft/web-deploy)

# gwt - Guava 14.0 GWT 序列化 可选

> ID：15277312
> 
> 赞同：0
> 
> 时间：2013-03-07T17:04:22.490
> 
> 标签：gwt, deserialization, guava, gwt-rpc

使用带有 GWT RPC 2.5.1-rc1 的 Guava 14.0，使用 maven 构建，如[Guava 库和 GWT中所述](https://stackoverflow.com/questions/2005687/guava-libraries-and-gwt/6201161#6201161)

Guava 集合的反序列化似乎运行良好。但是，在尝试反序列化包含 Optional.Present 的响应 DTO 时，我遇到了 SerializationException。

```
Caused by: com.google.gwt.user.client.rpc.SerializationException: com.google.common.base.Present/3434853995
at    com.google.gwt.user.client.rpc.impl.SerializerBase.getTypeHandler(SerializerBase.java:153) 
```

查看 SerializerBase.java:146 methodToJava 映射不包含：

```
com.google.common.base.Present/3434853995 
```

但是，它确实包含一个 CustomFieldSerializer 用于：

```
com.google.common.base.Present/3491224270 
```

那么，/3434853995 映射是怎么回事？

看起来这是 SerializerBase 用来确保服务器端类型与客户端类型相同的哈希（在编译时计算）。查看 guava-gwt 和服务器端 guava Optional.Present，这些不匹配。而且由于 Present 是在服务器端实例化的，它的哈希值与客户端 Present 不匹配？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:48:44.017

唔。我们的内部测试可以成功地 GWT 序列化 server-created `Optional`，但这不是我们的公共 Guava 版本第一次无法匹配我们的内部 GWT 行为。

从您提供的链接中，听起来您已经完成了我建议的前两件事：确保您的客户端和服务器端库都依赖于，并在您的 GWT 模块中`guava-gwt`声明依赖于。`com.google.common.base.Base`

我目前的另一个想法是询问您的 DTO 是什么样的。GWT 有时难以确定需要准备序列化哪些类。真的，我怀疑这就是问题所在：GWT 显然有一些迹象表明它可能需要 serialize `Present`，而且无论如何，这些问题通常只出现在`final`字段中，这可能会给您带来更根本的困难。

您还可以确保您不会以某种方式传递地引入不同版本的 Guava。如果它是真正的 Maven 传递依赖项，那么我认为 Maven 会出错，但如果您的依赖项之一是将 Guava 类直接捆绑到其 jar 中，那么 Maven 可能不会注意到。这似乎也不太可能，但我正在抓住稻草。

如果你做不到这一切，如果你能整理一个我可以在本地运行的测试用例，我可以进一步调查。

# c# - 如何在 WinForm UI 中显示通过递归搜索访问的文件？

> ID：15277314
> 
> 赞同：0
> 
> 时间：2013-03-07T17:04:23.340
> 
> 标签：c#, visual-studio-2008, user-interface, event-handling, backgroundworker

我编写了一个程序，它递归地遍历一个目录，通过文件夹浏览器对话框选择，并列出其中的所有文件和所有子目录。对于每个文件，我创建一个文件对象并为其提供名称、路径和创建日期的属性。然后我将它们添加到对象列表中，以便排序并打印为 csv。我现在被要求添加在 UI 中观看搜索的功能，以代替进度条之类的东西。

我对编写 WinForm UI 很陌生，所以我不完全确定从哪里开始。我一直在为创建的每个文件对象更新工具条状态标签，但不确定应该如何完成。我已经阅读了将 BackgroundWorker 用于类似任务的建议，但由于这是该程序执行的唯一任务，这似乎有点矫枉过正。我想我需要使用事件处理程序/委托，但不完全确定如何实现它。

我很高兴发布任何有用的代码。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T13:09:02.890

我终于能够通过向包含递归搜索的类添加一个事件处理程序来实现这一点。当我为目录中的每个文件设置文件对象的名称时，设置一个 onPropertyChanged 事件。我将它与我的后台工作人员的 DoWork 中的表格联系起来。然后我在事件触发时报告了进度，并使用后台工作程序 ProgressChanged 将文本设置为当前文件名。以下是我的程序中的一些代码片段，可以帮助任何尝试类似事情的人。

*在搜索类*

```
foreach (string file in Directory.GetFiles(dir))
    {
       //creating objects for each file in the directory
       FileObject fileObject = new FileObject();
       FileInfo info = new FileInfo(file);
       currentfile = file.ToString();
       fileObject.name = info.Name.ToString();
       fileObject.path = file.ToString();
       fileObject.createdDate = info.CreationTime.ToString();
       FileList.Add(fileObject);
       //event handler triggered
       OnFileNameChanged(name);
    }

//event handler code
public event PropertyChangedEventHandler PropertyChanged;

protected void OnFileNameChanged(string propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;

        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(propertyName));
        } 
```

*在 windows 窗体中*

```
private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)
    {
       //do some work
      search.PropertyChanged += (s, pe) => backgroundWorker1.ReportProgress(unusedNumber);
      backgroundWorker1.ReportProgress(100);
    }
 private void backgroundWorker1_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {
      //change label
      label1.Text = search.currentfile;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:17:59.840

是的，如果您不希望 UI 是“可点击的”，您可以使用事件作为解决方案。递归代码应该提供一个事件并且你的 UI 可以订阅它。事件处理程序将获取必要的数据并重绘表单。但通常这不是一个好方法。您将无法对表单进行操作，因为 UI 线程正忙于任务，并且您无法以用户友好的方式中止任务（不杀死它的进程）。

# c++ - opencv 形状检测

> ID：15277323
> 
> 赞同：2
> 
> 时间：2013-03-07T17:04:39.100
> 
> 标签：c++, opencv, detection, shape

嗨，我正在使用 opencv 进行简单的形状检测检测（三角形、多边形、圆形），这是我的代码：

```
 int main()
{

    IplImage* img =  cvLoadImage("C:/Users/tarek/Desktop/test5.png");

    //show the original image
    cvNamedWindow("Raw");
    cvShowImage("Raw",img);

    //converting the original image into grayscale
    IplImage* imgGrayScale = cvCreateImage(cvGetSize(img), 8, 1); 
    IplImage* imgCanny = cvCreateImage(cvGetSize(img), 8, 1); 
    cvCvtColor(img,imgGrayScale,CV_BGR2GRAY);

    //thresholding the grayscale image to get better results
    cvThreshold(imgGrayScale,imgGrayScale,128,255,CV_THRESH_BINARY);  

    CvSeq* contours;  //hold the pointer to a contour in the memory block
    CvSeq* result;   //hold sequence of points of a contour
    CvMemStorage *storage = cvCreateMemStorage(0); //storage area for all contours

    //finding all contours in the image
    cvFindContours(imgGrayScale, storage, &contours, sizeof(CvContour), CV_RETR_LIST, CV_CHAIN_APPROX_SIMPLE, cvPoint(0,0));

    //iterating through each contour
    while(contours)
    {
        //obtain a sequence of points of contour, pointed by the variable 'contour'
        result = cvApproxPoly(contours, sizeof(CvContour), storage, CV_POLY_APPROX_DP, cvContourPerimeter(contours)*0.02, 0);

        //if there are 3  vertices  in the contour(It should be a triangle)
        if(result->total==3 )
        {
            //iterating through each point
            CvPoint *pt[3];
            for(int i=0;i<3;i++){
                pt[i] = (CvPoint*)cvGetSeqElem(result, i);
            }

            //drawing lines around the triangle
            cvLine(img, *pt[0], *pt[1], cvScalar(255,0,0),4);
            cvLine(img, *pt[1], *pt[2], cvScalar(255,0,0),4);
            cvLine(img, *pt[2], *pt[0], cvScalar(255,0,0),4);

        }

        //if there are 4 vertices in the contour(It should be a quadrilateral)
        else if(result->total==4 )
        {
            //iterating through each point
            CvPoint *pt[4];
            for(int i=0;i<4;i++){
                pt[i] = (CvPoint*)cvGetSeqElem(result, i);
            }

            //drawing lines around the quadrilateral
            cvLine(img, *pt[0], *pt[1], cvScalar(0,255,0),4);
            cvLine(img, *pt[1], *pt[2], cvScalar(0,255,0),4);
            cvLine(img, *pt[2], *pt[3], cvScalar(0,255,0),4);
            cvLine(img, *pt[3], *pt[0], cvScalar(0,255,0),4);   
        }

        //if there are 7  vertices  in the contour(It should be a heptagon)
        else if(result->total ==7  )
        {
            //iterating through each point
            CvPoint *pt[7];
            for(int i=0;i<7;i++){
                pt[i] = (CvPoint*)cvGetSeqElem(result, i);
            }

            //drawing lines around the heptagon
            cvLine(img, *pt[0], *pt[1], cvScalar(0,0,255),4);
            cvLine(img, *pt[1], *pt[2], cvScalar(0,0,255),4);
            cvLine(img, *pt[2], *pt[3], cvScalar(0,0,255),4);
            cvLine(img, *pt[3], *pt[4], cvScalar(0,0,255),4);
            cvLine(img, *pt[4], *pt[5], cvScalar(0,0,255),4);
            cvLine(img, *pt[5], *pt[6], cvScalar(0,0,255),4);
            cvLine(img, *pt[6], *pt[0], cvScalar(0,0,255),4);
        }

        //obtain the next contour
        contours = contours->h_next; 
    }
    // apply hough circles to find circles and draw a cirlce around it
    cvCanny(imgGrayScale,imgCanny,0,0,3);
    CvSeq* circles = cvHoughCircles(imgCanny,
        storage,
        CV_HOUGH_GRADIENT,
        2,
        imgCanny->height/4,
        200,
        100 );

    for (int i = 0; i < circles->total; i++) 
    {
        float* p = (float*)cvGetSeqElem( circles, i );
        cvCircle( img, cvPoint(cvRound(p[0]),cvRound(p[1])), 
            3, CV_RGB(0,255,0), -1, 8, 0 );
        cvCircle( img, cvPoint(cvRound(p[0]),cvRound(p[1])), 
            cvRound(p[2]), CV_RGB(0,255,255), 3, 8, 0 );
    }
    //show the image in which identified shapes are marked   
    cvNamedWindow("Tracked");
    cvShowImage("Tracked",img);

    cvWaitKey(0); //wait for a key press

    //cleaning up
    cvDestroyAllWindows(); 
    cvReleaseMemStorage(&storage);
    cvReleaseImage(&img);
    cvReleaseImage(&imgGrayScale);

    return 0;
} 
```

这是输入图像的链接 [http://postimage.org/image/fmntii9lb/](http://postimage.org/image/fmntii9lb/)

以及输出 [http://postimage.org/image/4yhodbypj/的另一个链接](http://postimage.org/image/4yhodbypj/)

我的问题是如何解决中间的两个（也许更多）不必要的大圆圈，当框架中有很多形状时，它们总是会出现提前谢谢

# angularjs - 如何查看延迟服务属性？

> ID：15277331
> 
> 赞同：3
> 
> 时间：2013-03-07T17:05:07.697
> 
> 标签：angularjs

如果我有以下简单的控制器和服务。

```
<div ng-controller="MessagesCtrl">
  <ul>
    <li ng-repeat="message in data.messages">
      {{ message }}
    </li>
  </ul>
</div>

myApp.factory('Data', function () {
  var _messages = [];
  return {
    messages: _messages,
    getMessages: function() {
      $http.get('/messages').then(function(response) {
        _messages = response.data;
      });
    }
  };
});

function MessagesCtrl($scope, Data) {
  $scope.data = Data;
  $scope.data.getMessages();
} 
```

我希望`messages`模型在 AJAX 请求完成并填充对象时自动更新，但事实并非如此。这应该如何工作？（我有点问这种结构的最佳实践是什么）。

**编辑 - 工作解决方案：**

```
<div ng-controller="MessagesCtrl">
  <ul>
    <li ng-repeat="message in data.messages">
      {{ message }}
    </li>
  </ul>
</div>

myApp.factory('Data', function () {
  return {       
    getMessages: function() {
      var _this = this;
      $http.get('/messages').then(function(response) {
        _this.messages = response.data;
      });
    }
  };
});

function MessagesCtrl($scope, Data) {
  $scope.data = Data;
  $scope.data.getMessages();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:33:57.427

我相当确定您在这里遇到了 JavaScript 问题，而不是与 AngularJS 相关的问题。让我们删除 AngularJS 相关的代码，只留下 JavaScript 部分：

```
function factory() {
  var _messages = [];
  return {
    messages: _messages,
    getMessages: function() {
      _messages = [1, 2, 3, 4];
    }
  }
}

> var test = factory();
undefined
> test.messages
[]
> test.getMessages()
undefined
> test.messages
[] 
```

test.messages 指向原始 _messages 数组，而稍后 _messages 正在更改，但 test.messages 没有。

# php - 意外行为后的用户权限二进制/十进制混淆

> ID：15277343
> 
> 赞同：0
> 
> 时间：2013-03-07T17:05:26.130
> 
> 标签：php

首先，我不明白为什么有些人使用二进制数和 2 的幂来获得权限。是因为它们代表真/假，从后向关系为 1/0？

例如：`1010 means false, true, false, true`？

我的问题如下。`15`十进制与`1111`二进制相同，但是：

```
DEFINE ('READ',1);
DEFINE ('WRITE',2);
DEFINE ('EDIT',4);
DEFINE ('DELETE',8);

$current = 15;

if ($current & READ) print("can read <br />");
if ($current & WRITE) print("can write <br />");
if ($current & EDIT) print("can edit <br />");
if ($current & DELETE) print("can delete <br />"); 
```

正如我所料，这输出允许所有权限。但是，如果我将 15 更改为，`1111`则它只显示其中 3 个不允许全部四个（`delete`权限无效）：

```
DEFINE ('READ',1);
DEFINE ('WRITE',2);
DEFINE ('EDIT',4);
DEFINE ('DELETE',8);

$current = 1111;

if ($current & READ) print("can read <br />");
if ($current & WRITE) print("can write <br />");
if ($current & EDIT) print("can edit <br />");
if ($current & DELETE) print("can delete <br />"); 
```

是不是很奇怪？我理解错了吗？我需要一些帮助来理解这一点。我应该在数据库中将权限存储为小数还是二进制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:22:01.760

正如@mensi 和@datasage 在评论中所说，1111 不是二进制数 1111，而是十进制数 1111！。如果你想把你的权限放在二进制文件中（例如为了更好的可读性），你可以使用[bindec](http://www.php.net/manual/en/function.bindec.php)：

```
$current = bindec('1111'); //Is the same as $current = 15; 
```

# javascript - RegExp 匹配不带引号的单引号文本 - JavaScript

> ID：15277344
> 
> 赞同：2
> 
> 时间：2013-03-07T17:05:30.630
> 
> 标签：javascript, regex, text, double-quotes

如果这是一个令人困惑的问题，我很抱歉。我试图找到一种方法来做到这一点，但找不到它，如果这是一个重复的问题，我很抱歉！

我有这样的文字：`something:"askjnqwe234"`

我希望能够`askjnqwe234`使用 RegExp。你可以注意到我想省略引号。我正在尝试使用`/[^"]+(?=(" ")|"$)/g`，但它返回一个数组。我希望 RegExt 返回单个字符串，而不是数组。

我不知道是否可能，但我不想指定数组的位置；像这样的东西：

`var x = string.match(/[^"]+(?=(" ")|"$)/g)[0];`

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T17:07:34.023

尝试：

```
/"([^"]*)"/g 
```

用英语：寻找`"`匹配并记录任何`"`直到你看到另一个`"`“。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T17:22:17.127

`match`并`exec`始终返回一个数组 or `null`，因此，假设您有一个双引号值并且字符串中没有换行符，您可以使用

```
var x;
var str = 'something:"askjnqwe234"';

x = str.replace( /^[^"]*"|".*/g, '' );
// "askjnqwe234" 
```

或者，如果您在字符串中可能有其他引用的值

```
x = str.replace( /.*?something:"([^"]*)".*/, '$1' ); 
```

其中是指 .之间的`$1`子模式捕获的子字符串。 `[^"]*``()`

应要求提供进一步解释。

尽管如此，我还是建议您容忍数组索引并只使用`match`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T17:08:38.003

您可以像这样捕获引号内的信息，假设它匹配：

```
var x = string.match(/something:"([^"]*)"/)[1]; 
```

索引 1 处的内存捕获是双引号内的部分。

如果您不确定它是否匹配：

```
var match = string.match(/something:"([^"]*)"/);

if (match) {
    // use match[1] here
} 
```

# html - 图像上的透明文本层

> ID：15277348
> 
> 赞同：3
> 
> 时间：2013-03-07T17:05:42.373
> 
> 标签：html, css, stylesheet, styling

我有以下标记：

```
<div class="photo" style="float: left; margin: 2px;">
    <a href="#">
        <img src="images/image.jpg" alt="My Image" height="240" width="240" />
    </a>
</div> 
```

如何在图像顶部创建一个可以写一些文本的图层？该层应该具有透明度，与底部对齐并且大小为 240x60？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:08:31.713

为什么不把图片作为背景呢？

```
<div class="photo" style="float:left; margin:2px">
    <a href="#" style="background:url('images/image.jpg');
          width:240px; height:240px; display:inline-block;">Your text here</a>
</div> 
```

允许您将`display:inline-block`宽度和高度应用于其他内联元素，但在这里您甚至可能只想使用`display:block`它，因为它是容器的唯一子元素。

编辑：您甚至可以在其中放入更多容器，如下所示：

```
<div class="photo" style="float:left; margin:2px">
    <a href="#" style="background:url('images/image.jpg'); position:relative;
          width:240px; height:240px; display:block;">
        <span style="display:block;position:absolute;bottom:0;left:0;right:0;
              background:white;background:rgba(255,255,255,0.25);">Your text here</span>
    </a>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:10:47.310

图像上的文本块。网站和demo如下：

[http://css-tricks.com/text-blocks-over-image/](http://css-tricks.com/text-blocks-over-image/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T17:13:26.650

我会用这样的图像容器来做：

**html**

```
<div class="image-container">
    <img src="path/to/image" />
    <p class="caption">My text</p>
</div> 
```

**CSS**

```
.image-container {
    position:relative;
}

.caption {
    width:100%;
    background:rgba(0,0,0,0.5);
    color:#ffffff;
    position:absolute;
    top:0;

} 
```

看[小提琴](http://jsfiddle.net/soyuka/ByGQg/)！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-07T17:21:31.343

**标记**

```
<div class="figure-container">
    <img src="http://ipadwallsdepot.com/detail/solid-color_00015061.jpg" width="250" height="250" />
    <span class="figure-label">FIG 1.1: Caption Text Here</span>
</div>

<div class="figure-container">
    <img src="http://ipadwallsdepot.com/detail/solid-color_00015061.jpg" width="250" height="250" />
    <span class="figure-label">FIG 1.2: Another Caption Here</span>
</div> 
```

**样式表**

```
.figure-container 
{
    position: relative;  
    display: inline-block;
}

.figure-label
{
    position: absolute;
    bottom: 10px;
    right: 10px;
    color: White
} 
```

我在这里创建了一个 JSFiddle [http://jsfiddle.net/AbBKx/](http://jsfiddle.net/AbBKx/)展示了如何相对于父容器绝对定位子元素（标签）。

# java - 按下 Enter 时 JSpinner 不转移焦点

> ID：15277349
> 
> 赞同：0
> 
> 时间：2013-03-07T17:05:43.750
> 
> 标签：java, swing, events, focus, jspinner

下面的代码应该在任何时候按 Enter 键后将焦点转移到下一个控件，事件触发但 .transferFocus 没有转移焦点，可能有什么问题？谢谢

```
//JSpinner Creation Code:
private javax.swing.JSpinner edtStockMax;   
edtStockMax = new javax.swing.JSpinner();
edtStockMax.setModel(new javax.swing.SpinnerNumberModel(Integer.valueOf(0), Integer.valueOf(0), null, Integer.valueOf(1)));

//Code to bind the Enter key
JSpinnerField1.getActionMap().put("enter-action", new AbstractAction("enter-action")
        {
            @Override
            public void actionPerformed(ActionEvent e)
            {
                System.out.println("Transfer focus inside JSpinner");
                field.transferFocus();
            }
        });

        JSpinnerField1.getInputMap(JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT)
        .put(KeyStroke.getKeyStroke("ENTER"), "enter-action"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-22T10:48:44.227

您可以制作一个自定义 NumberEditor（内部）类来处理焦点更改。这是一个类的示例：

```
class CustomNumberEditor extends JSpinner.NumberEditor implements KeyListener{

        private JFormattedTextField textField;

        public CustomNumberEditor(JSpinner spinner){
            super(spinner);
            textField = getTextField();
            textField.addKeyListener(this);
        }

        @Override
        public void keyTyped(KeyEvent e) {
        }

        @Override
        public void keyPressed(KeyEvent e) {
            if (e.getKeyCode() == KeyEvent.VK_ENTER){
                textField.transferFocus();
            }
        }

        @Override
        public void keyReleased(KeyEvent e) {
        }
    } 
```

您必须将其设置为您的自定义编辑器。这是代码：

```
final JSpinner edtStockMax = new JSpinner();
edtStockMax.setModel(new SpinnerNumberModel(0, 0, 100, 10));
edtStockMax.setEditor(new CustomNumberEditor(edtStockMax)); 
```

# ruby-on-rails - 使用 rspec 和 pdfkit 测试下载 pdf

> ID：15277351
> 
> 赞同：9
> 
> 时间：2013-03-07T17:05:56.380
> 
> 标签：ruby-on-rails, pdf, rspec, wkhtmltopdf, pdfkit

我正在开发一个 Rails 3.2 应用程序，用户可以使用它下载 pdf。我非常喜欢使用 rspec 和 shoulda 匹配器进行测试驱动开发，但我对这个感到茫然。

我的控制器中有以下代码：

```
def show_as_pdf
  @client = Client.find(params[:client_id])
  @invoice = @client.invoices.find(params[:id])

  PDFKit.configure do |config|
    config.default_options = {
      :footer_font_size => "6",
      :encoding => "UTF-8",
      :margin_top=>"1in",
      :margin_right=>"1in",
      :margin_bottom=>"1in",
      :margin_left=>"1in"
    }
  end

  pdf = PDFKit.new(render_to_string "invoices/pdf", layout: false)
  invoice_stylesheet_path = File.expand_path(File.dirname(__FILE__) + "/../assets/stylesheets/pdfs/invoices.css.scss")
  bootstrap_path = File.expand_path(File.dirname(__FILE__) + "../../../vendor/assets/stylesheets/bootstrap.min.css")

  pdf.stylesheets << invoice_stylesheet_path
  pdf.stylesheets << bootstrap_path
  send_data pdf.to_pdf, filename: "#{@invoice.created_at.strftime("%Y-%m-%d")}_#{@client.name.gsub(" ", "_")}_#{@client.company.gsub(" ", "_")}_#{@invoice.number.gsub(" ", "_")}", type: "application/pdf"
  return true
end 
```

这是相当简单的代码，它所做的只是配置我的 PDFKit 并下载生成的 pdf。现在我想测试整个事情，包括：

*   实例变量的赋值（当然很简单，而且很有效）
*   数据的发送，即 pdf 的渲染 => 这就是我卡住的地方

我尝试了以下方法：

```
controller.should_receive(:send_data) 
```

但这给了我

```
Failure/Error: controller.should_receive(:send_data)
   (#<InvoicesController:0x007fd96fa3e580>).send_data(any args)
       expected: 1 time
       received: 0 times 
```

有谁知道测试pdf是否实际下载/发送的方法？此外，您还看到哪些内容需要测试以获得良好的测试覆盖率？例如，测试数据类型，即应用程序/pdf，会很好。

谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-07T19:46:06.210

不知道为什么你会失败，但你可以测试响应头：

```
response_headers["Content-Type"].should == "application/pdf"
response_headers["Content-Disposition"].should == "attachment; filename=\"<invoice_name>.pdf\"" 
```

您询问了有关更好的测试覆盖率的建议。我想我会推荐这个： [https](https://www.destroyallsoftware.com/screencasts) ://www.destroyallsoftware.com/screencasts 。这些截屏视频对我对测试驱动开发的理解产生了巨大的影响——强烈推荐！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-11-05T20:58:13.550

我建议使用[pdf-inspector](https://github.com/prawnpdf/pdf-inspector) gem 来编写与 PDF 相关的 Rails 操作的规范。

这是一个示例规范（假设 Rails操作在生成的 PDF 中`#report`写入有关模型的数据）：`Ticket`

```
describe 'GET /report.pdf' do
  it 'returns downloadable PDF with the ticket' do
    ticket = FactoryGirl.create :ticket

    get report_path, format: :pdf

    expect(response).to be_successful

    analysis = PDF::Inspector::Text.analyze response.body

    expect(analysis.strings).to include ticket.state
    expect(analysis.strings).to include ticket.title
  end
end 
```

# linux - 如果 CPU 平均负载很高会发生什么

> ID：15277353
> 
> 赞同：0
> 
> 时间：2013-03-07T17:05:59.330
> 
> 标签：linux, cpu, cpu-load

我读了一些关于 CPU 平均负载的文章。他们在谈论定义、CPU 使用率之间的差异以及最佳值（大致等于内核数）。他们还提到，如果数字很高，你会遇到麻烦（半夜醒来等），但如果数字很高，实际会发生什么？

例如，我一直在 4 核 Linux 服务器上运行 4、6 和 8 个会话。虽然完成任务所需的时间不同（4 次禁食，8 次最慢），但结果似乎还可以。CPU 平均负载大约为 4、8 和 10。我知道 10 可能不是一个好数字，但那又如何呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:17:15.777

就是这样：如果你运行的平​​均负载高得离谱，整体效率将受到影响：CPU 处理能力将被浪费。

这是由几个因素造成的；最直接的是调度竞争任务所需的更多 CPU 时间。一个非常重要的因素是几个竞争进程也会过度使用 CPU 缓存。每个任务切换都会有效地丢弃缓存内容并用新内容替换它们。进一步的瓶颈以内存和存储带宽的瓶颈形式出现。

# java - Spring MVC with JBoss vs Tomcat - 优势/实践

> ID：15277356
> 
> 赞同：15
> 
> 时间：2013-03-07T17:06:09.673
> 
> 标签：java, spring, jboss, application-server, web-container

好的。这又是一个行业实践的问题。

*   Tomcat = Web 容器
*   JBoss、WebLogic 等 = 具有 Web 容器的应用程序服务器（对于 JBoss，它的分叉 Tomcat）

Spring 不需要 JBoss 之类的 Application Server。如果我们使用 JMS 等企业服务，我们可以使用 RabbitMQ、ApacheMQ 等独立系统。

1.  问题是为什么人们仍然将 JBoss 和其他应用程序服务用于纯基于 Spring 的应用程序？
2.  通过使用应用程序服务器，Spring 可以利用哪些优势？像对象池一样？Application Server 提供了哪些具体优势？那些是如何配置的？
3.  如果不是用于 Spring，那么应用程序服务器用于 Spring/Hibernate 等堆栈的其他用途是什么？（用例）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T18:24:27.867

实际上我会说监听 JMS 可能是应用服务器的最佳理由。独立的消息代理不能解决问题，因为您仍然需要一个正在侦听消息的组件。最好的方法是使用 MDB。理论上你可以使用 Springs MessageListenerContainer。然而，这有几个缺点，例如 JMS 仅支持阻塞读取，因此 Spring 需要启动它自己的线程，这完全不受支持（即使在 Tomcat 中），并且可能会破坏事务、安全性、命名（JNDI）和类加载（这反过来会破坏远程）。JCA 资源适配器可以随意做任何事情，包括通过 WorkManager 启动线程。除了 JMS（或其他目的地）之外，可能还使用了一个数据库，此时您需要 XA 事务和 JTA，换句话说，一个应用程序服务器。

恕我直言，反对应用服务器的最大原因是规范发布后需要数年时间（这反过来也需要数年时间），直到服务器实施规范并消除最严重的错误。直到现在，就在 EE 7 即将发布之前，我们是否有 EE 6 服务器开始出现，它们并没有完全充满错误。一些供应商不再修复其 EE 6 产品线中的错误，因为他们已经忙于即将推出的 EE 7 产品线，这变得可笑了。

**编辑**

最后一段的详细解释：

Java EE 在很多地方都依赖于所谓的上下文信息。未作为参数从服务器/容器显式传递给应用程序但隐式“存在”的信息。例如当前用户进行安全检查。当前事务或连接。当前用于查找类以延迟加载代码或反序列化对象的应用程序。或者用于进行 JNDI 查找的当前组件（servlet、EJB、...）。所有这些信息都在服务器/容器在调用组件（servlet、EJB、...）之前设置的线程局部变量中。如果您创建自己的线程，则服务器/容器不知道它们，并且依赖此信息的所有功能都不再起作用。您可能会通过不使用您生成的线程中的任何这些功能来解决这个问题。

一些链接

[http://www.oracle.com/technetwork/java/restrictions-142267.html#threads](http://www.oracle.com/technetwork/java/restrictions-142267.html#threads) [http://www.ibm.com/developerworks/websphere/techjournal/0609_alcott/0609_alcott.html#spring-4](http://www.ibm.com/developerworks/websphere/techjournal/0609_alcott/0609_alcott.html#spring-4)

如果我们检查 Servlet 3.0 规范，我们会发现：

> 2.3.3.3 异步处理
> 
> Java Enterprise Edition 功能（例如第 15-174 页的第 15.2.2 节“Web 应用程序环境”和第 15-176 页的第 15.3.1 节“在 EJBTM 调用中传播安全身份”）仅适用于执行初始请求的线程或者当请求通过 AsyncContext.dispatch 方法分派到容器时。通过 AsyncContext.start(Runnable) 方法直接在响应对象上运行的其他线程可以使用 Java 企业版功能。

这是关于异步处理的，但同样的限制也适用于自定义线程。

> public void start(Runnable r) - 此方法使容器调度一个线程，可能来自托管线程池，以运行指定的 Runnable。容器可以将适当的上下文信息传播到 Runnable。

同样，异步处理，但同样的限制适用于自定义线程。

> 15.2.2 Web应用环境
> 
> 这种类型的 servlet 容器在开发人员创建的线程上执行时应该支持这种行为，但**目前不需要这样做**。这样的要求将在本规范的下一个版本中添加。开发人员需要注意的是，不建议依赖于应用程序创建的线程的此功能，因为它是不可移植的。

不可移植意味着它可以在一台服务器上但不能在另一台服务器上。

当您想在 MDB 之外使用 JMS 接收消息时，您可以使用以下四种方法`javax.jms.MessageConsumer`：

*   `#receiveNoWait()`您可以在容器线程中执行此操作，它不会阻塞，但就像偷看一样。如果没有消息，它只会返回`null`。这不太适合收听消息。
*   `#receive(long)`您可以在容器线程中对此进行处理，它确实会阻塞。您通常不希望在容器线程中进行阻塞等待。再次不太适合收听消息。
*   `#receive()`，这可能会无限期地阻塞。再次不太适合收听消息。
*   `#setMessageListener()`这就是你想要的，当消息到达时你会得到一个回调。但是，除非库可以连接到应用程序服务器，否则它不会是容器线程。应用程序服务器的挂钩只能通过 JCA 提供给资源适配器。

所以是的，它可能会起作用，但不能保证，并且有很多事情可能会破坏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T15:53:19.700

您说得对，您并不需要真正的应用程序服务器（实现所有 Java EE 规范）来使用 Spring。人们不使用像 JBoss 这样的真正的 Java EE 应用程序的最大原因是，在冷启动时速度很慢，因为 #$@#% 使开发变得痛苦（热部署仍然不能很好地工作）。

你看有两个阵营：

*   Java EE
*   春天框架。

一个阵营相信规范/委员会过程，另一个阵营相信仁慈的独裁者/有机 OSS 过程。两者都有自己的“议程”。

您可能不会得到一个非常好的公正答案，因为这[两个阵营很像 Emacs 与 VIM 之战](http://bill.burkecentral.com/2012/03/13/java-ee-wins-over-spring/)。

用 Spring 偏见回答您的问题

1.  因为它从理论上购买了您较少的供应商锁定（尽管我发现这是相反的）。
2.  Spring 最大的优势是 AspectJ AOP。到目前为止。
3.  我想看到菲利普的回答。

（开始吐槽）

自从@PhilippeMarschall 为 Java EE 辩护以来，我会说我已经完成了 Tomcat+RabbitMQ+Spring 路线，而且效果很好。@PhilippeMarschall 讨论是有效的，如果您想要正确的 JTA + JMS，但使用 Sprig AMQP 和像 Postgresql 这样的良好事务数据库进行正确设置，这不是一个问题。此外，他对消息队列事务未绑定/同步到平台事务的说法也不正确，因为 Spring 支持这一点（恕我直言，@Transactional AOP 更优雅）。**AMQP**也明显优于 JMS。

（吐槽结束）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T00:54:24.307

我们在 tomcat 上使用 JBoss 用于 JNDI 数据源和池。它使程序员不必了解数据库的任何信息，只需了解其 JNDI 名称

# java - 如何将数组的元素与标量值进行比较

> ID：15277359
> 
> 赞同：0
> 
> 时间：2013-03-07T17:06:23.380
> 
> 标签：java, arrays

如何将数组的元素与标量值进行比较？

这是有错误的代码部分：

```
if(month != numMonth[])
    System.out.printf("\n not a valid month");
if (day != daysInMonth[]  &&  day> daysOfMonth[month])
    System.out.printf("\n not a valid day");
if (year<1880 && year>2280)
    System.out.printf("\n not a valid year"); 
```

在`(day != daysInMonth[] && day> daysOfMonth[month])`expr 我得到一个类文件预期的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:24:16.750

我将建议一个更简单的替代方案（恕我直言）。

对于这项任务，我将`Calendar`直接使用该类，以避免将不同的日期和年份存储在数组中。闰年在这里的特定情况下可能是一个问题。

首先，验证年份。它们是该链中最简单的验证，并且与几个月一样，它们不依赖于输入的任何连续参数。在这种情况下，您所做的最后一次检查将成为第一次：

```
if (year < 1880 && year > 2280)
    System.out.printf("\n not a valid year"); 
```

验证年份后，验证月份。它们也是一个简单的数字，但您必须定义如何管理它们。我会选择范围`1 -> 12`：

```
if(month < 1 || month > 12)
    System.out.printf("\n not a valid month"); 
```

最后，您在`Calendar`. 这样，您可以获得对应于某个月份的正确天数。然后，您相应地进行验证。

```
Calendar cal = Calendar.getInstance();
cal.set(Calendar.YEAR, year);
cal.set(Calendar.MONTH, month - 1); //Calendar manages the months 
                                    //from 0 to 11, that's why 
                                    //you need to substract 1
int maxDays = cal.getActualMaximum(Calendar.DAY_OF_MONTH); 
```

`maxDays`包含给定月份和年份的最大天数。现在，您只需检查当天输入的 id 是否在范围内：

```
if (day < 1 || day > maxDays)
    System.out.printf("\n not a valid day"); 
```

这样，您无需跟踪每个月的日子，还可以管理闰年。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:08:32.767

利用

```
if (month < 0 || month > 11) 
```

或者

```
if (month < 1 || month > 12) 
```

取决于编号是从零开始还是从一开始。

＆C

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:09:35.907

您可以将数组的元素与标量进行比较，而不是整个数组。此外，您使用的语法仅在声明时有效：

```
int numMonth[] = new int[10];
or 
int numMonth[] = {1,2,3};

and so on 
```

要与单个标量进行比较，您需要引用要与之比较的元素：

```
// to compare with the 1st entry
numMonth[0] == month; // with arrays being zero based
// to compare with the 2nd entry
numMonth[1] == month;

and so on 
```

# ogg - 在 iOS 上使用 Ogg 打包 Speex

> ID：15277361
> 
> 赞同：2
> 
> 时间：2013-03-07T17:06:26.853
> 
> 标签：ogg, speex, jspeex

我正在使用 libogg 和 libogg，我已成功将这些库添加到我的 iPhone xCode 项目中，并使用 Speex 对我的声音进行编码。问题是我无法弄清楚如何用 ogg 打包这些音频数据包。有人知道这种数据包的外观或有我可以使用的参考代码吗？

我知道在 Java 中它非常简单（你有一个专门的功能）但在 iOS 上却不是。请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T11:26:39.507

UPD 10.09.2013：请看[演示项目](http://files.mikejd.ru/speexencodingdemo.zip)，它基本上从波形容器中获取 pcm 音频数据，使用 speex 编解码器对其进行编码，并将所有内容打包到 ogg 容器中。也许稍后我会为 IOS 上的所有 speex 例程创建一个成熟的库/框架。

UPD 16.02.2015：演示项目在 GitHub 上[重新发布。](https://github.com/mikejd/Speex-For-IOS)

* * *

我最近也在 iOS 上尝试使用 Speex，取得了不同程度的成功，但这是我发现的一些东西。基本上，如果你想将一些 speex 编码的语音打包到一个 ogg 文件中，你需要遵循三个步骤（假设 libogg 和 libspeex 已经编译并添加到项目中）。

1）添加第一个带有Speex header的ogg页面；libspeex 为此提供了内置[工具](http://speex.org/docs/api/speex-api-reference/group__SpeexHeader.html)（下面的代码来自我的项目，不是最佳的，只是为了举例）：

```
// create speex header 
SpeexHeader spxHeader;
SpeexMode spxMode = speex_wb_mode;
int spxRate = 16000;
int spxNumberOfChannels = 1;
speex_init_header(&spxHeader, spxRate, spxNumberOfChannels, &spxMode);

// set audio and ogg packing parameters
spxHeader.vbr = 0;
spxHeader.bitrate = 16;
spxHeader.frame_size = 320;
spxHeader.frames_per_packet = 1;

// wrap speex header in ogg packet
int oggPacketSize;
_oggPacket.packet = (unsigned char *)speex_header_to_packet(&spxHeader, &oggPacketSize);
_oggPacket.bytes = oggPacketSize;
_oggPacket.b_o_s = 1;
_oggPacket.e_o_s = 0;
_oggPacket.granulepos = 0;
_oggPacket.packetno = 0;

// submit the packet to the ogg streaming layer
ogg_stream_packetin(&_oggStreamState, &_oggPacket);
free(_oggPacket.packet);

// form an ogg page
ogg_stream_flush(&_oggStreamState, &_oggPage);

// write the page to file
[_oggFile appendBytes:&_oggStreamState.header length:_oggStreamState.header_fill];
[_oggFile appendBytes:_oggStreamState.body_data length:_oggStreamState.body_fill]; 
```

[2) 添加带有Vorbis 注释](http://www.xiph.org/vorbis/doc/v-comment.html)的第二个 ogg 页面：

```
// form any comment you like (I use custom struct with all fields)
vorbisCommentStruct *vorbisComment = calloc(sizeof(vorbisCommentStruct), sizeof(char));
...

// wrap Vorbis comment in ogg packet
_oggPacket.packet = (unsigned char *)vorbisComment;
_oggPacket.bytes = vorbisCommentLength;
_oggPacket.b_o_s = 0;
_oggPacket.e_o_s = 0;
_oggPacket.granulepos = 0;
_oggPacket.packetno = _oggStreamState.packetno;

// the rest should be same as in previous step
... 
```

3) 以类似的方式添加带有 speex 编码音频的后续 ogg 页面。

首先决定你想在每个 ogg 页面上有多少帧音频数据（0-255；我很随意地选择了 79）：

```
_framesPerOggPage = 79; 
```

然后对于每一帧：

```
// calculate current granule position of audio data within ogg file 
int curGranulePos = _spxSamplesPerFrame * _oggTotalFramesCount;

// wrap audio data in ogg packet
oggPacket.packet = (unsigned char *)spxFrame;
oggPacket.bytes = spxFrameLength;
oggPacket.granulepos = curGranulePos;
oggPacket.packetno = _oggStreamState.packetno;
oggPacket.b_o_s = 0;
oggPacket.e_o_s = 0;

// submit packets to streaming layer until their number reaches _framesPerOggPage
...

// if we've reached this limit, we're ready to create another ogg page

ogg_stream_flush(&_oggStreamState, &_oggPage);

[_oggFile appendBytes:&_oggStreamState.header length:_oggStreamState.header_fill];
[_oggFile appendBytes:_oggStreamState.body_data length:_oggStreamState.body_fill];

// finally, if this is the last frame, flush all remaining packets,
// which have been created but not packed into a page, to the last page 
// (don't forget to set oggPacket.e_o_s to 1 for this frame) 
```

就是这样。希望它会有所帮助。欢迎任何更正或问题。

# facet-wrap - ggplot facet_wrap：至少一层必须包含用于分面的所有变量

> ID：15277362
> 
> 赞同：5
> 
> 时间：2013-03-07T17:06:28.150
> 
> 标签：facet-wrap

我正在使用命令

```
qplot(factor(ww), WeeklyYield, geom = "bar", fill = I("grey50"))+facet_wrap(~model+name) 
```

`model`为和的每个组合创建条形图`name`。但是我收到以下错误消息：

> layout_base(data, vars, drop = drop) 中的错误：至少一层必须包含用于分面的所有变量

我无法解密此消息。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-10-26T14:23:23.867

我不确定这么长时间后它是否仍然有帮助，但我怀疑问题是你正在将公式输入`facet_wrap()`，而它只能接受一个变量，例如`facet_wrap(~model)`.

如果您想要一个公式，请尝试`facet_grid()`作为替代方案，例如`facet_grid(.~model+name)`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T10:44:06.053

看起来 ggplot 在您的数据框 WeeklyYield 中找不到“模型”和/或“名称”列。你应该检查`names(WeeklyYield)`

# android - 如何从Android中特定区域的位图中删除绘图

> ID：15277368
> 
> 赞同：3
> 
> 时间：2013-03-07T17:06:44.627
> 
> 标签：android, bitmap, region

我有一个位图对象。

我有一个代表位图一小部分的 Region 对象；

我想从该特定区域的位图对象中**删除绘图**并使该部分**透明**..

怎么做？任何帮助....

我正在使用android api-level 8 ..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T17:59:22.097

您可以简单地使用 使像素透明`mBitmap.setPixel (100,100,Color.TRANSPARENT);`，因此基本思想是遍历所有像素以使其透明，但如果您必须遍历太多像素，则可能会很慢。

**或者**

您可以使用`PorterDuffXferMode`使一部分透明，

例如，创建一个如下所述的绘画对象并将其传递给画布：

```
Paint mPaint = new Paint();
mPaint.setXferMode(new PorterDuffXferMode(PorterDuff.Mode.CLEAR)); 
```

您可以将其传递给画布，如下所述：

```
 Canvas c = new Canvas(mBitmap);
 c.drawCircle(cx, cy, radius, paint); 
```

它适用于圈子，但希望您能得到提示，根据您的需要为自定义区域执行此操作。

如果仍然无法正常工作，那么您可能必须禁用`Hardware Acceleration`该特定视图。有关详细信息，请参阅此[Google 文档](http://developer.android.com/guide/topics/graphics/hardware-accel.html#unsupported)。

希望这会给你一些提示。

# database - SQLite UPSERT / 更新或插入

> ID：15277373
> 
> 赞同：117
> 
> 时间：2013-03-07T17:06:52.673
> 
> 标签：database, sqlite, upsert

我需要对 SQLite 数据库执行 UPSERT / INSERT OR UPDATE。

有一个命令 INSERT OR REPLACE 在许多情况下可能很有用。但是，如果您想因为外键而使您的 id 保持在适当的位置，则它不起作用，因为它会删除该行，创建一个新行，因此该新行具有一个新 ID。

这将是表格：

玩家 -（id 上的主键，user_name 唯一）

```
|  id   | user_name |  age   |
------------------------------
|  1982 |   johnny  |  23    |
|  1983 |   steven  |  29    |
|  1984 |   pepee   |  40    | 
```

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2013-03-07T17:06:52.673

# 问答风格

好吧，在研究和解决这个问题几个小时后，我发现有两种方法可以实现这一点，具体取决于表的结构以及是否激活了外键限制以保持完整性。我想以一种简洁的格式分享这个，以便为可能处于我这种情况的人节省一些时间。

## 选项 1：您可以负担得起删除该行

换句话说，你没有外键，或者如果你有外键，你的 SQLite 引擎被配置为没有完整性异常。要走的路是*INSERT OR REPLACE*。如果您尝试插入/更新其 ID 已存在的播放器，SQLite 引擎将删除该行并插入您提供的数据。现在问题来了：如何保持旧 ID 关联？

假设我们要使用数据 user_name='steven' 和 age=32进行*UPSERT 。*

看看这段代码：

```
INSERT INTO players (id, name, age)

VALUES (
    coalesce((select id from players where user_name='steven'),
             (select max(id) from drawings) + 1),
    32) 
```

诀窍在于合并。它返回用户 'steven' 的 id（如果有），否则返回一个新的新 id。

## 选项 2：您不能删除该行

在尝试了之前的解决方案之后，我意识到在我的情况下这可能最终会破坏数据，因为这个 ID 作为其他表的外键。*此外，我使用ON DELETE CASCADE*子句创建了表，这意味着它会静默删除数据。危险的。

所以，我首先想到了一个 IF 子句，但 SQLite 只有*CASE*。如果 EXISTS（从 user_name='steven' 的玩家中选择 id ），则不能使用此*CASE （或者至少我没有管理它）执行一个**UPDATE*查询，如果没有则*INSERT 。*不去。

然后，最后我使用了蛮力，成功了。逻辑是，对于您要执行的每个*UPSERT ，首先执行**INSERT OR IGNORE*以确保我们的用户有一行，然后使用您尝试插入的完全相同的数据执行*UPDATE查询。*

与之前相同的数据：user_name='steven' 和 age=32。

```
-- make sure it exists
INSERT OR IGNORE INTO players (user_name, age) VALUES ('steven', 32); 

-- make sure it has the right data
UPDATE players SET user_name='steven', age=32 WHERE user_name='steven'; 
```

就这样！

## 编辑

正如 Andy 评论的那样，尝试先插入然后更新可能会导致触发触发器的频率比预期的要高。在我看来，这不是数据安全问题，但触发不必要的事件确实没有什么意义。因此，改进的解决方案是：

```
-- Try to update any existing row
UPDATE players SET age=32 WHERE user_name='steven';

-- Make sure it exists
INSERT OR IGNORE INTO players (user_name, age) VALUES ('steven', 32); 
```

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2018-06-06T11:10:18.607

这是一个迟到的答案。从 2018 年 6 月 4 日发布的 SQLIte 3.24.0 开始，终于有了对PostgreSQL 语法后的[UPSERT子句的支持。](http://www.sqlite.org/lang_UPSERT.html)

```
INSERT INTO players (user_name, age)
  VALUES('steven', 32) 
  ON CONFLICT(user_name) 
  DO UPDATE SET age=excluded.age; 
```

> 注意：对于那些必须使用早于 3.24.0 的 SQLite 版本的人，请参考下面的[答案](https://stackoverflow.com/a/38463024/168179)（由我发布，@MarqueIV）。
> 
> 但是，如果您确实可以选择升级，*强烈建议*您这样做，因为与我的解决方案不同，此处发布的解决方案在单个语句中实现了所需的行为。此外，您还可以获得更新版本通常附带的所有其他功能、改进和错误修复。

* * *

## 回答 #3

> 赞同：76
> 
> 时间：2016-07-19T15:41:05.477

这是一种不需要蛮力“忽略”的方法，该方法仅在存在密钥违规时才有效。这种方式基于您在更新中指定的*任何*条件工作。

试试这个...

```
-- Try to update any existing row
UPDATE players
SET age=32
WHERE user_name='steven';

-- If no update happened (i.e. the row didn't exist) then insert one
INSERT INTO players (user_name, age)
SELECT 'steven', 32
WHERE (Select Changes() = 0); 
```

## 这个怎么运作

这里的“魔法酱”在子句中`Changes()`使用`Where`。 `Changes()`表示受最后一次操作影响的行数，在这种情况下是更新。

在上面的示例中，如果更新没有更改（即记录不存在），则`Changes()`= 0，因此`Where`语句中的子句`Insert`评估为 true，并插入带有指定数据的新行。

如果`Update` *确实*更新了现有行，则`Changes()`= 1（或更准确地说，如果更新了不止一行，则不为零），因此`Insert`now 中的“Where”子句评估为 false，因此不会发生插入。

这样做的好处是不需要蛮力，也不需要删除，然后重新插入可能导致外键关系中下游键混乱的数据。

此外，由于它只是一个标准`Where`条款，它可以基于您定义的任何内容，而不仅仅是关键违规。同样，您可以`Changes()`在允许表达式的任何地方与您想要/需要的任何其他内容结合使用。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2015-01-13T15:35:59.447

所有给出的答案的问题是完全没有考虑触发器（可能还有其他副作用）。像这样的解决方案

```
INSERT OR IGNORE ...
UPDATE ... 
```

当行不存在时，导致执行两个触发器（用于插入，然后用于更新）。

正确的解决方案是

```
UPDATE OR IGNORE ...
INSERT OR IGNORE ... 
```

在这种情况下，只执行一条语句（当行存在或不存在时）。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-09-01T04:17:55.790

拥有一个没有漏洞的纯 UPSERT（对于程序员），不依赖唯一键和其他键：

```
UPDATE players SET user_name="gil", age=32 WHERE user_name='george'; 
SELECT changes(); 
```

SELECT changes() 将返回上次查询中完成的更新次数。然后检查changes()的返回值是否为0，如果是则执行：

```
INSERT INTO players (user_name, age) VALUES ('gil', 32); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-01-17T11:48:45.777

你也可以在你的 user_name 唯一约束中添加一个 ON CONFLICT REPLACE 子句，然后插入，让 SQLite 找出在发生冲突时该怎么做。请参阅：[https](https://sqlite.org/lang_conflict.html) ://sqlite.org/lang_conflict.html 。

还要注意关于删除触发器的句子：当 REPLACE 冲突解决策略删除行以满足约束时，当且仅当启用递归触发器时，删除触发器才会触发。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-08-03T10:59:08.040

# 选项 1：插入 -> 更新

如果您想避免两者`changes()=0`，`INSERT OR IGNORE`即使您无法删除该行 - 您可以使用此逻辑；

首先，**插入**（如果不存在），然后通过使用唯一键过滤进行**更新**。

# 例子

```
-- Table structure
CREATE TABLE players (
    id        INTEGER       PRIMARY KEY AUTOINCREMENT,
    user_name VARCHAR (255) NOT NULL
                            UNIQUE,
    age       INTEGER       NOT NULL
);

-- Insert if NOT exists
INSERT INTO players (user_name, age)
SELECT 'johnny', 20
WHERE NOT EXISTS (SELECT 1 FROM players WHERE user_name='johnny' AND age=20);

-- Update (will affect row, only if found)
-- no point to update user_name to 'johnny' since it's unique, and we filter by it as well
UPDATE players 
SET age=20 
WHERE user_name='johnny'; 
```

# 关于触发器

注意：我尚未对其进行测试以查看正在调用哪些触发器，但我**假设**以下内容：

## 如果行不存在

*   插入前
*   使用 INSTEAD OF 插入
*   插入后
*   更新前
*   使用 INSTEAD OF 更新
*   更新后

## 如果行确实存在

*   更新前
*   使用 INSTEAD OF 更新
*   更新后

# 选项 2：插入或替换 - 保留您自己的 ID

这样你就可以有一个单一的SQL命令

```
-- Table structure
CREATE TABLE players (
    id        INTEGER       PRIMARY KEY AUTOINCREMENT,
    user_name VARCHAR (255) NOT NULL
                            UNIQUE,
    age       INTEGER       NOT NULL
);

-- Single command to insert or update
INSERT OR REPLACE INTO players 
(id, user_name, age) 
VALUES ((SELECT id from players WHERE user_name='johnny' AND age=20),
        'johnny',
        20); 
```

编辑：添加选项 2。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-02-25T10:40:01.257

对于那些拥有最新版本的 sqlite 的人，您仍然可以使用 INSERT OR REPLACE 在单个语句中执行此操作，但请注意您需要设置所有值。然而，这个“聪明”的 SQL 通过在要插入/更新的表上使用左连接和 ifnull 来工作：

```
import sqlite3

con = sqlite3.connect( ":memory:" )

cur = con.cursor()
cur.execute("create table test( id varchar(20) PRIMARY KEY, value int, value2 int )")
cur.executemany("insert into test (id, value, value2) values (:id, :value, :value2)",
        [ {'id': 'A', 'value' : 1, 'value2' : 8 }, {'id': 'B', 'value' : 3, 'value2' : 10 } ] )
cur.execute('select * from test')
print( cur.fetchall())

con.commit()
cur = con.cursor()

# upsert using insert or replace. 
 # when id is found it should modify value but ignore value2
 # when id is not found it will enter a record with value and value2
upsert = '''
   insert or replace into test
        select d.id, d.value, ifnull(t.value2, d.value2) from ( select :id as id, :value as value, :value2 as value2 ) d  
           left join test t on d.id = t.id
    '''           

upsert_data = [ { 'id' : 'B', 'value' : 4, 'value2' : 5 },
                { 'id' : 'C', 'value' : 3, 'value2' : 12 } ]

cur.executemany( upsert, upsert_data )

cur.execute('select * from test')
print( cur.fetchall()) 
```

该代码的前几行用于设置表，其中包含一个 ID 主键列和两个值。然后输入 ID 为“A”和“B”的数据

第二部分创建“upsert”文本，并为 2 行数据调用它，其中一行的 ID 为“B”，但未找到，另一行的 ID 为“C”。

当你运行它时，你会发现最后产生的数据

```
$python3 main.py
[('A', 1, 8), ('B', 3, 10)]
[('A', 1, 8), ('B', 4, 10), ('C', 3, 12)] 
```

B 将值“更新”为 4，但忽略了 value2 (5)，插入了 C。

注意：如果您的表具有自动递增的主键，则这不起作用，因为 INSERT OR REPLACE 将用新的数字替换该数字。

添加这样一列的轻微修改

```
import sqlite3

con = sqlite3.connect( ":memory:" )

cur = con.cursor()
cur.execute("create table test( pkey integer primary key autoincrement not null, id varchar(20) UNIQUE not null, value int, value2 int )")
cur.executemany("insert into test (id, value, value2) values (:id, :value, :value2)",
        [ {'id': 'A', 'value' : 1, 'value2' : 8 }, {'id': 'B', 'value' : 3, 'value2' : 10 } ] )
cur.execute('select * from test')
print( cur.fetchall())

con.commit()
cur = con.cursor()

# upsert using insert or replace. 
 # when id is found it should modify value but ignore value2
 # when id is not found it will enter a record with value and value2
upsert = '''
   insert or replace into test (id, value, value2)
        select d.id, d.value, ifnull(t.value2, d.value2) from ( select :id as id, :value as value, :value2 as value2 ) d  
           left join test t on d.id = t.id
    '''           

upsert_data = [ { 'id' : 'B', 'value' : 4, 'value2' : 5 },
                { 'id' : 'C', 'value' : 3, 'value2' : 12 } ]

cur.executemany( upsert, upsert_data )

cur.execute('select * from test')
print( cur.fetchall()) 
```

现在的输出是：

```
$python3 main.py
[(1, 'A', 1, 8), (2, 'B', 3, 10)]
[(1, 'A', 1, 8), (3, 'B', 4, 10), (4, 'C', 3, 12)] 
```

注意 pkey 2 被 3 替换为 id 'B'

因此，这并不理想，但在以下情况下是一个很好的解决方案：

*   您没有自动生成的主键
*   您想创建一个带有绑定参数的“upsert”查询
*   您想使用 executemany() 一次性合并多行数据。

# android - 如何将帖子发送到 Facebook 朋友的墙 android SDK 3.0

> ID：15277381
> 
> 赞同：4
> 
> 时间：2013-03-07T17:07:26.457
> 
> 标签：android, facebook, android-facebook

我想使用（android）Facebook SDK 3.0 在 Facebook 朋友的墙上发帖。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:14:14.370

> 适用于 Android 的 Facebook SDK 提供了一种方法，可让您将应用中的故事发布到用户的时间线。您还可以使用此方法代表您的用户发布状态更新。此方法使用 Graph API，是使用 Feed Dialog 的替代方法

[http://developers.facebook.com/docs/howtos/androidsdk/3.0/publish-to-feed/](http://developers.facebook.com/docs/howtos/androidsdk/3.0/publish-to-feed/)

# android - Android Button 将图像置于中心，将文本置于底部

> ID：15277382
> 
> 赞同：16
> 
> 时间：2013-03-07T17:07:27.077
> 
> 标签：android, image, button, text, center

我想将图像放在中心，并将文本放在按钮下方，我尝试设置 android:gravity 但无法正确设置，这是附上的图像：

![在此处输入图像描述](../Images/0e64b4ae7a4b23ae6ff65f6444b04791.png)

下面是我的xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:paddingLeft="10.0dip" 
    android:paddingTop="10.0dip" 
    android:paddingRight="10.0dip" 
    android:paddingBottom="10.0dip"    
    android:background="@drawable/background_img"
    >

    <LinearLayout
        android:layout_height="0dp"
        android:layout_width="match_parent"
        android:layout_weight="1"
        android:orientation="horizontal"
        android:paddingLeft="10.0dip" 
        android:paddingTop="10.0dip" 
        android:paddingRight="10.0dip" 
        android:paddingBottom="10.0dip"          
        >

        <Button          
            android:layout_height="match_parent"
            android:layout_width="0dp"
            android:layout_weight="1"
            android:id="@+id/button_listen"
            android:text="@string/listen"
            android:drawableTop="@drawable/listen_btn"
            android:layout_marginLeft="10dp"
            android:layout_marginRight="10dp"
            android:layout_marginTop="10dp"
            android:layout_marginBottom="10dp"      
            android:layout_gravity="center"
            />
        <Button
            android:layout_height="match_parent"
            android:layout_width="0dp"
            android:layout_weight="1"
            android:id="@+id/button_gallery"
            android:text="@string/gallery"
            android:drawableTop="@drawable/gallery_btn"
            android:layout_marginLeft="10dp"    
            android:layout_marginRight="10dp"    
            android:layout_marginTop="10dp"    
            android:layout_marginBottom="10dp"   
            android:layout_gravity="center"
            />
    </LinearLayout>
    <LinearLayout
        android:layout_height="0dp"
        android:layout_width="match_parent"
        android:layout_weight="1"
        android:orientation="horizontal"
        android:paddingLeft="10.0dip" 
        android:paddingTop="10.0dip" 
        android:paddingRight="10.0dip" 
        android:paddingBottom="10.0dip"              
        >

        <Button
            android:layout_height="match_parent"
            android:layout_width="0dp"
            android:layout_weight="1"
            android:id="@+id/button_play"
            android:text="@string/play"                
            android:drawableTop="@drawable/play_btn"
            android:layout_marginLeft="10dp"
            android:layout_gravity="center"
            android:layout_marginRight="10dp"
            android:layout_marginTop="10dp"
            android:layout_marginBottom="10dp"
            />
        <Button
            android:layout_height="match_parent"
            android:layout_width="0dp"
            android:layout_weight="1"
            android:id="@+id/button_find"
            android:text="@string/find"
            android:drawableTop="@drawable/test_btn"
            android:layout_marginLeft="10dp"
            android:layout_marginRight="10dp"
            android:layout_marginTop="10dp"    
            android:layout_marginBottom="10dp" 
            android:layout_gravity="center"
            />        
    </LinearLayout>
</LinearLayout> 
```

将图像和文本置于其下方的正确方法是什么？

提前谢谢了。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-07T17:14:38.147

试试这个它对我的工作

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >
<Button
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:layout_marginBottom="151dp"
        android:onClick="onClick"
        android:drawableTop="@drawable/ic_launcher"
        android:text="Button" />
</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-10T16:31:00.387

尝试将按钮更改为 LinearLayout 并在 fakebutton 上使用相同的 onclicklistener

```
 <LinearLayout
        android:id="@+id/fakeButton"
        android:layout_width="0dp"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:gravity="center_vertical|center_horizontal"
        android:orientation="vertical" >

        <ImageView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/icon_big_evento" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/menu_about" />
    </LinearLayout> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-10T07:12:14.243

我按照 DjHacktorReborn 的评论做了布局，这里是冻结的

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/background_img"
    android:orientation="vertical" >
  <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:orientation="vertical"
        android:weightSum="10" >    
      <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_weight="4.1"
            android:orientation="vertical" >
        </LinearLayout>        
        <TableLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:layout_weight="2"
                android:orientation="horizontal"
                android:stretchColumns="*" >    
                 <TableRow android:layout_weight="1" >
                      <RelativeLayout
                        android:layout_width="match_parent"
                        android:layout_height="match_parent" >

                        <Button
                            android:id="@+id/button_listen"
                            android:layout_width="match_parent"
                            android:layout_height="match_parent"
                            android:layout_centerInParent="true"
                            android:background="@drawable/main_list"

                            android:paddingTop="90dp"

                            android:text="@string/listen"
                            android:textStyle="bold"
                            android:textColor="#FFFFFF" />

                        <ImageView
                            android:id="@+id/main_icon_content_image_view"
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:layout_centerInParent="true"
                            android:src="@drawable/listen_btn" />
                    </RelativeLayout>
                     <RelativeLayout
                        android:layout_width="match_parent"
                        android:layout_height="match_parent" >

                        <Button
                            android:id="@+id/button_gallery"
                            android:layout_width="match_parent"
                            android:layout_height="match_parent"
                            android:background="@drawable/main_list"

                            android:paddingTop="90dp"

                            android:text="@string/gallery"
                             android:textStyle="bold"
                            android:textColor="#FFFFFF" />

                        <ImageView
                            android:id="@+id/main_icon_schedule_image_view"
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:layout_centerInParent="true"
                            android:src="@drawable/gallery_btn" />
                    </RelativeLayout>
                      </TableRow>
                      <TableRow android:layout_weight="1" >

                    <RelativeLayout
                        android:layout_width="match_parent"
                        android:layout_height="match_parent" >

                        <Button
                            android:id="@+id/button_play"
                            android:layout_width="match_parent"
                            android:layout_height="match_parent"
                            android:background="@drawable/main_list"
                            android:ellipsize="marquee"

                            android:paddingTop="90dp"

                            android:text="@string/play"
                             android:textStyle="bold"
                            android:textColor="#FFFFFF"
                             />

                        <ImageView
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:layout_centerInParent="true"
                            android:src="@drawable/play_btn" />
                    </RelativeLayout>

                    <RelativeLayout
                        android:layout_width="match_parent"
                        android:layout_height="match_parent" >

                        <Button
                            android:id="@+id/button_find"
                            android:layout_width="match_parent"
                            android:layout_height="match_parent"
                            android:background="@drawable/main_list"

                            android:paddingTop="90dp"

                            android:text="@string/find"
                             android:textStyle="bold"
                            android:textColor="#FFFFFF" />

                        <ImageView

                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:layout_centerInParent="true"
                            android:src="@drawable/test_btn" />
                    </RelativeLayout>

                </TableRow>
    </TableLayout>                      
         <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_weight="4.1"
            android:orientation="vertical" >
        </LinearLayout>        
</LinearLayout>
</LinearLayout> 
```

这是更新的结果

![在此处输入图像描述](../Images/68e081675a6e169b88ca5b23c0d615f6.png)

感谢您的建议

# view - Ember.js - 子嵌套视图的控制器

> ID：15277385
> 
> 赞同：1
> 
> 时间：2013-03-07T17:07:31.280
> 
> 标签：view, controller, ember.js

我正在用 Ember 构建一个简单的日历应用程序。我的观点是这样嵌套的：

```
<script type="text/x-handlebars" data-template-name="calendar">
    {{content.monthAsString}}
    {{#each day in content.days}}
       {{view App.DayView contentBinding="day"}}
    {{/each}}
</script>

<script type="text/x-handlebars" data-template-name'="calendarDay">
    {{content.date}}
</script> 
```

我的 JS 代码：

```
App.CalendarController = Ember.ObjectController.extend({
    content:App.Calendar.create(...);
    oneDayHover:function(day){

    }
});
App.CalendarView = Ember.View.extend({
    templateName:"calendar"
});

App.CalendarDayController = Ember.ObjectController.extend({
    dayHOver:function(){
        //???? HOW TO ACCESS CalendarController?????
    }
});
App.CalendarDayView = Ember.View.extend({
    templateName:"calendarDay",
    init:function(){
        this._super();
        this.set('controller', App.CalendarDayController.create());
    },
    mouseEnter:function(){
        this.get('controller').dayHover();
    }
}); 
```

问题1：没有比重写视图的init方法来设置它的控制器更好的解决方案吗？

问题2：如何从CalendarDayController访问CalendarController的oneDayHover？

在此先感谢您的帮助

**更新 1：** 我应该说这些控制器存在于相同的状态。mouseenter 的目的是在 CalendarDayView 顶部显示一个包含额外信息的弹出窗口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:15:09.083

**1 - 不要手动将控制器分配给视图。**让 Ember 完成繁重的工作！查看 Embers Router API / 如何定义路由。路由将连接控制器和视图并渲染它们（[Doc](http://emberjs.com/guides/routing/)）。

**2 -**如果您遵循第 1 点，您的其他问题将通过 Embers 依赖注入方式变得容易：

```
App.CalendarDayController = Ember.ObjectController.extend({
    needs : ["calendar"],
    dayHOver:function(){
        //Access the single instance of CalendarController
        var calendarController = this.get("controllers.calendar");
    }
}); 
```

**更新以回应评论：**

CalendarRoute 是隐式创建的。因此，您需要做的就是修改您的模板，我猜：

```
<script type="text/x-handlebars" data-template-name="calendar">
    {{content.monthAsString}}
    {{#each day in content.days}}
       {{control "calendarDay" day}}
    {{/each}}
</script> 
```

如您所见，我建议使用**{{control}}**助手。上面的代码基本上说的是：

> “亲爱的 Ember，请使用名称 'calendarDay' 来查找 App.CalendarView 和 App.CalendarDayController 并使用它们来渲染对象日”

此外，您必须告诉 ember，它不应该**将控制器用作单例**（这是默认行为）：

```
App.register('controller:calendarDay', App.CalendarDayController, {singleton: false }); 
```

**注意：**我自己还没有使用控制助手，但这应该是它的工作方式。

# matlab - Exp 的自定义算法。Matlab中的最大化

> ID：15277388
> 
> 赞同：2
> 
> 时间：2013-03-07T17:07:33.727
> 
> 标签：matlab, machine-learning, gaussian, normal-distribution

我尝试编写一个算法，从混合多元正态分布中确定每个类的 $\mu$, $\sigma$,$\pi$。

我部分完成了算法，当我将随机猜测值（$\mu$，$\sigma$，$\pi$）设置为接近真实值时，它会起作用。但是当我将值设置为远离真实值时，算法不会收敛。sigma 为 0 $(2.30760684053766e-24 2.30760684053766e-24)$。

我认为问题在于我的协方差计算，我不确定这是正确的方法。我在维基百科上找到了这个![在此处输入图像描述](../Images/6bd3898010e191147e16c4b55a4d5eb1.png)。如果您能检查我的算法，我将不胜感激。尤其是协方差部分。

祝你有美好的一天，谢谢，

```
2 mixture gauss
size x  = [400, 2] (400 point 2 dimension gauss)
mu = 2 , 2 (1 row = first gauss mu, 2 row = second gauss mu)

    for i = 1 : k
        gaussEvaluation(i,:) = pInit(i) * mvnpdf(x,muInit(i,:), sigmaInit(i, :) * eye(d));
        gaussEvaluationSum = sum(gaussEvaluation(i, :));

        %mu calculation
        for j = 1 : d
            mu(i, j) = sum(gaussEvaluation(i, :) * x(:, j)) / gaussEvaluationSum;
        end
       %sigma calculation methode 1
       %for j = 1 : n 
        %    v = (x(j, :) - muNew(i, :));
        %    sigmaNew(i) = sigmaNew(i) + gaussEvaluation(i,j) * (v * v');
        %end
        %sigmaNew(i) = sigmaNew(i) / gaussEvaluationSum;

        %sigma calculation methode 2
        sub = bsxfun(@minus, x, mu(i,:));
        sigma(i,:) = sum(gaussEvaluation(i,:) * (sub .* sub)) / gaussEvaluationSum;

        %p calculation

        p(i) = gaussEvaluationSum / n; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:38:28.703

**两点：即使您正确实现了高斯混合 EM，您也可以观察到这一点，但在您的情况下，代码似乎确实不正确。**

首先，这只是拟合高斯混合时必须处理的问题。有时，混合物的一个成分可能会塌陷到一个点上，导致该成分的平均值变为该点而方差变为 0；这被称为“奇点”。因此，可能性也趋于无穷大。

查看此套牌的第 42 张幻灯片：[http ://www.cs.ubbcluj.ro/~csatol/gep_tan/Bishop-CUED-2006.pdf](http://www.cs.ubbcluj.ro/~csatol/gep_tan/Bishop-CUED-2006.pdf)

您正在评估的似然函数不是对数凹函数，因此 EM 算法不会收敛到具有不同初始值的相同参数。我在上面给出的链接还提供了一些解决方案来避免这种过度拟合问题，例如在您的参数上放置一个先验或正则化项。您还可以考虑使用不同的起始参数运行多次，并将方差为 0 的任何结果视为过度拟合而丢弃，或者只是减少您正在使用的组件数量。

在您的情况下，您的等式是正确的；Wikipedia 上的协方差更新计算与上述链接的幻灯片 45 上的计算相同。但是，如果您在 2d 空间中，则对于每个分量，均值应该是长度为 2 的向量，协方差应该是 2x2 矩阵。因此，您的代码（对于两个组件）是错误的，因为您有一个 2x2 矩阵来存储均值和一个 2x2 矩阵来存储协方差；它应该是一个 2x2x2 矩阵。

# android - 从起点、行驶时和终点路由一个位置

> ID：15277397
> 
> 赞同：-2
> 
> 时间：2013-03-07T17:07:52.080
> 
> 标签：android, google-maps, gps

我正在为我的同事创建一个地图路由应用程序来跟踪他们的位置作为旅行。我该如何执行以下操作：

当应用程序启动并**创建一个标记**时，我**得到他们的当前位置**，当他们开始驾驶时，我想从开始标记**画一条线并****跟随他们的行程**进入工作，然后用另一个标记结束行程。

 ******我正在使用**Google API** v1。我的公司有用户许可证。. 我看过很多使用 RouteOverlay 的帖子，但这对我来说从来没有用过。我只想在开车时跟随司机的路线。

我为一家公司工作，该公司是一个内置位置等的 m2m 平台。这里已经有一个苹果用户使用的 IOS 应用程序。**他们打开应用程序，它会获得一个位置，当他们开车时，它会向我们的平台发送一个 httppost**。www.axeda.com

我试图**在 Android 上模仿这一点**，我在其中启动应用程序，它获取当前位置并将其发布到我们的服务器，然后在我开车时，每 200 英尺它会发布位置，直到我停止旅行。我正在尝试从起点绘制路径/路线，直到旅行结束。我希望能澄清它。（DB、Tomcat、WebApp等是我们的业务）

如果您可以从显示位置 A 到 B 的一些代码开始我有一条路线，然后我将更改的位置模拟到 C 并路由到那里，我会顺利进行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:27:20.793

3 月 13 日：跳过所有这些文本和两张漂亮的图片，从带有“2013 年 3 月 13 日编辑：”标签的部分开始阅读。

请说清楚：

1.  您打算使用什么映射 API？googleMaps 将以至少 100 个用户的增量向您收取 25 美元（我收到的最后一次报价），除非它是 100% 免费、无用户的应用程序，且浏览量低于一定数量。

2.  您打算在哪里查看地图（智能手机/平板电脑或网络）？

我建议您使用 OpenLayers。有[很多例子](http://openlayers.org/dev/examples/)可以帮助你理解它的工作方式。

如果你想做的是这样的：

![动画 OPENLAYERS MAP](../Images/89a3ffe3da8fd367c1050115e2828932.png)

您将需要使用具有开放端口或使用非常不安全的“post to http”策略的 LAMP 服务器（linux、apache、mysql、php），以及使用“刷新策略”的 openlayers。

如果您想要这样的静态地图（对不起，开头有一个标志，但我没有任何图像 - 相信我，它就在那里，就在框架之外）：

![带轨道的地图](../Images/4b24de3b1b10c4202569b3c79334d234.png)

那么你就不会使用刷新策略了，但是，这不是在公园里散步（技术很简单，调试的是一只母狗）。

不想在你的游行上下雨，但是，这可能不是周末项目，除非你想让它工作，但只是有点......

注意：在这两种情况下，我都使用 KML 源来获取地理数据（从智能手机上的 gps 或 wifi 收集的 MySQL 存储数据解析 - 实际上我的应用程序也集成了 RFID 和车辆跟踪器）。请查看[我关于该主题的其他帖子](https://stackoverflow.com/questions/2995238/refresh-redraw-a-layer-in-openlayers-kml-network-link-auto-refresh/11333611#11333611)（使用正确的代码说明如何操作）。

**2013 年 3 月 13 日** 在您解释后编辑，这是使用 googleMaps API 的方法（根据您在下面的评论）：

在您的地图上创建几个叠加层

```
 mapOverlays.add(new MapOverlayTrip(pathTrip));
    mapOverlays.add(new MapOverlayPointer(location));

    //redraw map
    mapView.invalidate();
    flagMapRedraw = false; 
```

...

```
public class MapOverlayTrip extends Overlay implements TextToSpeech.OnInitListener, OnTouchListener {` 
```

例如（如果您的应用不说话，您可以删除 TTS）。...

```
@Override
public void draw(Canvas canvas, MapView mapv, boolean shadow){
    super.draw(canvas, mapv, shadow); 
```

...

```
 PathPoint pathPointTemp;
    Path pathScreenNewArea = new Path();
    Path pathScreen = new Path();
    Point p1 = new Point(0,0);
    Point p2 = new Point(0,0);
    projection = (Projection) mapv.getProjection();
    for (int j = 0; j < pathTrip.size();j++) {
        p1 = new Point();
        projection.toPixels(pathTrip.get(j),p1);
        if (j == 0) {
            pathScreen.moveTo(p1.x, p1.y);
            p2 = (Point) p1;
        } else {
            pathScreen.lineTo(p1.x, p1.y);
        } 
```

使用 PathPoint 类

```
public class PathPoint {

public float x;
public float y; 
```

在我的主要活动中更新

```
public void onLocationChanged(Location locationIn) {
    location = locationIn;
            //redraw map
    geoPoint = locationConvert(location);
    geoPointLast = pathTrip.get(pathTrip.size()-1);
            if (your conditions compare current displacement) {
                 pathTrip.add(geoPoint); 
```

这些是在 android 屏幕上进行绘图的全功能代码的摘录。

对于更新，我不喜欢 http 帖子，我更信任套接字，但是，我有两个解决方案并行工作 6 个月，并且它们的性能非常相似（命中/未命中率）。这是我用来同时调用套接字和 http 的通用解决方案

```
public boolean geoPointInsert (GeoLocPoint geoPointIn) {
    boolean flagOK = false;
    if (geoPointIn != null) {
        try {
            String webPostAnswer = deviceIdCheck(deviceUuid, geoPointIn); 
```

这是处理 http 帖子的代码

```
try {
        HttpClient client = new DefaultHttpClient();
        HttpGet request = new HttpGet();
        //Log.v(TAG, "okok deviceId = "+deviceUuidIn +" latitude "+geoPointIn.latitude);
        String uri = "http://www.yourdomain.net/tracker/" +
                "trackPointListener.php";
        uri = addLocationToUrl(uri, geoPointIn);
        request.setURI(new URI(uri));
        //Log.i(TAG,uri);
        HttpResponse response = client.execute(request);
        //Log.d(TAG, "php answered> "+response); 
```

恕我直言，http 比套接字连接承担更大的责任，尽管两者都可能受到拒绝服务攻击。

正如我所说，不是周末项目。******

# php - Codecepetion Acceptance Test with self signed SSL

> ID：15277400
> 
> 赞同：1
> 
> 时间：2013-03-07T17:07:58.180
> 
> 标签：php, curl, acceptance-testing, mink, guzzle

I am trying to login to my app using `WebGuy`. I created a `Cept` file `MergeCompaniesCept.php` with contents:

```
$I = new WebGuy($scenario);
$I->wantTo('login into admin, merge companies, & verify data');
$I->amOnPage('/login.php');
$I->fillField("username","name");
$I->fillField("password","xxxxxxxxxxxxxxxxx");
$I->click("LOGIN"); 
```

But I get the following error:

```
[Codeception\Exception\ModuleConfig]                                                     
Codeception\Util\Mink module is not configured!                                          
Provided URL can't be accessed by this driver.

[curl] 77: [url] https://localhost/
[info]

array(                                                                              
    'url' => 'https://localhost/',                                                         
    'content_type' => NULL,                                                                
    'http_code' => 0,                                                                      
    'header_size' => 0,                                                                    
    'request_size' => 0,                                                                   
    'filetime' => -1,                                                                      
    'ssl_verify_result' => 0,                                                              
    'redirect_count' => 0,                                                                 
    'total_time' => 0.002284,                                                              
    'namelookup_time' => 0.00214,                                                          
    'connect_time' => 0.002295,                                                            
    'pretransfer_time' => 0,                                                               
    'size_upload' => 0,                                                                    
    'size_download' => 0,                                                                  
    'speed_download' => 0,                                                                 
    'speed_upload' => 0,                                                                   
    'download_content_length' => -1,                                                       
    'upload_content_length' => -1,                                                         
    'starttransfer_time' => 0,                                                             
    'redirect_time' => 0,                                                                  
    'certinfo' =>                                                                             
),
array (                                                                              
    'primary_ip' => '127.0.0.1',                                                           
    'primary_port' => 443,                                                                 
    'local_ip' => '127.0.0.1',                                                             
    'local_port' => 41951,                                                                 
    'redirect_url' => '',                                                                  
)
[debug]                                                                                

 run [-c|--config[="..."]] [--report] [--html] [--xml] [--tap] [--json] [--colors]     [--silent] [--steps] [--debug] [-cc|--coverage] [--no-exit] [suite] [test] 
```

I thought the issue was related to self signed cert and the use of curl without -k, so I made the following change to WebHelper

```
<?php
namespace Codeception\Module;

class WebHelper extends \Codeception\Module\PhpBrowser {
    public function _initialize() {
        $client = new \Behat\Mink\Driver\Goutte\Client();
        $driver = new \Behat\Mink\Driver\GoutteDriver($client);
        $client->setClient(new \Guzzle\Http\Client('', array(
            'curl.CURLOPT_SSL_VERIFYPEER' => false,
            'curl.CURLOPT_CERTINFO'       => false
        ))); 
        $this->session = new \Behat\Mink\Session($driver);
        parent::_initialize();
    }
} 
```

However, the same error still persists.

Any help here would be much appreciated!

**Update**

The following changes finally fixed the issue:

```
<?php
namespace Codeception\Module;

class WebHelper extends \Codeception\Module\PhpBrowser {
    public function _initialize() {
        $client = new \Behat\Mink\Driver\Goutte\Client();
        $driver = new \Behat\Mink\Driver\GoutteDriver($client);
        $client->setClient(new \Guzzle\Http\Client('', array(
        //'curl.CURLOPT_SSL_VERIFYPEER' => false,
        //'curl.CURLOPT_CERTINFO'       => false
        'ssl.certificate_authority' => false
        ))); 
        $this->session = new \Behat\Mink\Session($driver);
        //parent::_initialize();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-27T16:50:36.013

Try the following:

```
capabilities:
              acceptSslCerts: true
              acceptInsecureCerts: true 
```

at acceptance.suite.yml

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-18T21:08:43.610

Use the `ssl.certificate_authority` option:

```
$client = new Client($baseUrl, [
    'ssl.certificate_authority' => false,
]); 
```

# jquery - jquery滑块按钮卡在“悬停”上

> ID：15277402
> 
> 赞同：1
> 
> 时间：2013-03-07T17:08:01.240
> 
> 标签：jquery, html, css, slider

[现场直播](http://frshstudio.com/#home)

我的 jQuery 内容滑块的右键似乎卡在“悬停”上。我检查了 html、css 和图像路径 - 一切似乎都应该如此。我的 jQuery 技能还不够好，无法确定是否存在问题-

HTML

```
<div id="slider_mask">
        <div class="slide_container">
            <div class="slide"><p>is where creative <i>je ne sais quoi</i> + business savvy collide.</p></div>
            <div class="slide"><p>is the maker + doer for makers + doers</p></div>
            <div class="slide">
                    <ul>
                    <?php if ($maxitems == 0) echo '<li>No items.</li>';
                    else
                    // Loop through each feed item and display each item as a hyperlink.
                    foreach ( $rss_items as $item ) : ?>
                    <li>
                    <a href='<?php echo $item->get_permalink(); ?>'>
                    <?php echo $item->get_title(); ?>
                    </a>
                    </li>
                    <?php endforeach; ?>
                    </ul>
                </div>
        </div>
        <div class="left_button"><a href="#" class="left-arrow" title="left arrow"></a></div>
        <div class="right_button"><a href="#" class="right-arrow" title="right arrow"></a></div>
    </div> 
```

CSS

```
#home #slider_mask {
    width: 420px;
    margin: 0 auto;
    padding-top: 60px;
    position: relative;
    overflow: hidden;
}

#home #slider_mask .left_button {
    float: left;
    display: block;
    width: 23px;
    height: 25px;
    background: url(img/left-arrow.png);
    text-indent: -99999px;
}

#home #slider_mask .left_button:hover {
    background: url(img/left-arrow-hover.png);
    background-position: 0 0;
}

#home #slider_mask .slide_container {
    float: left;
    font-size: 120%;
    text-align: center;
    width: 420px;
}

#home #slider_mask .right_button {
    float: right;
    display: block;
    width: 23px;
    height: 25px;
    background: url(img/right-arrow.png);
    text-indent: -99999px;
}

#home #slider_mask .right_button {
    background: url(img/right-arrow-hover.png);
    background-position: 0 0;
}

#home #slider_mask .slide {
    float: left;
    display: block;
    text-align: center;
} 
```

jQuery

```
jQuery(document).ready(function($){
// Setup Variables
var slides = $('#slider_mask .slide_container').children();
var total_slides = slides.length; // ***CHANGED***
var slide_width = $('#slider_mask').width();
var current_slide = 0;

// ***REMOVED*** slides.not(':first').hide();
// Set the width of the slide_container to total width of all slides
$('#slider_mask .slide_container').width(slide_width*total_slides);

slides.width(slide_width); // ***ADDED***

// Handle Right Arrow Click
$('#slider_mask .right_button').on('click', function() {

    current_slide++;

    if(current_slide == total_slides){ current_slide = 0; }

    var negative_margin_required = current_slide*slide_width;
    $('#slider_mask .slide_container').stop().animate({marginLeft:-negative_margin_required+'px'},'fast');

});

// Handle Left Arrow Click
$('#slider_mask .left_button').on('click', function() {

    current_slide--;

    if(current_slide < 0){ current_slide = total_slides-1; }

    var negative_margin_required = current_slide*slide_width;
    $('#slider_mask .slide_container').stop().animate({marginLeft:-negative_margin_required+'px'},'fast');

}); 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:28:03.010

改变这个：

```
#home #slider_mask .right_button {
    background: url(img/right-arrow-hover.png);
    background-position: 0 0;
} 
```

至：

```
#home #slider_mask .right_button:hover {
    background: url(img/right-arrow-hover.png);
    background-position: 0 0;
} 
```

# javascript - 触发window.onbeforeunload时如何检测是否点击了链接？

> ID：15277403
> 
> 赞同：6
> 
> 时间：2013-03-07T17:08:02.570
> 
> 标签：javascript

我有 window.onbeforeunload 正确触发。它显示一个确认框，以确保用户知道他们正在导航（关闭）窗口，并且任何未保存的工作都将被删除。

我有一个独特的情况，如果用户通过单击链接离开页面，我不希望触发此事件，但我不知道如何检测是否在函数内部单击了链接以停止函数. 这就是我的代码：

```
window.onbeforeunload = function() {
var message = 'You are leaving the page.';

/* If this is Firefox */
if(/Firefox[\/\s](\d+)/.test(navigator.userAgent) && new Number(RegExp.$1) >= 4) {
  if(confirm(message)) {
    history.go();
  } 
  else {
    window.setTimeout(function() {
      window.stop();
    }, 1);
  }
}
/* Everything else */
else {
  return message;
}
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T17:33:33.207

您正在寻找延迟事件处理。我将使用 jQuery 进行解释，因为它的代码更少：

```
window._link_was_clicked = false;
window.onbeforeunload = function(event) {
  if (window._link_was_clicked) {
    return; // abort beforeunload
  }
  // your event handling
};

jQuery(document).on('click', 'a', function(event) {
  window._link_was_clicked = true;
}); 
```

一个没有 jQuery 方便的委托处理的（非常）穷人的实现可能看起来像：

```
document.addEventListener("click", function(event) {
  if (this.nodeName.toLowerCase() === 'a') {
    window._link_was_clicked = true;
  }
}, true); 
```

这允许您页面上的*所有*链接在不调用`beforeunload`处理程序的情况下离开。我相信您可以弄清楚如何自定义它，如果您只想为一组特定的链接允许这个（您的问题不是特别清楚）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-09T16:46:15.280

```
var link_was_clicked = false;
document.addEventListener("click", function(e) {
  if (e.target.nodeName.toLowerCase() === 'a') {
    link_was_clicked = true;
  }
}, true);

window.onbeforeunload = function() {
  if(link_was_clicked) {
    link_was_clicked = false;
    return;
  }
  //other code here
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-30T13:18:25.140

您可以使用计时器来区分 a`link unload`或 a s。`reload/user entering a different address unload`这样你就知道`beforeunload`点击链接后直接触发了。

使用 jQuery 的示例：

```
$('a').on('click', function(){
  window.last_clicked_time = new Date().getTime();
  window.last_clicked = $(this);
});

$(window).bind('beforeunload', function() {
  var time_now = new Date().getTime();
  var link_clicked = window.last_clicked != undefined;
  var within_click_offset = (time_now - window.last_clicked_time) < 100;

  if (link_clicked && within_click_offset) {
    return 'You clicked a link to '+window.last_clicked[0].href+'!';
  } else {
    return 'You are leaving or reloading the page!';
  }
}); 
```

（在 Chrome 中测试）

# javascript - 将新帖子加载到顶部 - 向上滚动

> ID：15277404
> 
> 赞同：-1
> 
> 时间：2013-03-07T17:08:10.353
> 
> 标签：javascript, scroll

我正在一个网站上（或多或少）实时发布新帖子。因为我不希望帖子在发布新帖子时不断向下滚动，所以我想在其他帖子的“顶部”加载新帖子。如果用户想要查看新帖子，他/她必须向上滚动而不是向下滚动。

我一直在寻找有关如何实现这一目标的想法，但到目前为止并不幸运。有谁知道如何开始？

非常感谢！D

PS 我不想显示“新帖子”的消息（如 twitter）。我有点希望帖子立即加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:23:39.140

一个想法是，如果您将帖子列表绝对定位在另一个 div 中，则应用一个`top`等于新帖子高度的负值。为简单起见，假设您的所有帖子的高度正好为 40px，然后当有新帖子出现时，将`top`偏移设置为之前的负 40px。如果处理不好，我会有点担心“闪烁”。

`scrollTop`如果您在滚动窗口中查看列表，则同样的技巧可以应用于这些值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:12:34.577

如果您使用的是“Jquery”，则可以使用

```
$('#container').prepend( '<div class="post">Hi im a new post</div>' ); 
```

代替

```
$('#container').append( '<div class="post">Hi im a new post</div>' ); 
```

这会将帖子呈现为#container 的第一个子元素，而不是最后一个。

# highcharts - Highchart - 显示/隐藏 y 轴而不隐藏系列

> ID：15277405
> 
> 赞同：28
> 
> 时间：2013-03-07T17:08:11.733
> 
> 标签：highcharts

我正在与 Highchart 合作。我有一个多系列图，其中每个系列都有自己的 y 轴。

[很像这个（jsfiddle）](http://jsfiddle.net/39xBU/1/)

当我们单击系列的图例项时，它会隐藏它和相关的 y 轴（使用`showEmpty:false`帮助隐藏轴的名称）

我想要实现的是隐藏给定系列的 y 轴而不隐藏系列本身。

我试图通过像这样修改 showAxis 属性来隐藏它：

```
serie.yAxis.showAxis = false; 
```

但它不起作用。任何人都知道我应该怎么做？

编辑：我设法编辑了文本，因此我可以通过将文本设置为 null 来删除轴标题，但它不足以隐藏整个轴及其值。

这是我为编辑文本所做的：

```
serie.yAxis.axisTitle.attr({
            text: null
        }); 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-03-08T10:57:57.860

**Highcharts 4.1.9+**

Since 4.1.9, there is an option [Axis.visible](http://api.highcharts.com/highcharts/xAxis.visible) which can be used to show/hide an axis, demo: [http://jsfiddle.net/3sembmfo/36/](http://jsfiddle.net/3sembmfo/36/)

**Older versions of Highcharts**

It's a new feature for Highcharts 3.0 - that allows to update axes in realtime: `chart.yAxis[0].update(object)` - as object takes the same options as for creating chart. For example:

```
 chart.yAxis[0].update({
            labels: {
                enabled: false
            },
            title: {
                text: null
            }
        }); 
```

And jsFiddle: [http://jsfiddle.net/39xBU/2/](http://jsfiddle.net/39xBU/2/)

**EDIT:**

Use below snippet to hide/show axis by just calling `axis.hide()` and `axis.show()`. Live demo: [http://jsfiddle.net/39xBU/183/](http://jsfiddle.net/39xBU/183/)

```
(function (HC) {
    var UNDEFINED;
    HC.wrap(HC.Axis.prototype, 'render', function (p) {
        if (typeof this.visible === 'undefined') {
            this.visible = true;
        }
        if(this.visible) {
            this.min = this.prevMin || this.min;
            this.max = this.prevMax || this.max;
        } else {
            this.prevMin = this.min;
            this.prevMax = this.max;
            this.min = UNDEFINED;
            this.max = UNDEFINED;
        }

        this.hasData = this.visible;

        p.call(this);
    });

    HC.Axis.prototype.hide = function () {
        this.visible = false;
        this.render();

        HC.each(this.plotLinesAndBands, function (plotLine) {
            plotLine.render();
        });
    };

    HC.Axis.prototype.show = function () {
        this.visible = true;
        this.render();

        HC.each(this.plotLinesAndBands, function (plotLine) {
            plotLine.render();
        });
    };
})(Highcharts); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-01-18T09:27:53.683

它实际上变得更简单了。您只需将 yAxis 标题属性设置为 false：

```
yAxis: {
   title: false
}, 
```

这是一个示例：[jsfiddle示例](https://jsfiddle.net/geoffDev/nwh06yp8/1/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-08-30T10:21:23.400

我们可以通过返回空字符串来隐藏 Y 轴标签而不隐藏 y 轴而不隐藏系列，如下所示：

```
yAxis: {
       title: '',
       labels: {
                formatter: function() {
                    return '';
                },
                style: {
                    color: '#4572A7'
                }
        } 
```

},

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-07-11T11:30:04.143

对于较新的版本（我使用的是 6.2.0），该`yAxis`属性有一个名为[gridLineWidth](https://api.highcharts.com/highcharts/yAxis.gridLineWidth)的参数。只需将其设置为 0，该轴的网格就会消失。[在这个 JSFiddle](https://jsfiddle.net/yg6j53wz/4/)中有一个例子。

但是，如果您处于[样式模式](https://www.highcharts.com/docs/chart-design-and-style/style-by-css)，这会比较棘手。在这里，您必须为目标轴设置一个[类名](https://api.highcharts.com/highcharts/yAxis.className)，然后像这样设置 CSS：

```
.highcharts-yaxis-grid {
    &.right-axis {
      path {
        stroke: none;
      }
    }
  } 
```

例如，这将使`className`设置为*right-axis*的轴的网格消失。这允许多轴具有不同的样式。

# log4net - 使用 log4net 处理日志消息中嵌入的换行符

> ID：15277411
> 
> 赞同：4
> 
> 时间：2013-03-07T17:08:33.103
> 
> 标签：log4net, c#-2.0

当日志消息包含嵌入的换行符时，此类日志消息的对齐方式在日志文件中不正确。

例如，如果我使用转换模式： [%-5level] %message%newline

并且如果我记录包含嵌入的换行符或任何其他多行日志消息的异常堆栈跟踪，则消息中的附加行从行的开头开始。

是否有可能对于每个这样的附加行，都遵循转换模式，并且文本适当缩进？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-09T10:28:31.310

我这样做是通过以下方式：

```
void Log(string message, int levelsDeep)
{
   StringBuilder sb = new StringBuilder();
   for(int i = 0; i < levelsDeep; i++)
       sb.Append(" ");

   string spacer = sb.ToString();

   string msg = message.Replace("\r\n", "\r\n" + spacer);
   msg = "\r\n" + msg + "\r\n";   //the prefix and suffix newline characters ensure that this and the next message starts in a new line and is not impacted by the 'spacer' from this message.

   // call log4net functions to log the 'msg'

} 
```

# python - Python从项目列表中创建字典键

> ID：15277417
> 
> 赞同：2
> 
> 时间：2013-03-07T17:08:44.223
> 
> 标签：python, hash, dictionary

我希望使用 Python 字典来跟踪一些正在运行的任务。这些任务中的每一个都有许多使其独一无二的属性，所以我想使用这些属性的函数来生成字典键，以便我可以使用相同的属性再次在字典中找到它们；类似于以下内容：

```
class Task(object):
    def __init__(self, a, b):
        pass

#Init task dictionary
d = {}

#Define some attributes
attrib_a = 1
attrib_b = 10

#Create a task with these attributes
t = Task(attrib_a, attrib_b)

#Store the task in the dictionary, using a function of the attributes as a key
d[[attrib_a, attrib_b]] = t 
```

显然这不起作用（列表是可变的，因此不能用作键（**“unhashable type: list”**）） - 那么从几个已知属性生成唯一键的规范方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T17:09:41.830

使用元组代替列表。元组是不可变的，可以用作字典键：

```
d[(attrib_a, attrib_b)] = t 
```

括号可以省略：

```
d[attrib_a, attrib_b] = t 
```

但是，有些人似乎不喜欢这种语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:10:28.847

使用元组

```
d[(attrib_a, attrib_b)] = t 
```

那应该可以正常工作

# php - Worldpay 测试模式 - 测试错误响应未重定向到 resultC.html

> ID：15277419
> 
> 赞同：3
> 
> 时间：2013-03-07T17:09:03.847
> 
> 标签：php, payment-gateway, payment, payment-processing, worldpay

我目前正在尝试将 WorldPay 集成到我们的网站中（自定义 PHP，没有开源电子商务框架）。

我已经让它在测试模式下成功处理“授权”/成功付款，并且付款响应 URL 一切正常，然后客户被重定向到 resultY.html（WorldPay 的成功购物者结果页面），我在其中包含了一个按钮来获取它们回到网站。这表明通常这一切都有效，但是......

我已按照文档尝试在提交交易时测试“错误”响应，但是我不断被重定向回“安全支付页面”（带有卡详细信息输入等），并显示以下消息：

'找不到此购买的可用路线。这可能是由商家配置错误或远程系统故障引起的。

在出现错误结果时，我希望客户被引导到 resultC.html 页面（WorldPay 的已取消购物者结果页面），但是我似乎无法让 WorldPay 测试模式失败到该页面，只是为了查看它如何处理错误。理想情况下，我希望客户在错误交易中看到 resultC.html，以便我可以显示一个按钮以将客户重定向回网站。

我想知道 WorldPay 帐户中的“安装管理”配置中是否有我丢失的内容。我能看到的唯一其他与失败相关的字段是“付款响应失败计数”-始终为 0（尽管发送了许多错误交易）、“付款响应失败电子邮件地址”（已填写但没有电子邮件通过错误交易）、“附加失败电子邮件的 HTTP(s) 付款消息？（我已启用）。

希望有WorldPay经验的人给我一些指点，谢谢期待。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-12T13:57:03.270

“错误”结果与捕获/结算付款有关，因此与您的网站与 WorldPay 集成方式的错误无关。不幸的是，WorldPay 仅在用户成功创建费用（这将是 'CAPTURED'）或点击取消时才会向您发送“付款响应”。就像您在评论中所说的那样，用户只有在点击“取消”时才会转到 resultC.html。

如果 WorldPay 无法访问您的回调 URL，您也可能会收到“回调失败”。一般来说，如果在 WorldPay 端创建费用时出现错误，他们不会让您知道（类似地，它不会让您知道何时结算或拒绝费用）。

在过去的两年里，我们从来没有在创建收费时出错，所以我认为你不必担心。

# javascript - 获取祖父元素中的文本

> ID：15277420
> 
> 赞同：2
> 
> 时间：2013-03-07T17:09:04.123
> 
> 标签：javascript, jquery, parent

我正在尝试修改此函数以从祖父元素中获取文本

```
span.html(checked.map(function () { return $(this).parent().text(); }).get().join()); 
```

这两个函数都返回祖父文本以及它的兄弟元素 ( `<div class=CheckMark>`) 中的文本。如何修改它以仅返回祖父元素中的文本？

```
span.html(checked.map(function () { return $(this).parent().parent().text(); }).get().join());

span.html(checked.map(function () { return $(this).parents(':eq(1)').text(); }).get().join()); 
```

HTML

```
<li><a href="#">
    <label onclick="toggle_colorbox_alt(this.children[0]);">
        <div style="background-color: #000000" class="color">
            <div class=CheckMark>&#10003;</div>
            <input type="checkbox" name="color[]" value="value" class="cbx"/>
        </div>
        Text I Want
    </label>
</a></li> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:11:38.490

您似乎想获得`label`排除其子项的文本。

你可以这样做 ：

```
var p = $(this).closest('label').clone();
p.children().remove();
var txt = p.text(); 
```

或者以更短的链式方式：

```
var txt = $(this).closest('label').clone().children().remove().end().text(); 
```

[示范](http://jsbin.com/eyowik/2/edit)

# python - 如何在这段代码中不写字段名，而是写字段的详细名称？

> ID：15277428
> 
> 赞同：0
> 
> 时间：2013-03-07T17:09:47.593
> 
> 标签：python, django

如何在此代码（导出到 xls）中写不是字段名称而是字段的详细名称（在列标题中）？

```
def export_as_xls(modeladmin, request, queryset):
    if not request.user.is_staff:
        raise PermissionDenied
    opts = modeladmin.model._meta

    wb = Workbook()
    ws0 = wb.add_sheet('0')
    col = 0
    field_names = []
    # write header row
    for field in opts.fields:
        ws0.write(0, col, field.name)
        field_names.append(field.name)
        col = col + 1

    row = 1
    # Write data rows
    for obj in queryset:
        col = 0
        for field in field_names:
            val = unicode(getattr(obj, field)).strip()
            ws0.write(row, col, val)
            col = col + 1
        row = row + 1   

    f = StringIO()
    wb.save(f)
    f.seek(0)
    response = HttpResponse(f.read(), mimetype='application/ms-excel')
    response['Content-Disposition'] = 'attachment; filename=%s.xls' % unicode(opts).replace('.', '_')
    return response

export_as_xls.short_description = "Export selected objects to XLS" 
```

我看到`field.name`了，但我不知道如何改变它。此代码来自 django 片段站点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T18:59:19.037

我可能会误解这个问题，但如果你想更改 field.name：

```
for field in opts.fields:
    field.name = 'Foo' 
```

这会将所有字段名称更改为“Foo”

# ms-access - Access 中货币值的数据类型

> ID：15277432
> 
> 赞同：2
> 
> 时间：2013-03-07T17:09:54.033
> 
> 标签：ms-access, ms-access-2010

我正在为学校做数据库作业。由于睡眠不足，我现在无法思考，但我知道这是一个简单的问题。

我有这个 create table 语句，在其中，我应该有 3 列`cusNo`、`add`和`balance`，我可以做得很好。但我的问题在于最后一栏。最后一列用于余额，应该有一个 5 位数的数值。为此，当我创建平衡列时，我是否只需将其创建为双精度列？

像这样的东西：

```
CREATE TABLE tablename
(
  cusNo char(3),
  add varchar(20),
  balance double
) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T17:23:59.370

SQL Server中没有`DOUBLE`。

我会提倡`DECIMAL`over `MONEY`。`MONEY`存在[已知的准确性问题](https://sqlblog.org/2008/04/27/performance-storage-comparisons-money-vs-decimal)，[很少赢得性能竞赛](https://sqlblog.org/2008/04/27/performance-storage-comparisons-money-vs-decimal)，并且在您可以存储的内容方面非常不灵活。`DECIMAL`您可以自由选择比例和精度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T17:11:42.173

您通常不会使用 double/float 来赚钱（对不起，不仅仅是“通常”，但您永远不应该将其存储为非精确类型）。取决于您使用的 RMDS，您可以选择一种或另一种精确的数字类型。`money`- SQL 服务器，`decimal`- MySQL，`NUMBER`- 甲骨文

**更新**
我忘了提到 SQL Server 也有`decimal`你可能（和很多人）更喜欢的类型`money`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-07T17:49:36.157

Use Decimal for balance. Normally, up to two decimal works fine but you can change as per your need. So you should use:

```
CREATE TABLE tablename
(
  cusNo char(3),
  address varchar(20),
  balance NUMERIC(7,2)
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T17:18:52.663

我会尝试：

```
CREATE TABLE tablename (cusNo INT(3), add MONEY(5), balance MONEY(5)) 
```

假设您尝试将总计相加，MONEY 数据类型就是您想要的（并且您在 sql server 上）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-07T19:53:26.157

在 Microsoft Access 中，使用`Currency`美元金额的数据类型。在 SQL Server 中使用`DECIMAL`或`MONEY`。

# css - Twitter Bootstrap - 如何使模态窗口负责移动设备？

> ID：15277436
> 
> 赞同：0
> 
> 时间：2013-03-07T17:09:59.140
> 
> 标签：css, ruby-on-rails, twitter-bootstrap, modal-dialog

我在移动设备上遇到了 Twitter 引导模式窗口的问题 - 当我在那里加载模式窗口时，屏幕变暗，但模式窗口中的联系表单不存在。

我浏览了 SO 并找到[了这个主题](https://stackoverflow.com/questions/10437151/twitter-bootstrap-modal-on-mobile-devices)- 16 票赞成的答案可能有效。

我担心的是 - 我在哪里可以找到这些文件？我的应用程序在 RoR 框架上运行，我没有看到这些 Twitter Bootstrap 文件 - 在主 CSS 文件中我只有：

```
@import "bootstrap";
@import "bootstrap-responsive"; 
```

如何更新这些文件？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:21:38.477

我假设您使用了 twitter-bootstrap-rails gem。

在我的系统上（使用 RVM 的 OS X）我相信这是保存它的地方：

~/.rvm/gems/ruby-1.9.3-p327/gems/twitter-bootstrap-rails-2.1.9/vendor/toolkit/twitter/bootstrap/responsive.less

# php - symfony2 - 在存储库或类中使用多个连接

> ID：15277444
> 
> 赞同：10
> 
> 时间：2013-03-07T17:10:16.177
> 
> 标签：php, symfony, database-connection, multiple-databases

我有多个连接，并且我有一个存储库类。我希望存储库类能够访问多个连接。它适用于需要从多个数据库主机获取数据的报告。

**配置.yml**

```
doctrine:
    dbal:
        default_connection:  default
        connections:
          default:
              driver:   "%db_default_driver%"
              host:     "%db_default_host%"
              etc..
          bookings:
              driver:   "%db_readonly_bookings_driver%"
              host:     "%db_readonly_bookings_host%"
              etc ...
          sessions:
              etc.. 
```

**SalesJournalRepistory.php**

```
namespace Portal\SalesJournalBundle\Repository;

use Doctrine\ORM\EntityRepository;

class SalesJournalRepository extends EntityRepository 
{

  public $connDefault   = null;
  public $connBookings  = null;
  public $connSessions  = null;

  function __construct()
  {
    // this is where I get the error
    $this->connDefault  = $this->getManager('default')->getConnection();
    $this->connBookings = $this->getManager('bookings')->getConnection();
    $this->connSessions = $this->getManager('sessions')->getConnection();
  }

  function testQuery(){
     $sql = "SELECT * FROM testTableBookings LIMIT 10";
     $stmt = $this->connBookings->prepare($sql);
     $results = $stmt->fetchAll();

     print_r($results);
  }

  function testQuery2(){
     $sql = "SELECT * FROM testTableSessions LIMIT 10";
     $stmt = $this->connSessions->prepare($sql);
     $results = $stmt->fetchAll();

     print_r($results);
  }

} 
```

我可以通过控制器使其工作

```
$connDefault  = $this->getDoctrine()->getManager('default')->getConnection();
$connBookings = $this->getDoctrine()->getManager('bookings')->getConnection(); 
```

但是我希望能够从存储库中运行它。我收到以下错误

```
PHP Fatal error:  Call to a member function getConnection() on a non-object 
```

我认为这可能会提供一些线索？[注入实体](https://stackoverflow.com/questions/13118288/how-to-inject-non-default-entity-managers)但是我有点困惑，不确定是不是？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-11T14:17:56.540

An`EntityRepository`应该只关心其拥有的实体（和管理器） - 因此将您的实体存储库与您的实体管理器混合起来确实不是要走的路。我建议你自己创建一个服务并注入 Doctrine - 然后你可以查询任何你想要的。例如 ：

配置

```
[config.yml / services.yml]
services:
   sales_journal:
      class: Acme\DemoBundle\Service\SalesJournal
       arguments: ['@doctrine'] 
```

服务

```
[Acme\DemoBundle\Service\SalesJournal.php]

namespace Acme\DemoBundle\Service;

public class SalesJournal {

    private $connDefault;
    private $connBookings;
    private $connSessions;

    function __construct($doctrine)
    {
        $this->connDefault = $doctrine->getManager('default')->getConnection();
        $this->connBookings = $doctrine->getManager('bookings')->getConnection();
        $this->connSessions = $doctrine->getManager('sessions')->getConnection();
    }

    function testQuery()
    {
        $sql = "SELECT * FROM testTableBookings LIMIT 10";
        $stmt = $this->connBookings->prepare($sql);
        $results = $stmt->fetchAll();

        print_r($results);
    }

    function testQuery2()
    {
        $sql = "SELECT * FROM testTableSessions LIMIT 10";
        $stmt = $this->connSessions->prepare($sql);
        $results = $stmt->fetchAll();

        print_r($results);
    }
} 
```

然后从您的控制器或您想使用该服务的任何地方执行以下操作：

```
// get the service
$sales_journal = $this->get('sales_journal');
// call relevent function
$sales_journal->testQuery(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T22:00:17.840

您应该将要在控制器中使用的实体管理器设置为 getRepository 方法的第二个参数，如下所示：

```
$repository = $this->getDoctrine()->getRepository('PortalSalesJournalBundle:SalesJournal', 'bookings'); 
```

并在存储库类中访问该实体管理器的连接，如下所示：

```
namespace Portal\SalesJournalBundle\Repository;

use Doctrine\ORM\EntityRepository;

class SalesJournalRepository extends EntityRepository 
{
    function testQuery(){
        $connection = $this->getEntityManager()->getConnection();
    }
} 
```

# c++ - ModelResetter RAII 对象

> ID：15277447
> 
> 赞同：2
> 
> 时间：2013-03-07T17:10:22.960
> 
> 标签：c++, qt, templates, qt4, qabstractitemmodel

我有一个自定义代理模型，当将新列/行添加到其源模型时，它偶尔会自行检修。从文档看来，在此类操作的开始和结束时调用[QAbstractItemModel::beginResetModel()](http://qt-project.org/doc/qt-4.8/qabstractitemmodel.html#beginResetModel) 和[QAbstractItemModel::endResetModel()是正确的方法。](http://qt-project.org/doc/qt-4.8/qabstractitemmodel.html#endResetModel)不幸的是，我的检修功能有几个可能的退出点，我只知道我会忘记`endResetModel`在每个退出点调用，因为它变得更加复杂。

因此，我想创建一个简单的 RAII 类，它将调用`beginResetModel`构造然后调用`endResetModel`破坏，如下所示：

```
class ModelResetter
{
public:
    ModelResetter(QAbstractItemModel* model) : m_model(model)
    {
        m_model->beginResetModel();
    }
    ~ModelResetter()
    {
        m_model->endResetModel();
    }

private:
    QAbstractItemModel* m_model;
}; 
```

问题在于，`beginResetModel()`两者`endResetModel()`都`protected`在`QAbstractItemModel`. 在我的**继承**模型中声明`ModelResetter`为 a似乎没有帮助，因为我正在尝试与基类交互。`friend class`

 **我不想为我实现的每个模型都做一个自定义实现，那么我可以用模板来做这个吗？我对模板语法还不是很熟悉。

**编辑 1：（**我删除了编辑 2 中的示例模板代码以避免混淆）

如果我能以某种方式将模板限制为只允许继承的类型，那就太好了`QAbstractItemModel`，但我在标准 C++ 中看不到任何允许这样做的东西。我不会使用 Boost。

**编辑 2**：我想我并不清楚我的要求。他们来了：

*   对一般情况的基类进行操作
*   在调试模式下强制`QAbstractItemModel`继承要求，而在发布模式下没有惩罚
*   使用简单，几乎没有开销
*   不需要修改基类或新函数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T14:55:08.647

您可以让继承的模型公开方法，这些方法只会分别调用 beginResetModel() 和 endResetModel()，然后让 ModelResetter 调用这些方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T19:23:49.850

我不想回答我自己的问题，但几天后我整理了一个基于模板的解决方案，可以满足我的所有要求。是的，我的第一个从头开始的模板类。这是实现：

```
//modelresetter.h
#include <QAbstractItemModel>

/* you must declare this class as a friend to your model
 * to give it access to protected members as follows:
 * template <class Model> friend class ModelResetter;
 */
template<class Model>
class ModelResetter
{
public:
    ModelResetter(Model* model) : m_model(model)
    {
        Q_ASSERT_X(qobject_cast<QAbstractItemModel*>(model) != 0, __FUNCTION__,
                   "templated object does not inherit QAbstractItemModel");
        m_model->beginResetModel();
    }
    ~ModelResetter()
    {
        m_model->endResetModel();
    }

private:
    Model* m_model;
}; 
```

和用法：

```
//mymodel.cpp
bool MyModel::overhaul()
{
    ModelResetter<MyModel> resetter(this); resetter;  //prevent compiler warning

    //do stuff
    if(somethingswrong)
        return false; //model will finish reset at every exit point

    //do more stuff
    return true; //model also completes reset on success
} 
```

谢谢你的帮助！**

# svg - SVG 水平大括号

> ID：15277448
> 
> 赞同：6
> 
> 时间：2013-03-07T17:10:24.193
> 
> 标签：svg, curly-braces

我正在尝试创建一个从键盘字符开始并对其进行转换的宽水平花括号。

我从：

```
<text x="40" y="120" transform="rotate(90, 40, 120)">}</text> 
```

现在我想拉伸文本以使其更宽。忘记使用 CSS`font-size`元素，字体粗细的大小也会相应改变，产生一个胖符号。

我想通过保持瘦来拉伸角色。

然后我开始使用`symbol`and`use`组合，以尝试利用该`viewbox`功能

这是我最后尝试的：

```
<symbol id="curly-bracket">
    <text>}</text>
</symbol>
<use x="40" y="120" transform="rotate(90, 40, 120)" xlink:href="#curly-bracket" /> 
```

角色现在看起来被剪掉了，我发现没有办法让它正确显示。

[阅读W3 SVG 文档](http://www.w3.org/TR/SVG/struct.html#SymbolElement)时，我很难理解自己在做什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T12:10:10.020

```
<text x="40" y="120" transform="rotate(90, 40, 120) scale(1,2)">}</text> 
```

这将使所有 y 坐标加倍，并且由于您已将其旋转 90 度，因此将水平拉伸它。

尝试从 W3 规范中学习 SVG 会让您感到沮丧和困惑。它不是作为如何使用它的教程而编写的。[这是关于 SVG 转换的一个很好的资源](http://oreillymedia.github.io/svg-essentials-examples/)。如果您真的对 SVG 感兴趣，我建议您阅读整本电子书。我认为这是最好的资源。

# mysql - 删除mysql中3列concat相同的重复记录？

> ID：15277449
> 
> 赞同：1
> 
> 时间：2013-03-07T17:10:25.753
> 
> 标签：mysql, duplicates

我有一个包含超过 800,000 条记录的表。每行有 8 列。我需要删除重复的记录，即 column1 和 column2 和 column5 相同。所有列都应该相同。

例如

* * *

第 1 列 | 第 2 列 | .... | 第 5 列

* * *

约翰 | 英文 | .... | 经过

亚历克斯 | 英文 | .... | 经过

约翰 | 化学| .... | 经过

约翰 | 英文 | .... | 经过

* * *

我想删除 1 条和最后一条记录。（即john+Eng+Pass）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:44:38.007

假设您的表已命名`t`并且 t 的主键是`pk`.

我建议你分两步完成工作：

第一步：**确定要删除的行**

```
CREATE TEMPORARY TABLE to_delete AS 
select distinct
     t2.pk
from
     t t1
inner join
     t t2
where
     t1.c1 = t2.c1 and 
     t1.c2 = t2.c2 and 
     t1.c5 = t2.c5 and
     t2.pk > t1.pk      #erase this line to
                        #delete all dups rows 
```

第二步：**删除行**

```
delete from t
where t.pk in (select pk from to_delete ) 
```

简化示例广告 sqlfiddle：[http ://sqlfiddle.com/#!2/f97da/3/0](http://sqlfiddle.com/#!2/f97da/3/0)

免责声明：删除超过您风险的行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T18:12:45.263

试试下面的查询：

```
create table abc (id int(11) primary key auto_increment, col_1 varchar(255), 
col_2 varchar(255), col_3 varchar(255));

insert into abc (col_1, col_2, col_3) values ('a', 'a', 'a'),
('a', 'b', 'c'), ('a','a', 'a'), ('b','b','b'),('a','b','c');

DELETE a1.* from abc a1 inner join abc a2 ON a1.col_1 = a2.col_1 
AND a1.col_2 = a2.col_2 AND a1.col_3 = a2.col_3 AND a1.id <> a2.id; 
```

SQL小提琴：

[http://sqlfiddle.com/#!2/08e4b/1](http://sqlfiddle.com/#!2/08e4b/1)

# scala - 在 Scala 中声明一、二、多参数

> ID：15277452
> 
> 赞同：3
> 
> 时间：2013-03-07T17:10:33.397
> 
> 标签：scala, map, variadic-functions

我刚刚开始学习 Scala。在浏览 Scaladocs 时，我在以下位置看到了这个方法定义[`mutable.Map`](http://www.scala-lang.org/api/current/index.html#scala.collection.mutable.Map)：

```
def -=(elem1: A, elem2: A, elems: A*): Map.this.type
  Removes two or more elements from this shrinkable collection.

  elem1 the first element to remove.
  elem2 the second element to remove.
  elems the remaining elements to remove.
  returns the shrinkable collection itself 
```

如果您只是要定义a `elem1`，为什么还需要明确定义？`elem2``elems``*`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-07T17:20:47.970

请注意，已经有一个带有单个参数的单独重载方法：

```
abstract def -=(key: A): Map.this.type 
```

所以*多加两个参数*约束是为了避免歧义调用。使用单个参数的单独方法的原因可能是效率。请注意，调用可变参数方法涉及在后台创建一个数组，如果只有一个元素要删除，这将是浪费的。

由于该方法的单参数版本是抽象的，而多参数版本是具体的，如果后者的实现实际上在循环（功能等价物）中调用了前者，我不会感到惊讶。（更新：[快速代码检查](https://github.com/scala/scala/blob/v2.10.0/src/library/scala/collection/generic/Shrinkable.scala#L1)验证了我的猜测，尽管调用是通过 .）间接调用的`--=`。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:13:13.827

我会说是因为有*两个或更多*的条件。

使用该签名，您清楚地强制要求将至少两个类型`A`的参数传递给该方法。

如果您只使用`*elems`，则意味着删除 0 个或更多元素，这没有多大意义。

您特别具有删除 2 或更多的签名这一事实，以及它是否有意义，超出了此答案的范围。就像@PéterTörök 所说，用一个参数重载这个方法的原因，两个或多个参数可能是效率。

# python - 任何以编程方式从 python 更改 nginx 配置文件的好方法？

> ID：15277453
> 
> 赞同：20
> 
> 时间：2013-03-07T17:10:34.143
> 
> 标签：python, nginx

我有一个动态改变 nginx 配置文件（`nginx.conf`）的 python 脚本。由于 nginx 配置不是`ini`格式，我目前使用一些正则表达式来解析和修改文件内容。是否存在以编程方式更改 nginx 配置的唯一方法或更好的方法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-04-03T01:43:09.603

1.  [https://www.npmjs.com/package/nginx-conf](https://www.npmjs.com/package/nginx-conf)

2.  您可能会使用**PyNginxConfig Parser**。 [http://code.google.com/p/pynginxconfig/source/browse/pynginxconfig.py#208](http://code.google.com/p/pynginxconfig/source/browse/pynginxconfig.py#208) 这个实现和原来的很接近。

3.  还有[ServerMgr](http://pythonhosted.org/servermgr/nginx.html)。它不是真正的解析器，只允许基本映射。

4.  最后但并非最不重要，实际上是首先，因为基于 pyparsing：[https ://github.com/fatiherikli/nginxparser](https://github.com/fatiherikli/nginxparser)

    `pip install git+https://github.com/fatiherikli/nginxparser.git`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2019-12-20T23:20:55.527

NGINX Inc 于 2017 年开始提供一个库，这是一种“将 NGINX 配置转换为 JSON 并返回的快速可靠的方法”。它称为[交叉](https://github.com/nginxinc/crossplane)计划，您可以使用`pip`.

```
pip install crossplane 
```

有了这个，您可以将文件解析为 JSON、反序列化、操作、序列化回 JSON，然后转换回 NGINX 配置文件格式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-07T17:19:09.497

似乎存在一个支持至少一部分 nginx 配置文件语法的[augeas 镜头。](http://augeas.net/docs/references/lenses/files/nginx-aug.html)Augeas 也有[Python 绑定](http://augeas.net/download.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-30T02:24:19.197

现在有[nginx-conf](https://www.npmjs.com/package/nginx-conf)，一个提供对 nginx 配置的编程访问的 NPM 模块。

# java - 是否可以使用默认关联程序打开 RandomAccessFile？

> ID：15277455
> 
> 赞同：-1
> 
> 时间：2013-03-07T17:10:36.037
> 
> 标签：java, default, desktop, temporary-files, randomaccessfile

我通过 RandomAccessFile （在 java 中）在内存中加载了一个文件。

不要把它放在光盘里，因为它是一个临时文件，为了他们的安全，不要存放它是非常重要的。

是否可以使用系统的默认应用程序打开 RandomAccessFile？，我找不到让我信服的替代方案。我知道有“临时文件”，但我不会产生很多安全性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:57:04.953

您可以使用 Desktop.open() 通过文件名及其关联程序打开文件。在执行此操作之前，您应该关闭在 Java 中使用它的所有资源。

您如何创建文件并不重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:20:40.453

也许您可以分享一些描述您如何创建它的代码`RandomAccessFile`？此类的构造函数需要一个`File`对象或文件的路径。应该可以[使用关联的默认应用程序](https://stackoverflow.com/questions/550329/how-to-open-a-file-with-the-default-associated-program)[打开任何`File`](https://stackoverflow.com/questions/550329/how-to-open-a-file-with-the-default-associated-program)对象。

如果正如您所说的 RandomAccessFile 类实际上是从内存而不是文件中读取，那么您可能不走运 - 大多数程序都希望打开文件，而不是内存地址。

# c# - 如何为此方法编写单元测试

> ID：15277457
> 
> 赞同：0
> 
> 时间：2013-03-07T17:10:48.807
> 
> 标签：c#, asp.net-mvc-4, nunit, rhino-mocks

我正在为此方法编写单元测试。我已经尝试了很多次，但仍然无法为其编写任何代码。请建议我如何对其进行单元测试。我正在使用 C#、nunit 框架和 rhino mock。

提前致谢。

```
 public FileUploadJsonResult AjaxUploadProfile(int id, string branchName, string filepath, HttpPostedFileBase file)
    {
        // TODO: Add your business logic here and/or save the file
        string statusCode = "1";
        string profilePicture = string.Empty;
        string fileExtension = System.IO.Path.GetExtension(file.FileName.ToLower());
        string fileName = id + "_" + branchName;
        string fileNameWithOriginalExtension = fileName + fileExtension;
        string fileNameWithJPGExtension = fileName + ".jpg";
        string fileServerPath = this.Server.MapPath("~/LO_ProfilePicture/" + fileNameWithJPGExtension);
        string statusMessage = string.Empty;
        if (string.IsNullOrEmpty(fileExtension) || !Utility.isCorrectExtension(fileExtension))
        {
            statusMessage = "Profile picture should be of JPG, BMP, PNG, GIF or JPEG format.";
            return new FileUploadJsonResult { Data = new { message = string.Format(statusMessage, fileNameWithOriginalExtension), filename = string.Empty, profilepic = profilePicture, statusCode = "0" } };
        }
        if (file.ContentLength > PageConstants.PROFILE_PICTURE_FILE_SIZE)
        {
            statusMessage = "Profile picture size should be less than 2MB";
            return new FileUploadJsonResult { Data = new { message = string.Format(statusMessage, fileNameWithOriginalExtension), filename = string.Empty, profilepic = profilePicture, statusCode = "0" } };
        }
        Utility.SaveThumbnailImage(fileServerPath, file.InputStream, PageConstants.BRANCH_PROFILE_PICTURE_FILE_HEIGTH, PageConstants.BRANCH_PROFILE_PICTURE_FILE_WIDTH);
        profilePicture = PageConstants.IMAGE_PATH + "LO_ProfilePicture/" + fileNameWithJPGExtension;
        // Return JSON            
        return new FileUploadJsonResult { Data = new { message = string.Format("Profile Picture is successfully uploaded.", fileNameWithOriginalExtension), filename = fileNameWithJPGExtension, profilepic = profilePicture, statusCode } };
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T18:36:09.467

您可以将此功能视为执行特定工作的多个功能的组合。一个功能是获取目标文件路径，另一个是验证扩展名，另一个是验证大小，另一个是创建缩略图等。

目标是将复杂的代码分解为可以独立测试的小型可测试函数（单元）。因此，当您将它们放在一起时，您会更有信心相信您的大功能可以按预期工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T18:09:35.500

让它只做必要的部分。将与您尝试处理的操作无关的任何内容拆分给其他类。把它们放在接口后面，这样你就可以在你的单元测试中模拟它们。这样你会注意到你不必在这个类中使用文件 i/o 测试任何东西。在下面的课程中，我将功能分解为基本部分，一些文件 i/o 和检索设置。即使这些设置与您尝试测试的当前方法无关。该方法只需要验证，例如扩展名，但它如何做到这一点并不重要。

提示：尽量避免使用静态实用程序类。给他们自己的课。还要避免外部组件，例如网络通信或文件 i/o。

因为我没有很多上下文，它可能无法编译。但我会选择类似的东西：

```
class Controller {
    public FileUploadJsonResult AjaxUploadProfile(int id, string branchName, string filepath, HttpPostedFileBase file) {
        string fileName = id + "_" + branchName;
        string fileExtension = _fileIO.GetExtensionForFile(file);

        if (!_extensionManager.IsValidExtension(fileExtension)) {
            return CreateAjaxUploadProfileError("Profile picture should be of JPG, BMP, PNG, GIF or JPEG format.");
        }

        if (file.ContentLength > _settingsManager.GetMaximumFileSize()) {
            return CreateAjaxUploadProfileError("Profile picture size should be less than 2MB");
        }

        string fileNameWithJPGExtension = fileName + ".jpg";
        string fileServerPath = _fileIO.GetServerProfilePicture(Server, fileNameWithJPGExtension);
        string fileClientPath = _fileIO.GetClientProfilePicture(fileNameWithJPGExtension);

        var dimensions = _settingsManager.GetThumbnailDimensions();
        _fileIO.SaveThumbnailImage(fileServerPath, file, dimensions.Item1, dimensions.Item2);

        // Return JSON      
        var data = new {
                message = "Profile Picture is successfully uploaded.", 
                filename = fileClientPath,
                profilepic = profilePicture,
                statusCode = "1"
            };
        return new FileUploadJsonResult { Data = data };
    }

    private static CreateAjaxUploadProfileError(string message) {
        var data = new {
                message = message, 
                filename = string.Empty,
                profilepic = string.Empty,
                statusCode = "0"
            };
        return new FileUploadJsonResult { Data = data };
    }
}

class FileIO : IFileIO {
    public string GetExtensionForFile(HttpPostedFileBase file) {
        return System.IO.Path.GetExtension(filePath.FileName.ToLower());
    }

    public string GetServerProfilePicture(T server, string file) {
        return server.MapPath( "~/LO_ProfilePicture/" + file);
    }

    public void SaveThumbnailImage(string path, HttpPostedFileBase file, int height, int width) {
        Utility.SaveThumbnailImage(path, file.InputStream, height, width); // or even inline
    }

    public string GetClientProfilePicture(string fileName) {
        return _settingsManager.GetClientImagePath() + "LO_ProfilePicture/" + fileNameWithJPGExtension;
    }
}

class ExtensionManager : IExtensionManager {
    public bool IsValidExtension(string extension) {
        return Utility.isCorrectExtension(fileExtension); // or even inline
    }
}

class SettingsManager : ISettingsManager {
    public Tuple<int, int> GetThumbnailDimensions() {
        return Tuple.Create<int, int>(PageConstants.BRANCH_PROFILE_PICTURE_FILE_HEIGTH, PageConstants.BRANCH_PROFILE_PICTURE_FILE_WIDTH);
    }

    public int GetMaximumFileSize() {
        return PageConstants.PROFILE_PICTURE_FILE_SIZE;
    }
} 
```

# java - 我们需要 ArrayBlockingQueue.put(E) 中的 Condition.signal

> ID：15277458
> 
> 赞同：1
> 
> 时间：2013-03-07T17:10:49.377
> 
> 标签：java, concurrency

我正在查看`ArrayBlockingQueue.put(E)`. 我们真的需要`notFull.signal`在 catch 块中调用 to 吗？消费者不应该调用那个信号吗？

```
public void put(E e) throws InterruptedException {
    if (e == null) throw new NullPointerException();
    final E[] items = this.items;
    final ReentrantLock lock = this.lock;
    lock.lockInterruptibly();
    try {
        try {
            while (count == items.length)
                notFull.await();
        } catch (InterruptedException ie) {
            notFull.signal(); // propagate to non-interrupted thread
            throw ie;
        }
        insert(e);
    } finally {
        lock.unlock();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:21:11.240

我们根本不需要那个电话。最新版本的 JDK (1.7.0_17) 甚至没有那个 catch 块。

```
public void put(E e) throws InterruptedException {
    checkNotNull(e);
    final ReentrantLock lock = this.lock;
    lock.lockInterruptibly();
    try {
        while (count == items.length)
            notFull.await();
        insert(e);
    } finally {
        lock.unlock();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T19:45:16.087

问题似乎是，如果发出条件信号，并且线程被中断，则`await()`消耗信号并抛出 InterruptedException。但是，javadoc 明确禁止 - 如果`await()`抛出 InterruptedException，它不能使用信号。

类似的担忧也适用于`Object.wait()`. 在 1.4 中，javadoc 不是很明确。从 1.5 开始，javadoc 说

> 抛出：InterruptedException - 如果另一个线程在当前线程等待通知之前或期间中断了当前线程。

这似乎暗示如果`wait()`抛出 InterruptedException，它一定不能使用通知。

# android - 如何创建没有标题的 DialogFragment？

> ID：15277460
> 
> 赞同：366
> 
> 时间：2013-03-07T17:10:51.470
> 
> 标签：android, android-dialogfragment

我正在创建一个 DialogFragment 来显示一些关于我的应用程序的帮助消息。除了一件事之外，一切正常：窗口顶部有一条黑色条纹，显示 DialogFragment，我认为它是为标题保留的，我不想使用。

这特别痛苦，因为我的自定义 DialogFragment 使用白色背景，所以这种变化太臭名昭著了，不能放在一边。

让我以更形象的方式向您展示：

![在此处输入图像描述](../Images/bb0925760763ff93366ab33c169fbe5f.png)

现在我的 DialogFragment 的 XML 代码如下：

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <LinearLayout
        android:id="@+id/holding" 
        android:orientation="vertical" 
        android:layout_width="fill_parent" 
        android:layout_height="fill_parent"
        android:background="@drawable/dialog_fragment_bg"
        >
        <!-- Usamos un LinearLayout para que la imagen y el texto esten bien alineados -->
        <LinearLayout
            android:id="@+id/confirmationToast" 
            android:orientation="horizontal" 
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content"
            >

            <TextView android:id="@+id/confirmationToastText" 
            android:layout_width="wrap_content"
            android:layout_height="fill_parent" 
            android:text="@string/help_dialog_fragment"
            android:textColor="#AE0000"
            android:gravity="center_vertical"
            />

        </LinearLayout>
        <LinearLayout
            android:id="@+id/confirmationButtonLL" 
            android:orientation="horizontal" 
            android:layout_width="fill_parent" 
            android:layout_height="fill_parent"
            android:gravity="center_horizontal"
            >    
            <Button android:id="@+id/confirmationDialogButton"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:gravity="center"
                android:layout_marginBottom="60dp"
                android:background="@drawable/ok_button">
            </Button>
        </LinearLayout>
    </LinearLayout>
</ScrollView> 
```

以及实现DialogFragment的类的代码：

```
public class HelpDialog extends DialogFragment {

    public HelpDialog() {
        // Empty constructor required for DialogFragment
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        //Inflate the XML view for the help dialog fragment
        View view = inflater.inflate(R.layout.help_dialog_fragment, container);
        TextView text = (TextView)view.findViewById(R.id.confirmationToastText);
        text.setText(Html.fromHtml(getString(R.string.help_dialog_fragment)));
        //get the OK button and add a Listener
        ((Button) view.findViewById(R.id.confirmationDialogButton)).setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                 // When button is clicked, call up to owning activity.
                HelpDialog.this.dismiss();
             }
         });
        return view;
    }

} 
```

以及主Activity中的创建过程：

```
/**
 * Shows the HelpDialog Fragment
 */
private void showHelpDialog() {
    android.support.v4.app.FragmentManager fm = getSupportFragmentManager();
    HelpDialog helpDialog = new HelpDialog();
    helpDialog.show(fm, "fragment_help");
} 
```

我真的不知道这个与对话框相关的答案是否也适合这里[Android: How to create a Dialog without a title?](https://stackoverflow.com/questions/2644134/android-how-to-create-a-dialog-without-a-title)

我怎样才能摆脱这个标题区域？

* * *

## 回答 #1

> 赞同：593
> 
> 时间：2013-03-07T18:54:20.843

只需将这行代码添加到您的`HelpDialog.onCreateView(...)`

```
getDialog().getWindow().requestFeature(Window.FEATURE_NO_TITLE); 
```

这样你就明确要求得到一个没有标题的窗口:)

**编辑**

正如下面的评论`@DataGraham`所`@Blundell`指出的那样，在`onCreateDialog()`方法中添加对无标题窗口的请求而不是`onCreateView()`. 这样，当您不将片段用作`Dialog`：

```
@Override
public Dialog onCreateDialog(Bundle savedInstanceState) {
  Dialog dialog = super.onCreateDialog(savedInstanceState);

  // request a window without the title
  dialog.getWindow().requestFeature(Window.FEATURE_NO_TITLE);
  return dialog;
} 
```

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2013-05-08T19:23:51.630

对话框片段有 setStyle 方法，应该在视图创建[Java Doc](http://developer.android.com/reference/android/app/DialogFragment.html#setStyle%28int,%20int%29)之前调用。对话框的样式也可以用相同的方法设置

```
public static MyDialogFragment newInstance() {
        MyDialogFragment mDialogFragment = new MyDialogFragment();
        //Set Arguments here if needed for dialog auto recreation on screen rotation
        mDialogFragment.setStyle(DialogFragment.STYLE_NO_TITLE, 0);
        return mDialogFragment;
} 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-12-11T08:44:15.600

```
FragmentManager manager = getSupportFragmentManager();
SettingsDialog sd = new SettingsDialog();
sd.setStyle(DialogFragment.STYLE_NO_TITLE, 0);
sd.show(manager, "settings_dialog"); 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2015-10-21T20:07:52.690

尝试简单的方法

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setStyle(STYLE_NO_TITLE, 0);
} 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-12-10T12:20:08.040

将样式设置为 Theme_Holo_Dialog_NoActionBar：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setStyle(STYLE_NORMAL, android.R.style.Theme_Holo_Dialog_NoActionBar);
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2014-08-12T07:47:08.113

```
public class LoginDialog extends DialogFragment {   
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.login_dialog, null);
        getDialog().getWindow().requestFeature(Window.FEATURE_NO_TITLE);
        return view;
    }   
} 
```

# javascript - 如果通过 $.ajax 请求，则缺少安全 URL 的身份验证提示

> ID：15277461
> 
> 赞同：4
> 
> 时间：2013-03-07T17:10:51.933
> 
> 标签：javascript, jquery, ajax, authentication, cross-domain

当我在家工作时，我们开发服务器的 URL 需要基本身份验证。因此，如果一个网页有一个脚本或链接标签对我们的开发服务器的引用，我们会得到每个服务器 URL 的提示。

最近，我使用 jQuery 在开发服务器上编写了一个对 API 的 ajax 调用`$.ajax`。我没有收到身份验证提示，并且 Firebug 报告 401 未经授权。但是，如果我将这个 API 直接放在浏览器地址栏中，我会得到提示。

目前，我必须切换到 Chrome 并调用 --disable-web-security。当我这样做时，`$.ajax`调用将导致浏览器给我一个提示。

这是`$.ajax()`浏览器或其他东西的“问题”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:26:33.573

[您可以按照jQuery.ajax()](http://api.jquery.com/jquery.ajax/)文档中的建议将您的凭据与请求一起发送：

```
$.ajax({
    // ...
    username: "foo",
    password: "bar"
}); 
```

不过，请确保您没有将您的个人证书推送给某些 SCM！

# ruby-on-rails - 如何不改进此代码以不重复 twitter 引导模式？

> ID：15277464
> 
> 赞同：0
> 
> 时间：2013-03-07T17:10:57.723
> 
> 标签：ruby-on-rails, ruby-on-rails-3, twitter-bootstrap, modal-dialog

我有一个`Project`有很多`Pictures`。我使用第一张图片作为链接来调用[twitter bootstrap modal](http://twitter.github.com/bootstrap/javascript.html#modals)，其中将显示一些信息以及项目页面的链接。

```
<!-- Modal -->
<div id="<%= project.id %>" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3><%= project.title %> <small><%= project.sub_title %></small></h3>
  </div>
  <div class="modal-body">
    <p><%= ActionView::Base.full_sanitizer.sanitize (project.description) %></p>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    <%= link_to 'More Details', project_path(project), class: 'btn btn-primary' %>
  </div>
</div> 
```

为了使模式适用于每个项目，我`project.id`已将`Modal id`. 所以，我实际上正在创建许多模式，每个项目一个。

```
<% @projects.each do |project| %>
  <%= link_to (image_tag project.pictures.first.url), "##{project.id}", class: 'btn', role: 'button', data: { toggle: 'modal' } %>
  <%= render 'projects/modal', project: project %>
<% end %> 
```

好吧，一切都很好，但我不喜欢它！如果我有很多项目，这将成为一个加载问题。

所以，我想找到一种不加载所有模式的方法。我想要一个由项目信息填充的模态模板。

关于如何改进它的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T18:28:50.477

创建一个模式，而不是为每个项目创建一个。使用 javascript 打开每个链接上的模态（而不是`data-toggle="modal"`），在此之前，使用 Javascript 设置项目的标题、副标题、描述和链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T21:31:38.327

*注意：*我目前没有设置导轨，所以不能直接测试，但应该可以：

将以下通用模态代码放入模态部分：

```
<div id="genericModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3></h3>
  </div>
  <div class="modal-body">
    <p></p>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    <%= link_to 'More Details', nil, class: 'btn btn-primary' %>
  </div>
</div> 
```

在视图顶部包括以下内容：

```
<script>
function populateModal(projectId) {
     $(".modal-header").find("h3").html($(projectId).find("#p_title").html());
     $(".modal-body").find("p").html($(projectId).find("#p_desc").html());
     $(".modal-footer").find("a").attr("href", $(projectId).find("#p_link > a").attr("href"));
     $("#genericModal").modal('show');
}
</script> 
```

然后在您的视图中进一步向下，您可以执行以下操作：

```
<%= render 'projects/modal' %>
<% @projects.each do |project| %>
  <%= link_to (image_tag project.pictures.first.url), html => {:onclick => "populateModal('##{project.id}')", :class => 'btn', :role => 'button'} %>
  <div id="#{project.id}" class="hide">
    <span id="p_title"><%= project.title %> <small><%= project.sub_title %><small></span>
    <span id="p_desc"><%= ActionView::Base.full_sanitizer.sanitize (project.description) %></span>
    <span id="p_link"><%= link_to project_path(project) %></span>
  </div>
<% end %> 
```

# android - 由于 androidannotations 插件，Gradle 构建失败

> ID：15277466
> 
> 赞同：0
> 
> 时间：2013-03-07T17:11:09.343
> 
> 标签：android, gradle, android-annotations

我正在将 andoirdannotations 集成到一个 gradle 构建过程中到一个通用的 android 项目中。当我尝试通过添加来构建项目时，`apply plugin: 'androidannotations`出现以下失败：

```
$ gradle clean

FAILURE: Build failed with an exception.

* What went wrong:
Main Manifest missing from /tmp/RunTest/src/main/AndroidManifest.xml 
```

注意（1）：我想维护通用的android项目结构。注意（2）：我已经成功地构建/清理了这个项目，没有 androidannotations 插件

build.gradle 文件：

```
buildscript {
  repositories {
    mavenCentral()
  }

  dependencies {
    classpath 'com.android.tools.build:gradle:0.3'
    classpath 'net.ealden.gradle.plugins:gradle-androidannotations-plugin:0.3.0'
  }
}
apply plugin: 'android'
apply plugin: 'androidannotations'

repositories {
  mavenCentral()
}

android {
    def target = 'android-21'
    def androidAnnotationsVersion = '2.7.1'
    sourceSets {
        main {
            manifest {
                srcFile 'AndroidManifest.xml'
            }
            java {
                srcDir 'src'
            }
            res {
                srcDir 'res'
            }
            assets {
                srcDir 'assets'
            }
            resources {
                srcDir 'src'
            }
        }
        test {
            java {
                srcDir 'tests/src'
            }
        }
    }
} 
```

因此，我已放弃尝试维护通用的 android 项目结构，并将项目目录结构强制转换为此处所述的结构：[http ://tools.android.com/tech-docs/new-build-system/using-新的构建系统](http://tools.android.com/tech-docs/new-build-system/using-the-new-build-system)。

正如预期的那样，这解决了我的问题 `Main Manifest missing from /tmp/RunTest/src/main/AndroidManifest.xml`，但我仍然没有得到快乐。

现在我得到：

```
MyBox:RunTest $ gradle clean
Download http://repo1.maven.org/maven2/net/ealden/gradle/plugins/gradle-androidannotations-plugin/0.3.0/gradle-androidannotations-plugin-0.3.0.pom
Download http://repo1.maven.org/maven2/org/gradle/api/plugins/gradle-android-plugin/1.1.0/gradle-android-plugin-1.1.0.pom
Download http://repo1.maven.org/maven2/net/ealden/gradle/plugins/gradle-androidannotations-plugin/0.3.0/gradle-androidannotations-plugin-0.3.0.jar
Download http://repo1.maven.org/maven2/org/gradle/api/plugins/gradle-android-plugin/1.1.0/gradle-android-plugin-1.1.0.jar

FAILURE: Build failed with an exception.

* What went wrong:
Cannot add task ':processTestResources' as a task with that name already exists.

* Try:
Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output.

BUILD FAILED

Total time: 9.28 secs 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T01:16:30.550

看起来 androidannotations 插件应用了完整的 Java gradle 插件，该插件创建了一个 processTestResources 任务，该任务与我们试图创建的任务发生冲突。

不幸的是，我们使用了相同的名称，但实际上您并不想将完整的 Java 插件应用到使用 android 插件的项目中。android 插件仅应用基本 Java 插件（它提供了创建 Java 编译任务的能力，但不创建由完整 Java 插件创建的默认任务）。

老实说，我们的插件所做的事情与常规 Java 非常不同，旨在扩展 Java 项目的插件（目前）还不能在 android 项目上运行。

您遇到的第一个错误看起来像是我们遇到的问题（但无法重现），其中抛出了一些异常，但 Gradle 忽略了它，跳过了评估 DSL 的其余部分，并继续尝试构建。由于跳过了 sourceSets 重新映射，因此它在错误的地方寻找 Manifest。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-23T13:52:00.503

要将 Android Annotations 集成到您的项目中，请将以下内容添加到项目的 build.gradle 中：

```
buildscript {
    repositories {
        mavenCentral()
    }

    dependencies {
        // other classpathes like gradle here, in my case
        classpath 'com.android.tools.build:gradle:1.1.0'

        // APT Dependency for annotation processing
        classpath 'com.neenbedankt.gradle.plugins:android-apt:1.4'
    }
} 
```

然后在模块的 build.gradle 中应用不是 androidannotation 作为插件，而是应用 'android-apt'

```
// apply apt plugin from global gradle file
apply plugin: 'android-apt' 
```

并将以下内容添加到构建文件中：

```
// Tell apt where to find sources
apt {
    arguments {
        androidManifestFile variant.outputs[0].processResources.manifestFile

        // adjust the path to your module here
        resourcePackageName 'de.company.app'
    }
}

dependencies {
    // Android Anotations for clean and readable code
    apt "org.androidannotations:androidannotations:3.2"
    compile 'org.androidannotations:androidannotations-api:3.2'
} 
```

然后你应该可以在你的项目中使用 Android Annotations。要保持基于 Eclipse 的项目结构，您可以像以前一样调整文件夹：

```
android {
    sourceSets {
        main {
            manifest.srcFile 'AndroidManifest.xml'
            java.srcDirs = ['src']
            resources.srcDirs = ['src']
            renderscript.srcDirs = ['src']
            res.srcDirs = ['res']
            assets.srcDirs = ['assets']
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-30T21:03:00.150

1.  you are using wrong gradle android plugin (com.google.tools plugin developed by Google)
2.  androidannotations plugin uses com.jvoegele.gradle.plugins.android plugin and you don't have to add it to build.gradle as androidannotations plugin will fetch it itself.
3.  Use ADT 21 or earlier as gradle-android-plugin cannot understand version which is not integer number (1.2.2-SNAPSHOT can)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-06T13:08:51.413

例如，您可以查看 build.gradle 文件

[https://github.com/ealden/android-annotations-idea-test/blob/master/build.gradle](https://github.com/ealden/android-annotations-idea-test/blob/master/build.gradle)

# javascript - 使用 jQuery 突出显示单词的父级？

> ID：15277467
> 
> 赞同：4
> 
> 时间：2013-03-07T17:11:15.427
> 
> 标签：javascript, jquery, function, highlight

例如，假设我有一个网页。

```
<ul>
  <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>
  <li>Aliquam tincidunt mauris eu risus.</li>
  <li>Vestibulum auctor dapibus neque.</li>
</ul> 
```

我想找到“Lorem”这个词的所有实例并以两种方式操纵它们：

1.  `<mark>`用HTML5 元素包裹它
2.  `.addClass('look-at-me');`在其父元素上运行。

所以生成的 HTML 将是

```
<ul>
  <li class="look-at-me"><mark>Lorem</mark> ipsum dolor sit amet, consectetuer adipiscing elit.</li>
  <li>Aliquam tincidunt mauris eu risus.</li>
  <li>Vestibulum auctor dapibus neque.</li>
</ul> 
```

我已经阅读了关于[Highlight a word with jQuery 的](https://stackoverflow.com/questions/119441/highlight-a-word-with-jquery)所有评论，并且我一直在使用[highlight: JavaScript text higlighting jQuery plugin](http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html)中的 JS 代码，但这两者都只在上下文中突出显示单词。我操纵了代码来包装单词 using`<mark>`但我对 JS 的熟练程度不足以实现我的 #2 目标，即突出显示父容器。我渴望看到您的有用建议。谢谢！

编辑：解决了！[http://jsfiddle.net/GB8zP/1/](http://jsfiddle.net/GB8zP/1/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T17:22:21.670

```
$('li').each(function () {
    $(this).html($(this).html().replace(/Lorem/ig, "<mark>$&</mark>"));
    if ($(this).text().toLowerCase().indexOf('lorem') >= 0) $(this).addClass('look-at-me');
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/GB8zP/)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T17:15:40.613

尝试这个

```
 $("ul li:contains('Lorem')").each(function() {
   $(this).html($(this).html().replace("Lorem","<mark>Lorem</mark>"));
   $(this).parent().addClass("look-at-me");
 }) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T17:20:54.853

这是我想出的：http: [//jsfiddle.net/c24w/cZegf/](http://jsfiddle.net/c24w/cZegf/)

HTML

```
<ul id="test">
    <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>
    <li>Aliquam lorem tincidunt mauris eu Lorem risus.</li>
    <li>Vestibulum auctor dapibus neque.</li>
</ul> 
```

JS

```
$('li', '#test').each(function highlightElement(i, e) {
    e = $(e);
    e.html(e.html().replace(/lorem/gi, function handleMatch(match) {
        if (!e.hasClass('look-at-me')) e.addClass('look-at-me');
        return '<match>' + match + '</match>';
    }));
}); 
```

CSS

```
.look-at-me {
    background: #f00;
}
match {
    background: #ff0;
} 
```

* * *

*信息*

正则表达式：

```
/lorem/gi
       ↑↑
       ||_ case-insensitive
       |_ matches multiple (global) 
```

匹配功能：

`handleMatch(match)`- 每个成功的正则表达式匹配都会传递给此函数，其中匹配的文本用 . 包围`<match></match>`。此实现使更改要突出显示的确切模式变得更加容易，因为只有正则表达式需要更新。此外，如果需要，匹配的父元素也会相应地突出显示。

# matlab - 如何在matlab中找到数组中的n个最大元素并使其他元素为零？

> ID：15277468
> 
> 赞同：0
> 
> 时间：2013-03-07T17:11:22.853
> 
> 标签：matlab, matrix

假设我有一个矩阵

```
A=[2 3 4; 6 1 2] 
```

我想找到 2 个最大的元素并使所有其他元素为零。在这种情况下，A 最终变成

```
A=[0 0 4; 6 0 0] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:14:56.513

你的行动路线应该是：

1.  对矩阵进行降序排序，得到排序后元素的索引顺序。
2.  丢弃前两个索引并使用其余索引将 中的相应元素清零`A`。

### 例子

```
A = [2 3 4; 6 1 2];
[Y, idx] = sort(A(:), 'descend')
A(idx(3:end)) = 0 
```

这应该导致：

```
A =
     0     0     4
     6     0     0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:17:34.270

```
>> A=[2 3 4; 6 1 2]
A =
     2     3     4
     6     1     2
>> [~,idx] = sort(A(:), 'descend');
>> A(idx(3:end))=0
A =
     0     0     4
     6     0     0 
```

# c++ - Xcode Linker Error Cocos2d-x Box2D CContactListener 构造函数未定义

> ID：15277469
> 
> 赞同：0
> 
> 时间：2013-03-07T17:11:23.143
> 
> 标签：c++, class, constructor, box2d, cocos2d-x

我正在尝试让 Box2D 与我的 Cocos2d-x 项目一起运行。我正在添加碰撞检测，但出现链接器错误 Undefined symbols for architecture i386: "CContactListener::CContactListener()"，引用自：HelloWorldScene.o 中的 HelloWorld::init()

我已经尝试了几件事并研究了几天，但无法弄清楚。任何帮助都会很棒。这是一些代码片段

HelloWorldScene.h

```
 CContactListener *_contactListener; //Variable declared and #include "ContactListener.h" is present at the top 
```

HelloWorldScene.cpp

```
_contactListener = new CContactListener(); //This line gets the error
_world->SetContactListener(_contactListener); 
```

联系人监听器.h

```
class CContactListener : public b2ContactListener {

public:

CContactListener();
~CContactListener();
std::vector<ContactData>_contacts;
virtual void BeginContact(b2Contact* contact);
virtual void EndContact(b2Contact* contact);
virtual void PreSolve(b2Contact* contact, const b2Manifold* oldManifold);    
virtual void PostSolve(b2Contact* contact, const b2ContactImpulse* impulse); 
```

};

联系人监听器.cpp

```
#include "ContactListener.h"

CContactListener::CContactListener(): _contacts() 
{
}

CContactListener::~CContactListener() 
{
}
//...other functions 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T03:25:23.567

CContactListener.cpp 未在 Xcode 中添加目标构建。我只是在 .ccp 文件的文件检查器中检查了我的项目的目标框。轻松修复。

# asp.net - 在中等信任.NET 4.0 中使用非对称密钥进行数字签名/解密

> ID：15277479
> 
> 赞同：3
> 
> 时间：2013-03-07T17:11:44.190
> 
> 标签：asp.net, asp.net-4.0, digital-signature, medium-trust

我有一些文件，我想用自己在 ASP:NET 中的证书进行数字签名。在 3.5 .NET（中等信任）中，我设法做到了这一点，但是当以中等信任切换到 .NET 4.0 时，我遇到了 System.Security 异常：

```
System.Security.SecurityException: Request for the permission of type &#39;System.Security.Permissions.KeyContainerPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&#39; failed.
   at System.Security.CodeAccessSecurityEngine.Check(Object demand, StackCrawlMark& stackMark, Boolean isPermSet)
   at System.Security.CodeAccessSecurityEngine.Check(CodeAccessPermission cap, StackCrawlMark& stackMark)
   at System.Security.CodeAccessPermission.Demand()
   at System.Security.Cryptography.Utils.CreateProvHandle(CspParameters parameters, Boolean randomKeyContainer)
   at System.Security.Cryptography.Utils.GetKeyPairHelper(CspAlgorithmType keyType, CspParameters parameters, Boolean randomKeyContainer, Int32 dwKeySize, SafeProvHandle& safeProvHandle, SafeKeyHandle& safeKeyHandle)
   at System.Security.Cryptography.RSACryptoServiceProvider.GetKeyPair()
   at System.Security.Cryptography.RSACryptoServiceProvider..ctor(Int32 dwKeySize, CspParameters parameters, Boolean useDefaultKeySize)
   at System.Security.Cryptography.X509Certificates.X509Certificate2.get_PrivateKey() 
```

我的代码是：

```
X509Certificate2 certificate = null;
            try
            {
                certificate = new X509Certificate2(AppDomain.CurrentDomain.BaseDirectory + licenceFile, licenceFilePass, X509KeyStorageFlags.MachineKeySet | X509KeyStorageFlags.Exportable);

                if (certificate == null)
                    throw new Exception("The certificate is null!!!");
            }
            catch (Exception ex)
            {
                exception += "X509Certificate2 fail! Did not get certificate " + AppDomain.CurrentDomain.BaseDirectory + licenceFile;
                exception += FormatException(ex);
                goto SetError;
            }

            RSACryptoServiceProvider myRSASigner = null;

            try
            {
                myRSASigner = (RSACryptoServiceProvider)certificate.PrivateKey;

                if (myRSASigner == null)
                {
                    throw new Exception("No valid cert was found");
                }

                    doc = SignXmlFile(doc, myRSASigner);

            catch (Exception ex)
                {
                    exception += "SignXmlFile failed";
                    exception += FormatException(ex);
                    goto SetError;
                } 
```

当我尝试提取我自己本地存储的许可证文件的 PrivateKey 时发生错误：

```
myRSASigner = (RSACryptoServiceProvider)certificate.PrivateKey; 
```

我知道我缺少 KeyContainerPermission，但是对于我自己的证书？不幸的是，我也用另一个证书解密，当然会出现同样的问题....

我无法提高信任级别，因为该网站位于托管服务器上。我也怀疑我能否说服我的提供商在 GAC 中安装我自己的程序集来执行此操作......

# c++ - 使用 C++ 进行实例级封装

> ID：15277480
> 
> 赞同：0
> 
> 时间：2013-03-07T17:11:45.530
> 
> 标签：c++, encapsulation

我有一个两部分的问题。首先，我了解 C++ 仅提供类级别的数据封装，这意味着同一类的所有对象都可以访问彼此的私有成员。我理解这样做的原因，但找到了一些链接（即[http://www.programmerinterview.com/index.php/c-cplusplus/whats-the-difference-between-a-class-variable-and-an- instance-variable/](http://www.programmerinterview.com/index.php/c-cplusplus/whats-the-difference-between-a-class-variable-and-an-instance-variable/)），这似乎与这一点相矛盾，表明我可以执行以下操作：

```
class testclass {
  private:

  // Below would be an instance-level variable, and new memory for it is set aside 
  // in each object I create of class testclass 
  int x;

  // Below would be a class-level variable, memory is set aside only once no matter 
  // how many objects of the same class 
  static int y;
} 
```

我想做的实际上是使这项工作，即我想在一个类中定义一个变量，该变量在*每个实例化*中都是私有的（这是我的第二个问题）。由于上面的代码片段似乎没有实现这一点，是否有一种解决方法可以用来创建单个对象私有的数据？谢谢！

编辑：

确实，我还在学习 OO 基础知识。我将使用无处不在的汽车示例来展示我正在尝试做的事情，我确信这一定是一个常见的尝试。我欢迎任何有关如何重新考虑它的建议：

```
class car {
  private:
    int mileage;
  public:
    car(int); // Constructor
    void odometer();
};

car::car(int m) {
  mileage = m;
}

void car::odometer() {
  return mileage;
}

int main(void) {
  car ford(10000), honda(20000);

  cout<<ford.odometer(); //Returns 20000, since honda constructor overwrites private variable 'mileage'
} 
```

有没有办法让 odometer() 方法返回福特或本田的里程，这取决于我想要什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:20:13.040

特权（公共、私有、受保护）仅适用于名称。只有在解析名称时，编译器才会应用权限。一旦编译，所有这些信息都消失了。

在上面的示例中，在解析为 THOSE 变量的范围内对名称 x 和 y 的所有使用对您的类都是私有的。只有在你的类中声明的函数，无论它们是否是静态的，才能*通过 name*访问这些变量。

但是，如果您将变量分配给其他对象，则所有的赌注都将被取消，然后这些对象可以通过具有其他权限的其他名称来引用该变量。

我不确定您对“在每个实例化中”的要求是什么。AFAIK，没有本地方法可以将变量设为私有，这样只有该实例才能访问它。在所有情况下，实例都可以访问彼此的私有部分。

我想有一些方法可以解决这个问题。首先是模板化你的类并给每个实例一个不同的类型。您可以使用整数模板参数或其他东西来做到这一点。当您尝试将这些类型作为同一种事物使用时，这可能会使生活变得烦人。您必须虚拟化并拥有一个抽象基类或其他东西。

目前这是我能想到的唯一方法。所有其他人都依赖于调用实体玩得很好。

一般来说，您很少希望保护成员免受其他情况的影响。将相同类型传递给相同类型的通常情况是在复制和分配期间，您基本上需要有关源的所有知识才能正确复制。我敢打赌，你需要重新考虑你想要做什么，不管那是什么。

# vmware - 如何从主机中找到 vmware 的 locahost 服务器

> ID：15277483
> 
> 赞同：-1
> 
> 时间：2013-03-07T17:12:01.993
> 
> 标签：vmware

我在同一台 PC 上的 VMware 上运行了一个网站服务器。我想知道如何通过我的主机获取该服务器的 IP。我的服务器正在运行 red hat，它处于“已保存状态”。所以它不是一个物理操作系统，我可以进去浏览我的红帽。我可以ping那台服务器吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:29:15.817

我以两种方式之一做到这一点。您是否可以从控制台访问机器？如果是这样，请登录并使用 /sbin/ifconfig 查找地址。如果不查找文件 dhcpd.leases（在 Linux 上，它位于 /etc/vmware/vmnet8/dhcpd 用于 NAT /etc/vmware/vmnet1/dhcpd 用于主机 -only。在文件中有许多数据块： -

```
lease ip-address {
hardware ethernet MAC address
} 
```

将IP地址与MAC地址匹配，您就拥有了。

例如 MAC 地址 00:0C:29:64:B4:EF

```
lease 192.168.240.138 {
    starts 4 2013/03/07 17:19:44;
    ends 4 2013/03/07 17:49:44;
    hardware ethernet 00:0c:29:64:b4:ef;
} 
```

注意Mac地址匹配，ip地址为192.168.240.138

虚拟机上的 /sbin/ifconfig 给出

```
eth0      Link encap:Ethernet  HWaddr 00:0c:29:64:b4:ef  
          inet addr:192.168.240.138  Bcast:192.168.240.255  Mask:255.255.255.0 
```

希望这可以帮助。我怀疑 Windows 上的 VMWare 中会有类似的文件，但我必须检查

# php - 正则表达式原子分组似乎在 preg_match_all() 中不起作用

> ID：15277486
> 
> 赞同：5
> 
> 时间：2013-03-07T17:12:09.410
> 
> 标签：php, regex

我最近一直在玩正则表达式，当我在 php.ini 中使用 preg_match_all 时，有一件事对我来说没有按预期工作。

我在[http://www.solmetra.com/scripts/regex/index.php](http://www.solmetra.com/scripts/regex/index.php)使用在线正则表达式工具。

我使用的正则表达式是`/(?>x|y|z)w/`. 我正在使它匹配`abyxw`。我预计它会失败，但它会成功，并且匹配`xw`.

由于使用了原子分组，我预计它会失败，从我从多个来源阅读的内容来看，它可以防止回溯。我所期待的正是引擎尝试`y`与交替匹配并成功。后来它尝试`w`与正则表达式文字匹配`w`并失败，因为它遇到`x`. 然后它通常会回溯，但由于原子分组，在这种情况下它不应该。所以据我所知，它应该继续尝试`y`与这个原子组匹配。然而事实并非如此。

我希望能对这种情况有所了解。:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T17:28:30.510

这有点棘手，但是当正则表达式找不到匹配项时，它可以尝试做两件事：

*   **提前开始位置**- 如果匹配在 index 处不能成功`i`，则会从 index 处再次尝试`i+1`，并且这将一直持续到到达字符串的末尾。
*   **回溯**- 如果在正则表达式中使用重复或交替，则正则表达式引擎可以丢弃部分不成功的匹配并通过使用更少或更多的重复或交替中的不同元素重试。

原子组防止回溯，但它们不影响推进起始位置。

在这种情况下，当引擎尝试匹配`y`第一个字符时，匹配将失败，但随后它将继续并查看`xw`字符串的其余部分，这将匹配。

# php - 在任何页面内容上显示自定义字段。德鲁巴 7

> ID：15277494
> 
> 赞同：1
> 
> 时间：2013-03-07T17:12:37.440
> 
> 标签：php, drupal-7, field

我为用户配置文件创建了一个自定义字段。这些是 settings-field_test 整数文本字段。

如何通过 CMS 在任何页面上显示此自定义字段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T05:10:45.083

如果它附加到用户实体，您可以将其插入 page.tpl.php：

```
<?php print render($user_profile['field_test']); ?> 
```

# jar - 注册表项“...”的值为“1.7”，但需要“1.6”。Java 1.7 已安装并且注册表指向它

> ID：15277496
> 
> 赞同：96
> 
> 时间：2013-03-07T17:12:48.217
> 
> 标签：jar, environment-variables, java

我的开发团队最近被迫转移到一个远程开发环境，我们无法完全访问服务器。在更改之前，我们有一个在 Java 1.7 x64 和 JRE 7 上运行良好的 JAR。当我们转移到新服务器时，我们的 JAR 运行良好，但随后其中一位服务器管理员“更新”了我们的 Java 到旧版本版本并卸载了我们正在使用的版本。不要问我为什么，我不知道。我重新安装了 Java 1.7 并连同 JRE 一起卸载了 1.6。

运行时出现以下问题，没有构建错误：

```
Registry key 'Software\JavaSoft\Java Runtime Environment\CurrentVersion'
has value '1.7', but '1.6' is required.
Error: could not find java.dll
Error: could not find Java SE Runtime Environment. 
```

我在笔记本电脑上运行了相同的 JAR，没有任何问题。服务器和我的笔记本电脑在各自的 %HOME% 变量和系统 PATH 中都有 JDK 1.7 和 JRE 7。我什至重新安装了 JRE 6 并将其放置在系统环境 PATH 变量中，结果相同。

我还将注册表更改回查看 1.6 并导致以下结果，我查找了它似乎是由于安装了多个 Java（导致我原来的问题）：

```
Exception in thread "main" java.lang.UnsupportedClassVersionError: ... :
Unsupported major.minor version 51.0 
```

当我一直在查看各种论坛时，我将不胜感激大家的任何见解，但似乎没有什么是我的问题。此外，这也发生在我们正在使用的另一台服务器上。谢谢！

更新：将 JAR 重新编译为 1.6 或 1.7 并匹配 JDK 不走运。另外，为什么新版本的 Java 会破坏旧的编译版本？

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2013-09-21T01:54:21.603

当您以某种方式混淆 java 本身时，就会发生这种情况。您正在尝试运行发现 JRE 7 的 java 6 VM。即使您仅在命令行中键入`java`或`java -version`在配置错误的环境中键入，它也可能会显示此问题。JAR 不是问题，除非在极不可能的情况下，JAR 中的代码正在 Windows 注册表中查找（这可能不是您的情况）。

就我而言，我在文件夹中有来自 Java 6的`java.exe`,`javaw.exe`和（不知道它是如何出现的）。JDK 和 JRE 的其余部分在 PATH 里面找到。哎呀！`javaws.exe``Windows/System32``C:\Java\jdk_1.7.0\bin`

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2015-01-03T15:37:09.660

在已经运行 Java 7 的系统上安装 java 8 (jdk & jre) 时出现类似错误。

> 错误：注册表项 'Software\JavaSoft\Java Runtime
> 
> Environment'\CurrentVersion' 的值为 '1.8'，但需要 '1.7'。
> 
> 错误：找不到 java.dll 错误：找不到 Java SE 运行时环境。

我的环境设置正确（正确定义了路径和 java_home），但问题出在 8 版之前的 Java 安装程序的工作方式上，即它们用于复制三个可执行文件（java.exe、javaw.exe 和 javaws.exe ) 到 Windows 系统目录。除非被新的 pre-8 安装覆盖，否则这些将保留。

但是，Java 8 安装程序会在新目录 C:\ProgramData\Oracle\Java\javapath 中创建符号链接，指向实际的 JRE 8 位置。

这意味着您实际上将运行旧的 7 个 exe，但使用新的 8 个 DLL。

因此，解决方案就是从 Windows 系统目录中删除 3 个 Java exe，如上所述。

如果您在 64 位 Windows 上运行 32 位 Java，则 exe 将在 Windows\SysWOW64 中，否则在 Windows\System32 中。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2014-09-22T17:18:33.633

我已经删除了 windows/system32 中的 java 文件，并且还从 PATH 变量中删除了 c:\ProgramData\Oracle\Java\javapath，因为有 3 个符号链接到 java 1.8 文件。

我在 %JAVA_HOME% 变量中有 JDK 1.7，在 PATH 中有 java1.7/bin。

PS1：我的问题是在 Java 1.7 和 Java 1.8 之间。

PS2：我无法将此作为评论添加到维克多的回答中，因为我没有足够的积分。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2015-05-12T09:36:29.900

在开始菜单中输入“regedit”打开注册表编辑器

转到左侧注册表资源管理器/树菜单上的“HKEY_LOCAL_MACHINE”

单击“HKEY_LOCAL_MACHINE”注册表中的“软件”

单击“软件”注册表中的“JavaSoft”

单击“JavaSoft”注册表列表中的“Java Runtime Environment”，您可以看到已安装的不同版本的java

单击“Java 运行时环境”- 在右侧，您将获得 4-5 行。请选择“CurrentVersion”并右键单击（选择修改选项）将版本更改为“1.7”

现在魔法已经完成

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-07-24T07:36:54.657

我不知道是否有人还在关注这个线程，但我最近在尝试将 ActiveMQ 5.10 作为 Windows 服务启动时遇到了这个问题。

我没有设置 JAVA_HOME 路径。我安装了 Java 6 和 Java 7，但默认版本是 v7。（即，如果我打开一个命令窗口并键入“java -version”）。

这就是线索所在 - “java -version”返回“Java HotSpot(TM) 64-Bit Server VM (build 23.1-b03, mixed mode)”但我已经安装了 Win32 服务......

事实证明，如果您在 64 位机器上使用 Win32 包装器，它会以某种方式决定使用不同版本的 Java...

所以我的解决方法是卸载 32 位版本的包装器并安装 64 位版本。厌恶我的机器；我猜只是习惯......但幸运的是我最终解决了这个问题......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-04T21:04:48.177

对于我的 Win7

悖论在于 System32 文件夹中的 java.exe 和 javaw.exe。打开那个文件夹我看不到它们，但是在开始菜单中使用搜索我得到了这些文件的链接，删除了它们。Next searsh 给了我指向 JAVA_HOME 文件的链接

魔法 ）

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-05-09T10:51:36.927

更改到正确的目录，`java.exe`即转到所需的 JDK 版本`java.exe`

```
cd C:/Program Files/Java/jdk1.7.0_25/bin 
```

`java.exe`从此目录运行，它优先于注册表和 $PATH 设置。

```
java -jar C:/installed/selenium-server-standalone-2.53.0.jar 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2015-05-10T20:00:16.750

我通过卸载 Java 1.8 解决了这个问题

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2014-07-31T13:45:06.437

使用 regedit，删除对应于 java 7 的条目。它将起作用。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2013-03-07T17:14:51.763

jar 被编译为`1.6` 兼容的。这就是您收到此错误的原因。两个解决方案：
1) 使用 Java 1.6

或者

2）重新编译jar以符合您的环境`1.7`

# mysql - 使用多个连接优化 MySQL Count 查询

> ID：15277497
> 
> 赞同：0
> 
> 时间：2013-03-07T17:12:48.537
> 
> 标签：mysql, sql, ruby-on-rails

我有一个 SQL 查询需要 3.5 秒才能返回计数。查看查询的跟踪，看起来所有索引都在使用。我能做些什么来优化它以合理执行？

提前致谢。

* * *

[**链接到跟踪**](https://rpm.newrelic.com/accounts/86996/applications/553214/transactions?tw%5Bend%5D=1362600268&tw%5Bstart%5D=1362599693#id=100411964&app_trace_id=971064401&tab-detail_971064401=trace_details)

**SQL 详细信息**

**询问**

```
SELECT count(DISTINCT `workorders`.id) AS count_all FROM `workorders` 
LEFT OUTER JOIN `users` ON `users`.id = `workorders`.user_id 
LEFT OUTER JOIN `assets` ON `assets`.id = `workorders`.asset_id 
LEFT OUTER JOIN `users` completed_by_users_workorders ON `completed_by_users_workorders`.id = `workorders`.completed_by_user_id 
LEFT OUTER JOIN `messages` ON messages.workorder_id = workorders.id LEFT OUTER JOIN `priorities` ON `priorities`.id = `workorders`.priority_id 
LEFT OUTER JOIN `suspension_reasons` ON `suspension_reasons`.id = `workorders`.suspension_reason_id 
LEFT OUTER JOIN `job_types` ON `job_types`.id = `workorders`.job_type_id 
LEFT OUTER JOIN `workorder_statuses` ON `workorder_statuses`.id = `workorders`.workorder_status_id 
LEFT OUTER JOIN `workorder_types` ON `workorder_types`.id = `workorders`.workorder_type_id 
LEFT OUTER JOIN `workorder_tasks` ON workorder_tasks.workorder_id = workorders.id 
LEFT OUTER JOIN `frequencies` ON `frequencies`.id = `workorder_tasks`.frequency_id 
LEFT OUTER JOIN `facilities` ON `facilities`.id = `workorders`.facility_id 
LEFT OUTER JOIN `locations` ON `locations`.id = `workorders`.location_id 
WHERE ((((workorders.workorder_status_id = ?)) AND (workorders.application = ?)) AND (workorders.facility_id = ?)) 
```

* * *

**持续时间 3,791 ms 查询分析（显示详细信息）**

**Trace** * *workorders* *
使用此索引检索表：facility_id,app_fac,workorder_status_id 您可以通过仅查询索引内的字段来加快此查询。或者，您可以创建一个包含查询中每个字段的索引，包括主键。

扫描了该表的大约 33850 行。

**users**
使用以下索引检索表：PRIMARY 扫描了该表的大约 1 行。

**assets**
该表是使用以下索引检索的：PRIMARY

扫描了该表的大约 1 行。

**completed_by_users_workorders**
使用以下索引检索表：PRIMARY

扫描了该表的大约 1 行。

**消息**
使用此索引检索表：workorder_id

扫描了该表的大约 2 行。

**优先级**
使用以下索引检索表：PRIMARY

扫描了该表的大约 1 行。

**suspend_reasons**
使用以下索引检索表：PRIMARY

扫描了该表的大约 1 行。

**job_types**
使用以下索引检索表：PRIMARY

扫描了该表的大约 1 行。

**workorder_statuses**
使用以下索引检索表：PRIMARY

扫描了该表的大约 1 行。

**workorder_types** 使用以下索引检索表：PRIMARY

扫描了该表的大约 1 行。

**workorder_tasks** 使用此索引检索表：index_workorder_tasks_on_workorder_id 您可以通过仅查询索引内的字段来加快此查询。或者，您可以创建一个包含查询中每个字段的索引，包括主键。

扫描了该表的大约 1 行。

**频率** 使用此索引检索表：PRIMARY

扫描了该表的大约 1 行。

**设施**
使用以下索引检索表：PRIMARY

扫描了该表的大约 1 行。

**位置**
使用此索引检索表：PRIMARY

扫描了该表的大约 1 行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:17:52.390

除非我遗漏了一些东西，否则你会有一堆`LEFT JOIN`不影响最终结果的 s （你正在选择`distinct workorders.id`- 我猜它是一个 PK 列。那么只有 where 很重要，`WHERE ((((workorders.workorder_status_id = ?)) AND (workorders.application = ?)) AND (workorders.facility_id = ?)`所以我相信你可以摆脱所有`LEFT JOIN`s 并写只需从 1 个表中选择，使优化器的生活变得更加轻松......

```
SELECT count(*) AS count_all
FROM `workorders`
WHERE ((((workorders.workorder_status_id = ?)) AND (workorders.application = ?)) AND   
(workorders.facility_id = ?) 
```

上面的查询应该给您与原始查询相同的结果，但工作量要少得多。

# javascript - SVG 到形状 (EaselJS)

> ID：15277498
> 
> 赞同：2
> 
> 时间：2013-03-07T17:12:49.060
> 
> 标签：javascript, canvas, shape, easeljs

在 EaselJS 中，只有形状可以变成蒙版，所以我想知道是否可以将 Inkscape 制作的 SVG 转换为 EaselJS，我发现了这个很棒的工具 - [http://www.professorcloud.com/svg-to-canvas/](http://www.professorcloud.com/svg-to-canvas/)可以让我将 SVG 转换为上下文，但是有没有一种方法/工具可以轻松地将 SVG 转换为 EaselJS 形状（这与 Flash/AS3 中的形状几乎相同）？我只需要这样的基本形状：

```
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   version="1.1"
   width="776.4032"
   height="405.87927"
   id="svg1383">
  <defs
     id="defs1385" />
  <metadata
     id="metadata1388">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     transform="translate(15.455332,-13.016229)"
     id="layer1">
    <path
       d="m 1193.5963,82.437378 a 369.81683,206.47517 0 1 1 -739.63371,0 A 369.81683,206.47517 0 1 1 1193.5963,82.437378 Z"
       transform="matrix(1.0497132,0,0,0.98287671,-491.98585,134.93009)"
       id="mask"
       style="fill:#008000;fill-opacity:1;stroke:none;display:inline" />
  </g>
  <g
     transform="translate(15.455332,-13.016229)"
     id="layer2" />
</svg> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T13:10:50.460

在您提供的网页上生成 js 代码后，您可以覆盖名为[draw](http://www.createjs.com/Docs/EaselJS/files/.._src_easeljs_display_DisplayObject.js.html#l581)的函数。只需将生成的代码粘贴到您的函数中，您就应该能够看到您的图像。

示例代码：

```
 var s = new createjs.Shape();
  // this is important because if we dont change graphics our overriden
  // function wont be called.
  s.graphics.beginFill("#FF0000").rect(0, 0, 75, 100);

  //save old draw function
  var oldDraw = s.draw;
  // here we switch draw funciton to the one generated from svg file
  s.draw = this.draw;
  // draw our model on cache
  s.cache(0, 0, 66, 113, 2);
  // and now we can back to old drawing function
  s.draw = oldDraw; 
```

# button - Pinterest 按钮 - 无效的网址

> ID：15277501
> 
> 赞同：1
> 
> 时间：2013-03-07T17:13:08.897
> 
> 标签：button, pinterest

自昨天 Pinterest 更新其网站以来，我的 Pinterest 的“Pin it”按钮停止正常工作，即旋转轮永远在弹出窗口中运行。

我的代码 - 以前可以正常工作 - 是：

```
 <a data-pin-config="beside" href="//pinterest.com/pin/create/button/?url=<?=urlencode($url)?>&media=<?=urlencode($image_url) ?>&description=The picture I just pinned!" data-pin-do="buttonPin" >
     <img src="//assets.pinterest.com/images/pidgets/pin_it_button.png" />
    </a> 
```

`</body>`我还在结束标记之前包含了 Pinterest js 。

有趣的是，当我访问 Pinterest 的网站并尝试`Add Pin`通过 URL 访问时，我得到：

> “哎呀！无效的 URL”

我的 $url 是指传递几个参数的php页面，即 `http://www.mywebsite.com/img.php?img_id=photo (999).jpg&album=...&page=...`

**更新 #1：**我注意到，当发布的 URL 不包含任何括号时，直接或通过按钮在 Pinterest 上发布没有问题。尽管 URL 都在 php 中进行了 urlencoded，即 ( 和 ) 分别编码为 %28 和 %29，这应该处理括号，但它似乎不起作用。尽管我意识到它正在解释 url 编码的 %28 和 %29 代码，但浏览器仍然显示括号。

**更新 #2：**收到 Pinterest 的回复说

"*有时，如果网站阻止亚马逊 IP，我们会看到这种行为。确保您没有阻止亚马逊 IP 或将我们的用户代理列入白名单：*

> Pinterest/0.1 + [http://pinterest.com/](http://pinterest.com/)

*不幸的是，我们没有可以将您列入白名单的专用 IP 组，因为我们的 IP 会随着时间而变化。*"

在 Pinterest 的回复之后，我进行了研究，并提出了以下相关链接：

*   [http://wordpress.org/support/topic/note-when-entering-user-agent-whitelist](http://wordpress.org/support/topic/note-when-entering-user-agent-whitelist)

    “ *Pinterest 必须作为推荐人或代理列入白名单，这样它才能看到图像 - 如果不是，它只会看到重定向到 HTML 页面（因此“不是有效图像”）。尝试将 pinterest 和 pinterest.com 放在您的用户代理白名单*“

**问题：**

*   这对任何人有用吗？

*   修改 .htaccess 或 robots.txt 以实现此目的的最佳方法是什么？

*   我也面临与 Tumblr 相同的问题。我已经验证没有括号，共享按钮可以正常工作。如果没有其他方法，我应该从 URI 中删除所有括号吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T10:26:36.853

问题解决了！

导致无法固定（或在 Tumblr 上分享）的不是括号，而是 URL 中的空格（在我的例子中是括号前的空格）。尽管空格是 URL 编码 (+)，但 Pinterest 将其视为无效 URL。

我从图片文件名中删除了所有空格，这也意味着来自 URL，因为 URL 作为参数传递图片文件名。

这解决了 Pinterest 和 Tumblr 按钮的问题。

# opticalflow - 有没有光流代码的集合？

> ID：15277509
> 
> 赞同：3
> 
> 时间：2013-03-07T17:13:47.357
> 
> 标签：opticalflow

我目前正在搜索各种光流代码（主要是算法的实现），目的是将它们收集到一个列表中，以后可以以网站的形式发布。

以前有过这样的努力吗？如果是这样，它有没有到达任何地方？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T17:19:52.883

是的，Matlab/C++： http: [//people.csail.mit.edu/celiu/OpticalFlow/](http://people.csail.mit.edu/celiu/OpticalFlow/)
CS UMD EDU：[http](http://www.cs.umd.edu/~ogale/download/code.html)
: //www.cs.umd.edu/~ogale/download/code.html[谷歌搜索](http://www.google.com/search?q=optical+flow+code)它的更多参考资料。

希望有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-28T22:08:54.657

另请参阅，[CVPapers](http://www.cvpapers.com/rr.html)

Matlab/C++/OpenCL-GPU[鲁棒局部光流](http://www.nue.tu-berlin.de/menue/forschung/projekte/rlof/)

Matlab C++ [FlowLib](http://gpu4vision.icg.tugraz.at/index.php?content=downloads.php)

C++/ Cuda GPU [KLT+SIFT](http://cs.unc.edu/~ssinha/Research/GPU_KLT/)

# javascript - jQuery Dynatree，按标题选择子节点？

> ID：15277510
> 
> 赞同：1
> 
> 时间：2013-03-07T17:13:52.790
> 
> 标签：javascript, jquery, dynatree, jquery-dynatree

我正在使用一些代码以编程方式选择动态树的根节点（其中唯一的一个），即

```
 $("#divDynaTree").dynatree("getRoot").visit(function (node) {
        node.select(true);
    }); 
```

我有第二个具有多个“父”和“子”节点的动态树，当我在应用程序中使用单独的事件（按钮单击）时，我想以编程方式选择其中一个“子”。我想使用子节点的标题，但很难找到正确的语法。我确实探索了这个网站和 goodle 上的其他 dynatree 线程，但还没有找到我正在寻找的确切内容（或者它可能很接近，但我的经验不足导致我没有看到它）。我假设代码将与上面类似，使用“访问”.. 但我现在不确定该去哪里。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:24:26.337

试试这个选择所有子节点：

```
$(function(){
    var inEventHandler = false;
    $("#tree").dynatree({
        checkbox: true,
        selectMode: 2,
        [...]
        onSelect: function(select, dtnode) {
            // Ignore, if this is a recursive call
            if(inEventHandler) 
                return;
            // Select all children of currently selected node
            try {
                inEventHandler = true;
                dtnode.visit(function(childNode){
                    childNode.select(true);
                });
            } finally {
                inEventHandler = false;
            }
        } 
```

或按名称搜索节点：

```
var match = null;
tree.visit(function(node){
    if(node.data.title === "foo"){
        match = node;
        return false; // stop traversal (if we are only interested in first match)
    }
});
alert("Found " + match); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-19T03:58:32.237

您可能正在寻找

```
$("#tree").dynatree("getTree").activateKey("KeyName") 
```

**这将使用其key**从外部事件激活节点。这是来自*“Programming dynatree”下的*[dynaTree 文档的第二个示例](http://wwwendt.de/tech/dynatree/doc/dynatree-doc.html)

 *我没有寻找通过名称而不是键来查找节点的方法，可能有更好的方法，但我认为您可以使用访问来查找键，然后像这样激活它。

```
function ActivateNodeByTitle(nodeTitle){
    var $tree = $("#tree").dynatree("getTree")
    $tree.visit(function(node){
        if(node.data.title === nodeTitle){
            $tree.activateKey(node.data.key)
            return false; // stop traverse
        }
    });
    return false
} 
```*

# sql - 如何在 Excel 中捕获文本的 URL，以便将其转储到 SQL 中（使用 SSIS）？

> ID：15277511
> 
> 赞同：2
> 
> 时间：2013-03-07T17:13:52.933
> 
> 标签：sql, excel, tsql, ssis

我有一个 Excel 文件。

```
Column1
Backwater - 01
Backwater - 09
... 
```

名称“Backwater - 01”是一个超链接。我有一个将 Excel 数据导入 SQL 的 SSIS 包。

问题在于`Column1`，它以“Backwater - 01”的形式进入 SQL 表中，而不是实际的 URL：“http...”。

我将如何处理这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:28:01.607

听起来您需要从单元格中提取网址。[http://howtouseexcel.net/how-to-extract-a-url-from-a-hyperlink-on-excel](http://howtouseexcel.net/how-to-extract-a-url-from-a-hyperlink-on-excel)

如果您无权更改获取此数据的 SSIS 应用程序，则可以使用上面的示例创建这些值的新行，其中只有 URL，而不是超链接。如果您需要这方面的帮助，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:18:15.603

从您发布的内容中很难理解，但我猜您没有通过正确的索引访问 Excel 列中的行。

如果 Row[n] 是**Column1**，那么 Row[n+1] 将是**Backwater-01**。

索引是从零开始的，而不是从 1 开始的。

# templates - TFS - xcopy 不适用于我的 TFS 构建

> ID：15277516
> 
> 赞同：2
> 
> 时间：2013-03-07T17:14:01.890
> 
> 标签：templates, build, tfs, xcopy

我为 TFS 构建创建了一个自定义模板，该模板将文件从 Source 文件夹复制到 Destination 文件夹。

```
ForEach<String>
    InvokeProcess
        xcopy "C:SourceFolder\File1.doc" "C:DestinationFolder"

ForEach<String>
    InvokeProcess
        xcopy "C:SourceFolder\File2.doc" "C:DestinationFolder" 
```

我可以将 xcopy 行键入命令提示符，它工作得很好，但由于某种原因不在 TFS 中。我没有错误。我已经坚持了几天，现在我很困惑。有人对此有经验吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-18T07:06:37.957

您必须完全限定 xcopy 的路径。所以调用过程的文件名应该是“C:\Windows\System32\xcopy.exe”

# gwt - GWT 编辑器以编程方式设置路径

> ID：15277518
> 
> 赞同：0
> 
> 时间：2013-03-07T17:14:04.840
> 
> 标签：gwt, path, annotations, editor

如果您使用 UiBinder 在 GWT 中定义编辑器，则可以使用 @Path 注释指定属性值的路径。

如果您在不使用 UiBinder（即以编程方式）的情况下定义编辑器，如何在不使用注释的情况下指定可编辑属性的路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T03:27:30.100

你可以`use the same @Path annotation on the declared fields`。

`It is not bound to UiBinder.`

您可以通过 2 种方式将属性绑定到字段 -

1）声明与属性同名的字段。

2) @Path 注释，以防字段和属性声明为不同的名称。

如果您不想将任何属性绑定到该字段，请使用 @Ignore 注释声明该字段。

这些注解都被 Editor Framework 的代码生成器用来生成一些支持的 java 类。

所以，`At Runtime`你不能改变`Path of the editors programmatically`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T20:46:27.373

如果您以编程方式定义 UI，您仍然可以`@Path`在小部件类中的字段上使用（或仅命名字段以匹配属性）。不使用 UiBinder 并不意味着你不能使用 Editor Framework。

也就是说，无论您如何构建 ui，都无法以编程方式定义路径。编辑器驱动程序生成代码要求它可以查看将使用哪些属性，因此它只生成将属性连接到编辑器的必要代码。

编辑器和 UiBinder 是完全不同的功能 - 碰巧两者都可以连接到您班级中的字段。UiBinder 并不关心`@Path`注解，就像编辑器关心的那样`@UiField`

# java - 根据 JtextArea 中给定的行号突出显示字符串

> ID：15277519
> 
> 赞同：0
> 
> 时间：2013-03-07T17:14:05.463
> 
> 标签：java, string, swing, jtextarea, swing-highlighter

是否有任何函数可以用来实际传递行号和字符串以突出显示该行号中的单词。我不知道如何实现这一目标。

我能够在 JtextArea 上加载我的文件。

正在加载“Hello.txt”的文件包含：

```
Hello, This
is my first
lesson in Java
Hope You Have a nice 
Time. 
```

我希望函数在第 1 行突出显示字符串“first”。

我的代码：

```
import javax.swing.*;  

import java.util.*;  

import java.io.*;  

public class OpenTextFileIntoJTextArea  
{  
public static void main(String[]args)  
{  
 try  
 {  

  FileReader readTextFile=new FileReader("C:\\Hello.py");  

  Scanner fileReaderScan=new Scanner(readTextFile);  

  String storeAllString="";  

  while(fileReaderScan.hasNextLine())  
  {  
   String temp=fileReaderScan.nextLine()+"\n";  

   storeAllString=storeAllString+temp;  
  }  
  JTextArea textArea=new JTextArea(storeAllString);  
  textArea.setLineWrap(true);  
  textArea.setWrapStyleWord(true);  
  JScrollPane scrollBarForTextArea=new JScrollPane(textArea,JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED,JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);  
  JFrame frame=new JFrame("Open text file into JTextArea");  
  frame.add(scrollBarForTextArea);  
  frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);  
  frame.setSize(500,500);  
  frame.setLocationRelativeTo(null);  
  frame.setVisible(true);  
 }  
 catch(Exception exception)  
 {  

  System.out.println("Error in file processing");  
 }  
}  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:28:11.330

从 JTextArea 的方法开始：

1.  见`getLineStartOffset(...)`和`getLineEndOffset(...)`方法。
2.  然后您可以使用该`getText(...)`方法获取该行的所有文本。
3.  然后您可以使用`String.indexOf(...)`在文本中搜索“第一个”的位置。
4.  现在您可以添加从行首的偏移量和 indexOf 方法来获取要在文档中突出显示的文本的位置
5.  然后可以使用`getHighlighter()`文本区域的方法来获取荧光笔
6.  终于可以用`addHighlight()`方法高亮单词了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:29:43.263

你试过玩吗：

JTextComponent.setSelectionStart(int)、JTextComponent.setSelectionEnd(int)、JTextComponent.setSelectedTextColor(java.awt.Color)

# python - SQLAlchemy：转换 Self-Ref JOIN、COUNT、GROUP BY SELECT

> ID：15277520
> 
> 赞同：0
> 
> 时间：2013-03-07T17:14:05.913
> 
> 标签：python, sqlalchemy

我一直在努力获得一个适用于等效 SQLAlchemy 代码的 SQL Select 语句。它涉及两个表。

一个标签表

```
class Tags(Base):
    __tablename__ = 't_tags'
    uid                 = Column(Integer, primary_key=True)
    category            = Column(Enum('service', 'event', 'attribute', name='enum_tag_category'))
    name                = Column(String(32)) 
```

以及一张将他们映射到其原始父母的表格

```
class R_Incident_Tags(Base):
    __tablename__ ='r_incident_tags'
    incident_uid        = Column(String(48), ForeignKey('t_incident.uid'), primary_key=True)
    tag_uid             = Column(Integer, ForeignKey('t_tags.uid'), primary_key=True)

    tag = relationship("Tags", backref="r_incident_tags") 
```

event_uid 是用于标识父级的唯一字符串。

我一直在努力在 SQLAlchemy 中表示的 SELECT 如下

```
SELECT DISTINCT s.name, e.name, count(e.name)
    FROM "t_tags" AS s,
         "t_tags" AS e,
         "r_incident_tags" AS sr,
         "r_incident_tags" AS er
    WHERE   s.category='service' AND
            e.category='event' AND
            e.uid = er.tag_uid AND
            s.uid = sr.tag_uid AND
            er.incident_uid = sr.incident_uid
    GROUP BY s.name, e.name 
```

任何帮助都将不胜感激，因为经过一整天的努力，我什至还没有接近完成工作。

最亲切的问候！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T09:48:17.737

这应该做的工作：

```
s = aliased(Tags)
e = aliased(Tags)
sr = aliased(R_Incident_Tags)
er = aliased(R_Incident_Tags)

qry = (session.query(s.name, e.name, func.count(e.name)).
        select_from(s, e, sr, er).
        filter(s.category=='service').
        filter(e.category=='event').
        filter(e.uid == er.tag_uid).
        filter(s.uid == sr.tag_uid).
        filter(er.incident_uid == sr.incident_uid).
        group_by(s.name, e.name)
        ) 
```

但是您也可以使用`relationship`-based`JOIN`代替简单的`WHERE`子句。

# highcharts - 如何仅在动态高图的末尾添加标记？

> ID：15277521
> 
> 赞同：0
> 
> 时间：2013-03-07T17:14:06.710
> 
> 标签：highcharts

我有一个动态更新的折线图。我想在最后一点添加一个标记。随着图表滚动并添加新点，我想删除以前的标记并将其添加到最近的点。因此，此折线图的“尖端”将只有一个标记。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T18:05:42.897

您可以在 plotOptions 中禁用标记，然后对于您希望标记出现的点，将数据设置为对象，如下所示：

[http://jsfiddle.net/jlbriggs/JVNjs/281/](http://jsfiddle.net/jlbriggs/JVNjs/281/)

```
data: [7,12,16,32,{y:64,marker:{enabled:true,radius:5,fillColor:'#c00'}}] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-19T04:00:52.030

您可以禁用除最后一个点之外的每个点的标记。

开始时：

```
 series: [{
    name: 'Random data',
    data: (function () {
        // generate an array of random data
        var data = [],
            time = (new Date()).getTime(),
            i;

        for (i = -19; i <= 0; i += 1) {
            data.push({
                x: time + i * 1000,
                y: Math.random(),
                marker: {
                  enabled: i === 0
                }
            });
        }
        return data;
    }())
}] 
```

并在添加新点之前的最后一个点禁用标记：

```
 events: {
        load: function () {

            // set up the updating of the chart each second
            var series = this.series[0];
            setInterval(function () {
                var x = (new Date()).getTime(), // current time
                    y = Math.random();
                series.data[series.data.length - 1].update({
                  marker: { enabled: false }
                }, false)
                series.addPoint([x, y], true, true);
            }, 1000);
        }
    } 
```

你可以试试这个。 [http://jsfiddle.net/687215jj/2/](http://jsfiddle.net/687215jj/2/)

# webdriver - 网络驱动程序不返回所有 cookie

> ID：15277523
> 
> 赞同：3
> 
> 时间：2013-03-07T17:14:09.753
> 
> 标签：webdriver, selenium-webdriver, session-cookies

我正在尝试测试一个场景，其中运行 http 请求以使用用户名和密码登录到站点，并在成功时重定向到 google.com。它还创建自己的会话 cookie，我可以在 Firefox 浏览器中查看手动。

但是，当我尝试使用 Selenium Webdriver 检索所有 cookie 时，它​​只是返回属于当前域的 cookie。

我正在使用以下代码：

```
Set <Cookie> allCookies=driver.manage().getCookies();
Iterator <Cookie> itr=allCookies.iterator();
APPLICATION_LOGS.info("Cookie Size--->"+driver.manage().getCookies().size());

while(itr.hasNext())
{  
    Cookie c=itr.next();
    APPLICATION_LOGS.info("Cookie Domain--->"+c.getDomain()+"Cookie Name---"+c.getName()+"Cookie Value---"+c.getValue());
} 
```

如果有任何其他方法可以检索所有 cookie，请告诉我。

# web-services - Symfony2 通过 web 服务对用户进行身份验证

> ID：15277526
> 
> 赞同：5
> 
> 时间：2013-03-07T17:14:19.333
> 
> 标签：web-services, security, symfony, symfony-2.1

我目前正在处理 Symfony2 的安全组件。

我尝试根据网络服务对用户进行身份验证。要对用户进行身份验证，我必须向 Web 服务提供用户名和密码。

我知道我必须创建一个实现 UserProvider 的类。但是 loadUserByUsername 函数不适合我的 web 服务需求：为了验证用户身份，它需要用户名和密码，而 UserProvider 的函数只需要用户名。

这是与我面临的问题类似的问题：[Symfony2 authentication without UserProvider](https://stackoverflow.com/questions/14988162/custom-authentication-which-doesnt-need-userprovider)

这几天我一直在为这个问题苦苦挣扎……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-07T11:13:11.483

我以这种方式解决了这个问题：

服务.yml：

```
services:
     user_provider:
         class: "%my_class%"
         arguments: ["@service_container"] 
```

WebServiceUserProvider.php

```
/**
 * @param ContainerInterface $container
 */
public function __construct(ContainerInterface $container)
{
    $this->apiClient = $container->get('api_client');
    $this->request = $container->get('request');
} 
```

并`$password = $this->request->get('password');`在您的 loadUserByUsername 方法中使用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-27T05:55:13.427

完成此操作的一种方法是通过用户名加载用户，然后验证密码。如果给定用户名的用户存在并且输入的密码与该用户的密码匹配，则验证该用户。例子：

```
public function userLogin($username, $password)
{
    $em = $this->getEntityManager();
    $query = $em->createQuery('SELECT u FROM VenomCoreBundle:User u WHERE u.username = :username OR u.email = :username AND u.isDeleted <> 1 ')
            ->setParameter('username', $username);
    try {
        $entity = $query->getSingleResult();
        if (count($entity) > 0) {
            $encoder = new MessageDigestPasswordEncoder('sha512', true, 10);
            $passwordEnc = $encoder->encodePassword($password, $entity->getSalt());
            $userPassword = $entity->getPassword();

            if ($passwordEnc == $userPassword) {
                $tokenValue = $entity->getUserToken();
                $profile = $entity->getUserProfile();
                if(!$profile) {
                    return false;
                }
                $userName = $profile->getFullName();

                $response = array(
                    'token' => $tokenValue,
                    'username' => $userName
                );
            } else {
                return false;
            }
        }
    } catch (\Doctrine\Orm\NoResultException $e) {
        return false;
    }

    return $response;
} 
```

# android - 远程 TextView 不支持 setTextSize(float)？

> ID：15277531
> 
> 赞同：4
> 
> 时间：2013-03-07T17:14:36.680
> 
> 标签：android, android-widget

我正在尝试在 Widget 中设置远程 TextView 的文本大小，如下所示：

```
RemoteViews rv = new RemoteViews(mContext.getPackageName(), layoutId);
rv.setFloat(R.id.subject, "setTextSize", 10f); 
```

虽然我可以设置其他属性，如文本颜色或更改视图的可见性，但在使用 setTextSize 时，膨胀失败并显示以下错误消息（无堆栈跟踪）：

```
Error inflating RemoteViews at position: 1, using loading view instead
android.widget.RemoteViews$ActionException:
view: android.widget.TextView doesn't have method: setTextSize (float) 
```

setTextSize(float) 具有 @RemotableViewMethod 注释，因此应该支持它，但甚至找不到该方法（“没有方法”和“不支持”错误之间存在差异）。

为什么明明有方法却找不到呢？在 API 16 中为 RemoteViews 引入 setTextViewTextSize() 方法可能表明我的方法有问题？任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-09T16:06:02.957

您应该在第三个参数中使用 int 类型。因此，删除使其成为显式浮点数的“f”。

```
rv.setFloat(R.id.subject, "setTextSize", 10); 
```

# c# - 将带有 linq 的字符串连接到实体

> ID：15277533
> 
> 赞同：1
> 
> 时间：2013-03-07T17:14:39.470
> 
> 标签：c#, .net, entity-framework-5, dynamic-linq

我正在使用[`Dynamic Linq`](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)with`Linq to Entities`

所以，我`List<Person>`用这段代码测试了正常，一切正常：

```
 List<Person> per = new List<Person>();
 per.Add(new Person { IdNo = "1", LastName = "test", MiddleName = "go", FirstName = "let" });
 per.Add(new Person { IdNo = "2", LastName = "hope", MiddleName = "is", FirstName = "way" });
 per.Add(new Person { IdNo = "3", LastName = "must", MiddleName = "be", FirstName = "human" });
 per.Add(new Person { IdNo = "4", LastName = "thing", MiddleName = "anywhere", FirstName = "can" });
 per.Add(new Person { IdNo = "5", LastName = "bird", MiddleName = "fly", FirstName = "away" });

 List<object> paramObjects = new List<object>();
 List<string> fields = new List<string>();
 fields.Add("IdNo == @0");
 paramObjects.Add("1");

 fields.Add("or (LastName + \", \" + MiddleName + \" \" + FirstName).Contains(@1)");
 paramObjects.Add("m");

 var where = string.Join(" ", fields.ToArray());
 var toParam = paramObjects.ToArray();

 var query = per.AsQueryable().Where(where, toParam).ToList(); 
```

当我`Linq To Entities`接近时。

```
using(var con = new DbContext())
{
   var query = con.Person.Where(where, toParam).ToList();
} 
```

我收到了这个错误：

> LINQ to Entities 无法识别方法 'System.String Concat(System.Object, System.Object)' 方法，并且此方法无法转换为存储表达式。

我的问题是：

在我使用*Dynamic Linq*的示例中，如何`Concat`使用 base 字符串？任何人都可以帮助我吗？`Linq To Entities`

 ** * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T17:58:45.597

*   选项1：

    换行...

    ```
    fields.Add("or (LastName + \", \" + MiddleName + \" \" + FirstName).Contains(@1)"); 
    ```

    ...至

    ```
    fields.Add("or string.Concat(LastName, \", \", MiddleName, \" \", FirstName).Contains(@1)"); 
    ```

*   选项 2：

    打开`Dynamic.cs`动态 LINQ 库的文件，`"GenerateStringConcat"`在该文件中搜索。你应该找到这个方法：

    ```
    Expression GenerateStringConcat(Expression left, Expression right) {
        return Expression.Call(
            null,
            typeof(string).GetMethod("Concat",
                new[] { typeof(object), typeof(object) }),
            new[] { left, right });
    } 
    ```

    将`object`参数类型改为`string`，即：

    ```
    Expression GenerateStringConcat(Expression left, Expression right) {
        return Expression.Call(
            null,
            typeof(string).GetMethod("Concat",
                new[] { typeof(string), typeof(string) }),
            new[] { left, right });
    } 
    ```

请记住，动态 LINQ 不是特殊的“LINQ-to-Entities 库”，而是`IQueryable`. 可能有支持`string.Concat(object, object)`通用`object`参数的 Queryable 提供程序，但 LINQ-to-Entities 不支持。它仅`string`支持`string.Concat`. 在实际调用时（仅一次）查看动态 LINQ 文件`GenerateStringConcat`，只要您只想将库与 LINQ-to-Entities/Entity Framework 一起使用，我相信上面的更改是安全的。

**编辑**

选项 1 不起作用，因为在示例中`Concat`获取了*四个*以上 的字符串参数。它最多只能使用四个参数，因为`string.Concat`具有四个显式`string`参数的重载。似乎不可能`params string[]`在动态 LINQ 中将重载与数组参数一起使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-02T20:57:26.150

我遇到了同样的问题，但是对于 NHibernate，我的解决方案是修改 GenerateStringConcat 方法

我改变这个：

```
static Expression GenerateStringConcat(Expression left, Expression right)
    {   
        return Expression.Call(
            null,
            typeof(string).GetMethod("Concat", new[] { typeof(object), typeof(object) }),
            new[] { left, right });
    } 
```

为了这：

```
static Expression GenerateStringConcat(Expression left, Expression right)
    {            
        return Expression.Add(
            left,
            right,
            typeof(string).GetMethod("Concat", new[] { typeof(object), typeof(object) })
        );
    } 
```

他工作得很好:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:25:27.473

改变

```
 var where = string.Join(" ", fields.ToArray()); 
```

至

```
string where = string.Empty;
foreach(var f in fields)
{
    where += f + " "; 
}

where = where.Trim(); 
```*

# java - 如何从两个类中提取共性..模板方法？

> ID：15277539
> 
> 赞同：-1
> 
> 时间：2013-03-07T17:14:59.290
> 
> 标签：java, oop

我有两节课

```
public class ABC {
    public void test() {
       Car a = new Car();
       a.start();
    }
}

public class DEF {
    public void test() {
       Car a = new Car();
       a.start();
       a.stop();
    }
} 
```

现在这两个类都做几乎相同的事情，如何提取共性，或者最好的方法是什么..模板方法可以工作..我在哪里使用接口......并且有一个父方法调用在子类上实现的抽象方法？...但这意味着一个类在方法中没有操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:19:38.017

是的，您可以在此处使用模板方法模式：

```
public abstract class Template {

    public void test() {
       Car a = new Car();
       a.start();
       if(shouldStop()) {
           a.stop();
       }
    }

    public abstract boolean shouldStop();

}

public class ABC extends Template {

    public boolean shouldStop() {
        return false;
    }

}

public class DEF extends Template {

    public boolean shouldStop() {
        return true;
    }

} 
```

在这里，您要添加一个钩子以允许子类在需要时停止。您显然可以扩展它以包含任何其他可选功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:24:08.253

当您有应为所有子类共享的步骤时，模板方法很有用。

[模板方法维基](http://en.wikipedia.org/wiki/Template_method_pattern)

基本结构就是你已经说过的。具有一些必须由子类实现的抽象方法的抽象类。

另一方面，接口定义了 API，而不是行为。所以在这种情况下它是没有用的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:43:31.313

通常，并且尽可能地，我更喜欢将通用功能放在外部（和静态）方法中，主要有两个原因（它们非常细微的不同和相关）：

1.  我更喜欢避免保留我的“继承槽”，我可以只从一个类继承，并且我希望在非常必要或适当的情况下使用它（见第 2 点）；

2.  只有在类之间存在“类型”关系时才应使用继承；无论如何，我个人认为在 Java 中，在某些情况下，您可能会被迫以错误的方式使用继承，因为 Java 语言不提供共享通用功能的机制（例如 ruby​​ 中的模块）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T17:18:24.663

好的，所以你在方法上有共同点：

```
Car a = new Car();
a.start(); 
```

你可以做的是创建一个抽象类，这两个类`extend`。

```
public abstract class ParentClass
{
      public void test()
      {
              Car a = new Car();
              a.start();
      }
} 
```

然后从您的子类中，您可以调用`super.test();`：这将在返回当前方法并完成子类实现之前调用父类中的方法。

**这种方法的优点**

这些类中的任何通用代码现在都可以被提取出来，并放在`ParentClass`. 这意味着没有重复代码，这总是好的。这也意味着您的类具有逻辑结构，适当地提供了超类功能。这再次被认为是一种很好的做法，因为它使您的代码在语义上更具逻辑性。

**这种方法的缺点**

`ParentClass`是其他类可以的唯一类`extend`。这称为[继承](http://en.wikipedia.org/wiki/Inheritance_%28object-oriented_programming%29)，Java 不支持多重继承，因此请记住这一点。如果您`ABC`还与另一组类共享类似的功能，那么您可能需要重新考虑您的类结构。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-07T17:19:54.240

除了这个简单的例子，我有点取决于你还有什么，但你可以做这样的事情：

```
public class ABC {
    public Car test() {
       Car a = new Car();
       a.start();
       return a;
    }

}

public class DEF extends ABC {
    public Car test() {
       Car a = super.test();
       a.stop();
    }
} 
```

# autoscroll - 自动滚动后更改 DIV 的背景颜色

> ID：15277540
> 
> 赞同：1
> 
> 时间：2013-03-07T17:15:02.120
> 
> 标签：autoscroll

我有一个菜单，它使用页面名称后的哈希标签（即 my-page.html#section1）链接到单个页面上的不同 div。

在用户滚动到他们选择的页面的任何部分后，有没有办法简单地更改该 div 的背景颜色？

这样做的原因是我希望用户的眼睛立即转到他们选择的部分。有时可能不会发生这种情况的原因是屏幕空间内会有 2 个部分。

谢谢！

山姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T15:53:37.787

**解决方案**

只需将其添加到您的样式表中：

```
:target {
    -webkit-animation: target-fade 3s 1;
    -moz-animation: target-fade 3s 1;
}
@-webkit-keyframes target-fade {
    0% { background-color: rgba(228,201,128,.3); }
    100% { background-color: rgba(228,201,128,0); }
}
@-moz-keyframes target-fade {
    0% { background-color: rgba(228,201,128,.3); }
    100% { background-color: rgba(228,201,128,0); }
} 
```

# java - ResteasyJacksonProvider 之后的 Resteasy PostProcessInterceptor

> ID：15277541
> 
> 赞同：0
> 
> 时间：2013-03-07T17:15:04.277
> 
> 标签：java, jackson, jax-rs, resteasy

我们有一个 Resteasy 网络服务。

我对 JSON 使用 Jackson 提供程序，包括响应中的传出 JSON 和请求中的传入 JSON。

是否可以在 JSON-Jackson 序列化之后执行 PostProcessInterceptor？

我的 PostProcessInterceptor 必须更改每个传出响应的 JSON 内容。但是当 PostProcessInterceptor 被执行时，如果我打印实体`response.getEntity().toString();`，我会看到 java.lang.Object 的 toString 方法，而不是 JSON 字符串。那是因为 Object 还没有被 Jackson 序列化。

**是否可以在运行 PostProcessInterceptor之前**使用 Resteasy/Jackson 进行序列化？

我还尝试`@Precedence`在我的 PostProcessInterceptor 上使用注释。但它不起作用，即使使用“解码器”优先级（这是最后一个）。

任何想法？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T18:02:54.063

我会选择 CDI 拦截器。您可以从 InvocationContext 中获取截获的方法参数，并在必要时更改它们。

# ruby-on-rails - Rubymotion：使用 JSON 获取请求

> ID：15277544
> 
> 赞同：1
> 
> 时间：2013-03-07T17:15:11.737
> 
> 标签：ruby-on-rails, rubymotion

我是 iOS 编程新手，使用 Rubymotion 构建我的第一个应用程序。在我的 Rubymotion 应用程序中，我 POST 到网络服务器（使用 RoR 构建的应用程序）来验证想要登录的用户，并且正在使用 BubbleWrap gem 进行 RubyMotion [https://github.com/rubymotion/BubbleWrap/blob/master/motion/http .rb](https://github.com/rubymotion/BubbleWrap/blob/master/motion/http.rb)

```
def login(sender)
  payload = {email: @email, password: @password}
  BubbleWrap::HTTP.post("http://example.com/sessions", {payload:   payload}) do |response|
  @authCookie = response.headers['Set-Cookie']
 end 
end 
```

现在，一旦我收到成功的身份验证，我就会使用以下代码从 Web 应用程序接收 JSON 数据：

```
BubbleWrap::HTTP.get("http://example.com/events.json", {cookie: @authCookie, :headers=>{"Content-Type"=>'json'} }) do |response|
 puts response.body #testing the response
end 
```

由于某种原因，从 POST 请求接收到的身份验证令牌没有被 GET 请求正确传递。我知道这一点，因为在 Web 应用程序中，如果身份验证失败，它会重定向到登录页面，这就是从 GET 请求接收到的响应（登录页面的 HTML 代码）。

Web App上的身份验证检查：

```
 def session_check
    if session[:bizid].nil?
     redirect_to login_url
     flash[:notice] = "Please login to view your account!"
     end 
   end 
```

此外，在 Web 应用程序上，此身份验证令牌通过以下方法设置：

```
def create
    current_biz = Bizname.find_by_email(params[:email])
        if current_biz && current_biz.authenticate(params[:password])
            session[:bizid] = current_biz.id
            flash[:notice] = 'Login Successful!'

            if current_biz.events.empty?
                redirect_to getsetup_url
            else
                redirect_to  account_summary_url
            end

        else
            flash[:notice] = 'Incorrect Email or Password.'
            redirect_to login_url   
        end 
    end 
```

关于我在这里可能做错了什么的任何想法？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T01:58:42.063

您也只需将 cookie 作为标头传递。例如：

```
BubbleWrap::HTTP.get("http://example.com/events.json", :headers=> {"Content-Type"=>'json', "Cookie" => @authCookie}) do |response|
  puts response.body #testing the response
end 
```

# asp.net - 如何遍历asp.net中的复选框

> ID：15277547
> 
> 赞同：0
> 
> 时间：2013-03-07T17:15:18.423
> 
> 标签：asp.net, vb.net, visual-studio-2010, sql-server-2008

我正在将以前的 PHP Web 应用程序翻译成 Visual Basic 中的 ASP.Net，以便进行服务器传输。

我正在尝试做的是遍历一组复选框以查看它们是否被选中，如果是，则将它们的值添加到字符串中。

根据我的阅读，设置为 HTML 输入而不是 ASP 控件的复选框可能很难循环并从中获取值。

此外，复选框控制其他复选框组，因此如果（例如）checkbox1 被选中，那么我需要检查复选框组 A 以查看其中哪些被选中。如果选中复选框 3，我需要遍历 B 组等...

所有复选框都有带有简单增量命名约定的 ID：PE1、PE2、PE3 等...

使用 VB 在 ASP 中执行此操作的最佳方法是什么？在 php 中，循环提交的复选框很简单，只需使用变量和计数器来识别它们：

```
var name = 'PE';
For(i=1; i<10; i++){
    checkbox = name.i;
    if(checkbox.checked){
        Blah blah. You get the point.
    }
} 
```

但我不确定如何在 vb.net 中解决这个问题。

我已经对 FindControl 进行了试验，但到目前为止，我在将其转换为可用代码方面运气不佳。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:19:23.130

如果这些是 HTML 控件而不是 asp.net CheckBox 控件，那么我将使用 javscript（如果可以选择 jQuery）来执行此操作。

如果您坚持使用服务器端来执行此操作，则需要将 a 添加到所有 html 输入中，然后使用[FindControl](http://msdn.microsoft.com/en-us/library/486wc64h.aspx)`runat="server"`在服务器端搜索它们。实际上，既然我大声说出来，如果您不打算使用 javascript，您可能应该将它们转换为 asp.net CheckBox 控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T00:49:30.807

循环遍历 ASP 复选框和 HTML 复选框之间的最大区别在于，当您检查必须使用的类型时：“HtmlInputCheckbox”，而不是“Checkbox”。我花了很长时间才弄清楚，但现在循环工作得很好。

```
If TypeOf ctrl Is HtmlInputCheckBox Then
     Dim chkbox As HtmlInputCheckBox = CType(ctrl, HtmlInputCheckBox)
     If chkbox.Checked Then
     Blah
     End If
End If 
```

感谢您的回答！

# image-uploading - wp_enqueue_media() 和自定义帖子类型

> ID：15277549
> 
> 赞同：1
> 
> 时间：2013-03-07T17:15:36.900
> 
> 标签：image-uploading, custom-post-type, meta-boxes

我正在尝试使用图像上传器，并且可以在普通帖子中使用它。但是，它不适用于自定义帖子类型。

经过一番搜索，我似乎需要调用 wp_enqueue_media(); 但是，如果我这样做了，那么普通帖子和自定义帖子类型的图像上传器都不起作用。

为自定义帖子类型调用此函数的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T17:16:46.060

```
function media_uploader() {
    global $post_type;
    if( 'custom-post-type' == $post_type) {
        if(function_exists('wp_enqueue_media')) {
            wp_enqueue_media();
        }
        else {
            wp_enqueue_script('media-upload');
            wp_enqueue_script('thickbox');
            wp_enqueue_style('thickbox');
        }
    }
}
add_action('admin_enqueue_scripts', 'media_uploader'); 
```

# c++ - 使用类方法分配成员值时，C++ 总是崩溃

> ID：15277550
> 
> 赞同：0
> 
> 时间：2013-03-07T17:15:39.823
> 
> 标签：c++, class

所以基本上到目前为止我所拥有的是一个通过对象访问类方法然后分配新值的代码，但是每次我尝试运行时它都会崩溃，有人可以告诉我我做错了什么

```
#include <iostream> 
#include <fstream>
#include <string> 
using namespace std; 
class person
{
      private:
              string name;
              string age;
              string country;
              string food;
              string sex;
              string drink;
      public:
             string setname(string input){name=input;}
             string setage(string input){age=input;}
             string setcountry(string input){country=input;}
             string setfood(string input){food=input;}
             string setsex(string input){sex=input;}
             string setdrink(string input){drink=input;}

             string showname(){return name;}
             string showage(){return age;}
             string showcountry(){return country;}
             string showfood(){return food;}
             string showsex(){return sex;}
             string showdrink(){return drink;}
};
int main() 
{ 
  //ofstream logwrite("test.txt"); 
  cout<<"Create Person? (y/n) ";
  string anwser;
  cin>>anwser;
  if (anwser=="y")
  {
  person object;
  cout<<"Name? ";
  string name;
  cin>>name;
  object.setname(name);
  cout<<object.showname();

  }
  //logwrite.close(); 
  return 0; 
} 
```

抱歉，当我写这篇文章时，我有点着急，我的课程结束了，我没有其他备用，我使用 Dev-C++ 作为编译器，所以我不知道它是否支持警告或任何东西，但它会产生这些错误消息

C:\Users\13276\Desktop\Untitled3.cpp 在成员函数`std::string person::setname(std::string)'中：

C:\Users\13276\Desktop\Untitled3.cpp 在成员函数`std::string person::setname(std::string)'中：

F:\Makefile.win [构建错误] [C:/Users/13276/Desktop/Untitled3.o] 错误 1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:20:31.543

因此，看起来您已将所有 setter 声明为返回`string`，但您没有这样做。我猜你的意思是`void`：

```
void setname(string input){name=input;} 
```

只是为了完整起见，不返回值是[未定义的行为](https://stackoverflow.com/questions/1610030/why-can-you-return-from-a-non-void-function-without-returning-a-value-without-pr)。如果您更新所有设置器以返回`void`，那么看起来可以解决问题。

如评论中所述，如果您发现警告，您可能会立即看到问题。这些方面的东西：

```
Compilation finished with warnings:
source.cpp: In member function 'std::string person::setname(std::string)':
source.cpp:15:54: warning: no return statement in function returning non-void [-Wreturn-type] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T17:19:37.543

您的程序正在崩溃，因为它试图清理一个不存在的字符串对象。

在您的设置方法中，您**没有**返回一个值（即使您的方法声明说它应该是）。这是未定义的行为：

```
string setname(string input){name=input;} 
```

然而，生成的代码会尝试释放一个字符串对象并且`free`调用会失败，因为它会尝试释放一些留在堆栈上的随机内存地址：

```
*** glibc detected *** ./prog: free(): invalid pointer: 0x08049110 ***
======= Backtrace: =========
/lib/i386-linux-gnu/i686/cmov/libc.so.6(+0x6e3f1)[0xb76103f1]
/lib/i386-linux-gnu/i686/cmov/libc.so.6(+0x6fc58)[0xb7611c58]
/lib/i386-linux-gnu/i686/cmov/libc.so.6(cfree+0x6d)[0xb7614d0d]
/usr/lib/i386-linux-gnu/libstdc++.so.6(_ZdlPv+0x1f)[0xb77904bf]
/lib/i386-linux-gnu/i686/cmov/libc.so.6(__libc_start_main+0xe6)[0xb75b8e46]
./prog[0x8048b21] 
```

[如此处](http://ideone.com/2654Cl)所见。您可以通过将返回类型更改为 void 来解决问题：

```
void setname(string input) { name = input; } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-07T17:19:48.007

您在 中缺少一个`return`声明`setname()`。

请尝试以下任一方法：

```
string setname(string input){return name=input;}

void setname(string input){name=input;} 
```

您的其他`setxxx`功能中有类似的错误。

# javascript - jQuery Ajax 竞争条件？

> ID：15277553
> 
> 赞同：4
> 
> 时间：2013-03-07T17:15:58.160
> 
> 标签：javascript, ajax, jquery

我有以下 JavaScript 代码，它遍历页面上的文本字段列表。它将文本字段中的文本作为价格，通过 AJAX GET 将其发送到服务器，并从服务器获取已解析的 double。如果任何返回的价格低于现有价格，则不应提交表单。

问题是表单在所有 AJAX 请求完成之前提交，因为 Ajax 调用的非阻塞即时响应性质。我需要设置一个 wait() 函数（或在所有 Ajax 方法完成时的回调），但不知道如何使用 jQuery 来做到这一点。

有什么建议么？

```
// .submitForm is a simple button type="button", not type="submit"
$(".submitForm").click(function(e){
   var submittable = validatePrices();
   if (submittable) {
     $("#myForm").submit();
   }
});

function validatePrices() {
    var submittable = true; 

    $(".productPrice").each(function(){
        var $el = $(this);

        $.ajax({
            type: "POST",
            url: "/get_price.jsp", 
            async: false,
            dataType: "html",
            data: "price=" + $el.val(), 
            success: function(data)
            {                  
               var price = new Number(data.split("|")[1]);
               var minPrice = new Number($el.data("min-price")); 
               if (price < minPrice) 
               {
                  $el.addClass("error");
                  $(".dynamicMessage").show().addClass("error").append("<p>ERROR</p>");
                  submittable = false;
               }
            }
        });
        return submittable;
    });
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T17:18:57.577

您已经在使用同步 AJAX（这对您的用户体验来说是一个非常糟糕的主意），所以这不是问题所在。问题是您需要取消“提交”处理程序中的默认操作：

```
$(".submitForm").click(function(e){
   var submittable = validatePrices();
   e.preventDefault(); // this line
   if (submittable) {
     $("#myForm").submit();
   }
 }); 
```

为每个单独的字段使用返回到服务器的同步 HTTP 请求将使您的站点非常缓慢。无论如何，当您提交表单时，您将不得不再次检查服务器上的参数，因此最好先检查并返回错误。

*编辑*——现在情况更清楚了，我认为继续进行的方法是完全停止执行 AJAX 验证检查。为什么？好吧，即使您执行了这些测试，您*仍然*需要在实际提交表单时进行基本相同的有效性测试。您不能像在任何其他表单验证方案中那样依赖实际运行的 JavaScript 验证代码。如果您在表单提交时进行验证，它将节省一堆 HTTP 请求，以便同时完成所有操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:21:08.393

您没有取消表单提交。您必须严格使用 ajax 回调（如果您想异步使用它们，那会很好）。

```
$(".submitForm").click(function(e){
   e.preventDefault();
   validatePrices().done(function () { /* ajax success function here */
       if (submittable) {
           $("#myform").trigger('submit');
       }
   }
});

function validatePrices() {
    var checks = [];

    $(".productPrice").each(function(){
        var $el = $(this);
        checks.push($.ajax({
            /* snip */
    });
    return $.when.apply(null, checks);

} 
```

# mysql - 优化一个 SQL 查询

> ID：15277554
> 
> 赞同：1
> 
> 时间：2013-03-07T17:16:06.867
> 
> 标签：mysql, sql

我需要运行查询以从数据库中获取一些数据。问题是我使用的查询有效但需要很长时间。

```
SELECT SHH1.CUST_NO,
       SHH1.CUST_NAME,
       ADDR.BVADDREMAIL 
FROM SALES_HISTORY_HEADER SHH1
INNER JOIN ADDRESS ADDR ON (SHH1.CUST_NO=ADDR.CEV_NO)
INNER JOIN CUSTOMER CUST ON (SHH1.CUST_NO=CUST.CUS_NO)
WHERE CUST.HOLD = 0
AND SHH1.CUST_NO IN (SELECT SHH2.CUST_NO 
                     FROM SALES_HISTORY_HEADER SHH2
                     GROUP BY SHH2.CUST_NO 
                     HAVING Max(SHH2.IN_DATE) < '20120101')
GROUP BY SHH1.CUST_NO,
         SHH1.CUST_NAME,
         ADDR.BVADDREMAIL 
```

我不太擅长这个，所以想知道你们中的任何人是否可以帮助我？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T18:30:02.140

我同意[马克班尼斯特的回答](https://stackoverflow.com/a/15278290/244935)，即 OP 应该这样`FROM CUSTOMER`做`FROM SALES_HISTORY_HEADER`。

所以，假设`CUST_NAME`是 on `CUSTOMER`，我会做以下事情：

```
SELECT CUST.CUS_NO,
       CUST.CUST_NAME,
       ADDR.BVADDREMAIL 
FROM CUSTOMER CUST
JOIN ADDRESS ADDR ON CUST.CUS_NO = ADDR.CEV_NO
WHERE CUST.HOLD = 0
AND CUST.CUS_NO IN (SELECT SHH.CUST_NO 
                    FROM SALES_HISTORY_HEADER SHH
                    GROUP BY SHH.CUST_NO 
                    HAVING Max(SHH.IN_DATE) < '20120101') 
```

请注意，MySQL 必须激活[子查询实现才能优化子选择。](http://dev.mysql.com/doc/refman/5.6/en/subquery-materialization.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T20:53:56.393

在加入之前删除一些行怎么样

```
SELECT S.CUST_NO,
      ,S.Cust_NAME
      ,A.BVADDREMAIL
FROM CUSTOMER C
    INNER JOIN SALES_HISTORY_HEADER S ON (CUST.HOLD = 0 AND S.CUST_NO=C.CUS_NO)
        INNER JOIN ADDRESS A ON (S.CUST_NO=A.CEV_NO)
GROUP BY S.CUST_NO,S.CUST_NAME,A.BVADDREMAIL
HAVING Max(S.IN_DATE) < '20120101' 
```

我对[StevieG](https://stackoverflow.com/users/54555/stevieg)答案的更新

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T18:05:20.887

使用执行计划的哪一部分查询具有主要的执行成本。这很可能表明问题出在哪里。我将执行的下一步是查看索引创建。请记住，默认情况下，聚集索引是在 PK 上创建的，但在 FK 和您可能特别感兴趣的任何潜在字段上创建非聚集索引也是一个好习惯。希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T17:22:17.643

我认为您不需要子选择。以下应该给你相同的结果：

```
SELECT SHH1.CUST_NO,SHH1.CUST_NAME,ADDR.BVADDREMAIL 
FROM SALES_HISTORY_HEADER SHH1
INNER JOIN ADDRESS ADDR ON (SHH1.CUST_NO=ADDR.CEV_NO)
INNER JOIN CUSTOMER CUST ON (SHH1.CUST_NO=CUST.CUS_NO)
WHERE CUST.HOLD = 0
GROUP BY SHH1.CUST_NO,SHH1.CUST_NAME,ADDR.BVADDREMAIL
HAVING Max(SHH1.IN_DATE) < '20120101' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-07T17:53:42.627

假设`CUST_NAME`开启`CUSTOMER`，请尝试：

```
SELECT CUST.CUS_NO CUST_NO,
       CUST.CUST_NAME,
       ADDR.BVADDREMAIL 
FROM CUSTOMER CUST
JOIN ADDRESS ADDR ON CUST.CUS_NO=ADDR.CEV_NO
LEFT JOIN SALES_HISTORY_HEADER SHH 
       ON CUST.CUS_NO=SHH.CUST_NO AND SHH.IN_DATE >= '20120101'
WHERE CUST.HOLD = 0 AND SHH.CUST_NO IS NULL
GROUP BY CUST.CUS_NO, ADDR.BVADDREMAIL 
```

# php - phph in_array 没有找到记录

> ID：15277556
> 
> 赞同：0
> 
> 时间：2013-03-07T17:16:15.147
> 
> 标签：php

我正在使用 in_array 但它回来了，我给它的数据不在数组中，尽管它应该。

看不到我错过了什么？

数组

```
array(3) { 
["MonthlyReturn"]=> array(11) { ["id"]=> string(3) "307" ["employee_id"]=> string(3) "553" } 
["Company"]=> array(13) { ["id"]=> string(3) "160" ["member_number"]=> string(1) "2" ["name"]=> string(5) "ger 2"  } 
["Employee"]=> array(15) { ["id"]=> string(3) "553" ["company_id"]=> string(3) "160" ["first_name"]=> string(4) "pepe" } 
```

php代码

```
$employee = 554;

if (in_array($employee, (array)$existingReturns['MonthlyReturn']['employee_id'])){ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:20:29.683

`$existingReturns['MonthlyReturn']`是数组，`$existingReturns['MonthlyReturn']['employee_id']`而是字符串

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:18:06.870

因为它不是一个数组。为什么你不这样检查，

```
if ($employee == $existingReturns['MonthlyReturn']['employee_id']) 
```

# android - 多活动问题

> ID：15277558
> 
> 赞同：0
> 
> 时间：2013-03-07T17:16:32.293
> 
> 标签：android, android-activity, progress-bar, progress

我有 4 个活动：changeView、changeViewTwo、NoRunning、YesRunning。另外，我有 2 个 XML：yes_running 和 no_running

第一个屏幕（no_running）有一个按钮，可以像这样改变视图：

```
Button buttonchange01 = (Button) findViewById(R.id.Button01);
    buttonchange01.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            startActivity(new     Intent("com.example.runningtimer.changeView"));
        }
    }); 
```

在清单上

```
<activity
        android:name="changeView"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="com.example.runningtimer.changeView" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity> 
```

在 changeView.java 上

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.yes_running);
} 
```

这是正确完成的，但是，当新的出现时，我有一个计数为 10 的进度条，它应该回到 no_running.xml 但它没有，这就是 YesRunning 活动的样子

```
public class YesRunningActivity extends Activity {

ProgressBar myProgressBar;
int myProgress = 0;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.yes_running);
    myProgressBar=(ProgressBar)findViewById(R.id.progressbar_Horizontal);
    new Thread(myThread).start();
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.no_running, menu);
    return true;
}
public Runnable myThread = new Runnable(){

    @Override
    public void run() {
        // TODO Auto-generated method stub
        while (myProgress<100){
            try{
                myHandle.sendMessage(myHandle.obtainMessage());
                Thread.sleep(100);
            }
            catch(Throwable t){ }
        }
        if (myProgress==100){
            finish();
            startActivity(new Intent("com.example.runningtimer.changeViewTwo"));
            myProgress = 0;
        }
    }

    Handler myHandle = new Handler(){

        @Override
        public void handleMessage(Message msg) {
            // TODO Auto-generated method stub
            myProgress++;
            myProgressBar.setProgress(myProgress);
        }
    };
};
} 
```

changeViewTwo 的清单

```
<activity
        android:name="changeViewTwo"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="com.example.runningtimer.changeViewTwo" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity> 
```

更改视图二

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.no_running);
} 
```

知道为什么它不回去了吗？或者我怎样才能让它回去？

# ruby - GitHub Ruby API - 更新拉取请求描述

> ID：15277563
> 
> 赞同：1
> 
> 时间：2013-03-07T17:16:56.380
> 
> 标签：ruby, github, jira, github-api

我正在使用以下 github ruby​​ api：[https](https://github.com/peter-murach/github) ://github.com/peter-murach/github 我正在尝试更新拉取请求的描述，但文档似乎没有给出关于如何做的任何想法这。到目前为止，这是我的代码：

```
def link_github_jira
    github = Github.new basic_auth: 'user:pass'
    @github_jira = github.pull_requests.list '<Name>', '<reposity_name>', state: 'open'
    @github_data = []
    @issues      = []

    @github_jira.each do | x |
      @github_data << x
    end

    @github_data.each do | x | 
      pull_id = x["title"].to_i 
      @pull_request_description = x["body"]
      if pull_id.is_a?(Integer) 
        uri = URI.parse("http://<jira_url>/rest/api/2/issue/#{pull_id}")
        http = Net::HTTP.new(uri.host, uri.port)
        http.use_ssl = true
        http.verify_mode = OpenSSL::SSL::VERIFY_NONE
        request = Net::HTTP::Get.new(uri.request_uri)
        request.basic_auth '<jira_user>', '<jira_pass>'
        request["Content-Type"] = "application/json"
        @jira_response = http.request(request)
        @issues << JSON.parse(@jira_response.body)
        if !@pull_request_description.include?("<jira_url>") 
            #add Jira link to pull description as it does not already exist 
        end
      end 
    end
  end 
```

有没有人对我如何做到这一点有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T12:31:33.507

通过使用此 GitHub Ruby API 解决：[https ://github.com/pengwynn/octokit](https://github.com/pengwynn/octokit)

可以使用以下代码更新拉取请求：

```
client.update_pull_request("<repository>", <pull_id>, <pull_title>, <pull_description>, <pull_state>) 
```

# php - PHP：MySQL插入不起作用

> ID：15277566
> 
> 赞同：0
> 
> 时间：2013-03-07T17:17:00.997
> 
> 标签：php, mysql, insert, pdo

我无法弄清楚为什么我的插入查询不起作用......这是我的代码：

```
<?php
session_start();
try
{
$bdd = new PDO('mysql:host=localhost;dbname=gestion', 'root', '');
}
catch(Exception $e)
{
die('Erreur : '.$e->getMessage());
}

$req = $bdd->prepare('INSERT INTO tasks (title, details, maturity, from, to) VALUES(:title, :details, :maturity, :from, :to)');
$req->execute(array(
                    ':title'=>$_POST['title'],
                    ':details'=>$_POST['details'],
                    ':maturity'=>$_POST['maturity'],
                    ':from'=>$_SESSION['login'],
                    ':to'=>$_POST['to']
                    ));

header('Location: tasks.php');
?> 
```

运行此代码时什么都没有发生。

谢谢您的帮助。

回答 ：

`FROM`并且`TO`都是保留字......所以，我不能这样使用它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:25:00.077

from 和 to 是 mysql 中的保留关键字。

您可以在 mysql 中使用 'from' 和 'to' ......但你必须用这个字符包装它们：`（键盘顶部 1 键的左侧）

所以写 `from` 而不是 from，和 `to` 而不是 to

# linux - 简单替换 init 即可启动控制台

> ID：15277570
> 
> 赞同：6
> 
> 时间：2013-03-07T17:17:14.840
> 
> 标签：linux, ubuntu, init

在一台非常简单的 PC 上，我想用最简单的 bash 脚本替换 Ubuntu 12.04 /sbin/init 以使运行的进程数量最少。显然，没有 X，没有 USB，没有检测到新硬件，没有升级，没有 apt，“什么都没有”，我只需要一个带有基于 DHCP 的 Wi-Fi IP 地址的工作控制台（ssid、密码短语已经存储在 /etc /网络/接口）。就这样。目前，我已经尝试用这个来代替 /sbin/init：

```
#!/bin/sh
mount -o rw,remount /
mount -t proc none /proc
udevd --daemon
mkdir /run/network
ifup -a &
while [ 1 ]; do
    /sbin/getty -8 115200 tty1 vt100
done 
```

它正在工作，因为我正在获取 IP 地址并且我可以登录但是：

*   A）在运行关机时，我得到“关机：无法关闭系统：”
*   B) control-c 在控制台中不起作用
*   C）登录后，我得到：“bash：无法设置终端进程组（-1）：设备的ioctl不合适”
*   D) 登录后，我得到：“bash: no job control in this shell”

另外，我注意到所有用户空间进程都有一个“？” 运行 ps avx 时在 tty 列中。我该如何解决这些问题？我不想使用暴发户来真正控制在 PC 上启动的内容并拥有最低限度的最低要求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:54:44.717

我最终使用了 Busybox init。伟大的小初始化...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:26:18.423

您可以利用`runlevels`并根据您的问题`runlevel 3`是您想要使用的。

如果您有一些您不想启动的服务，您也可以为该运行级别关闭它们。

要启动`runlevel 3`，您只需将 boot 参数附加到引导加载程序中的内核：

```
<EXISTING_BOOT_CMD> 3 
```

如果您的发行版使用`systemd`而不是`sysvinit`，则它们被称为`targets`. `runlevel 3`in的等价物`systemd`通常被命名为`multi-user.target`

在这种情况下，您需要传递的内核引导参数是`systemd.unit=multi-user.target`

```
<EXISTING_BOOT_CMD> systemd.unit=multi-user.target 
```

另一种方法是，如果您不想接触引导加载程序：

```
systemctl enable multi-user.target 
```

# grammar - 模棱两可的语法

> ID：15277572
> 
> 赞同：5
> 
> 时间：2013-03-07T17:17:27.703
> 
> 标签：grammar, context-free-grammar, ambiguous-grammar

我正在查看以下语法，我认为它在第 3 行是模棱两可的，但不确定。

```
<SL> → <S>
<SL> → <SL> <S>
<S> → i <B> <S> e <S>
<S> → i <B> <S> 
<S> → x
<S> → y
<B> → 5
<B> → 13 
```

我发现这个字符串`xi13yi5xeyx`我相信会生成两个不同的解析树，但我不确定我是否做错了。

有人可以验证我的发现吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T19:29:35.883

是的，您的语法是模棱两可的语法！
[你没有提到但我认为`<SL>`开始可行]

使用您的语法规则，我们可以绘制一个以上的解析树（*两个*）进行拧`i5i5yey`紧，如下所示：

```
 <SL>                              <SL>
        |                                 |  
       <S>                               <S>   
     / /|\ \                            / | \ 
    / / | \ \                          /  |  \
   / /  |  \ \                        /   |   \
  / /   |   \ \                      i   <B>   <S>      
 /  |   |   |  \                          |  / /|\ \     
 i <B> <S>  e  <S>                        5 / / | \ \
   /  / | \     |                          / /  |  \ \  
  /  /  |  \    y                         / /   |   \ \
 5  i  <B> <S>                           /  |   |   |  \  
        |   |                           i  <B> <S>  e  <S> 
        5   y                               |   |       |  
                                            5   y       y 
```

两种解析树的结构不同，两种文法都是二**义文法！**

您可以扩展上图以生成树字符串`xi13yi5xeyx`，（*我将其作为练习留给您*）

重要的是该语法生成​​的语言[不是歧义语言](http://en.wikipedia.org/wiki/Ambiguous_grammar#Inherently_ambiguous_languages)。并且可以为该语法编写一个等效的明确语法，该语法总是为语法语言中的每个字符串生成唯一的树。

**提示**：编写明确的语法。

语法与 C 语言中的 for 语法非常相似`if loop`（注意不同的语言具有不同的语法 for `if loop`）。它在几乎所有编译器设计书中都得到了解决。
[**解决一般悬空 Else/If-Else 歧义**](http://www.parsifalsoft.com/ifelse.html)

参考： Aho-Ullman 的***书籍****编译器原理、技术和工具**第 4.5 节**在 Shift 和归约解析期间发生冲突。*

# spring - Spring BatchSqlUpdate vs NamedParameterJdbcTemplate 使用命名参数

> ID：15277584
> 
> 赞同：5
> 
> 时间：2013-03-07T17:18:00.563
> 
> 标签：spring, jdbc, sql-update, batch-processing

我已经`BatchSqlUpdate`成功使用了一段时间。`declareParameter`使用它的唯一麻烦是在使用or`setParameter`方法运行任何查询之前需要注册命名参数。这意味着也必须声明参数的类型。但是，Spring 也提供了一个`NamedParameterJdbcTemplate`类，它有一个非常方便的方法，可以将命名参数作为输入（映射或对象`batchUpdate`的数组） **，而无需先声明它们**。最重要的是，这个类可以很容易地重用，我也相信它是线程安全的。所以我对此有几个问题：`SqlParameterSource`

 ***   执行（多个）批量更新的推荐方法是什么？
*   为什么此功能会在两个行为也不同的不同类中重复？
*   如果不需要，为什么`BatchSqlUpdate`需要声明的参数`NamedParameterJdbcTemplate`？

感谢您的想法！

乔瓦尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T14:55:47.650

经过一番研究，我得出以下结论。

首先，我意识到`NamedParameterJdbcTemplate`该类是唯一接受命名参数进行批量更新的类。该方法`batchUpdate(String sql,Map[] batchValues)`是在 Spring 3 中添加的以实现此目的。

该类`BatchSqlUpdate`包含一个重写的`update(Object... params)`方法，该方法*将给定的语句参数添加到队列中，而不是立即执行它们*，如 javadoc 中所述。`flush()`这意味着只有在调用方法或批处理大小超过最大值时才会执行语句。这个类不支持命名参数，尽管它包含一个`updateByNamedParam()`继承自`SqlUpdate`. 这是不幸的，因为此方法允许为命名参数重用相同的映射，而该`NamedParameterJdbcTemplate.batchUpdate()`方法需要映射数组，如果批量大小是可变的，则具有相关的开销、代码膨胀和重用映射数组的复杂性。

`updateByNamedParam(Map paramMap)`我认为让in的重写版本`BatchSqlUpdate`表现得像`update(Object... params)`但增加了对命名参数的支持会很有用。**

# css - 为什么省略这个“li” CSS 选择器会影响应用的样式？

> ID：15277592
> 
> 赞同：0
> 
> 时间：2013-03-07T17:18:15.697
> 
> 标签：css

代码是这样的，

```
<style type="text/css">
#nav, .nav, #nav .nav li { margin:0px; padding:0px; }
#nav li {float:left; display:inline; cursor:pointer; list-style:none; padding:0px 10px 0px 10px; border:1px #000 solid; 
position:relative;}

li, li a {color:#000; text-decoration:none;}
#nav .nav li { width:100%; text-indent:10px; line-height:30px; margin-right:10px; border-top:1px #000 solid; 
border-bottom:1px #000 solid; border-left:none; border-right:none; background:#fff;}
#nav li a {display:block; width:inherit; height:inherit;}

ul.nav { display:none; }
#nav li:hover > a, #nav li:hover { color:#fff; background:#000; }
#nav li ul.first {left:-1px; top:100%;}
li:hover > .nav { display:block; position:absolute; width:200px; top:-2px; left:50%; z-index:1000; border:1px #000 solid; }
li:hover { position:relative; z-index:2000; }
</style>
</head>

<body>
<ul id="nav">
    <li>Menu 1
        <ul class="nav first">
            <li><a href="#">Menu 1</a></li>
            <li>Menu 2</li>
            <li>Menu 3</li>
            <li>Menu 4</li>
        </ul>
    </li>
    <li>Menu 2</li>
    <li>Menu 3</li>
    <li>Menu 4</li>
</ul>

</body> 
```

在该部分的第三个元素上，如果我`"li, li a"`删除`"li"`选择器只留下`"li a"`这是背景影响，或文本影响，因为我找不到影响我的 2 级列表的因素！

哦，对了，第一级列表项下名为“Menu 1”的第一个菜单是可见的，我认为是因为“li a”选择器，但至于我删除的部分，我没有知道它是如何工作的，有人可以告诉我删除它时是什么导致了这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:29:09.107

您仅将`a`标签应用于“菜单 1”的第一个子项。并且您通过以下代码将文本颜色设置为白色（#FFF）：

```
#nav li:hover > a, #nav li:hover { color:#fff; background:#000; } 
```

这就是为什么文本不可见的原因，因为背景也是白色的。但是当您将鼠标悬停在`li`'s 上时，文本是可见的，因为您通过执行以下操作将背景颜色更改为黑色。

```
li,li a {color:#000; text-decoration:none;} //assigning text color of li as black 
```

如果您`li`从上面的代码中删除，则 li 元素内的文本颜色将保持白色，如您在上面的代码中提到的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:27:36.523

该行`li, li a`表示样式正在应用于所有 LI 和 LI 中包含的所有 A。

你所有的样式都是相对应用的。这意味着应用到的任何内容`li, li a`都会影响每个 LI 以及嵌套在存在的 LI 中的任何 A。无论是父菜单还是子菜单。

由于`.nav`是应用于子菜单的类，因此您可以通过包含`.nav`在选择器中来定位 li。例如：`#nav .nav li a`

要隐藏您的子菜单，您只需：

```
#nav li ul.nav { display: none; } 
```

然后让它出现在悬停上（假设这是你想要的）

```
#nav li:hover ul.nav { display: block; } 
```

我回答了所有问题吗？

# python - Gtk3：从事件框中动态添加和删除按钮：按钮不会接收鼠标按下信号

> ID：15277594
> 
> 赞同：1
> 
> 时间：2013-03-07T17:18:23.850
> 
> 标签：python, gtk, gtk3, pygobject

我在这里为 Gtk 3 使用 python 和 PyGObjects（自省库）。

考虑以下代码：

```
from gi.repository import Gtk

class InternalWidget(Gtk.Button):
    def __init__(self):
        super(InternalWidget, self).__init__()
        self.set_size_request(100,100)
        self.connect("button-press-event", self.on_press)

    def on_press(self, *args):
        print "The Internal Widget was clicked."

class ExternalEventBox(Gtk.EventBox):
    def __init__(self):
        super(ExternalEventBox, self).__init__()
        self.fixed = Gtk.Fixed()
        self.add(self.fixed)
        self.internal_widget = InternalWidget()
        self.set_size_request(200, 200)
        self.connect("button-press-event", self.on_press)
        self.connect("enter-notify-event", self.on_enter)
        self.connect("leave-notify-event", self.on_leave)

    def on_enter(self, *args):
        self.fixed.put(self.internal_widget, 50,50)
        self.show_all()

    def on_leave(self, *args):
        self.fixed.remove(self.internal_widget)

    def on_press(self,*args):
        print "The External Event Box was clicked."

w = Gtk.Window(Gtk.WindowType.TOPLEVEL)
w.connect("delete-event", Gtk.main_quit)
w.add(ExternalEventBox())
w.show_all()
Gtk.main() 
```

上面，每当鼠标进入 时，都会将`ExternalEventBox`一个按钮 ( `InternalWidget`) 作为子项添加到其中。当鼠标离开 时`ExternalEventBox`，按钮将作为 的子项移除`ExternalEventBox`。

现在，如果你运行代码（你可以），按钮会正确出现和消失。但是，与预期相反，单击按钮只会向包含 发送信号`ExternalEventBox`，而按钮则不会收到信号。

有趣的是，预期的行为（点击按钮实际上点击它）发生在按钮，而不是动态添加和删除，在事件框的构造函数中添加一次，并且从未删除。

这是一个错误，还是我只是错过了什么？

编辑：简而言之，我只得到“外部事件框被点击。”，但从来没有“内部小部件被点击。”。

**更新**：我提交了一个[错误报告](https://bugzilla.gnome.org/show_bug.cgi?id=695618)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T18:20:25.313

您需要使用 .set_above_child(false) 将 EventBox 事件窗口设置为低于其子级

这是它的文档：[GtkEventBox](https://developer.gnome.org/gtk3/stable/GtkEventBox.html#gtk-event-box-set-above-child)

> 如果窗口在上面，则事件框内的所有事件都将转到事件框。如果窗口在下方，则子窗口小部件窗口中的事件将首先到达该窗口小部件，然后到达其父窗口。

# dynamics-crm-2011 - 将 EntityReference 转换为 Entity

> ID：15277597
> 
> 赞同：13
> 
> 时间：2013-03-07T17:18:31.670
> 
> 标签：dynamics-crm-2011, dynamics-crm, dynamic-programming

有谁知道如何将 EntityReference 转换为实体。

```
protected override void Execute(CodeActivityContext executionContext)
{
    [Input("Email")]
    [ReferenceTarget("email")]
    public InArgument<Entity> EMail { get; set; }

    Entity MyEmail = EMail.Get<Entity>(executionContext); 
```

这给了我一个错误。不能转换这个。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-07T18:45:42.270

对您的问题的最短回答是在数据库中查询实体引用指出（引用）的实体。我一直将实体引用视为（粗略）等同于 C++ 中的指针。它有它的地址（guid），但你需要取消引用它才能找到蜂蜜。你这样做是这样的。

```
IOrganizationService organization = ...;
EntityReference reference = ...;

Entity entity = organization.Retrieve(reference.LogicalName, reference.Id, 
  new ColumnSet("field_1", "field_2", ..., "field_z")); 
```

当我进行大量从*EntityReference*到*Entity*的转换时，我部署了带有可选参数的扩展方法。

```
public static Entity ActualEntity(this EntityReference reference,
  IOrganizationService organization, String[] fields = null)
{
  if (fields == null)
    return organization.Retrieve(reference.LogicalName, reference.Id, 
      new ColumnSet(true));
  return organization.Retrieve(reference.LogicalName, reference.Id, 
    new ColumnSet(fields));
} 
```

You can read more and compare [EntityReference](http://msdn.microsoft.com/en-us/library/gg327579.aspx) and [Entity](http://msdn.microsoft.com/en-us/library/microsoft.xrm.sdk.entity.aspx).

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-07T17:50:21.487

An`EntityReference`只是实体的逻辑名称、名称和 ID。因此，要获得`Entity`，您只需要使用 的属性创建实体`EntityReference`。

这是为您执行此操作的扩展方法：

```
public static Entity GetEntity(this EntityReference e)
{
    return new Entity(e.LogicalName) { Id = e.Id };
} 
```

不要忘记不会填充实体的任何其他属性。如果你想要你需要查询的属性：

```
public static Entity GetEntity(this IOrganizationService service, EntityReference e)
{
    return service.Retrieve(e.LogicalName, e.Id, new ColumnSet(true));
} 
```

如果您喜欢@Konrad 的现场回答，请将其设为 params 数组，这样调用会更好

```
public static Entity GetEntity(this IOrganizationService service, EntityReference e, 
   params String[] fields)
{
    return service.Retrieve(e.LogicalName, e.Id, new ColumnSet(fields));
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-07T17:51:40.927

Entity 和 EntityReference 是不同的。[EntityReference](http://msdn.microsoft.com/en-us/library/microsoft.xrm.sdk.entityreference_members.aspx)是对包含 GUID 和实体逻辑名称的记录的引用。您必须通过 guid 和逻辑名称来访问实体。像这样的东西：

```
service.Retrieve(logicalname, guid, new ColumnSet(columns)); 
```

# javascript - Connection.Start().Done() SignalR 问题

> ID：15277598
> 
> 赞同：3
> 
> 时间：2013-03-07T17:18:36.080
> 
> 标签：javascript, tinymce, signalr

我正在使用 SignalR 连接设计一个类似于谷歌文档的实时文档编辑器 Web 应用程序。

它工作正常，即当我在浏览器的一个编辑器中编写时，文本显示在我拥有的其他打开的浏览器上。我唯一的问题是，起初我写一些文本时没有显示，然后我删除并再次写入，一切正常。

当我在 Chrome 中使用 F12 进行调试时，出现此错误：

```
Uncaught Error: SignalR: Connection has not been fully initialized. Use .start().done() or        .start().fail() to run logic after the connection has started. 
```

我不明白这一点，因为在我的代码中我实际上使用的是 $.connection.hub.start.done()。这是我正在使用的集线器：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using Microsoft.AspNet.SignalR;
using Microsoft.AspNet.SignalR.Hubs;

namespace Write.ly
{
    [HubName("editor")]
    public class EditorHub : Hub
    {
        public void Send(string message)
        {
            Clients.Others.broadcastMessage(message);
        }
    }
} 
```

这是与此相关的 JavaScript 和 html。请注意，我使用 tinyMCE 作为编辑器的插件。

```
@{
    ViewBag.Title = "- Editor";
    ViewBag.ContentStyle = "/Content/CSS/editor.css";
}

<script src="~/Scripts/jquery.signalR-1.0.1.min.js"></script>
<script src="~/signalr/hubs"></script>
<script src="~/Content/TinyMCE/tiny_mce.js"></script>
<script type="text/javascript">
    $(function () {
        var hub = $.connection.editor;

        tinyMCE.init({
            mode: "textareas",
            theme: "advanced",
            plugins: "emotions,spellchecker,advhr,insertdatetime,preview",

            // Theme options - button# indicated the row# only
            theme_advanced_buttons1: "newdocument,|,bold,italic,underline,|,justifyleft,justifycenter,justifyright,fontselect,fontsizeselect,formatselect",
            theme_advanced_buttons2: "cut,copy,paste,|,bullist,numlist,|,outdent,indent,|,undo,redo,|,link,unlink,anchor,image,|,code,preview,|,forecolor,backcolor",
            theme_advanced_buttons3: "insertdate,inserttime,|,spellchecker,advhr,,removeformat,|,sub,sup,|,charmap,emotions",
            theme_advanced_toolbar_location: "top",
            theme_advanced_toolbar_align: "left",
            theme_advanced_statusbar_location: "bottom",
            theme_advanced_resizing: false,

            setup: function (ed) {
                ed.onKeyUp.add(function (ed, e) {
                    hub.client.broadcastMessage = function (message) {
                        var bookmark = ed.selection.getBookmark(2, true);
                        tinyMCE.activeEditor.setContent(message);
                        ed.selection.moveToBookmark(bookmark);
                    };

                    $.connection.hub.start().done(function () {
                        var text = tinyMCE.activeEditor.getContent();
                        hub.server.send(text);
                    });
                });
            }
        });
    });
</script>

<form method="post" action="somepage">
        <textarea id="editor" name="content" cols="100" rows="30"></textarea>
</form>

<button class="btn" onclick="ajaxSave();"><span>Save</span></button> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T19:01:15.657

您应该只启动一次 SignalR 连接，而不是每次按键。您还应该在开始连接之前创建客户端集线器方法：

```
<script type="text/javascript">
    $(function () {
        var hub = $.connection.editor;

        tinyMCE.init({
            mode: "textareas",
            theme: "advanced",
            plugins: "emotions,spellchecker,advhr,insertdatetime,preview",

            // Theme options - button# indicated the row# only
            theme_advanced_buttons1: "newdocument,|,bold,italic,underline,|,justifyleft,justifycenter,justifyright,fontselect,fontsizeselect,formatselect",
            theme_advanced_buttons2: "cut,copy,paste,|,bullist,numlist,|,outdent,indent,|,undo,redo,|,link,unlink,anchor,image,|,code,preview,|,forecolor,backcolor",
            theme_advanced_buttons3: "insertdate,inserttime,|,spellchecker,advhr,,removeformat,|,sub,sup,|,charmap,emotions",
            theme_advanced_toolbar_location: "top",
            theme_advanced_toolbar_align: "left",
            theme_advanced_statusbar_location: "bottom",
            theme_advanced_resizing: false,

            setup: function (ed) {
                hub.client.broadcastMessage = function (message) {
                    var bookmark = ed.selection.getBookmark(2, true);
                    tinyMCE.activeEditor.setContent(message);
                    ed.selection.moveToBookmark(bookmark);
                };

                $.connection.hub.start().done(function () {
                    ed.onKeyUp.add(function (ed, e) {
                        var text = tinyMCE.activeEditor.getContent();
                        hub.server.send(text);
                    });
                });
            }
        });
    });
</script> 
```

# css - 顶部的应用程序脚本 html 服务空白

> ID：15277599
> 
> 赞同：1
> 
> 时间：2013-03-07T17:18:38.500
> 
> 标签：css, google-apps-script

我有一个显示 html 文件的简单脚本

```
function doGet(e) {
     return HtmlService.createTemplateFromFile('Final Contract Agreement').evaluate();
} 
```

和相应的html：

```
 <html>
   <head>
     <style type="text/css">
     #content{
          padding :0 0;
          margin : 0 auto;
          width: 800px;
          height : 600px;
          background: #FFFFFF;
     }
     body{
         background: #dbdad4;
         margin : 0;
     }
     #header{
         width: 100%;
         height: 82px;
         background: #4F2170;
         background-repeat:no-repeat;
     }
     #header h1{
         vertical-align:middle;
         text-align:right;
         color: white;
         padding-right: 50px;
     }
     </style>
 </head>
 <body>
    <div id="header">
      <h1>
         Contract Form
      </h1>
     </div>
    <div id="content">
       <h3>
        Hello World! 
        <?= new Date() ?>
      </h3>
    </div>
  </body>
 </html> 
```

它输出：

![空白](../Images/fa722ac6a391c57e3d54a938a4044870.png)

我已经尝试在元素上设置所有边距/填充的组合，但没有什么能摆脱顶部的空白。当我将相同的代码放在飞机简 html 文件中时，它工作得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:54:00.683

我猜 caja 正在将空格添加到顶部，这个 css 为我删除了空格：

```
 * {
    margin: 0;
  } 
```

对于那些想知道这就是我如何让它占据整个浏览器窗口的人：

```
 html {
    height:100%;
  }
  body{
    height:100%;
  } 
```

# search - 使用电子表格中的数据进行 Applescript 文件搜索

> ID：15277601
> 
> 赞同：0
> 
> 时间：2013-03-07T17:18:44.787
> 
> 标签：search, csv, applescript, filenames

我目前正在使用这个 Applescript，我发现它搜索文件名并在文本文档中返回文件路径。这适用于查找 1 或 2 个文件，但我想查找分布在数百个文件夹中的 500 个文件。我理想的脚本将使用来自 excel 电子表格或 csv 的数据，执行搜索，找到文件并将其复制到我桌面上的指定文件夹中。任何帮助表示赞赏。

这是我找到的脚本：

```
tell application "System Events"
    activate
    set thePattern to text returned of (display dialog "Search for" default answer "")
    end tell
    if thePattern = "" then return
   try
    set foundFiles to do shell script "mdfind -name " & quoted form of thePattern & " |         /usr/bin/egrep -i " & quoted form of thePattern & "[^/]*/?$ | /usr/bin/grep -vi " & quoted     form of thePattern & ".*" & quoted form of thePattern
on error
    set foundFiles to "Nothing Returned"
end try
if foundFiles = "" then set foundFiles to "Nothing Returned"

tell application "TextEdit"    
activate
delay 0.5
try
    set theDoc to document 1
    get text of theDoc
    if result is not "" then
        make new document
        set theDoc to result
    end if
on error
    make new document
    set theDoc to result
end try
set text of theDoc to foundFiles
end tell 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T23:41:03.983

您需要从文本文件中读取数据，然后将其转换为返回或换行分隔的列表，并对列表中的项目进行重复。然后将每个项目（实际上是一行）转换为例如制表符分隔的列表，并再次对该列表的项目执行（嵌套）重复循环。如果您知道例如第 3 项是文件路径，您可以将变量设置为行的第 3 项作为文本，并在您的 shell 脚本中使用此变量。

我认为您需要通过发布自己的实现尝试来表明您理解重复循环的概念。如果你这样做了，我很乐意回来帮助你进行下一步。

亲切的问候，

标记

# elasticsearch - 方面的多个属性（弹性搜索）

> ID：15277603
> 
> 赞同：2
> 
> 时间：2013-03-07T17:18:50.013
> 
> 标签：elasticsearch, faceted-search

我有以下索引：

```
curl -XPUT "http://localhost:9200/test/" -d '
{
    "mappings": {
        "files": {
            "properties": {
                "name": {
                    "type": "string",
                    "index": "not_analyzed"
                },
                "owners": {
                    "type": "nested",
                    "properties": {
                        "name": {
                            "type":"string",
                            "index":"not_analyzed"
                        },
                        "mail": {
                            "type":"string",
                            "index":"not_analyzed"
                        }
                    }
                }
            }
        }
    }
}
' 
```

带样本文件：

```
curl -XPUT "http://localhost:9200/test/files/1" -d '
{
    "name": "first.jpg",
    "owners": [
        {
            "name": "John Smith",
            "mail": "js@example.com"
        },
        {
            "name": "Joe Smith",
            "mail": "joes@example.com"
        }
    ]
}
'

curl -XPUT "http://localhost:9200/test/files/2" -d '
{
    "name": "second.jpg",
    "owners": [
        {
            "name": "John Smith",
            "mail": "js@example.com"
        },
        {
            "name": "Ann Smith",
            "mail": "as@example.com"
        }
    ]
}
'

curl -XPUT "http://localhost:9200/test/files/3" -d '
{
    "name": "third.jpg",
    "owners": [
        {
            "name": "Kate Foo",
            "mail": "kf@example.com"
        }
    ]
}
' 
```

我需要找到匹配某个查询的所有所有者，比如说“mit”：

```
curl -XGET "http://localhost:9200/test/files/_search" -d '
{
    "facets": {
        "owners": {
            "terms": {
                "field": "owners.name"
            },
            "facet_filter": {
                "query": {
                    "query_string": {
                        "query": "*mit*",
                        "default_field": "owners.name"
                    }
                }
            },
            "nested": "owners"
        }
    }
}
' 
```

这给了我以下结果：

```
{
  "facets" : {
    "owners" : {
      "missing" : 0,
      "_type" : "terms",
      "other" : 0,
      "total" : 4,
      "terms" : [
        {
          "count" : 2,
          "term" : "John Smith"
        },
        {
          "count" : 1,
          "term" : "Joe Smith"
        },
        {
          "count" : 1,
          "term" : "Ann Smith"
        }
      ]
    }
  },
  "timed_out" : false,
  "hits" : {...}
} 
```

没关系。但我确切需要的是让所有者获得他们的电子邮件地址（对于构面中的每个条目，我需要在结果中添加额外的字段）。它可以实现吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T07:28:18.783

我认为不可能？根据您的需要，我会

1.  创建一个包含名称和电子邮件的复合字段，并在该字段上执行构面，或者
2.  运行除了方面之外的查询并从查询结果中提取它，但这显然是不可扩展的
3.  两步操作，获取方面，构建所需的查询并合并结果。

# c++ - 对象的 C++ 向量和对析构函数的过度调用？

> ID：15277606
> 
> 赞同：0
> 
> 时间：2013-03-07T17:18:54.863
> 
> 标签：c++, vector, destructor

我想知道的是代码是否多次调用析构函数，以及以这种方式编码是否正确。似乎创建的对象在加载到向量中之前超出了范围，但对象并没有死亡，而是留在向量中，并在程序完成后再次破坏。这是输出：

```
object::constructor:
before push_back
object::destructor:
object::constructor:
before push_back
object::destructor:
object::destructor:
object::call(): begin
0
object::call(): end
object::call(): begin
1
object::call(): end
object::destructor:
object::destructor:

Process returned 0 (0x0)   execution time : 0.313 s
Press any key to continue. 
```

这是main.cpp

```
#include <vector>
#include <iostream>
#include "object.h"

int main()
{
    int max = 2;
    std::vector <object> OBJECTS;

    for(int index = 0; index < max; index++)
    {
            object OBJECT(index);
            std::cout<<"before push_back"<<std::endl;
            OBJECTS.push_back(OBJECT);
    }

    for(int index = 0; index < max; index++)
        OBJECTS[index].call();

    return 0;
} 
```

这是object.h

```
#ifndef OBJECT_H
#define OBJECT_H

#include <iostream>

class object
{
        private:

            int value;

        public:

        object(){}
        object(int value)
        {
            std::cout<<"object::constructor: "<<std::endl;
            this->value = value;
        }
        ~object()
        {
            std::cout<<"object::destructor: "<<std::endl;
        }
        void call()
        {
            std::cout<<"object::call(): begin"<<std::endl;
            std::cout<<value<<std::endl;
            std::cout<<"object::call(): end"<<std::endl;
        }
};
#endif 
```

这是来自下面答案 Chowlett 的代码，以防万一网站崩溃。

```
#include <iostream>
#include <vector>

class object
{
        private:

            int value;

        public:

        object(){}
        object(int value)
        {
            std::cout<<"object::constructor: "<< value << std::endl;
            this->value = value;
        }
        object( const object& o )
        {
           std::cout<<"object::copy-constructor: " << o.value << std::endl;
           this->value = o.value + 10;
        }
        ~object()
        {
            std::cout<<"object::destructor: "<< value << std::endl;
        }
        void call()
        {
            std::cout<<"object::call(): begin"<<std::endl;
            std::cout<<value<<std::endl;
            std::cout<<"object::call(): end"<<std::endl;
        }
};

int main()
{
    int max = 3;
    std::vector <object> OBJECTS;

    for(int index = 0; index < max; index++)
    {
            object OBJECT(index);

            std::cout<<"before push_back: capacity="<< OBJECTS.capacity() << std::endl;            
            OBJECTS.push_back(OBJECT);
            std::cout<<"after push_back: capacity="<< OBJECTS.capacity() << std::endl;
    }

    for(int index = 0; index < max; index++)
        OBJECTS[index].call();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:21:14.827

编译器为您生成了一个 copy-ctor。添加一个带有一些调试输出的代码，您就可以了解您的代码在做什么：

```
object( const object& o )
{
   std::cout<<"object::copy-constructor: "<<std::endl;
   this->value = o.value;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T09:06:36.847

正在发生的事情是`vector`重新分配以腾出空间。

`OBJECTS`从`capacity`等于零开始。循环构造`OBJECT = object(0)`，然后复制构造该对象的副本以传递给`push_back`。`push _back`注意没有足够的空间（1 > 0！），所以它重新分配`vector`容量为 1 并将副本放入。然后它 destructs `OBJECT`。

下一次通过循环，`OBJECT = object(1)`被构造，然后复制构造 for `push_back`。再次没有足够的空间，因此`OBJECTS`被重新分配以具有更大的容量 -**并且已经在其中的 object(0) 被复制构造到重新分配的空间中，并且原来的 destructed**。然后将复制的对象放入，然后`OBJECT`再次销毁。

[您的代码的这种](http://ideone.com/KnbYP8)变化应该清楚地说明发生了什么。我已经让代码`vector`在每个之前和之后写了容量`push_back`；我添加了一个日志复制构造器。我还让复制构造器在`value`每次被调用时加 10，这样你就可以看到每个人`object`是如何被复制的。

# android - 从不同的线程Android更新视图

> ID：15277608
> 
> 赞同：1
> 
> 时间：2013-03-07T17:18:59.547
> 
> 标签：android, multithreading, sms

我制作了一个简单的 Android 应用程序，它会在收到 SMS 时更新其视图。这是我的接收器类的代码

```
public class SMSReceiver extends BroadcastReceiver {

@Override
public void onReceive(Context context, Intent intent) {
    // TODO Auto-generated method stub
    intent.setClass(context, SMSReceiverService.class);
    intent.putExtra("result", getResultCode());
    WakefulIntentService.sendWakefulWork(context.getApplicationContext(), intent);
} 
```

}

该类将调用 SMSReceiverService 类来处理即将到来的 SMS 并执行方法 notifyMessageReceived，如下所示。

```
private void notifyMessageRecevied(SMS message) {
    if(!isInMyApps()) {
                launchPopUp();
    }
    else {
        //updating view should go here
    }
} 
```

问题是，我不知道如何更新我的活动中的视图（它在单独的类中，而不是 SMSReceiverService 类中），当我尝试在我的活动中更新我的 TextView 时，它抛出了一个 CalledFromWrongThreadException。有人可以帮我吗？

在此先感谢，并为我的英语不好感到抱歉...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:26:30.873

您可以创建一个活动变量来保存所需活动的实例。

在`SMSReceiver`（您要调用的那个）：

```
SMSReceiverService.setMainActivity(this); 
```

在`SMSReceiverService`（您要更新的那个）：

```
public static SMSReceiver smsActivity;
public static void setMainActivity(SMSReceiver activity) 
{
    smsActivity = activity;      
}

...

smsActivity.runOnUiThread(new Runnable() {
     public void run() {    
             try{
                    smsActivity.textView.setText("");
             }
             catch{}
     }
} 
```

假设`SMSActivity`是包含要更新的视图的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:38:08.310

假设服务具有用户活动的上下文

```
Activity a=(Activity)userContext;
a.runOnUiThread(/*runnable method of activity which calls UpdateView() */); 
```

# java - 用于 iperf 应用程序的实时图形 android

> ID：15277611
> 
> 赞同：0
> 
> 时间：2013-03-07T17:19:05.367
> 
> 标签：java, android, html5-canvas, achartengine

嗨，我已经为 android 开发了 IPerf 应用程序，它可以在手机屏幕上提供吞吐量和时间。但我想要屏幕上的吞吐量与时间图。我是安卓新手。所以请告诉我该怎么做。？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T06:53:37.827

看看我的[答案在这里](https://stackoverflow.com/a/15893444/1752560)它可能对你有帮助::

您可以根据您的要求更改`getnext()`方法，可能如下：

```
public String getnext(int a)
{
    final Calendar c = Calendar.getInstance();
    int mMinute = c.get(Calendar.MINUTE);
    int mHour = c.get(Calendar.HOUR_OF_DAY);
    int am =c.get(Calendar.AM_PM); 
    String ap;
    if(am==1)
    {ap="PM";}
    else {ap="AM";}
    String s = mHour+""+ap; // or String s = mHour+""+mMinute;
    return (s);
} 
```

# php - 代码点火器管理文件夹在本地主机 wamp 服务器中不起作用

> ID：15277612
> 
> 赞同：-1
> 
> 时间：2013-03-07T17:19:05.933
> 
> 标签：php, codeigniter

服务器中的代码点火器管理模块创建问题`wamp`。

这个在本地文件和服务器路径 localhost/site/ 中为我工作

但是管理文件夹在`wamp`服务器中不起作用，服务器上传的文件正在工作并且正在获取管理文件夹。本地主机/站点/管理员/

这是出于测试目的从服务器下载的，为什么它在 localhost 管理文件夹中不起作用。请指导我，如何摆脱这个问题。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-08T02:02:20.060

模式 revrite 的 wampp 问题对于那些认为 wampp 是一个 creaton 的人来说，使用 apache 可以帮助你使这个词变得更好坏消息

如果您检查 google wampp mod_rewrite 不工作 大约 254,000 个结果，并且如果 url 在普通服务器上而不是在本地主机上工作，则它与 codeigniter 有很大关系，它与 winshit 和 xampp 有很大关系。

youse it widout mode rewrite and .htaccess

```
url/index.php/someign 
```

# c# - 布尔不更新

> ID：15277617
> 
> 赞同：2
> 
> 时间：2013-03-07T17:19:11.013
> 
> 标签：c#, xna

我有一个 bool 调用`attack`，每当`Q`按下按钮时我将其设置为 true （`Q`是攻击）

我已经使用断点来尝试自己解决问题。设置为 true 的代码行`attack`正在运行，但实际上并没有设置`attack`为 true ...我是 XNA 的新手，如果这是一个明显的解决方案，我很抱歉。这是代码..：（ps我遗漏了很多与问题无关的代码）

```
public class Player
{

    Animation playerAnimation = new Animation();

public void Update(GameTime gameTime)
    {
        keyState = Keyboard.GetState()

        if (keyState.IsKeyDown(Keys.Q))
        {
            tempCurrentFrame.Y = 0;
           *** playerAnimation.Attack = true; *** This line of code runs yet doesn't actually work
        }

public class Animation
{

    bool  attack;

public bool Attack
    {
        get { return attack; }
        set { value = attack; }
    }

public void Update(GameTime gameTime)
    {

        if (active)
            frameCounter += (int)gameTime.ElapsedGameTime.TotalMilliseconds;
        else
            frameCounter = 0;
        if (attack) ***This never turns true***
            switchFrame = 50; 
```

就像我之前说的，我使用断点进行检查，并且所有代码都运行了，只是我的攻击变量没有发生任何事情，我不确定为什么不发生。

我有一个类似的 bool，称为 active，具有所有相同的属性和链接的代码，但该 bool 确实得到了更新，这就是我如此卡住的原因。

感谢您的时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T17:20:53.433

访问器中的逻辑`set`是向后的。您需要将字段分配给`attack`设置器的值，而不是相反

```
set { attack = value; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:21:04.717

问题是

```
set { value = attack; } 
```

您将 设置`value`为字段，而不是将字段设置为值。将其更改为

```
set { attack = value; } 
```

阅读[文档](http://msdn.microsoft.com/en-us/library/aa691315%28v=vs.71%29.aspx)以获取更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T17:21:09.873

你的`set`方法是落后的。试试这个。

```
set { attack = value }; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-07T17:25:34.743

正如其他人所说，你`set`是倒退的。它应该是

```
set {attack = value;} 
```

但是，我还想建议使用自动属性。这很容易解决这个问题。不过，知道分配的正确顺序仍然很重要

```
public bool Attack {get;set;} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-07T17:43:13.073

由于您的属性 Getter 和 Setter 是微不足道的，我建议将其实现为 Auto Property 之类

```
 public bool Attack{ get; set; } 
```

Doing so, it will reduce your code size and yet yield the desired result.Also, the bug will have never been introduced at first place.

# asp.net - 带有 HtmlEditorExtender 的 AsyncFileUpload 引发验证错误

> ID：15277620
> 
> 赞同：1
> 
> 时间：2013-03-07T17:19:20.077
> 
> 标签：asp.net, ajaxcontroltoolkit, asyncfileupload, htmleditorextender

当我在页面上有一个 HTMLEditorExtender（输入了 HTML）并尝试使用 AJAX AsyncFileUpload 控件上传文件时，*有时会*收到验证错误：

![在此处输入图像描述](../Images/db8fd640ce8c64a78831f78ff99f577d.png)

我想我已经把它缩小了——它只在上传是*在回*发之后抛出这个错误——在文本框中输入了 html。

这是一个例子：

```
<asp:ScriptManager ID="ScriptManager1" runat="server">
</asp:ScriptManager>
<asp:Button ID="Button1" runat="server" Text="PostBack" />
<asp:TextBox ID="txtBannerHTML" runat="server" Height="130px" Width="100%" TextMode="MultiLine" />
<asp:HtmlEditorExtender ID="txtBannerHTML_HtmlEditorExtender" runat="server" DisplaySourceTab="True"
    Enabled="True" TargetControlID="txtBannerHTML">
</asp:HtmlEditorExtender>
<asp:AsyncFileUpload ID="AsyncFileUpload3" runat="server" /> 
```

重现：

1.  在文本框中输入 html。

2.  点击回发按钮。

3.  尝试上传图片。

我确实在 HTMLEditorExtender 上启用了消毒剂。

任何人都可以复制这个吗？

如何让两个控件一起工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T10:03:56.467

尝试在客户端处理 AjaxFileUpload 控件的 uploadStarted 事件并强制对 HtmlEditorExtender 扩展器的 html 进行编码：

```
<script type="text/javascript" >
function uploadStarted(sender, args){
    var editor = $find("<%= txtBannerHTML_HtmlEditorExtender.ClientID %>");
    editor._editableDiv_submit();
}
</script>

<asp:ScriptManager ID="ScriptManager1" runat="server">
</asp:ScriptManager>
<asp:Button ID="Button1" runat="server" Text="PostBack" />
<asp:TextBox ID="txtBannerHTML" runat="server" Height="130px" Width="100%" TextMode="MultiLine" />
<asp:HtmlEditorExtender ID="txtBannerHTML_HtmlEditorExtender" runat="server" DisplaySourceTab="True"
    Enabled="True" TargetControlID="txtBannerHTML">
</asp:HtmlEditorExtender>
<asp:AsyncFileUpload ID="AsyncFileUpload3" runat="server" OnClientUploadStarted="uploadStarted" /> 
```

# php - php - 将对象转换为数组

> ID：15277621
> 
> 赞同：1
> 
> 时间：2013-03-07T17:19:21.447
> 
> 标签：php, arrays, object

我有一个数组。这是该`var_dump`数组的。

```
array (size=2)
  0 => 
    object(stdClass)[266]
      public 'term_id' => string '4' (length=1)
      public 'name' => string 'Test' (length=4)
      public 'slug' => string 'test' (length=4)
      public 'term_group' => string '0' (length=1)
      public 'term_taxonomy_id' => string '4' (length=1)
      public 'taxonomy' => string 'filter' (length=6)
      public 'description' => string '' (length=0)
      public 'parent' => string '0' (length=1)
      public 'count' => string '0' (length=1)
  1 => 
    object(stdClass)[277]
      public 'term_id' => string '5' (length=1)
      public 'name' => string 'test2' (length=5)
      public 'slug' => string 'test2' (length=5)
      public 'term_group' => string '0' (length=1)
      public 'term_taxonomy_id' => string '5' (length=1)
      public 'taxonomy' => string 'filter' (length=6)
      public 'description' => string '' (length=0)
      public 'parent' => string '0' (length=1)
      public 'count' => string '0' (length=1) 
```

现在我想像这样转换该数组。

```
$choices = array(
  array('label' => 'Test','value' => 'test'),
  array('label' => 'test2','value' => 'test2'),
) 
```

请注意：我在`choices`数组中映射了这样的键

```
 name key as label
  slug key as value 
```

有人可以告诉我如何实现这一目标吗？

## 更新：

这是我到目前为止所尝试的。

```
foreach ( $filters as $filter ) { 
$filterarr[] = "array('label' => '". $filter->name ."' ,'value' => '". $filter->slug ."' )"; 
} 
$choices = array($filterarr); 
```

但它没有按预期工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:30:52.590

试试看

```
$choices = array();    
$tempArray = array();

for($i=0; $i < count(YOUR_ARRAY); $i++)
{
    $tempArray["label"] = array[$i]->name;
    $tempArray["value"] = array[$i]->slug;

    array_push($choices, $tempArray);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:31:09.200

只需对您的对象进行类型转换。并执行您想要的操作，如下所示。

```
$posts = (array) $yourObject;
$choices = array();
foreach($posts as $post){
   $choices[]['label'] = $post['name'];
   $choices[]['value'] = $post['slug'];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:30:45.643

你可以写这样的东西，但下次尝试自己找到它很简单。

```
foreach($your_array as $a)
{
    $choices[] = array('label' => $a['label'],
                       'value' => $a['slug']);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T17:32:29.720

尝试;

```
foreach($array as $object){
   $choices[] = array("label" => $object->name, "value" => $object->slug);
} 
```

# gcc - __libc_csu_fini 和 __libc_csu_init 未定义，同时遵循 build-webos 的说明

> ID：15277622
> 
> 赞同：4
> 
> 时间：2013-03-07T17:19:21.693
> 
> 标签：gcc, linker-errors, glibc, webos, openembedded

我正在尝试构建 OpenWebOS，并按照[build-webos](https://github.com/openwebos/build-webos) GitHub README 中的计划进行操作。我正在使用全新的 32 位 Ubuntu 12.10 安装。事情有些坎坷。

但是，通过在这里和那里进行调整，我设法在错误出现之前达到了 2500 或（或其他）的第 350 步。问题是构建 glibc 的依赖，它在抱怨

```
(...)/sysdeps/i386/start.S:107: undefined reference to `__libc_csu_fini'
(...)/sysdeps/i386/start.S:108: undefined reference to `__libc_csu_init' 
```

搜索网络会发现人们在不构建 glibc 本身时发生这种情况的各种案例：

[ld 抱怨：在函数“_start”中，未定义对“__libc_csu_fini”和“__libc_csu_init”的引用](https://stackoverflow.com/questions/10280631/ld-complains-in-function-start-undefined-reference-to-libc-csu-fini)

[使用 ld 直接链接 C 程序失败，未定义对 `__libc_csu_fini` 的引用](https://stackoverflow.com/questions/6656317/cant-link-a-c-program)

但这是在自定义*嵌入式 LIBC 的构建过程中： eglibc*。所以有点不同，我能找到的最接近的案例是[OpenEmbedded list 上的这个 2009 线程](http://comments.gmane.org/gmane.comp.handhelds.openembedded/26911)。我不确定如何在 WebOS 构建结构的令人困惑的“bakefile”世界中将他们的补丁付诸实践，这令人眼花缭乱。

失败的命令行怪物我将“简化”为以下内容：

> gcc -m32 -march=i586 --sysroot=/home/webos/build-webos/BUILD-qemux86/sysroots/qemux86-tcbootstrap -nostdlib -nostartfiles -o iconv/iconvconfig -Wl,-dynamic-linker=/lib/ld -linux.so.2 -Wl,-z,combreloc -Wl,-z,relro -Wl,--hash-style=both csu/crt1.o csu/crti.o `gcc -m32 -march=i586 -- sysroot=/home/hostilefork/Projects/webos/build-webos/BUILD-qemux86/sysroots/qemux86-tcbootstrap --print-file-name=crtbegin.o` iconv/iconvconfig.o iconv/strtab.o iconv/xmalloc。 o iconv/hash-string.o -Wl,-rpath-link=/home/webos/build-webos/BUILD-qemux86/work/i586-webos-linux/eglibc-2.16-r15+svnr20393/build-i586-webos -linux:math:elf:dlfcn:nss:nis:rt:resolv:crypt:nptl libc.so.6 libc_nonshared.a -Wl,--根据需要 elf/ld.so -Wl,--no-as-needed -lgcc `gcc -m32 -march=i586 --sysroot=/home/webos/build-webos/BUILD-qemux86/sysroots/qemux86-tcbootstrap --print-file-name=crtend.o ` csu/crtn.o

我在目录中有一个**libc.a**和一个**libc_nonshared.a**文件。没有提到`__libc_csu_init`或`__libc_csu_fini`在非共享版本中，但它们在普通的 libc.a 中。这似乎与人们看起来应该是真的相反，尽管......当我查看`/usr/lib/i386-linux-gnu`Ubuntu 附带的内容时，共享和非共享版本都提到了它。嗯。

如果有人读到这篇文章并说“嘿，我打赌我知道发生了什么事！” 那会很漂亮。:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:24:49.523

不幸的是，WebOS build-desktop 仅支持 Ubuntu lts 12.04。

安装 Ubuntu 12.04 并按照[https://github.com/openwebos/build-webos上的说明进行操作](https://github.com/openwebos/build-webos)

# java - scalding 如何将用户函数传递给远程 MapReduce 节点

> ID：15277625
> 
> 赞同：2
> 
> 时间：2013-03-07T17:19:34.973
> 
> 标签：java, scala, scalding

使用 Scalding 时，您可以提供一个函数。我想知道 scalding 如何将这些功能传递给远程 map/reduce 任务？这是使用scala中的东西还是可以用匿名对象完成的通用东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T21:10:15.793

这是由 Cascading 完成的普通 Java 序列化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:52:02.637

It uses [Cascading](http://www.cascading.org/), a java library upon Apache Hadoop.

# c++ - 为什么 sizeof C++ 结构数组在传入的函数中不同？

> ID：15277638
> 
> 赞同：0
> 
> 时间：2013-03-07T17:20:06.440
> 
> 标签：c++, arrays, struct, sizeof

我有一个动态分配的结构数组（`myStructArray`）。为了获得其中的元素数量，正如我们所知（即使是 hack），我做了一个 ( `sizeof(myStructArray)/sizeof(myStructArray[0]`) ，它按预期工作。

但是，当我传入`myStructArray`一个函数时，`sizeof`对该结构数组参数 ( `someStructArray`) 执行该操作会直接得到我想要的 - 数组元素的数量。

为什么？？？

我知道`myStructArray`是通过引用传递的，并且作为验证和理智，我操纵了`someStructArray`inside of的元素，`bar()`它***确实***改变了`myStructArray`. 所以，这个问题困扰着我。

当然，我喜欢我可以在`bar()`不进行 ( `sizeof(someStructArray)/sizeof(someStructArray[0])`) hack 的情况下获得内部数组元素的数量，但除非我明白为什么，否则我不会感到舒服/自信，它总是会以这种方式解决。谢谢！

```
typedef struct {
   int a;
   int b;
} MyStruct;

...

.h file
class MyClass {
public:
   static MyStruct myStructArray[];
};

.cpp file
MyClass::myStruct[] =
{{1,2}, {3,4}};

void MyClass::foo() {
   sizeof(myStruct); // 16  (elements x size of element)
   cout << myStruct[0].a;  // 1 
   bar(myStruct);
   cout << myStruct[0].a;  // 17 
}

...

void bar(MyStruct someStruct[]) {
   sizeof(someStruct);  // 2  (just elements??) why different??? 
   someStruct[0].a = 17;  
} 
```

# java - 字符串扩展实用程序

> ID：15277645
> 
> 赞同：0
> 
> 时间：2013-03-07T17:20:26.467
> 
> 标签：java, velocity, freemarker

我似乎记得一个 Apache Commons 或类似的 API，它允许您使用属性扩展替换字符串内联，类似于 Freemarker 或 Velocity（或就此而言的 JSP 容器）完成此操作而无需拖入这些工具。谁能记得这个 API 是什么？显然，名称不正确，但构造看起来像这样：

```
Person person = ...;
String expanded = SomeAPI.expand(
                  "Hi ${name}, you are ${age} years old today!", 
                  person); 
```

我不是在寻找有关如何完成此任务的其他建议（例如使用 Formatter），只是在寻找现有的 API。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:31:48.233

`MessageFormat`可能是您正在寻找的：

```
final MessageFormat format = new MessageFormat("Hi {0}, you are {1, number, #} years old today!");
final String expanded = format.format(new Object[]{person.getName(), person.getAge()}); 
```

还有一个像这样的C `String.format`：

```
final String expanded = String.format("Hi %1s, you are %2s years old today!", person.getName(), person.getAge()); 
```

测试：

```
public static void main(String[] args) {
    final MessageFormat format = new MessageFormat("Hi {0}, you are {1,number,#} years old today!");
    System.out.println(format.format(new Object[]{"Name", 15}));
    System.out.println(String.format("Hi %1s, you are %2s years old today!", "Name", 15));
} 
```

输出：

```
Hi Name, you are 15 years old today!
Hi Name, you are 15 years old today! 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T19:04:08.293

这应该使用 Apache Commons [Lang](http://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/text/StrSubstitutor.html)和[BeanUtils](http://commons.apache.org/proper/commons-beanutils//apidocs/org/apache/commons/beanutils/BeanMap.html)来解决问题：

```
 StrSubstitutor sub = new StrSubstitutor(new BeanMap(person));

  String replaced = sub.replace("Hi ${name}, you are ${age} years old today!"); 
```

# sed - 在第 m 个和第 n 个匹配模式之间打印行

> ID：15277649
> 
> 赞同：1
> 
> 时间：2013-03-07T17:20:36.280
> 
> 标签：sed, grep, vim

我想打印文件中*第 m 个*和*第 n 个*匹配模式之间的所有行。假设 m 为 10，n 为 90，在 VIM 中我执行以下操作：

```
/pattern  
gg
100n
jdG
gg
10n
kdgg 
```

我如何使用 sed 或 grep 执行此操作。我希望在不在 Windows 中打开它的情况下对文件进行操作。我尝试使用带有 -c 选项的 vimscript，但遇到了一些问题。我们可以在 vimscript 中执行此操作而无需在窗口中打开文件吗？我想将这部分（截断文件）用作 shell 脚本的一部分。我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:24:53.700

一种简单的方法：

```
awk '/pattern/{ count++ } count > m && count < n' input 
```

如果它在一行上出现多次，这只会计算一次模式，但这很容易修复，并且不清楚在这种情况下你想要什么行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T18:06:27.677

我看到标记为`vimscript`只需添加此答案的问题。如果这里不合适，请发表评论，我会删除它。

您的 vim 工作流程可以简化为：（例如`m=3,n=10`）

```
/pattern
3//,10//y x|%d|put x 
```

*   如果你想要它在 vimscript 中，你可以将它包装在一个函数中：

    ```
    function! CutIt(m,n)
        execute a:m.'//,'.a:n.'//y x|%d|put x'
    endfunction 
    ```

那么你只是（之后`/pattern`）`:call CutIt(3,10)`

*   如果要保存`/pattern`步骤：

    ```
    function! CutIt(p,m,n)
        execute a:m.'/'.a:p.'/,'.a:n.'/'.a:p.'/y x|%d|put x'
    endfunction 
    ```

然后你就打电话`:call CutIt('pattern',3,10)`

如果你想以交互方式进行。比如说，输入一个映射键，然后输入，`pattern, m, n`然后`Enter`让 vim 为你完成这项工作。你可以检查这个答案，如何在 vim 中接受用户输入： [Remap key and get user input](https://stackoverflow.com/questions/15273810/remap-key-and-get-user-input)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:35:20.267

```
sed '10,90!d' file.txt 
```

将第 10 行到第 90 行打印到 STDOUT。要将输出发送到新文件，请使用

```
sed '1,9!d' file.txt > newfile.txt 
```

# google-chrome - 带有 CSS 转换的圆形缩放动画 Chrome 错误

> ID：15277656
> 
> 赞同：2
> 
> 时间：2013-03-07T17:20:46.943
> 
> 标签：google-chrome, css, scale, css-transforms

我在 Chrome 中的简单动画遇到了一些麻烦。我正在开发一个非常简单的预加载器，它包含在一个可以及时增加其大小的圆圈中。这就是我创建这个的方式：

```
#circle{
position:absolute;
    display:block;
        width:40px;
    height:40px;
        background:#000;
    top:50%;
    left:50%;
    margin:-20px 0 0 -20px;

    -webkit-border-radius:50%;
     -khtml-border-radius:50%;
       -moz-border-radius:50%;
            border-radius:50%;

    -webkit-transform:scale(0.3);
       -moz-transform:scale(0.3);
        -ms-transform:scale(0.3);

    -webkit-animation:loading 1.5s ease-out forwards infinite;
       -moz-animation:loading 1.5s ease-out forwards infinite;
        -ms-animation:loading 1.5s ease-out forwards infinite;
} 
```

这是动画：

```
@-webkit-keyframes loading {
    0%{-webkit-transform:scale(0.3);}
    50%{-webkit-transform:scale(1);} 
    100%{-webkit-transform:scale(0.3);}    
} 
```

这是结果，边缘仅在 Chrome 上被切断。Safari，也使用 webkit 完美地呈现了这一点。（注意顶部和左侧的切口）

![在此处输入图像描述](../Images/0ff59c8cfe6e0301e92bf547a44961a9.png)

和最后一个问题有关。您将如何计划 IE 的图形回退？我的意思是，我可以要求 modernizr 并创建后备方案，删除它并通过 JS 添加图形。但我想知道只使用 CSS 的更好方法。

该动画在 IE 上不起作用，因此我们的想法是删除黑色圆圈并在其位置添加一个动画预加载器 gif。

希望你能帮忙，因为它让我发疯！

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:23:46.473

看起来它被它的容器隐藏了。

尝试这个：

```
 #circle {
   margin:-19px 0 0 -19px;
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-18T12:29:47.053

问题与border-radius的属性有关，把圆改成svg图片。

# java - Wicket - 在 onSubmit 之前渲染一些东西

> ID：15277658
> 
> 赞同：0
> 
> 时间：2013-03-07T17:20:49.477
> 
> 标签：java, wicket-1.6

在我的 AjaxButton onSubmit() 的整个请求周期完成之前，怎么可能或最好的方式来呈现某些东西。我尝试设置一个可见的进度条，就在用户单击 AjaxButton 之后，做一些内部工作，工作完成后，我想设置另一个响应页面。但是只有在 onSubmit 方法中完成所有操作后才会呈现页面。我想在单击按钮后显示进度条，内部工作的处理和重定向应该在之后开始。是否有可能将其拆分或从另一个线程调用 setResponsePage 方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T08:48:43.467

我找到了解决方案。我将交互分为两个请求：

```
AjaxButton confirmButton = new AjaxButton("confirmButton", layoutForm) {

@Override
protected void onSubmit(AjaxRequestTarget target, Form<?> form) {
    super.onSubmit(target, form);
    System.out.println("Second");
}
};

confirmButton.add(new AjaxEventBehavior("onclick") {

@Override
protected void onEvent(AjaxRequestTarget target) {
    System.out.println("First");
}
}); 
```

# c++ - C ++ SendARP返回错误的mac地址？

> ID：15277659
> 
> 赞同：1
> 
> 时间：2013-03-07T17:20:51.017
> 
> 标签：c++

我试图在我的局域网上检索设备的 mac 地址，我使用 SendARP 函数来执行此操作，但由于某种奇怪的原因，它给了我错误的 mac 地址，我告诉它获取我的笔记本电脑的 mac，它也在局域网上但它不起作用：/

链接到 SendARP 功能（MSDN）：http: [//msdn.microsoft.com/en-us/library/windows/desktop/aa366358%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366358%28v=vs.85%29.aspx)

笔记本电脑的 mac 真的是：e0:94:67:18:a7:dc SendARP 的 Mac 输出：e9:ad:2d:01:c8:11

这是我创建的简单地从 IP 地址获取 mac 的函数：P

```
BYTE* GetMacAddress(IPAddr destination, IPAddr source) {
Sleep(500);
ULONG DestMacAddr[2];
ULONG PhysicalLength = 6;

memset(&DestMacAddr, 0xff, sizeof(DestMacAddr));

DWORD returnValue = SendARP(destination, source, &DestMacAddr, &PhysicalLength);

if(returnValue == NO_ERROR) {
    cout << "Fetched destination mac" << endl;
}else {
    printf("Error: %d\n", returnValue);

    if(returnValue == ERROR_BAD_NET_NAME) {
        printf("ERROR_BAD_NET_NAME\n trying to fetch mac address...");
        return GetMacAddress(destination, source);
    }

    if(returnValue == ERROR_BUFFER_OVERFLOW) {
        printf("ERROR_BUFFER_OVERFLOW\n");
    }

    if(returnValue == ERROR_GEN_FAILURE) {
        printf("ERROR_GEN_FAILURE\n");
    }

    if(returnValue == ERROR_INVALID_PARAMETER) {
        printf("ERROR_INVALID_PARAMETER\n");
    }

    if(returnValue == ERROR_INVALID_USER_BUFFER) {
        printf("ERROR_INVALID_USER_BUFFER\n");
    }

    if(returnValue == ERROR_NOT_FOUND) {
        printf("ERROR_NOT_FOUND\n");
    }

    if(returnValue == ERROR_NOT_SUPPORTED) {
        printf("ERROR_NOT_SUPPORTED\n");
    }
}
BYTE *bMacAddr = (BYTE *) &DestMacAddr;

return bMacAddr; 
```

}

我在想这可能是因为它是网络字节顺序或其他东西，但 nothl() 也不起作用：/请在这里帮助我：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T18:27:07.503

You can't do this:

```
BYTE *bMacAddr = (BYTE *) &DestMacAddr;

return bMacAddr; 
```

You're returning a pointer to some thing that's on the stack of your GetMacAddress() function, which will be gone when the function ends.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T18:19:37.727

在命令提示符下键入“arp -a”以查看本地 arp 表中笔记本电脑的 MAC 地址是什么。如果它与原来的不同，则键入“arp -d”（在 Vista 和 Win7/8 上具有管理员权限）以清除 arp 表并尝试使用 yo SendARP 应用程序再次检查 mac。

# java - 绘制 JPanel 隐藏菜单

> ID：15277673
> 
> 赞同：3
> 
> 时间：2013-03-07T17:21:16.627
> 
> 标签：java, swing

我有一个 JPanel，在其上执行自定义绘画可能需要 15 秒。

![在此处输入图像描述](../Images/83ab2ce0e17e4432f77466e8d8746ad9.png)

问题是，当我在绘制 JPanel 时单击菜单时，绘制是在菜单上完成的，并且选项不可见。（见图片中扭曲的文字）

![在此处输入图像描述](../Images/179e269431da4b1349591a6683979794.png)

如果我在绘画完成后单击菜单，则不会出现不需要的行为，但是当我将鼠标指针移到不同的菜单上时，同样的事情又会发生。例如，绘画完成后，如果我点击“应用程序”，不会出现副作用，但是当我将鼠标指针移到“帮助”上时，就会出现前面描述的行为。如何避免这种情况？

我在一个单独的线程中在 paintComponent() 方法之外执行绘画：

```
public class RandomIFSPanel extends JPanel {

  RandomIFSPanelRenderer randomIFSPanelRenderer;

 @Override
    public void paintComponent(Graphics graphics) {
        try {
            randomIFSPanelRenderer.stop();
        } catch (Exception e) {
        }
randomIFSPanelRenderer = new RandomIFSPanelRenderer();
   randomIFSPanelRenderer.start();
}

    class RandomIFSPanelRenderer extends Thread {
        @Override
        public void run() {
            for (int i = 0; i < numberOfPoints; i++) {
                Graphics g=getGraphics();
             g.setColor(Color.WHITE);
               g.drawLine........
            }
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:43:02.967

首先，您不应该在方法中启动线程，`paintComponent()`因为. 可能会发生新线程启动而以前的线程没有终止的情况。`paintComponent()``repaint()`

其次，如果要正常绘制菜单，请尝试`super.paintComponent(g)`在开头添加`paintComponent()`.

第三，`Graphics g = getGraphics();`为什么不直接使用`graphics`？由于 Graphics 对象正在发生变化，因此您不能假设下一次绘画是在同一个旧 Graphics 对象中进行的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T17:33:37.963

除了关于事件调度线程的内容之外：

*   你是直接调用paintComponent() 方法吗？调用 repaint() 更“安全”。
*   是否可以在调用 paintComponent() 时缓冲图像、绘制图像然后在面板上进行设置？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T11:17:15.003

*   不要使用线程会阻​​塞 EDT，不是所有的事件都可以在屏幕上看到，在某些情况下只有第一个。最后，使用 Swing Timer 代替

*   不要在 paintComponent 中创建任何 Object、FileIO、Thread 等，也不要在 try-catch-finally 块中创建 unsafe

*   之前创建任何对象，将其放入数组和内部paintComponent以在最终对象数组中循环

*   发布一个[SSCCE](http://sscce.org/)，简短，可运行，可编译，只是关于绘画，所有对象都应该存储为局部变量（实际上，任何关于二次淡入和缩小问题的答案）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T17:25:33.937

我不会在paintComponent 方法中运行线程。我会在paint方法之外使用线程。

# matlab - 用于 MATLAB 的低频、高通滤波器

> ID：15277676
> 
> 赞同：0
> 
> 时间：2013-03-07T17:21:33.010
> 
> 标签：matlab, filter, signals

我在尝试在 MATLAB 中创建/使用在非常低的频率下足够准确的滤波器时遇到了真正的麻烦。

我对 5 到 50Hz 之间的信号范围很感兴趣，高频段并不是什么大问题，我真正想做的是过滤 5Hz 以下的任何信号。但是，我发现巴特沃斯滤波器的滚降在滤波方面做得很少，它只是将信号衰减到正常信号的一半左右。

我试过两种方法。一个是使用 MATLABs 过滤工具`fdatool`，另一个是下面的手动方法：

```
filtLow = 5;
filtHigh = 50;
Fs = 1000;
[b, a] = butter(1, filtLow/(Fs/2), 'high');
y = filtfilt(b, a, data); 
```

或者

```
[b, a] = butter(1, [filtLow/(Fs/2), filtHigh/(Fs/2)]);
y = filtfilt(b, a, data); 
```

谁能给我一个可以给我更好结果的建议或代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T18:03:38.227

如果您只想要 5-50Hz 范围内的信号，那么您的滤波器的阶数可能会非常高。此外，巴特沃斯滤波器虽然通带中的线性相位和平坦频率响应没有从通带到抑制的最佳滚降。如果你能忍受一点失真，椭圆或贝塞尔滤波器会给你一个更紧密的滚降。此外，如果您使用 5 Hz 作为截止频率，理论上它应该是 -3 dB 点，这就是您看到 1/2 衰减的原因。您需要考虑一些规格。

1.  在通带中我能接受的最低频率是多少？
2.  在通带中我能接受的最高频率是多少？

您认为这可以确定所需的*可实现*衰减。现在，您似乎想要在单个频率上进行无限衰减。不幸的是，您需要确定您的设计可接受的频率范围内的衰减。

我在高通部分试了一下，得出以下结论：

```
Fs = 1000;
BW = Fs/2;
% get the recommended order and cutoff for high pass
[n,Wc] = buttord(10/BW,5/BW,3,10);
% get the butterworth filter
[b,a] = butter(n,Wc);
% get the frequency response
[H,W] = freqz(b,a);
% plot the low end of the response
plot( BW*W(1:10)/pi, 20*log10(abs(H(1:10))) ) 
```

给我->

![频率响应](../Images/54d4ad0703343a6e644e52ca5d7b7380.png)

这似乎很合理。

# android - 确定移动设备是否在移动的飞机上？

> ID：15277679
> 
> 赞同：0
> 
> 时间：2013-03-07T17:21:38.400
> 
> 标签：android, ios, gps, accelerometer, cellular-network

我想知道是否有一种好方法可以确定移动设备是否已开机并位于飞行的飞机上。是否可以为 iOS 和 Android 平台推广解决方案？位置、高度和速度可以在最低高度确定吗？需要gps吗？通过 cel tower 信息进行本地化是否足够？

就像是：

```
if (altitude > 100ft off ground) && (speed > 200 mph) then flying = true 
```

不会是完美的，但可能是可以接受的准确。

原因：我想知道是否可以收集表示移动设备在飞机起飞或降落期间是否开机的汇总数据。

要求：如果解决方案为一小部分移动设备提供数据，那么在确定在飞行期间打开此类设备是否会造成航空风险方面，可能会认为汇总信息具有重要意义。这将消除讨论中的传闻和轶事经验。可能有助于提出改变政策的论点。

请尝试将您的回复集中在此处将发挥作用的技术考虑上。设备所有者是否必须下载应用程序并选择加入才能知道此信息？cel 塔的数据是否就足够了？可能不止一种方法有效吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T18:33:16.567

我已经用我的 iphone 4 试过了：

您不会在普通飞机上接收 GPS。
手机信号塔的位置也不起作用。

所以只剩下**加速度传感器**了。

如果你足够聪明的话，这很有效:-)。

您可以识别出起步时的高加速度，其性能优于任何车辆。即使在启动之后，您也可以识别出加速度值的“典型”模式。
落地也是一样，这种长时间保持的巨大负加速度也是独一无二的。

（但这是一个重大项目，对于有经验的开发人员来说大约需要 2-3 个月）。
您将`FFT`为此任务使用频率分析。

（有些公司已经这样做了：他们可以分析包裹服务中使用了哪种运输车辆类型，其中特殊包裹包含加速度传感器。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:31:38.180

看看[飞机上的 911 手机电话？不太可能](http://rense.com/general56/cellpp.htm)并考虑到除了不太可能接收到的小区信号之外，GPS 信号可能有更糟糕的机会通过。

顺便说一句，离哪个地面 100 英尺？你用什么作为参考点？丹佛的高度和死海的高度有很大的不同，这还没有考虑到地球不是完美的圆形这一事实。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T17:27:21.840

通过 GPS 访问，您可以确定位置、方向、高度和速度。请注意，如果 iPhone 中的 GPS 无限期开启，将会导致大量电池消耗。

# android - DataPicker 看起来也像新 API 上的旧设计

> ID：15277683
> 
> 赞同：7
> 
> 时间：2013-03-07T17:21:58.007
> 
> 标签：android, android-fragments, datepicker

所以问题很简单：

我`DatePicker`在我的应用程序中集成了一个。不是作为 a`DialogDatePicker`而是作为一个 View 组件（更准确地说是 a 的`View`内部，`Fragment`动态显示并从`FrameLayout`我的主`FragmentActiviy`布局中包含的 a 中删除。）。

现在我的问题是这个 DataPicker 看起来像这样： ![在此处输入图像描述](../Images/d70a3485eab32673f8216243b3461eb5.png)

而不是这样：

![在此处输入图像描述](../Images/4ee2c14976074f426d03795dcb828414.png)

即使我以更高的 API 为目标，我也尝试将 Min SDK 设置为 16 或 17，但它也没有任何帮助。

有人知道为什么会这样吗？以及如何显示数据选择器的新外观？最好在旧版本的Android上也是如此？

任何帮助，将不胜感激。

谢谢。

**编辑：**代码：

**数据选择器片段 xml：**

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:paddingLeft="6.5dp"
    android:paddingTop="6dp"
    android:paddingRight="8.5dp"
    android:paddingBottom="8.5dp"
    android:background="@drawable/date_picker_background">

    <DatePicker
        android:id="@+id/datePicker"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_margin="10dp"
        android:paddingBottom="40dp" />

    <LinearLayout 
        android:layout_width="match_parent"
        android:layout_height="match_parent">

        <Button
            android:id="@+id/bCancel"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_gravity="bottom"
            android:layout_weight="1.0"
            android:onClick="buttonCanceDatePickerOnclick"
            android:text="@string/cancel" />

        <Button
            android:id="@+id/bSave"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_gravity="bottom"
            android:layout_weight="1.0"
            android:onClick="buttonSaveDatePickerOnclick"
            android:text="@string/save" />

     </LinearLayout>
</FrameLayout> 
```

**DataPickerFramgnet 类：**

```
public class DatePickerFragment extends Fragment {

    private Button bSave, bCancel;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        View rootView = inflater.inflate(R.layout.date_picker_fragment_layout, 
                                         container, false);
        return rootView;
    }
} 
```

**更新：**

**清单文件：**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.emildesign.sgreportmanager"
android:versionCode="1"
android:versionName="1.0">

    <uses-sdk
        android:minSdkVersion="13"
        android:targetSdkVersion="17" />

    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>

    <!--  Crittercism  -->
    <uses-permission android:name="android.permission.READ_LOGS"/>
    <uses-permission android:name="android.permission.GET_TASKS"/>

    <application
        android:allowBackup="true"
        android:name="com.emildesign.sgreportmanager.SGRaportManagerAppObj"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@android:style/Theme.Black.NoTitleBar.Fullscreen">

        <activity
            android:name="com.emildesign.sgreportmanager.activities.LoginScrActivity"
            android:screenOrientation="landscape">

            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name="com.emildesign.sgreportmanager.activities.ReportsTableActivity"
            android:screenOrientation="landscape">
        </activity>
        <activity
            android:name="com.emildesign.sgreportmanager.activities.ParametersActivity"
            android:screenOrientation="landscape">
        </activity>
        <activity android:name="com.crittercism.NotificationActivity"/>  
</application> 
```

好吧，我发现我的问题出在哪里，我设置：

```
android:theme="@android:style/Theme.Black.NoTitleBar.Fullscreen" 
```

使我的应用程序全屏显示，这应用了数据选择器的旧样式，将其更改为：

```
android:theme="@android:style/Theme.Holo.Light.NoActionBar.Fullscreen" 
```

创建以下 DataPicker：

![在此处输入图像描述](../Images/c999bdda4c35d9cd48363baa6cdb4304.png)

它比以前更好，但这仍然不是我正在寻找的结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T17:41:32.387

将您`android:targetSdkVersion`的设置为 11 或更高。[这是一个示例应用程序来演示这一点](https://github.com/commonsguy/cw-omnibus/tree/master/WidgetCatalog/DatePicker)。

* * *

**更新**

首先，您的原始`DatePicker`屏幕截图来自深色主题（例如`Theme.Holo`），而您的第二张屏幕截图来自浅色主题（例如`Theme.Holo.Light`）。

其次，`DatePicker`文档有以下开头段落：

> 此类是用于选择日期的小部件。日期可以通过年、月、日微调器或 CalendarView 来选择。微调器组和日历视图自动同步。客户端可以自定义是否仅显示微调器，或仅显示日历视图，或两者都显示。此外，可以自定义选择日期的最小和最大日期。

您可以摆脱`CalendarView`通过`android:calendarViewShown`（或`setCalendarViewShown()`）。当您尝试这样做时，您会发现一旦`CalendarView`消失，您的年份微调器就会出现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T17:41:42.173

您必须使用 Holo 主题。

因此，您的主题应如下所示：

```
<style name="AppTheme" parent="@android:style/Theme.Holo">
    ...
</style> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T18:57:17.727

*回复您的更新*

改变

`android:theme="@android:style/Theme.Holo.Light.NoActionBar.Fullscreen"`

到

`android:theme="@android:style/Theme.Holo.NoActionBar.Fullscreen"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-25T11:27:28.547

这是调用设备的默认日期和时间选择器的片段

date_time_layout.xml

```
 <?xml version="1.0" encoding="utf-8"?>
    <ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:gravity="center" >

        <LinearLayout
            android:id="@+id/linearLayout1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:gravity="center"
            android:orientation="vertical" >

            <DatePicker
                android:id="@+id/datePicker1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:calendarViewShown="false" > <!-- style="@style/date_picker_style" -->
            </DatePicker>

            <TimePicker
                android:id="@+id/timePicker1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" >
            </TimePicker>

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content" >

                <Button
                    android:id="@+id/dialogCancel"
                    android:layout_width="0dip"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:text="Cancel" />

                <Button
                    android:id="@+id/dialogSet"
                    android:layout_width="0dip"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:text="Set" />
            </LinearLayout>
        </LinearLayout>

    </ScrollView> 
```

将此方法放在您的类中并使用 showDateAndTimePicker(); 调用它

```
private void showDateAndTimePicker() {
        final Dialog dialog = new Dialog(this,
                android.R.style.Theme_DeviceDefault_Dialog);

        dialog.setContentView(R.layout.date_time_layout);
        dialog.setCancelable(false);
        dialog.setTitle("Select Date and Time");
        Button set = (Button) dialog.findViewById(R.id.dialogSet);
        Button cancel = (Button) dialog.findViewById(R.id.dialogCancel);
        final DatePicker dtp = (DatePicker) dialog
                .findViewById(R.id.datePicker1);
        final TimePicker tp = (TimePicker) dialog
                .findViewById(R.id.timePicker1);
        set.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                // Handle Set button
                dialog.dismiss();

            }
        });
        cancel.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                 //Handle Cancel button
                dialog.dismiss();
            }
            });
            dialog.show();
        } 
```

# php - 使用 PHP 从数据库中选择一个随机行，但不是一个相等的行

> ID：15277684
> 
> 赞同：0
> 
> 时间：2013-03-07T17:21:59.723
> 
> 标签：php, mysql, database, arrays

我的问题几乎是不言自明的，但我不能完全解决它以使其尽可能高效。
我想从 MySQL 数据库中选择一个随机条目。我希望它尽可能快且尽可能高效（这始终是目标，不是吗？）。当我选择该行时，我想选择另一行，但与之前的行不同。如果我选择 10 行，我希望第 11 行与所有其他行不同（可以说是唯一的 :)）。但是当我用完行时，我想“报告错误”。

才能触及问题的核心。我正在使用 PHP 和 MySQL。我有一个包含已选择标题的输入数组。然后我得到数据库中所有项目的计数，所以我知道我可以“循环通过最大值”多少次。让我们粘贴代码来看看我们在这里处理什么。

```
try
{
    $db = new PDO("mysql:host=localhost;dbname=xxxxx;charset=utf8", "xxxx", "xxxx");

    $played = explode(":;:", $_POST['items']); //All already selected items are in $_POST separated by :;:

    $sql = "SELECT count(id) AS count FROM table"; //Lets get the total count of items

    $query = $db->prepare($sql);
    $query->execute();
    $result = $query->fetch(PDO::FETCH_ASSOC);

    $count = $result['count']; //There we are...
    $i = 0; //Index counter so we dont exceed records.. well kinda (more on that below)

    do //do while because we want something to be selected first
    {
        $sql = "SELECT FLOOR(RAND() * COUNT(*)) AS offset FROM table"; //From here

        $query = $db->prepare($sql);
        $query->execute();
        $result = $query->fetch(PDO::FETCH_ASSOC);
        $offset = $result['offset'];

        $sql = "SELECT itemXML FROM table LIMIT $offset, 1";

        $query = $db->prepare($sql);
        $query->execute();
        $result = $query->fetch(PDO::FETCH_ASSOC); //To here is some code to randomly select a record "as efficiently as possible"..

        $output = Array();

        $xml = simplexml_load_string($result['itemXML']);

        $i++;
    } while (in_array($xml->{"title"}, $played) && $i < $count); //While record title is in array and while we have not exceeded the total number of records (that's the logic but it isint that simple is it?)

    if ($i >= $count)
    {
        die("400"); //Just a random status code which I parse with the client.
    }

    $itemArr = Array("whatever" => $xml->{"whatever-attr"}, "title" => $xml->{"title"});
    array_push($output, $itemArr); Lets push this to out array

    echo json_encode($output); //Aaaaand finally lets print out the results
}
catch (Exception $e) //If anything went wrong lets notify our client so he can respond properly
{
    $output = Array("error" => $e->getMessage());
    die(json_encode($output));
} 
```

是的，很好.. 问题是如果有 10 条记录，选择了 9 行并且索引计数器`$i`变得更大或等于 10 并且随机记录都在数组中，该怎么办？然后我们有一行应该被选中，但它没有。

我该如何解决这个问题？您的帮助将不胜感激！
如果我解释得不够好，请告诉我，我会更加努力。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:26:42.703

我认为您在这里采取了错误的方法。您不应该需要遍历数据库一次查询一条记录。

如果您需要选择 10 条记录，只需像这样选择 RAND() 排序的 10 条记录

```
SELECT * FROM table
ORDER BY RAND()
LIMIT 10; 
```

或者，如果您想从选择中省略某些 ID

```
SELECT * FROM table
WHERE id NOT IN (?, ?, ?, ...)
ORDER BY RAND()
LIMIT 10; 
```

或者，如果您要省略的 id 存储在另一个表中

```
SELECT * FROM table
LEFT OUTER JOIN omit_table ON table.id = omit_table.id
WHERE omit_table.id IS NULL
ORDER BY RAND()
LIMIT 10; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:51:04.360

假设您已经在下表中填充了数据：

```
TABLE mydata
  id INT AUTOINCREMENT PRIMARYKEY
  name VARCAHAR
  ... 
```

我们为一些非随机映射创建下表：

```
TABLE shufflemap
  id INT AUTOINCREMENT PRIMARYKEY
  data_id INT UNIQUEINDEX 
```

我们执行以下操作：

```
$rs = $dbh->query('SELECT id FROM mydata');
shuffle($rs);
foreach($rs as $data_id) {
    $dbh->query('INSERT INTO shufflemap (data_id) VALUES (?)', array($data_id));
} 
```

现在如果我们想添加行怎么办？您可以`TRUNCATE`表并重新运行上述代码，或者：

```
$my_new_id = 1234; //the ID of the new row inserted into `mydata`
$rs = $dbh->query('SELECT COUNT(*) AS 'count' from shufflemap');
$target = rand(0,$rs[0]['count']);
$rs = $dbh->query('SELECT id, data_id FROM shufflemap LIMIT ?,1', array($target));
$swap_id = $rs[0]['id'];
$swap_data_id = $rs[0]['data_id'];
$dbh->query('UPDATE shufflemap SET data_id = ? WHERE id = ?', array($my_new_id, $swap_id));
$dbh->query('INSERT INTO shufflemap (data_id) VALUES (?)', array($swap_data_id)); 
```

它以相当有效的方式从 shufflemap 表中选择随机条目，将 data_id 替换为新的，并将旧的添加到表的末尾。

使用这种方式，您可以拥有看似随机的数据而没有重复，并且仍然可以通过在 JOIN、子查询或您能想到的任何其他方式中使用 shufflemap 表来使用表中的所有正确索引。

## 编辑

假设 mydata 表有一个字段指示每个字段与哪个客户端或用户相关联，即：

```
TABLE mydata
  id INT AUTOINCREMENT PRIMARYKEY
  client_id INT
  name VARCAHAR
  ... 
```

可以通过以下方式检索仅该客户数据的打乱列表：

```
SELECT d.*
FROM mydata d INNER JOIN shufflemap s
  ON d.id = s.data_id
WHERE client_id = ?
ORDER BY s.id 
```

排除已播放项目的列表？

```
SELECT d.*
FROM mydata d INNER JOIN shufflemap s
  ON d.id = s.data_id
WHERE client_id = ?
  AND d.id NOT IN(?,?,?,...)
ORDER BY s.id 
```

# python - 英特尔核芯显卡 3000 上的 PyOpenGL 访问冲突

> ID：15277687
> 
> 赞同：4
> 
> 时间：2013-03-07T17:22:02.420
> 
> 标签：python, opengl, intel, pyopengl

我在带有 Intel HD 3000 图形芯片组的 Windows 8 64 位笔记本电脑上遇到了 PyOpenGL 3.0.2 问题。任何调用`glGenBuffers(1)`（在正确的 GL 初始化之后）都会崩溃：

```
 File ".\sample.py", line 7, in init
    buffer = glGenBuffers(1)
  File "latebind.pyx", line 32, in OpenGL_accelerate.latebind.LateBind.__call__ (src\latebind.c:768)
  File "wrapper.pyx", line 308, in OpenGL_accelerate.wrapper.Wrapper.__call__ (src\wrapper.c:5811)
  File "C:\Python27\lib\site-packages\OpenGL\platform\baseplatform.py", line 379, in __call__
    return self( *args, **named )
WindowsError: exception: access violation writing 0x00000000720CF630 
```

完全相同的脚本适用于其他机器。

我有支持 OpenGL 3.1 的最新版本的 GPU 驱动程序 (15.28.12.64.2932)。

有任何想法吗？

这是示例脚本：

```
import sys
from OpenGL.GLUT import *
from OpenGL.GL import *
from OpenGL.GLU import *

def init():
    buffer = glGenBuffers(1)

glutInit(sys.argv)
glutInitWindowSize(600, 600)
glutCreateWindow("Sample")
init()
glutMainLoop() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T19:05:07.910

即使您的驱动程序支持 OpenGL 3.1，Glut 也会默认为您提供 OpenGL 2.0 上下文。您将不得不要求 3.1 cpntext，可能是这样的：

```
glutInitContextVersion(3, 1) 
glutInitContextFlags(GLUT_FORWARD_COMPATIBLE) 
glutInitContextProfile(GLUT_CORE_PROFILE) 
```

如果没有适当的 3.1 上下文，任何 3.1 特定调用都会导致您崩溃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T10:02:49.883

我终于通过卸载我的整个 Python 64 位发行版并安装 Python 32 位和所有 32 位库来解决了这个问题。此外，我必须使用 PyOpenGL 3.1.a。我不知道是什么导致了 64 位安装的问题。

# python - 如何修复 django 1.5 中的 localflavor deprecation 警告？

> ID：15277688
> 
> 赞同：8
> 
> 时间：2013-03-07T17:22:04.100
> 
> 标签：python, django, django-1.5, django-localflavor

我已将现有的 django 1.3 迁移到 django 1.5。一切似乎都很好。但是，当我启动时，由于本地风味，我有一个弃用警告`python manage.py runserver`

> ...\env\lib\site-packages\django\contrib\loca lflavor__init__.py:2: DeprecationWarning: django.contrib.localflavor 已弃用。请改用单独的 django-localflavor-* 包。
> warnings.warn("django.contrib.localflavor 已弃用。请改用单独的 djan go-localflavor-* 包。", DeprecationWarning)

我已经阅读了 django 1.5 发行说明，并且我知道这个应用程序现在已被弃用。我的问题是我的项目中没有使用 localflavor 应用程序。

我想另一个应用程序正在以某种方式加载它（可能是 localeurl 或 modeltranslation？），但我不知道如何修复这个警告。

*   如何知道为什么显示此警告？
*   如何以干净的方式修复它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T17:30:56.613

更新：

> Django 现在有一个 localflavors 包：[https ://pypi.python.org/pypi/django-localflavor](https://pypi.python.org/pypi/django-localflavor)
> 
> 这是文档：[http ://django-localflavor.readthedocs.org/en/latest/](http://django-localflavor.readthedocs.org/en/latest/)
> 
> 我让其余的响应，但它现在已经过时了。

您必须下载您使用的所有本地风味（[https://github.com/django/](https://github.com/django/)），目前只有 3 个在 pypi 上。

然后，您可以将它们与新的

```
from django_localflavor_XX import forms as XX_forms 
```

（其中 xx 是您最喜欢的国家代码）

他们选择搁置所有这些库，因为很多提交（外语）来自 django，而且发布周期有点长。

Django 有本地的墨西哥社会安全号码验证小部件！

所以这是一个很好的举措，但所有这些包都需要由当地社区尽快管理才能使用。

这是在导入完成时触发的，您可能想要记录导入的堆栈跟踪或查看您是否依赖于使用它的 django 应用程序。

所以打开你的 django 源代码，转到你的 contrib.localflavor`__init__.py`文件。打印堆栈跟踪以了解错误导入在哪里。

[http://docs.python.org/2/library/traceback.html](http://docs.python.org/2/library/traceback.html)

希望能帮助到你

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-08T01:16:07.330

这是 django 1.5 中的一个错误。Django 本身正在触发警告。

罪魁祸首是[django/contrib/gis/utils/layermapping.py#L19](https://github.com/django/django/blob/stable/1.5.x/django/contrib/gis/utils/layermapping.py#L19)

这是在 django master 中修复的（通过完全删除 localflavor）。

您可以通过在日志配置中添加忽略来使警告静音：

```
import warnings
warnings.filterwarnings('ignore', r"django.contrib.localflavor is deprecated") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-10T00:04:51.200

刚刚处理了同样的问题。我安装了新包（美国包的示例）：

点安装[https://github.com/django/django-localflavor-us/zipball/master](https://github.com/django/django-localflavor-us/zipball/master)

然后我将旧代码注释掉并更改为新包：

```
# from django.contrib.localflavor.us.us_states import STATE_CHOICES  <= old
from django_localflavor_us.us_states import STATE_CHOICES
# from django.contrib.localflavor.us.models import USStateField  <= old
from django_localflavor_us.models import USStateField 
```

似乎已经解决了这个问题。此处列出了其他语言包：[https ://github.com/django](https://github.com/django)

# asp.net - IE 中不显示 Ajax 嵌套选项卡容器

> ID：15277694
> 
> 赞同：2
> 
> 时间：2013-03-07T17:22:27.023
> 
> 标签：asp.net, ajax

我有下面的嵌套选项卡容器。根标签容器不在 IE 中显示，但在 Chrome 中显示。

```
<form id="form1" runat="server">
    <cc1:ToolkitScriptManager ID="ToolkitScriptManager1" runat="server">
    </cc1:ToolkitScriptManager>
    <cc1:TabContainer ID="RootTabContainer1" runat="server" ActiveTabIndex="0">
        <cc1:TabPanel ID="TabPanel1" runat="server" HeaderText="TabPanel1">
            <ContentTemplate>
                <cc1:TabContainer ID="NestedTabContainer1" runat="server">
                    <cc1:TabPanel ID="TabPanel12" runat="server" HeaderText="TabPanel12">
                    </cc1:TabPanel>
                </cc1:TabContainer>
            </ContentTemplate>
        </cc1:TabPanel>
        <cc1:TabPanel ID="TabPanel2" runat="server" HeaderText="TabPanel2">
            <ContentTemplate>
                <cc1:TabContainer ID="NestedTabContainer2" runat="server">
                    <cc1:TabPanel ID="TabPanel21" runat="server" HeaderText="TabPanel21">
                    </cc1:TabPanel>
                </cc1:TabContainer>
            </ContentTemplate>
        </cc1:TabPanel>
    </cc1:TabContainer>
    </form> 
```

# plsql - SQL*Plus 脚本拉取问题

> ID：15277701
> 
> 赞同：1
> 
> 时间：2013-03-07T17:22:54.667
> 
> 标签：plsql, oracle11g, sqlplus, terminal-services

不确定你的好人可以帮助解决这个问题。我的团队中有一个人正试图从他的家用计算机上运行一个连接到终端服务器的 SQL 脚本。他将所有脚本放在一个易于访问的网络文件夹中，他可以访问该文件夹。但是，当他尝试通过文件 -> 打开 -> 文件夹 -> script.sql 运行脚本时，脚本将不会执行。该脚本确实从网络文件夹中提取并插入到 SQL *PLus 窗口中，但是它被插入到提示符下方并且脚本不执行。我和我的团队都使用各种终端服务器进行远程工作（因为我们遍布全国），我已经尝试并复制了他的问题。我登录到同一个终端服务器，运行同一个版本的 SQL*加上并尝试提取相同的脚本（但是我的脚本位于我的一个网络驱动器文件夹中，而不是他的）并且每件事都正确执行。我无法对这个问题做出正面或反面。非常感谢您的帮助，因为我们有 TB 的数据要提取，而没有时间去做。

# jquery - 单击时无法更改链接的颜色

> ID：15277702
> 
> 赞同：0
> 
> 时间：2013-03-07T17:22:55.723
> 
> 标签：jquery, css, hover

我在页面右侧有菜单，菜单中的所有链接都是橙色的。当我悬停任何链接时，它会变为黑色。但我想要的是，在我点击任何其他链接之前，它应该以黑色保持活动状态，以便每个人都知道打开的页面属于该链接。这可能是一个愚蠢的问题，但我做不到。提前致谢。

这是代码：

JavaScript 函数：

```
@section JavaScript{
<script type="text/javascript">
    $('#allapps a').click(function () {
        $('#allapps a').removeClass('selected'); // remove selected from any other item first
        (this).addClass('selected'); //add selected to the one just clicked.
    });
 </script>
} 
```

关联 ：

```
<a id="allapps" class="allapps" href="@Url.Action("CategoryType", "Marketplace", new { @id = 1 })"><h3 class="allapps grid_2 alpha">Legal </h3><p class="grid_1 omega calculate" > @ViewBag.legal</p><br /><br /></a> 
```

CSS：

```
.allapps
{
font-family: Arial;
font-size: 12px;
color:#C55000;
padding-left:20px;
font-weight:bold;
}

a.allapps :link {
   color: Black;
}

a.allapps :visited {
 color:Black;}

a.allapps :hover {
 color:Black;}

a.allapps :active {
  color:Black; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:23:43.770

你错过了 $ 或 jQuery

*改变*

```
(this).addClass('selected'); 
```

*至*

```
$(this).addClass('selected'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:32:35.153

在您的 JQuery 中为什么您同时使用 ID 名称和标记名称......？

```
$('#allapps a').click(function () { 
```

你能像下面这样试试吗……可能对你有帮助……

```
$('#allapps').click(function () {
        $('#allapps').removeClass('selected'); // remove selected from any other item first
        $(this).addClass('selected'); //add selected to the one just clicked.
    }); 
```

我也没有`.selected`在你的 CSS 中找到 Class ......

尝试添加它

```
.selected{
 color:Black;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:39:42.953

尝试这个：

```
 $(function(){
     var url = window.location.href;
     var page = url.substr(url.lastIndexOf('/')+1);
     $('a[href$="'+page+'"]').addClass('selected');

     $('#allapps a').click(function () {
        $('#allapps a').removeClass('selected');
        $(this).addClass('selected');
     });
  }); 
```

你似乎想要什么，`to highlight the link`但`when clicked on it page get refreshed`和`applied class gets removed.`

# silverlight - 在 C# 客户端应用程序中使用 Web 服务

> ID：15277705
> 
> 赞同：0
> 
> 时间：2013-03-07T17:23:06.653
> 
> 标签：silverlight, service, web

我试图从 silverlight c# 应用程序连接到 web 服务。我向服务添加服务引用，现在我尝试访问它，但我无法像我期望的那样连接到它：

```
WebService1 service = new WebService1(); 
```

然后我会打电话：

```
service.SomeMethod(); 
```

但这是不可能的。添加的服务是一个我无法实例化的命名空间，并且在其中没有要创建为服务的对象。

你能告诉我任何简单的方法如何使用 Visual Studio 中的 Web 服务参考或其他方式从 Silverlight 应用程序连接到 Web 服务吗？

谢谢

# php - 如何为关键字搜索编写codeigniter查询代码

> ID：15277706
> 
> 赞同：1
> 
> 时间：2013-03-07T17:23:08.057
> 
> 标签：php, mysql, codeigniter

我写了一个关键字搜索的方法和模型。但不幸的是，我得到的输出与我的关键字匹配，并且与我输入的关键字没有任何匹配。

例如。如果我输入“grisham”之类的关键字作为作者姓氏，那么我将获得所有其他数据（`book_title,auth_firstname,isbn`）作为输出，包括“grisham”（即`auth_lastname`）

*但我输入的关键字仅与作者姓氏匹配。那么为什么其他的都显示？***只应该显示aUth_last name？**

请帮助我，解决我的问题。

控制器.php

```
 function suggestions()
{
        $this->load->model('Booksmodel');
        $term = $this->input->post('term',TRUE); 
        $rows = $this->Booksmodel->GetAutocomplete(array('keyword' => $term)); 
        $json_array = array();
        foreach ($rows as $row) 
        array_push($json_array, $row->book_title);
        array_push($json_array, $row->auth_firstname);
        array_push($json_array, $row->isbn);
        array_push($json_array, $row->auth_lastname);
        array_push($json_array, $row->publisher_name); 

        echo json_encode($json_array);
} 
```

模型.php

```
 function GetAutocomplete($options = array())
  { 
    $this->load->database();   
    $this->db->limit('10');  
    $this->db->select('book_title,auth_firstname,isbn,auth_lastname,publisher_name');    
    $this->db->like('book_title', $options['keyword']);
    $this->db->or_like('auth_firstname', $options['keyword']); 
    $this->db->or_like('isbn', $options['keyword']);
    $this->db->or_like('auth_lastname', $options['keyword']);
    $this->db->or_like('publisher_name', $options['keyword']); 

    $query = $this->db->get('bookdetails');
      return $query->result();
    } 
```

# git - 给定合并提交 SHA1，您如何查看/显示已完成的 git 合并冲突解决方案？

> ID：15277708
> 
> 赞同：37
> 
> 时间：2013-03-07T17:23:11.940
> 
> 标签：git, merge, resolution, conflict

当您解决冲突，然后进行更改，然后执行 git diff 时，它会显示两列 + 和 -，一列用于“我们的”，另一列用于“他们的”。鉴于 repo 的 git 历史记录中的合并提交，我如何查看由其他人完成的解决方案？在其他情况下，我以前见过它（我认为是在 gitk 中），但我似乎无法为我拥有的这个 SHA1 确定它。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-10-29T10:30:48.970

如果您知道 ref，那么`git show <MERGE_COMMIT>`将向您显示合并提交的解决方案（如果有）。

对于日志，使用`git log -p -c`或`git log -p --cc`。从 git log 的手册页：

```
 -c
       With this option, diff output for a merge commit shows the differences from each 
       of the parents to the merge result simultaneously instead of showing pairwise 
       diff between a parent and the result one at a time. Furthermore, it lists only 
       files which were modified from all parents.

   --cc
       This flag implies the -c option and further compresses the patch output by 
       omitting uninteresting hunks whose contents in the parents have only two 
       variants and the merge result picks one of them without modification. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2022-02-19T00:30:13.393

最近（2022 年，九年后）的选项是：

```
git log --remerge-diff 
```

在 Git 2.36（2022 年第二季度）中，“ [`git log --remerge-diff`](https://github.com/git/git/blob/90b7153806af46ca62b85a92a2810015be2453d4/Documentation/git-log.txt)” ^(（[man](https://git-scm.com/docs/git-log)）)显示了与机械合并结果和实际记录在合并提交中的结果的差异。

请参阅[Elijah](https://github.com/git/git/commit/0dec322d31db3920872f43bdd2a7ddd282a5be67) [Newren ( )](https://github.com/newren)[提交的 0dec322](https://github.com/git/git/commit/0d83d8240ddb3f54da44563b73527dbc50c4ed22)、提交 0d83d82 、提交[20323d1](https://github.com/git/git/commit/20323d104ec389505e83b9376c8ecab94e852fb8)、提交[95433ee](https://github.com/git/git/commit/95433eeed9eac439eb21eb30105354b15e71302e)、[提交 6054d1a](https://github.com/git/git/commit/6054d1aac36d5769461fb73b15326a900e53edb9)、[提交 a28d094](https://github.com/git/git/commit/a28d094ac276da2f6dd8132355baaedf685342ef)、[提交 24dbdab](https://github.com/git/git/commit/24dbdab50ddaadf6a7abaf5537e0dad36d91e49a)、[提交 35f6967](https://github.com/git/git/commit/35f6967161860cb5c067e961b7283e8389ff0726)、[提交 7b90ab4](https://github.com/git/git/commit/7b90ab467a658b2fb1b7c15c7d634e06f35f4ef2)、[提交 db757e8](https://github.com/git/git/commit/db757e8b8d5527c195c461a04ec35d141ddea48e)（2022 年 2 月 2 日[）](https://github.com/newren)。 请参阅[Junio C Hamano ( ) 的](https://github.com/gitster)[提交 5046831](https://github.com/git/git/commit/504683162642c0db86c844ea37cad339f928ea9c)（2021 年 12 月 21 日[）](https://github.com/gitster)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 90b7153](https://github.com/git/git/commit/90b7153806af46ca62b85a92a2810015be2453d4))^(中，2022 年 2 月 16 日）)[`newren`](https://github.com/newren)
[`gitster`](https://github.com/gitster)
^([`gitster`](https://github.com/gitster))

> ## [`show, log`](https://github.com/git/git/commit/db757e8b8d5527c195c461a04ec35d141ddea48e): 提供 --remerge-diff 能力
> 
> ^(签字人：以利亚·纽伦)

> 当指定此选项时，**我们重新合并所有（两个父级）合并提交并将实际合并提交与自动创建的版本进行比较**，以显示用户如何：
> 
> *   删除了冲突标记，
> *   解决了不同的冲突版本，并且
> *   可能会在冲突区域之外添加新的更改**，以解决语义合并问题（或者，可能只是为了隐藏其他随机更改）。
> 
> 此功能通过创建临时对象目录并将其标记为主要对象存储来工作。
> 这使得在自动合并期间创建的任何 blob 或树都可以通过从临时对象目录中删除所有对象来轻松删除。
> 
> 此实现有几种方式不是最理想的：
> 
> *   `log --remerge-diff`变得很慢，因为临时对象目录在运行时会充满许多松散的对象
> *   日志输出可能会因错误的“**警告：无法合并二进制文件**”消息而变得混乱，因为[`ll-merge.c`](https://github.com/git/git/blob/db757e8b8d5527c195c461a04ec35d141ddea48e/ll-merge.c)在运行时无条件地将这些消息写入标准错误，而不是允许调用者管理它们。
> *   简单地丢弃重要的冲突和警告消息；因此，对于无法用内容冲突标记表示的修改/删除或重命名/重命名或文件/目录等冲突，用户可能无法`--remerge-diff`知道存在已解决的冲突（并且可能激发了其他合并提交中的更改）。
> *   修复上一个问题时，请注意可能会开始包含一些不重要的冲突和警告消息。
>     相反，我们应该确保这些仍然被丢弃。
>     后续提交将解决这些问题。

`diff-options`现在在其[手册页](https://github.com/git/git/blob/db757e8b8d5527c195c461a04ec35d141ddea48e/Documentation/diff-options.txt#L37)中包含：

> ## `--diff-merges=(off|none|on|first-parent|1|separate|m|combined|c|dense-combined|cc|remerge|r)`

`diff-options`现在在其[手册页](https://github.com/git/git/blob/db757e8b8d5527c195c461a04ec35d141ddea48e/Documentation/diff-options.txt#L67-L78)中包含：

> ## `--diff-merges=remerge:`
> 
> ## `--diff-merges=r:`
> 
> ## `--remerge-diff:`
> 
> 使用此选项，双父合并提交被重新合并以创建一个临时树对象——可能包含带有冲突标记等的文件。
> 
> 然后在该临时树和实际合并提交之间显示差异。
> 
> 使用此选项时发出的输出可能会发生变化，它与其他选项的交互也会发生变化（除非明确记录）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:54:38.670

轻微的自行车棚：您可以使用 diff3 或 kdiff3 反向查看合并，特别是如果它是（git 风格）“邪恶”合并，其中引入了二次更改来解决冲突。（当心一个爆炸的脑袋，试图看看它是如何“退出”这些变化的；-）

显然，“基础”提交将是合并提交。

# r - 在 R 中的不同 Y 轴上向条形图添加线条

> ID：15277712
> 
> 赞同：3
> 
> 时间：2013-03-07T17:23:31.170
> 
> 标签：r, graphics, plot

我有以下简单的数据。我希望将“V”与 D1,D2,D3 值绘制为并排条形图，将累积总和 CS1,CS2,CS3 绘制为线条，并以不同的 Y 比例绘制。虽然绘制并排条形图相对容易，如第[一个图](http://i.stack.imgur.com/GL9IB.png)所示，但我发现很难为 CS1-CS3 列添加线图。最终的情节看起来像[第二个图](http://i.stack.imgur.com/Yp8zf.png) 谢谢你的帮助

```
V   D1  D2  D3  CS1 CS2 CS3
10  2038    1806    1643    72.81171847 64.52304394 58.69953555
20  550 709 757 92.46159343 89.85351911 85.7449089
30  142 192 271 97.53483387 96.71311183 95.42693819
40  45  61  80  99.14255091 98.89246159 98.28510182
50  12  20  30  99.57127546 99.6070025  99.35691318
60  5   6   10  99.74991068 99.82136477 99.71418364
70  2   2   3   99.82136477 99.89281886 99.82136477
80  4   1   2   99.96427295 99.92854591 99.89281886
90  1   0   1   100.0000000 99.92854591 99.92854591
100 0   1   0   100.0000000 99.96427295 99.92854591 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-07T17:51:57.380

首先，您需要绘制条形图并将其保存为对象。该对象包含条形的 x 坐标。由于最大值为 39.5，我设置`xlim=c(0,40)`.

```
mp<-barplot(as.matrix(t(df[,2:4])),beside=TRUE,xlim=c(0,40),ann=FALSE)
mp
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
[1,]  1.5  5.5  9.5 13.5 17.5 21.5 25.5 29.5 33.5  37.5
[2,]  2.5  6.5 10.5 14.5 18.5 22.5 26.5 30.5 34.5  38.5
[3,]  3.5  7.5 11.5 15.5 19.5 23.5 27.5 31.5 35.5  39.5 
```

添加新的情节使用`par(new=TRUE)`. 然后添加`plot()`第一行和`lines()`其他行。由于新绘图的 x 值使用第二行`mp`对象（中间条）。`axis()`用于设置轴刻度的函数。

```
par(new=TRUE)
plot(mp[2,],df$CS1,xlim=c(0,40),type="l",col="red",axes=FALSE,ylim=c(0,100),ann=FALSE)
lines(mp[2,],df$CS2,col="blue")
lines(mp[2,],df$CS3,col="green")
axis(1,at=mp[2,],labels=df$V)
axis(4,at=seq(0,100,10))
box() 
```

![在此处输入图像描述](../Images/88b67a543b1842f41bb1e9d380263b50.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T19:02:47.237

TeachingDemos 包中的`updateusr`功能允许您更改现有绘图的坐标系，而无需求助于`par(new=TRUE)`它带来的潜在问题。

您还可以`twoord.plot`将 plotrix 包中的函数视为另一种选择。

在同一个图上有 2 个坐标系有时会导致混淆，最好创建 2 个垂直堆叠的对齐图，这样没有重叠并且比例完全独立，可能会使顶部图更短。该`layout`功能可以帮助进行这种安排。

# jquery - 如何从缩短的 Jquery 中获取重定向 URL

> ID：15277713
> 
> 赞同：0
> 
> 时间：2013-03-07T17:23:32.293
> 
> 标签：jquery, url

是否可以从 Bi.ty 或 t.co 等缩短的 URL 中获取重定向 URL。

更新：

我想我并没有我应该说的那么清楚。这就是我想做的

```
var output =[];
var shorturl = "http://t.co"; //input shorturl

//Code I need!!! - make shorturl display long url version ie: http://twitter.com

var longurl = "http://twitter.com"; //result from above code

output.push('<p>' + longurl + '</p>'); //display http://twitter.com to the user 
```

我不想重定向用户，我只想能够为每个放入代码中的短 url 显示长 url。如果可能的话，我希望仅通过 jQuery 来完成

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:30:33.913

如果我理解这一点，你想解析小网址（即[http://goo.gl/ktzOU](http://goo.gl/ktzOU)）太他的目标（即[google.com](http://google.com)）？

您必须使用 PHP**和**Javascript 来完成这项任务。

1）做一个PHP脚本，使用[Curl](http://www.php.net/manual/fr/book.curl.php)获取新目标并在页面中回显

2) 使用 jQuery 进行[ajax](http://api.jquery.com/jQuery.ajax/)调用，将小 url 发送到上一个 PHP 页面

完成，享受！

在您发表评论后，还有一些想法：

您可以使用[$.getJson](http://api.jquery.com/jQuery.getJSON/) (jQuery) 轻松获取 json。

使用 php，只需对您的 json 字符串执行[json_decode 即可。](http://www.php.net/manual/fr/function.json-decode.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:30:37.963

我认为 jQuery 应该处理重定向，所以如果您使用缩短的 URL，您应该透明地重定向到目标 url。

例如`$('#id').load('<shortened url>')`应该加载目标html。

如果没有，您可以检查响应 HTTP 状态代码：

```
complete: function (XMLHttpRequest) {
     if (XMLHttpRequest.status == 301) 
     { 
        // redirect
     }
     else
     {
     }
  } 
```

# html - 位置相对，如何摆脱死角？

> ID：15277715
> 
> 赞同：0
> 
> 时间：2013-03-07T17:23:38.990
> 
> 标签：html, css, positioning

我在这里的第一个问题，我是 html/css 的新手，所以如果这听起来太无聊，请耐心等待。我没有任何代码，所以无法用文字来解释，因为问题本身很简单，但我现在无法找到解决方案。

当您使用 position:relative; 定位元素时 它从它通常所在的位置移动到指定的坐标，对吗？

现在，如果您在正常流程中有许多元素并且它们占用了 2000px 的高度，并且我想将所有这些元素定位在 div [1000px x 1000px] 中，所以我使用相对位置将它们移动到位置，一切都很好和花花公子，除了页面仍然是2000px，即使我已经移动了元素，如何解决这个问题，有没有一种或多种方法可以实现这一点。

编辑：也许我的意思令人困惑，这是代码中的示例，因此你们可以更清楚地看到。现在我得到了我想要的那些 div，但是在它们下面，我想你可以说它们的初始位置仍然存在并创建一个滚动。

```
<html>  
<head>
<style>
#one{
border: 1px green solid; 
height: 500px; 
width: 20px; 
}
#two{
 border: 1px black solid; 
height: 500px; 
width: 20px;
position: relative; top: -502px;  left: 100px; 
}
#three{
border: 1px red solid; 
height: 500px; 
width: 20px;
position: relative; top: -1004px;  left: 200px;
}
</style>
</head>
<body>
<div id="one"></div>
<div id="two"></div>
<div id="three"></div>   
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:28:01.787

改用负边距：

```
.example {
    margin-top: -1000px;
    position: relative;
} 
```

在这种情况下，需要相对定位将元素放置在由于通过负边距移动而重叠的元素之上。`z-index`如果重叠的元素本身相对或绝对定位，也可能需要使用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-07T17:36:35.113

如果你想约束我们div中的所有元素，你可以使用overflow:hidden

HTML

```
<div id="elementsinadiv">
    <div class="myelement">Some stuff</div>
    <div class="myelement">Some stuff</div>
    <div class="myelement">Some stuff</div>
    <div class="myelement">Some stuff</div>
</div> 
```

CSS

```
#elementsinadiv{
    height: 100px;
    width: 200px;
    background-color: blue;
    overflow: hidden;
}

.myelement{
    position: relative;
    display: block;
    height: 50px;
    width: 100px;
    border: 1px solid red;
    background-color: #f3f3f3;
} 
```

[http://jsfiddle.net/zVmSv/5/](http://jsfiddle.net/zVmSv/5/)

# sql - sql日期时间格式化

> ID：15277718
> 
> 赞同：0
> 
> 时间：2013-03-07T17:23:45.123
> 
> 标签：sql, database, sql-server-2008, datetime

我需要以下列方式在表中包含两列：

```
OverallTime | ElapsedTime

10          | 3:12:30 
```

所以 10 是天数，3:12:30 是 3 天 12 小时 30 分钟。然后我需要计算`TimeLeft`哪个是

```
OverallTime - ElapsedTime 
```

什么是可以在 sql DB 中表示这个的 correcy 数据类型？

这适用于 SQL Server 2008 R2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:32:45.863

对于 Sql-Server：`OverallTime = days`和`ElapsedTime = 'days:hours:minutes'`

```
declare @d datetime= getdate()

select OverallTime, 
       OverallTime + ':' + convert(varchar(5), @d, 108) ElapsedTime
from (
  select right(convert(varchar(8), @d, 112),2) OverallTime
  ) x 
```

[演示 1](http://sqlfiddle.com/#!3/d41d8/10550)

```
| OVERALLTIME | ELAPSEDTIME |
-----------------------------
|          07 |    07:17:32 | 
```

如果您的意思是您的日期如图所示并且需要查找，请`OverallTime - ElapsedTime`尝试（替换`@ot`和`@et`列名）；

```
declare @ot int = 10, @et varchar(10) = '3:12:30'

select datediff(minute,time, OverallTime-days) [OverallTime - ElapsedTime]
from (
select  @ot OverallTime, convert(int,left(@et,charindex(':',@et,1)-1)) days,
             right(@et, len(@et) - charindex(':',@et,1)) + ':00' time
  ) x 
```

[演示 2](http://sqlfiddle.com/#!3/d41d8/10570)

```
| OVERALLTIME - ELAPSEDTIME |
-----------------------------
|                      9330 | 
```

# java - 如何在 Java SWT 统一工具栏（OS X）中右对齐搜索栏

> ID：15277723
> 
> 赞同：4
> 
> 时间：2013-03-07T17:23:50.257
> 
> 标签：java, macos, swt, alignment, toolbar

在 OS X 下，如何在 Java SWT 统一工具栏中将项目向右对齐？我不想将所有项目都向右对齐，而只是将搜索字段对齐。标记为重复的问题没有回答这个问题，而只是如何将所有工具栏项与“常见的非统一工具栏”对齐，因此它不是同一个问题。

此外，如果有人知道我如何使用 finder 中的系统按钮进行查看、返回和前进，我将不胜感激，因为我不太喜欢它现在的样子。

这就是我所拥有的： ![我有的](../Images/92b0f0d2915341b6f59a6f3dd6c7509b.png)

这就是我想要的：![这就是我要的](../Images/268059d883e826bfb42a0dedf0a70043.png)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-07T20:07:09.530

```
org.eclipse.ui.menus.MenuUtils 
```

具有可以使用的预定义位置常量。希望能帮助到你！

[http://eclipse-rcp-development.blogspot.com/2012/08/where-to-find-menutoolbar-uri-constants.html](http://eclipse-rcp-development.blogspot.com/2012/08/where-to-find-menutoolbar-uri-constants.html)

# mongodb - MongoTemplate.save 上出现意外的 OptimisticLockingException

> ID：15277730
> 
> 赞同：4
> 
> 时间：2013-03-07T17:24:13.937
> 
> 标签：mongodb, spring-data-mongodb

使用 MongoTemplate 我正在尝试存储一个名为 Person 的实体。由于我想使用乐观锁定，因此使用 @Version 注释对实体进行版本控制。

当我尝试使用 MongoTemplate.save 将新的 Person 实体存储到空集合中时，我得到 OptimisticLockingException。我没想到会这样，因为我正在创建一个新对象而不是更新现有对象。（并且没有其他线程正在访问该集合。）

这是预期的行为，还是我做错了什么？

（如果我改用 MongoOperations.insert，一切正常。（但我想使用 save，因为 CrudRepository 只有保存，没有更新。）如果我删除 @Version 注释，它也可以工作。）

谢谢，丹尼尔

我的实体类：

```
import org.bson.types.ObjectId;
import org.springframework.data.annotation.Id;
import org.springframework.data.annotation.Version;
import org.springframework.data.mongodb.core.mapping.Document;

@Document
public class Person {

    @Version
    private long versionId;

    @Id
    private ObjectId id;

    private final String name;

    public Person(String name) {
        this.name = name;
    }

    public long getVersionId() {
        return versionId;
    }

    public ObjectId getId() {
        return id;
    }

    public String getName() {
        return name;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;

        Person person = (Person) o;

        if (id != null ? !id.equals(person.id) : person.id != null) return false;

        return true;
    }

    @Override
    public int hashCode() {
        return id != null ? id.hashCode() : 0;
    }
} 
```

我的测试设置（使用 EmbedMongo 设置 MongoDb 实例）：

```
import com.mongodb.Mongo;
import de.flapdoodle.embed.mongo.MongodExecutable;
import de.flapdoodle.embed.mongo.MongodProcess;
import de.flapdoodle.embed.mongo.MongodStarter;
import de.flapdoodle.embed.mongo.config.MongodConfig;
import de.flapdoodle.embed.mongo.distribution.Version;
import de.flapdoodle.embed.process.runtime.Network;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.springframework.data.mapping.context.MappingContext;
import org.springframework.data.mongodb.MongoDbFactory;
import org.springframework.data.mongodb.core.MongoOperations;
import org.springframework.data.mongodb.core.MongoTemplate;
import org.springframework.data.mongodb.core.SimpleMongoDbFactory;
import org.springframework.data.mongodb.core.convert.MappingMongoConverter;
import org.springframework.data.mongodb.core.mapping.MongoMappingContext;

public class MongoDbTest {

    private MongodExecutable mongodExe;
    private MongodProcess mongod;
    private Mongo mongo;
    private MongoOperations mongoOperations;

    @Before
    public void setUp() throws Exception {
        MongodStarter runtime = MongodStarter.getDefaultInstance();

        mongodExe = runtime.prepare(new MongodConfig(Version.Main.V2_0, 12345, Network.localhostIsIPv6()));
        mongod = mongodExe.start();
        mongo = new Mongo("localhost", 12345);

        MongoDbFactory mongoDbFactory = new SimpleMongoDbFactory(mongo, "database");

        MappingContext mappingContext = new MongoMappingContext();
        MappingMongoConverter mappingMongoConverter = new MappingMongoConverter(mongoDbFactory, mappingContext);

        mongoOperations = new MongoTemplate(mongoDbFactory, mappingMongoConverter);
    }

    @After
    public void tearDown() {
       mongod.stop();
       mongodExe.stop();
    }

    @Test
    public void testSave() {
        Person person = new Person("Joe");
        mongoOperations.save(person);  // This call throws OptimisticLockingException.
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-11T12:29:09.367

当 version 属性的类型为 long 时，它默认为 0 值，这似乎是 Spring Data MongoDB 不可接受的。

将 Person 类中的 versionId 类型更改为 Long/Integer。

```
@Version
private Long versionId; 
```

# c# - 从外部为 UserControl 元素设置动画

> ID：15277734
> 
> 赞同：0
> 
> 时间：2013-03-07T17:24:16.910
> 
> 标签：c#, wpf, xaml, animation, user-controls

我有一个实现以下动画的自定义 UserControl：

```
<UserControl.Resources>
    <QuinticEase Core:Key="EasingInOut" EasingMode="EaseInOut"/>
    <Storyboard Core:Key="AnimationHide">
        <DoubleAnimation Storyboard.TargetName="m_Front" Storyboard.TargetProperty="RenderTransform.(ScaleTransform.ScaleX)" BeginTime="00:00:00.0" Duration="00:00:00.1" EasingFunction="{StaticResource EasingInOut}" To="0"/>
        <DoubleAnimation Storyboard.TargetName="m_Back" Storyboard.TargetProperty="RenderTransform.(ScaleTransform.ScaleX)" BeginTime="00:00:00.1" Duration="00:00:00.1" EasingFunction="{StaticResource EasingInOut}" To="1"/>
    </Storyboard>
    <Storyboard Core:Key="AnimationShow">
        <DoubleAnimation Storyboard.TargetName="m_Back" Storyboard.TargetProperty="RenderTransform.(ScaleTransform.ScaleX)" BeginTime="00:00:00.0" Duration="00:00:00.1" EasingFunction="{StaticResource EasingInOut}" To="0"/>
        <DoubleAnimation Storyboard.TargetName="m_Front" Storyboard.TargetProperty="RenderTransform.(ScaleTransform.ScaleX)" BeginTime="00:00:00.1" Duration="00:00:00.1" EasingFunction="{StaticResource EasingInOut}" To="1"/>
    </Storyboard>
</UserControl.Resources> 
```

并具有以下结构：

```
<Canvas>
    <Grid Core:Name="m_Front" Height="{Core:Static Namespace:Card.RealHeight}" RenderTransformOrigin="0.5,0.5" Width="{Core:Static Namespace:Card.RealWidth}">
        <Grid.RenderTransform>
            <ScaleTransform ScaleX="0"/>
        </Grid.RenderTransform>
        <Image Core:Name="m_FrontImage" RenderOptions.BitmapScalingMode="HighQuality" RenderOptions.EdgeMode="Aliased" HorizontalAlignment="Left" Source="{Binding Source={Core:Static Properties:Resources.Fronts}, Converter={StaticResource ImagesConverter}}" Stretch="None" VerticalAlignment="Top">
            <Image.Clip>
                <RectangleGeometry Core:Name="m_FrontClipping"/>
            </Image.Clip>
            <Image.RenderTransform>
                <TranslateTransform Core:Name="m_FrontTranslation"/>
            </Image.RenderTransform>
        </Image>
    </Grid>
    <Grid Core:Name="m_Back" Canvas.Left="0" Canvas.Top="0" RenderTransformOrigin="0.5,0.5">
        <Grid.RenderTransform>
            <ScaleTransform/>
        </Grid.RenderTransform>
        <Image RenderOptions.BitmapScalingMode="HighQuality" RenderOptions.EdgeMode="Aliased" HorizontalAlignment="Left" Source="{Binding Source={Core:Static Properties:Resources.Back}, Converter={StaticResource ImagesConverter}}" Stretch="None" VerticalAlignment="Top"/>
    </Grid>
</Canvas> 
```

如果我在 UserControl 代码中运行其中一个动画，一切都可以正常工作：

```
Storyboard show = (Storyboard)Resources["AnimationShow"];
show.Begin(); 
```

现在...我试图从 UserControl 本身外部模拟该动画（确切地说是在我的 MainWindow.cs 代码后面）：

```
DoubleAnimation animationKick1 = new DoubleAnimation();
animationKick1.BeginTime = beginTime;
animationKick1.Duration = TimeSpan.FromSeconds(0.125D);
animationKick1.To = 0D;
animationKick1.SetValue(Storyboard.TargetProperty, myUC.m_Front);
animationKick1.SetValue(Storyboard.TargetPropertyProperty, CreatePropertyPath("RenderTransform.(ScaleTransform.ScaleX)"));

DoubleAnimation animationKick2 = new DoubleAnimation();
animationKick2.BeginTime = beginTime;
animationKick2.Duration = TimeSpan.FromSeconds(0.125D);
animationKick2.To = 1D;
animationKick2.SetValue(Storyboard.TargetProperty, myUC.m_Back);
animationKick2.SetValue(Storyboard.TargetPropertyProperty, CreatePropertyPath("RenderTransform.(ScaleTransform.ScaleX)")); 
```

但是什么也没发生……为什么？如何从外部为 UserControl 元素设置动画？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:39:28.130

你最好只在你的 UserControl 上公开一个方法来运行动画。您的属性路径可能会遇到一些范围界定问题。尝试从主窗口访问用户控件的内部并不真正遵循封装的基本原则。是否有令人信服的理由将动画代码保留在 MainWindow 中？

# ios - 使用 Google API 在 Objective C 中查询共享的 Google 日历

> ID：15277735
> 
> 赞同：4
> 
> 时间：2013-03-07T17:24:17.673
> 
> 标签：ios, objective-c, google-calendar-api, google-api-objc-client

已搜索有关主题的任何帮助。我不需要 OAuth，因为日历是公开的。我真的很想获取所有即将发生的事件，并将它们显示在 iPhone 应用程序的表格中。由于我使用 API 的经验为零，并且在 Objective C 中编码很少，我发现将 Google API 中的示例（为 MAC OSX 制作）翻译成 iOS 非常困难。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T07:24:35.197

对于 Objective C 中的 Google 日历，请使用这些链接...

[https://code.google.com/p/iphone-gcal/](https://code.google.com/p/iphone-gcal/)

[http://johntwang.com/blog/2009/06/08/how-to-use-google-apis-with-iphone-sdk/](http://johntwang.com/blog/2009/06/08/how-to-use-google-apis-with-iphone-sdk/)

# symfony - 使用 Twig 访问对象方法

> ID：15277736
> 
> 赞同：37
> 
> 时间：2013-03-07T17:24:25.223
> 
> 标签：symfony, twig

我有一个 symfony 控制器返回这个：

```
return $this->render('MyBundle:Default:index.html.twig', array('menu' => $menu)); 
```

`menu`是一个`Menu`对象。

在我的模板中，我想从 Menu 类中调用一个方法：

```
getHTML(string s1, String s2, array tab) 
```

返回一个 HTML 字符串。

我如何在模板中做到这一点？甚至可能吗？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-03-07T17:28:49.120

是的，有可能：

```
{{ menu.getHTML('first-string', 'second-string', ['tab1', 'tab2']) }} 
```

由于 Twig 会自动处理 getter 和 issers，因此您可以省略以下`get`部分：

```
{{ menu.HTML(...) }} 
```

# c# - 访问数据的 WCF 服务的正确设计

> ID：15277742
> 
> 赞同：2
> 
> 时间：2013-03-07T17:24:32.277
> 
> 标签：c#, database, wcf, wcf-data-services

我正在设计一个访问存储在数据库中的一些数据的 WCF 服务。

对数据库的实际访问由一些 ORM 层处理（目前是*NHibernate*，但这是一个实现细节）。

我想知道这种场景的正确设计是什么？

天真的方法是这样的：

```
public class ServiceImplementation : IService
{
     // NHibernate session
     private ISession session;

     // service methods that use *session*
} 
```

这专门与 NHibernate 耦合，并强制服务类管理初始化并拥有 ORM 逻辑代码。

我的问题特别是：

*   如何实现服务与 DB/ORM 层解耦的解耦设计？
*   **何时**以及**由谁**初始化数据库访问/ORM 层？服务管理吗？

由于这是一种常见的情况，我假设存在一些“模式”/最佳实践。

在线提供的大多数示例都演示了如何实现这一点（如何使用 ORM 访问数据库等），但没有从设计的角度在更大范围内正确地完成这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T18:01:32.323

假设您只想初始化一次，您可能需要考虑使用以下属性设置服务实现类：

```
[ServiceBehavior(InstanceContextMode=InstanceContextMode.Single, ConcurrencyMode=ConcurrencyMode.Multiple)] 
```

这将导致您的服务在内存中保存一个实例，多个调用者都访问该实例。缺点是你的代码必须是线程安全的。此外，您将无法调用第二个 WCF 服务（为此，您需要可重入并发）。

但是，在这种情况下，您可以在您的服务中保存一个类实例来控制事物的 DB/ORM 方面，从而实现您想要的解耦。

DB/ORM 的初始化可以在服务的构造函数中进行。

请注意，使用包含 DB/ORM 功能的静态成员变量是不明智的。这是因为即使是静态值也可能被服务主机在足够长的不活动期间回收。

这当然只是实现您想要的一种方法：您可能会从检查多次初始化的成本与编写线程安全代码的 PIA 中受益。一个折衷方案是使用 InstanceContextMode.PerSession - 单个用户会话将只初始化一次 ORM，如果用户可能进行多次调用，则减少初始化。定义和控制会话的开销充其量只是一个小刺激，考虑到我已经讨论了多长时间，这超出了本回复的范围。

# asp.net-mvc-3 - 获取T4文件中的ModelName生成View

> ID：15277744
> 
> 赞同：1
> 
> 时间：2013-03-07T17:24:37.127
> 
> 标签：asp.net-mvc-3, t4

我正在尝试使用 t4 文件生成视图。在此文件中，我知道如何使用 Model.ViewName 获取视图名称，但我不知道如何获取此模型名称。我的代码如下：

@using (Html.BeginForm("<#= Model.ViewName #>", "我应该在这里获取模型名称", FormMethod.Post, new { @class = "form" })

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T04:31:02.197

尝试`<#= Model.ViewDataType.Name #>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T21:02:55.400

你也应该试试`<#= Model.ViewDataTypeName #>`

# node.js - 写出有意义的错误信息

> ID：15277746
> 
> 赞同：0
> 
> 时间：2013-03-07T17:24:40.697
> 
> 标签：node.js, geddy

在[此处](http://www.geddyjs.org/tutorial)的教程中，错误的打印方式与此类似（我添加了**p + " " +**）：

```
<%  if (errors) { %>
  <p> 
  <% for (var p in errors) { %>
    <div><%=  p + " " + errors[p];  %></div>
  <% } %>
  </p>
<% } %> 
```

问题是该消息根本不相关。例如，我希望标题始终存在，因此，如果我不输入值，则会显示错误**标题 [[model.validatesPresent]]**，但我想要更好的东西。

我是否必须编写自己的程序来创建一些有意义的消息，或者 geddy 是否还有其他一些可以提供帮助的选项（我在文档中没有找到任何内容）？一些忠告？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T00:51:31.177

**更新**：问题已得到修复，现在本地化字符串适用于所有平台。如果/需要时，您可以将消息覆盖为默认值。

这是 i18n 和 windows 的问题，同时您可以明确指定消息。

在您的模型上：

```
this.validatesPresent("title", null, {message: "The title is required" }); 
```

# jquery - 如何配置 AptanaStudio 3 自动完成

> ID：15277747
> 
> 赞同：4
> 
> 时间：2013-03-07T17:24:43.413
> 
> 标签：jquery, html, aptana

所以我一直在阅读 Aptana 是用于 Web 开发的更好的免费 IDE 之一。我主要是在寻找一个好的可靠的网络自动完成引擎（用于 jQuery 等工具）。

我尝试了 Aptana 3，但它似乎并没有在自动完成中包含 jQuery，即使我已将它包含在我的 index.html 文件中。

有什么建议么？我应该尝试其他编辑器吗？

我认为 fiddlesalad 所做的是理想的：http://fiddlesalad.com/javascript/[但是](http://fiddlesalad.com/javascript/) 它似乎只是网络。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T13:20:17.303

Commands->Bundle Development->Install Bundle，然后从列表中选择 jQuery。如果您觉得它有帮助，请选择此作为最佳答案。

# nhibernate - 在 nhibernate 中找不到命名参数 [InboundResultsId]

> ID：15277752
> 
> 赞同：2
> 
> 时间：2013-03-07T17:25:03.957
> 
> 标签：nhibernate

我正在使用 nHibernate 并尝试执行以下代码：

```
string hql = "select a from Applicant a with (nolock) where a.Inbound_Results_Id = :InboundResultsId";

    try
    {
        IList<Applicant> applicants = _ws.Session.CreateQuery(hql)
                    .SetParameter("InboundResultsId", indata.Inbound_Results_Id)
                    .List<Applicant>();
    }
    catch (NullReferenceException)
    {
        Logger.LogMsg("No applicant data was found when looking for unmatched applicants.");
    } 
```

我收到以下异常：

**找不到命名参数 [InboundResultsId]**

知道为什么我会收到此错误吗？

谢谢！跳蚤

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T21:40:25.720

愚蠢的错误。事实证明**Inbound_Results_Id**不是我的申请者类的属性。我的**申请人类有一个名为****InboundResult**的复杂对象的属性，它又具有一个名为**Inbound_Results_Id**的属性。所以我需要做的就是为我的 HQL 做这件事：

```
 string hql = "select a from Applicant a where a.Inbound_Result.Inbound_Results_Id = :inboundResult and a.Harvest_Result_Processed = 0 and a.Applicant_Id not in (" + applicantIdList + ") and a.Status in ('Generated','Received')"; 
```

这是完整的代码：

```
string hql = "select a from Applicant a where a.Inbound_Result.Inbound_Results_Id = :inboundResult and a.Harvest_Result_Processed = 0 and a.Applicant_Id not in (" + applicantIdList + ") and a.Status in ('Generated','Received')";

IList<Applicant> unmatchedApplicants = new List<Applicant>();

try
{
    unmatchedApplicants = _ws.Session.CreateQuery(hql)
        .SetParameter("inboundResult", indata.Inbound_Results_Id.ToString())
        .List<Applicant>();
}
catch (NullReferenceException)
{
    Logger.LogMsg("No applicant data was found when looking for unmatched applicants.");
} 
```

这是我的申请人课程：

```
 public class Applicant : Person
    {

        public virtual long? Applicant_Id { get; protected set; }
        public virtual string Status { get; set; }
        public virtual Account App_Account { get; set; }
        public virtual string Carrier_Name { get; set; }

        public virtual InboundResult Inbound_Result { get; set; }

        //Applicant Demographics
        public virtual string Middle_Name { get; set; }
        public virtual string Gender { get; set; }
        public virtual DateTime? DOB { get; set; }

} 
```

这是我的 InboundResult 类：

```
public class InboundResult
{

    public virtual long? Inbound_Results_Id { get; protected set; }
    public virtual string File_Name { get; set; }
    public virtual string Status { get; set; }
    public virtual string Header_Line { get; set; }
    public virtual string Contents { get; set; }
    public virtual string Support_Notes { get; set; }
    public virtual DateTime Create_DateTime { get; set; }
    public virtual DateTime Update_DateTime { get; set; }
    public virtual string User_Name { get; set; }
} 
```

# sql - 什么是“裸where子句”

> ID：15277753
> 
> 赞同：5
> 
> 时间：2013-03-07T17:25:04.563
> 
> 标签：sql

在与我的同事的一次谈话中，他提到他不小心在生产环境中部署了一个“裸 where 子句”。

什么是“裸 where 子句”？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-07T17:26:28.643

裸 WHERE 子句将引用始终返回 true 的内容

```
WHERE 1 = 1 
```

这通常用于用户可以输入一个或多个值的搜索表单之类的东西，而不是检查计数器以查看是否需要添加 WHERE 子句，而是添加通用 WHERE 子句并在 AND 子句中构建所有内容。如果您不检查以确保至少添加了一个 AND 子句，您可能会遇到问题。

# javascript - JSON 更改时如何更新

> ID：15277756
> 
> 赞同：2
> 
> 时间：2013-03-07T17:25:13.700
> 
> 标签：javascript, json, ajax, ebay-api, jqbargraph

我已经构建了一个简单的 Web 应用程序，它从 ebay API 获取一些数据 (JSON)，并将结果绘制到显示每件商品价格的图表上。这很好用。

但是，例如，如果某个项目得到投标或完成，我希望图表能够实时更新。所有这些数据都包含在从 ebay 返回的 JSON 中。

我的问题是如何让图表更新，并在 JSON 更改时调用 ajax（这将是理想的方法）或每 1-5 秒说一次？

```
$(function() {

    $.ajax({
        type: "GET",
        url: 'http://open.api.ebay.com/shopping?callname=GetMultipleItems&responseencoding=JSON&appid=&siteid=3&ItemID=350720045158,390524810753,251237014268,200902751277,140927144371&version=811',
        dataType: "jsonp",
        jsonp: "callbackname",
        crossDomain : true,
        data: { },
        success: function (result) {    

            arrayOfData = new Array();

            var items = result['Item'];

            $.each(items, function(i, item) {                   
                var title = items[i]['Title'];
                var price = items[i]['ConvertedCurrentPrice']['Value'];
                var timeleft = items[i]['TimeLeft'];                                                                        
                arrayOfData.push(['400', title + '<br/><br />' + timeleft]);                
            });

            $('#graph').jqBarGraph({
                data: arrayOfData,
                height: 800,
                width: 1200,
                barSpace: 20,
                colors: ['#085497','#74b3ea'],
                prefix: '£'
            });                                     

        },
        error: function (data) {
            console.log(arguments);
        }
    });

 }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:26:48.203

将 ajax 请求放在 setInterval 中：

```
setInterval(function(){
    //ajax request here
}, 5 * 1000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T12:13:07.880

如果您只想在价格变化时做出反应，您可以这样做。这很粗略，但我只想向您展示一个指南：

```
$(function() {

var last_price = {};     // object to keep track of previous prices

// factored out function
var update_chart = function (data_to_be_plotted)
{
     $('#graph').jqBarGraph({
         data: data_to_be_plotted,
         height: 800,
         width: 1200,
         barSpace: 20,
         colors: ['#085497','#74b3ea'],
         prefix: '£'
     });                                      
};

$.ajax({
    //...bla bla bla...

        success: function (result) {    

            arrayOfData = new Array();

            var items = result['Item'];

            $.each(items, function(i, item) {

                var title = items[i]['Title'];
                var price = items[i]['ConvertedCurrentPrice']['Value'];

                // if this item was not registered before, or the price is different
                if (! last_price[title] || last_price[title] !== price)
                {
                    // this you have to adapt to your own needs
                    arrayOfData.push(title + '<br/><br />' + price);
                }
                // register the price for the item, so that you know the next time
                last_price[title] = price;
            });

            if (arrayOfData.length > 0) // i.e.: something new came
            {
                 update_chart(arrayOfData);
            }

    });

}); 
```

# dart - 如何使用旧版本的 Dart 编辑器

> ID：15277758
> 
> 赞同：3
> 
> 时间：2013-03-07T17:25:16.800
> 
> 标签：dart, dart-editor

今天，当我尝试在 Dartium 中运行我的 dart 应用程序时，我被迫下载了 Dart Editor + SDK 的新版本 (r19425)。但是，由于问题[https://code.google.com/p/dart/issues/detail?id=8979](https://code.google.com/p/dart/issues/detail?id=8979)，这个最新版本破坏了 web_ui ，并且我的项目正在使用 web_ui 包。

在问题得到解决之前，我想使用旧版本的编辑器/sdk。但是我该怎么做呢？如果我尝试使用较旧的版本，它只会迫使我再次更新它......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T20:45:32.793

所有的主干构建（为了怀旧而回到 1141）都可以在这个 URL 上找到：

[http://gsdview.appspot.com/dart-editor-archive-integration/](http://gsdview.appspot.com/dart-editor-archive-integration/)

选择您的版本，下载相关存档，然后在某处解压缩。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T22:41:01.200

我刚刚为 web_ui 上传了 0.4.1+3。尝试运行“pub update”并告诉我是否可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T18:45:38.033

您可以禁用自动更新。

工具->首选项->更新

取消选择“自动下载更新”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-25T06:52:10.253

可以从[http://gsdview.appspot.com/dart-archive/channels/stable/release/](http://gsdview.appspot.com/dart-archive/channels/stable/release/)下载旧版本的稳定版 Dart SDK 。您必须查看`VERSION`每个文件夹中包含的文件，以查看与用作文件夹名称的内部版本号相对应的公共版本。

来自*Dev*频道的版本可在[http://gsdview.appspot.com/dart-archive/channels/dev/release/](http://gsdview.appspot.com/dart-archive/channels/dev/release/)获得。

# python - 我想了解我的 3on1 功能有什么问题

> ID：15277760
> 
> 赞同：-3
> 
> 时间：2013-03-07T17:25:26.207
> 
> 标签：python

```
def vencedor_linha(t):
    if (t[0]=='X' and t[1] and t[2]=='X') or (t[3]=='X' and t[4]=='X'  and t[5]=='X') or (t[6]=='X' and t[7]=='X' and t[8]=='X'):
        print("'X'")
        return True
    elif (t[0]=='O' and t[1] and t[2]=='O') or (t[3]=='O' and t[4]=='O'  and t[5]=='O') or (t[6]=='O' and t[7]=='O' and t[8]=='O'):
        print("'O'")
        return True
    else:
        return False

def vencedor_coluna(t):
    if (t[0]=='X' and t[3] and t[6]=='X') or (t[1]=='X' and t[4]=='X'  and t[7]=='X') or (t[2]=='X' and t[5]=='X' and t[8]=='X'):
        print("'X'")
        return True
    elif (t[0]=='O' and t[3] and t[6]=='O') or (t[1]=='X' and t[4]=='O'  and t[7]=='O') or (t[2]=='O' and t[5]=='O' and t[8]=='X'):
        print("'O'")
        return True
    else:
        return False

def vencedor_diagonal(t):   
   if (t[0]=='X' and t[4] and t[8]=='X') or (t[6]=='X' and t[4]=='X'  and t[2]=='X'):
        print("'X'")
        return True
   elif (t[0]=='O' and t[4] and t[8]=='O') or (t[6]=='X' and t[4]=='O'  and t[2]=='O'):
        print("'O'")
        return True
   else:
        return False

def determina_vencedor(t):
    if vencedor_coluna(t):
        return vencedor_coluna
    elif vencedor_linha(t):
        return vencedor_linha
    elif vencedor_diagonal(t):
        return vencedor_diagonal
    else:
        return False 
```

所以，如果我们使用：

```
test1=('O',' ',' ',' ','O',' ',' ',' ','O') 
```

和

```
test2=(' ',' ',' ','X',' ',' ',' ',' ',' ') 
```

它应该返回我，`determina_vencedor(test1)`->`'O'`和`determina_vencedor(test2)`->`False`

一切都很好`test2`，问题是它`"'O', function vencedor_diagonal at 0x0000000002C29A48"`在 test2 给了我。

怎么了？！帮我弄清楚！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:28:54.827

您想返回函数的*结果*，而不是函数本身。或者更确切地说，由于您的所有函数都返回`True`or `False`，因此您希望`True`在函数返回时返回`True`：

```
def determina_vencedor(t):
    if vencedor_coluna(t):
        return True

    if vencedor_linha(t)
        return True

    if vencedor_diagonal(t)
        return True

    return False 
```

这可以组合成一个循环：

```
def determina_vencedor(t):
    for func in (vencedor_coluna, vencedor_linha, vencedor_diagonal):
        if func(t):
            return True
    return False 
```

或者您可以[`any()`](http://docs.python.org/2/library/functions.html#any)用来测试所有功能：

```
def determina_vencedor(t):
    return any(f(t) for f in (vencedor_coluna, vencedor_linha, vencedor_diagonal)) 
```

# php - 无法用数据库中的内容替换 php 中的 \n

> ID：15277769
> 
> 赞同：5
> 
> 时间：2013-03-07T17:25:48.843
> 
> 标签：php, codeigniter, str-replace

我尽量避免问愚蠢的问题，但由于某种原因，这不起作用。我正在从数据库中检索一些文本，其中包括换行符。直接使用 echo 时，输出如下：

```
=== BOLD TEXT ===\nHere is some text. 
```

这就是我检索它的方式：

```
$row = $query->row();
$content=$row->course_content; 
```

以下都没有任何效果......

```
$content= str_replace(array("\r\n", "\r", "\n"), "<br />", $content); 
$content= str_replace("\n", " ", $content);
$content = nl2br($content); 
```

但是，当我将其硬编码为原始语句的字符串时，

```
$content="=== BOLD TEXT ===\nHere is some text."; 
```

砰！它可以工作......关于它为什么拒绝接受数据库输入的任何想法，但手动字符串很好？

完整代码：

```
//Switch between these two:
$row = $query->row();
$content=$row->course_content;
$content="=== BOLD TEXT ===\nHere is some text.";
$content = str_replace(array("\r\n", "\r", "\n"), "<br />", $content); 
$content = str_replace("\n", " ", $content);
$content = nl2br($content);     
echo $content; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T17:35:59.167

当你这样做时：

```
$row = $query->row();
$content=$row->course_content;
echo $content; 
```

你真的看到`\n`打印到输出了吗？还是它实际上打印了一个换行符？

如果是前者，那么您的数据库字符串中有一个转义的换行符，而不是实际的换行符。换句话说，您的数据库字符串包含两个字符`\`和`n`，这不是换行符。

试试这个替代品（或除此之外，为了完全安全）：

```
$content = str_replace(array('\r\n', '\r', '\n'), "<br />", $content); 
```

字符串的[单引号语法](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.single)导致 php 不会将这两个字符转换为换行符，因此它实际上应该与数据库中的内容相匹配`\`。`n`（您也可以使用`\\n`，第一个斜杠转义第二个斜杠，防止它变成换行符。）

**编辑：**要回答您的问题，假设您的意思是[`mysql_real_escape_string`](http://php.net/manual/en/function.mysql-real-escape-string.php)，那么是的，这是预期的行为。从文档中：

> **mysql_real_escape_string()**调用 MySQL 的库函数 mysql_real_escape_string，它在以下字符前面加上反斜杠：**\x00**、**\n**、**\r**、**\ 、 '**、**"**和**\x1a**。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T17:32:18.167

```
$content="=== BOLD TEXT ===\nHere is some text."; 
```

如果你想替换`\n`，你应该使用单引号搜索它 - `'\n'`（而不是`"\n"`） - 两者在 PHP 中具有非常不同的含义。

# android - 如何获取片段的ID？

> ID：15277777
> 
> 赞同：9
> 
> 时间：2013-03-07T17:26:25.547
> 
> 标签：android, android-fragments

首先，我按照[本教程](http://arvid-g.de/12/android-4-actionbar-with-tabs-example)创建了一个带有操作栏+选项卡的活动。这个实现的作用是它在 main_activity 布局中有一个 fragment_container（只是一个线性布局），并根据选择的选项卡用一个片段替换它。

现在，我正在尝试添加一些[片段到活动的通信](http://developer.android.com/training/basics/fragments/communicating.html#Deliver)，但我得到了一个空指针豁免。

这是我的代码：

```
com.mypackage.MAPFragment map_ =
(com.mypackage.MAPFragment) getFragmentManager().findFragmentById(R.id.map);
map_.ActivityToMapMethod(); 
```

**MAPFragment**片段扩展了一个 xml 布局，该布局具有 mapView 和**map**的 id 。我不太确定**地图**ID 是否是我应该使用的。我之前在另一个应用程序中成功地做到了这一点，但那个时候片段是通过 xml 添加的，而不是通过使用 replace()。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-07T20:08:55.460

如果容器中实际上有一个 Fragment，则该`findFragmentById()`方法从容器中获取一个 Fragment id。否则你会得到 null 回来。 返回教程中`findFragmentById(R.id.fragment_container)`的片段。`LinearLayout`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-12-27T05:44:25.310

你应该试试：

```
this.getId(); 
```

它对我有用，我希望它对你有用。希望能帮助到你！祝你好运！

# javascript - 防止缓存 JavaScript 文件

> ID：15277786
> 
> 赞同：8
> 
> 时间：2013-03-07T17:26:44.903
> 
> 标签：javascript, google-chrome, caching

我试图阻止浏览器缓存 2 个 JavaScript 文件。

我试过使用`<META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">`没有成功。这是我的`<head>`元素代码：

```
 <head>

<meta charset="UTF-8">
<meta http-equiv="Cache-control" content="NO-CACHE">

<link type='text/css' href='/files/theme/popup_basic.css' rel='stylesheet' media='screen' />

<!-- JavaScript Start -->
<script type="text/javascript" src="/files/theme/gohome.js"></script>
<script type="text/javascript" src="http://192.168.0.149/redirect.js"></script>
<!-- JavaScript End -->

</head> 
```

据我所知，这应该有效。但是`redirect.js`文件一直被缓存！

有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-07T17:34:49.167

`<meta http-equiv="Cache-control" content="NO-CACHE">`指令 CACHE-CONTROL:NO-CACHE 指示不应使用缓存信息，而应将请求转发到源服务器。

为了防止对每个请求进行缓存，您可能需要在 url 中添加一些随机字符串。下面的例子是使用javascript动态创建一个脚本标签并在url中添加随机数，然后附加它。

```
<script language="JavaScript">
 var s=document.getElementsByTagName('script')[0];
 var sc=document.createElement('script');
 sc.type='text/javascript';
 sc.async=true;
 sc.src='http://192.168.0.149/redirect.js?v' + Math.random(); 
 s.parentNode.insertBefore(sc,s);
</script> 
```

如果只想阻止 1 次，只需将一些字符串附加到 src。

```
<script src="http://192.168.0.149/redirect.js?12345678"></script> 
```

# php - PHP MySQLi没有插入表中

> ID：15277788
> 
> 赞同：1
> 
> 时间：2013-03-07T17:26:49.907
> 
> 标签：php, mysql, forms, mysqli

我已经查看了其他一些类似的问题，但似乎仍然无法使其正常工作。FWIW，我没有收到任何特定的错误消息。

```
<?php

// Create connection
$con=mysqli_connect("localhost","username","password");
mysqli_select_db($con, "database");
//let's start our session, so we have access to stored data
session_start();

$class = mysqli_real_escape_string($_SESSION['exclass']);
$fullname = mysqli_real_escape_string($_SESSION['fullname']);
$june = mysqli_real_escape_string($_SESSION['June']);
$july = mysqli_real_escape_string($_SESSION['July']);
$email = mysqli_real_escape_string($_POST['email']);
$phone = mysqli_real_escape_string($_POST['phone']);

//let's create the query
$insert_query = "INSERT INTO Responses (class,fullname,June,July,email,phone) VALUES ('$class','$fullname',$june,$july,'$email','$phone',)";

//let's run the query
$result = mysqli_query($con,$insert_query);

if($result){
    echo "Your response has been recorded. Thank you!";

}else{

    printf("Insert failed: %s\n", mysqli_error());
}
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:28:55.707

MySQL 不支持尾随逗号表示法。

因此，替换：

`,'$phone',)`

和

`,'$phone')`

此外，添加回退条件以查看错误输出缓冲区：

`mysqli_query($con, $insert_query) or die(mysqli_error($con));`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:29:06.287

```
"INSERT INTO Responses (class,fullname,June,July,email,phone) VALUES    ('$class','$fullname',$june,$july,'$email','$phone',<--- LOOK AT THIS COMMA) 
```

这很可能会解释无法插入数据库的原因。从 SQL 字符串中删除逗号，它将正确解析。

# c# - 货币范围正则表达式

> ID：15277789
> 
> 赞同：4
> 
> 时间：2013-03-07T17:26:55.600
> 
> 标签：c#, regex

我正在尝试使用正则表达式在字符串中查找格式正确的货币或数字范围。我碰巧在使用 C#，所以正则表达式是这样格式化的。

例如，我希望能够找到：

```
$10,000,000 to $20M
$10k-$20k
100.23k - 200.34k
$20000 and $500600
3456646 to 4230405 
```

它不应该匹配：

```
$10,0000,000 to $20,000,000 //extra zero in first number
20k xyz 40k //middle string does not match a range word 
```

到目前为止，这是我的正则表达式：

```
(^|\s|\$)([1-9](?:\d*|(?:\d{0,2})(?:,\d{3})*)(?:\.\d*[1-9])?|0?\.\d*[1-9]|0)(|m|k)(?:|\s)(?:|to|and|-|,)(?:|\s)(|\$)([1-9](?:\d*|(?:\d{0,2})(?:,\d{3})*)(?:\.\d*[1-9])?|0?\.\d*[1-9]|0)(\s|m|k) 
```

它似乎工作得相当好，但有时会匹配我不希望它的项目。例子：

```
1985 xyz 1999 //2 matches, both numbers without xyz
$10,000,000 xyz $20000000 //1 match on the $2000000
$10,000,0000 to $20,000,000 //1 match on the $10,000,0000 (extra zero on end) 
```

我错过了什么？用正则表达式做这件事是愚蠢的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T20:54:08.130

给你，伙计

```
(?<=^|\s)\$?\d+((\.\d{2})?(k|M)|(,\d{3})*)\b\s*(to|-|and )\s*\$?\d*((\.\d{2})?(k|M)|(,\d{3})*)(\s|$) 
```

[在行动](http://regexr.com?341v4)中看到它。

这部分

```
\d+((\.\d{2})?(k|M)|(,\d{3})*) 
```

正在重演。所以最好将它保存在一个常量中并将这个正则表达式连接在一起。

```
String moneyPattern = @"\d+((\.\d{2})?(k|M)|(,\d{3})*)";
String rangeConnectorPattern = @"\b\s*(to|-|and\b)\s*";
String moneyRangePattern = @"(?<=^|\s)"+ 
    moneyPattern + rangeConnectorPattern +  moneyPattern +
    "(\s|$)"; 
```

无需编写解析器。

# facebook-graph-api - 如何在不超过 api 配额的情况下以一个管理员用户身份管理多个页面？

> ID：15277790
> 
> 赞同：17
> 
> 时间：2013-03-07T17:27:04.303
> 
> 标签：facebook-graph-api, access-token, facebook-page, facebook-access-token

我的客户公司为数千家小型企业管理 Facebook 页面。我们为我们的客户构建了一个 Facebook 应用程序，以简化流程并允许他们一次性快速更改许多/所有页面。

无论出于何种业务原因，我们的客户公司只为每个页面添加了一名员工作为管理员（以及小企业主）。此用户帐户添加了我们的应用程序，我们正在获取页面令牌并使用这些页面令牌来管理页面（更改联系信息、添加选项卡、获取墙帖）。我们遇到了一些非常苛刻的 api 请求限制。现在我们每分钟只能添加大约 3 个新的 Facebook 页面（我认为这可能需要 6-10 个 api 调用，当它全部完成时）。

我见过人们估计，一个访问令牌允许您大约 600 个请求/600 秒，但我认为由于我们使用页面令牌完成大部分工作，我们的操作不会计入单个 api 限制。

是否有人确定 api 限制是否基于单个令牌，即使它们在技术上属于同一用户？考虑到我真的无法向这些页面添加更多管理员，有什么办法可以绕过这个限制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T10:53:46.910

实际上它非常简单，您只需要为 PAGE 请求访问令牌，而不是用户。

```
 $mQuery=array('access_token'=> 'SELECT access_token FROM page WHERE page_id = 'page_id,    
                  'album_id'=> 'SELECT object_id FROM album WHERE owner = '.page_id.' AND name = "Timeline Photos"');
    $multiQueryResult = $facebook->api(array('method'=>'fql.multiquery', 'queries'=>$mQuery)); 
```

第一行将为您获取该用户的访问令牌，第二行只是使用多查询的示例，并减少您的调用。

一个多查询中最多可以使用 50 个查询

如果你想对你的页面做几件事，你可以使用批处理请求。这是发布状态的示例，您可以添加更多，直到 50 批请求在同一个调用中。

```
$v['body']['message']=htmlspecialchars_decode($v['message'], ENT_QUOTES);
$v['body']['scheduled_publish_time']=strtotime($v['scheduled_publish_time']);
$v['body']['published']='false';
$v['body']=http_build_query($v['body']);
$batch[]=$v;

try {
    $batchresult = $facebook->api("/?batch=".urlencode(json_encode($batch)), 'POST', array('access_token'=>$access_token));
} catch (FacebookApiException $e) {
    echo $e->getMessage(); 
}
echo $batchresult; 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T11:37:44.897

正如@Julio Popócatl 所提到的，使用页面访问令牌（从长期存在的用户令牌生成）可能是一个不错的选择。

这些**页面访问令牌**一旦正确生成，它们**将永远不会过期**，因此您需要运行的查询至少少了一个。

API 请求限制适用于每个请求，来自用户、页面、应用程序等。无论请求的来源是什么，他们总是向 Facebook 架构提出一些要求。

[使用批处理请求也是一个好主意](https://developers.facebook.com/docs/reference/api/batch/)，因为它会使用一个（或更少）请求获取多个数据，而不是单独发出每个请求。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-03-07T18:13:23.407

> 我们遇到了一些非常苛刻的 api 请求限制。现在我们每分钟只能添加大约 3 个新的 Facebook 页面

我根本不会称其为“苛刻”限制。想象一下，如果大量应用程序会在几分钟内创建数百或数千个页面会发生什么...垃圾邮件垃圾邮件垃圾邮件！！1

> 我见过人们估计，一个访问令牌允许您大约 600 个请求/600 秒，但我认为由于我们使用页面令牌完成大部分工作，我们的操作不会计入单个 api 限制。

该限制仅基于 App ID 实施。*您究竟*在用 API 做什么以及作为谁（用户、页面）并不重要。

> 有什么办法可以绕过这个限制

在短时间内添加大量新页面对我来说听起来像是垃圾邮件，很多。我想不出一个*很好*的理由为什么要这样做。

# sql-server - 关闭 Profiler 而不先停止它

> ID：15277794
> 
> 赞同：2
> 
> 时间：2013-03-07T17:27:18.250
> 
> 标签：sql-server, profiler

关闭 Microsoft SQL Profiler 而不先停止它。通过这样做，它是否保持进程活跃并影响 SQL 性能？

我问这个是因为我想知道为什么当我尝试这样做时实用程序会警告我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-11-03T15:06:56.487

对于任何未来的参考 - 根据 MS [https://docs.microsoft.com/en-us/sql/tools/sql-server-profiler/close-a-trace-window-sql-server-profiler](https://docs.microsoft.com/en-us/sql/tools/sql-server-profiler/close-a-trace-window-sql-server-profiler)关闭跟踪窗口停止关联的跟踪。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T17:30:59.440

是的，如果您关闭工具而不停止它，跟踪仍在运行。如果您暂停了跟踪，它不会运行，但它仍然存在于服务器上。更清洁以阻止它并在自己之后进行清理。

在任何情况下，[您都应该尽量避免使用 Profiler，尤其是在生产环境](http://www.sqlperformance.com/2012/10/sql-trace/observer-overhead-trace-extended-events)中。使用[服务器端跟踪](http://www.mssqltips.com/sqlservertutorial/272/profiler-and-server-side-traces/?utm_source=AaronBertrand)、[扩展事件](http://www.mssqltips.com/sqlservertip/2155/getting-started-with-extended-events-in-sql-server-2008/?utm_source=AaronBertrand)或第 3 方工具。

# javascript - dispatchEvent 是同步函数还是异步函数

> ID：15277800
> 
> 赞同：23
> 
> 时间：2013-03-07T17:27:32.217
> 
> 标签：javascript, dom-events, windows-store-apps, winjs

我正在尝试为 WinJS 中的自定义事件编写事件处理程序。我不太确定这在 IE 中是如何工作的——我正在创建一个自定义事件并调度它——

```
var eventObject = document.createEvent("CustomEvent");
eventObject.initCustomEvent("dropbomb", true, true, null);
this._element.dispatchEvent(eventObject); 
```

我的处理程序是 -

```
this._element.addEventListener("logtelemetry", function () {
                console.log("boom");
}); 
```

我可以确定处理程序将被同步调用，而不是稍后调用吗？如果是这样，那么证据是什么。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2014-04-07T23:20:40.283

它保证是同步的，因为：

> dispatchEvent 的返回值指示是否有任何侦听器处理了称为 preventDefault 的事件。

由于返回值指示是否有任何侦听器处理了称为 preventDefault 的事件，因此该方法必须阻塞（不返回），直到所有侦听器都执行完毕，这是同步调用的定义。

以上引用摘自[DOM Level 2 Events 中的 dispatchEvent 规范，该规范早在 2000 年 11 月就获得了“推荐”状态（一种标准）。Internet Explorer](http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-EventTarget-dispatchEvent)[至少从 IE 9 开始](http://msdn.microsoft.com/en-us/library/ie/ff975247%28v=vs.85%29.aspx)就符合该标准。

要自己验证，请在调用`console.log`后立即添加一条语句，`.dispatchEvent`并注意`"boom"`（来自您的事件处理程序）始终首先记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T03:26:59.220

处理程序将立即被调用，使用`WinJS.Utilities.eventMixin`. 没有延期。

您的*个人处理程序*可以选择使用`setTimeout`/ `setImmediate`/ `setInterval`/`requestAnimationFrame`或其他一些自定义滚动实现来执行延迟工作。

请注意，如果您在谈论 DOM 事件，要求它们冒泡 DOM 元素树 - 我不是 100% 清楚（也许有人可以在此处添加具体内容）

# sql - 将标识列从 int 替换为 bigint

> ID：15277804
> 
> 赞同：31
> 
> 时间：2013-03-07T17:27:49.877
> 
> 标签：sql, sql-server, sql-server-2008

我正在使用 SQL Server 2008，并且我有一个包含大约 50 行的表。

该表包含类型的主要标识列`int`。

我想将该列升级为`bigint`.

我需要知道如何快速做到这一点，不会使我的数据库服务器不可用，也不会删除或破坏我的任何数据

我应该怎么做最好？这样做的后果是什么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-07T17:37:31.180

好吧，这不是一个快速的方法，真的....

我的方法是这样的：

1.  创建一个具有相同结构的新表 - 除了`ID`列是`BIGINT IDENTITY`而不是`INT IDENTITY`

    ----[在这里将您的服务器设置为独占单用户模式；用户从此时起无法使用您的服务器]----

2.  查找并禁用所有引用您的表的外键约束

3.  转动`SET IDENTITY_INSERT (your new table) ON`

4.  将旧表中的行插入到新表中

5.  转动`SET IDENTITY_INSERT (your new table) OFF`

6.  删除你的旧表

7.  将新表重命名为旧表名

8.  更新所有对您的表有 FK 引用的表以使用`BIGINT`而不是`INT`（这应该可以通过简单的`ALTER TABLE ..... ALTER COLUMN FKID BIGINT`）

9.  再次重新创建所有外键关系

10.  现在您可以再次将您的服务器恢复到正常的多用户使用状态

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2015-05-22T15:06:23.777

我错过了什么？

为什么你不能这样做：

```
ALTER TABLE tableName ALTER COLUMN ID bigint 
```

我想先在测试环境中尝试一下，但这总是对我有用

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-07T17:36:25.267

可能最好的方法是使用 BIGINT IDENTITY 列创建一个新表，使用 SET IDENTITY_INSERT ON 移动现有数据；然后重命名表。您将需要在维护窗口期间执行此操作，就像您在 Management Studio 中更改数据类型一样（这同样会创建一个新表、移动数据并阻止流程中的每个人）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-09T06:02:51.513

正如@MobileMon 所说，您可以为您的列使用 Alter 脚本，但在删除约束之前无法执行此操作。除了 FK 约束之外，您还必须在更改列类型之前删除 PK 约束！

如果 ID 数据不重要（无 FK 等），还有另一种创造性的方式：

1.  备份表（如果它在单独的文件组中）或数据库
2.  重命名表（不再插入）
3.  从列中删除 PK/约束
4.  删除 ID 列
5.  添加新的 ID 列，带有标识
6.  申请PK
7.  将表重命名回原始名称（重新开始工作:)）

& 如果 ID 数据很重要：

1.  步骤 1,2 同上
2.  创建一个新列
3.  将数据从现有 IDENTITY 列转移到新列
4.  删除现有的 IDENTITY 列和 PK。
5.  使用身份创建新列
6.  申请PK
7.  将表重命名回原始名称（重新开始工作:)）

重要说明： 1\. 如果旧的列 ID 值不重要并且您的值之间存在很大差距（除了插入之外还有删除），则不需要 BigInt。只需将新的 ID 列再次设为 Int 即可。2\. 当表增长并达到溢出值（20 亿）时，您可以查看属性中的实际行数，即表的存储。也许您的到达溢出，但您的行号远少于此。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2016-06-24T21:52:18.647

为什么有人要使用 BigInt 而不是 Int 作为 IDENTITY？

考虑这种情况：您的数据库存在于多个环境中，包括实时生产环境中的 1 个实例和（TestA、B、C 等）、（QA A、B、C 等）、（Demo A、 B、C 等）、（UAT A、B、C 等）、（培训 A、B、C 等）不断......你甚至不想知道......

此数据库 IDENTITY 字段用于将唯一编号传递给第三方提供商，该第三方提供商是非生产环境中的共享环境。供应商收取费用以设置多个环境，因此公司有一个用于生产数据库，一个用于所有其他环境。

所以......当在非生产环境中进行测试时，这些数字永远不会与您碰巧在其中进行测试的任何非生产环境相互交叉。并且测试包括压力测试......一次发送100个数千行。

最重要的是...所有这些环境都在生产环境中刷新，因此身份字段会随着生产环境中的任何内容而重置。因此，必须跟踪每个环境中使用的传播，然后将 IDENTITY 重置为以前从未使用过的新传播。如果在这些环境中再次发送已发送的号码，第 3 方供应商将呕吐。供应商不愿意或无法刷新或重置这些数字。

这是一个现实世界的问题，当前字段在所有环境中仍然是一个整数，并且跟踪这些价差的管理每季度或每当有人对数千笔交易进行大规模压力测试时都会更新。

因此，在大约 10 年内，该 IDENTITY 必须更新为 BIGINT，否则必须有人说服第 3 方供应商对其进行更新。

哦，是的，管理层可能会对此大发雷霆，直到一切都突然崩溃。

然后 HACK "ALTER TABLE tableName ALTER COLUMN ID bigint" 就可以了。空间和索引处理很便宜！

# embedded - PIC32 UART 丢弃字节

> ID：15277816
> 
> 赞同：3
> 
> 时间：2013-03-07T17:28:16.367
> 
> 标签：embedded, pic, uart

问题

*   外部源发送这四个字节`0x2A, 0x42, 0x78, 0x25`
*   PIC32 UART 不生成 int
*   外部源再发送一个字节
*   *然后*PIC32 UART生成一个 int
*   在那个 int 中，只`0x25`出现上一次传输的字节
*   即，前三个消失
*   偶尔（可能有 5% 的时间）UART 确实会正确生成所有 4 个字节

[周五晚上调试结果]

我们编写了另一个 echo 例程；它只是读取它得到的内容并将其写回。

我们以发布模式构建它（根据此处另一个人的建议）

我编写了一个例程，将相同的号码发送 25 次，看看我会得到什么。

之后，我计算值并将其发送 25 次，然后循环。

结果附加在此消息的末尾。

我没有得到第一个空字节。基于各种因素，我现在不会担心。

在接下来的五轮比赛中，我正在完美地恢复一切

我会尝试包含所有相关的源代码，希望它不是文字墙。如果需要更多代码来理解这一点，请询问。

这是有问题的 UART 的初始化代码。我可以包括

```
 //*****************************************************************//
  void initUART1(void)   // UART1 for MCU1/2 communication
  {
   U1MODE=0;                     //// Mode Register, Manual DS61168D page 180
   U1MODEbits.FRZ=0;
   U1MODEbits.SIDL=0;
   U1MODEbits.IREN=0;
   U1MODEbits.RTSMD=0;

   U1MODEbits.UEN=0b00;           //// Just TX/RX, No CTS/RTS

   U1MODEbits.WAKE=1;
   U1MODEbits.LPBACK=0;
   U1MODEbits.ABAUD=0;
   U1MODEbits.RXINV=0;
   U1MODEbits.BRGH=1;
   U1MODEbits.PDSEL=0b00;
   U1MODEbits.STSEL=0;

   U1STA=0;
   U1STAbits.ADM_EN=0;
   U1STAbits.UTXINV=0;
   U1STAbits.URXEN=1;
   U1STAbits.UTXBRK=0;
   U1STAbits.UTXEN=1;
   U1STAbits.ADDEN=0;
   U1STAbits.OERR=0;     
                                 //// Status register, Manual DS61168D page 183

   //U1BRG=21;                    ////  21 for 921600 (80 MIPS)
     U1BRG=172;                   //// 172 for 115200 (80 MIPS)

   IFS0bits.U1RXIF=0;
   IPC6bits.U1IP=5;
   IPC6bits.U1IS=3;
   IEC0bits.U1RXIE=1;

   U1MODEbits.ON=1;
  }

  //*****************************************************************// 
```

这是处理这个特定 UART 的中断服务程序

```
 //*********************************************************//
  void __ISR(_UART1_VECTOR, ipl5) IntUart1Handler(void)   //MCU communication port
  {     
    if(INTGetFlag(INT_SOURCE_UART_RX(UART1)))  //if it's a rx interrupt
    {
       U1RxBuf=UARTGetDataByte(UART1);

    switch (CmdRecording)
    {
     case 0:
           if(U1RxBuf=='*')
           {
            CmdRecording=1;  //set the cmd recording flag
            Command_U1[0]=U1RxBuf;
            TimeOut=1;  //time out=1 means the timeout for MCU1 command receiver is enabled
            initT3(0x0100);  //time out=0 means the timeout for MCU1 command receiver is enabled
           }
           else
         {
          putcharUART1('$');
          putcharUART1('e');
          putcharUART1('2');
          putcharUART1('%');
         }
           break;
     case 1:
           CmdRecording=2;  //set the cmd recording flag
           Command_U1[1]=U1RxBuf;
           break;
     case 2:
           CmdRecording=3;  //set the cmd recording flag
           Command_U1[2]=U1RxBuf;
           break;
     case 3:
           CmdRecording=0;  //reset the cmd recording flag
           Command_U1[3]=U1RxBuf;
           if(U1RxBuf=='%') //if this is the last command byte
           {
                if((Command_U1[1]=='O'))
            {
               CMD_Err=0;      //clear error
             CMD_OK=1;      //send cmd OK;
            }
              else if((Command_U1[1]=='e'))
            {
               CMD_OK=0;      //clear OK
             CMD_Err=1;     //send cmd Err;
            }
            else
            Command_flag=1;
           }
           else
           {
            Command_flag=0;
           }

           disableT3(0);  //the command receiving is done, disable the time out #0 (command receving time out)
           TimeOut=0;  //the command receiving is done, disable the time out

           break;
     default:
           break;
    }
     INTClearFlag(INT_SOURCE_UART_RX(UART1));
    }

    if ( INTGetFlag(INT_SOURCE_UART_TX(UART1)) )  //if it's a tx interrupt
    {
        INTClearFlag(INT_SOURCE_UART_TX(UART1));
    }
  }

  //***********************************************// 
```

这是我在通过“echo”系统运行字节时看到的数据；即，读取一，写入一的例程。

PIC-32 以 80 MHz 运行，UART 以 115200 bps 运行，所以我不担心速度。

```
 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
  01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 
  02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 
  03 03 03 03 03 03 03 03 03 03 03 03 03 03 03 03 03 03 03 03 03 03 03 03 03 
  04 04 04 04 04 04 04 04 04 04 04 04 04 04 04 04 04 04 04 04 04 04 04 04 04 
  05 05 05 05 05 05 05 05 05 05 05 05 05 05 05 05 05 05 05 05 05 05 05 05 05 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T18:50:28.737

看起来 UART 可能有一个 4 字节的 FIFO，并且在 FIFO 满之前不会产生中断。我不熟悉这部分，但通常您可以对 UART 进行编程以在特定 FIFO 级别或在 n 个字符超时后生成中断，以便可以读取未满 FIFO 中的数据。此外，如果是这种情况，您的 ISR 应该循环直到 FIFO 被清空，而不是简单地读取单个字符。

# c++ - 匿名联合是否可以为结构中的成员变量起别名？

> ID：15277819
> 
> 赞同：2
> 
> 时间：2013-03-07T17:28:28.937
> 
> 标签：c++, struct, unions

假设我有以下 C++ 代码：

```
struct something
{
  // ...
  union { int size, length; };
  // ...
}; 
```

这将创建两个`struct`访问相同值的成员：`size`和`length`。

将这两个成员视为完整的别名（即设置大小，然后访问长度，反之亦然）是未定义的行为吗？有没有“更好”的方式来实现这种行为，或者这是一个可以接受的实现方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T17:33:32.420

这不是未定义的行为。联合中的两个别名都将访问内存中的相同位置。见下文：

> **§9.2/18**如果一个标准布局联合包含两个或多个共享一个公共初始序列的标准布局结构，并且如果标准布局联合对象当前包含这些标准布局结构之一，则允许检查公共其中任何一个的初始部分。如果对应的成员具有布局兼容的类型，并且对于一个或多个初始成员的序列，两个标准布局结构都不是位域或两者都是具有相同宽度的位域，则两个标准布局结构共享一个共同的初始序列。

如果类型具有不同的初始序列，则未定义。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-07T17:40:32.420

是的，这是允许的并且定义明确。根据§3.10 [basic.lval]：

> **10/**如果程序尝试通过非下列类型之一的左值访问对象的存储值，则行为未定义：
> 
> — 对象的动态类型
> 
> [...]

由于在这里我们存储 an`int`并通过 an 读取`int`，我们通过与对象相同的动态类型的 glvalue 访问对象，因此一切都很好。

* * *

对于共享相同前缀的*结构*，标准中甚至还有一个特殊警告。或者，在标准的*标准布局类型*中，共享一个*共同的初始序列*。

> **§9.2/18**如果一个标准布局联合包含两个或多个共享一个公共初始序列的标准布局结构，并且如果标准布局联合对象当前包含这些标准布局结构之一，则允许检查公共其中任何一个的初始部分。如果对应的成员具有布局兼容的类型，并且对于一个或多个初始成员的序列，两个标准布局结构都不是位域或两者都是具有相同宽度的位域，则两个标准布局结构共享一个共同的初始序列。

那是：

```
struct A { unsigned size; char type; };
struct B { unsigned length; unsigned capacity; };

union { A a; B b; } x;

assert(x.a.size == x.b.length); 
```

**编辑：**鉴于这`int`不是`struct`（也不是`class`）我恐怕它实际上没有正式定义（我当然在标准中看不到任何东西），但在实践中应该是安全的......我已经把问题带到了 isocpp 论坛; 你可能找到了一个洞。

**编辑：**在上述讨论之后，我看到了§3.10/10。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:34:16.140

值将相同。如果将 5 分配给 size，则长度也将为 5。

# php - 使用 PHP 提供文件以供下载 - 停止多次点击

> ID：15277823
> 
> 赞同：0
> 
> 时间：2013-03-07T17:28:51.540
> 
> 标签：php, zip, download

我有一个“download.php”脚本，它提供文件供下载，用户可以选择下载他们自定义的 ZIP 文件。所以需要即时生成。

我遇到的问题是，如果用户快速连续单击 ZIP 文件 5 次，则 ZIP 会在服务器上生成 5 次。

我需要一种方法来仅在第一次单击时生成它，而不是一遍又一遍地生成。

我不想**永久**“禁用”链接，因为如果用户愿意，几分钟后再次下载文件就可以了，我只想尝试阻止恶意用户敲击下载脚本以使用服务器处理不断生成 ZIP力量。

有任何想法吗？我已经尝试了几个小时，但似乎无法找到有效的解决方案：/

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:52:30.287

是否可以选择包含验证码或类似代码来激活下载？那将停止快速点击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-20T14:37:03.473

将 jQuery 添加到首页以在第一次单击后禁用该按钮。就像是：

```
$("#button").click(fuction(e) {
    $(this).attr("disabled", "");
}); 
```

此外，您可以将 zip 文件缓存一段时间，以便它们仅在 30 分钟块或某个时间范围内处理一次。

# ios - 如何在滚动视图ios中更新标签文本

> ID：15277829
> 
> 赞同：0
> 
> 时间：2013-03-07T17:29:01.340
> 
> 标签：ios, timer, label, scrollview

我在滚动视图 iOS 中有一个标签。
还有一个更新标签文本的计时器。
它工作正常，但如果我滚动滚动视图，标签不会更新

```
[NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(countDown) userInfo:nil repeats:YES];

- (void) countDown {
      label.text = [[NSDate date] description];
} 
```

在这里回答：[当 UIScrollView 滚动时，我的自定义 UI 元素没有被更新](https://stackoverflow.com/questions/4109898/my-custom-ui-elements-are-not-being-updated-while-uiscrollview-is-scrolled)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T18:20:11.230

使用此 UIScrollViewDelegate 方法更新标签

```
- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate
{
   // here update your label
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:46:16.073

```
[self performSelector:@selector(onTick:) withObject:nil afterDelay:2.0];

-(void)onTick:(NSTimer *)timer {
   label.text = //what you want.
} 
```

希望这可以帮助..

# windows-services - 64 位机器上的 32 位 Windows 服务

> ID：15277831
> 
> 赞同：1
> 
> 时间：2013-03-07T17:29:09.097
> 
> 标签：windows-services, windows-server-2003

我在 64 位 Windows 服务器上运行 32 位 Windows 服务时遇到问题，我的查询如下

1) 如果 Windows 服务（使用所有 32 位 DLL）在 64 位寡妇服务器上运行，会有什么问题吗？

2）如果是，那么我们如何在 windows server 2003 R2 上运行 32 位 windows 服务。每次我尝试运行服务事件日志时都会显示错误，尝试加载格式不正确的程序。（来自 HRESULT 的异常：0x8007000B）

这可能是具有任何 64 位 dll 的服务的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:35:14.280

您绝对可以在 64 位 Windows 操作系统上运行 32 位服务。

> 这可能是具有任何 64 位 dll 的服务的问题吗？

如果服务找不到它引用的 32 位版本的 DLL，它将无法加载。如果服务是使用托管代码编写的，请使用[Fusion Log Viewer](http://msdn.microsoft.com/en-us/library/e74a18c4%28v=vs.110%29.aspx) (Fuslogvw) 查看是否有任何绑定失败。

# java - 队列实现构造函数错误JAVA

> ID：15277836
> 
> 赞同：0
> 
> 时间：2013-03-07T17:29:22.120
> 
> 标签：java, eclipse, oop, queue, nodes

谁能告诉我为什么我得到一个错误说

> 隐式超级构造函数 Node() 未定义。必须显式调用另一个构造函数

我知道在某些情况下，当 Java 编译器版本与代码混合使用时，eclipse 会出现此错误，但对我而言并非如此。这是我的代码，错误在 Queue2 构造函数的 Queue2 类中。

```
import java.util.NoSuchElementException;

public class Queue2<T, Item> extends Node<T> {

    private Node<T> head;
    private Node<T> tail;

    // good practice to initialize all variables!
    public Queue2() {
        head = null;
        tail = null;
    }
    public void enqueue(T newData) {
        // make a new node housing newData
        Node<T> newNode = new Node<T>(newData);
        // point _head to newNode if queue is empty
        if (this.isEmpty()) {
            _head = newNode;
        }
        // otherwise, set the current tail’s next
        // pointer to the newNode
        else {
            _tail.setNext(newNode);
        }
        // and make _tail point to the newNode
        _tail = newNode;

    }

    // in class Queue<Type> …
    public Type dequeue() {

        if (this.isEmpty()) {
            return null;
        }
        // get _head’s data
        Type returnData = _head.getData();

        // let _head point to its next node
        _head = _head.getNext();

        // set _tail to null if we’ve dequeued the
        // last node
        if (_head == null){
            _tail = null;
        }
        return returnData;
        public boolean isEmpty() {
            // our Queue is empty if _head
            // is pointing to null!
            return _head == null;
        }

    } 
```

这是超级类......我意识到getter和setter并不完整，但我相信这与我的错误无关？:S

```
public class Node<Type> {
    private Type _data;
    private Node<Type> _nextNode;

    public Node(Type newData) {
        _data = newData;
        _nextNode = null;
    }

    public void setNext(Node<T> newNextNode){ 

    }

    public Node<Type> getNext() {

    }

    public Type getData() {

    }

    public void setData(Node<T> newData){

    }
} 
```

顺便说一句，这只是一些代码来做一些队列练习！先谢谢大家了！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:32:15.247

我*怀疑*唯一的构造函数`Node<T>`是这样的：

```
public Node<T>(T value) 
```

这是完全有道理的——一个节点应该有一个值。然后您的`Queue2`构造函数失败，因为：

```
public Queue2() {
    head = null;
    tail = null;
} 
```

是隐含的：

```
public Queue2() {
    super(); // This is what's failing.
    head = null;
    tail = null;
} 
```

首先，扩展是*没有意义*的。只需使用组合而不是继承。为什么要将队列视为节点？队列的节点值是多少？上一个节点是什么？下一个节点是什么？`Queue2``Node`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:29:57.860

因为您在`Node class`. 您必须在中定义默认构造函数或从您的`Node class`调用另一个构造函数`Node class``Queue class`

或者避免这种疯狂的解决方案，因为 Queue 可能会保留 Node 对象，而不是派生自`Node class`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:31:38.513

问题是你有`Queue2<T, Item> extends Node<T>`，你*没有*一个无参数`Node<T>`的构造函数，并且构造函数`Queue2<T, item>`没有指示`Node<T>`应该调用哪个构造函数。

我认为你实际上不想`Queue2<T, Item>`成为`Node<T>`（你有[一个 has-a 关系](http://en.wikipedia.org/wiki/Has-a)，而不是[一个 is-a 关系](http://en.wikipedia.org/wiki/Is-a)）的子类，所以改变这个：

```
public class Queue2<T, Item> extends Node<T> { 
```

对此：

```
public class Queue2<T, Item> { 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T17:34:08.853

当您创建一个类但不定义构造函数时，Java 会为您定义一个隐含的，没有参数（并且什么都不做）。

当这种情况发生但您从另一个类继承（例如从 Node 继承的 Queue2）时，此隐式构造函数还将调用父类构造函数，因此相当于：

```
public Queue2() {
  super();
} 
```

您看到的错误与父类没有默认（无参数）构造函数的事实有关，因此这个“隐式”代码无法工作。

要解决这个问题，请自己定义一个构造函数，传递 Node 构造函数所需的任何参数。请参阅有关此的[官方文档](http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html)。

# xcode - 在循环中计算来自文本字段的输入

> ID：15277838
> 
> 赞同：1
> 
> 时间：2013-03-07T17:29:22.697
> 
> 标签：xcode, loops, textfield

如何在循环中计算文本字段？我在循环中有一个文本字段，我想计算另一个文本字段中的输入。

```
x = 36;     y = 0;   w = 36      h = 25 ;

moretext = 0 ;

for (moretext=0; moretext<5; moretext ++) {
    textFiled1 = [[UITextField alloc]initWithFrame:CGRectMake(x, y, w, h)];
    textFiled1.textAlignment = NSTextAlignmentCenter;
    textFiled1.backgroundColor = [UIColor clearColor];
    textFiled1.font = [UIFont fontWithName:@"Helvetica " size:(8)];
    x+=36 ;

    [self.view addSubview:textFiled1];
} 
```

我想在 textfield2 中显示 textfield1 循环输入的 TOTAL

```
textFiled2 = [[UITextField alloc]initWithFrame:CGRectMake(180, 0, 36, 25)];
textFiled2.textAlignment = NSTextAlignmentCenter;
textFiled2.backgroundColor = [UIColor clearColor];
textFiled2.font = [UIFont fontWithName:@"Helvetica " size:(8)];

[self.view addSubview:textFiled2]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:36:20.677

实施该`UITextFieldDelegate`协议，您可以从 UITextField 获取更新作为人员类型。`textFieldDidEndEditing:`当有人完成编辑文本字段时也会告诉你。

请参阅：http: [//developer.apple.com/library/ios/#documentation/uikit/reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T19:34:24.840

可能您需要修改代码：
在分配多个 UITextField 对象时，您需要将它们存储在这样的某个数组中。

```
myArray  = [[NSMutableArray alloc]init];
UITextField *textFiled1;

int moretext = 0 ;

for (moretext=0; moretext<5; moretext ++, y=y+50) {
    textFiled1 = [[UITextField alloc]initWithFrame:CGRectMake(x, y, w, h)];
    textFiled1.textAlignment = NSTextAlignmentCenter;
    textFiled1.backgroundColor = [UIColor blueColor];
    textFiled1.font = [UIFont fontWithName:@"Helvetica " size:(8)];
    textFiled1.text = [NSString stringWithFormat:@"%d",y];
    //x+=36 ;
    [myArray addObject:textFiled1];
    [self.view addSubview:textFiled1];
    NSLog(@"view Did Load called");
} 
```

稍后要进行总计，您需要遍历数组并提取文本字段值并累积在像这样的一些变量中。

```
- (int) calc {
int total=0;
int counter;
for (counter=0; counter<5; counter ++) {
    UITextField *field1 = [myArray objectAtIndex:counter];
    total = total + [field1.text intValue];
    NSLog(@"value: %d",[field1.text intValue]);

}

return total;
} 
```

# xna - HLSL 像素着色器照明性能 (XNA)

> ID：15277843
> 
> 赞同：2
> 
> 时间：2013-03-07T17:29:46.000
> 
> 标签：xna, hlsl, pixel-shader

我有一个足够简单的着色器，它支持多个点光源。
灯光存储为 Light 结构数组（最大大小），当它发生变化时，我会传入活动灯光的数量。
问题出在 PixelShader 函数中：
它是基本的东西，从纹理中获取基色，循环从 0 到 numActiveLights 的灯光数组并添加效果，它工作正常，但性能很糟糕！
但是，如果我用相同值的常量替换对全局变量 numActiveLights 的引用，则性能很好。
我只是无法理解为什么引用变量会产生 30+ fps 的差异。

谁能解释一下？

完整的着色器代码：

```
#define MAX_POINT_LIGHTS 16

struct PointLight
{
    float3      Position;
    float4      Color;
    float       Radius;
};

float4x4    World;
float4x4    View;
float4x4    Projection;
float3  CameraPosition;

float4  SpecularColor;
float   SpecularPower;
float   SpecularIntensity;
float4      AmbientColor;
float   AmbientIntensity;
float   DiffuseIntensity;   

int     activeLights;
PointLight  lights[MAX_POINT_LIGHTS];

bool    IsLightingEnabled;
bool    IsAmbientLightingEnabled;
bool    IsDiffuseLightingEnabled;
bool    IsSpecularLightingEnabled;

Texture Texture;
sampler TextureSampler = sampler_state
{
    Texture = <Texture>;

    Magfilter = POINT;
    Minfilter = POINT;
    Mipfilter = POINT;

    AddressU = WRAP;
    AddressV = WRAP;
};

struct VS_INPUT
{
    float4 Position : POSITION0;
    float2 TexCoord : TEXCOORD0;
    float3 Normal : NORMAL0;
};

struct VS_OUTPUT
{
    float3 WorldPosition : TEXCOORD0;
    float4 Position : POSITION0;
    float3 Normal : TEXCOORD1;
    float2 TexCoord : TEXCOORD2;
    float3 ViewDir : TEXCOORD3;

};

VS_OUTPUT VS_PointLighting(VS_INPUT input)
{
    VS_OUTPUT output;

    float4 worldPosition = mul(input.Position, World);
    output.WorldPosition = worldPosition;

    float4 viewPosition = mul(worldPosition, View);
    output.Position = mul(viewPosition, Projection);

    output.Normal = normalize(mul(input.Normal, World));
    output.TexCoord = input.TexCoord;
    output.ViewDir = normalize(CameraPosition -  worldPosition);

    return output;
}

float4 PS_PointLighting(VS_OUTPUT IN) : COLOR
{
    if(!IsLightingEnabled) return tex2D(TextureSampler,IN.TexCoord);

    float4 color = float4(0.0f, 0.0f, 0.0f, 0.0f);

    float3 n = normalize(IN.Normal);
    float3 v = normalize(IN.ViewDir);
    float3 l = float3(0.0f, 0.0f, 0.0f);
    float3 h = float3(0.0f, 0.0f, 0.0f);

    float atten = 0.0f;
    float nDotL = 0.0f;
    float power = 0.0f;

    if(IsAmbientLightingEnabled) color += (AmbientColor*AmbientIntensity);

    if(IsDiffuseLightingEnabled || IsSpecularLightingEnabled)
    {
        //for (int i = 0; i < activeLights; ++i)//works but perfoemnce is terrible
        for (int i = 0; i < 7; ++i)//performance is fine but obviously isn't dynamic
        {
            l = (lights[i].Position - IN.WorldPosition) / lights[i].Radius;
            atten = saturate(1.0f - dot(l, l));

            l = normalize(l);

            nDotL = saturate(dot(n, l));

            if(IsDiffuseLightingEnabled) color += (lights[i].Color * nDotL * atten);
            if(IsSpecularLightingEnabled) color += (SpecularColor * SpecularPower * atten);
        }
    }

    return color * tex2D(TextureSampler, IN.TexCoord);
}

technique PerPixelPointLighting
{
    pass
    {
        VertexShader = compile vs_3_0 VS_PointLighting();
        PixelShader = compile ps_3_0 PS_PointLighting();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T18:53:04.670

我的猜测是将循环约束更改为编译时常量允许 HLSL 编译器展开循环。也就是说，而不是这样：

```
for (int i = 0; i < 7; i++)
    doLoopyStuff(); 
```

它正在变成这样：

```
doLoopyStuff();
doLoopyStuff();
doLoopyStuff();
doLoopyStuff();
doLoopyStuff();
doLoopyStuff();
doLoopyStuff(); 
```

循环和条件分支可能会对着色器代码内部的性能造成重大影响，应尽可能避免。

**编辑**

这只是我的想法，但也许你可以尝试这样的事情？

```
for (int i = 0; i < MAX_LIGHTS; i++)
{
    color += step(i, activeLights) * lightingFunction();
} 
```

通过这种方式，您可以计算所有可能的灯光，但对于不活动的灯光，总是得到 0 值。当然，好处取决于照明功能的复杂性；你需要做更多的分析。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T19:05:11.200

尝试使用 PIX 对其进行分析。[http://wtomandev.blogspot.com/2010/05/debugging-hlsl-shaders.html](http://wtomandev.blogspot.com/2010/05/debugging-hlsl-shaders.html)

或者，阅读这个漫无边际的猜测：

也许是因为有了常量，编译器可以解开和折叠循环的指令。当您将其替换为变量时，编译器将无法做出相同的假设。

尽管与您的实际问题有些无关，但我会将许多这些条件/计算推向软件级别。

`if(IsDiffuseLightingEnabled || IsSpecularLightingEnabled)`

^- 就这样。

另外，我认为您也可以在调用着色器程序之前预先计算一些东西。就像`l = (lights[i].Position - IN.WorldPosition) / lights[i].Radius;`传递一个预先计算好的数组，而不是每次都计算每个像素。

我可能对 HLSL 编译器所做的优化有误解，但我认为你在像素着色器上所做的每个计算都会在屏幕上执行 w*h 次（尽管这是疯狂并行完成的），而且我隐约记得有一些限制到你可以在着色器中拥有的指令数量（比如 72 条？）。（尽管我认为该限制在 HLSL 的更高版本中放宽了很多）。也许是因为你的着色器生成了这么多指令——也许它会破坏你的程序并在编译时将它变成一个多通道像素着色器。如果是这种情况，那可能会增加大量开销。

实际上，这里还有一个可能很愚蠢的想法：将变量传递给着色器让它将数据传输到 GPU。这种传输发生在有限的带宽内。也许编译器足够聪明，以至于当您仅静态索引数组中的前 7 个元素时，仅传输 7 个元素。当编译器没有进行优化时（因为您没有使用常量进行迭代），它会每帧推送整个数组，并且您正在淹没总线。如果是这样的话，那么我之前提出的推出计算，并传递更多结果的建议只会让问题变得更糟，呵呵。

# java - Android - AutoCompleteTextView 如何将项目附加到始终显示的结果列表中？

> ID：15277848
> 
> 赞同：2
> 
> 时间：2013-03-07T17:30:07.890
> 
> 标签：java, android, autocomplete, autocompletetextview

我正在尝试将“无法找到地点单击此处”附加到 AutoCompleteTextView 的结果列表的末尾。我需要这个来显示找到的任何结果，以便用户可以手动添加场地

谢谢，

安迪

```
public class AddVenueActivity extends Activity implements TextWatcher{
    AutoCompleteTextView venue_auto_complete;
    ArrayList<String> venues = new ArrayList<String>();
    ArrayAdapter<String> adapter = null;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_addvenue);

        try
        {
            venue_auto_complete = (AutoCompleteTextView) findViewById(R.id.add_venue_autocomplete);
            adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, venues);
            venue_auto_complete.setThreshold(2);
            adapter.setNotifyOnChange(true);
            venue_auto_complete.addTextChangedListener(this);
            venue_auto_complete.setAdapter(adapter);
            venue_auto_complete.setCompletionHint("POWPOWPOW");

            venue_auto_complete.setOnClickListener(new OnClickListener(){
                @Override
                public void onClick(View arg0) {
                    // TODO Auto-generated method stub
                    venue_auto_complete.setDropDownHeight(LayoutParams.WRAP_CONTENT);
                }
            });

            venue_auto_complete.setOnItemClickListener(new OnItemClickListener(){
                @Override
                public void onItemClick(AdapterView<?> listView, View arg1, int position, long arg3) {
                    try
                    {
                        String venue = (String)listView.getItemAtPosition(position);
                        String[] venue_string_array = venue.split(System.getProperty("line.separator"));
                        venue = venue_string_array[0];
                        venue_auto_complete.setText(venue);
                        venue_auto_complete.dismissDropDown();
                        venue_auto_complete.setDropDownHeight(0);
                    }
                    catch(Exception e)
                    {
                        Log.v("EROORS", e.toString());
                    }
                }
            });
        }
        catch(Exception e)
        {
            e.printStackTrace();
            Log.v("ERROR", e.toString());
        }
    }

    @Override
    public void onTextChanged(CharSequence arg0, int arg1, int arg2, int arg3) {
        if(arg0.length() > 0) 
        {
            search(arg0.toString());
        }

    }

    public void search(String query)
    {
        try
        {
            RequestParams params = new RequestParams();
            params.put("q", query);
            Api.get("/search", params, new JsonHttpResponseHandler() 
            {
                @Override
                public void onSuccess(JSONObject json_response) 
                {
                    try
                    {
                        adapter.clear();

                        JSONArray venue_searchs = json_response.getJSONArray("response");

                        for(int i = 0; i < venue_searchs.length(); i++)
                        {
                            JSONObject venue_search_result = venue_searchs.getJSONObject(i);
                            if(venue_search_result.getString("address") != "null")
                            {
                                adapter.add(venue_search_result.getString("name") + "\n" + venue_search_result.getString("address"));
                            }
                            else
                            {
                                adapter.add(venue_search_result.getString("name"));
                            }
                        }

//                      adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, venues);
                        venue_auto_complete.setAdapter(adapter);
                        adapter.notifyDataSetChanged();
                    }
                    catch(Exception e)
                    {
                        Log.v("ERROR", e.toString());
                    }
                }
            });
        }
        catch(Exception e)
        {
            Log.v("error", e.toString());
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:49:58.450

try to wrap Adapter in HeaderViewListAdapter and try to use for AutoCompleteTextView

use this constructor

```
headeradapter= new HeaderViewListAdapter(ArrayList<ListView.FixedViewInfo> headerViewInfos, ArrayList<ListView.FixedViewInfo> footerViewInfos, adapter);

venue_auto_complete.setAdapter(headeradapter); 
```

# c# - 在数据表中追加记录

> ID：15277849
> 
> 赞同：2
> 
> 时间：2013-03-07T17:30:13.507
> 
> 标签：c#, asp.net

我已在其他地方发布了此内容，但我对要求的理解对帮助我的主持人@ShaiCohen 不正确，他建议我重新发布它。

我需要编辑输入的数据，该数据`DataTable`可以具有不同的列和行，但前两列是不变的。数据如下所示（行首的数字不是数据的一部分）：

```
 Repair  Repair 
    Code    Code Entries          6/1/2012  7/1/2012  8/1/2012  9/1/2012
    ------  --------------------  --------  --------  --------  --------
1\.  00000A  Critical Down Time       1       
2\.  00000A  Critical Outage          1       
3\.  00000A  Total Repair Time        65         
4\.  00000B  Critical Down Time                                     6
5\.  00000B  Total Repair Time                                      90
6\.  00000C  Critical Down Time       1          5    
7\.  00000C  Critical Outage          1          5    
8\.  00000C  Total Repair Time        30         240    
9\.  00000D  Critical Down Time                                     2     
10\. 00000E  Critical Down Time                          1    
11\. 00000G  Critical Down Time                                     1    
12\. 00000M  Critical Down Time        1                            3    
13\. 00000M  Critical Outage           1                 3    
14\. 00000M  Total Repair Time         60                180 
```

请注意，第 1-3、6-8 行具有相同的修复代码类别，因此被视为组。另一方面，第 10-12 行只有“Critical Down Time”子类别，而其余的则是这三者的组合。

要求是在它们不存在的地方插入“修复代码条目”子类别。它们不存在的原因是因为数据库中没有数据，但是即使没有相应的数据，客户端也希望看到显示的丢失的措辞，并插入一个空行来分隔组，如下所示：

```
 Repair  Repair 
    Code    Code Entries          6/1/2012  7/1/2012  8/1/2012  9/1/2012
    ------  --------------------  --------  --------  --------  --------
1\.  00000A  Critical Down Time       1       
2\.  00000A  Critical Outage          1       
3\.  00000A  Total Repair Time        65         

4\.  00000B  Critical Down Time                                     6
    00000B  Critical Outage          
5\.  00000B  Total Repair Time                                      90

6\.  00000C  Critical Down Time       1          5    
7\.  00000C  Critical Outage          1          5    
8\.  00000C  Total Repair Time        30         240 

9\.  00000D  Critical Down Time                                     2   
    00000D  Critical Outage          
    00000D  Total Repair Time 
```

但是，当前存在的代码假定数据始终具有三个子类别的分组，因此如果不是，则上一行的子类别将覆盖当前行中的子类别：

```
8\.  00000C  Total Repair Time        30         240 

9\.  00000D  Total Repair Time (should be Critical Down Time)        2   
    00000D  Critical Outage 
```

在代码（下面）中，当处理新行时，方法`subCategoryOccurences`内部的计数器不会重置为零。`CheckSubCategoryRequirements`

```
public void PrepareDataTable(DataTable dtResults)
{

    if (dtResults == null || dtResults.Rows.Count == 0)
       return;

    //initialize category
    categoryPrevious = dtResults.Rows[0]["Category"].ToString();
    do
    {
        //get the current category
        categoryCurrent = dtResults.Rows[rowCount]["Category"].ToString();
        //check if this is a new category. this is where all the work is done
        if (categoryCurrent != categoryPrevious)
        {
            //check if we have fulfilled the requirement for number of subcategories 
            CheckSubCategoryRequirements(dtResults);
            //at this point we have fulfilled the requirement for number of subcategories 
            //add blank (separator) row
            dtResults.Rows.InsertAt(dtResults.NewRow(), rowCount);
            rowCount++;
            //reset the number of subcategories
            subCategoryOccurences = 0;
            categoryPrevious = categoryCurrent;
        }
        else
        {
            rowCount++;
            categoryOccurences++;
        }
    } while (rowCount < dtResults.Rows.Count);
    //check sub category requirements for the last category
    CheckSubCategoryRequirements(dtResults);  
}

private void CheckSubCategoryRequirements(DataTable dtResults)
{
    if (subCategoryOccurences< subCategories.Length)
    {
        //we need to add rows for the missing subcategories
        while (subCategoryOccurences< subCategories.Length)
        {
            //create a new row and populate category and subcategory info
            rowFiller = dtResults.NewRow();
            rowFiller["Category"] = categoryPrevious;
            rowFiller["SubCategory"] = subCategories[subCategoryOccurences];
            //insert the new row into the current location of table 
            dtResults.Rows.InsertAt(rowFiller, rowCount);
            subCategoryOccurences++;
            rowCount++;
        }
    }
} 
```

我试图在方法调用之前移动计数器，但这导致了不希望的结果，所以我不确定从这里去哪里。我将不胜感激建设性的意见。谢谢。R。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T19:30:35.903

对于这些要求，我采用了与以前不同的方法。有了这些新要求，我们将不得不“倒退”在以前缺少的地方插入子类别。

此方法创建一个*新*表，该表为原始表中存在的每个类别填充正确数量的子类别。创建新行后，我们将检查*旧*表以查看是否有任何数据需要复制到*新*表（即：示例中的“6/1/2012”和“7/1/2012” ）。

试试这个代码：

```
public DataTable PrepareDataTable(DataTable dtResults)
{
    string[] subCategories = new string[3] {"Critical Down Time", "Critical Outage", "Total Repair Time"};
    //make a copy of the original table
    DataTable dtOutput = dtResults.Clone();
    DataRow drOutput = null;
    DataRow[] drResults = null;
    //retrieve the list of Categories
    var categories = dtResults.AsEnumerable().Select(r => r["Category"]).Distinct().ToList();
    //populate the new table with the appropriate rows (combinations of categories/subcategories)
    foreach (string category in categories)
    {
        for (int i = 0; i < subCategories.Length    ; i++)
        {
            //create the new row in the new table
            drOutput = dtOutput.NewRow();
            drOutput["Category"] = category;
            drOutput["SubCategory"] = subCategories[i];
            //here is where you will check to see if a row with the same category and subcategory exists in dtResults. if it does, then copy over the values for each column
            drResults = dtResults.Select(String.Format("Category = '{0}' AND SubCategory = '{1}'", category, subCategories[i]));
            if(drResults.Length > 0)
            {
                foreach(DataColumn column in dtResults.Columns)
                {
                    drOutput[column.ColumnName] = drResults[0][column.ColumnName];
                }

            }
            dtOutput.Rows.Add(drOutput);
        }
        //add filler/spacer row
        drOutput = dtOutput.NewRow();
        dtOutput.Rows.Add(drOutput);
    }
    return dtOutput;
} 
```

这是“测试工具”：

```
public void RunTest()
{
    DataTable dtResults = new DataTable();
    dtResults.Columns.Add("Category");
    dtResults.Columns.Add("SubCategory");
    dtResults.Columns.Add("Data");
    dtResults.Rows.Add("00000A", "Critical Down Time", "1");
    dtResults.Rows.Add("00000A", "Critical Outage", "1");
    dtResults.Rows.Add("00000A", "Total Repair Time", "1");
    dtResults.Rows.Add("00000B", "Critical Down Time", "1");
    dtResults.Rows.Add("00000B", "Total Repair Time", "1");
    dtResults.Rows.Add("00000C", "Critical Down Time", "1");
    dtResults.Rows.Add("00000C", "Critical Outage", "1");
    dtResults.Rows.Add("00000C", "Total Repair Time", "1");
    dtResults.Rows.Add("00000D", "Critical Down Time", "1");
    dtResults.Rows.Add("00000E", "Critical Down Time", "1");
    dtResults.Rows.Add("00000G", "Critical Down Time", "1");
    dtResults.Rows.Add("00000M", "Critical Down Time", "1");
    dtResults.Rows.Add("00000M", "Critical Outage", "1");
    dtResults.Rows.Add("00000M", "Total Repair Time", "1");
    DataTable dtOutput = PrepareDataTable(dtResults);
} 
```

# php -   PHP 中的删除

> ID：15277859
> 
> 赞同：1
> 
> 时间：2013-03-07T17:30:35.593
> 
> 标签：php

我需要从我正在使用 Curl 和 simplehtml dom 解析的网站中删除所有狡猾的 html 字符。

```
<?php
$html = "this is&nbsp;a text";
var_dump($html);
var_dump(html_entity_decode($html,ENT_COMPAT,"UTF-8")); 
```

哪个输出

> string(19) "这是一个文本"
> 
> string(15) "这是┬á文本"

我不想使用 preg*，因为文本中有其他字符（例如 °）。这让我快疯了！

谢谢，詹姆斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T17:32:51.907

您需要使用标头指定输出编码：

```
<?php
    header('Content-Type: text/html; charset=utf-8');

    $html = "this is&nbsp;a text";
    var_dump($html);
    var_dump(html_entity_decode($html,ENT_COMPAT,"UTF-8"));
?> 
```

浏览器默认不采用 UTF-8，这就是它显示错误字符的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:31:43.433

如果这是唯一需要替换的字符，请使用`str_replace()`

```
var_dump(str_replace('&nbsp;', ' ', "this is&nbsp;a text")); 
```

[看到它在行动](http://codepad.viper-7.com/iyGMGl)

# java - Android：将活动的 onCreate() 代码放在片段中的什么位置？

> ID：15277862
> 
> 赞同：16
> 
> 时间：2013-03-07T17:30:42.300
> 
> 标签：java, android, android-fragments, android-viewpager, oncreate

我正在将我的所有活动转换为片段，以便我可以在 ViewPager 中使用它们。

我已经搜索过这个，但我找不到令人满意的答案，所以我在这里问它。

在我的活动中，我在`onCreate()`方法中编写了一些代码。例如，我调用 some `findViewById()`s 以便将一些 xml 按钮链接到我的 Activity。我还在方法中使一些视图不可见`onCreate()`，设置一个`OnClickListener()`，用文本填充一个`TextView`并删除一个通知`onCreate()`。

我的问题是：我应该把这段代码放在片段的哪里？在 onCreate()? 创建视图（）？onActivityCreated()? 为什么？

提前谢谢了！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-07T18:36:27.223

尽管 Pragnani 的答案很接近，但它几乎没有教育价值。此外，他的第二个陈述还有一个更合适的选择。

> 我应该把这段代码放在片段的哪里？在 onCreate()? 创建视图（）？onActivityCreated()? 为什么？

简短的回答是：要么做，`onCreateView()`要么`onActivityCreated()`做。视图层次结构要到 才会创建`onCreateView()`，因此这是片段生命周期中最早可以膨胀视图并附加点击侦听器等的点。[由于`onActivityCreated()`将始终在 之后运行`onCreateView()`](http://developer.android.com/guide/components/fragments.html#Lifecycle)，这也是一个合适的位置。`onCreate()`可以跳过有利于系统临时分离片段并重新附加它，例如在[保留片段](http://developer.android.com/reference/android/app/Fragment.html#setRetainInstance%28boolean%29)时。

Pragnani 是正确的，他指出膨胀片段的视图与膨胀活动中的视图略有不同。更具体地说：片段没有定义`findViewById()`方法，因此您需要在其他对象上调用它。

而不是使用`getActivity().findViewById()`，你会想要**`getView().findViewById()`**。这样做的原因是，如果您使用 Activity 进行视图查找，那么当多个具有相同视图 ID 的片段附加到它时，您会遇到麻烦。如果您在各种片段的布局中重用视图 ID，或者如果您显示两个显示不同数据的相同片段，就会出现这种情况。在这两种情况下，只会返回第一个匹配项，而您确实希望在片段的上下文中查找视图。这正是[`getView()`](http://developer.android.com/reference/android/app/Fragment.html#getView%28%29)返回的内容，即片段的根视图（您在 中返回的`onCreateView()`），因此适当地限制了查找的范围。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T17:41:15.223

1.**将 onCreate 留空，只需调用 super.onCreate()**

2.**而不是 findViewById() 使用 getActivity().findViewById() 在您需要视图上下文的地方始终使用 getActivity()。**

```
 Do all other operations in onCreateview() 
```

# javascript - 用 jquery 事件更新 javascript 中的主类的正确方法是什么？

> ID：15277867
> 
> 赞同：0
> 
> 时间：2013-03-07T17:30:49.370
> 
> 标签：javascript

假设我有类似的东西：

```
var MyApp = function() {
this.name = "Stacy"
}

MyApp.prototype.updateName = function(newname) {
this.name = newname;
} 
```

在我的主页中，我有一个：

```
$(function () {
  var instance = new MyApp();
}) 
```

我有一个按钮事件处理程序可以更新名称：

```
$("#button").on("click", function(evt) {                        
    // Update the name in MyApp to something else...
    instance.name = "john" // I do not like using instance here, because it has to be "instance" has to be created before I can use it. I want to be able to make this independent of "instance" being created or not
}); 
```

这样做的正确方法是什么，以便按钮处理程序将更新“MyApp”以具有正确的名称，而不明确使用创建的 myapp“实例”作为按钮的单击处理程序的一部分？

理想情况下，我想将该 jquery 事件处理程序推到“MyApp”的某个地方，这样我就可以执行以下操作：

```
MyApp.prototype.events = function() {
    $("#button").on("click", function(evt) {                        
        this.name = "john"
    });
} 
```

虽然它不起作用，因为这指的是别的东西。

如何正确构建我的应用程序，以便事件处理程序或多或少地更新“MyApp”的属性，以便它可以独立于创建的“实例”（即我不再需要使用“实例”）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:50:16.757

首先，如果您创建了一个 setter 函数，那么使用它是个好主意！:D

```
$("#button").on("click", function(evt) {                        
    // Update the name in MyApp to something else...
    //instance.name = "john"
    instance.updateName("john");
}); 
```

然后，将事件处理程序放在对象 MyApp 的方法中是没有意义的，因为它永远不会绑定 onclick 事件，直到您触发 events()

然后...**我的组织方式**是使用 jQuery 文档 onload 将所有 DOM 对象与您的应用程序的功能绑定。通常是这样的：

```
MYAPP = {};

MYAPP.say_something = function () {

    alert('lol, you clicked me!');

};

...

$(function () {

    $('#my_button').click(MYAPP.say_something);
    $('#other_element').mouseenter(MYAPP.another_method);

}); 
```

对于大型应用程序，您必须使用大量元素，如果您有一个用于 DOM 元素的命名空间，则可以更好地组织代码，如下所示：

```
MYAPP.fetch_dom = function () {

    return {
        my_button: $('#my_button'),
        other_element: $('#other_element')
    };
}; 
```

你可以用一种非常简洁的方式绑定事件

```
$(function () {

    // first initiate DOM
    my_dom = MYAPP.fetch_dom();

    // Then bind events
    my_dom.my_button.click(MYAPP.say_something);
    my_dom.other_element.mouseenter(MYAPP.another_method);

}); 
```

这样，您不必从程序的一千个点中寻找 DOM 中的特定元素，将硬编码的 id 散布到各处，并对 DOM 结构执行无效搜索。

最后，在 JS 中使用字面量比使用 new 这个词要好得多。JS 是一种原型 OOP 语言，而 new 有点“违背自然”，可能会让人头疼。

# wpf - 当 SelectedItem 更改时，如何获取绑定 WPF Datagrid 的最后一行以通知 View Model？

> ID：15277869
> 
> 赞同：0
> 
> 时间：2013-03-07T17:30:55.400
> 
> 标签：wpf, mvvm, datagrid, selecteditem

这是我的第一篇文章 - 我欢迎任何关于如何在需要时发布问题的建议。

我有一个 WPF `DataGrid`，它`ItemsSource`绑定到一个名为 OrderDetails(List Of OrderDetails) 的属性并`SelectedItem`绑定到一个名为 CurrentOrderDetail 的属性。

在 CurrentOrderDetail 属性中，我调用了一个进行计算的方法。执行计算的方法循环通过 OrderDetails 属性并将属于该列表的每个 OrderDetail 的两个成员相乘以产生总成本。该方法只是简单地更新文本框绑定到表单上的另一个属性。

这一切都很好 - 直到我到达最后一行`DataGrid`。基本上，用户从第一行开始，点击 Invoiced 字段并输入数量，然后按 Enter 键，选择下一行。更改并因此`SelectedItem`更新 CurrentOrderDetail - 调用计算。这行得通！用户重复该过程，一切计算正常，直到`DataGrid`命中最后一条记录。当用户按 Enter 键结束对 Invoiced 单元格的编辑时，从不调用计算方法 - 因为`SelectedItem`未更改，因此从不更新 CurrentOrderDetail 属性。

我喜欢标准，因为我最近转向 WPF/Silverlight 和 MVVM，所以我没有回头。因此，我试图以同样的方式保持这个应用程序。

我想我需要强迫一些东西来触发`SelectedItem`改变。我曾考虑过在视图中连接事件并简单地强制导航，但这对我来说似乎有点难看。一定有更好的解决方案。我已经在这里和其他论坛度过了两天，并尝试了我自己的几个想法，但都没有奏效。

我可以要求用户导航到另一行以触发属性通知，但我宁愿不这样做。

这只是 XAML 的`DataGrid`：

```
<DataGrid Name="grdData" Grid.Row="3" Grid.ColumnSpan="2" AutoGenerateColumns="False" CanUserAddRows="False" Margin="5,5,5,5" ItemsSource="{Binding Path=OrderDetails, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"  SelectedItem="{Binding Path=CurrentOrderDetail, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" BorderThickness="3" >
    <DataGrid.Columns>   
        <DataGridTextColumn Binding="{Binding Path=Part}" Header="Wyandot Part #" IsReadOnly="True" />
        <DataGridTextColumn Binding="{Binding Path=SupplierPartNumber}" Header="Supplier Part #" IsReadOnly="True" />
        <DataGridTextColumn Binding="{Binding Path=UnitPrice, StringFormat=c}" Header="Price" IsReadOnly="True" />
        <DataGridTextColumn Binding="{Binding Path=Account}" Header="Account" IsReadOnly="True" />
        <DataGridTextColumn Binding="{Binding Path=UDF5, Mode=TwoWay}" Header="Invoiced" IsReadOnly="False" />
    </DataGrid.Columns>
</DataGrid> 
```

以及我的视图模型中相关的片段。

```
Private m_orderDetails As List(Of OrderDetail)
Public Property OrderDetails As List(Of OrderDetail)
    Get
        Return m_orderDetails
    End Get
    Set(value As List(Of OrderDetail))
        m_orderDetails = value
        InvokePropertyChanged("OrderDetails")
    End Set
End Property

Private m_currentOrderDetail As OrderDetail
Public Property CurrentOrderDetail As OrderDetail
    Get
        Return m_currentOrderDetail
    End Get
    Set(value As OrderDetail)
        m_currentOrderDetail = value
        InvokePropertyChanged("CurrentOrderDetail")
        Calculate()
    End Set
End Property

Public Sub Calculate()
    Dim total As Decimal = 0

    For Each detail As OrderDetail In OrderDetails
        total += detail.UnitPrice * detail.UDF5
    Next

    PoTotal = CStr("$" & total.ToString)
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:50:24.613

在我看来，您的计算发生在错误的更改事件上。我会让`OrderDetail`用户正在更新的 value 属性触发属性更改事件并使用它来更新我的总数。

订阅 each 的每个属性更改事件需要做更多的工作`OrderDetail`，但这是您真正关心的。我可能会使用一个`ObservableCollection<OrderDetail>`然后在`Collectionchanged`事件中连接必要的侦听器。

# javascript - Loop through array and match items to html elements

> ID：15277877
> 
> 赞同：1
> 
> 时间：2013-03-07T17:31:25.517
> 
> 标签：javascript, jquery, arrays, loops

I am looking for a more intuitive way to run the code below (as it is also incomplete to my purpose).

```
for (j = 0; j<items.length; j++) {
            var indivItem = items[j];
               if (indivItem.category == 1) {
                  $('.indiv_category[idnumber="1"]').append('<ul class="left_side_item"><li>'+indivItem.title+'</li></ul>');
               }
               else if (indivItem.category == 2) {
                  $('.indiv_category[idnumber="2"]').append('<ul class="left_side_item"><li>'+indivItem.title+'</li></ul>');
               }
            } 
```

Essentially I need line 3 to check `if (indivItem.category > 0)` then look for the element with a matching `idnumber` attribute and append the necessary info.

I need this continue for the length of available `.indiv_category` elements.

Basically a matchup of the all items in the 'items' `array` to all of the elements with a matching 'idnumber' attribute to the item in the array that contains the same id number.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:33:40.590

Remmove the condition and just use the variable `items[j].category` in selector.

```
for (j = 0; j<items.length; j++) {             
    $('.indiv_category[idnumber="'+ items[j].category + '"]').append('<ul class="left_side_item"><li>'+indivItem.title+'</li></ul>');             
} 
```

# ruby-on-rails - 更改回形针样式以调整图像大小使应用程序在上传图像时显示“未选择文件”？

> ID：15277887
> 
> 赞同：0
> 
> 时间：2013-03-07T17:31:53.507
> 
> 标签：ruby-on-rails, paperclip, imagick

在我的模型 pin.rb

```
has_attached_file :image, styles: { medium: "320x240>"} 
```

在 pin.html.erb

```
<td><%= image_tag pin.image(:medium) %></td> 
```

当我上传图片时，它会给出

> 没有选择文件回形针::Errors::NotIdentifiedByImageMagickError

但是，当我从 pin.rb 中删除“样式...”和从 pin.html 中删除 '(:medium) 时，它可以正常工作。我希望调整图像大小。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T18:09:59.060

你不是忘记在附件上调用 url 了吗？

```
<%= image_tag pin.image.url(:medium) %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-03T17:12:09.467

是的，这是几年前的问题，从未有人回答

我今天正在研究另一个回形针问题，但在这种情况下，我会说：

```
<%= image_tag @pin.image.url(:medium) %> 
```

因为这相当于我的。

不要忘记 _form.html.erb 中的实例变量以及将图像设置为所需大小的 .url 方法。

对于此页面的任何旅行者，作为下一步，您可能还希望在此处查看有关如何在编辑视图中删除图像的另一篇文章。 [编辑时的 Rails 文件上传（回形针）](https://stackoverflow.com/questions/22315198/rails-file-upload-paperclip-on-edit?rq=1)

干杯

# asp.net-mvc - 显示模型中的值以外的值

> ID：15277889
> 
> 赞同：0
> 
> 时间：2013-03-07T17:31:59.530
> 
> 标签：asp.net-mvc

我的视图中有这个文本框定义

```
@Html.TextBoxFor(model => model.MaxNumberOfExtensions == "0" ? "Unlimited" : model.MaxNumberOfExtensions, new { required = "required", id = "maxNumberOfExtensions" }) 
```

我想做的是说，

> 如果 MaxNumberOfExtensions 值为 0，则在文本框中显示“Unlimited”，否则显示 MaxNumberOfExtensions 字段中的值

这在运行时不起作用。它给出了错误

```
Templates can be used only with field access, property access, single-dimension array index, or single-parameter custom indexer expressions. 
```

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T09:51:20.190

HTML 助手不支持这种复杂的 lambda 表达式。它们仅支持属性访问和索引器访问表达式。

正确的方法当然是使用视图模型。因此，您将拥有一个已包含基于域模型值所需文本的属性。

例如：

```
public class MyViewModel
{
    public string MaxNumberOfExtensions { get; set; }
} 
```

然后在您的控制器操作中呈现此视图：

```
public ActionResult SomeAction()
{
    SomeDomainModel model = ...
    MyViewModel viewModel = new MyViewModel();
    viewModel.MaxNumberOfExtensions = model.MaxNumberOfExtensions == "0" ? "Unlimited" : model.MaxNumberOfExtensions;
    return View(viewModel);
} 
```

然后在视图中：

```
@model MyViewModel
...
@Html.TextBoxFor(x => x.MaxNumberOfExtensions, new { required = "required", id = "maxNumberOfExtensions" }) 
```

或者，如果您的应用程序当前没有遵循最佳实践（不使用视图模型），您可以编写一个自定义模板来执行此任务。

例如，在 中添加以下模板`~/Views/Shared/EditorTemplates/FormattedNumberOfExtensions.cshtml`：

```
@model string
@{
    var value = Model == "0" ? "Unlimited" : Model;
}

@Html.TextBox("", value, new { required = "required", id = "maxNumberOfExtensions" }) 
```

然后在你看来：

```
@Html.EditorFor(x => x.MaxNumberOfExtensions, "FormattedNumberOfExtensions") 
```

# c# - 根据两个数据表的差异更改datagridview中的颜色？

> ID：15277891
> 
> 赞同：4
> 
> 时间：2013-03-07T17:32:08.170
> 
> 标签：c#, winforms, datagridview, datatable

我有两个数据表，每个数据表都有 1 列：

```
dtTempCM
dtOldTempCM 
```

在这两个表中，唯一的列名是`Column1`

我还有 2 个数据网格视图，每个都绑定到一个数据表：

```
dgvCurrentCM.DataSource = dtTempCM;
dgvOldCM.DataSource = dtOldTempCM; 
```

如果它们不匹配，我如何比较每一行，并在一个（或两个）datagridviews 中突出显示它？到目前为止，我有这个：

```
foreach (DataRow row1 in dtTempCM.Rows)
{
   foreach (DataRow row2 in dtOldTempCM.Rows)
   {
        var array1 = row1.ItemArray;
        var array2 = row2.ItemArray;

        if (array1.SequenceEqual(array2))
        {
            //change row/cell color in dgvCurrentCM to red
            //change row/cell color in dgvOldCM to red
        }
    }
} 
```

有任何想法吗？谢谢！

编辑：我也试过这个，但它会改变每个单元格的颜色，因为它将 dgvOldCM 中的每一行与 dgvCurrentCM 中的单行进行比较：

```
foreach (DataGridViewRow row1 in dgvCurrentCM.Rows)
{
    foreach (DataGridViewRow row2 in dgvOldCM.Rows)
    {
        if (row1.Cells[0].Value != row2.Cells[0].Value)
        {
            row1.DefaultCellStyle.ForeColor = Color.Red;
            row2.DefaultCellStyle.ForeColor = Color.Red;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T18:07:55.297

我会在其中一个 gridview 上进行迭代，与另一个类似：

```
 for (int i = 0; i < dgvCurrentCM.RowCount; i++)
    {
        if (dgvCurrentCM.Rows[i].Cells[0].Value != null)
        {
            if ((int)dgvCurrentCM.Rows[i].Cells[0].Value != (int)dgvOldCM.Rows[i].Cells[0].Value)
            {
                dgvCurrentCM.Rows[i].DefaultCellStyle.ForeColor = Color.Red;
                dgvOldCM.Rows[i].DefaultCellStyle.ForeColor = Color.Red;
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T18:37:11.960

您可以生成两个数据表的交集，然后标记行：

```
DataTable dt1 = new DataTable();
DataTable dt2 = new DataTable();

dt1.Columns.Add("Col");
dt2.Columns.Add("Col");

for (int i = 0; i < 10; i++)
{
    DataRow dr = dt1.NewRow();
    dr["Col"] = i.ToString();
    dt1.Rows.Add(dr);
}

for (int i = 5; i < 15; i++)
{
    DataRow dr = dt2.NewRow();
    dr["Col"] = i.ToString();
    dt2.Rows.Add(dr);
}

var result = dt1.AsEnumerable().Intersect(dt2.AsEnumerable(), DataRowComparer.Default);

dataGridView1.DataSource = dt1;
dataGridView2.DataSource = dt2;

for (int i = 0; i < dataGridView1.RowCount -1; i++)
{
    DataRow currRow = ((DataRowView)dataGridView1.Rows[i].DataBoundItem).Row;
    if (result.Contains(currRow))
        dataGridView1.Rows[i].DefaultCellStyle.ForeColor = Color.Red;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-08-26T14:52:06.930

```
if (array1.SequenceEqual(array2))
{

}
else
{
//Do your action here!
} 
```

# jquery - 请帮我在 IE7 中处理这个脚本

> ID：15277892
> 
> 赞同：0
> 
> 时间：2013-03-07T17:32:11.847
> 
> 标签：jquery, internet-explorer, internet-explorer-7

```
<script>
$('#mbx').vTicker({
speed:500,
pause:5000,
animation:'false',
mousePause:true,
showItems:1,
});
</script> 
```

我正在使用这个非常简单的滴答脚本，我的问题是它在所有浏览器中都能正常工作，除了最可怕的浏览器 ie7，这显然也不能被忽略。在调试它的显示时

预期的标识符，字符串或数字，这是`$('#mbx').vTicker({`这里的第一个字符，现在众所周知，ie7 与逗号混淆，我也将其删除，但它没有工作，然后在其他浏览器中也停止工作，现在有人可以帮我找到一个这个问题的解决方案对我来说真的是无与伦比的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:34:13.930

IE 不喜欢带有逗号结尾的对象。去掉后面的逗号`showItems:1`。

# r - 解析出字符串，将其设置为 R data.table 中的因子列

> ID：15277894
> 
> 赞同：4
> 
> 时间：2013-03-07T17:32:15.660
> 
> 标签：r, data.table

我真的找不到一种优雅的方式来实现这一点，请帮忙。

我有一个`DT`数据表：

```
name,value
"lorem pear ipsum",4
"apple ipsum lorem",2
"lorem ipsum plum",6 
```

并基于一个列表`Fruits <- c("pear", "apple", "plum")`，我想创建一个因子类型列。

```
name,value,factor
"lorem pear ipsum",4,"pear"
"apple ipsum lorem",2,"apple"
"lorem ipsum plum",6,"plum" 
```

我想这是基本的，但我有点卡住了，这就是我走了多远：

`DT[grep("apple", name, ignore.case=TRUE), factor := as.factor("apple")]`

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T18:24:50.987

您可以使用正则表达式对其进行矢量化，例如使用`gsub()`：

设置数据：

```
strings <- c("lorem pear ipsum", "apple ipsum lorem", "lorem ipsum plum")
fruit <- c("pear", "apple", "plum") 
```

现在创建一个正则表达式

```
ptn <- paste0(".*(", paste(fruit, collapse="|"), ").*")
gsub(ptn, "\\1", strings)
[1] "pear"  "apple" "plum" 
```

* * *

正则表达式的工作原理是用 , 分隔每个搜索元素`|`，嵌入括号内：

```
ptn
[1] ".*(pear|apple|plum).*" 
```

* * *

要在数据表中执行此操作，根据您的问题，那么简单如下：

```
library(data.table)
DT <- data.table(name=strings, value=c(4, 2, 6))
DT[, factor:=gsub(ptn, "\\1", strings)]
DT

                name value factor
1:  lorem pear ipsum     4   pear
2: apple ipsum lorem     2  apple
3:  lorem ipsum plum     6   plum 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-07T17:44:19.147

我不知道是否有更“data.table”的方式来做到这一点，但你可以试试这个：

```
DT[, factor := sapply(Fruits, function(x) Fruits[grep(x, name, ignore.case=TRUE)])]
DT
#                 name value factor
# 1:  lorem pear ipsum     4   pear
# 2: apple ipsum lorem     2  apple
# 3:  lorem ipsum plum     6   plum 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-07T18:19:34.773

这是我的编码解决方案。困难的部分是从`regex`. 我所知道的最好的通用解决方案（找到与任何正则表达式匹配的任何内容）是`regexec`and`regmatches`组合（见下文）。

```
# Create the data frame
name <- c("lorem pear ipsum", "apple ipsum lorem", "lorem ipsum plum")
value <- c(4,2,6)
DT <- data.frame(name=name, value=value, stringsAsFactors=FALSE)

# Create the regular expression
Fruits <- c("pear", "apple", "plum")
myRegEx <- paste(Fruits, collapse = "|")

# Find the matches
r <- regexec(myRegEx, DT$name, ignore.case = TRUE)
matches <- regmatches(DT$name, r)

# Extract the matches, convert to factors
factor <- sapply(matches, function(x) as.factor(x[[1]]))

# Add to data frame
DT$factor <- factor 
```

这可能是比您想要的更长的解决方案。

# sql - UPDATE 涉及三个表

> ID：15277895
> 
> 赞同：-2
> 
> 时间：2013-03-07T17:32:17.117
> 
> 标签：sql, oracle11g

我需要创建此查询中涉及的三个表，并且我不确定如何连接这两个（**地址**和地址**键**）表以更新**办公室**表。

我有一张**办公室**表、一个**地址**表和一个地址**键**表。**办公室**表有地址数据（街道、城市、州、邮编）和办公室 ID#。

**地址**表具有地址数据和地址Id#。

**address_key**表有address_id 和office_id。我需要使用地址表中的地址数据更新 office 表中的现有行，**并将**它们**与**address_key 表中的键链接**起来**。

 ****我将如何更新**办公室**表地址数据字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:52:09.143

You could loop through the address_key table and for each row, update the office record with office_id with the address info using the address_id in each row you're looping through. I think something like this should work if you're using oracle (the question was tagged with oracle11g):

```
FOR id_row in (SELECT * FROM address_key)
LOOP
    UPDATE office SET (street, city, state, zip) = 
        (SELECT street, city, state, zip FROM address WHERE address_id = id_row.address_id);
    WHERE office_id = id_row.office_id
END LOOP 
```

I hope that helps!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:38:13.287

```
update o set
    street = a.street
    , city = a.city
    , state = a.state
    , zip = a.zip
from Office o
join Address_Key k
    on k.officeid = o.officeID
join Address a
    on a.addressID = k.addressid 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:38:27.667

您可以根据您的联接运行更新。

```
UPDATE office
SET office.street = address.street ,
 office.city = address.city ,
 office.state = address. ,
 office.zip = address.zip 
FROM office
 INNER JOIN address_key ON office.office_id = address_key.office_id
 INNER JOIN address ON address_key.address_id = address.address_id 
```****

# c# - AutoMapper：手动设置属性

> ID：15277904
> 
> 赞同：34
> 
> 时间：2013-03-07T17:32:32.170
> 
> 标签：c#, automapper

我正在使用 AutoMapper 将平面 DataObjects 映射到胖 BusinessObjects，反之亦然。我注意到从 DataObjects 到 BusinessObjects 的映射需要额外的时间，因为 BusinessObjects 的更改通知（使用自定义验证实现 INotifyPropertyChanged 等）。

因为我通常在映射过程中不需要更改通知，所以我想将其关闭。所以我添加了一个属性“IsPropertyChangedEnabled”。如果此属性设置为 false，则不会引发 NotifyPropertyChanged 事件并节省时间。

问题：

我可以告诉 AutoMapper 在映射过程开始时将此属性设置为 false 吗？如果是这样，怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-03-07T17:46:25.487

在映射过程之前使用`BeforeMap`方法设置属性值：

```
Mapper.CreateMap<Source, Destination>()
      .BeforeMap((s, d) => d.IsPropertyChangedEnabled = false ); 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2014-03-26T14:52:40.500

您还可以使用 ForMember() 当属性设置为值不在源对象中时，它具有通过 Mapper.AssertConfigurationIsValid() 的标准单元测试的额外好处。

这是一个例子

```
Mapper.CreateMap<ClientData, GenerateClientLetterCommand>()
            .ForMember(x => x.Id, opt => opt.MapFrom( o => Guid.NewGuid()))
            .ForMember(x => x.Created, opt => opt.MapFrom( o => DateTime.Now)); 
```

根据条件赋值

```
Mapper.CreateMap<ClientData, GenerateClientLetterCommand>()
            .ForMember(x => x.Gender, opt => opt.MapFrom( o => o.Gender == 0 ? "Male" : "Female")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:52:35.570

根据我从描述中了解到的是，您不想在使用 DO 从 db 获取数据并填充 BO 时触发属性更改通知。

一种可能的解决方案是为所有 BO 提供一个具有两个主要功能的基类，1\. Property - IsLoaded，它将在数据加载后由映射器设置；2\. INotifyPropertyChange 实现和包装 RaisePropertyChange 发布者的方法检查 IsLoaded 属性并基于该属性引发事件。

# asp.net-mvc - 请求的资源不支持 http 方法 "Put"

> ID：15277908
> 
> 赞同：1
> 
> 时间：2013-03-07T17:32:46.093
> 
> 标签：asp.net-mvc, web-applications, asp.net-web-api

我可以通过 /api/set/id 或 /api/set/archived/ GET 很好，但 PUT 不起作用。我的路线：

```
 routes.MapHttpRoute(
            name: "SetId",
            routeTemplate: "api/set/{id}",
            defaults: new { controller = "Set", action = "getset" }
        ); 

        routes.MapHttpRoute(
            name: "Set",
            routeTemplate: "api/set/{action}/{id}",
            defaults: new { controller = "Set", id = RouteParameter.Optional }
        ); 
```

设置控制器：

```
 [HttpPut]
        [AcceptVerbs("PUT")]
        [ActionName("update")]
        public HttpResponseMessage PutSet(Set set)
        {
         ...
        } 
```

在提琴手中，我将来自相应 GET 请求的原始对象放入：

```
http://localhost:24144/api/set/update 
```

但我明白了

> "{"$id":"1","Message":"请求的资源不支持http方法'PUT'。"}"

为什么 PUT 不起作用？

编辑：我还尝试更新第一个路由以将 id 作为可选，并删除 PUT 方法上的操作名称。然后我尝试通过 PUT /api/set 访问，我得到相同的 405 错误 - PUT 不受支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T19:18:41.410

将此路由移动到路由配置文件的顶部：

```
routes.MapHttpRoute(
            name: "Set",
            routeTemplate: "api/set/{action}/{id}",
            defaults: new { controller = "Set", id = RouteParameter.Optional }
        ); 
```

并将您的 Put 方法重命名为 Update

[HttpPut]

```
 public HttpResponseMessage Update(Set set)
    {
     ...
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:37:12.417

也许动词没有在 web.config 中正确注册？

```
 <authorization>
        <!-- General application authorization -->
        <allow verbs="GET" users="*"/>
        <allow verbs="PUT" users="*"/>
        <allow verbs="POST" users="*"/>
    </authorization> 
```

# java - 如何使用 Jsoup 删除文档类型

> ID：15277911
> 
> 赞同：0
> 
> 时间：2013-03-07T17:32:58.480
> 
> 标签：java, parsing, jsoup

我正在尝试从我正在解析的 html 文件中删除 doctype，但 doctype 在文件中保持不变。

```
 Document doc = Jsoup.parse(file, null);

    List<Node>nods = doc.childNodes();
      for (Node node : nods) {

    if (node.nodeName().equals("#doctype") {

       node.remove();

  } 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-05-14T13:03:53.690

```
Document document = ...;
document.childNodes()
    .stream()
    .filter(node -> node instanceof DocumentType)
    .findFirst()
    .ifPresent(Node::remove); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T17:35:26.943

```
node.nodeName()=="#doctype" 
```

尝试比较相等时，使用`==`运算符比较类型对象将产生不可预测的结果。`String`那是因为它正在检查两个引用是否都指向同一个对象，但没有相同的值。您应该改用该`equals()`方法，该方法已在 String 类中被覆盖以检查相等性。

# javascript - 我可以像在 webkit 浏览器的资源选项卡中检查 websql 一样在 Firefox 中检查 indexeddb

> ID：15277915
> 
> 赞同：2
> 
> 时间：2013-03-07T17:33:16.970
> 
> 标签：javascript, html, firefox-addon, firebug, indexeddb

有没有像我们在浏览器`firebug extension`中检查一样让我检查`indexed DB`的东西。`firefox``webSQL``webkit`

`indexedDB`我做了一些谷歌搜索，但找不到任何有用的东西，现在找到检查员是否为时过早？

我们如何检查表是否已创建和填充，我们是否应该编写某种测试用例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-28T06:52:10.760

通过**Storage Inspector**，您可以在 Firefox 中查看 indexeddb 数据。

存储检查器可从 Firefox 34 获得。

有关[Storage Inspector的更多信息](https://developer.mozilla.org/en-US/docs/Tools/Storage_Inspector)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:53:39.657

我不知道它是否有任何扩展，但我前段时间写了一个 indexeddb 查看器。您可以在[codeplex](http://linq2indexeddb.codeplex.com/releases)上找到它。有关如何使用它的信息，您可以在我的[博客](http://www.kristofdegrave.be/2012/11/indexeddbviewer-take-look-inside-your.html)上找到。

希望这可以帮到你。

# android - Android NDK：jnix jar 未加载

> ID：15277918
> 
> 赞同：1
> 
> 时间：2013-03-07T17:33:18.137
> 
> 标签：android, android-ndk

我已将 jnix.jar 文件放在 libs 文件夹中并添加到构建路径中。但是当我尝试使用 System.loadLibrary("jnix") 加载库时，我收到以下崩溃。它虽然列在引用的库中。

```
03-07 22:04:24.822: E/streamer(8746): Couldn't load jnix: findLibrary returned null
03-07 22:04:24.822: E/streamer(8746): java.lang.UnsatisfiedLinkError: Couldn't load jnix: findLibrary returned null
03-07 22:04:24.822: E/streamer(8746):   at java.lang.Runtime.loadLibrary(Runtime.java:365)
03-07 22:04:24.822: E/streamer(8746):   at java.lang.System.loadLibrary(System.java:535)
03-07 22:04:24.822: E/streamer(8746):   at ob.android.MainActivity.<clinit>(MainActivity.java:38)
03-07 22:04:24.822: E/streamer(8746):   at java.lang.Class.newInstanceImpl(Native Method)
03-07 22:04:24.822: E/streamer(8746):   at java.lang.Class.newInstance(Class.java:1319)
03-07 22:04:24.822: E/streamer(8746):   at android.app.Instrumentation.newActivity(Instrumentation.java:1039)
03-07 22:04:24.822: E/streamer(8746):   at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2101)
03-07 22:04:24.822: E/streamer(8746):   at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2229)
03-07 22:04:24.822: E/streamer(8746):   at android.app.ActivityThread.access$600(ActivityThread.java:139)
03-07 22:04:24.822: E/streamer(8746):   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1261)
03-07 22:04:24.822: E/streamer(8746):   at android.os.Handler.dispatchMessage(Handler.java:99)
03-07 22:04:24.822: E/streamer(8746):   at android.os.Looper.loop(Looper.java:154)
03-07 22:04:24.822: E/streamer(8746):   at android.app.ActivityThread.main(ActivityThread.java:4945)
03-07 22:04:24.822: E/streamer(8746):   at java.lang.reflect.Method.invokeNative(Native Method)
03-07 22:04:24.822: E/streamer(8746):   at java.lang.reflect.Method.invoke(Method.java:511)
03-07 22:04:24.822: E/streamer(8746):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
03-07 22:04:24.822: E/streamer(8746):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
03-07 22:04:24.822: E/streamer(8746):   at dalvik.system.NativeStart.main(Native Method)
03-07 22:04:24.822: W/dalvikvm(8746): Exception Ljava/lang/RuntimeException; thrown while initializing Lob/android/MainActivity;
03-07 22:04:24.822: W/dalvikvm(8746): Class init failed in newInstance call (Lob/android/MainActivity;)
03-07 22:04:24.822: D/AndroidRuntime(8746): Shutting down VM
03-07 22:04:24.822: W/dalvikvm(8746): threadid=1: thread exiting with uncaught exception (group=0x40abe228)
03-07 22:04:24.862: E/AndroidRuntime(8746): FATAL EXCEPTION: main
03-07 22:04:24.862: E/AndroidRuntime(8746): java.lang.ExceptionInInitializerError
03-07 22:04:24.862: E/AndroidRuntime(8746):     at java.lang.Class.newInstanceImpl(Native Method)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at java.lang.Class.newInstance(Class.java:1319)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at android.app.Instrumentation.newActivity(Instrumentation.java:1039)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2101)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2229)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at android.app.ActivityThread.access$600(ActivityThread.java:139)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1261)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at android.os.Handler.dispatchMessage(Handler.java:99)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at android.os.Looper.loop(Looper.java:154)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at android.app.ActivityThread.main(ActivityThread.java:4945)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at java.lang.reflect.Method.invokeNative(Native Method)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at java.lang.reflect.Method.invoke(Method.java:511)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at dalvik.system.NativeStart.main(Native Method)
03-07 22:04:24.862: E/AndroidRuntime(8746): Caused by: java.lang.RuntimeException: java.lang.UnsatisfiedLinkError: Couldn't load jnix: findLibrary returned null
03-07 22:04:24.862: E/AndroidRuntime(8746):     at ob.android.MainActivity.<clinit>(MainActivity.java:47)
03-07 22:04:24.862: E/AndroidRuntime(8746):     ... 15 more
03-07 22:04:24.862: E/AndroidRuntime(8746): Caused by: java.lang.UnsatisfiedLinkError: Couldn't load jnix: findLibrary returned null
03-07 22:04:24.862: E/AndroidRuntime(8746):     at java.lang.Runtime.loadLibrary(Runtime.java:365)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at java.lang.System.loadLibrary(System.java:535)
03-07 22:04:24.862: E/AndroidRuntime(8746):     at ob.android.MainActivity.<clinit>(MainActivity.java:38)
03-07 22:04:24.862: E/AndroidRuntime(8746):     ... 15 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T19:27:39.363

loadLibrary() 用于本机代码，通常编译为 C 或 C++。Jar 是一个 Java 库，您可以在 Android 中使用此类库，但这些库将被编译到您的 Java 代码中。请注意，Android 运行不同的 JVM，其运行时环境仅与 JRE 部分兼容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T19:48:17.817

如上所述， System.loadLibrary() 用于本机代码。如果您的 jar 文件已正确添加到构建路径中，您应该能够像往常一样导入类。

例如，如果您要从 jar 文件中使用的类在 com.jnixpackage 包中，并且类名为 JnixClass，则可以通过添加来导入它

```
import com.jnixpackage.JnixClass; 
```

到你的java文件的顶部。

# php - 如果没有博客文章，标题不会显示。WordPress

> ID：15277920
> 
> 赞同：0
> 
> 时间：2013-03-07T17:33:20.970
> 
> 标签：php, wordpress

在我们当前的网站上，我们有不同的公司简介。有些公司的博客文章会显示在他们的个人资料上，有些则没有。它们是页面模板中帖子上方的 h2 标记，然后是引入帖子的代码。代码看起来像这样。

```
 <h2>Recent Blog Articles</a></h2>
 <?php echo get_related_author_posts(); ?> 
```

我正在尝试找到一种方法，以便如果他们没有公司的帖子，则不会显示 h2 标签。函数文件中的代码是

```
function get_related_author_posts() {
    global $authordata, $post;

    $authors_posts = get_posts( array( 'author' => $authordata->ID, 'post__not_in' => array( $post->ID ), 'posts_per_page' => 5 ) );

    $output = ' <ul style="list-style: none;">';
    foreach ( $authors_posts as $authors_post ) {
        $output .= '<li><a href="' . get_permalink( $authors_post->ID ) . '">' . apply_filters( 'the_title', $authors_post->post_title, $authors_post->ID ) . '</a></li>';
    }
    $output .= '</ul>';

    return $output;

} 
```

我想不出任何建议会有所帮助。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:40:56.027

如果将 添加`h2`到函数中，则可以通过添加 if 语句来检查是否有任何作者帖子来控制整个输出。

```
function get_related_author_posts() {
    global $authordata, $post;

    $authors_posts = get_posts( array( 'author' => $authordata->ID, 'post__not_in' => array( $post->ID ), 'posts_per_page' => 5 ) );

    if( ! $authors_posts ) {
        return;
    } 

    $output = '<h2>Recent Blog Articles</h2>';
    $output .= ' <ul style="list-style: none;">';
    foreach ( $authors_posts as $authors_post ) {
        $output .= '<li><a href="' . get_permalink( $authors_post->ID ) . '">' . apply_filters( 'the_title', $authors_post->post_title, $authors_post->ID ) . '</a></li>';
    }
    $output .= '</ul>';

    return $output;

} 
```

# android - 检测适配器上的项目视图已被破坏

> ID：15277922
> 
> 赞同：4
> 
> 时间：2013-03-07T17:33:26.367
> 
> 标签：android, listview, adapter, baseadapter

我有一个带有 BaseAdapter 的 ListView。我想经常更新列表中的某些项目而不刷新内容。为了实现这一点，我使用了观察者模式。我有一个 Observable 对象，列表中的每个项目都是观察者。

```
 public View getView(final int position, View convertView, final ViewGroup parent) {
        final ItemViewHolder holder;
        final Item item = (Item) getItem(position);
        if (convertView == null) {
            convertView = inflater.inflate(R.layout.item, parent, false);

            /* ADD VIEWS TO HOLDER */

            holder = new ItemViewHolder();

            convertView.setTag(holder);

            ItemObserver observer = new ItemObserver(holder, context);
            mapObservers.put(holder, observer);
            observable.addObserver(observer);
        } else {
            holder = (ItemViewHolder) convertView.getTag();
        }
        //Set values into view etc...
        return convertView;
    } 
```

这很好用，但问题是：我怎么知道不再需要观察者？我想检测给定视图何时被销毁，以便从 Map 中获取观察者并将其从 Observable 对象中删除。当视图被销毁时，是否有任何监听器被调用？

我试过`AbsListView.RecyclerListener.onMovedToScrapHeap(View view)`了，但它似乎在 View 被回收时被调用。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-07-30T09:22:02.237

根据[这个官方问题](https://code.google.com/p/android/issues/detail?id=5708)，`onViewDetachFromWindow`BUT存在问题

> 在这种情况下，不一定会调用 onDetachedFromWindow()。ListView 子项被回收和重用，ListView 尽可能避免不必要的 onDetachedFromWindow()。
> 但是，当 Activity 被销毁或 ListView 与窗口分离时，应为适配器创建的所有视图调用 onDetachedFromWindow()。

所以你不能指望 listview 视图被破坏。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-11T14:56:21.367

您的项目视图必须扩展 android View 并覆盖下一个方法：

```
@Override
protected void onDetachedFromWindow() {
    super.onDetachedFromWindow();
    // View is now detached, and about to be destroyed.
    // Remove observer here.
} 
```

# 编辑

阅读评论后，我决定稍微解释一下列表视图的工作原理。

最大的问题是视图被适配器重用。当您向下滚动列表时，最上面的项目视图被重用（而不是销毁！）以显示最下面的项目视图。如果您覆盖适配器的 getView() 方法，这将反映在 next 方法中：

```
public View getView(int position, View convertView, ViewGroup parent) {
    View view = super.getView(position, convertView, parent);
    ...
    return view;
} 
```

它在后面做什么：

```
 if (convertView == null) {
        view = mInflater.inflate(resource, parent, false);
    } else {
       view = convertView;
    } 
```

因此，convertView 永远不会被破坏，而是**被重用**。回到问题上来，您只需要根据变量*position*更新持有者值，在以下行之后：

```
 holder = (ItemViewHolder) convertView.getTag();
    // Update your holder/observer here. Something like:
    holder.setPosition(position); 
```

# java - Java，仅在 GC 后出现内存不足警告

> ID：15277932
> 
> 赞同：0
> 
> 时间：2013-03-07T17:33:55.597
> 
> 标签：java, memory-management, out-of-memory

我在我的 Java 应用程序中安装了一个低内存检测器，它似乎运行良好。我`MemoryPoolMXBean`与 a 结合使用`NotificationListener`，将堆设置`collectionUsageThreshold`为`size * 0.9999`

但是，我的应用程序中也有很多 SoftReference。即使应用程序在没有我的低内存检测器的情况下运行良好，检测器也会发出警告 - 很可能是因为软引用尚未被 GC 清除。

如果在所有可以清除的 SoftReferences 都被清除之后，x% 的可用内存被用完，有什么方法可以警告我吗？

# javascript - 使用 IE10 和 windows 8 捕获移动事件

> ID：15277940
> 
> 赞同：3
> 
> 时间：2013-03-07T17:34:28.437
> 
> 标签：javascript, windows, html, mouse, tablet

我正在尝试在 Windows 8 触摸屏平板电脑上使用 html5 客户端捕获签名。我试过使用[http://github.com/thomasjbradley/signature-pad](http://github.com/thomasjbradley/signature-pad)，但它不是用鼠标在桌面上捕捉到的平滑曲线，而是偶尔捕捉到 dot 。

我设置了一个 html5 画布并在平板电脑上用手指刷过它，捕获鼠标悬停、鼠标输入和鼠标按下。

似乎只有移动的开始才会触发鼠标进入/鼠标悬停事件。

我用手写笔再次尝试并得到了相同的结果。

我尝试使用一百左右的 div 行，结果相同。

尝试改用chrome，结果相同

这是有道理的（有点），因为平板电脑没有鼠标，但我需要捕获按下的手指/触控笔的鼠标移动事件以捕获签名。

有没有人解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-22T22:51:39.080

```
-ms-touch-action: none; 
```

只需将其添加到 .sigWrapper 上的 signaturepad.css 文件，thomasjbradley 控件就可以工作。

似乎 IE10 正在注册的触摸事件正在破坏该控件上鼠标事件的事件侦听器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T06:36:29.107

试试这些事件 MSPointerDown、MSPointerMove、MSPointerUp 和更多这里提到的[http://msdn.microsoft.com/en-in/library/windows/apps/hh465891.aspx](http://msdn.microsoft.com/en-in/library/windows/apps/hh465891.aspx)

这些事件在 Windows Phone 8 中有效，但我不确定它们是否在 Windows 8 平板电脑中有效。

# javascript - 将变量和字符串保存在本地存储中

> ID：15277943
> 
> 赞同：0
> 
> 时间：2013-03-07T17:34:46.733
> 
> 标签：javascript, local-storage

嘿，我想在本地存储中存储一段文本和一个变量。这可能看起来有点模糊，所以这就是我的意思：

```
var something = "text";
localStorage.setItem("localstorage", '"sometext"+something');

function functionz() 
{
var displayed = localStorage.localstorage;
alert(displayed);
} 
```

我想确保显示将显示此文本： sometexttext 我已经通过将“sometext”+something 存储在这样的变量中来工作：

```
var something = "text";
localStorage.setItem("localstorage", '"sometext"+something');    

function functionb()
{
var thetext = "sometext"+something;
alert(thetext);
} 
```

第二个版本会给你：（sometexttext），第一个版本会给你（“sometext”+something）作为原始文本。这当然不是我想要的，我想知道如何制作它以便它可以存储在本地存储中并仍然显示第二个结果。提前致谢

# php - Facebook 发布链接作为页面问题

> ID：15277946
> 
> 赞同：1
> 
> 时间：2013-03-07T17:35:05.783
> 
> 标签：php, facebook-graph-api, facebook-page

我正在编写一个简单的 Facebook 页面选项卡应用程序，它允许我将消息（状态更新、链接、照片和视频）发布到多个页面。

我在尝试将各种内容发布到页面时间轴的 Facebook API（使用 PHP SDK）时遇到问题。

当我发布状态更新时，它成功地以页面名称发布。

```
 $pages = $this->facebook->api('me/accounts', 'GET');
    $pages = json_decode(json_encode($pages), FALSE);

    foreach ($pages->data as $page) {
        if (in_array($page->id, $_POST['pages'])) {

            $data = array(
                'access_token' => $page->access_token,
                'message' => Arr::get('status', $_POST)
            );

            $queryString = http_build_query($data);

            $this->facebook->api("$page->id/feed?".$queryString, 'POST');
        }
    } 
```

只要我添加更多参数（即尝试发布链接），就会在我的管理员帐户下发布帖子（即 Chris Hayes 发布了指向“页面 X”的链接）。

```
 $pages = $this->facebook->api('me/accounts', 'GET');
    $pages = json_decode(json_encode($pages), FALSE);

    foreach ($pages->data as $page) {
        if (in_array($page->id, $_POST['pages'])) {

            $data = array(
                'access_token' => $page->access_token,
                'link' => Arr::get('link', $_POST),
                'message' => Arr::get('status', $_POST)
            );

            $queryString = http_build_query($data);

            $this->facebook->api("$page->id/feed?".$queryString, 'POST');
        }
    } 
```

我不知道这里发生了什么。从字面上看，唯一改变的是添加“链接”参数。如果有人可以帮助我，我将不胜感激！

**编辑**我获得的权限是：email、user_about_me、user_likes、user_birthday、manage_pages、publish_stream

问候，克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T18:32:29.720

我在另一篇文章中找到了答案。

```
 $pages = $this->facebook->api('me/accounts', 'GET');
    $pages = json_decode(json_encode($pages), FALSE);

    foreach ($pages->data as $page) {
        if (in_array($page->id, $_POST['pages'])) {

            $this->facebook->setAccessToken($page->access_token);

            $data = array(
                'access_token' => $page->access_token,
                'name' => 'Facebook API: Posting As A Page',
                'link' => 'https://www.webniraj.com/2012/08/09/facebook-api-posting-as-a-page/',
                'caption' => 'The Facebook API lets you post to Pages you own automatically - either as real-time updates or in the case that you want to schedule posts.',
                'message' => 'Check out my new blog post!'
            );

            $queryString = http_build_query($data);

            $this->facebook->api("$page->id/feed?".$queryString, 'POST');
        }
    } 
```

关键是通过 Facebook SDK 设置页面访问令牌。这可能是因为我在其他地方使用库将访问令牌设置为用户的；我猜这个库必须覆盖作为参数发送的令牌。

```
$this->facebook->setAccessToken($page->access_token); 
```

**参考：** [作为主页（不是个人）发布到 Facebook 主页](https://stackoverflow.com/questions/6239482/posting-to-a-facebook-page-as-the-page-not-a-person)

* * *

**编辑：**我刚刚发现的另一个问题是我自己构建查询字符串并将其附加到 API 端点，如下所示：

```
$this->facebook->api("$page->id/feed?".$queryString, 'POST'); 
```

您应该做的是发送 $data 数组作为 API 调用的第三个参数：

```
$this->facebook->api("$page->id/feed", 'POST', $data); 
```

PHP SDK 在 $data 中查找“access_token”参数，因为我没有在该数组中发送它，所以它没有找到它（因此默认使用我之前设置的用户访问令牌）。

在将数据作为 API 调用的第三个参数发送后，我能够删除该行：

```
$this->facebook->setAccessToken($page->access_token); 
```

# c# - 如何检查单元格值是否为数字

> ID：15277947
> 
> 赞同：0
> 
> 时间：2013-03-07T17:35:06.970
> 
> 标签：c#, excel, vsto

使用 Microsoft.Office.Interop.Excel 对象读取 Excel 电子表格的单元格。我需要找出数字值的格式并相应地应用。例如我有 19.0000 的值，但是当它被读取时 Value2 将是“19”但是我需要保持它“19.0000”

```
Excel.Range sheetRange = xlWorksheet.Range["A1", lastCell];
var cell = sheetRange.Cells[row, col];
cell.Value2 == "19"; 
```

有一个 NumberFormat 属性返回我可以使用的格式字符串，如“0.0000”，但我不知道如何检查单元格值是否为数字。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-29T14:42:44.747

我为此目的使用此功能：

```
 public static bool IsValidDecimalNumber(this string s)
    {
        if (string.IsNullOrWhiteSpace(s)) return false; //blank/null strings aren't valid decimal numbers
        return !s.Any(c => !(char.IsDigit(c) || c == '.')) && !(s.Count(c => c == '.') > 1);
    } 
```

编辑：详细地说，如果它是空白/空，则返回 false，如果任何数字不是数字或小数点，则返回 false，如果小数点超过一个，则返回 false。否则，它返回真。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-29T14:31:59.313

一个有点老套的方法是在开头添加一个撇号 - 然后excel不会尝试格式化它

例如 `var value = 19.0000; cell.value = "'" + value;`

# linq - Linq Pivot 查询中的错误

> ID：15277953
> 
> 赞同：2
> 
> 时间：2013-03-07T17:35:26.703
> 
> 标签：linq, entity-framework, linq-to-entities

使用 Linq 对“键/值表”的实体执行以下查询时，我得到`[System.NotSupportedException] "Specified method not supported"`：

有人可以提示我做错了什么吗？

```
var Pivot = context.goe_postmeta.GroupBy(pm => pm.post_id).Select(
                g => new PivotTemp
                    {
                        ID = g.Key, 
                        FirstName = g.FirstOrDefault(p => p.meta_key == "_billing_first_name").meta_value, 
                        LastName = g.FirstOrDefault(p => p.meta_key == "_billing_last_name").meta_value, 
                        Address = g.FirstOrDefault(p => p.meta_key == "_billing_address_1").meta_value, 
                        PostCode = g.FirstOrDefault(p => p.meta_key == "_billing_postcode").meta_value, 
                        Phone = g.FirstOrDefault(p => p.meta_key == "_billing_phone").meta_value, 
                        OrderTotal = g.FirstOrDefault(p => p.meta_key == "_order_total").meta_value, 
                        PickupLocation = g.FirstOrDefault(p => p.meta_key == "_pickup_location").meta_value, 
                        PickupTime = g.FirstOrDefault(p => p.meta_key == "_pickup_time").meta_value, 
                        OrderItems = g.FirstOrDefault(p => p.meta_key == "_order_items").meta_value
                    }).ToList(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T17:45:57.837

```
var Pivot = context.goe_postmeta.GroupBy(pm => pm.post_id).Select(
                g => new PivotTemp
                    {
                        ID = g.Key, 
                        FirstName = g.FirstOrDefault(p => p.meta_key == "_billing_first_name").meta_value, 
                        LastName = g.FirstOrDefault(p => p.meta_key == "_billing_last_name").meta_value, 
                        Address = g.FirstOrDefault(p => p.meta_key == "_billing_address_1").meta_value, 
                        PostCode = g.FirstOrDefault(p => p.meta_key == "_billing_postcode").meta_value, 
                        Phone = g.FirstOrDefault(p => p.meta_key == "_billing_phone").meta_value, 
                        OrderTotal = g.FirstOrDefault(p => p.meta_key == "_order_total").meta_value, 
                        PickupLocation = g.FirstOrDefault(p => p.meta_key == "_pickup_location").meta_value, 
                        PickupTime = g.FirstOrDefault(p => p.meta_key == "_pickup_time").meta_value, 
                        OrderItems = g.FirstOrDefault(p => p.meta_key == "_order_items").meta_value
                    }).ToList(); 
```

也许是因为你错过了“。” 在 ToList() 之前？只是一个猜测

# jquery - 从 asp.net 用户控件中的 jquery datepicker 发送更改事件？

> ID：15277955
> 
> 赞同：0
> 
> 时间：2013-03-07T17:35:33.500
> 
> 标签：jquery, asp.net, events, user-controls, datepicker

我在 asp.net 用户控件中有一个 jquery datepicker。

我需要设置一个更改指示器（它不必是 onchange，任何事件名称都可以，只要我可以从包含控件的页面的 .aspx 中引用它来执行特定于该控件的 javascript在日历上选择新日期时的页面。）

这是初始化我的日期选择器的 javascript。

```
 calendarcontrol.datepicker({
        altField: calendarcontroldate,
        navigationAsDateFormat: true,
        onSelect: function(dateText, inst) { alert(dateText); },
        nextText: 'MM',
        prevText: 'MM'
    }); 
```

datepicker 初始化很好，并且当它像上面那样设置时，警报确实会按预期弹出日期选择，但是当我尝试通过控制参数传递它或通过直接调用页面的 javascript 函数将它发送到页面时，它根本没有开火。

我需要做什么来为内部日历选择设置一个控制事件，以便我的页面可以捕获它并在必要时执行进一步的 javascript？我的控件工作得很好，我需要做的最后一件事是在用户控件中选择新日期时在页面上显示一个事件。

非常感谢。我正在好转，但 jquery 对我来说仍然很神秘。

编辑：好的，让它像这样工作：

```
 // init main datepicker
    calendarcontrol.datepicker({
        altField: calendarcontroldate,
        navigationAsDateFormat: true,
        onSelect: window[hfSelectDate],
        nextText: 'MM',
        prevText: 'MM'

    }); 
```

其中 hfSelectDate 是函数的传入字符串（我通过参数设置它，所以我可以在 aspx 中使用它。）

感谢您为我指明正确的方向！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:56:26.203

您可以`onchange`在原始文本输入元素上添加一个事件。每当从日历中选择新日期或手动输入日期时，都会触发该事件。

您还可以使用 jQuery`change()`方法附加该事件处理程序：

```
calendarcontrol.datePicker({...})
               .change(function() { alert('value changed'); }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T20:22:00.703

似乎您设置页面的方式正在咬您。在 aspx 页面中初始化您的日期选择器，就像我在发布的链接中所做的那样。如果您在 aspx 页面上初始化您的日期选择器，那么您不必担心发送任何内容，因为您将完全控制您的 aspx 页面。您的选择功能将在 aspx 页面中您想要的位置准确触发，然后直接在该功能内执行其他操作。无需发送任何东西。

1.将css类附加到ascx控件中具有日期选择器的文本框。

**ascx**

```
 <asp:UpdatePanel runat="server">
    <ContentTemplate>
   <asp:TextBox ID="TextBox1" runat="server" CssClass="myclass"></asp:TextBox>
  </ContentTemplate>
  </asp:UpdatePanel> 
```

2.在母版页中引用附加的css类。我已经初始化了两次日期选择器来处理更新面板。 **aspx**

```
 <script type="text/javascript">
        $(document).ready(function () {
        var prm = Sys.WebForms.PageRequestManager.getInstance();
        prm.add_initializeRequest(InitializeRequest);
        prm.add_endRequest(EndRequest);
        // Place here the first init of the DatePicker   

        $('.myclass').datepicker({
            altField: "",
            navigationAsDateFormat: true,
            onSelect: function (dateText, inst) {

               //here directly excute further javascript code.Piece of cake.
             .

            },
            nextText: 'MM',
            prevText: 'MM'
        });

    });

    function InitializeRequest(sender, args) { }
    function EndRequest(sender, args) {
        // after update occur on UpdatePanel re-init the DatePicker 

        $('.myclass').datepicker({
            altField: "",
            navigationAsDateFormat: true,
            onSelect: function (dateText, inst) {
              //here directly excute further javascript code.Piece of cake.

            },
            nextText: 'MM',
            prevText: 'MM'
        }) ;

    } 
```

[例子](https://www.dropbox.com/s/88vypoiphykspae/WebApplication3.zip?m)

# iphone - UIAlertview 后数字键盘跳动

> ID：15277956
> 
> 赞同：0
> 
> 时间：2013-03-07T17:35:37.127
> 
> 标签：iphone, ios, objective-c, xcode, uialertview

我有一个登录屏幕，当用户多次输入错误密码时会显示警报。单击其中一个按钮时，将显示另一个警报视图以确认，如果我在第二个警报视图上按下取消按钮，数字键盘将从屏幕底部弹回其原始位置。在第二次警报响应期间没有执行任何代码。有人可以帮忙吗？

```
if (loginCount < 5) {
  // Display alert to user
  UIAlertView *loginError = [[UIAlertView alloc] initWithTitle:@"Login Failure" message:@"You have entered an incorrect passcode.  Please try again." delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil];
  [loginError show];

  } else {
    // Display alert to user, including option to reset the app as they have 5 or more login failures
    UIAlertView *loginError = [[UIAlertView alloc] initWithTitle: @"Login Failure" message: @"You have entered an incorrect passcode on 5 or more occasions.  Please try again or reset the app." delegate: self cancelButtonTitle: @"Try Again" otherButtonTitles: @"Reset App", nil]
    [loginError show];
}
// Clear password fields
[self clearPasswordFields];
[passcode1 becomeFirstResponder];
// Increment the login count
loginCount++;

- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex {

    // If the user has chosen to reset the app, alert with a confirmation first before resetting
    NSString *title = [alertView buttonTitleAtIndex:buttonIndex];
    if ([title isEqualToString:@"Reset App"]) {
        // Create alert to give the user the choice to confirm reset
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Confirm Reset" message:@"Are you sure you wish to Reset?" delegate:self cancelButtonTitle:@"No" otherButtonTitles:@"Yes", nil];
        [alert show];
    } else if ([title isEqualToString:@"Yes"] && buttonIndex == 1) {
        [Utilities resetApp];
        [self dismissViewControllerAnimated:NO completion:nil];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T18:06:20.400

我将这样做。

在头文件中：

```
UIAlertView *loginError; 
```

在实现文件中：

```
-(void)textFieldDidEndEditing:(UITextField *)textField
{
  if (loginCount < 5) {
  // Display alert to user
  loginError = [[UIAlertView alloc] initWithTitle:@"Login Failure" message:@"You have entered an incorrect passcode.  Please try again." delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil];
  [loginError show];

  } else {
    // Display alert to user, including option to reset the app as they have 5 or more login failures
    loginError = [[UIAlertView alloc] initWithTitle: @"Login Failure" message: @"You have entered an incorrect passcode on 5 or more occasions.  Please try again or reset the app." delegate: self cancelButtonTitle: @"Try Again" otherButtonTitles: @"Reset App", nil]
    [loginError show];
}
}

- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex {

    // If the user has chosen to reset the app, alert with a confirmation first before resetting
    NSString *title = [alertView buttonTitleAtIndex:buttonIndex];
    if ([title isEqualToString:@"Reset App"]) {
        [self showSecondAlert];
    } else if ([title isEqualToString:@"Yes"] && buttonIndex == 1) {
        [Utilities resetApp];
        [self dismissViewControllerAnimated:NO completion:nil];
    }else{
      [self clearPasswordFields];
      [passcode1 becomeFirstResponder];
    }
}

-(void)showSecondAlert
{
        //make sure you dismiss the old alertview first
         [loginError dismissWithClickedButtonIndex:0  animated:NO];
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Confirm Reset" message:@"Are you sure you wish to Reset?" delegate:self cancelButtonTitle:@"No" otherButtonTitles:@"Yes", nil];
        [alert show];
} 
```

希望这可以帮助...

# regex - 尝试使用正则表达式解析字符

> ID：15277957
> 
> 赞同：0
> 
> 时间：2013-03-07T17:35:40.247
> 
> 标签：regex

我正在尝试在交换服务器上使用正则表达式来匹配规则“电子邮件地址是否有字符 1,2 或 3 中的数字”

我以前从未使用过 RegEx，但我想出了以下内容，几乎可以正常工作！

^([0-9]|[0-9]|[0-9]).*@domain.com

如果 Char 2 或 3 是数字，但不是第一个字符，它可以工作

有人可以看到/解释我哪里出错了吗？

非常感谢，

Ĵ

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T17:44:46.173

如果第一个字符是数字 ( `[0-9]`)、数字( `[0-9]`) 或数字()，您的正则表达式正在检查`[0-9]`：`([0-9]|[0-9]|[0-9])`

你可以做你想做的事情：

```
^([0-9]..|.[0-9].|..[0-9]).*@domain.com 
```

这会检查您的字符串是否以：

`[0-9]..`一个数字后跟两个字符

`.[0-9].`一个字符、一个数字和一个字符

`..[0-9]`两个字符和一个数字

你可以[在这里测试](http://rubular.com/r/eRiGdkntwB)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:46:23.163

当您真正尝试匹配位置上的字符时，在括号中使用[交替会出错。](http://www.regular-expressions.info/alternation.html)

如果您想匹配位置 1、2 或 3 的数字，这将起作用：

```
^[0-9]|^.[0-9]|^..[0-9] 
```

请注意，这不会将您的字符串验证为电子邮件地址，但假设您仅将有效的电子邮件地址提供给正则表达式，它将匹配您希望它匹配的内容。

# php - 正则表达式匹配包含子字符串但不包含子字符串的字符串

> ID：15277959
> 
> 赞同：0
> 
> 时间：2013-03-07T17:35:43.463
> 
> 标签：php, regex

我正在尝试编写一个正则表达式，它将匹配包含某个子字符串的字符串，但如果它还包含不同的子字符串则失败。我找到[了这个答案](https://stackoverflow.com/questions/406230/regular-expression-to-match-string-not-containing-a-word)，但我不确定如何让它满足我的需要。为了尽可能具体：

*   是的，它必须将其作为表达式的一部分。我无权访问将处理此问题的代码。
*   是的，它必须是一种表达方式。
*   它需要使用 PHP 的正则表达式风格。我很确定它正在使用 preg 进行评估

为了了解我正在尝试做什么，我有一组我正在尝试过滤的 URL。我想匹配其中包含“/somedir”的 URL，但如果 URL 中也包含“somestring”，我不希望它匹配。

所以，

*   www.somesite.com/somedir/index.html
*   www.somesite.com/somedir/somotherdir/index.html
*   www.somesite.com/somedir/somepage.html

都会匹配，但是，

*   www.somesite.com/somedir/somestring.html
*   www.somesite.com/somedir/somestring/index.html

都会失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T18:01:08.587

*您需要一个正则表达式，只有*当它没有被另一个模式包围时才会接受某个模式：

```
~
    (?(DEFINE)
        (?<ACCEPT> must-contain-pattern)
        (?<REFUSE> must-not-contain-pattern)
    )

    ^
        (?:(?!(?&REFUSE)).)*
            (?&ACCEPT)
        (?:(?!(?&REFUSE)).)*
    $
~ux 
```

在`DEFINE`块中根据您的需要定义`ACCEPT`和模式，这应该可以工作。`REFUSE`

*编辑：*上面的模式通过定义两个命名的子模式为您的情况量身定制：

```
~
    (?(DEFINE)
        (?<ACCEPT> \Q/somedir\E)
        (?<REFUSE> \Qsomestring\E)
    )

    ^
        (?:(?!(?&REFUSE)).)*
            (?&ACCEPT)
        (?:(?!(?&REFUSE)).)*
    $
~ux 
```

# php - 如何使用 php api 更新 chargify next_billing_at 值？

> ID：15277963
> 
> 赞同：0
> 
> 时间：2013-03-07T17:36:19.867
> 
> 标签：php, api, subscription, billing, chargify

我正在使用[https://github.com/jforrest/Chargify-PHP-Client](https://github.com/jforrest/Chargify-PHP-Client)中描述的 php chargify 连接器，我想更新订阅的 next_billing_at 参数。我试着这样做：

```
$requestArr = array('customer_id'=>"$thisCustomerID",'next_billing_at' => '2013-04-20T02:52:17-04:00');
try {
    $connector->requestUpdateSubscription($thisSubscriptionID, json_encode($requestArr), $format = 'JSON');
} catch (ChargifyValidationException $cve) {
    //process error handling code here.
    echo $cve->getMessage();
} 
```

但是，虽然没有验证例外，但当我随后检查下一个评估日期时，它没有改变：

```
$subscriptionUpdated = $connector->getSubscriptionsByID($thisSubscriptionID);
$newBillingDate = $subscriptionUpdated->next_assessment_at;
echo "new next billing date is $newBillingDate<br>"; 
```

我尝试将日期传递为“2013-04-20”，但这也不起作用。是否可以使用 API 更新 chargify 中的计费日期？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T21:21:04.413

您的想法是正确的，除了您的数组应如下所示：

```
$requestArr = array(
    'subscription' => array(
        'customer_id' => $thisCustomerID,
        'next_billing_at' => '2013-04-20'
    )
); 
```

然后你应该很好（经过测试）

参考：[http ://docs.chargify.com/api-subscriptions#api-usage-json-subscriptions-update](http://docs.chargify.com/api-subscriptions#api-usage-json-subscriptions-update)

# java - JSF 从 page1 到 page2（看不到 page2）

> ID：15277965
> 
> 赞同：0
> 
> 时间：2013-03-07T17:36:22.680
> 
> 标签：java, jsp, jsf, jakarta-ee

我有一个网页：TRY，我想从那个页面转到另一个页面：TRY2

jsp TRY.jsp：

```
 <%@taglib uri="http://www.sun.com/webui/webuijsf" prefix="webuijsf"%><%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%>
    <%@ taglib prefix="f"  uri="http://java.sun.com/jsf/core"%>
    <%@ taglib prefix="h"  uri="http://java.sun.com/jsf/html"%>
    <f:view>
<f:loadBundle basename="it.eni.italgas.sam.web.dictionary"
    var="bundle" />
<webuijsf:page id="page1" rendered="#{UserBean.userEnabled}">
    <webuijsf:html id="html1">
        <webuijsf:head id="head1" parseOnLoad="false"
            title="Pagina di prova" webuiOnLoad="false">
            <webuijsf:link id="link1" url="/resources/stylesheet.css" />
        </webuijsf:head>
        <webuijsf:body id="body1" style="-rave-layout: grid"
        styleClass="pageLayout">

            <webuijsf:form id="form1">
            <webuijsf:button actionExpression="#{Prova.button1_action}"
                id="button1"
                style="height: 24px; left: 23px; top: 216px; position: absolute; width: 72px"
                text="#{bundle.TastoConferma}" />
            <webuijsf:calendar dateFormatPattern="dd/MM/yyyy"
                dateFormatPatternHelp="dd/MM/yyyy" id="startDate" immediate="true"
                selectedDate="#{ALGUISessionBean.startDate}"
                style="height: 24px; left: 168px; top: 120px; position: absolute; width: 192px" />
            <webuijsf:calendar dateFormatPattern="dd/MM/yyyy"
                dateFormatPatternHelp="dd/MM/yyyy" id="endDate" immediate="true"
                selectedDate="#{ALGUISessionBean.endDate}"
                style="height: 24px; left: 168px; top: 168px; position: absolute; width: 192px" />
            <webuijsf:dropDown binding="#{AlGui02_1.dropDown1}" id="dropDown1"
                items="#{ALGUI02RequestBean.dropDownPlantList_ricerca}"
                selected="#{ALGUISessionBean.dropDown1SelectedOption_ricerca}"
                style="height: 24px; left: 168px; top: 72px; position: absolute"
                width="260" />
            <webuijsf:label id="label4"
                style="height: 24px; left: 24px; top: 72px; position: absolute; width: 142px"
                text="#{bundle.NomeImpiantoProva}" />
            <webuijsf:label id="label1"
                style="font-size: 14px; height: 24px; left: 24px; top: 24px; position: absolute; width: 432px"
                text="#{bundle.TitoloGuiProva}" />
            <webuijsf:label id="label2"
                style="height: 24px; left: 24px; top: 120px; position: absolute; width: 142px"
                text="#{bundle.DataInizioProva}" />
            <webuijsf:label id="label3"
                style="height: 24px; left: 24px; top: 168px; position: absolute; width: 142px"
                text="#{bundle.DataFineProva}" />
            <webuijsf:message for="startDate" id="message1" showDetail="false"
                showSummary="true"
                style="position: absolute; left: 384px; top: 120px; width: 168px; height: 24px" />
            <webuijsf:message for="endDate" id="message2" showDetail="false"
                showSummary="true"
                style="position: absolute; left: 384px; top: 168px; width: 168px; height: 24px" />
            <h:messages errorClass="errorMessage" fatalClass="fatalMessage"
                globalOnly="true" id="messageList1" infoClass="infoMessage"
                style="border-width: 1px; height: 22px; left: 24px; top: 264px; position: absolute"
                warnClass="warnMessage" />
            <br />
        </webuijsf:form>
    </webuijsf:body>
    </webuijsf:html>
</webuijsf:page> 
```

TRY2的jsp：

```
 <%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%>
  <%@taglib uri="http://www.sun.com/webui/webuijsf" prefix="webuijsf"%>
  <%@ taglib prefix="f"  uri="http://java.sun.com/jsf/core"%>
  <%@ taglib prefix="h"  uri="http://java.sun.com/jsf/html"%>
  <f:view>

<webuijsf:page id="page1">
    <webuijsf:html id="html1">
        <webuijsf:head id="head1" parseOnLoad="false"
            title="Pagina di prova2" webuiOnLoad="false">
            <webuijsf:link id="link1" url="/resources/stylesheet.css" />
        </webuijsf:head>
        <webuijsf:body id="body1" style="-rave-layout: grid"
        styleClass="pageLayout">

        TRY TRY

        </webuijsf:body>
    </webuijsf:html>
</webuijsf:page> 
```

用于 TRY 的 Java 托管 bean：

```
public class TRY extends AbstractPageBean{

private String nomeClasse = this.getClass().getSimpleName();
private String distrib = getUserBean().getCurrentDatasource();
private String username = getUserBean().getUser();
private Date startDate;
private Date endDate;
private DropDown dropDown1;

private Logger logger;

public TRY() {

    logger = Logger.getLogger(getClass());

    logger.debug("Class TRY....");
}

@Override
public void init() {
    super.init();

    try {
        log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.INIT, LogMessages.INIT_OK), null);
    } catch (Exception e) {
        log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.INIT, "KO: " + e.getMessage()), null);
        throw e instanceof FacesException ? (FacesException) e : new FacesException(e);
    }
}

@Override
public void preprocess() {
    try {

        getUserBean().navigationStatus();
        log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.PREPROCESS, "OK"), null);
    } catch (IOException e) {
        log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.PREPROCESS, "KO: " + e.getMessage()), null);
    }
}

@Override
public void prerender() {
    try {

        logger.debug("Class TRY....PRERENDER");

        getUserBean().navigationStatus();
        log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.PRERENDER, "OK"), null);

        ALGUISessionBean session = getALGUISessionBean();

        if (session.isError()) {
            log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.PRERENDER, LogMessages.PRERENDER_VAL_ER), null);
            session.setError(false);
        } else {
            resetOwnSessionVars();
        }

        logger.debug("Classe di prova....PRERENDER fine");
    } catch (Exception e) {
        log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.PRERENDER, "KO: " + e.getMessage()), null);
    }
}

@Override
public void destroy() {
    log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.DESTROY, LogMessages.DESTROYED), null);
}

/* -------------------
 * - GETTER & SETTER -
 * ------------------*/
protected ALGUISessionBean getALGUISessionBean() {
    return (ALGUISessionBean) getBean("ALGUISessionBean");
}

protected UserBean getUserBean() {
    return (UserBean) getBean("UserBean");
}

public DropDown getDropDown1() {
    return dropDown1;
}

public void setDropDown1(DropDown dd) {
    this.dropDown1 = dd;
}

private void resetOwnSessionVars() {

    ALGUISessionBean session = getALGUISessionBean();

    log(LogMessages.getLogString(username, distrib, nomeClasse, "resetOwnSessionVars", LogMessages.INIZIO), null);
    session.setStartDate(null);
    session.setEndDate(null);
    session.setdropDown1SelectedOption_ricerca(null);
    session.setPlantLabel(null);
    log(LogMessages.getLogString(username, distrib, nomeClasse, "resetOwnSessionVars", LogMessages.FINE), null);
}

public String button1_action() {

     logger.debug("Class prova....button1_action ");
     ALGUISessionBean session = getALGUISessionBean();

     log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.BUTTON1, LogMessages.INIZIO), null);

     session.setStartDate(startDate);
     session.setEndDate(endDate);
     logger.debug("Class prova....button1_action return ");

     return "TRY2";
}

} 
```

TRY2 的 Java 托管 bean：

```
public class TRY2 extends AbstractPageBean{

private String nomeClasse = this.getClass().getSimpleName();
private String distrib = getUserBean().getCurrentDatasource();
private String username = getUserBean().getUser();

private Logger logger;

public TRY2() {

    logger = Logger.getLogger(getClass());

    logger.debug("Class  TRY2....");
}

@Override
public void init() {
    super.init();

    try {
        log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.INIT, LogMessages.INIT_OK), null);
    } catch (Exception e) {
        log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.INIT, "KO: " + e.getMessage()), null);
        throw e instanceof FacesException ? (FacesException) e : new FacesException(e);
    }
}

@Override
public void preprocess() {
    try {

        getUserBean().navigationStatus();
        log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.PREPROCESS, "OK"), null);
    } catch (IOException e) {
        log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.PREPROCESS, "KO: " + e.getMessage()), null);
    }
}

@Override
public void prerender() {
    try {

        logger.debug("Class  TRY2....PRERENDER");

        getUserBean().navigationStatus();
        log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.PRERENDER, "OK"), null);

    } catch (Exception e) {
        log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.PRERENDER, "KO: " + e.getMessage()), null);
    }

    ALGUISessionBean session = getALGUISessionBean();

    if (session.isError()) {
        log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.PRERENDER, LogMessages.PRERENDER_VAL_ER), null);
        session.setError(false);
    } else {
        resetOwnSessionVars();
    }
}

@Override
public void destroy() {
    log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.DESTROY, LogMessages.DESTROYED), null);
}

/* -------------------
 * - GETTER & SETTER -
 * ------------------*/
protected ALGUISessionBean getALGUISessionBean() {
    return (ALGUISessionBean) getBean("ALGUISessionBean");
}

protected UserBean getUserBean() {
    return (UserBean) getBean("UserBean");
}
}
} 
```

以及 face-config.xml 中的 naviagion 规则

```
 <navigation-rule>
     <from-view-id>/TRY.jsp</from-view-id>
   <navigation-case>
   <from-outcome>TRY2</from-outcome>
   <to-view-id>/TRY2.jsp</to-view-id>
   </navigation-case>
   </navigation-rule>

  <managed-bean>
  <managed-bean-name>TRY</managed-bean-name>
  <managed-bean-class>web.TRY</managed-bean-class>
  <managed-bean-scope>request</managed-bean-scope>
  </managed-bean>
  <managed-bean>
  <managed-bean-name>TRY2</managed-bean-name>
  <managed-bean-class>web.TRY2</managed-bean-class>
  <managed-bean-scope>request</managed-bean-scope>
  </managed-bean> 
```

记录器告诉我：

```
 logger.debug("Class TRY....button1_action ");    

  logger.debug("Class TRY....button1_action return "); 
```

所以这意味着它进入方法 button_click

我看到它的日志：

```
 logger.debug("Class TRY2....");

  logger.debug("Class TRY2....PRERENDER"); 
```

所以这意味着它进入了 bean TRY2

但是在我看不到页面 TRY2 之后为什么？

我看到 javascript 说：

```
 <script type="text/javascript">new webui.suntheme4_2.body('/TRY2.jsp', '/sam-fe-web/faces/TRY2.jsp',null,null,'com_sun_webui_util_FocusManager_focusElementId',true);</script></body></html>

  Uncaught TypeError: undefined is not a function 
```

有什么帮助吗？

没有人帮助我真的非常感谢你......

解决方案是添加

```
private void _init() throws Exception {
}

private Page page1 = new Page();

public Page getPage1() {
    return page1;
}

public void setPage1(Page p) {
    this.page1 = p;
}
private Html html1 = new Html();

public Html getHtml1() {
    return html1;
}

public void setHtml1(Html h) {
    this.html1 = h;
}
private Head head1 = new Head();

public Head getHead1() {
    return head1;
}

public void setHead1(Head h) {
    this.head1 = h;
}
private Link link1 = new Link();

public Link getLink1() {
    return link1;
}

public void setLink1(Link l) {
    this.link1 = l;
}
private Body body1 = new Body();

public Body getBody1() {
    return body1;
}

public void setBody1(Body b) {
    this.body1 = b;
}
private Form form1 = new Form();

public Form getForm1() {
    return form1;
}

public void setForm1(Form f) {
    this.form1 = f;
}
private Link link2 = new Link();

public Link getLink2() {
    return link2;
}

public void setLink2(Link l) {
    this.link2 = l;
} 
```

和

```
 public void init() {
    super.init();

    logger.debug("Classe di prova....INIT");

    try {
         _init();
        log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.INIT, LogMessages.INIT_OK), null);
    } catch (Exception e) {
        log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.INIT, "KO: " + e.getMessage()), null);
        throw e instanceof FacesException ? (FacesException) e : new FacesException(e);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:13:23.700

```
 add this into the TRY2.java class

 private void _init() throws Exception {
 }

 private Page page1 = new Page();

 public Page getPage1() {
      return page1;
 }

 public void setPage1(Page p) {
     this.page1 = p;
 }
 private Html html1 = new Html();

 public Html getHtml1() {
     return html1;
 }

 public void setHtml1(Html h) {
     this.html1 = h;
 }
 private Head head1 = new Head();

 public Head getHead1() {
     return head1;
 }

 public void setHead1(Head h) {
     this.head1 = h;
 }
 private Link link1 = new Link();

 public Link getLink1() {
     return link1;
 }

 public void setLink1(Link l) {
     this.link1 = l;
 }
 private Body body1 = new Body();

 public Body getBody1() {
     return body1;
 }

 public void setBody1(Body b) {
     this.body1 = b;
 }
 private Form form1 = new Form();

 public Form getForm1() {
     return form1;
 }

 public void setForm1(Form f) {
     this.form1 = f;
 }
 private Link link2 = new Link();

 public Link getLink2() {
          return link2;
 }

 public void setLink2(Link l) {
     this.link2 = l;
 } 
```

并以这种方式编辑 init() ：

```
public void init() {
super.init();

logger.debug("Classe di prova....INIT");

try {
     _init();
    log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.INIT, LogMessages.INIT_OK), null);
} catch (Exception e) {
    log(LogMessages.getLogString(username, distrib, nomeClasse, LogMessages.INIT, "KO: " + e.getMessage()), null);
    throw e instanceof FacesException ? (FacesException) e : new FacesException(e);
}
} 
```

# windows - 通过 WebScripting 知道 windows 用户名

> ID：15277972
> 
> 赞同：1
> 
> 时间：2013-03-07T17:36:46.940
> 
> 标签：windows, wsh

亲爱的程序员，再次向大家问好，

我想知道是否可以通过 Web 脚本（Javascript、PHP、ASP.NET、Java、Flash .. Everything）获取 PC 的 Windows/Mac/Linux 用户名

我知道通常网络脚本无法访问机器，但我在这里了解你们所有人的意见。

请尝试帮助我，我真的需要找到解决方案。

提前致谢。狐狸。

# css - 将 div 垂直放置在中间

> ID：15277974
> 
> 赞同：1
> 
> 时间：2013-03-07T17:36:53.767
> 
> 标签：css

我将如何在中间水平/垂直设置 div？

到目前为止，这是我的代码：

**HTML**

```
<div id="outer">
    <div id="inner">
        <div id="signin_header">
        Sign in
        </div>
    </div>
</div> 
```

**CSS**

```
html, body {
    height: 100%;
}
html {
    display: table;
    margin: auto;
    height: 100%;
}
body {
    display: table-cell;
}
#outer {
    width: 100%;
    text-align: center;
    height: 100%;
}
#inner {
    display: inline-block;
    background-color: rgb(245, 245, 245);
    background-image: none;
    background-origin: padding-box;
    background-size: auto;
    border-bottom-color: rgb(229, 229, 229);
    border-bottom-style: solid;
    border-bottom-width: 1px;
    border-left-color: rgb(229, 229, 229);
    border-left-style: solid;
    border-left-width: 1px;
    border-right-color: rgb(229, 229, 229);
    border-right-style: solid;
    border-right-width: 1px;
    border-top-color: rgb(229, 229, 229);
    border-top-style: solid;
    border-top-width: 1px;
    display: block;
    font-family: 'segoe ui', arial, helvetica, sans-serif;
    font-size: 13px;
    width: 300px;
    padding: 25px;
}
#signin_header {
    color: rgb(34, 34, 34);
    display: block;
    font-family: 'segoe ui', arial, helvetica, sans-serif;
    font-size: 16px;
    font-weight: normal;
    height: 16px;
    line-height: 16px;
    margin-top: 0px;
    width: 283px;
    text-align: left;
} 
```

小提琴可以在这里找到

[http://jsfiddle.net/yaFeD/](http://jsfiddle.net/yaFeD/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:42:33.633

假设您正在尝试使登录 div 居中（而不是字母本身），这是您需要的新 CSS，在您的 jsfiddle 中通过使用`margin: 0 auto;`并将`position: relative;`div 设置在该 div 的中间进行测试。

```
#signin_header {
    color: rgb(34, 34, 34);
    display: block;
    font-family: 'segoe ui', arial, helvetica, sans-serif;
    font-size: 16px;
    font-weight: normal;
    height: 16px;
    line-height: 16px;
    margin: 0 auto;
    position: relative;
    width: 283px;
} 
```

编辑：我也把你`text-align: left;`带走了

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:49:31.033

这就是你所追求的吗？我想这就是你想要的？

```
html, body {
height: 100%;
}
html {
display: table;
margin: auto;
height: 100%;
}
body {
display: table-cell;
}
#outer {
width: 100%;
text-align: center;
height: 100%;
position:relative;
top:50%;
bottom:50%;
}
#inner {
display: inline-block;
background-color: rgb(245, 245, 245);
background-image: none;
background-origin: padding-box;
background-size: auto;
border-bottom-color: rgb(229, 229, 229);
border-bottom-style: solid;
border-bottom-width: 1px;
border-left-color: rgb(229, 229, 229);
border-left-style: solid;
border-left-width: 1px;
border-right-color: rgb(229, 229, 229);
border-right-style: solid;
border-right-width: 1px;
border-top-color: rgb(229, 229, 229);
border-top-style: solid;
border-top-width: 1px;
display: block;
font-family: 'segoe ui', arial, helvetica, sans-serif;
font-size: 13px;
width: 300px;
padding: 25px;
}
#signin_header {
color: rgb(34, 34, 34);
display: block;
font-family: 'segoe ui', arial, helvetica, sans-serif;
font-size: 16px;
font-weight: normal;
height: 16px;
line-height: 16px;
margin-top: 0px;
width: 283px;
text-align: left;
} 
```

[http://jsfiddle.net/EQjHz/](http://jsfiddle.net/EQjHz/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:41:19.023

添加`margin:auto;`到内部 div 就可以了。当您只需要水平对齐时，只需添加`margin-left:auto;margin-right:auto;`. 同样对于垂直对齐，添加`margin-bottom:auto;margin-top:auto;`

# javascript - 如何使用纯 JavaScript 在 DOM 中将元素从一个位置移动到另一个位置？

> ID：15277975
> 
> 赞同：3
> 
> 时间：2013-03-07T17:36:56.643
> 
> 标签：javascript

我知道如何在 jQUery 中做到这一点（未经测试但应该可以）：

```
$('#foo').html().appendTo('#bar');
$('#foo').remove(); 
```

但是如何在纯 JS 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:42:23.733

```
field = document.getElementById('e');
document.getElementById('x').innerHTML = field.parentNode.innerHTML;
field.parentNode.removeChild(field); 
```

这是一种解决方案，您也可以搜索[clonenode](http://www.w3schools.com/dom/met_element_clonenode.asp)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T17:45:19.363

您的 jQuery 代码可以在纯 javascript 中像这样完成：

```
var foo = document.getElementById("foo"),
    bar = document.getElementById("bar");
bar.innerHTML = foo.innerHTML;
foo.parentNode.removeChild(foo); 
```

但这只是将内部的 html 代码复制`foo`为`bar`字符串，然后`foo`从 DOM 中删除。

也可以移动节点，如下所示：

```
var foo = document.getElementById("foo"),
    bar = document.getElementById("bar");
bar.innerHTML = "";
for (var node in foo.childNodes) {
    bar.appendChild(node);
}
foo.parentNode.removeChild(foo); 
```

这会将实际的子节点移动`foo`到`bar`，然后删除现在为空的`foo`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T17:48:47.477

创建元素

```
 <div id="div1">
     <p id="p1">This is a paragraph.</p>
     <p id="p2">This is another paragraph.</p>
    </div>

    <script>
    var para=document.createElement("p");
     var node=document.createTextNode("This is new.");
    para.appendChild(node);

     var element=document.getElementById("div1");
    element.appendChild(para);
    </script> 
```

移除一个元素（你必须知道父元素）

```
 <div id="div1">
     <p id="p1">This is a paragraph.</p>
     <p id="p2">This is another paragraph.</p>
    </div>
    <script>
     var parent=document.getElementById("div1");
      var child=document.getElementById("p1");
      parent.removeChild(child);
    </script> 
```

[由http://www.w3schools.com/js/js_htmldom_elements.asp](http://www.w3schools.com/js/js_htmldom_elements.asp)带给您

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T18:15:44.603

在最简单的情况下，有这种可能性：

```
var foo = document.getElementById('foo');
document.getElementById('bar').innerHTML = foo.innerHTML;
foo.parentNode.removeChild(foo); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/CESGq/)。

并且，使用函数来最小化重复：

```
function moveTo(source,target){
    if (!source || !target) {
        return false;
    }
    else {
        var children = source.childNodes;
        while (children.length){
            target.appendChild(children[0]);
        }
        source.parentNode.removeChild(source);
    }
}

var bar = document.getElementById('bar'),
    foo = document.getElementById('foo');

moveTo(foo, bar); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/CESGq/1/)。

# android - 膨胀视图的布局参数被忽略

> ID：15277976
> 
> 赞同：1
> 
> 时间：2013-03-07T17:36:58.530
> 
> 标签：android, layout, view, inflate

我放大了一个视图并将其添加到我的布局中：

```
LayoutInflater inflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
View vi = inflater.inflate(R.layout.to_add,null,false);

DyL.addView(vi); 
```

我想动态更改视图参数（高度）但`getLayoutParams`不起作用，我总是有一个空结果。那么我该怎么做呢？我尝试了我在网上找到的所有解决方案，但没有成功。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T17:55:41.537

尝试设置父视图，

```
View vi = inflater.inflate(R.layout.to_add, DyL, false); 
```

DyL 是你的父视图

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2013-03-16T07:33:17.743

不需要时在参数中使用您的父视图`parent.add(vi)`

```
View vi = inflater.inflate(R.layout.to_add, parent , false); 
```

# mod-pagespeed - 有没有办法使用 mod_pagespeed 在视口中显示之前延迟加载图像？

> ID：15277981
> 
> 赞同：3
> 
> 时间：2013-03-07T17:37:08.107
> 
> 标签：mod-pagespeed

我使用 将我的图像配置`.htaccess`为延迟加载图像`mod_pagespeed`，但我不想通过显示尚未加载的图像来影响用户体验。

有没有办法在使用 mod_pagespeed 在视口中可见之前设置配置和延迟加载图像一些像素？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T18:40:57.917

如果您在 mod_pagespeed 中启用图像延迟加载，默认行为是在“滚动时”加载图像。我们确实有现有的代码路径可以将其更改为“onload” - 也就是在 onload 触发后加载图像，但不幸的是我们尚未将其公开为配置标志。即将发布的版本之一的功能！:-)

当前过滤器文档： [https ://developers.google.com/speed/docs/mod_pagespeed/filter-lazyload-images](https://developers.google.com/speed/docs/mod_pagespeed/filter-lazyload-images)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T19:08:56.473

不幸的是，目前没有办法在延迟加载开始加载图像时添加“偏移量”。它当前设置在视口的底部，并且没有公开任何选项来配置它。但是，我认为这将是一个很有价值的公开选项，我已在[https://code.google.com/p/modpagespeed/issues/detail?id=644](https://code.google.com/p/modpagespeed/issues/detail?id=644)记录了您的功能请求。

# delphi - UTF8Decode 和 D5 混淆

> ID：15277988
> 
> 赞同：0
> 
> 时间：2013-03-07T17:37:41.970
> 
> 标签：delphi, utf-8, delphi-5

有点超出我的深度，但在提问之前会努力研究。这有点长，但我会尽力提供我迄今为止所做的一切。

我正在尝试编译 Hunspell 示例项目。我已经退休了，我一直坚持使用 D5ent，因为我现在只为自己编程，所以买不起更高的版本。

我遇到的第一个问题是 PPChar，但一些搜索建议有两个选项可以在 D5 中复制它。

```
type
  PPChar = Array[0..0] of PChar; { with Range check off } 
```

或者

```
 PPChar = Array of PChar; 
```

两者似乎都可以编译。但在项目的最后部分，为了显示项目的拼写建议......

```
Memo1.Lines.Add(UTF8Decode(wrds^)); 
```

D5 中不存在 UTF8Decode，因此更多的研究出现在此页面上。 [Utf8ToString 和旧的 Delphi 版本](https://stackoverflow.com/questions/7518885/utf8tostring-and-older-delphi-versions)

感谢 Arnaud，我下载并创建了两个单元 SynCommons 和 SynLZ（SynCommons 需要）。我包括了 Arnaud 描述的例程，然后更改了项目

```
Memo1.Lines.Add(UTF8Decode(wrds^)); 
```

至

```
Memo1.Lines.Add(UTF8DecodeToString(@wrds,SizeOf(@wrds))); 
```

编译好，但是当我运行项目时，我得到一个图形字符列表。

最后是问题：我做错了什么？我如何使它工作？

谢谢

# python - 包括其他 URL 模式

> ID：15277992
> 
> 赞同：1
> 
> 时间：2013-03-07T17:38:04.847
> 
> 标签：python, django, url

我有一个我认为是我在 django 中构建的公共 API 的非常简单的 URL 配置：

```
# public API, in urls.py
(r'^api/', include('api.urls'))

# in api/urls.py
api_key_patterns = patterns('api.geoprocessing',
    url(r'^land-use/', 'landUse', name='geoprocessing_land_use'))

urlpatterns = patterns('',
    url(r'^(?P<api_key>(.+))/', include(api_key_patterns))) 
```

但是，当我向`/api/123/land-use/`Django 的 URL 解析器发出请求时，找不到匹配项。当我调试它尝试过的网址时，它会将上述问题解决为：

```
^api/ (?P<api_key>(.+))/ land-use/ [name='geoprocessing_land_use'] 
```

`(?P<api_key>(.+))`注意和之间的空格`land-use`。为什么要为每个包含插入这些空格，我怎样才能得到匹配？

## 更新

如果我硬编码一个网址，`^api/(?P<api_key>(.+))/land-use/`我就能得到匹配。

`/`此外，如果我在尾随URL 匹配后添加一个字符也可以：

```
api_key_patterns = patterns('api.geoprocessing', url(r'^and-use/$', 'landUse',name='geoprocessing_land_use'))
urlpatterns = patterns('', url(r'^(?P<api_key>(.+))/l', include(api_key_patterns))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:49:12.847

尝试：

```
urlpatterns = patterns('api.geoprocessing',
    url(r'^land-use/(?P<api_key>(.+))/$', 'landUse',
        name='geoprocessing_land_use'))
) 
```

当您似乎不需要这样做时，我不确定您通过包含一个模式来尝试完成什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T18:22:05.947

看起来`(.+)`在我的正则表达式中使用一个组迫使 django URL 解析器寻找一个不存在的字符。当斜杠后面有字符时，这总是会解析，但是当该组位于 url 段的末尾时，末尾会标记一个空格。

`(.+)`我通过用一个简单的单词匹配器交换组来解决这个问题`\w+`：

```
(r'^api/(?P<api_key>\w+)/', include('api.api')), 
```

# android - OnGestureListener 取消 onCreateContextMenu

> ID：15277997
> 
> 赞同：0
> 
> 时间：2013-03-07T17:38:12.717
> 
> 标签：android, adapter, gestures, android-contextmenu

我有一个`OnGestureListener`我的，`ListView`因为我需要对它做手势，但现在`ContextMenu`不起作用。

**编辑代码：**

我在**`onActivityCreated`**我的方法中有**`Fragment`** 这个`ListView`：

```
gestureDetector = new GestureDetector(getActivity(),
            new GestureListener());
    View.OnTouchListener gestureListener = new View.OnTouchListener() {
        public boolean onTouch(View v, MotionEvent event) {
            return gestureDetector.onTouchEvent(event);
        }
    };
    listView.setOnTouchListener(gestureListener); 
```

这样做允许我的手势，但是，评论它会带回我的 ConextMenu。

我知道我可以使用 showContextMenu(v)，但如果这是答案，我不确定在哪里放置它（我在几个地方尝试过）。

在我设置适配器的片段中，我有这个空方法，

```
public void onLongPress(MotionEvent e) {

    return;
} 
```

我尝试将代码放在那里，但没有对视图的引用。所以不知道如何进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:00:02.553

您仍然可以使用`GestureDetector`“查看”投掷手势，并且`ContextMenu`在长按回调时`ListView`使用以下代码打开：`onLongPress()`

```
@Override
public void onLongPress(MotionEvent e) {
    registerForContextMenu(listView);
    final int x = (int) e.getX();
    final int y = (int) e.getY();
    int position = listView.pointToPosition(x, y);
    final int firstVisible = listView.getFirstVisiblePosition();
    View v = listView.getChildAt(position - firstVisible);
    getActivity().openContextMenu(v);
} 
```

[可以在此处找到](https://gist.github.com/luksprog/5117998)完整的`Fragment`类示例。

# c++ - 在 3D 坐标系中查找矩形中的角点

> ID：15277999
> 
> 赞同：3
> 
> 时间：2013-03-07T17:38:20.447
> 
> 标签：c++, 3d, openni, point-cloud-library

我有 3D 点，它们构成矩形的 2 或 3 边。如何计算立方体角的坐标？可能吗？

![个人电脑](../Images/d64b2d0d9fe900bfb8d3f95dc9265406.png) ![个人电脑](../Images/11a9566721e6baba180875eca8f5b7f3.png) ![个人电脑](../Images/406c61b84e092170f8285b9deb190830.png) ![个人电脑](../Images/46512b019dd4803cecf01d935d48aca1.png)

更新：[https ://github.com/CPIGroup/3d-Camera-scanDimensions](https://github.com/CPIGroup/3d-Camera-scanDimensions)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T18:43:47.797

这只是一个想法，而不是经过验证的方法。

首先，找到飞机。随机选择 3 个点，找到一个通过它们的平面，对 4 个参数进行归一化。重复 1000 次左右。你最终会得到 1000 个 4 元组的数字。使用其中一种[聚类分析](http://en.wikipedia.org/wiki/Cluster_analysis#Density-based_clustering)方法来查找 2 或 3 组非常接近的 4 元组。平均每个组。这些大约是您盒子侧面的平面。

现在让它们更精确。对于每个平面，找到靠近它但不靠近其他平面的所有点（对于“关闭”的某些值，也许也可以使用聚类方法找到）。对于每一组这样的点，使用[最小二乘法](http://en.wikipedia.org/wiki/Least_squares)找到一个最佳拟合平面。

如果您有三架飞机，那就太好了；相交它们，你有一个顶点和三个边。对于两个平面，你只有一个边。无论哪种方式，您现在都可以尝试找到其他边缘。为简单起见，将您的平面视为 XY 平面，将已知边视为 X 轴。您现在需要找到最左边（最右边）的垂直线，这样大部分点都在它的左边（分别是右边）。将所有点投影到 X 轴。你现在有一个原始问题的一维案例：在某个区间上有很多随机点，找到区间。再次使用聚类方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T11:54:13.193

我对此不是很有经验，但是您可以使用 RANSAC 吗？似乎有很多关于[使用 RANSAC 从点云进行平面检测的论文](https://www.google.co.uk/search?q=ranscac%20plane%20detection%20from%20point%20cloud&aq=f&oq=ranscac%20plane%20detection%20from%20point%20cloud&aqs=chrome.0.57.15922&sourceid=chrome&ie=UTF-8)

您也可能想看看点云库（PCL）。这是一个非常令人印象深刻的项目，具有许多有用的功能，包括[平面分割](http://pointclouds.org/documentation/tutorials/planar_segmentation.php#planar-segmentation)

一旦检测到平面，就应该找到边缘/角落，这应该简单得多。