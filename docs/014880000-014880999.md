# StackOverflow 问答 14880000-14880999

# mysql - 如何在 SQL Server 导入和导出向导中选择 MySQL 目标表？

> ID：14880004
> 
> 赞同：1
> 
> 时间：2013-02-14T16:54:43.420
> 
> 标签：mysql, sql-server, ssis

我已经成功地将一些数据从远程*`MySQL`*数据库传输到我们的本地*`SQL Server`*数据库。

我现在正试图将一些数据发送回*MySQL*并遇到一些问题。我正在使用**`SQL Server Import and Export Wizard`**. 当我指定一个查询以将数据发送回*MySQL*时，我会到达映射阶段，它只会让我创建一个名为*`Query`*将数据传递到的新表。

我无法从我的*MySQL*数据库中选择现有表，它只是显示*`Query`*或空白。

有谁知道为什么不显示表格？我相信可以完成这项基本任务并填充或更新现有表。

我以前曾**`SqlYog`**用于将数据从*SQL Server*传输到*MySQL*，但它只能以一种方式工作。

我想要一个在*MySQL*和*SQL Server*之间发送和检索数据的解决方案。

感谢您提供任何帮助，如果您知道我可能会从中受益的任何其他工具，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T03:40:17.457

导入和导出向导生成（并可选择运行）一个 SSIS 包。如果向导中断，我将使用 BIDS (Visual Studio) 手动构建 SSIS 包。

然后（取决于您使用的驱动程序）您可能需要数据流中的 OLE DB 目标或 ADO NET 目标来传递数据。

# android - 使用谷歌地图的应用程序只显示灰色瓷砖

> ID：14880005
> 
> 赞同：0
> 
> 时间：2013-02-14T16:54:46.943
> 
> 标签：android, google-maps

我正在尝试制作一个使用谷歌地图的应用程序，并且我已经尝试了几乎所有东西，但是我手机上的应用程序现在只显示灰色瓷砖。我确信我的 API 密钥是正确的。

这是我的代码

```
package net.learn2develop.GoogleMaps;

import com.google.android.gms.maps.MapView;
import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapController;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;

public class MapsActivity extends MapActivity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
}

@Override
protected boolean isRouteDisplayed() {
    // TODO Auto-generated method stub
    return false;
}

} 
```

和xml文件

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android" 
android:layout_width="fill_parent" 
android:layout_height="fill_parent">

<com.google.android.maps.MapView 
    android:id="@+id/mapView"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:enabled="true"
    android:clickable="true"
    android:apiKey="AIzaSyBZxTMbzMOaFHau-awITz9CtnxZJkYzryg"
    />

</RelativeLayout> 
```

和 android 清单

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="net.learn2develop.GoogleMaps"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="8" />

<uses-feature
    android:glEsVersion="0x00020000"
    android:required="true"/>

 <uses-permission android:name="android.permission.INTERNET" />
 <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
 <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
 <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
 <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
 <permission
      android:name="net.learn2develop.GoogleMaps.permission.MAPS_RECEIVE"
      android:protectionLevel="signature"/>
 <uses-permission android:name="net.learn2develop.GoogleMaps.permission.MAPS_RECEIVE"/>

 <application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="AIzaSyBZxTMbzMOaFHau-awITz9CtnxZJkYzryg"/>
    <uses-library android:name="com.google.android.maps"></uses-library>
    <activity
        android:name=".MapsActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:15:25.897

要么您缺少 Internet 连接，要么您的 API 密钥未被授权用于您的包名称和签名密钥签名的组合。检查 LogCat 以获取与授权相关的警告。

# machine-learning - 我想建立一个交互式机器学习系统，使用尽可能多的现成软件对物品进行分类

> ID：14880008
> 
> 赞同：2
> 
> 时间：2013-02-14T16:55:01.577
> 
> 标签：machine-learning, artificial-intelligence, neural-network

我有一个复杂的问题，我想用机器学习来解决，但是因为我是机器学习的新手，所以我会先尝试解决一个非常简单的问题来练习。基本问题是：我可以通过下载/定制现成的（免费或商业）软件来创建多少？

想象一个能够理解动物园里动物的系统。我将追踪它们的一些简单特征：它们吃什么？它们是夜间活动的还是白天活动的？它们如何移动（滑行、游泳、飞行、行走、爬行），它们有几条腿？等等。每只动物可能有十几个属性，也可能是训练集中已知的所有属性。

我想用一些关于一群动物的事实来启动这个系统，我会告诉它这些都是真实的事实。然后，我基本上想说“好吧，我有一只新动物”并让它问我关于动物的信息。根据它对所拥有数据的了解，我希望它优先考虑问题（即，首先询问最有用的问题）。当它了解新动物时，我希望它开始猜测答案。例如，“它是夜间活动吗？我认为，有 68% 的信心，它是”，我会告诉它“是的，你是对的”。

我想添加关于动物的新属性。也许他们是否是掠食者。显然，我必须从一开始就提供数据，但我希望系统具有足够的适应性，能够接受这样的新属性，并在获取数据时逐渐开始对其相关性建立信心。

一个有趣的类似系统是在20q.net，它播放“20个问题”并且非常好。我并不是想玩那个游戏，但那是我正在寻找的那种互动性。我的难题看起来有点像 20 个问题的问题。将有成百上千的已知属性。任何给定的“事物”可能只有几十个答案是已知的，而其他数百个的答案将是未知的。根据已知情况，解决难题的系统将不得不选择要询问的问题以获取更多信息。

我见过 Weka，我什至在其中加载了一些数据集。这似乎是构建我的交互式系统的正确引擎吗？是否有工具包（Weka 或其他）可以让构建这样的系统变得简单？即，我可以下载（或购买）和定制多少，我需要自己构建多少？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-18T17:32:22.637

Hello :) Nice to meet you. I'm trying to do something similar.

I have researched the necessary data types required for a program in order to understand, learn and, therefore, ask (to learn some more).

My approach is to teach the program just like a little baby. But a little baby gets bored, distracted and doesn't get it the first time. So a computer program would act the same, until it has the basic tools for understanding, like language.

My current model is this

1.  create a (blank) database; -- this database has some tables like : words, sentences, actions etc.
2.  create a program that can receive input (sentences); parses the sentences, saves words, tries to **make sense of the sentence** (see python nltk); if the sentence requires output then try to search for output by looking in the database for saved actions. If there are no actions then the program asks the user for the result or hints. If you build a script that searches the answer on the web (good luck) then the program asks the user if it is allowed to look-up the answer online. If the program cannot resolve the users' request, then it builds up interest on that request.

3.  I'm also trying to create a tree of synapses based on the input-output process. EG: the table of synapses has these fields : 1\. id; 2\. id_object (more on that later) 3\. id_parent (the id of the parent synapse). This would be useful if, say, you would want the program to be multi-tasking and remember the discussions so that you would not have to repeat every command over and over.

For instance: I'll prompt the program to search a "THING" for me and "PERFORM" an "ACTION" with that "THING". This requires RAM-like learning (temporary memory) in order to firstly search for the "THING" and (after and IF it finds it) "PERFORM" the (heh based on the programs' synapses history) best matched "ACTION" that it could find.

This is not an answer to your question because you need to understand databases and nltk before you can continue. This is my concept (or approach) of creating a literally learning machine.

Cheers!

# c# - UI 线程和后台线程使用相同的全局变量

> ID：14880011
> 
> 赞同：0
> 
> 时间：2013-02-14T16:55:12.483
> 
> 标签：c#, multithreading

我希望 pictureBox1 在 UI（主线程）中显示 CurrImage，同时在后台线程中修改 CurrImage，这需要一些时间才能完成。当后台线程完成处理后，它应该在pictureBox1 中将旧的CurrImage 替换为这个新的。

1）我得到一个异常 2）我在 UI 线程中尝试了一个不同的图像变量，同时在后台线程中修改 CurrImage 并且效果很好。

如何管理两个线程以在同一个全局变量上运行？提前致谢

```
private Image CurrImage; int index; 
```

`private void button4_Click(object sender, EventArgs e) {`

```
 index++;
        if (index >= images.Count) index = 0;
        CurrImage = images[index]; if (!bkGrndWker2.IsBusy)  bkGrndWker2.RunWorkerAsync();
        pictureBox1.Image = CurrImage;    
    }

   private void bkGrndWker2_DoWork(object sender, DoWorkEventArgs e)
    {
        this.pictureBox1.Image = Iprocessing.Colour_style1((Bitmap)CurrImage);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:01:46.757

简单：不要从后台线程访问 PictureBox。

```
private int index;

private async void button4_Click(object sender, EventArgs e) 
{ //      ↑
    index++;
    if (index >= images.Count) index = 0;
    var bitmap = (Bitmap)images[index];

    pictureBox1.Image = bitmap;
    pictureBox1.Image = await Task.Run(() =>
    { //                  ↑
        return Iprocessing.Colour_style1(bitmap);
    });
} 
```

请参阅：[使用 Async 和 Await 进行异步编程](http://msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx)

# objective-c - 从 pvr 纹理中奇怪的 CCSprites 定位

> ID：14880013
> 
> 赞同：0
> 
> 时间：2013-02-14T16:55:32.230
> 
> 标签：objective-c, cocos2d-iphone, kobold2d

我使用 Kobold2D + TexturePacker（目前都是最后一个版本）。

当我使用 spriteWithFile: 方法创建一个 CCSprite 对象并按原样放置时，它看起来很好。

```
CGSize screenSize = [CCDirector sharedDirector].winSize;

background = [CCSprite spriteWithFile:@"dir_bg.png"];
background.position = CGPointMake(screenSize.width - background.texture.contentSize.width / 2 - 10, background.texture.contentSize.height / 2 + 10);

[self addChild:background];

controller = [CCSprite spriteWithFile:@"dir_big.png"];
controller.position = background.position;

[self addChild:controller]; 
```

![spriteWithFile:](../Images/82ba5ebb3af2e5fd447fc3418902d9b8.png)

但是使用不同的方法，使用 spriteWithSpriteFrameName: 加载纹理时，对象不会按应有的方式放置。

```
[CCTexture2D PVRImagesHavePremultipliedAlpha:YES];
[[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:@"Textures.plist"];

CGSize screenSize = [CCDirector sharedDirector].winSize;

background = [CCSprite spriteWithSpriteFrameName:@"dir_bg.png"];
background.position = CGPointMake(screenSize.width - background.texture.contentSize.width / 2 - 10, background.texture.contentSize.height / 2 + 10);

[self addChild:background];

controller = [CCSprite spriteWithSpriteFrameName:@"dir_big.png"];
controller.position = background.position;

[self addChild:controller]; 
```

![spriteWithSpriteFrameName:](../Images/f8a5b6a7da940e68fa761a2d07d9c086.png)

为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T12:10:22.123

而是`background.texture.contentSize.width`使用`background.contentSize.width`等等。

来源：[如何在cocos2d for iphone中获取CCSprite的宽高](https://stackoverflow.com/questions/2503903/how-to-obtain-a-ccsprites-width-and-height-in-cocos2d-for-iphone)

# javascript - 指南针针效果。图像保持固定并根据鼠标的位置旋转

> ID：14880014
> 
> 赞同：2
> 
> 时间：2013-02-14T16:55:35.057
> 
> 标签：javascript, css

我找到了一个我正在努力实现的工作示例。[http://jsfiddle.net/JFZ7a/](http://jsfiddle.net/JFZ7a/). 我尝试将这个功能插入我的网页，但我遇到了很多问题。我试图将其恢复为基础，并将 HTML 复制到标准的空 HTML 文档正文中。然后我将文件保存为 test.html。我正在使用 Arachnophilia 进行编程。然后我在 IE 中加载页面，它会向我显示应有的图像。然后我将 CSS 脚本插入头部，直接从 jsFiddle 一对一复制。CSS 将图像定位为应有的位置。然后我插入了 javascript，这就是它向我表明我做错了什么的时候。我已经阅读了这份文件，但在我的一生中它不会起作用。我首先将隐藏字符粘贴到记事本中，然后再次将其复制出来，从而搜索到隐藏字符。有人可以看看这个并告诉我我缺少什么，我最亏欠你。

```
<!doctype html>
<html>
<head>
<title>
</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script type="text/javascript">
var img = $('.image');
if (img.length > 0) {
    var offset = img.offset();

function mouse(evt) {
   var center_x = (offset.left) + (img.width() / 2);
    var center_y = (offset.top) + (img.height() / 2);
    var mouse_x = evt.pageX;
    var mouse_y = evt.pageY;
    var radians = Math.atan2(mouse_x - center_x, mouse_y - center_y);
    var degree = (radians * (180 / Math.PI) * -1) + 90;
    img.css('-moz-transform', 'rotate(' + degree + 'deg)');
    img.css('-webkit-transform', 'rotate(' + degree + 'deg)');
    img.css('-o-transform', 'rotate(' + degree + 'deg)');
    img.css('-ms-transform', 'rotate(' + degree + 'deg)');
}
$(document).mousemove(mouse);
}
     </script>  
     <style type="text/css">
     #apDiv1 {
position:absolute;
width:400px;
height:327px;
z-index:1;
left: 105px;
top: 98px;
}  
</style>  </head>

<body>
<div id="apDiv1">
 <img src="http://i347.photobucket.com/albums/p472/lcope24/corgi.jpg" class="image" />
 <br>(Not actual picture I'm trying to rotate, but it'll do for now)</div>
 </body>
  </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T16:59:45.783

你忘了`$(document).ready( function(){ });`。那个小提琴已经有`$(window).load( function(){ });`相当于`$(document).ready( function(){ });`

# android - android单词翻译应用程序基本功能代码错误

> ID：14880015
> 
> 赞同：0
> 
> 时间：2013-02-14T16:55:35.417
> 
> 标签：android, translate

目前我无法找出问题所在。对于以下代码，我不断收到相同的错误消息：

```
package com.example.test1;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;
import android.util.Log;
import com.memetix.mst.language.Language;
import com.memetix.mst.translate.Translate;

public class MainActivity extends Activity {
  private EditText text;
  private EditText text1;
  //private String translatedText;

  @Override
   public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    Translate.setClientId("myId");
Translate.setClientSecret("mySecret");
    text = (EditText) findViewById(R.id.editText1);
    text1 = (EditText) findViewById(R.id.editText2);

    Button Trans1 = (Button)findViewById(R.id.button1);
    Trans1.setOnClickListener(new View.OnClickListener(){
    public void onClick(View view) {
        String word = text.getText().toString();
        try {
            String translatedText = Translate.execute(word, Language.ENGLISH, Language.GERMAN);
            text1.setText(translatedText);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    });
    }
    } 
```

错误：

```
02-14 16:36:26.355: W/System.err(1146): java.lang.Exception: [microsoft-translator-api] Error retrieving translation : null
02-14 16:36:26.361: W/System.err(1146):     at com.memetix.mst.MicrosoftTranslatorAPI.retrieveString(MicrosoftTranslatorAPI.java:202)
02-14 16:36:26.361: W/System.err(1146):     at com.memetix.mst.translate.Translate.execute(Translate.java:61)
02-14 16:36:26.361: W/System.err(1146):     at com.example.test1.MainActivity$1.onClick(MainActivity.java:35)
02-14 16:36:26.361: W/System.err(1146):     at android.view.View.performClick(View.java:4202)
02-14 16:36:26.361: W/System.err(1146):     at android.view.View$PerformClick.run(View.java:17340)
02-14 16:36:26.361: W/System.err(1146):     at android.os.Handler.handleCallback(Handler.java:725)
02-14 16:36:26.361: W/System.err(1146):     at android.os.Handler.dispatchMessage(Handler.java:92)
02-14 16:36:26.361: W/System.err(1146):     at android.os.Looper.loop(Looper.java:137)
02-14 16:36:26.361: W/System.err(1146):     at android.app.ActivityThread.main(ActivityThread.java:5039)
02-14 16:36:26.372: W/System.err(1146):     at java.lang.reflect.Method.invokeNative(Native Method)
02-14 16:36:26.372: W/System.err(1146):     at java.lang.reflect.Method.invoke(Method.java:511)
02-14 16:36:26.372: W/System.err(1146):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-14 16:36:26.372: W/System.err(1146):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-14 16:36:26.372: W/System.err(1146):     at dalvik.system.NativeStart.main(Native Method)
02-14 16:36:26.372: W/System.err(1146): Caused by: android.os.NetworkOnMainThreadException
02-14 16:36:26.381: W/System.err(1146):     at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1117)
02-14 16:36:26.381: W/System.err(1146):     at java.net.InetAddress.lookupHostByName(InetAddress.java:385)
02-14 16:36:26.381: W/System.err(1146):     at java.net.InetAddress.getAllByNameImpl(InetAddress.java:236)
02-14 16:36:26.381: W/System.err(1146):     at java.net.InetAddress.getAllByName(InetAddress.java:214)
02-14 16:36:26.381: W/System.err(1146):     at libcore.net.http.HttpConnection.<init>(HttpConnection.java:70)
02-14 16:36:26.381: W/System.err(1146):     at libcore.net.http.HttpConnection.<init>(HttpConnection.java:50)
02-14 16:36:26.381: W/System.err(1146):     at libcore.net.http.HttpConnection$Address.connect(HttpConnection.java:340)
02-14 16:36:26.391: W/System.err(1146):     at libcore.net.http.HttpConnectionPool.get(HttpConnectionPool.java:87)
02-14 16:36:26.391: W/System.err(1146):     at libcore.net.http.HttpConnection.connect(HttpConnection.java:128)
02-14 16:36:26.391: W/System.err(1146):     at libcore.net.http.HttpEngine.openSocketConnection(HttpEngine.java:316)
02-14 16:36:26.391: W/System.err(1146):     at libcore.net.http.HttpsURLConnectionImpl$HttpsEngine.makeSslConnection(HttpsURLConnectionImpl.java:461)
02-14 16:36:26.391: W/System.err(1146):     at libcore.net.http.HttpsURLConnectionImpl$HttpsEngine.connect(HttpsURLConnectionImpl.java:433)
02-14 16:36:26.391: W/System.err(1146):     at libcore.net.http.HttpEngine.sendSocketRequest(HttpEngine.java:290)
02-14 16:36:26.391: W/System.err(1146):     at libcore.net.http.HttpEngine.sendRequest(HttpEngine.java:240)
02-14 16:36:26.391: W/System.err(1146):     at libcore.net.http.HttpURLConnectionImpl.connect(HttpURLConnectionImpl.java:81)
02-14 16:36:26.391: W/System.err(1146):     at libcore.net.http.HttpURLConnectionImpl.getOutputStream(HttpURLConnectionImpl.java:197)
02-14 16:36:26.391: W/System.err(1146):     at libcore.net.http.HttpsURLConnectionImpl.getOutputStream(HttpsURLConnectionImpl.java:281)
02-14 16:36:26.401: W/System.err(1146):     at com.memetix.mst.MicrosoftTranslatorAPI.getToken(MicrosoftTranslatorAPI.java:133)
02-14 16:36:26.401: W/System.err(1146):     at com.memetix.mst.MicrosoftTranslatorAPI.retrieveResponse(MicrosoftTranslatorAPI.java:160)
02-14 16:36:26.401: W/System.err(1146):     at com.memetix.mst.MicrosoftTranslatorAPI.retrieveString(MicrosoftTranslatorAPI.java:199) 
```

或者我已经尝试过另一种方式：

```
package com.example.test1;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;
import android.util.Log;
import com.memetix.mst.language.Language;
import com.memetix.mst.translate.Translate;

public class MainActivity extends Activity {
  private EditText text;
  private EditText text1;
  //private String translatedText;

  @Override
   public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    Translate.setClientId("myId");
Translate.setClientSecret("mySecret");
    text = (EditText) findViewById(R.id.editText1);
    text1 = (EditText) findViewById(R.id.editText2);
    }

    public void onClick(View view) {
     switch (view.getId()) {
    case R.id.button1:
    if (text.getText().length() == 0) {
      Toast.makeText(this, "Please enter a word or phrase to translate...",
         Toast.LENGTH_LONG).show();
      return;
     }
    else {
    String word = text.getText().toString();
    try {
        String translatedText = Translate.execute(word, Language.ENGLISH, Language.GERMAN);
        text1.setText(translatedText);
    } catch (Exception e) {
        Toast.makeText(this, "flop...",
               Toast.LENGTH_LONG).show();
        e.printStackTrace();
    }
      }
     }
     }
     } 
```

有了这个，它总是会捕获异常。

他们都没有返回结果。

主要问题（发现异常）：

```
02-14 16:50:17.281: W/System.err(1249): java.lang.Exception: [microsoft-translator-api] Error retrieving translation : null 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T16:57:34.107

> 引起：android.os.NetworkOnMainThreadException

这是因为您要么在不允许的 android 版本 >= 3.0 的主线程上执行网络操作。

[使用 AsyncTask 从http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)读取

# python - Python重新模式匹配

> ID：14880016
> 
> 赞同：0
> 
> 时间：2013-02-14T16:55:46.040
> 
> 标签：python, regex

我正在尝试使用 re 模块解决正则表达式识别问题。我想从文件中复制一些以 * 开头的行，确切的行模式是：

```
*7  3   279 0 
```

在字符中有制表符。我与这些行匹配的正则表达式是：

```
regex=re.compile(r'^\*\d+.\n', re.MULTILINE)
for line in f:
    if regexp.match(line)
    print >> a, line 
```

我编写的脚本创建了文件“a”，但它是空的，它无法识别模式。你有什么建议吗？

此外，你能解释一下双引号和单引号模式之间的区别吗？我搜索了几个python手册，但没有找到任何信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:00:32.100

您没有使用正则表达式捕获行的全部内容，您只会匹配以下类型的行：

`*7`

类似的东西`^\*(?:\d+\s+)+$`应该可以工作，不需要多行，因为您将正则表达式应用于文件的每一行。

编辑：更改为非捕获组，因为它不需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:14:39.963

假设你只在一行的开头寻找`*`+number，你只需要这样做：

```
regex=re.compile(r'\*\d+')
for line in f:
    if regexp.match(line)
    print >> a, line 
```

如果您关心以空格分隔的数字数量：

```
regex=re.compile(r'\*(?:\d+\s+){3}\d+')
for line in f:
    if regexp.match(line)
    print >> a, line 
```

如果你使用`re.match`你不需要`^`锚。如果你使用`re.search`，你会这样做。[查看文档](http://docs.python.org/2/library/re.html#search-vs-match)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T17:00:34.263

试试这个：

```
 re.compile(r'^\*\d\s+\d+\s+') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T17:01:50.630

不知道python，但似乎正则表达式应该是这个`^[*][\d(\s)*]+$`

# c++ - C++ Phidg et 事件处理程序未定义引用“链接器”

> ID：14880018
> 
> 赞同：0
> 
> 时间：2013-02-14T16:55:51.763
> 
> 标签：c++, qt, linker-errors, undefined-reference

我收到以下错误。根据最后一行，我认为这是一个链接器错误。但是，我真的不知道我在说什么。:) 我是初学者。如果您碰巧发现任何其他蹩脚点，请告诉我！

错误：对`AttachHandler(_CPhidget*, void*)' error: undefined reference to`DetachHandler(_CPhidg​​et*, void*)' 的未定义引用 错误：对`ErrorHandler(_CPhidget*, void*, int, char const*)' error: undefined reference to`数据的未定义引用(_CPhidg​​etBridge*, void*, int, double)' :-1: 错误: collect2: ld 返回 1 个退出状态

我有一个名为 eventhandlers.h 的头文件，其中包含：

```
#ifndef EVENTHANDLERS_H
#define EVENTHANDLERS_H

#include <phidget21.h>

int CCONV AttachHandler(CPhidgetHandle SENSOR, void *userptr);
int CCONV DetachHandler(CPhidgetHandle SENSOR, void *userptr);
int CCONV ErrorHandler(CPhidgetHandle SENSOR, void *userptr, int ErrorCode, const char *DESCR);
int CCONV Data(CPhidgetBridgeHandle SENSOR, void *userptr, int index, double val);

#endif // EVENTHANDLERS_H 
```

我试图在源文件名 quadbridge.cpp *PARTIAL CODE*中将 AttachHandler 和其他参数作为 CPhidg​​et_Set_OnAttach_Handler() 的参数传递：

```
#include "stdlib.h"
#include "quadbridge.h"
#include "eventhandlers.h"

QuadBridge::QuadBridge(int numOfSensors, int PhidgetID)
{

this->SERIAL = 140800;
//this->SERIAL = 137723;

this->bridge = 0;
CPhidgetBridge_create(&bridge);
setEventHandlers();

if(setAttachController(PhidgetID))
{
    getNumOfSensorsAttached(numOfSensors);
    initSensors();
}
else
{
    exit(1);
}

}

QuadBridge::~QuadBridge()
{
CPhidget_close((CPhidgetHandle)bridge);
CPhidget_delete((CPhidgetHandle)bridge);
}

void QuadBridge::setEventHandlers()
{
CPhidget_set_OnAttach_Handler((CPhidgetHandle)bridge, AttachHandler, 0);
CPhidget_set_OnDetach_Handler((CPhidgetHandle)bridge, DetachHandler, 0);
CPhidget_set_OnError_Handler((CPhidgetHandle)bridge, ErrorHandler, 0);

CPhidgetBridge_set_OnBridgeData_Handler(bridge, Data, 0);

CPhidget_open((CPhidgetHandle)bridge, SERIAL);
} 
```

最后——我把整个事情都搞定了。

```
#include "palmtools.h"
#include "QuadBridge.h"
#include <QApplication>

QuadBridge *qb;

int main(int argc, char *argv[])
{
QApplication a(argc, argv);
PalmTools w;
w.show();

qb = new QuadBridge(4);

return a.exec();
} 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:10:30.153

你可以看到有声明

```
int CCONV AttachHandler(CPhidgetHandle SENSOR, void *userptr); //etc 
```

编译器可以编译调用声明函数的源代码。但是，在链接步骤中，链接器无法找到这些函数的定义以将它们包含到输出文件中——因为在编译器传递给它的文件中找不到它们。由于您使用的是第 3 方库，因此这些函数预编译在“库文件”中，您需要将其包含在链接步骤中。

如果您使用的是 Visual Studio，请右键单击该项目并打开属性。在`Linker`-> `Input`->`Additional Dependencies`添加包含缺少定义的 lib 文件的名称（`phidget21.lib`我假设）。另外，确保链接器的库路径包含该文件的文件夹（您可以在`VC++ Directories`选项卡下的属性页中设置它）。

# php - Zend Framework 2 RestfulController 和额外的动作

> ID：14880019
> 
> 赞同：1
> 
> 时间：2013-02-14T16:55:57.777
> 
> 标签：php, rest, zend-framework2

我在 ZF2-Application 中使用 AbstractRestfulController 作为控制器。该控制器实现了 create()、update() 等。

是否可以在这些 REST-Function 旁边进行操作？

例如，我想要： url.com/model/id 来获取模型（这已经有效），但我也希望能够调用 url.com/model/doSomething。

我尝试使用 child_routes，但它不起作用：

```
'car' => array(
                            'type'         => 'literal',
                            'options'      => array(
                                    'route'       => '/car',
                                    'defaults'    => array(
                                            'controller' => 'CarDealer\Controller\Car',
                                            'action' => 'index'
                                    ),
                            ),
                            'child_routes' => array(
                                    'rest'    => array(
                                            'type'    => 'segment',
                                            'options' => array(
                                                    'route'       => '[/:id]',
                                                    'constraints' => array(
                                                            'id' => '[0-9]+',
                                                    ),
                                                    'defaults'    => array(
                                                            'controller' => 'CarDealer\Controller\Car',
                                                    ),
                                            ),
                                    ),
                                    'actions' => array(
                                            'type'    => 'segment',
                                            'options' => array(
                                                    'route'       => '[/:action]',
                                                    'constraints' => array(
                                                            'action' => '[a-zA-Z][a-zA-Z0-9_-]*',
                                                            'id'     => '[0-9]+',
                                                    ),
                                                    'defaults'    => array(
                                                            'controller' => 'CarDealer\Controller\Car',
                                                            'action'     => 'index',
                                                    ),
                                            ),
                                    ),
                            ),
                    ), 
```

我很确定上述内容没有多大意义，但是我找不到正确的提示来使事情正常进行。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-17T11:56:50.557

AbstractRestfulController 不会分派给任意操作方法，因此您应该使用子路由和另一个控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T05:39:42.587

使用 WildCard Routes 做一些不例外的事情。在控制器中获取通配符参数以执行该操作

# javascript - Tweet 按钮可在没有 http://www 的情况下发送推文 URL

> ID：14880020
> 
> 赞同：0
> 
> 时间：2013-02-14T16:55:53.527
> 
> 标签：javascript, twitter

我正在尝试在我的页面中嵌入一个推文按钮，该按钮发布一个动态生成的 url。

我已经获得了推文完整网址的按钮，但为了尽量减少推文中的字符，我想去掉`http://www`. 但是，当我尝试将其分配给 twitter 按钮锚标记的 data-url 属性时，该 url 不会出现在推文中。

因此，`$url = 'http://www.mypage.com/?id=2'`作品`$url = 'mypage.com/?id=2'`没有。

我正在使用js api，我的实现如下：

```
<a href="https://twitter.com/share" data-url="<?php echo $url;?>" class="twitter-share-button" data-text="test copy" data-lang="en">Tweet</a> 
```

加上推特的js：

```
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script> 
```

我可以理解为什么需要 http 的东西来扩大 url 范围，但是为了服务于他们的主要客户群，我认为 twitter 可能有办法使这些信息隐含。有什么我可以添加的内容告诉 twitter，“将其解释为[http://www.blahblahblah](http://www.blahblahblah) ...”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:04:19.830

试试`$url = '//mypage.com/?id=2'`。它被称为相对协议的 URL。可能会奏效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:33:19.397

设置`data-url=" "` and`data-text= <my url>`工作正常，显然 twitter 知道将数据文本中的 url 制作成锚标签。据我所知，这在技术上不是一个答案，但在功能上是相同的

# ios - 如何正确包含 .bundle 到 Unity3d 包

> ID：14880026
> 
> 赞同：2
> 
> 时间：2013-02-14T16:56:28.677
> 
> 标签：ios, unity3d

我有一个用于 unity3d 的 iOS 插件，里面有一个静态库，这个库使用 .bundle 中的一些图像。但是我不知道如何将我的包包含到 Unity 包中。当我将包放入包并尝试从 Unity3d 编辑器构建项目时，最后我的包没有包含在生成的 XCode 项目中。

所以我有两个问题：

1）有没有办法将它复制到生成的项目中？

2）是否可以从 unity3d 插件（我对 AdSupport.framework 有依赖关系）中指定额外的框架，以包含在生成的项目中。

**更新：**您可以将您的捆绑包复制到 Assets/WebPlayerTemplates，这样 Unity3d 就不会从那里导入任何内容，该目录也会导出到 unitypackage。最后一步是使用 postbuild 脚本将你的包包含到生成的 Xcode 项目中，我为此使用[了 XUPorter](https://github.com/onevcat/XUPorter)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:58:49.267

*Unity 将Assets/Plugins/iOS*文件夹中的每个文件复制到 Xcode 项目的 Library 文件夹中。这对于您的 lib 文件和其他东西来说是完美的，但是当涉及到目录结构时它会失败。资源包是目录，因此 Unity 只是复制目录的*.meta*文件并拒绝复制其中的文件。

解决此问题的方法是手动复制您的包并将它们导入 Xcode（菜单*File / Add File to "Unity-iPhone"*）。之后，您应该始终以附加模式导出您的 iOS 项目（默认情况下 CMD+B 会执行此操作）。有两个缺点：

*   当您更新到较新版本的 Unity 时，该项目通常会被替换，因此您的捆绑包已经消失。如果您使用 git 进行版本控制，我建议将包添加到存储库，Subversion 用户必须做额外的工作。
*   每当您的库项目中的包发生更改时，您都必须复制它。如果这种情况经常发生而令人烦恼，您可以在构建过程中设置一个预操作，即编写一个小的 shell 脚本，从 libraty 项目中复制您的资源包。这可以在*Edit Scheme*中完成： ![编辑方案/构建/预操作](../Images/4aca8a771d4e456f5940409e3baefc10.png)
    同样，这可能会在 Unity 更新时被覆盖，您必须再次手动设置预操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T12:48:14.687

我发现没有办法配置 Unity3d，使其包含额外的框架和捆绑包来生成 Xcode 项目（即 Marmalade SDK 允许您通过配置这样做），我使用[mod_pbxproj](https://bitbucket.org/icalderon/mod-pbxproj/overview)和 Unity3d 控制台工具来生成 XCode 项目并注入构建完成后项目的所有必要包和框架。

有一个更好的选择，请参阅问题本身。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-12-16T00:11:23.290

其实是有办法的。不确定这是否是在您的回答/评论之后添加的，但是；

1.  在目录中找到您的 .bundle 文件（在 Unity 编辑器中）并单击它。
2.  在 Inspector 面板中，仅从Include **Platforms中选择****iOS** **[![在此处输入图像描述](../Images/28c53c89a503f17d167ac565c5d53aaf.png)](https://i.stack.imgur.com/OSc8j.png)**
***   在 Inspector 面板中单击**Apply down。***   在为 iOS 构建时，您将在导出 Xcode 项目时看到 .bundle [检查**构建阶段/复制捆绑资源**]。**

# html - 为什么推文窗口在特定尺寸的弹出窗口中打开

> ID：14880031
> 
> 赞同：0
> 
> 时间：2013-02-14T16:56:38.720
> 
> 标签：html, twitter

我有一个`<a>`带有 href="https://twitter.com/intent/tweet?text=@goomena Welcome to Goomena.com&hashtags=goomena" 的标签，当我单击它时，它没有在现有窗口或新标签中打开但它会在具有特定尺寸的弹出窗口中打开。在我的`<a>`标签**中，我没有任何*目标*属性**，所以我确定我不是导致它的人。我喜欢这种效果，但我想知道 Twitter 是如何做到的。我将来可能会使用它。提前感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:06:57.220

您可能还加载了 Twitter 的 Intent javascript，它会拦截此链接并创建弹出窗口。

# linux - 本机 KDE 寻找 Qt 5 应用程序

> ID：14880032
> 
> 赞同：21
> 
> 时间：2013-02-14T16:56:42.897
> 
> 标签：linux, qt, kde, qt5

我在我的 Kubuntu 12.10 linux 机器上安装了 Qt5 和 Qt4，并注意到以下内容：

*   使用 Qt4 编译的程序具有原生的 KDE 外观。我使用默认 KDE 的*Oxygen*主题，我的程序也是如此（注意带有标题的平滑渐变和聚焦小部件的蓝色选择）；
*   但是当使用 Qt5 重新编译**而不对代码进行任何更改时**，它使用了不同的样式（似乎被称为*Fusion*）并且看起来很尴尬且不合时宜（见右图）

![Qt4 应用程序的原生外观](../Images/e6e47ffee7a04cac86f8ee4e7d9e9db3.png)![不是 Qt5 应用程序的原生外观](../Images/65edfb17fed2e19e85430dcd0db43a86.png)

我想要的是非常简洁：我希望我的应用程序适合周围的系统，即始终看起来是原生的。使用 Qt4 时，我习惯于默认使用它。Qt5 在 Windows 中似乎也有正常的原生外观。但是我该怎么做才能在 Kubuntu 中也有同样的功能呢？而且，理想情况下，**无处不在**？我的意思是，我不想强​​制我的应用程序的 linux 版本严格使用*Oxygen*。我希望它使用当前在 KDE 中设置的主题：就像在旧的 Qt4 中一样。

*似乎应用程序代码与此问题无关：我没有在其中使用任何 QStyle，它非常典型的 Qt 的 hello-world。但以防万一[它在 GitHub 上](https://github.com/NIA/qfractal)。*

**UPD：** @peppe已经就*为什么会发生这个问题*[给出了](https://stackoverflow.com/a/14880148/693538)非常充分的答案（KDE 中的氧气主题是针对 Qt4 编译的，并且不能被 Qt5 使用）。**但是我仍在寻找有关*****如何解决此问题的答案？***[我试图找到 Oxygen 主题源来玩，但除了Firefox 主题](http://kde-look.org/content/show.php?content=117962)之外什么也没找到。

 ****UPD2：** @kwirz[提出](https://stackoverflow.com/a/15965194/693538)了一个有趣的想法：强制应用使用 GTK+ 主题，并在 KDE 设置中启用**oxygen-gtk**，使 GTK 窗口看起来类似于 Oxygen。一方面，它确实看起来更接近氧气：

![使用氧气-gtk 的 Qt5 应用程序的半原生外观](../Images/9e93ef88a962f3f659dff8612586df7b.png)

但另一方面，我们已经看到了细微的差别：只读行编辑变成灰色，焦点按钮仍然没有突出显示等。不幸的是，当尝试将此技术应用于更复杂的小部件时，会出现更多的伪影（尤其是在组合框上）和微调器）：

> > ![在 QComboBox 和 QTimeEdit 上使用oxygen-gtk 的工件](../Images/8abb4e5f95bd26ba6f28523d2fcaa4fa.png)

因此，这种技术似乎不能成为一个完整的解决方案，但对于简单的情况仍然非常有用。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-17T10:42:10.770

Oxygen 是 KDE 的一部分，所以你可以在那里找到它。这不是一个独立的主题。您不能针对 Qt 5 构建 KDE，它不受支持。KDE 的下一个主要版本（KDE 5）将使用 Qt 5。

所以现在，你绝对无能为力。如果您希望您的应用程序在 KDE 4 中看起来和表现良好，请使用 Qt 4。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-14T17:03:11.343

这不是你的应用程序——只是 Oxygen 是针对 Qt 4 而不是 Qt 5 编译的，所以 Qt 5 不能使用它并回退到默认样式（“fusion”）。请记住，样式实际上是**插件**——即代码，需要满足 API/ABI 要求才能加载和使用。您需要针对 Qt 5 编译的 Oxygen 样式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-12T07:09:31.973

try

```
QApplication::setStyle(QStyleFactory::create("GTK+")); 
```

as workaround, it looks native, if oxygen-gtk is installed.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-22T17:50:36.200

使用参数启动您的 Qt5 应用程序：

```
-style=gtk 
```

据我所知，没有任何全局设置适用于所有 QT5 应用程序。

祝你好运！**

# javascript - Javascript 对象性能偏好

> ID：14880036
> 
> 赞同：0
> 
> 时间：2013-02-14T16:56:55.150
> 
> 标签：javascript, performance, object, code-structure

SO上可能有这个问题的副本，但我还没有找到一个专门解决我的问题的问题。

假设我正在构建一个包含以下内容之一的 Web 应用程序：

1.  一个具有大约 100 个属性的 JS 对象，其中 5 个是子对象，可能有 10 或 15 个属性，每个属性大约 2/3 是函数。所以像：

    ```
    Obj={
        x:y,
        y:z,
        obj1:{
          func:func(),
          num:1,
          func2:func2()
        },
        obj2:etc
    } 
    ```

2.  或者几个不同的对象，其中仍然有一个具有 100 个左右的属性，但将运行函数的其他对象将存在于全局命名空间中，如下所示：

    ```
    Obj={
        x:y,
        y:z,
        etc:andthensome
     }
    obj1={
        func:func(),
        num:1,
        func2:func2()
    }
    obj2={
       etc:'I am also a larger objects with functions'
    } 
    ```

第一种方法使全局命名空间更干净，但会导致更多的递归属性和函数搜索，并且可能会使保持`this`直线更加混乱。

第二种方式更容易理解，但会在全局命名空间中添加更多对象，并且执行速度可能会更慢（这就是问题类型）。

我的问题是，使用一种或另一种方式是否有任何显着的好处 - 或者它们都是“好”，都是“坏”？

我知道与开发人员的偏好有很大关系，所以用另一种方式问类似的问题——更接近我真正想知道的：

> 当使用许多较小的对象，或者一个或几个具有大量子对象和功能的大型对象等时，性能是否会受到更大的影响？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:37:22.440

[更少的查找性能更高](http://jsperf.com/lookup-comparisons)，但这并不重要。

您应该优化您的代码以便更易于维护，并且只有在性能成为问题时才担心性能。

更重要的是，如果性能已成为问题，请使用性能分析工具来查找代码中的瓶颈。

至于更多的全局污染，除非您明确希望它们存在，否则您永远不应该将对象添加到全局命名空间中。为避免污染，所有代码都属于[立即调用函数表达式 (IIFE)](http://benalman.com/news/2010/11/immediately-invoked-function-expression/)：

```
(function () {
    var obj = {
        foo: 'bar',
        ...
    };
}());
console.log(window.obj); //undefined, no accidental global pollution 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:03:04.153

查找不应该有任何显着的性能影响，代码结构与此无关。这些结构中的任何一个仍然只包含对对象的引用，无论如何，这些对象的查找时间都是相同的。

您应该构建对象以匹配您的数据并提高代码的清晰度。如果一个对象是与另一个对象分离的关注点，请不要将其设为属性。如果它直接相关，那么将它作为另一个对象的属性可能是有意义的。这里没有真正的性能问题，这是关于构建代码，使其可读、清晰且易于使用。

# c# - 为什么我的 XmlWriter 保留其文件流？

> ID：14880037
> 
> 赞同：1
> 
> 时间：2013-02-14T16:56:51.623
> 
> 标签：c#, .net, xmlwriter

我编写了一个应用程序，该应用程序有时会编写一个 XML 文档。后来，创建了一个新对象，并且在代码的同一部分，`XmlWriter`无法打开该文件，因为我的程序仍在“使用”该文件。在寻找答案时，我看到很多线程在`CloseOutput`创建之前将答案设置为 true `XmlWriter`，并在 using 块中创建它。这两个我都做了，还是有这个问题。

```
XmlWriterSettings xSettings = new XmlWriterSettings();
xSettings.Indent = true;
xSettings.IndentChars = "\t";
xSettings.CloseOutput = true;

using (XmlWriter xWriter = XmlWriter.Create(sOutputFileName, xSettings))
{
    data.WriteContentTo(xWriter);
    xWriter.Close();
} 
```

我有什么明显的遗漏吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T17:01:33.487

我以前见过类似的事情，也同样感到困惑。*看起来*您的代码确实在做正确的事情。*话虽如此，我现在*实际上无法重现该问题。（虽然我以前看过……）

除非有人能弄清楚发生了什么，否则这是我建议的解决方法：

```
var settings = new XmlWriterSettings { Indent = true, IndentChars = "\t" };

using (var stream = File.Create(sOutputFileName))
{
    using (var writer = XmlWriter.Create(stream, settings))
    {
        data.WriteContentTo(writer);
    }
} 
```

# jasper-reports - Jasper 报告，包含外部详细信息或多个详细信息的子报告

> ID：14880038
> 
> 赞同：0
> 
> 时间：2013-02-14T16:57:08.567
> 
> 标签：jasper-reports

我需要创建一个包含 4 个部分的报告。为此，我看到了一份报告和其他 3 份子报告的选项。

问题是这些部分都不相关，所以我不能将子报告放在同一个详细信息带中。

有什么选择？创建多个详细品牌，每个品牌都有一个子报告？或将子报表放在页脚中？

如果没有子报告，还有其他方法可以做到这一点吗？如果我能做到这一点，只需一个 .jrxml 我想学习它。

我正在使用 iReports 5.0.0 和 jsf 2.0 来填充数据。

问候。

例子：

```
--------section 1---------
+----------+------+ -----
| title    | count|     |
+----------+------+     |
| ejample  | 150  |     |
| ejample  | 15   |     detail 
| ejample  | 10   |     |   
| ejample  | 1250 |     |   
| ejample  | 150  |     | 
+----------+------+ -----
--------section 2---------
+----------+------+ -----
| country  | %    |     |
+----------+------+     |
| ejample  | 150  |     |
| ejample  | 15   |     detail 
| ejample  | 10   |     |   
| ejample  | 1250 |     |   
| ejample  | 150  |     | 
+----------+------+ -----
--------section 3---------
   etc 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:33:52.147

添加 4 个细节带 - 每个部分都有一个细节带。这是因为子报表具有动态高度，但报表元素本身具有固定高度。为了不产生重叠输出，将每个子报告放入一个单独的波段。细节带随着内容的大小而增长。

根据输出的复杂性，您可能要考虑在主报表中使用子数据集并使用列表或表格元素安排显示。

# wordpress - 如何挂钩 page_attributes_meta_box 以更改显示“父”选项？

> ID：14880043
> 
> 赞同：2
> 
> 时间：2013-02-14T16:57:30.443
> 
> 标签：wordpress, hook

在 WP 管理面板中，有带有“父级”下拉列表的“属性”元框。我需要更改排序参数并仅显示父帖子。如果我更改原生 WP 文件**meta-boxes.php第****621**行，我可能会这样做。以下代码：

```
$dropdown_args = array(
    'post_type'        => $post->post_type,
    'exclude_tree'     => $post->ID,
    'selected'         => $post->post_parent,
    'name'             => 'parent_id',
    'show_option_none' => __('(no parent)'),
    //Remove existing sort
    //'sort_column'      => 'menu_order, post_title',
    'echo'             => 0,
    //Add my options
    'parent'           => 0,
    'sort_order'       => 'DESC',
    'sort_column'      => 'post_date',
); 
```

使用这一切都很完美。但我需要钩住它。我已经创建了 actiont 来执行此操作，但它不起作用：

```
add_action('page_attributes_meta_box', 'custome_page_attributes_meta_box');
function custome_page_attributes_meta_box($post) {
    $post_type_object = get_post_type_object($post->post_type);
    if ( $post_type_object->hierarchical ) {
        $dropdown_args = array(
            'post_type'        => $post->post_type,
            'exclude_tree'     => $post->ID,
            'selected'         => $post->post_parent,
            'name'             => 'parent_id',
            'show_option_none' => '(no parent)',
            'echo'             => 0,
            'sort_order'       => 'DESC',
            'sort_column'      => 'post_date',
            'parent'           => 0
        );

        $dropdown_args = apply_filters( 'page_attributes_dropdown_pages_args', $dropdown_args, $post );
        $pages = wp_dropdown_pages( $dropdown_args );
        if ( ! empty($pages) ) {
        ?>
            <p><strong><?php _e('Parent') ?></strong></p>
            <label class="screen-reader-text" for="parent_id"><?php _e('Parent') ?></label>
            <?php echo $pages; ?>
        <?php
        } // end empty pages check
    } // end hierarchical check.
} 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T23:11:26.493

你正试图[钩](http://codex.wordpress.org/Plugin_API#Hook_to_WordPress)入一个不存在的动作。
在核心文件中，您必须查找`do_action`和`apply_filters`.
在这种情况下，有一个正是您需要的：

```
add_filter( 'page_attributes_dropdown_pages_args', 'filter_dropdown_so_14880043', 10, 2 );

function filter_dropdown_so_14880043( $dropdown_args, $post )
{
    $my_args = array(
         'post_type'        => $post->post_type,
         'exclude_tree'     => $post->ID,
         'selected'         => $post->post_parent,
         'name'             => 'parent_id',
         'show_option_none' => '(no parent)',
         'echo'             => 0,
         'sort_order'       => 'DESC',
         'sort_column'      => 'post_date',
         'parent'           => 0
    );
    return $my_args;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-07T17:50:35.060

我知道这个问题很老了。但我找到了一个更简单的解决方案来保留所有以前的论点并只显示私人帖子：

```
add_filter( 'page_attributes_dropdown_pages_args', 'wpse_984638_show_private_pages_in_dropdown', 10, 2 );

function wpse_984638_show_private_pages_in_dropdown( $args, $post ) {
    $args['post_status'] = array('publish', 'private');
    return $args;
} 
```

# .net - 实体框架5选择动态列

> ID：14880056
> 
> 赞同：0
> 
> 时间：2013-02-14T16:57:52.800
> 
> 标签：.net, vb.net, entity-framework

有没有办法在运行时选择实体框架中的特定列。
例如，我有一个实体**用户**，其属性为**Title、FirstName、LastName、Email**，我想指定在运行时选择的特定列

```
Using u as New UserEntities
 dim user = (From usr in u.Users
             Select usr.<<Relpacing this property with the selected property>>).ToList
End Using 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:25:33.117

大概您的数据上下文中有一个实体“用户”。假设您的 User 实体有一个 firstName 属性（如果您愿意，也可以在它后面的数据表上列）。因此，要从您的 User 实体中检索名字，您需要一个 linq 查询沿这些行运行：

```
Using u as new UserEnties
     Dim query = (From n in u.Users
     select n.firstName).ToList()
     'now do something with your list
 End Using 
```

一开始，Linq 并不是最容易引起你注意的事情，而且至少可以说有点生疏。然而，MSDN 上有一些很好的基本示例可以帮助您朝着正确的方向开始。希望这至少能让你指出正确的方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:01:45.780

LINQ 确实最适合编译时间查询。当您需要动态结构时，它并不容易使用。在这种情况下，您可能需要查看 Entity SQL 和 Query Builder 方法。开始使用此功能的最佳方法之一是查看 EF 查询示例项目中的示例，网址为[http://archive.msdn.microsoft.com/EFQuerySamples](http://archive.msdn.microsoft.com/EFQuerySamples)。

# php - 将数据从 c++ 程序发送到 php web 服务器

> ID：14880057
> 
> 赞同：0
> 
> 时间：2013-02-14T16:57:59.033
> 
> 标签：php, c++, linux, bash, sockets

我有一个在 Web 服务器中运行的 php 脚本，以便对数据库执行一些插入操作。该脚本接收一些加密数据，对其进行解密并将其推送到数据库中。

负责发送此数据的是一个 C++ 程序（在 Linux 中运行），该程序将每 5 秒发送一条不超过 40 个字符的消息。

我正在考虑调用一些 bash 脚本来打开 URL（[http://myserver.com/myscript.php?message=adfafdadfasfasdfasdf](http://myserver.com/myscript.php?message=adfafdadfasfasdfasdf)）并通过参数接收消息。

我不想要一个复杂的解决方案，因为我只需要打开 URL，它是一个单向的沟通渠道。

一些简单的解决方案来做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T17:11:21.293

一个更强大的解决方案是使用`libcurl`，它可以让您[在几行中打开一个 http 连接](http://curl.haxx.se/libcurl/c/simple.html)。这是链接中的自包含示例：

```
#include <stdio.h>
#include <curl/curl.h>

int main(void)
{
  CURL *curl;
  CURLcode res;

  curl = curl_easy_init();
  if(curl) {
    curl_easy_setopt(curl, CURLOPT_URL, "http://example.com");
    /* example.com is redirected, so we tell libcurl to follow redirection */ 
    curl_easy_setopt(curl, CURLOPT_FOLLOWLOCATION, 1L);

    /* Perform the request, res will get the return code */ 
    res = curl_easy_perform(curl);
    /* Check for errors */ 
    if(res != CURLE_OK)
      fprintf(stderr, "curl_easy_perform() failed: %s\n",
              curl_easy_strerror(res));

    /* always cleanup */ 
    curl_easy_cleanup(curl);
  }
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:59:46.237

由于您不需要解析 HTTP 查询的结果，因此您可以使用[system](http://linux.die.net/man/3/system)调用像[wget](http://linux.die.net/man/1/wget)这样的标准实用程序。

```
int retVal = system("wget -O- -q http://whatever.com/foo/bar");
// handle return value as per the system man page 
```

这和你想的基本一样，保存脚本间接。

# sqlite - SQLite，PHP PDO：将 foreign_keys 设置为 ON

> ID：14880058
> 
> 赞同：0
> 
> 时间：2013-02-14T16:57:59.500
> 
> 标签：sqlite, pdo, foreign-keys

有没有办法使用 PDO SQLite 驱动程序选项设置 SQLite 外键：

```
new PDO('sqlite:...',array(driver options)) 
```

或使用 PDO::setAttribute() 方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:37:48.817

只需`PRAGMA foreign_keys = on`像任何其他 SQL 命令一样执行。

# r - 在一个图中绘制 2 个数据框时的图例

> ID：14880061
> 
> 赞同：0
> 
> 时间：2013-02-14T16:58:10.157
> 
> 标签：r, plot, ggplot2

我已经完全按照我想要的方式绘制[了正值](https://docs.google.com/file/d/0BzDs54ck2dfYM29FeTlERDBoNlE/edit?usp=sharing)和[负值，包括图例。](https://docs.google.com/file/d/0BzDs54ck2dfYMVFTN1FsY0hOZWc/edit?usp=sharing)我现在将这些放在一个情节中以创建一个情节（*我没有足够的点来链接到该图像*）。我对此非常满意——除了传说。图例按字母顺序排序，这不是我的首选顺序（与颜色层从上到下的顺序相同）。我尝试了不同的方法来尝试手动设置图例，但到目前为止我发现的所有方法都适用于绘制单个数据框而不是像我现在这样的两个数据框。

似乎使用 scale_colour_manual 不会影响这种类型的情节，还有其他方法吗？

下面是一个非常简单的工作示例，它也给出了上述相同的行为。

```
data1 = data.frame(x = seq(0,20), y =    c(1,4,-5,-9,-4,0,3,6,-4,3,-2,-5,8,2,1,6,7,-9,8,-4,0))
data2 = data.frame(x = seq(0,20), y = seq(0,20))

q = ggplot(NULL, aes(x = x, y = y))
q = q + geom_line(data = data1)
q = q + geom_line(data = data2) 
```

谢谢，简

* * *

感谢您的回复，但我仍然没有得到我想要的图表。这是到目前为止我所得出的最接近[正负值的链接-传说不是必需](https://docs.google.com/file/d/0BzDs54ck2dfYM29FeTlERDBoNlE/edit?usp=sharing)的。对于这个图，我使用了两个单独的数据框，因为我使用了不同的`geom_area`和`geom_line`位置；对于我正在使用的情节的积极部分：

```
geom_area(data = prod.data, position = "identity", alpha = 0.8)
geom_line(data = prod.data, position = "identity") 
```

对于我正在使用的情节的负面部分：

```
geom_area(data = cons.data, position = "stack", alpha = 0.8)
geom_line(data = cons.data, position = "stack") 
```

但是，正如原始问题中所讨论的，我似乎无法控制图例的顺序。我尝试组合数据框并设置因子的顺序，这里我使用：

```
geom_area(position = "stack", alpha = 0.8)
geom_line(position = "stack") 
```

我可以控制图例顺序，但实际情节并不像我想要的那样。这是[正负值的图表 - 图表不是必需](https://docs.google.com/file/d/0BzDs54ck2dfYMVFTN1FsY0hOZWc/edit?usp=sharing)的。

我有量子力学闪回:-)所以非常感谢任何进一步的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:07:29.483

通常，`ggplot`将数据组合到一个数据框中时效果最佳。您提供的示例有点令人困惑 - 正如所写的那样，没有图例，并且不清楚您希望图例是什么。我的方法是组合数据框：

```
data1$group <- 1
data2$group <- 2
data3 <- rbind(data1, data2)
data3$group  <- factor(data3$group)
q <- ggplot(data3, aes(x = x, y = y, group = group, color = group))
    + geom_line() 
```

然后，您可以使用任何标准方式来订购图例。自动化程度较低，但通常优于普通图例，您可以使用 new`data.frame`和`geom_text`call 手动标记每一行。

默认情况下，图例将按因子的顺序排序，因此要重新排序图例，您应该对因子进行排序，或者手动使用`factor`

```
data3$group <- reorder(data3$group, levels = c(2, 1), ordered = TRUE) 
```

或 使用`reorder`和 一个函数（例如`sort()`, 或`rev(sort())`，如果您想要反向 alpha 顺序）。`reorder`例如，如果您想按`mean`或`max`y 值对因子进行排序，也可以与不同列的函数一起使用。

# javascript - 最初隐藏 iframe 时，Vimeo Javascript API 不起作用

> ID：14880078
> 
> 赞同：1
> 
> 时间：2013-02-14T16:59:23.190
> 
> 标签：javascript, iframe, cross-browser, vimeo

所以我的问题是，我需要显示一张封面图片，而实际的视频将被隐藏。一旦有人点击图像，视频就会变得可见，应该会自动开始播放。我的代码在这里[http://jsfiddle.net/Vq8Wr/](http://jsfiddle.net/Vq8Wr/)。这在 Chrome 中运行良好，但在任何其他浏览器中都没有。任何解决方案将不胜感激

代码如下

```
<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
<style>
.hide{
   display:none
}

img{
    width:500px;
}
</style>

<iframe class="hide" src="http://player.vimeo.com/video/59372982?api=1" width="500" height="281" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
<img src="http://allthingsd.com/files/2011/05/clouds-1259.jpg" id="video-cover" >

<script>
  $("#video-cover").click(function(){
    $(this).hide();
    var f = $('iframe'),
    url = f.attr('src').split('?')[0];
    f.show();
    var data = { method: "play" };
    f[0].contentWindow.postMessage(JSON.stringify(data), url);
})
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:02:36.480

试试这个：

```
.hide{
   position : absolute;
   left     : -99999px;
} 
```

# mysql - 带有 GROUP BY 子句的 COUNT 的 MySQL SUM

> ID：14880080
> 
> 赞同：14
> 
> 时间：2013-02-14T16:59:27.890
> 
> 标签：mysql, count, group-by, sum

我希望`SUM`的`COUNT`一个查询如下。此查询为每一行正确返回计数 (1)，但不确定如何将它们全部加起来。

```
SELECT COUNT(*), jss_orders_headers.*  FROM jss_orders_headers
LEFT JOIN jss_orders_extrafields
ON jss_orders_headers.orderID = jss_orders_extrafields.orderID
AND jss_orders_extrafields.extraFieldID = 5
GROUP BY jss_orders_headers.orderID
ORDER BY jss_orders_headers.orderID DESC 
```

表结构是

## jss_order_headers

订单ID等

## jss_order_extrafields

exid、orderID、extrafieldID、extrafieldName、内容

这当前返回数据如下：

## 计数（） | 订单号 | ETC

1 | 99

1 | 104

1 | 106

我需要返回列`SUM`的`COUNT()`。因此，在上面的 3 个示例中，我将返回`3`.

非常感谢

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-15T17:18:19.543

你的问题并不完全清楚，但如果你只想要`sum()`of all `orders`，那么你应该能够使用这样的东西：

```
select sum(TotalByOrder) TotalOrders
from
(
  SELECT COUNT(*) TotalByOrder, jss_orders_headers.*  
  FROM jss_orders_headers
  LEFT JOIN jss_orders_extrafields
    ON jss_orders_headers.orderID = jss_orders_extrafields.orderID
    AND jss_orders_extrafields.extraFieldID = 5
  GROUP BY jss_orders_headers.orderID
) src 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-14T17:07:29.457

会[`WITH ROLLUP`](http://dev.mysql.com/doc/refman/5.0/en/group-by-modifiers.html)做你需要的吗？

```
SELECT COUNT(*), jss_orders_headers.*  FROM jss_orders_headers
LEFT JOIN jss_orders_extrafields
ON jss_orders_headers.orderID = jss_orders_extrafields.orderID
AND jss_orders_extrafields.extraFieldID = 5
GROUP BY jss_orders_headers.orderID DESC WITH ROLLUP 
```

为什么没有`ORDER BY`？

> 使用 ROLLUP 时，也不能使用 ORDER BY 子句对结果进行排序。换句话说，ROLLUP 和 ORDER BY 是互斥的。**但是**，您仍然可以控制排序顺序。MySQL 中的 GROUP BY 对结果进行排序，您可以对 GROUP BY 列表中命名的列使用显式 ASC 和 DESC 关键字来指定各个列的排序顺序。

# python - Python sqlite 数据分组

> ID：14880083
> 
> 赞同：0
> 
> 时间：2013-02-14T16:59:35.947
> 
> 标签：python, sqlite

我使用这段代码：

```
cur.execute("SELECT * FROM seats WHERE Day = 'S' AND Booked = 'N' AND Disabled = 'Y'")
for number, rows in groupby(cur, key=lambda r: r[0][0]):
    print 'Disabled seats available : ', ', '.join([r[0] for r in rows]) 
```

它将数据分组在一起以给出以下答案：

```
Disabled seats available :  A1, A14
Disabled seats available :  B1, B16
Disabled seats available :  C1, C17
Disabled seats available :  D1, D19
Disabled seats available :  E1, E20
Disabled seats available :  F1, F20
Disabled seats available :  G1, G19
Disabled seats available :  H1, H19
Disabled seats available :  J1, J19
Disabled seats available :  K1, K19
Disabled seats available :  L1, L15 
```

但我希望座位以下列方式显示：

```
Disabled seats available: A1,A14,B1,B16 
```

就像每个之间没有线条？

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:02:03.497

只需删除`groupby`调用，然后直接使用光标中的行：

```
print 'Disabled seats available : ', ', '.join([r[0] for r in cur]) 
```

# sql - 循环在包中不起作用

> ID：14880085
> 
> 赞同：0
> 
> 时间：2013-02-14T16:59:40.823
> 
> 标签：sql, oracle11g, oracle-sqldeveloper, plsqldeveloper

我有两张桌子： - 个人和银行详细信息

```
Person table :---
person_id     employee_number
393829          X1029
648494          x9494
393939          X2299

Bank details :---

person_id       bank_form
393829         Reimb
393829         Sal
648494         Sal
393939         Common 
```

现在，如果某个人的银行表格为“sal”和“reimb”，则必须打印“This is it”。如果他只有“common”作为银行表格，则也无需执行任何操作。我为此做了一个光标。但是“这就是它”行不起作用。

```
Create or replace package body xx_bank_details
as 
procedure xx_bank_details_proc( 
ERRBUF out varchar2,
 RETCODE  out varchar2
)

Cursor c1
is 
select person_id
from person;

Cursor c2(p_person_id)
is select bank_form
from bank_details
where bank_details.person_id=p_person_id;

begin

for cur_c1 in c1
loop
        for cur_c2 in c2(c1.person_id)
        loop
        if(cur_c2.bank_details='Sal')
then
l_sal :='Sal';
end if;
if(cur_c2.bank_details='Reimb')
then
l_reimb :='Reimb';
end if;
if(cur_c2.bank_details='Common')
then
l_common :='Common';
end if;
end loop;
if (l_sal is not null and l_reimb is not null)
then
fnd_output.put_line("This is it !");
end if;

end loop;
end xx_bank_details_proc;
end xx_bank_details; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:16:38.167

您的代码充满了错误，因此很难知道您是否匆忙将整个事情放在一起以进行 stackoverflow 发布或什么。您的主要问题是您没有在`C1`循环的每次迭代中将三个局部变量重置为 NULL 。

您的逻辑也如所述“但如果银行表格只有“Sal”而没有“Reimb”，那么您必须打印出来的表格”与代码不匹配，因为如果两者都存在，则代码正在打印出来。

这整个事情可以在一个单独的 SQL 语句中完成，尽管不需要所有这些游标循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:07:25.350

这里的关键是使用 SQL 来隔离您要对其执行操作的记录。

一种形式是：

```
begin
for x in (
  select person_id
  from   person
  where  exists (
           select null -- see comment below *
           from   bank_details
           where  bank_details.person_id=person.person_id and
                  bank_form in ('Sal','Reimb')
           having count(*) = 2)
loop
  fnd_output("This is it!)
end loop
end 
```

可以使用的 SQL 有很多变体，但关键问题是将逻辑推入 SQL 而不是游标，尤其是显式游标。

评论 * ：在“存在”子查询中，从子查询投影的值无关紧要。“存在”正在查看是否投影了任何行，无论包含多少列或行以及值是什么。选择 null、1、“x”或任何其他文字中的任何一个都是等效的，但选择 null 是一种很好的说法，即“值是什么并不重要”。

# cmake - 带有模块和外部库的 Fortran 程序的 cmake

> ID：14880086
> 
> 赞同：4
> 
> 时间：2013-02-14T16:59:42.983
> 
> 标签：cmake, fortran

我正在尝试使用一个外部模块为我的 Fortran 项目编写一个 cmake 列表，并且两者都必须与一个没有任何 cmake find (findlib) 包的外部库链接。到目前为止，我的 CMakeLists.txt 看起来像这样：

```
cmake_minimum_required (VERSION 2.6)

project (Project 1)

enable_language (C Fortran)

set(extern_INCLUDE /home/path/lib/libdir/include/)
set(extern_LIB /home/path/lib/libdir/lib)
include_directories(${extern_INCLUDE})
link_directories (${extern_LIB})

add_library(mymodule STATIC mymodule.f90)
set(main-source_SRC main-source.f)
add_executable(main-source ${main-source_SRC})
#the name of the external library located in /home/path/lib/libdir/lib is    libexternlib.so
target_link_libraries(main-source mymodule externlib) 
```

创建了一个 libmymodule.a 并且绝对没有必要（或者就此而言共享一个）。我不想生成它们。如何避免它的生成并仍然编译 mymodule，生成 .o 和 .mod 以便能够与主程序和外部库链接？等效于 ifort -c 到 mymodule 和 ifort 到所有 .o。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:07:16.143

你有源代码`mymodule`。您可以包含`mymodule.f90`在`main-source_SRC`. 这应该足够了。我希望以下工作，但我无法测试它。

```
cmake_minimum_required (VERSION 2.6)

project (Project 1)

enable_language (C Fortran)

set(extern_INCLUDE /home/path/lib/libdir/include/)
set(extern_LIB /home/path/lib/libdir/lib)
include_directories(${extern_INCLUDE})
link_directories (${extern_LIB})

set(main-source_SRC main-source.f mymodule.f90)
add_executable(main-source ${main-source_SRC})
#the name of the external library located in /home/path/lib/libdir/lib is    libexternlib.so
target_link_libraries(main-source externlib) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T16:24:04.810

The file libmymodule.a is a static library, and is created because the STATIC option in the add_library() function tells CMake to do so. Instead of STATIC, try using SHARED to create the shared library libmymodule.so - though I'm not sure it's the static bit you're worried about here.

If the external library does not come with a FindLib file, it may be easy enough to create one yourself. There are a number of examples in the FindLibs/ directory of the CMakeFiles package, which provides example CMake files, in particular for Fortran projects: [http://cmakefiles.sf.net/](http://cmakefiles.sf.net/)

# jquery - 在 ror 中使用回形针进行多次上传

> ID：14880100
> 
> 赞同：3
> 
> 时间：2013-02-14T17:00:18.880
> 
> 标签：jquery, ruby-on-rails, paperclip, photos

我正在使用回形针为一栋建筑物上传一张照片。[http://www.youtube.com/watch?v=KGmsaXhIdjc](http://www.youtube.com/watch?v=KGmsaXhIdjc)我已经用这种方式完成了。但是知道我决定将许多照片上传到一栋建筑物。我可以用回形针做到这一点还是必须改变它并使用 jQuery ？如果我可以怎么办？ **Ps：如果需要我会上传我的代码。ps：我正在考虑在数据库中为 photo2 和 photo 3 再创建 2 个列**。顺便说一句，我已经看到所有生成的资产都可以做到这一点。我的想法是我用不同的方式上传了 1 张照片。这意味着我必须改变一切？

更新1：

在路线.rb

```
resources :buildings do 
      resources :photos
  end 
```

在建筑物>_form

```
<%= form_for(@building, :html=>{:multipart => true}) do |f| %>
  <% if @building.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@building.errors.count, "error") %> prohibited this building from being saved:</h2>

      <ul>
      <% @building.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :title %><br />
    <%= f.text_field :title %>
  </div>
  <div class="field">
    <%= f.label :status %><br />
    <%= f.select :status, Building::STATUS, :prompt=>'Select status of the building' %>
  </div>
  <div class="field">
    <%= f.label :description %><br />
    <%= f.text_area :description, :rows => 10 %>
  </div>
  <div class="field">
    <%= f.label :price %><br />
    <%= f.text_field :price %>
  </div>
  <div class="field">
    <!--<%= f.label :photo %><br />
    <%= f.file_field :photo %> -->
    <%= f.fields_for :photos do |photo| %>  
    <% if photo.object.new_record? %>
      <%= photo.file_field(:image) %>

     <% else %> 
        <%= image_tag(photo.url(:thumb)) %>
        <%= photo.hidden_field :_destroy %>
        <%= photo.link_to_remove "X"%>
    <% end %>
  <% end %>

    <p><%= f.link_to_add "Add photo", :photos %></p>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

在模型>建筑中

```
 attr_accessible :description, :price, :status, :title, :photo

accepts_nested_attributes_for :photo, :allow_destroy => true

  has_attached_file :photo ,
                  :url  => "/assets/products/:id/:style/:basename.:extension",
                  :path => ":rails_root/public/assets/products/:id/:style/:basename.:extension" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T08:51:49.653

是的，你可以用回形针来做。我这样做的方式是使用嵌套资源和[nested_form](https://github.com/ryanb/nested_form) gem。

例如你`building has_many :photos`和`photo belongs_to :building`

然后在你的`/views/buildings/_form.html.erb`你会写这样的东西：

```
<%= nested_form_for @building, :html => { :multipart => true } do |f| %>
  <%# all your building fields .... %>

  <%= f.fields_for :photos do |photo| %>  
    <% if photo.object.new_record? %>
      <%= photo.file_field(:image) %>
    <% else %> 
      <%= image_tag(photo.url(:thumb)) %>
      <%= photo.hidden_field :_destroy %>
      <%= photo.link_to_remove "X" %>
    <% end %>
  <% end %>

  <p><%= f.link_to_add "Add photo", :photos %></p>

  <%= f.submit %>
<% end %> 
```

您必须在模型中设置`accepts_nested_attributes_for :photos, :allow_destroy => true`并`building.rb`确保您`routes.rb`还包括嵌套：

```
resources :buildings do 
  resources :photos
end 
```

# session - 会话总是在登录时创建

> ID：14880107
> 
> 赞同：0
> 
> 时间：2013-02-14T17:00:40.077
> 
> 标签：session, jakarta-ee, login, cdi

通常我在我的项目中使用带有自定义登录表单和 bean 的 Java EE 身份验证。因此，我将 Glassfish 配置为从数据库 (JDBC) 获取用户/密码，创建一个调用 HttpServletRequest 的 login() 方法的 RequestScoped bean（名为“LoginBean”）上的 login() 方法的 jsf 表单。

当登录尝试成功时，我将用户信息设置在一个注入到 LoginBean 中的 SessionScoped bean 中，我将其命名为“LoginService”。然后，在许多其他网站页面和 bean 中，我总是通过注入 LoginService 并访问它的数据来使用这些数据。

一切都很好，但我注意到如果用户进入登录页面，即使它尚未尝试登录，也会创建一个会话。我的猜测是它的发生是因为 LoginService 在对象创建时总是被注入到 LoginBean 中。

正因为如此，我有两个问题：

1.  我应该关心这个会话吗？这会导致任何问题吗？
2.  在每次用户访问登录页面时不创建会话的情况下进行此自定义登录的最佳方法是什么？我的意思是，我可以在成功后在查询字符串上传递用户信息，但这太可怕了。:)

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:05:14.377

> *我应该关心这个会话吗？这会导致任何问题吗？*

依靠。如果您的服务器在相对“便宜”的硬件上，那么成功进行 DDOS 攻击的机会就更大，因为在达到硬件限制之前，可以创建的会话多于服务器可以破坏的会话。

* * *

> *在每次用户访问登录页面时不创建会话的情况下进行此自定义登录的最佳方法是什么？*

不要注入会话范围的 bean。自己放置`User`会话中的地图。有关具体示例，另请参见[使用 j_security_check 在 Java EE / JSF 中执行用户身份验证的“更新”部分：](https://stackoverflow.com/questions/2206911/best-way-for-user-authentication-on-javaee-6-using-jsf-2-0/2207147#2207147)

```
public void login() throws IOException {
    FacesContext context = FacesContext.getCurrentInstance();
    ExternalContext externalContext = context.getExternalContext();
    HttpServletRequest request = (HttpServletRequest) externalContext.getRequest();

    try {
        request.login(username, password);
        User user = userService.find(username, password);
        externalContext.getSessionMap().put("user", user);
        externalContext.redirect(originalURL);
    } catch (ServletException e) {
        // Handle unknown username/password in request.login().
        context.addMessage(null, new FacesMessage("Unknown login"));
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T21:14:17.993

既然你用 CDI 标记了这个，我有点怀疑这样做：

```
externalContext.getSessionMap().put("user", user); 
```

我对 glassfish 不熟悉，也不知道“Java EE 身份验证”是关于什么的。所以这只是我作为 CDI+tomcat 用户的两分钱。

我想说，如果你想用 CDI 来做这件事，你不应该让 bean 成为 @SessionScoped 看看你需要如何更好地控制它。

The userBean: I would go for `@WindowScoped` from myfaces CODI (will be included in deltaspike 0.4). I would have the loginBean be `@RequestScoped`. I would have a second loginBean `@ViewScoped` (myfaces codi required).

`@PreDestroy` could then be used on a method on our main loginBean. If authenticated == false we should destroy the `@windowScoped` bean.

The `@ViewScoped` bean is responsible for remembering number of failed login attempts and the username. Then again this is only if I would actually mind just creating the @WindowScoped bean (I don't for my projects)

# c - PIC 上的 Bit-banged 串行停止使用 C 中的嵌套循环

> ID：14880108
> 
> 赞同：0
> 
> 时间：2013-02-14T17:00:46.697
> 
> 标签：c, microcontroller, pic, pic18, c18

Stackoverflow，你以前帮助过我，我想我再次需要你的帮助。我正在尝试使用 PIC18F2550 上的 GPIO 对我自己的串行进行 bit-bang。这连接到一些移位寄存器 (3x74LS595)，其中最后一个连接到标准 HD44780 LCD。到目前为止，我的时钟和闩锁工作正常，经过长时间的战斗，数据现在也被正确吐出（结果桶移位效果不佳，事情会很乐意吐出数据超出范围但我离题了）。

我的问题是，要使用 LCD，我需要将启用引脚切换为数据时钟，因此为了保存代码，我只需嵌套另一个循环，该循环运行两次并切换启用标志，否则会吐出相同的字节。从理论上讲，这应该是从 12 到 24 吐出的字节数的两倍。无论出于何种原因，添加此循环时它都不起作用。它只是吐出两个字节并退出。没有它，它会吐出所有 12 个字节（尽管 LCD 设置不正确，因为启用不存在）。

这是它工作的图片，没有嵌套的启用循环：

[链接，因为缺乏代表](http://i.stack.imgur.com/vw2kk.png)

D0 是数据，下面的 D1/2 分别是时钟/负载。

这里是 for 循环：

[链接，因为缺乏代表](http://i.stack.imgur.com/3nIxb.png)

最左边的那个边缘是线的初始重置。我知道它在这两个字节之后完成，因为它会发出我拥有的小蜂鸣器的哔哔声，表明所有有意义的代码都已完成。

这是一个代码转储：

```
//First testing program for PIC18F2550

#include <p18f2550.h>
#include <stdlib.h>
#include <delays.h>

#define _XTAL_FREQ 4915200 
#pragma config PLLDIV = 1
#pragma config CPUDIV = OSC1_PLL2
#pragma config FOSC = XT_XT
#pragma config MCLRE = ON
#pragma config BOR = OFF
#pragma config WDT = OFF
#pragma config IESO = OFF
#pragma config PBADEN = OFF
#pragma config LVP = OFF

unsigned char setupstream[12] = {0b0011, 0b0011, 0b0011, 0b0010, 0b0010, 0b1000, 0b0000, 0b0001, 0b0000, 0b1111, 0b0000, 0b0110};
unsigned char teststream[6] = {0xF0, 0x00, 0xFF, 0x00, 0xFF, 0x00};
unsigned char letterstream[2] = {0b0010, 0b0001};
unsigned char c1 = 0, c2 = 0, c3 = 0, outreg = 0, outmask = 0, feedout = 0;

void main(void){

//CONFIG4L = 0b01000001;
UCONbits.USBEN=0;
UCFGbits.UTRDIS=1;
//OSCCONbits.IRCF2=1;
//OSCCONbits.IRCF1=1;
//OSCCONbits.IRCF0=1;
OSCCONbits.SCS1 = 0;
OSCCONbits.SCS0 = 0;
BAUDCONbits.TXCKP=0;
SPBRG = 0x3F;  //1200 baud
TRISA = 0x00;
TRISB = 0xFF;
TRISC = 0x00;     

LATCbits.LATC0 = 1;     //Start: beep the speaker
Delay10KTCYx(8);
LATCbits.LATC0 = 0; 
Delay10KTCYx(8);

LATA = 0;               //reset
Delay10KTCYx(8);
LATAbits.LATA2 = 1;     //load the reset
Delay10KTCYx(8);
LATAbits.LATA3 = 1;     //stop reset
LATAbits.LATA2 = 0;
Delay10KTCYx(123);

for(c1==0; c1<12; c1++){
    for(c2==0; c2<2; c2++){
        outreg = setupstream[c1] << 2;  //nibble of data needs to be in the middle
        //outreg |= 0b00000010;         //set flags  
        //outreg ^= 0b00000001; 

        outmask = 0x80;                 
        for(c3=0; c3<8; c3++){
            LATAbits.LATA0 = (outreg & outmask) ? 1:0;
            outmask >>=1;           

            Delay10KTCYx(8);
            LATAbits.LATA1 = 1;     //clock the data out
            Delay10KTCYx(8);
            LATAbits.LATA1 = 0;             
        }

        Delay10KTCYx(8);        
        LATAbits.LATA2 = 1;         //one byte fed out; load it into shift regs
        Delay10KTCYx(8);
        LATAbits.LATA2 = 0;
    }
}

LATAbits.LATA0 = 0;   //Done, clear the line and 
LATCbits.LATC0 = 1;   //Beep the speaker
Delay10KTCYx(8);
LATCbits.LATC0 = 0; 
Delay10KTCYx(8);    

while(1){  //Idle
}
} 
```

在上面的代码中，我什至禁用了切换以查看它是否会吐出所有字节。可能不会。我正在认真考虑只在汇编中完成这一切，因为对于 C 语言，我在看似简单的东西上遇到了很多问题。感觉就像我无法控制这件事的背景中发生的事情。我正在使用 Pickit 3，但如果我想了解实际情况，我可能只需要挖掘 ICD2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:09:20.933

尝试使用赋值（单 =）而不是比较（双 ==）初始化 for 循环变量

采用

```
for(c1=0; c1<12; c1++){
    for(c2=0; c2<2; c2++){ 
```

代替

```
for(c1==0; c1<12; c1++){
    for(c2==0; c2<2; c2++){ 
```

# php - Symfony2：在 PHPUnit 中创建模式一次只运行一个命令

> ID：14880111
> 
> 赞同：0
> 
> 时间：2013-02-14T17:01:14.983
> 
> 标签：php, symfony, doctrine, phpunit

我正在将 Symfony2 和 PHPUnit 与 Doctrine 一起使用并编写插件包。我有一个扩展 Symfony 的 WebTestCase 的 TestCase 类。

在 setUp 方法中，我需要创建一个用于测试的模式并加载一些固定装置。

我的代码（如下）正在构建一个应用程序内核，启动一个应用程序，然后运行几个命令来删除一个模式（如果它在那里），重新创建它并加载一些数据夹具。

我遇到的问题是，在应用程序上使用 run() 方法时，它只运行第一个命令，然后测试停止，标记为成功，没有错误或消息。

为了执行下一个命令，我需要推荐出第一个命令并再次运行测试。

显然，我想要的结果是每个方法都按顺序运行。

```
/**
 * setUp
 *
 * @return void
 **/
public function setUp()
{
    parent::setUp();

    $this->appKernel = $this->createKernel();
    $this->appKernel->boot();

    $this->application = new Application($this->appKernel);

    $this->em = $this->appKernel->getContainer()->get('doctrine')->getManager();

    $this->buildDb();
}

/**
 * buildDb
 * Builds the DB from the Entities in Acme\TestBundle\Entity
 * @return void
 **/
private function buildDb()
{
    $this->application->run(new ArrayInput(array(
        'doctrine:schema:drop',
        '--force' => true
    )));

    $this->application->run(new ArrayInput(array(
        'doctrine:schema:create'
    )));

    $this->application->run(new ArrayInput(array(
        'doctrine:fixtures:load',
        '--fixtures' => 'tests/SupportFiles/bundles/Acme/TestBundle/DataFixtures/Test'
    )));

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T01:22:31.227

I would encourage you to check out [ICBaseTestBundle](https://github.com/instaclick/ICBaseTestBundle) which can handle easily creating a clean database for each test case, and loading appropriate data fixtures, instead of writing your own version of doing it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T10:31:14.977

刚刚发现如何阻止这种情况发生。

默认情况下，Application 类在命令运行后停止执行。要阻止它这样做，必须调用 Application 中的一个方法，并将“false”作为参数传递：

```
$this->application->setAutoExit(false); 
```

# vbscript - Visual Basic 脚本中的网页自动填充

> ID：14880112
> 
> 赞同：0
> 
> 时间：2013-02-14T17:01:22.523
> 
> 标签：vbscript

我正在使用 Visual Basic 脚本自动填充标题为：

id='V_RUN_PA100A_BUSINESS_UNIT' （我从页面源得到这个）

我使用了代码

```
Set ie = CreateObject("InternetExplorer.Application")
ie.navigate("https://jayfin.cov.kansas.gov/psp/finprd/?cmd=login&languageCd=ENG")
ie.visible = 1
ie.document.all.item("V_RUN_PA100A_BUSINESS_UNIT").Value = "40400" 
```

我不断收到错误`..object required`

根据我的理解，盒子的ID是单引号而不是双引号的事实是问题......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T14:25:31.680

如果使用元素 ID 设置值会发生什么？

```
ie.document.getElementById("V_RUN_PA100A_BUSINESS_UNIT").Value = "40400" 
```

双/单引号不是问题。在 javascript/html 中你可以同时使用，VBScript 只使用双引号，但它们都是可以互换的。

# java - ArrayLists 的二维数组空异常

> ID：14880115
> 
> 赞同：2
> 
> 时间：2013-02-14T17:01:35.160
> 
> 标签：java, arraylist, multidimensional-array

我有一个具有 ArrayList 属性的类，以及另一个具有该类的二维数组的类：

```
public class someThingsList {

    private List<someThings> lst;

    public someThingsList () {
        this.lst = new ArrayList<someThings>();
    }
    public addThing(someThings) {
        someThings s = someThings;
        this.lst.add(s);
    }
} 
```

和

```
public class x implements y {

    private static someThingsList[][] field;

    public x(int h, int w) {
    x.field = new someThingsList[h][w];
    for (someThingsList[] lst1 : x.field)
        for (someThingsList lst2 : lst1)
            lst2 = new someThingsList();
} 
```

例如，当我有一个新的 x 对象，其中 (2,2) 作为 h 和 w，并尝试做

```
x.fields[0][0].addThing(thing); 
```

我收到 NullPointerException 错误，知道为什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T17:05:24.157

不幸的是，当您想要对数组进行变异时，您不能对数组使用增强的 for-each 循环。`lst2`在您的示例中只是另一个引用（对`null`），修改它不会修改原始数组。试试这个：

```
for(int i = 0; i < field.length; ++i)
    for(int j = 0; j < field[i].length; ++j)
        field[i][j] = new someThingsList(); 
```

或者：

```
for(int i = 0; i < h; ++i)
    for(int j = 0; j < w; ++j)
        x.field[i][j] = new someThingsList(); 
```

事实上，这个问题并不特定于数组。检查以下代码：

```
List<String> strings = //...

for(String s: strings) {
    s += "Bar";
} 
```

尽管看起来好像您正在修改原始`strings`列表，但您几乎没有修改`s`在每次循环后重新创建并忽略的临时变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:05:22.843

您已经实例化了数组`x.field = new someThingsList[h][w];`，但没有实例化`someThingsList`Object。所以 x.field[i][j] 给出`NullPointerException`.

```
for(int i = 0; i < x.field.length; i++)
    for(int j = 0; j < x.field[i].length; j++)
        x.field[i][j] = new someThingsList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T17:38:00.660

您的代码的问题是，当您为每个循环迭代第二个时，您正在实例化“lst2”的值，它是循环的局部变量，因此它不会影响您的原始数组。一旦你的循环超过 lst2 的值就会丢失。这样您的数组元素保持为空，并且当您尝试在空对象上调用方法时，它会给出空指针异常。

要理解这一点，请尝试打印 arr[0]。它将打印一个对象类型，然后尝试打印 a[0][0] 这将打印 null。

希望这可以清除您的语法不起作用的原因。

尝试运行此代码，您将了解这里出了什么问题。

```
import java.util.*;
class someThingsList {

    private List<String> lst;

    public someThingsList () {
        this.lst = new ArrayList<String>();
    }
    public void addThing(String someThings ) {
        String s = someThings;
        this.lst.add(s);
    }
}
class Main{

    private static someThingsList[][] field;

 public static void main (String[] args) throws java.lang.Exception
  {
    new Main(3,3);
System.out.println(Main.field[0]);
System.out.println(Main.field[0][0]);
    Main.field[0][0].addThing("thing");
  }

    public Main(int h, int w) {
    Main.field = new someThingsList[h][w];
    for (someThingsList[] lst1 : Main.field)
    {
    System.out.println(lst1);
        for (someThingsList lst2 : lst1){
System.out.println(lst2);
            lst2 = new someThingsList();
System.out.println(lst2);}
    }
    }
} 
```

# python - 从父类控制子类方法

> ID：14880117
> 
> 赞同：3
> 
> 时间：2013-02-14T17:01:39.467
> 
> 标签：python, class, python-2.7, parent-child

假设我有这个代码：

```
class Foo:
    def write(self, s=""):

        # Make sure that overwritten
        # 'write' method in child class
        # does what it's specified, and
        # then what comes next...

        print "-From Foo"

class Bar(Foo):
    def write(self, s=""):
        print s

baz = Bar()
baz.write("Hello, World!") 
```

最后一个调用显然是自己输出hello world。我还需要让它写“-From Foo”，但不修改 Bar 类，只修改 Foo 类。我尝试过使用 the`__bases__`和其他东西，但它不适用于我的目的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T17:11:07.243

我 100% 同意 Lattyware：你**不应该这样**做。父类不应该“知道”子类或它们如何工作。

但我必须说，可以使用一些`__getattribute__`魔法：

```
class Foo(object):
    def __getattribute__(self, attr):
        if attr != 'write':
            return super(Foo, self).__getattribute__(attr)
        meth = super(Foo, self).__getattribute__(attr)
        if meth.im_func is Foo.write.im_func:
            # subclass does not override the method
            return meth

        def assure_calls_base_class(*args, **kwargs):
            meth(*args, **kwargs)
            Foo.write(self, *args, **kwargs)
        return assure_calls_base_class

    def write(self, s=""):
        print "-From Foo"

class Bar(Foo):
    def write(self, s=""):
        print s 
```

运行代码：

```
>>> b = Bar()
>>> b.write('Hello, World!')
Hello, World!
-From Foo 
```

但是请注意，这只是一个 hack，并且在使用一些继承时可能会中断，或者即使您`write`从类访问：

```
>>> Bar.write(b, 'Hello, World!')  #should be equivalent to b.write('Hello, World!')
Hello, World! 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T17:03:05.633

没有修改就没有（好的）方法可以做到这一点`Bar()`- 你想做的是使用`super()`inside `Bar()`，这将允许你调用父方法。

如果你正在使用一个你不能修改的类，那么最好的解决方案是制作一个包装类来手动执行你想要的操作，使用表现不佳的类。例如：

```
class BarWrapper(Foo):
    def __init__(self, *args, **kwargs):
        self.bar = Bar(*args, **kwargs)

    def write(self, *args, **kwargs):
        super(BarWrapper, self).write(*args, **kwargs)
        self.bar.write(*args, **kwargs) 
```

（当然，根据你的类有多少，需要更多，并注意在 3.x 中，你可以`super()`通过删除参数来使用更简单的语法。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-14T17:24:19.130

这是使用元类魔法的一种方法；恕我直言，它比其他方法更健壮和灵活，它还可以`Bar.write(x, "hello")`正确处理无界调用（例如）和单继承（参见下面的 Baz）：

```
class ReverserMetaclass(type):
    def __new__(cls, name, bases, dct):
        """ This metaclass replaces methods of classes made from it
            with a version that first calls their base classes
        """
        # create a new namespace for the new class
        new_dct = {}
        for member_name, member in dct.items():
            # only decorate methods/callable in the new class
            if callable(member):
                member = cls.wrap(bases, member_name, member)
            new_dct[member_name] = member
        # construct the class
        return super(ReverserMetaclass, cls).__new__(cls, name, bases, new_dct)

        # instead of the above, you can also use something much simpler
        #     dct['read'] = cls.wrap(bases, 'read', dct['read'])
        #     return super(ReverserMetaclass, cls).__new__(cls, name, bases, dct)
        # if you have a specific method that you want to wrap and want to 
        # leave the rest alone

    @classmethod
    def wrap(cls, bases, name, method):
        """ this method calls methods in the bases before calling the method """
        def _method(*args, **kwargs):
            for base in bases:
                if hasattr(base, name):
                    getattr(base, name)(*args, **kwargs)
            # put this above the loop if you want to reverse the call order
            ret = method(*args, **kwargs)
            return ret
        return _method 
```

示例控制台运行：

```
>>> class Foo(object):
...     __metaclass__ = ReverserMetaclass
...     def write(self, s=""):
...         # Make sure that overwritten
...         # 'write' method in child class
...         # does what it's specified, and
...         # then what comes next...
...         print "Write - From Foo", s
...     def read(self):
...         print "Read - From Foo"
...
>>> class Bar(Foo):
...     def write(self, s=""):
...         print "Write - from Bar", s
...     def read(self):
...         print "Read - From Bar"
...
>>> class Baz(Bar):
...     def write(self, s=""):
...         print "Write - from Baz", s
...
>>> x = Bar()
>>> x.write("hello")
Write - From Foo hello
Write - from Bar hello
>>> Bar.read(x)
Read - From Foo
Read - From Bar
>>>
>>> x = Baz()
>>> x.read()
Read - From Foo
Read - From Bar
>>> x.write("foo")
Write - From Foo foo
Write - from Bar foo
Write - from Baz foo 
```

Python 元类非常强大，尽管正如其他人所说，你真的不想太频繁地使用这种魔法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-14T18:53:02.743

这是使用元类的另一种方法。与使用相比，它的一个重要优势`__getattribute__()`是访问或使用其他子类属性和方法不会产生额外的开销。如果定义了它的子类，它还支持单继承。

```
class Foo(object):
    class __metaclass__(type):
        def __new__(metaclass, classname, bases, classdict):
            clsobj = super(metaclass, metaclass).__new__(metaclass, classname, 
                                                         bases, classdict)
            if classname != 'Foo' and 'write' in classdict:  # subclass?
                def call_base_write_after(self, *args, **kwargs):
                    classdict['write'](self, *args, **kwargs)
                    Foo.write(self, *args, **kwargs)

                setattr(clsobj, 'write', call_base_write_after)  # replace method

            return clsobj

    def write(self, s=""):
        print "-From Foo"

class Bar(Foo):
    def write(self, s=""):
        print 'Bar:', s

class Baz(Bar):  # sub-subclass
    def write(self, s=""):
        print 'Baz:', s

Bar().write('test')
Baz().write('test') 
```

输出：

```
Bar: test
-From Foo
Baz: test
-From Foo 
```

如果您希望子类`write()`方法之后调用*其*基类的版本而不是根 ( `Foo`) 类的版本，只需更改硬编码：

```
 Foo.write(self, *args, **kwargs) 
```

拨电至：

```
 super(clsobj, self).write(*args, **kwargs) 
```

在`Foo.__new__()`.

# wpf - 破坏了默认按钮的 InputBinding 到 Enter 键

> ID：14880118
> 
> 赞同：0
> 
> 时间：2013-02-14T17:01:41.497
> 
> 标签：wpf

我的 WPF 应用程序有一个用于执行数据库搜索的表单。它有一个`Button`启动搜索，其`IsDefault`属性设置为 true。通常，这允许`Button's Click`在您按表单上的 enter 键时触发事件。

搜索结果显示在 Telerik`RadGridView`控件中。最初，如果您双击结果中的一行，程序会将您带到另一个选项卡并显示您单击的行的详细信息。我的老板让我修改，`RadGridView`以便当您按 Enter 时，控件执行相同的操作。

我能够通过添加一个自定义命令来向我的程序显示详细信息并`CommandBindings`在搜索控件的 XAML 中添加一个`InputBindings`部分来实现这一点。然后我在`RadGridView's`XAML 中添加了一个部分，一切正常。除了按 enter 不再引发默认`Button's Click`事件：

```
<UserControl x:Class="CarSystem.CustomControls.Searcher"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation"
             xmlns:cs="clr-namespace:CarSystem.CustomControls"
             xmlns:vm="clr-namespace:CarSystem.ServiceModel;assembly=ViewModels"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             mc:Ignorable="d"
             Height="620"
             IsVisibleChanged="Searcher_IsVisibleChanged"
             Loaded="Searcher_Loaded"
             Width="990">

    <UserControl.CommandBindings>        
        <CommandBinding CanExecute="DisplayEditHotListEntry_CanExecute"  Command="cs:CarSystemCommands.DisplayEditHotListEntry"  Executed="DisplayEditHotListEntry_Executed" />
        <CommandBinding CanExecute="DisplayEditRecordDetails_CanExecute" Command="cs:CarSystemCommands.DisplayEditRecordDetails" Executed="DisplayEditRecordDetails_Executed" />
    </UserControl.CommandBindings>

    <Grid Background="{DynamicResource ContentBackground}"
              Name="LayoutRoot">

        . . .

        <telerik:RadGridView . . .>
            . . .
            <telerik:RadGridView.InputBindings>
                <KeyBinding Key="Enter" Command="{x:Static cs:CarSystemCommands.DisplayEditHotListEntry}" />
            </telerik:RadGridView.InputBindings>
        </telerik:RadGridView>

        <Button IsDefault="true" . . . />

    </Grid>
</UserControl> 
```

表单顶部有许多指定搜索条件的控件。我想在焦点位于其中一个控件中时按 Enter 键以触发默认`Button's Click`事件，并在焦点位于`RadGridView`. 我怎样才能让它工作？

# c# - 从数据库c#中存储和检索媒体文件

> ID：14880119
> 
> 赞同：0
> 
> 时间：2013-02-14T17:01:35.967
> 
> 标签：c#, binary

我正在尝试构建一个测验程序，从数据库中获取问题并在 Visual Studio 应用程序中显示它们。对于我的一些问题，我想展示一张图片或视频，所以我在我的问题表中添加了一个 varbinary(max) 字段。

但我不知道在这些字段中输入什么我已经阅读了一些文章并看到了像“0x00342”或类似的值。我将如何获得这些数据？我必须做一些将我的文件转换为字节的东西吗？我也读过一些关于“文件流”的东西，这值得研究吗？

我的另一个问题是将我的文件存储到我的数据库中是否明智，或者我应该将文件路径存储在数据库中并将文件放在其他地方，将 varbinary 更改为 varchar？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:03:39.817

存储在数据库列中的二进制文件称为 BLOB（Binary Large OBject）。

[http://support.microsoft.com/kb/309158](http://support.microsoft.com/kb/309158)

# c# - 如何创建一个接受多个 lambda 表达式作为参数的方法？

> ID：14880127
> 
> 赞同：4
> 
> 时间：2013-02-14T17:02:05.477
> 
> 标签：c#, asp.net-mvc, linq, lambda

我正在尝试制作自己的扩展方法，该方法可以采用任意数量的 lambda 表达式，但是每当我添加多个表达式时，它似乎都会窒息。

这是方法：

```
public static MvcHtmlString _RouteButton<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, string label, string controller, string action, params Expression<Func<TModel, TProperty>>[] parameters)
{
   var test = parameters;
   return MvcHtmlString.Empty;
} 
```

这是成功调用它的标记：

```
<%: Html._RouteButton("details", "Health", "SystemDetails", m=>m.Id)%> 
```

这是错误的标记：

```
<%: Html._RouteButton("details", "Health", "SystemDetails", m=>m.Id, m=>m.Status)%> 
```

这是错误：

> 无法从用法中推断出方法的类型参数。尝试明确指定类型参数

任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T17:43:21.887

让我们简化一下：

```
using System;
class P
{
    static void M<R>(params Func<R>[] p) {}
    static void N(int i, string s, decimal m)
    {
        M(()=>i, ()=>s); // fails
        M(()=>i, ()=>s.Length); // succeeds
        M(()=>i, ()=>m); // succeeds
    }
} 
```

现在很清楚为什么您的程序失败了？

在我的程序中，每个调用都尝试推断 R。在第一次调用中，R 被推断为 int 和 string，因此推断失败，因为没有类型既是 int 又是 string。在第二个中，R 被推断为 int 并且......再次为 int ！成功是因为 int 匹配所有边界。第三种，R被推断为int和decimal，成功了，因为每一个int都可以隐式转换为decimal，所以decimal是一个很好的推断。

Id 和 Status 可能是类型不兼容的属性。如果你想这样做，那么推断的类型之一必须是*最好的类型*。

请注意，C# 从不说“哦，我看到你推断出狗、猫和鱼的界限，所以我猜你的意思是动物”。C# 宁愿说“Dog、Cat 或 Fish 都不是最好的界限，所以我不知道你的意思；请明确说明”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T21:55:00.323

Eric Lippert 的回答解释了问题所在。我将添加如何实际解决它：您很可能不需要 lambda 来返回属性的类型，您只想获取表达式树来检查属性。因此，您可以做的是将类型从更改`Func<TModel, TProperty>`为`Func<TModel, object>`（并删除`TProperty`类型参数）。由于 C# 中的所有普通类型都可以隐式转换为`object`，因此您的代码将在此更改后正常编译和运行

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T14:46:20.567

我想在网站上得到这个，以防有人尝试类似的事情。

该代码构建了一个路由表单。为此，它需要属性的**名称**及其**值**。

```
public static void _RouteButton<TModel>(this HtmlHelper<TModel> htmlHelper, string text, string controller, string action, params Expression<Func<TModel, object>>[] parameters)
{
    using (htmlHelper.BeginRouteForm("Default", new { controller = controller, action = action }))
    {
        foreach (Expression<Func<TModel, object>> p in parameters)
        {
            MemberExpression me;
            switch (p.Body.NodeType)
            {
                case ExpressionType.Convert:
                case ExpressionType.ConvertChecked:
                    var ue = p.Body as UnaryExpression;
                    me = ((ue != null) ? ue.Operand : null) as MemberExpression;
                    break;
                default:
                    me = p.Body as MemberExpression;
                    break;
            }
            string name = me.Member.Name;
            string value = p.Compile()(htmlHelper.ViewData.Model).ToString();
            HttpContext.Current.Response.Write(htmlHelper.Hidden(name, value).ToHtmlString());
        }
        HttpContext.Current.Response.Write("<input type='submit' value='" + text + "' />");
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-11-24T04:50:54.820

@eric-lippert 以您的示例解释了“为什么它不起作用”。每个表达式中传递的属性类型不一样。

将扩展方法的签名更改为仅指定 TModel，因为泛型将有助于解决问题。此外，为表达式函数指定object 代替TProperty。

**扩展方法**

```
public static MvcHtmlString _RouteButton<TModel>(this HtmlHelper<TModel> htmlHelper, 
                                                 params Expression<Func<TModel, object>>[] parameters)
{
    var test = parameters;
    return MvcHtmlString.Empty;
} 
```

**ASP/剃须刀**

```
<%: Html._RouteButton(m=>m.Id, m=>m.Status)%>
@Html._RouteButton(m=>m.Id, m=>m.Status) 
```

# html - String.Replace 不适用于长 html 代码。（邮件.正文）

> ID：14880131
> 
> 赞同：0
> 
> 时间：2013-02-14T17:02:28.460
> 
> 标签：html, string, text, replace, document-body

所以，我只是遇到了一个小问题，给定一个邮件对象：

```
Mail = new MailMessage(); 
```

生成它的身体：

```
Mail.IsBodyHtml = true; 
Mail.Body = GenerateHTMLFoo(); // it's a stringbuilder 
```

现在 Mail.Body 包含一个完整的 HTML 文档，例如仅显示第一行：

```
"<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\"> 
```

然后我发送邮件，然后我想替换它的正文中的一些东西：

```
Mail.Body.Replace("cid:header", "header.jpg"); // no effect 
```

有任何想法吗？Mail.Body 是一个字符串，替换对它没有影响。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:10:14.960

我用这个修复了它，但我仍然很好奇为什么它没有以“正常”的方式工作。

```
 MailBody = new StringBuilder(Mail.Body);
            MailBody.Replace("cid:header", "header.jpg");
            Mail.Body = MailBody.ToString(); 
```

# asp.net - 如何在 css 中制作 asp.net 文本框和下拉平面样式？

> ID：14880139
> 
> 赞同：1
> 
> 时间：2013-02-14T17:02:47.757
> 
> 标签：asp.net, css

我有 asp.net 文本框和下拉列表。试图制作平面模型或花式风格。请帮我弄清楚一些例子和样本

```
.RegText
{
    font-family: Tahoma, Arial, Helvetica;
    font-size: 11.5pt;
    width:250px;
    height:30px;
    margin-top:5px;
    margin-bottom:5px;  

}
.RegDropdown
{
    font-family: Tahoma, Arial, Helvetica;
    font-size: 11.5pt;
    height:35px;
    width:250px;
    margin-top:5px;
    margin-bottom:5px;  
}
<td>
  <asp:DropDownList ID="ddlCostcenter" runat="server" CssClass="RegDropdown" 
       AutoPostBack="true" InitialValue="Select One"></asp:DropDownList>
</td>
</tr>
    <tr>
        <td >
             <asp:Label ID="lbInitiative" runat="server" CssClass="RegLabel" Text="Initiative # :"></asp:Label>
        </td>
        <td>
           <asp:TextBox ID="txtInitiative" runat="server" CssClass="RegText" ></asp:TextBox>
           </td> 
```

![在此处输入图像描述](../Images/0bb767a8cdeee1c10045641505997274.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:57:33.640

@James123，我在文本框上使用这种风格，它可以帮助你：

```
input[type=text], input[type=password], textarea
{
  outline:none;
  border:solid 1px #BBB;
  padding:3px;
  font-size:20px;
}

input[type=text]:focus, input[type=password]:focus, textarea:focus
{
  border:solid 1px #888;
} 
```

这是一个关于花哨的文本和文本框的很好提示的页面：[http ://webdesign.about.com/od/css/a/aa051607.htm](http://webdesign.about.com/od/css/a/aa051607.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:04:18.003

只需`border: 0;`用于`input type=text`和`select`

```
input[type=text], select {
   border: 0;
} 
```

[**演示**](http://jsfiddle.net/Ck6cR/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T17:47:01.587

只需添加更多信息……您可能想使用 outline:0; 以及删除那些“额外的边框”（通常在谷歌浏览器中为黄色）

# javascript - 为什么我不能在函数中设置 JavaScript 原型？

> ID：14880140
> 
> 赞同：2
> 
> 时间：2013-02-14T17:02:49.167
> 
> 标签：javascript, prototype

为什么我不能在函数内部设置原型？例如为什么这不起作用？

```
var Bar = function(){
   this.name='Bar'
}

var barProto = new Bar()  

var Foo = function(){
    this.prototype= barProto
}

var foo = new Foo()
console.log(foo.name) // undefined 
```

但这确实有效：

```
var Bar = function(){
   this.name='Bar'
}

var barProto = new Bar()  

var Foo = function(){

}

Foo.prototype= barProto

var foo = new Foo()

console.log(foo.name) // Bar 
```

我不喜欢在创建函数后分配原型的语法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T17:07:34.950

```
this.prototype= barProto 
```

不等于

```
Foo.prototype= barProto 
```

`this`指将由 new Foo() 创建的特定对象

Foo 是构造函数。您在构造函数上设置原型，而不是在特定实例上。

有关原型继承的更多信息：[Mozilla docs](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Inheritance_and_the_prototype_chain)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T17:06:21.297

因为`this.prototype`不一样`Foo.prototype`。当`Foo`用 调用时`new`，对它内部的任何引用`this`都将引用正在创建的实例。

# ajax - Facebook 在分享时将 #!v URL 替换为“_escaped_fragment_”

> ID：14880142
> 
> 赞同：3
> 
> 时间：2013-02-14T17:03:00.277
> 
> 标签：ajax, facebook, url, gwt, mvp

我正在尝试在 Facebook 上从我的应用程序中分享此 URL： [http ://www.example.com/#!v;id=NH1NlYov3bKJ](http://www.example.com/#!v;id=NH1NlYov3bKJ)

但是，它会自动替换为： [http ://www.example.com/?_escaped_fragment_=v%3Bid%3DNH1NlYov3bKJ](http://www.example.com/?_escaped_fragment_=v%3Bid%3DNH1NlYov3bKJ)

此 URL 错误，无法从网页中检索到正确的标题、描述和图片。我能做些什么？谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T17:25:10.763

为什么您的 URL 包含序列`#!`？你能改变它吗？由于 ajax 内容不可抓取，因此序列是（Google）规范的一部分，以使该内容可抓取，并且大多数互联网大鱼现在都在使用它。

它是如何工作的？假设您有一个像`www.example.com/folder#!id=4`. 表示url的某些内容是ajax传递的，它依赖于id=4的信息，称为hash。谷歌爬虫将尝试读取页面`www.example.com/folder?_escaped_fragment_=id=4`，根据规范，爬虫希望找到同一页面的无 ajax 版本。

我一点也不喜欢它，但它确实有效，这就是 Twitter、Facebook、Groveshark 和许多其他大鱼都在使用该规范的原因。因此，当您在 facebook（一个 100% ajax 页面）中分享一首grooveshark 歌曲时，facebook 知道在哪里可以找到同一页面的非 ajax 版本。但正因为如此，Facebook 也在尝试更改您的网址。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-14T17:08:18.860

`#!`根据 Google 的指南，停止使用或处理转义片段查询。

* * *

请参阅[Google 的网站管理员“完整规范”](https://developers.google.com/webmasters/ajax-crawling/docs/specification)：

> 每个包含以感叹号开头的哈希片段的 URL 都被视为**#! 网址**。请注意，任何 URL 最多可以包含一个哈希片段。每个漂亮的 (#!) URL 都有一个对应的丑陋 (_escaped_fragment_) URL，它是通过以下步骤派生的：
> 
> *   哈希片段成为查询参数的一部分。
> *   哈希片段在查询参数中通过在它前面加上 _escaped_fragment_= 来指示
> *   当哈希片段成为查询参数的一部分时，某些字符会被转义。下面列出了这些字符。
> *   URL 的所有其他部分（主机、端口、路径、现有查询参数等）保持不变。

在这种情况下，Facebook 最初是在执行这个从漂亮到丑陋（或客户端动态到可抓取）的步骤。请记住，`_escaped_fragment_`表单*应生成可重复的快照*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T15:48:50.507

我知道哈基，但我即将使用 .htaccess 和 mod_rewrite 来捕获 _escaped_fragement_ url。就我而言，这是因为我制作了一个纯 .html/.js 单页 web 应用程序，我需要捕捉搜索引擎何时需要快照，但您可以使用相同的技术将丑陋的 _escaped_fragment_ 重写为正确的格式为您的网站。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-19T15:50:55.917

另一种想法是在共享之前通过快捷方式服务推送正确的 url，例如[http://goo.gl/](http://goo.gl/)

# php - php百分比计算

> ID：14880152
> 
> 赞同：-2
> 
> 时间：2013-02-14T17:03:41.500
> 
> 标签：php, percentage

如何实现百分比计算：

```
$x=3;
$y = 100\$x;  // 3.333..
$x*$y  - and here I need to get 100 without Observational error 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-02-14T17:05:35.257

您的反斜杠 ( `\`) 不是除法符号。您必须使用除法`/`符号。

这是一个使用`number_format()`它将四舍五入到小数点后两位（百分之一位置）的示例。

```
$x = 3;
$y = 15;

$percent = $x/$y;
$percent_friendly = number_format( $percent * 100, 2 ) . '%'; // change 2 to # of decimals 
```

# ios - 是否可以使用 ios 键盘实现“自动完成”功能？

> ID：14880156
> 
> 赞同：-1
> 
> 时间：2013-02-14T17:03:58.050
> 
> 标签：ios

我想知道是否可以使用 ios 键盘实现自动完成功能 - 就像谷歌一样。有没有人见过有人真的这样做过？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:24:26.637

一个选项是自动完成下拉框。

当用户`(BOOL)textFieldShouldBeginEditing:(UITextField *)textField`调用您的逻辑并将您可能的单词放入包含显示该数组的 a`nsmutablearrray`和 a中时，请继续通过您的检测方法更新您的数组，如果用户 将该标签放入.`popoverview``tableview``didselectrow``uitextfield`

[UITextField 的下拉框](https://stackoverflow.com/questions/11202584/dropdown-box-for-uitextfield/11203099#11203099)

# php - 子文件夹中的控制器不起作用

> ID：14880158
> 
> 赞同：0
> 
> 时间：2013-02-14T17:04:12.160
> 
> 标签：php, json

我的网站在本地运行良好.. 但是当我在线上传时......有一个问题..

子目录中的控制器无法正常工作......但主目录中的控制器工作正常......

domain.com/main 工作 domain.com/users/alerts/youralerts 不工作...

在上面的例子中......我在控制器中有一个名为“users”的文件夹，其中我有一个名为“alerts”的控制器，其中我有一个名为“youralerts”的函数......它没有返回未找到的页面，而是给出了我一个空白页...

```
<html>
<head></head>
<body></body>
</html> 
```

我在任何目录中的任何控制器中的所有功能都给出了这个空白页..我只是使用一层深目录......所以文件夹中没有文件夹。

关于路线，我尝试设置...

$route['users'] = 'users/alerts/youralerts'; 然后只访问 /users ... 不起作用 $route['users'] = 'users'; 没用

也尝试了其他一些......我错过了什么吗？

在进一步调查中，我发现目录中的控制器正在工作，但受安全类保护的控制器不是……这是我的安全类的代码

```
 <?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class MY_Controller extends CI_Controller
{
public function is_post()
{
return $_SERVER['REQUEST_METHOD'] == 'POST' ? TRUE : FALSE;
}
}

<?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Secure_Controller extends MY_Controller {

function __construct()
{
parent::__construct();

//
// Require members to be logged in. If not logged in, redirect to the login page.
//
if( ! $this->ion_auth->logged_in())
{
redirect(base_url() . 'main/login');
}
}

} 
```

再次，它在本地一切正常......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:23:26.210

在没有看到任何源代码的情况下很难说出问题所在。我建议将您的路线添加到此，以便您可以更快地获得帮助。另外一个想法是您是否使用 htaccess 文件路由到您的路由器，或者您打算如何处理这方面的问题？有了更多信息，我确信问题可以立即解决。

# localization - 在 MvvmCross ViewModels 中本地化文本

> ID：14880159
> 
> 赞同：3
> 
> 时间：2013-02-14T17:04:15.607
> 
> 标签：localization, xamarin.ios, xamarin.android, windows-phone-8, mvvmcross

我想从 ViewModel 中获取所有本地化文本（因为它通常是动态的），我想知道您如何使用转换器从用于本地化的 json 文件中获取文本。例如，在下面的代码中，我希望 LocalisedString 使用我目前在静态文本绑定中的视图中使用的转换器 -

```
public string MyText // used in the binding in the View
{
    get
    {
        string exclamation;

        if (MyValue <= 3.3)
        {
            exclamation = LocalisedString("Rubbish!");
        }
        else if (OverallScore > 3.3 && OverallScore <= 6.6)
        {
            exclamation = LocalisedString("Good!");
        }
        else
        {
            exclamation = LocalisedString("Excellent!");
        }

        return exclamation;
    }
} 
```

当前使用 MvvmCross 版本 1。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-14T18:08:32.157

**注意：**这个答案是关于 vNext - 移植回 master 应该相当容易......该区域的差异不是那么大。

* * *

MvvmCross 中内置了一个文本本地化机制。

唯一使用它的公共示例是会议示例。

* * *

此示例包括共享的和 ViewModel 特定的 Json 文件 -[请参阅](https://github.com/MvvmCross/MvvmCross-Samples/tree/master/OldSamples/CirriousConference/Cirrious.Conference.UI.WP7/ConfResources/Text)

这些 Json 文件每个都包含简单的键值对，例如：

```
{
"Title":"SQLBits X",
"Welcome":"Welcome",
"Sessions":"Sessions",
"Sponsors":"Sponsors",
"Tweets":"Tweets",
"Favorites":"Favorites"
} 
```

它们作为内容或资产链接到 Droid、Touch 和 WP……所有这些都由平台使用 ResourceLoader 插件访问。

* * *

为了在运行时使用这些 JSON 文件，核心项目将它们加载到[TextProviderBuilder](https://github.com/slodge/MvvmCross/blob/vnext/Sample%20-%20CirriousConference/Cirrious.Conference.Core/ApplicationObjects/TextProviderBuilder.cs)中：

```
 protected override IDictionary<string, string> ResourceFiles
    {
        get
        {
            var dictionary = this.GetType()
                .Assembly
                .GetTypes()
                .Where(t => t.Name.EndsWith("ViewModel"))
                .Where(t => !t.Name.StartsWith("Base"))
                .ToDictionary(t => t.Name, t => t.Name);

            dictionary[Constants.Shared] = Constants.Shared;
            return dictionary;
        }
    } 
```

如果您愿意，显然可以在此处轻松加载其他 JSON 文件。我的一些应用程序具有以下情况并不少见：

*   错误文件
*   一般共享语句的文件
*   特定组件的文件
*   每个 ViewModel 一个文件

而其他人有：

*   只有一个大文件！

国际化 - 完成后 - 通过加载一组不同的 JSON 文件来完成。通常所做的是首先加载默认集，然后加载增量覆盖 - 因此您可以加载英语作为默认值，Cat 作为覆盖，Cat-Lol 作为进一步细化。

有关这方面的一些讨论，请参见：

*   [MvvmCross 本地化：运行时切换](https://stackoverflow.com/questions/13455635/mvvmcross-localization-switch-at-runtime)
*   以及一些未来的增强功能 - [https://github.com/slodge/MvvmCross/issues/55](https://github.com/slodge/MvvmCross/issues/55)

* * *

假设每个 ViewModel 有一个共享文件和一个文件，那么为了提供对 JSON 文本值的运行时访问，BaseViewModel 提供了 2 个属性：

```
 public IMvxLanguageBinder TextSource
    {
        get { return new MvxLanguageBinder(Constants.GeneralNamespace, GetType().Name); }
    }

    public IMvxLanguageBinder SharedTextSource
    {
        get { return new MvxLanguageBinder(Constants.GeneralNamespace, Constants.Shared); }
    } 
```

这些属性在数据绑定中使用：

*   指定是否使用 SharedTextSource 或 TextSource 的路径
*   MvxLanguageBinderConverter 作为转换器
*   文本键作为 ConverterParameter

例如，在 Droid 中，这是：

```
<TextView
  style="@style/AboutPageBodyText"
  local:MvxBind="{'Text':{'Path':'TextSource','Converter':'Language','ConverterParameter':'Title'}}"
  /> 
```

尽管在现代“瑞士”装订中，这将被写成：

```
<TextView
  style="@style/AboutPageBodyText"
  local:MvxBind="Text TextSource, Converter=Language, ConverterParameter='Title'"
  /> 
```

任何希望使用 Text 的代码也可以这样做 - 例如，请参阅 TimeAgo 文本是如何从 TimeAgoConverter.cs 中的资源字符串创建的，[它](https://github.com/slodge/MvvmCross/blob/vnext/Sample%20-%20CirriousConference/Cirrious.Conference.Core/Converters/TimeAgoConverter.cs) 使用如下资源字符串：

```
{
"TimeAgo.JustNow":"just now",
"TimeAgo.SecondsAgo":"{0}s ago",
"TimeAgo.MinutesAgo":"{0}m ago",
"TimeAgo.HoursAgo":"{0}h ago",
"TimeAgo.DaysAgo":"{0}d ago",
"TimeAgo.Never":"never"
} 
```

有效的代码是：

```
 var valueToFormat = 42;
 var whichFormat = "TimeAgo.DaysAgo";

 var textProvider = this.GetService<IMvxTextProvider>();
 var format = textProvider.GetText(Constants.GeneralNamespace, Constants.Shared, whichFormat);

 return string.Format(format, valueToFormat) 
```

* * *

语言 Binder 和 ValueConverter 是非常简单的代码

*   [MvxLanguageBinder.cs](https://github.com/slodge/MvvmCross/blob/vnext/Cirrious/Cirrious.MvvmCross.Localisation/MvxLanguageBinder.cs)
*   [MvxLanguageBinderConverter.cs](https://github.com/slodge/MvvmCross/blob/vnext/Cirrious/Cirrious.MvvmCross.Localisation/Converters/MvxLanguageBinderConverter.cs)

因此，如果您需要，请随意为您的应用构建更复杂的东西。

* * *

其他跨平台文本本地化技术可用 - 我自己特别想有一天尝试白话 - [https://github.com/rdio/vernacular](https://github.com/rdio/vernacular)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:17:33.903

也许您应该返回枚举而不是字符串并处理视图中的本地化。

# c# - 如果组合框 SelectedIndexChanged 在关闭表单上出现，我的列名中的引用为空

> ID：14880164
> 
> 赞同：0
> 
> 时间：2013-02-14T17:04:29.303
> 
> 标签：c#

我正在使用组合框来显示项目，当我选择它在它下面的文本框中显示该项目的 ID 的项目时，我已经在选定的更改索引事件中编写了代码，当我执行表单并关闭该表单而不做它向我显示的任何形式的对象引用未设置为我的字符串查询中的对象实例我的代码如下所示：

```
 using System;
    using System.Collections.Generic;
    using System.ComponentModel;
    using System.Data;
    using System.Drawing;
    using System.Linq;
    using System.Text;
    using System.Windows.Forms;
    using System.Data.SqlClient;

    namespace TinyErp
    { 
public partial class frmaddprod : Form
{
    public frmaddprod()
    {
        InitializeComponent();
    }

    private void productsBindingNavigatorSaveItem_Click(object sender, EventArgs e)
    {
        this.Validate();
        this.productsBindingSource.EndEdit();
        this.tableAdapterManager.UpdateAll(this.orderMachineDataSet);

    }

    SqlConnection conn = new SqlConnection(Properties.Settings.Default.OrderMachineConnectionString);
    string strgetsupp;

    private void frmaddprod_Load(object sender, EventArgs e)
    {
        // TODO: This line of code loads data into the 'orderMachineDataSet.Suppliers' table. You can move, or remove it, as needed.
        this.suppliersTableAdapter.Fill(this.orderMachineDataSet.Suppliers);
        // TODO: This line of code loads data into the 'orderMachineDataSet.Products' table. You can move, or remove it, as needed.
        this.productsTableAdapter.Fill(this.orderMachineDataSet.Products);

        //string strgetsupp = "select supplier_id from Suppliers where supplier_company='" + ((DataRowView)comboBox1.SelectedItem).Row["supplier_company"].ToString() + "'";
        //conn.Open();
        //SqlCommand cmd = new SqlCommand(strgetsupp, conn);
        //SqlDataReader read;
        //read = cmd.ExecuteReader();
        //read.Read();
        //int sid = int.Parse(read["supplier_id"].ToString());
        //read.Close();
        //conn.Close();
        //supplier_idTextBox.Text = sid.ToString();

    }

    private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
    {
        strgetsupp = "select supplier_id from Suppliers where supplier_company='" + ((DataRowView)comboBox1.SelectedItem).Row["supplier_company"].ToString() + "'";
        conn.Open();
        SqlCommand cmd = new SqlCommand(strgetsupp, conn);
        SqlDataReader read;
        read = cmd.ExecuteReader();
        read.Read();
        int sid = int.Parse(read["supplier_id"].ToString());
        supplier_idTextBox.Text = sid.ToString();
        read.Close();
        conn.Close();
    }

    private void productsDataGridView_CellContentClick(object sender, DataGridViewCellEventArgs e)
    {

    }

    private void frmaddprod_FormClosing(object sender, FormClosingEventArgs e)
    {
        Application.Exit();
    }
 }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:22:05.130

Check if comboBox1.SelectedItem is null before executing anything else

```
private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
    {
       if(comboBox1.SelectedItem==null)
            return;

        strgetsupp = "select supplier_id from Suppliers where supplier_company='" + ((DataRowView)comboBox1.SelectedItem).Row["supplier_company"].ToString() + "'";
        conn.Open();
        SqlCommand cmd = new SqlCommand(strgetsupp, conn);
        SqlDataReader read;
        read = cmd.ExecuteReader();
        read.Read();
        int sid = int.Parse(read["supplier_id"].ToString());
        supplier_idTextBox.Text = sid.ToString();
        read.Close();
        conn.Close();
    } 
```

# c# - Asp.net 绑定之间的会话保存

> ID：14880169
> 
> 赞同：1
> 
> 时间：2013-02-14T17:04:38.830
> 
> 标签：c#, asp.net, session, iis, multi-tenant

我正在构建一个[多租户网站](https://stackoverflow.com/questions/14230644/best-practice-for-dal-and-configuration-on-multi-tenant-isolated-db)，该网站将容纳多个租户，每个租户都有自己的配置。

如果租户的用户将尝试连接，则在 aspmembership 身份验证后，他将获得他的配置。

用户可以访问多个租户，但仍将获得其租户的配置。

我的问题是关于会话：左说我有几个绑定：cust1.domain.com

cust2.domain.com

cust3.domain.com

如果 user1 可以访问 cust1 和 custs，他会得到相同的 sessin

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-10T13:27:54.610

`<forms ...>`您可以通过在 web.config 文件的部分中进行设置来使用域 cookie 。这将允许用户在登录任何一个域后登录到任何域。

您将设置的域 cookie 如下所示。

```
 <authentication mode="Forms">
      <forms loginUrl="/" cookieless="UseCookies" name="FormAuthentication" domain=".domain.com" />
</authentication> 
```

此外，确保呈现 *.domain.com 应用程序的所有代码库中的机器密钥都相同。

# ruby-on-rails - 如何将 current_user 限制为仅在 Ruby on Rails 3 中确认的用户？

> ID：14880171
> 
> 赞同：0
> 
> 时间：2013-02-14T17:04:41.440
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2

我还是 Rails 的新手，我想调整以下（相当标准的）代码，以便任何`current_user`需要将其`confirmed`数据库字段设置为`true`. 换句话说，如果一个`user`的`confirmed`数据库字段是`false`他应该不能成为一个`current_user`。

```
module SessionsHelper

  def current_user=(user)
    @current_user = user
  end  

  def current_user
    @current_user ||= User.find_by_token(cookies[:token]) if cookies[:token]
  end

  def current_user?(user)
    user == current_user
  end

end 
```

如何做到这一点？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:06:36.813

```
def current_user
  user = User.find_by_token(cookies[:token]) if @current_user.nil? && cookies[:token]
  @current_user ||= user if user && user.confirmed 
end 
```

# c++ - 缺少 std::front 和 std::back

> ID：14880172
> 
> 赞同：7
> 
> 时间：2013-02-14T17:04:41.173
> 
> 标签：c++, c++11

是否有原因`std::front`并且`std::back`在 C++11 中不存在？对我来说，在实际实例中具有等价`std::begin`物*是*有意义的。`std::end`

 ** * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T17:07:59.050

`std::begin()`并且`std::end()`应该适用于*所有*基本容器（包括 C 风格的数组）。

事实上，如果容器支持成员`begin()`和`end()`函数，`std::begin()`并将`std::end()`调用转发给那些成员函数。

但是，并非所有容器都支持`front()`成员`back()`函数。*

# python - 如何读取文件的特定部分

> ID：14880173
> 
> 赞同：0
> 
> 时间：2013-02-14T17:04:43.797
> 
> 标签：python, file, for-loop

我有一个大文件，将只发布其中的一小部分：

```
World population in thousands
Source: United Nations, DEMOBASE

Country/ISO country code/UN Code/Population 1950/Population 2012
----------------------------------------------------------------
Afghanistan/AF/4/8151/33397
Albania/AL/8/1215/3227
Algeria/DZ/12/8753/36486
American Samoa/AS/16/19/71
Andorra/AD/20/6/88 
```

我的问题是我如何阅读前 5 行，即国家信息开始之前的信息。

我尝试过类似的东西：

```
file=open("wordpop.txt","r")
for i in range[0:5]:
    rows = file.read()
print(rows) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:07:59.387

`range()`是一个函数，而不是一个列表。`range(5)`会工作得更好，但你只是读取文件 5 次（读取空结果四次）。

用于`readline()`读取文件中的*一行*，并使用列表推导轻松将这些行放入列表中：

```
with open("wordpop.txt","r") as infile:
    rows = [infile.readline() for _ in range(5)]
print(rows) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-14T17:08:21.917

尝试：

```
for line in file.readlines()[:5]:
    print line 
```

# java - ListField 选定的换行符其他行的高度

> ID：14880174
> 
> 赞同：0
> 
> 时间：2013-02-14T17:04:50.553
> 
> 标签：java, blackberry, blackberry-simulator

我有一个 ListField 行为怪异，我没有很多 BB 开发经验，但是在互联网上进行了大量搜索后，我得到了以下结果。我用[这个教程](http://javalearning-adventure.blogspot.com/2012/10/blackberry-listfield-tutorial-part-2.html "黑莓 ListField 教程第 2 部分") 做了很多 ListField 的东西。

这是我第一次打开屏幕并且不做任何其他事情时的屏幕截图：

![屏幕 A](../Images/27763b0638787ec1e2b321365f43358e.png)

这是我向下滚动时的屏幕截图，这对所有字段都有相同的效果：

![在此处输入图像描述](../Images/c07bbf5a1b09addcc186026b8f071982.png)

这是我根据上面提到的教程根据我的需要调整的实现：

```
private Bitmap p1;
TableRowManager row;
Vector rows;

public ImageListField(List list) {
    /* Init & Declaration */
    setEmptyString("This ListField has No Data", DrawStyle.HCENTER);
    setCallback(this);
    setRowHeight(50);
    Font.getDefault();
    p1 = Bitmap.getBitmapResource("no-image.png");
    rows = new Vector();
    for (int x = 0; x < list.size(); ++x) {
        Event e = (Event)list.getAt(x);

        row = new TableRowManager();

        BitmapField myImageField = new BitmapField(p1);
        row.add(myImageField);
        row.add(new LabelField(e.Name,
                DrawStyle.ELLIPSIS | FOCUSABLE){

            public void paint(Graphics g) {
                g.setBackgroundColor(Color.BLACK);
                g.fillRect(0, 0, getWidth(), getHeight());
                g.setColor(Color.WHITE);
                g.clear();
                super.paint(g);
            }

        });

        if(e.DateFrom.compareTo(e.DateTo) == 0)
        {
            row.add(new LabelField(e.DateFrom,
                    DrawStyle.ELLIPSIS | FOCUSABLE){

                public void paint(Graphics g) {
                    g.setBackgroundColor(Color.BLACK);
                    g.fillRect(0, 0, getWidth(), getHeight());
                    g.setColor(Color.WHITE);
                    g.clear();
                    super.paint(g);
                }

            });
        }
        else
        {
            row.add(new LabelField(e.DateFrom + " - " + e.DateTo,
                    DrawStyle.ELLIPSIS | FOCUSABLE){

                public void paint(Graphics g) {
                    g.setBackgroundColor(Color.BLACK);
                    g.fillRect(0, 0, getWidth(), getHeight());
                    g.setColor(Color.WHITE);
                    g.clear();
                    super.paint(g);
                }

            });
        }

        if(e.TimeFrom.compareTo(e.TimeTo) == 0)
        {
            row.add(new LabelField(e.TimeFrom,
                    DrawStyle.ELLIPSIS | FOCUSABLE){

                public void paint(Graphics g) {
                    g.setBackgroundColor(Color.BLACK);
                    g.fillRect(0, 0, getWidth(), getHeight());
                    g.setColor(Color.WHITE);
                    g.clear();
                    super.paint(g);
                }

            });
        }
        else
        {
            row.add(new LabelField(e.TimeFrom + " - " + e.TimeTo,
                    DrawStyle.ELLIPSIS | FOCUSABLE){

                public void paint(Graphics g) {
                    g.setBackgroundColor(Color.BLACK);
                    g.fillRect(0, 0, getWidth(), getHeight());
                    g.setColor(Color.WHITE);
                    g.clear();
                    super.paint(g);
                }

            });
        }

        row.add(new LabelField(e.Address,
                DrawStyle.ELLIPSIS | FOCUSABLE){

            public void paint(Graphics g) {
                g.setBackgroundColor(Color.BLACK);
                g.fillRect(0, 0, getWidth(), getHeight());
                g.setColor(Color.WHITE);
                g.clear();
                super.paint(g);
            }

        });

        row.add(new LabelField("R " + e.EntranceFee,
                DrawStyle.ELLIPSIS | FOCUSABLE){

            public void paint(Graphics g) {
                g.setBackgroundColor(Color.BLACK);
                g.fillRect(0, 0, getWidth(), getHeight());
                g.setColor(Color.WHITE);
                g.clear();
                super.paint(g);
            }

        });

        rows.addElement(row);
    }
    setSize(rows.size());
}

public void drawListRow(ListField listField, Graphics graphics, int index,
        int y, int width) {
    // TODO Auto-generated method stub
    ImageListField list = (ImageListField) listField;
    TableRowManager rowManager = (TableRowManager) list.rows
            .elementAt(index);
    rowManager.drawRow(graphics, 0, y, width, 119);
}

public Object get(ListField listField, int index) {
    // TODO Auto-generated method stub
    return rows.elementAt(index).toString();
}

public int getPreferredWidth(ListField listField) {
    // TODO Auto-generated method stub
    return Graphics.getScreenWidth();
}

public int getRowHeight() {
    // TODO Auto-generated method stub
    return 119;
}

public int getRowHeight(int arg0) {
    // TODO Auto-generated method stub
    return 119;
}

public int indexOfList(ListField listField, String prefix, int start) {
    // TODO Auto-generated method stub
    return -1;
}

protected boolean trackwheelClick(int status, int time) {
    int index = getSelectedIndex();
    Dialog.inform(Integer.toString(index));
    return true;
}

private class TableRowManager extends Manager {
    public TableRowManager() {
        super(0);
    }

    // Causes the fields within this row manager to be layed out then
    // painted.
    public void drawRow(Graphics g, int x, int y, int width, int height) {
        // Arrange the cell fields within this row manager.
        layout(width, height);
        // Place this row manager within its enclosing list.
        setPosition(x, y);
        // Apply a translating/clipping transformation to the graphics
        // context so that this row paints in the right area.
        g.pushRegion(getExtent());
        // Paint this manager's controlled fields.
        subpaint(g);
        g.setColor(0xFF0000);
        g.drawLine(0, height - 1, getPreferredWidth(), height - 1);
        g.drawLine(40, 0, 40, getPreferredHeight());
        // Restore the graphics context.
        g.popContext();
    }

    // Arrages this manager's controlled fields from left to right within
    // the enclosing table's columns.
    protected void sublayout(int width, int height) {
        // set the size and position of each field.
        int fontHeight = Font.getDefault().getHeight();
        int preferredWidth = getPreferredWidth();
        // start with the Bitmap Field of the priority icon
        Field field = getField(0);
        layoutChild(field, 75, 75);
        setPositionChild(field, 5, 5);
        // set the task name label field
        field = getField(1);
        layoutChild(field, preferredWidth, fontHeight + 2);
        setPositionChild(field, 85, 5);
        // set the list name label field
        field = getField(2);
        layoutChild(field, preferredWidth, fontHeight + 2);
        setPositionChild(field, 85, fontHeight + 6 + 5);
        // set the due time name label field
        field = getField(3);
        layoutChild(field, preferredWidth, fontHeight + 2);
        setPositionChild(field, 100, fontHeight + fontHeight + 8 + 5);

        field = getField(4);
        layoutChild(field, preferredWidth, fontHeight + 2);
        setPositionChild(field, 100, fontHeight + fontHeight + fontHeight + 10 + 5);

        field = getField(5);
        layoutChild(field, preferredWidth, fontHeight + 2);
        setPositionChild(field, 100, fontHeight + fontHeight + fontHeight + fontHeight + 12 + 5);

        setExtent(preferredWidth, getPreferredHeight());
    }

    // The preferred width of a row is defined by the list renderer.
    public int getPreferredWidth() {
        return Graphics.getScreenWidth();
    }

    // The preferred height of a row is the "row height" as defined in the
    // enclosing list.
    public int getPreferredHeight() {
        return 119;// getRowHeight();
    }

} 
```

任何有关更改行高和位置的建议将不胜感激。

顺便说一句，这是在模拟器中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T21:47:28.807

尝试设置`setRowHeight(119);`而不是`setRowHeight(50);`. 不确定它是否有帮助，因为它不是`ListField`发布代码中的常用应用程序/用法。

# visual-studio-2010 - WCF 服务参考生成的代码无法编译

> ID：14880178
> 
> 赞同：0
> 
> 时间：2013-02-14T17:05:06.333
> 
> 标签：visual-studio-2010, wcf, code-generation

这是我在项目中添加服务引用时 Visual Studio 生成的代码。所有对“ReminderServiceClient.ServiceReference1.IReminderService”的引用都不起作用，因为它找不到“ServiceReference1”。但它定义在顶部的命名空间中？！为什么这个生成的代码不能编译？

```
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.296
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//----------------------------------------------------------------------------- 
```

-

```
namespace ReminderServiceClient.ServiceReference1 {

[System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "4.0.0.0")]
[System.ServiceModel.ServiceContractAttribute(ConfigurationName="ServiceReference1.IReminderService")]
public interface IReminderService {

    [System.ServiceModel.OperationContractAttribute(Action="http://tempuri.org/IReminderService/DoWork", ReplyAction="http://tempuri.org/IReminderService/DoWorkResponse")]
    void DoWork();
}

[System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "4.0.0.0")]
public interface IReminderServiceChannel : ReminderServiceClient.ServiceReference1.IReminderService, System.ServiceModel.IClientChannel {
}

[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "4.0.0.0")]
public partial class ReminderServiceClient : System.ServiceModel.ClientBase<ReminderServiceClient.ServiceReference1.IReminderService>, ReminderServiceClient.ServiceReference1.IReminderService {

    public ReminderServiceClient() {
    }

    public ReminderServiceClient(string endpointConfigurationName) : 
            base(endpointConfigurationName) {
    }

    public ReminderServiceClient(string endpointConfigurationName, string remoteAddress) : 
            base(endpointConfigurationName, remoteAddress) {
    }

    public ReminderServiceClient(string endpointConfigurationName, System.ServiceModel.EndpointAddress remoteAddress) : 
            base(endpointConfigurationName, remoteAddress) {
    }

    public ReminderServiceClient(System.ServiceModel.Channels.Binding binding, System.ServiceModel.EndpointAddress remoteAddress) : 
            base(binding, remoteAddress) {
    }

    public void DoWork() {
        base.Channel.DoWork();
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T18:43:11.960

看起来它没有编译，因为生成的服务客户端类与项目具有相同的名称，因此它被命名空间和具有相同名称的类混淆了。边缘案例！

# c# - 从 MVC 中的 .mhtml 导出带有打印布局的单词

> ID：14880179
> 
> 赞同：0
> 
> 时间：2013-02-14T17:05:06.570
> 
> 标签：c#, asp.net-mvc, ms-word, export

我正在导出一个带有从 .mhtml 文件转换的图像的 word 文档。我参考了下面的链接来导出这个词。

[http://www.revium.com.au/articles/sandbox/aspnet-mvc-convert-view-to-word-document/](http://www.revium.com.au/articles/sandbox/aspnet-mvc-convert-view-to-word-document/)

现在这个词正在被导出，但它在网络布局中。但我需要打印布局中的文档。

谁能帮我解决这个问题。

**已编辑**

我在以下链接的帮助下解决了这个问题

[http://forums.aspfree.com/asp-development-5/open-ms-word-documents-print-layout-view-57860.html](http://forums.aspfree.com/asp-development-5/open-ms-word-documents-print-layout-view-57860.html)

您可以随时对其进行逆向工程。用word打开你的文档。按照您想要的方式进行操作并将其保存为 html。使用文本编辑器打开并使用您需要的内容。

这就是我所做的。

```
<head>
<meta http-equiv=Content-Type content="text/html; charset=us-ascii">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<title></title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Print</w:View>
 </w:WordDocument>
</xml><![endif]-->
</head> 
```

我还添加了一些由我的话生成的额外代码，然后我才正确理解它。

希望这会帮助面临同样问题的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:13:08.990

将文件写入响应库，从流中获取字节并尝试。它应该强制下载文件

```
 HttpResponseBase.OutputStream(fileBytes,0,fileBytes.GetLength(0)); 
```

# android - 以编程方式获取连接到 adb 的 android 设备列表

> ID：14880182
> 
> 赞同：3
> 
> 时间：2013-02-14T17:05:11.123
> 
> 标签：android, adb

有没有办法以编程方式获取连接到 adb 的 android 设备列表？

我想在桌面应用程序上用 Java 来做。我有 adb.exe 的路径，但解析“adb devices”响应似乎不是最好的主意。

有没有更可靠的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T14:15:20.173

这就是我的做法

```
try {
        Process process = Runtime.getRuntime().exec("adb devices");
        BufferedReader in = new BufferedReader(new InputStreamReader(process.getInputStream()));  
        String line = null;  

        Pattern pattern = Pattern.compile("^([a-zA-Z0-9\\-]+)(\\s+)(device)");
        Matcher matcher;

        while ((line = in.readLine()) != null) {  
            if (line.matches(pattern.pattern())) {
                matcher = pattern.matcher(line);
                if (matcher.find())
                    System.out.println(matcher.group(1));
            }
        }  
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T18:07:12.803

最佳解决方案取决于您要对列表执行的操作。如果您要在您找到的设备上运行一些 adb 命令 - 解析`adb devices`输出是显而易见的选择。另一种选择是通过 USB 堆栈并收集具有 ADB 接口枚举的设备的序列号。或者我最喜欢的一个——在 Linux 下，我只是创建一个自定义 `udev`规则来跟踪所有连接的 ADB 设备。我正在使用数据库，但它可以像为每个 ADB 设备创建一个符号链接然后检查文件列表一样简单。

# c# - 如何在 WCF 数据服务中使用多线程/pfx 来加快速度？

> ID：14880185
> 
> 赞同：0
> 
> 时间：2013-02-14T17:05:23.977
> 
> 标签：c#, multithreading, .net-4.0, parallel-processing, wcf-data-services

场景：我一直在与托管 WCF 数据服务 3.0 的第三方公司合作，我们只能通过 API 访问他们的 Web 服务，不，我不能通过使用存储过程来加快速度，因为我没有具有 SQL 直接访问权限。

我玩过一点 PFX，尝试将它与 WCF 数据服务一起使用可能会大错特错。例如

```
 public List<EntityA> GetAEntitiesBy(int customerID) {
            var result = new List<EntityA>();
            int lastResultCount = 50;
            int callsMade = 0;

            while (lastResultCount == 50)
            {
            var results = MyApiWrapper.CreateODataContext().EntityA.Expand("Customer").Expand("EntityB").AsParallel()
        .Where(c => c.EntityA.CustomerID == customerID)
        .Where(c => c.EntityB.IsProperty1True && c.EntityB.Property2TypeID == 1)
        .Select(c => c)
        .Skip(callsMade * 50)
        .Take(50));

results.ForAll(c => nodes.Add(c));

            callsMade++;
            lastResultCount = results.Count;

            }

        return nodes;
} 
```

我知道每次执行 DataServiceQuery 时我最多只能提取 50 行，我的瓶颈是在此函数结果返回到我的网络表单后创建的，因为后来我做了一个`.ForEach`并且对于我得到的每一行我需要运行一些其他的查询其他服务 (WCF)

任何建议如何加快此操作？

另一方面，当我调试此方法时，我发现在并行查询执行期间调用 GetEnumerator 时出现错误消息“[无法评估子项”。](https://stackoverflow.com/questions/12456216/debugging-linq-children-could-not-be-evaluated)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:14:50.467

您当然可以通过并行发出多个查询来获得更好的整体吞吐量。您的客户必须为响应无序到达的可能性做好准备。Web 服务提供商可能会限制您允许进行的并行查询的数量。确保您理解并尊重这些限制。如果 Web 服务已经是次优的，根据其基础设施的大小，如果您同时发出太多请求，您可能会达到收益递减点。

另外的选择...

看起来您正在获取很多与客户相关的实体。您可能会考虑在第一次呈现网页时显示前 50 个，然后使用 Ajax 查询分批获取其余部分，例如 50 个。总吞吐量会比你先在服务器端获取它们，然后渲染页面要慢一些。但是，用户体验可能要好得多（具体取决于页面上发生的情况）。

# php - PHP中多维数组的高级排序

> ID：14880191
> 
> 赞同：0
> 
> 时间：2013-02-14T17:05:30.210
> 
> 标签：php, multidimensional-array

我在 Stack Overflow 上浏览了所有关于在 PHP 中对多维数组进行排序的答案，但没有一个直接回答我的问题。

从各种答案中，我了解到我应该使用 php`usort`函数或 php`array_multisort`函数，但我不确定如何将它们应用于我非常具体的数组结构：

这是我的变量`$array`：

```
Array
(
    [0] => Array
        (
            [field1] => 10
            [field2] => 100
            [field3] => 100
            [subarray] => Array
                (
                    [0] => Array
                        (
                            [field1] => 10
                            [field2] => 100
                            [field3] => 100
                        )

                    [1] => Array
                        (
                            [field1] => 10
                            [field2] => 100
                            [field3] => abcORDERBYTHIS
                        )

                )

        )

    [1] => Array
        (
            [field1] => 10
            [field2] => 100
            [field3] => 100
            [subarray] => Array
                (
                    [0] => Array
                        (
                            [field1] => 10
                            [field2] => 100
                            [field3] => 100
                        )

                    [1] => Array
                        (
                            [field1] => 10
                            [field2] => 100
                            [field3] => ghiORDERBYTHIS
                        )

                )

        )

    [2] => Array
        (
            [field1] => 10
            [field2] => 100
            [field3] => 100
            [subarray] => Array
                (
                    [0] => Array
                        (
                            [field1] => 10
                            [field2] => 100
                            [field3] => 100
                        )

                    [1] => Array
                        (
                            [field1] => 10
                            [field2] => 100
                            [field3] => defORDERBYTHIS
                        )

                )

        )

) 
```

我**希望**能够`field3`按. 使用 php函数访问这个元素很容易，如下所示：**`subarray``end`**

 **```
<?php
foreach($array as $array_single){
    foreach(end($array_single['subarray']) as $sub_array){
        echo $sub_array;
    }
}
?> 
```

从现在开始，我被困在如何按字母顺序专门对这个多维数组进行排序，以便我们得到以下结果：

*   `$array[0]`- 保持领先，因为`field3`价值是`abcORDERBYTHIS`
*   `$array[2]`- 跳到中间，因为`field3`值是`defORDERBYTHIS`
*   `$array[1]`- 现在位于底部，因为`field3`值为`ghiORDERBYTHIS`

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:16:31.193

试试这个代码：

```
$array = Array();

$arraytemp['field1'] = 10;
$arraytemp['field2'] = 100;
$arraytemp['field3'] = 100;
$arraytemp['subarray'][0]["field1"] = 10;
$arraytemp['subarray'][0]["field2"] = 100;
$arraytemp['subarray'][0]["field3"] = 100;
$arraytemp['subarray'][1]["field1"] = 10;
$arraytemp['subarray'][1]["field2"] = 100;
$arraytemp['subarray'][1]["field3"] = "abcORDERBYTHIS";

$array[] = $arraytemp;

$arraytemp['field1'] = 10;
$arraytemp['field2'] = 100;
$arraytemp['field3'] = 100;
$arraytemp['subarray'][0]["field1"] = 10;
$arraytemp['subarray'][0]["field2"] = 100;
$arraytemp['subarray'][0]["field3"] = 100;
$arraytemp['subarray'][1]["field1"] = 10;
$arraytemp['subarray'][1]["field2"] = 100;
$arraytemp['subarray'][1]["field3"] = "ghiORDERBYTHIS";

$array[] = $arraytemp;

$arraytemp['field1'] = 10;
$arraytemp['field2'] = 100;
$arraytemp['field3'] = 100;
$arraytemp['subarray'][0]["field1"] = 10;
$arraytemp['subarray'][0]["field2"] = 100;
$arraytemp['subarray'][0]["field3"] = 100;
$arraytemp['subarray'][1]["field1"] = 10;
$arraytemp['subarray'][1]["field2"] = 100;
$arraytemp['subarray'][1]["field3"] = "defORDERBYTHIS";

$array[] = $arraytemp;

// Sort the multidimensional array
usort($array, "custom_sort");

// Define the custom sort function used in usort
function custom_sort($a,$b) {
    return strcmp($a['subarray'][1]["field3"], $b['subarray'][1]["field3"]);
} 
```**

# python - 迭代元组列表

> ID：14880192
> 
> 赞同：15
> 
> 时间：2013-02-14T17:05:31.443
> 
> 标签：python, list, iteration, tuples

我正在寻找一种干净的方法来迭代一个元组列表，其中每个元组都是这样的一对`[(a, b), (c,d) ...]`。最重要的是，我想更改列表中的元组。

标准做法是避免在迭代列表的同时更改列表，那么我该怎么办？这就是我想要的：

```
for i in range(len(tuple_list)):
  a, b = tuple_list[i]
  # update b's data
  # update tuple_list[i] to be (a, newB) 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-02-14T17:09:59.420

只需替换列表中的元组；只要避免添加或删除元素，就可以在循环列表时更改它*：*

```
for i, (a, b) in enumerate(tuple_list):
    new_b = some_process(b)
    tuple_list[i] = (a, new_b) 
```

`b`或者，如果您可以像我上面所做的那样将更改汇总到一个函数中，请使用列表推导：

```
tuple_list = [(a, some_process(b)) for (a, b) in tuple_list] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T17:09:56.820

你为什么不去列表理解而不是改变它？

```
new_list = [(a,new_b) for a,b in tuple_list] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T17:10:08.177

这里有一些想法：

```
def f1(element):
    return element

def f2(a_tuple):
    return tuple(a_tuple[0],a_tuple[1])

newlist= []
for i in existing_list_of_tuples :
    newlist.append( tuple( f1(i[0]) , f(i1[1]))

newlist = [ f2(i) for i in existing_list_of_tuples ] 
```

# php - 查找具有特定值的数组项，将其删除并重新索引数组

> ID：14880198
> 
> 赞同：0
> 
> 时间：2013-02-14T17:05:47.267
> 
> 标签：php, arrays, indexing

我想出了一个解决方案（我将在下面发布），但我想知道是否有更好、更紧凑的方法？

```
function removeImage($id) {
    $index;

    for ($i = 0; $i <= count($this->_images); $i++) {
        if ($this->images[$i] == $id) {
            $index = $i;
            break;
        }

        if ($i == count($this->_images)) {
            throw new Exception("No image with this ID found.");
        }
    }

    unset($this->_images[$index]);
    $this->_images = array_values($this->_images);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:14:34.927

> 查找具有特定值的数组项

[`array_search()`](http://php.net/array_search)

您更新的代码：

```
$index = array_search($id, $this->_images);
if ($index !== false) {
  unset($this->_images[$index]);
  $this->_images = array_values($this->_images);
} 
```

**注意：**除非顺序索引很重要，否则如果您重构代码以使用`foreach`.

# system - 使用 LAPACK 的 DGBSV 从 C 中求解带状系统

> ID：14880205
> 
> 赞同：4
> 
> 时间：2013-02-14T17:06:20.253
> 
> 标签：system, lapack, scalapack

我试图搜索与该主题相关的类似线程，但似乎没有人关心带状系统（...）。

我有兴趣使用 C 代码中的 LAPACK/ScaLAPACK 求解带状矩阵。首先，在尝试使用 ScaLAPACK 之前，我想使用 LAPACK 实现顺序解决方案。

问题：两种语言之间的行主要/列主要差异似乎正在影响我的解决方案过程。这是我打算解决的系统：

![线性系统](../Images/351aab8b808773ef81f6658baeef9755.png)

以下代码将该矩阵转换为 LAPACK 的带状数据结构，在[此处](http://www.netlib.org/lapack/lug/node124.html)指定。

```
 int rr = 6;     // Rank.
  int kl = 2;     // Number of lower diagonals.
  int ku = 1;     // Number of upper diagonals.
  int nrhs = 1;   // Number of RHS.
  double vals[36] = {0.0,   0.0,   0.0,   0.0,   0.0,   0.0,  // Req. ex. space.
                     0.0,   0.0,   0.0,   0.0,   0.0,   0.0,  // Req. ex. space.
                   666.0,   0.0,   0.0,   0.0,   0.0,  22.5,  // First up diag.
                     1.0, -50.0, -50.0, -50.0, -50.0,  -2.6,  // Main diagonal.
                    27.5,  27.5,  27.5,  27.5,   4.0, 666.0,  // First low diag.
                     0.0,   0.0,   0.0,  -1.0, 666.0, 666.0}; // 2nd low diag.

  int lda = rr;   // Leading dimension of the matrix.
  int ipiv[6];    // Information on pivoting array.
  double rhs[] = {1.0, 1.0, 1.0, 1.0, 1.0, 0.0};  // RHS.
  int ldb = lda;  // Leading dimension of the RHS.
  int info = 0;   // Evaluation variable for solution process.
  int ii;         // Iterator.
  int jj;         // Iterator.

  dgbsv_(&rr, &kl, &ku, &nrhs, vals, &lda, ipiv, rhs, &ldb, &info);

  printf("info = %d\n", info);
  for (ii = 0; ii < ldb; ii++) {
    printf("%f\n", rhs[ii]);
  }
  putchar('\n'); 
```

正如我所说，我担心我转换矩阵的方式是不正确的，因为我的解决方案产生了：

```
[ejspeiro@node01 lapack-ex02]$ make runs
`pwd`/blogs < blogs.in
info = 1
1.000000
1.000000
1.000000
1.000000
1.000000
0.000000 
```

Fortran 的返回值`info = 1`意味着分解已完成，但`U(1,1) = 0`在 的 LU 分解中`A = LU`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-26T22:01:03.317

正如您所注意到的，您的矩阵是以行优先格式输入的。将它写在主要列中，我们在视觉上看到的行将对应于列：

```
 double vals[36] = {0.0,   0.0,   0.0,   1.0,  27.5,   0.0,
                     0.0,   0.0,   0.0, -50.0,  27.5,   0.0,
                     0.0,   0.0,  22.5, -50.0,  27.5,   0.0,
                     0.0,   0.0,  22.5, -50.0,  27.5,  -1.0,
                     0.0,   0.0,  22.5, -50.0,   4.0,  0.0,
                     0.0,   0.0,  22.5,  -2.6,   0.0,  0.0}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T17:02:39.593

好吧，我会回答这个问题，以便称其为“已解决”。

这些文件代表功能代码。如果有人遇到同样的问题，我将提供此功能：**使用 C 中的 LAPACK 求解带状方程组**。

1.  [https://dl.dropbox.com/u/5432016/banded/cmtk.h](https://dl.dropbox.com/u/5432016/banded/cmtk.h)
2.  [https://dl.dropbox.com/u/5432016/banded/blogs.c](https://dl.dropbox.com/u/5432016/banded/blogs.c)

如果有人对实施有任何额外的建议，我将很高兴欢迎他们！

我的下一步是分发核心矩阵，以便用 ScaLAPACK 解决。

谢谢！

# python - 将 Python 分析脚本部署到服务器

> ID：14880209
> 
> 赞同：0
> 
> 时间：2013-02-14T17:06:33.130
> 
> 标签：python, scripting

我是奥斯汀一家小型初创公司的数据专家。我所做的所有分析（到目前为止）都存储为一组我在笔记本电脑上运行的临时脚本。这是一个坏主意。

我将在这里草拟我的计划以部署我的分析，并且我想知道是否有任何我遗漏的明显漏洞，或者我应该考虑的其他任何事情。我认为我的大纲保持了足够的原子性，以便我可以在需要的时间和地点插入东西，而且还允许我很容易地运行一个脚本。次要（长期）目标是建立一个简单的 Web 前端，允许用户（即我公司的员工）一次调用一个脚本，请参见此处：[非常简单的 Web 服务：接受输入，电子邮件结果](https://stackoverflow.com/questions/14836120/very-simple-web-service-take-inputs-email-results)。

我想将脚本部署到服务器，并且正在考虑将我的脚本组织成一组 python 模块。然后，我希望我的批处理脚本看起来像：

```
import analysis

batch_dict = analysis.build_batch_dict()
assert sorted(batch_dict.keys()) = ['Hourly', 'Monthly', 'Nightly', 'Weekly']

scripts_to_run = analysis.what_batch() # get from command line?
results_directory = analysis.make_results_directory()
failures = {}
for script in scripts_to_run:
    try:
        script.analyze()
        script.export_results(results_directory)
    except Exception as e:
        failures.update(script.failed(e))

analysis.completed(failures) 
```

我将重写我的分析，以便它们由一个类处理。

```
class AnalysisHandler(object):
    ...
    def analyze():
        pass
    def export_results(some_directory):
        pass
    def failed(exception):
        pass
    def run_with_non_default_args(*args, **kwargs):
        pass
    def something_else_im_missing_now():
        pass 
```

所有脚本都将由继承自 AnalysisHandler 的东西处理。

服务器上的目录结构如下所示：

```
datalytics/
    results/
        02-14-2013/
            script1/
                /log
                /error
                /data
            script2/
                /log
                /error
                /data
            .
            .
            .
            <etc>
    scripts/
        script1/
            bin/
            data/
            doc/
            script_1/
            tests/
            setup.py
        .
        .
        .
    analysis/
        __init__.py
        analysis.py
    batch.py (see above)
    new_script.py
    run_all_tests.py
    run_some_tests.py
    run_this_script.py
    run_everything.py 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:46:41.180

作为正式答案：

*   在创建文件时注意并尝试捕获异常（您可能会遇到权限问题），尤其是当您添加前端并希望可能写入员工无法修改的目录时

*   使用您当前的设置，我建议将循环包装在“with”语句中，保持打开的文件句柄，并在结果进入时刷新结果。这使您可以在一定程度上跟踪进度，并让您知道如果您的服务器崩溃，您的测试是否正在运行，以及是否其中一个导致崩溃

*   您似乎正在开发相当多的框架。虽然 unittest 模块旨在测试 python 代码，但它当然可以用来替换很多框架（即排序测试、指定要运行的测试、日志记录等）。它还将为您提供一种简单的方法来附加接口，然后为预期的故障等标记测试。

*   与输出一样重要，使其有用也很重要。您可能希望它以干净的文本打印，但如果它以 Python 字典开头，并且您将其展平，请在日志文件中添加一个逗号，然后将 dict 转储为字符串，以便您可以将那个东西直接舀回 Python并在需要时操纵数据。

*   离开最后一点，看看 json.dumps 和 json.loads，尤其是在使用日志和 Web UI 时。javascript 对这种格式很友好，您可以通过将所有内容保持为“python-happy”格式来节省大量工作

*   如果需要，线程化测试并不难添加。如果你知道你有一项任务需要很长时间才能运行，或者是 IO 密集型的，也许可以让它自己分拆。如果您确实认为您将走这条路，请从一开始就计划好并注意您可能需要保护的变量，或者将所有结果推送到队列而不是字典中以防止竞争条件问题

*   请注意时间戳的分辨率，尤其是如果您正在加载使用时间戳作为键的字典 o_O ---> 只是不要这样做

*   I noticed the config function and that it accepted args and kwargs. If you are going to allow configuring of tests, either via ui or file, especially if it's a file, use json friendly format, you can do kwargs = json.loads( open(configfile,'r').read() ) and be super happy that you didn't have to write a parser or regex, or modify your code when you add a parameter.

# clojure - clojure 和 clojurescript 之间的区别？

> ID：14880212
> 
> 赞同：12
> 
> 时间：2013-02-14T17:06:36.830
> 
> 标签：clojure, clojurescript

谁能列出 Clojure 和 ClojureScript 之间的一些区别？（请，谢谢） 语法上的差异？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-06-06T23:29:43.407

Clojure 和 ClojureScript 之间的全部区别在[ClojureScript 网站上详细列出。](https://clojurescript.org/about/differences)

根据该页面，主要区别在于：

*   并发编程
*   托管环境（JVM 与 JS VM 或 Google 的 Clojure 编译器）
*   数字
*   人物
*   read 和 read-string 方法在不同的地方定义
*   加载和加载文件*尚未*实现
*   ClojureScript 中没有 eval
*   一些特殊形式没有实现

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T20:18:30.513

它们是不同的语言，具有共同的语法，托管在不同的环境中。

# mongodb - 在字符串中的 MongoDB 中搜索

> ID：14880213
> 
> 赞同：0
> 
> 时间：2013-02-14T17:06:37.873
> 
> 标签：mongodb

我是 MongoDB 世界的新手，有一些基本问题。我想知道是否可以在 MongoDB 中搜索字符串。例如这里有一条记录：

> db.test.insert({ s_id:0, c_id:1, json:"{result:[104192,42068],id:1}" })

当我在 s_id 上进行查找时，它工作正常：

> db.test.findOne({s_id:0}) { "_id" : ObjectId("511d1675d3c6fdeb779c8ea8"), "s_id" : 0, "c_id" : 1, "json" : "{result:[104192,42068],编号：1}" }

但是，如果我在 json 上进行查找：“结果”它不起作用

> db.test.findOne({json : "result"}) null

同时我确实确保了 json 上的索引

> db.test.ensureIndex({json:1})

是否可以在其中对此类字符串进行搜索，或者我们是否需要在此之上创建 SOLR 或 Elastic Search？

任何指针都非常感谢

谢谢马斯蒂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:41:27.013

因此，您的 json 键的值是序列化的 json。如果您正在搜索具有包含单词“结果”的 json 值的文档，则可以使用 $regex 运算符。您没有说明您拥有多少条记录或您期望的性能，因此 Solr / Lucene 可能是矫枉过正。您还可以查看最新 MongoDB 版本中的新自由文本搜索功能。

尝试：

```
db.test.find({json:/result:/i}); 
```

在我的机器上：

```
> db.test.insert({ s_id:0, c_id:1, json:"{result:[104192,42068],id:1}" })
> db.test.find({json:/result:/i});
{ "_id" : ObjectId("511d21fe0ff85d1b95a5f8b1"), "s_id" : 0, "c_id" : 1, "json" : "{result:[104192,42068],id:1}" } 
```

顺便说一句，来自 MongoDB 手册：

“$regex 只有在正则表达式在字符串的开头（即 ^）有一个锚点并且是区分大小写的匹配时才能有效地使用索引”

所以你实际上可能想要

```
> db.test.ensureIndex({json:1})
> db.test.find({json:{ $regex:'^{result:'}}).explain();
{
    "cursor" : "BtreeCursor json_1 multi",
    "isMultiKey" : false,
    "n" : 1,
    "nscannedObjects" : 1,
    "nscanned" : 1,
    "nscannedObjectsAllPlans" : 1,
    "nscannedAllPlans" : 1,
    "scanAndOrder" : false,
    "indexOnly" : false,
    "nYields" : 0,
    "nChunkSkips" : 0,
    "millis" : 0,
    "indexBounds" : {
        "json" : [
            [
                "",
                {

                }
            ],
            [
                /^{result:/,
                /^{result:/
            ]
        ]
    },
    "server" : "Micks-MacBook-Pro-3.local:27017"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:23:23.783

此链接很好地涵盖了 Mongo 中的读取操作基础知识：http: [//docs.mongodb.org/manual/applications/read/](http://docs.mongodb.org/manual/applications/read/)

编辑：不建议在大型数据库中使用更复杂的查询在 Mongo 中进行搜索。如果您经常想要这样做，请考虑使用 solr 之类的索引。Mongo 最好使用 id 进行搜索。

# javascript - JS 验证表单的值

> ID：14880216
> 
> 赞同：0
> 
> 时间：2013-02-14T17:06:54.353
> 
> 标签：javascript, html, forms, validation

我正在尝试创建一个 html + JS 表单.. 我设法让它按我的意愿工作.. 但我想在其中添加一个字段，我不知道该怎么做.. 我不擅长 js，所以需要帮助.

我想做的是..当用户填写表格时..其中一个字段应该在提交之前验证促销代码。

```
 <script type="text/javascript">
    function get(y){
        return document.getElementById(y).value;
    }
    function getResponse(){
        $.get("process.php", { name: get('name'), email: get('email'), postcode: get('postcode'), phone: get('phone'), postcode: get('fbcode') },
           function(data){
             if(data.status === false || data.status === 'false'){
                 return errorMsg(data.message);
             }else{
                errorMsg(data.message);
                setTimeout(" offerDownloadAndClose()", 4000); 
             }
           }, "json");
    }
    function errorMsg(msg){
        $('#status').html(msg);
        $('#status').slideDown('slow');
        setTimeout("doHide('#status')", 3000);
    }
    function doHide(t){
        $(t).slideUp('slow');   
    }
    function offerDownloadAndClose(){
        doHide('#fancybox-wrap, #fancybox-overlay');
        window.location = 'process.php?file=true';
    }
    function validnum(evt){
        var charCode;
        charCode = (evt.which) ? evt.which : event.keyCode;
        if ((charCode >= 48 && charCode <= 57) || charCode == 46 || charCode == 127 || charCode == 8)
        {
            return true;
        }
        else{
            return false;
        }
    }

</script> 
```

我需要添加一个带有 facebook 促销代码的字段.. 所以说我们的代码是 FaceCode1，当用户填写表格时.. 它使用这个值验证字段.. 如果代码是 FaceCode1，它将处理否则会给出错误填充出来。

所以它应该是这样的

```
function validcode{
if value=FaceCode1 
{return true;
}
else{
return false;
}
} 
```

但我不知道如何为要检查的特定代码创建价值..如果有人可以帮助我，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:30:26.480

这是你想要做的吗？ [http://jsfiddle.net/davidchase03/QXGPD/](http://jsfiddle.net/davidchase03/QXGPD/)

```
function validate() {
    var value = $('.promo').val();
    if (value === 'FaceCode1') {
        alert('all good')
    } else {
        alert('wrong')
    }
}

$('button').click(function(){
    validate();
}); 
```

让我知道-大卫

# gwt - GWT DataGrid 好的教程？

> ID：14880221
> 
> 赞同：1
> 
> 时间：2013-02-14T17:07:02.537
> 
> 标签：gwt, datagrid

谁能指出我好的 GWT DataGrid 教程？

现有的示例代码以完整的形式呈现，我想要一些在使用 DataGrid 的步骤中逐步完成的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T18:37:37.967

尽管这不是一个教程，但我发现了解 DataGrid 如何工作的最佳方法是通过[这个示例](http://gwt.googleusercontent.com/samples/Showcase/Showcase.html#!CwDataGrid)并自己并行构建一个。理解这一切可能需要一段时间，但值得一试。所有重要的步骤都在那里。

# localization - 如何合并两个 .po 文件？

> ID：14880223
> 
> 赞同：6
> 
> 时间：2013-02-14T17:07:13.283
> 
> 标签：localization, internationalization, po, xgettext

我有 2 个问题来合并 2 个 .po 文件。

1.  我有 1 个 .po 文件 (trans.po) 用于我的应用程序本地化，还有一个 ( `transNew.po`) 我最近制作。我需要合并它们。但是当我运行以下命令时，我总是会得到与 相同的内容`transNew.pot`，根本没有旧的翻译。

    msgmerge --previous trans.po transNew.pot -o transfinal.po

2.  我之前使用 textedit 手动添加了一些翻译字符串`trans.po`，我不想丢失它们，即使上面的命令可以成功，我也会丢失这些字符串。我找不到任何选项可以解决它。

# javascript - 如何替换两个索引之间的子字符串

> ID：14880229
> 
> 赞同：47
> 
> 时间：2013-02-14T17:07:29.937
> 
> 标签：javascript, jquery

我想替换 Javascript 中两个索引之间的文本，例如：

```
str = "The Hello World Code!";
str.replaceBetween(4,9,"Hi");
// outputs "The Hi World Code" 
```

索引和字符串都是动态的。

我怎么能这样做呢？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2013-02-14T17:09:32.527

JavaScript 中没有这样的方法。但是您始终可以创建自己的：

```
String.prototype.replaceBetween = function(start, end, what) {
  return this.substring(0, start) + what + this.substring(end);
};

console.log("The Hello World Code!".replaceBetween(4, 9, "Hi"));
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2019-09-19T06:52:53.673

接受的答案是正确的，但我想避免扩展 String `prototype`：

```
function replaceBetween(origin, startIndex, endIndex, insertion) {
  return origin.substring(0, startIndex) + insertion + origin.substring(endIndex);
} 
```

用法：

```
replaceBetween('Hi World', 3, 7, 'People');

// Hi People 
```

如果使用简洁的箭头函数，那么它是：

```
const replaceBetween = (origin, startIndex, endIndex, insertion) =>
  origin.substring(0, startIndex) + insertion + origin.substring(endIndex); 
```

如果使用模板文字，那么它是：

```
const replaceBetween = (origin, startIndex, endIndex, insertion) =>
  `${origin.substring(0, startIndex)}${insertion}${origin.substring(endIndex)}`; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-14T17:18:15.320

JavaScript 中有一个[`Array.splice`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/splice)方法可以完成这项工作，但没有`String.splice`. 但是，如果将字符串转换为数组：

```
var str = "The Hello World Code!";
var arr = str.split('');
var removed = arr.splice(4,5,"Hi"); // arr is modified
str = arr.join(''); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-11-03T12:12:56.363

这就是它对我有用的方式。

```
var str = "The Hello World Code!";
var newStr="Hi"

var startIndex= 4;  // start index of 'H' from 'Hello'
var endIndex= 8; // end index of 'o' from 'Hello'
var preStr = str.substring(0, startIndex);
var postStr = str.substring(endIndex+1, str.length - 1);
var result = preStr+newStr+postStr;);     // outputs "The Hi World Code" 
```

小提琴：http: [//jsfiddle.net/ujvus6po/1/](http://jsfiddle.net/ujvus6po/1/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-23T16:35:36.680

当您需要使用完全相同的函数调用完全替换特定索引处的字符串时，另一种方法`String.prototype.replace`可能是：

```
String.prototype.replaceAt = function(index, fromString, toString) {
    let hasWrongParams = typeof index !== 'number'
                || !fromString || typeof fromString !== 'string'
                || !toString || typeof toString !== 'string';
    if(hasWrongParams) return '';
    let fromIndex = index;
    let toIndex = index + fromString.length;
    return this.substr(0, fromIndex) + toString + this.substr(toIndex);
} 
```

[https://gist.github.com/kwnccc/9df8554474e39f4b17a07efbbdf7971c](https://gist.github.com/kwnccc/9df8554474e39f4b17a07efbbdf7971c)

例如：

```
let string = 'This is amazing world, it's still amazing!';
string.replaceAt(8, 'amazing', 'worderful');
// 'This is worderful world, it's still amazing!'
string.replaceAt(34, 'amazing', 'worderful');
// 'This is amazing world, it's still worderful!' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-20T13:37:24.900

[VisioN](https://stackoverflow.com/a/14880260/6798201)解决方案的更强大版本，可检测超出范围的错误并抛出有意义且易于调试`RangeError`的错误。如果你愿意，你也可以扩展`String.prototype`。

```
function replaceString(str, start, end, replace) {
  if (start < 0 || start > str.length) {
    throw new RangeError(`start index ${start} is out of the range 0~${str.length}`);
  }
  if (end > str.length || end < start) {
    throw new RangeError(`end index ${end} is out of the range ${start}~${str.length}`);
  }
  return str.substring(0, start) + replace + str.substring(end);
}

// replace in the middle of the string, replacement string can be any length
console.log(replaceString("abcdef", 2, 4, "hhhh")); // output: "abhhhhef"

// insert in the front of the string, start and end index equal to 0
console.log(replaceString("abcdef", 0, 0, "hhhh")); // output: "hhhhabcdef"

// append at the end of the string, start and end index equal to the length of the string
console.log(replaceString("abcdef", 6, 6, "hhhh")); // output: "abcdefhhhh"

// error 1: start index is greater than end index
// console.log(replaceString("abcdef", 4, 2, "hhhh")); // output: RangeError: end index 2 is out of the range 4~6

// error 2: start/end index is less than 0
// console.log(replaceString("abcdef", -2, 2, "hhhh")); // output: RangeError: start index -2 is out of the range 0~6

// error 3: start/end index is greater than length of the string
// console.log(replaceString("abcdef", 3, 20, "hhhh")); // output: RangeError: end index 20 is out of the range 3~6
```

# c - 如何在“speech-dispatcher”中使用索引标记？

> ID：14880234
> 
> 赞同：1
> 
> 时间：2013-02-14T17:07:43.207
> 
> 标签：c, text-to-speech

所以，类似主题的问题：“如何在语音调度程序中使用索引标记？” 我听到很多关于它的消息，但找不到任何关于如何在 SPD_MODE_THREADED 中使用它的教程。主要问题是当您发送“SPEAK”命令时，您无法将数据模式更改为 SPD_DATA_SSML。而且我认为我做错了什么。所以，谁知道如何使用这个索引标记，教程也很容易接受。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T14:11:00.887

**已解决**，这是在语音调度程序中设置索引标记的方法：

```
pthread_mutex_lock( m_connection->ssip_mutex );

spd_execute_command_wo_mutex( m_connection, "SET SELF SSML_MODE on" );

spd_execute_command_wo_mutex( m_connection, "SPEAK" );

char * reply = spd_send_data_wo_mutex( m_connection, "<speak>Hello, <mark name=\"mark1\"/> how does it work?</speak>", SPD_NO_REPLY );
delete[] reply;

spd_execute_command_wo_mutex( m_connection, "\r\n." );

spd_execute_command_wo_mutex( m_connection, "SET SELF SSML_MODE off" );

pthread_mutex_unlock( m_connection->ssip_mutex ); 
```

`<mark name=\"mark1\"/>`索引标记在哪里。并且`mark1`是索引标记名称。

该文档对于低级语音调度程序通信非常有用： http: [//cvs.freebsoft.org/doc/speechd/ssip.html#Top](http://cvs.freebsoft.org/doc/speechd/ssip.html#Top)

# batch-file - windows批处理将字节转换为GB

> ID：14880236
> 
> 赞同：1
> 
> 时间：2013-02-14T17:07:54.397
> 
> 标签：batch-file, size

如何将结果从字节转换为千兆字节？有关示例，请参见此脚本：

```
@echo off

set file=C:\Users\%username%\AppData\Local\Microsoft\Outlook\%username%.ost

%1 %0 :: %file%
set len=%~z2

echo %len%  %username% >>"C:\Desktop\size.txt" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T05:04:00.943

你可以使用这个方法：

```
set len=%~z2
set /A GB=%len:~0,-3%/1024/1024 
```

这相当于这个公式：GigaBytes = Bytes / 1000 / 1024 / 1024。数值结果实际上与原始公式相同，但此方法允许正确转换超过 2000 GB 的文件大小。

如果要获得两位小数的结果，请使用以下方法：

```
set len=%~z2
set /A GBtimes100=%len:~0,-3%/1024*100/1024
echo %GBtimes100:~0,-2%.%GBtimes100:~-2%  %username% >>"C:\Desktop\size.txt" 
```

安东尼奥

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T20:05:41.077

正如迈克尔在他的回答中所说，批处理可以通过`SET /A`. 但是计算严格限于整数；没有本机浮点数学。并且整数在内部表示为带符号的 32 位整数。所以最大可能的字节数等于~2 GB。已经编写了一些批处理例程来处理大量数字，但我不建议使用它们。

将字节转换为千兆字节的公式很简单：

```
Gigabytes = Bytes / 1024 / 1024 / 1024 
```

在紧要关头，您可以编写混合脚本并让批处理调用 powershell 来计算。

```
for /f %%N in ('powershell %~z2/1024/1024/1024') do set len=%%N 
```

但这是极其缓慢和低效的。您最好用支持浮点的脚本语言（可能是 PowerShell、VBScript 或 JScript）简单地编写整个脚本。

# bash - 为什么我从这个 bash 脚本中得到“缺少`]'”来列出文件？

> ID：14880244
> 
> 赞同：3
> 
> 时间：2013-02-14T17:08:23.683
> 
> 标签：bash

我有以下代码

```
#!/bin/bash
 if [   "-f /data/sb3???sh25t.sqfs" && "! -f /data/sb3??????sh25t.sqfs"  && "! -f /data/sb3????????sh25t.sqfs" && "! -f /data/sb3???????sh25t.sqfs" ]  ;then
      select build in `ls -D /data/tftpboot/sb3???sh25t.sqfs` ; do
         break
      done
    build=${build:15}
 fi 
```

当我运行这个脚本时，它给了我一个错误：

> 缺少`]'

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T20:17:48.790

好吧，给自己拿[一罐 Jolt Cola](https://en.wikipedia.org/wiki/Jolt_Cola)，然后坐下。这将需要一段时间...

Unix shell 中的`if`语句接受一个命令（任何命令），处理该命令，如果该命令返回的退出代码为零，则将执行**if语句的***then*子句。如果该命令返回一个非零值，它将执行*else*子句（如果存在）。

 ***例如：

```
if ls foo 2>&1 > /dev/null
then
   echo "File 'foo' exists"
else
   echo "No Foo For you!"
fi 
```

以上将运行`ls foo`命令。输出将通过 删除`2>&1 > /dev/null`，因此如果存在，您将看不到列表，如果不`foo`存在，您将不会收到错误消息`foo`。但是，如果存在，该`ls`命令仍将返回，`0`如果不`foo`存在，则返回 a `1`。

这使您可以做各种整洁的事情：

```
if mv foo foo.backup
then
    echo "Renamed `foo` directory to `foo.backup`"
else
    echo "BIG HORKING ERROR: Can't rename 'foo' to 'foo.backup'"
    exit 2  #I need to stop my program. This is a big problem.
fi 
```

在上面的代码中，我尝试在放入新目录之前将目录重命名`foo`为。也许目录不存在，所以命令失败。也许我没有重命名目录的权限。不管它是什么，该语句允许我测试我的命令是否成功。`foo.backup``foo``foo``mv``if``mv`

这就是`if`命令所做的一切：它执行一个命令，根据返回值是否为零，它可能会或可能不会执行*then*子句。

* * *

但是，如果我想*测试*一个特定的条件是否存在呢？例如：

*   有目录叫`foo`吗？
*   我的环境变量的值是否`$value`大于 3？

如果有某种命令可以让我测试这些东西，那不是很好吗？嘿，如果我的测试为真则该命令返回零值，如果我的测试为假则返回非零值，我可以将其合并到`if`语句中！

幸运的是，Unix 中有一个名为*test*的命令可以做到这一点：

```
if test -d foo
then
    echo "Directory foo exists"
fi

if test $value -gt 3
then
    echo "\$value is bigger than 3"
fi 
```

也恰好 Unix 命令`test`有一个指向该命令的*硬链接*`[`：

```
$ cd /bin
$ ls -li test [
54008404 -rwxr-xr-x  2 root  wheel  18576 Jul 25  2012 [
54008404 -rwxr-xr-x  2 root  wheel  18576 Jul 25  2012 test 
```

第一列是[inode](https://en.wikipedia.org/wiki/Inode)编号。由于两者都是相同的 inode 编号，因此该`[`命令只是该命令的硬链接`test`。

现在，事情变得更容易理解了。1实际上是一个 Unix 命令`[`^！这就是为什么我需要在方括号和我正在测试的东西之间留一个空格：

```
# Invalid Syntax: I need spaces between the test and the braces:
if [$value -gt 3]

# Valid Syntax
if [ $value -gt 3 ]

# Actually the same command as above
if test value -gt 3 
```

它还更清楚地说明了为什么它是`-gt`and`-f`带有前导破折号而不是简单地`gt`or `f`。那是因为`-gt`和`-f`是 test 命令的参数！

* * *

现在您对内置 shell 的`if`工作原理以及`[`它实际上是一个 Unix 命令的方式有了更清晰的了解，我们可以查看您的*if 语句*，看看问题出在哪里：

```
if [ "-f "/data/sb3???sh25t.sqfs" && "! -f /data/sb3??????sh25t.sqfs"  && \
   "! -f /data/sb3????????sh25t.sqfs" && "! -f /data/sb3???????sh25t.sqfs" ] 
```

首先，你有：

```
"-f /data/sb3???sh25t.sqfs" 
```

引号使整个字符串成为*测试*命令的一个参数，这不是您想要的。您希望`-f`参数与您正在测试的文件分开。因此，您需要`-f`从引号中删除 ，因此*test*命令将其视为参数：

```
if [ -f "/data/sb3???sh25t.sqfs" && ! -f "/data/sb3??????sh25t.sqfs"  && \
   ! -f "/data/sb3????????sh25t.sqfs" && ! -f "/data/sb3???????sh25t.sqfs" ] 
```

这仍然行不通。查看`test`命令的（手册页）[http://www.manpagez.com/man/1/test/]。请注意，这`&&`不是`test`命令的有效参数。相反，您应该使用`-a`组合两个表达式_您的测试：

```
if [   -f "/data/sb3???sh25t.sqfs"      -a ! -f "/data/sb3??????sh25t.sqfs"  -a \
     ! -f "/data/sb3????????sh25t.sqfs" -a ! -f "/data/sb3???????sh25t.sqfs" ]
then 
```

引号在`-f`引号之外（引号也是`!`），我将`-a`to 和所有四个条件一起使用。

我也可以这样做：

```
if [ -f "/data/sb3???sh25t.sqfs" ]      && [ ! -f "/data/sb3??????sh25t.sqfs" ] && \
   ! -f "/data/sb3????????sh25t.sqfs" ] && [ ! -f "/data/sb3???????sh25t.sqfs" ] 
```

这`&&`实际上是一个称为*列表运算符*的 bash shell 结构。它将两个单独的命令链接在一起，并执行以下操作：

*   运行第一个命令。
*   如果第一个命令返回非零值，则运行第二个命令。否则，返回第一个命令的退出代码并且不运行第二个命令。

例如，看到这样的事情是很常见的：

```
[ -d foo ] && rm -rf foo 
```

或（同样的事情）：

```
test -d foo && rm -rf foo 
```

在上面的命令中，我正在测试是否`foo`作为目录存在。如果它确实存在，我的测试命令会返回一个真值，然后我执行删除目录的第二个命令。这和...一样

```
if [ -d foo ]
then
   rm -rf foo
fi 
```

因此，我的*if*语句由四个单独的命令组成。第一个`[...]`执行，并查看文件是否`/data/sb3???sh25t.sqfs`实际存在。如果是，则该测试为真，返回零退出代码。然后，`&&`执行列表中的下一个命令。

下一个测试命令查看是否`/data/sb3??????sh25t.sqfs` **不**存在。如果该文件不存在，则测试命令返回零退出代码，并且下一个`&&`列表运算符运行下一个测试命令。只有前三个`test`命令为真时，才会执行最后一个测试命令。如果最后一个测试命令也是一个真语句，那么您的*then*子句将被执行。

* * *

我希望您了解它`if`现在的工作原理以及您遇到问题的原因。

遗憾的是，还有一个问题正在发生，这就是 Unix shell 的工作方式以及[globbing](https://en.wikipedia.org/wiki/Glob_%28programming%29)与命令行的交互方式。

与其他操作系统中的对应物不同（*咳咳*， Windows！*咳咳*），Unix shell 非常智能，也非常好管闲事。

从命令行尝试此命令：

```
$ echo "Print an *"   #Use quotes
Print an * 
```

现在试试这个：

```
$ echo Print an *    #No quotes
Print an bin foo bar... 
```

这将打印所有“打印”，然后是当前目录中的所有文件。

尝试这个：

```
$ touch foo.out foo.txt
$ echo "Do I have any foo.??? files"
Do I have any foo.??? files
$ echo Do I have any foo.??? files
Do I have any foo.out foo.txt files 
```

再一次，没有引号，我要求它打印出来的东西被改变了。这是因为 Unix shell 很麻烦。正在发生的事情是 Unix shell 看到*globbing*模式并在命令有机会回显任何内容之前用***所有***匹配的文件`foo.???`替换该模式。*`echo`*

 *您可以通过以下方式看到这种情况：

```
$ set -x   #Turns on `xtrace`
$ touch foo.out foo.txt
+ touch foo.out foo.txt
$ echo "Do I have any foo.??? files"
+ echo "Do I have any foo.??? files"
Do I have any foo.??? files
$ echo Do I have any foo.??? files
+ echo Do I have any foo.out foo.txt files
Do I have any foo.out foo.txt files
$ set +x   #Turns off `xtrace` 
```

该功能向您展示了在 shell 处理您的命令***后***`xtrace`您将要执行的命令。以开头的行向您展示了您的命令将实际执行的内容。*`+`*

 *我提出这个问题的原因是由于一个可能的问题。如果您碰巧有多个文件与您的模式匹配，则所有与您的模式匹配的文件都将被替换到您的测试命令中。让我们再看一次命令：

```
if [ -f /data/sb3???sh25t.sqfs ] &&        [ ! -f /data/sb3??????sh25t.sqfs ] && \
   [ ! -f /data/sb3????????sh25t.sqfs ] && [ ! -f /data/sb3???????sh25t.sqfs ] 
```

如果您有一个文件`/data/sb3aaash25t.sqfs`和一个名为的文件`/data/sb3bbbsh25t.sqfs`，则 if 语句中的第一个测试命令将如下所示：

```
if [-f /data/sb3aaash25t.sqfs /data/sb3bbbsh25t.sqfs ] 
```

这可能不起作用，因为该`-f`参数仅采用单个文件名。因此，即使您完成了上述所有操作，您仍然可能会得到一个无法运行的程序。更糟糕的是，它会间歇性地失败，这更难调试。

解决此问题的一种方法是忘记 test 命令，并使用`ls`您在此答案顶部看到的命令：

```
if ls /data/sb3???25t.sqfs 2>&1 > /dev/null
then
   echo "At least one file that matches pattern sb3???25t.sqfs exists"
fi 
```

因此，您可以这样做：

```
if   ls /data/sb3???sh25t.sqfs       2>&1 > /dev/null && \
   ! ls /data/sb3??????sh25t.sqfs    2>&1 > /dev/null && \
   ! ls /data/sb3????????sh25t.sqfs  2>&1 > /dev/null && \
   ! ls /data/sb3???????sh25t.sqfs   2>&1 > /dev/null
then 
```

因为`ls`可以占用多个文件。

对于冗长的解释，我很抱歉。99% 的情况下，您无需了解`if`语句是如何工作的，或者这`[...]`实际上是与`if`.

碰巧你用这个问题中了大奖。如果你今天玩了乐透而不是写剧本，你可以告诉你的老板你对他们的真实看法，这是你的工作，然后搬到一个热带岛屿天堂，那里的文化如此原始，他们没有关于*终端的词模拟器*。

相反，它明天回到盐矿。

* * *

¹是的，是的。我知道这`[`是内置在 BASH shell 中的，而不是`/bin/[`命令。但是，内置的 shell`[`就像`/bin/[`命令一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:15:41.087

使用`-a`代替`&&`并且不要在表达式周围添加双引号，例如`"! -f /filename"`. 另请注意，`-f /data/sb3????????sh25t.sqfs`如果有多个文件与该模式匹配，则该方法不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T17:32:26.953

你的代码最好写成

```
#!/bin/bash
if [   -f /data/sb3???sh25t.sqfs ] &&
   [ ! -f /data/sb3??????sh25t.sqfs ] &&
   [ ! -f /data/sb3???????sh25t.sqfs ] &&
   [ ! -f /data/sb3????????sh25t.sqfs ]; then
   select build in /data/tftpboot/sb3???sh25t.sqfs ; do
       break
   done
   build="${build:15}"
fi 
```

（我对`f`测试进行了重新排序，以便更容易地查看您正在测试的文件名中的模式。）

不要引用`-f`运算符（但*要*养成引用操作数的习惯）并将每个测试放在单独的`test/[`命令中。无需`ls`在您的`select`命令中运行，因为模式扩展已经生成了可供选择的文件列表；`ls`只会获取该列表并复制它，因此它是无操作的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T17:17:15.310

你也有`&&`里面单`[` `]` **这是不允许的**

像这样使用`[[`和`]]`或取出`&&`

```
[ -f file1 ] && [ -f file2 ] 
```

由于您使用的是 glob，因此不能使用以下语法：

~~但最好使用~~

 ~~```
[[ -f file1 && -f file2 ]] 
```~~ 

~~请注意，后者仅适用于`bash`此处的更多信息：~~

[Bash 中的简单逻辑运算符](https://stackoverflow.com/questions/6270440/simple-logical-operators-in-bash)*****

# java - BufferedReader 给连接重置？

> ID：14880246
> 
> 赞同：3
> 
> 时间：2013-02-14T17:08:20.413
> 
> 标签：java, networking, tcp

我正在尝试使用 Java 将一些数据从客户端发送到服务器，这是我的 PlayerThread，它在新客户端连接时在服务器上运行

```
PrintWriter out = new PrintWriter(socket.getOutputStream(), true);
        //Create a link to send data to the server
        BufferedReader in = new BufferedReader(
                new InputStreamReader(
                socket.getInputStream()));
        while(true)
        {
            out.println(pongData);
            String temp = in.readLine();
            if(temp == "up")
            {
                System.out.println("Up you say");
            }
        }
//There is a little more but no point to give it all 
```

行 String temp = in.readLine(); 当客户端断开连接时给我这个错误

```
java.net.SocketException: Connection reset
at java.net.SocketInputStream.read(Unknown Source)
at java.net.SocketInputStream.read(Unknown Source)
at sun.nio.cs.StreamDecoder.readBytes(Unknown Source)
at sun.nio.cs.StreamDecoder.implRead(Unknown Source)
at sun.nio.cs.StreamDecoder.read(Unknown Source)
at java.io.InputStreamReader.read(Unknown Source)
at java.io.BufferedReader.fill(Unknown Source)
at java.io.BufferedReader.readLine(Unknown Source)
at java.io.BufferedReader.readLine(Unknown Source)
at Pong.PongPlayerThread.run(PongPlayerThread.java:36) 
```

这是客户端代码

```
try
    {
        socket = new Socket(host, port);
        serverOut = new PrintWriter(socket.getOutputStream(), true);
        serverInput = new BufferedReader(new InputStreamReader(socket.getInputStream()));
    }
    catch (UnknownHostException e)
    {
        System.err.println("Couold not connect to host:" + host);
        System.exit(1);
    }
    catch (IOException e)
    {
        System.err.println("Could not get Input/Output from server");
        System.exit(1);
    }

    System.out.println("Connected to Server");

    while ((pos = serverInput.readLine()) != null) 
    {
        String[] posValues = pos.split(":");
        model.getBall().setX(Double.parseDouble(posValues[0]));
        model.getBall().setY(Double.parseDouble(posValues[1]));

        if(PongController.moveUp == true)
        {
            serverOut.println("up");
            PongController.moveUp = false;
        }

        //If the client presses up or down arrow, a message will be sent to the server
        //the server will then update the movement and the clients will be able to see it

    } 
```

这段代码有效，但它似乎根本没有真正发送消息:(，如果有人能帮助我，那就太棒了

帆布

我刚刚编辑了一些代码，我发现在 PlayerThread 中的行

```
if(temp.equals("up"))
            {
                System.out.println("Up you say");
            } 
```

是问题所在，我在客户端的流一开始就设置为空，这可能是问题吗？发送空？

这是更新版本

```
 while ((pos = serverInput.readLine()) != null) 
    {
        String[] posValues = pos.split(":");
        model.getBall().setX(Double.parseDouble(posValues[0]));
        model.getBall().setY(Double.parseDouble(posValues[1]));
        serverOut.println("nothing");

        if(PongController.moveUp == true)
        {
            System.out.println("Up");
            serverOut.println("up");
            PongController.moveUp = false;
        }
        else
        {
            serverOut.println("nothing");
        }

    } 
```

但我仍然遇到同样的错误

检查 in.readLine 是否等于我在这里得到的任何东西是代码

```
try
    {
        PrintWriter out = new PrintWriter(socket.getOutputStream(), true);
         BufferedReader in = new BufferedReader(
                    new InputStreamReader(
                    socket.getInputStream()));

         System.out.println("Checking readLine value");

         if(in.readLine() == null)
         {
             System.out.println("A ok");
         }
         else
         {
             System.out.println(":" + in.readLine());
         }

        while(true)
        {
             String temp = in.readLine();
             if(temp == "up")
             {
                    System.out.println("Up you say");
             }
            out.println(pongData);
        }
    }
    catch (IOException e) 
    {
        e.printStackTrace();
    } 
```

这是结果

```
Pong
400.0:301.0:60.0:300.0:740.0:300.0
Server started
Server was setup and will try to create a socket
Data sent
Checking readLine value
Connection reset, and then followed by lots of red lines 
```

我还可以做些什么？

我只是想像这样检查我的 BufferedReader

```
BufferedReader in = new BufferedReader(
                    new InputStreamReader(
                    socket.getInputStream()));

        System.out.println(in.toString());
        System.out.println(in.readLine()); 
```

我为 in.toString 获得 java.io.BufferedReader@6262937c 但对于 readLine 我再次重置连接...

快速更新，

在我的客户代码中，如果我有这个

```
 while ((pos = serverInput.readLine()) != null) 
    {
        String[] posValues = pos.split(":");
        model.getBall().setX(Double.parseDouble(posValues[0]));
        model.getBall().setY(Double.parseDouble(posValues[1]));
        serverOut.println("nothing"); //<--- 
```

客户端将连接，获取乒乓球的位置，但随后它将停止从服务器接收数据并自行移动球（尚未禁用更新方法）。serverOut 是

```
serverOut = new PrintWriter(socket.getOutputStream(), true); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-16T19:50:27.643

好的，所以我注意到您最近一直在问很多有关网络的问题，我想您可能需要一些基础知识方面的帮助。这是一个非常简单的服务器：

```
package com;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.ServerSocket;
import java.net.Socket;

public class SimpleServer implements Runnable
{    
    public SimpleServer()
    {
        started = false;
        serverSocket = null;
    }

    public void start()
    {
        if(!started)
        {
            started = true;

            try
            {
                serverSocket = new ServerSocket(PORT);
                running = true;

                serverThread = new Thread(this);
                serverThread.start();

                System.out.println("Server started!\n");
            }catch(Exception e)
            {
                e.printStackTrace();
                System.exit(0);
            }
        }
    }

    public void stop()
    {
        running = false;
        started = false;

        if(serverThread != null)
            serverThread.interrupt();
        serverThread = null;
    }

    public void run()
    {
        try
        {
            while(running)
            {
                try
                {
                    Socket client = serverSocket.accept();
                    System.out.println("Client Accepted!");

                    ClientHandler handler = new ClientHandler(client);

                    handler.sendMessage("Hello, SimpleClient!");
                    System.out.println("Sendeing client a message...");
                }catch(Exception e){e.printStackTrace();}
            }
        }catch(Exception e){e.printStackTrace();}
    }

    private boolean started;
    private boolean running;
    private ServerSocket serverSocket;
    private Thread serverThread;

    private static final int PORT = 8081;

    public static void main(String args[])
    {
        SimpleServer server = new SimpleServer();
        server.start();
    }

    public class ClientHandler implements Runnable
    {
        public ClientHandler(Socket socket)
        {
            this.socket = socket;

            try
            {
                writer = new PrintWriter(socket.getOutputStream());
                reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));
                running = true;

                runningThread = new Thread(this);
                runningThread.start();
            }catch(Exception e){e.printStackTrace(); disconnect();}
        }

        public void disconnect()
        {
            running = false;
            if(runningThread != null)
                runningThread.interrupt();
            runningThread = null;

            try
            {
                reader.close();
            }catch(Exception e){}
            reader = null;

            try
            {
                writer.close();
            }catch(Exception e){}
            writer = null;
            try
            {
                socket.close();
            }catch(Exception e){}
            socket = null;
        }

        public void sendMessage(String message)
        {
            if(running)
            {
                writer.println(message);
                writer.flush();
            }
        }

        public void run()
        {
            try
            {
                String message = "";
                while((message = reader.readLine()) != null && running)
                {
                    System.out.println("Message Recieved: " + message);
                }
            }catch(Exception e){e.printStackTrace(); disconnect();}
        }

        private Socket socket;
        private PrintWriter writer;
        private BufferedReader reader;

        private Thread runningThread;
        private boolean running;
    }
} 
```

现在这里是客户端：

```
package com;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.Socket;

public class SimpleClient implements Runnable
{
    public SimpleClient()
    {
        try
        {
            socket = new Socket("127.0.0.1", PORT);
            writer = new PrintWriter(socket.getOutputStream());
            reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            running = true;

            runningThread = new Thread(this);
            runningThread.start();
        }catch(Exception e){e.printStackTrace(); disconnect();}
    }

    public void disconnect()
    {
        running = false;
        if(runningThread != null)
            runningThread.interrupt();
        runningThread = null;

        try
        {
            reader.close();
        }catch(Exception e){}
        reader = null;

        try
        {
            writer.close();
        }catch(Exception e){}
        writer = null;
        try
        {
            socket.close();
        }catch(Exception e){}
        socket = null;
    }

    public void sendMessage(String message)
    {
        if(running)
        {
            writer.println(message);
            writer.flush();
        }
    }

    public void run()
    {
        try
        {
            String message = "";
            while((message = reader.readLine()) != null && running)
            {
                System.out.println("Message Recieved: " + message);

                System.out.println("Sending a response!");
                sendMessage("Hello, SimpleServer!");
            }
        }catch(Exception e){e.printStackTrace(); disconnect();}
    }

    private Socket socket;
    private PrintWriter writer;
    private BufferedReader reader;

    private Thread runningThread;
    private boolean running;

    private static final int PORT = 8081;

    public static void main(String args[])
    {
        new SimpleClient();
    }
} 
```

为了在 Java 中制作成功的服务器，您需要实现大量的面向对象。如果服务器不仅要处理侦听客户端，还要处理向这些客户端发送和接收消息，服务器将过于复杂。这就是我通常使用`ClientHandler`类的原因。这个类处理所有的通信并且很容易实现。客户端和服务器不应该在同一个文件中，因为它们是分开运行的。

如果您不确定服务器和客户端应该如何工作，这也可能会让您感兴趣：

*   [客户端 - 服务器模型](http://en.wikipedia.org/wiki/Client%E2%80%93server_model)

我希望这有帮助！

约翰

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:14:43.640

您可能需要刷新输出。

[http://docs.oracle.com/javase/6/docs/api/java/io/PrintWriter.html#flush()](http://docs.oracle.com/javase/6/docs/api/java/io/PrintWriter.html#flush())

# apache - 用.htaccess 控制子路径？

> ID：14880248
> 
> 赞同：0
> 
> 时间：2013-02-14T17:08:40.157
> 
> 标签：apache, .htaccess, apache2

我有一个在子文件夹下运行 CMS 的站点，但我不想让它像[http://mysite.tld/cms/](http://mysite.tld/cms/)那样加载，我希望所有页面都像位于根目录一样加载[http://mysite.tld](http://mysite.tld)。

到目前为止，我已经能够完成其中的一部分，以便在[http://mysite.tld/](http://mysite.tld/)加载索引文件，但是当我开始接触子页面时，我最终得到了[http://mysite。 tld/cms/some-page](http://mysite.tld/cms/some-page)而不是[http://mysite.tld/some-page](http://mysite.tld/some-page)。

到目前为止，我的 .htaccess 如下：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^(www.)?mysite.tld$
RewriteRule ^(/)?$ cms [L] 
```

我不禁认为 .htaccess 上一定有一些我遗漏的东西可以促进子页面在根目录中而不是在`/cms/`路径中工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:24:43.023

我发现了[以下](https://stackoverflow.com/a/163530/320681)作品：

> RewriteRule ^foldername – [L,NC]

*   - 表示什么都不做。

*   L 表示这应该是最后一条规则；忽略后面的一切。

*   NC 表示无大小写（因此“FOLDERNAME”也匹配）。

***Rails 方法也适用：***

```
RewriteCond %{REQUEST_URI} ^(folders|to|ignore).*
RewriteRule .* – [L] 
```

# java - TelephonyManager.getDeviceId() 返回一个常量值？

> ID：14880249
> 
> 赞同：0
> 
> 时间：2013-02-14T17:08:47.450
> 
> 标签：java, android

我正在为混淆信息生成一个密钥。

该密钥必须在设备之间更改，因此对于我使用的一代：

*   `Secure.getString(getContentResolver(), Secure.ANDROID_ID)`
*   `TelephonyManager.getSimSerialNumber()`
*   `TelephonyManager.getDeviceId()`
*   如果上述所有选项都为，则生成一个随机持久字符串`null`

但是测试我意识到，由于**TelephonyManager.getSimSerialNumber()**会随着设备中的 SIM 卡而变化（并且在飞行模式下总是返回 null），因此密钥也会发生变化，并且无法恢复混淆的数据。

我的问题是：**TelephonyManager.getDeviceId()**是否总是返回相同的值（null 或一个值但总是相同的结果）？

注意：我测试过，即使在“飞行模式”下它也会为我返回一个有效值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:12:54.927

假设有问题的设备**没有**植根（因为它允许用户更改设备的大部分唯一字符串） TelephonyManager.getDeviceId() 应该返回 GSM 网络上的 IMEI 号码 - 这与手机而不是 SIM 相关联，因此，它不会改变。

# google-apps-script - 在 importData() 之后转换列货币

> ID：14880250
> 
> 赞同：0
> 
> 时间：2013-02-14T17:08:56.193
> 
> 标签：google-apps-script, google-sheets

我有一个表导入（通过 importData()），其中包含一列完整的美元值。我想将这些值转换为英镑。

我知道（假设）这将通过 =GoogleFinance("CURRENCY:USDGBP") 完成，但我不知道如何应用它，因为单元格正在由 importData 函数填充。有没有解决的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:50:55.127

如果对您来说不是太麻烦，您可以制作一张只处理数据导入的表格。然后在单独的表格中，只需引用导入的单元格乘以货币兑换率（由 给出`GoogleFinance("...")`）。

# javascript - backbone.js Backbone.Events Prototype Router 事件聚合

> ID：14880252
> 
> 赞同：2
> 
> 时间：2013-02-14T17:09:01.813
> 
> 标签：javascript, backbone.js, client-side, singlepage

`(Backbone.View.prototype.eventAggregator = _.extend({}, Backbone.Events);)`在不将它作为参数传递的情况下，让我的 Backbone.js 中的路由器可以使用这个 eventAggregator 对象的最佳方法是什么。

我有一个 mainController （一个没有渲染的视图），我正在实例化 `Backbone.View.prototype.eventAggregator`.

我还在 mainController 中创建了我的路由器，但只有 View 会有 eventAggregator 而不是路由器。

我不想走得更远，做 Backbone.prototype.eventAggregator 以便路由器可以拥有它。有更清洁的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T18:29:16.303

Backbone 已经内置了类似的东西，您可以使用（来自 Backbone 源）：

```
 // Allow the `Backbone` object to serve as a global event bus, for folks who
  // want global "pubsub" in a convenient place.
  _.extend(Backbone, Events); 
```

然后在路由器中：

```
Backbone.trigger('something'); 
```

并认为：

```
this.listenTo(Backbone, 'something', this.someMethod); 
```

或者反过来取决于你想要做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:51:30.733

正如 Paul 提到的，所有主干对象，包括路由器，都扩展了 Event 对象，因此您可以在这些对象上设置事件侦听器。但是我理解为什么要集中管理事件，这样就不需要在各种对象上设置事件侦听器，或者传入事件聚合器。

Derick Bailey 在下面的帖子中谈到了这一点，他提出的解决方案是创建一个 App 级事件聚合器。

[http://lostechies.com/derickbailey/2012/04/03/revisiting-the-backbone-event-aggregator-lessons-learned/](http://lostechies.com/derickbailey/2012/04/03/revisiting-the-backbone-event-aggregator-lessons-learned/)

此外，如果您正在做比“待办事项”应用程序更复杂的事情，我建议您查看一些 Backbone 框架，如 Chaplin、Marionette、样板等。您可以在[此处找到列表](https://github.com/documentcloud/backbone/wiki/Extensions,-Plugins,-Resources)

在我的应用程序中，我使用 Marionette 框架，并且发现它在创建模块化、易于维护的代码方面非常有用，其中已经处理了许多常用的重复代码。

# perl - 如何在 perl 中包含和使用 pm 文件

> ID：14880255
> 
> 赞同：2
> 
> 时间：2013-02-14T17:09:07.067
> 
> 标签：perl, include, package, perl-module

好的，这就是主文件使用那些包含 pm 文件的方式

```
use Dancer;
use Net::OAuth2::Client;
use HTTP::Request::Common;

sub client {
   Net::OAuth2::Client->new(
     '0', # OAuth 2.0 client_id
     '1234567890abcdef', # OAuth 2.0 client_secret
     site => 'http://www.deviantart.com',
     authorize_path => 'https://www.deviantart.com/oauth2/draft15/authorize?response_type=code',
     access_token_path => 'https://www.deviantart.com/oauth2/draft15/token?grant_type=authorization_code',
     access_token_method => 'GET',
   )->web_server(
     redirect_uri => uri_for('/auth/deviantart/callback')
   );
} 
```

我已将这些 PM 文件放在与此相同的目录中，但由于无法找到而失败

![在此处输入图像描述](../Images/ab76b132e6775262e7aac049b97753e6.png)

这些文件是这样开始的

```
package Net::OAuth2::Client;
package HTTP::Request::Common;
package Dancer; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-14T17:12:43.727

Perl 期望`Foo::Bar::Baz`在`$PERL5LIB/Foo/Bar/Baz.pm`

它还期望模块附带它们的依赖项。不要只复制特定`.pm`文件。使用`cpanm`（`cpan`或其他 CPAN 安装程序）正确安装模块。

您似乎在使用 Windows……</p>

如果您使用的是 ActiveState Perl，那么您可能应该查看它的 PPM 安装程序。

如果您使用的是 Strawberry Perl，那么它将有一个 cpan 安装程序，您可以运行：

```
cpan Net::OAuth2::Client 
```

在命令行上。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-14T17:45:36.177

有一个名为 Perl 的变量`@INC`列出了搜索这些 Perl 模块的目录。运行这一个班轮：

```
$ perl -e 'print join ("\n", @INC) . "\n";' 
```

输出将是这些 Perl 模块所在的所有目录的列表。

现在，您必须了解这些模块的结构。当一个模块说：

```
use Foo::Bar:Barfu; 
```

`Foo/Bar/Barfu.pm`这意味着在这些目录之一中有一个名为的文件。这就是 Perl 知道如何找到这些模块的方式。当然，如果这些模块包含必须编译并与模块链接的二进制代码，那么所有的赌注都将失败。

这些似乎都是 CPAN 模块。如果您使用的是 Strawberry Perl，您可以使用`cpan`控制台窗口中的命令来安装这些模块。只需`cpan`在命令行上键入并按照说明进行操作。您需要第一次执行此操作，因此`cpan`可以自行配置。

完成后，您下次可以执行以下操作：

```
$ cpan install Dancer 
```

这将（幸运地）为您安装 Dancer 模块。这也将运行所有测试，并在需要时进行任何类型的 C 编译。

如果您使用 ActiveState Perl，请尝试使用 Perl 模块管理器 (PMM)，它应该位于 ActiveState 下的开始菜单中。您也可以通过 使用 ActiveState `cpan`，但您需要进行一些[配置](http://docs.activestate.com/activeperl/5.8/faq/ActivePerl-faq2.html#CPAN_shell)才能使其正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T19:54:55.130

如果您不必从 cpan 安装它们，您应该按照以下步骤操作：

1.  检查文件中是否没有任何依赖：Client.pm、Dancer.pm、common.pm。您可以从以 use some_module; 开头的文件中的字符串中知道它。但是如果使用了其他一些模块，那么你应该使用最简单的方法是 cpan。
2.  假设文件中没有任何依赖关系。在这种情况下，您已使用规则重命名这些文件，“.pm 文件的名称必须与包名称相同；进入该文件。有两种方法：第一种在主文件中您应该这样编写：

    使用舞者；# 模块名必须与文件名相同

    使用客户端；# ...

    使用普通；# 普通不普通

第二种方法是：为每个 .pm 文件创建一些目录。例如，如果您的模块具有名称`package Net::OAuth2::Client;`，那么您必须将一些目录设置为`./Net/OAuth2/Client.pm`. 该符号与将在其中找到模块的目录路径`::`相同`/`。

ps`./`如果您使用正确的名称，当然会找到目录中的任何 .pm 模块文件。

# c++ - 从 boost::shared_ptr 转换 提升::shared_ptr

> ID：14880264
> 
> 赞同：3
> 
> 时间：2013-02-14T17:09:48.873
> 
> 标签：c++, boost

```
class T
{};

class UseT
{
public:
    //...
    boost::shared_ptr<const T> getT() const
    {
        return m_t;
    }
private:
    boost::shared_ptr<T> m_t;
}; 
```

问题> 转换 from 时使用的规则是`boost::shared_ptr<T>`什么`boost::shared_ptr<const T>`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:22:42.223

`shared_ptr<T>`有一个转换构造函数，如果从 to 转换为有效，则可以构造它`shared_ptr<U>`，反映内置指针的工作方式。`U*``T*`

```
template<typename U>
  shared_ptr(const shared_ptr<U>& other); 
```

（对于`std::shared_ptr`构造函数只能在`U*`可转换为时调用`T*`，但`boost::shared_ptr`我不确定它是否会检查它，或者你只是得到一个无效转换的编译器错误。）

由于`T*`可以转换为`const T*`，构造函数允许您`shared_ptr<const T>`从`shared_ptr<T>`.

# command - 自动热键覆盖了一些默认的 Windows 热键

> ID：14880272
> 
> 赞同：1
> 
> 时间：2013-02-14T17:10:18.243
> 
> 标签：command

所以我在我的新 Windows 8 机器上扔了自动热键。它加载了它自己的热键文件，它改变了（windows按钮+ Z）的功能。我立即删除了分配 Run Autohotkey 的行，然后保存并运行该热键文件。现在 windows 键 + Z 什么都不做，而是恢复到原来的功能，即“在屏幕底部打开特定于应用程序的命令栏”。

如何恢复自动热键随机决定覆盖的默认 Windows 热键？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-06-06T22:50:02.717

已经有几个月了，所以希望到现在为止，你已经有了你的解决方案......我注意到有时 AutoHotkey 脚本即使在我重新运行脚本的新版本后也会卡在原地。但是重新启动总是将我的热键恢复到原来的状态。

因为我并不清楚如何重新启动 Windows 8，所以让我包含此链接以重新启动说明，以防万一有人需要它们： http: [//www.addictivetips.com/windows-tips/how-to-restart-log -off-sleep-and-shutdown-windows-8/](http://www.addictivetips.com/windows-tips/how-to-restart-log-off-sleep-and-shutdown-windows-8/)

# wamp - PHPMailer 不发送电子邮件：如何检查我的 wamp 服务器限额

> ID：14880287
> 
> 赞同：1
> 
> 时间：2013-02-14T17:11:10.550
> 
> 标签：wamp, phpmailer

我正在使用 wamp 服务器和 PHPMailer 发送测试电子邮件。这是我的代码：

```
<?php
require_once ("includes/PHPMailer/class.phpmailer.php");
require_once ("includes/PHPMailer/class.smtp.php");
require_once ("includes/PHPMailer/language/phpmailer-lang-en.php");

$to_name = "Junk mail";
$to = "myemail@yahoo.com";
$subject = "Mail Test at" .strftime("%T", time());
$message = "This is a test.";
$message = wordwrap($message, 70);
$from_name = "My Name";
$from = "myemail@gmail.com";

//PHP mail version (default)
$mail = new PHPMailer();
try {
    $mail->FromName = $from_name;
    $mail->From = $from;
    $mail->AddAddress($to, $to_name);
    $mail->Subject = $subject;
    $mail->Body = $message;
    $mail->SMTPDebug = 1;
    $result = $mail->Send();
    echo 'Sent';
} catch (phpmailerException $e) {
    echo $e->errorMessage();
}
?> 
```

结果我得到`Sent`了（没有错误），但是在我的雅虎帐户中我没有收到任何东西。

# prestashop-1.5 - Prestashop 1.5.3 上的 Appixia - 类别从 Root 开始，而不是从 Home

> ID：14880288
> 
> 赞同：0
> 
> 时间：2013-02-14T17:11:12.133
> 
> 标签：prestashop-1.5, appixia

在 Prestashop 1.5.3.1 上运行 Appixia 模块 1.0.2

显示类别列表不需要从根目录开始，因为它只显示“主页”类别。

我如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:11:12.133

默认情况下，Prestashop 的 Appixia 模块从第一个类别 (id 1) 开始类别树。

Prestashop 1.3-1.4 用于将您的所有商店类别放在根目录下。

Prestashop 1.5 将您的所有商店类别置于根目录下的 Home 类别下。

这就是为什么您首先看到 Home 类别的原因。

这很容易定制。在 Appixia Dashboard 中，关注 CategoryList 模块（如果找不到，请转到“所有模块”列表或使用模块图）。转到此模块的非活动设置并查找名为`Filter`. 此属性将允许您为类别列表定义初始过滤器。

您需要的过滤器基于 category `ParentId`，这意味着过滤列表以从具有特定父级的类别开始 - 在您的情况下为 Home 类别。假设您商店中 Home 的 Prestashop 类别 ID 为 2，您需要将 2 放入过滤器值中。

# r - rgdal R 包中 spTransform 中的“检测到非有限变换”

> ID：14880294
> 
> 赞同：3
> 
> 时间：2013-02-14T17:11:46.777
> 
> 标签：r, spatial, coordinate-systems, rgdal

我正在尝试将地理坐标（度）转换为 UTM 坐标（米）并不断收到“检测到非有限变换”的错误消息。你知道我该如何解决这个问题吗？这是我使用的代码：

```
> GPS.Points <- Gomer.Data[, c('Longitude', 'Latitude')]
> head(GPS.Points)

  Longitude  Latitude
1  23.85474 -19.52211
2  23.85531 -19.52243
3  23.85534 -19.52257
4  23.85580 -19.52346
5  23.85551 -19.52380
6  23.85513 -19.52360

> GPS.Points.Spatial.Data <- SpatialPoints(GPS.Points, 
                                         proj4string=CRS("+proj=longlat +ellps=WGS84"))
> GPS.Points.Spatial.Data[1]

SpatialPoints:
     Longitude  Latitude
[1,]  23.85474 -19.52211
Coordinate Reference System (CRS) arguments: +proj=longlat +ellps=WGS84 

> class(GPS.Points.Spatial.Data)

[1] "SpatialPoints"
attr(,"package")
[1] "sp"

> GPS.Points.UTM.Spatial.Data <- spTransform(GPS.Points.Spatial.Data,
                                           CRS("+proj=utm +south +zone=34 +ellps=WGS84"))

non finite transformation detected:
     Longitude Latitude  
Error in spTransform(GPS.Points.Spatial.Data, CRS("+proj=utm +south +zone=34 +ellps=WGS84")) : 
  failure in points 
In addition: Warning message:
In spTransform(GPS.Points.Spatial.Data, CRS("+proj=utm +south +zone=34 +ellps=WGS84")) :
  3 projected point(s) not finite 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T17:53:29.383

我会检查您要转换的数据。我无法访问您在示例中拥有的数据，因此我只使用了您提供的前 3 个坐标点来尝试复制错误并且没有收到错误。我还检查了错误是否可能是由于指定的 UTM 区域不包括通过更改区域编号和北/南参数提供的所有点，但一切正常。我可能会创建一个循环，遍历要分块转换的数据，以查看问题所在...

```
library(rgdal)

GPS.Points=data.frame(Longitude=c(23.85474, 23.85531, 23.85534))
GPS.Points=cbind(GPS.Points,Latitude=c(-19.52211, -19.52243, -19.52257))

GPS.Points.Spatial.Data <- SpatialPoints(GPS.Points, 
proj4string=CRS("+proj=longlat     +ellps=WGS84"))
GPS.Points.Spatial.Data[1]

class(GPS.Points.Spatial.Data)

GPS.Points.UTM.Spatial.Data <- spTransform(GPS.Points.Spatial.Data,
                          CRS("+proj=utm +south +zone=34 +ellps=WGS84")) 
```

既然你问了，这里是一个遍历部分数据的代码。如果您遇到错误，您至少会知道问题来自数据的哪个位置：

```
library(rgdal)
GPS.Points=data.frame(Longitude=c(23.85474, 23.85531, 23.85534, 23.85474, 
23.85531, 23.85534, 23.85474, 23.85531, 23.85534))
GPS.Points=cbind(GPS.Points,Latitude=c(-19.52211, -19.52243, -19.52257, -19.52211, 
-19.52243, -19.52257, -19.52211, -19.52243, -19.52257))

n_chunks=3 #number of pieces you will break you data into
n.points=dim(GPS.Points)[1]
breaks=seq(1,n.points, by=round(n.points/n_chunks))
breaks=c(breaks, n.points) #make sure to include last points as well

i=1
for (i in 1:(length(breaks)-1)){
  cat('\n','converting points', breaks[i], "to", breaks[i+1])  
  temp.GPS.Points=GPS.Points[breaks[i]:breaks[i+1],]
  temp.GPS.Points.Spatial.Data <- SpatialPoints(temp.GPS.Points, 
proj4string=CRS("+proj=longlat +ellps=WGS84"))
  temp.GPS.Points.UTM.Spatial.Data <- spTransform(temp.GPS.Points.Spatial.Data,
                                             CRS("+proj=utm +south +zone=34 
+ellps=WGS84"))
} 
```

# iphone - 如何从另一个 iOS 应用程序打开一个 iOS 应用程序

> ID：14880295
> 
> 赞同：0
> 
> 时间：2013-02-14T17:12:01.450
> 
> 标签：iphone, ios, ios6

让我们考虑一下我有两个应用程序 App A 和 App B。我想要做的是

1) 当我点击 App A 中的按钮时，我喜欢打开 App B。

2）当从App A的那个按钮点击打开App B时，我喜欢从App B回到App A。

在 iOS 中可以吗？

谢谢你——阿米特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T17:16:12.927

很有可能。它通过您应用程序状态的自定义 url 方案解决：

[如何使用 Xcode 4 注册自定义应用程序打开 URL 方案？](https://stackoverflow.com/questions/8201724/how-to-register-a-custom-app-opening-url-scheme-with-xcode-4)'

[从另一个 (iPhone) 中启动应用程序](https://stackoverflow.com/questions/419119/launch-an-app-from-within-another-iphone)

然后从 App A 告诉 UIApplication 启动 App B 的 url，反之亦然。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T17:16:47.653

如果两个应用程序都支持它是可能的。

两个应用程序都可以声明它们处理的 URL 方案，例如`applicationA://`. 然后可以通过以下方式打开应用程序

```
NSURL* url = [NSURL URLWithString:@"applicationA://launch"];
BOOL success = [[UIApplication sharedApplication] openURL:url]; 
```

请参阅[实现自定义 URL 方案](http://developer.apple.com/library/ios/documentation/iphone/conceptual/iphoneosprogrammingguide/AdvancedAppTricks/AdvancedAppTricks.html#//apple_ref/doc/uid/TP40007072-CH7-SW50)

# c# - 建议：CLR 类型到 EDM 类型的映射不明确，因为多个 CLR 类型与 EDM 类型匹配

> ID：14880298
> 
> 赞同：2
> 
> 时间：2013-02-14T17:12:25.413
> 
> 标签：c#, entity-framework, poco, dbcontext, edmx

我有一个包含 100 多个 dables 的数据库。我决定将 EF 模型分成三个不同的模型。有多个表格出现在多个模型中。使用 EF 5.X DbContext Generator 后，我有了 POCO 类。

此模板生成重复的类（出现在多个模型中的类）但具有不同的命名空间。在尝试查询其中之一后，我收到以下错误：

```
The mapping of CLR type to EDM type is ambiguous because multiple CLR types match the EDM type 
```

面对这个问题后，我相信我有两种选择：

1.  编辑 CSDL、MSL、SSDL 文件以重命名实体。在这种情况下，我会将上下文名称作为前缀附加到实体。
2.  编辑 EF 5.x DbContext 生成器以编辑将生成的 POCO 类的名称。在这种情况下，我还将上下文名称作为前缀附加到 POCO 类。

我的问题如下：我应该遵循哪个选项？以及根据选择的选项我需要做什么。如果没有一个选项是有效的，你建议我做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:01:10.400

如果您编辑 t4 模板（选项 2），所有类都将受到影响。通过编辑类名（您可以在设计器界面中执行此操作），您只能更改在更多上下文中常见的那些类。

因此，如果重叠的类很少，我会选择选项 1。我在类似的场景中做同样的事情，其中​​一些表包含在多个上下文（业务、授权、报告......）中，并且只有类具有其原始名称的上下文是针对该类的 CUD 操作。此外，我不希望我的所有课程都有前缀。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-06-11T17:42:34.097

我删除了**.edmx**文件并重新创建了它。
这解决了问题。不确定这是否对您有帮助。

# string - 如何在不使用诸如 MissingH 之类的外部库的情况下用 Haskell 中的另一个字符串替换字符串的子字符串？

> ID：14880299
> 
> 赞同：3
> 
> 时间：2013-02-14T17:12:25.453
> 
> 标签：string, haskell, substring

我想用 Haskell 中的字符串替换子字符串，而不使用外部库，并且如果可能的话，具有良好的性能。

我考虑过使用[**`Data.Text`**](https://hackage.haskell.org/package/text-1.2.1.3/docs/Data-Text.html)替换功能，但我不想移植我的整个程序以使用`Text`类型而不是`Strings`. 是否会将其打包`String`成一个`Text`值，然后替换我想要的值，然后将该 Text 值解包为 a`String`会很慢`Strings`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T17:44:33.417

试试这个（未经测试）：

```
replace :: Eq a => [a] -> [a] -> [a] -> [a]
replace needle replacement haystack
  = case begins haystack needle of
      Just remains -> replacement ++ remains
      Nothing      -> case haystack of
                        []     -> []
                        x : xs -> x : replace needle replacement xs

begins :: Eq a => [a] -> [a] -> Maybe [a]
begins haystack []                = Just haystack
begins (x : xs) (y : ys) | x == y = begins xs ys
begins _        _                 = Nothing 
```

但总的来说，您可以通过将程序切换为使用`Text`s 而不是`String`s 来获得性能提升。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-03-13T16:28:40.053

这是我的解决方案

```
import Data.List (intercalate)
import Data.List.Split (splitOn)

replace from to = intercalate to . splitOn from 
```

例子

```
replace "squirrel" "platypus" "Daddy, I want a squirrel !" 
```

爸爸，我想要一只鸭嘴兽！

# c# - 清除文本框和组合框 c#

> ID：14880300
> 
> 赞同：1
> 
> 时间：2013-02-14T17:12:24.973
> 
> 标签：c#, winforms

我想在按下按钮时清除所有文本框、组合框并将 numericupdown 重置为零。

最好的方法是什么。对不起，如果有人觉得这个 q 很愚蠢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:17:03.643

如果您使用的是 WinForms，您可以使用以下内容清除所有想要的控件。

```
public void ClearTextBoxes(Control control)
{
    foreach (Control c in control.Controls)
    {
        if (c is TextBox)
        {
            if (!(c.Parent is NumericUpDown))
            {
                ((TextBox)c).Clear();
            }
        }
        else if (c is NumericUpDown)
        {
            ((NumericUpDown)c).Value = 0;
        }
        else if (c is ComboBox)
        {
            ((ComboBox)c).SelectedIndex = 0;
        }

        if (c.HasChildren)
        {
            ClearTextBoxes(c);
        }
    }
} 
```

然后要激活它，您只需在表单中添加一个按钮，并在代码隐藏中添加以下内容。

```
private void button1_Click(object sender, EventArgs e)
{
    ClearTextBoxes(this);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:17:59.427

```
public void ClearTextBoxes(Control parent)
{
    foreach(Control c in parent.Controls)
    {
        ClearTextBoxes(c);
        if(c is TextBox) c.Text = string.Empty;
        if(c is ComboBox) c.SelectedIndex = 0;
    }
} 
```

或者

```
public void ClearTextBoxes(Control ctrl) 
{ 
    if (ctrl != null) 
    { 
        foreach (Control c in ctrl.Controls) 
        { 
            if (c is TextBox)
            {   
                ((TextBox)c).Text = string.empty; 
            } 

            if(c is ComboBox)
            {
                ((ComboBox)c).SelectedIndex = 0;
            }
            ClearTextBoxes(c); 
        } 
    } 
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-14T17:16:50.350

如果这是 WinForms 遍历所有控件并重置它们

```
foreach (Control c in this.Controls)
{
   if (c is TextBox)
   {
        ((TextBox)c).Text = "";
   }
   else if (c is ComboBox)
   {
        ((ComboBox)c).SelectedIndex = 0;
   }
   else if (c is NumericUpDown)
   {
        ((NumericUpDown)c).Value= 0;
   }
} 
```

# reference - 表中的一列能否引用三个不同表中的三个主键

> ID：14880301
> 
> 赞同：2
> 
> 时间：2013-02-14T17:12:25.537
> 
> 标签：reference, foreign-keys, primary-key, user-profile

我想将 UserProfile_tbl(UserId) 引用到三个主键，即 Student(Regno)、Faculty(Regno)、Admin(adminId)。这可能吗？我正在使用 UserProfile 表进行登录。

# visual-studio - Team Foundation Service 构建版本控制

> ID：14880302
> 
> 赞同：1
> 
> 时间：2013-02-14T17:12:26.753
> 
> 标签：visual-studio, tfs, msbuild, versioning, azure-devops

我想将 Changeset 和 BuildNr 添加到我的版本号中。例如：
`4.5\. _Changeset_ . _BuildNr_`

我找到了一些通过控制台执行此操作的解决方案，并且存在一些扩展来向您添加本地 Team Foundation Server。

但我正在使用托管的[Team Foundation *Service*](http://tfs.visualstudio.com/)，因此无法使用**Visual Studio 2012 Pro**添加任何扩展，也找不到任何解决方案。是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T14:28:46.127

实际上，您不需要通过控制台向 tfs 添加扩展（即使这是可能的）。在 TFS 2012 中使用扩展，就像 Team Foundation Service 在 TFS 2010 中的工作方式一样。您必须签入扩展程序集并自定义构建模板。VS 2012 Professional 也应该可以做到这一点（至少我记得，我是用 VS 2010 Pro 做到的）。

看看[这个](http://social.msdn.microsoft.com/Forums/en-US/TFService/thread/e8ba2e76-eb58-4811-a12c-0cdc1f9ec3cd)社区帖子。您还可以阅读[这篇处理 Team Build 自定义的博客文章](http://www.ewaldhofman.nl/post/2010/05/13/Customize-Team-Build-2010-e28093-Part-5-Increase-AssemblyVersion.aspx)。

最后但同样重要的是，您会[在 CodePlex 上](http://versionedtfsbuild.codeplex.com/)找到完整的解决方案。您可以从 Visual Studio 的集成团队资源管理器中完全设置它。

# jsf - 使用 PrimeFaces 启动对话框 和

> ID：14880304
> 
> 赞同：2
> 
> 时间：2013-02-14T17:12:28.953
> 
> 标签：jsf, jsf-2, primefaces

我正在为我的 Web UI 项目使用 PrimeFaces UI 库。

我有一个`manage_watchfolder.xhtml`有按钮的页面，这个按钮会启动一个对话框：

```
<p:commandButton value="Add" oncomplete="dlgEditWF.show()"
    update=":editWFForm" process="@none"/> 
```

在同一个文件中，我`dlgEditWF`包含了`edit_watchfolder.xhtml`：

```
<p:dialog id="editDialog" widgetVar="dlgEditWF" modal="true"
    resizable="true" onShow="showHideActionLocation();">
    <ui:include src="edit/edit_watchfolder.xhtml"/>
</p:dialog> 
```

问题是我不想`edit_watchfolder.xhtml`在单击按钮之前**加载。**但是，在创建`edit_watchfolder.xhtml`的同时被“加载” `manage_watchfolder.xhtml`。因此，所有调用的 bean`edit_watchfolder.xhtml`都被创建、初始化等，甚至用户可能永远不会真正点击按钮。这会产生大量开销，并使执行速度变慢。

我可以避免这种情况吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T19:12:43.067

由于此答案中解释的原因，这是“设计使然”：[Skip execution <ui:include> when parent UI component is not render](https://stackoverflow.com/questions/11989631/skip-executing-uiinclude-when-parent-ui-component-is-not-rendered/11991895#11991895)。

在您的特定情况下，您最好的选择是默认情况下保持 bean 未初始化，并在命令按钮的操作方法期间执行初始化。

```
<p:commandButton value="Add" action="#{bean.initDialog}" 
    process="@this" update=":editWFForm" oncomplete="dlgEditWF.show()" /> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-18T20:23:32.877

您可以使用 的“动态”属性`p:dialog`。查看 primefaces[文档](http://www.primefaces.org/showcase/ui/dialogDynamic.jsf)。

```
<p:commandButton id="basic" value="Show Dialog" onclick="dlg.show();" type="button" />  

<p:dialog id="dialog" header="Dynamic Dialog" widgetVar="dlg" dynamic="true">  
    <h:outputText value="This content is loaded lazy." />  
</p:dialog> 
```

# c# - 创建窗口句柄 #2 时出错

> ID：14880312
> 
> 赞同：0
> 
> 时间：2013-02-14T17:13:04.600
> 
> 标签：c#, winforms

[创建窗口句柄时出错](https://stackoverflow.com/questions/1831088/error-in-creating-windows-handle)

[“创建窗口句柄时出错”](https://stackoverflow.com/questions/88904/error-creating-window-handle)

在大多数这些线程中发现的普遍共识是我的应用程序没有正确处理各种控件。但是，对我来说并非如此。

![在此处输入图像描述](../Images/346ae28a39100310784857e6b30b2d2d.png)

据我所知，这些价值观似乎都没有异常。此外，当我尝试加载表单时出现此错误。它由一个具有约 28 个节点的 DotNetBar AdvTree 组成。其中 26 个有 2 个单元格，第二个单元格有一个使用 DotNetBar TextBoxX 的托管控件。**如果我加载更少数量的节点，错误就会消失。**

我错过了什么吗？我相当肯定处置对象不是问题，因为我在加载表单时遇到了这个问题。

这是堆栈跟踪：

```
System.ComponentModel.Win32Exception (0x80004005): Error creating window handle.
   at System.Windows.Forms.NativeWindow.CreateHandle(CreateParams cp)
   at System.Windows.Forms.Control.CreateHandle()
   at System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible)
   at System.Windows.Forms.Control.CreateControl()
   at System.Windows.Forms.Control.ControlCollection.Add(Control value)
   at DevComponents.AdvTree.AdvTree.Ú›()
   at DevComponents.AdvTree.AdvTree.Ú“(Rectangle Ú‘, Rectangle Ú’)
   at DevComponents.AdvTree.AdvTree.Ú()
   at DevComponents.AdvTree.AdvTree.RecalcLayout()
   at DevComponents.AdvTree.Node.OnDisplayChanged()
   at DevComponents.AdvTree.Cell.OnSizeChanged()
   at DevComponents.AdvTree.Cell.HostedControlSizedChanged(Object sender, EventArgs e)
   at System.Windows.Forms.Control.OnSizeChanged(EventArgs e)
   at System.Windows.Forms.Control.UpdateBounds(Int32 x, Int32 y, Int32 width, Int32 height, Int32 clientWidth, Int32 clientHeight)
   at System.Windows.Forms.Control.UpdateBounds()
   at System.Windows.Forms.Control.WmCreate(Message& m)
   at System.Windows.Forms.Control.WndProc(Message& m)
   at System.Windows.Forms.TextBoxBase.WndProc(Message& m)
   at System.Windows.Forms.TextBox.WndProc(Message& m)
   at DevComponents.DotNetBar.Controls.TextBoxX.WndProc(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) 
```

回答：

对于自定义控件，有一个 Hosted Control 属性。我创建的对象的顺序是这样的：

1.  创建节点
2.  创建一个单元格
3.  创建托管控件
4.  将单元格的托管控件属性设置为步骤 3 中的控件。
5.  将单元格添加到 node.Cells 集合
6.  将节点添加到树中。

由于在第 4 步中，单元格没有父单元，它基本上就在那里。我的猜测是托管控件和单元格都没有父控件，因此它无法正确定位这些控件。无论哪种方式，我都需要将托管控件的父级设置为表单。这似乎解决了我的问题：

`Hosted Control ctrl.Parent = this;`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T14:35:42.310

对于自定义控件，有一个 Hosted Control 属性。我创建的对象的顺序是这样的：

```
1\. Create a node
2\. Create a cell
3\. Create the hosted control
4\. Set the cell's hosted control property to the control in step 3.
5\. Add the cell to the node.Cells collection
6\. Add the node to the tree. 
```

由于在第 4 步中，单元格没有父单元，它基本上就在那里。我的猜测是托管控件和单元格都没有父控件，因此它无法正确定位这些控件。无论哪种方式，我都需要将托管控件的父级设置为表单。这似乎解决了我的问题：

托管控制 ctrl.Parent = this;

# mysql - SQL 从聚合函数中获取其他行

> ID：14880313
> 
> 赞同：6
> 
> 时间：2013-02-14T17:13:02.103
> 
> 标签：mysql, sql

我有一个按（col A）分组的聚合函数。它从一组列（col B）中选择最大值，但我还想从同一行的列中返回另一个值（col C）。但是，如果它对 3 行进行分组，它会选择 C ​​列中的第一个值，而不是具有最大值的列（MAX(col B)）。

```
A    B    C
1     75  jkl
1    100  abc
1    125  dae
2    200  def
3    300  ghi

"SELECT A, MAX(B), C FROM myTable where B > 50 GROUP BY A"

returns (first row) A => 1, B => 125, C => jkl

I want it to return 

A => 1, B => 125, C => dae 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-14T17:16:39.017

您将需要使用一个子查询来获取`max(b)`每个`A`，然后将该值连接回您的表以返回与子查询的值匹配的剩余列：

```
select *
from mytable t1
inner join
(
  select A, max(b) B
  from mytable
  where b >50
  group by a
) t2
  on t1.a = t2.a
  and t1.b = t2.b
where t1.b >50 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/60347/3)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-14T17:16:06.250

由于您没有提及您正在使用的 RDBMS，因此请使用适用于几乎所有 RDBMS 的此查询

```
SELECT  a.*
FROM    tableName a
        INNER JOIN
        (
            SELECT  A, MAX(b) max_B
            FROM    tableName
            WHERE   b > 50
            GROUP   BY A
        ) b ON a.A = b.A   AND
            a.B = b.max_B 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/ec81f/2)

 ~~但是如果你的 RDBMS 支持窗口函数，你可以使用`DENSE_RANK()`

```
SELECT  A, B, C
FROM    
        (
            SELECT  A, B, C,
                    DENSE_RANK() OVER (PARTITION A ORDER BY B DESC) rn
            FROM    tableName
            WHERE   b > 50
            GROUP   BY      
        ) a
WHERE   rn = 1 
```

 ~~* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-14T17:51:35.273

这是一个非常常见的问题 - “显示与我的 min()/max() 聚合条件匹配的行上的其他列。” 在大表上，子查询策略会变得非常慢，排序函数有时也好不了多少。

如果您愿意了解它，这是迄今为止处理此问题的最高效方法（尽管同样，不是最易读的）：

```
SELECT  A, cast(left(val, 8) as int) AS B, substring(val, 9, 999) AS C
FROM  ( SELECT A, max(str(B, 8) + C) AS val FROM myTable GROUP BY A) t 
```

您可以将任何您想要的内容连接到您正在输入的内容`max`，然后在外部查询中提取它。瞧。

请注意，这将返回与 bluefeet 和 JW 发布的解决方案不同的结果，因为如果每个组有多个匹配的最大值，则此方法将选择获胜者（最大的 C），而其他方法将返回多条记录。因此，如果第三个 B 值是 100 而不是 125，这将返回**1, 100, dae，**而其他解决方案将返回**1, 100, abd**和**1, 100, dae**。~~~~

# r - R - 生成 -1 到 1 之间特定形状的数据

> ID：14880314
> 
> 赞同：-3
> 
> 时间：2013-02-14T17:13:03.120
> 
> 标签：r, normal-distribution

我试图在 R 中生成分布在此图像上的数据：

![在此处输入图像描述](../Images/3850fba7e173457284d0b6b78525fc9a.png)

这些值实际上应该只位于 -1 和 +1 之间，但与 0 和 +1 相比，应该更少在 -1 和 0 之间。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-14T17:28:05.297

你需要这样做：

1) 发现一个具有这种形状的函数（如 (-(x-1) *x^2* (x+1)*(x+2))*k) 2）在 -1 到 1 的区间内积分（它将是 k 的函数） 3）将此积分与 1 匹配（以发现 K） 4）对 0 和 1 之间的数字进行采样（我们称此数字为 z） 5）发现 y ，您的积分从 0 到 y 给出 z 6) 重复大量时间步骤 4-5

# jquery - 如何使用 JavaScript 更改选择的选定选项？

> ID：14880319
> 
> 赞同：0
> 
> 时间：2013-02-14T17:13:22.037
> 
> 标签：jquery, html, select

我有一个非常简单的问题，但我不知道该怎么做......在我的 HTML 页面中，我有一个简单的选择标签：

```
<select id="selection-type">
     <option disabled="disabled">Type</option>
     <option value="0">Tous les types</option>
     <option value="1">Appartement</option> 
     <option value="2">Maison</option>
     <option value="3">Terrain</option>
</select> 
```

我想使用 JavaScript 动态设置一个特定的值，但我只是设法更改了选定的索引，而不是显示的值。目前，我正在这样做（在我的 HTML 页面的页脚部分）：

```
<script type="text/javascript">
  $(document).ready(function(){
    document.getElementById("selection-type").selectedIndex = 2;
});
</script> 
```

结果，它改变了我选择的选定索引，但显示的文本不是“更新”：值“Tous les types”保持不变。事实上，我想改变整个选择，例如选择的选项，而不仅仅是索引。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:19:19.790

看起来你正在使用 jQuery。您可以使用 jQuery 的`val`方法来更改选择框，使用`value`您要选择的选项：

```
$(document).ready(function() {
    $('#selection-type').val('1');
}); 
```

或者你需要用纯 JavaScript 来完成吗？

**编辑：**

你使用的是什么浏览器？您正在做的`selectedIndex`事情实际上在 Chrome 24.0.1312.5 中对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:43:48.173

你有没有尝试过：

```
document.getElementById("selection-type").value = document.getElementById("selection-type").selectedIndex.value; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T01:20:26.760

最后，我找到了让它工作的方法。我仍然使用我的第一种方法，但我在 $(document).ready 之前执行它：

```
<script type="text/javascript">
    document.getElementById("selection-type").selectedIndex = 2;
    $(document).ready(function() {
        ...
     });
</script> 
```

我不明白为什么..但它的工作。非常感谢。

# c# - 如何强制 EF-CodeFirst 忽略创建现有视图？

> ID：14880320
> 
> 赞同：3
> 
> 时间：2013-02-14T17:13:26.393
> 
> 标签：c#, entity-framework, ef-code-first

我`View`在现有的数据库中有一个完全由**EF-CodeFirst**创建的，现在我添加了`View`，`Entity`但是当我运行我的应用程序时它会抛出一个异常`There is already an object named 'View' in the database`。我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:44:05.410

**正在发生的事情的解释：**
您收到此错误是因为数据库已经有一个名为“View”的对象（视图或表等），并且带有迁移的 EF-Code First 正在尝试再次创建它。

运行应用程序时，EF Code First 在数据库中查找 dbo.__MigrationHistory 表（通常在系统表中找到）。此表跟踪已运行的迁移。查看此表以查看迁移是否正在创建它并正确填充它。

**为您解答：**
确保您首先正确使用迁移和 EF 代码。如果可以，请尝试删除现有视图（或表）并让 EF 再次创建它。此时，如果您正确设置了迁移，您的迁移表应该使用迁移“升级”自身，并将该条目放在 MigrationHistory 表中。

# php - 你能破解这个输入清理功能吗？

> ID：14880323
> 
> 赞同：0
> 
> 时间：2013-02-14T17:13:33.150
> 
> 标签：php, forms, input, sanitize

我还在学习 PHP 和 SQL。我正在尝试为网站的事件列表创建一个简单的内容管理系统。所有输入表单字段都是文本区域或文本框（是的，我希望它们那样），并且我想让用户能够在这些字段中添加除了文本之外的 HTML 链接。以下功能似乎是开始清理我从用户那里获得的输入的好地方，但由于我是新手，所以我想获得更多知识渊博的开发人员的意见。我还应该做些什么来保护数据库？

PS 感谢这些功能的[CSS-Tricks](http://css-tricks.com/snippets/php/sanitize-database-inputs/)。

```
function cleanInput($input) {

    $search = array(
         '@<script[^>]*?>.*?</script>@si',   // Strip out javascript
         '@<style[^>]*?>.*?</style>@siU',    // Strip style tags properly
         '@<![\s\S]*?--[ \t\n\r]*>@'         // Strip multi-line comments
    );

    $output = preg_replace($search, '', $input);
    return $output;
}

function sanitize($input) {
    if (is_array($input)) {
       foreach($input as $var=>$val) {
          $output[$var] = sanitize($val);
       }
    }
    else {
       if (get_magic_quotes_gpc()) {
          $input = stripslashes($input);
       }
       $input  = cleanInput($input);
   $output = htmlentities($output);
       $output = mysql_real_escape_string($input);
     }
     return $output;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:35:34.167

很容易：

```
$testinput = "<script>alert('p0wned');</script >\n
    <a href='http://example.org' onclick=\"alert('p0Wned again!)\">Click me!</a>";

var_export(cleanInput($testinput)); 
```

此外，`htmlescape`几乎总是使用错误的东西——它会破坏 utf8 输入。此外，您不应将 html 转义数据存储在数据库中。我什至不知道你为什么在这里使用它——你不需要对 html 进行*转义来显示它吗？*

但是，您正在以错误的方式解决此问题。

1.  不要使用正则表达式解析/清理 html。使用真正的 html 解析器，例如[`DOMDocument`](http://php.net/manual/en/class.domdocument.php)or[`html5lib`](http://code.google.com/p/html5lib/)或[`tidylib`](http://php.net/manual/en/book.tidy.php). 不幸的是，PHP 似乎没有像[Python 上的 Bleach](http://pypi.python.org/pypi/bleach)那样美妙的东西，所以你必须自己动手。带有白名单的 XSLT 样式表似乎是处理这种特殊清理条件的好方法。**更新**：另一位用户指出[HTML Purifier](http://htmlpurifier.org)，它也是一个基于白名单的 html sanitizer。我从未使用过它，但它看起来像“PHP 中的漂白剂”。你绝对应该调查。
2.  宁愿*逃跑*也不愿*消毒*。PHP 文化痴迷于清理，这确实是完全*错误*的。在应用程序（输出和数据库）的边界处转义数据。在您的应用程序的核心，您的数据应该是其本机形式，没有任何转义。

处理的大致轮廓如下：

1.  输入

    1.  在您的 php 设置中关闭魔术引号。在您的应用程序顶部包含代码，以便在应用程序打开时很难失败：`if (get_magic_quotes_gpc()) die ('TURN OFF MAGIC QUOTES!!!!');`
    2.  根据每个字段的预期类型验证和规范化/清理输入的*特定字段。*例如，“美元金额”与列入白名单的 html 片段字段具有不同的验证标准。（也许您应该找到并使用验证库。）
    3.  如果有错误，请使用适当的 HTTP 响应代码将其发回给用户。
    4.  使用支持参数绑定的数据库库（例如[`PDO`](http://php.net/manual/en/book.pdo.php)带有预处理语句的库）将数据保存到数据库中。这样您就不需要记住手动转义数据。
    5.  成功后，重定向（代码 303）到显示创建或修改记录的页面。
2.  输出

    1.  从数据库中检索数据。
    2.  将数据提供给模板，该模板是*仅*处理数据结构的 html 显示的 PHP 代码。它不应该知道如何检索数据或包含任何“应用程序驱动”行为的详细信息。将模板视为接受数据结构并返回字符串的函数。
    3.  *在您的模板*中转义您的数据。您的数据的各个字段将需要以不同的方式转义。您几乎总是需要`htmlspecialchars`在输出之前运行它；*您不*会这样做的唯一情况是您需要显示的数据*已经*是html（即您的白名单过滤的 html 字段）。像这样定义一个辅助函数并在您的模板中使用它：

        ```
        function h($str) {
            return htmlspecialchars($str, ENT_QUOTES, 'utf-8');
        } 
        ```

        更好的是，尝试使用*自动*为您转义字符串并要求您明确*关闭转义的模板库。*（常见的情况应该是简单的避免错误，不得不转义是常见的情况！）

    4.  您的 html 页面是从您的模板返回的字符串。您现在可以将其显示给用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-19T20:15:48.053

虽然您不必清理您在浏览器中显示或存储在数据库中的自己的字符串数据，但您**必须**清理您的网站通过 INPUT 元素、TEXTAREA 元素、通过 JavaScript/DOM 事件从键盘获得的所有用户输入，来自上传的文件，以及我忘记列出的所有其他来源。

虽然数据库清理有据可查，并且在最新版本的服务器端语言（如 PHP）中部分强制执行，但仍然没有普遍接受的方法来清理我列出的其他用户输入源。

我自己的贡献是这段 PHP 代码，它允许任何用户输入显示在网页上或通过 GET 或 POST 控件和 FORM 元素中的字段或通过 Ajax 发送到另一个网页，而不会打开您的网站以供恶意使用：

```
function HTMLToSafeHTML($Str)
    {
    return str_replace(['&','<','>','"','\''], ['&amp;','&lt;','&gt;','&quot;','&apos;'], $Str);
    } // HTMLToSafeHTML 
```

要正确使用此功能，您必须识别和跟踪所有用户输入，然后在显示或以其他方式允许将用户输入解释为 Web 处理或编程的一部分之前调用此功能。识别用户输入允许您仅调用此函数一次。多次调用它会显示其难以阅读的编码，这作为文本没有用。

例如，如果您想以粗体显示某些用户输入的错误消息，则必须在将用户输入封闭之前调用 HTMLToSafeHTML（您可以给它一个更短的名称）`<strong>...</strong>`以使其变为粗体。虽然显示“ `<strong>`”是无害的，但显示用户输入可能是恶意用户为了传播病毒或出于其他邪恶目的而故意尝试闯入您的网站的结果，这绝非无害。

# sql-server-2008 - 将大字段 (varbinary(max)) 复制到文件/剪贴板

> ID：14880324
> 
> 赞同：17
> 
> 时间：2013-02-14T17:13:39.417
> 
> 标签：sql-server-2008, tsql, ssms

我在数据库表中有一个 VARBINARY(MAX) 字段，其中包含约 35k 个字符。该字段是一个转换后的 word 文档，遗憾的是无法再访问。

该字段存在于我的开发数据库中，我希望将此值移植到实时数据库中。但是，如果我纯粹从 SQL 中的网格结果中选择内容，我似乎只能获得约 28k 的可用字符。

所以我的问题是，迁移内容太大而无法简单复制粘贴并插入脚本的字段的最佳方法是什么？

任何想法都非常感谢。

编辑：

作为附加信息，将结果输出到文件（尽管是 .txt）似乎比通过网格给我的字符更少。如果我将查询结果导出到运行查询到网格的文件后，我似乎得到了当时查询窗口中内容的文字表示（因此，如果我拉伸窗口，我会得到比压缩列宽更多的字符）

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-14T18:17:23.793

要从 SSMS 查询结果窗格中可靠地复制大字符串，您需要密切注意以下设置（我现在正在查看 SSMS 10.50.2500.0）：

```
Tools > Options > Query Results > SQL Server > Results to Grid
    Max chars retreived:
        Non-XML: 65535
        XML: Unlimited

Tools > Options > Query Results > SQL Server > Results to Text
    Max chars displayed:    
        8192 
```

您可能至少需要打开一个新的查询窗口才能应用设置。请注意，由于 XML 是无限的，您可以*潜在*地转换为 XML 以获得完整的结果。在这种情况下，您可以执行以下操作：

```
select cast(convert(varchar(max), MyColumn, 1) as xml) -- Use style 1 to get "0x..." 
```

总而言之，正如其他人所提到的，可能有更好的（和可自动化/可重现的）方法来在您的系统中移动数据：

*   设置[链接服务器](http://msdn.microsoft.com/en-us/library/ms188279.aspx)以简单地运行插入语句
*   使用[openrowset](http://msdn.microsoft.com/en-us/library/ms190312.aspx)查询远程服务器
*   SSMS：导出数据、生成脚本、结果到文件
*   SSIS
*   3rd 方工具（Redgate 数据比较等）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T09:54:57.740

我为 SSMS 开发的 SSMSBoost 插件有 2 个功能可以帮助您：

1.  它可以直接从ResultsGrid“可视化”保存在单元格中的文档。因此，您将能够直接从 SSMS 中查看您的文档。链接：[http ://www.ssmsboost.com/Features/ssms-add-in-results-grid-visualizers-feature](http://www.ssmsboost.com/Features/ssms-add-in-results-grid-visualizers-feature)

2.  它可以将所有字节从单元格复制到剪贴板。您可以将数据粘贴到一些“好的”文本编辑器中并将其保存为 .doc。但是第一个解决方案更好，只要您可以直接获得 word 文档：[http ://www.ssmsboost.com/Features/ssms-add-in-copy-results-grid-cell-contents-line-with-breaks](http://www.ssmsboost.com/Features/ssms-add-in-copy-results-grid-cell-contents-line-with-breaks)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T17:18:28.513

您可以简单地将结果导出（另存为）到 csv。

1) 在 SSMS 中运行查询
2) 结果以网格格式显示
3) 右键单击​​网格，然后选择将结果另存为
4) 选择 csv 或文本文件格式
5) 将结果保存到文件

这种方式将导出所有数据，从那里你可以选择你想要的所有文本。

注意：这些步骤是使用 SSMS 2012 完成的，但对于 2008 和其他数据库管理工具应该相同或相似

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T18:05:41.037

在 SSMS 查询结果中跳过网格到文件
运行查询

或者你为什么不使用链接服务器直接插入

我测试并保存到文件会截断。

您可以将 .NET 与 DataReader 和 .GetBinary 一起使用吗？

# dojo - dojo dgrid 不渲染

> ID：14880326
> 
> 赞同：0
> 
> 时间：2013-02-14T17:13:48.140
> 
> 标签：dojo, dgrid

我是 js 框架的新手，目前正在试用 Dojo，看看它是否最适合我们的项目。我正在努力使事情与 Dojo 一起工作。我尝试使用 Dojo 的 dgrid。代码或多或少是从教程中直接提升的，我相信我也有所有依赖项（如 dgrid/xstyle 和 put-selector）。但我仍然没有看到网格渲染页面。有人可以帮我解决这个问题吗？

这是我的 js 设置（在 tomcat 中）

![在此处输入图像描述](../Images/bed7d00b87e808580c8d4a80af673a15.png) 这是我的代码（几乎直接从教程部分升起）

```
 <html>
<head>
    <meta charset="utf-8">
    <title>Tutorial: Hello dgrid!</title>
    <!-- this configuration assumes that the dgrid package is located
         on the filesystem as a sibling to the dojo package -->

<!-- load Dojo -->

<script>
    dojoConfig ={
    baseUrl: "js",
    isDebug: true, // enables debug
    async: true, // enables AMD loader
    packages: [
        {
        "name": "dojo",
        "location": "lib/dojo"
        },
        {
        "name": "dgrid",
        "location": "lib/dgrid"
        }   
    ]
    };
</script>
<script src="dojo/dojo.js"></script>
<script>
require(["dojo/parser", "dgrid/Grid", "dojo/domReady!"], function(Grid){
            alert("Hi");
            var data = [
                        { first: "Bob", last: "Barker", age: 89 },
                        { first: "Vanna", last: "White", age: 55 },
                        { first: "Pat", last: "Sajak", age: 65 }
                    ];
            var grid = new Grid(
                    { 
                         columns : {
                                first: "First Name",
                                last: "Last Name",
                                age: "Age"
                            }
                    }, "grid");
            grid.renderArray(data);            
        });
</script>

</head>
<body class="slate">
    <div id="grid" class="slate"></div>
    Hi grid
</body>
</html> 
```

这是我看到的（我根本看不到网格，也没有 js 错误）。 ![在此处输入图像描述](../Images/d3c1199282cf2fba7abaa13705bdf12b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-18T12:28:13.400

in Grid there is "dojo/parser" because the first require isn't Grid. Try with

```
require(["dojo/parser", "dgrid/Grid", "dojo/domReady!"], function(parser,Grid){ 
```

or

```
 require([ "dgrid/Grid", "dojo/parser","dojo/domReady!"], function(Grid){ 
```

# achartengine - 在图表引擎中画一条线

> ID：14880327
> 
> 赞同：5
> 
> 时间：2013-02-14T17:13:49.597
> 
> 标签：achartengine

我想在我触摸图表区域的位置显示一个垂直光标。与此行关联的文本视图将显示条形的值以及其中点的 y 轴值。当我将手指移到右边的同时保持手指向下[左移或右移]时，这个垂直光标会相应地移动，文本视图也会随之移动，但会显示 y 轴值移动时的新位置。

我看到 GraphicalView 有一个触摸监听器，我可以注册它以获取回调 - 但从那时起我不知道如何使用它。我也可以设法将 touchevent 与某种手势监听器相关联。但是我如何绘制覆盖在当前图表顶部的垂直光标线？

我遇到的其他问题是，在 onTuuch 中，当返回 true 时，我无法获取 mChart.getCurrentSeriesAndPoint(); 的值。，总是返回 Null，但如果我将返回值更改为 False，我可以获得这些值，但我无法再次访问 ontuch。

这是我的代码

```
 mChart.setOnTouchListener(new View.OnTouchListener() {
               @Override
               public boolean onTouch(View v, MotionEvent event) {
                   if (event.getAction() == MotionEvent.ACTION_CANCEL) {

                       dataset.removeSeries(dataset.getSeriesCount()-1);
                       multiRenderer.removeSeriesRenderer(GraficaCuatro);
                    }
                    if (event.getAction() == MotionEvent.ACTION_DOWN) { 
                        multiRenderer.setPanEnabled(false);
                        multiRenderer.setZoomEnabled(false);
                        SeriesSelection seriesSelection = mChart.getCurrentSeriesAndPoint();

                           if(seriesSelection != null)
                           {
                               Toast.makeText(
                                        getActivity().getBaseContext(),"Hola",
                                        Toast.LENGTH_SHORT).show();
                           }
                        XYSeries Line = new XYSeries("");
                        Line.add(event.getX()/1.5,minValue);
                        Line.add(event.getX()/1.5,maxValue);
                        dataset.addSeries(Line);    
                        multiRenderer.addSeriesRenderer(GraficaCuatro);
                    }
                    if (event.getAction() == MotionEvent.ACTION_MOVE) {

                           dataset.removeSeries(dataset.getSeriesCount()-1);
                           multiRenderer.removeSeriesRenderer(GraficaCuatro);
                           XYSeries Line = new XYSeries("");
                           Line.add(event.getX()/1.5,minValue);
                           Line.add(event.getX()/1.5,maxValue);
                           dataset.addSeries(Line); 
                           multiRenderer.addSeriesRenderer(GraficaCuatro);

                    }
                       if (event.getAction() == MotionEvent.ACTION_UP) {

                           dataset.removeSeries(dataset.getSeriesCount()-1);
                           multiRenderer.removeSeriesRenderer(GraficaCuatro);
                        }
                   mChart.repaint();
                  return true;
               }
            }); 
```

我很想要这个。

[![矮人](../Images/31c4ab3cefcf62cb9e6841e4dfdaf36d.png)](https://i.stack.imgur.com/4srqq.png)
[（来源：[subirimagenes.com](http://s2.subirimagenes.com/imagen/previo/thump_82994131.png)）]

请我需要帮助！

编辑：这是我的 onTouch 代码，当我返回 True 时；在 onTouch 中，来自 toRealPoint() 的值；和 SeriesSelection 不正确，如果我将 true 更改为 false，我可以获得真实值。请帮忙

```
 mChart.setOnTouchListener(new View.OnTouchListener() {
               @Override
               public boolean onTouch(View v, MotionEvent event) {
                   SeriesSelection seriesSelection = mChart.getCurrentSeriesAndPoint();
                   double[]values = mChart.toRealPoint(0);
                   if(seriesSelection != null)
                   {
                       if (event.getAction() == MotionEvent.ACTION_CANCEL) {
                           dataset.removeSeries(dataset.getSeriesCount()-1);
                           multiRenderer.removeSeriesRenderer(GraficaCuatro);
                        }
                       if (event.getAction() == MotionEvent.ACTION_DOWN) {

                           XYSeries Line = new XYSeries("");
                           Line.add(seriesSelection.getXValue(),minValue);
                           Line.add(seriesSelection.getXValue(),maxValue);
                           dataset.addSeries(Line); 
                           multiRenderer.addSeriesRenderer(GraficaCuatro);
                       }
                       if (event.getAction() == MotionEvent.ACTION_MOVE) {

                           dataset.removeSeries(dataset.getSeriesCount()-1);
                           multiRenderer.removeSeriesRenderer(GraficaCuatro);
                           XYSeries Line = new XYSeries("");
                           Line.add(seriesSelection.getXValue(),minValue);
                           Line.add(seriesSelection.getXValue(),maxValue);
                           dataset.addSeries(Line); 
                           multiRenderer.addSeriesRenderer(GraficaCuatro);
                    }
                       if (event.getAction() == MotionEvent.ACTION_UP) {

                           dataset.removeSeries(dataset.getSeriesCount()-1);
                           multiRenderer.removeSeriesRenderer(GraficaCuatro);
                        }
                   }

                   mChart.repaint();
                  return true;
               }
            }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:16:28.353

为了绘制垂直光标，您必须在图表中添加一系列额外的垂直点。

这`chart.getCurrentSeriesAndPoint()`将返回最接近您在可选缓冲区下触摸屏幕的点的内容。因此，您需要在靠近现有点的位置触摸屏幕，例如它会为您返回一些东西。但是，您可以将可选缓冲区设置为您想要的任何值：

```
renderer.setSelectableBuffer(100); 
```

为了监听图表上的触摸事件，像这样注册：

```
chartView.setOnClickListener(...); 
```

对于一些工作代码，查看官方 AChartEngine 演示，[这篇](http://code.google.com/p/achartengine/source/browse/trunk/achartengine/demo/org/achartengine/chartdemo/demo/chart/XYChartBuilder.java)文章会帮助你。

**更新：**另一个选项必须自己处理触摸并搜索系列以找到最近的点。您可以使用`chartView.toRealPoint()`从屏幕点检索真实数据点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T15:17:45.190

我用这个

```
 mChart = (GraphicalView) ChartFactory.getLineChartView(getActivity().getBaseContext(), dataset, multiRenderer);
        mChart.setOnTouchListener(new View.OnTouchListener() {
            @Override
            public boolean onTouch(View v, MotionEvent event) {
                MotionEvent motionEvent = MotionEvent.obtain(
                        event.getDownTime(), 
                        event.getEventTime(), 
                        MotionEvent.ACTION_DOWN, 
                        event.getX(), 
                        event.getY(), 
                        event.getMetaState()
                        );
                mChart.onTouchEvent(motionEvent);
                double[]values = mChart.toRealPoint(0);
                for(int i = 0; i < dataset.getSeriesCount(); i++)
                {
                    try
                    {
                        if((int)values[0] < dataset.getSeriesAt(i).getItemCount())
                        {
                            //float value = (float) dataset.getSeriesAt(i).getY((int)values[0]);
                            //Log.d("", "");
                        }
                    }
                    catch (Exception e) {
                        // TODO: handle exception
                    }
                }
                if (event.getAction() == MotionEvent.ACTION_CANCEL) {
                    dataset.removeSeries(dataset.getSeriesCount()-1);
                    multiRenderer.removeSeriesRenderer(GraficaCuatro);
                }
                if (event.getAction() == MotionEvent.ACTION_DOWN) {
                    XYSeries Line = new XYSeries("");
                    Line.add(values[0],minValue);
                    Line.add(values[0],maxValue);
                    dataset.addSeries(Line);    
                    multiRenderer.addSeriesRenderer(GraficaCuatro);
                }
                if (event.getAction() == MotionEvent.ACTION_MOVE) {

                    dataset.removeSeries(dataset.getSeriesCount()-1);
                    multiRenderer.removeSeriesRenderer(GraficaCuatro);
                    XYSeries Line = new XYSeries("");
                    Line.add(values[0],minValue);
                    Line.add(values[0],maxValue);
                    dataset.addSeries(Line);    
                    multiRenderer.addSeriesRenderer(GraficaCuatro);

                }
                if (event.getAction() == MotionEvent.ACTION_UP) {
                    dataset.removeSeries(dataset.getSeriesCount()-1);
                    multiRenderer.removeSeriesRenderer(GraficaCuatro);
                }

                mChart.repaint();
                return true;
            }
        }); 
```

# jquery - 更改标签的类别

> ID：14880329
> 
> 赞同：0
> 
> 时间：2013-02-14T17:13:58.940
> 
> 标签：jquery, jquery-validate

我有一些验证，但需要隐藏 div 错误，或者在成功时添加“隐藏”类。我已经包含了我正在使用的插件的链接。您可以在我的演示中看到，当您填写一个字段时，每个输入下方的错误标签都会添加一个空格。[http://cuberocigars.com/bugler/xml.request.php](http://cuberocigars.com/bugler/xml.request.php)

HTML

```
<div class="control-group">
        <div class="controls">
        <input type="text" class="input-coupon" name="address1" placeholder="Street Address" id="address1">
        </div>
    </div> 
```

JS - 这是亮点和成功

```
$(document).ready(function(){

// Validate
// http://bassistance.de/jquery-plugins/jquery-plugin-validation/
// http://docs.jquery.com/Plugins/Validation/
// http://docs.jquery.com/Plugins/Validation/validate#toptions

    $('#contact-form').validate({
    rules: {

      address1: {
        minlength: 2,
        required: true
      }

    },
        highlight: function(element) {
            $(element).closest('.control-group').removeClass('success').addClass('error');
        },
        success: function(element) {
            element

            .closest('.control-group').removeClass('error').addClass('success')

        }
  });

}); // end document.ready 
```

CSS

```
label.error {
        font-weight: bold;
        color: red;
        padding: 2px 8px;
        margin-top: 2px;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:34:54.673

尝试`unhighlight:`回调而不是`success:`...

```
highlight: function(element) {
    $(element).closest('.control-group').removeClass('success').addClass('error');
},
unhighlight: function(element) {
    $(element).closest('.control-group').removeClass('error').addClass('success')
} 
```

[根据文档](http://docs.jquery.com/Plugins/Validation/validate#toptions)：

> **unhighlight**，回调，默认值：删除 errorClass
> 调用以恢复选项所做的更改`highlight`，与 相同的参数`highlight`。

# python - Python MySQLdb "with" 语法和 DictCursor

> ID：14880330
> 
> 赞同：1
> 
> 时间：2013-02-14T17:13:59.910
> 
> 标签：python, mysql-python

我正在尝试将[DictCursor](http://mysql-python.sourceforge.net/MySQLdb-1.2.2/public/MySQLdb.cursors.DictCursor-class.html)与`with`块一起使用。我认为通过使用：

```
with MySQLdb.connect(...) as c: 
```

`c`将是一个连接对象，因为这就是 connect() 返回的内容。但很可惜，事实并非如此！突然，`c`是一个光标！虽然这通常很方便，但我真的很喜欢使用`DictCursor`- 这根本不是这样设计的吗？将 DictCursor 包含为“作用域对象”会导致错误（`__exit__`未定义）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-04-30T02:31:54.383

根据 MySQLdb 中 Connection 的定义，这里[第 254 行的 connections.py](https://github.com/farcepest/MySQLdb1/blob/master/MySQLdb/connections.py#L254)， Connection.cursor() 将返回一个 Connection.cursorclass 的实例：

```
def cursor(self, cursorclass=None):
    """
    Create a cursor on which queries may be performed. The
    optional cursorclass parameter is used to create the
    Cursor. By default, self.cursorclass=cursors.Cursor is
    used.
    """
    return (cursorclass or self.cursorclass)(self) 
```

所以，我猜如果您使用参数“cursorclass”初始化连接，并将其设置为 MySQLdb.cursors.DictCursor，例如：

```
dbconn = MySQLdb.connect(cursorclass=MySQLdb.cursors.DictCursor) 
```

当谈到

```
def __enter__(self):
    if self.get_autocommit():
        self.query("BEGIN")
    return self.cursor() 
```

它将返回一个字典光标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:24:44.203

`c`是一个游标，因为这是从`__enter__`上下文管理器的方法返回的内容。
如果您浏览 Mysqldb 的源代码，您将能够看到[`line 245 of connections.py`](https://github.com/jehiah/mysql-python/blob/master/MySQLdb/connections.py#L245)：

```
def __enter__(self): return self.cursor() 
```

至于`DictCursor`，它不支持上下文管理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-13T09:36:52.403

我用 sqlalchemy 修复原始 sql

```
if self.engine.url.drivername == 'mysql+pymysql':
    from pymysql.cursors import SSDictCursor
    connection = self.engine.raw_connection()
    cursor = connection.cursor(cursor=SSDictCursor)
elif self.engine.url.drivername == 'mysql+mysqldb':
    import MySQLdb.cursors
    connection = self.engine.raw_connection()
    cursor = connection.cursor(cursorclass=MySQLdb.cursors.DictCursor)
else:
    connection = self.engine.raw_connection()
    cursor = connection.cursor() 
```

或在创建连接时使用

```
connect_args=dict(cursorclass=MySQLdb.cursors.DictCursor) 
```

# linux - 向linux进程发送信号并拦截它们

> ID：14880331
> 
> 赞同：2
> 
> 时间：2013-02-14T17:14:00.713
> 
> 标签：linux, bash, process, signals

我有以下 bash 脚本：

```
#!/bin/bash
for i in {0..8}
do
  trap "echo received $i" $i
done
trap "echo 'receiving the SIGINT'; kill -9  $$" INT
for i in {10..64}
do
  trap "echo receiving the $i" $i
done

sleep 1h 
```

如果运行它并从其他终端发送 SIGINT 给它，它什么也不做。我正在使用`kill -2 pid`where pid 是正在运行的脚本的 pid。

如果我在运行脚本的终端中点击`CTRL`+ (SIGINT)，它会杀死自己并写入消息。`C`怎么，从不同的终端向它发送信号时不一样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:22:28.553

If I replace the `sleep 1h` with the

```
while true ; do
    sleep 1
done 
```

It is working :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-17T13:17:46.483

[通常，shell仅在命令之间](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_11)传递处理过的信号（“触发*陷阱*”）。这意味着在子*睡眠*进程退出之前，您的脚本的 INT*陷阱*无法触发。

 **在`CTRL`+的`C`情况下，[终端发送一个 SIGINT 到前台进程组](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap11.html#tag_11_01_09)。该组包括*your_script.sh*及其子*sleep 1h*。子进程立即被杀死，然后脚本也解除阻塞并触发它接收到的信号的*陷阱*。

在*kill -INT*情况下，SIGINT 仅传递给*your_script.sh*而不是传递给它的子节点，因此`trap`在子节点正常退出之前一直处于挂起状态。这就是为什么将*睡眠*间隔从 1 小时减少到 1 秒的紧密循环有效的原因：*陷阱*等待的时间不超过 1 秒。**

# android - Android：在 Activity 中添加子项时 ViewGroup 重叠

> ID：14880334
> 
> 赞同：0
> 
> 时间：2013-02-14T17:14:11.947
> 
> 标签：android, android-activity, overlap, viewgroup

我的情况如下：在我的布局 xml 中，我有一个通用的 LinearLayout 作为主容器，我想基于一个分页系统填充内容，所有内容都包含在单个活动中。

我的Java代码如下：

```
private void goToPage(int pageNum){
    LinearLayout layout = (LinearLayout)this.findViewById(R.id.layoutRadioGroups);

    //Clear Views
    layout.removeAllViews();

    //Figure out array positions based on page number
    if (pageNum < this.PAGE_NUM)
        this.LAST_QUESTION_START -= this.NUM_PER_PAGE[pageNum];
    else{
        if (pageNum > 0)
            this.LAST_QUESTION_START += this.NUM_PER_PAGE[pageNum - 1];
        else
            this.LAST_QUESTION_START = 0;
    }
    this.PAGE_NUM = pageNum;

    //Grab my array values, create a TextView, and add it to the layout
    for (int i=this.LAST_QUESTION_START; i < this.LAST_QUESTION_START + this.NUM_PER_PAGE[pageNum]; i++){
        TextView tv = new TextView(layout.getContext());
        tv.setText(this.QUESTIONS[i]);
        tv.setId(i);
        layout.addView(tv);
    }
} 
```

所以它清除所有视图（这将只是 TextView 的），找出将制定 TextView 对象的正确数组值，然后将它们添加到我的布局中。

现在第 0 页显示正确，当我单击下一步按钮时，第 1 页也正确显示。但是当我转到第 2 页时，第 1 页的内容仍然存在，第 2 页的内容覆盖在顶部。

我对Android开发相当陌生，所以我不确定我没有刷新某些东西或使某些东西无效，但我很困惑。有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T22:54:30.460

想通了问题。

仅当您将应用程序的 android:windowBackground 设置为 @null 时，才会发生此重叠问题。

如果您只是将 textview 的文本设置为数组值，甚至会发生这种重叠问题。您不必实际将视图添加到布局或任何东西。

故事的道德，一开始就正确设置。

话虽这么说，有没有人知道为什么会发生这种情况？

# c# - 删除对象时“非空属性引用空值或瞬态值”

> ID：14880336
> 
> 赞同：3
> 
> 时间：2013-02-14T17:14:13.910
> 
> 标签：c#, asp.net, gridview, fluent-nhibernate, objectdatasource

使用 ASP.NET/C#/fluent Hibernate 架构，我正在尝试使用`GridView`和`ObjectDataSource`管理我的业务对象。我有一个与下面的简化映射和类`Project`具有一对多关系的主类。`OIC`

```
// OIC class definition
public partial class OIC
{
    public int pkOICID { get; set; }
    public string Guarantor { get; set; }
    // ... other fields
    public Project Project { get; set; }
}

// OIC mapping
public class OICMap : ClassMap<OIC>
{
    public OICMap()
    {
        Table(@"OIC");
        LazyLoad();
        Id(x => x.pkOICID)            // primary key for OIC
          .Column("pkOICID")
          .Not.Nullable()
          .GeneratedBy.Identity();
        Map(x => x.Guarantor)
          .Column("Guarantor")
          .Not.Nullable();
        // ...more fields not listed
        References(x => x.Project)    // foreign key to Project
          .Class<Project>()
          .Access.Property()
          .Cascade.None()
          .LazyLoad()
          .Columns("fkProjectID");
    }
}

// Project class definition
public partial class Project
{
    public int pkProjectID { get; set; }
    // ...
    public Iesi.Collections.ISet OICs { get; set; }
}

// Project mapping
public class ProjectMap : ClassMap<Project>
{
    public ProjectMap()
    {
        Table(@"Project");
        LazyLoad();
        Id(x => x.pkProjectID)
          .Column("pkProjectID")
          .Not.Nullable()
          .GeneratedBy.Identity();
        // ...
        HasMany<OIC>(x => x.OICs)
          .Access.Property()
          .AsSet()
          .Cascade.AllDeleteOrphan()
          .LazyLoad()
          .Inverse()
          .Not.Generic()
          .KeyColumns.Add("fkProjectID", mapping => mapping.Name("fkProjectID")
                                                               .SqlType("int")
                                                               .Not.Nullable());
    }
} 
```

在我的存储库上进行单元测试时，OIC 类的所有 CRUD 操作都运行良好，所以我知道映射工作正常。但是，当我使用`GridView`and`ObjectDataSource`尝试删除 OIC 的实例时，当我尝试提交事务时，我得到一个“非空属性引用空值或瞬态值 CLS.BusinessLayer.Model.OIC.Guarantor”异常。

设置断点并检查存储库的 Remove 函数（下面的代码）中的对象显示只有 OIC 对象的主键被填充 - 其余字段为空。

```
public virtual void Remove(T entity)
{
    if (entity == null)
        throw new ArgumentNullException("entity");
    _session = NHibernateSessionProvider.GetSession();
    if (!_session.Transaction.IsActive)
    {
        try
        {
            using (ITransaction transaction = _session.BeginTransaction())
            {
                _session.Delete(entity);
                transaction.Commit();      // exception caused here
            }
        }
        catch
        {
        }
    }
    else
        _session.Delete(entity);
} 
```

如果我删除`.Not.Nullable()`OIC 中的 Guarantor 属性，删除工作正常（我只是出于好奇才尝试过这个）。`DataKeyNames`此外，如果我在for my的列表中包含 Guarantor 字段，`GridView`当我在上面的函数中检查对象时，该字段会正确填充`Remove()`，并且事务会成功提交。目前，`GridView`仅包含 pkOICID - 主键，在`DataKeyNames`.

所以有几件事我坚持：

1.  如果我只删除一个对象并拥有主键，为什么 nHibernate 关心其他字段是否为空？
2.  更重要的是，我认为我必须在`GridView`or`ObjectDataSource`中遗漏一些东西，导致对象在被删除之前没有被完全填充 - 这是需要在`ObjectDataSource_Deleting()`或其他地方完成的事情吗？

如果需要更多代码或解释，请告诉我 - 谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T07:47:38.643

当只有 id 已知/填充时，这应该可以删除

```
session.Delete(Session.Get(entity.GetType(), entity.Id); 
```

# javascript - var myvar 和有什么区别？和 var myvar= null;?

> ID：14880337
> 
> 赞同：1
> 
> 时间：2013-02-14T17:14:11.820
> 
> 标签：javascript

有什么区别

```
var myvar; 
```

和

```
var myvar = null; 
```

?

我刚刚在专业代码中看到了旁边的两个，并想知道这是怎么回事......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T17:15:41.757

一个创建`myvar`（在当前范围内）并且不为它分配任何值（离开它`=== undefined`）。

另一个也分配`null`给它。

的赋值`null`可能很重要，具体取决于其他代码如何与变量交互。OTOH，这可能是因为对它的含义缺乏理解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:36:52.357

我更喜欢使用`var myvar = null;`

**为什么？**

如果我正在检查该值是否在将来设置，null 表示它尚未设置，其中 undefined 表示尝试`myvar`在代码中的某处设置时可能存在错误。

这里还有一些其他意见 -[在 JavaScript 中使用 null 而不是 undefined 的原因是什么？](https://stackoverflow.com/questions/6604749/what-reason-is-there-to-use-null-instead-of-undefined-in-javascript)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T17:24:59.733

如果您尝试`var myvar;`将其定义`myvar`为**未定义**，这意味着它根本没有被分配一个值。

但是当您尝试时，您已将**null 文字**`var myvar = null;`分配给，这意味着该变量表示 null、空或不存在的引用。**`myvar`**

# javascript - Length 返回兄弟姐妹总数的值，如果兄弟姐妹被删除，则不会更新。为什么？

> ID：14880338
> 
> 赞同：-1
> 
> 时间：2013-02-14T17:14:19.807
> 
> 标签：javascript, jquery

当页面第一次加载时，兄弟姐妹的 .length 返回假设为 3。然后“点击”事件触发帖子，成功删除兄弟姐妹并再次调用 .length，但它继续返回 3。

请注意，每个兄弟姐妹都是通过随机时间的“点击”事件而不是在同一个循环中删除的。

示例：（此处手动编码，但应解释行为）

```
<ul id="un33k">
    <li><a class="clicked" href="/link/1">Link 1</a></li>
    <li><a class="clicked" href="/link/2">Link 2</a></li>
    <li><a class="clicked" href="/link/3">Link 3</a></li>
    <li><a class="clicked" href="/link/4">Link 4</a></li>
</ul>

$(document).ready(function(){
    var total_li = $('#un33k').children().length; // 3 (test only)

    $('a.clicked').click(function () {
        var me = this;
        $.post('somelink', {...}, function(data, status) { // assuming success
            var new_total_li =  $(me).closest('li').siblings().length; // 3, good
            var parent = $(me).closest('li').parent() // can't hardcode id
            $(me).closest('li').remove(); // assuming the clicked li is gone now
            new_total_li =  $(parent).children().length; // 3, but should be 2 now?
        }, "json");
    });
}); 
```

即使几分钟后单击，仍然会显示 3。为什么？

**更新：在此处复制实际代码：**

这一行是罪魁祸首（*console.log($(me).closest('li').siblings().length*），无论删除多少兄弟姐妹，它都会显示相同的初始数字。

```
<script>
$(document).ready(function(){
    $('a.get2post').click(function () {
        var me = this;
        var url = $(me).attr('href');
        if ($(me).hasClass('confirm')){
            if(!window.confirm("Are you sure?")){
                return false;
            }
        }
        if ($(me).hasClass('deletion')){
            var postdata = {ajax: 'true' };
            $.post(url, postdata, function(data, status) {
                if (status == 'success'){
                    $(me).closest('li').hide('slow', function(){ $(me).remove(); });
                    console.log($(me).closest('li').siblings().length) // problem
                }
            }, "json");
       }
       return false;
    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:35:20.480

你的问题是`$(me).remove();`线路。那就是删除`<a>`元素，因为`me`引用`this`，它是`a.get2post`元素。我不确定您要完成什么 - 删除`<a>`或`<li>`，但是当您从 获取计数时`$(me).closest('li').siblings().length`，您正在引用`<li>`元素。删除`<a>`with`$(me).remove();`不会影响`<li>`元素的集合。因此，您需要决定在您的情况下删除和计数的含义。

您的工作流程是这样的：隐藏 parent `<li>`，删除`<a>`被引用的，然后获取`<li>`兄弟姐妹的数量。永远不会删除，因此计数将`<li>`始终相同，尽管有些被隐藏。

看看这段代码：

```
$(document).ready(function(){
    $('a.get2post').click(function () {
        var me = $(this);
        var parent_li = me.closest("li");
        var url = "/echo/json/";//$(me).attr('href');
        if (me.hasClass('confirm')){
            if(!window.confirm("Are you sure?")){
                return false;
            }
        }
        if (me.hasClass('deletion')){
            var postdata = {stuff: 'stuff' };
            $.post(url, postdata, function(data, status) {
                if (status == 'success'){
                    parent_li.hide('slow', function () {
                        $(this).remove();
                    });
                    console.log(parent_li.siblings().length) // problem
                }
            }, "json");
       }
       return false;
    });
}); 
```

[http://jsfiddle.net/CTC3J/](http://jsfiddle.net/CTC3J/)

`<li>`它实际上在隐藏目标元素后删除了它。

# objective-c - 将 Storyboard UIViews 添加到数组

> ID：14880339
> 
> 赞同：1
> 
> 时间：2013-02-14T17:14:19.627
> 
> 标签：objective-c, xcode, arrays, uiimageview, xcode-storyboard

我已经用谷歌搜索了自己的盲点，无法找到我要找的东西。我是 XCode 和 Objective-C 的新手，但进展很快……但是……

如果我在 singleView 应用程序上使用 Storyboards，并且我手动将 UIViews 添加到该 Storyboard（例如，表示我要拖放的图像），我如何将这些 UIViews 放入一个数组中以便我可以以编程方式循环它们？现在，我已经能够通过代码创建子视图，然后将它们添加到数组中就好了，但是如果我首先在故事板中创建子视图（这简化了整体布局的设计），然后我尝试添加那些故事板 UIView到一个数组，该数组出现空，X 和 Y 位置为 0。

我的第一个假设是 Storyboard 中创建的 UIView 的实例在 ViewDidLoad 执行时没有实例化（我试图填充数组），但我不确定。我的目标是能够从 Storyboard 布局中直观地将这些 UIViews 放置在它们各自的位置，然后在应用程序启动期间将这些 UIViews 添加到一个数组中，将它们的起始位置保存在屏幕上等。

//

好的，感谢 Andrew 对 IBOutletCollections 的引用，我终于在 App 启动时将我的 UIViews 存储在一个数组中，但是它们表示的帧位置在控制台中被 NSLog'ing 到 {0,0}，即使它们在故事板上的其他位置. 我从 ViewDidLoad 调用了一个 Init 方法，如下所示：

```
- (void)initialize {

    dragViews = [NSArray arrayWithObjects: dragView1, dragView2, dragView3, nil];
    dragTargets = [NSArray arrayWithObjects: dragTarget1, dragTarget2, dragTarget3, nil];

    NSLog(@"arrayImages contains %d items. Contents = %@",[dragViews count], dragViews);
    NSLog(@"arrayTarget contains %d items. Contents = %@",[dragTargets count], dragTargets);

    int i;
    int count = [dragViews count];
    for (i = 0; i < count; i++) {
        UIView *currentView = [dragViews objectAtIndex:i];
        NSLog (@"My view's center is: %@\n", NSStringFromCGRect(currentView.frame));
    }
} 
```

但是我的控制台没有正确地表示他们当前的位置：

```
2013-02-15 10:43:09.538 dragAssign[4869:11303] arrayImages contains 3 items. Contents = (
    "<UIImageView: 0x92066b0; frame = (0 0; 0 0); autoresize = TM+BM; layer = <CALayer: 0x9206710>>",
    "<UIImageView: 0x9006510; frame = (0 0; 0 0); autoresize = TM+BM; layer = <CALayer: 0x9006570>>",
    "<UIImageView: 0x90065a0; frame = (0 0; 0 0); autoresize = TM+BM; layer = <CALayer: 0x9006600>>"
)
2013-02-15 10:43:09.545 dragAssign[4869:11303] arrayTarget contains 3 items. Contents = (
    "<UIView: 0x92062a0; frame = (0 0; 0 0); autoresize = TM+BM; layer = <CALayer: 0x9206350>>",
    "<UIView: 0x92055d0; frame = (0 0; 0 0); autoresize = TM+BM; layer = <CALayer: 0x92053a0>>",
    "<UIView: 0x9206650; frame = (0 0; 0 0); autoresize = TM+BM; layer = <CALayer: 0x92057d0>>"
)
2013-02-15 10:43:09.546 dragAssign[4869:11303] My view's center is: {{0, 0}, {0, 0}}
2013-02-15 10:43:09.546 dragAssign[4869:11303] My view's center is: {{0, 0}, {0, 0}}
2013-02-15 10:43:09.547 dragAssign[4869:11303] My view's center is: {{0, 0}, {0, 0}} 
```

建议？我将如何通过该数组进行交互并获得正确的帧位置？再次感谢安德鲁为我指明了正确的方向！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:17:17.013

您应该可以使用[IBOutletCollection](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIKitConstantsReference/Reference/reference.html)来做到这一点。这里有一个简短的帖子解释它：http: [//www.bobmccune.com/2011/01/31/using-ios-4s-iboutletcollection/](http://www.bobmccune.com/2011/01/31/using-ios-4s-iboutletcollection/)

至于保存视图的起始位置，您需要自己通过迭代出口集合数组中的视图来完成此操作`-viewDidLoad`，并将每个视图的框架存储在某处。

# javascript - 谷歌图表上升 1，不连续

> ID：14880341
> 
> 赞同：2
> 
> 时间：2013-02-14T17:14:27.140
> 
> 标签：javascript, api, numbers, google-visualization

我的网站上有一个谷歌图表，它是一个折线图。但是我的 Y 轴数据值只会以整数上升，所以我不想在 Y 轴上有“4.5”值，如您所见：

![在此处输入图像描述](../Images/a7b41ce08684f949d47298cf673a4dc0.png)

如果有人能指出我正确的方向，我将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:26:55.290

您应该使用以下参数`gridlines:{count}`，例如

```
 hAxis: {
                           minValue: 1.00,
                           maxValue: 5.00,
                           baseline: 3.00,
                           viewWindowMode:'explicit',
                           viewWindow:
                           {
                              max: 5.00,
                              min: 1.00
                           },
                           gridlines:{count:11}
                   },
                   vAxis: {
                           minValue: 1.00,
                           maxValue:5.00,
                           baseline:3.00,
                           viewWindowMode:'explicit',
                           viewWindow:
                           {
                              max:5.00,
                              min:1.00
                           },
                           gridlines:{count:11}
                   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:23:38.653

This question has already been answered [here](https://stackoverflow.com/questions/14440231/google-charts-vertical-axis-in-whole-numbers/14472345#14472345).

And this is what it says:

> If you just want numbers to *display* as whole numbers, then it's easy:
> 
> ```
> function drawVisualization() {
>   // Create and populate the data table.
>   var data = google.visualization.arrayToDataTable([
>     ['x', 'Cats', 'Blanket 1', 'Blanket 2'],
>     ['A',   1,       1,           0.5],
>     ['B',   2,       0.5,         1],
>     ['C',   4,       1,           0.5],
>     ['D',   8,       0.5,         1],
>     ['E',   7,       1,           0.5],
>     ['F',   7,       0.5,         1],
>     ['G',   8,       1,           0.5],
>     ['H',   4,       0.5,         1],
>     ['I',   2,       1,           0.5],
>     ['J',   3.5,     0.5,         1],
>     ['K',   3,       1,           0.5],
>     ['L',   3.5,     0.5,         1],
>     ['M',   1,       1,           0.5],
>     ['N',   1,       0.5,         1]
>   ]);
> 
>   // Create and draw the visualization.
>   new google.visualization.LineChart(document.getElementById('visualization')).
>       draw(data, {curveType: "function",
>                   width: 500, height: 400,
>                   vAxis: {maxValue: 10, format: '0'}}
>           );
> } 
> ```
> 
> If you go to [google playground](https://stackoverflow.com/questions/14440231/google-charts-vertical-axis-in-whole-numbers/14472345#14472345) you will note that the axis labels are 0, 2.5, 5, 7.5, 10\. By adding the format: '0' to the vAxis, it will display only whole numbers, so my labels become 0, 3, 5, 8, 10. But obviously this is not ideal since 8 displays as being halfway between 5 and 10, which it isn't, because the number is actually 7.5 and just being rounded.
> 
> Your ability to change the axis scale/labels is restricted. And to do what you're asking would take a special bit of javascript to create an appropriate scale and number of gridlines to prevent breaking things down in to funky numbers.
> 
> Basically, you want to make sure that your maximum and minimum values, and number of gridlines, allow for easy division such that you will only get whole numbers. To do that, you need to create some funky new logic. Here is some sample code that will allow you to get an appropriate min/max axis value:
> 
> ```
> // Take the Max/Min of all data values in all graphs
> var totalMax = 345;
> var totalMin = -123;
> 
> // Figure out the largest number (positive or negative)
> var biggestNumber = Math.max(Math.abs(totalMax),Math.abs(totalMin));
> 
> // Round to an exponent of 10 appropriate for the biggest number
> var roundingExp = Math.floor(Math.log(biggestNumber) / Math.LN10);
> var roundingDec = Math.pow(10,roundingExp);
> 
> // Round your max and min to the nearest exponent of 10
> var newMax = Math.ceil(totalMax/roundingDec)*roundingDec;
> var newMin = Math.floor(totalMin/roundingDec)*roundingDec;
> 
> // Determine the range of your values
> var range = newMax - newMin;
> 
> // Define the number of gridlines (default 5)
> var gridlines = 5;
> 
> // Determine an appropriate gap between gridlines
> var interval = range / (gridlines - 1);
> 
> // Round that interval up to the exponent of 10
> var newInterval = Math.ceil(interval/roundingDec)*roundingDec;
> 
> // Re-round your max and min to the new interval
> var finalMax = Math.ceil(totalMax/newInterval)*newInterval;
> var finalMin = Math.floor(totalMin/newInterval)*newInterval; 
> ```
> 
> There are a couple issues here (unfortunately). The first is that I am using the number of gridlines to determine the min/max values -- you want to figure out how many gridlines you should have to use nice whole numbers. The easiest way to do this, I think, would be as follows (pseudo-code only):
> 
> ```
> // Take the Max/Min of all data values in all graphs
> var totalMax = 3;
> var totalMin = -1;
> 
> // Figure out the largest number (positive or negative)
> var biggestNumber = Math.max(Math.abs(totalMax),Math.abs(totalMin));
> 
> // Round to an exponent of 10 appropriate for the biggest number
> var roundingExp = Math.floor(Math.log(biggestNumber) / Math.LN10);
> var roundingDec = Math.pow(10,roundingExp);
> 
> // Round your max and min to the nearest exponent of 10
> var newMax = Math.ceil(totalMax/roundingDec)*roundingDec;
> var newMin = Math.floor(totalMin/roundingDec)*roundingDec;
> 
> // Determine the range of your values
> var range = newMax - newMin;
> 
> // Calculate the best factor for number of gridlines (2-5 gridlines)
> // If the range of numbers divided by 2 or 5 is a whole number, use it
> for (var i = 2; i <= 5; ++i) {
>     if ( Math.round(range/i) = range/i) {
>         var gridlines = i
>     }
> } 
> ```
> 
> Then you set the gridlines option (vAxis.gridlines) to the above variable, and your max to newMax, and your min to newMin. That should give you whole number axis labels.
> 
> Note: if your numbers are really small then the above function may not work. The function is also not tested so please check it against some examples on your own time and let me know if it doesn't work properly.
> 
> [1](https://stackoverflow.com/questions/14440231/google-charts-vertical-axis-in-whole-numbers/14472345#14472345): [http://code.google.com/apis/ajax/playground/?type=visualization#line_chart](http://code.google.com/apis/ajax/playground/?type=visualization#line_chart)

# ruby-on-rails - 每当 gem 抛出“无法从时间迭代”错误时

> ID：14880347
> 
> 赞同：11
> 
> 时间：2013-02-14T17:14:50.340
> 
> 标签：ruby-on-rails, ruby-on-rails-3, whenever, ruby-2.0

每当我使用[gem](https://github.com/javan/whenever)进行 cron 作业时，我都会使用它，但是当我运行它时：

```
cd ~/my_project
whenever 
```

我收到错误

```
/home/tomi/.rvm/gems/ruby-2.0.0-rc1@my_projcet/bundler/gems/rails-d1904aff6f04/activesupport/lib/active_support/core_ext/range/include_range.rb:16:in `each': can't iterate from Time (TypeError) 
```

我在跑

ruby-2.0.0-rc1 和 rails 3.2.12

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-14T17:14:50.340

该错误是由**慢性**gem （**每当 gem**依赖项）引起的：它与**Ruby 2**冲突。你可以用一个简单的方法解决它，`bundle update whenever chronic`你会得到最新的、不冲突的版本。

将来，如果您在新版本的 Chronic 正式发布之前需要修复，请`Gemfile`直接指向 git 存储库：

```
gem 'chronic', :git => 'git@github.com:mojombo/chronic.git'
gem 'whenever' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-20T00:05:28.183

您需要更新`whenever`以处理 Ruby 2。

```
bundle update whenever 
```

# css - 使用 Compass/Sass 自动获取 Sprite 文件的名称

> ID：14880352
> 
> 赞同：0
> 
> 时间：2013-02-14T17:14:56.733
> 
> 标签：css, sass, compass-sass, sprite

我最近一直在使用 Sass，最终加入了 Compass（好吧，我在 VS2010 中使用 Mindscape，最后决定试一试）。我只是喜欢精灵生成功能。不过，我有一个问题要问任何知情的人。

我有一个特定的目录，其中包含将在 sprite 文件中使用的任何图像。到目前为止，这是我的代码：

```
@import "icons/*.png";

@each $p in (delete, docEdit, buttonBack, docView, editAcct, email, help, info, lock, search, unlock) {
    .#{$p} { @include icons-sprites(#{$p}); }
} 
```

不用说每个元素都是一个特定的图像文件，最终会出现在精灵中。

这会为列表中的每个项目生成（作为示例）：

```
.delete .icons-delete {
    background-position: -23px 0;
}

.docEdit .icons-docEdit {
    background-position: -63px 0;
} 
```

我想知道是否可以通过获取指定目录中所有 .png 文件的名称并对其执行每个循环而不对它们进行硬编码来进一步自动化此操作。这样我可以在需要时插入或删除图像，重新编译和输出将自动创建类，而无需我在@each 指令下的列表中输入它们。

提前感谢您的任何建议或意见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:25:19.917

是的：

```
@import "icons/*.png";
@include all-icons-sprites; 
```

有关更多详细信息和选项，请参阅[Compass Spriting Docs](http://compass-style.org/help/tutorials/spriting/)。

# java - 简单 for 循环中的进程停滞，取决于迭代器类型（潜在的 JVM 错误？）

> ID：14880354
> 
> 赞同：3
> 
> 时间：2013-02-14T17:14:58.873
> 
> 标签：java, for-loop, jvm

一个非常简单的 for 循环，我用作虚拟机让我的机器忙于阻塞我的 JVM 的所有进程。即使在最简单的星座中，这种停滞仍然存在。

这是两个 for 循环的示例（第一个阻塞，第二个不阻塞），唯一的区别是迭代器“i”的类型，即 int 与 long：

```
public class Main {
public static void main(String[] args) {

    Timer timer = new Timer();
    timer.schedule(new MyTimerHandler(), new Date(), 1000);
    float b = 1;

    // after a few seconds this loop uses 200% CPU and blocks the timer 
    for (int i=0; i<2000000000; i++) {
        b += i/3.141592;
    }
    System.out.println("Result: " + b);
    b = 1;

    // this version uses 100% CPU throughout the entire loop and doesn't block the timer
    for (long i=0; i<2000000000L; i++) {
        b += i/3.141592;
    }
    System.out.println("Result: " + b);
    timer.cancel();
 }
}
// helps to show whether the JVM is stalled or not
class MyTimerHandler extends TimerTask {
    @Override
    public void run() {
        System.out.println("timestamp=" + new Date().toString());
    }
} 
```

我们在两台不同的机器/jvm上重现了这个问题：

*   Arch Linux 3.7.7-1-ARCH ... x86_64 GNU/Linux java 版本“1.7.0_09”，Java(TM) SE Runtime Environment (build 1.7.0_09-b05)
*   OSX 10.8.2 ... x86_64 java 版本“1.7.0_07”，Java(TM) SE 运行时环境（内部版本 1.7.0_07-b10）

* * *

更新和澄清：

*   问题是，为什么以及究竟发生了什么，而不是“解决”给定的示例，即为什么第一个 for 循环表现得如此怪异，使用 2 倍以上的 CPU 并阻塞了 JVM 的所有线程。
*   示例代码终止并给出正确的结果。
*   计时器仅用于演示，有或没有它都会出现问题。
*   int 的限制远高于 2,000,000,000。
*   到目前为止，该问题影响了所有经过测试的 JVM。
*   JProfiler 和其他调试工具在第一个 for 循环期间也会中断/停止。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:32:38.370

这是因为优化编译器（可能试图展开循环）。它在单独的线程上运行，这就是为什么您会看到 200% 的 CPU 利用率。如果您在第一个循环之外创建一个方法并第二次运行它两次，它会按预期工作。

尝试像这样运行你的 JVM：

```
java -Xint Main 
```

该选项禁用 HotSpot 编译器。在我的情况下，计时器线程每秒打印一次，没有暂停。

如果你运行，`java -XX:+PrintCompilation Main`你会看到编译器在第一个循环的中间打印“made not entrant”。

```
 79    6             java.lang.String::lastIndexOf (52 bytes)
    90    1 %           test.Main::main @ 33 (141 bytes)
    timestamp=Thu Feb 14 12:10:40 PST 2013
    timestamp=Thu Feb 14 12:10:41 PST 2013
    timestamp=Thu Feb 14 12:10:42 PST 2013
    timestamp=Thu Feb 14 12:10:43 PST 2013
    timestamp=Thu Feb 14 12:10:44 PST 2013
    13202    1 %           test.Main::main @ -2 (141 bytes)   made not entrant
    timestamp=Thu Feb 14 12:10:53 PST 2013
    Result: 1.80143985E16
    13202    2 %           test.Main::main @ 85 (141 bytes)
    timestamp=Thu Feb 14 12:10:54 PST 2013
    timestamp=Thu Feb 14 12:10:55 PST 2013 
```

交换循环，它会在两个循环之间打印“made not entrant”。

```
 72    6             java.lang.String::lastIndexOf (52 bytes)
    85    1 %           test.Main::main @ 33 (141 bytes)
    timestamp=Thu Feb 14 12:12:38 PST 2013
    timestamp=Thu Feb 14 12:12:39 PST 2013
    timestamp=Thu Feb 14 12:12:40 PST 2013
    timestamp=Thu Feb 14 12:12:41 PST 2013
    15415    1 %           test.Main::main @ -2 (141 bytes)   made not entrant
    Result: 1.80143985E16
    15415    2 %           test.Main::main @ 88 (141 bytes)
    timestamp=Thu Feb 14 12:12:42 PST 2013
    timestamp=Thu Feb 14 12:12:43 PST 2013 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:05:35.620

使用 AProVE ( [http://aprove.informatik.rwth-aachen.de](http://aprove.informatik.rwth-aachen.de) ) 我证明了第一个循环确实正在终止。请仔细查看其他可能的非终止代码，很可能是计时器（如注释中所示）。

# javascript - 全球电话号码的 Javascript RegEx

> ID：14880364
> 
> 赞同：1
> 
> 时间：2013-02-14T17:15:34.743
> 
> 标签：javascript, regex

我正在浏览互联网以找到适合电话号码的 javascript 正则表达式，但我找到的不是我需要的。

我的案例可接受的电话号码类型必须符合以下规则：

*   可能以`+`或开头`0-9`
*   所有其余字符串只允许有`0-9`,`-`和空格（最好在数字之间只有 1 个空格）

到目前为止，我试过这个：`/^\+[\-\d\s]/`但我没有得到正确的结果。我试图阅读一些教程，但我对此很陌生，似乎我遗漏了一些东西。

例如，可接受的电话号码是：+30 6995 4488551（允许空格）或 0030 6995 4488551 等。

任何帮助将非常感激！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:32:39.200

您的正则表达式匹配以 a 开头的任何内容，`+`后跟单个`-`、 数字或空白字符。因此，您将匹配例如：

*   +4qwertzuiopasdfghjkl
*   +-asdfasdfasdfasdf

我建议您查看[http://www.regular-expressions.info/](http://www.regular-expressions.info/)上的示例和教程。至于您的电话号码，更好的正则表达式是：

```
/^\+?[\d -]+$/ 
```

这将匹配所有有效数字，但也匹配无效结构，例如`+---------`或仅`+`带有尾随空格。如果您想真正接近否认很多无效组合，我建议您阅读[此](https://stackoverflow.com/questions/123559/a-comprehensive-regex-for-phone-number-validation)内容，但是您可以看到正则表达式变得混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T18:39:56.893

添加到 migg 的答案 - 您可以在正则表达式测试之后添加更多过滤器，例如，确保表达式中至少有最少位数，或者您有什么。例如，

```
 if !(phone_number.match(/\d/g).length == 9) inValidate() 
```

# java - 安全连接到 UI 线程 Android

> ID：14880369
> 
> 赞同：1
> 
> 时间：2013-02-14T17:15:42.980
> 
> 标签：java, android, thread-safety

使用 AsyncTask 的 doInBackground() 方法在主 UI 线程中声明的对象实例是否安全？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:46:13.470

您的问题更多关于 Java 线程和线程之间的对象访问。

请看一下这个例子，以更好地理解主题[线程示例](http://www.vogella.com/articles/JavaConcurrency/article.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:23:57.190

这是不安全的，因为创建 Asynctask 的 Activity / Fragment 在完成执行时可能不存在，可能是因为屏幕旋转。您应该将所需的对象作为参数传递。要更新 UI，您应该使用 postExecute 方法。

如果您只指线程安全，那么在 android 3.x+ 中，如果您只使用 AsyncTaks，则应该是线程安全的，因为 AsyncTasks 是在串行执行器上执行的。在 Android 2.3 上是同时执行的。

**编辑**

如果需要从 AsyncTask 的 doInBackground 方法修改 UI，可以使用活动方法 runOnUiThread

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T17:18:29.340

我不太明白*“在主 UI 线程中声明”*是什么意思，线程不声明任何内容。我假设您的意思是在`Activity`. 那么是的，只要确保你没有并发问题（例如，一个线程读取而另一个线程正在同一个实例上写入）。`synchronized`并且`volatile`是你的朋友。

# ssis - 如何从 SSIS 包中的路径中提取文件名？

> ID：14880370
> 
> 赞同：2
> 
> 时间：2013-02-14T17:15:52.327
> 
> 标签：ssis

我想知道如何使用 SSIS 从以下给定路径中提取文件名：

### 路径：

```
O:\SourceFiles\Primary\care\ALC121.csv
O:\SourceFiles\Primary\care\COPL119.csv 
```

我想将名称和完整路径插入到表中，如下所示：

### 表数据：

```
QueryName  FileName 
---------  ---------------------------------------
ALC121     O:\SourceFiles\Primary\care\ALC121.csv
COPL119    O:\SourceFiles\Primary\care\COPL119.csv 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T17:26:23.423

我假设完整的文件名来自文件的 ForEach 枚举器。似乎请求是将该字符串减少为仅基本文件名。有些人会使用表达式来让你到达那里，但我发现这是一种丑陋的方法。相反，我会使用脚本任务并利用 .NET 库中的功能。

[System.IO.Path.GetFileNameWithoutExtension](http://msdn.microsoft.com/en-us/library/system.io.path.getfilenamewithoutextension.aspx)

> 返回指定路径字符串的文件名，不带扩展名。

创建第二个变量，`QueryName`使用 String 类型调用它，并将其设置为脚本中的读/写变量。根据带有该值的那个 metchod 调用的结果来分配它的`FileName`值。

然后使用执行 SQL 任务将它们插入到您的表中。使用 a`?`作为参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-08T15:23:07.507

在派生列中，您可以使用`TOKEN()`和`TOKENCOUNT()`函数来执行此操作：

```
TOKEN(
     TOKEN(@[User::Filepath],"\\", TOKENCOUNT(@[User::Filepath],"\\"))
, ".", 1) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-21T17:23:05.360

不带扩展名的文件名：

```
select substring(?,len(?)+1,(charindex('.',?)-1)-LEN(?)) 
```

对于 4 参数映射
0 - FullPath
1 - FilePath
2 - FullPath
3 - FilePath

# sencha-touch - 在不同视口之间传递数据

> ID：14880373
> 
> 赞同：0
> 
> 时间：2013-02-14T17:15:57.247
> 
> 标签：sencha-touch, sencha-touch-2

在我的程序中，有一个带有两个 TextField 和一个 Button 的“屏幕”。

按钮有这个监听器；

```
listeners: {
    tap: function (as, e, eOpts ) {
        Ext.Viewport.animateActiveItem({xtype: 'clientlist'},{ type:'flip'})},
    },
} 
```

所以按下按钮我转到另一个屏幕......</p>

在第二个屏幕中，我想使用一个标签来查看我在第一个屏幕中写的单词。那么我如何在新屏幕中移植文本（在第一个屏幕的文本字段中）？

多谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:36:25.257

遵循 MVC 格式：

看法：

```
Ext.define('MyApp.view.FirstScreen', {
    extend: 'Ext.Panel',

    config: {
        items: [
            {
                xtype: 'textfield',
                itemId: 'textField1',
                label: 'Field'
            },
            {
                xtype: 'textfield',
                itemId: 'textField2',
                label: 'Field'
            },
            {
                xtype: 'button',
                itemId: 'mybutton1',
                text: 'click me'
            },
            {
                xtype: 'titlebar',
                docked: 'top',
                title: 'First Screen'
            }
        ]
    }

});    

// Client List (Second Screen)
Ext.define('MyApp.view.ClientList', {
    extend: 'Ext.Panel',
    alias: 'widget.clientlist',

    config: {
        itemId: 'clientList',
        items: [
            {
                xtype: 'titlebar',
                docked: 'top',
                title: 'Client List'
            }
        ]
    }

}); 
```

控制器：

```
Ext.define('MyApp.controller.MyController1', {
    extend: 'Ext.app.Controller',

    config: {
        refs: {
            textField1: '#textField1',
            textField2: '#textField2',
            clientList: {
                autoCreate: true,
                selector: '#clientList',
                xtype: 'clientlist'
            }
        },

        control: {
            "button#mybutton1": {
                tap: 'onMybutton1Tap'
            }
        }
    },

    onMybutton1Tap: function(button, e, options) {
        var me  = this,
            clientList = me.getClientList(),
            textField1_val = me.getTextField1().getValue(),
            textField2_val = me.getTextField2().getValue();

        Ext.Viewport.animateActiveItem(clientList,{ type:'flip'});

        // Do what you need to do with the values from your 
        // first screen in your client list
        clientList.setHtml('textField1_data: '+textField1_val+'<br>textField2_data: '+ textField2_val);
    }
}); 
```

# ruby-on-rails - 创建嵌套路由

> ID：14880376
> 
> 赞同：0
> 
> 时间：2013-02-14T17:16:08.800
> 
> 标签：ruby-on-rails, database, ruby-on-rails-3, routes

在我的应用程序中，我有有票的项目。我希望能够通过以下方式出示票证：

```
/projects/43/tickets 
```

此路线有效，但会显示所有票证，而不仅仅是属于该项目的票证。我需要改变什么？

**路线：**

```
resources :projects do
  resources :tickets do
    collection do
      get "manage"
    end 
  end
end 
```

**楷模：**

```
class Ticket < ActiveRecord::Base
  belongs_to :project
  ...
end

class Project < ActiveRecord::Base
  has_many :tickets, :dependent => :destroy
  ...
end 
```

工单通过以下方式连接到项目：

```
Tickets (table)
    project_id
    ...the rest of the fields... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:24:36.300

这是控制器逻辑，而不是路由逻辑。在`tickets_controller.rb`

```
def index
    @project = Project.find(params[:project_id])
    @tickets = @project.tickets
end 
```

现在，`@tickets`将包含当前项目的所有票证。

# xsd - XSD 1.1 替代使用问题

> ID：14880381
> 
> 赞同：1
> 
> 时间：2013-02-14T17:16:40.467
> 
> 标签：xsd, xsd-validation, xsd-1.1

我需要根据属性值对单一类型的节点进行特定的 XSD 验证：XSD 1.1 和 xsd:alternative 应该是我的朋友。

但是使用以下（最简单的）示例：

```
<xsd:complexType name="BaseType">
    <xsd:attribute name="type" 
                   type="xsd:string" 
                   use="required" />
</xsd:complexType>  

<xsd:complexType name="NamedType">
    <xsd:complexContent>
        <xsd:extension base="BaseType">
            <xsd:attribute name="path" 
                           type="xsd:string" 
                           use="required" />
        </xsd:extension>
    </xsd:complexContent>
</xsd:complexType>  

<xsd:complexType name="TaggedType">
    <xsd:complexContent>
        <xsd:extension base="BaseType">
            <xsd:attribute name="tag" 
                           type="xsd:string" 
                           use="required" />
        </xsd:extension>
    </xsd:complexContent>
</xsd:complexType>  

<xsd:element name="MyRoot">
    <xsd:complexType>
          <xsd:choice minOccurs="1">
            <xsd:element name="MyType" 
                         type="BaseType">
              <xsd:alternative test="@type='Named'" 
                               type="NamedType"/>
              <xsd:alternative test="@type='Tagged'" 
                               type="TaggedType"/>
            </xsd:element>
          </xsd:choice>
    </xsd:complexType>
</xsd:element> 
```

当我加载 XSD（使用 Qt 4.7.4 中的 QXmlSchema 类，但我认为这是一个 XSD 问题而不是 Qt 问题）时，我收到以下错误：

未知位置中的错误 XSDError，第 93 行第 74 列：替代元素的测试属性包含无效内容：{@type='Named'}。

我也在替代测试条件下尝试了“@type eq 'Named'”以及大量其他明智和不太明智的变化......没有通过：/

任何帮助都感激不尽！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:05:24.177

像 Petru Gardea 一样，我相信您的 XSD 架构很好（更重要的是，Saxon 也是如此）。

问题是您的 XSD 处理器不支持 XSD 1.1。QXmlSchema [Class Reference](http://doc.qt.digia.com/4.7-snapshot/qxmlschema.html)说“此类用于表示符合 XML Schema 1.0 规范的模式。” 错误消息可能会更清楚一些（通过抱怨 @type 而不是 xsd:alternative 它确实给出了错误的想法），但错误消息通常是这样，毕竟通常报告软件不准备处理的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T18:25:50.187

你的 XSD 对我来说似乎很好。我已经在 QTAssistant（最终基于 XSD 1.1 的 Xerces 版本）中尝试过它，它工作得很好。

使用此示例 XML：

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<!-- Sample XML generated by QTAssistant (http://www.paschidev.com) -->
<MyRoot xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://tempuri.org/XMLSchema.xsd">
    <MyType type="Tagged"/> 
</MyRoot> 
```

我得到：

```
Error while loading [], line 4 position 25
cvc-complex-type.4: Attribute 'tag' must appear on element 'MyType'.
Document1.xml is XSD 1.1 invalid. 
```

使用此 XML：

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<!-- Sample XML generated by QTAssistant (http://www.paschidev.com) -->
<MyRoot xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://tempuri.org/XMLSchema.xsd">
    <MyType type="Named"/>  
</MyRoot> 
```

我得到：

```
Error while loading [], line 4 position 24
cvc-complex-type.4: Attribute 'path' must appear on element 'MyType'.
Document1.xml is XSD 1.1 invalid. 
```

按照建议修复上述问题将产生有效的 XML 结果。你的语法是正确的，所以我只能责怪你的 XSD 处理器。

# ruby - 如何通过索引获取数组元素？

> ID：14880382
> 
> 赞同：1
> 
> 时间：2013-02-14T17:16:45.617
> 
> 标签：ruby

是否有任何可能的简短方法来执行此操作：

```
var1 = %w{sub1 sub2 sub3 sub4 sub5}
var2 = [1,4] 
```

我需要从 var1 返回 var2 的 1,4 个值。现在我的输出应该是*`["sub2", "sub5"]`*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T17:18:56.590

```
var1 = %w{sub1 sub2 sub3 sub4 sub5}
var2 = [1,4]

var1.values_at(*var2) # => ["sub2", "sub5"] 
```

# excel - 在列中搜索字符串并在连续行中打印结果

> ID：14880383
> 
> 赞同：2
> 
> 时间：2013-02-14T17:16:45.867
> 
> 标签：excel, vba

我有一列包含 .cpp 文件名列表，另一列表示测试用例。我想搜索工作表中与测试用例字符串匹配的所有行并从该行打印文件名。

```
column 1        column2 
--------       ------------    
file1.cpp      testcase1   
file2.cpp      testcase1   
file3.cpp      testcase3    
...             .......    
....            ....... 
```

所以最后我想要一个看起来像这样的输出：

```
Testcase1   Testcase2     
file4.cpp   file5.cpp    
file9.cpp   file8.cpp     
file5.cpp   file13.cpp 
```

这是vba代码：

```
Function fileToTest(Search_string As String, _
Search_in_col As Range)

Dim result As String   
Dim i As Long   
Dim j As Long   
Dim rArray(20) As String    
Dim rCnt As Long   
Dim rTmp As String   
Dim found As Long   
Dim testCases, Value As Variant   
Dim currentRow As Long    
Dim fCnt As Long    

  For i = 1 To Search_in_col.Count 'search each test case column    
     testCases = Split(Search_in_col.Cells(i, 1), ";")    
     For Each Value In testCases    
         If Search_string = Value Then    

        ActiveCell.Value = Search_in_col.Cells(i, 2).Value    
         ' write the next row after active cell. not sure how to do this
        End If   
      Next Value   
   Next i   

End Function 
```

当我尝试写入 ActiveCell.Value 时函数失败

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:13:14.360

您面临的问题是-根据您的评论-您想要一个用户定义的函数-然后尝试修改工作表。这是不可能的，因为 UDF 的体系结构是您不能对工作表进行任何更改，而只能使用您的函数返回一个值 - 然后显示该值。此外，在 UDF 中，除了作为参数传递的单元格之外，通常不允许读取任何其他单元格的值 - 否则这将导致 Excel 认为某处存在循环引用。

因此，我看到以下三个选项：

1.  修改你的 UDF
2.  创建一个宏，一次填充所有单元格
3.  仅使用 Excel 公式

以下是详细信息：

**1.修改你的UDF**

假设您在 A1 中输入“testcase1”，构建一个可以这样调用的 UDF：

```
=FileToTestCase(A1,1,SourceSheet!A2:A100,SourceSheet!B2:B100)

```

UDF 的 VBA 定义将是这样的：

```
Public Function FileToTestCase(sTestCaseName as String, iElementNumber as Integer, _
    rngFileNames as Range, rngTestcases as Range) as String
    CodeToFigure out the iElementNumer_th entry for sTestCaseName
    FileToTestCase = YourResult
 End Function 
```

然而，这种方法非常低效，因为您每次都需要解析源列表。您可以使用在第一次调用中初始化并稍后使用的一些内部、模块范围的变量来加速此过程 - 但是您需要注意检测更改。或者，您可以在一个大数组公式中执行此操作。但是，这两种方法都相当费力。

**2.创建一个宏，一次填充所有单元格**

您可以使用一个宏来一次性填充所有单元格，而不是 UDF。如果要自动更新内容，请从 Worksheet_Change 事件调用宏 - 每次源数据更改时。

这段代码应该这样做：

```
Sub FillTestcases(rngFiles As Range, rngTestcases As Range, rngStartResult As Range)
    Dim d As New Scripting.Dictionary
    Dim lRow As Long
    Dim sTestCase As Variant
    Dim sFile As Variant
    Dim rngResult As Range
    Const csSeparator As String = "|"

    For lRow = 1 To rngFiles.Rows.Count
        sTestCase = rngTestcases(lRow, 1).Value
        sFile = rngFiles(lRow, 1).Value
        If d.Exists(sTestCase) Then
            d(sTestCase) = d(sTestCase) & csSeparator & sFile
        Else
            d.Add sTestCase, sFile
        End If
    Next

    Set rngResult = rngStartResult
    For Each sTestCase In d.Keys
        rngResult.Value = sTestCase
        rngResult.Font.Bold = True
        lRow = 1
        For Each sFile In Split(d(sTestCase), csSeparator)
            rngResult.Offset(lRow) = sFile
            lRow = lRow + 1
        Next sFile
        Set rngResult = rngResult.Offset(, 1)
    Next sTestCase
End Sub 
```

请注意，您需要添加对*Microsoft Scripting Runtime*的引用才能使用 Dictionary 类。另请注意，此代码不会合并重复项，因此您可能需要对其进行调整。

**3\. 只使用 Excel 公式**

假设您的文件名在 A1:A10 中，B1:B10 中的测试用例和测试用例名称列表在第 1 行，从 F 列开始，在 F2 中使用此公式：

```
=IFERROR(INDEX($A$1:$A$10,-INT((大(($B$1:$B$10=F$1)-ROW($B$1:$B$10)/10000,ROW(F1)) -1)*10000)),"")

```

这是一个数组公式，所以用`Ctrl`- `Shift`-输入`Enter`。

！

# ruby-on-rails - 将小应用程序从 rails 3.1.3 迁移到 3.1.10

> ID：14880403
> 
> 赞同：0
> 
> 时间：2013-02-14T17:17:40.353
> 
> 标签：ruby-on-rails, migration

我正在尝试将 rails 应用程序从 3.1.3 迁移到 3.1.10

我在 gemfile 中将 3.1.3 更改为 3.1.10 并运行`bundle update rails`

尽管 gemfile 几乎是空的，但我有以下错误：

> Bundler 找不到 gem "multi_json" 的兼容版本：在 Gemfile: uglifier (>= 1.0.3) ruby​​ 依赖于 multi_json (~> 1.3) ruby
> 
> ```
> rails (= 3.1.10) ruby depends on
>   multi_json (1.2.0) 
> ```

这是我的宝石文件：

```
source 'http://rubygems.org'

gem 'rails', '3.1.10'

# Bundle edge Rails instead:
# gem 'rails',     :git => 'git://github.com/rails/rails.git'

gem 'sqlite3'
gem 'rails_admin'
gem 'devise'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'coffee-rails', '~> 3.1.1'
  gem 'uglifier', '>= 1.0.3'
end

gem 'sass-rails',   '3.1.5'

gem 'jquery-rails'
gem 'therubyracer'

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# Use unicorn as the web server
# gem 'unicorn'

# Deploy with Capistrano
gem 'capistrano'

# To use debugger
# gem 'ruby-debug19', :require => 'ruby-debug'
#gem for images
gem 'paperclip' 
```

Uglifier 是默认存在的 gem，rails 3.1.3 添加的 gem 怎么可能需要 3.1.10 需要的更新的 gem（1.2.0）！

我该如何迁移？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T11:55:44.857

创建一个新项目。然后编辑新的 gem 文件以反映新的 rails 版本。将旧 gem 文件的内容复制到新文件，rails 除外。执行捆绑安装。将旧项目复制到新项目中。捆绑它并再次执行 rake db:migrate。

希望这可以帮助。

# python - 为什么一些 Python 函数在参数列表周围有一组额外的括号？

> ID：14880406
> 
> 赞同：11
> 
> 时间：2013-02-14T17:17:48.977
> 
> 标签：python, arguments, parentheses

我见过一些这样写的 Python 函数：

```
def get_year((year,prefix,index,suffix)):
  return year 
```

这与没有额外括号的其他函数有何不同（如果有的话）：

```
def do_format(yr,pfx,id,sfx):
  return "%s %s %s/%s"%(yr, id, pfx, sfx) 
```

还是只是样式的品味问题，或者如果它们不同，是否可以将 get_year() 重写为 do_format() 的样式，反之亦然，而不影响现有调用者的语法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-14T17:18:50.993

第一个函数接受一个元组参数，而第二个函数接受 4 个参数。您可以单独传递这些参数，也可以将这些参数作为带有`splat`运算符的元组传递，这会将元组解包为单独的参数。

例如：

```
# Valid Invocations
print do_format(*('2001', '234', '12', '123'))  # Tuple Unpacking
print do_format('2001', '234', '12', '123')     # Separate Parameter
print get_year(('2001', '234', '12', '123'))

# Invalid invocation. 
print do_format(('2001', '234', '12', '123'))   # Passes tuple 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-14T18:11:55.257

您的示例中的`get_year`函数使用自动解包的元组参数（这是 Python 3 中的功能）。要调用它，你给它一个参数，这个参数应该是一个包含四个值的序列。

```
# Invocation
my_input = [2013, 'a', 'b', 'c'] # sequence does NOT have to be a tuple!
my_year = get_year(my_input) # returns 2013 
```

要为 Python 3 重写此代码但不更改调用（换句话说，不破坏调用 的现有代码`get_year`）：

```
def get_year(input_sequence):
    year, prefix, index, suffix = input_sequence
    return year 
```

以上本质上是元组解包自动为您做的事情。在这种特殊情况下，您可以简单地编写

```
def get_year(input_sequence):
    return input_sequence[0] 
```

如需更多信息，请阅读[PEP 3113](http://www.python.org/dev/peps/pep-3113/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T18:26:09.977

这些都是等效的（调用者不必更改）：

```
# 2.x unpacks tuple as part of the function call, 3.x raises exception
def get_year((year,prefix,index,suffix)):
    """get year from (year, prefix, index, suffix) tuple"""
    return year

# 2.x and 3.x, you unpack tuple in the function call
def get_year(year_tuple):
    """get year from (year, prefix, index, suffix) tuple"""
    year, prefix, index, suffix = year_tuple
    return year

# 2.x and 3.x, speedier because you don't unpack what you don't need
def get_year(year_tuple):
    """get year from (year, prefix, index, suffix) tuple"""
    return year_tuple[0] 
```

# django - 为什么 Django 文档建议为静态文件使用单独的服务器？

> ID：14880407
> 
> 赞同：23
> 
> 时间：2013-02-14T17:17:53.157
> 
> 标签：django, apache, http, mod-wsgi

从[mod_wsgi 页面上的 Django](https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/modwsgi/)：

> 我们建议使用单独的 Web 服务器——即不运行 Django 的服务器——来提供媒体服务。

为什么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-14T17:27:52.583

一般而言，将静态内容（例如图像、CSS 和 JS 文件）放在不同的服务器上，此外，放在不同的域/子域上是个好主意。这允许为静态文件提供服务的软件得到高度优化和极快的速度（例如，[nginx](http://en.wikipedia.org/wiki/Nginx)）。

另一个主要好处来自网络流量的减少。如果您从与动态 Django 应用程序相同的域中提供静态内容，那么客户端浏览器会将您域的 cookie 作为其 HTTP 请求的一部分发送，即使对于静态文件也是如此。这是不必要的开销 - 静态文件将始终是静态的 - 但这是必需的，因为客户端无法区分静态和动态内容之间的区别。另一方面，如果静态内容是从不同的域提供的，则可以将其配置为“无[cookie 域](https://developers.google.com/speed/docs/best-practices/request)”，从而最大限度地减少请求开销。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-14T17:27:49.643

这是 Web 框架中常见的策略。这里的想法是简单地使用最好的工具来提供静态内容。Apache、Nginx、lighttpd 和其他现代网络服务器都非常擅长提供静态内容，因此如果您可以轻松配置这些服务器来完成这项工作，您将获得以下好处：

1.  这些请求正在飞速发展。
2.  您不会占用重量级的 python 进程来执行平凡的任务，因此它们可以自由地处理应用程序请求。
3.  以后，通过使用这个单独的过程来处理静态内容，您在使用 CDN 或将资产传播到其他服务器方面具有更大的灵活性。

通过将媒体移动到特定目录，您可以更轻松地为此任务配置网络服务器。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-14T18:36:59.480

这对安全也有好处。一个非常简单的方法是让用户上传的文件远离您的核心服务器文件。单独的文件夹权限等。但是，是的，速度优势很大。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-02-14T17:30:19.877

从单个主机下载资产时，现代 Web 浏览器通常会打开两个（几个？）套接字。所以你会得到`index.html`哪些引用了一堆图像、js 文件、css 等。每个额外的文件都由一个阻塞套接字下载。

如果您从单独的主机中提取静态文件，您将获得额外的两个套接字来下载文件 - 因此在生产中这工作得更快。

这种并行化还允许您运行不同的服务器引擎（好吧，它们可以在同一个盒子上 - 但你仍然只能获得两个套接字），专门处理它们所服务的内容 - 例如原始`nginx`内容和动态内容。`fastcgi``django`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-10T19:29:17.113

从技术和理论的角度来看，这里的答案肯定都是正确的。但实际上，对于绝大多数 Django 部署，我什至不会考虑为媒体和 Django 应用程序使用单独的服务器（即机器、虚拟或物理）。只是没有必要。它是[过早的优化](http://c2.com/cgi/wiki?PrematureOptimization)——“万恶之源”。

相反，我会使用一个通用的 httpd 服务器（Apache、nginx、...）进行部署，让它通过 WSGI/FastCGI 运行应用程序，**并**让它也提供静态和媒体文件。这行得通。您可以避免很多麻烦，特别是如果您考虑为用户媒体使用单独的服务器。

如果您的网站成功到足以出现性能问题，您将很乐意修复它。您的第一步甚至可能只是租用更快的服务器。

这至少适用于您唯一关心的问题与性能相关的情况。出于安全原因，您可能必须使用单独的服务器，甚至可能是因为您的客户需要它。

# themes - 下划线在 Sublime Text 2 主题中不起作用

> ID：14880408
> 
> 赞同：5
> 
> 时间：2013-02-14T17:17:53.867
> 
> 标签：themes, sublimetext2

我在 OSX 10.8.2 上使用[ST2 build 2217 。](http://www.sublimetext.com/)其他一切都很好，除了我无法下划线工作。这是我的主题文件中的一个示例：

```
<dict>
    <key>name</key>
    <string>Language Constant</string>
    <key>scope</key>
    <string>constant.language</string>
    <key>settings</key>
    <dict>
        <key>fontStyle</key>
        <string>bold italic underline</string>
        <key>foreground</key>
        <string>#FF1308</string>
    </dict>
</dict> 
```

在 ST2 中，Python 语言常量如***`True`***or***`False`***以红色显示，带有粗斜体文本，如预期的那样，但不像在[TextMate](http://www.macromates.com)中那样带下划线。语言或上下文无关紧要，我无法下划线工作。唯一有效的是括号匹配，它确实显示了匹配对的细下划线。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T19:12:01.230

它可能不受支持，尽管我不是主题方面的专家。您可能想在 ST 论坛（[链接](http://www.sublimetext.com/forum/)）上提问。我认为更多的 ST 用户看那里而不是这里。

我刚刚在 ST3 (W7) 中进行了测试，但似乎没有下划线。下一个最好的事情是我想提出一个功能请求。

编辑：

我已将我的插件（[链接](https://github.com/skuroda/PersistentRegexHighlight)）更新为下划线。如果您有任何问题，请在 github 页面上创建问题。不过有点警告，它不是最有效的插件（我需要改进），所以如果你有大文件，可能会有一些性能下降。

![样本](../Images/37244260551341065ccc07e58e9dd08c.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T19:45:56.437

如果你不介意额外的开销，你可以试试这个技巧

```
 # To underline a region, we use a "hack" specific to SublimeText
  # where we create a list of empty regions for each character
  # which we want to underline.  When drawing with
  # sublime.DRAW_EMPTY_AS_OVERWRITE, such empty regions
  # will appear as underlined.

  line = view.full_line(view.text_point(lineno, 0))
  position += line.begin()

  for i in xrange(length):
     underline.append(sublime.Region(position + i)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T16:03:44.410

从我所能找到的一点点来看，似乎下划线还没有在 ST2 或 ST3 中实现。我已经在 userecho 上提交了一个[功能请求](http://sublimetext.userecho.com/topic/153925-implement-underline-as-part-of-fontstyle-in-tmtheme/)，所以我们会看看它的去向。如果您也喜欢此功能，请为它投票！

# jaxb - 无法创建 DynamicJAXBContext - 从 GML 模式引导时出现问题

> ID：14880410
> 
> 赞同：2
> 
> 时间：2013-02-14T17:17:57.237
> 
> 标签：jaxb, eclipselink, moxy

* * *

**根据下面的回复，用我的最新示例更新这篇文章。**

* * *

我正在尝试使用 MOXY 创建一个 DynamicJAXBContext 使用一个简单的模式，该模式使用 GML 2.1.2 模式（导入 xlink）。似乎 moxy 在导入 GML 模式（或 GML 导入的 xlink 模式）时遇到问题。我尝试向 DynamicJAXBContextFactory 提供 jaxb 绑定文件，但这不起作用。

我正在使用 eclipselink 2.4.2（**每晚 2/20**）和 jaxb-xjc 2.1.12。正在生成的异常如下：

> 异常 [EclipseLink-0]（Eclipse 持久性服务 - 2.4.2.v20130220-bf58d47）：org.eclipse.persistence.exceptions.IntegrityException 描述符
> 
> ## 例外：
> 
> 异常 [EclipseLink-217] (Eclipse Persistence Services - 2.4.2.v20130220-bf58d47)：org.eclipse.persistence.exceptions.DescriptorException 异常描述：XMLDirectMapping/XMLCompositeDirectCollectionMapping 的 XPath 无效。XPath 必须包含属性的@ 符号或以/text() 结尾的文本节点。例如：“@name”或“name/text()” 映射：org.eclipse.persistence.oxm.mappings.XMLDirectMapping[title-->ns2:title] 描述符：XMLDescriptor(org.w3._1999.xlink.Extended --> [])
> 
> 异常 [EclipseLink-217] (Eclipse Persistence Services - 2.4.2.v20130220-bf58d47)：org.eclipse.persistence.exceptions.DescriptorException 异常描述：XMLDirectMapping/XMLCompositeDirectCollectionMapping 的 XPath 无效。XPath 必须包含属性的@ 符号或以/text() 结尾的文本节点。例如：“@name”或“name/text()” 映射：org.eclipse.persistence.oxm.mappings.XMLDirectMapping[xlinkTitle1-->ns2:title] 描述符：XMLDescriptor(org.w3._1999.xlink.LocatorType --> [DatabaseTable(ns2:locator)])
> 
> 异常 [EclipseLink-217] (Eclipse Persistence Services - 2.4.2.v20130220-bf58d47)：org.eclipse.persistence.exceptions.DescriptorException 异常描述：XMLDirectMapping/XMLCompositeDirectCollectionMapping 的 XPath 无效。XPath 必须包含属性的@ 符号或以/text() 结尾的文本节点。例如：“@name”或“name/text()” 映射：org.eclipse.persistence.oxm.mappings.XMLDirectMapping[xlinkTitle2-->ns2:title] 描述符：XMLDescriptor(org.w3._1999.xlink.ArcType --> [数据库表(ns2:arc)])
> 
> ## 运行时异常：
> 
> 在 org.eclipse.persistence.internal.sessions.DatabaseSessionImpl.initializeDescriptors(DatabaseSessionImpl.java:638) 在 org.eclipse.persistence.internal.sessions.DatabaseSessionImpl.initializeDescriptors(DatabaseSessionImpl.java:574) 在 org.eclipse.persistence.internal .sessions.DatabaseSessionImpl.initializeDescriptors(DatabaseSessionImpl.java:533) 在 org.eclipse.persistence.internal.sessions.DatabaseSessionImpl.postConnectDatasource(DatabaseSessionImpl.java:777) 在 org.eclipse.persistence.internal.sessions.DatabaseSessionImpl.login(DatabaseSessionImpl .java:735) 在 org.eclipse.persistence.oxm.XMLContext$XMLContextState.(XMLContext.java:940) 在 org.eclipse.persistence.oxm.XMLContext$XMLContextState.(XMLContext.java:915) 在 org.eclipse。 org.eclipse 上的 persistence.oxm.XMLContext.(XMLContext.java:194)。persistence.jaxb.dynamic.DynamicJAXBContext$SchemaContextInput.createContextState(DynamicJAXBContext.java:332) 在 org.eclipse.persistence.jaxb.JAXBContext.(JAXBContext.java:169) 在 org.eclipse.persistence.jaxb.dynamic.DynamicJAXBContext.( DynamicJAXBContext.java:70) 在 org.eclipse.persistence.jaxb.dynamic.DynamicJAXBContextFactory.createContextFromXSD(DynamicJAXBContextFactory.java:309) 在 ogc.catalog.moxy.TestMoxy.testMoxy(TestMoxy.java:45)java:309) 在 ogc.catalog.moxy.TestMoxy.testMoxy(TestMoxy.java:45)java:309) 在 ogc.catalog.moxy.TestMoxy.testMoxy(TestMoxy.java:45)

这是我的测试moxy类：

```
import java.io.InputStream;
import java.util.HashMap;
import java.util.Map;

import javax.xml.bind.JAXBException;
import javax.xml.transform.Source;
import javax.xml.transform.stream.StreamSource;

import org.eclipse.persistence.jaxb.dynamic.DynamicJAXBContext;
import org.eclipse.persistence.jaxb.dynamic.DynamicJAXBContextFactory;
import org.junit.Test;

public class TestMoxy {

    private static final String SCHEMA = "example-feature.xsd";

    @Test
    public void testMoxy() throws JAXBException {

        System.setProperty("javax.xml.bind.context.factory",
                "org.eclipse.persistence.jaxb.DynamicJAXBContextFactory");

        System.setProperty("com.sun.tools.xjc.api.impl.s2j.SchemaCompilerImpl.noCorrectnessCheck",
                "true");

        InputStream schema = this.getClass().getClassLoader().getResourceAsStream(SCHEMA);

        Source schemaSource = new StreamSource(schema);
        schemaSource.setSystemId(SCHEMA);

        InputStream xjbStream = this.getClass().getClassLoader()
                .getResourceAsStream("xlink-bindings.xjb");
        Source xjbSource = new StreamSource(xjbStream);
        xjbSource.setSystemId(SCHEMA);

        Map<String, Object> props = new HashMap<String, Object>();
        props.put(DynamicJAXBContextFactory.EXTERNAL_BINDINGS_KEY, xjbSource);

        try {
            DynamicJAXBContext jaxbContext = DynamicJAXBContextFactory.createContextFromXSD(
                    schemaSource, null, null, props);

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

这是example-feature.xsd：

```
<?xml version='1.0' encoding='UTF-8'?>
<xsd:schema elementFormDefault='qualified' targetNamespace='http://example.org' 
    xmlns:example='http://example.org' 
    xmlns:xsd='http://www.w3.org/2001/XMLSchema' 
    xmlns:gml='http://www.opengis.net/gml'>
    <xsd:import namespace='http://www.opengis.net/gml' schemaLocation="http://schemas.opengis.net/gml/2.1.2/feature.xsd"/>
    <xsd:complexType name='example_featureType'>
        <xsd:complexContent>
            <xsd:extension base='gml:AbstractFeatureType'>
                <xsd:sequence>
                    <xsd:element maxOccurs='1' minOccurs='1' name='id' nillable='false' type='xsd:long'/>
                    <xsd:element maxOccurs='1' minOccurs='1' name='version' nillable='false' type='xsd:long'/>
                    <xsd:element maxOccurs='1' minOccurs='0' name='access_date' nillable='true' type='xsd:dateTime'/>
                    <xsd:element maxOccurs='1' minOccurs='0' name='ground_geom' nillable='true' type='gml:PolygonPropertyType'/>
                </xsd:sequence>
            </xsd:extension>
        </xsd:complexContent>
    </xsd:complexType>
    <xsd:element name='exampleFeature' substitutionGroup='gml:_Feature' type='example:example_featureType'/>
</xsd:schema> 
```

和 xlink-bindings.xjb：

```
<jaxb:bindings version="1.0" xmlns:jaxb="http://java.sun.com/xml/ns/jaxb" xmlns:xs="http://www.w3.org/2001/XMLSchema"
    xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc" jaxb:extensionBindingPrefixes="xjc">
    <jaxb:bindings schemaLocation="http://www.w3.org/1999/xlink.xsd">
        <jaxb:bindings node="//xs:attributeGroup[@name='locatorAttrs']//xs:attribute[@ref='xlink:title']">
            <jaxb:property name="xlink:title1" />
        </jaxb:bindings>
        <jaxb:bindings node="//xs:attributeGroup[@name='arcAttrs']//xs:attribute[@ref='xlink:title']">
            <jaxb:property name="xlink:title2" />
        </jaxb:bindings>
    </jaxb:bindings>

    <jaxb:bindings schemaLocation="http://schemas.opengis.net/gml/2.1.2/feature.xsd"
        node="/xs:schema">
        <jaxb:globalBindings fixedAttributeAsConstantProperty="false"
            typesafeEnumBase="xs:string" typesafeEnumMemberName="generateName" generateIsSetMethod="true"
            generateMixedExtensions="true">
            <xjc:noValidator />
            <xjc:noValidatingUnmarshaller />
        </jaxb:globalBindings>

        <jaxb:schemaBindings>
            <jaxb:package name="ogc.schema.opengis.gml.v_2_1_2" />
            <jaxb:nameXmlTransform>
                <jaxb:elementName suffix="Element" />
            </jaxb:nameXmlTransform>
        </jaxb:schemaBindings>
        <jaxb:bindings node="xs:element[@name='_geometryProperty']">
            <jaxb:class name="AbstractGeometryProperty" />
        </jaxb:bindings>
    </jaxb:bindings>
</jaxb:bindings> 
```

**注意**xjc 对我有用： xjc -extension example-feature.xsd -b xlink-bindings.xjb

*xjc 版本“JDK 6 中的 JAXB 2.1.10”* *java 版本“1.6.0_38”*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T21:36:16.080

我能够使用这个绑定文件让 xjc v2.1.10 编译器工作：

```
<jaxb:bindings version="1.0" xmlns:jaxb="http://java.sun.com/xml/ns/jaxb"
xmlns:xs="http://www.w3.org/2001/XMLSchema" 
xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc" 
jaxb:extensionBindingPrefixes="xjc">

<jaxb:bindings schemaLocation="http://schemas.opengis.net/gml/2.1.2/feature.xsd"
    node="/xs:schema">
    <jaxb:schemaBindings>
        <jaxb:package name="ogc.schema.opengis.gml.v_2_1_2" />
        <jaxb:nameXmlTransform>
            <jaxb:elementName suffix="Element" />
        </jaxb:nameXmlTransform>
    </jaxb:schemaBindings>
    <jaxb:bindings node="xs:element[@name='_geometryProperty']">
        <jaxb:class name="AbstractGeometryProperty" />
    </jaxb:bindings>
</jaxb:bindings>

<jaxb:bindings schemaLocation="http://www.w3.org/1999/xlink.xsd">
    <jaxb:bindings
        node="//xs:attributeGroup[@name='locatorAttrs']//xs:attribute[@ref='xlink:title']">
        <jaxb:property name="xlink:title1" />
    </jaxb:bindings>
    <jaxb:bindings
        node="//xs:attributeGroup[@name='arcAttrs']//xs:attribute[@ref='xlink:title']">
        <jaxb:property name="xlink:title2" />
    </jaxb:bindings>
</jaxb:bindings> 
```

但是当我尝试运行 java 测试时，我得到：

```
java.lang.NullPointerException
at org.eclipse.persistence.jaxb.compiler.AnnotationsProcessor.processXmlSeeAlso(AnnotationsProcessor.java:1201)
at org.eclipse.persistence.jaxb.compiler.AnnotationsProcessor.preBuildTypeInfo(AnnotationsProcessor.java:555)
at org.eclipse.persistence.jaxb.compiler.AnnotationsProcessor.processClassesAndProperties(AnnotationsProcessor.java:267)
at org.eclipse.persistence.jaxb.compiler.Generator.<init>(Generator.java:104)
at org.eclipse.persistence.jaxb.dynamic.DynamicJAXBContext$SchemaContextInput.createContextState(DynamicJAXBContext.java:316)
at org.eclipse.persistence.jaxb.JAXBContext.<init>(JAXBContext.java:157)
at org.eclipse.persistence.jaxb.dynamic.DynamicJAXBContext.<init>(DynamicJAXBContext.java:70)
at org.eclipse.persistence.jaxb.dynamic.DynamicJAXBContextFactory.createContextFromXSD(DynamicJAXBContextFactory.java:302)
at ogc.common.schema.test.TestMoxy.testEntityResolver(TestMoxy.java:92)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

不确定这是否有帮助。

-基思

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:45:44.860

我一直在查看您的问题，但也无法使其正常工作。我尝试使用 XJC 模式编译器，但它也存在模式冲突问题，并且 EclipseLink 依赖于 XJC 来创建动态 JAXB 上下文。

首先，当我在 Eclipse 中运行你的测试用例时，我得到了一个稍微不同的错误：

```
com.sun.istack.SAXParseException2: Property "Title" is already defined. Use &lt;jaxb:property> to resolve this conflict. 
```

但是我看到在您的绑定文件中，您已经在使用 jaxb:property 作为标题（小写），并且我在任何相关的 XSD 中都找不到任何标题（大写）。

其次，当我运行 XJC 时，我得到：

```
C:\...\src\omar>xjc example-feature.xsd -b xlink-bindings.xjb
parsing a schema...
compiling a schema...
[ERROR] Two declarations cause a collision in the ObjectFactory class.
  line 28 of http://schemas.opengis.net/gml/2.1.2/feature.xsd

[ERROR] (Related to above error) This is the other declaration.
  line 29 of http://schemas.opengis.net/gml/2.1.2/feature.xsd

Failed to produce code. 
```

但这也很奇怪，因为 feature.xsd 的第 29 行是：

```
<element name="geometryProperty" type="gml:GeometryAssociationType"/> 
```

但我找不到与geometryProperty 的任何冲突。

希望这些信息足以让您获得一个绑定文件，以便让 XJC 正常工作。此时，您应该能够引导 DynamicJAXBContext。xjc 可执行文件位于您的 JAVA_HOME\bin 目录中。

*   瑞克

# cordova - IBM Worklight Cordova ChildBrowser 错误

> ID：14880414
> 
> 赞同：0
> 
> 时间：2013-02-14T17:18:05.907
> 
> 标签：cordova, xcode4.5, ibm-mobilefirst

我正在使用“ [http://clearblade.wordpress.com/2012/07/31/using-worklight-with-cordova-childbrowser-plugin/#comment-152](http://clearblade.wordpress.com/2012/07/31/using-worklight-with-cordova-childbrowser-plugin/#comment-152) ”这个 url 来访问 iPhone.these 中的 IBM Worklight Corodova ChildBrowser 功能如果我们只有 xcode 项目，步骤运行良好，从 Worklight 生成时遇到错误。![在此处输入图像描述](../Images/839fe074d151fb0b2b1632c63b87f3bd.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:51:08.763

好吧，马上，我可以看到您缺少 Plugins 文件夹。看看这个教程，它会一步一步地引导你如何去做： http: [//moduscreate.com/opening-all-urls-with-phonegaps-childbrowser-plugin/](http://moduscreate.com/opening-all-urls-with-phonegaps-childbrowser-plugin/)

我还写了一篇关于我是如何做到的帖子，其中包括该帖子上的步骤。

最后，请记住，当您在 Xcode 中工作时，您正在更改 WL 文件夹/文件，因此您需要在 WL Studio/Eclipse 中运行之前重新构建应用程序。

# c# - 使用 Linq 更新 NVarChar(MAX) 列导致错误

> ID：14880416
> 
> 赞同：3
> 
> 时间：2013-02-14T17:18:07.210
> 
> 标签：c#, linq

我正在尝试使用 C# 中的 Linq 对数据库中的现有值进行更新。

我实例化变量：

```
var projectTrackingEntity = context.project_trackings.Single(pt => pt.project_id == projectId); 
```

然后我更新操作列（它是一个`NVarChar(MAX)`），但我正在检查它是否已经有一个操作。如果是这样，我只是用分号添加它，例如。动作1；动作2

当我打电话时：

```
context.SubmitChanges(); 
```

调试时出现此错误：

> System.NotSupportedException：SQL Server 不处理 NText、Text、Xml 或 Image 数据类型的比较。

我试过设置`UpdateCheck = UpdateCheck.Never`，但这并不能解决问题。

编辑：添加我更新动作的代码（变量“动作”是一个字符串）

```
var actions = projectTrackingEntity.action.Split(';');
bool equalActions = false;
foreach (string a in actions)
{
    if (string.Equals(a, action, StringComparison.CurrentCultureIgnoreCase))
    {
        equalActions = true;
        break;
    }
}
if(!equalActions)
{
    projectTrackingEntity.action = string.IsNullOrEmpty(projectTrackingEntity.action) ? //if
        action : //true
        projectTrackingEntity.action + ';' + action; //false
}

context.SubmitChanges(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T17:44:27.130

**方法一：**

为了解决这个问题，只需`open the dbml file`使用`xml editor`并设置`updatecheck to Never`如下：

```
<column canbenull="true" dbtype="Xml" name="PermissionsXml" type="System.Xml.Linq.XElement" updatecheck="Never"></column> 
```

**方法二：**

将您的字段更改为`VARCHAR(max)`

**方法三：**

将 UpdateCheck 更改为`UpdateCheck.WhenChanged`

我希望这对你有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:51:09.340

几乎似乎您的 DAL 类在其自动检测中将该属性作为错误类型拾取？您可以手动指定该类型`NVARCHAR(MAX)`在设计器中，而不是它可能认为的任何其他类型吗？

# makefile - 在 makefile 之间共享变量

> ID：14880419
> 
> 赞同：14
> 
> 时间：2013-02-14T17:18:13.530
> 
> 标签：makefile

我有一个目录结构，我希望我的主文件夹中有一个主 makefile，然后我的 test 和 src 文件夹中有另一个 makefile。

在我的主 makefile 中，我有两个 test / all 的指令，它们调用单个文件夹 makefile。我正在尝试在我的主 makefile 中声明变量，并让其他文件夹可以访问它们。

例如在我的主 Makefile

```
PACKAGES = jansson mysql ....

all:
    do something here

test:

    cd test
    make test 
```

然后在我的 test/Makefile 中，我希望能够访问以前的 PACKAGES 变量并将这个 makefile 的各个依赖项添加到它上面。

在测试/Makefile

```
PACKAGES += googletest googlemock

test
     do something here 
```

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-14T17:21:17.533

您可以创建另一个文件，例如`Makefile.variable`在其中定义了这些共享变量并使用包含该文件

```
include $(PATHTOSHAREDMAKEFILE)/Makefile.variable 
```

查看[包含手册](http://www.gnu.org/software/make/manual/html_node/Include.html)以获取更多信息

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-14T17:20:11.333

您可以在命令行上传递变量：

```
test:
    make -C test PACKAGES="$(PACKAGES)" 
```

请注意，尽管反过来是不可能的。如果`test/Makefile`更改了变量，则这些更改无法返回到调用 makefile。

* * *

如果要添加到`PACKAGES`主 makefile 中的变量，则必须重构构建系统以包含子 makefile。因此，主 makefile 设置了所有内容，然后包括（使用`include`大多数 make 实现中可用的指令）子 makefile，这些子 makefile 将特定目标添加到它们，以及更改/添加变量。

例如，假设您有两个测试目录，`test_foo`并且`test_bar`您可以有一个包含测试目标的变量，让我们调用它`TEST_TARGETS`。文件夹中的每个 makefile`test_*`将其本地和唯一目标添加到全局变量，然后主 makefile 可以运行它们。

像这样的东西：

主要生成文件：

```
# Start empty
TEST_TARGETS =

include test_foo/Makefile
include test_bar/Makefile

test:
    for target in "$(TEST_TARGETS)"; do \
        $(MAKE) $(target); \
    done 
```

test_foo/Makefile：

```
TEST_TARGETS += test_foo

test_foo:
    # Do some foo testing 
```

测试栏/生成文件：

```
TEST_TARGETS += test_bar

test_bar:
    # Do some bar testing 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-05-10T06:00:33.690

导出 PACKAGES = jansson mysql ....

# android - Arduino 摄像头模块视频到 Android 屏幕

> ID：14880421
> 
> 赞同：2
> 
> 时间：2013-02-14T17:18:20.197
> 
> 标签：android, camera, arduino

我正在尝试将相机模块连接到我的 Arduino Mega，将我的 Mega 连接到我的 Android 手机（通过[蓝牙](http://en.wikipedia.org/wiki/Bluetooth)或其他方式）并将相机的实时视图发送到手机。

我在网上看到[了一段视频](http://www.youtube.com/watch?v=qEVXqOJz-GY)，其中显示了静态图像 - Arduino 上的相机模块捕获的图像被发送到 Android，几秒钟后查看输出图像（通过蓝牙发送图像的时间）。

这对实时视频而不是图像可行吗？如果是，如何？如果没有，有哪些解决方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T19:22:10.683

我不认为你可以做实时视频——Arduino 上的串行带宽不是很高。它的最大值为每秒 115200 位。要获得每秒字节数，除以 10（通常为 8 + 2 位开销），即为每秒 11.5 KB。

一帧 640 x 480 视频是 640 x 480 x 3（每个颜色分量 RGB 一个字节）大约是 1000 KB。[JPEG](http://en.wikipedia.org/wiki/JPEG)相机使用[M-JPEG](http://en.wikipedia.org/wiki/Motion_JPEG)，它可以为您提供大约 20:1 的压缩率（[请参阅 Wikipedia 文章](http://en.wikipedia.org/wiki/Motion_JPEG#Encoding)），因此这可能会压缩到大约 1000K / 20 = 50K。所以相机需要以每秒11.5KB的速度传输50K，所以传输一帧至少需要四秒。然后它需要通过[蓝牙传输](http://en.wikipedia.org/wiki/Bluetooth)或其他一些串行通信，至少需要四秒钟，所以总共八秒钟。您可能可以更快地并行执行此操作以使其总共达到 4 秒，但我对此表示怀疑，因为 Mega 芯片仅以 16 MHz 运行，因此在高度理想化的世界中，它最多只能处理 16 KB/秒。

在视频中，图像从相机到手机大约需要 10 秒，这与 8 秒的估计相当吻合。

您可以尝试较小的图像 - 比如 320 x 240，带有灰度（如果相机可以做到的话）。这将字节数减少了 12 倍，因此您每秒可能会获得 1.5 帧。

也许更好的解决方案是使用[Raspberry Pi](http://en.wikipedia.org/wiki/Raspberry_Pi)，它具有 1 GHz 处理器和 USB 2.0[最高速度 280 Mbits/s](http://en.wikipedia.org/wiki/Universal_Serial_Bus#USB_2.0_.28High_Speed.29)，比 115200 bit/s 快一千多倍。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-30T16:07:39.727

这是不可能的。你可以试试我的例子。通过蓝牙 4.0 将 320x240 图像传输到 Android 手机需要 15 秒。 [http://privateblog.by/peredacha-kartinki-s-ov7670-cherez-arduino-uno-na-android-telefon/](http://privateblog.by/peredacha-kartinki-s-ov7670-cherez-arduino-uno-na-android-telefon/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T11:50:17.557

这是我设法解决问题的方法，我安装了旧的野火[IP网络摄像头](https://play.google.com/store/apps/details?id=com.pas.webcam)，从我的nexus4设置了一个wifi热点，从野火连接到它，获取了野火的IP并将其放入nexus4的网络查看器中。

# c# - 将多个 WMIC 命令输出到同一个文件

> ID：14880422
> 
> 赞同：0
> 
> 时间：2013-02-14T17:18:21.217
> 
> 标签：c#, javascript, windows, visual-studio-2010, wmic

我想知道是否有办法将多个 WMIC 命令输出到同一个文件。我想在下面运行这些命令，但想在同一个文件中输出结果。

```
wmic /node:"pcname" /USER:"username" /PASSWORD:"pwd"/output:c:\file1.htm  csproduct list full/format:hform.xsl

wmic /node:"pcname" /USER:"username" /PASSWORD:"pwd"/output:c:\file1.htm  bios list full/format:hform.xsl 
```

我希望将信息一个接一个地输出到同一个文件中。

# python - python3 - os.path 更改

> ID：14880424
> 
> 赞同：0
> 
> 时间：2013-02-14T17:18:25.497
> 
> 标签：python, python-3.3, os.path

我`python 3.3`在 Windows 7 中使用。

python文件，`main.py`在`D:\my proj\$MY\1`

我在该文件中编写了以下代码：

```
import os

file_usage = "usage.txt"
p1 = os.getcwd()
print ("os.getcwd(): ", p1)

p5 = os.path.join(p1,"report")
print ("os.path.join: ", p5)

file = open(file_usage, "a")
file.write ("*****BLAH-BLAH*****")
file.close() 
```

所以，当我在 cmd 中运行我的程序时，它会给出如下输出：

```
os.getcwd():  D:\my proj\$MY\1
os.path.join:  D:\my proj\$MY\1\report 
```

现在，`usage.txt`文件在我所在的目录中生成`main.py`意味着在`1`文件夹内。

但是我试图修改它应该保存在`report`文件夹中的路径，因为你可以看到`os.path.join`.

所以，我想将生成`usage.txt`的文件保存在`report`文件夹中，而不是`1`. 我应该做哪些类型的更改？或者我需要使用哪些其他模块？

我是新手用户。因此，请尝试深入告诉我或向我发送链接，我可以从中获得更多与此相关的知识或示例。我正在等待您的回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:36:58.557

```
open(os.path.join(p5, "usage.txt"), "w") 
```

由于`p5`是报告目录的路径，这将`usage.txt`在该目录中打开一个文件。

# java - 在绘制方法实现中减小了多边形的大小

> ID：14880428
> 
> 赞同：2
> 
> 时间：2013-02-14T17:18:33.427
> 
> 标签：java, applet, drawing, polygon, paint

我在 JAVA 小程序中制作了一个程序。该程序用 4 个随机生成的点绘制一个多边形`A`，然后用 4 个随机生成的点绘制另一个多边形`B`。在此之后，它比较每个多边形的每个点以查看它们是否相同。如果不是，那就`A[0] > B[0]`说吧`A[0]--`。直到旧多边形的所有点都`A`变成新多边形`B`。然后它重复。

所以我遇到的问题是，由于某种原因，多边形变得越来越小。

这是我的代码：

```
package some.package.games;

import java.applet.Applet;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Color;
import java.awt.Polygon;
import java.awt.geom.GeneralPath;
import java.awt.image.BufferedImage;
import java.awt.image.ImageProducer;
import java.util.Random;

public class graphics extends Applet implements Runnable
{
    public boolean isRunning = false;
    protected BufferedImage mBuffer;
    protected boolean comparaisonFinni = false;
    protected Polygon polygonCourant = createNewPolygon();
    protected Graphics2D mGraphics;
    protected Dimension mDimension;
    protected int mFPS = (1000 / 9);

    public void start()
    {
        isRunning = true;
        new Thread(this).start();
    }
    public void stop()
    {
        isRunning = false;
    }

    public void init()
    {
        mDimension = getSize();
        mBuffer = (BufferedImage)createImage(mDimension.width, mDimension.height);  
        mGraphics = (Graphics2D)mBuffer.createGraphics();
    }

    public void paint(Graphics pGraphics)
    {
        pGraphics.clearRect(0, 0, mDimension.width, mDimension.height);

        Polygon polygonTmp = new Polygon();

        if (!comparaisonFinni)
            polygonTmp = createNewPolygon();

            for (int i = 0; i < 4; i++) 
            {
                if (polygonTmp.xpoints[i] < polygonCourant.xpoints[i])
                {
                    polygonCourant.xpoints[i]--;            
                }
                if (polygonTmp.xpoints[i] > polygonCourant.xpoints[i])
                {
                    polygonCourant.xpoints[i]++;
                }
                if ( polygonTmp.ypoints[i] < polygonCourant.ypoints[i])
                {
                    polygonCourant.ypoints[i]--;
                }
                if ( polygonTmp.ypoints[i] > polygonCourant.ypoints[i])
                {
                    polygonCourant.ypoints[i]++;
                }
                if ((polygonCourant.xpoints[0] == polygonTmp.xpoints[0]) && (polygonCourant.xpoints[1] == polygonTmp.xpoints[1]) &&
                        (polygonCourant.xpoints[2] == polygonTmp.xpoints[2]) && (polygonCourant.xpoints[3] == polygonTmp.xpoints[3]) &&
                        (polygonCourant.ypoints[0] == polygonTmp.ypoints[0]) && (polygonCourant.ypoints[1] == polygonTmp.ypoints[1]) && 
                        (polygonCourant.ypoints[2] == polygonTmp.ypoints[2]) && (polygonCourant.ypoints[3] == polygonTmp.ypoints[3]))
                {
                    comparaisonFinni = true;
                }   
            }       
         pGraphics.drawPolygon(polygonCourant);

    }

    public Polygon createNewPolygon()
    {   
        Random aNumber = new Random();
        int x1Points[] = new int [4];
        int y1Points[] = new int [4];

        for (int i = 0; i < 4; i++) 
        {
            x1Points[i] = aNumber.nextInt(200);
            y1Points[i] = aNumber.nextInt(300);
        }

        Polygon lePolygon = new Polygon(x1Points, y1Points, 4);

        if (comparaisonFinni)
        {
            comparaisonFinni = false;
            polygonCourant = lePolygon;

        }

        return lePolygon;

    }
    public void update(Graphics pGraphics)
    {
        paint(pGraphics);
    }

    public void run() 
    {
        while (isRunning)
        {
            repaint();
            try
            { Thread.sleep(mFPS); }
            catch (InterruptedException pException)
            { pException.printStackTrace(); }
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:22:43.263

You use random there. For instance, xpoints are created as nextInt(200).

```
public Polygon createNewPolygon()
{   
    Random aNumber = new Random();
    int x1Points[] = new int [4];
    int y1Points[] = new int [4];

    for (int i = 0; i < 4; i++) 
    {
        x1Points[i] = aNumber.nextInt(200);
        y1Points[i] = aNumber.nextInt(300);
    }

    Polygon lePolygon = new Polygon(x1Points, y1Points, 4);

    if (comparaisonFinni)
    {
        comparaisonFinni = false;
        polygonCourant = lePolygon;

    }

    return lePolygon;

} 
```

nextInt(200) is an evenly distributed random value with mean value = 100\. This means that all xpoints slowly move towards value of 100\. Not sure if that was your idea.

Same goes for ypoints. They move towards 150.

As a result, of course, you see that polygon shrinks around point (100,150).

# jquery - jQuery没有正确比较表格单元格中的变量

> ID：14880431
> 
> 赞同：0
> 
> 时间：2013-02-14T17:18:40.660
> 
> 标签：jquery

我有一张这样的桌子：

```
<table id="comparison">
    <tr>
        <th>Hotels</th>
        <th>Jan 2013</th>
        <th>Feb 2013</th>
    </tr>
    <tr>
        <td>Lorem Ipsum Hotel</td>
        <td>
            <div class="rooms">165</div>
            <div class="sob">352</div>
        </td>
        <td>
            <div class="rooms">215</div>
            <div class="sob">30</div>
        </td>
    </tr>
</table> 
```

我准备了这个 jQuery 脚本来比较每个单元格中的房间和 SOB。
- 如果 SOB 小于 Rooms，那么我将 SOB 涂成红色以表示否定结果。
- 如果 SOB 大于 Rooms，则我将 SOB 涂成绿色以表示阳性结果。

```
$('#comparison td .sob').each(function() {
    var rooms = $(this).prev().text();
    var sob = $(this).text();
    if (rooms > sob) {
        $(this).css({'color': 'red'});
    } else {
        $(this).css({'color': 'green'});
    }
}); 
```

问题是这个脚本没有正确比较房间和 SOB。它似乎在变量比较中随机运行，有时会产生正确的结果，有时则不会。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:20:01.367

您正在使用文本值进行比较，而不是数值。

尝试替换这两行：

```
var rooms = $(this).prev().text();
var sob = $(this).text(); 
```

有了这个：

```
var rooms = parseInt($(this).prev().text(),10); // always use a radix
var sob = parseInt($(this).text(),10); 
```

另一方面，如果可以的话，您可能希望在生成页面输出的代码中添加 css 类（当然，还假设 HTML 内容是动态生成的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:20:56.487

试试这个

```
$('#comparison td .sob').each(function() {
    var rooms = Number($(this).prev().html());
    var sob = Number($(this).html());
    if (rooms > sob) {
        $(this).css({'color': 'red'});
    } else {
        $(this).css({'color': 'green'});
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T17:23:10.517

试试这个，

```
var rooms = parseInt($(this).siblings('.rooms').text()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T17:30:17.540

我认为您必须将文本解析为int：

```
$('#comparison td .sob').each(function() {
  var rooms = Math.floor($(this).siblings().text());
  var sob = Math.floor($(this).text());
  if (rooms > sob) {
    $(this).css({'color': 'red'});
  } else {
    $(this).css({'color': 'green'});
  }
}); 
```

`Math.floor()`：我在某处读到它的性能要快得多`parstInt()`

# directshow - IMFMediSource 不支持 IKsPropertySet 接口

> ID：14880434
> 
> 赞同：2
> 
> 时间：2013-02-14T17:18:47.150
> 
> 标签：directshow, video-capture, ms-media-foundation, wdm

我正在将基于 Direct Show 相机的 SDK 移植到 MFT。在我的旧代码中，我有 KSProxy 接口，例如 IksTopolgy,IKsControl 和 IKsProperty 。

IksTopolgy,IKsControl 用于枚举属性集，IKsProperty 用于获取/设置属性值。现在我尝试在新代码中进行相同的操作。我能够枚举属性，即 MFT 支持以下代码。

```
CComPtr<IKsTopologyInfo> ksTopology = NULL;
hRet = m_pMediaSource->QueryInterface(&ksTopology); 
```

但是用于获取/设置属性值的 IKsProperty 接口无法返回 E_NOINTERFACE。

```
 hRet = m_pMediaSource->QueryInterface(&pKsPropertySet); 
```

失败了。我不明白为什么 m_pMediaSource 不支持此功能 请建议如何获取/设置属性值。

# excel - 将字符串拆分为具有特定模式和条件的部分

> ID：14880438
> 
> 赞同：4
> 
> 时间：2013-02-14T17:18:53.277
> 
> 标签：excel, pattern-matching, excel-formula

我有大约 5k+ 个字符串的类似下面的数组作为某些应用程序的输出（出于安全原因，我可能不会提供确切的数据，但示例格式与实际数据非常相似）：

```
kasdfhkasdhfaskdfj42345sdsadkfdkfhasdf5345534askfhsad
asdfasdf66sdafsdfsdf4560sdfasdfasdf
sdfaasdfs96sadfasdf65459asdfasdf
sadfasdf8asdfasdas06666654asdfasdfsd
fasdjfsdjfhgasdf6456sadfasdfasdf9sdfasdfsadf 
```

**简单地说，我有由5 个部分**组成的不间断字母数字字符串：

```
[latin letters][1 or more digits][latin letters][1 or more digits][latin letters] 
```

字母部分的长度以及数字的数量是随机的，整个字符串长度可能从*几个*到 2-3***数百个***字符不等，但模式仍然如上。

实际上，我对**前导和尾随字符串部分**感兴趣，即`[1 or more digits][latin letters][1 or more digits]`可能会被丢弃，但应提取其他 2 个字符串以分隔单元格。

我尝试`SUBSTITUTE`了`SEARCH`函数，但我仍然可能无法处理随机数量的数字。VBA 是最后需要的方法，但是如果纯公式无用，它是可以接受的。此外，该解决方案应该是灵活的，以便将来可能使用类似的模式 - 因此任何正确的指导/一般方法都将受到赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T18:04:04.827

如果您不介意使用**MS Word而不是 Excel - 对于此类任务，有一种非常简单的方法，其中涉及使用****通配符**的内置`Search and Replace`例程。假设数据可以在 Word 中打开，请执行以下操作：

 **1.  按`CTRL`+`H`打开替换对话框。
2.  勾选`Use wildcards`选项。
3.  您要丢弃的数据部分与以下模式匹配：`[0-9]{1,}*[0-9]{1,}`- 这意味着任何数字 1 次或多次，其间有任何字符。根据您需要的区域设置`;`而不是`,`此处。
4.  指定您喜欢的任何字符作为替换，例如`^t`(Tab) 或`;`- 用于进一步的部分拆分。
5.  进行更换。
6.  或者，您可以使用功能区功能将其余部分转换为表格`Insert > Table > Convert Text to Table...`。

您现在需要的只是保存/粘贴获得的结果。

实际上，该方法非常强大，无需特殊技能和/或编程即可快速完成许多类似于您的常规文本数据解析任务。而且您不需要任何第三方工具 - 现在每台 PC 都安装了 Word。

阅读有关模式和适用案例的更多信息：

*   [使用通配符查找和替换](http://www.gmayor.com/replace_using_wildcards.htm)
*   [使用通配符查找和替换字符](http://word.mvps.org/faqs/general/usingwildcards.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T17:47:46.050

基于来自伟大的chandoo的[本教程（如果你想在excel中表现出色，你应该遵循谁：](http://chandoo.org/wp/2012/06/19/extract-numbers-from-text-excel/)

使用这个公式（注意一个数组公式，你需要用**ENTER+SHIFT+CTRL**输入它）来提取

```
{=MIN(IFERROR(FIND(lstNumbers,G6),""))} 
```

其中 lstNumbers 是工作表中的命名范围，其中单元格包含 0-9（单元格中的每个数字）和 e1 包含数据的单元格。

这将返回第**一个**数字，然后您可以提取第一部分：

```
=LEFT(E1,G1-1) 
```

其中 e1 包含数据， g1 包含前面的公式

要获得您使用的数字部分的结尾：

```
{=MAX(IFERROR(FIND(lstNumbers,E1),""))} 
```

然后你可以使用 mid 来提取数字部分，并使用 len(datacell)- len(from max function) 来提取字符串的其余部分。我们将使用相同的处理方法——用 min 获取第一个数字，用 max 获取最后一个数字等

祝你好运！这是一个真正的硬汉，用真正的编程语言做这件事可能会更容易

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T18:35:57.690

更新：

此数组公式将为您提供第一个字符串部分：

```
 =LEFT(A1,MATCH(0,1*ISERROR(1*MID(A1,ROW(INDIRECT("$A1:$A"&LEN(A1))),1)),0)-1) 
```

此数组公式将为您提供最后一个字符串部分：

```
 =RIGHT(A1,MATCH(0,1*ISERROR(1*MID(A1,LEN(A1)+1-ROW(INDIRECT("$A1:$A"&LEN(A1))),1)),0)-1) 
```**

# .net - 是否有一种工具可以跨多个解决方案记录 .net 代码？

> ID：14880441
> 
> 赞同：2
> 
> 时间：2013-02-14T17:19:09.143
> 
> 标签：.net, visual-studio, sharepoint, tfs, documentation

我们正在寻求实现一个文档解决方案，使我们能够搜索我们所有的解决方案和项目以寻找潜在的可重用代码。一个例子是服务。如果我们创建了一些 WCF 服务，我们希望其他开发人员能够搜索可用的服务并查看该服务的文档以查看它是否符合他们的需求。

目前我们正在使用 Visual Studio 2012 Ultimate 以及 TFS 2012 和 SharePoint 2013。

我研究过流行的文档工具，例如 GhostDoc Pro 和 Sandcastle，但它们似乎只适用于处理单一解决方案。
现在可以为所有解决方案构建所有文档，并且每个解决方案都有自己的文档网页，但是您将如何利用一些易于使用的方法来搜索所有解决方案文档？我们还研究了将 GhostDoc 和 Sandcastle 创建的网站加载到 SharePoint 中以获得中央可搜索位置，但这很麻烦，因为 SharePoint 一次只允许您加载一个文件。

本质上，我们的最终目标是拥有一个公司范围内可维护的文档解决方案，该解决方案可以组织所有文档并允许在所有文档中进行搜索。

我觉得这必须是以前做过的事情，但我找不到任何现有的解决方案。

**编辑以获取更多信息：**

理想情况下，如果不完全是 sandcastle 和 ghostdoc 现在构建的，我们会想要类似的东西。一个文档，可以让您轻松地减少一个类及其成员。该工具将从 XML 文档中获取其信息。不必自己构建文档将是理想的。这就是为什么像沙堡这样的工具很好的原因。只要你有有价值的 XML 文档，它就会很容易地构建一个很好的帮助文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T22:06:25.850

怎么样：

*   使用 Sandcastle 生成 HTML 文档。
*   把它放在某个共享文件夹上。
*   每个用户都使用 Copernic Desktop Search Professional 对其进行索引吗？

# ios - 带有登录参数的 URL

> ID：14880442
> 
> 赞同：-1
> 
> 时间：2013-02-14T17:19:09.447
> 
> 标签：ios, json, post

一段时间以来，我一直在挠头。假设我有一个这样的网址

//myurl/index.jsp?user_name=bob&user_pwd=new

以及我的应用程序上的登录表单，其中包含用户名和密码 texfields 以及登录按钮。当用户输入“bob”作为用户名并输入“new”作为密码时，我想推送到另一个视图控制器。

我知道如何使用标准的硬编码方式来做到这一点，但我想尝试通过发布到 url/web 服务。

你怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:57:34.500

I would use AFNetworking Library. You run the request with blocks so you can run a success block that if the login is successful, you can push a new view controller and if it fails you can throw a UIAlert or something else. You will just want to take the username and password text from the UITextFields and put that in your URL request.

More info on AFNetworking below. Also way faster than standard NSHTTP requests.

[AFNetworking](https://github.com/AFNetworking/AFNetworking)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:45:29.277

```
 NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
NSString *url = @"http://myurl/index.jsp?"; //your url
NSString *post = [NSString stringWithFormat:@"user_name=%@&user_pwd=%@",UserName,Password] ;
NSData *postData = [post dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];
[request setURL:[NSURL URLWithString:url]]; 
[request setTimeoutInterval:20]; //time out interval 
request.HTTPMethod = @"POST";
[request setHTTPBody:postData];
NSError *error;
NSHTTPURLResponse *response = nil;
NSData *urlData=[NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];
NSString *data=[[[NSString alloc]initWithData:urlData encoding:NSUTF8StringEncoding] autorelease];
NSLog(@"Login response %@ :",data);
[request release]; 
```

# c# - 在 OpenXML 文档的每页顶部插入图片

> ID：14880445
> 
> 赞同：0
> 
> 时间：2013-02-14T17:19:24.237
> 
> 标签：c#, .net, openxml, openxml-sdk

我在 C# for Word 中创建 OpenXML 文档，但我总是发现无法确定分页符在文档中的出现位置。这会产生以下问题：

我想在每个页面的顶部插入一个小图像，它可以对页面的元素进行一些概述。

为此，是否可以使用以下条件：

“`if(page break reached == true)`然后在下一页插入一个小图像”？

我可以在每个段落之后使用这个条件，所以我不必知道分页符出现在哪里。任何其他解决方案也会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T14:25:44.663

您可以通过在要插入图像时手动插入分页符来解决您的问题，在 xml 中分页符，

```
 <w:r>
      <w:br w:type="page" />
 </w:r> 
```

您还需要[`lastRenderedPageBreak`](http://msdn.microsoft.com/en-us/library/office/documentformat.openxml.wordprocessing.lastrenderedpagebreak.aspx)在下一页的内容之前添加元素，

```
 <w:r>
    <w:lastRenderedPageBreak />
    <w:t>your content on page 2</w:t>
  </w:r> 
```

同样的事情可以在代码中实现：

```
 Run run1 = new Run();
    Break break1 = new Break(){ Type = BreakValues.Page }; //Breaks page
    run1.Append(break1); //append your run to paragraph on page 1 
```

在第 2 页

```
 Run run2 = new Run();
    LastRenderedPageBreak lastRenderedPageBreak1 = new LastRenderedPageBreak();
    //add your image here in openxml code
    run2.Append(lastRenderedPageBreak1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:26:26.853

Word 文档不以文件格式进行分页。确定哪些对象在哪个页面上的唯一方法是使用渲染引擎。Aspose.Words 就是一个例子，但它并不便宜。

另一种选择是添加标题并将图像放在那里或使用水印

# batch-file - 未找到 ftp 批处理目录

> ID：14880446
> 
> 赞同：0
> 
> 时间：2013-02-14T17:19:38.507
> 
> 标签：batch-file, ftp

我正在创建一个批处理文件，它将通过 FTP 备份来自服务器的特定目录的备份，该服务器可公开访问的服务器只能由我们网络上的人访问。（从我们的网络服务器到我们的内网服务器）。由于无法从网络服务器访问内网服务器，所以我在内网服务器上创建了 FTP 批处理文件。我在 FileZilla Server 的网络服务器上设置了一个用户，该用户可以访问我要从中复制所有文件和子目录的目录。我设置了这个文本文件 (backupTransfer.txt)： open myIPAddress username password hash bin lcd E:\backups\website mget "C:\Backup\testFile.txt" quit

然后我有我的批处理文件来运行它（websiteBackup.bat）： FTP -v -i -s:C:\batch\backupTransfer.txt

当我运行它时，我收到以下消息： ftp>mget "C:\Backup\testFile.txt" Directory not found 找不到远程文件列表 ftp> quit

我尝试使用 cd 来指定网络服务器上的目录（尽管这并不是真正必要的，因为我使用的用户只有对 C:\Backups 文件夹及其子目录的 FTP 访问权限。

我不知道这是否是相关信息，但我有另一个可以正常工作的批处理文件，它将文件从 Intranet 服务器传输到 Web 服务器。我似乎无法让 Intranet 从网络服务器中提取文件。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:36:53.383

您的 ftp 的根文件夹是 / 不是 c:\batch

# java - 具有自定义相等标准的Java HashSet？

> ID：14880450
> 
> 赞同：48
> 
> 时间：2013-02-14T17:19:46.480
> 
> 标签：java, set, hashset

我正在寻找类似于 Java TreeSet 在实例化时接收自定义比较器的能力，因此我不需要使用对象的默认相等（和哈希码）标准。

我能想到的最接近的方法是将我的对象包装在一个私有自定义类中，但这似乎很棘手:(这最终成为编程时一种反复出现的主题，所以我想知道是否已经有一些东西可供我们使用。也许在公共图书馆？

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-14T17:20:36.560

不，您已经找到了您应该使用的解决方案。

即使对于`TreeSet`，也[不赞成](http://docs.oracle.com/javase/6/docs/api/java/util/SortedSet.html)使用与 不兼容的比较标准`equals`：

> 请注意，如果有序集合要正确实现 Set 接口，则由有序集合维护的排序（无论是否提供显式比较器）必须与 equals 一致。

我不了解 Apache Commons，但 Guava[明确](https://code.google.com/p/guava-libraries/issues/detail?id=188#c9) [拒绝](https://code.google.com/p/guava-libraries/issues/detail?id=576#c17)了此类请求，尽管您可以使用[Guava Equivalence](https://guava.dev/releases/28.0-jre/api/docs/com/google/common/base/Equivalence.html)实现您想要的：

```
Equivalence<T> equivalence = new Equivalence<T>() {
    @Override
    protected boolean doEquivalent(T a, T b) {
        return CustomComparator.equals(a, b);
    }

    @Override
    protected int doHash(T item) {
        return CustomHashCodeGenerator.hashCode(item);
    }
};
List<T> items = getItems();
Set<Equivalence.Wrapper<T>> setWithWrappedObjects = items.stream()
    .map(item -> equivalence.wrap(item))
    .collect(Collectors.toSet()); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T18:11:32.960

有几个第三方集合框架允许自定义相等逻辑。这非常适合覆盖无法更改源的对象的相等性。

*   [特罗夫](http://trove.starlight-systems.com/overview)

> Trove 的地图/集支持使用自定义散列策略，允许您根据输入数据的特征调整集合。此功能还允许您在无法覆盖 Object.hashCode() 时定义散列函数。

*   [HE-系列](http://sourceforge.net/p/hecollection/wiki/Home/)

> 为了实现这一点，任何需要标准校正的类型都必须实现 HE-Collection 接口 EqualsAndHashCorrection。该接口定义了 hashCodeInHeCollection() 和 equalsInHeCollection(Object) 方法，用于纠正错误实现的方法 hashCode() 和 equals(Object)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-14T17:30:28.680

你是对的，当你想使用任何`Trees`( `TreeMap`, `TreeSet`) 你添加的对象必须实现`Comparable`。

对于原始类型，Java 已经为您解决了这个问题。
对于自定义对象，您有 3 种可能性：

1.  您的一个对象已经具有原始类型的唯一 id 或已经实现的类型`compareTo()`（如`String`）如果其他对象的值对于相等性不重要，则将此字段用于 compareTo。（但`equals()`也必须只使用这一个字段）

2.  从 Apache使用`EqualsBuilder`：这适用于反射，并不是最快的解决方案

3.  自己写，阅读一些教程如何做到这一点：例如：

> Josh Bloch：有效的 Java 第 2 版

但是不要忘记`equals()`, 和`compareTo()`必须兼容（和`hashCode()`, 也是），这样你就不会违反 equals 契约。（合同本身不太容易理解，但如果你拒绝其中一个等于教程，就会清楚。）

或者忘记这一切，并使用`HashSet`, `HashMap`。

# django - Django REST权限类和认证类的区别

> ID：14880451
> 
> 赞同：13
> 
> 时间：2013-02-14T17:19:49.167
> 
> 标签：django, django-rest-framework

最后一件事我对[Django Rest Framework](http://django-rest-framework.org/)有点困惑，那就是权限类和身份验证类之间的**区别**。

**这是我的 settings.py**

```
REST_FRAMEWORK = {
'DEFAULT_PERMISSION_CLASSES': (
    'rest_framework.permissions.IsAdminUser',

),
'DEFAULT_AUTHENTICATION_CLASSES': (
    'rest_framework.authentication.TokenAuthentication',
    'rest_framework.authentication.SessionAuthentication',
),
'PAGINATE_BY': 10 
```

}

**在我看来，我有以下...**

```
class ProfileList(generics.ListCreateAPIView):
    """
    API endpoint that represents a list of users.
    """
    permission_classes = (permissions.IsAdminUser,)
    model = Profile
    serializer_class = ProfileSerializer

    def pre_save(self, obj):
        obj.owner = self.request.user 
```

我假设上面会发生的是，只有管理员用户才能访问可浏览的 API，而具有有效令牌的用户仍然可以获得 json 请求。但是，情况并非如此，IsAuthenticated 似乎授予他们访问权限，但 = 这仍然允许我的用户在登录时访问在线版本。

**我希望所有拥有有效令牌的用户都能访问，但只有管理员用户有权查看带有会话的在线 API 版本，这可能吗？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T13:19:24.407

> 我希望所有拥有有效令牌的用户都能访问，但只有管理员用户有权查看带有会话的在线 API 版本，这可能吗？

值得注意的第一件事是，与仅呈现 JSON 相比，可浏览 API 不会为您的用户提供更多权限。它只是对 API 端点的一个更好的视图。就个人而言，我通常希望将可浏览的 API 公开给最终开发人员，因为它使针对 API 的开发变得更加容易。

如果您确实想对除管理员用户之外的所有人隐藏它，您可以采取以下两种方法：

1.  覆盖`get_renderers()`视图上的方法。[（此处](https://www.django-rest-framework.org/api-guide/views/#api-policy-instantiation-methods)简要记录）您可以检查`self.request.user.is_staff`，如果它是管理员用户，则仅包含可浏览 API 渲染器。

2.  子类化可浏览的 API 渲染器，并覆盖`.render()`. （例如，请参见[此处](https://www.django-rest-framework.org/api-guide/renderers/#custom-renderers)）您可以使用 获取传入请求`renderer_context['request']`，如果它不是管理员用户，则只需呈现为标准 JSON。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T13:56:54.530

我认为它按照[文档中的](https://www.django-rest-framework.org/api-guide/permissions/#how-permissions-are-determined)描述工作：

> 如果任何权限检查失败，则会引发 exceptions.PermissionDenied 异常，并且视图的主体将不会运行。

如果设置`IsAdminUser`，则用户必须是管理员。否则即使提供了所有需要的东西，他也不会获得许可`DEFAULT_AUTHENTICATION_CLASSES`。

# map - 使用 MapReduce API 通过 Gzip 压缩复制 HDFS 内的文件

> ID：14880457
> 
> 赞同：1
> 
> 时间：2013-02-14T17:20:05.000
> 
> 标签：map, copy, mapreduce, gzip, reduce

我正在用 Java 编写一个归档程序。将归档的文件已经驻留在 HDFS 中。我需要能够将文件从 HDFS 中的一个位置移动到另一个位置，并使用 Gzip 压缩最终文件。要移动的文件可能非常大，因此使用 HDFS API 移动和压缩它们可能效率很低。所以我想我可以在我的代码中写一个 mapreduce 作业来为我做这件事。

但是，我一直找不到任何示例来说明如何使用 MapReduce API 复制这些文件并将它们以 gzip 格式输出。事实上，我什至很难找到一个编程示例，说明如何通过 mapreduce 在 HDFS 中复制文件。

任何人都可以阐明我如何使用 MapReduce API 完成此任务吗？

编辑：这是我到目前为止的工作配置代码，它改编自 Amar 给我的帮助：

```
 conf.setBoolean("mapred.output.compress", true); 
        conf.set("mapred.output.compression.codec","org.apache.hadoop.io.compress.GzipCodec");
        Job job = new Job(conf);
        job.setJarByClass(LogArchiver.class);
        job.setJobName("ArchiveMover_"+dbname);
        job.setOutputKeyClass(Text.class);
        job.setOutputValueClass(Text.class);
        //job.setMapperClass(IdentityMapper.class);
        //job.setReducerClass(IdentityReducer.class);
        job.setInputFormatClass(NonSplittableTextInputFormat.class);
        job.setOutputFormatClass(TextOutputFormat.class);
        job.setNumReduceTasks(0);
        FileInputFormat.setInputPaths(job, new Path(archiveStaging+"/"+dbname+"/*/*"));
        FileOutputFormat.setOutputPath(job, new Path(archiveRoot+"/"+dbname));
        job.submit(); 
```

这是位于 LogArchiver 类中的 NonSplittableTextInputFormat 的类声明

```
public class NonSplittableTextInputFormat extends TextInputFormat {
    public NonSplittableTextInputFormat () {
    }

    @Override
    protected boolean isSplitable(JobContext context, Path file) {
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T18:24:54.950

您可以使用和编写[自定义 jar 实现](http://bigdataspeak.wordpress.com/2012/12/27/emr-streaming-job-using-java-code-for-mapper-and-reducer-creating-custom-jar/)。您可以生成 gzip 文件作为输出，而不是纯文本文件。在 中设置以下配置：`IdentityMapper``IdentityReducer``run()`

```
conf.setBoolean("mapred.output.compress", true); 
conf.set("mapred.output.compression.codec","org.apache.hadoop.io.compress.GzipCodec"); 
```

为了确保输入和输出中的文件数量相同，只是输出文件必须经过 gzip 压缩，您必须做 2 件事：

1.  实现 NonSplittableTextInputFormat
2.  将减少任务设置为零。

为了确保每个映射器读取一个文件，您可以扩展`TextInputFormat`如下：

```
import org.apache.hadoop.fs.*;
import org.apache.hadoop.mapred.TextInputFormat;
public class NonSplittableTextInputFormat extends TextInputFormat {
    @Override
    protected boolean isSplitable(FileSystem fs, Path file) {
        return false;
    }
} 
```

并将上述实现用作：

```
job.setInputFormatClass(NonSplittableTextInputFormat.class); 
```

要将 reduce 任务设置为零，请执行以下操作：

```
job.setNumReduceTasks(0); 
```

这将为您完成工作，但最后一件事是文件名不一样！但我相信，这里也必须有一个解决方法。

# css - CSS gradient striping in Chrome

> ID：14880463
> 
> 赞同：1
> 
> 时间：2013-02-14T17:20:24.460
> 
> 标签：css, gradient

I used the Colorzilla CSS gradient generator to create a background that has multiple color stops. It works great in Firefox and Safari but in Chrome there is a subtle striping/banding thing going on that is frustrating. Here's my code and a jsfiddle link:

```
body {
background: rgb(0,0,0); /* Old browsers */
background: -moz-linear-gradient(left,  rgba(0,0,0,1) 0%, rgba(85,187,0,1) 15%, rgba(85,187,0,1) 25%, rgba(221,34,85,1) 45%, rgba(221,34,85,1) 55%, rgba(0,136,238,1) 75%, rgba(0,136,238,1) 85%, rgba(0,0,0,1) 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, right top, color-stop(0%,rgba(0,0,0,1)), color-stop(15%,rgba(85,187,0,1)), color-stop(25%,rgba(85,187,0,1)), color-stop(45%,rgba(221,34,85,1)), color-stop(55%,rgba(221,34,85,1)), color-stop(75%,rgba(0,136,238,1)), color-stop(85%,rgba(0,136,238,1)), color-stop(100%,rgba(0,0,0,1))); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(left,  rgba(0,0,0,1) 0%,rgba(85,187,0,1) 15%,rgba(85,187,0,1) 25%,rgba(221,34,85,1) 45%,rgba(221,34,85,1) 55%,rgba(0,136,238,1) 75%,rgba(0,136,238,1) 85%,rgba(0,0,0,1) 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(left,  rgba(0,0,0,1) 0%,rgba(85,187,0,1) 15%,rgba(85,187,0,1) 25%,rgba(221,34,85,1) 45%,rgba(221,34,85,1) 55%,rgba(0,136,238,1) 75%,rgba(0,136,238,1) 85%,rgba(0,0,0,1) 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(left,  rgba(0,0,0,1) 0%,rgba(85,187,0,1) 15%,rgba(85,187,0,1) 25%,rgba(221,34,85,1) 45%,rgba(221,34,85,1) 55%,rgba(0,136,238,1) 75%,rgba(0,136,238,1) 85%,rgba(0,0,0,1) 100%); /* IE10+ */
background: linear-gradient(to right,  rgba(0,0,0,1) 0%,rgba(85,187,0,1) 15%,rgba(85,187,0,1) 25%,rgba(221,34,85,1) 45%,rgba(221,34,85,1) 55%,rgba(0,136,238,1) 75%,rgba(0,136,238,1) 85%,rgba(0,0,0,1) 100%); /* W3C */
width:100%;
margin-bottom:1em;
} 
```

[http://jsfiddle.net/yL82a/](http://jsfiddle.net/yL82a/) (ignore the margin-bottom declaration)

Any idea how to fix this in Chrome to just be a nice smooth gradient? I've tried this using both rgba and hex values and get the same result.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-18T18:34:37.623

我希望整个页面都有渐变背景，这个问题很烦人。`-webkit-filter: blur(3px);`最后我可以通过应用来去除条纹`<body>`，但是整个内容都变得模糊了，所以我做了一个单独`<div>`的作为页面的背景，并对其应用了过滤器。

CSS：

```
html, body {
   width: 100%;
   margin: 0;
}

#page-background
{
    width: 100%;
    height: 100%;
    background: #383838; /* Old browsers */
    background: -webkit-linear-gradient(top, #383838 0%,#d6d6d6 100%); /* Chrome10+,Safari5.1+ */
    (...)
    -webkit-filter: blur(3px);
} 
```

HTML：

```
<body>
    <div id="page-background"></div>
    And content goes here... 
```

渐变是在[ColorZilla 站点](http://www.colorzilla.com/gradient-editor/)生成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T18:56:00.687

与 Chrome 如何处理抖动有关。此处讨论了问题：

[https://graphicdesign.stackexchange.com/questions/8426/gradient-banding-in-chrome](https://graphicdesign.stackexchange.com/questions/8426/gradient-banding-in-chrome)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-14T17:49:38.653

尝试从此站点生成 css 渐变，看看是否有任何差异，它将帮助您调试代码，

[http://ie.microsoft.com/testdrive/graphics/cssgradientbackgroundmaker/default.html](http://ie.microsoft.com/testdrive/graphics/cssgradientbackgroundmaker/default.html)

祝你好运。。

# java - Create a file extension

> ID：14880465
> 
> 赞同：0
> 
> 时间：2013-02-14T17:20:33.190
> 
> 标签：java, file-extension

I make a java program. Persistence is performed in a folder "nameFolder.myProgramExtension". Is it possible that the operating system recognizes "myProgramExtension" as a file extension that opens with my program? and not as a folder. What would be the way to go?. Sorry for my English. thanks

# java - Maven: Build runnable jar and then add to zip with maven-assembly-plugin

> ID：14880472
> 
> 赞同：1
> 
> 时间：2013-02-14T17:21:04.537
> 
> 标签：java, maven, maven-assembly-plugin

I have a maven problem that should be easy to solve, but is proving to be a bit difficult.

I have a project that builds a jar, and needs that jar to be able to execute a class `com.foo.bar.MainClass`, but I need to be able to deploy it along with a few scripts and its dependencies like

```
some-product-1.0.0.zip
  bin/
    some-product.sh
  lib/
    some-product-1.0.0.jar
    dependency1.jar
    dependency2.jar 
```

I can get it to make this structure quite easily. My `pom.xml` looks like

```
<plugin>
    <artifactId>maven-assembly-plugin</artifactId>
    <configuration>
        <archive>
            <manifest>
                <mainClass>com.foo.bar.MainClass</mainClass>
                <addClasspath>true</addClasspath>
            </manifest>
        </archive>
        <descriptors>
            <descriptor>assembly.xml</descriptor>
        </descriptors>
    </configuration>
</plugin> 
```

and my `assembly.xml` is

```
<assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2 http://maven.apache.org/xsd/assembly-1.1.2.xsd">
    <id>bin</id>
    <formats>
        <format>zip</format>
    </formats>
    <files>
        <file>
            <source>src/main/scripts/some-product.sh</source>
            <outputDirectory>/bin</outputDirectory>
        </file>
    </files>
    <dependencySets>
        <dependencySet>
            <outputDirectory>/lib</outputDirectory>
            <useProjectArtifact>true</useProjectArtifact>
            <scope>compile</scope>
        </dependencySet>
    </dependencySets>
</assembly> 
```

And `some-product.sh` looks like

```
SCRIPTLOC=$( readlink -f $( dirname "${BASH_SOURCE[0]}" ) )
LIBS="$( dirname $SCRIPTLOC )/lib"
# builds a : joined list of all the jars in the lib directory
MYCLASSES=$(echo $LIBS/*.jar | tr ' ' ':')

java -cp "$CLASSPATH:$MYCLASSES" com.foo.bar.MainClass 
```

but what I got when I ran the script was

```
Exception in thread "main" java.lang.NoClassDefFoundError: com/foo/bar/MainClass
Cause by: java.lang.ClassNotFoundException com.foo.bar.MainClass
    at ...
Could not find the main class: com.foo.bar.MainClass.  Program will exit. 
```

When I examined the jar that contains the class, the manifest only had

```
Manifest-Version: 1.0
Archiver-Version: Plexus Archiver
Created-By: Apache Maven
Built-By: <myname>
Build-Jdk: 1.6.0_27 
```

telling me that it did not add the main class to the manifest.

I've googled this problem for quite some time without luck, and the examples on the assembly plugin's website are terrible. How can I get maven to build this jar correctly *and* add it to the zip?

**EDIT**: I did need the maven-jar-plugin in my pom, but my real problem was that I was using Cygwin and the classpath separator it expected was `;` not `:`. My solution was to write some code to figure out which classpath separator to use, and with the jar plugin it works perfectly now.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T17:33:41.160

我看到的两件事是

1.  `classpath`设置不正确。

    ```
     SCRIPTLOC=$( readlink -f $( dirname "${BASH_SOURCE[0]}" ) ) 
    ```

    这里的 SCRIPTLOC 不是根目录。这是`<the_complete_path_from_root>/bin`

    ```
     LIBS="$( dirname $SCRIPTLOC )/lib" 
    ```

    这最终评估为`<the_complete_path_from_root>/bin/lib`

    您稍后`lib`会将文件夹添加到其中，该文件夹实际上并不包含您的 jar。因此，要添加到类路径的正确路径是`lib` jar 所在的文件夹，然后它将能够找到`com.foo.bar.MainClass`.

2.  要将 Main 类添加到清单文件中，您需要将以下内容添加到`pom.xml`文件中。

    > ```
    > <plugin>
    >      <groupId>org.apache.maven.plugins</groupId>
    >      <artifactId>maven-jar-plugin</artifactId>
    >      <configuration>
    >        <archive>
    >          <manifest>
    >            <mainClass>com.someclass.Main</mainClass>
    >            <packageName>com.someclass</packageName>
    >          </manifest>
    >          <manifestEntries>
    >               <mode>development</mode>
    >               <url>${pom.url}</url>
    >           </manifestEntries>
    >         </archive>
    >       </configuration>
    >   </plugin> 
    > ```

# batch-file - 批处理脚本比较问题

> ID：14880475
> 
> 赞同：0
> 
> 时间：2013-02-14T17:21:11.617
> 
> 标签：batch-file

```
if exist "C:\Windows\System32\updatevmcheck.txt" (
set /p Build=<C:\Windows\System32\updatevm.txt
if %Build% LSS 2  (
echo "Run Code Here"
) else (
exit
)
echo 2 > C:\Windows\System32\updatevmcheck.txt
exit
) 
ELSE (
echo 1 > C:\Windows\System32\updatevmcheck.txt
exit
) 
```

以上是我拥有的当前代码。基本上它会检查文件是否存在，如果存在，它会检查文件以查看其中的数字是否小于您指定的数字。如果是这样，它会运行一些代码，然后更新文件中的数字，然后退出。否则，它会创建带有数字的文件，然后退出。我相信我的语法是正确的，我可以运行单独的行，但是当我制作我的批处理文件时，它似乎甚至没有通过 if exists 语句。除了糟糕的格式之外，任何人都可以看到任何明显的错误:)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:26:00.357

您在一个块中设置一个变量并在同一个块中使用它的值。这不能与正常的变量扩展一起工作（这发生在一个命令（这包括一个完整的块）被解析，而不是在它运行时）。要解决此问题，您需要使用延迟扩展，因此将以下内容放在批处理文件的开头：

```
setlocal enabledelayedexpansion 
```

然后使用`!Build!`而不是`%Build%`. 有关`help set`更多详细信息和解释，请参阅（我已经写了几十次了；））。

# wiki - Is there a wiki that works with Aloha editor (or hallo-js)?

> ID：14880480
> 
> 赞同：6
> 
> 时间：2013-02-14T17:21:19.980
> 
> 标签：wiki, contenteditable, aloha-editor, hallo-js

I have a dokuwiki wiki set up on my server, and I would love to be able to edit the wiki with inline editing, a la Aloha Editor or Hallo Editor. On the Aloha editor home page they mention that you could use it for wikis in passing, but there are no more details.

I know I could go through all the work of implementing Aloha or Hallo or another similar editor with my dokuwiki setup, but I guess what I'm really wondering is if anyone has already done this with any wiki (dokuwiki or something else).

The end result I'm looking for is: you go to a wiki page, click on the content, edit it in place with Aloha editor or the like, and the new content is saved back to the server. It would allow creating new wiki pages by inserting links to the not-yet-created page (either by clicking the link button or by typing, e.g. [[new-page-link]].

Does this exist in some form somewhere?

Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-08T18:38:23.227

[WYSIWYG Wiki](http://wysiwygwiki.org/), which is written in PHP.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T15:21:45.983

你可以试试[https://wikidocs.com](https://wikidocs.com)。它基于 Aloha Editor（尽管控件看起来不同），甚至提供多个用户对同一页面的协作编辑。

我认为这正是您正在寻找的。

# java - Filter ASCII stream in Java

> ID：14880484
> 
> 赞同：1
> 
> 时间：2013-02-14T17:21:45.797
> 
> 标签：java, sockets, stream, ascii

I want to write a class to be used in comunicaion between Java and C++

There are a lot of discussion about Java and C++ communication. Here I'm not requesting how to communicate, I konw an i know how.

I create a

```
 OutputStream os = socketChannel.socket().getOutputStream();
 OutputStreamWriter osw = new OutputStreamWriter( os);
 BufferedWriter wr = new BufferedWriter( osw ); 
```

then I write

```
 String data= dataArea.getText();

 wr.write( dataArea.getText() );
 wr.write('\0');//here is the wire with C++
 wr.flush(); // flushes the stream 
```

* * *

I send some text:

```
Hi this is a test
i send also 
character as dollar $ ...
or other stange é*"£$%&/(()=?'^ìì[]@!<>#òùèé+*
and so on 
```

So reading raw text send between two system i see:

```
00000000  48 69 20 74 68 69 73 20  69 73 20 61 20 74 65 73   Hi this  is a tes 
00000010  74 0A 69 20 73 65 6E 64  20 61 6C 73 6F 20 0A 63   t.i send  also .c 
00000020  68 61 72 61 63 74 65 72  20 61 73 20 64 6F 6C 6C   haracter  as doll 
00000030  61 72 20 24 20 2E 2E 2E  0A 6F 72 20 6F 74 68 65   ar $ ... .or othe 
00000040  72 20 73 74 61 6E 67 65  20 C3 A9 2A 22 C2 A3 24   r stange  ..*"..$ 
00000050  25 26 2F 28 28 29 3D 3F  27 5E C3 AC C3 AC 5B 5D   %&/(()=? '^....[] 
00000060  40 21 3C 3E 23 C3 B2 C3  B9 C3 A8 C3 A9 2B 2A 0A   @!<>#... .....+*. 
00000070  61 6E 64 20 73 6F 20 6F  6E 00                     and so o n. 
```

This is near the solution.

changing CHARSET "US-ASCII" I obtain

```
Hi this is a test
    i send also 
    character as dollar $ ...
    or other stange é*"£$%&/(()=?'^ìì[]@!<>#òùèé+*
    and so on

00000000  48 69 20 74 68 69 73 20  69 73 20 61 20 74 65 73   Hi this  is a tes 
00000010  74 0A 20 20 20 20 69 20  73 65 6E 64 20 61 6C 73   t.    i  send als 
00000020  6F 20 0A 20 20 20 20 63  68 61 72 61 63 74 65 72   o .    c haracter 
00000030  20 61 73 20 64 6F 6C 6C  61 72 20 24 20 2E 2E 2E    as doll ar $ ... 
00000040  0A 20 20 20 20 6F 72 20  6F 74 68 65 72 20 73 74   .    or  other st 
00000050  61 6E 67 65 20 3F 2A 22  3F 24 25 26 2F 28 28 29   ange ?*" ?$%&/(() 
00000060  3D 3F 27 5E 3F 3F 5B 5D  40 21 3C 3E 23 3F 3F 3F   =?'^??[] @!<>#??? 
00000070  3F 2B 2A 0A 20 20 20 20  61 6E 64 20 73 6F 20 6F   ?+*.     and so o 
00000080  6E 00 
```

This is near my purpose.

* * *

I need to transfer only ASCII with extended characters "è"-->E8

Then I need to put '\0' at the end of the string.

'\0' is message terminator.

Now the question: using Java i like to create a Writer or stream writer to output the specific binary data format.

**At what level is correct to work with `OutputStreamWriter` or `BufferedWriter` and should I rewrite from scratch extend or use some library? Are some example all around about what I like to do?** I'll do the same for input

I like to write it in this form because tomorrow when I rewrite C++ server in Java I use on the both side DataOutputStream.

Using a `while` is not a nice solution I prefer a more Java integrated solution.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:39:42.470

此流已启用自动刷新和 US-ASCII，如您所愿。

```
OutputStream os = socketChannel.socket().getOutputStream();
PrintStream ps = new PrintStream( os, true, "US-ASCII" );
ps.print( "tange é*"£$%&/(()=?'^ìì[]@!<>#òùèé+*" );
os.write( (byte)0 ); // end-of-message 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T14:33:22.597

我已经做了一个基于 BufferedWriter 和 BufferedReader 的可能解决方案，我使用了正确的 ASCII 扩展字符编码的 ISO-8859-1。

* * *

```
OutputStream os = socketChannel.socket().getOutputStream();
OutputStreamWriter osw = new OutputStreamWriter(os, "ISO-8859-1");
TBufferedWriter bw = new TBufferedWriter (osw);
bw.writeTMessageFlushing( dataArea.getText() );

InputStream is = socketChannel.socket().getInputStream();
InputStreamReader isr= new InputStreamReader(is, "ISO-8859-1") ;
TBufferedReader br= new TBufferedReader(isr);
// wait for response
String responseLine = br.readTMessage(); 
```

* * *

我只是简单地打开了 BufferedWriter 和 BufferedReader 的源代码，看看如何获​​得我的交互。

BufferedReader 不能简单地扩展，因为使用了一些函数。（它应该是从 java Boys 重写的）。它扩展了缓冲阅读器，但没用

* * *

```
import java.io.BufferedWriter;
import java.io.IOException;
import java.io.Writer;

public class TBufferedWriter extends BufferedWriter {

    public TBufferedWriter(Writer out){
        super( out );
    }
    public TBufferedWriter(Writer out, int sz){
        super( out, sz );
    }

    public void writeTMessage(String message) throws IOException {
         synchronized (lock) {
              super.write( message );
              super.write('\0');
         }
    }
     public void writeTMessageFlushing(String message) throws IOException {
         synchronized (lock) {
              super.write( message );
              super.write('\0');
              super.flush();
         }
    }

} 
```

* * *

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.Reader;

public class TBufferedReader extends BufferedReader {
    private Reader in;
    private char cb[];
    private int nChars, nextChar;
    private static final int INVALIDATED = -2;
    private static final int UNMARKED = -1;
    private int markedChar = UNMARKED;
    private int readAheadLimit = 0; /* Valid only when markedChar > 0 */

    /** If the next character is a line feed, skip it */
    private boolean skipNUL = false;
    /** The skipLF flag when the mark was set */
    private boolean markedSkipLF = false;
    private static int defaultCharBufferSize = 8192;
    private static int defaultExpectedLineLength = 80;

    /**
     * Creates a buffering character-input stream that uses an input buffer of
     * the specified size.
     *
     * @param  in   A Reader
     * @param  sz   Input-buffer size
     *
     * @exception  IllegalArgumentException  If sz is <= 0
     */
    public TBufferedReader( Reader in, int sz ) {
        super( in );
        if (sz <= 0) {
            throw new IllegalArgumentException( "Buffer size <= 0" );
        }
        this.in = in;
        cb = new char[ sz ];
        nextChar = nChars = 0;
    }

    /**
     * Creates a buffering character-input stream that uses a default-sized
     * input buffer.
     *
     * @param  in   A Reader
     */
    public TBufferedReader( Reader in ) {
        this( in, defaultCharBufferSize );
    }

    /** Checks to make sure that the stream has not been closed */
    private void ensureOpen() throws IOException {
        if (in == null) {
            throw new IOException( "Stream closed" );
        }
    }

    /**
     * Fills the input buffer, taking the mark into account if it is valid.
     */
    private void fill() throws IOException {
        int dst;
        if (markedChar <= UNMARKED) {
            /* No mark */
            dst = 0;
        } else {
            /* Marked */
            int delta = nextChar - markedChar;
            if (delta >= readAheadLimit) {
                /* Gone past read-ahead limit: Invalidate mark */
                markedChar = INVALIDATED;
                readAheadLimit = 0;
                dst = 0;
            } else {
                if (readAheadLimit <= cb.length) {
                    /* Shuffle in the current buffer */
                    System.arraycopy( cb, markedChar, cb, 0, delta );
                    markedChar = 0;
                    dst = delta;
                } else {
                    /* Reallocate buffer to accommodate read-ahead limit */
                    char ncb[] = new char[ readAheadLimit ];
                    System.arraycopy( cb, markedChar, ncb, 0, delta );
                    cb = ncb;
                    markedChar = 0;
                    dst = delta;
                }
                nextChar = nChars = delta;
            }
        }

        int n;
        do {
            n = in.read( cb, dst, cb.length - dst );
        } while (n == 0);
        if (n > 0) {
            nChars = dst + n;
            nextChar = dst;
        }
    }

    /**
     * Reads a line of text.  A line is considered to be terminated by any one
     * of a line feed ('\0')
     *
     * @param      ignoreNUL  If true, the next '\0' will be skipped
     *
     * @return     A String containing the contents of the line, not including
     *             any line-termination characters, or null if the end of the
     *             stream has been reached
     *
     * @see        java.io.LineNumberReader#readLine()
     *
     * @exception  IOException  If an I/O error occurs
     */
    String readTMessage( boolean ignoreNUL ) throws IOException {
        StringBuffer s = null;
        int startChar;

        synchronized (lock) {
            ensureOpen();
            boolean omitNUL = ignoreNUL || skipNUL;
bufferLoop:     for (;;) {
                    if (nextChar >= nChars) {
                        fill();
                    }
                    if (nextChar >= nChars) { /* EOF */
                        if (s != null && s.length() > 0) {
                            return s.toString();
                        } else {
                            return null;
                        }
                    }
                    boolean eol = false;
                    char c = 0;
                    int i;

                    /* Skip a leftover '\0', if necessary */
                    if (omitNUL && (cb[nextChar] == '\0')) {
                        nextChar++;
                    }
                    skipNUL = false;
                    omitNUL = false;

charLoop:               for (i = nextChar; i < nChars; i++) {
                            c = cb[i];
                            if ((c == '\0')) {
                                eol = true;
                                break charLoop;
                            }
                        }

                    startChar = nextChar;
                    nextChar = i;

                    if (eol) {
                        String str;
                        if (s == null) {
                            str = new String( cb, startChar, i - startChar );
                        } else {
                            s.append( cb, startChar, i - startChar );
                            str = s.toString();
                        }
                        nextChar++;
                        if (c == '\0') {
                            skipNUL = true;
                        }
                        return str;
                    }

                    if (s == null) {
                        s = new StringBuffer( defaultExpectedLineLength );
                    }
                    s.append( cb, startChar, i - startChar );
                }
        }
    }

    /**
     * Reads a line of text.  A line is considered to be terminated by any one
     * of a line feed ('\n'), a carriage return ('\r'), or a carriage return
     * followed immediately by a linefeed.
     *
     * @return     A String containing the contents of the line, not including
     *             any line-termination characters, or null if the end of the
     *             stream has been reached
     *
     * @exception  IOException  If an I/O error occurs
     *
     * @see java.nio.file.Files#readAllLines
     */
    public String readTMessage() throws IOException {
        return readTMessage( false );
    }
} 
```

* * *

其他有趣的课程是

[http://www.ibm.com/developerworks/java/zos/javadoc/jzos/index.html?com/ibm/jzos/TranscodingPrintStream.html](http://www.ibm.com/developerworks/java/zos/javadoc/jzos/index.html?com/ibm/jzos/TranscodingPrintStream.html)。

和

org.apache.james.util.CharTerminatedInputStream

* * *

我添加了一些关于 CharTerminatedInputStream 的消息。使用 thtat 类是危险的，因为您需要管理使用中的正确字符集。outputStream 更高级，您可以设置 InputStreamReader。

# .htaccess - Building a simple .htaccess hierachy rewrite

> ID：14880486
> 
> 赞同：1
> 
> 时间：2013-02-14T17:22:11.627
> 
> 标签：.htaccess, rewrite, subdirectory

I'm trying to do something rather simple here, but haven't been able to find the solution for it by searching here or Google - it must be that I don't know exactly what to search for.

Basically, I'm trying to do this with my .htaccess file:

www.mydomain.com/$ **shows** www.mydomain.com/$.php

and

www.mydomain.com/products/$ **shows** www.mydomain.com/products/$.php

Also, what is your favourite resource for learning how to code .htaccess files? I know my question is a simple one, and I would much like to be able to do things like this on my own from now on.

Thanks so much

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:41:21.600

如果我理解正确，您只想在每个请求中添加一个“.php”。你可以使用

```
RewriteRule ^(.*)$ $1.php 
```

为了实现这一点，即使用户请求 www.example.com/foo.php，它也会添加一个“.php”，所以你可能想要使用

```
RewriteRule ^(.*)(\.php)?$ $1.php 
```

**编辑：**如果您想允许访问现有文件，例如 css 或 JavaScript 文件或图像，请使用 RewriteCond：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^(.*)$ $1.php [END] 
```

# javascript - Dynamic placement of Twitter-Bootstrap popover

> ID：14880488
> 
> 赞同：0
> 
> 时间：2013-02-14T17:22:24.380
> 
> 标签：javascript, twitter-bootstrap

I'm trying to create a dynamic displacement function for bootstrap popovers, so that if the content is too large to be shown on the screen with "bottom" placement without a vertical scroll, it will show the popover upwards with "top" placement.

For this, I created a function:

```
function popoverPlacement(popoverHeight, element) {
    var offset = element.offset().top;
    var height = popoverHeight;
    var docheight = $(document).height();

    if (offset + height >= docheight) {
        return "top";
    }
    else {
        return "bottom"
    }
} 
```

Unfortunately, I need to specify the popoverHeight as a hardcoded value, since the content is generated for the popover and not added to the DOM, so I cannot obtain the height it will be.

This is how it is used:

```
$(this).popover({
            placement: function () { return popoverPlacement(270, this.$element); },
            title: "Status",
            trigger: "click",
            content: editStatusContent,
            html: true,
            delay: {
                show: 1,
                hide: 1
            },
            animation: false
        }); 
```

Is there a dynamic way to achieve this?

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:17:08.383

您可以通过将内容附加到文档中作为不可见节点来测量您的弹出框，如下所示：

```
var tpl = this.options.template;
var $inner_el = $(this.options.content).clone(false);
var $measure_el = $('.popover-content', tpl).append($inner_el)
                                            .parents('.popover');
$measure_el.css({
    visibility: 'hidden',
    position:   'absolute'
});

$measure_el.appendTo('body');
actual_height = $measure_el.height();
actual_width = $measure_el.width();
$measure_el.remove(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T18:34:06.613

我发现您可以在显示工具提示后使用绝对定位：

```
$('#liveCallData').tooltip('show');
var tooltip = $('#liveCallData .tooltip');
width = tooltip.width(); 
```

定位它：

```
tooltip.css({'position': 'absolute', top: y - 41, left: x - (width / 2) - 1}); 
```

# c# - WPF Image doesn't change with source change

> ID：14880490
> 
> 赞同：0
> 
> 时间：2013-02-14T17:22:28.147
> 
> 标签：c#

Hello i want to change an image by opening en openfiledialog and selecting a new one.. This By changing the source.. But it doens't work.. Could you please help me? Paginaholder is my image..

```
private void pdfOpenen()
{
    Microsoft.Win32.OpenFileDialog d = new Microsoft.Win32.OpenFileDialog();
    d.FileName = "Document";//begin map 
    Nullable<bool> pad = d.ShowDialog();
    //Controleren of er een bestand geselecteerd werd
    if (pad == true)
    {
        PaginaHolder.Source = BitmapFromUri(new Uri(pad, UriKind.Relative));
    }
}
public static ImageSource BitmapFromUri(Uri source)
        {
            var bitmap = new BitmapImage();
            bitmap.BeginInit();
            bitmap.UriSource = source;
            bitmap.CacheOption = BitmapCacheOption.OnLoad;
            bitmap.EndInit();
            return bitmap;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:41:48.407

一些应该解决的问题：

```
PaginaHolder.Source = BitmapFromUri(new Uri(pad, UriKind.Relative)); 
```

具体来说：

```
new Uri(pad, UriKind.Relative) 
```

没有将可为空的 bool 作为参数的 Uri 构造函数。利用：

```
PaginaHolder.Source = new BitmapImage( new Uri( d.FileName ) ); 
```

这是一个完整的工作示例：

```
var d = new OpenFileDialog();
d.Title = "Select a picture";
d.Filter = "All supported graphics|*.jpg;*.jpeg;*.png|JPEG (*.jpg;*.jpeg)|*.jpg;*.jpeg|Portable Network Graphic (*.png)|*.png";
if( d.ShowDialog() == true )
{
    PaginaHolder.Source = new BitmapImage( new Uri( d.FileName ) );
} 
```

您也可以使用您的`BitmapFromUri`方法：

```
PaginaHolder.Source = BitmapFromUri( new Uri( d.FileName ) ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T12:49:22.920

我使用可以正常工作的转换器将 pdf 文档转换为单独的图像。当我打开一个新的 PDF 文档时，我的转换会删除以前的第一个图像，然后将新的图像添加到地图中。这很好，但我的应用程序一直显示我以前的图像，当以前的图像已经从我的调试映射中消失时，这怎么办？这是我的代码：

```
Microsoft.Win32.OpenFileDialog d = new Microsoft.Win32.OpenFileDialog();
d.FileName = "Document";//begin map 
d.DefaultExt = ".pdf";
d.Filter = "PDF Files(*.pdf)|*.pdf";
Nullable<bool> pad = d.ShowDialog();
pdfPad = d.FileName;
File.Delete(AppDomain.CurrentDomain.BaseDirectory+"1.jpg");
pdfconverter.convertPDF(1, pdfPad);
pdfAantalPaginas = pdfconverter.getAantalPaginas(pdfPad);
Uri test = new Uri(AppDomain.CurrentDomain.BaseDirectory + "1.jpg");
PaginaHolder.Source = BitmapFromUri(test);
PaginaHolder.Source.Freeze(); 
```

# javascript - JsTree Click Event

> ID：14880491
> 
> 赞同：2
> 
> 时间：2013-02-14T17:22:28.543
> 
> 标签：javascript, jstree

Hi I am new to JsTree and I got a question on event. Let's call the tree structure stuff as LeftSide and the content rendered after you click one node on the tree as RightSide. What I can do is that you click one node at LeftSide then there is a subpage will be rendered at RightSide.

Now, what I need is to click something on the RightSide (This "something" can be a node name on the LeftSide) and it will render a subpage on the RightSide as same as if you click that node on the LeftSide.

I am not sure whether I make my question clear.

The point is that I don't know how to describe my question and search it one the web. So if you don't know the exact answer, you you just tell me which direction I should search for it. (If you tell me to read the official document, please specify which part rather than the whole doc.)

Appreciate for any help!!!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-08-14T02:27:08.907

我不认为“select_node.jstree”事件是最好的解决方案，因为当你刷新树时，它也会被触发。下面的代码片段是我使用的方式：</p>

```
$("#categories_tree").on("click", ".jstree-anchor", function(e) {
   var id = $("#categories_tree").jstree(true).get_node($(this)).id;
}) 
```

编辑：修复了一个右括号

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-14T12:51:55.370

您想监听`select_node.jstree`事件，并获取选定的节点。然后，您可以在页面右侧执行您想要的操作。

```
$("#jstree_id").on('select_node.jstree', function(e) {
    // gather ids of selected nodes
    var selected_ids = [];
    $("#jstree_id").jstree('get_selected').each(function () { 
        selected_ids.push(this.id); 
    }); 
    // do summit with them
    $('#RightSide').text('selected '+selected_ids);
}); 
```

编辑为`bind`已弃用以支持`on`.

# memory - 链接/构建白话/行话 - 动态链接方法

> ID：14880493
> 
> 赞同：2
> 
> 时间：2013-02-14T17:22:34.473
> 
> 标签：memory, makefile, static-linking, dynamic-linking

我熟悉一般程序内存布局（即：文本段、数据段、堆、堆栈等），并试图找到类似于此处描述和图表的内容：

[http://www.tenouk.com/Bufferoverflowc/Bufferoverflow1c.html](http://www.tenouk.com/Bufferoverflowc/Bufferoverflow1c.html)

但是，我试图找出三个不同的案例，每个案例都涉及使用外部库：

1.  构建时外部库的静态链接（即：`libtest.a`在`ldflags`
2.  在构建时动态链接外部库（即：`libtest.so`在`ldflags`
3.  在运行时动态链接外部库（即：`libtest.so` **不在**中`ldflags`，但库是通过`dlopen()`/`dlsym()`调用加载的）

更熟悉这个的人可以向我解释内存布局吗？我对 case`(2)`和`(3)`.

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-12T03:18:22.813

我发现 Solaris 链接器指南（位于[http://docs.oracle.com/cd/E26502_01/html/E26507/index.html](http://docs.oracle.com/cd/E26502_01/html/E26507/index.html)）写得非常好，在解释一个极其复杂的实用程序方面非常有用。

图表方面，您可能会在[http://docs.oracle.com/cd/E26502_01/html/E26507/chapter6-93046.html#scrolltoc](http://docs.oracle.com/cd/E26502_01/html/E26507/chapter6-93046.html#scrolltoc)、[http://docs.oracle.com/cd/E26502_01/html找到那些/E26507/chapter6-34713.html#scrolltoc](http://docs.oracle.com/cd/E26502_01/html/E26507/chapter6-34713.html#scrolltoc)会有所帮助。

# c - Why does this C-code work?

> ID：14880496
> 
> 赞同：0
> 
> 时间：2013-02-14T17:22:39.650
> 
> 标签：c, arrays, string, char, scanf

Why can I store more than 3 characters in the array "char array[3]" ? For example, in this code:

```
#include <stdio.h>

char array[3];

main()
{
scanf("%s", array);
putchar(array[5]);
return 0;
} 
```

You can enter a text of any length, and it will print the 6th letter. You can also print the entire text with "printf("%s", array). Why does this work although the array only has space for 3 characters?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T17:25:23.360

您的代码能够打印整个单词，因为它还没有被覆盖。您正在设置内存，然后立即从中读取。如果您稍后在程序执行时尝试从该内存位置读取，您可能会得到完全不同的结果。

**这是未定义的行为......在你的情况下，它打印了“正确”的输出。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:25:58.740

`array`被定义为一个全局数组，因此通常是部分的`.bss`一部分。由于您系统的 .bss 部分有足够的内存，您可以写入相同的内容。显然，这是一种违规行为，当您超出此部分的大小时会被捕获。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T17:30:04.523

由于 scanf() 的工作方式，它只会继续将发送给它的内容写入内存。因为您在写入后立即读取，所以数组使用的额外内存尚未被覆盖，因此您可以读取整个字符串。
C 中还有其他函数会限制您的输入，例如 fgets()。

# chef-infra - Vagrant Box 上的厨师：找不到加密的数据包秘密

> ID：14880503
> 
> 赞同：18
> 
> 时间：2013-02-14T17:23:22.067
> 
> 标签：chef-infra, vagrant

使用 (hosted-)chef 配置 vagrant box 时，出现以下错误：

```
No such file or directory - file not found '/tmp/encrypted_data_bag_secret' 
```

这是导致错误的调用：

```
ssl = Chef::EncryptedDataBagItem.load("ssl", s[:id]) 
```

我也找不到它通常驻留在我的其他服务器上的位置`encrypted_data_bag_secret`。`/etc/chef`

我是否缺少上传数据包机密的配置？

这是堆栈跟踪的其余部分：

```
[2013-02-14T16:51:15+00:00] ERROR: Running exception handlers
[2013-02-14T16:51:15+00:00] FATAL: Saving node information to /srv/chef/file_store/failed-run-data.json
[2013-02-14T16:51:15+00:00] ERROR: Exception handlers complete
[2013-02-14T16:51:15+00:00] FATAL: Stacktrace dumped to /srv/chef/file_store/chef-stacktrace.out
[2013-02-14T16:51:15+00:00] FATAL: Errno::ENOENT: No such file or directory - file not found '/tmp/encrypted_data_bag_secret' 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-14T22:34:01.897

配置 vagrant box 时，如果要使用加密的数据包，则必须提供数据包密钥的路径。

```
config.vm.provision :chef_solo do |chef|
  [...]
  chef.encrypted_data_bag_secret_key_path = '/etc/chef/encrypted_data_bag_secret'
  [...]
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-04T21:54:18.297

快速修改 Thomas Obermüller 对上述 Draco Ater 回答的回应。在 Vagrant 1.5.1 到 Vagrant 1.6.5（可能早于 1.5.1；我没有尝试过）中，有一些变化：

1.  `chef.encrypted_data_bag_secret`已弃用，设置它没有效果。
2.  Vagrant 将加密密钥放在，而不是像最初那样`/tmp/vagrant-chef-2/encrypted_data_bag_secret_key`默认为。`/etc/chef/encrypted_data_bag_secret`

# mysql - MYSQL，如何组合名字的前2个字母和姓氏的前5个字母

> ID：14880509
> 
> 赞同：1
> 
> 时间：2013-02-14T17:23:48.350
> 
> 标签：mysql, sql, substring, concat

我正在尝试编写一个 SQL 查询（使用 SELECT 函数），它将获取名字的前两个字母和姓氏的前 5 个字母，然后将它们组合起来并将它们放在一个名为“用户名”的新列中。” 我试过一起使用 SUBSTRING 和 CONCAT 函数，但我的语法不正确。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T17:27:18.900

您可以同时使用[`CONCAT()`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat)和[`SUBSTRING()`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_substr)：

```
select 
  concat(substring(fname, 1, 2), substring(lname, 1, 5)) UserName
from yourtable 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/e49e1/1)。

或者您可以[`LEFT()`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_left)使用`CONCAT()`：

```
select 
  concat(left(fname, 2), left(lname, 5)) UserName
from yourtable 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/e49e1/2)

如果您的样本数据是：

```
CREATE TABLE yourtable (`fname` varchar(4), `lname` varchar(50)) ;

INSERT INTO yourtable (`fname`, `lname`)
VALUES ('John', 'Smithton'),
    ('Abby', 'Jonesing'); 
```

两个查询都将返回：

```
| USERNAME |
------------
|  JoSmith |
|  AbJones | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-07-29T12:41:15.847

在 oracle 中，您可以使用类似的东西

`select concat(substr(fname,1,3), substr(lname,1,3)) as username from <table_name>;`

Note that u can use substr to trim integer datatypes too, while left() might only work for varchar.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-07-17T22:44:33.280

试试下面的查询

```
select first_name,
       substr(first_name,1,2)||substr(lower(last_name),1,5) as "USER NAME",
       last_name 
from employees; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-06-12T12:09:14.510

使用以下几行

```
select  concat(left(empfname, 2) + ' ',left(emplname, 2)) UserNamefrom employee 
```

# pyqt4 - QtGui.QMainWindow 中不包含小部件

> ID：14880517
> 
> 赞同：0
> 
> 时间：2013-02-14T17:24:11.227
> 
> 标签：pyqt4, pyside, opencascade

![小部件掉出框架...](../Images/54232212e74c5e6c3442efa3a779ded1.png)

你好，

PySide / PyQt4 新手在这里。我们正在将 OpenCasCade 查看器后端从 X11 移植到 Cocoa。我不明白为什么我的小部件不包含在 QtGui.QMainWindow 中...任何指向我应该研究的内容的指针都非常感谢...作为 PySide 的新手，API 的范围可能有点压倒性的;)

```
 from qtDisplay import qtViewer3d

    class MainWindow(QtGui.QMainWindow):
        def __init__(self, *args):
            apply(QtGui.QMainWindow.__init__,(self,)+args)
            self.canva = qtViewer3d(self) # QtGui.QWidget instance
            self.setWindowTitle("pythonOCC-%s 3d viewer ('qt' backend)"%VERSION)
            self.setCentralWidget(self.canva)
            self.resize(1024,768)
            self.menuBar = self.menuBar()
            self._menus = {}
            self._menu_methods = {}

        def add_menu(self, menu_name):
            _menu = self.menuBar.addMenu("&"+menu_name)
            self._menus[menu_name]=_menu

        def add_function_to_menu(self, menu_name, _callable):
            assert callable(_callable), 'the function supplied is not callable'
            try:
                _action = QtGui.QAction(_callable.__name__.replace('_', ' ').lower(), self)
                self.connect(_action, QtCore.SIGNAL("triggered()"), _callable)
                self._menus[menu_name].addAction(_action)
            except KeyError:
                raise ValueError('the menu item %s does not exist' % (menu_name))
    app = QtGui.QApplication(sys.argv)
    win = MainWindow()
    win.canva.InitDriver()
    win.show()
    display = win.canva._display
    display.SetBackgroundImage(get_bg_abs_filename())        
    def add_menu(*args, **kwargs):
        win.add_menu(*args, **kwargs)
    def add_function_to_menu(*args, **kwargs):
        win.add_function_to_menu(*args, **kwargs)
    def start_display():
        app.exec_() 
```

# windows - windows x86堆栈中的堆栈是如何定义的？

> ID：14880518
> 
> 赞同：1
> 
> 时间：2013-02-14T17:24:15.837
> 
> 标签：windows, memory-management, assembly, operating-system, stack

首先，我将展示对堆栈的理解不足，然后我将提出一个无法很好回答的略微连贯的问题，因为该问题不够具体，无法引出一个有条理的答案。

那么，当程序运行时，函数被压入堆栈——这意味着堆栈指针是递增还是递减？

堆栈内存分配中究竟存储了什么？指向变量数据的指针，指向程序 est 的指针？我只是不明白堆栈中到底存储了什么（什么数据类型，什么类型的引用，它们是如何存储的）我希望一个函数存储它的局部变量指针和一个指向调用它的地址的指针，以便它可以返回.

此外，windows x86 虚拟内存分配实际上将单个虚拟内存块映射到任意多个物理内存地址，因此堆栈在 windows x86 系统的物理内存中是连续的还是不连续的？

最后，假设堆栈存储在 x86 上 32 位窗口上的应用程序的用户分配的虚拟内存中，堆栈指针（引用内存的高地址还是低地址？）是 31 位的（31 是因为用户分配的并且高2GB保留给内核分配）小端引用，对吗？

当数据到达堆栈时（就像一个函数被输入并为一个新的 DWORD 分配内存）存储在该 DWORD 中的数据被推入堆栈并且堆栈指针是递增还是递减？系统如何同时感知堆栈的两端？

---- ESP在这里？

|-变量x的引用地址

|- 函数 1 中变量 x 的内存地址中要存储的整数数据

|----上面的功能1块^^

|

|

---- 还是这里的 ESP？

并且从这里引用地址和整数数据将被弹出到寄存器中，并且 mov 操作会将整数数据存储在分配的内存位置？

当新数据进入堆栈时，我听说堆栈“向下”增长，但这似乎不合理，因为只有更高和更低的内存地址 - 我知道只有堆栈的一端需要递增/递减，但它是高地址或低地址，堆栈长度（高度）如何分隔？当堆栈“增长”过大时，系统如何理解？

抱歉所有问题，但我已经做了很多阅读，用于描述我一直在阅读的概念的术语在我的词汇表中没有很好地操作。此外，我在谷歌、维基百科和这个网站上查了一下，找不到解决我具体问题的解释。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T17:40:07.493

行。堆栈只是一种抽象数据类型。好的。一个内存数组，您可以将数据放置（puhs）到末尾并移除（pop）它。向上或向下增长，从前面或后面，或任何取决于它的实现方式。好的。

现在 (a) 系统堆栈更加明确。它是由程序分配的 RAM 区域，或本地线程存储或其他任何东西。指针被放置在其内存位置的“末端”，并且向顶部生长。推送将数据放在当前位置的堆栈上（减去数据大小，使其不会超过末尾），因此在写入之前递减。强制时，新的堆栈指​​针指向最后一个“推送”值的开始。

为什么要倒退？约定和易用性。考虑一个嵌入式系统或一些具有更多有限 RAM 资源的旧系统。如果我们让堆从 RAM 的顶部开始——就在代码和静态/常量数据之后，并且我们需要在同一个 RAM 空间中使用另一种类型的存储，为什么不让它从后面增长呢？这样您就不必担心每个部分必须有多大。当所有 RAM 都用完后，它们将在中间某个地方相遇（并且下一次写入将通过堆栈溢出而繁荣）。易于维护和创建且高效 - 无需猜测适当的大小等。

就从这里开始吧。在这一点上，虚拟地址等不应该让你太担心。当空间不足时，它们只是帮助“繁荣”部分。我怀疑堆栈是否会分成多个页面，但如果是，让操作系统处理它，一切都很好（而且速度很慢，但那是另一回事了。）

现在堆栈上发生了什么 - 无论您想要什么。通常，传递给函数的参数超出了可以放入寄存器的范围，在函数之外不需要的作用域变量，有时用于 this 指针的 c++ 胶水，有时更多`alloca()`用于将堆栈视为动态内存 - 你会看到这在线程代码中通常有助于防止内存写入竞争条件等。此外，不适合寄存器的值返回的值通常也会返回到堆栈中。基本上，您在函数中看到的每个本地变量都有很大的机会在某个时候存在于堆栈中，因为寄存器已填满并且需要更多空间。因此，许多系统试图确保堆栈内存尽可能快。

要回答您剩下的问题 - 系统可能知道也可能不知道堆栈的两侧 - 取决于平台。我猜windows是通过跟踪如果写入超出结束位置来了解堆栈开始的。不成对的推送/弹出会破坏程序的一天，有时还会导致操作系统挂起（现在更少了）。我无法回答您的 Windows 特定 32/31 位地址问题，因为我在那里没有直接经验。其他人可以抓住那部分。最后，堆栈增长方向是令人困惑的术语。我通常认为系统堆栈是“向上”增长的，但这可能只是我。

希望这对您有所帮助并解决一些问题！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:40:20.120

> 当程序运行时，函数被推入堆栈 - 这意味着堆栈指针是递增还是递减？

这取决于堆栈的实现方式。如果它从内存的末尾向后增长，它就会递减。如果它从内存的开头向前增长，则递增。

> 堆栈内存分配中究竟存储了什么？

任何给定的程序或编程语言都压入堆栈。这可以包括返回地址、值类型、指向对象的指针和堆栈帧。

> windows x86虚拟内存分配实际上将单个虚拟内存块映射到任意多个物理内存地址，因此堆栈在windows x86系统的物理内存中是连续的还是不连续的？

见这里：[http ://www.dirac.org/linux/gdb/02a-Memory_Layout_And_The_Stack.php](http://www.dirac.org/linux/gdb/02a-Memory_Layout_And_The_Stack.php)

> 当堆栈“增长”过大时，系统如何理解？

它到达堆的顶部。

# iphone - NSDate 和 NSDateFormatter 不是我当前的本地或字符串日期

> ID：14880521
> 
> 赞同：1
> 
> 时间：2013-02-14T17:24:19.523
> 
> 标签：iphone, objective-c

我阅读了所有内容`NSDate`，`NSDateFormatter`但没有解决我的问题。我需要获取我当前的日期，并在 NSDate 对象中添加这个日期，但是当我这样做时，我的时间总是带有 +2 小时。我正在做这样的事情：

```
NSDateFormatter * dateformatter = [[NSDateFormatter alloc]init];
[dateformatter setLocale:[NSLocale currentLocale]];
[dateformatter setDateFormat:@"yyyy-mm-dd HH:mm:ss"];
//NSTimeZone* localTimeZone = [NSTimeZone localTimeZone];
//NSLog(@"timezone local = %@",localTimeZone);
//[NSTimeZone timeZoneWithAbbreviation:@"BRST"];
NSString * current = [dateformatter stringFromDate:[NSDate date]];
NSLog(@"current = %@",current); // Cool this is my current date!

NSDate *thedate = [dateformatter dateFromString:current]; 
NSLog(@"date = %@",thedate);// NO! my hours is wrong 
```

我需要在 中添加我当前的日期`NSDate`，并且还需要添加`NSDate`带有字符串的 a（带有方法`stringFromDate`）。字符串示例：2013-01-21 17:05:17。当在返回 NSDate 的方法中传递这个字符串时`stringFromDate`，我打印 NSDate 并给我带来这个错误的日期：2013-01-21 19:05:17 +0000。

只是简历：

> 需要将我当前的日期添加到 NSDate 中，还需要添加`NSDate`类似`NSString`2013-01-21 17:05:17 的内容。我现在的本地是巴西/圣保罗，NSTimerZone 的缩写是 BRST。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:09:26.340

`theDate`是正确的，您只需在另一个时区（+0000）中显示它。

NSDate 对象对时区一无所知。但是 NSDateFormatter 对象确实知道。默认情况下 NSDateFormatter 使用当前时区（用户在操作系统首选项中设置）。

当您创建一个字符串并显示它时，它会显示在您的时区 BRST (-0200): 2013-01-21 17:05:17 中。然后，当您从此字符串创建日期时，日期格式化程序再次将其视为 BRST 时区中的日期。但是当您显示原始 NSDate 对象时，它会显示 +0000 时区的日期：2013-01-21 19:05:17 +0000，即 BRST 中的 17:05:17。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:29:42.103

这是因为在你的`dateformatter`你使用`HH`而不是`hh`. 在您的代码中将其更改为：

```
[dateformatter setDateFormat:@"yyyy-mm-dd hh:mm:ss"]; 
```

您可以在此处查找有关此主题的信息：[链接](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html)

> 它使用 yyyy 来指定年份组件。一个常见的错误是使用 YYYY。yyyy 指定日历年，而 YYYY 指定年份（“一年中的一周”），用于 ISO 年-周日历。在大多数情况下，yyyy 和 YYYY 产生相同的数字，但它们可能不同。通常，您应该使用日历年。

# centos - CentOs 6.3 外接显示器

> ID：14880526
> 
> 赞同：1
> 
> 时间：2013-02-14T17:24:31.953
> 
> 标签：centos

我在使用 nvidia 显卡使我的外接显示器在 centOs 6.3 下工作时遇到问题。我还安装了 nvidia 驱动程序，但是当我重新启动系统时，它没有打开 X 驱动程序，所以我不得不重命名 xorg.conf 文件。为了使我的外接显示器正常工作，有什么建议可以一步一步地进行吗？请记住，我是 centOS 的新手。先感谢您。

# android - 检测到 NFC 空标签时，Android 应用程序未启动

> ID：14880530
> 
> 赞同：2
> 
> 时间：2013-02-14T17:24:45.893
> 
> 标签：android, nfc

我在检测空标签时遇到问题。我的意思是空标签是一个带有 NdefRecord.TNF_EMPTY 类型记录的 Ndef 标签。我的应用程序使用所有标签启动，但我在处理此类内容时遇到了问题。

```
<intent-filter>
    <action android:name="android.nfc.action.NDEF_DISCOVERED"/>
    <category android:name="android.intent.category.DEFAULT" />
</intent-filter>
<intent-filter>
    <action android:name="android.nfc.action.TECH_DISCOVERED" />
    <meta-data android:name="android.nfc.action.TECH_DISCOVERED"
                android:resource="@xml/techlist" />
</intent-filter>
<intent-filter >
    <action android:name="android.nfc.action.TAG_DISCOVERED" />
    <category android:name="android.intent.category.DEFAULT" />
</intent-filter> 
```

我想技术列表不是问题，因为 Ndef 标签被正确检测到，反正我的技术列表就是这个

```
<resources xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
<tech-list>
    <tech>android.nfc.tech.IsoDep</tech>
</tech-list>
<tech-list>
    <tech>android.nfc.tech.NfcA</tech>
</tech-list>
<tech-list>
    <tech>android.nfc.tech.NfcB</tech>
</tech-list>
<tech-list>
    <tech>android.nfc.tech.NfcF</tech>
</tech-list>
<tech-list>
    <tech>android.nfc.tech.NfcV</tech>
</tech-list>
<tech-list>
    <tech>android.nfc.tech.Ndef</tech>
</tech-list>
<tech-list>
    <tech>android.nfc.tech.NdefFormatable</tech>
</tech-list>
<tech-list>
    <tech>android.nfc.tech.MifareClassic</tech>
</tech-list>
<tech-list>
    <tech>android.nfc.tech.MifareUltralight</tech>
</tech-list> 
```

“NFC 任务启动器”和“标签”应用程序能够检测到此类内容。

“TagInfo”应用程序将标签检测为 NDEF

```
Empty record
type: [NULL]
payload length: 0 bytes 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T11:54:25.937

好吧，经过几个小时的测试，我已经解决了这个问题，但我不知道为什么会这样。

问题在于 AndroidManifest.xml 中的这段代码

```
<intent-filter>
   <action android:name="android.nfc.action.TECH_DISCOVERED" />
   <meta-data android:name="android.nfc.action.TECH_DISCOVERED"
            android:resource="@xml/techlist" />
</intent-filter> 
```

我已将其更改为

```
<intent-filter>
   <action android:name="android.nfc.action.TECH_DISCOVERED" />
</intent-filter>
<meta-data android:name="android.nfc.action.TECH_DISCOVERED" android:resource="@xml/techlist" /> 
```

只需取出标签“元数据”问题就解决了，但为什么呢？

# php - 通过 Javascript 传递 MySQL 查询

> ID：14880531
> 
> 赞同：1
> 
> 时间：2013-02-14T17:24:52.710
> 
> 标签：php, javascript, jquery, mysql, post

在 Javascript 函数中，我有以下 JQuery，我在其中调用 PHP 脚本（即 getDBData.php）从查询中获取数据库数据：

```
$("#dbcontent").load("getDBData.php", {query: "SELECT * FROM `texts` WHERE name='John' LIMIT 10;"}); 
```

在 getDBData 中，我通过 POST 获取此查询：

```
$query = $_POST['query']; 
```

并将其作为 mysql_query 的输入：

```
$query = mysql_query($query) or die(mysql_error()); 
```

但是，我收到以下 MySQL 错误：

*您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '\'John\' LIMIT 10' 附近使用正确的语法*

这里有什么问题？我想它在传递查询时与字符编码有关，但似乎没有正确。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T17:30:14.683

在任何情况下，您都不应该这样做。您应该传递可用于构建正确查询的参数。

至少做这样的事情......

**Javascript**

```
$.post('getDBData.php', {
   query: 'getTextsByUser',
   user: 'John'
}); 
```

**PHP**

```
$queries = array(
   'getTextsByUser' => 'SELECT * FROM texts WHERE name = ?',
   'getNewsById' => 'SELECT * FROM news WHERE id = ?'
);
$stmt = $dbConnection->prepare($queries[$_POST['query']);
$stmt->bind_param('s', $_POST['user']);

$stmt->execute();

$result = $stmt->get_result();
while ($row = $result->fetch_assoc()) {
    // do something with $row
} 
```

然后`getUsers`通过 ajax 来确定要运行哪个查询。

**注意：**如果您刚刚开始这个项目，[mysql_query()](http://php.net/manual/en/function.mysql-query.php)已被弃用，您应该考虑切换到[mysqli](http://www.php.net/manual/en/book.mysqli.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:42:49.263

**正如其他人指出的那样，不要这样做！Webnet 的解决方案要好得多！**

但我相信我知道如何解决你最初的问题。我也有过一次，在解析 JSON 时，使用`stripslashes()`.

```
$query = stripslashes($_POST['query']);
mysql_query($query); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T17:28:50.113

正如许多人所说，这是非常危险的。但是，我认为失败的是您需要使用 URL 编码指定查询。请参阅[http://en.wikipedia.org/wiki/Query_string#URL_encoding](http://en.wikipedia.org/wiki/Query_string#URL_encoding)。这尤其适用于`=`符号。

# ios - 什么时候使用presentedViewController 合适？

> ID：14880535
> 
> 赞同：2
> 
> 时间：2013-02-14T17:24:58.407
> 
> 标签：ios, segue, viewcontroller

假设我正在使用 segues 转换视图控制器。我在视图控制器 1 上有一个 textField，在第二个视图控制器上有一个标签。当我转到第二个视图控制器时，我可以使用以下代码轻松设置标签：

视图控制器 #2

```
-(void) viewWillAppear: (BOOL) animated
{ 
 self.labelVC2.text = ((VC1 *)self.presentingViewController).textFieldVC1.text;
} 
```

这很有意义。在这种情况下使用 presentingViewController 属性。虽然试图弄清楚什么时候使用 presentViewController 属性，但似乎合乎逻辑的是，它将在 prepareForSegue 方法中的第一个视图控制器中使用，如下所示：

视图控制器 #1

```
 -(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
 {
    if([[segue identifier] isEqualToString:@"SegueToNextVC"])
    {
       ((VC2 *)self.presentedViewController).labelVC2.text = self.textFieldVC1.text;
    }
 } 
```

但是，这似乎不起作用，我假设这是因为在 prepareForSegue 中，我的第二个视图控制器的一个新实例在 segue 发生之前的那一刻被调用，从而丢失了我刚刚设置的属性。如果我在这方面是正确的，那么什么时候是使用presentedViewController 属性的合适时间？显然我不会在我的第二个视图控制器上使用这个属性，因为我可以直接访问这个类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:32:54.657

看一下. [_](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIStoryboardSegue_Class/Reference/Reference.html) `UIStoryboardSegue`它有几个我认为对你非常有用的属性。

`sourceViewController`- “...视图控制器，其内容显示在 segue 的开头”，即`self`

`destinationViewController`- “...查看控制器，其内容应显示在 segue 的末尾”，这是`VC2`您尝试访问的内容`self.presentedViewController`

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
 {
    if([[segue identifier] isEqualToString:@"SegueToNextVC"])
    {
       ((VC2 *)destinationViewController).labelVC2.text = self.textFieldVC1.text;
    }
 } 
```

回到你的问题......你什么时候想使用`presentedViewController`？答案是，只要您还没有对`presentedViewController`. 这是一个例子。

你有一堆类都有相同的父级。`SubViewController1`, `SubViewController2`，`SubViewController3`它们都是 的子类，`MyViewController`你现在可能有也可能没有。所以你想检查它是否存在并告诉它完成它正在做的事情并离开。令人高兴的是，有一种方法`MyViewController`可以让你做到这一点。

```
if (self.presentedViewController) {
    MyViewController *subVC = (MyViewController *)self.presentedViewController;
    [subVC finishAndGoAway];
} 
```

这只是您可能使用它的一个示例。在许多其他情况下它会很有用，但也有很多时候它完全没有意义，因为您已经参考了所呈现的内容，因此您不需要使用默认值。

# sql - MS Access SQL - 连接其他两个查询的简单查询没有结果

> ID：14880539
> 
> 赞同：0
> 
> 时间：2013-02-14T17:25:12.070
> 
> 标签：sql, ms-access, join

谁能告诉我为什么这个简单的 JOIN 查询给了我一个没有结果的表？当我分别运行 countINTmonth 和 countDEPTmonth 查询时，它们会给出我期望的结果。但是，当我运行简单的 JOIN 查询时，它给了我一个包含列名但没有数据的表——但也没有任何错误消息！

CountINTmonth 查询

```
SELECT Count(clients.ssn) AS CountofIntakes, month(clients.prog_start) AS Month2, year(clients.prog_start) AS Year2
FROM clients
WHERE clients.prog_start BETWEEN [Enter Start Date] AND [Enter End Date]
GROUP BY year(clients.prog_start), month(clients.prog_start)
ORDER BY year(clients.prog_start) DESC , month(clients.prog_start) DESC; 
```

CountDEPTmonth 查询

```
SELECT Count(clients.ssn) AS CountOfDepartures, month(clients.[departure date]) AS Month1, year(clients.[departure date]) AS year1
FROM clients
WHERE clients.[departure date] BETWEEN [Enter Start Date] AND [Enter End Date]
GROUP BY year(clients.[departure date]), month(clients.[departure date])
ORDER BY year(clients.[departure date]) DESC , month(clients.[departure date]) DESC; 
```

连接前两个的查询

```
SELECT countdeptmonth.countofdepartures, countintmonth.countofintakes, countdeptmonth.month1, countdeptmonth.year1
FROM countdeptmonth
INNER JOIN
countintmonth
ON (countdeptmonth.year1=countintmonth.year2 AND countdeptmonth.month1=countintmonth.month2)
ORDER BY countdeptmonth.year1 DESC, countdeptmonth.month1 DESC 
```

当我将 JOIN 更改为 LEFT JOIN 时，会出现数据，但 countofintakes 列为空。当我将 JOIN 更改为 RIGHT JOIN 时，唯一具有数据的列是 countofintakes。

表上的注释
CLIENTS 表有一堆具有不同数据点的列。SSN 是主键。prog_start 是他们开始我们治疗计划的日期字段。[departure date] 是他们离开我们计划的日期字段。[输入开始日期] 和 [输入结束日期] 应该是用户在运行查询时输入的日期范围——两个查询的日期应该相同。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:57:21.513

I may have solved my own problem. I just added the MonthName function to the Month1 and Month2 columns.

```
MonthName(month(clients.prog_start)) AS Month2 
```

And

```
MonthName(month(clients.[departure date])) AS Month1 
```

Once I did that, the JOIN query showed the correct results. I didn't even need to update the GROUP BY fields.

Anyone know why the query couldn't join on the just the number of the month and why it needed the name to join correctly?

# ruby - 在 Ruby 1.9.3 上使用较旧的 VMC - 错误：“无法将哈希转换为字符串”

> ID：14880546
> 
> 赞同：0
> 
> 时间：2013-02-14T17:25:30.870
> 
> 标签：ruby, cloud-foundry, vmc

我最近在我的 Win7 PC 上安装了 Ruby 1.9.3。然后我安装了最新版本的 VMC，它似乎运行良好。但是，我被建议卸载该版本，因为它在我的环境中无法正常工作，而是安装 0.3.21。

我已经这样做了，但是现在我输入的每个 VMC 命令基本上都会出现以下错误。我尝试重新安装 Ruby、Sinatra 和 VMC，但仍然遇到相同的错误。有任何想法吗？

```
C:\$eclipse\TestProjectRuby>vmc -v
can't convert Hash into String
C:/Ruby193/lib/ruby/gems/1.9.1/gems/vmc-0.3.21/lib/cli/commands/base.rb:60:in `expand_path'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/vmc-0.3.21/lib/cli/commands/base.rb:60:in `block in load_manifest_structure'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/vmc-0.3.21/lib/cli/commands/base.rb:59:in `each'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/vmc-0.3.21/lib/cli/commands/base.rb:59:in `load_manifest_structure'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/vmc-0.3.21/lib/cli/commands/base.rb:81:in `load_manifest'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/vmc-0.3.21/lib/cli/commands/base.rb:28:in `initialize'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/vmc-0.3.21/lib/cli/runner.rb:465:in `new'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/vmc-0.3.21/lib/cli/runner.rb:465:in `run'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/vmc-0.3.21/lib/cli/runner.rb:14:in `run'
C:/Ruby193/lib/ruby/gems/1.9.1/gems/vmc-0.3.21/bin/vmc:5:in `<top (required)>'
C:/Ruby193/bin/vmc:23:in `load'
C:/Ruby193/bin/vmc:23:in 'main' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T10:48:58.990

为什么建议您卸载最新版本？可能存在 gem 依赖问题，但已解决。

# wpf - 带有编辑记录按钮和多个编辑窗口的 WPF MVVM Light DataGrid

> ID：14880547
> 
> 赞同：0
> 
> 时间：2013-02-14T17:25:33.203
> 
> 标签：wpf, mvvm, datagrid, viewmodel, mvvm-light

我正在学习使用 MVVM Light，我正在制作一个程序，它使用数据库优先模型和实体框架。

我有一个绑定到 ViewModel 的 DataGrid，它从 Repository 获取数据。我正在尝试制作一个按钮，单击该按钮会打开一个窗口，该按钮绑定到它自己的 View Model，并允许您通过以下方式将记录添加到 DataGrid将其添加到具有事件的存储库中，该事件在添加项目时调用，以便它可以更新 DataGridViewModel。

这里的一切都很好。我打开表单，输入数据，按添加，记录被添加到数据库中，DataGrid 被存储库事件自动刷新。

当我打开多个“添加记录”窗口时，问题就来了。当我在其中一个窗口中输入内容时，它会出现在另一个窗口中。

我知道这是因为“添加记录”窗口的两个实例都绑定到视图模型的同一个实例。

有没有办法解决这个问题，所以每个窗口都可以独立？我知道目前这看起来不是什么大问题，但是将来我计划使用具有相同视图模型的同一个窗口来编辑记录（这是一个好方法，你能推荐我一些通过的方式吗？记录 id 或记录本身从 DataGrid 窗口到添加/编辑记录窗口？）。

提前致谢！告诉我我是否遗漏了什么，我会添加它：）

**编辑：** 好的，这就是我想出的：

```
public EditParentViewModel EditParent
    {
        get
        {
            EditParentViewModel editParentViewModelInstance = new EditParentViewModel(ServiceLocator.Current.GetInstance<IParentsRepository>(),
                ServiceLocator.Current.GetInstance<IChildrenRepository>(),
                ServiceLocator.Current.GetInstance<IBailiffsRepository>());
            return editParentViewModelInstance;
        }
    } 
```

它正在工作，但这是向视图模型提供存储库的正确方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:02:33.273

算上你正在使用`ViewModelLocator`，你应该有这样的东西：

```
public class ViewModelLocator
{
    public ViewModelLocator()
    {
        ServiceLocator.SetLocatorProvider(() => SimpleIoc.Default);

        SimpleIoc.Default.Register<AddRecordViewModel>();
    }

    public AddRecordViewModel AddRecordViewModel
    {
        get { return ServiceLocator.Current.GetInstance<AddRecordViewModel>(); }
    }
} 
```

每次只返回一个新的视图模型：

```
public class ViewModelLocator
{
    public ViewModelLocator()
    {
    }

    public AddRecordViewModel AddRecordViewModel
    {
        get { return new AddRecordViewModel(); }
    }
} 
```

这样，您的表单总是会获得一个新的视图模型，而不是在您的`ServiceLocator`.

# c# - 扩展的 SqlProfileProvider，如何调用我的自定义方法？

> ID：14880548
> 
> 赞同：0
> 
> 时间：2013-02-14T17:25:35.623
> 
> 标签：c#, sqlprofileprovider

我正在使用`MySqlProfileProvider`which 扩展`SqlProfileProvider`类。在我的课堂上，我正在重写`Initialize`以更改基础的连接字符串。这一切都很好。

我的问题是我需要在配置文件提供程序初始化后进行调用以更改连接字符串（初始化时我没有创建正确连接字符串所需的信息），我似乎无法访问方法。

它适用于我的自定义`SqlMembershipProvider`类，以便调用我调用的函数

```
((MySqlMembershipProvider)Membership.Providers).ChangeConnectionString(sRequiredData); 
```

班上：

```
public class MySqlMembershipProvider : SqlMembershipProvider
{
    public override void Initialize(string name, System.Collections.Specialized.NameValueCollection config) {...}

    public virtual void ChangeConnectionString(string sRequiredData)
    {
        // get db name 
        string sDATABASE_NAME = ManageDBs.GetCompanyDBName(sRequiredData);

        // Set private property of Membership provider. 
        FieldInfo connectionStringField = GetType().BaseType.GetField("_sqlConnectionString", BindingFlags.Instance | BindingFlags.NonPublic);

        string connectionString = connectionStringField.GetValue(this).ToString();

        if (!connectionString.Contains(sDATABASE_NAME))
        {
            connectionString = connectionString.Replace("DATABASE_NAME", sDATABASE_NAME);

            connectionStringField.SetValue(this, connectionString);
        }
    }
} 
```

我的个人资料提供程序中有相同的方法，但我找不到如何调用它。我试过在 中访问它`ProfileBase`，但没有运气，`ProfileProvider`而且`Profile`谷歌上似乎没有任何人有这个解决方案。

**编辑**

我正在寻找类似的东西

```
((MySqlProfileProvider)Profile.Provider).ChangeConnectionString(sRequiredData); 
```

但不幸的是，您无法`Provider`通过个人资料访问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T14:00:03.533

我通过反复试验找到了解决方案：

```
((MySqlProfileProvider)ProfileBase.Properties["ANY_PROFILE_PROPERTY"].Provider).ChangeConnectionString(sRequiredData); 
```

# mysql - 拥有子句中的最大计数

> ID：14880549
> 
> 赞同：2
> 
> 时间：2013-02-14T17:25:37.237
> 
> 标签：mysql, count, max, having-clause

我必须找到最先出现的演员。

独奏会（歌剧、演员、角色、出场顺序）

我试过这样：

```
select distinct R1.Actor, count(R1.Actor) as nro
from Recital R1
where R1.AppOrd='1'
group by Actor
having max(nro) 
```

但它返回一个空表。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:48:39.127

这将显示顶级演员，但如果出现平局，则只会显示其中一名演员：

```
select R1.Actor, count(R1.Actor) as nro
from Recital R1
where R1.AppOrd='1'
group by R1.Actor
ORDER BY nro DESC
LIMIT 1; 
```

# javascript - JS返回值与从外部返回的函数不同

> ID：14880550
> 
> 赞同：0
> 
> 时间：2013-02-14T17:25:37.353
> 
> 标签：javascript

第一篇在这里！试图解决这个问题并在网上寻找答案但不是运气 - 我知道它在那里，但似乎无法弄清楚 - 我有一个 javascript 代码来返回用户的位置，如下所示：

```
var myLatlon = navigator.geolocation.getCurrentPosition(onSuccess, onError); 
```

功能如下：

```
var onSuccess = function(position) {
    var latlon=position.coords.latitude+','+position.coords.longitude;
    return latlon;
}; 
```

当我做一个 console.log(latlon); 在上面的函数内部，它返回用逗号分隔的实际纬度和经度。

但是当我在第一行之后执行 console.log(myLatlon) 时；它返回：**{"timer":true}**

我需要从我的函数返回实际的纬度和经度。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:27:33.340

通常，您根本无法从用于处理异步执行的回调中返回。任何取决于您要返回的值的代码都*必须*在回调中调用。

这就是异步的工作原理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:28:20.413

您不能从 中返回值`navigator.geolocation.getCurrentPosition`。这就是异步调用的本质。在调用 `navigator.geolocation.getCurrentPosition`回调之前完成调用。`onSuccess`您必须在回调中使用您的坐标

通常，重构代码与返回代码的效果几乎相同。

```
navigator.geolocation.getCurrentPosition(function(position){
    // Use position from here
}, onError);
// This line is reached before the commented line in the anonymous function above, that's why you can't return the value 
```

# php - 从 wordpress 中提取数据的垃圾值

> ID：14880551
> 
> 赞同：0
> 
> 时间：2013-02-14T17:25:46.833
> 
> 标签：php, wordpress

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:40:44.087

看起来你和提要之间的编码有所不同。您可以尝试使用以下命令将其转换为 UTF-8：

`$utf8_content = mb_convert_encoding($content, 'UTF-8', mb_detect_encoding($content));`

还要仔细检查您的浏览器是否也设置为 UTF-8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T08:12:26.430

以下代码行为我修复了垃圾值问题：

```
$ret = $feed;     
echo htmlspecialchars_decode(htmlentities($ret, ENT_QUOTES | ENT_IGNORE, 'UTF-8')); 
```

# ruby-on-rails - Getting Devise to recognize my authentication module

> ID：14880552
> 
> 赞同：3
> 
> 时间：2013-02-14T17:25:44.870
> 
> 标签：ruby-on-rails, authentication, devise

I am attempting to write my own Devise authentication module following the procedure outlined in [http://4trabes.com/2012/10/31/remote-authentication-with-devise/](http://4trabes.com/2012/10/31/remote-authentication-with-devise/)

I've created a User class under app/models and Devise::Models and Devise::Strategies modules under lib. I've also added:

```
require 'remote_authenticatable'  

config.warden do |manager|
   manager.strategies.add(:remote, Devise::Strategies::RemoteAuthenticatable)
   manager.default_strategies(:scope => :user).unshift :remote
end 
```

to my initializers/devise.rb file.

And I've added:

```
devise_for :users 
```

to my routes.rb

However, for some reason the sign_on and sign_off routes do not appear in my rake routes.

Is there some good documentation on how the Devise plugin works with these kinds of extensions?

Peter.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:37:28.547

好的，我想通了。

我需要添加

```
Devise.add_module :remote_authenticatable, :controller => :sessions,  :route => { :session => :routes } 
```

到我的配置/初始化程序/设计文件。谁能解释这条线的作用？特别关注最后两个参数？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-14T17:30:14.680

默认情况下调用它`sign_in`并且`sign_out`:)

# node.js - 使用 WebSockets 过滤和排序结果？

> ID：14880553
> 
> 赞同：1
> 
> 时间：2013-02-14T17:25:51.860
> 
> 标签：node.js, websocket, socket.io

我对 node.js 和 socket.io 都很陌生，但我已经构建了一个 websocket 端点，可以将简单数据推送到前端。

**例子：** `{ name : "Bob", eyes : "green", score : 100, fav : "true" }`

使用 node.js/socket.io 很容易（*太容易了！！*）但我的问题是：

有没有办法在推送到客户端之前过滤和/或排序数据？我意识到我可以在浏览器中使用 JS 来做到这一点，但是如果我有 600 人被推送，而最终用户只想要“绿色”眼睛的人，那么推送 550 名没有绿色眼睛的用户似乎是一种浪费到浏览器，然后将它们删除。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T22:19:15.583

经过大量研究和播放后，我得出结论，实现此目的的最佳方法是为每个过滤点设置套接字“通道”。以我最初的帖子为例，我有一个绿色、蓝色、棕色（等）眼睛的频道，然后根据用户的要求订阅该频道。然后将在客户端进行过滤，以确保列表/网格中不显示重复项。

# arrays - 使用数组作为 Excel 数据 VBA 中具有唯一值的活动列表

> ID：14880556
> 
> 赞同：-1
> 
> 时间：2013-02-14T17:25:57.070
> 
> 标签：arrays, excel, list, vba, for-loop

我试图弄清楚如何使用 VBA 从 Excel 数据创建一个数组作为活动列表，当我的脚本运行循环时，可以自动添加和删除唯一条目。

例子：

```
Object#   ,  Status     ,   Group#  ,  Time            
1      ,     Associate     , 1        , 1  
1      ,     Associate     , 1        , 1.1  
1      ,     Associate     , 2        , 2   
1      ,     Associate     , 3        , 3  
1      ,     Disassociate  , 2        , 4 
```

该数组将填充、 和的唯一组合`Object`，但无关紧要，因为一旦对象关联，它将保持关联，直到解除关联。`Status``Group``Time`

我已经在这方面寻求帮助，但大多数帖子只讨论填充数组，而不讨论循环如何帮助在取消关联时自动删除条目。

所以在这个例子中，我想要一个允许我输入对象 # 和时间的系统，然后脚本将运行，最后它会告诉我“在时间 4，对象 1 与组 1 和 3 相关联”。另一种情况是“在时间 3，对象 1 与组 1、2、3 相关联”。最后，如果在时间 5 取消所有对象的关联，则消息将显示该对象关联到的最后一个组。

我有一个代码可以做我需要的一切，直到它遇到一个对象与多个组相关联的情况，然后它无法返回准确的信息。我的编程知识有限，因此感谢您的帮助。下面是我目前拥有的代码，其中单元格 (15, 8) 和 (18, 8) 是对象 # 和时间的值输入单元格。

```
Private Sub CommandButton2_Click()
Dim Association As String, i As Integer, Group As Integer

Count = Application.WorksheetFunction.CountA(Range("A:A"))

For i = 1 To Count 

    If Cells (i, 1).Value = Cells(15, 8) And Cells (i, 4).Value <= Cells (18, 8) And Cells (i, 2) = "Associate"  Then Association = "Associated" 

    If Cells (i, 1).Value = Cells(15, 8) And Cells (i, 4).Value <= Cells (18, 8) And Cells (i, 2) = "Disassociate"  Then Association = "NOT Associated"

    If Cells (i, 1).Value = Cells(15, 8) And Cells (i, 4).Value <= Cells (18, 8) And Cells (i, 2) = "Associate"  Then Group = Cells(i, 3)

Next i

    If Association = "Associated" Then MsgBox Association & " Associated to " & Group
    If Association = "NOT Associated" Then Msgbox Association & " Was Last Associated to " & Group
    If Association = "" Then Msgbox "Object Does Not Exist Prior to This Time"

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:20:25.263

你大部分时间都在。对于此示例，我将`Dim Group as String`构建一个简单的逗号分隔列表以允许多个关联。您可以将其存储为一个数组并转置它，但我不确定这是否有必要。

我声明了更多变量以方便进行更清洁/更整洁的“测试”，并`Select Case`为您的消息框结果支持而不是多个 IF/THEN。

```
Private Sub Groups()
Dim Association As String
Dim i As Integer
Dim Group As String 'will contain the message
Dim ObjNum As Integer  'cells(15,5)
Dim TimeStamp As Double 'cells(15,8)
Dim ObjTest As Integer
Dim Status As String  'cells(i,2)
Dim GroupNum As Integer  'cells(1,3)
Dim TimeVal As Double  'Cells(i,4)

Count = Application.WorksheetFunction.CountA(Range("A:A"))

ObjNum = Cells(15, 8).Value
TimeStamp = Cells(18, 8).Value

For i = 2 To Count
    ObjTest = Cells(i, 1).Value
    Status = Cells(i, 2).Value
    GroupNum = Cells(i, 3).Value
    TimeVal = Cells(i, 4).Value

    If ObjTest = ObjNum And TimeVal <= TimeStamp Then
        If Status = "Associate" Then
            Association = "Associated"
            'Build a simple comma-delimited string of group associations, to allow
            ' for multiple associations
            Group = PrintMessage(Group, GroupNum & " at time " & TimeVal)
        ElseIf Status = "Disassociate" Then
            Association = "NOT Associated"
        End If
    End If

Next i

Select Case Association
    Case "Associated"
        MsgBox "Object # " & ObjNum & " Associated to: " & vbCrLf & Group
    Case "NOT Associated"
        MsgBox "Object # " & ObjNum & " Was Last Associated to: " & vbCrLf & Group
    Case vbNullString, ""
        MsgBox "Object " & ObjNum & " Does Not Exist Prior to This Time"
End Select

End Sub

Function PrintMessage(existingMsg$, GroupAtTimeString$) As String
If existingMsg = vbNullString Then
    PrintMessage = GroupAtTimeString
Else:
    PrintMessage = existingMsg & "," & vbCrLf & GroupAtTimeString
End If
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:39:23.677

经过你和我的反复讨论，我发现这是一个比我们最初理解的更复杂的请求。这是另一种使用`Scripting.Dictionary`对象的方法——基本上这允许您向集合添加/删除唯一的“键”。在这种情况下，我选择使用 Group# 作为 KEY 值，因为您指出这应该是唯一关联（例如，如果 Obj1 在时间 1 关联到 Group 1，在时间 2 关联到 Group 1，我们只关心第一个关联到第 1 组）。此外，我们假设 Time 总是按升序排序。

Scripting.Dictionary 似乎比尝试为添加/删除调整数组大小要容易一些。

最后，我们设置了一些简单的数组`dicKeys`和`dicItems`，我们可以对其进行迭代以将消息框信息呈现给用户。在您的示例中，它将创建一个消息框，如下所示：

![msgbox 结果截图](../Images/a634f2c6801e15f9f150936178d36b54.png)

这是代码：

```
Option Explicit

Private Sub GroupAssociation()
'ASSUMPTIONS: GroupNum is the UNIQUE key
'ASSUMPTIONS: TimeVal always sort ascending

'Parameters for our test:
Dim ObjNum As Integer  'cells(15,5)
Dim TimeStamp As Double 'cells(15,8)

'Fields being iterated over, in columns A:D
Dim i As Integer    'row counter/iterator
Dim count As Long   'row count/max range
Dim ObjTest As Integer 'the object number being tested, from column A, cells(i,1)
Dim Status As String  'cells(i,2)
Dim GroupNum As Integer  'cells(1,3)
Dim TimeVal As Double  'Cells(i,4)

'We will store the information, uniquely in a Scripting.Dictionary
Dim objDic As Object 'Scripting dictionary to contain your information
Dim dicKeys As Variant 'list of key items in the dictionary
Dim dicItems As Variant 'list of items in dictionary
Dim o As Long 'counter/iterator for dicKeys

'A message box will display the results
Dim mbString As String 'to contain the message box string

Set objDic = Nothing 'make sure this is nothing, just in case.
Set objDic = CreateObject("Scripting.Dictionary")

count = Application.WorksheetFunction.CountA(Range("A:A"))

ObjNum = Cells(15, 8).Value
TimeStamp = Cells(18, 8).Value

For i = 2 To count
    ObjTest = Cells(i, 1).Value
    Status = Cells(i, 2).Value
    GroupNum = Cells(i, 3).Value
    TimeVal = Cells(i, 4).Value
    dicKeys = objDic.Keys

    If ObjTest = ObjNum And TimeVal <= TimeStamp Then
        If Status = "Associate" Then
            'Check to see if this Key already exists, if so ignore, if not, add to dic.
            If UBound(dicKeys) < 0 Then
                objDic.Add GroupNum, "Object #" & ObjTest & _
                    " Associated to Group #" & GroupNum & " at time " & TimeVal
            Else:
                If IsError(Application.Match(GroupNum, dicKeys, False)) Then
                    objDic.Add GroupNum, "Object #" & ObjTest & _
                    " Associated to Group #" & GroupNum & " at time " & TimeVal
                End If
            End If
        ElseIf Status = "Disassociate" Then
            'Check to see if this Key already exists, if so, remove it
            If Not IsError(Application.Match(GroupNum, dicKeys, False)) Then
                'remove the item as it was
                objDic.Remove GroupNum
                'add a new item indicating it's new status as disassociated
                objDic.Add GroupNum, "Object #" & ObjTest & _
                " Disassociated from Group #" & GroupNum & " at time " & TimeVal
            End If
        End If
    End If

Next i

'Set some arrays from our Dictionary items:
dicKeys = objDic.Keys
dicItems = objDic.Items

'iterate over the array and build our message box string:
For o = 0 To UBound(dicKeys)
    If mbString = vbNullString Then
        mbString = dicKeys(o) & " - " & dicItems(o)
    Else:
        mbString = mbString & vbCrLf & _
           dicKeys(o) & " - " & dicItems(o)
    End If
Next

'handle cases where the item doesn't exist prior to this timestamp:
If mbString = vbNullString Then mbString = "Object #" & ObjNum & _
    " doesn't exist prior to time " & TimeStamp

'Show the message box:
MsgBox mbString, vbInformation

Set objDic = Nothing

End Sub 
```

# node.js - 如何将 appjs 连接到 nodejs 服务器并显示其内容

> ID：14880557
> 
> 赞同：0
> 
> 时间：2013-02-14T17:25:57.807
> 
> 标签：node.js, express

我想在 appjs 窗口中显示我网站的内容，但我不知道如何。

在 appjs 脚本中有 `app.serveFilesFrom(__dirname + '/content');` 说明内容在哪里，它必须显示，但我不希望它在本地，我希望它显示我的网站的内容，由 node.js 服务器脚本运行。

我已经尝试过这个 [https://github.com/appjs/appjs/wiki/Using-express-to-handle-local-http-requests](https://github.com/appjs/appjs/wiki/Using-express-to-handle-local-http-requests) 和 express.js 文档中的一些方法，但没有成功。

因此我在这里问，有人有想法，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T11:16:37.107

为了让您的网站像 Web 浏览器一样显示在 AppJS 窗口中，这是 AppJS 的主要意图之一，您可以采取以下两 (2) 步骤中的任何一个；

1.  在位于“data/content/”的 index.html 文件中创建一个 IFRAME（填充宽度和高度）。

    将 IFRAME SRC 设置为您的网站 url。

    例如 <iframe src="http://www.YourWebsite.com">

    当 app.exe 启动时，这将在 AppJS 窗口中显示您的网站。

    注意：您可能希望使用 CSS 使 iframe 填充窗口的 100% 宽度和 100% 高度。

2.  更改“data/node_modules/appjs/lib/settings.js”处的代码行

    从

    网址：'ht tp://appjs',

    至

    网址：' [http](http://www.YourWebsite.com) ://www.YourWebsite.com '

大多数时候我选择第一个选项，因为它允许我使用 CSS 做很多事情。这包括在 IFRAME 的背景上放置一个动画 GIF，以指示在启动时页面加载。

只有当我想让我的实际网站 URL 在尝试黑客攻击时更难找到时，我才会选择第二个选项。同时仍然保留“数据/内容”目录及其内容未删除。

我希望这能回答。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T07:50:06.723

我希望我正确理解了您的问题，您实际上可以发出代理请求并将其响应传递给您的应用响应。

```
var http = require("http");
var express = require("express");
var app = express();

var options = {
    host: "stackoverflow.com",
    port: 80,
    path: "/",
    method: "GET",
    headers: {}
};

app.get("/stackoverflow*", function (request, response) {
    "use strict";

    var proxyRequest;

    options.headers.cookie = request.headers.cookie;
    options.headers["user-agent"] = request.headers["user-agent"];

    // TODO set other headers if needed

    options.path = "/" + request.path.split("/").slice(2).join("/");
    options.method = request.method;

    proxyRequest = http.request(options, function (proxyResponse) {
        proxyResponse.pipe(response);
    });

    request.pipe(proxyRequest);
}).listen(8080); 
```

现在您可以导航到`http://localhost:8080/stackoverflow/questions/14880557/how-to-connect-appjs-to-nodejs-server-and-show-its-content/14890268#14890268`并且您的应用程序将显示来自 的请求路径`stackoverflow.com`。

# process - erlang生成过程错误？

> ID：14880560
> 
> 赞同：0
> 
> 时间：2013-02-14T17:26:17.417
> 
> 标签：process, erlang, spawn

我正在关注[本教程](http://learnyousomeerlang.com/designing-a-concurrent-application)，并尝试编译 event.erl 并根据

```
6> c(event).
{ok,event}
7> rr(event, state).
[state]
8> spawn(event, loop, [#state{server=self(), name="test", to_go=5}]).
<0.60.0>
9> flush().
ok
10> flush().
Shell got {done,"test"}
ok
11> Pid = spawn(event, loop, [#state{server=self(), name="test", to_go=500}]).
<0.64.0>
12> ReplyRef = make_ref().
#Ref<0.0.0.210>
13> Pid ! {self(), ReplyRef, cancel}.
{<0.50.0>,#Ref<0.0.0.210>,cancel}
14> flush().
Shell got {#Ref<0.0.0.210>,ok}
ok 
```

但我似乎无法通过第 8 步，因为我收到了这个错误。

```
7> spawn(event, loop, [#state{server=self(), name="test", to_go=5}]).

=ERROR REPORT==== 14-Feb-2013::11:14:38 ===
Error in process <0.51.0> with exit value: {function_clause,[{event,loop,[{state,<0.32.0>,"test",5}],[{file,"event.erl"},{line,35}]}]}

<0.51.0> 
```

以下是event.erl

```
-module(event).
-export([start/2, start_link/2, cancel/1]).
-export([init/3, loop/1]).
-record(state, {server,
                name="",
                to_go=0}).

%%% Public interface
start(EventName, DateTime) ->
    spawn(?MODULE, init, [self(), EventName, DateTime]).

start_link(EventName, DateTime) ->
    spawn_link(?MODULE, init, [self(), EventName, DateTime]).

cancel(Pid) ->
    %% Monitor in case the process is already dead
    Ref = erlang:monitor(process, Pid),
    Pid ! {self(), Ref, cancel},
    receive
        {Ref, ok} ->
            erlang:demonitor(Ref, [flush]),
            ok;
        {'DOWN', Ref, process, Pid, _Reason} ->
            ok
    end.

%%% Event's innards
init(Server, EventName, DateTime) ->
    loop(#state{server=Server,
                name=EventName,
                to_go=time_to_go(DateTime)}).

%% Loop uses a list for times in order to go around the ~49 days limit
%% on timeouts.
loop(S = #state{server=Server, to_go=[T|Next]}) ->
    receive
        {Server, Ref, cancel} ->
            Server ! {Ref, ok}
    after T*1000 ->
        if Next =:= [] ->
            Server ! {done, S#state.name};
           Next =/= [] ->
            loop(S#state{to_go=Next})
        end
    end.

%%% private functions
time_to_go(TimeOut={{_,_,_}, {_,_,_}}) ->
    Now = calendar:local_time(),
    ToGo = calendar:datetime_to_gregorian_seconds(TimeOut) -
           calendar:datetime_to_gregorian_seconds(Now),
    Secs = if ToGo > 0  -> ToGo;
              ToGo =< 0 -> 0
           end,
    normalize(Secs).

%% Because Erlang is limited to about 49 days (49*24*60*60*1000) in
%% milliseconds, the following function is used
normalize(N) ->
    Limit = 49*24*60*60,
    [N rem Limit | lists:duplicate(N div Limit, Limit)]. 
```

编辑：我试图通过添加一个参数来改变函数循环

```
loop(S = #state{server=Server, to_go=[T|Next]}) ->

to this 

loop(S = #state{server=Server,name=EventName, to_go=[T|Next]}) -> 
```

它仍然可以编译，但它不起作用，同样的错误......我想也许元组不匹配。然后它只会演变为论点`to_go=[T|Next]}`不正确。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:42:20.690

我认为问题在于您的 loop/1 子句将 #state 参数解包，以便 to_go 与列表进行模式匹配（即 to_go = [T|Next]）。但是，您传入一个 5 (to_go=5) 将无法匹配 [T | Next] 因此 loop/1 将不匹配，您将没有匹配的函数子句

```
loop(#state{server=self(), name="test", to_go=5}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T18:11:33.107

这个表达式：

```
8> spawn(event, loop, [#state{server=self(), name="test", to_go=5}]). 
```

适用于早期版本的代码，因为它正在整个教程中进行开发。如果我没看错，这应该是正确的调用：

```
19> event:start("Event", 0). 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T23:03:25.683

[这与Erlang 进程事件错误](https://stackoverflow.com/questions/14791717/erlang-process-event-error)中的问题相同。和函数需要一个时间参数，`start/2`这就是当你用 调用它们时它们会失败的`start_link/2`原因。该函数期望字段 of是一个**整数**列表，它将其解释为秒，并将通过对每个整数执行 a 来等待总时间。该服务器的目标是能够等待比 Erlang 直接在.`time_to_go/1``{{Year,Month,Day},{Hour,Minute,Second}}``5``loop/1``to_go``#state{}`**`receive...after``receive...after`**

 **该`time_to_go/1`函数正在计算从现在到作为参数输入的日期/时间之间的秒数，然后将其分解为一个秒列表，其中没有一个大于`receive...after`可以处理的最大大小。**

# iphone - 无法执行命令：总线错误：10 IOS

> ID：14880564
> 
> 赞同：4
> 
> 时间：2013-02-14T17:26:32.657
> 
> 标签：iphone, ios, xcode, runtime, clang

我的 Xcode 中有一个模糊问题。重新安装我的**X-Code 版本 4.3.2 (4E2002)**后，当我运行我的任何代码时，它会显示以下错误消息。

错误 ：

一些文字喜欢：

```
Ld /Users/vivek/Library/Developer/Xcode/DerivedData/MapDirectionsViewExample-gbobmtqliuwpjbbhsaxeqrqgzyax/Build/Products/Debug-iphonesimulator/MapDirectionsViewExample.app/MapDirectionsViewExample normal i386
    cd /Users/vivek/Desktop/MapDirectionViewController-master/Example
    setenv MACOSX_DEPLOYMENT_TARGET 10.6
    setenv PATH "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Applications/Xcode.app/Contents/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -arch i386 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.1.sdk -L/Users/vivek/Library/Developer/Xcode/DerivedData/MapDirectionsViewExample-gbobmtqliuwpjbbhsaxeqrqgzyax/Build/Products/Debug-iphonesimulator -F/Users/vivek/Library/Developer/Xcode/DerivedData/MapDirectionsViewExample-gbobmtqliuwpjbbhsaxeqrqgzyax/Build/Products/Debug-iphonesimulator -filelist /Users/vivek/Library/Developer/Xcode/DerivedData/MapDirectionsViewExample-gbobmtqliuwpjbbhsaxeqrqgzyax/Build/Intermediates/MapDirectionsViewExample.build/Debug-iphonesimulator/MapDirectionsViewExample.build/Objects-normal/i386/MapDirectionsViewExample.LinkFileList -mmacosx-version-min=10.6 -Xlinker -objc_abi_version -Xlinker 2 -Xlinker -no_implicit_dylibs -D__IPHONE_OS_VERSION_MIN_REQUIRED=40200 -framework QuartzCore -framework SystemConfiguration -lz -framework MobileCoreServices -framework CFNetwork -framework CoreLocation -framework MapKit -framework UIKit -framework Foundation -framework CoreGraphics -o /Users/vivek/Library/Developer/Xcode/DerivedData/MapDirectionsViewExample-gbobmtqliuwpjbbhsaxeqrqgzyax/Build/Products/Debug-iphonesimulator/MapDirectionsViewExample.app/MapDirectionsViewExample 
```

**和错误消息，如**

> clang：错误：无法执行命令：总线错误：10 clang：错误：链接器命令因信号 2 失败（使用 -v 查看调用） clang：注意：诊断消息：请向 [http://developer提交错误报告.apple.com/bugreporter/](http://developer.apple.com/bugreporter/)并包含命令行参数和所有诊断信息。叮当声：注意：诊断消息：生成预处理源时出错 - 没有可预处理的输入。

我需要做的事情我没有得到。

谁能帮我 ？

提前致谢 。

图片 ：

![在此处输入图像描述](../Images/3c4318a5894d8ec6b124ecb0f27aea45.png)

# sql-server-2005 - 如何在 SQL 的单行中插入多个值？

> ID：14880566
> 
> 赞同：-1
> 
> 时间：2013-02-14T17:26:36.030
> 
> 标签：sql-server-2005

嘿，我从过去 4 天开始陷入 SQL 问题，我如何为单行插入多个值，例如项目表包含项目名称、ID 和其他员工持有员工详细信息的详细信息，项目中存在多对多关系和员工，所以我想存储许多在单个或多个项目中工作的员工。请帮帮我.....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:28:53.890

为此，您需要创建一个新表，说明`employeeproject`该表将具有来自员工表和项目表的外键以及其自己表的主键。所以你的新表看起来像这样

```
employeeproject ==> epid, emp_id, proj_id 
```

在多对多关系中，我们总是需要创建一个链接（映射）这两个表的表，
请参阅[此处](http://en.tekstenuitleg.net/articles/software/database-design-tutorial/many-to-many.html)

希望这可以帮助！

# sql - 对连接感到困惑

> ID：14880567
> 
> 赞同：0
> 
> 时间：2013-02-14T17:26:49.673
> 
> 标签：sql, join

我有以下sql结构

```
Department: id, name
Students: id,name
department_students: student_id, department_id 
```

查找学生人数超过 10 人的所有部门

查找所有不在技术部门的学生

我怎么能用 join 来得到这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:41:37.960

对可怕的压痕感到抱歉

```
select *
from student s
where
    not exists 
    ( 
        select 1 
        from student_department sd 
        join department d
        on sd.student_id = s.id 
        and
        sd.department_id = d.id
        and
        d.name = 'tech'
    )

select d.name 
from department d
join student_department sd 
on d.id = sd.department_id 
group by sd.department_id
having count(*)>10 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:36:59.513

首先，您需要将表连接在一起。部门到 Department_students，然后是 Student 到 Department_Students。然后在 WHERE 子句中进一步定义需要查找的内容。这是“查找所有不在技术部门的学生”的示例

```
 SELECT  S.ID, S.Name
FROM department_students AS DS
    INNER JOIN Department AS D
        ON DS.department_id = D.id
    INNER JOIN Students AS S
        ON S.ID = DS.student_id 
WHERE  
    D.Name <> 'Tech_Department' 
```

注意：我使用的是 MS SQL Server 语法。

因此，您几乎需要了解的是，您正在将不同的表“加入”到具有唯一信息（即键）的其他表“ON”字段中。在您的示例中，跨越不同表的唯一信息是“ID”。部门 id 到 department_students，然后学生 id 到 department_students。

# ios - 获取字节流中的颜色值 - ios

> ID：14880570
> 
> 赞同：1
> 
> 时间：2013-02-14T17:27:05.540
> 
> 标签：ios, objective-c, nsdata

我从二进制文件（.ase）中读取了这个字节流粗体值代表颜色：

<41534546 00010000 00000005 c0010000 00140008 004f0070 0061006c 0074006f 006e0065 00000001 00000024 00080023 00320042 00420034 00300046 00005247 4220* *3e2c acad3f34 b4b53d70 f0f1* *0002 00010000 00240008 00230046 00460035 00420033 00310000 52474220 3f800000 3eb6b6b7 3e44c4c5 **00020001 00000024** 00080023 00460046 00380037 00340038 00005247 4220* *3f80 00003f07 87883e90 9091* *0002 00010000 00240008 00230030 00330038 00340043 00410000 52474220 **3c40c0c1 3f048485 3f4acacb** 0002>

如果颜色`9BD6AE`存在字节块将是**3f1b9b9c 3f56d6d7 3f2eaeaf**

每个块代表每个颜色分量的浮点值。（红色：0.607843 绿色：0.839216 蓝色：0.682353）

如何从上述数据流中获取这些浮点值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T18:01:07.163

假设您拥有包含文件内容的 NSData，您可以`float`使用如下代码将这些值转换为：

```
NSData *data = ... // contents of the ASE file
const void *bytes = [data bytes];
int offset = ... // offset into the data stream (in bytes)

// assuming offset is pointing to the start of 4 bytes that represent a float value:
float colorComponent = [self floatFromBytes:bytes + offset];

// Helper method to convert bytes to a float
// In ASE file, float values are 4-byte values in big-endian format
- (float)floatFromBytes:(const void *)bytes {
    uint_32_t beVal = *(uint_32_t *)bytes; // data is in big-endian format
    uint_32_t locVal = CFSwapInt32BigToHost(beVal); // data in host format

    float res = *(float *)&locVal; // convert bytes to float

    return res;
} 
```

这远非完整的 ASE 解析算法。但这显示了如何将 4 字节值转换为`float`值。您需要处理 ASE 文件格式的许多其他方面。

# devexpress - DevExpress DataGrid、LinqDataSource、行插入问题

> ID：14880575
> 
> 赞同：0
> 
> 时间：2013-02-14T17:27:39.567
> 
> 标签：devexpress, linqdatasource

这是问题的屏幕截图：

[http://screencast.com/t/ZG2NQWjxYFLh](http://screencast.com/t/ZG2NQWjxYFLh)

我正在尝试使用 DevExpress 数据网格通过 Linq 向数据库添加一条记录。提交数据的时候报错：

LinqDataSource 'linqDsLocales' 没有要插入的值。检查“值”字典是否包含值。

这就是我的 LinqDataSource 的样子：

```
<asp:LinqDataSource ID="linqDsLocales" runat="server" ContextTypeName="MyCompany.MyObject.DataDataContext" TableName="Locales" EnableInsert="True" EnableUpdate="True" EnableDelete="True" /> 
```

这是网格：

```
<dx:ASPxGridView ID="gridLocales" runat="server" AutoGenerateColumns="False" DataSourceID="linqDsLocales" KeyFieldName="LocaleID">
                    <Columns>
                        <dx:GridViewCommandColumn ShowInCustomizationForm="True" VisibleIndex="0">
                            <EditButton Visible="True" />
                            <NewButton Visible="True" />
                            <DeleteButton Visible="True" />
                        </dx:GridViewCommandColumn>
                        <dx:GridViewDataTextColumn FieldName="LocaleID" ReadOnly="True" VisibleIndex="1">
                            <EditFormSettings Visible="False" />
                        </dx:GridViewDataTextColumn>
                        <dx:GridViewDataTextColumn FieldName="Name" VisibleIndex="2"/>                            
                        <dx:GridViewDataTextColumn FieldName="Description" VisibleIndex="3"/>
                    </Columns>
                    <Settings ShowFilterRow="True" />
                    <Templates>
                        <EditForm>

                            <dx:ASPxPageControl ID="tabLocaleEditController" runat="server" ActiveTabIndex="0" Width="100%">
                                <TabPages>

                                    <dx:TabPage Text="Locale Information">
                                        <ContentCollection>
                                            <dx:ContentControl runat="server">
                                                <dx:ASPxGridViewTemplateReplacement ID="localeEditors" ReplacementType="EditFormEditors" runat="server" />
                                            </dx:ContentControl>
                                        </ContentCollection>
                                    </dx:TabPage>

                                    <dx:TabPage Text="Role Assigment">
                                        <ContentCollection>
                                            <dx:ContentControl runat="server">
                                                <dx:ASPxCheckBoxList ID="cbListRoles" runat="server" ValueType="System.String" DataSourceID="linqDsRoles" TextField="RoleName" ValueField="RoleID" OnDataBound="cbListRoles_OnDataBound" />
                                            </dx:ContentControl>
                                        </ContentCollection>
                                    </dx:TabPage>

                                </TabPages>
                            </dx:ASPxPageControl>

                            <div style="text-align: right; padding: 2px 2px 2px 2px">
                                <dx:ASPxGridViewTemplateReplacement ID="UpdateButton" ReplacementType="EditFormUpdateButton" runat="server" />
                                <dx:ASPxGridViewTemplateReplacement ID="CancelButton" ReplacementType="EditFormCancelButton" runat="server" />
                            </div>

                        </EditForm>
                    </Templates>

                </dx:ASPxGridView> 
```

任何人都可以对此有所了解吗？

# javascript - HTML5 音频播放器作为 WordPress 中的帖子标题

> ID：14880576
> 
> 赞同：0
> 
> 时间：2013-02-14T17:27:41.820
> 
> 标签：javascript, html, wordpress

我试图弄清楚如何使用 html5 音频播放器作为我网站的帖子标题。例如，您通常会在其中看到帖子的标题，我想拥有带有帖子相关歌曲的音频播放器。我不知道如何实现这样的功能，有没有办法在 Wordpress 仪表板中编辑帖子页面以启用这样的功能或有哪些其他方法可用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:47:25.033

您可以通过修改主题来做到这一点。

使用自定义字段来定义音频文件的 src，并在循环中的帖子标题旁边插入音频播放器标签。

[http://codex.wordpress.org/Custom_Fields](http://codex.wordpress.org/Custom_Fields)

# regex - Perl RegEx 解析 10 位数字上的注释块

> ID：14880579
> 
> 赞同：0
> 
> 时间：2013-02-14T17:27:49.323
> 
> 标签：regex, perl

好的，事情就是这样。我有旧的 sql server 文本格式的注释。它将所有笔记记录在一个大数据中。我需要提取该文本块并对其进行解析，以便为每个注释条目创建一行，其中包含用于时间戳、用户和注释文本的单独列。我能想到的唯一方法是使用正则表达式来定位每个音符的 unix 时间戳并对其进行解析。我知道有用于解析分隔符的拆分函数，但这会删除分隔符。我需要在 \d{10} 上进行解析，但还需要保留 10 位数字。这是一些示例数据。

```
create table test_table
(
job_number number,
notes varchar2(4000)
)

insert into test_table values
(12345, '1234567890 username notes text notes text notes text notes text 5468204562 username notes text notes text notes text notes text 1025478510 username notes text notes text notes text notes text')
(12346, '2345678901 username notes text notes text notes text notes text 1523024512 username notes text notes text notes text notes text 1578451236 username notes text notes text notes text notes text')
(12347, '2345678902 username notes text notes text notes text notes text 2365201214 username notes text notes text notes text notes text 1202154215 username notes text notes text notes text notes text') 
```

我希望看到每个音符的一个记录看起来像这样。

```
JOB_NUMBER        DTTM    USER     NOTES_TEXT
----------    ----------  ----     ----------
12345         1234567890  USERNAME notes text notes text notes text notes text
12345         5468204562  USERNAME notes text notes text notes text notes text
12345         1025478510  USERNAME notes text notes text notes text notes text
12346         2345678901  USERNAME notes text notes text notes text notes text
12346         1523024512  USERNAME notes text notes text notes text notes text
12346         1578451236  USERNAME notes text notes text notes text notes text
12347         2345678902  USERNAME notes text notes text notes text notes text
12347         2365201214  USERNAME notes text notes text notes text notes text
12347         1202154215  USERNAME notes text notes text notes text notes text 
```

感谢您提供任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:03:58.063

[`Text::ParseWords`](http://search.cpan.org/perldoc?Text%3a%3aParseWords)可以处理带引号的字符串并以逗号分隔。您可以使用触发器运算符在输入中向前跳过`1 .. /values/`。这种特殊的跳过方法可能需要修改。

然后只需要解析字符串，这可以通过使用前瞻断言进行拆分，然后捕获每个子字符串中的各种条目来完成。拆分中的正则表达式：

```
my @entries = split /(?<!^)(?=\d{10})/, $data; 
```

有一个否定的lookbehind断言来避免匹配字符串的开头`^`，还有一个lookahead断言来匹配10个数字。这将有效地拆分数字并保留它们。

`DATA`文件句柄用于演示，只需替换为与参数文件名一起使用`<DATA>`。`<>`

```
use strict;
use warnings;
use Text::ParseWords;

my $format = "%-12s %-12s %-10s %s\n";              # format for printing
my @headers = qw(JOB_NUMBER DTTM USER NOTES_TEXT);  
printf $format, @headers;
printf $format, map "-" x length, @headers;         # print underline
while (<DATA>) {
    next while 1 .. /values/;                       # skip to data
    s/^\(|\)$//g;                                   # remove parentheses
    my ($job, $data) = quotewords('\s*,\s*',0, $_); # parse string
    my @entries = split /(?<!^)(?=\d{10})/, $data;  # split into entries
    for my $entry (@entries) {                      # parse each entry
        my ($dttm, $user, $notes) = $entry =~ /^(\d+)\s+(\S+)\s+(.*)/;
        printf $format, $job, $dttm, $user, $entry;
    }
}

__DATA__
create table test_table
(
job_number number,
notes varchar2(4000)
)

insert into test_table values
(12345, '1234567890 username notes text notes text notes text notes text 5468204562 username notes text notes text notes text notes text 1025478510 username notes text notes text notes text notes text')
(12346, '2345678901 username notes text notes text notes text notes text 1523024512 username notes text notes text notes text notes text 1578451236 username notes text notes text notes text notes text')
(12347, '2345678902 username notes text notes text notes text notes text 2365201214 username notes text notes text notes text notes text 1202154215 username notes text notes text notes text notes text') 
```

**输出：**

```
JOB_NUMBER   DTTM         USER       NOTES_TEXT
----------   ----         ----       ----------
12345        1234567890   username   1234567890 username notes text notes text notes text notes text
12345        5468204562   username   5468204562 username notes text notes text notes text notes text
12345        1025478510   username   1025478510 username notes text notes text notes text notes text
12346        2345678901   username   2345678901 username notes text notes text notes text notes text
12346        1523024512   username   1523024512 username notes text notes text notes text notes text
12346        1578451236   username   1578451236 username notes text notes text notes text notes text
12347        2345678902   username   2345678902 username notes text notes text notes text notes text
12347        2365201214   username   2365201214 username notes text notes text notes text notes text
12347        1202154215   username   1202154215 username notes text notes text notes text notes text 
```

# javascript - 根据窗口大小停止打开链接

> ID：14880580
> 
> 赞同：0
> 
> 时间：2013-02-14T17:27:51.203
> 
> 标签：javascript, jquery, html

我试图阻止我`class="blocker"`在小屏幕（即 iPhone）上打开属性的所有链接。目前，图像设置为使用 prettyPhoto 打开，我希望将其保留在更大的屏幕上。我在这里搜寻了一些 javascript 部分来提供帮助（我是 javascript 新手）并想出了`$(window).width()`and`$(window).height()`以及`preventDef`命令。我试图将其合并到`if`以下部分的语句中`<head>`（包括其他 js 脚本）：

```
<head>
...
    <script src="http://cdn.jquerytools.org/1.2.7/full/jquery.tools.min.js"></script>
    <script src="scripts/prettyPhoto/js/jquery.prettyPhoto.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" charset="utf-8">
        function sizeChecker(){
            if ($(window).width() || $(window).height() < 641) {
                function imgHandler() {
                    document.getElementByClass("blocker").addEventListener("click", preventDef, false);
                    }
            }
    </script>
</head> 
```

在该`<body>`部分中，列出了图像，然后是 prettyPhoto 代码，如下所示：

```
<body>
...
    <div class="centered_image">
        <a href="image1.jpg" rel="prettyPhoto[gallery]" class="blocker">
            <img class="img_style" src="image1.jpg" >
        </a>
    </div>
    <div class="centered_image">
        <a href="image2.jpg" rel="prettyPhoto[gallery]" class="blocker">
            <img class="img_style" src="image3.jpg" >
        </a>
    </div>

    <script type="text/javascript" charset="utf-8">
        $(document).ready(function(){
            $("a[rel^='prettyPhoto']").prettyPhoto();
        });
    </script>
...
</body> 
```

我的目标是让网站在大于 640x960 的屏幕上使用 prettyphoto 插件，并且在所有小于 640x960 的屏幕上，只显示没有活动链接的图像。这真的可能吗？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:31:24.030

您可能必须分别检查高度和宽度，仅添加“OR”是行不通的：

```
$(function() {
    if ($(window).width() < 641 || $(window).height() < 641) {
        $('.blocker').on('click', function() {
            return false;
        });
    }
}); 
```

也不需要在每次点击时都这样做，只需在页面加载时这样做，它会产生相同的效果。一个更好的主意是在调整大小时进行，或者检查`screen`而不是`window`获取屏幕大小等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:25:27.657

有几种方法可以做到这一点。

首先有点像你尝试过的，通过测量屏幕尺寸并有条件地加载

```
 // Arbitrary width
    if ($(window).width() <= 480) {
     //do stuff for small screem
      } else {
     //do stuff for large screen
      } 
```

或者您可以使用媒体查询将元素添加到包含内容的正文中，然后读取内容。这有点复杂，但在断点处的 css 中

```
@media all and (min-width: 400px) {
    body:after {
        content: 'widescreen';
        display: none;
    }
} 
```

然后在你的 javascript 中寻找那个元素并用它做一些事情。

```
var size = window.getComputedStyle(document.body,':after').getPropertyValue('content');
    if(size.indexOf("widescreen") !=-1 || null) {
//do something
} 
```

第二个例子来自 Jeremy Keith 的博客

[http://adactio.com/journal/5429/](http://adactio.com/journal/5429/)

# php - 如果它已经来自php中的数据库，如何在数组中添加复选框值

> ID：14880582
> 
> 赞同：0
> 
> 时间：2013-02-14T17:27:59.137
> 
> 标签：php

我有一个代码，它在复选框中显示项目，这些项目已经存在于我的数据库中，并且我给出的值也在数据库中，我需要将其映射到另一个页面中。那么如何将其推送到数组中呢？代码如下：

```
echo print_chkbx("SELECT * FROM Product_master", database_connect($dbName)); 
```

函数是

```
function print_chkbx($query, $link){
    $queried = mysql_query($query, $link);

    while ($result = mysql_fetch_array($queried)) {
        $menu .= '
        <input name="check" type="checkbox" value="'. $result['product_id'] .'" />' . $result['product_name'];

    }

    return $menu;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:37:14.080

这将在表单中创建一个`products`数组。

在输入名称之后放置`[]`字符以表示具有此名称的所有输入都是数组中的单独条目。

```
$menu .= '
<input name="check" name="products[]" type="checkbox" value="'. $result['product_id'] .'" />' . $result['product_name']; 
```

然后在提交时，它们将作为一个数组提供：

```
<?php
$products = $_REQUEST['products']; // used request as unsure of (GET||POST)
echo '<pre>',print_r($products),'</pre>'; 
```

# android - 使用 Visual Studio 进行 Android 开发的 VisualGDB 或 WinGDB

> ID：14880584
> 
> 赞同：4
> 
> 时间：2013-02-14T17:28:06.203
> 
> 标签：android, visual-studio

有人做过功能比较吗？它们看起来都在积极开发中。

它们看起来都可以与 vs-android 集成。或者这些 IDE 插件是否有必要这样做？

# c - 如何防止隐式链接描述文件更改部分的 LMA

> ID：14880585
> 
> 赞同：3
> 
> 时间：2013-02-14T17:28:05.757
> 
> 标签：c, embedded, ld, binutils, linker-scripts

我正在为软件使用模块化构建系统，而不是在 ARM 嵌入式目标以及普通 X86 (linux) 机器上运行。我正在使用 GNU 工具链进行编译，因此使用`ld`.

其中一个模块使用链接脚本技巧来组装一组“已注册”对象。这些对象是使用这样的宏创建的：

```
#define RegObject(name, arg1, arg2, etc) \
    static TRegObject name \
    __attribute__((section ("regobj_table"), used)) = \
    { arg1, arg2, etc } 
```

该模块还向链接步骤添加了一个[隐式链接器脚本](http://sourceware.org/binutils/docs/ld/Implicit-Linker-Scripts.html)，如下所示：

```
SECTIONS
{
    .data : ALIGN(4)
    {
        regobj_table_start = .;
        KEEP(*(regobj_table))
        regobj_table_end = .;
    }
} 
```

代码使用`regobj_table_start`和`regobj_table_end`符号来查找已注册的对象。此解决方案适用于本机 (Linux) 编译目标。

但是，这不适用于 ARM 目标。原因是我有一个用于目标的自定义默认链接器脚本（它是一个微型微控制器，在没有操作系统的情况下运行），它定义了该`.data`部分的加载内存地址。这是因为该部分存储在闪存中，但是一旦微控制器启动，它就会被复制到 RAM。链接描述文件的相关部分如下所示：

```
MEMORY
{
  ROM (rx)  : ORIGIN = 0x00000000, LENGTH = 512k
  RAM (rwx) : ORIGIN = 0x40000000, LENGTH = 32k
}

SECTIONS
{
    /* ... other stuff ... */

    .data :
    {
        _data = .;
        *(.data)
        *(.data.*)
    } >RAM AT>ROM

    /* ... even more stuff ... */
} 
```

这会将`.data`部分的 VMA 设置为 0x4000000 范围内的某个位置，并将 LMA 设置为 0x00000000 范围内的某个位置。

**问题是**，当隐式链接器脚本被添加到命令行时`ld`，它只是忘记了 LMA，它再次变得等于 VMA。我正在拼命寻找一种方法来告诉`ld`在加载隐式链接器脚本时不要触摸 LMA。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-16T15:18:27.833

尝试使用 INSERT AFTER ... 作为最后一行。这会将您的脚本插入到默认脚本中。

# actionscript-3 - AS3 进阶指南

> ID：14880593
> 
> 赞同：-3
> 
> 时间：2013-02-14T17:28:27.560
> 
> 标签：actionscript-3

我想是时候问了。我正在学习 AS3，除了一些童年时期的 JavaScript 技巧之外，它是我的第一个 p.language。随机教程教授基础知识，例如如何启动函数，如何“监听”，如何设置变量等。但是语言要大得多，我需要对它有一个复杂的理解。所以随机选择任务并找到执行它的方法可能需要很长时间。*我需要一种有组织的方式来逐步了解 AS3 的所有重要（如果不是全部）可能性。*

我敢肯定，每个愿意回答带有 AS3 标记的问题的人都非常了解这种语言，并且有他/她的学习方式，除了使用别人的代码直到你理解它或每次都问别人。我不介意最后一个，但我知道我会收到很多关于我的“serious_and_busy_people_forum”泛滥的愤怒评论。;)

**所以如果你发现了一些非常好的、完整的、清晰的在线教程，请分享。**

至于我现在感兴趣的例子，我将看到如何创建许多随机实例，这些实例将共享相同的代码，就像对象旋转一样——观察最近的一个，存储可能由不同场景共享的信息，创建更平滑的重力、力矩、半径，为物体设置任何形状的路径......

是的，我不仅需要一个随机教程或 Adob​​e 字典 - 它很有用，但只有在您了解所有内容并需要提醒之后，因为它只有一个命令、类、包等列表，以及一个非常基本的教程这有点低于高级。*我想看看你认为你在 AS3 学习中的最佳帮手。=)*

补充：这是一个问题：什么对你帮助最大。我说我不需要随机教程，我知道如何谷歌，我想要人们的意见。在判断、侮辱、投票减号或傲慢行为之前，先学会阅读。特别是如果您无用提供有关该主题的 0 信息。可惜我不能删除火焰的评论。

如果我提供我的代码的一部分并要求更好的方法——你会提供帮助，但如果我提供我的水平并要求一种更好的方法来自己学习这一切——你会攻击吗？浪费你的时间写一个冒犯性的评论而不是帮助是，IMO，智力和文化的底部。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:00:36.017

Apocalyptic0n3 是正确的，你不会在这里找到你需要的培训，但是，我可以推荐从这里去哪里。

**1：**购买[编程书籍](http://books.google.com/books?id=gUHX2fcLKxYC&printsec=frontcover&dq=AS3%20programming&hl=en&sa=X&ei=QTUdUdGbKIOy9gTpvoAw&ved=0CEUQ6AEwBA#v=onepage&q=AS3%20programming&f=false)，或使用任何[免费提供的手册](http://livedocs.adobe.com/flex/3/progAS_flex3.pdf)。也许是[AS3 Cookbook](http://shop.oreilly.com/product/9780596526955.do)，而且绝对[是 API 参考](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/index.html)。

**2：**学习通用编程。我不是说“去学习 C”，我的意思是，知道文档代码和类之间的区别。知道如何以及何时编写函数，以及如何使用参数。了解不同变量类型之间的区别。知道如何编写循环。了解您的运营商。

学习编程的问题是没有人可以“教”你如何编写程序。您需要了解这些工具，而您尝试编写的程序将决定您编写的内容。出于这个原因，我使用最多的文档是 Adob​​e 的[API 参考](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/index.html)。

*   数组的方法有哪些？ [检查 API。](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Array.html#summaryTableMethod)
*   每次返回时如何拆分字符串？ [检查 API。](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/String.html#split%28%29)
*   如何创建向量编号？ [检查 API。](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Vector.html#helpful-pod)
*   ETC...

一旦你知道它是如何布局的，它实际上非常有用，一旦你意识到那里的内容远远超过你在一次“通读”中所能记住的内容，了解有关该语言的一切的重要性就变得不重要了。

**3：**练习；在我看来，最好的训练就是做。*因此，选择一个项目，仔细考虑您*将采取的逻辑步骤来执行您希望代码执行的任何操作，并研究您将如何执行此操作。

最后，关于您特别感兴趣的领域，我已经购买并喜欢 Keith Peter 的[Actionscript 3 Animation](http://books.google.com/books?id=nzyu5TytMEUC&printsec=frontcover&dq=Actionscript%203%20animation&hl=en&sa=X&ei=CEMdUa-lEJH88QTA74DoDQ&ved=0CC0Q6AEwAA#v=onepage&q=Actionscript%203%20animation&f=false)书。它清楚地解释了您所有的动画/碰撞/物理/3d 相机需求。

# css - 如何在css的另一个规则中使用规则？

> ID：14880594
> 
> 赞同：0
> 
> 时间：2013-02-14T17:28:30.557
> 
> 标签：css, css-selectors

我想我所要求的有点奇怪，但我没有其他办法。
有没有办法在现实生活中执行这个伪 CSS 规则：
假设我有规则：

```
.myCssRule1{ color:red; } 
```

而且我不能（不想）改变它，但我需要在另一个规则中使用它，我将这样制定：

```
.myCssRule2{  
   .myCssRule1
} 
```

就像从另一个内部调用方法一样。
任何本机方式或 JS 库来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:29:46.713

您可以使用像 LESS 这样的 CSS 框架来执行此操作。

然后将您使用 LESS 编写的代码编译为“本机”css 文件。

这里有一个例子：查看`Mixins`： http: [//lesscss.org/](http://lesscss.org/)

下面的代码直接取自该 LESS 链接

```
// LESS

.rounded-corners (@radius: 5px) {
  -webkit-border-radius: @radius;
  -moz-border-radius: @radius;
  -ms-border-radius: @radius;
  -o-border-radius: @radius;
  border-radius: @radius;
}

#header {
  .rounded-corners;
}
#footer {
  .rounded-corners(10px);
} 
```

使用 less 编译为：

```
/* Compiled CSS */

#header {
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  -ms-border-radius: 5px;
  -o-border-radius: 5px;
  border-radius: 5px;
}
#footer {
  -webkit-border-radius: 10px;
  -moz-border-radius: 10px;
  -ms-border-radius: 10px;
  -o-border-radius: 10px;
  border-radius: 10px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:39:42.923

您不能使用纯 CSS 以这种方式将样式混合到选择器中。我建议实现您的结果的方法是创建一个具有您想要共享的属性的类，例如：

```
.red {
    color: red;
} 
```

并将该类应用于您想要红色的所有元素。任何 HTML 元素都可以有任意数量的类：

```
<div class="myCssRule1 myCssRule2"></div> 
```

* * *

*更好*的方法（在我看来）是使用 CSS 预处理器，它是一种通常类似于 CSS 的语言，可以为您提供额外的功能，但可以编译成普通的 CSS 样式表。我最喜欢的是[Stylus](http://learnboost.github.com/stylus/)，但你也应该看看[LESS](http://lesscss.org/)、[Sass](http://sass-lang.com/)和[Compass](http://compass-style.org/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T17:30:32.737

你需要一个 CSS 预处理器来做到这一点。最受欢迎的是 Sass 和 LESS。

*   萨斯（[http://sass-lang.com/](http://sass-lang.com/)）
*   少（[http://www.lesscss.org/](http://www.lesscss.org/)）

# c++ - 为什么要提供两个get函数

> ID：14880596
> 
> 赞同：5
> 
> 时间：2013-02-14T17:28:35.777
> 
> 标签：c++, boost

```
class T
{};

class AccessT
{
public:
    boost::shared_ptr<const T> getT() const {return m_T;}
    boost::shared_ptr<T>       getT()       {return m_T;}

private:
    boost::shared_ptr<T> m_T;
}; 
```

问题> 我在遗留项目中看到了很多与上述类似的代码。我真的不明白这样做的意义。为什么不简单地提供以下内容：

```
class T
{};

class AccessTModified
{
public:
    boost::shared_ptr<T> getT() const { return m_T; }

private:
    boost::shared_ptr<T> m_T;
}; 
```

最初的论点可能是`boost::shared_ptr<const T> getT() const`不会让 const 对象意外修改 T 。如果是这样，是否所有此类功能都应提供两个版本？对我来说，我觉得很乏味！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-14T17:44:09.137

您是对的： 的目的`boost::shared_ptr<const T> getT() const`是确保`const`对象不会意外修改 T 。

在 C++ 中，这被称为*const 正确性*，通常被认为是好的 C++ 设计。正如您所说，它通常会导致 getter 有两个版本（一个版本`const`和一个非`const`版本）。它最初可能很乏味（尽管一旦习惯了它就不错了），但结果可能非常有用。const 正确性使您可以声明函数，例如

```
void DoSomething(const AccessT& item); 
```

该承诺不会修改，因此如果执行任何声明为可能正在修改的操作`item`，编译器就会抛出错误。`DoSomething``item`

尽管 const 正确性通常被认为是良好的 C++ 设计，但一些开发人员认为必须声明某些函数的 const 和非 const 版本的开销比它的价值更麻烦。

如果您对更多信息感兴趣，C++ FAQ 有[一整节关于 const 正确性。](http://www.parashift.com/c++-faq/const-correctness.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:44:42.730

当感觉需要访问器类时，这种模式很常见，但作者不想走完整的方式来定义访问`AccessT`和`AccessTconst`常量访问。您看到的 hack 是通过常量和非常量访问器实现常量和非常量访问的不那么繁琐的方法。

这种模式的优点是易于实现，缺点是您将“const 指针”和“指向 const 的指针”的概念混合在一起。如果一个 AccessT 提供了一个`setT`成员，那么关于 const-ness 的混淆就会随之而来。

您可以将此访问模式与`const_`例如迭代器显示的模式进行对比，迭代器出现`const_iterator`并`iterator`允许可变迭代器和可变迭代器的所有四种组合。

# vim - Vim 更新后配色方案出现问题

> ID：14880597
> 
> 赞同：1
> 
> 时间：2013-02-14T17:28:37.050
> 
> 标签：vim, color-scheme

我最近在使用 vim 彩色显示时遇到问题。在 vim 7.2 版上，它运行良好，但自从我更新到 vim 7.3 后，大多数颜色方案的默认加载并不是`:colorscheme <name>`在 vim 加载后发出命令时它们看起来的样子。
例如，这就是我放入`colorscheme default`.vimrc 时 vim 的外观![在此处输入图像描述](../Images/1642749d8df4b030c24892ffe64b8f95.png)

虽然这是我在vim 启动 `colorscheme default` *后键入时的样子。*![在此处输入图像描述](../Images/469f55c2bebb4b66de8eb24ae25c02c7.png)

所有浅色主题也是如此。
是否有解决方法，也许主题文件中的一些更改会做。新版7.3和旧版7.2在色彩显示上有区别吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T01:09:52.753

**我完全改变了这个答案**

我做了一些研究（我也有一些配色方案的问题，最近开始在 MS Windows 中使用它）。
对于默认安装中的配色方案，我认为唯一的问题是`default`因为这不是设置`background`（从这里我使用缩写形式`bg`），只使用`set bg&`. 那就是“猜测”背景应该是什么。GUI在和**之后**加载，在此之前“猜测”是不正确的。 请参阅 VIM 手册`.vimrc``.gvimrc`
[`Options`](http://vimdoc.sourceforge.net/htmldoc/options.html#%27background%27)

> 当使用: :set background& 将 'background' 设置为默认值时，Vim 会猜测该值。在 GUI 中这应该可以正常工作，在其他情况下，Vim 可能无法猜出正确的值。
> 
> 启动 GUI 时，'background' 的默认值将是“light”。当 .gvimrc 中没有设置该值，并且 Vim 检测到背景实际上很暗时，'background' 设置为 "dark"。但这仅在读取 .gvimrc 文件后才会发生（因为需要打开窗口才能找到实际的背景颜色）。为了解决这个问题，通过在 .gvimrc 文件中放置一个 ":gui" 命令来强制打开 GUI 窗口，在使用 'background' 的值之前（例如，在 ":syntax on" 之前）。

这应该是根据以下的解决方案：

```
gui  " Before your line with syntax on
syntax on 
```

在`.vimrc`或`gvimrc`中，都没有关系（如果你不将它用于不同的环境）。
如果您不想更改加载顺序，可以试试这个

```
autocmd GuiEnter * set background& 
```

两者都对我有用。

但如果这没有帮助，我认为一定有一些插件把它搞砸了。
为了清楚起见；`set background=dark`没有**将**背景设置为深色，它告诉 vim 为深色背景调整颜色。

没有关于环境问题的信息，或者使用了哪些插件。所以这里是某种猜测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T12:24:56.260

我不知道是什么原因造成的，但作为一种解决方法，您可以将`:colorscheme <name>`命令放入您的`~/.gvimrc`（对于 GVIM），或者在您的`~/.vimrc`:

```
autocmd VimEnter * colorscheme <name> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-19T20:29:17.767

我有同样的问题。推杆有`set background=light`帮助。但我也注意到顺序很重要，我的意思是 _vimrc 文件中的 command`set backgroung=light`应该在 command 之后`colorscheme default`。

# python - 在 Ubuntu 10.04 中安装 Dropbox python SDK

> ID：14880598
> 
> 赞同：1
> 
> 时间：2013-02-14T17:28:39.003
> 
> 标签：python, linux, dropbox, dropbox-api

我的设置：Ubuntu 10.04、Dropbox SDK 1.5.1 和 python 2.7.3

我正在设置 Dropbox SDK，但遇到问题。

我的 python 工作正常，但是当我执行时

```
python setup.py install 
```

要安装 Dropbox SDK，它会显示一条消息

```
Traceback (most recent call last):
  File "setup.py", line 6, in <module>
    from setuptools import setup, find_packages
ImportError: No module named setuptools 
```

我用谷歌搜索了这条消息，发现我没有 setuptools。所以我转而安装python setuptools。然而，我又失败了。

我试图执行

```
sudo apt-get install python-setuptools 
```

但 Dropbox 的安装显示相同的消息。

我也去[http://pypi.python.org/pypi/setuptools](http://pypi.python.org/pypi/setuptools)下载文件**setuptools-0.6c11-py2.7.egg**然后我执行

```
sudo sh setuptools-0.6c11-py2.7.egg 
```

但是，我收到了另一条错误消息

```
Traceback (most recent call last):
  File "<string>", line 1, in <module>
zipimport.ZipImportError: can't decompress data; zlib not available 
```

我发现可能我还需要安装 zlib 相关的东西。因此，我按照建议执行

```
sudo apt-get install zlib1g-dev 
```

但情况似乎是一样的。我总是收到消息

```
Traceback (most recent call last):
  File "<string>", line 1, in <module>
zipimport.ZipImportError: can't decompress data; zlib not available 
```

**我什至使用了 Ubuntu 的 Synaptic 包管理器，并使用zlib**关键字检查并安装了每个包。但我仍然有同样的问题。

谁能给我一些关于如何在 Ubuntu 10.04 中安装 Dropbox SDK 的建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-05T20:28:01.107

对于遇到此问题并寻找答案的任何人，请使用以下命令：

```
sudo apt-get install python-setuptools 
```

将正确设置 setuptools，然后

```
sudo python setup.py install 
```

将工作。干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:44:07.970

对于 64 位

```
sudo ln -s /lib/x86_64-linux-gnu/libz.so.1 /lib/libz.so 
```

对于 32 位

```
sudo ln -s /usr/lib/i386-linux-gnu/libz.so /usr/lib 
```

同时安装：

`lib32z1`&`lib32z1-dev`用于 32 位软件包

# c++ - 在笛卡尔坐标和屏幕坐标之间转换

> ID：14880601
> 
> 赞同：17
> 
> 时间：2013-02-14T17:28:46.330
> 
> 标签：c++, algorithm, math, coordinates, coordinate-systems

对于我的游戏，我需要在两个坐标系之间转换的函数。嗯，这主要是数学问题，但我需要的是 C++ 代码来做这件事，以及如何解决我的问题的一些解释。

屏幕坐标：

a) 左上角是 0,0

b) 没有负值

c) right += x (x值越多，右边越多)

d) 底部 +=y

笛卡尔二维坐标：

a) 中点为 (0, 0)

b) 负值确实存在

c) 右 += x

d) 底部 -= y （y 越少，底部越多）

我需要一种简单的方法来从一个系统转换到另一个系统，反之亦然。为此，（我认为）我需要一些知识，例如 (0, 0) [屏幕坐标的左上角] 在笛卡尔坐标中的位置。

但是存在一个问题，笛卡尔坐标中的某个点在转换为屏幕坐标后，屏幕坐标中的位置可能是负数，这是胡说八道。我不能将屏幕坐标的左上角放在（-inifity，+infinity）笛卡尔坐标中......

我该如何解决这个问题？我能想到的唯一解决方案是将屏幕 (0, 0) 放在笛卡尔 (0, 0) 中，并且只使用笛卡尔系统的四分之一，但在这种情况下，使用笛卡尔系统毫无意义......

我确信有办法将屏幕坐标转换为笛卡尔坐标，反之亦然，但我的想法是用负值做错了。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-14T17:40:53.667

从笛卡尔坐标转换为屏幕坐标的基本算法是

```
screenX = cartX + screen_width/2
screenY = screen_height/2 - cartY 
```

但是正如您提到的，笛卡尔空间是无限的，而您的屏幕空间不是。这可以通过更改屏幕空间和笛卡尔空间之间的分辨率轻松解决。上述算法使笛卡尔空间中的 1 个单位 = 屏幕空间中的 1 个单位/像素。如果您允许其他比率，您可以“缩小”或缩小屏幕空间以覆盖所有必要的笛卡尔空间。

这会将上述算法更改为

```
screenX = zoom_factor*cartX + screen_width/2
screenY = screen_height/2 - zoom_factor*cartY 
```

现在，您可以通过修改缩放因子来处理负（或过大）screenX 和 screenY，直到您的所有笛卡尔坐标都适合屏幕。

您也可以允许平移坐标空间，这意味着允许笛卡尔空间的中心偏离屏幕中心。这也有助于让您的 zoom_factor 保持尽可能紧凑，但也适合未均匀分布在笛卡尔空间原点周围的数据。

这会将算法更改为

```
screenX = zoom_factor*cartX + screen_width/2 + offsetX
screenY = screen_height/2 - zoom_factor*cartY + offsetY 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-14T17:33:42.693

您必须知道屏幕的大小才能进行转换

转换为笛卡尔：

```
cartesianx = screenx - screenwidth / 2;
cartesiany = -screeny + screenheight / 2; 
```

转换为屏幕：

```
screenx = cartesianx + screenwidth / 2;
screeny = -cartesiany + screenheight / 2; 
```

对于屏幕值为负的情况：我不会担心，此内容将被剪切，因此用户不会看到。如果这*是*一个问题，我会添加一些约束来防止笛卡尔坐标太大。另一种解决方案，因为你不能让边缘是 +/- 无穷大，将缩放你的坐标（例如 1 像素 = 10 笛卡尔）让我们称之为`scalefactor`. 现在的方程是：

转换为具有比例因子的笛卡尔：

```
cartesianx = scalefactor*screenx - screenwidth / 2;
cartesiany = -scalefactor*screeny + screenheight / 2; 
```

转换为具有比例因子的屏幕：

```
screenx = (cartesianx + screenwidth / 2) / scalefactor;
screeny = (-cartesiany + screenheight / 2) / scalefactor; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-14T17:33:02.783

您需要知道屏幕的宽度和高度。

然后你可以这样做：

```
cartX =   screenX - (width / 2);
cartY = -(screenY - (height / 2)); 
```

和：

```
screenX =  cartX + (width / 2);
screenY = -cartY + (height / 2); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-14T17:38:34.817

您总是会遇到结果可能不在屏幕上的问题——要么是负值，要么是大于可用屏幕尺寸的值。

有时这并不重要：例如，如果您的图形 API 接受负值并为您剪辑您的绘图。有时这很重要，对于这些情况，您应该有一个函数来检查一组屏幕坐标是否在屏幕上。

您还可以编写自己的剪辑函数，尝试对从屏幕上掉下来的坐标做一些合理的事情（例如将负屏幕坐标截断为 0，以及对于最大屏幕坐标而言太大的坐标）。但是，请记住，“合理”取决于您要执行的操作，因此最好推迟定义此类函数，直到您真正需要它们。

* * *

无论如何，正如其他答案所指出的那样，您可以在坐标系之间转换为：

```
cart.x = screen.x - width/2;
cart.y = height/2 - screen.y; 
```

和

```
screen.x = cart.x + width/2;
screen.y = height/2 - cart.y; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-07T08:53:45.773

根据微软文章： [https ://msdn.microsoft.com/en-us/library/jj635757(v=vs.85).aspx，我为你准备了一些 boost c++](https://msdn.microsoft.com/en-us/library/jj635757(v=vs.85).aspx)

您只需要知道坐标系中的两个屏幕点和两个点。然后，您可以将点从一个系统转换为另一个系统。

```
#include <boost/numeric/ublas/vector.hpp>
#include <boost/numeric/ublas/vector_proxy.hpp>
#include <boost/numeric/ublas/matrix.hpp>
#include <boost/numeric/ublas/triangular.hpp>
#include <boost/numeric/ublas/lu.hpp>
#include <boost/numeric/ublas/io.hpp>

 /* Matrix inversion routine.
 Uses lu_factorize and lu_substitute in uBLAS to invert a matrix */
template<class T>
bool InvertMatrix(const boost::numeric::ublas::matrix<T>& input, boost::numeric::ublas::matrix<T>& inverse)
{
    typedef boost::numeric::ublas::permutation_matrix<std::size_t> pmatrix;

    // create a working copy of the input
    boost::numeric::ublas::matrix<T> A(input);

    // create a permutation matrix for the LU-factorization
    pmatrix pm(A.size1());

    // perform LU-factorization
    int res = lu_factorize(A, pm);
    if (res != 0)
        return false;

    // create identity matrix of "inverse"
    inverse.assign(boost::numeric::ublas::identity_matrix<T> (A.size1()));

    // backsubstitute to get the inverse
    lu_substitute(A, pm, inverse);

    return true;
}

PointF ConvertCoordinates(PointF pt_in,
    PointF pt1, PointF pt2, PointF pt1_, PointF pt2_)
{

    float matrix1[]={
         pt1.X,           pt1.Y,           1.0f,           0.0f,
        -pt1.Y,           pt1.X,           0.0f,           1.0f,
         pt2.X,           pt2.Y,           1.0f,           0.0f,
        -pt2.Y,           pt2.X,           0.0f,           1.0f
    };

    boost::numeric::ublas::matrix<float> M(4, 4);
    CopyMemory(&M.data()[0], matrix1, sizeof(matrix1));

    boost::numeric::ublas::matrix<float> M_1(4, 4);
    InvertMatrix<float>(M, M_1);

    double vector[] = {
        pt1_.X,
        pt1_.Y,
        pt2_.X,
        pt2_.Y
    };

    boost::numeric::ublas::vector<float> u(4);
    boost::numeric::ublas::vector<float> u1(4);
    u(0) = pt1_.X;
    u(1) = pt1_.Y;
    u(2) = pt2_.X;
    u(3) = pt2_.Y;

    u1 = boost::numeric::ublas::prod(M_1, u);

    PointF pt;
    pt.X = u1(0)*pt_in.X + u1(1)*pt_in.Y + u1(2);
    pt.Y = u1(1)*pt_in.X - u1(0)*pt_in.Y + u1(3);
    return pt;
} 
```

# java - 使用超类实例构造子类

> ID：14880605
> 
> 赞同：1
> 
> 时间：2013-02-14T17:28:55.780
> 
> 标签：java, sockets

我有 mysocket 类，它扩展了 Socket 类..

```
class MySocket extends Socket {
    public int id;
} 
```

现在我有一个从ServerSocket 的accept 方法得到的子类实例（Socket）。如何使用这个 Socket 实例来构造我的 MySockey 实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:34:09.503

你`Socket`从某个地方得到一个，所以你最好使用一个包装器来添加一个`id`，比如：

```
public class SocketWrapper {
    private Socket socket;
    private int id;
    // getter, setter, ctors, ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:47:30.997

仅当您想向类本身添加一些附加功能时，才对类进行子类化才有意义。在您的情况下，您似乎只想使用套接字。所以@RC 建议的方法是正确的。您可以将 Socket 对象作为实例成员，而不是继承 Socket 类，并且可以为其分配 server.accept() 返回类型。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T17:43:10.890

我同意包装而不是扩展 Socket 的建议。但是，如果您决定继续扩展，请向您的子类添加一个以 Socket 作为参数的构造函数。将 Socket 方法委托给它。

# postgresql - 错误：关系不存在（创建表）

> ID：14880606
> 
> 赞同：1
> 
> 时间：2013-02-14T17:28:55.640
> 
> 标签：postgresql, ddl

我是 Postgresql (9.2) 的新手，在指定模式中创建表时遇到问题

当我在公共模式中创建相同的表时，它工作正常，但在我的“测试”模式中它没有

```
--> ERREUR:  la relation « intervention_site » n'existe pas
--> ERROR: the relation « intervention_site » does not exist. 
```

也许是一个正确的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T15:49:50.107

该`test`架构可能不在您的搜索路径中。

您可以通过多种方法进行更改。您可以临时更改它或为会话更改它：

```
SET search_path=test; 
```

完成后，您可以重置：

```
RESET search_path; 
```

如果要将其设置为给定 db 用户的默认值：

```
ALTER USER foo SET search_path=test; 
```

或重置：

```
ALTER USER foo RESET search_path; 
```

您也可以通过这种方式更改数据库。

如果您希望继续能够检查公共表，请使用逗号分隔的列表：

```
SET search_path=test,public; 
```

# django - Django 表单向导：如何将“确认”屏幕作为向导的最后一步？

> ID：14880609
> 
> 赞同：1
> 
> 时间：2013-02-14T17:29:07.957
> 
> 标签：django

从之前的问题重新发布：

[Django FormWizards：如何在表单之间轻松传递用户输入的数据？](https://stackoverflow.com/questions/14860392/django-formwizards-how-to-painlessly-pass-user-entered-data-between-forms/14863853#comment20849729_14863853)

我在 Django 1.4.3 中使用 FormWizard 功能。

我已经成功创建了一个 4 步表单。在表单的前 3 个步骤中，它正确地从用户那里获取信息，对其进行验证等。在第 4 步中，它现在只显示一个“确认”按钮。没有其他的。当你在第 4 步点击“确认”时，在 done() 函数中使用它做一些有用的事情。到目前为止，一切正常。

但是，我想让它在第 4 步（确认步骤）中向用户显示他们在前面的步骤中输入的数据以供他们查看。我试图找出最轻松的方法来实现这一点。到目前为止，我正在上下文中创建一个名为 formList 的条目，其中包含已完成的表单列表。

my4StepWizard 类（SessionWizardView）：

```
def get_template_names(self):
    return [myWizardTemplates[self.steps.current]]

def get_context_data(self, form, **kwargs):
    context = super(my4StepWizard, self).get_context_data(form=form, **kwargs)
    formList = [self.get_form_list()[i[0]] for i in myWizardForms[:self.steps.step0]]

    context.update(
        {
            'formList': formList,
        }
    )
    return context        

def done(self, form_list, **kwargs):
    # Do something here.
    return HttpResponseRedirect('/doneWizard') 
```

表格 #1 有一个名为 myField 的输入字段。所以在我的第 4 步模板中，我想做 {{ formList.1.clean_myField }}。但是，当我这样做时，我收到以下错误：

异常值：“my4StepWizard”对象没有属性“cleaned_data”

我放入 formList 的表单似乎是无限的。所以它们不包含用户的数据。有没有可以用来获取数据本身的修复程序？我真的很想像上面那样使用上下文来传递数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T20:49:32.893

如果您的三个表单中没有重复的字段名称，您可以使用 WizardView.get_all_cleaned_data()。它返回所有可以通过 get_context_data() 传递给模板的数据的字典，就像您尝试做的那样。[这是我目前正在采取的角度](https://stackoverflow.com/questions/14912429/how-can-i-show-a-preview-of-all-data-entered-as-a-final-django-form-wizard-step)，但我希望找到更好的方法。

# javascript - 使用动态最小值和最大值生成动态 jQuery 滑块

> ID：14880611
> 
> 赞同：0
> 
> 时间：2013-02-14T17:29:10.417
> 
> 标签：javascript, jquery-ui

我有一个项目，要求最终用户选择每位摄影师不同的摄影师和相关卷号（数据由页面加载时的 JSON 数据库调用引入并放入 Javascript 数组中——用于快速显示值） . 我已经创建了一个包含我需要的所有内容的 jsFiddle，但是动态创建的滑块在创建后不会移动。我确信它与最小值和最大值有关，但它“似乎”是正确的。自动完成部分仅显示摄影师选择，然后从现有 HTML 元素动态创建其下方的滑块。我已经删除了很多我用来解决问题的基础的无关代码。

[jsFiddle 链接] [http://jsfiddle.net/sN63W/2/](http://jsfiddle.net/sN63W/2/)

```
(Ommiting data array named 'Photographer' - But it is in the jsFiddle Link)

$(function () {
   $("#photographer-label").autocomplete({
      minLength: 0,
      source: Photographer,
      focus: function (event, ui) {
          $('#photographer-label').val(ui.item.label);
          return false;
      },
      select: function (event, ui) {
          $('#photographer').val(ui.item.value);
          $('#photographer-label').val(ui.item.label);
          var slider_min = ui.item.rollnum_from;
          var slider_max = ui.item.rollnum_to;
          alert('Selected Rolls: ' + slider_min + ' : ' + slider_max); // For Debugging
          $('#rollnum-slider').slider({
              min: slider_min, // ui.item.rollnum_from,
              max: slider_max, // ui.item.rollnum_to,
              change: function (event, ui) {
                  $('#rollnum').val(ui.value);
              }
          });
      }
   });
}); 
```

具有讽刺意味的是，如果我在滑块的最小值和最大值中插入一个硬编码数字，它就可以正常工作。但是这些值（根据警告框）似乎是正确的。我错过了什么？我知道这可能是一个简单的答案，但我只是对此感到头疼。

PS作为一个附带问题，当您将焦点移到滑块上时，我还希望自动完成显示“标签”而不是“数据”，但它似乎没有这样做。但这没什么大不了的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:49:09.950

这是因为您的 JSON 数据是一个字符串，请去掉这些值的引号，例如

```
{
      "photographer_id": "2",
          "label": "Tommy Stay (TS)",
          "value": "TS",
          "rollnum_from": 1,
          "rollnum_to": 10
} 
```

代替

```
{
      "photographer_id": "2",
          "label": "Tommy Stay (TS)",
          "value": "TS",
          "rollnum_from": "1",
          "rollnum_to": "10"
} 
```

这是Jsfiddle，

[http://jsfiddle.net/ufv9T/1/](http://jsfiddle.net/ufv9T/1/)

注意：我将“更改”更改为“幻灯片”并添加了“值”，`$( "#rollnum" ).val( $( "#rollnum-slider" ).slider( "value" ) );`以便在滑块的初始加载时显示一个数字，这不是您的示例工作所必需的。

# java - 在 Mac 上的 Java 应用程序中使用 R

> ID：14880615
> 
> 赞同：0
> 
> 时间：2013-02-14T17:29:41.473
> 
> 标签：java, macos, r, tomcat, rjava

这是[我之前](https://stackoverflow.com/questions/8977723/setup-r-and-java-application-on-osx-10-7-2)一篇关于在 Mac 上使用 R 和 JAVA 的后续文章。我的应用程序依赖于 R 来运行。我已经安装了 Java，Java 版本“1.6.0_37”。我已经安装了“R”，R 版本 2.15.1。现在我需要包含在[rJava](http://www.rforge.net/rJava/index.html)中的 JRI 。

在 R 内部，我运行了以下命令

> install.packages('rJava',,' [http:](http://www.rforge.net/) //www.rforge.net/ ')

这是输出：

```
install.packages('rJava',,'http://www.rforge.net/')
trying URL 'http://www.rforge.net/bin/macosx/leopard/contrib/2.15/rJava_0.9-4.tgz'
Content type 'application/x-gzip' length 506489 bytes (494 Kb)
opened URL
==================================================
downloaded 494 Kb

The downloaded binary packages are in
    /var/folders/gz/1jwm65h12132yq8_1wdsl9cr0000gn/T//RtmpGHpTYR/downloaded_packages 
```

我从这里去哪里？

启动tomcat时出现以下错误：

```
Cannot find JRI native library!
Please make sure that the JRI native library is in a directory listed in java.library.path.

    java.lang.UnsatisfiedLinkError: no jri in java.library.path
        at java.lang.ClassLoader.loadLibrary(ClassLoader.java:1758)
        at java.lang.Runtime.loadLibrary0(Runtime.java:823)
        at java.lang.System.loadLibrary(System.java:1045)
        at org.rosuda.JRI.Rengine.<clinit>(Rengine.java:9)
        at com.visibleequity.servlets.VisibleEquityServlet.init(VisibleEquityServlet.java:55)
        at javax.servlet.GenericServlet.init(GenericServlet.java:160)
        at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1274)
        at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1186)
        at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1081)
        at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5033)
        at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5320)
        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)
        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)
        at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1114)
        at org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1673)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
        at java.util.concurrent.FutureTask.run(FutureTask.java:138)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        at java.lang.Thread.run(Thread.java:680) 
```

**更新 2/15/13 尝试设置环境变量后...**

我自己的路：

```
 DAVIDs-MacBook-Pro-2:~ dave$ echo $PATH
/opt/local/bin:/opt/local/sbin:/usr/local/rvm/gems/ruby-1.9.3-p194/bin:/usr/local/rvm/gems/ruby-1.9.3-p194@global/bin:/usr/local/rvm/rubies/ruby-1.9.3-p194/bin:/usr/local/rvm/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/git/bin:/opt/sm/bin:/opt/sm/pkg/active/bin:/opt/sm/pkg/active/sbin:/usr/local/mysql/bin:/usr/libexec/java_home:/Library/Frameworks/R.framework/Versions/2.15:/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rJava/jri 
```

![环境变量](../Images/b129b2b8d584206e2a076fd65299fabf.png)

![JAVA_HOME 位置](../Images/82b57b666dcecc483daa19af0838a31f.png)

![R_HOME 和 JRI 位置](../Images/7139df87bfc0e3a5e0c2900e0a017104.png)

**仍然收到上面的错误。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:55:02.923

确保运行 Tomcat 的用户的环境变量存在。

# mysql - 选择未加入的记录以及加入的记录

> ID：14880618
> 
> 赞同：1
> 
> 时间：2013-02-14T17:29:44.450
> 
> 标签：mysql

您好，我有以下格式的两个表格：

一张桌子：

```
 ID   |  columnx | event |
  1    |     4    | call  |
  2    |     7    | call  |
  3    |     4    | call  |
  4    |     11   | visit | 
```

B 表：

```
columnx  | fName |
  4      | clare |
  7      | Bill  |
  9      | Tom   |
  11     | Nick  | 
```

我做了如下查询：

```
Select A.columnx ,B.fName,Count(event) as Calls
from A
Left Join B on A.columnx = B.columnx 
where 'event' LIKE 'call'; 
```

它给出的输出如下：

```
 columnx | fname  | Calls|
    4     | Clare  |   2  |
    7     | Bill   |   1  |
    11    | Nick   |   0  | 
```

但是我怎样才能得到以下输出：

```
 columnx  | fname  | Calls|
    4     | Clare  |   2  |
    7     | Bill   |   1  |
    11    | Nick   |   0  |
    9     | Tom    |   0  | 
```

我的意思是当一个特定的记录没有被加入时，我仍然需要选择计数为 0 的记录。这可以通过加入来完成，还是我需要找到另一种方式。有什么建议么。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:35:54.840

将 'event' LIKE 'call' 移动到左连接的附加条件

```
 Select B.columnx ,B.fName ,Count(A.'event') as Calls
    from A
    Right Join B on A.columnx   = B.columnx   and A.'event' LIKE 'call'
    group by B.columnx  ,B.fName 
    order by B.columnx 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:43:16.893

您可以使用子查询来获取`count()`调用：

```
select dv.columnx,
  dv.fname,
  coalesce(dl.calls, 0) Calls
from device dv
left join
(
  select count(dl.event) Calls, dl.columnx
  from deal dl
  where dl.event LIKE 'call'
  group by dl.columnx
) dl
  on dv.columnx = dl.columnx 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/50924/7)。

或者，这可以通过将`WHERE`过滤器移动到以下位置来完成，而无需子查询`JOIN`：

```
select dv.columnx,
  dv.fname,
  coalesce(count(dl.event), 0) Calls
from device dv
left join deal dl
  on dv.columnx = dl.columnx
  and dl.event LIKE 'call'
group by dv.columnx,  dv.fname 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/50924/8)

这将返回：

```
| COLUMNX | FNAME | CALLS |
---------------------------
|       4 | clare |     2 |
|       7 |  Bill |     1 |
|       9 |   Tom |     0 |
|      11 |  Nick |     0 | 
```

# javascript - jQuery UI Accordion - 单击不同部分时加载上一部分的内容

> ID：14880631
> 
> 赞同：0
> 
> 时间：2013-02-14T17:30:10.340
> 
> 标签：javascript, jquery, html, css, jquery-ui

我正在尝试实现可排序的 jQuery UI 手风琴，但是当我单击第一节时，例如它打开时没有内容，如果我然后单击第二节，则第一节中的内容会尝试加载，但该部分在完全加载之前已关闭，并且第二部分打开时没有内容。

HTML：

```
<!DOCTYPE html> 
<html lang="en"> 
  <head> 
    <meta charset="utf-8" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.0/jquery-ui.min.js"></script>
    <title>History of Le Mans</title>   
    <link rel="stylesheet" type="text/css" href="CSS/common.css">
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.0/themes/base/jquery-ui.css" />
    <script src="JS/common.js"></script>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
  </head>
  <body>
    <nav>
      <ul id="tabs">
        <li><a href="#" id="tab1" name="#tabContent1" class="activeTab">Home</a></li>
        <li><a href="#" id="tab2" name="#tabContent2">History</a></li>
        <li><a href="#" id="tab3" name="#tabContent3">The Circuit</a></li>
        <li><a href="#" id="tab4" name="#tabContent4">Gallery</a></li> 
        <li><a href="#" id="tab5" name="#tabContent5">Further Reading</a></li>    
      </ul>
    </nav>
    <div id="content">
      <div id="tabContent1"></div>
      <div id="tabContent2">
        <div id="accordion">
          <div class="group">
            <h3>Section 1</h3>
            <div>
              <p>Mauris mauris ante, blandit et, ultrices a, suscipit eget, quam. Integer ut neque. Vivamus nisi metus, molestie vel, gravida in, condimentum sit amet, nunc. Nam a nibh. Donec suscipit eros. Nam mi. Proin viverra leo ut odio. Curabitur malesuada. Vestibulum a velit eu ante scelerisque vulputate.</p>
            </div>
          </div>
          <div class="group">
            <h3>Section 2</h3>
            <div>
              <p>Sed non urna. Donec et ante. Phasellus eu ligula. Vestibulum sit amet purus. Vivamus hendrerit, dolor at aliquet laoreet, mauris turpis porttitor velit, faucibus interdum tellus libero ac justo. Vivamus non quam. In suscipit faucibus urna. </p>
            </div>
          </div>
          <div class="group">
            <h3>Section 3</h3>
            <div>
              <p>Nam enim risus, molestie et, porta ac, aliquam ac, risus. Quisque lobortis. Phasellus pellentesque purus in massa. Aenean in pede. Phasellus ac libero ac tellus pellentesque semper. Sed ac felis. Sed commodo, magna quis lacinia ornare, quam ante aliquam nisi, eu iaculis leo purus venenatis dui. </p>
              <ul>
                <li>List item one</li>
                <li>List item two</li>
                <li>List item three</li>
              </ul>
            </div>
          </div>
          <div class="group">
            <h3>Section 4</h3>
            <div>
              <p>Cras dictum. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Aenean lacinia mauris vel est. </p><p>Suspendisse eu nisl. Nullam ut libero. Integer dignissim consequat lectus. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. </p>
            </div>
          </div>
        </div>
      </div>
      <div id="tabContent3"></div>
      <div id="tabContent4"></div>
      <div id="tabContent5"></div>
    </div>
  </body>
</html> 
```

jQuery：

```
 $(function () {
    $("#accordion")
      .accordion({
        header: "> div > h3"
      })
      .sortable({
        axis: "y",
        handle: "h3",
        stop: function (event, ui) {
          ui.item.children("h3").triggerHandler("focusout");
        }
      });
  }); 
```

jQuery 教程：http: [//jqueryui.com/accordion/#sortable](http://jqueryui.com/accordion/#sortable)

是什么导致了这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:01:15.737

这是手风琴在不可见时渲染的问题。[您可以在此处](http://bugs.jqueryui.com/ticket/3905)看到一个问题，它被列为无法修复。

您的选择是使用选项创建手风琴，或者 在导航到选项卡后`{ heightStyle: "content" }`调用。`$("#accordion").accordion("refresh");`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:44:43.093

试试这个代码。

```
$(function() {
    $( "#accordion" )
        .accordion({
            header: "> div > h3",
            heightStyle: "content"
        })
        .sortable({
            axis: "y",
            handle: "h3",
            stop: function( event, ui ) {
                // IE doesn't register the blur when sorting
                // so trigger focusout handlers to remove .ui-state-focus
                ui.item.children( "h3" ).triggerHandler( "focusout" );
            }
        });
}); 
```

# c# - WPF 从模板对象中获取指针

> ID：14880636
> 
> 赞同：0
> 
> 时间：2013-02-14T17:30:15.470
> 
> 标签：c#, wpf, xaml, templates

我有一个如下所示的 XAML 片段：

```
<UserControl.Resources>
<DataTemplate DataType="{x:Type ns:MyObject}">
    <Grid>
        /// Stuff

    </Grid>
    <GridView x:Name="MyGrid" />
</DataTemplate>
</UserControl.Resources>

<ns:MyObject x:Name="MyLovelyObject" /> 
```

现在，我想要一个指向“MyGrid”的指针。但是，由于 WPF 的内在设计，不可能在代码级别轻松访问“MyGrid”。所以，我正在寻找替代方案。以下是我想做但不能完全解决语法的事情（注意：GridView 是 MyObject 的公共属性）：

```
<UserControl.Resources>
<DataTemplate DataType="{x:Type ns:MyObject}">
    <Grid>
        /// Stuff

    </Grid>
    <GridView Binding="{Path=GridView}" />

</DataTemplate>
<GridView x:Key="GridViewTemplate">
    /// Lots of stuff
</GridView>
</UserControl.Resources>

<ns:MyObject x:Name="MyLovelyObject" GridView="{Binding GridViewTemplate}" /> 
```

无论如何，这显然是行不通的。基本上看来我对 XAML 有两个目标： 1\. 使用 DataTemplate 创建 MyObject 2\. 使用另一个 DataTemplate 初始化 MyObject.GridView （注意：GridView 是一个 GUI 对象）

对此有任何意见吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:53:33.610

我不是 100% 确定你在代码中做了什么，但我会尽力而为。

首先，DataTemplate 的存在只是为了告诉 WPF 如何绘制一个对象。它们不是会自行呈现的实际 UI 对象。

有两种类型的数据模板：隐式和显式。

隐式 DataTemplate 没有`x:Key`字段，并且在 WPF 去呈现指定 DataType 的对象时自动使用。

例如，您`<DataTemplate DataType="{x:Type ns:MyObject}">`在第一个代码块中有，因此 WPF 将在需要呈现类型对象的任何时候使用此模板`ns:MyObject`

显式数据模板已`x:Key`为它们定义，并且必须在要使用它们的 XAML 中显式定义。例如，如果您有`<DataTemplate x:Key="CustomNsObjectTemplate">`，那么您可以将它应用于您的对象，例如`<ns:MyObject Template="{StaticResource CustomNsObjectTemplate}" />`

其次，如果`GridView`对象是 UI 对象，则应使用 a`ContentControl`来显示它，而不是尝试使用另一个`GridView`. 就像是

```
<ContentControl Content="{Binding GridView}" /> 
```

现在我怀疑你想要做的是`GridView`在你的 DataTemplate 中使用一个自定义对象，方法是将你的`GridView`in传递给你的类`UserControl.Resources`的`GridView`属性。`MyObject`

如果是这种情况，您需要在 中创建`GridView`UI 对象，并使用定义中的绑定`<UserControl.Resources>`将其传递给您的对象。`{Static Resource }``MyObject`

You'll also want to switch how you display the `GridView` in your `DataTemplate` from a `GridView` to a `ContentControl`, and you'll probably want to wrap both your `Grid` and `GridView` in a single parent control, like a `StackPanel` or you'll get an exception.

So your end code might look something like this:

```
<UserControl.Resources>
    <DataTemplate DataType="{x:Type ns:MyObject}">
        <StackPanel>
            <Grid>
                /// Stuff
            </Grid>
            <ContentControl Content="{Binding Path=GridView}" />
        </StackPanel>
    </DataTemplate>

    <GridView x:Key="MyCustomGridView">
        /// Lots of stuff
    </GridView>
</UserControl.Resources>

<ns:MyObject GridView="{StaticResource MyCustomGridView}" /> 
```

# iphone - 如何在 iPhone 上测试 Dreamweaver 网站

> ID：14880646
> 
> 赞同：0
> 
> 时间：2013-02-14T17:30:48.520
> 
> 标签：iphone, dreamweaver

我知道这看起来有点傻。我这里有一部iphone，我需要在dreamweaver 中测试我正在开发的网站。我是否以某种方式保存并通过电子邮件发送给自己，然后在 iphone 中打开它？什么是最好的方法来做到这一点。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:37:43.457

编辑：在 iPhone 上公开/测试您的网站与让任何客户都可以使用该网站没有什么不同。您必须以一种或另一种方式发布网站。

我将首先获取 Webmatrix2 中包含的免费 iPhone 模拟器，链接在这里：[http ://www.hanselman.com/blog/SimulatingAnIPhoneOrIPadBrowserForASPNETMobileWebDevelopmentWithWebMatrix2OrVisualStudio2012.aspx](http://www.hanselman.com/blog/SimulatingAnIPhoneOrIPadBrowserForASPNETMobileWebDevelopmentWithWebMatrix2OrVisualStudio2012.aspx)

要在您的 iphone 上实际显示该页面，您必须使用网络服务器公开您的网站。Webmatrix 可以帮助您，或者只是将您的网站上传到任何托管服务提供商。

Microsoft Azure 是一个非常适合在尝试时使用的托管平台，我强烈推荐它！

如何使用 Webmatrix 发布网站： http: [//www.microsoft.com/web/post/how-to-publish-a-web-application-using-webmatrix](http://www.microsoft.com/web/post/how-to-publish-a-web-application-using-webmatrix)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:14:42.817

有一个有用的东西 - [Edge Inspect](http://html.adobe.com/edge/inspect/)。使用此插件，您可以简单地将任何设备连接到计算机并进行预览（如浏览器中的预览）。该页面将自动上传到服务器（您需要一个测试服务器才能使用 Edge Inspect）并显示在设备上。

# complexity-theory - 复杂性类问题 P、NP、EXP？

> ID：14880647
> 
> 赞同：0
> 
> 时间：2013-02-14T17:30:54.993
> 
> 标签：complexity-theory, fibonacci

计算斐波那契数列的第n个数的问题属于复杂类问题？我想在P班，给我确认一下！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:35:03.433

是的，它肯定是使用[比内公式](http://www.maths.surrey.ac.uk/hosted-sites/R.Knott/Fibonacci/fibFormula.html)的 P 类但是，我们不能给出确切的数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:34:53.327

有[一个解析解](http://en.wikipedia.org/wiki/Fibonacci_number#Matrix_form)，所以它是 O(1)，这意味着它在 P 中。

# java - 输入不是有效的 SOAP 消息，因为缺少以下标头

> ID：14880648
> 
> 赞同：0
> 
> 时间：2013-02-14T17:30:51.320
> 
> 标签：java, web-services, soap

我收到以下消息，

输入不是有效的 SOAP 消息，因为缺少以下标头

能够从 SOAP UI 获得响应。但我无法从我的代码中得到响应。

这是代码

```
post.setRequestHeader(
        "Content-type", "text/xml; charset=ISO-8859-1");
RequestEntity entity;
HttpClient httpclient = new HttpClient();
httpclient.getParams().setSoTimeout(10000);
entity = new StringRequestEntity(getReceiveTranscactionRequest(), "text/xml",
        "ISO-8859-1");
post.setRequestEntity(entity); 
```

我在 getReceiveTranscactionRequest() 方法中收到硬编码请求

添加 XML 请求 -> [http://www.teleflora.com/webservices/ReceiveTransactions](http://www.teleflora.com/webservices/ReceiveTransactions) uuid:e11c3a90-5929-46d9-85dc-f75df736e740urn:TelefloraWebServices/Gateway [http://schemas.xmlsoap.org/ws/2004/03/addressing /角色/匿名](http://schemas.xmlsoap.org/ws/2004/03/addressing/role/anonymous)2009-10-01T21:53:36Z43357100XTYNHW81NzUzNzVhNDMtZDhlYS04NTZlLThkMDMtODExNGFjOTk5NmMy 2009-10-01T21:53:36Z

# iis-7 - 'C:\Windows\System32\drivers\etc' 中的 'hosts' 文件自动重命名为 'tmphosts'

> ID：14880650
> 
> 赞同：1
> 
> 时间：2013-02-14T17:31:10.137
> 
> 标签：iis-7, hosts

我在 IIS7 上的“etc”目录中使用主机文件。我遇到了一个非常奇怪的问题。在一段不确定的时间后，hosts 文件自动重命名为 tmphosts。通常在重新启动计算机后，有时在工作之间。

我为此运行了 Microsoft Fix，但问题仍然存在。

我曾尝试禁用防病毒软件，但没有运气。

请帮我解决它。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-23T09:45:53.157

大多数情况下，如果主机文件包含许可证验证链接的重定向，则该文件会被重命名，以便下次许可应用程序可以连接到服务器。有时它被重命名，有时文件内容被删除。这两种情况我都见过。

# webkit - 在 Plone 4.1.4 中，使用 Carousel，border-radius css 在 Safari 中不持久

> ID：14880651
> 
> 赞同：1
> 
> 时间：2013-02-14T17:31:12.480
> 
> 标签：webkit, plone, carousel, css

基本上，我希望在新 Plone 网站的主页上的轮播上设置圆角。因此，在 custom.css 中，我添加了从 Firebug 中找到的类：

```
.carousel-banners{
-webkit-border-radius: 16px;
-moz-border-radius: 16px;
border-radius: 16px;
margin-bottom: 10px;
} 
```

在 Safari 中，第一个图像加载圆角，然后所有后续图像都失去圆角。有 5 张图像，每张图像的 Carousel 设置为 5 秒，交叉淡入淡出过渡为 0.5 秒。使用 Carousel 2.2、Plone 4.1.4。

似乎在 IE、FF、Chrome、Opera 中表现良好，只是在 Safari 中不持久。有任何想法吗？

# c# - 如何使用 Google 翻译 API v2 库指定 POST 方法而不是 GET

> ID：14880659
> 
> 赞同：2
> 
> 时间：2013-02-14T17:31:42.720
> 
> 标签：c#, .net, google-translate

我需要能够使用 Google translate API v2 库指定 POST 方法而不是 GET。这是我的代码：

```
Google.Apis.Translate.v2.TranslationsResource.ListRequest request =  this.client.Translations.List( cadena, idiomaDestino );
request.Source = idiomaOriginal;
request.Format = Google.Apis.Translate.v2.TranslationsResource.Format.Html;
TranslationsListResponse response = request.Fetch();
if ( response.Translations.Count > 0 )
{
    //Do something with the translations
} 
```

# actionscript-3 - 将宽度和高度设置为加载器

> ID：14880662
> 
> 赞同：1
> 
> 时间：2013-02-14T17:31:51.173
> 
> 标签：actionscript-3, actionscript

我正在使用下面的代码循环从我的`xml`文件中获取变量。我的`xml`文件包含一个图像路径（[http://www.mydomain.com/images/image.jpg](http://www.mydomain.com/images/image.jpg)），但宽度和高度有点大。

当我设置`.width`和`.height`currentLoader 我的拇指停止出现。

我尝试了`.scaleY`and`.scaleX`但我所有的拇指都没有相同的`width`and `height`。

有人可以帮我解决这个问题吗？

```
private function xmlLoaded(evt:Event):void
{

var currentPosY:Number = 0;
imagesXML = new XML(evt.target.data);
for (var i:uint = 0; i < imagesXML.article.length(); i++)
{

listItem=new itemList();
listItem.x = 25;
listItem.y = currentPosY;
listItem.num=i;
listContainer.loaderMc.addChild(listItem);
currentPosY +=  125;
trace(imagesXML.article[i].photo.toString());
listItem.labelTxt.text = imagesXML.article[i].name.toString();
loadThumbsFromXml(listItem,imagesXML.article[i].photo.toString());
listItem.buttonMode=true;
listItem.mouseChildren=false;
listItem.addEventListener(MouseEvent.CLICK,openPreview);

}

boundsScroll = new flash.geom.Rectangle(480,0,0,455);
setScroll();

}

private function loadThumbsFromXml(target:MovieClip,path:String)
 {          
var currentLoader:Loader=new Loader();
currentLoader.load(new URLRequest(path));           
//currentLoader.width = 115;
//currentLoader.height = 95;
target.thumbLoader.addChild(currentLoader);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-10T19:35:08.623

我看到您找到了问题的答案....但是我有另一种方法可以得到它，所以我的方法是在您的库中创建一个新符号作为 MovieClip 并将其链接为 Mc_Holder ...重点是：您的 MovieClip添加了一个 Square （或任何你想要的东西），并且在你添加加载器的 Child 之前，flash 知道它的属性，所以你现在有了宽度和高度；）

我的代码

```
import flash.display.MovieClip;
import flash.display.Sprite;

var url:String = "images/1.jpg";
var myloader:Loader = new Loader();
var request:URLRequest = new URLRequest(url);
var mc_holder:Sprite = new Mc_Holder();  // from library 
addChild (mc_holder);

myloader.load(request);
mc_holder.addChild(myloader);

mc_holder.width =10;
mc_holder.height =10; 
```

实际上它不是您的“装载机宽度和高度”，但您可以根据宽度和高度调整它并根据需要放置一个新的 Mc_Holder

# c# - 我可以在 Windows 应用程序而不是网页中包含 reCAPTCHA 吗？

> ID：14880665
> 
> 赞同：3
> 
> 时间：2013-02-14T17:32:01.470
> 
> 标签：c#, .net, windows, recaptcha

我想将它集成到 Windows 应用程序中。我正在使用 Visual Studio 2010，它是一个 C# Windows 窗体应用程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T17:52:59.557

```
 public static Image DownloadReCaptcha(string key, ref string challenge)
    {

        try
        {
            WebClient client = new WebClient();
            string response = client.DownloadString(string.Format("http://api.recaptcha.net/challenge?k={0}", key));

            Match match = Regex.Match(response, "challenge : '(.+?)'");

            if (match.Captures.Count == 0)
            {
                challenge = null;
                return null;
            }

            challenge = match.Groups[1].Value;
            if (File.Exists("captcha.jpg")) File.Delete("captcha.jpg");
            client.DownloadFile(string.Format("http://www.google.com/recaptcha/api/image?c={0}", challenge),
                                "captcha.jpg");
            return Image.FromFile("captcha.jpg");

        }
        catch (Exception)
        {
            challenge = null;
            return null;
        }
    } 
```

像这样使用它：

```
string challenge = null; // you will need this to submit captcha answer
pictureBox1.Image = DownloadReCaptcha("reCaptcha site key", ref challenge); 
```

## 如何找到钥匙？

在网页的 HTML 源代码中，您会发现类似

`<script type="text/javascript" src="http://www.google.com/recaptcha/api/challenge?k=6LexLsMSAAAAABUuI6bvUYfxaumgcu0vGiEFotDA"></script>`

`key = 6LexLsMSAAAAABUuI6bvUYfxaumgcu0vGiEFotDA`

# jquery - jQuery AJAX 意外的“未定义”结果（有效 JSON）

> ID：14880666
> 
> 赞同：0
> 
> 时间：2013-02-14T17:32:04.887
> 
> 标签：jquery, ajax, jquery-mobile

我有一个正在开发的 PhoneGap / jQuery Mobile 应用程序。我在以前使用过的脚本上得到了一些奇怪的结果。

```
$.ajax({type: "GET",
            url: "http://****.net/****/GetMembers.php",
            data: {get_param: "Member"},
            dataType: "json",
            success: function (data) {
                $.each(data, function (index, element) {
                    $("#members-content").append("<li><a id='members-a-" + element.ID + "' data-id='" + element.ID + "' href='#member-details'><img src='" + element.ImgURL + "' /><h3>" + element.Name + "</h3></a></li>");
                    $("#members-a-" + element.ID).bind('click', function () {Members.MemberID = $(this).attr('data-id'); MemberDetails.Load(); });
                    $("#members-content").listview("refresh");
                    });
           }
    }); 
```

从 web 服务返回的 JSON：

> [{"会员":{"ID":1,"姓名":"会员 1","ImgURL":null}},{"会员":{"ID":2,"姓名":"会员 2" ,"ImgURL":null}},{"Member":{"ID":3,"Name":"Member 3","ImgURL":null}},{"Member":{"ID":4, "姓名":"会员 4","ImgURL":null}}]

在我的`#members-content`列表中，我得到`undefined`了`<h3>`name 元素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:37:25.070

你在那里有一个双重嵌套的对象。你应该使用

```
element.Member.ImgURL 
```

例如查看 json：

```
[
    {   <--element in your .each() loop
       "Member": {
           "ID":1,
           "Name":"Member 1",
           "ImgURL":null
       }
    },
    { etc... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:37:24.940

每个元素都有一个成员。所以：

```
element.ID 
```

应该：

```
element.Member.ID 
```

ImgURL 和名称也是如此

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T17:51:24.980

你有两个选择：[在这里找到两个小提琴](http://jsfiddle.net/ChkfL/)

要么像你目前正在做的那样循环，但有一个变化：

这必须是这样的`element.Member.Name`

或者像这样再次循环遍历它：

```
$.each(data, function (index, element) {
   $.each(element, function (index, e) {
    console.log(e.Name); // <----here you will get the correct response
   });
}); 
```

# c# - 新服务 cmdlet 的 C# 实现

> ID：14880668
> 
> 赞同：-3
> 
> 时间：2013-02-14T17:32:09.660
> 
> 标签：c#, powershell, service, windows-services

我需要安装一个可执行文件作为服务，我需要使用用 C# 编写的 PowerShell cdmlet 来完成。本质上，我需要创建所需的注册表项等来定义服务（包括要运行的可执行文件 - 一种 srvany.exe）。

我还需要能够定义此服务的登录身份（凭据）。

TIA，汉斯

到目前为止我尝试了什么。我一直在查看 ServiceProcessInstaller 和 ServiceProcessInstaller 类，但它们错过了定义“外部”可执行文件的可能性。

```
 public partial class MyServiceInstaller : Installer
    {
        public MyServiceInstaller()
        {
            IDictionary saveState = null;
            this.Installers.Clear();
            ServiceProcessInstaller spi = new ServiceProcessInstaller();
            ServiceInstaller si = new ServiceInstaller();
            spi.Account = ServiceAccount.LocalSystem;
            spi.Username = null;
            spi.Password = null;
            si.ServiceName = "MyService";
            si.DisplayName = "MyService";
            si.StartType = ServiceStartMode.Automatic;
            si.Description = "MyService - I wish....";

            spi.Installers.Add(si);
            this.Installers.Add(spi);
            this.Install(saveState);
        }
    } 
```

卡在这里，因为我找不到添加可执行路径（服务图像路径）的方法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T11:13:26.243

好吧，我有以下代码工作，我只是想知道是否有更“本机”的方式来做到这一点。

```
 Command psc = new Command("New-Service");
                psc.Parameters.Add("Name", svcName);
                psc.Parameters.Add("BinaryPathName", svcExec);
                psc.Parameters.Add("DisplayName", svcName);
                psc.Parameters.Add("Description", svcDesc);
                psc.Parameters.Add("StartupType", "Automatic");
                WriteVerbose("Verifying service account");
                if (Account == null) { WriteVerbose("- Using LocalSystem account"); }
                else { psc.Parameters.Add("Credential", crd); }
                WriteVerbose("Installing service");
                Pipeline pipeline = Runspace.DefaultRunspace.CreateNestedPipeline();
                pipeline.Commands.Add(psc);
                Collection<PSObject> results = pipeline.Invoke(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T08:50:46.840

感谢[Brad Bruce](https://stackoverflow.com/users/5008/brad-bruce)，我找到了我需要的内容：[如何在不创建安装程序的情况下安装 C# Windows 服务？](https://stackoverflow.com/questions/1193424/how-do-i-install-a-c-sharp-windows-service-without-creating-an-installer)

我对 IntegratedServiceInstaller 类做了一个小调整，对“SINST.Install(state)”的调用将产生 3 行输出

```
Installing service 'ServiceName'...
Service 'ServiceName' has been successfully installed.
Creating EventLog source 'ServiceName' in log Application... 
```

调用 SINST.Uninstall(null) 时类似的行被写入控制台

我通过将输出重定向到 Stream.Null 来抑制此输出

```
 System.IO.StreamWriter sw = new System.IO.StreamWriter(Stream.Null);
    System.IO.TextWriter tmp = Console.Out;
    Console.SetOut(sw);
    try { SINST.Install(state); }
    catch (Exception Ex) { Console.SetOut(tmp); Console.WriteLine(Ex.Message); }
    finally { Console.SetOut(tmp); } 
```

# javascript - 如何为此模式/posts/:post_id 创建正则表达式？

> ID：14880673
> 
> 赞同：-1
> 
> 时间：2013-02-14T17:32:38.677
> 
> 标签：javascript

我想评估应该匹配 /post/:post_id 模式的 url 路径。

例如 /post/1 、 /post/2 、 /post/mypost 等应该匹配。

这应该是什么 reg 表达式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:40:45.017

根据`:post_id`URL 中的内容，如果它是一个数字，这样的事情可能会起作用：

```
/^\/post\/\d+$/ 
```

它基本上说 URL 必须以`/post/[0-9]+`. 如果`:post_id`有任何价值，您可以使用：

```
/^\/post\/\w+$/ 
```

这基本上说 URL 必须以`/post/[0-9A-Za-z_]+`. 您想接受的任何其他字符，您都可以添加。

要检查以某种模式开头，请使用 ^。

# php - PHP中特定类的对象集合

> ID：14880681
> 
> 赞同：3
> 
> 时间：2013-02-14T17:33:13.750
> 
> 标签：php, collections

我想要一个类似数组/对象的集合，其中元素是特定类的对象（或派生自它）。在 Java 中，我会执行以下操作：

```
private List<FooClass> FooClassBag = new ArrayList<FooClass>(); 
```

我知道这可以并且将紧密耦合我的应用程序的某些组件，但我一直想知道如何以正确的方式做到这一点。

我现在能想到的唯一方法是创建一个实现`Countable`, `IteratorAggregate`, `ArrayAccess`... 的类并强制添加一个类的元素，但这是最好的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T17:49:04.433

这是一个可能的实现，但我永远不会使用这样的结构。

```
<?php
class TypedList implements \ArrayAccess, \IteratorAggregate {
    private $type;

    private $container = array();

    public function __construct($type) {
        $this->type = $type;
    }

    public function offsetExists($offset) {
        return isset($this->container[$offset]);
    }

    public function offsetUnset($offset) {
        unset($this->container[$offset]);
    }

    public function offsetGet($offset) {
        return $this->container[$offset];
    }

    public function offsetSet($offset, $value) {
        if (!is_a($value, $this->type)) {
            throw new \UnexpectedValueException();
        }
        if (is_null($offset)) {
            $this->container[] = $value;
        } else {
            $this->container[$offset] = $value;
        }
    }

    public function getIterator() {
        return new \ArrayIterator($this->container);
    }
}

class MyClass {
    private $value;

    public function __construct($value) {
        $this->value = $value;
    }

    public function __toString() {
        return $this->value;
    }
}
class MySubClass extends MyClass {}

$class_list = new TypedList('MyClass');
$class_list[] = new MyClass('foo');
$class_list[] = new MySubClass('bar');
try {
    $class_list[] = 'baz';
} catch (\UnexpectedValueException $e) {

}
foreach ($class_list as $value) {
    echo $value . PHP_EOL;
} 
```

# magento - Magento：将产品添加到购物车后减少库存

> ID：14880684
> 
> 赞同：1
> 
> 时间：2013-02-14T17:33:26.357
> 
> 标签：magento

我为客户开发了一个 Magento 商店，她希望在产品添加到购物车后减少库存。是否有可能通过代码获得此解决方案？这是因为您将产品添加到购物车并且其他 2 位客户尝试购买您已经为自己添加（保留）的相同产品是没有意义的。

任何人都可以给我一个“代码”提示来做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:02:35.350

当您添加到购物车时，减少库存存在一些大问题。客户基本上可以来并最大化他们自己购物车中的每件商品，从而将所有这些产品锁定给该客户并使它们无法出售给其他人。仅在下订单后库存才会减少似乎很奇怪，而反过来有人可能会访问他们的购物车以发现该商品缺货，但这似乎是两害相权取其轻。

我建议与客户交谈，看看她的所作所为是否有任何影响力。

# php - 对先前查询 Zend 的行集进行查询

> ID：14880690
> 
> 赞同：0
> 
> 时间：2013-02-14T17:33:53.397
> 
> 标签：php, mysql, zend-framework, rowset

我想对 zend 选择从另一个查询返回给我的行集执行 MySQL 查询。

原因是我需要之前的“更一般”的查询，然后需要根据我想要从他们那里得到的更精确的行。

有没有办法避免向数据库发出另一个请求？

长话短说，我正在使用一个自动完成插件，它返回有关与用户输入模式匹配的不同城市的信息。这是一个挑剔的查询，我想避免每次用户更改查询的某些参数时都进行，这些参数与所讨论的城市无关。

因此，自动完成功能返回给我一个包含多个城市的行集，并且我想从中“消除”其中一些与价格范围、距离等用户选项不对应的行集。

我想尽可能地保持该行集最长，并对它执行一些过滤，而不是每次都直接向数据库请求一个新的行集。

有没有办法在该行集上执行 MySQL 查询，或者我是否必须将其转换为数组并对它们进行“手动”过滤？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T12:06:58.227

我认为您正在寻找“嵌套选择”。在 Zend_DB 中，你可以像这篇文章中那样做：

> [使用 Zend Db 进行嵌套选择](https://stackoverflow.com/questions/5604872/nested-select-using-zend-db)

如果您的项目中有 Doctrine 1.x，您可以执行以下 DQL 查询：

```
$q = new Doctrine_RawSql();
        $q->addComponent('m', 'Application_Model_Table')
        ->from('(SELECT * FROM table2 m2 WHERE ... // here is first query

        ) AS m') // IMPORTANT- name as m !
            ->orderBy('m.created ASC')
            ->limit($limit)
            ->where(' // connect tables or give 2\'nd where');
        return $q->execute(); 
```

我希望这就是你要找的

# c - 如何在 LLDB 中设置 const char* 变量

> ID：14880693
> 
> 赞同：0
> 
> 时间：2013-02-14T17:34:14.603
> 
> 标签：c, lldb

我在一个IOS项目上，我们使用objective-c。

我函数传递一些类型为 const char* 的数据。我可以在调试器中查看数据：

```
expr -- (void)printf("[%s]\n",(const char *)xml) 
```

但我想通过调试器即时更改 xml 变量的值。可以怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:06:02.060

与您相同的方式`char*`：

因为`const char *xml = "<xml></xml>";`你可以分配给 xml

`expr -- xml = "<foo></foo>"`

当然`xml`（指向你的字符串的指针）在函数范围内，所以你只改变`xml`函数指向的位置，而不是`xml`最初指向的字符串（你不能，因为你有一个指向的指针`const`）

`xml`如果声明为，这不起作用`char xml[] = "<xml></xml>";`，因为数组在 C 中是不可赋值的。

# jquery-lazyload - 如何让延迟加载插件在没有鼠标交互的情况下工作？

> ID：14880695
> 
> 赞同：2
> 
> 时间：2013-02-14T17:34:22.770
> 
> 标签：jquery-lazyload

目前，我正在使用带有无限滚动的延迟加载。当用户滚动到我的页面底部时，我会加载新的“惰性”图像，但在移动鼠标之前，惰性加载不会触发图像下载。有没有办法强制延迟加载下载图像而不是等待鼠标交互来设置视口？

[http://cl.ly/image/1s2E2t1b1t3b](http://cl.ly/image/1s2E2t1b1t3b)

我正在使用这段代码：

```
$("img.lazy").lazyload({effect : "fadeIn"}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-04T15:51:31.757

在无限滚动插件的回调中，以编程方式触发滚动事件。

```
$(window).trigger('scroll'); 
```

# java - 超级 CSV 和推土机：找不到 SurveyResponse 类

> ID：14880696
> 
> 赞同：1
> 
> 时间：2013-02-14T17:34:23.967
> 
> 标签：java, dozer, supercsv

我下载了 Super CSV 的 2.0.1 版本，并配置了一个 eclipse 项目来使用它和 Dozer bean 阅读器。我第一次尝试这个例子： http: [//supercsv.sourceforge.net/xref-test/org/supercsv/example/dozer/Reading.html](http://supercsv.sourceforge.net/xref-test/org/supercsv/example/dozer/Reading.html)

但我坚持使用 SurveyResponse 课程。在我拥有的 .jar 文件中（“super-csv-2.0.1.jar”和“super-csv-dozer-2.0.1.jar”）没有“org.supercsv.mock.dozer.SurveyResponse”，我不知道在哪里可以找到它。

这可能是一个小问题，但我需要一些帮助。

提前谢谢你，安德里亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:14:51.580

我也在 Super CSV[论坛](https://sourceforge.net/p/supercsv/discussion/718795/thread/e2f728a6/#8c9f)上回答了这个问题，但在这里复制以供参考。

该项目的所有示例都位于项目的测试中，因此它们不会包含在您可以从 Maven 或 SourceForge 获得的 jar 中。

我们确实将源代码和测试源代码发布到[网站上](http://supercsv.sourceforge.net/xref-test/index.html)——它是文档标题下的“x-ref”项目（用于“交叉引用”）。或者直接点击上面的链接就可以了！

如果您使用 Subversion，我建议您从 SourceForge 下载 Super CSV 存储库 - 然后您可以尽情享受它。该类`SurveyResponse`在推土机模块的测试类中。

但如果您不这样做，那么您可以通过单击[此处](https://sourceforge.net/p/supercsv/code/274/tree/trunk/super-csv-dozer/src/test/java/org/supercsv/mock/dozer/SurveyResponse.java)使用 Subversion Web 客户端直接下载文件。

# ios - iOS Plist 对象计数错误？

> ID：14880698
> 
> 赞同：1
> 
> 时间：2013-02-14T17:34:37.870
> 
> 标签：ios, nsmutablearray, plist

我正在`NSMutableArray`使用以下代码将几个具有 256 个对象的 .plist 文件初始化为：

```
NSMutableArray *return_list = [[NSMutableArray alloc]initWithContentsOfFile:[[NSBundle mainBundle]pathForResource:list_name ofType:@".plist"]];

NSLog(@"numitems: %d", [return_list count]); 
```

在 10 个 plist 中，此代码正确加载并计算列表中的项目数。但是，对于其中一个 plist，它始终将项目数列为 253，这非常令人困惑。

Plist edit pro 说“256 个有序对象”，内置的 Xcode plist 查看器声称相同的数字。

这里可能出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T18:00:35.003

您的属性列表文件中是否可能存在嵌套错误？文件中可能有 256 个对象，但只有 253 个是顶级对象，其他三个无意中成为其他对象之一的子对象。

如果不是这样，我会怀疑 plist 中存在格式错误。将其作为代码打开并查看原始 XML。

# c# - 仅针对解决方案中的网页的 Windows 身份验证

> ID：14880699
> 
> 赞同：0
> 
> 时间：2013-02-14T17:34:41.237
> 
> 标签：c#, asp.net, handler, windows-authentication, http-redirect

我有一个要求，比如有一个解决方案以及 4 个项目。Webapp，重新路由处理程序（将请求重定向到我的 WCF 服务），业务，数据库。我在我的 webapp 中引用其他项目，它只有 1 个网页。

现在我需要为此 Web 应用程序提供 Windows 身份验证。

如果我实施 Windows 身份验证，则来自智能设备的现有访问无法连接到路由处理程序。

所以我有几个问题，我做了一些家庭作业并发现

[在 IIS 7.5 上为使用 Windows 身份验证的 ASHX 处理程序启用 PUT](https://stackoverflow.com/questions/6695587/enabling-put-on-iis-7-5-for-an-ashx-handler-using-windows-authentication)

[如何在需要身份验证的站点中授予对使用通配符的 httpHandler 的匿名访问？](https://stackoverflow.com/questions/9978582/how-can-i-grant-anonymous-access-to-an-httphandler-that-uses-wildcards-in-a-site)

所以现在我的疑问是 1\. 我们可以绕过处理程序的身份验证吗？2\. 我们可以在不改变智能设备代理中的任何内容的情况下访问它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T11:27:22.030

所以这里没有任何人的回应。无论如何，我找到了解决方法。我想这可能对其他人有帮助。

我创建了一个只接受 Windows 凭据的登录页面。我删除了 web.config 条目以仅接受 Windows 身份验证。

对于 aspx 页面，操作正在做什么。正在检查用户的身份验证。

对于剩余的页面/处理程序，我避免了这种交叉检查，以便我的服务或下载请求处理程序可以正常工作。

# c# - Excel 2013 插件 API 是否向后兼容 Excel 2003-2010？

> ID：14880701
> 
> 赞同：9
> 
> 时间：2013-02-14T17:34:47.793
> 
> 标签：c#, visual-studio, excel, ms-office

我想知道我是否使用 vs 2012 为 Excel 2013 开发插件/插件，并且 .net 4.0 与最新 Excel 2013 版本到 2003 版本的所有版本兼容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-02T21:56:26.503

这种类型的解决方案将有效，只要

工作站机器安装了 VSTO 2010 运行时。
工作站安装了 .Net Framework 4.0 框架。
工作站安装了 Office 2007 以上版本。（2010 VSTO 运行时不针对 2003）。

它不适用于 Excel 2003。

**注释：**
工作站是指最终用户（部署）工作站。您从 API 使用的任何功能都必须存在于您希望定位的所有 Office 版本中。
因此，例如，您不能在插件中使用迷你图对象，或者如果您确实确保使用 If(application.Version > 14.0) 在代码周围放置一个 if 语句，以便它永远不会在 2003 年被调用。
还记得嵌入在您的解决方案中输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:42:33.007

使用 Visual Studio 2012 中的“Excel 2010 加载项”项目模板和其他 Office 应用程序的等效项，答案是否定的。使用“2003”和“2007”模板（使用 Visual Studio 2010 创建）创建的加载项将分别适用于 Office 2003 及更高版本以及 Office 2007 及更高版本。使用“2010”（使用 Visual Studio 2012 创建）模板创建的加载项将适用于 Office 2010 及更高版本。这些是“VSTO”样式的加载项，特定于给定版本的 Office 或更高版本。

COM 加载项使用`IDTExtensibility2`（可以使用本机或托管代码创作）可以针对受应用程序的下级版本中的 API 支持的旧版本。Visual Studio 2010 提供了“共享插件”模板，允许使用此框架开发面向 Office 应用程序的 .NET 插件。但是，我认为此项目模板类型已从 Visual Studio 2012 中删除。但是，通过一些黑客攻击，我相信可以使“Visual Studio 加载项”类型在 Office 应用程序中加载加载项，因为它们使用相同的底层`IDTExtensibility2`和相关的 COM 接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T17:40:35.607

是的，这是可能的，因为它是 COM，因此不依赖于 .Net 版本。

# ios - UIActivityViewController 不会将图像发布到 Facebook

> ID：14880702
> 
> 赞同：0
> 
> 时间：2013-02-14T17:34:48.310
> 
> 标签：ios, facebook

当我使用 UIActivityViewController 将图像发布到 Facebook 时，它会通过动作但帖子从未出现过。在 Twitter 上发布的图片可以正常工作；Facebook 上的非图片帖子可以正常工作。SLComposeViewController 同上。

令人欣慰的是：我在尝试从 Camera.app 或 Photos.app 共享照片时看到同样的问题，所以显然不只是我，而且我已经让另一个用户确认。然而，IIRC，这可能在上周起作用。

有任何想法吗？等待 Apple 或 Facebook 解决问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T17:06:16.903

截至今天早上，等待 Apple/Facebook 工作。

# matlab - dlmwrite 追加到末尾

> ID：14880703
> 
> 赞同：2
> 
> 时间：2013-02-14T17:34:48.667
> 
> 标签：matlab

我在一个文本文件中写了几行，其中有一个矩阵。我决定将 fprintf 用于普通文本消息，并使用 dlmwrite 将矩阵写入文件。但是，此操作是在 while 循环中完成的。这是大纲：

```
 k=0;

 while (k<10):

     fprintf(file,'%s', 'Hello');

     dlmwrite(file,M ,'-append', 'newline', 'pc');

     fprintf(file, '%s' , 'Goodbye');

     k= K+1; 
```

但是，当我打开文件时，所有矩阵都附加到文本文件的最后，而不是每个矩阵都在你好和再见之间。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T17:57:05.010

use this:

```
k=0;

file = fopen('exp.txt','a');
 while (k<10)

     fprintf(file,'%s', 'Hello');

     dlmwrite('exp.txt',A ,'-append', 'roffset', 1, 'delimiter', ' ')

     fprintf(file, '%s\n' , 'Goodbye');

     k= k+1;
 end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T17:57:28.673

It may have something to do with the `-append` option, that according to the help appends the result to the end of the file.

You are accessing the same file with two functions, `fprintf` and `dlmwrite`.

This is probably not efficient, but closing the file after every write from `fprintf` would work:

```
clear all
close all

file_name = 'aa.txt';
file = fopen(file_name, 'w');
fclose(file);
file = fopen(file_name, 'a');
M = randn(5);

for kk = 1:10
    file = fopen(file_name, 'a');
    fprintf(file, 'Hi\n');
    fclose(file);
    dlmwrite(file_name, M ,'-append', 'newline', 'pc');
    file = fopen(file_name, 'a');
    fprintf(file, 'Bye\n');
end 
```

If not, just try to print the matrix with other funcion that you create and that uses the same file handler as `fprintf`.

# ocr - 校正 MNIST 日期集

> ID：14880706
> 
> 赞同：3
> 
> 时间：2013-02-14T17:35:02.007
> 
> 标签：ocr, skew, mnist

我目前正在研究数字手写识别问题。我发现许多最先进的算法对 mnist 数据集采用了一些预处理方法，例如纠偏和抖动（我不知道“抖动”是什么）。我用谷歌搜索了很长时间，但没有发现任何关于可用于纠偏 mnist 日期集的具体方法或算法。有没有人对如何解决这个问题有想法？非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-11-15T10:13:45.643

我也用谷歌搜索了很长时间，也很难找到这个，但直到我看到这篇论文才成功：

> Teow、Loo-Nin 和 Kia-Fock Loe。“用于离线手写数字识别的强大的基于视觉的特征和分类方案。” 模式识别 35.11 (2002): 2355-2364。

阅读第 4.2 节。他们描述了一种**去除**图像倾斜的程序。我不确定这是否与**纠偏**相同，但这是我能找到的最接近的东西。

希望这能有所帮助，如果有人可以确认去倾斜是否**与****去歪斜**相同，我们将不胜感激。

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-08T12:40:32.057

纠偏取自 LeCun 1998 年的论文 [ [http://yann.lecun.com/exdb/publis/pdf/lecun-98.pdf]](http://yann.lecun.com/exdb/publis/pdf/lecun-98.pdf])。

> 偏斜计算像素的第二惯性矩（将前景像素计为 1，将背景像素计为 0）并通过水平移动线条来剪切图像，使主轴垂直。**

# ruby-on-rails - 如何在 Rails 的子文件夹中组织迁移文件？

> ID：14880712
> 
> 赞同：1
> 
> 时间：2013-02-14T17:35:14.367
> 
> 标签：ruby-on-rails, ruby, directory, rails-migrations

有没有办法在`db/migrate`文件夹中组织迁移文件？

因为您很快就会在此文件夹中拥有大量迁移文件，并且拥有以下内容会很棒：

*   `db/migrate/user_migrations/`
    *   `timestamp_create_users.rb`
    *   `timestamp_create_addresses.rb`

等等...

有没有一种简单的方法可以做到这一点？某种配置？这是一种不好的做法，我绝对不应该这样做吗？

如果有人对此有任何信息，我会很高兴听到的！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T17:49:34.330

目前没有办法做到这一点，也没有理由。会有一个迁移涉及多个模型和功能的情况，基于模型的分类不是很合适。

如果您已经将非常旧的迁移应用到所有系统，或者它们彼此无效（例如创建表 A 的迁移，然后随后将其删除），您也可以删除它们。

有人可能会争辩说，删除迁移可能会导致系统无法从头开始引导。但是，不应为此使用迁移。实际上，迁移仅用于更改数据库。要为空数据库加载架构，您应该使用`$ rake db:schema:load`.

# string - 如何从文本中提取/复制字符串到 DOS 批处理文件

> ID：14880713
> 
> 赞同：0
> 
> 时间：2013-02-14T17:35:14.460
> 
> 标签：string, batch-file, copy, dos

我有一个文本文件`output.txt`，内容如下：

```
**Adapter #0
Enclosure Device ID: 10
Slot Number: 16
Enclusure Device ID: 10
Slot Number: 15** 
```

如何将值“10”从机箱设备 ID 复制到下面的命令，该命令是我的批处理文件的一部分（标记为 xx）？

```
c:\megacli\megacli -CfgLdAdd -r1 [**xx**:0,**xx**:1] -a0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:40:20.343

尝试：

```
for /f "tokens=6 delims=#: " %x in (output.txt) do echo %x 
```

在批处理文件中使用时使用双符号`%`（又名`%%x`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:46:01.680

呸，你愚蠢的编辑改变了一切。你又来了。

```
for /f "tokens=4" %%I in ('find "Enclosure" output.txt') do (
    c:\megacli\megacli -CfgLdAdd -r1 [%%I:0,%%I:1] -a0
) 
```

# python - 如何让鼻子测试忽略异常？

> ID：14880715
> 
> 赞同：1
> 
> 时间：2013-02-14T17:35:33.530
> 
> 标签：python, nose

在特定情况下，我不希望我的鼻子测试报告错误并继续进行其他测试，我希望它彻底失败并显示堆栈跟踪（就像任何其他未捕获的异常一样）。我可以提出一个（可能是特定于鼻子的）异常类型来做到这一点吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-14T17:39:16.933

您可以使用参数调用鼻子测试`-x`。

```
-x, --stop
    Stop running tests after the first error or failure 
```

# php - 使用 spl_autoload_register 处理单个文件中的多个类

> ID：14880719
> 
> 赞同：0
> 
> 时间：2013-02-14T17:36:02.477
> 
> 标签：php, oop, class, nomenclature, spl-autoload-register

使用`spl_autoload_register`，可以自动加载类。让我们举一个使用两个文件的简单示例：

**索引.php**

```
<?php
    spl_autoload_extensions (".php");
    spl_autoload_register ();

    $class = new \kitchen\oven;

    var_dump ($class);
    var_dump (new kitchen\Microwave);
    var_dump (new kitchen\Oven);
?> 
```

**厨房/烤箱.php**

```
<?php
    namespace kitchen {
        class Microwave {
            private $potency;

            public function get_potency () {return $this->potency;}
            public function set_potency ($potency) {$this->potency = $potency;}
        }

        class Oven {
            private $temperature;

            public function get_temperature () {return $this->temperature;}
            public function set_temperature ($temperature) {$this->temperature = $temperature;}
        }
    }
?> 
```

运行`$ php index.php`给出以下输出：

```
object(kitchen\Oven)#1 (1) {
  ["temperature":"kitchen\Oven":private]=>
  NULL
}
object(kitchen\Microwave)#2 (1) {
  ["potency":"kitchen\Microwave":private]=>
  NULL
}
object(kitchen\Oven)#2 (1) {
  ["temperature":"kitchen\Oven":private]=>
  NULL
} 
```

一切都很好，我唯一关心的是命名法。我****必须****用该文件中任何类的相同名称提名我的文件。有什么方法可以让我使用更通用的名称吗？我希望我可以使用“kitchen/objects.php”而不是“kitchen/oven.php”。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:46:09.747

我能想到的唯一方法是将所有 PHP 文件包含在[spl-autoload-register](http://php.net/manual/en/function.spl-autoload-register.php)方法中的命名空间目录中。您的自动加载方法只会运行一次，但它可能会加载比您预期和/或需要的更多的内容。

我相信每个文件只有一个类并且文件名共享类的名称是一种很好的做法。是的，您有更多文件，但它简化了重构并使您的文件结构更易于其他开发人员使用。

# sencha-touch - 如何在 Sencha Touch 的商店中设置数据视图列表以使用子列表？

> ID：14880720
> 
> 赞同：0
> 
> 时间：2013-02-14T17:36:05.020
> 
> 标签：sencha-touch, sencha-touch-2

在我的休息服务中，我返回一个 json 模型，其中包含一个余额值和一个可枚举的语句交易列表。我需要能够将余额数字返回到我的视图，同时将可枚举项目设置为数据视图列表。

如果我使用代理并将 rootProperty 设置为我的项目列表，那么我将无法访问单个余额数字。如果我不设置，如何确保列表使用商店的交易项目属性？通常，整个商店本身都设置为数据视图列表，但我需要能够将商店中的项目子集设置为列表。

如何在 Sencha Touch 中实现这一点？

**示例 json：**

```
{
    Balance: "£430",
    Transactions: [
       { TransactionDate: "1/1/2013", Credit: 300, Debit: 0, Balance: 300 },
       { TransactionDate: "3/1/2013", Credit: 130, Debit: 0, Balance: 430 }
    ]
} 
```

我希望底层数据视图列表使用“事务”属性，同时能够访问商店外的单个余额属性，以便可以在视图内的标签上设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:46:15.480

正如您所说，您不能`store`直接申请列表，因此您必须监听商店加载事件。然后加载后，在数组中获取所需的可枚举对象并将其设置为要列出的数据。你可以试试 -

```
store.load(function(){
     store.each(function(record){
         // do stuff here
     });
}); 
```

[或者还有另一种方式，我在这里](https://stackoverflow.com/a/14800301/1211980)回答了一些同样的问题。要求有些相同。你也可以试试。

# php - 对 php 的 Ajax 调用不起作用 - 单击按钮时没有响应

> ID：14880722
> 
> 赞同：0
> 
> 时间：2013-02-14T17:36:15.577
> 
> 标签：php, javascript, ajax

我对 php 进行了以下 ajax 调用，但它不起作用。

```
 var data = ['test1','test2'];
  $(document).ready(function(){
    $(".button").click(function() {        

        $.ajax({        
            type: "POST",
            url: "getResult.php",
            data: {testData : data },
            success: function(data) { 
                alert("Data: " + data);
            } 
        });      
    return false; 
    });  
  }); 
```

PHP端 -

```
$myArray = $_REQUEST['testData'];
echo $myArray; 
```

请求希望对我有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:37:22.223

这应该可以解决问题：

```
 $myArray = $_POST['testData']; 
```

# powershell - 在 Powershell 的 ForEach-Object 循环中获取当前哈希键

> ID：14880725
> 
> 赞同：15
> 
> 时间：2013-02-14T17:36:29.883
> 
> 标签：powershell, hashtable

我有一个哈希表：

```
$myHash = @{ 
   "key1" = @{
       "Entry 1" = "one"
       "Entry 2" = "two"
   }
   "key 2" = @{
       "Entry 1" = "three"
       "Entry 2" = "four"
   }
} 
```

我正在循环获取对象：

```
$myHash.keys | ForEach-Object {
    Write-Host $_["Entry 1"]
} 
```

工作正常，但我可以用什么来确定我`$myHash`在哪个键？`$_.Name`不返回任何东西。我难住了。帮助？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-02-14T18:02:00.200

我喜欢`GetEnumerator()`在循环哈希表时使用。它会给你一个`value`带有对象的属性，以及一个`key`带有它的键/名称的属性。尝试：

```
$myHash.GetEnumerator() | % { 
    Write-Host "Current hashtable is: $($_.key)"
    Write-Host "Value of Entry 1 is: $($_.value["Entry 1"])" 
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-10-28T07:16:57.597

您也可以在没有变量的情况下执行此操作

```
@{
  'foo' = 222
  'bar' = 333
  'baz' = 444
  'qux' = 555
} | % getEnumerator | % {
  $_.key
  $_.value
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-30T08:43:32.557

这是我用来读取ini文件的类似函数。（值也是像你一样的字典）。

我转换成哈希的 ini 文件看起来像这样

```
[Section1]

key1=value1
key2=value2

[Section2]

key1=value1
key2=value2
key3=value3 
```

从 ini 哈希表看起来像这样（我将进行转换的函数传递给哈希）：

```
$Inihash = @{ 
           "Section1" = @{
               "key1" = "value1"
               "key2" = " value2"
           }
           "Section2" = @{
               "key1" = "value1"
               "key2" = "value2"
         "key3" = "value3"
           }
        } 
```

所以从哈希表中，这一行将搜索给定部分的所有键/值：

```
$Inihash.GetEnumerator() |?{$_.Key -eq "Section1"} |% {$_.Value.GetEnumerator() | %{write-host $_.Key "=" $_.Value}} 
```

`? = for search where-object equal my section name. % = you have to do 2 enumeration ! one for all the section and a second for get all the key in the section.`

# c# - 是否可以删除 TableLayoutPanel 中 2 个单元格之间的边框？

> ID：14880728
> 
> 赞同：0
> 
> 时间：2013-02-14T17:36:40.403
> 
> 标签：c#, tablelayoutpanel

我想删除 2 个单元格之间的边框，同样，如果它们位于 TableLayoutPanel 的中间，则在它们周围有一个边框。假设一个 5x5 的网格，它是单元格 (2,3) 和 (2,4) 这将如何完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:40:16.300

更改面板内控件的[ColumnSpan](http://msdn.microsoft.com/en-us/library/ms171687%28v=vs.80%29.aspx)。

# asp.net - 在编辑模式期间未填充 Gridview 中的下拉列表

> ID：14880729
> 
> 赞同：1
> 
> 时间：2013-02-14T17:36:39.403
> 
> 标签：asp.net, vb.net, gridview

我有一个ASP GridView，我想在选定的行切换到编辑模式时填充下拉列表控件。

```
<EditItemTemplate>
      <asp:DropDownList ID="ddlFormatID" runat="server">
      </asp:DropDownList> 
```

我已经用谷歌搜索了，我知道您应该在 rowdatabound 上执行此操作，然后检查该行是否是正在编辑的行，如果是，则填充 DDL，但我无法检查该行是否正常工作:(

```
 If DataControlRowState.Edit = e.Row.RowState Then

        Dim ddlFormat As DropDownList = e.Row.FindControl("ddlFormatID")
        ddlFormat.DataSource = XRefBCWorker.GetFormatCombos
        ddlFormat.DataTextField = "Format"
        ddlFormat.DataValueField = "FormatID"
        ddlFormat.DataBind()

    End If 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:44:35.650

我能够找到这篇文章，并且我在 rowdatabound 事件中更改了我的代码并且它起作用了！

```
 If e.Row.RowType = DataControlRowType.DataRow Then
        If e.Row.DataItem IsNot Nothing Then
            If (e.Row.RowState And DataControlRowState.Edit) > 0 Then
                Dim ddlFormat As DropDownList = e.Row.FindControl("ddlFormatID")
                ddlFormat.DataSource = XRefBCWorker.GetFormatCombos
                ddlFormat.DataTextField = "Format"
                ddlFormat.DataValueField = "FormatID"
                ddlFormat.DataBind()
                ddlFormat.SelectedIndex = CurrentFormatID
            End If
        End If
    End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T18:14:49.333

您可以将 DataItem 转换为您显示的类型。

```
Protected Sub GridView_RowDataBound(sender As Object, e As GridViewRowEventArgs)
    If DataControlRowState.Edit = e.Row.RowState Then
        Dim item = e.Row.DataItem
        Dim dr = DirectCast(item, DataRowView)
        Dim id = Integer.Parse(dr(0).ToString())
    End If
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-30T02:39:44.053

只需将其添加到标记中：

```
<asp:DropDownList SelectedValue='<%# Bind("categoryId") %>' 
```

# android - Android 网络应用的广告代码

> ID：14880730
> 
> 赞同：0
> 
> 时间：2013-02-14T17:36:39.593
> 
> 标签：android, cordova

我正在编写一个网络应用程序，我计划发布 Android 应用程序并通过广告将其货币化。

我很可能会使用 phonegap 将我的网络应用程序转换为 android 应用程序。

如何在我的应用程序中添加广告代码。在 google 的 android 教程中，他们展示了 Java 代码，我如何获得相同的 HTML 代码？

# gwt - gwt - 如何删除 TextBox 内部空格/填充？

> ID：14880731
> 
> 赞同：1
> 
> 时间：2013-02-14T17:36:49.810
> 
> 标签：gwt, textbox, padding, font-size

我有一个 gwt TextBox，其高度由一个变量确定：

```
aTextBox = new TextBox();
parentLayoutPanel.add(aTextBox);
parentLayoutPanel.setWidgetTopHeight(aTextBox, 0.0, Unit.PX, text_box_height, Unit.PX); 
```

`text_box_height`在页面加载之前，此变量是未知的。现在我想确保框内的字体与框的大小相匹配。目前，我正在尝试以下操作：

```
aTextBox.getElement().getStyle().setProperty("fontSize", Integer.toString(text_box_height) + "px"); 
```

不幸的是，这会导致文本上方出现空白，从而切断文本的底部：

![文本框字体](../Images/f086307f6b1efc8f0ad8628eef7a26e7.png)

如何删除此空白/填充？还是有不同的方法来调整文本在框中的大小和位置？非常感谢！

**编辑：附加信息：** 由于评论，我添加了以下图片。该行是光标标记。 ![在此处输入图像描述](../Images/1b09ac5a8a5d4c3eb23f980ce978d573.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T18:02:02.067

您可以在 TextBox 上设置填充，就像在任何元素上设置它一样。您可以使用`.getElement().getStyle()`，也可以应用 CSS 样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:28:54.477

经过更多研究，我发现文本行占用的空间是字体大小的 1.5 倍。我看不到改变那个空白的方法。我最终实际上只是将框设置为字体大小的 1.5 倍。

# oracle10g - SQL+ 中的外键内联引用问题

> ID：14880733
> 
> 赞同：0
> 
> 时间：2013-02-14T17:36:51.513
> 
> 标签：oracle10g, foreign-keys, constraints, sqlplus

当引用外键内联时，我会在以这种方式编写时收到一条错误消息：

`C_ID NUMBER(6) CONSTRAINT ORDERS_C_ID_fk FOREIGN KEY (C_ID) REFERENCES customer(C_ID),`

错误是：第 7 行的错误：ORA-02253：此处不允许约束规范

但它以这种方式工作（它应该）：

`C_ID NUMBER(6), CONSTRAINT ORDERS_C_ID_fk FOREIGN KEY (C_ID) REFERENCES customer(C_ID),`

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:01:09.817

内联引用约束不需要`FOREIGN KEY (C_ID)`. 改用这个：

```
C_ID NUMBER(6) CONSTRAINT ORDERS_C_ID_fk REFERENCES customer(C_ID) 
```

# c# - 根据变量变化对对象列表进行排序和更新

> ID：14880735
> 
> 赞同：3
> 
> 时间：2013-02-14T17:36:54.577
> 
> 标签：c#, algorithm, list, int

我正在研究一种可以解决我遇到的问题的算法，但我发现自己有点卡住了。这是场景：

我有一个对象，其中包含一个名为 order 的变量。

```
public class Item
{
     public int Order{get; set;};

     public int ID{get; set;}; // not incremented can be any value!
} 
```

所以我有一个清单：

```
List<Item> list = new List<Item>().OrderBy((o) => o.Order); 
```

并且可以随时更改订单值。因此，如果我想更改第一个项目订单值，则所有其他订单值都应相应更新，以免重复。

```
for (int i = 0; i <= list .Count - 1; i++)
{
    if (list [i].ID == inputID)
    {
        list [i].Order = inputNewPosition;
    }
    else
    {
        if (list [i].Order < inputNewPosition)
        {
            list [i].Order --;
        }
        else
        {
             list [i].Order ++;
        }
    }
} 
```

如果我将最后一个项目订单更改为第一个，这将失败，因为这会使第一个项目订单为 0！

任何人都可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T17:45:18.890

让我们看看列表中元素的四种情况（当我们遍历它们时）。如果（为了简洁起见）我们将`old`移动的项目作为其旧位置并`new`作为其新位置，我们在您的列表中为项目提供以下案例（在纸上画出以明确这一点）。

1.  当前项是要移动的：直接移动
2.  当前项目的顺序是 <`new`和 < `old`：不要移动它
3.  当前项目的顺序是 ≥`new`和 < `old`：向右移动
4.  当前项目的顺序是 ≤`new`和 > `old`：将其向左移动
5.  当前项目的顺序是 >`new`和 > `old`：不要移动它

当我们开始枚举时，我们知道要移动的项目将在哪里结束（at `new`），但我们不知道它从哪里来（`old`）。然而，当我们从列表的*开头*开始枚举时，我们知道每一步都必须在列表中更靠后，直到我们真正看到它！所以我们可以用一个标志（`seen`）来表示我们是否已经看过它。所以`seen`false 意味着 <`old`而 true 意味着 >= `old`。

```
bool seen = false;
for (int i = 0; i < items.Length; i++)
{
    if (items[i].ID == inputID)
    {
        items[i].Order = inputNewPosition;
        seen = true;
    }
} 
```

这个标志告诉我们当前项目是否 >= *old*。所以现在可以根据这些知识和上述规则开始分流。（所以`new`在上面的讨论中`inputNewPosition`，无论我们是在`old`我们用`seen`变量表示之前还是之后。）

```
bool seen;
for (int i = 0; i < items.Count; i++)
{
    if (items[i].ID == inputID) // case 1
    {
        items[i].Order = inputNewPosition;
        seen = true;
    }
    else if (seen) // cases 4 & 5
    {
        if (items[i].Order <= inputNewPosition) // case 4
        {
           items[i].Order--; // move it left
        }
    }
    else // case 2 & 3
    {
        if (items[i].Order >= inputNewPosition) // case 3
        {
            items[i].Order++; // move it right
        }            
    }
} 
```

说了这么多，在每次更改时对集合进行排序可能更简单。默认排序算法对于几乎排序的集合应该是相当简单的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T18:13:15.740

您的问题不是很清楚，但对于要求，您可能最好在包含 Order 的对象上执行一个事件，并且可能有一个可以监视它的容器对象。但是，如果是这种情况，我怀疑您可能需要重新考虑您的算法，因为这似乎是一种非常尴尬的方式来处理按顺序显示的问题。

也就是说，问题要求是什么？如果我将项目#2 的顺序切换到#5，#3 会发生什么？它会留在原处，还是应该是#6？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-14T17:23:30.277

这就是我解决问题的方法，但我认为可能有更聪明的方法......

我需要更新的对象是策略工作负载项。这些中的每一个都有一个相关的优先级。不能有具有相同优先级的策略工作负载项。因此，当用户更新优先级时，其他优先级需要相应地向上或向下移动。

这个处理程序接受一个请求对象。该请求有一个 id 和一个优先级。

```
 public class UpdatePriorityCommand
 {
     public int PolicyWorkloadItemId { get; set; }
     public int Priority { get; set; }
 } 
```

此类表示以下代码中的**请求**对象。

```
//Get the item to change priority
PolicyWorkloadItem policyItem = await _ctx.PolicyWorkloadItems
                                          .FindAsync(request.PolicyWorkloadItemId);

//Get that item's priority and assign it to oldPriority variable
int oldPriority = policyItem.Priority.Value;

//Get the direction of change. 
//-1 == moving the item up in list
//+1 == moving the item down in list
int direction = oldPriority < request.Priority ? -1 : 1;

//Get list of items to update... 
List<PolicyWorkloadItem> policyItems = await _ctx.PolicyWorkloadItems
                                                 .Where(x => x.PolicyWorkloadItemId != request.PolicyWorkloadItemId)
                                                 .ToListAsync();

//Loop through and update values
foreach(var p in policyItems)
{
    //if moving item down in list (I.E. 3 to 1) then only update
    //items that are less than the old priority. (I.E. 1 to 2 and 2 to 3)
    //items greater than the new priority need not change (i.E. 4,5,6... etc.)

    //if moving item up in list (I.E. 1 to 3)
    //items less than or equal to the new value get moved down. (I.E. 2 to 1 and 3 to 2)
    //items greater than the new priority need not change (i.E. 4,5,6... etc.)
    if(
           (direction > 0 && p.Priority < oldPriority)
        || (direction < 0 && p.Priority > oldPriority && p.Priority <= request.Priority)
      )
    {  
        p.Priority += direction;
        _ctx.PolicyWorkloadItems.Update(p);
    }       
}

//finally update the priority of the target item directly
policyItem.Priority = request.Priority;

//track changes with EF Core
_ctx.PolicyWorkloadItems.Update(policyItem);

//Persist changes to database
await _ctx.SaveChangesAsync(cancellationToken); 
```

# seo - 页面排名和垃圾邮件

> ID：14880736
> 
> 赞同：0
> 
> 时间：2013-02-14T17:36:55.337
> 
> 标签：seo, information-retrieval, pagerank

假设我们有一个连接了 4 个页面/节点的图。我们还计算了该图的 pagerank，现在我们要上传一个新页面/节点以增加其 pagerank。我想知道如果我们还上传 N 个更多的页面/节点作为我们想要增加 pagerank 的页面的中心，我们会实现我们的目标吗？（第一个图和垃圾图没有连接）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:24:54.233

有几种方法可以利用 Google 1998 年专利申请中公布的 Google pagerank。正如您所指出的，您添加到网站的每个页面都会增加您网站上可用的总页面排名。

甚至还有一种方法可以创建具有无限 pagerank 的页面：创建一个页面链，其中每个页面链接到下一个页面。将链中的每一页链接回第一页。你做这个链的时间越长，第一页的pagerank就越多。

这些算法弱点在现实世界中很难被利用。

首先，谷歌修改了最初在其专利申请中公布的算法。他们的一些更新是为了弥补这样的弱点。他们没有公布他们当前的算法或他们所做的更改列表。

其次，Google 只会抓取超过特定 pagerank 阈值的页面。这意味着 googlebot 甚至不会抓取大量仅为制造 pagerank 目的而创建的额外页面。如果 googlebot 不抓取它们，它们将不会用于 pagerank 计算。

第三，谷歌会积极惩罚它检测到的试图向其算法发送垃圾邮件的网站。这可能包括防止网站上的页面通过任何页面排名。谷歌现在非常擅长检测没有内容的生成页面，或者生成的乱码。创建具有真实内容的有用页面以放入这样的方案中付出的努力比它的价值要大。

# build - TFS DefaultTemplate.xaml 中缺少 ProcessParameterMetadata：例如，在必需类别中构建的项目在哪里

> ID：14880740
> 
> 赞同：1
> 
> 时间：2013-02-14T17:37:02.133
> 
> 标签：build, tfs, workflow-foundation

我试图弄清楚默认情况下为 TFS 中的构建提供的 Windows Workflow Foundation (WWF) 模板如何在构建定义中指定构建过程参数。

这应该通过其中的`ProcessParameterMetadataCollection`和`ProcessParameterMetadata`包含的发生。但是在 DefaultTemplate.xaml 中没有指定它们。任何地方都没有*必需*的类别或*构建*项目，其他也没有用红色圈出。见下图。

我想也许它们是在附加的工作流程中指定的，可惜我对 WWF 的了解不是很好，我找不到任何附加的工作流程。然后我想也许它们可能会在代码中指定为构建活动的一部分。我不知道，有人知道吗？

![TFS DefaultTemplate.xaml 中缺少构建过程参数](../Images/af9c13cd7bb54232e940332f84412491.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:13:51.383

当您打开构建 XAML 文件时，在底部附近有您可以单击的*Variables*、*Arguments*和*Imports链接。*如果单击*Arguments*链接，这就是它们所在的位置。如果它们没有立即出现，则意味着您超出了正确的活动范围。如果您单击构建中的不同活动，您将看到参数列表发生变化。这是一个屏幕截图： ![在此处输入图像描述](../Images/feca2f518e7d16451376f13265a3d730.png)

# android - sw600dp 和 w600dp 的区别？

> ID：14880746
> 
> 赞同：70
> 
> 时间：2013-02-14T17:37:09.357
> 
> 标签：android, layout

请用简单的方式详细说明`sw<N>dp`和之间的区别。`w<N>dp`我研究了屏幕尺寸的完整文档，但对这两个限定符**sw<>**和**w<>**感到困惑。

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2013-02-14T17:42:19.840

Android 设备屏幕是矩形的。矩形有两条边，一条比另一条短。让我们称短的 A 和长的 B。

`-swNNNdp`表示“如果 A 的长度大于或等于 NNN，则使用这些资源`dp`”

`-wNNNdp`表示“如果当前持有的设备宽度大于或等于 NNN，则使用这些资源`dp`”

当用户在纵向和横向之间旋转设备时，宽度会发生变化（为 A 或 B），但 A（最短宽度）始终相同。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-14T17:43:02.023

请查看[屏幕支持](http://developer.android.com/guide/practices/screens_support.html)

根据文件：

**SW**：屏幕的基本尺寸，由可用屏幕区域的最短尺寸表示。具体来说，设备的最小宽度是屏幕可用高度和宽度中最短的（您也可以将其视为屏幕的“最小可能宽度”）。您可以使用此限定符来确保，无论屏幕的当前方向如何，您的应用程序的 UI 至少有 dps 的宽度可用。

而**W**：指定资源应使用的最小可用宽度（以 dp 为单位）——由值定义。当屏幕的方向在横向和纵向之间切换时，系统对应的宽度值会发生变化，以反映 UI 可用的当前实际宽度。

用我的话来说：

**SW**：您的布局将在 dps 中运行的屏幕边缘之间的最小距离，因此如果您使用 layout-sw600dp/ 文件夹，则其中的所有布局仅适用于至少具有 600dp（宽度或高度）的设备

**W**：意味着您的布局将适用于任何具有 n dp 宽度的设备，无论高度如何，或者可能是当前处于横向模式的设备（在这种情况下， w 将指高度 .. 因为横向和纵向之间的方向不同）

# r - 加载数据问题

> ID：14880753
> 
> 赞同：0
> 
> 时间：2013-02-14T17:37:26.277
> 
> 标签：r, csv, upload, import-from-csv

数据链： [数据](https://www.dropbox.com/s/yt4l10nel5bwxoq/GTAP_ConsIndex.csv)

代码：

```
 ccfsisims <- read.csv(file = "F:/Purdue University/RA_Position/PhD_ResearchandDissert/PhD_Draft/GTAP-CGE/GTAP_NewAggDatabase/NewFiles/GTAP_ConsIndex.csv", header=TRUE, sep=",", na.string="NA", dec=".", strip.white=TRUE)
 ccfsirsts <- as.data.frame(ccfsisims)
 ccfsirsts[7:25] <- sapply(ccfsirsts[7:25],as.numeric)
 ccfsirsts <- droplevels(ccfsirsts)
 ccfsirsts <- transform(ccfsirsts,sres=factor(sres,levels=unique(sres)))
 ccfsirsts[1:5,] 
```

问题：

因此，如果您检查“pSVIPM”列，则数据框“ccfsirsts”中显示的值与实际保存在 .csv 文件中的值不同。上传不同的数据集时会出现此问题。

在最初的上传，即“ccfsisims”中，一切似乎都检查出来了。问题发生在之后。

关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T17:45:11.213

当您加载`ccfsisims`时`str(ccfsisims )`...（养成这样做的习惯）

你会看到这`pSVIPM`是一个因素。因此`as.numeric`，只需按照级别出现的顺序将因子更改为数字。

因为如果你看你的 csv 你`#DIV/0!`那里有字符。

自己试试：

```
> length(ccfsisims$pSVIPM[ccfsisims$pSVIPM == "#DIV/0!"])
[1] 350 
```

# php - 满足条件时跳出 if 语句和循环

> ID：14880757
> 
> 赞同：0
> 
> 时间：2013-02-14T17:37:32.163
> 
> 标签：php, mysql, pdo

我的数据库中有一个名为 ts_rounds 的表，其结构如下

```
round | current
===============
P     | 0
1     | 1
2     | 0
3     | 0
4     | 0 
```

我试图`<div>`在两种不同的条件下呼应某种安排：

1.  **当前**值为 1，其余为 0

2.  **所有电流**为0，多于**一个电流**值为1

一旦满足条件，我就想跳出 if 语句。

到目前为止，这是我的代码，第一个条件得到满足，但我无法满足第二个条件。

```
<div id="timeline">

<?php
    $sql = "SELECT * from ts_rounds";
    $result = $pdo->query($sql);
    foreach ($result as $row) 
    {
        if ($row["round"] == "P" && $row["current"] == "1") {
        echo 
            '
            <div id="r0" class="circle">
    <h3>P</h3>
    </div>
    <div id="r1" class="circle_small"><h3>1</h3></div>
    <div id="r2" class="circle_small"><h3>2</h3></div>
    <div id="r3" class="circle_small"><h3>3</h3></div>
    <div id="r4" class="circle_small"><h3>4</h3></div>
    <div id="r5" class="circle_small"><h3>A</h3></div>
    <hr id="line">
    '; 
            }
        else if ($row["round"] == "1" && $row["current"] == "1") {
        echo 
            '
            <div id="r0" class="circle_small">
    <h3>P</h3>
    </div>
    <div id="r1" class="circle"><h3>1</h3></div>
    <div id="r2" class="circle_small"><h3>2</h3></div>
    <div id="r3" class="circle_small"><h3>3</h3></div>
    <div id="r4" class="circle_small"><h3>4</h3></div>
    <div id="r5" class="circle_small"><h3>A</h3></div>
    <hr id="line">
    ';
            } 
        else if ($row["round"] == "2" && $row["current"] == "1") {
        echo 
            '
            <div id="r0" class="circle_small">
    <h3>P</h3>
    </div>
    <div id="r1" class="circle_small"><h3>1</h3></div>
    <div id="r2" class="circle"><h3>2</h3></div>
    <div id="r3" class="circle_small"><h3>3</h3></div>
    <div id="r4" class="circle_small"><h3>4</h3></div>
    <div id="r5" class="circle_small"><h3>A</h3></div>
    <hr id="line">
    '; 
            }
        else if ($row["round"] == "3" && $row["current"] == "1") {
        echo 
            '
            <div id="r0" class="circle_small">
    <h3>P</h3>
    </div>
    <div id="r1" class="circle_small"><h3>1</h3></div>
    <div id="r2" class="circle_small"><h3>2</h3></div>
    <div id="r3" class="circle"><h3>3</h3></div>
    <div id="r4" class="circle_small"><h3>4</h3></div>
    <div id="r5" class="circle_small"><h3>A</h3></div>
    <hr id="line">
    '; 
            }
        else if ($row["round"] == "4" && $row["current"] == "1") {
        echo 
            '
            <div id="r0" class="circle_small">
    <h3>P</h3>
    </div>
    <div id="r1" class="circle_small"><h3>1</h3></div>
    <div id="r2" class="circle_small"><h3>2</h3></div>
    <div id="r3" class="circle_small"><h3>3</h3></div>
    <div id="r4" class="circle"><h3>4</h3></div>
    <div id="r5" class="circle_small"><h3>A</h3></div>
    <hr id="line">
    </div>'; 
            }
        else if ($row["round"] == "A" && $row["current"] == "1") {
        echo 
            '
            <div id="r0" class="circle_small">
    <h3>P</h3>
    </div>
    <div id="r1" class="circle_small"><h3>1</h3></div>
    <div id="r2" class="circle_small"><h3>2</h3></div>
    <div id="r3" class="circle_small"><h3>3</h3></div>
    <div id="r4" class="circle_small"><h3>4</h3></div>
    <div id="r5" class="circle"><h3>A</h3></div>
    <hr id="line">
    '; 
            }
        else {
            $rounds = '
            <div id="r0" class="circle_small">
    <h3>P</h3>
    </div>
    <div id="r1" class="circle_small"><h3>1</h3></div>
    <div id="r2" class="circle_small"><h3>2</h3></div>
    <div id="r3" class="circle_small"><h3>3</h3></div>
    <div id="r4" class="circle_small"><h3>4</h3></div>
    <div id="r5" class="circle_small"><h3>A</h3></div>
    <hr id="line">
    ';
        }
    }

    ?>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:45:33.933

高度重复的代码，特别是因为您的 html 基本上只是在版本之间进行了微不足道的更改。为什么不更像

```
$sql = "SELECT current, round FROM yourtable"
$results = array()
while($row = fetch($result)) {
   $results[$row['current']][] = $row['round'];
} 
```

这会给你一个数组

```
0: p, 2, 3, 4
1: 1 
```

从那里输出逻辑只是“我现在输出哪个 0/1 值”以根据需要调整 html。无需为每个变体重复 html 块 5 次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T18:05:42.553

我想你正在寻找的是这些线上的东西：

```
$circleSize = array ('circle_small', 'circle');
$rounds = '';
foreach ($result as $row) {

    switch ($row['round']) {
        case 'P':
            $rounds .=   '<div id="r0" class="'.$circleSize[$row['current']].'"><h3>P</h3></div>';break;
        case '1':
            $rounds .=   '<div id="r1" class="'.$circleSize[$row['current']].'"><h3>1</h3></div>';break;
        case '2':
            $rounds .=   '<div id="r2" class="'.$circleSize[$row['current']].'"><h3>2</h3></div>';break;
        case '3':
            $rounds .=   '<div id="r3" class="'.$circleSize[$row['current']].'"><h3>3</h3></div>';break;
        case '4':
            $rounds .=   '<div id="r4" class="'.$circleSize[$row['current']].'"><h3>4</h3></div>';break;
        case 'A':
            $rounds .=   '<div id="r5" class="'.$circleSize[$row['current']].'"><h3>A</h3></div>';break;
    }
}
echo $rounds; 
```

# javascript - 加快基于属性修改表格单元格范围（行/列选择）

> ID：14880758
> 
> 赞同：1
> 
> 时间：2013-02-14T17:37:41.857
> 
> 标签：javascript, jquery, performance

我正在编写一个 jQuery 可用性日历，它基本上显示一个巨大的表格。有多大？过去两年、今年和未来两年的每一天都有 34 行和 1 列。我会为您计算：超过 62,000 个表格单元格。

是的，这加载有点慢，但是一旦加载，日历就完全符合我们的需要。只有一个问题：

用户需要能够选择一个单元格块。我在 UI 中设置了所有内容，以允许用户围绕一组单元格绘制一个框，选择框中的所有单元格。实际上将它们标记为“选中”的过程非常缓慢。这是我使用的循环代码：

```
while(r<=thisRow) {
            for(var c=startColumn;c<=thisColumn;c++) {
                if($(".calendar_slot[row="+r+"][column="+c+"]").attr('selectable')=='YES') {
                    if (toggleDirection==0) { $(".calendar_slot[row="+r+"][column="+c+"]").removeClass('selected'); $(".calendar_slot[row="+r+"][column="+c+"]").html(''); }
                    if (toggleDirection==1) { $(".calendar_slot[row="+r+"][column="+c+"]").addClass('selected'); $(".calendar_slot[row="+r+"][column="+c+"]").html($(".calendar_slot[row="+r+"][column="+c+"]").attr('label')); }
                }

            }
            r++;
} 
```

如您所见，我必须按列和行自定义属性的值进行选择。我无法将这些嵌入到单元格的 ID 中，因为已经有另一个进程对速度有同样的需求，并且已经使用了 ID 值。如果 ID 值包含行和列信息，则此其他功能会中断，然后需要使用自定义属性，因此会遇到与我在这里遇到的相同问题。

有没有办法加快这个选择过程？循环本身并不需要很长时间（如果我注释掉 jQuery 的东西，它运行得非常快）。所以我需要一种方法来强制 jQuery 根据自定义属性的值更快地执行这些任务。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:10:14.207

tldr; 不要试图逐列选择每个元素，尤其是选择器必须费力地搜索许多元素和相应的属性*。*

这就是我最初尝试解决它的方式：

首先，使用 jQuery选择*第一*`row = $("#calendar .calendar_slot:first")[0]`行 - 即或任何合适的。然后，使用[`nextSibling`](https://developer.mozilla.org/en-US/docs/DOM/Node.nextSibling). 当到达选择的最后一行索引时停止迭代。在行支配列的假设下，这个循环操作必须*相对较快，这就是为什么我推荐简单的 DOM 操作和“范围扫描”的原因。*（或者，这可能在 jQuery 选择器语法中使用[下一个兄弟选择器](http://api.jquery.com/next-siblings-selector/)和/或[范围选择器](http://api.jquery.com/gt-selector/)和/或`jQuery.slice`.）

对于上面迭代的每一行，使用类似于：

```
$(row).children(".calendar_slot[selectable]").each(function () {
  var colNum = +this.column
  if (colNum > x && colNum < y) {
    var col = $(this)
    // do stuff with col here: only wrapped once!
  }
} 
```

请注意，选择器每行*只执行一次；*此外它只需要查看[子元素](http://api.jquery.com/children/)。与迭代上面的行不同，“较慢”的 jQuery 在这里就足够了，因此应该是首选。

另外，考虑[jQuery Range Selectors](https://stackoverflow.com/questions/1954342/getting-a-range-of-elements-in-one-jquery-selector)；我会尝试这两种方法，看看哪些方法可以满足您的目标。范围选择器可能会完全减轻我选择上面行的建议，并且它们可能会很好地添加到列选择器并消除显式条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:42:09.567

使用临时变量来避免重复搜索，例如：

```
var $RC = $(".calendar_slot[row="+r+"][column="+c+"]") 
```

此外，如果您可以通过使用容器元素限制搜索来缩小搜索范围，它会更快：

```
 $("#container_div  .calendar_slot[row="+r+"][column="+c+"]") 
```

# php - laravel 3如何上传多个文件？

> ID：14880761
> 
> 赞同：1
> 
> 时间：2013-02-14T17:37:51.153
> 
> 标签：php, laravel, laravel-3

我想使用 laravel 3 将多个文件上传到服务器，但是如何？查看代码：

```
{{ Form::open_for_files() }}
    {{ Form::label('imgs', 'Image') }}
    <input name="imgs[]" type="file" multiple="" />

    {{ Form::label('', '') }}
    {{ Form::submit('submit', array('class' => 'submit')) }}
{{ Form::close() }} 
```

路线代码：

```
Input::upload('imgs', 'public/uploads' , 'abc.jpg'); 
```

但它不工作。请任何人帮忙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T13:18:57.853

我认为，你应该在 foreach 循环中这样做：

```
$files = Input::file();
foreach($files as $key=>$file)
{
   Input::upload("imgs[$key]", 'public/uploads' , "img_$key.jpg");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-07T00:21:19.733

这就是我在我的应用程序中所做的，（由 symfony 的 http 基金会处理）

```
foreach((array) Request::foundation()->files->get('file') as $file) {

    $file->move('save_path', 'new_name');

} 
```

上传字段的名称应为 'name="file[]"'

# dependency-injection - 构造函数注入/依赖注入 - 处理“根”类

> ID：14880762
> 
> 赞同：3
> 
> 时间：2013-02-14T17:37:51.837
> 
> 标签：dependency-injection, inversion-of-control, constructor-injection

我最近一直在使用大量的依赖注入、测试驱动开发和单元测试，并且开始喜欢它。

我在类中使用构造函数依赖项，这样我就可以注入模拟依赖项进行单元测试。

但是，当您真正想要生产环境中的对象时，最好的处理方法是什么？

你`DependencyInjectionContainer.Get<MyClass>()`在任何你想创建类的地方使用吗？还是为类创建一个空白构造函数更有意义，它通过 DI 容器解决所有依赖项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T18:11:56.847

不需要有默认构造函数。

在您的生产代码中，您通常只需`DependencyInjectionContainer.Get(someRootType)`在应用程序中调用一次即可获取根类型（例如`HomeController`MVC 中的类）。由于所有类型都是使用构造函数注入创建的，因此容器将能够为您创建相关对象的整个图。所以从生产的角度来看，没有必要拥有一个以上的构造函数。

由于在您的单元测试中您通常希望注入所有模拟对象，因此您的测试也不会使用默认构造函数。另一方面，让每个测试直接调用被测类的构造函数将很快导致代码难以维护，因为当构造函数更改时，您将不得不更改所有测试。相反，将该逻辑集中到测试类中的工厂方法中。这个工厂方法可以有多个重载，以使测试更容易创建被测类。

# exception - 经典 ASP 错误“80020009”发生异常

> ID：14880764
> 
> 赞同：6
> 
> 时间：2013-02-14T17:38:03.980
> 
> 标签：exception, asp-classic

在我正在修复的站点的代码的第 5 行，我从经典 ASP 中得到一个异常错误。下面的 ** 行是第 5 行。看起来这个功能在站点的其他页面上使用，虽然我不太清楚为什么。我试过只删除代码，但由于它在其他地方使用过，它一定很重要，所以也许我不应该尝试删除它....

```
Private Function AE(myString)
**If myString <> "" then** 
AE = Replace(myString,"`","'")
End If
End Function 
```

以下是使用 where 的示例`AE`：`response.write AE(rs("ArticleTitle"))`

提前感谢您能给我的任何帮助！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-14T18:31:03.407

这可能意味着数据库中的字段为 Null。您可以在有问题的行之前添加此行：

```
If isNull( myString ) Then Exit Function 
```

如果这不起作用，您还可以尝试将有问题的行更改为：

```
If "" & myString <> "" Then 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-06T23:33:37.700

如果您尝试访问没有记录的记录集中的记录（即，如果您在访问字段之前忘记检查 eof），也会出现此错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-01T08:16:34.493

在替换之前检查，`这在字符串中是否存在

```
if instr(mystring, "`") then
'your code
else
'your code
end if 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-02-14T18:03:12.053

使用 ASCII 字符代码而不是单引号：

```
AE = Replace(myString,"`",chr(39)) 
```

# python - pyplot.cm 实例为相同的值但不同的数据类型产生不同的结果

> ID：14880766
> 
> 赞同：0
> 
> 时间：2013-02-14T17:38:13.350
> 
> 标签：python, numpy, matplotlib

这个问题是[tcaswell](https://stackoverflow.com/users/380231/tcaswell) (answer #2) 为我的问题提供的解决方案的延续：[Is there a way to convert pyplot.imshow() object to numpy array?](https://stackoverflow.com/questions/14869321/is-there-a-way-to-convert-pyplot-imshow-object-to-numpy-array)

考虑以下python代码：

```
import pylab
import numpy as np

a = np.array( ( 30, 129 ) , dtype = np.float32 )
b = np.array( ( 30, 129 ) , dtype = np.int32 )
my_cm = pylab.cm.get_cmap('jet')
a_mapped_data = my_cm( a )
b_mapped_data = my_cm( b ) 
```

我正在使用一个小数组来节省空间，但即使使用大数组也是如此。

结果：

```
>>> a
array([  30.,  129.], dtype=float32)

>>> b
array([ 30, 129])

>>> a_mapped_data
array([[ 0.5,  0\. ,  0\. ,  1\. ],
       [ 0.5,  0\. ,  0\. ,  1\. ]])

>>> b_mapped_data
array([[ 0\.        ,  0\.        ,  1\.        ,  1\.        ],
       [ 0.5028463 ,  1\.        ,  0.46489564,  1\.        ]]) 
```

我似乎不明白这里的行为。即使值相同，实例`cm.get_map()`也会为数据类型产生不同的结果。上面的代码有问题吗？请帮忙解决这个问题。我需要绘制 numpy.float 类型的二维数组。`numpy.int32``numpy.float32`

谢谢

我在 Windows7 x64 Home Basic 上使用 python 2.7.3 32bit

* * *

**编辑：** ***为那些与我面临同样问题的人提供解决方案***

下面的脚本对输入数据执行颜色映射，并将映射按原样转换为图像，不使用`pylab.imshow`或不使用`pylab.pcolor`任何比例或边框。我感谢每个做出贡献并帮助我了解如何完成的人。

```
import pylab
import numpy as np

a = np.random.random( (512, 512) )*100
# a is a 2D array of random data not in the range of 0.0 to 1.0

# normalize the data
normed_a = ( a - a.min() )/( a.max() - a.min() )

# now create an instance of pylab.cm.get_cmap()
my_cm = pylab.cm.get_cmap('jet_r')

# create the map
mapped_a = my_cm( normed_a )

# to display the map, opencv is being used
# import opencv
import cv2 as cv

# convert mapped data to 8 bit unsigned int
mapped_au8 = (255 * mapped_a).astype('uint8')

# show the image
cv.imshow( 'a', mapped_au8 )
cv.waitKey( 0 )
cv.destroyAllWindows() 
```

* * *

**编辑：**返回类型`cm.get_cmap`实例为 RGBA 格式，但 OpenCV 默认以 BGR 格式运行。因此，在显示通过转换`cm.get_cmap()`上面代码中实例的返回值获得的任何图像之前，将其转换为 BGR 格式（*在显示图像之前，默认情况下，在 opencv 中，ALPHA 通道无论如何都会被剥离，因此除非必要，否则不要费心将其转换为 BGRA*） . 下面的代码给出了更好的解释：

```
mapped_au8 = (255 * mapped_a).astype('uint8')

#convert mapped_au8 into BGR fromat before display
mapped_u8 = cv.cvtColor( mapped_au8, cv.COLOR_RGBA2BGR )

# show the image
cv.imshow( 'a', mapped_au8 )
cv.waitKey( 0 )
cv.destroyAllWindows() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:47:55.623

从文档字符串`my_cm.__call__`：

```
*X* is either a scalar or an array (of any dimension).
If scalar, a tuple of rgba values is returned, otherwise
an array with the new shape = oldshape+(4,). If the X-values
are integers, then they are used as indices into the array.
If they are floating point, then they must be in the
interval (0.0, 1.0).
Alpha must be a scalar between 0 and 1, or None.
If bytes is False, the rgba values will be floats on a
0-1 scale; if True, they will be uint8, 0-255. 
```

请注意处理浮点数和整数的方式之间的区别。

# javascript - 防止回发与 jquery 绑定的函数

> ID：14880768
> 
> 赞同：0
> 
> 时间：2013-02-14T17:38:15.797
> 
> 标签：javascript, jquery, asp.net, postback, asp.net-4.0

当焦点位于特定文本框上时按下“Enter”键时，我正在尝试运行一些 javascript 代码。如果发生这种情况，我不希望页面回发。（但是，如果有人*单击*提交按钮，那么我希望页面像往常一样回发。）

我有一个包含以下内容的页面：

```
<script type="text/javascript">
$(function () {
    $('#txtInput').on('keyup', function (e) {
        if (e.keyCode == 13) {
            alert('enter was clicked');
            return false;
        }
    });
});
</script>

<asp:TextBox ID="txtInput" runat="server" ClientIDMode="Static"></asp:TextBox>
<asp:Button ID="btnSubmit" runat="server" OnClick="btnSubmitClick" Text="Submit" /> 
```

我一直认为这`return false;`是实现此目的的方法，但在这种情况下，它不起作用。

我还在我的javascript函数中尝试了以下内容，但无济于事。

```
$(function () {
    $('#txtInput').on('keyup', function (e) {
        if (e.keyCode == 13) {
            e.cancel = true;
            e.returnValue = false;
            alert('enter was clicked');
        }
    });
}); 
```

我的问题是：

**1\. 为什么这不起作用？**

**2.我怎样才能实现这种行为？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:00:34.140

You need to use the keypress event because it happens before the key is released and therefore it can be cancelled.

Quoting the comment:

> It might be because of the keyup event. In theory the key is already up, so the event already happened. Have you tried with **keypress** instead?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:41:44.180

刚刚对此进行了测试，它仅适用于 keydown 事件，当释放键时为时已晚：

```
$(function () {
    $('#txtInput').on('keydown', function(e) {
        if (e.which == 13) e.preventDefault();
    });
}); 
```

[**小提琴**](http://jsfiddle.net/3WAAk/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T17:49:25.990

你试过使用`e.PreventDefault()`吗？对于这种情况，您可能还需要使用`keydown`或`keypress`捕获默认事件。

```
<script type="text/javascript">
$(function () {
    $('#txtInput').on('keydown', function (e) {
        if (e.which == 13) {
            e.PreventDefault();
            alert('enter was clicked');
        }
    });
});
</script> 
```

但是，您应该知道，通过破坏键盘功能，您并没有满足可访问性标准，这可能会使某些用户感到困难。确保为仅使用键盘的用户提供导航方式。

**编辑：**由于您的问题（ASP.NET）的性质，您可能必须以不同的方式解决这个问题。

您可以 a) 看看这个问题：[取消 ASP.NET 中的默认提交按钮](https://stackoverflow.com/q/1473388/677526)或 b) 应用上面的 Javascript 解决方案，但将其应用到整个文档而不是元素。

我不建议使用第二个，因为它可能会破坏无障碍用户的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T20:07:03.287

```
function PreventEnterKeyInTextBox(){
$('#txtInput').keypress(function(evt){evt=(evt)?evt:window.event; 
if(evt.keyCode==13){
    if($.browser.msie)
         {evt.cancelBubble=true; evt.returnValue=false;}
    else{evt.preventDefault();}
 }});
}
Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(PreventEnterKeyInTextBox);
//Or $(document).ready(function(){PreventEnterKeyInTextBox();}); 
```

# ios - UIScrollView 向下滚动

> ID：14880770
> 
> 赞同：1
> 
> 时间：2013-02-14T17:38:19.147
> 
> 标签：ios, xcode, uiscrollview

我正在使用此方法向下滚动 UIscrollView：

```
CGPoint bottomOffset = CGPointMake(0, self.ScrollForComments.contentSize.height -     self.ScrollForComments.bounds.size.height);
[self.ScrollForComments setContentOffset:bottomOffset animated:YES]; 
```

重点是，如果 UIsecollView 中的内容大于滚动视图的实际大小，则一切正常，否则，如果我的内容较少，则此方法会隐藏滚动视图中的所有内容。我怎样才能阻止这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:38:15.457

如果它太短而无法滚动，你为什么要滚动它？相反，检查内容大小是否高于滚动视图大小：

```
if (self.ScrollForComments.contentSize.height > self.ScrollForComments.bounds.size.height) {
    // if it is, run your code
    CGPoint bottomOffset = CGPointMake(0, self.ScrollForComments.contentSize.height - self.ScrollForComments.bounds.size.height);
    [self.ScrollForComments setContentOffset:bottomOffset animated:YES];
} else {
    // if it is not, either do nothing or scroll to the top
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:36:34.070

您可能想检查一下`self.ScrollForComments.contentSize.height - self.ScrollForComments.bounds.size.height > 0`，如果没有，请不要打电话`setContentOffset`

# ios - OpenGL 视图的 UIImage 渲染在设备上不起作用

> ID：14880771
> 
> 赞同：2
> 
> 时间：2013-02-14T17:38:30.953
> 
> 标签：ios, opengl-es, uiimage, screenshot, device

我使用 Apple 的实现将 OpenGL 视图渲染到 UIImage：http: [//developer.apple.com/library/ios/#qa/qa1704/_index.html](http://developer.apple.com/library/ios/#qa/qa1704/_index.html)

这是在模拟器上运行的，但是当我在设备上尝试它时，它只显示一个空白图像。

我正在使用的代码是这样的：

```
// OpenGL view rendering to UIView
- (UIImage*)snapsotOfOpenGLView:(UIView*)eaglview
{
   GLint backingWidth, backingHeight;

  // Bind the color renderbuffer used to render the OpenGL ES view
  // If your application only creates a single color renderbuffer which is already bound       at this point,
  // this call is redundant, but it is needed if you're dealing with multiple renderbuffers.
  // Note, replace "_colorRenderbuffer" with the actual name of the renderbuffer object defined in your class.

  //    glBindRenderbufferOES(GL_RENDERBUFFER_OES, _colorRenderbuffer);

  // Get the size of the backing CAEAGLLayer
  glGetRenderbufferParameterivOES(GL_RENDERBUFFER_OES, GL_RENDERBUFFER_WIDTH_OES, &backingWidth);
  glGetRenderbufferParameterivOES(GL_RENDERBUFFER_OES, GL_RENDERBUFFER_HEIGHT_OES, &backingHeight);

  NSInteger x = 0, y = 0, width = backingWidth, height = backingHeight;
  NSInteger dataLength = width * height * 4;
  GLubyte *data = (GLubyte*)malloc(dataLength * sizeof(GLubyte));

  // Read pixel data from the framebuffer
  glPixelStorei(GL_PACK_ALIGNMENT, 4);
  glReadPixels(x, y, width, height, GL_RGBA, GL_UNSIGNED_BYTE, data);

  // Create a CGImage with the pixel data
  // If your OpenGL ES content is opaque, use kCGImageAlphaNoneSkipLast to ignore the  alpha channel
  // otherwise, use kCGImageAlphaPremultipliedLast
  CGDataProviderRef ref = CGDataProviderCreateWithData(NULL, data, dataLength, NULL);
  CGColorSpaceRef colorspace = CGColorSpaceCreateDeviceRGB();
  CGImageRef iref = CGImageCreate(width, height, 8, 32, width * 4, colorspace,  kCGBitmapByteOrder32Big | kCGImageAlphaPremultipliedLast,
                                ref, NULL, true, kCGRenderingIntentDefault);

  // OpenGL ES measures data in PIXELS
  // Create a graphics context with the target size measured in POINTS
  NSInteger widthInPoints, heightInPoints;
  if (NULL != UIGraphicsBeginImageContextWithOptions) {
      // On iOS 4 and later, use UIGraphicsBeginImageContextWithOptions to take the scale into consideration
      // Set the scale parameter to your OpenGL ES view's contentScaleFactor
      // so that you get a high-resolution snapshot when its value is greater than 1.0
      CGFloat scale = eaglview.contentScaleFactor;
      widthInPoints = width / scale;
      heightInPoints = height / scale;
      UIGraphicsBeginImageContextWithOptions(CGSizeMake(widthInPoints, heightInPoints), NO, scale);
  } else {
    // On iOS prior to 4, fall back to use UIGraphicsBeginImageContext
    widthInPoints = width;
    heightInPoints = height;
    UIGraphicsBeginImageContext(CGSizeMake(widthInPoints, heightInPoints));
  }

  CGContextRef cgcontext = UIGraphicsGetCurrentContext();

  // UIKit coordinate system is upside down to GL/Quartz coordinate system
  // Flip the CGImage by rendering it to the flipped bitmap context
  // The size of the destination area is measured in POINTS
  CGContextSetBlendMode(cgcontext, kCGBlendModeCopy);
  CGContextDrawImage(cgcontext, CGRectMake(0.0, 0.0, widthInPoints, heightInPoints), iref);

  // Retrieve the UIImage from the current context
  UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

  UIGraphicsEndImageContext();

  // Clean up
  free(data);
  CFRelease(ref);
  CFRelease(colorspace);
  CGImageRelease(iref);

 return image;
} 
```

有谁知道为什么会发生这种情况？

我在 XCode 4.5 和 iOS 5.1 和 6.0 模拟器上进行了尝试，它可以工作。

它不适用于 iPad2 iOS 6.0.1 和 iPhone 4S iOS 6.0.1 设备

谢谢。

# c++ - 从链表中删除数据

> ID：14880773
> 
> 赞同：0
> 
> 时间：2013-02-14T17:38:35.273
> 
> 标签：c++

我正在尝试从链接列表中删除。但如果我尝试删除第一个元素，它似乎不起作用。

```
if (found)
{
    if (prev == NULL)
    {
        prev = head;
        prev -> next = curr -> next;
        delete curr;
    }
    else
    {
        prev -> next = curr -> next;
        delete curr;
    }
}

return found; 
```

如果我要从中间或尾部的某处删除，findNode 函数会起作用。但我发现如果我从尾部删除，我必须将 next 设置为 NULL，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:43:19.793

问题*可能*是您实际上并没有将 to 更改`head`为指向列表的新头部。你必须改变`head`：

```
if (prev == NULL)
{
    head = head->next;  // Set `head` to point to the next node, i.e. the new `head`
    delete curr;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:45:39.023

假设这`findNode`是正确的并且设置`prev`为之前的节点`curr`（可能要考虑一个双向链表）然后

```
 if (prev == NULL)
   {
      prev = head;
      prev -> next = curr -> next;
      delete curr;
   } 
```

是不正确的。由于何时`prev`为 NULL，所以找到的就是头节点。

所以代码应该是

```
 if (prev == NULL)
   {
      head = head->next;
      delete curr;
   } 
```

# javascript - 从链接中删除“可点击性”（锚标记）

> ID：14880775
> 
> 赞同：3
> 
> 时间：2013-02-14T17:38:51.483
> 
> 标签：javascript, javascript-events

我有几个链接，在发送响应之前需要几秒钟来处理，所以我想实现一个指示器图标。这是我的出发点：

```
<a href="/foo"><img src="icon.png" /></a> 
```

这是一个遗留应用程序，代码已经是一团糟，所以我不介意并使用内联事件处理程序：

```
<a href="/foo"><img src="icon.png" onclick="indicate(this)" /></a> 
```

此外，没有绑定 JS 框架。我可以使用其他一些机制来应用事件处理程序，但这不会改变我要解决的问题。

由于后端处理消耗大量资源，我希望防止用户多次点击。我试图在第一次点击时删除 href 属性。看来，通过使用超时，在发送请求后会正确删除 href，但是 firefox 和 IE9 都允许我再次单击该链接。

这是指示（）函数：

```
function indicate(e) {
    if (indicator.ref.nodeName) indicateStop();

    // save state
    indicator.ref = e;
    indicator.orig.href = indicator.ref.parentNode.href;
    indicator.orig.src = indicator.ref.src;

    // replace icon
    indicator.ref.src = indicator.src;

    // remove href
    setTimeout(function(){ indicator.ref.parentNode.removeAttribute("href"); }, 20);
} 
```

所以问题是，如何通过单击链接（锚点）从链接（锚点）中删除“可点击性”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:44:19.110

使用此代码，您可以阻止锚点打开链接：

```
$('a').on('click', function(e){
  e.preventDefault();
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-14T17:48:08.873

```
<a id="indicate" href="/foo"><img src="icon.png" /></a>

document.getElementById('indicate').addEventListener('click', indicate, false);

function indicate(e) {
    e.preventDefault();
} 
```

有些人会说使用 return false，这有时很好，但并不总是最好的主意。 [event.preventDefault() 与返回 false](https://stackoverflow.com/questions/1357118/event-preventdefault-vs-return-false)

# bash - 如何使用脚本 cd 进入目录？

> ID：14880777
> 
> 赞同：2
> 
> 时间：2013-02-14T17:39:02.740
> 
> 标签：bash

例如，假设我有一个名为 tmp 的目录，并且我在主目录中

```
$pwd
/my/home/directory/
$ls
tmpdir 
```

我有一个 tmp.sh 进入“tmp”目录

```
#!/bin/bash
cd tmp 
```

我使用以下命令运行脚本：

```
$sh tmp.sh 
```

运行此脚本后，我仍在我的主目录中。

1）我想了解为什么这不能彻底工作（我只是大致知道它与独立于父进程的子进程有关（这是否正确？））和

2）我怎样才能完成这个任务（最终在脚本执行完成后脚本cd-ed的目录中）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T17:43:18.297

那是你的 shell 的工作目录。当您执行脚本时，会为您的脚本创建一个新的 shell。您正在更改其余代码的当前工作目录，而不是父 shell。

> 2）我怎样才能完成这个任务（最终在脚本执行完成后脚本cd-ed的目录中）？

为此，您可以`&&`编写脚本。因此，如果脚本成功执行，那么只有您最终进入新目录

```
./tmp.sh && cd <to_your_directory> 
```

您还应该阅读 unix.se 帖子 -[为什么 cd 不是程序？](https://unix.stackexchange.com/q/38808/17265)为了更好地理解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T17:45:21.327

简短的回答是脚本在单独的进程中运行，并且在一个进程中更改当前目录不会影响其他进程。例如设置变量也是如此（有关这可能导致的一些有趣的错误，请参见[此处](http://www.vidarholen.net/contents/blog/?p=178)）。

为了使它工作，您可以使用您的脚本`source tmp.sh`来运行脚本，就像您在提示符下键入它一样。为了更方便，您可以在 ~/.bashrc 中添加一个函数：

```
foo() { 
   cd somewhere
} 
```

或别名

```
alias foo="cd somewhere" 
```

然后，两者都将允许您在运行时`foo`（从下一次登录）到某个地方 cd。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T17:43:46.440

1) 当你运行一个 shell 脚本时，它会在一个新的 shell 实例中运行。一旦这个 shell 终止，你仍然在 shell 的旧版本中。也就是说，从外部看，shell 脚本只是一段代码。

2）没有真正好的解决方案。我会做

```
sh tmp.sh && cd /tmp 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T17:46:22.117

1) 当前工作目录 cwd 是进程状态的一部分。当 shell 脚本启动时，它是一个新进程，因此它有自己的 cwd。脚本外壳中的任何命令只会影响该进程的 cwd。

2）如果您的脚本不会产生输出，您可以让您的脚本输出您想要的目录，并拥有一个调用脚本并更改输出位置的 shell 函数/别名。就像是

```
cd `script` 
```

# python - 使用另一个字典列表中的值对字典列表进行排序

> ID：14880780
> 
> 赞同：1
> 
> 时间：2013-02-14T17:39:06.017
> 
> 标签：python

我得到了一个字典列表，并希望按另一个字典中的值对其进行排序。

这个

```
[{'fld':'a1', 'sortkey':'k2'}, {'fld':'b1', 'sortkey':'k3'}, {'fld':'c1', 'sortkey':'k1'},{'fld':'d1', 'sortkey':'k3'}] 
```

应该使用以下

```
[{'sortkey':'k1', 'value':9}, {'sortkey':'k2', 'value':10}, {'sortkey':'k3', 'value':7}] 
```

并得到以下结果

```
[ {'fld':'b1', 'sortkey':'k3'}, {'fld':'d1','sortkey':'k3'}, {'fld':'c1', 'sortkey':'k1'},{'fld':'a1', 'sortkey':'k2'} ] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T17:45:23.570

您需要将第二个列表转换为您可以实际*使用*并具有任何不错性能的东西：

```
sort_map = {d['sortkey']: d['value'] for d in secondlist}

sorted(firstlist, key=lambda d: sort_map[d['sortkey']]) 
```

这假定对于其中的每个`sortkey`值，第二个中`firstlist`都有一个匹配`sortkey`项。

这给出了：

```
>>> firstlist = [{'fld':'a1', 'sortkey':'k2'}, {'fld':'b1', 'sortkey':'k3'}, {'fld':'c1', 'sortkey':'k1'},{'fld':'d1', 'sortkey':'k3'}]
>>> secondlist = [{'sortkey':'k1', 'value':9}, {'sortkey':'k2', 'value':10}, {'sortkey':'k3', 'value':7}]
>>> sort_map = {d['sortkey']: d['value'] for d in secondlist}
>>> sorted(firstlist, key=lambda d: sort_map[d['sortkey']])
[{'fld': 'b1', 'sortkey': 'k3'}, {'fld': 'd1', 'sortkey': 'k3'}, {'fld': 'c1', 'sortkey': 'k1'}, {'fld': 'a1', 'sortkey': 'k2'}] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T17:45:14.193

为您当前的列表命名：

```
data = [{'fld':'a1', 'sortkey':'k2'}, {'fld':'b1', 'sortkey':'k3'}, {'fld':'c1', 'sortkey':'k1'},{'fld':'d1', 'sortkey':'k3'}]
sorts = [{'sortkey':'k1', 'value':9}, {'sortkey':'k2', 'value':10}, {'sortkey':'k3', 'value':7}] 
```

首先，我将转换`sorts`为以下内容：

```
{'k1': 9, 'k2': 10, 'k3': 7} 
```

您可以使用以下代码执行此操作：

```
sorts_dict = {d['sortkey']: d['value'] for d in sorts} 
```

然后，您可以使用以下方法获取最终列表：

```
result = sorted(data, key=lambda d: sorts_dict.get(d['sortkey'])) 
```

# c# - 是否可以在代码优先实体框架中忽略列映射？

> ID：14880782
> 
> 赞同：1
> 
> 时间：2013-02-14T17:39:05.920
> 
> 标签：c#, entity-framework-5

我目前正在使用 Entity Framework 连接到具有几乎相同架构的两个数据库。我从数据库中生成了包含所有表和列的代码第一类。我只是想知道是否有一种方法可以为可能丢失的列返回 null（并且不会出现映射错误）并为仍然具有该列的数据库返回一个值？我不想忽略该属性的映射，因为我想要数据库中仍然具有该列的值。

# android - 无法运行 Android 应用程序（应用程序意外停止）

> ID：14880783
> 
> 赞同：-1
> 
> 时间：2013-02-14T17:39:10.730
> 
> 标签：android, android-logcat

我正在构建 Android 音乐播放器应用程序。我完成了设计和编码，但是当我在模拟器中运行它时，它给了我以下错误：

**应用程序 Droid Player（进程 com.droid.droidplayer）意外停止。请再试一次。**

这里是源代码链接： [源代码](http://www.4shared.com/rar/DiSPXwq6/DroidPlayer.html)

源代码中没有错误，但在运行应用程序后，它在 LogCat 中显示错误：

> 02-14 20:28:49.037: E/AndroidRuntime(383): 致命异常: main
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): java.lang.RuntimeException: 无法启动活动 ComponentInfo{com.droid.droidplayer/com.droid.droidplayer.Player}: java.lang.NullPointerException
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1815)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1831)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 android.app.ActivityThread.access$500(ActivityThread.java:122)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:1024)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 android.os.Handler.dispatchMessage(Handler.java:99)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 android.os.Looper.loop(Looper.java:132)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 android.app.ActivityThread.main(ActivityThread.java:4123)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 java.lang.reflect.Method.invokeNative(Native Method)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 java.lang.reflect.Method.invoke(Method.java:491)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): at dalvik.system.NativeStart.main(Native Method)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 引起: java.lang.NullPointerException
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 com.droid.droidplayer.SongsManager.getPlayList(SongsManager.java:25)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 com.droid.droidplayer.Player.onCreate(Player.java:76)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 android.app.Activity.performCreate(Activity.java:4397)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1048)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1779)
> 
> 02-14 20:28:49.037: E/AndroidRuntime(383): ... 11 更多
> 
> 02-14 20:29:27.166: I/Process(383): 发送信号。PID：383 SIG：9

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:40:43.827

SongsManager 第 25 行的对象为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T02:33:24.037

1.  包 com.droid.droidplayer；

3.  导入java.io.File；

4.  导入 java.io.FilenameFilter；

5.  导入 java.util.ArrayList；

6.  导入 java.util.HashMap；

8.  公共类 SongsManager {

9.  // SD卡路径
10.  final String MEDIA_PATH = new String("/sdcard/");

11.  私有数组列表>歌曲列表=新数组列表>（）；

13.  // 构造函数

14.  公共 SongsManager(){

16.  }

22.  公共 ArrayList> getPlayList(){

23.  文件主页 = 新文件（MEDIA_PATH）；

25.  if (home.listFiles(new FileExtensionFilter()).length > 0) {

26.  for (文件文件: home.listFiles(new FileExtensionFilter())) {

27.  HashMap song = new HashMap();

28.  song.put("songTitle", file.getName().substring(0 (file.getName().length() - 4)));

29.  song.put("songPath", file.getPath());

31.  // 将每首歌曲添加到 SongList

32.  歌曲列表.add(歌曲);

33.  }

34.  }

35.  // 返回歌曲列表数组

36.  返回歌曲列表；

37.  }

42.  类 FileExtensionFilter 实现 FilenameFilter {

43.  公共布尔接受（文件目录，字符串名称）{

44.  return (name.endsWith(".mp3") || name.endsWith(".MP3"));

45.  }

46.  }

47.  }

# ios - 与 AFNetworking 结合使用的良好映射库？

> ID：14880785
> 
> 赞同：1
> 
> 时间：2013-02-14T17:39:12.927
> 
> 标签：ios, mapping, afnetworking

有谁知道可以与 AFNetworking 一起使用的简单的库，将 JSON 响应对象映射到我的模型对象，反之亦然？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:41:26.713

如果您谈论的是 Core Data 模型，那么还有更好的方法：AFNetworking 的制造商现在也有[AFIncrementalStore](https://github.com/AFNetworking/AFIncrementalStore)，它可以让您将 Web 服务用作 Core Data 后端。[在此处阅读更多相关信息。](http://nshipster.com/nsincrementalstore/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:41:55.260

我正在使用 NSDictionary 接收 JSON 响应，然后使用 objectForKey 来获取属性，或者您可以只使用`dict[@"AttributeName];` 以下 JSON 请求的示例代码：

```
 AFHTTPRequestOperation *op = [[AFHTTPRequestOperation alloc] initWithRequest:urlRequest];
[op setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
    NSError *jsonError = nil;
    NSDictionary *parsedData = [NSJSONSerialization JSONObjectWithData:(NSData *)responseObject options:NSJSONReadingAllowFragments error:&jsonError];

    id response = [parsedData objectForKey:@"response"];
    NSDictionary *responseDictionary = nil;
    if ([response isKindOfClass:[NSDictionary class]]) {
        responseDictionary = [NSDictionary dictionaryWithDictionary:(NSDictionary *)response];
    } else {
        dispatch_async(dispatch_get_main_queue(), ^{
        });
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-21T12:57:52.663

我正在使用 Jastor 库将 AFNetworking 的响应 (NSDictionaries) 映射到我的类。奇迹般有效。看看：[https ://github.com/elado/jastor](https://github.com/elado/jastor)

# jquery - Kendo Ui 像 windows 桌面一样可拖动

> ID：14880790
> 
> 赞同：2
> 
> 时间：2013-02-14T17:39:27.810
> 
> 标签：jquery, drag-and-drop, kendo-ui, draggable

我需要模拟一个桌面图标拖放，我这样做：

```
 $(".draggable").kendoDraggable({
                    container: $("#desktop"),
                    hint: function() {
                         return $(".draggable").clone();
                    },
                    dragend: function(e) { 
                         console.log(e);
                         console.log(e.currentTarget.attr("src"));
                         e.currentTarget.css("top",e.y.location);
                         e.currentTarget.css("left",e.x.location);
                    }                      
    }); 
```

但我不确定这是否是一个好方法，并且拖动回滚效果打破了我的解决方案。

使用 KendoUI（No Jquery UI draggable）有一个简单的方法来做到这一点。

任何帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T19:32:15.733

我过去这样做如下：

定义了以下 CSS 样式

```
.draggable {
    position: absolute;
    background: #aaaaaa;
    width: 100px;
    height: 100px;
    vertical-align: middle;
}

.ob-hide {
    display: none;
}

.ob-clone {
    background: #cccccc;
} 
```

（实际上你只需要 ob-hide）。

将可拖动对象定义为：

```
$('.draggable').kendoDraggable({
    hint     : function (original) {
        return original.clone().addClass("ob-clone");
    },
    dragstart: function (e) {
        $(e.target).addClass("ob-hide");
    }
}); 
```

将要移动的区域定义为：

```
$('body').kendoDropTarget({
    drop: function (e) {
        var pos = $(".ob-clone").offset();
        $(e.draggable.currentTarget)
                .removeClass("ob-hide")
                .offset(pos);
    }
}) 
```

我的 HTML 是：

```
<body style="padding: 0; margin: 0; ">
<div id="drop" style="position: absolute; width: 100%; height: 100%; border: 2px solid #000000">
    <div class="draggable">
        Drag 1
    </div>
    <div class="draggable">
        Drag 2
    </div>
</div>
</body> 
```

# c++ - 谷歌地图 C++ api

> ID：14880793
> 
> 赞同：0
> 
> 时间：2013-02-14T17:39:38.377
> 
> 标签：c++, google-maps

是否有 c++ api 可以在地图和卫星视图中显示谷歌地图上移动车辆的位置？输入数据将是车辆的地理坐标。我知道一个名为 GMaps.Net 的 c# api，我想知道是否也有 c++ 的 api。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-02-05T15:52:02.333

您好，如果您在哪里我会开始使用免费且非常完整的 Google Maps Control 项目，该项目将 Google Maps API 包装为 ASP.NET 自定义控件，提供了一种简单快捷的方法，可以在您的 ASP.NET 页面中使用“零”添加 Google Maps -Written-JavaScript”代码。ASP.NET Google Maps Control 包括许多功能（标记、折线、多边形、方向），并以令人愉快的 ASP.NET 编码方式为您提供几乎所有 Google Maps API 功能。您可以在此地址的 Nuget 上找到并下载控件

PM>Install-Package GoogleMapControl

# java - Windows 7/8 和 OS X 上的 Emacs SmartCompile for Java

> ID：14880800
> 
> 赞同：1
> 
> 时间：2013-02-14T17:40:17.310
> 
> 标签：java, windows, osx-mountain-lion, emacs24

我已经开始使用 SmartCompile 来编译 Java 程序并在 emacs 中运行它们。以下代码行应该在成功编译 Java 程序后编译和运行它们。

```
(add-to-list 'smart-compile-alist '("\\.java$" . "javac %f" && "java %n")) 
```

但是，如果我在 Windows 和 OS X 中尝试以下命令：

```
(add-to-list 'smart-compile-alist '("\\.java$" . "javac %f" && "java %n")) 
```

编译后不运行程序。

每次启动 Emacs 时，我都会收到`invalid read syntax: . in wrong context`错误消息。我真的不确定发生了什么。

我正在使用 Emacs 24，不确定是否相关。

正如您可能看到的那样，我是 Emacs 的菜鸟，所以如果有人能逐步告诉我如何修复此错误或指出我可以找到解决方案的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:41:20.137

在弄乱代码后修复它。这真的是我自己的愚蠢。对Elisp了解不多。如果我想更频繁地使用 Emacs 的强大功能，也许我应该学习它。

下面是代码的样子：

```
(add-to-list 'smart-compile-alist '("\\.java$" . "javac %f && java %n")) 
```

这适用于 Windows 和 OS X。

# jquery - FancyBox 和 Youtube API 事件

> ID：14880803
> 
> 赞同：1
> 
> 时间：2013-02-14T17:40:21.200
> 
> 标签：jquery, fancybox, youtube-api, fancybox-2, auto-close

一旦我在我的幻想箱中播放的 youtube 视频结束，我就会尝试触发一个事件。

所以一旦视频结束，我可以自动关闭fancybox。

我有最后一个 fancybox 版本，我在 youtube API 上，坚持使用示例，但似乎 ytplayer 对象是“未定义的”，我无法使其正常工作。

我在互联网上阅读了很多东西，包括这个，这似乎很好：[当 youtube 视频 id 完成时，如何让 fancybox 自动关闭？](https://stackoverflow.com/questions/7541890/how-make-fancybox-auto-close-when-youtube-video-id-done)

这是我正在使用的代码：[JsFiddle](http://jsfiddle.net/xn4FB/)

```
$(".fancybox").fancybox({
    'openEffect'  : 'none',
    'closeEffect' : 'none',
    'overlayOpacity' : 0.7,
    'helpers' : {
        media : {}
    },
    'afterLoad' :   function() {
        function onYouTubePlayerReady(playerId) {
            //alert(playerId);
            //alert(document.getElementById("myytplayer"));
            ytplayer = document.getElementById("myytplayer");
            ytplayer.addEventListener("onStateChange", "onytplayerStateChange");
        }

        function onytplayerStateChange(newState) {
            //alert("Player's new state: " + newState);
            if (newState == 0){
                $.fancybox.close(true);
            }
        }
    }
});

// Launch fancyBox on first element
$(".fancybox").eq(0).trigger('click'); 
```

如果有人让这个工作，那就太棒了！我只是在完成后关闭fancybox的视频！

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:17:58.967

请参阅以下工作代码（您应该使用 fancybox 的第 2 版。）

**jsfiddle**：http: [//jsfiddle.net/c5h9U/2/](http://jsfiddle.net/c5h9U/2/)

```
// Fires whenever a player has finished loading
function onPlayerReady(event) {
    event.target.playVideo();
}

// Fires when the player's state changes.
function onPlayerStateChange(event) {
    // Go to the next video after the current one is finished playing
    if (event.data === 0) {
        $.fancybox.close();
    }
}

// The API will call this function when the page has finished downloading the JavaScript for the player API
function onYouTubePlayerAPIReady() {

    // Initialise the fancyBox after the DOM is loaded
    $(document).ready(function() {
        $(".fancybox")
            .attr('rel', 'gallery')
            .fancybox({
                openEffect  : 'none',
                closeEffect : 'none',
                nextEffect  : 'none',
                prevEffect  : 'none',
                padding     : 0,
                margin      : 50,
                beforeShow  : function() {
                    // Find the iframe ID
                    var id = $.fancybox.inner.find('iframe').attr('id');

                    // Create video player object and add event listeners
                    var player = new YT.Player(id, {
                        events: {
                            'onReady': onPlayerReady,
                            'onStateChange': onPlayerStateChange
                        }
                    });
                }
            });
    // Launch fancyBox on first element
    $(".fancybox").eq(0).trigger('click');
    });

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-09T19:42:59.347

可能的原因：

*   “本地”测试（不通过 [h​​ttp://localhost](http://localhost)加载文件）
*   将 Embed API（在其中声明 iframe）与 iframe API（在其中声明 DIV 并加载一些 JS）混合。这些事件似乎只适用于后者。
*   DIV 上的 ID 与新 YT.Player(...) 调用上的 ID 不匹配

# php - 原则 1 在 CodeIgniter 2 上没有正确返回数据数组

> ID：14880804
> 
> 赞同：1
> 
> 时间：2013-02-14T17:40:32.977
> 
> 标签：php, codeigniter, doctrine

当我获得一张桌子的数据时，我遇到了一些麻烦。

我正在使用 Doctrine 1 + Codeigniter，问题是数据只获得最后一个注册表。

我没有定义这些表（OpModelos 和 AnSimNavTrans）之间的任何关系，这就是风景：

控制器：

```
class Modelos extends CI_Controller {

    public function view($idModelo) {
        $aData['site_description'] = 'AutoDato';
        $aData['site_keywords'] = 'keywords';
        $aData['site_robots'] = 'robots';
        $aData['site_author'] = 'author';

        $modelo = Doctrine::getTable('OpModelo')->find($idModelo);
        $modelo_caract = Doctrine::getTable('anCaractUserMo')->getByModeloId($idModelo);
        $modelos_similares_nav = Doctrine::getTable('OpModelo')->getModeloSimNav($idModelo);

        $aData['modelo'] = $modelo;
        $aData['modelo_caract'] = $modelo_caract;
        $aData['modelos_similares_nav'] = $modelos_similares_nav;

        $aData['view'] = 'modelo/view';

        $this->load->view('template', $aData);
    }
} 
```

数据表 AnSimNavTrans

```
op_modelo_id  cod_mod med_sim
    1           10      0.9
    1           2       0.8
    1           11      0.7
    1           4       0.5
    1           6       0.1 
```

模型

```
class OpModeloTable extends Doctrine_Table {

    public function getModeloSimNav($idModelo) {
        $query = Doctrine_Query::create();
        $query->from('AnSimNavTrans');
        $query->where('op_modelo_id = ?', $idModelo);
        $query->orderBy('med_sim DESC');
        $query->limit('3');

        $result = $query->execute();

        return $result->toArray();
    }
} 
```

看法：

```
print_r($modelos_similares_nav);

Array ( [0] => Array ( [op_modelo_id] => 1 [cod_mod] => 11 [med_sim] => 0.7 ) ) 
```

正如您在视图中看到的，当我得到查询的数组时，这只显示最后一条记录。

这有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T09:01:52.753

**第一的：**

`OpModeloTable->getModeloSimNav`对 .进行查询对我来说很奇怪`AnSimNavTrans`。为什么不用`AnSimNavTransTable`这样做呢？

**第二：**

如果你想要一个数组，请使用数组而不是使用`toArray`：

```
$result = $query->execute(array(), Doctrine_Core::HYDRATE_ARRAY);. 
```

用最后一件事进行测试。我不知道为什么当您的解决方案不起作用时这种方式有效。查看代码时，toArray 注释的函数说：

> 模仿 $query->execute(array(), Doctrine_Core::HYDRATE_ARRAY); 的结果

所以，也许最好不要模仿这个功能，而是实际使用它..

顺便说一句，像我告诉你的那样使用保湿比使用`toArray`. 使用数组水合背后的想法是，学说不会水合对象（和所有依赖项）。这将在加载页面时为您节省**大量时间。**

使用时`toArray`，您将与对象水合，然后将其转换为数组。你浪费了很多时间。

这是修复性能问题的第一步。

# extjs4 - 获取 controle win Extjs Controller 参考的最佳方式

> ID：14880806
> 
> 赞同：1
> 
> 时间：2013-02-14T17:40:37.523
> 
> 标签：extjs4

我正在寻找一种使用 extjs refs 系统在我的窗口中引用两个控件的好方法。

这是我的视图代码：

```
Ext.define('App.view.Filter',{
extend: 'Ext.window.Window',
alias: 'widget.myfilter',
items: [
    {
        xtype: 'container',
        items: [
            {
                xtype: 'combobox'
            },
            {
                xtype: 'textfield'
            },
            {
                xtype: 'button',
                text: 'Search',
                action: 'search'
            }

        ]
    }
] 
```

});

我想访问组合框和文本字段。我第一次尝试这样做：

```
refs: [
    {
        ref: 'combo',
        selector: 'myfilter combobox:first'
    },
    {
        ref: 'filter',
        selector: 'myfilter textfield:first'
    }
], 
```

但是“过滤器”也得到了组合框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T18:29:41.940

将 itemId 属性添加到您的项目：

```
items: [
        {
            xtype: 'combobox',
            itemId: 'myCombobox'
        },
        {
            xtype: 'textfield',
            itemId: 'myTextfield'
        },
        {
            xtype: 'button',
            text: 'Search',
            action: 'search'
        }

    ] 
```

然后你可以像这样引用它们：

```
refs: [
{
    ref: 'combo',
    selector: 'myfilter #myCombobox'
},
{
    ref: 'filter',
    selector: 'myfilter #myTextfield'
}
], 
```

您的“过滤器”引用也获得了组合框，因为组合框类继承自文本字段，这就是为什么使用 itemId 属性通常更好的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:51:47.410

或者，

```
Ext.define('App.view.Filter',{
    extend: 'Ext.window.Window',
    alias: 'widget.myfilter',
    items: [{
        xtype: 'combobox',
        itemId: 'myCombobox'
    },{
        xtype: 'textfield',
        itemId: 'myTextfield'
    }]
});

window1 = Ext.create('App.view.Filter').show();
window2 = Ext.create('App.view.Filter').show();

window1.down('#myCombobox'); 
```

这样您就可以从您感兴趣的特定窗口中获取组件。查看文档以[获取](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.container.AbstractContainer-method-down)更多信息。

# c++ - 如何在静态库项目中添加 main 方法？

> ID：14880808
> 
> 赞同：2
> 
> 时间：2013-02-14T17:40:40.160
> 
> 标签：c++, xcode, xcode4.3

我在 XCode 中有一个构建静态库的 C++ 项目。我想在项目中添加一个 main 方法，以允许我测试库中的一些代码。

为了尝试做到这一点，我首先复制了项目的目标，然后向第二个目标添加了一个 main 方法（根据[这个答案](https://stackoverflow.com/a/3321390/765287)）。但是，当我构建并运行这个新目标时，我的 main 方法没有执行。

有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T17:45:06.050

测试库的典型方法是编写一段单独的代码来运行库，并将结果与​​预期结果进行比较。

在这种情况下，`main`将进入测试程序，而不是库。在图书馆里有一个`main`不是正确的事情，如果用户忘记提供一个图书馆的用户会导致非常奇怪的问题`main`......

# java - 对 Java 脚本对象文字进行排序

> ID：14880813
> 
> 赞同：0
> 
> 时间：2013-02-14T17:40:50.970
> 
> 标签：java, json, sorting

我继承了一个项目，该项目使用 JSON 来执行由每个对象字面量表示的一系列操作。我对 JSON 的经验为零，虽然符号很简单，但我发现使用对象文字的情况不太好。

考虑以下文件：

```
[{
    "Name": "Hingle McCringleberry",
    "ID": "4"
},
{
    "Name": "Scoish Velociraptor Maloish",
    "ID": "1"
},
{
    "Name": "DGlester Hardunkichud",
    "ID": "3"
}] 
```

使用 Java，我想按 ID 对它们进行排序。我看到[这个线程](https://stackoverflow.com/questions/6238830/sort-a-json-file-with-2-entries)谈论实现 JavaScript 排序方法，但我不确定如何在实践中执行此操作。我正在使用[JsonFactory](http://jackson.codehaus.org/1.0.1/javadoc/org/codehaus/jackson/JsonFactory.html)和[JsonParser](http://jackson.codehaus.org/1.1.2/javadoc/org/codehaus/jackson/JsonParser.html)来读取和迭代文件，但我需要先对它们进行排序，然后才能处理它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:53:29.337

由于您使用杰克逊来解析这些，我假设您必须将它们解析为具有 ID 和名称的某种对象的[列表。](http://docs.oracle.com/javase/6/docs/api/java/util/List.html)如果是这种情况，只需编写一个标准[Comparator](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)。例如：

**命名对象.java：**

```
public class NamedObject {
    // I'm using public fields instead of getters/setters for brevity,
    // since this is just sample code.

    @JsonProperty("ID")
    public int id;

    @JsonProperty("Name")
    public String name;
} 
```

**NamedObjectIdComparator.java：**

```
public class NamedObjectIdComparator implements Comparator<NamedObject> {
    public int compare(NamedObject object1, NamedObject object2) {
        return object1.id - object2.id;
    }
} 
```

然后，对对象列表进行排序：

```
List<NamedObject> objects = // parse using JsonParser
Collections.sort(objects, new NamedObjectIdComparator()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:54:03.953

我对杰克逊库了解不多，但我确信杰克逊可以将 JSON 转换为 Java对象（我猜`List`有些方法调用）。`readValueXXX`

一旦我们得到一个 Java `List`，**[Collections.sort](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#sort%28java.util.List,%20java.util.Comparator%29)**就可以进行排序。

# c# - 如何从 XMLNodeList 打印节点

> ID：14880814
> 
> 赞同：3
> 
> 时间：2013-02-14T17:40:54.003
> 
> 标签：c#

我是 C# 编程的新手。我正在尝试解析 XML 文档并在控制台上打印值。我的程序编译没有错误，但我没有得到想要的结果。

这是代码。

```
XmlDocument doc = new XmlDocument();
doc.Load("C:\\Users\\hsyed\\Documents\\XMLParser\\Example.xml");
XmlNamespaceManager nsmgr = new XmlNamespaceManager(doc.NameTable);
nsmgr.AddNamespace("ab", "Identifier");
XmlNodeList node = doc.SelectNodes("//root/ab:Identity/Refrences/Reference/Value/text()", nsmgr);

String s= node.ToString();
System.Console.WriteLine(s);

Console.Read(); 
```

XML 文件

```
 <Attributes>

        <Attribute Name="StudentFirstName" Tag="B"/>

    </Attributes>
</Metadata>
<Identities>
<Identity Identifier="00002C8DGPDDTZ5D" CDate="2013-02-07">
    <References>
        <Reference>
            <Value>A^S2513.268898|B^JOHN</Value>
            <Traces/>
        </Reference>
        <Reference>
            <Value>A^S2613.269022|B^JOHN</Value>
            <Traces/>
        </Reference>
    </References>
</Identity>
<Identity Identifier="000388MRUO7TRSBH" CDate="2013-02-07">
    <References>
        <Reference>
            <Value>A^S2513.285402|B^Doe</Value>
            <Traces/>
        </Reference>
        <Reference>
            <Value>A^S2613.285476|B^Doe</Value>
            <Traces/>
        </Reference>
    </References>
</Identity> 
```

我想在值字段中获取信息。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T18:45:23.487

使用您的示例：

```
XmlDocument doc = new XmlDocument(); 
doc.Load("C:\\Users\\hsyed\\Documents\\XMLParser\\Example.xml");

XmlNodeList nodes = doc.SelectNodes("//root/Identities/Identity/Refrences/Reference/Value/text()");

foreach (XmlNode xn in nodes)
{
    Console.WriteLine(xn.Value.ToString());
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T20:45:18.260

这是在 LINQ 上搭载的替代方案：

```
XmlDocument doc = new XmlDocument(); 
doc.Load("whatever path to xml");

var nodes = doc
    .SelectNodes("xpath query goes here")
    .Cast<XmlNode>()
    // optionally, convert to a list
    .ToList();

// Outputs something like: 
//   System.Collection.Generic.List`1[[System.Xml.XmlNode, ...]]
Console.WriteLine(nodes.GetType().FullName); 
```

# javascript - Javascript层次结构/树创建者

> ID：14880817
> 
> 赞同：15
> 
> 时间：2013-02-14T17:40:59.277
> 
> 标签：javascript, jquery, html, css

有谁知道将完成以下任务的 javascript 或 css 层次结构插件：

```
Root
|  |
|  |
M1  M2
|  |
\  /
  E 
```

基本上会这样做的一个，从根开始，分支到两个或更多节点，以及节点可以在下面的子元素上相遇的可能性。

谢谢

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-14T17:45:00.560

你可能只需要扭转这个.. [CSS3 家谱](http://thecodeplayer.com/walkthrough/css3-family-tree)

否则，您可以使用 Canvas 绘制所需的树结构

或者您可以使用[jsPlumb 库](https://github.com/sporritt/jsPlumb)。在此处查看一些[示例](https://jsplumbtoolkit.com/demos.html)

还[可以查看 JavaScript InfoVis Toolkit](http://philogb.github.com/jit/demos.html)和[GoJS](http://gojs.net/)库。

还结帐[D3 库](https://github.com/mbostock/d3/wiki/Hierarchy-Layout)。[演示](http://bl.ocks.org/mbostock/4339083)1 ,[演示](http://bl.ocks.org/mbostock/4339184)2 ,[演示 3](http://bl.ocks.org/mbostock/2966094)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T16:27:22.370

最终使用了我们最初的想法，并使用了[http://astuteo.com/slickmap/](http://astuteo.com/slickmap/)，它制作了一些漂亮的层次结构树。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-04T09:22:59.513

您可以使用此高级图表生成器。此[演示](https://js.syncfusion.com/demos/jquery/dashboard/diagrambuilder/default.html)用于同步融合。创建所有类型的工作流程并具有像 Windows 应用程序这样的高级工具栏。

# ruby-on-rails - 根据 Sunspot Solr 上的语言环境进行搜索

> ID：14880818
> 
> 赞同：1
> 
> 时间：2013-02-14T17:41:04.837
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, solr, sunspot

我正在使用以下方法对我的应用程序上的模型进行国际化：

```
class GenreLocalization < ActiveRecord::Base
  attr_accessible :genre_id, :name, :locale
end

class Genre < ActiveRecord::Base
  has_many :genre_localizations, :dependent => :destroy

  def name(locale = nil)
    locale ||= I18n.locale
    genre_localizations.find_by_locale(locale).name
  end
end 
```

如果我调用`genre.name`它将返回当前语言环境中流派的名称。

现在我想`sunspot solr`根据语言环境索引这个模型。我的想法是为每一行存储`id`,`localized_name`和的组合。`locale`这样我就可以通过这种方式搜索流派：

```
search = Genre.search do
  keywords params[:search]
  with(:locale, 'en')
end 
```

到目前为止，我最好的方法是：

```
searchable do
  Language.supported_locales.each do |locale|
    integer :id, :stored => true
    text    :name, :stored => true, :using => :name(locale)
    string  :locale
  end
end 
```

但是该行`text :name, :stored => true, :using => :name(locale)`（显然）无效，我一直在努力寻找一种方法来索引本地化名称。

有没有办法做到这一点？这甚至是获得本地化搜索的正确方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:27:13.493

如果这不是一组固定的流派，并且您将翻译存储在该表中，那么只需为每个语言环境创建一个单独的索引字段

```
searchable do
  integer :id, :stored => true
  Language.supported_locales.each do |locale|
    text :"name_in_#{locale}", :stored => true do
      name(locale)
    end
  end
end 
```

然后限制对本地化名称字段的搜索

```
search = Genre.search do
  keywords params[:search] do
     fields(:"name_in_#{current_locale}")
  end
end 
```

# android - 方向更改时的类强制转换异常（Android）

> ID：14880819
> 
> 赞同：10
> 
> 时间：2013-02-14T17:41:06.613
> 
> 标签：android

我有一个由选项卡活动托管的活动。当我更改屏幕方向时，我的应用程序崩溃。

```
02-14 21:01:35.825: E/AndroidRuntime(9424): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.testapp/com.example.testapp.MainActivity}
java.lang.ClassCastException: android.view.AbsSavedState$1 cannot be cast to android.widget.AbsListView$SavedState
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2194)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2229)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:3791)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.app.ActivityThread.access$700(ActivityThread.java:139)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1265)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.os.Looper.loop(Looper.java:154)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.app.ActivityThread.main(ActivityThread.java:4945)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at java.lang.reflect.Method.invokeNative(Native Method)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at java.lang.reflect.Method.invoke(Method.java:511)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at dalvik.system.NativeStart.main(Native Method)
02-14 21:01:35.825: E/AndroidRuntime(9424): Caused by: java.lang.ClassCastException: android.view.AbsSavedState$1 cannot be cast to android.widget.AbsListView$SavedState
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.widget.AbsListView.onRestoreInstanceState(AbsListView.java:1596)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.view.View.dispatchRestoreInstanceState(View.java:9977)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.view.ViewGroup.dispatchThawSelfOnly(ViewGroup.java:2346)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.widget.AdapterView.dispatchRestoreInstanceState(AdapterView.java:778)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.view.ViewGroup.dispatchRestoreInstanceState(ViewGroup.java:2332)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.view.ViewGroup.dispatchRestoreInstanceState(ViewGroup.java:2332)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.view.ViewGroup.dispatchRestoreInstanceState(ViewGroup.java:2332)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.view.ViewGroup.dispatchRestoreInstanceState(ViewGroup.java:2332)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.view.ViewGroup.dispatchRestoreInstanceState(ViewGroup.java:2332)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.view.ViewGroup.dispatchRestoreInstanceState(ViewGroup.java:2332)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.view.ViewGroup.dispatchRestoreInstanceState(ViewGroup.java:2332)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.view.ViewGroup.dispatchRestoreInstanceState(ViewGroup.java:2332)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.view.ViewGroup.dispatchRestoreInstanceState(ViewGroup.java:2332)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.view.View.restoreHierarchyState(View.java:9955)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at com.android.internal.policy.impl.PhoneWindow.restoreHierarchyState(PhoneWindow.java:1671)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.app.Activity.onRestoreInstanceState(Activity.java:939)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.app.TabActivity.onRestoreInstanceState(TabActivity.java:84)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.app.Activity.performRestoreInstanceState(Activity.java:911)
02-14 21:01:35.825: E/AndroidRuntime(9424):     at android.app.Instrumentation.callActivityOnRestoreInstanceState(Instrumentation.java:1132)
   02-14 21:01:35.825: E/AndroidRuntime(9424):  at    android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2172)
  02-14 21:01:35.825: E/AndroidRuntime(9424):   ... 12 more 
```

清单中的这一行没有帮助：

```
android:configChanges="orientation|keyboardHidden" 
```

还有一件事：在我的活动中，我使用来自[https://github.com/dinocore1/DevsmartLib-Android的自定义视图（水平 ListView）](https://github.com/dinocore1/DevsmartLib-Android)

没有此自定义视图，该应用程序运行良好，但我需要使用它。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-15T12:37:54.723

> 不幸的是，我没有足够的声誉来发布图片。

XML 文件不是图像，布局是 XML 文件。

> 我发现如果我从第一个选项卡中删除 listview 或从第二个选项卡中删除 Horizo​​ntalListView，我可以毫无问题地更改方向

加上您的症状，这表明您将这两个小部件命名为相同的`android:id`值。那是行不通的，因为他们保存的状态不一样。要么使它们成为同一类，要么将它们命名为不同的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:54:20.173

注意 CommonsWare 所说的话，他是个读心者 :)

* * *

我只是把这个留在这里存档。

照此办理：

android.view.AbsSavedState$1 不能转换为 android.widget.AbsListView$SavedState

1.  检查您的导入以查看您是否使用了正确的类
2.  在转换前做一个 instanceof 检查
3.  粘贴java代码

# javascript - 将 Datepicker 用于 jquery

> ID：14880825
> 
> 赞同：0
> 
> 时间：2013-02-14T17:41:36.093
> 
> 标签：javascript, jquery, ruby-on-rails

我正在尝试使用 datepicker 进行日期选择，然后使用此日期进行查询。我有一个运动表，即使我选择一个带有条目的日期，结果也始终为 0。

我该如何解决？

```
<html lang="en">
<head>
<meta charset="utf-8" />
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.0/themes/base/jquery-ui.css" />
<script src="http://code.jquery.com/jquery-1.8.3.js"></script>
<script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script>
<link rel="stylesheet" href="/resources/demos/style.css" />
<script>
$(function() {
                $( "#datepicker" ).datepicker();
             });
</script>
</head>
<body>
<p>Date: <input type="text" id="datepicker" /> 
<p id="result"> Turnover: </p>
    <script>
    $("input").change(function(){
        var currentDate = $( "#datepicker" ).datepicker( "getDate" );
        document.getElementById("result").innerHTML= <%= Movement.where(:movementDate =>("currentDate")).sum("turnover")%>;
    });
    </script>
</p>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:36:25.380

对不起，但这都是错误的。

您需要通过 ajax 将日期发送到您的服务器，以便它可以使用给定日期执行查询，然后将结果发送回前端。

如果你有，去这里看看 jQuery 和 ajax 请求：[http ://api.jquery.com/category/ajax/](http://api.jquery.com/category/ajax/)

# c# - 从/向xml读取/写入换行符

> ID：14880827
> 
> 赞同：-1
> 
> 时间：2013-02-14T17:41:39.240
> 
> 标签：c#, xml, c#-4.0

我使用 xml 文件来存储一些键/值数据：

```
<Resource Key="A1" Value="Some text" /> 
```

我遇到的问题是，如果它是多行文本，我将如何在 Value 中保存/加载数据？

```
<Resource Key="A2" Value="Some text\nin two lines" /> 
```

这应该在显示时导致

```
Some text
in two lines 
```

如果我阅读以上资源使用

```
XDocument document = XDocument.Load(filePath);

// get all the localized client resource strings
var resource = (from r in document.Descendants("Resource")
                          where r.Attribute("Key").Value == "A2"
                          select r).SingleOrDefault(); 
```

它会用双反斜杠读取它：

```
Some text\\nin two lines. 
```

那么，如何读取/保存换行符是一些文本，例如，以后可以在 WPF 应用程序或 Web 应用程序中显示？

**编辑**：这是一个示例（正确写入，错误读取）：

```
<!-- WPF window xaml code -->
<Grid>
  <Button Name="btn" Content="Click me" />
</Grid>

// WPF window code behind
public MainWindow()
{
    InitializeComponent();

    XDocument doc =
          new XDocument(
            new XElement("Resources",
              new XElement("Resource", new XAttribute("Key", "A1"), new XAttribute("Value", @"Some text\nin two lines")))
          );

    const string fileName = @"D:\test.xml";
    doc.Save(fileName);

    doc = XDocument.Load(fileName);

    IDictionary<string, string> keys = (from c in doc.Descendants("Resource")
                                        select c).ToDictionary(c => c.Attribute("Key").Value, c => c.Attribute("Value").Value);

    btn.ToolTip = keys["A1"];
    //btn.ToolTip = "Some text\nin two lines"; // if you uncomment this line, it works as expected
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T18:52:20.340

取消转义字符串有效

```
btn.ToolTip = System.Text.RegularExpressions.Regex.Unescape(keys["A1"]); 
```

如果有人知道如何在从 xml 读取时避免转义（按原样不转义地读取它），我会很高兴听到它。

# java - 如何只允许一定数量的单词？

> ID：14880829
> 
> 赞同：1
> 
> 时间：2013-02-14T17:41:44.720
> 
> 标签：java

假设我有一个扫描仪，并且用户向该扫描仪添加了两个单词。

第一个单词之前不应有空格。

两个词之间只有一个空格。

第二个单词后没有空格。

IE

```
'hello world' is correct 
```

但

```
'hello world bye' 
' hello world' 
'hello word ' 
'hello  world' 
```

都是不正确的。

我尝试使用正则表达式，但没有成功。

编辑：只允许字母 a 到 z（大写和小写）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T17:46:10.900

尝试

```
if (input.matches("\\p{Alpha}+ \\p{Alpha}+")) { // same as "[a-zA-Z]+ [a-zA-Z]+"
    // good
} else {
    // bad
} 
```

在您阐明也允许使用大写字母后，我对其进行了编辑以使用 posix 字符类。

# php - 在 PHP 中管理巨型数组

> ID：14880830
> 
> 赞同：4
> 
> 时间：2013-02-14T17:41:45.823
> 
> 标签：php, memory-management

我正在为某人对数百万个旧日志条目进行数据挖掘，并且真的想在这件事上使用 PHP 来提供材料，以便轻松地将它们链接到现有的 PHP 系统。

我在终端（OSX 10.8）的 PHP 5.4.4 中运行此代码：

```
// Settings
ini_set('error_reporting', E_ALL); // Shows all feedback from the parser for debugging
ini_set('max_execution_time', 0); // Changes the 30 seconds parser exit to infinite
ini_set('memory_limit', '512M'); // Sets the memory that may be used to 512MegaBytes

echo 'Start memory usage: '.(memory_get_usage(TRUE) / 1024)."\n";

$x = Array();
for ($i = 0; $i < 1e7; $i++) {
    $x[$i] = 1 * rand(0, 10);
    //unset($x[$i]);
}

echo 'End memory usage: '.(memory_get_usage(TRUE) / 1024)."\n";
echo 'Peak memory usage: '.(memory_get_peak_usage(TRUE) / 1024)."\n"; 
```

这是一千万次循环的简单测试。与在 Python 中使用字典相比，泄漏真的很糟糕 :(。

当我取消引用 unset() 函数来测试用法时，它立即变成了独角兽和彩虹。所以强制释放内存似乎进展顺利。

有什么办法我仍然可以在 512M 内存限制内维护 10-50 百万个数组条目？

我也无法想象我什么时候会用这些循环做一些正则表达式..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T17:54:28.260

使用`SplFixedArray`是因为您确实需要了解[PHP 数组（和值）到底有多大？（提示：大！）](http://nikic.github.com/2011/12/12/How-big-are-PHP-arrays-really-Hint-BIG.html)

```
$t = 1e6;
$x = array();
for($i = 0; $i < $t; $i ++) {
    $x[$i] = 1 * rand(0, 10);
} 
```

输出

```
Start memory usage: 256
End memory usage: 82688
Peak memory usage: 82688 
```

和

```
$t = 1e6;
$x = new SplFixedArray($t);
for($i = 0; $i < $t; $i ++) {
    $x[$i] = 1 * rand(0, 10);
} 
```

输出

```
Start memory usage: 256
End memory usage: 35584
Peak memory usage: 35584 
```

但更好的是我认为你应该考虑一个基于内存的数据库，比如[REDIS](http://redis.io/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-24T14:36:09.200

如果 SplFixedArray 对您不起作用，我强烈建议使用 RabbitMQ -> [http://www.rabbitmq.com/tutorials/tutorial-one-php.html](http://www.rabbitmq.com/tutorials/tutorial-one-php.html)

RabbitMQ 比人们通常想象的更易于配置和使用，并且它有一个很好的 PHP 库。

使用 RabbitMQ，您的脚本可以快十倍、二十倍、一百倍（取决于您设置的消费者数量），您还可以管理任意数量的数据。

我曾使用 RabbitMQ 导入数百万行来检索有关在丹麦注册的所有汽车的信息，想象一下这有多大。

# c# - 简单的动态按钮列表 asp.net

> ID：14880834
> 
> 赞同：0
> 
> 时间：2013-02-14T17:42:04.247
> 
> 标签：c#, asp.net

我的问题是：我必须使用什么 asp.net 控件来生成带有来自数据库的文本的按钮列表，以及通过链接传递列出的对象的 ID（ID 也来自数据库）的链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:39:20.230

解决我的问题的是这个令人难以置信的简单的noobish解决方案：

```
<asp:Repeater ID="Repeater1" runat="server" OnItemCommand="Repeater1_ItemCommand"
                DataSourceID="SqlDataSource1">
                <ItemTemplate>
                    <asp:Button Style="margin-top: 20px;" ID="Button1" Font-Size="X-Large" BackColor="Blue" ForeColor="White" runat="server" Text='<%# Eval("Descrizione") %>'
                        PostBackUrl='<%# "~/Assemblaggio3.aspx?idCompCrit="+Eval("ID") %>' /><br /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:49:07.847

一个带有一堆按钮的数据中继器，该按钮具有唯一的 commandArgument 和一个通用的命令名称。

从我的头顶：

```
<asp:Repeater runat="server">
  <ItemTemplate>
      <asp:Button id="<%# DataBinder.Eval(Container.DataItem, "someuniquecounter") %>"
           Text="<%# DataBinder.Eval(Container.DataItem, "columnContainingTextToDisplayToUser") %>"
           CommandName="CommonCommandName"
           CommandArgument="<%# DataBinder.Eval(Container.DataItem, "IdToPassToTheCommandEventHandler%>")"
           OnCommand="CommandBtn_Click" 
           runat="server"/>
  </ItemTemplate>
  <SeparatorTemplate>
    <br>
  </SeparatorTemplate>
</asp:Repeater> 
```

在您的命令处理程序中，您可以首先测试命令名称是否正确（根据您要完成的操作，您可能有很多），然后获取命令参数（id）以传递给正确的方法。

```
void CommandBtn_Click(Object sender, CommandEventArgs e) 
      {

         if((string.Compare(e.CommandName, "yourCommandName", false)==0)
         {
               YourMethodAcceptingTheIdAsParameter((int)e.CommandArgument);            
         }
      } 
```

# php - PHP多语言：如何存储活动语言？

> ID：14880835
> 
> 赞同：0
> 
> 时间：2013-02-14T17:42:08.910
> 
> 标签：php, mysql, multilingual

我正在构建一个 php 切换器来为我的网站添加**多语言功能。**

MySQL 中的每个内容都有一个特定于语言的文本，我想根据活动语言检索它。

一开始，我想**在 MySQL 中建立一个定制的表来存储语言状态**。
例如：
ITALIAN 1
ENGLISH 0
..其中 1 表示语言处于活动状态，0 表示关闭。

每次用户切换语言时，我都会调用此表并更改语言状态。然后，在通话结束时，我刷新页面并 php 检索正确的内容。

这似乎是个好主意，直​​到我发现每次用户切换时 MySQL 中的语言状态都会改变。因此，如果一个用户正在用意大利语浏览网站，而其他用户同时切换到英语，那么第一个用户也将浏览英语。

我的问题是：如何存储特定用户的语言状态，避免更改每个其他用户的语言状态？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:48:43.177

如果您想要持久保存，请在用户表上添加“Lang”列

用户（id，用户名，密码，语言）；

只需将他们的语言设置存储在那里。如果您有另一个包含语言的表，则可以使用外键来避免完整性问题。

如果您不关心持久性（如果用户从其他计算机登录，则默认使用默认语言），您可以使用会话或 Cookie。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:47:30.837

不要使用数据库。改为设置一个`$_SESSION`变量（并且不要忘记`session_start()`在修改它之前调用它）。 [（PHP手册）](http://www.php.net/manual/en/reserved.variables.session.php)

# jquery - 在 beforeClose 函数中打开 fancybox 的目标链接？

> ID：14880842
> 
> 赞同：0
> 
> 时间：2013-02-14T17:42:43.210
> 
> 标签：jquery, fancybox, fancybox-2

我有一个可以通过以下方式打开的fancybox：

```
$('.fancybox').fancybox({
    type: 'iframe',
    fitToView : false,
    autoSize : false,
    height : 550,
    width : 650,
    beforeClose: function () {
        d = new Date();
        var imgObj = $('.fancybox').siblings('img');
        var imgSrc = imgObj.attr("src");
        imgObj.attr("src", imgSrc+"?"+d.getTime());
    }
}); 
```

正如您在`beforeClose`函数中看到的那样，我试图定位单击的链接的同级图像，并通过将时间附加为查询字符串来重新加载图像。

上面的代码有效，但它仅在页面上有 1 个幻想框时才有效。如果超过 1 个（这是我想要做的），那么它将页面上的所有图像重新加载到单击的链接旁边的图像。

有没有办法可以定位我单击的链接以从`beforeClose`函数中打开 fancybox？

我在fancybox 文档中找不到有关如何执行此操作的任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:06:43.573

而不是这个：

```
var imgObj = $('.fancybox').siblings('img'); 
```

... 尝试这个 ：

```
var imgObj = $(this.element).siblings('img'); 
```

见**[JSFIDDLE](http://jsfiddle.net/ZBQPm/)**

# java - 如何使用 Spring Java 配置在单例 bean 中生成原型对象

> ID：14880847
> 
> 赞同：6
> 
> 时间：2013-02-14T17:42:55.300
> 
> 标签：java, spring, jakarta-ee, spring-mvc

这是我现在拥有的，效果很好。它所做的只是一个返回项目对象数组的市场类：

我有班级市场

```
class market {

    public ArrayList<Items> createItems(HashMap<String,String> map) {
        ArrayList<Items> array = new ArrayList<Items>();
        for (Map.Entry<String, String> m : map.entrySet()) {
            Item item = new Item();
            item.setName(m.key());
            item.setValue(m.value());
            array.add(item);
        }
        return array;
    }
} 
```

类 Item 是一个简单的类，具有用于名称和值的 getter 和 setter

这是我的配置文件的外观：

```
@Configuration
public class MarketConfig {

    @Bean
    public Market market() {
        return new Market();
    }
} 
```

我想如何更改我的代码:( 原因：我不想要

```
Item item = new Item(); 
```

在 then 方法中。我希望 Spring 将其注入市场）

```
class market {

    public Item item;
    //getters and setters for item

    public ArrayList<Items> createItems(HashMap<String,String> map) {
        ArrayList<Items> array = new ArrayList<Items>();
        for (Map.Entry<String, String> m : map.entrySet()) {
             item.setName(m.key());
             item.setValue(m.value());
             array.add(item);
        }
        return array;
    }
}

@Configuration
public class MarketConfig {

    @Bean
    @Scope("prototype")
    public Item item() {
        return new Item();
    }

    @Bean
    public Market market() {
        Market bean = new Market();
        bean.setItem(item());
    }
} 
```

我知道每次调用 item() 时原型作用域都会给我新的 bean；现在我想要 createItems 方法的 for 循环中的每次迭代都有新的 bean。我怎么能告诉春天给我。

我知道的一种方法是做

```
applicationContext context = new AnnotationConfigApplicationContext();
context.getBean(Item.class); 
```

但是有没有其他方法可以完成我的工作。谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-14T18:02:49.467

是的，您可以使用查找方法按需创建原型方法

```
public abstract class ItemFactory {

    public abstract Item createItem();

} 
```

现在在 applicationContext.xml 中只需输入以下内容：

```
<bean id="item" class="x.y.z.Item" scope="prototype" lazy-init="true"/> 
```

并配置工厂：

```
<bean id="itemFactory" class="x.y.z.ItemFactory">
<lookup-method name="createItem" bean="item"/>
</bean> 
```

现在，为了使用它，您需要做的就是在任何 bean 中自动装配它：

并调用你的查找方法：

```
@Service 
public class MyService{

   @Autowired
   ItemFactory itemFactory;

   public someMethod(){
      Item item = itemFactrory.createItem();
   } 

} 
```

每次调用时，`createItem()`您都会收到对新创建的 Item 类实例的引用。

**PS：**我看到您正在使用`@Configuration`而不是xml，您需要检查是否可以在配置bean中配置查找方法。

希望能帮助到你。

**更新：**诀窍很简单：

```
@Configuration
public class BeanConfig {

    @Bean
    @Scope(value="prototype")
    public Item item(){
        return new Item();
    }

    @Bean
    public ItemManager itemManager(){
        return new ItemManager() {

            @Override
            public Item createItem() {
                return item();
            }
        };
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-09-02T12:59:44.587

如果您使用的是 Java 8，则可以简化

```
@Configuration
public class Config {

  @Bean
  @Scope(value = "prototype")
  public Item item() {
      return new Item();
  }

  @Bean
  public Supplier<Item> itemSupplier() {
      return this::item;
  }
} 
```

之后，您可以在 Market 类中使用此供应商来创建原型 Item bean。

```
@Component
public class Market {

  private final Supplier<Item> itemSupplier;

  @Autowired
  public Market(Supplier<Item> itemSupplier) {
      this.itemSupplier = itemSupplier;
  }

  private Item createItem() {
      return itemSupplier.get();
  }

} 
```

非常简单，不需要额外的工厂 bean 或接口。

# java - 寻找合适的设计模式

> ID：14880848
> 
> 赞同：0
> 
> 时间：2013-02-14T17:42:57.360
> 
> 标签：java, android, oop, design-patterns

好的，由于服务器端响应的配置不佳，我很难找到一种有效的方法来编写我的代码。
由于我要传达的示例相当复杂，因此我将尝试使用现实生活中的示例来提供帮助。

因此，假设我负责一项体育奖励计划，并且我正在尝试创建一个“顶级运动员页面”。该页面将显示来自三个运动类别的顶级男女运动员；棒球、篮球和足球。对此的一个转折是，可能只有一名男性获胜者，而没有一名女性获胜者，反之亦然，或者根本没有获胜者。最重要的是，女性只能是棒球运动员或篮球运动员，而男性可以是这三者中的任何一个，或者既是篮球运动员又是足球运动员。没有棒球与其他任何东西的结合。最后，如果男性和女性玩家都存在，则必须首先显示女性。所有三个类别都具有不同的属性，例如足球将具有“tds = 43”属性，而棒球则具有“本垒打 = 32”。

因此，混乱与服务器响应有关：

```
<player>
  <baseballList>
   <baseball
    name="Adam"
    sex="male"
    HomeRuns="32"
    reward="True"/>
 </baseballList>
 <basketballList>
 <basketball
  name="John"
    sex="male"
    Points="322"
    reward="False"/>
  <basketball
   name="Sandra"
    sex="female"
    Points="332"
    reward="True"/>
  </basketballList>
  <footballList>
   <football
    name= doug
    Touchdowns= 33
    sex=male
    reward="false"/>
   </footballList>
</player> 
```

（如果球员姓名同时匹配足球和篮球并且是男性，那么您将结合 2）正如您所见，响应是发回我必须过滤掉的不感兴趣的球员（不要问为什么），如以及当玩家进行多项运动时，它不会合并数据。因此，对于我的方法，我有一个 xml 处理程序工厂，它将 xml 发送到指定的“Players”处理程序。这看起来像：

```
public class PlayerHandler implements XmlHandler {

private static PlayerHandler handler = new PlayerHandler();

private PlayerHandler() {

}

public static PlayerHandler getInstance() {
    return handler;
}

public void load(String localName, String qName, Attributes attributes) {
    if (localName != null && attributes != null) {
        if       (localName.equalsIgnoreCase("football")||localName.equalsIgnoreCase("baseball")||localName.equalsIgnoreCase("basketball")) {
Player player = new Player();

if (localName.equalsIgnoreCase("football"))
 player.category = "football"
 player.TouchDowns=attributes.getValue("TouchDowns");

else if (localName.equalsIgnoreCase("baseball"))
  player.HomeRuns=arrtibutes.getValue("HomeRun");
  player.category = "baseball"

else{
  player.category = "basketball";
  player.Points=attributes.getValue("Points");}

  player.sex=attributes.getValue("sex");
  player.name=attributes.getValue("name");   
}
playerSorter.addPlayer(player);}} 
```

我为对象创建了一个类文件：

```
public class Player implements Serializable{
  public String category;
  public String rewards;
  public String TouchDowns;
  public String Points;
  public String HomeRuns;
  public String sex;
  public String Name;   
} 
```

我正在使用一个名为“playerSorter”的类进行所有排序，该类使用 addPlayer() 方法，仅在满足指定条件时才填充列表，然后我有一个 getPlayers() 方法，它调用我的 checkForAthleteWithInTwoSports() 方法（通过并查看是否有一个既是篮球又是足球的球员）然后返回一个排序列表，其中女性首先显示（如果适用）。从我的主页调用 getPlayers() 方法，然后将其设置为适配器类。更好的 xml 响应将使这样的任务变得更容易，但事实并非如此，我想找到一种更有效的方法来做到这一点。如果有人能帮助我找到一个好的设计模式来解决这个问题或任何建议，我将不胜感激。（此外，这些类别具有更多的属性，而不仅仅是“本垒打、得分或达阵”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:58:44.737

我不知道这里是否有特定的设计模式可以解决您的问题；从我的角度来看，您的模型缺少一些抽象，因为您主要使用字符串来表示您的域模型。这种与 OOP 背道而驰，OOP 的想法是用对象来表示事物，以便您可以将行为委托给它们。例如，考虑这段代码：

```
if (localName.equalsIgnoreCase("football"))
 player.category = "football"
 player.TouchDowns=attributes.getValue("TouchDowns");

else if (localName.equalsIgnoreCase("baseball"))
  player.HomeRuns=arrtibutes.getValue("HomeRun");
  player.category = "baseball"

else{
  player.category = "basketball";
  player.Points=attributes.getValue("Points");} 
```

这可以通过创建三个类来表示每个运动表现（ 和 ）来轻松改进`FootballPerformance`，`BaseballPerformance`其中`BasketballPerformance`每个类都包含适用于它们的属性。一旦你有了它，你就可以将 XML 节点的读取委托给类本身（请耐心等待，我不是 Java 程序员，所以我将使用伪代码）：

```
public class BasketballPerformance extends SportPerformance {
  private Integer points;

  //Constructor
  public BasketballPerformance(Attributes attributes)
  {
     this.points = attributes.getValue("Points");
  }

  public getPoints() 
  {
    return this.points;
  }
} 
```

这些类`FootballPerformance`和`BaseballPerformance`非常相似，采用一组属性并根据它们填充自己。通过将相同的想法应用于`Player`类，您还可以将对象创建分散到以下内容：

```
public Sport createSportPerformanceInstance(String name, Attributes attributes) 
{
if (name.equalsIgnoreCase("football"))
    {return new BasketballPerformance(attributes);}
else 
if (name.equalsIgnoreCase("baseball"))
    {return new BaseballPerformance(attributes);}
...
}

public void load(String localName, String qName, Attributes attributes) 
{
SportPerformance sportPerformance = this.createSportPerformanceInstance(localName, attributes);
Player player = new Player(Attributes attributes);
player.sportPerformance = sportPerformance;
} 
```

请注意，作为一个很好的副作用，如果您稍后添加一项新运动，您只需要实现新类并在`createSportPerformanceInstance`方法中添加一个新分支，而不是潜入一个单一的大方法。

以后可以通过`Player`保存一组表演而不是一个表演并`PlayerHandler`在创建新表演之前检查播放器的存在来改进代码。新方法看起来像这样：

```
public void load(String localName, String qName, Attributes attributes) 
{
SportPerformance sportPerformance = this.createSportPerformanceInstance(localName, attributes);
String playerName=attributes.getValue("name");
Player player;
  if (!this.playerExists(playerName)) 
  {
     player = new Player(attributes);
  } else 
     {
       player = this.getPlayerByName(playerName);
     }
  player.addPerformance(sportPerformance);
} 
```

好消息是，现在您可以通过实现接口将排序顺序委托给球员自己，`Comparable`并且模型也更适合您尝试建模的现实，因为您有一个球员在不同的运动中具有不同的表现。

[话虽如此，您可能会在Creational 设计模式](http://www.oodesign.com/creational-patterns/)中找到一些灵感，特别是在[Builder](http://www.oodesign.com/builder-pattern.html)、[Factory](http://www.oodesign.com/factory-pattern.html)和[Abstract Factory](http://www.oodesign.com/abstract-factory-pattern.html)中。

高温高压

# excel - 复制工作表时引用临时的、未保存的工作簿

> ID：14880850
> 
> 赞同：1
> 
> 时间：2013-02-14T17:43:04.077
> 
> 标签：excel, vba, object, copy

我有要复制到新的临时工作簿的工作表，**但不保存**。

`Worksheet.Copy`将工作表复制到一个新的、未命名的（Book1、Book2、Book3 等）工作簿。我希望将所有工作表复制到同一个工作簿。

对于第一个之后的所有工作表，我都尝试过使用`Worksheet.Copy After:=xlWb.Sheets(1)`，但我不知道在设置 xlWb 工作簿对象时如何引用新创建的工作簿。我不断收到

> 运行时错误 9，“下标超出范围”。

```
Dim xlApp As Excel.Application
Dim xlWb As Excel.Workbook
Dim xlWbOld As String
Dim xlWs As Excel.Worksheet
Dim xlWbNew As Excel.Workbook
Dim xlWsOld As Excel.Worksheet
Dim xlRng As Excel.Range
Dim xlRngOld As Excel.Range

xlWbOld = ActiveWorkbook.Name

Set xlApp = New Excel.Application
xlApp.Visible = True                                '*** Quite Important to set Excel.Visible,_
                                                    'Otherwise user wouldn't see the application's running _
                                                    'even though it would run as background

xlApp.Application.ScreenUpdating = False
Set xlWb = xlApp.Workbooks.Add                      'Create a new Workbook
Set xlWs = xlWb.Worksheets.Add 
```

这是应该复制工作表的地方：

```
Select Case strRptType
    Case "DAILY"
        xlWs.Name = "1-Daily Price"
        'Check the last column and the last row
        lLastRow = oBasic.GetLast(, "DailyRpt", False, "A")
        iLastCol = oBasic.GetLast(, "DailyRpt", True, 4)
        Set xlRngOld = wksDailyRpt.Range(wksDailyRpt.Cells(4, 1), wksDailyRpt.Cells(lLastRow, iLastCol))
        Application.ScreenUpdating = True
        xlRngOld.Copy

        Set xlRng = xlWs.Cells(1, 1)
        xlRng.PasteSpecial Paste:=xlPasteValues
        xlWs.Columns.AutoFit

        For Each xlWsOld In ActiveWorkbook.Worksheets
            If xlWsOld.Name = "ForwardPrices" Or xlWsOld.Name = "ForwardVolatilities" _
              Or xlWsOld.Name = "ForwardReturns" Or xlWsOld.Name = "ForwardCorrelations" Then

                Sheets(xlWsOld.Name).Copy After:=Workbooks(xlWb).Sheets(1)

            End If
        Next xlWsOld
End Select 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:04:12.660

这个小宏遍历所有打开的工作簿的所有工作表，并将它们复制到当前工作表之后。

```
Sub GatherAllSheets()
  Dim Wb As Workbook, Sh As Worksheet
  For Each Wb In Workbooks
    If Not Wb Is ThisWorkbook Then
      For Each Sh In Wb.Worksheets
        Sh.Copy after:=ActiveSheet
      Next Sh
    End If
  Next Wb
End Sub 
```

这是你需要的吗？
或者您需要将工作表的内容复制到同一张工作表上？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T12:40:22.403

我用以下方法解决了它：

```
 For Each xlWsOld In ActiveWorkbook.Worksheets
                If xlWsOld.Name = "ForwardPrices" Or xlWsOld.Name = "ForwardVolatilities" _
                Or xlWsOld.Name = "ForwardReturns" Or xlWsOld.Name = "ForwardCorrelations" Then

                    Set xlRngOld = Nothing
                    Set xlWsForwards = xlWb.Worksheets.Add

                    lLastRow = oBasic.GetLast(, xlWsOld.Name, False, "A")
                    iLastCol = oBasic.GetLast(, xlWsOld.Name, True, 1)

                    Set xlRngOld = xlWsOld.Range(xlWsOld.Cells(1, 1), xlWsOld.Cells(lLastRow, iLastCol))

                    xlWsForwards.Name = xlWsOld.Name
                    xlRngOld.Copy
                    Set xlRngForwards = xlWsForwards.Cells(1, 1)
                    xlRngForwards.PasteSpecial Paste:=xlPasteValues
                    xlWsForwards.Columns.AutoFit

                    xlWsForwards.Cells(1, 1).Select

                    Set xlWsForwards = Nothing

                End If
            Next xlWsOld 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-29T11:27:54.327

跳过创建新工作簿，一次性复制所有工作表。

```
xlWbOld.Sheets(Array("ForwardPrices", "ForwardVolatilities", "ForwardReturns", "ForwardCorrelations")).Copy
Set xlWb = ActiveWorkbook 
```

这种方式复制创建成为 ActiveWorkbook 的新工作簿。然后您可以将它分配给一个工作簿对象，并在以后通过该名称引用它

# jquery - 如何在使用 jQuery 重新加载页面期间继续显示请等待页面？

> ID：14880852
> 
> 赞同：1
> 
> 时间：2013-02-14T17:43:11.917
> 
> 标签：jquery, jsp

我正在使用 jQuery 1.6.2，并且在显示请稍候动画时，我必须禁用页面上包含表单、选择和链接的所有元素。

[我在Ajaxload](http://ajaxload.info/)找到了一个免费动画并`$('.gif').show();`用来显示它，等到一些 javascript 函数完成然后调用`$('.gif').hide();`

然而，我遇到了一些我没有预料到的事情。当用户在下拉列表中选择一个新项目时，加载 gif 动画会显示，但此后不久，在与下拉列表关联的嵌套 javascript 函数中，它会使用来自数据库调用的新数据来调用页面刷新，并在我可以之前删除我的动画调用隐藏函数。

所以我的问题是，是否可以显示将在 jsp 中显示的动画，然后继续直到重新加载完成？

我正在使用这样的东西来禁用链接点击事件：

```
 $("a").click(function(event) {
   // add some conditional logic here if animation is running then
    event.preventDefault(); ... 
```

那么，有没有更好的方法来全局禁用页面上的所有元素，防止选择下拉菜单上的单击事件或更改事件？

**后果：**

我使用了 Archer 对背景 div 的建议，Jai 的回答，以及这篇博客文章：[jQuery 页面加载延迟](http://onwebdev.blogspot.com/2011/03/jquery-page-loading-delay.html)，这篇关于使用[带有动画的模态窗口的](http://blog.lavgupta.com/2011/12/jquery-modal-waiting-dialog.html)文章，并提出了一个完全符合我需要的自定义解决方案.

感谢大家的帮助，不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T18:00:03.763

可能以这种方式一起使用`doc ready`和：`window load`

```
$(function(){
   $('.gif').show();
   $(window).load(function(){
      $('.gif').hide();
      $('#wrapper').show();
   });
}); 
```

最初`wrapper div needs to be hidden`，当窗口完全加载时`show the wrapper`，`hide the gif`.

# entity-framework - 为什么将新行添加到外键表中而不更新实体的关联行？

> ID：14880853
> 
> 赞同：0
> 
> 时间：2013-02-14T17:43:15.177
> 
> 标签：entity-framework, asp.net-mvc-4, ef-code-first

我可能犯了一个愚蠢的错误，但我不知道为什么会这样。我最初保存个人信息，这会在问题表中创建一行，但是当我去更新问题时，它会在问题表中创建一个新行并将 questionId 列更新为添加的新行。代码如下。

```
public class PersonalInfo
{
    public virtual int PersonalInfoId { get; set; }

    public virtual string FirstName { get; set; }

    public virtual string LastName { get; set; }

    public virtual string Email { get; set; }

    public virtual string CompanyName { get; set; }

    public virtual string Gender { get; set; }

    public virtual DateTime GenerationDate { get; set; }

    [ForeignKey("Question")]
    public int QuestionId { get; set; }

    [ForeignKey("QuestionId")]
    public virtual Question Question { get; set; }

    public PersonalInfo()
    {
        if (Question == null)
            Question = new Question();
    }
}

public class Question
{
    public virtual int QuestionId { get; set; }
    public virtual string Question1 { get; set; }
    public virtual string Question2 { get; set; }
    public virtual string Question3 { get; set; }
    public virtual string Question4 { get; set; }
    public virtual string Question5 { get; set; }
    public virtual string Question6 { get; set; }
    public virtual string Question7 { get; set; }
    public virtual string Question8 { get; set; }
    public virtual string Question9 { get; set; }
    public virtual string Question10 { get; set; }
    public virtual string Question11 { get; set; }
    public virtual string Question12 { get; set; }
} 
```

并更新代码...

```
[HttpPost]
    public ActionResult Questions(FormCollection form)
    {
        int id = GetCookie();

        //var questions = db.Questions.Find(id);
        var personalInfo = db.PersonalInfoes.Include(i => i.Question).SingleOrDefault(p => p.PersonalInfoId == id);

        personalInfo.Question.Question1 = form["question1"];
        personalInfo.Question.Question2 = form["question2"];
        personalInfo.Question.Question3 = form["question3"];
        personalInfo.Question.Question4 = form["question4"];
        personalInfo.Question.Question5 = form["question5"];
        personalInfo.Question.Question6 = form["question6"];
        personalInfo.Question.Question7 = form["question7"];
        personalInfo.Question.Question8 = form["question8"];
        personalInfo.Question.Question9 = form["question9"];
        personalInfo.Question.Question10 = form["question10"];
        personalInfo.Question.Question11 = form["question11"];
        personalInfo.Question.Question12 = form["question12"];

        db.SaveChanges();

        return RedirectToAction("list");   
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T18:49:23.747

尝试注释掉这段代码：

```
if (Question == null)
    Question = new Question(); 
```

* * *

更新

定义 2 个外键也可能存在问题

```
[ForeignKey("Question")]
public int QuestionId { get; set; }

[ForeignKey("QuestionId")]
public virtual Question Question { get; set; } 
```

如错误所示，包括`Questions_QuestionId`

如果将其减少到一个条目会发生什么：

```
[ForeignKey("QuestionId")]
public virtual Question Question { get; set; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:38:36.167

根据评论，`personalInfo.Question.QuestionId`为 0 意味着 EF 将查看该问题记录并确定它实际上是一个新记录，并且与前一个记录没有链接。这就是为什么它每次都重新创建行。

您可以执行以下两种解决方案之一：

1) 将 QuestionId 放入您的会话缓存中，然后在控制器中抓取它，使用它来抓取问题，并在那里进行必要的更新。

2）将 QuestionId 作为隐藏字段放入您的视图中，并确保在提交表单时将其传递到控制器中。从那里抓住问题并进行必要的更新。您甚至可以将该字段设置为可选参数，这样当它为 0 时，您就知道需要创建问题。

# java - Java：存储到字符串中时服务器响应被切断？

> ID：14880854
> 
> 赞同：3
> 
> 时间：2013-02-14T17:43:15.880
> 
> 标签：java, stream, http-headers

很奇怪的问题，不知道。也许你可以再次提供帮助 - 经常这样:)

我创建了一个简单的 UrlConnection 并使用 post-method。当我查看wireshark时，所有内容都直接发送给我。我尝试将响应存储到一个字符串中。并且该字符串是整个数据包的简短版本，同时它是正确关闭的（带有/html-tag）。

记事本中的差异给了我这样的信息：

```
<a href="wato.py?mode=..."></a> 
```

在wireshark中：

```
<a href="wato.py?mode=edithost&amp;host=ColorPrinter ... muchmuchmore ... 
```

这是它似乎得到削减的地方

真的很奇怪，现在这是我的代码：

```
public void uploadCsv(File csvFile) throws CsvImportException, IOException {

    String sUrl = String.format(urlBaseWato, hostAddress);

    String csvFileContent = readFile(csvFile);

    ParamContainer params = new ParamContainer().addParam("a", "a")
                                                .addParam("b", b)
                                                .addParam("c", "c");

    URLConnection connection = new URL(sUrl).openConnection();

    postData(connection, params);
    String resp = getResponse(connection); // <---- broken string here :(
    ...
} 
```

-

```
private void postData(URLConnection con, ParamContainer params) throws IOException {

    int cLen = params.getEncodedParamString().getBytes().length;

    con.setDoInput(true);
    con.setDoOutput(true);
    con.setUseCaches (false);

    con.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
    con.setRequestProperty("Cookie", authCookie.toString());
    con.setRequestProperty("Content-Length", Integer.toString(cLen));       

    //Send request

    DataOutputStream os = new DataOutputStream (con.getOutputStream());

    os.writeBytes(params.getEncodedParamString());
    os.flush ();
    os.close ();

} 
```

-

```
private String getResponse(URLConnection connection) throws IOException {
    connection.connect();
    BufferedReader in = new BufferedReader(new InputStreamReader(
            connection.getInputStream()));

    String line;
    String response = "";

    while ((line = in.readLine()) != null)        
        response +=line;

    in.close();

    return response;
} 
```

莫名其妙，我一点头绪都没有。你能帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T09:01:34.153

使用有[`IOUtils`](http://commons.apache.org/io/apidocs/org/apache/commons/io/IOUtils.html)帮助吗？

```
URLConnection connection = new URL(sUrl).openConnection();
IOUtils.toString(connection.getInputStream(), "UTF-8"); 
```

甚至：

```
IOUtils.toString(new URL(sUrl), "UTF-8"); 
```

即使没有，请始终首先考虑减少代码中的样板数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T18:37:41.950

我想我应该把它作为一个答案，以防它是问题并且可以被接受。我见过关闭套接字会切断已经写入那里的流的情况。尝试将 Thread.sleep(5000) 放在套接字闭包的前面。

# java - Android - Sqlite 日期查询有什么问题以及如何改进我的编码风格

> ID：14880860
> 
> 赞同：0
> 
> 时间：2013-02-14T17:43:35.867
> 
> 标签：java, android, sqlite

我在我的 sql 查询中遇到错误，我需要更改哪些内容来改进我的编码

我的代码是

我的 DBHelper 代码

```
public Cursor fetchDaysAppointment(String from, String to){

    Cursor c = ourDatabase.rawQuery("SELECT * FROM "+CUSTOMER_TABLE_NAME+
            "WHERE (aDate >= ? AND aDate <= ?)", 
            new String[]{from, to});

    if(c != null){
        c.moveToFirst();
    }
    return c;
} 
```

我的 Java 代码

```
public void getDaysAppointment(int day, int month, int year){

    String from = year+"-"+month+"-"+day+" 00:00:00";
    String to = year+"-"+month+"-"+day+" 23:59:59";

    in.open();
    cursor = in.fetchDaysAppointment(from, to);
    cursor.moveToFirst();

    for(int i=0; i<cursor.getCount(); i++){

        if(cursor.getInt(cursor.getColumnIndex("aTime")) == 8){
            System.out.println("Hi the value is found to be Matched");
        }
        cursor.moveToNext();

    }

} 
```

日志猫错误

```
02-14 17:23:06.740: E/AndroidRuntime(4535): FATAL EXCEPTION: main
02-14 17:23:06.740: E/AndroidRuntime(4535): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.ashadegreen/com.example.ashadegreen.Home}: android.database.sqlite.SQLiteException: near "(": syntax error: , while compiling: SELECT * FROM customerWHERE (aDate >= ? AND aDate <= ?) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:45:08.450

你之前忘了加空格`WHERE`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T18:28:26.813

*我需要更改哪些内容来改进我的编码。？*

我看到的一件事是，您在 DBHelper 类本身中定义了 CUSTOMER_TABLE_NAME 和其他人，对于小程序来说这很好，但是当您的代码增长并且数据库模式变得更大时，维护代码和数据库很重要。

为此，让另一个类命名为常量，并定义所有与数据库模式相关的信息，如 dbname、表、它们在同一类中的列，稍后您可以使用**常量访问它们。“itemyouwanttouse”**。这将使您的代码更有条理。

# c# - 嵌套 LINQ 查询以在列表中选择“上一个”值

> ID：14880863
> 
> 赞同：6
> 
> 时间：2013-02-14T17:43:44.430
> 
> 标签：c#, linq

我有一个日期列表。我想查询列表并返回一个对列表，其中第一项是日期，第二项是在第一个日期之前发生的日期（在列表中）。

我知道这可以通过对列表进行排序并按索引获取相应的日期来轻松实现，我很好奇如何在 LINQ 中实现这一点。

我在 SQL 中使用以下查询完成了此操作：

```
SELECT Date, 
    (SELECT MAX(Date)
    FROM Table AS t2
    WHERE t2.Date < t1.Date) AS PrevDate
FROM Table AS t1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T17:53:06.623

将当前查询转换为`LINQ`查询很容易：

```
var result = table.Select(x =>
    new
    {
        Date = x.Date,
        PrevDate = table.Where(y => y.Date < x.Date)
                        .Select(y => y.Date)
                        .Max()
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T17:52:19.273

```
List<DateTime> dates = new List<DateTime>()
{
    DateTime.Now.AddDays(1),
    DateTime.Now.AddDays(7),
    DateTime.Now.AddDays(3),
    DateTime.Now.AddDays(6),
    DateTime.Now.AddDays(5),
    DateTime.Now.AddDays(2),
    DateTime.Now.AddDays(3),
};

dates = dates.OrderByDescending(x => x).ToList();
var result = dates.Skip(1)
    .Select((x, i) => new { Date = dates[i], PreviousDate = x }); 
```

# google-closure - Google Closure JSDoc 注解

> ID：14880874
> 
> 赞同：0
> 
> 时间：2013-02-14T17:44:12.273
> 
> 标签：google-closure

是否可以使用 JSDoc 注释在子类中公开超类的受保护实例方法？更具体地说，我有一个继承自 goog.ui.Control 的类。goog.ui.Control 有一个受保护的方法 setElementInternal。我想在子类中公开它的访问修饰符，以便从另一个类访问这个方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T01:27:23.170

答案如下所示。

“foo.js”

goog.provide('foo');

...

goog.inherits(foo,goog.ui.Control);

...

/** * @param {Element} 元素 */

foo.prototype.setElementInternalEncap = 函数（元素）{

goog.bind(this.setElementInternal, this, element);

};

“酒吧.js”

goog.provide('bar');

goog.require('foo');

...

fooReference.setElementInternalEncap(元素);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:29:09.020

不是直接的。

您需要在调用该方法的公共继承类中添加一个新`@protected`方法。像这样的东西应该工作。

```
/**
 * My public wrapper around a protected method
 * @param {Element} element Root element for this component
 */
my.namespace.Control.prototype.setElement = function(element) {
    this.setElementInternal(element);
} 
```

# ruby-on-rails - 在属性视图中添加租户用户

> ID：14880875
> 
> 赞同：0
> 
> 时间：2013-02-14T17:44:14.277
> 
> 标签：ruby-on-rails, ruby, models

我正在尝试在 Property#show 视图中添加租户用户。我有一个表格，如下所示：

```
<%= form_for(@property.tenants) do |f| %>
   <div class="field">
    <%= f.label :name %><br />
    <%= f.text_field :name %>
  </div>
  <div class="field">
    <%= f.label :email %><br />
    <%= f.text_field :email %>
  </div>
  <div class="select">
  <%= f.select :type, [['Landlord'],['Tenant']] %>
  </div>
  <%= f.submit "Add", %>  
<% end %> 
```

租户模型如下：

```
class Tenant < User
  belongs_to :property
  def type
  "Tenant"
  end
end 
```

属性模型如下：

```
class Property < ActiveRecord::Base
  attr_accessible :address, :bathrooms, :bedrooms, :postcode, :price
  belongs_to :branch
  belongs_to :user

  has_many :ownerships
  has_many :landlords, :through => :ownerships

  has_many :tenants
end 
```

当我单击添加按钮时，我被神奇地重定向到根路径 (/)。我希望它为我在显示视图中查看的特定属性添加一个新租户，但它只是将我重定向到根路径。

随时询问 rake 路线的任何澄清结果：

```
 tenants_index GET    /tenants/index(.:format)       tenants#index
   tenants_show GET    /tenants/show(.:format)        tenants#show
    tenants_new GET    /tenants/new(.:format)         tenants#new
  landlords_new GET    /landlords/new(.:format)       landlords#new
   tenants_edit GET    /tenants/edit(.:format)        tenants#edit
 tenants_create GET    /tenants/create(.:format)      tenants#create
 tenants_update GET    /tenants/update(.:format)      tenants#update
tenants_destroy GET    /tenants/destroy(.:format)     tenants#destroy
     properties GET    /properties(.:format)          properties#index
                POST   /properties(.:format)          properties#create
   new_property GET    /properties/new(.:format)      properties#new
  edit_property GET    /properties/:id/edit(.:format) properties#edit
       property GET    /properties/:id(.:format)      properties#show
                PUT    /properties/:id(.:format)      properties#update
                DELETE /properties/:id(.:format)      properties#destroy
          users GET    /users(.:format)               users#index
                POST   /users(.:format)               users#create
       new_user GET    /users/new(.:format)           users#new
      edit_user GET    /users/:id/edit(.:format)      users#edit
           user GET    /users/:id(.:format)           users#show
                PUT    /users/:id(.:format)           users#update
                DELETE /users/:id(.:format)           users#destroy
      companies GET    /companies(.:format)           companies#index
                POST   /companies(.:format)           companies#create
    new_company GET    /companies/new(.:format)       companies#new
   edit_company GET    /companies/:id/edit(.:format)  companies#edit
        company GET    /companies/:id(.:format)       companies#show
                PUT    /companies/:id(.:format)       companies#update
                DELETE /companies/:id(.:format)       companies#destroy
       branches GET    /branches(.:format)            branches#index
                POST   /branches(.:format)            branches#create
     new_branch GET    /branches/new(.:format)        branches#new
    edit_branch GET    /branches/:id/edit(.:format)   branches#edit
         branch GET    /branches/:id(.:format)        branches#show
                PUT    /branches/:id(.:format)        branches#update
                DELETE /branches/:id(.:format)        branches#destroy
       sessions POST   /sessions(.:format)            sessions#create
    new_session GET    /sessions/new(.:format)        sessions#new
        session DELETE /sessions/:id(.:format)        sessions#destroy
         agents GET    /agents(.:format)              users#index
                POST   /agents(.:format)              users#create
      new_agent GET    /agents/new(.:format)          users#new
     edit_agent GET    /agents/:id/edit(.:format)     users#edit
          agent GET    /agents/:id(.:format)          users#show
                PUT    /agents/:id(.:format)          users#update
                DELETE /agents/:id(.:format)          users#destroy
      landlords GET    /landlords(.:format)           users#index
                POST   /landlords(.:format)           users#create
   new_landlord GET    /landlords/new(.:format)       users#new
  edit_landlord GET    /landlords/:id/edit(.:format)  users#edit
       landlord GET    /landlords/:id(.:format)       users#show
                PUT    /landlords/:id(.:format)       users#update
                DELETE /landlords/:id(.:format)       users#destroy
        tenants GET    /tenants(.:format)             users#index
                POST   /tenants(.:format)             users#create
     new_tenant GET    /tenants/new(.:format)         users#new
    edit_tenant GET    /tenants/:id/edit(.:format)    users#edit
         tenant GET    /tenants/:id(.:format)         users#show
                PUT    /tenants/:id(.:format)         users#update
                DELETE /tenants/:id(.:format)         users#destroy
           root        /                              static_pages#home
         signup        /signup(.:format)              users#new
         signin        /signin(.:format)              sessions#new
        signout DELETE /signout(.:format)             sessions#destroy
      dashboard        /dashboard(.:format)           static_pages#dashboard
           help        /help(.:format)                static_pages#help
          about        /about(.:format)               static_pages#about
        contact        /contact(.:format)             static_pages#contact 
```

properties_controller.rb

```
class PropertiesController < ApplicationController
  # GET /properties
  # GET /properties.json
  def index
    @properties = Property.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @properties }
    end
  end
def show
    @property = Property.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @property }
    end

  end

  # GET /properties/new
  # GET /properties/new.json
  def new
   # @property = Property.new
   @property = current_user.properties.build if signed_in?

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @property }
    end
    logger.debug("hello from new")
  end

  # GET /properties/1/edit
  def edit
    @property = Property.find(params[:id])
  end

  # POST /properties
  # POST /properties.json
  def create
    #@property = Property.new(params[:property])
    @property = current_user.branch.properties.build(params[:property]) if signed_in?
    respond_to do |format|
      @property.user_id = current_user.id
      if @property.save
        format.html { redirect_to @property, notice: 'Property was successfully created.' }
        format.json { render json: @property, status: :created, location: @property }
      else
        format.html { render action: "new" }
        format.json { render json: @property.errors, status: :unprocessable_entity }
      end
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T18:25:42.683

在你的 `properties_controller.rb`,

```
def show
 @tenant = Tenant.new
end 
```

你的 from 应该是：

```
<%= form_for @tenant do |f| %> 
```

您还应该在提交表单时添加一个带有属性 ID 的隐藏字段。

然后为您的创建操作`properties_controller.rb`

```
def create
   tenant = Tenant.new(params[:tenant])
   tenant.property_id = params[:property_id] #This is from that hidden field with your property_id and this also assumes you have a column in your tenant table for property_id
   tenant.save

   #the shorter way would just be tenant = Tenate.create(params[tenant]) but I want to emphasize the property_id since this attribute is paramount to your property-tenant relationship
end 
```

这应该有效地为新租户创建一个表单，并且当您创建实际租户记录时，您将使用新租户记录保存属性 ID。

另一方面，我建议根据 Rails 约定将其移至租户控制器，并将表单置于新操作下，因为您实际上是在创建新的租户记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T18:18:03.490

我认为有几件事似乎不太正确。

尝试这个。

将 @tenant 实例变量添加到 Properties 控制器的 show 方法中。

```
def show
  ...
  @tenant = @property.tenants.build
end 
```

并将 form_for 行修改为此。

```
<%= form_for @tenant do |f| %> 
```

# java - 无内存交换的 SSD 的 java 最快并发随机文件 R/W 方法

> ID：14880878
> 
> 赞同：0
> 
> 时间：2013-02-14T17:44:26.720
> 
> 标签：java, file, random, solid-state-drive

我有一个带有 32GB ram 和一组 4 个 SSD 的 linux 机器，在 raid 0 配置中，最大吞吐量约为 1GB（随机 4k 读取），我正在尝试确定随机并同时访问文件的最佳方式使用java。到目前为止，我看到的两种主要方式是通过随机访问文件和映射的直接字节缓冲区。

这是它变得棘手的地方。我有自己的对象内存缓存，因此对存储在文件中的对象的任何调用都应该通过磁盘而不是分页内存（我已禁用我的 linux 机器上的交换空间以防止这种情况发生）。虽然映射的直接内存缓冲区被认为是最快的，但它们依赖于交换，这并不好，因为 A）我将所有空闲内存用于对象缓存，而使用映射字节缓冲区会产生大量的序列化开销，这就是对象缓存的存在防止。（我的程序已经受 CPU 限制） B）使用映射字节缓冲区，操作系统处理数据何时写入磁盘的详细信息，我需要自己控制它，即。当我 write(byte[]) 时，它会立即直接输出到磁盘，这是为了防止电源故障时数据损坏，因为我没有使用 ACID 事务。

另一方面，我需要大量并发，即。我需要同时读取和写入同一个文件中的多个位置（同时使用偏移/范围锁来防止数据损坏）我不确定如果没有映射字节缓冲区我怎么能做到这一点，我总是可以查询读取/写，但我不确定这会对我的吞吐量产生什么负面影响。

最后，当我为读取或写入创建新的 byte[] 对象时，我不会遇到这种情况，这是因为我每秒执行几乎 100000 次读取/写入操作，分配和垃圾收集所有这些对象会杀死我的程序，这是时间敏感且已经受到 CPU 限制，重用 byte[] 对象就可以了。

请不要推荐任何数据库软件，因为我已经尝试过其中的大多数软件，它们增加了很多复杂性和 CPU 开销。

有人遇到过这种困境吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:00:04.747

> 虽然映射的直接内存缓冲区据说是最快的，但它们依赖于交换

不，如果您有足够的 RAM，则不会。该映射将内存中的页面与磁盘上的页面相关联。除非操作系统决定需要恢复 RAM，否则页面不会被换出。而且，如果您的 RAM 不足，那么禁用交换所做的一切只会导致致命错误，而不是性能下降。

> 我将所有可用内存用于对象缓存

除非您的对象的寿命非常长，否则这是一个坏主意，因为垃圾收集器在运行时必须做很多工作。您经常会发现较小的缓存会导致较高的整体吞吐量。

> 使用映射字节缓冲区，操作系统处理数据何时写入磁盘的详细信息，我需要自己控制它，即。当我写（字节[]）时，它会立即直接输出到磁盘

实际上，它不会，除非您使用该`sync`选项安装了文件系统。然后您仍然冒着因驱动器故障（尤其是在 RAID 0 中）而丢失数据的风险。

> 我不确定如果没有映射字节缓冲区我怎么能做到这一点

A`RandomAccessFile`会这样做。但是，您将在每次写入时至少为内核上下文切换付费（并且如果您为同步写入安装了文件系统，则每次写入都将涉及磁盘往返）。

> 我没有使用 ACID 事务

那么我猜这些数据并没有那么有价值。所以不要再担心有人会被电源线绊倒的可能性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T18:06:13.973

您对映射字节缓冲区的反对是站不住脚的。您的映射文件将与您的对象缓存不同，尽管它们占用地址空间，但它们不会消耗 RAM。您还可以随时同步映射的字节缓冲区（以牺牲一些性能为代价）。此外，随机访问文件最终会在幕后使用相同的设备，因此您无法在其中保存任何性能。

如果映射字节缓冲区没有为您提供所需的性能，您可能必须绕过文件系统并直接写入原始分区（这是 DBMS 所做的）。为此，您可能需要为数据处理编写 C++ 代码并通过 JNI 访问它。

# visual-studio-2012 - 我可以使用 Blend for Visual Studio 2012 制作常规桌面应用程序吗？

> ID：14880879
> 
> 赞同：4
> 
> 时间：2013-02-14T17:44:27.897
> 
> 标签：visual-studio-2012, blend, expression-blend-5

我看到的与 Blend for Visual Studio 2012 相关的所有内容都在谈论制作 Window 的商店应用程序。我假设它也可以用于常规桌面应用程序是否正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T08:08:10.877

目前 Blend for Visual Studio 不支持构建 WPF 或 Silverlight 应用程序。但是，它将与下一次更新。从那时起，您将能够再次使用 Blend 设计常规桌面应用程序。直到您可以使用 Expression Blend 4，如果您有 MSDN 订阅，您可以使用它。

您可以在此处阅读有关[Visual Studio](http://blendinsider.com/technical/announcing-visual-studio-2012-update-2-ctp-2013-01-30/)即将更新的更多信息并下载预览。

还有一个早期的 Blend 预览版也支持 WPF。[您可以在BlendInsiders 博客](http://blendinsider.com/technical/announcing-blend-sketchflow-preview-for-visual-studio-2012-2012-08-15/)上阅读更多相关信息。此预览版的唯一缺点是它还没有上线许可证。它与 Blend for Visual Studio 并行运行。

尽管应该可以完全在 Blend 中构建应用程序，但我建议您在 Visual Studio 中编写代码，并且只在 Blend 中使用 XAML。

**更新：** 随着 Visual Studio 2012 更新 2 的发布，Blend 添加了对 WPF 的支持。更多相关信息可以在[这里](http://blogs.msdn.com/b/visualstudio/archive/2013/04/04/visual-studio-2012-update-2-is-here.aspx)找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T18:42:04.707

是和不是。

“Windows 应用商店”应用程序模板只能用于“Windows 应用商店模型”类型的应用程序，也称为 Tifkam、Metro 或 Immersive。

Blend 确实具有用于常规 WPF 和 Silverlight 应用程序和控件的设计器。但是，它不是用于端到端创建应用程序的工具，它严格来说是一种用户界面设计工具。请注意，Visual Studio 共享完全相同的 WPF 设计器代码库。如果您是非程序员设计师，或者如果您需要出色的 Tifkam HTML 或“Jupiter”XAML（非 WPF）设计器工具，请使用 Blend。

# sql-server - 无法将数据添加到 datetime2 字段

> ID：14880889
> 
> 赞同：0
> 
> 时间：2013-02-14T17:45:04.150
> 
> 标签：sql-server, sql-server-2008

我使用 SQL Server Express 2008 并尝试将数据添加到数据类型为 datetime2(7) 的表中的字段中。

这就是我要添加的内容：

```
'2012-02-02 12:32:10.1234' 
```

但我得到了错误

```
Msg 8152, Level 16, State 4, Line 1
String or binary data would be truncated.
The statement has been terminated. 
```

这是否意味着添加到字段中的时间太长了？应该削减一点？如果是这样 - 你能给我一个它应该是什么样子的例子吗？

注意 - 我也尝试过这种格式：

```
'01/01/98 23:59:59.999' 
```

谢谢

**编辑

实际声明：

```
INSERT INTO dbo.myTable
( 
nbr,
id,
name,
dsc,
start_date,
end_date,
last_date,
condition,
condtion_dsc,
crte_dte,
someting,
activation_date,
denial_date,
another_date,
a_name,
prior_auth_start_date,
prior_auth_end_date,
history_cmnt,
cmnt,
source,
program, 
[IC-code],
[IC-description],
another_start_date,
another_start_date,
ver_nbr,
created_by,
creation_date,
updated_by,
updated_date)
VALUES
(
26,
'a',
'sometinh',
'c',
01/01/98 23:59:59.999,
01/01/98 23:59:59.999,
01/01/98 23:59:59.999,
'as',
'asdf',
01/01/98 23:59:59.999,
'lkop',
01/01/98 23:59:59.999,
01/01/98 23:59:59.999,
01/01/98 23:59:59.999,
'a',
01/01/98 23:59:59.999,
01/01/98 23:59:59.999,
'b',
'c',
'd',
'b',
'c',
'd',
01/01/98 23:59:59.999,
01/01/98 23:59:59.999,
423,
'Monkeys',
01/01/98 23:59:59.999,
'Goats',
01/01/98 23:59:59.999
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:02:02.003

仔细查看您要插入的表。我敢打赌，您尝试插入 char/varchar/nchar/nvarchar 列的值之一太长了。

```
SELECT 
  name,
  max_length / CASE WHEN system_type_id IN (231, 239)
    THEN 2 ELSE 1 END
FROM sys.columns 
WHERE [object_id] = OBJECT_ID('dbo.TargetTableName')
AND system_type_id IN (167, 175, 231, 239); 
```

这将为您提供如下列表：

```
name    
--------  --------
col1      32
col5      64
col7      12 
```

现在，将此列表与您的`VALUES`子句中的文字进行比较。正如我在评论中建议的那样，我敢打赌其中一个字符的数量超出了表格允许的范围。

`DATETIME2(7)`有可能存在 binary 或 varbinary 列，问题就在那里，但我强烈怀疑这是一个简单的“字符串太长”问题 - 与您的价值完全无关。

# mysql - 在一张表中记录关系？

> ID：14880890
> 
> 赞同：0
> 
> 时间：2013-02-14T17:45:09.067
> 
> 标签：mysql, database, database-design

我正在尝试实现我自己的[NACE 代码](http://ec.europa.eu/competition/mergers/cases/index/nace_all.html)数据库，并找到了一个包含所有代码及其各自名称的**.CSV**文件，这样我就不必手动输入它们了。

问题是，代码都在一个**.CSV**文件中。是否可以将它们 [NACE 代码] 全部转储到一张表中，然后以某种方式区分它们之间的父子关系？

因此，例如，如果所有代码都导入到表名“ **tnacecodes** ”中：

> J62 - 计算机编程、咨询和相关活动

将是父母

> J62.0.1 - 计算机编程活动
> 
> J62.0.2 - 计算机咨询活动
> 
> J62.0.3 - 计算机设施管理活动
> 
> J62.0.9 - 其他信息技术和计算机服务活动

即使他们都在一张桌子上。

我要做的是创建带有嵌套链接的 PHP 页面。通过单击更高级别的 NACE 代码（即 J62），PHP 脚本将检索子相关代码（J62.0.1、J62.0.2、...）并将它们显示在页面上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:52:20.663

您可以为每个项目添加一个包含父链接的列。这允许在单个表中使用分层结构（概念上）。您可以通过搜索具有指向该项目的父链接的项目来访问该项目的子项目。

# bash - linux动态cronjobs

> ID：14880893
> 
> 赞同：0
> 
> 时间：2013-02-14T17:45:12.403
> 
> 标签：bash, shell, dynamic

我希望继续添加更多的ips，我显然不想继续一个一个地添加，任何人都可以帮助我动态构建某种数组，我可以通过crontab每10分钟执行一个shell文件?

这是我的 cronjob 中的内容：

```
*/10 * * * * scp /var/lib/asterisk/agi-bin/* 72.119.110.20:/var/lib/asterisk/agi-bin/ >/dev/null 2>&1
*/10 * * * * scp /var/lib/asterisk/agi-bin/* 72.119.110.21:/var/lib/asterisk/agi-bin/ >/dev/null 2>&1
*/10 * * * * scp /var/lib/asterisk/agi-bin/* 72.119.110.22:/var/lib/asterisk/agi-bin/ >/dev/null 2>&1

*/10 * * * * scp /etc/asterisk/extensions.conf 72.119.110.20:/etc/asterisk/extensions.conf >/dev/null 2>&1
*/10 * * * * scp /etc/asterisk/extensions.conf 72.119.110.21:/etc/asterisk/extensions.conf >/dev/null 2>&1
*/10 * * * * scp /etc/asterisk/extensions.conf 72.119.110.22:/etc/asterisk/extensions.conf >/dev/null 2>&1

*/10 * * * * scp /etc/asterisk/sip.conf 72.119.110.20:/etc/asterisk/sip.conf >/dev/null 2>&1
*/10 * * * * scp /etc/asterisk/sip.conf 72.119.110.21:/etc/asterisk/sip.conf >/dev/null 2>&1
*/10 * * * * scp /etc/asterisk/sip.conf 72.119.110.22:/etc/asterisk/sip.conf >/dev/null 2>&1 
```

非常感谢您编写脚本以实现此目的的任何帮助。再一次感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:49:52.330

```
for ip in 21.119.110.{20,21,22}; do scp ... $ip:...; done 
```

应该管用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T18:12:54.043

您可以在 bash 中使用数组：

```
IPADDRESSES=( 10.0.0.1 192.168.0.1 8.8.8.8 )

for IPADDRESS in ${IPADDRESSES[@]}; do
  echo ${IPADDRESS}
done 
```

# api - 带有 API 的编程/Web 开发字典？

> ID：14880896
> 
> 赞同：1
> 
> 时间：2013-02-14T17:45:17.190
> 
> 标签：api

[http://www.webopedia.com/](http://www.webopedia.com/)是我正在寻找的，但它不提供 API。是否有提供 API 的类似服务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T18:33:15.210

DuckDuckGo 有一个非常灵活的开放 API：查看[https://duckduckgo.com/api](https://duckduckgo.com/api)。使用他们的“定义”语法，可以取回单词定义。例如，

```
http://api.duckduckgo.com/?q=define+ostensibly&format=json&pretty=1 
```

...会让你回到 JSON 格式的“表面上”的定义。

WordNik API ( [http://developer.wordnik.com/](http://developer.wordnik.com/) ) 也非常适合用于单词定义。

# python - 字典键的有序更改（Python）

> ID：14880908
> 
> 赞同：0
> 
> 时间：2013-02-14T17:45:46.177
> 
> 标签：python, dictionary

我知道可以更改字典中的键。但是是否可以使用定义的模式更改所有键？在这种情况下，我有一本字典，其中包含：

```
{'>Apple': 'Orange', '>Grape': 'Hopz'} 
```

**问题：**所有键都包含一个 '>' + 字符串。我可以删除这些“>”并更新吗？还是不带“>”更新？

**小背景：** 在我的脚本中，我尝试将一个字典值与此示例键进行比较，这会导致错误。我认为这是由于 '>' 因为 v =! k 如果 k = '>foo' 和 v = 'foo'

如果你们中的任何一个是科学家，那么这个“>”是 fasta 解析器的结果。我可能只是将脚本更改为不在行首写“>”（我还没有尝试过）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T17:48:15.113

使用 dict 理解很容易：

```
updateddict = {k.lstrip('>'): v for k, v in yourdict.iteritems()} 
```

对于 Python 2.7。对于 Python 3，请`yourdict.items()`改用。

对于 Python 2.6 及更早版本，尚无 dict 理解语法，请使用：

```
updateddict = dict((k.lstrip('>'), v) for k, v in yourdict.iteritems()) 
```

[`str.lstrip()`](http://docs.python.org/3/library/stdtypes.html#str.lstrip)`>`是一种从键的开头删除任何字符的快速简洁的方法。

# dns - BIND DNS 区域转发器与 NS 类型记录

> ID：14880911
> 
> 赞同：1
> 
> 时间：2013-02-14T17:45:52.217
> 
> 标签：dns, bind

`type foward;`将 DNS 区域设置为 have和在区域文件中为另一个名称服务器设置 NS 记录之间有很大区别吗？有更好的性能/速度吗？还是我完全没有抓住重点，它们完全不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-12T17:33:02.813

所以这两种情况是有区别的...添加 NS 记录是创建一个委托（当您对父区域具有权威时，您只能对子区域这样做，添加转发器就是这样。性能/速度并不是真的进入它，因为它们用于不同的目的。

当您希望将子区域的管理委托给另一台服务器时，可以使用委托。例如，您拥有 corp.com，您可以将engineering.corp.com 的子区域委托给工程团队的名称服务器。这就是整个 Internet DNS 层次结构的工作方式，区域是从根向下委派的。

当您想将查询直接反弹到负责特定域的特定名称服务器时，使用条件转发。如果 corp.com 的所有者购买了 company.com，那么在合并阶段，当您希望两家公司都可以使用内部 DNS 访问时，您可能希望在对方的名称服务器中为每个公司添加转发器，然后服务器知道将查询转发到哪里直接而不是遍历 Internet 层次结构并获取任一公司的外部名称服务器。

史蒂夫

# c# - 在 .NET 中使用 Google 自定义搜索 API 的步骤

> ID：14880921
> 
> 赞同：8
> 
> 时间：2013-02-14T17:46:30.417
> 
> 标签：c#, .net, google-custom-search

我正在尝试在我的 .NET 项目中使用 Google 自定义搜索 API。我有我公司提供的 API 密钥。我使用我的 Google 帐户创建了一个自定义搜索引擎并复制了“cx”值。

我正在使用以下代码：

```
string apiKey = "My company Key";
string cx = "Cx";
string query = tbSearch.Text;

WebClient webClient = new WebClient();
webClient.Headers.Add("user-agent", "Only a test!");

string result = webClient.DownloadString(String.Format("https://www.googleapis.com/customsearch/v1?key={0}&cx={1}&q={2}&alt=json", apiKey, cx, query)); 
```

我收到以下错误：“远程服务器返回错误：(403) Forbidden。”

我也尝试过以下代码：

```
Google.Apis.Customsearch.v1.CustomsearchService svc = new Google.Apis.Customsearch.v1.CustomsearchService();
svc.Key = apiKey;

Google.Apis.Customsearch.v1.CseResource.ListRequest listRequest = svc.Cse.List(query);
listRequest.Cx = cx;
Google.Apis.Customsearch.v1.Data.Search search = listRequest.Fetch();

foreach (Google.Apis.Customsearch.v1.Data.Result result1 in search.Items)
{
   Console.WriteLine("Title: {0}", result1.Title);
   Console.WriteLine("Link: {0}", result1.Link);
} 
```

在这里，我在 Fetch() 处得到以下异常：

Google.Apis.Requests.RequestError 访问未配置 [403] 错误 [消息 [访问未配置] 位置 [-] 原因 [accessNotConfigured] 域 [usageLimits]

是否需要 CX 参数？我是否因为使用公司提供的密钥并使用我的 Google 帐户使用自定义搜索引擎中的 CX 参数而收到错误？

有没有其他方法可以获得'cx'？我们不想展示 Google AD。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-05-01T17:36:33.953

我不确定你是否仍然对此感兴趣。

要获得没有广告的结果，您需要付费。 [信息@谷歌](http://support.google.com/customsearch/bin/answer.py?hl=en&answer=72326&ctx=cb&src=cb&cbid=1pte6z18mbci6&cbrank=1)

是的，cx 是必需的，因为它指定了您要用于搜索的 google 自定义搜索引擎。[您可以从此谷歌页面](http://www.google.com/cse/create/new)创建自定义搜索引擎

这是检索当前 api 版本 1.3.0-beta 的搜索结果的当前代码

```
 string apiKey = "Your api key";
        string cx = "Your custom search engine id";
        string query = "Your query";

        var svc = new Google.Apis.Customsearch.v1.CustomsearchService(new BaseClientService.Initializer { ApiKey = apiKey });
        var listRequest = svc.Cse.List(query);

        listRequest.Cx = cx;
        var search = listRequest.Fetch();

        foreach (var result in search.Items)
        {
            Response.Output.WriteLine("Title: {0}", result.Title);
            Response.Output.WriteLine("Link: {0}", result.Link);
        } 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-12-12T12:03:36.227

代替，

```
var search = listRequest.Fetch(); 
```

但现在它不支持 Fetch() 方法，而需要使用 Execute() 方法。

```
var search = listRequest.Execute(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-07-25T08:31:24.327

```
var listRequest = svc.Cse.List(query); 
```

错误 ！！！你应该使用：

```
var listRequest = svc.Cse.List(); 
```

接着 ：

```
listRequest.Q=query 
```

# ajax - 无法在具有淘汰赛的控制器中接收 json 数据

> ID：14880928
> 
> 赞同：0
> 
> 时间：2013-02-14T17:46:50.087
> 
> 标签：ajax, json, model-view-controller, knockout.js

我是敲除和 mvc 的新手，所以我需要一些帮助，我的问题是我的下拉列表正在从服务器成功填充，并且单击保存按钮调用控制器中的保存方法。但问题是在控制器中我无法接收 json 数据，即它为空。这是我的代码

```
 var initialData = @Html.Raw( new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model)); 

    var viewModel = function(){
        var self = this;
        self.HomeAgencies = ko.observableArray(initialData.HomeAgencies);
        self.selectedOrgUnit = ko.observable();
        self.Save = function () {
                                    $.ajax({
                                    url: "@Url.Action("Save")",
                                    type: "POST",
                                    data: ko.toJSON(this),
                                    contentType: "application/json; charset=utf-8",
                                    dataType:"json",
                                    success: function(result) {alert(result.message)}
                                    });
                                }
    }

    var vm = new viewModel();
    ko.applyBindings(vm); 
```

在控制器中我有以下代码

public JsonResult Save(string someData) { var message = string.Format("Saved {0} ", "successfully"); 返回 Json(新 { 消息 }); }

string someData 始终为空，我期待一些 json 数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:23:05.600

尝试替换数据中的`this`to`self`并引入字段名称并删除 contentType。

```
$.ajax({
    url: '@Url.Action("Save")',
    type: 'POST',
    data: { someData: ko.toJSON(self) },
    dataType: 'json',
    success: function (result) { alert(result.message); }
}); 
```

在您的情况下，方法的上下文可以从您的对象更改为调用它们方法的 html 元素或窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:11:10.450

问题解决了。问题出在控制器方面，在控制器的操作中传递相同的模型类而不是手动解析 json。

# sql - SQL 在 SQL 联合中将 varchar 转换为 clob

> ID：14880930
> 
> 赞同：2
> 
> 时间：2013-02-14T17:47:00.420
> 
> 标签：sql, oracle

为什么oracle不允许以下查询

```
select to_clob(1) from dual
union
select wm_concat(sysdate) from dual; 
```

`wm_concat`返回一个clob。为了使联合中的两个查询具有相同类型的列，我将第一个查询中的列转换为 clob，但 Oracle 给了我一个`[1]: ORA-00932: inconsistent datatypes: expected - got CLOB`错误，即使两者都返回一个 clob 值。

每个查询都单独工作，并且都返回一个 clob 值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T17:59:08.707

我不相信`wm_concat`返回一个`CLOB`.

这表明回报`Typ=1`是`VARCHAR2`

```
SQL> select dump(wm_concat(sysdate)) from dual;

DUMP(WM_CONCAT(SYSDATE))
--------------------------------------------------------------------------------
Typ=1 Len=9: 49,52,45,70,69,66,45,49,51 
```

如果您创建一个视图，您也可以看到

```
SQL> ed
Wrote file afiedt.buf

  1  create view vw_wm_concat
  2  as
  3* select wm_concat(sysdate) col from dual
SQL> /

View created.

SQL> desc vw_wm_concat;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 COL                                                VARCHAR2(4000) 
```

如果将`VARCHAR2`返回的 by`WM_CONCAT`转换为 a `CLOB`，则下一个问题是 Oracle 不支持对执行 a所需`DISTINCT`的`CLOB`列执行 a `UNION`。假设您真的不需要删除重复的行，您可以使用 a`UNION ALL`而不是 a `UNION`。

将两者放在一起，就像这样

```
SQL> ed
Wrote file afiedt.buf

  1   select to_clob(1) from dual
  2   union all
  3* select to_clob(wm_concat(sysdate)) col from dual
SQL> /

TO_CLOB(1)
------------------------------------------------------------
1
14-FEB-13 
```

将工作

# ruby - 如何更新 Ruby on Rails 3 中的多个列？

> ID：14880931
> 
> 赞同：14
> 
> 时间：2013-02-14T17:47:01.230
> 
> 标签：ruby, ruby-on-rails-3, ruby-on-rails-3.2

只是出于好奇，有没有办法说这个......

```
user.update_column(:field1, true)
user.update_column(:field2, true) 
```

... Ruby on Rails 的一行代码？

据我所知，`update_columns`方法不存在...

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-08-15T12:23:50.303

您可以`update_all`按如下方式使用：

```
User.where(:id => user.id).update_all({:field1 => true, :field2 => true}) 
```

这将生成以下更新语句（mysql）：

```
UPDATE users SET field1 = 1, field2 = 1 WHERE users.id = <whatever> 
```

不会运行回调和验证。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-05-13T19:21:17.330

> **注意**：这仅在 ActiveRecord`v4.0.2`和更高版本中可用：

你可以这样做：

```
update_columns(field1: value, filed2: value) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T18:02:07.607

这样做怎么样：

```
user.attributes = attributes
user.save(validate: false) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-06T22:19:51.963

如果您需要速度，您也可以直接在 AR 连接上调用执行。我用这样的东西来导入大量数据。

```
connection = ActiveRecord::Base.connection
email = connection.quote(email)
zip = connection.quote(zip)
connection.execute(%{UPDATE "users" SET "email" = #{email}, "zip" = #{zip} WHERE "users"."id" = #{user.id}}) 
```

请注意，不会运行验证和回调。

复制自[https://stackoverflow.com/a/25171127/1520775](https://stackoverflow.com/a/25171127/1520775)

# php - 新控制器中的 Zend Framework 404 错误问题

> ID：14880933
> 
> 赞同：1
> 
> 时间：2013-02-14T17:47:05.970
> 
> 标签：php, zend-framework, controller, http-status-code-404

我对 ZF 很陌生，我正在开发一个已经构建的应用程序。我的任务是在应用程序中创建 Web 服务。我已经在本地设置了应用程序并且它工作正常。所以我添加了一个新的控制器，并且可以在localhost中访问，但是当我尝试在服务器中访问相同的控制器时，会导致404错误，但可以完美访问其他控制器。

AllowOverride All 和 Apache mod_rewrite 在服务器中启用。有没有人对这个问题有任何想法。我在这个错误中坐了 2 天..

```
 <VirtualHost *:80>
          DocumentRoot /path/to/site/public
          ServerName sitename.com
          ServerAlias www.sitename.com
       <Directory /path/to/site/public>
          AllowOverride All
       </Directory>
    </VirtualHost> 
```

控制器代码：

```
class APIController extends Zend_Controller_Action
{

    public function init()
    {
        /* Initialize action controller here */

    }

    public function indexAction()
    {

        // Setup REST server
        $server = new Zend_Rest_Server();
    $server->setClass('APIHandlerClass');
    $server->handle();
    exit;
    }

} 
```

我正在使用 url **site.com/API**访问它，它会在实际情况下显示一个 XML。

**编辑**：

我已经在本地 linux 系统中设置了应用程序，我发现问题与 linux 有关。

我尝试了以下方法：

1.  创建了一个导致 404 的新控制器。

2.  复制现有控制器并重命名原始控制器的名称。然后我更改了复制控制器中的代码。我访问了我的控制器并且它起作用了！

3.  复制现有控制器并重命名复制的控制器。我用新名称调用复制的控制器，显示 404 错误。

我的问题是我是否需要在任何地方指定新的控制器名称！？我没有找到任何关于此的文档，我什至为控制器创建了视图文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T09:07:30.463

如果应用程序在 Windows 本地运行，但在运行 Linux 的测试服务器上无法运行，则可能是区分大小写的问题。检查文件夹的大小写，包括控制器文件夹和视图/脚本文件夹（都应该是小写）。

# c++ - 我正在尝试使用模板可变参数将 lambda 作为参数传递

> ID：14880934
> 
> 赞同：1
> 
> 时间：2013-02-14T17:47:07.310
> 
> 标签：c++, templates, c++11, lambda

我仍在为一些 C++ 语法而苦苦挣扎。
这次我想用 lambda 添加额外的参数。但是为了使代码通用，我希望能够接受任何函数及其参数：

```
#include <functional>
#include <exception> 

template<typename R>
class Nisse
{
    private:
        Nisse(Nisse const&)             = delete;
        Nisse(Nisse&&)                  = delete;
        Nisse& operator=(Nisse const&)  = delete;
        Nisse& operator=(Nisse&&)       = delete;
    public:
        //Nisse(std::function<R()> const& func) {}  // disable for testing

        template<typename... Args>
        Nisse(std::function<R(Args...)> const& func, Args... a) {}
};

int main()
{
    // I  was hoping this would deduce the template arguments.
    Nisse<int>   nisse([](int a,double d){return 5;},12,12.0);
} 
```

这会产生：

```
> g++ -std=c++0x Test.cpp 
Test.cpp:21:61: error: no matching function for call to ‘Nisse<int>::Nisse(main()::<lambda(int, double)>, int, double)’
Test.cpp:21:61: note: candidate is:
Test.cpp:16:9: note: template<class ... Args> Nisse::Nisse(const std::function<R(Args ...)>&, Args ...) 
```

我尝试明确指定模板类型：

```
 Nisse<int>   nisse<int,double>([](int a,double d){return 5;},12,12.0); 
```

但这（令我惊讶）是一个语法错误：

```
> g++ -std=c++0x Test.cpp 
Test.cpp: In function ‘int main()’:
Test.cpp:21:23: error: expected initializer before ‘&lt;’ token
Test.cpp:21:65: error: expected primary-expression before ‘,’ token
Test.cpp:21:73: error: expected ‘;’ before ‘)’ token 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T18:00:56.833

您不能`std::function`从 lambda 推断模板参数。接受任意可调用对象的常用方法是通过通用引用：

```
 template<typename F, typename... Args,
      typename = typename std::enable_if<std::is_convertible<
        decltype(std::declval<F>()(std::declval<Args>()...)), R>::value>::type>
    Nisse(F &&f, Args... a): Nisse(std::function<R()>(std::bind(f, a...))) {} 
```

最后一个（匿名的，默认的）模板参数在这里用来验证第一个模板参数是函数式的，并返回一个 R 类型的结果。

```
std::enable_if<std::is_convertible<
    decltype(std::declval<F>()(std::declval<Args>()...)), R>::value>::type 
```

正如@Yakk 在下面的评论中所描述的 上面的表达式检查 F 是一个函数类型，其结果是 R。如果它有效，那么一切都很好。如果失败，则会生成编译时错误（注意：这使用[SFINAE](http://en.wikipedia.org/wiki/Substitution_failure_is_not_an_error)）。

对于方法，SFINAE 被插入到返回类型中，但对于构​​造函数，这不是一个选项；历史上添加了一个额外的默认构造函数参数，但添加一个默认模板参数更优雅，因为它根本不会更改构造函数签名。匿名模板参数的 SFINAE 在可变参数模板参数之后特别有吸引力，因为用户无法（意外？）覆盖默认值。

# javascript - 为什么画布线不可见？

> ID：14880936
> 
> 赞同：1
> 
> 时间：2013-02-14T17:47:17.687
> 
> 标签：javascript, html, math, canvas

我正在 HTML5 Canvas 上构建一个旋转超立方体，但在此之前，我遇到了 Canvas 的基本困难。我有一个白色/未着色的画布，我试图在将 fillStyle 和 strokeStyle 设置为“#000000”后画线，但我还没有成功地让画布上的任何像素都显示为白色以外。

画布位于[http://blajeny.com/tesseract.html](http://blajeny.com/tesseract.html)，部分数学和部分老式 JavaScript 的 JavaScript 位于[http://blajeny.com/js/tesseract.js](http://blajeny.com/js/tesseract.js)。日志说它正在画布上画线，其中一些应该与 500x500 画布相交，其中一些应该完全位于画布内，但我能看到的只是纯白色。

它的数学方面需要在从高维到低维表面的投影方面工作。然而，我现在要解决的困难是一个基本的 HTML5 画布问题，因为我正在设置颜色，移动到并绘制一条线来协调其中一些重叠，其中一些在 500x500 画布内，并且看不到任何东西黑色的。（JavaScript 控制台记录了我尝试绘制的线条。）

我怎样才能让我试图绘制的线条显示出来？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:19:36.160

您需要让画布知道何时使用 context.beginPath() 和 context.stroke()/context.fill() 开始和停止绘图。这是代码和小提琴：http: [//jsfiddle.net/m1erickson/Jw8XU/](http://jsfiddle.net/m1erickson/Jw8XU/)

```
<!DOCTYPE HTML>
<html>
  <head>
    <style>
      canvas{border:1px solid red;}
    </style>
  </head>
  <body>
    <canvas id="canvas" width="300" height="300"></canvas>
    <script>
      var canvas = document.getElementById('canvas');
      var ctx = canvas.getContext('2d');

      ctx.beginPath();
      ctx.moveTo(50, 75);
      ctx.lineTo(150, 150);
      ctx.stroke();
    </script>
  </body>
</html> 
```

# c# - 事件位于从网格中的 ActiveEditor 更新数据源之后立即发生的事件

> ID：14880938
> 
> 赞同：0
> 
> 时间：2013-02-14T17:47:26.610
> 
> 标签：c#, .net, devexpress, xtragrid, xtraeditors

我需要做的是根据网格中其他字段的值计算网格中一个字段的值。我需要在一个依赖单元格中的值更改后运行此计算，但前提是该值是有效条目。编辑器/存储库的`EditValueChanged`、`Validating`和`Validated`事件都发生在数据回发到数据源之前。我想知道是否有任何可以挂钩的事件允许我在数据回发到数据源之后、但在控制权返回给用户之前触发这个计算。

**示例代码**

```
//calculation functions
private void SetCalcROP(MyObjectt Row)
{
    //rop = m/hr
    TimeSpan ts = Row.ToTime - Row.FromTime;
    double diffDepth = Row.EndDepth - Row.StartDepth;

    if (ts.TotalHours > 0)//donot divide by 0
        Row.ROP = diffDepth / ts.TotalHours;
    else
        Row.ROP = 0;
}

private void SetCalcDeltaP(MyObject Row)
{
    Row.DeltaPress = Row.SPPOnBtm - Row.SPPOffBtm;
}

//events
private void repNumberInput_Validated(object sender, EventArgs e) //is actaully ActiveEditor_Validated
{
    if (vwDDJournal.FocusedColumn.Equals(colSPPOff) || vwDDJournal.FocusedColumn.Equals(colSPPOn))
        SetCalcDeltaP(vwDDJournal.GetFocusedRow() as MyObject);
}

private void repNumberInput_NoNulls_Validated(object sender, EventArgs e) //is actaully ActiveEditor_Validated
{
    if (vwDDJournal.FocusedColumn.Equals(colStartDepth) || vwDDJournal.FocusedColumn.Equals(colEndDepth))
        SetCalcROP(vwDDJournal.GetFocusedRow() as MyObject);
}

private void repTimeEdit_Validated(object sender, EventArgs e) //is actaully ActiveEditor_Validated
{
    SetCalcROP(vwDDJournal.GetFocusedRow() as MyObject);
}

private void repNumberInput_NoNulls_Validating(object sender, System.ComponentModel.CancelEventArgs e)
{
    TextEdit TE = sender as TextEdit;
    //null is not valid for this entry;
    if (string.IsNullOrEmpty(TE.Text))
    {
        e.Cancel = true;
        vwDDJournal.SetColumnError(vwDDJournal.FocusedColumn, "This Column may not be blank");
        return;
    }
    else
    {
        double tmp;
        if (!Double.TryParse(TE.Text, out tmp))
        {
            e.Cancel = true;
            vwDDJournal.SetColumnError(vwDDJournal.FocusedColumn, "This Column must contain a number");
            return;
        }
    }
}

private void repNumberInput_Validating(object sender, System.ComponentModel.CancelEventArgs e)
{
    TextEdit TE = sender as TextEdit;
    //null is not valid for this entry;
    if (!string.IsNullOrEmpty(TE.Text))
    {
        double tmp;
        if (!Double.TryParse(TE.Text, out tmp))
        {
            e.Cancel = true;
            vwDDJournal.SetColumnError(vwDDJournal.FocusedColumn, "This Column must contain a number");
            return;
        }
    }
}

private void repTimeEdit_Validating(object sender, System.ComponentModel.CancelEventArgs e)
{
    if (vwDDJournal.FocusedColumn.Equals(colToTime))
    {//dont bother to check from time
        //TIME TRAVEL CHECK!!!!
        DateTime FromTime = Convert.ToDateTime(vwDDJournal.GetRowCellValue(vwDDJournal.FocusedRowHandle, colFromTime));
        TimeEdit te = sender as TimeEdit;
        DateTime ToTime = Convert.ToDateTime(te.EditValue);
        if (ToTime < FromTime)
        {//TIME TRAVEL
            e.Cancel = true;
            vwDDJournal.SetColumnError(vwDDJournal.FocusedColumn, "To Time must be greater than From Time");
            return;
        }
    }
} 
```

问题是，无论我从哪里调用它，无论我使用`vwDDJournal.GetRowCellValue(...)`or `vwDDJournal.GetFocusedRow() as MyObject`，我仍然得到旧的编辑值。

**要求**

在运行计算之前，我必须验证输入。进行更改后，我必须立即运行计算。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:21:55.853

怎么样`CustomCellValue`？

回发到数据源后刷新数据。

每当更新数据或更改视图时都会调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T04:26:17.007

> ...我需要做的是根据网格中其他字段的值计算网格中一个字段的值。

完成此任务的最佳方法是使用[未绑定列](http://help.devexpress.com/#WindowsForms/CustomDocument1477)功能。

以下示例演示了如何通过处理[ColumnView.CustomUnboundColumnData](http://help.devexpress.com/#WindowsForms/DevExpressXtraGridViewsBaseColumnView_CustomUnboundColumnDatatopic)事件来实现此功能：

```
// Provides data for the Total column.
void gridView1_CustomUnboundColumnData(object sender, CustomColumnDataEventArgs e) {
   if (e.Column.FieldName == "Total" && e.IsGetData) e.Value = 
     getTotalValue(e.ListSourceRowIndex);
}
// Returns the total amount for a specific row.
decimal getTotalValue(int listSourceRowIndex) {
    DataRow row = nwindDataSet.Tables["Order Details"].Rows[listSourceRowIndex];
    decimal unitPrice = Convert.ToDecimal(row["UnitPrice"]);
    decimal quantity = Convert.ToDecimal(row["Quantity"]);
    decimal discount = Convert.ToDecimal(row["Discount"]);
    return unitPrice * quantity * (1 - discount);
} 
```

原始示例：[如何：添加存储任意数据的未绑定列](http://help.devexpress.com/#WindowsForms/CustomDocument3008)

您还可以使用[表达式](http://help.devexpress.com/#WindowsForms/CustomDocument6211)实现未绑定列的计算值：

```
GridColumn columnTotal = new GridColumn();
columnTotal.FieldName = "Total";
columnTotal.Caption = "Total";

columnTotal.UnboundType = DevExpress.Data.UnboundColumnType.Decimal;
columnTotal.UnboundExpression = "[Quantity] * [UnitPrice] * (1 - [Discount])";

gridView1.Columns.Add(columnTotal); 
```

# css - 文字后面的背景图片

> ID：14880939
> 
> 赞同：0
> 
> 时间：2013-02-14T17:47:27.937
> 
> 标签：css, background, background-image

我正在尝试在每个段落的星期几之后显示图像，但仅显示部分背景图像。我以前尝试过填充，但可以使用一些帮助，因为我是 css 方面的新手。

html是：

```
 <section id="top">
    ...
    <p><span>Mon</span><span>Open</span></p>
    <p><span>Tues</span><span>6:30 pm</span>Bible Study</p>... 
```

CSS是：

```
 #top p span:nth-child(1){
    font-family: 'Quintessential', cursive;
    font-size:25px;
    font-weight:normal;
    color:#fff;
    line-height: 59px;
    background-image:url('img/ribbon.png');
    background-repeat:no-repeat;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:51:37.927

SPAN 正在显示 DISPLAY: INLINE; 默认情况下。

尝试设置为 DISPLAY: INLINE-BLOCK;

以下是有关它们为何以这种方式工作的更多信息： [http ://www.webdesignfromscratch.com/html-css/css-block-and-inline/](http://www.webdesignfromscratch.com/html-css/css-block-and-inline/)

# microstrategy - 我怎么知道哪个对象阻止我保存？

> ID：14880942
> 
> 赞同：0
> 
> 时间：2013-02-14T17:47:38.843
> 
> 标签：microstrategy

我正在开发带有 Microstrategy Server 8.1 的 Microstrategy 8.1.525.151 客户端。在创建报告时，我删除了一些对象，之后，每次我尝试创建或更改任何对象（报告、过滤器、属性）时，我在尝试保存时都会遇到相同的错误

错误是

'无法保存、移动或复制此对象，因为它已在元数据中更改'

我尝试在客户端和服务器中刷新架构，删除并重新创建对象（它仅在服务器上有效，但在客户端上不刷新）以及菜单管理/服务器/清除缓存对象

除了 Microstrategy 知识库（我无法访问）之外，我发现的所有内容都提到了更改多个对象，但是我不知道哪些对象可能导致此错误（如果有的话）

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T17:46:56.010

如果您无法创建/保存任何其他对象，恐怕您的元数据已损坏。

MicroStrategy 提供了一些实用程序来修复它们，但我认为它们仍然不支持 8.1 版。最好的办法是尝试使用 MicroStrategy 技术支持。

你是唯一一个有这个问题的人吗？其他用户可以修改对象吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T21:03:32.740

我用来解决它的方法是删除自从我开始遇到这样的问题以来我创建的所有属性和报告（这更容易，因为它们都在一个用于属性的文件夹和一个用于报告的文件夹中，我怀疑在某些情况下其他对象也需要删除）也重新启动了情报服务器

# javascript - Javascript自动解析嵌套对象

> ID：14880943
> 
> 赞同：0
> 
> 时间：2013-02-14T17:47:41.523
> 
> 标签：javascript, ajax, json, object

这更像是一个程序问题，而不是其他任何事情。我很好奇为什么会发生这种情况，我似乎在 ECMA 脚本文档中找不到任何关于此“功能”的文档。

当我在 jQuery 中对我的服务器进行 AJAX 调用时，它会向页面返回以下 JSON 响应：

```
{"version":"v1","status":"OK","timestamp":"2013-02-14 10:32:45","data":"true","error":""} 
```

有了这个字符串，我必须调用 jQuery.parseJSON(string); 将其作为对象获取，并且能够将其作为对象引用。

但是，当我的服务器返回如下内容时：

```
{"version":"v1","status":"OK","timestamp":"2013-02-14 10:12:19","data":{"a":"asgsadfga","b":false,"c":[]},"error":""} 
```

Javascript 会自动加载这个对象而不需要解析。看起来因为这个例子返回了一个嵌套对象，尽管它是作为字符串从服务器返回的，Javascript 会立即识别出来，并为我解析字符串。

这是预期的功能吗，如果是这样，有人可以指出我的文档吗？

编辑：

这是有问题的 AJAX 调用：

```
 jQuery.ajax({
        url: url,
        type: 'GET',
        async: false,
        success: function (result) {
            console.log(result)
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T17:49:24.713

确保您的服务器设置正确的 Content-Type 响应 HTTP 标头：

```
Content-Type: application/json 
```

这样 jQuery 会自动将服务器返回的 JSON 字符串解析为一个 javascript 对象，该对象将作为参数传递给您的成功回调。

或者，如果由于某种原因您有一些无法控制的损坏的服务器端脚本，您可以设置`dataType`参数以强制 jQuery 将结果解析为 JSON：

```
$.ajax({
    url: '/script.cgi',
    type: 'POST'
    dataType: 'json',
    success: function(result) {
        // result will be a javascript object 
    }
}); 
```

但显然正确的做法是修复您的服务器端脚本以返回正确的 Content-Type 响应标头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:55:28.713

根据**dataType**下 jQuery API Documentation 中的 ajax() ：

> dataType（默认值：Intelligent Guess（xml、json、script 或 html））Type：String 您期望从服务器返回的数据类型。**如果没有指定，jQuery 将尝试根据响应的 MIME 类型推断它（XML MIME 类型将产生 XML，在 1.4 中 JSON 将产生 JavaScript 对象**，在 1.4 中脚本将执行脚本，其他任何内容都将是作为字符串返回）。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T17:52:52.223

您应该指定`dataType`在`json`您的`$.ajax`通话中。dataType 是您希望从服务器接收的 MIME。contentType 是服务器对您的期望。

# plc - 开始PLC编程

> ID：14880948
> 
> 赞同：3
> 
> 时间：2013-02-14T17:47:56.747
> 
> 标签：plc

我对 PLC 编程越来越感兴趣，我的想法是尝试一下。因此我需要模拟一些真实的系统，因为它很快就会寻找一些硬件。这就是我希望这样做的方式（示例）：

1.  模拟一些真实的系统，即。带有放气阀和进水阀的水箱，当然还有一些水位传感器。这些由PLC控制和检查。

2.  用于控制阀门并从传感器获取值的 PLC 模拟器。还将数据发送到一些 HMI/SCADA (PLCsim ?)

3.  一些将逻辑编程到PLC中的软件。（第 7 步？）

4.  一些 GUI 供最终用户手动检查值和控制阀（InTouch ?、ControlWeb ?、WinCC ?、LabView ?）

我不知道这是否完全可以通过使用软件以及是否有机会起作用。感谢您的建议和想法。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T22:30:47.657

确实。如果钱是个问题，AutomationDirect.com 有一个名为 Do-more 的新产品，其中的编程软件是免费的（称为 Designer），它带有一个免费的 PLC 模拟器。

然后，我建议编写单独的代码块来模拟“过程”，其中代码块根据输出状态从输出（离散和模拟）读取并写入输入（离散和模拟）（和时间，以及随机的外部事件——想想蝴蝶效应）。

披露：我在 Do-more 的开发人员 Host Engineering 工作。

如果钱不是问题，我知道那里有很多 PLC 模拟器和过程模拟器软件可能有人可以推荐。

# c# - 如何使用枚举作为数据源？

> ID：14880949
> 
> 赞同：1
> 
> 时间：2013-02-14T17:47:56.370
> 
> 标签：c#, combobox, enums, datasource

我想使用枚举中的值作为某些组合框的来源。这会编译，但不会填充组合框：

```
private enum ValueType { Text, Barcode }

private ValueType vt;

private void FormCPCLCodeGenUtil_Load(object sender, EventArgs e)
{
    comboBoxType1.DataSource = vt;
} 
```

...这不应该让我感到惊讶，因为 vt 没有被赋值；而且我不希望组合框只有一个值。那么我该怎么做（或者有比使用枚举作为数据源更好的方法）？

## 更新

一个附带问题：当多个组合框将使用相同的数据源时，其中哪一个更好：

```
 comboBoxType1.DataSource = Enum.GetNames(typeof(ValueType)); 
    comboBoxFontSize1.DataSource = Enum.GetNames(typeof (FontSizeType));
    comboBoxAlign1.DataSource = Enum.GetNames(typeof(AlignOptions));

    //comboBoxType2.DataSource = comboBoxType1.DataSource; 
    comboBoxType2.DataSource = Enum.GetNames(typeof(ValueType)); 
```

（使用之前分配的组合框数据源作为自己的数据源，还是以与前一个相同的方式连接？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T17:50:13.113

你可以试试这个

```
comboBoxType1.DataSource= Enum.GetNames(typeof(ValueType)); 
```

# .net - OData WebAPI Action的参数反序列化

> ID：14880960
> 
> 赞同：3
> 
> 时间：2013-02-14T17:48:41.573
> 
> 标签：.net, web-services, asp.net-web-api, odata

尝试使用 OData webAPI 并使用参数调用操作，将其序列化为没有元信息的 json。所以，我想传递一个类型的对象：

```
public class SomeRequest
{
    public RequestReason Reason { get; set; }
}

public enum RequestReason
{
    New,
    Dublicate
} 
```

我创建了一个 mdel，配置了一个动作：

```
var action = modelBuilder.Entity<Member>().Action("SomeRequest");
action.Parameter<SomeRequest>("Info");
action.Returns<HttpResponseMessage>();
var model = modelBuilder.GetEdmModel();
configuration.EnableOData(model); 
```

在控制器中有代码：

```
[HttpPost]
public HttpResponseMessage RequestIDCard(int key, [FromBody]ODataActionParameters param)
{
    object value;
    param.TryGetValue("Info", out value);
///!!!!
} 
```

并期望具有真实类型 SomeRequest 的价值，转换类型并处理它...然后我发出带有标头的 POST 请求

> 内容类型：application/json;json=light; charset=utf-8 接受：application/json;odata=light

与身体

> {“信息”：{“原因”：1}}

但是我得到了“Newtonsoft.Json.Linq.JObject”类型的对象，并且确定它不能被投射！但是，如果我将对象类型更改为 int，一切正常 :) 是 WebAPI OData 的错误还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T17:59:05.877

你的用法有几个问题，

1.  枚举映射到 aspnet Web API OData 中的字符串。因此，您的请求正文应该有 { "Reason" : 'Duplicate' 代替。
2.  正如 Jen 已经指出的那样， application/json;odata=light 不是受支持的媒体类型。您可能想使用 'application/json;odata=minimalmetadata' 或只是 'application/json'。
3.  action.Returns< HttpResponseMessage > 没用。这会将 HttpResponseMessage 映射为服务的 EDM 模型中的复杂类型。我不确定映射会是什么样子。通常，您希望在您正在构建的 EDM 模型中公开模型中的类型。您应该从模型中选择更具体的类型，更像是，

    action.Returns<IDCard>();

# mysql - 试图理解和优化 mysql 查询

> ID：14880966
> 
> 赞同：1
> 
> 时间：2013-02-14T17:48:55.660
> 
> 标签：mysql

我们在下面有一个查询。它在根据日期搜索最新培训的情况下运行良好。我想了解为什么我们放 B1.driverTrainingDate< B2.driverTrainingDate 而不是相反，而且 B2.driverID 也为空。是否有任何其他选项可以改进此查询？

```
SELECT driver.driverID,b.driverTrainingDate
 FROM   driver
             LEFT JOIN (
  SELECT B1.*
                      FROM   dTraining AS B1
                             LEFT JOIN  dTraining AS B2
                                    ON B1.driverID = B2.driverID
                                       AND B1.cTrainingID = B2.cTrainingID 
                                       AND B1.driverTrainingDate< B2.driverTrainingDate
                      WHERE B1.cID=".$cTID." And B2.driverID IS NULL) as b
ON ( driver.driverID= b.driverID) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:52:42.383

我认为这是打算返回在完整记录之前但具有空驾驶员 ID 的培训日期。

“反过来”将意味着……如果该数据模式甚至存在的话。

# xslt - XSLT 模板模式 - xpath 评估

> ID：14880968
> 
> 赞同：2
> 
> 时间：2013-02-14T17:49:00.727
> 
> 标签：xslt, xpath

我想根据源 XML 的属性动态更改应用模板模式，如下所示：

```
<xsl:choose>
    <xsl:when test="@myAttribute">
        <xsl:apply-templates select="." mode="@myAttribute"/>
    </xsl:when>
    <xsl:otherwise>
        <xsl:apply-templates select="." mode="someOtherMode"/>
    </xsl:otherwise>
</xsl:choose> 
```

是否可以在 mode 属性中评估 XPath？还有其他方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T17:56:24.150

不，没有办法为`mode`属性使用动态值。它必须是静态的。在您的情况下，我建议您执行以下操作（使用名称**myNode**作为上面示例的上下文节点）：

```
<xsl:template match="myNode[@myAttribute = 'someValue']" mode="specialHandling">
   <!-- template contents -->
</xsl:template>

<xsl:template match="myNode[@myAttribute = 'someOtherValue']" mode="specialHandling">
   <!-- template contents -->
</xsl:template>

<xsl:template match="myNode[@myAttribute = 'aThirdValue']" mode="specialHandling">
   <!-- template contents -->
</xsl:template>

<xsl:template match="myNode[not(@myAttribute)]" mode="specialHandling">
   <!-- template contents -->
</xsl:template> 
```

那你甚至不需要那个`xsl:choose`。你可以这样做：

```
<xsl:apply-templates select="." mode="specialHandling" /> 
```

# clojure - Leiningen 2 没有在 localrepo 中查找？

> ID：14880973
> 
> 赞同：3
> 
> 时间：2013-02-14T17:49:05.637
> 
> 标签：clojure, leiningen

我正在使用 Leiningen 2，并且正在努力让它识别本地存储库 ($HOME/.m2)

我正在尝试使用不在 clojar 上的[storm-rdbms(storm-contrib)](https://github.com/nathanmarz/storm-contrib/tree/master/storm-rdbms)

以下是我采取的步骤：

1.  使用 lein-localrepo 插件，在 .m2 本地仓库下安装了storm-rdbms
2.  pom.xml 显示了这一点：

    ```
    <groupId>storm-rdbms</groupId>
    <artifactId>storm-rdbms</artifactId>
    <versioning>
        <versions>
          <version>0.1-SNAPSHOT</version>
        </versions>
    <lastUpdated>20130214173431</lastUpdated>
    </versioning> 
    ```

3.  我的 project.clj 文件：

    ```
     :dependencies [[org.clojure/clojure "1.4.0"]
                    [storm "0.8.2"]
                    [storm-rdbms "0.1-SNAPSHOT"]]
     :plugins [[lein-localrepo "0.4.1"]]
     :repositories {"local" ~(str (.toURI (java.io.File. "~/.m2")))}) 
    ```

4.  我运行 lein deps：

    ```
     Could not find artifact storm-rdbms:storm-rdbms:jar:0.1-SNAPSHOT
     This could be due to a typo in :dependencies or network issues.
     Could not resolve dependencies 
    ```

我也用 Maven 试过这个，但是 Maven 3 在按照[这里](http://stian.almaas.me/2012/08/adding-jars-to-local-repository-with.html)的指示时甚至无法安装 jar 。

请阐明我在这里做错了什么。非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:22:16.210

当您运行 mvn install 时，storm-rdbms 似乎不正确？在安装 jar 时安装一个 pom，这会阻止 lein 找到它。

这是我使用的完整步骤：

```
git clone git://github.com/nathanmarz/storm-contrib.git
cd storm-contrib/storm-rdbms/
mvn install
cp pom.xml ~/.m2/repository/storm/storm-rdbms/0.1-SNAPSHOT/storm-rdbms.pom  

cd ~/my-storm-project 
emacs project.clj and add this dep:
 [storm/storm-rdbms "0.1-SNAPSHOT"]
lein deps 
```

我不确定这是否是因为它是一个子项目。我无法构建父项目，因为当我检查它时，其他子项目之一被破坏了......

# html - 是否有一种“简单”的方法可以将巨大的 HTML 文件拆分为多个页面

> ID：14880974
> 
> 赞同：0
> 
> 时间：2013-02-14T17:49:25.003
> 
> 标签：html, logging

我得到了一个大约 306K 行的 html 日志文件。我知道有更好的格式，但希望能够在线查看文件。我认为将文件分解成更小的位和“分页”可能是除了手动执行以下操作之外的任何方式的方法：

*   获取初始页面的标题并复制到每个新文件
*   复制初始文件的 5-10k 行并粘贴到新正文中
*   复制初始文件的页脚并复制到每个新文件

然后给出 1.html、2.html、3.html 的基本命名约定，并在新页脚的每个页面上创建子链接。有没有一种自动化的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:57:58.030

You can use something like this

```
 text = document.getElementById('text').value; var pieces = new Array(); var total = Math.ceil(text.length/10000); for(i=0;i<total;i++){
pieces[i] = text.substr(([i]*10000),10000)); } 
```

then send it to a file(the way you want, ajax, or some write-txt)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T17:59:21.397

如果您的 html 文件格式正确（即带有换行符），您可以取出页眉和页脚并每隔 1000 行（或保证有意义数据的任何数量）拆分内容。这个声音可以通过 shell 脚本来实现。

# android - 带有 onDraw 或 ImageView 的 Android 动画？

> ID：14880978
> 
> 赞同：0
> 
> 时间：2013-02-14T17:49:32.493
> 
> 标签：android, animation, rotation, imageview, ondraw

我想创建一个安卓游戏。每次有人触摸显示器时，播放器应该上升，如果他松开，播放器应该下降。

在许多教程的帮助下，我让它工作了，但现在我想为它制作动画，但我被卡住了。这意味着玩家的图像应该每半秒改变一次。此外，当玩家上升时，应该创建一个动画旋转。

但是（经过数小时的谷歌搜索）我找不到任何有用的答案来解决我的问题。Android 开发者网站讨论了创建 ImageView 和 XML 文件。但这就是我卡住的地方：我没有 ImageView，我的播放器（我使用 PNG 文件）只是由 onDraw() 方法创建的：

```
public void onDraw(Canvas canvas) {
       for (Sprite s : sprites) {   
            canvas.drawBitmap(s.getGraphic(), s.getLocation().x,
                    s.getLocation().y, null);

        }
} 
```

现在我想问我应该如何做动画和动画旋转。我应该从 ImageView 开始，还是可以以某种方式将 onDraw 方法“转换”为 ImageView？还是有另一种方法可以在没有 ImageView 的情况下进行动画和动画旋转？

其次，如果我必须创建 ImageView，我不明白如何使播放器“动态”，即：当有人触摸显示器时改变位置。

提前致谢 ：）

编辑：

好的，我在 drawable 文件夹中创建了我的 animation.xml 文件：

```
<animation-list xmlns:android="http://schemas.android.com/apk/res/android" android:oneshot="false" android:id="@+id/splashAnimation">
<item android:drawable="@drawable/ship" android:duration="200" />
<item android:drawable="@drawable/ship_2" android:duration="200" />
</animation-list> 
```

在我的主文件中我添加了：

```
ImageView img = (ImageView) findViewById(R.id.splashAnimation);
    img.setBackgroundResource(R.drawable.animation);
    ship_anim= (AnimationDrawable) img.getBackground();
ship_anim.start(); 
```

但是，现在我收到错误消息： NullPointerException

问题出在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T18:17:32.753

如果你有描述动画的drawable，你总是可以像这样在你的drawable文件夹中创建xml，而不是将它添加`imageView`到布局中

```
 <?xml version="1.0" encoding="utf-8"?>
<animation-list xmlns:android="http://schemas.android.com/apk/res/android" >
<item android:drawable="@drawable/img1" android:duration="100" />
<item android:drawable="@drawable/img2" android:duration="100" />
<item android:drawable="@drawable/img3" android:duration="100" />
<item android:drawable="@drawable/mimg4" android:duration="100" />
<item android:drawable="@drawable/img5" android:duration="100" />   
</animation-list> 
```

它的代码如下所示：

```
myAnimation = (AnimationDrawable) findViewById(R.id.animation); 
```

仅添加事件处理程序

```
if (!isPlaying)
{
playDrawableAnimation();
    isPlaying = true;
} else
{
    faceAnimation.stop();
    isPlaying = false;

} 
```

# junit - Gradle：错误列出 junit#junit;4.+ 的版本

> ID：14880983
> 
> 赞同：2
> 
> 时间：2013-02-14T17:49:40.730
> 
> 标签：junit, proxy, gradle, dependency-management

`gradle build`在我的 gradle.properties 文件上运行时出现以下错误。

我知道我在防火墙后面，并且我有一个可以使用的 poxy。我尝试将以下内容添加到我的 gradle.properties 文件中，但我无法下拉 jUnit。所有帮助表示赞赏！

```
systemProp.http.proxyHost=www.somehost.org
systemProp.http.proxyPort=8080 
```

错误：

```
Error listing versions of junit#junit;4.+ using class 
org.gradle.api.internal.artifacts.repositories.resolver.MavenVersionLister$1\. 
Will attempt an alternate way to list versions. This behaviour has been 
deprecated and is scheduled to be removed in Gradle 2.0

FAILURE: Build failed with an exception.

* What went wrong:
Could not resolve all dependencies for configuration ':testRuntime'.
> Could not resolve junit:junit:4.+.
  Required by:
      :HealthMonitor:1.0
   > Failed to list versions for junit#junit;4.+.
      > Could not list versions using M2 pattern 'http://repo1.maven.org/maven2/
[organisation]/[module]/[revision]/[artifact]-[revision](-[classifier]).[ext]'.
         > Could not GET 'http://repo1.maven.org/maven2/junit/junit/'.
            > Connection to http://repo1.maven.org refused 
```

构建.gradle：

```
apply plugin: 'java'
apply plugin: 'eclipse'

version = '1.0'
jar {
    manifest {
        attributes 'Implementation-Title': 'Health Monitor', 'Implementation-Version': version
    }
}

repositories {
    mavenCentral()
}

dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.+'
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:29:53.117

根据代理的不同，您可能需要配置的不仅仅是主机和端口。请参阅Gradle 用户指南中的[通过代理访问 Web 。](http://www.gradle.org/docs/current/userguide/userguide_single.html#sec%3aaccessing_the_web_via_a_proxy)另外，我建议尝试使用固定版本而不是版本范围。

# android - GridView 中多次（>120）调用 getView 导致 OutOfMemoryError

> ID：14880985
> 
> 赞同：3
> 
> 时间：2013-02-14T17:49:40.033
> 
> 标签：android, gridview, user-interface, out-of-memory

我正在使用 GridView 来显示图像。图像从提要下载并添加到 BitmapCache。GridView 位于 ViewFlipper 内（它有一个 ListView 作为第二个视图）。我是第一次使用 GridView，但是当我使用 ListViews 时，我已经多次使用 Adapters。

目前，Feed 只提供两张图片。但是当我启动包含 GridView 的片段时，我得到一个 OutOfMemoryError 导致 bei BitmapFactory.decodeStream()。当我更深入地查看 logcat 时，我注意到我的 GridView 适配器内部的 getView() 被多次调用。我知道如果多次调用 getView() 并没有什么特别的，但是我的 Adapter 中的 getView() 方法仅在位置 0 被调用了 120 次以上。而且我真的不明白为什么它被如此频繁地调用。但我很确定这会导致我的内存问题，因为这种方法试图在几秒钟内加载超过 100 次位图。

因为我已经在尝试使用 ViewHolder 回收我的视图，所以我现在很无助，我希望有人可以向我解释 getView() 的大量调用和/或可能给我一个提示来解决我的问题。

我的适配器的 getView() 方法：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    ViewHolder holder;

    LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    if (convertView == null) {
        holder = new ViewHolder();
        convertView = inflater.inflate(R.layout.pictures_grid_item, parent, false);
        holder.image = (ImageView) convertView.findViewById(R.id.picturesGridImage);
        convertView.setTag(holder);
    } else {
        holder = (ViewHolder) convertView.getTag();
        holder.image.setImageBitmap(null);
    }

    Picture picture = (Picture) pictureList.get(position);
    String imageUrl = picture.getUrl();

    if (!TextUtils.isEmpty(imageUrl)) {
        holder.image.setTag(imageUrl);
        ImageLoader.getInstance(context).loadImageWithTagCheck(holder.image);
    }

    return convertView;
}

private static class ViewHolder {
    ImageView image;
} 
```

loadImageWithTagCheck *()* - 方法只检查图像是否已经下载（肯定应该是这种情况）

包含视图的片段：

```
public class PicturesFragment extends BaseFragment {

private List<Parcelable> pictureList;
private PicturesGridAdapter adapter;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    View view = inflater.inflate(R.layout.pictures_fragment, container, false);
    // TODO: Remove final after development
    final MediaActivity activity = (MediaActivity) getActivity();

    pictureList = activity.getPictures();

    adapter = new PicturesGridAdapter(activity, pictureList);

    GridView gridview = (GridView) view.findViewById(R.id.picturesGrid);
    gridview.setAdapter(adapter);

    gridview.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> parent, View v, int position, long id) {
            Toast.makeText(activity, "" + position, Toast.LENGTH_SHORT).show();
        }
    });
    return view;
}
} 
```

顺便说一句：我没有在任何地方使用 *wrap_content*。

编辑：这是图像加载器的代码。当然，ImageLoader 是导致 outOfMemoryError 的问题。但我认为问题出在适配器上，因为在创建视图之后对位置 0 的 120 次 getView() 调用是不正确的。并且适配器只创建一次，因此在我的适配器的单个实例中调用超过 120 次。（这是一个非常庞大而复杂的项目，所以“简单”的图像加载器有很多代码）

```
 public void loadImageWithTagCheck(final ImageView view) {
    final String url = (String) view.getTag();
    final Handler uiHandler = new Handler() {
        @Override
        public void handleMessage(Message msg) {
        }
    };
    if (imageHandler != null) {
        imageHandler.post(new Runnable() {

            @Override
            public void run() {
                final Bitmap bmp = getImage(url, view);
                uiHandler.post(new Runnable() {

                    @Override
                    public void run() {
                        String tagUrl = (String) view.getTag();
                        if (tagUrl.equals(url) && bmp != null
                                && !bmp.isRecycled()) {
                            scaleBitmapAndAdjustViewByHeight(view, bmp);
                        } else if (bmp != null) {
                            bmp.recycle();
                        }
                    }
                });
            }
        });
    }
}

     private Bitmap getImage(String url, View v) {
        Bitmap bmp = null;

        if (url != null && !TextUtils.isEmpty(url)) {
            String md5Url = Utility.md5(url);
            if (cache.containsKey(md5Url)) {
                bmp = cache.getBitmap(md5Url);
            } else {
                HttpGet httpGet = new HttpGet();
                HttpClient httpClient = new DefaultHttpClient();

                HttpResponse response = null;
                try {
                    URI uri = new URI(url);
                    httpGet.setURI(uri);
                    response = httpClient.execute(httpGet);

                    if (response.getStatusLine().getStatusCode() == HttpStatus.SC_OK) {
                        HttpEntity entity = response.getEntity();
                        if (entity != null) {
                            final BufferedInputStream buffIn = new BufferedInputStream(
                                    entity.getContent(), Utils.IO_BUFFER_SIZE);
                            BitmapFactory.Options options = new BitmapFactory.Options();
                            options.inJustDecodeBounds = true;
                            options.outWidth = v.getWidth();
                            options.outHeight = v.getHeight();
                            options.inPurgeable = true;
                            options.inInputShareable = true;
                            options.inPreferredConfig = Bitmap.Config.RGB_565;

                            bmp = BitmapFactory.decodeStream(buffIn, null,
                                    options);
                        }
                    }
                } catch (URISyntaxException e) {
                    e.printStackTrace();
                } catch (ClientProtocolException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                } catch (IllegalStateException e) {
                    e.printStackTrace();
                }

                if (bmp != null) {
                    cache.put(md5Url, bmp);
                }
            }
        }

        return bmp;
    }

private void scaleBitmapAndAdjustViewByHeight(final ImageView view,
        final Bitmap bmp) {
    ViewTreeObserver vto = view.getViewTreeObserver();
    vto.addOnGlobalLayoutListener(new OnGlobalLayoutListener() {

        @SuppressLint("NewApi")
        @SuppressWarnings("deprecation")
        @Override
        public void onGlobalLayout() {
            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {
                view.getViewTreeObserver().removeOnGlobalLayoutListener(
                        this);
            } else {
                view.getViewTreeObserver().removeGlobalOnLayoutListener(
                        this);
            }

            // Get current dimensions
            int width = bmp.getWidth();
            int height = bmp.getHeight();

            // Determine how much to scale: the dimension requiring less
            // scaling is closer to the its side. This way the image always
            // stays inside your bounding box AND either x/y axis touches
            // it.
            int imageViewHeightFromXMLinPixels = view.getHeight();
            float xScale = (float) ((imageViewHeightFromXMLinPixels * 2.75) / width);
            float yScale = ((float) imageViewHeightFromXMLinPixels)
                    / height;
            float scale = (xScale <= yScale) ? xScale : yScale;

            // Create a matrix for the scaling and add the scaling data
            Matrix matrix = new Matrix();
            matrix.postScale(scale, scale);

            // Create a new bitmap
            Bitmap scaledBitmap = Bitmap.createBitmap(bmp, 0, 0, width,
                    height, matrix, true);
            width = scaledBitmap.getWidth(); // re-use

            view.setImageBitmap(scaledBitmap);
            view.getLayoutParams().width = width;
        }
    });
    view.requestLayout();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T11:40:52.233

摆脱`scaleBitmapAndAdjustViewByHeight(...)`方法。相反，做一个简单的`view.setImageBitmap(bmp)`.

为什么？ `scaleBitmapAndAdjustViewByHeight(...)`调用`view.requestLayout()`这可能会导致调用您的适配器`getView(...)`并以死锁结束，最后是 OutOfMemoryError。

# node.js - 为什么这个 Node+MongoDB 使用 addToSet 更新无法更新数组

> ID：14880986
> 
> 赞同：1
> 
> 时间：2013-02-14T17:49:46.203
> 
> 标签：node.js, mongodb

我无法弄清楚这一点，我尝试使用终端执行相同的查询并且它成功了。我应该注意，在使用 MongoHub 时，相同的查询会返回一行，但在检查记录后没有任何变化。下面是 mongo 设置和更新操作。

```
var mongo = require('mongodb');

var Server = mongo.Server,
    Db = mongo.Db,
    BSON = mongo.BSONPure;

var server = new Server('localhost', 27017, {auto_reconnect: true});
    db = new Db('help', server, {safe: true});

type = 'issues';
id = 2;
body = { comments: '64' };

db.collection(type, function(err, collection) {
       collection.update({id:id}, {$addToSet: body}, {safe:true}, function(err, result) {
            if (err) {
                console.log('Error updating: ' + err);
                res.send({'error':'An error has occurred'});
            } else {
                console.log('' + result + ' document(s) updated');
                res.send(type);
            }
        });
    });

//Mongo Collection Record
{ "_id" : ObjectId( "511c000d994cde0d02adf1ba" ),
  "comments" : [ 
    1, 
    2, 
    3 ],
  "id" : 2,
  "text" : "This is another issue test",
  "title" : "Another Issue Test" } 
```

任何帮助是极大的赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T11:18:30.247

原来我没有将变量 id 解析为我从 req.params 获得的整数，我应该包括我从 req.params 对象中获取 id。

```
var id = parseInt(req.params.id); 
```

解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T18:19:10.647

这部分似乎有一些问题

```
db.collection(type, function(err, collection) {
   collection.update({id:id}, {$addToSet: body}, {safe:true}, 
```

我没有看到类型变量在第一行中定义的位置。这意味着很可能找不到该集合。但是您没有在两行之间检查此问题的任何错误。

在更新语句中，您应该有 {_id: ObjectId(id)} 其中 id 应该是 511c000d994cde0d02adf1ba 以用于您的示例。

这些问题似乎一开始就很明显。

# javascript - 从 HTML 表单 textarea 值和 Post 在 JavaScript 中制定 JSON？

> ID：14880992
> 
> 赞同：2
> 
> 时间：2013-02-14T17:50:13.750
> 
> 标签：javascript, html, json

我想要一个 HTML 表单，在 Http 请求正文中发布以下内容。

```
{ “info” : {
     “id” : “123”
     “text1” : <comes from html text-box>
} 
```

所以，我想要的是将上面的内容制定为一个 JavaScript 对象，然后在提交时发布这个 JavaScript 对象。“text1”的值将来自用户输入，这将是一个 html 格式的 textarea 输入框。第一个值“id”将是硬编码的，或者也可能来自隐藏的文本框。

所以我的问题是：如何编写一段JavaScript来实现这一点，以及相应的html表单等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T18:04:43.443

```
<html>
 <head>
  <script>
   function sendJson()
   {
   var x=document.forms["alfa"]["text1"].value;
   str1="{ 'info' : { 'id' : '123' 'text1' : ";
   str2=str1.concat(x);
   body=str2.concat(" }");
   document.forms["alfa"]["text1"].value=body;
   }
  </script>
 </head>
 <body>
  <form id="alfa" onsubmit="return sendJson()">
   Text1: <input id="text1" type=text size=50>
   <input type="submit" value="Submit">
  </form>
 </body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T18:07:58.757

使用 jQuery 最容易做到这一点。

首先，用您的数据初始化一个 JavaScript 对象。然后，使用 jQuery 从文本框中提取文本并将其分配给对象中所需的属性。

```
var data = { 
    "info": {
        "id":"123",
        "text1":"" 
    }
};

data.info.text1 = $("#yourTextBox").val(); 
```

然后你可以使用 jQuery.ajax 来发出请求：

```
$.ajax({
  type: "POST",
  url: url,
  data: data,
  success: success,
  dataType: dataType
}); 
```

有关帖子，请参阅 jQuery 文档：http: [//api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

编辑：使用内联 javascript，您的 HTML 看起来像这样（不使用 jQuery 来获取表单数据）：

```
<html>
<head>
<script>
var data = { 
    "info": {
        "id":"123",
        "text1":"" 
    }
};
function makeRequest()
{
    data.info.text1 = document.forms["frm1"]["fname"].value;

    $.ajax({
        type: "POST",
        url: url,
        data: data,
        success: success,
        dataType: dataType
    });
}
</script>
</head>
<body>

<form name="frm1" id="yourTextBox" onsubmit="makeRequest()">
<input type="text" name="fname">
<input type="submit" value="Submit">
</form>

</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-09T06:39:17.330

最好的方法是使用**JSON.parse()**

# extjs - Sencha Touch Production Build 不工作

> ID：14880995
> 
> 赞同：1
> 
> 时间：2013-02-14T17:50:26.103
> 
> 标签：extjs, sencha-touch, sencha-touch-2

我是 Sencha touch 的新手。我复制了文档视频中显示的博客示例演示

**环境** Sencha 2.2.0 Aplha Sencha Cmd 3.0.2.288 Google Chrome

当我尝试构建测试时，没有任何效果，我点击链接（[http://www.sencha.com/forum/showthread.php?253688](http://www.sencha.com/forum/showthread.php?253688)）然后测试工作..

当我构建生产，构建成功，并且没有加载只是加载指示器闪烁时，我在 chrome 日志中看到以下内容

```
Document was loaded from Application Cache with manifest 
http:/mydomain:88/apm/build/apm/production/cache.appcache
Application Cache Checking event
XHR finished loading: "http://mydomain:88/apm/build/apm/production/app.json?
1360863591949".
Application Cache NoUpdate event 
```

请让我知道，如果我错过了什么？

谢谢帕万

# iis-7 - URL 重写与服务器重定向一起使用

> ID：14880997
> 
> 赞同：1
> 
> 时间：2013-02-14T17:50:29.687
> 
> 标签：iis-7, url-rewriting

我正在尝试使用 IIS7 的 URL 重写来使**mydomain.com/home/default.aspx**看起来像**mydomain.com**。此外，该站点的原始结构将根**default.aspx**重定向到**mydomain.com/home/default.aspx**。

因此，对 mydomain.com 的访问**将**重定向到**mydomain.com/home/default.aspx**，同时在 Web 浏览器地址栏中仅显示**mydomain.com**。

有人可以帮助我使用入站和出站规则来实现这一点吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:09:59.127

运行 iis 管理器 ( `inetmgr`)，选择您的网站 -> 双击`URL rewrite`.
然后，您必须单击右侧`Add Rule(s)...`并选择`Blank Rule`。
使用以下值填写字段： ![重写规则](../Images/eb80b1d5fb1a200113cc27624d4c78ea.png)

此规则将匹配`mydomain.com`or`mydomain.com/`并将其重写为`mydomain.com/home/default.aspx`.

这将在您的 中产生以下规则`web.config`：

```
<rules>
    <rule name="test" stopProcessing="true">
        <match url="^/?$" negate="false" />
        <action type="Rewrite" url="home/default.aspx" />
    </rule>
</rules> 
```

# solr - 使用 Solr 和 Sunspot 对多个单词进行模糊“开头”搜索

> ID：14880998
> 
> 赞同：0
> 
> 时间：2013-02-14T17:50:37.293
> 
> 标签：solr, ruby-on-rails-3.2, sunspot-solr

我正在尝试提供文本搜索以根据城市的名称和所属国家/地区的名称来查找城市。

例如，我想返回`Milan, Italy`搜索条件`mil ita`，或者`Los Angeles, United States`搜索`los ang uni`.

这些是我拥有的当前模型（省略了验证）：

```
class City < ActiveRecord::Base
  belongs_to :country

  searchable do
    text :name
    text :country do
      country.name
    end
  end
end 
```

和

```
class Country < ActiveRecord::Base
end 
```

这是我的 solr`schema.xml`文件的相关部分：

```
<fieldtype class="solr.TextField" positionIncrementGap="100" name="text">
  <analyzer type="index">
    <tokenizer class="solr.StandardTokenizerFactory"/>
    <filter class="solr.StandardFilterFactory"/>
    <filter class="solr.LowerCaseFilterFactory"/>
    <!--<filter class="solr.StopFilterFactory" words="stopwords.txt" ignoreCase="true"/>-->
    <filter class="solr.ISOLatin1AccentFilterFactory"/>
    <filter class="solr.TrimFilterFactory" />
    <filter class="solr.EdgeNGramFilterFactory"
            minGramSize="3"
            maxGramSize="30"/>
  </analyzer>
  <analyzer type="query">
    <tokenizer class="solr.StandardTokenizerFactory"/>
    <filter class="solr.StandardFilterFactory"/>
    <filter class="solr.LowerCaseFilterFactory"/>
    <!--<filter class="solr.StopFilterFactory" words="stopwords.txt" ignoreCase="true"/>-->
    <filter class="solr.ISOLatin1AccentFilterFactory"/>
    <filter class="solr.TrimFilterFactory" />
  </analyzer>
</fieldtype> 
```

我在控制器中执行搜索：

```
search = City.search do
  fulltext params[:q]
  paginate page: 1, per_page: 10
end 
```

这里发生的情况是，如果我搜索`mil`我会得到`Milan, Italy`结果，但搜索`mil ita`不会返回任何内容。

有任何想法吗？

先感谢您，

河。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T14:03:39.807

找到了解决方案，我想我会分享。

您只需要构建一个“自定义字段”，其中包含要启用搜索的所有文本，如下所示（在 City 模型中）：

```
searchable do
  text :composite_name do
    "#{name} #{country.name}"
  end
end 
```

这行得通。

河。