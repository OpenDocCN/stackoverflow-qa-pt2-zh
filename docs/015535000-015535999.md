# StackOverflow 问答 15535000-15535999

# javascript - 具有唯一匿名函数的 removeEventListener

> ID：15535001
> 
> 赞同：2
> 
> 时间：2013-03-20T21:23:02.680
> 
> 标签：javascript, function, unique, dom-events, anonymous-function

我有一个生成 HTML 元素的对象，这些元素也与对象数组相连，假设我们有一个它的实例。因此，当它创建元素时，它还将以下事件侦听器分配给元素的嵌套部分（uploadDelete 类）。

现在这个事件监听器需要调用创建它的对象实例的 delete 方法，并在创建它时分配 i 的值。因为事件在 Window 下，所以需要将实例与 i 值一起传递给匿名函数。

因此，这为事件分配了一个非常独特的功能，并且因为 delete 方法将破坏包含侦听器的元素，我想先将其删除；从我读过的内容来看，否则可能会导致泄漏（？）。我也在使用严格模式，所以不是 arguments.callee。

```
file.display.getElementsByClassName('uploadDelete')[0].addEventListener('click',
(function(that,i){
    return function() {
        that.delete(i);
    };
})(this,i), false); 
```

我尝试了很多不同的东西，但是当我开始在函数内部的函数内部有一个匿名函数，然后在侦听器中调用它时，我想我应该在这里问一下。我可能对整体问题有一个解决方案，更改其他代码，但如果可以回答这个问题，它仍然会有所帮助。

* * *

在 Norguard 的回答的帮助下，这就是我最终要做的事情。由于唯一性源于一个名为 file 的对象，我只是创建了一个新的 file 属性来存储函数：

```
file.deleteFunction = (function(that,i){
    return function() {
        that.delete(i);
    };
})(this,i);

file.display.getElementsByClassName('uploadDelete')[0].addEventListener('click',file.deleteFunction, false); 
```

然后调用的删除函数删除事件侦听器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:41:13.240

一种相对轻松的方法可能是在负责添加和删除侦听器的范围内创建一个对象，该对象构建一个 ID，串行或非串行或非 ID，并将使用该 ID 存储对象中的任何侦听器，返回请求它的任何对象/模块的 ID（或将匿名函数传回给它们）。

```
// trivial example
var listeners = {},
    i = 0,

add = function (context, func, closure) {
    var enclosed = (function (closure) {
        return function () { /* ... */; func(); };
    }(closure)),
    index = i;

    context.addEventListener("...", enclosed, false);
    listeners[index] = enclosed;
    i += 1;
    return index;
}; 
```

`add`现在将添加您的侦听器，但还将您传递给 addEventListener 的函数存储到`listeners`对象中。如果你需要一个对 的引用`i`，你已经在闭包中得到了它，如果你想要的话。

因此，现在当您删除内容时，您只需查找保存在`listeners[i]`.

另一种选择是，如果您不想在一个地方保存一张满是这些的表，无论出于何种原因，都可以捕获 return 语句，而不是返回`i`，而是返回函数；

```
// inside of your module
// I'm not usually crazy about `this`, without doing something particular with it,
// but hopefully it illustrates my point
this.cached_func = add(this.el, this.callback.bind(this), this.secret); 
```

所以现在，当需要删除所有内容时，你想关闭你的监听器......

```
remove(this.cached_func); 
```

尽管如此，您所读到的泄漏仍然是可能的，但主要的罪魁祸首是 IE6/7（及更早版本）。
随着人们远离不良浏览器，这变得不那么重要了。
事实上，在 IE6 中鼓励内存转储可能只是鼓励人们不要使用 IE6 的好方法。

# bash - 在 SSH 命令中使用 sh -c if 比较

> ID：15535003
> 
> 赞同：1
> 
> 时间：2013-03-20T21:23:13.247
> 
> 标签：bash, shell, if-statement, ssh

我在 if 语句的 != 部分遇到了一些问题。据我所知，基本上这个语句是有效的，但是执行它会给出`[: 1: !=: unexpected operator`. 我尝试使用 -n 执行，但无论出于何种原因，即使输出为空白，使用 -n 仍会运行 echo 命令。

对此的任何帮助表示赞赏。我附上了下面的代码片段。

```
#!/bin/sh

HOST=$1
USER="/scripts/whoowns $HOST | tr -d '\r'"

ssh -t $HOST -p 22 -l deehem "sh -c 'if [ "" != "\`$USER\`" ]; then echo "Username for $HOST: \`$USER\`"; fi' ; bash -login" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:51:42.763

正如您所意识到的，`"bla "" bla"`只是连接了两个字符串 ( `"bla bla"`)。

您可以转义`"`: `\"`，但标准`[` `test`工具有一个专门用于此任务的选项：

```
 -n STRING
          the length of STRING is nonzero

   -z STRING
          the length of STRING is zero 
```

注意：为什么你有\`？这样字符串永远不会为空....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-08T03:19:27.943

关于您的“但是执行此操作会给出`[: 1: !=: unexpected operator`”问题，这是一个解决方案：

使用`bash -c`而不是`sh -c`. bash 程序在处理方括号方面似乎比 sh 更好。例如：

```
ubuntu@ubuntu:/$ echo "antipetalous" | if [[ "antipetalous" =~ "ti" ]]; then echo "match"; else echo "no"; fi
match
ubuntu@ubuntu:/$ echo "antepetalous" | if [[ "antepetalous" =~ "ti" ]]; then echo "match"; else echo "no"; fi
no
ubuntu@ubuntu:/$ sh -c 'echo "antipetalous" | if [[ "antipetalous" =~ "ti" ]]; then echo "match"; else echo "no"; fi'
sh: 1: [[: not found
no
ubuntu@ubuntu:/$ bash -c 'echo "antipetalous" | if [[ "antipetalous" =~ "ti" ]]; then echo "match"; else echo "no"; fi'
match
ubuntu@ubuntu:/$ bash -c 'echo "antepetalous" | if [[ "antepetalous" =~ "ti" ]]; then echo "match"; else echo "no"; fi'
no
ubuntu@ubuntu:/$ sh -c 'echo "antepetalous" | if [[ "antepetalous" =~ "ti" ]]; then echo "match"; else echo "no"; fi'
sh: 1: [[: not found
no
ubuntu@ubuntu:/$ 
```

所以`ssh -t $HOST -p 22 -l deehem "sh -c 'if [ "" != ...`会变成`ssh -t $HOST -p 22 -l deehem "bash -c 'if [ "" != ...`.

感谢 pLumo 在[https://askubuntu.com/questions/1310106/sh-c-sh-not-working-when-using-if-statement-and-having-in-the-filena](https://askubuntu.com/questions/1310106/sh-c-sh-not-working-when-using-if-statement-and-having-in-the-filena)（“命令行 - sh - c '...' sh {} 在使用 if 语句并且文件名中有 ' 时不起作用 - Ask Ubuntu"）。

# css - 背景图像在 IE8 中不固定（anythingSlider）

> ID：15535010
> 
> 赞同：1
> 
> 时间：2013-03-20T21:23:55.007
> 
> 标签：css, background-position, anythingslider

下文中引用的链接：http: [//www.massgeneral.org/international/dev/full-screen.aspx](http://www.massgeneral.org/international/dev/full-screen.aspx)

如果您使用“anythingNavWindow”类预览 div 的 CSS，您可以看到用于投射阴影效果的背景图像（精灵），从而为缩略图滑块的导航窗口提供缩略图在后面的视觉效果触发器。

好吧，不幸的是，在 IE8 中查看时，当您使用滑块转换以查看滑块中的其他缩略图时，阴影会随着缩略图一起移动。每个其他浏览器都正确处理背景图像，即让它静止而不随缩略图滑块移动。

缩略图的实际转换发生在父容器上，而不是“anythingNavWindow”类的父容器上，所以我不确定为什么会发生这种情况。任何帮助将不胜感激。

我不认为这是滑块的问题，但更多的是 CSS 的问题。

这是一个准备被篡改的 jsFiddle：http: [//jsfiddle.net/jodriscoll/fKCFE/](http://jsfiddle.net/jodriscoll/fKCFE/)

```
div.anythingNavWindow {
    width: 616px !important; 
    background: url('http://www.massgeneral.org/assets/js-plugins/images/bg-slideshow-shadows.png') no-repeat 0 0 transparent;
} 
```

我尝试过的事情：

*   将位置设置为“固定”，不知何故最终隐藏了整个 DIV 容器。
*   使用“background-position-x”和“background-position-y”设置背景位置什么都不做

任何帮助将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:30:01.680

尝试`backgroundPositionX`并`backgroundPositionY`

IE8 使用它，出于某种愚蠢的原因。

# ruby - 如何正确确定 Ruby lambda 的范围？

> ID：15535016
> 
> 赞同：1
> 
> 时间：2013-03-20T21:24:09.277
> 
> 标签：ruby, lambda

我有这个 lambda：

```
echo_word = lambda do |words|
  puts words
  many_words = /\w\s(.+)/
    2.times do
      sleep 1
      match = many_words.match(words)
      puts match[1] if match
    end
  sleep 1
end 
```

我想将它`each`作为一个块传递给，将来每个块都会传递更多。

```
def is_there_an_echo_in_here *args
  args.each &echo_word # throws a name error
end

is_there_an_echo_in_here 'hello out there', 'fun times' 
```

但是当我用这个 lambda 方法运行 my_funky_lambda.rb 时，我得到了一个 NameError。我不确定这个 lambda 的范围是怎么回事，但我似乎无法从`is_there_an_echo_in_here`.

`echo_word`如果我将其设为常量`ECHO_WORD`并像那样使用它，那么它的范围和使用是正确的，但必须有一个更直接的解决方案。

在这种情况下，从内部访问`echo_word`lamba的最佳方式是什么`is_there_an_echo_in_here`，例如将其包装在模块中、访问全局范围等？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T21:30:48.507

在 Ruby 中，常规方法不是闭包。正是由于这个原因，你不能`echo_word`在里面打电话`is_there_an_echo_in_here`。

然而，块是闭包。在 Ruby 2+ 中，您可以这样做：

```
define_method(:is_there_an_echo_in_here) do |*args|
  args.each &echo_word
end 
```

`echo_word`另一种方法是作为参数传递：

```
def is_there_an_echo_in_here *args, block
  args.each &block
end

is_there_an_echo_in_here 'hello out there', 'fun times', echo_word 
```

# php - php 在函数中调用构造函数并初始化对象

> ID：15535019
> 
> 赞同：0
> 
> 时间：2013-03-20T21:24:25.073
> 
> 标签：php, oop, object

我不熟悉 php OOP，现在我遇到了一些麻烦。我正在用结构化编程（不是 OOP）开发我的项目，并且我已经包含了一个类（由其他人制作），并且在我的结构化函数中，我必须初始化类并执行操作。如果您不明白我在这里输入的内容，请观看代码：

```
<?php
require __DIR__ . '/SourceQuery/SourceQuery.class.php';

function get_server_info($ip, $port){

    define( 'SQ_SERVER_ADDR', $ip );
    define( 'SQ_SERVER_PORT', $port );
    define( 'SQ_TIMEOUT',     5 );
    define( 'SQ_ENGINE',      SourceQuery :: GOLDSOURCE );

    $Query = new SourceQuery( );

    try
    {
        $Query->Connect( SQ_SERVER_ADDR, SQ_SERVER_PORT, SQ_TIMEOUT, SQ_ENGINE );

        $result = (array)$Query->GetInfo();

    }
    catch( Exception $e )
    {
        $result = array('Players' => 0, 'MaxPlayers' => 0);
    }

    $Query->Disconnect( );
    unset($Query);
    return array('players' => $result['Players'], 'max_players' => $result['MaxPlayers']);
}
?> 
```

基本上，我创建了一个名为 get_server_info 的函数，它构造了一个 SourceQuery 对象。我正在查询 Counter-Strike 服务器的玩家数量和最大玩家数量。

我不知道这在编程上是否正确（与 OOP 混合结构化）。我不想在类中更改代码或创建方法，我想使用我的函数。我得到每个调用的结果（get_server_info（）），但问题是每个结果都是一样的！

例如：

```
for($i = 0; $i < 30; $i++){
   $result = get_server_info('66.55.44.3'.$i, 27015);
   echo $result['players'].' - '.$result['max_players'].'<br />';
} 
```

结果对于任何服务器都是一样的！（是的，它们都已启动并运行）。当我在我的服务器查看器程序上检查服务器时，他们有不同数量的玩家，但我从这个循环中得到的结果是一样的！我不知道为什么。

如果我一一手动查询，我会得到正确的结果。

我认为这是因为该对象没有被删除或....我不知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:33:54.477

我认为这是因为你试图覆盖一个常数。( `define`)

在任何函数之外的代码中的某处定义常量`$id`并`$port` 直接传递给类。你在哪里`$Query`初始化？

尝试：

```
define( 'SQ_TIMEOUT',     5 );
define( 'SQ_ENGINE',      SourceQuery :: GOLDSOURCE );

function get_server_info($ip, $port){

    try
    {
        $Query->Connect( $ip, $port, SQ_TIMEOUT, SQ_ENGINE ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:35:47.473

你忘了

```
$Query = new SourceQuery( ); 
```

请参阅[此处](https://github.com/xPaw/PHP-Source-Query-Class/blob/master/Example.php)的示例。

# php - preg_split() 帮助，格式正确的正则表达式

> ID：15535021
> 
> 赞同：2
> 
> 时间：2013-03-20T21:24:31.593
> 
> 标签：php, split, expression, explode

我的正则表达式很弱。

我想拆分这些字符：

*   加“+”
*   空间 ” ”
*   连字符“-”
*   下划线“_”

这就是我所拥有的：

```
preg_split('/\+|-|\s|_/', $string ), 
```

...我怀疑这是不对的 - 在“+”号上。我想要一些建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:26:08.940

`preg_split('/[+\s_-]/', $string);`应该为你工作。这是使用您的角色而不是一系列管道创建一个角色类。

**注意**- 有时重要的`-`是放在角色类的最后一个，所以我倾向于总是把它放在那里以确保安全。

# php - wordpress 致命错误的问题：无法重新声明 frm_dl

> ID：15535025
> 
> 赞同：0
> 
> 时间：2013-03-20T21:24:34.140
> 
> 标签：php, database, wordpress

我的网站使用 wordpress 遇到了这个问题

我不知道是什么问题，请有人帮助我们。

致命错误：无法重新声明 frm_dl() (

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:28:08.027

您似乎在 wp-settings.php 中有函数 rm_dl() 的重复函数定义。请查看该文件，以便只有一个定义。

将链接发布到您的网站并询问“请看一下”也不是一个好主意。如果您将特定错误与受影响的文件一起发布（当然没有密码！），我们可以更好、更轻松地提供帮助。

如果您的文件没有任何问题，则该错误很可能是由某些新安装或更新的主题或插件引起的。在最坏的情况下，它是一些自动破解。在这两种情况下，您都应该恢复到工作备份，并确保使用安全更新仔细更新任何插件和基础安装。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-03-21T11:29:52.473

这个问题是由病毒引起的。它是一种脚本，当它在每个 php 文件中运行此创建代码时，如下所示。.

解决方案是下载您的实时项目文件并删除此代码并再次上传所有实时文件。您可以一次性替换所有代码，仅用空白光标替换所有代码。

希夫

# vb.net - 工作簿中的调用表

> ID：15535034
> 
> 赞同：0
> 
> 时间：2013-03-20T21:25:26.113
> 
> 标签：vb.net, excel, excel-interop, excel-addins

我正在尝试调用打开的工作簿中的第 5 张工作表。当我从程序中打开工作簿时，我似乎能够做到：

```
Dim CurrentRun As New Excel.Application
Dim CurrentBook As Excel.Workbook
Dim CurrentSheet As Excel.Worksheet

Private Sub GeneralButtonOpener_Click(sender As Object, e As EventArgs) Handles GeneralButtonOpener.Click

    CurrentRun.Visible = True
    CurrentBook = CurrentRun.Workbooks.Add(MainTemplatePath)
    CurrentSheet = CurrentBook.Worksheets(4)
    CurrentSheet.Activate()

End Sub 
```

但是如果文件已经打开，我所有尝试调用工作表的尝试都失败了：

```
 Dim CurrentRun As Microsoft.Office.Interop.Excel.Application
    Dim CurrentBook As Microsoft.Office.Interop.Excel.Workbook
    Dim CurrentSheet As Microsoft.Office.Interop.Excel.Worksheet

    CurrentRun = System.Runtime.InteropServices.Marshal.GetActiveObject("Excel.Application")
    CurrentBook = CurrentRun.Workbooks
    CurrentSheet = CurrentBook.Sheets(4)
    CurrentSheet.Activate() 
```

或者

```
Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
    Dim CurrentRun As Microsoft.Office.Interop.Excel.Application
    Dim CurrentBook As Excel.Workbook
    Dim CurrentSheet As Excel.Worksheet

    CurrentRun = System.Runtime.InteropServices.Marshal.GetActiveObject("Excel.Application")
    CurrentBook = CurrentRun.ActiveWorkbook
    CurrentSheet = CurrentBook.Sheets(4)
    CurrentSheet.Activate()
End Sub 
```

我看过几个例子，但我不知道我哪里出错了。这让我感到惊讶，因为似乎有很多关于这个主题的问题。以太指向解决/解决此问题的位置或我特别做错了什么的指针将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T05:42:11.697

令我惊讶的是，我发现我实际上有几十个 Excel 实例在后台运行。当我调试并启动 COM 时，Excel 的第一个实例就会启动。第二个是在我打开 windows 窗体（加载项的主要部分）时启动的。

我不知道的是，当抛出异常并且我在 Visual Studio 中停止操作时，只有 Excel 的第一个实例被关闭。我有尝试清理 Excel 的打开应用程序的代码，但由于引发了异常，因此当然没有达到。

在这里，我一直在想，当我的事情更发展一些时，我会把错误处理放得更远一些。显然，我需要在构建过程的早期解决一些基本的错误处理。我完全是自学成才，不知何故做了三年，这不是问题。

希望其他没有被教导过的人可以在拔头发 14 小时之前看到这一点。

**解决方案** 关闭所有其他 Excel 实例，上述代码正常工作。错误处理中的地址清理和更早的地址如下：http: [//support.microsoft.com/kb/317109](http://support.microsoft.com/kb/317109) 也许也调用 GC，尽管这似乎有争议。

最终代码：

```
....
Imports System.Runtime.InteropServices
....
Dim CurrentRun As New Excel.Application
Dim CurrentBook As Excel.Workbook
Dim CurrentSheet As Excel.Worksheet
....
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
    On Error GoTo VortexInYourSoul
    CurrentRun = System.Runtime.InteropServices.Marshal.GetActiveObject("Excel.Application")
    CurrentBook = CurrentRun.Workbooks(1)
    CurrentRun.Visible = True
    CurrentSheet = CurrentBook.Sheets(8)
    CurrentSheet.Activate()
    CurrentBook.ActiveSheet.name = "LLAMA LALA LLAMALMALMAL"
    ....
  Exit Sub
VortexInYourSoul:

     CurrentSheet = Nothing
     CurrentBook.Close(False)
     CurrentBook = Nothing
     CurrentRun.Quit()
     CurrentRun = Nothing
     MsgBox("Error: " & Err.Description)

  End Sub 
```

# html - 图像排版的 SEO

> ID：15535036
> 
> 赞同：0
> 
> 时间：2013-03-20T21:25:34.030
> 
> 标签：html, seo

由于字体渲染在跨平台上是一场噩梦（例如，windows 有非常难看的抗锯齿，而 TTF 字体根本没有抗锯齿），我想出了为我设计中的每个标题创建一个 png 文件的想法。

然而，我的问题暗示，如果我要创建一个 H1 html 元素并用 CSS 隐藏它，而标题由 png 图像显示，那么搜索引擎会解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:27:07.073

您提出的是一种用图像替换文本的非常常用的方法。搜索引擎不介意。

我建议不要隐藏元素，而是将其移出屏幕，`-5000px`或者这样。此外，您的用户可能会讨厌您，因为您的网站会很慢。最好只是按原样处理排版。我不知道您使用的是什么 Windows 系统，但抗锯齿在我所有的 Windows 机器上都可以正常工作。如果您需要不同的字体，请考虑使用网络字体。

# backbone.js - 在backbone.js 中更新父视图

> ID：15535038
> 
> 赞同：0
> 
> 时间：2013-03-20T21:25:47.127
> 
> 标签：backbone.js, backbone-views

目标：使用 Backbone 生成用户表，能够在线编辑这些用户，并在保存时使用更新的数据重新渲染行。

*   我正在为具有主用户视图的用户生成一个容器表。
*   然后，我遍历用户集合，并使用 UserView 为每个用户生成一个表行。
*   单击任何行上的编辑需要将该行替换为编辑表单。（与用户关联的字段多于表中显示的字段。）
*   单击保存应将编辑表单替换为更新的表格行。

除了重新渲染表格行之外，一切正常。（如果我重新加载页面，更新的用户数据会正确显示，所以我知道它正在保存。）我想要做的（我认为）是让父视图（UsersView）监听更改并重新渲染用户视图。经过数十次搜索和不同的尝试，我在这里寻求帮助，了解我做错了什么。提前致谢。

**// 主要用户视图**

```
var UsersView = Backbone.View.extend( {
  el: '#content',

  template: _.template( usersTemplate ),

  initialize: function( ) {
    var that = this;
    this.listenTo( Users, 'change', this.updateOne );
    Users.fetch( );
    that.render( );
  },

  render: function( ) {
    this.$el.html( this.template );
  },

  // Add a single user to the table
  addOne: function( user ) {
    var userView = new UserView( { model: user } );
    userView.render( ).el;
  },

  // Add all items in the Users collection
  addAll: function( ) {
    Users.each( this.addOne, this );
  }
}); 
```

**// 个人用户视图**

```
var UserView = Backbone.View.extend({
  el: '#usersTableBody',

  tagName:  'tr',

  attributes : function( ) {
    return {
      'data-user' : this.model.get( 'display_name' )
    };
  },

  template: _.template( userTemplate ),

  events: {
    'click .editUser': 'editUser'
  },

  initialize: function( ){ },

  render: function( ) {
    var html = this.template( this.model.attributes );
    this.$el.html( html );
  },

  // Switch user row into edit mode
  editUser: function( e ) {
    e.preventDefault( );

    var userAddEditView = new UserAddEditView( { model: this.model } );
    userAddEditView.render( );
  }
}); 
```

**// 用户编辑视图**

```
var UserAddEditView = Backbone.View.extend({
  el: $( '#content' ),

  template: _.template( userEditTemplate ),

  events: {
    'click .saveUser': 'saveUser'
  },

  initialize: function( options ) { },

  render: function( ) {
    element = '[data-user="' + this.model.get( 'display_name' ) + '"]'
    this.$el.find( element ).hide( ).after( this.template( this.model.attributes ) );
  }, 

  saveUser: function( ) {
    var display_name = this.$( '#display_name' ).val( ).trim( );
    var email_address = this.$( '#email_address' ).val( ).trim( );
    var key_email_address = this.$( '#key_email_address' ).val( ).trim( );
    var password = this.$( '#password' ).val( ).trim( );
    var partner_name = this.$( '#partner_name' ).val( ).trim( );
    var hash = this.$( '#hash' ).val( ).trim( );
    var salt = this.$( '#salt' ).val( ).trim( );

    Users.create( { display_name: display_name, key_email_address: key_email_address, email_address: email_address, password: password, partner_name: partner_name, hash: hash, salt: salt } );
  }
}); 
```

**// 用户模型**

```
var UserModel = Backbone.Model.extend( {
  idAttribute: 'key_email_address'
}); 
```

**// 用户集合**

```
var UsersCollection = Backbone.Collection.extend( {
  model: User,

  url: 'users',

  initialize : function( models, options ) { },

  parse: function( data ) {
    this.result = data.result;
    return data.users;
  }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T10:46:55.520

`change`当集合的项目发生任何更改时，不会触发任何事件。

因此，您的以下行不应该真正做任何事情：

`this.listenTo( Users, 'change', this.updateOne );`

您需要在`UserView` `initialize`方法中包含以下内容：

`this.listenTo( this.model, 'change', this.render );`

所以现在每当模型改变（编辑），当前用户行再次呈现。

# php - 解析 Google Reader 导出

> ID：15535041
> 
> 赞同：0
> 
> 时间：2013-03-20T21:25:55.227
> 
> 标签：php, rss, simplexml

我正在尝试使用 SimpleXML 来解析从 Google Reader 导出生成的 xml 文件。

文件示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<opml version="1.0">
    <head>
        <title>TheTechBox subscriptions in Google Reader</title>
    </head>
    <body>
        <outline text="Engadget RSS Feed" title="Engadget RSS Feed"
            type="rss" xmlUrl="http://www.engadget.com/rss.xml" htmlUrl="http://www.engadget.com"/>
        <outline text="xkcd.com" title="xkcd.com" type="rss"
            xmlUrl="http://xkcd.com/rss.xml" htmlUrl="http://xkcd.com/"/>
    </body>
</opml> 
```

这是我到目前为止所尝试的，用户将文件上传到这个表单，表单需要循环并提取数据。

```
<?php
if ($_FILES["file"]["error"] > 0)
{
    echo "Error: " . $_FILES["file"]["error"] . "<br>";
}
else
{

    $import = new SimpleXMLElement($_FILES["file"]["name"]);

    foreach($import->opml->body->outline[0] as $feed){
        echo $feed["title"];
    }

}
?> 
```

现在 chrome 产生了一个服务器错误，表明页面上有一些非常错误的东西，文件上传正常，所以它似乎是 simpleXML 部分。

我计划稍后对数据做一些更复杂的事情，我目前正在尝试获取它只是为了在页面上回显数据（用于演示目的）。

任何反馈将不胜感激。

**这是最后的工作代码**

```
$import = simplexml_load_file($_FILES["file"]["tmp_name"]);

foreach($import->body->outline as $feed){
    echo $feed["title"];
} 
```

这将需要添加以解析所有数据，但这有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:52:07.453

您在使用 SimpleXML 时陷入了一个经典陷阱：解析文件或字符串时获得的第一个对象不是抽象的“文档”对象，而是父节点。在这种情况下，父节点是`<opml> ... </opml>`，因此`$import`在您的示例代码中是该`<opml>`节点。换句话说，而不是`$import->opml->body`你只需要说`$import->body`。

您的循环中还有另一个错误，即当您想要遍历*所有*`<outline>`元素 ( ) 时，您正在请求第一个元素( )。`->outline[0]`*`foreach( $whatever->outline as $feed )`*

# c# - 具有十进制值或类似的枚举

> ID：15535046
> 
> 赞同：5
> 
> 时间：2013-03-20T21:26:02.880
> 
> 标签：c#, winforms, combobox, enums

基本上我想用十进制值定义一个枚举，但这是不可能的。另一种选择是：

```
public static class EstadoRestriccion
{
    public const decimal Valur1 = 0;
    public const decimal Value2 = 0.5M;
    public const decimal Value3 = 1;
}; 
```

但是我需要在组合框中添加这些常量，其中要显示的选项应该是常量的名称，并且`SelectedItem`应该返回值 (0, 0.5M, 1) 或类似的值。我知道这是可能的，但它是丑陋的。

使用枚举我可以轻松做到这一点：`comboBox.DataSource = Enum.GetValues(typeof(MyEnum));`

根据我的要求模拟枚举的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T21:28:08.497

字典可能是一个不错的选择。

`Dictionary<string,decimal>`可能是一个很好的候选人 - 让您命名这些值。

```
var values = new Dictionary<string,decimal>();
values.Add("Value1", 0m);
values.Add("Value2", 0.5m);
values.Add("Value3", 1m); 
```

这可以包装在一个类中，因此您只按索引公开一个 getter，而不是整个`Dictionary<TKey,TValue>`接口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T21:28:14.280

没有办法简单。`enum`只接受整数值。你放的代码片段很好。

`const decimal`和之间有细微差别`static readonly decimal`。一是直接评价；编译器将名称替换为其值。相反，`readonly`强制代码每次都引用该字段并从中获取值。您可以观察为什么`readonly`与引用类型一起使用而`const`不能（期望字符串）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-20T21:40:26.627

你可以稍微改变你的班级：

```
public class EstadoRestriccion
{
    public static readonly EstadoRestriccion Value1 = new EstadoRestriccion("Value1", 0);
    public static readonly EstadoRestriccion Value2 = new EstadoRestriccion("Value2", 0.5M);
    public static readonly EstadoRestriccion Value3 = new EstadoRestriccion("Value3", 1);
    private static readonly EstadoRestriccion[] values = new EstadoRestriccion[] { Value1, Value2, Value3 };

    private string name;
    private decimal value;

    private EstadoRestriccion(string name, decimal value)
    {
        this.name = name;
        this.value = value;
    }

    public static EstadoRestriccion[] GetValues()
    {
        return values;
    }

    public override string ToString()
    {
        return this.name;
    }
}; 
```

以及一些`decimal`转换和/或更改`value`为公共财产。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-20T21:27:24.390

`static readonly`十进制数组怎么样？

```
public static readonly decimal[] myValues = new[] {0, 0.5M, 1}; 
```

# java - App Engine：保持 Socket 打开超过 2 分钟

> ID：15535050
> 
> 赞同：4
> 
> 时间：2013-03-20T21:26:12.880
> 
> 标签：java, google-app-engine, sockets

使用 App Engine 受信任的测试器套接字连接到 APNS。写入套接字工作正常。

但问题是 Socket 在 2 分钟不活动后被回收。它在 Trusted Tester 网站上说，任何套接字操作都会使套接字继续存活 2 分钟。在 APNS 决定关闭连接之前保持套接字打开会更好。

在尝试了几乎所有没有写入输出流的 Socket API 方法之后，无论如何 2 分钟后 Socket 都会关闭。我错过了什么？

部署在java后端。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-27T10:32:35.690

您不能人为地打开连接到 APNS 的套接字；无需发送实际的推送通知。保持它打开的唯一方法是发送一些任意数据/字节，但这会导致套接字立即关闭；一旦检测到不符合协议的内容，即不是实际推送通知的内容，APNS 就会立即关闭连接。

`SO_KEEPALIVE`

怎么样`SO_KEEPALIVE`？App Engine 明确表示支持。我认为这只是意味着它不会在您调用时抛出异常`Socket.setKeepAlive(true)`；调用想要设置套接字选项之前引发了未实现的异常。即使您启用 keep-alive，如果您超过 2 分钟不发送任何内容，您的套接字也会被回收（关闭）；至少到目前为止在 App Engine 上。

其实，这并不是什么大惊喜。[指定 TCP Keep Alive 的RFC1122](https://www.rfc-editor.org/rfc/rfc1122#page-101)明确指出 TCP Keep Alive 不能每两个小时发送一次以上，然后，只有在没有其他流量时才需要。虽然它还说这个间隔也必须是可配置的，但没有 API`java.net.Socket`可以用来配置它（很可能是因为它高度依赖于操作系统），我怀疑它会在 App Engine 上设置为 2 分钟。

`SO_TIMEOUT`

怎么样`SO_TIMEOUT`？这是为了完全不同的东西。状态的javadoc `Socket.setSoTimeout()`：

> 使用指定的超时启用/禁用 SO_TIMEOUT，以毫秒为单位。将此选项设置为非零超时，对与此 Socket 关联的 InputStream 的 read() 调用将仅阻塞此时间量。如果超时到期，则会引发 java.net.SocketTimeoutException，尽管 Socket 仍然有效。必须在进入阻塞操作之前启用该选项才能生效。超时必须 > 0。超时为零被解释为无限超时。

也就是说，当`read()`因为没有什么可阅读的内容而阻塞太久时，您可以说“好的，我不想再等待（阻塞）；让我们做点别的吧”。这对我们的“2 分钟”问题没有帮助。

`What then?`

解决此问题的唯一方法是：检测连接何时被回收/关闭，然后将其丢弃并打开一个新连接。并且有一个完全支持该功能的库。

退房`java-apns-gae`。

它是一个开源 Java APNS 库，专为在 Google App Engine 上工作（和使用）而设计。

[https://github.com/ZsoltSafrany/java-apns-gae](https://github.com/ZsoltSafrany/java-apns-gae)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T21:18:37.610

您是否尝试过 getSoLinger()？这可能是当前（某种）有效的 getSocketOpt，它可能会重置 2 分钟超时。从理论上讲，也可以进行零字节读取，但我不确定如果您尝试这样做，是否会在输入流上使用此方法。

公共 int 读取（字节 b []，int 关闭，int len）

如果这些建议不起作用，请向 App Engine 问题跟踪器提出问题。

将会有一些其他的修复，例如使用套接字选项等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-22T09:53:05.167

使用`getpeername()`.

来自[https://developers.google.com/appengine/docs/java/sockets/overview](https://developers.google.com/appengine/docs/java/sockets/overview) ...

> 套接字可以在 2 分钟不活动后回收；**任何套接字操作（例如 getpeername）使套接字再保持活动 2 分钟**。（请注意，您不能在多个可用套接字之间进行选择，因为这需要当前不支持的 java.nio.SocketChannel。）

# android - Android webview onTouch() 无法正常工作

> ID：15535052
> 
> 赞同：0
> 
> 时间：2013-03-20T21:26:29.783
> 
> 标签：android, android-webview

我的代码：

```
final WebView webView1 = (WebView)findViewById(R.id.example);

        webView1.setOnTouchListener(new View.OnTouchListener() {  
            public boolean onTouch(View v, MotionEvent event) {
            Intent intent = new Intent(Ads.this, General.class);
            startActivity(intent);
            finish();
                return false;
            }
        });
        webView1.getSettings().setJavaScriptEnabled(true);
        webView1.setBackgroundColor(Color.TRANSPARENT);
        StringBuilder htmlData = new StringBuilder("<html>"); 
        htmlData.append("<head></head>");
        htmlData.append("<body style='margin:0;padding:0;'>"); 
        htmlData.append("banner from my websive with link"); 
        htmlData.append("</body>"); 
        htmlData.append("</html>"); 
        webView1.loadData(htmlData.toString(),"text/html", "ISO 8859-1"); 
```

请问，我哪里有问题？

我如何启动第一个 Intent 和 browserver 窗口之后？

PS：我不知道为什么，但如果我点击 webview，intent 会同时启动 5 次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:43:27.520

尝试使用此代码

```
webView1.setOnTouchListener(new View.OnTouchListener() {  
            public boolean onTouch(View v, MotionEvent event) {
            if(event.getAction() == MotionEvent.ACTION_DOWN){
                Intent intent = new Intent(Ads.this, General.class);
                startActivity(intent);
                finish();
              }  
              return true;
            }
        }); 
```

# ios - 更新 UITableViewCell 子视图的框架没有效果

> ID：15535054
> 
> 赞同：6
> 
> 时间：2013-03-20T21:26:33.523
> 
> 标签：ios, objective-c, uitableview, uilabel

我有一个自定义（子类化）UITableViewCell，其中包含一些 UILabel、一个 UIButton 和一个 NSBlock 作为属性。这个子类称为`ExploreCell`. 其中两个属性是 UILabel，分别命名为`waitLabel`和`lastUpdateLabel`。

当内容`lastUpdateLabel`为 nil 或为空白`@""`时，我需要`waitLabel`垂直向下（在 Y 轴上）移动 10 个像素。我通过检查一些对象来做到这一点，`NSDictionary`如下面的代码所示，我在`-tableView:cellForRowAtIndexPath:`方法中放入了这些对象。

```
CGRect frame = cell.waitLabel.frame;

if ([[venue allKeys] containsObject:@"wait_times"] && ([[venue objectForKey:@"wait_times"] count] > 0)) {

    frame.origin.y = 43;

}

else {
    frame.origin.y = 53;
}

[cell.waitLabel setFrame:frame]; 
```

但是，此代码间歇性地工作，并且尝试调用`-setNeedsLayout`，仍然无法正常工作。间歇性地，我的意思是，在滚动几次之后，符合条件的一两个单元格将单元格的原点向下移动 10 个像素，实际上它们`waitLabel`的框架发生了变化。

请您告诉我为什么会发生这种情况，以及如何解决。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-20T22:02:01.647

这看起来像是自动布局的问题。如果您没有明确将其关闭，则它已打开。您应该为单元格顶部（或底部）的约束创建一个出口，并在代码中更改该约束的常量，而不是设置框架。根据 WWDC 2012 视频，如果您使用自动布局，则代码中不应包含任何 setFrame: 消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:36:18.690

你试过跑步吗

```
[CATransaction flush];
[CATransaction begin]; 
```

更新这些值后在主线程上？

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-03-20T21:51:02.840

当您更改任何单元格中的布局并希望立即看到它们时，您需要使用 [tableView beginUpdates] + [tableView endUpdates]。

```
-(void)someMethod
{
    [tableView beginUpdates];
    // your code:
    CGRect frame = cell.waitLabel.frame;

    if ([[venue allKeys] containsObject:@"wait_times"] && ([[venue objectForKey:@"wait_times"] count] > 0)) 
    {

        frame.origin.y = 43;

    }
    else {
        frame.origin.y = 53;
    }
    [cell.waitLabel setFrame:frame];

    [tableView endUpdates];
} 
```

确保 [tableView beginUpdates] 和 [tableView endUpdates] 始终在一起。

# java - java中没有名字的线程的影响

> ID：15535060
> 
> 赞同：3
> 
> 时间：2013-03-20T21:26:58.507
> 
> 标签：java, multithreading

我的 java 应用程序中有各种 Thread 语法

```
new Thread(this).start(); 
```

当我使用[Code Pro](https://developers.google.com/java-dev-tools/download-codepro)执行代码审核时，我收到以下消息

```
Thread declare without a name. 
```

我想知道这是什么意思，如果我将声明更改为

```
new Thread(this,this.getName()).start(); 
```

它们之间有什么区别以及它们的影响。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:28:39.223

这只是 Code Pro 提醒您线程应该有一个识别名称的礼貌方式，以便在涉及到该名称时更容易调试。除此之外，它没有任何“影响”，它只是一种很好的编程实践。这应该有效：

```
new Thread(this, "an identifying name").start(); 
```

请注意，`this.getName()`仅当您已经`getName()`在当前类中定义了要返回的名称时才有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:29:10.157

不同之处在于线程现在具有您为其指定的名称，而不是默认名称。显然，有人认为这足以阻止审计。我当然不会。

# c# - WCF 服务 - 不实现接口成员

> ID：15535061
> 
> 赞同：0
> 
> 时间：2013-03-20T21:27:04.220
> 
> 标签：c#, asp.net, .net, asp.net-mvc, wcf

我正在关注如何在位于[此处的 WCF 服务中添加授权的指南。](http://www.kotancode.com/2010/08/06/aspnet-authentication-wp7/)

现在我的问题是当我创建服务并从中删除 .DoWork() 方法时，我收到一条错误消息：

“Testing.HelloService”没有实现接口成员“Testing.IHelloService.DoWork()

这显然是因为我删除了它，但是需要它吗？在指南中，它基本上说要从中删除 .DoWork() 方法，所以我猜写它的人错过了一些东西。

当我创建它的服务时，它会将 HelloService 和 IHelloService 文件添加到项目中。我需要对 IHelloService 添加更改吗？

这是 HelloService.svc.cs 中的代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.ServiceModel;
using System.Text;
using System.Web;
using System.ServiceModel.Activation;

namespace MLA_Test_Service
{
    // NOTE: You can use the "Rename" command on the "Refactor" menu to change the class name "HelloService" in code, svc and config file together.
    [AspNetCompatibilityRequirements(
    RequirementsMode = AspNetCompatibilityRequirementsMode.Required)]
    public class HelloService : IHelloService
    {
        public string HelloWorld()
        {
            if (HttpContext.Current.User.Identity.IsAuthenticated)
                return HttpContext.Current.User.Identity.Name;
            else
                return "Unauthenticated Person";
        }
    }
} 
```

这是来自 IHelloService.cs 的代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.ServiceModel;
using System.Text;

namespace MLA_Test_Service
{
    // NOTE: You can use the "Rename" command on the "Refactor" menu to change the interface name "IHelloService" in both code and config file together.
    [ServiceContract]
    public interface IHelloService
    {
        [OperationContract]
        void DoWork();
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:31:14.287

您的实现需要与您的界面相匹配。如果不想实现DoWork方法，就需要从实现和Interface上去。

实际上，您可能应该将 DoWork 替换为您实际要在服务上调用的方法的名称，然后实现该方法。它应该作为如何在 WCF 服务上启动操作的示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:34:09.920

其简单的 C#，您正在继承一个接口，您必须在类中实现它的所有声明方法。

`DoWork()`存在于您的接口中，因此在您的`HelloService`类中实现它。

此外，只有那些方法对您的 WCF-Service 客户端可见，它们将在`OperationContract`接口中声明并标记`[OperationContract]`

# coffeescript - 使用 Eco 和 CoffeeScript

> ID：15535063
> 
> 赞同：0
> 
> 时间：2013-03-20T21:27:12.447
> 
> 标签：coffeescript, docpad, eco

如何使用 If 语句来指定 docpad.coffee 文件中定义的变量。

我想做这样的事情：

```
<% if sponsor.type == 'Gold': %>
<li class="sponsor-item gold" itemscope itemtype="http://schema.org/Organization">
  <a href="<%= sponsor.url %>" class="sponsor-logo sponsor-link" itemprop="url">
    <img src="<%= sponsor.logo %>" alt="<%= sponsor.name %>" class="photo" itemprop="image">
  </a>
<% else: %>
<li class="sponsor-item" itemscope itemtype="http://schema.org/Organization">
  <a href="<%= sponsor.url %>" class="sponsor-logo sponsor-link" itemprop="url">
    <img src="<%= sponsor.logo %>" alt="<%= sponsor.name %>" class="photo" itemprop="image">
  </a>
<% end %> 
```

这是我制作的代码，但他找到了字符串，但没有在黄金赞助商类型中添加类“gold”（在 li 中定义）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:21:48.057

要获取在模板数据中定义的变量，您必须在它们前面加上`@`字符，就像这样`@sponsor`-> 这`this.sponsor`在 javascript 中转换为。

这是因为模板数据变量被分配给 eco 中的 this 范围。您可以在此处阅读有关此内容的更多信息：[https ://github.com/sstephenson/eco#the-context-object](https://github.com/sstephenson/eco#the-context-object)

# regex - 匹配一个或多个 Lua 模式

> ID：15535065
> 
> 赞同：1
> 
> 时间：2013-03-20T21:27:18.680
> 
> 标签：regex, lua, pattern-matching, string-matching

我想知道是否有可能制作一个可以像这样工作的模式：

使用`[icon=star w=32 h=32 spin=90]`，它将返回一个包含以下内容的表：

```
icon: star  
w: 32  
h: 32  
spin: 90 
```

我试过做`[icon=(.-) ((.-)=(.-))]`，但它坏了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:40:59.607

Lua 没有字面意义上的正则表达式。它使用模式。

因此，对于您的情况，我更愿意使用 gsub（或 gmatch）：

```
local str = "[icon=star w=32 h=32 spin=90]"
local tR = {}
str:gsub( "(%w+)%=(%w+)", function( x, y ) tR[x] = y end ) 
```

您`tR`将获得您想要的确切结果。

* * *

更多关于 gmatch 和 gsub 的教程是：

*   [http://lua-users.org/wiki/StringLibraryTutorial](http://lua-users.org/wiki/StringLibraryTutorial)
*   [http://www.lua.org/manual/5.1/manual.html#pdf-string.gmatch](http://www.lua.org/manual/5.1/manual.html#pdf-string.gmatch)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:32:25.417

使用以下表达式：`(\w+(?=\=))=((?<=\=)\w+)`每个匹配的第 1 组将是左侧，每个匹配的第 2 组将是右侧。

示例：[http ://regexr.com?3478b](http://regexr.com?3478b)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T03:35:20.627

```
for k, v in ("[icon=star w=32 h=32 spin=90]"):gmatch("(%w+)=(%w+)")
  do print(k..":",v) end

icon:   star
w:  32
h:  32
spin:   90 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T21:40:13.163

尝试这个：

```
(\w+)=(\w+) 
```

每场比赛将有两组：

*   第 1 组将是“名称”
*   第 2 组将是“价值”

# c# - “System.Windows.Data.Binding”不是属性“SelectedIndex”的有效值

> ID：15535067
> 
> 赞同：0
> 
> 时间：2013-03-20T21:27:18.760
> 
> 标签：c#, wpf, combobox, selectedindex, markup-extensions

有人可以解释一下这个错误吗？

起初我以为 SelectedIndex 可能只是不是 DependencyProperty 并且不能绑定，但我错了。

如果我使用普通绑定而不是标记扩展名`src:ValidatedBinding`，或者如果我保留标记扩展名但绑定`SelectedItem`而不是`SelectedIndex`，那么它可以工作。

这是一个演示问题的小应用程序。

主窗口：

```
<Window       x:Class="WpfApplication2.MainWindow"
                xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
              xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
            xmlns:src="clr-namespace:WpfApplication2"
                Title="MainWindow" 
               Height="350" 
                Width="525"
                     >
    <ComboBox SelectedIndex="{src:ValidatedBinding SelectedIndex}"
              VerticalAlignment="Center" HorizontalAlignment="Center" Width="100">
        <ComboBoxItem>Not Specified</ComboBoxItem>
        <ComboBoxItem>First</ComboBoxItem>
        <ComboBoxItem>Second</ComboBoxItem>
    </ComboBox>
</Window> 
```

主窗口后面的代码：

```
using System.Windows;

namespace WpfApplication2
{
    /// <summary>
    /// The main window.
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

            DataContext = new Item { Description = "Item 1", SelectedIndex = 0 };
        }
    }

    /// <summary>
    /// An object with a string and an int property.
    /// </summary>
    public sealed class Item
    {
        int _selectedIndex;
        string _description;

        public string Description
        {
            get { return _description; }
            set { _description = value; }
        }

        public int SelectedIndex
        {
            get { return _selectedIndex; }
            set { _selectedIndex = value; }
        }
    }
} 
```

标记扩展的代码：

```
using System;
using System.Windows;
using System.Windows.Data;
using System.Windows.Markup;

namespace WpfApplication2
{
    /// <summary>
    /// Creates a normal Binding but defaults NotifyOnValidationError and 
    /// ValidatesOnExceptions to True, Mode to TwoWay and UpdateSourceTrigger
    /// to LostFocus.
    /// </summary>
    [MarkupExtensionReturnType(typeof(Binding))]
    public sealed class ValidatedBinding : MarkupExtension
    {
        public ValidatedBinding(string path)
        {
            Mode = BindingMode.TwoWay;

            UpdateSourceTrigger = UpdateSourceTrigger.LostFocus;

            Path = path;
        }

        public override object ProvideValue(IServiceProvider serviceProvider)
        {
            var Target = (IProvideValueTarget)serviceProvider.GetService(typeof(IProvideValueTarget));

            /* on combo boxes, use an immediate update and validation */
            DependencyProperty DP = Target.TargetProperty as DependencyProperty;
            if (DP != null && DP.OwnerType == typeof(System.Windows.Controls.Primitives.Selector)
                && UpdateSourceTrigger == UpdateSourceTrigger.LostFocus) {
                UpdateSourceTrigger = UpdateSourceTrigger.PropertyChanged;
            }

            return new Binding(Path) {
                Converter = this.Converter,
                ConverterParameter = this.ConverterParameter,
                ElementName = this.ElementName,
                FallbackValue = this.FallbackValue,
                Mode = this.Mode,
                NotifyOnValidationError = true,
                StringFormat = this.StringFormat,
                ValidatesOnExceptions = true,
                UpdateSourceTrigger = this.UpdateSourceTrigger
            };
        }

        public IValueConverter Converter { get; set; }

        public object ConverterParameter { get; set; }

        public string ElementName { get; set; }

        public object FallbackValue { get; set; }

        public BindingMode Mode { get; set; }

        [ConstructorArgument("path")]
        public string Path { get; set; }

        public string StringFormat { get; set; }

        public UpdateSourceTrigger UpdateSourceTrigger { get; set; }
    }
} 
```

我运行此应用程序时的异常：

> System.Windows.Markup.XamlParseException 发生
> HResult=-2146233087 Message= **'Set property 'System.Windows.Controls.Primitives.Selector.SelectedIndex' 引发异常。**' 行号 '9' 和行位置 '19'。
> 来源=PresentationFramework LineNumber=9 LinePosition=19
> StackTrace：在 System.Windows.Markup.WpfXamlLoader.LoadBaml（XamlReader xamlReader，布尔 skipJournaledProperties，对象 rootObject，XamlObjectWriterSettings 设置，Uri baseUri）处的 System.Windows.Markup.WpfXamlLoader.Load（XamlReader xamlReader，布尔型 skipJournaledProperties，对象 rootObject , XamlAccessLevel accessLevel, Uri baseUri) 在 System.Windows.Markup.XamlReader.LoadBaml(Stream stream, ParserContext parserContext, Object parent, Boolean closeStream) 在 System.Windows.Application.LoadComponent(Object component, Uri resourceLocator) 在 WpfApplication2.MainWindow。 InitializeComponent() in c:\Users\Administrator\Documents\Visual Studio 2012\Projects\WpfApplication2\MainWindow.xaml:line 1 at WpfApplication2.MainWindow..ctor() in c:\Users\Administrator\Documents\Visual Studio 2012\Projects\WpfApplication2\MainWindow.xaml.cs：第 12 行
> InnerException：System.ArgumentException HResult=-2147024809 消息= **“System.Windows.Data.Binding”不是属性“SelectedIndex”的有效值**. Source=WindowsBase StackTrace：在 System.Windows.DependencyObject.SetValueCommon（DependencyProperty dp，对象值，PropertyMetadata 元数据，布尔 coerceWithDeferredReference，布尔 coerceWithCurrentValue，OperationType operationType，布尔 isInternal）在 System.Windows.DependencyObject.SetValue（DependencyProperty dp，对象值）在 System.Windows.Baml2006.WpfMemberInvoker.SetValue(Object instance, Object value) 在 MS.Internal.Xaml.Runtime.ClrObjectRuntime.SetValue(XamlMember member, Object obj, Object value) 在 MS.Internal.Xaml.Runtime.ClrObjectRuntime。 SetValue(Object inst, XamlMember property, Object value) InnerException:

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T10:33:21.093

Ok, here is a proxy binding that works if anyone is interested.

Thank you @HighCore for pointing me in the right direction.

I use this binding proxy to set non-standard default values on the binding so I don't have to set them everywhere. This makes my xaml more compact, and allows me to have a central place where I 'style' my bindings.

These are the defaults:

*   NotifyOnValidationError = True,
*   ValidatesOnExceptions = True,
*   Mode = TwoWay,
*   UpdateSourceTrigger = LostFocus for 'Text' properties, otherwise PropertyChanged.

The `UpdateSourceTrigger` will change to `PropertyChanged` if the target property is not a `Text` property. (e.g. Combos or CheckBoxes)

If I don't need validation, I use the normal binding:

```
<TextBlock Text="{Binding FirstName}" /> 
```

If I need a normal two way binding, I know I might need validation so I use this binding proxy:

```
<TextBox Text="{i:ValidatedBinding FirstName}" /> 
```

That means I don't have to write out:

```
<TextBox Text="{Binding FirstName
    , Mode=TwoWay
    , UpdateSourceTrigger=LostFocus
    , NotifyOnValidationError=True
    , ValidatesOnExceptions=True" /> 
```

It works on both `SelectedItem` (reference types) and `SelectedIndex` (value types).

It will monitor the DataContext and maintain the binding.

If you find holes in the code, fix bugs or have any suggestions, please let me know.

```
using ITIS.Reflection /* you can replace this with System.Reflection */;
using System;
using System.Windows;
using System.Windows.Data;
using System.Windows.Markup;

namespace ITIS
{
    /// <summary>
    /// Creates a Binding with the following defaults:
    /// <para>- NotifyOnValidationError = True, </para>
    /// <para>- ValidatesOnExceptions = True, </para>
    /// <para>- Mode = TwoWay, </para> 
    /// <para>- UpdateSourceTrigger = LostFocus for 'Text' properties, otherwise PropertyChanged.</para>
    /// </summary>
#if !SILVERLIGHT
    [MarkupExtensionReturnType(typeof(Binding))]
#endif
    public sealed class ValidatedBinding : MarkupExtension
    {
        #region CONSTRUCTOR

        public ValidatedBinding(string path)
        {
            Mode = BindingMode.TwoWay;

            Path = path;

            /* possibly changed again in ProvideValue() */
            UpdateSourceTrigger = UpdateSourceTrigger.Default;
        }

        #endregion

        #region PROPERTIES

        public IValueConverter Converter { get; set; }

        public object ConverterParameter { get; set; }

        public string ElementName { get; set; }

        public object FallbackValue { get; set; }

        public BindingMode Mode { get; set; }

#if !SILVERLIGHT
        [ConstructorArgument("path")]
#endif
        public string Path { get; set; }

        public string StringFormat { get; set; }

        public UpdateSourceTrigger UpdateSourceTrigger { get; set; }

        #endregion

        #region FIELDS

        bool _bound;
        DependencyProperty _property;
        FrameworkElement _element;

        #endregion

        #region OPERATIONS

        void ClearBinding()
        {
            _element.ClearValue(_property);
        }

        public override object ProvideValue(IServiceProvider serviceProvider)
        {
            IProvideValueTarget Target = serviceProvider.GetService(typeof(IProvideValueTarget)) as IProvideValueTarget;

            if (Target == null) {
                throw new InvalidOperationException(
                    "Cannot resolve the IProvideValueTarget. Are you binding to a property?");
            }

#if !SILVERLIGHT
            /* on text boxes, use a LostFocus update trigger */
            _property = Target.TargetProperty as DependencyProperty;

            if (_property != null) {
                if (_property.Name.StartsWith("Text")) {
                    UpdateSourceTrigger = UpdateSourceTrigger.LostFocus;
                }
                else {
                    UpdateSourceTrigger = UpdateSourceTrigger.PropertyChanged;
                }
            }
#endif

            _element = Target.TargetObject as FrameworkElement;

            if (_element != null) {

                _element.DataContextChanged += Element_DataContextChanged_SetBinding;

                if (_element.DataContext != null || !string.IsNullOrWhiteSpace(ElementName)) {

                    SetBinding();

                    /* can be replaced with normal reflection PropertyInfo.GetValue() */
                    return FastReflector.GetPropertyValue(/* object = */ _element.DataContext, /* property name = */ Path);
                }

                /* don't return null for value types */
                if (_property.PropertyType.IsValueType) {
                    return Activator.CreateInstance(_property.PropertyType);
                }

                return null;
            }

            return this;
        }

        void SetBinding()
        {
            _bound = true;

            Binding Binding = new Binding() {
                Path = new PropertyPath(this.Path),
                Converter = this.Converter,
                ConverterParameter = this.ConverterParameter,
                FallbackValue = this.FallbackValue,
                Mode = this.Mode,
                NotifyOnValidationError = true,
                StringFormat = this.StringFormat,
                ValidatesOnExceptions = true,
                UpdateSourceTrigger = this.UpdateSourceTrigger
            };

            /* only set when necessary to avoid a validation exception from the binding */
            if (_element.DataContext != null) { Binding.Source = _element.DataContext; }
            if (!string.IsNullOrWhiteSpace(ElementName)) { Binding.ElementName = ElementName; }

            _element.SetBinding(_property, Binding);
        }

        #endregion

        #region EVENT HANDLERS

        void Element_DataContextChanged_SetBinding(object sender, DependencyPropertyChangedEventArgs e)
        {
            /* cleanup the old binding */
            if (_bound) { ClearBinding(); }

            SetBinding();
        }

        #endregion
    }
} 
```

# c# - 使用 Selenium WebDriver C# 在下拉列表中选择每个选项

> ID：15535069
> 
> 赞同：18
> 
> 时间：2013-03-20T21:27:27.750
> 
> 标签：c#, selenium

我无法在下拉列表中选择选项。我想我需要有`.Select`or `SelectElement`，但没有这样的选择。

示例代码：

```
IWebDriver ffbrowser = new FirefoxDriver();
ffbrowser.Navigate().GoToUrl("http://www.amazon.com/");
ffbrowser.Manage().Window.Maximize();

Thread.Sleep(500);

IWebElement ddl = ffbrowser.FindElement(By.Name("url"));
int numofitems = ddl.FindElements(By.TagName("option")).Count;

for (int i = 1; i < numofitems; i++)
{
    ffbrowser.select("TagName = option", "index = i");
} 
```

“ffbrowser.select”中的“select”报错：

错误 1 ​​'OpenQA.Selenium.IWebDriver' 不包含 'select' 的定义，并且找不到接受类型为 'OpenQA.Selenium.IWebDriver' 的第一个参数的扩展方法 'select'（您是否缺少 using 指令或装配参考？）

我的项目参考包括`Selenium.WebDriverBackedSelenium`, `Thoughtworks.Selenium.Core`, `WebDriver`,`WebDriver.Support`

我有

```
using NUnit.Framework;
using OpenQA.Selenium;
using OpenQA.Selenium.Chrome;
using OpenQA.Selenium.Firefox;
using OpenQA.Selenium.IE;
using OpenQA.Selenium.Support.UI; 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-20T22:01:51.627

根据您使用的 Selenium WebDriver 版本，您可以使用`SelectElement`该类，该类将包含在`OpenQA.Selenium.Support.UI`.
例如：

```
SelectElement selector = new SelectElement(element);
selector.SelectByIndex(1); 
```

元素是您的*下拉*框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T10:02:09.777

这是一个示例，可以更好地说明如何获取下拉列表中的所有项目并从下拉列表中选择项目。

下拉列表的示例 Html 代码

```
<select>
  <option>Milk</option>
  <option>Coffee</option>
  <option>Tea</option>
</select> 
```

下面的代码从上面的下拉列表中获取所有项目并选择项目'Coffee'。代码逻辑如下

Step 1\. 创建 web element 标签的接口 Step 2\. 创建一个包含 web element tag 的所有子元素的 IList Step 3\. 选择 Drop List 项“Coffee”

```
using System;
using System.Collections.Generic;
using OpenQA.Selenium;
using OpenQA.Selenium.Firefox;
using OpenQA.Selenium.Support.UI;

namespace SeleniumTests
{
    class DropDownListSelection
    {
        static void Main(string[] args)
        {
            IWebDriver driver = new FirefoxDriver(); 
            driver.Navigate().GoToUrl("http://DropDownList.html");
            IWebElement element = driver.FindElement(By.XPath("//Select"));
            IList<IWebElement> AllDropDownList =    element.FindElements(By.XPath("//option"));
            int DpListCount = AllDropDownList.Count;
            for (int i = 0; i < DpListCount; i++)
            {
                if (AllDropDownList[i].Text == "Coffee")
                 {
                    AllDropDownList[i].Click();
                 }
            }
            Console.WriteLine(DpListCount);
            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-04T08:53:58.587

您还可以使用：

```
new SelectElement(driver.FindElement(By.Id("")).SelectByText("")); 
```

或者：

```
new SelectElement(driver.FindElement(By.Id("")).SelectByValue("")); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-27T18:45:50.617

使用下面的简单示例代码：

```
String Input="Value to Select"; 
String xPathVal="@["id=Samplexpath"]"; 
IWebElement TargetElement = driver.FindElement(By.XPath(xPathVal)); 
SelectElement dropdown = new SelectElement(TargetElement); 
dropdown.SelectByText(Input.Trim()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-22T14:30:43.117

这完美地工作......

```
SelectElement selector = new SelectElement(element);
selector.SelectByIndex(1); 
```

元素是您的下拉框。

# apache-flex - 如何在 Spark DataGrid 中设置行的文本颜色

> ID：15535070
> 
> 赞同：0
> 
> 时间：2013-03-20T21:27:28.167
> 
> 标签：apache-flex, flex-spark

我在 Spark DataGrids 中设置行颜色和文本颜色时遇到了很多麻烦，我记不清了。这篇文章展示了如何设置它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:30:59.287

要在网格项目行上设置文本样式，我们需要创建一个新的 DataGrid 项目渲染器。

不幸的是，当我们在 Flash Builder 中创建一个新的 ItemRenderer 时，它只会创建一个只有一个标签的简单的 ItemRenderer。默认情况下，它不添加对状态的任何支持。

要设置我们需要的样式，我们需要创建一个带有悬停状态的新 ItemRenderer，然后为这些状态设置颜色值。

```
<?xml version="1.0" encoding="utf-8"?>
<s:GridItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009" 
                    xmlns:s="library://ns.adobe.com/flex/spark" 
                    xmlns:mx="library://ns.adobe.com/flex/mx" 
                    clipAndEnableScrolling="true">

    <s:states>
        <s:State name="normal" />
        <s:State name="hovered" />
        <s:State name="down" />
        <s:State name="selected" />
    </s:states>

    <s:Label id="labelDisplay" top="9" left="7"
             color.normal="#171515" 
             color.hovered="#FFFFFF" 
             color.down="#FFFFFF"
             color.selected="#FFFFFF"
             />

</s:GridItemRenderer> 
```

然后我们需要将 DataGrid 指向我们的项目渲染器：

```
<s:DataGrid itemRenderer="view.renderers.AbstractDataGridItemRenderer"> 
```

# algorithm - 带负数的最大段总和

> ID：15535078
> 
> 赞同：1
> 
> 时间：2013-03-20T21:28:12.517
> 
> 标签：algorithm, dynamic, numbers, intervals

给定 N 个数字（正数和负数）并且 T = 您可以选择的数字数，您如何计算区间的最大总和？区间的第一个数字被认为是 0。

例如： N=5 T=4 and {3 9 1 1 7} 最大和是 16 来自 (3, 9) 和 (1, 7) ！记住 3 和 1 被认为是 0，因为它们是它们间隔中的第一个数字。我想出了一个解决方案，但是当我添加负数时它会搞砸。N=4 T=3 和 {-2 1 -3 -4} 解是 1 (-2, 1) 和 (-3 -3) （当你使用负数时，你可以考虑由相同的负数形成的区间数字 (-3 -3) = 0)。有任何想法吗？

*稍后编辑：我的代码有什么问题？[http://pastebin.com/QTTTrvUz](http://pastebin.com/QTTTrvUz)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:14:56.780

[动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)是你的朋友：

假设我们可以选择数字，让我们`S[i][j]`表示仅考虑第一个数字时可以获得的最大总和。`i``j`

然后：

1.  `S[i][j] = S[i - 1][j]`, 如果`i`不在一个段中。
2.  `S[i][j] = S[i - k][j - k] + value_of_segment(i - k + 1, i)`，如果`i`在一段长度中`k`。

我们让`S[i][j] = max((1), (2))`.

`value_of_segment`可以预先计算在`O(n)`.

`S[i][j]`可以计算在`O(N * T^2)`.

# css - CSS显示但保持行高

> ID：15535081
> 
> 赞同：0
> 
> 时间：2013-03-20T21:28:15.713
> 
> 标签：css

我正在使用一个表格来显示一些数据，对于一行，我正在显示一个（可能）更长的字符串的 35 个字符的预览。当用户将鼠标悬停在其中一个预览上时，它会在其旁边显示全文。

问题是显示全文时，`tr`高度会更改以适合全文，但我希望它保持相同的大小。

```
<td><a href="link.asp?tid=<%=ID%>" onmouseover="showDetails(<%=ID%>);"><%=shortPreview%></a>
<br/><div class="details" style="display:none;" id="<%=ID%>"><%=rsTickets("details")%></div></td> 
```

CSS

```
.details {
  position:relative;
  top:-15px;
  left:260px;
  background-color:#FFFFAA;
  z-index:1;
  padding-top:5px;
  padding-bottom:5px;
  padding-right:15px;
  padding-left:5px;
  border:1px;
  border-style:solid;
  border-color:#CCCC99;

  -moz-border-radius: 1em 2em 2em 1em;
  border-radius: 1em 2em 2em 1em;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:30:04.583

在单元格内放置一个固定大小的 div 并将其设置为`position: relative`. 在那个 div 里面放一个你的详细信息并将其设置为`position: absolute;`. 这应该适用于 99%。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:09:46.920

问题是，当您将对象设置为相对时，它与周围的对象相关。这意味着如果你改变 div 的高度（或者在这种情况下，显示它），周围的对象将适应这种变化。因此，当您将 div 设置为可见时，封装它的 td 也会改变它的高度。

将 div 设置为绝对位置可以解决问题，但是可能很难将其正确定位。除非你把它放在另一个 div 中。如果你将绝对 div 放在相对 div 中，那么绝对 div 对 relavite div 是绝对的，从而解决问题。这是一个例子：

```
<table>
    <tr><td><div style=position:relative>
          This div will not affect the td more than will this text.
          <div style=position:absolute;top10px;>
               This div will not affect the td, since it's absolute, and will be
               10px from the top of the outer div
          </div>
    </div></td></tr>
</table> 
```

这应该可以解决问题。至少对我有用。

# ruby-on-rails - 是否可以将 ERB 放入 simple_form 占位符字符串？

> ID：15535084
> 
> 赞同：-1
> 
> 时间：2013-03-20T21:28:32.710
> 
> 标签：ruby-on-rails, ruby-on-rails-3, erb, simple-form

我有一个包含占位符文本的表单。我希望能够使其成为动态的一部分。这似乎很简单，但我无法弄清楚。我错过了什么？

这是表格：

```
<%= simple_form_for([@reviewable, @review]) do |f| %>
  <%= f.error_notification %>
  <div class="form-inputs">
    <%= f.input :review, :input_html => { :class => "span4", :rows => 10 },
                label: false,                                
                placeholder: 'Help others by sharing what you\'ve learned as a major.' %>
  </div>
  <div class="modal-footer">
    <button class="btn cancel-modal-review" data-dismiss="modal" aria-hidden="true">Cancel</button>
    <%= f.submit 'Share My Review', :class => "submit-feedback" %>
  </div>
<% end %> 
```

我希望占位符文本按照以下方式阅读：

```
placeholder: 'Help others by sharing what you\'ve learned as a <%= @major.name %> major.' 
```

但是当我这样做时，它的字面意思是“通过分享您作为 <%= @major.name %> 专业所学的知识来帮助他人”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:37:42.723

问题是，如果您将字符串放在单引号内，它将按字面意思显示。使用双引号可以正确解析 #{} 中的结果。

试试这个：

```
placeholder: "Help others by sharing what you\'ve learned as a #{@major.name} major." 
```

# css - 如何将两个 div 并排放置，其中一个在两个 div 的容器中居中

> ID：15535089
> 
> 赞同：1
> 
> 时间：2013-03-20T21:28:46.483
> 
> 标签：css, html

如何将两个 div 并排放置，其中一个在两个 div 的容器中居中

如何将第二个 div 直接放在第一个 div 旁边并使其扩展到右侧？

这是一个例子：

[http://jsfiddle.net/Dpcq4/3/](http://jsfiddle.net/Dpcq4/3/)

HTML：

```
<div id="container" >
    <div id="div1"> </div>
    <div id="div2"></div>
</div> 
```

CSS：

```
 #container{ width: 100%;
              display:inline;
              height:60px;
              color:#000;
    }
    #div1{ margin-left:auto;
           margin-right:auto;
           width:200px;
           height:50px;
           background-color:#333;
    }
    #div2{ float:right;
           width:100%;
           height:50px;
           background-color:#ccc;
    } 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:58:03.383

看看这个：http: [//jsfiddle.net/GTduj/2/](http://jsfiddle.net/GTduj/2/)

```
#container{ 
    width: 600px; 
    height:60px; 
    border:1px solid #bbb;
    text-align:center;
} 
```

您的容器元素需要固定宽度，并且您希望将其内容居中。

```
#div1{        
    width:60%;
    display:inline-block;
    height:50px;     
    background-color:#333; 
} 
```

div1 可以是 % 宽度或固定的，但它需要是内联块。

```
#div2{        
    display:inline-block;
     width:10%; 
    height:50px; 
    background-color:#ccc; 
    margin-right:0;    
    position:absolute;    
} 
```

对 div2 使用 inline-block 和绝对位置，因此它会在您居中的 div1 之后挂起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:39:26.530

只是给`float:left`你`div1`，并确保这一点：

```
width(div1) + width(div2) <= width(Screen) 
```

所以，你想`div2`占用其余的空间，所以给两个 div 百分比宽度，即给 div1 30% 宽度和 div2 70% 宽度。

看到这个[小提琴](http://jsfiddle.net/manishmishra256/Dpcq4/8/)

# 更新：

所以你希望`div1`总是在 的中心`#container`，然后给它`left:50%`并相应地调整`div2`

如果那是你想要的，请看这个[小提琴。](http://jsfiddle.net/manishmishra256/Dpcq4/14/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:41:16.807

用 margin: auto 将一个 div 居中在另一个 div 中，这意味着您正在使用包含 div 的整个宽度。将 div1 放在您指定宽度的另一个 div 中，然后将 div1 浮动在其中。

```
<div id="container" >
  <div class="container">
    <div id="div1"> </div>
  </div>
  <div id="div2"></div>
</div>

.container{
  width: x%;
  float: left;
 }

#div2{
 float: left;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T21:44:38.660

假设您不希望左侧的空白区域需要删除，`margin-left:auto;`并且您还需要更改宽度。`margin-right:auto;``#div1.``#div2`

像这样的东西：

```
#div1{
    width:200px; 
    height:50px; 
    background-color:#333; 
    float:left;
}
#div2{
    width:75%; 
    height:50px; 
    background-color:#ccc; 
    margin-right:0; 
    float:left;
} 
```

但是，如果这意味着流动，我也会将`#div1`宽度更改为百分比。类似的东西`width:25%;`; 如果您打算在两个 div 的左侧有空白，那么您需要在左侧添加 div 以充当列。

[http://jsfiddle.net/Dpcq4/12/](http://jsfiddle.net/Dpcq4/12/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T21:48:50.650

这是我知道的方法。也许其他人可以告诉我们一个更好的方法。

首先，像这样硬编码css中的宽度

```
#container{ 
    width: 600px; 
    height:60px; 
    color:#000;
}
#div1{
    float: left;
    width:200px; 
    height:50px; 
    background-color:#333; 
    margin-left: 200px;
}
#div2{
    float:left; 
    width:200px; 
    height:50px; 
    background-color:#ccc; 
    margin-right:0;
} 
```

如果这不是一个选项，我敢肯定它可能不会，另一个解决方案将使用 javascript。我将在示例中使用 jquery。

```
var container = $('#container1');
var div1 = $('#div1');

div1.css('margin-left', container.width()/2-div1.width()); 
```

[http://jsfiddle.net/Dpcq4/9/](http://jsfiddle.net/Dpcq4/9/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T22:03:55.983

我的方法适用于 ie8 及更高版本以及所有其他浏览器，并严格使用 css。
通过使用 display:table 然后 display:table-cell 作为它的子元素，它将两个元素保持在同一表格行中。

```
#container{ 
   width: 100%; 
   display:table; 
   height:60px; 
   color:#000;
}
#div1{
   margin-left:auto; 
   margin-right:auto; 
   width:200px; 
   height:50px; 
   background-color:#333;
   display:table-cell; 
}
#div2{
   display:table-cell;
   height:50px; 
   background-color:#ccc; 
   margin-right:0;
   float:left;
   width:100%; 
} 
```

[http://jsfiddle.net/Dpcq4/13/](http://jsfiddle.net/Dpcq4/13/)

# asp.net-mvc-4 - 无法让 ViewContext.RouteData.Values["Controller"] 为我工作

> ID：15535091
> 
> 赞同：0
> 
> 时间：2013-03-20T21:28:54.957
> 
> 标签：asp.net-mvc-4

我做错了什么，我知道的就这么多。:) 我试图在页面上显示一个简单的面包屑。我有这样的看法：

```
@if (ViewContext.RouteData.Values["Action"].ToString() == "Index")
{
    <li>
        // This displays "Matter"
        @ViewContext.RouteData.Values["Controller"]
    </li>
}
else
{  
    <li>
        // This displays a hyperlink "Matter", 
        // but the Href goes to "MyApp/Matter/Matter"
        <a href="@ViewContext.RouteData.Values["Controller"].ToString()">
            @ViewContext.RouteData.Values["Controller"]
        </a>
    </li>
} 
```

在上述场景中，我将 Route.cs 文件设置为“MyApp/Matter”，它对应于“MatterController”上的“Index”操作。

单击该链接会将您带到不起作用的“MyApp/Matter/Matter”。

关于如何让它发挥作用的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T02:41:02.907

您正在锚标记中设置相对路径。它正在评估：

```
 <a href="Matter">Matter</a> 
```

该（物质）被附加到您当前的 URL，在这种情况下，我只能假设是“MyApp/Matter”。结果是“MyApp/Matter/Matter”。

您需要指定一个绝对 URL 或更完整的相对 URL —— ../Matter 在这种情况下可以工作。

除此之外，如果不了解您正在尝试做的事情，我将无法帮助您。

1.  你想让面包屑把它们带到哪里？与他们正在查看的内容相关的面包屑中的内容是什么？
2.  您的示例中的 MyApp 是包含应用程序的目录还是应用程序中的一个区域？
3.  我只能收集到 Matter 是控制器，但它的作用是什么？如果您正在显示一个链接，那么它当前没有查看索引操作。

# macos - 为什么从 xcodebuild 启动的脚本中的“read -t”会阻塞？

> ID：15535093
> 
> 赞同：2
> 
> 时间：2013-03-20T21:29:03.873
> 
> 标签：macos, bash, xcodebuild

我有一个创建 FIFO 并启动将输出写入 FIFO 的程序的脚本。然后我读取并解析输出，直到程序退出。

```
MYFIFO=/tmp/myfifo.$$
mkfifo "$MYFIFO"
MYFD=3
eval "exec $MYFD<> $MYFIFO"
external_program >&"$MYFD" 2>&"$MYFD" &
EXT_PID=$!

while kill -0 "$EXT_PID" ; do
  read -t 1 LINE <&"$MYFD"
# Do stuff with $LINE
done 
```

当程序仍在运行时，这可以很好地读取输入，但看起来读取超时被忽略，并且在外部程序退出后读取调用挂起。

我在其他脚本中成功地使用了超时读取，并且一个简单的测试脚本正确地忽略了外部程序超时。我在这里做错了什么？

编辑：当我从命令行运行我的脚本时，它看起来像`read -t`预期的功能，但是当我作为 xcodebuild 构建过程的一部分运行它时，超时不起作用。这两种环境有什么不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:26:35.793

我认为`-t`不会与重定向一起使用。

从[这里](http://ss64.com/bash/read.html)的手册页：

> -t timeout
> 如果在 timeout 秒内没有读取完整的输入行，则导致读取超时并返回失败。***如果 read 不是从终端*****或*****管道*****读取输入，则此选项无效。**

# javascript - 图像的新滑块

> ID：15535098
> 
> 赞同：0
> 
> 时间：2013-03-20T21:29:15.327
> 
> 标签：javascript

我可以通过 CSS 和 HTML 构建静态网页，现在想在我的页面上添加一个图像滑块，我的意思是那些自己水平滑动的图像。我对 JQuery、Javascript 或 Ajax 没有任何了解。

因此，目前我有一个图像文件夹上传到服务器，在我放入的 head 部分以引用 Javascript 文件：

```
<script type="text/javascript" src="Javascript/slider.js"></script> 
```

现在我卡住了。我如何获得

```
<div> 
```

我的 HTML 页面上的标签以引用 Javascript 来上传图像等？

生病学习编码位，但只是不知道它是如何联系在一起的。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:47:49.317

```
<script type="text/javascript" src="Javascript/slider.js">
function someFunc(domObj){
 domObj.innerHtml += "<div id=\"div2\"></div>";

 document.getElementById("div1").innerHtml +="<h1>Hello Foobar World!</h1>";
}
</script> 

<body onLoad="someFunc(this)">
<div id="div1"></div>
</body> 
```

那将是一些基本的javascript。对于滑块，您可以使用 javascript 通过 css 不断更新 div 的样式/位置。

您可能想要使用的一些 css 属性是 background-image background-position。

# ruby-on-rails - 部署 heroku 时的应用程序错误

> ID：15535099
> 
> 赞同：0
> 
> 时间：2013-03-20T21:29:32.400
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

我的应用程序在 localhost 中运行良好，但是当我部署到 heroku 并尝试创建新订单时，我收到此错误：

```
2013-03-20T21:26:02+00:00 app[web.1]: Started GET "/orders/new" for 189.44.29.3 at 2013-03-20 21:26:02 +0000
2013-03-20T21:26:02+00:00 app[web.1]: Processing by OrdersController#new as HTML
2013-03-20T21:26:02+00:00 app[web.1]:   Rendered orders/new.html.erb within layouts/application (49.4ms)
2013-03-20T21:26:02+00:00 app[web.1]: Completed 500 Internal Server Error in 62ms
2013-03-20T21:26:02+00:00 app[web.1]: 
2013-03-20T21:26:02+00:00 app[web.1]: ActionView::Template::Error (/app/app/views/orders/new.html.erb:31: unknown regexp options - tabl
2013-03-20T21:26:02+00:00 app[web.1]: /app/app/views/orders/new.html.erb:33: unterminated string meets end of file
2013-03-20T21:26:02+00:00 app[web.1]: /app/app/views/orders/new.html.erb:33: syntax error, unexpected $end, expecting keyword_end):
2013-03-20T21:26:02+00:00 app[web.1]:     28:       <td><%= order.select :drop,options_for_select({"Nao",false,"Sim",true}) %></td>
2013-03-20T21:26:02+00:00 app[web.1]:     29:   </tr>
2013-03-20T21:26:02+00:00 app[web.1]:     30:   </tbody>
2013-03-20T21:26:02+00:00 app[web.1]:     31: </table>
2013-03-20T21:26:02+00:00 app[web.1]:     32:   <%= order.submit "Criar nova Compra !"%>
2013-03-20T21:26:02+00:00 app[web.1]:     33: <% end %>
2013-03-20T21:26:02+00:00 app[web.1]:   app/controllers/orders_controller.rb:16:in `new' 
```

在我看来有这个代码：

```
<%= form_for @order do |order| %>
<table>
    <tbody>
    <tr>
        <td>Fornecedor</td>
        <td>Produto</td>
        <td>Quantidade</td>
        <td>Nr Compra</td>
        <td>Pagamento</td>
        <td>Valor</td>
        <td>Endereço</td>
        <td>Dropship</td>
    </tr>
    <tr>
        <td><%= order.select :seller,Place.all.map { |a| [a.place,a.place] }%></td>
        <td><%= order.select :product_id,Product.all.map { |a| [a.name,a.id] } %></td>
        <td><%= order.text_field :quantity,:size => 4 %></td>
        <td><%= order.text_field :order_number,:size => 2%></td>
        <td><%= order.select :payment,Place.all.map { |a| [a.place,a.place] }%></td>
        <td><%= order.text_field :value,:size => 5 %></td>
        <td><%= order.select :adress_id,Adress.all.map { |a| [a.name,a.id] }%></td>
        <td><%= order.select :drop,options_for_select({"Nao",false,"Sim",true}) %></td>
    </tr>
    </tbody>
</table>
    <%= order.submit "Criar nova Compra !"%>
<% end %> 
```

如果有人可以帮助我，谢谢，当我尝试创建新订单时会发生此错误，谢谢

我尝试使用options_for_select和whitout，所有情况下我都会在heroku中遇到这个错误！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T04:08:46.610

您的视图中有语法错误。我最好的猜测是，对于您的情况，是以下行

```
<td><%= order.select :drop,options_for_select({"Nao",false,"Sim",true}) %></td>
</tr> 
```

可以改写为：

```
<td><%= order.select :drop,options_for_select({"Nao" => false, "Sim" => true}) %></td>
</tr> 
```

该表达式`{"Nao",false,"Sim",true}`在默认的 Ruby 语法中没有任何意义。

更改为此`{"Nao" => false,"Sim" => true}`将产生一个哈希。

更改为此`["Nao",false,"Sim",true]`将生成一个数组。

根据文档，rails 方法[options_for_select](http://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/options_for_select)将接受散列或数组（或任何可枚举类型）。

# java - 在线查找 java 对象，如何扫描所有输入？

> ID：15535100
> 
> 赞同：0
> 
> 时间：2013-03-20T21:29:39.390
> 
> 标签：java, java.util.scanner

我正在对 findInLine 对象进行测试，但它不起作用，我不知道为什么。这是代码：

```
public static void main(String[] args) {

    Scanner input = new Scanner(System.in);
    System.out.print("enter string: ");
    String a = null;
    String pattern ="(,)";

    if (input.findInLine(pattern) != null){

        a = input.nextLine();

    }
    System.out.println(a); 
```

`enter string: (9,9) <---------- that is what i wrote`

这是`output: 9)`

如果我想让变量`a`得到我这样写的所有字符串，我需要做什么：`a = (9,9)`而不是`a = 9)`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:40:05.087

您需要在正则表达式中转义括号。现在正则表达式匹配逗号。

此外，您应该意识到`Scanner.findInLine()`输入也有所进步。

尝试

```
String pattern = "\\([0-9]*,[0-9]*\\)";
String found = input.findInLine(pattern);
System.out.println(found); 
```

来验证这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:58:31.357

什么我都明白。您想输入一些字符串，如果该字符串与您的模式匹配，则需要将其显示在控制台中。这将为您提供正确的输出。

```
import java.util.Scanner;

public class InputScan {

    public static void main(String[] args) {

        Scanner input = new Scanner(System.in);
        String a;
        System.out.print("enter string: ");
        String pattern = "\\(\\d+,\\d+\\)"; // Its regex
        // For white spaces as you commented use following regex
        // String pattern = "\\([\\s+]?\\d+[\\s+]?,[\\s+]?\\d+[\\s+]?\\)";
        if ((a = input.findInLine(pattern)) != null){
            System.out.println(a);
        }
    }
} 
```

[Java 正则表达式教程](http://www.vogella.com/articles/JavaRegularExpressions/article.html)

[扫描仪 findInLine()](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html#findInLine%28java.lang.String%29)

输入：

```
(9,9) 
```

输出 ：

```
(9,9) 
```

# windows - 尝试连接到团队基础服务器时出现问题

> ID：15535106
> 
> 赞同：0
> 
> 时间：2013-03-20T21:29:55.810
> 
> 标签：windows, visual-studio, visual-studio-2012

我对 Visual Studio 很陌生，正在尝试连接到团队基础服务器。首先我想指出，如果我在浏览器中访问 TFS 的 URL 并输入我的凭据，我可以访问代码等，因此凭据本身没有问题。

基本上我在 Visual Studio 2012 中所做的是转到：团队资源管理器 -> 连接到 Team Foundation Server -> 服务器 -> 添加 -> 输入我的凭据。

因此，之后会出现一个登录屏幕，提示输入用户名/密码（这是非常合乎逻辑的），但是当我输入相同的凭据时，我无法访问。在该登录屏幕中，我还可以看到一个“域”，这似乎是我在安装 Windows 时刚刚输入的随机内容，并且该域与 TFS 无关。

正如您可能注意到的那样，我真的不知道该域的作用是什么？这就是为什么我无法通过 Visual Studio 连接到 TFS 服务器但它可以通过浏览器工作的问题吗？此外，如果这很重要，我会通过 VPN 连接到 TFS 服务器所在的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-05T11:16:42.573

我只是在通过 VPN 连接到 TFS 时遇到了完全相同的问题。几个月来我的连接一直没有问题，但我昨天在办公室时更改了我的 Windows 密码，今天无法从我的笔记本电脑登录。

原来，在凭据框中，我省略了我的域名。因此，我只是输入了 Itar，而不是 MY-WORK-DOMAIN\Itar。

（下面有一个域名 - 不可编辑 - 指的是我的无线路由器。登录时这似乎无关紧要。）

一旦我输入了我的用户名 MY-WORK-DOMAIN\Itar 并输入了新密码，它就一切正常了。

我确定现在已经整理了OP，但也许我的回答对其他人有用。

# javascript - JSON对象重复字符串效率

> ID：15535111
> 
> 赞同：1
> 
> 时间：2013-03-20T21:30:27.880
> 
> 标签：javascript, json, string, replace

我有一个 JSON 对象，其中包含大约 150 个表单条目，`[key] : [sentence]`其中句子通常一遍又一遍地包含相同的文本。例如：

```
var test = {
    "abc" : "This is the first sentence that is in this JSON object. Hello! Blue."
    "abd" : "Red. This is the second sentence that is in this JSON object. Hi!"
    "abe" : "This is the third sentence that is in this JSON object. Hey! Yellow."
    "abf" : "White. This is the fourte sentence that is in this JSON object. Hola!"
} 
```

您可以看到字符串“此 JSON 对象中的句子”。经常重复。用某个锚点替换它然后在我从对象中获取条目后替换锚点会更有效吗？那是：

```
var test = {
    "abc" : "This is the first #anchor# Hello!"
    "abd" : "This is the second #anchor# Hi!"
    "abe" : "This is the third #anchor# Hey!"
    "abf" : "This is the fourte #anchor# Hola!"
}

var anchor = "sentence that is in this JSON object." 
```

从 JSON 中获取所需值后，将字符串替换为实际文本？这些句子没有特定的模式，但其中大量包含重复的文本字符串。感谢您的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:40:57.947

基本上，您正在谈论为计算交易带宽。在原始情况下，需要更多带宽并且不需要下载后计算（字符串替换）。在后一种情况下，带宽较少，但您需要进行后处理。

对我来说，您要为您的用例明确回答这个问题的唯一方法是测试这两个场景并确定最适合您的方案。您还必须确定带宽与执行时间的可能折衷是否是您想要做出的折衷。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:34:13.530

根据有多少条目，这可能会节省一些内存或服务器带宽，但我认为它不值得重建句子所需的复杂性和处理能力。

无论哪种方式，这都是一个糟糕的优化 IMO。使用像 gzip 这样自然处理重复字符串的标准优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:39:50.580

如果您的 JSON 下载是 gzip 压缩的（这极有可能），那么您可能不会节省太多带宽（如果有的话）。Gzip 压缩非常擅长删除重复的字符串。

要找出答案，请将您的 JSON 放入一个文件中，然后使用任何 Gzip 实用程序从中创建一个 .gz 文件。对另一个版本的 JSON 执行相同操作，然后比较两个 .gz 文件的大小。您可能会惊讶于差异如此之小。

如果您没有 Gzip 实用程序，请获取[7-Zip](http://www.7-zip.org/)。

除了带宽，您可以通过组合字符串来节省浏览器中的内存。这是否值得取决于我们正在谈论多少个字符串。

# php - Jquery ui 自动完成 php 检索名称

> ID：15535112
> 
> 赞同：0
> 
> 时间：2013-03-20T21:30:30.707
> 
> 标签：php, javascript, jquery, jquery-ui

我正在尝试使用 jquery UI 自动完成小部件从 php 文件 (nameSearch.php) 中的 mysql 表中检索名称

它没有正确检索结果。我这里的 Jquery 有什么问题吗？它应该将结果返回到带有 id 'tags' 的输入吗？

我在 php 文件中得到了 '$_GET['term']' 变量，我理解它是从自动完成请求发送到 php 文件的？

这是我拥有的 Jquery 代码：

```
<script>
    $("#tags").autocomplete({
            source: "nameSearch.php",
            minLength: 2
        });
</script> 
```

php

```
 <?php

    $namePart=$_GET['term'];
    $names = array();

// Create connection
        $con=mysqli_connect('localhost','root','admin','filmdatabase'); 
        // Query Database
        $result = mysqli_query($con,"SELECT name FROM actor WHERE name like    '%".$namePart."%'");
        $arr = '';

                while($row = mysqli_fetch_array($result)){
                    array_push($names,$row['name']);
                }

       echo json_encode($names);
?> 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:24:11.453

添加`$(document).ready(function(){....});?`为包装器解决了问题

# c# - 对象引用未设置为对象的实例 - Black Jack Game

> ID：15535116
> 
> 赞同：-2
> 
> 时间：2013-03-20T21:30:46.790
> 
> 标签：c#

我是一个编程新手，我正在制作一个 Black Jack 游戏，但是当我调用该`Hit`函数时，我真的很难将一张牌从我洗好的牌组中添加到玩家的手中，我收到以下消息：

> 你调用的对象是空的。

我知道解决方案可能真的很明显，但你能帮忙吗？
问题就在`Deck`类的底部，在`Hit()`函数中

/* 主类 */

```
using System;
using System.Collections.Generic;
using System.Text;

namespace BlackJackGameX
{
    public class MainClass
    {
        public static void Main (string[] args)
        {

            Deck cards = new Deck();

            Hand playerHand = new Hand(cards);

            Console.WriteLine("Welcome to Black Jack\n\nPress Enter To Start");
            Console.ReadLine ();

            cards.Hit();

            playerHand.PrintHand();

        }
    }
} 
```

/* 卡片类 */

```
using System;
using System.Collections.Generic;
using System.Text;

namespace BlackJackGameX
{
    public enum Suit {Spades, Hearts, Clubs, Diamonds}
    public enum FaceValue {Ace, Two, Three, Four, Five, Six, Seven, Eight, Nine, Ten, Jack, Queen, King}

    public class Card
    {
        public Suit CardSuit;
        public FaceValue CardValue;
        public int iValue;

        public Card (Suit cardSuit, FaceValue cardValue, int ivalue)
        {
            CardSuit = cardSuit;
            CardValue = cardValue;
            iValue = ivalue;
        }

        public Card ()
        {

        }
    }
} 
```

/*手类*/

```
using System.Collections.Generic;
using System.Text;

namespace BlackJackGameX
{
    public class Hand
    {
        public List<Card> PlayerHand;

        private Deck cardDeck = new Deck();

        public Hand (Deck Cards)
        {
            cardDeck = Cards;
        }

        public void PrintHand()
        {
            for (int i = 0; i < PlayerHand.Count; ++i)
            {
                Console.WriteLine("You have a " + PlayerHand[i].CardValue + " of " + PlayerHand[i].CardSuit);

                if (i < PlayerHand.Count)
                {
                    Console.WriteLine ("&");
                }
            }

            Console.ReadLine();

        }
    }
} 
```

/* 甲板类 */

```
using System;
using System.Collections.Generic;
using System.Text;

namespace BlackJackGameX
{
    public class Deck
    {
        Hand playerHand;

        Random rNumber = new Random();

        List<Card> Cards;

        public int iValue1 = 11;
        public int iValue2 = 2;
        public int iValue3 = 3;
        public int iValue4 = 4;
        public int iValue5 = 5;
        public int iValue6 = 6;
        public int iValue7 = 7;
        public int iValue8 = 8;
        public int iValue9 = 9;
        public int iValue10 = 10;
        public int iValue11 = 10;
        public int iValue12 = 10;
        public int iValue13 = 10;

        public Deck()
        {
            Cards = NewDeck();
        }

        private List<Card> NewDeck()
        {
            var AllSuits = new Suit[]
            {
                Suit.Spades,
                Suit.Hearts,
                Suit.Clubs,
                Suit.Diamonds
            };

            var AllFaces = new FaceValue[]
            {
                FaceValue.Ace,
                FaceValue.Two,
                FaceValue.Three,
                FaceValue.Four,
                FaceValue.Five,
                FaceValue.Six,
                FaceValue.Seven,
                FaceValue.Eight,
                FaceValue.Nine,
                FaceValue.Ten,
                FaceValue.Jack,
                FaceValue.Queen,
                FaceValue.King
            };

            var AllValues = new int[]
            {
                iValue1,
                iValue2,
                iValue3,
                iValue4,
                iValue5,
                iValue6,
                iValue7,
                iValue8,
                iValue9,
                iValue10,
                iValue11,
                iValue12,
                iValue13
            };

            List<Card> myDeck = new List<Card>();

            for (int i = 0; i <= 3; i++) 
            {
                for (int j = 0; j <= 12; j++) 
                {
                    Card newCard = new Card(AllSuits[i], AllFaces[j], AllValues[j]);
                    myDeck.Add(newCard);

                }
            }

            List<Card> shuffledDeck = new List<Card> ();

            while (myDeck.Count > 0)
            {
                int c = myDeck.Count;

                int n = rNumber.Next (0, c);

                // var will translate into an int which will be used to pick the card needed from the list
                var value = myDeck[n];
                shuffledDeck.Add(value);
                myDeck.Remove(value);

            }

            return shuffledDeck;
        }

        public void Print()
        {
            for (int i = 0; i <= 51; i++) 
            {
                Console.WriteLine("You drew a " + (Cards [i].CardValue) + " of " + (Cards [i].CardSuit));
                Console.ReadLine ();
            }
        }

        public void Hit()
        {

            playerHand.PlayerHand.Add(Cards[0]);
            Cards.Remove(Cards[0]);

            /*var tmp = Cards[0];
            Cards.Remove(tmp);
            return tmp;*/
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T21:33:57.393

`public List<Card> PlayerHand;`在您的`Hand`班级中，永远不会分配给`null`.

在`Hit`中，您调用`playerHand.PlayerHand.Add`-is ，因此调用结果`playerHand.PlayerHand`为。`null``Add``NullReferenceException`

通过抛出异常的函数进行调试应该清楚地向您显示此类问题 - 通过观察使用的变量，您可以看到哪些具有预期值，哪些没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:34:06.220

看起来 Deck.playerHand 从未初始化。Hand.PlayerHand 也一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:34:30.793

你永远不会在 Deck 中设置 playerHand，所以当你调用 hit 时， playerHand 为空。

# javascript - 退出 Pop Javascript 无法正常运行

> ID：15535118
> 
> 赞同：2
> 
> 时间：2013-03-20T21:30:49.640
> 
> 标签：javascript, jquery, onload, onunload

我一直试图让这个退出弹出工作。到目前为止，我可以让它在 FF、Chrome 和 Safari 的 Mac 上运行，但在 IE、FF、Windows 版 Chrome 中遇到了困难。这是我迄今为止尝试过的两个片段：

```
<script language=javascript>
function thankYou(){
var win=window.open("[url.com]", "_blank", "left=20,top=20,width=500,height=500,scrollbars=1"); win.focus();  }
</script>

<body onUnload="thankYou()"> 
```

和

```
<SCRIPT>
function thankYou() {

var ConfirmStatus = confirm("We would love to receive your feedback on your experience of this page. Would you like to complete our short survey?");

if (ConfirmStatus == true) {
window.open("[url]", "win", "left=20,top=20,width=500,height=500,scrollbars=1");
} else {
window.close();
}

}

window.onunload=thankYou;
</SCRIPT> 
```

不知道如何让它在 Windows 上运行。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-12T06:13:34.833

改变：

```
<body onUnload="thankYou()"> 
```

至：

```
<body onBeforeUnload="thankYou()"> 
```

和....

改变：

```
window.onunload=thankYou; 
```

至：

```
window.onbeforeunload=thankYou; 
```

# c# - 在列表或数组中搜索现有字符串

> ID：15535119
> 
> 赞同：1
> 
> 时间：2013-03-20T21:30:50.063
> 
> 标签：c#, list

我需要一个包含用户将添加到的名称的数组或列表。我还需要执行一个检查，如果该名称已经存在，则不允许添加该名称。我知道这应该相当简单，但我找不到任何解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:32:24.997

使用`HashSet<string>`; `HashSet`是独特元素的集合。如果添加了元素，则它们的`.Add`方法返回，否则返回。`true``false`

如果您不能使用这样的数据结构，那么只需调用`.Contains`列表并传入要添加的元素 - 如果它返回`true`，则不要添加它。否则，你很高兴可以将其附加到列表中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:32:31.433

我想你可能只是在追求：

```
if (list.Contains(name)) 
```

或者：

```
if (array.Contains(name)) 
```

就这么简单！两者都`List<T>`用它的方法`T[]`实现`IList<T>`接口。[`Contains`](http://msdn.microsoft.com/en-gb/library/k5cf1d56.aspx)当然，这是假设您对完全匹配感到满意。如果您需要更复杂的东西，我可能会使用`Any`LINQ。例如：

```
if (array.Any(x => x.StartsWith(name)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:37:07.867

如果列表被实例化，这将起作用：

```
//List<string> list
list.contains(specifiedstring) 
```

否则，如果它是一个带有字符串字段的复杂对象 - List 那么我会使用：

```
//For a List<ClassA> list
var exists = list.Any(x => !String.IsNullOrWhitespace(x.StringAField) && 
                          x.StringAField.Equals(string)); 
```

这为您提供了用于检查 if 语句或其他条件的 bool 值。

# sql - SQL 查询中的 SUM - 左外连接

> ID：15535129
> 
> 赞同：0
> 
> 时间：2013-03-20T21:31:20.423
> 
> 标签：sql, sql-server, function, sum, aggregate-functions

这是场景：

表：

```
**CallMain:**

Call_ID = PK (INT)
Abandoned (INT) Either 1 or NULL

**CallHold:**

Hold_ID = PK (INT)

Call_ID = FK (INT)

StartTime (INT)

EndTime (INT) 
```

CallMain 表中保持的每个呼叫可以有 1、0 或多个保持记录。每次呼叫保持时，都会创建一条由 FK 引用的记录，其中包含保持的开始时间和保持的结束时间。

现在，要在查询中返回此信息以显示呼叫及其总保持时间，我相信 SQL 如下：

```
SELECT CallMain.Call_ID, CallMain.Abandoned,  
ISNULL((CallHold.EndTime - CallHold.StartTime),0) AS HoldPeriodSeconds 
FROM CTIStatCall 
LEFT OUTER JOIN CallHold ON CallMain.Call_ID = CallHold.Call_ID 
```

此查询应返回没有与之关联的保留记录的调用记录，并应将它们作为 NULLS 返回。具有单个保留记录的呼叫正确显示。由 LEFT OUTER JOIN 返回的 NULLS 由 ISNULL() 函数管理并被替换为零，因为实际上调用没有保持时间。

我的问题是，如果一个呼叫有多个保持记录，它将在结果中出现两次，即：

```
Call_ID, HoldPeriod

212, 254

213, 154

214, 158

214, 25

214, 10 
```

如上所示，呼叫 214 有多个保持记录，总计 193。我如何在查询中添加它，以便它只显示该呼叫的总保持期，而不是在结果中多次重复呼叫记录？

解决方案

```
SELECT CallMain.Call_ID, CallMain.Abandoned,
 sum(ISNULL((CallHold.EndTime - CallHold.StartTime),0)) AS HoldPeriodSeconds FROM CTIStatCall LEFT OUTER JOIN CallHold ON CallMain.Call_ID = CallHold.Call_ID group by CallMain.Call_ID, CallMain.Abandoned 
```

@AshReva - 这是代码

```
SELECT CallMain.Call_ID, dateadd(s,CallMain.StartTime, '1970-01-01') AS StartTime,
dateadd(s,CallMain.AnsTime, '1970-01-01') AS AnsTime, 
dateadd(s,CallMain.EndTime, '1970-01-01') AS EndTime,
CallMain.Abandoned,
(CallMain.AnsTime - CallMain.StartTime) AS RingPeriod,
SUM(ISNULL((CallHold.EndTime - CallHold.StartTime),0)) AS HoldPeriod,
(CallMain.EndTime - CallMain.AnsTime) - ISNULL((CallHold.EndTime - CallHold.StartTime),0) AS TalkPeriod
FROM CallMain
LEFT OUTER JOIN
CallHold ON CallMain.Call_ID = CallHold.Call_ID
   GROUP BY CallMain.Call_ID, CallMain.Abandoned, CallMain.StartTime, CallMain.EndTime, CallMain.AnsTime, CallHold.EndTime, CallHold.StartTime
order by CallMain.Call_ID 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:37:21.777

只需使用 sum 和 group by 子句。看看下面是否有效。

```
SELECT 
    CallMain.Call_ID, 
    CallMain.Abandoned,  
    sum(ISNULL((CallHold.EndTime - CallHold.StartTime),0)) AS HoldPeriodSeconds 
FROM CTIStatCall 
LEFT OUTER JOIN CallHold 
   ON CallMain.Call_ID = CallHold.Call_ID
group by CallMain.Call_ID, CallMain.Abandoned 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:35:09.410

使用 sql sum() 函数和 group by 子句。

```
SELECT CallMain.Call_ID, CallMain.Abandoned,  
sum(ISNULL((CallHold.EndTime - CallHold.StartTime),0)) AS HoldPeriodSeconds 
FROM CTIStatCall 
LEFT OUTER JOIN CallHold ON CallMain.Call_ID = CallHold.Call_ID
group by CallMain.Call_ID, CallMain.Abandoned 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:35:17.270

```
SELECT
    CallMain.Call_ID,
    CallMain.Abandoned,  
    Sum(ISNULL((CallHold.EndTime - CallHold.StartTime), 0)) AS HoldPeriodSeconds 
FROM
    CallMain
LEFT OUTER JOIN
    CallHold
ON
    CallMain.Call_ID = CallHold.Call_ID
GROUP BY
    CallMain.Call_ID,
    CallMain.Abandoned 
```

# javascript - 共享对话框或更新状态框未显示多个 og:image 标签

> ID：15535133
> 
> 赞同：20
> 
> 时间：2013-03-20T21:31:32.977
> 
> 标签：javascript, facebook-javascript-sdk, facebook-opengraph, facebook-sharer

我目前正在开发一项新功能，允许用户在 Facebook 上共享页面时选择他们想要使用的缩略图。用户应该能够使用 Facebook 小部件，如发送对话框或共享按钮，以及简单地将 URL 剪切并粘贴到他们在 Facebook 上的更新状态对话框中。

我已经阅读了很多文档，这似乎表明我只需要在要共享的页面中添加多个 og:image 标记。我已经这样做了，并通过 linter 运行页面，以便更新缓存。

当直接将页面传递给 share.php 时，有效地删除了我的任何客户端代码并让对话框呈现它正在抓取的内容，我看到页面中的 3 张图像可用。

我不确定我在这里做错了什么。

这是linter[结果](https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Ffb-playground.herokuapp.com%2F)、[图形对象](https://graph.facebook.com/636359309712586)、[sharer.php 链接](https://www.facebook.com/sharer/sharer.php?u=http://fb-playground.herokuapp.com)和[页面](http://fb-playground.herokuapp.com/)。有人知道我可能做错了什么吗？

我已经确认至少 og:title 标签受到共享对话框的尊重。我还测试了图像的大小，并包含如下建议的文件扩展名。

我知道这很有效，因为[buzzfeed](http://www.buzzfeed.com/generalelectric/10-lifechanging-ways-to-make-your-day-more-efficient)具有我想要的确切功能。我已将我的示例简化为我认为应该起作用的核心部分。你可以在[这里找到完整的源代码](https://github.com/NotMyself/facebook-playground)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T19:32:38.500

它可能是顶部 HTML 标记中的 XML 命名空间吗？

在 BuzzFeed 文章中，它是：

```
xmlns:og="http://opengraphprotocol.org/schema/" 
```

在您的页面中：

```
xmlns:og="http://ogp.me/ns#" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-03T20:11:07.660

在 Buzzfeed 文章中，og:image 链接中的内容属性指向命名的 .jpg 文件，而您的链接末尾没有文件名/扩展名。

可能需要在链接中包含文件名，特别是如果它基于文件扩展名进行图像检测。

例如：

嗡嗡声：

```
<meta property="og:image" content="http://s3-ak.buzzfeed.com/static/campaign_images/webdr02/2013/3/18/11/10-lifechanging-ways-to-make-your-day-more-effici-1-2774-1363621197-4_big.jpg" /> 
```

你的：

```
<meta property="og:image" content="http://statics.stage3.cheezdev.com/mediumSquare/3845/4AC356E3/1"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-09T14:12:19.627

经过一些测试，我想这是一个[缓存问题](http://umairj.com/146/how-to-clear-facebook-shares-cache/)。

看起来共享器正在缓存图形，**使用`og:url`作为键**，因此共享器中的不同查询字符串不会绕过缓存，如果它们不影响`og:url`值。
显然，调试工具不使用这样的缓存。

如果我是对的（这只是一个见解），您可以等待缓存条目过期或尝试使用不同的`og:url`. 此外，为了简化测试，保持新的`og:url`等于新的页面位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-22T20:19:14.863

如此有趣的故事，我是 BuzzFeed 的开发人员，在试图弄清楚为什么我们的共享对话框突然停止显示缩略图选择器时遇到了这个问题。

看起来 Facebook 禁用了该功能。它在 2014 年 1 月 14 日短暂地再次出现，但他们引入了一个错误，该错误阻止了从定义了多个 og:image 标记的任何页面共享。（见：[https](https://developers.facebook.com/bugs/1393578360896606/) ://developers.facebook.com/bugs/1393578360896606/ ）

他们修复了这个错误，但截至 2014 年 1 月 22 日，缩略图选择器看起来仍然被禁用。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-04-03T19:06:38.983

Sharer.php 已被 Facebook 正式弃用，因此如果某些功能无法使用它，我不会感到惊讶。虽然它仍然有效，但它始终是最简单的选择，我猜他们从未构建从 og 项目中抓取的链接图像。

我能够找到[这篇文章，](http://ar.zu.my/how-to-really-customize-the-deprecated-facebook-sharer-dot-php/)它展示了一种方法，您可以准确地指定哪些图像可用于 sharer.php 共享页面。您可以指定一个（或多个）图像以使用如下 URL 结构共享：

```
http://www.facebook.com/sharer.php?s=100
&p[url]=http://bit.ly/myelection
&p[images][0]=http://election.gv.my/assets/vote.png
&p[title]=My customized title
&p[summary]=My customized summary 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-03-23T13:28:39.000

据我所知，Facebook 网站上的 Sharer.php 脚本并不支持所有的 OG 标签。这些图像是从页面内容本身中抓取的，因此如果您希望您的三个图像出现在 Sharer.php 脚本中，请将它们包含在您的内容中。

# vba - 在 Access 中更新罗斯文刷新表链接

> ID：15535139
> 
> 赞同：0
> 
> 时间：2013-03-20T21:32:10.860
> 
> 标签：vba, ms-access, northwind

我正在研究这个数据库程序。出于某种原因，老板购买了所有 64 位 2010 Office 套件，所以我正在更新程序以在 64 位 Office 上工作。

在本节中，我在尝试找出在 64 位 Access 上进行这项工作的方法时遇到了问题。我似乎无法得到有关 msaof 的直接答案，也找不到任何具有更新代码的工作。它是 Northwind Refresh Table Link 的一部分，可以在 Internet 上找到，但代码仅适用于 32 位。

```
Private Sub MSAOF_to_OF(msaof As MSA_OPENFILENAME, of As OPENFILENAME)
' This sub converts from the friendly MSAccess structure to the win32 structure.

Dim strFile As String * 512

' Initialize some parts of the structure.
of.hwndOwner = Application.hWndAccessApp
of.hInstance = 0
of.lpstrCustomFilter = 0
of.nMaxCustrFilter = 0
of.lpfnHook = 0
of.lpTemplateName = 0
of.lCustrData = 0

If msaof.strFilter = "" Then
    of.lpstrFilter = MSA_CreateFilterString(ALLFILES)
Else
    of.lpstrFilter = msaof.strFilter
End If
of.nFilterIndex = msaof.lngFilterIndex

of.lpstrFile = msaof.strInitialFile & String$(512 - Len(msaof.strInitialFile), 0)
of.nMaxFile = 511

of.lpstrFileTitle = String$(512, 0)
of.nMaxFileTitle = 511
of.lpstrTitle = msaof.strDialogTitle
of.lpstrInitialDir = msaof.strInitialDir
of.lpstrDefExt = msaof.strDefaultExtension
of.flags = msaof.lngFlags
of.lStructSize = Len(of) 
```

结束子

一件事是我收到错误“of.nMaxCustrFilter = 0”不存在，但是当我将其注释掉时，调试器仍然指向它并突出显示整个第一行。

更新：这是整个代码

```
Option Explicit           ' Require variables to be declared before being used.
Option Compare Database   ' Use database order for string comparisons.

Private Declare PtrSafe Function GetOpenFileName Lib "comdlg32.dll" Alias "GetOpenFileNameA" (pOpenfilename As OPENFILENAME) As Boolean
Declare PtrSafe Function GetSaveFileName Lib "comdlg32.dll" Alias "GetSaveFileNameA" (pOpenfilename As OPENFILENAME) As Boolean

Type MSA_OPENFILENAME
    ' Filter string used for the File Open dialog filters.
    ' Use MSA_CreateFilterString() to create this.
    ' Default = All Files, *.*
    strFilter As String
    ' Initial Filter to display.
    ' Default = 1.
    lngFilterIndex As Long
    ' Initial directory for the dialog to open in.
    ' Default = Current working directory.
    strInitialDir As String
    ' Initial file name to populate the dialog with.
    ' Default = "".
    strInitialFile As String
    strDialogTitle As String
    ' Default extension to append to file if user didn't specify one.
    ' Default = System Values (Open File, Save File).
    strDefaultExtension As String
    ' Flags (see constant list) to be used.
    ' Default = no flags.
    lngFlags As Long
    ' Full path of file picked.  On OpenFile, if the user picks a
    ' nonexistent file, only the text in the "File Name" box is returned.
    strFullPathReturned As String
    ' File name of file picked.
    strFileNameReturned As String
    ' Offset in full path (strFullPathReturned) where the file name
    ' (strFileNameReturned) begins.
    intFileOffset As Integer
    ' Offset in full path (strFullPathReturned) where the file extension begins.
    intFileExtension As Integer
End Type

Const ALLFILES = "All Files"

Type OPENFILENAME
  lStructSize As Long
  hwndOwner As LongPtr
  hInstance As LongPtr
  lpstrFilter As String
  lpstrCustomFilter As String
  nMaxCustFilter As Long
  nFilterIndex As Long
  lpstrFile As String
  nMaxFile As Long
  lpstrFileTitle As String
  nMaxFileTitle As Long
  lpstrInitialDir As String
  lpstrTitle As String
  flags As Long
  nFileOffset As Integer
  nFileExtension As Integer
  lpstrDefExt As String
  lCustData As Long
  lpfnHook As LongPtr
  lpTemplateName As String
End Type

Const OFN_ALLOWMULTISELECT = &H200
Const OFN_CREATEPROMPT = &H2000
Const OFN_EXPLORER = &H80000
Const OFN_FILEMUSTEXIST = &H1000
Const OFN_HIDEREADONLY = &H4
Const OFN_NOCHANGEDIR = &H8
Const OFN_NODEREFERENCELINKS = &H100000
Const OFN_NONETWORKBUTTON = &H20000
Const OFN_NOREADONLYRETURN = &H8000
Const OFN_NOVALIDATE = &H100
Const OFN_OVERWRITEPROMPT = &H2
Const OFN_PATHMUSTEXIST = &H800
Const OFN_READONLY = &H1
Const OFN_SHOWHELP = &H10

Function FindNorthwind(strSearchPath) As String
' Displays the open file dialog box for the user to locate
' the ElectricData database. Returns the full path to ElectricData.

    Dim msaof As MSA_OPENFILENAME

    ' Set options for the dialog box.
    msaof.strDialogTitle = "Where Is ElectricData.accdb?"
    msaof.strInitialDir = strSearchPath
    msaof.strFilter = MSA_CreateFilterString("Databases", "**.accdb")

    ' Call the Open File dialog routine.
    MSA_GetOpenFileName msaof

    ' Return the path and file name.
    FindNorthwind = Trim(msaof.strFullPathReturned)

End Function

Function MSA_CreateFilterString(ParamArray varFilt() As Variant) As String
' Creates a filter string from the passed in arguments.
' Returns "" if no args are passed in.
' Expects an even number of args (filter name, extension), but
' if an odd number is passed in, it appends *.*

    Dim strFilter As String
    Dim intRet As Integer
    Dim intNum As Integer

    intNum = UBound(varFilt)
    If (intNum <> -1) Then
        For intRet = 0 To intNum
            strFilter = strFilter & varFilt(intRet) & vbNullChar
        Next
        If intNum Mod 2 = 0 Then
            strFilter = strFilter & "*.*" & vbNullChar
        End If

        strFilter = strFilter & vbNullChar
    Else
        strFilter = ""
    End If

    MSA_CreateFilterString = strFilter
End Function

Function MSA_ConvertFilterString(strFilterIn As String) As String
' Creates a filter string from a bar ("|") separated string.
' The string should pairs of filter|extension strings, i.e. "Access Databases|**.accdb|All Files|*.*"
' If no extensions exists for the last filter pair, *.* is added.
' This code will ignore any empty strings, i.e. "||" pairs.
' Returns "" if the strings passed in is empty.

    Dim strFilter As String
    Dim intNum As Integer, intPos As Integer, intLastPos As Integer

    strFilter = ""
    intNum = 0
    intPos = 1
    intLastPos = 1

    ' Add strings as long as we find bars.
    ' Ignore any empty strings (not allowed).
    Do
        intPos = InStr(intLastPos, strFilterIn, "|")
        If (intPos > intLastPos) Then
            strFilter = strFilter & Mid$(strFilterIn, intLastPos, intPos - intLastPos) & vbNullChar
            intNum = intNum + 1
            intLastPos = intPos + 1
        ElseIf (intPos = intLastPos) Then
            intLastPos = intPos + 1
        End If
    Loop Until (intPos = 0)

    ' Get last string if it exists (assuming strFilterIn was not bar terminated).
    intPos = Len(strFilterIn)
    If (intPos >= intLastPos) Then
        strFilter = strFilter & Mid$(strFilterIn, intLastPos, intPos - intLastPos + 1) & vbNullChar
        intNum = intNum + 1
    End If

    ' Add *.* if there's no extension for the last string.
    If intNum Mod 2 = 1 Then
        strFilter = strFilter & "*.*" & vbNullChar
    End If

    ' Add terminating NULL if we have any filter.
    If strFilter <> "" Then
        strFilter = strFilter & vbNullChar
    End If

    MSA_ConvertFilterString = strFilter
End Function

Private Function MSA_GetSaveFileName(msaof As MSA_OPENFILENAME) As Integer
' Opens the file save dialog.

    Dim of As OPENFILENAME
    Dim intRet As Integer

    MSAOF_to_OF msaof, of
    of.flags = of.flags Or OFN_HIDEREADONLY
    intRet = GetSaveFileName(of)
    If intRet Then
        OF_to_MSAOF of, msaof
    End If
    MSA_GetSaveFileName = intRet
End Function

Function MSA_SimpleGetSaveFileName() As String
' Opens the file save dialog with default values.
    Dim msaof As MSA_OPENFILENAME
    Dim intRet As Integer
    Dim strRet As String

    intRet = MSA_GetSaveFileName(msaof)
    If intRet Then
        strRet = msaof.strFullPathReturned
    End If

    MSA_SimpleGetSaveFileName = strRet
End Function

Private Function MSA_GetOpenFileName(msaof As MSA_OPENFILENAME) As Integer
' Opens the file open dialog.

    Dim of As OPENFILENAME
    Dim intRet As Integer

    MSAOF_to_OF msaof, of
    intRet = GetOpenFileName(of)
    If intRet Then
        OF_to_MSAOF of, msaof
    End If
    MSA_GetOpenFileName = intRet
End Function

Function MSA_SimpleGetOpenFileName() As String
' Opens the file open dialog with default values.

    Dim msaof As MSA_OPENFILENAME
    Dim intRet As Integer
    Dim strRet As String

    intRet = MSA_GetOpenFileName(msaof)
    If intRet Then
        strRet = msaof.strFullPathReturned
    End If

    MSA_SimpleGetOpenFileName = strRet
End Function

Public Function CheckLinks() As Boolean
' Check links to the ElectricData database; returns true if links are OK.

    Dim dbs As Database, rst As DAO.Recordset

    Set dbs = CurrentDb()

    ' Open linked table to see if connection information is correct.
    On Error Resume Next
    Set rst = dbs.OpenRecordset("lstPartClasses")

    ' If there's no error, return True.
    If Err = 0 Then
        CheckLinks = True
    Else
        CheckLinks = False
    End If

End Function

Private Sub OF_to_MSAOF(of As OPENFILENAME, msaof As MSA_OPENFILENAME)
' This sub converts from the win32 structure to the friendly MSAccess structure.

    msaof.strFullPathReturned = Left$(of.lpstrFile, InStr(of.lpstrFile, vbNullChar) - 1)
    msaof.strFileNameReturned = of.lpstrFileTitle
    msaof.intFileOffset = of.nFileOffset
    msaof.intFileExtension = of.nFileExtension
End Sub

Private Sub MSAOF_to_OF(msaof As MSA_OPENFILENAME, of As OPENFILENAME)
' This sub converts from the friendly MSAccess structure to the win32 structure.

    Dim strFile As String * 512

    ' Initialize some parts of the structure.
    of.hwndOwner = Application.hWndAccessApp
    of.hInstance = 0
    of.lpstrCustomFilter = 0
    of.nMaxCustrFilter = 0
    of.lpfnHook = 0
    of.lpTemplateName = 0
    of.lCustrData = 0

    If msaof.strFilter = "" Then
        of.lpstrFilter = MSA_CreateFilterString(ALLFILES)
    Else
        of.lpstrFilter = msaof.strFilter
    End If
    of.nFilterIndex = msaof.lngFilterIndex

    of.lpstrFile = msaof.strInitialFile & String$(512 - Len(msaof.strInitialFile), 0)
    of.nMaxFile = 511

    of.lpstrFileTitle = String$(512, 0)
    of.nMaxFileTitle = 511

    of.lpstrTitle = msaof.strDialogTitle

    of.lpstrInitialDir = msaof.strInitialDir

    of.lpstrDefExt = msaof.strDefaultExtension

    of.flags = msaof.lngFlags

    of.lStructSize = Len(of)
End Sub

Private Function RefreshLinks(strFilename As String) As Boolean
' Refresh links to the supplied database. Return True if successful.

    Dim dbs As Database
    Dim intCount As Integer
    Dim tdf As TableDef

    ' Loop through all tables in the database.
    Set dbs = CurrentDb
    For intCount = 0 To dbs.TableDefs.Count - 1
        Set tdf = dbs.TableDefs(intCount)

        ' If the table has a connect string, it's a linked table.
        If Len(tdf.Connect) > 0 Then
            tdf.Connect = ";DATABASE=" & strFilename

          '  Debug.Print tdf.Connect
           ' Debug.Print tdf.SourceTableName

            Err = 0
            On Error Resume Next
            tdf.RefreshLink         ' Relink the table.
            If Err <> 0 Then
                RefreshLinks = False
                Exit Function
            End If
        End If
    Next intCount

    RefreshLinks = True        ' Relinking complete.

End Function

Public Function RelinkTables() As Boolean
' Tries to refresh the links to the American Campus IT Department database.
' Returns True if successful.

    Const conMaxTables = 8
    Const conNonExistentTable = 3011
    Const conNotNorthwind = 3078
    Const conNwindNotFound = 3024
    Const conAccessDenied = 3051
    Const conReadOnlyDatabase = 3027
    Const conAppTitle = "Calvin's Electric - Bid/Job Program"

    Dim strAccDir As String
    Dim strSearchPath As String
    Dim strFilename As String
    Dim intError As Integer
    Dim strError As String

    ' Get name of directory where Msaccess.exe is located.
    strAccDir = SysCmd(acSysCmdAccessDir)

    ' Get the default sample database path.
    If Dir(strAccDir & "\.") = "" Then
        strSearchPath = strAccDir
    Else
        strSearchPath = strAccDir & "\"
    End If

    ' Look for the ElectricData database.
    If (Dir(strSearchPath & "ElectricData.accdb") <> "") Then
        strFilename = strSearchPath & "ElectricData.accdb"
    Else
        ' Can't find ElectricData, so display the File Open dialog.
        MsgBox "Can't find linked tables in the Calvin's Electric Bid And Job Program. You must locate the ElectricData Database in order to use " _
            & conAppTitle & ".", vbExclamation
        strFilename = FindNorthwind(strSearchPath)
        If strFilename = "" Then
            strError = "Sorry, you must locate ElectricData.accdb to open " & conAppTitle & "."
            GoTo Exit_Failed
        End If
    End If

    ' Fix the links.
    If RefreshLinks(strFilename) Then   ' It worked!
        RelinkTables = True
        Exit Function
    End If

    ' If it failed, display an error.
    Select Case Err
    Case conNonExistentTable, conNotNorthwind
        strError = "File '" & strFilename & "' does not contain the required ElectricData tables."
    Case Err = conNwindNotFound
        strError = "You can't run " & conAppTitle & " until you locate the ElectricData database."
    Case Err = conAccessDenied
        strError = "Couldn't open " & strFilename & " because it is read-only or located on a read-only share."
    Case Err = conReadOnlyDatabase
        strError = "Can't reattach tables because " & conAppTitle & " is read-only or is located on a read-only share."
    Case Else
        strError = Err.Description
    End Select

Exit_Failed:
    MsgBox strError, vbCritical
    RelinkTables = False

End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:41:15.630

作为处理 32/64 位 API 声明的替代方法，您可以只使用`Application.FileDialog`Access 2010 中提供的方法。它适用于 32 位和 64 位版本的 Access。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:38:16.410

您似乎有`Declare Function`需要阅读的地方`Declare PtrSafe Function`。然后你必须确保你有一个 64 位库用于你正在调用的 DLL。[使用此处的代码http://www.dbforums.com/microsoft-access/990945-building-database-help.html在](http://www.dbforums.com/microsoft-access/990945-building-database-help.html)**我的 64 位应用程序中似乎**（没有经过很好的测试）可以正常工作。

# ruby-on-rails - 在 AWS EC2 上安装 Ruby 2.0 和 Rails 4.0.0beta

> ID：15535140
> 
> 赞同：27
> 
> 时间：2013-03-20T21:32:14.087
> 
> 标签：ruby-on-rails, amazon-web-services, amazon-ec2, ruby-on-rails-4, ruby-2.0

在默认的 Amazon EC2 Linux 安装 (Amazon Linux AMI 2012.09.1) 上安装 Ruby 2.0.0 和 Rails 4.0.0beta1 非常顺利。但是 openssl 阻碍了（例如[http://railsapps.github.com/openssl-certificate-verify-failed.html](http://railsapps.github.com/openssl-certificate-verify-failed.html)）并且奇怪的是阻止 openssl 安装或导致 RubyGem 包管理器安装 rails。

我该如何解决这些问题？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-03-20T21:32:14.087

登录到您的全新实例：

```
[19:59:22] paul:~ $ ssh -i ~/.ssh/server.pem ec2-user@your.ip

   __|  __|_  )
   _|  (     /   Amazon Linux AMI
  ___|\___|___|

  https://aws.amazon.com/amazon-linux-ami/2012.09-release-notes/ 
```

并模拟根：

```
$ sudo su - 
```

您从这里以 root 身份登录。应用服务器更新：

```
[root@ip-xx ~]# yum update
...
Complete!
[root@ip-xx ~]# yum groupinstall "Development Tools"
...
Install      72 Package(s)
...
Complete! 
```

现在，这就是它与标准解决方案不同的地方。安装 RVM 但没有 ruby​​ 的分发：

```
[root@ip-xx ~]# \curl -L https://get.rvm.io | bash -s stable

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   184  100   184    0     0    135      0  0:00:01  0:00:01 --:--:--   183
100 11861  100 11861    0     0   7180      0  0:00:01  0:00:01 --:--:-- 64113
Downloading RVM from wayneeseguin branch stable
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   124  100   124    0     0    161      0 --:--:-- --:--:-- --:--:--   185
100 1615k  100 1615k    0     0   258k      0  0:00:06  0:00:06 --:--:--  401k

Installing RVM to /usr/local/rvm/
    Creating group 'rvm'

# RVM:  Shell scripts enabling management of multiple ruby environments.
# RTFM: https://rvm.io/
# HELP: http://webchat.freenode.net/?channels=rvm (#rvm on irc.freenode.net)
# Cheatsheet: http://cheat.errtheblog.com/s/rvm/
# Screencast: http://screencasts.org/episodes/how-to-use-rvm

# In case of any issues read output of 'rvm requirements' and/or 'rvm notes'

Installation of RVM in /usr/local/rvm/ is almost complete:

  * First you need to add all users that will be using rvm to 'rvm' group,
    and logout - login again, anyone using rvm will be operating with `umask u=rwx,g=rwx,o=rx`.

  * To start using RVM you need to run `source /etc/profile.d/rvm.sh`
    in all your open shell windows, in rare cases you need to reopen all shell windows.

# root,
#
#   Thank you for using RVM!
#   I sincerely hope that RVM helps to make your life easier and
#   more enjoyable!!!
#
# ~Wayne 
```

让我们检查一下没有安装 ruby​​ 版本：

```
[root@ip-xx ~]# rvm list

rvm rubies

# No rvm rubies installed yet. Try 'rvm help install'. 
```

现在，openssl 已经安装在系统上，但与 setup 不兼容：

```
[root@ip-xx ~]# openssl version
OpenSSL 1.0.0k-fips 5 Feb 2013

[root@ip-xx ~]# openssl version -d
OPENSSLDIR: "/etc/pki/tls" 
```

尝试使用此版本安装 ruby​​2 将导致以下错误：

```
[root@ip-xx ~]# rvm install 2.0.0 -- --with-openssl-dir=/etc/pki/tls
Fetching yaml-0.1.4.tar.gz to /usr/local/rvm/archives
######################################################################## 100.0%
Extracting yaml to /usr/local/rvm/src/yaml-0.1.4
Prepare yaml in /usr/local/rvm/src/yaml-0.1.4.
Configuring yaml in /usr/local/rvm/src/yaml-0.1.4.
Compiling yaml in /usr/local/rvm/src/yaml-0.1.4.
Installing yaml to /usr/local/rvm/usr
Installing Ruby from source to: /usr/local/rvm/rubies/ruby-2.0.0-p0, this may take a while depending on your cpu(s)...
ruby-2.0.0-p0 - #downloading ruby-2.0.0-p0, this may take a while depending on your connection...
######################################################################## 100.0%
ruby-2.0.0-p0 - #extracting ruby-2.0.0-p0 to /usr/local/rvm/src/ruby-2.0.0-p0
ruby-2.0.0-p0 - #extracted to /usr/local/rvm/src/ruby-2.0.0-p0
ruby-2.0.0-p0 - #configuring
ruby-2.0.0-p0 - #compiling
ruby-2.0.0-p0 - #installing 
Retrieving rubygems-2.0.3
######################################################################## 100.0%
Extracting rubygems-2.0.3 ...
Removing old Rubygems files...
Installing rubygems-2.0.3 for ruby-2.0.0-p0 ...
Error running 'env GEM_PATH=/usr/local/rvm/gems/ruby-2.0.0-p0:/usr/local/rvm/gems/ruby-2.0.0-p0@global:/usr/local/rvm/gems/ruby-2.0.0-p0:/usr/local/rvm/gems/ruby-2.0.0-p0@global GEM_HOME=/usr/local/rvm/gems/ruby-2.0.0-p0 /usr/local/rvm/rubies/ruby-2.0.0-p0/bin/ruby /usr/local/rvm/src/rubygems-2.0.3/setup.rb', please read /usr/local/rvm/log/ruby-2.0.0-p0/rubygems.install.log
Installation of rubygems did not complete successfully.
Saving wrappers to '/usr/local/rvm/bin'.
ruby-2.0.0-p0 - #adjusting #shebangs for (gem irb erb ri rdoc testrb rake).
cp: overwrite `/usr/local/rvm/rubies/ruby-2.0.0-p0/bin/gem'? y
cp: overwrite `/usr/local/rvm/rubies/ruby-2.0.0-p0/bin/irb'? y
cp: overwrite `/usr/local/rvm/rubies/ruby-2.0.0-p0/bin/erb'? y
cp: overwrite `/usr/local/rvm/rubies/ruby-2.0.0-p0/bin/ri'? y
cp: overwrite `/usr/local/rvm/rubies/ruby-2.0.0-p0/bin/rdoc'? y
cp: overwrite `/usr/local/rvm/rubies/ruby-2.0.0-p0/bin/testrb'? y
cp: overwrite `/usr/local/rvm/rubies/ruby-2.0.0-p0/bin/rake'? y
ruby-2.0.0-p0 - #importing default gemsets, this may take time ...
Install of ruby-2.0.0-p0 - #complete 
```

尽管您将获得 ruby​​2，但“rubygems 的安装未成功完成” - 请注意警告：“Error running 'env GEM_PATH=...”

相反，我们将让 RVM 为我们安装一个 openssl 副本（请参阅[https://rvm.io/packages/openssl/](https://rvm.io/packages/openssl/)）。zlib-devel 包是必需的：

```
[root@ip-xx ~]# yum install zlib-devel
...
Installed:
  zlib-devel.x86_64 0:1.2.5-7.11.amzn1                                                                                  

Complete!
[root@ip-xx ~]# rvm pkg install openssl
Fetching openssl-1.0.1c.tar.gz to /usr/local/rvm/archives
Extracting openssl to /usr/local/rvm/src/openssl-1.0.1c
Configuring openssl in /usr/local/rvm/src/openssl-1.0.1c.
Compiling openssl in /usr/local/rvm/src/openssl-1.0.1c.
Installing openssl to /usr/local/rvm/usr

Please note that it's required to reinstall all rubies:

    rvm reinstall all --force

Updating openssl certificates 
```

我们现在可以安装 ruby​​2：

```
[root@ip-xx ~]# rvm reinstall 2.0.0 --with-openssl-dir=/usr/local/rvm/usr
Removing /usr/local/rvm/src/ruby-2.0.0-p0...
Removing /usr/local/rvm/rubies/ruby-2.0.0-p0...
Installing Ruby from source to: /usr/local/rvm/rubies/ruby-2.0.0-p0, this may take a while depending on your cpu(s)...
ruby-2.0.0-p0 - #downloading ruby-2.0.0-p0, this may take a while depending on your connection...
ruby-2.0.0-p0 - #extracting ruby-2.0.0-p0 to /usr/local/rvm/src/ruby-2.0.0-p0
ruby-2.0.0-p0 - #extracted to /usr/local/rvm/src/ruby-2.0.0-p0
ruby-2.0.0-p0 - #configuring
ruby-2.0.0-p0 - #compiling
ruby-2.0.0-p0 - #installing 
Removing old Rubygems files...
Installing rubygems-2.0.3 for ruby-2.0.0-p0 ...
Installation of rubygems completed successfully.
Saving wrappers to '/usr/local/rvm/bin'.
ruby-2.0.0-p0 - #adjusting #shebangs for (gem irb erb ri rdoc testrb rake).
cp: overwrite `/usr/local/rvm/rubies/ruby-2.0.0-p0/bin/gem'? y
cp: overwrite `/usr/local/rvm/rubies/ruby-2.0.0-p0/bin/irb'? y
cp: overwrite `/usr/local/rvm/rubies/ruby-2.0.0-p0/bin/erb'? y
cp: overwrite `/usr/local/rvm/rubies/ruby-2.0.0-p0/bin/ri'? y
cp: overwrite `/usr/local/rvm/rubies/ruby-2.0.0-p0/bin/rdoc'? y
cp: overwrite `/usr/local/rvm/rubies/ruby-2.0.0-p0/bin/testrb'? y
cp: overwrite `/usr/local/rvm/rubies/ruby-2.0.0-p0/bin/rake'? y
ruby-2.0.0-p0 - #importing default gemsets, this may take time ...
Install of ruby-2.0.0-p0 - #complete 
Making gemset ruby-2.0.0-p0 pristine.
Making gemset ruby-2.0.0-p0@global pristine.

[root@ip-xx ~]# ruby -v
ruby 2.0.0p0 (2013-02-24 revision 39474) [x86_64-linux] 
```

和rails4：

```
[root@ip-xx ~]# gem install rails -v 4.0.0beta1
...
28 gems installed
[root@ip-xx ~]# gem list

*** LOCAL GEMS ***

actionmailer (4.0.0.beta1)
actionpack (4.0.0.beta1)
activemodel (4.0.0.beta1)
activerecord (4.0.0.beta1)
activerecord-deprecated_finders (0.0.3)
activesupport (4.0.0.beta1)
arel (4.0.0.beta2)
atomic (1.0.1)
bigdecimal (1.2.0)
builder (3.1.4)
bundler (1.3.4)
erubis (2.7.0)
hike (1.2.1)
i18n (0.6.4)
io-console (0.4.2)
json (1.7.7)
mail (2.5.3)
mime-types (1.21)
minitest (4.3.2)
multi_json (1.7.1)
polyglot (0.3.3)
psych (2.0.0)
rack (1.5.2)
rack-test (0.6.2)
rails (4.0.0.beta1)
railties (4.0.0.beta1)
rake (10.0.3, 0.9.6)
rdoc (4.0.0, 3.12.2)
rubygems-bundler (1.1.1)
rvm (1.11.3.6)
sprockets (2.9.0)
sprockets-rails (2.0.0.rc3)
test-unit (2.0.0.0)
thor (0.17.0)
thread_safe (0.1.0)
tilt (1.3.6)
treetop (1.4.12)
tzinfo (0.3.37) 
```

这就是所有的人！

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-06-07T17:53:04.387

这是 rbenv 的变体。

SSH 进入您的全新实例：

```
 __|  __|_  )
   _|  (     /   Amazon Linux AMI
  ___|\___|___|

https://aws.amazon.com/amazon-linux-ami/2012.09-release-notes/
There are 16 security update(s) out of 57 total update(s) available
Run "sudo yum update" to apply all updates.
Amazon Linux version 2013.03 is available.
[jimjh ~]$ ruby --version
ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux] 
```

模拟根并应用服务器更新：

```
$> sudo su -
$> yum update 
```

安装几个包：

```
$> yum install git pcre pcre-devel 
```

克隆[rbenv](https://github.com/sstephenson/rbenv)：

```
$> git clone git://github.com/sstephenson/rbenv.git /usr/local/rbenv 
```

创建以下文件：

```
# /etc/profile.d/rbenv.sh
export RBENV_ROOT=/usr/local/rbenv
export PATH="${RBENV_ROOT}/bin:$PATH"
eval "$(rbenv init -)" 
```

安装[ruby​​-build](https://github.com/sstephenson/ruby-build)：

```
$> . /etc/profile
$> git clone https://github.com/sstephenson/ruby-build.git /usr/local/rbenv/plugins/ruby-build 
```

安装红宝石：

```
$> rbenv install 2.0.0-p195  # wait ...
$> rbenv global 2.0.0-p195
$> rbenv rehash 
```

更新 ruby​​gems 并安装乘客：

```
$> gem update --system
$> gem install bundler     
$> gem install passenger 
```

通过passenger安装nginx：

```
$> passenger start 
```

在撰写本文时，乘客的最新版本是 4.0.0，它适用于 ruby​​ 2.0.0。

**Elastic Beanstalk** 如果您使用的是 Elastic Beanstalk，请停止乘客

```
$> sudo service passenger stop 
```

通过添加以下内容来初始化 rbenv`/opt/elasticbeanstalk/support/envvars.d/appenv`

```
. /etc/profile.d/rbenv.sh 
```

启动乘客

```
$> sudo service passenger start 
```

# opengl - 使用opengl进行任意图像变换

> ID：15535142
> 
> 赞同：0
> 
> 时间：2013-03-20T21:32:22.903
> 
> 标签：opengl, image-processing

我需要通过将输入图像中的每个像素映射到输出图像上的位置来传输图像。

例如，输入图像上的点 (xi,yi) 应映射到点 (xo,yo)。为了在输出图像上找到点的位置，我有一个查找表。

在 C/C++ 中很容易做到，但速度很慢。有什么方法可以使用 OpenGL 着色器来实现它，从而控制目标系统上 GPU 的速度增加吗？

如果我不能使用 opengl，如何加快这个过程？

## 编辑 1

模拟示例 c/c++ 代码：

```
class Point
{
    int x;
    int y;
}

Point LUT[w,h];   // would hold LUT

void Transform(image in,image out)
{
     for(int x=0;x<w;x++)
     {
          for(int y=0;y<h;y++)
          {
                color pixelColor=in.GetPixelColor(x,y);
                out.PutPixelColor(LUT[x,y].x,LUT[x,y].y),pixelColor);
          }
     }
}

void main()
{
  image in,out;
  ReadLUT(LUT);    // read LUT from file and fill LUT table
  ReadImage(in);   // read input image.

  Transform(in,out);   // transform image based on LUT
  SaveImage(out);      // write output image 
```

}

# sql-server-2008 - MERGE 导致触发器中的“子查询返回超过 1 个值”错误

> ID：15535144
> 
> 赞同：0
> 
> 时间：2013-03-20T21:32:24.857
> 
> 标签：sql-server-2008, triggers, merge, sql-update

下面是表上的触发器和我用于更新的查询。

**扳机**

*此触发器将根据插入或更新到另一列的文本更新类型 ID 列...这是强制在设计不良的表上键入*

```
CREATE TRIGGER [dbo].[TypeIDInsert] 
    ON [dbo].[Table1]
    AFTER INSERT, UPDATE
AS
BEGIN

    IF (SELECT TypeID FROM inserted) IS NULL
    BEGIN

        DECLARE @ID [int] = (SELECT ID FROM inserted);

        UPDATE Table1 SET TypeID = (
            CASE TypeName
                WHEN 'Value 1' THEN 1
                WHEN 'Value 2' THEN 2
                WHEN 'Value 3' THEN 3
                ELSE 0
            END
        )
        WHERE ID = @ID

    END

END 
```

该`ID`列是一个`IDENTITY`列。

**更新声明**

```
MERGE INTO Table1
    USING Table1TypeTable
        ON Table1.TypeName= TypeTable.TypeName
WHEN MATCHED THEN
    UPDATE SET TypeID = TypeTable.TypeID; 
```

启用触发器后，我收到错误：

> 子查询返回超过 1 个值。当子查询跟随 =、!=、<、<=、>、>= 或子查询用作表达式时，这是不允许的。

我发现这篇文章[更新语句错误：子查询返回超过 1 个值](https://stackoverflow.com/questions/1660755/update-statement-error-subquery-returned-more-than-1-value)，描述问题是表上的触发器一次只为一条记录设计。我禁用了触发器并能够成功进行更新。我的问题是如何编写触发器，以免在这样的大规模更新中引起问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:37:49.853

有几件事：您的触发器假设所有操作只影响一行。这样做的方法是*加入*插入的表，而不是尝试用谁知道哪一行的 ID 值填充单个变量。此外，检查`inserted`（在您的示例中缺少`EXISTS`）并不是真正必要的。如果有 0 行，`inserted`则无论如何都不会执行更新。

```
ALTER TRIGGER [dbo].[TypeIDInsert] 
    ON [dbo].[Table1]
    AFTER INSERT, UPDATE
AS
BEGIN
  SET NOCOUNT ON;

  UPDATE t SET t.TypeID = CASE i.TypeName
      WHEN 'Value 1' THEN 1
      WHEN 'Value 2' THEN 2
      WHEN 'Value 3' THEN 3
      ELSE 0 END
    FROM dbo.Table1 AS t
    INNER JOIN inserted AS i
    ON t.ID = i.ID;
END
GO 
```

# php - 如何测试属性中是否存在方法？

> ID：15535146
> 
> 赞同：1
> 
> 时间：2013-03-20T21:32:25.650
> 
> 标签：php, methods, error-handling

**如何在不抛出错误或使用“@”的情况下进行测试？**

**可以是有效的：**

```
$foo->bar_x; 
```

**或者**

```
$foo->bar()->x(); 
```

我需要类似的东西：

```
if(($foo->bar()->x()))
   echo $foo->bar()->x();

if(($foo->bar_x))
   echo $foo->bar_x(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:40:44.717

```
$bar = $foo->bar();
if (method_exists($bar, 'x')) {
    echo $bar->x();
}

if (property_exists($foo, 'bar_x')) {
    echo $foo->bar_x;
} 
```

当然，处理那些你甚至不知道其类型以至于无法调用它们的方法的对象是不好的。应该清楚对象属于哪个类，方法将返回哪种对象，因此可以使用哪些方法和属性。定义的接口是 OOP 的一个关键点。

最多你应该根据对象的类型来决定调用什么：

```
if ($foo instanceof SomeClass) {
    $foo->bar();
} else if ($foo instanceof SomeDefinedInterface) {
    $foo->baz();
} 
```

最好只处理已知类型的对象，您根本不会有这种歧义：

```
function (SomeClass $foo) {
    $foo->bar();
} 
```

# ajax - 如何使用ajax在新窗口中打开页面

> ID：15535150
> 
> 赞同：0
> 
> 时间：2013-03-20T21:32:43.933
> 
> 标签：ajax

我有这个 lismenu 的表格

```
<select name="Exam" id="Exam">
              <option value="Hematology">Hematology</option>
              <option value="G. Urin Exam">G. Urin Exam</option>
              <option value="G. Stool Exam">G. Stool Exam</option>
            </select>
            <input name="PtID" type="hidden" id="PtID" value="<?php echo $_POST['PtID']; ?>" />
          </p></th>
          <th scope="col"><input type="button" name="button" id="button" value="Button" onclick="open_exam()" /> 
```

我有这个脚本

> ```
> <script  type="text/javascript">
>   function open_exam(){
>      var myurl;
>      switch($("#Exam").val())
>      {
>         case "Hematology":
>           myurl = "testspg/Hematology.php";
>           break;
>         case "G. Urin Exam":
>           myurl = "testspg/Gurin.php";
>           break;
>         case "G. Stool Exam":
>           myurl = "testspg/Gstool.php";
>           break;
>  // etc
>      }
>     $.ajax({
>       url: myurl,
>       type: 'POST',
>       data: { PtID: $('#PtID').val() },
>       success: function(data){
>         $(".myresult").html(data);
>       }
>     })
>   }
> </script> 
> ```

我想在新窗口中打开 myurl 而不是 .myresult 类 如何使用此脚本执行此操作

# java - 在 Jar 中解析 XML 文件

> ID：15535153
> 
> 赞同：0
> 
> 时间：2013-03-20T21:32:49.787
> 
> 标签：java, xml, resources, null, slick2d

我在我的 java 游戏中加载 XML 文件时遇到问题。这是文件所在的位置（来自 Eclipse）：

![Eclipse IDE 中的包资源管理器](../Images/120e4f78dd582408b308502416df3ac6.png)

我一直在做研究，显然要在 JAR 文件中使用 xml 文件，我需要调用

```
DocumentBuilder.parse(InputStream) 
```

问题是当我尝试使用它获取 InputStream 时，`getResourceAsStream("res/xml/items.xml")` 它总是返回 null。

我怎样才能让它不返回null？我不想将我的 res 文件夹放在我的“src”文件夹中，但是在 Eclipse 中是否有一些我需要设置的设置？路径的正确字符串是什么？谢谢！

编辑：

我的代码：

```
try {
    DocumentBuilder db = dbf.newDocumentBuilder();
    InputStream is = Thread.currentThread().getContextClassLoader().getResourceAsStream("res/xml/items.xml");
    dom = db.parse(is);
} catch(Exception e) {
    e.printStackTrace();
} 
```

这仍然给我null。

![在此处输入图像描述](../Images/5f7abc79314f277412e82caf36da98d9.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:54:24.010

因此，假设您告诉 Eclipse 使用“res”作为源文件夹，您的查找仍然有两个问题：

```
Item.class.getResourceAsStream("res/xml/items.xml"); 
```

这是一个相对路径，因此`getResourceAsStream()`将在其所在目录前面添加`Item.class`（请参阅[docs](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getResourceAsStream%28java.lang.String%29)）。

第二个问题是 Eclipse 将“源”文件夹视为类路径的根。因此，您需要更改路径以排除“res”。

一种选择是使用绝对路径：`"/xml/items.xml"`

更好的选择是调用`Thread.currentThread().getContextClassLoader().getResourceAsStream()`，它可以在应用服务器和自包含应用程序中正常工作（并且是一个好习惯）。但是您仍然需要从路径中省略“res”。

# email - 如何从 Magento 发送邮件？

> ID：15535155
> 
> 赞同：1
> 
> 时间：2013-03-20T21:32:58.880
> 
> 标签：email, magento, localhost, mamp

我已经在我的 Mac 上安装了 Magento 1.7。我应该怎么做才能从本地主机发送有关订单的电子邮件。我正在本地开发商店，只想检查它是如何工作的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T05:02:21.157

使用此链接上给出的工具[测试邮件工具](http://www.toolheap.com/test-mail-server-tool/)

要发送电子邮件，您需要侦听端口号 25 的 SMTP 服务器。默认情况下，没有带 wamp 的 SMTP 服务器。因此，您需要使用一些 SMTP 工具来检查本地环境中的电子邮件发送功能。

# php - 在 php 的 if/for/do-while 块中使用变量

> ID：15535160
> 
> 赞同：0
> 
> 时间：2013-03-20T21:33:20.223
> 
> 标签：php, variables

如果我没记错的话，我曾经第一次在 if 语句或条件循环块中使用新的 PHP 变量。我想说的是如下。

```
<?php

    for($i=0;$i<10; $i++)
    {
        $total += $i;
        $concat .= $i;
    }
 ?> 
```

但是今天，当我查看错误日志时，它说 $total 和 $concat 是未定义的变量。然后我写这个

```
 $total = 0;
    $concat="";   
    for($i=0;$i<10; $i++)
    {
        $total += $i;
        $concat .= $i;
    }
 ?> 
```

它可以正常工作。为什么？只求好奇。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:35:00.343

这是因为：

```
$total += $i;
$concat .= $i; 
```

实际上意味着：

```
$total  = $total+$i;
$concat = $concat.$i; 
```

第一次执行循环，`$total`并且`$concat`未定义。所以你得到了错误。

**更多细节：**

在循环的第一次运行期间，您正在编写

```
$total = the value of undefined $total + $i; 
```

现在，总计已定义。$concat 也一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:36:51.223

变量需要在使用前声明。根据您的错误报告，您不会看到错误。

# android - 与元素类型“EditText”关联的属性“android:id”需要打开引号

> ID：15535164
> 
> 赞同：0
> 
> 时间：2013-03-20T21:33:34.000
> 
> 标签：android, xml

这是我尝试为 android 编写的第一个应用程序，我见过更多有这个问题的人，但我似乎找不到答案。它应该有错误的“”类型，但没有。另外，所有的文本框都写得一样，但只有第一个有错误。我什至尝试切换它们，但只有第一个得到它。

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical" >

      <EditText
            **android:id=@+id/editText1** //(the error comes here)
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:ems="10"
            android:inputType="numberSigned"
            android:width="1dp">

            <requestFocus />
        </EditText>
         <EditText
            android:id=@+id/editText2
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:ems="10"
            android:inputType="numberSigned"
            android:width="1dp">

            <requestFocus />
        </EditText> 
          <EditText
            android:id=@+id/editText3
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:ems="10"
            android:inputType="numberSigned"
            android:width="1dp">

            <requestFocus />
        </EditText>
          <EditText
            android:id=@+id/editText4
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:ems="10"
            android:inputType="numberSigned"
            android:width="1dp">

            <requestFocus />
        </EditText>

          <Button
              android:id="@+id/button1"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:text="Determinar"
              android:onClick="determinar" />

    </LinearLayout>

Thanks for your time!! 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:35:02.867

错误不仅存在，而且贯穿整个布局

你应该用`@+id/yourid`引号括起来

IE

```
android:id="@+id/editText3" 
```

# php - 数组 python 到 php

> ID：15535166
> 
> 赞同：-3
> 
> 时间：2013-03-20T21:33:42.033
> 
> 标签：php, python

我必须将 python 代码翻译成 php，但我不知道这个 python 代码在 php 中是如何工作的：

```
dec = data_ar[4:len(data_ar)] 
```

我不知道[]之间的冒号“：”是什么！谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:35:52.163

这只是[Python 的数组切片符号](https://stackoverflow.com/a/509295/1427124)，所以我认为你想要的是[`array_slice`](http://php.net/manual/en/function.array-slice.php)：

```
array_slice($data_ar, 4); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T21:37:16.937

如果您想在 PHP 中实现确切的功能：

```
<?php
$data_ar = array(1,2,3,4,5,6,7);
$dec = array_slice($data_ar, 4, count($data_ar)-4); 
```

现在，这里有趣的是`len(data_ar)`. 如果您提供没有第二个参数的冒号，则假定“直到结束”。所以这个功能实际上应该这样写：

```
dec = data_ar[4:] 
```

同样，我们可以修改 PHP 方面的内容以反映同样的简单性：

```
<?php
$data_ar = array(1,2,3,4,5,6,7);
$dec = array_slice($data_ar, 4);
print_r($dec); // Returns array(5,6,7) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:35:49.453

在大多数语言中，冒号的意思是“到”。这意味着数组长度的索引 4（结束）。

在 PHP 中，您可以[`array_slice`](http://php.net/manual/en/function.array-slice.php)这样使用：

```
$dec = array_slice($data_ar, 4) 
```

# java - 项目输入错误

> ID：15535176
> 
> 赞同：2
> 
> 时间：2013-03-20T21:34:13.007
> 
> 标签：java, android, eclipse

我想使用开发的listView，

我从这里下载了 swipeList 项目的 jar 文件：

[https://github.com/47deg/android-swipelistview/downloads](https://github.com/47deg/android-swipelistview/downloads)

命名：swipelistview-1.0-SNAPSHOT.jar

我在eclipse中将此jar文件导入我的项目

但是，当我创建 xml 时，例如您网站中的示例：

```
<com.fortysevendeg.android.swipelistview.SwipeListView
            xmlns:swipe="http://schemas.android.com/apk/res-auto"
            android:id="@+id/android:list"
            android:listSelector="#00000000"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            swipe:swipeFrontView="@+id/relative"
            swipe:swipeBackView="@+id/layoutUpdate"
            swipe:swipeActionLeft="reveal"
            swipe:swipeActionRight="reveal"
            swipe:swipeMode="both"
            swipe:swipeCloseAllItemsWhenMoveList="false"
            swipe:swipeOpenOnLongPress="false"
            swipe:swipeAnimationTime="2"
            swipe:swipeOffsetLeft="5"
            swipe:swipeOffsetRight="5"
            /> 
```

我在这一行收到一条错误消息：

![错误信息](../Images/d534ac88f8d8c9e550ea3ddb6e516e37.png)

有人可以告诉我我哪里错了吗？

多谢

# python - 无法在谷歌应用引擎中获得重定向工作

> ID：15535178
> 
> 赞同：0
> 
> 时间：2013-03-20T21:34:22.120
> 
> 标签：python, google-app-engine, redirect, python-2.7

我是 Google App 引擎的初学者，并试图通过 Google App HelloWorld 应用程序。[使用模板](https://developers.google.com/appengine/docs/python/gettingstartedpython27/templates)时重定向 url 不起作用。

```
self.redirect('/?'+urllib.urlencode({'guestbook_name':guestbook_name})) 
```

它会重定向，但应该在 urlbar 中显示确切的 url，例如

```
http://localhost:8080/?guestbook_name=some_name 
```

而它显示像

```
http://localhost:8080/?guestbook_name=

class MainPage(webapp2.RequestHandler):
    def get(self):
        guestbook_name=self.request.get('guestbook_name')
        greetings_query = Greeting.all().ancestor(
            guestbook_key(guestbook_name)).order('-date')
        greetings = greetings_query.fetch(10)

        if users.get_current_user():
            url = users.create_logout_url(self.request.uri)
            url_linktext = 'Logout'
        else:
            url = users.create_login_url(self.request.uri)
            url_linktext = 'Login'

        template_values = {
            'greetings': greetings,
            'url': url,
            'url_linktext': url_linktext,
        }

        template = jinja_environment.get_template('index.html')
        self.response.out.write(template.render(template_values))

class Guestbook(webapp2.RequestHandler):
   def post(self):

      guestbook_name = self.request.get('guestbook_name')
      greeting = Greeting(parent=guestbook_key(guestbook_name))

      if users.get_current_user():
         greeting.author = users.get_current_user().nickname()

      greeting.content = self.request.get('content')
      greeting.put()
      self.redirect('/?' + urllib.urlencode({'guestbook_name': guestbook_name})) 
```

Index.html 文件看起来像

```
 <html>
   <body>
     {% for greeting in greetings %}
        {% if greeting.author %}
         <b>{{ greeting.author }}</b> wrote:
        {% else %}
       An anonymous person wrote:
        {% endif %}
  <blockquote>{{ greeting.content|escape }}</blockquote>
   {% endfor %}

<form action="/sign" method="post">
  <div><textarea name="content" rows="3" cols="60"></textarea></div>
  <div><input type="submit" value="Sign Guestbook"></div>
</form>

<a href="{{ url }}">{{ url_linktext }}</a>

   </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:51:51.957

似乎您的 guestbook_name 是 '' （空字符串）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T00:02:54.227

在您的 index.html 中，没有设置留言簿名称的输入。对于空键，webapp2 返回一个空字符串，`self.request.get('key_name')`而不是您可能期望的 None。您可以通过查看数据存储区看到这一点，您存储的所有问候语都将有一个空的 guestbook_name。

要获取 guestbook_name，请将 get 方法中的模板值设置为

```
template_values = {
    'greetings': greetings,
    'guestbook_name': guestbook_name,
    'url': url,
    'url_linktext': url_linktext,
} 
```

并在您的 index.html 中

```
<form action="/sign" method="post">
  <div><textarea name="content" rows="3" cols="60"></textarea></div>
  <div><input type="hidden" name="guestbook_name" value="{{guestbook_name}}"></div>
  <div><input type="submit" value="Sign Guestbook"></div>
</form> 
```

这会将 guestbook_name 添加到您在 POST 中发送的数据中，因此您将能够在处理程序中使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-28T03:16:17.673

我在尝试 gae 时遇到了类似的问题，官方网站[https://developers.google.com/appengine/docs/python/gettingstartedpython27/templates](https://developers.google.com/appengine/docs/python/gettingstartedpython27/templates)已经更改了相关代码，就像 Anthony 在他的帖子中提到的那样。但这里也有一些问题：

1.  在 MainPage 类的 template_values 变量中，由于此函数将 dict 或元组作为变量而不是字符串，`guestbook_name`因此编码`urllib.urlencode`将失败，应使用 urllib.quote_plus 代替。
2.  index.html 中的两个表单共享相同的编码变量`guestbook_name`，如果您的语言不是英语，这并不漂亮，在这种情况下，内容中会出现一些类似的字符串，所以，我的解决方案是为第二种形式`%2F`发送额外的非编码`guestbook_name`.

# c++ - 使用 boost 程序选项时如何解决“boost::bad_any_cast: failed conversion using boost::any_cast”？

> ID：15535180
> 
> 赞同：17
> 
> 时间：2013-03-20T21:34:23.183
> 
> 标签：c++, boost, types, casting, boost-program-options

```
//Using boost program options to read command line and config file data
    #include <boost/program_options.hpp>
    using namespace std;
    using namespace boost;
    namespace po = boost::program_options;

int main (int argc, char *argv[])
{
    po::options_description config("Configuration");
    config.add_options()
                ("IPAddress,i","IP Address")
                ("Port,p","Port")
                 ;

    po::variables_map vm;
    po::store(po::parse_command_line(argc, argv, config),vm);
    po::notify(vm);

    cout << "Values\n";

    string address = (vm["IPAddress"].as<std::string >()).c_str();
    string port = (vm["Port"].as<std::string>()).c_str();

    cout << (vm["IPAddress"].as< string >()).c_str();
    cout << " " << (vm["Port"].as<string>()).c_str();

    return 0;

} 
```

输入的值是否无法打印？

这是gdb输出，似乎是演员问题：

> 在抛出 'boost::exception_detail::clone_impl 的实例后调用终止
> 
> > ' what(): boost::bad_any_cast: 使用 boost::any_cast 转换失败
> 
> ```
>  Program received signal SIGABRT, Aborted.
>         0x0000003afd835935 in raise () from /lib64/libc.so.6 
> ```

```
string address = (vm["IPAddress"].as<std::string >()).c_str(); 
```

是错误发生的地方；我尝试过 std::string 和 string 的结果相同。

```
testboostpo -i 192.168.1.10 -p 5000 
```

是命令行。

我尝试声明类型，如下所示：

```
config.add_options()
        ("IPAddress,i", po::value<std::string>(), "IP Address")
            ("Port,p", po::value<std::string>(), "Port"); 
```

但错误仍然发生。

这可能是一个真正的错误吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-20T21:59:28.993

您会看到从`boost::bad_any_cast`抛出的异常，`po::variables_map`因为 的两个`const char*`参数重载[`po::options_description_easy_init::operator()`](http://www.boost.org/doc/libs/1_53_0/doc/html/boost/program_options/options_descri_idp44766528.html)未指定`po::value_semantic`类型，因此将其转换为 a`std::string`将不起作用。如果要将值转换为 a `std::string`，并且您的应用程序需要它，请使用`required()`值语义。

```
#include <boost/program_options.hpp>
namespace po = boost::program_options;

int main (int argc, char *argv[])
{
    po::options_description config("Configuration");
    config.add_options()
                ("IPAddress,i", po::value<std::string>()->required(), "IP Address")
                ("Port,p", po::value<std::string>()->required(), "Port")
                ;

    try {
        po::variables_map vm;
        po::store(po::parse_command_line(argc, argv, config),vm);
        po::notify(vm);
        std::cout << "Values" << std::endl;

        const std::string address = vm["IPAddress"].as<std::string>();
        const std::string port = vm["Port"].as<std::string>();

        std::cout << "address: " << address << std::endl;
        std::cout << "port: " << port << std::endl;
    } catch ( const std::exception& e ) {
        std::cerr << e.what() << std::endl;
        return 1;
    }

    return 0;
} 
```

请注意添加的 catch 块，因为解析可以（并且正如您所注意到的）会抛出异常。这是一个示例会话：

```
samm$ ./a.out
the option '--IPAddress' is required but missing
samm$ ./a.out --IPAddress 127.0.0.1
the option '--Port' is required but missing
samm$ ./a.out --IPAddress 127.0.0.1 --Port 5000
Values
address: 127.0.0.1
port: 5000
samm$ 
```

这是一个[在线演示](http://coliru.stacked-crooked.com/view?id=da8370546903b0df9f5427dc83c0257b-17035df9b4df11bb8fd30b8fc89ee5d1)，显示了相同的行为，由 COMpile 链接运行 (coliru) 提供。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T21:48:54.537

添加选项时，您需要将 ip-address 和 port 声明为字符串：

```
config.add_options()
    ("IPAddress,i", po::value<std::string>(), "IP Address")
    ("Port,p", po::value<std::string>(), "Port")
    ; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-11T00:27:46.397

如果您没有正确处理可选参数，也会出现同样的消息。

Sam 的解决方案指出了必需的参数，并且 OP 的代码建议必需 - 只需将它们标记为必需。对于可选输入，[Boost PO 教程](http://www.boost.org/doc/libs/1_58_0/doc/html/program_options/tutorial.html#idp337609360)为我们提供了一个模板，用于在转换之前检查选项是否存在：

```
if(vm.count("address")) 
{
    const std::string address = vm["IPAddress"].as<std::string>();
    std::cout << "address: " << address << std::endl;
}
if(vm.count("port")) 
    const std::string port = vm["Port"].as<std::string>();
    std::cout << "port: " << port << std::endl;
} 
```

我的问题 - 我复制/粘贴并忘记将 if 测试与使用情况对齐！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-01-21T22:39:00.403

我收到了类似的错误消息，但这是因为我使用的是简写`i`，而不是`IPAddress`.

```
// this throws the cast exception
const std::string address = vm["i"].as<std::string>();
// this does not
const std::string address = vm["IPAddress"].as<std::string>(); 
```

Boost 采用第一个声明的。所以如果你的选项被声明为`IPAddress,i`你需要使用`vm["IPAddres"]`，而`i,IPAddress`你需要使用`vm["i"]`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-11T15:15:26.193

不一定和这个人有同样的问题，但这里有一些让我印象深刻的事情：

如果你把你的类型放在匿名命名空间中，将会有两个类同名但实例不同，并且转换将失败。例如：

a.hpp：

```
namespace {
class MyClass {...};
} 
```

b.cpp：

```
#include "a.hpp"
cli_options.add_options()("test", po::value<MyClass>(), "test desc"); 
```

c.cpp：

```
#include "a.hpp" // THIS WILL MAKE A DIFFERENT "MyClass"
vm["test"].as<MyClass>();  // Fails at runtime. 
```

它失败了，因为`MyClass`in`b.cpp`和 one in`c.cpp`不是同一个类。因为匿名命名空间。

删除匿名命名空间解决了这个问题。

# git - 在 git 中创建一个新分支，省略一次提交

> ID：15535186
> 
> 赞同：1
> 
> 时间：2013-03-20T21:34:39.597
> 
> 标签：git

我的项目分支 1 和分支 2 中有 2 个分支。

这是分支上的提交顺序。

git log 在 branch1 上的输出：

```
commit 'a'
commit 'b'
commit 'c'
commit 'd' 
```

git log 在 branch2 上的输出：

```
commit 'f'
commit 'e'
commit 'c' 
commit 'd' 
```

我想创建一个与 branch1 同步的新分支，并且还具有刚刚提交“f”中的更改。

所以新的分支提交应该是这样的

```
commit 'f'
commit 'a'
commit 'b'
commit 'c'
commit 'd' 
```

如何继续这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:37:45.507

```
git checkout -b [new branch name]
git cherry-pick [hash of commit 'f'] 
```

# python - 尝试读取目录python中的文件时没有这样的文件或目录

> ID：15535188
> 
> 赞同：0
> 
> 时间：2013-03-20T21:34:52.800
> 
> 标签：python, readfile

我有这段代码，它列出了目录中的文件并用我的函数解析每个文件。

```
paths = []
for filename in os.listdir(r"C:\Program Files (x86)\Folder\Folder"):
    with open(filename) as f:            
        paths.append(parse_file(f)) 
```

我收到错误消息：

```
 File "find.py", line 21, in <module>
    with open(filename) as f:
IOError: [Errno 2] No such file or directory: 'file.txt' 
```

这个错误表明它看到了，`file.txt`因为它存在于我指定的文件夹中`os.listdir`，我在那里有更多文件。如果我删除`file.txt`它将在另一个文件上显示错误。

我还尝试将文件移动到桌面上的目录中，并且脚本运行良好。

什么问题我不明白。我对python很陌生，所以如果它是愚蠢的问题，请原谅我。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:36:46.027

`os.listdir()`返回*文件名*，而不是路径。将它们与目录名称连接起来以创建绝对路径：

```
path = r"C:\Program Files (x86)\Folder\Folder"
for filename in os.listdir(path):
    with open(os.path.join(path, filename)) as f: 
```

# sql-server - 按错误聚合函数组

> ID：15535198
> 
> 赞同：0
> 
> 时间：2013-03-20T21:35:43.733
> 
> 标签：sql-server, sql-server-2008

以下是我创建表的方式：

```
CREATE TABLE #tmp
(
  [Counter] int
  ,Per date not null
  ,Cam float
  ,CamMeg float
  ,Hfx float
  ,HfxMet float
  ,TorMetric float

) 
```

以下是我稍后在脚本中调用该表的方式：

```
SELECT 
  ((ROW_NUMBER() over(order by Per desc)-1)/@Avg)+1 as [Counter], Per, 
  Cam, 
  AVG(CamMetric) as CamMet, 
  HfxMe, 

FROM #tmp
GROUP BY [counter] ;

DROP TABLE #tmp 
```

以下是我得到的错误：

> 消息 8120，级别 16，状态 1，第 175 行列“#tmp.Per”在选择列表中无效，因为它不包含在聚合函数或 GROUP BY 子句中。
> 
> 消息 8120，级别 16，状态 1，第 175 行列“#tmp.Per”在选择列表中无效，因为它不包含在聚合函数或 GROUP BY 子句中。

我做错了什么？

数据如下所示

```
counter --- per ---Cam --- HfxMet ---......

 1        2012-02-09      3       16
 1        2012-02-24      4       12
 1        2012-03-04      2       15
 2        2012-03-15      1       18
 2        2012-03-30      6       20
 2        2012-04-07      10      6
 3        2012-04-28      8       3 
```

现在我想再添加两个名为 CamMetricAvg 和 HfxMetric 的列，它们将查看所有为 1 的计数器，然后分别获取 CamMetric 和 HfxMetric 值并给出平均值并将其放在每个列上，如下所示：

```
counter --- per ---Cam --- CamMt ---

 1        2012-02-09      3         3                
 1        2012-02-24      4         3                
 1        2012-03-04      2         3              
 2        2012-03-15      1         5.6             
 2        2012-03-30      6         5.6             
 2        2012-04-07      10        5.6              
 3        2012-04-28      8         8 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:19:53.077

```
SELECT [Counter], Period,
  CamMetric, 
  AvgCamMetric = AVG(CamMetric) OVER(PARTITION BY Counter),
  HfxMetric, 
  AvgHfxMetric = AVG(HfxMetric) OVER(PARTITION BY Counter)
  ... repeat for other metrics ...
FROM #tmpTransHrsData
GROUP BY [Counter], Period, CamMetric, HfxMetric; 
```

[SQLFiddle 示例](http://sqlfiddle.com/#!3/4ac2b/1)

# css - 试图在左右两侧获得 CSS 阴影

> ID：15535199
> 
> 赞同：0
> 
> 时间：2013-03-20T21:35:45.383
> 
> 标签：css, html

我有一个 DIV 元素，我也想应用 CSS 框阴影。问题是，我只希望它在元素的左侧和右侧。我试着玩

```
box-shadow: 0 0 10px #000; 
```

但无论我做什么，它都拒绝工作。我希望阴影为 10 像素，颜色为 #000。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:46:07.990

你应该把它应用到你的 CSS 中。

```
div {
    box-shadow: 4px 0 2px #222,  -4px 0 2px #222; 
} 
```

这是一个例子。[http://jsfiddle.net/vDvkP/](http://jsfiddle.net/vDvkP/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:53:46.037

```
.box-shadow {
    -webkit-box-shadow:4px 0 2px #000, -4px 0 2px #000;
    -moz-box-shadow:4px 0 2px #000, -4px 0 2px #000;
    box-shadow:4px 0 2px #000, -4px 0 2px #000;
} 
```

# html - CSS'位置：相对；' 和'顶部：xx%;' 标签组合在 chrome 中有效，但在任何非 webkit 浏览器（FF、IE、Opera 等）中无效

> ID：15535200
> 
> 赞同：0
> 
> 时间：2013-03-20T21:35:45.743
> 
> 标签：html, css, resize, position, footer

我遇到了一种非常特殊的行为，尤其是对于我认为是一段简单的代码！基本上，我正在尝试“定位：相对；” 我页面底部的页脚导航。在 chrome 中，它正确地位于底部。在 FF（或任何其他非 webkit 浏览器）中，它不在页面底部，而几乎在页面顶部。如果我更改一个 CSS 行（位置：相对于位置：绝对；）它适用于所有浏览器，但在我调整屏幕大小或放大/缩小时它不会正确浮动。我已经在“样板”HTML/CSS 中确认了这一点，并且所有正确的浏览器也重置了，并且得到了相同的行为。这一切都在 Windows 7 中。下面是两个非常短的 HTML 和 CSS 片段。为什么不是 这工作吗？任何关于如何获得简单的页脚导航以跨浏览器工作并使其在放大/缩小时正确浮动的任何解决方案都将不胜感激！

```
 <ul id="avmenu">
  <li class="current"><a href="first.html">First page</a></li>
  <li><a href="second.html">Second page</a></li>
  <li><a href="third.html">Third page</a></li>
  <li><a href="fourth.html">Fourth page</a></li>
  <li><a href="fifth.html">Fifth page</a></li>
</ul>

ul#avmenu {
margin: 35px 0;
padding: 0;
font: 12px Verdana;
list-style-type: none;

position:relative; <---As is this works in chrome only.  JUST CHANGE THIS to position:absolute and it works in all browsers but it doesn't float well resizing or zooming.

top:70%;  <--This only works ONLY in CHROME when above position:relative.  Work improperly whhn position: absolute.
*left:20%;
}

ul#avmenu li {
display: inline;
}

ul#avmenu li a {
padding: 5px 10px;
border: 1px solid #aaa;
background-color: #eee;
color: #47a;
text-decoration: none;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:56:40.703

看看这是否对您有帮助：http: [//jsfiddle.net/panchroma/u9qtd/](http://jsfiddle.net/panchroma/u9qtd/)

为了做到这一点，你会看到我已经强迫身体全高。根据实际页面上 UL 的具体情况，您可能需要对此进行调整。

至于相对与绝对的细节，我无法改进这个讨论：[Position Relative vs Position Absolute？](https://stackoverflow.com/questions/10426497/position-relative-vs-position-absolute)

**CSS**

```
html, body {
height: 100%;
} 

ul#avmenu {
margin: 35px 0;
padding: 0;
font: 12px Verdana;
list-style-type: none;

position:relative; 

top:70%; 
left:20%;   
}

ul#avmenu li {
display: inline;
}

ul#avmenu li a {
padding: 5px 10px;
border: 1px solid #aaa;
background-color: #eee;
color: #47a;
text-decoration: none;
} 
```

# internet-explorer - 在 IFrame 中使用 Twitter Bootstrap 时 IE 认为它有溢出

> ID：15535203
> 
> 赞同：0
> 
> 时间：2013-03-20T21:35:51.200
> 
> 标签：internet-explorer, twitter-bootstrap, iframe

我们使用的是 1.3 版的 Bootstrap。我们从这个 div 中弹出一个 IFrame：

```
<div id="searchDialog" class="modal hide" title="Search">

    <div class="modal-header" style="left:40%">
       <a href="#" class="close">&times;</a>
       <h3>Search</h3>
     </div>
     <div class="modal-body">
        <iframe style="width: 700px; height: 400px; overflow: auto; border-style: none" src="<c:url value="/kb/workgroup/usersearch"/>"></iframe>
     </div>

</div> 
```

在调用的 JSP（通过 Spring MVC）中，它具有引导 css 引用：

```
<link type="text/css" rel="stylesheet" href="<c:url value="/resources/skins/kb/css/bootstrap.css" />" /> 
```

IFrame 在 Firefox 上运行良好，但 IE 8 有一个垂直滚动条，但没有额外的滚动内容。当我删除引导 css 引用时，垂直滚动条消失。

所以我认为引导程序对 960px 的需求可能会混淆......或类似的东西。

当我尝试使用引导行和跨度类时，还有引导 css 参考，效果很奇怪，即无法正常工作。

有什么想法吗？（此时我们很难升级引导程序）。我可以期望在 IFrame 中使用 Bootstrap 吗？我没有成功地寻找例子。谢谢

# python - [:-1] 在 python 中是什么意思/做什么？

> ID：15535205
> 
> 赞同：47
> 
> 时间：2013-03-20T21:35:55.537
> 
> 标签：python

处理 python 任务，并对以下代码上下文中的 [:-1] 含义感到好奇：`instructions = f.readline()[:-1]`

在 SO 和 Google 上搜索过这里，但无济于事。想要一个解释！

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-03-20T21:37:58.247

它对字符串进行切片以省略最后一个字符，在本例中为换行符：

```
>>> 'test\n'[:-1]
'test' 
```

由于这甚至适用于空字符串，因此删除最后一个字符（如果存在）是一种非常安全的方法：

```
>>> ''[:-1]
'' 
```

这适用于任何序列，而不仅仅是字符串。

`line.rstrip('\n')`对于文本文件中的行，我实际上*只会删除一个换行符*；有时文件中的最后一行不以换行符结尾，使用切片然后删除该行最后的任何其他字符。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-20T21:38:13.970

它的意思是“序列的所有元素，但最后一个元素”。在它的上下文中`f.readline()[:-1]`意味着“我很确定该行以换行符结尾，我想删除它”。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-03-20T21:38:11.280

它选择除了序列的最后一个元素之外的所有元素。

下面使用列表的示例：

```
In [15]: a=range(10)

In [16]: a
Out[16]: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

In [17]: a[:-1]
Out[17]: [0, 1, 2, 3, 4, 5, 6, 7, 8] 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-20T21:37:56.640

它从列表中获取所有元素（或字符串中的字符），但最后一个元素。

`:`表示遍历列表 `-1`意味着列表的最后一个元素

# ios - 使用情节提要展开，我如何从要返回的视图控制器中获取数据并在返回的视图控制器中使用它？

> ID：15535208
> 
> 赞同：2
> 
> 时间：2013-03-20T21:36:09.377
> 
> 标签：ios, objective-c, xcode, uistoryboard, uistoryboardsegue

我已经实现了一切，当我返回到源视图控制器时会触发以下方法：

```
- (IBAction)returned:(UIStoryboardSegue *)segue {
    ...
} 
```

我想从要返回的视图中的 UITextField 中获取值，并将源视图（或调用此方法的视图）中的值设置为该 UITextField 的值。

我试过这个：

```
- (IBAction)returned:(UIStoryboardSegue *)segue {
    AddTextViewController *returnedFromViewController = segue.destinationViewController;
    NSString *inputtedText = returnedFromViewController.textField.text;
    self.foo = inputtedText;
} 
```

但我得到这个错误：

```
[RootViewController textField]: unrecognized selector sent to instance 0x8dc0250
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[RootViewController textField]: unrecognized selector sent to instance 0x8dc0250' 
```

我在上面的代码中做错了什么？几乎没有这方面的任何文档，所以我很难在自己周围搜索。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:41:52.487

您使用了错误的控制器。你想要的是 segue 的`sourceViewController`，而不是`destinationViewController`. 否则，你做的都是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:56:13.390

最好的方法是实现协议/委托。委托将处理来自您的目标视图控制器的任何请求，并将数据发送回您的源视图控制器。

[http://iosdevelopertips.com/objective-c/the-basics-of-protocols-and-delegates.html](http://iosdevelopertips.com/objective-c/the-basics-of-protocols-and-delegates.html)

# jquery - 如何将 jquery 选项卡划分为 4 个相等的 div？

> ID：15535210
> 
> 赞同：1
> 
> 时间：2013-03-20T21:36:16.977
> 
> 标签：jquery, html, google-visualization, jquery-tabs

我正在使用 jquery 选项卡，并且在我的一个选项卡中有 4 个谷歌图表（每个包含一个 div）。我想将每个 div 放置在选项卡区域的 1/4 上。（在屏幕的北部、南部、东部和西部）。

现在我的html是：

```
<div id="chartsTab">
<!--Div that will hold the volume column chart-->
<div id="chart_div_volume" style="width:400; height:300"></div>
</div>
<div id="chart_div_midp" style="width:400; height:300"></div>
</div>
</div>
<div id="chart_div_spread" style="width:400; height:300"></div>
</div>
</div>
<div id="chart_div_volatility" style="width:400; height:300"></div>
</div> 
```

所以我的图表是一个在另一个之下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:53:58.133

这是一个[显示示例的工作小提琴](http://jsfiddle.net/dozoisch/2wePu/)。

HTML：

```
<div id="chartsTab">
    <!--Div that will hold the volume column chart-->
    <div id="chart_div_volume" class="tab" ></div>
    <div id="chart_div_midp" class="tab"></div>
    <div style="clear:both"></div>
    <div id="chart_div_spread" class="tab"></div>
    <div id="chart_div_volatility" class="tab"></div>
</div> 
```

*`clear:both`请注意在要强制新行的位置使用 div 。*

只需将宽度调整为您想要的宽度。如果您希望它能够很好地全屏显示，请考虑使用 %. 但请注意，如果重新调整浏览器的大小，% 可能会达到错误的大小。因此，如果您使用 % 考虑添加一个`min-width`.

CSS：

```
.tab {
    float: left;
    width: 400px;
    height: 3000px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:05:42.423

将图表宽度设为 50%，然后向左浮动。

html:

```
<div id="chartsTab">
    <!--Div that will hold the volume column chart-->
    <div id="chart_div_volume" class="tab" >1</div>
    <div id="chart_div_midp" class="tab">2</div>
    <div id="chart_div_spread" class="tab">3</div>
    <div id="chart_div_volatility" class="tab">4</div>
</div> 
```

CSS：

```
#chartsTab {
    width: 200px;
}
.tab {
    float: left;
    width: 50%;
    height: 100px;
}

.tab:nth-child(1){
 background-color: #f00;   
}

.tab:nth-child(2){
 background-color: #0f0;   
}

.tab:nth-child(4){
 background-color: #00f;   
}

.tab:nth-child(5){
 background-color: #000;   
} 
```

[http://jsfiddle.net/2wePu/2/](http://jsfiddle.net/2wePu/2/)

# java - Spring Batch 不会以并行模式执行流程。

> ID：15535212
> 
> 赞同：1
> 
> 时间：2013-03-20T21:36:18.963
> 
> 标签：java, spring, spring-batch

Spring Batch 不会以并行模式执行流程。我究竟做错了什么？

```
<split id="preprocessingStep" next="decompress">
        <flow>
            <step id="step11" next="step22">
                <tasklet ref="my1" />
            </step>

            <step id="step22">
                <tasklet ref="my2" />
            </step>

        </flow>
        <flow>
            <step id="step33">
                <tasklet ref="my3" />
            </step>
        </flow>
</split> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T22:54:36.003

我认为这是因为您使用单线程任务执行器。尝试添加

```
<bean id="taskExecutor" class="org.springframework.core.task.SimpleAsyncTaskExecutor" 
```

并将线路更改为

```
 <split id="preprocessingStep" task-executor="taskExecutor" next="decompress"> 
```

到你的配置。

# c# - 删除 TableLayoutPanel 中的特定行

> ID：15535214
> 
> 赞同：27
> 
> 时间：2013-03-20T21:36:23.667
> 
> 标签：c#, .net, tablelayoutpanel

我有 TableLayoutPanel，我以编程方式将 Rows 添加到其中。用户基本上选择了一个属性，然后将其与一些控件一起显示在表格中。我想我在这里有一个普遍的理解问题，我会尝试解释它。

每行中的一个控件是一个“删除”按钮。该按钮应该删除它所在的行。我所做的是向按钮添加一个事件处理程序并设置当前行数。

```
deleteTalent.Click += (sender, e) => buttonClickHandler(numberOfRows); 
```

处理程序的代码：

```
private void buttonClickHandler(int rowCount)
{
    int count = rowCount - 1;
    for (int i = count; i < (count + 5); i++)
    {
        balanceTable.Controls.RemoveAt(count);
    }
    balanceTable.RowStyles.RemoveAt(count);
    balanceTable.RowCount--;

} 
```

我看了好几个小时，到处玩。但我找不到有效的清洁解决方案。我对 C# 也很陌生

这是创建新行的完整函数：

```
private void addBalanceItems(ToolStripMenuItem item)
{
    int numberOfRows = balanceTable.RowCount;
    if (numberOfRows > 1)
    {
        balanceTable.RowStyles.Add(new System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.AutoSize));

    }
    balanceTable.Height = numberOfRows * 45;
    Steigerungsrechner rechner = new Steigerungsrechner();
    string tag = item.Tag.ToString();

    //change that asap :(
    if (tag == "A") { rechner.column = 1; }
    if (tag == "B") { rechner.column = 2; }
    if (tag == "C") { rechner.column = 3; }
    if (tag == "D") { rechner.column = 4; }
    if (tag == "E") { rechner.column = 5; }
    if (tag == "F") { rechner.column = 6; }
    if (tag == "G") { rechner.column = 7; }
    if (tag == "H") { rechner.column = 8; }

    Label talentName = new Label();
    talentName.Text = item.Text;
    talentName.Height = standardHeight;
    talentName.TextAlign = ContentAlignment.MiddleLeft;
    talentName.AutoSize = true;
    Label cost = new Label();
    cost.TextChanged += (sender, e) => costChangeHandler(cost);
    cost.Height = standardHeight;
    cost.TextAlign = ContentAlignment.MiddleLeft;
    TextBox startValue = new TextBox();
    startValue.TextChanged += (sender, e) => startValueChangeHandler(rechner, startValue, cost);
    startValue.Height = standardHeight;
    startValue.TextAlign = HorizontalAlignment.Center;
    TextBox endValue = new TextBox();
    endValue.TextChanged += (sender, e) => endValueChangeHandler(rechner, endValue, cost);
    endValue.Height = standardHeight;
    endValue.TextAlign = HorizontalAlignment.Center;
    Button deleteTalent = new Button();
    deleteTalent.Text = "x";
    deleteTalent.Click += (sender, e) => buttonClickHandler(numberOfRows);
    deleteTalent.Height = standardHeight;

    balanceTable.Controls.Add(talentName);
    balanceTable.Controls.Add(startValue);
    balanceTable.Controls.Add(endValue);
    balanceTable.Controls.Add(cost);
    balanceTable.Controls.Add(deleteTalent);
    balanceTable.Visible = true;
    balanceTable.RowCount++;
} 
```

任何帮助将不胜感激！:)

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-03-20T23:08:12.310

是的，从 TableLayoutPanel 中删除任意行一点*都不*直观。他们真的把这个设计搞砸了。

删除行的唯一方法是设置[`RowCount`](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.rowcount.aspx)属性。仅这一点就够奇怪了。该属性确实看起来应该是只读的，并且每次看到它时，执行此操作的代码对我来说都是错误的。

但除此之外，这种设计的结果是您不能从中间删除行。重置该`RowCount`属性只会导致行从底部删除。

解决方法有点笨拙，有多个步骤会出错：

1.  从要删除的行中删除控件
2.  如果适用，将这些控件移动到另一行。
3.  将要删除的行之后的其他行中的所有控件向上移动一行。
4.  `RowCount`最后，通过递减属性的值来删除最后一行。

快速的谷歌搜索显示有人[编写并共享了](http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/50d87be6-bbcb-4194-9a3c-b90633a12112)声称这样做的代码。它在 VB.NET 中，但应该很[容易翻译](http://www.developerfusion.com/tools/convert/vb-to-csharp/)成您的母语。

我承认我知道我只是平底船并将`RowHeight`我希望“删除”的行设置为 0。这样，自动调整大小就可以为你工作。不过，您可能仍想删除它包含的控件。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2015-07-12T19:58:25.263

这是一个静态类，可以帮助您通过索引删除任何行：

```
using System.Windows.Forms;

public static class TableLayoutHelper
{
    public static void RemoveArbitraryRow(TableLayoutPanel panel, int rowIndex)
    {
        if (rowIndex >= panel.RowCount)
        {
            return;
        }

        // delete all controls of row that we want to delete
        for (int i = 0; i < panel.ColumnCount; i++)
        {
            var control = panel.GetControlFromPosition(i, rowIndex);
            panel.Controls.Remove(control);
        }

        // move up row controls that comes after row we want to remove
        for (int i = rowIndex + 1; i < panel.RowCount; i++)
        {
            for (int j = 0; j < panel.ColumnCount; j++)
            {
                var control = panel.GetControlFromPosition(j, i);
                if (control != null)
                {
                    panel.SetRow(control, i - 1);
                }
            }
        }

        var removeStyle = panel.RowCount - 1;

        if (panel.RowStyles.Count > removeStyle)
            panel.RowStyles.RemoveAt(removeStyle);

        panel.RowCount--;
    }
} 
```

有一件事要提：我们通过的控件`panel.GetControlFromPosition(...)`必须是可见的，否则它将返回`null`而不是不可见的控件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-03-22T06:41:58.297

`rowCount`首先删除现有的控件

```
for(int i = 0; i < panel.ColumnCount; i++){
     Control Control = panel.GetControlFromPosition(i, rowCount);
     panel.Controls.Remove(Control);
  } 
```

然后删除行

```
panel.RowStyles.RemoveAt(rowCount-1); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-31T07:32:23.880

**删除**完整的表 -

```
tableLayoutPanel1.Controls.Clear();
tableLayoutPanel1.RowStyles.Clear(); 
```

****再次****设置**您的表格**标题**-**

 ****```
 tableLayoutPanel.RowCount = 1;
            tableLayoutPanel.RowStyles.Add(new RowStyle(SizeType.Absolute, 20F));
            tableLayoutPanel.Controls.Add(new Label() { Text = "MONTH", Font = new Font("Century Gothic", 12, FontStyle.Bold), ForeColor = Color.LightGray }, 0, tableLayoutPanel.RowCount - 1);
            tableLayoutPanel.Controls.Add(new Label() { Text = "YEAR", Font = new Font("Century Gothic", 12, FontStyle.Bold), ForeColor = Color.LightGray }, 1, tableLayoutPanel.RowCount - 1);
            tableLayoutPanel.Controls.Add(new Label() { Text = "MEASURED WAFERS", Font = new Font("Century Gothic", 12, FontStyle.Bold), ForeColor = Color.LightGray }, 2, tableLayoutPanel.RowCount - 1); 
```

3 列 - 1 行

也许有人可以使用我的代码片段，效果很好......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-14T16:51:08.950

您不能完全删除一行，`tablelayoutpanel`但有一个解决方法：

1.  删除行中的所有控件，如果您知道控件的名称，则更容易，因为您可以调用 dispose 方法。
2.  将行的高度设置为可能`2px`使用行样式方法（例如`tablelayoutpanel1.Rowstyle(index).height=2`）

对我来说，这创造了奇迹，无论行索引如何，行都完全折叠了行。****

# bdd - JBehave 与 FitNesse

> ID：15535215
> 
> 赞同：1
> 
> 时间：2013-03-20T21:36:24.943
> 
> 标签：bdd, functional-testing, fitnesse, jbehave

如果您的系统基本上是在处理数字，即给定一组大输入，对它们运行一个进程，然后断言输出，哪个是更好的框架？

“大量输入”是指我们需要为几个不同的相关实体输入数据。

此外，还有几个输出，即我们最后不只是得到一个数字。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-24T18:21:49.510

如果您发现自己通过不同的示例与人交谈，那么 JBehave 可能非常好。

如果您发现自己制作数字列表并将输入与输出进行比较，Fitnesse 可能会更好。

但是，如果您发现自己与其他开发人员而不是其他人交谈，请使用普通的旧 JUnit。您拥有的抽象越少，运行起来就越快，维护起来就越容易。

# scala - 使用 Scala 集合时的奇怪结果

> ID：15535216
> 
> 赞同：1
> 
> 时间：2013-03-20T21:36:26.450
> 
> 标签：scala, scala-collections

我有一些测试结果我无法解释。

第一个测试对包含 4 个元素的列表进行过滤、映射和归约：

```
{
    val counter = new AtomicInteger(0)
    val l = List(1, 2, 3, 4)
    val filtered = l.filter{ i =>
        counter.incrementAndGet()
        true
    }
    val mapped = filtered.map{ i =>
        counter.incrementAndGet()
        i*2
    }
    val reduced = mapped.reduce{ (a, b) =>
        counter.incrementAndGet()
        a+b
    }
    println("counted " + counter.get + " and result is " + reduced)
    assert(20 == reduced)
    assert(11 == counter.get)
} 
```

计数器按我的预期增加了 11 倍：过滤期间每个元素一次，映射期间每个元素一次，以及 3 次以将 4 个元素相加。

使用通配符会改变结果：

```
{
    val counter = new AtomicInteger(0)
    val l = List(1, 2, 3, 4)
    val filtered = l.filter{
        counter.incrementAndGet()
        _ > 0
    }
    val mapped = filtered.map{
        counter.incrementAndGet()
        _*2
    }
    val reduced = mapped.reduce{ (a, b) =>
        counter.incrementAndGet()
        a+b
    }
    println("counted " + counter.get + " and result is " + reduced)
    assert(20 == reduced)
    assert(5 == counter.get)
} 
```

我不知道如何在 reduce 中使用通配符（代码无法编译），但现在，计数器只增加了 5 次！！

那么，问题 #1：为什么通配符会改变调用计数器的次数，以及它是如何工作的？

然后是我的第二个相关问题。我对视图的理解是它们会懒惰地执行传递给单子方法的函数，但是下面的代码没有显示出来。

```
{
    val counter = new AtomicInteger(0)
    val l = Seq(1, 2, 3, 4).view
    val filtered = l.filter{
        counter.incrementAndGet()
        _ > 0
    }
println("after filter: " + counter.get)
    val mapped = filtered.map{
        counter.incrementAndGet()
        _*2
    }
println("after map: " + counter.get)
    val reduced = mapped.reduce{ (a, b) =>
        counter.incrementAndGet()
        a+b
    }
println("after reduce: " + counter.get)
    println("counted " + counter.get + " and result is " + reduced)
    assert(20 == reduced)
    assert(5 == counter.get)
} 
```

输出是：

```
after filter: 1
after map: 2
after reduce: 5
counted 5 and result is 20 
```

问题 #2：为什么函数会立即执行？

我正在使用 Scala 2.10

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-20T21:43:31.063

你可能在想

```
filter {
  println
  _ > 0
} 
```

方法

```
filter{ i =>
  println
  i > 0
} 
```

但 Scala 有其他想法。原因是

```
{ println; _ > 0 } 
```

是一个语句，它首先打印一些东西，然后返回`> 0`函数。因此，它将您正在做的事情解释为指定函数的有趣方式，相当于：

```
val p = { println; (i: Int) => i > 0 }
filter(p) 
```

这又相当于

```
println
val temp = (i: Int) => i > 0   // Temporary name, forget we did this!
val p = temp
filter(p) 
```

正如您可以想象的那样，它并不能完全按照您想要的方式进行 - 您只在开始时打印（或在您的情况下进行增量）一次。您的两个问题都源于此。

如果您使用下划线表示“填写参数”，请确保您只有一个表达式！如果您使用多个语句，最好坚持使用显式命名的参数。

# backbone.js - 对象 [object Object] 没有“on”方法

> ID：15535219
> 
> 赞同：0
> 
> 时间：2013-03-20T21:36:41.557
> 
> 标签：backbone.js

我对骨干很陌生，我正在阅读，按照它的示例创建一个待办事项列表。我不明白为什么这段代码不起作用：

```
 var Todo= Backbone.Model.extend({
    defaults:       {
        title       :   "",
        completed   :   false
    },

    initialize:     function(){
            console.log("model initialized");
            this.on("change", function(){
                console.log("values for this model have changed.");
            });
    }        
});

var todo1= new Todo(); 
```

我包含的库是 jquery、下划线和主干。这有什么问题？为什么“.on”不可用？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T10:28:46.600

`on`仅包含在 Backbone 0.9.0 中。你需要更新它。

# javascript - 发送ajax消息的问题

> ID：15535221
> 
> 赞同：0
> 
> 时间：2013-03-20T21:36:49.500
> 
> 标签：javascript, ajax, json

JQuery / JSON / AJAX 的新手，所以请善待。

我已经从 SO 和其他网站上的示例中拼凑出这幅作品，但我很挣扎。

我创建了一些函数来处理 AJAX 响应......

```
function newOrderSuccess(response) { ... }
function newOrderTimeout() { ... }
function newOrderFail() { ... } 
```

...

这是 AJAX 调用：

```
function sendCallAjaxUsingJson(theUrl, theData, successCallbackFunction, timeoutCallbackFunction, otherErrorCallback, timeoutValueMilli)
{
var successFn = successCallbackFunction; 
var timeoutFn = timeoutCallbackFunction; 
var otherFn = otherErrorCallback;
if(!(typeof successFn === 'function') || !(typeof timeoutFn === 'function') || !(typeof otherFn === 'function')) 
        return false;
$.ajax({
        type: "POST",
        url: theUrl,
        timeout:timeoutValueMilli,
        dataType: 'json',
        data: { json: JSON.stringify(theData) },
        success:successFn(result),
        error: function(x, t, m) {
                   if(t==="timeout") {
                        timeoutFn();
                    } else {
                        otherFn();
                    }
                }
    }); 
```

}

我的代码调用函数如下：

```
sendCallAjaxUsingJson("/ordertaker.php", 'submitOrder','newOrderSuccess', 'newOrderTimeout', 'newOrderFail',1000); 
```

结果……什么都没有。`newOrderFail()`在上传文件之前，我正在使用该功能`ordertaker.php`，但现在我什么也没得到。

我哪里做错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:48:46.410

您将字符串传递给`sendCallAjaxUsingJson`而不是函数，

```
sendCallAjaxUsingJson("/ordertaker.php", 'submitOrder',newOrderSuccess, newOrderTimeout, newOrderFail,1000); 
```

此外，您在 ajax 调用中调用您的成功函数，而不是设置它。

```
success:successFn, 
```

# asp.net - ASp.Net GridView 使用存储过程进行更新

> ID：15535223
> 
> 赞同：1
> 
> 时间：2013-03-20T21:36:53.013
> 
> 标签：asp.net, web-applications, gridview, datagridview

我已经阅读了大量关于此的网站。如果您调用一些代码而没有解释它是如何生成的（设计视图与键入）或者只是想使用简单的选择和更新语句，那么有很多“示例”。

我有一个网格视图。我正在使用存储过程中的代码填充它。现在我想编辑数据。我没有通过设计视图（数据源、列等）在 Gridview 的属性中设置任何内容。我的问题是，如何设置它以允许编辑并使用 SP 将其发送回数据库？

由于我选择不在设计视图中设置属性，我现在是否必须使用代码手动创建列？

在设计视图中设置属性并走这条路更好吗？我是这样开始的，但是在使用 SP 更新时遇到了问题。

我想整个在设计器中做与在代码中做这件事让我感到困惑。

我开始在 html 和 c# 中添加 RowEdit、RowCommand 等，但是当我运行它时仍然没有在网页上看到 EDIT/CANCEL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:45:55.167

学习使用 ObjectDataSource。它使您可以最大程度地自由地存储您使用的数据 - 您将选择、更新和删除委托给外部类，您只需在其中编写使用 ado、linq、hibernate、webservice 或任何东西的代码。

直接针对固定的数据库结构编写视图迟早会伤害到您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-22T05:49:21.780

创建表，如名称 StckDetails [在此处输入图像描述](http://i.stack.imgur.com/4OAnQ.png)

在使用 anme sp_StckDetails1 ALTER procedure [dbo].[sp_StockDetails1] 创建过程后（
@Action varchar(20), @Branch_ID int=null, @Stock_Name varchar(50)=null, @Stock_code varchar(20)=null, @Qty int =null, @Purchase_Price decimal(18,0)=null, @Sales_Price decimal(18,0)=null, @Order_ID int=null ) 作为 BEGIN SET NOCOUNT ON; if @Action='Update' begin update StockDetails set Qty=@Qty,Purchase_Price= @Purchase_Price,Sales_price=@Sales_Price where Order_ID=@Order_ID end End

然后添加 c#code is Label lbl_id = GridView2.Rows[e.RowIndex].FindControl("Label2") as Label; TextBox txt1_qty = GridView2.Rows[e.RowIndex].FindControl("TextBox7") as TextBox; TextBox txt2_PP = GridView2.Rows[e.RowIndex].FindControl("TextBox8") as TextBox; TextBox txt3_sp = GridView2.Rows[e.RowIndex].FindControl("TextBox9") as TextBox;

```
 SqlCommand cmd = new SqlCommand("sp_StockDetails1", con);
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.Parameters.AddWithValue("@Action", "Update");
        cmd.Parameters.AddWithValue("@Order_ID", SqlDbType.Int).Value = Convert.ToInt32(lbl_id.Text);
        cmd.Parameters.AddWithValue("@Qty", SqlDbType.Int).Value = Convert.ToInt32(txt1_qty.Text);
        cmd.Parameters.AddWithValue("@Purchase_Price", SqlDbType.Decimal).Value = Convert.ToDecimal(txt2_PP.Text);
        cmd.Parameters.AddWithValue("@Sales_Price", SqlDbType.Decimal).Value = Convert.ToDecimal(txt3_sp.Text);
        con.Open();
        cmd.ExecuteNonQuery();
        con.Close();

        GridView2.EditIndex = -1;
        fillgrid2(); 
```

Gridview设计代码是aspx代码

'>'>'>'>'>'>'>'> '> '> ......................................................................................................................................................

试试看它会说话

# haskell - 有 LambdaCube 3D 教程或介绍吗？

> ID：15535225
> 
> 赞同：2
> 
> 时间：2013-03-20T21:37:00.190
> 
> 标签：haskell, 3d

我开始对功能图形感兴趣。通过[GPipe](http://www.haskell.org/haskellwiki/GPipe)我到达了[LambdaCube](http://www.haskell.org/haskellwiki/LambdaCubeEngine)。有没有它的介绍？hackage 的文档很大，示例有点长，[博客上的解释](http://lambdacube3d.wordpress.com/2012/09/07/the-lambdacube-3d-pipeline-model/)虽然有趣，但不允许开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T12:45:24.097

目前还没有教程级别的材料。由于 LambdaCube 仍处于一切都在不断变化的阶段，任何类型的指南都会几乎立即失去其相关性。唯一保持最新的是存储库中的示例，即使它们没有记录，所以如果你想从今天开始使用它，我仍然建议阅读这些。特别是，[阴影映射示例](https://github.com/csabahruska/lc-dsl/tree/master/samples/shadow-mapping)被设计为独立的：它展示了如何从头开始构建网格和管道描述。

需要注意的是，Hackage 上的 LambdaCube 版本仍然是旧引擎，与您在博客上阅读的任何内容都无关，因为它是旧的 Ogre 启发的命令式渲染器。权威版本在我们的[GitHub 存储库](https://github.com/csabahruska/lc-dsl)中。

# twitter-bootstrap - 在移动设备上堆叠 Bootstrap 轮播项目？

> ID：15535229
> 
> 赞同：3
> 
> 时间：2013-03-20T21:37:09.673
> 
> 标签：twitter-bootstrap, carousel

我正在使用 Bootstrap 轮播来循环浏览页面的子部分。虽然这在大屏幕上非常适合我，但在移动设备上，我更喜欢让子部分一个接一个地显示。这可能吗？

因此，例如（澄清）

在关于“关于”部分下的桌面上，有一个轮播，可通过“任务”、“联系人”和“客户列表”循环，并带有下一个/上一个按钮。

在移动设备上，我希望这三个部分一个在另一个之上，您只需正常滚动浏览它们；没有下一个/上一个按钮。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-26T15:06:04.683

最后，我通过使用媒体查询覆盖轮播项目的引导程序默认样式，确实很容易做到这一点：

```
@media (max-width: 767px) {
    #myCarousel {
        .item { 
            display:block;
            padding-bottom:10px;
        }
    }
} 
```

这需要 carousel `.item`s，通常设置为`display:none`unless`.active`并一个接一个地显示它们，并带有一点填充。这不会禁用或暂停引导程序的轮播行为，但如果您还隐藏轮播指示器和任何轮播导航，则无法访问该行为。

也许不是最优雅的解决方案，但它确实有效。

# php - mcrypt没有解密到相同的长度

> ID：15535234
> 
> 赞同：1
> 
> 时间：2013-03-20T21:37:25.943
> 
> 标签：php, json, mcrypt

我正在尝试使用我创建的类（下面的方法）对一些数据进行加密。这就是你如何 mcrypt 数据然后使用 pack，然后你可以使用 unpack 来取回数据。

```
$packed = $server->cache->pack("packed", array(123,123,123), "Password");
if(!$packed){
    echo "Could not encrypt data\n";
}
$server->cache->unpack("packed", "Password"); 
```

当我打包它时，我`var_dump`对`json_encode()`数据做一个，并得到这个：
`string(13) "[123,123,123]"`

当我打开它时，我`var_dump`在`mcrypt_decode()`字符串上做一个，然后得到这个：
`string(32) "[123,123,123]"`

为什么长度不一样？当我`json_decode()`在`mcrypt_decode()`弦上做 a 时，我`null`回来了，这就是原因。如果我修剪数据它可以工作，但我不应该修剪它。

以下是方法：

```
<?php
public function put($key, $value, $life = 0)
{
    $this->cache[$key] = $value;
    $life              = (int)$life;
    if($life > 0)
    {
        $life = strtotime("now + $life seconds");
    }

    $this->life[$key] = $life;
}

public function get($key)
{
    return $this->cache[$key];
}

public function pack($key, $value, $secret, $life = 0)
{
    if(!function_exists("mcrypt_encrypt"))
    {
        $this->put($key, $value, $life);
        return false;
    }
    $iv_size   = mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_ECB);
    $iv        = mcrypt_create_iv($iv_size, MCRYPT_RAND);
    $value     = json_encode($value);
    var_dump($value);
    $cryptdata = mcrypt_encrypt(MCRYPT_RIJNDAEL_256, $secret, $value, MCRYPT_MODE_ECB, $iv);
    $this->put($key, $cryptdata, $life);
    return true;
}

public function unpack($key, $secret)
{
    if(!function_exists("mcrypt_decrypt"))
    {
        return json_decode($this->get($key), true);
    }
    $cryptdata = $this->get($key);
    $iv_size   = mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_ECB);
    $iv        = mcrypt_create_iv($iv_size, MCRYPT_RAND);
    $data      = mcrypt_decrypt(MCRYPT_RIJNDAEL_256, $secret, $cryptdata, MCRYPT_MODE_ECB, $iv);
    //$data      = json_decode($data, true);
    var_dump($data);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-11T23:02:06.590

当使用像 ECB 这样的分组密码模式时（顺便说一句，你不应该使用那个），MCrypt 将对数据进行 NUL 填充，这样它的长度就可以被加密算法的块大小整除。

如果您必须知道，对于 Rijndael-256，块大小为 256 位或 32 字节。

考虑到您正在加密 JSON 数据，您可以只`rtrim()`处理数据而不用担心它。除非您切换到 CTR 之类的计数器模式，否则无法解决此问题。

# android - 在 BroadcastReceiver (Android) 中更改 Activity 的 TextView

> ID：15535235
> 
> 赞同：0
> 
> 时间：2013-03-20T21:37:27.197
> 
> 标签：android, android-activity, textview, broadcastreceiver

我有一个简单的 Android 应用程序，其中包含一个包含 TextView 的 Activity。我创建了一个 BroadcastReceiver，其目的是执行一些数值计算，将结果转换为字符串，然后将 TextView 的文本值更改为该字符串。但是，由于通常在应用程序的 Activity 不存在时调用 BroadcastReceiver，我似乎无法找到访问 Activity 的 TextView 的方法（我总是得到 NullPointerException）。

我在 StackOverflow 上阅读了其他文章，这些文章建议使用回调方法为我的 BroadcastReceiver 实现监听器，但老实说，我不确定如何实现这一点。我对回调方法的概念有些熟悉，只是不确定如何在这种情况下实现它。谁能建议我如何做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:50:50.830

**编辑**

使用`AsyncTask`will do 在后台执行操作。[示例一](http://www.javasrilankansupport.com/2012/11/asynctask-android-example-asynctask-in.html) [示例二](http://samir-mangroliya.blogspot.de/p/android-asynctask-example.html)

请注意，您必须将您的传递`TextView`给`AsyncTask`它的构造函数内部

# matlab - Matlab：如何使用 nlinfit 将状态空间模型拟合到数据中

> ID：15535237
> 
> 赞同：1
> 
> 时间：2013-03-20T21:37:41.153
> 
> 标签：matlab, model, state, space

我已经进行了一项实验，并希望将状态空间模型拟合到数据中。不幸的是，我对如何实现这一点几乎没有经验，所以希望能得到一些帮助。

在实验中，参与者达到不同的目标。参与者通过屏幕上的光标接收有关其移动的反馈。此光标显示它们的到达运动，但旋转了 30 度。这意味着参与者最初会犯很大的错误，但通过反复练习来减少错误。

以下数据提供了一些说明性结果。每个值代表一个“纪元”（八次试验的平均值）：

> 18.26 13.95 10.92 10.32 8.23 6.57 7.05 5.98 5.99 4.58 4.35 3.72 3.71 3.04 4.47 4.16

我发现一篇论文使用了类似的实验，并将状态空间模型拟合到他们的数据中。该模型由两个方程组成：

> 1) e(n) = p(n) - s(n) + E(n) 2) s(N+1) = s(n) + Ae(n)
> 
> 其中 e(n) = 试验 n 的误差（即上述值） p(n) = 应用于运动的扰动（即 30 度） s(n) = 系统的内部状态 E(n) = 噪声 A = 适应率扰动

该论文表明他们使用 nlinfit matlab 函数来实现此模型，但我不明白我将如何做到这一点。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-08T06:48:54.423

我现在才看到你的帖子，很久以后，但我在寻找我自己的问题时遇到了它。

根据经验，我知道如果您有一个想要获得状态空间模型的系统，并且您已经测量了系统的输入和相应的测量输出，您可以使用“pem”函数来构建状态空间模型基于您的测量。

“pem”功能是系统识别工具箱的一部分。

# python - 如何使用 Popen 同时写入标准输出和记录文件？

> ID：15535240
> 
> 赞同：55
> 
> 时间：2013-03-20T21:37:48.387
> 
> 标签：python, subprocess, popen

我正在使用 Popen 调用一个 shell 脚本，该脚本不断将其 stdout 和 stderr 写入日志文件。有没有办法同时连续输出日志文件（到屏幕上），或者让 shell 脚本同时写入日志文件和标准输出？

我基本上想在 Python 中做这样的事情：

```
cat file 2>&1 | tee -a logfile #"cat file" will be replaced with some script 
```

同样，这将 stderr/stdout 一起传送到 tee，tee 将其同时写入 stdout 和我的日志文件。

我知道如何在 Python 中将 stdout 和 stderr 写入日志文件。我被困的地方是如何将这些复制回屏幕：

```
subprocess.Popen("cat file", shell=True, stdout=logfile, stderr=logfile) 
```

当然，我可以做这样的事情，但是有没有办法在没有 tee 和 shell 文件描述符重定向的情况下做到这一点？：

```
subprocess.Popen("cat file 2>&1 | tee -a logfile", shell=True) 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-03-20T21:46:35.577

您可以使用管道从程序的标准输出中读取数据并将其写入您想要的所有位置：

```
import sys
import subprocess

logfile = open('logfile', 'w')
proc=subprocess.Popen(['cat', 'file'], stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
for line in proc.stdout:
    sys.stdout.write(line)
    logfile.write(line)
proc.wait() 
```

*更新*

在 python 3 中，`universal_newlines`参数控制管道的使用方式。如果`False`，管道读取返回`bytes`对象并且可能需要被解码（例如，`line.decode('utf-8')`）以获得字符串。如果`True`，python 会为你解码

> 在 3.3 版更改：当 universal_newlines 为 True 时，该类使用编码 locale.getpreferredencoding(False) 而不是 locale.getpreferredencoding()。有关此更改的更多信息，请参阅 io.TextIOWrapper 类。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2016-01-05T05:22:58.107

模拟：`subprocess.call("command 2>&1 | tee -a logfile", shell=True)`不调用`tee`命令：

```
#!/usr/bin/env python2
from subprocess import Popen, PIPE, STDOUT

p = Popen("command", stdout=PIPE, stderr=STDOUT, bufsize=1)
with p.stdout, open('logfile', 'ab') as file:
    for line in iter(p.stdout.readline, b''):
        print line,  #NOTE: the comma prevents duplicate newlines (softspace hack)
        file.write(line)
p.wait() 
```

要修复可能的缓冲问题（如果输出延迟），请参阅[Python 中的链接：从 subprocess.communicate() 读取流输入](https://stackoverflow.com/a/17698359/4279)。

这是 Python 3 版本：

```
#!/usr/bin/env python3
import sys
from subprocess import Popen, PIPE, STDOUT

with Popen("command", stdout=PIPE, stderr=STDOUT, bufsize=1) as p, \
     open('logfile', 'ab') as file:
    for line in p.stdout: # b'\n'-separated lines
        sys.stdout.buffer.write(line) # pass bytes as is
        file.write(line) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-08-30T06:49:54.030

**为交互式应用程序逐字节写入终端**

此方法立即将它获得的任何字节写入标准输出，这更接近于模拟 的行为`tee`，尤其是对于交互式应用程序。

主文件

```
#!/usr/bin/env python3
import os
import subprocess
import sys
with subprocess.Popen(sys.argv[1:], stdout=subprocess.PIPE, stderr=subprocess.STDOUT) as proc, \
        open('logfile.txt', 'bw') as logfile:
    while True:
        byte = proc.stdout.read(1)
        if byte:
            sys.stdout.buffer.write(byte)
            sys.stdout.flush()
            logfile.write(byte)
            # logfile.flush()
        else:
            break
exit_status = proc.returncode 
```

睡眠.py

```
#!/usr/bin/env python3
import sys
import time
for i in range(10):
    print(i)
    sys.stdout.flush()
    time.sleep(1) 
```

首先，我们可以进行非交互式完整性检查：

```
./main.py ./sleep.py 
```

我们看到它实时计入标准输出。

接下来，对于交互式测试，您可以运行：

```
./main.py bash 
```

然后，您键入的字符会在您键入时立即出现在终端上，这对于交互式应用程序非常重要。这是运行时发生的情况：

```
bash | tee logfile.txt 
```

此外，如果您希望输出立即显示在 ouptut 文件中，则还可以添加：

```
logfile.flush() 
```

但`tee`不这样做，我担心它会影响性能。您可以通过以下方式轻松测试：

```
tail -f logfile.txt 
```

相关问题：[子进程命令的实时输出](https://stackoverflow.com/questions/18421757/live-output-from-subprocess-command)

在 Ubuntu 18.04、Python 3.6.7 上测试。

# java - MS Access DB 查询结果到 JTextField

> ID：15535248
> 
> 赞同：0
> 
> 时间：2013-03-20T21:38:08.727
> 
> 标签：java, database, ms-access, jtextfield

我正在尝试向数据库添加新记录，将在数据库中添加的信息将输入到 JTextField 中，我正在尝试使第一个 JTextField 内容成为下一个可接受的索引，例如，

```
Table_ID   Item1   Item2   etc
--------   -----   -----   ---
    1       www     rrr
    2       rrr     ccc 
```

我知道我可以通过此查询获得最大 ID：**SELECT TOP 1 Table_ID FROM Table_name ORDER BY Table_ID DESC**结果我会得到**2**，但如何做到 JTextField 内容将为**3**？

# jquery - JQuery 截断和显示

> ID：15535252
> 
> 赞同：0
> 
> 时间：2013-03-20T21:38:14.580
> 
> 标签：jquery, jquery-animate, toggle, substring

我正在寻找在我的网站中创建效果，我的页面顶部有一个信息容器，充当此特定页面的标题。我的“标题”项目由一些文本和一个相当大的图像组成，但文本可能需要截断为一定数量的字符。我希望能够单击一个按钮，然后通过展开文本 div 来展开/滑动以显示未截断的文本，覆盖图像

HTML

```
<div class="container">
    <div id="mytext" class="text"><h1>Lorem ipsum</h1> dolor sit amet, consectetur adipiscing elit. Nunc vestibulum sodales massa ac consectetur. Maecenas eu nisl vel erat pellentesque eleifend ut a est. Nullam ac lorem nisi, eu consequat nisi. In euismod porttitor adipiscing. Aenean feugiat, turpis nec accumsan posuere, diam tellus pharetra arcu, sit amet ultrices magna felis ac elit. Donec sit amet massa nisi, sed semper turpis. Aliquam fringilla vestibulum urna, in tincidunt dui facilisis condimentum. Integer eget enim lectus, id congue ipsum. Sed sit amet ante nec turpis mattis venenatis. In urna quam, cursus vel cursus eu, volutpat eget leo. Praesent in mi diam, vitae tincidunt eros. Etiam feugiat venenatis purus eu cursus. Curabitur euismod, dolor in rhoncus vehicula, leo justo commodo orci, id pulvinar felis purus at lacus. <a href="#" id="expand-div">Expand</a></div>
    <div class="image">Image goes here</div>
</div> 
```

CSS

```
.container {
    width:500px;
    height:300px;
    border:solid 1px black;
    position:relative;
}

.image {
    background:#00b3f0;
    line-height:300px;
    color:black;
    width:50%;
    text-align:center;
}

.text {
    color:black;
    height:100%;
    position:absolute;
    right:0;
    background:#00DD99;
    max-width:50%;
}

.text a {
    text-decoration:none;
    display:inline-block;
    background:white;
    color:black;
    padding:2px 5px;
} 
```

jQuery

```
var expand_btn = document.getElementById('expand-div').outerHTML;

var long_title = document.getElementById('mytext').innerHTML;
var short_title = jQuery.trim(long_title).substring(0, 240).split(" ").slice(0, -1).join(" ") ;

document.getElementById('mytext').innerHTML = short_title + ' - ' +expand_btn;

$("#expand-div").click(function(event) {
    event.preventDefault();
    text_div = $(this).closest('div');
    div_width = parseInt(text_div.css('max-width'));
    if(div_width == 50) {
        $(this).closest('div').animate({"max-width": "100%"}, "slow");
        document.getElementById('expand-div').innerHTML = 'Shrink';
    } else {
        $(this).closest('div').animate({"max-width": "50%"}, "slow");
        document.getElementById('expand-div').innerHTML = 'Expand';
    }
}); 
```

[我已经整理了一个基本的小提琴](http://jsfiddle.net/enkV4/1/)来展示我所追求的那种效果，但是我在编写 JQuery 方面从来都不是最好的，当我试图在文本之间进行更改时，我可能会为自己犯错误，因为它停止工作了。理想情况下，我想从这个位置动画截断效果，但这不是必需的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:41:51.267

使用[css text-overflow](http://www.w3schools.com/cssref/css3_pr_text-overflow.asp)属性应该会使这更容易。但是，它不适用于某些较旧的浏览器。

# c# - 如果指定了错误的端口，SmtpClient 将挂起且不抛出异常

> ID：15535254
> 
> 赞同：9
> 
> 时间：2013-03-20T21:38:20.113
> 
> 标签：c#, asp.net, smtpclient

我试图在我的 Asp.Net C# 应用程序中使用端口 465 和主机“smtp.gmail.com”发送电子邮件，但整个应用程序挂起（继续加载）。调试时卡在 SmtpClient.Send(msg)。

无论指定的凭据如何，它都不会抛出任何要捕获的异常或任何超时错误。我必须关闭或刷新页面才能重新访问该页面。

如果我改为使用端口 587，那么一切正常，并且 SmtpClient.Send 响应并发送电子邮件或返回适当的异常，例如操作超时或基于凭据发送电子邮件失败。

我简化了下面的代码进行演示：

```
var smtp = new SmtpClient
                        {
                            Host = "smtp.gmail.com",
                            Port = 465,
                            EnableSsl = true,
                            Timeout = 200, // or any value it doesn't solve the problem
                            DeliveryMethod = SmtpDeliveryMethod.Network,
                            UseDefaultCredentials = false,
                            Credentials = new NetworkCredential("name@gmail.com", "password")
                        };

var msg = new MailMessage("name@gmail.com", "name@gmail.com", "Any subject", "Any body"); 
smtp.Send(msg); // stuck here
smtp.Dispose(); // never reached
msg.Dispose(); 
```

我尝试了 SendAsync 并减少了超时间隔，但这并没有解决问题。我认为问题在于 smtp.gmail.com 已到达但没有正确响应端口 465，这就是该方法被卡住的原因。

我需要避免这种行为，因为我的应用程序允许动态设置 smtp 服务器详细信息，并且我不希望整个应用程序在输入错误详细信息的情况下挂起。

谢谢，

![在此处输入图像描述](../Images/5ea3a95e0afec77802c0d4088573feec.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-06-07T02:56:31.070

找到这个答案，以防有人来到这里

[SmtpClient 超时不起作用](https://stackoverflow.com/questions/10467476/smtpclient-timeout-doesnt-work)

```
Socket socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
IAsyncResult result = socket.BeginConnect("192.168.1.180", 25, null, null);
// Two second timeout
bool success = result.AsyncWaitHandle.WaitOne(2000, true);
if (!success) {
    socket.Close();
    throw new ApplicationException("Failed to connect server.");
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-11-20T04:16:02.190

将您的 SmptClient 包装在一个`using`语句中，以确保调用 Dispose。

我不确定这是否是原因或您的问题，但我遇到了同样的问题（第一次正确发送，之后经常失败），这已经为我纠正了。

# python - python中三元运算符的缩写

> ID：15535255
> 
> 赞同：1
> 
> 时间：2013-03-20T21:38:27.647
> 
> 标签：python, conditional-operator

我似乎记得三元运算符测试存在的缩写。例如：

```
a = None
b = a if a else 'Not None!'
# b is now 'Not None!' 
```

我以为是这样的

```
a else 'Not None!' 
```

但这不起作用。也许还有另一种使用其他内置类型来缩写它的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:44:42.980

不，没有可用的缩写。

你是不是在想`a or 'Not None!'`呢？

附带说明：`... if ... else ...`被称为[条件表达式](http://docs.python.org/2/reference/expressions.html#conditional-expressions)；它是**一个**三元运算符，但 SQL`BETWEEN ... IN ...`表达式也是如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:52:52.123

是的，在你的情况下有一个缩写。

```
b = a or 'Not None!' 
```

几乎等于

```
b = a if a else 'Not None!' 
```

唯一的区别是`a`在第一种情况下评估一次，在第二种情况下评估两次。在任何一种情况下，放入的值`b`都是相同的。

此外，请意识到在任一代码中，如果`a`不是 None，但仍然是 False-y，您可能会得到意想不到的结果。例如，考虑如果`a`is会发生什么`0.0`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T22:48:07.437

这对我来说真的没有意义

```
a = None
b = a if a else 'Not None!' 
```

您将 b 设置为（包括）`Not None!`的任何错误值`a``None`

也许你在想

```
a = None
b = 'Not None!' if a is None else a 
```

或者其他的东西？

无论如何，除了你可以逃脱的情况

```
b = a or 'Not None!' 
```

或者

```
b = a and 'Not None!' 
```

没有办法避免提及`a`两次

# python - python，帮助替换第一个字母

> ID：15535256
> 
> 赞同：1
> 
> 时间：2013-03-20T21:38:36.783
> 
> 标签：python, replace

我需要替换字符串的第一个字母。我应该使用什么命令？我正在为法语写一个将单词变成过去时的东西，我已经为最后一个字母做了一些工作，即`re`变成了 u，但我需要做一个`je`变成过去时的东西`j'ai`

```
word = raw_input("what words do you want to turn into past tense?")
word2= word

if word2.endswith("re"):
    word3 = word2[:-2] + "u"
    print word3
elif word2.endswith("ir"):
    word3 = word2[:-2] + "i"
    print word3
elif word2.endswith("er"):
    word3 = word2[:-2] + "e"
    print word3
else:
    print "nope" 
```

这就是我到目前为止所做的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:42:47.877

如果你做这样的事情

```
word = 'tu as'
changes = {'je': "j'ai", 'tu':'tu as'}
changes.get(word, 'Nope') 
```

它会给你从“我/你”到“我/你做了”所需的改变。

这是制作翻译的一个非常幼稚的尝试......您不妨将所有术语放在同一个字典中，即

```
changes = {'re':'u', 'ir':'i', 'er':'e', 'je': "j'ai", 'tu':'tu as'} 
```

然后遍历“from”句子中的每个单词，将其转换为等效的过去时态单词。

免责声明：当然这不考虑您使用的语言的语法。完全翻译比这种“a-for-b”类型的交换要复杂得多。

# gradle - gradle 'build' 任务混乱

> ID：15535258
> 
> 赞同：8
> 
> 时间：2013-03-20T21:38:40.127
> 
> 标签：gradle

嗨，我有多项目 gradle 设置

```
-root_project
|-sub_project1
|-sub_project2
|-sub_project3 
```

一切都很好，但有一件事让我发疯。在我的构建脚本中：

```
defaultTasks 'build' <- this works just fine

task buildroom (description: 'This task is invoked by build room script, invokes default task plus publishes artifacts') { 
//    dependsOn('build') <-- this doesn't work

// alternative 
dependsOn(":sub_project1:build")
dependsOn(":sub_project2:build") 
```

当我从命令行'gradlew'调用时<-默认任务被执行

当我从命令行调用'gradlew tasks'<-'all task runnable from root project'下的任务时，我看到'build'

但是当我尝试添加dependsOn（'build'），dependsOn（'：build'）或dependsOn（'：root：build'）时它告诉我

> 出了什么问题：任务'：tasks'执行失败。
> 
> 无法确定任务 ':buildroom' 的依赖关系。

'base' 插件添加了 'assemble' 和 'clean' 任务但不构建...

有小费吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-20T22:18:55.987

`build`任务由插件`java-base`声明。您的根项目可能没有（直接或间接）应用`java-base`，因此没有`build`任务。这就是为什么在*同一个项目*`dependsOn("build")`中命名的任务上添加任务依赖，最终导致错误的原因。不同之处在于：`build`*`defaultTasks`*

 **   它只接受任务名称（同时`dependsOn`也接受任务路径和`Task`对象）。
*   它的任务名称被解析为任务，就好像任务名称已在命令行中输入一样。换句话说，在所有项目中搜索具有给定名称的任务，并返回匹配的任务集。*

# sql - DB2 SQL 将十进制转换为带填充零的字符

> ID：15535260
> 
> 赞同：16
> 
> 时间：2013-03-20T21:39:03.290
> 
> 标签：sql, db2

如何将我的`DECIMAL(11)`字段从转换`12345678`为字符值`00012345678`？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2015-04-21T15:12:34.583

仅使用该 `DIGITS`功能，因为这会验证字段数字或小数等的长度，并在必要时在左侧以零完成。

```
SELECT DIGITS(FIELD) FROM ... 
```

结果字符串的长度始终为：

*   5 如果参数是一个小整数
*   10 如果参数是一个大整数
*   19 如果参数是一个大整数

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-21T13:51:59.983

根据您在@Mr Fuzzy Botton 的回答中的评论，我猜您正在使用[`DB2 for i`](http://pic.dhe.ibm.com/infocenter/iseries/v7r1m0/index.jsp)，它没有该`LPAD`功能。您可以改为使用[`REPEAT`](http://pic.dhe.ibm.com/infocenter/iseries/v7r1m0/topic/db2/rbafzscarepeat.htm)和[`RIGHT`](http://pic.dhe.ibm.com/infocenter/iseries/v7r1m0/index.jsp?topic=/db2/rbafzscaright.htm)函数的组合：

```
SELECT RIGHT(REPEAT('0', 11) || LTRIM(CHAR(your_field)), 11)
FROM your_table 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-03-20T23:35:03.397

使用[http://pic.dhe.ibm.com/infocenter/dzichelp/v2r2/topic/com.ibm.db2.doc.sqlref/castsp.htm](http://pic.dhe.ibm.com/infocenter/dzichelp/v2r2/topic/com.ibm.db2.doc.sqlref/castsp.htm)了解有关 CAST
和[http://pic.dhe.ibm.com的详细信息/infocenter/dzichelp/v2r2/topic/com.ibm.db2z10.doc.sqlref/src/tpc/db2z_scalarfunctionsintro.htm](http://pic.dhe.ibm.com/infocenter/dzichelp/v2r2/topic/com.ibm.db2z10.doc.sqlref/src/tpc/db2z_scalarfunctionsintro.htm)对于字符串函数，
我认为这应该可以解决问题 -

`SELECT LPAD( CAST(FIELD AS CHAR(11)) ,11,'0') AS PADDEDFIELD`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-10-03T18:38:46.423

不知道你是否解决了，但是试试这个：

```
SELECT LPAD( DIGITS( fieldName ), 11, '0') ) as paddedFieldName FROM yourTable 
```

LPAD 是左侧填充，但 DIGITS 函数是我让 DB2 将数值视为字符串的唯一方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-22T06:46:57.900

如果这是 DB2 for i，并且 myColumn 数据类型是具有精度 (11) 和小数位数 (0) 的 DECIMAL，那么：

```
SELECT digits( myColumn ) FROM sysibm.sysdummy1 
```

将返回：

```
....+....1.
DIGITS     
00001234567 
```

可以通过多种方式更改前导零的数量。在使用 DIGITS() 之前转换为不同的精度是一种方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-05-24T12:50:42.933

我的 LeftPad 功能没有 LeftPad 功能

```
 REPEAT('0', 4-length(MY_COLUMN_VALUE))||CHAR(MY_COLUMN_VALUE) as NEW_COLUMN

MY_COLUMN_VALUE NEW_COLUMN
1               0004
23              0023 
```

测试...

```
SELECT '32' MY_VALUE, REPEAT('0', 4-length('23'))||CHAR('23') as LEFTPAB_MY_VALUE FROM sysibm.sysdummy1 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-11-09T13:48:41.827

```
SELECT SUBSTRING( 
          CHAR(100000000000+fieldName),
          2,11
       ) as paddedFieldName
FROM yourTable 
```

我只想在 select 语句中定义我的字段一次，所以上面对我有用并且很整洁

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-21T02:03:07.920

我只是去了另一个方向： cast(field as int)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-27T08:37:39.700

为您的字段 x 试试这个：

```
substr(digits(x), 33 - length(x), length(x) ) 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2018-03-15T18:19:01.460

从数字 8,0 (datenumfld=20170101) 到`01/01/2017`这对我有用：

```
DATE(TO_DATE(CHAR(datenumfld), 'YYYYMMDD')) as YourDate 
```

# php - 解析错误：语法错误，第 102 行 /srv/disk7/1259829/www/k00138899.atspace.eu/photoalbum/upload_file.php 中的意外 T_STRING

> ID：15535261
> 
> 赞同：0
> 
> 时间：2013-03-20T21:39:04.907
> 
> 标签：php, string, image

我正在使用 HTML 代码将图像上传到“上传”文件夹，这是我使用的教程 [http://www.w3schools.com/php/php_file_upload.asp](http://www.w3schools.com/php/php_file_upload.asp) 我想添加额外的功能，因为我想显示该文件夹中的图像连同描述，所以我的计划是将地址存储到像[http://k00138899.atspace.eu/photoalbum/upload/](http://k00138899.atspace.eu/photoalbum/upload/) $filename.$extension这样的文件中入数据库。（只是将图像上传到文件夹）

这就是完整的 php 代码
http://justpaste.it/phpcodephpcode

这只是我的额外部分

```
 <?php

$host=""; // Host name
$username=""; // Mysql username
$password=""; // Mysql password
$db_name=""; // Database name
$tbl_name="photo"; // Table name
  $imagestring = $_FILES["file"]["name"];
  $filetype = $_FILES["file"]["type"];
  mysql_connect("$host", "$username", "$password")or die("cannot connect");
  mysql_select_db("$db_name")or die("cannot select DB");
  $sql="INSERT INTO $tbl_name (PhotoString) VALUES ("http://www.atspace.com/photoalbum/upload/'$imagestring'.'$filetype'")";
  $result=mysql_query($sql);
  ?> 
```

我收到此错误：
http://k00138899.atspace.eu/photoalbum/upload_file.php

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:50:36.710

换行

`$sql="INSERT INTO $tbl_name (PhotoString) VALUES ("http://www.atspace.com/photoalbum/upload/'$imagestring'.'$filetype'")";`

为了

`$sql='INSERT INTO '.$tbl_name.' (PhotoString) VALUES ("http://www.atspace.com/photoalbum/upload/'.$imagestring.'.'.$filetype.'")';`

# c# - 所有表单的 C# 全局变量

> ID：15535263
> 
> 赞同：0
> 
> 时间：2013-03-20T21:39:21.377
> 
> 标签：c#, visual-studio-2010, global-variables

我是一名新手程序员，现在正在使用 Visual Studio 2010 和许多表单在 C# 上开发应用程序，所以我很感兴趣是否可以设置一些全局变量以在所有表​​单中使用它们？简单的例子，我有 10 个表单，它们都连接到 MySQL 数据库，所以设置 10 次数据库名称和密码并不是很聪明，理想情况下我可以设置一次然后到处使用，我找不到答案在谷歌这个问题，所以也许有人可以在这里帮助我？是否可以？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T21:41:17.987

为您的表单创建一个基类，它继承自`Form`. 在那里初始化共享值，以便继承表单可以访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:43:00.430

有几种方法可以解决这个问题。

*   首先，您可以使用设置。
*   其次，您可以使用 web.config （不确定这是否适用于表单）
*   第三种选择是创建一个包含变量的静态类。

# ajax - ASP.NET MVC - AJAX 回发与完整回发

> ID：15535266
> 
> 赞同：-1
> 
> 时间：2013-03-20T21:39:23.530
> 
> 标签：ajax, asp.net-mvc

为什么不总是使用 AJAX 回发而不是完整的回发并通过 JSON 传递模型，因为 AJAX 回发总是更快？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:42:55.200

在大多数情况下，复杂性。AJAX 页面更复杂，并且有更多的怪癖和障碍需要跳过。许多人只是不想处理它。

此外，Ajax 并不总是更快。这真的取决于。

# symfony - 即使实体1和实体2被映射，提交表单数据到实体1和实体2_id列也是空的

> ID：15535267
> 
> 赞同：2
> 
> 时间：2013-03-20T21:39:26.317
> 
> 标签：symfony, symfony-forms

我有两个设置为相互映射的实体（Plan 和 PricingTier）。PricingTier 设置为 oneToMany，Plan 设置为 manyToOne。映射列在计划实体中；计划数据库表有一个pricing_tier_id 列，将两个表/实体链接在一起。

我有一个创建新计划的表格。表单在 Twig 文件中正确生成，并在发布时 $request->request->getAll(); 返回已发布值的数组。在数组中，我可以看到 priceTierId 已明确设置为我选择的定价层的 id。当我执行以下操作时：

```
$form->bind($request);
$newPlan = $form->getData();
$em = $this->getDoctrine()->getEntityManager();
$em->perist($newPlan);
$em->flush(); 
```

我得到一个抛出的异常，说pricing_tier_id 不能为NULL。我对 $newPlan 变量做了一个 var_dump() ，它看起来返回一个对象，包括映射定价层的对象。

谁能建议我为什么会收到此错误的解决方案？相关代码和错误如下。

**计划控制器.php**

```
namespace etrak\CustomerServiceBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use etrak\OnlineOrderProcessingBundle\Entity\Plan;
use etrak\OnlineOrderProcessingBundle\Entity\PricingTier;
use etrak\CustomerServiceBundle\Form\Type\PlanType;
use Symfony\Component\HttpFoundation\Request;

class PlanController extends Controller
{
    public function indexAction($name)
    {
        return $this->render('etrakCustomerServiceBundle:Default:index.html.twig', array('name' => $name));
    }

    public function addPlanAction(Request $request)
    {
        // Set up a new Plan object
        $plan = new Plan();

        $form = $this->createForm(new PlanType(), $plan);

        // Check to see if the form has been submitted
        if ($request->isMethod('POST')) {
            $form->bind($request);
            var_dump($request->request->all()); die();
            // Validate the form
            if ($form->isValid()) {
                $newPlan = $form->getData();
//var_dump($newPlan->getPricingTierId()); die();
                $em = $this->getDoctrine()->getEntityManager();
                $em->persist($newPlan);
                $em->flush();
            }
        }

        return $this->render('etrakCustomerServiceBundle:Plan:new.html.twig', array("form" => $form->createView()));
    }
} 
```

**计划类型.php**

```
namespace etrak\CustomerServiceBundle\Form\Type;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;

class PlanType extends AbstractType
{
    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults(array(
            'data_class' => 'etrak\OnlineOrderProcessingBundle\Entity\Plan',
            'cascade_validation' => true,
        ));

    }

    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $termsConditionsArray = array("1 Year Contract" => "1 Year Contract", "2 Year Contract" => "2 Year Contract");
        $billingFrequencyArray = array("1" => "Monthly", "6" => "6 Months", "12" => "Yearly");

        // Create the form
        $builder->add('name', 'text', array('label' => 'Plan Name: ', 'required' => false));
        $builder->add('description', 'text', array('label' => 'Plan Description: '));
        $builder->add('termsConditions', 'choice', array('choices' =>                 $termsConditionsArray, 'label' => 'Terms & Conditions'));
        $builder->add('amount', 'text', array('label' => 'Plan Price: '));
        $builder->add('affinity', 'choice', array('choices' => array('0' => 'Yes', '1' => 'No'), 'label' => 'Affinity? ', 'expanded' => true));
        $builder->add('deactivationFee', 'text', array('label' => "Deactivation Fee: "));
        $builder->add('recurringInMonths', 'choice', array('choices' => $billingFrequencyArray, 'label' => 'Billing Frequency: '));
        $builder->add('pricingTierId', 'entity', array(
        'class' => 'etrakOnlineOrderProcessingBundle:pricingTier',
        'property' => 'name',
        'label' => "Select Pricing Tier: "
    ));
        $builder->add('activeStartDate', 'datetime', array('label' => "Effective Start Date: "));
        $builder->add('activeEndDate', 'datetime', array('label' => "Effective End Date: "));
    }

    public function getName()
    {
        return 'plan';
    }
} 
```

**Plan.php** 命名空间 etrak\OnlineOrderProcessingBundle\Entity；

```
use Doctrine\ORM\Mapping as ORM;

/**
 * Plan
 */
class Plan
{
    /**
     * @var integer
     */
    private $id;

    /**
     * @var string
     */
    private $name;

    /**
     * @var string
     */
    private $description;

    /**
     * @var string
     */
    private $termsConditions;

    /**
     * @var boolean
     */
    private $active;

    /**
     * @var decimal
     */
    private $amount;

    /**
     * @var boolean
     */
    private $affinity;

    /**
     * @var integer
     */
    private $deactivationFee;

    /**
     * @var integer
     */
    private $gracePeriodDays;

    /**
     * @var integer
     */
    private $recurringInMonths;

    /**
     * @var integer
     */
    private $pricingTierId;

    /**
     * @var date
     */
    private $activeStartDate;

    /**
     * @var date
     */
    private $activeEndDate;

    /**
     * @var \etrak\OnlineOrderProcessingBundle\Entity\PricingTier
     */
    private $pricingTier;

    /**
     * Set pricingTier
     *
     * @param \etrak\OnlineOrderProcessingBundle\Entity\PricingTier $pricingTier
     * @return Plan
     */
    public function setPricingTier(\etrak\OnlineOrderProcessingBundle\Entity\PricingTier $pricingTier = null)
    {
        $this->pricingTier = $pricingTier;

        return $this;
    }

    /**
     * Get pricingTier
     *
     * @return \etrak\OnlineOrderProcessingBundle\Entity\PricingTier 
     */
    public function getPricingTier()
    {
        return $this->pricingTier;
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set name
     *
     * @param string $name
     * @return Plan
     */
    public function setName($name)
    {
        $this->name = $name;

        return $this;
    }

    /**
     * Get name
     *
     * @return string 
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     * Set description
     *
     * @param string $description
     * @return Plan
     */
    public function setDescription($description)
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Get description
     *
     * @return string 
     */
    public function getDescription()
    {
        return $this->description;
    }

    /**
     * Set termsConditions
     *
     * @param string $termsConditions
     * @return Plan
     */
    public function setTermsConditions($termsConditions)
    {
        $this->termsConditions = $termsConditions;

        return $this;
    }

    /**
     * Get termsConditions
     *
     * @return string 
     */
    public function getTermsConditions()
    {
        return $this->termsConditions;
    }

    /**
     * Set active
     *
     * @param boolean $active
     * @return Plan
     */
    public function setActive($active)
    {
        $this->active = $active;

        return $this;
    }

    /**
     * Get active
     *
     * @return boolean 
     */
    public function getActive()
    {
        return $this->active;
    }

    /**
     * Set amount
     *
     * @param decimal $amount
     * @return Plan
     */
    public function setAmount($amount)
    {
        $this->amount = $amount;

        return $this;
    }

    /**
     * Get amount
     *
     * @return decimal 
     */
    public function getAmount()
    {
        return $this->amount;
    }

    /**
     * Set affinity
     *
     * @param boolean $affinity
     * @return Plan
     */
    public function setAffinity($affinity)
    {
        $this->affinity = $affinity;

        return $this;
    }

    /**
     * Get affinity
     *
     * @return boolean 
     */
    public function getAffinity()
    {
        return $this->affinity;
    }

    /**
     * Set deactivationFee
     *
     * @param integer $deactivationFee
     * @return Plan
     */
    public function setDeactivationFee($deactivationFee)
    {
        $this->deactivationFee = $deactivationFee;

        return $this;
    }

    /**
     * Get deactivationFee
     *
     * @return integer 
     */
    public function getDeactivationFee()
    {
        return $this->deactivationFee;
    }

    /**
     * Set gracePeriodDays
     *
     * @param integer $gracePeriodDays
     * @return Plan
     */
    public function setGracePeriodDays($gracePeriodDays)
    {
        $this->gracePeriodDays = $gracePeriodDays;

        return $this;
    }

    /**
     * Get gracePeriodDays
     *
     * @return integer 
     */
    public function getGracePeriodDays()
    {
        return $this->gracePeriodDays;
    }

    /**
     * Set recurringInMonths
     *
     * @param integer $recurringInMonths
     * @return Plan
     */
    public function setRecurringInMonths($recurringInMonths)
    {
        $this->recurringInMonths = $recurringInMonths;

        return $this;
    }

    /**
     * Get recurringInMonths
     *
     * @return integer 
     */
    public function getRecurringInMonths()
    {
        return $this->recurringInMonths;
    }

    /**
     * Set pricingTierId
     *
     * @param integer $pricingTierId
     * @return Plan
     */
    public function setPricingTierId($pricingTierId)
    {
        $this->pricingTierId = $pricingTierId;

        return $this;
    }

    /**
     * Get pricingTierId
     *
     * @return integer 
     */
    public function getPricingTierId()
    {
        return $this->pricingTierId;
    }

    /**
     * Set activeStartDate
     *
     * @param \DateTime $activeStartDate
     * @return Plan
     */
    public function setActiveStartDate($activeStartDate)
    {
        $this->activeStartDate = $activeStartDate;

        return $this;
    }

    /**
     * Get activeStartDate
     *
     * @return \DateTime 
     */
    public function getActiveStartDate()
    {
        return $this->activeStartDate;
    }

    /**
     * Set activeEndDate
     *
     * @param \DateTime $activeEndDate
     * @return Plan
     */
    public function setActiveEndDate($activeEndDate)
    {
        $this->activeEndDate = $activeEndDate;

        return $this;
    }

    /**
     * Get activeEndDate
     *
     * @return \DateTime 
     */
    public function getActiveEndDate()
    {
        return $this->activeEndDate;
    }

    /**
     * 
     */
    public function prePersist()
    {
        if (!isset($this->affinity)) {
            $this->setAffinity(0);
        }

        if (!isset($this->active)) {
            $this->setActive(1);
        }
    }
} 
```

**计划.orm.yml**

```
#etrak/OnlineOrderProcessingBundle/Resources/config/doctrine/Entity/Plan.orm.yml
etrak\OnlineOrderProcessingBundle\Entity\Plan:
  type: entity
  table: plans
  id:
    id:
      type: integer
      generator: { strategy: AUTO }
  fields:
    name:
      type: string
      length: 255
      nullable: true
    description:
      type: text
      nullable: true
    termsConditions:
      column: terms_conditions
      type: text
      nullable: true
    active:
      type: boolean
      nullable: true
    amount:
      type: decimal
      nullable: true
      scale: 2
      precision: 5
    affinity:
      type: boolean
      nullable: true
    deactivationFee:
      column: deactivation_fee
      type: decimal
      scale: 2
      precision: 5
      nullable: true
    gracePeriodDays:
      column: grace_period_days
      type: integer
      nullable: true
    recurringInMonths:
      column: recurring_in_months
      type: integer
      nullable: true
    pricingTierId:
      column: pricing_tier_id
      type: integer
    activeStartDate:
      column: active_start_date
      type: date
    activeEndDate:
      column: active_end_date
      type: date
  lifecycleCallbacks:
    prePersist: [ prePersist ]
  manyToOne:
    pricingTier:
      targetEntity: PricingTier
      inversedBy: plans
      joinColumn:
        name: pricing_tier_id
        referencedColumnName: id 
```

**定价层.php**

```
namespace etrak\OnlineOrderProcessingBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * PricingTier
 */
class PricingTier
{

    /**
     * @var integer
     */
    private $id;

    /**
     * @var integer
     */
    private $productId;

    /**
     * @var string
     */
    private $name;

    /**
     * @var string
     */
    private $description;

    /**
     * @var integer
     */
    private $minimumDevices;

    /**
     * @var boolean
     */
    private $isAffinity;

    /**
     * @var string
     */
    private $keyname;

    /**
     * @var string
     */
    private $createdBy;

    /**
     * @var datetime
     */
    private $createdOn;

    /**
     * @var datetime
     */
    private $updatedOn;

    /**
     * Set productId
     *
     * @param integer $productId
     * @return PricingTier
     */
    public function setProductId($productId)
    {
        $this->productId = $productId;

        return $this;
    }

    /**
     * Get productId
     *
     * @return integer 
     */
    public function getProductId()
    {
        return $this->productId;
    }

    /**
     * @var \Doctrine\Common\Collections\Collection
     */
    private $plans;

    /**
     * Constructor
     */
    public function __construct()
    {
        $this->plans = new \Doctrine\Common\Collections\ArrayCollection();
    }

    /**
     * Add plans
     *
     * @param \etrak\OnlineOrderProcessingBundle\Entity\Plan $plans
     * @return PricingTier
     */
    public function addPlan(\etrak\OnlineOrderProcessingBundle\Entity\Plan $plans)
    {
        $this->plans[] = $plans;

        return $this;
    }

    /**
     * Remove plans
     *
     * @param \etrak\OnlineOrderProcessingBundle\Entity\Plan $plans
     */
    public function removePlan(\etrak\OnlineOrderProcessingBundle\Entity\Plan $plans)
    {
        $this->plans->removeElement($plans);
    }

    /**
     * Get plans
     *
     * @return \Doctrine\Common\Collections\Collection 
     */
    public function getPlans()
    {
        return $this->plans;
    }

    /**
     * Set name
     *
     * @param string $name
     * @return PricingTier
     */
    public function setName($name)
    {
        $this->name = $name;

        return $this;
    }

    /**
     * Get name
     *
     * @return string 
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     * Set description
     *
     * @param string $description
     * @return PricingTier
     */
    public function setDescription($description)
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Get description
     *
     * @return string 
     */
    public function getDescription()
    {
        return $this->description;
    }

    /**
     * Set minimumDevices
     *
     * @param integer $minimumDevices
     * @return PricingTier
     */
    public function setMinimumDevices($minimumDevices)
    {
        $this->minimumDevices = $minimumDevices;

        return $this;
    }

    /**
     * Get minimumDevices
     *
     * @return integer 
     */
    public function getMinimumDevices()
    {
        return $this->minimumDevices;
    }

    /**
     * Set isAffinity
     *
     * @param boolean $isAffinity
     * @return PricingTier
     */
    public function setIsAffinity($isAffinity)
    {
        $this->isAffinity = $isAffinity;

        return $this;
    }

    /**
     * Get isAffinity
     *
     * @return boolean 
     */
    public function getIsAffinity()
    {
        return $this->isAffinity;
    }

    /**
     * Set keyname
     *
     * @param string $keyname
     * @return PricingTier
     */
    public function setKeyname($keyname)
    {
        $this->keyname = $keyname;

        return $this;
    }

    /**
     * Get keyname
     *
     * @return string 
     */
    public function getKeyname()
    {
        return $this->keyname;
    }

    /**
     * Set createdBy
     *
     * @param string $createdBy
     * @return PricingTier
     */
    public function setCreatedBy($createdBy)
    {
        $this->createdBy = $createdBy;

        return $this;
    }

    /**
     * Get createdBy
     *
     * @return string 
     */
    public function getCreatedBy()
    {
        return $this->createdBy;
    }

    /**
     * Set createdOn
     *
     * @param \DateTime $createdOn
     * @return PricingTier
     */
    public function setCreatedOn($createdOn)
    {
        $this->createdOn = $createdOn;

        return $this;
    }

    /**
     * Get createdOn
     *
     * @return \DateTime 
     */
    public function getCreatedOn()
    {
        return $this->createdOn;
    }

    /**
     * Set updatedOn
     *
     * @param \DateTime $updatedOn
     * @return PricingTier
     */
    public function setUpdatedOn($updatedOn)
    {
        $this->updatedOn = $updatedOn;

        return $this;
    }

    /**
     * Get updatedOn
     *
     * @return \DateTime 
     */
    public function getUpdatedOn()
    {
        return $this->updatedOn;
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * @ORM\PrePersist
     */
    public function onPrePersist()
    {
        if (!isset($this->isAffinity)) {
            $this->setIsAffinity(0);
        }
        $this->setCreatedOn(new \DateTime());
    }

    /**
     * @ORM\PreUpdate
     */
    public function onPreUpdate()
    {
        $this->setUpdatedOn(new \DateTime());
    }
} 
```

**定价层.orm.yml**

```
#etrak/OnlineOrderProcessingBundle/Resources/config/doctrine/Entity/PricingTier.orm.yml
etrak\OnlineOrderProcessingBundle\Entity\PricingTier:
  type: entity
  table: pricing_tiers
  id:
    id:
      type: integer
      generator: { strategy: AUTO }
  fields:
    productId:
      column: product_id
      type: integer
    name:
      type: string
      length: 50
    description:
      type: string
      length: 100
      nullable: true
    minimumDevices:
      column: minimum_devices
      type: integer
    isAffinity:
      column: is_affinity
      type: boolean
    keyname:
      type: string
      length: 55
    createdBy:
      column: created_by
      type: string
      length: 20
    createdOn:
      column: created_on
      type: datetime
    updatedOn:
      column: updated_on
      type: datetime
      nullable: true
  lifecycleCallbacks:
    prePersist: [ onPrePersist ]
    preUpdate: [ onPreUpdate ]
  oneToMany:
    plans:
      targetEntity: Plan
      mappedBy: pricingTier 
```

这应该是与此相关的所有文件。我没有包含 Twig 文件，因为它只是呈现由 PlanController 中的 createView() 魔术方法生成的表单的一行。

先谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:49:28.333

在您的 Plan.orm.yml 中：

```
pricingTierId:
      column: pricing_tier_id
      type: integer 
```

这是与您的多对一连接相同的列名。这可能是一个不好的做法。这未设置为 nullable: true，并且可能是您的问题的根源。明确地，您不需要此字段。同样在您的表单中，您正在加载pricingTierId 的实体类，它不是一个实体，我认为symfony 对此感到非常困惑。

```
 $builder->add('pricingTierId', 'entity', array(             // add pricingTier
    'class' => 'etrakOnlineOrderProcessingBundle:pricingTier',  // not pricingTierId
    'property' => 'name',
    'label' => "Select Pricing Tier: "
    )); 
```

我希望如果您删除有问题的 yaml 部分并调整表单类型，您的问题就会消失。

# php - PHP回显一个显示空白屏幕的变量

> ID：15535269
> 
> 赞同：0
> 
> 时间：2013-03-20T21:39:28.697
> 
> 标签：php, mysql

所以我有以下PHP代码

```
<?php 

error_reporting(E_ALL & ~E_NOTICE);
ini_set('display_errors', TRUE);
ini_set('display_startup_errors', TRUE);

    $poscote = $_POST['postcode'];

    mysql_real_escape_string($poscote);

    //! Checks for direct access to page

    if (empty($_POST)) {
        header('location:index.php?nothingentered');
        die();
    }

    require_once('../Connections/PropSuite.php'); 

    mysql_select_db($database_Takeaway, $Takeaway);
    $query_PC = "SELECT * FROM Postcodes WHERE pc = '$postcode'";
    $PC = mysql_query($query_PC, $Takeaway) or die(mysql_error());
    $row_PC = mysql_fetch_assoc($PC);

    if( mysql_errno() != 0){
     // mysql error
     // note: message like this should never appear to user, should be only stored in log
     echo "Mysql error: " . htmlspecialchars( mysql_error());
     die();
     }

    else {

    echo $row_PC['oc'];

    }

?> 
```

这是使用以下代码处理表单

```
<form action="search_postcode.php" method="post">
        <input type="text" name="postcode" />
        <button>Go</button>
    </form> 
```

奇怪的是它只是显示一个空白屏幕，没有错误，我没有检查过任何东西，似乎无法找到解决方案。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:46:53.763

除了其他答案之外，并且没有提及您应该使用`PDO`or `mysqli`，您可能遇到了字符编码问题。尝试做这样的事情：

```
define('DB_CHARSET', 'ISO-8859-1');
define('REPLACE_FLAGS', ENT_COMPAT | ENT_XHTML);

...

echo "Mysql error: " .  htmlentities(mysql_error(), REPLACE_FLAGS, DB_CHARSET); 
```

`DB_CHARSET`用您的数据库使用的任何编码替换 的值。如果您尝试使用`htmlentities()`无效字符，它将产生一个空字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:44:46.670

由于您的`$postcode`变量未定义，因此您正在数据库中查找`pc`错误消息所在的行。

该查询可以很好地完成而没有错误，但它可能会产生 0 行，因此您没有错误，也没有结果。在这种情况下，您什么也不输出，因此您将看到一个空白屏幕。

你可能想要：

```
$postcode = mysql_real_escape_string($poscote); 
```

代替：

```
mysql_real_escape_string($poscote); 
```

并将其放在数据库连接部分下方。

此外，您应该切换到 PDO（或 mysqli）和准备好的语句以避免 sql 注入问题，因为这些`mysql_*`函数已被弃用。请注意，`mysql_real_escape_string`当您没有打开数据库连接时，您不会做任何事情（除了删除变量的内容......）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:45:12.617

从 php.net 开始，要使用 启用 php 错误`ini_set`，您必须这样做

```
ini_set('display_errors', '1') 
```

这是取自此[链接](http://php.net/manual/en/function.ini-set.php)

# mysql - 替换表 sql 中的字符串

> ID：15535271
> 
> 赞同：0
> 
> 时间：2013-03-20T21:39:39.587
> 
> 标签：mysql, concat

我遇到了一些关于用一些要求替换 mysql 表中的字符串的问题。你可以看到我当前的表：

```
+----+------------------------+  
| id | data                   |  
+----+------------------------+  
|  1 | [text1]mytext1[/text1] |
|    | [text2]mytext2[/text2] |
|    | [text3]mytext3[/text3] |
|    | [text4]mytext4[/text4] |
+----+------------------------+ 
```

然后我需要更改`[text3]mytext3[/text3]`为`[text3]mytext5[/text3]`

问题是：

1.  我怎样才能找到字符串 [textX] 和 [/textX] ？
2.  如何替换 [textX] 和 [/textX] 之间的内容？

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:45:54.780

使用 LIKE 查找匹配项，然后使用 REPLACE 进行更改：

```
update mytable set
data = replace(data, 'mytext3', 'mytext5')
where data like '[text%]mytext3[/text%]' 
```

# html - 有没有办法指定嵌入式要点的宽度？

> ID：15535272
> 
> 赞同：2
> 
> 时间：2013-03-20T21:39:45.310
> 
> 标签：html, github, gist

我正在尝试将要点嵌入网页。以下面的要点为例：

```
<script src="https://gist.github.com/Astr0surf3r/5208714.js"></script> 
```

我想知道是否有办法设置要点的宽度。例如，我想让 gist 比默认宽度窄。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T21:50:23.480

您可以通过修改此 gist 使用的 CSS 类来控制宽度。

```
.gist { width: 250px; } 
```

示例：http: [//jsfiddle.net/aFwEd/](http://jsfiddle.net/aFwEd/)

# mysql - 选择具有仅当另一列具有特定值时才存在的列值的行

> ID：15535273
> 
> 赞同：1
> 
> 时间：2013-03-20T21:39:44.943
> 
> 标签：mysql, sql

请考虑以下 MySQL 表

```
|----+--------+----------|
| id | result |reference | 
|----+--------+----------|
|  1 |ok      |       33 |
|  2 |ok      |       46 | 
|  3 |ko      |       55 |  
|  4 |ko      |       55 |  
|  5 |ok      |       55 |  
|  6 |ko      |       47 | 
|  7 |ko      |       89 |  
|  8 |ok      |       91 | 
|  9 |ko      |       47 |  
+----+--------+----------+ 
```

我想选择结果 = ko 和引用 = 47 的行，因为引用 47 在结果 = ok 的任何行中都不存在。除此之外，我只想要这一行一次，因为这种情况发生了两次（id=6 和 id=9），尽管它可能发生一次。实际上，在我要查询的查询中，id=89 的行也应该出现，如 reference = 89、result = ko 并且没有其他行的 reference = 89 和 result = ok。非常感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:47:26.117

您可以使用[不存在的子查询](http://dev.mysql.com/doc/refman/4.1/en/exists-and-not-exists-subqueries.html)：

```
SELECT DISTINCT result, reference 
FROM [dbo].[references] as x
WHERE NOT EXISTS 
(SELECT * FROM [dbo].[references] as y
 WHERE
 y.reference = x.reference
 and
 y.result = 'ok'); 
```

您也可以使用 self left join 来做到这一点：

```
SELECT DISTINCT x.result, x.reference 
FROM [dbo].[references] as x
LEFT JOIN
[dbo].[references] as y 
on x.reference = y.reference
and y.result = 'ok'
WHERE
y.reference IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:45:11.617

使用条件句，效果如下：

```
IF EXISTS (Select TOP 1 * from <thistable>
WHERE result='OK' AND reference=47)
SELECT Select TOP 1 * from <thistable>
WHERE result='OK' AND reference=47
ELSE
SELECT Select TOP 1 * from <thistable>
WHERE result='KO' AND reference=47
END 
```

# php - PHP：如何为 SplFileObject 启用压缩？

> ID：15535277
> 
> 赞同：1
> 
> 时间：2013-03-20T21:39:55.800
> 
> 标签：php, csv, gzip, spl

我正在使用 SPLFile 类创建一个 CSV 文件：

```
$z=new SplFileObject('/tmp/test.csv.gz','w');
$arr=[['a','b','c'],[1,2,3],[2,4,8],[3,6,9]];
foreach($arr as $f) $z->fputcsv($f); 
```

有没有办法 gz 压缩我的输出？

谢谢

通用汽车

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T00:39:53.667

您可以使用[包装器](http://www.php.net/manual/en/wrappers.php)。在这种情况下，您可以使用[zlib](http://www.php.net/manual/en/wrappers.compression.php)。

```
$z=new SplFileObject('compress.zlib:///tmp/test.csv.gz','w');
$arr=[['a','b','c'],[1,2,3],[2,4,8],[3,6,9]];
foreach($arr as $f) $z->fputcsv($f); 
```

# tfs - 如何彻底删除 TFS 备份计划

> ID：15535279
> 
> 赞同：2
> 
> 时间：2013-03-20T21:40:00.407
> 
> 标签：tfs

TFS 备份计划已损坏。当我尝试重新创建备份计划时，我得到“对象引用未设置为对象的实例”。如何完全删除备份计划并从头开始？我正在使用带有电动工具的 TFS 2010。

# ruby-on-rails - Rails 3 中的名称错误

> ID：15535289
> 
> 赞同：2
> 
> 时间：2013-03-20T21:40:30.877
> 
> 标签：ruby-on-rails, gem, nameerror, uninitialized-constant

因此，我正在尝试使用 Public Activity gem 作为通知时间线，但我不明白为什么会收到 NameError ，即未初始化的常量消息。这是我得到的错误：

```
NameError in ActivitiesController#index
uninitialized constant ActivitiesController::PublicActivity

app/controllers/activities_controller.rb:3:in `index' 
```

未初始化的常量ActivitiesController::PublicActivity

这是我的控制器代码，据说错误是：

```
 class ActivitiesController < ApplicationController
      def index
       @activities = PublicActivity::Activity.order("created_at desc")
      end
     end 
```

我正在尝试基于 Rails 演员：[http](http://railscasts.com/episodes/406-public-activity) ://railscasts.com/episodes/406-public-activity 据我所知，我已经做了与上面相同的事情。

没有任何活动模型，但这是我使用 PublicActivity 模块的帖子和评论模型：

后模型：

```
class Post < ActiveRecord::Base
  include PublicActivity::Model
  tracked 
```

评论模型

```
class Comment < ActiveRecord::Base
    include PublicActivity::Model
tracked

belongs_to :post
belongs_to :user
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:00:28.780

根据宝石来源

```
 def load_orm
      require "public_activity/orm/#{@@orm.to_s}"
      m = "PublicActivity::ORM::#{@@orm.to_s.classify}".constantize
      ::PublicActivity.const_set(:Activity,  m.const_get(:Activity))
      ::PublicActivity.const_set(:Adapter,   m.const_get(:Adapter))
      ::PublicActivity.const_set(:Activist,  m.const_get(:Activist))
      ::PublicActivity.const_set(:Trackable, m.const_get(:Trackable))
    end 
```

您应该使用下一个代码

```
 @activities = ::PublicActivity::Activity.order("created_at desc") 
```

还要确保您使用 bundle 安装了 gem，检查`bundle show public_activity`

# django - Django缓存获取过期条目

> ID：15535291
> 
> 赞同：1
> 
> 时间：2013-03-20T21:40:37.117
> 
> 标签：django, caching, get

在我看来，我有以下几点

```
@require_POST
def loadVals(request):
  result = //do some heavy calculations
  return HttpResponse(json.dumps({"data": result}), content_type="application/json") 
```

现在我添加了一个缓存，这样我就不必一直执行“繁重的计算”。所以新代码看起来像

设置.py

```
CACHES = {
'default': {
    'BACKEND': 'django.core.cache.backends.locmem.LocMemCache',
    'LOCATION': 'unique-snowflake'
} 
```

}

视图.py

```
from django.core.cache import get_cache

@require_POST
def loadVals(request):
  cache = get_cache('default')
  result = cache.get('res')
  if result == NONE:
    result = //do some heavy calculations
    cache.set('res', result, 30)
    return HttpResponse(json.dumps({"data": result}), content_type="application/json")
  else:
    return HttpResponse(json.dumps({"data": result}), content_type="application/json") 
```

相反，我想做的是，即使该缓存已过期，我也想为前端用户节省一些等待时间（因为计算量大），然后只返回最后一个过期值。然后刷新缓存。

我如何能

1）获取过期缓存的值？因为如果缓存过期，cache.get('res') 返回 NONE

2）在 return HttpResponse 语句之后进行调用以刷新缓存值并进行大量计算（其中 return statmenet 刚刚返回过期值）或者可以通过异步调用来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T15:08:18.460

首先，您的代码存在一些语法问题。其次，您无法从 django 缓存中获取过期值。过期的值一旦过期就会被删除，在它们不再存在之后。

如果您想在这种情况下将过期值存储更长时间，您需要将它们存储在更持久的存储（如数据库）中，缓存不是为此而设计的。

或者，您可以将结果缓存两次，其中一个较长，并从第二个缓存中提供服务：

```
from django.core.cache import get_cache

@require_POST
def loadVals(request):
    cache = get_cache('default')
    result = cache.get('res') or cache.get('res_long')
    if result is None:
        result = //do some heavy calculations
        cache.set('res', result, 30)
        cache.set('res_long', result, 60*60*24*7) # cache for a week
    return HttpResponse(json.dumps({"data": result}), content_type="application/json") 
```

这仍然不是一个好方法，因为您仍然需要做一些事情来重新缓存短缓存。这也不是很好，因为您的缓存后端使用双倍数据超载。

如果您希望您的用户始终获得缓存的内容，请尝试使用[Celery](http://docs.celeryproject.org/en/latest/django/index.html)将其与后台任务一起缓存。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-21T17:21:34.423

Here is what worked for me:

1) create a global variable, and when you set the cache, set this global variable too. if the cache has expired, your global variable is still around with expired values, so send that in response. and use threading to update the cache and global variable.

2) use python threading

```
import  threading
def loadVals():
    threading.Thread(group=None, target=methodToDoheavyCalculations).start()
    # return the expired cache in the meanwhile
    return HttpResponse(json.dumps(EXPIRED_VALUES), content_type="application/json") 
```

# ruby-on-rails - 根据内部数据计数过滤结果

> ID：15535292
> 
> 赞同：0
> 
> 时间：2013-03-20T21:40:41.477
> 
> 标签：ruby-on-rails, elasticsearch, tire

我正在为一些列表数据构建搜索查询。作为搜索的一部分，人们可以要求多个能睡最少人数的房间，即两个能睡 2 人和 3 人的房间。

我不确定如何使用过滤器执行此操作。

到目前为止，这是一个缩短的搜索查询。

```
 {
  "query":{
    "filtered":{
      "query":{
        "match_all":{}
      }
    }
  },
  "filter":{
    "and":
      [
        {
          "term":{
          "status":"live"
          }
        },
        {
          "geo_bounding_box":{
            "location":{
              "top_left":"60.856553, -8.64935719999994",
              "bottom_right":"49.8669688, 1.76270959999999"
              }
            }
          }
        ,{
        "range":{
          "bedrooms":{
            "gte":"2"
            }
          }
        }
      ]
    }
  ,
  "size":10
} 
```

## 测试数据

```
{
       "took":1,
       "timed_out":false,
       "_shards":{
          "total":5,
          "successful":5,
          "failed":0
       },
       "hits":{
          "total":3,
          "max_score":1.0,
          "hits":[
             {
                "_index":"listings",
                "_type":"listing",
                "_id":"1",
                "_score":1.0,
                "_source":{
                   "name:":"Listing One",
                   "address1":"Some Street",
                   "bedrooms":2,
                   "city":"A City",
                   "id":1,
                   "refno":"FI451",
                   "user_id":1,
                   "rooms":[
                      {
                         "bathroom":"Shared bathroom with bath",
                         "double_standard":null,
                         "id":5,
                         "single":2,
                         "sleeps":2,
                         "title":"Twinny",
                      },
                      {
                         "bathroom":"Ensuite with bath",
                         "double_king_size":1,
                         "double_standard":1,
                         "id":1,
                         "single":null,
                         "sleeps":2,
                         "title":"Double Ensuite Room",
                      }
                   ]
                }
             },
             {
                "_index":"listings",
                "_type":"listing",
                "_id":"2",
                "_score":1.0,
                "_source":{
                   "name":"Listing Two",
                   "address1":"Some Street",
                   "bedrooms":2,
                   "city":"A City",
                   "id":2,
                   "refno":"BL932",
                   "user_id":1,
                   "rooms":[
                      {
                         "bathroom":"Ensuite with bath",
                         "double_standard":1,
                         "id":4,
                         "single":1,
                         "sleeps":3,
                         "title":"Family Room",
                      },
                      {
                         "bathroom":"Ensuite with shower",
                         "double_standard":1,
                         "id":2,
                         "single":null,
                         "sleeps":2,
                         "title":"Single Room",
                      }
                   ]
                }
             },
             {
                "_index":"listings",
                "_type":"listing",
                "_id":"3",
                "_score":1.0,
                "_source":{
                   "name":"Listing Three",
                   "address1":"Another Address",
                   "bedrooms":1,
                   "city":"Your City",
                   "id":3,
                   "refno":"TE2116",
                   "user_id":1,
                   "rooms":[
                      {
                         "bathroom":"Ensuite with shower",
                         "double_king_size":null,
                         "double_standard":1,
                         "id":3,
                         "single":1,
                         "sleeps":3,
                         "title":"Family Room",
                      }
                   ]
                }
             }
          ]
       }
    } 
```

如果您查看我的数据，我有 3 个房源，其中两个有多个房间（房源一和二），但只有房源二会匹配我的搜索，原因是它有一个房间睡两个，另一个睡三个。

是否可以使用 elasticsearch 执行此查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:08:36.170

如果您想要的是“*查找一间卧室睡 2 人且另一间卧室睡 3 人的所有房源*”，则此查询将起作用。它做了一个很大的假设：您使用的是内部对象，而不是嵌套数据类型。

此查询使用内部对象折叠到单个字段中的事实，导致“rooms.sleeps”等于所需字段的 [2,3]。由于该字段被折叠成一个数组，一个简单的`Terms`查询将匹配它们。当您将执行模式更改为 And 时，它会强制匹配 2 和 3。

需要注意的是，具有 [2,3,4] 的房间也将被匹配。

*我省略了地理和状态部分，因为源文档中没有提供该数据。*

```
{
  "query": {
    "filtered": {
      "query": {
        "match_all": {}
      }
    }
  },
  "filter": {
    "and": [
      {
        "range": {
          "bedrooms": {
            "gte": "2"
          }
        }
      },
      {
        "terms": {
          "rooms.sleeps": [2,3],
          "execution": "and"
        }
      }
    ]
  },
  "size": 10
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T02:08:29.060

据我所知，`filter`必须是元素`query`内部的兄弟。`filtered`请参阅： [http ://www.elasticsearch.org/guide/reference/query-dsl/filtered-query/](http://www.elasticsearch.org/guide/reference/query-dsl/filtered-query/)

如果你将它与 Zach 的解决方案结合起来，它应该可以工作。

```
{
    "query":
    {
        "filtered":
        {
            "query":
            {
                "match_all":{}
            },
            "filter":
            {
                "put" : "your filter here"
            }
        }
    }
} 
```

# android - Android：禁用复选框不响应点击事件

> ID：15535299
> 
> 赞同：4
> 
> 时间：2013-03-20T21:40:58.867
> 
> 标签：android

我有一个可以动态禁用并绑定到点击侦听器的复选框：

```
CheckBox chkbox = (CheckBox)findViewById(R.id.chkboxid);

if(condition) {
     chkbox.setEnabled(false);
     chkbox.setOnClickListener(displayPopup);
} else {
     chkbox.setOnClickListener(handleToggle);
} 
```

这样做的目的是，如果该复选框被禁用，我想为单击该复选框的用户提供更多信息，说明为什么该选项被禁用。

从那以后，我意识到禁用的小部件不会向点击侦听器发送点击事件。我已经尝试`LinearLayout`通过执行以下操作将其设置为可点击：

```
CheckBox chkbox = (CheckBox)findViewById(R.id.checkboxName);
LinearLayout layout = (LinearLayout)findViewById(R.id.layoutName);
if(condition) {
     chkbox.setEnabled(false);
     layout.setClickable(true);
     layout.setDescendantFocusability(ViewGroup.FOCUS_BLOCK_DESCENDANTS);
     layout.setOnClickListener(displayPopup);
} else {
     chkbox.setOnClickListener(handleToggle);
} 
```

这适用于单击`LinearLayout`禁用复选框之外的任何位置。它没有遵循`FOCUS_BLOCK_DESCENDANTS`设置。我也尝试在复选框上放置一个不可见的可点击对象，但在那里也没有成功。有任何想法吗？

编辑：我们现在被困在 API lvl 8 中，否则我会尝试降低复选框的 alpha 而不是禁用它以至少模拟被禁用的外观。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T22:09:20.383

> Android：禁用复选框不响应点击事件

我认为如果`CheckBox`禁用或其他类型的小部件，则无法处理任何事件。

但是要做什么简单的把戏。让`CheckBox`启用，当需要的东西没有填满时，总是将检查状态设置为 false。它看起来像*“我不能勾选复选框，有些东西不好”*，并通过 Toast 显示一些警告消息。

```
checkBox.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {
        if (somethingIsNotFilledUp) {
            checkBox.setChecked(false);
            Toast.makeText(Main.this, "You didn't fill required fields", Toast.LENGTH_SHORT).show();
        }
        else {
            // do some stuff
        }
    }
}); 
```

> 我希望他们看到不同之处

您可以通过使用自定义复选框的外观来实现它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-15T10:20:34.140

您无法在禁用的复选框上接收事件，但我做了其他技巧来模拟禁用的复选框，您可以在其中接收复选框事件并启用它，例如长按它

[模拟禁用复选框接收事件](https://stackoverflow.com/a/37824155/4409192)

希望这可以帮助你

# tcl - 性能比较：一个参数还是参数列表？

> ID：15535302
> 
> 赞同：0
> 
> 时间：2013-03-20T21:41:12.463
> 
> 标签：tcl

我正在定义一个新的 TCL 命令，它的实现是 C++。该命令是查询一个数据流，语法是这样的：

```
mycmd  <arg1>  <arg2> ... 
```

这个想法是这个命令接受一个参数列表并返回一个列表，其中包含每个参数的相应数据。

我的同事评论说，最好只使用一个参数，当需要多个值时，只需多次调用该命令。

还有一些其他的讨论，但我们不能达成一致的一件事是性能。

我认为我的版本，参数列表应该更快，因为当我们想要多个参数时，通过 TCL 解释器是一次成本。

他的评论对我来说是新的-

> 1.  函数实现被缓存
> 2.  访问 TCL 函数比访问 TCL 数据更快

这个推理合理吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T07:23:18.397

如果您使用`Tcl_EvalObjv`调用命令，您将不会通过 Tcl 解释器。成本将是一个哈希表查找（或者更少，如果您重用`Tcl_Obj*`包含命令名称），然后您将执行该命令。否则，*构造*一个列表`Tcl_Obj*`（例如，用`Tcl_NewListObj`）然后调用`Tcl_EvalObj`几乎一样便宜，因为这是一种特殊情况，因为列表构造代码保证生成也是无替换命令的列表。构建一个普通字符串并通过`Tcl_Eval`(or `Tcl_EvalObj`) 的速度要慢得多，因为它必须被解析。（OTOH，连续多次传递*相同* `Tcl_Obj*`的`Tcl_EvalObj`内容会更快，因为它将在内部编译为字节码。）

访问值（即`Tcl_Obj*`引用）非常快，*只要*这些值的内部表示与访问函数所需的类型相匹配。如果不匹配，可能会调用内部类型转换函数，而且它们通常相对昂贵。要了解内部表示，您可以考虑以下几点：

*   `string`— Unicode 字符数组
*   `integer`- 一个 C `long`（除非你溢出到任意精度的工作中）
*   `list`—`Tcl_Obj*`引用数组
*   `dict``Tcl_Obj*`— 映射到的哈希表`Tcl_Obj*`
*   `script`— 字节码版本
*   `command`— 指向实现函数的指针

好的，这些不是确切的类型（通常还有其他簿记数据），但它们是您应该认为的模型。

至于“哪个最快”，回答这个问题的唯一明智的方法是尝试一下，看看哪个是真正最快的：对于没有实际代码来预测它的任何人来说，答案将取决于太多因素。如果您从 Tcl 调用，则该`time`命令非常适合这种性能分析工作（这是它的设计目的）。如果您从 C 或 C++ 调用，请使用该语言的性能测量习语（我不知道，但会在 Stack Overflow 上搜索）。

我？我建议编写 API 尽可能*清晰和干净*。描述实际操作，不要扭曲一切以试图挤出额外的 0.01% 的性能。

# python - 如何在不声明 url 方案的情况下使用 urllib2 获取 url？

> ID：15535309
> 
> 赞同：1
> 
> 时间：2013-03-20T21:41:26.697
> 
> 标签：python, http, url, urllib2

这可能是一个愚蠢的问题，但我可以在不声明 http 或 https 之类的 url 方案的情况下使用 urllib2 获取 url

为了澄清而不是写' [http://blahblah.com](http://blahblah.com) '，我只想写'blahblah.com'，这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:20:34.517

```
import urllib2

def open_url_with_default_protocol(*args, **kwargs):
    #  Use the HTTP scheme by default if none is given
    #  pass through all other arguments to urllib2.urlopen

    default_scheme = 'http://'

    url = args[0]
    scheme, address = urllib2.splittype(url)

    if not scheme:
        #  Replace the url in the args tuple by a URL with the default scheme
        args = (default_scheme + args[0],) + args[1:]

    return urllib2.urlopen(*args, **kwargs) 
```

所以你可以这样做：

```
>>> open_url_with_default_protocol('http://google.com')
<addinfourl at 4496800872 whose fp = <socket._fileobject object at 0x10bd92b50>>
>>> open_url_with_default_protocol('google.com')
<addinfourl at 4331750464 whose fp = <socket._fileobject object at 0x1027960d0>> 
```

请注意，如果您向它传递一个格式为“//google.com”的 URL，此函数仍然会失败，因为它假定如果没有方案，则没有前导双正斜杠。

# jakarta-ee - EJB 查找 - 无法创建远程连接

> ID：15535310
> 
> 赞同：1
> 
> 时间：2013-03-20T21:41:27.213
> 
> 标签：jakarta-ee, lookup, ejb-3.1

我在查找我的 ejb 时遇到问题。在 servlet 中一切正常，但我需要从远程客户端连接到 ejb。

从部署控制台日志：

```
 java:global/easymenu-webappEAR/EasyMenu/CounterBean!sk.jbase.projects.easymenu.CounterBeanRemote
 java:app/EasyMenu/CounterBean!sk.jbase.projects.easymenu.CounterBeanRemote
 java:module/CounterBean!sk.jbase.projects.easymenu.CounterBeanRemote
 java:jboss/exported/easymenu-webappEAR/EasyMenu/CounterBean!sk.jbase.projects.easymenu.CounterBeanRemote
 java:global/easymenu-webappEAR/EasyMenu/CounterBean
 java:app/EasyMenu/CounterBean
 java:module/CounterBean 
```

我在 webapp 中有 ejbmodule（我不知道它是如何分开的）

获取上下文：

```
public static InitialContext getInitialContext(String url) throws NamingException {
    Properties properties = new Properties();

    properties.setProperty(Context.URL_PKG_PREFIXES,
            "org.jboss.ejb.client.naming");
    properties.setProperty(Context.PROVIDER_URL, url);
    properties.setProperty(Context.INITIAL_CONTEXT_FACTORY, "org.jboss.naming.remote.client.InitialContextFactory");
    properties.setProperty(Context.SECURITY_PRINCIPAL, "pch");
    properties.setProperty(Context.SECURITY_CREDENTIALS, "peterch");

    return new InitialContext(properties);
} 
```

抬头：

```
 CounterBeanRemote cbr = (CounterBeanRemote) ServiceLocator
                    .getInitialContext("remote://localhost:8080").lookup("java:app/EasyMenu/CounterBean!"
        + CounterBeanRemote.class.getName());

            System.out.println("Result: " + cbr.getMessage()); 
```

例外

```
mar 20, 2013 10:27:04 PM org.xnio.Xnio <clinit>
INFO: XNIO Version 3.0.3.GA
mar 20, 2013 10:27:04 PM org.xnio.nio.NioXnio <clinit>
INFO: XNIO NIO Implementation Version 3.0.3.GA
mar 20, 2013 10:27:04 PM org.jboss.remoting3.EndpointImpl <clinit>
INFO: JBoss Remoting version 3.2.3.GA
javax.naming.NamingException: Failed to create remoting connection [Root exception is java.lang.RuntimeException: Operation failed with status WAITING]
    at org.jboss.naming.remote.client.ClientUtil.namingException(ClientUtil.java:36)
    at org.jboss.naming.remote.client.InitialContextFactory.getInitialContext(InitialContextFactory.java:121)
    at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:684)
    at javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:307)
    at javax.naming.InitialContext.init(InitialContext.java:242)
    at javax.naming.InitialContext.<init>(InitialContext.java:216)
    at sk.jbase.projects.easymenu.client.EasyMenuClient.getInitialContext(EasyMenuClient.java:58)
    at sk.jbase.projects.easymenu.client.EasyMenuClient.main(EasyMenuClient.java:38)
Caused by: java.lang.RuntimeException: Operation failed with status WAITING
    at org.jboss.naming.remote.protocol.IoFutureHelper.get(IoFutureHelper.java:89)
    at org.jboss.naming.remote.client.NamingStoreCache.getRemoteNamingStore(NamingStoreCache.java:56)
    at org.jboss.naming.remote.client.InitialContextFactory.getOrCreateCachedNamingStore(InitialContextFactory.java:166)
    at org.jboss.naming.remote.client.InitialContextFactory.getOrCreateNamingStore(InitialContextFactory.java:139)
    at org.jboss.naming.remote.client.InitialContextFactory.getInitialContext(InitialContextFactory.java:104)
    ... 6 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-20T17:23:14.593

我在 JBOSS AS 7.2 的最后一个夜间版本中遇到了同样的问题。当我刚刚将类路径中的 jboss-client.jar 恢复为旧版本时，它开始像魅力一样工作。

一旦你修复了上面的 URL 和查找以及 jboss-client.jar，就应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T08:03:19.580

您使用哪个 JBoss 版本？在 JBoss 7.1 中，默认远程端口是 4447，您应该使用 java:jboss/exported/ 之后的 URL。如果您使用“org.jboss.ejb.client.naming”，那么您需要一个“ejb:”前缀作为 URL 和通常在文件 jboss-ejb-client.properties 中的属性。

# android - 在清单中出现父活动错误时返回父活动

> ID：15535313
> 
> 赞同：6
> 
> 时间：2013-03-20T21:41:45.310
> 
> 标签：android

这是与主题相关的清单代码：

```
 <activity
        android:name="smartHomes.capstone.GeneralAndSecurity"
        android:label="@string/title_activity_general_and_security"
        android:parentActivityName="smartHomes.capstone.HomePage" >
        <meta-data
            android:name="android.support.PARENT_ACTIVITY"
            android:value="smartHomes.capstone.HomePage" />
    </activity> 
```

这是错误日志：

```
 03-20 21:19:18.227: E/AndroidRuntime(787): FATAL EXCEPTION: main
   03-20 21:19:18.227: E/AndroidRuntime(787): java.lang.IllegalArgumentException: Activity           GeneralAndSecurity does not have a parent activity name specified. (Did you forget to add the  android.support.PARENT_ACTIVITY <meta-data>  element in your manifest?)
   03-20 21:19:18.227: E/AndroidRuntime(787):   at android.support.v4.app.NavUtils.navigateUpFromSameTask(NavUtils.java:177)
   03-20 21:19:18.227: E/AndroidRuntime(787):   at smartHomes.capstone.GeneralAndSecurity.onOptionsItemSelected(GeneralAndSecurity.java:41)
   03-20 21:19:18.227: E/AndroidRuntime(787):   at com.actionbarsherlock.app.SherlockActivity.onMenuItemSelected(SherlockActivity.java:208) 
```

请问我能知道为什么返回按钮返回错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-06T11:45:35.113

同样对我有用`meta-data`

这是我的例子。

```
 <activity android:name="com.redplanet.sandboxandroid.ui.MainActivity" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.redplanet.sandboxandroid.ui.SecondActivity"
        android:parentActivityName="com.redplanet.sandboxandroid.ui.MainActivity" >
    </activity> 
```

我的`SecondActivity`课。

```
public class SecondActivity extends SherlockFragmentActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.countries_list);

        ActionBar actionBar = getSupportActionBar();
        actionBar.setDisplayOptions(ActionBar.DISPLAY_HOME_AS_UP | ActionBar.DISPLAY_SHOW_TITLE);

    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
        case android.R.id.home:
            NavUtils.navigateUpFromSameTask(this);
            break;
        }
        return super.onOptionsItemSelected(item);

    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-12T12:32:35.200

我遇到了同样的问题，但这只是包名中的拼写错误。您是否仔细检查了包和类名？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-27T14:48:03.493

尝试在您的清单中将其添加到您的父活动中：

`android:allowBackup="true"`

例子：

```
<activity
    android:name=".View.MainActivity"
    android:allowBackup="true">
</activity>

<activity 
    android:name=".View.ChildActivity"
    android:parentActivityName=".View.ChildActivity">
    <meta-data
         android:name="android.support.PARENT_ACTIVITY"
         android:value=".View.MainActivity" />
</activity> 
```

在您的 ChildActivity 中：

```
public class ChildActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_child);
        getSupportActionBar().setDisplayHomeAsUpEnabled(true);
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
            case android.R.id.home:
                NavUtils.navigateUpFromSameTask(this);
                return true;
        }
        return super.onOptionsItemSelected(item);
    }
} 
```

# java - 用于从光盘读取内容的 Java/Scala 的 BSON 库

> ID：15535314
> 
> 赞同：0
> 
> 时间：2013-03-20T21:41:45.010
> 
> 标签：java, scala, serialization, bson

我正在寻找一个用于 Java/Scala 的 BSON 库，它可以读取非常大（大于 RAM）的 BSON 文件。这意味着我不想一次读取整个文件，而只想逐个片段地读取。更何况我只需要阅读。有这样的吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2017-01-19T13:21:53.860

看看[BSONSpec 页面](http://bsonspec.org/implementations.html)

查理

# javascript - 使用 jquery 按样式查找元素

> ID：15535321
> 
> 赞同：-1
> 
> 时间：2013-03-20T21:42:35.203
> 
> 标签：javascript, jquery, html

如何使用它的样式属性在 HTML 文档中找到一个元素？这是一个例子：

HTML：

```
<ul>
   <li style='z-index=1;'>e1</li>
        <div style='z-index=8;'>div</div>
   <li style='z-index=2;'>e2</li>
   <li style='z-index=3;'>e3</li>
   <li style='z-index=4;'>e4</li>
   <li style='z-index=5;'>e5</li>
<ul> 
```

问题是我如何选择，例如..：`<li>`带有`z-index=4`. 以及如何选择所有`div`...`z-index=8`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:45:28.083

如果样式设置为内联，则可以使用属性选择器：

```
 $('li[style*="z-index:4"]') //returns any li's with z-index = 4 
```

看[这里](http://api.jquery.com/attribute-equals-selector/)。这种方法的优点是速度非常快。

如果样式是通过样式表设置的，您可以通过以下方式访问它：

```
 var elem;
 var elems = $("li");

 for(var i=0; i<elems.length; i++) {
    if($(elems[i]).css('z-index') == '4') {
        elem = elems[i];  //assign elem we found
        break;            //exit loop early
    }
 } 
```

**注意**Webkit 浏览器（Safari、Chrome 等）不会返回 z-index 值，除非它也被定位。看这个[例子](http://restingrobot.com/testing/test.html)

此外，for 循环仍然比 .filter()[快](http://jsperf.com/jquery-attribute-style-selector/5)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:47:04.777

没有样式选择器（它是如何工作的，样式是继承和明确声明的规则的组合），但您可以过滤（[演示](http://jsfiddle.net/sperske/99Sz6/)）：

```
var things = $("li").filter(function() {
  return $(this).css('z-index') == '4';
}); 
```

现在，如果您使用`z-index`将一段数据附加到 HTML 元素，您可能会更幸运地使用数据属性（更清晰，可通过 Sizzle 搜索）。一种解释可能如下所示：（[演示](http://jsfiddle.net/sperske/vMP7Q/1/)）

```
<div data-id='8'>div</div>
<ul>
  <li data-id='1'>e1</li>
  <li data-id='2'>e2</li>
  <li data-id='3'>e3</li>
  <li data-id='4'>e4</li>
  <li data-id='5'>e5</li>
<ul>
<script>
  alert($('[data-id=4]').text())
  alert($('[data-id=8]').text())
</script> 
```

# android - 将 TextView 放入 EditText

> ID：15535323
> 
> 赞同：4
> 
> 时间：2013-03-20T21:42:40.097
> 
> 标签：android, android-edittext, textview

请告诉我，我怎样才能将文本放在这样的 EditText 中

[![图片](../Images/df2f15c53e2c34a500ee496179cee829.png)](https://i.stack.imgur.com/ZQYwT.jpg)

并且只能编辑正确的文本。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T21:44:01.990

将 TextView 和 EditText 保留在相对布局中，并根据您的要求进行调整。

例子：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <EditText
        android:id="@+id/Edittext"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_marginTop="20dp"
        android:ems="10"
        android:hint="To my first character" >

        <requestFocus />
    </EditText>

    <TextView
        android:id="@+id/text_view"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/Edittext"
        android:layout_alignBottom="@+id/Edittext"
        android:layout_alignParentRight="true"
        android:text="123123" />

</RelativeLayout> 
```

如果您有任何更改，请更改它

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-01-29T10:41:04.973

试试这个...

**布局：**

```
<FrameLayout
     android:layout_width="match_parent"
     android:layout_height="wrap_content"
     android:layout_marginEnd="8dp"
     android:layout_marginStart="8dp" >

        <EditText
            android:id="@+id/editText"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:ems="10"
            android:hint="@string/mobile"
            android:inputType="phone"
            android:background="@drawable/some_edittext_background"
            android:labelFor="@+id/editText"
            android:maxLength="9"
            android:paddingBottom="8dp"
            android:paddingStart="48dp"
            android:paddingEnd="8dp"
            android:paddingTop="8dp" >
                <requestFocus />
            </EditText>

        <TextView
            android:id="@+id/prefix"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical"
            android:paddingStart="8dp"
            android:text="+971" />
</FrameLayout> 
```

**结果：**

![使能够](../Images/858d0aef63b7f6e15116f69fa1ea5ea7.png)

![重点](../Images/b2790eee54c3acf463a61d996ca88d8a.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-20T21:49:09.627

```
EditText editText = (EditText)findViewById(R.id.edit_text);
editText.setText("Количество", TextView.BufferType.EDITABLE); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T21:54:19.837

您需要结合 3 个组件：

*   容器：使用RelativeLayout，因为它允许视图重叠。
*   一个 TextView 对齐到 RelativeLayout 的右边缘（宽度 = wrap_content）
*   一个 EditText 采用 RelativeLayout 的全宽（宽度 = match_parent）

要将文本放入 EditText：`myEditText.setText("myText")`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T21:46:24.903

为什么不使用`setText()`左侧部分来设置文本并保持不变？

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-03-20T21:48:14.557

我假设您询问如何将文本放入 TextView 中，以编程方式完成

```
textView.setText("anything you want..."); //enter a string into parameters 
```

其中 textView 是 TextView 类的一个实例。

# php - ModRewrite 古怪

> ID：15535326
> 
> 赞同：0
> 
> 时间：2013-03-20T21:42:52.047
> 
> 标签：php, apache, redirect

这对我来说很奇怪，我正在尝试重新定义 SEO 重定向，但发生了一些奇怪的事情。以 /test/test/ 和 /test/test33 等结尾的 url 可以工作，但是如果我有一个以 /test/ 结尾的 url，它可以工作，但 /test33 不能，我错过了什么吗？总而言之，第一条第二条和第四条规则有效，但第三条无效。如果有更好的方法，我愿意接受任何事情。

```
RewriteEngine on
RewriteCond %{REQUEST_URI}  !^.*(media/|\.php).*$ [NC]
RewriteRule ^(.+)/(.+)$     /asports/$1/$2.php [QSA,L]
RewriteRule ^(.+)/(.+)/$    /asports/$1/$2/index.php [QSA,L]
RewriteRule ^(.+)$          /asports/$1.php [QSA,L]
RewriteRule ^(.+)/$         /asports/$1/index.php [QSA,L]
RewriteRule ^$              /asports/index.php [QSA,L]
RewriteRule ^/$             /asports/index.php [QSA] 
```

# c++ - 系统查找错误未定义符号SFML

> ID：15535330
> 
> 赞同：0
> 
> 时间：2013-03-20T21:42:59.387
> 
> 标签：c++, linux, sfml

我在 i686 上运行 Linux Mint 12。

我正在运行一个使用 SFML 的程序。我这样编译并运行它：

```
 g++ -c lineTest.cpp Rasterizer.cpp simpleCanvas.cpp
    g++ -o lineTest lineTest.o Rasterizer.o simpleCanvas.o -lsfml-graphics -lsfml-window -lsfml-system 
```

当我尝试运行程序 lineTest 后，我​​收到以下错误：

```
$ ./lineTest
./lineTest: symbol lookup error: /usr/local/lib/libsfml-window.so.1.6: undefined 
symbol: _ZN2sf7Unicode11UTF8OffsetsE 
```

我没有使用任何 IDE，只是从命令行运行所有内容。有谁知道我可以做些什么来摆脱错误并让程序运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T17:05:10.013

如果我不得不猜测，我会说你在 /usr/lib 和 /usr/local/lib 中都有 sfml。解码损坏的名称：

```
> c++filt _ZN2sf7Unicode11UTF8OffsetsE
sf::Unicode::UTF8Offsets 
```

因此，libsfml-window.so 会查找该`sf::Unicode::UTF8Offsets`函数但找不到它。

# database - 查找实例使两个查询不同

> ID：15535333
> 
> 赞同：0
> 
> 时间：2013-03-20T21:43:01.670
> 
> 标签：database, database-schema

给定数据库的任何模式和关于该数据库的任何两个查询，尝试找到导致两个查询具有不同结果集的最小实例。

1.  我只能想出如何找到两个查询之间的差异的想法，即将每个查询的结果视为一个子表，然后比较两个表，看它们是否相同。但是我不确定这是否可行

2.  不知道如何找到最小的实例，谁能给我一些提示或灵感？我应该开始使用来自两个查询或数据库架构的信息来构建实例，还是我走错了方向？非常感谢！

update1：​​数据库实例是一种场景，其中数据库的每个表的属性都有一些特定的值。

例如，

架构：

```
table A:  attr1 attr2...             table B: attr1  attr2  attr3 ... 
```

我必须找到在数据库的什么场景下两个任意查询会返回不同的结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:50:44.933

假设您使用的是 SQL Server，我相信您希望从两个查询中看到两个结果的差异。

`EXCEPT`像这样使用

```
SELECT * FROM table1
EXCEPT
SELECT * FROM table2 
```

# svn - 从 svn 存储库中过滤大量敏感代码

> ID：15535334
> 
> 赞同：2
> 
> 时间：2013-03-20T21:43:02.760
> 
> 标签：svn, version-control, history, obliterate

我知道整个转储|过滤|加载、删除等问题。而且我同意通常您实际上不必从历史记录中删除文件。

但是我有我认为是一个特例。在过去的几年里，我的团队在做一些 iOS 项目，并不是所有的项目都密切相关，但它们共享一些公共代码，并且它们在同一个 svn repo 上进行管理。

现在的问题是：公司决定将*其中一个*项目的进一步开发转让给第三方。我们需要给他们那个项目的代码——包括历史——但我们不想给他们其他项目的代码。

我怎样才能做到这一点？由于 Svndumpsanitizer 的作者所记录的原因，转储|过滤|加载循环并不能解决问题。不幸的是，Svndumpsanitizer 本身也没有。我目前的方法是将 repo 迁移到 git，您*可以*在其中删除历史记录。但我认为这是矫枉过正。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:14:29.993

就我看到的 ATM 而言，[官方的 Apache Subversion FAQ 条目适用于您的案例。](http://subversion.apache.org/faq.html#removal)

允许您过滤存储库历史记录的新方法应该会有所帮助：

`svnsync`您可以在配置基于路径的授权规则（拒绝对需要从存储库历史记录中过滤掉的任何路径的读取访问）之后使用工具复制存储库。

与, 不同`svndumpfilter`，`svnsync`将自动将具有不可读源路径的复制操作转换为正常添加，如果需要过滤涉及复制操作的历史记录，这很有用。

还要检查这个答案：[https](https://stackoverflow.com/a/13720677/761095) ://stackoverflow.com/a/13720677/761095 。

# android - 使用 MediaRecorder 录制 MPEG TS

> ID：15535335
> 
> 赞同：4
> 
> 时间：2013-03-20T21:43:15.337
> 
> 标签：android, video-streaming, android-camera, android-mediarecorder, mpeg2-ts

我正在尝试录制`mpeg2-ts`视频，以便`server / socket`使用[此处](http://dmonakhov.livejournal.com/23083.html)`Android MediaRecorder`描述的类将其流式传输到...

代码如下：

```
public class MediaRecorderDemo extends Activity
{
private final static String TAG = "MediaRecorderDemo";
Camera camera;
CameraPreview cameraPreview;
MediaRecorder mediaRecorder;
File outputFile = new File(Environment.getExternalStorageDirectory().getPath() + "/out1.ts");

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.media_recorder_demo_layout);

    camera = getCameraInstance();
    cameraPreview = new CameraPreview(this);
    FrameLayout preview = (FrameLayout) findViewById(R.id.camera_preview);
    preview.addView(cameraPreview);
}

private Camera getCameraInstance()
{
    final String FUNCTION = "getCameraInstance";

    Camera c = null;
    try
    {
        c = Camera.open();
    }
    catch(Exception e)
    {
        Log.e(TAG, FUNCTION + " : " + e.getMessage());
    }

    return c;
}

void initMediaRecorder()
{
    final String FUNCTION = "initMediaRecorder";
    FileDescriptor outputFileFD = null;
    try
    {
        outputFile.createNewFile();
        outputFileFD = new FileOutputStream(outputFile).getFD();
    }
    catch(Exception e)
    {
        Log.e(TAG, FUNCTION + " : " + e.getMessage());
    }

    mediaRecorder = new MediaRecorder();
    mediaRecorder.setOnErrorListener(new MediaRecorder.OnErrorListener() {
        final static String TAG = "MediaRecorder.onErrorListener";

        @Override
        public void onError(MediaRecorder mr, int what, int extra) {
            Log.e(TAG, "Error : " + what + " " + extra);
        }
    });

    camera.unlock();
    mediaRecorder.setPreviewDisplay(cameraPreview.getHolder().getSurface());
    mediaRecorder.setCamera(camera);
    mediaRecorder.setAudioSource(MediaRecorder.AudioSource.DEFAULT);
    mediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);
    //mediaRecorder.setProfile(CamcorderProfile.get(CamcorderProfile.QUALITY_LOW));
    mediaRecorder.setOutputFormat(8);
    Log.d(TAG, "File Exists : " + outputFile.exists());
    mediaRecorder.setOutputFile(outputFileFD);
    mediaRecorder.setVideoEncoder(MediaRecorder.VideoEncoder.H264);
    mediaRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.AAC);
    //mediaRecorder.setVideoSize(640, 480);
    mediaRecorder.setMaxDuration(-1);
    //mediaRecorder.setVideoFrameRate(16);
    mediaRecorder.setVideoEncodingBitRate(1024 * 1024);

    try
    {
        mediaRecorder.prepare();
        Log.d(TAG, "MediaRecorder Prepared.");
        mediaRecorder.start();

    }
    catch(Exception e)
    {
        Log.e(TAG, FUNCTION + " : " + e.getMessage());
        //releaseMediaRecorder();
    }
}

void releaseMediaRecorder()
{
    final String FUNCTION = "releaseMediaRecorder";

    try
    {
        if(mediaRecorder != null)
        {
            mediaRecorder.stop();
            mediaRecorder.reset();
            mediaRecorder.release();
            mediaRecorder = null;
            camera.lock();
        }
    }

    catch(Exception e)
    {
        Log.e(TAG, FUNCTION + " : " + e.getMessage());
    }
}

void releaseCamera()
{
    final String FUNCTION = "releaseCamera";
    try
    {
        if(camera != null)
        {
            camera.stopPreview();
            camera.release();
        }
        camera = null;
    }
    catch(Exception e)
    {
        Log.e(TAG, FUNCTION + " : " + e.getMessage());
    }
}

@Override
public void onStart()
{
    super.onStart();
}

@Override
public void onPause()
{
    super.onPause();
}

@Override
public void onResume()
{
    super.onResume();
}

@Override
public void onStop()
{
    super.onStop();
}

@Override
public void onDestroy()
{
    super.onDestroy();
}

public class CameraPreview extends SurfaceView
{
    private final static String TAG = "CameraPreview"; 
    SurfaceHolder holder;
    boolean isPreviewDisplaySet;

    public CameraPreview(Context context)
    {
        this(context, (AttributeSet)null);

        this.holder = getHolder();
        this.holder.addCallback(new SurfaceHolderCallback());
    }

    public CameraPreview(Context context, AttributeSet attrSet)
    {
        this(context, attrSet, 0);
    }

    public CameraPreview(Context context, AttributeSet attrSet, int defStyle)
    {
        super(context, attrSet, defStyle);
    }

    private void releaseCamera()
    {
        if(camera != null)
        {
            camera.release();
            camera = null;
        }
    }

    private class SurfaceHolderCallback implements SurfaceHolder.Callback
    {
        @Override
        public void surfaceCreated(SurfaceHolder holder)
        {
            final String FUNCTION = "surfaceCreated";
            Log.d(TAG, "Surface Created.");

            try
            {
                camera.setPreviewDisplay(holder);
                camera.startPreview();

                initMediaRecorder();
                //mediaRecorder.start();
            }
            catch(Exception e)
            {
                Log.e(TAG, FUNCTION + " : " + e.getMessage());
            }
        }

        @Override
        public void surfaceDestroyed(SurfaceHolder holder)
        {
            final String FUNCTION = "surfaceDestroyed";
            Log.d(TAG, "Surface Destroyed.");

            try
            {
                releaseMediaRecorder();
                releaseCamera();
            }
            catch(Exception e)
            {
                Log.e(TAG, FUNCTION + " : " + e.getMessage());
            } 
        }

        @Override
        public void surfaceChanged(SurfaceHolder holder, int format, int w, int h)
        {
            final String FUNCTION = "surfaceChanged";
            Log.d(TAG, "Surface Changed.");

            if(holder.getSurface() == null)
                return;

            try
            {
                camera.stopPreview();
            }
            catch(Exception e)
            {
                Log.e(TAG, FUNCTION + " : " + e.getMessage());
            }

            try
            {
                camera.setPreviewDisplay(holder);
                camera.startPreview();
            }
            catch(Exception e)
            {
                Log.e(TAG, FUNCTION + " : " + e.getMessage());
            }
        }
    }
}
} 
```

`mediaRecorder.prepare()`调用and没有任何错误并显示`mediaRecorder.start()`相机预览...但是过了一会儿预览被切断然后屏幕冻结并在输出路径创建一个空文件...这个问题也正在报告[Android 问题列表](http://code.google.com/p/android/issues/detail?id=37714)，但尚未纠正...

我曾尝试在具有 Stock Android ICS ROM 的 Galaxy Note N7000 以及三星 Galaxy Tab 2 P3100 但具有自定义 Android 4.2 ROM 上运行相同的应用程序......所以它似乎与 ROM 或特定的硬件配置...

如果有什么遗漏或做错了，知道这一点会很高兴，当然也会松一口气……？

谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-26T21:07:06.217

解决方案是在`M2ts Writer`. 构建`libstagefright.so`并推送到设备。在应用程序中也设置如下

```
recorder.setAudioSamplingRate(48000); 
recorder.setAudioEncodingBitRate(128000); 
```

否则它不会完整地记录剪辑。不过，我没有深入研究设置上述参数的原因。

补丁：`M2tsWriter`_`libstagefright`

```
diff --git a/media/libstagefright/MPEG2TSWriter.cpp b/media/libstagefright/MPEG2TSWriter.cpp

index c9ed5bb..a42371f 100644

--- a/media/libstagefright/MPEG2TSWriter.cpp

+++ b/media/libstagefright/MPEG2TSWriter.cpp

@@ -411,6 +411,7 @@ void MPEG2TSWriter::SourceInfo::onMessageReceived(const sp<AMessage> &msg) { 
                            (const uint8_t *)buffer->data() 
                             + buffer->range_offset(), 
                            buffer->range_length()); 
+                    readMore(); 
                 } else if (buffer->range_length() > 0) {
                     if (mStreamType == 0x0f) { 
                         if (!appendAACFrames(buffer)) { 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-26T03:21:40.500

我遇到了与您类似的问题，尽管不在同一设备上。根据我的初步调查，在录制 mpeg ts 时，HAL 中摄像机的录制堆（缓冲区）没有正确释放。但我仍然不太确定 yuv 数据是否已经到达 OMX。高级原因应由每个硬件供应商检查。希望能帮助到你。:)

# angularjs - 对抗AngularJS执行控制器两次

> ID：15535336
> 
> 赞同：537
> 
> 时间：2013-03-20T21:43:16.287
> 
> 标签：angularjs

我了解 AngularJS 会两次运行某些代码，有时甚至更多，例如`$watch`事件、不断检查模型状态等。

但是我的代码：

```
function MyController($scope, User, local) {

var $scope.User = local.get(); // Get locally save user data

User.get({ id: $scope.User._id.$oid }, function(user) {
  $scope.User = new User(user);
  local.save($scope.User);
});

//... 
```

执行两次，将 2 条记录插入我的数据库。我显然仍在学习，因为我多年来一直在努力解决这个问题！

* * *

## 回答 #1

> 赞同：1054
> 
> 时间：2013-03-20T22:08:26.263

应用路由器将导航指定为`MyController`：

```
$routeProvider.when('/',
                   { templateUrl: 'pages/home.html',
                     controller: MyController }); 
```

但我也有这个`home.html`：

```
<div data-ng-controller="MyController"> 
```

这消化了控制器两次。`data-ng-controller`从 HTML 中删除属性解决了这个问题。或者，该`controller:`属性可能已从路由指令中删除。

使用选项卡式导航时也会出现此问题。例如，`app.js`可能包含：

```
 .state('tab.reports', {
    url: '/reports',
    views: {
      'tab-reports': {
        templateUrl: 'templates/tab-reports.html',
        controller: 'ReportsCtrl'
      }
    }
  }) 
```

相应的报告选项卡 HTML 可能类似于：

```
<ion-view view-title="Reports">
  <ion-content ng-controller="ReportsCtrl"> 
```

这也将导致控制器运行两次。

* * *

## 回答 #2

> 赞同：129
> 
> 时间：2014-10-02T08:46:50.630

> [AngularJS docs - ngController](https://docs.angularjs.org/api/ng/directive/ngController)
> 请注意，您还可以通过 $route 服务在路由定义中声明控制器来将控制器附加到 DOM。**一个常见的错误是在模板本身中使用 ng-controller 再次声明控制器。这将导致控制器被附加并执行两次。**

当您将 ngRoute 与`ng-view`指令一起使用时，控制器默认附加到该 dom 元素（如果您使用 ui-router，则附加到 ui-view）。因此，您无需在模板中再次附加它。

* * *

## 回答 #3

> 赞同：70
> 
> 时间：2015-03-24T18:52:00.243

我刚刚经历了这个，但问题与接受的答案不同。我真的要把它留在这里，为了我未来的自己，包括我修复它所经历的步骤。

1.  [删除多余的控制器声明](https://stackoverflow.com/a/15535724/435460)
2.  [检查路线中的尾随斜杠](https://stackoverflow.com/a/19178043/435460)
3.  [检查`ng-ifs`](https://stackoverflow.com/a/17835972/435460)
4.  检查是否有任何不必要的包装`ng-view`调用（我不小心留下了一个`ng-view`包装我实际`ng-view`的 . 这导致对我的控制器的三个调用。）
5.  如果你在 Rails 上，你应该从你的文件中删除`turbolinks`gem 。`application.js`我浪费了一整天的时间来发现这一点。[在这里](http://dchua.com/2014/11/16/fix-angularjs-from-loading-twice-error-on-rails-4/)找到答案。
6.  使用 ng-app 和 bootstrap 初始化应用程序两次。[对抗AngularJS执行控制器两次](https://stackoverflow.com/questions/15535336/combating-angularjs-executing-controller-twice#comment22009188_15535336)
7.  在指令的“链接”功能中对整个元素使用 $compile 时，该指令还定义了自己的控制器，并通过 ng-click 等在模板中使用此控制器的回调。在[这里](https://stackoverflow.com/a/32014248/3114702)找到答案。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2014-11-17T11:08:58.260

只想在控制器可以初始化两次时再添加一种情况（这对于 angular.js 1.3.1 来说是实际的）：

```
<div ng-if="loading">Loading...</div>
<div ng-if="!loading">
    <div ng-view></div>
</div> 
```

在这种情况下，$route.current 将在 ng-view 初始化时设置。这会导致双重初始化。

要修复它，只需将 ng-if 更改为 ng-show/ng-hide，一切都会正常工作。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-10-28T18:19:21.337

想补充以供参考：

在页面上运行的指令中引用控制器也可能导致双重控制器代码执行。

例如

```
return {

            restrict: 'A',
            controller: 'myController',
            link: function ($scope) { .... 
```

当您的 HTML 中也有 ng-controller="myController" 时

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-04-19T11:25:14.127

在 Angular 1.3+ 中使用[angular-ui-router](http://angular-ui.github.io/ui-router/site/#/api/ui.router)时，存在关于[在 route transition 上渲染视图两次](https://github.com/angular-ui/ui-router/issues/881)的问题。这也导致两次执行控制器。建议的解决方案都不适合我。

但是，`angular-ui-router`从 0.2.11 更新到 0.2.13 为我解决了问题。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-05-07T08:56:34.137

我撕毁了我的应用程序及其所有依赖项，以解决这个问题（详细信息：[AngularJS 应用程序启动两次（尝试了通常的解决方案..）](https://stackoverflow.com/questions/30081785/angularjs-app-initiating-twice-tried-the-usual-solutions)）

最后，这都是 Batarang Chrome 插件的错。

[此答案](https://stackoverflow.com/questions/18709297/angualrjs-ng-click-fires-twice/29662815#29662815)中的分辨率：

![](../Images/d80f29967953dc09862730b7462bff08.png)

我强烈建议任何人列表中的第一件事是在更改代码之前根据帖子禁用它。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-08-01T22:49:28.147

如果您知道您的控制器无意中执行了多次，请尝试在您的文件中搜索有问题的控制器的名称，例如：搜索：MyController 通过所有文件。很可能它被复制粘贴到其他一些 html/js 文件中，而当您开发或使用这些部分/控制器时忘记更改它。来源：我犯了这个错误

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2015-01-27T14:33:07.383

我在一个简单的应用程序中遇到了同样的问题（没有路由和简单的 ng-controller 引用），并且我的控制器的构造函数确实运行了两次。最后，我发现我的问题是在我的 Razor 视图中自动引导我的 AngularJS 应用程序的以下声明

```
<html ng-app="mTest1"> 
```

我还使用 angular.bootstrap 手动引导它，即

```
angular.bootstrap(document, [this.app.name]); 
```

所以删除其中一个，它对我有用。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-11-18T10:54:00.897

在某些情况下，当您根本不正确关闭您的指令时，您的指令会运行两次，如下所示：

`<my-directive>Some content<my-directive>`

这将运行您的指令两次。当您的指令运行两次时，还有另一种常见情况：

确保你没有在你的`index.html` **TWICE**中包含你的指令！

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-05-22T22:49:11.627

一直在用 AngularJS 1.4 rc build 解决这个问题，然后意识到上述答案都不适用，因为它起源于撰写本文时[Angular 1.4 和 Angular 2 的新路由器库。](https://github.com/angular/router)因此，我在这里为可能正在使用新的 Angular 路由库的任何人做一个说明。

基本上，如果 html 页面包含`ng-viewport`用于加载应用程序部分的指令，则通过单击 with 中指定的超链接`ng-link`将导致关联组件的目标控制器被加载两次。细微的差别在于，如果浏览器已经加载了目标控制器，通过重新点击同一个超链接只会调用一次控制器。

还没有找到可行的解决方法，尽管我相信这种行为与[shaunxu](https://github.com/angular/router/issues/204)提出的观察一致，希望这个问题能在未来构建新的路由库和 AngularJS 1.4 版本中得到解决。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-08-12T01:36:58.583

就我而言，我发现两个视图使用同一个控制器。

```
$stateProvider.state('app', {
  url: '',
  views: {
    "viewOne@app": {
      controller: 'CtrlOne as CtrlOne',
      templateUrl: 'main/one.tpl.html'
    },
    "viewTwo@app": {
      controller: 'CtrlOne as CtrlOne',
      templateUrl: 'main/two.tpl.html'
    }
  }
}); 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-09-09T04:44:10.050

我遇到的问题可能是切题的，但由于谷歌搜索让我想到了这个问题，这可能是合适的。使用 UI Router 时，问题对我来说很丑陋，但只有当我尝试使用浏览器刷新按钮刷新页面时。该应用程序使用带有父抽象状态的 UI 路由器，然后是父抽象状态的子状态。在应用程序`run()`功能上，有一个`$state.go('...child-state...')`命令。父状态使用 a `resolve`，起初我以为子控制器可能正在执行两次。

在 URL 附加哈希之前，一切都很好。
`www.someoldwebaddress.org`

然后一旦 url 被 UI Router 修改，
`www.someoldwebaddress.org#/childstate`

...然后当我**使用浏览器刷新按钮刷新页面时**，会`$stateChangeStart`触发两次，每次都指向`childstate`.

`resolve`on parent 状态是触发两次的状态。

也许这是一个杂牌；无论如何，这似乎确实消除了我的问题：在`$stateProvider`第一次调用的代码区域中，**首先**检查**window.location.hash**是否为空字符串。如果是，一切都很好；如果不是，则将**window.location.hash**设置为空字符串。然后似乎`$state`只有一次而不是两次尝试去某个地方。

另外，如果您不想依赖应用程序的默认值`run`和`state.go(...)`，您可以尝试捕获哈希值并使用哈希值来确定您在页面刷新之前所处的子状态，并在您的区域中添加条件设置`state.go(...)`.

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-08-26T06:24:51.583

对于那些使用 ControllerAs 语法的人，只需在 $routeprovider 中声明控制器标签，如下所示：

```
$routeprovider
        .when('/link', {
            templateUrl: 'templateUrl',
            controller: 'UploadsController as ctrl'
        }) 
```

或者

```
$routeprovider
        .when('/link', {
            templateUrl: 'templateUrl',
            controller: 'UploadsController'
            controllerAs: 'ctrl'
        }) 
```

声明 $routeprovider 后，不要像在视图中那样提供控制器。而是使用视图中的标签。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-05-13T13:28:35.960

就我而言，这是因为我使用的 url 模式

我的网址就像 /ui/project/:parameter1/:parameter2。

在所有状态变化的情况下，我都不需要 paramerter2。在我不需要第二个参数的情况下，我的 url 将类似于 /ui/project/:parameter1/。所以每当我有状态改变时，我都会让我的控制器刷新两次。

解决方案是将 parameter2 设置为空字符串并进行状态更改。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-08-24T16:09:02.637

由于不同的原因，我发生了这种双重初始化。对于我的应用程序中的一些路由转换，我想强制滚动到页面顶部附近（例如，在分页搜索结果中......单击下一步应该将您带到第 2 页的顶部）。

我通过向`$rootScope` `$on` `$viewContentLoaded`执行的（基于某些条件）添加一个侦听器来做到这一点

```
$location.hash('top'); 
```

无意中，这导致我的路线被重新评估并且控制器被重新初始化

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-09-22T12:41:25.947

我的问题是像这样更新搜索参数`$location.search('param', key);`

你可以在这里读更多关于它的内容

[由于在 url 中附加参数，控制器被调用了两次](https://stackoverflow.com/questions/29796557/controller-getting-called-twice-due-to-append-params-in-url)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-11-20T15:16:50.840

在我的情况下，将控制器重命名为不同的名称解决了这个问题。

**控制器名称**与“ *angular-ui-tree* ”模块存在冲突：我将控制器从“CatalogerTreeController”重命名为“ *TreeController* ”，然后该控制器开始在使用“ *ui-tree* ”指令的页面上启动两次，因为该指令使用名为“ *TreeController* ”的控制器。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-06-28T12:01:35.213

我遇到了同样的问题，在尝试了所有答案后，我终于发现我的视图中有一个绑定到同一个控制器的指令。

```
APP.directive('MyDirective', function() {
  return {
    restrict: 'AE',
    scope: {},
    templateUrl: '../views/quiz.html',
    controller: 'ShowClassController'
}
}); 
```

删除指令后，控制器停止被调用两次。现在我的问题是，如何使用绑定到控制器范围的这个指令而没有这个问题？

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-01-21T13:21:49.210

我刚刚解决了我的问题，这实际上非常令人失望。它是一个离子混合应用程序，我使用了 ui-router v0.2.13。在我的例子中，有一个 epub 阅读器（使用 epub.js）在我导航到我的图书库并选择任何其他书时不断报告“未找到文档”。当我重新加载浏览器书时，它被完美呈现，但是当我选择另一本书时，又遇到了同样的问题。

我的解决方法很简单。我刚从我`reload:true`的`$state.go("app.reader", { fileName: fn, reload: true });``LibraryController`

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-03-28T09:03:39.760

我在 中遇到了同样的问题`angular-route@1.6.7`，这是因为正则表达式路由末尾的**额外斜杠：**

```
.when('/goods/publish/:classId/', option) 
```

到

```
.when('/goods/publish/:classId', option) 
```

它工作正常。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-05-17T12:52:15.813

只需在此处添加我的案例：

我正在使用angular **-ui-router**`$state.go('new_state', {foo: "foo@bar"})`

一旦我将**encodeURIComponent**添加到参数中，问题就消失了：`$state.go('new_state', {foo: encodeURIComponent("foo@bar")})`.

发生了什么？URL 中不允许参数值中的字符“@”。结果，angular-ui-router 两次创建了我的控制器：在第一次创建期间它传递了原始的“foo@bar”，在第二次创建期间它将传递编码版本“foo%40bar”。一旦我如上所示明确编码参数，问题就消失了。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2020-08-04T02:43:25.937

我的问题真的很难追查。最后，当网页缺少图像时，问题就出现了。src 缺少 URL。这发生在 MVC 5 Web 控制器上。为了解决这个问题，当没有真实图像可用时，我包含了透明图像。

```
<img alt="" class="logo" src=""> 
```

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2017-04-26T11:04:48.837

我发现我的被调用了两次是因为我从我的 html 中调用了两次该方法。

```
`<form class="form-horizontal" name="x" ng-submit="findX() novalidate >
 <input type="text"....>
 <input type="text"....>
 <input type="text"....>
 <button type="submit" class="btn btn-sm btn-primary" ng-click="findX()"
</form>` 
```

突出显示的部分导致 findX() 被调用两次。希望它可以帮助某人。

# css - 按钮和饼图 CSS

> ID：15535338
> 
> 赞同：0
> 
> 时间：2013-03-20T21:43:23.720
> 
> 标签：css, css3pie

我对 CSS Pie 和 iE8 有一个奇怪的问题，其中 Pie 正确地将border-radius 属性应用于元素，但元素的背景（渐变或纯色）溢出了边框，看起来就像在顶部，隐藏了实际元素。

我使用 Pie CSS 已经有一段时间了。我确实知道，在 PHP 环境中使用它时，需要 pie.php，并且 Pie 的正确位置位于站点的根目录。我从来没有遇到过这个问题，但是现在我使用响应式框架我遇到了这个问题。我们用这种结构制作的按钮：

```
<p class="btn">
  <a href="#">Learn More</a>
</p> 
```

CSS：

```
.btn {

    position: relative;
    display: inline-block;
    width: auto;
    height: 36px;
    font-size: 16px;
    line-height: 36px !important;
    border: 1px solid #a0c401;
    border-radius: 4px;
    cursor: pointer;
    margin: 0 0 20px 0;
    -webkit-box-shadow: inset 0 1px 1px #fff,
        0 1px 2px rgba(0,0,0,0.31); /* Remove this line if you dont want a dropshadow on your buttons*/
    box-shadow: inset 0 1px 1px #fff,
                0 1px 2px rgba(0,0,0,0.31); /* Remove this line if you dont want a dropshadow on your buttons*/
    background: #c0eb03; /* Old browsers */
    background: -moz-linear-gradient(top, #c0eb03 0%, #a8cd01 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#c0eb03), color-stop(100%,#a8cd01)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, #c0eb03 0%,#a8cd01 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top, #c0eb03 0%,#a8cd01 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top, #c0eb03 0%,#a8cd01 100%); /* IE10+ */
    background: linear-gradient(top, #c0eb03 0%,#a8cd01 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#c0eb03', endColorstr='#a8cd01',GradientType=0 ); /* IE6-9 */
    -pie-background: linear-gradient(top, #c0eb03 0%,#a8cd01 100%);
    behavior: url("PIE.php");
    z-index: 10 !important;
}
.btn a, .btn:hover a {
    display: block;
    text-shadow: 0px 1px 1px rgba(199, 243, 6, 1);
    text-transform: uppercase;
    font-family: 'AvantGardeGothicITCW01D 731075';
    padding: 0 20px;
    text-align: center;
    text-decoration: none;
    color: #6a8100;
    text-shadow: 0px 1px 1px rgba(199, 243, 6, 1);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:51:35.773

是过滤器溢出；如果您让 PIE 通过 -pie-background 呈现渐变，则不需要它。取下过滤器，一切都应该很好。

# javascript - 如何在 Javascript 中使用 While 循环获取月份返回

> ID：15535340
> 
> 赞同：-1
> 
> 时间：2013-03-20T21:43:27.420
> 
> 标签：javascript, loops, while-loop

我正在学习 JS 并且无法弄清楚这一点。我想问你们是否有人能发现我的错误。我想使用 while 循环返回 1 月到 12 月所有月份的名称，而不使用数组，这可能吗？谢谢你。

```
 window.onload = function() {
    document.getElementById("months").innerHTML = getMonth(11);   
};

for(var month=0; month < 11; month++)

function getMonth(month) {
    var monthName;
    if (month == 11) {
         monthName = "December";
     }
     return monthName;
 }

 function getMonth()
{
var x="",month=0;
while (month<11)
  {
  x=x + month + "<br>";
  i++;
  }
document.getElementById("months").innerHTML=x;
} 
```

[http://jsfiddle.net/priswiz/xuJRc/](http://jsfiddle.net/priswiz/xuJRc/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:48:06.603

没有数组：

```
function getMonth(month) {
  switch(month){
     case 0: return "January";
     case 1: return "February"; 
     //...
     case 11: return "December";
     default: return "Not a valid Month";
   }
 } 
```

但这是一种痛苦的方式。

带数组：

```
function getMonth(month){
  var monthNames = [ "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December" ];
  return monthNames[month];
} 
```

我不知道你想用没有数组的 while 循环做什么。你会迭代什么？

# object - 在 Rust（0.5 和/或树干）中，如何创建可变对象的可变向量？

> ID：15535343
> 
> 赞同：2
> 
> 时间：2013-03-20T21:43:33.573
> 
> 标签：object, vector, rust, mutability

我有以下代码（作为简化示例）：

```
class Item {
   attributes: ~mut [~str];
}

class ItemList {
   items: ~mut [ ~Item ];
}

fn read_item(rdr : Reader) -> ~mut Item {
}

fn load_item_list(rdr : Reader) -> ~mut ItemList {
} 
```

在尝试实现这些功能时，我不断遇到诸如指针/可变性类型（ vs等）*`"unresolved name ItemList"`*之间的错误和冲突`&~mut``~mut`

有人可以给我一个简单的例子，它只分配并返回空对象吗？从那里我应该能够填写数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T00:13:08.360

我不确定您遇到了什么问题，但这里有一些建议。首先，我建议转移到 Rust 主干 -`class`您使用的语法表明 Rust 的版本相当旧。在树干上，`mut`不再是拥有类型内部的有效修饰符，意味着`~mut T`无法写入，也不`struct { mut field: T }`. 相反，拥有类型的可变性是通过其在堆栈中的根来继承的。因此，如果您有`type Foo = ~[~str]`，则该类型在声明时是非常不可变的，`let foo = ~[~"bar"]`而在 时是非常可变的`let mut foo = ~[~"bar"]`。

这是一个基于您的类型的示例。

```
struct Item {
    attributes: ~[~str]
}

struct ItemList {
    items: ~[ ~Item ]
}

fn read_item() -> ~Item {
    ~Item {
        attributes: ~[~"puppies"]
    }
}

fn load_item_list() -> ~ItemList {
    ~ItemList {
        items: ~[read_item()]
    }
}

fn main() {
    let mut my_items = load_item_list();

    my_items.items[0].attributes[0] = ~"kitties";
} 
```

你可以看到这些类型根本没有提到可变性，但是因为我们将它们加载到一个可变槽 ( `let mut my_items`) 中，所以内部向量中的值可以被改变。

这可能需要一些时间来适应，但 Rust 以这种方式处理内部可变性，以避免一些与借用指针相关的潜在混淆错误。

这种继承的可变性的例外是托管类型，它也可以是可变性的根源，如`@mut T`.

# javascript - 从 indexedDB 中捕获 removeObject

> ID：15535350
> 
> 赞同：0
> 
> 时间：2013-03-20T21:44:09.363
> 
> 标签：javascript, html, local-storage, addeventlistener, indexeddb

使用游标显示我的 indexedDB 中的所有对象。我的任务要求我们在页面启动时创建一个管理员帐户。我使用了 localStorage API 来记录该帐户已创建，以便不连续创建此管理员帐户。创建并显示新用户时，他们的姓名旁边会添加一个删除按钮。

**如果要删除管理员帐户，我正在尝试启动一个可以更改管理员密钥的 localStorage 的函数：函数 adminRemoved()。但我不知道如何才能捕捉到那个事件。**

这是显示数据库中所有用户列表的功能：

```
function showUserList(e){
    //var result = e.target.result;
    //databox.innerHTML = '<div>' + result.id + ' - ' + result.name + ' - ' + result.date + '</div>';
    var cursor = e.target.result; // Capture multiple return values as a cursor
    // Modify the databox to show the results 
    if (cursor){        
        databox.innerHTML += '<div>' + 
        cursor.value.userName + ' - ' + 
        cursor.value.fn+ ' - ' + 
        cursor.value.ln+ ' - '+ 
        cursor.value.pw+ ' - '+ 
        cursor.value.em+ ' - '+ 
        cursor.value.dob+ ' - '+
        cursor.value.tel+ ' - '+ 
        cursor.value.bio+ ' - '+ 
        cursor.value.tm+ ' - '+
        cursor.value.scl+' - '+
        cursor.value.gender+ 
        ' <input type="button" onclick="removeobject(\'' + cursor.value.userName + '\')" value="remove"/></div>';
            // Add a remove button as inserted HTML
        cursor.continue(); // Iterates over the cursor
    }
} 
```

我想在删除管理员帐户时运行此功能：

```
function adminRemoved(){
    var admin ='admin';
    var status = 'removed';
    newItem(admin,status);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T07:41:36.953

您的函数名称不对应。在 onclick 中，它被称为“removeobject”，函数名称为“adminRemoved”。将它们命名为相同的名称，并可能在按钮的 onclick 事件中的函数之前放置“javascript:”。这应该有效。

也许更容易做到这一点是通过使用像 jQuery 这样的库来创建控件。附加事件会更容易。

# javascript - 格式化下拉框中的文本

> ID：15535354
> 
> 赞同：0
> 
> 时间：2013-03-20T21:44:24.340
> 
> 标签：javascript, html, css

我目前正在尝试获取格式化并显示在下拉框中的属性的代码和全名。我已经有代码来显示这两个值，但它们没有格式化。问题是并非所有字符都会消耗相同数量的空间。代码可以包含数字或字母。

```
render : function() {
            this.$el.attr('value', this.model.get('ptTimeCd')).html(
                this.model.get('ptTimeCd') + "&nbsp&nbsp|&nbsp"
                + this.model.get('ptTimeName'));

            return this;
        } 
```

这会产生一个下拉菜单，如下所示：

A1 | 一些文字CM | 更多文字 GB | ...

有没有办法让所有这些对齐，以便垂直总是在同一个地方？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:02:27.577

如果我正确理解了您的问题，那么您对[可变宽度或“比例”字体](http://en.wikipedia.org/wiki/Typeface#Proportion)的性质有疑问。您需要的是[等宽](http://www.w3.org/Style/Examples/007/fonts.en.html)字体/字体系列。

也许尝试这样的css规则：

```
.mono {
    font-family: "Courier New", Courier, Fixed, monospace;
} 
```

然后将 css 类应用于您的下拉列表项，看看您是否获得了更像您想要实现的东西。

然后，您只需要确保项目的每个“部分”具有相同数量的字符和空格，这是一个相对简单的编程逻辑练习，您可以根据字符串长度填充或修剪每个部分。再次询问您是否需要该特定部分的帮助。

# sqlite - 仅在 id 不存在时插入

> ID：15535355
> 
> 赞同：4
> 
> 时间：2013-03-20T21:44:26.973
> 
> 标签：sqlite

好的，所以我们有一个带有表格设置的 phonegap 应用程序，例如

`tblTest (actualid INTEGER PRIMARY KEY, id INTEGER, name TEXT)`

actualid 是设备的唯一 ID，该 ID 保存在服务器端数据库中。我们遇到了 web 服务返回重复记录的问题，在我们修复时，我想在我们的 sql 中添加一些内容，以防止添加重复记录（修复错误数据很痛苦）。

我们当前的插入语句设置如下

`INSERT INTO tblTest (id, name) VALUES (101, 'Bob')`

如果你运行两次，数据库最终会看起来像

```
actualid |  id| name
       1 | 101|  Bob
       2 | 101|  Bob 
```

我希望它看起来像

```
actualid |  id| name
       1 | 101|  Bob 
```

插入或替换会`actualid 2`在示例中给我一个，我发现使用 where 子句的任何示例都设置为

`INSERT INTO tblTest SELECT ..... WHERE.....`

这不起作用，因为表中还没有任何数据（除非我犯了新手错误，否则我不太擅长 sqlite 或一般 sql）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-21T07:14:41.513

使用[插入或忽略](http://sqlite.org/lang_insert.html)：

```
INSERT OR IGNORE INTO tblTest (id, name) VALUES (101, 'Bob') 
```

`id`（这需要您已经拥有的列上的唯一索引。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-20T21:47:06.527

你可能想试试这个：

```
 INSERT INTO tblTest 
      (id, name)
      SELECT 101 as id, 'Bob' as name
        FROM tblTest
       WHERE NOT EXISTS(SELECT * FROM tblTest WHERE id = 101 and name = 'Bob') 
```

# css - 在多个 div 上居中文本？

> ID：15535356
> 
> 赞同：1
> 
> 时间：2013-03-20T21:44:27.460
> 
> 标签：css, html

我有一个百分比栏，我试图在它的前面放一些文字。

我的示例是这样做的，但它以较小的条为中心，而不是完整的东西。

**我的问题：**我怎样才能让“测试”这个词集中在整个栏上，而不仅仅是内部较小的那个。

**HTML**

```
<div id="bar1">
<div style="width:55%; text-align:center;">test</div>
</div> 
```

**CSS**

```
#bar1 {
  background-color: black;
  border-radius: 13px; /* (height of inner div) / 2 + padding */
  padding: 3px;
  } 

#bar1 div 
{
    background-color: green;
    height: 20px;   
    border-radius: 10px;
    -webkit-background-size:50px 50px;
    background-image:
        -webkit-repeating-radial-gradient(center, circle, green, #00BB00 40%, green 80%);
        -webkit-animation:upbar 3s linear infinite;
}

@-webkit-keyframes upbar
{
    0%{background-position:0 0}
    100%{background-position:0px -100px}
} 
```

（为酒吧的俗气道歉。我正在努力为它找到一个体面的向上动画，所以欢迎提出任何建议）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:52:15.243

那是因为你的内栏有`width:55%`父 div( `div.bar1`)。要么给它一个全宽，把文本带到中心，要么把你的文本放在外面。

你也可以玩`position:absolute`

看到这个[小提琴](http://jsfiddle.net/manishmishra256/yAzvJ/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:55:27.757

可能有更好的方法，但这有效：http: [//jsfiddle.net/SFHft/](http://jsfiddle.net/SFHft/)

`div`使用一秒钟`position:absolute`：

```
<div id="bar1">
    <div class="anim" style="width:55%;"></div>
    <div class="text">TEST</div>
</div>

#bar1 div.anim 
{
    background-color: green;
    height: 20px;   
    border-radius: 10px;
    -webkit-background-size:50px 50px;
    background-image:
        -webkit-repeating-radial-gradient(center, circle, green, #00BB00 40%, green 80%);
        -webkit-animation:upbar 3s linear infinite;
}

#bar1 div.text 
{
    text-align:center;
    position:absolute;
    color:#fff;
    top: 3px;
    left: 50%;
    width: 100px;
    margin-left: -50px;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T21:58:13.723

您可以使用以下方法将孩子水平`div`居中**`margin: 0 auto`**：

*   [小提琴](http://jsfiddle.net/Nps5F/)
*   [MDN 关于保证金](https://developer.mozilla.org/en-US/docs/CSS/margin)

# jquery - 如何在文档中处理同一表单的多个“实例”

> ID：15535357
> 
> 赞同：0
> 
> 时间：2013-03-20T21:44:30.097
> 
> 标签：jquery, asp.net-mvc

使用重复控件处理重复表单的多个实例的最简单方法是什么。

```
<div id="divTest_Control1">
      <form id="frmBaseClass" >    
        <div id="divTest"></div>    
      </form>
</div>
<div id="divTest_Control2">    
      <form id="frmBaseClass">    
        <div id="divTest"></div>    
      </form>
</div> 
```

使用 @(Using AjaxBeginForm()... 将表单呈现为部分控件

一次只有一个 divTest_xxx 可见，因为我正在隐藏/显示所选的反对重新加载。

我有一些 js 函数作为部分渲染的一部分，所以我如何与 $this...$("#divTest").DoSomething 相关联并不总是按计划工作。

实际上，每个表单上都有许多元素，并且每个元素的可见性都在表单本身的通用 js 函数中处理。所以，我最终得到了很多具有相同控件 ID 的元素。

我对 jquery 还很陌生，并且犯了一个菜鸟错误。任何帮助表示赞赏。处理这种情况的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:55:51.247

您不希望多个元素具有相同的 id。将“共享”ID 更改为类。

例如，假设您知道 divTest_Control2 是当前可见的，然后使用复杂的 jquery 选择器访问特定元素，例如：

$('#divTest_Control2 .divTest')...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T02:52:00.043

我可以通过一些工作来解决这个问题。冲突的子视图确实导致了问题。因此，我为指示始终重新加载的报告类型视图放置了一个属性。这将为我争取时间，直到我能做对为止。

# jquery - jquery没有在点击时触发

> ID：15535361
> 
> 赞同：0
> 
> 时间：2013-03-20T21:44:41.937
> 
> 标签：jquery, onclick, zurb-foundation

我开始在我的 Django 项目中插入一些业余 jQuery，但遇到了一些麻烦。文件的 HTML HEAD 部分如下所示：

```
link rel="stylesheet" href="{{ STATIC_URL }}/stylesheets/foundation.min.css">
<script src="{{ STATIC_URL }}javascripts/modernizr.foundation.js"></script>     
<script src="{{ STATIC_URL }}javascripts/jquery.js"></script>
<script src="{{ STATIC_URL }}javascripts/foundation.min.js"></script>
<script src="{{ STATIC_URL }}javascripts/app.js"></script>
<script src="{{ STATIC_URL }}javascripts/jquery.foundation.tabs.js"></script>
<script type="text/javascript">
    $(window).load(function() {
    $('#slider').orbit();
    });
</script>
<script>
    $('#edit').click(function () {
    alert("heyyyy")
    });
</script> 
```

在 BODY 中，我有一个 ID="edit" 的按钮。

```
<button id="edit" class="small button right">Izmeni</button> 
```

如果我将此代码粘贴到 jsFiddle 中，它将起作用，我可以看到警报。但是，它不适用于我的情况。与 jsFiddle 的唯一区别是我使用的是 Zurb 基础框架，它带有许多 jQuery 函数并且它们都可以工作。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:46:55.577

在 DOM 中创建元素*后*，您需要附加事件处理程序。它在 jsFiddle 中工作的原因是因为 jsFiddle 自动将您的代码包装在

```
$(document).ready(function(){
    // your code here
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:50:13.310

要绑定它，您可以执行以下操作

```
$(document).on('click','#edit',function() {
    alert('Hey');
}); 
```

替换`document`为您的父容器。

# jquery - 使用 jquery 滑动和淡入淡出图像

> ID：15535365
> 
> 赞同：-4
> 
> 时间：2013-03-20T21:44:54.253
> 
> 标签：jquery

我正在尝试创建一个简单的主页，其中两个主图像并排，第三个按钮图像居中，作为输入按钮。是否可以让 2 个主图像滑出屏幕，一个向左，一个向右，并在单击时让输入按钮消失，以显示下面的网页？

我在网上找不到任何东西，我也是新手，非常感谢任何帮助，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:01:10.423

使用 jQuery 动画 - [http://api.jquery.com/animate/](http://api.jquery.com/animate/)

```
$(".button").click(function(){
    $this = $(this);
    $('.left').animate({"margin-left":-1000});
    $('.right').animate({"margin-right":-1000},function(){
        $this.fadeOut();
    });
}); 
```

这既没有成​​效也没有帮助，因为他不知道这是什么。

小提琴 - [http://jsfiddle.net/r285t/1/](http://jsfiddle.net/r285t/1/)

# php - 在插入 mysql 之前检查数据（url 变量）

> ID：15535369
> 
> 赞同：0
> 
> 时间：2013-03-20T21:45:23.303
> 
> 标签：php, mysql, ajax, filter

我的 php 脚本发布了 ajax 发送给它的错误 url。当我尝试过滤 url 并取消插入 mysql 时，它不起作用。我想要做的是验证 $link 变量是否是链接。如果没有，请不要将数据发布到 mysql。我能知道我做错了什么以及如何解决吗？谢谢 :) 这是我的代码

```
$con = mysql_connect("localhost","root","");
if (!$con) {
   die('Could not connect: ' . mysql_error());
}

mysql_select_db("database", $con);

$link = $_POST['new'];
$name = $_POST['name'];
$size = $_POST['size'];
$cat = $_POST['cat'];

// PHP 5.3.5-1ubuntu7.2
$link = mysql_real_escape_string($link);
$name = mysql_real_escape_string($name);
$size = mysql_real_escape_string($size);
$cat = mysql_real_escape_string($cat);

if (filter_var($link, FILTER_VALIDATE_URL)) {} else {
  echo "URL is NOT valid";
  mysql_close($con);
  exit();
}

$check = mysql_query("SELECT link FROM links WHERE  link = '{$link}';");

if (mysql_num_rows($check) == 0) {
    // insert

    $sql="INSERT INTO links (link, name, size, category) VALUES ('$link','$name','$size','$cat')";
    if (!mysql_query($sql,$con))
      {
      die('Error: ' . mysql_error());
      }
    echo "1 record added.  Redirecting!";

    mysql_close($con);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:49:29.073

试试这个：

```
if(filter_var($link, FILTER_VALIDATE_URL, FILTER_FLAG_SCHEME_REQUIRED) === false){
    echo "URL is NOT valid";
    mysql_close($con);
    exit();
} 
```

你是对的`xxxhxtxtp://example.com`将作为有效的网址传递。

试试吧`preg_match`。

```
if (!preg_match("#^http(s)?://[a-z0-9-_.]+\.[a-z]{2,4}#i", $link)) {
    echo "URL is NOT valid";
    mysql_close($con);
    exit();
} 
```

使用此正则表达式，您需要拥有 http(s) 方案。因此，如果这对您不起作用，您可以搜索另一个正则表达式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:49:49.633

这是你想要做的吗？也许您需要一个正则表达式解决方案。

```
if (filter_var($link, FILTER_VALIDATE_URL)) {
    $check = mysql_query("SELECT link FROM links WHERE  link = '{$link}';");

    if (mysql_num_rows($check) == 0) {
        // insert

        $sql="INSERT INTO links (link, name, size, category) VALUES ('$link','$name','$size','$cat')";
        if (!mysql_query($sql,$con))
          {
          die('Error: ' . mysql_error());
          }
        echo "1 record added.  Redirecting!";

        mysql_close($con);
    }
} else {
  echo "URL is NOT valid";
  mysql_close($con);
  exit();
} 
```

# java - Dalvik - 将java文件添加到项目时局部变量类型不匹配 - 没有proguard

> ID：15535371
> 
> 赞同：2
> 
> 时间：2013-03-20T21:45:31.890
> 
> 标签：java, android, proguard, dalvik

我的 android 项目编译和构建很好，但是，当我添加 NanoHTTPD java 文件（纯 java 1 文件 http 服务器）时，我在启动时收到以下错误（没有 proguard）。

```
 [2013-03-20 23:28:56 - test] Dx 
EXCEPTION FROM SIMULATION:
[2013-03-20 23:28:56 - test] Dx local variable type mismatch: attempt to set or access a value of type int using a local variable of type java.io.ByteArrayInputStream. This is symptomatic of .class transformation tools that ignore local variable information.

[2013-03-20 23:28:56 - test] Dx ...at bytecode offset 0000009d
locals[0000]: Lcom/my/android/test/NanoHTTPD$HTTPSession;
locals[0001]: Ljava/io/InputStream;
locals[0002]: I
locals[0003]: [B
locals[0004]: I
locals[0005]: I
locals[0006]: I
locals[0007]: 
locals[0008]: 
locals[0009]: 
locals[000a]: 
locals[000b]: 
locals[000c]: 
locals[000d]: 
locals[000e]: 
locals[000f]: 
locals[0010]: 
locals[0011]: 
locals[0012]: 
locals[0013]: 
locals[0014]: 
locals[0015]: 
locals[0016]: 
locals[0017]: 
locals[0018]: 
locals[0019]: 
locals[001a]: 
locals[001b]: [I
...while working on block 009d
...while working on method run:()V
...while processing run ()V
...while processing com/my/android/test/NanoHTTPD$HTTPSession.class

[2013-03-20 23:28:56 - test] Dx 
EXCEPTION FROM SIMULATION:
[2013-03-20 23:28:56 - test] Dx local variable type mismatch: attempt to set or access a value of type java.lang.Object using a local variable of type int. This is symptomatic of .class transformation tools that ignore local variable information.

[2013-03-20 23:28:56 - test] Dx ...at bytecode offset 000002cd
locals[0000]: Lcom/my/android/test/NanoHTTPD;
locals[0001]: Ljava/lang/String;
locals[0002]: Ljava/util/Properties;
locals[0003]: Ljava/io/File;
locals[0004]: I
locals[0005]: Lcom/my/android/test/NanoHTTPD$Response;
locals[0006]: Ljava/io/File;
locals[0007]: [Ljava/lang/String;
locals[0008]: Ljava/lang/String;
locals[0009]: 
locals[000a]: 
locals[000b]: 
locals[000c]: 
locals[000d]: 
locals[000e]: 
locals[000f]: 
locals[0010]: 
locals[0011]: 
locals[0012]: 
locals[0013]: 
locals[0014]: 
locals[0015]: 
locals[0016]: [I
stack[top0]: Ljava/lang/String;
...while working on block 02cd
...while working on method serveFile:(Ljava/lang/String;Ljava/util/Properties;Ljava/io/File;Z)Lcom/my/android/test/NanoHTTPD$Response;
...while processing serveFile (Ljava/lang/String;Ljava/util/Properties;Ljava/io/File;Z)Lcom/my/android/test/NanoHTTPD$Response;
...while processing com/my/android/test/NanoHTTPD.class 
```

这只发生在当前项目上，当我在其他项目上使用 NanoHTTPD 时没有发生。

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:15:48.503

原来是一个 Eclipse 插件做到了 - CodePro BY GOOGLE！他们的代码覆盖工具不知何故导致了上述错误（可能与 emma 有关，但这只是猜测）。

# .net - 以编程方式在 WCF 服务上定义 system.web/compilation 标记

> ID：15535375
> 
> 赞同：0
> 
> 时间：2013-03-20T21:45:49.860
> 
> 标签：.net, wcf, web-config, system.web

我正在尝试在代码中定义我的所有 WCF 服务配置，我刚刚使用 system.servicemodel 部分完成了它，我做对了。但我想从编译部分设置调试属性为真（它是一个自托管服务）：

```
<system.web>
<compilation debug="true" strict="false" explicit="true" targetFramework="4.5" />
<httpRuntime targetFramework="4.5"/>
</system.web> 
```

我已经这样做了，但我不知道在哪里添加它以使其工作：

```
Dim webConf As New System.Web.Configuration.CompilationSection
webConf.Debug = True
webConf.Strict = False
webConf.TargetFramework = "4.5" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:55:38.553

直接在您的启动方法中

[http://msdn.microsoft.com/en-us/library/system.web.configuration.compilationsection.aspx](http://msdn.microsoft.com/en-us/library/system.web.configuration.compilationsection.aspx)

# javascript - 使用 Kendo Grid 如何删除列边框？

> ID：15535380
> 
> 赞同：1
> 
> 时间：2013-03-20T21:46:05.683
> 
> 标签：javascript, css, telerik, kendo-ui, kendo-grid

我使用的是 Kendo UI Grid，默认情况下我得到列分隔线或边框线。（垂直向下的列）。你如何删除它们。

加价：

```
<div class="grid">
    <h3>Current<span class="goal-count">15</span></h3>
</div> 
```

这是一个 JSFiddle 项目的链接：http: [//jsfiddle.net/mackry/RbmAz/](http://jsfiddle.net/mackry/RbmAz/)

有什么建议么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T22:13:17.867

尝试定义以下样式：

```
.k-grid td {
     border-width: 0;
} 
```

*注意*：请记住，此样式是在 KendoUI CSS 中定义的，因此您应该在最后定义它。

# javascript - 应用程序错误是一个目录 (file:///#android_asset/www/index.html)

> ID：15535382
> 
> 赞同：18
> 
> 时间：2013-03-20T21:46:13.857
> 
> 标签：javascript, android, cordova

我正在使用 phonegap 在 android 上开发应用程序，当我在手机上对其进行测试时出现此错误`Application Error Is a directory (file:///#android_asset/www/index.html)` ，只有当我的手机没有互联网连接时才会出现此错误。

有什么建议么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-22T16:11:43.733

这意味着，在您的 index.html 中，您正在使用需要访问 Internet 的资源。查看您的 index.html 并查找任何直接从 Internet 链接的 CSS、javascript 或 Cordova 文件。如果是这样，您必须下载相关文件并将其本地化。

当我像这样直接链接我的 Jquery 移动 JS 文件时，我遇到了同样的问题：

```
<script type="CSS/javascript" src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.js"> 
```

我所做的是，下载了 jquery.mobile-1.3.0.js 文件并将它放在本地我的 www 文件夹中。这解决了我的问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-20T22:32:15.653

我在这里找到了答案：http: //dev.wavemaker.com/wiki/bin/wmdoc_6.5/PhoneGap?xpage= [print#HTheconnectiontotheserverwasunsucessful28file3A2F2F2Fandroidasset2Fwww2Findexhtml29](http://dev.wavemaker.com/wiki/bin/wmdoc_6.5/PhoneGap?xpage=print#HTheconnectiontotheserverwasunsucessful28file3A2F2F2Fandroidasset2Fwww2Findexhtml29)

> 6.1 连接服务器不成功（file:///android_asset/www/index.html）
> 
> WHERE：在 Android 设备上启动应用程序时。
> 
> 您在 index.html 文件中放置的任何请求远程资源的内容都将导致为 android 设备引发上述错误，然后您的应用程序将死机。Weinre 调试器是导致此错误的常见原因。
> 
> 解决方案：将远程资源的加载从 index.html 移到您的应用程序中，它会安静地失败。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-14T07:26:59.880

例如，您只需要将“index.html”重命名为“main.html”，然后创建一个新的（虚拟）“index.html”，只需重定向到“main.html”

新的“index.html”的内容：

```
<!doctype html>

<html>
    <head>
        <title>Title</title>
        <script>
            window.location='./main.html';
        </script>
    </head>
    <body>      
    </body>
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-12T00:37:12.597

我找到了答案。

在您的标签中包含 phonegap.js `<head>`。phonegap 在构建时需要它。

```
<head>
<script src="phonegap.js"></script> 
</head> 
```

您无需下载 phonegap.js。您只需要包含所示的代码。在构建期间，phonegap 会自动查找并包含它。如果没有，当您运行 Native 应用程序时，该应用程序将在 phonegap 服务器上查找 phonegap.js，这需要很长时间。最终，您的应用程序加载将因您看到的错误消息而超时。

哇！我可以相信这一点。我遇到了这个问题，我很气馁，几乎放弃了使用phonegap。但是，我在 Phonegap 的网站上阅读了关于 phonegap.js 在下面的子标题下

[https://build.phonegap.com/docs/app-overview](https://build.phonegap.com/docs/app-overview)

“确保您仍然可以访问 PhoneGap API”

“一旦你删除了 phonegap.js，你需要确保你的应用程序仍然可以访问 PhoneGap API。

为此，只需确保在您的 index.html 中进行以下引用”

```
<script src="phonegap.js"></script> 
```

这就像魔术一样。有用。

大家加油。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-28T18:57:17.503

空白访问标签允许访问所有外部资源。

```
<access origin="*" /> - a wildcard access tag allows access to all external resource. 
```

否则，您可以指定特定域：

```
-->
    <access origin="127.0.0.1*"/> <!-- allow local pages -->
<!--
<access origin="http://phonegap.com" /> - allow any secure requests to http://honegap.com/
<access origin="http://phonegap.com" subdomains="true" /> - same as above, but including subdomains, such as http://build.phonegap.com/
<access origin="http://phonegap.com" browserOnly="true" /> - only allows http://phonegap.com to be opened by the child browser.
--> 
```

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-19T21:30:15.407

我遵循“[快速入门指南](http://www.adobe.com/devnet/html5/articles/getting-started-with-phonegap-in-eclipse-for-android.html)”，我遇到了同样的问题。但我解决了。我的问题是下载的 phonegap 和后面的 guie 之间的不一致。

您必须确定以下详细信息： - 在 intex.html 中链接正确的 js 脚本版本（例如：cordova-2.7.0.js） - 它必须与下载的 phonegab 版本匹配。phonegab 版本和链接的 js 脚本必须匹配。

我希望这对你有帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-21T17:20:43.567

确保您的页面中包含 phonegap.js 或 cordova.js 脚本。这仅适用于您的移动设备。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2013-03-20T21:54:16.573

你应该使用：

```
file:///android_asset/www/index.html 
```

作为网址

# java - 向morphia查询添加投影

> ID：15535397
> 
> 赞同：3
> 
> 时间：2013-03-20T21:47:06.713
> 
> 标签：java, mongodb, morphia

使用 Morphia 进行查询时，是否可以限制返回的字段（指定投影）？

像这样在命令行：
db.Institution.find({name: /^Berlin/}, {slug:1})

或者使用 Java 驱动程序： BasicDBObject projection = new BasicDBObject("slug", 1); collection.find(new BasicDBObject(),projection);

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:54:10.607

你这样做，请参阅[https://code.google.com/p/morphia/wiki/Query#Ignoring_Fields](https://code.google.com/p/morphia/wiki/Query#Ignoring_Fields)

```
Pattern regex = Pattern.compile("^Berlin");
Query<InsitutionEntity> query = mongoDataStore.find(InsitutionEntity.class)
    .field("name").equal(regex)
    .retrievedFields(true, "slug").asList(); 
```

（没有测试它，但它应该像这样工作）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-05T10:49:14.770

```
BasicDBObject filter = new BasicDBObject();
filter.append("name", "whoever");

BasicDBObject projection = new BasicDBObject();
projection.append("fieldOne", 1); // 1 == True, it shows the Field.
projection.append("fieldTwo", 1);
projection.append("_id", 0) // 0 == False, it does not show the "_id"

List list = MorphiaObject.datastore.getCollection(MyClass.class).find(filter, projection).toArray();
for (Object each : list) {
    System.out.println("Each: " + each.toString());
} 
```

# vb.net - 将复选框添加到 datagridview 列标题，未正确对齐

> ID：15535398
> 
> 赞同：2
> 
> 时间：2013-03-20T21:47:07.673
> 
> 标签：vb.net, winforms, checkbox, datagridview

我试图在特定的 datagridview 列标题中添加一个复选框，我在网上找到了一些代码来提供帮助，但它没有正确对齐，我不确定如何修复它。

下面是问题的图片和代码，任何帮助将不胜感激！

PS我认为这可能与属性有关，但我已经玩过它们但没有成功。

![在此处输入图像描述](../Images/153dccf259fe75ad51e1c41b3c32a1b2.png)

```
Private checkboxHeader231 As CheckBox
Private Sub show_chkBox()
Dim rect As Rectangle = DataGridView1.GetCellDisplayRectangle(columnIndexOfCheckBox, -1, True)
' set checkbox header to center of header cell. +1 pixel to position 
rect.Y = 3
rect.X = rect.Location.X + 8 + (rect.Width / 4)
checkboxHeader231 = New CheckBox()
With checkboxHeader231
    .BackColor = Color.Transparent
End With

checkboxHeader231.Name = "checkboxHeader1"
checkboxHeader231.Size = New Size(18, 18)
checkboxHeader231.Location = rect.Location
AddHandler checkboxHeader231.CheckedChanged, AddressOf checkboxHeader231_CheckedChanged
DataGridView1.Controls.Add(checkboxHeader231)
End Sub

Private Sub checkboxHeader231_CheckedChanged(sender As System.Object, e As System.EventArgs)
Dim headerBox As CheckBox = DirectCast(DataGridView1.Controls.Find("checkboxHeader1", True)(0), CheckBox)
For Each row As DataGridViewRow In DataGridView1.Rows
    row.Cells(columnIndexOfCheckBox).Value = headerBox.Checked
Next
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-18T15:55:57.307

这是我的第一个条目，但我认为这就是你要找的。我对其进行了测试，它适用于我的数据网格。您使用的是矩形的宽度，您将需要它来代替列宽。我将列标题设置为 4，但是您可以将 4 替换为您要使用的列，我以两种方式放置它，一种是四循环，另一种是单行。告诉我这是否对您有用：

```
Dim rect As Rectangle = DataGridView1.GetCellDisplayRectangle(4, -1, True) ' replace 4
        rect.Y = 3

        Dim sum = DataGridView1.Columns(0).Width

        'for this area write a for loop to find the width of each column except for the last line which you manually do
        '
        '
        'For i As Integer = 1 To 4 - 1 Step 1  ' replace 4
        'sum = sum + DataGridView1.Columns(i).Width
        'Next

        sum = sum + DataGridView1.Columns(1).Width
        sum = sum + DataGridView1.Columns(2).Width
        sum = sum + DataGridView1.Columns(3).Width
        ' stop here and add the last line by hand here

        sum = sum + (DataGridView1.Columns(4).Width / 2) + 35 ' used in both cases ' replace 4
        rect.X = sum

        checkboxHeader231 = New CheckBox()
        With checkboxHeader231
            .BackColor = Color.Transparent
        End With

        checkboxHeader231.Name = "checkboxHeader1"
        checkboxHeader231.Size = New Size(18, 18)
        checkboxHeader231.Location = rect.Location
        AddHandler checkboxHeader231.CheckedChanged, AddressOf checkboxHeader231_CheckedChanged
        DataGridView1.Controls.Add(checkboxHeader231) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-04T04:02:37.393

```
Private headerBox As CheckBox
Private Sub show_checkBox()
        Dim checkboxHeader As CheckBox = New CheckBox()
        Dim rect As Rectangle = PendingApprovalServiceListingDataGridView.GetCellDisplayRectangle(4, -1, True)
        rect.X = 20
        rect.Y = 12
        With checkboxHeader
            .BackColor = Color.Transparent
        End With
        checkboxHeader.Name = "checkboxHeader"
        checkboxHeader.Size = New Size(14, 14)
        checkboxHeader.Location = rect.Location
        AddHandler checkboxHeader.CheckedChanged, AddressOf checkboxHeader_CheckedChanged
        PendingApprovalServiceListingDataGridView.Controls.Add(checkboxHeader)
    End Sub
    Private Sub checkboxHeader_CheckedChanged(ByVal sender As Object, ByVal e As EventArgs)
        headerBox = DirectCast(PendingApprovalServiceListingDataGridView.Controls.Find("checkboxHeader", True)(0), CheckBox)
        For Each row As DataGridViewRow In PendingApprovalServiceListingDataGridView.Rows
            row.Cells(0).Value = headerBox.Checked
        Next
    End Sub 
```

# javascript - 动态 Ajax 加载条形图不显示

> ID：15535400
> 
> 赞同：0
> 
> 时间：2013-03-20T21:47:16.313
> 
> 标签：javascript, jquery, ajax, highcharts

我正在努力让 Highcharts 条形图随 Ajax 调用动态变化。我想我真的很接近解决它，但它没有显示，我没有看到问题。我相信我可以像在 setInterval 函数中那样更新积分。我希望有人可以关注它并给我建议......非常感谢

```
<!DOCTYPE HTML>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Highcharts Example</title>

<script type="text/javascript" src="jquery-1.8.2.min.js"></script>
<script type="text/javascript">
<!--Ajax Function-->
var flag = 1;
var xmlhttp;
var url="http://mysite.com/web/ajax_info.txt";
//ajax call
function loadXMLDoc(url, cfunc){
   if(window.XMLHttpRequest){
      xmlhttp=new XMLHttpRequest();
   }
   else {
      xmlhttp=new ActiveObject("Microsoft.XMLHTTP");
   }
   xmlhttp.onreadystatechange=cfunc;
   xmlhttp.open("GET",url, true);
   xmlhttp.send();
}

function myFunction(){
   loadXMLDoc(url+'?_dc='+(new Date()).getTime(), function(){
      if(xmlhttp.readyState==4 && xmlhttp.status==200){
         flag = 1;
      }
   });
}

$(function () {
    var chart;
    $(document).ready(function() {
       chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                type: 'column'
            },
            title: {
                text: 'Active Tribble Sales'
            },
            subtitle: {
                text: 'Source: TribbleInternational.com'
            },
            xAxis: {
                categories: [
                    'Tribbles'
                ]
            },
            yAxis: {
                min: 0,
                title: {
                    text: 'Active Sales (%)'
                }
            },
            legend: {
                layout: 'vertical',
                backgroundColor: '#FFFFFF',
                align: 'left',
                verticalAlign: 'top',
                x: 100,
                y: 70,
                floating: true,
                shadow: true
            },
            tooltip: {
                formatter: function() {
                    return ''+
                        this.x +': '+ this.y +' mm';
                }
            },
            plotOptions: {
                column: {
                    pointPadding: 0.2,
                    borderWidth: 0
                }
            },
            series: [{
                   name: 'Good',
                   data: [80]

               }, {
                   name: 'Bad',
                   data: [1]
               }]
},

function(chart){
             setInterval(function() {
               myFunction();
               if(flag == 1){
                  var point = chart.series[0].points[0],
                  var point2 = chart.series[1].points[0],
                  newVal,
                  inc = Math.round((Math.random() - .5) * 20);

                  newVal = point.y + inc;
                  if (newVal < 0 || newVal > 100) {
                      newVal = point.y - inc;
                  }
                  point.update(newVal);
                  point2.update(1);
                }
                else{
               var point2 = chart.series[0].points[0],
                   var point = chart.series[1].points[0],
                   newVal,
               inc = Math.round((Math.random() - .5) * 20);

                   newVal = point2.y + inc;
                   if (newVal < 0 || newVal > 100) {
                      newVal = point2.y - inc;
                   }
               point2.update(newVal);
                   point.update(1);
               }
         flag = 0; //reset flag after point update. 
             }, 3000);
         }); 
});

</script>
    </head>
  <body>
<script src="highcharts.js"></script>

<div id="container" style="min-width: 300px; max-width: 300px; height: 400px; margin: 0 auto"></div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T11:54:58.910

检查语法，即大括号正确闭合

至于我注意到

```
 series: [{
               name: 'Good',
               data: [80]

           }, {
               name: 'Bad',
               data: [1]
           }] 
```

**},**

应该是 })
因为 // chart = new Highcharts.Chart({

和

```
 }
     flag = 0; //reset flag after point update. 
         }, 3000);
       // } is missing
     }); 
```

});

请检查一下

# copy - NSMutableDictionary 的可变深拷贝

> ID：15535401
> 
> 赞同：0
> 
> 时间：2013-03-20T21:47:17.100
> 
> 标签：copy, nsdictionary, iteration, nsmutabledictionary, deep-copy

首先，我发现了类似的东西： [NSMutableDictionary 的深层可变副本，](https://stackoverflow.com/questions/1950361/deep-mutable-copy-of-a-nsmutabledictionary) 但它并没有解决我的问题。

我有一个 NSMutableDictionary 作为模板。

```
NSMutableDictionary *mutableDictionaryTemplate = [NSMutableDictionary dictionaryWithObjectsAndKeys: @"obj1, @"key1",@"obj2, @"key2",nil]; 
```

现在我想复制这本字典，然后更改一些部分，然后将其保存在 NSMutable 数组中。

```
NSMutableArray *savedIterations = [NSMutableArray new];

//some loop that normally would change the objects added
int i=0;
for (i < 5){

    NSMutableDictionary *copiedDictionary = [mutableDictionaryTemplate copy];
    [copiedDictionary setObject:@"obj3" forKey:@"key3"];
    [savedIterations addObject:copiedDictionary];

    i++;
} 
```

我的问题是，一旦我复制了 NSMutableDictionary “mutableDictionaryTemplate”，它就不再是可变的。但我需要复制它，否则我的 NSMutableArray “savedIterations”的每个索引都会有相同的 NSMutableDictionary（至少我是这么认为的）。我也尝试了可变副本，但是当我更改“copiedDictionary”时，我更改了“mutableDictionaryTemplate”。我认为我对必须复制的内容和不复制的内容以及如何正确复制内容有些混乱。如果有人能指出我正确的方向，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-22T02:07:59.277

你可以试试这个：

```
 NSMutableDictionary *destinationDictionary = (NSMutableDictionary *)CFBridgingRelease(CFPropertyListCreateDeepCopy(kCFAllocatorDefault, (__bridge CFPropertyListRef)(sourceDictionary), kCFPropertyListMutableContainers)); 
```

# r - 根据索引列删除数据框中的数据

> ID：15535406
> 
> 赞同：0
> 
> 时间：2013-03-20T21:47:29.707
> 
> 标签：r, if-statement

像这样查看数据框：

```
set.seed(3)
Data1<-rnorm(20, mean=20)
Dir_1<-rnorm(20,mean=2)
Data2<-rnorm(20, mean=21)
Dir_2<-rnorm(20,mean=2)
Data3<-rnorm(20, mean=22)
Dir_3<-rnorm(20,mean=2)
Data4<-rnorm(20, mean=19)
Dir_4<-rnorm(20,mean=2)
Data5<-rnorm(20, mean=20)
Dir_5<-rnorm(20,mean=2)
Data6<-rnorm(20, mean=23)
Dir_6<-rnorm(20,mean=2)
Data7<-rnorm(20, mean=21)
Dir_7<-rnorm(20,mean=2)
Data8<-rnorm(20, mean=25)
Dir_8<-rnorm(20,mean=2)
Index<-rnorm(20,mean=5)
DF<-data.frame(Data1,Dir_1,Data2,Dir_2,Data3,Dir_3,Data4,Dir_4,Data5,Dir_5,Data6,Dir_6,Data7,Dir_7,Data8,Dir_8,Index) 
```

我最终得到一个数据框，每个观察值包含两列数据（基于观察值 1-8）和一个索引。基于这个指数，我想删除（或做 NA）某些数据观察。

举个例子：

如果索引大于 5，则删除该行中的观察 8（数据和目录）

如果索引大于 4，则删除该行中的观测值 7 和 8

如果索引大于 3 且小于 3.5，则在该行中删除 6、7、8

我希望提出一系列“if”语句，让我根据索引值删除每一行的列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:18:53.493

假设您想要的不是“删除一行的列”而是将 NA 放入特定行的正确列中，您需要使用一些索引向量而不是一系列`if`语句：

```
DF[DF$Index>3 & DF$Index<3.5, (6*2-1):(8*2)] <- NA
DF[DF$Index>4, (7*2-1):(8*2)] <- NA
DF[DF$Index>5, (8*2-1):(8*2)] <- NA 
```

# javascript - 使用 JavaScript、HTML5 或任何跨平台语言（支持 Android）将数据写入 USB HID

> ID：15535409
> 
> 赞同：13
> 
> 时间：2013-03-20T21:47:38.207
> 
> 标签：javascript, android, html, usb, hid

我用 HTML5 和 JavaScript 编写了一个 UI。我选择了这个实现，以便我可以在 Android Chrome 和[Windows 8](https://en.wikipedia.org/wiki/Windows_8) RT 之间共享相同的代码。

现在，我的下一个目标是将数据写入 USB HID。我正在与之通信的设备被视为 HID。我提到这部分，以防有办法写入 HID 设备而不是 USB *RAW*设备。

我对这个问题做了很多研究。但是，HTML5 规范变化如此频繁，以至于我可能遗漏了一些东西。

**无论如何，我是否可以使用一种语言或实现来共享通用代码以访问 Android 和 Windows 8 RT 上的 USB 设备？

如果两者之间无法共享，建议仅在 Android 上进行 USB 通信怎么样？**

* * *

以下是我的研究和结论：

*   Silverlight：*不支持*。网页插件方面，Windows 8 RT 或 Android 不支持

*   Flash：可能的选项。两种操作系统都支持它，尽管它们在[Android 4.1](https://en.wikipedia.org/wiki/Android_version_history#Android_4.1_Jelly_Bean_.28API_level_16.29) (Jelly Bean) 版本中删除了对 Android 的支持。

*   HTML5：*不支持*

*   我查看了 GamePad API，但它似乎只支持从游戏手柄读取。

*   我查看了设备标签，但当前草稿中不再存在此标签。我读到“导航器”对象在 JavaScript 中替换了它，但它似乎完全不同。此外，*设备*仅针对获取视频和音频

*   JavaScript：*不支持*。据我了解，这是因为这会带来安全风险。

*   Chrome 打包应用程序：*不支持*。我不确定是否支持 Windows 8 RT。但是，Android Chrome 也不支持它。

*   存在一个可以完全满足我需要的 USB API，但该 API 仅适用于打包的应用程序[。](https://developer.chrome.com/beta/apps/usb.html)

*   Java 小程序：*不支持*。我不确定是否支持 Windows 8 RT。但是，Android Chrome 也不支持它。

*   有很多关于如何与 USB 设备通信的资源。但是，由于智能手机不支持 Java 小程序，因此最终不受支持。

*   几个有用的帖子

*   *[如何在 ASP.NET 中向串行端口或 USB 端口发送和接收数据？](https://stackoverflow.com/questions/12543874)*

*   *[是否可以从跨浏览器跨操作系统的 Web 应用程序访问 USB？](https://stackoverflow.com/questions/4564973/is-accessing-usb-from-a-web-application-for-cross-browser-cross-os-possible-at-a/4565076#4565076)*

*   *[是否可以提供 JavaScript API 来控制 USB、LPT 和 COM 设备？](https://stackoverflow.com/questions/4242153)*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T02:41:27.307

我实际上已经考虑过如何做类似的事情......

如果您可以控制连接了 USB 设备的计算机，这是一种确定的方法：

让带有 USB 设备的计算机运行 Web 服务器，例如 Apache 和 PHP。让它只听[localhost](https://en.wikipedia.org/wiki/Localhost)。

[然后在正在查看的 HTML 页面中，对 localhost/somescript.php（或CGI](https://en.wikipedia.org/wiki/Common_Gateway_Interface)或 cfm 或其他）执行 Ajax 发布。

在 PHP/CGI 脚本中，与 USB 设备通信，然后向浏览器返回一个 JSON 字符串，说明发生了什么事。

另一种方法是使用自定义 URL 协议。您创建一个可执行文件并将其与您的自定义 URL 协议一起“安装”在客户端计算机上。

然后，您可以使用自定义 URL 协议从浏览器调用可执行文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T15:40:53.620

如果您要控制的 USB 设备是条码打印机，您可以使用[jZebra](https://code.google.com/p/jzebra/)。

这是一个直接与本地连接的打印机通信的小程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-15T07:41:01.267

还有另一种 Web Socket。创建一个 Web 套接字服务器，它将访问本地系统中的 USB 设备。

使用 Web 应用程序中的 Web Socket 连接您的 Web 服务器。Web Socket 具有标准 Api

你可以做这样的事情

```
 var host = "wss://localhost:25000/test";

  Websokcet ws = new WebSocket(host); 
```

[您可以使用 RFC 6455](https://www.rfc-editor.org/rfc/rfc6455)创建您的 web sokcet 服务器

对于较旧的浏览器，您也可以考虑 http 服务器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-06T14:06:46.330

请看一下JSFS。它的工作方式类似于 Chris_vr 的方法，并且已经是一个可行的解决方案。

[https://github.com/jsfsproject/jsfs](https://github.com/jsfsproject/jsfs)。它是免费的，并在 GPL 下获得许可。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-11T08:10:50.510

写入串口：

```
var writeSerial = function(str) {
  chrome.serial.write(connectionId, str2ab(str), onWrite);
}

// Convert string to ArrayBuffer
var str2ab = function(str) {
  var buf = new ArrayBuffer(str.length);
  var bufView = new Uint8Array(buf);
  for (var i=0; i<str.length; i++) {
    bufView[i] = str.charCodeAt(i);
  }
  return buf;
} 
```

更多信息在[http://developer.chrome.com/apps/app_hardware.html](http://developer.chrome.com/apps/app_hardware.html)。

# bash - 如何将每个文件名传递给我的函数？

> ID：15535411
> 
> 赞同：1
> 
> 时间：2013-03-20T21:47:58.513
> 
> 标签：bash, shell, zsh

我正在尝试编写一个简单的函数，该函数将允许我以交互方式从 Git 中取消暂存文件。这是我到目前为止所拥有的：

```
reset_or_keep () {
  echo "Received $1"
}

interactive_reset () {
  local mods=
  mods=`git status --porcelain | sed -e "s/^[A-Z][ \t]*//g" | xargs reset_or_keep`
} 
```

但是，我收到此错误：

```
xargs: reset_or_keep: No such file or directory 
```

我希望为每个条目调用一次 reset_or_keep`git status --porcelain`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:00:30.007

`xargs`最简单的方法是使用以下命令直接在 bash中有效地重新实现`read`：

```
#!/bin/sh

reset_or_keep () {
    echo "Received $1"
}

handle_files() {
    while read filename ; do
        reset_or_keep "$filename"
    done
}

git status --porcelain | sed -e "s/^[ \t]*[A-Z][ \t]*//g" | handle_files 
```

（请注意，我必须对您的`sed`表达式进行一些小改动才能处理来自我的输出格式`git status`。）

请注意，与`xargs`没有`-0`标志一样，该程序将无法正确处理包含空格的文件名。

# html - HTML 5 背景在导航菜单上？

> ID：15535412
> 
> 赞同：1
> 
> 时间：2013-03-20T21:47:58.570
> 
> 标签：html

我开始设计我的作品集，我遇到了这个问题，我为背景设置了图案，但我想在这个图案上再增加 1 个颜色和 1 个切片图像。我开始编写代码，一切都很好，只是我的导航菜单和其他东西都在我添加的这种颜色和图片下。这是 HTML 代码和 CSS。请帮忙？！？

```
<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <title>Wrapping up HTML5</title>
    <link rel="stylesheet" type="text/css" href="css/style.css" />
</head>
<body>
<div id="top-wrap">
<div id="cornerfill"><div class="fillmask"></div></div>
    <div id="fillright"><div class="rightfill"></div></div>
</div>
<div id="wrapper">
<header><h1>Using a HTML5 wrapper</h1></header>
    <section>
        <article>
            <hgroup>
            <h1>This is actually legal</h1>
            <h2>Just wrap everything in a div, just like before</h2>
            </hgroup>
            <p>But it's probably better to simply use the body tag.</p>
        </article>
    </section>
    <footer><p>Love from Kebman</p></footer>
</div>
</body>
</html> 
```

CSS

```
@charset "utf-8";
/* CSS Document */

html
{
    width:100%;
    height:100%;
}

body {
    width: 100%;
    height: 100%;
    min-width:960px;
    min-height:600px;
    margin: 0; 
    padding: 0;
    background: #FFF url(../img/bg.png) fixed;
}

#cornerfill
{
    position:fixed;
    top:0;
    left:0;
    width:50%;
    height:100%
        }

#cornerfill .fillmask
{
    width:  100%;
    height: 100%;
    background-color:#070707;}

#fillright {
    position:fixed;
    top: 0;
    right: 0;
    width:50%;
    height: 100%;
}

#fillright .rightfill
{
    margin-left:-20px;
    width:  600px;
    height: 100%;
    background:url(../img/bgup.png) left bottom no-repeat;
}

#wrapper{
    width: 960px;
    margin: 0 auto;

    }
header
{ width:auto;
height:auto;
background:#FFF;}

#top-wrap
{
    width:100%
    height:40%
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:50:15.470

尝试应用`z-index`来控制页面上元素的分层。

# vba - Word 2011 VBA中的文件对话框

> ID：15535413
> 
> 赞同：3
> 
> 时间：2013-03-20T21:47:58.847
> 
> 标签：vba, macos, ms-word, applescript

我希望能做一个健全的检查。我正在为 Mac 改编一个 Word 加载项（用 VBA 为 Word 2010 编写），具体来说，此时是 Word 2011。我知道其中的许多差异，但我无法找到很多文档是明显缺乏 FileDialog。我最接近答案的地方是：[http](http://www.rondebruin.nl/mac.htm) ://www.rondebruin.nl/mac.htm作者使用 Application.GetOpenFilename。不过，Word 似乎不存在这种方法（该站点的重点是 Excel）。

有谁知道如何使用 FileDialog 提供的文件和文件夹选择器对话框？我真的不熟悉 Applescript，但我必须学习一点才能解决 Word 2011 的时髦文件管理问题（Dir、FileCopy 等）。因此，如果这是答案，那么任何关于 Applescript 中代码可能是什么样子的感觉都将不胜感激。（我或多或少知道如何将其翻译成 VBA）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T11:40:27.663

我相信您必须使用 Apple Script 才能在 Mac 上做得更好。以下代码允许用户选择从函数中作为数组返回的文本文件。您只需修改 Apple 脚本以返回其他文件类型并选择目录，我将把它留给您。

调用该函数并显示包含所有文件的消息框的代码：

```
Sub GetTextFilesOnMac()
    Dim vFileName As Variant

    'Call the function to return the files
    vFileName = Select_File_Or_Files_Mac

    'If it's empty then the user cancelled
    If IsEmpty(vFileName) Then Exit Sub

    'Loop through all the files specified
    For ii = LBound(vFileName) To UBound(vFileName)
        MsgBox vFileName(ii)
    Next ii

End Sub 
```

执行 Apple Script 的功能：

```
Function Select_File_Or_Files_Mac() As Variant
    'Uses AppleScript to select files on a Mac
    Dim MyPath As String, MyScript As String, MyFiles As String, MySplit As Variant

    'Get the documents folder as a default
    On Error Resume Next
    MyPath = MacScript("return (path to documents folder) as String")

    'Set up the Apple Script to look for text files
    MyScript = "set applescript's text item delimiters to "","" " & vbNewLine & _
            "set theFiles to (choose file of type " & " {""public.TEXT""} " & _
            "with prompt ""Please select a file or files"" default location alias """ & _
            MyPath & """ multiple selections allowed true) as string" & vbNewLine & _
            "set applescript's text item delimiters to """" " & vbNewLine & _
            "return theFiles"

    'Run the Apple Script
    MyFiles = MacScript(MyScript)
    On Error GoTo 0

    'If there are multiple files, split it into an array and return the results
    If MyFiles <> "" Then
        MySplit = Split(MyFiles, ",")
        Select_File_Or_Files_Mac = MySplit
    End If
End Function 
```

最后，指定不同的文件类型可能会有点麻烦，如果您只想指定 Word 文档，然后替换`public.TEXT`为`com.microsoft.word.doc`，但是这不允许`.docx`or`.docm`文件。您需要分别为这些使用`org.openxmlformats.wordprocessingml.document`和。`org.openxmlformats.wordprocessingml.document.macroenabled`有关这些的更多信息，请参阅：[https ://developer.apple.com/library/mac/#documentation/FileManagement/Conceptual/understanding_utis/understand_utis_conc/understand_utis_conc.html](https://developer.apple.com/library/mac/#documentation/FileManagement/Conceptual/understanding_utis/understand_utis_conc/understand_utis_conc.html)

# ruby-on-rails - ruby on rails 中的关联

> ID：15535415
> 
> 赞同：0
> 
> 时间：2013-03-20T21:48:12.387
> 
> 标签：ruby-on-rails, ruby, database, associations

我使用设备身份验证创建了一个用户。我还创建了文章视图、控制器和模型，其中模型具有 和等`title`字段。现在我想实现评论（条件是只有登录用户才能评论文章）。我创建了一个特殊用户，该用户有权通过应用程序创建新文章。`body``article_id``is_admin`

User 表包含设备默认生成的所有字段。Article 表具有`article_id`、`title`和等字段`body`。用户和文章表之间仍然没有关联。评论表将有（根据我的理解）`comment_id`，和`comment_body`。

预期关联：

```
class Comment < ActiveRecord::Base
  belongs_to :article
  belongs_to :user 
```

我想确保只有登录用户才能评论文章，并且该`is_admin`用户可以创建新文章。

如何在用户、文章和评论表之间创建关联？我需要为用户和评论表创建关联吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-24T03:52:50.713

建议通过 rails 指南和小博客来了解 @dpassage 在评论中建议的关联。看起来你已经有工作了，所以让我巩固一下。

如您所述，您将拥有三个模型：

第一：用户

```
class User
  has_many :articles  # not dependent => :destroy, may you not want to destroy article on deletion of user
  has_many :comments, :dependent => :destroy 
end 
```

二：文章

```
class Article
    has_many :comments, :dependent => :destroy
    belongs_to :user
end 
```

第三：评论

```
class Comment
    belongs_to :user
    belongs_to :article
end 
```

# string - 用符号将变量分成不同的部分

> ID：15535424
> 
> 赞同：8
> 
> 时间：2013-03-20T21:48:51.523
> 
> 标签：string, batch-file

使用批处理，我希望能够将变量分成两个或三个部分，当有一个符号将它们分开时。例如，如果我有这样的字符串：var1;var2;

我怎样才能让 var1 成为变量，而 var2 成为不同的变量。

提前致谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-20T22:11:12.863

将变量拆分为数组（或 Windows 批处理可以模仿的尽可能接近数组）的最佳方法是将变量的值放入`for`循环可以理解的格式。 `for`没有任何开关将逐字分割一行，在 csv 类型的分隔符处分割（逗号、空格、制表符或分号）。

这比 更合适`for /f`，它逐行而不是逐字循环，并且它允许拆分未知数量元素的字符串。

这基本上是使用`for`循环进行拆分的工作原理。

```
setlocal enabledelayedexpansion
set idx=0
for %%I in ("%var:;=","%") do (
    set "var[!idx!]=%%~I"
    set /a "idx+=1"
) 
```

重要的部分是in的替换，`;`并将整个内容用引号括起来。事实上，这是[最优雅](https://stackoverflow.com/a/5472168/1683264)的分割环境变量的方法。`","``%var%``%PATH%`

这是一个更完整的演示，调用一个子程序来拆分一个变量。

```
@echo off
setlocal enabledelayedexpansion

set string=one;two;three;four;five;

:: Uncomment this line to split %PATH%
:: set string=%PATH%

call :split "%string%" ";" array

:: Loop through the resulting array
for /L %%I in (0, 1, %array.ubound%) do (
    echo array[%%I] = !array[%%I]!
)

:: end main script
goto :EOF

:: split subroutine
:split <string_to_split> <split_delimiter> <array_to_populate>
:: populates <array_to_populate>
:: creates arrayname.length (number of elements in array)
:: creates arrayname.ubound (upper index of array)

set "_data=%~1"

:: replace delimiter with " " and enclose in quotes
set _data="!_data:%~2=" "!"

:: remove empty "" (comment this out if you need to keep empty elements)
set "_data=%_data:""=%"

:: initialize array.length=0, array.ubound=-1
set /a "%~3.length=0, %~3.ubound=-1"

for %%I in (%_data%) do (
    set "%~3[!%~3.length!]=%%~I"
    set /a "%~3.length+=1, %~3.ubound+=1"
)
goto :EOF 
```

这是上述脚本的输出：

```
C:\Users\me\Desktop>test.bat
array[0] = one
array[1] = two
array[2] = three
array[3] = four
array[4] = five 
```

只是为了好玩，试着取消评论这`set string=%PATH%`条线，让美好时光滚滚而来。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-20T23:13:14.023

`Tokens=1,2`确实创建了两个 for 循环变量`%%i`和`%%j`& 分成`string`两部分，由分隔符分隔`;`：

```
@echo off &setlocal
set "string=var1;var2;"
for /f "tokens=1,2 delims=;" %%i in ("%string%") do set "variable1=%%i" &set "variable2=%%j"
echo variable1: %variable1%
echo variable2: %variable2%
endlocal
pause 
```

对于更“动态”的方法，请使用：

```
@echo off &setlocal enabledelayedexpansion
set "string=var1;var2;"

set /a count=0
for %%i in (%string%) do (
    set /a count+=1
    set "variable!count!=%%i"
)
echo found %count% variables
for /l %%i in (1,1,%count%) do (
    echo variable%%i: !variable%%i!
)
endlocal 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-16T11:32:39.083

如果您只出现“一个”，请更改该行

```
for /L %%I in (0, 1, %array.ubound%) do ( 
```

经过

```
for /L %%I in (0, 1, !array.ubound!) do ( 
```

# c# - Validation.GetHasError 对于 WPF ValidationRule 始终返回 true

> ID：15535425
> 
> 赞同：0
> 
> 时间：2013-03-20T21:48:53.433
> 
> 标签：c#, wpf, validation, xaml

为了测试控制组的验证，我看到了一个很好的解决方案：

**在我的 Window.xaml.cs 中：**

```
 private bool IsValid(DependencyObject obj)
    {
        // The dependency object is valid if it has no errors, 
        //and all of its children (that are dependency objects) are error-free.
        return !Validation.GetHasError(obj) &&
            LogicalTreeHelper.GetChildren(obj)
            .OfType<DependencyObject>()
            .All(child => IsValid(child));
    } 
```

我的问题是，就我而言，即使我有错误，isValid 总是返回 true。我认为是因为 xaml 错误但是......在哪里？

**这是我的 Windows.XAML ：**

```
<Window.Resources>
    <CommandBinding x:Key="binding" Command="Save" Executed="Save_Executed" CanExecute="Save_CanExecute" />
</Window.Resources>

<TextBox Name="TextBox_TypeEvenement" Grid.Column="1" VerticalAlignment="Center" Height="20">
  <TextBox.Text>
    <Binding Path="strEvtType">
        <Binding.ValidationRules>
            <ExceptionValidationRule />
        </Binding.ValidationRules>
    </Binding>
  </TextBox.Text>
</TextBox>

<Button Template="{StaticResource BoutonRessourcesTpl}" Command="Save">
  <Button.CommandBindings>
    <StaticResource ResourceKey="binding"></StaticResource>
  </Button.CommandBindings>
  <Image Source= "Toolbar_Valider.png" Height="16"/>
</Button> 
```

**这是我的 Class.cs c# ：**

```
private string m_strEvtType;
public string strEvtType
{
get { return m_strEvtType; }
set {
        m_strEvtType = value;
        if (m_objEvtCode.ReadEvtTypebyType(m_strEvtType) != 0)
        {
            throw new ApplicationException(m_strEvtType.Trim() + " est innexistant !");
        }
        FirePropertyChangedEvent("strEvtType");
        FirePropertyChangedEvent("m_objEvtCode.strDes");
    }
} 
```

你知道为什么 isValid 总是返回 true 吗？

非常感谢 ：）

此致 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:08:45.200

我认为问题是`All`你的用法`Linq`

> 如果源序列的每个元素都通过指定谓词中的测试，**或者序列为空**，则 All 将返回 true ；否则为假。

所以如果没有孩子`DependencyObjects`，`DependencyObject` `All`将返回true

尝试使用另一种 Linq 方法`Any`来检查您的`IsValid`状况

```
 return !Validation.GetHasError(obj) &&
            !LogicalTreeHelper.GetChildren(obj)
            .OfType<DependencyObject>()
            .Any(child => !IsValid(child)); 
```

# sql - 在保留 SQLite 中的自动增量 ID 的同时截断表

> ID：15535429
> 
> 赞同：0
> 
> 时间：2013-03-20T21:49:08.357
> 
> 标签：sql, sqlite

我有一个包含几个不同表的**SQLite数据库。**我想截断这些表之一（删除所有行），同时保留自动增量 ID。

漫长的道路：

```
SELECT id FROM data ORDER BY id DESC LIMIT 1 
DELETE FROM data 
ALTER TABLE data AUTO_INCREMENT={value from first query} 
```

有没有更短/更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:24:27.657

除非您使用设置为 AUTOINCREMENT 的主键创建表，否则该表将以 ID 1 重新开始。

请从这里阅读更多关于 SQLite 中的 AUTOINCREMENT 的信息： [http ://www.sqlite.org/autoinc.html](http://www.sqlite.org/autoinc.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:52:32.733

我相信自动增量在 MySQL 5 中默认保留最后一个值（我最近想要相反的 :) 所以你应该可以删除所有行。

希望这可以帮助！

# asp.net - ImageResizer - 该进程无法访问该文件，因为它正被另一个进程使用

> ID：15535433
> 
> 赞同：0
> 
> 时间：2013-03-20T21:49:29.520
> 
> 标签：asp.net, imageresizer

此行抛出错误：`ImageBuilder.Current.Build(imgURL, imgURL, resizeImg);`

知道为什么吗？

```
public void setImgSize(string controlId, string filename)
{
    decimal currentWidth = 0;
    decimal currentHeight = 0;
    int maxFileWidth = 600;
    int maxFileHeight = 600;
    bool imageExists = false;
    string imgURL = "~/SODocs/" + SONum + "/" + filename;
    string imgPath = Server.MapPath(imgURL);
    if (File.Exists(imgPath))
    {
        imageExists = true;
        System.Drawing.Image imgFile = System.Drawing.Image.FromFile(imgPath);
        Image imgControl = FindControl(controlId) as Image;
        int maxDisplayWidth = 273;
        int maxDisplayHeight = 200;
        currentWidth = Convert.ToDecimal(imgFile.Width);
        currentHeight = Convert.ToDecimal(imgFile.Height);
        int newDisplayWidth = 0;
        int newDisplayHeight = 0;
        int paddingHeight = 0;

        if (currentHeight > currentWidth)
        {
            imgControl.Height = maxDisplayHeight;
            newDisplayWidth = Convert.ToInt32((maxDisplayHeight / currentHeight) * currentWidth);
            imgControl.Width = newDisplayWidth;
            imgControl.Style.Add("margin", "0 auto");
        }
        else if (currentWidth > currentHeight)
        {
            newDisplayHeight = Convert.ToInt32((maxDisplayWidth / currentWidth) * currentHeight);

            if (newDisplayHeight > maxDisplayHeight)
            {
                // set newWidth based on maxHeight
                newDisplayWidth = Convert.ToInt32((maxDisplayHeight / currentHeight) * currentWidth);
                imgControl.Width = newDisplayWidth;
                imgControl.Style.Add("margin", "0 auto");
            }
            else
            {
                imgControl.Width = maxDisplayWidth;
            }

            paddingHeight = maxDisplayHeight - newDisplayHeight;
            imgControl.Style.Add("padding-top", paddingHeight.ToString() + "px");
        }

        imgControl.ImageUrl = imgURL;
        imgFile.Dispose();
        imgFile = null;

        if (imageExists)
        {
            // resize the image file
            if (currentWidth > maxFileWidth | currentHeight > maxFileHeight)
            {
                var resizeImg = new ResizeSettings();
                resizeImg.MaxWidth = maxFileWidth;
                resizeImg.MaxHeight = maxFileHeight;

                ImageBuilder.Current.Build(imgURL, imgURL, resizeImg);

            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T13:27:50.430

### 您正在打开文件以单独阅读，但希望 ImageResizer 稍后能够写入它。System.Drawing 无法正确处理文件锁定，并且 .Dispose() 不足以处理内存泄漏或您遇到的文件访问问题。

我建议查看使用 ImageResizer[的最佳实践指南](http://imageresizing.net/docs/best-practices)。

您在这里尝试完成的工作很可能可以通过[URL API 以更简单且不易崩溃的方式实现](http://imageresizing.net/docs/basics)。

# asp.net - System.NullReferenceException：对象引用未设置为对象的实例（对象父对象、对象 configContext、XmlNode 部分）

> ID：15535437
> 
> 赞同：-1
> 
> 时间：2013-03-20T21:49:33.747
> 
> 标签：asp.net

这是完整的错误代码：

> [2013-03-20 15:34:52,901] Sync3DCartDatabase.ConfigHandler - System.NullReferenceException：对象引用未设置为对象的实例。在 Sync3DCartDatabase.ConfigHandler.Create（对象父，对象 configContext，XmlNode 部分）
> 
> [错误] [2013-03-20 15:34:52,917] ASP.syncdatabase_aspx - System.NullReferenceException：对象引用未设置为对象的实例。在 Sync3DCartDatabase.SyncDatabase.SyncDatabaseFromFile()

下面是看起来正在引用的代码的一部分。如果需要，我可以发布整个代码。

```
 <?xml version="1.0"?>

    <!--
     For more information on how to configure your ASP.NET application, please visit
     http://go.microsoft.com/fwlink/?LinkId=169433
     -->

    <configuration>
     <configSections>
     <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net"/>
     <sectionGroup name="SyncServiceConfigSection">
     <section name="ServiceConfig" type="Sync3DCartDatabase.ConfigHandler, Sync3DCartDatabase" />
     </sectionGroup>
     </configSections>
     <log4net>
     <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
     <file value="logfile.txt" />
     <appendToFile value="true" />
     <rollingStyle value="Size" />
     <maxSizeRollBackups value="5" />
     <maximumFileSize value="1MB" />
     <staticLogFileName value="true" />
     <layout type="log4net.Layout.PatternLayout">
     <conversionPattern value="[%level] [%date] %logger - %message%newline" />
     </layout>
     </appender>
     <root>
     <level value="INFO" />
     <appender-ref ref="RollingFileAppender" />
     </root>
     </log4net>
     <SyncServiceConfigSection>
     <ServiceConfig>
     <!--Time Interval after which to Sync Database (in secs)-->
     <SyncInterval>2700</SyncInterval> 
     <!--Path where working files will be placed-->
     <WorkingFolder>FTPHelperFolder</WorkingFolder>
     <SourceFolderPath>/wwwroot/flatfile</SourceFolderPath>
     <CartConnectionInfo>
     <StoreUrl>Store URL Here</StoreUrl>
     <UserKey>API Key Here</UserKey>
     </CartConnectionInfo>
     <!--FTP Machine information to connect-->
     <FTPSessionOptionInfo>
     <HostName>FTP Host Here</HostName>
     <PortNumber>-1</PortNumber>
     <UserName>FTP User</UserName>
     <Password>FTP Pass</Password>
     <!--FTP = 0, SFTP = 1-->
     <FTPProtocol>0</FTPProtocol>
     <SshHostKeyFingerprint></SshHostKeyFingerprint>
     <!-- None = 0, Implicit = 1, ExplicitSsl = 2, ExplicitTls = 3-->
     <FTPSecure>0</FTPSecure>
     <SslHostCertificateFingerprint>SSL Finger</SslHostCertificateFingerprint>
     </FTPSessionOptionInfo>
     <MappedFileDetails>
     <MappedFileDetails>
     <FileInfo fileNameSuffix="P" fileNamePattern="yyyyMMdd" fileExtension=".txt" >
     <!-- Delete the file after it has been successfully updated to 3D cart-->
     <!-- 0= Do Not Delete / 1 = Delete-->
     <DeleteFTPFileAfterSync>0</DeleteFTPFileAfterSync>
     <!--Mapping for input and output column names-->
     <ColumnsMappingDetails>
     <ColumnsMappingDetails>
     <column name="SKU" mappedName="id" update="0" insert="1" ColumnType="2"></column>
     <column name="STATUS 0=ACTIVE/9=INACTIVE" mappedName="hide" update="0" ColumnType="3" insert="0">
     <!--Mapping for input to output column values-->
     <MappedValues>
     <value origValue="0" mappedValue="0"></value>
     <value origValue="9" mappedValue="1"></value>
     </MappedValues>
     </column>
     <column name="QTY AVAILABLE" mappedName="Stock" update="0" insert="0" ColumnType="1"></column>
     <column name="STYLE" mappedName="mfgid" update="0" insert="0" ColumnType="2"></column>
     <column name="SUGG PRICE" mappedName="price2" update="0" insert="0" ColumnType="1"></column>
     <column name="PRICE" mappedName="price" update="1" insert="1" ColumnType="4"></column>
     <column name="ADVERTIZED PRICE" mappedName="saleprice" update="1" insert="1" ColumnType="4"></column>
     </ColumnsMappingDetails>
     </ColumnsMappingDetails>
     </FileInfo>
     <FileInfo fileNameSuffix="S" fileNamePattern="yyyyMMdd" fileExtension=".txt" >
     <!-- Delete the file after it has been successfully updated to 3D cart-->
     <!-- 0= Do Not Delete / 1 = Delete-->
     <DeleteFTPFileAfterSync>0</DeleteFTPFileAfterSync>
     <!--Mapping for input and output column names-->
     <ColumnsMappingDetails>
     <ColumnsMappingDetails>
     <column name="SKU" mappedName="id" update="0" insert="1" ColumnType="2"></column>
     <column name=" SET PRICE" mappedName="price" update="1" insert="1" ColumnType="4"></column>
     <column name="ADVERTIZED SET PRICE" mappedName="saleprice" update="1" insert="1" ColumnType="4"></column>
     </ColumnsMappingDetails>
     </ColumnsMappingDetails>
     </FileInfo>
     </MappedFileDetails>
     </MappedFileDetails>
     </ServiceConfig>
     </SyncServiceConfigSection>
     <system.web>
     <compilation debug="true" targetFramework="4.0" />
        <customErrors mode="Off"/>
     <authentication mode="Forms">
     <forms loginUrl="~/Account/Login.aspx" timeout="2880" />
     </authentication>

     <membership>
     <providers>
     <clear/>
     <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices"
     enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false"
     maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10"
     applicationName="/" />
     </providers>
     </membership>

     <profile>
     <providers>
     <clear/>
     <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="/"/>
     </providers>
     </profile>

     <roleManager enabled="false">
     <providers>
     <clear/>
     <add name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="ApplicationServices" applicationName="/" />
     <add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />
     </providers>
     </roleManager>

     </system.web>

     <system.webServer>
     <modules runAllManagedModulesForAllRequests="true"/>
     </system.webServer>
     <system.serviceModel>
     <bindings>
     <basicHttpBinding>
     <binding name="cartAPISoap" />
     <binding name="cartAPIAdvancedSoap" />
     </basicHttpBinding>
     </bindings>
     <client>
     <endpoint address="http://api.3dcart.com/cart_advanced.asmx"
     binding="basicHttpBinding" bindingConfiguration="cartAPISoap"
     contract="cartAPI.cartAPISoap" name="cartAPISoap" />
     <endpoint address="http://api.3dcart.com/cart_advanced.asmx"
     binding="basicHttpBinding" bindingConfiguration="cartAPIAdvancedSoap"
     contract="cartAPI.cartAPIAdvancedSoap" name="cartAPIAdvancedSoap" />
     </client>
     </system.serviceModel>
    </configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:52:29.693

在 SyncDatabaseFromFile() 中添加断点。逐步检查并找到您引用尚未使用 new() 参数初始化的对象的位置。

另外，学会提出更好的问题。这是非常模糊的

# mysql - 带有AND条件的MYSQL查询中的多个PHP变量

> ID：15535442
> 
> 赞同：-1
> 
> 时间：2013-03-20T21:50:10.050
> 
> 标签：mysql, variables

这是我的第一个代码问题！我是 MySQL 和 PHP 的初学者，所以这可能真的很简单！这是我的代码：

这是包含在我的 Index.php 中的一个文件...：

```
<?php
$query="SELECT * FROM wines WHERE Type='$type' AND Country='$country'";
$products=mysql_query($query);
?> 
```

这些是使用 $_GET 函数设置的变量：

```
<?php
$type=$_GET['type'];
$fruit=$_GET['fruit'];
$country=$_GET['country'];
?> 
```

然后稍后我将获取数组并使用它。

问题是我的 $query 仅适用于 '$type' 变量，但不适用于 $country -variable - - - - 或我尝试过的任何其他变量。

我使用 Microsoft Webmatrix，它告诉我问题出现在我在第二个变量中输入 $-sign 的那一刻......

如此迷茫！希望你能帮助一个新人:)

编辑：我发现问题出在我的变量周围的“刻度”上。正确的做法是使用反引号（``）。另外，我开始使用 PDO 和 MySQLi 而不是 mysql。对于初学者来说，MySQLi 可能是最简单的。也开始消毒了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:03:03.893

只需注意几点（重要）...

1.  您可能应该使用 mysqli_* 函数代替 mysql_ 函数，因为它们将在下一个版本中被弃用。

2.  在进行数据库查询之前开始[清理您的输入。](http://www.php.net/manual/en/mysqli.real-escape-string.php)早点养成是个好习惯，从长远来看，会为您省去很多麻烦！

在数据库上执行之前使用[sprintf](http://www.php.net/manual/en/function.sprintf.php)和[mysqli_real_escape_string](http://www.php.net/manual/en/mysqli.real-escape-string.php)构建 SQL是一个好习惯：

```
$sql = sprintf("SELECT * FROM wines WHERE Type='%s' AND Country='%s'" ,
    mysqli_real_escape_string($db_object, $type),
    mysqli_real_escape_string($db_object, $country));

$results = mysqli_query($db_object, $sql); 
```

附言。在我的示例中，$db_object 来自对[mysqli_connect](http://php.net/manual/en/function.mysqli-connect.php) ()的调用

**编辑：**

对于上面的示例，使用（即将失效的）mysql_ 函数将类似于以下内容：

```
$sql = sprintf("SELECT * FROM wines WHERE Type='%s' AND Country='%s'" ,
    mysql_real_escape_string($type),
    mysql_real_escape_string($country));

$results = mysql_query($sql); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:02:22.693

如果您没有在查询字符串中发送 $type，则查询为

```
SELECT * FROM wines WHERE Type='' AND [other stuff]; 
```

这将只返回 type = ''; 的葡萄酒

尝试：

```
<?php
$wheres=array();
if (isset($type)){$wheres['Type']=$type;}
if (isset($type)){$wheres['Country']=$country;}
// and so forth for each parameter
$query="SELECT * FROM wines";
if (count($wheres) != 0){
    $query.=" WHERE ";
    foreach ($wheres as $k => $v){$query.="$k='$v' AND ";}
    $query.=" 1=1;"
}
$products=mysql_query($query);
?> 
```

# python - 关闭挥之不去的联系

> ID：15535445
> 
> 赞同：1
> 
> 时间：2013-03-20T21:50:15.947
> 
> 标签：python, python-requests

我正在使用 python-requests 作为客户端工具。它每隔一段时间向服务器发出重复请求。但是，如果服务器断开连接，客户端将在下一次请求时失败并出现套接字错误。客户端似乎从其一侧保持连接打开，而不是重新连接。这些连接可能相隔数小时，因此服务器不太可能断开连接。

有没有办法覆盖保持活动并强制它关闭？有没有类似的东西：

```
with requests.get(url) as r:
  doStuff(r)
# R is cleaned up, the socket is closed. 
```

那会在我完成后强制连接清理吗？

正如所写的那样不起作用，因为 requests.Response 没有 __ exit__ 调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:50:11.927

这个怎么样？

我没有测试它，仅基于 API 文档：

```
s = requests.Session()
r = s.get(url)
doStuff(r)
s.close() 
```

或者，为了确保始终调用 close，即使有异常，以下是如何使用 try/finally 模拟 with 语句：

```
s = requests.Session()
try:
    r = s.get(url)
    doStuff(r)
finally:
    s.close() 
```

# python - 从 Bitbucket OAuth 获得 400

> ID：15535446
> 
> 赞同：3
> 
> 时间：2013-03-20T21:50:19.317
> 
> 标签：python, oauth, bitbucket, rauth

```
from rauth import OAuth1Service

OAUTH_REQUEST = "https://bitbucket.org/!api/1.0/oauth/request_token"
OAUTH_AUTH = "https://bitbucket.org/!api/1.0/oauth/authenticate"
OAUTH_ACCESS = "https://bitbucket.org/!api/1.0/oauth/access_token"

service = OAuth1Service(
           name='test',
           consumer_key='xxxxxxxxxxxxxx',
           consumer_secret='xxxxxxxxxxxxxxxxxxxx',
           request_token_url=OAUTH_REQUEST,
           access_token_url=OAUTH_ACCESS,
           authorize_url=OAUTH_AUTH)

resp = service.get_raw_request_token()
print resp 
```

我继续使用 Bitbucket 并生成了一个消费者密钥对，但响应是 400。知道发生了什么吗？

我查看了 Bitbucket 文档，并且 URL 是正确的。

* * *

**编辑**

感谢@maxcountryman 抽出宝贵时间来这里。

我刚刚阅读了他的[linkedlin示例代码](https://github.com/litl/rauth/blob/c6447ddb5427246d58e6c2077bdc71404b4d1def/examples/linkedin-updates-cli.py)：

```
import os
from rauth import OAuth1Service

OAUTH_REQUEST = "https://bitbucket.org/!api/1.0/oauth/request_token"
OAUTH_AUTH = "https://bitbucket.org/!api/1.0/oauth/authenticate"
OAUTH_ACCESS = "https://bitbucket.org/!api/1.0/oauth/access_token"

service = OAuth1Service(
           name='test',
           consumer_key='blah',
           consumer_secret='blah',
           request_token_url=OAUTH_REQUEST,
           access_token_url=OAUTH_ACCESS,
           authorize_url=OAUTH_AUTH)

# You can run python -m SimpleHTTPServer if you want a local callback
rtoken, rtoken_secret = service.get_request_token(params={'oauth_callback': 'http://localhost:8000'})

authorize_url = service.get_authorize_url(rtoken)
print 'Visit this URL in your browser: ' + authorize_url
pin = raw_input('Enter PIN from browser: ')
session = service.get_auth_session(rtoken,
                                   rtoken_secret,
                                   data={'oauth_verifier': pin})

reponame = raw_input('Enter the reponame: ')
new_name = raw_input('Enter a new repo name: ')
account_name = raw_input('Enter your account name: ')
url = 'https://api.bitbucket.org/1.0/repositories/%s/%s' %(account_name, reponame)
r = session.put(url, data={'name': new_name})
print r 
```

例子：

```
(k)yeukhon@yeukhon-P5E-VM-DO:/tmp$ python bb2.py
Visit this URL in your browser: https://bitbucket.org/!api/1.0/oauth/authenticate?oauth_token=xxxxxxxxxxxxx
Enter PIN from browser: 216000000
Enter the reponame: newpatch
Enter a new repo name: junk-patch
Enter your account name: yeukhon
<Response [200]> 
```

* * *

**编辑**从 max using 中获取更多建议`base_url`。

```
OAUTH_REQUEST = "https://bitbucket.org/!api/1.0/oauth/request_token"
OAUTH_AUTH = "https://bitbucket.org/!api/1.0/oauth/authenticate"
OAUTH_ACCESS = "https://bitbucket.org/!api/1.0/oauth/access_token"

service = OAuth1Service(
           name='test',
           consumer_key='blah',
           consumer_secret='blah',
           request_token_url=OAUTH_REQUEST,
           access_token_url=OAUTH_ACCESS,
           authorize_url=OAUTH_AUTH,
           base_url='https://api.bitbucket.org/1.0/')

# You can run python -m SimpleHTTPServer if you want a local callback
rtoken, rtoken_secret = service.get_request_token(params={'oauth_callback': 'http://localhost:8000'})

authorize_url = service.get_authorize_url(rtoken)
print 'Visit this URL in your browser: ' + authorize_url
pin = raw_input('Enter PIN from browser: ')
session = service.get_auth_session(rtoken,
                                   rtoken_secret,
                                   data={'oauth_verifier': pin})

reponame = raw_input('Enter the reponame: ')
new_name = raw_input('Enter a new repo name: ')
account_name = raw_input('Enter your account name: ')
url = 'repositories/%s/%s' %(account_name, reponame)
r = session.put(url, data={'name': new_name})
print r.text
print r 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-28T21:33:45.280

您需要给 API 一个`oauth_callback`，如下所示：

```
r = service.get_raw_request_token(params={'oauth_callback': 'http://example.com/'}) 
```

这应该会让您从提供商那里得到正确的回应。

# javascript - 如何在 syntaxhighlighter 中创建动态内容

> ID：15535448
> 
> 赞同：0
> 
> 时间：2013-03-20T21:50:31.063
> 
> 标签：javascript, html, syntaxhighlighter

我想根据用户输入显示属性名称并将其显示在 SyntaxHighlighter 中。 [另一篇](https://stackoverflow.com/questions/7761867/how-to-replace-content-of-javascript-syntax-highlighter)文章说这应该很容易。

**JS**

```
 $('#inputText').keyup(function () {
        var outputValue = $('#codeTemplate').html();//Take the output of codeTemplate
        $('#codeContent').html(outputValue);//Stick the contents of code template into codeContent

        var finalOutputValue = $('#codeContent').html();//Take the content of codeContent and insert it into the sample label
        $('.popover #sample').html(finalOutputValue);

        SyntaxHighlighter.highlight();
    });               

    SyntaxHighlighter.all(); 
```

**标记**

```
<div style="display: none;">
    <label class="propertyName"></label>
    <label id="codeTemplate">
        <label class="propertyName"></label>
        //Not using Dynamic object and default Section (appSettings):
        var actual = new Configuration().Get("Chained.Property.key");

        //more code
    </label>            

    <pre id="codeContent" class="brush: csharp;">

    </pre>
</div>

<div id="popover-content" style="display: none">
    <label id="sample">

    </label>
</div> 
```

这会输出纯文本。好像 SyntaxHighlighter 从未运行过。`<pre>`我怀疑这个问题与呈现页面后不存在的事实有关。然而，更新

`SyntaxHighlighter.config.tagName = "label";`

与 pre to label 一起也不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T19:26:37.403

要使其发挥作用，必须克服许多问题。我觉得最好用代码来解释：

**JS**

```
<script>        
    $(function () {        
        $('#Key').popover({
            html: true,
            trigger: 'focus',
            position: 'top',
            content: function () {
                loadCodeData(true);
                console.log('content updated');
                var popover = $('#popover-content');
                return popover.html();//inserts the data into .popover-content (a new div with matching class name for the id)
            }
        });       

        $('#Key').keyup(function () {
            loadCodeData();
        });

        function loadCodeData(loadOriginal) {
            var userData = $('#Key').val();
            var codeTemplate = $('#codeTemplate').html();
            var tokenizedValue = codeTemplate.toString().replace('$$propertyNameToken', userData);
            $('#codeContent').html(tokenizedValue);
            $('#codeContent').attr('class', 'brush: csharp');//!IMPORTANT: re-append the class so SyntaxHighlighter will process the div again

            SyntaxHighlighter.highlight();

            var syntaxHighlightedResult = $('#codeContent').html();//Take the content of codeContent and insert it into the div                   

            var popover;
            if(loadOriginal)
                popover = $('#popover-content');//popover.content performs the update of the generated class for us so well we need to do is update the popover itself
            else {
                popover = $('.popover-content');//otherwise we have to update the dynamically generated popup ourselves.
            }

            popover.html(syntaxHighlightedResult);
        }

        SyntaxHighlighter.config.tagName = 'div';//override the default pre because pre gets converted to another tag on the client.  
        SyntaxHighlighter.all();
    });
</script> 
```

**标记**

```
<div style="display: none;">
    <label id="codeTemplate">
        //Not using Dynamic object and default Section (appSettings):
        var actual = new Configuration().Get("$$propertyNameToken");

        //Using a type argument:
        int actual = new Configuration().Get&lt;int>("asdf");

        //And then specifying a Section:
        var actual = new Configuration("SectionName").Get("test");

        //Using the Dynamic Object and default Section:
        var actual = new Configuration().NumberOfRetries();

        //Using a type argument:
        int actual = new Configuration().NumberOfRetries&lt;int>();

        //And then specifying a Section:
        var actual = new Configuration("SectionName").NumberOfRetries(); 
    </label>            

    <div id="codeContent" class="brush: csharp;">

    </div>
</div>

<div id="popover-content" style="display: none">

</div> 
```

# c# - WPF如何使DataGridComboBoxColumn的背景与DataGridTextBoxColumn相同

> ID：15535449
> 
> 赞同：0
> 
> 时间：2013-03-20T21:50:36.053
> 
> 标签：c#, wpf, styles, datagridcomboboxcolumn

我在 datagrid 中有一个 datagridCombox 列。为了使组合框始终像组合框一样显示（单击或不单击），组合框的实现方式如下

xmlns:dg="http://schemas.microsoft.com/wpf/2008/toolkit"

```
 <dg:DataGridTemplateColumn Header="Time Unit" x:Name="timeUnit" >
                    <dg:DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <ComboBox SelectedValue="{Binding RelParams.TimeUnit}" 
                                      Background="White" BorderBrush="{x:Null}"
                                      ItemsSource ="{Binding TimeUnitList}" >
                            </ComboBox>
                        </DataTemplate>
                    </dg:DataGridTemplateColumn.CellTemplate>
                </dg:DataGridTemplateColumn> 
```

现在的问题是 datagridrow 有交替背景。我希望 datagridrow 中的组合框使用与 datagridrow 中的文本框列相同的背景。Also when the datagridrow is selected, the combobox should be highlighted in the same color as the rest of the row. 如何做到这一点？谢谢

```
<Style x:Key="DataGridCellStyle" TargetType="{x:Type dg:DataGridCell}">
    <Setter Property="ContextMenu" Value="{DynamicResource cellContextMenu}" />
</Style>
<Style x:Key="DataGridRowStyle"  TargetType="{x:Type dg:DataGridRow}">
    <Style.Triggers>
        <Trigger Property="AlternationIndex" Value="1" >
            <Setter Property="Background" Value="Beige" />
        </Trigger>
    </Style.Triggers>
    <Setter Property="Margin" Value="0 2 0 2" />            
</Style>
<Style x:Key="DataGridStyle" TargetType="{x:Type dg:DataGrid}">
    <Setter Property="AlternationCount" Value="2" />
    <Setter Property="RowStyle" Value="{StaticResource DataGridRowStyle}" />
    <Setter Property="CellStyle" Value="{StaticResource DataGridCellStyle}" />
</Style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:27:06.653

您可以尝试在您的to中设置`Background`属性。`Combobox``DataTemplate``Transparent`

# sql - 如何粉碎列名以及 XML 中的数据

> ID：15535453
> 
> 赞同：1
> 
> 时间：2013-03-20T21:50:43.733
> 
> 标签：sql, xml, tsql, sql-server-2012, shred

我有一个 XML，它有一个带有列名的标题组和一个带有属于这些列的实际数据的数据组。

示例 XML：

```
<headerGroup> 
   <data> 
      <string>Column 1</string> 
   </data> 
   <data> 
      <string>Column 2</string> 
   </data> 
</headerGroup> 
<dataGroup> 
   <data> 
      <string> abcd </string> 
   </data> 
   <data> 
      <double> 1234</double> 
   </data> 
</dataGroup> 
<dataGroup> 
   <data> 
      <string> xyz</string> 
   </data> 
   <data> 
       <double> 78945</double> 
   </data> 
</dataGroup> 
```

我需要将此 xml 分解为包含这些列名和相应数据的表。预期输出：

```
Column 1      Column 2
------------- ------------------- 
abcd           1234 
xyz           78945 
```

列名和数据不共享相同的标签，因此无法将它们相互关联。

请记住，列名是可变的并且可以更改。

提前致谢。

# ios - iOS 可伸缩菜单

> ID：15535455
> 
> 赞同：0
> 
> 时间：2013-03-20T21:50:51.093
> 
> 标签：ios, xcode, menu

我目前正在开发一个包含音乐播放器的应用程序。到目前为止，它有一个播放、暂停和一个显示当前正在播放的歌曲的选择歌曲按钮。现在，玩家总是在屏幕上。我想让它在页面中间有一个按钮，这样当用户点击它时，就会出现带有播放、暂停和选择歌曲按钮/图标的整个媒体播放器。当他们再次单击该中间按钮时，它将隐藏这些图标。

如果有人能指出我正确的方向，无论是已经发布的教程，还是其他讨论（我真的找不到任何讨论），那就太棒了！

注意：我不是要制作 facebook 使用的弹出菜单。此菜单/音频播放器将在当前视图上水平展开/缩回

先感谢您！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:57:25.737

听起来您需要查看视图对象的 .hidden 属性（允许您使视图可见/不可见），以及可能使用 .frame 属性在屏幕上移动视图的能力（设置位置、高度/宽度）。

如果没有关于您要达到的效果的更详细信息，很难说更多。如果您使用界面构建器来设置要显示的视图/UI 对象，您可以简单地在界面构建器中将基本视图设置为隐藏，然后当用户单击您的按钮时，为该视图设置 .hidden=NO。

注意：为了能够像这样将所有内容显示/隐藏为一个单元，我假设您在界面构建器中使用单个 UIView 对象作为容器（大小并放置在您想要的位置），然后将您的控制器按钮添加为子-该单个视图内的对象。这允许您通过为包含视图设置 .hidden 属性来显示/隐藏所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:01:56.687

我不确定你在寻找什么样的视觉效果，但我想你已经说过了——把它们隐藏起来。

你可以通过几种方式做到这一点。

一种简单的方法是将这些元素放在他们自己的视图中。使用情节提要或 xib 文件。将您想要隐藏的按钮和控件显示在视图中。

然后在您的视图控制器中创建对该视图的引用。称它为控件视图。

```
 @property (strong,nonatomic) IBOutlet UIView *controlsView; 
```

确保连接该视图。

然后当按下按钮时，只需隐藏整个视图：

```
 self.controlsView.hidden = YES; 
```

再次按下时，显示它：

```
 self.controlsView.hidden = NO; 
```

如果您想要更平滑的外观和感觉，请将其包装在这样的动画中：

```
 //to hide
  [UIView animateWithDuration:2 animations:^{
       [self.controlsView setAlpha:0];
  } completion {
       self.controlsView.hidden = YES;
  }];

  //to show
  self.controlsView.alpha = 0;
  self.controlsView.hidden = NO;
  [UIView animateWithDuration:2 animations:^{
       [self.controlsView setAlpha:1.0];
  } completion {

  }]; 
```

希望有帮助

# core-data - 在表格视图控制器中选择行时的 TabBar Segue

> ID：15535458
> 
> 赞同：0
> 
> 时间：2013-03-20T21:51:01.183
> 
> 标签：core-data, uitabbarcontroller, segue

我已经在我的表格视图控制器中设置了一个 segue，用于按下添加按钮。现在我想在用户选择新添加的对象时再进行一次转场。到目前为止，我的代码如下所示：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"Add Vehicle Segue"])
    {
        NSLog(@"Setting RootViewController as a delegate of AddViewController");

        AddViewController *addViewController = segue.destinationViewController;
        addViewController.delegate = self;
        addViewController.managedObjectContext = self.managedObjectContext;
    } 
```

我想我需要添加一个 else if next 来处理标签栏 segue 但不知道该怎么做。

选项卡栏视图也只是在那里显示两个选项卡，所以我不相信我会使用对核心数据的引用来执行 segue。

提前致谢。！

[我的故事板流程](http://i.stack.imgur.com/cgKBJ.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T08:51:19.927

如果您不想将值传递给下一个视图控制器或在执行 segue 之前执行任何需要完成的操作，而只是显示选项卡栏，那么您不需要在`prepareForSegue:sender:`方法中添加任何内容。如果您在执行 segue add 和 else 条件时确实必须做一些事情，因为只有两个 segue 并在 else 块中编写您的代码。

# jquery - 将对话框设置为模态并附加到表单会导致对话框也成为模态

> ID：15535460
> 
> 赞同：0
> 
> 时间：2013-03-20T21:51:03.417
> 
> 标签：jquery, asp.net, jquery-ui

标题是不言自明的；当我将对话框附加到表单并将其设置为模态时，它也会使对话框成为模态。使用 jQuery UI - v1.10.0

```
$("#dialog").dialog({
    autoOpen: false,
    resizable: false,
    modal: true,
    hide: "puff",
    appendTo: "form",
    width: '350px'
}); 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-07T09:53:40.747

[https://stackoverflow.com/a/14787020](https://stackoverflow.com/a/14787020)

它对我有用。

```
.ui-dialog
{
    z-index: 101;
} 
```

# mysql - 如何从一个表中对 MYSQL 中的一系列行求和，匹配另一个表中的信息以获得结果

> ID：15535462
> 
> 赞同：0
> 
> 时间：2013-03-20T21:51:12.483
> 
> 标签：mysql, sql, group-by, sum

```
SELECT table2.*, 
       (SELECT Sum(qtde) 
        FROM   table1 
        WHERE  table1.cnes = table2.cnes 
               AND table1.procedimento = table2.procedimento 
               AND table1.mes = table2.mes 
               AND table1.ano = table2.ano 
        GROUP  BY cnes, 
                  procedimento, 
                  ano, 
                  mes) AS soma 
FROM   table2 
```

此代码在 Access 中运行良好。

我有两张桌子。

表 1 有以下列：`CNES, PROCEDIMENTO, MES, ANO, QTDE`

它可能包含这样的信息（我无法改变这个事实，我从另一个软件获取信息）

```
+------+--------------+-----+-----+------+
| CNES | PROCEDIMENTO | MES | ANO | QTDE |
+------+--------------+-----+-----+------+
| C1   | P1           | M1  | A1  |   12 |
| C1   | P1           | M1  | A1  |    3 |
| C1   | P1           | M1  | A1  |    5 |
| C1   | P2           | M1  | A1  |    4 |
| C1   | P2           | M1  | A1  |    4 |
| C1   | P2           | M1  | A1  |    3 |
| C1   | P3           | M1  | A1  |    4 |
| C2   | P2           | M1  | A1  |    5 |
| C2   | P2           | M1  | A1  |    4 |
| C2   | P1           | M1  | A1  |    3 |
+------+--------------+-----+-----+------+ 
```

QTDE = 手术数量 (PROCEDIMENTO)，来自医院 (CNES)，在一个月 (MES) 和一年 (ANO) 内完成

因此，要知道从一家医院到一个月的手术数量，我需要搜索所有行并将该月的所有行相加......

表 2 有以下列：`CNES, PROCEDIMENTO, NOME, MES, ANO, META`

此表包含医院在一个月内需要执行的程序数量（META）和程序的实际名称（NOME。PROCEDIMENTO 是一个数字，但我将其存储为字符串 [code]）

因此，在 Access 中工作的我的查询将从上面的示例中执行此操作

查询1

```
+------+--------------+------+-----+-----+------+------------+
| CNES | PROCEDIMENTO | NOME | MES | ANO | META | SUM(QTDE)  |
+------+--------------+------+-----+-----+------+------------+
| C1   | P1           | N1   | M1  | A1  |   23 |         20 |
| C1   | P2           | N2   | M1  | A1  |   20 |         11 |
| C1   | P3           | N3   | M1  | A1  |   04 |          4 |
| C2   | P2           | N2   | M1  | A1  |   05 |          9 |
| C2   | P1           | N1   | M1  | A1  |   01 |          3 |
+------+--------------+------+-----+-----+------+------------+ 
```

如果你仔细观察，你会发现最后一列是那个月的数量总和，所以我可以用它来看看医院是否做了它应该在那个月做的手术数量。

除此之外，我的查询没有这样做，但我希望它这样做......我需要另一列来显示 % (SUM(QTDE)/META)。但是我需要使超过 100% 的 %% 成为 100% ......而且我需要小心除以零问题......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:27:40.193

我认为这在 MySQL 5.5.30 中运行良好：

```
select *, 
 if(meta = 0 or soma > meta, 100, (soma/meta)*100) Percent
from
(
 SELECT table2.*, 
   (SELECT Sum(qtde) 
    FROM   table1 
    WHERE  table1.cnes = table2.cnes 
           AND table1.procedimento = table2.procedimento 
           AND table1.mes = table2.mes 
           AND table1.ano = table2.ano 
    GROUP  BY cnes, 
              procedimento, 
              ano, 
              mes) AS soma
FROM   table2) TMP; 
```

# linux - 使用校验和标记共享库

> ID：15535465
> 
> 赞同：0
> 
> 时间：2013-03-20T21:51:32.400
> 
> 标签：linux, libraries, checksum, gentoo

如何使用构建 ID 标记 ELF 库？我下载了一个预编译库，其中包含一个 sha1 总和：

```
user@localhost ~/tmp $ file foo.so.0
foo.so.0: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, BuildID[sha1]=0x7e3374eb34cafb69d3dca8b126f4aa33d44bb465, stripped

user@localhost ~/tmp $ ldd foo.so.0
linux-vdso.so.1 (0x00007fff955b1000)
libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f436d3c9000)
libc.so.6 => /lib64/libc.so.6 (0x00007f436d022000)
/lib64/ld-linux-x86-64.so.2 (0x0000003000000000) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T18:37:25.120

来自[http://fedoraproject.org/wiki/RolandMcGrath/BuildID](http://fedoraproject.org/wiki/RolandMcGrath/BuildID)

> **ld：新选项 --build-id**：
> 
> 这为 ld 添加了一个选项，用于合成具有 SHT_NOTE 类型和标志 SHF_ALLOC（只读数据）的 .note.gnu.build-id 部分，其中包含 ELF 注释标头和构建 ID 位。然后它进入链接，就好像它是第一个目标文件的一部分一样（因此它可以由链接器脚本放置或合并）。构建 ID 位被确定为 ld 在写出链接文件之前所做的最后一件事。您可以给 --build-id=style 选择 md5、uuid（128 个随机位）或 0xabcdef（您选择的十六进制字节）。只是 --build-id 默认为 md5，它根据文件中的所有 ELF 标头位和部分内容计算 128 位 MD5 签名——即，在 ELF 文件有意义的内容集中唯一的 ID 并且相同当输出文件本来是相同的。

Linux binutils-2.17.50.0.17 版本在 f8test1 中包含此内容。

# cuda - CUDA：如何计算网格大小

> ID：15535467
> 
> 赞同：0
> 
> 时间：2013-03-20T21:51:33.250
> 
> 标签：cuda

当编写一个内核时，它将对一维数组的一个元素进行操作，具有可以从 2 到 100 百万的大维度 N，或者在具有相同维度 N 的多个一维数组的一个具有相同索引的元素上，什么是计算内核网格大小的最佳方法吗？特别是，以下是最佳方式：

CPU部分：

```
cudaSetDevice(device);

cudaGetDeviceProperties(&deviceProp, device);

max_threads_per_block = deviceProp.maxThreadsPerBlock;
number_CUDA_cores = _ConvertSMVer2Cores(deviceProp.major, deviceProp.minor) * deviceProp.multiProcessorCount; 
```

GPU部分：

```
if (N <= number_CUDA_cores) {
  blocks            = N;
  threads_per_block = 1;
}
else {
  blocks            = number_CUDA_cores;
  threads_per_block = (N + number_CUDA_cores - 1) / number_CUDA_cores;

  if (threads_per_block > max_threads_per_block) {
    blocks            = (N + max_threads_per_block - 1) / max_threads_per_block;
    threads_per_block = max_threads_per_block;    
  }
}

kernel<<<blocks, threads_per_block>>>( ..... ) 
```

同样，在 K20 或 K20x 上，这必须适用于从 2 到 100 百万的 N 大小，甚至更好。

如果出现以下情况，答案是否会有所不同：

1）内核大多是直接代码

2) 内核有许多 if 语句，它们在执行时会出现分歧（这就是为什么我试图让块尽可能小）。

# android - 使用 getResources().getIdentifier 对 4 个按钮进行平方

> ID：15535471
> 
> 赞同：1
> 
> 时间：2013-03-20T21:51:44.480
> 
> 标签：android, android-layout

我想在表格布局正方形中制作 4 个按钮。

按钮看起来像这样（id 最多为 4）：

```
<Button
        android:id="@+id/button1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_column="0"
        android:background="@drawable/tile_selector"
        android:text="Button1" /> 
```

到目前为止一切看起来都很好。现在我想获取每个 Button 的 witdh 并将该值设置为它的高度。

我的代码：

```
@Override
public void onWindowFocusChanged(boolean hasFocus) {

    for (int i = 0; i <= 4; i++) {

        String buttonID = "button" + i;
        int resID = getResources().getIdentifier(buttonID, "id", getPackageName());
        Button b = (Button) findViewById(resID);
        int width = b.getWidth();
        b.setHeight(width);
    }

} 
```

但这崩溃了……为什么？

请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:04:25.853

尝试使您的按钮如下

```
Button[] buttons; 
for(int i=0; i<4; i++) {
{
 String buttonID = "button" + (i+1);

 int resID = getResources().getIdentifier(buttonID, "id", getPackageName());
 buttons[i] = ((Button) findViewById(resID));
 //set your height and width as you are doing.
} 
```

希望它有效...

# javascript - Javascript滑块动态更改变量

> ID：15535472
> 
> 赞同：2
> 
> 时间：2013-03-20T21:51:50.110
> 
> 标签：javascript, jquery, html, css, html5-canvas

到目前为止，我在 codepen 上得到了什么：

[http://codepen.io/Shane24/pen/cEGsb](http://codepen.io/Shane24/pen/cEGsb)

当您将滑块移动到变量中时，我需要保存出现在输入框中的值。

非常感谢任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:03:43.760

该问题的最简单答案是您可以从滑块的处理程序中设置变量

```
 slide: function( event, ui ) {
    $('amount1').val( ui.value );
    // This is the value that you just dragged the slider to, there it is,
    // in a variable
    x = ui.value;
  } 
```

在不知道您需要什么的情况下，[我创建了一个示例，该示例应该向您展示一个工作示例](http://codepen.io/anon/pen/uoIAc)，其中我从滑块中提取值并将其应用于画布中圆圈的颜色。此代码适用于您最初发布的 HTML

```
function drawOnCanvas () {
   var rgb =[
       $('#slider-1').slider("value"),
       $('#slider-2').slider("value"),
       $('#slider-3').slider("value")
   ];
   var c = document.getElementById("myCanvas2");
   var ctx = c.getContext("2d");
   var color = "rgb("+ rgb.join(',') + ")" ;
   ctx.fillStyle = color;
   ctx.beginPath();
   ctx.arc(100, 100, 100, 0, Math.PI*2, true);
   ctx.closePath();
   ctx.fill();
}

function createSlider(slider, boundTextField) {
   slider.slider({
      orientation: "vertical",
      range: "min",
      min: 0,
      max: 255,
      value: 0,
      slide: function( event, ui ) {
        boundTextField.val( ui.value );
        drawOnCanvas();
      }
  })
}

$(function() {
    createSlider($( "#slider-1" ), $( "#amount1" ));
    createSlider($( "#slider-2" ), $( "#amount2" ));
    createSlider($( "#slider-3" ), $( "#amount3" ));    
}); 
```

# oracle - 在 Oracle 的外部查询中无法访问列别名

> ID：15535474
> 
> 赞同：1
> 
> 时间：2013-03-20T21:51:56.903
> 
> 标签：oracle, union, alias

```
select k.Val, sum(k.Cnt) "Cnt" from 
(
(select a.Env_Location "Val", count( a.VolumeID ) "Cnt"
    from DTree
    join ZCOP_APLNG_Documents a on
     DTree.DataID = a.DataID and DTree.VersionNum = a.VersionNum
    where
     DTree.OwnerID =  -2111 and
     DTree.SubType not in ( 0, 136 ) and
     a.Env_Location is not NULL
     group by a.Env_Location
     )

union
     (select
     b.Env_Location "Val",  count( b.VolumeID ) "Cnt"
    from DTree
    join ZCOP_APLNG_Corr b on
     DTree.DataID = b.DataID and DTree.VersionNum = b.VersionNum
    where
     DTree.OwnerID = -2111 and
     DTree.SubType not in ( 0, 136 ) and
     b.Env_Location is not NULL
     group by b.Env_Location
     )
 ) k     
    group by k.Val 
```

谁能帮我完成这项工作。显示错误 Val 或 Cnt 是无效标识符。我们不能为列使用一些列别名吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:58:07.257

如果您想使用[区分大小写的标识符](https://stackoverflow.com/questions/563090/oracle-what-exactly-do-quotation-marks-around-the-table-name-do/563126#563126)（几乎总是一个坏主意），那么对该标识符的每个引用都需要区分大小写。在您的情况下，`"Val"`and`"Cnt"`都是区分大小写的标识符，因此您每次都需要使用区分大小写的语法来引用它们。就像是

```
SELECT k."Val", sum(k."Cnt") "Cnt" from 
   ...
GROUP BY k."Val" 
```

在绝大多数情况下，您真的不想使用区分大小写的别名。你通常会得到更好的服务

```
SELECT k.val, sum(k.cnt) cnt from 
(
  SELECT a.env_location val, count( a.volumeID ) cnt
  ...
  UNION 
  SELECT b.env_location val, count( b.volumeID) cnt
  ...
) k
 GROUP BY k.val 
```

# javascript - 如何将 highchart 系列转换为从 0 开始

> ID：15535477
> 
> 赞同：0
> 
> 时间：2013-03-20T21:52:12.827
> 
> 标签：javascript, highcharts

在我一直在开发的图表中，我希望我的两个系列都从 0 开始。目前，标题为“收入”的系列从零开始，但标题为“成本”的系列从第一次计算开始。这是我的推动方程中的错误，还是有办法将系列“成本”转移到一个刻度上，以便它们都从零开始？这应该可以帮助您了解我的问题：http: [//jsfiddle.net/nlem33/L5cY6/11/](http://jsfiddle.net/nlem33/L5cY6/11/)

```
newdata.push(((++j * ++j) / 2) * selected * units); 
```

# git - 我从 .ssh 文件夹中删除了 known_hosts 文件，但无法拉入或推送 BitBucket 存储库

> ID：15535486
> 
> 赞同：12
> 
> 时间：2013-03-20T21:52:37.993
> 
> 标签：git, ssh, key, bitbucket

我犯了一个错误，删除了“.ssh”文件夹中的“known_hosts”文件！现在我无法拉入或推入 BitBucket 存储库。

我该如何解决？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-20T22:17:27.897

尝试执行：

```
ssh -T git@bitbucket.org 
```

它会给你一个消息，比如：

```
The authenticity of host 'bitbucket.org (207.223.240.181)' can't be established.
RSA key fingerprint is 97:8c:1b:f2:6f:14:6b:5c:3b:ec:aa:46:46:74:7c:40.
Are you sure you want to continue connecting (yes/no)? yes 
```

验证主机指纹后说`yes`（详见文末）。

然后你应该得到这个警告，你可以安全地忽略它：

```
Warning: Permanently added 'bitbucket.org,207.223.240.181' (RSA) to the list of known hosts.
conq: logged in as tuxdude.

You can use git or hg to connect to Bitbucket. Shell access is disabled. 
```

尝试再次运行`git pull`or ，这次它应该可以工作了。`git push`

注意：我假设您仍然`.ssh/id_rsa`安全地拥有您的文件，这是您用于 SSH 身份验证的私钥。

# 验证主机指纹

正如@Pascal_dher 指出的那样，如果您不验证主机的指纹（使用一些您可以依赖的带外方法），您可能会成为中间人攻击的受害者。对于 bitbucket，信息[可在此处获得](https://confluence.atlassian.com/bitbucket/use-the-ssh-protocol-with-bitbucket-cloud-221449711.html#UsetheSSHprotocolwithBitbucketCloud-KnownhostorBitbucket'spublickeyfingerprints)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T22:15:56.970

在[“将 ssh 与 BitBucket 一起使用”页面](https://confluence.atlassian.com/display/BITBUCKET/Using+the+SSH+protocol+with+Bitbucket)中，下一次使用 ssh 应该重新创建该`known_hosts`文件：

> Bitbucket 主机只允许 Git 和 Mercurial 建立 SSH 连接。
> 首次使用 SSH URL 访问 Bitbucket 时，您的 SSH 客户端会检查 Bitbucket 主机是否为已知主机。如果主机不在您的`~/.ssh/known_hosts`文件中，SSH 会警告您正在将 Bitbucket 主机添加到已知主机：

```
$ hg clone ssh://hg@bitbucket.org/newuserme/mquotefork testkey
The authenticity of host 'bitbucket.org (207.223.240.182)' can't be established.
RSA key fingerprint is 97:8c:1b:f2:6f:14:6b:5c:3b:ec:aa:46:46:74:7c:40.
Are you sure you want to continue connecting (yes/no)? 
```

> 如果您查看存储的已知主机的内容，您会发现实际密钥以 base64 编码格式存储：

```
bitbucket.org,207.223.240.182 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAubiN81eDcafrgMeLzaFPsw2kNvEcqTKl/VqLat/MaB33pZy0y3rJZtnqwR2qOOvbwKZYKiEO1O6VqNEBxKvJJelCq0dTXWT5pbO2gDXC6h6QDXCaHo6pOHGPUy+YBaGQRGuSusMEASYiWunYN0vCAI8QaXnWMXNMdFP3jHAJH0eDsoiGnLPBlBp4TNm6rYI74nMzgz3B9IikW4WVK+dc8KZJZWYjAuORU3jc1c/NPskD2ASinf8v3xnfXeukU0sJ5N6m5E8VLjObPEO+mN2t/FZTMZLiFqPWc/ALSqnMnnhwrNi2rbfg/rd/IpL8Le3pSBne8+seeFVBoGqzHM9yXw== 
```

因此，只需使用 ssh 地址（或仅 ssh 命令）就足以再次触发该消息。

# php - 跟踪失败的登录尝试

> ID：15535489
> 
> 赞同：1
> 
> 时间：2013-03-20T21:53:00.017
> 
> 标签：php, security, session, passwords, brute-force

这个问题本质上与语言无关，但就我而言，我正在为任何想知道的人使用[PHP 。](http://php.net/)

我想跟踪用户登录尝试失败的次数，以便在`X`尝试失败后显示[验证](http://en.wikipedia.org/wiki/CAPTCHA)码。这样做的唯一目的是防止暴力攻击。它不一定是一种非常安全的方式，只要够烦人就可以延迟任何暴力破解的人。

我正在考虑创建一个会话变量`$_SESSION['failedLoginAttempts']`，并在每次检测到失败的登录尝试时增加它。攻击者仍然可以更换浏览器或删除他的 cookie 以继续进行，但这会使他（即他用来执行暴力破解的任何工具）每次尝试多浪费几秒钟，因此尝试次数会大大增加降低。

从每秒几次攻击到每分钟两次攻击将是理想的，那么攻击将可以忽略不计。

这种方法是正确的还是我错过了什么？另外，在这些情况下，最佳做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:55:51.107

您最好将其记录在附加到用户 ID 的数据库中。这是因为坚定的攻击者不会使用网络浏览器进行暴力破解。用几乎任何语言构建一个脚本非常简单，该脚本会重复登录尝试并完全忽略 cookie，或者在每次尝试后重置 cookie。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-04T17:55:09.627

另外请记住，如果您将密码加密存储在数据库中。

PHP 或 MySQL 应该接受用户输入并对其进行加密。

例如（不是真实且不安全的代码）

```
$query = "SELECT * FROM user WHERE user = " . $_POST['username'] . " AND password " . sha512($_POST['password']); 
```

如果您的服务器可以在 post 请求中占用多达 8 Mb 的数据怎么办。该攻击者可以发布 1 Mb 作为密码，尝试对加密进行 DDOS 以保持服务器的 CPU 处于高负载状态。

# java - GWT RPC：发送纯文本密码是否安全

> ID：15535493
> 
> 赞同：0
> 
> 时间：2013-03-20T21:53:19.460
> 
> 标签：java, gwt

我有一个关于如何通过线路从 GWT Web 应用程序向服务器发送密码的问题。

我的客户使用 HTTPS 与服务器通信。我的理解是 GWT RPC 使用 HTTP POST 进行通信。所以我认为使用 GWT RPC 发送纯文本密码是可以的。

我错了吗？是否有任何其他选项可以在 GWT 客户端和服务器之间安全地发送密码？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T06:07:54.030

不会有问题，因为您已经习惯使用 HTTPS。

[如果您仍然有一个狭窄的优势，那么您可以使用名为GWT-Crypto](http://code.google.com/p/gwt-crypto/)的第三方轻量级库以安全的方式发送密码等字符串 ..帐号。

它使用[TripleDesCipher](http://gwt-crypto.googlecode.com/svn-history/r47/trunk/javadoc/com/googlecode/gwt/crypto/client/TripleDesCipher.html)使用字节数组密钥（只有您知道）来加密您的字符串。

这是一个[例子](http://www.mooreds.com/wordpress/archives/529)，不完全是这里的一些相关[问题](https://stackoverflow.com/questions/14618865/forget-password-link-using-gwt/14620975#14620975)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T06:21:07.067

您是对的，可以使用 GWT RPC 发送纯文本密码 这可能会有所帮助 1）[GWT/Javascript 客户端密码加密](https://stackoverflow.com/questions/3570623/gwt-javascript-client-side-password-encryption) 2）[具有 SSL 安全性的 GWT](https://stackoverflow.com/questions/4142436/gwt-with-ssl-security)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T22:10:13.190

GWT 与任何其他浏览器应用程序没有什么不同。几乎身份验证系统使用相同的方法：使用 POST 通过 HTTPS 发送密码。

# ruby-on-rails - 使用 Tomcat 问题部署“WAR”

> ID：15535496
> 
> 赞同：0
> 
> 时间：2013-03-20T21:53:40.623
> 
> 标签：ruby-on-rails, ruby, jruby, tomcat7, war

我在用：

1.  Ubuntu 12.04
2.  JRuby 1.7.2
3.  导轨 3.2.12
4.  雄猫 7.0.26

我已成功运行我的应用程序

```
rails server 
```

命令并在**127.0.0.1:3000**上使用我的演示应用程序。

我已经安装了**warble** gem并使用

```
warble 
```

在我的应用程序目录中生成我已部署的 .war 文件。不幸的是，当我尝试使用**127.0.0.1:8080/depot/**访问我的应用程序时，我收到以下错误：

> org.jruby.exceptions.RaiseException: (NameError) 无法在 org.jruby.javasupport.JavaClass.for_name(org/jruby/javasupport/JavaClass.java:1227) 加载 Java 类 com.ibm.db2.jcc.DB2Driver ... ......

所以，我相信应用程序无法找到指定的驱动程序，但我应该如何部署它？

此外，以这种方式使用 Tomcat，我的应用程序是否可以从远程 PC 上看到？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T09:14:30.290

1.  您是否已将 db2 数据库驱动程序安装到 Tomcat 共享资源文件夹中？或者它们是作为 .war 的一部分部署的？
2.  简单回答是不。127.0.0.1 总是路由到本地主机；您需要在 TomCat 配置中定义一个新的虚拟主机，以便将您的应用程序暴露给外部世界。

# c# - 循环通过 XML 节点

> ID：15535498
> 
> 赞同：1
> 
> 时间：2013-03-20T21:53:46.020
> 
> 标签：c#, .net, xml-parsing, document, whmcs

我正在从 XML 格式的网站中提取一些数据，当没有连续的节点时它工作正常，但我无法弄清楚如何在有节点时循环它们。我得到的数据看起来像......

```
 <whmcsapi> 
  <action>gettickets</action> 
  <numreturned>1</numreturned> 
  <tickets> 
   <ticket>  
    <tid>557168</tid> 
    <name><![CDATA[Array]]></name> 
    <subject><![CDATA[Test Ticket]]></subject> 
    <message><![CDATA[This is a test ticket>
   <ticket>
   <ticket>
    <tid>557168</tid> 
    <name><![CDATA[Array]]></name> 
    <subject><![CDATA[Test Ticket]]></subject> 
    <message><![CDATA[This is a test ticket>
   <ticket> 
```

如何循环并从每个节点读取数据？我现在的代码如下...

```
 public List<Ticket> Get_Tickets()
    {
        Dictionary<string, string> args = new Dictionary<string, string>();
        args.Add("status", "All Active Tickets");

        string data = Get_Data("gettickets", args);
        XDocument doc = XDocument.Parse(data);

        //var support_tickets = doc.Descendants("ticket").Select(ticket => new
        List<Ticket> support_tickets = (from x in doc.Descendants("ticket") select new Ticket
        {
            ID = x.Element("id").Value,
            TicketID = x.Element("tid").Value,
            DeptID = x.Element("deptid").Value,
            UserID = x.Element("userid").Value,
            Name = x.Element("name").Value,
            Email = x.Element("email").Value,
            Subject = x.Element("subject").Value,
            Message = x.Element("message").Value,
        }).ToList();

        return support_tickets;
    } 
```

票务类...

```
public class Ticket
{
    public string ID;
    public string TicketID;
    public string DeptID;
    public string UserID;
    public string Name;
    public string Email;
    public string CC;
    public string Subject;
    public string Message;
    public string Status;
    public string Priority;
    public DateTime Date;
    public DateTime LastResponse;
    public IPAddress IP;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T22:06:12.023

```
List<Ticket> supportTickets = 
    (from x in doc.Descendants("ticket")
     select new Ticket
     {
         ID = x.Element("id").Value,
         TicketID = x.Element("tid").Value,
         DeptID = x.Element("deptid").Value,
         UserID = x.Element("userid").Value,
         Name = x.Element("name").Value,
         Email = x.Element("email").Value,
         Subject = x.Element("subject").Value,
         Message = x.Element("message").Value,
     }).ToList(); 
```

你可以试试这段代码。如果您尝试取回不存在的 Element 的值，它将引发异常。

# java - 将 imageview 设置为导致崩溃的图像

> ID：15535499
> 
> 赞同：0
> 
> 时间：2013-03-20T21:53:48.070
> 
> 标签：java, android, imageview

当我尝试设置任何 imageview 图像（setImageBitmap 或 setImageView）时，活动会崩溃，它会在除一个 getview 之外的任何地方执行此操作。

我正在尝试获取一个 imageview 数组，我可以在我的适配器中为我的 gridview 使用它（问题标记为“这里的问题”）

```
package joshpike.hsh.hsh_game;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;

import android.annotation.SuppressLint;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Point;
import android.os.Bundle;
import android.view.Display;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.ViewGroup;
import android.view.Window;
import android.view.WindowManager;
import android.widget.BaseAdapter;
import android.widget.GridView;
import android.widget.ImageView;

public class DisplayActivity extends MainActivity
{

    int screenTileWidth = 3;
    int nativeTileSize = 256;
    int tileSize;
    int numberColumn;
    int numberRow;
    int floorNum;

    ImageView[][] topGridArray = null;
    ImageView[][] bottomGridArray = null;

    //sets tilesize, numberColumn and numberRow
    @SuppressLint("NewApi")
    public void setGridVars()
    {
        //set tileSize 
        Display display = getWindowManager().getDefaultDisplay();
        Point size = new Point();
        int screenWidth;

        if (android.os.Build.VERSION.SDK_INT >= 13)
        {
            display.getSize(size);
            screenWidth = size.x;
        }
        else
        {
            screenWidth = display.getWidth();
        }

        tileSize = screenWidth / screenTileWidth;

        //set numberColumn and numberRow
        try
        {
            String dataFilePath = "floors/" + floorNum + "/FloorData.txt";
            InputStream dataInputStream = getAssets().open(dataFilePath);
            BufferedReader reader = new BufferedReader(new InputStreamReader(dataInputStream));

            String line = reader.readLine();
            line = reader.readLine();
            numberColumn = Integer.parseInt(line);
            line = reader.readLine();
            numberRow = Integer.parseInt(line);
            dataInputStream.close();
        }
        catch (IOException e) 
        {
            System.out.println("exception found in try/catch in DisplayActivity.setGridVars method");
        }

        for(int x = 0; x < numberColumn ; x++ )
        {
            for(int y = 0; y < numberRow ; y++ )
            {
                ///***PROBLEM HERE***///
                bottomGridArray[x][y].setImageBitmap(currentImageView("bottom", x, y));
                topGridArray[x][y].setImageBitmap(currentImageView("top", x, y));
            }
        }

    }

    //returns the one imageView for gridViewForadapter 
    public Bitmap currentImageView(String layer, int X, int Y ) 
    {
        try 
        {
            Bitmap returnBitmap = null;
            String imgDirectory = "floors/" + floorNum + "/" + layer + "/" + X + "," + Y + ".png";

            InputStream imageInputStream = getAssets().open(imgDirectory);
            returnBitmap = BitmapFactory.decodeStream(imageInputStream);
            imageInputStream.close();
            return returnBitmap;

        } 
        catch (IOException e) 
        {
            System.out.println("exception found in try/catch in DisplayActivity.currentImageView method");
            return null;
        }

    }

    public int returnGridCord (int position, char whatCord)
    {
        position = position + 1;

        float rowFromTop = (float)  position / numberColumn;

        if (rowFromTop != Math.round(rowFromTop))
        {
            rowFromTop = ((float) Math.ceil( rowFromTop));
        }

        int returnY = Math.abs( (int)rowFromTop - numberRow);
        int returnX = (position - ( ( (int)rowFromTop -1 ) * numberColumn) ) - 1;

        System.out.println(position + ":" + returnX + "x" + returnY);
        if (whatCord == 'X')
        {
            return returnX;
        }
        else
        {
            return returnY;
        }
    }

    public class ImageAdapter extends BaseAdapter 
    {

        private Context mContext;

        // create a new ImageView for each item referenced by the Adapter
        public View getView(int position, View convertView, ViewGroup parent) 
        {
            ImageView imageView;
            if (convertView == null) 
            {  
                // if it's not recycled, initialize some attributes
                imageView = new ImageView(mContext);
                imageView.setLayoutParams(new GridView.LayoutParams(tileSize, tileSize));
                imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
                imageView.setPadding(0, 0, 0, 0);
            } 
            else 
            {
                imageView = (ImageView) convertView;
            }

            System.out.println("endish of getview");    

            imageView.setImageResource(R.drawable.ic_launcher);
            return imageView;

        }

        public ImageAdapter(Context c) 
        {
            mContext = c;
        }

        @Override
        public int getCount() 
        {
            return numberColumn * numberRow;
        }

        @Override
        public Object getItem(int position) 
        {
            return null;
        }

        @Override
        public long getItemId(int position) 
        {
            return 0;
        }

    }

    // Inflate the menu; this adds items to the action bar if it is present.
    //makes the options menu
    @Override
    public boolean onCreateOptionsMenu(Menu menu) 
    {
        getMenuInflater().inflate(R.menu.display, menu);
        return true;
    }

    //what happens if you select items from the options menu
    @Override
    public boolean onOptionsItemSelected(MenuItem item)
    {
        switch (item.getItemId() )
        {
            case R.id.miniMap:

            return true;
        }
        return super.onOptionsItemSelected(item);
    }

    //called when activity is started for first time either for first time or after destoryed
    @Override
    protected void onCreate(Bundle savedInstanceState) 
    {
        this.requestWindowFeature(Window.FEATURE_NO_TITLE);
        this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
        super.onCreate(savedInstanceState);
        setContentView(R.layout.display);
        setGridVars();

        System.out.println("DisplayActivity test about to start");     
        //ImageAdapter test = null;
        //returnGridCord(0,"X");

        GridView bottomMapGrid = (GridView)findViewById(R.id.bottomMapGrid);
        bottomMapGrid.setNumColumns(numberColumn); 
        bottomMapGrid.setColumnWidth( tileSize );
        bottomMapGrid.setStretchMode( GridView.NO_STRETCH ) ;   
        bottomMapGrid.setAdapter(new ImageAdapter(this));

        System.out.println("DisplayActivity onCreate done");        
    }

    //called when Activity goes from paused to active
    @Override
    protected void onResume()
    {
        super.onResume();
        System.out.println("DisplayActivity onResume done");
    }

    //called when Activity goes from active to paused
    @Override
    protected void onPause()
    {
        super.onPause();
        System.out.println("DisplayActivity onPause done");

    }

    //called when Activity goes from paused to stopped
    @Override
    protected void onStop()
    {
        super.onStop();
        System.out.println("DisplayActivity onStop done");

    }

    //called when Activity goes from stopped to destroyed
    @Override
    protected void onDestroy()
    {
        super.onDestroy();
        System.out.println("DisplayActivity onDestroy done");

    }

    //called when Activity has been stopped, is going to be paused then active
    @Override
    protected void onRestart()
    {
        super.onRestart();
        System.out.println("DisplayActivity onRestart done");

    }

    //called when Activity is transitioning to paused either for first time or after it has been stopped
    @Override
    protected void onStart()
    {
        super.onStart();
        System.out.println("DisplayActivity onStart done");

    }

} 
```

日志猫：

```
03-20 17:16:43.437: I/System.out(22850): MainActivity onCreate done
03-20 17:16:43.437: I/System.out(22850): MainActivity onStart done
03-20 17:16:43.437: I/System.out(22850): MainActivity onResume done
03-20 17:16:43.848: D/TextLayoutCache(22850): Using debug level: 0 - Debug Enabled: 0
03-20 17:16:44.088: D/libEGL(22850): loaded /system/lib/egl/libGLES_android.so
03-20 17:16:44.168: D/libEGL(22850): loaded /system/lib/egl/libEGL_mali.so
03-20 17:16:44.208: D/libEGL(22850): loaded /system/lib/egl/libGLESv1_CM_mali.so
03-20 17:16:44.218: D/libEGL(22850): loaded /system/lib/egl/libGLESv2_mali.so
03-20 17:16:44.358: D/OpenGLRenderer(22850): Enabling debug mode 0
03-20 17:16:48.973: I/System.out(22850): MainActivity onPause done
03-20 17:16:49.974: D/OpenGLRenderer(22850): Flushing caches (mode 0)
03-20 17:16:50.674: I/System.out(22850): MainActivity onCreate done
03-20 17:16:50.915: D/AndroidRuntime(22850): Shutting down VM
03-20 17:16:50.915: W/dalvikvm(22850): threadid=1: thread exiting with uncaught exception (group=0x40aa8210)
03-20 17:16:51.005: E/AndroidRuntime(22850): FATAL EXCEPTION: main
03-20 17:16:51.005: E/AndroidRuntime(22850): java.lang.RuntimeException: Unable to start activity ComponentInfo{joshpike.hsh.hsh_game/joshpike.hsh.hsh_game.DisplayActivity}: java.lang.NullPointerException
03-20 17:16:51.005: E/AndroidRuntime(22850):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1967)
03-20 17:16:51.005: E/AndroidRuntime(22850):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1992)
03-20 17:16:51.005: E/AndroidRuntime(22850):    at android.app.ActivityThread.access$600(ActivityThread.java:127)
03-20 17:16:51.005: E/AndroidRuntime(22850):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1158)
03-20 17:16:51.005: E/AndroidRuntime(22850):    at android.os.Handler.dispatchMessage(Handler.java:99)
03-20 17:16:51.005: E/AndroidRuntime(22850):    at android.os.Looper.loop(Looper.java:137)
03-20 17:16:51.005: E/AndroidRuntime(22850):    at android.app.ActivityThread.main(ActivityThread.java:4448)
03-20 17:16:51.005: E/AndroidRuntime(22850):    at java.lang.reflect.Method.invokeNative(Native Method)
03-20 17:16:51.005: E/AndroidRuntime(22850):    at java.lang.reflect.Method.invoke(Method.java:511)
03-20 17:16:51.005: E/AndroidRuntime(22850):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:823)
03-20 17:16:51.005: E/AndroidRuntime(22850):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:590)
03-20 17:16:51.005: E/AndroidRuntime(22850):    at dalvik.system.NativeStart.main(Native Method)
03-20 17:16:51.005: E/AndroidRuntime(22850): Caused by: java.lang.NullPointerException
03-20 17:16:51.005: E/AndroidRuntime(22850):    at joshpike.hsh.hsh_game.DisplayActivity.setGridVars(DisplayActivity.java:85)
03-20 17:16:51.005: E/AndroidRuntime(22850):    at joshpike.hsh.hsh_game.DisplayActivity.onCreate(DisplayActivity.java:235)
03-20 17:16:51.005: E/AndroidRuntime(22850):    at android.app.Activity.performCreate(Activity.java:4465)
03-20 17:16:51.005: E/AndroidRuntime(22850):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
03-20 17:16:51.005: E/AndroidRuntime(22850):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1931)
03-20 17:16:51.005: E/AndroidRuntime(22850):    ... 11 more
03-20 17:16:56.510: I/Process(22850): Sending signal. PID: 22850 SIG: 9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:26:05.833

你永远不会初始化`bottomGridArray`. 也不`topGridArray`是，就此而言。（查看[基本 Java 教程中的这个主题，了解如何以及为什么需要初始化数组](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)）

在你的行之前

```
for(int x = 0; x < numberColumn ; x++ )
    {
        for(int y = 0; y < numberRow ; y++ ) 
```

插入

```
bottomGridArray = new ImageGrid[numberColumn][numberRow];
topGridArray = new ImageGrid[numberColumn][numberRow]; 
```

请注意：您的代码可能会遇到很多麻烦。您可能应该看看 Google 对[您 UI 中位图](http://developer.android.com/training/displaying-bitmaps/display-bitmap.html)的建议。

# r - 使用 apply 或 plyr 独立地打乱矩阵的列

> ID：15535506
> 
> 赞同：2
> 
> 时间：2013-03-20T21:54:21.743
> 
> 标签：r, plyr, apply, sample

我在 R 中有一个矩阵，不需要做一个 for 循环，我想随机打乱行，但对于每一列都是独立的。

IE，

```
A=cbind(c(1,2,3),c(4,5,6)) 
```

我想要一个新的矩阵，让我们说 A.shuffle 其中第 1 列 c(1,2,3) 和第 2 列 c(4,5,6) 是独立随机随机洗牌的。

例如，

```
A.shuffle = cbind(c(1,3,2), c(6,4,5)) 
```

即，在第 1 列中，随机洗牌改变了 2 和 3 的位置，而在第 2 列中，不同的随机洗牌将 6 到 4、4 到 5 和 5 到 6 的位置。

在不需要循环的情况下在 R 中做到这一点的好方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-20T22:02:37.613

这个怎么样？

```
> apply(A, 2, sample) 
```

# shell - s3cmd Amazon s3 仅更新元数据

> ID：15535509
> 
> 赞同：2
> 
> 时间：2013-03-20T21:54:30.423
> 
> 标签：shell, amazon-s3, s3cmd

我在 S3 上有几 GB 的文件，我需要为所有这些文件批量更新元数据。我知道 s3cmd 可以在传输文件时更新元数据：

`s3cmd -m text/html --add-header='Content-Encoding: gzip' put [files] s3://...`

但是我不想将文件重新传输到 S3。s3cmd 可以**只**更新密钥的元数据而不传输文件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:55:01.213

s3cmd 将来可能会这样做： [https ://github.com/s3tools/s3cmd/issues/37](https://github.com/s3tools/s3cmd/issues/37)

# php - 来自返回 Object 的 api 调用的数据的手动分页

> ID：15535510
> 
> 赞同：0
> 
> 时间：2013-03-20T21:54:32.517
> 
> 标签：php, api, pagination, laravel

我是 Laravel 的新手，我正在做一个测试项目，它将通过 curl 获取一些执行 API 调用的记录。我能够得到一个对象，我准备在我的控制器上处理它，如下所示：

```
$results = App::get_data($date);

$tasks = Paginator::make($results->data, count($results->data), 5); 
```

我对手动分页的实际工作方式感到困惑，我在 $results->data 上有 10 个项目，我已经在我的视图中打印了这些项目，包括链接，但分页不起作用。手动分页是否适用于这种设置，我不在数据库上进行交互，而是通过 curl 从特定的 API 调用中提取数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-17T10:26:37.383

Laravel 中的 Paginator 类最初旨在与 Eloquent ORM 一起使用，例如：

```
User::all()->paginate($itemsPerPage); 
```

但是，要手动创建 Paginator，您使用了正确的方法，并且没有明确记录，但是 Paginator::make() 不会自动为您分割数组，您也必须手动执行此操作。即（假设 $results->data 是一个数组）。

```
$itemsPerPage = 6;
$currentPage = 2;

$slicedResults = array_slice($results->data, $itemsPerPage * $currentPage, $itemsPerPage);
Paginator::make($slicedResults, $totalItems, $itemsPerPage); 
```

上面的示例将为您提供第 3 页中的 6 个项目。

# javascript - Javascript mouseover mouseout 菜单

> ID：15535511
> 
> 赞同：1
> 
> 时间：2013-03-20T21:54:33.743
> 
> 标签：javascript, css, menu

我试图让这个 javascript 菜单在哪里工作，当我将鼠标悬停在 AAA 上时，它的子菜单显示，而在 BBB 上，它的子菜单显示。

它被实现为一个javascript，它切换#subnav1 和#subnav2 css 可见性，其中两者相互重叠。

但是，似乎只有 BBB 鼠标悬停才能正常工作，我怀疑是因为 subnav2 位于 subnav1 之上，但是即使弄乱 z-index 也不能解决问题。知道吗？

![在此处输入图像描述](../Images/bb7fd59cb320d0aa9515c79603663116.png)

下面是代码..我留下了css样式，让它看起来像一个菜单，希望sscce不会太长

```
<html>
    <head>
    <style>
    #nav {
    float:left;
    height:20px;
    width:50%;
    font-size:.8em;
    margin:10px 0 0 20%;
    }

    #nav li,#subnav1 li,#subnav2 li {
    display:inline;
    }

    #nav ul li a,#subnav1 ul li a,#subnav2 ul li a {
    color:#000;
    text-decoration:none;
    margin:0 10px 0 0;
    }

    #nav ul,#subnav1 ul,#subnav2 ul {
    list-style-type:none;
    margin:0;
    padding:0;
    }

    #subnav1,#subnav2 {
    width:100%;
    height:100%;
    position:absolute;
    top:0;
    left:0;
    }

    #subnavs {
    background:none repeat scroll 0 0 #ccc;
    position:relative;
    float:left;
    height:20px;
    width:60%;
    font-size:.8em;
    margin:0 0 0 20%;
    padding:3px 0 0 10px;
    }
    </style>
    </head>
    <body>
     <div id="nav">
<ul>
<li><a href="index.php">Home</a></li>
<li onmouseover="showAAA(true, 'subnav1')" onmouseout="showAAA(false, 'subnav1')"><a>AAA</a></li>
<li onmouseover="showAAA(true, 'subnav2')" onmouseout="showAAA(false, 'subnav2')"><a>BBBB</a></li>
</ul>
</div>
<div id="subnavs">
<div id="subnav1" onmouseover="showAAA(true, 'subnav1')" onmouseout="showAAA(false, 'subnav1')">
<ul style="display: none; z-index: 10;">
<li><a>AAAAAAAA1</a></li>
<li><a>AAAAAAAA2</a></li>
<li><a>AAAAAAAA3</a></li>
<li><a>AAAAAAAA4</a></li>
</ul>
</div>
<div id="subnav2" onmouseover="showAAA(true, 'subnav2')" onmouseout="showAAA(false, 'subnav2')">
<ul style="display: none; z-index: -10;">
<li><a>BBBBBBBB1</a></li>
<li><a>BBBBBBBB2</a></li>
<li><a>BBBBBBBB3</a></li>
<li><a>BBBBBBBB4</a></li>
</ul>
</div>
</div>
    </body>
    <script type="text/javascript">
            function showAAA(show, subnavid) 
            {
            var subNav1 = document.getElementById(subnavid);
            var ull = subNav1.getElementsByTagName("ul");
            for (var i = 0, ii = ull.length; i < ii; i++) 
            {
                if(show) 
                {
                  ull[i].style.display = "block";
                  ull[i].style.zIndex = 10;
                }
                else 
                {
                  ull[i].style.display = "none";
                  ull[i].style.zIndex = -10;
                }
            }
            };
</script>
</html> 
```

# android - Android 开发 查找联系人

> ID：15535513
> 
> 赞同：0
> 
> 时间：2013-03-20T21:54:46.160
> 
> 标签：android, contacts

所以如果我有一个用户输入的联系人姓名的字符串，我怎样才能找到联系人信息？我想在代码中完成这一切，没有 GUI 而不是 ContactPicker。谢谢你的帮助。

# alfresco - 是否可以在 Alfresco 中替换二进制文件的内容？如果没有，是否可以替换整个文件？

> ID：15535514
> 
> 赞同：0
> 
> 时间：2013-03-20T21:54:48.650
> 
> 标签：alfresco

是否可以在 Alfresco 中替换二进制文件的内容？如果没有，是否可以替换整个文件？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T07:39:07.223

内容只是 cm:content 类型节点上的一个属性，所以是的，这是可能的。事实上，每次您在 Alfresco 中编辑文件的内容时，内容都会被替换。它只是选择使用什么技术的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-27T08:57:12.207

它应该可以帮助您：

```
ContentWriter writer = contentService.getWriter(nodeRef, ContentModel.PROP_CONTENT, true);

writer.putContent(inputStream); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-25T13:38:21.767

我想下面是另一种方法。

```
ContentData content  = ContentData.createContentProperty("My content.");

nodeService.setProperty(nodeRef, ContentModel.PROP_CONTENT, content); 
```

# django - django 表单在视图中获取字段输出

> ID：15535515
> 
> 赞同：0
> 
> 时间：2013-03-20T21:54:49.133
> 
> 标签：django, django-forms, django-views

我有几个字段的模型表单按预期工作。现在，出于特定原因，我需要查看表单字段，但在查看`'EditPostForm' object has no attribute 'about'`时出现错误`mydata1 = form.about`。但是关于场当然存在。`form.data.about`也不会工作等。所以我怎么能得到它？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:15:35.657

如果您的表单有与之关联的实例，您可以尝试

```
post = EditPost.objects.get(id=id)
form1 = EditPostForm(instance=post)
form1.instance.about 
```

根据您在下面的评论，如果您使用的是[ManyToMany 关系](https://docs.djangoproject.com/en/1.5/topics/db/queries/#many-to-many-relationships)，您可以获得的值为

```
>>> bf = BookForm(instance=book)
>>> bf.instance.authors
<django.db.models.fields.related.ManyRelatedManager object at 0x0000000004658B38>
>>> bf.instance.authors.all() #which returns a query set of related objects
[<Author: Kotian>]
>>> bf.instance.authors.all()[0]
<Author: Kotian>
>>> bf.instance.authors.all()[0].name
u'Kotian' 
```

或基于您如何定义多对多

```
>>> af = AuthorForm(instance=author)
>>> af.instance.name
u'MyName'
>>> af.instance.book_set
<django.db.models.fields.related.ManyRelatedManager object at 0x0000000004658C18>
>>> af.instance.book_set.all() # returns queryset
[<Book: Book object>, <Book: Book object>]
>>> af.instance.book_set.all()[0] #accessing first object here
<Book: Book object>
>>> af.instance.book_set.all()[0].name
u'Lepord' 
```

# java - 将 java ClassLoaders 添加到堆而不是 perm gen

> ID：15535517
> 
> 赞同：0
> 
> 时间：2013-03-20T21:54:54.090
> 
> 标签：java, memory-management, permgen

我们有一个应用程序可以生成数千个 Java 类加载器和类，然后再让它们被垃圾回收。我们很确定没有类加载器泄漏，但是我们得到了 permgen 错误（即使有，这个问题也与任何潜在的泄漏正交）。

有没有办法指定某些 ClassLoader 及其加载的类放在堆中而不是 perm gen 中？

我们在 Linux 上使用 Oracle JDK Java 6。

* * *

编辑：看起来 Java 8 将不再有 PermGen。它将被元空间取代。

[http://java.dzone.com/articles/java-8-permgen-metaspace](http://java.dzone.com/articles/java-8-permgen-metaspace)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:57:23.930

当然，您会遇到 perm gen 错误——这是类加载器放置类的地方。你会期待什么？

您可以将它们映射到字节缓冲区，就像 Java NIO 所做的那样，但它们不会放在堆上。

在采取特殊措施之前，您应该尝试增加您的烫发大小。您需要多少烫发空间？使用 Visual VM 对其进行分析并查看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:46:47.933

> 有没有办法指定某些 ClassLoader 及其加载的类放在堆中而不是 perm gen 中？

AFAIK，没有办法做到这一点。AFAIK，permgen 分配发生在 JVM 运行时的深处，你无法做到这一点。（我不认为类加载器本身在 permgen 中。我认为它只是代表类及其代码的 JVM 的内部数据结构。）

如果您的应用程序真的必须以这种方式工作，我认为您别无选择，只能使 permgen 足够大。（显然，您*还*应该检查真正的问题不是 permgen 泄漏。）

然而，如果你的应用程序需要生成大量的类和类加载器，我觉得它的架构相当奇怪。我会看看它正在做的事情是否不能以其他方式完成。

# git - 我必须推送什么到 github 来更新我的 octopress 博客？

> ID：15535518
> 
> 赞同：1
> 
> 时间：2013-03-20T21:55:01.517
> 
> 标签：git, github, blogs, octopress

我刚刚创建了一个托管在 github 上的博客。现在我在我的机器上进行了一些本地定制，现在想把它们带到 github。在文档（[http://octopress.org/docs/deploying/github/](http://octopress.org/docs/deploying/github/)）中，octopress 说您必须将生成的内容提交到主分支。

叫我笨蛋，但我不明白。我必须承诺什么？我的源代码或我的 _deploy 文件夹中的代码？我必须将我的内容推送到哪个分支？

谁能帮我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:55:55.217

您需要推送`public`. 除非你明确地做一些事情来复制数据`public`到`_deploy`，`_deploy`否则将是空的。

您可以通过使用 rake 任务`setup_github_pages`一次和之后通过`rake deploy`.

# ruby-on-rails - 即使在运行 rake assets 之后，生产错误“application.css 未预编译”：预编译没有错误

> ID：15535520
> 
> 赞同：0
> 
> 时间：2013-03-20T21:55:05.830
> 
> 标签：ruby-on-rails, deployment, capistrano, passenger, production

由于最长时间的预编译错误，我无法部署我的 rails 项目。找到了一个清除 cap deploy 错误的脚本，但现在生产中的 Rails 抛出 500 并说 application.css 没有预编译。

这是纲要：

设置 - Ruby 2.0.0p0、Rails 3.2.13、Twitter-Bootstrap、Capistrano 部署到 VPS 与乘客和 Nginx

原始命令：

```
cap deploy 
```

错误：

```
* executing "cd -- /var/www/scotch/releases/20130320194644 && /home/deploy/.rvm/gems/ruby-2.0.0-p0@global/bin/bundle exec rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile && cp -- /var/www/scotch/shared/assets/manifest.yml /var/www/scotch/releases/20130320194644/assets_manifest.yml"
servers: ["198.211.112.227"]
[198.211.112.227] executing command
** [out :: 198.211.112.227] rake aborted!
** [out :: 198.211.112.227] FATAL:  role "deploy" does not exist 
```

我的`deploy.rb`文件：

```
require "rvm/capistrano"
require "bundler/capistrano"
set :bundle_cmd, "/home/deploy/.rvm/gems/ruby-2.0.0-p0@global/bin/bundle"
set :bundle_dir, "/home/deploy/.rvm/gems/ruby-2.0.0-p0/gems"

set :rvm_ruby_string, :local
set :application, "scotch"
set :user, 'deploy'
set :domain, '198.211.112.227'
set :applicationdir, "/var/www/scotch"

set :scm, 'git'
set :repository,  "ssh://deploy@198.211.112.227/var/www/scotch.git"
#set :git_enable_submodules, 1 # if you have vendored rails
set :scm_passphrase, ""
set :branch, 'master'
set :git_shallow_clone, 1
set :scm_verbose, true

# roles (servers)
role :web, domain
role :app, domain
role :db,  domain, :primary => true

# deploy config
set :deploy_to, applicationdir
set :deploy_via, :export

# additional settings
default_run_options[:pty] = true  # Forgo errors when deploying from windows
 ssh_options[:keys] = %w(/home/user/.ssh/id_rsa)            # If you are using ssh_keysset :chmod755, "app config db lib public vendor script script/* public/disp*"set :use_sudo, false

# Passenger
namespace :deploy do
  task :start do ; end
  task :stop do ; end
  task :restart, :roles => :app, :except => { :no_release => true } do
    run "#{try_sudo} touch #{File.join(current_path,'tmp','restart.txt')}"
  end
end 
```

帽文件：

```
load 'deploy'
# Uncomment if you are using Rails' asset pipeline
load 'deploy/assets'
load 'config/deploy' # remove this line to skip loading any of the default tasks 
```

Application.rb 包括：

```
config.assets.initialize_on_precompile = false 
```

根据 StackOverflow 上的说明：[rake assets:precompile trying to connect to database](https://stackoverflow.com/questions/8997226/rake-assetsprecompile-attempting-to-connect-to-database/8997640#8997640)

Database.yml 是为生产数据库设置的。数据库迁移就好了等。

目前只是跟着这个并添加了脚本： [加速资产：使用 Rails 3.1/3.2 Capistrano 部署预编译](https://stackoverflow.com/questions/9016002/speed-up-assetsprecompile-with-rails-3-1-3-2-capistrano-deployment)

预编译在 VPS 上工作并使用 --trace 在本地运行：

```
rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile 
```

它部署得很好，但现在我的应用程序正在提供“我们很抱歉，但出了点问题”。我的 production.log 给了我这个错误：

```
ActionView::Template::Error (application.css isn't precompiled):
4:     %meta{:content => "width=device-width, initial-scale=1.0", :name => "viewport"} 
```

应用程序/资产/样式表/application.css.scss

```
.content {
background-color: #eee;
padding: 20px;
margin: 0 -20px; /* negative indent the amount of the padding to maintain the grid system */
-webkit-border-radius: 0 0 6px 6px;
-moz-border-radius: 0 0 6px 6px;
 border-radius: 0 0 6px 6px;
-webkit-box-shadow: 0 1px 2px rgba(0,0,0,.15);
-moz-box-shadow: 0 1px 2px rgba(0,0,0,.15);
 box-shadow: 0 1px 2px rgba(0,0,0,.15);
 } 
```

编辑 - 显示新错误：由于某种原因，现在它甚至没有到达，我的 production.log 文件显示了这一点，即使 rake db:migrate 在生产中工作正常并且 database.yml 都是正确的：

```
ActiveRecord::StatementInvalid (PG::Error: ERROR:  permission denied for relation     reviews
: SELECT  "reviews".* FROM "reviews"  LIMIT 30 OFFSET 0):
app/models/review.rb:10:in `search'
app/controllers/reviews_controller.rb:6:in `index' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:51:19.887

我建议将您的 css 代码从清单文件`application.css`移到（例如）`custom.css.scss`. 在清单文件中，您必须声明`css`要在应用程序中使用的资产，如下所示：

```
*= require_self
*= require your_assets 
```

有关资产管道管理的更多详细信息，您可以在[此 Rails 指南](http://guides.rubyonrails.org/asset_pipeline.html)中找到。

# c - 关于 C 中的指针

> ID：15535521
> 
> 赞同：6
> 
> 时间：2013-03-20T21:55:08.840
> 
> 标签：c

我开始阅读一些关于 C 中指针的文章，但我有一个我不明白的例子。

该示例来自此处：[http ://en.wikibooks.org/wiki/C_Programming/Pointers_and_arrays](http://en.wikibooks.org/wiki/C_Programming/Pointers_and_arrays)

这里是：

让我们看一个稍微不同的问题。我们想要一个二维数组，但我们不需要所有的行都具有相同的长度。我们要做的是声明一个指针数组。下面的第二行将 A 声明为一个指针数组。每个指针都指向一个浮点数。这是一些适用的代码：

```
float  linearA[30];
 float *A[6];

 A[0] = linearA;              /*  5 - 0 = 5 elements in row  */
 A[1] = linearA + 5;          /* 11 - 5 = 6 elements in row  */
 A[2] = linearA + 11;         /* 15 - 11 = 4 elements in row */
 A[3] = linearA + 15;         /* 21 - 15 = 6 elements        */
 A[4] = linearA + 21;         /* 25 - 21 = 4 elements        */
 A[5] = linearA + 25;         /* 30 - 25 = 5 elements        */

 A[3][2] = 3.66;          /* assigns 3.66 to linearA[17];     */
 A[3][-3] = 1.44;         /* refers to linearA[12];           
                             negative indices are sometimes useful.
                             But avoid using them as much as possible. */ 
```

我的问题是为什么`A[0]`指针只指向五个元素而不是 ALL of `linearA`，因为数组的名称是指向其第一个成员的指针。

并且`A[1] = linearA + 5;`是连续 6 个元素 - 出于同样的原因？不`A[1]`应该是指向第 6 个成员的指针`linearA`吗？

有人可以解释我的错误在哪里吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:58:22.990

除了少数例外，在 C 中，数组名被转换为指向数组第一个元素的指针。是表达式`linearA`中的和的数组 30 ：`float`

```
A[0] = linearA; 
```

它被转换为指向`float`.

`A`是指向 的指针数组 6 `float`。的元素`A`是指向的类型指针`float`。`A[0]`指向数组的指针`float`而不是指向数组的指针也是如此。

而`A[i][j]`在 C 中等价于`*(A[i] + j)`so `A[i][j]`is a `float`（取消引用指向`float`产生 a的指针`float`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:03:17.373

`A[0]`是指向 的第一个元素的指针`linearA`。由于`linearA`是一个连续数组，因此该指针实际上允许`linearA`通过添加适当的偏移量来访问 30 个元素中的任何一个。但是，在这段代码中，您通过指向数组中的不同偏移量来模拟二维`linearA`数组。结果是类似 2D 的数组寻址：将您带到第 n 行`A[n]`的位置（即在 中的偏移量），并将您带到该行内的第 m 个元素。`linearA``A[n][m]`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T22:12:58.447

这是因为这一行设置了一个包含 6 个指针的数组`float`：

```
float *A[6]; 
```

这一行将这些指针中的*第一个设置为 30 的第一个元素*。

```
A[0] = linearA; 
```

因此 A 的每个元素都指向原始数组的一个子部分。但是，您必须分配它们-它们最初会指向随机地址。

第一个是初始地址（`&linearA[0]`），接下来的五个是以下地址。这些是可访问`A[0][0]`的`A[0][5]`。因为数组对应指针的方式，你可以一直往上走，只要不超过30。

但是您可以分配`A[n]`给您喜欢的数组的任何部分。只要它是原始数组的一部分，它就会指向该成员，以及接下来的 5 个（或者你想要的任意多个）。

例如，通过指向`A[1]`，`&linearA[6]`您将有效地设置一个二维数组（它类似于一个，但不像一个）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T22:18:17.643

> 我的问题是为什么 A[0] 是仅指向五个元素而不是所有线性 A 的指针，因为数组的名称是指向其第一个成员的指针。

您设置`A[0]`指向`linearA`哪个是数组中的第一个浮点数，`A[0]`是一个指针，因此不知道它指向的地址是什么。因此`A[0]`，它不是指向仅五个元素的指针，它指向数组的开始位置，并且不知道数组的结束位置。

> A[1] = 线性A + 5；是连续 6 个元素 - 出于同样的原因？A[1] 不应该是指向 linearA 的第 6 个成员的指针吗？

yes`A[1]`指向第六个元素，但如前所述，它是一个起始地址。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-20T23:06:26.033

[您发布的示例显示了一种称为Iliffe 向量](https://en.wikipedia.org/wiki/Iliffe_vector)的有点深奥的技术，这是在 C 中实现*锯齿状数组*的一种可能方法。锯齿状数组是一个矩阵，其中每一行都有不同的长度。

由于数组在 C 中是一维的，因此您正在创建一个`linearA`包含所有元素的单个数组，该数组被解释为一系列行，每行都有不同的大小。指针数组`A`包含指向每行第一个元素的指针，允许您使用行和列索引访问元素。

该代码显示了 C 指针和数组的几个有趣的特性：

```
linearA + 5 
```

指针算术：将整数添加到指针（或数组）会给您一个指针，该指针指向原始指针之后的*n 个元素。*

```
A[3][2] = 3.66; 
```

这种漂亮的语法使您可以将此结构视为二维矩阵。

此外，这可能是示例的要点，*指针和数组是可互换的*。这里，`A[3]`是一个指向浮点数的指针，因为`A`它被定义为一个指向浮点数的指针数组；appending`[2]`为我们提供了在原始指针指向的元素之后 2 个位置的元素。这类似于上面的指针算法，只是在这种情况下指针被取消引用。实际上，数组访问是根据指针定义的，因此`X[5]`等价于`*(X+5)`.

```
A[3][-3] 
```

这表明没有什么可以阻止您访问给定行之外的元素。在这种情况下，您正在访问元素 3所指向的位置*之前*`A[3]`的位置。这是很少需要的东西，它只在这种情况下有效，因为您将矩阵构建为具有连续元素。通常，访问数组分配范围之外的元素会使您的程序崩溃。

最后，回答你的问题：

> 并且`A[1] = linearA + 5;`是连续 6 个元素 - 出于同样的原因？不`A[1]`应该是指向第 6 个成员的指针`linearA`吗？

由于指针和数组是可互换的，`A[1]`既是指向 in 中第六个元素的指针，也是*从in*`linearA` *中*第六个元素开始的数组`linearA`。语言中没有说后者有 6 个元素长，您必须在代码中实现该逻辑。

# javascript - 引号中的 JQuery 变量值

> ID：15535523
> 
> 赞同：1
> 
> 时间：2013-03-20T21:55:26.430
> 
> 标签：javascript, jquery

我在 Jquery 中将变量值放在引号中时遇到问题：

例如：

我有一个可变颜色的 Html 颜色代码，其值为 #FFFF00。我想像这样显示变量值：“#FFFF00”。

我尝试了这样的事情，但没有奏效：

```
context.strokeStyle = "\"color\""; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T21:57:10.127

如果要显示用引号括起来的字符串，只需使用：

```
context.strokeStyle = '"' + color + '"'; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T21:57:02.797

直接使用变量即可。

```
context.strokeStyle = color; 
```

如果你想给它添加引号：

```
context.strokeStyle = "&quot;" + color + "&quot;"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:57:08.767

你不需要引号。

```
context.strokeStyle = color; 
```

应该做得很好。

# azure - 为基于 powershell 的 Azure 部署启用 IntelliTrace

> ID：15535525
> 
> 赞同：0
> 
> 时间：2013-03-20T21:55:34.310
> 
> 标签：azure, azure-powershell

使用命令 New-AzureDeployment 从 powershell 部署 azure 包时，如何启用 IntelliTrace？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T04:06:48.110

Grant 的博文早于 VS2012，我们在其中将 powershell 控件添加到 IntelliTrace。（我是 IntelliTrace 的开发经理）这为您在 VS2012 中提供了更多选择。

IntelliTrace 已获得许可，因此您可以使用新的远程收集器随时随地收集数据。但是，您只能在 VS Ultimate 中打开这些文件。

首先你需要获取独立的收集器：http: [//www.microsoft.com/en-us/download/details.aspx?id=30665](http://www.microsoft.com/en-us/download/details.aspx?id=30665)

它将删除一个 cab 文件夹，其中包含收集所需的所有位，包括 PowerShell。

您现在可以将 TS 放入您的 azure 盒子，将这些位复制下来，然后使用这些说明进行收集：http: [//msdn.microsoft.com/en-us/library/vstudio/hh398365.aspx](http://msdn.microsoft.com/en-us/library/vstudio/hh398365.aspx)

我实际上并没有尝试使用 New-AzureDeployment 添加 IntelliTrace，但由于 cab 文件中的位是可复制的，我想您只需要在您正在部署的包中包含 IntelliTrace 位。虽然这不会打开它们以直接从 VS 中的服务器资源管理器收集日志。您仍然需要使用 powershell 命令来控制集合。要从服务器资源管理器中获得控制权，您需要按照 bhavesh lad 的建议进行操作。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T03:32:45.110

我认为这不受支持，因为 IntelliTrace 仅随 VS 终极版提供。人们发布了一些工作，但不确定它是否会工作......这是该链接：http: [//blogs.msdn.com/b/granth/archive/2011/02/20/intellitrace-for-没有视觉工作室的天蓝色.aspx](http://blogs.msdn.com/b/granth/archive/2011/02/20/intellitrace-for-azure-without-visual-studio.aspx)

# c++ - 如何将迭代器推广到某种类型

> ID：15535526
> 
> 赞同：2
> 
> 时间：2013-03-20T21:55:37.763
> 
> 标签：c++, templates, generics, iterator, containers

考虑这两个函数，它们适用于 std::vector：

```
 int connectNode(GraphNode const& newNode,std::vector<GraphNode const*>::const_iterator beginCandidates, std::vector<GraphNode const*>::const_iterator endCandidates){
    int connections =0;
    for (auto iter= beginCandidates; iter!=  endCandidates; ++iter) {
      if(connectNodes(newNode,**iter)) ++connections;
    }
    return connections;
  }

  int connectNode(GraphNode const& newNode,std::vector<GraphNode>::const_iterator beginCandidates, std::vector<GraphNode>::const_iterator endCandidates){
    int connections =0;
    for (auto iter= beginCandidates; iter!=  endCandidates; ++iter) {
      if(connectNodes(newNode,*iter)) ++connections;
    }
    return connections;
  } 
```

这些函数适用于向量，但显然不适用于任何其他容器，例如集合。怎么可能一概而论。我能想到的唯一可能的解决方案是使用一些非常丑陋的 enable_if 解决方法。有直接的解决方案吗？编辑：为了更清楚：我想要两个功能，一个用于普通容器，一个用于指针容器。真正的逻辑发生在 connetNodes 内部，它需要两个引用。（注意第一个函数中的**）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:25:22.417

如前所述，使迭代器类型成为模板参数 - 这解决了泛化迭代器本身的问题。`GraphNode`对于正常值及其指针之间的差异，您可以使用重载：

```
template<class T>
T& maybe_deref(T& v){ return v; }

template<class T>
T& maybe_deref(T* p){ return *p; } 
```

只需调用它`connectNodes(newNode, maybe_deref(*iter))`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T22:00:28.407

把迭代器作为模板参数，那么你就不用担心你迭代的是什么类型的容器。

```
template<class T, class Iter>
int connectNode( GraphNode const& newNode, 
                 Iter beginCandidates, 
                 Iter endCandidates )
{
  // ...
} 
```

我没有看到`T`函数模板中的任何地方使用了其他模板参数 ()，但我假设您的真实代码在某处使用它。

此外，您可以`static_assert`将迭代器指向`GraphNode const*`using`std::iterator_traits<Iter>::value_type`

```
static_assert( std::is_same< typename std::iterator_traits<Iter>::value_type
                             GraphNode const *>::value,
               "Iterator must point to 'GraphNode const *'" ); 
```

**编辑：**

为了能够接受指向`GraphNode`或`GraphNode const *`保持函数模板签名相同的迭代器，但为调用的助手创建 2 个重载`connectNodes`

```
bool do_connectNodes( GraphNode const& newNode, GraphNode const *p )
{
  return connectNodes( newNode, *p );
}

bool do_connectNodes( GraphNode const& newNode, GraphNode& n )
{
  return connectNodes( newNode, n );
} 
```

现在，`connectNode`将`if`条件更改为

```
if( do_connectNodes(newNode,*iter) ) ++connections; 
```

并且将根据迭代器指向的内容选择正确的重载。

# prolog - Prolog 倒数规则

> ID：15535529
> 
> 赞同：1
> 
> 时间：2013-03-20T21:55:44.133
> 
> 标签：prolog

我敢肯定这是相当基本的，虽然我无法通过搜索在这里找到它。

我正在学习prolog，并找到了一个带有规则的示例：（表示邻接）

```
adj(1, 2).    adj(2, 1).
adj(1, 3).    adj(3, 1).
adj(3, 4).    adj(4, 3). 
```

现在，这让我觉得有点浪费，因为我们知道邻接是一种互惠关系，只定义每一对中的一个就足够了，然后定义：

```
adj(X, Y) :-
    adj(Y, X), !. 
```

我理解为什么这种简单化的尝试行不通；如果 X 和 Y 不相邻，它会陷入无限循环。但是，我还没有完全弄清楚如何修改它以在所有情况下工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:39:53.320

您应该引入一个替代名称并使用它来编码您的逻辑。例如

```
adj(1, 2).
adj(1, 3).
adj(3, 4).

is_adj(X,Y) :- adj(X,Y) ; adj(Y,X). 
```

# command-line - F# 关于 SharpDevelop 和命令行参数

> ID：15535530
> 
> 赞同：0
> 
> 时间：2013-03-20T21:55:44.587
> 
> 标签：command-line, f#, sharpdevelop

我试图将 SharpDevelop 4.3 用作 F# IDE。我在 SharpDevelop 论坛上问过这个问题，但已经一个星期了，我没有任何回应。当我想调试程序时，我究竟可以在哪里将命令行参数传递给通过 IDE 运行的程序？我浏览了项目选项菜单项，以及包含的所有选项卡，但我没有确定命令行参数的位置。

我也尝试使用 Xavarin，但是当我尝试创建 F# 应用程序时它立即崩溃。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T09:13:13.627

SharpDevelop 中包含的 F# 插件当前无法在您运行 F# 应用程序时设置命令行参数。项目选项下没有可用的调试选项卡。当前唯一可用的选项是修改[源代码](https://github.com/icsharpcode/SharpDevelop/tree/master/src/AddIns/BackendBindings/FSharpBinding)。

# angularjs - AngularJs - 在选择控件中过滤掉重复项

> ID：15535536
> 
> 赞同：0
> 
> 时间：2013-03-20T21:56:03.920
> 
> 标签：angularjs

我有一个轴类型的选择列表，每个类型都有一个前轴或后轴的类型属性。我似乎无法过滤掉“前”和“后”的重复词。

![在此处输入图像描述](../Images/35485d37fcc72f96615b1ac2c371296e.png)

**更新：**

html:

```
<select ng-model="axleType.Type" ng-options="type for type in uniqueTypes"> 
```

**控制器：**

```
 $scope.axleTypes = API.GetAxleTypes();

    $scope.fixedAxleTypes = [
    { "$id": "1", "Description": "I beam, telescopic type shock absorbers", "Type": "Front", "Id": 1 },
    { "$id": "2", "Description": "Full-floating banjo housing", "Type": "Rear", "Id": 2 },
    { "$id": "3", "Description": "Something Else", "Type": "Rear", "Id": 2 },
    { "$id": "4", "Description": "I beam, telescopic type shock absorbers", "Type": "Front", "Id": 4 }
    ];

    // This Works
    $scope.uniqueTypes = _.uniq(_.pluck($scope.fixedAxleTypes, 'Type'));

    // This does not
    //$scope.uniqueTypes = _.uniq(_.pluck($scope.axleTypes, 'Type'));

    // This does not
    //$scope.uniqueTypes = _.uniq(_.pluck(API.GetAxleTypes(), 'Type')); 
```

我彻底糊涂了。**是的，API 有效，我从Chrome > Network>Response 窗口**复制粘贴的上述数据

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:38:22.213

看到您在编辑中添加的错误，我确信原因是我在评论中描述的，这是在`(axleType.Type)`无法评估该表达式的上下文中使用过滤器的表达式。由于您没有在过滤器实现中使用表达式，我相信您可以完全省略它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T02:43:30.643

我猜`API.GetAxleTypes();`应该做一些异步任务，比如调用`$http`。如果是这种情况，则`$scope.axleTypes`不会是您正在寻找的数组类型。`GetAxleTypes`可以看起来与此类似。

服务定义：

```
{
   uniqueaxleTypes:[],
   GetAxleTypes = function($http,..){
     var promise = $http({
       //config
     })
     promise.then(function(response){
       this.uniqueaxleTypes = _.uniq(_.pluck(response.data, 'Type'));
     })
   }
} 
```

然后，如果您将范围变量绑定到 this `uniqueaxleTypes`，它将始终反映唯一值。

由于 `$scope.fixedAxleTypes`是硬编码值，因此可以正常工作。**

# python - 使用 Python 解码 UTF-8 文件

> ID：15535538
> 
> 赞同：1
> 
> 时间：2013-03-20T21:56:13.447
> 
> 标签：python, python-3.3, utf8-decode

好吧，所以我试图浏览有关此错误的多个帖子，但不幸的是，我要么太累而无法理解它们，要么只是在逃避我。我试图读取一个 UTF-8 编码的 txt 文件（我的 Whatsapp 聊天记录的备份）并将其转储到一个变量中（现在只是打印它），以便我以后可以对其内容进行一些拆分。但是，当我运行这个时：

```
protocol = open('C:/chat.txt', 'r', encoding='utf-8', errors='replace') #use the uft codec, and replace chars u dnt recognize instead of raising errors
print(protocol.read()) 
```

我明白了：

```
Traceback (most recent call last):
  File "C:\xx\src\main.py", line 8, in <module>
    print(protocol.read())
  File "C:\Python33\lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
UnicodeEncodeError: 'charmap' codec can't encode characters in position 0-1: character   maps to <undefined> 
```

我已经使用 codec.open() 函数阅读了一些答案，但我根本不完全确定如何使用它。所以，如果这是关于这个问题的第 100 个问题，我很抱歉，但我无法弄清楚问题到底是什么，以及如何解决它。

感谢您的耐心和您可以提供的任何答案:)

# excel - 获取组合框的选定值

> ID：15535540
> 
> 赞同：11
> 
> 时间：2013-03-20T21:56:26.503
> 
> 标签：excel, vba, combobox

我在 Excel 工作表中有数千个单元格，它们是组合框。用户将随机选择一个并填充它。

如何获取选定的 ComboBox 值？当 ComboxBoxes 被选中时，有没有办法触发一个函数（即事件处理程序）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-21T01:43:05.063

您可以使用以下更改事件，该事件将在组合框值更改时触发。

```
Private Sub ComboBox1_Change()
'your code here
End Sub 
```

您也可以使用以下方法获取所选值

```
ComboBox1.Value 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-21T13:25:36.890

如果您正在处理数据验证列表，则可以使用 Worksheet_Change 事件。右键单击带有数据验证的工作表，然后选择查看代码。然后输入：

```
Private Sub Worksheet_Change(ByVal Target As Range)

    MsgBox Target.Value

End Sub 
```

如果您正在处理 ActiveX 组合框，它会稍微复杂一些。您需要创建一个自定义类模块来连接事件。首先，创建一个名为 CComboEvent 的类模块并将此代码放入其中。

```
Public WithEvents Cbx As MSForms.ComboBox

Private Sub Cbx_Change()

    MsgBox Cbx.Value

End Sub 
```

接下来，创建另一个名为 CComboEvents 的类模块。这将保存我们所有的 CComboEvent 实例并将它们保持在范围内。将此代码放在 CComboEvents 中。

```
Private mcolComboEvents As Collection

Private Sub Class_Initialize()
    Set mcolComboEvents = New Collection
End Sub

Private Sub Class_Terminate()
    Set mcolComboEvents = Nothing
End Sub

Public Sub Add(clsComboEvent As CComboEvent)

    mcolComboEvents.Add clsComboEvent, clsComboEvent.Cbx.Name

End Sub 
```

最后，创建一个标准模块（不是类模块）。您需要代码将所有组合框放入类模块中。您可以将其放在 Auto_Open 过程中，以便在打开工作簿时发生，但这取决于您。

您需要一个公共变量来保存 CComboEvents 的实例。将其公开将使其及其所有子项保持在范围内。您需要它们在范围内，以便触发事件。在该过程中，遍历所有组合框，为每个组合框创建一个新的 CComboEvent 实例，并将其添加到 CComboEvents。

```
Public gclsComboEvents As CComboEvents

Public Sub AddCombox()

    Dim oleo As OLEObject
    Dim clsComboEvent As CComboEvent

    Set gclsComboEvents = New CComboEvents

    For Each oleo In Sheet1.OLEObjects
        If TypeName(oleo.Object) = "ComboBox" Then
            Set clsComboEvent = New CComboEvent
            Set clsComboEvent.Cbx = oleo.Object
            gclsComboEvents.Add clsComboEvent
        End If
    Next oleo

End Sub 
```

现在，每当更改组合框时，都会触发该事件，在本例中，将显示一个消息框。

[您可以在https://www.dropbox.com/s/sfj4kyzolfy03qe/ComboboxEvents.xlsm](https://www.dropbox.com/s/sfj4kyzolfy03qe/ComboboxEvents.xlsm)看到一个示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-21T03:06:22.913

从 ComboBox 控件获取选定值的更简单方法是：

```
Private Sub myComboBox_Change()
  msgbox "You selected: " + myComboBox.SelText
End Sub 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-21T08:45:58.853

也许您可以使用（伪代码）之类的方式以编程方式设置事件处理程序

```
sub myhandler(eventsource)
  process(eventsource.value)
end sub

for each cell
  cell.setEventHandler(myHandler) 
```

但我不知道在 VB/VBA 中实现这一点的语法，或者是否有可能。

# android - 通过 GPS Tracker 的 ToggleButton 切换服务

> ID：15535541
> 
> 赞同：0
> 
> 时间：2013-03-20T21:56:28.077
> 
> 标签：android, service, android-service, togglebutton

我目前正在编写一个应用程序，应该如下：

*   UI 仅包含一个切换按钮。如果打开，则 GPS 位置应发送到外部服务器。如果它被关闭，则不会发生任何事情。

*   如果 Button 已打开并且应用程序（活动）已关闭，则仍应发送位置，直到 Button 再次关闭。

我怎样才能做到这一点？我在 dev.google.com 和 dev.google.com 上阅读了很多主题和教程，但我无法找到解决我的问题的最佳解决方案。

我目前的做法：

**MainActivity.java**

```
public void onClick(View v) {
   if (onOffButton.isChecked()) {
      Intent startIntent = new Intent(this, LocationService.class);
      startService(startIntent);
   } else {
      stopService(new Intent(this, LocationService.class));
   }
} 
```

**定位服务.java**

```
public class LocationService extends Service implements LocationListener {

        final public static String START_ACTION = "START_LOCATION";
        final public static int NOTE_ID = 1;

        private int updateRate;

        private LocationManager locationManager;
        private NotificationManager notifyManager;

        @Override
        public IBinder onBind(Intent arg0) {
                return null;
        }

        @Override
        public void onStart(Intent intent, int startId) {
                super.onStart(intent, startId);

                // show popup message
                Toast.makeText(this, getText(R.string.start_message), Toast.LENGTH_SHORT).show();

                // display icon in status bar

                requestLocationUpdates();
        }

        private void requestLocationUpdates() {
                if(locationManager != null)
                        locationManager.removeUpdates(this);

                // get location service
                Criteria crit = new Criteria();
                crit.setPowerRequirement(Criteria.ACCURACY_FINE);
                String bestProvider = getLocationManager().getBestProvider(crit, true);
                getLocationManager().requestLocationUpdates(bestProvider, updateRate * 1000,
                                0 /* minDist */, this);

                LocationService.running = true;
        }

        @Override
        public void onDestroy() {
                super.onDestroy();
                getLocationManager().removeUpdates(this);
                notifyManager.cancel(NOTE_ID);
                Toast.makeText(this, getText(R.string.stop_message), Toast.LENGTH_SHORT).show();
                LocationService.running = false;
        }

        @Override
        public void onLocationChanged(Location location) {
                //Send Location to Server
        }

        @Override
        public void onProviderDisabled(String provider) {
                // TODO stop service, notify user
        }

        @Override
        public void onProviderEnabled(String provider) {
                requestLocationUpdates();
        }

        @Override
        public void onStatusChanged(String provider, int status, Bundle extras) {
                // TODO notify user
        }

        private LocationManager getLocationManager() {
                if (this.locationManager == null)
                        this.locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
                return this.locationManager;
        }
} 
```

我从互联网上找到的一个非常旧的 gps 跟踪器得到这个（我知道 onStart() 已被弃用，应该用 onCommandStart() 代替）我只是想知道一般方法是否好..

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T07:09:44.097

这种方法看起来不错。您只需要实现回调方法来报告您的位置。

# ruby-on-rails - 在 Rails 迁移类中这些方法（如 create_table）如何可用？

> ID：15535542
> 
> 赞同：2
> 
> 时间：2013-03-20T21:56:34.757
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

这是一个关于如何在 Ruby 中定义方法和类以及如何阅读 API 文档的问题。简而言之：方法是如何`create_table`定义/导入/继承的，因此它可以在 中使用`ActiveRecord::Migration`，代码如下：

```
class CreateProducts < ActiveRecord::Migration
  def up
    create_table :products do |t|
      t.string :name
      ... 
```

来自 Java 世界，我希望[API 文档](http://api.rubyonrails.org/)能够提供指向定义所有内容的基类或 mixin 的链接。但是，如果我`Migration`查看`create_table`. 我用谷歌在 中找到它`ActiveRecord::ConnectionAdapters::SchemaStatements`，但甚至查看了这两个文件的源代码：

[git 中的迁移](https://github.com/rails/rails/blob/d68e299167c8da07dc63a55197313b5c3396c3a4/activerecord/lib/active_record/migration.rb)
[create_table in git](https://github.com/rails/rails/blob/fa34acec20574699c2de19d97f9ae54f540fe69d/activerecord/lib/active_record/connection_adapters/abstract/schema_statements.rb)

我看不到如何`create_table`将`Migration`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:17:55.533

这些方法是在此类中动态创建的：[https ://github.com/rails/rails/blob/d68e299167c8da07dc63a55197313b5c3396c3a4/activerecord/lib/active_record/migration/command_recorder.rb](https://github.com/rails/rails/blob/d68e299167c8da07dc63a55197313b5c3396c3a4/activerecord/lib/active_record/migration/command_recorder.rb)

他们在`CommandRecorder`类中动态添加这些，然后是以下行：

```
class Migration
    autoload :CommandRecorder, 'active_record/migration/command_recorder' 
```

使其可用于迁移类。

# ruby - 在Ruby中，你如何将一个数字四舍五入到2位有效数字

> ID：15535543
> 
> 赞同：3
> 
> 时间：2013-03-20T21:56:38.920
> 
> 标签：ruby, rounding

例如，

如果我有 24987654，我需要它返回 24000000，这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:02:05.170

这是一种天真的算法：

```
n = 24987654
n / (10 ** (n.to_s.size - 2)) * (10 ** (n.to_s.size - 2)
=> 24000000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:21:24.197

这是另一种方法：

```
x -= x % (10 ** (Math.log(x, 10).to_i - 1)) 
```

在上述声明中：

1.  `Math.log(x, 10).to_i - 1`确定要删除的无意义数字的数量
2.  `x % (10 ** number_of_insignificant_digits)`计算数字的微不足道的部分
3.  从初始数字中减去步骤 2 中的值，现在`x`包含结果

这是该程序的在线测试：http: [//ideone.com/trSNOr](http://ideone.com/trSNOr)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-05T01:03:31.280

```
n = 24987654
n.round((n.to_s.size - 2)*-1) #=> 25000000
n.ceil((n.to_s.size - 2)*-1) #=> 25000000
n.floor((n.to_s.size - 2)*-1) #=> 24000000

n = 24187654
n.round((n.to_s.size - 2)*-1) #=> 24000000
n.ceil((n.to_s.size - 2)*-1) #=> 25000000
n.floor((n.to_s.size - 2)*-1) #=> 24000000 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T00:16:28.107

只是另一种方式：

```
n = 24987654
a = n.to_s[0, 2] + '0' * ((a.to_s.length)-2) 
```

将输出字符串：

```
=> "24000000" 
```

您可以将其转换为整数调用该`.to_i`方法

# c++ - 在编译时比较静态字段指针

> ID：15535545
> 
> 赞同：3
> 
> 时间：2013-03-20T21:56:49.033
> 
> 标签：c++, static-assert

我有一个从类 A 派生的类 B。A 声明了一个静态字段 f，而 B 可能声明了一个类似的同名字段。以下不起作用：

```
struct A { static int f; };
struct B : A { static int f; }; // A::f is different from B::f
struct C : A {}; // A::f is the same as C::f
BOOST_STATIC_ASSERT((&A::f != &B::f));
BOOST_STATIC_ASSERT((&A::f == &C::f)); 
```

尽管理论上可以在编译时检查这些断言，但它们是不允许的，因为常量表达式不能获取地址。

有没有办法在编译时进行这种检查？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T00:24:51.940

尝试将静态变量的定义放在静态断言的范围内。

这适用于 gcc 4.7.2：

```
struct A { static int f; };
struct B : A { static int f; };
struct C : A {};

int A::f;
int B::f;

static_assert(&A::f != &B::f, "B");
static_assert(&A::f == &C::f, "C");

int main()
{
} 
```

编译：

```
$ g++ -std=gnu++11 test.cpp
$ ./a.out 
```

# matlab - 在 weka 中找到真正的正数的确切数字

> ID：15535546
> 
> 赞同：1
> 
> 时间：2013-03-20T21:56:56.040
> 
> 标签：matlab, statistics, machine-learning, classification, weka

在 WEKA 中，我可以很容易地从混淆矩阵中找到 TP 率和真实分类实例总数，但是有没有办法查看 tp 和/或 tn 的确切数量？

你知道在 matlab-anfis 中找到这些值的任何方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:02:58.280

由于您提到了 MATLAB，我假设您正在使用 Weka 库的[Java API](http://weka.wikispaces.com/Use+Weka+in+your+Java+code)以编程方式构建分类器。

在这种情况下，您可以使用[weka.classifiers.Evaluation](http://weka.sourceforge.net/doc.dev/weka/classifiers/Evaluation.html)类评估模型，该类提供各种统计信息。

假设您已经`weka.jar`在 java 类路径上有文件（请参阅`javaaddpath`函数），下面是 MATLAB 中的示例：

```
%# data
fName = 'C:\Program Files\Weka-3-7\data\iris.arff';
loader = weka.core.converters.ArffLoader();
loader.setFile( java.io.File(fName) );
data = loader.getDataSet();
data.setClassIndex( data.numAttributes()-1 );

%# classifier
classifier = weka.classifiers.trees.J48();
classifier.setOptions( weka.core.Utils.splitOptions('-C 0.25 -M 2') );
classifier.buildClassifier( data );

%# evaluation
evl = weka.classifiers.Evaluation(data);
pred = evl.evaluateModel(classifier, data, {''});

%# display
disp(classifier.toString())
disp(evl.toSummaryString())
disp(evl.toClassDetailsString())
disp(evl.toMatrixString())

%# confusion matrix and other stats
cm = evl.confusionMatrix();

%# number of TP/TN/FP/FN with respect to class=1 (Iris-versicolor)
tp = evl.numTruePositives(1);
tn = evl.numTrueNegatives(1);
fp = evl.numFalsePositives(1);
fn = evl.numFalseNegatives(1);

%# class=XX is a zero-based index which maps to the following class values
classValues = arrayfun(@(k)char(data.classAttribute.value(k-1)), ...
    1:data.classAttribute.numValues, 'Uniform',false); 
```

输出：

```
J48 pruned tree
------------------

petalwidth <= 0.6: Iris-setosa (50.0)
petalwidth > 0.6
|   petalwidth <= 1.7
|   |   petallength <= 4.9: Iris-versicolor (48.0/1.0)
|   |   petallength > 4.9
|   |   |   petalwidth <= 1.5: Iris-virginica (3.0)
|   |   |   petalwidth > 1.5: Iris-versicolor (3.0/1.0)
|   petalwidth > 1.7: Iris-virginica (46.0/1.0)

Number of Leaves  :     5

Size of the tree :  9

Correctly Classified Instances         147               98      %
Incorrectly Classified Instances         3                2      %
Kappa statistic                          0.97  
Mean absolute error                      0.0233
Root mean squared error                  0.108 
Relative absolute error                  5.2482 %
Root relative squared error             22.9089 %
Coverage of cases (0.95 level)          98.6667 %
Mean rel. region size (0.95 level)      34      %
Total Number of Instances              150     

=== Detailed Accuracy By Class ===

                 TP Rate  FP Rate  Precision  Recall   F-Measure  MCC      ROC Area  PRC Area  Class
                 1.000    0.000    1.000      1.000    1.000      1.000    1.000     1.000     Iris-setosa
                 0.980    0.020    0.961      0.961    0.961      0.955    0.990     0.969     Iris-versicolor
                 0.960    0.010    0.980      0.980    0.980      0.955    0.990     0.970     Iris-virginica
Weighted Avg.    0.980    0.010    0.980      0.980    0.980      0.970    0.993     0.980     

=== Confusion Matrix ===

  a  b  c   <-- classified as
 50  0  0 |  a = Iris-setosa
  0 49  1 |  b = Iris-versicolor
  0  2 48 |  c = Iris-virginica 
```

# django - 向页面管理添加一个字段以包含菜单项的图标

> ID：15535553
> 
> 赞同：1
> 
> 时间：2013-03-20T21:57:24.013
> 
> 标签：django, django-cms

在我的 html 模板中，我允许使用带有小方形 png 或 font-awesome 的图标：

```
<a href="#"><i class="icon-search"></i>Search</a> // using font-awesome
// or
<a href="#"><img src="images/icons/search.png">Search</a> // using images 
```

在模板 top-menu.html 中，我需要能够使用以下内容：

```
{{ child.menu_icon_font_awesome }} # in place of "icon-search"
{{ child.menu_icon_image }} # in place of "images/icons/search.png" 
```

如何将这些变量放入菜单中的子菜单节点？

另外，我如何让字段集在 admin.py 中工作（不太重要）？

我的 menu_icons 应用程序如下所示：

```
# models.py

from django.db import models
from django.utils.translation import ugettext_lazy as _
from cms.models.pagemodel import Page
from django.core.files.storage import FileSystemStorage

class OverwriteStorage(FileSystemStorage):
  """
    Deletes file of same name if exists.
  """
  def _save(self, name, content):
    if self.exists(name):
      self.delete(name)
    return super(OverwriteStorage, self)._save(name, content)

  def get_available_name(self, name):
    return name

class MenuIconFontAwesome(models.Model):
  """
    Defines Font Awesome Menu Icon
  """
  page = models.ForeignKey(Page,
                           unique=True,
                           verbose_name=_("Page"),
                           editable=False)
  menu_icon_font_awesome = models.CharField(max_length=48,
                                            verbose_name="Font Awesome Menu Icon",
                                            blank=True)

class MenuIconImage(models.Model):
  """
    Defines Image Menu Icon
  """
  page = models.ForeignKey(Page,
                           unique=True,
                           verbose_name=_("Page"),
                           editable=False)
  menu_icon_image = models.ImageField('Menu Icon Image',
                                      upload_to = 'menu_icons/',
                                      blank=True,null=True)

# admin.py
from models import MenuIconFontAwesome, MenuIconImage
from cms.admin.pageadmin import PageAdmin
from cms.models.pagemodel import Page
from django.contrib import admin

class MenuIconFontAwesomeAdmin(admin.TabularInline):
  """
    Adds field for Font Awesome Menu Icon
  """
  model = MenuIconFontAwesome
  fieldsets = (
    ('Menu Icon with Font Awesome', {
      'fields': ('menu_icon_font_awesome',),
    }),
  )

class MenuIconImageAdmin(admin.TabularInline):
  """
    Adds field for Image Menu Icon
  """
  model = MenuIconImage
  fieldsets = (
    ('Menu Icon with Uploaded Image', {
      'fields': ('menu_icon_image',),
    }),
  )

PageAdmin.inlines.append(MenuIconFontAwesomeAdmin)
PageAdmin.inlines.append(MenuIconImageAdmin)

admin.site.unregister(Page)
admin.site.register(Page, PageAdmin)

# views.py
# this is the part I cannot figure out 
```

这是使用导航修饰符提示的添加。它给出了错误，“类型对象'MenuIconFontAwesome'没有属性'menu_icon_font_awesome'”我确信我缺少一些明显的东西。

```
from menus.base import Modifier
from menus.menu_pool import menu_pool
from models import MenuIconFontAwesome, MenuIconImage

class MenuIconsMod(Modifier):
    """
    Add Menu Icons to the menu nodes
    """

    def modify(self, request, nodes, namespace, root_id, post_cut, breadcrumb):
        if post_cut:
            return nodes
        for node in nodes:
            node.menu_icon_font_awesome = MenuIconFontAwesome.menu_icon_font_awesome
            node.menu_icon_image = MenuIconImage.menu_icon_image
        return nodes

menu_pool.register_modifier(MenuIconsMod) 
```

关于字段集；我所看到的看起来像这样， http: [//imgur.com/ubSBeB3](http://imgur.com/ubSBeB3)。我只是无法排序为什么这些字段集会获得这些名称以及如何覆盖它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T23:44:48.263

看看菜单修饰符（[https://django-cms.readthedocs.org/en/2.3.5/extending_cms/app_integration.html#navigation-modifiers](https://django-cms.readthedocs.org/en/2.3.5/extending_cms/app_integration.html#navigation-modifiers)），使用 NavigationNode.attr 属性，您应该能够添加任何自定义数据.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T11:09:24.267

我不允许发表评论，所以我会尝试在这里总结一下。

您可以在模板中发布一些“您允许”的代码吗？我不确定我明白你的意思。

如果你想通过 django admin 上传图片，你需要`menu_image = models.ImageField(upload_to = '/images/')`在你的 models.py 文件中的类中有一个，然后通过说将它包含在模板中`<img src="{{ object.menu_image.url }}" alt="menu_image_description" />`。并且比在 admin.py 中写

```
from django.contrib import admin
from myproject.models import *

class MYModelNameAdmin(admin.ModelAdmin):

    list_display = ('name',)

admin.site.register(MuModelName, MyModelNameAdmin) 
```

字体是怎么回事？您可以编辑您的问题并包含您目前拥有的模板、admin.py 和 models.py 吗？

# ios - LLVM Xcode 版本 4.6.1 (4H512) 的编译器错误

> ID：15535562
> 
> 赞同：0
> 
> 时间：2013-03-20T21:57:48.987
> 
> 标签：ios, xcode, llvm, clang, llvm-clang

我们最近将 Xcode 升级到 4.6.1 时看到此错误。在此版本之前能够完美编译。对此消息有任何见解吗？似乎是 32/64 位问题？

从查看[LLVM 补丁日志](http://www.csl.cornell.edu/~fang/sw/llvm/patches/llvm-local-r175024b.patch)看来，这是 MachO 格式的不幸限制。

```
fatal error: error in backend: Section too large, can't encode r_address (0x1000005) into 24 bits of scattered relocation entry. 
```

有什么见解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T18:59:40.690

为了解决这个问题，我将 LLVM 编译级别设置为最快、最小 [-Os]。

# php - 使用外部处理在同一页面上进行 PHP 表单验证

> ID：15535563
> 
> 赞同：0
> 
> 时间：2013-03-20T21:57:48.770
> 
> 标签：php, forms, external

我正在尝试结束这个具有相同页面验证但外部处理的联系人/报价单。我已经设置了一个变量以进入表单操作，并且当表单验证时，变量/url 从同一页面更改为处理页面。但是，在填写完所有必填字段后，需要单击提交按钮两次来处理表单：将填写所有必填字段，我点击提交，页面重新加载保存的数据变量，然后当我再次点击提交，它终于通过，发送电子邮件并加载感谢页面。我在这里搜索了帖子并尝试了多种方法，但没有找到解决方案。我绝对不是 php 专家，仍然是新手，所以这可能不是完成此任务的最佳方法，但我会很感激有关如何完成此任务的任何想法。这是我所拥有的：

```
<?php

....

if (empty($Name) && empty($Company) && empty($Address1) && empty($City) && empty($State) && empty($Phone))
{
    echo '<p class="tan">The fields marked with an * are required.</p>';
$Process = 'samepageurl'; 

}

/*else if (empty($Name) || is_numeric($Name))
{
echo '<p class="tan"><b>Please enter your name.</b></p>';
}*/

else if (empty($Company) || is_numeric($Company))
{
echo '<p class="tan"><b>Please enter your company name.</b></p>';
$Process = 'samepageurl'; 

}

else if (empty($Address1) || is_numeric($Address1))
{
echo '<p class="tan"><b>Please enter your address.</b></p>';
$Process = 'samepageurl'; 

}

else if (empty($City) || is_numeric($City))
{
echo '<p class="tan"><b>Please enter your city.</b></p>';
$Process = 'samepageurl'; 

}

else if (empty($State) || is_numeric($State))
{
echo '<p class="tan"><b>Please enter your state.</b></p>';
$Process = 'samepageurl'; 

}

else if (empty($Phone) || ctype_alpha($Phone))
{
echo '<p class="tan"><b>Please enter your phone number.</b></p>';
$Process = 'samepageurl'; 

}

else if (strlen($Phone) < 10 || strlen($Phone) > 12 || ctype_alpha($Phone) || ctype_space($Phone))
{
echo '<p class="tan"><b>Please enter a phone number with an area code.</b></p>';
$Process = 'samepageurl'; 

}

else if (isset($Name) && isset($Company) && isset($Address1) && isset($City) && isset($State) && isset($Phone))
{
$Process = 'processingurl';
}
?> 

<form action="<?php echo $Process; ?>" method="post" class="print"  >
<p><input type="hidden" name="recipient" value="responses@url.com"/> 
<input type="hidden" name="subject" value="Web Site Response"/>
<input type="hidden" name="redirect" value="thankyou.html"/></p>

... form fields ...

</form> 
```

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T15:21:51.797

首先检查缺失的变量，然后提取并验证变量，然后根据它们提供内容。

```
<?php
  function verifyPostContains(&$req) {
    global $_POST;
    $missing = array();
    foreach($req as $var => $_) {
      if(!isset($_POST[$var])) {
        $missing[] = $var;
      }
    }
    return $missing;
  }

  $requirements = array('name'=>'','city'=>'','state'=>'',...);
  $missing = verifyPostContains($requirements);

  if(count($missing)>0) {
    $content = formErrorReport($missing);
    sendHeaders();
    echo $content;
    exit();
  }

  // extract, making sure to sanitize
  $name = sanitize($_POST["name"]);
  ...

  $errorHtml = array();
  // validate by reference. Effectively call testName($name).
  if(failsValidation($name, "testName")) {
    $errorHtml [] = generateError(NAME_ERROR, $name);
  } else { $requirements["name"] = $name; }
  if(failsValidation($city, "testCity")) {
    $errorHtml [] = generateError(CITY_ERROR, $city);
  } else { $requirements["city"] = $name; }
  ...

  if(count($errorHTML)>0) {
    generateErrorPage($requirements, $missing, $errorHTML);
  } else { processForm($requirements); }
?> 
```

此代码假定您具有执行需要完成的各种位的函数，并且具有一些用于生成错误 HTML 的字符串常量。

作为一个新手，您可能想在谷歌上搜索一些教程，这些教程解释了在服务器上使用 PHP 和在客户端使用 JavaScript 进行表单处理。如果您找到一个教程，它为您提供在测试数据时回显错误的代码，例如您的代码，请继续前进。这不是一个好的教程。如果您发现一个在发现一个错误后停止，请继续前进。如果您找到一个告诉您确保 JavaScript 中的值是正确的，然后说“我们已经在客户端验证了这一点，所以我们直接在 PHP 中使用这些值”，请继续前进。寻找解释的教程：

*   确保所有表单字段中都有数据，使用 JavaScript，所以提交按钮被禁用，直到所有字段都有数据。
*   确保数据符合您的标准，在 PHP 中，以便那些只是发布到您的服务器而不使用您的页面的人不会因为注入他们不应该能够做的各种有趣的东西而逃脱
*   您生成一个页面，其中解释了所有错误（如果有），并且表单重新填充了错误的数据，但突出显示为错误
*   如果没有错误，您将处理发布请求。

（如果教程解释说 POST 请求不需要实际生成页面内容作为响应，除了指示 POST 调用是被接受还是被拒绝的标头之外，奖励积分。）

# .net - 实体框架删除无键

> ID：15535564
> 
> 赞同：3
> 
> 时间：2013-03-20T21:57:50.333
> 
> 标签：.net, linq, entity-framework

我正在使用 Entity Framework 5，并且正在尝试删除没有主键的实体。我的意思是我的表甚至没有主键。

场景如下：

我有 3 个表，其流程如下：

MainTeam -> UserPerTeam <- 用户

我的 Mainteam 表的主键 ID 与表 UserPerTeam 中的 MainTeamID 相关。

我的用户表具有与表 UserPerTeam 中的用户 ID 相关的主键 ID。

UserPerTeam 具有这两个关系以及该表中需要的一些其他字段。

所以现在当我使用以下代码时，我的实体框架会因为它没有主键而中断：

```
var upt = new FighterPerTeam { UserID = userId, TeamID = teamId };
Entities.UserPerTeam.Attach(upt);
Entities.UserPerTeam.Remove(upt);
Entities.SaveChanges(); 
```

所以现在我得到了全能的错误：

无法更新 EntitySet 'UserPerTeam'，因为它有一个 DefiningQuery 并且元素中不存在支持当前操作的元素。

我只是想知道如何解决这个问题是一种安全的方法。我知道我可以使用以下代码，但我真的不喜欢使用它，因为它似乎不是实体框架。

```
 var cmd = ("Delete from UserPerTeam where userID = " + userId + " and teamId = " + teamId);
        Entities.Database.ExecuteSqlCommand(cmd); 
```

几乎忘了提到我正在使用延迟加载，并且我只想删除 UserPerTeam 表中的实体。如果您的解决方案还删除了 MainTeam 或 User 对象，那么我将无法使用它。

我欢迎所有建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T08:15:40.257

没有主键的表在实体框架中是只读的，除非存储过程映射到它们的插入、更新和删除操作。将联结表中的两列标记为数据库中的复合键。

# php - 两个不同主机之间的会话数据传输

> ID：15535567
> 
> 赞同：0
> 
> 时间：2013-03-20T21:58:02.680
> 
> 标签：php

我有两个网站托管在不同的主机 xyz.net63.net 和 abc.comli.com 我想将从 db 获取并存储在 xyz.net63.net 的 php 页面的会话中的数据传输到 abc.comli.com 的 php 页面

php 页面发送数据（在 xyz.net63.net）

```
<?php session_start();                 
    $_SESSION['customer_name'] = "test"; //data to pass
    $link = "http://abc.comli.com"; //data pass to

    //link for call update page
    echo "<br/><a href=\"$link/create_db.php\">Click here</a> to update.
 ?> 
```

php 页面接收数据（在 abc.comli.com）

```
<?php session_start();               
    $data = $_SESSION['customer_name']; //DATA APPEARS NOTHING HERE 
 ?> 
```

# ios - 如果 OSX/iOS 中的网络代理设置发生变化，有没有办法接收通知/回调？

> ID：15535571
> 
> 赞同：3
> 
> 时间：2013-03-20T21:58:08.987
> 
> 标签：ios, macos, proxy, notifications

如果 OSX/iOS（C、C++ 或 Objective C）中的网络代理设置发生变化，我想收到通知/回调吗？有没有人有如何做到这一点的例子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T02:23:50.333

使用 监控系统配置`SCDynamicStoreSetNotificationKeys()`。有关您需要注意的键，请参阅[系统配置编程指南](https://developer.apple.com/library/mac/#documentation/Networking/Conceptual/SystemConfigFrameworks/SC_UnderstandSchema/SC_UnderstandSchema.html)。请参阅`SCDynamicStoreCreateWithOptions()`如何设置`SCDynamicStore`对象以及通知回调。

# java - 如何在 Tomcat 服务器上保存和加载图像

> ID：15535573
> 
> 赞同：1
> 
> 时间：2013-03-20T21:58:20.340
> 
> 标签：java, image, tomcat, jakarta-ee

我正在编写一个 Java EE 应用程序，我尝试从 URL 获取图像，然后将其保存在我的资源文件夹中（通过 AJAX 请求）。我的问题是，如果我不重新启动服务器，我将无法显示此图像，因为它没有加载到我的服务器上。

我正在使用 Tomcat 7、Spring、Hibernate、Primeface。

这是我保存myimage的课程

```
public class ImageSaver {
    final static int SIZE=1024;

    public static void fileUrl(String fAddress, String localFileName, String destinationDir) {
        OutputStream outStream = null;
        URLConnection  uCon = null;

        InputStream is = null;
        try {
            URL url = new URL(fAddress);
            byte[] buf;
            int byteRead;
            int byteWritten=0;
            outStream = new BufferedOutputStream(new FileOutputStream(destinationDir+"\\"+localFileName));
            uCon = url.openConnection();
            is = uCon.getInputStream();
            buf = new byte[SIZE];
            while ((byteRead = is.read(buf)) != -1) {
                outStream.write(buf, 0, byteRead);
                byteWritten += byteRead;
            }
        }
        catch (Exception e) {
            e.printStackTrace();
        }
        finally {
            try {
                is.close();
                outStream.close();
            }
            catch (IOException e) {
                e.printStackTrace();
            }
        }
    }

    public static void fileDownload(String fAddress,String fileName, String destinationDir){
        int slashIndex =fAddress.lastIndexOf('/');
        int periodIndex =fAddress.lastIndexOf('.');
        //String fileName=fAddress.substring(slashIndex + 1);
        if (periodIndex >=1 &&  slashIndex >= 0 && slashIndex < fAddress.length()-1){
        }
        else{
            System.err.println("path or file name.");
        }
    }

} 
```

以及我调用函数的方式：

```
ImageSaver.fileDownload("http://www.mywebsite.com/myImage.jpg","myImage.jpg", "C:\\Users\\MyProject\\src\\main\\webapp\\resources\\images"); 
```

如何在不重新启动的情况下自动加载我上传的图片？哪个文件允许配置上传文件夹？如何 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T10:23:02.800

您不应该将动态检索到的图像写入您的 web 应用程序的文件夹中 - 这会为您带来一整类问题。相反，将它们保存到应用服务器根目录之外的文件夹中，并创建一个下载 servlet 来提供这些资源。

否则的危险是您将从外部来源检索一些 jsp 文件，将它们保存到您的应用程序服务器，并且在下载时应用程序服务器将愉快地在服务器端执行它。

假设你的 webapp 的目录对你的 webapp 是不可写的。这也将简化备份和更新：假设您需要安装更新或迁移到不同的服务器：您服务器上的应用程序将仅部分包含在其 *.war 文件中。如果有明确的资源目录，您可以独立备份（或放在网络共享驱动器上）

# sql - 查询中的 SQL SUM 和 Group By Duplicates

> ID：15535576
> 
> 赞同：0
> 
> 时间：2013-03-20T21:58:29.247
> 
> 标签：sql, function, sum, aggregate-functions, alias

这是场景：

表： **CallMain：**

Call_ID = PK (INT) 已放弃 (INT) 1 或 NULL

**呼叫保持：**

Hold_ID = PK (INT)

Call_ID = FK (INT)

开始时间 (INT)

结束时间 (INT)

CallMain 表中保持的每个呼叫可以有 1、0 或多个保持记录。每次呼叫保持时，都会创建一条由 FK 引用的记录，其中包含保持的开始时间和保持的结束时间。

现在，要在查询中返回此信息以显示呼叫及其总保持时间，我相信 SQL 如下：

```
SELECT CallMain.Call_ID, CallMain.Abandoned,  
ISNULL((CallHold.EndTime - CallHold.StartTime),0) AS HoldPeriodSeconds 
FROM CTIStatCall 
LEFT OUTER JOIN CallHold ON CallMain.Call_ID = CallHold.Call_ID 
```

此查询应返回没有与之关联的保留记录的调用记录，并应将它们作为 NULLS 返回。具有单个保留记录的呼叫正确显示。由 LEFT OUTER JOIN 返回的 NULLS 由 ISNULL() 函数管理并被替换为零，因为实际上调用没有保持时间。

我的问题是，如果一个呼叫有多个保持记录，它将在结果中出现两次，即：Call_ID、HoldPeriod

212, 254

213, 154

214, 158

214, 25

214, 10 从上面可以看出，Call 214 有多个保持记录，总共 193 条。我发现查询必须是：

```
SELECT
    CallMain.Call_ID,
    CallMain.Abandoned,  
    Sum(ISNULL((CallHold.EndTime - CallHold.StartTime), 0)) AS HoldPeriodSeconds 
FROM
    CallMain
LEFT OUTER JOIN
    CallHold
ON
    CallMain.Call_ID = CallHold.Call_ID
GROUP BY
    CallMain.Call_ID,
    CallMain.Abandoned 
```

我现在的问题是我在 MainCall 表中有更多列，它们也将被返回，CallStart、CallAns、CallEnd，这些用于计算其他一些派生值。我正在返回这些并将它们添加到 group by 子句，但它会再次显示重复值。我怎样才能解决这个问题？

我已经尝试过：

> ```
> SELECT CallMain.Call_ID, dateadd(s,CallMain.StartTime, '1970-01-01') AS StartTime,
> dateadd(s,CallMain.AnsTime, '1970-01-01') AS AnsTime, 
> dateadd(s,CallMain.EndTime, '1970-01-01') AS EndTime,
> CallMain.Abandoned,
> (CallMain.AnsTime - CallMain.StartTime) AS RingPeriod,
> SUM(ISNULL((CallHold.EndTime - CallHold.StartTime),0)) AS HoldPeriod,
> (CallMain.EndTime - CallMain.AnsTime) - ISNULL((CallHold.EndTime - CallHold.StartTime),0) AS TalkPeriod
> FROM CallMain
> LEFT OUTER JOIN
> CallHold ON CallMain.Call_ID = CallHold.Call_ID
>    GROUP BY CallMain.Call_ID, CallMain.Abandoned, CallMain.StartTime, CallMain.EndTime, CallMain.AnsTime, CallHold.EndTime, CallHold.StartTime 
> ```
> 
> 按 CallMain.Call_ID 排序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:07:47.167

正如你自己已经说过的。当您按`CallStart`, `CallAns`,分组时，您会得到多个结果`CallEnd`。这意味着对于每个`Call_ID, Abandoned`组合，这些列的唯一值超过 1 个。

您必须决定要显示哪些值。例如，您可以选择像这样取最大值：

```
SELECT
    CallMain.Call_ID,
    CallMain.Abandoned,  
    Sum(ISNULL((CallHold.EndTime - CallHold.StartTime), 0)) AS HoldPeriodSeconds,
    (MAX(CallMain.AnsTime) - MAX(CallMain.StartTime)) AS RingPeriod,
    ....
FROM
    CallMain
LEFT OUTER JOIN
    CallHold
ON
    CallMain.Call_ID = CallHold.Call_ID
GROUP BY
    CallMain.Call_ID,
    CallMain.Abandoned 
```

或者，也许更合乎逻辑，使用`SUM`您对 HoldPeriod 所做的函数。我不知道你的期望结果是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:13:17.280

这是因为你分组

```
CallHold.EndTime , CallHold.StartTime 
```

这会返回多个条目，因为您在 CallMain 中的每个条目都得到一行。这些需要从 group by 中删除，或者从 select 语句中删除，或者从使用的合适的聚合函数中删除。应该是这样的……

```
SELECT CallMain.Call_ID, dateadd(s,CallMain.StartTime, '1970-01-01') AS StartTime,
       dateadd(s,CallMain.AnsTime, '1970-01-01') AS AnsTime, 
       dateadd(s,CallMain.EndTime, '1970-01-01') AS EndTime,
       CallMain.Abandoned,
       (CallMain.AnsTime - CallMain.StartTime) AS RingPeriod,
       SUM(ISNULL((CallHold.EndTime - CallHold.StartTime),0)) AS HoldPeriod,
       (CallMain.EndTime - CallMain.AnsTime) - ISNULL((CallHold.EndTime - CallHold.StartTime),0) AS TalkPeriod
  FROM CallMain
LEFT OUTER JOIN
       CallHold ON CallMain.Call_ID = CallHold.Call_ID
GROUP BY CallMain.Call_ID, CallMain.Abandoned, CallMain.StartTime, CallMain.EndTime, CallMain.AnsTime 
```

# c# - 为什么我们必须使用 typeof，而不仅仅是使用类型？

> ID：15535579
> 
> 赞同：13
> 
> 时间：2013-03-20T21:58:39.363
> 
> 标签：c#

当尝试将类型分配给 type 的属性时`System.Type`，为什么我们不能这样做？

```
foo.NetType = bool; 
```

编译器会产生以下警告：

> “意料之中的表情。”

解决它的方法是这样做：

```
foo.NetType = typeof(bool); 
```

我的问题是为什么我们不能使用第一种方法？编译器还不够聪明，无法弄清楚我们要在这里完成什么吗？为什么我们必须采用第二种方法（`typeof`）有什么原因吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-21T06:04:33.283

好问题——只要它是语言设计中的一个有趣问题。对于本网站来说，这可能不是一个理想的问题，因为它与具体的实际代码无关。

设计一种无需显式运算符即可将类型名称用作表达式的语言是完全可行的`typeof`。

这样做需要在语言中添加少量额外的规则和说明。例如，假设我们有：

```
enum Color { Red }
class Square 
{
    Color Color { get; set; }
    void M()
    {
        Type t = Color.GetType(); 
```

在今天的 C# 中，这明确意味着*调用属性 Color 的 getter 并在 result 上调用 GetType*。（请参阅规范的“颜色规则”部分以了解原因。）在您提出的世界中，这可能意味着三件事：

*   调用 Color 的 getter，对结果调用 GetType，将 Color 的 Type 对象分配给 t。
*   Color 会产生一个 Color 类型的 Type 对象。对该类型调用 GetType，并将 System.Type 的 Type 对象分配给 t。
*   Color 指的是 Color 类型，GetType 指的是非静态方法，这是错误的，因为这是对非静态成员的静态调用。

您需要澄清规范，以便清楚表达式中的 Color 何时表示*类型*以及何时表示*创建类型 object*。因此，提议的功能增加了必须处理的少量歧义，但它是完全可行的。语言设计者可以提出合理的规则。

允许通常是编译时分析的一部分的语言元素被解释为创建可以*由同一程序*中的代码操作的对象的代码的语言称为**同音语言**。在 C# 3 之前，C# 是一种非常不和谐的语言；表达式树使 C# 更加谐音。C# 3 允许将 lambda 视为程序元素，然后用于生成执行 lambda 主体操作的方法，但它还支持从 lambda 到表示 lambda 主体的对象的同音变换。

最谐音的语言之一是 Lisp。Lisp 操作列表，任何 Lisp 程序本身都可以被认为是一个列表。它可以在运行时作为对象而不是代码来引用和操作。因此，我们再次看到了关于语言设计的老笑话的真相：每个语言设计师最终都会重新发明 Lisp，非常糟糕。

我跑题了。那么您的问题本质上是：C# 在类型名称方面应该*或多或少**同音*吗？类型名称是否应该有一个含义——编译时指令——在上下文中

 *```
Foo x = new Foo();
object o = new List<Foo>[] {};
Foo.StaticMethod(); 
```

并且具有*非常不同*的含义-作为可以在其他上下文中在运行时检查的对象的构造：

```
object t = Foo; // Assign a Type object to t. 
```

?

虽然设计这样的语言当然是*可能*的，但我不太喜欢它。如果没有一个操作员清楚地指出“嘿，我们正在以同音方式使用通常是编译时元素”，这可能会令人困惑。在 C# 3 之前，没有其他同音语言功能，因此只有一个类型可以用作类型或生成 Type 对象的表达式，这似乎有点奇怪。不幸的是，在某些表达式中，不清楚一个特定的简单名称是指“我在编译时使用这种类型”还是“我想创建一个对象”。

有一个明确的 typeof 操作符可以缓解所有这些问题；当类型被同义地使用并且对读者来说非常清楚时，它是明确的。

要解决有关您的问题的一个非常具体的问题：

> 尝试将类型**分配给**System.Type类型**的属性时...**

C# 通常没有只适用于赋值的特殊规则。**一个表达式的含义通常是在不考虑使用该表达式的上下文的情况下确定的**。当我们说：

```
x = y; 
```

我们通常不会说“哦，我知道 y 被分配给 x 并且 x 属于 X 类型，所以我将在分析 y 时使用该信息”。相反，分析是从内到外：我们计算出 y 的含义，然后决定它是否与 X 兼容。

这个规则的例外当然是 lambdas。lambda*确实*考虑了它们的“目标”类型，因为目标类型可用于推断隐式类型 lambda 的类型。使这些规则正确是非常复杂的。

更一般地说，使赋值表达式特别是一个坏主意。有很多方法可以将值分配给变量：

```
M(x); // x is assigned to a formal
q = new [] { x }; // x is assigned to the first element of an array
y = new Y() { X = x }; // x is assigned to a property of Y. 
```

您希望所有这些分配的规则保持一致；如果一个表达式的意思是“我是一个类型对象”，那么它应该意味着在该表达式可以出现的*每个*上下文中，而不仅仅是作为赋值的右侧。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-20T21:59:52.043

对不起，我一开始误解了你的目标。但是，您仍然有些困惑。

您正在尝试将对象的实例*分配*`Type`给属性。`bool`不是`Type`类的实例，它是它自己的类型。我很欣赏这个术语有点令人困惑，但它们是两个不同的东西。这就是为什么它不起作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T22:57:37.157

所以这里有一个 SWAG：

如果我有一堂课：

```
public class Foo
{
    public static int Bar = 1;
} 
```

我有一些代码，例如：

```
var foo = Foo; 
```

你可能会说“好吧，这绝对意味着类型”

现在，如果我有类似的东西：

```
public class Bar
{
    public void Foo ()
    {
          var hmm = Foo;
    }
} 
```

我是什么意思？类型 Foo? 方法 Foo? 命名空间（如果存在的话） Foo?

通过将它包装在 typeof 中，我们可以明确我们想要什么。此外，它会生成特定的 IL，但我假设您的问题隐含的意思是“为什么编译器不更聪明？”*

# php - 重写规则模式无法正常工作

> ID：15535580
> 
> 赞同：0
> 
> 时间：2013-03-20T21:58:42.440
> 
> 标签：php, .htaccess, rewrite

我试图将 profile.php?id=1&email=medicalboy@gmail.com 重写为 regex/profile/9/medicalboy@gmail.com

但规则不起作用：

这就是我所做的

php:

```
<a href="profile/<?php echo $row['userid']; ?>/<?=$row['email']; ?>"><?php echo $row['username']; ?></a><br /> 
```

htaccess

```
RewriteEngine On
RewriteBase /regex/
RewriteRule ^profile/([0-9]+)/(.*)$ profile.php?id=$1&email=$2 [L] 
```

有什么问题？我仔细阅读了有关重写的内容，但我不知道问题出在哪里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:13:29.980

我知道答案

我想如果 $_GET 可以与 regex/profile/1/66 之类的 uri 一起使用，所以 $_GET 无法获取取决于 uri 的信息

所以我使用explode（）来获取id，如下所示：

```
$url=$_SERVER['REQUEST_URI'];
$exp=explode("/",$url);
$id=$exp[3];
$query=$db->query("select * from users where userid='$id'"); 
```

# c++ - C++ If 循环在 for 循环中。限制

> ID：15535581
> 
> 赞同：1
> 
> 时间：2013-03-20T21:58:46.727
> 
> 标签：c++, loops, if-statement, for-loop

我有这个代码。

```
 for(int j=0; j<=n; j++) {
     Xnew2 = j*(Y+R2)/n;
     Ynew2 = pow((((Y+R2)*(Y+R2)) - (Xnew2*Xnew2)), 0.5);
     cout<<"\n("<<Xnew2<<","<<Ynew2<<")"; 
 } 
```

我希望显示所有值，但我还想对显示的值创建一个限制，以确保`Ynew2`不能高于 310 或低于 -310。半径为 482.7 毫米，这是当前数值的数值。

我该怎么做呢？我尝试在其中放置一个`if`循环，但它不起作用，我尝试的任何其他方法都只给了我一个值。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:44:34.803

试试这个：

```
for(int j=0; j<=n; j++) {
    Xnew2 = j*(Y+R2)/n;
    Ynew2 = pow((((Y+R2)*(Y+R2)) - (Xnew2*Xnew2)), 0.5);

    if(abs(Ynew2) <= 310))
        cout<<"\n("<<Xnew2<<","<<Ynew2<<")"; 
} 
```

我们使用该`abs`函数获取变量的绝对值`Ynew2`，并将其与310进行比较。如果小于或等于310，则显示该点，否则，我们不显示。

旁注：您应该避免使用`\n`和使用`std::endl`（或者`endl`如果您有适当的`using`声明）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:00:57.833

```
for(int j=0; j<=n; j++)
{
    Xnew2 = j*(Y+R2)/n;
    Ynew2 = pow((((Y+R2)*(Y+R2)) - (Xnew2*Xnew2)), 0.5);
    if (Ynew2 < 310 && Ynew2 > -310)
        cout<<"\n("<<Xnew2<<","<<Ynew2<<")"; 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T23:43:28.200

```
 const int YLIMIT = 310;
   for(int j=0; j<=n; j++) {
       Xnew2 = j*(Y+R2)/n;
       int Ynew2Raw = pow((((Y+R2)*(Y+R2)) - (Xnew2*Xnew2)), 0.5);
       int Ysign = Ynew2Raw >= 0 ? 1 : -1;
       int limitedY2 = std::min(abs(Ynew2Raw, YLIMIT));
       Ynew2 = Ysign * limtedY2;

       cout<<"\n("<<Xnew2<<","<<Ynew2<<")"; 
   } 
```

# html - 这些列表中的样式有什么问题（HTML）

> ID：15535585
> 
> 赞同：0
> 
> 时间：2013-03-20T21:59:04.977
> 
> 标签：html, css, styles, styling

我一直在 Codecademy 上开设网络课程，但我一直坚持“为字体设置样式！” 任务。任何想法我做错了什么？

```
<li style= "font-family: Garamond; size:16px">This item is big Garamond.</li>

<li style= "font-family: Bodoni; size:12px;" >This item is medium Bodoni.</li>

<li style= "font-family: Futura; size:10px">This item is small Futura</li> 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:06:20.073

请记住，大多数计算机只安装了有限数量的字体：[http ://web.mit.edu/jmorzins/www/fonts.html](http://web.mit.edu/jmorzins/www/fonts.html)

最好也指定备用字体，以防用户计算机没有指定第一个字体，例如

```
font-family: arial, helvetica, georgia, verdana, sans-serif; 
```

因此，如果计算机没有安装 arial，它将在列表中向下查找，直到找到它已安装的一个并显示它。

你也错误地声明了大小。它应该是...

```
font-size: xxx; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:01:42.737

“大小”应该是“字体大小”。

`<li style= "font-family: Garamond; **font-size**:16px">This item is big Garamond.</li>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T22:08:05.523

尝试这个：

```
<li style = "font-size: 16px; font-family:Garamond">This item is big Garamond.</li>
<li style = "font-size: 12px; font-family:Bodoni">This item is medium Bodoni.</li>
<li style = "font-size: 10px; font-family:Futura">This item is small Futura.</li> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T02:54:17.523

**定义字体系列属性？**

你可以像这样使用多种字体`font-family: arial, verdana, "Cooper Black";`

**定义字体大小？**

像这样定义`font-size: 16px;`

或者，您可以同时定义这些字体属性，如下所示或`font: 16px arial, verdan, "Cooper Black";`以下是行高。`font: 16px arial;``font: 16px/20px arial;`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T22:03:43.913

```
<li style= "font-family: Garamond; font-size:16px;">This item is big Garamond.</li>

<li style= "font-family: Bodoni; font-size:12px;" >This item is medium Bodoni.</li>

<li style= "font-family: Futura; font-size:10px;">This item is small Futura</li> 
```

# python - Twisted 和 python 列表并发访问

> ID：15535586
> 
> 赞同：0
> 
> 时间：2013-03-20T21:59:14.010
> 
> 标签：python, list, python-2.7, twisted

我有一个关于在 python 中同时访问 list 的问题。我有一个将数据添加到列表的扭曲类，以及一个每 4 秒调用一次的方法。这个方法它对列表的元素进行一些操作。我担心从 ossPeriodic 和从 dataReceived 访问同一个列表会产生一致性问题。这是代码：

```
ossStorage=[]

def ossPeriodic():
for i in ossStorage:
            ossStorage.remove(i)
    db.insertDataToDb(i)
reactor.callLater(4, ossPeriodic)

class OSS(Protocol):
    def dataReceived(self, data):
        account = pickle.loads(data)        
        ossStorage.append(account)

def main():
    ossFactory = Factory()
    ossFactory.protocol = OSS
    reactor.listenTCP(50000, ossFactory)    
    reactor.callLater(4, ossPeriodic)
    reactor.run() 
```

我应该使用锁或类似的东西吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:08:16.760

你在使用线程吗？如果没有，那么您没有对列表的并发访问权限。

通常使用 Twisted 的应用程序不使用线程。Twisted 的异步特性在单个线程中执行，按顺序处理每个事件。异步特性提供了类似并发的行为，例如并行处理许多网络连接，但每个回调函数在调用下一个回调函数之前运行完成。

# paypal - 创建销售后获取贝宝用户信息

> ID：15535593
> 
> 赞同：0
> 
> 时间：2013-03-20T21:59:50.687
> 
> 标签：paypal

我正在将 Paypal 集成到购物车中，我想在创建付款后获取用户的运输信息。我知道有一种方法可以使用旧的 api，但似乎在 developer.paypal.com 启动时 api 发生了变化。我没有看到我需要使用什么 url 来获取扩展的付款人信息。

到目前为止，我将用户发送到贝宝进行创建，当用户回来时，我有一个付款人 ID 和令牌。在之前的通话中，我有一个执行链接，但没有详细信息链接。在联系贝宝之前，我是否需要强制用户输入运输信息？如果是这样的话，Paypal 显示来自他们系统而不是我的系统的运输信息似乎令人困惑。

一旦他们批准了金额，我如何从贝宝获取付款人的运输详细信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:30:08.707

大多数商家使用 PayPal 即时付款通知 (IPN) 来接收包括送货地址在内的付款详细信息。这使您可以从 PayPal 接收实时通知，而不是在您认为已付款后对我们进行 ping 操作。下面是一个简单的 PHP 脚本，它将获取 IPN 并对其进行验证，以确保它不是欺骗尝试。一旦通过验证，您就可以更新您的数据库、发送电子邮件或在您知道已付款后执行任何所需的任务。

```
// Validate with curl
  $req = 'cmd=_notify-validate';

  foreach ($_POST as $key => $value)  
  {  
       $value =  urlencode(stripslashes($value));  
       $req .=  "&" . $key . "=" . $value;  
  }

  $curl_result=$curl_err='';
  $ch = curl_init();
  curl_setopt($ch, CURLOPT_URL,'www.paypal.com');//Change URL to sandbox.paypal.com if testing in our developer environment
  curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
  curl_setopt($ch, CURLOPT_POST, 1);
  curl_setopt($ch, CURLOPT_POSTFIELDS, $req);
  curl_setopt($ch, CURLOPT_HTTPHEADER,  array("Content-Type: application/x-www-form-urlencoded",  "Content-Length: " . strlen($req)));
  curl_setopt($ch, CURLOPT_HEADER , 0);  
  curl_setopt($ch, CURLOPT_VERBOSE, 1);
  curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, true);
  curl_setopt($ch, CURLOPT_TIMEOUT, 30);
  $curl_result = @curl_exec($ch);
  $curl_err = curl_error($ch);
  curl_close($ch);

  //Set validation flag
  if (strpos($curl_result, "VERIFIED")!==false)
       $valid  = true;
  else
       $valid  = false; 
```

这种方法比支付数据传输 (PDT) 更可靠，因为它不依赖消费者返回您的网站进行支付。

# android - 在设备上调试 android 应用程序不起作用

> ID：15535596
> 
> 赞同：0
> 
> 时间：2013-03-20T22:00:03.780
> 
> 标签：android, eclipse

我无法在手机上调试我的 android 应用程序。My Phone 是运行在 4.0.4 版 android 上的 LG Optimus G。到处都说要更新驱动程序，但是当我这样做时，我的计算机无法识别它。我安装了带有 SDK 版本 4.2、4.0.3、2.3.3 和 2.2 的 android ADT。我认为这可能是因为我的手机是 4.0.4 而不是 4.0.3。我在手机上启用了 USB 调试。模拟器只是在调试时不稳定和滞后。还有一件事，我已经尝试过调试，但没有找到设备，尽管我可以在文件资源管理器中找到所有文件和图片。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:13:58.933

如果您使用的是 Windows，我建议您尝试下载 PdaNet [http://pdanet.co/](http://pdanet.co/)，此应用程序用于从您的 android 手机共享 Internet 到您的 PC，但还可以帮助您为您的 Android 安装正确的驱动程序。

我发现使用这个程序是让大多数 Android 手机在 Windows 上运行的最简单方法，另外，如果您不想要该软件，您可以将其卸载并保留驱动程序。

# c# - 与表单交互的异步客户端

> ID：15535598
> 
> 赞同：2
> 
> 时间：2013-03-20T22:00:11.080
> 
> 标签：c#, winforms, sockets, asynchronous, client

我已经搜索了一天中的大部分时间来试图解决这个问题，而且我确定我在某个地方缺少一个简单的解决方案。

我正在使用异步套接字客户端连接来监视来自 TCP 连接的传入数据。我已经按照 msdn 示例的建议实现了 ManualResetEvent 和 Callback 方法，但是 Callback 方法无法调用用于将接收到的数据输出到我的 Windows 窗体的方法。如何获取从套接字接收到的数据，并将其发送到表单中的文本框？

我敢肯定，我在某处遗漏了一个简单的技巧。示例代码是为控制台应用程序编写的。如何让表单对来自 Socket 的传入数据做出反应？

更新：

我想你让我走上了正确的道路。我尝试输入代码来使用委托，但我显然不太了解委托是如何工作的，因为它不断抛出以下错误：

非静态字段、方法或属性“APRS_SMS_Gateway.MainForm.SockOutputDelegate”需要对象引用

你能让我靠近一点吗？这是我现在正在尝试处理的 ConnectCallBack 处理程序，但我想从所有 CallBacks 中使用相同的方法（SockOutput）。

```
public partial class MainForm : Form
{
    private AutoResetEvent receiveNow;

    public delegate void SockOutputDelegatetype(string text); // Define delegate type
    public SockOutputDelegatetype SockOutputDelegate;

    // The port number for the remote device.
    private const int port = 14580;

    // ManualResetEvent instances signal completion.
    private static ManualResetEvent connectDone =
        new ManualResetEvent(false);
    private static ManualResetEvent sendDone =
        new ManualResetEvent(false);
    private static ManualResetEvent receiveDone =
        new ManualResetEvent(false);

    // The response from the remote device.
    private static String response = String.Empty;

    public MainForm()
    {

        InitializeComponent();

        SockOutputDelegate = new SockOutputDelegatetype(SockOutput);

    }

    private void Form1_Load(object sender, EventArgs e)
    {
        CommSetting.APRSServer = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);

        //StartClient();

    }

    private void StartClient()
    {
        try
        {
            IPHostEntry ipHostInfo = Dns.GetHostEntry("rotate.aprs.net");
            IPAddress ipAddress = ipHostInfo.AddressList[0];
            IPEndPoint remoteEP = new IPEndPoint(ipAddress, port);

            // Create a TCP/IP socket.
            //Socket APRSServer = new Socket(AddressFamily.InterNetwork,
            //    SocketType.Stream, ProtocolType.Tcp);

            // Connect to the remote endpoint.
            CommSetting.APRSServer.BeginConnect(remoteEP,
                new AsyncCallback(ConnectCallback), CommSetting.APRSServer);
            connectDone.WaitOne();

            //Show the connect string from the host
            Receive(CommSetting.APRSServer);
            //receiveDone.WaitOne();

            //Show the connection response
            //SockOutput(response);
        }
        catch (Exception e)
        {
            SockOutput(e.ToString());
        }
    }

    private static void ConnectCallback(IAsyncResult ar)
    {
        try
        {
            // Retrieve the socket from the state object.
            Socket APRSServer = (Socket)ar.AsyncState;

            // Complete the connection.
            APRSServer.EndConnect(ar);

            // Signal that the connection has been made.
            connectDone.Set();
        }
        catch (Exception e)
        {
            MainForm.Invoke(MainForm.SockOutputDelegate, e.ToString());
        }
    }

    private static void Receive(Socket client)
    {
        try
        {
            // Create the state object.
            StateObject state = new StateObject();
            state.workSocket = client;

            // Begin receiving the data from the remote device.
            client.BeginReceive(state.buffer, 0, StateObject.BufferSize, 0,
                new AsyncCallback(ReceiveCallback), state);
        }
        catch (Exception e)
        {
            //throw new ApplicationException(e.ToString());
            response = e.ToString();
        }
    }

    private static void ReceiveCallback(IAsyncResult ar)
    {
        try
        {
            // Retrieve the state object and the client socket 
            // from the asynchronous state object.
            StateObject state = (StateObject)ar.AsyncState;
            Socket client = state.workSocket;

            // Read data from the remote device.
            int bytesRead = client.EndReceive(ar);

            if (bytesRead > 0)
            {
                // There might be more data, so store the data received so far.
                state.sb.Append(Encoding.ASCII.GetString(state.buffer, 0, bytesRead));

                // Get the rest of the data.
                client.BeginReceive(state.buffer, 0, StateObject.BufferSize, 0,
                    new AsyncCallback(ReceiveCallback), state);
            }
            else
            {
                // All the data has arrived; put it in response.
                if (state.sb.Length > 1)
                {
                    response = state.sb.ToString();
                }
                // Signal that all bytes have been received.
                receiveDone.Set();
            }
        }
        catch (Exception e)
        {
            response = e.ToString();
        }
    }

    void SockOutput(string text)
    {
            txtSockLog.AppendText(text);
            txtSockLog.AppendText("\r\n");
    }

} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:12:56.707

听起来您的套接字端工作正常，它只是更新导致问题的winform。你可以在这里找到你的答案[Update WinForm Controls from another thread _and_ class](https://stackoverflow.com/questions/12131453/update-winform-controls-from-another-thread-and-class)。

# c - 将文件写入标准输出失败

> ID：15535601
> 
> 赞同：1
> 
> 时间：2013-03-20T22:00:15.370
> 
> 标签：c, winapi

我想写入一个随机输出，其中`STD_OUTPUT_FILE`可以。我想使用 `WriteFile`，但它似乎没有写任何东西。

```
HANDLE outH = GetStdHandle ( STD_OUTPUT_HANDLE );
WriteFile( outH,param, strlen ( param ), &written_b, NULL ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-27T22:35:08.177

要使用调用窗口/控制台写入 STDOUT，您需要将生成的可执行文件链接到控制台子系统。

LINK.exe /EDIT /SUBSYSTEM:CONSOLE {你的 exe 名称在这里}

这适用于较旧的 VB6 环境，我假设相同的可执行标志也适用于 Visual C。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:38:11.207

我解决了。

重定向标准输出时出错，当它应该让它保持原样时，它做错了什么。还不知道。我会更新我的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T22:38:20.273

您的代码缺少任何形式的错误检查。这对于从网站复制的代码或 Stack Overflow 答案很常见，为了清晰和简洁，通常会省略错误检查。但是任何时候你自己编写代码，你绝对必须假设它可能会失败并编写代码来处理这种情况。在这里，您知道它失败了，但您仍然没有返回添加错误检查代码以查看失败发生的位置。

现在让我们添加错误检查代码，必要时参考 SDK 文档，了解您调用的 API 函数如何处理错误情况：

```
static void ReportError(const TCHAR* errorMsg)
{
   MessageBox(NULL, errorMsg, NULL, MB_OK | MB_ICONERROR);
}

int _tmain(int argc, TCHAR* argv[])
{
   char param[] = "This is some output.";
   DWORD written_b;

   HANDLE outH = GetStdHandle(STD_OUTPUT_HANDLE);
   if (!outH)
   {
      ReportError(TEXT("No standard handles associated with this app."));
   }
   else if (outH == INVALID_HANDLE_VALUE)
   {
      TCHAR errMsg[100];
      wsprintf(errMsg, TEXT("GetStdHandle() failed with error code %lu"), GetLastError());
      ReportError(errMsg);
   }
   else
   {
      if (!WriteFile(outH, param, strlen(param), &written_b, NULL))
      {
         TCHAR errMsg[100];
         wsprintf(errMsg, TEXT("WriteFile() failed with error code %lu"), GetLastError());
         ReportError(errMsg);
      }
   }

   return 0;
} 
```

现在，如果出现问题，我们不仅会知道，还会知道*原因*。

好东西，因为当我在我的计算机上运行这段代码时，它工作得很好。因此，问题出在您的应用程序的其他地方，在一些我们没有看到的代码中。错误处理代码将有助于清除它。

# linq - 关于 monads 和 LINQ

> ID：15535606
> 
> 赞同：8
> 
> 时间：2013-03-20T22:00:37.590
> 
> 标签：linq, haskell, monads

我偶然发现了一些声明，暗示 LINQ 是由 monads 驱动的。

一些 C# 程序员问过 monad 是什么以及它与 LINQ 有何相似之处。但我是一名 Haskell 程序员，我在问什么是 LINQ 以及拥有 monad 是什么感觉。

我对 LINQ 的了解很少，它可以让您在 C# 代码中间编写任意 SQL。有人告诉我，这意味着可以为其他数据类型实现 LINQ，但我从未见过它完成。大概这就是事情变得有趣的部分。（？）

任何评论或有用的阅读将不胜感激。

# javascript - CKEditor 在 Internet Explorer 中显示为灰色

> ID：15535607
> 
> 赞同：0
> 
> 时间：2013-03-20T22:00:38.903
> 
> 标签：javascript, jquery, editor, ckfinder

我访问了很多网站以找到解决方案。

我的编辑器几乎可以在除 Internet Explorer 之外的所有浏览器中使用。在 Internet Explorer 中，更改内容的空间（文本区域）没有显示，编辑器的其余部分是可见的。有谁知道解决方案？我没有在互联网上找到它。

更新编辑器可能是一个解决方案，但是我花了一段时间将它与ckfinder一起配置，所以我担心更新后ckfinder无法正常工作。

编辑几个月前工作，但我有几个月没有在网站上工作。

```
<textarea id="textarea" name='text' class='editor'></textarea> 
```

显示我的编辑器。

```
<script>
$(document).ready(function(){
             $('textarea.editor').ckeditor( 
             function() { 
                 /* callback code */ 
                  }, 
                {   

                   language : 'nl',
                   uiColor : '#e9eaee',
                   toolbarStartupExpanded : false,
                      toolbar :
                            [
                                    { name: 'tools', items : [ 'Maximize', 'ShowBlocks', 'Source'] },{ name: 'document', items : ['DocProps','Preview','Print','-','Templates' ] },
                         { name: 'clipboard', items : [ 'Cut','Copy','Paste','PasteText','PasteFromWord','-','Undo','Redo' ] },
                              { name: 'editing', items : [ 'Find','Replace','-','SelectAll','-','SpellChecker', 'Scayt' ] },
                            '/',
                            { name: 'basicstyles', items : [ 'Bold','Italic','Underline','Strike','Subscript','Superscript','-','RemoveFormat' ] },
                              { name: 'paragraph', items : [ 'NumberedList','BulletedList','-','Outdent','Indent','-','Blockquote','-','JustifyLeft','JustifyCenter','JustifyRight','JustifyBlock','-','BidiLtr','BidiRtl' ] },
                            { name: 'links', items : [ 'Link','Unlink','Anchor' ] },
                         '/',
                            { name: 'styles', items : [ 'Styles','Format','Font','FontSize' ] },
                            { name: 'colors', items : [ 'TextColor','BGColor' ] },
                           { name: 'insert', items : [ 'Image','Table','HorizontalRule','Smiley','SpecialChar' ] }
                            ],
                      height: '225',
                      extraPlugins : 'tableresize'

                } );
            });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:13:45.700

尝试禁用您的附加组件，如果问题解决了，请逐个启用附加组件以查找导致问题的附加组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-23T10:55:52.203

根据上一个答案的评论，问题出在IE10上，对吗？好像是版本问题。CKFinder 2.2.2 不支持 IE10，因此您可以尝试更新 CKF。

如果您在问题中包含 CKFinder、CKEditor 和浏览器版本，将会有所帮助:)。

这也可能是配置或一般 JS 问题 - 你有 JSfiddle 或我们可以查看的其他链接吗？此外，您是否检查了 IE10 的开发人员工具报告的内容，那里很可能存在信息错误。

# fluent-nhibernate - Losing the record ID

> ID：15535608
> 
> 赞同：0
> 
> 时间：2013-03-20T22:00:40.907
> 
> 标签：fluent-nhibernate

I have a record structure where I have a parent record with many children records. On the same page I will have a couple queries to get all the children.

A later query I will get a record set when I expand it it shows "Proxy". That is fine an all for getting data from the record since everything is generally there. Only problem I have is when I go to grab the record "ID" it is always "0" since it is proxy. This makes it pretty tough when building a dropdown list where I use the record ID as the "selected value". What makes this worse is it is random. So out of a list of 5 items 2 of them will have an ID of "0" because they are proxy.

I can use evict to force it to load at times. However when I am needing lazy load (For Grids) the evict is bad since it kills the lazy load and I can't display the grid contents on the fly.

I am using the following to start my session:

```
ISession session = FluentSessionManager.SessionFactory.OpenSession();
session.BeginTransaction();
CurrentSessionContext.Bind(session); 
```

I even use ".SetFetchMode("MyTable", Eager)" within my queries and it still shows "Proxy".

Proxy is fine, but I need the record ID. Anyone else run into this and have a simple fix?

I would greatly appreciate some help on this.

Thanks.

Per request, here is the query I am running that will result in Patients.Children having an ID of "0" because it is showing up as "Proxy":

```
 public IList<Patients> GetAllPatients()
    {
        return FluentSessionManager.GetSession()
            .CreateCriteria<Patients>()
            .Add(Expression.Eq("IsDeleted", false))
            .SetFetchMode("Children", Eager)
            .List<Patients>();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T14:31:03.620

I have found the silver bullet that fixes the proxy issue where you loose your record id! I was using ClearCache to take care of the problem. That worked just fine for the first couple layers in the record structure. However when you have a scenario of Parient.Child.AnotherLevel.OneMoreLevel.DownOneMore that would not fix the 4th and 5th levels. This method I came up with does. I also did find it mostly presented itself when I would have one to many followed by many to one mapping. So here is the answer to everyone else out there that is running into the same problem.

Domain Structure:

```
public class Parent : DomainBase<int>
{
    public virtual int ID { get { return base.ID2; } set { base.ID2 = value; } }

    public virtual string Name { get; set; }
    ....
} 
```

DomainBase:

```
public abstract class DomainBase<Y>, IDomainBase<Y>
{
    public virtual Y ID //Everything has an identity Key.
    {
        get;
        set;
    }

    protected internal virtual Y ID2 // Real identity Key
    {
        get
        {
            Y myID = this.ID;
            if (typeof(Y).ToString() == "System.Int32")
            {
                if (int.Parse(this.ID.ToString()) == 0)
                {
                    myID = ReadOnlyID;
                }
            }

            return myID;
        }
        set
        {
            this.ID = value;
            this.ReadOnlyID = value;
        }
    }
    protected internal virtual Y ReadOnlyID { get; set; } // Real identity Key
} 
```

IDomainBase:

```
public interface IDomainBase<Y>
{
    Y ID { get; set; }
} 
```

Domain Mapping:

```
public class ParentMap : ClassMap<Parent, int>
{
    public ParentMap()
    {
        Schema("dbo");
        Table("Parent");

        Id(x => x.ID);

        Map(x => x.Name);
        ....
    }
} 
```

ClassMap:

```
public class ClassMap<TEntityType, TIdType> : FluentNHibernate.Mapping.ClassMap<TEntityType> where TEntityType : DomainBase<TIdType>
{
    public ClassMap()
    {
        Id(x => x.ID, "ID");
        Map(x => x.ReadOnlyID, "ID").ReadOnly();
    }
} 
```

# ruby-on-rails - 为守望者声明自定义失败操作不起作用

> ID：15535610
> 
> 赞同：1
> 
> 时间：2013-03-20T22:00:44.170
> 
> 标签：ruby-on-rails, warden

目前在我的监狱长经理中，我们声明了一个自定义故障应用程序。

```
 Rails.configuration.middleware.use Warden::Manager do |manager|
      manager.default_strategies :password
      manager.failure_app = lambda { |env| SessionsController.action(:new).call(env) }
    end 
```

但是，对于我的一种策略，我想使用不同的失败操作，因此我尝试在失败中声明自定义操作，如下所示：

```
 def authenticate!
   email =  params["email"] || params['session']['email']
   pw =  params["password"] || params['session']['password']
   user = User.find_by_email email
   if user && user.authenticate_and_activated(pw)
     success! user
   else
     throw(:warden, :stuff => "foo", :action => :failure)   
   end
 end 
```

甚至在我的控制器操作中：

```
 def sign_in
   @user = warden.authenticate! :action => :failure
   ...
 end 
```

这是我的失败行动：

```
def failure        
  warden.custom_failure!
  render :json => {:success => false, :errors => ["Login Failed"]}
 end 
```

但问题是它似乎忽略了它，只调用了我的经理中声明的动作。任何人都知道我可能做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T22:24:27.857

我能够通过 JonRowe 在 Github 上的 Warden 问题上提出的想法找出我的解决方案（[https://github.com/hassox/warden/issues/73](https://github.com/hassox/warden/issues/73)）

根据他更改我的 lambda 的建议，我能够将我的监狱长管理器配置更改为：

```
Rails.configuration.middleware.use Warden::Manager do |manager|
  manager.default_strategies :password
  manager.failure_app = lambda { |env| 
    failure_action = env["warden.options"][:action].to_sym
    SessionsController.action(failure_action).call(env) 
  }
end 
```

这拿起了我传递给它的失败动作。它似乎存储在“warden.options”哈希中。

# ios - 观察属性或覆盖设置器更好吗？

> ID：15535614
> 
> 赞同：6
> 
> 时间：2013-03-20T22:01:01.120
> 
> 标签：ios, objective-c, cocoa-touch, properties, key-value-observing

假设我们有这个`CustomButton`接口：

```
@interface CustomButton : UIButton
    @property (nonatomic, assign) CGFloat minWidth;
@end 
```

每次`minWidth`改变，我们都要`CustomButton`重新布局。据我所知，我们有两种解决方案：

### 观察财产的价值

```
// In -initWithFrame:
[self addObserver:self forKeyPath:@"minWidth" options:0 context:nil];

// In -observeValueForKeyPath:ofObject:change:context:
[self setNeedsLayout]; 
```

### 覆盖`minWidth`的设置器

```
// In -setMinWidth:
_minWidth = minWidth; // Side note: it's an ARC project
[self setNeedsLayout]; 
```

哪一个是正确的解决方案，为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T22:35:44.393

我可以想到 3 个理由来覆盖 setter 而不是 KVO 属性。

### 1：副作用可能会有所不同

除非您明确需要或想要副作用，否则阻力最小的路径（或在这种情况下的开销）是覆盖设置器。KVO 不仅涉及到给定属性的绑定，还涉及观察者在整个绑定期间都处于活动状态的假设。甚至不要让我开始谈论 KVO 的调试难度有多大！臭名昭著的“ [NSKVODeallocateBreak](https://stackoverflow.com/questions/7466652/setting-breakpoint-at-nskvodeallocatebreak)断点”足以吓跑任何人。

### 2：传统智慧

“观察自己”虽然在理论上是一个好主意，但比重写 setter 更难。KVO 也是 setter 之上的额外（但最小）开销，仅对绑定到其他对象真正有用。此外，如果您将一个类视为一个自包含的单元，那么它确实不需要观察其自身的任何属性。Setter 精确地存在，因此给定的类可以选择对其属性的更改做出反应，甚至拒绝或修改所述更改。

### 3：我们都很懒

通过观察自己，你现在已经遵守了 KVO 的规则：即记住将自己移除为观察者，并实施

`-observeValueForKeyPath:ofObject:change:context:`.

相对于手头的任务，这是太多的工作***。***为什么你要记住要做所有这些？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:10:47.500

正确答案实际上在您的问题中：

> 每次更改 minWidth 时，我们都想重新布局 CustomButton。

编程没有绝对的答案，这使它既是一门艺术又是一门科学。但是，您可以采用一些策略来确保编程行为不会妨碍您尝试实现或创建的目标。编程本身就是达到目的的一种手段。

因此，您的代码应该尽可能复杂，但仅此而已。

虽然您可以使用键值对观察，并且没有人会责怪您，但更好的方法*（在您的问题的上下文中）*是覆盖设置器，因为这是您的意图（上面引用），它最简单，最简洁和字面形式。

在放大的层面上，您的代码应该尽可能易于阅读和解析，以便这些简单的块可以组装成更复杂的结构。如果放大到最详细的代码是不必要的冗长或复杂，这将表现为整个项目的摩擦（更难调试，更容易出错，等等）。

# awk - 从 pcap 文件中提取时间和源 IP 地址

> ID：15535618
> 
> 赞同：1
> 
> 时间：2013-03-20T22:01:15.063
> 
> 标签：awk, pcap, tcpdump

我有 pcap 跟踪文件，我想从数据包中提取时间和源 IP 地址。我正在使用 tcpdump 和 awk。这是文件的示例

```
 02:00:00.001814 IP 61.31.228.1.80 > 0.106.173.16.19999: Flags [S.], seq 4049606604, ack        4044405336, win 512, length 0
 02:00:00.005787 IP 61.31.228.1.80 > 0.4.173.19.13923: Flags [S.], seq 3812128115, ack 3811406374, win 512, length 0
 02:00:00.005799 IP 74.54.182.242.80 > 0.176.229.61.43527: Flags [S.], seq 61247722, ack 352633207, win 65535, options [mss 1460,nop,nop,sackOK], length 0 
```

然后我应用 awk 来提取 csv 文件中的时间和源 IP 地址：

```
02:00:00.001814,0.106.173.16.19999:
02:00:00.005787,0.4.173.19.13923:
02:00:00.005799,0.176.229.61.43527: 
```

我只对最后一点感兴趣，我想摆脱源ip末尾的“：”。我用过

```
awk '{print $1 "," $5}' 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:20:08.990

试试这个 ：

```
 awk -F'[:. ]' '$5=="IP"{print $4","$12"."$13"."$14"."$15}' 
```

## 输出

```
001814,0.106.173.16
005787,0.4.173.19
005799,0.176.229.61 
```

# php - 使用文本框和复选框的高级搜索

> ID：15535621
> 
> 赞同：0
> 
> 时间：2013-03-20T22:01:42.413
> 
> 标签：php, html, search, checkbox

我无法让我的网站的“高级搜索”功能正常工作。本质上，它是对音乐家的高级搜索（城市、姓名成员、按文本框的 zip 和按复选框的流派）。这是“高级搜索”php页面上的代码...

```
<form method="post" action="advsearchresults.php">
<div class="control-group">
    <div class="controls span4">
    <label>City</label>
        <input type="text" name="advCity" placeholder="Ex: San Marcos..." />
    <label>Zip Code</label>
    <input type="text" name="advZip" placeholder="Ex: 78666..." />
    <label>Band Name</label>
        <input type="text" name="advBand" placeholder="Ex: Catchy Band Name..." />
    <label>Band Member Name</label>
        <input type="text" name="advMember" placeholder="Ex: Steve Stevenson..." />
</div>
<div class="controls span2"><br/><br/><br/>
    <label class="checkbox">
        <input type="checkbox" name="check_list[]" value="Blues"> Blues
    </label>
    <label class="checkbox">
        <input type="checkbox" name="check_list[]" value="Classical"> Classical
    </label>
    <label class="checkbox">
        <input type="checkbox" name="check_list[]" value="Comedy"> Comedy
    </label>
    <label class="checkbox">
    <input type="checkbox" name="check_list[]" value="Country"> Country
    </label>
    ...
    ...
    </div>
    <div class="span12">
        <center>
        <input type="submit" class="btn btn-info" value=" Advanced Search ">
    </div>
    ... 
```

这是“高级搜索结果”页面...

```
...
<?php
$advCity = $_POST['advCity'];
$advZip = $_POST['advZip'];
$advBand = $_POST['advBand'];
$advMember = $_POST['advMember'];
$check = $_POST['check_list'];
?>
...

<?php
if(isset($_POST['check_list']) && is_array($_POST['check_list'])){
    foreach($_POST['check_list'] as $check) {
        $genreQuery = "SELECT profile.PROFILE_GENRE, profile.PROFILE_BANDNAME
        FROM profile INNER JOIN band ON profile.PROFILE_PROFILEID = band.BAND_PROFILEID
        INNER JOIN bandmember ON band.BAND_BANDID = bandmember.BANDMEMBER_BANDID
        WHERE band.BAND_CITY = '$advCity' OR profile.PROFILE_GENRE = '$check' 
        OR band.BAND_ZIP = '$advZip' OR profile.PROFILE_BANDNAME = '$advBand' 
        OR bandmember.BANDMEMBER_NAME = '$advMember'";              
    $result = mysql_query($genreQuery) OR die(mysql_error());
    $num=mysql_numrows($result);
    mysql_close();
if ($num > 0){
    ?>
    <table class="table table-hover span8" method="post" action="bandpage.php">
    <thead>
    <tr>
        <th>Genre</th>
        <th>Band Name</th>
    </tr>
    </thead>
    <?php
        $i = 0;
        while ($i < $num) {
            $GENRE = mysql_result($result,$i,"profile.PROFILE_GENRE");
            $BANDNAME = mysql_result($result,$i,"profile.PROFILE_BANDNAME");
    ?>
    <tbody>
    <tr>
    <td><?php echo $GENRE; ?></td>
    <td><a href="bandpage.php" name="band"><?php echo $BANDNAME; ?>
    </a></td></tr</tbody>
    <?php
        $i++;               
        }
        }
else {
?>  
    <table class="table span8">
    <thead>
        <tr>
        <th>No musicians available for the city: <?php echo $advCity ?></th>
        </tr>
    </thead>
    </table>
<?php
    }
    }
    }
?> 
```

搜索结果根本不显示，而是显示随机表数据。任何帮助深表感谢！

### 格式化的 SQL：

```
SELECT
    profile.PROFILE_GENRE,
    profile.PROFILE_BANDNAME
FROM
    profile
    INNER JOIN band       ON profile.PROFILE_PROFILEID = band.BAND_PROFILEID
    INNER JOIN bandmember ON band.BAND_BANDID          = bandmember.BANDMEMBER_BANDID
WHERE
    band.BAND_CITY             = '$advCity' OR
    profile.PROFILE_GENRE      = '$check' OR
    band.BAND_ZIP              = '$advZip' OR
    profile.PROFILE_BANDNAME   = '$advBand' OR
    bandmember.BANDMEMBER_NAME = '$advMember' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:07:58.697

您的 SQL 正在执行所有谓词，而不管它们是否被设置，因此如果用户没有明确提供值，`$advBand`那么它将具有`""`（空字符串）的值，该值仍将包含在您的查询中。因为是可交换的，所以将返回`OR`任何具有空值的行。`PROFILE_BANDNAME`

有两种可能的解决方案：手动添加谓词的“动态 SQL”，或者为每个谓词添加保护表达式。动态 SQL 可能容易出错，因此向 WHERE 添加表达式可能更容易，它应该如下所示：

（此示例使用 MySQL 特定的`field > ''`语法，这是一种快速执行“不是 null 或空”值比较的方法，它还使用 MySQL 参数。

```
WHERE
    (:advCity   > '' AND band.BAND_CITY             = :advCity   ) OR
    (:check     > '' AND profile.PROFILE_GENRE      = :check     ) OR
    (:advZip    > '' AND band.BAND_ZIP              = :advZip    ) OR
    (:advBand   > '' AND profile.PROFILE_BANDNAME   = :advBand   ) OR
    (:advMember > '' AND bandmember.BANDMEMBER_NAME = :advMember ) 
```

修改 PHP 的其余部分以使用 MySQL 参数是读者的练习 :)

# error-handling - 果园电子邮件错误

> ID：15535625
> 
> 赞同：0
> 
> 时间：2013-03-20T22:01:54.077
> 
> 标签：error-handling, orchardcms, orchardcms-1.6

我正在使用 Orchard 为新网站提供动力，当我尝试启用我的新主题（即使在预览模式下）时，我得到“由于内部服务器错误，无法显示页面。” 我尝试将 web.config 中的 customErrors 更改为 Off，但这并没有改变任何东西，所以我开始使用 log4net 的配置。我的配置如下：

```
<appender name="error-file" type="Orchard.Logging.OrchardFileAppender">
<!-- error log: only ERROR and FATAL subset of debug log -->
<file value="App_Data/Logs/orchard-error" />
<appendToFile value="true" />
<!-- immediate flush on error log, to avoid data loss with sudden termination -->
<immediateFlush value="false" />
<staticLogFileName value="false" />
<rollingStyle value="Date" />
<datepattern value="-yyyy.MM.dd'.log'" />
<!-- prevent orchard.exe from displaying locking error messages -->
<lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
<layout type="log4net.Layout.PatternLayout">
  <conversionPattern value="%date [%thread] %logger - %message%newline" />
</layout>
</appender>

<appender name="SmtpAppender" type="log4net.Appender.SmtpAppender">
<threshold value="WARN"/>
<to value="to@email.com" />
<from value="from@email.com" />
<subject value="Site Error" />
<smtpHost value="mailserver.com" />
<bufferSize value="2147483647" />
<lossy value="false" />
<layout type="log4net.Layout.PatternLayout">
  <conversionPattern value="%newline%date [%thread] %-5level %logger [%property{NDC}] - %message%newline%newline%newline" />
</layout> 
```

在配置的第一部分，它非常敏感。如果我将 appendToFile 更改为 false（意味着为每个错误创建一个新文件），则不会记录任何内容，也不会创建任何文件。当它为假时，会创建一个错误日志，但没有写入任何内容（暗示它已被缓冲）。此外，当我将“immediateFlush”更改为 true 时，不会写入/创建错误日志。我尝试根据搜索 Bing/Google 添加电子邮件配置信息，但它什么也没做（尝试缓冲区大小为 1 和 int.MaxValue）。没有记录错误，也没有发送电子邮件。

我需要做的就是找出错误是什么，但我动不动就被阻止，并且无法访问 Web 服务器本身来查看事件日志。这里有什么建议吗？另一件事是我重新启动了应用程序池几次，希望这会导致记录未决错误，但也没有运气 - 文件大小保持在 0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T12:34:42.933

在您的示例中，`<appender name="SmtpAppender" type="log4net.Appender.SmtpAppender">`未关闭`</appender>`

它在您的服务器上关闭了吗？

# css - 二十个子菜单 CSS

> ID：15535626
> 
> 赞同：0
> 
> 时间：2013-03-20T22:01:53.720
> 
> 标签：css, wordpress, menu

我正在为我正在创建的网站使用二十个子主题，并且在访问子菜单项上的“current_item”选择器时遇到了很多麻烦

我可以通过以下方式格式化主菜单项：

```
#access ul li.current_page_item a{} 
```

我试过了：

```
#access ul ul li.current_page_item a{} 
```

或标准的二十个 css 条目：

```
#access ul li.current_page_item > a,
#access ul li.current_page_ancestor > a,
#access ul li.current-menu-ancestor > a,
#access ul li.current-menu-item > a,
#access ul li.current-menu-parent > a { } 
```

但它们都不适用于子菜单项......

我想要做的是更改当前子菜单项的背景和文本颜色。任何想法如何访问它？

您可以在此处查看当前状态：

[http://stuck-mueller.de/beta.php?page_id=47](http://stuck-mueller.de/beta.php?page_id=47)

当前选择的子菜单项是“Estrich”，我要更改的是它的背景和文本颜色。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:13:19.227

如果你想改变`background-color`和`Text`颜色，`current menu item`那么你可以通过在下面的 css 类 ( `style.css : line 98`)中添加属性来实现

```
#access ul li.current_page_item a
{
   color: Yellow;
   background-color: red;
} 
```

# java - 使用异步任务（Json）更新列表视图

> ID：15535630
> 
> 赞同：0
> 
> 时间：2013-03-20T22:02:03.207
> 
> 标签：java, android, json, listview, android-asynctask

我在尝试使用异步任务更新列表视图时遇到问题。asynctask 似乎没有连接到数据库...

我一直在寻找，但我找不到解决方案...

谢谢你的帮助 ！

这是源代码：

```
@SuppressLint("NewApi")
public class Resultats extends Activity {

private PullToRefreshListView lv1;

private ImageView refresh = null; // to refresh

private ArrayList<Match_ItemDetails> image_details;
private Resultats_ListBaseAdapter adapter;
private ArrayList<Match_ItemDetails> results;

/** Called when the activity is first created. */

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.resultats);

results = new ArrayList<Match_ItemDetails>();

// first construction

image_details = GetSearchResults();
adapter = new Resultats_ListBaseAdapter(this, image_details);

// Définition de la liste
lv1 = (PullToRefreshListView) findViewById(R.id.liste);

// to refresh

refresh = (ImageView)findViewById(R.id.resultats_refresh);
refresh.setOnClickListener(new View.OnClickListener() {

    @Override
    public void onClick(View v) {
        refresh(GetSearchResults());        
    }
});
lv1.setAdapter(new Resultats_ListBaseAdapter(this, image_details));

//Listener that will be invoked when it has been tap or it has been pull and released
lv1.setOnRefreshListener(new OnRefreshListener() {
            @Override
            public void onRefresh() {

                new GetDataTask().execute();

            }
        });
}

// refresh  
private void refresh(ArrayList<Match_ItemDetails> arrayList){
  lv1.setAdapter(new Resultats_ListBaseAdapter(this, arrayList));

}

// asynctask which isn t working

private class GetDataTask extends AsyncTask<Void, Void, ArrayList<Match_ItemDetails>> {
    ArrayList<Match_ItemDetails> tableau;

    @Override
    protected ArrayList<Match_ItemDetails> doInBackground(Void... params) {
            Log.i(MainActivity.class.getName(),"doinBackground");
            StrictMode.ThreadPolicy policy = new         StrictMode.ThreadPolicy.Builder().permitAll().build();
            StrictMode.setThreadPolicy(policy);
            tableau = GetSearchResults();
            System.out.println("pouet");
        return tableau;
    }

    @Override
    protected void onPostExecute(ArrayList<Match_ItemDetails> result) {
            refresh(result);
            lv1.onRefreshComplete();

    }
}

// construction of the arraylist

private ArrayList<Match_ItemDetails> GetSearchResults(){

  StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
  StrictMode.setThreadPolicy(policy); 

  String lireResultats = lireResultats();

  try {
      JSONArray jsonArray = new JSONArray(lireResultats);
      Log.i(MainActivity.class.getName(),
          "Number of entries " + jsonArray.length());
      for (int i = 0; i < jsonArray.length(); i++) {
        JSONObject jsonObject = jsonArray.getJSONObject(i);
        Match_ItemDetails item_details = new Match_ItemDetails();
        item_details.setNameTeam1(jsonObject.getString("equipe1"));
        item_details.setNameTeam2(jsonObject.getString("equipe2"));
        item_details.setDate(jsonObject.getString("date"));
        item_details.setScoreTeam1(jsonObject.getInt("scoreEquipe1"));
        item_details.setScoreTeam2(jsonObject.getInt("scoreEquipe2"));
        item_details.setEstFini(jsonObject.getInt("estFini"));
        item_details.setDrapeauEquipe1(jsonObject.getString("drapeauEquipe1"));
        item_details.setDrapeauEquipe2(jsonObject.getString("drapeauEquipe2"));
        if (!existe(item_details.getDrapeauEquipe1())){
            enregistrer(item_details.getDrapeauEquipe2());              
        }
        if (!existe(item_details.getDrapeauEquipe2())){
            enregistrer(item_details.getDrapeauEquipe2());
        }
        item_details.setDrapeau1(getImage(item_details.getDrapeauEquipe1()));
        item_details.setDrapeau2(getImage(item_details.getDrapeauEquipe2()));

        results.add(item_details);
      }
    } catch (Exception e) {
      e.printStackTrace();
    }

  return results;
 }

// get data

public String lireResultats() {
StringBuilder builder = new StringBuilder();
HttpClient client = new DefaultHttpClient();
HttpGet httpGet = new HttpGet("****/resultats.php");
try {
  HttpResponse response = client.execute(httpGet);
  StatusLine statusLine = response.getStatusLine();
  int statusCode = statusLine.getStatusCode();
  if (statusCode == 200) {
    HttpEntity entity = response.getEntity();
    InputStream content = entity.getContent();
    BufferedReader reader = new BufferedReader(new InputStreamReader(content));
    String line;
    while ((line = reader.readLine()) != null) {
      builder.append(line);
    }
  } else {
    Log.e(MainActivity.class.toString(), "Failed to download file");
  }
 } catch (ClientProtocolException e) {
   e.printStackTrace();
 } catch (IOException e) {
   e.printStackTrace();
 }
 return builder.toString();
 }

 // test if the file exists

 public boolean existe(String nom){
    File tmp = new File(this.getFilesDir() + File.separator + nom);
    return tmp.exists();
}

// return a pict
public Bitmap getImage(String nom){
  Bitmap drawable = BitmapFactory.decodeFile(this.getFilesDir() + File.separator + nom);
  return drawable;
}

// save a pict
public void enregistrer(String nom){
  try
  {
URL u = new URL("http://www.centrale7.com/paris/android/drapeaux48/" + nom + ".png");
URLConnection conn = u.openConnection();
conn.connect();
InputStream is = new BufferedInputStream(conn.getInputStream());
Bitmap bm1 = BitmapFactory.decodeStream(is);
// Bitmap bm1 = BitmapFactory.decodeResource(getResources(), R.drawable.test);
FileOutputStream fout = openFileOutput(nom, Context.MODE_PRIVATE); 
bm1.compress(Bitmap.CompressFormat.PNG, 100, fout); 
          }
  catch(Exception e){
    System.out.println("ca marche pas");
    System.out.println(e);
    e.printStackTrace();
  }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T07:37:47.013

起初，由于您使用的是 AsyncTask ，因此无需调用

```
strictMode.ThreadPolicy 
```

你不应该叫它。只需执行`JSON`解析

```
tableau = GetSearchResults();
return tableau; 
```

然后在您为适配器设置新数据源后的刷新方法中，您需要调用

```
adapter.notifyDataSetChanged(); 
```

适配器不知道您何时更改数据源并且不会自行刷新。您需要通过调用上面提到的方法来确保它。

# java - Java客户端服务

> ID：15535631
> 
> 赞同：0
> 
> 时间：2013-03-20T22:02:03.720
> 
> 标签：java, client-server

我需要做的基本上是一个Java客户端/服务器程序，客户端要求服务器执行加法或乘法。客户端向服务器发送一个对象，该对象包含请求的操作（加法或乘法）和服务器必须处理的一系列数字（加法或乘法）。数字是从控制台发送的，由用户编写。

服务器接收对象，进行计算并返回答案。这是我到目前为止的代码。我不知道如何将 add 函数放入对象，将其发送到服务器，发送 te 号码，以便服务器可以对它们进行操作。

```
 package esercizio3;
         import java.io.*;
         import java.net.*;

         public class Client{

     public static void main(String[] args) throws Exception {
    Socket communication = new Socket("localhost",8888);
    BufferedReader response = new BufferedReader(
                    new  InputStreamReader(communication.getInputStream()));
    PrintWriter request = new PrintWriter(communication.getOutputStream());
    BufferedReader stdIn = new BufferedReader( new InputStreamReader(System.in));

    request.println(stdIn.readLine());
    String line = response.readLine();
    System.out.println(line);

    response.close();
    request.close();
    stdIn.close();
    communication.close();

}
   }

 package esercizio3;
 import java.io.*;
 import java.net.*;

 public class Server {

public static void main(String[] args) throws Exception {
    ServerSocket listener = new ServerSocket(8888);
    Socket communication = listener.accept();
    BufferedReader request = new BufferedReader(
                        new InputStreamReader(communication.getInputStream()));
    PrintWriter response = new PrintWriter(communication.getOutputStream());
    String line;
    while((line = request.readLine()) != "FINE"){
            a = request.
            response.println("Hai detto: " +line);
    }

    request.close();
    response.close();
    communication.close();
    listener.close();

}

   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:22:34.643

**客户**

```
package esercizio3;
import java.io.*;
import java.net.*;

public class Client{
    public static void main(String[] args) throws Exception {
        Socket communication = new Socket("localhost",8888);
        BufferedReader response = new BufferedReader(
                                  new  InputStreamReader(communication.getInputStream()));
        PrintWriter request = new PrintWriter(communication.getOutputStream());
        BufferedReader stdIn = new BufferedReader( new InputStreamReader(System.in));
        String userInput = stdIn.readLine();
        if (userInput.equals("FINE")){//    All calculations are finished
            request.println("FINE");
        }else{
            StringBuffer sbUserInput = new StringBuffer();
            while(!userInput.equals("SEND")){   //  Get input from user until SEND command received and prepare a string which you have to process in server
                sbUserInput.append(userInput).append(" ");//Add the user input along with a space which eases our server task.
                userInput = stdIn.readLine();
            }
            request.println(sbUserInput.toString());    //  Send it to server
        }
        String line = response.readLine();
        System.out.println(line);
        response.close();
        request.close();
        stdIn.close();
        communication.close();
    }
} 
```

**服务器**

```
package esercizio3;
import java.io.*;
import java.net.*;

public class Server {
    public static void main(String[] args) throws Exception {
        ServerSocket listener = new ServerSocket(8888);
        Socket communication = listener.accept();
        BufferedReader request = new BufferedReader(
                                 new InputStreamReader(communication.getInputStream()));
        PrintWriter response = new PrintWriter(communication.getOutputStream());
        String line;
        while((line = request.readLine()) != "FINE"){
            //  Read each string separated by space in the line and check if it is a number or + Or *
            String[] lineContents = line.split(" ");
            int result = 0;
            for(String lineContent : lineContents){
                //  Check if it is + OR *
                //  Take proper action and update "result"
            }
            //  Send the response back to the client
            response.println("Hai detto: " +line);
        }
        request.close();
        response.close();
        communication.close();
        listener.close();
    }
} 
```

# regex - 如何使用 vim 查找带下划线的字符串

> ID：15535632
> 
> 赞同：0
> 
> 时间：2013-03-20T22:02:05.020
> 
> 标签：regex, vim

我想使用替换字符串 IP_HD_LEN

```
:s/IP_HD_LEN/IP_HDR_LEN 
```

然而，在 vim 中，我得到了

```
E486: Pattern not found: IP_HD_LEN 
```

这有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:03:19.443

`:%s/IP_HD_LEN/IP_HDR_LEN/g`将如何做到这一点。

这表示搜索整个文档并进行替换。

@Kent 在下面的评论中的一个有效观点。通过添加命令，您正在对**每个**IP_HD_LEN实例`/g`执行此替换操作。如果你只想替换第一个实例，你会跳过它并最终得到这个：**`:%s/IP_HD_LEN/IP_HDR_LEN`**

# c# - 单声道错误格式异常，但不在 Windows 上

> ID：15535634
> 
> 赞同：2
> 
> 时间：2013-03-20T22:02:15.720
> 
> 标签：c#, .net, datetime, mono, formatexception

为什么我在 Mono 上出现此错误但在 Windows 上没有出现此错误？

```
Unhandled Exception: System.FormatException: Invalid format string
at System.DateTime.ParseExact (string,string[],System.IFormatProvider,System.Glo                                                                                                          balization.DateTimeStyles) <0x00127>
at System.DateTime.ParseExact (string,string,System.IFormatProvider,System.Globa                                                                                            lization.DateTimeStyles) <0x0004f>
at System.DateTime.ParseExact (string,string,System.IFormatProvider) <0x0001f>
at (wrapper dynamic-method) object.CallSite.Target (System.Runtime.CompilerServi                                                                                        ces.Closure,System.Runtime.CompilerServices.CallSite,System.Type,object,string,S                                                                                        ystem.Globalization.DateTimeFormatInfo) <0x000f3>
at System.Dynamic.UpdateDelegates.UpdateAndExecute4<System.Type, object, string,                                                                                         System.Globalization.DateTimeFormatInfo, object> (System.Runtime.CompilerServic                                                                                            es.CallSite,System.Type,object,string,System.Globalization.DateTimeFormatInfo) <                                                                                                0x00418>
at TwitterScraper.Program.scrapeTwitter () <0x00a22>
at TwitterScraper.Program.Main (string[]) <0x000bf> 
```

在此处使用此代码

```
DateTime tweettime = DateTime.ParseExact(obj["created_at"].ToString(),
        "ddd MMM dd HH:mm:ss %K yyyy",
        CultureInfo.InvariantCulture.DateTimeFormat); 
```

这用于处理 Twitter 为您提供的时间格式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-19T14:04:33.290

试试这个：

```
DateTimeOffset tweettime = DateTimeOffset.ParseExact(yourInputString,
    "ddd MMM dd HH:mm:ss zzz yyyy", CultureInfo.InvariantCulture); 
```

# javascript - JavaScript - 读取 XML 文档

> ID：15535636
> 
> 赞同：0
> 
> 时间：2013-03-20T22:02:21.193
> 
> 标签：javascript, jquery

我有一个 Youtube 视频 ID，我想获取此 ID 的视频标题。我得到了包含标题的 XML 提要，但不确定如何提取它。

[XML 输出示例](http://gdata.youtube.com/feeds/api/videos/vnUwxDhE1kU)

```
$.ajax({
    url: 'http://gdata.youtube.com/feeds/api/videos/' + videoId
}).done(function ( data ) {
    console.log( data.title ); //does not work
    console.log( data.entry.title ); //does not work
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T22:09:09.940

jQuery 不会自动为您将 XML 转换为 JSON。只需使用 jQuery 将 XML 文档视为 DOM 树。

```
$(function () {
    $.ajax({
        url: 'http://gdata.youtube.com/feeds/api/videos/vnUwxDhE1kU',
        dataType: 'xml'
    }).done(function (data) {
        console.log('done', $(data).find('entry > title').text());
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:26:18.917

您在 data 参数中得到的是一个 XML 文档。JQuery 还将帮助您以更简单的方式获取所需的信息。以下代码有效：

```
$.ajax({
    url: 'http://gdata.youtube.com/feeds/api/videos/vnUwxDhE1kU'
}).done(function ( data ) {
    var $xml = $(data);
    console.log($xml.find('title').text());
}); 
```

有关更多详细信息，请参阅此链接：[http](http://tech.pro/tutorial/877/xml-parsing-with-jquery) ://tech.pro/tutorial/877/xml-parsing-with-jquery 。

# jquery - Json phonegap 返回结果

> ID：15535644
> 
> 赞同：2
> 
> 时间：2013-03-20T22:02:45.147
> 
> 标签：jquery, json, cordova

我正在为 iphone 和 android 制作一个 phonegap 应用程序。我的代码在浏览器中运行良好，但是当我尝试使用 phonegap 时，手机显示 json 结果并且不执行提交函数中的代码，这是我点击提交按钮时得到的图片： [http:// i48.tinypic.com/21l1km0.png](http://i48.tinypic.com/21l1km0.png) 我使用了 $ajax() 和 json.eval() 但我得到了相同的结果，

```
form.onsubmit = function()
{
    var formData = new FormData(form);
    $.ajax({
        type: 'POST',
        data: formData,
        url: 'http://server.com',
        success: function(data){
            console.log("wa3 1");
            alert('Your comment was successfully added');
        },
        error: function(){
            console.log("wa3 2");
            alert('There was an error adding your comment');
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T09:30:27.933

也许你还没有设置你的 php 脚本的编码：

在脚本顶部添加这一行：

```
<?php header('Content-type: application/json'); ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:24:48.577

我认为ajax调用没有被执行。提交按钮发送表单但不使用 ajax。因此，您将被重定向到服务器脚本页面。

要防止这种行为，请添加`return false;`您的事件 onsubmit。

此代码将阻止您的 html 页面发送表单。所以ajax函数可以发送数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T23:46:03.027

您可以将语法更改为以下内容：

```
$('#myform').on ('submit', function (e) {
    e.preventDefault ();
    //rest of your code
}); 
```

或添加

```
return false; 
```

在 onsubmit 函数结束时。

# javascript - 如何根据光标的来源对元素执行操作

> ID：15535647
> 
> 赞同：0
> 
> 时间：2013-03-20T22:02:48.973
> 
> 标签：javascript, jquery, css

我希望这个问题足够清楚，我想根据悬停该元素时光标的来源对元素做“事情”。例如，如果光标来自左侧，则使元素向右滑动，如果光标来自右侧，则向左滑动，如果光标来自底部，则滑动到顶部，如果光标来自顶部，则滑动到底部。我试着自己做，结果不太好，所以不要指望我展示我自己的任何东西，对不起。但我有一个例子给你： http: [//pixelentity.com/](http://pixelentity.com/)

所以，请告诉我一种使用 jQuery 和/或 CSS3 的方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:55:27.340

您可以在它进入阻止的那一刻获得鼠标移动的方向。看例子[http://jsfiddle.net/PNsd5/2/](http://jsfiddle.net/PNsd5/2/)

获取鼠标方向的函数取决于 jsfiddle 表示的代码顶部的变量，如下所示：

```
function getMoveDir(){
    var direction = '';
    if ((disX <= 0) && (disY <= 0)){
        if (disX < disY) {
            direction = 'From right';
        } else {
            direction = 'From top';
        }
    }
    if ((disX >= 0) && (disY >= 0)) {
        if (disY > disX) {
            direction = 'from bottom';
        } else {
            direction = 'from left'
        }
    }
    return direction;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:10:53.033

使用 jquery mouseenter 事件。

您当前显示的代码根据 mouseenter 位置执行不同的动画，然后计算偏移量。因此，您可以尝试计算 mouseenter 的位置，然后确定光标的来源。

然后，您无论如何都可以决定为图片设置动画。

你的辅助函数应该是*mouseenter*、*offset*、*animate*。如果您需要更多帮助，请告诉我。

# php - Zend Framework 2 中的请求处理与 Zend Framework 1 中的请求处理比较

> ID：15535649
> 
> 赞同：-2
> 
> 时间：2013-03-20T22:02:57.840
> 
> 标签：php, zend-framework, request, zend-framework2

在 Keith Pope 的 Zend Framework 1 Bibel “Zend Framework 1.8 Web Application Development”中，ZF1 请求处理描述如下：

> 这个过程可以这样分解：
> 
> 1.  发出请求并创建请求对象。
> 2.  routeStartup 事件被触发。
> 3.  路由器处理请求。
> 4.  触发 routeShutdown 事件。
> 5.  dispatchLoopStartup 事件被触发。
> 6.  调度循环开始。
> 7.  preDispatch 事件被触发。
> 8.  Dispatcher 调用 Action Controller。
> 9.  动作控制器写入响应对象。
> 10.  postDispatch 事件被触发。
> 11.  如果还有要调用的操作，则转到步骤 7。
> 12.  dispatchLoopShutdown 事件被触发。
> 13.  响应被发回。

![在此处输入图像描述](../Images/dcfcc6d48165165ab09c480135b335d6.png)

这仍然适用于 Zend Framework 2 中的请求处理吗？如果没有：什么是新的？新架构看起来如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:46:51.247

ZF2 中的请求流程图与 ZF1 中的不同，因为 ZF2 MVC 是事件驱动的架构。请参阅此处的流程图：

[http://zendframework2.de/en/cheat-sheet.html](http://zendframework2.de/en/cheat-sheet.html)

我认为它有多种语言版本。

希望这可以帮助 ：）

# python - python类的初始化程序中的可选参数

> ID：15535655
> 
> 赞同：22
> 
> 时间：2013-03-20T22:03:20.913
> 
> 标签：python

我想知道是否有人有任何好的方法来快速解释如何有效地和 python 地创建带有可选参数的用户定义的对象。例如，我想创建这个对象：

```
class Object:
    def __init__(self, some_other_object, i, *j, *k):
        self.some_other_object = some_other_object
        self.i = i
        # If j is specified, assume it is = i
        if(j==None):
            self.j = i
        else:
            self.j = j
        # If k is given, assume 0
        if(k==None):
            self.k = 0
        else:
            self.k = k 
```

有一个更好的方法吗？

**编辑：**我更改了代码，使其更广泛，更容易理解。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-03-20T22:14:09.903

您可以设置默认参数：

```
class OpticalTransition(object):
    def __init__(self, chemical, i, j=None, k=0):
        self.chemical = chemical
        self.i = i
        self.k = k
        self.j = j if j is not None else i 
```

如果您没有使用 and 显式调用该类`j`，`k`您的实例将使用您在 init 参数中定义的默认值。因此，当您创建此对象的实例时，您可以正常使用所有四个参数：`OpticalTransition('sodium', 5, 100, 27)`

或者您可以省略带有默认值的参数 `OpticalTransition('sodium', 5)`，这将被解释为`OpticalTransition('sodium', 5, None, 0)`

通过引用参数的名称，您可以使用一些默认值但不是全部：`OpticalTransition('sodium', 5, k=27)`使用`j`'s default 但不是`k`'s。

Python 不允许您将其`j=i`作为默认参数（`i`不是类定义可以看到的现有对象），因此该行使用实际上执行相同操作`self.j`的语句来处理此问题。`if`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-04-26T23:33:14.377

我对stackoverflow太陌生，无法投票或发表评论，但我同意ronak的回答。Gareth Latty 关于默认参数的评论是通过使用 get 方法的 [default] 选项来解决的。

```
dictionary.get(key[, default]) 
```

当有许多可选变量要传递时，使用 **args 允许更少/更易读的代码。它只是将字典键值对作为参数传递。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-20T22:16:22.593

您可以将 args 作为 dict 对象传递并通过 dict 解析以获得您想要的任何内容。如果没有通过，get 函数将返回 None，你可以这样检查是否存在。

```
class Optioncal_transition(object):
  def __init(self, **args):
    self.chemical = args.get('chemical')
    self.i = args.get('i')
    self.j = args.get('j', self.i) 
```

默认情况下，该`get`函数将返回`None`. 因此，如果存在 的值`j`，则将其分配给 self.j 否则将分配与相同的值`i`

# java - ImageIO.read() 在给定一个假定有效的流时无法读取

> ID：15535657
> 
> 赞同：0
> 
> 时间：2013-03-20T22:03:23.500
> 
> 标签：java

这可能是一个明显的错误，但我正在使用这段代码：

```
BufferedImage sheet = null;

    try {
        sheet = ImageIO.read(Game.class.getResourceAsStream("spritesheet.png"));
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

`Game.class.getResourceAsStream("spritesheet.png")`正确打开流，但将该流传递给 read 函数最终返回 null。为什么这会返回 null，我该如何解决？

# xcode - 绘制具有相同颜色背景的图像时发生颜色偏移

> ID：15535658
> 
> 赞同：1
> 
> 时间：2013-03-20T22:03:25.600
> 
> 标签：xcode, macos, rgb, nsbitmapimagerep

我所期望的是输出将是1440x900 背景上的[http://i45.tinypic.com/344ehb5.png](http://i45.tinypic.com/344ehb5.png)图像，具有相同的图像背景颜色（不是红色），这种情况发生了，但是有一个微小的变化使背景颜色比应有的颜色更亮或更暗的颜色。它与色彩空间有关，但我不知道如何处理它。

```
NSURL *myImage;
NSString *tempDir;

tempDir = @"/Users/Maxime/Documents/";
myImage = [NSURL fileURLWithPath: [tempDir stringByAppendingString:@"344ehb5.png"]];
NSLog(@"soundFile: %@", myImage);

NSImage *image = [[NSImage alloc] initWithContentsOfURL:myImage];

NSArray *upper = [self getRGBAsFromImage:image atX:5 andY:5 count:1];

NSColor *color = [upper lastObject];

    NSRect imgRect = NSMakeRect(0.0, 0.0, 1400.0, 900.0);
NSSize imgSize = imgRect.size;

NSBitmapImageRep *offscreenRep = [[[NSBitmapImageRep alloc]
                                   initWithBitmapDataPlanes:NULL
                                   pixelsWide:imgSize.width
                                   pixelsHigh:imgSize.height
                                   bitsPerSample:8
                                   samplesPerPixel:4
                                   hasAlpha:YES
                                   isPlanar:NO
                                   colorSpaceName:NSCalibratedRGBColorSpace
                                   bitmapFormat:NSAlphaFirstBitmapFormat
                                   bytesPerRow:0
                                   bitsPerPixel:0] autorelease];

// set offscreen context
NSGraphicsContext *g = [NSGraphicsContext graphicsContextWithBitmapImageRep:offscreenRep];
[NSGraphicsContext saveGraphicsState];
[NSGraphicsContext setCurrentContext:g];

//Set color of drawing, and fill the rectangle, so we can see it's boundaries.
[color setFill];
NSRectFill(imgRect);

//add image
NSRect shot = NSMakeRect(500.0, 300.0, 400.0, 300.0);
[image drawInRect:shot fromRect:NSZeroRect operation:NSCompositeSourceOver fraction:1.0];
[NSGraphicsContext restoreGraphicsState];

// create an NSImage and add the rep to it
NSImage *img = [[[NSImage alloc] initWithSize:imgSize] autorelease];
[img addRepresentation:offscreenRep];
NSData *imagef = [[img TIFFRepresentation] retain];    
[imagef writeToFile: @"/Users/Maxime/Desktop/test.png" atomically: NO]; 
```

我正在使用此代码来获取像素数据：

```
- (NSArray*)getRGBAsFromImage:(NSImage*)image atX:(int)xx andY:(int)yy count:(int)count
{
    NSMutableArray *result = [NSMutableArray arrayWithCapacity:count];

    // create the image somehow, load from file, draw into it...
    CGImageSourceRef source;
    source = CGImageSourceCreateWithData((CFDataRef)[image TIFFRepresentation], NULL);

    // First get the image into your data buffer
    CGImageRef imageRef = CGImageSourceCreateImageAtIndex(source, 0, NULL);
    NSUInteger width = CGImageGetWidth(imageRef);
    NSUInteger height = CGImageGetHeight(imageRef);
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    unsigned char *rawData = (unsigned char*) calloc(height * width * 4, sizeof(unsigned char));
    NSUInteger bytesPerPixel = 4;
    NSUInteger bytesPerRow = bytesPerPixel * width;
    NSUInteger bitsPerComponent = 8;
    CGContextRef context = CGBitmapContextCreate(rawData, width, height,
                                                 bitsPerComponent, bytesPerRow, colorSpace,
                                                 kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);
    CGColorSpaceRelease(colorSpace);

    CGContextDrawImage(context, CGRectMake(0, 0, width, height), imageRef);
    CGContextRelease(context);

    // Now your rawData contains the image data in the RGBA8888 pixel format.
    int byteIndex = (bytesPerRow * yy) + xx * bytesPerPixel;
    for (int ii = 0 ; ii < count ; ++ii)
    {
        CGFloat red   = (rawData[byteIndex]     * 1.0) / 255.0;
        CGFloat green = (rawData[byteIndex + 1] * 1.0) / 255.0;
        CGFloat blue  = (rawData[byteIndex + 2] * 1.0) / 255.0;
        CGFloat alpha = (rawData[byteIndex + 3] * 1.0) / 255.0;
        byteIndex += 4;

        NSColor *acolor  = [NSColor colorWithCalibratedRed:red green:green blue:blue alpha:alpha];

        [result addObject:acolor];
    }

    free(rawData);

    return result;
} 
```

# c# - 如何测试 Hotmail 帐户是否存在？

> ID：15535659
> 
> 赞同：-2
> 
> 时间：2013-03-20T22:03:33.560
> 
> 标签：c#, asp.net, network-programming, websocket, hotmail

我正在尝试测试我的 hotmail 帐户是否存在，但以下代码对我没有帮助。

```
public bool IsExists_SMTPMethod(string email)
{
    string domain = email.Substring(email.IndexOf("@") + 1);
    var servers = _commander.GetMXServers(domain);

    Socket socket = null;

    foreach (MXServer mxserver in servers)
    {
        IPHostEntry ipHost = Dns.Resolve(mxserver.MailExchanger);
        IPEndPoint endPoint = new IPEndPoint(ipHost.AddressList[0], 25);
        socket = new Socket(endPoint.AddressFamily, SocketType.Stream, ProtocolType.Tcp);
        socket.Connect(endPoint);

        if (!CheckResponse(socket, ResponseEnum.ConnectSuccess))
        {
            socket.Close();
        }
        else
        {
            // If connected, send SMTP commands
            {
                SendData(socket, string.Format("HELO {0}\r\n", "machinename"));
                if (!CheckResponse(socket, ResponseEnum.GenericSuccess))
                {
                    socket.Close();
                    continue;
                }

                SendData(socket, string.Format("MAIL FROM:  <{0}>\r\n", "from@domain.com"));
                CheckResponse(socket, ResponseEnum.GenericSuccess);

                SendData(socket, string.Format("RCPT TO:  <{0}>\r\n", email));
                bool result = CheckResponse(socket, ResponseEnum.GenericSuccess);
                if (!result)
                {
                    socket.Close();
                    continue;
                }
                else
                    return true;
            }
        }
    }

    return false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:06:59.653

这方面有很多问题，其中很多都有相同的一般答案。如果您要发送到的 SMTP 服务器允许，您可以使用 RCPT TO、VRFY 或 EXPN 等 SMTP 命令确认电子邮件地址是否存在。

问题是，看起来hotmail 不允许这样做。

以下代码适用于 gmail（并验证用户是否在那里），但您不能使用它来验证 hotmail 地址 - 他们的 SMTP 服务器对所有内容都返回无效。

```
var email = "invalidemailasifnasiofnasonfaso@gmail.com";
TcpClient tClient = new TcpClient("gmail-smtp-in.l.google.com", 25);
string CRLF = "\r\n";
byte[] dataBuffer;
string ResponseString;
NetworkStream netStream = tClient.GetStream();
StreamReader reader = new StreamReader(netStream);
ResponseString = reader.ReadLine();
/* Perform HELO to SMTP Server and get Response */
dataBuffer = BytesFromString("HELO KirtanHere" + CRLF);
netStream.Write(dataBuffer, 0, dataBuffer.Length);
ResponseString = reader.ReadLine();
dataBuffer = BytesFromString("MAIL FROM:<test@gmail.com>" + CRLF);
netStream.Write(dataBuffer, 0, dataBuffer.Length);
ResponseString = reader.ReadLine();
/* Read Response of the RCPT TO Message to know from google if it exist or not */
dataBuffer = BytesFromString("RCPT TO:<"+email+">"+CRLF);
netStream.Write(dataBuffer, 0, dataBuffer.Length);
ResponseString = reader.ReadLine();
if (GetResponseCode(ResponseString) == 550)
{
    Console.WriteLine("Mail Address Does not Exist");
    Console.WriteLine("Original Error from Smtp Server "+ResponseString);
}
else
{
    Console.WriteLine("Original response from Smtp Server "+ResponseString);
}
/* QUITE CONNECTION */
dataBuffer = BytesFromString("QUITE" + CRLF);
netStream.Write(dataBuffer, 0, dataBuffer.Length);
tClient.Close(); 
```

像这样的东西会让你登录到 hotmail 的 SMTP 以发送电子邮件，但只要你的凭据正确，它就不会返回电子邮件是否正确。

```
try
{
    SmtpClient SmtpServer = new SmtpClient("smtp.live.com"); 
    SmtpServer.EnableSsl = true;
    SmtpServer.UseDefaultCredentials = false;
    SmtpServer.Port = 587;
    SmtpServer.Credentials = new System.Net.NetworkCredential("test@hotmail.com", "password");
    var message = new MailMessage {
    From = new MailAddress("asd@hotmail.com"),
    Subject = "test"

    };

    message.To.Add("sodfinaosidgnoasbeguosebofubasgfsgrsgr@hotmail.com");
    SmtpServer.Send(message);
}
catch(SmtpException x)
{
    //This unfortunately only really calls authentication failures
    Console.WriteLine(x.ToString());
} 
```

我建议在您的电子邮件中向这些人发送一个激活链接，如果他们单击它，它会将他们的电子邮件设置为已验证，以便您知道您可以向他们发送电子邮件。然后，您还必须确保您不会发送未经身份验证的电子邮件，否则您会将电子邮件发送到一个巨大的黑洞。

这里有一些过去问过这个问题的人的参考资料。

[验证以查看其邮箱中是否存在电子邮件](https://stackoverflow.com/questions/7778524/validating-to-see-if-an-email-exists-in-its-mailbox)

[我可以使用 .net 检查电子邮件地址是否存在吗？](https://stackoverflow.com/questions/3883518/can-i-check-if-an-email-address-exists-using-net)

[如何检查给定的电子邮件地址是否确实存在于c#中？](https://stackoverflow.com/questions/3797961/how-to-check-if-a-given-email-address-actually-exist-in-c)

# callback - PulseAudio：线程主循环数据回调

> ID：15535661
> 
> 赞同：3
> 
> 时间：2013-03-20T22:03:40.873
> 
> 标签：callback, pulseaudio

我有一个关于如何使用线程主循环数据回调功能的问题。我一直在查看文档并尝试一下。为了尝试数据回调，我采用了 AsyncDeviceList 示例，将主循环更改为线程主循环，并尝试在此处使用 pa_threaded_mainloop_signal(ml,1) 和 pa_threaded_mainloop_accept() 进行回调。我不确定我是否将信号（ml，1）放在错误的位置，但程序为我挂起。我注意到在回调调用signal(1) 之后，当wait() 唤醒时，get_state() 的返回值仍然是OPERATION_RUNNING。据我了解，这是有道理的，因为需要调用 accept() 才能使信号继续进行。但是，文档的数据回调示例是这样编码的，所以我 ma 有点迷失了如何正确地去做这件事。一些帮助和澄清会有所帮助。此外，我将在解决后将此示例添加到 pulseaudio wiki 页面。

ps 我复制了下面的代码。编译：'gcc -Wall -o pulsedevicelist pulsedevicelist.c -lpulse' 资源： [http ://freedesktop.org/software/pulseaudio/doxygen/threaded_mainloop.html](http://freedesktop.org/software/pulseaudio/doxygen/threaded_mainloop.html) [http://www.freedesktop.org/wiki/Software/PulseAudio /Documentation/Developer/Clients/Samples/AsyncDeviceList](http://www.freedesktop.org/wiki/Software/PulseAudio/Documentation/Developer/Clients/Samples/AsyncDeviceList)

```
#include <stdio.h>
#include <string.h>
#include <pulse/pulseaudio.h>
#include <pulse/stream.h>

// Field list is here: http://0pointer.de/lennart/projects/pulseaudio/doxygen/structpa__sink__info.html
typedef struct pa_devicelist {
        uint8_t initialized;
        char name[512];
        uint32_t index;
        char description[256];
} pa_devicelist_t;

void pa_state_cb(pa_context *c, void *userdata);
void pa_sinklist_cb(pa_context *c, const pa_sink_info *l, int eol, void *userdata);
void pa_sourcelist_cb(pa_context *c, const pa_source_info *l, int eol, void *userdata);
int pa_get_devicelist(pa_devicelist_t *input, pa_devicelist_t *output);

pa_threaded_mainloop *pa_ml;

int main(int argc, char *argv[]) {
    int ctr;

    // This is where we'll store the input device list
    pa_devicelist_t pa_input_devicelist[16];

    // This is where we'll store the output device list
    pa_devicelist_t pa_output_devicelist[16];

    if (pa_get_devicelist(pa_input_devicelist, pa_output_devicelist) < 0) {
        fprintf(stderr, "failed to get device list\n");
        return 1;
    }

    for (ctr = 0; ctr < 16; ctr++) {
        if (! pa_output_devicelist[ctr].initialized) {
            break;
        }
        printf("=======[ Output Device #%d ]=======\n", ctr+1);
        printf("Description: %s\n", pa_output_devicelist[ctr].description);
        printf("Name: %s\n", pa_output_devicelist[ctr].name);
        printf("Index: %d\n", pa_output_devicelist[ctr].index);
        printf("\n");
    }

    for (ctr = 0; ctr < 16; ctr++) {
        if (! pa_input_devicelist[ctr].initialized) {
            break;
        }
        printf("=======[ Input Device #%d ]=======\n", ctr+1);
        printf("Description: %s\n", pa_input_devicelist[ctr].description);
        printf("Name: %s\n", pa_input_devicelist[ctr].name);
        printf("Index: %d\n", pa_input_devicelist[ctr].index);
        printf("\n");
    }

    return 0;
}

int pa_get_devicelist(pa_devicelist_t *input, pa_devicelist_t *output) {
    // Define our pulse audio loop and connection variables
    //pa_threaded_mainloop *pa_ml;
    pa_mainloop_api *pa_mlapi;
    pa_operation *pa_op;
    pa_context *pa_ctx;

    pa_operation_state_t temp;

    // We'll need these state variables to keep track of our requests
    int state = 0;
    int pa_ready = 0;

    // Initialize our device lists
    memset(input, 0, sizeof(pa_devicelist_t) * 16);
    memset(output, 0, sizeof(pa_devicelist_t) * 16);

    // Create a mainloop API and connection to the default server
    pa_ml = pa_threaded_mainloop_new();
    pa_mlapi = pa_threaded_mainloop_get_api(pa_ml);
    pa_ctx = pa_context_new(pa_mlapi, "test");

    //pa_stream *s = pa_stream_new(pa_ctx, "stream", &ss, &map);

    // This function connects to the pulse server
    pa_context_connect(pa_ctx, NULL, PA_CONTEXT_NOFLAGS, NULL);

    // This function defines a callback so the server will tell us it's state.
    // Our callback will wait for the state to be ready.  The callback will
    // modify the variable to 1 so we know when we have a connection and it's
    // ready.
    // If there's an error, the callback will set pa_ready to 2
    pa_context_set_state_callback(pa_ctx, pa_state_cb, &pa_ready);
    pa_threaded_mainloop_start(pa_ml);
    // Now we'll enter into an infinite loop until we get the data we receive
    // or if there's an error
    for (;;) {
        // We can't do anything until PA is ready, so just iterate the mainloop
        // and continue
        if (pa_ready == 0) {
            //pa_mainloop_iterate(pa_ml, 1, NULL);
            continue;
        }
        // We couldn't get a connection to the server, so exit out
        if (pa_ready == 2) {
            pa_context_disconnect(pa_ctx);
            pa_context_unref(pa_ctx);
            pa_threaded_mainloop_free(pa_ml);
            return -1;
        }
        // At this point, we're connected to the server and ready to make
        // requests
        switch (state) {
            // State 0: we haven't done anything yet
            case 0:
                // This sends an operation to the server.  pa_sinklist_info is
                // our callback function and a pointer to our devicelist will
                // be passed to the callback The operation ID is stored in the
                // pa_op variable

                pa_threaded_mainloop_lock(pa_ml);

                pa_op = pa_context_get_sink_info_list(pa_ctx,
                        pa_sinklist_cb,
                        output
                        );

                 while (pa_operation_get_state(pa_op) == PA_OPERATION_RUNNING) { // MF
                     temp = pa_operation_get_state(pa_op); // MF
                     pa_threaded_mainloop_wait(pa_ml); // MF
                 } // MF
                // Update state for next iteration through the loop
                state++;
                break;
            case 1:
                // Now we wait for our operation to complete.  When it's
                // complete our pa_output_devicelist is filled out, and we move
                // along to the next state
                if (pa_operation_get_state(pa_op) == PA_OPERATION_DONE) {
                    pa_operation_unref(pa_op);

                    pa_threaded_mainloop_accept(pa_ml); // MF
                    pa_threaded_mainloop_unlock(pa_ml); // MF

                    // Now we perform another operation to get the source
                    // (input device) list just like before.  This time we pass
                    // a pointer to our input structure
                    pa_threaded_mainloop_lock(pa_ml);

                    pa_op = pa_context_get_source_info_list(pa_ctx,
                            pa_sourcelist_cb,
                            input
                            );

                    // Update the state so we know what to do next
                    state++;
                }
                break;
            case 2:
                if (pa_operation_get_state(pa_op) == PA_OPERATION_DONE) {
                    // Now we're done, clean up and disconnect and return
                    pa_operation_unref(pa_op);
                    pa_context_disconnect(pa_ctx);
                    pa_context_unref(pa_ctx);
                    pa_threaded_mainloop_free(pa_ml);
                    return 0;
                }
                break;
            default:
                // We should never see this state
                fprintf(stderr, "in state %d\n", state);
                return -1;
        }
        // Iterate the main loop and go again.  The second argument is whether
        // or not the iteration should block until something is ready to be
        // done.  Set it to zero for non-blocking.
        //pa_mainloop_iterate(pa_ml, 1, NULL);
    }
}

// This callback gets called when our context changes state.  We really only
// care about when it's ready or if it has failed
void pa_state_cb(pa_context *c, void *userdata) {
        pa_context_state_t state;
        int *pa_ready = (int *)userdata;

        state = pa_context_get_state(c);
        switch  (state) {
                // There are just here for reference
                case PA_CONTEXT_UNCONNECTED:
                case PA_CONTEXT_CONNECTING:
                case PA_CONTEXT_AUTHORIZING:
                case PA_CONTEXT_SETTING_NAME:
                default:
                        break;
                case PA_CONTEXT_FAILED:
                case PA_CONTEXT_TERMINATED:
                        *pa_ready = 2;
                        break;
                case PA_CONTEXT_READY:
                        *pa_ready = 1;
                        break;
        }
}

// pa_mainloop will call this function when it's ready to tell us about a sink.
// Since we're not threading, there's no need for mutexes on the devicelist
// structure
void pa_sinklist_cb(pa_context *c, const pa_sink_info *l, int eol, void *userdata) {
    pa_devicelist_t *pa_devicelist = (pa_devicelist_t *)userdata;
    int ctr = 0;

    // If eol is set to a positive number, you're at the end of the list
    if (eol > 0) {
        pa_threaded_mainloop_signal(pa_ml, 1); // MF
        return;
    }

    // We know we've allocated 16 slots to hold devices.  Loop through our
    // structure and find the first one that's "uninitialized."  Copy the
    // contents into it and we're done.  If we receive more than 16 devices,
    // they're going to get dropped.  You could make this dynamically allocate
    // space for the device list, but this is a simple example.
    for (ctr = 0; ctr < 16; ctr++) {
        if (! pa_devicelist[ctr].initialized) {
            strncpy(pa_devicelist[ctr].name, l->name, 511);
            strncpy(pa_devicelist[ctr].description, l->description, 255);
            pa_devicelist[ctr].index = l->index;
            pa_devicelist[ctr].initialized = 1;
            break;
        }
    }

}

// See above.  This callback is pretty much identical to the previous
void pa_sourcelist_cb(pa_context *c, const pa_source_info *l, int eol, void *userdata) {
    pa_devicelist_t *pa_devicelist = (pa_devicelist_t *)userdata;
    int ctr = 0;

    if (eol > 0) {
        return;
    }

    for (ctr = 0; ctr < 16; ctr++) {
        if (! pa_devicelist[ctr].initialized) {
            strncpy(pa_devicelist[ctr].name, l->name, 511);
            strncpy(pa_devicelist[ctr].description, l->description, 255);
            pa_devicelist[ctr].index = l->index;
            pa_devicelist[ctr].initialized = 1;
            break;
        }
    }

} 
```

# objective-c - 如何在结构中使用动态 C 数组

> ID：15535664
> 
> 赞同：0
> 
> 时间：2013-03-20T22:03:55.250
> 
> 标签：objective-c, dynamic-memory-allocation

我在这里问这个问题之前做了广泛的研究，但我找不到答案。

我有一个简单的结构，其中包含另一个结构的数组和总数：

```
typedef struct {
    int total;
    struct Struct1 arrayOfStructs[];
} Struct2;
Struct2 _myVar;  // the variable I need 
```

*   `arrayOfStructs[]`应该是包含类型结构的 C 数组`Struct1`（此语法无效，因为您需要一个常量值）
*   `total`是的计数`arrayOfStructs`
*   （`Struct1`不相关，它只包含一些原始数据）

问题是我希望这个数组是动态的。我希望能够做到这一点：

```
for (int i = 0; i < _myVar.total; i++) {
    NSLog(@"%d", _myVar.arrayOfStructs[i].index);
} 
```

我尝试了以下方法：

```
typedef struct {
    int total;
    struct Struct1 *arrayOfStructs;  // USING A POINTER HERE
} Struct2;
Struct2 _myVar;  // the variable I need 
```

并添加值：

```
int total = ++_myVar.total;  // increase total count
_myVar.arrayOfStructs = realloc(_myVar.arrayOfStructs, total * sizeof(Struct1));
_myVar.arrayOfStructs[total - 1] = {1, 5.3};  // appending a new value in the array 
```

上面的代码正确地添加了值，但是在将它传入`NSData`并检索它之后，数组项丢失了，我最终得到了一些错误的指针：

```
[NSData dataWithBytes:&_myVar length:sizeof(_myVar) + sizeof(Struct1) * total]; 
```

我怀疑这是因为我需要做`sizeof(_myVar) + sizeof(Struct1) * total`的不仅仅是`sizeof(_myVar)`，所以由于指针地址不同，我最终得到了错误的数据。我认为我没有将数据正确复制到我的结构中。
任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:23:31.853

需要单独编写Struct1的内容：

```
myData = [NSMutableData dataWithBytes:&_myVar length:sizeof(_myVar)];
[myData appendBytes: _myVar.arrayOfStructs length: (_myVar.total * sizeof(Struct1)]; 
```

回读的时候，需要读它的第一部分，忽略你读到的arrayOfStructs的值，根据长度重新分配，剩下的部分读入新分配的指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:17:19.073

_myVar 是一个 Struct2 变量。所以它只有一个整数和一个指针。结构数组不属于 _myVar。

因此，NSData 的长度存在错误。在 &_myVar 中只有一个大小为 sizeof(Struct2) 的结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T22:21:49.080

在 C 中，通常在结构的末尾使用大小为 1 的数组。不知道它是否在 Objective-C 中是标准的。重新分配

```
(total- 1) * sizeof(Struct1) + sizeof(Struct2) 
```

可能工作。

我认为。

编辑：

我的意思是，您可以执行以下操作：

这将是你的结构：

```
typedef struct {
    int total;
    struct Struct1 arrayOfStructs[1];
} Struct2;
Struct2 *_myVar = malloc(sizeof(Struct2)); 
```

这就是添加元素的方式：

```
int total = ++_myVar->total;
realloc(_myVar, (total - 1) * sizeof(Struct1) + sizeof(Struct2));
_myVar->arrayOfStructs[total - 1] = {1, 5.3}; 
```

或类似的东西

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T23:54:08.937

跟踪数组中的元素数量。要添加孩子，请重新 calloc、memcpy，并将孩子设置在数组中。

```
typedef struct Person {
    char *name;
    short age;
    struct Person *children;
    int numberOfChildren;
} Person;

#import <Foundation/Foundation.h>
int main(int argc, char *argv[]) {
    @autoreleasepool {

        NSData *data;
        {
            // setup Carol
            Person ethan = { .name="Ethan", .age=14, .children=nil, .numberOfChildren=0 };
            Person terry = { .name="Terry", .age=16, .children=nil, .numberOfChildren=0 };
            Person carol = { .name="Carol", .age=40, .children=nil, .numberOfChildren=2 };
            carol.children=(Person  *)calloc(carol.numberOfChildren, sizeof(&carol));
            carol.children[0] = ethan;
            carol.children[1] = terry;

            // people
            Person  *people = (Person  *)calloc(1+carol.numberOfChildren, sizeof(*people));
            people[0] = carol;

            size_t bytesToCopy = 1+carol.numberOfChildren * sizeof(*people);
            data = [NSData dataWithBytes:people length:bytesToCopy];
        }

        {
            int elements = 1 + [data length]/sizeof(Person);
            Person  *people = (Person  *)calloc(elements, sizeof(*people));
            size_t bytesToCopy = [data length];
            const void *source = [data bytes];
            memcpy((void*)people, source, bytesToCopy); // memxxx are an ARC no-no

            for (int i = 0; i < 1; i=i+people[i].numberOfChildren) {
                printf("\nname=%s, age=%d, children=%d", people[i].name, people[i].age, people[i].numberOfChildren);
                for (int j = 0; j < people[i].numberOfChildren; j++) {
                     printf("\nname=%s, age=%d, children=%d", people[i].children[j].name, people[i].children[j].age, people[i].children[j].numberOfChildren);
                }
            }
        }

    }
} 
```

印刷

```
name=Carol, age=40, children=2
name=Ethan, age=14, children=0
name=Terry, age=16, children=0 
```

考虑避免所有这些并切换到对象。

# python - Python：对保留“AM”和“PM”的日期时间对象进行排序

> ID：15535666
> 
> 赞同：0
> 
> 时间：2013-03-20T22:03:58.887
> 
> 标签：python, sorting, datetime, strftime, strptime

这是我的问题的简化版本，但这里是它的要点：我有一个脚本，它使用正则表达式对电子邮件进行排序以查找特定模式。我排序的项目之一是收到电子邮件的日期。我使用 datetime 模块来格式化日期字符串，如下所示：

```
 s1 = datetime.strptime(regex_obtained_str, '%B %d, %Y, %I:%M:%S %p').strftime('%m/%d/%Y %I:%M:%S %p') 
```

现在，假设我已经解析了 4 封电子邮件，这些是 Regex 函数的结果：

```
 s1 = 'March 15, 2013 8:58:34 PM'
    s2 = 'March 15, 2013 11:10:10 AM'
    s3 = 'March 15, 2013 11:16:06 AM'
    s4 = 'April 15, 2013 12:02:04 PM' 
```

在 strftime 格式化后变成这样：

```
 s1 = '03/15/2013 08:58:34 PM'
    s2 = '03/15/2013 11:10:10 AM'
    s3 = '03/15/2013 11:16:06 AM'
    s4 = '04/15/2013 12:02:04 PM' 
```

如果我将这些都按随机顺序放在一个列表中并执行 sort() 函数，如下所示：

```
 L = [s2, s1, s3, s4]
    L.sort() 
```

输出是：

```
 ['03/15/2013 08:58:34 PM', '03/15/2013 11:10:10 AM', '03/15/2013 11:16:06 AM', '04/15/2013 12:02:04 PM'] 
```

如您所见，排序时没有考虑“AM”和“PM”。我在 StackOverflow 上查看了许多与此类似的其他问题，所有这些问题都建议在 strptime()/stftime() 函数中将 %H 更改为 %I 以说明 12 小时制，但我已经完成了那。任何人都可以建议在排序时如何考虑 %p 吗？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T22:10:51.383

这里的问题是您正在对字符串进行排序 - Python 不知道这些字符串是时间，所以它只是将它们排序为字符串（这几乎可以工作）。

所以，解决方案是，当它们是日期对象时对它们进行排序，此时，Python 拥有正确排序它们所需的信息：

```
dates = sorted([datetime.strptime(regex_obtained_str, '%B %d, %Y, %I:%M:%S %p') 
                for regex_obtained_str in strings])
l = [date.strftime('%m/%d/%Y %I:%M:%S %p') for date in dates] 
```

这里使用[列表](http://www.youtube.com/watch?v=pShL9DCSIUw)推导轻松地将格式应用于所有对象。

# java - 使用继承在我的域层中添加字段

> ID：15535668
> 
> 赞同：3
> 
> 时间：2013-03-20T22:04:05.110
> 
> 标签：java

我创建了一个名为的类，该类`Base`具有一个存储 a 的字段，`UUID`因为我希望系统中的所有对象都具有该字段。我还希望在`id`可以存储在数据库中的所有对象上命名一个字段。我不会添加它，`Base`因为并非我的域层中的所有对象都将持久保存到数据库中。我可以创建另一个继承`Base`并添加该字段的类，然后让所有需要的类都继承自该字段。

是否应该避免创建为了添加这样的字段而存在的层次结构？有更好的选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:19:27.073

对于非常简单的应用程序，您只能使用继承。但是随着应用程序变得复杂，如果您使用组合，您的类将更加灵活。因此，在接口中定义公共行为、公共字段并要求具有这些公共行为的类来实现它们。为公共接口提供实现，并让您的类将调用委托给实现类。

这是一个例子：

```
interface Uniqueness {
    long getUUID();
    void setUUID(long uuid);
}

interface Storable {
    long getId();
    void setId(long id);
}

class UniquenessSupport implements Uniqueness {

    private long uuid;

    @Override
    public long getUUID() {
        return uuid;
    }

    @Override
    public void setUUID(long uuid) {
        this.uuid = uuid;
    }
}

class StorableSupport implements Storable {
    private long id;

    @Override
    public long getId() {
        return id;
    }

    @Override
    public void setId(long id) {
        this.id = id;
    }
}

class Some implements Uniqueness, Storable {

    private UniquenessSupport uniquenessSupport;
    private StorableSupport storableSupport;

    public Some() {
        uniquenessSupport = new UniquenessSupport();
        storableSupport = new StorableSupport();
    }

    @Override
    public long getUUID() {
        return uniquenessSupport.getUUID();
    }

    @Override
    public void setUUID(long uuid) {
        uniquenessSupport.setUUID(uuid);
    }

    @Override
    public long getId() {
        return storableSupport.getId();
    }

    @Override
    public void setId(long id) {
        storableSupport.setId(id);
    }
} 
```

在这个简单的例子中，有很多样板代码，但是当您向类中添加更多字段和方法时，这是具有灵活性并避免代码重复的唯一方法。如果您将有更多接口，例如：`Payable`，`Sendable`，`Returnable`并且想要创建一个只有`Payable`和 has的新类，则`Uniqueness`使用合适的接口和支持类：仅`Uniqueness`+`UniquenessSupport`和`Payable`+ `PayableSupport`。

另一方面，如果使用继承，您将扩展一些需要包含来自`Payable`,`Sendable`等的所有方法的 Base 类，以适应所有需求，但您的类需要 only`Payable`并且 has `Uniqueness`。通过继承，你也可以实现它`Returnable`，`Storable`等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:05:48.500

这就是继承的真正用途，用于本地化许多不同类之间共有的类属性/行为。您的示例相当简单，但似乎仍然是对继承的合理使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T22:08:35.930

如果 id 所做的只是提供简单的 get/set，我会使用一个接口：IDbEntity 以及 getId() 和可能的 setId() 等方法。

# c# - 如何在没有 ID 的情况下生成对 div 的自动点击？

> ID：15535669
> 
> 赞同：0
> 
> 时间：2013-03-20T22:04:08.603
> 
> 标签：c#, javascript, asp.net, html

我有一个奇怪的问题。如果没有该 div 的 ID，如何通过 javascript 生成对我从 C# 获得的 div 的自动点击？作为一个粗略的想法，我想做的是以下（用外行的话）：

1.  从 C# 方面，我正在解析 html 文档并找到我需要的实际 div。示例 div class="CLASSNAME">CONTENT /div

2.  我需要以某种方式将此 div 从代码隐藏示例 Page.RegisterStartupScript("myScript", FUNCTION_NAME(DIV_HTML);

3.  在 javascript 中生成一个自动点击我刚刚通过的这个 div 元素

我不知何故无法理解 javascript 函数如何通过将此 div 的 HTML 作为参数来生成对 div 的点击。请问各位有什么想法吗？

非常感谢，让

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T03:07:45.847

事件永远不会是自动的，当它是自动的时，它就不是事件。如果您想调用某个函数，只需在正确的位置调用它即可。例如：

```
someElement.click(function(){
   ...
}); 
```

如果你想要它自动，只需调用 {} 中的函数，将其替换为：

```
this.doSomething=function(){
   ...
} 
```

并在正确的位置调用函数 doSomething()。所以注册脚本后可以直接调用函数，不需要触发点击事件。

# python - 如何在服务器端发出 SocketIO 事件

> ID：15535673
> 
> 赞同：20
> 
> 时间：2013-03-20T22:04:33.997
> 
> 标签：python, django, websocket, socket.io, gevent-socketio

我正在运行一个 gevent-socketio Django 应用程序。

我有类似这堂课的东西

```
@namespace('/connect')
class ConnectNamespace(BaseNamespace):

    def on_send(self, data):
        # ... 
```

但是，如果我从 javascript 客户端收到事件，一切正常，例如`send`事件被正确处理

`emit`如果我想在服务器端进行一些活动，我会有点迷茫。我可以在课堂上做到这一点`socket.send_packet`

但是现在我想将一些事件链接到`post_save`信号，所以我想`send_packet`从这个命名空间类之外，这样做的一种方法是

```
ConnectNamespaceInstance.on_third_event('someeventname') 
```

我只是不知道如何获得 ConnectNamespaceInstance 的实例

总结一下，我只想在收到`post_save`信号后向javascript客户端发送一个事件

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-29T17:25:21.283

您可能想要做的是添加一个模块变量来跟踪连接，`_connections`例如：

```
_connections = {}

@namespace('/connect')
class ConnectNamespace(BaseNamespace): 
```

然后添加`initialize`和`disconnect`使用一些你可以稍后引用的快乐标识符的方法：

```
def initialize(self, *args, **kwargs):
    _connections[id(self)] = self
    super(ConnectNamespace, self).initialize(*args, **kwargs)

def disconnect(self, *args, **kwargs):
    del _connections[id(self)]
    super(ConnectNamespace, self).disconnect(*args, **kwargs) 
```

`_connections`当您需要生成事件时，您只需在变量中查找正确的连接，然后使用`emit`.

（没有对此进行任何测试，但我在许多其他语言中使用了类似的模式：看不出有任何理由说明这在 Python 中也不起作用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-09T11:22:08.950

除了费米的回答，我认为这肯定有效。使用 Redis 可能会给您更多的灵活性，并且使用 gevent 中的 greenlet 可能会使这种方法更加“在框架中”，因为您已经在使用 gevent-socketio :D

```
REDIS_HOST = getattr(settings, 'REDIS_HOST', '127.0.0.1')

class YourNamespace(BaseNamespace):

    def _listener(self, channel_label_you_later_call_in_post_save):
        pubsub = redis.StrictRedis(REDIS_HOST).pubsub()
        pubsub.subscribe(chan)
        while True:
            for i in pubsub.listen():
                self.send({'message_data': i}, json=True) 

    def recv_message(self, message):
        if is_message_to_subscribe(message):
            self.spawn(self.listener, get_your_channel_label(message)) 
```

在你的 post_save 中，你可以做

```
red = redis.StrictRedis(REDIS_HOST)
red.publish(channel_label, message_data) 
```

# mysql - MySQL 查询问题；'like' 操作的排序规则的非法混合

> ID：15535674
> 
> 赞同：0
> 
> 时间：2013-03-20T22:04:38.097
> 
> 标签：mysql, pdo

我真的不知道我的以下查询做错了什么；

```
SELECT 
main.id as id, d.name as departmentName, s.name as sectionName, m.fullName as fullName, main.title as title, main.entryDate as entryDate 
FROM pre_tickets as main 

INNER JOIN pre_ticketscategory as d ON d.id = main.mainCategory_id 
INNER JOIN pre_ticketscategory as s ON s.id = main.category_id 
INNER JOIN pre_members as m ON m.id = main.member_id  

WHERE 

main.softDelete = '0' AND 
main.parent_id = '0' AND 
main.status = '0' AND 
(main.id LIKE '%my_query_ł%' OR d.name LIKE '%my_query_ł%' OR s.name LIKE '%my_query_ł%' OR m.fullName LIKE '%my_query_ł%' OR main.title LIKE '%my_query_ł%' OR main.entryDate LIKE '%my_query_ł%') 

ORDER BY main.id desc 
LIMIT 0, 25 
```

**错误**

```
Illegal mix of collations for operation 'like' 
```

**所有 3 个表都是（包括字段）；**

**字符集：** UTF-8

**排序规则：** utf_8_general_ci

我正在使用 PDO（我还直接从 PHPMYAdmin 和 Navicat 运行查询，结果相同）。我使用 UTF-8 进行连接（`SET NAMES utf8`命令）。

当我不使用 JOINS 时，我没有这个问题。

如果我删除**ł**那么一切都按预期工作，没有错误。但是，如果我不这样做，我会收到错误消息。UTF-8 字符集和 utf_8_general_ci 排序规则不应该支持这样的字符吗？

**笔记：**

这是奇怪的部分；

1.  如果我在查询中不使用**ł**那么我的查询有效

    （main.id LIKE '%my_query%' OR d.name LIKE '%my_query%' OR s.name LIKE '%my_query%' OR m.fullName LIKE '%my_query%' OR main.title LIKE '%my_query%'或 main.entryDate LIKE '%my_query%')

2.  如果我在查询中使用**ł**并从查询中删除 main.id 和 main.entryDate 字段，那么我的查询仍然有效；

    （d.name LIKE '%my_query_ł%' OR s.name LIKE '%my_query_ł%' OR m.fullName LIKE '%my_query_ł%' OR main.title LIKE '%my_query_ł%'）

3.  如果我不使用**JOINs**，我可以使用**ł**并且仍然在我的查询中保留 id 和 entryDate 字段而没有任何问题。

    从 pre_tickets 中选择 id、title、entryDate

    在哪里

    softDelete = '0' AND parent_id = '0' AND status = '0' AND (id LIKE '%my_query_ł%' OR title LIKE '%my_query_ł%' OR entryDate LIKE '%my_query_ł%')

    ORDER BY id desc LIMIT 0, 25

**id**是`integer`字段，而**entryDate**是`datetime`字段。

如果有人能解释我做错了什么以及如何解决这个问题，我会很高兴？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-14T11:42:33.517

由于没有答案，我决定回答我自己的问题；

但是我实际上并没有修复它，我发现了问题并尽可能地使查询工作而不会出错。

我的解决方案是从查询中删除所有整数字段。这样我没有得到任何错误。这不是一个好的解决方案，但至少它仍然允许我搜索某些字段而不会出错。

我希望这有帮助。

# sql-server - 获取与每个日期范围的条件匹配的行数

> ID：15535678
> 
> 赞同：0
> 
> 时间：2013-03-20T22:04:54.937
> 
> 标签：sql-server, pivot

我怎样才能得到如下所示的结果。我的查询应该接受**`current date`**作为输入参数。

结果 ：

```
 (Prior 7 - 12 Months)     (Prior 4 - 6 Months)      (Current - 3 Months)
Analysis       3/23/2012-09/20/2012      09/21/2012-12/19/2012      12/20/2012-3/20/2013

Total Active         2                         0                             0 
```

要生成的部分`**Total active**`已完成，如下所示。

```
;WITH x AS 
    (
        SELECT  ID,statusdate,status , row_number() over (partition by ID order by statusdate DESC )  as RN1
        FROM 
            (SELECT ID,statusdate,status,
                   rn = row_number() over (partition by ID order by statusdate ) 
            FROM tblHistory   (nolock)
             WHERE [statusdate] <=  '20120920' AND
             ID in ('2145','2146','4145''7175')
            )  AS A
     )

SELECT  Count(*)  
FROM x 
WHERE rn1 = 1 AND status IN ('Backup','Active') 
```

数据 ：

```
 ID      StatusDate              Status  Order
    2145    2012-04-29              n/a     1
    2145    2012-08-02              Backup  2
    2145    2012-11-09              Active  3
    2145    2012-11-12              Backup  4
    2145    2012-12-13              Pending 5
    2145    2012-12-18              Sold    6
    2146    2012-10-15              Pending 1
    2146    2012-10-15              n/a     2
    2146    2012-12-19              Sold    3
    4145    2012-04-24              Active  1
    4145    2012-04-24              Active  2
    4145    2012-05-22              Pending 3
    4145    2012-09-13              Active  4
    4145    2012-09-13              Active  5
    4145    2012-12-05              Pending 6
    4145    2012-12-19              Sold    7
    7175    2012-11-08              n/a     1
    7175    2012-12-01              Backup  2
    7175    2012-12-05              Active  3
    7175    2012-12-06              Pending 4
    7175    2012-12-19              Sold    5 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:27:10.647

利用 GROUP BY 功能，按日期分组。

最后将您的选择更改为：

```
SELECT  [statusdate], Count(*) 
FROM x 
WHERE
    rn1 = 1
    AND status IN ('Backup','Active')
    AND [statusdate] IN ('2012-09-20', '2012-12-19' , '2013-03-20')
GROUP BY [statusdate]
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:47:28.597

我会像这样使用 case 语句：

```
SELECT
    SUM(CASE WHEN DATEDIFF(month, statusdata, @current_date) BETWEEN 7 AND 12 
        THEN 1 ELSE 0 END) AS 'Prior7to12',
    SUM(CASE WHEN DATEDIFF(month, statusdata, @current_date) BETWEEN 6 AND 4 
        THEN 1 ELSE 0 END) AS 'Prior4to6',
    SUM(CASE WHEN DATEDIFF(month, statusdata, @current_date) BETWEEN 3 AND 0 
        THEN 1 ELSE 0 END) AS 'Prior0to3',
    FROM SomeTable 
```

这将为您提供三列，0-3、4-6 和 7-12 个月各一列。

# java - 在 DocumentListener 中访问 JTextField

> ID：15535679
> 
> 赞同：3
> 
> 时间：2013-03-20T22:04:57.727
> 
> 标签：java, swing, jtextfield, sudoku, documentlistener

所以，我完成了一个数独求解器，但我想改进它。为此，我需要以某种方式`betterJTextField`从`documentListener`. 我正在使用`documentListener`实时读取我的`betterJTextFields`，我遇到的问题是在`insertUpdate(DocumentEvent e)`.

我需要到达`betterJTextfield`发生`DocumentEvent`的地方。例如，如果输入无效，`betterJTextfield`则会变成红色等。

`betterJTextfield`如果你需要知道的话，我把所有的都放在一个矩阵中。数独中的每个字段都处理一个数字。

```
@Override
    public void insertUpdate(DocumentEvent e) {

       //Removed code which checks if the input in the betterJTextField is fine. 

    } 
```

（`JFormattedTextfield`延伸`JTextField`）

```
public class betterJTextField extends JFormattedTextField {
private int row;
private int column;

public betterJTextField(Format format, int row, int column) {
    super(format);
    this.row = row;
    this.column = column;
    // TODO Auto-generated constructor stub
}

public int getRow() {
    return row;
}

public int getColumn() {
    return column;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:17:04.070

我不太明白你在问什么，但我相信这就是你要找的：

```
private static class RedDocumentListener implements DocumentListener {
    private JTextField textField;

    public RedDocumentListener(JTextField textField) {
        this.textField = textField;
    }
    @Override
    public void insertUpdate(DocumentEvent e) {
        textField.setBackground(Color.red);
    }
    @Override
    public void removeUpdate(DocumentEvent e) {
        textField.setBackground(Color.red);
    }
    @Override
    public void changedUpdate(DocumentEvent e) {
        textField.setBackground(Color.red);
    }
} 
```

# .net - 无法加载 .Net 程序集

> ID：15535682
> 
> 赞同：1
> 
> 时间：2013-03-20T22:05:09.773
> 
> 标签：.net, windows, vb.net, dll, .net-assembly

我正在尝试访问在服务器上运行的 VB 程序中的 .Net 程序集。我收到了经常提到的`Could not load file or assembly`错误。我浏览了大约 60 个不同的网页，但我没有做任何事情来修复它。

我将 dll 与我正在启动的可执行文件放在同一目录中。在它显示的 Appbase 中`file://?/c:`，在我看到的研究这个的其他示例中，它们都有`file:///`. 我不知道这是否是问题所在。如果是的话，谁能告诉我如何解决它？我试过搜索，`file://?/`但即使在谷歌和必应中用问号括起来时也会忽略所有特殊字符，据我所知。

错误信息：

```
Unhandled Exception: System.TypeInitializationException: The type initializer for 'cgiTest.modCurrentBalance' threw an exception. ---> System.IO.FileNotFoundException: Could not load file or assembly 'Aspose.Cells, Version=7.4.1.0, Culture=neutral, PublicKeyToken=716fcc553a201e56' or one of its dependencies. The system cannot find the file specified.
File name: 'Aspose.Cells, Version=7.4.1.0, Culture=neutral, PublicKeyToken=716fcc553a201e56'
   at cgiTest.modCurrentBalance..cctor()

=== Pre-bind state information ===
LOG: User = WEBSERVER1\Administrator
LOG: DisplayName = Aspose.Cells, Version=7.4.1.0, Culture=neutral, PublicKeyToken=716fcc553a201e56
 (Fully-specified)
LOG: Appbase = file://?/c:/inetpub/intranet/
LOG: Initial PrivatePath = NULL
Calling assembly : cgiTest, Version=1.0.0.0, Culture=neutral, PublicKeyToken=abaf442583423e6f.
===
LOG: This bind starts in default load context.
LOG: No application configuration file found.
LOG: Using machine configuration file from c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\config\machine.config.
LOG: Post-policy reference: Aspose.Cells, Version=7.4.1.0, Culture=neutral, PublicKeyToken=716fcc553a201e56
LOG: Attempting download of new URL file://?/c:/inetpub/intranet/Aspose.Cells.DLL.
LOG: Attempting download of new URL file://?/c:/inetpub/intranet/Aspose.Cells/Aspose.Cells.DLL.
LOG: Attempting download of new URL file://?/c:/inetpub/intranet/Aspose.Cells.EXE.
LOG: Attempting download of new URL file://?/c:/inetpub/intranet/Aspose.Cells/Aspose.Cells.EXE.

   --- End of inner exception stack trace ---
   at cgiTest.modCurrentBalance.GenerateReport()
   at cgiTest.Module1.ProcessFunction() in q:\visual studio 2010\Projects\cgiTest\cgiTest\Module1.vb:line 65
   at cgiTest.Module1.Main() in q:\visual studio 2010\Projects\cgiTest\cgiTest\Module1.vb:line 41 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T05:40:25.647

执行程序的用户是否有权访问文件和文件夹？可能是文件是从具有不同 ACL 的文件夹中移动而不是复制的，并且代码无法访问它。

最好的检查方法是获取[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)，将其过滤器配置为仅显示对包含“Aspose.Cells”的路径的访问，并查看哪些进程尝试访问该文件，如果它们失败，如果是，为什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T12:32:45.593

我终于能够通过使用[http://support.microsoft.com/kb/837908](http://support.microsoft.com/kb/837908)中描述的事件处理程序来加载它。

在这一点上，我不确定为什么我必须走这条路，但它正在通过我指定二进制文件和 dll 所在的路径来工作，这应该是默认行为。

我唯一能想到的是它与文件路径“file://？/”中的问号有关，它正在寻找 dll，但我不知道为什么会有问号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T06:14:01.647

DLL 不应该在应用程序的 BIN 文件夹中吗？当您的应用程序编译时，它将在那里查找程序集。

# python - Django-503 应用程序维护模板错误

> ID：15535683
> 
> 赞同：0
> 
> 时间：2013-03-20T22:05:14.207
> 
> 标签：python, django, django-templates, settings, http-status-code-503

我最近下载了 coagulant 的[Django-503](https://github.com/coagulant/django-503)应用程序，它会生成一个 503 页面，以便您可以运行维护。

我目前遇到的问题是我从 GitHub 下载了该应用程序并进行了 pip 安装。我遵循了所有的指示。但是，当我尝试打开维护模式时，出现以下错误。

```
Request Method:     POST
Request URL:    http://XX.XXX.XXX.XXX:8000/admin/django_503/config/1/
Django Version:     1.4.3
Exception Type:     TemplateDoesNotExist
Exception Value:    admin_warning.html
Exception Location: /usr/local/lib/python2.7/dist-packages/django/template/loader.py in find_template, line 138 
```

即使来自 GitHub 的包附带了模板，Django 似乎也找不到它们。有什么可能的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T16:56:38.000

我发现问题出在哪里，在进行 pip 安装时，该包没有将 HTML 文件安装到 Django_503 所在的 dist-packages 目录中。您需要在 Django_503 中手动添加一个模板文件夹，然后添加相应的 HTML 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:20:18.820

[设置的TEMPLATE_DIRS](https://docs.djangoproject.com/en/1.5/ref/settings/#template-dirs)中是否包含 admin_warning.html 的路径？

# c# - 在弹出窗口中丢失会话变量

> ID：15535686
> 
> 赞同：0
> 
> 时间：2013-03-20T22:05:32.207
> 
> 标签：c#, asp.net

当我尝试从超链接打开弹出窗口时，我丢失了存储在会话变量中的数据。下面是我的代码

```
 <asp:HyperLink ID="HyperLink1" runat="server" Target="_blank" NavigateUrl='<%#"~/Viewer/DetailsViewer.aspx?ID=" + Eval("Id") + "&QueryID=" + Request.QueryString["QueryID"]%>'
                                                Text="View" /> 
```

上面代码中的会话变量在 IE 中被清除。我使用的版本是 8。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:07:57.607

我不确定 IE8 是否在新窗口中保持会话。要进行测试，请尝试在同一窗口中打开超链接（取出`target="_blank"`）。无论哪种方式，我都建议将其存储在 cookie 中，或者如果它不是敏感数据，则将其与查询字符串一起传递。

# javascript - 为什么 W3 验证需要为图像填充 alt 和 src 属性？

> ID：15535687
> 
> 赞同：0
> 
> 时间：2013-03-20T22:05:33.267
> 
> 标签：javascript, image

我不使用这些属性，因为我稍后会动态添加 src。我也不需要alt。但是，我确实希望我的页面能够验证。我可以通过在 div 中使用 CSS 背景来绕过这个要求。这是一种有效的方法吗？

**澄清：**

*   我不关心搜索引擎。

*   我的图像总是加载。

*   我使用 JavaScript 设置了 src 属性。

*   适用于主要的现代浏览器。

*   还不需要辅助功能。

*   文档类型是 HTML 5 -`<!DOCTYPE html>`

**参考**

[http://validator.w3.org/](http://validator.w3.org/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T22:18:13.843

## 因为它正在验证规范

Html 具有特定的结构，该结构记录在[w3.org](http://www.w3.org/TR/html51/)站点上。w3 验证器验证输入是否符合规范，在这种情况下符合要求：

### [img 标签](http://www.w3.org/TR/html51/embedded-content-0.html#the-img-element)

> src 属性必须存在

没有 src 的 img 标签具有未定义的行为，例如，可能会根据浏览器重新请求当前页面以代替有效图像。

### [alt 属性](http://www.w3.org/TR/html51/embedded-content-0.html#alt)

> 必须指定 alt 属性且其值不能为空

从同一个参考资料中，alt 属性要求的理由：

> [alt 属性] 应该包含用户可以使用的替换文本而不是图像

## 为什么提供无效标记

从问题：

> 我不使用这些属性，因为我稍后会动态添加 src。我也不需要alt。

如果您要动态添加 src（这也意味着没有 javascript 的页面，或者至少这个特定的标记对任何人都没有用） - 为什么不动态添加 img 标签。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T22:18:38.973

坚持使用 Alt 标签至少部分基于各个国家/地区的联邦法律，因为在某些情况和情况下，它被认为是对残疾人的非法歧视，可能会受到一些非常高额的罚款 - 因此，W3 标准明智地坚持它，如果该页面将被视为符合标准。

除了残疾之外，alt 标签还用于各种环境，例如屏幕阅读器、浏览器关闭图像时等。

如果您真的想避免定义 alt 标签，请使用默认标签，例如 alt="Alt tag 由于'原因'而故意留空" 或诸如此类。

至于源属性，它涉及一个事实，即 html 页面必须在运行脚本之前在内部有效，才能被视为符合标准。这是由于在脚本运行后检查标准合规性的复杂性和不可靠性，以及该标准受到“不显眼的脚本”思想的影响 - 页面可以通过脚本增强，但不应该在非绝对必要时坚持为基本功能编写脚本。

现在，如果您有充分的理由必须在运行时定义图像，那么您有两种选择：

1.  使用空白或占位符图像，例如至少 1x1 透明 gif/png。
2.  从 HTML 中完全删除图像并在运行时添加它们，而不是仅仅更改相关的 src 属性。

至于 src 标签，还必须记住，随着应用程序的增长，加载时间会增加，并且根据样式和尺寸等，事情可能会开始变得很奇怪。

总之，即使您认为不需要它们，也请始终使用 Alt 标签，并使用上述两种关于 src 标签的解决方案之一。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T22:18:51.127

该`alt`属性对于基于文本的浏览器、屏幕阅读器等残疾人辅助功能和搜索引擎（其中一些在您的问题的评论中提到）很有用。

您可能也不应该有空的图像标签。这在语义上是错误的（更不用说它未能如您所说的那样验证），并且可能导致您的网站出现[技术问题](http://www.nczonline.net/blog/2009/11/30/empty-image-src-can-destroy-your-site/)。相反，可能有空的“图像持有者”（如`div`或`figure`），并使用动态图像标签填充其内部 HTML 内容。

用 JS设置`src`（甚至静态）不能保证图片的加载。如果网络出现非常严重的故障怎么办？您不能保证所有资源都会正确加载。处理加载不良的 JS 或 CSS 可能会有点荒谬，并且可能超出您的控制范围，但是像`alt`在图像上添加标签这样简单的事情可能是一个非常简单的解决方法。

*仅仅因为您不需要所有这些特性，并不意味着 W3C 在为全世界*制定通用规范时不应该考虑它们。

# javascript - 从另一个外部函数调用 mootools 类方法

> ID：15535688
> 
> 赞同：0
> 
> 时间：2013-03-20T22:05:38.470
> 
> 标签：javascript, class, mootools

我有一个正在使用的遗留 mootools 类，它有很多功能。我没有扩展类，而是尝试从类外部简单地调用类方法之一。因此，如果课程看起来像这样：

```
var myClass = new Class({
    search: function(){
        this.searchSpinner.show();
        this.request.send({data: this.data});
    },

    // many other functions
}) 
```

我需要`search`从加载在同一页面上的另一个脚本调用该方法。

现在我正在尝试这样：

```
window.myClass.search(); 
```

但这会导致我无法理解但看起来像这样的大毛病错误：

```
Uncaught TypeError: Object function (){e(this);if(g.$prototyping){return this;}this.$caller=null;var i=(this.initialize)?this.initialize.apply(this,arguments):this;this.$caller=this.caller=null;
return i;} has no method 'search' 
```

有没有一种“正确”的方式来调用这个方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:09:49.593

使用 Mootool 定义的类的`Class`行为与其他语言中的静态类不同。为了访问该类中的方法，您必须首先创建该类的一个实例：

```
var classObj = new myClass(/*any parameters if required, check the "initialize" method*/);
classObj.search(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:03:16.517

您正在尝试应用“单例”模式：如果您只使用此类的一次，您可以使用：

```
var mySingleton = new new Class({ 
```

（注意 2 x`new`关键字）然后

```
mySingleton.search() 
```

叫它...

哦，如果您尝试将静态函数添加到 mootools 类，只需像这样声明它们：

```
var myClass = new Class({ });
myClass.staticMethod = function() {
    // ...
}; 
```

希望这可以帮助 ！

# extjs - 如何在 ExtJS 4 分页中设置总页数？

> ID：15535691
> 
> 赞同：0
> 
> 时间：2013-03-20T22:05:49.807
> 
> 标签：extjs, extjs4, paging

我不确定它是否可能，但我想知道是否可以设置分页中的页数。那就是我可以设置第 1 页，共 20 页。（如果我将总页数设置为 20）此外，当有人点击下一页时，它将返回取决于页码但可以是任何大小的页面数据我不想限制页面大小。它将是取决于页码的动态页面大小。大多数情况下，当有人提交表单时，我首先要查看的内容是我可以发送页面总数，当他们单击下一个时，它将显示该页面的所有数据。我想知道我是否可以发送总页数作为我们发送数据行总数的 totalProperty。如下所示。我想让页面大小动态化，就像现在的 totalProperty= total 一样。另外我想知道我是否可以设置总页数。

```
var store = Ext.create('Ext.data.Store',{
    model: 'test_data_layout',
    pageSize: '50',
    proxy: {
        type: 'ajax',
        url: url,
        actionMethods: {
            create : 'POST',
            read   : 'POST',
            update : 'POST',
            destroy: 'POST'
            },
        reader: { 
            type: 'json',
            root: 'data',
            totalProperty: 'total'
         }
    },
    autoLoad: true
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:41:54.823

这不是它的工作原理。您告诉它您总共有多少条记录以及您希望将多少条记录放入一个页面中，它会为您计算页面数。简单的。

# javascript - OOP 和 jQuery：如何使用 Deferred() 初始化 var；

> ID：15535692
> 
> 赞同：0
> 
> 时间：2013-03-20T22:05:58.437
> 
> 标签：javascript, oop, jquery-deferred

这是我的 javascript 代码它的目标只是为了教育。我正在学习 js OOP 和 jquery

```
function App() {

this.deviceReadyDeferred = new $.Deferred();

this.init = function() {
    console.log ("Run");
    $.when(this.deviceReadyDeferred).then(this.run);
    document.addEventListener("click", this.onDeviceReady, false);

},

// NB: onDeviceReady non ha parametri evento
this.onDeviceReady = function() {
    console.log("deviceReady");
    this.deviceReadyDeferred.resolve();
},

this.run = function() {
    console.log("main");
}

}

app = new App();
app.init(); 
```

当我点击时，我收到

> 类型错误：this.deviceReadyDeferred 未定义

为什么？

*   我没有收到未定义的“$”，因此 jQuery 运行良好。
*   我在 Win 7 上的 FF 19.0.2 上运行 jQuery 1.9.1

如何使用 deferred 到 javascript 对象中？如何初始化和重用它？

编辑：

此代码正在运行。所有的问题都出在我对`this`. 我是使用 javascript 的 OOP 新手。

```
function App() {

    var self = this;

    this.deviceReadyDeferred = new $.Deferred();

    this.init = function() {
        console.log ("Run");
        $.when(self.deviceReadyDeferred).then(self.run);
        $(document).on("click", self.onClick);

    },

    this.onClick = function() {
        console.log("deviceReady");
        self.deviceReadyDeferred.resolve();
    },

    this.run = function() {
        console.log("main");
    }

}

app = new App();
app.init(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:16:04.393

`this`代替

```
this.onDeviceReady = function() {
    ...
} 
```

`this`和外面不一样。jQuery 通过将数据传递给事件处理程序来解决此问题。

```
function App() {

    this.deviceReadyDeferred = new $.Deferred();

    this.init = function () {
        console.log("Run");
        $.when(this.deviceReadyDeferred).then(this.run);
        $(document).on("click", { App: this }, this.onDeviceReady);
    },

    // NB: onDeviceReady non ha parametri evento
    this.onDeviceReady = function (e) {
        console.log("deviceReady");
        e.data.App.deviceReadyDeferred.resolve();
    },

    this.run = function () {
        console.log("main");
    }

}

app = new App();
app.init(); 
```

[http://jsfiddle.net/6zAN7/17/](http://jsfiddle.net/6zAN7/17/)

或者，如果您不必支持 IE8，则更容易使用本机方法（注意`.bind(this)`）：

```
function App() {

    this.deviceReadyDeferred = new $.Deferred();

    this.init = function () {
        console.log("Run");
        $.when(this.deviceReadyDeferred).then(this.run);
        document.addEventListener("click", this.onDeviceReady.bind(this), false);

    },

    // NB: onDeviceReady non ha parametri evento
    this.onDeviceReady = function () {
        console.log("deviceReady");
        this.deviceReadyDeferred.resolve();
    },

    this.run = function () {
        console.log("main");
    }

}

app = new App();
app.init(); 
```

[http://jsfiddle.net/6zAN7/18/](http://jsfiddle.net/6zAN7/18/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T22:17:57.463

其他答案已经解释了原因，它是`this`回调内部的值。解决它的方法之一是创建一个绑定到特定`this`值的新函数：

```
document.addEventListener("click", this.onDeviceReady.bind(this), false); 
```

如果本机不可用，则需要[垫片。`bind`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind#Compatibility)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T22:19:11.467

正如 Kevin B 所说，`this`它`document`在您的`click`处理程序中，因为您首先绑定到该事件`document`。

解决这种情况的一种简单方法是使用[$.proxy()](http://api.jquery.com/jQuery.proxy/)：

```
document.addEventListener("click", $.proxy(this.onDeviceReady, this), false); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T22:16:19.770

```
this.init = function() {
    console.log ("Run");
    var self = this;
    $.when(this.deviceReadyDeferred).then(self.run);
    document.addEventListener("click", self.onDeviceReady, false);

}, 
```

# c++ - 如何在 QML 中创建自定义基本类型？

> ID：15535694
> 
> 赞同：2
> 
> 时间：2013-03-20T22:06:14.190
> 
> 标签：c++, qt, types, customization, qml

我似乎没有找到任何关于向 QML 添加基本类型的资源。我不是指 QObject 或更高派生的元素，而是基本类型 - bool、int、real 等。

也没有任何运气在来源中挖掘它......

因此，任何信息都值得赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T23:16:14.957

我假设您想要注册比 int、bool、real 更复杂的类型，因为它们已经存在。

在 Qt 4.x 中不能这样做。在 Qt 5 (QML 2) 中是可能的，但没有公共 API。如果您仍想这样做，则需要深入研究一些代码以查看其完成方式，因为没有文档。

您需要实现 QQmlValueTypeProvider (qqmlglobal_p.h) 并为每个类型创建 QQmlValueTypeBase<> 子类 (qqmlvaluetype_p.h)。然后在插件的 registerTypes() 中使用 QQml_addValueTypeProvider() 注册您的值类型提供程序。

您可以查看的一个示例是 QtLocation 模块中的 QGeoCoordinate、QGeoRectangle 等：http: [//qt.gitorious.org/qt/qtlocation/trees/master/src/imports/location](http://qt.gitorious.org/qt/qtlocation/trees/master/src/imports/location)

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:09:29.060

查看[这篇文章](http://qt-project.org/doc/qt-4.8/custom-types.html)和[这篇](http://qt-project.org/doc/qt-4.8/qtbinding.html#using-enumerations-of-a-custom-type)关于如何在 Qt/QML 中创建自定义类型的文章。至于创建自己的原始类型（int、bool、double 等）......我认为如果不深入研究 Qt 语言本身的源代码，这是不可能的，我认为这不是一个好主意.

制作自己的原始类型有什么目的？为什么不能使用语言本身已经定义的那些？

如果您尝试重命名原始类型，则始终可以选择执行**typedef**。“typedef 的目的是为现有类型分配替代名称，通常是那些标准声明繁琐、可能令人困惑或可能因一种实现而异的实现。”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-30T22:16:39.760

从 Qt 5.5 开始，您可以使用[Q_GAGDET](http://doc.qt.io/qt-5/qobject.html#Q_GADGET)创建基本类型。例如，您可以创建一个自定义 MyError 类：

```
class MyError
{
    Q_GADGET
    Q_ENUMS(ErrorType)

    Q_PROPERTY(bool suppressed READ suppressed WRITE setSupressed)
    Q_PROPERTY(QString message READ message WRITE setMessage)
    Q_PROPERTY(ErrorType type READ type WRITE setType)

public:
    enum ErrorType {
        Warning, //Survex should still run
        Fatal, //Survex will not run
        Unknown
    };

    cwSurveyChunkError();
    cwSurveyChunkError(const cwSurveyChunkError &);
    cwSurveyChunkError &operator=(const cwSurveyChunkError &);
    ~cwSurveyChunkError();

    ErrorType type() const;
    void setType(ErrorType type);

    QString message() const;
    void setMessage(QString message);

    bool suppressed() const;
    void setSupressed(bool suppressed);

private:
    QSharedDataPointer<MyErrorData> data;
};

Q_DECLARE_METATYPE(MyError) //Allows you to use this class in QVariant 
```

您需要使用 qmlRegisterUncreatableType 向 qml 注册类型。这允许您在 QML 中使用 MyError.ErrorType 枚举。由于 MyError 是一个 Q_GADGET，您可以将它直接传递给 QML 并使用 MyError 属性，就好像它是一个 QObject 一样。Q_GADGET 对象是 QObject 的轻量级版本，但它们不能在 QML 中创建，并且信号和槽在它们中不起作用。

QML 示例：

```
Item {

   Component.onCompleted: {
        var error = model.errorAt(4); //Returns MyError 
        console.log("Error:" + error.type + " " + error.message + " " + error.suppressed)
   }
} 
```

# php - 如何在 PHP 中编写一个链接，例如指向同一页面的哪个链接？

> ID：15535699
> 
> 赞同：4
> 
> 时间：2013-03-20T22:06:44.407
> 
> 标签：php

 [就像在 HTML 中一样，我可以编写`<a href="#id">`可以链接到我制作`<a id="id">`. 但似乎它在 PHP 中不起作用。怎么做？](#id) 

[原始代码来自引导](#id)[http://twitter.github.com/bootstrap/components.html#navs](http://twitter.github.com/bootstrap/components.html#navs)

```
<div class='tabbable'>
<ul class='nav nav-tabs'>
    <li class='active'><a href='#tab1' data-toggle='tab'>Drinks</a></li>
    <li><a href='#tab2' data-toggle='tab'>Bread</a></li>
</ul>

<div class='tab-content'>
    <div class='tab-pane active' id='tab1'><p>some</p>
    </div>

    <div class='tab-pane' id='tab2'><p>many</p>
    </div>
</div> 
```

但就在我转向 PHP 时，选项卡链接不起作用

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-20T22:10:55.387

编辑：

你想这样做吗？见：http: [//twitter.github.com/bootstrap/javascript.html#tabs](http://twitter.github.com/bootstrap/javascript.html#tabs)

* * *

请参阅工作示例：http: [//jsfiddle.net/U6aKT/](http://jsfiddle.net/U6aKT/)

```
<a href="#id">go to id</a>
<div style="margin-top:2000px;"></div>
<a id="id">id</a> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T22:10:59.183

尝试这个

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html>
    <body>
        <a href="#name">click me</a>
<br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br>
        <div name="name" id="name">here</div>
    </body>
    </html> 
```

# iphone - iOS 使用 ALAsset 仅将照片保存到自定义相册

> ID：15535705
> 
> 赞同：1
> 
> 时间：2013-03-20T22:07:20.987
> 
> 标签：iphone

因为您只能使用框架将图像保存到自定义相册，即使没有将其保存在 iPhone 相机胶卷上`ALAsset`？

为什么当我从相机胶卷中选择要保存在自定义相册中的照片时，我会在相机胶卷中进行复制？

# r - 具有显着差异和相互作用的条形图？

> ID：15535708
> 
> 赞同：11
> 
> 时间：2013-03-20T22:07:40.210
> 
> 标签：r, plot, interaction, significance

我想可视化我的数据和方差分析统计。通常使用带有表示显着差异和相互作用的添加线的条形图来执行此操作。你如何使用 R 制作这样的情节？

这就是我想要的：

# 显着差异：

![显着差异](../Images/2f42592891258c93b2cdd5050f251637.png)

# 重要的相互作用：

![重要的相互作用](../Images/d3197c3628d4402e56dce79320adc3a5.png)

# 背景

我目前正在使用`barplot2{ggplots}`绘制条形图和置信区间，但我愿意使用任何包/程序来完成工作。获取我当前使用的统计数据`TukeyHSD{stats}`或用于差异和用于交互`pairwise.t.test{stats}`的 anova 函数 ( `aov`, `ezANOVA{ez}`, ) 之一。`gls{nlme}`

只是给你一个想法，这是我目前的情节： ![barplot2 与 CI](../Images/012f3ba90f42e673162b4f19415ca36d.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-21T13:02:32.463

当您使用`barplot2()`库中的函数时`gplots`，将给出使用这种方法的示例。

首先，按照`barplot2()`函数帮助文件中的说明制作条形图。`ci.l`并且`ci.u`是假置信区间值。条形图应保存为对象。

```
hh <- t(VADeaths)[1:2, 5:1]
mybarcol <- "gray20"
ci.l <- hh * 0.85
ci.u <- hh * 1.15
mp <- barplot2(hh, beside = TRUE,
               col = c("grey12", "grey82"),
               legend = colnames(VADeaths)[1:2], ylim = c(0, 100),
               cex.names = 1.5, plot.ci = TRUE, ci.l = ci.l, ci.u = ci.u) 
```

如果您查看 object `mp`，它包含所有条形的 x 坐标。

```
 mp
     [,1] [,2] [,3] [,4] [,5]
[1,]  1.5  4.5  7.5 10.5 13.5
[2,]  2.5  5.5  8.5 11.5 14.5 
```

现在我使用上置信区间值来计算段的 y 值的坐标。段将从比置信区间结束高 1 的位置开始。`y.cord`包含四行 - 第一行和第二行对应于第一条，其他两行对应于第二条。最高 y 值是根据每个条形对的置信区间的最大值计算得出的。 `x.cord`值只是重复`mp`对象中的相同值，每次 2 次。

```
y.cord<-rbind(c(ci.u[1,]+1),c(apply(ci.u,2,max)+5),
          c(apply(ci.u,2,max)+5),c(ci.u[2,]+1))
x.cord<-apply(mp,2,function(x) rep(x,each=2)) 
```

使用 barplot 后，`sapply()`使用计算的坐标制作五个线段（因为这次有 5 个组）。

```
sapply(1:5,function(x) lines(x.cord[,x],y.cord[,x])) 
```

要在段上方绘制文本，请计算 x 和 y 坐标，其中 x 是两个条 x 值的中点，y 值是根据每个条对的置信区间的最大值加上一些常数计算得出的。然后使用函数`text()`添加信息。

```
x.text<-colMeans(mp)
y.text<-apply(ci.u,2,max)+7
text(c("*","**","***","NS","***"),x=x.text,y=y.text) 
```

![在此处输入图像描述](../Images/87d0283eb00c57482ccbfb23b2de6af0.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T16:53:18.407

我想现在您的问题已或多或少得到解决，因此我将鼓励您使用不同的方法，这些方法在数据的视觉表示方面要好得多 - 点图。例如，将您的条形图与使用相似数据点构建的点图进行比较：

```
#example data similar to your barplot
d <- data.frame(group=rep(c("control","group1","group2"),each=4),
                esker=c(1.6,1.4,1.8,1.5,2,1.8,1.6,1.4,2.3,2,1.7,1.4),
                se=rep(0.1,12),
                cond=rep(c("t1","t2","t3","t4"),3))
#dotplot - you need Hmisc library for version with error bars
library(Hmisc)
Dotplot(cond ~ Cbind(esker, esker+se, esker-se) | group, data=d, col=1, 
        layout=c(1,3), aspect="xy",
        par.settings = list(dot.line=list(lwd=0), plot.line=list(col=1))) 
```

![在此处输入图像描述](../Images/24035432c51c8ef0297fa55134d1a57f.png)

将其与条形图进行比较。在点图中，水平绘制时更容易看到差异，您不需要额外的图例或条形或颜色来显示条件，您不需要指南和其他嘈杂的元素。您拥有这三个面板中包含的所有内容。当然，我知道您可能想强调您的显着效果，并且它可能适用于少数情况。但是如果因素的数量增加，情节就会充满星星和狗屎。

把事情简单化。保持点图。查看 William Cleveland 和 Edward Tufte 的书籍以了解更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-11T23:11:34.623

我建议使用 ggplot 而不是 barplot，您可以像这样手动构建线条：

这从 data.table 开始，如下所示： [data.table used](https://i.stack.imgur.com/ERgsH.png)

```
gg <- ggplot(data, aes(x = time, y = mean, fill = type)) +
    geom_bar(stat = "identity", position = "dodge") +
    scale_fill_manual(values = c("RGX" = "royalblue2", "EX" = "tomato2")) +
    xlab("Post-treatment Time Point (months)") +
    ylab(paste("data", "Change Score")) +
    scale_y_continuous(expand = c(0, 0)) +
    ylim(c(0,max(data$mean*1.5)))

# add horizontal bars
gg <- gg + geom_errorbar(aes(ymax = hline, ymin = hline), width = 0.45)

# add vertical bars
gg <- gg + geom_linerange(aes(ymax = max(data$mean)+3, ymin = max(data$mean)+1), position = position_dodge(0.9))

# add asterisks   
gg <- gg + geom_text(data = data[1:2], aes(y = max(data$mean)+4), label = ifelse(data$p_value[1:2] <= 0.4, "*", ifelse(data$p_value[1:2] <= 0.05, "*", "")), size = 8)

gg 
```

[绘图输出](https://i.stack.imgur.com/PDgql.png)

# c++ - 在构造函数中初始化多个相关 const 属性的最简单方法？

> ID：15535711
> 
> 赞同：13
> 
> 时间：2013-03-20T22:07:45.437
> 
> 标签：c++, constructor, constants

当 C++ 类的多个 const 属性依赖于一些中间计算时，初始化它们的最简单方法是什么？

例如，如何更正下面类的构造函数？

```
class MyClass {
public:
    const int a;
    const int b;

    MyClass() {
        int relatedVariable = rand() % 250;
        a = relatedVariable % 100;
        b = abs(relatedVariable - 150);
    }
}; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-20T22:46:21.593

With C++11, you can simply use a delegating constructor:

```
class MyClass
{
public:
    const int a;
    const int b;

private:
    MyClass( int relatedVariable )
      : a( relatedVariable % 100 ),
        b( abs( relatedVariable - 150 ) ) {}

public:
    MyClass() : MyClass( rand() % 250 ) {}
}; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-20T22:23:23.163

这是使用委托构造函数的迂回解决方案：

```
class MyClass
{
    MyClass(int aa, int bb) : a(aa), b(bb) { }

    static MyClass Maker() { int x = /* ... */; return MyClass(x * 2, x * 3); }

    int const a;
    int const b;

public:
    MyClass(MyClass const &) = default;
    MyClass() : MyClass(Maker()) { }
}; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-20T22:19:01.700

这对于我们这些碰巧喜欢在编码方面不太先进的人来说有点*用：*

```
class MyClass {
public:

    int iamStupid;      /* K.I.S.S. */

    const int a;
    const int b;

    MyClass()
      : iamStupid(rand() % 250)
      , a(iamStupid % 150)
      , b(abs(iamStupid - 150))
    {}
}; 
```

额外的成员会带来不必要的开销——这对于手头的任务可能很重要，也可能不重要。OTOH，代码很简单。

记得在and`iamStupid` **之前** 声明！（看评论）`a``b`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-20T22:15:49.517

你可以做这样的事情 - 不漂亮，但应该做的伎俩：

```
class MyClass {
public:
    const int a;
    const int b;
    static int relatedVariable;
    MyClass() :
        a(setRand()),
        b(relatedVariable)  {}
    static const int setRand()
    {
        relatedVariable = rand() % 250;
        return relatedVariable;
    }
};
int MyClass::relatedVariable = 0; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-20T22:48:50.030

In case if you are stuck with an ancient compiler which doesn't support delegating constructors, here's the same approach adapted for the older language version:

```
class MyClassBase {
public:
    const int a;
    const int b;
    MyClassBase(int a, int b) : a(a), b(b) {}
};

class MyClass : public MyClassBase {
    static MyClassBase Maker() {
        int x = rand() % 250;
        return MyClassBase(x % 100, abs(x - 150));
    }
public:
    using MyClassBase::a;
    using MyClassBase::b;

    MyClass() : MyClassBase(Maker()) { }
}; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-20T22:13:16.237

引入一个执行计算的中间类：

```
class ConstCalc {

   public:
    ConstCalc(int related) : rv(related){}

    int a() const { return rv % 100; } 
    int b() const { return abs( rv - 150 ) ; } 

   private:
    const int rv;
};

class MyClass {
public:
    const int a;
    const int b;

    MyClass( const ConstCalc c ) : a( c.a() ), b( c.b() ) {
    }
}; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-20T22:26:32.303

Const is a contract between a class's user and implementor. It indicates that the class user should not modify the member variables, thus providing an immutable object design. It is fine for a constructor to otherwise initialize that state. That said, it might be better to hide these behind a private access qualifier and to provide accessors that allow read-only. The correct way to temporarily remove const-ness is using the const_cast<>.

```
class MyClass {
public:
   const int a;
   const int b;

MyClass() : a(0), b(0) {
    int relatedVariable = rand() % 250;
    const_cast<int&>(a) = relatedVariable % 100;
    const_cast<int&>(b) = abs(relatedVariable - 150);
} 
```

};

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-03-20T22:26:55.607

You could make `a` and `b` private, and provide getters to access their values from outside the class.

```
class MyClass
{
private:
    int a, b; // private
public:
    int getA() { return a; }
    int getB() { return b; }

    MyClass()
    {
        int relatedVariable = rand() % 250;
        a = relatedVariable % 100;
        b = abs(relatedVariable - 150);
    }
}; 
```

Or, you could just use subobject initializers and cache the random number somehow. Turning the optimization on might even remove the temporary variable in the generated program text.

```
class MyClass
{
private:
    int temp; // this is a workaround
public:
    const int a;
    const int b;

    MyClass() : temp(rand() % 250), a(temp % 100), b(abs(temp - 150)) {}
}; 
```

[Remember that subobject construction happens in the order that members are declared in the class, and that the order of subobjects in the initialization list is ignored.](https://stackoverflow.com/questions/1242830/constructor-initialization-list-evaluation-order)

Or, you can be lazy, and only store the initial random number, and generate `a, b` on demand.

# javascript - 使用 jQuery mobile 将 DIV 动态添加到 BODY

> ID：15535713
> 
> 赞同：2
> 
> 时间：2013-03-20T22:07:48.090
> 
> 标签：javascript, jquery, ajax, jquery-mobile

我尝试在正文中添加一个 DIV，但我得到了一个空白页。这是我的[例子](http://jsfiddle.net/cFens/1/)。

在同一个示例中，我取消了对 HTML 的注释，因为它工作正常。

代码 ：

```
$("body").append('<div data-role="page"><div data-role="content">HOME</div></div>');
$("body").collapsibleset(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T07:28:17.280

我在页面中添加了一个ID并调用了`show()`jquery的方法。有效

```
$("body").html('<div data-role="page" id="myPage"><div data-role="content"><p>HOME</p> </div></div>');
$("#myPage").show(); 
```

[请在http://jsfiddle.net/cFens/2/](http://jsfiddle.net/cFens/2/)上查看小提琴

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T22:23:47.600

这不起作用，因为`data-role= "page"`有一个`display`of `none`。
![在此处输入图像描述](../Images/d8db216f48aa45db8eaf863e97313f3d.png)

我不知道这个 css 是从哪里来的，但是如果你像我一样禁用它，“Home”就会出现

**编辑** 这个 css 来自 jquery mobile。您可以在样式表中手动设置 css for `data-role="page"`to`display:block;`以覆盖 jquery，或者您甚至不必在 HTML 中分配它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T22:32:39.487

您应该取消选中`jQuery Mobile 1.1.1`并检查[jsFiddle](http://jsfiddle.net/cFens/1/)`jQuery UI 1.8.18`中的其他内容

# javascript - D3.js 可折叠强制布局：未生成链接

> ID：15535714
> 
> 赞同：1
> 
> 时间：2013-03-20T22:07:51.333
> 
> 标签：javascript, api, svg, d3.js, force-layout

我正在尝试生成类似于此示例的可折叠力布局： http: [//bl.ocks.org/mbostock/1062288](http://bl.ocks.org/mbostock/1062288)：

![在此处输入图像描述](../Images/d3da6859dedd23cd4e2f6f5826efc5e1.png)

用于生成我的力布局的数据是来自 API 的 JSON 对象。我能够成功地遍历数据结构，并生成附加到 SVG 的节点（根节点及其子节点）。

但是，问题在于将父节点链接到其子节点。**没有生成链接，我的链接变量返回一个空数组。**与示例相比，我很确定问题与我的应用程序中的数据结构有关，因此我将发布我的 JS 代码和每个节点的数据结构。

任何帮助将非常感激！提前致谢！！

这是我的代码的 JS Fiddle：http: [//jsfiddle.net/tmzjW/](http://jsfiddle.net/tmzjW/)

这是我的 JS 代码：

```
//Force Layout Code
var w = 607,
    h = 500,
    node,
    link,
    root;

var force = d3.layout.force()
    .on("tick", tick)
    .size([w, h]);

var vis = d3.select("#chart").append("svg:svg")
    .attr("width", w)
    .attr("height", h);

function initiateForceJS(currentURL) {
    //Generate the URL
    forceURL = currentURL + ".json?jsonp=?";
    $('#commentArea').show();
    $.getJSON(forceURL,handleRequest2);
    function handleRequest2(json) {
        //Set the root as the first object returned
        root = json[1]['data']['children'][0];
        update();
    }
}

function update() {
  nodes = flatten(root),
  links = d3.layout.tree()
            .sort(null)
            .children(function(d) {return (!d['replies']['data']['children']|| d['replies']['data']['children'].length === 0) ? null : d['replies']['data']['children'];})
            .links(nodes);

  // Restart the force layout.
  force
      .nodes(nodes)
      .links(links)
      .start();

  // Update the links…
  link = vis.selectAll("line.link")
      .data(links, function(d) { return d.target.id; });

  // Enter any new links.
  link.enter().insert("svg:line", ".node")
      .attr("class", "link")
      .attr("x1", function(d) { return d.source.x; })
      .attr("y1", function(d) { return d.source.y; })
      .attr("x2", function(d) { return d.target.x; })
      .attr("y2", function(d) { return d.target.y; });

  // Exit any old links.
  link.exit().remove();

  // Update the nodes…
  node = vis.selectAll("circle.node")
      .data(nodes, function(d) {return d.id; })
      .style("fill", color);

  // Enter any new nodes.
  node.enter().append("svg:circle")
      .attr("class", "node")
      .attr("cx", function(d) { return d.x; })
      .attr("cy", function(d) { return d.y; })
      .attr("r", function(d) { return Math.sqrt(d.ups) || 4.5; })
      .style("fill", color)
      //.on("click", click)
      .call(force.drag);

  // Exit any old nodes.
  node.exit().remove();
  //This will add the name of the character to the node

  node.append("comment").text(function(d) { return d.body });
  //This will put the comment in the Comment Area div
  node.on("mouseover", function() {
    var currentNode = d3.select(this);
    var currentTitle = currentNode.select("comment").text();
    $('#commentArea').html('<p>' + currentTitle + '</p>')  
  });
} 

function tick() {
  link.attr("x1", function(d) { return d.source.x; })
      .attr("y1", function(d) { return d.source.y; })
      .attr("x2", function(d) { return d.target.x; })
      .attr("y2", function(d) { return d.target.y; });

  node.attr("cx", function(d) { return d.x; })
      .attr("cy", function(d) { return d.y; });
}

// Color leaf nodes orange, and packages white or blue.
function color(d) {
  return d._children ? "#3182bd" : d.children ? "#c6dbef" : "#fd8d3c";
}
// Returns a list of all nodes under the root.
function flatten(root) {
  var nodes = [], i = 0;
  function recurse(node) {

    if (node['data']['replies'] != "" && node['kind'] != "more") {
        node['data']['replies']['data']['children'].forEach(recurse);
    }
    if (node['kind'] !="more") {
        //Add an ID value to the node starting at 1
        node.data.id = ++i;
        var comment = node.data;
        nodes.push(comment);
    }
  }
  recurse(root);
  return nodes;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T02:08:43.747

问题是[hierarchy.links](https://github.com/mbostock/d3/wiki/Hierarchy-Layout#wiki-links)函数没有观察到您设置的子访问器；它仅依赖于`children`节点的属性。这在原始示例中有效，因为该示例使用标准的分层节点结构（`children`每个节点上都有一个数组）。它不适用于您的情况，因为您使用的是非标准结构（由第三方 API 定义）。

links 方法不观察子访问器，因为当您在数据上调用层次结构布局（例如树布局）时，它`children`会根据您定义的子访问器为您填充属性；它会自动将您的非标准输入数据映射到标准表单。但是，由于您实际上并没有在这里使用层次结构布局，因此没有机会将节点映射到标准格式，因此 hierarchy.links 不返回任何结果 - 没有节点具有`children`数组。

这里的另一个问题是您的`root`节点实际上没有任何回复，因此根节点没有子节点。（有`root.data.replies.data.children`，但不是`root.replies.data.children`定义为您的 children 访问器。）

我认为在这里要做的最简单的事情是将您的数据映射到一个更简单的层次结构，其中孩子被定义为一个`children`数组。您也许可以使用层次结构布局来帮助解决这个问题，但鉴于您已经编写了一个扁平化函数（或至少修改了一个函数），无论如何，您已经完成了大部分工作。

# c# - C# SQlite INSERT INTO 不起作用

> ID：15535715
> 
> 赞同：3
> 
> 时间：2013-03-20T22:07:56.343
> 
> 标签：c#, database, sqlite

我是 SQLite 的初学者。现在我正在尝试在示例北风数据库中插入新记录。我的 C# 代码如下：

```
 SQLiteConnection myConnection = new SQLiteConnection();

        myConnection.ConnectionString = @"Data Source=|DataDirectory|\northwindEF.db";

        using (myConnection)
        {
            SQLiteCommand myCommand = myConnection.CreateCommand();
            myCommand.CommandText = "INSERT INTO Categories(CategoryID,CategoryName,Description) VALUES(11,'Bakery','Baked goods such as bread and cakes')";
            myConnection.Open();
            myCommand.ExecuteNonQuery();
            myConnection.Close();
        } 
```

当我运行这个程序时，我没有收到任何错误。但是我的新记录没有插入到表中。我的代码有什么问题。请帮我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T23:07:51.710

这是一个常见的陷阱。服务器资源管理器中的连接建立到存储在项目文件夹中的数据库文件。然后，在运行时，数据库被复制到输出目录，并且每次插入、更新、删除都针对该数据库进行。在服务器资源管理器中，没有任何变化，因为数据库不同。`'Copy to the output directory'`如果属性设置为 ，也会发生同样的情况`Copy always`。在这种情况下，每次运行时，输出目录中的数据库都会被从项目根文件夹中获取的新副本覆盖，并且每次删除、更新或插入都会在下次运行时消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:06:12.280

为什么你认为“没有插入新记录”？`ExecuteNonQuery`将告诉您有多少记录受到影响；它返回什么？

你是如何运行程序的？从调试器？`DataDirectory`是数据安装到的文件夹。如果您没有更改 .sdf 文件项目属性中的某些内容，Visual Studio 会将数据安装到 project\debug\bin\ 文件夹。在那里寻找一个 .sdf 文件，那里有你的“新记录”吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-17T12:38:38.543

尝试这样的编码，它总是检查连接是否有错误或您的查询是否有错误。

```
using (SQLiteConnection con = new SQLiteConnection { ConnectionString = "connectionstring" })
{
     using(SQLiteCommand cmd = new SQLiteCommand { Connection = con })
     {
         // check connection state if open then close, else close proceed
         if(con.State == ConnectionState.Open)
           con.Close();

         //then
         try
         {
            // try connection to Open
            con.Open();
         }
         catch
         {
            // catch connection error.
         }

         try
         {
             // your insert query
         }
         catch
         {
             // catch query error
         }

     } // Close Command

}  // Close Connection 
```

# r - 在 R 数据框中匹配和添加因子计数

> ID：15535719
> 
> 赞同：0
> 
> 时间：2013-03-20T22:08:09.177
> 
> 标签：r, dataframe, multiple-columns

我的问题源于[这个](https://stackoverflow.com/questions/11280277/adding-counts-of-a-factor-to-a-dataframe)，[这个](https://stackoverflow.com/questions/13567212/collapse-data-frame-adding-values-for-factor)问题之前提出过，并且与我认为的完全不同。想象一下，我有一个最小的数据集（鸟类），其中每一行代表在给定时间和地点对鸟类的观察，如下所示：

```
id,obs,country
A,4,USA
B,3,CAN
A,5,USA
C,4,MEX
C,1,USA
A,3,CAN
D,1,null 
```

我理想中想要的是将此数据集转换为这样的形式，从数据集中删除空值：

```
id,tot_obs,country_tot
A,12,2
B,3,1
C,5,2 
```

我知道我可以使用以下方法计算因素：

```
table(bird$country) 
```

但是，是否有一种更聪明的方法，也许是一种去除空值、加总计数、找到国家的计数然后将它们重新配置为这种形式的方法？如果有一个包可以做到这一点，那么我也愿意接受这个建议。谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:16:00.690

加载数据`stringsAsFactors=FALSE`：

```
df <- read.csv(header=TRUE, text="id,obs,country
A,4,USA
B,3,CAN
A,5,USA
C,4,MEX
C,1,USA
A,3,CAN
D,1,null", stringsAsFactors=FALSE)

# check to see if columns are factors
sapply(df, class)
#          id         obs     country 
# "character"   "integer" "character" 
```

删除所有行`country = null`

```
df <- df[df$country != "null", ] 
```

然后您可以使用`plyr`package with`summarise`来获得所需的结果，如下所示：

```
ddply(df, .(id), summarise, tot_obs=sum(obs), tot_country=length(unique(country)))
#   id tot_obs tot_country
# 1  A      12           2
# 2  B       3           1
# 3  C       5           2 
```

# html - 使图像的一部分可点击

> ID：15535722
> 
> 赞同：2
> 
> 时间：2013-03-20T22:08:17.293
> 
> 标签：html, css, xhtml

我以这种方式应用了背景图像

```
HTML

<div id="background">
    <img src="stock.png" class="stretch" alt="image" />
</div>

CSS

#background {
    width: 100%; 
    height: 100%; 
    position: absolute; 
    left: 0px; 
    top: 0px; 
    z-index: 0;
}

.stretch {
    width:100%;
    height:100%;
} 
```

我想让图像的一部分区域可点击，以便它将我链接到下一页，有什么简单的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:14:07.807

您总是可以建立一个链接`relative`并将`z-index`其指向正确的位置：

```
<div id="background">
    <img src="stock.png" class="stretch" alt="image" />
    <a href="path/to/url/" class="link"></a>
</div> 
```

然后是这样的：

```
#background {
    width: 100%; 
    height: 100%; 
    position: absolute; 
    left: 0px; 
    top: 0px; 
    z-index: 0;
}
.stretch {
    width:100%;
    height:100%;
    z-index:1;
}
.link {
    width:200px;
    height:200px;
    position:absolute;
    top:50%;
    left:50%;
    display:block;
    z-index:2;
} 
```

然后像使用 CSS 和/或图像一样移动和设置链接样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:10:38.217

那么添加另一个div，`position: absolute;`然后用这个定义他的位置

```
left:100px;
top:100px; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-24T17:42:42.843

我知道这是一个老问题，但在我看来，最简单和最好的方法是使用图像映射。它们非常简单，基本上您可以在图像上定义可点击的形状（矩形、圆形，甚至多边形，但我从未使用过这些）。形状的坐标和大小都是相对于图像的，因此非常灵活。

[http://www.w3schools.com/tags/tag_map.asp](http://www.w3schools.com/tags/tag_map.asp)解释了如何使用它。

# c++ - c++字符串到char*的隐式转换匹配错误的函数签名

> ID：15535729
> 
> 赞同：2
> 
> 时间：2013-03-20T22:09:28.090
> 
> 标签：c++, char, stdstring, implicit-conversion

我正在编写一个程序，它应该同时处理 c 字符串（char*）和 c++ 字符串（std::string）。我对下面的例子感到担忧。

```
#include <iostream>
#include <string>

void hello(std::string s) {
    std::cout << "STRING FUNCTION" << std::endl;
}

void hello(char* c) {
    std::cout << "CHAR FUNCTION" << std::endl;
}

int main(int argc, char* argv[]) {
    hello("ambiguous");
    hello((std::string)"string");
    hello((char*)"charp");

    return 0;
} 
```

当我编译这个程序时，我收到警告：

```
test.cpp:14: warning: deprecated conversion from string constant to ‘char*’ 
```

关于第一次调用`hello`. 运行程序给出：

```
CHAR FUNCTION
STRING FUNCTION
CHAR FUNCTION 
```

显示第一次调用`hello`与签名匹配`hello(char* c)`。

我的问题是，如果作为 c++ 程序，字符串文字 ( `"ambiguous"`) 是 std::string，为什么将它转换为 a`char*`然后匹配函数`hello(char* c)`而不是保持为 std::string 和匹配`hello(std::string s)`？

我知道我可以 pragma 或 -Wsomething 发出警告（并且我可以将 char* 转换为字符串而无需担心），但我想知道为什么编译器甚至会费心进行这种转换，以及是否有办法告诉它不要. 我正在使用 g++ 4.4.3 进行编译。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T22:22:15.693

像这样的字符串文字`"ambiguous"`不是 type `std::string`。`std::string`是一个只有库的类型，没有任何语言魔法。字符串文字的类型实际上是`const char[N]`，其中`N`是文字的长度。

由于历史原因（向后兼容性），字符串文字将隐式转换为`char*`（违反 const 正确性）。此内置转换优于“用户定义”转换为`std::string`，这就是它调用`char*`函数并向您发出警告的原因。

如果您将签名更改`hello`为`hello(const char* c)`它可能不会再给您警告（但仍然不会调用该`std::string`版本，为此您需要手动转换）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:14:32.257

你错了：“作为一个 C++ 程序，一个字符串文字，（“歧义”）是一个 std::string”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T22:22:15.977

("ambiguous") 不是 std::string，它是一个字符数组。

这就是为什么它调用 void hello(char* c)。

# jsf-2 - 使用 JSTL 进行条件图像渲染

> ID：15535730
> 
> 赞同：1
> 
> 时间：2013-03-20T22:09:30.210
> 
> 标签：jsf-2, jstl, facelets

我正在开发一个 JSF 应用程序，并且我有一个关于带有 JSTL 的 Facelets 页面的问题。我想在 ui:repeat 显示多个问题、一个问题和 3 个答案（有条件地格式化）并在答案前面显示一个勾号（tickSmall.png）或一个 X（xSmall.png），如果问题是正确的或错误的。

答案格式正确，但勾号 / X 未正确放置（我检查了布尔值是否正确，有些是正确的，有些是错误的）。每次它都会放一个 X，即使应该有一个勾号。

我已经包括`xmlns:c="http://java.sun.com/jsp/jstl/core`

编码：

```
 <ui:repeat var="n"
                    value="#{answerResultBean.accessWrongAnswerColumnWrapperList}">
                    <hr />
                    <h:outputText value="#{n.noQuestion}. #{n.question}" />
                    <h:panelGrid columns="2" style="text-align: left;">
                        <c:choose>
                            <c:when test="#{n.rightGridAnswerA}">
                                <h:form>
                                    <img src="/juritest/resources/img/tickSmall.png" alt="tick" />
                                </h:form>
                            </c:when>
                            <c:otherwise>
                                <h:form>
                                    <img src="/juritest/resources/img/xSmall.png" alt="wrong" />
                                </h:form>
                            </c:otherwise>
                        </c:choose>
                        <h:outputText value="a) #{n.a}"
                            style="#{n.userAnswerA ? 'font-weight:bold;' : 'font-weight:normal;'}" />

                        <c:choose>
                            <c:when test="#{n.rightGridAnswerB}">
                                <h:form>
                                    <img src="/juritest/resources/img/tickSmall.png" alt="tick" />
                                </h:form>
                            </c:when>
                            <c:otherwise>
                                <h:form>
                                    <img src="/juritest/resources/img/xSmall.png" alt="wrong" />
                                </h:form>
                            </c:otherwise>
                        </c:choose>
                        <h:outputText value="b) #{n.b}"
                            style="#{n.userAnswerB ? 'font-weight:bold;' : 'font-weight:normal;'}" />

                        <c:choose>
                            <c:when test="#{n.rightGridAnswerC}">
                                <h:form>
                                    <img src="/juritest/resources/img/tickSmall.png" alt="tick" />
                                </h:form>
                            </c:when>
                            <c:otherwise>
                                <h:form>
                                    <img src="/juritest/resources/img/xSmall.png" alt="wrong" />
                                </h:form>
                            </c:otherwise>
                        </c:choose>
                        <h:outputText value="c) #{n.c}"
                            style="#{n.userAnswerC ? 'font-weight:bold;' : 'font-weight:normal;'}" />
                    </h:panelGrid>
                </ui:repeat> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:51:45.887

JSTL 标记和 JSF 组件不会像您对编码所期望的那样同步运行。JSTL 标记首先在视图构建期间运行，生成 JSF 组件树。JSF 组件随后在视图呈现期间运行，生成 HTML 输出。因此，当 JSTL 运行时，`#{n}`在 EL 范围内无处可用，因为此时`<ui:repeat>`尚未运行。

您需要 JSF 组件的`rendered`属性，或者巧妙地使用 EL 中的三元运算符。

以下笨拙的块

```
<c:choose>
    <c:when test="#{n.rightGridAnswerA}">
        <h:form>
            <img src="/juritest/resources/img/tickSmall.png" alt="tick" />
        </h:form>
    </c:when>
    <c:otherwise>
        <h:form>
            <img src="/juritest/resources/img/xSmall.png" alt="wrong" />
        </h:form>
    </c:otherwise>
</c:choose>
...
<c:choose>
    <c:when test="#{n.rightGridAnswerB}">
        <h:form>
            <img src="/juritest/resources/img/tickSmall.png" alt="tick" />
        </h:form>
    </c:when>
    <c:otherwise>
        <h:form>
            <img src="/juritest/resources/img/xSmall.png" alt="wrong" />
        </h:form>
    </c:otherwise>
</c:choose>
...
<c:choose>
    <c:when test="#{n.rightGridAnswerC}">
        <h:form>
            <img src="/juritest/resources/img/tickSmall.png" alt="tick" />
        </h:form>
    </c:when>
    <c:otherwise>
        <h:form>
            <img src="/juritest/resources/img/xSmall.png" alt="wrong" />
        </h:form>
    </c:otherwise>
</c:choose> 
```

`rendered`可以使用属性重写如下：

```
<h:form>
    <h:graphicImage name="img/tickSmall.png" alt="tick" rendered="#{n.rightGridAnswerA}" />
    <h:graphicImage name="img/xSmall.png" alt="wrong" rendered="#{not n.rightGridAnswerA}" />
</h:form>
...
<h:form>
    <h:graphicImage name="img/tickSmall.png" alt="tick" rendered="#{n.rightGridAnswerB}" />
    <h:graphicImage name="img/xSmall.png" alt="wrong" rendered="#{not n.rightGridAnswerB}" />
</h:form>
...
<h:form>
    <h:graphicImage name="img/tickSmall.png" alt="tick" rendered="#{n.rightGridAnswerC}" />
    <h:graphicImage name="img/xSmall.png" alt="wrong" rendered="#{not n.rightGridAnswerC}" />
</h:form> 
```

或使用条件运算符如下：

```
<h:form>
    <h:graphicImage name="img/#{n.rightGridAnswerA ? 'tick' : 'x'}Small.png" alt="#{n.rightGridAnswerA ? 'tick' : 'wrong'}" />
</h:form>
...
<h:form>
    <h:graphicImage name="img/#{n.rightGridAnswerB ? 'tick' : 'x'}Small.png" alt="#{n.rightGridAnswerB ? 'tick' : 'wrong'}" />
</h:form>
...
<h:form>
    <h:graphicImage name="img/#{n.rightGridAnswerC ? 'tick' : 'x'}Small.png" alt="#{n.rightGridAnswerC ? 'tick' : 'wrong'}" />
</h:form> 
```

*（这仍然不是[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)，但这是一个不同的问题）*

### 也可以看看：

*   [JSF2 Facelets 中的 JSTL...有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense)
*   [如何在 Facelets 模板中引用 CSS / JS / 图片资源？](https://stackoverflow.com/questions/8367421/how-to-reference-resource-in-facelets-template)

# java - Tic Tac Toe Game (Java)：寻找平局游戏

> ID：15535740
> 
> 赞同：0
> 
> 时间：2013-03-20T22:10:09.860
> 
> 标签：java, tic-tac-toe

为我的班级制作井字游戏，我所有其他方法都正确，并且游戏正常运行，除非有平局。board 是一个 2D 数组，表示井字棋盘。这是用于尝试查看板是否已满的 Full() 方法：

```
public boolean full() {
    boolean full = false;
    for (int i = 0; i < 3; i++) {
        for (int j = 0; j < 3; j++) {
            if (board[i][j] == '-') {
                full = false;
            } else {
                full = true;
            }
        }
    }
    return full;
} 
```

我知道它不起作用，我真的想不出一种让它起作用的方法。有人有想法么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:14:27.250

当您发现电路板未满时，您需要跳出循环（或返回）。

```
public boolean full() {
    for (int i = 0; i < 3; i++) {
        for (int j = 0; j < 3; j++) {
            if (board[i][j] == '-') {
                return false;
            }
        }
    }
    return true;
} 
```

# c++ - 优化 3D 循环 (C++)

> ID：15535744
> 
> 赞同：3
> 
> 时间：2013-03-20T22:10:19.797
> 
> 标签：c++, optimization, scientific-computing

我正在使用 C++ 开发一个多重网格求解器，现在我正在尝试提高串行性能。其中最耗时的部分是平滑器，在我的例子中是一个连续的过度松弛求解器。这看起来如下（我希望它是不言自明的）：

```
int idx; 
int strideY = stride_[level][0];
int strideZ = stride_[level][1];
for(int i = 0; i < steps; ++i) {

    for(int z = 1; z <= innerGridpoints_[level][2]; ++z) {
        for(int y = 1; y <= innerGridpoints_[level][1]; ++y) {
            idx = getIndexInner(level, 1,y,z);
            for(int x = 1; x <= innerGridpoints_[level][0]; ++x, ++idx) {
                grid[idx] = (1\. - omega)  * grid[idx] + omega * 1./6\. * (grid[idx+1] + grid[idx-1] +
                                    grid[idx + strideY]  + grid[idx - strideY] + 
                                    grid[idx + strideZ]  + grid[idx - strideZ] - 
                                    spacing_[level] * spacing_[level] * rhs[idx]);
            }
        }
    }
} 
```

我已经做了一些优化：循环的定位使得内部循环给出了最局部的条目（即相邻元素沿着 x 维度），以及 idx 的预先计算（即使这是一个内联函数，它也节省了很多时间这样）。我也尝试过阻塞，即不迭代整个网格，而只迭代小块以增加局部性，但这没有任何影响。我的最后一个想法是尝试一些循环展开，但我实际上并不期望有很大的改进。我在想也许对内存访问有一些可能的改进。欢迎任何小费:)

仅供参考：网格大小从非常小到 255x255x255 不等。此外，网格在每个维度上都有一些边界，由少量行组成，即迭代不在整个网格上。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T22:25:11.013

一个好的优化编译器无论如何都会为你做大部分简单的事情，所以*总是*衡量你所做的改变是否真的改善了事情。并且，检查（并学习理解）生成的汇编代码以查看编译器实际在做什么。

但是我会尝试一些事情，因为表达式很复杂，即使是好的优化器有时也需要一些帮助：-

首先，将内部循环中不变的子表达式提升到周围的循环。在您的示例中，明显的是 `spacing_[level] * spacing_[level]`和`omega * 1./6.`

要尝试的另一件事是使 idx 成为指针而不是数组索引，并在循环中递增指针。

```
 int *idx = &grid[getIndexInner(level, 1,y,z)];  // assuming grid is array of ints. 
```

然后你的表情开始看起来像这样

```
*idx = (1\. - omega)  * *idx + omega * 1./6\. * (idx[1] + idx[-1] +
                                idx[strideY]  + idx[- strideY] + // etc... 
```

您的优化器（假设它已打开？？？）很可能已经这样做了。但值得一试。正如我所说，没有测量，这是一个毫无意义的练习。

而且，正如@AkiSuihkonen 在“首先让它工作”上面的评论中提到的那样。调试高度优化的代码要困难得多，因此在开始担心性能之前，请确保您的算法*完全按照应有的方式执行。*

# c# - 在字符串列表中查找一个字符

> ID：15535750
> 
> 赞同：0
> 
> 时间：2013-03-20T22:10:44.650
> 
> 标签：c#, list

我正在寻找一种智能方法来在字符串列表中查找具有特定字符的列表元素。

我想查找所有字符串，其中包含一个？-符号在字符串列表中，例如：“a?11”、“ab12”、“bb12”、“b?13”

我目前的解决方案如下所示：

```
// Interates through all strings.
foreach (string currentString in listOfStrings)
{
  if (currentString.Contains('?'))
  {
    // Found!
    myStrings.Add(currentString);
  }
} 
```

有没有更好的方法来完成这项工作，也许像：

```
List<string> myStrings = listOfStrings.Select(z => z.Contains('?')).ToList(); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T22:11:51.610

```
listOfStrings.Where(s => s.Contains('?')); 
```

# jquery - 阻止fancybox 在图库中的图像上使用 empy 占位符？

> ID：15535753
> 
> 赞同：1
> 
> 时间：2013-03-20T22:10:53.620
> 
> 标签：jquery, fancybox, fancybox-2

当您单击一个时，我正在使用 fancybox 将页面上的图像网格变成画廊。它们都通过 rel="gallery" 属性链接在一起。问题是当您单击其中一个图像时，fancybox 会在其位置放置一个空白占位符 div，导致所有图像在背景中移动。当您关闭fancybox 时，它会将其放回到页面上，并且不显示任何内容。

我最终只是屈服并在我的 a 标签上放了一个 display:block!important，这样它们就会重新出现，我正准备将一些通用样式（即我的图像大小）放在它扔下的愚蠢的空占位符上。

fancybox 演示站点甚至没有这样的功能。它留下了单独包装图像的标签......有没有办法阻止fancybox这样做？

单击此处的“照片”选项卡以获取实时示例。*删除链接。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:51:32.297

如果您像以前一样将`href`属性**留空：**

```
<a rel="gallery" class="gallery" href=""><img src="../images/placeholder_prop.jpg"></a> 
```

然后fancybox会将整个`<a>`标签视为*目标*内容并将其作为`inline`内容移动到框中（留下一个占位符）

您只需要`href`使用以下目标填充属性`image`：

```
<a rel="gallery" class="gallery" href="../images/placeholder_prop.jpg"><img src="../images/placeholder_prop.jpg"></a> 
```

所以只有这样的目标`image`才会显示而不会弄乱您的 html 文档。

# google-analytics - 谷歌分析 - 多个域和网站

> ID：15535757
> 
> 赞同：0
> 
> 时间：2013-03-20T22:10:58.893
> 
> 标签：google-analytics

我有一个管理大约 200 个站点的系统。每个站点都有一个唯一的域名和唯一的内容，但是站点的所有 url 都是相同的，因为它们使用相同的模板。

我目前的每个站点都有一个唯一的 GA 帐户。我还想有另一个 GA 编号，我可以在其中汇总所有站点的行为和流量。由于 url 路径都是相似的，我认为报告作为汇总会很好。

目标是无需访问 200 个不同的仪表板即可获得总体统计数据和模式行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T08:20:16.577

我有点想念这里的问题。如果您问这是否可能 - 是的，谷歌分析文档中对此进行了描述（您可以在[https://developers.google.com/analytics/devguides/collection/gajs/#MultipleCommands](https://developers.google.com/analytics/devguides/collection/gajs/#MultipleCommands)找到一个示例）。您必须小心，事件、自定义变量等总是被推送到两个跟踪器。

有用吗？那要看。分析数据在可操作的范围内是有用的。您正在寻找（我认为）一份报告，该报告将相同 URL 的访问次数相加，但在具有不同内容的不同域上。我认为用户行为是由内容而不是 URL 决定的，所以我个人认为这种报告会导致胡言乱语（数据看起来有效但实际上没有意义） - 但我不知道你的报告需求，也许你可以从中找出一些含义。

如果网站有其他共同点，则所有域的“主”帐户可能会很有用 - 例如，如果您对所有网站都有共同的在线广告预算或 SEO 策略并希望对其进行优化，或者如果您只是想在漂亮的图形界面中查看有多少用户访问了您的服务器（如果域都驻留在同一台服务器上）。

即便如此，我认为汇总所有域并不是一个好主意 - 您应该设置一个自定义过滤器以在跟踪的 url 中包含主机名（[http://support.google.com/analytics/bin/answer.py ?hl=en&answer=1012243](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1012243)）而不是将所有域集中在一起。

归根结底，您必须问自己：“在查看此报告后，我有什么不同的做法吗？”如果答案为“否”，那可能是浪费精力。

# node.js - 在正文或查询参数中表达解析内容

> ID：15535759
> 
> 赞同：1
> 
> 时间：2013-03-20T22:11:04.307
> 
> 标签：node.js, express

我有一个在 URL 或消息正文中接受 json 的端点（当然是 POST）

```
app.post('/book/addBooks', function (req, res) {
... 
```

我知道来自服务器的新书 JSON 要么是查询参数

```
<server>/book/addBooks?books=[{...},{...}] 
```

或从身体

```
<server>/book/addBooks 
```

身体：

```
books=[{...},{...}] 
```

基本上我正在检查两者：

```
req.body.books 
```

或者

```
req.query.books 
```

并选择第一个有内容的。有没有更好的方法可以快速获取“书籍”？

旁注：在你丢弃你可以传递 url 或 body 的事实之前，我正在编写一个模仿另一个 API 的服务，因为另一个 API 允许这个垃圾我也必须这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T16:56:54.337

来自快递文档

> req.param（名称）
> 
> 存在时返回参数名称的值。
> 
> // ?name=tobi req.param('name') // => "tobi"
> 
> // POST name=tobi req.param('name') // => "tobi"
> 
> // /user/tobi for /user/:name req.param('name') // => "tobi"

这是查找顺序：

> 查找按以下顺序执行：
> 
> ```
> req.params
> req.body
> req.query 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-31T22:02:27.893

案例使用 req.params ：什么时候是一个休息值的例子

```
/users/:id 
```

req.body : 当为方法 post 发送数据时 req.query : 当为方法 get 发送数据时

```
 /users?thisIsaVar=thisIsaValue 
```

好的，expressjs的post方法是body

# django - django 在生产中提供媒体文件（与 PHP 框架相比）

> ID：15535760
> 
> 赞同：0
> 
> 时间：2013-03-20T22:11:05.163
> 
> 标签：django

我是 django 新手。我读过所有部署在生产环境中的 django 项目都应该通过 web 服务器（如 apache）提供媒体文件（上传）。我的问题是 -**为什么会这样**？

有很多 PHP 框架 - 例如。symfony 1 和 2 - 不遵守规则。一旦您通过 Web 服务器使您的应用程序可以访问，您就不必根据您部署的环境进行任何更改。仅在`DOCUMENT_ROOT`Web 服务器上进行了配置，并且此目录中的某处是上传目录 - 仅此而已。您可以确定没有人会访问 PHP、sql 文件等——这要归功于适当的框架架构和文档根目录。为什么它在 django 中有所不同？

编辑：此外，为不同的环境准备不同的代码（例如[this](https://docs.djangoproject.com/en/dev/howto/static-files/#django.conf.urls.static.static)）是一种非常糟糕的方法，因为您不能使用完全相同的代码在不同的环境中部署项目（并且链接中的代码仅对调试环境有意义.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T14:26:28.850

因为使用 PHP，您的代码是从 Web 服务器的公共目录以及静态和媒体文件提供的。因此，当您请求任何这些静态文件时，Web 服务器会直接为它们提供服务，而无需执行任何 PHP 代码。

在 Django 中，您的代码是单独运行的，所有请求都由 Django 中的 python 代码处理。这对于提供静态文件效率低下，服务效率更高，允许像 Apache 或 Nginx 这样的 Web 服务器直接为它们提供服务，而无需通过任何 python 代码。

# css - 为活动链接添加样式？

> ID：15535765
> 
> 赞同：-1
> 
> 时间：2013-03-20T22:11:27.497
> 
> 标签：css

嗨，在我的网站[上](http://marctesting.myshopify.com/)（密码：ebriff），我已将白色小三角形作为图片添加到活动链接。但因为我有一张图片作为我的第一个菜单链接，所以它不会被添加到其中。我该如何解决这个问题？

CSS：

```
.top-menu li{
    margin: 0;
    float: left;
    font-family: 'Oswald', sans-serif;
    text-transform: uppercase;
    color: #fff; /* text color */
    font-size: 15px;
    text-shadow: 0 1px 0 rgba(0,0,1,.5); /* drop shadow */
    letter-spacing: 1px;
    font-weight: 300;
  } 

li.top {
    border-right: 1px solid #007472;
    border-left: 1px solid #009C9A;
}

li.top:last-child {
    border-right: none;
}

li.top:first-child {
    width: 70px;
    border-left: none;
    background: url({{'home-icon.png'|asset_url}}) no-repeat 24px 25px;
    text-indent: -9999px;
}

.current {
    background: url({{'triangle.png'|asset_url}}) no-repeat center bottom}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:25:23.553

您可以将主页图标作为链接而不是列表项的背景图像。至少当我在 chrome 开发人员工具中尝试它时，这对我有用；）所以而不是

```
li.top:first-child {
  width: 70px;
  border-left: none;
  background: url({{'home-icon.png'|asset_url}}) no-repeat 24px 25px;
  text-indent: -9999px;
} 
```

采用

```
li.top:first-child {
  width: 70px;
  border-left: none;
  text-indent: -9999px;
}
li.top:first-child a{
  background: url({{'home-icon.png'|asset_url}}) no-repeat 24px 25px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:18:24.653

您可以使用 CSS3 多种背景

```
background: url(...), url(...); 
```

或者您可以手动创建一个带有覆盖在“普通背景图标”上的箭头的图像，并将其用于 :active 选择器。也可以考虑使用 CSS 精灵。

在多个背景上：[http ://www.css3.info/preview/multiple-backgrounds/](http://www.css3.info/preview/multiple-backgrounds/)

# java - java反射超类被hibernate加载的问题

> ID：15535767
> 
> 赞同：1
> 
> 时间：2013-03-20T22:11:35.600
> 
> 标签：java, hibernate, reflection

我正在尝试在控制台中打印我需要的超类字段的名称，以便稍后计算在一个简单的 POJO 时工作正常，但是当该类先前由 Hibernate 加载时，我得到的是子类的字段而不是超类和当我打印父级的名称时（当由 Hibernate 加载时，我得到以下信息）

[处理程序，_filter_signature，serialVersionUID，*方法*]

这是我的代码

```
public static void main(String[] args)
{
    FixingModels clazz = new FixingModels();
    HibernateHandler handler = new HibernateHandler(true);
    Student student =  (Student)handler.getSession().load(Student.class,1);
    Student newStudent = new Student();
    System.out.println("Printing Class loaded by Hibernate");
    clazz.showFieldsFromSuperClass(student);//show the Fields of the Child and parent wrong
    System.out.println("--------------------------------------------------");
    System.out.println("Printing Class instance by new..");
    clazz.showFieldsFromSuperClass(newStudent);//Show the fields from the parent and child IS O.K
}
private void showFieldsFromSuperClass(Student clazz) 
{
    final Class objectClass = clazz.getClass();
    final Class parentClass = objectClass.getSuperclass();
    System.out.println("Printing Child");
    for(Field field:objectClass.getDeclaredFields())System.out.println(field.getName());//printing child
    System.out.println("Printing Parent");
    for(Field field:parentClass.getDeclaredFields())System.out.println(field.getName());//printing parent
} 
```

第一次

```
clazz.showFieldsFromSuperClass(student); 
```

被称为打印 [handler,_filter_signature,serialVersionUID, *methods* ] 之后来自孩子的字段就像休眠现在是我的学生类的父类而不是我的代码中的抽象类。之后

```
clazz.showFieldsFromSuperClass(newStudent); 
```

在这种情况下，正在打印学生字段的正确字段以及它的父 Person

我的问题是我如何从休眠或 Spring 容器的新实例中获取 Person 类字段 [Parent Class]？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:14:38.407

基本上我怀疑 Hibernate 正在动态创建您的“子类”的另一个子类 - 并在您从会话中获取它时创建它的一个实例。您的代码当前依赖的实例是*just的**直接*实例。 *`Student`*

 *这很容易验证：

```
System.out.println("Instance class: " + objectClass); 
```

我怀疑它打印的*不是*您期望看到的。

鉴于您*知道*您想要的父类（`Student`大概是 的超类），为什么不直接使用类文字明确地引用它呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:34:54.727

Hibernate load() 方法不会完全初始化检索到的对象，但会返回一个代理，直到您访问对象属性。

`Class`您可以在不使用特殊的休眠辅助类初始化的情况下获得对象的正确性：

`HibernateProxyHelper.getClassWithoutInitializingProxy(student);`*

# android - ArrayAdapter 不创建视图

> ID：15535768
> 
> 赞同：0
> 
> 时间：2013-03-20T22:11:44.053
> 
> 标签：android, android-arrayadapter

我有一个`ArrayAdapter`需要填充的`listView`. 这是代码

```
final ArrayAdapter<CarDetails.Extra> aditionalListAdapter = new ArrayAdapter<CarDetails.Extra>(
            this, android.R.layout.simple_list_item_1, CurrentRequest
                    .getCarDetalized().getExtra()) {
        class TagHolder {
            TextView extraName;
            TextView extraPrice;

        }

        @Override
        public View getView(final int position, final View convertView,
                final ViewGroup parent) {
            View v = convertView;
            TagHolder tagHolder = null;
            if (v == null) {
                final LayoutInflater vi = (LayoutInflater) getContext()
                        .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                v = vi.inflate(R.layout.additional_component, null);

                tagHolder = new TagHolder();
                tagHolder.extraName = (TextView) v
                        .findViewById(R.id.additional_info);
                tagHolder.extraPrice = (TextView) v
                        .findViewById(R.id.additional_price);
                v.setTag(tagHolder);
            } else {
                tagHolder = (TagHolder) v.getTag();
            }
            try {
                final CarDetails.Extra extra = getItem(position);
                tagHolder.extraName.setText(extra.getName());
                tagHolder.extraPrice.setText(extra.getCurrency() + " "
                        + extra.getPrice());
                Log.d("Adapter",
                        "Set up adapter field with name " + extra.getName());

            } catch (final Exception e) {
                e.printStackTrace();
                System.exit(0);
                Log.e("CarList", "Error setting cell" + e);
            }
            return v;
        }

    };
    additionalInfoList.setAdapter(aditionalListAdapter); 
```

getExtra() 方法返回`ArrayList`对象。正如 LogCat 所说，它有 18 个对象。它在 Android Emulator 4.2.2 上正常运行，但在我的设备 4.0.4 上不起作用。它只是填充一个（第一个）对象，然后就是它。我尝试了覆盖`getCount()`方法并将返回设置为 18，它也没有做任何事情。问题出在哪里？

# streaming - Kit Digital 的 Roku 流媒体频道

> ID：15535775
> 
> 赞同：1
> 
> 时间：2013-03-20T22:12:53.307
> 
> 标签：streaming, live, roku

我一直在开发一个 roku 频道，主要来自[http://www.herofish.com/2012/01/how-to-create-you-own-roku-videoplayer-channel/](http://www.herofish.com/2012/01/how-to-create-you-own-roku-videoplayer-channel/)上的教程，它已经很好地融合在一起. 现在我的问题是我正在尝试将频道连接到 Kit Digital Live 流（.m3u8 流），但我不知道如何将频道连接到该流而不是常规选择您的视频流。

有谁知道我在哪里可以找到有关如何执行此操作的说明或可以提供帮助的文档？（我已经浏览了开发者指南和论坛，但找不到任何线索）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T09:31:36.770

查看以下演示代码： http: [//sourceforge.net/projects/rokusdkexamples/files/customvideoplayer.zip/download](http://sourceforge.net/projects/rokusdkexamples/files/customvideoplayer.zip/download) 向您展示了如何使用 HLS 和其他一些很酷的播放功能。

```
this.player.SetMessagePort(this.port)
this.player.SetLoop(true)
this.player.SetPositionNotificationPeriod(1)
this.player.SetDestinationRect(this.layout.left)
this.player.SetContentList([{
    Stream: { url: "http://ec2-184-72-239-149.compute-1.amazonaws.com:1935/demos/smil:bigbuckbunnyiphone.smil/playlist.m3u8" }
    StreamFormat: "hls"
    SwitchingStrategy: "full-adaptation"
}])
this.player.Play() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T22:23:07.793

测试 HLS 流的最简单示例可能是 simplevideoplayer 示例，它位于 sourceforge 或您下载的 SDK 中。只需找到“Big Buck Bunny”部分，将引号中的 url 替换为您的 .m3u8 url，添加 srt="" 然后注释掉其他示例。

```
' Big Buck Bunny test stream from Wowza
urls = ["http://myserver.com/mystream.m3u8"]
streamformat = "hls"
title = "Big Buck Bunny"
srt="" 
```

# internet-explorer - 在 Internet Explorer 9 中使用 cleditor 会导致双引号被错误地转义

> ID：15535779
> 
> 赞同：0
> 
> 时间：2013-03-20T22:13:12.673
> 
> 标签：internet-explorer, internet-explorer-9, cleditor

我已经在互联网上搜索了这个问题的答案，但是，唉，我不得不寻求帮助。

我正在使用[cleditor](http://premiumsoftware.net/cleditor/) jQuery 插件来实现它的富文本/HTML 编辑功能。在大多数情况下，它工作正常。但是，如果我在 IE9 中执行以下操作，则会出现一个奇怪的问题：

1.  点击工具栏右上角的“显示源代码”按钮切换到 HTML 模式
2.  粘贴以下代码段：

    ```
    <p>Note the double-quotes</p>
    <div onclick='alert("hi")'>click me</div> 
    ```

3.  切换回富文本模式并进行微不足道的更改（例如，添加一个空格）

4.  再次切换到 HTML 模式

请注意双引号现在如何错误地转义，如下所示：

```
<div onclick="alert(\"hi\")">click me</div> 
```

这到底是怎么回事？其他浏览器像这样正确地转义双引号：

```
<div onclick="alert(&quot;hi&quot;)">click me</div> 
```

我自己尝试过使用实体 , `&quot;`，但这没关系 - IE9 仍然把它搞砸了。有谁知道如何克服这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T18:04:15.340

没关系，我想通了。如果其他人正在为这个问题苦苦挣扎，我认为这是使用 cleditor、XHTML 插件和 Internet Explorer 的组合。

您可以通过在您的 cleditor 代码之前添加此 JavaScript 片段来修复它：

```
(function ($) {
    var oldCallback = $.cleditor.defaultOptions.updateTextArea;

    $.cleditor.defaultOptions.updateTextArea = function (html) {
        if (oldCallback) {
            html = oldCallback(html);
        }

        var isIE = /*@cc_on!@*/false;
        if (isIE) {
            return html.replace(/\\\"/g, "&quot;");
        } else {
            return html;
        }
    };
})(jQuery); 
```

或者，您可以在 jquery.cleditor.js 中进行条件替换（cleditor v1.3.0 的第 1126 行）。

# python - Django如何找出特定时区是否早于晚上7点

> ID：15535782
> 
> 赞同：0
> 
> 时间：2013-03-20T22:13:16.407
> 
> 标签：python, django, timezone

我是 Django/programming 的新手，正在尝试编写一些代码来告诉我它是否早于特定时区的晚上 7 点（我会提供时区）。

如果这种类型的问题被问了很多，我很抱歉。我搜索了答案，但无法提出解决方案。

我很感激时间和专业知识。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T21:20:38.883

我能够找到一个可行的解决方案：

```
tz = timezone('US/Eastern')
datetime.now(timezone(tz)).hour<19 
```

# javascript - 粘性导航栏/居中 div 的右侧

> ID：15535794
> 
> 赞同：-1
> 
> 时间：2013-03-20T22:13:50.887
> 
> 标签：javascript, navigation, fixed, sidebar, sticky

我正在编辑一个 Squarespace 模板，并想创建一个粘性导航侧边栏。有一个 Squarespace 字段，我可以在其中输入“自定义 CSS”。

我已经有了侧边栏，但是如何修改 CSS 以使其保持不变？当我在折叠下方滚动时，我希望它保持可见。

我的div 居中（自动/自动），并且在右侧`pageBodyWrapper`包含`contentWrapper`div 和div。`sidebar1Wrapper`

我努力了

```
#sidebar1Wrapper 
{
   position:fixed;
} 
```

`px`在or中具有左值或右值`%`，但每当我更改窗口大小时，侧边栏要么远离内容，要么与内容重叠。

我该如何防止这种情况发生？我可以定义相对于`contentWrapper`div 的固定位置吗？

谢谢您的帮助！

这是我正在谈论的网站：[Last Wave Film](http://lastwavefilm.com)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:32:30.700

不幸的是，该功能尚未内置到 css 中。它是用javascript完成的。本质上，javascript 会检测页面何时滚动到顶部，然后将侧边栏设置为`position: fixed`.

这是一个使用 jQuery 库的解决方案：http: [//css-tricks.com/persistent-headers/](http://css-tricks.com/persistent-headers/)

您可以使用 css 固定侧边栏，它将永久固定在浏览器窗口中。

```
.sidebar1Wrapper {
   position: fixed;
   top: 20px;
   right: 40px;
} 
```

# python - 熊猫数据框绘图列

> ID：15535796
> 
> 赞同：0
> 
> 时间：2013-03-20T22:13:56.793
> 
> 标签：python, matplotlib, pandas

在阅读了一系列文件后，我创建了一个包含 7 列的数据框：

```
<class 'pandas.core.frame.DataFrame'>
Int64Index: 756 entries, 0 to 755 
```

数据列：

```
Fr(Hz)        756  non-null values

res_ohm*m     756  non-null values

phase_mrad    756  non-null values

ImC_S/m       756  non-null values

Rm_S/m        756  non-null values

C_el          756  non-null values

date          756  non-null values

dtypes: float64(6), object(1) 
```

然后我想按具有 12 个变量的第 6 列（C_el）对日期进行分组：

```
Pairs = = data_set.groupby('C_el') 
```

现在每个组都包含 21 的倍数的数据（这意味着每 21 行我有一个新的唯一数据集） - 21 指的是第 1 列（Fr(Hz)，我为每个数据集使用 21 个频率

我想要做的是创建一个 x，y 散点图 - 在 X 轴上是第 1 列（Fr（Hz），在 Y 轴上是第 3 列（phase_mrad） - 每个数据集将有 21 个独特的频率点，并且然后我想在同一个图上添加所有可用的数据集，使用不同的颜色

最后一步，对剩余的 11 个组重复此操作（如前面步骤中定义的那样）

样本数据集在这里（[A12 ）目前我在 numpy](http://pastebin.com/XiPSxrmr) [multiple_datasets](https://stackoverflow.com/questions/14635172/save-and-plot-multiple-datasets-using-python)中这样做非常难看

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:56:48.783

我不知道这是否真的能满足你的要求，但我认为`groupby`可以帮到你很多忙。例如，代替您提供的代码示例，您可以这样做：

```
for key, group in data_set.groupby('C_el'):
   # -- define the filename, path, etc..
   # e.g. filename = key
   group.to_csv(filename, sep=' ') 
```

[另请参阅此处](http://pandas.pydata.org/pandas-docs/stable/groupby.html)的文档。抱歉，我无法为您提供更多详细信息，但我希望对您有所帮助。

# vbscript - 我想删除 7 天前的文件。文件夹和空文件夹

> ID：15535801
> 
> 赞同：0
> 
> 时间：2013-03-20T22:14:10.900
> 
> 标签：vbscript

我想删除 7 天前的文件和空文件夹。我从链接中使用了以下脚本，但是由于源直接指向驱动器号，因此某些文件和文件夹没有被删除。但是，如果我们更改源文件夹 c:\temp\lab 一切正常。

```
Const Active = True
Const sSource = "E:"
Const MaxAge = 7 'days
Const Recursive = True

Checked = 0
Deleted = 0

Set oFSO = CreateObject("Scripting.FileSystemObject")
if active then verb = "Deleting """ Else verb = "Old file: """
CheckFolder oFSO.GetFolder(sSource)

WScript.echo
if Active then verb = " file(s) deleted" Else verb = " file(s) would be deleted"
WScript.Echo Checked & " file(s) checked, " & Deleted & verb

Sub CheckFolder (oFldr)
For Each oFile In oFldr.Files
Checked = Checked + 1
If DateDiff("D", oFile.DateLastModified, Now()) > MaxAge Then
Deleted = Deleted + 1
WScript.Echo verb & oFile.Path & """"
If Active Then oFile.Delete
End If
Next

if not Recursive then Exit Sub
For Each oSubfolder In oFldr.Subfolders
CheckFolder(oSubfolder)
Next
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:44:08.003

那么，这个呢：

```
Const Active     = True
Const sSource    = "E:\start_folder" 'or "E:\" but not "E:"
Const MaxAge     = 7 'days
Const Recursive  = True

Dim dtOld, Checked, Deleted, verb
dtOld   = Now - MaxAge
Checked = 0
Deleted = 0

If Active Then verb = "Deleting """ Else verb = "Old file: """

Validate sSource
Cleanup sSource

WScript.Echo
If Active Then verb = " file(s) deleted" Else verb = " file(s) would be deleted"
WScript.Echo Checked & " file(s) checked, " & Deleted & verb

Sub Validate(sFolder)
    With CreateObject("Scripting.FileSystemObject")
        If Not .FolderExists(sFolder) Then
            Err.Raise 76 'Path not found
        End If
        If .GetFolder(sFolder).IsRootFolder Then
            If .GetDrive(.GetDriveName(sFolder)) = _
            CreateObject("WScript.Shell").Environment(_
            "PROCESS")("HOMEDRIVE") Then
                Err.Raise 75 'Path/File access error
            End If
        End If
    End With
End Sub

Sub Cleanup(sFolder)
    Dim obj
    With CreateObject("Scripting.FileSystemObject").GetFolder(sFolder)
        'recurse first
        If Recursive Then
            For Each obj In .SubFolders
                Cleanup obj
            Next
        End If
        'next delete oldest files
        For Each obj In .Files
            If obj.DateCreated < dtOld Then
                Deleted = Deleted + 1
                WScript.Echo verb & obj.Path & """"
                If Active Then obj.Delete(True)
            End If
        Next
        Checked = Checked + .Files.Count
        'and then delete old or empty folders
        For Each obj In .SubFolders
            If obj.DateCreated < dtOld Or 0 = obj.Size Then
                'count here in a variable if you like...
                If Active Then obj.Delete(True)
            End If
        Next
    End With
End Sub 
```

**PS**需要**警告**一个弱时刻。FSO 使用快照`Folders`集合，这意味着在迭代期间 FSO 可能会尝试访问不再存在的文件夹。换句话说，为删除文件夹制作了单独的程序。

# javascript - t /= d 是什么意思？Python并出现错误

> ID：15535802
> 
> 赞同：5
> 
> 时间：2013-03-20T22:14:11.667
> 
> 标签：javascript, python

```
// t: current time, b: begInnIng value, c: change In value, d: duration

def: 'easeOutQuad',
swing: function (x, t, b, c, d) {
    //alert(jQuery.easing.default);
    return jQuery.easing[jQuery.easing.def](x, t, b, c, d);
},
easeInQuad: function (x, t, b, c, d) {
    return c*(t/=d)*t + b;
},
easeOutQuad: function (x, t, b, c, d) {
    return -c *(t/=d)*(t-2) + b;
}, 
```

我正在尝试将 Robert Penner 的缓动函数转换为 python 并卡住了！有任何帮助或其他人以前做过吗？

[https://github.com/danro/jquery-easing/blob/master/jquery.easing.js](https://github.com/danro/jquery-easing/blob/master/jquery.easing.js)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T22:24:16.580

在 JavaScript 和 Python 中，`/=`都是“增强赋值”运算符，含义几乎相同。

在 JS 中：

```
var i = 10;
i /= 2; 
```

… 相当于：

```
var i = 10;
i = i / 2; 
```

并且，在 Python 中：

```
i = 10
i /= 2 
```

……同样等价于（不完全相同，但对于数字来说足够接近）：

```
i = 10
i = i / 2 
```

但是，有一个非常大的区别。

在 JavaScript 中，赋值是一个表达式——它有一个值，这个值就是赋给变量的值。所以：

```
var i = 10;
var j = i /= 2; 
```

……大致相当于：

```
var i = 10;
i /= 2;
var j = i; 
```

在 Python 中，赋值是一个语句。它没有值，也不能在表达式中使用。所以：

```
i = 10
j = i /= 2 
```

... 提出一个`SyntaxError`.

* * *

移植在表达式中间使用赋值（增强或其他方式）的代码通常需要将该表达式分成多行和/或找到一种方法来重写表达式以不需要任何赋值。（但通常，这不是一件坏事，因为原来的表达方式本来就不是很可读……）

例如，假设 JS 从左到右评估操作数（我不确定是否保证？）：

```
def easeInQuad(x, t, b, c, d):
    t /= d
    return c*t*t+b 
```

更一般地说，你这样做：

```
old_t = t
t /= d 
```

然后您将`t`之前的任何实例`t/=d`替换为`old_t`，并保留所有实例 from`t/=d`和 later 单独。幸运的是，在这种情况下，没有以前的实例，所以我们不需要那些`old_t`东西。

而且，如果您考虑一下，您可以`t`通过以下任何一种方式轻松获得相同的效果，而无需在一行中进行更改，并且更具可读性：

```
return c * (t/d) * (t/d) + b
return c * (t/d)**2 + b
return c * t*t / d*d + b 
```

用 C 语言思考的人会立即抱怨这些都“太慢”。毕竟，第一个执行额外的除法，第二个执行取幂而不是乘法，第三个执行两次乘法而不是一次。恐怖！

当然，您始终可以使用临时变量：

```
t_over_d = t/d
return c * t_over_d * t_over_d + b 
```

……但同样，对于 C 程序员来说，这意味着您正在用完一个有价值的寄存器。当然，在 1985 年之后编写的每个编译器都会`t`在出现时立即检测到已死`t_over_d`并重用相同的寄存器，但如果可以的话，为什么不*强制*它重用寄存器，特别是如果它也节省了几次击键呢？

在 JS 或 Python 中，乘法的成本只是调用函数和解释字节码等成本的一小部分，你甚至都不会注意到它。同时，重新绑定局部变量的成本（尤其是在 V8 风格或 PyPy 风格的 JIT 解释器中）可能比传递一个未命名的临时结果的成本要高得多。

因此，这是一个误导性“优化”的范例案例，使代码更难理解，同时可能会减慢而不是加快速度，并且在一个无论如何都不可能成为值得优化的瓶颈的领域。

* * *

由于 gnibbler 提出了 JavaScript 是否确实保证了这种评估顺序的问题……</p>

首先，JavaScript 被有效地定义为“Firefox 所做的事情”（和“Spidermonkey 所做的事情”，但这应该是同一件事——如果不是，那么 JavaScript 做了两件事，所以好两倍， 对？）。但是 ECMAScript*是*由标准定义的，而且每个 JS 实现（不管名称）都在口头上支持这些标准，我们可以假装 ECMAScript 5.1 是所有实现都遵循的标准（只要“所有实现"的意思是“歌剧”)。你可以在[这里](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-262%20edition%205.1,%20June%202011.pdf)找到它。

因此，在 ES 5.1 中：**11.5 乘法运算符**保证 的结果`(t/=d)`将在 之前评估`t`，而**11.13.2 复合赋值**保证评估将在其完成之前`t/=d`设置值。`t`（您必须阅读“评估”`GetValue`的含义和`SetValue`含义，但我很确定这确实得到了保证。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:17:21.650

`/=`是增广赋值运算符。`t /= d`是一样的`t = t / d`。`+=`, `-=`, 并且`*=`还存在，等等……

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T22:17:49.357

好吧，它是一个速记运算符，就像除`+=`而不是添加它。这是长表格

```
t = t / d 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T22:17:52.113

```
c*(t/=d)*t + b; 
```

相当于

```
t /= d            # or t = t / d
c * t * t + b 
```

因为 Python 不能在表达式内部赋值

请记住，如果`t`和`d`都是`int`/ `long`，这将是 Python2 中的截断除法

同样`easeOutQuad`会是

```
def easeOutQuad (x, t, b, c, d):
    t /= d
    return -c * t * (t - 2) + b 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T22:16:59.980

划分和分配。

```
>>> p = 6
>>> p /= 2
>>> p
3 
```

# java - 泛型方法返回超类型参数类型和方法参数类型参数

> ID：15535804
> 
> 赞同：1
> 
> 时间：2013-03-20T22:14:14.730
> 
> 标签：java, generics

我希望返回类型参数是类型参数和方法参数的类型参数的超级参数。

这编译：

```
import java.util.List;
interface Foo<A> {
    <R, B extends R> List<R> eg1(List<B> unit);
    <R> List<R> eg2(List<? extends R> unit);
} 
```

但它并不强制 R 也必须是 A 的超级。我怎么做？

实际上，我想做一些类似这些表达的事情：

```
<B, R super A & B> List<R> func(List<B> unit);
<B> List<? super A & B> func(List<B> unit); 
```

但是这些当然不能编译。

这样做有两个目的：

1.  我希望能够将结果分配给 A 和 B 的任何超类。
2.  在此方法的实现中，我需要一个可以同时包含 A 和 B 的结果类型。所以第一个编译的例子是行不通的，因为它们不允许我在结果中加上 A。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:20:01.097

我认为您必须在类级别命名类型参数：

```
import java.util.List;
interface Foo<Base, A extends Base> {
    <B extends Base> List<Base> eg1(List<B> unit);
    <R> List<R> eg2(List<? extends R> unit);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:11:18.927

感谢@LouisWasserman 的评论，我开始考虑我应该首先这样做的实现。某处必须指定要构造返回的类型。在方法实现中硬编码，指定为类型参数、参数类型参数等。无论该规范在哪里，都可以为该接口方法正确定义泛型。

换句话说，我试图做的事情没有意义，因为您无法构造返回类型。

# java - 使用 udl 文件连接到 java 中的 access 数据库

> ID：15535805
> 
> 赞同：1
> 
> 时间：2013-03-20T22:14:22.913
> 
> 标签：java, database, ms-access

如何使用 udl 文件连接到 java 中的 access 数据库？

我环顾四周，发现了一些用于 c# 的线程以及一些用于 mysql 数据库的线程，但从来没有完全符合我的要求以及如何做到这一点。

我也尝试过不使用 udl 进行连接，但在使用 64 位系统和 32 位系统时遇到了一些问题。当我连接到 64 位和 32 位时，我没有遇到 udl 和 c# 的问题。所以我也试图通过在java中使用这个方法来解决这个问题。

亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:16:52.813

我不知道 .udl 文件是什么，但 Java 使用 JDBC 连接到数据库，最好使用 IV 型 100% 驱动程序。

您对 Access 不走运。JDBC-ODBC 桥驱动程序仅在 32 位 JVM 中可用。它从来都不是一个权宜之计，所以它不是我见过的 64 位 JVM 的一部分。您必须购买获得许可的 Access 驱动程序。

# java - 线程等待时出现大量 IllegalMonitorStateException

> ID：15535815
> 
> 赞同：0
> 
> 时间：2013-03-20T22:14:46.300
> 
> 标签：java, multithreading, wait, runnable, illegalstateexception

每当我调用 pauseThread() 时，它总是抛出 IllegalMonitorStateException。

我在文档中注意到我需要拥有对象监视器才能使线程等待。

用这段代码

```
synchronized (obj) {
         while (<condition does not hold>)
             obj.wait();
         ... // Perform action appropriate to condition
     } 
```

在这种情况下，obj 参数是否会运行 while(ServerTickHandler.peakBlockDestructionQueue() == null){} 但当 obj.wait(); 被称为是否需要通知？还是当 while 条件不成立时它会通知自己， synchronized (){} 代码块会持续循环还是在 synchronized (){} 中仍然需要一个 while 循环来完成此操作？

编辑： syncronized(){} 会通过 run 方法进入吗？

这是我的课

```
public class ServerTickSaveHandler implements Runnable
{
    private static Thread   runner;
    /**
     * Creates a new thread for dealing with logging block destruction when using certain tools.
     * @param threadName Name of the thread.
     */
    public ServerTickSaveHandler(String threadName)
    {
        runner = new Thread(this, threadName);
    }
    /**
     * If thread has nothing to do we shall pause it so it does not needlessly run :D.
     * @throws InterruptedException
     */
    public void pauseThread()
    {
        try
        {
            runner.wait();
        }
        catch (InterruptedException e)
        {
            e.printStackTrace();
        }
        catch(IllegalMonitorStateException e)
        {
            e.printStackTrace();
        }
    }
    /**
     * If Items from DropItemQueue need ticking lets resume this thread.
     * @throws IllegalMonitorStateException
     */
    public void resumeThread()
    {
        try
        {
            runner.notify();
        }
        catch (IllegalMonitorStateException e)
        {
            e.printStackTrace();
        }
    }
    /**
     * The thread that is spawned when this object is created.
     */
    public void run()
    {
        while (true)
        {
            // long start = System.currentTimeMillis();

            WorldData worldData = ServerTickHandler.getBlockDestructionQueue();
            if (worldData != null)
            {
                worldData.saveToFile();
            }
            else pauseThread();

            // long end = System.currentTimeMillis();

            // NumberFormat formatter = new DecimalFormat("#0.00000");
            // Utils.log("Save Tick Handler Execution time is " +
            // formatter.format((end - start) / 1000d) + " seconds");
        }
    }
    /**
     * Starts the thread.
     * @throws IllegalStateException
     */
    public void startThread()
    {
        try
        {
            runner.start();
        }
        catch (IllegalStateException e)
        {
            e.printStackTrace();
        }   
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:22:52.947

`wait()`如文档所述，您必须持有您调用/的对象的监视器`notify()`。由于您在 上调用这些方法`runner`，因此这些说明必须在

```
synchronized(runner) { 
```

堵塞。

也就是说，在线程上调用`wait()`/`notify()`是一个很奇怪的选择。您最好使用最终的专用锁定对象来等待/通知。您的程序中还有其他不好的选择。例如，从构造函数初始化静态字段。

`wait()`并且`notify()`是非常低级的，难以使用的原语。您应该使用更高级别的抽象，例如 Locks、Semaphores、CountDownLatches、BlockingQueues 等。

# php - PHP Curl登录到APSX页面，需要将数据发布到登录页面

> ID：15535816
> 
> 赞同：1
> 
> 时间：2013-03-20T22:14:47.040
> 
> 标签：php, asp.net, post, curl

首先，我对我的英语感到抱歉，我的英语写作不好，我没有时间通过​​拼写检查。kkk

所以，这是我的问题的概述。我能够使用 PHP CURL 命令登录 ASPX 页面，发送带有 ASPX 请求的所有疯狂变量的帖子数据。我的问题是，要将帖子数据（带有用户名和密码）发送到登录页面，我必须在之后，将帖子数据（带有一些疯狂的东西）发送到登录页面，以获得对该页面的访问权限，换句话说，如果我将一些指定的帖子数据（带有那个疯狂的 stuuf）发送到页面，我只能访问登录页面，如果我不发送它，我将被重定向到主页，而不是登录页面。

我能够使用疯狂的帖子对登录页面执行 CURL 命令并访问登录页面。现在，在发送第一个疯狂的帖子以访问登录页面后，如何将带有用户/密码的帖子发送到登录页面？

你们有没有看错？如果没有，我可以尝试解释更多。

谢谢！！

拉斐尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T08:52:02.500

如果您想让用户访问仅在登录后可用的页面 - 您必须从登录页面保存 COOKIE，然后将每个请求发送给他们。这可以通过卷曲来完成。

**获取饼干：**

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_HEADER, true);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_USERAGENT, $_SERVER['HTTP_USER_AGENT']);
$data = curl_exec($ch);
$header = substr($data, 0, curl_getinfo($ch, CURLINFO_HEADER_SIZE));
$body = substr($data, curl_getinfo($ch, CURLINFO_HEADER_SIZE));
preg_match_all("/Set-Cookie: (.*?)=(.*?);/i", $header, $res);
$cookie = '';
foreach ($res[1] as $key => $value) {
   $cookie .= $value . '=' . $res[2][$key] . '; ';
};
curl_close($ch); 
```

**将 cookie 返回到另一个 curl 请求：**

```
curl_setopt($ch, CURLOPT_COOKIE, $cookie); 
```

# c# - 如何动态分配 lambda > 表达

> ID：15535820
> 
> 赞同：2
> 
> 时间：2013-03-20T22:15:01.570
> 
> 标签：c#, lambda, expression

我正在尝试制作动态表达式并将 lambda 分配给它。结果，我得到了异常：System.ArgumentException：“Test.ItsTrue”类型的表达式不能用于分配给“System.Linq.Expressions.Expression`1[Test.ItsTrue]”类型

怎么了？

```
public delegate bool ItsTrue();

public class Sample
{
    public Expression<ItsTrue> ItsTrue { get; set; }
}

[TestClass]
public class MyTest
{
    [TestMethod]
    public void TestPropertySetWithExpressionOfDelegate()
    {
        Expression<ItsTrue> itsTrue = () => true;

        // this works at compile time
        new Sample().ItsTrue = itsTrue;

        // this does not work ad runtime
        var new_ = Expression.New(typeof (Sample));

        var result = Expression.Assign(
            Expression.Property(new_, typeof (Sample).GetProperties()[0]), 
            itsTrue);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:18:39.540

的第二个参数`Expression.Assign`是表示要分配的值的*表达式。*因此，目前您正在有效地尝试将 an 分配`ItsTrue`给该属性。您需要将其包装，使其成为返回值的表达式`itsTrue`... via`Expression.Quote`或`Expression.Constant`. 例如：

```
var result = Expression.Assign(
    Expression.Property(new_, typeof (Sample).GetProperties()[0]), 
    Expression.Constant(itsTrue, typeof(Expression<ItsTrue>))); 
```

或者，您*可能*想要`Expression.Quote`- 这实际上取决于您想要实现的目标。

# php - 设置和使用新设置的 Cookie 值

> ID：15535821
> 
> 赞同：0
> 
> 时间：2013-03-20T22:15:02.690
> 
> 标签：php, cookies

在根据 cookie 值显示不同内容的网站上工作。例如：

[http://peewee.betaforming.com/](http://peewee.betaforming.com/)

对比

[http://peewee.betaforming.com/?cu=10010](http://peewee.betaforming.com/?cu=10010)

该值可以在任何页面上设置，因为我在每个页面上都包含一个功能。如果 cookie 已设置或已保存，则加载该 CU 的信息。如果未设置 cookie 值或传递了数据库中不存在的值，则站点将显示默认信息。

这就是问题所在。如果您从没有设置 cookie 值到请求将“?cu=10010”附加到任何页面的站点，则当前页面在刷新之前不会加载当前数据。

根据我的阅读，我需要使用 header("location....

这是函数文件中用于设置/检索 cookie 的相关代码。

```
// CU cookies

    if (isset($_GET["cu"]) && is_numeric($_GET["cu"])) {

        $pass_cu = $_GET["cu"];

        // See if passed value returns an active CU record

        mysql_select_db($database_peewee, $peewee);
        $query_rs_valid_cu = "SELECT * FROM tbl_cus WHERE cu_id = $pass_cu";
        $rs_valid_cu = mysql_query($query_rs_valid_cu, $peewee) or die(mysql_error());
        $row_rs_valid_cu = mysql_fetch_assoc($rs_valid_cu);
        $totalRows_rs_valid_cu = mysql_num_rows($rs_valid_cu);

        if ($totalRows_rs_valid_cu != 0) {

            // Set cookie

            $peewee_cu_querystring = $_GET["cu"];
            $expire_month = time()+60*60*24*30; //30 days

            //kill current cookie

            setcookie("peewee_cu", "", time()-10);

            //set new cookie

            setcookie("peewee_cu", $peewee_cu_querystring, $expire_month, "/");

        }

        mysql_free_result($rs_valid_cu);

    }

    // See of cookie exists

    if ((isset($_COOKIE['peewee_cu'])) && $_COOKIE['peewee_cu'] != "") {

        $cu_cookie_value = $_COOKIE['peewee_cu'];

        // Set values for getting CU record

        $colname_rs_cu_data = $cu_cookie_value;
        $load_custom_cu = 'true';

    } else {

        // Set defualt CU value

        $colname_rs_cu_data = 10000;
        $load_custom_cu = 'false';

    }

// Get and Set CU Information (CU specific or default)

mysql_select_db($database_peewee, $peewee);
$query_rs_cu_data = "SELECT * FROM tbl_cus WHERE cu_id = $colname_rs_cu_data";
$rs_cu_data = mysql_query($query_rs_cu_data, $peewee) or die(mysql_error());
$row_rs_cu_data = mysql_fetch_assoc($rs_cu_data);
$totalRows_rs_cu_data = mysql_num_rows($rs_cu_data);

$cu_sidebar_image = $row_rs_cu_data['cu_logo'];
$cu_sidebar_name = $row_rs_cu_data['cu_name'];
$cu_sidebar_link = $row_rs_cu_data['cu_link'];
$cu_sidebar_address = $row_rs_cu_data['cu_address'];
$cu_sidebar_city = $row_rs_cu_data['cu_city'];
$cu_sidebar_state = $row_rs_cu_data['cu_state'];
$cu_sidebar_postal = $row_rs_cu_data['cu_postal'];
$cu_sidebar_phone = $row_rs_cu_data['cu_phone'];
$cu_sidebar_toll = $row_rs_cu_data['cu_phone_toll_free'];

$cu_meta_title = $row_rs_cu_data['cu_name'];
$cu_tab_title = $row_rs_cu_data['cu_name'];

mysql_free_result($rs_cu_data);

// Set default error page for all pages except home page

$default_error_page = 10007;
$default_error_page_home = 10005; 
```

谢谢

布雷特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:22:44.467

重新加载页面只是为了读取您知道其值的 cookie（因为您刚刚设置了它）似乎有点多余。

相反，您需要做的只是将一个变量设置为*浏览*器发送的当前 cookie 值 ( `$_COOKIE['peewee_cu']`)*或*您在当前页面上分配给该 cookie 的值 ( `$peewee_cu_querystring`)。

对于一个非常简单的方法（但请注意：我不特别建议写入超全局变量，最好拥有自己的变量并正确管理范围）请参阅[PHP 设置 COOKIE，使用 JQUERY COOKIE 插件更改，无法使用 php 进行编辑？](https://stackoverflow.com/questions/15178473/php-sets-cookie-changed-with-jquery-cookie-plugin-cannot-be-edited-with-php/15178732#15178732)

顺便说一句，在设置新的 cookie 之前，您不需要杀死旧的 cookie，因为任何具有相同名称、域和路径的新 cookie 都会自动覆盖它。

# mongodb - 易腐烂的文件？

> ID：15535822
> 
> 赞同：0
> 
> 时间：2013-03-20T22:15:16.970
> 
> 标签：mongodb

MongoDB有什么方法可以根据时间自动处理文档的删除？

我使用 Tornado (Python) 并且`IOLoop`可以做到，但它总是检查时间，并且这些文档的生命周期很长（6 mounth），

那么Mongodb可以在不制作可点击脚本或使用IOLoop的情况下做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T04:14:02.360

是的，这是一个称为 TTL（生存时间）索引的功能（2.1 中的新功能）。

您可以阅读所有关于它们的信息，包括此处的示例：

[http://docs.mongodb.org/manual/tutorial/expire-data/](http://docs.mongodb.org/manual/tutorial/expire-data/)

# android - 在 iframe 中动态设置 href 在 Android 上的 Chrome 中不起作用

> ID：15535823
> 
> 赞同：0
> 
> 时间：2013-03-20T22:15:21.743
> 
> 标签：android, google-chrome, iframe, mailto

我有一个页面 (jobs.php)，其中包含所有移动功能，如通话、短信和电子邮件。我在主页中以 iframe 的形式访问此`index.php`页面。我制作了一个功能，以便在拨打电话或发送短信或发送电子邮件之前，它将条目记录到数据库中。

jobs.php 代码

Javascript（所有变量都已定义并正常工作）

```
<img src=\""+imgpath+"email_logo.png\"onclick=\"setMailLog('"+installername+"',"+customerId+",'"+email+"')\" id=\"mimg_"+customerId+"\"/>

function setMailLog(installerName, customerId,email){
        console.log("Email Attempted:");
    $.ajax({
      url: 'functions.php',
      type: 'POST',
      dataType:'text',
      data: 'elogins='+installerName+'&elogcid='+customerId,
      success: function(result){
        console.log(result);
        $("#mimg_"+customerId).wrap('<a id="mhrefid_'+customerId+'" target="_blank"></a>');
        $('#mhrefid_'+customerId).attr('href','mailto:'+email);
        window.location.href=$("#mhrefid_"+customerId).attr('href');
      } 

   }); 

    } 
```

这在所有桌面浏览器上都运行良好。它在 Android 的默认浏览器上运行良好，但在 Android 的 Chrome 上会中断，这很重要，因为这些是移动功能，应该在每个浏览器的移动设备上运行。

当我在 Android 上单击 Chrome 中的邮件图标时，它说

```
The web page at mailto:email might be temporarily down or it may have removed permanently to a new address

Error 302(net::ERR_UNKNOWN_URL_SCHEME): Unknown error 
```

错误页面仅显示在特定的 iframe 中，而不显示在整个 index.php 文件中。

呼叫和短信功能相同，只是错误变为`tel:5225`或`sms:5114`

这一切都在一个 iframe 中，可能是导致问题的原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T16:42:02.840

对我来说似乎是一个错误。我创建了一张票来跟踪它[https://code.google.com/p/chromium/issues/detail?id=223146](https://code.google.com/p/chromium/issues/detail?id=223146)

要解决此问题，请更换

```
window.location.href=$("#mhrefid_"+customerId).attr('href'); 
```

和

```
window.top.location.href=$("#mhrefid_"+customerId).attr('href'); 
```

这会更改顶级页面的位置，而不是 iframe，这在 Chrome 中运行良好。

# php - JS AJAX发送多个数据数组

> ID：15535826
> 
> 赞同：1
> 
> 时间：2013-03-20T22:15:45.013
> 
> 标签：php, javascript, jquery, ajax, knockout.js

我正在尝试在我的 ajax 保存函数中发送多个数据数组。

我可以单独做每个数组`data:hardwarePayload`，它会起作用。如果我这样做，`{hardware: hardwarePayload, service:servicePayload}`我会得到非常奇怪的 JSON 输出。看起来像：

> 硬件=%5B%7B%22hardwareName%22%3A%221%22%2C%22hardwareQuantity%22%3A%22%22%2C%22hardwareBYOD%22%3A%22%22%7D%5D&服务=%5B%7B% 22serviceName%22%3A%223%22%2C%22serviceQuantity%22%3A%22%22%7D%5D

我真的需要两个阵列，一个硬件和一个服务，所以我可以单独获取每个阵列。

我的代码看起来像这样..

> ```
> self.save = function (form) {
>     var hardwareModel = [];
>     var serviceModel = [];
>     ko.utils.arrayForEach(self.services(), function (service) {
>         serviceModel.push(ko.toJS(service));
>     });
>     ko.utils.arrayForEach(self.hardwares(), function (hardware) {
>         hardwareModel.push(ko.toJS(hardware));
>     }); 
>   //allModel.push({accountId: ko.toJS(account)});
>     var hardwarePayload = JSON.stringify(hardwareModel);
>     var servicePayload = JSON.stringify(serviceModel);
>   //alert(JSON.stringify(serviceModel) +JSON.stringify(allModel));
>     $.ajax({
>         url: '/orders/add',
>         type: 'post',
>         data: {hardware: hardwarePayload, service:servicePayload}, //            data:hardwarePayload,
>         contentType: 'application/json',
>         success: function (result) {
>             alert(result);
>         }
>     });
> }; 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T05:02:28.140

**你应该试试这个**

```
var hardwarePayload = hardwareModel;
var servicePayload = serviceModel;

var postData = {'hardware': hardwarePayload, 'service':servicePayload};

var postData = JSON.stringify(postData);

alert(postData);

$.ajax({
    url: '/orders/add',
    type: 'post',
    data: postData,
    contentType: 'application/json',
    success: function (result) {
        alert(result);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:07:33.160

我认为如果您不对*数据进行**字符串化*处理会更好：

 *```
$.ajax({
    url: '/orders/add',
    type: 'post',
    data: {hardware: hardwareModel, service:serviceModel}, //            data:hardwarePayload,
    contentType: 'application/json',
    success: function (result) {
        alert(result);
    }
}); 
```

（请注意，我使用的是**未**字符串化的*hardwareModel*和*serviceModel*）

这样，您可以让 jQuery 处理请求的 (json) 数据。*

# python - 在实例变量之外使用类方法/属性

> ID：15535830
> 
> 赞同：1
> 
> 时间：2013-03-20T22:15:51.720
> 
> 标签：python, class, methods, properties

我有一堂课如下：

```
class Spheroid(object):                                                                                                                                                        
  def __init__(self,shortt,longg):                                                                                                                                           
    self.shortax = shortt                                                                                                                                                  
    self.longax  = longg                                                                                                                                                   
    self.alpha=self.longax/self.shortax                                                                                                                                    

  @property                                                                                                                                                                                                                                                                                                                                           
  def volume(self):                                                                                                                                                          
    return (4*np.pi/3) * self.shortax * self.shortax * self.longax 
```

在稍后的一段代码中，我使用了一个音量函数，如下所示：

```
x=np.arange(5,8.5,dx)
y=np.arange(5,30,dy)
X,Y = np.meshgrid(x,y)

Z = vol(X,Y) 
```

vol 函数与我在课堂上定义的@property 完全相同。为了让这段代码正常工作，我必须复制并粘贴 @property 类并将其转换为如下常规函数：

```
def vol(a,b):
    return (4*np.pi/3) * a * a * b 
```

我总是被告知复制和粘贴代码是我做错了什么的标志。所以我的问题是，有没有一种方法可以重新设计我的类，以便在不创建实例的情况下调用我在该 Spheroid 类中定义的卷 @property / 方法，以便 Z = vol(X,Y) 可以工作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:23:06.020

如果您的目标是使 vol(x, y) 工作，您可以定义 vol 来创建一个带有传递给它的参数的新对象，调用该属性，然后返回。

或者你可以在你的球体类上创建一个名为 Vol 的函数，并将该函数设为静态。然后你可以让那个函数的实例版本只调用静态版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:32:48.573

我会遵循 scott_fakename 的建议并使用这样的静态方法：

```
class Spheroid(object):

    def __init__(self, shortt, longg):
        self.shortax = shortt
        self.longax = longg
        self.alpha = self.longax / self.shortax

    @property
    def vol(self):
        return Spheroid.volume(self.shortax, self.longax)

    @staticmethod
    def volume(shortax, longax):
        return (4 * np.pi / 3) * shortax * shortax * longax

# outside the instance call it like this
Spheroid.volume(X, Y) 
```

# ruby - 重构条件变量赋值

> ID：15535831
> 
> 赞同：5
> 
> 时间：2013-03-20T22:15:51.710
> 
> 标签：ruby, refactoring

我正在做一个项目。目前我有一个相当大的条件语句，它根据一些输入参数为变量赋值。所以，我有这样的事情。

```
if some condition
  x = some value
elsif another condition
  x = a different value
  ... 
```

重构它的最佳方法是什么？我希望我最终可能会得到类似的东西

```
x = some value if some condition || another value if another condition 
```

这种事情有模式吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-20T22:27:38.467

只需将作业放在 if 之外。

```
x = if some condition
  some value
elsif another condition
  a different value 
```

或者你可以使用哈希。

```
x = dict[some condition] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:27:40.947

```
x = some condition ? some value : 
    another condition ? a different value : ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T22:30:37.460

条件语句也是一个表达式，所以如果变量在每个条件中都相同，那么您可以做的第一件事是：

```
x = if cond1
  expr1
elsif cond2
  expr2
....
end 
```

如果条件是单个表达式的所有状态，则可以使用 case 语句使这更加整洁。

然而，下一个最明显的重构练习是将大条件隔离到一个方法中，该方法应该提供评估所有条件和表达式所需的最少数据。

例如

```
# Where conditional is currently, and x assigned, assuming the conditionals
# need a couple of variables . . .
x = foo param1, param2

# Elsewhere
private

def foo p1, p2
  if cond1
    expr1
  elsif cond2
    expr2
  ....
  end
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T22:23:32.727

它不是一个模式，而是一个操作符。您指的是三元运算符：

```
If Condition is true ? Then value X : Otherwise value Y 
```

这是一个例子：

```
speed = 90
speed > 55 ? puts("I can't drive 55!") : puts("I'm a careful driver") 
```

使用三元语句是简短的，甜蜜的，并且可以完成工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-04T15:48:17.510

如果要重构代码的清晰度和灵活性，请考虑使用多态重构[替换条件。](http://refactoring.com/catalog/replaceConditionalWithPolymorphism.html)

您的问题中没有足够的细节来进一步提出建议，但是这种重构将使您的代码库更能抵抗更改。如果你收到一个新的需求，打破条件并修改它是不好的形式（更容易引入错误，更难做）；最好创建一个可以插入现有代码库的新对象。[开放/封闭原则](https://en.wikipedia.org/wiki/Open/closed_principle)（SOLID 首字母缩写词中的“O”）所描述的这种灵活性。

# clojure - Clojure：错误数量的参数（4）传递给：core$rest

> ID：15535833
> 
> 赞同：3
> 
> 时间：2013-03-20T22:15:57.203
> 
> 标签：clojure

> 编写一个函数，允许您创建函数组合。参数列表应采用可变数量的函数，并创建一个从右到左应用它们的函数。

```
(fn [& fs]
  (fn [& args]
    (->> (reverse fs)
         (reduce #(apply %2 %1) args)))) 
```

[http://www.4clojure.com/problem/58](http://www.4clojure.com/problem/58)

```
=> (= [3 2 1] ((_ rest reverse) [1 2 3 4]))

clojure.lang.ArityException: Wrong number of args (4) passed to: core$rest 
```

是什么导致了这个错误？我看不到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:34:21.067

它在您的使用中`apply`- 这会将最后一个参数变成一个扁平的参数列表，创建一个看起来像这样的调用：

`(rest 1 2 3 4)`

这可能不是您想要的......并解释了您遇到的错误。

# mysql - #1064 - 您的 SQL 语法有错误；在“块”附近使用正确的语法？

> ID：15535835
> 
> 赞同：-1
> 
> 时间：2013-03-20T22:16:02.747
> 
> 标签：mysql

我需要有关此查询的帮助：

```
update ibf_posts
set post =
replace (post,
'<div><div style="background: #B7E5CE;border: 1px dotted #000; border-bottom: 0; border-left: 4px solid #429E6F; color: #000; font-weight: bold; font-size: 10px; margin: 8px auto 0 auto; padding: 3px;">SPOILER <a href="javascript:void(0);" onclick="javascript:if(parentNode.parentNode.getElementsByTagName('div')[1].style.display=='block'){parentNode.parentNode.getElementsByTagName('div')[1].style.display='none';this.innerHTML='--Click here to view--';}else {parentNode.parentNode.getElementsByTagName('div')[1].style.display='block';this.innerHTML='--Click here to hide--';}">--Click here to view--</a></div><div style="color: #000000; background: #FAFCFE; border: 1px dotted #000; border-left: 4px solid #429E6F; border-top: 0; padding: 4px; margin: 0 auto 8px auto;display:none;">',
'[spoiler]'); 
```

我收到此错误：

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds
to your MySQL server version for the right syntax to use near 'block')
{parentNode.parentNode.getElementsByTagName('div')[1].style.display='none' at line 1 
```

有什么线索吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:23:03.137

由于您要插入带有`'`（单撇号/引号）的字符串，因此您需要转义字符串中相同的所有外观。

```
update ibf_posts
set post =
replace (post,
'<div><div style="background: #B7E5CE;border: 1px dotted #000; border-bottom: 0; border-left: 4px solid #429E6F; color: #000; font-weight: bold; font-size: 10px; margin: 8px auto 0 auto; padding: 3px;">SPOILER <a href="javascript:void(0);" onclick="javascript:if(parentNode.parentNode.getElementsByTagName(\'div\')[1].style.display==\'block\'){parentNode.parentNode.getElementsByTagName(\'div\')[1].style.display=\'none\';this.innerHTML=\'--Click here to view--\';}else {parentNode.parentNode.getElementsByTagName(\'div\')[1].style.display='block';this.innerHTML=\'--Click here to hide--\';}">--Click here to view--</a></div><div style="color: #000000; background: #FAFCFE; border: 1px dotted #000; border-left: 4px solid #429E6F; border-top: 0; padding: 4px; margin: 0 auto 8px auto;display:none;">',
'[spoiler]'); 
```

`\`转义是通过在引号前加上反斜杠（ ）来完成的。

# javascript - 为 Web 应用程序实现空闲超时的最佳方法是什么（自动注销）

> ID：15535839
> 
> 赞同：3
> 
> 时间：2013-03-20T22:16:14.630
> 
> 标签：javascript, jquery, asp.net, httphandler, session-timeout

我想为我们正在构建的 Web 应用程序实现空闲超时。我之前使用 来自 codeplex 的[AsynchronousSessionAuditor](http://spikes.codeplex.com/releases/view/40299)实现了这一点，它本质上是通过持续轮询来查找表单身份验证和会话 cookie 超时。

但它有一个不尊重客户端事件的缺点，它只会寻找最后一次回发来决定何时注销。

来自 erichynds的 jquery 插件 [jquery-idle-timeout-plugin](http://forum.jquery.com/topic/a-new-and-improved-jquery-idle-timeout-plugin)解决了客户端事件的这个问题，但存在无法识别用户在其他选项卡上处于活动状态的另一个缺点。

是否有人已经使用 jquery-idle-timeout-plugin 修复了 TABBED 浏览问题？或者对于 Web 应用程序是否有更好的应用程序超时方法（通过使用 asp.net f/w 构建这个 Web 应用程序的方式）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:21:02.937

如果我正确理解您的问题，那是不可能的，因为在 javascript 中没有为当前窗口/选项卡之外的活动触发事件。

除非您为每个浏览器都有一个与您的网站一起使用的插件，它可以监控浏览器中的所有活动，但这并不是一个真正实用的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:29:30.127

好吧，您必须手动编写代码，这并不难。你可以使用 onfocus 和 onblur 函数来做这样的事情：

```
$(function() {
    window.isActive = true;
    $(window).focus(function() { this.isActive = true; });
    $(window).blur(function() { this.isActive = false; });
    showIsActive();
});

function showIsActive()
{
    console.log(window.isActive)
    window.setTimeout("showIsActive()", 2000);
}

function doWork()
{
    if (!window.isActive) { /* Check for idle time */}
} 
```

如果您进行一些搜索，您会发现已经提出并回答了这个问题的各种问题，您可能会找到可以使用您提到的插件之一实现的解决方案。

尝试： [仅在选项卡处于活动状态时运行 setTimeout](https://stackoverflow.com/questions/5766263/run-settimeout-only-when-tab-is-active) 或 [如何判断浏览器/选项卡是否处于活动状态](https://stackoverflow.com/questions/1760250/how-to-tell-if-browser-tab-is-active)

编辑 - >添加：

或者我会尝试不同的方法。您可以创建一个带有一些哈希值的 cookie，并将该哈希值保存在您的数据库中，并在窗口处于活动状态时更新时间戳（您可以每 5 秒或其他时间检查一次，这不是一个密集的请求）
然后，在之前进行另一次检查（但在相同的请求）查看自上次时间戳以来已经过去了多少时间，并在必要时将其注销。
当时间过去时，它不会立即将它们注销，但是当他们尝试通过再次打开该站点或通过关注选项卡/窗口来访问该站点时，它会注销。

# jquery - 折叠并展开所有

> ID：15535840
> 
> 赞同：1
> 
> 时间：2013-03-20T22:16:15.690
> 
> 标签：jquery

我正在尝试实现展开/折叠所有功能。我有一个可展开项目的列表，右上角有一个按钮，允许用户展开和折叠所有内容。

目前，如果所有内容都一起展开/折叠，我的代码就可以工作，但是当用户展开一些（而不是全部）元素时，我的代码就不能正常工作。它只是切换折叠/展开的元素。[JSFiddle](http://jsfiddle.net/Q63Dx/8/)

这是我正在运行的 jQuery 代码：

```
$('div.srcprojects').hide();
$('.projectscontainer').on("click", "span.destproject", function (){
    $(this).siblings('.srcprojects').toggle().end().siblings('div.destarrow').toggleClass("arrow-right arrow-down");
}).on("click", "div.destarrow", function (){
    $(this).parent().find("span.destproject").trigger("click");
});

$('body').on("click", "span#expandcollapse", function (){
    $(this).text(function(i, currentText){
        return currentText === 'Expand All' ? 'Collapse All' : 'Expand All';
    });
    $('body').find("span.destproject").trigger("click");
}); 
```

我怎样才能做到这一点，以便我的#expandcollapse 实际上展开所有/折叠所有？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:22:33.693

在不完全剖析您的代码的情况下，我将指出 jQuery 的`toggle`方法只是将可见性从`show`to切换，`hide`反之亦然。如果你只想在一个方向切换，你可以这样做：

`.toggle(true)`显示和 `.toggle(false)`隐藏

[http://api.jquery.com/toggle/#toggle-showOrHide](http://api.jquery.com/toggle/#toggle-showOrHide)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:43:51.933

我相信你可以简单地做

```
$("#expandcollapse").on("click",function(e) {
    $(".projectscontainer").find(".srcprojects").toggleSlide();
}); 
```

当切换幻灯片时，这也会为您提供一个不错的上滑/下滑动画。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T22:18:20.747

使用切换将做到这一点。

我不确定我是否完全理解您要查找的内容，但希望这个小示例可以让您顺利上路：

```
$('#expandcollapse').click(function () {
    $('.projectscontainer').each(function () {
        //Code to manipulate the elements here, like .show()/.hide()
    }); 
}); 
```

# cloud-foundry - UAA 是否要求登录服务器具有 uaa.user 范围？

> ID：15535841
> 
> 赞同：0
> 
> 时间：2013-03-20T22:16:19.353
> 
> 标签：cloud-foundry

我有一个运行 UAA 示例应用程序以及 Java 登录服务器的部署。我已经分别使用自定义 uaa.yml 和 login.yml 配置了我的 UAA 和登录服务器。我通过查看 /uaa/uaa/src/main/webapp/WEB-INF/spring/oauth-clients.xml 的内容，根据“登录”客户端的详细信息填充了 uaa.yml，如下所示：

```
 <entry key="login">
    <map>
        <entry key="id" value="login" />
        <entry key="secret" value="loginsecret" />
        <entry key="scope" value="openid,uaa.user" />
        <entry key="authorized-grant-types" value="client_credentials,authorization_code" />
        <entry key="authorities" value="oauth.login" />
        <entry key="autoapprove" value="true" />
    </map>
</entry> 
```

在我的 uaa.yml 中进行了相应的配置。这似乎工作正常，我可以登录并浏览示例应用程序。

但是，当我随后访问示例应用程序中的 /approvals 页面时，我在approvals.jsp 中收到了一个javascript 错误，这显然是由于messages.properties 文件中没有任何对应的scope.uaa.user 条目引起的。

```
[2013-03-20 18:05:52.787] login/login-server - ???? [http-8080-1] .... DEBUG --- DispatcherServlet: Could not complete request
org.apache.jasper.JasperException: javax.servlet.ServletException: javax.servlet.jsp.JspTagException: No message found under code 'scope.uaa.user' for locale 'en_US'.
    at org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:491)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:401)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
    at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)
    at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)
    at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)
    at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
    at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)
    at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1180)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:950)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)  
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    ... 
```

所以，问题是——登录服务器真的需要范围“uaa.user”吗？如果是这样，messages.properties 文件中的条目应该说什么？我找不到为 uaa.user 范围提供商定文本描述的任何地方。

作为一种解决方法，我只是在messages.properties 中为该范围编写了我自己的文本，并且批准页面现在呈现OK。

谢谢，约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-17T15:02:57.433

登录服务器无法预测可用的范围，因为某些范围可能是应用程序自定义的。该错误已在此处修复 [https://github.com/cloudfoundry/login-server/commit/c39aa19db33c12a0d9740e2c0a53698b87889ebc](https://github.com/cloudfoundry/login-server/commit/c39aa19db33c12a0d9740e2c0a53698b87889ebc) 如果没有消息可用于表示范围，只需打印出范围名称即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:00:08.210

是的，登录服务器需要“uaa.user”。您可以在 messages.properties 文件中包含任何文本字符串，您将在应用程序中相应地使用它。让我知道这是否有帮助。

谢谢，

*   希特什

# javascript - HTML5 Canvas 游戏 - 实体类

> ID：15535844
> 
> 赞同：0
> 
> 时间：2013-03-20T22:16:27.757
> 
> 标签：javascript, html, canvas, entity, html5-canvas

我的播放器不画画。任何帮助，将不胜感激！我想做一个播放器对象，即实体类。基本上，我的播放器不会画画，我想保留这个实体类的想法。我可以将它用于游戏中我想要移动、有重力等的任何东西。

```
const FPS = 60;
var playerSprite = new Image();
playerSprite.src = 'http://placehold.it/50x75';
var canvas = null;
var context = null;
var keys = [];
window.onload = init;

setInterval (function() {
                update();
                draw();
                },
                1000/FPS
            );

function init(){
    canvas = document.getElementById('canvas');
    context = canvas.getContext('2d');
    setInterval(draw, 1000 / FPS);
}

function update(){
    player.update();
}

function draw(){
    context.clearRect(0,0,canvas.width,canvas.height);
    player.draw(player.xpos, player.ypos);
}

function Entity(xpos,ypos,xd,yd,speed,yvel,gravity,width,height,imagesrc,controls){
    this.xpos = xpos;
    this.ypos = ypos;
    this.speed = speed;
    this.yvel = yvel;
    this.gravity = gravity;
    this.width = width;
    this.height = height;
    this.imagesrc = imagesrc;
    this.controls = controls;
}

Entity.prototype.draw = function(x,y){
    context.drawImage(this.imagesrc, x, y);
}

Entity.prototype.update = function(){
    this.xpos += this.xd;
    this.ypos += this.yd;

    // yVelocity
    if(this.ypos >= canvas.height - this.height){
        this.yvel = 0;
    }else{
        this.yvel += this.gravity;
        this.ypos += this.yvel;
    }
    // end of yVelocity

    // walls
    if(this.xpos >= canvas.width - this.width){
        this.xpos = canvas.width - this.width;
    }else if(this.xpos <= canvas.width - canvas.width){
        this.xpos = canvas.width - canvas.width;
    }
    // end of walls

    // player controls
    if(this.controls){
        if (keys[39]) {
            this.moveRight();
        }else if (keys[37]){
            this.moveLeft();
        }else{
            this.stopMove();
        }
    }

        Entity.prototype.moveRight = function(speed){
        this.xd = speed;
    }

    Entity.prototype.moveLeft = function(speed){
        this.xd = speed;
    }

    Entity.prototype.stopMove = function(){
        this.xd = 0;
    }
    // end of player controls
}

var player = new Entity(20,20,0,0,3,0,1,50,75,playerSprite,true); {}

// key events
document.body.addEventListener("keydown", function (e) {
    keys[e.keyCode] = true;
});
document.body.addEventListener("keyup", function (e) {
    keys[e.keyCode] = false;
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:16:43.620

我认为您正在尝试在画布加载之前绘制图像。使用类似的东西`onLoad`来确保页面首先完成加载

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:57:14.820

发现你的代码有几个小问题 :) 但我相信你会根据你的代码的复杂性找到然后嘿嘿，我的建议是：使用 console.debug()，它是你最好的朋友！

一些总体评论：

**带有函数名称的 setInterval 看起来更具可读性，**

```
setInterval(gameLoop, 1000 / FPS);

function gameLoop() {
    console.debug('game loop');
    update();
    draw();
} 
```

看起来比：

```
setInterval( function() {
    console.debug('game loop');
    update();
    draw();
}, 1000 / FPS); 
```

**检查图像是否加载，有时http请求比我们预期的要长...**

```
playerSprite.onload = function(){ imgReady = true; }; 
```

玩得开心代码，请评论您的进度！

```
<html>
<body>
<canvas width="640" height="480" id="canvas" />

<script>
const FPS = 60;
var imgReady = false;
var playerSprite = new Image();
playerSprite.onload = function(){ imgReady = true; };
playerSprite.src = 'http://placehold.it/50x75.jpg';

var canvas = null;
var context = null;
var keys = [ ];
var player;
window.onload = init;

function init() {
    console.debug('init()');
    canvas = document.getElementById('canvas');
    context = canvas.getContext('2d');

    player = new Entity(20, 20, 0, 0, 3, 0, 1, 50, 75, playerSprite, true); 
    setInterval(gameLoop, 1000 / FPS);
}

function gameLoop() {
    console.debug('game loop');
    update();
    draw();
}

function update() {
    player.update();
}

function draw() {
    context.clearRect(0, 0, canvas.width, canvas.height);
    player.draw();
}

function Entity(xpos, ypos, xd, yd, speed, yvel, gravity, width, height, imagesrc, controls) {
    this.xpos = xpos;
    this.ypos = ypos;
    this.xd = xd;
    this.yd = yd;
    this.speed = speed;
    this.yvel = yvel;
    this.gravity = gravity;
    this.width = width;
    this.height = height;
    this.imagesrc = imagesrc;
    this.controls = controls;
}

Entity.prototype.draw = function () {
    if( imgReady ){
        context.drawImage(this.imagesrc, this.xpos, this.ypos);
    }
}

Entity.prototype.update = function () {

    this.xpos += this.xd;
    this.ypos += this.yd;

    // yVelocity
    if (this.ypos >= canvas.height - this.height) {
        this.yvel = 0;
    } else {
        this.yvel += this.gravity;
        this.ypos += this.yvel;
    }
    // end of yVelocity

    // walls
    if (this.xpos >= canvas.width - this.width) {
        this.xpos = canvas.width - this.width;
    } else if (this.xpos <= canvas.width - canvas.width) {
        this.xpos = canvas.width - canvas.width;
    }
    // end of walls

    // player controls
    if (this.controls) {
        if (keys[39]) {
            this.moveRight();
        } else if (keys[37]) {
            this.moveLeft();
        } else {
            this.stopMove();
        }
    }
    // end of player controls

    console.debug('update() x=' + this.xpos + ' y=' + this.ypos);
}

Entity.prototype.moveRight = function (speed) {
    this.xd = this.speed;
}

Entity.prototype.moveLeft = function (speed) {
    this.xd -= this.speed;
}

Entity.prototype.stopMove = function () {
    this.xd = 0;
}

// key events
document.body.addEventListener("keydown", function (e) {
    keys[e.keyCode] = true;
});

document.body.addEventListener("keyup", function (e) {
    keys[e.keyCode] = false;
});

</script>

</body>
</html> 
```

# mysql - 哪个子查询更快？

> ID：15535846
> 
> 赞同：1
> 
> 时间：2013-03-20T22:16:34.333
> 
> 标签：mysql, sql, subquery

（可能是重复的，但我只能通过 JOIN 找到问题和解决方案，`[3]`这**不是一个选项**。）

我有两张桌子。非常薄（几列）和非常长（多行）。一个是数据表 ( `articles`)，一个是 ACL 表 ( `acl`)。

我只想显示我可以通过 访问的文章`acl.some_id`。哪个子查询更快？

```
[1]
SELECT a.title
FROM articles a
WHERE 0 < (
  SELECT COUNT(1)
  FROM acl
  WHERE article_id = a.id AND some_id IN (1, 2, 3)
) 
```

或者

```
[2]
SELECT a.title
FROM articles a
WHERE a.id IN (
  SELECT article_id
  FROM acl WHERE some_id IN (1, 2, 3)
) 
```

我会说第二个，因为该子查询可以重复用于所有可能匹配的行，所以只会执行一次（尽管结果集会非常大），而第一个中的子查询将不得不检查每一个可能匹配行。

还有第三种方法，但这**不是一个选项**，因为它会重复行（并且 GROUP BY 不是解决方案，因为我以后需要一个 COUNT 来做其他事情（并且 DISTINCT 永远不是解决方案！））：

```
[3]
SELECT a.title
FROM articles a
JOIN acl
  ON acl.article_id = a.id
WHERE acl.some_id IN (1, 2, 3) 
```

由于 article_id X 在 中存在 N 次`acl`，它将返回该行 0 - N 次而不是 0 - 1。

还有第四种方式：`EXISTS`. 感谢超立方体。

有关的：

*   [子查询与内部连接——哪一个执行得更快？](https://stackoverflow.com/q/12063008/247372)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T22:26:41.403

我也想说`[2]`，但是 MySQL 在优化子查询方面有一些盲点`IN`，至少到 5.5。（新发布的）5.6 版本对查询优化器进行了多项改进。您可以在 MySQL 文档中阅读（半连接和`IN`子查询）：**[MySQL 5.6: Optimizing Subqueries with Semi-Join Transformations](http://dev.mysql.com/doc/refman/5.6/en/semi-joins.html)**。

MariaDB（版本 5.3 和 5.5）中的优化器也有一些改进，其中一些与此类查询有关。您可以在他们的文档中阅读：**[MariaDB 5.3: Semi-join subquery optimizations](https://kb.askmonty.org/en/semi-join-subquery-optimizations/)**。

你也可以试试这个`EXISTS`版本，特别是如果你使用的是 5.5 或更早的版本：

```
-- [4]
SELECT id
FROM articles AS a
WHERE EXISTS (
  SELECT *
  FROM acl 
  WHERE acl.some_id IN (1, 2, 3)
    AND acl.article_id = a.id 
) ; 
```

我认为`(article_id, some_id)`这里的索引会很有用 - 或者可能是相反的，尝试两者都没有坏处。

* * *

如果有`acl (article_id) REFERENCES article (id)`您可以信任的外键，并且您只需要文章 ID，您也可以只从一个表中获取数据：

```
SELECT DISTINCT article_id
FROM acl 
WHERE acl.some_id IN (1, 2, 3) ; 
```

* * *

当然，您应该测试您的服务器中的几个版本、您拥有（或计划使用）的 MySQL 版本、您的数据分布，当然还有足够大的表。用几百行测试不会告诉你太多。

# visual-studio - Visual Studio：NuGet 包源需要凭据

> ID：15535847
> 
> 赞同：26
> 
> 时间：2013-03-20T22:16:47.403
> 
> 标签：visual-studio, nuget, nuget-package, myget

```
Visual Studio 2012 > Tools > Options > Package Manager > Package Sources 
```

我添加了一个指向 myget.org url 的新包源：

[http://www.myget.org/F/myfeed/](http://www.myget.org/F/myfeed/)

```
VS > Tools > Library Package Manager > Manage NuGet Packages for Solution... 
```

现在提示我输入 myget 凭据。显然，开发人员每次使用 myget 包时都必须手动输入凭据会很不方便。

此博客解释了如何在机器级 NuGet.config 中存储凭据：

[https://gist.github.com/xavierdecoster/3205826](https://gist.github.com/xavierdecoster/3205826)

但在我按照这些步骤操作后，VS 仍然提示我输入凭据。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2015-02-03T16:18:59.320

一种方法是使用以下`sources`命令：

```
nuget.exe sources Add|Update -Name feedName -UserName user -Password secret 
```

有了这个，您可以使用凭据添加该源或更新现有的。它完美地工作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-21T09:01:19.597

你在代理后面吗？如果是这样，您可能希望按照文档中的说明将代理凭据添加到全局 NuGet.config：[http ://docs.nuget.org/docs/reference/nuget-config-file](http://docs.nuget.org/docs/reference/nuget-config-file)

# nginx - 没有 Content-Length 标头的 PUT 的 nginx proxy_pass 返回 411

> ID：15535854
> 
> 赞同：3
> 
> 时间：2013-03-20T22:17:04.237
> 
> 标签：nginx, reverse-proxy, http-status-code-411

我在使用 nginx proxy_pass 和 PUT 时遇到问题，但没有 Content-Length 标头返回 411 错误。

我跑来测试这个：

```
# curl -XPUT http://localhost:8080/
<html>
<head><title>411 Length Required</title></head>
<body bgcolor="white">
<center><h1>411 Length Required</h1></center>
<hr><center>nginx/1.1.19</center>
</body>
</html>
# touch temp
# curl -X PUT http://localhost:8080/ -T temp
{"response": "ok"} 
```

相关配置：

```
# Proxy to Backend Server
server {
    listen localhost:8080;

    location / {
        proxy_set_header Host $http_host;
        proxy_set_header X-Forwarded-Host $http_host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://backend_server;
    }
} 
```

我发现这个帖子似乎是同样的问题：

[http://forum.nginx.org/read.php?2,72279,72279#msg-72279](http://forum.nginx.org/read.php?2,72279,72279#msg-72279)

有没有办法让 nginx 在没有 Content-Length 标头的情况下代理 PUT 请求？

新版本的 nginx 不会受到此错误/限制的影响吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-14T12:02:41.530

升级到`nginx >= 1.4.1`（`1.3.9`或者`1.4.0`就足够了，但是有安全问题 thx @elhefe - 请参阅评论）或安装[NginxHttpChunkinModule ，如此](http://wiki.nginx.org/NginxHttpChunkinModule)[处](https://serverfault.com/questions/164220/is-there-a-way-to-avoid-nginx-411-content-length-required-errors)所述。有Debian 和 RedHat 系列的[官方软件包](http://nginx.org/en/linux_packages.html#stable)。

**德比安**：

*   喘不过气的反向移植（当前为 1.4.4-1）

    添加到`/etc/apt/sources.list`：

    ```
    deb http://ftp.debian.org/debian/ wheezy-backports main 
    ```

    运行并安装您选择的 nginx 版本 ( `nginx-full`, `nginx-light`, `nginx-naxsi`)

    ```
    apt-get update
    apt-get -t wheezy-backports install nginx-full 
    ```

*   nginx.org 包（目前稳定版为1.4.4）：

    ```
    wget http://nginx.org/keys/nginx_signing.key
    apt-key add nginx_signing.key 
    ```

    添加到`/etc/apt/sources.list`：

    ```
    deb http://nginx.org/packages/debian/ wheezy nginx
    deb-src http://nginx.org/packages/debian/ wheezy nginx 
    ```

    删除当前的 nginx 包：

    ```
    apt-get remove nginx-full nginx-common 
    ```

    更新包列表：

    ```
    apt-get update
    apt-get install nginx 
    ```

    对于类似 Debian 的行为更改更新`/etc/nginx/nginx.conf`

    ```
    user  www-data; 
    ```

    `http`并在部分末尾添加

    ```
    include /etc/nginx/sites-enabled/*; 
    ```

# c# - 引用多个数据表的下拉列表

> ID：15535860
> 
> 赞同：0
> 
> 时间：2013-03-20T22:17:22.210
> 
> 标签：c#, drop-down-menu, datatable

我正在创建一个 WMI 程序，它将查询输出到数据表，然后输出到数据网格。我想创建一个历史下拉列表，将当前日期和时间作为一个项目，并将刚刚创建的数据表克隆为“值”。

选择下拉列表中的项目会将数据网格更改为当时运行的任何先前数据表。

这是到目前为止的代码，但我不确定如何将数据表添加为字符串或数组？

```
// copy current data table

DataTable cloneTable = new DataTable();
cloneTable = dt.Copy();

ddlEventhistory.Items.Add(new Data { 
    Name = DateTime.Now.ToString(), 
    Value = cloneTable () 
}); 
ddlEventhistory.DisplayMember = "Name";
ddlEventhistory.ValueMember = "Value"; 
```

**更新 1：**这是我的自定义类：

```
 private class Data 
 { 
     public string Name { get; set; } 
     public Object Value { get; set; } 
 } 
```

**更新 2：**这是我的下拉列表更改的情况：

```
private void ddlEventhistory_SelectionChangeCommitted(object sender, EventArgs e)
{
    dgEvent.DataSource = (ddlEventhistory.SelectedValue as Data).Value as DataTable;                 
} 
```

**更新 3：**这是最终代码

```
private class Data 
 { 
     public string Name { get; set; } 
     public Object Value { get; set; } 
 }

//History

        //take existing data table and copy it's source
        DataTable eventhistory = new DataTable();
        eventhistory = (DataTable)dgEvent.DataSource;

        ddlEventhistory.Items.Add(new Data { Name = DateTime.Now.ToString(), Value = eventhistory });
        ddlEventhistory.DisplayMember = "Name";
        ddlEventhistory.ValueMember = "Value";

//when drop down list selection is changed do....

private void ddlEventhistory_SelectionChangeCommitted(object sender, EventArgs e)
    {
        // Assign DataTable of selected ComboBox item to DataGrid.
       dgEvent.DataSource = (ddlEventhistory.SelectedItem as Data).Value as DataTable;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T15:38:58.050

您可以像这样将数据的副本添加到您的组合框项目中。

```
//copy current data table
DataTable cloneTable = dt.Copy();

ddlEventhistory.Items.Add(new Data { Name = DateTime.Now.ToString(), Value = cloneTable }); 
ddlEventhistory.DisplayMember = "Name";
ddlEventhistory.ValueMember = "Value"; 
```

然后，当用户选择其中一项时，您可以像这样在 DataGrid 中显示它。

```
private void ddlEventhistory_SelectionChangeCommitted(object sender, EventArgs e)
{
    // Assign DataTable of selected ComboBox item to DataGrid.
    dgEvent.DataSource = (ddlEventhistory.SelectedItem as Data).Value as DataTable;
} 
```

# jquery - 将 .on() 与 .not() 链接以从对象中删除不需要的元素

> ID：15535863
> 
> 赞同：1
> 
> 时间：2013-03-20T22:17:29.977
> 
> 标签：jquery, jquery-selectors, onbeforeunload

我有一个 Web 表单，我将 beforeunload 事件绑定到窗口，以检测表单的任何更改，**除了**我不需要包含的输入。例如，我不需要绑定 beforeunload 事件的输入。它应该只绑定在离开窗口时会影响丢失更改的输入。

这是我当前的绑定：

```
formChanged = false;
$('#main-form').on('change.form_change', 'input:not(.leave-change-allowed), textarea:not(.leave-change-allowed), select:not(.leave-change-allowed)', function()
{
    if(!formChanged)
    {
        formChanged = true;

        $(window).bind('beforeunload', function()
        {
            if(formChanged)
            {
                return 'Are you sure you want to navigate away from this window, you will lose unsaved changes.';
            }
        });
    }
    else
    {
        $(this).unbind('change.form_change');   
    }
}); 
```

如您所见，我已将`:not(.leave-change-allowed)`元素包含在选择器中，以逗号分隔以选择表单元素。虽然，我不想将 添加`not()`到选择器，因为我想添加到 的选择器可能很少，`not()`但我需要应用到每个表单输入`input`和。请记住，这些元素是动态的，所以我使用而不是.`textarea``select``.on()``.change()`

如何将`.not()`函数与动态元素链接？所以我保持选择器完好无损，并在`.not()`函数中传递所有不必要的元素？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:21:14.327

检查函数内类的目标：

```
formChanged = false;
$('#main-form').on('change.form_change', 'input, textarea, select', function(e) {
    if(! (formChanged || $(e.target).is('.leave-change-allowed')) ) {
        formChanged = true;
        $(window).on('beforeunload', function() {
            if(formChanged) {
                return 'Are you sure you want to navigate away from this window, you will lose unsaved changes.';
            }
        });
    } else {
        $(this).off('change.form_change');   
    }
}); 
```

# c# - 未选中时如何隐藏收据中的复选框名称？

> ID：15535864
> 
> 赞同：1
> 
> 时间：2013-03-20T22:17:35.683
> 
> 标签：c#, checkbox

我想知道如何在未选中时隐藏收据中的复选框名称以下是我的代码：

```
richTextBox2.Visible = true;
tabControl1.Visible = false;
richTextBox2.Text = FirstName.Text + ' ' + Surname.Text +   (System.Environment.NewLine) +
FullAddress.Text + (System.Environment.NewLine) +
ContactNumber.Text + (System.Environment.NewLine) +
EmailAddress.Text + (System.Environment.NewLine) +
dob.Text +
(System.Environment.NewLine) +
"----------------------------------------------------------" +
(System.Environment.NewLine) +
textBox1.Text + (System.Environment.NewLine) +
textBox2.Text + (System.Environment.NewLine) +
textBox3.Text + (System.Environment.NewLine) +
"You have chosen to have a banner with the following text:" +
(System.Environment.NewLine) +
BannerText.Text + (System.Environment.NewLine) +
"at the price of " + label43.Text + (System.Environment.NewLine) +
"You have asked for the following accessories: " +
(System.Environment.NewLine) + MasksCB.Text+
(System.Environment.NewLine) + PartyCB.Text+
(System.Environment.NewLine) + CrackersCB.Text +
(System.Environment.NewLine) + HatsCB.Text+
(System.Environment.NewLine) + label18.Text; 
```

HatsCB PartyCB CrackersCB 和 MasksCB 都是复选框。打印收据时，即使没有选中这些框，它们也是可见的。我想知道如何在未选中这些框时隐藏它们，并在收据中选中这些框时使它们可见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:32:22.607

您可以像这样使用**[?: 运算符：](http://msdn.microsoft.com/en-us/library/ty67wk28.aspx)**

```
 "You have asked for the following accessories: " +
 (MasksCB.Checked  ? System.Environment.NewLine + MasksCB.Text : "") + 
 (PartyCB.Checked  ? System.Environment.NewLine + PartyCB.Text : "") + 
 ... 
```

仅在选中复选框时才打印文本

# css - 如何使用 css 格式化单个 gridview 单元格？

> ID：15535865
> 
> 赞同：2
> 
> 时间：2013-03-20T22:17:45.003
> 
> 标签：css, visual-studio-2010, gridview

是否可以在gridview中使用CSS格式化单个单元格

我正在`visual studio 2010`使用`vb`

我想做以下事情。基于这个表结构...

```
H1 H2 H3 H4
R1 i1 i2 i3
R2 j1 j2 j3
R3 k1 k2 k3 
```

我需要以下共振峰：

```
H1, H2, H3, H4 - Headings: bold, white font, blue background
R1, R2, R3- Bold => Row headings
i1, i2 - percentage
i3 - format number with 'pp' at the end, for example 10pp
j1, j2, j3 - mumber
k1, k2, k3 - percentage 
```

任何提示/想法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T20:03:10.410

我不太确定我理解你的问题。

据我所知，您正在尝试设置这些元素的样式。一种方法是将类添加到“td”，然后对这些类进行样式设置。另一种是在标签本身上添加“内联”样式。

至于“%”和“pp”，可以使用CSS3的“:after”作为其内容。但这并不是一个好主意。这些确实应该从后端生成，而不是从 CSS 生成。

# c# - 我可以在 Windows 服务中运行另一个命令提示符/GUI 进程吗？

> ID：15535868
> 
> 赞同：1
> 
> 时间：2013-03-20T22:17:53.767
> 
> 标签：c#, windows, windows-services

我正在编写一个 Windows 服务，它偶尔需要更新系统的 IP 地址，它会调用 ipconfig /renew 来完成它。代码将如下所示

```
 Process ipconfigProcess = new Process();                
            ipconfigProcess.StartInfo.FileName = "ipconfig";
            ipconfigProcess.StartInfo.Arguments = " /renew";
            ipconfigProcess.StartInfo.UseShellExecute = false;
            ipconfigProcess.StartInfo.RedirectStandardOutput = true;
            ipconfigProcess.Start();
            strOutput = compiler.StandardOutput.ReadToEnd();
            ipconfigProcess.WaitForExit(); 
```

我想不允许 Windows 服务显示窗口/对话框。所以我的问题是，在 Windows 服务中更新 ip 是否会成为问题，因为它可能会或可能不会显示控制台来运行 ipconfig ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:26:27.770

我认为您将面临的唯一问题是权限问题-运行这样的进程应该没有问题（只要您不想与任何类型的 UI 交互），但是您的 Windows 服务需要以能够生成进程并执行 ipconfig 的帐户运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:19:15.457

这不需要 cmd.exe 的实例。许多命令行应用程序都以这种方式使用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-22T02:06:35.960

服务可以使用 GUI 功能和/或创建控制台。Windows 会根据需要创建一个虚拟显示表面以供绘制。（显然，这个虚拟表面无法与用户交互。）

# java - 无法在 Spring Web Service 的肥皂响应中正确显示命名空间

> ID：15535871
> 
> 赞同：0
> 
> 时间：2013-03-20T22:18:00.173
> 
> 标签：java, spring, soap, marshalling

我似乎无法从根中摆脱 ns0 。我究竟做错了什么？

拦截器

```
@Override
    public boolean handleFault(MessageContext messageContext, Object endpoint) {

        SaajSoapMessage saajSoapMessage = (SaajSoapMessage) messageContext.getResponse();
        SoapMessage soapMessage = (SoapMessage) messageContext.getResponse();

        try {
            SOAPMessage saajMessage = saajSoapMessage.getSaajMessage();
            saajMessage.getSOAPPart().getEnvelope().setPrefix("soapenv");
            saajMessage.getSOAPPart().getEnvelope().removeNamespaceDeclaration("SOAP-ENV");
            saajMessage.getSOAPPart().getEnvelope().addNamespaceDeclaration("ims", "http://www.imsglobal.org/services/lis/cmsv1p0/wsdl11/sync/imscms_v1p");
            saajMessage.getSOAPHeader().setPrefix("soapenv");
            saajMessage.getSOAPBody().setPrefix("soapenv");
            saajMessage.saveChanges();
        } catch (SOAPException e) {
            e.printStackTrace();
        } 
```

**正确的**

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ims="http://www.imsglobal.org/services/lis/cmsv1p0/wsdl11/sync/imscms_v1p0"> 
```

**不正确**

```
<soapenv:Envelope ns0:ims="ims" xmlns:ns0="http://www.imsglobal.org/services/lis/cmsv1p0/wsdl11/sync/imscms_v1p0" xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:52:39.233

我通过更新订单解决了这个问题

```
try {
            SOAPMessage saajMessage = saajSoapMessage.getSaajMessage();

            saajMessage.getSOAPPart().getEnvelope().removeNamespaceDeclaration("SOAP-ENV");
            saajMessage.getSOAPPart().getEnvelope().addNamespaceDeclaration("ims", "http://www.imsglobal.org/services/lis/cmsv1p0/wsdl11/sync/imscms_v1p");
            saajMessage.getSOAPPart().getEnvelope().setPrefix("soapenv");
            saajMessage.getSOAPHeader().setPrefix("soapenv");
            saajMessage.getSOAPBody().setPrefix("soapenv");
            saajMessage.saveChanges();
        } catch (SOAPException e) {
            e.printStackTrace();
        } 
```

# iphone - 无法分发 AdHoc ipa 文件

> ID：15535873
> 
> 赞同：2
> 
> 时间：2013-03-20T22:18:08.920
> 
> 标签：iphone, wireless, adhoc, ipa

我有一个 xcode 项目，我想分发给我的同事，因此我在配置门户的设备部分添加了我所有的同事 UDID，然后我下载了分发和临时配置文件并单击它们以便他们来到我的组织者面前。然后我在 xcode 中使用它们并选择“build-archive”，然后我按照本指南[http://gknops.github.com/adHocGenerate/](http://gknops.github.com/adHocGenerate/)制作无线应用程序分发。并上传了provisiong文件、plist文件和ipa文件。但是，当我尝试使用我的 html 文件中的链接安装应用程序时，它开始安装但失败并显示此消息“现在无法安装“Appnamexxxx”。我不知道我做错了什么，我得到的错误并没有告诉我任何事情......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T07:13:25.860

我找到了它不起作用的原因。我已经在配置门户中输入了所有设备的 UDID，但我没有检查它们是否应该与该配置文件一起使用。我认为如果我输入了 UDID，它们会自动选择与配置文件一起使用，当我试图在门户中找到原因时，我纯粹靠运气发现了这一点。因此，必须选择配置并选择编辑，然后您有理由在该配置文件中选中/取消选中您想要的 UDID。希望这也可以帮助其他人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T11:58:15.177

您好，尝试使用 betabuilder。[http://www.hanchorllc.com/2010/08/24/introducing-ios-beta-builder/](http://www.hanchorllc.com/2010/08/24/introducing-ios-beta-builder/)

# r - 在 R 中推断时间序列数据

> ID：15535877
> 
> 赞同：2
> 
> 时间：2013-03-20T22:18:23.363
> 
> 标签：r, time-series, extrapolation

我有过去 20 年的时间序列数据。该变量每年都会测量，所以我有 20 个值。我有一个制表符分隔的文件，第一列代表年份，第二列代表值。这是它的样子：

```
1991 438
1992 408
1993 381
1994 361
1995 338
1996 315
1997 289
1998 261
1999 229
2000 206
2001 190
2002 173
2003 151
2004 141
2005 126
2006 108
2007 99
2008 93
2009 85
2010 77
2011 71
2012 67

```

我想推断未来几年第二列的价值。第二列中的值下降的速度也在下降，所以我认为我们不能使用线性回归。我想知道第二列将在哪一年接近零值。我从未使用过 R，所以如果您能帮助我编写用于从制表符分隔的文件中读取数据的代码，那就太好了。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T23:09:16.580

以下是可以帮助您入门的草图。

```
## get the data
tmp <- read.table(text="1991    438
1992    408
1993    381
1994    361
1995    338
1996    315
1997    289
1998    261
1999    229
2000    206
2001    190
2002    173
2003    151
2004    141
2005    126
2006    108
2007    99
2008    93
2009    85
2010    77
2011    71
2012    67", col.names=c("Year", "value"))

library(ggplot2)

## develop a model
tmp$pred1 <- predict(lm(value ~ poly(Year, 2), data=tmp))

## look at the data
p1 <- ggplot(tmp, aes(x = Year, y=value)) +
  geom_line() +
  geom_point() +
  geom_hline(aes(yintercept=0))

print(p1)

## check the model
p1 +
  geom_line(aes(y = pred1), color="red")

## extrapolate based on model
pred <- data.frame(Year=1990:2050)
pred$value <- predict(lm(value ~ poly(Year, 2), data=tmp),newdata=pred)

p1 +
  geom_line(color="red", data=pred) 
```

在这种情况下，我们的模型说这条线永远不会过零。如果这没有意义，那么您将需要选择不同的模型。无论您选择哪种模型，将结果与数据一起绘制成图表，以便您了解自己的表现。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-20T22:47:38.787

**从格式化文件中读取数据：**

```
require(utils)  # (make sure you have 'utils' package installed!)
data <- read.table('<filename>', header=FALSE, colnames=c('Year','Value')) 
```

并查看[read.table 手册页](http://stat.ethz.ch/R-manual/R-patched/library/utils/html/read.table.html)

**要推断数据：**

正如[EDi](https://stackoverflow.com/users/511399/edi)和[Dirk](https://stackoverflow.com/users/143305/dirk-eddelbuettel)所说，您需要做一些阅读。决定你想要什么样的外推 fn：线性（[Hmisc::approxExtrap](http://www.inside-r.org/packages/cran/Hmisc/docs/approxExtrap)用于线性外推；[approxfun](http://stat.ethz.ch/R-manual/R-patched/library/stats/html/approxfun.html)进行插值但不进行外推），样条线（[stats::splinefun](http://stat.ethz.ch/R-manual/R-patched/library/stats/html/splinefun.html)或[splines](http://stat.ethz.ch/R-manual/R-patched/library/splines/html/00Index.html)包）等`splinefun`可能适合您的情况。专门用于预测时间序列，请参阅[预测](https://stackoverflow.com/questions/10302261/forecasting-time-series-data)（您还应该浏览相关的 SO 问题）。在您浏览这些联机帮助页后，尝试一下，发布一些代码并告诉我们您遇到的问题，可以做出更多回应。否则你会被无情地激怒，你的问题很可能会被关闭为*“给我密码”*；-)

# xcode - 不同文件的新标签

> ID：15535884
> 
> 赞同：1
> 
> 时间：2013-03-20T22:18:40.923
> 
> 标签：xcode

我需要像通用编辑器一样使用 Xcode。例如，我需要打开文件 .txt、.project 等……如果我一次打开一个文件一切顺利，但我需要将其他文件放在新选项卡中。

我试过了

```
cmd+t 
```

但是新标签的文本与第一个标签完全相同……如果我双击打开另一个文件，它会打开一个新窗口而不是新标签……有解决方案吗？

多谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:21:10.453

Command+T 将打开一个包含相同文件的新选项卡，然后您可以导航到一个新文件并在任一选项卡中打开该文件。

XCode 将无法假定您要在新选项卡中打开什么文件，并且它不想打开一个空选项卡，因此它会在新选项卡中打开当前文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-03T12:13:33.630

对于 XCode 10，右键单击文件，选择*Open in New Tab*。

[![在此处输入图像描述](../Images/e2422647e6fae9e01534fa7132ff80c7.png)](https://i.stack.imgur.com/30FQI.png)

不知道什么时候加的。

# php - 使用 POST 时未将变量发送到服务器

> ID：15535889
> 
> 赞同：0
> 
> 时间：2013-03-20T22:19:03.437
> 
> 标签：php, javascript, ajax, wamp

用户在其计算机上使用以下`JavaScript`/运行页面`Ajax`：

```
xmlhttp.open("POST", "ProcessRequest.php", true);
xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
xmlhttp.send(encodeURIComponent("fname=Mr.&lname=tester")); 
```

服务器端脚本 ProcessRequest.php 似乎无法访问这些变量。
例如 `$_POST['fname']` 给出以下错误：

> 注意：未定义索引：fname

我究竟做错了什么？我正在使用 WAMP 运行它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:20:55.930

你编码太多了。你需要的是这样的：

```
xmlhttp.send("fname=" + encodeURIComponent("Mr.") + "&lname=" + encodeURIComponent("tester")); 
```

当然，您可以使用一个函数来使其更加干燥。

# c++ - Delphi typcast tlist 项 C++ 方法

> ID：15535896
> 
> 赞同：1
> 
> 时间：2013-03-20T22:19:45.497
> 
> 标签：c++, delphi, inheritance, casting, tlist

嗨，我有一个关于某些类型转换方法的问题。我正在将一些 Delphi 文件翻译成 C++。我有从 TList 派生的类的 delphi 声明，它是其他派生类的基类。

```
type TBaseItem = class (TObject)
public
  procedure SomeProcedure; virtual; abstract;
end;

Type TBaseClass = class(TList)
private 
  function GetItem(Index: Integer): TBaseItem;
  procedure SetItem(Value: TBaseItem; Index: Integer);
public
  property Items[Index: Integer]: TBaseItem read GetItem write SetItem;
end;

function TBaseClass.GetItem(Index: Integer): TBaseItem;
begin
  Result := TBaseItem(inherited Items[Index]);
end;

procedure TBaseClass.SetItem(Value: TBaseItem; Index: Integer);
begin
  inherited Items[Index] := Value;
end; 
```

这是两个基类 TBaseItem 和 TBaseClass。所以这里声明了从 TBaseItem 派生的新类 TchildItem 和从 TBaseClass 派生的 TChildClass。TChildItem 是覆盖方法 SomeMethod，更重要的是 TChildtClass 正在覆盖属性 Items，现在我们正在返回 TParentItem 项 insted 的 TBaseItem。

```
type TChildItem = class (TBaseItem)
public
  procedure SomeProcedure; override;
end;

type TChildClass = class(TBaseClass)
private 
  function GetItem(Index: Integer): TChildItem;
  procedure SetItem(Value: TChildItem; Index: Integer);
public
  property Items[Index: Integer]: TChildItemread GetItem write SetItem;
end;

function TChildClass .GetItem(Index: Integer): TChildItem;
begin
  Result := TChildItem(inherited Items[Index]);
end;

procedure TChildClass.SetItem(Value: TChildItem; Index: Integer);
begin
  inherited Items[Index] := Value;
end; 
```

通过这个例子，我想展示派生类和覆盖属性是多么容易。从列表中获取正确类型的项目只需调用父（基）属性 Item 并将其类型转换为正确类型即可。这是德尔福方法。

我想知道如何将这部分代码翻译成 C++。目前我声明了一个新的基类，它不是从任何类派生的，它有 public var Items 是

```
class TBaseItem{
  virtual void SomeMethod();
}

class TBaseClass {
public:
  vector<TBaseItem> Items; 
};

class TChildItem : public TBaseItem{
}

class TChildClass : public TBaseClass {
}; 
```

然后使用

```
return (TChildItem) Items[Idx] 
```

这意味着我想访问父级的（TBaseClass）公共变量，例如那个向量项并将它的类型转换为正确的类型......我的第一印象是我可能会使用 Delphi 方法进入错误的方向。

你有什么建议？我该怎么办？

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T22:36:41.050

Delphi 代码是旧的并且早于泛型，Delphi 类似于 C++ 模板。在现代 Delphi 代码中，这些列表类根本不存在。相反，人们会使用`TList<TBaseItem>`and `TList<TChildItem>`。

在 C++ 代码中，您只需使用`vector<TBaseItem*>`and `vector<TChildItem*>`。在您的 C++ 翻译中实现`TBaseClass`和`TChildClass`.

我也会更正你的术语。Delphi 属性不能被覆盖。新的财产`TChildClass`就是这样，一个新的财产。

# python - 从子元素选择到父元素末尾的xpath

> ID：15535897
> 
> 赞同：0
> 
> 时间：2013-03-20T22:19:46.523
> 
> 标签：python, xml, xpath, lxml

我正在尝试使用 lxml 来做到这一点，但最终这是一个关于正确 xpath 的问题。我想从`<pgBreak>`元素中选择直到其父元素结束，在这种情况下`<p`>

# XML 输入：

```
 <root>
     <pgBreak pgId="1"/>
      <p>
         some text to fill out a para
           <pgBreak pgId="2"/>
            some more text 
            <quote> A quoted block </quote>
            remainder of para
      </p>
    </root> 
```

# XML 输出：

```
 <root>
     <pgBreak pgId="1"/>
      <p>
         some text to fill out a para
       </p>
          <pgBreak pgId="2"/>
       <p>
             some more text 
            <quote> A quoted block </quote>
            remainder of para
      </p>
    </root> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:30:10.017

你要做的不是微不足道的：你不仅想匹配'pgBreak'元素和所有后续的兄弟姐妹，然后你想将它们移到父范围之外并将兄弟姐妹包装在'p'元素中。好玩的东西。

以下代码应该让您了解如何实现这一点（免责声明：仅示例，需要清理，可能未处理边缘情况）。代码是故意取消注释的，所以你必须弄清楚:)

我稍微修改了输入 XML 以更好地说明功能。

```
import lxml.etree

text = """
<root>
  <pgBreak pgId="1"/>
  <p>
    some text to fill out a para
    <pgBreak pgId="2"/>
    some more text 
    <quote> A quoted block </quote>
    remainder of para
    <pgBreak pgId="3"/>
    <p>
       blurb
    </p>
  </p>
</root>
"""

root = lxml.etree.fromstring(text)
for pgbreak in root.xpath('//pgBreak'):
    inner = pgbreak.getparent()
    if inner == root:
        continue
    outer = inner.getparent()
    pgbreak_index = inner.index(pgbreak)
    inner_index = outer.index(inner) + 1
    siblings = inner[pgbreak_index+1:]
    inner.remove(pgbreak)
    outer.insert(inner_index,pgbreak)
    if siblings[0].tag != 'p':
        p = lxml.etree.Element('p')
        p.text = pgbreak.tail
        pgbreak.tail = None
        for node in siblings:
            p.append(node)
        outer.insert(inner_index+1,p)
    else:
        for node in siblings:
            inner_index += 1
            outer.insert(inner_index,node) 
```

输出是：

```
<root>
  <pgBreak pgId="1"/>
  <p>
    some text to fill out a para
  </p>
  <pgBreak pgId="2"/>
  <p>
    some more text 
    <quote> A quoted block </quote>
    remainder of para
  </p>
  <pgBreak pgId="3"/>
  <p>
    blurb
  </p>
</root> 
```

# java - Java：数组中的唯一项

> ID：15535898
> 
> 赞同：0
> 
> 时间：2013-03-20T22:19:50.330
> 
> 标签：java, arrays, unique

我似乎无法将我的大脑包裹起来，但可以说我得到了一个包含不同元素的数组。如果我想创建另一个仅包含第一个数组中唯一元素的数组，我将如何在不使用 Maps、HashSets 等的情况下执行此操作（不从 java 导入任何其他内容）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:22:40.737

简单的蛮力算法。
只需（双）循环数组并检查元素是否重复。如果没有将其添加到数组中并继续。`O(N^2)`复杂性而不是`O(N)`复杂性使用`Map`或`Set`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:30:48.237

请不要对此投票，请参阅 Cratylus 的回答 - 或者更好的是 harpun 的评论。这只是*具有 O(n ² ) 复杂性*的解决方案的一些“伪代码” 。

* * *

```
foreach element1 in array:
    duplicate = false
    foreach element2 in array:
        if element 1 == element 2:
            duplicate = true
            break // out of inner loop
    if duplicate:
       // duplicate
    else:
       // not duplicate 
```

当然，这可以在稍高的层次上更清晰地表达出来。“包含”的定义应该是显而易见的。

```
foreach element in array:
   if contains(array, element):
       // duplicate 
```

# objective-c - 块保留命名约定的循环？

> ID：15535899
> 
> 赞同：7
> 
> 时间：2013-03-20T22:19:50.380
> 
> 标签：objective-c, automatic-ref-counting, clang

我很惊讶地发现以下行为......

```
@interface Foo : NSObject

- (void)addBar:(id)aBar withCompletion:(void(^)(void))completion;

@end

@interface AwesomeClass : NSObject

@property (strong, nonatomic) Foo *foo;

- (void)doSomethingWithBar:(id)bar;

@end

@implementation AwesomeClass

- (void)doSomethingWithBar:(id)bar
{
    [self.foo addBar:bar withCompletion:^{
        NSLog(@"%@", self.foo);
    }];
} 
```

`-doSomethingWithBar:`在 Xcode 4.6.1 中，我在执行“在此块中强烈捕获 'self' 可能会导致保留周期”的实现时收到警告。

但是，如果我将方法*名称*重构`-addBar:withCompletion:`为此`-setupBar:withCompletion:`警告，则会消失。似乎我对此感到惊讶，这表明我在 Objective-C 命名约定方面的知识存在差距！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-20T23:06:25.470

编码

```
[self.foo someMethod:bar withCompletion:^{
    NSLog(@"%@", self.foo);
}]; 
```

通常不会创建保留周期。如果`someMethod:withCompletion:`只是调用块并返回，则根本没有保留循环。（`-[NSArray enumerateObjectsUsingBlock:]`是一个例子。）

仅当`someMethod:withCompletion:`“记住”稍后要执行的块时，才有可能的保留循环。因此 clang 使用启发式方法来确定它是否是“类似 setter”的方法，将块存储`Foo`到稍后执行的属性中。

`-set<Key>`并且`-add<Key>`是键值编码中的访问器模式，用于设置属性或将值添加到（对多）关系中，这正是 clang 检查的内容。

这可以在[Clang 源代码](http://www.opensource.apple.com/source/clang/clang-421.11.65/src/tools/clang/lib/Sema/SemaChecking.cpp)中看到：

```
/// Check for a keyword selector that starts with the word 'add' or
/// 'set'.
static bool isSetterLikeSelector(Selector sel) {
  if (sel.isUnarySelector()) return false;

  StringRef str = sel.getNameForSlot(0);
  while (!str.empty() && str.front() == '_') str = str.substr(1);
  if (str.startswith("set"))
    str = str.substr(3);
  else if (str.startswith("add")) {
    // Specially whitelist 'addOperationWithBlock:'.
    if (sel.getNumArgs() == 1 && str.startswith("addOperationWithBlock"))
      return false;
    str = str.substr(3);
  }
  else
    return false;

  if (str.empty()) return true;
  return !islower(str.front());
} 
```

这里称为：

```
/// Check a message send to see if it's likely to cause a retain cycle.
void Sema::checkRetainCycles(ObjCMessageExpr *msg) {
  // Only check instance methods whose selector looks like a setter.
  if (!msg->isInstanceMessage() || !isSetterLikeSelector(msg->getSelector()))
    return;

  /*
   * rest omitted
   */

} 
```

您的`setupBar`方法*不*被视为“setter-like”方法，因为“set”后面没有大写字母。

# javascript - 在 Mongoose 文档获取上自动填充（）

> ID：15535903
> 
> 赞同：3
> 
> 时间：2013-03-20T22:19:59.650
> 
> 标签：javascript, node.js, mongodb, mongoose

是否可以为特定模型的引用子文档自动运行 populate() ？

我有一个城市模型，它引用了我希望在获取城市/城市时自动填充的地区和国家文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:29:50.200

好吧，Mongoose 网站上没有这方面的文档。我所做的是这样的：

```
schema.statics.createQuery = function( populates ) {
   var query = this.find();
   populates.forEach(function( p ) {
       query.populate( p );
   });

   return query;
}; 
```

当然，这种方法有验证和其他一些东西，但本质上这是我对模型所做的。

在您的情况下，如果您在每个 find 调用中都严格需要它们，您可以用这种方法对填充进行硬编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-10T05:07:59.177

AFAIK 无法自动填充对其他模型的所有引用（尽管有插件）。以与@gustavohenke 的答案类似的方式，您可以使用静态，并对您的查找查询进行少量更改。

这是我要做的：

```
citySchema.statics.fieldsToPopulate = function() {
   return ['regionField', 'countryField'];
}; 
```

Where`regionField`和`countryField`是分别引用模型`Region`和的字段`Country`。

然后在您的查询中，您可以相应地填充：

```
var populate = city.fieldsToPopulate ? city.fieldsToPopulate() : [];

city.findById(id)
   .populate(populate)
   .exec(function(err, data) {
      if (err) {
        return next(err);
      } else {
        res.render('template', { city: data });
      }
    }); 
```

# postgresql - Postgresql查询很慢

> ID：15535905
> 
> 赞同：1
> 
> 时间：2013-03-20T22:20:01.860
> 
> 标签：postgresql, query-optimization, database-performance

这个查询运行很慢。为什么？其他都很好。我认为索引很好。

```
explain analyze 
select "e_inst"."si_id" as "c0" 
from "e_inst" as "e_inst" 
group by "e_inst"."si_id" 
order by "e_inst"."si_id" ASC NULLS LAST 
```

查询计划：

```
Sort  (cost=12221.87..12221.90 rows=68 width=4) (actual time=1115.377..1115.433 rows=81 loops=1)
  Sort Key: si_id
  Sort Method: quicksort  Memory: 28kB
  ->  HashAggregate  (cost=12221.25..12221.45 rows=68 width=4) (actual time=1115.198..1115.261 rows=81 loops=1)
        ->  Seq Scan on e_inst  (cost=0.00..11920.07 rows=602357 width=4) (actual time=0.021..611.570 rows=602357 loops=1)
Total runtime: 1115.538 ms 
```

创建表和索引：

```
CREATE TABLE e_inst (
    id integer NOT NULL,
    ip numeric,
    gu character varying,
    referrer character varying,
    proc integer,
    loke_id integer,
    top_id integer,
    si_id integer,
    kop integer,
    count integer,
    created integer,
    modified integer,
    timepop integer,
    count_active character varying,
    country character(3),
    info character varying
);

CREATE INDEX "topEnhance" ON e_inst USING btree (created, top_id);
CREATE INDEX "procEnhance" ON e_inst USING btree (created, proc);
CREATE INDEX "countryEnhance" ON e_install USING btree (created, country);
CREATE INDEX "createdE" ON e_inst USING btree (created);
ALTER TABLE e_inst CLUSTER ON "createdE";
CREATE INDEX "lokeE" ON e_inst USING btree (loke_id);
CREATE INDEX "lokeEnhance" ON e_inst USING btree (created, loke_id);
CREATE INDEX "siE" ON e_inst USING btree (si_id);
CREATE INDEX "siEnhance" ON e_inst USING btree (created, si_id);
CREATE INDEX "kopEnhance" ON e_inst USING btree (created, kop); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T02:52:16.903

处理整个表的查询不会使用索引。

事实上，您正在检索*和处理*600k 条记录。它在一秒钟多一点的时间里就做到了，这实际上是令人印象深刻的。

现在在这种情况下，您尝试从 600k 记录中提取 81 个不同的值。您可能想要做的是构造一个递归查询，以便它获取一行 81 次。这*可能*会更快，但不能保证。通常我在返回的行数少得多的地方使用这些。然而，这里有一个例子：

```
WITH RECURSIVE sparse_scan AS (
    SELECT min(si_id) as si_id FROM e_inst
    UNION ALL
    SELECT min(si_id) as si_id
      FROM e_inst
      JOIN (select max(si_id) as last FROM sparse_scan) s
     WHERE s.last < si_id
)
SELECT si_id as c0 FROM sparse_scan; 
```

请注意，这会将顺序扫描替换为 81 次索引扫描。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T22:56:23.410

升级到 PostgreSQL 9.2。现在是仅索引扫描！效果很好，感谢 a_horse_with_no_name 建议我升级。

# shell - gnome 终端选项卡打开多个 ssh 连接

> ID：15535907
> 
> 赞同：2
> 
> 时间：2013-03-20T22:20:07.540
> 
> 标签：shell, ssh, tabs, gnome, gnome-terminal

我有一个包含服务器列表的文件：

服务器.TXT：

```
 192.168.0.100
    192.168.0.101
    192.168.0.102 
```

从 gnome 终端脚本，我想打开一个新终端，每个服务器都有一个选项卡。

这是我尝试过的：

```
gnome-terminal --profile=TabProfile `while read SERVER ; do echo "--tab -e 'ssh usr@$SERVER'"; done < SERVERS.TXT` 
```

这是错误：

> 无法解析参数：“--command/-e”的参数不是有效命令：文本在找到匹配的引号之前结束。（文本是“ssh”）

尝试删除 -e 后的空格

```
gnome-terminal --profile=TabProfile `while read SERVER ; do echo "--tab -e'ssh usr@$SERVER'"; done < SERVERS.TXT` 
```

我得到一个类似的错误：

> 无法解析参数：“--command/-e”的参数不是有效命令：文本在找到匹配的引号之前结束。（文本是'usr@192.168.0.100''）

显然存在解析错误，因为 shell 试图通过使用空格来预测和放置分隔符来提供帮助。服务器文件在没有通知的情况下被更改，并且需要查看许多不同的服务器集。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T04:23:09.863

我会尝试类似的东西：

```
$ while read SERVER;do echo -n "--tab -e 'ssh usr@$SERVER' "; \
  done < SERVERS.txt | xargs gnome-terminal --profile=TabProfile 
```

这是为了避免 shell 可以对参数进行任何解释（以破折号开头的任何内容）。

因为它是连接字符串（使用`-n`），所以需要在它们之间添加一个空格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-23T18:09:01.430

这是解析命令行选项的问题吗？有时，如果您有一个命令向另一个命令发送参数，第一个命令可能会感到困惑。约定是这样使用`--`：

```
echo -- "--tab -e 'ssh usr@$SERVER'"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-21T00:19:23.910

我在寻找 OP 所遇到问题的答案时发现了这个问题，但我的问题有点不同。我知道服务器列表，它们不在文件中。

无论如何，发布的其他解决方案对我不起作用，但以下脚本确实有效，并且是我用来解决`"--command/-e" is not a valid command"`错误的方法。

脚本应该很容易更改以适应任何需要：

```
#!/bin/sh
# Open a terminal to each of the servers
#
# The list of servers
LIST="server1.info server2.info server3.info server4.info"
cmdssh=`which ssh`

for s in $LIST
do
    title=`echo -n "${s}" | sed 's/^\(.\)/\U\1/'`
    args="${args} --tab --title=\"$title\" --command=\"${cmdssh} ${s}.com\""
done

tmpfile=`mktemp`
echo "gnome-terminal${args}" > $tmpfile
chmod 744 $tmpfile
. $tmpfile
rm $tmpfile 
```

现在最大的问题是为什么从文件运行时它会起作用，而不是从脚本中运行。当然，问题在于`--command`零件的转义，但是除非导出到临时文件，否则我尝试的一切都失败了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-26T09:43:09.107

尝试输入

> 评估

在 gnome 终端命令之前。

它应该是这样的：

```
eval /usr/bin/gnome-terminal $xargs 
```

为我工作！

# javascript - 将函数作为参数传递的范围问题

> ID：15535909
> 
> 赞同：0
> 
> 时间：2013-03-20T22:20:17.460
> 
> 标签：javascript, coffeescript

在我实例化我的类之后，我调用`myClass.testScope()`，它调用类中的另一个函数。但是，当我将函数作为参数传递时，我失去了作用域并调用`testScopeFromPassedParam`导致`data1`错误***Uncaught TypeError: Object [object global] has no method 'testScopeFromPassedParam'***

有人可以以最好的方式帮助解决这个问题吗？

[http://jsfiddle.net/2sJVX/4/](http://jsfiddle.net/2sJVX/4/)

```
class MyClass

  test: () ->

    @testScope()

  testScope: () ->

    console.log 'worky'

  testScopeFromPassedParam: () ->

    console.log 'no worky'

  data1: (cb) ->

    # Shoot. The error.
    @testScopeFromPassedParam()

    setTimeout (->
      cb '1'
    ), 1000

  data2: (cb) ->
    setTimeout (->
      cb '2'
    ), 3000

  loadData: () ->

    getDeferred = (someFunction) ->

      deferred = $.Deferred()

      someFunction (data) ->

        console.log data

        deferred.resolve()

      deferred

    dataFunctions = [
      @data1
      @data2
    ]

    arrayOfPromises = [ ]
    for someFunction in dataFunctions
      arrayOfPromises.push getDeferred(someFunction)

    $.when.apply(null, arrayOfPromises).done () =>
      alert 'returned'

myClass = new MyClass()
myClass.testScope()
myClass.loadData() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:50:47.787

这不是 [variable] 范围，而是这里丢失的[`this`上下文。](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)您需要将函数绑定到您的对象，在咖啡脚本中，您可以为此使用[胖箭头语法](http://coffeescript.org/#fat-arrow)：

```
data1: (cb) =>
    @testScopeFromPassedParam()
    … 
```

顺便说一句，您真的应该将 传递`data`给 resolve 函数（或者只使用`somefunction deferred.resolve`）

# php - Joomla 应用程序与移动应用程序的交互

> ID：15535911
> 
> 赞同：2
> 
> 时间：2013-03-20T22:20:22.093
> 
> 标签：php, database, web-services, joomla

我目前正在从事一个涉及 Joomla 应用程序和移动应用程序的项目。到目前为止，我已经创建了这两个应用程序，现在我想将 Mobile 应用程序链接到与 joomla 应用程序中使用的数据库相同的数据库。

我做了一些研究，由于安全原因等原因，直接连接到数据库似乎不是最佳选择……建议使用网络服务。

我对此的理解是，例如，我的数据库中有一个“播放器”表，其中包含播放器，通过 joomla 应用程序以 XML 或 JSON 格式输出这些播放器，然后移动应用程序可以访问并解析这些播放器。

我很好奇如何在 joomla 应用程序/框架中创建这个 web 服务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T05:03:40.690

Joomla 世界中有很多关于以某种方式将其集成到核心中的讨论。甚至还有一个 Web 服务工作组，所以这在未来会变得更容易。

就可以使用的东西而言，我见过的最好的代码仍然非常稀疏，但这可能是一个好的开始：[https](https://github.com/techjoomla/Joomla-REST-API) ://github.com/techjoomla/Joomla-REST-API 。这是由 Tech Joomla 提供的。我实际上并没有玩过这段代码，但它看起来正在实现一个 REST api，这可能是你想要的。

如需更多代码，您可能需要与工作组联系，看看他们是否有您可以帮助测试和改进您的情况的 beta 代码。[http://docs.joomla.org/Web_Services_Working_Group](http://docs.joomla.org/Web_Services_Working_Group)

# ruby-on-rails - 在 Windows 中通过 Cygwin 安装 RVM 时出错

> ID：15535918
> 
> 赞同：1
> 
> 时间：2013-03-20T22:20:49.577
> 
> 标签：ruby-on-rails, windows, cygwin, rvm

我正在尝试按照[本教程](http://blog.developwithpassion.com/blog/page/2/)通过 Cygwin 安装 RVM 。

创建目录并克隆 git 存储库后，我需要运行 ./osx_or_cygin_kick_off 开始安装过程。

这是我收到的错误消息：

```
 $ ./osx_or_cygwin_kick_off
  ./automation/rvm/rvm_install: line 2: $'\r': command not found
  ./automation/rvm/rvm_install: line 3: syntax error near unexpected token `$'\r''
  '/automation/rvm/rvm_install: line 3: `install_rvm()
  ./automation/rvm/rvm_install_some_rubies: line 2: $'\r': command not found
  ./automation/rvm/rvm_install_some_rubies: line 3: syntax error near unexpected token `$'\r''
  '/automation/rvm/rvm_install_some_rubies: line 3: `install_some_rubies() 
```

我在某处读到通过 doc2unix 将文件转换为 unix 格式可能会解决问题，但它只会创建更多错误消息。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:58:51.677

**编辑：**

问题是一些 Cygwin git 安装尝试进行魔术换行处理。要修复 git 使其停止修改行尾，请运行：

```
git config --global core.autocrlf false 
```

**评论澄清后，原始答案变得更加通用：**

该文件包含 CRLF ( `\r\n`) 结束行序列，这在 Windows 上很常见。不过，Unix 不喜欢它。Unix（和 Cygwin）只需要 LF（`\n`）。我猜你剪切并粘贴了那个文件，或者通过一些附加 Windows 行尾的机制下载了它。

在 Cygwin 中修复文件：

```
tr -d '\r' <filename >filename.tmp 
```

检查并确保 filename.tmp 看起来没问题，然后：

```
mv -f filename.tmp 
```

或者，执行浏览器下载并保存（而不是剪切和粘贴），或从 Cygwin shell 使用`curl`或下载`wget`。

在上述所有情况下，您可能都没有可执行文件（只是可读的）。您可以使用以下命令使其可执行：

```
chmod 755 filename 
```

或者通过 shell 显式运行它：

```
sh filename 
```

如果您使用 Windows 编辑器来操作 Cygwin 文件，您会经常遇到这个问题。Cygwin 中的编辑器会很好（例如 Vim）。可选地，许多免费的 Windows 编辑器支持 Unix 行尾。 [Notepad++](http://notepad-plus-plus.org/)是一个带有 Unix 行结束选项的好工具。

# paypal-sandbox - 沙盒无法充值

> ID：15535919
> 
> 赞同：6
> 
> 时间：2013-03-20T22:20:52.467
> 
> 标签：paypal-sandbox

我对新的 PayPal 开发者网站和沙盒感到悲痛。我在开发者中创建了一个个人帐户，但我添加的资金没有显示出来。我阅读了一篇论坛帖子，您必须通过沙盒登录添加资金，但它也不会让我添加资金。

菲尔

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T22:32:23.670

您必须使用您的开发者帐户登录[https://developer.paypal.com](https://developer.paypal.com)，然后转到 Applications->Sandbox Accounts->Create Account，第 5 个字段是“PayPal balance”，您可以在此处输入您想要的任何金额测试账户。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-02T11:37:20.307

Go to [https://www.sandbox.paypal.com](https://www.sandbox.paypal.com)

There use the option Send Money

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-03T05:04:06.800

“贝宝余额”在这里你可以放少于 5000 的金额。

# go - 为什么这个程序会产生输出

> ID：15535920
> 
> 赞同：1
> 
> 时间：2013-03-20T22:20:54.427
> 
> 标签：go, output, channel

我是`GO`谷歌的新手。在缓冲通道中，这里有一个程序：

```
package main

import "fmt"
import "time"

func main() {
    c := make(chan int, 2)
    c <- 1
    fmt.Println(<-c)
    time.Sleep(1000 * time.Millisecond)
    c <- 2    
    fmt.Println(<-c)
} 
```

它产生输出。但根据[http://tour.golang.org/#64](http://tour.golang.org/#64)它说：

> **仅当缓冲区已满**时才发送到缓冲通道块。当缓冲区为空时接收块。

正如它所说，它仅在**FULL**时发送，为什么程序会产生输出而不是`c`在第一个语句处等待无穷大。?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T22:27:04.367

您的频道的缓冲区大小为 2。您将一个 int 放入，然后将一个 int 拉出。然后你睡觉并重复这个过程。在您尝试插入第三个 int 而不拉出任何 int 之前，通道不会阻塞。前两个整数将被缓冲。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-21T09:26:00.950

我猜你没有正确理解幻灯片。它说“仅阻止”您理解“仅工作”。

幻灯片说的是：

*   如果缓冲区未满，则您的发送将正常工作并且不会阻塞

*   如果缓冲区已满，则您的发送将阻塞，直到缓冲区未满。

因此，您的示例按规定工作。

# ruby-on-rails - 在 jQuery Mobile 中选择活动选项

> ID：15535922
> 
> 赞同：0
> 
> 时间：2013-03-20T22:20:58.560
> 
> 标签：ruby-on-rails, jquery-mobile

我的应用程序的移动页面有一个带有 jQ​​uery Mobile 下拉选择菜单列表的标题，如下所示。

```
<span data-role="fieldcontain" id="category-dropdown">
  <select name="select-native-2" id="select-native-2" data-mini="true">
    <option value="<%= root_path %>">Home</option>
    <option value="<%= newest_path %>">New</option>    
    <option value="<%= group_path(Group.find(1)) %>">Group 1</option>
    <option value="<%= group_path(Group.find(2)) %>">Group 2</option>
    <option value="<%= group_path(Group.find(3)) %>">Group 3</option>
  </select>
</span> 
```

我正在使用下面的 Javascript 导航到选定的页面。

```
<script type="text/javascript">
$(document).ready(function() {
  $("#select-native-2").change(function(){
    if ($(this).val()!='') {
      window.location.href=$(this).val();
    }
  });
});
</script> 
```

我的问题是，当用户重定向到另一个页面时，选择菜单默认返回第一个选项（“主页”）。如何使选择菜单反映当前页面？

我的猜测是我需要

**#1 标记哪个选项是“活动的”，**然后

**#2 确保通过 javascript 在选择菜单上激活它**。

做这两件事的最佳方法是什么？

我可以像下面那样做**#1**，但它很丑

```
<option value="<%= root_path %>" id="<%= "active" if params[:controller] == "links" && params[:action] == "index" %>"> 
```

至于**＃2，**我不确定选择它的最佳方法是什么。

非常感谢您的意见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:32:28.923

为什么不直接使用`selected`属性？

```
<span data-role="fieldcontain" id="category-dropdown">
  <select name="select-native-2" id="select-native-2" data-mini="true">
    <option value="<%= root_path %>">Home</option>
    <option value="<%= newest_path %>">New</option>    
    <option selected value="<%= group_path(Group.find(1)) %>">Group 1</option>
    <option value="<%= group_path(Group.find(2)) %>">Group 2</option>
    <option value="<%= group_path(Group.find(3)) %>">Group 3</option>
  </select>
</span> 
```

这将使“第 1 组”成为页面加载时的选定选项。您只需要弄清楚哪个选项将获得此属性。但这在 Ruby 方面应该很容易做到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T15:29:16.833

只是为了添加到@Steve 的解决方案，我编写了一个帮助程序来帮助选择当前页面。

```
def is_selected?(action, name)
  if params[:controller] == "links" # this is the controller for my root and newest paths
    "selected" if params[:action] == action
  elsif params[:controller] == "groups"
    "selected" if @group.name == name
  end
end 
```

# oop - 如何在 Matlab 中访问超类的常量属性？

> ID：15535923
> 
> 赞同：3
> 
> 时间：2013-03-20T22:21:00.747
> 
> 标签：oop, matlab, inheritance, subclass, superclass

我有一个简单的类结构，如下所示：

```
classdef super < hgsetget
    properties(Constant = true, Access = private)
        PROP1 = 1;
        PROP2 = {2 [3 4] [5 6]};
    end

    methods
        function self = super()
            // Constructor code here
            // ...
        end
    end
end 
```

然后由像这样的子类继承。

```
classdef sub < super
    properties
        PROP3 = 7;
    end

    methods
        function self = sub()
            // Subclass constructor here
            // ...
            self = self@super();
            test = self.PROP1; // I don't appear to have access to PROP1 from Super

        end
    end
end 
```

我的问题是当我尝试访问超级财产`PROP1`或`PROP2`似乎无法访问时：

> 类 sub 没有合适的方法、属性或字段 PROP1。

有没有办法在 Matlab 中访问超级的属性？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T23:43:29.557

在超类`super`中将属性属性设置为

```
properties(Constant = true, Access = protected) 
```

从[文档](http://www.mathworks.com/help/matlab/matlab_oop/property-attributes.html)中，访问属性确定哪些代码可以访问这些属性：

*   public - 不受限制的访问
*   protected - 从类或子类中的方法访问
*   private — 仅通过类方法访问（不从子类访问）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T23:37:53.513

您将属性定义为`private`，那些不是继承的。

改为使用`Access = protected`。

# python - 理解：每次迭代多个值

> ID：15535927
> 
> 赞同：12
> 
> 时间：2013-03-20T22:21:22.243
> 
> 标签：python, generator, list-comprehension

有没有办法在列表/字典/集合理解中每次迭代输出两个（或更多）项目？举个简单的例子，输出 1 到 3 的所有整数的正负双精度（也就是`{x | x = ±2n, n ∈ {1...3}}`），有没有类似下面这样的语法？

```
>>> [2*i, -2*i for i in range(1, 4)]
[2, -2, 4, -4, 6, -6] 
```

我知道我可以输出元组`(+i,-i)`并将其展平，但我想知道是否有任何方法可以使用单一理解完全解决问题。

目前，我正在生成两个列表并将它们连接起来（如果顺序不重要，这可行）：

```
>>> [2*i for i in range(1, 4)] + [-2*i for i in range(1, 4)]
[2, 4, 6, -2, -4, -6] 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-22T18:41:53.400

Another form of nested comprehension:

```
>>> [sub for i in range(1, 4) for sub in (2*i, -2*i)]
[2, -2, 4, -4, 6, -6] 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-20T22:28:43.110

另一种选择是嵌套推导：

```
r = [2*i*s for i in range(1, 4) for s in 1, -1] 
```

对于更一般的情况：

```
r = [item for tpl in (<something that yields tuples>) for item in tpl] 
```

用你原来的例子：

```
r = [item for tpl in ((2*i, -2*i) for i in range(1, 4)) for item in tpl] 
```

尽管我真的会`itertools.chain.from_iterable`像@Lattyware 所说的那样建议。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-20T22:25:12.603

[`itertools.chain.from_iterable()`](http://docs.python.org/3.3/library/itertools.html#itertools.chain.from_iterable)正如您所提到的，这里最好的答案是简单地使用来展平列表：

```
itertools.chain.from_iterable((2*i, -2*i) for i in range(1, 4)) 
```

这是非常易读的，并且不需要对源进行两次迭代（这可能是有问题的，因为某些迭代器可能会耗尽，这意味着额外的计算工作）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-20T22:27:32.993

虽然我会使用`itertools`@Lattyware 建议的方法，但这里有一个更通用的方法，使用生成器也可能会有所帮助。

```
>>> def nums():
        for i in range(1, 4):
            yield 2*i
            yield -2*i

>>> list(nums())
[2, -2, 4, -4, 6, -6] 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-20T22:31:14.353

根据[PEP202](http://www.python.org/dev/peps/pep-0202/)，无法从列表推导中输出多个对象：

> - 表格`[x, y for ...]`不被允许；一个是需要写的 `[(x, y) for ...]`。

# http - Mule 并不总是在出站 HTTP 端点上发送数据？

> ID：15535929
> 
> 赞同：0
> 
> 时间：2013-03-20T22:21:25.087
> 
> 标签：http, soap, imap, mule

我是 Mule 的新手，并试图让一个简单的流程工作。基本思想是从 imap 框中获取电子邮件，获取电子邮件的正文（文本），将其放入 xml/soap 消息中并发布到soap web 服务。

我已经设置了我的流程，它似乎适用于大约 50% 的邮件。如果消息很短，一切都会按预期进行；如果邮件有点长或包含附件，它会部分工作。

这是我的流程（仅相关部分）：

```
<imap:inbound-endpoint host="mailserver" port="143"
    user="me" password="mypassword" responseTimeout="10000" doc:name="IMAP"
    connector-ref="imap">

    <remove-attachment attachmentName="*" />

</imap:inbound-endpoint>
<remove-attachment attachmentName="*" doc:name="Attachment" />

<logger level="INFO" doc:name="Logger" />

<set-variable variableName="mailBody" value="#[payload]"
    doc:name="Variable" />

<mulexml:object-to-xml-transformer
    doc:name="Object to XML" />
<mulexml:xslt-transformer maxIdleTransformers="2"
    maxActiveTransformers="5" xsl-file="submit_to_wfp.xsl" doc:name="XSLT"
    ignoreBadInput="true">
    <mulexml:context-property key="mailbody"
        value="#[mailBody]" />
</mulexml:xslt-transformer>

<object-to-string-transformer doc:name="Object to String"
    encoding="UTF-8" ignoreBadInput="true" mimeType="text/xml" />

<message-properties-transformer
    doc:name="Message Properties" overwrite="true" encoding="UTF-8"
    mimeType="text/xml">
    <add-message-property key="content-Type" value="text/xml" />
</message-properties-transformer>

<!-- <file:outbound-endpoint path="/Users/me" outputPattern="xml.txt" responseTimeout="10000" 
    doc:name="File"/> -->
<http:outbound-endpoint exchange-pattern="request-response"
    host="localhost" port="8082" doc:name="HTTP" contentType="text/xml"
    path="wfp/services/wfp" encoding="UTF-8" mimeType="text/xml"
    responseTimeout="500000" /> 
```

奇怪的是，如果我启用出站文件端点而不是 HTTP，一切正常，并且流程会生成一个完美的 XML 文件。如果消息较长（由于大量文本和/或附件），Mule 会因未通过 HTTP 端点发送任何数据而失败（日志告诉我它已被触发）。

我应该在哪里寻找？顺便说一句，使用 Mule 3.4CE。

谢谢！

# ios - GPUImageHistogramFilter 用于给出零数据的静止图像

> ID：15535931
> 
> 赞同：5
> 
> 时间：2013-03-20T22:21:31.470
> 
> 标签：ios, objective-c, image-processing, gpuimage

[这个答案](https://stackoverflow.com/questions/14391997/how-to-generate-an-histogram-using-ios-gpuimage)非常相似，除了我想为静止图像生成直方图。

下面是我正在做的事情，它给出了一个包含所有 0 数据的直方图。有什么技巧可以让它工作吗？

```
GPUImageFilter *filter = [[GPUImageHistogramFilter alloc]  initWithHistogramType:kGPUImageHistogramRGB];

GPUImagePicture *original = [[[GPUImagePicture alloc] initWithImage:image] autorelease];

GPUImageGammaFilter *gammaFilter = [[GPUImageGammaFilter alloc] init];
[original addTarget:gammaFilter];
[gammaFilter addTarget:filter];

GPUImageHistogramGenerator *histogramGraph = [[GPUImageHistogramGenerator alloc] init];

[histogramGraph forceProcessingAtSize:CGSizeMake(256.0, 330.0)];
[filter addTarget:histogramGraph];

GPUImageAlphaBlendFilter *blendFilter = [[GPUImageAlphaBlendFilter alloc] init];
blendFilter.mix = 0.75;
[blendFilter forceProcessingAtSize:CGSizeMake(256.0, 330.0)];

[original addTarget:blendFilter];
[histogramGraph addTarget:blendFilter];

[blendFilter addTarget:gpuImageView];

[original processImage]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-28T08:19:01.460

Brad 在上一个版本中已将一些内部机制更改为 GPUImage 以改进内存管理（并且确实如此），现在您应该告诉过滤器保留静止图像的帧`-useNextFrameForImageCapture`。

```
UIImage *inputImage = [UIImage imageNamed:@"Lambeau.jpg"];

GPUImagePicture *stillImageSource = [[GPUImagePicture alloc] initWithImage:inputImage];
GPUImageSepiaFilter *stillImageFilter = [[GPUImageSepiaFilter alloc] init];

[stillImageSource addTarget:stillImageFilter];
[stillImageFilter useNextFrameForImageCapture]
[stillImageSource processImage];

UIImage *currentFilteredVideoFrame = [stillImageFilter imageFromCurrentFramebuffer]; 
```

# highcharts - Highcharts - 防止大标记溢出轴 - 我的气泡正在逃逸=（

> ID：15535932
> 
> 赞同：2
> 
> 时间：2013-03-20T22:21:37.647
> 
> 标签：highcharts

这张照片应该说明一切。我正在尝试使用 HighCharts 实现一个气泡图（基本上是一个散点图，标记大小根据某些指标发生变化）。可悲的是，我的一些气泡试图逃离图表，溢出轴并使事情看起来凌乱且难以阅读。有什么办法可以防止这种情况？显然我可以操纵轴的范围，但我宁愿隐藏气泡的溢出部分。此外，如果 x 轴需要从 0 开始（例如），这不是一个选项。图片：

溢出（Highcharts）：

![溢出泡沫](../Images/a7fa30aa0c4760fb29b650dcc4c0e992.png)

没有溢出（图表总监）。这就是我要的：

![气泡很好地切断](../Images/f90b5d93e1985ac2fc5341a946ddc03c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T09:41:46.070

我建议尝试使用 v3.0 beta 版本，它应该可以解决您的问题。请看示例：

[http://jsfiddle.net/g8JcL/68/](http://jsfiddle.net/g8JcL/68/)

```
 $('#container').highcharts({

    chart: {
        type: 'bubble',
        plotBorderWidth: 1,
        zoomType: 'xy'
    },

    title: {
        text: 'Highcharts bubbles with radial gradient fill'
    },

    xAxis: {
        minPadding:0,
        gridLineWidth: 1
    },

    yAxis: {
        startOnTick: false,
        endOnTick: false
    },

    series: [ {
        data: [
            [42, 38, 500],
            [6, 18, 1],
            [0, 93, 505],
            [57, 2, 90],
            [80, 76, 22],
            [11, 74, 96],
            [88, 56, 10],
            [30, 47, 49],
            [57, 62, 98],
            [4, 16, 16],
            [46, 10, 11],
            [22, 87, 89],
            [57, 91, 82],
            [45, 15, 98]
        ]
    }]

}); 
```

# internet-explorer - 自定义 CLeditor 按钮的 IE HTML1114 错误

> ID：15535933
> 
> 赞同：0
> 
> 时间：2013-03-20T22:21:47.673
> 
> 标签：internet-explorer, twitter-bootstrap, fine-uploader, cleditor

我正在使用 CLeditor、Fineuploader 和 Bootstrap 创建一个自定义按钮，该按钮会弹出更高级的文件上传模式。但是每次我启动模态我都会得到一个错误，我不知道如何修复它。基本上整个浏览器都冻结了。

```
HTML1114: Codepage unicode from (UNICODE byte order mark) overrides conflicting codepage windows-1252 from (11) 
```

我发现这个警告仍然显示出了什么问题，但它会正常进行。

所以 CLeditor 有一个糟糕的设计，它在单击时在自定义按钮上运行命令，而不是等待`buttonClick`回调运行这造成了一种情况，即 IE 正在调用`getRange(editor).pasteHTML(value)`值`undefined`以减轻它我只是将我的按钮名称添加到大 if else if 在`buttonClick`事件处理程序中

```
// Image uploader
else if (buttonName === "uploadImage") {
  return;
}

// All other buttons AVOID THIS NONSENSE FOR CUSTOM BUTTONS!!!
else if (!execCommand(editor, data.command, data.value, data.useCSS, buttonDiv)) {
   return false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:11:21.913

您确定“cleditor wysiwyg”的输出标题（如果我理解代码正确）是

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="x-ua-compatible" content="IE=Edge"/> 
```

IE=Edge 应该是`<head>`. 听起来很像 IE 正在切换回 quirksmode。[在此处](https://stackoverflow.com/a/10494507/1407478)查看更详细的解释说明。

# c++ - 在 Perfmon 中找到的 CPU 百分比

> ID：15535936
> 
> 赞同：2
> 
> 时间：2013-03-20T22:21:53.047
> 
> 标签：c++, winapi, cpu, perfmon, pdh

我正在编写一个客户端来从 Windows 机器上收集性能数据。该数据将被发送到存储信息并以图形方式显示的中央服务器。

我正在使用 Windows 性能 API 来收集系统数据。但现在我有一个小问题。服务器需要知道我发送的数据是如何相互关联的，我在网上找不到任何关于 CPU 计数器的有用信息。我的问题是这些计数器之间的关系如何。

**例子**

> % 处理器时间 + % 空闲时间 = 100%

这并不难发现，但我找不到有关其他百分比值的任何信息，例如中断时间、特权时间或用户时间。例如，这些与处理器时间的关系如何。最终目标是添加所有这些值并最终获得 100%。

提前谢谢你，对不起我的英语，我希望我的问题很清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:33:18.180

[这篇文章清楚地表明](http://technet.microsoft.com/en-us/library/cc750967.aspx)（在“将是 15%”结尾的段落中）

> % 特权时间 + % 用户时间 + % 空闲时间 = 100%

这意味着所有其他 CPU 时间测量值都是这三个测量值之一的子集。perfmon 中的“计数器描述”描述了它们中的大多数的关系，例如：

> % DPC Time 是 % Privileged Time 的一个组成部分，因为 DPC 在特权模式下执行。

% Interrupt Time 没有像这样记录，但它显然也是特权时间的一个组成部分。

# node.js - 如何在 Winston/Node.js 中设置日志级别

> ID：15535937
> 
> 赞同：29
> 
> 时间：2013-03-20T22:22:04.320
> 
> 标签：node.js, express, winston

我在我的 Node.js 应用程序中使用 Winston 日志记录并定义了文件传输。在我的整个代码中，我使用`logger.error`、`logger.warn`或进行日志记录`logger.info`。

我的问题是，如何指定日志级别？是否有我可以设置的配置文件和值以便只记录适当的日志消息？例如，我希望日志级别在我的开发环境中为“信息”，但在生产环境中为“错误”。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2014-04-08T10:41:56.200

如果您使用的是*默认记录器*，则可以像这样调整日志级别：

```
const winston = require('winston');
// ...
winston.level = 'debug'; 
```

将日志级别设置为“调试”。（使用 winston 0.7.3 测试，[默认记录器仍在 3.2.1 中](https://github.com/winstonjs/winston/blob/master/lib/winston.js#L114-L126)）。

但是，[文档建议创建](https://github.com/winstonjs/winston#usage)具有适当日志级别的新记录器，然后使用该记录器：

```
const myLogger = winston.createLogger({
  level: 'debug'
});
myLogger.debug('hello world'); 
```

如果您已经在代码库中使用[默认记录器](https://github.com/winstonjs/winston/blob/master/lib/winston.js#L82-L90)，这可能需要您将所有用法替换为您正在使用的新记录器：

```
const winston = require('winston');
// default logger
winston.log('debug', 'default logger being used');

// custom logger
myLogger.log('debug', 'custom logger being used'); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-03-20T23:08:53.053

看起来[这里涵盖的选项中有一个级别选项](https://github.com/flatiron/winston)

从那个文档：

```
var logger = new (winston.Logger)({
  transports: [
    new (winston.transports.Console)({ level: 'error' }),
    new (winston.transports.File)({ filename: 'somefile.log' })
  ]
}); 
```

现在，这些示例显示了将选项对象中的级别传递到控制台传输。当您使用文件传输时，我相信您会传递一个不仅包含文件路径而且还包含级别的选项对象。

这应该导致类似：

```
var logger = new (winston.Logger)({
  transports: [
    new (winston.transports.File)({ filename: 'somefile.log', level: 'error' })
  ]
}); 
```

根据该文档，还请注意，从 2.0 开始，它公开了一个 setLevel 方法以在运行时更改。查看该文档的**使用日志级别**部分。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-21T03:58:56.240

winston 中有 6 个默认级别：silly=0（最低）、debug=1、verbose=2、info=3、warn=4、error=5（最高）

在创建记录器传输时，您可以指定日志级别，例如：

```
new (winston.transports.File)({ filename: 'somefile.log', level: 'warn' }) 
```

上面的代码会将日志级别设置为`warn`，这意味着`silly`,`verbose`并且`info`不会输出到 somefile.log ，而`warn`,`debug`和`error`will 。

您还可以定义自己的级别：

```
var myCustomLevels = {
  levels: {
    foo: 0,
    bar: 1,
    baz: 2,
    foobar: 3
  }
};

var customLevelLogger = new (winston.Logger)({ levels: myCustomLevels.levels });
customLevelLogger.foobar('some foobar level-ed message'); 
```

请注意，最好始终在您自己的自定义关卡中包含 6 个预定义关卡，以防在某处使用了预定义关卡。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-03-18T11:14:12.730

您可以通过修改`level`相应传输的属性来更改运行时的日志记录级别：

```
var log = new (winston.Logger)({
    transports: [
        new (winston.transports.Console)({ level : 'silly' })
    ]
});

...

// Only messages with level 'info' or higher will be logged after this.
log.transports.Console.level = 'info'; 
```

我想，它对文件的工作方式类似，但我没有尝试过。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-07T14:57:06.710

If you want to change the log level on the fly. Like for when you need to trace production issue for short amount of time; then revert to error log level. You can use a dynamic logger provided you can expose a service on the web [https://github.com/yannvr/Winston-dynamic-loglevel](https://github.com/yannvr/Winston-dynamic-loglevel)

# django - 上传的图片不显示，路径错误

> ID：15535938
> 
> 赞同：2
> 
> 时间：2013-03-20T22:22:13.213
> 
> 标签：django, upload, path

我在显示从管理面板上传的图像时遇到问题。Django呈现错误的路径，可能是由于我在某处的配置错误......

这是我的模型定义：

```
class Article(models.Model):
    """News article, displayed on homepage to attract users"""
    class Meta:
        db_table = 'article'
    title = models.CharField(max_length=64)
    headline = models.CharField(max_length=255)
    content = HTMLField()
    image = models.ImageField(upload_to = 'articles/', null=True, blank=True)
    active = models.BooleanField()
    created_at = models.DateTimeField()
    def __unicode__(self):
        return self.title 
```

这是网址配置：

```
from django.conf.urls import patterns, include, url
from django.conf import settings
from django.conf.urls.static import static

urlpatterns = patterns('',
# some stuff
) + static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT) 
```

设置.py：

```
PROJECT_DIR = os.path.dirname(__file__)
MEDIA_ROOT = os.path.join(PROJECT_DIR, "media")
MEDIA_URL = '/media/' 
```

风景：

```
def slider(request):
    context = Context ({ 'articles': Article.objects.order_by('-created_at')[:5] })
    return render(request, 'articles/slider.html', context) 
```

和模板：

```
{% for article in articles %}
  <img src="{{ article.image.url }}" alt="" /> 
```

我希望 django 渲染`http://127.0.0.1:8000/media/articles/slide-02.jpg`，但现在它渲染`http://127.0.0.1:8000/media/slide-02.jpg`. 我已经`upload_to=articles/`在模型类中定义了。那么为什么该`article.image.url`属性返回一个没有这个重要目录的路径呢？

* * *

编辑：我的模型有问题。它无法识别**upload_to**目录：

```
$ ./manage.py shell
Python 2.7.3 (default, Aug  1 2012, 05:14:39) 
[GCC 4.6.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
(InteractiveConsole)
>>> from articles.models import Article
>>> Article.objects.all()
[<Article: Blackened Recordings Launches>, <Article: The Rockin' Return of Deep Purple>, <Article: See Emily Day 20th April>, <Article: Celebration Day Premieres In Four Countries Announced>, <Article: Waging heavy innovation>, <Article: Rush to play festival D'Ete, Quebec City>]
>>> Article.objects.all().get(pk=1)
<Article: Blackened Recordings Launches>
>>> Article.objects.all().get(pk=1).image
<ImageFieldFile: slide-03.jpg>
>>> Article.objects.all().get(pk=1).image.path
u'/var/www/django/djninja/djninja/media/slide-03.jpg'
>>> Article.objects.all().get(pk=1).image.url
'/media/slide-03.jpg' 
```

同样，它应该`media/articles/slide-03.jpg`代替`media/slide-03.jpg`. 所以我猜所有路由/模板都可以，模型有问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T12:37:07.833

以上解决方案完全可以。我的问题是配置不正确的以 JSON 编写并加载到数据库中的装置。我认为在您将`articles`目录作为`upload_to`kwarg 传递时，它将被动态加载。**不是**。它仅在保存图像期间使用，在从数据库加载图像期间被忽略。因此，如果我有

```
"image":"slide.jpg" 
```

我将其更改为：

```
"image":"articles/slide.jpg" 
```

它奏效了。事实上，它一直有效，但我错过了 django 官方文档中的注释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T08:42:58.603

在**view.py**中：

```
from django.shortcuts import render_to_response, RequestContext
def slider(request):
    articles = Article.objects.order_by('-created_at')[:5]
    return render_to_response('articles/slider.html', locals(), context_instance = RequestContext(request) 
```

在**slider.html 中**：

```
{% for article in articles %}
    <img src="{{ MEDIA_URL }}{{ article.image.url }}" alt="" />
{% endfor %} 
```

在**urls.py**中：

```
from django.conf import settings
urlpatterns += patterns('',
    (r'^media/(?P<path>.*)$', 'django.views.static.serve', {'document_root': settings.MEDIA_ROOT}),
) 
```

尝试使用上面给出的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T08:42:40.233

您是否尝试使用上传方法：

```
def upload_path(self, filename):
    return 'media/articles/%s' % filename

class Article(models.Model):
    ...
    image = models.ImageField(upload_to=upload_path, null=True, blank=True)
    ... 
```

# seam - 使用哪个 Seam 组件： 或者 ?

> ID：15535939
> 
> 赞同：0
> 
> 时间：2013-03-20T22:22:15.407
> 
> 标签：seam

我对 Seam 很陌生，只是习惯了可用的不同组件。我想知道在这种情况下我应该使用哪一个。

[这个](https://stackoverflow.com/questions/4317684/when-should-i-use-houtputlink-instead-of-hcommandlink)问题的答案解释了`<h:outputLink>`和之间的区别`<h:commandLink>`，`<h:outputLink>`它只生成带有 GET 请求的基本 HTML 链接标签，并`<h:commandLink>`通过点击事件提交 POST。

我只想将一个简单的 jQuery 单击事件附加到链接。我不希望链接重定向到任何地方或提交表单。我基本上想要 href="#" 的等价物（我知道 commandLink 生成 href="#" 但对于没有表单提交的简单链接来说似乎很笨拙）。但是`<h:outputLink>`除非我输入 value="#" （这看起来很老套），否则会隐式添加一个 href 值。

我想在这里使用什么组件？我似乎缺少一些非常基本的元素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:38:51.260

（首先：`<h:outputLink>`and`<h:commandLink>`是标准的 JSF 组件，不是 Seam 框架的一部分。）在这种情况下，您可以只使用标准的 HTML 标签`<a>`，因为您似乎没有使用任何 JSF 特殊的东西。

# android - 回击键后Android游戏无法启动（重新启动）

> ID：15535943
> 
> 赞同：1
> 
> 时间：2013-03-20T22:22:20.927
> 
> 标签：android, restart, android-homebutton

在Android上单击主页或返回按钮后，我在重新启动游戏时遇到问题。

我在线程中找到了部分解决方案： [Android crash when app is closed and rebooted](https://stackoverflow.com/questions/5318847/android-crash-when-app-is-closed-and-reopened/5318902#5318902)，但重启后游戏无法正常运行。它只显示也会移动但不读取触摸的图像/精灵。

//这是在游戏视图中

```
public void surfaceChanged(SurfaceHolder holder, int format, int width,
        int height) { // ce se spremeni zaslon

}

public void surfaceCreated(SurfaceHolder holder) {

    createSprites();
    start();

}

public void start() {
    loop.setRunning(true);
    if (!mGameIsRunning) {
        loop.start();

        mGameIsRunning = true;
    } else {
        loop.onResume();
    }
}

public void surfaceDestroyed(SurfaceHolder holder) {
    boolean retry = true;
    while (retry) {
        try {
            loop.join();
            retry = false;

        } catch (InterruptedException e) {
        }
    }
} 
```

//这是游戏线程

```
 while (running) {
        canvas = null;
        try{
            canvas = this.surfaceHolder.lockCanvas();
            synchronized (surfaceHolder) {
                beginTime = System.currentTimeMillis();
                framesSkipped = 0;
                this.gameView.update();
                this.gameView.render(canvas);
                synchronized (mPauseLock) {
                    while (mPaused) {
                        try {
                            mPauseLock.wait();
                        } catch (InterruptedException e) {
                        }
                    }
                }
                timeDiff = System.currentTimeMillis() - beginTime;
                sleepTime = (int)(FRAME_PERIOD - timeDiff);

                if (sleepTime > 0){
                    try{
                        Thread.sleep(sleepTime);                        
                    } catch (InterruptedException e) {
                    }
                }
            }
        } finally {
            if (canvas != null){
                surfaceHolder.unlockCanvasAndPost(canvas);
            }

        }
    }
}
public void onPause() {
    synchronized (mPauseLock) {
        mPaused = true;
    }
}

public void onResume() {
    synchronized (mPauseLock) {
        mPaused = false;
        mPauseLock.notifyAll();
    }
} 
```

谁能告诉我是否有任何错误或任何其他解决方案。

感谢帮助。

或者如果有人能告诉我一个停止游戏并重新启动它的好方法，好吗？

我修复了它，以便在我回家时它可以工作，但是当我回击并重新启动它时，我得到黑屏。

// 当前游戏视图代码

```
public void surfaceCreated(SurfaceHolder holder) {
    if (loop==null)
        loop = new GameLoop(getHolder(), this);
     if(loop.getState() == Thread.State.TERMINATED)
     {
         loop = new GameLoop(getHolder(), this);
     }   

    start();

}

public void start() {
    if (!mGameIsRunning) {
        mGameIsRunning = true;
        loop.setRunning(true);
        loop.start();

    } else {
        loop.onResume();
        loop.start();
    }
}

public void surfaceDestroyed(SurfaceHolder holder) {
    loop.onPause(); 
} 
```

我感觉问题出在`surfaceDestroy`方法上，但我不确定，因为我不知道按 Home 键或返回键有什么区别。

# c# - 如何解决线性规划的有效方法

> ID：15535946
> 
> 赞同：3
> 
> 时间：2013-03-20T22:22:30.433
> 
> 标签：c#, performance, cplex

我对线性规划进行了研究，我需要解决一个复杂的（数百个变量和约束）问题。有很多方法可以在独立求解器中解决 LP（这不是问题）。但是，我需要从 C# 应用程序中解决它。我尽我所能找到如何在 C# 代码中解决 LP 的方法，但我发现（并且可用）的唯一东西是 CPLEX 和它的 .NET Concert 库。这看起来很不错（实际上我现在使用它并且效果很好）但是一些大型复杂问题的制定是一场真正的噩梦！可以用 AMPL 写成 10 行并且任何人都可以理解的内容，在 C# 中需要大约 200 行。

您是否知道任何 C# 库可以允许以某种有效（友好）的方式提供问题模型定义？（CPLEX 接受 LP 格式，但是当您尝试解决具有大量变量的问题然后算法运行很长时间时，它可能会增长到数百兆字节）或者我听说有可能将 AMPL 转换为 LP 格式然后解决它由 CPLEX C# 库提供，但听起来效率不高 :-)

简而言之，我有 C# 项目。我需要解决 LP 问题。我需要非常有效地解决它......所有这些都以某种相当简单的方式（而不是数百条混乱的线在for循环中添加变量和约束等）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:06:31.660

也许这不是您要寻找的答案，但 Concert for .NET 是对线性程序建模的好方法。我认为您只是在夸大 AMPL 和 Concert for .NET 之间的区别。这是 AMPL 书籍示例中的 AMPL 中的 SteelT.mod，后面是 CPLEX 中包含的 steel.cs 的一部分。这大致对应于相同的代码。缺少一些东西，例如数据读取和调用求解器，但必须将其写入 AMPL 中的单独文件中。它是 122 行。

是的，它比 AMPL 更难，因为它是通用编程语言的 API。如果您需要使用 C# 并且可以访问 CPLEX，这可能就足够了。它还比 AMPL 具有更大的功能，例如访问整数程序中的分支定界树。

CPLEX 本身包含许多非常好的 Concert 示例。

```
set PROD;     # products
param T > 0;  # number of weeks

param rate {PROD} > 0;          # tons per hour produced
param inv0 {PROD} >= 0;         # initial inventory
param avail {1..T} >= 0;        # hours available in week
param market {PROD,1..T} >= 0;  # limit on tons sold in week

param prodcost {PROD} >= 0;     # cost per ton produced
param invcost {PROD} >= 0;      # carrying cost/ton of inventory
param revenue {PROD,1..T} >= 0; # revenue per ton sold

var Make {PROD,1..T} >= 0;      # tons produced
var Inv {PROD,0..T} >= 0;       # tons inventoried
var Sell {p in PROD, t in 1..T} >= 0, <= market[p,t]; # tons sold

maximize Total_Profit:
  sum {p in PROD, t in 1..T} (revenue[p,t]*Sell[p,t] -
    prodcost[p]*Make[p,t] - invcost[p]*Inv[p,t]);

subject to Time {t in 1..T}:
  sum {p in PROD} (1/rate[p]) * Make[p,t] <= avail[t];

subject to Init_Inv {p in PROD}:  Inv[p,0] = inv0[p];

subject to Balance {p in PROD, t in 1..T}:
  Make[p,t] + Inv[p,t-1] = Sell[p,t] + Inv[p,t];

    public class Steel {
       internal static int _nProd;
       internal static int _nTime;

       internal static double[] _avail;
       internal static double[] _rate;
       internal static double[] _inv0;
       internal static double[] _prodCost;
       internal static double[] _invCost;

       internal static double[][] _revenue;
       internal static double[][] _market;

       internal static void ReadData(string fileName) {
          InputDataReader reader = new InputDataReader(fileName);

          _avail    = reader.ReadDoubleArray();
          _rate     = reader.ReadDoubleArray();
          _inv0     = reader.ReadDoubleArray();
          _prodCost = reader.ReadDoubleArray();
          _invCost  = reader.ReadDoubleArray();
          _revenue  = reader.ReadDoubleArrayArray();
          _market   = reader.ReadDoubleArrayArray();

          _nProd = _rate.Length;
          _nTime = _avail.Length;
       }

       public static void Main(string[] args) {
          try {
             string filename = "../../../../examples/data/steel.dat";
             if ( args.Length > 0 )
                filename = args[0];
             ReadData(filename);

             Cplex cplex = new Cplex();

             // VARIABLES
             INumVar[][] Make = new INumVar[_nProd][];
             for (int p = 0; p < _nProd; p++) {
                Make[p] = cplex.NumVarArray(_nTime, 0.0, System.Double.MaxValue);
             }

             INumVar[][] Inv = new INumVar[_nProd][];
             for (int p = 0; p < _nProd; p++) {
                Inv[p] = cplex.NumVarArray(_nTime, 0.0, System.Double.MaxValue);
             }

             INumVar[][] Sell = new INumVar[_nProd][];
             for (int p = 0; p < _nProd; p++) {
                 Sell[p] = new INumVar[_nTime];
                for (int t = 0; t < _nTime; t++) {
                   Sell[p][t] = cplex.NumVar(0.0, _market[p][t]);
                }
             }

             // OBJECTIVE
             ILinearNumExpr TotalRevenue  = cplex.LinearNumExpr();
             ILinearNumExpr TotalProdCost = cplex.LinearNumExpr();
             ILinearNumExpr TotalInvCost  = cplex.LinearNumExpr();

             for (int p = 0; p < _nProd; p++) {
                for (int t = 1; t < _nTime; t++) {
                   TotalRevenue.AddTerm (_revenue[p][t], Sell[p][t]);
                   TotalProdCost.AddTerm(_prodCost[p], Make[p][t]);
                   TotalInvCost.AddTerm (_invCost[p], Inv[p][t]);
                }
             }

             cplex.AddMaximize(cplex.Diff(TotalRevenue, 
                                          cplex.Sum(TotalProdCost, TotalInvCost)));

             // TIME AVAILABILITY CONSTRAINTS

             for (int t = 0; t < _nTime; t++) {
                ILinearNumExpr availExpr = cplex.LinearNumExpr();
                for (int p = 0; p < _nProd; p++) {
                   availExpr.AddTerm(1.0/_rate[p], Make[p][t]);
                }
                cplex.AddLe(availExpr, _avail[t]);
             }

             // MATERIAL BALANCE CONSTRAINTS

             for (int p = 0; p < _nProd; p++) {
                cplex.AddEq(cplex.Sum(Make[p][0], _inv0[p]), 
                            cplex.Sum(Sell[p][0], Inv[p][0]));
                for (int t = 1; t < _nTime; t++) {
                   cplex.AddEq(cplex.Sum(Make[p][t], Inv[p][t-1]), 
                               cplex.Sum(Sell[p][t], Inv[p][t]));
                }
             }

             cplex.ExportModel("steel.lp");

             if ( cplex.Solve() ) {
                System.Console.WriteLine();
                System.Console.WriteLine("Total Profit = " + cplex.ObjValue);

                System.Console.WriteLine();
                System.Console.WriteLine("\tp\tt\tMake\tInv\tSell");

                for (int p = 0; p < _nProd; p++) {
                   for (int t = 0; t < _nTime; t++) {
                      System.Console.WriteLine("\t" + p +"\t" + t +"\t" + cplex.GetValue(Make[p][t]) +
                                               "\t" + cplex.GetValue(Inv[p][t]) +"\t" + cplex.GetValue(Sell[p][t]));
                   }
                }
             }
             cplex.End();
          }
          catch (ILOG.Concert.Exception exc) {
             System.Console.WriteLine("Concert exception '" + exc + "' caught");
          }
          catch (System.IO.IOException exc) {
             System.Console.WriteLine("Error reading file " + args[0] + ": " + exc);
          }
          catch (InputDataReader.InputDataReaderException exc) {
             System.Console.WriteLine(exc);
          }
       }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T08:47:52.813

如果您使用的是 C 或 C++，我可能会推荐[GLPK](http://www.gnu.org/software/glpk/)。这是非常干净的代码，它附带了 AMPL 的某个子集的实现和一个求解器，对于您正在使用的大小的模型来说完全足够了。因此，您可以用 GNU Mathprog（它的 AMPL 方言）编写模型，然后直接将其输入 LP 求解器。

# ruby-on-rails - Rails - 一次具有单个值的自定义验证

> ID：15535949
> 
> 赞同：0
> 
> 时间：2013-03-20T22:22:36.663
> 
> 标签：ruby-on-rails, validation

所以我有这两个模型：

```
class Tag < ActiveRecord::Base
has_many :event_tags
attr_accessible :tag_id, :tag_type, :value
end

class EventTag < ActiveRecord::Base
belongs_to :tag
attr_accessible :tag_id, :event_id, :region
end 
```

和这个标签表：

```
**tag_id**    **tag_type**      **value**
    1         "funLevel"        "Boring..."
    2         "funLevel"        "A Little"
    3         "funLevel"        "Hellz ya"

    4         "generic"         "Needs less clowns"
    5         "generic"         "Lazer Tag"
    ... 
```

我想做的是编写一个自定义验证，它会检查以查看：

*   每个 event_id**仅**附加一个 tag_type 的“funLevel”，但可以有多个“通用”标签

例如：

```
t1 = EventTag.new(:tag_id => 1, :event_id =>777, :region => 'US')
t1.save  # success

t2 = EventTag.new(:tag_id => 2, :event_id =>777, :region => 'US')
t2.save  # failure 
         # because (event_id: 777) already has a tag_type of 
         # "funLevel" associated with it

t3 = EventTag.new(:tag_id => 4, :event_id =>777, :region => 'US')
t3.save  # success, because as (tag_id:4) is not "funLevel" type 
```

我想出了一个丑陋的解决方案：

```
def cannot_have_multiple_funLevel_tag
  list_of_tag_ids = EventTag.where("event_id = ?", event_id).pluck(:tag_id)
  if(Tag.where("tag_id in ?", list_of_tag_ids).pluck(:tag_type).include? "funLevel")
    errors.add(:tag_id, "Already has a Fun Level Tag!")
end 
```

作为 Rails 新手，有没有更好/更优雅/更便宜的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:53:41.417

结构化数据的方式意味着内置的 Rails 验证可能不会对您有很大帮助。**如果**`funLevel`类可以直接访问该属性`EventTag`，则可以使用以下内容：

```
# event_tag.rb
validate :tag_type, uniqueness: { scope: :event_id },
    if: Proc.new { |tag| tag.tag_type == "funLevel" } 
```

（不幸的是，通过快速测试，您似乎无法验证虚拟属性的唯一性。）

没有它，您可能无法使用自定义验证。您拥有的自定义验证的明显改进（假设您希望在 上进行验证`EventTag`）将不运行验证，除非那`EventTag`是一个`funLevel`标签：

```
def cannot_have_multiple_funLevel_tag
  return unless self.tag.tag_type == "funLevel"
  ...
end 
```

# python - numpy中3维矩阵的乘法

> ID：15535954
> 
> 赞同：6
> 
> 时间：2013-03-20T22:22:54.107
> 
> 标签：python, matrix, numpy, matrix-multiplication

我想我昨天问[错了问题。](https://stackoverflow.com/q/15516801/1382745)我真正想要的是将两个`2x2xN`矩阵相乘`A`，`B`这样

```
C[:,:,i] = dot(A[:,:,i], B[:,:,i]) 
```

例如，如果我有一个矩阵

```
A = np.arange(12).reshape(2, 2, 3) 
```

我怎样才能得到`C = A x A`上述定义？是否有内置功能可以做到这一点？

* * *

另外，如果我乘以`A (shape 2x2xN)`，`B (shape 2x2x1, instead of N)`我想得到

```
C[:,:,i] = dot(A[:,:,i], B[:,:,1]) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T22:37:45.587

尝试使用`numpy.einsum`，它有一点学习曲线，但它应该给你你想要的。这是一个帮助您入门的示例。

```
import numpy as np

A = np.random.random((2, 2, 3))
B = np.random.random((2, 2, 3))

C1 = np.empty((2, 2, 3))
for i in range(3):
    C1[:, :, i] = np.dot(A[:, :, i], B[:, :, i])

C2 = np.einsum('ijn,jkn->ikn', A, B)
np.allclose(C1, C2) 
```

# java - 有人可以解释 com.google.inject 的作用吗？

> ID：15535955
> 
> 赞同：8
> 
> 时间：2013-03-20T22:22:57.613
> 
> 标签：java, annotations, inject

我已经看到一个声明了一个类，它的唯一构造函数用`@Inject`. 而且我没有看到在整个项目的任何地方都调用了一个构造函数。

所以两个问题：

<1> 什么`@Inject`意思？（它有什么作用？为什么构造函数被它注解？）

<2> 如前所述，构造函数永远不会被直接调用，这与它被注释的事实有什么关系`@Inject`吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-20T22:30:33.463

Google [Guice](http://code.google.com/p/google-guice/)是一个依赖注入库，它允许您通过声明它们之间的关系来构造对象。对象的构造是因为它们被要求构造其他对象。您还可以通过配置 Guice 来实现具有不同实现的抽象类或接口，这对于运行或测试代码非常有用。

`@Inject`注释确定对象需要初始化的构造函数和方法。还有很多其他的注释决定了 Guice 的工作方式。但是仅仅注释对象是不够的；您还必须使用[Guice 绑定](http://code.google.com/p/google-guice/wiki/Bindings)配置它们。

这是一个非常简单的示例（来自我的一个应用程序）。我有一个`MySQLDataTracker`需要`MysqlConnectionPoolDataSource`：

```
public class MySQLDataTracker extends ExperimentDataTracker {
    @Inject
    public MySQLDataTracker(MysqlConnectionPoolDataSource ds) {
        ....
    }
} 
```

请注意，`MySQLDataTracker`extends`ExperimentDataTracker`是一个可以通过多种方式实现的抽象类。在我的 Guice 绑定中，我声明

```
bind(ExperimentDataTracker.class).to(MySQLDataTracker.class); 
```

这声明每当我想要`ExperimentDataTracker`a 时，`MySQLDataTracker`都会构造 a 。我还需要确保构造它的必要对象可用，所以我声明了一个提供者：

```
@Provides @Singleton 
MysqlConnectionPoolDataSource getMysqlCPDS() {
    return (some thingy I construct...);            
} 
```

这表示应该只有一个连接池数据源。这也意味着当我尝试获取 的实例时`ExperimentDataTracker`，Guice 拥有构建它所需的一切。如果我没有上述内容，它将引发错误。

```
ExperimentDataTracker tracker = injector.getInstance(ExperimentDataTracker.class); 
```

然而，它并不止于此。其他的东西依赖于`ExperimentDataTracker`，所以它反过来被用来注入其他对象。在我的代码的顶层实际上只有一次调用`getInstance`，这使得 Guice 几乎可以构建所有内容。我不必在`new`任何地方写声明。

在看到 Guice 如何减少初始化一堆对象以初始化其他对象的需要后，我成为了 Guice 的忠实粉丝。基本上我只是要求我想要的对象，然后噗！它出现。

# java - 如何创建“30 秒倒计时”？

> ID：15535956
> 
> 赞同：0
> 
> 时间：2013-03-20T22:23:00.670
> 
> 标签：java, android, countdowntimer

如何在任一 android 中编写一个简单的倒数计时器？对于 android，假设有一个名为 timerdisplay 的 textedit 字段将显示从 30 秒到 0 的倒计时

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:30:03.373

[http://docs.oracle.com/javase/1.3/docs/api/java/util/Timer.html](http://docs.oracle.com/javase/1.3/docs/api/java/util/Timer.html)
您可以使用 java timer Api 使用
**java.util.Timer**
**类 Timer进行定时器控制**

# android - Android 应用程序似乎在 setListAdapter 上崩溃

> ID：15535959
> 
> 赞同：-1
> 
> 时间：2013-03-20T22:23:12.603
> 
> 标签：android

我是 Android 开发的新手。这是我的代码：

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLConnection;
import java.util.ArrayList;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.Activity;
import android.app.ListActivity;
import android.os.Bundle;
import android.widget.ArrayAdapter;

public class MainActivity extends ListActivity {

/** Called when the activity is first created. */

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    setListAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1,     this.fetchTwitterPublicTimeline()));
  }

  public ArrayList<String> fetchTwitterPublicTimeline() {
      ArrayList<String> listItems = new ArrayList<String>();

      try {
          URL twitter = new URL("http://twitter.com/statuses/public_timeline.json");
          URLConnection tc = twitter.openConnection();
          BufferedReader in = new BufferedReader(new InputStreamReader(tc.getInputStream()));
          String line;

          while ((line = in.readLine()) != null) {
              JSONArray ja = new JSONArray(line);
              for (int i = 0; i < ja.length(); i++) {
                  JSONObject jo = (JSONObject) ja.get(i);
                  listItems.add(jo.getString("text"));
              }
          }
      } catch (MalformedURLException e) {
          // TODO Auto-generated catch block
          e.printStackTrace();
      } catch (IOException e) {
          // TODO Auto-generated catch block
          e.printStackTrace();
      } catch (JSONException e) {
          // TODO Auto-generated catch block
          e.printStackTrace();
      }

      return listItems;

  } 

} 
```

这是我的 acitivity_main.xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >
    <ListView android:id="@android:id/list"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>
</LinearLayout> 
```

logcat 在下面（或在[此链接](http://www.anonbin.com/3377207074)上）：

```
03-21 09:16:15.530: E/AndroidRuntime(31912):    ... 11 more
03-21 09:16:33.590: E/AndroidRuntime(31991): FATAL EXCEPTION: main
03-21 09:16:33.590: E/AndroidRuntime(31991): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.simplebrowser/com.example.simplebrowser.MainActivity}: android.os.NetworkOnMainThreadException
03-21 09:16:33.590: E/AndroidRuntime(31991):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at android.app.ActivityThread.access$600(ActivityThread.java:141)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at android.os.Handler.dispatchMessage(Handler.java:99)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at android.os.Looper.loop(Looper.java:137)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at android.app.ActivityThread.main(ActivityThread.java:5041)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at java.lang.reflect.Method.invokeNative(Native Method)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at java.lang.reflect.Method.invoke(Method.java:511)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at dalvik.system.NativeStart.main(Native Method)
03-21 09:16:33.590: E/AndroidRuntime(31991): Caused by: android.os.NetworkOnMainThreadException
03-21 09:16:33.590: E/AndroidRuntime(31991):    at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1117)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at java.net.InetAddress.lookupHostByName(InetAddress.java:385)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at java.net.InetAddress.getAllByNameImpl(InetAddress.java:236)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at java.net.InetAddress.getAllByName(InetAddress.java:214)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at libcore.net.http.HttpConnection.<init>(HttpConnection.java:70)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at libcore.net.http.HttpConnection.<init>(HttpConnection.java:50)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at libcore.net.http.HttpConnection$Address.connect(HttpConnection.java:340)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at libcore.net.http.HttpConnectionPool.get(HttpConnectionPool.java:87)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at libcore.net.http.HttpConnection.connect(HttpConnection.java:128)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at libcore.net.http.HttpEngine.openSocketConnection(HttpEngine.java:316)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at libcore.net.http.HttpEngine.connect(HttpEngine.java:311)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at libcore.net.http.HttpEngine.sendSocketRequest(HttpEngine.java:290)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at libcore.net.http.HttpEngine.sendRequest(HttpEngine.java:240)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at libcore.net.http.HttpURLConnectionImpl.getResponse(HttpURLConnectionImpl.java:282)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at libcore.net.http.HttpURLConnectionImpl.getInputStream(HttpURLConnectionImpl.java:177)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at com.example.simplebrowser.MainActivity.fetchTwitterPublicTimeline(MainActivity.java:38)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at com.example.simplebrowser.MainActivity.onCreate(MainActivity.java:29)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at android.app.Activity.performCreate(Activity.java:5104)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
03-21 09:16:33.590: E/AndroidRuntime(31991):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
03-21 09:16:33.590: E/AndroidRuntime(31991):    ... 11 more 
```

我已经按照[这个教程进行](http://inchoo.net/mobile-development/android-development/simple-android-json-parsing-example-with-output-into-listactivity/)操作，但我似乎无法让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:30:24.273

您必须执行网络任务`AsyncTask`以避免阻塞 UI 线程。

> 无法启动活动 ComponentInfo{com.example.simplebrowser/com.example.simplebrowser.MainActivity}：android.os.NetworkOnMainThreadException

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:30:39.780

您不能调用`fetchTwitterPublicTimeline()`主 UI 线程。在处理程序或计时器线程中将其称为延迟。

这是一个简单的例子：

```
Timer timer = new Timer();
timer.schedule(new TimerTask() {
    @Override
    public void run() {
        fetchTwitterPublicTimeline();
    }
}, 400); 
```

更好的做法是使用真正的`Thread`或更好的`AsyncTask`. 参考[有](http://developer.android.com/reference/android/os/AsyncTask.html)一个非常有用的例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T11:06:35.137

引起：android.os.NetworkOnMainThreadException，首先阅读您的异常并搜索解决方案，如果您没有找到任何问题，请发布问题。最简单的解决方案是使用 AsyncTask。有 doInBackGround() 和 onPostExecute()。

```
//This Run in background
protected void doInBackground(String url){

//fetch objects
//parse objects

//it pass parsedObjects to onPostExecute method
 return parsedObjects;
} 

//This run on current thread (Ui thread in this case) 
protected void onPostExecute(ParsedObjects o){
//Receives parsedObejct from doInBackground
//update UI
} 
```

# c# - ReadLine 问题

> ID：15535960
> 
> 赞同：0
> 
> 时间：2013-03-20T22:23:13.023
> 
> 标签：c#, string, console, int, readline

我需要在 C# 中创建一个控制台应用程序，它将接受数字和行

x 代表任何数字

xxxx-xx-xxxxxx

或 4 个数字，行，2 个数字，行，6 个数字。

建议的方法是询问用户输入并确认用户是否没有写整数并将行放在正确的位置。

我想把它放在一种格式中，这样用户就不必自己写这些行了。

我希望自动插入这些行，这样用户就不必放置它们，字符串的长度也总是相同的。（0-13 或 14 个字符）

这可以以任何相当简单的方式完成吗？

**编辑**：我编写并将代码添加到[pastebin](http://pastebin.com/cAt53NTV "糊盒")（因为将其全部放入此处相当长）

此代码接受字符串输入并确保没有输入无效字符，换句话说，它可以工作，但我希望程序以任何方式将“-”放置在它们应该自动出现的位置。并且能够限制您可以输入的字符数量（最多 14 个，包括行。）

我的主要问题是能够自动放置“-”，同时仍然能够使用退格键。

对不起，如果代码是原始的，它是一个学校项目，我还在学习。这是他们“希望我”使用的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:38:43.650

您可以尝试这样的事情（硬编码为长度为 14 的字符串，在位置 4 和 7 带有破折号）。它将拦截用户的所有输入并检查它是否是数字。如果它是一个数字，它会将其打印出来并将其添加到输入中。此外，当输入长度达到某个点时，它会打印出一个破折号。

```
 String input = "";
     while (input.Length < 14)
     {
        char c = Console.ReadKey(true).KeyChar;
        if (c >= 48 && c <= 57) // ASCII code for a digit (between 0 and 9)
        {
           input += c; // add digit to input
           Console.Write(c); // output it to the console
        }
        if (input.Length == 4 || input.Length == 7)
        {
           input += "-";
           Console.Write("-"); // add dash to the input and write it to console
        }
     } 
```

# jsf - 将 jpa 实体作为属性存储在 jsf 支持 bean 中

> ID：15535969
> 
> 赞同：0
> 
> 时间：2013-03-20T22:24:30.217
> 
> 标签：jsf, jpa

在我的 jsf bean 的 init 方法中，我正在调用从数据库中获取对象的服务。我们正在使用休眠。此 init 方法预先填充表单上的值。用户进行编辑并在提交时调用另一个方法来捕获编辑并更新数据库中的该对象。现在，我可以将在 init 方法期间检索到的数据库对象存储为支持 bean 上的属性，或者我可以在 jsf bean 中调用的提交方法中再次检索原始数据库对象（但这是对 db/cache 的另一个调用）。这里有首选方式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T03:37:57.603

1.  将检索到的实体实例放入会话中。
2.  使用将表单字段的目标设置为每个映射到字段`value="#{sessionScope.xxx.xxx}"`
3.  在提交时，您可以`merge`或`persist`会话中的实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T04:58:08.073

第一种方法（存储分离的实体并在提交时将其合并）更好，尤其是与版本字段一起使用时（请参阅[Java - JPA - @Version 注释](https://stackoverflow.com/questions/2572566/java-jpa-version-annotation)），因为它提供了一种检测陈旧实体的方法。

# xcode - Xcode 链接器问题 - 其他 LD 标志不会清除

> ID：15535981
> 
> 赞同：1
> 
> 时间：2013-03-20T22:25:30.870
> 
> 标签：xcode, linker, flags

我是一个菜鸟，并且遇到了链接器标志的问题。

我尝试构建自己的 ssh2 库，然后在已经构建的库中克隆了一个带有项目的 git 存储库。

在下载已编译的二进制文件之前，我正在使用 gcrypt 构建并将 -lgrcrypt 库添加到其他链接器标志。

使用我正在使用的这个新库集，我不再需要 gycrpt，因此我删除了链接器标志。但是，这并没有清除链接器选项。尽管在项目属性中清除了它们，我仍然得到所有旧的链接器标志。

该错误表明 -lgrypt 仍在作为链接器标志处理：

> -no_implicit_dylibs -mios-simulator-version-min=6.0 -lgcrypt

如何将链接器标志重置为原来的状态？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T16:48:09.570

好吧，我想您已经检查了标志并在项目的目标级别中删除了该库的路径，并且还清理了构建并从管理器和 xcode 内部删除了先前的构建，并且还重置了您的模拟器，并且还有检查您计算机上的项目文件夹并从项目的库文件夹中删除该库。这些是必要的步骤，如果您已完成所有这些步骤，那么除了将您的代码移植到新项目并尝试再次编译之外，我想不出其他任何方法。祝你好运，我的朋友。

# opengl - GLSL 从多个灯光计算颜色矢量

> ID：15535984
> 
> 赞同：6
> 
> 时间：2013-03-20T22:25:55.910
> 
> 标签：opengl, glsl

我正在使用我自己的（不是内置的 opengl）灯。这是我的片段着色器程序：

```
#version 330

in vec4 vertexPosition;
in vec3 surfaceNormal;
in vec2 textureCoordinate;
in vec3 eyeVecNormal;

out vec4 outputColor;

uniform sampler2D texture_diffuse;
uniform bool specular;
uniform float shininess;

struct Light {
    vec4 position;
    vec4 ambientColor;
    vec4 diffuseColor;
    vec4 specularColor;
};

uniform Light lights[8];

void main()
{
    outputColor = texture2D(texture_diffuse, textureCoordinate);
    for (int l = 0; l < 8; l++) {
        vec3 lightDirection = normalize(lights[l].position.xyz - vertexPosition.xyz);
        float diffuseLightIntensity = max(0, dot(surfaceNormal, lightDirection));

        outputColor.rgb += lights[l].ambientColor.rgb * lights[l].ambientColor.a;
        outputColor.rgb += lights[l].diffuseColor.rgb * lights[l].diffuseColor.a * diffuseLightIntensity;
        if (specular) {
            vec3 reflectionDirection = normalize(reflect(lightDirection, surfaceNormal));
            float specular = max(0.0, dot(eyeVecNormal, reflectionDirection));
            if (diffuseLightIntensity != 0) {
                vec3 specularColorOut = pow(specular, shininess) * lights[l].specularColor.rgb;
                outputColor.rgb += specularColorOut * lights[l].specularColor.a;
            }
        }
    }
} 
```

现在的问题是，当我有 2 个具有环境颜色的光源时`vec4(0.2f, 0.2f, 0.2f, 1.0f)`，模型上的环境颜色将是`vec4(0.4f, 0.4f, 0.4f, 1.0f)`因为我只是将它添加到 outputColor 变量中。**如何计算多个灯光的单个环境和单个漫反射颜色变量，这样我会得到一个真实的结果？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-20T23:07:15.720

这是一个有趣的事实：现实世界中的灯光没有环境、漫反射或镜面反射颜色。它们发出*一种*颜色。时期（好吧，如果你想成为技术人员，灯光会发出*很多*颜色。但是单个光子没有“环境”属性。它们只是具有不同的波长）。你所做的只是抄袭那些抄袭 OpenGL 关于环境光和漫射光颜色的废话的人。

不要再抄袭别人的代码，做*对*了。

每盏灯都有一种颜色。您使用该颜色来计算该光对对象的漫反射和镜面反射贡献。就是这样。

Ambient is a property of the *scene*, not of any particular light. It is intended to represent [indirect, global illumination](https://nicolbolas.github.io/oldtut/Illumination/Tut09%20Global%20Illumination.html): the light reflected from other objects in the scene, as taken as a general aggregate. You don't have ambient "lights"; there is only one ambient term, and it should be applied once.

# python - 在 OpenCV SIFT (Python) 中移除梯度方向直方图的高斯加权

> ID：15535985
> 
> 赞同：2
> 
> 时间：2013-03-20T22:25:57.117
> 
> 标签：python, opencv, computer-vision, histogram

在 SIFT 算法中，梯度方向直方图的条目是高斯加权的，这样离关键点中心越远的方向对直方图的贡献就越小。这可以在[OpenCV SIFT 源代码](https://code.ros.org/trac/opencv/browser/trunk/opencv/modules/features2d/src/sift.cpp?rev=5285)中的函数“ori_hist”中看到。我想摆脱这种加权，以便所有梯度方向对直方图的贡献相同。

本质上，我需要更改以下行

```
w = exp( -( i*i + j*j ) / exp_denom ); 
```

到

```
w = 1 
```

是否有 Python 绑定可以让我这样做？还是我只是运气不好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T05:22:26.547

下载 OpenCV 2.4.4 的源代码。在文件中进行必要的更改（C++），构建并安装它。我曾经遇到过卡尔曼滤波器（在 Python 中）的问题，为了调试，我在 OpenCV 源代码中添加了一些打印语句并重新构建了它。有效。

由于 Python 绑定是由 ctypes 制成的，因此如果您更改 C++ 代码并构建它，它将在 Python 中工作。

因此，如果您了解 C++，并且知道您想要更改什么，那么您可以自己完成。

# system.reactive - Rx 去抖动输入

> ID：15535986
> 
> 赞同：0
> 
> 时间：2013-03-20T22:26:03.850
> 
> 标签：system.reactive, debouncing

我需要去抖动输入流。

在第一次出现状态 1 时，我需要等待 5 秒并验证最后状态是否也是 1。只有我有一个稳定的信号。

```
(time)  0-1-2-3-4-5-6-7-8-9
(state) 0-0-0-0-0-1-0-1-0-1
(result)                   -> 1 
```

这是一个不稳定信号的例子。

```
(time)  0-1-2-3-4-5-6-7-8-9
(state) 0-0-0-0-0-1-0-1-0-0
(result)                   -> 0 
```

我尝试使用缓冲区，但缓冲区的起点是固定的，我需要从第一个事件开始等待 5 秒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-22T17:47:46.797

从字面上理解您的要求

> 在第一次出现状态 1 时，我需要等待 5 秒并验证最后状态是否也是 1。只有我有一个稳定的信号。

我可以想出一些方法来解决这个问题。为了澄清我的假设，您只想在第一次出现 1 后 5 秒推送最后一个值。这将导致单个值序列产生 0 或 1（即，无论产生超过 5 的任何其他值距离源序列的秒数）

在这里，我用一些 jiggery-pokery 重新创建了你的序列。

```
var source = Observable.Timer(TimeSpan.Zero,TimeSpan.FromSeconds(1))
    .Take(10)
    .Select(i=>{if(i==5 || i==7 || i==9){return 1;}else{return 0;}}); //Should produce 1;
    //.Select(i=>{if(i==5 || i==7 ){return 1;}else{return 0;}});    //Should produce 0; 
```

下面的所有选项看起来都共享顺序。为了在 Rx 中安全地共享一个序列，我们 Publish() 并连接它。我通过 RefCount() 运算符使用自动连接。

```
var sharedSource = source.Publish().RefCount(); 
```

1) 在这个解决方案中，我们取第一个值 1，然后将选定的序列值缓冲到 5 秒的缓冲区大小。我们只取第一个缓冲区。一旦我们得到这个缓冲区，我们就会得到最后一个值并推送它。如果缓冲区为空，我假设我们推入一个，因为最后一个值是启动缓冲区运行的“1”。

```
sharedSource.Where(state=>state==1)
            .Take(1)
            .SelectMany(_=>sharedSource.Buffer(TimeSpan.FromSeconds(5)).Take(1))
            .Select(buffer=>
            {   
                if(buffer.Any())
                {
                    return buffer.Last();
                }
                else{
                    return 1;
                }
            })
            .Dump(); 
```

2) 在这个解决方案中，我采取的方法是，只有在我们获得有效值 (1) 后才开始侦听，然后获取所有值，直到计时器触发终止。从这里我们取最后一个产生的值。

```
var fromFirstValid = sharedSource.SkipWhile(state=>state==0);
fromFirstValid 
    .TakeUntil(
        fromFirstValid.Take(1)
                    .SelectMany(_=>Observable.Timer(TimeSpan.FromSeconds(5))))
    .TakeLast(1)
    .Dump(); 
```

3）在这个解决方案中，我使用窗口运算符创建一个窗口，当第一个值 '1' 发生时打开，然后在 5 秒后关闭。同样，我们只取最后一个值

```
sharedSource.Window(
                sharedSource.Where(state=>state==1),
                _=>Observable.Timer(TimeSpan.FromSeconds(5)))
            .SelectMany(window=>window.TakeLast(1))
            .Take(1)
            .Dump(); 
```

给猫剥皮的方法有很多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T00:27:24.003

听起来（一目了然）像您想要的那样`Throttle`，而不是`Buffer`，尽管有关您的用例的更多信息将有助于确定这一点 - 无论如何，这就是您`Throttle`的流式传输方式：

```
void Main()
{
    var subject = new Subject<int>();
    var source = subject.Publish().RefCount();

    var query = source
        // Start counting on a 1, wait 5 seconds, and take the last value
        .Throttle(x => Observable.Timer(TimeSpan.FromSeconds(5)));

    using(query.Subscribe(Console.WriteLine))
    {
        // This sequence should produce a one
        subject.OnNext(1);
        subject.OnNext(0);
        subject.OnNext(1);
        subject.OnNext(0);
        subject.OnNext(1);
        subject.OnNext(1);
        Console.ReadLine();
        // This sequence should produce a zero
        subject.OnNext(0);
        subject.OnNext(0);
        subject.OnNext(0);
        subject.OnNext(0);
        subject.OnNext(1);
        subject.OnNext(0);
        Console.ReadLine();
    }
} 
```

# android - httpclient.execute(httpget) 之后的 Android 代码没有在 try 中运行（使用 AsyncTask）

> ID：15535988
> 
> 赞同：3
> 
> 时间：2013-03-20T22:26:06.333
> 
> 标签：android, android-asynctask, httpclient

我正在尝试从网站获取数据并将其解析到我的 android 应用程序中。不幸的是，我什至没有进入解析数据的部分。在以下行之后代码不会运行：

```
HttpResponse response = httpclient.execute(httpget); 
```

结果是 message = 333。当我使用 eclipse 调试器跳过它时，我可以看到它运行了该行。然后我可以读出响应变量（= 200），但之后的行不执行。它没有到达函数中的 444 或其他代码。我已经在 Android 清单中声明了互联网权限。

编码：

```
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import org.apache.http.HttpResponse;
import org.apache.http.StatusLine;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import android.os.AsyncTask;
import android.widget.TextView;

public class MainActivity extends Activity {

TextView message;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    message = (TextView)findViewById(R.id.message);

    message.setText("111");
    //new getinternetData .execute("");

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
}

@Override
protected void onStart(){
    super.onStart();
    new getinternetData().execute("");
    //message.setText("OnStart");
}

private class getinternetData extends AsyncTask<String, Void, String>{

    @Override
    protected String doInBackground(String... params) {
        HttpClient httpclient = new DefaultHttpClient();
        HttpGet httpget = new HttpGet("http://www.google.com");
        try{
            message.setText("333");
            HttpResponse response = httpclient.execute(httpget);
            message.setText("444");
            StatusLine statusLine = response.getStatusLine();
            int statusCode = statusLine.getStatusCode();
            if(statusCode == 200){
                message.setText("Could connect");
            }else
                message.setText("Couldn't connect");
        }catch(Exception e){
            message.setText(e.toString());
        }

        message.setText("555");
        return null;
    }

    @Override
    protected void onPostExecute(String result) {
        //message.setText("Postsequence");
    }   
} 
```

我不知道我做错了什么。
是因为我没有正确使用 AsyncTask 吗？
或者可能没有正确使用 httpclient.execute？

编辑：感谢您的帮助，我已将消息更改为 log.d，现在我可以看到我可以连接。故障在于更新屏幕等。我有很多东西要学。

这是我更改的代码部分：

```
 private static final String TAG = "MainActivity";

    @Override
    protected String doInBackground(String... params) {
        HttpClient httpclient = new DefaultHttpClient();
        HttpGet httpget = new HttpGet("http://www.google.com");
        try{
            //message.setText("333");
            Log.d(TAG, "Before httpResponse");
            HttpResponse response = httpclient.execute(httpget);
            Log.d(TAG, "After httpResponse");
            StatusLine statusLine = response.getStatusLine();
            int statusCode = statusLine.getStatusCode();
            Log.d(TAG, "after statusCode, code= " +statusCode);
            if(statusCode == 200){
                Log.d(TAG, "Could connect");
            }else{
                Log.d(TAG, "Couldn't connect");
            }
        }catch(Exception e){
            Log.d(TAG, e.toString());
        }
        Log.d(TAG, "Exit do in background");
        return null; 
```

日志猫结果：

```
 : D/MainActivity(22323): Before httpResponse
 bunch of code
 : D/MainActivity(22323): After httpResponse
 : D/MainActivity(22323): after statusCode, code= 200
 : D/MainActivity(22323): Could connect
 : D/MainActivity(22323): Exit do in background 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:48:51.657

您遇到的一个问题是您试图从后台线程更新屏幕（消息）。使用 AsyncTask.publishProgress(...) 让主线程在其 onProgressUpdate() 方法中更新 GUI。

另外，不要更新屏幕，而是考虑编写日志消息 Log.d(TAG, "You Are Here.); 并在 logcat 中观察它们。

这并没有解决 HTTP 问题，但首先清除它以确保您不会通过在后台线程中更改屏幕而导致挂起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:08:04.017

就像 Dale Wilson 所说，你不能在 doInBackground 方法中更新 UI。更喜欢 onPreExecute 和 onPostExecute 方法。

您还可以使用 doInBackground 的结果更新您的消息 TextView ，如下所示：

```
private class getinternetData extends AsyncTask<String, Void, String>{

    @Override
    protected String doInBackground(String... params) {
        HttpClient httpclient = new DefaultHttpClient();
        HttpGet httpget = new HttpGet("http://www.google.com");
        try{
            //message.setText("333");
            HttpResponse response = httpclient.execute(httpget);
            //message.setText("444");
            StatusLine statusLine = response.getStatusLine();
            int statusCode = statusLine.getStatusCode();
            if(statusCode == 200){
                return "Could connect";
            }else
                return "Couldn't connect";
        }catch(Exception e){
            return e.toString();
        }

        return null;
    }

    @Override
    protected void onPostExecute(String result) {
        if (result != null)
            message.setText(result);
    }   
} 
```