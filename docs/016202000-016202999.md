# StackOverflow 问答 16202000-16202999

# zeromq - 了解 ZMQ - 用于多线程的 PAIR Sockets

> ID：16202003
> 
> 赞同：2
> 
> 时间：2013-04-24T20:55:43.000
> 
> 标签：zeromq

请参阅[http://hintjens.wdfiles.com/local--files/main:files/cc1pe.pdf](http://hintjens.wdfiles.com/local--files/main:files/cc1pe.pdf) 第 67 页。

问题> 我不明白为什么下面的代码对多线程有好处。根据我的理解，主线程在等待子线程的反馈时可以做不同的事情。

但是，在下面的代码中，似乎step2在调用时被阻塞，`char *string = s_recv (receiver);`而step3在调用时被阻塞`char *string = s_recv (receiver);`

根据我的理解，(step_i+1) 可以自由地做一些事情，直到从 step_i 收到信号。但是，正如您所看到的代码，step2 和 step3 都被阻止并且无法执行任何操作。为什么这是一个多线程代码？

谢谢

```
//  Multithreaded relay

#include "zhelpers.h"
#include <pthread.h>

static void *
step1 (void *context) {
    //  Connect to step2 and tell it we're ready
    void *xmitter = zmq_socket (context, ZMQ_PAIR);
    zmq_connect (xmitter, "inproc://step2");
    printf ("Step 1 ready, signaling step 2\n");
    s_send (xmitter, "READY");
    zmq_close (xmitter);

    return NULL;
}

static void *
step2 (void *context) {
    //  Bind inproc socket before starting step1
    void *receiver = zmq_socket (context, ZMQ_PAIR);
    zmq_bind (receiver, "inproc://step2");
    pthread_t thread;
    pthread_create (&thread, NULL, step1, context);

    //  Wait for signal and pass it on
    char *string = s_recv (receiver);
    free (string);
    zmq_close (receiver);

    //  Connect to step3 and tell it we're ready
    void *xmitter = zmq_socket (context, ZMQ_PAIR);
    zmq_connect (xmitter, "inproc://step3");
    printf ("Step 2 ready, signaling step 3\n");
    s_send (xmitter, "READY");
    zmq_close (xmitter);

    return NULL;
}

int main (void)
{
    void *context = zmq_ctx_new ();

    //  Bind inproc socket before starting step2
    void *receiver = zmq_socket (context, ZMQ_PAIR);
    zmq_bind (receiver, "inproc://step3");
    pthread_t thread;
    pthread_create (&thread, NULL, step2, context);

    //  Wait for signal
    char *string = s_recv (receiver);
    free (string);
    zmq_close (receiver);

    printf ("Test successful!\n");
    zmq_ctx_destroy (context);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:32:06.387

按照我的阅读方式，示例代码只显示了如何让主线程（step3）知道其他两个线程已经创建并正确连接。来自第 1 步的信号通过第 2 步到第 3 步，因此一旦到达，所有信号都已设置好并准备就绪。这应该很快发生。

线程完成后，您可以传递一条新消息，而不是加入它们，而是传递一条新消息`DONE`。步骤 1 完成后发送此消息。其他步骤一旦完成就开始等待此消息，当它收到一个消息时，将其传递到下一步。当step3收到`DONE`消息时，所有线程都完成了。

或者您可以使用此类消息来累积每个线程的工作结果。

您无需等待对象，而是开始同步接收消息。您发送消息而不是通知。

所以如果我理解正确的话，多线程工作应该发生在这些同步消息之间。

* * *

编辑

> 似乎step2在调用时被阻止了`s_recv`

在这个例子中这很好，因为 step2 除了等待`READY`消息之外没有任何用处。如果在您的用例中，线程必须工作并定期检查它是否有消息在等待它，它可以`zmq_recv`使用标志以非阻塞模式调用`ZMQ_DONTWAIT`，以检查消息是否已经到达。

# php - 在没有 PDO 的情况下使用 PHP for SQL Server 防止 SQL 注入

> ID：16202006
> 
> 赞同：5
> 
> 时间：2013-04-24T20:55:53.607
> 
> 标签：php, sql-server, sql-injection

我可以尽可能多地清理和验证我的输入，但这绝对不能涵盖所有内容，如果我足够用力、足够彻底地擦洗，我将彻底清除我的输入。

**我意识到有很多关于这个主题的帖子，但似乎他们总是回到 PDO 或 Mysql（是的 - 即使有人发布关于 SQL Server 的帖子，他们收到的答案中有一半建议 mysql_real_escape_string - 疯狂的世界）。** 我也不能用。即使在我打字并且屏幕右侧出现“类似问题”的小问题时，我仍不断点击各种链接，但没有任何内容能完全回答我的问题。

我正在使用 SQL Server。我正在使用 PHP 5.2.4。我不能使用 PDO（因为......？我的老板说“不”，这就是足够的理由）。

有没有办法我可以编写一种安全的方法来准备我自己的查询语句？

过去，我曾尝试在 PHP 中构建这样的语句。（其中 $input_* 变量是某种形式的用户输入，或者我将它们从某些东西中拉出来）

```
$query = "
    declare @varID  int
    declare @var1   int
    declare @var2   varchar(100) 

    set @varID = cast('$input_ID' as int)
    set @var1  = cast('$input_var1' as int)
    set @var2  = cast('$input_var2' as varchar(100)) 

    update table_name_goes_here
         set var1 = @var1,  
             var2 = @var2
         where ID = @varID;
    ";
 # $query is then executed 
```

但这也很容易受到攻击......显然......我做的最后一件事是删除所有必要的标点符号（有时我知道他们没有理由使用某些字符）

但必须有一些其他的选择......对吧？并且`mssql_bind`仅适用于存储过程，这是一个明确的选择，但我不确定我是否想自愿扩展我的职责，通过制作插入/更新过程来包括在实际数据库中的维护。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:31:06.457

我会说“因为老板说'不'”是一个可怕的理由。告诉他（她？）他错了。我对 PHP 知之甚少，但不管是哪种语言，防止注入的唯一万无一失的方法是通过参数化查询或存储过程。如果在 PHP 中这样做的唯一方法是使用 PDO，那么请使用 PDO。

这是您使用 PDO 的理由：[https ://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet](https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet)

[http://msdn.microsoft.com/en-us/magazine/cc163917.aspx](http://msdn.microsoft.com/en-us/magazine/cc163917.aspx)

为什么代码中有任何 SQL？如果在数据库中，维护起来会容易很多，一般是存储过程的形式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T23:28:50.020

您还没有回答“如果不允许 PDO，您打算如何与 MS SQL 数据库通信”的问题，但我假设有 mssql_* 函数可以使用。

这些没有现成的转义功能，但似乎它们为您提供了使用准备好的语句 - 这将完成这项工作。

否则，您将拥有与安全相关的任务来自己创建转义函数。当您第一次看到它时，字符替换并不是很复杂，您可能很幸运只需要使用定义的编码来覆盖您的确切用例。所以这可能真的就像在 MSSQL 手册中查找字符串中的哪些字符不允许作为简单字符一样简单，以及如何转义它们。

请注意，您可能会错过边缘情况，如果可以避免，我宁愿使用准备好的语句功能。

更新：我误读了手册，mssql_execute() 只调用存储过程，而不是准备好的语句。你不能存储过程吗？将是一个简单的出路。但我想知道无论如何你应该如何与数据库交谈。

Update2：我在 php.net 的评论中找到了一个链接，用于 mssql_bind 指向关于转义的 SO 答案：[如何使用 PHP 在 SQL Server 中转义字符串？](https://stackoverflow.com/questions/574805/how-to-escape-strings-in-sql-server-using-php)

# mysql - 在 LIMIT 更改时从 MySQL 查询中获取不一致的排序结果

> ID：16202007
> 
> 赞同：2
> 
> 时间：2013-04-24T20:55:57.717
> 
> 标签：mysql, sql, pagination, codeigniter-2

当我增加页面（例如 LIMIT 3,3 到 LIMIT 4,3）时，我的查询（以下两者）返回不一致的排序结果。请参阅下面的示例图像，并注意我有两个新项目，尽管仅将 FROM 索引更改了 1。

最糟糕的是，我无法始终如一地生成任何特定的排序顺序，除了第一组：LIMIT 0, 6。然后 LIMIT 6,6 和其他变体返回截然不同的结果。例如，如果我更改 WANT 值，我可以获得一组完全不同的项目。

**示例：** [http ://trackauthoritymusic.com/wwwroot/images/pagination-error-proof.jpg](http://trackauthoritymusic.com/wwwroot/images/pagination-error-proof.jpg)

**环境：**

*   回声 mysql_get_server_info(); // 5.1.67-日志
*   回声 PHP_VERSION; // 5.4.14
*   character_set_client == utf8
*   character_set_connection == utf8
*   character_set_database == utf8
*   character_set_filesystem == 二进制
*   character_set_results == utf8
*   character_set_server == latin1
*   character_set_system == utf8
*   collat​​ion_connection == utf8_unicode_ci
*   collat​​ion_database == utf8_unicode_ci
*   collat​​ion_server == latin1_swedish_ci
*   我正在使用 codeigniter，但我使用的是下面看到的标准 sql。
*   在共享主机包上

**查询：**

```
SELECT S.*, G.* FROM games C LEFT JOIN songs T ON G.game_id = S.game_id WHERE G.game_status != 'deleted' and G.game_status != 'hidden' AND G.group_id = 1 GROUP BY G.game_id ORDER BY ISNULL(G.game_uploading_starts), G.game_listening_starts desc LIMIT 4, 3

SELECT S.*, G.* FROM games C LEFT JOIN songs T ON G.game_id = S.game_id WHERE G.game_status != 'deleted' and G.game_status != 'hidden' AND G.group_id = 1 GROUP BY G.game_id ORDER BY (CASE WHEN G.game_uploading_starts IS NULL then 1 ELSE 0 END), G.game_listening_starts desc LIMIT 4, 3 
```

这两个查询都会产生不一致的排序结果，而不是两者之间的简单不同集合。

**查询表架构：**

```
DROP TABLE IF EXISTS `games`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `games` (
  `game_id` mediumint(6) NOT NULL AUTO_INCREMENT,
  `group_id` mediumint(6) NOT NULL,
  `game_status` enum('playlist','game','compilation','halloffame','theme','deleted','hidden') COLLATE utf8_unicode_ci NOT NULL DEFAULT 'hidden' COMMENT 'except deleted, this is not maintained at runtime, but on a cron job',
  `game_title` varchar(100) COLLATE utf8_unicode_ci NOT NULL,
  `game_image` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,
  `game_author_id` mediumint(6) NOT NULL,
  `game_ta_id` mediumint(6) DEFAULT NULL,
  `game_winner_id` mediumint(6) DEFAULT NULL,
  `song_id` mediumint(6) DEFAULT NULL COMMENT 'either first example or 1st place song if awarded already',
  `game_buyin` int(11) DEFAULT NULL,
  `game_minpool` int(11) DEFAULT NULL,
  `game_rating_avg` tinyint(3) DEFAULT NULL,
  `game_songs_per_user` tinyint(2) NOT NULL DEFAULT '1',
  `game_uploading_starts` int(10) DEFAULT NULL,
  `game_listening_starts` int(10) DEFAULT NULL,
  `game_rating_starts` int(10) DEFAULT NULL,
  `game_awarding_starts` int(10) DEFAULT NULL,
  `game_uploading_ends` int(10) DEFAULT NULL,
  `game_awarding_complete` int(10) DEFAULT NULL,
  `game_created` int(10) NOT NULL,
  `game_summary` varchar(2000) COLLATE utf8_unicode_ci DEFAULT NULL,
  PRIMARY KEY (`game_id`),
  KEY `game_status` (`game_status`,`song_id`)
) ENGINE=MyISAM AUTO_INCREMENT=37 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

DROP TABLE IF EXISTS `songs`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `songs` (
  `song_id` mediumint(6) NOT NULL AUTO_INCREMENT,
  `game_id` mediumint(6) NOT NULL,
  `group_id` tinyint(3) NOT NULL,
  `user_id` mediumint(6) NOT NULL,
  `user_vendor_id` tinyint(1) DEFAULT NULL,
  `receipt_id` mediumint(6) DEFAULT NULL,
  `song_status` enum('example','game','playlist','compilation','deleted','winner') COLLATE utf8_unicode_ci NOT NULL DEFAULT 'example',
  `song_title` varchar(255) COLLATE utf8_unicode_ci NOT NULL,
  `song_artist` varchar(50) COLLATE utf8_unicode_ci NOT NULL,
  `song_album` varchar(100) COLLATE utf8_unicode_ci DEFAULT NULL,
  `song_released` smallint(4) DEFAULT NULL,
  `song_genre` varchar(50) COLLATE utf8_unicode_ci DEFAULT NULL,
  `song_location` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,
  `song_reason` varchar(2500) COLLATE utf8_unicode_ci DEFAULT NULL,
  `song_image` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,
  `song_rating_avg` smallint(3) NOT NULL DEFAULT '0',
  `song_adjusted_avg` decimal(5,2) NOT NULL DEFAULT '0.00',
  `song_rated_count` mediumint(6) NOT NULL DEFAULT '0',
  `win_rating` smallint(3) DEFAULT NULL,
  `song_timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `song_added` int(11) NOT NULL,
  `song_order` int(4) DEFAULT NULL,
  `song_dedication` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,
  PRIMARY KEY (`song_id`),
  KEY `game_id` (`game_id`),
  KEY `user_id` (`user_id`),
  KEY `song_status` (`song_status`)
) ENGINE=MyISAM AUTO_INCREMENT=305 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T21:02:38.073

我认为问题是您有多个具有相同值的行`G.game_listening_starts`。这些行可以按任何顺序返回，从一种到下一种。

你想要的是一个*稳定*的排序。一种顺序不变的。要获得稳定的排序，您需要对每一行进行唯一标识。我可能会建议：

```
ORDER BY ISNULL(G.game_uploading_starts), G.game_listening_starts desc, game_id 
```

这保证是唯一的，因为`group by`.

我碰巧认为[SQL Server 文档](http://msdn.microsoft.com/en-us/library/ms188385.aspx)在解释稳定排序方面做得最好：

> 要在使用 OFFSET 和 FETCH 的查询请求之间获得稳定的结果，必须满足以下条件：
> 
> 查询使用的基础数据不得更改。也就是说，查询涉及的行没有更新，或者查询中的所有页面请求都在使用快照或可序列化事务隔离的单个事务中执行。有关这些事务隔离级别的详细信息，请参阅 SET TRANSACTION ISOLATION LEVEL (Transact-SQL)。
> 
> ORDER BY 子句包含保证唯一的列或列组合。

我意识到您正在使用 MySQL，但同样的想法也适用。

# ms-access - 访问交叉表小计列

> ID：16202008
> 
> 赞同：1
> 
> 时间：2013-04-24T20:55:58.797
> 
> 标签：ms-access, crosstab

关于 Access 中的交叉表，我有以下问题：如何创建小计列？

作为查询的结果，我想看到的是：

```
 Nov 2010     Dec 2010     2010 Total     Jan 2011    Feb 2011 
Row1             2            4             17            3           2
Row2             8            6             35            7           5 
```

如何为年度创建这些小计？（没关系，如果年份数据将在所有月份之后结束）问题是我需要每年都这样做而不需要硬编码，查询应该适用于任何数据集

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T09:06:54.233

假设我们有原始 [SalesData]

```
SalesYear   SalesMonth  Region  SalesTotal
---------   ----------  ------  ----------
2010        11          East    45
2010        11          West    58
2010        12          East    55
2010        12          West    63
2011        1           East    51
2011        1           West    54
2011        2           East    55
2011        2           West    61 
```

我们可以创建一个 [SalesTotals] 查询来将月销售总额与年度总额相结合......

```
SELECT SalesYear & "-" & Format(SalesMonth, "00") AS SalesPeriod, Region, SalesTotal FROM SalesData
UNION ALL
SELECT SalesYear & "-Total", Region, SUM(SalesTotal) FROM SalesData GROUP BY SalesYear, Region; 
```

...产生

```
SalesPeriod Region  SalesTotal
----------- ------  ----------
2010-11     East    45
2010-11     West    58
2010-12     East    55
2010-12     West    63
2011-01     East    51
2011-01     West    54
2011-02     East    55
2011-02     West    61
2010-Total  East    100
2010-Total  West    121
2011-Total  East    106
2011-Total  West    115 
```

然后我们可以对 [SalesTotals] 查询进行交叉表查询...

```
TRANSFORM Sum(SalesTotals.[SalesTotal]) AS SumOfSalesTotal
SELECT SalesTotals.[Region]
FROM SalesTotals
GROUP BY SalesTotals.[Region]
PIVOT SalesTotals.[SalesPeriod]; 
```

...产生

```
Region  2010-11 2010-12 2010-Total  2011-01  2011-02  2011-Total
------  ------- ------- ----------  -------  -------  ----------
East    45      55      100         51       55       106
West    58      63      121         54       61       115 
```

# php - var_dump - 如何从转储 PHP 中获取特定值

> ID：16202021
> 
> 赞同：0
> 
> 时间：2013-04-24T20:56:36.087
> 
> 标签：php, arrays, api, var-dump

我知道有很多关于 PHP 的可用信息 - var_dump 我的问题是我是否需要从我从返回不同数组对象的 API 接收的转储中选择特定信息....例如下面的转储我需要 characterData 数组下的领域信息我如何选择该信息并存储在 String 变量中。解释我的问题的 php 代码的简短示例将不胜感激......

```
 object(Character)[3]
   private 'name' => string 'XXXX' (length=6)
   private 'region' => string 'eu' (length=2)
   private 'realm' => string 'Defias Brotherhood' (length=18)
   private 'characterData' => 
   array (size=24)
  'lastModified' => float 1363345999000
  'name' => string 'Growar' (length=6)
  'realm' => string 'Defias Brotherhood' (length=18)
  'battlegroup' => string 'Rampage / Saccage' (length=17) 
```

基本上这些信息来自 Battlegroup api

```
 $armory = new BattlenetArmory('EU','Defias Brotherhood');
$armory->setLocale('ru_RU');

    // To reset back to default server locale
    $armory->setLocale(FALSE);
    //initialize the character to get the character object
    $character = $armory->getCharacter('XXXX'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:08:40.847

如果您没有该 field 的吸气剂，则`characterData`您将无法访问它，因为它是私有财产，除非您使用[`Reflection`](http://php.net/ReflectionClass)：

```
$ref = new ReflectionClass( 'Character');
$prop = $ref->getProperty( 'characterData');
$prop->setAccessible( true);
$array = $prop->getValue( $yourCharacterObject);
echo $array['realm']; 
```

这可以用一个模仿 OP 的简单类来测试：

```
class Character {
    private $characterData;

    public function __construct() {
        $this->characterData['realm'] = 'Defias Brotherhood';
    }
} 
```

目前，其他人提出了这个解决方案：

```
$yourCharacterObject = new Character();
// echo $yourCharacterObject->characterData['realm']; 
```

结果是：

> 致命错误：无法访问第 11 行 X 中的私有属性 Character::$characterData

但是，Reflection 将能够获取私有值并正确显示它，如[本演示](http://viper-7.com/txJDuY)所示，它使用上述类和代码打印所需的属性值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:03:19.503

`Character`是您从中创建实例的类 - 例如：

```
$c = new Character(); 
```

因为`characterData`是私人的，你不能通过它访问它`$c->characterData`

您需要使用一些公共访问功能（例如`getCharacterData`），或者如果您可以访问对象内部，只需根据您的需要进行更改

# sbt - 在 sbt 中运行外部 shell 命令的方法

> ID：16202024
> 
> 赞同：7
> 
> 时间：2013-04-24T20:56:47.877
> 
> 标签：sbt

在交互式 shell 中如何运行外部 shell 命令`sbt`？

也就是说，在我输入`sbt`并看到提示出现后，我该怎么做`ls`，`cd`等等？应该有办法做到这一点，对吗？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T05:41:03.457

在[http://www.scala-sbt.org/release/docs/Community/Community-Plugins.html](http://www.scala-sbt.org/release/docs/Community/Community-Plugins.html)上有一个 SBT 插件列表。

用于您目的的插件可以是[https://github.com/steppenwells/sbt-sh](https://github.com/steppenwells/sbt-sh)。

# constraints - Excel Solver：作为绝对值的决策变量

> ID：16202025
> 
> 赞同：0
> 
> 时间：2013-04-24T20:56:57.573
> 
> 标签：constraints, excel-2010, solver

我正在使用 Excel 2010 求解器进行一些优化。一切都运行良好，除了我想运行求解器来找到一个解决方案，使我的决策变量 $A$1:$A$10 介于 5.1 和 15.3 之间或介于 -5.1 和 -15.3 之间。我尝试了多种方法，但无法弄清楚如何设置约束。正面部分还可以，

```
 $A$1:$A$10 >= 5.1
 $A$1:$A$10 <= 15.3 
```

这是我遇到困难的负范围。我努力了

```
 -$A$1:$A$10 >= 5.1
 -$A$1:$A$10 <= 15.3 
```

乃至

```
 ABS($A$1:$A$10) >= 5.1
 ABS($A$1:$A$10) <= 15.3 
```

但它不起作用。我在网上搜索过，但似乎找不到任何帮助。这可能吗，如果可以，我该怎么做？任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-27T12:16:06.040

假设您希望决策变量`X`介于`5.1`和`15.3`或介于`-5.1`和之间`-15.3`。用两个新的决策变量替换决策变量`XP`，`XN`其中`XP`是 的正值`X`，`XN`是负值，`X = XP – XN`。然后添加两个约束：

```
XP + XN >= 5.1
XP + XN <= 15.3 
```

# c# - 如何更改面板中的线条图大小？

> ID：16202026
> 
> 赞同：1
> 
> 时间：2013-04-24T20:56:58.223
> 
> 标签：c#, winforms, visual-studio, panel

我正在使用此代码使用鼠标指针在 WinForm 中的面板上绘图。

```
public partial class Signature : Form
{
    SolidBrush color;
    List<List<Point>> _lines;
    Boolean _mouseDown;

    public Signature()
    {
        InitializeComponent();
        _lines = new List<List<Point>>();
        color = new SolidBrush(Color.Black);
        _mouseDown = false;
    }

    private void clear_Click(object sender, EventArgs e)
    {
        _lines.Clear();
        panel1.Invalidate();
    }

    private void panel1_MouseDown(object sender, MouseEventArgs e)
    {
        _mouseDown = true;
        _lines.Add(new List<Point>());
    }

    private void panel1_MouseMove(object sender, MouseEventArgs e)
    {
        if (_mouseDown)
        {
            _lines.Last().Add(e.Location);
            panel1.Invalidate();

        }
    }

    private void panel1_Paint(object sender, PaintEventArgs e)
    {
        foreach (var lineSet in _lines)
        {
            if (lineSet.Count > 1)
            {
                e.Graphics.DrawLines(new Pen(color), lineSet.ToArray());
            }
        }
    }
    private void panel1_MouseUp(object sender, MouseEventArgs e)
    {
        _mouseDown = false;
    }
} 
```

}

我对编程很陌生，所以如果这是一个愚蠢的问题，请原谅我。我不知道如何使绘制的线条更粗一些。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:00:39.100

而不是`new Pen(color)`你可以使用`new Pen(color, floatWidth)`

示例可以在[这里找到](http://msdn.microsoft.com/en-gb/library/y7858dt5.aspx)

# angularjs - angularjs指令中的iScroll

> ID：16202028
> 
> 赞同：3
> 
> 时间：2013-04-24T20:57:05.163
> 
> 标签：angularjs, overflow, undefined, angularjs-directive, iscroll

我正在尝试使用 angular 指令实现水平 iScroll。

这是我的指令代码。

```
link: function(scope, elem, attrs) {
        scope.winWidth = window.innerWidth;
        scope.iScrollWidth = scope.winWidth *8.5 +'px';
        jQuery(angular.element(attrs.thelist)).css({'width':scope.iScrollWidth}); 

        var k_videoScroll = new iScroll(angular.element(attrs.scrollwrap),{
            snap: true,
            bounce: false,
            checkDOMChanges: false,
            momentum: false,
            hScrollbar: false,
            vScrollbar: false,
            overflow: false
        }); 
```

我的 html 页面中有一个 div 标记，其 id 与 attrs.scrollwrap 相关

```
<div id="videolist" class="videoScrollWrap" options="#thelist" wrapper="#deal-wrap"   scrollwrap="#videoReviewsWrap">    
   <div id="videoReviewsWrap">
      <ul id="thelist">
         <li id='deal-wrap' ng-repeat="video in videoList" videoList='video'></li>
      </ul>
    </div>
</div> 
```

我遇到的问题是'无法设置未定义的属性'溢出''。

```
TypeError: Cannot set property 'overflow' of undefined
at Object.iScroll (http://localhost/swordfish/web/js/lib/iscroll.js:89:31)
at setScroll (http://localhost/swordfish/web/js/directives/d-product-details.js:395:33)
at link (http://localhost/swordfish/web/js/directives/d-product-details.js:405:13)
at o (http://localhost/swordfish/web/js/lib/angular/angular.min.js:42:187)
at e (http://localhost/swordfish/web/js/lib/angular/angular.min.js:38:28)
at http://localhost/swordfish/web/js/lib/angular/angular.min.js:37:118
at <error: illegal access>
at Object.e.$broadcast (http://localhost/swordfish/web/js/lib/angular/angular.min.js:88:517)
at http://localhost/swordfish/web/js/lib/angular/angular.min.js:81:85
at i (http://localhost/swordfish/web/js/lib/angular/angular.min.js:76:207) <div id="videolist" class="videoScrollWrap ng-isolate-scope ng-scope" options="#thelist" wrapper="#deal-wrap" scrollwrap="#videoReviewsWrap"> angular.min.js:60 
```

（匿名函数）

可能是什么问题？似乎定义新 iScroll 的语法不正确。这样做的正确方法是什么？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T14:41:13.730

我弄清楚了这个问题。这是因为当我尝试获取 (attrs.scrollwrap) 它实际上是在重新调整对象。但是 iScroll 库试图直接获取对象的子元素，并设置该对象的样式属性。一旦我尝试使用 (attrs.scrollwrap[0]) 访问 div 元素，问题就解决了。

# iphone - 有没有办法捕捉或处理 EXC_BAD_ACCESS？

> ID：16202029
> 
> 赞同：24
> 
> 时间：2013-04-24T20:57:11.270
> 
> 标签：iphone, ios, objective-c, exc-bad-access

据我了解，当您尝试访问坏内存时会发生 EXC_BAD_ACCESS （如果我错了，请随时纠正我）？

有没有办法像在`try-catch`in 中那样捕捉它`Java`以防止应用程序完全失败？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-24T20:59:32.737

没有; `EXC_BAD_ACCESS`意味着事情已经严重脱轨。您的程序正在尝试访问无效的内存地址。即内存已损坏，并且没有可预测的恢复。

这可能是内存管理问题。如果您可以重现该问题，请打开 NSZombies 并查看会发生什么。或在此处发布回溯。

请注意，在 iOS/Cocoa 中，try-catch 样式的异常也是不可恢复的。异常不能用于可恢复的错误处理。这就是 NSError 的用途。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-03-15T09:32:19.470

新的 C 库[SignalRecovery](https://github.com/dhatbj/SignalRecovery)可以使程序能够从操作系统异常中恢复，例如`EXC_BAD_ACCESS`. 它可以用于`IOS/MacOS/Linux`.

示例代码：

```
signal_try(label) {
    // Add your code need try.
    int* ptr = NULL;
    *ptr = 0;
}
signal_catch(label) {
    // Add your code to process exceptions, or do nothing.
    siginfo_t* info = signal_info();
}
signal_end(label)
// Continue run 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-24T20:59:30.127

可以使用 try catch，但您首先需要知道导致问题的原因。您可以为当前构建启用 NSZombie 以捕获错误并消除需要。编辑当前方案，启用 NSZombie。

*   更新 * Swift2+ 现在具有出色的错误处理能力，绝对值得一试。 [快速错误处理](https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/ErrorHandling.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-24T22:04:34.573

*有时*您可以`main`使用信号处理程序将其捕获。但是，除了记录一些东西之外，它不允许您做太多事情。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-10-27T08:31:10.150

如果您想通过关闭捕获或处理崩溃，您可以使用[https://github.com/dhatbj/SignalRecovery](https://github.com/dhatbj/SignalRecovery)

C 代码 func 宏在 swift 中不可用，您不能直接调用函数（signal_try、signal_catch、signal_end） 下面是一个如何将闭包作为函数参数传递的示例。

首先，我们需要将完成块传递给 C 代码并返回信号错误。

将此代码添加到 signal_recovery.h：

```
const char* signalTry(void (*block)(void)); 
```

将此代码添加到 signal_recovery.c：

```
const char* signalTry(void (*block)(void)) {

    const char* signalName = "";

    signal_try(label0) {
        block();
    }
    signal_catch(label0) {
        signalName = signal_name(signal_info()->si_signo);
    }
    signal_end(label0)

    return signalName;
} 
```

在 swift 代码中，您需要调用 C 函数 signalTry 并将闭包作为参数传递给它：

```
import // C files   

class ExceptionsHandler {    

        private static var isReady = false

        init() {
            if !Self.isReady {
                Self.isReady = true
                signal_catch_init()
            }
        }

        private func cFunction(_ block: @escaping @convention(block) () -> Void) -> (@convention(c) () -> Void) {
            return unsafeBitCast(imp_implementationWithBlock(block), to: (@convention(c) () -> Void).self)
        }

        func execute(_ block: @escaping () -> Void) throws {

            let cBlock: @convention(c) () -> Void = cFunction {
                block()
            }

            let error = signalTry(cBlock)

            if let error = error, !String(cString: UnsafePointer<CChar>(error)).isEmpty {
                print("Catched signal \(String(cString: UnsafePointer<CChar>(error)))")
                throw \\ error or exception
            }
        }
    } 
```

当闭包块（）内发生错误 EXC_BAD_ACCESS 时，此 C 函数将跳过它，您将捕获它而不会崩溃。

像这样：

```
try self.exceptionsHandler.execute {
            let a = 3
            let b = 0
            let c = a / b

            // or
            let testArray: [Int] = []
            let number = testArray[100]
        } 
```

# android - 画布旋转时的getbounds

> ID：16202030
> 
> 赞同：2
> 
> 时间：2013-04-24T20:57:13.803
> 
> 标签：android, canvas, rotation

我需要获取画布内图像的边界以检测是否已被触摸，但如果我旋转画布 getbounds() 保持相同的值，如何在画布旋转后获得正确的值？

```
//CODE ON VIEW CLASS:

    canvas.save();  
    canvas.rotate(rotation, Xpos, Ypos);

    secHandImg.setBounds(left,top,right,bottom);    
    secHandImg.setAntiAlias(true);
    secHandImg.draw(canvas);

    circleHandImg.setBounds(left,top,right,bottom); 
    circleHandImg.setAntiAlias(true);
    circleHandImg.draw(canvas);

    canvas.restore();

//CODE ON FRAGMENT CLASS:

        public boolean onTouch(View view, MotionEvent event) {

                Rect imageBounds = MyClass.secHandImg.getBounds();          

                int action = event.getAction();

                final int x = (int)event.getX();
                final int y = (int)event.getY();

                    if(action == MotionEvent.ACTION_DOWN)   {

    if(x >= imageBounds.left && x < (imageBounds.left + imageBounds.width())
    && y >= imageBounds.top && y < (imageBounds.top + imageBounds.height())){

//THIS DON´T WORK IF CANVAS ROTATES 
                imageBoundsTouch = true;

                }

        } 
```

这里有一张图片可以更好地解释我的问题：

[http://s11.postimg.org/z7j0xgwmb/Imagen_2.png](http://s11.postimg.org/z7j0xgwmb/Imagen_2.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:17:37.393

您可以使用三角函数来获取旋转矩形的边界：

```
function BBoxDimensions(width,height,radianAngle){
  var c = Math.abs(Math.cos(radianAngle));
  var s = Math.abs(Math.sin(radianAngle));
  return({  width: height * s + width * c,  height: height * c + width * s });
} 
```

您可以使用 trig 获取旋转边界框的 XY：

```
// where cx/cy is the center of rotation of the target
// and startingX/startingY is the starting xy of the unrotated target

var x1 = startingX - cx;
var y1 = startingY - cy;
newX =cx+ x1*Math.cos(angle) - y1*Math.sin(angle);
newY =cy+ y1*Math.cos(angle) + x1*Math.sin(angle); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:03:39.793

重新计算你的边界值 onOrientationChanged()

# google-maps - 谷歌地图“抱歉，我们没有图像”和 403 禁止错误

> ID：16202032
> 
> 赞同：3
> 
> 时间：2013-04-24T20:57:26.233
> 
> 标签：google-maps, google-maps-api-3

在我咨询过的一家公司，他们的应用程序刚刚开始显示“抱歉，我们没有图像”，而谷歌地图曾经显示的地方。似乎我们并没有因为达到任何限制而被阻止，尽管我不能 100% 确定。我确实看过，似乎他们没有使用 API 密钥，但是，如果我添加一个，没有任何变化。

该应用程序可以在这里查看：http: [//devtp.airtreks.com/HtmlUi](http://devtp.airtreks.com/HtmlUi)

任何有关故障排除的帮助或指导将不胜感激。如果您需要任何进一步的细节，请告诉我。

谢谢你，贾斯汀

[更新] 看来问题可能与位置/接入点有关。我试图通过我的办公室、我的家庭办公室访问它，让一个朋友看它，我的妻子从她的办公室访问，还有一位同事从他们的家里访问。所有的报告都是一样的。

[这是一个屏幕截图的链接](https://www.dropbox.com/s/t9epes8j04b97wz/tp_issue.png)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:21:18.720

我的原始答案已被删除，不知道为什么，但我会试一试。一种可能性是您同时使用 http 和 https 加载文件，有时混合内容会导致此类错误。尝试使用 https 加载 Maps API，这是允许的，或者只是 // 看看这是否有助于解决问题。

# asp.net - 如何获取用户控件内的TextBox（以编程方式添加）的值（在Repeater内呈现的用户控件）

> ID：16202035
> 
> 赞同：0
> 
> 时间：2013-04-24T20:57:27.727
> 
> 标签：asp.net, webusercontrol

通常我们这样做是为了获取用户控件内的文本框的值。

```
<asp:TextBox runat="server" Text="Test" ID="txtTest"/> 
```

在后面的代码中创建一个属性

```
public string MyString
  {  
     get  { return txtTest.Text; }   
  } 
```

在父页面中，我们可以获取用户控件的实例并获取文本框的值，例如

```
foreach (RepeaterItem itm in rptAttribute.Items)
{     
 MyUserControl uc = ((MyUserControlitemUserControl)itm.FindControl("MyContorlName"));
 string  test = uc.MyString;
} 
```

但不确定如果用户控件中的文本框以编程方式创建，如何呈现该值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T08:19:59.570

您可以对文本框采用类似的方法，但声明一个公共方法，该方法将文本框名称作为参数，然后像这样返回它：

在您的 ASCX 中：

```
public TextBox GetDynamicTextBoxByID(string textBoxId)
{
  return (TextBox)Page.FindControl(textBoxId);
} 
```

在您的父页面中：

```
foreach (RepeaterItem itm in rptAttribute.Items)
{     
 MyUserControl uc = ((MyUserControlitemUserControl)itm.FindControl("MyContorlName"));
 string  test = uc.MyString;
 TextBox tx = uc.GetDynamicTextBoxByID(idOfTextBox);
} 
```

不要忘记检查是否返回 null 并进行适当处理。

# c# - 类文件存放在哪里？

> ID：16202038
> 
> 赞同：-1
> 
> 时间：2013-04-24T20:57:38.633
> 
> 标签：c#, conventions

我通常为我的项目创建一个单独的类库，然后将其分解为文件夹

```
Services
 -all my .cs files that are service(business logic)

Data
 - Mapping 
   - nhibernate mapping files

Domain
  - domain files 
```

我还创建了其他文件夹，例如我正在用foursquare做一些事情，所以对于所有`class files`它都在一个名为的文件夹中`"foursquare"`

但我不知道该放在哪里`one off class files`。例如，我有`"HtmlWhiteList" class`唯一的白名单。

我认为它不应该有自己的文件夹，因为它只是一个文件，但同时我不喜欢把它放在根目录中。

有什么建议将不值得拥有自己的文件夹的类文件放在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:03:36.270

有时我创建了一个包含其他东西的“实用程序”文件夹。事情通常会去那里，然后一旦他们有其他类似的类就迁移到其他地方......但有时他们会留在那里。当然，这对个人喜好非常主观。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T22:17:05.600

作为一般的经验法则，我将新的类文件放在另一个调用它的类的根目录中。如果我得到 5 个或更多类似的课程，我将创建一个文件夹并将它们放在同一级别的文件夹中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-26T10:04:35.263

如果你不知道它做什么或谁使用它，因此你不知道把它放在哪里，或者它所做的事情是微不足道的，所以它不值得占有一席之地，那么将它完全删除。

如果您不认为它被视为已删除，那么它应该占有一席之地。

如果它很少使用，那么您应该确切地知道谁在使用它以及它对他们有什么影响 - 然后您应该立即知道将它放在哪里：靠近他们的某个地方。

如果没有这样的地方，那就创造它并与之共存。随着项目的发展，当一个更好的地方成为现实时，你总是可以把它移到那里。查看您的项目结构，如果它是真正的实用程序，那么 Service 不是用于“BusinessLogic”，而是用于服务和实用程序。如果您将您的 BL 建模为“服务”，那么这是您的选择，但这并不意味着所有服务都是 BL。

如果这个类有很多分散的用户，以至于你无法确定谁更重要或更相关，那么将它创建为一个新的模块/库/文件夹，因为它被大量使用并且实际上很重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-26T10:01:33.467

我们停止使用这种结构。它最终拥有像“enums”、“interfaces”、“entities”这样的文件夹。当你为一个特性编写代码时，比如说特性“订单”，你需要所有的命名空间来获取你需要的类型，因为与订单相关的类分布在各处。因此，我们更改为具有“订单”、“文章”、“用户”等命名空间的面向特征的结构。

[.Net 命名指南](http://msdn.microsoft.com/en-us/library/ms229026.aspx)中有一条建议，Names of Namespaces ：

```
<Company>.(<Product>|<Technology>)[.<Feature>][.<Subnamespace>] 
```

属于哪个特征`HtmlWhiteList`？为了安全？到客户端会话？我不能告诉你，因为我不知道它是什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T21:02:22.447

我只是把它和调用它的代码的类放在一起。否则只给它自己的文件夹，不能保证它永远是唯一属于那里的类。不过，我认为这更像是一个意见问题，而不是一个有具体答案的问题。

# sql - sql: - 在查询中替换和取消透视函数

> ID：16202040
> 
> 赞同：0
> 
> 时间：2013-04-24T20:57:45.333
> 
> 标签：sql, sql-server, replace, unpivot

小提琴示例：http://sqlfiddle.com/#!3/419ec/ [3](http://sqlfiddle.com/#!3/419ec/3)

2008 年的 SQL 服务器。

我想知道是否有人可以使用替换功能和取消透视功能向我解释下面的选择查询中发生了什么。我是 sql 的新手，我不明白这种查询的逻辑（非规范化表）。

```
CREATE TABLE TableB
    ([date] datetime, [Id] int, [name] varchar(3), [blah1] varchar(4), [hour1] int, [hour2] int, [hour3] int, [hour4] int)
;

INSERT INTO TableB
    ([date], [Id], [name], [blah1], [hour1], [hour2], [hour3], [hour4])
VALUES
    ('2013-04-01 00:00:00', 1, 'Jim', 'test', 129, 343, 54, 89),
    ('2013-04-01 00:00:00', 2, 'Bob', 'rewe', 45, 6, 45, 2),
    ('2013-04-02 00:00:00', 3, 'Joe', 'fdf', 7, 8, 4, 3) 
```

选择查询：

```
select date, 
  id, 
  name,
  replace(MightMouse, 'hour', '') hour,
  observationvalue
from tableB
unpivot
(
  observationvalue
  for MightMouse in (hour1, hour2, hour3, hour4)
) unpiv 
```

我认为replace函数的用法如下：

```
REPLACE ( string_expression , string_pattern , string_replacement )

string_expression 
```

[http://msdn.microsoft.com/en-us/library/ms186862.aspx](http://msdn.microsoft.com/en-us/library/ms186862.aspx)

根据`replace`函数的定义，string_expression 是正在其中搜索子字符串的字符串（子字符串可以是完整字符串）。例如，

```
replace('mynameisjohn', 'john', '') 
```

`john`这将在 string_expression 中搜索子字符串`mynameisjohn`并将其替换为空字符串，从而生成一个等于 的字符串`mynameis`。

但在上面的例子中，我不明白是什么`MightyMouse`。原表中没有`MightyMouse`。我也不知道 unpivot 部分如何像在执行流程中那样适合查询。

例如，如果这是 python，那么代码的逻辑就会很直观。使用 SQL，您似乎可以构建丑陋的查询，并且从 sql 的角度来看，一切都很好。但从用户的角度来看，可能很难分解查询代码的不同部分中发生的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T22:01:28.710

Unpivot 为您的案例中指定的每一列使用嵌套的左外连接

```
 (hour1, hour2, hour3, hour4) 
```

这些列名也是结果的一部分，在您的情况下称为 MightMouse

```
select replace('hour1','hour','')
select replace('hour2','hour','')
select replace('hour3','hour','') 
```

换句话说，相同的查询可以这样写

```
select a.date,a.id, 
  a.name,replace('hour1', 'hour', '') as hour ,a.hour1 as observationvalue
from TableB a
left outer join TableB b
on a.hour1=b.hour1
where a.hour1 is not null
union

select a.date,a.id, 
  a.name,replace('hour2', 'hour', '') as hour ,a.hour2 as observationvalue
from TableB a
left outer join TableB b
on a.hour2=b.hour2
where a.hour2 is not null
union
select a.date,a.id, 
  a.name,replace('hou3', 'hour', '') as hour ,a.hour3 as observationvalue
from TableB a
left outer join TableB b
on a.hour3=b.hour3
where a.hour3 is not null
union
select a.date,a.id, 
  a.name,replace('hour4', 'hour', '') as hour ,a.hour4 as observationvalue
from TableB a
left outer join TableB b
on a.hour4=b.hour4
where a.hour4 is not null 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T22:19:05.973

`UNPIVOT`是一个表操作符，它对前面的表进行操作：

```
tableName UNPIVOT (<unpivot-expression>) 
```

您`UNPIVOT`添加了*两*列额外的列（不是隐含的列），第一`observationvalue`列包含`(hour1, hour2, hour3, hour4)`从水平旋转到垂直的列中的值。

其次，它添加了`MightMouse`列，该列是从中提取相应电流的列的*名称。*`(hour1, hour2, hour3, hour4)``observationvalue`

所以这一行：

```
hour1, hour2, hour3, hour4
129,   343,   54,    89 
```

变成这些行：

```
observationvalue MightMouse
129              hour1
343              hour2
 54              hour3
 89              hour4 
```

（当然还有其他相应的列值）

希望这也能清楚地说明 REPLACE 在做什么以及它为什么起作用。

* * *

至于*有效*的(*) 执行顺序：在 SQL Query 中，`FROM`子句总是*首先*`WHERE`执行，然后是子句。子句（列`SELECT`列表和列表达式）几乎在最后，而`ORDER BY`子句通常在最后（有一些特定于 MS 的例外）。

（* - 这只是“有效”/“逻辑”的执行顺序。允许 SQL 引擎按照它想要的任何实际顺序执行操作，只要它具有与此顺序相同的逻辑效果）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:10:19.737

“MightMouse”是新列的名称。从本质上讲，您将所有这些小时列合并到一个列中。“for MightMouse in ...”正在调用列 MightMouse。那么，您将用空字符串替换该新列中的文字字符串“小时”。

# ajax - 使用 $.ajax 和 jsonp 调用 C# Web 服务

> ID：16202043
> 
> 赞同：2
> 
> 时间：2013-04-24T20:57:49.727
> 
> 标签：ajax, jquery, jsonp

我需要将存储在文件中的数字列表带入网页。我用 Visual Studio C# 编写了一个 Web 服务来读取文件并响应内容。如果我将 Web 服务的 URL 放入浏览器 http://MyComputer /wcfService3_deploy/RestServiceImpL.svc/json/123 它会显示一个 json 结果：{"JSONDataResult":"9781770494138"}（文件中只有一个数字）。

现在，我需要从我的页面调用该服务。不幸的是，网络服务与我的网页在不同的计算机上，所以我需要将 jsonp 与 ajax 一起使用。

当我尝试通过 javascript 调用 Web 服务时，它永远不会访问该服务。我在调用中添加了一个错误参数，它报告“[object object] 错误”

```
function myFunction() {
var data = "datatext";
document.getElementById("response").innerHTML = "In MyFunction";
$.ajax({
     type : "GET",
     datatype : "jsonp",
     url : "http://MyComputer/wcfService3_deploy/RestServiceImpL.svc/json/123?callback=jsonpCallback",
     crossDomain : "true",
     jsonpCallback : jsonpCallback(data),
     success : jsonpCallback(data)

});
 /*document.getElementById("response").innerHTML = "AfterAjax";*/
};

function jsonpCallback(data) {
      document.getElementById("response").innerHTML =data;
    };

</script>

<p id="response">Old Text</p>
<button type="button" onclick="myFunction()">Click Me!</button> 
```

我知道我在这里有太多次jsonpCallback，并且将数据声明为变量没有意义。将回调放入 url 与 jsonpCallback 参数与 success 参数有什么区别？如果我不声明数据，它不会让我将它用作参数的参数。如何指定将包含返回结果的变量的名称？

感谢您的耐心等待

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:25:49.417

你有：

```
 jsonpCallback : jsonpCallback(data),
 success : jsonpCallback(data) 
```

为了扩展 David 的评论，您的回调设置是说在构建回调时，调用 jsonpCallback(data)，并将“jsonpCallback”和“success”定义为该函数的结果。

如果您只是为它提供要调用的方法，它会将其作为函数应用于返回的对象。

它看起来像这样：

```
jsonpCallback : jsonpCallback,
success : jsonpCallback 
```

# facebook - 网页上的 FB Like 按钮显示的计数与 FB 页面上的 Like 计数不同。

> ID：16202045
> 
> 赞同：0
> 
> 时间：2013-04-24T20:57:54.670
> 
> 标签：facebook, facebook-like

我们的网站有一个 FB 页面，其中有相当数量的“喜欢”。

现在，我们在我们的网站上添加了“赞”按钮，该按钮显示了“赞”的数量。问题是我网站上的“点赞”按钮中的数量远低于 FB 页面上的实际点赞数量。甚至 facebook 图表中的点赞数也小于页面点赞数。显然，有些喜欢丢失或没有被计算在内。我尝试了 Linter，但没有任何变化。

我在 FB 开发人员的帮助中找不到任何可以解释这一点的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-19T00:07:44.893

您在网站上点赞按钮旁边看到的点赞数是点赞该页面的人数。它与您的 Facebook 页面的点赞数无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-27T06:47:23.147

正如[社交插件常见问题](https://developers.facebook.com/docs/plugins/faqs?locale=en_US#faq_233117017073109)所提到的，网页上点赞按钮后的点赞数包括：

*   您的网址的点赞数
*   您的 URL 的共享数量（这包括将链接复制/粘贴回 Facebook）
*   Facebook 上有关您的 URL 的故事的点赞数和评论数

所以它不仅仅是在你的 FB 页面上简单的“喜欢”计数。

# android - Asynctask 不使用 publishprogress 更新进度对话框

> ID：16202046
> 
> 赞同：0
> 
> 时间：2013-04-24T20:57:55.397
> 
> 标签：android, android-asynctask

我有下载 Image 的 AsyncTask，它还显示进度对话框。asynctask 运行得很好，并且图像下载的进度也正确显示了该值。我通过在 doInBackground() 中记录下载的值来检查它，然后使用 publishProgress()。但是这个 publishProgress 不会增加进度对话框。

下面是我正在使用的代码。

```
public class SingleMenuItemActivity extends Activity {
public static final String KEY_TITLE = "title";
public static final String KEY_LINK = "link";
public static final String KEY_DATE = "date";

public static final String TAG = "SingleMenuItemActivity";
private ProgressDialog pDialog;
// Progress dialog type (0 - for Horizontal progress bar)
public static final int PROGRESS_BAR_TYPE = 0;

//public static ImageDownloadTask imTask;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.single_list_item);

    // getting intent data
    Intent in = getIntent();

    // Get XML values from previous intent
    String name = in.getStringExtra(KEY_TITLE);
    String pLink = in.getStringExtra(KEY_LINK);
    String pDate = in.getStringExtra(KEY_DATE);

    // Displaying all values on the screen
    TextView lblTitle = (TextView) findViewById(R.id.title_label);
    TextView lblDate = (TextView) findViewById(R.id.publish_label);
    lblTitle.setText(name);
    lblDate.setText(pDate);

// Set Image
    try {
        URL url = new URL(pLink);
        new ImageDownloadTask().execute(url);
    } catch (IOException e) {
        e.printStackTrace();
    }
}

/**
 * Showing Dialog
 * */
@Override
protected Dialog onCreateDialog(int id) {
    switch (id) {
    case PROGRESS_BAR_TYPE: // we set this to 0
        pDialog = new ProgressDialog(this);
        pDialog.setMessage("Downloading image. Please wait...");
        pDialog.setIndeterminate(false);
        pDialog.setMax(100);
        pDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        pDialog.setCancelable(false);
        pDialog.show();
        return pDialog;
    default:
        return null;
    }
}

class ImageDownloadTask extends AsyncTask<URL, Float, String> {

    public static final String TAG = "ImageDownloadTask";        
     ImageView imageView = (ImageView) findViewById(R.id.single_list_imageview);
     int count;
    @Override
    protected String doInBackground(URL... params) {
         try {

                URL url = params[0];
                URLConnection conection = url.openConnection();
                conection.connect();
                // this will be useful so that you can show a tipical 0-100% progress bar
                int lenghtOfFile = conection.getContentLength();

                // download the file
                InputStream input = new BufferedInputStream(url.openStream(), 8192);

                // Output stream
                OutputStream output = new FileOutputStream("/sdcard/downloadedfile.jpg");

                byte data[] = new byte[1024];

                long total = 0;

                while ((count = input.read(data)) != -1) {
                    total += count;
                    float pValue = (float)((total*100)/lenghtOfFile);
                    Log.d(TAG,"Download so far : "+pValue);
                    // publishing the progress....
                    // After this onProgressUpdate will be called
                    publishProgress(pValue);

                    // writing data to file
                    output.write(data, 0, count);
                }

                // flushing output
                output.flush();

                // closing streams
                output.close();
                input.close();

            } catch (Exception e) {
                Log.e("Error: ", e.getMessage());
            }
        return null;
    }

    @Override
    protected void onPostExecute(String result) {

        Log.d(TAG,"Bitmap download complete");
        dismissDialog(PROGRESS_BAR_TYPE);

        // Displaying downloaded image into image view
        // Reading image path from sdcard
        String imagePath = Environment.getExternalStorageDirectory().toString() + "/downloadedfile.jpg";
        // setting downloaded into image view
        imageView.setImageDrawable(Drawable.createFromPath(imagePath));
    }

    @Override
    protected void onCancelled(){
        Log.d(TAG,"Progress Dialog was Cancelled");
        pDialog.dismiss();
    }

    @Override
    protected void onPreExecute() {
         super.onPreExecute();
        // Things to be done before execution of long running operation. For
        // example showing ProgessDialog
         showDialog(PROGRESS_BAR_TYPE);
    }

    protected void onProgressUpdate(Integer... values) {
        //super.onProgressUpdate(values);
        Log.d(TAG,"values"+values[0]);
//          incrementProgressBy(values[0]);
        //pDialog.setProgress(values[0]);
        setProgress(values[0]);
        }
    }
} 
```

请告诉我哪里做错了。

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T21:19:21.670

问题是您的进度类型`AsyncTask`定义为`Float`，而该`onProgressUpdate()`方法将`Integer`作为参数的类型。通过声明`onProgressUpdate()`这种方式，您将重载标准回调方法，并且不会被`AsyncTask`. 如果您`@Override`为此方法添加注释，您的代码也将无法编译。因此，您应该将参数类型更改`onProgressUpdate()`为`Float`，或者将进度类型更改`AsyncTask`为`Integer`，这是一个更好的解决方案，因为`ProgressDialog's` `setProgress()`它`int`作为参数类型。

# powershell - 为什么 TortoiseSVN 似乎无法将我的 Powershell 脚本识别为文本文件？

> ID：16202051
> 
> 赞同：0
> 
> 时间：2013-04-24T20:58:10.090
> 
> 标签：powershell, tortoisesvn

我正在使用 TortoiseSVN（版本 1.7.10，Build 23359）将我的 Powershell 脚本存储在 Subversion（1.7.7）中，但是当我尝试查看“与以前版本的差异”时，我在第一行，其余的空白和一些空白行标记的不同。似乎 SVN 将我的 Powershell 文件视为二进制文件而不是文本。我可以进行一些编码更改以便 TortoiseSVN 识别它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T17:59:52.670

我发现[其他人也有同样的问题](http://social.technet.microsoft.com/Forums/en-US/winserverpowershell/thread/dacb75cb-47da-4120-8dca-c697f8a84c70/)，看起来 Powershell ISE (v2.0) 使用 Unicode Big Endian 而不是 UTF8。我可以在另一个编辑器中编辑我的文件，使用 Powershell v3（他们说默认使用 UTF8 - 未经证实）或使用支持 unicode 的工具，如[KDIFF](http://kdiff3.sourceforge.net/)。

# java - Netbeans：无法在 Swing 编辑器中添加自定义 JPanel

> ID：16202054
> 
> 赞同：1
> 
> 时间：2013-04-24T20:58:17.023
> 
> 标签：java, swing, netbeans, jpanel

我在 Netbeans Swing 编辑器中将自定义 JPanel 添加到 JFrame 时遇到问题。

为了排除其他问题，我制作了一个全新的 JFrame，并尝试将我的 JPanel 拖进去（JPanel 甚至在同一个包中）。它弹出一条错误消息：

> 警告：无法从项目加载组件类 GUI。（nameofpanel）...（路径）...找不到该类。请注意，该类必须经过编译，并且必须是目标 GUI 表单所属项目的源或依赖项的一部分。

在使用此方法之前，我已成功将 JPanel 添加到框架中，但现在它阻止了我这样做。我在 Netbeans 的 7.1 和 7.3 版本中遇到了同样的错误。

我想我可能需要构建 JPanel 类文件，但是这样做的选项是灰色的。我什至尝试过干净并没有效果。

这是我的 JFrame：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package gui;

/**
 *
 * @author chris
 */
public class MainFrame extends javax.swing.JFrame {

    /**
     * Creates new form MainFrame
     */
    public MainFrame() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">                          
    private void initComponents() {

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 400, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 300, Short.MAX_VALUE)
        );

        pack();
    }// </editor-fold>                        

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(MainFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(MainFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(MainFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(MainFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new MainFrame().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify                     
    // End of variables declaration                   
} 
```

我的JPanel：

```
package GUI;

import java.awt.Image;
import java.io.*;
import javax.imageio.*;
import javax.swing.*;

/*
 * Represents one card graphically /**
 *
 * @author Student-HSLH133
 */
public class CardPanel extends javax.swing.JPanel {

    private Image cardImage;

    /**
     * Creates new form CardPanel
     */
    public CardPanel() {
        initComponents();
        //Set to face down card initially
        //Hey look, some Lisp code, jk
        try {
            cardLabel.setIcon(imageToIcon(ImageIO.read(new File("images/gbCard52.gif"))));
        }
        catch (Exception e){
            System.out.println("Failed to load the image.");
            System.exit(-1);
        }
    }

    public void setCard(Image img) {
        cardLabel.setIcon(imageToIcon(img));
        repaint();
    }

// --------------   end of load_picture ---------------------------
    private ImageIcon imageToIcon(Image img) {
        return new ImageIcon(img);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">                          
    private void initComponents() {

        cardLabel = new javax.swing.JLabel();

        setMaximumSize(new java.awt.Dimension(72, 102));
        setMinimumSize(new java.awt.Dimension(72, 102));
        setPreferredSize(new java.awt.Dimension(72, 102));
        setLayout(new java.awt.BorderLayout());

        cardLabel.setMaximumSize(new java.awt.Dimension(72, 102));
        cardLabel.setMinimumSize(new java.awt.Dimension(72, 102));
        cardLabel.setPreferredSize(new java.awt.Dimension(72, 102));
        add(cardLabel, java.awt.BorderLayout.CENTER);
        cardLabel.getAccessibleContext().setAccessibleName("card");
    }// </editor-fold>                        
    // Variables declaration - do not modify                     
    private javax.swing.JLabel cardLabel;
    // End of variables declaration                   
} 
```

我完全迷路了。到底是怎么回事？

编辑：我以某种方式得到它来编译 JPanel，但我仍然得到同样的错误。考虑到它可能与 JPanel 本身有关，我制作了一个新的自定义 JPanel，对其进行编译，然后尝试添加它，并且它起作用了。

编辑 2：我尝试注释掉我在 JPanel 类中完成的自定义内容，但无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:17:38.900

我从来没有确定这一点，但我认为这与错误的文件跟踪或我的 JPanel 类文件损坏有关。

将方法和变量移动到新的 JPanel 类似乎工作正常，所以这就是解决方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-15T11:29:40.577

我前段时间遇到过这个问题，清理和构建我的项目对我有用。

# javascript - javascript：访问数组数组中的项目

> ID：16202057
> 
> 赞同：0
> 
> 时间：2013-04-24T20:58:23.623
> 
> 标签：javascript

我是 Javascript 新手，在访问数组数组中的项目时遇到问题。我正在使用 AngularJs 框架，代码如下：

```
$scope.db.items4 = [];  
var newRow={
    ID:0,
    action1:[0,0,0,0,0,0,0],
    action2:[0,0,0,0,0,0,0]
    };

$scope.db.items4.push(newRow);

for (var j = 0; j < 50; j++){
   var lastRow=items4.length-1;
   var thatDay=ts.items[j].day;
   if(items4[lastRow].ID=="0"){
       items4[lastRow]=ts.items[j].ID;
       items4[lastRow].action1[thatDay]=ts.items[j].action1;
       items4[lastRow].action2[thatDay]=ts.items[j].action2;
   }else{
    if(items4[lastRow].ID==ts.items[j].ID && items4[lastRow].action2[thatDay]=="0") { 
       items4[lastRow].action1[thatDay]=ts.items[j].action1;
       items4[lastRow].action2[thatDay]=ts.items[j].action2;
        } else{
           var newRow2={
            ID:0,
            action1:[0,0,0,0,0,0,0],
            action2:[0,0,0,0,0,0,0]
            };
            $scope.db.items4.push(newRow2);
            lastRow++;
            items4[lastRow]=ts.items[j].ID;
            items4[lastRow].action1[thatDay]=ts.items[j].action1;
            items4[lastRow].action2[thatDay]=ts.items[j].action2;
            }
        }
   } 
```

当我运行它时，javascript 控制台总是说：

```
Uncaught ReferenceError: items4 is not defined 
```

但是很明显 items4 在一开始就已经定义了；（任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:08:31.657

如果您想简化它，请将第一行更改为：

```
var item4 = $scope.db.items4 = []; 
```

# php - 带有赋值原因的条件语句中的 false !== 是什么？

> ID：16202059
> 
> 赞同：-1
> 
> 时间：2013-04-24T20:58:31.507
> 
> 标签：php, compare, expression

在某些编程语言中，这似乎是一种特殊情况。在php手册中，我找不到含义。

```
(false !== ($file = readdir($handle))) 
```

右边有'赋值，左边有比较，但整个运算符是什么意思？

使用这个有什么特别的考虑吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:04:05.553

这是以下内容的简写：

```
$file = readdir($handle);
if (false !== $file) {
// etc
} 
```

这最常见于 while 循环的条件。有两点需要注意：

1.  他们正在使用严格检查（！== 而不是！=），因为 readdir 可以返回“错误”的东西，比如空字符串。
2.  这是非常不透明的语法，我会射杀任何把它带给我的后辈。

**编辑**回应OP的问题：

PHP 具有“松散”和“严格”的值检查。松散检查使用 == 和 != 运算符，它比较“真”与“假”值。假、0 或空字符串或数组都是“假的”，因此条件 ("" == false) 的计算结果为真， (0 == Array()) 也是如此。

严格检查使用 === 和 !==。这意味着测试变量必须*相同*，因此 (0 === false) 评估为 false，而 (0 === 0) 评估为 true。

为了解释这对 readdir 函数意味着什么，[手册页上](http://php.net/manual/en/function.readdir.php)有一个红色的大框来解释它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:03:45.517

分解：

```
$file = readdir($handle);

if ($file !== false) {

} 
```

引用 PHP 手册`readdir`：

> 此函数可能返回布尔值 FALSE，但也可能返回计算结果为 FALSE 的非布尔值。请阅读有关布尔值的部分以获取更多信息。使用 === 运算符测试此函数的返回值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T21:06:53.390

这基本上是两个语句合二为一：

```
$file = readdir($handle);
if($file !== false) 
{
  //do something
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-24T21:15:41.287

`readdir()`给出 FALSE**或**它正在读取的当前目​​录中下一项的名称。

假设目录是可读的，$file 将具有下一个文件或目录的名称。

于是`(false !== ($file = readdir($handle)))`变成：

```
(false !== <name_of_a_file_or_dir>) //dir was read and the name passed to $file 
```

在这种情况下，比较将解析为 TRUE。

假设目录不可读，$file 将变为 FALSE。于是`(false !== ($file = readdir($handle)))`变成：

```
(false !== false) //because dir was not readable 
```

在这种情况下，比较将解析为 FALSE。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-24T21:01:56.390

这不是一个特别的情况。

PHP 尝试执行 readdir() 函数并将结果分配给 $file 变量。如果 readdir() 成功，则 $file 将包含目录值；但如果失败，它将包含一个布尔值 false。所以 PHP 执行 readdir() 并测试结果是否为假......比较测试中的左值假只是一个风格特征。

经常你会看到

```
if (false == $x) 
```

而不是

```
if ($x == false) 
```

做比较的时候。他们都做同样的事情，除了

```
if (false = $x) 
```

如果您错误输入了比较运算符，将抛出一个通知（如果启用了错误日志记录），而

```
if ($x = false) 
```

不会显示任何通知，并将为 $x 分配一个 false 值，这可能不是预期的，并且可能会在代码中引入问题和错误

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-24T21:26:44.650

```
if (false !== ($file = readdir($handle))) 
```

意思是

*   $file 被赋值为 readdir($handle)
*   然后检查该值是否不**完全**“**非**假”

如果 $file = readdir($handle) 返回值 NULL，并且您有以下代码：

```
if (false !== ($file = readdir($handle))) {
//do something
} 
```

“做某事”将被执行，因为 NULL 不是假的。

如果 $file 返回 0 - “做某事”将被执行，因为 0 不是假的。

如果 $file 返回值 false，则不会执行“做某事”。

如果您有此代码：（少一个 = 运算符）

```
if (false != ($file = readdir($handle))) {
//do something
} 
```

意思是：

*   $file 被赋值为 readdir($handle)
*   然后检查该值的评估是否为“ **NOT** false”

“做某事”不会被执行，因为 NULL 被评估为假。

如果 $file 返回 0 - “做某事”将不会被执行，因为 0 被评估为假。

如果 $file 返回值 false，则不会执行“做某事”。

以上只是为了描述 !== 运算符的工作原理。readdir() 函数不会返回所有这些值（null、0、false）。

# pdf - 如何将项目转换添加到 VS2012 .proj msbuild 文件

> ID：16202062
> 
> 赞同：1
> 
> 时间：2013-04-24T20:58:39.590
> 
> 标签：pdf, msbuild, docx

[根据这个描述将图像文件从 jpg 转换为 png 的项目转换的](https://stackoverflow.com/a/3447585/149060)答案，我进行了将 .docx 文件转换为 .pdf 的项目转换。当我从我的 projectname.proj 构建文件中调用它时，我收到以下错误消息：

```
Error   1   The condition " '%(Extension)' == '.docx' " on the
"WordToPdf" target has a reference to item metadata. References to item 
metadata are not allowed in target conditions unless they are part of an item
transform. [project path]\.build\WordToPdf.Tasks.target 7   9 
```

我怎样才能使这项工作？

这是我的目标：

```
 <?xml version="1.0" encoding="utf-8" ?>
    <Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
      <!-- $Id$ -->
      <Target Name="WordToPdf"
            Inputs="@(Content)"
            Outputs="@(Content -> '%(RootDir)%(Directory)%(Filename).pdf' )"
            Condition=" '%(Extension)' == '.docx' ">
        <ItemGroup>
          <Sublist Include="@(Content)" Condition=" '%(Extension)' == '.docx' " />
        </ItemGroup>
        <PropertyGroup>
          <PowerShellExe Condition=" '$(PowerShellExe)'=='' ">%WINDIR%\System32\WindowsPowerShell\v1.0\powershell.exe</PowerShellExe>
          <ScriptLocation Condition=" '$(ScriptLocation)'=='' ">.\WordToPdf.ps1</ScriptLocation>
        </PropertyGroup>

        <Exec Command="$(PowerShellExe) -NonInteractive -executionpolicy Unrestricted -command &quot;&amp; {&amp;&apos;$(ScriptLocation)&apos; -WordFilename &apos;/Input:%(Sublist.FullPath)&apos; }&quot;" />

        <Content Remove="@(Sublist)" />
        <Content Include="@(Sublist -> '%(RootDir)%(Directory)%(Filename).pdf' )" />
      </Target>
    </Project> 
```

并从 BeforeBuild 目标的我的 projectname.proj 文件中调用它，如下所示：

```
 <Import Project="$(MSBuildTasksPath)\WordToPdf.Tasks.target" />

  ....

  <Target Name="BeforeBuild">
    <CallTarget Targets="WordToPdf" />
  </Target> 
```

**更新**

除了使转换生效的解决方法之外，此目标还有更多错误。供将来参考，这是最终的工作代码：

```
<?xml version="1.0" encoding="utf-8" ?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <!-- $Id$ -->
  <Target Name="WordToPdf"
      Inputs="@(ContentFiltered)"
      Outputs="@(ContentFiltered -> '%(RootDir)%(Directory)%(Filename).pdf' )"
      DependsOnTargets="FilterContent">
    <PropertyGroup>
      <PowerShellExe Condition=" '$(PowerShellExe)'=='' ">%WINDIR%\System32\WindowsPowerShell\v1.0\powershell.exe</PowerShellExe>
      <ScriptLocation Condition=" '$(ScriptLocation)'=='' ">.\WordToPdf.ps1</ScriptLocation>
    </PropertyGroup>

    <Exec Command="$(PowerShellExe) -NonInteractive -executionpolicy Unrestricted -command &quot;&amp; {&amp;&apos;$(ScriptLocation)&apos; -WordFilename &apos;%(ContentFiltered.FullPath)&apos; }&quot;" />

    <ItemGroup>
      <Content Remove="@(ContentFiltered)" />
      <Content Include="@(ContentFiltered -> '%(RootDir)%(Directory)%(Filename).pdf' )" />
    </ItemGroup>
  </Target>
  <!-- New target to pre-filter list -->
  <Target Name="FilterContent">
    <ItemGroup>
      <ContentFiltered Include="@(Content)" Condition="'%(Extension)' == '.docx'" />
    </ItemGroup>
  </Target>

</Project> 
```

而且，对于任何到这里搜索“msbuild word to pdf item transform”的人来说，这是我的 powershell 脚本：

```
Param(
  [string]$WordFilename
)
$Word = New-Object -comobject Word.Application
$Doc=$Word.Documents.Open($WordFilename)
$Doc.saveas([ref](($WordFilename).replace("docx","pdf")), [ref]17)
$Doc.close() 
```

将 .docx 文件添加到您的项目中，作为内容 - 如果较新则复制，如果 docx 文件较新，则将创建 pdf 文件，然后将 pdf 文件复制到其输出位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T13:05:37.140

您可以通过创建单独的目标来解决它，该目标根据您的条件预先过滤项目 - 实际上，创建新列表。

这是示例 - 注意新`DependsOnTargets`标签和更改`ContentFiltered`名称：

```
 <Target Name="WordToPdf"
        Inputs="@(ContentFiltered)"
        Outputs="@(ContentFiltered -> '%(RootDir)%(Directory)%(Filename).pdf' )"
        DependsOnTargets="FilterContent">
    <!-- 
      ...
      your actual target body here 
      ...
      -->
  </Target>

  <!-- New target to pre-filter list -->
  <Target Name="FilterContent">
    <ItemGroup>
      <ContentFiltered Include="@(Content)" Condition="'%(Extension)' == '.docx'" />
    </ItemGroup>
  </Target> 
```

# c++ - 如何（重新）在文件中间写入字节？

> ID：16202067
> 
> 赞同：1
> 
> 时间：2013-04-24T20:59:01.257
> 
> 标签：c++, file, file-io, io

我有一种情况，文件中间有一个字节块需要洗牌。目前实现读取文件，洗牌内存中的字节，然后输出整个文件。虽然这可行，但它不适用于更大的文件大小。我还没有找到一个 C++ API，它允许我在特定偏移量处将特定数量的字节写入文件，而不会影响后面的字节。

这可以做到吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T21:05:48.570

`fstream`以(not `ifstream`or )开头，`ofstream`因为您同时进行输入和输出。

要进行改组，您基本上需要使用`seekg`到达您想要开始更改内容的位置。然后`read`用来读取你要洗牌的数据。然后 shuffle 内存中的数据，使用`seekp`回溯到要写回数据的位置，最后使用`write`将 shuffle 后的数据放回文件中。

这是一个快速演示，从字面上理解“shuffle”部分——它将一个字符串写入文件，然后读取一些数据，对这些字节进行排序，然后将它们写回：

```
#include <fstream>
#include <vector>
#include <string>
#include <algorithm>
#include <iostream>

void init(std::string const &name) { 
    std::ofstream initial(name);

    initial << "This is the initial data.";
}

void shuffle(std::string const &name) {
    std::fstream s(name);

    s.seekg(2);
    std::vector<char> data(5);
    s.read(&data[0], 5);
    std::sort(data.begin(), data.end());
    s.seekp(2);
    s.write(&data[0], 5);
}

void show(std::string const &name) { 
    std::ifstream in(name);

    std::copy(std::istreambuf_iterator<char>(in),
              std::istreambuf_iterator<char>(),
              std::ostream_iterator<char>(std::cout, ""));
}

int main() { 
    std::string name("e:/c/source/trash.txt");
    init(name);

    shuffle(name);

    show(name);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:14:15.023

如果您使用的平台支持`mmap()`（Linux 和其他 unix-likes - 但我很确定其他操作系统具有类似的 API，即使它没有被调用`mmap()`），只需映射文件（或它的适当部分）进入您的地址空间，然后随机播放。

# powershell - 具有类似于 psg et 的基本身份验证的 DownloadString

> ID：16202070
> 
> 赞同：1
> 
> 时间：2013-04-24T20:59:20.363
> 
> 标签：powershell, powershell-2.0, powershell-3.0

任何人都知道我可以如何修改下面的 DownloadString 以便我也可以传递基本的身份验证凭据？

我正在使用与 PsGet ( [http://psget.net/](http://psget.net/) ) 相同的技术来下载我自己的内部脚本并即时执行它们。但是，我的服务器使用基本身份验证进行保护。我无法应用凭据并仍在使用 Invoke-Expression 执行该行。

当我使用“powershell.exe -Command ...”执行它时，我需要它在一行中

(new-object Net.WebClient).DownloadString(" [http://psget.net/GetPsGet.ps1](http://psget.net/GetPsGet.ps1) ") | 即

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T22:03:27.190

您不能在一行中执行此操作（好吧，除非您将其包装为 cmdlet），但提供所需的凭据很容易：

```
$wc = New-Object System.Net.WebClient
$wc.Credentials = New-Object System.Net.NetworkCredential "user","pass"
$wc.DownloadString("http://psget.net/GetPsGet.ps1") | iex 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T22:19:44.070

尝试在 WebClient 上设置授权标头：

```
$wc = New-Object -TypeName System.Net.WebClient
$cred = 'bob:password'
$enc_cred = [convert]::ToBase64String([System.Text.Encoding]::ASCII.GetBytes($cred))
$wc.Headers.Add("Authorization","Basic $enc_cred")
$wc.DownloadString("http://localhost:81/") | Invoke-Expression 
```

注意 - base64 中的凭据字符串未加密。

# java - try/catch 中所需的 AssignmentOperators

> ID：16202076
> 
> 赞同：1
> 
> 时间：2013-04-24T20:59:37.577
> 
> 标签：java, arrays, try-catch, assignment-operator

我在一个 Java 项目中有一个类，它包含一个二维值数组，并提供了与之交互的有用方法。它使用 Location 对象（仅存储两个值）来访问映射中的点并返回值。它有一个方法 isValid()，用于检查 Location 对象是否在网格的映射中。

```
public boolean isValid(Location loc) {
    try {
        // will throw an ArrayIndexOutOfBoundsException if not valid
        // occs is the 2D array within the class
        occs[loc.getX()][loc.getY()];
        return true;
    }
    catch (ArrayIndexOutOfBoundsException e) {
        return false;
    }
} 
```

现在，我知道我可以使用比较来检查值并查看该 loc 是否适合网格，但这更快，因为它不需要运行比较，并且检查的无效位置的情况远在少数。但是，这是我的问题：由于访问数组的行返回的值没有被分配或发送到方法中，因此我收到有关 AssignmentOperators 的错误。我知道将它分配给一个临时值或通过一些无用的方法运行它是一个简单的解决方法，但这两种方法对我来说似乎都是愚蠢的创可贴解决方案，我想知道是否有更清洁的方法来做到这一点。（此外，前者会引起 Eclipse 的警告。）

无论如何，这是低优先级，但让我很烦恼的是，这么简单的事情在如此简单的实现中是不可能的，老实说。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-18T11:51:39.727

> 这更快，因为它不需要运行比较。

当然，它需要“运行比较”。它还能怎么工作？你在这一点上的推理是错误的。因此，您的问题是无效的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-03T18:24:00.210

不幸的是，这正是 Java 的方式。从 JLS 第 14.8 节，表达式语句：

> 与 C 和 C++ 不同，Java 编程语言只允许将某些形式的表达式用作表达式语句。请注意，Java 编程语言不允许“强制转换为 void”——void 不是一种类型——因此编写表达式语句的传统 C 技巧，例如：
> 
> （空白）... ; // 不正确！不起作用。另一方面，Java 编程语言允许在表达式语句中使用所有最有用的表达式，并且不需要将方法调用用作表达式语句来调用 void 方法，因此几乎不需要这样的技巧。如果需要技巧，可以使用赋值语句（第 15.26 节）或局部变量声明语句（第 14.4 节）来代替。

目前尚不清楚他们这样做的确切原因，但我的猜测是它旨在减少错误。例如，如果有人不小心写`a == b;`而不是`a=b;`，将导致编译器错误。在极少数情况下，有人真正想要这种行为，他们必须将其显式分配给临时变量（或将其传递给方法或类似方法）。

# javascript - 高精度地理定位Html5

> ID：16202077
> 
> 赞同：24
> 
> 时间：2013-04-24T20:59:42.500
> 
> 标签：javascript, html, google-maps-api-3, geolocation

我正在尝试使用嵌入式 GPS 定位设备（例如应用程序共享位置）。我读过它是可能的`enableHighAccuracy: true`。

如何`enableHighAccuracy: true`在此代码中设置？我尝试了不同的位置，但它不起作用。

```
<script type="text/javascript">
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
            var latitude = position.coords.latitude;
            var longitude = position.coords.longitude;
            var accuracy = position.coords.accuracy;
            var coords = new google.maps.LatLng(latitude, longitude);
            var mapOptions = {
                zoom: 15,
                center: coords,
                mapTypeControl: true,
                navigationControlOptions: {
                    style: google.maps.NavigationControlStyle.SMALL
                },
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };

            var capa = document.getElementById("capa");
            capa.innerHTML = "latitude: " + latitude + ", longitude: " + ", accuracy: " + accuracy;  

            map = new google.maps.Map(document.getElementById("mapContainer"), mapOptions);
            var marker = new google.maps.Marker({
                position: coords,
                map: map,
                title: "ok"
            });
        });

    } else {
        alert("Geolocation API is not supported in your browser.");
    }

</script> 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-04-24T21:33:39.877

您需要一个`PositionOptions`对象，您可以在其中按照 API 设置高精度标志。

我从这里引用： http: [//diveintohtml5.info/geolocation.html](http://diveintohtml5.info/geolocation.html)

> getCurrentPosition() 函数有一个可选的第三个参数，即 PositionOptions 对象。您可以在 PositionOptions 对象中设置三个属性。所有属性都是可选的。您可以设置任何或全部或不设置。

```
POSITIONOPTIONS OBJECT

Property            Type        Default         Notes
--------------------------------------------------------------
enableHighAccuracy  Boolean     false           true might be slower
timeout             long        (no default)    in milliseconds
maximumAge          long        0               in milliseconds 
```

所以，它应该像这样工作：

```
if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
        var latitude = position.coords.latitude;
        var longitude = position.coords.longitude;
        var accuracy = position.coords.accuracy;
        var coords = new google.maps.LatLng(latitude, longitude);
        var mapOptions = {
            zoom: 15,
            center: coords,
            mapTypeControl: true,
            navigationControlOptions: {
                style: google.maps.NavigationControlStyle.SMALL
            },
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        var capa = document.getElementById("capa");
        capa.innerHTML = "latitude: " + latitude + ", longitude: " + ", accuracy: " + accuracy;

        map = new google.maps.Map(document.getElementById("mapContainer"), mapOptions);
        var marker = new google.maps.Marker({
            position: coords,
            map: map,
            title: "ok"
        });

    },
    function error(msg) {alert('Please enable your GPS position feature.');},
    {maximumAge:10000, timeout:5000, enableHighAccuracy: true});
} else {
    alert("Geolocation API is not supported in your browser.");
} 
```

注意到我添加了以下 2 个参数来`getCurrentPosition`调用：

1.  `function error(msg){alert('Please enable your GPS position future.');}`

    当无法检索 GPS 或已触发超时时调用此函数。

2.  `{maximumAge:10000, timeout:5000, enableHighAccuracy: true});`

    这些是选项。我们不想要超过 10 秒 ( `maximumAge:10000`) 的 gps 数据。我们不想等待超过 5 秒的响应 ( `timeout:5000`)，我们希望启用高精度 ( `enableHighAccuracy: true`)。

另请参阅：[Geolocation HTML5 enableHighAccuracy True 、 False 还是 Best Option？](https://stackoverflow.com/questions/9053262/geolocation-html5-enablehighaccuracy-true-false-or-best-option)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-10-24T14:34:33.750

`enableHighAccuracy: true`这是取自[Mozilla Developer Network](https://developer.mozilla.org/en-US/docs/Web/API/Geolocation/getCurrentPosition#Example)的一个简单示例。

```
var options = {
  enableHighAccuracy: true,
  timeout: 5000,
  maximumAge: 0
};

function success(pos) {
  var crd = pos.coords;

  console.log('Your current position is:');
  console.log(`Latitude : ${crd.latitude}`);
  console.log(`Longitude: ${crd.longitude}`);
  console.log(`More or less ${crd.accuracy} meters.`);
}

function error(err) {
  console.warn(`ERROR(${err.code}): ${err.message}`);
}

navigator.geolocation.getCurrentPosition(success, error, options); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-17T12:33:09.577

```
if(navigator.geolocation) {
   navigator.geolocation.getCurrentPosition(position => {
       do_whatever_you_want
},
error => console.log(error),
{enableHighAccuracy: true}
)
} 
```

**说明：** 首先，我正在检查浏览器是否支持使用`if`顶部条件的地理位置并将整个代码包装在其中。如果它存在，那么我会尝试获取`getCurrentPosition`包含坐标等信息的对象。我称之为对象`position`。所以如果你想得到`lat`and `lng`;

```
var lt = position.coords.latitude;
var ln = position.coords.longitude; 
```

`GetCurrentPosition`也需要更多的论据。第一个是如果它运行成功（然后我试图获取返回的对象）。第二个是`error`。我在这里控制台记录了错误。第三个是额外的选项。这些选项之一是`enableHighAccuracy`. 如果设置为`true`它将尝试从用户那里获得最准确的位置。

# php - 我在哪里可以找到一个好的 PHP 类来将数据从 html 或数据集导出到带有格式化的 excel 文件？

> ID：16202079
> 
> 赞同：0
> 
> 时间：2013-04-24T20:59:54.007
> 
> 标签：php, excel, class, export-to-excel

我正在寻找将数据导出到 excel 文件的现有 PHP 类。我还需要能够创建设计，以便所有报告看起来都像报告的网络版本。

有人可以带我去上一堂经过测试的好课吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:04:26.550

要从 Excel 格式导出，请查看 [PHPExcel](http://phpexcel.codeplex.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:09:41.273

如果还没有，请尝试 PHPExcel [http://phpexcel.codeplex.com/ 。](http://phpexcel.codeplex.com/)这个很不错。

# jquery - IE7 jQuery 1.9.1 问题

> ID：16202086
> 
> 赞同：-1
> 
> 时间：2013-04-24T21:00:16.867
> 
> 标签：jquery, internet-explorer-7

仅在 IE7 中，脚本错误消息会显示在状态栏中，这会削弱 UI。例如，如果我单击任何锚标记，它就不起作用。顺便说一句，这个脚本错误位置和调用堆栈是使用 IE7 的 Web 开发助手获取的。

如果我包含**jquery-1.9.1.min.js**，在 IE7 中我会看到以下脚本错误消息：

```
at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.min.js [4]
    wt
    code: if(t=i.find.ID(u.matches[0].replace(et,tt),t)[0],!t) at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.min.js [4]
    st
    code: return wt(e.replace(W,"$1"),t,n,r) at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.min.js [4]
    JScript anonymous function
    code: b.find(e,this[t],n) at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.min.js [3]
    JScript anonymous function
    code: return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e) at http://10.15.1.77:8080/mhs/3p/jquery-migrate-1.1.1.min.js [2]
    JScript anonymous function
    code: return t&&"string"==typeof t&&!e.isPlainObject(n)&&(o=y.exec(t))&&o[1]&&("<"!==t.charAt(0)&&r("$(html) HTML strings must start with '<' character"),n&&n.context&&(n=n.context),e.parseHTML)?v.call(this,e.parseHTML(e.trim(t),n,!0),n,a):v.apply(this,arguments) at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.min.js [3]
    JScript anonymous function
    code: return new b.fn.init(e,t,r) at http://10.15.1.77:8080/mhs/nwtTools.js [124]
    JScript anonymous function
    code: $("#IPL a").click(function()  {
            self.dropdownTools.hide();
        }) at http://10.15.1.77:8080/mhs/nwtTools.js [10]
    JScript anonymous function
    code: this.attachEvents() at http://10.15.1.77:8080/mhs/nwtTools.js [270]
    JScript anonymous function
    code: var nwtTools = new NWTTools() at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.min.js [3]
    JScript anonymous function
    code: if(u[a].apply(t[0],t[1])===!1&&e.stopOnFalse) at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.min.js [3]
    JScript anonymous function
    code: return t=t||[],t=[e,t.slice?t.slice():t],!u||i&&!l||(n?l.push(t):c(t)),this at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.min.js [3]
    JScript anonymous function
    code: b.isReady=!0,e!==!0&&--b.readyWait>0||(n.resolveWith(o,[b]),b.fn.trigger&&b(o).trigger("ready").off("ready")) at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.min.js [3]
    JScript anonymous function
    code: (o.addEventListener||"load"===e.type||"complete"===o.readyState)&&(q(),b.ready()) 
```

如果我包含**jquery-1.9.1.js**，在 IE7 中我会看到以下脚本错误消息：

```
at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.js [5472]
    select
    code: context = Expr.find["ID"]( token.matches[0].replace( runescape, funescape ), context )[0]
at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.js [3998]
    Sizzle
    code: return select( selector.replace( rtrim, "$1" ), context, results, seed )
at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.js [5576]
    JScript anonymous function
    code: jQuery.find( selector, this[ i ], ret )
at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.js [196]
    JScript anonymous function
    code: return ( context || rootjQuery ).find( selector )
at http://10.15.1.77:8080/mhs/3p/jquery-migrate-1.1.1.min.js [2]
    JScript anonymous function
    code: return t&&"string"==typeof t&&!e.isPlainObject(n)&&(o=y.exec(t))&&o[1]&&("<"!==t.charAt(0)&&r("$(html) HTML strings must start with '<' character"),n&&n.context&&(n=n.context),e.parseHTML)?v.call(this,e.parseHTML(e.trim(t),n,!0),n,a):v.apply(this,arguments)
at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.js [62]
    JScript anonymous function
    code: return new jQuery.fn.init( selector, context, rootjQuery )
at http://10.15.1.77:8080/mhs/nwtTools.js [124]
    JScript anonymous function
    code: $("#IPL a").click(function()  {
            self.dropdownTools.hide();
        })
at http://10.15.1.77:8080/mhs/nwtTools.js [10]
    JScript anonymous function
    code: this.attachEvents()
at http://10.15.1.77:8080/mhs/nwtTools.js [270]
    JScript anonymous function
    code: var nwtTools = new NWTTools()
at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.js [1037]
    JScript anonymous function
    code: if ( list[ firingIndex ].apply( data[ 0 ], data[ 1 ] ) === false && options.stopOnFalse )
at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.js [1148]
    JScript anonymous function
    code: fire( args )
at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.js [433]
    JScript anonymous function
    code: readyList.resolveWith( document, [ jQuery ] )
at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.js [103]
    JScript anonymous function
    code: jQuery.ready()
at http://10.15.1.77:8080/mhs/nwtTools.js [124]
    JScript anonymous function
    code: $("#IPL a").click(function()  {
            self.dropdownTools.hide();
        })
at http://10.15.1.77:8080/mhs/nwtTools.js [10]
    JScript anonymous function
    code: this.attachEvents()
at http://10.15.1.77:8080/mhs/nwtTools.js [270]
    JScript anonymous function
    code: var nwtTools = new NWTTools()
at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.js [1037]
    JScript anonymous function
    code: if ( list[ firingIndex ].apply( data[ 0 ], data[ 1 ] ) === false && options.stopOnFalse )
at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.js [1148]
    JScript anonymous function
    code: fire( args )
at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.js [433]
    JScript anonymous function
    code: readyList.resolveWith( document, [ jQuery ] )
at http://10.15.1.77:8080/mhs/3p/jquery-1.9.1.js [103]
    JScript anonymous function
    code: jQuery.ready() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T00:26:22.737

我对 IE7 使用 jquery 1.7.2，对所有其他浏览器使用 jquery 1.9.1。它现在工作正常。感谢 SpYk3HH。

# android - Android - 为什么我不能向 ListFragment 的 ListView 添加页脚视图？

> ID：16202088
> 
> 赞同：0
> 
> 时间：2013-04-24T21:00:18.757
> 
> 标签：android, android-layout, android-listview, android-listfragment

我以前让这段代码在 a 中工作没有问题`ListActivity`，现在我正在重构使用`ListFragment`并且代码编译但我看不到任何按钮（页脚）

代码：

```
@Override
public void onActivityCreated(Bundle savedInstanceState)
{
    super.onActivityCreated(savedInstanceState);

    log("+ ON ACTIVITY CREATED +");

    listView = getListView();

    // Retrieve routines ArrayList from JSON
    routineList = FitnessApp.routineList;   

    routineList.add(new Routine("test routine"));

    adapter = new GeneralTemplateAdapter(routineList, getActivity().getLayoutInflater());

    listView.setAdapter(adapter);

    // Creating bottom button as a footer view
    Button bAddNew = (Button) getActivity().getLayoutInflater().inflate(R.layout.add_new_button, null);
    bAddNew.setText("Add Routine");

    listView = getListView();   // Get reference to ListActivities ListView
    listView.addFooterView(bAddNew);
} 
```

有任何想法吗？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-03T22:53:34.153

啊，我忘记了在添加适配器之前必须声明页眉和页脚的简单事实

# jquery - 'Active' 而不是 :hover 用于触摸设备

> ID：16202093
> 
> 赞同：2
> 
> 时间：2013-04-24T21:00:42.057
> 
> 标签：jquery, css

当鼠标悬停在上面时，我`:hover`用来显示使菜单不透明 - 显然这不适用于触摸设备。这个[小提琴](http://jsfiddle.net/wright_jamie/veDU3/1/)显示了我想要实现的目标（向下滚动以查看透明度）。在我的完整示例中，我使用复选框来下拉子菜单，效果很好。

显然我不能使用 CSS 向上遍历，所以选择一个复选框我不能影响 grandparent `nav`。有没有人有什么建议？是否有某种`:active`或等效的遍历 DOM？

我不确定我是否让自己特别清楚，但任何帮助将不胜感激。我怀疑唯一的解决方案可能是 jquery 一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:03:39.480

在移动设备上完全避免不透明效果更简单。也就是说，如果客户端在触摸设备上，则将 opacity 设置为 1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:03:01.997

使用媒体查询为手持设备做其他事情；

```
@media handheld {
    /* .myHoverElement:active { }*/
} 
```

您也可以尝试寻找一些您特别想要定位的触摸设备。例如;

iPhone < 5:

```
@media handheld and (device-aspect-ratio: 2/3) {} 
```

iphone 5：

```
@media handheld and (device-aspect-ratio: 40/71) {} 
```

平板电脑：

```
@media handheld and (device-aspect-ratio: 3/4) {} 
```

至于`cimmanon`说的评论。StackOverflow 有很多关于它的信息，以及如何定位特定设备，如果`handheld`在某些设备上不起作用，也许可以更好地检测它们；

[iPhone / Android 浏览器是否支持 CSS @media 手持设备？](https://stackoverflow.com/questions/3893342/do-iphone-android-browsers-support-css-media-handheld)

# c# - 部分视图刷新后保存数据的 jQuery 对话框

> ID：16202095
> 
> 赞同：3
> 
> 时间：2013-04-24T21:00:48.457
> 
> 标签：c#, jquery, ajax, asp.net-mvc, jquery-dialog

我有一个局部视图，它打开一个对话框以输入一些数据。单击按钮后，将执行 Ajax 调用以重置该局部视图和另一个。当我单步执行代码时，一切似乎都正常，只是当我打开部分视图备份它时，数据仍在框中。[我在这个问题Caching issue with loading partial views into JQuery dialogs](https://stackoverflow.com/questions/11528196/caching-issue-with-loading-partial-views-into-jquery-dialogs)之后发现了一些成功，但是当我实现该按钮在我第二次使用它时不起作用时。我的代码如下：

刷新视图和包含其他部分视图的视图的 jQuery 和 Ajax：

```
<script type="text/javascript" charset="utf-8">
$(document).ready(function () {
    $('#ChangeHeatName').click(function (e) {
        var tdata = $('#form1').serialize();
        var origname = $('#HeatNameDiv').find('input[name="heatName"]').first().val();
        var newname = $('#HeatNameDiv').find('input[name="updatedHeat"]').first().val();
        $.ajax({
            type: "POST",
            data: {
                mCollection: tdata,
                heatName: origname,
                updatedHeat: newname
            },
            url: '@Url.Action("ChangeHeatName","Home")',
            //url: "/Home/ChangeHeatName",
            success: function (result) { success(result); }
        });
    });

    function success(result) {

        $('#HeatNameDiv').dialog('close');
        //Ajax with problem
        $.ajax({
            type: "GET",
            url: '@Url.Action("ButtonsPartial","Home")',
            success: function (result2) { $("#ButtonsPartial").html(result2); }
        });
        $("#Partial_Chem_Analysis").html(result);
    }
});
</script>

<section>
<div id ="ButtonsPartial" title="ButtonsPartial">
    @Html.Action("ButtonsPartial", "Home")
</div>
<div id="Partial_Chem_Analysis" title="Partial_Chem_Analysis">
    @Html.Action("PartialChemAnalysis", "Home", Model)
</div>
</section>
<section> 
```

部分观点：

```
@using System.Data;
@using System.Dynamic;
@using System.Collections.Generic;
@using System.Linq;
@model TheManhattanProject.Models.ButtonsModel

<div id="Chem_Buttons">
<h2 class="alignleft">Chemistry Table</h2>
<p class="alignright">Heat Name<input type="text" name="heat_name" value="@Model.heatName" class="search-query" placeholder="Search" style ="width:100px" readonly="true"/>
<button class="btn btn-success" id="Change_Heat_Name" value="Change_Heat_Name" name="action:Change_Heat_Name" type="button"> Change Heat Name</button>
Grade<input type="text" name="heat_grade" value="@Model.grade" class="search-query" placeholder="Search" style="width:100px" readonly="true"/>
<button class="btn btn-success" id="ChangeHeatGrade" value="ChangeHeatGrade" name="action:Change_Grade" type="button">Change Grade</button>
Delete Record<input type="text" name="delete_record" value="@Model.heatName" class="search-query" placeholder="Search" style ="width:100px" readonly="true"/>
<button class="btn btn-success" id="DeleteRecord" value="DeleteRecord" name="action:Delete_Record" type="button">Delete Record</button>
  </p>
  <div style="clear: both;"></div>
  </div>
<div id="HeatNameDiv" title="Change Heat Name">
    @using (Html.BeginForm("ChangeHeatName", "Home", "POST"))
   {
    <section>
        Heat Name:<input type="text" name="heatName" value="@Model.heatName" style ="width:100px" readonly="true"/>
        //Value staying to what was entered not ""
        Change to:<input type="text" name="updatedHeat" value="" style="width: 100px" />
        <input type="button" id="ChangeHeatName" name="ChangeHeatName" value="Change" />
    </section>
}
</div>

<div id="HeatGradeDiv" title="Change Heat Grade">
@using (Html.BeginForm("ChangeGrade", "Home", "POST"))
{
    <section>
        Heat Grade:<input type="text" name="grade" value="@Model.grade" style ="width:100px" readonly="true"/>
        Change to:<input type="text" name="updatedGrade" value="" style="width: 100px" />
        <input type ="hidden" name="hiddenHeat" value ="@Model.heatName)" />
        <input type="button" id="ChangeGrade" name="ChangeGrade" value="Change" />
    </section>
}
</div>

<div id="DeleteRecordDiv" title="Delete Record">
@using (Html.BeginForm("DeleteRecord", "Home", "POST"))
{
<section>
    Heat Name:<input type="text" name="heatName" value="@Model.heatName" style ="width:100px" readonly="true"/>
    <input type="button" id="DeleteRecordBtn" name="DeleteRecordBtn" value="Delete" />
</section>
}
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:57:37.883

事件处理程序与被部分视图加载替换的原始按钮相关联。之后它没有处理程序，直到您再次注册它或第一次将点击处理程序注册到父 DOM 元素。

```
$(document).ready(function () {
    // instead of this
    $('#ChangeHeatName').click(function (e) {
        ...
    });

    // do this
    $("body").on("click", "#ChangeHeatName", function(e) {
        ...
    });
}); 
```

尝试`"body"`用尽可能接近重新加载的部分的静态 DOM 元素替换。

```
$("#ButtonsPartial").on("click", "#ChangeHeatName", function(e) {
    ...
}); 
```

# java - 如何在所有操作系统上强制使用 JFrame windows 主题

> ID：16202099
> 
> 赞同：1
> 
> 时间：2013-04-24T21:00:54.100
> 
> 标签：java, windows, macos, swing, jframe

我在为我的 java 应用程序开发 GUI 时遇到问题。我在 Windows 上开发并使用基于 Windows 的程序。但是，当 Mac 或 linux 操作系统上的用户使用 GUI 时，它具有不同的布局，并且某些字段被推离了框架。有没有办法强制 GUI 使用特定的系统主题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:53:32.610

关于 Look and Feel的[Swing 教程](http://docs.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html)有一些关于如何以编程方式设置 LnF 的非常好的示例。

简而言之，打电话

```
UIManager.setLookAndFeel("fully qualified name of the lnf"); 
```

在 main() 方法的开头。例如，如果你想使用跨平台的 LnF，你会使用

```
UIManager.setLookAndFeel(UIManager.getCrossPlatformLookAndFeelClassName()); 
```

# c# - 我如何知道是否打开了 WPF 窗口

> ID：16202101
> 
> 赞同：40
> 
> 时间：2013-04-24T21:01:05.023
> 
> 标签：c#, wpf, window

在 WPF 窗口中，我如何知道它是否已打开？

我的目标是当时只打开 1 个窗口实例。

所以，我在父窗口中的伪代码是：

```
if (this.m_myWindow != null)
{
    if (this.m_myWindow.ISOPENED) return;
}

this.m_myWindow = new MyWindow();
this.m_myWindow.Show(); 
```

编辑：

我找到了解决我最初问题的解决方案。窗口.ShowDialog();

它阻止用户打开任何其他窗口，就像模式弹出窗口一样。使用此命令，无需检查窗口是否已打开。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2013-04-25T01:07:15.430

在类`WPF`中有一个打开的集合`Windows`，`Application`您可以创建一个辅助方法来检查窗口是否打开。

这是一个示例，它将检查`Window`某个特定名称`Type`或`Window`具有特定名称的 a 是否已打开，或两者兼而有之。

```
public static bool IsWindowOpen<T>(string name = "") where T : Window
{
    return string.IsNullOrEmpty(name)
       ? Application.Current.Windows.OfType<T>().Any()
       : Application.Current.Windows.OfType<T>().Any(w => w.Name.Equals(name));
} 
```

用法：

```
if (Helpers.IsWindowOpen<Window>("MyWindowName"))
{
   // MyWindowName is open
}

if (Helpers.IsWindowOpen<MyCustomWindowType>())
{
    // There is a MyCustomWindowType window open
}

if (Helpers.IsWindowOpen<MyCustomWindowType>("CustomWindowName"))
{
    // There is a MyCustomWindowType window named CustomWindowName open
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-24T21:11:32.800

您可以检查是否`m_myWindow==null`并且只有在创建和显示窗口。当窗口关闭时，将变量设置回 null。

```
 if (this.m_myWindow == null)
    {
           this.m_myWindow = new MyWindow();
           this.m_myWindow.Closed += (sender, args) => this.m_myWindow = null;           
           this.m_myWindow.Show();
    } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-04-21T13:29:06.060

这是使用 LINQ 实现此目的的另一种方法。

```
using System.Linq;

...

public static bool IsOpen(this Window window)
{
    return Application.Current.Windows.Cast<Window>().Any(x => x == window);
} 
```

用法：

```
bool isOpen = myWindow.IsOpen(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-03-09T14:37:46.703

如果发现需要激活窗口，可以使用下面的代码：

```
//activate a window found
//T = Window

 Window wnd = Application.Current.Windows.OfType<T>().Where(w => w.Name.Equals(nome)).FirstOrDefault();
 wnd.Activate(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-24T21:35:54.310

在你的类中放置一个静态布尔值，命名`_open`或类似的东西。然后在构造函数中执行以下操作：

```
if (_open)
{
    throw new InvalidOperationException("Window already open");
}
_open = true; 
```

在 Closed 事件中：

```
_open = false; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-25T07:16:43.200

是你搜索的吗？

```
if (this.m_myWindow != null)
{
    if (this.m_myWindow.IsActive) return;
}

this.m_myWindow = new MyWindow();
this.m_myWindow.Show(); 
```

如果你想要一个单例，你应该阅读这个：[我们如何为一个窗口创建一个单例实例？](https://stackoverflow.com/questions/16056161/how-can-we-create-a-singleton-instance-for-a-window/16085504#16085504)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-29T02:10:01.257

```
 void  pencereac<T> (int Ops) where T : Window , new()
    {
        if (!Application.Current.Windows.OfType<T>().Any()) // Check is Not Open, Open it.
        {
           var wind = new T();
            switch (Ops)
            {
                case 1:
                    wind.ShowDialog();
                    break;
                case 0:
                    wind.Show();
                    break;
            }
        }
        else Application.Current.Windows.OfType<T>().First().Activate(); // Is Open Activate it.
    } 
```

库拉尼米：

```
void Button_1_Click(object sender, RoutedEventArgs e)
{
  pencereac<YourWindow>(1);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-05-12T21:33:51.803

如果您想检查第二个表单是否已经打开并避免在按钮单击时再次打开它，则此方法有效。

```
int formcheck = 0;
private void button_click()
{
   Form2Name myForm2 = new Form2Name();
   if(formcheck == 0)
   {
      myForm2.Show(); //Open Form2 only if its not active and formcheck == 0
      // Do Somethin

      formcheck = 1; //Set it to 1 indicating that Form2 have been opened
   {   
{ 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-12-04T17:40:53.680

```
public bool IsWindowOpen<T>(string name = "") where T : Window
{
    return Application.Current.Windows.OfType<T>().Any(w => w.GetType().Name.Equals(name));               
} 
```

# python - 如何在 Libre Office 中打开文件并将其保存为 .doc 文件？

> ID：16202103
> 
> 赞同：3
> 
> 时间：2013-04-24T21:01:10.570
> 
> 标签：python, libreoffice

如何在 Libre Office 中打开文件并将其保存为 .doc 文件？有可能的？（为此创建脚本）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T21:08:00.560

根据[`libreoffice`手册](http://manned.org/libreoffice.1)（作为命令行实用程序），您不需要 python，但`libreoffice`应该直接支持：

> **--convert-to** output_file_extension[:output_filter_name] [--outdir output_dir] file... 批量转换文件。如果未指定 --outdir，则当前工作目录用作已转换文件的输出目录。
> 
> 例子：
> 
>     **--转换为**pdf *.doc
> 
> 将所有 .doc 文件转换为 PDF。
> 
>     **--convert-to** pdf:writer_pdf_Export --outdir /home/user *.doc
> 
> 使用 Writer PDF 导出对话框中的设置将所有 .doc 文件转换为 PDF，并将它们保存在 /home/user 中。

如果您需要处理许多文件，您可以编写简单的 bash 脚本，如下所示：

```
for i in `find folder -type f -name *.lwp` ; do
    libreoffice --headless --convert-to doc:"MS Word 2003 XML" $i
done 
```

有关如何在[此处](http://ask.libreoffice.org/en/question/2641/convert-to-command-line-parameter/)或前面指定的手册中调用此命令的更多详细说明。

您基本上可以从 python 和执行相同的调用[`subprocess`](http://docs.python.org/3.2/library/subprocess.html)：

```
import os
import os.path
import subprocess

for i in os.listdir( SOURCE_FOLDER):
    if not i.endswith( '.lwp'):
        continue

    path = os.path.join( SOURCE_FOLDER, i)
    args = ['libreoffice', '--headless', '--convert-to',
            'doc:"MS Word 2003 XML"', path]

    subprocess.call(args, shell=False) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-13T13:19:03.087

在 win7 上，使用 LO 4.1 我必须执行以下操作（从命令行， 如果在 cmd 脚本中运行，您可能需要转换`%f`为）：`%%f`

```
set path=%path%;C:\Program Files (x86)\LibreOffice 4\program
for %f in (*.odt) do (
    soffice.exe --headless --convert-to doc --outdir "C:\tmp" %f
) 
```

笔记：

*   如果任何 LO 实例打开，它将不起作用！
*   outdir 是必需的
*   不支持输入文件的通配符（因此使用 for 循环）

相应的 python 脚本可能如下所示：

```
import os
import subprocess as sp

lo = r'C:\Program Files (x86)\LibreOffice 4\program\soffice.exe'

args = '--headless --convert-to doc --outdir "%(out)s" "%(inp)s"'

inp_path = './odt'
out_path = './doc'

inp_path = os.path.normpath(os.path.abspath(inp_path))
out_path = os.path.normpath(os.path.abspath(out_path))

for root, dirs, files in os.walk(inp_path):
  for fname in files:
    if fname.endswith('.odt'):
      i = os.path.join(inp_path,fname)
      sp.call(lo + ' ' + args%{'out': out_path, 'inp': i}) 
```

（从 ask.libreoffice 复制并修改了我的答案，也发布在[superuser](https://superuser.com/questions/207272/batch-convert-odg-to-ai-cdr-or-jpg/644864#644864 "超级用户")上）

# c# - 转换 EnumerableRowCollection 列出

> ID：16202104
> 
> 赞同：12
> 
> 时间：2013-04-24T21:01:12.007
> 
> 标签：c#, linq

我试图在一个函数中返回这个集合：

```
List<string> codes = ( from q in Data.AsEnumerable() select q.Field<string>("START") );
return codes; 
```

这会引发错误：

```
Cannot implicitly convert type 'System.Data.EnumerableRowCollection<string>' to 'System.Collections.Generic.List<string>' 
```

退回此类收藏的最佳方式是什么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-24T21:03:41.053

由于[EnumerableRowCollection<TRow>](http://msdn.microsoft.com/en-gb/library/bb907979.aspx)实现`IEnumerable<T>`了你可以`ToList()`在最后添加一个：

```
using System.Linq;

List<string> bankCodes = ( from q in QueueData.AsEnumerable() select q.Field<string>("START") ).ToList(); 
```

或者

```
List<string> bankCodes =  QueueData.AsEnumerable()
    .Select(r => r.Field<string>("START"))
    .ToList(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-24T21:03:51.017

您需要使用`.ToList()`将其转换为列表，因此请尝试这样的操作。

```
List<string> bankCodes = ( from q in QueueData.AsEnumerable() select q.Field<string>("START")).ToList(); 
```

# jquery - PhoneGap / JQM 事件在底部触发（网页视图）

> ID：16202112
> 
> 赞同：0
> 
> 时间：2013-04-24T21:01:49.203
> 
> 标签：jquery, cordova, jquery-mobile, jquery-waypoints

**如果用户通过滚动PhoneGap** / **JQM**达到底部，我想重新加载项目。

目前我正在使用这个解决方案：

```
$(window).scroll(function() {
  if($(window).scrollTop() + $(window).height() == $(document).height()) {    
     .. some action ..
  }
}); 
```

但是接缝好像不太稳定，有什么触发的事件可以用吗？这适用于Android和iOS？在我的 Galaxy 上，如果到达底部，我会看到某种蓝色边框弹出，但在**ADB**中没有看到任何事件名称......

任何提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T07:31:48.457

我可以帮助你用我的老例子。但是您需要修复它，以便它可以与 jQM 1.2 一起使用。

这是一个示例：http: [//jsfiddle.net/Gajotres/v4NxB/](http://jsfiddle.net/Gajotres/v4NxB/)。它远非完美的演示，但它可以为您提供足够的信息以正确使用它。

它使用这个 jQuery 插件来检测底部滚动触摸：http: [//imakewebthings.com/jquery-waypoints/#get-started](http://imakewebthings.com/jquery-waypoints/#get-started)

我用 jQM 1.0 构建了它

这将检测底端：

```
$('#example-offset-pixels').waypoint(function() {
    //notify('100 pixels from the top');
}, { offset: 100 }); 
```

**编辑 ：**

此版本适用于所有 jQM 版本，包括 1.3：http: [//jsfiddle.net/Gajotres/Bn2Du/](http://jsfiddle.net/Gajotres/Bn2Du/)。它使用纯 jQuery，不需要额外的框架。

# ruby-on-rails - “json”的未定义方法“路径”：soundcloud轨道上传期间的字符串

> ID：16202122
> 
> 赞同：0
> 
> 时间：2013-04-24T21:02:25.617
> 
> 标签：ruby-on-rails, soundcloud

在 Rails 应用程序中，我使用 SoundCloud gem ( [https://github.com/soundcloud/soundcloud-ruby](https://github.com/soundcloud/soundcloud-ruby) ) 使用以下代码将声音文件上传到 SoundCloud。该文件是使用文件类型输入从表单上传的。

```
def upload
  @api_response = @soundcloud.post('/tracks', :track => {
    :title => params[:title],
    :asset_data => params[:sound].tempfile
  })
end 
```

`@soundcloud`是在`before_filter`.

当我尝试上传文件时，我收到此错误：

```
NoMethodError (undefined method `path' for "json":String):
  app/controllers/api_controller.rb:223:in `upload' 
```

我很难理解错误的根本原因。对此的任何帮助都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-10T10:28:37.180

**试试这个代码。**

默认上传

```
 file = params[:sound]
   title = params[:title]
   track = client.post('/tracks', track: {
      title: title
      asset_data: File.new(file.tempfile, 'rb')
      }) 
```

结尾

# playframework - 如何从现有的 MySQL 模式生成 ebean 模型类（对于 Play 2.1）？

> ID：16202123
> 
> 赞同：1
> 
> 时间：2013-04-24T21:02:32.967
> 
> 标签：playframework, ebean

我第一次开始使用 Play 2.1 框架，我想将 ebean 用于 ORM 到 MySQL 5.1 数据库。

我已经使用 Play 2.1 文档成功配置了数据库连接，我想将我的数据库模式反向工程为 ebean 模型类，但似乎找不到任何方法来做到这一点。我已经读到可以为 1.2.x 执行此操作，但不能为 2.x 版本执行此操作。我已经尝试过 minuteproject 网站，但它似乎只支持 Play 1.2 实现。

我是Play和ebean的新手，我想知道我是否错过了一些基本的东西，否则有人能指出我正确的方向吗？
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:12:55.850

不幸的是，逆向工程模型在 Ebean 中是不可能的。你需要：

*   了解 Ebean 如何在某些测试项目上创建 DB 模式，只需...测试
*   创建能够与现有数据库表一起使用的模型。
*   可选择修改您的数据库结构以确保它对 Ebean 来说足够清晰

其他选项（如果可能）是使用 Ebean 插件的支持创建新的数据库结构，然后编写一些脚本（甚至使用 PHP）来迁移数据。

抱歉，如果不充分了解您现有的数据库，我实际上无法为您提供更好的解决方案，很难说哪种方法会更好。

# python - 如何以与 South 兼容的方式使用 UUIDField？

> ID：16202129
> 
> 赞同：1
> 
> 时间：2013-04-24T21:02:49.700
> 
> 标签：python, django, django-south, django-extensions

通常，我可以解决突然出现的数据库迁移，但这让我感到困惑。

我创建了一个新模型，以`UUIDField`(from `django-extensions`) 作为主键。

```
# BaseModelNamed is just a mixin which provides some basic fields
# e.g. name, description, slug, created, modified
class UUIDObject(BaseModelNamed):
    uuid = UUIDField(primary_key=True) 
```

我还有另一个模型指的是这个模型：

```
class ParentModel(BaseModelNamed):
    default_uuidobject = models.OneToOneField(UUIDObject,
        related_name='parent_model', blank=True, null=True)
    uuidobject_collection = models.ManyToManyField(UUIDObject,
        related_name='parent_models', blank=True, null=True) 
```

...以及自动生成的迁移：

```
def forwards(self, orm):
    # Adding model 'UUIDObject'
    db.create_table('app_uuidobject', (
        ('created', self.gf('django.db.models.fields.DateTimeField')(auto_now_add=True, null=True, blank=True)),
        ('last_modified', self.gf('django.db.models.fields.DateTimeField')(auto_now=True, null=True, blank=True)),
        ('name', self.gf('django.db.models.fields.CharField')(max_length=255, null=True, blank=True)),
        ('description', self.gf('django.db.models.fields.TextField')(null=True, blank=True)),
        ('slug', self.gf('django.db.models.fields.SlugField')(max_length=50, null=True, blank=True)),
        ('uuid', self.gf('django.db.models.fields.CharField')(max_length=36, primary_key=True)),
    ))
    db.send_create_signal('app', ['UUIDObject'])

    # Adding field 'ParentModel.default_uuidobject'
    db.add_column('app_parentmodel', 'default_uuidobject',
                  self.gf('django.db.models.fields.related.OneToOneField')(blank=True, related_name='parent_model', unique=True, null=True, to=orm['app.UUIDObject']),
                  keep_default=False) 
```

但是，当我尝试实际执行迁移时，我不断收到迁移错误：

```
django.db.utils.DatabaseError: (1005, "Can't create table 'db.#sql-819_2ed' (errno: 150)") 
```

从我破译的内容来看，跑步`SHOW ENGINE INNODB STATUS`可以提供对问题的更多洞察力，事实上，它揭示了这一点：

```
------------------------
LATEST FOREIGN KEY ERROR
------------------------
130424 20:34:02 Error in foreign key constraint of table ebdb/#sql-819_2ed:
 FOREIGN KEY (`default_uuidobject_id`) REFERENCES `app_uuidobject` (`uuid`):
Cannot find an index in the referenced table where the
referenced columns appear as the first columns, or column types
in the table and the referenced table do not match for constraint. 
```

**如何以与 South 兼容的方式使用 UUIDField？**

或者，我该如何解决这个迁移冲突？

目前，我正在使用以下软件包：

*   `django-extensions==0.9`
*   `South==0.7.6`
*   `Django==1.4.1`

**编辑：**
我尝试`db_index`在迁移中添加和创建索引，但都没有成功：

```
# ...
    ('uuid', self.gf('django.db.models.fields.CharField')(max_length=36, primary_key=True, db_index=True)),
))
db.create_index('app_uuidobject', ['uuid'], unique=True) 
```

# android - 如何模拟 ARM 处理器运行时环境并将 Linux 内核模块加载到其中？

> ID：16202130
> 
> 赞同：2
> 
> 时间：2013-04-24T21:02:55.240
> 
> 标签：android, linux, linux-kernel, gdb, arm

我尝试加载`vmlinux`并`gdb`使用 ARM 核心模拟器。

但我不明白为什么我会得到`Undefined target command: "sim".`：

这是外壳输出：

```
$ arm-eabi-gdb vmlinux
GNU gdb (GDB) 7.3.1-gg2
Copyright (C) 2011 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "--host=x86_64-linux-gnu --target=arm-linux-android".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from /repo/kernel/kernel/vmlinux...done.
(gdb) target sim
Undefined target command: "sim".  Try "help target".
(gdb) help target
Connect to a target machine or process.
The first argument is the type or protocol of the target machine.
Remaining arguments are interpreted by the target protocol.  For more
information on the arguments for a particular protocol, type
`help target ' followed by the protocol name.

List of target subcommands:

target core -- Use a core file as a target
target exec -- Use an executable file as a target
target extended-remote -- Use a remote computer via a serial line
target record -- Log program while executing and replay execution from log
target record-core -- Log program while executing and replay execution from log
target remote -- Use a remote computer via a serial line
target tfile -- Use a trace file as a target 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T14:39:30.087

Your process is correct as per this [email](http://www.sourceware.org/ml/crossgcc/2000-q1/msg00019.html) and the [gdb target command](http://sourceware.org/gdb/current/onlinedocs/gdb/Target-Commands.html) page in the manual.

However, the **gdb** configure script has an option *--disable-sim*. The [crosstool-ng](http://crosstool-ng.org/) project uses this [option by default](http://www.sourceware.org/ml/crossgcc/2012-01/msg00088.html). Most cross-compilers are build with this project ^(Note1) as it is a fairly lengthy process to do by hand. It is quite possible that your **gdb** does not have the *simulator* built in.

There doesn't seem to be a command line option to print the **gdb** configuration. However, running `strings -n 3 arm-eabi-gdb | grep -iw sim` should verify whether your **gdb** has the *sim* option or not; the command returns nothing if there is no *sim* option in the **gdb**.

**Note1:** At least, Linaro, Ubuntu, Debian, and Ltib use *crosstool-ng*. I am not sure about the Android suite.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-28T21:08:22.020

GDB 中的 ARM 模拟器不模拟能够运行 Linux 内核的 ARM 应用处理器，例如，我相信它不模拟内存管理单元。对于运行 Linux，请改用 QEMU 及其内置 gdb 服务器：https: [//plus.google.com/100386424363328269117/posts/RhdQmjz4gBJ](https://plus.google.com/100386424363328269117/posts/RhdQmjz4gBJ)

# sql-server - LINQ to SQL 并将其配置为不使用 TOP

> ID：16202136
> 
> 赞同：2
> 
> 时间：2013-04-24T21:03:03.593
> 
> 标签：sql-server, linq, linq-to-sql

我们在代码中使用带有 linq to sql 的 SQL Server 2005。

当在以下场景中使用 TOP 300 时，我们注意到速度下降（3 分钟而不是 4 秒返回 100 条记录）。

```
SELECT TOP (300) {fields HERE} FROM {database} WHERE {where clauses with a nested select} ORDER BY {order by values} 
```

这是由 linq 创建的，因为正在调用 .Skip(0).Take(300).ToList<>() 。

当调用 .Skip(300).Take(300).ToList<>() 时，linq 将其转换为 ROW_NUMBER 而不是 TOP 并消除了问题。

linq 是否有不使用 TOP 的解决方法？

我已经阅读了一些关于 TOP 问题的博客，即当您 TOP 获得 101 条或更多记录时，它使用 tempdb 进行排序而不是在内存中进行排序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:14:18.843

我们经常使用 TOP，以前从未遇到过性能问题。

也许您只是遇到“ARITHABORT 默认关闭”的问题？

在您选择之前致电：

```
new SqlCommand("SET ARITHABORT ON", connection).ExecuteNonQuery(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:24:03.613

我有一个电影数据库（其中注册了 50'000 部电影）。我将此列表带到网页的方式是寻呼机。逻辑完全在 SQL 中生成

```
WITH ct1 as
(
    SELECT ROW_NUMBER() OVER(ORDER BY some condition) num,
    {my fields}
)
SELECT {my fields} FROM ct1 
WHERE num BETWEEN (@PageNum - 1) * @ItemsPerPage + 1 
AND @PageNum * @ItemsPerPage 
```

超过 50'000 条记录只需不到一秒钟的时间。

# php - 将音频文件长度保存在数据库中

> ID：16202142
> 
> 赞同：2
> 
> 时间：2013-04-24T21:03:24.197
> 
> 标签：php, mysql, audio

我有将近 200 个 ogg 文件，我需要获取它们的音频长度并将其保存在数据库中。

我知道 PHP，但我认为我无法使用 PHP 和 MySQL 完成我的任务。

你能为我的问题推荐一个解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:26:22.800

如果您使用的是 linux / unix 并安装了 ffmpeg，请执行以下操作：

```
$time = exec("ffmpeg -i " . escapeshellarg($path) . " 2>&1 | grep 'Duration' | cut -d ' ' -f 4 | sed s/,//");
list($hms, $milli) = explode('.', $time);
list($hours, $minutes, $seconds) = explode(':', $hms);
$total_seconds = ($hours * 3600) + ($minutes * 60) + $seconds; 
```

如果没有，那么您应该查看一些支持此功能的库，也许[`this`](http://de3.php.net/manual/en/refs.utilspec.audio.php)像[`ogg`](http://de3.php.net/manual/en/refs.utilspec.audio.php)Kacey 提到的那样。

所以你可以使用类似的东西

```
KTaglib_MPEG_AudioProperties::getLength 
```

我的答案开头的代码最初是由 Stephen J. Fuhry 编写的，可以看到[`here`](https://stackoverflow.com/questions/3069574/get-the-length-of-an-audio-file-php)

# python - 密码期望表达式不匹配

> ID：16202150
> 
> 赞同：0
> 
> 时间：2013-04-24T21:03:41.163
> 
> 标签：python, unix, pexpect

我开始使用该`Pexpect`库，但由于某种原因，我在获取匹配的表达式时遇到了问题。

例如在下面的代码中

```
 import pexpect

   child=pexpect.spawn('su')
   i=child.expect_exact('Password:')
   print "value of i is %d" %i
   if i==1:
          p=input("Please enter root password : ")
          child.sendline(p)
          child.sendline('echo piggy') 
```

**问题** 我从不等于 1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:15:32.827

`su`不从终端调用时拒绝运行：

```
$回声废话| 苏
su：必须从终端运行

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T22:28:20.903

IMO，当 pexpect 是答案时，您问的是错误的问题。

在这种情况下，您可能可以更有效地使用 sudo。当由特定用户调用时，它可以配置为以 root 身份运行，而无需密码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T22:36:29.793

根据文档，当您将字符串传递给 expect_exact() 时，它在匹配时返回 0，而不是 1。

您是否尝试过将 i 与 0 进行比较？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T06:42:44.753

首先，您登录超级用户使用此评论，pxssh 是此类扩展 pexpect.spawn 以专门设置 SSH 连接。这添加了登录、注销和期待 shell 提示的方法。

```
import pexpect
import pxssh

hostname ='172.16.0.120 -p 2222'
username = 'root'  # must you login in super user add this line
password = 'zilogic'
host = pxssh.pxssh()
host.login (hostname, username, password)
host.logfile = open(logfile, "w")
host.sendline ('whoami') 
print host.before 
```

您将用于 pxssh 模块不需要 child.expect_exact('Password:')，此密码需要处理 pxssh 模块 请参阅此链接[Python: How can remote from my local pc to remoteA to remoteb to remote c using Paramiko](https://stackoverflow.com/questions/15818328/python-how-can-remote-from-my-local-pc-to-remotea-to-remoteb-to-remote-c-using/15831027#15831027)以及[如何使用 pexpect 在远程主机系统中登录超级用户（root）？](https://stackoverflow.com/questions/14895847/how-to-login-the-super-userroot-in-remote-host-system-using-pexpect)

# c++ - OpenCV 2.4.1 未定义的引用

> ID：16202156
> 
> 赞同：2
> 
> 时间：2013-04-24T21:04:00.963
> 
> 标签：c++, opencv, g++

[我最近按照本教程](http://www.samontab.com/web/2012/06/installing-opencv-2-4-1-ubuntu-12-04-lts/)在运行 Ubuntu 12.04（64 位）的桌面上安装了 OpenCV 2.4.1 ，但是每次我尝试编译代码时，即使包含使用预构建编译脚本的示例，我都会得到未定义的引用关于`cv`命名空间中的每个函数。

我目前正在尝试编译的代码是OpenCV 文档中的[这个示例。我尝试了 3 种不同的方法来编译此代码：](http://docs.opencv.org/doc/tutorials/introduction/linux_gcc_cmake/linux_gcc_cmake.html)

I- 按照文档站点的说明使用 CMake；

II- 通过以下命令使用 gcc 和 pkg-config：

```
gcc `pkg-config --cflags opencv` display_image.cpp `pkg-config --libs opencv` -o DisplayImage 
```

III-使用我自己的makefile并直接添加库和头文件路径：

```
CC = g++
INCLUDE = -I/usr/local/include -I/usr/local/include/opencv

LIBS = -L/usr/local/lib -lopencv_core -lopencv_highgui 

%: %.cpp 
    $(CC) -o $@ $< $(INCLUDE) $(LIBS) 
```

它们都产生相同的输出：

```
/tmp/ccufJQVm.o: In function `main':
display_image.cpp:(.text+0x9b): undefined reference to `cv::imread(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int)'
display_image.cpp:(.text+0x13f): undefined reference to `cv::namedWindow(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int)'
display_image.cpp:(.text+0x1a1): undefined reference to `cv::imshow(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, cv::_InputArray const&)'
collect2: ld returned 1 exit status
make: *** [display_image] Error 1 
```

我发现了一些与我相关的其他问题，但他们的解决方案都没有为我解决。我真的很想了解导致这些未定义引用的原因，因为所有库和标题都在它们应该在的位置.

任何形式的帮助都会以我永恒的爱和感激来回报。H546163809H

添加一些命令的回声以澄清问题：

```
$pkg-config --cflags opencv
-I/usr/local/include/opencv -I/usr/local/include 
$pkg-config --libs opencv
/usr/local/lib/libopencv_calib3d.so /usr/local/lib/libopencv_contrib.so /usr/local/lib/libopencv_core.so /usr/local/lib/libopencv_features2d.so /usr/local/lib/libopencv_flann.so /usr/local/lib/libopencv_gpu.so /usr/local/lib/libopencv_highgui.so /usr/local/lib/libopencv_imgproc.so /usr/local/lib/libopencv_legacy.so /usr/local/lib/libopencv_ml.so /usr/local/lib/libopencv_nonfree.so /usr/local/lib/libopencv_objdetect.so /usr/local/lib/libopencv_photo.so /usr/local/lib/libopencv_stitching.so /usr/local/lib/libopencv_ts.so /usr/local/lib/libopencv_video.so /usr/local/lib/libopencv_videostab.so 
```

现在添加更详细的编译输出（使用 -Wall 和 -v）

```
g++ -v -Wall -o display_image display_image.cpp -I/usr/local/include -I/usr/local/include/opencv -L/usr/local/lib -lopencv_core -lopencv_highgui  
Using built-in specs.
COLLECT_GCC=g++
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/4.6/lto-wrapper
Target: x86_64-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Ubuntu/Linaro 4.6.3-1ubuntu5' --with-bugurl=file:///usr/share/doc/gcc-4.6/README.Bugs --enable-languages=c,c++,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-4.6 --enable-shared --enable-linker-build-id --with-system-zlib --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.6 --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --enable-gnu-unique-object --enable-plugin --enable-objc-gc --disable-werror --with-arch-32=i686 --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
Thread model: posix
gcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu5) 
COLLECT_GCC_OPTIONS='-v' '-Wall' '-o' 'display_image' '-I' '/usr/local/include' '-I' '/usr/local/include/opencv' '-L/usr/local/lib' '-shared-libgcc' '-mtune=generic' '-march=x86-64'
/usr/lib/gcc/x86_64-linux-gnu/4.6/cc1plus -quiet -v -I /usr/local/include -I /usr/local/include/opencv -imultilib . -imultiarch x86_64-linux-gnu -D_GNU_SOURCE display_image.cpp -quiet -dumpbase display_image.cpp -mtune=generic -march=x86-64 -auxbase display_image -Wall -version -fstack-protector -o /tmp/ccDB7q8G.s
GNU C++ (Ubuntu/Linaro 4.6.3-1ubuntu5) version 4.6.3 (x86_64-linux-gnu)
    compiled by GNU C version 4.6.3, GMP version 5.0.2, MPFR version 3.1.0-p3, MPC version 0.9
GGC heuristics: --param ggc-min-expand=100 --param ggc-min-heapsize=131072
ignoring nonexistent directory "/usr/local/include/x86_64-linux-gnu"
ignoring nonexistent directory "/usr/lib/gcc/x86_64-linux-gnu/4.6/../../../../x86_64-linux-gnu/include"
ignoring duplicate directory "/usr/local/include"
  as it is a non-system directory that duplicates a system directory
#include "..." search starts here:
#include <...> search starts here:
 /usr/local/include/opencv
 /usr/include/c++/4.6
 /usr/include/c++/4.6/x86_64-linux-gnu/.
 /usr/include/c++/4.6/backward
 /usr/lib/gcc/x86_64-linux-gnu/4.6/include
 /usr/local/include
 /usr/lib/gcc/x86_64-linux-gnu/4.6/include-fixed
 /usr/include/x86_64-linux-gnu
 /usr/include
End of search list.
GNU C++ (Ubuntu/Linaro 4.6.3-1ubuntu5) version 4.6.3 (x86_64-linux-gnu)
compiled by GNU C version 4.6.3, GMP version 5.0.2, MPFR version 3.1.0-p3, MPC version 0.9
GGC heuristics: --param ggc-min-expand=100 --param ggc-min-heapsize=131072
Compiler executable checksum: 65b5171ac1bd7b3f07dbea6bdb24be3d
COLLECT_GCC_OPTIONS='-v' '-Wall' '-o' 'display_image' '-I' '/usr/local/include' '-I' '/usr/local/include/opencv' '-L/usr/local/lib' '-shared-libgcc' '-mtune=generic' '-march=x86-64'
 as --64 -o /tmp/cchdK0Uq.o /tmp/ccDB7q8G.s
COMPILER_PATH=/usr/lib/gcc/x86_64-linux-gnu/4.6/:/usr/lib/gcc/x86_64-linux-gnu/4.6/:/usr/lib/gcc/x86_64-linux-gnu/:/usr/lib/gcc/x86_64-linux-gnu/4.6/:/usr/lib/gcc/x86_64-linux-gnu/
LIBRARY_PATH=/usr/lib/gcc/x86_64-linux-gnu/4.6/:/usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/:/usr/lib/gcc/x86_64-linux-gnu/4.6/../../../../lib/:/lib/x86_64-linux-gnu/:/lib/../lib/:/usr/lib/x86_64-linux-gnu/:/usr/lib/../lib/:/usr/lib/gcc/x86_64-linux-gnu/4.6/../../../:/lib/:/usr/lib/
COLLECT_GCC_OPTIONS='-v' '-Wall' '-o' 'display_image' '-I' '/usr/local/include' '-I' '/usr/local/include/opencv' '-L/usr/local/lib' '-shared-libgcc' '-mtune=generic' '-march=x86-64'
 /usr/lib/gcc/x86_64-linux-gnu/4.6/collect2 --sysroot=/ --build-id --no-add-needed --as-needed --eh-frame-hdr -m elf_x86_64 --hash-style=gnu -dynamic-linker /lib64/ld-linux-x86-64.so.2 -z relro -o display_image /usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crt1.o /usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crti.o /usr/lib/gcc/x86_64-linux-gnu/4.6/crtbegin.o -L/usr/local/lib -L/usr/lib/gcc/x86_64-linux-gnu/4.6 -L/usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu -L/usr/lib/gcc/x86_64-linux-gnu/4.6/../../../../lib -L/lib/x86_64-linux-gnu -L/lib/../lib -L/usr/lib/x86_64-linux-gnu -L/usr/lib/../lib -L/usr/lib/gcc/x86_64-linux-gnu/4.6/../../.. /tmp/cchdK0Uq.o -lopencv_core -lopencv_highgui -lstdc++ -lm -lgcc_s -lgcc -lc -lgcc_s -lgcc /usr/lib/gcc/x86_64-linux-gnu/4.6/crtend.o /usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crtn.o
/tmp/cchdK0Uq.o: In function `main':
display_image.cpp:(.text+0x9b): undefined reference to `cv::imread(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int)'
display_image.cpp:(.text+0x13f): undefined reference to `cv::namedWindow(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int)'
display_image.cpp:(.text+0x1a1): undefined reference to `cv::imshow(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, cv::_InputArray const&)'
collect2: ld returned 1 exit status
make: *** [display_image] Error 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:22:32.807

你能指导我完成你的 OpenCV 安装过程吗？这意味着您的程序正在获取头文件但没有获取 opencv 库。可能是您的 opencv .so 文件未生成，或者它们不在系统路径中。如果文件生成正确，请检查您的构建文件夹。如果 OpenCV 编译正确，请导出构建位置的路径，然后尝试编译。`pkg-config --cflags opencv`您可以通过回显和来检查您的系统是否能够找到 opencv 安装位置`pkg-config --libs opencv`。如果其中任何一个没有打印适当的值，您可能必须导出该位置。如果您错过了任何安装步骤，请[在此处查看。](http://varuagdiary.blogspot.in/2011/09/installing-opencv-23-on-ubuntu-1104.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:34:28.330

我的猜测是您缺少一些 *`-dev`包。本教程一开始就列出了一大堆，根据我的经验，这些通常是编译失败的直接原因。不幸的是，您可以从编译器获得间接消息。我猜您提到的错误消息只是构建输出的尾部，这可能与真正的原因相去甚远。您需要做的是重定向构建输出（`tee`您可以将其拆分并在控制台上查看并获取构建日志），或者您已经有了构建日志。研究构建日志并查看第**一个**或**第二个**编译过程中出现的错误信息。这可以更好地指示缺少的库或开发包。这只是一个猜测，指导方针。向我们提供整个构建日志。如果输出那么短，请尝试增加输出详细程度。另外，我可能完全错了。

我比较了@Gaurav Raj 链接的 Ubuntu 11.04 教程和您的 Ubuntu 12.04 教程。我会尝试安装这些软件包：

*   libpng12-dev
*   libpng++-dev
*   libpng3
*   libpnglite-dev
*   libpngwriter0-dev
*   zlib1g-dbg
*   zlib1g-dev
*   工具
*   libjpeg8-dev
*   libjpeg8-dbg
*   libjpeg-progs
*   ffmpeg
*   libgstreamer0.xy-0-dbg（xy 应该是 Ubuntu 12.04 的版本，这可能比 Ubuntu 11.04 的 0.10 版本更新）
*   libgstreamer0.xy-dev
*   libxine-dev
*   libunicap2-dev
*   痛饮
*   libdc1394-utils

在安装它们之前，您可以通过说来检查它们是否已安装`dpkg -l | grep ${pkg_name_to_check}`。

# android - 需要帮助更改网格视图中项目的背景颜色 - Android

> ID：16202159
> 
> 赞同：2
> 
> 时间：2013-04-24T21:04:10.643
> 
> 标签：android, gridview, setbackground

我目前有一个gridview

```
GridView gv;
         gv = (GridView)findViewById(R.id.gridView);
         gv.setNumColumns(RowsSplit[0].length());
         gv.setAdapter(new CustomAdapterClass(this, result)); 
```

结果是一个字符串数组。

然后我希望能够更改网格内某些项目的背景颜色。

```
for (int i : CorrectLetters)
{
    int temp2 = i;
    gv.getChildAt(temp2).setBackgroundColor(Color.CYAN);        
} 
```

CorrectLetters 是一个数字数组，它们是我想要更改颜色的网格中项目的位置。

我得到的错误是，当它到达 foreach 循环时，gridview 中没有子级，因此它会引发空异常错误。

但是，如果我将 foreach 循环放入 onclick 事件中，如下所示，一切正常，

```
gv.setOnItemClickListener(new OnItemClickListener() 
  {        
            public void onItemClick(AdapterView<?> parent, View v, int position, long id) 
            {  
                    //do stuff here
                 }
   } 
```

所以我的问题是如何让这个 foreach 循环在 onclick 侦听器之外工作？

# xml - 编组 XML Go XMLName + xmlns

> ID：16202170
> 
> 赞同：10
> 
> 时间：2013-04-24T21:05:00.913
> 
> 标签：xml, go, marshalling

我正在尝试实现以下 XML 输出

```
<?xml version="1.0" encoding="UTF-8"?>

<CreateHostedZoneRequest xmlns="https://route53.amazonaws.com/doc/2012-12-12/">
   <Name>DNS domain name</Name>
   <CallerReference>unique description</CallerReference>
   <HostedZoneConfig>
      <Comment>optional comment</Comment>
   </HostedZoneConfig>
</CreateHostedZoneRequest> 
```

我有以下输出非常接近的 XML 但是我无法编码到 CreateHostedZoneRequest

> xmlns="https://route53.amazonaws.com/doc/2012-12-12/

```
package main

import "fmt"
import "encoding/xml"

type ZoneRequest struct {
  Name            string
  CallerReference string
  Comment         string `xml:"HostedZoneConfig>Comment"`
}

var zoneRequest = ZoneRequest{
  Name:            "DNS domain name",
  CallerReference: "unique description",
  Comment:         "optional comment",
}

func main() {
  tmp, _ := createHostedZoneXML(zoneRequest)
  fmt.Println(tmp)
}

func createHostedZoneXML(zoneRequest ZoneRequest) (response string, err error) {
  tmp := struct {
    ZoneRequest
    XMLName struct{} `xml:"CreateHostedZoneRequest"`
  }{ZoneRequest: zoneRequest}

  byteXML, err := xml.MarshalIndent(tmp, "", `   `)
  if err != nil {
    return "", err
  }
  response = xml.Header + string(byteXML)
  return
} 
```

[http://play.golang.org/p/pyK76VPD5-](http://play.golang.org/p/pyK76VPD5-)

如何将 xmlns 编码到 CreateHostedZoneRequest 中？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-12-18T11:31:11.607

我有一个类似的问题。Unmarshal 方法的文档（[http://golang.org/pkg/encoding/xml/#Unmarshal](http://golang.org/pkg/encoding/xml/#Unmarshal)）有：

> 如果 XMLName 字段具有“名称”或“名称空间-URL 名称”形式的关联标记，则 XML 元素必须具有给定的名称（以及可选的名称空间），否则 Unmarshal 将返回错误。

在 struct 标签中使用“namespace-URL name”：

```
type ZoneRequest struct {
    XMLName  xml.Name `xml:"https://route53.amazonaws.com/doc/2012-12-12/ CreateHostedZoneRequest"`
} 
```

应该产生：

```
<CreateHostedZoneRequest xmlns="https://route53.amazonaws.com/doc/2012-12-12/"> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-24T21:16:18.943

你可以这样做，这可能不是最优雅的解决方案，但似乎有效

[游乐场链接](http://play.golang.org/p/uqVEdMQipZ)

```
type ZoneRequest struct {
    Name            string
    CallerReference string
    Comment         string `xml:"HostedZoneConfig>Comment"`
    Xmlns           string `xml:"xmlns,attr"`
}

var zoneRequest = ZoneRequest{
    Name:            "DNS domain name",
    CallerReference: "unique description",
    Comment:         "optional comment",
    Xmlns:           "https://route53.amazonaws.com/doc/2012-12-12/",
} 
```

生产

```
<?xml version="1.0" encoding="UTF-8"?>

<CreateHostedZoneRequest xmlns="https://route53.amazonaws.com/doc/2012-12-12/">
   <Name>DNS domain name</Name>
   <CallerReference>unique description</CallerReference>
   <HostedZoneConfig>
      <Comment>optional comment</Comment>
   </HostedZoneConfig>
</CreateHostedZoneRequest> 
```

# asp.net-web-api - 如何从头开始构建 ASP.NET Web API？

> ID：16202171
> 
> 赞同：2
> 
> 时间：2013-04-24T21:05:01.530
> 
> 标签：asp.net-web-api

我刚刚开始使用 ASP.NET Web API。

虽然我没有反对模板之类的东西，但我更愿意至少在信任为我生成的代码之前准确了解幕后发生的事情。

我很难找到任何可以从头开始构建 ASP.net WEB API 的指南，而没有 MCV Web API 项目模板提供的任何脚手架。

所以我的问题是：Web API 的哪些部分是启动和运行 API 的基本代码？

另外，如果有一个指南我找不到有人可以指向我，那也将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T01:43:22.537

这里有一点可以帮助您入门：

1.  创建一个新的控制台应用程序
2.  安装“Microsoft ASP.NET Web API Self Host”NuGet 包
3.  将此代码添加到您的 Main 方法中：

```
public static void Main()
{
    string baseAddress = "http://localhost:12345/";
    HttpSelfHostConfiguration config = new HttpSelfHostConfiguration(baseAddress);
    config.Routes.MapHttpRoute("Default", "api/{controller}");

    HttpSelfHostServer server = new HttpSelfHostServer(config);
    server.OpenAsync().Wait();

    Console.ReadKey();

    server.CloseAsync().Wait();
} 
```

4\. 创建一个新的控制器类：

```
public class HelloWorldController : ApiController
{
    public string Get()
    {
        return "Hello World";
    }
} 
```

5\. 运行您的应用程序并将您最喜欢的 HTTP 客户端指向`http://localhost:12345/api/helloworld`. 我建议使用 Fiddler 的作曲家，但浏览器也应该可以工作。

注意：这仅适用于 VS，如果您以管理员权限启动它。如果您没有以管理员权限运行，则可能需要添加以下行：

```
config.HostNameComparisonMode = HostNameComparisonMode.Exact; 
```

这说明了如何在应用程序中自己启动 HTTP 服务器。Web 托管 Web API 略有不同，主要区别在于您将使用 GlobalConfiguration.Configuration 静态配置 API，而不是像上面那样创建 HttpSelfHostConfiguration 对象。

# matlab - 使用 Matlab 在 FMI 工具箱块中设置初始值

> ID：16202180
> 
> 赞同：1
> 
> 时间：2013-04-24T21:05:35.943
> 
> 标签：matlab, simulink, fmi

（这个问题和我之前发过的问题差不多，但是情况变了……）

我正在使用 Dymola/Simulink 接口的 Modelon FMI 工具箱将 Model-Exchange 类型的 fmu 文件（1.0 版）导入 Simulink 模型。我有一个 Matlab m 文件，它以编程方式依次模拟模型，保存模型的最终内部状态以在下一次模拟中进行初始化。

m文件中的模拟调用是：

```
simOut_itr = sim(model, model_cs); 
```

其中“model”是 Simulink .slx 模型文件，“model_cs”是 Simulink 配置设置变量。我已经设置了配置，以便模型从工作区加载初始状态，并且我已经将之前的迭代最终状态保存到该工作区变量。

但是，当我运行我的代码时，模型中没有设置初始化值，并且仿真结果表明，每次运行仿真时，模型输出都会重置为其初始值。这种行为向我表明，状态没有使用工作区变量值进行初始化，但在模拟过程中没有设置错误。我已经确认为每次迭代加载和卸载模型没有帮助。

非常感谢有关在 Matlab/Simulink 中的 fmu 文件中初始化系统状态的任何建议。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T23:44:51.907

Simulink 中的 FMI 工具箱模块不会通过对模型 (sim) 的调用来设置其初始化值，而是通过一组特定于 FMI 工具箱的单独函数来设置它的初始化值。FMI 工具箱手册有更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T08:12:50.100

fmuSetValueSimulink() 是要使用的函数。这用于设置状态变量的参数值和起始值。该函数的帮助部分信息量很大，所以我不会在这里详细介绍。

# perl - 无法使用 perl switch 语句对同一子例程进行递归调用

> ID：16202188
> 
> 赞同：-1
> 
> 时间：2013-04-24T21:05:59.837
> 
> 标签：perl, recursion, switch-statement

我正在使用 switch 语句来检查终端上提供的参数。如果最终用户提供，则提供的脚本工作正常

```
 $perl test.pl -help 
```

但是当用户给出下面的选项时，它的子程序不会被递归调用。

```
 $perl test.pl -link abc -web test.com 
```

请建议！

```
 use Switch;
      #perl test.pl -help
      #perl test.pl -link abc -web test.com

      sub CheckArgument {

       my ($argv)   = shift @_;
       local $\     = "\n";
       print "\$argv : $argv\n";

       switch($argv) {
                  case /-help/ {
                             print "Usage : $0 -link <link name> -web <website name>";
                             print "Usage : $0 -list_web_name";
                             exit;
                  }
                  case /-list_web_name/ {
                             print "Currently Support following site";
                             foreach (qw/abc/) {
                                        print "$_";
                              }
                             exit;
                   }
                  case /-link/ {
                             CheckArgument($ARGV[3]);
                  }
                  case /-web/ {
                             print "argument provided : @ARGV\n";       
                  }
                  default {
                             CheckArgument("-help");
                  }
        }
       } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T21:25:27.280

[Switch](http://search.cpan.org/perldoc?Switch)是一个实验模块，不适合实际使用。5.10 引入了`given`/形式的 switch 语句`when`。

顺便说一句，您可能希望查看[Getopt::Long](http://search.cpan.org/perldoc?Getopt%3a%3aLong)以更好地处理其中一些工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T22:06:00.403

首先，`Switch`不推荐使用源过滤器。请不要使用它。

这是您的代码的重写，没有递归，可能更容易理解：

```
use 5.010;
sub CheckArgument {
  my $_ = shift;

  ARG: {
    if (/-help/) {
      say "Usage: $0 -link <link-name> -web <website-name>";
      say "Usage: $0 -list_web_name";
    } elsif (/-list_web_name/) {
      say "Currently supporting following sites:";
      say for qw/a b c/;
    } elsif (/-link/) {
      $_ = $ARGV[3];
      redo ARG;
    } elsif (/-web/) {
      say "arguments provided : @ARGV\n";       
    } else {
      $_ = "-help";
      redo ARG;
    }
  }
  exit;
} 
```

如果我们设置`@ARGV`为`qw/ -link x y -web/`，并使用 as 参数调用该 sub `@ARGV`，我们将得到以下输出：

```
arguments provided : -link x y -web 
```

首先，我们来看`-link`。这导致我们将第四个元素放入`@ARGV`我们正在查看的变量中。这将保持`-web`下一次迭代，它将输出所有命令行参数。这种解析策略绝不是健壮的。

比递归更好的是在您有未处理的参数时循环。如果您识别出某个开关，请从 arglist 中删除该开关及其值。当您不理解参数时，请打印用法：

```
use 5.010;
# I use 5.010 for the C<say> function, but if we're already using it,
# we could just as well use given/when. Wouldn't make it much prettier.
sub ProcessArguments {
  ARG: while (@_) {
    my $_ = shift;
    if (/\A-?-list_web_name\z/) {
      say "Currently supporting following sites:";
      say for qw/a b c/;
    } elsif (/\A-?-link\z/) {
      my $link_name = shift;
      shift() =~ /\A-?-web\z/ or do { Usage(); exit };
      my $website_name = shift;
      do_something_with($link_name, $website_name);
    } elsif (/\A-?-web\z/) {
      my $website_name = shift;
      shift() =~ /\A-?-link\z/ or do {Usage(); exit };
      my $link_name = shift;
      do_something_with($link_name, $website_name);
    } else {
      Usage();
      exit;
    }
  }
}
sub Usage {
  say "Usage: $0 -link <link-name> -web <website-name>";
  say "Usage: $0 -list_web_name";
} 
```

哦，这个可怕的样板，无休止的重复。如果有人已经写了一个已经为我们提供选择的东西，那不是很好吗？比如，CPAN 模块？

```
use Getopt::Long;
use 5.010;
sub ProcessArguments {
  my $list_web_name;
  my $help;
  my ($link_name, $website_name);
  GetOptions
    'list-web-name' => \$list_web_name,
    'help'          => \$help,
    'link=s'        => \$link_name,
    'web=s'         => \$website_name;
  if ($help) {
      Usage();
  } elsif ($list_web_name) {
      say "Currently supporting following sites:";
      say for qw/a b c/;
  } elsif (defined $link_name and defined $website_name) {
      do_something_with($link_name, $website_name);
  } else {
      Usage();
  }
} 
```

这就是它的完成方式。

# java - Java 字符串拆分/操作

> ID：16202190
> 
> 赞同：1
> 
> 时间：2013-04-24T21:06:10.543
> 
> 标签：java, arrays, string, split

我需要在 Java 中编写一个方法，该方法可以接受一个字符串文本参数和一个返回字符串数组的字符串“正则表达式”参数数组。

我希望返回的 Array 基本上可以执行该`String.split`操作，但是使用多个 String 正则表达式，而不是剥离正则表达式，而是将其保留在数组中。

例子：
`Input: "int a=10; a++;"`
`Regexes: "int", ";", "++", "="`
`Output: "int", " a", "=", "10", ";", " a", "++", ";"`

我尝试了一些事情，包括以下内容，但都没有奏效

```
public static String[] splitIntoBits(String in, String[] regex)
{
    List<String> bitList = new ArrayList<String>();

    for(int i = 0; i < in.length(); i++)
    {
        int lastIndex=0;
        //Check that character against all regexes
        for(int j = 0; j < regex.length; j++)
        {   
            if(in.substring(i).startsWith(regex[j]))
            {
                bitList.add(in.substring(lastIndex, i));
                lastIndex=i;
            }
        }
    }

    return bitList.toArray(new String[0]);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:19:13.793

您可以构造一个正则表达式来匹配参数中的所有正则表达式，然后使用.`Matcher.find()`跟踪先前匹配项的结束索引`end()`。

注意：在下面的代码中，我展示`Pattern.quote(r)`了处理“++”（这是一个无效的正则表达式模式）。如果您确实支持正则表达式作为参数，只需删除该调用。

```
 String[] regex = { "int", ";", "++", "=" };
    StringBuilder pattern = new StringBuilder();
    for (String r : regex) {
        pattern.append('|').append(Pattern.quote(r));
    }

    String input = "int a=10; a++;";
    Matcher m = Pattern.compile(pattern.substring(1)).matcher(input);
    // e.g. m = Pattern.compile("int|;|\\+\\+|=").matcher(input);
    List<String> result = new ArrayList<String>();
    for (int i=0 ; m.find() ; i = m.end()) {
        if (i != m.start()) {
            result.add(input.substring(i, m.start()));
        }
        result.add(m.group(0));
    }
    String[] array = result.toArray(new String[result.size()]); 
```

# c# - Visual Studio 2012 测试资源管理器测试正在进行中

> ID：16202196
> 
> 赞同：6
> 
> 时间：2013-04-24T21:06:32.460
> 
> 标签：c#, visual-studio, visual-studio-2012, test-explorer

在 Visual Studio 2010 中，测试结果视图能够显示当前正在进行的单元测试。在使用 Visual Studio 2012 时，我无法识别正在测试资源管理器中执行的单元测试。如何识别 Visual Studio 2012 测试资源管理器中正在进行的单元测试？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-08T17:59:35.997

的接口`ITestExecutor`是单元测试插件的必需接口，它表明 RunTests 的上下文为`IFrameworkHandle`

```
public interface ITestExecutor
{
   void RunTests(IEnumerable<string> sources, IRunContext runContext, IFrameworkHandle frameworkHandle);
   void RunTests(IEnumerable<TestCase> tests, IRunContext runContext, IFrameworkHandle frameworkHandle);
   void Cancel();
} 
```

`IFrameworkHandle`有记录测试状态的方法

```
RecordStart(TestCase testCase)
RecordResult(TestResult testResult)
RecordEnd(TestCase testCase, TestOutcome testOutcome) 
```

因此，测试窗口可能会在测试运行时显示一个图标。但是，我使用向导为 MS-Test 创建的类库构建了一个测试夹具，因为我希望它是所有运行程序中功能最完整的。我添加了以下测试类

```
[TestClass]
public class UnitTest1
{
    [TestMethod]
    public void TestMethod1()
    {
        Thread.Sleep(10000);
        Assert.IsTrue(true);
    }
} 
```

没有迹象表明测试运行了 10 秒。所以我想说VS2012的[Update 3 RC]测试窗口没有显示当前正在运行的测试。考虑到单元测试框架的 API，未来的更新可能会改善这种情况。

# mysql - 如果我选择多于一列，Mysql 的 EXPLAIN 会显示“使用文件排序”，如果没有选择则显示“使用索引”

> ID：16202199
> 
> 赞同：0
> 
> 时间：2013-04-24T21:06:52.047
> 
> 标签：mysql, sql

我有一张类似这样的表格（为了便于解释，我删除了很多字段）。orderId 是一个 int 非唯一值，用于显示一行的重要性（我在返回数据时按它排序）

```
CREATE TABLE `my_images` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `orderId` int(11) NOT NULL,
  `slug` varchar(50) NOT NULL,
  `imageFilename` varchar(255) NOT NULL,
  `thumb200` varchar(255) NOT NULL,
  `thumb600` varchar(255) NOT NULL,
  `md5hash` varchar(255) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `orderId` (`orderId`),
  KEY `thumb600` (`thumb600`),
  KEY `slug` (`slug`),
  KEY `multiple_1` (`md5hash`,`orderId`,`thumb200`,`thumb600`),
  KEY `md5hash` (`md5hash`),
  KEY `thumb200` (`thumb200`),
  KEY `thumb200_2` (`thumb200`,`orderId`),
  KEY `orderId_2` (`orderId`,`thumb600`,`thumb200`),
  KEY `thumb600_2` (`thumb600`,`orderId`),
  KEY `thumb600_3` (`thumb600`,`orderId`),
  KEY `orderId_3` (`orderId`,`thumb600`),
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

是的 - 有很多索引涵盖 orderId。它混合了尝试解决当前问题的方法，并且因为我在 WHERE 语句中使用了这些字段。

无论如何，如果我运行此命令：

```
explain SELECT id FROM my_images
 ORDER BY orderId asc 
```

它输出这个（“使用索引”）

```
id  select_type table   type    possible_keys   key key_len ref rows    Extra
1   SIMPLE  my_images   index   NULL    orderId 4   NULL    174553  Using index 
```

这是预期的 - orderId 是一个索引。

但如果我这样做：

```
explain SELECT id,   thumb600, imageFilename,  slug FROM my_images
 ORDER BY orderId asc 
```

它输出这个（使用文件排序）：

```
id  select_type table   type    possible_keys   key key_len ref rows    Extra
1   SIMPLE  my_images   ALL NULL    NULL    NULL    NULL    174553  Using filesort 
```

奇怪的是，如果我这样做

```
explain SELECT id,  md5hash  FROM my_images
 ORDER BY orderId asc 
```

它说“使用索引；使用文件排序”

```
id  select_type table   type    possible_keys   key key_len ref rows    Extra
1   SIMPLE  my_images   index   NULL    multiple_1  775 NULL    174553  Using index; Using filesort 
```

我注意到的原因是因为我看到了一个缓慢的查询，它基本上是“选择（一堆字段） order by orderId limit 4000,3 ”，这需要很长时间，在运行解释命令后看到了。有什么办法让它总是使用索引？我是否必须创建一个包含我选择的所有字段的索引？如果是这样，索引中字段的顺序是否重要？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:23:52.397

如果您选择索引未涵盖的列，引擎将不得不进行表查找以获取这些列的值。

由于您无论如何都在选择整个表（不使用`WHERE`or `LIMIT`），因此顺序扫描表然后对其进行排序会更快，而不是进行大量的键搜索。

此外，`MySQL`不能进行后期行查找，这意味着它总是在计算偏移量之前查找表，即使使用索引也是如此。

如果您按表中的非 PK 字段排序`InnoDB`，请尝试以下操作：

```
SELECT  i.*
FROM    (
        SELECT  id
        FROM    my_images
        ORDER BY
                orderId
        LIMIT   4000, 3
        ) q
JOIN    my_images i
ON      i.id = q.id 
```

请参阅我的博客中的这篇文章以获得解释：

*   [**MySQL ORDER BY / LIMIT 性能：延迟行查找**](http://explainextended.com/2009/10/23/mysql-order-by-limit-performance-late-row-lookups/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T21:49:15.143

添加索引顺序 ID，然后添加您想要作为索引的列

问题是当您添加其他列时，文件排序就像便笺一样，它必须重新收集它们

但是，如果您在索引中有列（它必须是一个具有 4-6 列的索引），因为每个查询将只使用一个索引。列将一起去兜风

# java - Javassist 的 CtMethod.insertAt(line,src) 在错误的字节码位置检测代码

> ID：16202204
> 
> 赞同：0
> 
> 时间：2013-04-24T21:07:08.227
> 
> 标签：java, instrumentation, javassist, javaagents

我的目标是在每个基本代码块的开头插入一点检测代码。使用 Javaassist 的 ControlFlow.Block 和 CtMethod.insertAt() 似乎是一项相当简单的任务。到目前为止，这是相关的代码块（它位于转换函数中）：

```
ControlFlow flow=new ControlFlow(m); //m is the CtMethod currently being instrumented
Block[] blockArray=flow.basicBlocks();
for(Block thisbb : blockArray){

    //Dynamically Update Method Statistics
    String blockUpdate=new String();
    String thisbbIndex=Integer.toString(thisbb.index());

    blockUpdate+=mse+".setBlockIndex("+thisbbIndex+"); ";
    blockUpdate="{ " + blockUpdate + "} ";

    //Insert
    int pos=m.getMethodInfo().getLineNumber(thisbb.position()); //Source code line position from binary line position
    System.out.print("At "+pos+": "+blockUpdate);
    int n=m.insertAt(pos, blockUpdate);
    System.out.println(" -> "+n);
} 
```

注意其中的“line”参数`CtMethod.insertAt(line,srcCode)`是*源代码*行位置，而不是*字节码*行位置。在*源代码*中，一些基本块报告了相同的行号！这是输出：

```
At 6: { _JDA_mse.setBlockIndex(0); }  -> 6
At 8: { _JDA_mse.setBlockIndex(1); }  -> 8
At 8: { _JDA_mse.setBlockIndex(2); }  -> 8
At 8: { _JDA_mse.setBlockIndex(3); }  -> 8
At 8: { _JDA_mse.setBlockIndex(4); }  -> 8
At 8: { _JDA_mse.setBlockIndex(5); }  -> 8
At 8: { _JDA_mse.setBlockIndex(6); }  -> 8 
```

`At #`表示我请求放置代码`-> #`的位置， 表示它在源代码中实际插入的位置（如果一切正常，它们应该是相同的）。其中的所有内容都是`{ ... }`我想要放置的代码（`_JDA_mse`是我使用 Javassist 方法添加到函数中的局部变量，因此使用它没有问题）。

问题在于它`for(int i=0; i<size; ++i)`包含多个在源代码中不可分割但在字节码中明显不同的基本块。这就是为什么多个基本块被映射到同一源代码行的原因，它只是表明源代码行没有提供足够的检测精度来记录基本块。 **有没有办法模拟 CtMethod.insertAt(bytecodePosition,srcString) 而不是使用提供的 CtMethod.insertAt(sourceLine,srcString)？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T08:05:30.200

如果您需要使用 Javaassist 插入的变量在字节码级别进行检测，请参阅[此解决方法。](https://stackoverflow.com/questions/16248610/basic-block-logging-in-java-using-javaagents?lq=1)

# c++ - 做...虽然不会停止

> ID：16202208
> 
> 赞同：-1
> 
> 时间：2013-04-24T21:07:23.460
> 
> 标签：c++, arrays, do-while

所以我正在为一项任务制作一个程序，目前我正在尝试获取用户输入并尝试使其适合某种形式。

例如，用户要输入格式为 mm/yyyy 的日期。如果用户没有以该格式键入它，它只会重新提示用户。

到目前为止，这是我的小循环：

```
#include <iostream>
#include <cstring>
#include <string>
using namespace std;

int findSlash(char[], int);
int findLastEle(char[]);

int main() {
//variables
char expDate[7];
int expLast, expEle;
int expLen;

do{
cout << "Enter experation (form mm/yyyy): ";
cin.getline(expDate, 7);
expLen = strlen(expDate);
expEle = findSlash(expDate, expLen);
expLast = findLastEle(expDate);

}while(expEle != (expLast - 4));

return 0;
}

//findSlash function (finds slash place in array)
int findSlash(char array[], int arrayLen){
int r, dec = 0;

for(r = 0; r < arrayLen; r++){
    if(array[r] == '/'){
        break;
    }
    else{
        dec++;
    }
}

return dec;
} 
```

如果'/'不在正确的位置，则循环假设此时只是重新提示，但循环只是向 cout 语句发送垃圾邮件，我不知道它为什么这样做。任何帮助将不胜感激：D

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T21:11:51.597

`cin.getline(expDate, 7)`, 如果没有找到换行符，最多会提取 6 个字符，并用空字符`cin`填充 的最后一个元素。`expDate`那是因为第二个参数只在第一个参数中给出缓冲区的大小，这样它就不会超过缓冲区的末尾。当`getline`由于达到缓冲区限制而停止提取时，它将失败位设置为真。任何进一步的提取尝试都将立即失败。

要将整个日期（长度为 7 个字符）与空字符一起放入数组中，您需要数组的大小至少为`8`元素，并将该大小传递给`getline`.

但是，你最好使用这样的`std::string`版本`getline`：

```
string expDate;
do{
  cout << "Enter experation (form mm/yyyy): ";
  getline(cin, expDate);
  // ...
}while(expEle != (expLast - 4)); 
```

现在您不必担心缓冲区溢出。

# jquery - 在函数外访问 jQuery 脚本

> ID：16202210
> 
> 赞同：2
> 
> 时间：2013-04-24T21:07:31.807
> 
> 标签：jquery

我像这样激活一个 jQuery 脚本：

```
$('#an-id').drawbox(); 
```

这是 jQuery 脚本（重要部分）：

```
(function($)
{
$.fn.extend(
{
    drawbox: function()
    {

        // Default options
        var defaults = {
            caption:       'Caption',
            // Canvas properties
            lineWidth:     3,
            lineCap:       'round',
            lineJoin:      'round',
            miterLimit:    10,
            strokeStyle:   'green',
            fillStyle:     'none',
            shadowOffsetX: 0.0,
            shadowOffsetY: 0.0,
            shadowBlur:    0.0,
            shadowColor:   'none',
        }

        options = $.extend(defaults);

        return this.each(function()
        {

            //etc 
```

该脚本运行良好，但我想稍后在单独的脚本中获取“选项”值。我猜选项设置已设置并存储在函数中，以后可以检索。

我试过这样的事情：

```
$('#an-id').drawbox.options 
```

...但似乎无法得到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:22:30.347

你有你的`drawbox()`方法，但似乎你目前将它设置为只执行一个内部函数。要做你想做的事，你必须设置你的插件以允许多种方法......

执行此操作的一般`jquery approved`方法是将所有方法包含`methods object`在插件代码中，其中函数`init`是您的默认函数，就像这样......

```
var methods = {
  "getOptions" : function(){ return options; },

  "init" : function(){
    return this.each(function(){
      //your current code goes here (what happens when you call $().drawbox)
    });
  }
} 
```

现在，您必须包含以下代码或类似代码，以让您的插件调用您想要的方法...

```
 $.fn.drawbox = function(method){
    if(methods[method]){
      return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
    }else if(!methods[method]){
      return methods.init.apply(this, arguments);
    }else{
      $.error('Method ' +  method + ' does not exist on jQuery.drawbox');
    }      
  }; 
```

注意这是做什么的。当`.drawbox()`被调用时，上面的执行，如果没有传递参数，你的`init`函数被调用。如果传递了参数，例如`drawbox('getOptions')`，`getOptions`则执行方法（在方法对象中）。

通过这种方式，您可以返回插件范围内的任何变量，在概念上类似于普通的 getter/setter。您还需要删除`drawbox : function(){...`当前代码中的行，因为上面替换了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:19:22.183

看：

```
(function($) {
    $.fn.yourPlugin = function(options) {
         options= jQuery.extend({ opt: 1, opt2: 2 }, options);
         // the escope of your plugin....
    }
})(jQuery); 
```

您需要通过参数获取选项，并将参数选项与属性默认值合并，使用选项属性覆盖默认属性，或者如果选项为空则保留默认值

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T21:20:54.317

drawbox 是一个函数，所以这一行是无效的：

```
$('#an-id').drawbox.options 
```

`$('#an-id').drawbox()`每次调用都会执行不正确的代码。

您必须在构造函数方法中使用参数，以便您可以返回这样的选项

```
$('#an-id').drawbox('options') 
```

看看手风琴的实现，我认为它做了一些你需要的事情：

[http://api.jqueryui.com/accordion/#method-option](http://api.jqueryui.com/accordion/#method-option)

# jquery - .slideToggle 悬停在 div jquery 上

> ID：16202212
> 
> 赞同：3
> 
> 时间：2013-04-24T21:07:33.697
> 
> 标签：jquery, hover, slidetoggle

我希望能够在悬停时滑动切换 div，但它不起作用.. 这是代码：

```
<div class='slide-header'>
        header....
</div>

<div class='slide-content'>
       Content..................
</div>

<script>
$(".slide-header").hover(function () {
    $(".slide-content").slideToggle("slow");
});
</script>

<style><!-- initially, I don't want to display .slide-content -->
    .slide-content { display:none; }
</style> 
```

如何在悬停时使用 .slideToggle？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T21:08:36.187

尝试这个

```
$(".slide-header").hover(function () {
    $(".slide-content").stop().slideDown("slow");
}, function(){
    $(".slide-content").stop().slideUp("slow");
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T21:21:47.723

将其包装在[文档就绪](http://api.jquery.com/ready/)函数中：

```
$(function(){
    $(".slide-header").hover(function () {
        $(".slide-content").slideToggle("slow");
    });
}); 
```

# caml - 如何更改此 for 循环中的变量

> ID：16202214
> 
> 赞同：0
> 
> 时间：2013-04-24T21:07:37.310
> 
> 标签：caml

我的循环有问题。在这个节目中，

```
let f s = 
  for i = 0 to ((String.length s) - 1) do 
    print_char s.[i];
  done;; 
```

出于某些原因，我想更改变量 i (increase, dicrease) 但此变量不是可变的，我不知道如何更改字符串 s 上的指针。我想到了另一个功能，但我不知道是否是个好主意..

# mysql - sql查询对表中的增量求和

> ID：16202216
> 
> 赞同：1
> 
> 时间：2013-04-24T21:07:44.980
> 
> 标签：mysql, sql, database-design, linked-list

我有存储在表中的传入传感器数据。传感器的每条记录都有几个“计数器”列。计数器不过是时间的快照。示例记录如下所示。

```
|标识 | 传感器 | 柜台 1 | 柜台2 | 时间戳
  1 5 100 200 上午 10:00
  2 5 125 210 上午 10:01
...
  60 5 1000 800 上午 11:00

```

我有数千个这样的传感器及时发送其计数器值的快照。我需要做的是，给定一个时间段，比如上午 10 点到 11 点之间，将记录之间的**增量**映射到图表。Delta 总是取到之前的记录。
获取连续记录之间的增量的 SQL 查询是什么？
我的第二个问题是，存储此类自引用数据的良好表设计是什么。可能作为一个链表，每条记录都指向前一条记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:15:54.327

通用 SQL 是：

```
select t.*,
       (select counter1 from t t2 where t2.sensor = t.sensor and t2.timestamp < t.timestamp
        order by timestamp desc
        limit 1
       ) prevCounter1
from t 
```

`limit 1`取决于数据库。它可能是`top 1`（SQL Server、Sybase）或`where rownum = 1`（Oracle）。

您需要为每个计数器执行此操作。

如果您使用的是 Postgres、Oracle 或 SQL Server 2012，您可以使用`lag()`：

```
select t.*,
       lag(counter1) over (partition by sensor order by timestamp) as prevCounter1
from t 
```

在 MySQL 中，最好将`prevID`. 如果没有，索引`sensor, timestamp`应该会给你合理的表现。

# python - Nmap的python子进程问题

> ID：16202220
> 
> 赞同：0
> 
> 时间：2013-04-24T21:07:54.190
> 
> 标签：python, subprocess, nmap

我试图让一个 linux 二进制文件通过使用子进程将其标准输出发送到一个变量。但只是不断获得回溯。

```
>>> import subprocess
>>>nmap -sn -Pn todd.ns.cloudflare.com --script dns-check-zone --script-args='dns-check-zone.domain=www.macmonster.com 
```

任何想法（哦，我使用 Python2.7）。

理想情况下，我想避免使用 Shell=true 来避免任何安全问题。

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-17T19:45:12.663

## shlex 来救援！

模块 shlex 将获取一个包含整个 shell 命令的字符串，并将其完全按照 Popen 和 check_output 的期望进行拆分。像这样：

```
import shlex, subprocess
cmd = "/usr/bin/nmap -sn -Pn todd.ns.cloudflare.com --script dns-check-zone --script-args='dns-check-zone.domain=www.macmonster.com'"
args = shlex.split(cmd)
output = subprocess.check_output(args) 
```

当您查看 args 的内容时，您会看到：

```
>>> print args
['/usr/bin/nmap', '-sn', '-Pn', 'todd.ns.cloudflare.com', '--script', 'dns-check-zone', '--script-args=dns-check-zone.domain=www.macmonster.com'] 
```

请注意，shlex 将选项“--script dns-check-zone”拆分为两个标记。另一方面，它保留了“--script-args='dns-check-zone.domain=www.macmonster.com'”，但删除了单引号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:10:54.950

```
import subprocess
output = subprocess.check_output(["/usr/bin/nmap", "-sP", "-n", "172.16.1.0/24"])

output = subprocess.check_output(["/usr/bin/nmap", "-sP", "-n", "172.16.1.0/24"], stderr=subprocess.STDOUT) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-16T15:04:43.797

你有没有试过这个：

```
p = subprocess.Popen(command, stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
var = p.stdout.read()
print var 
```

我会使用`communicate`，但它返回一个奇怪的列表类型的东西。

# android - 强制从 onCreate Activity 显示启动画面

> ID：16202222
> 
> 赞同：0
> 
> 时间：2013-04-24T21:08:03.753
> 
> 标签：android, android-activity, oncreate, splash-screen

我的应用程序有以下活动：

*   仪表板活动
*   飞溅活动
*   主要活动

这需要流程：仪表板有一个启动 MainActivity 的按钮。主要活动的 onCreate() 方法检查是否先前创建了用户配置文件，如果是，则它正常启动（这很快，没有 GUI 延迟）。如果没有找到用户配置文件，则需要显示一个初始屏幕，其中包含 mainActivity 的说明/操作方法，同时主 Activity 的 onCreate() 创建一个新的用户配置文件文件（缓慢和 GUI 阻塞）。

我目前看到的是在缓慢的用户配置文件创建结束后显示延迟的启动/说明。

这是 MainActivity 的代码片段。

```
private void showUsage(){
    Thread splashTread = new Thread() {
        public void run() {
            try {
                Intent instructionIntent = new Intent(MainActivity.this,
                        InstructionsActivity.class);
                startActivity(instructionIntent);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }

    };
    splashTread.start();
}

@Override //MainActivity
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
            WindowManager.LayoutParams.FLAG_FULLSCREEN);

    if (!IsProfileExists()){
        showUsage();
        try{
               createUserProfile(); //slow!
        } catch (Exception e) { }
    }

    /*Continue with MainActivity*/
  } 
```

Splash 通过单击自行关闭：

```
 public class InstructionsActivity extends Activity {
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
            WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(R.layout.instructions_layout);
    ImageView instructions = (ImageView) findViewById(R.id.ivInstructions);
    instructions.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            finish();
        }
    });
}
} 
```

问题：在 GUI 从 MainActivity onCreate() 获取块后显示说明活动（飞溅）。

有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:34:44.423

从 dashBoardActivity 执行条件检查 (IsProfileExists())，如果配置文件不存在，则调用 Splash 活动。

# ruby-on-rails - 命名空间控制器，无需命名空间路由助手

> ID：16202225
> 
> 赞同：2
> 
> 时间：2013-04-24T21:08:15.980
> 
> 标签：ruby-on-rails, routing

是否可以引用`app/controllers/admin/categories_controller.rb`using`categories_path`而不是`admin_categories_path`？

我正在使用 Rails 4。

```
# app/controllers/admin
class Admin::CategoriesController < Admin::BaseController
end

# visiting localhost:3000/admin/categories causes route not found error 'admin/categories'
scope module: "admin" do
  resources :categories
end

# visiting localhost:3000/admin/categories causes uninitialized constant CategoriesController
scope "/admin" do
  resources :categories
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T22:10:19.650

我相信您必须在资源中引用控制器

```
scope 'admin' do
  resources :categories, controller: 'admin/categories'
end 
```

所以路线变成了

```
 categories   GET    /admin/categories(.:format)          admin/categories#index
                POST   /admin/categories(.:format)          admin/categories#create
   new_category GET    /admin/categories/new(.:format)      admin/categories#new
  edit_category GET    /admin/categories/:id/edit(.:format) admin/categories#edit
       category GET    /admin/categories/:id(.:format)      admin/categories#show
                PATCH  /admin/categories/:id(.:format)      admin/categories#update
                PUT    /admin/categories/:id(.:format)      admin/categories#update
                DELETE /admin/categories/:id(.:format)      admin/categories#destroy 
```

# iphone - 如何以编程方式使用自动布局在视图之间提供垂直空间？

> ID：16202227
> 
> 赞同：1
> 
> 时间：2013-04-24T21:08:28.350
> 
> 标签：iphone, autolayout, nslayoutconstraint

在我的应用程序中，我必须根据每个视图垂直布局两个视图，并希望确保它们在 iPhone 4 和 5 中看起来相似。这是代码：

```
nextShowView = [[WestwoodNextShowView alloc]initWithFrame:CGRectMake(-5, 322, 290, 70)];
    nextShowView.staticLabel.text = @"Next Show";
    nextShowView.date.text = @"10/25";
    nextShowView.address.text = @"Green Dot Tavern";
    nextShowView.cityState.text = @"Detroit, MI";
    [_aboutScroll addSubview:nextShowView];

    playerView = [[WestwoodMusicPlayerView alloc]initWithFrame:CGRectMake(0, 407, 320, 50)];
        [_aboutScroll addSubview:playerView];

    NSDictionary * viewsDict = NSDictionaryOfVariableBindings(nextShowView, playerView);
    NSArray * constraints = [NSLayoutConstraint constraintsWithVisualFormat:@"V:[nextShowView]-15-[playerView]-20-|" options:NSLayoutFormatAlignAllLeft metrics:nil views:viewsDict];
    [_aboutScroll addConstraints:constraints]; 
```

我试图做的是在 nextShowView 和 playerView 之间留出 15 点空间，从 playerView 底部到视图底部边缘留出 20 点空间。

请帮忙 ！！！！

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:22:36.033

仅当您提供每个视图需要完全指定它的*所有约束时，自动布局才有效。*不仅要给出 and 之间的垂直分隔`nextShowView`，不仅要给出和 superview`playerView`之间的垂直分隔`playerView`，还要给出它们的高度，以及它们的水平位置和宽度。

如果您的视图没有出现在您期望的位置，那么您可能没有给出足够的约束。在调试器中暂停并`po [[UIWindow keyWindow] _autolayoutTrace]`在控制台命令行中确认您是否有不明确的布局。

# perl - Perl 并行处理多个网页

> ID：16202229
> 
> 赞同：0
> 
> 时间：2013-04-24T21:08:31.153
> 
> 标签：perl, mechanize, web-scraping

我必须在多个网页上填写表格。我正在尝试获取数据，将 html 解析为文本，并将其存储在一个文件中。每个网络表单都有不同的字段需要填写；这是其中之一的代码。我还有三个。建议表示赞赏 - 谢谢！

```
 use strict;
 use warnings;
 my $timeout=40;
 use WWW::Mechanize;
 use HTML::TreeBuilder;
 use HTML::FormatText;
 use HTML::Parser;
 use autodie qw/ open close /;
 use 5.012;
 use Win32::IE::Mechanize;
 use Time::HiRes 'sleep';
 my $m = WWW::Mechanize->new(autocheck => 1);
 my $browser = Win32::IE::Mechanize->new(visible => 1);
 my $snp = "rs111";
 my $content= $browser->get("http://snp-nexus.org/index.html");
 my $html = $browser->content;
 $browser->form_name ('snpnexus');
 $browser->field('batch_text', 'dbsnp rs111');
 $browser->tick('ensembl', "ensembl");
 $browser->tick('refseq','refseq');
 $browser->tick('ucsc','ucsc');
 $browser->tick("sift",'sift');
 $browser->tick("polyphen",'polyphen');
 $browser->tick("chb",'chb');
 $browser->tick("chd",'chd');
 $browser->tick("tfbs",'tfbs');
 $browser->tick("consv",'consv');
 $browser->tick("gwas",'gwas');
 $browser->tick("indel",'indel');
 $browser->tick("mirbase" ,'mirbase');
 $browser->tick('gad','gad');
 $browser->tick('cnp' , 'cnp' );
 $browser->click_button('value', 'RUN');
 for (0 .. $timeout*20) {
 last if $browser->{agent}->ReadyState >=5;
 sleep 0.1;
 }
my $html2 = $browser->content;

 my $Format =HTML::FormatText->new();
 my $TreeBuilder =HTML::TreeBuilder->new();
 $TreeBuilder->parse($html2);
 my $parsed= $Format->format($TreeBuilder);

print $parsed; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T08:01:05.293

您不需要使用 Perl 和 Mechanize 来提交批处理查询。他们的指南页面详细介绍了如何使用制表符分隔的文件提交批量信息请求。

[http://snp-nexus.org/guide.html](http://snp-nexus.org/guide.html)

这有帮助吗？引用：

> SNPnexus 允许用户在处理大量变体时提交批量查询。用户可以将变体列表直接粘贴到设计的文本空间中，也可以上传包含查询的文件。目前，我们将单个批处理查询中的最大变体数量限制为 100,000。我们只允许使用基因组位置和/或 dbsnp rs# 格式进行批量查询。不允许染色体区域查询数据。每个变体必须位于一个新行上，并具有以下格式之一的制表符分隔数据：

# wcf - 无法在 Azure Web 角色上设置 wsHttpBinding。Web.config 被忽略？

> ID：16202240
> 
> 赞同：0
> 
> 时间：2013-04-24T21:08:56.333
> 
> 标签：wcf, azure, web-config, wcf-binding

我正在尝试将 WCF 服务部署为使用`wsHttpBinding`.

当客户端尝试连接到它时，它不断收到以下异常：

```
[SynchronizingContextState.Process] [System.Net.WebException: The remote server returned an error: (415) Cannot process the message because the content type 'application/soap+xml; charset=utf-8' was not the expected type 'text/xml; charset=utf-8'..]
   at System.Net.HttpWebRequest.GetResponse()
   at System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout) 
```

这似乎表明该服务正在使用`basicHttpBinding`。但是，我检查了`Web.config`很多次，似乎找不到任何问题。此外，同样的服务在 Azure 之外托管时也能完美运行。

我连接到 Azure VM 并确认`Web.config`已部署正确，但它看起来好像只是被忽略了，因为我也无法获取服务元数据，即使它应该已启用。

这是我的`Web.config`文件：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>
    <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
  </configSections>
  <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework" />
  </entityFramework>
  <system.web>
    <compilation debug="true" targetFramework="4.0" />
    <customErrors mode="Off" />
  </system.web>
  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior name="BackendServiceBehavior">
          <serviceDebug includeExceptionDetailInFaults="true" />
          <serviceMetadata httpGetEnabled="true" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <bindings>
      <wsHttpBinding>
        <binding name="BackendServiceBinding" maxReceivedMessageSize="655360">
          <security mode="None" />
        </binding>
      </wsHttpBinding>
    </bindings>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
    <services>
      <service name="MyNamespace.BackendService" behaviorConfiguration="BackendServiceBehavior">
        <endpoint name="Backend" address="" binding="wsHttpBinding" bindingConfiguration="BackendServiceBinding" contract="MyNamespace.IBackendService" />
        <endpoint name="BackendMex" address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost/BackendService.svc" />
          </baseAddresses>
        </host>
      </service>
    </services>
  </system.serviceModel>
</configuration> 
```

我在这里错过了什么吗？非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T19:12:13.800

您是否尝试添加到端点行为？

```
<behavior name="web">
    <webHttp />
</behavior> 
```

（如果您希望 MEX 也能正常工作）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T20:15:57.090

好的，我终于修好了，这是 PEBKAC 的一个坏案例。=/

我见过有人遇到同样的问题，因为他没有在服务名称中包含命名空间，所以我怀疑这是命名空间问题，但我一直在看错误的地方。

原来服务的 Azure 实现是在错误的命名空间中定义的。我纠正了它，瞧，现在它可以工作了。

希望这至少对其他人有用。

# sql-server-2008 - MDX 中的产品总和（乘法）

> ID：16202242
> 
> 赞同：0
> 
> 时间：2013-04-24T21:09:10.673
> 
> 标签：sql-server-2008, ssas, mdx

我有一个像这样的 MDX 查询：

```
with 
member [Measures].[Currency] as [Currency].[Code].Currentmember.Member_Key
member [Measures].[Date] as [Time].[Date].Currentmember.Member_Key
member [Measures].[Wholesale Price Totals] as [Measures].[Wholesale Price] * [Measures].[Net Sold Units]
select
{
[Measures].[Currency]
,[Measures].[Date]
,[Measures].[Sold Units]
,[Measures].[Wholesale Price Totals]
}
on columns,
ORDER
(
    NONEMPTY
    (
        CROSSJOIN
        (
            {[Time].[Date].&[2013-02-26T00:00:00],[Time].[Date].&[2013-02-27T00:00:00]}
            ,EXCEPT([Currency].[Code].Members, [Currency].[Code].[All])
        ), 
        [Measures].[Sold Units]
    ), 
    [Measures].[Date], BASC
)
on rows
from MyCube 
```

我需要将所有 [Sold Units]（数量）* [Wholesale Price] 的总和作为 [Wholesale Price Totals]。像这样的查询检索所有已售单位的总和乘以 Wolesale 价格的总和，我需要将每个已售单位“单元格”的总和乘以它们的批发价格。

我从几天前就开始尝试这样做，这让我发疯了！

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T06:43:38.593

乘法需要在叶级别完成，这使得它比常规措施慢得多。理想情况下，您应该在 ETL 阶段考虑乘法。如果不行，可以使用下面帖子[http://sqlblog.com/blogs/mosha/archive/2005/02/13/performance-of-aggregating-data-from-lower-levels-中描述的方法在-mdx.aspx](http://sqlblog.com/blogs/mosha/archive/2005/02/13/performance-of-aggregating-data-from-lower-levels-in-mdx.aspx)

# ios - 写入文件时，有没有办法删除在 NSMutableDictionary 键/对象对之间创建的换行符？

> ID：16202245
> 
> 赞同：0
> 
> 时间：2013-04-24T21:09:20.317
> 
> 标签：ios, objective-c, nsmutabledictionary, nscharacterset

`NSMutableDictionary`当写入文件时，我试图使我的条目看起来像这样：

```
 <dict>
        <key>Track ID</key><integer>686</integer>
        <key>Name</key><string>Poetic Justice (Feat. Drake)</string>
        <key>Artist</key><string>Kendrick Lamar</string>
        <key>Album</key><string>Good Kid M.A.A.D City-(Deluxe Edition)</string>
        </dict> 
```

这是我的文件现在的样子：

```
 <dict>
        <key>Track ID</key>
        <integer>686</integer>
        <key>Name</key>
        <string>Poetic Justice (Feat. Drake)</string>
        <key>Artist</key>
        <string>Kendrick Lamar</string>
        <key>Album</key>
        <string>Good Kid M.A.A.D City-(Deluxe Edition)</string>
        </dict> 
```

我尝试使用`NSCharacterSet`这样的方法从键字符串和对象中修剪空格和换行符

```
 NSString *trimmedArtistString = [ArtistString stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]]; 
```

但这没有用。
这可以做到吗？

# c# - 使用 DirectoryServices.AccountManagement 按名称从字符串匹配/更新 UserPrincipal 属性

> ID：16202246
> 
> 赞同：1
> 
> 时间：2013-04-24T21:09:25.367
> 
> 标签：c#, active-directory, principal

我有一个字典，其键/值是 UserPrincipal 属性。这些是从 csv 文件中读取的。此 csv 文件还具有要更新的相应 AD 用户的employeeId。目标是使用 csv 中提供的值更新 AD 中的每个用户属性。

但是，直到运行时我才知道 csv 中提供了哪些属性。

**如何将每个提供的属性名称与正确的 UserPrincipal 属性进行匹配，特别是使用 DirectoryServices.AccountManagement 然后更新 / 保存**？

我有一种使用 Reflection 和 2.0 的 DirectoryEntry 的方法，可以让我部分地到达那里，但我仍然需要一种更新和保存的方法：

（“userToUpdate”引用了 UserPrincipal 实例，“Attributes”是从 csv 提供的键/值）

```
 public void UpdateAttributes(List<ADUser> users)
    {           
        // get all the UserPrincipal properties 
        List<string> userPrincipalProperties = 
            users[0].UserPrincipal.GetType().GetProperties()
            .Select(property => property.Name).ToList();

        foreach (var userToUpdate in users)
        {
            try
            {
                 foreach (KeyValuePair<string, string> attribute in userToUpdate.Attributes
                    .Where(attribute => userPrincipalProperties.Contains(attribute.Key))
                    .Where(attribute =>
                        {
                            return value.ToString() != attribute.Value;
                        }))
                {
                   //something like userToUpdate.UserPrincipal.{property-name} = attribute.Value;

                }
                // save...
            }
            catch (Exception ex)
            {
                _log.Error(ex.Message);
            }

        }
    } 
```

# sorting - 频繁更新排序数据的模式

> ID：16202251
> 
> 赞同：0
> 
> 时间：2013-04-24T21:09:44.287
> 
> 标签：sorting, real-time, specification-pattern

假设您正在编写一个博客网站。它显示按“优先级”排序的多个作者最近的博客文章。最高优先级。优先级由以下公式确定：

1.  这篇文章最近是如何发布的
2.  吸引了多少评论

订单必须始终实时准确。

按优先级排序很容易。问题是，假设我们的网站非常受欢迎，评论以每分钟数百条的速度飞来。他们飞进了几十个帖子。

有处理这种情况的模式吗？换句话说，我们能不能做得更好，而不仅仅是在帖子上有评论时更新优先级字段，然后在每次加载页面时对帖子进行排序？缓存发布订单并没有多大帮助，因为大量的用户活动会导致订单频繁更改。

对于“模式”，我是从代码和数据库模式的角度讲的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:25:20.823

您可以使用平衡二叉树（例如红黑树）来存储排序后的索引，这应该比每次都对整个索引进行排序时更新速度更快。

使用 Java-ish 伪代码，这看起来像

```
Tree tree;

Node {
    int priority;

    incrementPriority() {
        priority = priority + 1;
        if(priority > tree.nextHighestNode(this)) {
            tree.remove(this);
            tree.add(this);
        }
    }

    decrementPriority() {
        priority = priority - 1;
        if(priority < tree.nextLowestNode(this)) {
            tree.remove(this);
            tree.add(this);
        }
    }
} 
```

如果更改节点的优先级意味着它位于无效的树位置（意味着它高于应该是下一个最高节点，或者低于应该是下一个最低节点），那么它会被移除并重新 -添加到树（负责重新平衡自身）。插入是 O(log(n))，但通常（当没有插入/删除时）更新优先级是一个恒定时间操作。

[红黑树](http://en.wikipedia.org/wiki/Red-black_tree)是平衡二叉树的通常实现方式，但也有替代方案，例如[Tango 树](http://en.wikipedia.org/wiki/Tango_tree)可能更适合这里，因为它是在线实现。最大的问题是并发性 - 理想情况下，您希望能够使用某种 AtomicInteger 实现节点的优先级字段（允许原子增量和减量；相当多的语言都有这样的东西），这样你就不会了每次更改时都需要锁定字段，但是很难将优先级与相邻节点的优先级进行原子比较。

作为替代方案，您可以将所有内容存储在数组或链表中，并在它们的优先级发生变化时交换相邻元素 - 这样您就不需要每次都进行完整排序，这与平衡二叉树不同，其中删除和插入元素是 O(log(n))，交换两个相邻的数组/列表元素是常数时间。唯一的问题是使用数组添加一个全新的元素会很昂贵，因为您需要移动数组的所有元素；它也将是 O(n) 与列表，因为您需要遍历列表直到找到插入项目的正确位置，但这可能比数组更可取，因为您不需要移动任何相邻的元素（这将减少您需要执行的锁定量）。

# android - 如何从其他位置在gridview中加载图像

> ID：16202253
> 
> 赞同：-1
> 
> 时间：2013-04-24T21:09:47.540
> 
> 标签：android

我遵循下面的本[教程](http://vikaskanani.wordpress.com/2011/07/20/android-custom-image-gallery-with-checkbox-in-grid-to-select-multiple/)
是我的代码，它从应用程序内部存储器加载图像并使用简单的适配器显示，但现在我想添加复选框我找到了这个教程，其中包含来自画廊的图像我想自定义这个示例代码以从文件位置加载图像什么我该怎么做我如何更改此代码以从文件位置加载图像或如何自定义其适配器以加载我的文件我有什么帮助请

```
 <!-----------------this is my code------>
 GridView gridView;
 SimpleAdapter simpleAdapter;

    gridView =(GridView)findViewById(R.id.grid);
    gridView.setOnItemClickListener(new OnItemClickListener(){
        public void onItemClick(AdapterView<?> parent, View view, int  
                        position,long id) {

        if(currentFiles[position].isDirectory())
        {
            root = new File("/data/data/com.myexample/files 
                /"+FileName(currentFilePath[position])+"/");

            Log.e("Root first",root+ " ");

            currentFiles = root.listFiles();

            inflateListView(currentFiles);
        }
        else if(currentFiles[position].isFile())
        {
                   inflateListView(currentFiles);
        } } });

         private void inflateListView(File[] files){

  List<Map<String,Object>> listItems = new ArrayList<Map<String,Object>>();

 for(int i=0;i<files.length;i++)
 {      
        Map<String, Object> listItem = new HashMap<String, Object>();

        if(files[i].isDirectory())
        {
            listItem.put("icon", R.drawable.folder);
        }
        else
        {
            listItem.put("icon",  files[i]);
        }

        listItem.put("fileName", files[i].getName());
        listItems.add(listItem);
    }

      simpleAdapter=new SimpleAdapter(this,listItems,R.layout.line,new String[] 
      {"icon","fileName"},new int[]{R.id.icon,R.id.file_name});
      gridView.setAdapter(simpleAdapter);

       <!--------this is sample code--------->>>>>>

import android.widget.CheckBox;
import android.widget.GridView;
import android.widget.ImageView;
import android.widget.Toast;

 public class AndroidCustomGalleryActivity extends Activity {
private int count;
private Bitmap[] thumbnails;
private boolean[] thumbnailsselection;
private String[] arrPath;
private ImageAdapter imageAdapter;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    final String[] columns = { MediaStore.Images.Media.DATA, 
     MediaStore.Images.Media._ID };
    final String orderBy = MediaStore.Images.Media._ID;
    Cursor imagecursor = managedQuery(
            MediaStore.Images.Media.EXTERNAL_CONTENT_URI, columns, 
       null,
            null, orderBy);
    int image_column_index =  
       imagecursor.getColumnIndex(MediaStore.Images.Media._ID);
    this.count = imagecursor.getCount();
    this.thumbnails = new Bitmap[this.count];
    this.arrPath = new String[this.count];
    this.thumbnailsselection = new boolean[this.count];
    for (int i = 0; i < this.count; i++) {
        imagecursor.moveToPosition(i);
        int id = imagecursor.getInt(image_column_index);
        int dataColumnIndex = 
    imagecursor.getColumnIndex(MediaStore.Images.Media.DATA);
        thumbnails[i] = MediaStore.Images.Thumbnails.getThumbnail(
                getApplicationContext().getContentResolver(), id,
                MediaStore.Images.Thumbnails.MICRO_KIND, null);
        arrPath[i]= imagecursor.getString(dataColumnIndex);
    }
    GridView imagegrid = (GridView) findViewById(R.id.PhoneImageGrid);
    imageAdapter = new ImageAdapter();
    imagegrid.setAdapter(imageAdapter);
    imagecursor.close();

    final Button selectBtn = (Button) findViewById(R.id.selectBtn);
    selectBtn.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            final int len = thumbnailsselection.length;
            int cnt = 0;
            String selectImages = "";
            for (int i =0; i<len; i++)
            {
                if (thumbnailsselection[i]){
                    cnt++;
                    selectImages = selectImages + arrPath[i] + 
    "|";
                }
            }
            if (cnt == 0){
                Toast.makeText(getApplicationContext(),
                        "Please select at least one image",
                        Toast.LENGTH_LONG).show();
            } else {
                Toast.makeText(getApplicationContext(),
                        "You've selected Total " + cnt +  
  "  
       image(s).",
                        Toast.LENGTH_LONG).show();
                Log.d("SelectedImages", selectImages);
            }
        }
    });
}

public class ImageAdapter extends BaseAdapter {
    private LayoutInflater mInflater;

    public ImageAdapter() {
        mInflater = (LayoutInflater) 
         getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    }

    public int getCount() {
        return count;
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        ViewHolder holder;
        if (convertView == null) {
            holder = new ViewHolder();
            convertView = mInflater.inflate(
                    R.layout.galleryitem, null);
            holder.imageview = (ImageView)  
        convertView.findViewById(R.id.thumbImage);
            holder.checkbox = (CheckBox)  
       convertView.findViewById(R.id.itemCheckBox);

            convertView.setTag(holder);
        }
        else {
            holder = (ViewHolder) convertView.getTag();
        }
        holder.checkbox.setId(position);
        holder.imageview.setId(position);
        holder.checkbox.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                CheckBox cb = (CheckBox) v;
                int id = cb.getId();
                if (thumbnailsselection[id]){
                    cb.setChecked(false);
                    thumbnailsselection[id] = false;
                } else {
                    cb.setChecked(true);
                    thumbnailsselection[id] = true;
                }
            }
        });
        holder.imageview.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                int id = v.getId();
                Intent intent = new Intent();
                intent.setAction(Intent.ACTION_VIEW);
                intent.setDataAndType(Uri.parse("file://" + 
    arrPath[id]), "image/*");
                startActivity(intent);
            }
        });
        holder.imageview.setImageBitmap(thumbnails[position]);
        holder.checkbox.setChecked(thumbnailsselection[position]);
        holder.id = position;
        return convertView;
    }
}
class ViewHolder {
    ImageView imageview;
    CheckBox checkbox;
    int id;
}
     } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-20T14:40:57.353

```
import com.example.appsecurity.AndroidCustomGalleryActivity.ImageAdapter;

import android.app.Activity;
import android.database.Cursor;
import android.graphics.Bitmap;
import android.os.Bundle;
import android.provider.MediaStore;
import android.widget.GridView;

public class unhide extends Activity {
    private int count;
    private Bitmap[] thumbnails;
    private boolean[] thumbnailsselection;
    private String[] arrPath;
   private ImageAdapter imageAdapter1 ;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.unhide);

        final String[] columns = { MediaStore.Images.Media.DATA, MediaStore.Images.Media._ID};

        final String orderBy = MediaStore.Images.Media._ID;

        Cursor imagecursor = getContentResolver().query( MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
                columns, 
                MediaStore.Images.Media.DATA + " like ? ",
                new String[] {"%/./%"},  
                null);
                int image_column_index = imagecursor.getColumnIndex(MediaStore.Images.Media._ID);          
                this.count = imagecursor.getCount();        
                this.thumbnails = new Bitmap[this.count];       
                this.arrPath = new String[this.count];  
                this.thumbnailsselection = new boolean[this.count];

        for (int i = 0; i < this.count; i++) {

            imagecursor.moveToPosition(i);

            int id = imagecursor.getInt(image_column_index);        
            int dataColumnIndex = imagecursor.getColumnIndex(MediaStore.Images.Media.DATA); 

          thumbnails[i] = MediaStore.Images.Thumbnails.getThumbnail(        
                    getApplicationContext().getContentResolver(), id,       
                    MediaStore.Images.Thumbnails.MICRO_KIND, null);     

            arrPath[i]= imagecursor.getString(dataColumnIndex);

    }

        GridView imagegrid = (GridView) findViewById(R.id.Unhide);      
        ImageAdapter  imageAdapter1  =  ImageAdapter();      
        imagegrid.setAdapter(imageAdapter1);     
        imagecursor.close();
}
    private ImageAdapter ImageAdapter() {
        // TODO Auto-generated method stub
        return null;
    }
} 
```

# angularjs - 带有禁用行的 ng-options

> ID：16202254
> 
> 赞同：59
> 
> 时间：2013-04-24T21:09:53.313
> 
> 标签：angularjs, ng-options

是否可以使用`ng-options`它将根据标准呈现为禁用的行？

这个：

```
 <select ng-options="c.name group by c.shade for c in colors"> 
```

也许有可能变成这样的东西：

```
 <select ng-options="c.name group by c.shade for c in colors | disabled(c.shade)"> 
```

假设通过一个过滤器可以返回`disabled='disabled'`所有具有 shade = "dark" 的颜色

```
<select>
   <optgroup label="dark">
      <option value="0" disabled="disabled">black</option>
      <option value="2" disabled="disabled">red</option>
      <option value="3" disabled="disabled">blue</option>
   </optgroup>
   <optgroup label="light">
      <option value="1">white</option>
      <option value="4">yellow</option>
   </optgroup>
 </select> 
```

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2016-11-01T07:31:10.007

@lucuma 的答案（最初被接受的答案）是正确的，但现在应该更新，因为这已在 Angular 1.4 中修复。请参阅[ng-options 的文档，](https://docs.angularjs.org/api/ng/directive/ngOptions)其中还包含一个[示例](https://docs.angularjs.org/api/ng/directive/ngOptions#example)。

我正在使用 Angular 1.5，这对我有用：

### 看法

`<select ng-model="$ctrl.selectedItem" ng-options="item as item.label disable when item.disabled for item in $ctrl.listItems">`

### 控制器

`vm.items = [ { id: 'optionA', label: 'Option A' }, { id: 'optionB', label: 'Option B (recommended)' }, { id: 'optionC', label: 'Option C (Later)', disabled: true } ]; vm.selectedItem = vm.items[1];`

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2013-12-26T20:34:24.457

正如[@Lod](https://stackoverflow.com/users/2438650/lod) Angular 所指出的，在 1.4.0-beta.5 中增加了对此的支持。

对于角度 js **>= 1.4.0-beta.5**。

```
<select ng-options="c.name disable when c.shade == 'dark' 
group by c.shade for c in colors"> 
```

对于 angular js **< 1.4.0-beta.5**，请参考以下解决方案：

[与@lucuma](https://stackoverflow.com/users/1366293/lucuma)给出的类似，但**没有 jQuery 依赖**项。

检查这个[http://jsfiddle.net/dZDLg/46/](http://jsfiddle.net/dZDLg/46/)

**控制器**

```
<div ng-controller="OptionsController">
    <select ng-model="selectedport" 
        ng-options="p.name as p.name for p in ports"
        options-disabled="p.isinuse for p in ports"></select>
    <input ng-model="selectedport">
</div> 
```

**指示**

```
angular.module('myApp', [])
.directive('optionsDisabled', function($parse) {
    var disableOptions = function(scope, attr, element, data, 
                                  fnDisableIfTrue) {
        // refresh the disabled options in the select element.
        var options = element.find("option");
        for(var pos= 0,index=0;pos<options.length;pos++){
            var elem = angular.element(options[pos]);
            if(elem.val()!=""){
                var locals = {};
                locals[attr] = data[index];
                elem.attr("disabled", fnDisableIfTrue(scope, locals));
                index++;
            }
        }
    };
    return {
        priority: 0,
        require: 'ngModel',
        link: function(scope, iElement, iAttrs, ctrl) {
            // parse expression and build array of disabled options
            var expElements = iAttrs.optionsDisabled.match(
                /^\s*(.+)\s+for\s+(.+)\s+in\s+(.+)?\s*/);
            var attrToWatch = expElements[3];
            var fnDisableIfTrue = $parse(expElements[1]);
            scope.$watch(attrToWatch, function(newValue, oldValue) {
                if(newValue)
                    disableOptions(scope, expElements[2], iElement, 
                        newValue, fnDisableIfTrue);
            }, true);
            // handle model updates properly
            scope.$watch(iAttrs.ngModel, function(newValue, oldValue) {
                var disOptions = $parse(attrToWatch)(scope);
                if(newValue)
                    disableOptions(scope, expElements[2], iElement, 
                        disOptions, fnDisableIfTrue);
            });
        }
    };
}); 
```

**注意**：此解决方案不适用于`group by`每个人都正确指出的问题。如果您想让[它](https://stackoverflow.com/users/1268533/dhlavaty)与`group by`.

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2015-04-08T08:23:47.937

Angular 在 1.4.0-beta.5 中添加了对此的支持

```
<select ng-options="c.name disable when c.shade == 'dark' group by c.shade for c in colors"> 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2013-04-24T22:49:33.753

我不相信有一种方法可以做你所要求的只是使用`ng-options`. 这个问题是在 Angular 项目中提出的，并且仍然存在：

[https://github.com/angular/angular.js/issues/638](https://github.com/angular/angular.js/issues/638)

似乎解决方法是使用此处和 github 问题中引用的指令：http: [//jsfiddle.net/alalonde/dZDLg/9/](http://jsfiddle.net/alalonde/dZDLg/9/)

这是来自 jsfiddle 的完整代码供参考（下面的代码来自 alande 的 jsfiddle）：

```
<div ng-controller="OptionsController">
    <select ng-model="selectedport" 
        ng-options="p.name as p.name for p in ports"
        options-disabled="p.isinuse for p in ports"></select>
    <input ng-model="selectedport">
</div>

angular.module('myApp', [])
.directive('optionsDisabled', function($parse) {
    var disableOptions = function(scope, attr, element, data, fnDisableIfTrue) {
        // refresh the disabled options in the select element.
        $("option[value!='?']", element).each(function(i, e) {
            var locals = {};
            locals[attr] = data[i];
            $(this).attr("disabled", fnDisableIfTrue(scope, locals));
        });
    };
    return {
        priority: 0,
        require: 'ngModel',
        link: function(scope, iElement, iAttrs, ctrl) {
            // parse expression and build array of disabled options
            var expElements = iAttrs.optionsDisabled.match(/^\s*(.+)\s+for\s+(.+)\s+in\s+(.+)?\s*/);
            var attrToWatch = expElements[3];
            var fnDisableIfTrue = $parse(expElements[1]);
            scope.$watch(attrToWatch, function(newValue, oldValue) {
                if(newValue)
                    disableOptions(scope, expElements[2], iElement, newValue, fnDisableIfTrue);
            }, true);
            // handle model updates properly
            scope.$watch(iAttrs.ngModel, function(newValue, oldValue) {
                var disOptions = $parse(attrToWatch)(scope);
                if(newValue)
                    disableOptions(scope, expElements[2], iElement, disOptions, fnDisableIfTrue);
            });
        }
    };
});

function OptionsController($scope) {
    $scope.ports = [{name: 'http', isinuse: true},
                    {name: 'test', isinuse: false}];

    $scope.selectedport = 'test';
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-09-26T15:04:38.367

使用选项本身可以实现类似的效果`ng-repeat`，`ng-disabled`避免使用新指令。

**HTML**

```
<div ng-controller="ExampleController">
    <select ng-model="myColor">
        <option ng-repeat="c in colors" ng-disabled="c.shade=='dark'" value="{{$index}}">
            {{c.name}}
        </option>
    </select>
</div> 
```

**控制器**

```
function ExampleController($scope, $timeout) {
    $scope.colors = [
      {name:'black', shade:'dark'},
      {name:'white', shade:'light'},
      {name:'red', shade:'dark'},
      {name:'blue', shade:'dark'},
      {name:'yellow', shade:'light'}
    ];
    $timeout(function() {
        $scope.myColor = 4; // Yellow
    });
} 
```

**小提琴**

[http://jsfiddle.net/0p4q3b3s/](http://jsfiddle.net/0p4q3b3s/)

已知的问题：

*   不使用`ng-options`
*   不适用于`group by`
*   选择索引，而不是对象
*   需要`$timeout`初始选择

**编辑：** 可以选择任何对象属性（除了索引），**但不能选择对象本身。**此外，如果您有一个简单的数组而不是对象数组，则以下方法将起作用。

在 HTML 中更改此行：

```
<option ng-repeat="c in colors" ng-disabled="c.shade=='dark'" value="{{c.name}}"> 
```

在 Controller 中更改此行：

```
$scope.myColor = $scope.colors[4].name; // Yellow 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-11-23T16:07:46.357

自 2015 年 2 月以来，有一种方法可以禁用 ng-options 标签中的选项。

[此链接显示了在 github 上添加的功能](https://github.com/angular/angular.js/commit/91061e443fba7aa10ce78279c90e331571ef3ac4)

我发现使用 angular 1.4.7，语法已经从“禁用”更改为“禁用时间”。

其语法是：

```
'ng-options': 'o.value as o.name disable when o.unavailable for o in options' 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-11-04T20:24:18.367

我遇到了一个有趣的情况。一组下拉列表，我需要它来禁用每个下拉列表中已经选择的选项，但我还需要它来保持启用已经选择的选项......

这是我的 plunker： [使用 ng-options 启用/禁用值](http://plnkr.co/edit/dbQHb6SHq3r54Gj6wbTQ?p=preview)

```
var app = angular.module('ngoptions', []);

app.controller('MainCtrl', function($scope) {

  // disable the fields by default
  $scope.coverage = [
    { CoverageType: '', CoverageName: 'No Coverage' },
    { CoverageType: 'A', CoverageName: 'Dependent Only' },
    { CoverageType: 'B', CoverageName: 'Employee Plus Children' },
    { CoverageType: 'C', CoverageName: 'Employee Only' },
    { CoverageType: 'D', CoverageName: 'Employee Plus One' },
    { CoverageType: 'E', CoverageName: 'Employee Plus Two' },
    { CoverageType: 'F', CoverageName: 'Family' },
];

  // values already set ex: pulled from db          
  $scope.rates = ['A','C', 'F'];     

  $scope.changeSelection = function (index, rate){
     $scope.rates[index] = rate;
     disableRecords();
  }

  // start by disabling records
  disableRecords(); 

  function disableRecords () {
      // set default values to false
      angular.forEach($scope.coverage, function (i, x) {
             i.disable = false; 
      });
      // set values to true if they exist in the array
      angular.forEach($scope.rates, function (item, idx) {
          angular.forEach($scope.coverage, function (i, x) {
              if (item == i.CoverageType) {
                   i.disable = true; 
              }
          });
      });
  }

});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.21/angular.min.js"></script>
<!DOCTYPE html>
<html ng-app="ngoptions">

  <head>
    <meta charset="utf-8" />
    <title>AngularJS Plunker</title>
    <script data-require="angular.js@1.4.7" data-semver="1.4.7" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular.js"></script>
    <script>document.write('<base href="' + document.location + '" />');</script>
    <link rel="stylesheet" href="style.css" />
    <script src="app.js"></script>
  </head>

  <body ng-controller="MainCtrl">
    <table>
      <thead></thead>
      <tbody>
        <tr ng-repeat="rate in rates">
          <td>
            <select 
            ng-model="rate" 
            ng-change="changeSelection($index, rate)" 
            ng-options="type.CoverageType as type.CoverageName disable when (type.disable == true && type.CoverageType != rate) for type in coverage"></select>
          </td>
        </tr>
      </tbody>
    </table>
  </body>

</html>
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-04-20T08:12:56.430

您可以在 Angular 1.4.1 或更高版本中禁用使用 ngOptions

## HTML 模板

```
<div ng-app="myapp">
<form ng-controller="ctrl">
    <select id="t1" ng-model="curval" ng-options='reportingType.code as reportingType.itemVal disable when reportingType.disable for reportingType in reportingOptions'>
        <option value="">Select Report Type</option>
    </select>

</form> 
```

## 控制器代码

```
angular.module('myapp',[]).controller("ctrl", function($scope){
$scope.reportingOptions=[{'code':'text','itemVal':'TEXT','disable':false}, {'code':'csv','itemVal':'CSV','disable':true}, {'code':'pdf','itemVal':'PDF','disable':false}]; 
```

})

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-12-08T15:21:03.687

[与@Vikas-Gulati](https://stackoverflow.com/users/1283546/vikas-gulati)类似的“无 jQuery”解决方案，但它适用于`group by`

在我的情况下，`group by`不起作用，因为我的第一个`<option>`没有价值，只有`Please select and item from dropdown`文字。这是一个稍作修改的版本，修复了这种特殊情况：

用法类似于@Vikas-Gulati 答案：[https ://stackoverflow.com/a/20790905/1268533](https://stackoverflow.com/a/20790905/1268533)

**指示**

```
angular.module('disabledModule', [])
    .directive('optionsDisabled', function($parse) {
        var disableOptions = function(scope, attr, element, data, fnDisableIfTrue) {
            var realIndex = 0;
            angular.forEach(element.find("option"), function(value, index){
                var elem = angular.element(value);
                if(elem.val()!="") {
                    var locals = {};
                    locals[attr] = data[realIndex];
                    realIndex++; // this skips data[index] with empty value (IE first <option> with 'Please select from dropdown' item)
                    elem.attr("disabled", fnDisableIfTrue(scope, locals));
                }
            });
        };
        return {
            priority: 0,
            require: 'ngModel',
            link: function(scope, iElement, iAttrs, ctrl) {
                // parse expression and build array of disabled options
                var expElements = iAttrs.optionsDisabled.match(/^\s*(.+)\s+for\s+(.+)\s+in\s+(.+)?\s*/);
                var attrToWatch = expElements[3];
                var fnDisableIfTrue = $parse(expElements[1]);
                scope.$watch(attrToWatch, function(newValue, oldValue) {
                    if(newValue)
                        disableOptions(scope, expElements[2], iElement, newValue, fnDisableIfTrue);
                }, true);
                // handle model updates properly
                scope.$watch(iAttrs.ngModel, function(newValue, oldValue) {
                    var disOptions = $parse(attrToWatch)(scope);
                    if(newValue)
                        disableOptions(scope, expElements[2], iElement, disOptions, fnDisableIfTrue);
                });
            }
        };
    }); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-09-30T11:01:33.750

由于我无法升级到最新的 angularJS，所以创建了一个更简单的指令来处理它。

```
.directive('allowDisabledOptions',['$timeout', function($timeout) {
    return function(scope, element, attrs) {
        var ele = element;
        var scopeObj = attrs.allowDisabledOptions;
        $timeout(function(){
            var DS = ele.scope()[scopeObj];
            var options = ele.children();
            for(var i=0;i<DS.length;i++) {
                if(!DS[i].enabled) {
                    options.eq(i).attr('disabled', 'disabled');
                }
            }
        });
    }
}]) 
```

更多详情：[https ://github.com/farazshuja/disabled-options](https://github.com/farazshuja/disabled-options)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-10-22T10:55:28.610

我还隐藏了添加休闲线的禁用选项：

`$(this).css("display", fnDisableIfTrue(scope, locals) ? "none" : "block");`

这是必要的，因为我不能简单地将它们过滤掉，因为此选择的初始值可能是禁用的选项之一。

# java - GAE 持久值不在已部署的应用程序中更新，而是在本地更新

> ID：16202255
> 
> 赞同：1
> 
> 时间：2013-04-24T21:09:57.740
> 
> 标签：java, google-app-engine, persistence, jdo

目前我正在做一个涉及使用 JDO 的 GAE 的小项目，但是我似乎在持久化更新的数据时遇到了问题——奇怪的是它在本地工作，但在应用程序的部署版本中却没有。更新非常简单：

```
update(Foo newBar) {
    PersistenceManager pm = PMF.get().getPersistenceManager();
    Transaction trans = pm.currentTransaction();
    trans.begin();
    Foo bar = pm.getObjectById(Foo.class, "someId");
    bar.baz = newBar.baz;
    pm.makePersistent(bar);
    trans.commit();
    pm.close();
} 
```

我在这里有什么遗漏吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T06:35:01.240

直接更新公共字段？哦亲爱的。如果您这样做，则没有持久性机制希望知道您更新了该字段。使用设置器，或将更新类增强为@PersistenceAware。

检查日志会发现很多东西，比如调用 makePersistent 没有任何价值

# linq - 有条件地添加 .Take()

> ID：16202256
> 
> 赞同：13
> 
> 时间：2013-04-24T21:09:57.760
> 
> 标签：linq, c#-4.0

目前我有这个自动占用 500 行：

```
var orderQuery = subsetTable.Where(pred).OrderByDescending(o => o.CreationDate).Take(500); 
```

我想让 Take() 有条件，像这样：

```
var orderQuery = subsetTable.Where(pred).OrderByDescending(o => o.CreationDate);
if (condition)
    orderQuery = orderQuery.Take(500); 
```

这可能吗？

编辑：
编译器说

> “无法将类型 'System.Linq.IQueryable' 隐式转换为 'System.Linq.IOrderedQueryable'。”

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-24T21:26:29.207

添加“AsQueryable”以使类型对齐：

```
var orderQuery = subsetTable.Where(pred).OrderByDescending(o => o.CreationDate).AsQueryable();
if (condition)
    orderQuery = orderQuery.Take(500); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-24T21:17:45.513

在 Linq-to-Objects 中，`var`将推断`IOrderedEnumerable<T>`，其中`T`是您的对象的类型。将`Take()`产生一个`IEnumerable<T>`，因此您的代码行将不被允许。（IOrderedEnumerable 比 IEnumerable 指定更多，您需要以较少指定的方式键入查询。）而且，正如评论所指出的，对于根据 处理的提供程序也是如此`IQueryable<T>`，它本身可以表示为指定`IEnumerable<T>`。

要使其工作，请将您的查询显式键入您需要的较少指定的类型，`IEnumerable<T>`或者`IQueryable<T>`，然后您可以应用您的条件`Take`。

```
IEnumerable<YourType> orderedQuery = ...
if (condition)
     orderedQuery = orderedQuery.Take(n); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-24T21:11:13.480

> 这可能吗？

是的。您的代码应该几乎可以像编写的那样工作。你只需要消除`var`. 假设您的类型是`Order`. 你会使用：

```
IQueryable<Order> orderQuery = subsetTable.Where(pred).OrderByDescending(o => o.CreationDate);
if (condition)
    orderQuery = orderQuery.Take(500); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-04-24T21:31:53.650

我所做的是在最后添加排序，以避免必须转换它们

```
var orderQuery = subsetTable.Where(pred);

if (condition)
    orderQuery = orderQuery.Take(500);

orderQuery = orderQuery.OrderByDescending(o => o.CreationDate); 
```

# uiview - 使用 CALayer 和自动布局的 UIView 自定义边框

> ID：16202263
> 
> 赞同：3
> 
> 时间：2013-04-24T21:10:51.310
> 
> 标签：uiview, calayer, autolayout

我必须为 UIView 绘制自定义边框。

我已经有代码可以做到这一点，但它是在我们开始使用自动布局之前编写的。

代码基本上加了一个width/height=1.0f的子层

```
-(void)BordeIzquierdo:(UIColor *)pcColor cfloatTamanio:(CGFloat )pcfloatTamanio
{
    CALayer* clElemento = [self layer];
    CALayer *clDerecho = [CALayer layer];
    clDerecho.borderColor = [UIColor darkGrayColor].CGColor;
    clDerecho.borderWidth = pcfloatTamanio;
    clDerecho.frame = CGRectMake(0, 1, pcfloatTamanio, self.frame.size.height);
    [clDerecho setBorderColor:pcColor.CGColor];
    [clElemento addSublayer:clDerecho];
} 
```

现在的问题是，使用自动布局，这发生在 layoutSubViews 之前。(0,0;0,0) 也是如此`UIView.layer.frame`，因此添加的子层未显示，因为它的宽度/高度=0.0f

现在如何在不将此自定义绘图转移到另一个方法之后执行此代码，`viewDidLoad`例如`didLayoutSubviews`.

我希望在`viewDidLoad`调用之前正确应用此样式。

*   有什么像我可以使用的自动布局约束`CALayers`吗？
*   还有其他想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T22:04:07.003

iOS 中没有 CALayer 自动调整大小或约束。（在 Mac OS X 上有，但在 iOS 中没有。）

你这里的要求是不合理的。您说您拒绝将呼叫移至`BordeIzquierdo:`。但是在您知道（因此）的大小之前，您*无法*给出正确的大小。Cocoa 触控编程的一半艺术在于将您的代码放在正确的位置。您*必须*找到正确的位置来进行调用，以便您需要的值在调用时具有意义。`clDerecho``self``self.layer`*`BordeIzquierdo:`*

 *我要做的就是把它`layoutSubviews`和一个 BOOL 标志放在一起，这样你就只做一次。*

# java - Java字符串方法错误

> ID：16202265
> 
> 赞同：0
> 
> 时间：2013-04-24T21:11:00.137
> 
> 标签：java, class

我准备了 Date 和 DateTest 类，如下所示；

**日期类**

```
public Date( String m, int d, int y)
{
this("m",d,y);
} 
```

**日期测试类**

```
Date myDate2 = new Date("april",18 , 2013);
System.out.println(myDate2); 
```

但我收到以下错误消息。谁能告诉我问题是什么以及如何解决它。

**线程“main”java.lang.Error 中的错误消息** 异常：未解决的编译问题：递归构造函数调用 Date(String, int, int)

```
at Date.<init>(Date.java:24)
at DateTest.main(DateTest.java:10) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T21:12:08.517

从错误消息来看，我会说调用`this()`, 是导致问题的原因

```
public Date( String m, int d, int y)
{
this("m",d,y);
} 
```

显然在你的构造函数中调用`this("m",d,y);`意味着你在你的构造函数中进行递归调用，这甚至没有意义。

* * *

我的猜测是，也许您正在寻求按照以下方式做一些事情

```
public Date( String m, int d, int y)
{
    this.Month = m;
    this.Day = d;
    this.Year = y;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:16:32.163

在构造函数中调用 this 会使其无限递归。因此出现了这个错误。您最好使用一些 setter 方法创建构造函数。阅读构造函数设计模式，这应该会有所帮助。

# node.js - node.js 错误回调语法

> ID：16202267
> 
> 赞同：2
> 
> 时间：2013-04-24T21:11:01.553
> 
> 标签：node.js

我是一个nodejs新手，我正在寻找一些关于风格的指导。我有一个简单的路线，即调用下面定义的**get**函数：

```
var gameSchema = new Schema({
ExecutableName : String,
Name : String,
});

var Game = mongoose.model('games', gameSchema );

var get = function( id, func ) {

    Game.findById( id )
        .exec( function( err, doc ) {
            if( err ) {
                func( err );
            } else {
                func( null, doc );
            }
    });
}; 
```

在语法上，我相信该函数可以重写为：

```
var get = function( id, func ) {

    Game.findById( id )
        .exec( function( err, doc ) {
            func( err, doc );
    });
}; 
```

从风格的角度来看，一种方法比另一种更受欢迎吗？为了可读性和减少嵌套，我喜欢第二个定义。但是，我想跟踪流行的风格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:37:32.880

你可以重写为：

```
var get = function( id, func ) {
    Game.findById( id )
        .exec( func );
}; 
```

我认为以这种方式阅读更容易。

# android - 当我将构建目标更改回 2.3.3 时出现错误

> ID：16202268
> 
> 赞同：0
> 
> 时间：2013-04-24T21:11:02.440
> 
> 标签：android, themes

当我将构建目标更改为 2.3.3 时，style.xml 中出现错误，我想我需要将主题从全息更改为某些东西，但我不知道任何主题名称

这里是错误所在的行

```
<style name="AppBaseTheme" parent="android:Theme.Holo.Light"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:26:54.547

如果您正在使用动作栏等高级功能，那么有一个名为 SherlocActionBar 的库项目，您可以尝试使用它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:15:30.800

旧的 android 版本不支持 Holo 主题。一个快速的选择可能是这个

```
<style name="LightThemeSelector" parent="@android:style/Theme.Light">
    ...
</style> 
```

[更多主题信息](http://developer.android.com/guide/topics/ui/themes.html)

# database - 尝试编写一个简单的 Joomla 插件

> ID：16202269
> 
> 赞同：0
> 
> 时间：2013-04-24T21:11:03.370
> 
> 标签：database, joomla, joomla2.5, updating

请帮忙，这是我写的第一个插件，我完全迷路了。我正在尝试使用我的自定义**giveBadge()**函数在 joomla 数据库的表中写入和更新信息。这些函数接收两个不同的变量，第一个变量是**$userID**，第二个变量是数字**300 ，我使用****giveBadge(300)**在类的底部传递它。同时比较 Joomla 数据库中的**$userID**以确保将数字**300**分配给登录 Joomla 站点的当前用户。

提前致谢。

```
<?php

     defined('JPATH_BASE') or die;

      class plgUserBadge extends JPlugin
      {
           public function onUserLogin () {
                $user =& JFactory::getUser();
                $userID =& user->userID;

                return $userID;
           }

           public function giveBadge ($userID, &$badgeID) {
                // Get a db connection.
                $db = JFactory::getDbo();

                // Create a new query object.
                $query = $db->getQuery(true);

                // Fields to update.
                $fields = array(
                    'profile_value=\'Updating custom message for user 1001.\'',
                    'ordering=2');

                // Conditions for which records should be updated.
                $conditions = array(
                    'user_id='.$userID, 
                    'profile_key=\'custom.message\'');

                $query->update($db->quoteName('#__user_badges'))->set($fields)->where($conditions);

                $db->setQuery($query);

                try {
                    $result = $db->query(); 
                } catch (Exception $e) {
                    // Catch the error.
                }es = array(1001, $db->quote('custom.message'), $db->quote('Inserting a record using insert()'), 1);

            }   

        }

     giveBadge(300);  //attaches to $badgeID    

    ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T15:21:27.410

您的代码进展不顺利：

*   您可以在所有代码 (&) 中**通过引用删除分配**- 在 99% 的情况下，您真的不需要它。
*   **使用 IDE**（例如带有 PDT 的 Eclipse）。在您的代码顶部，`& user->userID;`任何 IDE 都会发现您的错误以及代码中的其他内容。
*   研究现有插件以了解它们的工作原理。这也是[关于插件的文档](http://docs.joomla.org/Plugin/Events/User#onUserLogin)。
*   **当特定事件被触发时（当您的插件被激活时）**，Joomla 将自动调用 onUserLogin() 方法。**检查`die("My plugin was called")`你的插件是否真的被调用**
***   **在 onUserLogin() 中，您执行所有业务逻辑。**你不应该返回一些东西，只需要返回 true。现在你的方法完全没有任何作用。但是您可以调用 $this->giveBadge() 将逻辑移动到另一个方法。**

# android - Intent extras 不是通过引用传递的？

> ID：16202274
> 
> 赞同：3
> 
> 时间：2013-04-24T21:11:32.123
> 
> 标签：android, android-intent

我有一个实现 Serializable 的自定义类型对象，并且我能够成功地通过我的活动传递这个对象。

现在的情况是这样的：

在 Activity 1 上，CustomObject 实例有一个 String 属性，其值为“A”，并作为 Extra 传递给 Activity 2：

```
Intent intent = new Intent(getApplicationContext(), Activity_2.class);
intent.putExtra("CUSTOM_OBJECT", customObjectInstance);

startActivityForResult(intent, 0); 
```

在活动 2 中，我从 Intent 中检索 CustomObject 并将属性值从“A”修改为“B”。

当我按下返回按钮，从 Activity 2 回到 Activity 1 时，CustomObject 的属性值又是“A”了！

我检查了对象的哈希码并确认在两个活动上是同一个实例，但仍然无法弄清楚为什么会发生这种情况。

**编辑：**

根据要求，关于我设置属性值的代码，它尽可能简单：

关于活动 2：

```
CustomObject obj = (CustomObject) getIntent().getExtras().getSerializable("CUSTOM_OBJECT");
obj.setProperty("B"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:19:29.903

Intent 的 extras 仅包含值。您可以通过扩展 Application 类和部署“全局”变量来通过引用处理参数。

尽管您表示两个对象的哈希码相同，但我很确定每个 Activity 都处理自己的一组局部变量。在您的测试中，活动 A 和 B 中的对象是相互独立的。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:19:28.387

您是否在 Activity 中调用 setResult(int) 返回结果？这是有关为结果启动活动的文档。

> 它必须始终提供结果代码，可以是标准结果 RESULT_CANCELED、RESULT_OK 或任何以 RESULT_FIRST_USER 开头的自定义值。此外，它还可以选择返回一个 Intent，其中包含它想要的任何附加数据。所有这些信息连同它最初提供的整数标识符一起出现在父级的 Activity.onActivityResult() 上。
> 
> 如果子活动因任何原因（例如崩溃）失败，则父活动将收到带有代码 RESULT_CANCELED 的结果。

[http://developer.android.com/reference/android/app/Activity.html#StartingActivities](http://developer.android.com/reference/android/app/Activity.html#StartingActivities)

# java - java arraylist 包含对象的类型

> ID：16202276
> 
> 赞同：0
> 
> 时间：2013-04-24T21:11:38.283
> 
> 标签：java, arrays, list, arraylist

我有一个对象 Edges，它有 5 种不同的整数类型与该对象相关联。像这样：

```
public class Edge implements Comparable {

int weight, tox, toy, fromx, fromy;

public Edge(int x1, int y1, int x2, int y2, int wei) {
    tox = x1;
    toy = y1;
    fromx = x2;
    fromy = y2;
    weight = wei;

}

public int compareTo(Object obj) { 
```

我想创建这些 objs 的数组列表，然后在列表上调用 contains 以查看任意整数是否在任何这些数据类型的列表中，edge.tox edge.toy edge.fromx 或 edge.fromy ... 。 有没有办法做到这一点？

谢谢你先进

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:15:18.497

将此方法添加到`Edge`类中

```
public boolean contains(int num) {
    if(tox == num) return true;
    if(fromx == num) return true;
    if(toy == num) return true;
    if(fromy == num) return true;
    return false;
} 
```

然后你可以这样做：

```
public Edge getEdgeFromNumber(int number) {
  for(Edge e : myArrayList) { 
      if(e.contains(number)) return e;
  }
  return null; // there are no such edges
} 
```

另外，不要使用原始类型`Comparable`，您可能想要`Comparable<Edge>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T21:15:26.420

用这个：

```
public List<Integer> asList() {
    Arrays.asList(weight, tox, toy, fromx, fromy);
} 
```

# symfony - symfony2 原则选择 IFNULL

> ID：16202277
> 
> 赞同：14
> 
> 时间：2013-04-24T21:11:39.450
> 
> 标签：symfony, doctrine, query-builder, ifnull

好的，我有这个代码：

```
SELECT 
IFNULL(s2.id,s1.id) AS effectiveID, 
IFNULL(s2.status, s1.status) AS effectiveStatus, 
IFNULL(s2.user_id, s1.user_id) as effectiveUser,
IFNULL(s2.likes_count, s1.likes_count) as effectiveLikesCount

FROM statuses AS s1
LEFT JOIN statuses AS s2 ON s2.id = s1.shared_from_id
WHERE s1.user_id = 4310
ORDER BY effectiveID DESC
LIMIT 15 
```

我需要将它重写为querybuilder。类似的东西？

```
 $fields = array('IFNULL(s2.id,s1.id) AS effectiveID','IFNULL(s2.status, s1.status) AS effectiveStatus', 'IFNULL(s2.user_id, s1.user_id) as effectiveUser','IFNULL(s2.likes_count, s1.likes_count) as effectiveLikesCount');

    $qb=$this->_em->createQueryBuilder()
             ->select($fields)
             ->from('WallBundle:Status','s1')
             ->addSelect('u')
             ->where('s1.user = :user')
             ->andWhere('s1.admin_status = false')
             ->andWhere('s1.typ_statusu != :group')
             ->setParameter('user', $user)
             ->setParameter('group', 'group')
             ->leftJoin('WallBundle:Status','s2', 'WITH', 's2.id=s1.shared_from_id')  
             ->innerJoin('s1.user', 'u')               
             ->orderBy('s1.time', 'DESC')
             ->setMaxResults(15);

     var_dump($query=$qb->getQuery()->getResult());die(); 
```

这个错误是

```
[Syntax Error] line 0, col 7: Error: Expected known function, got 'IFNULL' 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-08-28T09:43:06.383

Use **COALESCE** instead of IFNULL like this

```
$fields = array('COALESCE(s2.id,s1.id) AS effectiveID','COALESCE(s2.status, s1.status) AS effectiveStatus', 'COALESCE(s2.user_id, s1.user_id) as effectiveUser','COALESCE(s2.likes_count, s1.likes_count) as effectiveLikesCount'); 
```

COALESCE return the first value not null in the list, so if A is null and B not null, then `COALESCE(A,B)` will return B.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-05T15:28:57.760

有一个 Doctrine 扩展添加了这个。

这是来自 IFNULL 的 DQL 文件。 [https://github.com/beberlei/DoctrineExtensions/blob/master/src/Query/Mysql/IfNull.php](https://github.com/beberlei/DoctrineExtensions/blob/master/src/Query/Mysql/IfNull.php)

本章解释了如何使用它们。 [http://symfony.com/doc/2.0/cookbook/doctrine/custom_dql_functions.html](http://symfony.com/doc/2.0/cookbook/doctrine/custom_dql_functions.html)

# html - 菜单无序列表上的奇怪填充 - 无法删除

> ID：16202278
> 
> 赞同：2
> 
> 时间：2013-04-24T21:11:43.577
> 
> 标签：html, css

我的菜单上有一个非常奇怪的填充。填充出现在菜单按钮的顶部和二级菜单按钮的下方。

我已经尝试了各种边距、边框和填充的组合，但我就是无法摆脱这种额外的颜色！

*请注意：人们推荐（并删除了他们的评论）我删除了 CSS：

```
margin-top: -0.5em; 
```

但是，如果可能的话，我希望保持原样。 *

不幸的是，我无法发布图片，因为我需要更多的声誉点（我是编码新手，甚至是 Stackoverflow 的新手），但如果有人可以查看我下面的代码，看看我哪里出错了，那就太好了！

我的 HTML 代码：

```
<ul id="menu" >
<li style="margin-left: 3em;"><a href="#">Home</a></li>
<li class="sub">
<a href="#">Our Services</a>
<ul>
<li><a href="#">Solar PV</a></li>
<li><a href="#">Air Tightness Testing</a></li>
<li><a href="#">Thermal Imaging</a></li>
<li><a href="#">Wind Turbines</a></li>
<li><a href="#">Energy Consultancy</a></li>
</ul>
</li>
<li><a href="#">Recent Projects</a></li>
<li><a href="#">About</a></li>
<li><a href="#">Contact</a></li>
</ul> 
```

我的 CSS 代码：

```
#menu {
margin: 0;
padding: 0;
background: #201f5f;
height: 3em;
list-style: none;
font-family:arial;
}

#menu > li {

margin-right: 3em;
margin-top: -0.5em;
background:#201f5f;
vertical-align: bottom;
}

#menu > li > a {
height: 3em;
color: #ffffff;
text-decoration: none;
line-height: 3;
font-weight: bold;
text-transform: uppercase;
}

#menu > li > a:hover {
color: #41A044;
text-decoration: underline;
}

#menu > li.sub {
position: relative;
}

#menu > li.sub ul {
font-size:15px;
margin: 0;
padding: 0;
list-style: none;
background: #000000;
position: absolute;
top: -1000em;
width: 649px;
left:-87px;
}

#menu > li.sub ul li {
display: inline-block;

}

#menu > li.sub ul li a {
height: 100%;
display: inline;
float: left;
padding-left: 0.4em;
padding-right: 0.4em;
padding-top: 0;
padding-bottom: 0;
color: #fff;
font-weight: bold;
text-decoration: none;

}

#menu > li.sub ul li a:hover {
background: #41A044;
text-decoration: underline;
position: relative;
}

#menu > li.sub:hover ul {
top: 2.15em;
}

#menu{
text-align:center;
}

li{
display:inline-block;
} 
```

我提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:34:24.533

我删除了您设置的边距值 DEMO [http://jsfiddle.net/gSCr4/4/](http://jsfiddle.net/gSCr4/4/)

```
margin-top: -0.5em; //Removed 
```

# c# - 向 System.Drawings.Color 添加颜色选项

> ID：16202279
> 
> 赞同：12
> 
> 时间：2013-04-24T21:11:44.623
> 
> 标签：c#, asp.net, visual-studio-2012, system.drawing, asp.net-4.5

在 Visual Studio 中，当在标记（或代码隐藏）中创建控件时，您可以指定 HEX 格式的颜色，如下所示：“#FFFFFF”，但您也可以从预设颜色列表中进行选择，例如：白色、小麦、窗口等（见截图）。
是否可以扩展该列表并添加其他颜色？
![在此处输入图像描述](https://i.stack.imgur.com/1AjUQ.png)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-26T23:01:11.580

此列表基于[`System.Drawing.KnownColor`](http://msdn.microsoft.com/en-us/library/system.drawing.knowncolor%28v=vs.100%29.aspx)枚举值。由于枚举[无法扩展](https://stackoverflow.com/questions/16202279/add-color-options-to-system-drawings-color)并且您[不能从另一个枚举继承](https://stackoverflow.com/questions/757684/enum-inheritance)，因此如果您想创建具有更多命名颜色的列表以在您自己的代码中使用，您必须使用手动添加的这些值以及您希望在那里看到的其他值来实现您自己的枚举.

当然，除了`System.Drawing.KnownColor`enum 之外，`Color`struct 中还有一个方法用于获取这个命名颜色 - 的值[`Color.FromKnownColor`](http://msdn.microsoft.com/en-us/library/system.drawing.color.fromknowncolor%28v=vs.100%29.aspx)。我认为您还应该向 struct 添加扩展方法，`Color`该方法将对您自己的枚举执行相同的操作，就像`FromKnownColor`方法对`KnownColor`枚举一样。也许你甚至可以`FromKnownColor`在你自己的扩展方法中使用方法来简化这个标准枚举中已经存在的颜色。

但是，如果您只想在 ASP.NET 设计器中扩展这一列表，则无法通过在您自己的项目中进行任何更改或通过更改 VS 中的选项来做到这一点。也许您可以为 Visual Studio 编写一个加载项来执行此操作，但这是我看到的唯一方法，如果这是您想要做的。

**编辑**：如果继承控件是您的一个选项，也许您可​​以获得的最佳答案是**simplecoder**建议的答案，如[他的回答](https://stackoverflow.com/a/16248084/1816426)中所述- 基于旧控件创建自己的控件，并将此新枚举值绑定到属性你想使用新的颜色。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-27T03:40:01.860

正如@Sayse 指出的那样，您不能创建扩展属性：为什么？阅读：[MSDN 博客](http://blogs.msdn.com/b/ericlippert/archive/2009/10/05/why-no-extension-properties.aspx) 一种方法是创建扩展方法并使用它。@Sayse 指出 @Konrad 指出了 KnownColor Enum 的问题

所以这里有一个稍微扭曲的解决方案。

通过继承控制类，我很肯定这应该有效。这涉及的工作很少，但是一旦掌握了它，它就会非常简单。

1.  继承 Control 类，例如 MyCustomButton 继承 System.web.UI.WebControls.Button
2.  创建一个新的属性 BackColor2 ，它作为 MyColor 的新枚举使用
3.  覆盖 BackColor 属性，BackColor 定义在 Button 的父类中，即
    System.Web.Ui.WebControls.WebControl

4.  将 BackColor Set 属性设置为 Private 并将其链接到 BackColor 2

如果您需要现有的颜色，则将它们复制到您的新枚举中。使用反射器

![在此处输入图像描述](https://i.stack.imgur.com/uY6FU.png)

![在此处输入图像描述](https://i.stack.imgur.com/lKOr6.png)

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Drawing;
using System.ComponentModel;

namespace ClassLibrary1
{
    public class MyButton : System.Web.UI.WebControls.Button
    {

        [DefaultValue(typeof(Color), "")]
        public virtual Color BackColor
        {
            get
            {
                if (!this.ControlStyleCreated)
                    return Color.Empty;
                else
                    return this.ControlStyle.BackColor;
            }
            private set
            {
               // this.ControlStyle.BackColor = value;  , OVerride it with your  MyColor
                this.ControlStyle.BackColor =YourMethodConvertMyColorToColor(this.BackColor2);
            }
        }

        private Color YourMethodConvertMyColorToColor(MyColor c){
            //your implementation 
            if (c == MyColor.MyColorGreen)
            {
                return ColorTranslator.FromHtml("#FF0000"); ; //just example
            }

            return Color.Green;//default
        }

        MyColor _mycolor;  //Global Value

        [DefaultValue(typeof(MyColor), "")]
        public  MyColor BackColor2
        {
            get
            {
                return _mycolor;
            }
            set
            {
                this._mycolor = value;
            }
        }
    }

    public enum MyColor
    {
       MyColorGreen=1,
       MyColorBlue=2
    }
} 
```

**编辑： System.Drawing.Color 是结构，所以它不能被继承。这是表演塞。这就是为什么我认为继承控制权只是一个解决方案**

我也尝试添加这样的扩展方法，但它对我不起作用。在设计师中我看不到 myColor

```
public static class MyExtensions
    {
        public static System.Drawing.Color MyColor(this System.Drawing.Color c)
        {
            return Color.AliceBlue;  // could be your color
        }
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-27T02:41:15.130

您需要编写自己的控件并为 Visual Studio 添加设计时支持。这可以让您直接从 VS Toolbox 中使用它。为了快速解决，请考虑使用以下代码在代码中定义颜色：

```
using System.Drawing;

this.myButton.BackColor = ColorTranslator.FromHtml("#FF0000"); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-24T21:25:14.527

不是直接的，因为您无法创建扩展属性。

一种解决方案是制作扩展方法

```
 public static Color MyNewColor(this Color str)
    {
        return Color.FromArgb(255, 255, 255, 255);
    } 
```

然后可以从 `(new Color()).MyNewColor()`

如此略有不同并且可能效率较低，因为它创建两种颜色而不是像现有属性那样创建一种颜色，但会实现您正在寻找的东西..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-03T18:27:17.887

您确实无法编辑 .Net Framework 提供的此列表来添加您选择的其他颜色。正如@Konrad Gadzina 在上面的帖子中总结的那样，原因很明显。您可以按照@simplecoder 的建议选择替代方式。

但我宁愿说，使用 Pick Color 功能来获取您选择的颜色，而不是通过所有这些艰难的方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-01T19:48:03.587

您可以创建自己的下拉列表，其中包含现有列表中的所有颜色。

```
 Dim colorList as new DropDownList()
    Dim colorArray As String() = System.Enum.GetNames(GetType(KnownColor))
    colorList.DataSource = colorArray 
    colorList.DataBind() 
```

现在您可以将自己的手动颜色添加到列表中。

```
 colorList.Items.Add(newcolor.ToString) 
```

当然要在 Visual Studio IDE 中使用它，您必须创建自己的 Visual Studio 插件。

# jquery - 我希望能够选择第二个或第三个 li 而不仅仅是第一个

> ID：16202282
> 
> 赞同：0
> 
> 时间：2013-04-24T21:12:04.657
> 
> 标签：jquery, selector

我尝试使用 .not ("li.level-2") 来显示第二个 li .. 不走运

```
$(document).ready(function() {
// Collapse everything but the first menu:
$("#VerColMenu > li > a").not(":first").find("+ ul").slideUp(1);
//$("#VerColMenu > li > a").not("li.level-2").find("+ ul").slideUp(1);
// Expand or collapse:
$("#VerColMenu > li > a").click(function() {
    $(this).find("+ ul").slideToggle("fast");
});
   }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:25:23.210

您正在选择“a”标签而不是“li”标签。如果您想选择所有“li”标签但第一次尝试

```
$("#VerColMenu li").not(":first").each(function (){
    ...
}); 
```

# sql - SQL 'WHERE' 与 'ON'（内连接）

> ID：16202285
> 
> 赞同：0
> 
> 时间：2013-04-24T21:12:08.933
> 
> 标签：sql

在执行 SQL 查询时，

“WHERE”和“ON”之间的性能是否存在显着（或根本）差异？

我知道对于 LEFT 或 RIGHT JOIN，两者之间的结果集存在显着差异。

INNER JOIN 怎么样？

对我的每个选择使用“ON”而不是最后的“WHERE”有什么缺点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:15:40.297

性能方面，它们应该是相同的。但是，请参阅[这篇](https://sqlblog.org/2009/10/08/bad-habits-to-kick-using-old-style-joins)文章，了解行业资深人士对可读性和维护友好性的看法。

虽然旧式连接仍然有效，但你不能`outer join` [再做](http://blogs.technet.com/b/wardpond/archive/2008/09/13/deprecation-of-old-style-join-syntax-only-a-partial-thing.aspx?Redirected=true)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:15:42.607

两者的执行计划是相同的。许多人更喜欢使用`ON`虽然。

# mysql - 为什么即使文件不存在，SELECT INTO OUTFILE 也会给出文件存在错误？

> ID：16202286
> 
> 赞同：3
> 
> 时间：2013-04-24T21:12:11.480
> 
> 标签：mysql

该文件肯定不存在，但无论如何我都会收到错误消息。

我愿意：

```
$ rm /tmp/records_materialized_view.txt;
$ mysql ... 

> SELECT * FROM records_materialized_view INTO OUTFILE '/tmp/records_materialized_view.txt';

ERROR 1086 (HY000): File '/tmp/records_materialized_view.txt' already exists 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T21:14:41.787

`SELECT INTO OUTFILE`将结果写入服务器文件。

您是否正在检查服务器上的文件是否存在？

如果要选择到客户端计算机上的本地文件，只需重定向`mysql`输出：

```
mysql mydb < script.sql > /tmp/records_materialized_view.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-28T06:46:54.847

当我遇到类似问题时遇到了这个答案。

我意识到`SELECT INTO OUTFILE`不会覆盖文件，您必须自己清理它们。所以下次写的时候会出现这个错误。不确定上述答案是什么意思，文件被写入服务器文件。

此外，`SELECT INTO OUTFILE`默认情况下会写入相对于您的 db 数据目录的文件。默认位置即

```
/var/lib/mysql/ 
```

因此，如果您检查您的 db 数据目录，您应该在那里找到您的文件。使用绝对路径来精确控制您希望文件结束的位置。这正是我所追求的，希望它可以帮助某人。干杯。

# haskell - Haskell 函数组合、(.)(.) 的类型及其呈现方式

> ID：16202289
> 
> 赞同：3
> 
> 时间：2013-04-24T21:12:26.170
> 
> 标签：haskell, types, operator-keyword, function-composition

所以我知道：

```
(.) = (f.g) x = f (g x) 
```

它的类型是 (B->C)->(A->B)->A->C 但是呢：

```
(.)(.) = _? = _? 
```

这是如何表示的？我想到了：

```
(.)(.) = (f.g)(f.g)x = f(g(f(g x))) // this
(.)(.) = (f.g.h)x = f(g(h x)) // or this 
```

但就我试图获得它的类型而言，GHCi 告诉我的内容是不正确的。那么两个“_”是什么？

另外 - 函数/运算符**$**做什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-24T21:33:44.030

首先，你的符号很草率。

```
(.) = (f.g) x = f (g x)  -- this isn't true 
```

什么是真的：

```
(.) f g x = (f.g) x = f (g x)
(.) = \f g x -> f (g x) 
```

它的类型由下式给出

```
(.) :: (b -> c) -> (a -> b) -> a -> c
       -- n.b. lower case, because they're type *variables* 
```

同时

```
(.)(.) :: (a -> b -> d) -> a -> (c -> b) -> c -> d
          -- I renamed the variables ghci gave me 
```

现在让我们解决

```
(.)(.) = (\f' g' x' -> f' (g' x')) (\f g x -> f (g x))
       = \g' x' -> (\f g x -> f (g x)) (g' x')
       = \g' x' -> \g x -> (g' x') (g x)
       = \f y -> \g x -> (f y) (g x)
       = \f y g x -> f y (g x)
       = \f y g x -> (f y . g) x
       = \f y g -> f y . g 
```

* * *

和`($)`？

```
($) :: (a -> b) -> a -> b
f $ x = f x 
```

`($)`只是功能应用程序。但是，虽然通过并置的函数应用具有高优先级，但通过函数应用的优先级`($)`较低。

```
square $ 1 + 2 * 3 = square (1 + 2 * 3)
square 1 + 2 * 3 = (square 1) + 2 * 3  -- these lines are different 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-24T22:32:09.783

正如 dave4420 提到的，

```
(.) :: (b -> c) -> (a -> b) -> a -> c 
```

那么是什么类型的`(.) (.)`呢？dave4420 跳过那部分，所以它是：`(.)`接受一个类型的值`b -> c`作为它的第一个参数，所以

```
(.) :: (   b     ->       c             ) -> (a -> b) -> a -> c
(.) ::  (d -> e) -> ((f -> d) -> f -> e) 
```

所以我们有`b ~ d->e`and `c ~ (f -> d) -> f -> e`，结果类型`(.)(.)`是`(a -> b) -> a -> c`。代入，我们得到

```
(a -> d -> e) -> a -> (f -> d) -> f -> e 
```

重命名，我们得到`(a -> b -> c) -> a -> (d -> b) -> d -> c`. 这是一个`f`需要二元函数`g`、一个值`x`、一个一元函数`h`和另一个值的函数`y`：

```
f g x h y = g x (h y) 
```

这是可以实现这种类型的唯一方法：`g x :: b -> c`,`h y :: b`和 so `g x (h y) :: c`，根据需要。

当然，在 Haskell 中，“一元”函数需要一个*或多个*参数。类似地，“二进制”函数需要两个*或多个*参数。但不少于两个（所以使用 eg`succ`是不可能的）。

* * *

我们也可以通过编写方程式，*[组合](http://en.wikipedia.org/wiki/Combinatory_logic)符式*¹来解决这个问题。[等式推理很*容易*](https://stackoverflow.com/a/15030418/849891)：

```
(.) (.) x y z w q = 
((.) . x) y z w q =
(.) (x y) z w q =
(x y . z) w q =
x y (z w) q 
```

我们只是根据需要将尽可能多的变量放入混合中，然后来回应用定义。`q`这是一个额外的，所以我们可以把它扔掉并得到最终的定义，

```
_BB x y z w = x y (z w) 
```

（巧合的是，`(.)`被称为[**B** -combinator](http://en.wikipedia.org/wiki/Combinatory_logic#Combinators_B.2C_C)）。

* * *

¹ `a b c = (\x -> ... body ...)`等价于`a b c x = ... body ...`，反之亦然，前提是`x`不出现在 之间`{a,b,c}`。

# ruby - OptionParser 解析参数表单文件而不是命令行

> ID：16202290
> 
> 赞同：0
> 
> 时间：2013-04-24T21:12:30.483
> 
> 标签：ruby, arguments, optparse, optionparser

我正在使用 Ruby 执行带有命令行参数的代码。现在我尝试使用具有不同选项的同一程序，因此我将选项放在一个文件中，并且我希望程序读取每一行解释选项并相应地执行程序。

但我得到这个错误。"C:/Ruby193/lib/ruby/1.9.1/optparse.rb:1348:in `block in parse_in_order': undefined method`shift' for "--c execue --query unix --Servername abc123":String (NoMethodError)"

我知道它读取文件并将该行视为字符串。但想知道是否有办法克服这个移位错误并将该行视为在命令提示符中输入。或任何更好的解决方案。

这是我的代码。

```
require 'optparse'
require 'micro-optparse'
# --command execue --query unix command --Servername abc123
f =File.open("list_of_commands.txt", "r")
f.each_line { |line| 
line= line.chomp
#line = "--c execue --query unix --Servername abc123"
#line = eval("\"#{line}\"")
puts line

 options = {}
OptionParser.new do |opts|

  opts.on("-c", "--command result,execue,chart,scpfile", String, "Single command to execute ") do |c|
    options[:comd] = c
  end

  opts.on("-q", "--query remote command, unix command", String, "performs the command on local or remote machine") do |q|
    options[:query] = q
  end

  opts.on("-s", "--servername CHSXEDWDC002 ", String, "server name to execute the command") do |v|
    options[:hname] = v
  end

    opts.on_tail('-h', '--help', 'Show this message') do
    puts opts
     exit
   end

 end.parse!(line)
 p options
 } 
```

该文件的内容如下 --c execue --query unix --Servername abc123

我也尝试使用 micro-optparse 但面临同样的错误。任何解决方法？

**更新：** 根据“@mu 太短”的建议，我尝试了以下选项。end.parse!("#{Shellwords.shellsplit(line)}") 和/或 end.parse!(Shellwords.shellsplit(line))。但他们都没有工作。

我还尝试使用“line = line.split("\t")" 将行拆分为数组，然后使用 end.parse!(line)。输出为 --c execue --query unix --Servername abc123

但现在我收到错误作为阻止：无效选项--c执行

**更新：#2** 查看错误，问题在于错误的参数（-c。但感谢用户**“@mu 太短”**建议使用 Array.

**更新： 3** 传递数组仅适用于短格式的参数，例如 -c，但是当提供长格式时，它会因无效参数错误而失败。

我没有看到关于 optparse 的太多文档。我什至尝试过微解析，但它需要默认值，这对我来说不是一个选项:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T03:34:02.813

虽然您可以将命令行参数放入文件、标志和所有内容中，但还有更好的方法来记住配置设置。

不要存储标志，而是使用[YAML](http://www.yaml.org/)文件。YAML 是一种出色的数据格式，可以轻松转换为 Ruby 哈希和对象。“ [Yaml Cookbook](http://www.yaml.org/YAML_for_ruby.html) ”是一个非常有用的页面，用于学习 Ruby 格式的来龙去脉。有无数其他语言的 YAML 解析器，可以轻松共享设置，随着系统的增长，这可能会很有用。

使用一些创意代码，您可以使用 YAML 作为基本设置，并让 CLI 标志覆盖存储的设置。

如果您不熟悉 YAML，可以使用以下内容轻松开始文件：

```
require 'yaml'

data = {
  'command' => %w[result execute chart scpfile],
  'query' => ['remote command', 'unix command'],
  'servername' => 'CHSXEDWHDC002',
}

puts data.to_yaml 
```

哪个输出：

```
---
command:
- result
- execute
- chart
- scpfile
query:
- remote command
- unix command
servername: CHSXEDWHDC002 
```

将该输出重定向到以 结尾的文件，`.yaml`然后您就可以使用了。

要将其读回脚本中，请使用：

```
require 'yaml'

data = YAML.load_file('path/to/data.yaml') 
```

快速往返测试显示：

```
require 'yaml'

data = {
  'command' => %w[result execute chart scpfile],
  'query' => ['remote command', 'unix command'],
  'servername' => 'CHSXEDWHDC002',
}

YAML.load(data.to_yaml) 
```

看起来像：

```
{"command"=>["result", "execute", "chart", "scpfile"],
"query"=>["remote command", "unix command"],
"servername"=>"CHSXEDWHDC002"} 
```

如果您想将默认值存储在 YAML 文件中，并用命令行标志覆盖它们，请从文件中读取数据，然后使用该结果对象作为 OptionParse 的基础：

```
require 'optparse'
require 'yaml'

# Note, YAML can deal with symbols as keys, but other languages might not like them.
options = {
  :comd => %w[result execute chart scpfile],
  :query => ['remote command', 'unix command'],
  :hname => 'CHSXEDWHDC002',
}

# we'll overwrite the options variable to pretend we loaded it from a file.
options = YAML.load(options.to_yaml)

OptionParser.new do |opts|

  opts.on("-c", "--Command result,execue,chart,scpfile", String, "Single command to execute ") do |c|
    options[:comd] = c
  end

  opts.on("-q", "--query remote command, unix command", String, "performs the command on local or remote machine") do |q|
    options[:query] = q
  end

  opts.on("-s", "--Servername CHSXEDWHDC002 ", String, "server name to execute the command") do |v|
    options[:hname] = v
  end

  opts.on_tail('-h', '--help', 'Show this message') do
    puts opts
    exit
  end

end.parse! 
```

这没有经过测试，但我们一直在工作中做类似的事情，所以把它保存到一个文件中，然后用一根棍子戳它一会儿，看看你想出了什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T22:00:43.240

该[`parse!`](https://ruby-doc.org/stdlib/libdoc/optparse/rdoc/OptionParser.html#method-i-parse-21)方法需要一个数组作为其参数，而不是字符串。您可能希望使用[`Shellwords.shellsplit`](https://ruby-doc.org/stdlib/libdoc/shellwords/rdoc/Shellwords.html#method-c-shellsplit)而不是[`String#split`](https://ruby-doc.org/core/String.html#method-i-split)（或类似的手动方法）将您的转换`line`为数组，以防万一您必须处理引用和诸如此类的事情。像这样的东西：

```
OptionParser.new do |opts|
  #...
end.parse!(Shellwords.shellsplit(line)) 
```

# python - 两个日期时间之间的 django 分钟

> ID：16202292
> 
> 赞同：1
> 
> 时间：2013-04-24T21:12:40.050
> 
> 标签：python, django, datetime

我知道这个问题之前已经被问过，我已经完成了各种答案以及文档：[http](http://docs.python.org/2/library/datetime.html#datetime-objects) ://docs.python.org/2/library/datetime.html#datetime-objects但我仍然没有能够计算两个日期时间字段之间的分钟数。

这是模型：

```
class Activity(models.Model):
    user = models.ForeignKey(User)

    created_date = models.DateTimeField(default=datetime.now)

    activity_type = models.IntegerField(default=0) 

    def time_posted_description(self):
        now = datetime.now()
        then = datetime.fromtimestamp(self.created_date)
        tdelta = now - then
        minutes = tdelta.total_minutes()

        return minutes 
```

风景：

def portal_game_activity_page（请求）：

```
activity = Activity.objects.filter(user=request.user).order_by('-created_date')

pending_requests_list = FriendshipRequest.objects.filter(to_user=request.user, accepted=False)
number_pending_requests = len(pending_requests_list)

return render(request, 'portal/portal_game_activity.html', {'game_activity_page': True,'number_pending_requests':number_pending_requests,'activity':activity, }) 
```

和模板：

```
{% extends "portal/portal_base.html" %}

{% block content %}
    <section>
        <table class="table">
            <tbody>
                {% for event in activity %}
                <tr>
                    <td>{{event.user}}</td>
                    <td>{{event.created_date}}</td>
                    <td>{{event.time_posted_description}}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>    
    </section>
{% endblock %} 
```

非常感谢任何反馈/帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T21:19:26.590

```
now = datetime.now()
then = self.created_date
tdelta = now - then
minutes = tdelta.total_seconds() / 60

return minutes 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T05:32:48.103

datetime.fromtimestamp get timestamp argument:

```
 then = datetime.fromtimestamp(self.created_date.second) 
```

'datetime.timedelta' object has no attribute 'total_minutes'

# google-chrome - 我将使用什么库/函数来创建邮件客户端？

> ID：16202295
> 
> 赞同：0
> 
> 时间：2013-04-24T21:12:55.723
> 
> 标签：google-chrome, google-chrome-extension, google-chrome-os

我正在尝试制作一个 HTML5/JS 的邮件客户端，用户必须在其中定义他们的邮件服务器和凭据。

我浏览了谷歌导致死胡同，并认为这是下一个最好的地方（或 superuser.com）。

如果可以与服务器建立连接，我正在考虑使用 HTML5 WebSocket，但我对 smtp、imap 或 pop3 的体系结构了解不足，无法理解 javascript 如何传递参数并执行我想要它做的事情。

PHP 不能参与这个项目，否则我不会问这个问题。

找到这个的任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:39:04.823

没有什么是不可能的。除了这个。

在标准的 HTML 或 JavaScript 中，您无法建立原始套接字连接，而这是您所列出的任何协议所需要的。[WebSocket API](http://en.wikipedia.org/wiki/WebSocket)对您没有帮助，因为服务器也必须使用 WebSocket，而邮件服务器则不需要。不过，这实际上都是一件好事。想象一下，如果您访问了一个随机网站，它通过远程登录连接到您的家庭路由器，将其点燃并烧毁您的房子。如果网站可以发起普通的 TCP 套接字连接，这就是网站能够做到的。

你有几个我能想到的选择，但都不涉及构建网页。（需要明确的是，您并没有说您的项目必须是网页；您只是说 HTML/JS，所以这些确实是合法的选择。）

首先是类似[node-webkit](https://github.com/rogerwang/node-webkit)的东西。正如自述文件所说，“您可以使用 node-webkit 以 HTML 和 Javascript 编写本机应用程序。” 您仍然必须将其作为本机应用程序分发，因为它就是这样。

第二个是[Chrome 应用程序](https://developer.chrome.com/apps/about_apps.html)，特别是使用 chrome.socket API。但是在这些套接字上编写一个 TLS 层会很有趣，你会发现现在几乎所有邮件服务器都需要它。如果您成功地做到了这一点，您将能够在 Chrome 网上应用店中分发您的邮件客户端，我向您保证电子邮件客户端将非常受欢迎。

第三，编写一个在本地运行的网络服务器，这样你的用户就会`http://localhost:9999/mail`在他们的浏览器中访问类似的东西。这将是一个真正的痛苦分发，但你可以使用几乎任何你想要的技术。

我确信还有第四个有效选项，其他人可以加入该选项。

祝你好运。

# c++ - 着色器上带有卷积矩阵的高斯模糊

> ID：16202298
> 
> 赞同：0
> 
> 时间：2013-04-24T21:13:05.567
> 
> 标签：c++, filter, shader, blur, gaussian

我正在尝试在我的着色器上使用卷积矩阵实现高斯模糊。

这是我的代码：

```
float4 ppPS(float2 uv : TEXCOORD0, uniform sampler2D t1) : COLOR { 
  //kernel matrix
  float3x3 kernel={1*(1/16),2*(1/16),1*(1/16),
  2*(1/16),4*(1/16),2*(1/16),
  1*(1/16),2*(1/16),1*(1/16)
  };

  int x,y;
  float2 sum = 0;
  for (x = -1; x <= 1; x++)
  {
    for (y = -1; y <= 1; y++)
    {
      float2 fl;
      fl.x = uv.x+x;
      fl.y = uv.y+y; 
      sum += (fl)*(kernel[x+1][y+1]);
    }
  }
  return tex2D(t1, sum);
 } 
```

但出于某种原因，我得到了一张全是纯色的照片。

这是没有模糊的图像：

![非模糊](https://i.stack.imgur.com/IMfpP.jpg)

这是具有所谓模糊的图像：

![有模糊](https://i.stack.imgur.com/O2T9d.png)

知道我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-19T19:59:55.527

尝试将**float3x3**初始化值更改为浮点格式**(.0f)**，否则所有值将最终为 0。

```
 //kernel matrix
 static const float3x3 kernel={1*(1.0f/16.0f),2*(1.0f/16.0f),1*(1.0f/16.0f),
 2*(1.0f/16.0f),4*(1.0f/16.0f),2*(1.0f/16.0f),
 1*(1.0f/16.0f),2*(1.0f/16.0f),1*(1.0f/16.0f)
}; 
```

进行此更改后，您将看不到空白输出图像！！！

# vba - 在 do while 循环中使用公式作为条件

> ID：16202299
> 
> 赞同：0
> 
> 时间：2013-04-24T21:13:34.773
> 
> 标签：vba, loops, while-loop

我有一列包含时间值：

```
05:13:32
05:13:32
05:13:32
05:13:32
05:13:33
05:13:33
05:13:34
05:13:34
05:13:35
05:13:35
05:13:36
05:13:36
05:13:36
05:13:37
05:13:37
05:13:38
05:13:38
05:13:39
05:13:39 
```

这些值在 C 列中。

现在：第一个点是我开始寻找比第一个值多 2 秒的下一个值的点，这意味着我会找到 05:13:34。

我写了这段代码，但它不起作用，因为`Find`函数 (What:=) 不接受我声明为的变量`x= Activecell.Value + "00:00:2"`

```
Sub sekundenfinder2()
    Dim sekundo2 As Range
    Dim x as Integer 
    Range("C153").Select  
    ' //// Here is the Point where I begin to go the colomn down and look for the next value 

    Selection.Activate
    Set sekundo2 = Range("C:C").Find(What:="x", After:=ActiveCell)
    sekundo2.Select
End Sub 
```

第二个问题：

`Activecell.Value`给出值 0,21.......，这意味着 Excel 将值从时间转换为数字，但我想将时间保持在这种格式“00:00:00”中。我试图将格式更改为时间，它仍然将其更改为数字。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:37:56.057

1.  使用`DateAdd`添加时间
2.  当您使用`x`内引号时，它不会保留为变量，而是更改为字符串。
3.  声明`x`为`Date`和不`Integer`

这是你正在尝试的吗？我假设数据是从头`C1`开始的并且`C1`有`05:13:32`

```
Sub sekundenfinder2()
    Dim sekundo2 As Range
    Dim x As Date

    x = DateAdd("s", 2, Range("C1").Value)

    Set sekundo2 = Range("C:C").Find(What:=x)

    If Not sekundo2 Is Nothing Then sekundo2.Select
End Sub 
```

![在此处输入图像描述](https://i.stack.imgur.com/JdXIt.png)

# javascript - Fancybox 可以在其 onStart 或 onComplete 事件中关闭吗？

> ID：16202301
> 
> 赞同：0
> 
> 时间：2013-04-24T21:13:45.857
> 
> 标签：javascript, jquery, fancybox

我想在它的`onStart`或`onComplete`事件中关闭fancybox。我试过`$.fancybox.close()`了，但似乎无法关闭它。

Fancybox 可以在其`onStart`或`onComplete`事件中关闭吗？如何？

我正在使用 Fancybox 1.3.4。

感谢您的任何意见！

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T03:22:56.613

`$.fancybox.close()`是正确的方法。我不明白的是为什么你要关闭fancybox `onComplete`...无论如何，这行得通：

```
$(document).ready(function () {
    $(".fancybox").fancybox({
        "onComplete": function () {
            // close fancybox after 3 seconds
            setTimeout(function () {
                $.fancybox.close();
            }, 3000)
        }
    });
}); 
```

见**[JSFIDDLE](http://jsfiddle.net/L2UPg/)**

也适用于`onStart`...查看更新**[的 JSFIDDLE](http://jsfiddle.net/L2UPg/1/)**

# python - 使用 QSortFilterProxyModel 过滤时突出显示/选择 QListView 中的第一个可见项目

> ID：16202304
> 
> 赞同：0
> 
> 时间：2013-04-24T21:13:58.403
> 
> 标签：python, view, model, pyqt, pyside

如果过滤结果不存在列表选择，那么我想自动突出显示第一项。我创建了方法`force_selection()`突出显示第一项的方法。我正在使用`QListView.selectionModel()`来确定选择索引。我已经尝试连接`force_selection()`到`QLineEdit`插槽：`textEdited(QString)`和`textChanged(QString)`. 但是，在 textChanged 和代理刷新`QListView`. 有时会做出选择，而有时会消失。

那么，如果用户尚未做出选择，我将如何在代理过滤器期间强制选择（蓝色突出显示）？我的代码背后的想法是用户搜索一个项目，顶部的项目是最好的结果，所以它被选中（除非他们在过滤视图中手动选择另一个项目）。

[您可以在此处找到问题的图像。](https://www.dropbox.com/s/pv75xz86sddm3c9/qlistviewselection.png)

*重新创建问题：*

1.  使用 Python 2.7 执行示例脚本
2.  不要选择列表中的任何内容（QLineEdit 应该有焦点）
3.  搜索'Red2'，慢慢输入'R'、'e'、'd' --> Red1 和 Red2 可见，Red1 突出显示
4.  通过键入数字“2”完成搜索-> Red2 不再突出显示/选择

**最终解决方案：**

```
 from PySide import QtCore
    from PySide import QtGui

    class SimpleListModel(QtCore.QAbstractListModel):

        def __init__(self, contents):
            super(SimpleListModel, self).__init__()
            self.contents = contents

        def rowCount(self, parent):
            return len(self.contents)

        def data(self, index, role):
            if role == QtCore.Qt.DisplayRole:
                return str(self.contents[index.row()])

    class Window(QtGui.QWidget):

        def __init__(self, parent=None):
            super(Window, self).__init__(parent)

            data = ['Red1', 'Red2', 'Blue', 'Yellow']
            self.model = SimpleListModel(data)

            self.view = QtGui.QListView(self)

            self.proxy = QtGui.QSortFilterProxyModel(self)
            self.proxy.setSourceModel(self.model)
            self.proxy.setDynamicSortFilter(True)
            self.proxy.setFilterCaseSensitivity(QtCore.Qt.CaseInsensitive)
            self.view.setModel(self.proxy)

            self.search = QtGui.QLineEdit(self)
            self.search.setFocus()

            layout = QtGui.QGridLayout()
            layout.addWidget(self.search, 0, 0)
            layout.addWidget(self.view, 1, 0)

            self.setLayout(layout)

            # Connect search to proxy model
            self.connect(self.search, QtCore.SIGNAL('textChanged(QString)'), 
                         self.proxy.setFilterFixedString)

            # Moved after connect for self.proxy.setFilterFixedString
            self.connect(self.search, QtCore.SIGNAL('textChanged(QString)'), 
                         self.force_selection)

            self.connect(self.search, QtCore.SIGNAL('returnPressed()'), 
                         self.output_index)

        # @QtCore.Slot(QtCore.QModelIndex)
        @QtCore.Slot(str)
        def force_selection(self, ignore):
            """ If user has not made a selection, then automatically select top item.
            """
            selection_model = self.view.selectionModel()
            indexes = selection_model.selectedIndexes()

            if not indexes:
                index = self.proxy.index(0, 0)
                selection_model.select(index, QtGui.QItemSelectionModel.Select)

        def output_index(self):
            print 'View Index:',self.view.currentIndex().row()
            print 'Selected Model Current Index:',self.view.selectionModel().currentIndex()
            print 'Selected Model Selected Index:',self.view.selectionModel().selectedIndexes()

    if __name__ == '__main__':
        import sys

        app = QtGui.QApplication(sys.argv)
        window = Window()
        window.show()
        sys.exit(app.exec_()) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-27T18:27:52.267

问题是`connect`调用的顺序。你先连接`textChanged`，`force_selection`所以它首先被调用。但那时，过滤器没有处理，代理也没有更新。因此，您选择了一个可能很快会被过滤删除的项目。

只需切换`connect`调用顺序。

顺便说一句，你可能想重新考虑你的逻辑`force_selection`。`currentIndex`不一定对应于选定的索引。您可以通过键入`red2`和删除来观察这一点`2`。您将同时获得`Red1`并被`Red2`选中。如果你想处理`currentIndex`use`setCurrentIndex`而不是`select`. 如果要处理选定的索引，则条件应基于`selectedRows`or `selectedIndexes`。

# linux - 将图像文件名依次重命名为文件夹名

> ID：16202306
> 
> 赞同：1
> 
> 时间：2013-04-24T21:14:13.320
> 
> 标签：linux, image, rename

我有大约 5000 张图像要根据其文件夹名称重命名

例子

```
Vacation Picture
---2013
------Vegas-Trip
---------DCS001.jpg
---------DSC002.jpg
---------etc
------China-Trip
---------DSC0100.jpg
---------DSC0101.jpg 
```

我想要做的是将所有.jpg文件全部重命名为例如 Vegas-Trip-001.jpg Vegas-Trip-002.jpg 等。然后一旦进入China-Trip文件夹，它将重命名为China-Trip -001.jpg 并继续每个文件夹。

我已经进行了一些搜索，但似乎找不到任何东西。

运行 Linux。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:18:27.013

这应该让你开始

```
cd 'Vacation Picture/2013'
for picdir in *
do
  cd $picdir
  for pic in *
  do
    mv $pic $(sed "s/DSC/${picdir}-/" <<< $pic)
  done
  cd ..
done 
```

# sdl - Awesomium 自定义 SDL Surface 无法正常工作

> ID：16202307
> 
> 赞同：2
> 
> 时间：2013-04-24T21:14:13.670
> 
> 标签：sdl, awesomium

我正在尝试为 awesomium 制作一个自定义 Surface 类，以将其传送到常规 SDL 窗口。Awesomium 声称他们的像素格式是 BGRA ( [http://awesomium.com/docs/1_7_0/cpp_api/class_awesomium_1_1_surface.html)，SDL](http://awesomium.com/docs/1_7_0/cpp_api/class_awesomium_1_1_surface.html)为我提供了一个 ARGB 窗口。

```
virtual void Paint( unsigned char* src_buffer, int src_row_span, const Awesomium::Rect& src_rect, const Awesomium::Rect& dest_rect ) 
{
    SDL_LockSurface(screen);
    for(int x=0;x<src_rect.width;x++)
        for(int y=0;y<src_rect.height;y++)
        {
            unsigned char *s=src_buffer+src_rect.x*4+src_rect.y*src_row_span;
            Uint32 *d=(Uint32*)screen->pixels+(x+dest_rect.x)+(y+dest_rect.y)*screen->w;
            Uint32 sp=*((Uint32*)s);
            int r=(sp&0xFF00)>>8;
            int g=(sp&0xFF0000)>>16;
            int b=(sp&0xFF000000)>>24;
            Uint32 dp=0xFF000000|(r<<16)|(g<<8)|(b);
            *d=dp;
            if(x==491 && y==235)
                printf("");
        }
    SDL_UnlockSurface(screen);
    SDL_UpdateRect(screen,dest_rect.x,dest_rect.y,dest_rect.width,dest_rect.height);
} 
```

但是，当我在 Google 的主页上运行此程序时，我得到一个带有两个白色矩形的蓝屏，一次与 google 的搜索框匹配，另一个在它下方的 google.com 上只有空白区域。

# javascript - 强制垂直滚动条到底部

> ID：16202311
> 
> 赞同：2
> 
> 时间：2013-04-24T21:14:17.883
> 
> 标签：javascript, jquery, html

我有一个聊天窗口，我想一直看到这个聊天的底部。我尝试了两种方法，它们都在这里：http: [//jsfiddle.net/9hMXL/518/](http://jsfiddle.net/9hMXL/518/)并且都不起作用。

我究竟做错了什么？

另外，由于 SO 需要我在这里放一些代码，这里是页面的 html：

```
<div id="contt"  class="cont">
    <div class="inner">
        <p>Hi there! Nice scrollbars, aren't they?</p>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:16:54.683

`#contt`没有滚动条。 `window`做。

```
$(window).scrollTop(400); 
```

[http://jsfiddle.net/9hMXL/519/](http://jsfiddle.net/9hMXL/519/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:26:00.377

$(window).scrollTop(window.height)

或者，如果您使用的是内部框架，请使用它来代替窗口。

# linux - 在 Linux 中：打印以开头的日志文件的最后一行

> ID：16202312
> 
> 赞同：0
> 
> 时间：2013-04-24T21:14:31.023
> 
> 标签：linux, logging, redhat, tail

我试图让单个操作系统命令的输出显示以特定字符串开头的日志文件的最后一行。

所以基本上我有一个日志文件，内容如下：

```
Tom 
Paul 
Tom 
Steve 
Anthony 
Tom 
```

我想输入一个类似这样的命令：

```
tail -1 /etc/logfile | grep Steve 
```

并有这样的输出：史蒂夫

不幸的是，输出`tail -1`仅显示日志文件的最后一行...如果匹配。我希望它从底部到顶部（最近到最旧）搜索日志文件并打印与“开始于”或 grep 匹配的第一个条目。谢谢你。我尝试了一堆tail，sed，cat和less的组合......但我可能只是做一些小错误并且错过了它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:32:36.280

如果日志足够小以至于您不想完全扫描它，那么

```
grep Steve etc/logfile | tail -n 1 
```

会做你的工作。如果文件真的很大，你不想 grep 它，因为它会影响性能，所以我建议构建一个反向读取文件并在第一次出现时停止的脚本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T21:17:55.263

反过来做`grep Steve /etc/logfile | tail -l`

```
grep Steve /etc/logfile 
```

然后得到史蒂夫的所有台词

```
tail -1 
```

打印最后一个。

# android - Android - 锁定时阻止硬件按钮

> ID：16202315
> 
> 赞同：1
> 
> 时间：2013-04-24T21:14:47.683
> 
> 标签：android, samsung-mobile

我正在研究制作一个应用程序来阻止音量增大/减小按键的默认操作，并希望获得一些输入，看看我是否会浪费时间尝试。

这是设置：

我有三星 Galaxy S3。我喜欢听音乐。当手机被锁在口袋里时，我经常会无意中改变正在播放的音量。

起初我认为这很简单；测试了 onKeyDown() 方法的简单覆盖，用于检索音量键的整数值。很快我意识到只有在我不锁定手机并且只保持该应用程序打开的情况下，这才有效。

接下来我发现了一些关于服务的文章，但是我相信这也不能满足我的需求，因为它不是 Activity 的子集，因此没有实现 onKeyDown(); 除非我弄错了，否则唤醒锁实际上会唤醒和/或解锁手机吗？

我现在应该放弃，还是这实际上可以实现？
（实际上这必须是可能的，因为我不必为这个功能支付 3 英镑的应用程序费用。哈哈）

注意：运行 Android 的 4.2.1
新版本，而不是 Java。

史蒂夫。

**编辑：**只是一个想法，但是如果我将 Activity 扩展到我自己的类（并覆盖 onKeyDown），并在服务中将其实例化为静态实例，那么该自定义活动会在手机锁定时持续存在吗？

**Edit2：**我发现[这篇](https://stackoverflow.com/questions/3434325/is-there-a-way-to-make-an-android-app-respond-to-hardware-buttons-while-phone-lo?rq=1)建议使用 FLAG_SHOW_WHEN_LOCKED 的帖子。我回家后会开始看这个，但我仍然愿意接受建议和建议：D

**编辑 3：** 好的，如果我开始失去这里的情节，请告诉我......
使用广播接收器，我将监听 ACTION_SCREEN_OFF 标志。如果调用它，请创建我的自定义活动（使用 onKeyDown() 覆盖）并将其设置为 FLAG_SHOW_WHEN_LOCKED 以接管我的锁定屏幕（我不在乎，因为屏幕已关闭）。然后接收器监听 ACTION_SCREEN_OFF，如果被调用，它将在显示屏幕之前销毁 Activity（或者之后，如果它闪烁，我不会打扰）。（甚至可能只是暂停它，并且只有在检测到解锁时才将其杀死）。

还要非常感谢@StoneBird 让我走到这一步，有时与知道那里在谈论什么的人讨论一下会有所帮助（希望^_-）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:02:29.527

尝试这个？

[设置.系统](http://developer.android.com/reference/android/provider/Settings.System.html)

您可以每 1 毫秒启动服务并设置系统音量以使其保持稳定水平。由于该值每 1 毫秒被覆盖一次，因此不需要进行密钥检查。

此外，市场上有免费的容量保持器，因此您无需为此付费。

# intellij-idea - 是否可以从 IntelliJ 的文件对话框中过滤掉文件？

> ID：16202316
> 
> 赞同：2
> 
> 时间：2013-04-24T21:14:48.360
> 
> 标签：intellij-idea

我的具体用例是一个 Android 项目，但这不是 Android 特定的。我有一个 IntelliJ-IDEA 项目，其中包含几个已本地化的 Android 模块。如果我想打开文件`strings.xml`，我几乎总是想要非本地化的文件（in`res/values`而不是`res/values-fr`或其他）。但是当我点击`<ctrl><shift><n>`并输入时`strings.xml`，它会显示所有 30 亿个本地化文件，并且实际上在非本地化文件之前显示它们。我想找到一种方法给 IntelliJ 提示我想要哪个，或者从该对话框中过滤掉文件的方法。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-30T09:19:37.037

似乎有一种目录排除的解决方法

[http://devnet.jetbrains.com/thread/283525](http://devnet.jetbrains.com/thread/283525)

# ruby - 比较 Ruby 中的对象等价性

> ID：16202317
> 
> 赞同：6
> 
> 时间：2013-04-24T21:14:53.757
> 
> 标签：ruby

我在这里做一个 Ruby 教程： [http ://rubymonk.com/learning/books/4-ruby-primer-ascent/chapters/45-more-classes/lessons/105-equality_of_objects](http://rubymonk.com/learning/books/4-ruby-primer-ascent/chapters/45-more-classes/lessons/105-equality_of_objects)

这是说当我重载`==`运算符时，我也应该重载`eql?`方法和哈希方法，因为它们“更快”。

但是，如果我用基本相同的方法重载所有三个，那么一个比另一个快吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-24T21:46:19.507

在大多数情况下，`==`并`eql?`有相同的结果。在某些情况下，`eql?`比 更严格`==`：

```
42.0 == 42 # => true
42.0.eql?(42) # => false 
```

正因为如此，如果你定义`==`了你可能也想定义`eql?`（反之亦然）。

做出了一个选择，`Hash`该类将`eql?`用来区分不同的键，而不是`==`. 请注意，它本来可以`==`，但`eql?`更干净。

为了避免`eql?`一直进行昂贵的调用，计算哈希值时要求两个对象`eql?`必须具有相同的哈希值。该哈希值被存储，这使得将来的查找非常容易：如果哈希码不匹配，那么这些值不`eql?`......

因此，`hash`如果您定义`eql?`.

请注意，计算哈希值几乎总是比使用`==`or进行比较更昂贵`eql?`。但是，一旦计算出哈希，检查哈希是否匹配非常快。

因为散列通常涉及非常多的比较，所以相对昂贵的散列计算对每个键进行一次，然后对每个查找进行一次。想象一个有 10 个条目的散列。`hash`在第一次查找完成之前，构建它将涉及 10 次调用。不过，第一次查找会相对较快：一次调用`hash`，然后非常有效地比较哈希码（实际上比这更快，因为它们是“索引的”）。如果有匹配，仍然必须调用`eql?`以确保它是真正的匹配。事实上，两个不同的对象`eql?`可能具有相同的哈希值。唯一的保证是两个对象`eql?`必须具有相同的哈希值，但两个不同的对象也可以具有相同的哈希值。

如果您想使用 an 来做同样的事情，则每次查找`Array`可能需要 10 次调用`eql?`。

对于它的价值，我认为您链接到的 Ruby 入门书并没有尽可能清晰。它忽略了计算 可能很昂贵的事实`hash`，因此它仅在有意义时才完成，即当每个元素将被比较多次是一个很好的假设时。`eql?`此外，它提供的自定义示例`==`用于比较实例变量是一种耻辱。理想情况下，它将`eql?`用于一致性，就像数组是，`==`如果它的元素是`==`，数组是，`eql?`如果它的元素是`eql?`。最后，它真的应该提到[`Struct`](http://ruby-doc.org/core-2.0/Struct.html)哪个定义了体面`==`，`hash`并且`eql?`为您定义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T21:19:27.480

例如[`Array#hash`](http://www.ruby-doc.org/core-2.0/Array.html#method-i-hash)说 -

> 具有相同内容的两个数组将具有相同的哈希码（并且将使用 eql 进行比较？）。

并[`Array#==`](http://www.ruby-doc.org/core-2.0/Array.html#method-i-3D-3D)说：

> 相等——如果两个数组包含相同数量的元素并且每个元素都等于（根据 Object#==）other_ary 中的相应元素，则两个数组相等。

并[`Array#eql?`](http://www.ruby-doc.org/core-2.0/Array.html#method-i-eql-3F)说

> 如果 self 和 other 是同一个对象，或者都是具有相同内容的数组，则返回 true。

因此，根据文档，很明显`eql?`它使用`hash`value 会更快，使用`eql?`. 而`#==`做两件事 -

> 1.  数组的长度和
> 2.  每个元素相等性测试。

# git - Git 提交不使用转发的 ssh 代理？

> ID：16202319
> 
> 赞同：2
> 
> 时间：2013-04-24T21:15:00.417
> 
> 标签：git, github, ssh, git-commit

设置：

我们有几个用户可以访问 Github 存储库。这些用户都具有在各种服务器上的部署权限。服务器无权访问 Github 存储库 - 它们使用 ssh-agent 转发来获取用户的凭据。将数据从 Github 传输到服务器时，一切都按预期工作。

为了问责，部署将一些数据提交到存储库。这都是脚本化并在服务器端运行，无需用户干预。

问题：

Git 提交将提交者名称和电子邮件设置为服务器上设置的任何内容（如果未明确设置，则默认为服务器用户名）。有没有办法强制 Git（作为发送者）或 Github（作为接收者）将提交与转发的用户凭据相关联？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T05:52:00.060

您可以尝试在服务器上设置一个钩子，在接收时触发（例如，这个[**GitHubHook**：一个 GitHub Post-Receive Deployment Hook](https://github.com/kwangchin/GitHubHook)），它将：

*   修改本地`.git/config`文件
*   在所述配置文件中添加 user.name 和 user.email

这将假定部署提交是在下一次从 GitHub 推送到服务器*之前*完成的，否则，将使用错误的凭据。

如果上一点是一个问题，那么您可以通过以下方式改进：

*   按部署顺序将这些凭据存储在其他地方，
*   并确保部署提交是使用`git commit --author='AUserName <some@email.com>`, 根据记录的顺序从单独的文件中提取的名称和电子邮件完成的。

在最后一种情况下，无需修改本地配置：您`git commit`使用正确的参数构建命令，而不是依赖本地配置文件内容。

# c# - 获取最新的 .NET 框架目录

> ID：16202320
> 
> 赞同：0
> 
> 时间：2013-04-24T21:15:00.543
> 
> 标签：c#, .net, clr4.0

如何获取最新的 .NET CLR 安装位置？

[System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory() 正在返回 2.0* 位置，即使安装了 4.0*。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:26:52.063

GetRuntimeDirectory() 返回当前正在运行的 CLR 的运行时目录，如果您获得 2.0 路径，则意味着您在运行此代码时并未*运行*4.0，即使它已安装。

不确定您要做什么，但请查看这篇文章：http: [//msdn.microsoft.com/en-us/library/hh925568.aspx](http://msdn.microsoft.com/en-us/library/hh925568.aspx)。检查列出的注册表项下的 InstallPath 值以获取给定版本的框架的根路径。

# jquery - jquery eventhandler 和 documentready：处理程序绑定太晚

> ID：16202329
> 
> 赞同：0
> 
> 时间：2013-04-24T21:15:27.060
> 
> 标签：jquery, forms, handler, domdocument

所以我有

```
$(document).ready(function() {
  $('#button').click(function(e) {
      e.preventDefault();//do not submit the form
      //go to a specific place
   });
}); 
```

现在不幸的是，我的页面需要加载相当多的数据，所以它需要一些时间才能准备好。该按钮位于表单内。

如果页面没有完全加载，并且用户单击按钮，我实际上会执行默认事件（提交表单）......我不想要

在我们的工作流程中，该按钮不太可能被如此快速地按下 - 但它可能会让我烦恼。知道可以做什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:26:19.103

默认禁用按钮，加载页面后启用按钮

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:30:56.357

如果您打算使用 ajax 处理提交，请禁用表单的提交操作。

```
<form onsubmit="return false;"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:31:33.190

一个很好的做法是在单击按钮时设置加载指示器或微调器，并在单击后立即禁用它，以便用户知道他在期待某些东西，而不仅仅是双击它。

# ruby-on-rails - 如何在 erb 视图中动态访问模型的属性数据？

> ID：16202330
> 
> 赞同：0
> 
> 时间：2013-04-24T21:15:28.810
> 
> 标签：ruby-on-rails, erb

我想根据保存的顺序显示项目列表。例如，在我的模型（@gallery）中，我有一个名为 serializedmenu 的字段，其中包含特定顺序的菜单项。

现在基于菜单项名称，我想构建对包含实际数据的属性的引用并显示数据。

例如：

listname_for_video 和 listname_for_textbox 是模型的实际属性。

使用下面的代码，我遍历只包含部分属性名称的菜单列表，并构建对属性的最终引用：

对于此示例，@menulist 是一个包含名称 video 和 textbox 的数组。

```
<% @menulist = YAML::load(@gallery.serializedmenu) %>

<% @menulist.each do |menuitem| %>
<li>
  <a href="#<%=menuitem%>" >
  <%  myvar = "@gallery.listname_for_" +  menuitem %>
  <%= myvar %>  
  </a>
</li>
<% end %> 
```

不幸的是，这不起作用，因为 myvar 只打印字符串“@gallery.listname_for_video”而不是实际数据。

感谢您的意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:27:04.053

哦，那真的很容易。在发布这个问题之前，我应该进行更多搜索。您可以在变量 myvar 之前插入关键字 eval

这将为您提供实际数据：

```
<% eval mvar %> 
```

# android - 比较 SQLite 中的 Double NOT 字符串值

> ID：16202334
> 
> 赞同：1
> 
> 时间：2013-04-24T21:15:33.860
> 
> 标签：android, sqlite, comparison

我正在尝试使用 BETWEEN 运算符通过 Android 比较 sqlite 中的纬度和经度值。问题是该值总是被比较，就好像它是一个字符串，我不知道如何将它作为一个数字进行比较。我发现这一点是因为使用查询“select * from database orderby latitude”会返回一个未按数字排序的列表。KEY_LAT 和 KEY_LONG 我存储为 TEXT 和 REAL，并且得到相同的输出。请告诉我您需要什么信息。

这是查询：

```
 double high_lat = curr_lat + 100.0;
     double high_long = curr_longitude + 100.0;
     double low_lat = curr_lat - 100.0;
     double low_long = curr_longitude - 100.0;
         Cursor cursor = db.query(TABLE_NAME,      new String[]                        {KEY_ID, KEY_NAME, KEY_ADDR, KEY_LAT, KEY_LONG}, select,
        new String[]
                {KEY_LAT + " BETWEEN " + low_lat + " AND " 
                + high_lat + " AND " + KEY_LONG + " BETWEEN " + low_long + " AND " 
                + high_long},
            null, null, null); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T22:12:24.210

将您的输入转换为 REAL 作为最后的手段。

`...KEY_LONG + " BETWEEN CAST(" + low_long + " AS REAL) AND CAST(" + high_long +" AS REAL)"`

# javascript - 使用 .text() 仅修改文本

> ID：16202338
> 
> 赞同：0
> 
> 时间：2013-04-24T21:15:41.987
> 
> 标签：javascript, jquery

如何使用`.text()`来修改文本，而不是选择元素中的其他元素？

```
var titleTextDiv = $('div#title-text'),
    editTitleDiv = $('div#title-edit'),
    editTitleInput = $('input[name=imageTitle]'),
    editTitleLink = $('a#edit-title'),
    saveTitleLink = $('a#save-title');

editTitleDiv.hide();
editTitleInput.val($.trim(titleTextDiv.text()));

editTitleLink.click(function() {
    titleTextDiv.hide();
    editTitleDiv.fadeIn('fast');
});

saveTitleLink.click(function() {
    editTitleDiv.hide();
    titleTextDiv.text($.trim(editTitleInput.val())).fadeIn('fast');
}); 
```

**[ jsFIDDLE ]** [http://jsfiddle.net/2xMtQ/](http://jsfiddle.net/2xMtQ/)

目前，一切正常，除了标题更改为新值后，它会删除编辑/保存锚。为什么是这样？我能做些什么不同的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:19:49.507

将目标文本包裹在 a 中`<span>`，例如：

```
<span id="title-target">Dem Bears</span> 
```

并修改该跨度的文本而不是容器，例如：

```
var titleTextDiv = $('div#title-text'),
    titleTarget = $("#title-target"),
    editTitleDiv = $('div#title-edit'),
    editTitleInput = $('input[name=imageTitle]'),
    editTitleLink = $('a#edit-title'),
    saveTitleLink = $('a#save-title');

editTitleDiv.hide();
editTitleInput.val($.trim(titleTextDiv.text()));

editTitleLink.click(function() {
    titleTextDiv.hide();
    editTitleDiv.fadeIn('fast');
});

saveTitleLink.click(function() {
    editTitleDiv.hide();
    titleTarget.text($.trim(editTitleInput.val()));
    titleTextDiv.fadeIn("fast");
}); 
```

**演示：http:** [//jsfiddle.net/2xMtQ/1/](http://jsfiddle.net/2xMtQ/1/)

此外，在通过 选择元素时不需要使用 tagName `id`，因为 jQuery 优化了以“#”开头的选择器的选择过程。当你在“#”之前使用某些东西时，jQuery 必须对选择器进行不必要的处理，并且效率低下。例如，使用`$('#title-text')`代替`$('div#title-text')`.

查看 jQuery 源代码，`.text("string")`所做的是清空元素的内容，然后添加一个带有传入字符串的文本节点。这就是为什么您看到里面的所有内容都被替换。相关的jQuery：

```
this.empty().append( ( this[0] && this[0].ownerDocument || document ).createTextNode( value ) ); 
```

就像我说的，简而言之，就是清空元素并附加一个文本节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:22:38.463

您在使用时看到元素被删除的原因`text`是因为该方法将“将匹配元素集中每个元素的内容设置为指定的文本”。

这似乎具有欺骗性，因为最初使用`text`时只会返回元素的文本，即使有嵌套的子元素也是如此。但是，setter 是一个完全不同的故事，它将覆盖其中的内容。

为了能够使用 jQuery`text`只修改元素中的文本，您应该*本地化您的文本*，以便可以正确地定位它进行修改。

# 对 jQuery 文本的评论。

## jQuery`text`作为：

### *吸气剂*

*   获取匹配元素集中每个元素的组合文本内容，包括它们的后代。

### *二传手*

*   将匹配元素集中每个元素的内容设置为指定文本

（来源：**[jQuery API](http://api.jquery.com/text/)**）

* * *

您的本地化问题

# ***[`jsFiddle Demo`](http://jsfiddle.net/2xMtQ/3/)***

你需要稍微重组你的元素。文本将替换该区域内的所有内容，因此您可能希望使用文本跨度。这是一个修改后的版本作为建议：

```
<div id="title-div"><span id="title-text">Dem Bears</span> 
```

然后在js中

```
var titleTextDiv = $('div#title-div'),
titleText = $('span#title-text'),
editTitleDiv = $('div#title-edit'),
editTitleInput = $('input[name=imageTitle]'),
editTitleLink = $('a#edit-title'),
saveTitleLink = $('a#save-title');

editTitleDiv.hide();
editTitleInput.val($.trim(titleText.text()));

editTitleLink.click(function() {
 titleTextDiv.hide();
 editTitleDiv.fadeIn('fast');
});

saveTitleLink.click(function() {
 editTitleDiv.hide();
 titleText.text($.trim(editTitleInput.val()));
 titleTextDiv.fadeIn('fast');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:33:45.880

如果您真的想要，您可以更改`.text()`以保留节点并替换文本

```
$.fn.text = function ( value ) {
    return jQuery.access( this, function( value ) {
        if(value === undefined){
            return jQuery.text( this );
        }else{
        var childNodes = this.children().detach();
        return this.empty().append( ( this[0] && this[0].ownerDocument || document ).createTextNode( value ) ).append(childNodes);
        }
    }, null, value, arguments.length );
} 
```

尽管我建议将其添加为附加功能

```
$.fn.textPreserveNodes 
```

小提琴：http: [//jsfiddle.net/2xMtQ/10/](http://jsfiddle.net/2xMtQ/10/)

# mysql - 如何从一个表中选择 5 个随机行并从一秒钟开始列出这些行？

> ID：16202340
> 
> 赞同：0
> 
> 时间：2013-04-24T21:15:45.390
> 
> 标签：mysql

好的，我有 2 张桌子。在被调用的**项目**上，所有数据都存储在其中（id、名称、描述等），另一个名为**features** 的表存储了特色项目列表（id、itemid）

我想做的是从特色表中选择 5 个随机行并列出与 items 表中的 itemid 匹配的列表。items 表有点大，300,000 行左右，featured 目前有 106 个。

第二个问题：如果我只是在 items 表中添加一列来设置 bool 是否具有特色，那会更好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T21:18:22.593

```
SELECT  *
FROM    featured f
JOIN    items i
ON      i.id = f.itemid
ORDER BY
        RAND()
LIMIT   5 
```

但是，此查询在大型数据集上可能需要很长时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T21:18:47.393

我个人认为使用另一个列而不是另一个表会更好，因为两个表具有相同的超键。听起来 JOIN 对你来说很好用。

```
SELECT * FROM featured f JOIN items ON (f.id = itemid) ORDER BY RAND() LIMIT 5; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-24T21:29:56.710

我认为最有效的方法是：

```
select *
from (select f.*
      from featured f
      order by rand()
      limit 5
     ) f join 
     items i
     on i.id = f.itemId; 
```

在您的情况下，就性能而言，106 行与 5 行的排序可能无关紧要。但是，如果精选列表增加，那么它可能会有所作为。

# java - 递归斐波那契数列打印出列表

> ID：16202346
> 
> 赞同：2
> 
> 时间：2013-04-24T21:16:23.287
> 
> 标签：java, recursion, computer-science, fibonacci

我有递归斐波那契数列的以下代码

```
 if (term < 2){
        System.out.print("1 ");
        return 1;
    } 
        int results = fibonacci(term - 1) + fibonacci(term - 2);
        System.out.print(results + " ");

        return results; 
```

我得到的输出是

您希望对斐波那契数列执行什么操作：4

1 1 2 1 3 1 1 2 5 第 4 个是 5

我怎么做才能打印

1 1 2 3 第 4 个是 5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:26:10.973

使用尾递归。

```
 public static void main(String[] args) {

    System.out.print("The 10th is: " + fibonnaci(10));
  }

  public static int fibonnaci(int number) {
     return fibonnaciHelper(number, 1, 1);
  }

  public static int fibonnaciHelper(int term, int lower, int higher) {
      if (term < 2){
          return higher;

      } 

      System.out.print(higher + " ");
      int results = fibonnaciHelper(term - 1, higher, higher + lower);
      return results;
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T17:13:57.723

您可以尝试以下方法：

```
public void fib(int n){
    if(n==0)
        System.out.println(1);

    else System.out.println(fib(1,n,0,1);
}

private int fib(int iteration, int limit, int n0, int n1){
    if(iteration==limit)
         return(n0+n1);

    fib(++iteration,limit,n1,(n0+n1));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:20:12.653

迭代斐波那契数列 - 它位于某处

```
public static int fib(int n) {
            int prev1=0, prev2=1;
            for(int i=0; i<n; i++) {
                int savePrev1 = prev1;
                prev1 = prev2;
                prev2 = savePrev1 + prev2;
            }
            return prev1;
} 
```

# python - numpy逐行总和

> ID：16202348
> 
> 赞同：65
> 
> 时间：2013-04-24T21:16:31.543
> 
> 标签：python, multidimensional-array, numpy

如何将 numpy 数组行除以该行中所有值的总和？

这是一个例子。但我很确定有一种花哨且更有效的方法来做到这一点：

```
import numpy as np
e = np.array([[0., 1.],[2., 4.],[1., 5.]])
for row in xrange(e.shape[0]):
    e[row] /= np.sum(e[row]) 
```

结果：

```
array([[ 0\.        ,  1\.        ],
       [ 0.33333333,  0.66666667],
       [ 0.16666667,  0.83333333]]) 
```

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2013-04-24T21:25:06.553

方法＃1：使用`None`（或`np.newaxis`）添加额外的维度，以便广播将表现：

```
>>> e
array([[ 0.,  1.],
       [ 2.,  4.],
       [ 1.,  5.]])
>>> e/e.sum(axis=1)[:,None]
array([[ 0\.        ,  1\.        ],
       [ 0.33333333,  0.66666667],
       [ 0.16666667,  0.83333333]]) 
```

方法#2：转置快乐：

```
>>> (e.T/e.sum(axis=1)).T
array([[ 0\.        ,  1\.        ],
       [ 0.33333333,  0.66666667],
       [ 0.16666667,  0.83333333]]) 
```

（如果您愿意，可以删除该`axis=`部分以简洁明了。）

方法#3：（从 Jaime 的评论中提升）

使用`keepdims`参数 on`sum`保留维度：

```
>>> e/e.sum(axis=1, keepdims=True)
array([[ 0\.        ,  1\.        ],
       [ 0.33333333,  0.66666667],
       [ 0.16666667,  0.83333333]]) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-06-24T16:38:32.567

你可以在数学上做到这一点[![在此处输入图像描述](https://i.stack.imgur.com/RhQZn.gif)](https://i.stack.imgur.com/RhQZn.gif)。

在这里，`E`是您的原始矩阵，并且`D`是一个对角矩阵，其中每个条目是 中相应行的总和`E`。如果你有幸拥有一个 invertible `D`，这是一种在数学上非常方便的做事方式。

在 numpy 中：

```
import numpy as np

diagonal_entries = [sum(e[row]) for row in range(e.shape[0])]
D = np.diag(diagonal_entries)
D_inv = np.linalg.inv(D)
e = np.dot(e, D_inv) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-07-15T17:07:35.733

您还可以使用 numpy 的 reshape 方法，如下所示：

```
e = np.array([[0., 1.],[2., 4.],[1., 5.]])
e/=np.sum(e, axis=1).reshape(-1,1)
e

array([[0\.        , 1\.    ],
       [0.33333333, 0.66666667],
       [0.16666667, 0.83333333]]) 
```

# javascript - d3js图表动画不起作用

> ID：16202354
> 
> 赞同：0
> 
> 时间：2013-04-24T21:16:54.540
> 
> 标签：javascript, animation, d3.js

我正在将转换应用于我的图表。但我正在努力让他们产生任何结果。我正在尝试遵循`.enter()`, `.update()`,`.exit()`模式。

我想要完成的是让一系列数据消失。我希望当个人点击图例（选择/取消选择）时发生这种情况，但现在，为了方便 - 我将功能附加到按钮上。选择按钮后，所有绿条都会出现，所有蓝条都会消失。

让我感到困惑的部分是，这是一个成对的条形图。因此，事物被分组，并增加了一层额外的复杂性。

```
d3.select("#change").on("click", updateBars);
function updateBars()
{   

xScale.domain(d3.range(dataset.length)).rangeRoundBands([0, w], 0.05);
yScale.domain([0, d3.max(dataset, function(d) { return (d.local > d.global) ? d.local : d.global;})]); 

var bars = svg.selectAll("sets")
    .data(dataset);

bars.enter()
    .attr("x", w)
    .attr("y", function(d){ 
        return h - yScale(d.global);
    })
    .attr("width", xScale.rangeBand())
    .attr("height", function(d){
        return yScale(d.global);
    })
    .attr("fill", colors[0][1])
    ;

//Update
bars.transition()
    .duration(500)
    .attr("x", function(d, i) {
        return xScale(i);
    })
    .attr("y", function(d) {
        return h - yScale(d.global);
    })
    .attr("width", xScale.rangeBand())
    .attr("height", function(d) {
        return yScale(d.global);
    });

//Exit
bars.exit()
    .transition()
    .duration(500)
    .attr("x", -xScale.rangeBand())
    .remove();
} 
```

我的完整代码也可以**[在我的 JSFiddle 上看到](http://jsfiddle.net/enigmarm/weXNd/5/)**。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:36:03.200

问题在于，使用您的方法，您不能真正按预期使用进入/更新/退出选择。您正在使用数据创建条形集，然后手动附加各个条形而不用数据项表示它们。

我已经更新了您的 jsfiddle 以[在此处](http://jsfiddle.net/weXNd/6/)提供某种形式的转换，但要使其以正确的 D3 方式工作，您需要重组代码。这个想法是只使用数据创建两组条形图，即类似

```
d3.selectAll("rect.global").data(data)
  .enter().append("rect")
  .attr("class", "global")
  ...
d3.selectAll("rect.local").data(data)
  .enter().append("rect")
  .attr("class", "local")
  ... 
```

然后您可以使用相同的 selectAll/data 构造稍后使单个条消失、移动等。请注意，如果您只想删除一种特定类型的条（例如在您的 jsfiddle 中），则您实际上并不需要所有那——像我修改过的 jsfiddle 中的方法就足够了。

只有当您想要更新条形的值、为系列添加新值或删除系列的一部分时，您才应该认真考虑按照上面概述的方式重组代码。

# php - 从php中的两级路径获取所有zip文件

> ID：16202357
> 
> 赞同：2
> 
> 时间：2013-04-24T21:17:04.133
> 
> 标签：php, arrays, file, loops, zip

我想从我的两级路径中获取所有 *.zip 文件，我做了两个 while 循环和 foreach 循环。一直以来，我对“array_filter() [function.array-filter]：第一个参数应该是一个数组”之类的数组都有一些错误。有人可以帮忙吗？

```
<?php
$dirs = array_filter(glob('*'), 'is_dir');
 while (list($key, $value) = each($dirs)) {
  $dirs_2 = array_filter(glob($value.'/*'), 'is_dir');
  while (list($key_2, $value_2) = each($dirs_2)) {
    foreach (array_filter(glob($value_2."/*.zip")) as $filename) {
        echo "$filename size " . filesize($filename) . "\n";
    }
   }
 }
?> 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:22:19.690

您可以为此使用[SplIterators](http://www.php.net/manual/en/spl.iterators.php)。[`RecursiveDirectoryIterator`](http://www.php.net/manual/en/class.recursivedirectoryiterator.php)用于此：

```
// create recursive directory iterator for zip folder
$directory_iterator = new RecursiveDirectoryIterator('/path/to/zip/files');´   
// required to iterate through results using foreach
$recusive_iterator = new RecursiveIteratorIterator($directory_iterator);
// filter only .zip files
$regex_iterator = new RegexIterator($recursive_iterator, '/^.*\.zip$/',
                          RegexIterator::GET_MATCH);

// iterate through results
foreach($regex_iterator as $file_info) {
    var_dump($file_info);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:48:49.080

类似于您的原始代码的简单解决方案可能类似于：

```
$dirs = scandir('.');
foreach ($dirs as $dir) {
  if (is_dir($dir) && !preg_match('/^\.\.?$/', $dir)) {
    $dirs2 = scandir($dir);
    foreach ($dirs2 as $dir2) {
       if (is_dir($dir . '/' . $dir2) && !preg_match('/^\.\.?$/', $dir2)) {
        $files = scandir($dir . '/' . $dir2);
        foreach ($files as $file) {
          if (preg_match('/.+\.zip$/', $file)) {
            echo $file . "\n";
          }
        }
      }
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:23:04.413

这可能意味着`glob()`返回`false`表明发生了错误，您可以通过检查是否返回 false 来跳过它，在这种情况下提供一个空数组以便您的代码继续工作，例如替换以下代码：

```
$dirs_2 = array_filter(glob($value.'/*'), 'is_dir'); 
```

对于这个：

```
$dirs_2 = array_filter(glob($value.'/*') || array(), 'is_dir'); 
```

* * *

作为旁注，您可以完全跳过所有 array_filter ，因为您可以传递 glob() 一个参数，因此它只返回目录条目，它是标志`GLOB_ONLYDIR`，因此您可以替换以下代码：

```
$dirs = array_filter(glob('*'), 'is_dir'); 
```

对于这个：

```
$dirs = glob('*', GLOB_ONLYDIR) || array(); 
```

# css - Magento #nav 与 RGBA 问题

> ID：16202360
> 
> 赞同：2
> 
> 时间：2013-04-24T21:17:21.910
> 
> 标签：css, magento, hex, nav, rgba

所以我试图在我的导航中添加一个 RBBa 背景颜色，但是如果它不是纯色，它会被推回元素后面。为什么是这样？标记都是正确的，您可以在此处查看问题：www.newsecuritytechnologies.com

尝试使用顶部的导航，它看起来正确，但落后于其他元素。这是因为RGBa吗？如果是这样，为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:47:19.430

这个答案最终有点欺骗性！

你看，你的链接与你的蓝色横幅颜色相同，它们似乎消失了，因为导航背景非常不透明（并且与下面的深蓝色非常相似），介绍块的深蓝色将它淹没了.

修改此 CSS 以了解我的意思，您认为已消失的链接实际上会显示：

```
#nav ul li a {
    color: #FF0000;
} 
```

如果您在 firebug（或 chrome 开发人员工具）中选择 rgba 值的最后一部分并使用向上或向下箭头键递增它，您也可以看到这一点，您应该注意到您越接近值为 1更突出的导航将变为蓝色条。

我希望这是有道理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:31:16.767

如果您使用透明，RGBA 也是如此。您必须通过显示知道此元素下的元素。你可以改变颜色，`.quick-access`也许一些灰色会很好。另一个想法是你应该小心使用 rgba，IE8 不支持 rgba。

[http://caniuse.com/#search=rgba](http://caniuse.com/#search=rgba)

# android - 如何将带有 AndEngine 库的 android 项目发送给另一个人

> ID：16202362
> 
> 赞同：0
> 
> 时间：2013-04-24T21:17:32.520
> 
> 标签：android, eclipse, andengine, file-transfer

I'm making a small android game for someone usign the AndEngine library and am stumped on how to easily send them the project without requiring them to do any configuration, just download the project import it into eclipse and run it.

AndEngine is a library based engine, to use it in your project you just add the actual source projects to your build path and reference them that way, so I need a way to send my project + the AndEngine source to them in such away that they can just run it without having to configure anything. I tried just putting all the projects(the game + the andengine library projects) in one workspace and sending the whole workspace but the projects are linked using the absolute path, instead of a path relative to my project, so it doesnt work on a different computer with different folders and everything.

你会建议我怎么做？我们都将使用eclipse。

这是我第一次不得不做这样的事情，我不知道从哪里开始，我真的需要快速帮助，我很感激我得到的任何回应，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:11:33.233

虽然这确实需要一些配置，但我建议使用 GIT 等版本控制来管理它。Bitbucket[有免费的私有仓库（小团队免费，大团队便宜）](https://bitbucket.org/) Github 也很受欢迎。

然后，您可以简单地在 github 上发送 andengine 库的 git 路径以及存储库中的项目，然后 eclipse 将完成剩下的工作。

去做这个：

*   转到文件>导入>
*   如果您安装了 git 插件，您将看到“GIT”文件夹选项。选择“来自 Git 的项目”
*   从存储库源中选择“URL”。
*   然后从 bitbucket/github 粘贴到存储库路径并完成向导。

从 bitbucket 获取 URL 时，请务必选择“HTTPS”选项而不是“SSH”，除非您要设置 RSA 密钥。而且由于您正在寻找简单的东西，因此您不需要。

此外，如果您不同时使用它，我建议您尝试使用 google 发布的名为 ADT 的 android-specific build - 它集成了 eclipse git 插件和其他方便的 android 工具，并且需要最少的更改。

最后一件事：由于您可能会发送多个文件，git 也使生活变得轻松，因为您只需对存储库进行提交，其他人就可以再次从同一源获取新的更新文件。

# scala - Scalatest 或 Specs2 - 在并行运行的测试中设置和拆除变量

> ID：16202371
> 
> 赞同：2
> 
> 时间：2013-04-24T21:17:58.403
> 
> 标签：scala, tdd, bdd, scalatest, specs2

如果我需要为套件中的每个测试设置一些变量，是否有可能以某种方式设置它们并将它们放入测试而无需为每个测试编写套件？

即，设置：

```
val actorRef = context.actorOf(Props(new MyTestDude)) 
```

拆除：

```
actorRef ! PoisonPill 
```

如果我使用 setup 和 teardown 钩子运行，我需要将 actorref 作为测试类中的一个字段，以便可以从 setup 方法访问它，但是我不能并行运行测试，因为每个人都将共享相同的状态。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-26T00:43:46.403

`AroundOutside` [为了您的信息，您可以使用隐式上下文](http://etorreborre.github.io/specs2/guide/org.specs2.guide.Structure.html#Implicit+context)在 specs2 中执行类似的操作：

```
import org.specs2._
import execute._
import specification._

class s extends mutable.Specification {
  // this context will be used for each example
  implicit def withActor = new AroundOutside[ActorRef] { 

    // actor is passed to each example
    val actor = context.actorOf(Props(new MyTestDude)) 
    def outside = actor

    // execute the example code
    def around[R : AsResult](r: =>R) = {
      try AsResult(r)
      finally (actor ! PoisonPill)
    }
  }

  "My actor rules!" in { actor: ActorRef =>
     actor ! "very important message"
     ok
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T00:41:57.397

在 Scalatest 中，所有的 Suite 子类都有一些处理这个问题的方法，这在 Scaladoc 中针对特定的套件类进行了详细描述。

这是基于文档的使用 FunSuite 的示例。[http://www.artima.com/docs-scalatest-2.0.M5b/#org.scalatest.FunSuite](http://www.artima.com/docs-scalatest-2.0.M5b/#org.scalatest.FunSuite)

```
class ExampleSuite extends fixture.FunSuite {

  case class F(actorRef: ActorRef)
  type FixtureParam = F

  def withFixture(test: OneArgTest) {

    val actorRef = context.actorOf(Props(new MyTestDude))
    val fixture = F(actorRef)

    try {
      withFixture(test.toNoArgTest(fixture)) // "loan" the fixture to the test
    }
    finally {
      actorRef ! PoisonPill
    }
  }

  test("My actor rules!") { f =>
    f.actorRef ! "very important message"
    assert( ... )
  }
} 
```

另请注意，Akka 有一个用于 ScalaTest 的特殊模块，称为 TestKit，它通常会使测试 actor 变得更加容易。[http://doc.akka.io/docs/akka/snapshot/scala/testing.html](http://doc.akka.io/docs/akka/snapshot/scala/testing.html)

# compilation - 使用 Cygwin 在 Windows 7 上配置 Hydra-7.4.2

> ID：16202373
> 
> 赞同：0
> 
> 时间：2013-04-24T21:18:13.093
> 
> 标签：compilation, cygwin, hydra

我正在尝试使用 Cygwin 在我的 Windows 7 笔记本电脑上配置 THC Hydra 7.4.2。我使用 setup.exe 安装了 Cygwin，我选择了 devel 和 MinGW 包。

当我执行 ./configure 时它很好.. 虽然提到了一些缺少的模块。然后我被提示'现在输入“make”'。

当我这样做时，我收到以下错误消息：

```
PC@Z-PC ~/hydra/hydra-7.4.2
$ ./configure

Starting hydra auto configuration ...

Checking for openssl (libssl, libcrypto, ssl.h, sha.h) ...
                                                       ... found
Checking for idn (libidn.so) ...
                             ... found
Checking for curses (libcurses.so / term.h) ...
                                            ... found, color output enabled
Checking for pcre (libpcre.so, pcre.h) ...
                                       ... found
Checking for Postgres (libpq.so, libpq-fe.h) ...
                                             ... found
Checking for SVN (libsvn_client-1 libapr-1.so libaprutil-1.so) ...
                                                               ... found
Checking for firebird (libfbclient.so) ...
                                       ... NOT found, module firebird disabled
Checking for MYSQL client (libmysqlclient.so, math.h) ...
                                                      ... NOT found, module Mysq               l will not support version > 4.x
Checking for AFP (libafpclient.so) ...
                                   ... NOT found, module Apple Filing Protocol d               isabled - Apple sucks anyway
Checking for NCP (libncp.so / nwcalls.h) ...
                                         ... NOT found, module NCP disabled
Checking for SAP/R3 (librfc/saprfc.h) ...
                                      ... NOT found, module sapr3 disabled
Get it from http://www.sap.com/solutions/netweaver/linux/eval/index.asp
Checking for libssh (libssh/libssh.h) ...
                                      ... NOT found, module ssh disabled
Get it from http://www.libssh.org
Checking for Oracle (libocci.so libclntsh.so / oci.h and libaio.so) ...
                                                                    ... NOT foun               d, module Oracle disabled
Get basic and sdk package from http://www.oracle.com/technetwork/database/featur               es/instant-client/index.html
Checking for GUI req's (pkg-config, gtk+-2.0) ...
                                              ... found

Hydra will be installed into .../bin of: /usr/local
  (change this by running ./configure --prefix=path)

Writing Makefile.in ...

Cygwin detected, if compilation fails just update your installation.

Windres found, will attach icons to hydra cygwin executables

now type "make"

PC@Z-PC ~/hydra/hydra-7.4.2
$ make
gcc -I. -O3 -lm    -o hydra hydra-logo.o hydra.c hydra-vnc.o hydra-pcnfs.o hydra               -rexec.o hydra-nntp.o hydra-socks5.o  hydra-telnet.o hydra-cisco.o hydra-http.o                hydra-ftp.o hydra-imap.o  hydra-pop3.o hydra-smb.o hydra-icq.o hydra-cisco-enabl               e.o hydra-ldap.o  hydra-mysql.o hydra-mssql.o hydra-xmpp.o hydra-http-proxy-urle               num.o  hydra-snmp.o hydra-cvs.o hydra-smtp.o hydra-smtp-enum.o hydra-sapr3.o hyd               ra-ssh.o  hydra-sshkey.o hydra-teamspeak.o hydra-postgres.o hydra-rsh.o hydra-rl               ogin.o  hydra-oracle-listener.o hydra-svn.o hydra-pcanywhere.o hydra-sip.o  hydr               a-oracle-sid.o hydra-oracle.o hydra-vmauthd.o hydra-firebird.o hydra-afp.o hydra               -ncp.o  hydra-http-proxy.o hydra-http-form.o hydra-irc.o  hydra-rdp.o crc32.o d3               des.o bfg.o ntlm.o sasl.o hmacmd5.o hydra-mod.o -lm -lcurses -lssl -lidn -lpcre                -lpq -lsvn_client-1 -lapr-1 -laprutil-1 -lsvn_subr-1 -lcrypto -L/usr/lib -L/usr/               local/lib -L/lib -L/lib -I/usr/include/subversion-1 -I/usr/include/apr-1 -I/usr/               include/subversion-1 -DLIBOPENSSL -DLIBOPENSSLNEW -DLIBNCURSES -DLIBIDN -DHAVE_P               R29_H -DHAVE_PCRE -DLIBPOSTGRES -DLIBSVN -DHAVE_MATH_H
/usr/lib/libpq.a(fe-connect.o): In function `ldapServiceLookup':
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3541: undefined reference to `_ldap_init'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3553: undefined reference to `_ldap_simple_bind'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3563: undefined reference to `_ldap_result'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3576: undefined reference to `_ldap_msgfree'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3580: undefined reference to `_ldap_search_st'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3584: undefined reference to `_ldap_msgfree'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3585: undefined reference to `_ldap_err2string'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3588: undefined reference to `_ldap_unbind'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3594: undefined reference to `_ldap_count_entries'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3622: undefined reference to `_ldap_msgfree'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3623: undefined reference to `_ldap_unbind'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3569: undefined reference to `_ldap_msgfree'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3573: undefined reference to `_ldap_unbind'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3606: undefined reference to `_ldap_first_entry'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3618: undefined reference to `_ldap_get_values_len'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3628: undefined reference to `_ldap_msgfree'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3648: undefined reference to `_ldap_value_free_len'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3649: undefined reference to `_ldap_unbind'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3661: undefined reference to `_ldap_value_free_len'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-connect.c:3662: undefined reference to `_ldap_unbind'
/usr/lib/libpq.a(fe-misc.o): In function `libpq_gettext':
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-misc.c:1202: undefined reference to `_libintl_bindtextdomain'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-misc.c:1210: undefined reference to `_libintl_dgettext'
/usr/lib/libpq.a(fe-misc.o): In function `pqSocketCheck':
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-misc.c:1025: undefined reference to `_SSL_pending'
/usr/lib/libpq.a(fe-secure.o): In function `initialize_SSL':
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:1094: undefined reference to `_SSL_CTX_use_certificate_chain_file               '
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:1104: undefined reference to `_SSL_use_certificate_file'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:1183: undefined reference to `_SSL_use_PrivateKey'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:1253: undefined reference to `_SSL_check_private_key'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:1281: undefined reference to `_SSL_CTX_load_verify_locations'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:1292: undefined reference to `_SSL_CTX_get_cert_store'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:1322: undefined reference to `_SSL_set_verify'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:1239: undefined reference to `_SSL_use_PrivateKey_file'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:1357: undefined reference to `_SSL_ctrl'
/usr/lib/libpq.a(fe-secure.o): In function `init_ssl_system':
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:946: undefined reference to `_TLSv1_method'
/usr/lib/libpq.a(fe-secure.o): In function `pqsecure_write':
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:491: undefined reference to `_SSL_get_error'
/usr/lib/libpq.a(fe-secure.o): In function `pqsecure_read':
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:330: undefined reference to `_SSL_get_error'
/usr/lib/libpq.a(fe-secure.o): In function `close_SSL':
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:1466: undefined reference to `_SSL_shutdown'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:1467: undefined reference to `_SSL_free'
/usr/lib/libpq.a(fe-secure.o): In function `open_client_SSL':
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:1432: undefined reference to `_SSL_get_peer_certificate'
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:1381: undefined reference to `_SSL_get_error'
/usr/lib/libpq.a(fe-secure.o): In function `pqsecure_open_client':
/pub/devel/postgresql/postgresql-9.2.4-1/src/postgresql-9.2.4/src/interfaces/lib               pq/fe-secure.c:259: undefined reference to `_SSL_set_ex_data'
/usr/lib/libpq.a(chklocale.o): In function `pg_get_encoding_from_locale':
/pub/devel/postgresql/postgresql-9.2.4-1/build/src/interfaces/libpq/chklocale.c:               269: undefined reference to `_libintl_setlocale'
/pub/devel/postgresql/postgresql-9.2.4-1/build/src/interfaces/libpq/chklocale.c:               277: undefined reference to `_libintl_setlocale'
/pub/devel/postgresql/postgresql-9.2.4-1/build/src/interfaces/libpq/chklocale.c:               292: undefined reference to `_libintl_setlocale'
/pub/devel/postgresql/postgresql-9.2.4-1/build/src/interfaces/libpq/chklocale.c:               298: undefined reference to `_libintl_setlocale'
/pub/devel/postgresql/postgresql-9.2.4-1/build/src/interfaces/libpq/chklocale.c:               351: undefined reference to `_libintl_gettext'
collect2: ld returned 1 exit status
Makefile:51: recipe for target `hydra' failed
make: *** [hydra] Error 1 
```

我不确定它有什么问题..我尝试使用所有软件包（在大量下载时间之后）以及默认软件包重新安装 Cygwin，但它都不起作用..任何帮助表示赞赏..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-06T18:23:26.840

我刚刚在 Cygwin 上尝试了 Hydra 7.6。它禁用 PostgreSQL 的使用，configure 说：

```
Checking for Postgres (libpq.so, libpq-fe.h) ...
                                         ... DISABLED - postgres is buggy in Cygwin at the moment 
```

我想这就是你的问题的答案。是马车。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-28T18:16:52.503

好吧，这个网站上似乎没有任何人有相关经验。我对这个网站的工作方式有点失望。如果我问简单的问题，那么人们会投反对票，如果我问一些严肃的问题，那么我什至不会收到任何评论。

无论如何，我仍然不确定“Hydra-7.4.2”有什么问题，请注意我已经安装了完整的 cygwin 包并且在编译 hydra 时仍然出现“make”错误。

为了测试，我安装并编译了“Hydra-6.1”......幸运的是它成功了！因此，如果有人遇到相同的错误，请尝试移至以前的版本，或者如果您解决了这个问题，请分享详细信息。

# navigation - 导航服务块

> ID：16202375
> 
> 赞同：0
> 
> 时间：2013-04-24T21:18:18.133
> 
> 标签：navigation

在我的主窗口中，我使用以下代码导航到页面。

```
 private void logThresholds_Click_1(object sender, RoutedEventArgs e)
        {
            this.NavFrame.NavigationService.Navigate(trainSetQualityPage);
            trainSetQualityPage.MeasureQuality();
        } 
```

该页面将在方法测量质量处理后显示（需要几秒钟），但应该避免这种情况。
进度条包含在页面 trainsetquality 中，但如上所述，它将显示在末尾。

因此，用户界面没有延迟地改变视图可以改变什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T03:23:14.360

after reading about NavigationService, i tried the Navigated event which did not the trick.

subsequent, [BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx) was applied and the user interface can be used during processing of my stuff. according to msdn, `DoWork` and `ProgressChanged` events are used.

only a minor obstacle - a try catch was relevant for the `ReportProgress` method because it throws twice an exception.

# java - 每天在特定时间运行代码

> ID：16202380
> 
> 赞同：1
> 
> 时间：2013-04-24T21:18:40.313
> 
> 标签：java, android

我想每天在 [用户选择] 处禁用服务并在 [用户选择] 处启用它。实现这一目标的最佳方法是什么？

我应该使用日历吗？（计算开始和结束时间，还是别的什么？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:21:40.770

来自 Justin Breitfeller 对[Android Java - Creating a Cronjob](https://stackoverflow.com/questions/14605912/android-java-creating-a-cronjob)的回答：

> Android [AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)是您正在寻找的类。它可以触发意图以设定的时间间隔发送到您的应用程序，以便您可以运行任何您想要的任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:31:36.023

您要查找的内容称为“ Cron”。它可以通过[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)来实现。 `AlarmManager myAlarmManager = Context.getSystemService(Context.ALARM_SERVICE)`

# java - 在 Scala 中使用 Hector 库时出错

> ID：16202381
> 
> 赞同：1
> 
> 时间：2013-04-24T21:18:40.517
> 
> 标签：java, scala, hector

[hector-core-1.1-2.jar 和 hector-core-1.1-4.jar ( http://hector-client.github.io/hector/build/html/index.html](http://hector-client.github.io/hector/build/html/index.html) )我都遇到了同样的问题. 当我尝试编译使用基于 Java 的 Hector 库的 Scala 脚本时，我在 sbt 中收到以下错误：

[错误] 加载集群时出错，类文件 '/path_to_hector/hector-core-1.1-2.jar(me/prettyprint/hector/api/Cluster.class)' 已损坏 [错误] (class java.lang.NullPointerException/ )

Hector 是否需要重新构建以使用 Scala 的特殊方式？

# jquery - JQUERY选择具有特定样式的tr内的所有td单元格

> ID：16202382
> 
> 赞同：0
> 
> 时间：2013-04-24T21:18:42.957
> 
> 标签：jquery, css, html-table, tablerow

如何更改具有特定样式的 tr 内的 td 单元格的颜色？

例如：

```
<tr style="display: table-row">
<td></td>
<td></td>
</tr> 
```

到目前为止我已经这样做了，但它不能完全工作：

```
if ($('.mydiv').css('display') == 'table-row') {
   $(this).siblings('td').css("background-color", "white");
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T21:21:00.393

我的第一个想法，虽然未经测试，将是：

```
$('td').filter(function(){
    return this.parentNode.style.display == 'table-row';
}).css('background-color','#fff'); 
```

正如所写，这将选择所有`td`元素，然后将其过滤到其父元素`tr`具有`style="display: table-row;"`; 不过，这确实需要`tr`具有内联样式设置。然而，再多投入一点 jQuery，您可以通过以下方式实现相同的目标：

```
$('td').filter(function(){
    return $(this).parent().css('display') == 'table-row';
}).css('background-color','#fff'); 
```

这将以相同的方式过滤，但包括在外部样式表（或文档中的`style`标签）中设置的 CSS。`head`

但是，我会减少 DOM 遍历并`tr`仅显式处理元素，并使用给定的类名来实现相同的目的：

```
$('tr').filter(function(){
    return $(this).css('display') == 'table-row';
}).addClass('hasDisplayTableRow'); 
```

当然，这允许使用 CSS：

```
tr.hasDisplayTableRow td {
    /* css */
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T21:21:22.283

你不能为风格做到这一点，你需要一个类：

```
<tr style="display: table-row" class="myrow">
    <td></td>
    <td></td>
</tr> 
```

然后你可以在 css 中设置它的样式：

```
tr.myrow td{
    background-color: white
} 
```

或者在 jQuery 中：

```
$("tr.myrow td").css({"background-color": "white"}) 
```

**编辑**大卫的回答表明这是可能的。虽然它很聪明，但类方法将更易于维护 IMO

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:23:07.087

比较内联样式并不总是一个好主意。

相反，为什么不将类添加到有问题的 tr 中，这样它会更干净。

```
.table-row{
   display: table-row;
} 
```

然后你可以使用这个

```
if ($('.mydiv').hasClass('table-row')) {
   $(this).siblings('td').css("background-color", "white");
} 
```

而不是这个`<tr style="display: table-row">`

尝试更改您的标记

```
<tr class="table-row"> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T21:23:12.917

你为什么不通过 CSS 做到这一点？这是我在 JQuery 中的做法。

```
$("tr[style='<your style value here>'] td").css("background-color", "white"); 
```

# nose - 我怎样才能让鼻子重新运行失败的测试？

> ID：16202384
> 
> 赞同：31
> 
> 时间：2013-04-24T21:18:49.100
> 
> 标签：nose

我有一些 Selenium Webdriver GUI 测试，它们在我们的 Trac/Bitten 构建环境中的每次签入时运行。由于各种愚蠢的原因，这些都是脆弱的，重新运行失败的测试总是有效的（除非它没有，然后我有一个实际失败的测试）。

如何重新运行这些失败的测试？GUI 测试需要 10 到 15 分钟才能运行，因此重新运行所有测试会很痛苦。

这是构建步骤：

```
<step id="guitest" description="Run gui tests">
    <sh:exec executable="gui_tests.sh" />
</step> 
```

和 gui_tests.sh

```
# Setup environment stuff deleted
nosetests python/*Tests.py -v 
```

我们正在努力使 GUI 测试更加健壮，但我的理解是，这就是 GUI 测试的生命。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-04-24T21:18:49.100

2021 年 6 月编辑：令人惊讶的是，这仍然获得选票。如果可能，请考虑将[ptyest](https://pytest.org)与该`--last-failed`选项一起使用。

事实证明，这对鼻子来说是微不足道的。首先运行命令并包含`--with-id`标志。

```
# Environment stuff deleted
nosetests python/*Tests.py -v --with-id
nosetests python/*Tests.py -v --failed 
```

如果，比如说，四个测试失败，使用`--failed`标志运行将只运行这四个测试。如果您随后更正了三个，运行 with`--failed`将只运行剩余的失败测试。

再次运行`--with-id`会重置失败测试的跟踪并运行所有找到的测试。

在我开始编写自己的插件之前，我对此进行了相当多的搜索。在研究如何注册我的插件时，我发现一些代码恰好是nose提供的[testid插件](https://github.com/nose-devs/nose/blob/master/nose/plugins/testid.py#L38)，它提供了上面的功能。嘘。我在这里记录这个，希望能节省一些时间。

当然，现在我知道了，很明显可以通过以下方式找到它：

```
nosetests --help 
```

我最初扫描了文档，但没想到会那么容易，所以我三心二意地做了。

# java - 是否可以在 Alertdialog 中创建 GridView？

> ID：16202393
> 
> 赞同：0
> 
> 时间：2013-04-24T21:19:18.947
> 
> 标签：java, android, gridview

是否可以在警报对话框中创建 GridView？

目前我有一个单词搜索，我想在弹出对话框中显示解决方案（完成的单词搜索），以便用户可以在他们的谜题和答案之间快速切换。

我试过像这样实现它

```
AlertDialog.Builder aBuilder = new AlertDialog.Builder(this);

 // set title
 aBuilder.setTitle("The solution");
    GridView g = null ;
    final ArrayAdapter<String> Wordadapter = new ArrayAdapter<String>(getApplicationContext(),
            R.layout.wordsstyle, WordsToFind);
    g.setNumColumns(Length);
    g.setAdapter(Wordadapter);
     aBuilder.setView(g);
 aBuilder.setPositiveButton("OK", new DialogInterface.OnClickListener()
 {
 public void onClick(DialogInterface dialog, int whichButton)
 {
 }
}); 
```

然而它只是崩溃

我在我的日志猫里得到了这个

```
04-24 21:17:48.472: E/AndroidRuntime(826): FATAL EXCEPTION: main
04-24 21:17:48.472: E/AndroidRuntime(826): java.lang.IllegalStateException: Could not     execute method of the activity
04-24 21:17:48.472: E/AndroidRuntime(826):  at     android.view.View$1.onClick(View.java:3591)
04-24 21:17:48.472: E/AndroidRuntime(826):  at android.view.View.performClick(View.java:4084)
04-24 21:17:48.472: E/AndroidRuntime(826):  at android.view.View$PerformClick.run(View.java:16966)
04-24 21:17:48.472: E/AndroidRuntime(826):  at android.os.Handler.handleCallback(Handler.java:615)
04-24 21:17:48.472: E/AndroidRuntime(826):  at android.os.Handler.dispatchMessage(Handler.java:92)
04-24 21:17:48.472: E/AndroidRuntime(826):  at android.os.Looper.loop(Looper.java:137)
04-24 21:17:48.472: E/AndroidRuntime(826):  at     android.app.ActivityThread.main(ActivityThread.java:4745)
04-24 21:17:48.472: E/AndroidRuntime(826):  at java.lang.reflect.Method.invokeNative(Native Method)
04-24 21:17:48.472: E/AndroidRuntime(826):  at java.lang.reflect.Method.invoke(Method.java:511)
04-24 21:17:48.472: E/AndroidRuntime(826):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
04-24 21:17:48.472: E/AndroidRuntime(826):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
04-24 21:17:48.472: E/AndroidRuntime(826):  at dalvik.system.NativeStart.main(Native Method)
04-24 21:17:48.472: E/AndroidRuntime(826): Caused by: java.lang.reflect.InvocationTargetException
04-24 21:17:48.472: E/AndroidRuntime(826):  at java.lang.reflect.Method.invokeNative(Native Method)
04-24 21:17:48.472: E/AndroidRuntime(826):  at java.lang.reflect.Method.invoke(Method.java:511)
04-24 21:17:48.472: E/AndroidRuntime(826):  at android.view.View$1.onClick(View.java:3586)
04-24 21:17:48.472: E/AndroidRuntime(826):  ... 11 more
04-24 21:17:48.472: E/AndroidRuntime(826): Caused by: java.lang.NullPointerException
04-24 21:17:48.472: E/AndroidRuntime(826):  at com.example.angrywordsearch.Puzzle_Activity.GridPopup(Puzzle_Activity.java:726)
04-24 21:17:48.472: E/AndroidRuntime(826):  at com.example.angrywordsearch.Puzzle_Activity.ViewSolution_Click(Puzzle_Activity.java:686)
04-24 21:17:48.472: E/AndroidRuntime(826):  ... 14 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:27:36.453

您可以启动一个使用 DialogTheme 的 ActivityForResult 将自己显示为对话框。

见[http://developer.android.com/guide/topics/ui/themes.html](http://developer.android.com/guide/topics/ui/themes.html)

例子： `<activity android:theme="@android:style/Theme.Dialog">`

从那里，您可以使用 Activity 的 setResult(int) 方法从网格中返回选定的结果。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T06:02:33.230

一个更好的方法来做到这一点并更好地控制实际布局是通过创建一个对话框并扩展一个包含 gridview 的自定义 XML。xml 本身就像任何其他布局一样只是一个 xml，唯一的区别是当我们对其进行膨胀时，它只会填充我们的对话框，而不是像普通的根布局那样填充整个屏幕。

所以首先我们创建对话框：

```
//create the dialog
final Dialog dialog = new Dialog(getBaseContext());

//remove the default title if you want to
dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);

//here is where we inflate our custom xml containing a gridview
dialog.setContentView(R.layout.grid_dialog); 
```

现在我们有了引用自定义 xml 的对话框对象，假设在该 XML 中我们有一个名为“my_grid”的网格视图，我们现在可以通过我们的对话框对象引用它，如下所示：

```
Gridview myGrid = (Gridview) dialog.findViewById(R.id.my_grid); 
```

现在您有了对 gridview 的引用，您可以执行通常对 gridview 执行的任何操作，例如设置自定义适配器。

对于您想要引用的任何其他布局对象，例如文本视图或按钮，只需以相同的方式进行即可。

如果您想设置对话框的确切大小，只需设置最外层父级的宽度和高度，对话框就会扩展到该大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T21:24:46.630

你在打电话`g.setNumColumns(Length)`，但`g`在`null`那个时候。因此`NullPointerException`在您的 LogCat 中。您需要以`GridView`某种方式初始化`GridView g = new GridView(this);`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T21:26:36.457

必须是网格视图？...因为您可以将项目数组添加到警报对话框中，类似于列表视图...检查一下：

```
final CharSequence[] items = {"Foo", "Bar", "Baz"};
AlertDialog.Builder builder = new AlertDialog.Builder(this);
builder.setTitle("Make your selection");
builder.setItems(items, new DialogInterface.OnClickListener() {
public void onClick(DialogInterface dialog, int item) {
     // Do something with the selection
}
});
AlertDialog alert = builder.create();
alert.show(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-25T06:20:21.523

简单的方法是在您的活动中进行任何类型的 Gridview 设计。如果您想将该活动显示为对话框，则只需`android:theme="@android:style/Theme.Dialog"`像往常一样在 Android 清单文件中设置该活动的主题，使用 startActivity 来调用您的网格视图。然后它将以对话框形式打开。（可能看起来像自定义对话框）。同时在 setcontent 视图使用 (Window.nofeatureDialog) 之前。避免对话框的标题。

希望这会帮助你。

# objective-c - iOS 网络服务不工作

> ID：16202398
> 
> 赞同：-1
> 
> 时间：2013-04-24T21:19:21.397
> 
> 标签：objective-c, web-services

我一直在关注一个教程（[http://www.raywenderlich.com/5492/working-with-json-in-ios-5](http://www.raywenderlich.com/5492/working-with-json-in-ios-5)），我得到了处理 json web 服务的代码（这是我的 web 服务：[http ://bit.ly/Y5430d](http://bit.ly/Y5430d) )

所以，我已经将我的 URL 更改为我的 web 服务和 objectforkey 来代表我的（我没有更改任何其他变量）。但是，未格式化的 json 没有通过。

我的网络服务有问题吗？

```
#define kBgQueue dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0) //1
#define kLatestKivaLoansURL [NSURL URLWithString: @"http://www.bushell.info/getResults.php"] //2

#import "ViewController.h"

@interface NSDictionary(JSONCategories)
+(NSDictionary*)dictionaryWithContentsOfJSONURLString:(NSString*)urlAddress;
-(NSData*)toJSON;
@end

@implementation NSDictionary(JSONCategories)
+(NSDictionary*)dictionaryWithContentsOfJSONURLString:(NSString*)urlAddress
{
    NSData* data = [NSData dataWithContentsOfURL: [NSURL URLWithString: urlAddress] ];
    __autoreleasing NSError* error = nil;
    id result = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];
    if (error != nil) return nil;
    return result;
}

-(NSData*)toJSON
{
    NSError* error = nil;
    id result = [NSJSONSerialization dataWithJSONObject:self options:kNilOptions error:&error];
    if (error != nil) return nil;
    return result;    
}
@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    dispatch_async(kBgQueue, ^{
        NSData* data = [NSData dataWithContentsOfURL: kLatestKivaLoansURL];
        [self performSelectorOnMainThread:@selector(fetchedData:) withObject:data waitUntilDone:YES];
    });
}

- (void)fetchedData:(NSData *)responseData {
    //parse out the json data
    NSError* error;
    NSDictionary* json = [NSJSONSerialization JSONObjectWithData:responseData //1
                                                         options:kNilOptions 
                                                           error:&error];
    NSArray* latestLoans = [json objectForKey:@"Latest lotto"]; //2

    NSLog(@"Latest lotto: %@", latestLoans); //3

    // 1) Get the latest loan
    NSDictionary* loan = [latestLoans objectAtIndex:0];

    // 2) Get the funded amount and loan amount
    NSNumber* fundedAmount = [loan objectForKey:@"funded_amount"];
    NSNumber* loanAmount = [loan objectForKey:@"loan_amount"];
    float outstandingAmount = [loanAmount floatValue] - [fundedAmount floatValue];

    // 3) Set the label appropriately
    humanReadble.text = [NSString stringWithFormat:@"Latest loan: %@ from %@ needs another $%.2f to pursue their entrepreneural dream",
                         [loan objectForKey:@"name"],
                         [(NSDictionary*)[loan objectForKey:@"location"] objectForKey:@"country"],
                         outstandingAmount
                         ];

    //build an info object and convert to json
    NSDictionary* info = [NSDictionary dictionaryWithObjectsAndKeys:
                          [loan objectForKey:@"name"], @"who",
                          [(NSDictionary*)[loan objectForKey:@"location"] objectForKey:@"country"], @"where",
                          [NSNumber numberWithFloat: outstandingAmount], @"what",
                          nil];

    //convert object to data
    NSData* jsonData = [NSJSONSerialization dataWithJSONObject:info 
                                                       options:NSJSONWritingPrettyPrinted
                                                         error:&error];

    //print out the data contents
    jsonSummary.text = [[NSString alloc] initWithData:jsonData
                                             encoding:NSUTF8StringEncoding];

}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T23:25:04.173

> 我的网络服务有问题吗？

简单的判断方法是使用您的应用程序以外的其他东西访问它。命令行程序`curl`是检查 Web 服务调用结果的好工具。甚至 Safari 也可以在这里提供帮助，特别是如果您启用 Web 检查器（首选项->高级->在菜单栏中显示开发菜单）。真的，任何能让你看到查询结果的东西都应该有效。

检查您的服务的另一种方法是使用像 Charles 这样的网络代理工具。您可以将您的设备设置为使用 Charles 作为 HTTP 代理，然后 Charles 将能够向您显示您的应用程序和服务器之间的所有流量。

# asp.net - backcolor 不是 asp.net 中 system.web.ui.control 的成员

> ID：16202400
> 
> 赞同：3
> 
> 时间：2013-04-24T21:19:22.730
> 
> 标签：asp.net, vb.net, backcolor

我在表运行时创建一些控件并将它们添加到 List(Of T) 以供将来使用。现在我想更改包含 ImageList(x) 的表格列的背景色。这里 ImageList() 是一个图像列表。但是当我尝试更改表格列的背景色时，即 imagelist(x) 的父级，它说背景色不是 system.web.ui.control 的成员。

这是代码

```
For x As Integer = 0 To FileImageList.Count - 1
            If sender.id.substring(3) = FileImageList(x).ID.Substring(3) Then
                FileNameList(x).Parent.backcolor = Drawing.Color.Green
            End If
        Next 
```

可能是什么问题？有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:28:19.953

我将 Imagelist() 的类型更改为 Object，它工作正常。没有错误。

# tomcat - 是否有必要使用 servlet（Tomcat、Jetty 等）安装 solr？

> ID：16202408
> 
> 赞同：1
> 
> 时间：2013-04-24T21:19:46.023
> 
> 标签：tomcat, servlets, solr, installation, jetty

是否有必要使用 servlet 安装 solr？我阅读了几个如何安装 solr 的教程，其中大多数都说这是必要的，但是当我在没有 Tomcat 服务器的情况下启动 Solr 时！我可以索引 xml 文件。我看不到与 Servlet Tomcat 的关系。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:09:30.683

据我所知，solr bundles with jetty 所以我怀疑你正在使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T13:25:29.713

根据[SolrInstall](http://wiki.apache.org/solr/SolrInstall) wiki 页面，第二个 Requirement 状态

> servlet 容器，例如 Tomcat、Jetty 或 Resin

Jetty 是默认的（捆绑的）servlet。请参阅[Servlet 容器或环境特定提示](http://wiki.apache.org/solr/SolrInstall#Servlet_Container_or_Environment_Specific_Tips)以获取帮助在各种 Servlet 容器中安装 Solr 的链接。

还有[EmbeddedSolr](http://wiki.apache.org/solr/EmbeddedSolr)的概念，但是请注意以下几点

> 使用 Solr 最简单、最安全的方式是通过 Solr 的标准 HTTP 接口。嵌入 Solr 不太灵活，更难支持，没有经过很好的测试，应该为特殊情况保留。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T16:56:35.093

不，如果您使用 EmbeddedSolrServer，则无需在 Tomcat 等 Web 容器中启动 solr。

# c# - 在路径中使用文件夹而不是驱动器号指定

> ID：16202409
> 
> 赞同：0
> 
> 时间：2013-04-24T21:19:48.333
> 
> 标签：c#, networking, filepath

列出文件路径时，有没有办法使用映射的网络驱动器文件夹而不是驱动器？例如，我有一个具有此路径位置的文件；N:\COMMON\Test.xls 和 N: 驱动器是 c103d213 on 'c103d213' 所以文件夹是 \c103d213\c103d213。我不想在那里硬编码驱动器号，因为根据人们设置驱动器的方式，他们的 N: 驱动器可能与我的完全不同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:28:40.057

您可以使用 WMI 来获取映射。我之前在一个项目中使用过这个：

```
string mapping = null;

var searcher = new ManagementObjectSearcher("root\\cimv2", "select Caption,ProviderName from Win32_MappedLogicalDisk");
foreach (ManagementObject drive in searcher.Get())
{
    if (drive["Caption"].ToString() == driveLetter)
    {
        mapping = drive["ProviderName"].ToString();
        break;
    }
} 
```

# jquery - 内部服务器错误 ASP 经典项目

> ID：16202415
> 
> 赞同：0
> 
> 时间：2013-04-24T21:20:13.087
> 
> 标签：jquery, asp-classic, windows-server-2008

我开发了一个经典的 ASP 应用程序，它允许用户构建自己的 PDF 报告。我已经使用[http://neeviapdf.com/PDFmerge/](http://neeviapdf.com/PDFmerge/)的软件来合并 pdf。该应用程序在我的 VS2012 本地运行时运行良好。但是，当我将网站的内容发布到我的远程 Windows 2008 服务器时，当我尝试构建报告时会出现内部服务器错误。我迷路了，不确定问题出在哪里。我几乎尝试了所有方法，但没有想法。服务器配置正确，我在服务器上安装了 mergepdf 软件，并为使用该应用程序的用户提供了权限。没有任何效果。

这是我的 html 标记，我已经摆脱了大部分 html 代码，只留下了重要的东西。

```
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Build Your Own Report</title>
    <link href="css/mainel.css" rel="stylesheet" />
    <link href="css/main.css" rel="stylesheet" />
    <link href='http://fonts.googleapis.com/css?family=Cinzel' rel='stylesheet' type='text/css' />
    <link href='http://fonts.googleapis.com/css?family=Roboto+Condensed:300,400,500,700' rel='stylesheet' type='text/css' />
    <link href="favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <script type="text/javascript"> 
        if (navigator.userAgent.match(/iPad/i)) { 
        var viewportmeta = document.querySelector('meta[name="viewport"]'); 
        if (viewportmeta) { 
        viewportmeta.content = 'width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1.0'; 
        jQuery(document).ready(function() { 
        document.body.addEventListener('gesturestart', function () { 
        viewportmeta.content = 'width=device-width, minimum-scale=0.20, maximum-scale=1.0'; 
        }, false); 
        }); 
        } 
        } 
</script> 

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/jquery.form.js"></script>
    <script src="js/jquery.url.js"></script>

<script type="text/javascript">
     $(document).ready(function () {

         var page = $('.report-tree .checkbox');
         var mainPage = $('.section-node .section-name');
         var allLink = $('.check-all');

         var pageNum;
         var Select_Section = $('.select-sec');
         var Clear_Section = $('.clear-sec');
         page.click(function () {
             pageNum = $(this).val();
             if ($(this).is(':checked')) {
                 //console.log(pageNum);
             }
         });
         mainPage.click(function () {
             if ($(this).parent('div').parent('li').hasClass('expanded')) {
                 $(this).parent().parent('li').removeClass('expanded');
                 $(this).parent().parent('li').children('.inner-pages').slideUp(400);
             } else {
                 $(this).parent().parent('li').addClass('expanded');
                 $(this).parent().parent('li').children('.inner-pages').slideDown(400);
             }
         });
         allLink.click(function () {
             if (($(this).attr('id')) == 'select-all') {
                 page.attr('checked', 'checked');
                 $('input#report-submit.button').attr('src', 'img/build-my-report.jpg')
                 $('.section-node').parent('li').addClass('expanded');
                 $('.inner-pages').slideDown(400);
             } else {
                 page.attr('checked', '');
                 $('input#report-submit.button').attr('src', 'img/builder-btn.png')
                 $('.section-node').parent('li').removeClass('expanded');
                 $('.inner-pages').slideUp(400);
             }
             return false;
         });
         Select_Section.click(function () {
             $(this).parent('.select-links').parent('div').parent('li').children('.inner-pages').children('.report-subpages').children('li').children('.subpage-node').children('.checkbox').attr('checked', 'checked');
             $(this).parent('.select-links').parent('div').parent('li').children('.inner-pages').children('.report-subpages').children('li').children('.report-subpages').children('li').children('.subpage-node').children('.checkbox').attr('checked', 'checked');
             if ($(this).parent('.select-links').parent('div').parent('li').children('.inner-pages').children('.report-subpages').children('li').children('.subpage-node').children('.checkbox').attr('checked', 'checked')) {
                 $('input#report-submit.button').attr('src', 'img/build-my-report.jpg')
             }
             $(this).parent('.select-links').parent().parent('li').children('.inner-pages').slideDown(400);
             $(this).parent('.select-links').parent('div').parent('li').addClass('expanded');

             return false;
         });
         Clear_Section.click(function () {
             $(this).parent('.select-links').parent('div').parent('li').children('.inner-pages').children('.report-subpages').children('li').children('.subpage-node').children('.checkbox').attr('checked', '');
             $(this).parent('.select-links').parent('div').parent('li').children('.inner-pages').children('.report-subpages').children('li').children('.report-subpages').children('li').children('.subpage-node').children('.checkbox').attr('checked', '');
             if ($(this).parent('.select-links').parent('div').parent('li').children('.inner-pages').children('.report-subpages').children('li').children('.report-subpages').children('li').children('.subpage-node').children('.checkbox').attr('checked', '')) {
                 $('input#report-submit.button').attr('src', 'img/builder-btn.png')
             }
             $(this).parent('.select-links').parent().parent('li').children('.inner-pages').slideUp(400);
             $(this).parent('.select-links').parent('div').parent('li').removeClass('expanded');

             return false;
         });

         /*$('.checkbox').click(function () {
             if ($(this).is(':checked'))
                 alert('checked');
             else
                 alert('unchecked');
         });*/

         function setupProcessing(formData, jqForm, options) {

             var val = $('#report-builder').valid();
             if (val) {
                 $('#download-restart').hide();

                 $('#ajax-loader').show();

                 $('input#report-submit.button').attr('src', 'img/build-my-report.jpg').css({ 'opacity': '0.2', ' filter': 'alpha(opacity = 50)' });

             } else {
                 $('#make-a-selection').show();
             }
             return val;
         }
         function showResponse(responseText, statusText, xhr, $form) {
             $('#ajax-loader').hide();
             $('#download-report-link').attr('href', responseText);
             $('#download-restart').show();

             $('#report-submit').hide();

             $('#download-report-link').click(function () {
                 setTimeout("window.location = window.location", 100);
             });
         }

         var options = {
             //target:        '#output1',   // target element(s) to be updated with server response 
             beforeSubmit: setupProcessing,  // pre-submit callback 
             success: showResponse,  // post-submit callback 
             timeout: 30000,
             // other available options: 
             //url:       url         // override for form's 'action' attribute 
             //type:      "post",        // 'get' or 'post', override for form's 'method' attribute 
             //dataType:  null        // 'xml', 'script', or 'json' (expected server response type) 
             //clearForm: true,        // clear all form fields after successful submit 
             //resetForm: true,        // reset the form after successful submit 
             error: function (XMLHttpRequest, textStatus, errorThrown) {
                 alert("An error has occurred while generating your report, please try again later.\nThe error was: " + errorThrown);
                 $('#ajax-loader').hide();
                 $('#report-submit').show();
             }

         };

         // bind form using 'ajaxForm' 
         $('#report-builder').ajaxForm(options);

         $("#report-builder").validate({
             errorLabelContainer: "#make-a-selection",
             rules: {
                 "Page[]": "required"
             },
             messages: {
                 "Page[]": "Please choose at least one report to include."
             }
         });
         $('li.report-node-1 > div > input[type=checkbox]').click(function () {
             if (!$(this).is(':checked')) {
                 $('input[type=checkbox][name=Page\[\]]', $(this).parents('.report-node-1')).attr('checked', false);
             }
         });
     });

</script>

</head>

<body>

                 <div class="page-content">
                     <div id="report-bulder">
                         <div id="make-a-selection" style="display:none;">
                         </div>

                <form name="Report_Builder" action="stjreport/mergepdf_a.asp" method="post" id="report-builder">
                    <input type="hidden" name="dowhat" value="merge" />
                    <ul class="report-tree">
                        <li class="report-node-1">
                            <div class="section-node">
                                <span class="section-name dark-green">
                                <input type="hidden" class="hidden" name="PageSec[]" value="1" id="page-1" />
                                    Letter from Daniel  J. Starks
                                <span class="arrow-1"></span>
                                </span>
                                <span class="select-links">
                                    <a href="#select-section" class="select-sec">Select Section</a> | <a href="#clear-section" class="clear-sec" >Clear Section</a>
                                </span>
                            </div>
                            <div class="inner-pages">
                                <ul class="report-subpages">
                                    <li><div class="subpage-node">
                                        <input type="checkbox" class="checkbox" name="Page[]" value="letter-to-our-shareholder.pdf" id="letter-1" />
                                        <label for="letter-1" class="label-1">Letter from Daniel  J. Starks</label>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        <li class="report-node-1">
                            <div class="section-node">
                                <span class="section-name light-green">
                                    <input type="hidden" class="hidden" name="PageSec[]" value="1" id="Hidden1" />Embrace the Future<span class="arrow-2"></span></span>
                                        <span class="select-links"><a href="#select-section" class="select-sec">Select Section</a> | <a class="clear-sec" href="#clear-section">Clear Section</a>
                                        </span>
                            </div>
                            <div class="inner-pages">
                                <ul class="report-subpages">
                                    <li>
                                        <div class="subpage-node"><input type="checkbox" class="checkbox" name="Page[]" value="Infinity-Full-Annual-Report-2.pdf" id="embrace-1" />
                                            <label for="embrace-1" class="label-2">Products</label>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="subpage-node"><input type="checkbox" class="checkbox" name="Page[]" value="Infinity-Full-Annual-Report-3.pdf" id="embrace-2" />
                                            <label for="embrace-2" class="label-2">Service</label>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="subpage-node">
                                            <input type="checkbox" class="checkbox" name="Page[]" value="Infinity-Full-Annual-Report-4.pdf" id="embrace-3" />
                                            <label for="embrace-3" class="label-2">Technology</label>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="subpage-node">
                                            <input type="checkbox" class="checkbox" name="Page[]" value="Infinity-Full-Annual-Report-5.pdf" id="embracee-4" />
                                            <label for="embrace-4" class="label-2">Marketing</label>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        <li class="report-node-1"><div class="section-node"><span class="section-name purple">
                            <input type="hidden" class="hidden" name="PageSec[]" value="10" id="page-10" />Case Study<span class="arrow-3"></span></span>
                            <span class="select-links"><a href="#select-section" class="select-sec">Select Section</a> | <a class="clear-sec" href="#clear-section">Clear Section</a></span></div>
                            <div class="inner-pages">
                                <ul class="report-subpages">
                                    <li>
                                        <div class="subpage-node"><input type="checkbox" class="checkbox" name="Page[]" value="Infinity-Full-Annual-Report-6.pdf" id="case-1" />
                                            <label for="case-1" class="label-3">Florida Case Study</label></div>
                                    </li>
                                    <li>
                                        <div class="subpage-node"><input type="checkbox" class="checkbox" name="Page[]" value="Infinity-Full-Annual-Report-7.pdf" id="case-2" />
                                            <label for="case-2" class="label-3">California Case Study</label>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        <li class="report-node-1"><div class="section-node">
                            <span class="section-name red"><input type="hidden" class="hidden" name="PageSec[]" value="11" id="page-11" />Corporate Social Responsibility<span class="arrow-4"></span>
                            </span>
                            <span class="select-links"><a href="#select-section" class="select-sec">Select Section</a> | <a class="clear-sec" href="#clear-section">Clear Section</a></span></div>
                            <div class="inner-pages">
                                <ul class="report-subpages">
                                    <li>
                                        <div class="subpage-node"><input type="checkbox" class="checkbox" name="Page[]" value="Infinity-Full-Annual-Report-11.pdf" id="social-1" />
                                             <label for="social-1" class="label-4">Corporate Social Responsibility</label>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        <li class="report-node-1">
                            <div class="section-node"><span class="section-name yellow"><input type="hidden" class="hidden" name="PageSec[]" value="12" id="page-12" />Corporate Information <span class="arrow-5"></span></span><span class="select-links"><a href="#select-section" class="select-sec">Select Section</a> | <a class="clear-sec" href="#clear-section">Clear Section</a></span></div>
                            <div class="inner-pages">
                                <ul class="report-subpages">
                                    <li>
                                        <div class="subpage-node"><input type="checkbox" class="checkbox" name="Page[]" value="Infinity-Full-Annual-Report-12.pdf" id="corporate-information-1" /> 
                                            <label for="corporate-information-1" class="label-5">Corporate Information</label>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        <li class="report-node-1"><div class="section-node">
                            <span class="section-name purple"><input type="hidden" class="hidden" name="PageSec[]" value="13" id="page-13" />Financial Highlights<span class="arrow-3"></span></span><span class="select-links"><a href="#select-section" class="select-sec">Select Section</a> | <a class="clear-sec" href="#clear-section">Clear Section</a></span></div>
                            <div class="inner-pages">
                                <ul class="report-subpages">
                                    <li>
                                        <div class="subpage-node"><input type="checkbox" class="checkbox" name="Page[]" value="Infinity-Full-Annual-Report-13.pdf" id="financial-1" /> 
                                            <label for="financial-1" class="label-3">Financial Highlights</label>
                                        </div> 
                                    </li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                    <div class="check-controls">
                         <div class="controls-holder">
                             <a href="#select-all" class="check-all" id="select-all">Select all</a> | <a href="#clear-all" class="check-all" id="clear-all">Clear all</a>
                         </div>
                     </div><!-- end .check-controls -->
                    <div class="builder-buttons">
                        <div>
                            <input type="image" name="Submit" class="button" id="report-submit" src="img/builder-btn.png" />
                            <div id="ajax-loader"  style="display:none;margin-top:8px; text-align:right;"><img src="img/ajax-loader.gif" /></div>
                            <div id="download-restart" style="display:none;">
                                <div class="button-block">
                                    <!--a id="download-report-link" target="_blank" href="#"><img src="../i/download_button.gif" alt="Download Report" width="120" height="24" border="0" /></a-->
                                    <a id="download-report-link" target="_blank" href="#" style="font-weight: bold;font-size:14px;margin:15px 0 15px 0;"></a>
                                </div><!-- end .button-block-->
                                <div class="button-block">
                                    <!--a id="restart-link" href=""><img src="../i/new_report_button.gif" alt="Start New Report" width="120" height="24" border="0" /></a-->
                                </div><!-- end .button-block-->
                            </div><!-- end #download-restart -->
                        </div>
                    </div><!-- end #bulder-builder -->
                </form><!-- end #report-builder -->
                     </div><!-- end #report builder -->
                 </div><!-- end .page-content-->
             </div><!-- end #contright -->
         </div><!--end .wrapper .floatwrapper-->
     </div><!--end .buildreportmain-->

**When the form is submitted I call the following server side scripts. This is the code the does all the back end processing in the order that they are called**

    **mergepdf_a.pdf**
    <!--#include file="_mergepdf.asp"-->/stjreport/temp/<%=fileName %>.pdf

    **_mergepdf.asp**
    <%
        Response.Buffer = True
        Response.ExpiresAbsolute = Now() - 1
        Response.Expires = 0
        Response.CacheControl = "no-cache"
    %>
    <!--#include file="includes/includes.inc"-->
    <%
        set fso = server.CreateObject("Scripting.FileSystemObject")
        Set NVmerge = CreateObject("Neevia.PDFmerge")

        action = LCase(trim(request("dowhat")))  
        cleanitup(300)

        select case action
            case "merge"
                inPath = ""

                ' more efficient loop?
                For Each item In Request.Form("Page[]")
                    if fso.fileExists(pdf_path &"/"& trim(item)) then inPath = inPath & pdf_path & "/" & trim(item) & "+"
                Next

    '            for m=1 to 50
    '                for n=1 to 50
    '                    if len(trim(request("chb_"&m&"_"&n))) > 0 then  
    '                        if fso.fileExists(pdf_path &"/"& trim(request("chb_"&m&"_"&n))) then inPath = inPath & pdf_path & "/" & trim(request("chb_"&m&"_"&n)) & "+"
    '                    end if
    '                next
    '            next
                if len(trim(inPath)) > 0 then 
                    inPath = left(inPath,len(inPath)-1)
                    fileName = replace(replace(replace(now(),"/",""),":","")," ","")
                    fileName = fileName & makeRandomString(2)
                    outPath = tmp_Path & "/" & fileName & ".pdf"
                    success = NVMerge.MergePDF(inPath,outPath)
    'response.write "inpath: " & inpath & "<br>"
    'response.write "outpath: " & outpath & "<br>"               
    'response.write "s: " & success & "<br>"
    'response.flush               
                end if
        end select
    %>

    **includes.inc**

    <%
        thisPage = Request.ServerVariables("SCRIPT_NAME")
        thisPage = Right(thisPageName,Len(thisPage) - InStrRev(thisPage,"/"))

        session.timeout = 5
        webDir = "/stjreport"
        pdf_path = server.MapPath("/") & webDir & "/pdfs"
        tmp_path = server.MapPath("/") & webDir & "/temp"

        Function RoundUp(n)
            roundUp = Int(n) - CBool(CDbl(n) <> CLng(n))
        End Function

        Sub cleanItUp(tt) 
            set incFS = server.createobject("scripting.FileSystemObject")
            set incFO = incFS.GetFolder(tmp_path)
            for each incF in incFO.files
                'if instr(1,incF.name,".pdf",1) > 0 then
                    set tmpF = incFS.GetFile(incF)
                    if DateDiff("s",tmpF.DateCreated,now) > tt then incFS.deleteFile(tmpF)
                'end if
            next
            set incFO = nothing
            set incFS = nothing
        End Sub

        Function makeRandomString(incLength)
            makeRandomString = ""
            seedStr = "1,N,O,P,Q,3,W,X,Y,Z,$,4,0,A,B,C,D,E,F,8,G,H,I,J,5,6,7,9,K,L,M,R,2,S,U,V,T,"
            rndAry = Split(seedStr,",")
            rndName = ""    
            For inc = 1 to incLength
                Randomize
                iRandom = Int( UBound( rndAry ) * Rnd )
                rndName = rndName & rndAry( iRandom )
            next
            makeRandomString = rndName
        End Function    

        Sub displayMessage  (incMsg,incReturnUrl)
            if Len(incMsg) > 0 then
                Response.write("<br /><br /><p style='text-align:center; font-family:arial; font_size:larger;'>" & incMsg & "</p>")
    %>
    <script language="javascript">
                alert("<%=Replace(Replace(incMsg,"<br />","\n"),"<br>","\n")%>");
    <%
                if Len(incReturnUrl) > 0 then
    %>                      
                    top.location.href = "<%=incReturnUrl%>";
    <%
                else
    %>
                    top.history.go(-1);
    <%
                end if
    %>                                                  
    </script>
    <%
                Response.end()
            end if                      
        End Sub             

        Function isPermittedFile(incFileType,incFile)   
            incFile = replace(incFile, "\", "/")
            if inStr(incFile,"/") > 0 then
                incAry = split(incFile,"/")
                incFile = incAry(uBound(incFile)-1)
            end if
            if inStr(incFile,".") = 0 then call (displayMessage("Image file: " & incFile & " sounds not to be a recognized image format",""))
            incFileAry = split(incFile,".")
            incExt = incFileAry(1)

            Select Case LCase(incFileType)
                Case "image"
                    incAllowedStr = ",gif,png,jpg,jpeg,bmp,tiff,"
                Case "document"
                    'incAllowedStr = ",pdf,doc,docx,txt,rtf,doc,docx,xls,xlsx,"
                    incAllowedStr = ",pdf,"
            End Select
            isPermittedFile = False
            if inStr(1,incAllowedStr,","& LCase(incExt) &",",1) > 0 then isPermittedFile = True
        End Function

    %>

Again it works locally but for some reason it breaks on the live server. Any help would be great. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T07:20:10.827

*Microsoft VBScript 运行时错误“800a004c”找不到路径/build-your-own-report/stjreport/includes/includes.inc，第 16 行*

你是如何链接到你的文件的？您是否启用了父路径以允许跨文件夹的链接。无论哪种方式，在经典 ASP 中包含的文件都不应以斜杠 (/) 开头。

对于同一文件夹中的链接，请使用“build-your-own-report/etc...”或出入另一个文件夹，如“../build-your-own-report/etc”

# c# - 如何转换 xml 文档并插入附加数据？

> ID：16202418
> 
> 赞同：0
> 
> 时间：2013-04-24T21:20:31.743
> 
> 标签：c#, asp.net, xml, xslt

我有一个这种格式的 xml 文档：

```
<?xml version="1.0" encoding="UTF-8"?>
<person name="Bob" addr_street="123 Fake St" 
        addr_city="Springfield" addr_state="IL"/> 
```

我想获取这些数据并通过`FigureOutZipCode(string city, string state)`我的代码中的函数运行它。

然后，我想获取所有这些组合数据并以这种格式创建一个新文档：

```
<?xml version="1.0" encoding="UTF-8"?>
<people>
    <person>
        <name>Bob</name>
        <address>
            <street>123 Fake St</address>
            <city>Springfield</city>
            <state>IL</state>
            <zip>00000</zip>
        </address>
    </person>
</people> 
```

我知道我可以解析输入 xml 中的所有数据，进行计算，然后创建一个新的输出 xml，但是有没有更简洁/更好的方法来做到这一点？也许像使用 xslt 之类的东西？

如果是这样，您能否就如何做到这一点提供一些指导？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:40:51.507

实际上，如果您使用 XSLT`result-document`指令，您可以使用 XSLT 转换原始 XML 并使用相同的 XSLT 工作表输出新的（转换后的）XML 文件。这需要 Saxon .NET XSLT 解析器，可在此处获得：[http ://saxon.sourceforge.net/](http://saxon.sourceforge.net/)

`result-document`在此处使用的信息：http: [//saxonica.com/documentation9.4-demo/html/xsl-elements/result-document.html](http://saxonica.com/documentation9.4-demo/html/xsl-elements/result-document.html)

对于学习 XSLT，我推荐 Michael Kay（创建 Saxon）的任何东西，例如：[http ://www.amazon.com/XSLT-Programmers-Reference-Michael-Kay/dp/1861003129](https://rads.stackoverflow.com/amzn/click/com/1861003129)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T01:46:33.237

以下是使用 XSLT 执行此操作的方法：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:custom="custom-functions">
  <xsl:output method="xml" indent="yes"/>

  <xsl:template match="/person">
    <people>
      <xsl:copy>
        <name>
          <xsl:value-of select="@name"/>
        </name>
        <address>
          <street>
            <xsl:value-of select="@addr_street"/>
          </street>
          <city>
            <xsl:value-of select="@addr_city"/>
          </city>
          <state>
            <xsl:value-of select="@addr_state"/>
          </state>
          <zip>
            <xsl:value-of
              select="custom:figureOutZipCode(@addr_city, @addr_state)"/>
          </zip>
        </address>
      </xsl:copy>
    </people>
  </xsl:template>
</xsl:stylesheet> 
```

在 .NET 中，调用该`figureOutZipCode()`函数通常需要将 XSLT 扩展对象传递给 XSLT 处理器，这[在此处](http://msdn.microsoft.com/en-us/library/system.xml.xsl.xsltargumentlist.addextensionobject.aspx)进行了说明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:36:46.157

使用 LINQ 将您的 XML 转换为新格式

```
string URL = @"location";
XDocument doc = XDocument.Load(URL);

XElement newDoc = new XElement("people",
            from p in doc.Descendants("person")
            select new XElement("person", 
                new XElement("name", p.Attribute("name").Value),
                new XElement("address",
                    new XElement("street", p.Attribute("addr_street").Value),
                    new XElement("city", p.Attribute("addr_city").Value),
                    new XElement("state", p.Attribute("addr_state").Value),
                    new XElement("zip", GetZip(parameters))
                    )
            )
            ); 
```

# ios - iOS 对话框不工作

> ID：16202419
> 
> 赞同：-1
> 
> 时间：2013-04-24T21:20:37.323
> 
> 标签：ios, objective-c, mobile, alert

我正在尝试在我的 iOS 应用程序中创建一个对话框（应用程序是 PhoneGap 应用程序）。

我正在使用这篇文章中的代码：[如何在 iOS 中实现弹出对话框](https://stackoverflow.com/questions/4988564/how-to-implement-a-pop-up-dialog-box-in-ios)

以下是链接中的代码

```
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"No network connection" 
                                                message:@"You must be connected to the internet to use this app."
                                               delegate:nil 
                                      cancelButtonTitle:@"OK"
                                      otherButtonTitles:nil];
[alert show]; 
```

我已将此代码放入`AppDelegate.m`方法中

`- (BOOL)application:(UIApplication)...`

应用程序运行但对话框不显示。

问题是什么？

* * *

我已经更新了代码如下

下面的代码在我的 appdelegate.m 中

```
//reachability code

if (networkStatus == ReachableViaWifi)
{
    while (true)
        //show progress bar
}
else
{
    UIAlertView *alert=[[UIAlertView alloc]initWithTitle:@"title" message:@"message" delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:@"cancel", nil];
    [alert show];
} 
```

警告框未显示。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T22:21:32.123

如果你一切都做对了，你可以在 AppDelegate 中显示 UIAlertView，**但是你不能使用`exit()`方法退出应用程序，在 iOS 中自己退出应用程序是不正确的做法**。基本上你的 AppDelegate 正在实现[UIApplicationDelegate](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIApplicationDelegate_Protocol/Reference/Reference.html)协议，这个协议有很多方法。

尝试在 AppDelegate 中以不同的方法显示您的 AlertView。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {

    UIAlertView *alert=[[UIAlertView alloc]initWithTitle:@"title" message:@"message" delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:@"cancel", nil];
    [alert show];

    // other code... 
} 
```

或在

```
- (void)applicationDidBecomeActive:(UIApplication *)application {

   UIAlertView *alert=[[UIAlertView alloc]initWithTitle:@"title" message:@"message" delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:@"cancel", nil];
    [alert show];
} 
```

同样，您可以根据问题中提到的可达性的状态更改相应地显示警报视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:49:09.497

我想那是因为你的代码在 line 之上`[self.window makeKeyAndVisible];`。

尝试在该行之后移动您的代码以获取警报。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:51:23.887

您应该将代码添加到 MainViewController.m（或其他 UIViewController .m 文件）中，并根据您希望将代码添加到的行为`-(void)viewDidLoad`或`-(void)viewDidAppear`方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T22:00:37.727

对于 iOS 警报对话框，在您的 AppDelegate.m

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"No network connection" 
                                          message:@"You must be connected to the internet to use this app."
                                          delegate:nil 
                                          cancelButtonTitle:@"OK"
                                          otherButtonTitles:nil];
[alert show];
self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
self.window.rootViewController = [[ViewController alloc] initWithNibName:@"ViewController_iPhone" bundle:nil];
[self.window makeKeyAndVisible];
return YES;
} 
```

既然您提到您正在使用 phonegap，他们将在不同平台上为您处理警报框。您将在您的页面 html 中使用以下代码

```
function showAlert() {
    navigator.notification.alert(
        'You must be connected to the internet to use this app.',
        null,       
        'No network connection',            
        'OK'                  
    );
} 
```

# javascript - Passport-github js，用户代理错误

> ID：16202421
> 
> 赞同：1
> 
> 时间：2013-04-24T21:20:45.190
> 
> 标签：javascript, node.js, github, oauth, passport.js

**昨天我可以通过Passport.js**和**Passport-github**模块成功登录我的应用程序，今天我收到这样的错误：

`500 failed to fetch user profile (status: 403 data: {"message":"Missing or invalid User Agent string. See http://developer.github.com/v3/#user-agent-required"})`

那么其他人得到它吗？

gihub oauth 政策有变化吗？

**我们是否需要在passport-github / node-oauth**模块上为此做出贡献？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T22:27:03.897

只需将用户代理添加到您的策略中：

```
new GitHubStrategy({
        clientID: <githubClientID>,
        clientSecret: <githubClientSecret>,
        callbackURL: <callback>,
        customHeaders: {"User-Agent" : <your agent string>}
      },
      findOrCreateUserByOAuth
    ) 
```

自 4 月 24 日起，[用户代理现在是强制性](http://developer.github.com/changes/2013-04-24-user-agent-required/)的。

# scala - 如何添加 'Array[Ordered[Any]]' 作为方法参数

> ID：16202426
> 
> 赞同：1
> 
> 时间：2013-04-24T21:21:04.953
> 
> 标签：scala

下面是一个用 Scala 编写的选择排序的实现。

ss.sort(arr) 行导致此错误：类型不匹配；找到：需要数组 [字符串]：数组 [Ordered[Any]]

由于 Ordered 类型是由 StringOps 继承的，不应该推断出这种类型吗？如何将字符串数组添加到 sort() 方法？

这是完整的代码：

```
object SelectionSortTest {

  def main(args: Array[String]){

    val arr = Array("Hello","World")

    val ss = new SelectionSort()
    ss.sort(arr)
  }

}

class SelectionSort {

  def sort(a : Array[Ordered[Any]]) = {
    var N = a.length

    for (i <- 0 until N) {
        var min = i

        for(j <- i + 1 until N){
            if( less(a(j) , a(min))){
              min = j
            }
        exchange(a , i , min)
        }
    }

  }

  def less(v : Ordered[Any] , w : Ordered[Any]) = {
    v.compareTo(w) < 0
  }

  def exchange(a : Array[Ordered[Any]] , i : Integer , j : Integer) = {
    var swap : Ordered[Any] = a(i)
    a(i) = a(j)
    a(j) = swap
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:57:16.233

数组是不变的。即使是 的子类型，您也不能将其`Array[A]`用作。看看这里为什么：[为什么数组是不变的，但列表是协变的？](https://stackoverflow.com/questions/6684493/why-are-arrays-invariant-but-lists-covariant)`Array[B]``A``B`

也不是`Ordered`，因此您的 less 实现也将不起作用。

您应该通过以下方式使您的实现通用：

```
object SelectionSortTest {

  def main(args: Array[String]){

    val arr = Array("Hello","World")

    val ss = new SelectionSort()
    ss.sort(arr)
  }

}

class SelectionSort {

  def sort[T <% Ordered[T]](a : Array[T]) = {
    var N = a.length

    for (i <- 0 until N) {
        var min = i

        for(j <- i + 1 until N){
            if(a(j) < a(min)){ // call less directly on Ordered[T]
              min = j
            }
        exchange(a , i , min)
        }
    }

  }

  def exchange[T](a : Array[T] , i : Integer , j : Integer) = {
    var swap = a(i)
    a(i) = a(j)
    a(j) = swap
  }
} 
```

有点奇怪的说法`T <% Ordered[T]`意味着“任何`T`可以隐式转换为`Ordered[T]`”的类型。这确保您仍然可以使用小于运算符。

有关详细信息，请参阅： [什么是 Scala 上下文和视图边界？](https://stackoverflow.com/questions/4465948/what-are-scala-context-and-view-bounds)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T23:14:34.247

@gzm0 的答案（带有一些非常好的链接）建议`Ordered`。我将补充一个答案覆盖`Ordering`，它提供了等效的功能，而不会对你的类施加太多影响。

`Ordering`让我们调整 sort 方法以接受定义了隐式实例的“T”类型数组。

```
def sort[T : Ordering](a: Array[T]) = {
  val ord = implicitly[Ordering[T]]
  import ord._ // now comparison operations such as '<' are available for 'T'
  // ...
  if (a(j) < a(min))
  // ...
} 
```

`[T : Ordering]`and`implicitly[Ordering[T]]`组合等价于 type 的隐式参数`Ordering[T]`：

```
def sort[T](a: Array[T])(implicit ord: Ordering[T]) = {
  import ord._
  // ...
} 
```

为什么这很有用？`case class Account(balance: Int)`想象一下，某个第三方为您提供了一个。您现在可以`Ordering`像这样为它添加一个：

```
// somewhere in scope
implicit val accountOrdering = new Ordering[Account] {
  def compare(x: Account, y: Account) = x.balance - y.balance
}

// or, more simply
implicit val accountOrdering: Ordering[Account] = Ordering by (_.balance) 
```

只要该实例在范围内，您就应该能够使用`sort(accounts)`.
如果你想使用一些不同的排序，你也可以明确地提供它，像这样：`sort(accounts)(otherOrdering)`.

请注意，这与提供隐式转换没有太大区别`Ordering`（至少不在这个问题的上下文中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-27T21:52:57.320

尽管在编写 Scala 时，我习惯于更喜欢函数式编程风格（通过组合器或递归）而不是命令式编程风格（通过变量和迭代），这一次，对于这个特定问题，老式的命令式嵌套循环导致更简单和高效代码。

对于某些类型的问题，我不认为回到命令式风格是错误的，例如排序算法通常会转换输入缓冲区（更像是一个过程），而不是产生一个新的排序集合。

这是我的解决方案：

```
package bitspoke.algo

import scala.math.Ordered
import scala.collection.mutable.Buffer

abstract class Sorter[T <% Ordered[T]] {

  // algorithm provided by subclasses
  def sort(buffer : Buffer[T]) : Unit

  // check if the buffer is sorted
  def sorted(buffer : Buffer[T]) = buffer.isEmpty || buffer.view.zip(buffer.tail).forall { t => t._2 > t._1 }

  // swap elements in buffer
  def swap(buffer : Buffer[T], i:Int, j:Int) {
    val temp = buffer(i)
    buffer(i) = buffer(j)
    buffer(j) = temp
  }
}

class SelectionSorter[T <% Ordered[T]] extends Sorter[T] {
  def sort(buffer : Buffer[T]) : Unit = {
    for (i <- 0 until buffer.length) {
      var min = i
      for (j <- i until buffer.length) {
        if (buffer(j) < buffer(min))
          min = j
       }
       swap(buffer, i, min)
     }
  }
} 
```

如您所见，为了实现参数多态，`java.lang.Comparable`我更喜欢使用`scala.math.Ordered`Scala View Bounds 而不是 Upper Bounds。由于原始类型到 Rich Wrappers 的 Scala 隐式转换，这肯定是有效的。

您可以编写一个客户端程序，如下所示：

```
import bitspoke.algo._
import scala.collection.mutable._

val sorter = new SelectionSorter[Int]
val buffer = ArrayBuffer(3, 0, 4, 2, 1)
sorter.sort(buffer)

assert(sorter.sorted(buffer)) 
```

# http - 是否可以让 Safari 对第一个文档使用 HTTP 条件获取？

> ID：16202435
> 
> 赞同：2
> 
> 时间：2013-04-24T21:21:46.170
> 
> 标签：http, http-headers, safari, etag

我正在尝试将 HTTP 条件获取功能添加到移动网站的首页。但是，我所看到的让我认为 Safari 根本不支持它加载的第一个文档的 HTTP 条件获取。

我通过制作一个新的 Rails 3.2.13 应用程序对此进行了测试，其中一个操作如下所示：

```
def index
  last_modified = Date.today
  etag_obj = "something something"
  fresh_when last_modified: last_modified, etag: etag_obj, public: false
end 
```

正如预期的那样，请求标头同时包含 Etag 和 Last-Modified：

```
[cache_test]$ curl -I http://localhost:5000/test
HTTP/1.1 200 OK 
Etag: "79b547467286b3e20fad13f73fc1bf78"
Last-Modified: Wed, 24 Apr 2013 00:00:00 GMT
Content-Type: text/html; charset=utf-8
Cache-Control: max-age=0, private, must-revalidate
X-Ua-Compatible: IE=Edge
X-Request-Id: 8ace0b71533b2bc036bd84b12289cda6
X-Runtime: 0.012269
Server: WEBrick/1.3.1 (Ruby/1.9.3/2012-04-20)
Date: Wed, 24 Apr 2013 21:06:49 GMT
Content-Length: 0
Connection: Keep-Alive
Set-Cookie: _cache_test_session=BAh7B0kiD3Nlc3Npb25faWQGOgZFRkkiJTM0NWRjNDgyZGQwNWJmMGZkNmIzNmY4NjVmNWEzMDkwBjsAVEkiEF9jc3JmX3Rva2VuBjsARkkiMTlYK0VrMERGdEsvOVlzbVJ5N1FPQlZXVDRwak9zQ3QzS3ZXZ1pvbnJocjg9BjsARg%3D%3D--0902ae8a505527bd49d969753ddf1d2bd4c716eb; path=/; HttpOnly 
```

在 Firefox 20.0 和 Chrome 26.0.1410.65 上，这就像我预期的那样：在第二次加载时，浏览器在请求中发送 If-Modified-Since 和 If-None-Match，并收到 304 Not Modified。

但是，它并没有在 Safari 上执行此操作。在 Safari 上，它既不发送 If-Modified-Since 也不发送 If-None-Match，并且如您所料，它随后从服务器完全重新加载页面。我在我的 MacBook Pro 上的 Safari 6.0.3、使用 iOS 6.1 的 iPhone 的 iOS 模拟器中的 Safari 以及使用 iOS 6.1.3 的 iPad Mini 上看到了这一点。

真正奇怪的是，Safari 显然支持后续请求（CSS、JS、图像等）的条件获取——在主 HTML 页面通过后，我可以清楚地看到它们。但我一生无法弄清楚如何让 Safari 为第一个文档发出条件获取请求。

所以，我想我的问题是两个部分：

1.  我错过了一些明显的东西吗？因为 Safari 设计的这种行为实际上看起来有点疯狂。但也许我在这里对苹果的期望太高了。

2.  如果我没有遗漏一些明显的东西，有人知道任何解决方法吗？

# python - 如何在不更改python中子列表顺序的情况下合并列表列表？

> ID：16202436
> 
> 赞同：0
> 
> 时间：2013-04-24T21:21:46.347
> 
> 标签：python, list, merge

例如合并列表列表

```
list_of_lists = [['NA','NA','NA','0,678'], ['0.327','NA','NA','NA'], ...] 
```

我想

```
merged = ['0.327','NA','NA','0,678'] 
```

请评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:24:07.960

使用带有嵌套生成器表达式的列表推导来选择第一个非`NA`元素，以及`zip()`：

```
merged = [next((el for el in elements if el != 'NA'), 'NA') for elements in zip(*list_of_lists)] 
```

演示：

```
>>> list_of_lists = [['NA','NA','NA','0,678'], ['0.327','NA','NA','NA']]
>>> [next((el for el in elements if el != 'NA'), 'NA') for elements in zip(*list_of_lists)]
['0.327', 'NA', 'NA', '0,678'] 
```

`next((...), default)`调用表达式将选择第一个*不*等于 的元素，如果不存在这样的元素则`'NA'`回退。`'NA'`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T06:00:28.383

```
>>> list_of_lists = [['NA','NA','NA','0,678'], ['0.327','NA','NA','NA']]
>>> from itertools import ifilter # Py3k doesn't need import, use filter built-in
>>> [next(ifilter('NA'.__ne__, col), 'NA') for col in zip(*list_of_lists)]
['0.327', 'NA', 'NA', '0,678'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:30:30.550

假设两个列表在同一位置没有值（如 Martijn Pieters 所建议），那么您可以使用：

```
for i in range(len(l1)): 
    l1[i] = l2[i] if l1[i] == 'NA' and l2[i] != 'NA' else l1[i] 
```

希望这可以帮助！

# java - 在没有 main 的 Eclipse 中运行 Java 代码

> ID：16202449
> 
> 赞同：-1
> 
> 时间：2013-04-24T21:22:37.080
> 
> 标签：java, eclipse, class, main

我有一个没有 main 方法的 Java 项目（在 Eclipse 中运行），需要调试并查看哪个是调用者类和程序的流程。我该如何开始？

这是一个简单的项目，不包含任何 web/tomcat 相关数据。

* * *

谢谢你的回复。我是 StackOverflow 的新手，所以请原谅我的写作和提问。

我包括包并尝试创建一个类的对象，但它不识别这些类。所有的课程都是公开的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T21:24:13.213

如果不从 public static void main 开始，就无法运行 Java SE 应用程序。如果要调试库或框架的代码，则需要创建一个 main 方法并从那里调用代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T21:39:12.610

看看[JUnit](http://www.mkyong.com/tutorials/junit-tutorials/)。如果你只是想调试你的代码是你通常必须做的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T21:27:38.007

由于 Java 要求所有方法和变量都在类中，因此 JVM 需要一个在初始化任何对象之前就存在的起点。因此，main 必须是静态且公共的，以便 JVM 找到它。与 C++ 不同，main 方法不返回状态码，因此它的返回类型为 void 而不是 int。

# java - Java：如何坚持 Weka 朴素贝叶斯分类器？

> ID：16202451
> 
> 赞同：2
> 
> 时间：2013-04-24T21:22:40.590
> 
> 标签：java, persistence, classification, weka

将 Weka Naive Bayes Classifier 训练到文件后有什么方法可以坚持吗？我有 5000 万条记录的数据集，训练分类器需要很多小时。我想将训练有素的分类器保存到一个文件中，然后在不同的测试集上使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-27T21:17:35.247

训练完成后，您可以右键单击左下角结果列表中出现的结果，然后单击保存模型。您可以稍后加载该模型以将其应用于不同的测试集。

# android - 在 IntelliJ 中重建期间未处理注释

> ID：16202453
> 
> 赞同：2
> 
> 时间：2013-04-24T21:22:50.987
> 
> 标签：android, intellij-idea, annotations

我遇到了与其他问题完全相反的问题（[在 Intellij IDEA 12 中运行注释的命令](https://stackoverflow.com/questions/14196732/command-to-run-annotations-in-intellij-idea-12)）。

在我的配置中，使用 Android 注释，每次我重建项目时，它都不会处理注释并报告假定生成的以“_”结尾的类不存在。

但是当我运行项目时，它会按预期处理注释。

如何获得“重建”来处理注释？

# c - 如何刷新用 stdio 函数编写的输出？

> ID：16202457
> 
> 赞同：1
> 
> 时间：2013-04-24T21:23:05.107
> 
> 标签：c

我有一个父进程和一个子进程（子进程是使用 fork 创建的），在父进程中定义了这段代码：

```
FILE* pfile = fopen("log.txt","w");

while (1) { 
    serve child requests
    fprintf (pfile,"some data\n");
}

fclose (pfile); 
```

问题是代码的最后一行永远不会被执行，因为无限的while循环不会终止（程序应该这样做）..所以文件永远不会被关闭并且连续写入的数据不会被保存到文件中。

我怎么解决这个问题 ？

任何帮助将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T21:25:15.140

缓冲区满时保存数据。同时，您还可以强制文件提交[`fflush()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/fflush.html)- 当应用程序或 while 循环终止时，文件本身将物理关闭。

```
FILE* pfile = fopen("log.txt","w");

while (1) 
{ 
    serve child requests
    fprintf (pfile,"some data\n");
    fflush(pfile);
}

fclose (pfile); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T21:26:31.060

您可以`fflush`在循环内部使用来强制回写文件。

# php - php 和 dompdf - 如何在不让我的服务器突然停止的情况下生成一个大的 pdf

> ID：16202461
> 
> 赞同：4
> 
> 时间：2013-04-24T21:23:14.863
> 
> 标签：php, pdf-generation, dompdf

我正在尝试使用 dompdf 将较大的 html 表呈现为 pdf。有最小的 css 样式，但表中可能有 200 - 300 行。每行有 4 个带有基本文本的 td。

我可以毫无问题地生成一个较小表的 pdf，但较大的表会耗尽内存限制并且脚本将终止。解决这个问题的最佳方法是什么？我开始讨论 serverfault，一位用户建议生成一个新进程，以免耗尽 php / apache 的内存限制？这是最好的方法吗？这让我产生了关于它如何工作的问题，因为 dompdf 当前将下载流式传输到浏览器，但我假设如果我创建一个新进程来生成报告，我不能再将输出发送到浏览器用户下载？

感谢任何可能提出解决此问题的好方法的人！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T22:31:35.040

如果您使用辅助 PHP 进程（例如使用`exec()`）呈现您的 HTML，则执行时间和内存限制会得到缓解。以这种方法渲染时，您将渲染的 PDF 保存到网站上的目录中，并将用户重定向到下载（如果您想运行渲染队列，甚至可以通过电子邮件向他们发送链接）。一般来说，我发现这种方法确实在速度和内存使用方面提供了适度的改进。

但是，这并不意味着渲染在您的情况下会执行得更快。目前使用 dompdf 渲染表是资源密集型的。如果可以的话，可能会更好的方法是将文档分成几部分，分别渲染每个部分（再次使用辅助 PHP 进程），将生成的 PDF 集合合并到一个文件中（使用类似 pdftk 的东西），然后将 PDF 保存在用户可以访问的地方。我已经看到使用这种方法显着提高了性能。

或者使用 wkhtmltopdf 之类的东西（如果您可以通过 shell 访问您的服务器并且愿意处理安装过程）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T22:17:14.747

我在处理许多不同的生成文件类型时遇到了这个问题，而不仅仅是 PDF。产生过程没有帮助，因为问题在于变量的大小，而且无论过程多么新鲜，变量仍然太大。我的解决方案是创建一个文件并以可管理的块写入它，这样我的变量就不会超过一定的大小。

一个基本的，未经测试的例子：

```
$tmp = fopen($tmpfilepath, 'w');
if(is_resource($tmp)) {
    echo 'Generating file ... ';
    $dompdf = new DOMPDF();
    $counter = 0;
    $html = '';
    while($line = getLineOfYourHtml()) {
        $html .= $line;
        $counter++;
        if($counter%200 == 0) {  //pick a good chunk number here
            $dompdf->load_html($html);
            $dompdf->render();
            $output = $dompdf->output();
            fwrite($tmp, $output);

            echo round($counter/getTotalLines()).'%... ';  //echo percent complete

            $html = '';
        }
    }
    if($html != '') {  //the last chunk
        $dompdf->load_html($html);
        $dompdf->render();
        $output = $dompdf->output();
        fwrite($tmp, $output);
    }
    fclose($tmp);

    if(file_exists($tmpfilepath)) {
        echo '100%. Generation complete. ';
        echo '<a href="'.$tmpfileURL.'">Download</a>';
    } else {
        echo ' Generation failed.';
    }
} else {
    echo 'Could not generate file.';
} 
```

因为生成文件需要一段时间，所以回声一个接一个地出现，让用户可以看到一些东西，所以他们不会认为屏幕已经冻结。最终的回显链接只会在文件生成后出现，这意味着用户会自动等待文件准备好才能下载。您可能必须延长此脚本的最大执行时间。

# ios - 在 MFMailComposeViewController 中显示 pdf 文档

> ID：16202462
> 
> 赞同：0
> 
> 时间：2013-04-24T21:23:23.450
> 
> 标签：ios, objective-c, pdf, mfmailcomposeviewcontroller

我读过帖子说 `MFMailComposeViewController 如果它是 1 页文档，则应该显示您附加的 PDF，但由于某种原因，我的 PDF 总是显示为一个图标。我希望它显示 PDF，因为它只有 1 页。PDF 似乎很好，因为我可以发送电子邮件，并且可以在邮件应用程序或计算机上打开它。

在 iOS 6.0 或更高版本中默认情况下是否未启用此功能，还是缺少某些内容？

```
MFMailComposeViewController* controller = [[MFMailComposeViewController alloc] init];
controller.mailComposeDelegate = self;

// create the message body.
NSMutableString *body = [[NSMutableString alloc] init];

// add the user name to the email body.
[body appendFormat:@"Name: %@", userName];

// add the pdf to the email.
NSData *data = [NSData dataWithContentsOfFile:path];
[controller addAttachmentData:data mimeType:@"application/pdf" 
                                   fileName:@"test.pdf" 
                           includeExtension:YES]];

// add the body string to the email body.
[controller setMessageBody:body isHTML:NO];

// show the email controller.
[self presentViewController:controller animated:YES completion:nil]; 
```

# javascript - HTML 名称属性中的花括号

> ID：16202468
> 
> 赞同：1
> 
> 时间：2013-04-24T21:23:40.233
> 
> 标签：javascript, jquery, html, jquery-selectors, getelementsbyname

我正在尝试根据名称检索 DOM 元素。不幸的是，他们的名字里面有花括号`{}`。

jQuery (1.6.4) 能够毫无问题地检索它们。但此时我试图用 替换这些调用`getElementsByName()`，但 gEBN 不匹配查询字符串中带有大括号的任何内容。我曾尝试过一次又两次将反斜杠转义但无济于事。

有没有办法在不改变使用大括号的约定的情况下做到这一点？

[看起来](http://razzed.com/2009/01/30/valid-characters-in-attribute-names-in-htmlxml/)它们不在名称 attr 中允许的字符集中。

**更新**：似乎适用于 Chrome，但不适用于 Windows 的 Safari。但真正奇怪的是，即使是 Windows 版 Safari 也能很好地处理这些问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:40:51.890

如果您阅读有关[selectors](http://api.jquery.com/category/selectors/)的 jQuery 文档页面，您会看到：

> 要使用任何元字符（例如 !"#$%&'()*+,./:;<=>?@[]^`{|}~ ）作为名称的文字部分，它必须使用两个反斜杠进行转义：`\\`. 例如，id="foo.bar" 的元素可以使用选择器`$("#foo\\.bar")`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:50:59.853

当您做的事情明确超出标准允许的范围时，您应该期待“奇怪”的结果。如果您选择取消预订，那您就只能靠自己了。有些浏览器可以工作，有些则不行。当新版本出现时，曾经工作的那些将在没有警告的情况下中断。

所以这取决于你想要做什么。如果您只是为自己或一个小团队构建一些东西，这可能没问题。如果您正在为普通观众构建一些东西，最好遵守标准并且不要使用不允许的字符。

# jsf - Primefaces cellEditor在ajax提交中传递整个数据表

> ID：16202470
> 
> 赞同：2
> 
> 时间：2013-04-24T21:23:54.847
> 
> 标签：jsf, primefaces, tablecelleditor

我有一个数据表，其中每一行都有 24 小时输入字段。在某一时间点有超过 1000 个可编辑的输入字段。我注意到在 ajax 调用期间使用 p:cellEditor 时，primefaces 正在提交整个数据表。我怎样才能避免这种情况？请在下面找到我拥有的代码，并在其中找到每个重要部分的注释。

```
 <!-- Fires the cellEdit event to trigger the validations to happen as user tabs out of the input box -->
    <p:ajax event="cellEdit" listener="#{renderValidator.onCellEdit}"  update=":#{p:component('globalMessages')}" process="@this" /> 

    <p:column id="hour1" styleClass="col-right col-90">
        <f:facet name="header">
            <h:outputText value="1" escape="false"/>
        </f:facet>
        <p:cellEditor > 

            <f:facet name="output">
            <h:outputText value="#{row.amount[0]}" escape="false">
            <f:convertNumber  maxFractionDigits="3" minFractionDigits="3" maxIntegerDigits="5" />
            </h:outputText>
            </f:facet> 
            <f:facet name="input">
            <p:inputText id="hour1Input" value="#{row.amount[0]}" maxlength="10" size="10"  readonly="#{row.readOnly}" onchange='PowerMeter.setPowerMeterChange()'
            styleClass="col-right" valueChangeListener="#{row.setDirtyFlag(true)}"  >
            <!-- formats data the way its displayed -->
            <f:convertNumber  maxFractionDigits="3" minFractionDigits="3" maxIntegerDigits="5" />
            <!-- validates the input value w.r.t a custom validator -->
            <f:validator validatorId="hourlyValueValidator" for="hour1Input" /> 
            <!-- javascript restricting user to input alpha numeric characters -->
            <pe:keyFilter testFunction="return PowerMeter.isValidMWH(this, c);" />
            </p:inputText>
            </f:facet>          
        </p:cellEditor>
    </p:column> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T04:45:39.883

在 Ajax 请求上，JSF 默认发送表单中所有输入组件的数据。即使在部分生命周期中只执行了 100 个组件中的一个。`partialSubmit`使用 PrimeFaces，您可以通过设置如下来更改此行为`true`：

```
<p:ajax partialSubmit="true" event="cellEdit" process="@this"
    listener="#{renderValidator.onCellEdit}"
    update=":#{p:component('globalMessages')}"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-02T13:51:17.040

Primefaces 使用该`PrimeFaces.ajax.AjaxUtils.send`函数来构建 Ajax 请求。为了确定需要将哪些数据发送到服务器，它使用 jQuery`find`函数，然后使用哪些数据`serializeArray`来构建 POST 请求。

```
componentPostParams = jqProcess.find(':input').serializeArray(); 
```

不幸的是，当启用**liveScroll**属性`<p:DataTable>`并且已经获取了大量数据时，它将处理所有输入控件，无论是否`<p:cellEditor>`只有一个输入方面可见。

![只有一个输入元素可见的数据表](https://i.stack.imgur.com/ZQKmj.png)

`PrimeFaces.ajax.AjaxUtils.send`要更改此功能，我以以下形式 覆盖了功能

```
var pFacesSend = PrimeFaces.ajax.AjaxUtils.send;
PrimeFaces.ajax.AjaxUtils.send = function(cfg) {
    if (myCase) {
        // Custom send
    } else {
        pFacesSend(cfg);
    }
}; 
```

在`myCase`我从这个改变了另外的序列化：

```
componentPostParams = jqProcess.find(':input').serializeArray(); 
```

进入这个：

```
if (!customSerializationCondition) {
    componentPostParams = jqProcess.find(':input').serializeArray();
} else {
    componentPostParams = jqProcess.find(':input').filter(function() {
        return $(this).parent().css('display') !== 'none';
    }).serializeArray();
} 
```

此解决方案构建了一个仅包含可见输入字段的 POST 请求，并且由于我的**editMode**设置为*单元格*，我只有一个`<input>`可见的。它适用于*Primefaces v4.0*，并且只要输入父标签使用 css`display`属性在编辑器中隐藏输入方面，它就应该工作。

# c++ - 将无限无锁缓冲区折叠为循环缓冲区时避免冲突

> ID：16202472
> 
> 赞同：1
> 
> 时间：2013-04-24T21:23:58.703
> 
> 标签：c++, lock-free, circular-buffer

我正在解决[FAST](http://www.fixprotocol.org/fast)协议的两个提要仲裁问题。如果您不熟悉它，请不要担心，我的问题实际上很笼统。但我正在为感兴趣的人添加问题描述（你可以跳过它）。

* * *

所有 UDP 源中的数据都在两个不同的多播 IP 上的两个相同的源（A 和 B）中传播。强烈建议客户端接收并处理这两个提要，因为可能会丢失 UDP 数据包。处理两个相同的提要允许一个在统计上降低丢包的概率。未指定消息首次出现在哪个特定提要（A 或 B）中。要仲裁这些提要，应该使用在 Preamble 或标签 34-MsgSeqNum 中找到的消息序列号。Preamble 的使用允许在不解码 FAST 消息的情况下确定消息序列号。应使用以下算法处理来自提要 A 和 B 的消息：

1.  收听提要 A 和 B
2.  根据消息的序号处理消息。
3.  如果之前已经处理过具有相同序列号的消息，则忽略该消息。
4.  如果出现序列号间隙，则表明两个馈送（A 和 B）中的数据包丢失。客户端应启动其中一个恢复过程。但是首先客户端应该等待一个合理的时间，也许丢失的数据包会因为数据包重新排序而稍晚出现。UDP 协议不能保证数据包按顺序传送。

    // tcp 恢复算法进一步

* * *

我写了这么简单的类。它预先分配所有需要的类，然后接收特定的第一个线程`seqNum`可以处理它。另一个线程稍后将删除它：

```
class MsgQueue
{
public:
    MsgQueue();
    ~MsgQueue(void);
    bool Lock(uint32_t msgSeqNum);
    Msg& Get(uint32_t msgSeqNum);
    void Commit(uint32_t msgSeqNum);
private:
    void Process();
    static const int QUEUE_LENGTH = 1000000;

    // 0 - available for use; 1 - processing; 2 - ready
    std::atomic<uint16_t> status[QUEUE_LENGTH];
    Msg updates[QUEUE_LENGTH];
}; 
```

执行：

```
MsgQueue::MsgQueue()
{
        memset(status, 0, sizeof(status));
}

MsgQueue::~MsgQueue(void)
{
}

// For the same msgSeqNum should return true to only one thread 
bool MsgQueue::Lock(uint32_t msgSeqNum)
{
    uint16_t expected = 0;
    return status[msgSeqNum].compare_exchange_strong(expected, 1);
}

void MsgQueue::Commit(uint32_t msgSeqNum)
{
    status[msgSeqNum] = 2;
            Process();
}

    // this method probably should be combined with "Lock" but please ignore! :)
Msg& MsgQueue::Get(uint32_t msgSeqNum)
{
    return updates[msgSeqNum];
}

void MsgQueue::Process()
{
        // ready packets must be processed, 
} 
```

用法：

```
if (!msgQueue.Lock(seq)) {
    return;
}
Msg msg = msgQueue.Get(seq);
msg.Ticker = "HP"
msg.Bid = 100;
msg.Offer = 101;
msgQueue.Commit(seq); 
```

如果我们假设 QUEUE_LENGTH 是无穷大，这很好用。因为在这种情况下，一个 msgSeqNum = 一个`updates`数组项。

但是我必须使缓冲区循环，因为不可能存储整个历史记录（数百万个数据包）并且没有理由这样做。实际上我需要缓冲足够的数据包来重建会话，一旦重建会话，我就可以丢弃它们。

但是拥有循环缓冲区会使算法变得非常复杂。例如，假设我们有长度为 1000 的循环缓冲区。同时我们尝试处理 seqNum = 10 000 和 seqNum = 11 000（这非常不可能，但仍然可能）。这两个数据包都将映射到`updates`索引处的数组，`0`因此会发生冲突。在这种情况下，缓冲区应该“丢弃”旧数据包并处理新数据包。

实现我想要使用的东西很简单，但是在不同线程使用的循环缓冲区上`locks`编写代码确实很复杂。`lock-free`所以我欢迎任何建议和建议如何做到这一点。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-28T16:53:00.877

我不相信您可以使用*环形缓冲区*。可以在数组中使用*散列索引。*`status[]`即，`hash = seq % 1000`。问题是*序列号*是由网络决定的，你无法控制它的顺序。您希望根据此序列号进行**锁定。**您的数组不需要是*无限*的，只需*序列号*的范围；但这可能比实际更大。

我不确定*序列号*被锁定时会发生什么。这是否意味着另一个线程正在处理它？如果是这样，您必须维护一个哈希冲突的*子列表*来解决特定的序列号。

您也可以将数组大小视为 2 的幂。例如，1024 将允许`hash = seq & 1023;`，这应该是非常有效的。

# jquery - jQuery 动画正在跳跃

> ID：16202473
> 
> 赞同：0
> 
> 时间：2013-04-24T21:24:05.893
> 
> 标签：jquery

有人可以帮我吗？

我将其设置为水平导航。请参阅我的 jsFiddle 编码：

```
 <ul>
    <li >Item 1</li>
    <li >Item 1</li>                        
    <li >Item 1</li>                    
 </ul> 
```

[http://jsfiddle.net/k6YT8/](http://jsfiddle.net/k6YT8/)

当您在列表项上移动鼠标过快时，它们会变得跳跃，有时它会分成 2 或 3 行。

请看看我的 jQuery，让我知道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:26:27.830

您需要设置正确`width`的`ul`-

```
ul {
    display: block; clear: both;
    width:900px; 
} 
```

[小提琴](http://jsfiddle.net/mohammadAdil/KVH92/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:53:30.943

发生这种情况是因为您每次调用一个函数，鼠标悬停在一个元素上。这样，您可能会生成一长串函数，最终可能会以各种方式破坏您的动画。为了防止这种情况，您可以使用`stop()`方法，该方法**在匹配的元素上停止当前正在运行的动画。**
您可以选择使用 2 个布尔参数调用它：

```
.stop( [ clearQueue ] [, jumpToEnd ] ) 
```

clearQueue 从队列中删除所有动画，如果设置为 true 并且 jupToEnd 指示当前活动的动画是否应该立即结束。所以**在任何新动画之前**调用这个：

```
.stop(true,true) 
```

确保**所有动画都停止，队列重置并立即执行**。 [在这里阅读更多！](http://api.jquery.com/stop/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T21:30:38.007

您应该使用 stop() 方法

```
$('ul li').hover(
        function() {
            //mousein action
            $('ul li').stop(true, true);
            $('ul li.active').animate({
                width:'60'
            },250, function(){
                $(this).removeClass('active');
            });
            $(this).addClass('active').animate({
                width:'360'
            },250, function(){
                $(this).addClass('active');
            });
        },
        function () {
            //mouseout action

        }
    ); 
```

见小提琴：http: [//jsfiddle.net/djwave28/k6YT8/2/](http://jsfiddle.net/djwave28/k6YT8/2/)

# javascript - Javascript字符串搜索不起作用？

> ID：16202480
> 
> 赞同：0
> 
> 时间：2013-04-24T21:24:38.823
> 
> 标签：javascript, jquery, html, arrays

我有一个包含一些值的数组。我希望能够检查输入字段中的值是否存在于数组中。我的代码现在没有返回任何内容。

**html**

```
<input type="text" id="str_search" value=" "/>
<input type="button" id="search_str" value="search" /> 
```

**Javascript**

```
var array = ["php", "jquery", "java"];
var src_keyword = "";
$(document).ready(function () {
    $("#search_str").click(function () {
        src_keyword = $("#str_search").val();
        // alert(find(array,src_keyword));
        find(array, src_keyword)
    });
});

function find(arr, src_keyword1) {
    var result = [];
    alert(src_keyword1);
    // src_keyword1="oo";
    for (var i in arr) {
        var search = new RegExp(src_keyword1, "gi");
        if (arr[i].match(search)) {
            alert(arr[i])
            result.push(arr[i]);
        }
    }
    return result;
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:33:21.500

叉子：- [http://jsfiddle.net/jfy8J/](http://jsfiddle.net/jfy8J/)

可能**您的代码不起作用的原因是因为您**在文本框值中有一个空格并且您没有修剪它。

```
var array = ["php", "jquery", "java"];
var src_keyword = "";
$(document).ready(function () {
    $("#search_str").click(function () {
        src_keyword = $("#str_search").val().trim();
        var res = $.grep(array,function(obj,_){
            return obj === src_keyword;
        });
       if(res.length == 0) alert('not found'); else alert('found');
    });
}); 
```

**更新** 获取未找到的值：- [http://jsfiddle.net/ELqZS/](http://jsfiddle.net/ELqZS/)

```
var array = ["php", "jquery", "java"];
var src_keyword = "";
$(document).ready(function () {
    $("#search_str").click(function () {
        src_keyword = $("#str_search").val().trim();
       var items = $.grep(array,function(obj,_){
            return obj !== src_keyword;
        });
    alert(items);
    });
}); 
```

**更新 2**从具有搜索文本[http://jsfiddle.net/8FJYS/的数组中返回项目](http://jsfiddle.net/8FJYS/)

```
var array = ["php", "jquery", "java"];
var src_keyword = "";
$(document).ready(function () {
    $("#search_str").click(function () {
        src_keyword = $("#str_search").val().trim();
      var items =  array.filter(function(o, _){
            return o.indexOf(src_keyword) > -1;
        });
    alert(items);
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:29:43.160

改变你的 for 循环

```
for (var i in arr) 
```

至

```
for (var i=0; i < arr.length; i++) 
```

前一个循环遍历对象的所有属性以及每个索引元素的值。例如

```
var a = [7,8,9,0];
a.blah = "aoeusnth";
for (var prop in a) {
    console.log(prop);
} 
```

将登录

```
7
8
9
0
"blah" 
```

到控制台。

您正在使用变量“i”来访问数组的值，但在您的代码中，“i”已经是值。您想要的是使用项目的索引来访问项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:46:43.117

我认为您想使用[Array.indexOf](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf)而不是正则表达式解决方案。

> 概括
> 
> 返回可以在数组中找到给定元素的第一个索引，如果不存在则返回 -1。

```
<input type="text" id="str_search" value=" " />
<input type="button" id="search_str" value="search" />

var array = ["php", "jquery", "java"];
var src_keyword = "";
$(document).ready(function () {
    $("#search_str").click(function () {
        src_keyword = $("#str_search").val().trim();
        alert(array.indexOf(src_keyword) !== -1);
    });
}); 
```

在[jsfiddle上](http://jsfiddle.net/Xotic750/2psp7/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T21:32:43.027

只需使用 .indexOf()

```
$("#search_str").click(function () {
  src_keyword = $("#str_search").val().trim();
  alert(array.indexOf(src_keyword) !== -1);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T21:39:19.090

颠倒测试过程。现在，您正在测试`result`字符串的`search`字符串。你想扭转这种局面。

使用正则表达式`test()`方法。所以...

```
var search = new RegExp(src_keyword1, "gi");
if(search.test(arr[i])){....} 
```

当然，您现在可以将`RegExp`构造函数从循环中取出，以及其他一些小改动......

# asp.net-mvc - 在 Visual Studio 2012 中的 MVC 应用程序上运行 Page Inspector 时获取“对象引用未设置为对象的实例”

> ID：16202481
> 
> 赞同：3
> 
> 时间：2013-04-24T21:24:41.233
> 
> 标签：asp.net-mvc, visual-studio-2012

当我尝试在 Page Inspector 模式下运行 MVC Web 应用程序时，我收到错误“对象引用未设置为对象的实例”并且应用程序只是挂起。

微软已经注意到这是一个错误，但没有说明他们何时会修复它。

有人有解决方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-22T18:05:42.453

我也看到了对象引用错误，做了一些研究并在 Asp.net 上 找到[了这个线程。](http://forums.asp.net/t/1894770.aspx/1?Page+Inspector+crashes+VS+2012 "页面检查器崩溃 VS 2012")

在第 3 篇文章中，用户表示他们安装了[Visual Studio 2012 Web Express](http://www.microsoft.com/visualstudio/eng/products/visual-studio-express-for-web "VS 2012 网络快速安装")来清除错误。我安装了这个，现在 Page Inspector 在我的混合项目中工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-27T16:28:44.643

检查页面检查器中的地址栏以查看正在使用的参数，可能您的页面没有使用给定的 URL 呈现。还要确保 Visual Studio 具有[最新更新](http://www.microsoft.com/visualstudio)。

作为一种解决方法，您可以尝试在 Page Inspector 中调整 URL，以便您的控制器将数据传递给您知道工作正常的视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-10T18:33:19.680

基于[http://msdn.microsoft.com/en-us/vs11trainingcourse_pageinspector_topic2.aspx?ppud=4](http://msdn.microsoft.com/en-us/vs11trainingcourse_pageinspector_topic2.aspx?ppud=4)我相信问题是：

> Page Inspector 窗口将显示映射到您选择的源视图的 /Home/Index URL。

很久以前，我们将路由从 /Home/Index 更改了。如果我创建一个具有 /Home/Index 页面的新 Web 应用程序，那么 Page Inspector 就可以正常工作。

因此，长话短说，如果您想使用 Page Inspector，请始终确保您有一个 /Home/Index 页面，即使它是一个孤儿页面。希望微软能尽快修复这个错误。

# javascript - supervisord 将节点作为服务运行

> ID：16202482
> 
> 赞同：9
> 
> 时间：2013-04-24T21:24:45.357
> 
> 标签：javascript, node.js, supervisord

我正在尝试使用 supervisord 将节点应用程序作为服务运行。

如果我去 /opt/uptime 并运行：

```
node app.js 
```

我的应用程序在前台启动。我一按 ctrl+c 它就死了..正如预期的那样。

我已经安装了主管并将其添加到配置中：

```
[program:uptime]
command=/usr/local/bin/node app.js
directory=/opt/uptime/ 
```

我可以成功启动主管，但如果我做 supervisorctl status 我得到：

```
uptime         BACKOFF    Exited too quickly (process log may have details) 
```

以下是日志文件：

/var/log/supervisor/supervisord.log

```
2013-04-25 09:37:10,854 CRIT Supervisor running as root (no user in config file)
2013-04-25 09:37:10,866 INFO /var/tmp/supervisor.sock:Medusa (V1.1.1.1) started at Thu Apr 25 09:37:10 2013
Hostname: <unix domain socket>
Port:/var/tmp/supervisor.sock
2013-04-25 09:37:10,914 CRIT Running without any HTTP authentication checking
2013-04-25 09:37:10,915 INFO daemonizing the process
2013-04-25 09:37:10,917 INFO supervisord started with pid 28099
2013-04-25 09:37:10,918 INFO spawned: 'uptime' with pid 28101
2013-04-25 09:37:11,015 INFO exited: uptime (exit status 1; not expected)
2013-04-25 09:37:11,016 INFO received SIGCLD indicating a child quit
2013-04-25 09:37:12,019 INFO spawned: 'uptime' with pid 28103
2013-04-25 09:37:12,082 INFO exited: uptime (exit status 1; not expected)
2013-04-25 09:37:12,082 INFO received SIGCLD indicating a child quit
2013-04-25 09:37:14,086 INFO spawned: 'uptime' with pid 28105
2013-04-25 09:37:14,153 INFO exited: uptime (exit status 1; not expected)
2013-04-25 09:37:14,154 INFO received SIGCLD indicating a child quit
2013-04-25 09:37:17,157 INFO spawned: 'uptime' with pid 28107
2013-04-25 09:37:17,220 INFO exited: uptime (exit status 1; not expected)
2013-04-25 09:37:17,220 INFO received SIGCLD indicating a child quit
2013-04-25 09:37:18,221 INFO gave up: uptime entered FATAL state, too many start retries too quickly
2013-04-25 09:37:20,372 INFO localhost:0 - - [25/Apr/2013:14:37:20 -0600] "POST /RPC2 HTTP/1.0" 200 254
2013-04-25 09:37:20,374 INFO localhost:0 - - [25/Apr/2013:14:37:20 -0600] "POST /RPC2 HTTP/1.0" 200 1236 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-05-26T11:55:34.323

如果我理解正确，代码应如下所示：

如果目录 = /usr/local/bin/ ：

```
[program:uptime]
directory = /usr/local/bin/
command = node app.js 
```

如果目录 = /opt/uptime/ ：

```
[program:uptime]
directory = /opt/uptime/
command = node app.js 
```

# asp.net-mvc - Breeze.js：如何将 Breeze 实体转换为纯 JSON 对象

> ID：16202485
> 
> 赞同：2
> 
> 时间：2013-04-24T21:25:05.100
> 
> 标签：asp.net-mvc, knockout.js, breeze

我有一个使用来自服务器的元数据创建的实体实例：

```
breeze.NamingConvention.camelCase.setAsDefault();

...

var applicationType = metadataStore.getEntityType('Application');
var application = applicationType.createEntity(); 
```

此特定模型中的所有对象都没有循环依赖关系。

在用户对相应对象进行了一些更改后，我需要对该实体执行一些自定义验证，因此我需要将该对象转换回其 JSON 简单形式并将其发送回验证控制器（ASP.NET MVC4） .

问题是如何将实体转换为 JSON，以便：

1.  结果对象反映了服务器端使用的命名约定。
2.  该对象包含简单的属性，而不是淘汰 observables。
3.  并且不包含微风内部使用的任何其他附加属性或功能。

我期待找到类似的东西：

```
var json = application.toJS(); 
```

但是这样的方法是不存在的。使用 ko.toJS(application) 也不起作用，因为 (1)、(2) 和 (3) 没有实现。

我确信这应该很容易做到，但我什至在文档中找不到任何与远程相关的东西。

更新：你会原谅我可怕的黑客攻击，但因为我很着急我所做的暂时解决了我的问题，只是暴露`unwrapEntities`了`entityManager`. 我还稍微更改了函数定义（只是为了排除那个烦人的`entityAspect`）：

```
function unwrapEntities(entities, metadataStore, includeEntityAspect) {
    var rawEntities = entities.map(function(e) {
        var rawEntity = unwrapInstance(e);

        if (includeEntityAspect !== undefined && includeEntityAspect === false) {
            return rawEntity;
        }
        ...
    });
} 
```

而且因为我的`entityManager`服务中随时都有可用的数据，所以我能够扩展我的类型定义以执行以下操作：

```
function createApplicant(initialValues) {
    var applicant = applicantType.createEntity(initialValues);

    applicant.toJS = function () {
        var unwrappedEntities = entityManager.unwrapEntities([applicant], entityManager.metadataStore, false);
        return unwrappedEntities[0];
    };

    return applicant;
} 
```

这正是我所需要的：

```
var json = application.toJS(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T01:28:08.833

这是一个好主意！您能否将其添加到[微风用户语音](https://breezejs.uservoice.com/forums/173093-breeze-feature-suggestions)中。公开 Breeze 实体的“展开”是很有意义的。

只是一个小旁注，您编写的展开“hack”可能无法在未来版本的 Breeze 中工作，因为我们目前正在重构其中的一些代码，但我会尝试公开一个“更干净”的版本作为微风 API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-31T15:39:58.973

这可能是过时的解决方案，但我在我的 typescript 类中做了一些 hack 以在没有微风核心的帮助的情况下做到这一点。我做了这个 hack，因为我的微风版本和输入文件不包括 unwrap 方法，我现在不想升级它。
另一个好处是结果类绝对没有任何未包含在元数据中的额外属性，并且您可以控制是否只需要普通实体或者是否希望将相关实体也嵌入结果中。

只需将此代码包含在您的打字稿类中即可完成此操作：

```
public unwrapEntity(entity: breeze.Entity, includeRefs: boolean): any {
    var refs = [];
    return this.unwrapEntityInner(entity, refs, includeRefs);
}

private objInArray(obj: any, refs: Array<any>): boolean {
    var ret = false;
    for (var i = 0; i < refs.length; i++) {
        if (obj === refs[i]) {
            ret = true;
            break;
        }
    }
    if (!ret)
        refs.push(obj);
    return ret;
}

private unwrapEntityInner(entity: breeze.Entity, refs: Array<any>, includeRefs: boolean): any {
    var data = {};
    for (var prop in entity) {
        if (entity.hasOwnProperty(prop) && ko.isObservable(entity[prop])) {
            data[prop] = entity[prop]();
            if (typeof data[prop] !== 'undefined' && data[prop] != null) {
                if (typeof data[prop].entityAspect !== 'undefined') {
                    data[prop] = (includeRefs && !this.objInArray(data[prop], refs)) ? this.unwrapEntityInner(data[prop], refs, includeRefs ) : null;
                }
                else if ($.isArray(data[prop])) {
                    if (!includeRefs || this.objInArray(data[prop], refs))
                        data[prop] = [];
                    else {
                        var tmp = data[prop];
                        data[prop] = [];
                        for (var i = 0; i < tmp.length; i++) {
                            data[prop].push(this.unwrapEntityInner(tmp[i], refs, includeRefs));
                        }
                    }
                }
            }
        }
    }
    return data;
} 
```

# python - 如何让我的 __str__() 函数的返回值在我的 main 中打印？

> ID：16202493
> 
> 赞同：0
> 
> 时间：2013-04-24T21:25:18.170
> 
> 标签：python, class

我需要为一个程序创建两个类，该程序接受书籍、标题、作者、页数的输入变量，并查看它是否已检出，然后以下列格式将书籍添加到字典中`dictionary[title] = author`。然后我需要以这种格式在主函数中打印我的所有信息：“”title author pages checkOut。”我基本上需要`__str__()`在我的类中打印出我的函数的返回值。这是我的代码：

```
class Book:
    def __init__(self, title, author, pages):
        self.title = title
        self.author = author
        self.pages = pages
        self.checkedOut = False

    def checked_Out(self):
        print(self.checkedOut)
        return self.checkedOut

    def change_value_of_checkedOut(self):
        if self.checkedOut == False:
            self.checkedOut = True
            print("Switched from False to True.")
        elif self.checkedOut == True:
            self.checkedOut = False
            print("Switched from True to False.")

    def return_pages(self):
        print(self.pages)
        return self.pages

    def return_title(self):
        print(self.title)
        return self.title

    def __str__(self):
        return ("Title: " + self.title + "Author: " + self.author +
                "Pages: " + self.pages + "Checked Out Status: " +
                self.checkedOut)

class Library:
    def __init__(self):
        self.collection = {}

    def addExistingBook(self, book):
        self.collection[book.title] = book.author

    def addNewBook(self, title, author, pages):
        new_book = Book(title, author, pages)
        self.collection[title] = new_book.author

    def change_checked_out_status(self, title):
        if title in self.collection:
            title.change_value_of_checkedOut()
        else:
            print("This book is not in the collection.")

    def __str__(self):
        for myBook in self.collection[myBook]:
            self.collection[myBook]
            self.collection[myBook] = self.author

            # I want to print this return value in my main
        return ("Title: " + self.title + "Author: " + self.author
                + "Pages: " + self.pages + "Checked Out Status: " + self.checkedOut)

def main():
    title = str(input("Enter the title of the book. "))
    author = str(input("Enter the author of the book. "))
    pages = int(input("Enter the number of pages in the book. "))
    myBook = Book(title, author, pages)
    myLib = Library()
    myLib.addExistingBook(myBook)
    myLib2 = Library()
    myLib3 = myLib2.__str__()
    print(myLib3)

main() 
```

我在类库中的函数中的 for 循环似乎有问题`__str__(self)`（想法是我希望循环遍历集合中的任何一本书），但我不确定问题是什么。这是我收到的错误消息：

```
Enter the title of the book. A Tale of Two Cities
Enter the author of the book. Charles Dickens
Enter the number of pages in the book. 434
Traceback (most recent call last):
  File "C:\Python33\Class Programs\lab8.py", line 71, in <module>
    main()
  File "C:\Python33\Class Programs\lab8.py", line 68, in main
    myLib3 = myLib2.__str__()
  File "C:\Python33\Class Programs\lab8.py", line 54, in __str__
    for myBook in self.collection[myBook]:
UnboundLocalError: local variable 'myBook' referenced before assignment 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:27:48.100

您正在遍历字典的键，您不应该*尝试*在循环语句中传递键：

```
def __str__(self):
    for myBook in self.collection: 
```

目前尚不清楚您要对该循环做什么。`self.collection[myBook]`然后，您无需对返回值进行任何操作即可访问，然后将值*替换*`self.author`为（在 上不存在`self`，仍然是库），然后返回完全不同的结果作为`__str__()`结果。

我*想*你想在这里创建一个图书馆书籍列表：

```
def __str__(self):
    return ', '.join('{} - {}'.format(title, author) for title, author in self.collection.items()) 
```

现在，您返回一个以逗号分隔的集合中所有标题和作者的列表。

那里发生了 3 件事：

*   使用生成器表达式，我们遍历字典[`.items()`方法](http://docs.python.org/3/library/stdtypes.html#dict.items)；这会为字典中的所有内容生成`(key, value)`对。
*   每个键和值都传递给[`str.format()`方法](http://docs.python.org/3/library/stdtypes.html#str.format)，使用字符串作为模板在`-`存储在`self.collection`字典中的标题和作者对之间放置一个破折号。
*   整个循环传递给[`str.join()`方法](http://docs.python.org/3/library/stdtypes.html#str.join)；此方法从给定的序列中获取所有字符串，并将它们与它们之间的`', '`逗号连接在一起。

接下来，您正在创建一个*空*库，然后打印该`__str__()`方法的输出；没有必要明确地调用它`print()`，为你做。不要创建新库，只需打印您已有的库：

```
myLib = Library()
myLib.addExistingBook(myBook)
print(myLib) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:28:20.260

我想你想改变

```
def __str__(self):
        for myBook in self.collection[myBook]:
            self.collection[myBook]
            self.collection[myBook] = self.author 
```

至

```
def __str__(self):
        for myBook in self.collection.keys():
            self.collection[myBook]
            self.collection[myBook] = self.author 
```

# .htaccess - htaccess 仅匹配（地址栏）url

> ID：16202495
> 
> 赞同：0
> 
> 时间：2013-04-24T21:25:33.420
> 
> 标签：.htaccess, mod-rewrite

我想防止图像在新标签页中打开。

```
RewriteRule \.(jpg|jpeg|png|gif)$ %{ENV:REWRITEBASE} [NC,R,L] 
```

但是这条线在每个请求上都被执行，这使得所有图像都消失了有没有我可以使用的标志，以便 RewriteRule 仅在 url 在地址栏中时执行？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:28:46.813

不，没有。您正在处理服务器端编程 - 它不知道浏览器上发生了什么。

您几乎唯一可以检查的是推荐人，但这是一个非常弱的检查，并且在将图像打开到新标签时无法区分。唯一可能会产生影响的情况是，有人会使用来自其他地方而不是您网站的图像的直接链接。

# android - 如何在 Android 中随机插入弹出消息？

> ID：16202496
> 
> 赞同：0
> 
> 时间：2013-04-24T21:25:33.517
> 
> 标签：android, android-asynctask, popupwindow

您好我正在尝试使用 AsyncTask 以随机间隔显示弹出消息。

```
 public class MainActivity extends Activity {
       boolean popped=false;
   @Override
        public void onCreate(Bundle savedInstanceState) {
           super.onCreate(savedInstanceState);
           setContentView(R.layout.activity_main); 
       new PopupTask().execute();
    } 
```

仅当没有弹出其他弹出消息时，此方法才会弹出弹出消息。

```
 private class PopupTask extends AsyncTask<String, Void, String> {

      @Override
       protected String doInBackground(String... arg0) {

    Random r=new Random();
    int i1=r.nextInt();
    if(popped==false){
        LayoutInflater layoutInflater 
            = (LayoutInflater)getBaseContext().getSystemService(LAYOUT_INFLATER_SERVICE);  
        View popupView = layoutInflater.inflate(R.layout.popup, null);  
       final PopupWindow popupWindow = new PopupWindow(
                   popupView, 
                   LayoutParams.MATCH_PARENT,  
                         LayoutParams.MATCH_PARENT);  

                if(!popped){
                    popupWindow.showAsDropDown(popupView, 90, 420);
                    popped=true;
                }

                 Button btnDismiss = (Button)popupView.findViewById(R.id.dismiss);
                 btnDismiss.setOnClickListener(new Button.OnClickListener(){

                     @Override
                     public void onClick(View v) {
                      // TODO Auto-generated method stub
                      popupWindow.dismiss();
                      popped=false;

                     }});
    }
    return null;
} 
```

但是，当控制到达 LayoutInflater 语句时，我得到一个异常。

有没有更好的方法来做到这一点？提前致谢

编辑：这是我的堆栈跟踪

```
04-25 02:40:33.298: E/AndroidRuntime(9724): FATAL EXCEPTION: AsyncTask #1
04-25 02:40:33.298: E/AndroidRuntime(9724): java.lang.RuntimeException: An error occured while executing doInBackground()
04-25 02:40:33.298: E/AndroidRuntime(9724):     at android.os.AsyncTask$3.done(AsyncTask.java:278)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:208)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at java.lang.Thread.run(Thread.java:856)
04-25 02:40:33.298: E/AndroidRuntime(9724): Caused by: java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare()
04-25 02:40:33.298: E/AndroidRuntime(9724):     at android.os.Handler.<init>(Handler.java:121)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at android.view.ViewRootImpl.<init>(ViewRootImpl.java:329)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:267)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:215)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at android.view.WindowManagerImpl$CompatModeWrapper.addView(WindowManagerImpl.java:140)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at android.view.Window$LocalWindowManager.addView(Window.java:537)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at android.widget.PopupWindow.invokePopup(PopupWindow.java:988)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at android.widget.PopupWindow.showAsDropDown(PopupWindow.java:897)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at com.example.popupsamp.MainActivity$PopupTask.doInBackground(MainActivity.java:85)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at com.example.popupsamp.MainActivity$PopupTask.doInBackground(MainActivity.java:1)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at android.os.AsyncTask$2.call(AsyncTask.java:264)
04-25 02:40:33.298: E/AndroidRuntime(9724):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
04-25 02:40:33.298: E/AndroidRuntime(9724):     ... 5 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T04:50:33.877

覆盖`onProgressUpdate();` 并做这样的事情。

```
private class PopupTask extends AsyncTask<String, Integer, String>
 @Override
   protected String doInBackground(String... arg0) {

Random r=new Random();
int i1=r.nextInt();
if(popped==false){
   publishProgress(100); // Pass any Number
}

@Override
protected void onProgressUpdate(Integer... values) {
super.onProgressUpdate(values);
if (values[0] == 100) {

LayoutInflater layoutInflater 
        = (LayoutInflater)getBaseContext().getSystemService(LAYOUT_INFLATER_SERVICE);  
    View popupView = layoutInflater.inflate(R.layout.popup, null);  
   final PopupWindow popupWindow = new PopupWindow(
               popupView, 
               LayoutParams.MATCH_PARENT,  
                     LayoutParams.MATCH_PARENT); 

    }
} 
```

另请阅读本教程以了解[asyncTask](http://samir-mangroliya.blogspot.com/p/android-asynctask-example.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:45:22.517

您不能在 UI 线程以外的线程中显示弹出窗口。将此代码移至 onPostExecute() 方法。

# java - 如何在命令行上覆盖类型安全配置列表值？

> ID：16202501
> 
> 赞同：42
> 
> 时间：2013-04-24T21:26:04.570
> 
> 标签：java, scala, config, typesafe

我有`application.conf`一个结构如下的文件：

```
poller {
  datacenters = []
} 
```

我想`"datacenters"`在命令行上覆盖。

对于值是简单类型（字符串、数字）的其他配置键，我可以使用覆盖`-Dpath.to.config.value=<value>`，这很好用。

但是，我似乎找不到为*list*执行此操作的方法。在上面的示例中，我尝试设置`"datacenters"`为`["SJC", "IAD"]`like: `-Dpoller.datacenters="['SJC', 'IAD']"`，但我得到一个异常，即键值是一个字符串，而不是一个列表。

有没有办法向类型安全配置库发出这个值是一个列表的信号？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-06-04T16:28:05.037

1.0.1 版本为此实现了另一种语法：

```
-Dpoller.datacenters.0=SJC -Dpoller.datacenters.1=IAD 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T21:30:29.957

几周前我遇到了同样的问题，最后深入研究了源代码以了解发生了什么：

*   此功能未实现，无法使用命令行参数定义列表

修复它不会那么难，但需要有人花时间去做。

# wordpress - 子域上的 Wordpress 网络和站点

> ID：16202502
> 
> 赞同：2
> 
> 时间：2013-04-24T21:26:06.807
> 
> 标签：wordpress

如果您在 site.com 上安装了 wordpress，并希望在 one.site.com、two.site.com 等网站上使用多站点功能，但不希望将 site.com 包含在网络中。

即在例如zero.site.com 上有网络。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T01:10:18.827

在 zero.site.com 安装网络；使用符号链接将 one.site.com 指向 zero.site.com；然后使用域映射插件实现one.site.com URL。

# security - 健全性检查：SSL+ POST 与未加密的 GET

> ID：16202509
> 
> 赞同：0
> 
> 时间：2013-04-24T21:26:22.690
> 
> 标签：security, post, ssl

一个经典的愚蠢做法是通过查询字符串 ala 上的 GET 传递一些与安全相关的信息：

```
http://foo?SecretFilterUsedForSecurity=username 
```

...任何雅虎都可以使用 Fiddler 或类似的东西来看看发生了什么......

但是，通过 POST 将此信息传递到应用服务器（运行 SSL）有多安全？Fiddler 网站上的这个链接似乎表明可以解密 HTTPS 流量：

[http://fiddler2.com/documentation/Configure-Fiddler/Tasks/DecryptHTTPS](http://fiddler2.com/documentation/Configure-Fiddler/Tasks/DecryptHTTPS)

如果目标是确保客户端无法捕获/读取您不希望他们获取的信息，那么这是否同样愚蠢？好像是这样。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:40:55.007

是的，它“同样愚蠢”。SSL 仅保护数据不被第三方读取；它不会阻止客户端（或服务器）读取它。如果您不信任客户端读取某些数据，则不应授予他们访问该数据的权限，即使只是进行 POST 也是如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T02:34:52.953

[是的，任何用户都可以使用Burp Suite](http://portswigger.net/burp/)、[Webscarab](https://www.owasp.org/index.php/Category%3aOWASP_WebScarab_Project)或[Paros Proxy](http://www.parosproxy.org/)等软件轻松检查 POST 请求中的数据，甚至通过 HTTPS/SSL 。这些代理将完成与服务器的 SSL 事务，然后将数据传递给客户端。通过代理的所有数据都被存储并且对客户端可见。

也许您正试图在客户端存储敏感/秘密数据以减轻服务器上的负载？要做到这一点，即使使用代理，用户也无法查看（或更改）它的方法是使用只有服务器知道的强对称密钥对其进行加密。如果您想确保加密的数据不被篡改，请使用[HMAC](https://en.wikipedia.org/wiki/Hash-based_message_authentication_code)。确保使用足够随机的密钥以及强大的加密算法和密钥长度，例如 AES 256。

如果您这样做，您可以将此数据的存储卸载到客户端，但仍然可以确保自服务器上次看到它以来它没有更改，并且客户端无法查看它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T21:40:35.957

这取决于您试图保护数据的对象，以及您对客户端软件的控制程度。从根本上说，在任何客户端-服务器应用程序中，客户端都必须知道它正在向服务器发送什么。

如果实施得当，SSL 将在不修改客户端的情况下防止任何中介嗅探或更改流量。但是，这依赖于使用服务器域的*有效*证书对连接进行加密，并且如果不是这种情况，客户端将拒绝采取行动。鉴于这种情况，连接只能由持有该 SSL 证书的私钥的人解密。如果您的“客户端”只是一个网络浏览器，这意味着第三方（例如在公共 Wi-Fi 位置）无法在不提醒使用该网站的人存在可疑情况的情况下拦截数据。但是，它不会阻止用户故意绕过浏览器中的提示以自行嗅探流量。

如果您的客户端是自定义的二进制应用程序，那么对于“爱管闲事”的用户来说事情会更安全一些：为了检查流量，他们必须修改客户端以绕过您的证书检查（例如，通过更改目标 URL ，或欺骗应用程序信任伪造的证书）。

简而言之，没有什么可以完全阻止坚定的用户嗅探*他们自己的*流量（尽管您可以使其更难），但正确实施的 SSL 将阻止第三方*拦截*流量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-25T06:59:41.037

不使用 GET 请求将机密信息添加到 URL 的另一个更重要的原因是 Web 服务器和途中的任何代理都会记录它。默认情况下不记录 POST 参数。

您不希望您的密码出现在服务器日志中 - 日志的保护通常比密码数据库本身要少得多。

# android - AutocompleteTextView 和 ArrayAdapter 以编程方式崩溃

> ID：16202511
> 
> 赞同：1
> 
> 时间：2013-04-24T21:26:25.520
> 
> 标签：android, android-layout

我有以下代码，我正在尝试将 链接`String [] teams`到该`team1Input`字段。该程序当前崩溃，我很确定我没有`team1Input.getId()`正确使用。我怎么能在不接触任何 xml 的情况下做到这一点？

```
final AutoCompleteTextView team1Input = new AutoCompleteTextView(this);
        team1Input.setLayoutParams(new LinearLayout.LayoutParams(
                LinearLayout.LayoutParams.MATCH_PARENT,
                LinearLayout.LayoutParams.WRAP_CONTENT
                ));
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, team1Input.getId(), teams);
        team1Input.setAdapter(adapter);
        row1.addView(team1Input); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:37:32.887

正如[文档](http://developer.android.com/reference/android/widget/ArrayAdapter.html#ArrayAdapter%28android.content.Context,%20int,%20T%5B%5D%29)所述：

**textViewResourceId**包含 TextView 的布局文件的资源 ID，以在实例化视图时使用。

您不应该传递 TextView 的 id。预期的 id 是 R.layout.your_layout_here。此布局文件必须只有一个 TextView。

# iis-7 - IIS 7 Url Rewrite - 匹配子域，但不包括特定 url

> ID：16202519
> 
> 赞同：3
> 
> 时间：2013-04-24T21:26:40.213
> 
> 标签：iis-7, url-rewriting, url-rewrite-module

我在用户可以在子域上创建自己的网站的站点上设置了 URL 重写。

```
<rule name="CName to URL - Rewrite" stopProcessing="true">
    <match url=".*" />
    <conditions>
        <add input="{HTTP_HOST}" pattern="^(?!www)(.*)\.basedomain\.com" />
    </conditions>
<action type="Rewrite" url="render_page.aspx?site={C:1}&amp;page={R:0}" />
</rule> 
```

例如，用户可以创建一个页面[http://client.basedomain.com/about-us](http://client.basedomain.com/about-us)，这将成功地将“client”和“about-us”传递给我的应用程序。

我需要做的是在特定页面名称跟随其域的情况下覆盖此行为。

所以如果页面[http://client.basedomain.com/restricted](http://client.basedomain.com/restricted)被访问了，就不会进行上面的重写，而是重写到url "render_page_restricted.aspx?site={C:1}

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-26T12:08:42.533

以标准方式，花了几天时间研究它，最后将它发布到 SE 上，我在 20 分钟后破解了它。叹。如果其他人有同样的问题，这是我的解决方法：

```
<rule name="Restricted Page Name Override - Rewrite" stopProcessing="true">
    <match url="^(?!www)(.*)restricted" />
    <conditions>
        <add input="{HTTP_HOST}" pattern="^(?!www)(.*)\.basedomain\.com"/>
    </conditions>
    <action type="Rewrite" url="render_page_restricted.asp?site={C:1}" />
</rule> 
```

# android - 让 SAXParser 忽略转义字符

> ID：16202522
> 
> 赞同：0
> 
> 时间：2013-04-24T21:26:45.930
> 
> 标签：android, xml, xml-parsing, saxparser

我正在使用 sax 解析器来解析 xml 文件。除了遇到转义字符外，它工作得很好。下面是我试图解析的 xml 文件中的文本：

```
<line id='1'><![CDATA[Samantha saves 60&cent; on Thursday.]]></line>
<line id='2'><![CDATA[She saves 30&cent; on Friday.]]></line> 
```

我得到的结果是：Samantha 在星期四节省了 60 美分。她节省了 30 美分；在周五。

如何让我的解析器忽略 & 符号？这可能吗？

编辑：上面的结果没有引号。我不想在数字 60 之后有 & 符号。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T15:35:40.850

CDATA 标记告诉解析器 CDATA 部分中的所有字符都将按字面意思解释，也就是说，它们代表自己。所以`&`在 CDATA 内不是特殊字符；CDATA 中没有转义序列。如果你想使用实体引用，`&cent;`那么你不应该使用 CDATA。CDATA 标签的其他用途是什么？只是摆脱他们。

# php - 通过PHP将具有多个以逗号分隔的值的变量传递给sql语句

> ID：16202528
> 
> 赞同：1
> 
> 时间：2013-04-24T21:27:28.523
> 
> 标签：php, mysql, wordpress

我已经查看了整个互联网，但找不到我正在寻找的简单答案 - 可能是因为它不存在，但是.. 可能是因为我不知道要搜索的正确术语。

好的，所以，我有一个变量 - 它实际上是我传递给我的函数的数组中的一个键值对。关键是 args[comments_提到] 并且值是为我动态生成的 - 它总是数字，用逗号分隔（即 1,2,3,4,5）

所以，只是要超级清楚：

```
 $args[comments_mentioned] == "1,2,3,4"; //could be any amount of number, not just 1,2,3,4,5 
```

我想将它作为变量传递到 sql 语句中，以在“IN”子句中使用，如下所示：

```
 $sr_sql = <<<SQL
         SELECT *
         FROM $wpdb->commentmeta
         WHERE meta_value = %s
         AND comment_ID in ($args[comments_mentioned])
         ORDER BY meta_id DESC
         SQL; 
```

然后，使用 wordpress 准备它并获得结果

```
 $sr_query = $wpdb->prepare( $sr_sql, $args[user_id]) );
        //receive the correct sql statement, and plug 'er in.
        $sr_comment_rows = $wpdb->get_results($sr_query); 
```

并运行我的 foreach 循环：

```
 foreach ($sr_comment_rows as $sr_comment) {
            $sResults .= 'do something with $sr_comment';
        } 
```

现在，我意识到上面的代码不起作用——我不能像那样传递变量。但是，我不能将它作为字符串 (%s) 传递，因为它将它包装在 '1,2,3,45' 中，因此它会查找整个字符串，而不是每个数字。由于逗号，我不能将其作为 int (%d) 传递...

在其他帖子中，他们提到了创建一个临时表或变量，但是，我不确定这是否是在 mysql 中执行此操作的正确方法，或者一旦我这样做了如何引用它。

那么，我该怎么做呢？偏爱有效的实际代码；）

感谢您的阅读和帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:16:03.933

我相信这应该足够了：

```
$params = $args[comments_mentioned];
$table = $wpdb->commentmeta;
$sr_sql = "
         SELECT *
         FROM $table
         WHERE meta_value = %s
         AND comment_ID in ($params)
         ORDER BY meta_id DESC
         "; 
```

结果会是这样的：

```
SELECT *
FROM table_on_variable
WHERE meta_value = %s
         AND comment_ID in (1,2,3,4)
         ORDER BY meta_id DESC 
```

如果您的主要问题是关于 in 子句，那么如果您使用双引号和单变量，如上图所示，您将不会遇到问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:34:42.850

如果您无法规范化数据，一种选择是将字符串用逗号括起来`",1,2,3,4,"`，这样您就可以这样做：

```
AND LOCATE( CONCAT(',',comment_ID,',') , ($args[comments_mentioned]) ) 
```

如果找到例如，它将匹配。`',3,'`in `',1,2,3,4,'`（以3为例）

# php - 无需登录即可从 facebook graph api 检索照片

> ID：16202533
> 
> 赞同：2
> 
> 时间：2013-04-24T21:27:37.790
> 
> 标签：php, facebook, facebook-graph-api, photos

我有一个 php 应用程序，我的注册用户在其中登录到 facebook。我用`$facebook->getLogoutUrl();`. 然后我检索他们所有的专辑并在 HTML 选择标签中显示他们的 ID 和名称。用户选择一个，专辑的 id 存储在数据库中。

在这里一切都很好。

然后一个匿名用户访问我的网站，我希望他看到我的注册用户照片（注册用户选择的相册的公共照片）（他们没有登录我的网站，他们没有登录 facebook）。目前，它仅在匿名用户登录 facebook 时才有效。**但是即使匿名者没有登录facebook，我也想显示照片。**

```
$photos = $facebook->api('/'.$idAlbum.'?fields=id,name,link,photos.fields(id,picture,source)'); 
```

我已经尝试了 2 周，但似乎没有任何效果。我尝试过不登录，我尝试过使用应用访问令牌，我尝试过：

`https://graph.facebook.com/oauth/access_token?client_id=XXXXXX&client_secret=YYYYYY&grant_type=client_credentials`

谁能帮我？或者告诉我我的应用程序是否无法从相册中检索照片。我搜索了一种登录我的应用程序的方法，但我只找到了应用程序访问令牌（[https://developers.facebook.com/docs/howtos/login/login-as-app/](https://developers.facebook.com/docs/howtos/login/login-as-app/)）但正如它所说`it can make requests as the app, not as a user`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:53:31.673

为了访问用户信息，您需要该用户的有效访问令牌。应用程序访问令牌不能用于代表用户执行任何操作。

访问令牌会在一段时间后过期，这会阻止应用程序在用户实际未使用应用程序时搜索用户信息。

如果您想一路走下去 - 只需从相册中下载所有照片并将它们存储在您的服务器上......如果您不能这样做，那么您将不得不考虑扩展相册所有者的访问令牌，以便您可以在查询他们的相册时使用它。就应用程序而言，使用该扩展访问令牌，实际上是相册所有者发出请求。

取自[Facebook 文档](https://developers.facebook.com/docs/howtos/login/extending-tokens/)：

> ### 扩展客户端用户访问令牌
> 
> 当一个人完成客户端身份验证流程并且您检索他们的用户访问令牌时，默认情况下，该令牌仅在一到两个小时内有效。
> 
> 您可以将此令牌交换为有效期最长为 60 天的令牌，方法是使用 fb_exchange_token 的 grant_type 参数将其从您的服务器传递到 /oauth 端点。[请注意，它必须从服务器发送，以免 App Secret 暴露。] 如下所示：
> 
> ```
> https://graph.facebook.com/oauth/access_token？  
>     grant_type=fb_exchange_token&           
>     client_id=APP_ID&
>     client_secret=APP_SECRET&
>     fb_exchange_token=SHORT_LIVED_ACCESS_TOKEN
> ```
> 
> 来自此端点的响应将包括长期访问令牌。这将是与原始令牌不同的字符串，因此如果您要存储这些令牌，请替换旧的。

基本上，只要任何（注册的）用户成功登录并将令牌存储在数据库中，您就必须这样做。

# json - 巨大的 geoJSON 文件——甚至无法编辑

> ID：16202543
> 
> 赞同：-3
> 
> 时间：2013-04-24T21:28:44.870
> 
> 标签：json, memory, leaflet, geojson

我有一个需要编辑的 geoJSON 文件。例如，我需要进行查找和替换操作。但是，我什至无法在某些应用程序中打开文件 (150 MB)。使用 TextEdit（我在 Mac 上），我可以打开文件，但是当我尝试任何查找和替换操作时，应用程序几乎立即停止响应并冻结。

该文件包含我想要映射的数据（点）（我想我会使用 Leaflet），所以最终我需要将文件传输到我的服务器。鉴于文件的大小，我会在那里遇到任何问题，然后在浏览器中映射这些点吗？

任何有关该做什么的建议或指示将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:33:47.150

查看有关从命令行替换文本的[链接。](https://askubuntu.com/questions/20414/find-and-replace-text-within-a-file-using-commands)您应该能够使用`sed`来替换这些实例，而无需将其加载到内存中（我认为）。

# fortran - 定义我自己的 TYPE 时，ifort 和 gfortran 的结果不同

> ID：16202546
> 
> 赞同：2
> 
> 时间：2013-04-24T21:28:49.387
> 
> 标签：fortran, gfortran, intel-fortran

我是 Fortran 的新手，但我通常发现我可以用 C 或 Matlab 做大部分事情，只要我了解模块和类型。但是，我对结果的这种差异感到困惑，这取决于我使用的是 gfortran（gcc 版本 4.6.2）还是 ifort（13.0.2）。Gfortran 给了我预期的结果，但 ifort 给了我 3 个空白行！任何想法为什么？

```
module define_structures
implicit none
private

public modelling_params

    type modelling_params
        real, dimension(:), allocatable :: freqs
        real, dimension(:), allocatable :: offsets      
        complex, dimension(:), allocatable :: data
    end type modelling_params   
end module define_structures

program main

use define_structures
    implicit none

    type (modelling_params) :: S

    S%data = [(1,1) ,(2,3), (3,1)]
    S%freqs = [1, 3, 7]
    S%offsets = [100, 200, 300]
    print *,S%data
    print *,S%freqs
    print *,S%offsets

end program main 
```

这是使用 gfortran 编译的输出

```
(  1.0000000    ,  1.0000000    ) (  2.0000000    ,  3.0000000    ) (  3.0000000    ,  1.0000000    )
1.0000000       3.0000000       7.0000000    
100.00000       200.00000       300.00000 
```

使用 ifort，我只得到 3 个空行，尽管它编译得很好！！

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T22:59:35.947

`ifort`当`-assume realloc_lhs`命令行选项传递给编译器时，支持在赋值时重新分配可分配变量。如果您在第一次分配之后立即插入以下内容：

```
print *, allocated(S%data) 
```

您会看到`F`，这意味着分配给时未分配可分配字段。代码按预期工作`-assume realloc_lhs`。

# python - 测量加载页面的时间 - Python

> ID：16202548
> 
> 赞同：1
> 
> 时间：2013-04-24T21:29:01.340
> 
> 标签：python

我正在使用[webbrowser](http://docs.python.org/2/library/webbrowser.html)，所以我可以打开一个 html 来进行我目前正在进行的性能测试。这一小段代码是自动化的开始。该函数的目标`perf_measure`是返回`url`完全加载页面所用的时间。

```
import webbrowser

def perf_measure(url=""):

    try:
        webbrowser.open(url)

    except webbrowser.Error, e:
        print "It couldn't open the url: ", url

url = "www.google.com"
open_browser(url) 
```

我怎样才能做到这一点？我只需要以秒为单位的值，例如：

```
www.google.com  Total time to load page in (secs): 2.641 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T21:31:32.270

您需要使用网络浏览器吗？如您需要查看结果吗？

否则你可以这样做。

```
import urllib2
from time import time

stream = urllib2.urlopen('http://www.rarlab.com/rar/winrar-x64-420.exe')
start_time = time()
output = stream.read()
end_time = time()
stream.close()
print(end_time-start_time) 
```

如果您想要更易于阅读的结果，可以使用[round](http://docs.python.org/2/library/functions.html#round)。

```
print(round(end_time-start_time, 3)) 
```

**输出**

```
0.865000009537 # Without Round
0.865          # With Round 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T21:33:16.767

一种使用装饰器的奇特方式

```
import time

def time_it(func):
    def wrapper(*arg,**kw):
        t1 = time.time()
        res = func(*arg,**kw)
        t2 = time.time()
        return (t2-t1),res,func.func_name
    return wrapper

@time_it
def perf_measure(url=""):
    #w hatever you want
    pass 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-07-31T17:47:17.230

如果您想在真实浏览器中计时页面加载（包括它加载的所有资源、渲染时间等），您可以使用[Selenium Webdriver](https://selenium-python.readthedocs.io/api.html)。这将打开您选择的浏览器，加载 URL，然后提取时间：

```
from selenium import webdriver

def time_url(driver, url):
    driver.get(url)

    # Use the browser Navigation Timing API to get some numbers:
    # https://developer.mozilla.org/en-US/docs/Web/API/Navigation_timing_API
    navigation_start = driver.execute_script(
        "return window.performance.timing.navigationStart")
    dom_complete = driver.execute_script(
        "return window.performance.timing.domComplete")
    total_time = dom_complete - navigation_start

    print(f"Time {total_time}ms")

driver = webdriver.Chrome()

try:
    url = "https://httpbin.org/delay/"
    time_url(driver, url + '1')
    time_url(driver, url + '2')

finally:
    driver.close() 
```

如果您想将渲染时间与加载时间等分开，您可以加载许多[其他指标。](https://developer.mozilla.org/en-US/docs/Web/API/PerformanceTiming)

# python - Python - 使用定义和 env.hosts 创建结构日志文件

> ID：16202549
> 
> 赞同：1
> 
> 时间：2013-04-24T21:29:02.853
> 
> 标签：python, logging, concatenation, fabric

一直在尝试解决这个问题，但似乎无法让它发挥作用。我想创建一个看起来像 $HOSTNAME-timestamp 的日志文件。例如我有这个：

```
def test_servers():
    env.user = getpass.getuser()
    env.hosts = ['servernumber1', 'servernumber2']

def logname():
        timestamp = time.strftime("%b_%d_%Y_%H:%M:%S")
        'env.hosts' + timestamp

def audit():
        name = logname()
        sys.stdout = open('/home/path/to/audit/directory/%s' % name, 'w')
        run('hostname -i')
        print 'Checking the uptime of: ', env.host
        if run('uptime') < '0':
                print(red("it worked for less"))
        elif run('uptime') > '0':
                print(green("it worked for greater"))
        else:
                print "WTF?!" 
```

当我在我的 fabfile.py 上运行 fabric 以执行“审计”时，它工作得很好，但它没有在文件开头创建带有附加主机名的日志文件。它确实为 test_servers 中定义的每个主机创建了一个日志文件，但带有时间戳。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T08:11:46.633

看起来 env.hosts 不能在函数中定义，只有 env.host_string 可以。

所以我想你可能会收到一些错误消息，例如：

```
No hosts found. Please specify (single) host string for connection: 
```

# r - 使用 RGL 绘制 3D 地图

> ID：16202558
> 
> 赞同：1
> 
> 时间：2013-04-24T21:29:50.557
> 
> 标签：r, rgl

我正在尝试在 RGL 的 3d 环境中绘制平面地图，因为它应该能够自定义缩放/倾斜地图，以获得最适合数据和所需输出图像方面的投影。该线程描述[了](https://stat.ethz.ch/pipermail/r-help/2009-November/219844.html)使用`rgl.surface()`. 但尚不清楚此方法是否适用于 OSM/其他地图对象。非常感谢您可能有的任何想法。

这是起点，失败是因为`Error in is.matrix(z) : 'z' is missing`. 知道如何为 z 坐标插入一些零吗？

```
require(rgl)
open3d()               # R crashes if this is done later(?)
#Sys.setenv(NOAWT=1)   # fix an {OSM} X11 issue in Mac
require(OpenStreetMap)
require(ggplot2)

lat <- c(53, 50); lon <- c(-5, 1)
map <- openmap(c(lat[1],lon[1]),c(lat[2],lon[2]), 5, 'osm')
map <- openproj(map)
rgl.surface(map) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-26T09:18:01.330

您需要为高度创建一个零矩阵并使用`col=`参数来`surface3d`设置图像的颜色。

从对象中获取所有维度和排序以及所有这些`map`都是一件小事，所以这里有一个函数可以做到：

```
map3d <- function(map,...){
  if(length(map$tiles)!=1){
    stop("multiple tiles not implemented")
  }

  nx = map$tiles[[1]]$xres
  ny = map$tiles[[1]]$yres

  xmin = map$tiles[[1]]$bbox$p1[1]
  xmax = map$tiles[[1]]$bbox$p2[1]
  ymin = map$tiles[[1]]$bbox$p1[2]
  ymax = map$tiles[[1]]$bbox$p2[2]

  xc = seq(xmin,xmax,len=ny)
  yc = seq(ymin,ymax,len=nx)
  colours = matrix(map$tiles[[1]]$colorData,ny,nx)
  m = matrix(0,ny,nx)
  surface3d(xc,yc,m,col=colours,...)

} 
```

这给了我们：

![闪亮的地图](https://i.stack.imgur.com/oRsCZ.png)

现在，请注意它仅在返回的地图中有一个图块时才有效，但原理就在那里。

另外，我并不完全相信坐标对齐是准确的。坐标可能是图像的像素或边缘的中心，因此某处可能缺少+1。而且我不确定它是否适用于灰色边框。

# php - 保持 php 脚本一直运行

> ID：16202564
> 
> 赞同：3
> 
> 时间：2013-04-24T21:30:05.673
> 
> 标签：php, ubuntu

我需要在我的服务器上保持一个 php 脚本运行并保持活动状态，该脚本运行并检查数据库的记录，如果需要则进行处理，休眠 3 次，然后无限循环循环到脚本的顶部。问题是启动它，如果我使用 php script.php 通过终端（它在 ubuntu 系统上运行）启动它，那么如果终端会话结束，脚本将停止运行。

那么我该如何启动脚本，以便它继续在后台运行。

此外，如果我设置了一个每小时运行一次的 cron 作业并启动另一个脚本来检查主脚本是否仍在运行，如果没有重新启动它，我将如何获取此检查器脚本来检查初始脚本是否仍在运行（即使它在睡觉）。

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T21:34:32.477

如果从 Web 启动脚本是一个选项，则将[时间限制](http://php.net/manual/en/function.set-time-limit.php)设置为“无限制”（在脚本本身中）：

```
set_time_limit(0); 
```

*并将*[ignore_user_abort](http://php.net/manual/en/function.ignore-user-abort.php)设置为`"true"`：

```
ignore_user_abort(true); 
```

然后您可以像往常一样从 Web 运行脚本，它将永远运行（直到进程被终止或脚本以通常的方式[退出](http://de3.php.net/manual/en/function.exit.php)）。

当然，您可以（并且**必须**）通过密码保护这样的启动脚本，例如通过使用 HTTP 身份验证`.htaccess`，以便有人无法启动许多永久运行的脚本，这会导致您的服务器瘫痪。

* * *

在检查另一个进程是否正在运行时，请参阅[question1](https://stackoverflow.com/q/3111406/2170192)、[question2](https://stackoverflow.com/q/9874331/2170192)或尝试在 StackOverflow 上搜索“[php] 检查进程是否正在运行”。另请参阅[http://php.net/manual/en/refs.fileprocess.process.php](http://php.net/manual/en/refs.fileprocess.process.php)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T21:46:57.287

如果您想从终端运行它并使其永久运行，请查看[GNU screen](http://www.gnu.org/software/screen/)。它是一个虚拟终端，即使您关闭终端，它也会在后台继续运行。

```
$ sudo apt-get install screen 
```

有了这个，你可以简单地做：

```
$ screen php myscript.php 
```

该脚本将加载到`screen`您可以断开连接的会话中，即使您关闭终端，它也会继续运行。要检查它，只需调用：

```
$ screen -x 
```

最好的部分是`screen`免费软件，并且在所有优秀发行版的存储库中（如果 Linux 不让你浮出水面，还有其他 *NIX）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T21:37:42.527

Cron Job 将是一种解决方案： [有关 Cron 作业的更多详细信息。](http://www.thesitewizard.com/general/set-cron-job.shtml)

另一种方法是使用 Gearman 或本文中[的其他任务管理器](https://stackoverflow.com/questions/13802681/php-long-running-background-task)

# java - GWT 中没有可用于 Scribe 的源代码

> ID：16202565
> 
> 赞同：1
> 
> 时间：2013-04-24T21:30:10.423
> 
> 标签：java, xml, gwt, scribe

我在尝试编译我的 GWT 项目时遇到此错误：

```
No source code is available for type org.scribe.oauth.OAuthService; did you forget to inherit a required module? 
```

我在“war/WEB-INF/lib”中包含了 scribe .jar 文件，并将其导入。也许我必须将它添加到 app_name.gwt.xml？我试过这样做，但 Scribe 不包含任何 .gwt.xml 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T04:41:02.740

在 GWT 中，您只能使用一些 java 类，因为不可能将所有 java 类都转换为 javascript。您可以在此链接中找到允许[的课程列表：课程列表](https://developers.google.com/web-toolkit/doc/latest/RefJreEmulation#Package_java_util)

由于兼容性，不可能使用与线程、IO、网络等相关的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T10:36:23.820

我使用 Scribe 没有问题。但它是一个服务器端库。您的 GWT 代码中不应有对它的引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:34:51.180

您必须拥有 Scribe 的 Java 源代码才能让 GWT 编译器对其进行编译（将其翻译成 javascript）。如果它可用，那么您可以将它添加到源代码树中，并在 gwt.xml 文档中指定它是“继承的”。

当然，请查看 Google 的 GWT 论坛以获取任何更新。我知道他们正在努力解决这个问题。

我刚刚检查了一下，Google 提供了 OAuth 作为 GWT 的扩展。那是你最好的解决方案。看这里：

code.google.com/p/gwt-oauth2/

# php - 如何保护 php 中的查询字符串？

> ID：16202574
> 
> 赞同：0
> 
> 时间：2013-04-24T21:30:38.830
> 
> 标签：php, string, urlencode, urldecode

urlencode 和 urldecode 函数在那里，但如果你有一个可以使用 urldecode 函数轻松解码的编码值。

是否有任何其他方法可用于使查询字符串更强大且不易受到攻击。使用散列会很好，但如果可以尝试不使用太多计算。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:34:04.840

听起来您在谈论 URL 字符串而不是查询字符串。保护您不希望用户看到的变量的最佳方法是使用 POST 操作而不是 GET 操作。

的目的`urlencode`不是[提供安全性](http://www.w3schools.com/tags/ref_urlencode.asp)，而是对可能包含特殊字符等的字符串进行编码以传递 GET 请求。

POST 不会将变量存储为 URL 或浏览器历史记录的一部分，因此它更适合发送敏感信息。如果您想真正保护信息免受用户操纵，则必须对其进行散列或加密（例如，密码应在发布*前*进行散列处理）。

[POST 与 GET 比较](http://www.diffen.com/difference/Get_vs_Post)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:35:30.043

请记住，即使使用 POST，您也没有真正向想要获取该数据的人隐藏任何内容。要非常小心您允许在 GET 和 POST 中发送的数据类型。要知道，无论您选择哪一个，最终用户仍然可以对其进行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:35:59.473

[猜猜这是你想看的。](https://stackoverflow.com/questions/129677/whats-the-best-method-for-sanitizing-user-input-with-php) 这将向您展示如何“清理”来自用户的输入，无论它是否来自查询字符串。

我不确定如何发布变量是否更安全...... Chrome 开发工具将解决这个问题。

# c++ - C++ 匿名结构

> ID：16202576
> 
> 赞同：11
> 
> 时间：2013-04-24T21:30:45.520
> 
> 标签：c++, struct, unions, anonymous-struct

我使用以下联合来简化字节、半字节和位操作：

```
union Byte
{
  struct {
    unsigned int bit_0: 1;
    unsigned int bit_1: 1;
    unsigned int bit_2: 1;
    unsigned int bit_3: 1;
    unsigned int bit_4: 1;
    unsigned int bit_5: 1;
    unsigned int bit_6: 1;
    unsigned int bit_7: 1;
  };

  struct {
    unsigned int nibble_0: 4;
    unsigned int nibble_1: 4;
  };

  unsigned char byte;
}; 
```

它工作得很好，但它也会产生这个警告：

> 警告：ISO C++ 禁止匿名结构 [-pedantic]

好的，很高兴知道。但是......如何从我的 g++ 输出中得到这个警告？有没有可能在没有这个问题的情况下写出类似这个联盟的东西？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-24T21:38:40.960

gcc 编译器选项[`-fms-extensions`](http://gcc.gnu.org/onlinedocs/gcc-3.4.4/gcc/C-Dialect-Options.html)将允许非标准匿名结构没有警告。

（该选项启用了它认为的*“Microsoft 扩展”*）

您也可以使用此约定在*有效的 C++中实现相同的效果。*

```
union Byte
{
  struct bits_type {
    unsigned int _0: 1;
    unsigned int _1: 1;
    unsigned int _2: 1;
    unsigned int _3: 1;
    unsigned int _4: 1;
    unsigned int _5: 1;
    unsigned int _6: 1;
    unsigned int _7: 1;
  } bit;
  struct nibbles_type {
    unsigned int _0: 4;
    unsigned int _1: 4;
  } nibble;
  unsigned char byte;
}; 
```

有了这个，你的非标准`byte.nibble_0`就变成了合法的`byte.nibble._0`

# javascript - c3dl getPosition() 返回一个float32array，它代表什么？

> ID：16202581
> 
> 赞同：0
> 
> 时间：2013-04-24T21:31:18.960
> 
> 标签：javascript, webgl

我创建了一个模型鸭并想跟踪它的位置，即 x、y、z 值，下面是我的代码。但是，它返回`[Object Float32Array]`了，我不知道这是什么，如何解释它？

```
duck.getPosition().toString(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T19:06:45.223

而不是使用`duck.getPosition().toString()`use `duck.getPosition()`。
`toString()`不输出类型化数组的实际内容。

# spring - Hadoop 作业输入文件的位置

> ID：16202582
> 
> 赞同：0
> 
> 时间：2013-04-24T21:31:20.987
> 
> 标签：spring, hadoop, spring-data

我正在尝试在我的 Spring 批处理作业中生成一个序列文件以传递给 Hadoop map/reduce。通过手动将文件复制到 hdfs 上，我设法让这项工作开始工作。当它在我的本地系统测试中运行时，它运行良好，因为本地文件系统找到了该文件。但是当我尝试将它部署到远程 Hadoop 实例时，我得到了以下异常。

```
org.apache.hadoop.mapreduce.lib.input.InvalidInputException：输入路径不存在：hdfs://ngram-test:9000/user/hduser/DocumentsPTOgrants2007_2011.seq
    在 org.apache.hadoop.mapreduce.lib.input.FileInputFormat.listStatus(FileInputFormat.java:224)
    在 org.apache.hadoop.mapreduce.lib.input.SequenceFileInputFormat.listStatus(SequenceFileInputFormat.java:55)
    在 org.apache.hadoop.mapreduce.lib.input.FileInputFormat.getSplits(FileInputFormat.java:241)
    在 org.apache.hadoop.mapred.JobClient.writeNewSplits(JobClient.java:885)
    在 org.apache.hadoop.mapred.JobClient.submitJobInternal(JobClient.java:779)
    在 org.apache.hadoop.mapreduce.Job.submit(Job.java:432)
    在 org.apache.hadoop.mapreduce.Job.waitForCompletion(Job.java:447)
    在 com.atsid.hadoop.jobs.AbstractJobRunner.executeJob(AbstractJobRunner.java:70)
    在 com.atsid.hadoop.jobs.AbstractJobRunner.run(AbstractJobRunner.java:36)
    在 org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)
    在 org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:79)
    在 com.atsid.cloudbase.ngram.ingest.mapreduce.NGramIngestJobRunner.main(NGramIngestJobRunner.java:34)
    在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    在 java.lang.reflect.Method.invoke(Method.java:597)
    在 org.springframework.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:191)
    在 org.springframework.data.hadoop.mapreduce.JarExecutor.invokeTargetObject(JarExecutor.java:71)
    在 org.springframework.data.hadoop.mapreduce.HadoopCodeExecutor.invokeTarget(HadoopCodeExecutor.java:185)
    在 org.springframework.data.hadoop.mapreduce.HadoopCodeExecutor.runCode(HadoopCodeExecutor.java:102)
    在 org.springframework.data.hadoop.mapreduce.JarTasklet.execute(JarTasklet.java:32)
    在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    在 java.lang.reflect.Method.invoke(Method.java:597)
    在 org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
    在 org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
    在 org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    在 org.springframework.aop.support.DelegatingIntroductionInterceptor.doProceed(DelegatingIntroductionInterceptor.java:132)
    在 org.springframework.aop.support.DelegatingIntroductionInterceptor.invoke(DelegatingIntroductionInterceptor.java:120)
    在 org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    在 org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
    在 com.sun.proxy.$Proxy43.execute（未知来源）
    在 org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:386)
    在 org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:131)
    在 org.springframework.batch.core.step.tasklet.TaskletStep$2.doInChunkContext(TaskletStep.java:264)
    在 org.springframework.batch.core.scope.context.StepContextRepeatCallback.doInIteration(StepContextRepeatCallback.java:76)
    在 org.springframework.batch.repeat.support.RepeatTemplate.getNextResult(RepeatTemplate.java:367)
    在 org.springframework.batch.repeat.support.RepeatTemplate.executeInternal(RepeatTemplate.java:214)
    在 org.springframework.batch.repeat.support.RepeatTemplate.iterate(RepeatTemplate.java:143)
    在 org.springframework.batch.core.step.tasklet.TaskletStep.doExecute(TaskletStep.java:250)
    在 org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:195)
    在 org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:135)
    在 org.springframework.batch.core.job.flow.JobFlowExecutor.executeStep(JobFlowExecutor.java:61)
    在 org.springframework.batch.core.job.flow.support.state.StepState.handle(StepState.java:60)
    在 org.springframework.batch.core.job.flow.support.SimpleFlow.resume(SimpleFlow.java:144)
    在 org.springframework.batch.core.job.flow.support.SimpleFlow.start(SimpleFlow.java:124)
    在 org.springframework.batch.core.job.flow.FlowJob.doExecute(FlowJob.java:135)
    在 org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
    在 org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:120)
    在 org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:49)
    在 org.springframework.batch.core.launch.support.SimpleJobLauncher.run（SimpleJobLauncher.java:114）
    在 org.springframework.batch.core.launch.support.CommandLineJobRunner.start(CommandLineJobRunner.java:349)
    在 org.springframework.batch.core.launch.support.CommandLineJobRunner.main(CommandLineJobRunner.java:574)

```

这是该步骤使用的 tasklet 配置。我正在尝试使用该`files`属性将输入文件传递给 HDFS。该文件出现在 Hadoop 日志中。

```
<hdp:jar-tasklet id="ingestJarTasklet" scope="step"
                 jar="file:${ingest.job.jar.path}"
                 main-class="com.atsid.cloudbase.ngram.ingest.mapreduce.NGramIngestJobRunner"
                 libs="${ingest.job.libs}"
                 files="#{seqFileLocation.URI.toString()}"
                 configuration-ref="hadoopConfiguration">
    ngram.jobrunner.input.document.sequence.file=${job.file.location}#{seqFileLocation.filename}
</hdp:jar-tasklet> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T11:10:54.210

是你的输入路径`/user/hduser/DocumentsPTOgrants2007_2011.seq`还是你给的`hdfs://ngram-test:9000/user/hduser/DocumentsPTOgrants2007_2011.seq`？

如果您使用第二个，请尝试第一个，并确保它`DocumentsPTOgrants2007_2011.seq`在那里。

您可以通过以下命令查看它是否存在：`hadoop dfs -ls ./`

# java - @XmlElementWrapper 用于未包装的集合

> ID：16202583
> 
> 赞同：19
> 
> 时间：2013-04-24T21:31:21.777
> 
> 标签：java, xml, jaxb

文档声明*@XmlElementWrapper*注释可用于“未包装”或“包装”集合。

[http://docs.oracle.com/javaee/5/api/javax/xml/bind/annotation/XmlElementWrapper.html](http://docs.oracle.com/javaee/5/api/javax/xml/bind/annotation/XmlElementWrapper.html)

您如何配置它以生成未包装的集合？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-04-24T21:47:31.537

如果包含`@XmlElementWrapper`它将添加一个分组元素：

```
@XmlElementWrapper
@XmlElement(name="foo")
public List<Foo> getFoos() {
    return foos;
} 
```

```
<root>
    <foos>
        <foo/>
        <foo/>
    </foos>
</foo> 
```

如果你省略它，那么它不会。

```
@XmlElement(name="foo")
public List<Foo> getFoos() {
    return foos;
} 
```

```
<root>
    <foo/>
    <foo/>
</foo> 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2012/12/jaxb-representing-null-and-empty.html](http://blog.bdoughan.com/2012/12/jaxb-representing-null-and-empty.html)

# c# - 如何调用WebService客户端？

> ID：16202591
> 
> 赞同：3
> 
> 时间：2013-04-24T21:32:09.430
> 
> 标签：c#, asp.net, web-services, web-applications, client-side

我正在尝试使用 javascript 从客户端访问 web 服务。我已经成功创建了 web 服务。我已经成功地在网站项目中使用它，但它是 Web 应用程序项目。

这是我的 HTML 代码

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <script type="text/javascript">
        function Test() {
            WebService1.HelloWorld(onS, onF);
        }
        function onS(r) { alert("Result"); }
        function onF(er) { alert("Error"); }
    </script>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:ScriptManager ID="ScriptManager1" runat="server">
            <Services>
                <asp:ServiceReference InlineScript="true" Path="~/WebService1.asmx"/>
            </Services>
        </asp:ScriptManager>
        <input type="button" value="Call Service" onclick="Test()" />
    </div>
    </form>
</body>
</html> 
```

这是Web服务代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;

namespace TestWebService
{
    /// <summary>
    /// Summary description for WebService1
    /// </summary>
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
    [System.Web.Script.Services.ScriptService]
    public class WebService1 : System.Web.Services.WebService
    {

        [WebMethod]
        public string HelloWorld()
        {
            return "Hello World";
        }
    }
} 
```

现在这段代码不起作用。

我正在使用框架 3.5 和 VS2012。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:47:27.747

我找到了答案。我应该像这样在 Web 服务名称之前使用命名空间

```
function Test() {
    TestWebService.WebService1.HelloWorld(onS, onF);
} 
```

这是网站项目和 Web 应用程序项目之间的区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T02:36:37.530

您可以使用 JQuery 的 AJAX 功能来访问 Web 服务。它易于使用且功能强大。

之前在 stackoverflow.com 上已经回答了类似的问题。这是一个链接供您查看。

[jquery ajax 获取示例](https://stackoverflow.com/questions/1459211/jquery-ajax-get-example)

祝你好运！

# c# - 如何使用 C# 加载 IronPython 脚本，并在执行之前将变量添加到范围

> ID：16202592
> 
> 赞同：1
> 
> 时间：2013-04-24T21:32:14.973
> 
> 标签：c#, ironpython

我有以下代码：

```
m_pyScope = pyRuntime.UseFile(filename); 
```

在 C# 中的 IronPython 运行时中加载脚本文件。

问题是我需要在执行此脚本之前将我的自定义函数、变量等注册到该范围。我现在使用的代码在编译后执行脚本主体。

有没有办法像这样加载 IronPython 脚本：

1.  从文件或文本变量编译
2.  创建空范围（来自 Engine 的 createScope()）
3.  在该范围内做一些事情，例如添加一些功能
4.  执行脚本主体，例如任何函数或类之外的代码

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T14:42:01.370

我找到了解决方案。加载脚本的最佳方法是回答这个问题：

[IronPython 在 C# 中的集成：一个特定的问题/问题](https://stackoverflow.com/questions/5292366/ironpython-integration-in-c-a-specific-problem-question)

从运行时创建引擎，然后作用域，然后编译源代码。之后，您可以调用 source.Execute(scope) 在之前创建的范围内执行脚本

# ruby-on-rails - 什么属于控制器规范，什么属于请求规范？

> ID：16202594
> 
> 赞同：0
> 
> 时间：2013-04-24T21:32:18.963
> 
> 标签：ruby-on-rails, rspec, rabl

使用 Rspec，我正在尝试为我的 API 创建一个控制器规范以及一个请求规范。问题是我不明白每个规范中的测试部分。

为简单起见，假设我的控制器如下所示：

```
class Api::V1::ItemsController < ApplicationController
  def index
    if params[:user_id]
      user = User.find(params[:user_id])
      @items = user.items
    else
      @items = Item.all
    end
  end
end 
```

它使用 RABL 来呈现响应。

对于这么简单的控制器，控制器规范是什么样的？请求规范是什么样的？我在什么时候验证 API 响应 JSON 是我所期望的？等等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T22:47:56.277

对于控制器规范，我会编写如下测试：

```
it "renders with a user_id" do
  get :index, id: @user.id
  assigns(:items).should == @user.items
  response.should be_success
  response.should render_template("index")
end 
```

一个用于`user_id`路径，一个没有。我把设置留给`@user`你；您可以使用固定装置或 FactoryGirl，在前块中实例化一个，或者只是将其全部存根/模拟。如果可以的话，最好避免访问数据库。对于诸如和关联之类的东西，这可能会有点棘手，`Item.all`如果没有存根或持久化到测试数据库，它们就更难连接起来。Mocking 和 stubbing 使得它变得容易，但如果模型发生变化，也会让你的测试变得更加脆弱。

对于请求规范，我将使用 Capybara 创建真正的 DB 对象并执行以下操作：

```
it "lists all items without a user_id" do
  visit foo_path
  current_path.should == foo_path
  page.should have_content(item1.name)
  page.should have_content(item2.name)
end 
```

..和类似的路径与`user_id`. 在不知道您的数据以及如何呈现它的情况下，我无法更具体。如果您使用的是 JSON，则应在此处检查整个 JSON 响应。不过，我不会检查控制器规范中的 JSON 响应；控制器的工作只是将数据洗牌到正确的视图。您也可以单独测试视图，然后在您的请求规范中测试整个端到端场景。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T22:30:16.333

对于控制器规范，您将设置将处理请求身份验证的模拟。您只想测试是否`params[:user_id]`通过，则`@items`设置为用户项目，如果没有，则设置为所有项目。

对于请求规范，您只需包含一些测试来验证身份验证过程。

如果您问我，我将在两个测试中将 api 响应验证为 json。

# html - 动态高度 css 粘页脚

> ID：16202595
> 
> 赞同：1
> 
> 时间：2013-04-24T21:32:27.547
> 
> 标签：html, css, google-chrome, sticky-footer

我最近在寻找一个动态的 CSS 粘性页脚解决方案并遇到了这个： http: [//pixelsvsbytes.com/examples/sticky-footers-the-flexible-way/simple.html](http://pixelsvsbytes.com/examples/sticky-footers-the-flexible-way/simple.html)

它似乎在我尝试过的大多数流行的较新浏览器中都运行良好，但由于某种原因，chrome 并没有以相同的方式显示它，我的猜测是 safari 的行为方式相同。

谁能指出问题可能出在哪里？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:43:33.247

好的，感谢 Explosion Pills 评论，我解决了它。

如果您将 body 标记显示属性设置为 ，则很可能是一个错误`display: table`。

要解决它，只需将元素放在另一个 div 标签内并将其设置为`display: table`

# javascript - 具有 Three.js 动画的多个不同 Collada 场景将无法正常工作

> ID：16202602
> 
> 赞同：0
> 
> 时间：2013-04-24T21:32:52.893
> 
> 标签：javascript, three.js, webgl

我有多个 Collada 格式的模型（knight.dae 和 archer.dae）。我的问题是我无法让它们全部制作动画（假设空闲为 2-3 帧）。当我加载场景时，我要么只得到一个动画模型和一个 stil 模型（没有动画，什么都没有，就像他在 3ds max 中建模一样）。我知道我的问题在于皮肤和变形，但我搜索了很多并没有找到答案，由于我缺乏经验，我的尝试到目前为止都失败了。请帮忙！

```
//animation length of the model is 150(and it hosts 4 different animations)
var startFrame = 0, endFrame = 150, totalFrames = endFrame - startFrame, lastFrame;
var urls = [];
var characters = [];
urls.push('3D/archer/archer.dae');
urls.push('3D/archer/archer.dae');
//here's the loader
loader = new THREE.ColladaLoader();
        loader.options.convertUpAxis = true;
        for (var i=0;i<urls.length;i++) {                           
        loader.load(urls[i],function colladaReady( collada ){
            player = collada.scene;
            player.scale.x = player.scale.y = player.scale.z =10;
            player.position.y=115;
            player.position.z=i*200;
            player.updateMatrix()
            skin = collada.skins [ 0 ];
            //skinArray.push(skin);;
        var mesh=new THREE.Mesh(new THREE.CubeGeometry(10,20,10,1,1,1));
        player.add(mesh);
        characters.push(mesh);
        scene.add( player );
            });
        }
//i added the cube because i use raycaster and it doesnt detect collada obj

// Here is where i try my animation.
        function animate() {
        requestAnimationFrame( animate );
        render();

    }
        function render() {
        update();
        renderer.render(scene,camera);

    }
    function update() {
        var delta = clock.getDelta();
        delta = delta / 2;      
        if ( t > 1 ) t = 0;
        if ( skin )
            {
        skin.morphTargetInfluences[lastFrame] = 0;
        var currentFrame = startFrame + Math.floor(t*totalFrames);
        skin.morphTargetInfluences[currentFrame] = 1;
        t += delta;
        lastFrame = currentFrame;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T11:44:02.083

```
 if ( skinArray[0] && skinArray[1] )
        {
        skinArray[0].morphTargetInfluences[lastFrame] = 0;
        skinArray[1].morphTargetInfluences[lastFrame] = 0;
        var currentFrame = startFrame + Math.floor(t*totalFrames);
        skinArray[0].morphTargetInfluences[currentFrame] = 1;
        skinArray[1].morphTargetInfluences[currentFrame] = 1;
        t += delta;
        lastFrame = currentFrame;
        } 
```

我想出了这段代码，它可以完成工作，但我只是不喜欢它，主要是因为它感觉它是硬编码的。所以如果你们中的任何一个人能想出​​一个更优雅的解决方案，我会更高兴。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T10:32:30.037

尝试这样的事情......在开始时：

```
var skins = []; 
```

在您的 collada 回调中，您似乎已经想到了一些事情：

```
skins.push(collada.skins[0]); 
```

在您的渲染器中，而不是当前的 if (skin) 子句：

```
t += delta;
lastFrame = currentFrame;
var currentFrame = startFrame + Math.floor(t*totalFrames);

for (var i = 0; i < skins.length; i++) {
  var skin = skins[i];
  if (skin) {
    skin.morphTargetInfluences[lastFrame] = 0;
    skin.morphTargetInfluences[currentFrame] = 1;
  }
} 
```

重点是，您需要在 update() 函数中循环所有皮肤。我没有非常仔细地检查帧处理代码，因为这不是问题。如果你的皮肤有不同数量的帧，你需要在你的代码中考虑这些（也许将 lastFrame、currentFrame 等变量设置为匹配的数组皮肤数组）。

# intellij-idea - Intelij Idea (OC4J) 中调试器的超时时间

> ID：16202605
> 
> 赞同：0
> 
> 时间：2013-04-24T21:33:09.840
> 
> 标签：intellij-idea, remote-debugging, oc4j

问题是在调试应用程序时，调试器在大约 30 秒后停止。我该如何配置这个超时？

使用 Intellij Idea 12.0.1 和 OC4J 101330

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T21:22:28.257

您是否尝试过更新版本的想法？Idea有一些调试问题[http://youtrack.jetbrains.com/issue/IDEA-97389](http://youtrack.jetbrains.com/issue/IDEA-97389)

# mysql - 在 MySQL 中检查更新行的最佳方法

> ID：16202612
> 
> 赞同：0
> 
> 时间：2013-04-24T21:33:47.990
> 
> 标签：mysql, performance, comparison, timestamp

我试图查看自上次检查以来是否有任何行更新。我想知道是否有更好的替代品

```
"SELECT id FROM xxx WHERE changed > some_timestamp;" 
```

但是，由于有 200,000 多行，它会很快变得很重……计数会更好吗？

```
"SELECT count(*) FROM xxx WHERE changed > some_timestamp;" 
```

我曾想过创建一个单元测试，但我还不是最擅长的/：

谢谢您的帮助！

* * *

编辑：因为在许多情况下不会有任何更改的行，最好总是先使用 MAX(xx) 进行测试，如果它大于给定的旧更新时间戳，那么进行查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T23:42:15.197

在 some_timestamp 上创建索引并运行：

```
SELECT MAX(some_timestamp) FROM xxx; 
```

如果表是 MyISAM，则查询将立即进行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:40:45.130

如果您只想知道是否*有任何*行已更改，则以下查询可能比您的任何一个都快：

```
SELECT id FROM xxx WHERE changed > some_timestamp LIMIT 1 
```

只是为了完整起见：确保您在`changed`.

**编辑：一个微小的性能改进**

现在我想了想，您可能应该做 a`SELECT change`而不是选择`id`，因为这完全消除了对表*的*访问。如果执行了任何更改，此查询将很快告诉您。

```
SELECT changed FROM xxx WHERE changed > some_timestamp LIMIT 1 
```

它应该比我的第一个查询快一点——不过不会快很多，因为访问单个表行会非常快。

**我应该选择`MAX(changed)`吗？**

正如 Federico 所建议的那样，选择`MAX(changed)`应该几乎会产生相同的索引访问模式。查找索引中的最高元素是一项非常便宜的操作。找到任何大于某个常数的元素可能更便宜，因此两者的性能应该大致相同。在任何一种情况下，当且仅当存在索引时，即使在非常大的表上，这两个查询也非常快。

**我是否应该首先检查是否有任何行被更改，然后在单独的步骤中检索这些行**

不会。如果没有更改的行，`SELECT id FROM xxx WHERE changed > some_timestamp`将与任何此类检查*一样快，*因此单独执行它毫无意义。只有在有结果时才会变成较慢的操作。除非您添加昂贵的操作（例如`ORDER BY`），否则性能应该（几乎）与检索的行数成线性关系。

# sql - 登录DAO sql语句涉及多个join

> ID：16202613
> 
> 赞同：2
> 
> 时间：2013-04-24T21:33:48.310
> 
> 标签：sql, jsf, login, dao

我正在尝试创建一个查询，该查询将通过 DAO 返回输入的用户名和密码是否正确。我使用 java 来实现 DAO 以及 JSF。

我有以下表格：

```
LOGIN: username (pk)
BUSINESS: username (fk), password
CUSTOMER: username (fk), password 
```

我想要做的是创建多个连接，以便当用户登录时，他们存储的用户名定义了他们拥有的帐户类型。通过拉取用户名，在 BUSINESS 和 CUSTOMER 中都会查找用户名，找到后会比较密码。我尝试了以下语句：

```
SELECT l.USERNAME 
FROM ITKSTU.BUSINESS b 
JOIN ITKSTU.LOGIN l 
ON l.USERNAME=b.USERNAME                     
JOIN ITKSTU.CUSTOMER c 
ON c.USERNAME=l.USERNAME
WHERE l.USERNAME='user111' AND (b.PASSWORD='aaa' OR c.PASSWORD='aaa'); 
```

然而它什么也没返回。有什么可能的建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-05T03:02:54.417

我在这里复制了相同的内容，看起来它正在工作。你能检查一下吗？

[http://sqlfiddle.com/#!2/f253d/2](http://sqlfiddle.com/#!2/f253d/2)

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-05T07:29:21.030

如果我理解正确，您需要区分用户的类型，无论他/她是在业务表还是客户表中。然后，检查密码的正确性。

然后，如果我没记错的话，您应该在登录表中为所有用户输入一个条目，然后每个用户都应该在业务表或客户表中发生。

假设我们有如下记录：

```
INSERT INTO login VALUES ('TEST');
INSERT INTO login VALUES ('TEST2');
INSERT INTO business VALUES ('TEST','PASSWORD123');
INSERT INTO customer VALUES ('TEST2','PASSWORD1234'); 
```

我认为您可以通过以下查询解决问题。让我们用名为“TEST2”的用户进行测试：

```
SELECT b.username AS business_user, c.username AS customer_user 
FROM login l
LEFT JOIN business b ON b.username = l.username
LEFT JOIN customer c ON c.username = l.username
WHERE l.username = 'TEST2' AND (b.password = 'PASSWORD1234' OR c.password = 'PASSWORD1234'); 
```

如您所见，此查询将返回 2 列：第一列将返回 null，因为用户不在业务表中。第二个将为您提供用户名并将其标记为“customer_user”。因此，如果您检查每一列并确定哪一列为空，那么您将知道用户实际属于哪里（业务或客户表）。

这里的技巧是从登录表（“FROM login”）开始并使用 LEFT JOIN，而不是 JOIN。如果您需要，这里有一个关于连接及其差异的快速提示：[http ://www.firebirdfaq.org/faq93/](http://www.firebirdfaq.org/faq93/)

# c# - 只读字段上的方法可以修改构造函数之外的方法吗？

> ID：16202614
> 
> 赞同：1
> 
> 时间：2013-04-24T21:33:49.630
> 
> 标签：c#, visual-studio-2012

我在 C# 项目中使用 Visual Studio 2012 Express。我似乎记得在以前版本的 Visual Studio 中情况并非如此，我想知道这是否是一个错误。

在下面的代码中，Empty 是一个静态只读字段，但可以在其构造函数之外使用 Empty.Clear() 进行修改

```
 public struct Box
{
    public static readonly float D = float.MaxValue;
    public static readonly Box Empty = new Box(new Vector3(D, D, D), new Vector3(-D, -D, -D));

    public Vector3 Min;
    public Vector3 Max;

    public Box(Vector3 min, Vector3 max)
    {
        Min = min;
        Max = max;
    }

    public void Clear()
    {
        Min = new Vector3(D, D, D);
        Max = -Min;
        Empty.Clear(); // I seem to remember this should not be allowed
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:35:30.753

您实际上并未修改字段，而是在对象上调用方法。

修改它就像

```
Empty = null; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:35:39.877

该关键字`readonly`仅说明对实例的引用（在引用类型的情况下）只能由构造函数设置。关键字`readonly`没有说明实例内部发生的事情。

在值类型的情况下：`readonly`确保构造函数可以设置值类型，但不确保值类型本身不能从内部更改自己的值。

# kendo-ui - 在非模态窗口中使用模态的问题

> ID：16202621
> 
> 赞同：0
> 
> 时间：2013-04-24T21:34:30.883
> 
> 标签：kendo-ui

我正在尝试在另一个窗口中使用模式窗口作为确认/消息弹出窗口，但有些问题我不确定我是否无法解决。

这是我的情况的一个jsfiddle： [小提琴](http://jsfiddle.net/Zholen/fTrXD/3/)

我要解决的问题是：

1.  在使用模式窗口的同时也使用 appendTo 似乎有背景问题，我看到它在那里，直到你点击其他地方，然后它消失了。

2.  如果我可以在我的窗口而不是窗口中居中模式，那就太好了

3.  即使在模态上禁用了拖动，如果您抓住模态标题栏，它也会移动外部窗口。

4.  如果我单击“X”关闭内部模式，它会关闭我的外部窗口。

任何人都可以就这些问题提出解决方案吗？

```
$('<div id="confirmModal"><div id="confirmWindow">Is This Correct?<p><input type="button" id="btnYes" value="Yes" /><input type="button" id="btnNo" value="No" /></p></div></div>').prependTo('#Window');
$('#confirmWindow').kendoWindow({
  modal: true,
  resizable:false,
  draggable:false,
  appendTo: '#Window',
  close: function() {
    setTimeout(function(){
      $('#confirmWindow').kendoWindow('destroy');
    }, 200);
  }
});

$('#confirmWindow').find('#btnNo').click(function () {
    $('#confirmWindow').kendoWindow('close');
});
$('#confirmWindow').find('#btnYes').click(function () {
    $('#confirmWindow').kendoWindow('close');
}); 
```

**编辑**

我已经编辑了小提琴，因为第一个是我要发布的旧版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:21:03.277

从`appendTo` [文档](http://docs.kendoui.com/api/web/window#configuration-appendTo)：

> Window 将附加到的元素。**请注意，这并不限制在给定元素内拖动窗口**。

因此，Kendo 窗口是浮动的，它们不受您将其附加到的元素的限制。`prepend`这意味着对 HTML 元素的确认窗口然后对同一个元素的确认窗口没有意义`append`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-19T21:12:22.520

检查来自 Telerik 工程师的响应 http://www.kendoui.c​​om/forums/kendo-ui-web/window/kendowindow-appendto- [boundaries.aspx](http://www.kendoui.com/forums/kendo-ui-web/window/kendowindow-appendto-boundaries.aspx)

```
<script type="text/javascript">
    $(document).ready(function () {
        $("#windowName").data("kendoWindow").dragging._draggable.bind("drag", function (e) {

        var wnd = $("#window").data("kendoWindow");
        var position = wnd.wrapper.position();

        var minT = 0;
        var minL = 0;
        //Get the Window width and height and
        //place them in position of the hard-coded width and height
        var maxT = 600 - wnd.wrapper.height();
        var maxL = 900 - wnd.wrapper.width();

        if (position.left < minL) {
            coordinates = { left: minL };
            $(wnd.wrapper).css(coordinates);
        }

        if (position.top < minT) {
            coordinates = { top: minT };
            $(wnd.wrapper).css(coordinates);
        }

        if (position.left > maxL) {
            coordinates = { left: maxL };
            $(wnd.wrapper).css(coordinates);
        }

        if (position.top > maxT) {
            coordinates = { top: maxT };
            $(wnd.wrapper).css(coordinates);
        }
    })
})
</script> 
```

# javascript - 如何嵌入音频

> ID：16202624
> 
> 赞同：2
> 
> 时间：2013-04-24T21:34:39.290
> 
> 标签：javascript, html, audio, soundcloud

我正在尝试设计一个调查猴子调查，其中嵌入了一些音频。就像参加调查的人可以收听音频剪辑一样，并回答有关它的问题。

如何最好地完成它，我不完全确定。在surveymonkey 中，您可以将小的自包含HTML 脚本嵌入到您的问题中（就像博客上的“HTML 小部件”一样）。

我想我可以通过 HTML、Javascript 和 SoundCloud 来完成这一切。就像在 soundcloud 上保留音频并创建一个播放特定音频文件的按钮一样。

所以我会很好，只要我能以一些合乎情理的东西结束`<button type="button" onclick="playClip()">Play</button>`

但！大家的看法是什么……理论上的 Javascript 函数“playClip”应该如何看待，以便它只播放 soundcloud 文件？

（PS - 我不想只是从 soundcloud 中删除 URL。它使播放器变得非常混乱，我想使用其中不少音频剪辑，如果我只是在其中超过六个 url，它会失去很多可用性）

帮我欧比旺克诺比！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:57:52.383

```
function playClip(url){
  if(playClip.aud)playClip.aud.pause(); //stop previous track, if any
  (playClip.aud=new Audio(url)).play(); //load and play url
}

playClip("https://ec-media.soundcloud.com/jhfLh2n9tyEY.128.mp3?ff61182e3c2ecefa438cd02102d0e385713f0c1faf3b0339595665fc0701eb1c8ae8afa5c1059e14eaaf9e74d90a7660706e6a2265abbac2c25c5fcd0f2f1f7fbcfd70b793&AWSAccessKeyId=AKIAJ4IAZE5EOI7PA7VQ&Expires=1366840864&Signature=LmZu8Sgq2k8mfI8ivHGZGqQEj3k%3D"); 
```

# canvas - o带有多个显示对象的画布遮罩

> ID：16202627
> 
> 赞同：0
> 
> 时间：2013-04-24T21:34:47.320
> 
> 标签：canvas, html5-canvas, masking

我正在使用 oCanvas 创建遮盖图像的三角形，每个三角形遮盖不同的图像。我面临的问题是，当我掩盖这些三角形时，它们隐藏了它外面的任何东西，所以最后一个三角形掩盖了下面的三角形。有没有办法避免在其他地方显示透明度？我想它与 globalCompositeOperation 中的“xor”相反。

这是我的代码：

```
 var canvas = oCanvas.create({
        canvas: "#canvas",
        background: "#0cc"
    });

    var center = canvas.display.ellipse({
        x: canvas.width / 2, y: canvas.height / 2,
        radius: canvas.width / 3,
        fill: "#fff"
    }).add();

    var radius = canvas.width / 3;
    var x = canvas.width / 2;
    var y = canvas.height / 2;

    var image = canvas.display.image({
        x: 0,
        y: 0,
        origin: { x: "center", y: "top" },
        image: img,
        rotation: 120
    });

    center.addChild(image);

    var triangle = canvas.display.polygon({
        x: -canvas.width / 3,
        y: -canvas.width / 6,
        sides: 3,
        radius: 70,
        fill: "#0aa",
        rotation: 30,
        composition:"destination-atop"
    });

    center.addChild(triangle);

    var image1 = canvas.display.image({
        x: 0,
        y: 0,
        origin: { x: "center", y: "top" },
        image: img,
        rotation: 180
    });

    image1.scale(-1, 1);

    center.addChild(image1);

    var triangle1 = canvas.display.polygon({
        x: 0,
        y: -canvas.width / 3,
        sides: 3,
        radius: 70,
        fill: "#aaa",
        rotation: 90,
        composition:"destination-atop"
    });

    center.addChild(triangle1); 
```

如果我不使用合成，但当我使用合成时，我所有的三角形和图像都会正确显示：“destination-atop”做了我想做的事情，但它隐藏了三角形之外的任何东西。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T07:36:28.440

我必须首先承认，我在制作 oCanvas 时并没有在构图中投入太多精力。它没有经过很好的测试，可能会以更好的方式完成。

composition 属性在 oCanvas 中的作用是它只是在绘制所有对象时在本机画布 API 中设置 globalCompositeOperation 属性（[https://github.com/koggdal/ocanvas/blob/develop/src/draw.js#L161](https://github.com/koggdal/ocanvas/blob/develop/src/draw.js#L161)） .

您正在谈论的效果是，如果我理解它对“destination-atop”是正确的。从[https://developer.mozilla.org/en-US/docs/HTML/Canvas/Tutorial/Compositing](https://developer.mozilla.org/en-US/docs/HTML/Canvas/Tutorial/Compositing)，该值表示“现有画布仅保留在与新形状重叠的位置。新形状绘制在画布后面内容。”。

你想要的效果是什么？你想让图像作为三角形的背景吗？然后您可以将填充属性设置为图像： http: [//ocanvas.org/docs/Display-Objects/Base#property-fill](http://ocanvas.org/docs/Display-Objects/Base#property-fill)

# php - 当产品具有自定义选项时，Magento 数量字段不起作用

> ID：16202629
> 
> 赞同：0
> 
> 时间：2013-04-24T21:34:57.960
> 
> 标签：php, magento

我对 Magento 中的 qty box 有一个奇怪的问题。无论我在数量框中输入什么数字，只有 1 件商品被转移到购物车中。

我发现，如果我删除所有产品选项（例如颜色/尺寸等），它可以正常工作，并且我输入的任何数量都会转移到购物车，但使用产品选项它不起作用。

我已经检查了这个[Magento 数量字段](https://stackoverflow.com/questions/2958750/magento-quantity-field-doesnt-work)没有运气就无法工作。

这是一个简单的产品，我没有更改 addtocart.phtml 中的任何内容

有什么建议吗？

# java - Eclipse 运行配置本地文件

> ID：16202632
> 
> 赞同：0
> 
> 时间：2013-04-24T21:35:20.380
> 
> 标签：java, eclipse, properties

尝试查找属性文件的运行时异常。属性文件存在并在启动配置中指向：

```
-Dconfig.home="C:\development\eclipse workspace\config" 
```

我有几个其他目录指向它们不会导致问题。我得到这个堆栈跟踪：

```
Caused by: java.net.MalformedURLException: unknown protocol: c

    at org.springframework.web.context.ContextLoader.customizeContext(ContextLoader.java:499)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:384)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:284)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4206)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4705)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Caused by: java.net.MalformedURLException: unknown protocol: c
    at java.net.URL.<init>(URL.java:574)
    at java.net.URL.<init>(URL.java:464)
    at java.net.URL.<init>(URL.java:413)
    at 

... 20 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:39:08.127

我想到了。编辑启动配置 VM 参数：

运行->运行配置...->Tomcat 6.0（你的服务器）->参数->虚拟机参数

本地文件引用应如下所示：

```
-Dconfig.home="file:\\\development\eclipse workspace\config" 
```

是的，就是连续三个斜线来逃避“逃逸斜线”

或者，对于 OSX：

```
-Dconfig.home="file:///Users/gwn719/Documents/conf" 
```

# c# - 在 C# 中保存 Jpeg 图像会更改像素

> ID：16202633
> 
> 赞同：0
> 
> 时间：2013-04-24T21:35:25.790
> 
> 标签：c#, image, image-processing, jpeg, steganography

我编写了自己的代码来实现隐写术项目来隐藏图像中的文本。该代码完美运行。

但是当我将图像保存到 jpeg 文件并再次打开时，数据丢失，并且我得到一个垃圾结果文本（好像像素没有正确保存到新图像中）

![在此处输入图像描述](https://i.stack.imgur.com/bkF8e.jpg)

但是当我将图像保存为 Bmp 格式时，我可以完美地得到隐藏的文本，就好像像素正确保存到输出图像中一样：

![在此处输入图像描述](https://i.stack.imgur.com/plztV.jpg)

那么问题出在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:54:16.180

您需要使用无损 jpeg，很少有库可以做到这一点（Pegasus、LeadTools）如果您不能使用它们中的任何一个，那么您需要使用 PNG。.Net 中的 Stock Jpeg 压缩是有损的，因此像素不会相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T08:16:21.260

如果您想将隐写术与有损压缩方法（如 JPEG）一起使用，那么您现有的算法显然不够稳健。

要查看在这种情况下如何*使用*隐写术的示例，请查看[开源 F5-隐写术项目](http://code.google.com/p/f5-steganography/)

# ios - 调整 UIImageView 的大小

> ID：16202639
> 
> 赞同：-1
> 
> 时间：2013-04-24T21:35:59.153
> 
> 标签：ios, objective-c, uiimageview, cgrect

我有一个观点`UIImageView`。我正在从我的服务器中检索 300 像素宽和 100 像素高的图像。但是，当我将图像插入到 my`UIImageView`中时，图像会被拉伸到图像视图的大小。

代码`viewDidLoad:`

```
id path = @"URL TO IMAGE";
NSURL *url = [NSURL URLWithString:path];
NSData *data = [NSData dataWithContentsOfURL:url];
UIImage *img = [[UIImage alloc] initWithData:data];

CGRect frame = [imageView frame];
frame.size.width = 300;
frame.size.height = 100;
[imageView setFrame:frame];

self.imageView.image = img; 
```

但是，`UIImageView`大小不会更改为我上面代码的第 6 行和第 7 行中的值。

我很感激任何建议，我对 Objective-C 很陌生。

。H：

```
#import <UIKit/UIKit.h>

@interface detailViewController : UIViewController
@property (strong, nonatomic) IBOutlet UIImageView *imageView; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:37:40.597

您需要设置 UIImageView 的`contentMode`. 查看 UIView 文档`contentMode`以了解您可以使用的不同值。例如，`UIViewContentModeScaleToFill`拉伸图像以完全匹配 UIImageView 的大小；`UIViewContentModeCenter`根本不会改变图像的大小；等等。

编辑：至于 UIImageView 本身，您需要确保您的引用都正确指向同一个 UIImageView 并且这是来自笔尖的同一个 UIImageView。此外，如果在笔尖上启用了 Autolayout，您`setFrame:`将不会有任何效果，因为框架是由约束决定的。

# lisp - Lisp 程序产生合同违约

> ID：16202642
> 
> 赞同：2
> 
> 时间：2013-04-24T21:36:04.053
> 
> 标签：lisp, scheme, binary-search-tree

我写了一个 lisp 程序，它接受两个参数，一个目的地和一个 BST 形式的映射。它在 BST 中搜索目标号码，如果找到目标，则打印 (found: path)。如果未找到，则应打印（未找到：目的地），但由于某种原因，我违反了合同。它没有正确地通过我的条件，我已经搞砸了三十分钟。任何人都可以帮忙。

这是我的程序：

```
(define (robot goal map)
  [code hidden for university honour code purposes]

; Test robot function
(robot 64 '(53 () (64 () ())))
(robot 4 '(53 () (64 () ()))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:41:22.603

您在程序中遗漏了一个案例`(define (robot map path) ...)`。如果`map`参数是会发生什么`null`？像这样修复它：

```
(define (robot map path)
  (cond ((not (null? map))
         [code hidden for university honour code purposes])
        (else '()))) ; this line was missing! 
```

这与我在回答您上一个问题时提到的完全相同：无论您是遍历列表还是树，始终要考虑的第一个情况是：如果它为空会发生什么？

# jquery - jquery $(elem) + 特定的类标识符

> ID：16202646
> 
> 赞同：0
> 
> 时间：2013-04-24T21:36:12.980
> 
> 标签：jquery, jquery-selectors

这在 jQuery 中可能吗？

```
$(elem).('.class').html("new data"); 
```

我需要更改当前元素上的类的 HTML，因为有多个元素具有此类。我只想更改该特定元素上的类的 HTML。我尝试使用`.parent()`最近的孩子，但无济于事。

该函数由位于 tr 内的 td 内的选择标记调用，而我要更改的数据位于下一个 tr 中，因此如下所示：

```
<tr>
    <td>select</td>
    <td></td>
    <td></td>
</tr>
<tr>the td's which htmls i want to change</tr> 
```

另请注意，`<tr>`可以多次添加保持选择，因此将有超过 1 个选择，因此该`$(elem)`部分。每当添加包含选择的新 tr 时，也将添加包含 td 的 tr，因此这是一个示例 html 代码：

生成的 HTML 代码：

```
 <tr class="action-row">
 <td valign="top">CRM Action:&nbsp;&nbsp;&nbsp;</td>
      <td valign="top"><select name="crm_action[]">
 <option value="add">Add to Group</option>
 <option value="transfer">Transfer to Group</option>
 </select>
 </td>
 <td valign="top">Action:&nbsp;&nbsp;&nbsp;</td>
 <td valign="top">
 <select name="funnel_type[]" class="funnel-type" onchange="type_switch(this)">
 options to determine what to display in this tr onchange
 </select>
 </td>
 <td>
 <img src="somewhere/action_delete.png" title="Delete" onclick="delete_row(this)"     style="cursor: pointer;"></td>
 </tr>
 //this part should have been inside the above tr as you can see it the php code above
 <tr class="actionrow odd">
 <td class="type-label" valign="top"></td>
 <td class="type-selection" valign="top"></td>
 <td class="type-button" valign="top" align="right" colspan="2"></td>
 </tr>
 //end              
 <tr class="action-row">
 <td valign="top">CRM Action:&nbsp;&nbsp;&nbsp;</td>
 <td valign="top">
 <select name="crm_action[]"><option value="add">Add to Group</option>
 <option value="transfer">Transfer to Group</option>
 </select>
 </td>
 <td valign="top">Action:&nbsp;&nbsp;&nbsp;</td>
 <td valign="top">
 <select name="funnel_type[]" class="funnel-type" onchange="type_switch(this)">
 another options
 </select>
 </td>
 <td>
 <img src="somewhere/action_delete.png" title="Delete" onclick="delete_row(this)"      style="cursor: pointer;">
 </td>
      </tr>
 <tr class="actionrow odd">
 <td class="type-label" valign="top"></td>
 <td class="type-selection" valign="top"></td>
 <td class="type-button" valign="top" align="right" colspan="2"></td>
 </tr> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:37:30.850

你在找`find`吗？

```
$(elem).find('.class').html("new data"); 
```

`children`挖一层，`find`直到它到达“叶子”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:38:42.357

取决于 elem 是否为变量。

```
 $('elem.class').html("new data"); 
```

或者

```
 $(elem).find('.class').html("new data"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:39:09.243

您可以通过选择元素来做到这一点

```
$("div") // Can be whatever you want 
```

然后像在 CSS 中一样在它之后添加类

```
$("div.class") 
```

最后，调用元素上的`html()`或方法`text()`

```
$("div.class").html("new data") 
```

[小提琴](http://jsfiddle.net/CqRH4/)

# android - pendingAlarmIntent.cancel() 还是 AlarmManager.cancel(pendingAlarmIntent)？

> ID：16202651
> 
> 赞同：2
> 
> 时间：2013-04-24T21:37:08.753
> 
> 标签：android, alarmmanager, android-pendingintent, android-alarms

我只是在看如何取消警报，我遇到了这两种方法。在什么情况下应该使用哪一个，为什么？他们都一样吗？

我目前正在这样做：

```
Intent alarmIntent = new Intent(ChangeAlarmActivity.this, AlarmReceiver.class);                         
PendingIntent pendingAlarmIntent = PendingIntent.getBroadcast(ChangeAlarmActivity.this, (int)alarm.getID(),
        alarmIntent, 0);
pendingAlarmIntent.cancel(); 
```

这与下面的有什么不同？

```
Intent alarmIntent = new Intent(ChangeAlarmActivity.this, AlarmReceiver.class);                         
PendingIntent pendingAlarmIntent = PendingIntent.getBroadcast(ChangeAlarmActivity.this, (int)alarm.getID(),
        alarmIntent, 0);
AlarmManager alarmManager = (AlarmManager)getSystemService(ALARM_SERVICE);
alarmManager.cancel(pendingAlarmIntent); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:45:16.940

> 他们都一样吗？

不。

如果您想取消闹钟，请拨打`cancel()`。`AlarmManager`

`cancel()`on`PendingIntent`可能会出现相同的效果——无论你的警报事件应该触发什么都不再发生。但是，您假设它`AlarmManager`会检测到这一点并在其一侧进行清理，这是无法保证的。特别是对于`_WAKEUP`警报，这可能会导致设备被无缘无故地唤醒，从而浪费电池寿命。

> 在什么情况下应该使用哪一个，为什么？

我确信`cancel()`on`PendingIntent`有用例。我无法命名任何具体的，因为我从未见过它使用过。通常，当您使用 a 时`PendingIntent`，任何“取消”语义都在*使用*（`PendingIntent`例如，您`cancel()`通过警报`AlarmManager`，您`cancel()`通过通知`NotificationManager`），而不是在其`PendingIntent`本身上。

`cancel()`因此， on 的一个地方`PendingIntent`是你传递 a`PendingIntent`并且没有“取消”来恢复它的地方，或者你明确希望`cancel()`用作恢复机制。例如，如果您正在创建某种插件机制，并且插件向主机`PendingIntent`应用程序发送一个并得到了例外。就个人而言，我不是这个的忠实拥护者——大致上，如果主机应用程序无法正确处理这种情况，您不知道主机应用程序可能会使用哪些资源。但是，如果使用得当，它当然可以工作。`cancel()``PendingIntent``send()``PendingIntent``AlarmManager`

> 这与下面的有什么不同？

“下面”是我建议您使用的。

# java - 用 Java 或 Javascript 播放 BIOS 声音（带有 PC 扬声器）

> ID：16202652
> 
> 赞同：1
> 
> 时间：2013-04-24T21:37:11.940
> 
> 标签：java, javascript, audio, bios

是否可以使用 Javascript 或 Java 播放基本的 BIOS 声音？
我需要可以在没有声卡的 PC 上播放的声音。
每台 PC 都有内置的 PC 扬声器，在这种情况下很有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:14:26.100

我会使用 Java 并执行一个外部程序：

```
Runtime.getRuntime().exec("beep.exe"); //not sure Beep.exe is a real thing 
```

执行哪个程序？不确定，但在这里寻找灵感：

[https://superuser.com/questions/227939/how-to-make-the-pc-speaker-beep-from-the-windows-7-command-prompt](https://superuser.com/questions/227939/how-to-make-the-pc-speaker-beep-from-the-windows-7-command-prompt)

或自己编写：

[http://www.frank-buss.de/beep/](http://www.frank-buss.de/beep/)

请注意，使用 exec 本质上是特定于平台的，因此在 Java 中不受欢迎。但是，您尝试做的是特定于平台的操作，因此这是您的最佳选择。

其他值得尝试/思考的事情：

```
java.awt.Toolkit.getDefaultToolkit().beep(); 
```

但我认为声卡上会发出哔哔声。

和

```
System.out.print( (char)7 ); 
```

但我不确定这是否会一直有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T23:02:09.507

`pyx4j-native` [图书馆](http://pyx4j.com/pyx4j-native/index.html)对我很有帮助。

```
 <dependency>
     <groupId>com.pyx4j</groupId>
     <artifactId>pyx4j-native</artifactId>
     <version>1.0.1</version>
  </dependency> 
```

它有[Beep](http://pyx4j.com/pyx4j-native/apidocs/com/pyx4j/jni/Beep.html)类方法[beep(int,int)](http://pyx4j.com/pyx4j-native/apidocs/com/pyx4j/jni/Beep.html#beep%28int,%20int%29)。

使用这个库可以轻松播放任何声音！

# c# - 如何下载 Microsoft.Bcl.Async 包

> ID：16202655
> 
> 赞同：1
> 
> 时间：2013-04-24T21:37:31.683
> 
> 标签：c#, async-await

在我的工作场所，我们不允许从 Nuget 安装软件包，所以我只是想知道是否有任何地方可以下载安装程序，以便内部打包团队可以将其分发到整个公司。

包装生产准备好了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:39:30.933

不幸的是，`Microsoft.Bcl.Async`仅通过 NuGet 分发。您需要使用包管理器来获取程序集，尽管您可以手动将程序集复制到您的系统中。

> 包装生产准备好了吗？

是的，它现在可以生产了。BCL 团队刚刚宣布这个[包现在被认为是稳定](http://blogs.msdn.com/b/bclteam/archive/2013/04/17/microsoft-bcl-async-is-now-stable.aspx)的。从他们的帖子：

> 稳定意味着该包的所有者声明 API 和功能不太可能更改，因此适合在生产中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:39:33.283

您可以从另一台 PC 下载包（不工作），然后复制程序集。当然，您不会从 NuGet 获得额外的好处，但它仍然是一个可行的选择。

**编辑**几天前刚刚看到，正如 Reed 正确指出的那样，该软件包被宣布为稳定。

# javascript - 从现有的 img 中弹出图像并查看大图

> ID：16202661
> 
> 赞同：0
> 
> 时间：2013-04-24T21:37:50.350
> 
> 标签：javascript, jquery, css, struts2

我已经在jsp中从不同类型的服务器加载了文件，现在我想要点击弹出的图像文件，我知道我可以再次向服务器请求数据和弹出，我想知道有没有办法扩大现有的来自 img 标签的图片？我做了一些这样的事情，目前能够看到缩略图。

```
<s:iterator value="furls" var="file">
            <div id="img_holder">
                <img src="<s:property value="#file.url"/>" onError="this.onerror=null;this.src='images/no_preview.png';" alt="" height="100" width="100"/>
                <span id="text"><a href="<s:property value="#file.url"/>"><s:property value="#file.name"/></a></span>
            </div>
</s:iterator> 
```

谢谢并恭祝安康

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:29:06.347

试试这个[- jsFiddle](http://jsfiddle.net/apaul34208/pTARc/3/)

css

```
.scale {
    height:100px;
    width:300px;
    transition:all 2s;
} 
```

js

```
$(document).ready(function () {
    $('img').click(function () {
        $('img').toggleClass('scale');
    });
}); 
```

# yii - Active Record-如何选择具有关系的列？

> ID：16202662
> 
> 赞同：0
> 
> 时间：2013-04-24T21:37:52.837
> 
> 标签：yii

项目可以有无限数量的列（形成一个表或其他东西），关系 MANY 到 MANY。为了实现这`tbl_project_rel_column`一点，创建。它`stores project_id`，与项目表中列的`column_id`pos**位置。**

我正在使用 AC 数据库方法。我有 2 个模型项目和列。

项目模型的关系方法：

```
public function relations(){
   return array(
...
'columns'=>array(self::MANY_MANY,'Column','tbl_project_rel_column('p_id','c_id')
);
} 
```

现在可以使用以下方式获取所有项目的列：

```
$model = Project::model()->findbyPk($p_id);
$columns = $model->columns; 
```

但是列不存储它的某个项目的“pos”（位置）值。

如何获取某个项目和某个列的 tpl_project_rel_column 表的“pos”值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T06:49:01.420

您可以使用该[`through`](http://www.yiiframework.com/doc/guide/1.1/en/database.arr#relational-query-with-through)功能而不是`MANY_MANY`. [按列索引](http://www.yiiframework.com/doc/guide/1.1/en/database.arr#relational-query-options)结果也可能很有用`position`。尝试这样的事情：

```
public function relations()
{
    return array(
        'projectColumns' => array(self::HAS_MANY, 'ProjectRelColumn', 'p_id', 'index'=>'position'),
        'columns' => array(self::HAS_MANY, 'Column', 'c_id', 'through'=>'projectColumns'),
} 
```

现在您可以查询具有如下列的项目：

```
$projects = Project::model()->with('columns')->findAll();
foreach($projects as $project) {
    // projectColumns are indexed by position. You can sort by this now:
    ksort($project->projectColumns)
    foreach($project->projectColumns as $pos => $projectColumn)
        echo "Pos: $pos Column: {$projectColumn->column->name}";
} 
```

# c# - ServiceStack 嵌套数组错误：KeyValueDataContractDeserializer：转换为类型时出错：类型定义应以“{”开头

> ID：16202663
> 
> 赞同：2
> 
> 时间：2013-04-24T21:37:54.510
> 
> 标签：c#, rest, angularjs, servicestack

尝试将嵌套数组发布到 ServiceStack 休息端点时出现错误。

我得到的错误是：

> KeyValueDataContractDeserializer：转换为类型时出错：类型定义应以“{”开头，期望序列化类型“DeployServer”，字符串以：object Object] 开头”

我的班级结构如下：

```
public class DeployEnvironment
{
    public string Id { get; set; }
    public string ProjectId { get; set; }
    public string EnvironmentName { get; set; }
    public List<DeployServer> ServerList { get; set; }

    public DeployEnvironment()
    {
        this.ServerList = new List<DeployServer>();
    }
}
public class DeployServer
{
    public string Id { get; set; }
    public string EnvironmentId { get; set; }
    public string ServerName { get; set; }
} 
```

邮政编码很简单：

```
public object Post(DeployEnvironment environment)
{
    if (string.IsNullOrEmpty(environment.Id))
    {
        return _projectManager.CreateEnvironment(environment.ProjectId, environment.EnvironmentName, environment.ServerList);
    }
    else
    {
        return _projectManager.UpdateEnvironment(environment.Id, environment.ProjectId, environment.EnvironmentName, environment.ServerList);
    }
} 
```

这是我发送的 JSON，对我来说看起来不错：

```
{
  "id": "300b1bd2-af16-47bb-a167-407ec8966167",
  "projectId": "03b5635a-7eb8-4aeb-80e0-461f29c4488c",
  "environmentName": "QA",
  "serverList": [
    {
      "id": "6024e867-f858-47cb-93f4-dd592adb02af",
      "environmentId": "300b1bd2-af16-47bb-a167-407ec8966167",
      "serverName": "Server1"
    },
    {
      "id": "efcc3a14-3d4a-4990-b106-d5a81188ee04",
      "environmentId": "300b1bd2-af16-47bb-a167-407ec8966167",
      "serverName": "Server2"
    }
  ]
} 
```

事实上，这与我从 get 中提取的 JSON 相同，我只是想把它发回

有什么我做错了吗？

谢谢

**使用原始 HTTP 请求更新：**

```
POST http://local-host:55052/api/project/03b5635a-7eb8-4aeb-80e0-461f29c4488c/environment?environmentName=QA&id=300b1bd2-af16-47bb-a167-407ec8966167&serverList=%5Bobject+Object%5D,%5Bobject+Object%5D HTTP/1.1
Host: local-host:55052
Connection: keep-alive
Content-Length: 382
Accept: application/json, text/plain, */*
Origin: http://local-host:55052
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.64 Safari/537.31
Content-Type: application/json;charset=UTF-8
Referer: http://local-host:55052/
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3
Cookie: ltkmodal-Modal%20Signup=Thu%2C%2024%20Jan%202013%2021%3A47%3A32%20GMT; __test=1; ss-pid=uUvKs0YDGCPIHP1yhaUg; ss-id=7Oz3jNCeXDVoLaGT4+BM; __ngDebug=true; JSESSIONID=09245EF568D4507A3635664A6E8671DA; RememberMe=1180157474^2#-6059067053273955846

{"id":"300b1bd2-af16-47bb-a167-407ec8966167","projectId":"03b5635a-7eb8-4aeb-80e0-461f29c4488c","environmentName":"QA","serverList":[{"id":"6024e867-f858-47cb-93f4-dd592adb02af","environmentId":"300b1bd2-af16-47bb-a167-407ec8966167","serverName":"Server1"},{"id":"efcc3a14-3d4a-4990-b106-d5a81188ee04","environmentId":"300b1bd2-af16-47bb-a167-407ec8966167","serverName":"Server2"}]} 
```

**回答** 感谢mythz 的回答，他是对的，我是重复发帖的。问题是我调用 AngularJS 资源库以这种方式保存：

```
$scope.environment.$save($scope.environment); 
```

我应该这样称呼它：

```
var saveParams = {
    id: $routeParams.environmentId,
    projectId: $routeParams.projectId
};
$scope.environment.$save(saveParams); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T23:11:25.037

您在 QueryString 和请求正文中双重发布请求。在 QueryString 中使用[JSV 格式](https://github.com/ServiceStack/ServiceStack.Text/wiki/JSV-Format)解析复杂类型时。

将 URL 更改为仅选定的路由，即：

```
/api/project/03b5635a-7eb8-4aeb-80e0-461f29c4488c/environment 
```

然后解析请求正文应该没问题，例如：

```
var json = @"{""id"":""300b1bd2-af16-47bb-a167-407ec8966167"",""projectId"":""03b5635a-7eb8-4aeb-80e0-461f29c4488c"",""environmentName"":""QA"",""serverList"":[{""id"":""6024e867-f858-47cb-93f4-dd592adb02af"",""environmentId"":""300b1bd2-af16-47bb-a167-407ec8966167"",""serverName"":""Server1""},{""id"":""efcc3a14-3d4a-4990-b106-d5a81188ee04"",""environmentId"":""300b1bd2-af16-47bb-a167-407ec8966167"",""serverName"":""Server2""}]}";
var dto = json.FromJson<DeployEnvironment>();

dto.PrintDump(); 
```

输出：

```
/*
{
    Id: 300b1bd2-af16-47bb-a167-407ec8966167,
    ProjectId: 03b5635a-7eb8-4aeb-80e0-461f29c4488c,
    EnvironmentName: QA,
    ServerList: 
    [
        {
            Id: 6024e867-f858-47cb-93f4-dd592adb02af,
            EnvironmentId: 300b1bd2-af16-47bb-a167-407ec8966167,
            ServerName: Server1
        },
        {
            Id: efcc3a14-3d4a-4990-b106-d5a81188ee04,
            EnvironmentId: 300b1bd2-af16-47bb-a167-407ec8966167,
            ServerName: Server2
        }
    ]
}
*/ 
```

# wordpress - Wordpress - 从 URL 中删除父母的 slug

> ID：16202664
> 
> 赞同：2
> 
> 时间：2013-04-24T21:37:55.060
> 
> 标签：wordpress, url, parent-child

我正在尝试从 Wordpress 中的 URL 中删除父页面的 slug。即，而不是：

[http://domain.com/grandparent/parent/child](http://domain.com/grandparent/parent/child)

我需要网址：

[http://domain.com/child](http://domain.com/child)

任何人都知道如何做到这一点？谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-24T22:21:17.290

您可以通过更改您的[Wordpress 永久链接](http://codex.wordpress.org/Using_Permalinks#Choosing_your_permalink_structure)结构来更改您的网站生成的链接

从您的仪表板

```
Settings > Permalinks 
```

# coq - coqide - 无法从同一文件夹加载模块

> ID：16202666
> 
> 赞同：22
> 
> 时间：2013-04-24T21:37:58.107
> 
> 标签：coq

我无法加载 CoqIde 中同一文件夹中的模块。

我正在尝试从 Software Foundations 加载源代码，我在包含带有`coqide`or的 SF 源代码的文件夹中运行 coqide `coqide ./`，然后在打开并运行文件后，出现此错误：

```
Error: Cannot find library Poly in loadpath 
```

在这一行：

```
Require Export Poly. 
```

其他所有`require`命令都一样。

那么你们是如何将 SF 中的程序加载到 coqide 中的呢？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-04-24T23:01:35.847

如果需要，您需要将 .v 文件编译为 .vo 文件并将其目录添加到加载路径中。要编译它们，`coqc <file-path>`请在命令提示符下运行。要将文件的目录添加到 CoqIde 中的加载路径，您可以`Add LoadPath "<directory-path>".`在 .v 文件的开头插入该行。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-03-22T22:02:29.980

我意识到这是一个旧线程，但是关于这个问题的资源并不多。我只是花了一些时间来解决它，所以我认为将它发布在我从谷歌搜索得到的第一个主题上会很好。我在 Arch Linux 上使用 Coq 8.4p16 编译，没有额外的配置。

所以，手册说变量像`$COQPATH, ${XDG_DATA_DIRS}/coq/`和`${XDG_DATA_HOME}/coq/`被检查，但是我对这些没有运气。

我也试过把`coqc -I /folder/path`CoqIde放在`Edit->Preferences->Externals`那里，但是仍然没有运气。

我写这些是因为它们可能为某人工作。

唯一对我有用的全局方法是在其中编写一个 coqrc 文件`Add LoadPath "<directory-path>".`。在 Linux 上，该文件需要位于主文件夹中。

希望这可以节省一些时间。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-06-29T14:21:58.563

为了能够在 coqtop、coqc、CoqIDE 或 Proof General 中加载源文件，有几种方法，一种方法如下：

假设您已经下载了 Adam Chlipala 编写的名为*Certified Programming with Dependent Types的书的代码文件，这些文件可*[在此处](http://adam.chlipala.net/cpdt/)获得，并将它们提取到我们称为 CODEHOME 的路径中。如您所见，任何源文件中都有第一行`Require Import Bool Arith List Cpdt.CpdtTactics.`

首先输入`coqc -v`cli（命令行界面），输出类似于`The Coq Proof Assistant, version 8.4pl4 ....`，然后创建一个名为***coqrc.8.4pl4***的文件，文件扩展名应与您使用的 coq 的版本一致，在 $HOME/ 中。 config/coq 目录，如果它不存在并将这一行写入其中，仅此`Add LoadPath "CODEHOME/cpdt/src" as Cpdt .`而已。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-05-17T13:32:46.187

如果你开始你`file.v`的`Module file.`只是摆脱它（也摆脱它`End file.`），你的问题就解决了。

# java - 使用循环创建 java jbuttons

> ID：16202668
> 
> 赞同：0
> 
> 时间：2013-04-24T21:38:07.620
> 
> 标签：java, swing, loops, dynamic, jbutton

我正在开发一个要创建 x 数量的 jbuttons 的程序。x 在文本文件中声明，每个 jbutton 都与一个数字相关联，该数字将显示在 jbutton 上。我假设最好的方法是使用循环，但我真的不明白如何做到这一点。我可以在 jbutton 名称后面加上与 jbutton 关联的数字，以便每个 jbutton 都有一个不同的名称吗？谁能为我解释一下如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:43:27.443

可能最好的方法是使用数组（如果您在创建它们之前知道有多少）或列表。

就像是：

```
List<JButton> buttons = new ArrayList<JButton>();
while (haveMoreButtonsToCreate) {
  buttons.add(new JButton());
} 
```

# grails - 在 Groovy 中覆盖 Joda DateTime toString

> ID：16202669
> 
> 赞同：1
> 
> 时间：2013-04-24T21:38:09.887
> 
> 标签：grails, groovy, jodatime, grails-plugin

所以我在我正在实施的 grails 项目中使用 JodaTime 插件，我真的不喜欢它在我执行 toString 时吐出 ISO8601 日期格式。我一直在不断地放入 toString 并从消息文件中传递 default.date.format，但这很麻烦。大多数情况下，我只是希望它自动执行此操作。因此，利用 Groovy 出色的元编程来覆盖 DateTime 类上的 toString 是很自然的。但很遗憾，它不起作用。因此，这个讨论：

[http://jira.codehaus.org/browse/GROOVY-4210](http://jira.codehaus.org/browse/GROOVY-4210)

所以根据上述讨论，如果我们的类实现了一个接口来实现 toString 方法，我们需要重写接口的元类。查看 joda 代码库，DateTime 实现了 ReadableDateTime 接口，该接口又继承自 ReadableInstant，这是定义方法签名的地方。实际实现是在 DateTime 的类层次结构中完成 4 个类（DateTime 继承自 BaseDateTime 继承自 AbstractDateTime 继承自 AbstractInstant ，它实现了无参数的 toString）。跟我到现在？

所以理论上这意味着我应该覆盖实际上没有 toString 签名的 ReadableDateTime 接口或有的 ReadableInstant 接口。以下代码在 ReadableDateTime 上覆盖 toString 什么都不做。

```
ReadableDateTime.metaClass.toString = { ->
    delegate.toString(messageSource.getMessage(
        'default.date.format', null, LCH.getLocale()))
} 
```

然后尝试使用 ReadableInstant：

```
ReadableInstant.metaClass.toString = { ->
    delegate.toString(messageSource.getMessage(
        'default.date.format', null, LCH.getLocale()))
} 
```

DateTime.toString 方法也没有所需的结果。但是，这里有一些有趣的影响。看看下面的代码：

```
def aiToString = AbstractInstant.metaClass.getMetaMethod("toString", [] as Class[])
def adtToString = AbstractDateTime.metaClass.getMetaMethod("toString", [] as Class[])
def bdtToString = BaseDateTime.metaClass.getMetaMethod("toString", [] as Class[])
def dtToString = DateTime.metaClass.getMetaMethod("toString", [] as Class[])

def date = new DateTime()
println "ai: ${aiToString.invoke(date)} "
println "adt: ${adtToString.invoke(date)} "
println "bdt: ${bdtToString.invoke(date)} "
println "dt: ${dtToString.invoke(date)} " 
```

前 3 种方法显示了我希望的日期格式。最后一个仍然显示 ISO8601 格式的日期。我想也许 grails 的 JodaTime 插件可能会覆盖 toString，他们确实向这些接口添加了一些方法，但与 toString 无关。在这一点上，我不知所措。有人有想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T14:03:53.717

你不能覆盖`DateTime#toString()`，因为`DateTime`类是`final`

```
public final class DateTime 
```

但是如果你想要另一种日期格式，你可以使用[toString(org.joda.time.format.DateTimeFormatter)](http://joda-time.sourceforge.net/apidocs/org/joda/time/base/AbstractInstant.html#toString%28org.joda.time.format.DateTimeFormatter%29)
例如

```
def date = new DateTime();
date.toString(ISODateTimeFormat.basicDate()); // format yyyyMMdd 
```

# php - php $_GET 将回显，但之后显示为空白

> ID：16202670
> 
> 赞同：0
> 
> 时间：2013-04-24T21:38:23.103
> 
> 标签：php, get

我觉得这很简单。我有一个像这样的 $_GET ：

```
$cameFromCat = $_GET['cat'];
echo $cameFromCat; 
```

这将按预期读出“卡片”，所以稍后我会这样要求它：

```
if ($_POST['submission'] == "Continue Shopping") {

    Header("location: index.php?cat=" . $cameFromCat);

} 
```

该链接将我发送到`index.php?cat=`. 它不会读出“卡片”。但是，如果我对 var 进行硬编码，例如：

```
 $cameFromCat = "Cards"; 
```

该链接将我发送到 index.php?cat=Cards

这真的让我发疯了。我究竟做错了什么？

更新：周围的代码：

```
$cart = $_SESSION['cart'];
$cameFromCat = $_GET['cat'];
$cameFromPage = $_GET['pagenum'];
$action = $_GET['action'];
$cardqty2 = $_POST['var'];

switch ($action) {
case 'add':
    if ($cart) {
        for ($i = 1; $i <= $cardqty2; $i++) {
            $cart .= ','.$_GET['id'];
        }
    } else {
        $cart = $_GET['id'];
        for ($i = 2; $i <= $cardqty2; $i++) {
            $cart .= ','.$_GET['id'];
        }
    }
    break;
case 'delete':
    if ($cart) {
        $items = explode(',',$cart);
        $newcart = '';
        foreach ($items as $item) {
            if ($_GET['id'] != $item) {
                if ($newcart != '') {
                    $newcart .= ','.$item;
                } else {
                    $newcart = $item;
                }
            }
        }
        $cart = $newcart;
    }
    break;
case 'update':

    if ($_POST['submission'] == "Update") {

    if ($cart) {
        $newcart = '';
        foreach ($_POST as $key=>$value) {
            if (stristr($key,'qty')) {
                $id = str_replace('qty','',$key);
                $items = ($newcart != '') ? explode(',',$newcart) : explode(',',$cart);
                $newcart = '';
                foreach ($items as $item) {
                    if ($id != $item) {
                        if ($newcart != '') {
                            $newcart .= ','.$item;
                        } else {
                            $newcart = $item;
                        }
                    }
                }
                for ($i=1;$i<=$value;$i++) {
                    if ($newcart != '') {
                        $newcart .= ','.$id;
                    } else {
                        $newcart = $id;
                    }
                }
            }
        }
    }
    $cart = $newcart;
    break;

}

if ($_POST['submission'] == "Checkout") {

 Header("Location: address.php");

}

if ($_POST['submission'] == "Continue Shopping") {

 Header("location: index.php?cat=" . $cameFromCat);

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:42:05.067

确保所有 POST 和 GET 值都已正确发送到您的脚本：

```
// check if GET['cat'] isset
if(!isset($_GET['cat'])) {
    die('GET.cat not set');
}

// check if POST['submissuion'] isset    
if(!isset($_POST['submission'])) {
   die('POST.submission not set');
}

$cameFromCat = $_GET['cat'];
echo $cameFromCat;

if ($_POST['submission'] == "Continue Shopping") {
    Header("location: index.php?cat=" . $cameFromCat);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T22:09:52.643

我认为问题与开关条件有关。

看看这部分代码：

```
case 'update':

    if ($_POST['submission'] == "Update") {

    if ($cart) {
        $newcart = '';
        foreach ($_POST as $key=>$value) {
            if (stristr($key,'qty')) {
                $id = str_replace('qty','',$key);
                $items = ($newcart != '') ? explode(',',$newcart) : explode(',',$cart);
                $newcart = '';
                foreach ($items as $item) {
                    if ($id != $item) {
                        if ($newcart != '') {
                            $newcart .= ','.$item;
                        } else {
                            $newcart = $item;
                        }
                    }
                }
                for ($i=1;$i<=$value;$i++) {
                    if ($newcart != '') {
                        $newcart .= ','.$id;
                    } else {
                        $newcart = $id;
                    }
                }
            }
        }
    }
    $cart = $newcart;
    break;

} 
```

休息；在里面`if ($_POST['submission'] == "Update")`

另一个问题是switch 语句周围*缺少**一个**} 。***

我有资格的猜测是您希望将代码更改为：

```
case 'update':
    if ($_POST['submission'] == "Update") {

    if ($cart) {
        $newcart = '';
        foreach ($_POST as $key=>$value) {
            if (stristr($key,'qty')) {
                $id = str_replace('qty','',$key);
                $items = ($newcart != '') ? explode(',',$newcart) : explode(',',$cart);
                $newcart = '';
                foreach ($items as $item) {
                    if ($id != $item) {
                        if ($newcart != '') {
                            $newcart .= ','.$item;
                        } else {
                            $newcart = $item;
                        }
                    }
                }
                for ($i=1;$i<=$value;$i++) {
                    if ($newcart != '') {
                        $newcart .= ','.$id;
                    } else {
                        $newcart = $id;
                    }
                }
            }
        }
    }
    $cart = $newcart;

    }
    break;
} 
```

# jsf - 带有 managedBeans 的 Primefaces 总是返回 null

> ID：16202671
> 
> 赞同：1
> 
> 时间：2013-04-24T21:38:24.493
> 
> 标签：jsf, primefaces

我有个问题。我有一个表单，其中包含要发送到 bean 的输入，该东西已被调试，在 bean 对象中始终为空。你能帮我解决这个问题吗？

这里的代码：

```
<h:form id="frmNuevo">
      <p:dialog id="dialog" header="Añadir Presupuesto" widgetVar="dialogNuevo" resizable="true" width="500" height="500" showEffect="fade" hideEffect="explode" modal="true">
        <p:growl id="growl" showDetail="true" sticky="true" />
        <h:panelGrid id="display" columns="2" cellpadding="4" style="margin: 0 auto;">
            <h:outputText value="Diciembre:" />
            <p:inputText value="#{presupuestoBean.presupuesto.diciembre}" required="true"                 maxlength="20" />
            <p:commandButton value="Guardar" update=":form:cars, frmNuevo, growl, display" process="@this" actionListener="#{presupuestoBean.insertar}" oncomplete="dialogNuevo.hide()" image="icon-save" />
            <p:commandButton value="Cancelar" update=":form:cars" oncomplete="dialogNuevo.hide()" style="margin-bottom: 20px;" image="icon-cancel" />
        </h:panelGrid>
        <p:separator/></p:dialog>
</h:form> 
```

我用 SessionScoped 和 RequestScoped 进行了测试，但不起作用，奇怪的是我做过其他类似的 bean，如果它们工作 ManagedBean：

```
import java.io.Serializable;

import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.RequestScoped;
import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;

@ManagedBean(name = "presupuestoBean")
@RequestScoped
public class PresupuestoBean implements Serializable {

    private TbPresupuesto presupuesto;
    private List<TbPresupuesto> presupuestos;
    private UploadedFile file;
    private String destination = "C:\\temp\\";

    public PresupuestoBean() {
        presupuesto = new TbPresupuesto();
        presupuestos = new ArrayList();
    }

    public TbPresupuesto getPresupuesto() {
        return presupuesto;
    }

    public void setPresupuesto(TbPresupuesto presupuesto) {
        this.presupuesto = presupuesto;
    }

    public void prepararInsertar() {
        presupuesto = new TbPresupuesto();
        presupuestos = new ArrayList();
    }

    public void insertar() {
        PresupuestoDaoImpl presupuestoDao = new PresupuestoDaoImpl();
        presupuesto.setPresupuestoId(presupuesto.getLinea().getLineaId());
        presupuestoDao.insertar(presupuesto);
        FacesContext context = FacesContext.getCurrentInstance();
        context.addMessage(null, new FacesMessage("Se ha ingresado correctamente"));
        presupuesto = new TbPresupuesto();
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T00:46:08.787

表单必须进入对话框。

```
<p:dialog>
    <h:form>
        ...
    </h:form>
</p:dialog> 
```

生成的对话框组件的 HTML 表示是在页面加载期间通过 JavaScript 重新定位到末尾，`<body>`以提高呈现模态对话框的跨浏览器兼容性。

使用您当前的代码，这意味着对话框将不再位于表单中。因此，当您尝试在对话框中提交输入值时，它们最终会变为空值，因为没有表单可以收集输入值并将其发送到服务器。

此外，您只处理命令按钮内的提交按钮。

```
<p:commandButton ... process="@this" /> 
```

删除该属性。它默认为`@form`已经，这正是您想要的。

# iphone - 如何在objective-c中保持方法中创建的对象处于活动状态？

> ID：16202677
> 
> 赞同：0
> 
> 时间：2013-04-24T21:38:44.093
> 
> 标签：iphone, ios, objective-c, xcode, memory-management

我想在我使用核心图创建的应用程序中放置多个饼图。我创建了一个包装类（我们称之为`PieChartViewControlle`r），它是一个视图控制器，并设置了图形以及一些按钮和动作以使图形具有交互性。为了部署它，我通常只是在另一个视图控制器上创建一个属性，`PieChartViewController`当我初始化这个视图控制器时，我只需分配/初始化`PieChartViewController`并将其视图添加到主视图。这通常工作正常。

问题是在另一个视图上，我想向视图添加可变数量的图形，并且这个数字是在初始化视图控制器时确定的。我有一个初始化每个`PieChartViewController`并将其添加到`NSMutableDictionary`父对象的方法，以便我可以保留对它们的引用。然而，这似乎并没有让它们保持活力，因为我总是遇到**BAD_ACCESS** 2 崩溃，并且在运行仪器时我意识到它们被释放了。

因此，当`PieChartViewControllers`它们存储在一个属性上时，一切都很好，但是当我将它们放入字典时，它们似乎没有保持足够长的生命。我仍然不太熟悉objective-c中的内存管理，我不确定如何去做，希望能提供任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:56:00.690

> 我只是分配/初始化 PieChartViewController 并将其视图添加到主视图。这通常工作正常

它可能工作正常，但不要这样做。这是对 UIViewController 的误用。在这里查看我的答案：[https ://stackoverflow.com/a/15962125/341994](https://stackoverflow.com/a/15962125/341994)

# c# - Process.Start() 在后台线程上运行时挂起

> ID：16202678
> 
> 赞同：5
> 
> 时间：2013-04-24T21:38:52.843
> 
> 标签：c#, multithreading, timer

我整天都在排除故障。在做了一些[研究](http://jake.ginnivan.net/redirecting-process-output)和大量试验和错误之后，似乎我已经能够将问题缩小到我的调用`process.Start()`在计时器线程上不起作用的事实。下面的代码在主线程上运行时有效。将完全相同的代码放在计时器回调中，它就会挂起。为什么？如何让它与计时器一起工作？

```
private static void RunProcess()
{
    var process = new Process();

    process.StartInfo.FileName = "cmd";
    process.StartInfo.Arguments = "/c exit";
    process.StartInfo.UseShellExecute = false;
    process.StartInfo.RedirectStandardError = true;
    process.StartInfo.RedirectStandardInput = true;
    process.StartInfo.RedirectStandardOutput = true;

    process.Start();  // code hangs here, when running on background thread

    process.StandardOutput.ReadToEnd();

    process.WaitForExit();
} 
```

**编辑**

作为测试，我在另一台笔记本电脑上使用了完全相同的代码，我遇到了同样的问题。这是可以粘贴到控制台应用程序中的完整代码。`process.Start()`挂起，但只要我按下任何键结束，就会`process.Start()`在程序结束之前完成。

```
private static System.Timers.Timer _timer;
private static readonly object _locker = new object();

static void Main(string[] args)
{
    ProcessTest();

    Console.WriteLine("Press any key to end.");
    Console.ReadKey();
}
private static void ProcessTest()
{
    Initialize();
}
private static void Initialize()
{
    int timerInterval = 2000;
    _timer = new System.Timers.Timer(timerInterval);
    _timer.Elapsed += new ElapsedEventHandler(OnTimerElapsed);
    _timer.Start();
}
private static void OnTimerElapsed(object sender, ElapsedEventArgs e)
{
    if (!Monitor.TryEnter(_locker)) { return; }  // Don't let  multiple threads in here at the same time.
    try
    {
        RunProcess();
    }
    finally
    {
        Monitor.Exit(_locker);
    }
}
private static void RunProcess()
{
    var process = new Process();
    process.StartInfo.FileName = "cmd";
    process.StartInfo.Arguments = "/c exit";
    process.StartInfo.UseShellExecute = false;
    process.StartInfo.RedirectStandardError = true;
    process.StartInfo.RedirectStandardInput = true;
    process.StartInfo.RedirectStandardOutput = true;
    process.Start();  // ** HANGS HERE **
    process.StandardOutput.ReadToEnd();
    process.WaitForExit();
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-25T15:10:58.767

关于这个问题有很多重复的问题，没有一个完全适合你的情况。您可以使用调试器的 Debug + Windows + Threads 窗口查看问题。找到计时器线程并双击它。查看调用堆栈窗口以查看：

```
mscorlib.dll!System.Console.InputEncoding.get() + 0x66 bytes    
System.dll!System.Diagnostics.Process.StartWithCreateProcess(System.Diagnostics.ProcessStartInfo startInfo) + 0x7f5 bytes   
System.dll!System.Diagnostics.Process.Start() + 0x88 bytes  
ConsoleApplication70.exe!Program.RunProcess() Line 43 + 0xa bytes   C#
ConsoleApplication70.exe!Program.OnTimerElapsed(object sender, System.Timers.ElapsedEventArgs e) Line 28 + 0x5 bytes    C#
    // etc... 
```

线程在 Console.InputEncoding 属性 getter 上死锁。Process 类使用它来确定需要使用什么编码来将进程的重定向输出转换为字符串。

这是特定于 .NET 4.5 的，它还会影响在安装了 4.5 的计算机上以 4.0 为目标的应用程序，因为它不是 .NET 的并行版本。死锁是由主线程中的 Console.ReadKey() 方法调用引起的。它现在获得了一个锁，以防止其他线程弄乱控制台。这是微软软件的一个相当全局的变化，VS2012 创建的 C/C++ 应用程序中使用的 CRT 也添加了这个锁。确切的原因对我来说不是那么清楚，但是当您的程序要求输入时，肯定必须对控制台输出做一些事情，而不是与控制台输入混合。确切地说，为什么 InputEncoding 属性也需要获取该锁，这有点难以解释，但符合对控制台输入进行序列化访问的模式。这对许多程序员来说当然是一个很大的惊喜，尤其是那些编写测试线程代码的小测试应用程序的程序员，就像你所做的那样。TDD 有点挫折。

解决方法有点令人不快，TDD 明智，您必须停止使用 Console.ReadKey() 以避免死锁。实际程序会使用 AutoResetEvent 的 WaitOne() 方法来知道工作线程已完成执行。或 CountDownEvent.Wait()，更符合尝试代码几次。等等。

* * *

更新：此死锁场景已在 .NET 4.5 的服务更新中得到解决。在您的计算机上启用 Windows 更新以获取它。

# javascript - 使用javascript中的title属性将鼠标悬停在数据上

> ID：16202679
> 
> 赞同：0
> 
> 时间：2013-04-24T21:38:54.820
> 
> 标签：javascript, jquery, hover, tooltip

我有一个 javascript 代码，它以表格格式显示数据，当将鼠标悬停在第一列上时，它会显示其他详细信息。悬停在代码上是使用 jquery 工具提示和 html 的 title 属性。该代码在大多数情况下都可以正常工作，但是如果我在悬停中显示的字段之一具有“符号，它将破坏所有记录，并且悬停和主要数据一起显示，并且悬停在这些行上不起作用。

下面是我的代码的快照

```
var medicationName = medJSON.MED_DETAILS[medIdx1].ORDER_NAME;
     var orderdetails = medJSON.MED_DETAILS[medIdx1].ORD_DETAILS;
      var comments = medJSON.MED_DETAILS[medIdx1].ORD_COMMENTS;
      var reqStart = medJSON.MED_DETAILS[medIdx1].REQ_ST_DT;
      var originalStart = medJSON.MED_DETAILS[medIdx1].ORIG_ORD_DT;
      var lastDose = medJSON.MED_DETAILS[medIdx1].LAST_DOSE;
      var nextDose = medJSON.MED_DETAILS[medIdx1].NEXT_DOSE;
      var stopDt = medJSON.MED_DETAILS[medIdx1].STOP_DT_TM;
      var stopReason = medJSON.MED_DETAILS[medIdx1].STOP_REASON;
      var enteredBy = medJSON.MED_DETAILS[medIdx1].ORDER_ENTERED_BY;
      var status = medJSON.MED_DETAILS[medIdx1].ORD_STATUS;
      var simpleDetails = medJSON.MED_DETAILS[medIdx1].CLIN_DISP_LN;
      if(nextDose.length == 0)
      {
      nextDose = "Not Defined";
      }
      var medHover = ["<table><tr><td><b>Medication:</b></td><td>",medicationName,"</td></tr>"
                        ,"<tr><td><b>Details:</b></td><td>",simpleDetails,"</td></tr>"
                        //,"<tr><td><b>Order Comments:</b></td><td>",comments,"</td></tr>"
                          ,"<tr><td><b>Request Start:</b></td><td>",reqStart,"</td></tr>"
                          ,"<tr><td width = 200px><b>Original Order Date/Time:</b></td><td>",originalStart,"</td></tr>"
                          ,"<tr><td><b>Last Documented Dose:</b></td><td>",lastDose,"</td></tr>"
                          ,"<tr><td><b>Next Scheduled Dose:</b></td><td>",nextDose,"</td></tr>"
                          ,"<tr><td><b>Stop Date/Time:</b></td><td>",stopDt,"</td></tr>"
                          ,"<tr><td><b>Stop Reason:</b></td><td>",stopReason,"</td></tr>"
                          ,"<tr><td><b>Order Entered By:</b></td><td>",enteredBy,"</td></tr>"
                          ,"<tr><td><b>Status:</b></td><td>",status,"</td></tr>"
                          ,"</table>"]

     tempStr1.push("<tr class = 'evenrow' ><td class = 'cmedname custhvr' title=\"",medHover.join(""),"\">",medicationName,"</td><td> ",simpleDetails,"</td></tr>") 
```

谢谢，锡德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:41:54.677

使用以下方法处理 medHover：

```
medHover.join("").replace('\"', '&quot;'); 
```

这会将引号字符替换为可用于 HTML 的值。

# java - 通过 Oracle 搜索和导出提取多个嵌入文件

> ID：16202683
> 
> 赞同：1
> 
> 时间：2013-04-24T21:39:10.033
> 
> 标签：java, oracle

我目前正在用 Java 实现 Oracle OutsideIn Search 和 Export 工具，以提取不同文件的元数据和内容。我能够对一个文件夹中的多个文件执行此操作，但是我无法提取嵌入在另一个文件中的文件。我想知道这在搜索和导出中是否可行。

如果没有，我会选择 CleanContent，但它只接受 Microsoft 和 PDF 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T19:04:29.093

搜索导出可以转换或从档案或其他类型的文件中提取嵌入文件。我们区分了三种不同类型的嵌入，每一种都有自己的选项来控制它们的转换。这三种类型是归档子文档、电子邮件附件和通用嵌入。默认情况下，前两个被转换，但第三个不是。要启用通用嵌入转换，请在 SCCOPT_XML_SEARCHML_FLAGS 选项中设置 SCCEX_XML_EMBEDDINGS 标志。如果您使用 SDK 提供的导出器示例应用程序，请尝试在您的 CFG 文件中启用以下内容。

嵌入标志是

如果您尝试提取嵌入的二进制副本，则需要三个步骤。在初始转换时，在 SCCOPT_XML_SEARCHML_FLAGS 选项中设置 SCCEX_XML_PRODUCEOBJECTINFO 标志。使用该信息进行所需的嵌入，以填充传递给 DAOpenDocument 的 SCDAOBJECT 结构。从该函数返回的 hDoc 可以传递给 DASaveInputObject 以保存嵌入的二进制副本。这适用于上述三种嵌入中的任何一种。没有演示此过程的 Java 示例应用程序。

# kentico - “/KenticoCMS”应用程序中的服务器错误。单击 Kentico CMS Desk 中的工具

> ID：16202685
> 
> 赞同：0
> 
> 时间：2013-04-24T21:39:15.973
> 
> 标签：kentico

当我在 Kentico 的 CMS Desk 中单击工具菜单时出现此错误。我不确定从哪里开始解决问题。

我已经开始复制网站以在我的机器上本地运行。希望我可以通过这种方式获得更多信息。

很感激地收到了想法。

更新 - 我决定从头开始重新安装。更新 2 我认为问题可能是我们 安装了[Get Started](http://www.getstarted.com.au/Blog/Blog/August-2011/eWay-Payment-Gateway-for-Kentico.aspx)中的第 3 部分支付网关，但未针对 Kentico 的第 7 版进行更新。

我能够解决最初的错误，这是由于项目中复制了一个代码文件夹。

但是，下一个错误如下；

```
Server Error in '/KenticoCMS7' Application. 
--------------------------------------------------------------------------------

Invalid column name 'MenuItemGroup'.
Invalid column name 'MenuItemGroup'.
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.Data.SqlClient.SqlException: Invalid column name 'MenuItemGroup'.
Invalid column name 'MenuItemGroup'.

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below. 

Stack Trace: 

[SqlException (0x80131904): Invalid column name 'MenuItemGroup'.Invalid column name 'MenuItemGroup'.]   System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) +1753986   System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) +5296058   System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose) +558   System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady) +1682   System.Data.SqlClient.SqlDataReader.TryConsumeMetaData() +59   System.Data.SqlClient.SqlDataReader.get_MetaData() +90   System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) +365   System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite) +1379   System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite) +175   System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method) +53   System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method) +134   System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior) +41   System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior) +10   System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior) +140   System.Data.Common.DbDataAdapter.Fill(DataSet dataSet, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior) +316   System.Data.Common.DbDataAdapter.Fill(DataSet dataSet) +88   CMS.DataProviderSQL.DataConnection.ExecuteQuery(String queryText, QueryDataParameters queryParams, QueryTypeEnum queryType, Boolean requiresTransaction) +239[Exception: [DataConnection.HandleError]: Query: SELECT  ClassName, DocumentCulture, DocumentModifiedWhen, DocumentMenuCaption, DocumentMenuClass, DocumentMenuClassHighLighted, DocumentMenuClassOver, DocumentShowInSiteMap, DocumentMenuItemHideInNavigation, DocumentMenuItemImage, DocumentMenuItemImageHighlighted, DocumentMenuItemImageOver, DocumentMenuItemInactive, DocumentMenuItemLeftImage, DocumentMenuItemLeftImageHighlighted, DocumentMenuItemLeftImageOver, DocumentMenuItemRightImage, DocumentMenuItemRightImageHighlighted, DocumentMenuItemRightImageOver, DocumentMenuJavascript, DocumentMenuRedirectUrl, DocumentMenuStyle, DocumentMenuStyleHighlighted, DocumentMenuStyleOver, DocumentName, DocumentUrlPath, NodeAliasPath, NodeID, NodeChildNodesCount, NodeClassID, NodeLevel, NodeLinkedNodeID, NodeParentID, SiteName, NodeACLID, NodeSiteID, NodeOwner, NodeOrder, NodeName, DocumentSitemapSettings FROM View_CONTENT_MenuItem_Joined WHERE (((((NodeSiteID = 1) AND (Published = 1)) AND (DocumentCulture = N'en-US')) AND (NodeLevel <= 2)) AND (((DocumentMenuItemHideInNavigation = 0)) AND (MenuItemGroup <> 'footer' OR MenuItemGroup IS NULL))) ORDER BY NodeLevel, NodeOrder, DocumentName: caused exception: Invalid column name 'MenuItemGroup'.Invalid column name 'MenuItemGroup'.]   CMS.DataEngine.AbstractDataConnection.HandleError(String queryText, SqlException ex) +158   CMS.DataProviderSQL.DataConnection.ExecuteQuery(String queryText, QueryDataParameters queryParams, QueryTypeEnum queryType, Boolean requiresTransaction) +294   CMS.DataEngine.AbstractDataConnection.CMS.SettingsProvider.IDataConnection.ExecuteQuery(String queryText, QueryDataParameters queryParams, QueryTypeEnum queryType, Boolean requiresTransaction) +52   CMS.DataEngine.GeneralConnection.RunQuery(QueryParameters query) +280   CMS.DataEngine.GeneralConnection.ExecuteQuery(QueryParameters query) +581   CMS.DataEngine.GeneralConnection.ExecuteQuery(String queryName, QueryDataParameters parameters, String where, String orderBy, Int32 topN, String columns) +321   CMS.DataEngine.GeneralConnection.ExecuteQuery(String queryName, QueryDataParameters parameters, String where, String orderBy, Int32 topN, String columns, Int32 offset, Int32 maxRecords, Int32& totalRecords) +116   CMS.DataEngine.ConnectionHelper.ExecuteQuery(String queryName, QueryDataParameters parameters, String where, String orderBy, Int32 topN, String columns, Int32 offset, Int32 maxRecords, Int32& totalRecords) +90   CMS.DocumentEngine.TreeProvider.ExecuteQuery(String queryName, QueryDataParameters parameters, String where, String orderBy, Int32 topN, String columns, Int32 offset, Int32 maxRecords, Int32& totalRecords) +137   CMS.DocumentEngine.TreeProvider.ExecuteQuery(String queryName, QueryDataParameters parameters, String where, String orderBy, Int32 topN, String columns) +73   CMS.DocumentEngine.TreeProvider.SelectNodes(NodeSelectionParameters parameters) +2631   CMS.DocumentEngine.TreeProvider.SelectNodes(String siteName, String aliasPath, String cultureCode, Boolean combineWithDefaultCulture, String classNames, String where, String orderBy, Int32 maxRelativeLevel, Boolean selectOnlyPublished, Int32 topN, String columns) +247   CMS.Controls.CMSAbstractMenuProperties.GetMenuItems(String resolvedPath, Boolean siteMap) +1568   CMS.Controls.CMSAbstractMenuProperties.GetDataSource(Boolean siteMap) +1168   CMS.Controls.CMSAbstractMenuProperties.GetDataSource() +46   CMS.Controls.CMSListMenu.ReloadData(Boolean forceLoad) +270   CMS.Controls.CMSListMenu.OnInit(EventArgs e) +160   System.Web.UI.Control.InitRecursive(Control namingContainer) +134   System.Web.UI.Control.InitRecursive(Control namingContainer) +290   System.Web.UI.Control.InitRecursive(Control namingContainer) +290   System.Web.UI.Control.InitRecursive(Control namingContainer) +290   System.Web.UI.Control.InitRecursive(Control namingContainer) +290   System.Web.UI.Control.InitRecursive(Control namingContainer) +290   System.Web.UI.Control.InitRecursive(Control namingContainer) +290   System.Web.UI.Control.InitRecursive(Control namingContainer) +290   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +489 
```

建议 Kentico 支持 错误是否出现在使用（直接或继承）分层查看器 Web 部件的某些页面上？如果是这样，您能否编辑其属性并查看 Where 条件？有没有类似“MenuItemGroup = 'xxx'”的东西？如果是这样，您可以将其删除并查看差异吗？

或者，您可以尝试转到站点管理器 -> 开发 -> 系统表 -> 视图并点击刷新所有视图按钮，或者，站点管理器 -> 开发 -> 文档类型 -> 页面菜单项类型 -> 字段并点击保存到重新生成架构，或者应用最新的修补程序来刷新整个数据库和文件。

我在 30 之上应用了 Hotfix 31，但它没有帮助。我不认为我可以进入该计划来尝试支持所讨论的问题。

更新：我已经删除了入门代码，并确定我在旧安装中创建了一个新站点，该站点将成功导入新的 Kentico 安装而不会损坏工具菜单...现在尝试让我的真实站点导出和导入不破....

万岁——是的，它奏效了！

[更新] 我不再确定这个问题是由于入门网关不适用于 7.0 我能够干净地导出其中一个站点的事实并不意味着问题已解决。我继续讨论

[这里](https://stackoverflow.com/questions/16370224/server-error-in-application-kentico-7-31)

我开始了一个新问题，因为我认为我已经通过导出和导入解决了这个问题。但是现在我意识到这只能解决具有干净数据的站点的问题。回想起来，我应该继续这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-27T07:44:46.650

你有几个选择。首先，您可以尝试检查插件的 sql 脚本并尝试反转它所做的更改（并删除属于插件的文件）。其次，您可以导出您的站点并将其导入新实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-28T15:40:49.133

您是否从一些较旧的 Kentico 版本中导入了站点或对象？如果是这样，似乎在导入时，页面菜单项文档类型被覆盖，并且新字段“MenuItemGroup”被删除。您可以尝试将具有此名称的字段添加回给定的文档类型。

# memory-management - 我是否通过显式处理 imageView.Image 来赢得内存？

> ID：16202692
> 
> 赞同：3
> 
> 时间：2013-04-24T21:39:52.937
> 
> 标签：memory-management, xamarin.ios, garbage-collection, dispose, nsautoreleasepool

我的应用程序中有此代码：

```
var newImage = // ...

if (imageView.Image != null && imageView.Image != newImage)
    imageView.Image.Dispose ();

imageView.Image = newImage; 
```

我有三个相关的问题：

*   是否会立即释放之前占用的内存`imageView.Image`？
*   如果是这样，是否有更清洁的解决方案？
*   这有关系`NSAutoreleasePool`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T22:07:00.573

> 是不是立即释放之前imageView.Image占用的内存？

**不是立即**，但它应该比等待垃圾收集器快得多。

调用`Dispose`将删除对*native的**托管*引用。如果没有其他（本机）引用（RetainCount == 0），那么它将被释放（ObjC 引用计数）。 *`UIImage``UIImage`*

 *在您的代码`imageView`中仍然有对它的引用，直到它的`Image`属性设置为`newImage`- 这就是我**没有立即**回答的原因。

> 如果是这样，是否有更清洁的解决方案？

并不真地。让 GC 完成它的工作看起来更干净 - 但图像可能非常大，值得尽快释放。

此外，添加一个局部变量以确保（如果不存在其他本机引用）图像将立即被释放，这并不值得（并且无论如何也不会更干净）——它将发生在下一行。

> 这与 NSAutoreleasePool 有什么关系？

任何事物 ？好吧，这两种情况都与内存有关。

创建图像将使用（缓存）当前`NSAutoreleasePool`并且最终将被耗尽。如果您处理很多东西（例如循环），那么通常值得拥有自己的短期池以确保更快地排出。

一些 API（众所周知需要大量内存）装饰有一个属性，该属性会自动添加（btouch）一个`NSAutoreleasePool`- 但要找出哪个并不容易。

有疑问，您最好使用 Apple Instruments 来测量...*

# c# - 字符串必须恰好是一个字符长

> ID：16202694
> 
> 赞同：0
> 
> 时间：2013-04-24T21:39:55.160
> 
> 标签：c#

我有一个我认为很容易的问题。出于某种原因，以下代码会生成异常“字符串必须恰好是一个字符长”。

```
int n = 0;
foreach (char letter in charMsg)
{
    // Get the integral value of the character.
    int value = Convert.ToInt32(letter);
    // Convert the decimal value to a hexadecimal value in string form.
    string hexOutput = String.Format("{0:X}", value);
    //Console.WriteLine("Hexadecimal value of {0} is {1}", letter, hexOutput);
    charMsg[n] = Convert.ToChar(hexOutput);
    n++;
} 
```

异常发生在该`charMsg[n] = Convert.ToChar(hexOutput);`行。为什么会这样？当我检查它的值时，`CharMsg`它似乎正确地包含了所有这些值，但仍然向我抛出错误。

**更新：**我已经解决了这个问题，这是我的错误。对不起，打扰你。

好吧，这对我来说是一个非常愚蠢的错误。关键是，对于我的问题，我什至不应该这样做，因为十六进制值显然不会以任何方式帮助我。

我试图做的是加密图像中的消息。我已经在第一个像素的每个颜色通道的最后一位数字中加密了所述消息的长度。现在我正试图把这个信息放在那里。我在这里查看：[http](http://en.wikipedia.org/wiki/ASCII) ://en.wikipedia.org/wiki/ASCII并对自己说，没有想到使用 hexes 是个好主意。不敢相信我是这么想的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:55:19.650

`Convert.ToChar( string s )`，[根据文档](http://msdn.microsoft.com/en-us/library/5f3ew98y.aspx)需要一个字符串，否则它会抛出`FormatException`你已经注意到的 a 。这是一个粗略的，虽然更严格，相当于

public char string2char( string s ) { return s[0] ; }

您的代码执行以下操作：

*   遍历一些可枚举字符集合中的所有字符。
*   对于每一个这样的角色，它...
    *   将 char 转换为 int。*提示：* a`char`是一个整数类型：它是一个无符号的 16 位整数值。
    *   将该值转换为包含所讨论字符的十六进制表示的字符串。对于大多数字符，该字符串的长度至少为两个字符：例如，以这种方式转换空格字符 (' ', 0x20) 将得到字符串“20”。
    *   然后，您尝试将其转换回 char 并替换正在迭代的当前项目。这是引发异常的地方。您应该在这里注意的一件事是，更改正在枚举的集合可能会导致枚举器抛出异常。

你到底想在这里完成什么。例如，给定`charMsg`由 3 个字符组成的 a，“a”、“b”和“c”，应该发生什么。清晰的问题陈述有助于我们为您提供帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T21:42:35.623

由于可打印的 unicode 字符可以在 to 范围内的任何位置`0x0000`，`0xFFFF`因此您的 hexOutput 变量可以包含多个字符 - 这就是引发错误的原因。 `Convert.ToChar(string)`总是会检查字符串的长度 a，如果它不等于 1 - 它会抛出。所以它不会将字符串转换`0x30`为十六进制数，然后再转换为 ascii 表示符号`0`。

您能详细说明您要归档的内容吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T21:52:21.323

你的 hexOutput 是一个字符串，我假设 charMsg 是一个字符数组。假设 charMsg 中的第一个元素是 'p'，或十六进制值 70。 Convert.ToChar(string) 的文档说它将只使用字符串的第一个字符 ('7')，但这是错误的。它会抛出这个错误。您可以使用静态示例进行测试，例如`charMsg[n] = Convert.ToChar("70");`. 你会得到同样的错误。

您是否尝试用十六进制值替换字符？如果是这样，您可以尝试使用 StringBuilder 对象而不是数组分配。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-11-15T11:20:56.467

Convert.ToChar(string) 如果为空字符串，则会导致此错误。而是使用 cchar()

# c# - 如何在实体框架迁移中获取当前连接字符串？

> ID：16202696
> 
> 赞同：4
> 
> 时间：2013-04-24T21:40:10.233
> 
> 标签：c#, .net, entity-framework

是否有任何迁移属性或单例类返回实体框架 5/6 迁移中的当前连接字符串？我需要在迁移“Up”方法中使用它，我知道这听起来可能很奇怪，但我需要它来执行一些特定的自动化......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T22:09:48.453

该`Up`方法未连接。它只生成稍后将由`DbMigrator`. 如果您想在迁移期间对连接做任何事情，您唯一的机会就是`Seed`方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T22:11:04.803

好吧，听起来确实有点“不正统”:)，但是...

我建议使用`Seed`你的方法`Configuration`

```
var connection = context.Database.Connection.ConnectionString; 
```

对于向上/向下迁移，您可以执行以下操作...

当您有一个“正在运行”的 DbContext 时，这很有效。

```
using (var db = new YourDbContext())
{
    var connection = db.Database.Connection.ConnectionString;
} 
```

（我没有尝试过 - 因为它应该运行）

* * *

### 编辑：如何获取没有 DbContext 的连接缓存（实体框架）：

* * *

*我想我现在明白你想要做什么（基于评论）。*

您可以`all connections`使用`Reflection`and 从`internal static dictionary`

```
IEnumerable<string> EnumerateConnections()
{
    var lazyInternalContextType = typeof(DbContext).Assembly
        .GetType("System.Data.Entity.Internal.LazyInternalContext");
    var propertyDbs = lazyInternalContextType.GetField(
        "InitializedDatabases", 
        BindingFlags.Static | BindingFlags.NonPublic | BindingFlags.Public);
    var lazyContext = propertyDbs.GetValue(null);
    foreach (var pair in (IEnumerable)lazyContext)
    {
        var key = pair.GetType().GetProperty("Key")?.GetValue(pair, null);
        var tuple = (Tuple<System.Data.Entity.Infrastructure.DbCompiledModel, string>)key;
        yield return tuple.Item2; // need to replace "System.Data.SqlClient.SqlConnection;" with "" in EF6.
    }
}

var connectionName = EnumerateConnections().Distinct().SingleOrDefault(); 
```

您可以将其放入 Up/Down - 您应该获得一个已使用的“不同”连接。

如果您不混合不同的连接，则此方法有效。在这种情况下，您需要根据您的情况进行调整。

（应该适用于 EF5 和 EF6，类是相同的 - 我只是快速确认了 EF5）：

享受 ：）

# performance - 为什么这个 r 代码这么慢？

> ID：16202705
> 
> 赞同：0
> 
> 时间：2013-04-24T21:40:51.077
> 
> 标签：performance, r, dataframe

我正在尝试根据另一个数据框中的信息创建一个数据框。

第一个数据帧（base_mar_bop）具有如下数据：

```
201301|ABC|4
201302|DEF|12 
```

我的愿望是从中创建一个包含 16 行的数据框：

```
4 times: 201301|ABC|1
12 times: 201302|DEF|1 
```

我编写了一个需要很长时间才能运行的脚本。为了了解最终数据帧有大约 200 万行，源数据帧有大约 10k 行。由于数据的机密性，我无法发布数据帧的源文件。

由于运行这段代码需要很长时间，我决定在 PHP 中执行此操作，它在一分钟内运行并完成了工作，将其写入 txt 文件，然后将 txt 文件导入 R。

我不知道为什么 R 需要这么长时间。是函数的调用吗？它是嵌套的for循环吗？从我的角度来看，那里没有那么多计算密集型的步骤。

```
# first create an empty dataframe called base_eop that will each subscriber on a row 

identified by CED, RATEPLAN and 1
# where 1 is the count and the sum of 1 should end up with the base
base_eop <-base_mar_bop[1,]

# let's give some logical names to the columns in the df
names(base_eop) <- c('CED','RATEPLAN','BASE')

# define the function that enables us to insert a row at the bottom of the dataframe
insertRow <- function(existingDF, newrow, r) {
  existingDF[seq(r+1,nrow(existingDF)+1),] <- existingDF[seq(r,nrow(existingDF)),]
  existingDF[r,] <- newrow
  existingDF
}

# now loop through the eop base for march, each row contains the ced, rateplan and number of subs
# we need to insert a row for each individual sub
for (i in 1:nrow(base_mar_eop)) {
  # we go through every row in the dataframe
  for (j in 1:base_mar_eop[i,3]) {
    # we insert a row for each CED, rateplan combination and set the base value to 1
    base_eop <- insertRow(base_eop,c(base_mar_eop[i,1:2],1),nrow(base_eop)) 
  }
}

# since the dataframe was created using the first row of base_mar_bop we need to remove this first row
base_eop <- base_eop[-1,] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T04:27:40.220

这是一种方法`data.table`，尽管@BenBolker 的时机已经很棒了。

```
library(data.table)
DT <- data.table(d2)  ## d2 from @BenBolker's answer
out <- DT[, ID:=1:.N][rep(ID, BASE)][, `:=`(BASE=1, ID=NULL)]
out
#            CED RATEPLAN BASE
#       1:     1        A    1
#       2:     1        A    1
#       3:     1        A    1
#       4:     1        A    1
#       5:     1        A    1
#      ---                    
# 1999996: 10000        Y    1
# 1999997: 10000        Y    1
# 1999998: 10000        Y    1
# 1999999: 10000        Y    1
# 2000000: 10000        Y    1 
```

在这里，我使用复合查询来执行以下操作：

*   创建一个 ID 变量，它实际上只是 1 到`data.table`.
*   用于`rep`通过相应的 BASE 值重复 ID 变量。
*   将所有 BASE 值替换为“1”并删除我们之前创建的 ID 变量。

也许有一种更有效的方法可以做到这一点。例如，删除其中一个复合查询应该会使其更快一些。也许是这样的：

```
out <- DT[rep(1:nrow(DT), BASE)][, BASE:=1] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T21:49:32.923

我还没有尝试过任何基准测试，但是这种方法（在你的小例子中说明）应该*更快*：

```
d <- data.frame(x1=c(201301,201302),x2=c("ABC","DEF"),rep=c(4,12))
with(d,data.frame(x1=rep(x1,rep),x2=rep(x2,rep),rep=1)) 
```

一个更现实的例子，有时间：

```
d2 <- data.frame(CED=1:10000,RATEPLAN=rep(LETTERS[1:25],
         length.out=10000),BASE=200) 
nrow(d2) ## 10000
sum(d2$BASE)  ## 2e+06
system.time(d3 <- with(d2,
      data.frame(CED=rep(CED,BASE),RATEPLAN=rep(RATEPLAN,BASE),
              BASE=1)))
##   user  system elapsed 
## 0.244   0.860   1.117 
nrow(d3)  ## 2000000 (== 2e+06) 
```

# python - 使用 NaN 添加两个系列

> ID：16202711
> 
> 赞同：23
> 
> 时间：2013-04-24T21:41:04.443
> 
> 标签：python, pandas

我正在研究“用于数据分析的 Python”，但我不了解特定功能。添加两个 pandas 系列对象将自动对齐索引数据，但如果一个对象不包含该索引，则返回为 NaN。例如从书中：

```
a = Series([35000,71000,16000,5000],index=['Ohio','Texas','Oregon','Utah'])
b = Series([NaN,71000,16000,35000],index=['California', 'Texas', 'Oregon', 'Ohio']) 
```

结果：

```
 In [63]: a
    Out[63]: Ohio          35000
             Texas         71000
             Oregon        16000
             Utah           5000
    In [64]: b
    Out[64]: California      NaN
             Texas         71000
             Oregon        16000
             Ohio          35000 
```

当我把它们加在一起时，我得到了这个......

```
 In [65]: a+b
    Out[65]: California       NaN
             Ohio           70000
             Oregon         32000
             Texas         142000
             Utah             NaN 
```

那么为什么犹他州的值是 NaN 而不是 500？似乎 500+NaN=500。是什么赋予了？我遗漏了一些东西，请解释一下。

**更新：**

```
 In [92]: # fill NaN with zero
             b = b.fillna(0)
             b
    Out[92]: California        0
             Texas         71000
             Oregon        16000
             Ohio          35000

    In [93]: a
    Out[93]: Ohio      35000
             Texas     71000
             Oregon    16000
             Utah       5000

    In [94]: # a is still good
             a+b
    Out[94]: California       NaN
             Ohio           70000
             Oregon         32000
             Texas         142000 
             Utah             NaN 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-24T21:47:26.403

Pandas 不假设 500+NaN=500，但很容易要求它这样做：

```
a.add(b, fill_value=0) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T21:50:29.790

默认方法是假设任何涉及 NaN 的计算都会给出 NaN 作为结果。任何加上 NaN 的都是 NaN，除以 NaN 的任何东西都是 NaN，等等。如果你想用一些值填充 NaN，你必须明确地这样做（正如 Dan Allan 在他的回答中所示）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-16T22:25:06.407

使用起来更有意义，`pd.concat()`因为它可以接受更多列。

```
import pandas as pd
import numpy as np

a = pd.Series([35000,71000,16000,5000],index=['Ohio','Texas','Oregon','Utah'])
b = pd.Series([np.nan,71000,16000,35000],index=['California', 'Texas', 'Oregon', 'Ohio'])

pd.concat((a,b), axis=1).sum(1, min_count=1) 
```

输出：

```
California         NaN
Ohio           70000.0
Oregon         32000.0
Texas         142000.0
Utah            5000.0
dtype: float64 
```

* * *

或 3 系列：

```
import pandas as pd
import numpy as np

a = pd.Series([1, np.NaN, 4, 5])
b = pd.Series([3, np.NaN, 5, np.NaN])
c = pd.Series([np.NaN,np.NaN,np.NaN,np.NaN])

print(pd.concat((a,b,c), axis=1).sum(1, min_count=1))

#0    4.0
#1    NaN
#2    9.0
#3    5.0
#dtype: float64 
```

# php - 循环遍历以 JSON 编码的 PHP 数组

> ID：16202712
> 
> 赞同：1
> 
> 时间：2013-04-24T21:41:13.453
> 
> 标签：php, jquery, json

我有一个 PHP 数组，其中表 id 作为键，表字段作为值。

示例 PHP：

```
while($row = mysql_fetch_array($result))
{
    $id = $row['id'];
    $array[$id] = $row['some_field'];
} 
```

然后我用`json_encode($array)`得到类似的东西：

```
{"id1":"value1","abc":"123","xyz":"789"} 
```

如何在 jQuery 中循环遍历它？从我目前发现的情况来看，我似乎需要知道钥匙。所以：

```
var obj = jQuery.parseJSON(jsonVar);
alert(obj.abc); //prints 123 
```

但是，如果我不知道键，因为它们是动态的，我怎么能得到这些值呢？
我需要重组我的 PHP 数组吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:43:46.930

一旦将 php 中的关联数组编码为 JSON 对象，它就不再是数组，而是具有键和值的对象。您可以使用 javascript 在 javascript 中遍历它们[`for..in`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for...in)

```
for (var key in obj) {
   console.log(obj[key]);
} 
```

**注意：** `for..in`不保证顺序，如果您需要确保顺序，则必须使数组索引，而不是`key=>value`，并使用`for`循环（或`while`）代替。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T21:49:18.537

您可以使用 获取数组的键`Object.keys`，然后遍历它们。与 不同`for...in`，这使您可以[`.sort()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/sort)在处理它们之前选择键：

```
var keys = Object.keys(obj).sort();  // sorting is optional
for (var i=0; i<keys.length; i++) {
    var key = keys[i],
        val = obj[key];
    console.log(key+":"+val);
}; 
```

在较旧的浏览器中，您需要一个 polyfill 来启用该`Object.keys`方法。[MDN 在他们的文档页面上有一个](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/keys)。

# c# - 子表单中的用户输入

> ID：16202714
> 
> 赞同：0
> 
> 时间：2013-04-24T21:41:20.847
> 
> 标签：c#, winforms

我正在尝试从表单中获取值。我一直在尝试这个：[如何从 C# 中的表单返回值？](https://stackoverflow.com/questions/5233502/c-sharp-return-value-from-form)

它对我不起作用，也许我做错了什么，但在第二部分。

```
using (var form = new frmImportContact())
{
    var result = form.ShowDialog();
    if (result == DialogResult.OK)
    {
        string val = form.ReturnValue1;            //ReturnValue1 is not an option...
        string dateString = form.ReturnValue2;
        //Do something here with these values

        //for example
        this.txtSomething.Text = val;
    }
} 
```

我无法显示“ReturnValue1”。它被宣布为公开，我还需要做什么？

这是我写的。我的子表格：

```
namespace ASPE.GUI.SensorWizard
{
    public partial class PortsSensitivity : Form
    {
        public int ReturnValue1 { get; set; }
        public PortsSensitivity()
        {
            InitializeComponent();
        }

        private void PortsBox_ValueChanged(object sender, EventArgs e, KeyPressEventArgs m)
        {
            this.ReturnValue1 = Convert.ToInt16(PortsBox.Value);
        }

        private void PortsSensitivity_Load(object sender, EventArgs e)
        {

        }

    }
} 
```

我的主要形式：

```
 //Show Form (Number of Ports, Sensitivity)
            Form Part3 = new ASPE.GUI.SensorWizard.PortsSensitivity();
            DialogResult dr3 = new DialogResult();
            dr3 = Part3.ShowDialog();
            //Write Variables
            int numofports = Part3.ReturnValue1;  //Not an option.
            //Close Form 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:49:12.500

您的`Part3`变量被定义为`Form`不声明`ReturnValue1`属性的类型。（该`ReturnValue1`属性在您的`PortSensitivity`类上声明）。

改变

```
Form Part3 = new ASPE.GUI.SensorWizard.PortsSensitivity(); 
```

至

```
PortSensitivity Part3 = new ASPE.GUI.SensorWizard.PortsSensitivity(); 
```

您的第一个示例还在 using 语句中实例化了某种类型的东西，`frmImportContact`但您没有展示它的实现。检查您是否已在此类型上声明了属性（或者您不打算创建该`PortSensitivity`类型的实例）。

# javascript - D3js - 将垂直条形图更改为水平条形图

> ID：16202721
> 
> 赞同：15
> 
> 时间：2013-04-24T21:42:03.310
> 
> 标签：javascript, d3.js, bar-chart

我有一个成对分组的垂直条形图。我试图玩弄如何水平翻转它。在我的例子中，关键字会出现在 y 轴上，而比例会出现在 x 轴上。

我尝试切换各种 x/y 变量，但这当然只会产生奇怪的结果。我需要关注代码的哪些区域才能将其从垂直条切换到水平条？

**[`My JSFiddle: Full Code`](http://jsfiddle.net/enigmarm/juY5E/11/)**

```
var xScale = d3.scale.ordinal()
    .domain(d3.range(dataset.length))
    .rangeRoundBands([0, w], 0.05);

// ternary operator to determine if global or local has a larger scale
var yScale = d3.scale.linear()
    .domain([0, d3.max(dataset, function (d) {
    return (d.local > d.global) ? d.local : d.global;
})])
    .range([h, 0]);

var xAxis = d3.svg.axis()
    .scale(xScale)
    .tickFormat(function (d) {
        return dataset[d].keyword;
    })
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(yScale)
    .orient("left")
    .ticks(5);

var commaFormat = d3.format(',');

//SVG element
var svg = d3.select("#searchVolume")
    .append("svg")
    .attr("width", w + margin.left + margin.right)
    .attr("height", h + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

// Graph Bars
var sets = svg.selectAll(".set")
    .data(dataset)
    .enter()
    .append("g")
    .attr("class", "set")
    .attr("transform", function (d, i) {
        return "translate(" + xScale(i) + ",0)";
    });

sets.append("rect")
    .attr("class", "local")
    .attr("width", xScale.rangeBand() / 2)
    .attr("y", function (d) {
        return yScale(d.local);
    })
    .attr("x", xScale.rangeBand() / 2)
    .attr("height", function (d) {
        return h - yScale(d.local);
    })
    .attr("fill", colors[0][1])
    ;

sets.append("rect")
    .attr("class", "global")
    .attr("width", xScale.rangeBand() / 2)
    .attr("y", function (d) {
        return yScale(d.global);
    })
    .attr("height", function (d) {
    return h - yScale(d.global);
    })
    .attr("fill", colors[1][1])
    ;

    sets.append("rect")
        .attr("class", "global")
        .attr("width", xScale.rangeBand() / 2)
        .attr("y", function (d) {
        return yScale(d.global);
    })
        .attr("height", function (d) {
        return h - yScale(d.global);
    })
        .attr("fill", colors[1][1])
    ; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-08-22T02:18:08.317

我昨晚刚做了同样的事情，我基本上最终重写了代码，因为它比修复所有错误更快，但这里是我可以给你的提示。

翻转 x 和 y 轴的最大问题是`return h - yScale(d.global)`因为高度是从页面的“顶部”而不是底部计算出来的。

要记住的另一件事是，当您设置时，请`.attr("x", ..)`确保将其设置为 0（加上左侧的任何填充）所以 =`.attr("x", 0)"`

我使用本教程来帮助我用水平条来思考我自己的代码——它真的很有帮助

[http://hdnrnzk.me/2012/07/04/creating-a-bar-graph-using-d3js/](http://hdnrnzk.me/2012/07/04/creating-a-bar-graph-using-d3js/)

这是我自己的代码，如果有帮助的话，可以让它水平：

```
var w = 600;
var h = 600;
var padding = 30;

var xScale = d3.scale.linear()
        .domain([0, d3.max(dataset, function(d){
                                return d.values[0]; })]) //note I'm using an array here to grab the value hence the [0]
        .range([padding, w - (padding*2)]);

        var yScale = d3.scale.ordinal()
            .domain(d3.range(dataset.length))
            .rangeRoundBands([padding, h- padding], 0.05);

        var svg = d3.select("body")
            .append("svg")
            .attr("width", w)
            .attr("height", h)

        svg.selectAll("rect")
            .data(dataset)
            .enter()
            .append("rect")
            .attr("x", 0 + padding)
            .attr("y", function(d, i){
            return yScale(i);
            })
            .attr("width", function(d) {
                return xScale(d.values[0]);
            })
            .attr("height", yScale.rangeBand()) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-01-24T09:10:33.847

另一种方法是旋转图表（请参阅[**this**](http://jsfiddle.net/jrideout/RWs67/)）。这有点笨拙，因为您需要在头脑中维护交换的轴（高度实际上是宽度等），但如果您已经有一个工作垂直图表，它可以说更简单。

下面是一个旋转图表的示例。您可能还需要旋转文本以使其美观。

```
_chart.select('g').attr("transform","rotate(90 200 200)"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T00:59:03.537

这是我在这种情况下使用的过程：

1) 反转所有 Xs 和 Ys

2) 请记住，y 的 0 位于顶部，因此您将不得不反转许多值，因为 y 的先前值将被反转（您不希望 x 轴从左到右移动）和新的 y 轴也会被反转。

3) 确保条形图正确显示

4）如果有问题，调整图例

这个问题在某种意义上可能会有所帮助，因为它显示了如何从水平条形图变为垂直：[d3.js histogram with positive andnegative values](https://stackoverflow.com/questions/15388481/d3-js-histogram-with-positive-and-negative-values/15391554#15391554)

# javascript - 如何单击并编辑内联元素

> ID：16202723
> 
> 赞同：13
> 
> 时间：2013-04-24T21:42:05.623
> 
> 标签：javascript, ajax, jquery

我不确定它叫什么，但我希望能够单击例如`div`包含数字的 a，然后它将变为输入文本字段，其值是我单击的数字。

然后我想编辑号码，然后点击关闭（`onblur`事件），它会从显示新编辑号码的文本字段中变回 , `div`。该数字也将通过 ajax 更新到数据库中。

这个函数叫什么？
编写此代码的最佳方法是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-24T21:57:01.217

您可以执行以下操作：

有一个点击事件并动态创建一个文本框，它将 div 内的文本作为值。

即使绑定到该文本框并进行 AJAX 调用并在其成功更改 div 文本时也有模糊

假设您的 HTML 是这样的：

```
<div id="fullname">Amazing Spider man</div> 
```

您的 JS 代码将如下所示：

```
$('#fullname').click(function(){
    var name = $(this).text();
    $(this).html('');
    $('<input></input>')
        .attr({
            'type': 'text',
            'name': 'fname',
            'id': 'txt_fullname',
            'size': '30',
            'value': name
        })
        .appendTo('#fullname');
    $('#txt_fullname').focus();
});

$(document).on('blur','#txt_fullname', function(){
    var name = $(this).val();
    $.ajax({
      type: 'post',
      url: 'change-name.xhr?name=' + name,
      success: function(){
        $('#fullname').text(name);
      }
    });
}); 
```

这在这个[jsfiddle](https://jsfiddle.net/n4ky3Lzs/)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2018-02-18T04:18:33.727

HTML5 有一个[非常好的浏览器支持](https://caniuse.com/#feat=contenteditable)`contentEditable`属性，所以如果它符合你的情况并且你想不做 jquery，你可能想先探索一下。只需放入一个 div 即可使其可点击和可编辑（基本文本）。`contentEditable="true"`

要实际使用可编辑元素，您需要使用 JS 来观察元素并在有输入时触发动作。在 OP 的情况下，在 JS 中，他们会将新编辑的内容放在某处（如数组），以便 ajax 函数将其发送到外部数据库。更多信息[在这里](https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Editable_content)和[这里](https://www.w3schools.com/jsref/prop_html_contenteditable.asp)。

此外，[这里有一个插件](http://jakiestfu.github.io/Medium.js)可以更进一步，并为这些字段提供更多所见即所得的控件。

无论如何，这是一个示例代码，没有插件，没有 jquery：

```
var myEditableElement = document.getElementById('myContent');
myEditableElement.addEventListener('input', function() {
    console.log('An edit input has been detected');
    console.log(myEditableElement.innerHTML);
});
```

```
<div id="myContent" contentEditable="true">This is an editable element. Click and type something!</div>
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-24T21:46:15.283

有 jEditable： http: [//www.appelsiini.net/projects/jeditable](http://www.appelsiini.net/projects/jeditable)

但是，X-editable 看起来好多了：http: [//vitalets.github.io/x-editable/](http://vitalets.github.io/x-editable/)

![在此处输入图像描述](https://i.stack.imgur.com/V693E.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-24T21:47:38.167

为什么不只保留一个输入字段，并在模糊时更改字段样式。你可以把所有东西都拿走，这样它看起来就不像一个输入，这样就不需要来回改变了。对模糊进行 Ajax 调用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-24T21:44:00.727

它被称为 jQuery 就地编辑。jQuery 提供了许多可用的插件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-24T21:46:02.123

你已经命名了整个过程。

首先，将所有数字或字段分配给某个类。

```
<div class="editable">value</div> 
```

然后，为该类分配一个点击事件。

```
$('.editable').click(function(){
 //replace element with input element containing the value
 //attach an onblur event to the new element
 $(newelement).blur(function(){
  //use $.ajax to send the element's value to your server
  //remove the input element and then replace the previous element with the new value
 });
}); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2022-01-25T18:31:37.903

我知道这是一个旧线程，但我不久前建立了一个完全这样做的项目：[https](https://github.com/JackChilds/Preview-In-Place) ://github.com/JackChilds/Preview-In-Place 。

然后你可以像这样使用它：

```
// get element:
var el = document.querySelector('#idOfElement')
// function to process the user's data, e.g. you could convert markdown to HTML here:
function processData(data) {
  return data.toUpperCase() // do something with the data here
}
// initialise the class:
var example = new PreviewInPlace(el, {
  // options
  previewGenerator: processData // reference to the function that processes the data
})
```

```
<div id="idOfElement" class="block">
  <textarea class="edit">Some Text Here</textarea>
  <div class="preview"></div>
</div>

<script src="https://cdn.jsdelivr.net/gh/JackChilds/Preview-In-Place@main/dist/previewinplace.min.js"></script>
```

当然，你可以添加一些 CSS 让它看起来更整洁：

```
// get element:
var el = document.querySelector('#idOfElement')
// function to process the user's data, e.g. you could convert markdown to HTML here:
function processData(data) {
  return data.toUpperCase() // do something with the data here
}
// initialise the class:
var example = new PreviewInPlace(el, {
  // options
  previewGenerator: processData // reference to the function that processes the data
})
```

```
.block {
  width: 200px;
}
.block .edit {
  border: none;
  outline: none;
  border-radius: 0;
  resize: none;
}
.block .edit, .block .preview {
  padding: 8px;
  font-family: Arial, Helvetica, sans-serif;
  font-size: 16px;
}

/* Make the 'block' have a red background when in edit mode */
.block.state-edit .edit {
  background-color: rgba(131, 0, 0, 0.3);
}
/* Make the 'block' have a green background when in preview mode */
.block.state-preview .preview {
  background-color: rgba(9, 174, 0, 0.3);
}
```

```
<div id="idOfElement" class="block">
  <textarea class="edit" rows="1">Some Text Here</textarea>
  <div class="preview"></div>
</div>

<script src="https://cdn.jsdelivr.net/gh/JackChilds/Preview-In-Place@main/dist/previewinplace.min.js"></script>
```

# ruby-on-rails - 格式的自定义验证

> ID：16202724
> 
> 赞同：0
> 
> 时间：2013-04-24T21:42:06.420
> 
> 标签：ruby-on-rails, ruby, custom-validators

我有一个类链接。该类具有这些属性

1.  推特
2.  Facebook
3.  Pinterest
4.  知乎

我想编写一个验证，以确保当用户将链接插入文本框时，它以 http 或 https 开头。

验证有效，但是当用户根本不插入链接时我遇到了一个问题。它仍然尝试对空属性运行验证并引发错误。下面的代码是我检查空属性的尝试。

这是我的验证：

```
 class Links <  ActiveRecord::Base
     attr_accessible :facebook, :twitter, :quora, :pinterest

     validate :formatted_link

     def formatted_link
      links = %w(facebook twitter pinterest quora)
       if links.any? {|link| self[link].nil?}
         #Don't want it to do any validation if column is nil. 
         #Would like to drop column if user doesn't add a link.
       else
          validates_format_of links, :with => URI::regexp(%w(http https))
          errors.add(:base, "Your link must start with http or https.")
       end
    end 
```

原因：

如果用户只是提交“www.twitter.com/username”，则 url 会附加到我的网站 url“mydomain.com/page/www.twitter.com/username”。不知道为什么会这样。如果还有别的我可以做些什么来防止这种情况或我想念的东西，请告诉我。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:05:41.123

我认为您需要先将其转换`links`为符号，然后再将其传递给`validates_format_of`，但是由于它似乎对您有用，因此我可能错了，或者您上面的示例代码可能缺少该细节。

无论哪种方式，您都可以通过以下方式跳过对空白的验证：

```
validates_format_of :foo, with: some_format, allow_blank: true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T02:49:18.497

我认为您正在尝试以迂回的方式进行[条件验证](http://guides.rubyonrails.org/active_record_validations_callbacks.html#conditional-validation)。因为你真的只想允许空白，你可以这样做：

```
class Link < ActiveRecord::Base
  Networks = [:facebook, :twitter, :quora, :pinterest]
  attr_accessible *Networks

  validates_format_of *Networks, :with => URI::regexp(%w(http https)), :allow_blank => true
end 
```

# xpages - IE 10 中的 CKEditor 3.6.2 版本问题

> ID：16202727
> 
> 赞同：0
> 
> 时间：2013-04-24T21:42:27.137
> 
> 标签：xpages

CKEditor 组件在 Internet Explorer 10 中不起作用。

见[http://dev.ckeditor.com/ticket/9741](http://dev.ckeditor.com/ticket/9741)

有没有人有任何建议如何做任何解决方法？或者有人知道他们什么时候会修复它？

在此先感谢，吉克拉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T19:49:52.890

首先，IBM Domino 9 和 IBM XWork Server 9 使用 CKEditor 3.6.3，修复了 IE10 的这个 bug。

对于 8.5.3，我使用以下命令使 IE10 作为 IE9 运行，以便 CKEditor 工作：

```
<xp:this.beforeRenderResponse><![CDATA[#{javascript:
   if (context.getUserAgent().isIE()) {
     var response = facesContext.getExternalContext().getResponse();
     // Use IE9 mode because of CKEditor bugs with IE10
     response.setHeader("X-UA-Compatible", "IE=9");
   }
}]]></xp:this.beforeRenderResponse> 
```

# mysql - “来自（子查询）'表'”附近的MySQL语法错误

> ID：16202728
> 
> 赞同：1
> 
> 时间：2013-04-24T21:42:31.690
> 
> 标签：mysql, syntax-error

```
select *
from ( select * from table ) 'table1'; 
```

我不明白为什么会收到此错误：

**错误 1064 (42000)：** `You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''table1'' at line 2`

我检查了手册（[FROM 子句中的 MySQL 子查询](http://dev.mysql.com/doc/refman/5.0/en/from-clause-subqueries.html)），我看不出示例和我的小语句之间有任何区别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:45:30.520

表名/别名必须用反引号括起来或什么都不用

```
select *
from ( select * from table1 ) table1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:51:31.780

除了不在别名周围加上引号外，我相信您还需要在子查询中的“表”周围加上反引号，因为它是 MySQL 中的保留字（假设您确实将表命名为“表”）：

`select * from ( select * from `table` ) table1;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:46:00.147

我认为您想要后引号而不是前引号：

```
select *
from ( select * from table ) `table1`; 
```

前引号指定一个字符串常量。反引号分隔名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T21:46:06.257

当您有一个表的子查询时，您需要用名称声明它。

```
select * from (select * from table1) as x 
```

# jquery - 尝试将数据从 .on() 映射传递给函数

> ID：16202729
> 
> 赞同：0
> 
> 时间：2013-04-24T21:42:34.267
> 
> 标签：jquery

我目前正在研究一些 JQuery 代码，这将使工具提示在用户鼠标悬停在某些对象上时出现在用户鼠标旁边。大约有 13 个独特的工具提示，每个都有许多不同的触发器。我只是在想办法将数据传递给我的函数时遇到了一些麻烦，这样我就不必创建 13 组具有不同标识符的几乎相同的函数。这是我正在使用的代码，它可以工作，但需要多次复制：

```
jQuery(document).ready(function($){

function phpTooltipPosition(event) {
    var phptooltipX = event.pageX - 8;
    var phptooltipY = event.pageY + 8;
    $('#marpole').css({top: phptooltipY, left: phptooltipX});
}

function phpMethod(event) {
    $('#marpole').removeClass('hidden')
    phpTooltipPosition(event);
}

function phpHide() {
    $('#marpole').addClass('hidden');
}

$('.marpole').on({
    mousemove : phpTooltipPosition,
    mouseenter : phpMethod,
    mouseleave: phpHide
});
}); 
```

当我阅读这篇文章时，我读到使用 .on() 的事件映射可以使您无法将数据传递给函数......有解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:23:04.520

将 id 传递到您的函数中。

```
$('.marpole').on({
    mousemove : function(event){
        phpTooltipPosition(event,$(this));
    },
    mouseenter : function(event){
        phpMethod(event,$(this));
    },
    mouseleave: function(event){
        phpHide(event,$(this));
    }
}); 
```

然后使用它！

```
function phpTooltipPosition(event,$item) {
    var phptooltipX = event.pageX - 8;
    var phptooltipY = event.pageY + 8;
    $item.css({top: phptooltipY, left: phptooltipX});
} 
```

十分简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:44:59.370

尝试以这种风格编写代码，以帮助您区分逻辑与事件：

```
// Ensures code inside this function is called once jQuery is loaded.
jQuery(function() {

    $('div').click(function() {
        functionToCall.apply(this, arguments);
    });

});

var functionToCall = function() {
    // Actual code here
}; 
```

如果您需要来自一个主事件的多个事件，您也可以使用 jQuery 的`.on()`函数来处理它。

```
$('#outer-wrapper').on('click', '.div-you-want-evented', function() {
    // Actual code here
}) 
```

我认为这回答了你的问题？根据问题，不能 100% 确定您需要什么。

# winapi - MFC 自定义 HtmlHelp

> ID：16202732
> 
> 赞同：0
> 
> 时间：2013-04-24T21:42:37.550
> 
> 标签：winapi, visual-studio-2008, mfc, html-help

我正在对旧版 MFC 应用程序进行维护。当用户从应用程序顶部的主菜单中选择帮助 → 帮助时，我需要`OnHelp()`调用我的自定义。从我的研究中，我了解到 MFC 通常会自动拦截此命令并自行显示您的帮助文件。但是您可以覆盖此命令并自己拦截此消息。我的消息映射中有这个：

```
BEGIN_MESSAGE_MAP(MyApp, MyBaseApp)
   //{{AFX_MSG_MAP(MyApp)
   ON_COMMAND(ID_APP_ABOUT, OnAppAbout)
   ON_COMMAND(ID_HELP, OnHelp)
   //}}AFX_MSG_MAP
   // Standard file based document commands
END_MESSAGE_MAP() 
```

“关于”`OnAppAbout()`被调用，但不是我的`OnHelp()`（MFC 仍然拦截它并自行提供帮助）。我的实现非常简单：

```
void MyApp::OnHelp()
{
    // This never gets called
   MessageBox( NULL, "HtmlHelp: MyApp", "Hey", MB_OK );

   CString csHelpFile;
   csHelpFile.Format( "%s/MyHelp.chm", MyDoc::GetHelpPath() );
   ::HtmlHelp(
       NULL,
       csHelpFile,
       HELP_WM_HELP,
       NULL );
} 
```

我知道它没有被调用，因为我的 MessageBox 从未出现（我不能使用 Visual Studio 来调试它；只有消息框）。我还尝试使用消息映射和类似的实现将其楔入 , 也`CMDIFrameWnd`没有成功（此处实现了帮助菜单项的不同项目并且工作正常）。知道我需要做什么才能连接到我自己的自定义帮助功能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T23:23:37.943

您需要添加`ON_WM_HELPINFO()`到 CMainFrame 的消息映射中。在主框架的头文件中定义`afx_msg BOOL OnHelpInfo(HELPINFO* pHelpInfo);`，并在 cpp 文件中实现它：

```
BOOL CMainFrame::OnHelpInfo(HELPINFO* pHelpInfo)
{
#ifdef _DEBUG
  MessageBox( NULL, "HtmlHelp: MyApp", "Hey", MB_OK );
#endif

  CString csHelpFile;
  csHelpFile.Format( "%s/MyHelp.chm", MyDoc::GetHelpPath() );
  ::HtmlHelp(
   NULL,
   csHelpFile,
   HELP_WM_HELP,
   NULL );
  return CFrameWnd::OnHelpInfo(pHelpInfo);
} 
```

# c# - Linq To Sql 和动态数据的 DisplayName 属性

> ID：16202733
> 
> 赞同：0
> 
> 时间：2013-04-24T21:42:37.877
> 
> 标签：c#, asp.net, linq-to-sql, asp.net-dynamic-data

我目前正在使用 LINQ to SQL 构建一个用于数据访问的 ASP.NET 动态数据项目。我知道将`DisplayName`属性添加到我的一个属性将完成我所追求的，但我想避免在 LINQ to SQL 设计器生成的代码中这样做。

是否有另一种简单的方法来做我所追求的，还是我需要硬着头皮制作自己的元数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T23:31:19.937

您可以使用[`MetadataTypeAttribute`](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.metadatatypeattribute%28v=vs.100%29.aspx)MSDN 上记录的方法。

从文档中，但为了完整性（稍作改动以密封类内的元数据）：

如果您有一个`Customer`具有`Title`属性的实体，您将在`metadata class`

```
using System;
using System.Web.DynamicData;
using System.ComponentModel.DataAnnotations;

[MetadataType(typeof(Customer.CustomerMetaData))]
public partial class Customer
{

    class CustomerMetaData
    {
         // Apply RequiredAttribute
         [Required(ErrorMessage = "Title is required.")]
         public string Title;
    }

} 
```

# text - Selenium Webdriver 正在发送密钥，但字段中未显示任何文本

> ID：16202742
> 
> 赞同：0
> 
> 时间：2013-04-24T21:43:25.943
> 
> 标签：text, selenium, webdriver, field, sendkeys

我正在使用 selenium webdriver Chrome。我看到了这么奇怪的东西。我正在测试一个注册帐户。Webdriver 将进入每个字段，看起来它正在输入文本，但没有显示任何内容。字段中不显示任何文本结果。我究竟做错了什么？

```
@Test
public void testAlreadyUsedEmailSignUp() throws InterruptedException {
     driver.findElement(By.cssSelector("html body.oneColFixCtrHdr div.container div#header div#innerHeader div#menu ul div.btn-gr")).click();
    Thread.sleep(5000);
    // switch to frames inside the webpage
    driver.switchTo().frame("GB_frame"); // 1st frame
    driver.switchTo().frame(0); // 2nd frame
    driver.findElement(By.id("firstName")).click();
    driver.findElement(By.id("firstName")).sendKeys("Tester");
    driver.findElement(By.id("lastName")).sendKeys("Automater");
    driver.findElement(By.id("email")).sendKeys("test11@gmail.com");
    driver.findElement(By.id("Ppassword")).sendKeys("prd1");
    driver.findElement(By.id("confirmPPassword")).sendKeys("pass7ord1");
    driver.findElement(By.id("State")).sendKeys("I");

    driver.findElement(By.id("myInput")).sendKeys("Mike Ward");

    Thread.sleep(2000);

    driver.findElement(By.name("term")).click();
    driver.findElement(By.id("formAccSubmit")).click();

    assertEquals(driver.findElement(By.id("errorContainer")).getText(),
            "The Email field must contain a valid email address.");

    Thread.sleep(5000);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T14:00:19.493

使用下面的代码，您的问题将解决，删除 OR.getProperty 并使用您的属性。

```
String txtuserzipID = OR.getProperty("txt_UserZip_ID"); 
WebElement txtuserZipInput = driver.findElement(By.id(txtuserzipID));
txtuserZipInput.clear(); 
txtuserZipInput.sendKeys(String.valueOf(79081));
txtuserZipInput = driver.findElement(By.id(txtuserzipID));
new Actions(driver).sendKeys(driver.findElement(By.id(OR.getProperty("txt_UserZip_ID"))), 
"").perform(); 
```

希望它会起作用并解决您的问题。谢谢

# java - 如何杀死java上的线程？

> ID：16202744
> 
> 赞同：-3
> 
> 时间：2013-04-24T21:43:31.860
> 
> 标签：java, multithreading, sockets, kill

我很头疼用java杀死一个线程......我在stackoverflow上看到了很多主题，但我没有让他们处理我的代码......有人可以解释一下我如何能够在不使用deprecated的情况下杀死一个线程函数（如停止），请以安全的方式（我的线程也在运行一个套接字：DatagramSocket）。

类 p2p_app->

```
import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.net.InetAddress;
//import java.net.UnknownHostException;
import java.util.LinkedList;
import java.util.Scanner;
import java.util.StringTokenizer;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class p2p_app {

private String ip;
private Integer porta;
private LinkedList<Vizinho> vizinhos;
private String pathSharedFolder;
private String pathBootStrap;
private int exit;
//private Thread send;
//private Thread receive;
private UDPreceive udpR;

public p2p_app(String args[]) throws IOException {
    this.ip =  InetAddress.getLocalHost().getHostAddress();         
    this.vizinhos = new LinkedList<Vizinho>();
    this.exit = 0;
    //this.send=null;
    //this.receive=null;
    this.udpR=null;
    if(args.length==2){
        this.pathSharedFolder=args[0];
        this.pathBootStrap=args[1];
        System.out.println(pathSharedFolder);
        System.out.println(pathBootStrap);
    }
    else{
        this.pathSharedFolder="./";
        this.pathBootStrap="./p2p_bootstrap.conf";
        System.out.println(pathSharedFolder);
        System.out.println(pathBootStrap);
    }

    readFile(this.pathBootStrap);
    createSharedFolder(this.pathSharedFolder);
}

public void assign(String tipo,String info) //tratar o file bootstrap.conf
{

     Tipos currentTipos = Tipos.valueOf(tipo.toUpperCase());

        switch(currentTipos){

        case PATH:  if(this.pathSharedFolder==null)
                        this.pathSharedFolder = info; 
                    break;

        case PORTA: this.porta = Integer.parseInt(info);
                    break;

        case IP:    StringTokenizer st = new StringTokenizer(info,":");
                    st.nextElement();
                    String[] tokens = info.split(":");      
                    Vizinho s = new     Vizinho(tokens[0],Integer.parseInt(tokens[1]));
                    this.vizinhos.add(s);
                    break;
        default:
            break;
    }

}

public void trataLine(String line){

    Pattern p = Pattern.compile("[\\w\\./:]+");
    Matcher m = p.matcher(line);
    String tipo = "";

    while(m.find()){

        if(tipo.compareTo("")==0)
            tipo = m.group();

        else assign(tipo,m.group());

    }

}

public void readFile(String path) throws IOException{ //modifiquei este codigo para     ver se existe ou nao o ficheiro bootstrap (VASCO)

    String line;
    Pattern p = Pattern.compile("\\$");

    File f = new File(path);

    if(f.exists()){
        BufferedReader br;
        br = new BufferedReader(new FileReader(path));

        while ((line = br.readLine()) != null) {

            Matcher m = p.matcher(line);

            if(m.find() == true)
                trataLine(line);

        }

        br.close();
    }
    else{
        System.out.println("FILE :: BOOTSTRAP.CONF : Doesn't exist.");
    }
}

public void createSharedFolder(String path) {

    if(!(new File(path).exists()))  
        new File(path).mkdir();

}

public enum Tipos {

    PATH,
    PORTA,
    T1,
    T2,
    T3,
    R,
    M,
    K,
    IP
}

public String getIp(){

    return this.ip;
}

public Integer getPorta(){

    return this.porta;
}

public int getExit(){
    return this.exit;
}

public void setExit(int exit){
    this.exit = exit;
}

public LinkedList<Vizinho> getVizinhos(){

    LinkedList<Vizinho> aux = new LinkedList<Vizinho>();
    for(Vizinho c : this.vizinhos) aux.add(c);
    return aux;     
}

public String toString(){

    StringBuilder s = new StringBuilder();
    s.append("IP:"+this.ip + "\n");
    s.append("Porta:"+ this.porta +"\n");
    s.append("Directory:" + this.pathSharedFolder + "\n");
    s.append("-----Vizinhos-----");
    for(Vizinho c : this.vizinhos)
    s.append(c.toString());

    return s.toString();    
}

public void initThreads(p2p_app p2p){
    //UDPreceive udpR = new UDPreceive(p2p);
    this.udpR = new UDPreceive(p2p);
    //UDPsend udpS = new UDPsend(p2p);

    //this.receive = new Thread(udpR);
    Thread t = new Thread(udpR);
    //this.send = new Thread(udpS);

    t.start();
    //this.receive.start();
    //this.send.start();
}

@SuppressWarnings("deprecation")
public void stopThreads(){
    this.udpR.stopRun();
    //this.receive.interrupt();
    //this.receive.stop();
    //this.receive.toString();
    //this.send.interrupt();
    //this.send.toString();
}

public void menu(){
    System.out.println("1:Hello");
    System.out.println("2:Vasco");
    System.out.println("3:Exit");
}

public int choiceMenu(int i){
    int numRowsInConsole = 60;
    final String ESC = "\033[";

    switch(i){
    case 1:
        System.out.println("FUNCIONOU HELLO");
        System.out.print(ESC + "2J");
        /*for (int ii=0; ii<numRowsInConsole; ii++) {
            // scroll down one line
            System.out.println("");
        }*/
        break;
    case 2:
        System.out.println("FUNCIONOU VASCO");
        System.out.print(ESC + "2J");
        break;
    case 3:
        i=-1;
        System.out.print(ESC + "2J");
        break;
    default:
    }
    return i;

}

public static void main(String[] args) throws IOException {
    int i;

    p2p_app p2p = new p2p_app(args);
    //p2p.initThreads(p2p);
    System.out.println(p2p.toString());

    Scanner sc = new Scanner(System.in);
    while(p2p.getExit() != -1){
        p2p.menu();
        i = sc.nextInt();
        p2p.setExit(p2p.choiceMenu(i));
        System.out.println(p2p.getExit());
    }

    System.out.println("Woot woot!");

    //p2p.stopThreads();

}

} 
```

类 UDPreceive->

```
import java.io.IOException;
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.SocketException;

public class UDPreceive implements Runnable {
private p2p_app p2p;
private DatagramPacket p;

public volatile boolean stopThread = true;

public void stopRun(){
    this.stopThread=false;
}

public UDPreceive(p2p_app p2p){
    this.p2p = p2p;
}

/**
 * @param args
 */

public void run(){
    DatagramSocket socket=null;
    UDPpacket udp;
    byte[] x = new byte[1000];
    try{
        socket = new DatagramSocket(8734);
        socket.setBroadcast(true);
        //while(this.p2p.getExit() !=-1){
        while(stopThread){  
            p = new DatagramPacket(x,x.length);
            socket.receive(p);

            udp = new UDPpacket(p,this.p2p);
            udp.tostring();
            //udp.setDatagramPacket(p);

            //String d = new String(p.getData());
            //System.out.println("Mensagem enviada por mim: "+d);
        }
        //Thread.sleep(100);
    } catch (SocketException e) {
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

} 
```

}

我如何能够在 p2p_app 类中杀死我的主函数上的线程？我为我的 UDPreceiver 类创建了一个线程：F

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:47:25.337

在大多数情况下，杀死线程的唯一“安全”方法是对线程进行编码，使其可以接收到停止信号。例如，使用一个名为的布尔变量`shouldQuit`并让线程定期检查该变量，如果为真则退出。你也可以做一些事情，比如中断线程，但这并不总是安全的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T22:33:23.013

```
package test;

/**
 * simple thread class that prints '.' to the screen
 * @author Manex
 *
 */
public class ThreadTest extends Thread {
private boolean running = true ;

public void run(){
try{
    while(running){
        //do something here
        System.out.print(".");
        sleep(1000);
    }
}catch(InterruptedException e){
    System.out.println(e.getMessage());
}
    System.out.println("Stopped");
}
/**
 * a method to stop the thread
 */
public void stopRunning(){
    this.running = false ;
}

public static void main(String[] args){

    //creating threads
    ThreadTest[] t = new ThreadTest[2] ;
    t[0] = new ThreadTest() ;
    t[1] = new ThreadTest() ;

    //starting threads
    for(ThreadTest e : t){
        e.start();
    }
    try {
        //the main thread does something
        int x = 5 ;
        while(x > 0){
            sleep(1000) ;
            x -= 1 ;
        }
        //the main thread ended
        System.out.println("main thread ends here");
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    //before exiting - stop all threads 
    for(ThreadTest e : t){
        e.stopRunning();
    }
}
} 
```

如果您出于任何原因计划停止您创建的线程，您应该继续跟踪它们并保存对您可能想要停止的每个线程的引用，而不是等待它自己完成执行（运行方法简单地结束） . 在这个简单的测试中，如果您删除停止循环，线程将继续打印并且永远不会停止，直到您手动停止它们，即使在主线程终止之后也是如此。我希望这很有用..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T18:11:05.423

最后，我做到了！结果和你们说的有点不一样，我会发布我的答案，以防有人问！

解决方案是向我自己发送一个 DatagramPacket ！:)

类 udpReceiver ->

```
//package testeThread;

import java.io.IOException;
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetAddress;
import java.net.SocketException;
import java.net.SocketTimeoutException;
import java.net.UnknownHostException;

public class udpReceiver implements Runnable {
public volatile boolean stopThread = true;
private DatagramSocket socket;

//private DatagramSocket socket;

public udpReceiver() {
    // TODO Auto-generated constructor stub
    //this.socket = socket;
}

public void stopRun(){
    synchronized(this){

        this.stopThread=false;
        byte[] x = new byte[1000];
        try{
            DatagramPacket p = new DatagramPacket(x,x.length,InetAddress.getLocalHost(),8737);
            this.socket.send(p);
        } catch(UnknownHostException e){
            e.printStackTrace();
        } catch(IOException e){
            e.printStackTrace();
        }
    }
}

/**
 * @param args
 */
public void run(){
     //DatagramSocket socket=null;
     DatagramPacket p = null;
     //byte[] x = new byte[1000];
     try{
     this.socket = new DatagramSocket(8737);
     this.socket.setBroadcast(true);
     }catch(SocketException e){
         e.printStackTrace();   
     }
        //socket.setSoTimeout(5*1000); // 20 seconds
     while(stopThread){
            byte[] x = new byte[1000];
            p = new DatagramPacket(x,x.length);
            try{
            this.socket.receive(p);
            }catch(IOException e){
                e.printStackTrace();
            }

            String d = new String(p.getData());
            System.out.println("Mensagem enviada por mim: "+d);
     }
     this.socket.close();
     /* try{
        socket = new DatagramSocket(8735);
        socket.setBroadcast(true);
        //socket.setSoTimeout(5*1000); // 20 seconds
        while(stopThread){
            byte[] x = new byte[1000];
            p = new DatagramPacket(x,x.length);
            try {
              socket.receive(p);
            } catch (SocketTimeoutException e) {
              if (stopThread){
                //System.err.println("Warning: socket timed out before program completed: " + e.getLocalizedMessage());
              } else {
                // program completed, so just ignore and move on
                break;
              }
            }

            String d = new String(p.getData());

            //System.out.println("Mensagem enviada por mim: "+d);
            //System.out.println("SOCKET CLOSE"+socket.isConnected());
        }
        //socket.setSoTimeout(1000);
        socket.close();
        System.out.println("SOCKET CLOSE"+socket.isConnected());

    } catch (SocketException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException io){
        io.printStackTrace();
    }*/
    /*catch (SocketTimeoutException soc){
        if(this.stopThread == false) {
            this.stopThread = false;
        }
        soc.printStackTrace();
    }*/
}

} 
```

类服务器->

```
import java.net.DatagramSocket;
import java.net.SocketException;
import java.util.Scanner;

//package testeThread;

public class Servidor {

private int exit;

public Servidor() {
    // TODO Auto-generated constructor stub
}

public int getExit(){
    return this.exit;
}

public void setExit(int exit){
    this.exit = exit;
}

public int choiceMenu(int i){
    int numRowsInConsole = 60;
    final String ESC = "\033[";

    switch(i){
    case 1:
        System.out.println("FUNCIONOU HELLO");
        System.out.print(ESC + "2J");
        /*for (int ii=0; ii<numRowsInConsole; ii++) {
            // scroll down one line
            System.out.println("");
        }*/
        break;
    case 2:
        System.out.println("FUNCIONOU VASCO");
        System.out.print(ESC + "2J");
        break;
    case 3:
        i=-1;
        System.out.print(ESC + "2J");
        break;
    default:
    }
    return i;
}

public void menu(){
    System.out.println("1:Hello");
    System.out.println("2:");
    System.out.println("3:Exit");
}

@SuppressWarnings("deprecation")
public static void main(String[] args) {
    int i;
    Servidor s = new Servidor();

    //try{
        //DatagramSocket socket = new DatagramSocket(8735);
        udpReceiver udpR = new udpReceiver();
        Thread t = new Thread(udpR);
        t.start();

        Scanner sc = new Scanner(System.in);
        while(s.getExit() != -1){
            s.menu();
            i = sc.nextInt();
            s.setExit(s.choiceMenu(i));
            System.out.println(s.getExit());
        }
    //DatagramSocket socket = new DatagramSocket(8735);

    //socket.close();
    //t.interrupt();
    udpR.stopRun();

    try{
    t.join();
    }catch(InterruptedException e){
        e.printStackTrace();
    }
    System.out.println("MAIN FIM");
    //t.stop();
    /*}catch(SocketException e){
        e.printStackTrace();
    }*/

}

} 
```

PS：那个版本和楼上那个不一样……但是我得到了和我写另一个一样的逻辑，现在它工作得很好！我可以在不使用 CTRL+C 的情况下退出程序，它现在可以接收消息了！:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T13:26:54.890

您的 UDPReceive 线程没有停止的原因是您在 UDPReceive.run() while 循环中使用了阻塞方法[DatagramSocket.receive()](http://docs.oracle.com/javase/7/docs/api/java/net/DatagramSocket.html#receive%28java.net.DatagramPacket%29)。此方法的 JavaDocs 说：“此方法阻塞，直到收到数据报。” 块意味着永远不会返回。因此，当您希望程序退出时，带有 receive() 的线程仍在运行。它是一个“挂起的线程”，解除它的唯一方法是杀死整个进程，例如 Ctrl+C。

要修复它，请在 UDPReceive.run() while 循环开始之前调用[socket.setSoTimeout() 。](http://docs.oracle.com/javase/7/docs/api/java/net/DatagramSocket.html#setSoTimeout%28int%29)这将使对 receive() 的最终调用超时并实际完成。然后捕获如果您的套接字超时将发生的[SocketTimeoutException](http://docs.oracle.com/javase/7/docs/api/java/net/SocketTimeoutException.html)（例如，在程序结束时线程完成时，或者如果您有实际超时错误条件更早）并适当地处理异常（例如，如果触发 stopThread 只需忽略异常，或者如果 stopThread 尚未触发，则将其记录为警告）。例子：

```
public void run(){
    DatagramSocket socket=null;
    UDPpacket udp;
    byte[] x = new byte[1000];
    try{
        socket = new DatagramSocket(8734);
        socket.setBroadcast(true);
        socket.setSoTimeout(20*1000); // 20 seconds
        //while(this.p2p.getExit() !=-1){
        while(stopThread){  
            p = new DatagramPacket(x,x.length);
            try {
              socket.receive(p);
            } catch (SocketTimeoutException e) {
              if (stopThread){
                System.err.println("Warning: socket timed out " +
                    "before program completed: " + e.getLocalizedMessage());
              } else {
                // program completed, so just ignore and move on
                break;
              }
            }

            udp = new UDPpacket(p,this.p2p);
            udp.tostring();
            //udp.setDatagramPacket(p);

            //String d = new String(p.getData());
            //System.out.println("Mensagem enviada por mim: "+d);
        }
        //Thread.sleep(100);
    } catch (SocketException e) {
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

} 
```

这应该可以解决问题。*stopThread 逻辑本身看起来不错（尽管我会将布尔值重命名为 continueThread，因为当它为false*时您将停止）。

# openrefine - 在谷歌细化 / OpenRefine 中编辑/提取列表达式

> ID：16202751
> 
> 赞同：1
> 
> 时间：2013-04-24T21:43:53.867
> 
> 标签：openrefine

我正在使用 Google Refine v2.5。我创建了一个使用一些复杂逻辑从 url 获取信息的列，但我意识到我需要对其进行调整。我有什么方法可以编辑或提取我使用的表达式吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:09:20.073

用于构面、转换和列添加的所有表达式都保存在历史记录中，您可以通过单击预览对话框中的历史记录选项卡来访问。

# sql-server - 如何插入默认值作为 SQL Server 视图定义的一部分？

> ID：16202752
> 
> 赞同：5
> 
> 时间：2013-04-24T21:43:55.897
> 
> 标签：sql-server, sql-server-2008, sql-server-2008-r2

我有许多使用相同基础表的不同视图，但每个视图都使用不同的 FK 默认值。

所以对于我尝试的代码：

```
ALTER VIEW [dbo].[vwTest]
 AS
SELECT     
Id, 
C1 AS |TestCol, 
COALESCE(GroupId,3) AS GroupId 
FROM         dbo.tblTest
WHERE     (GroupId = 3) 
```

我知道“3”是硬编码的，但会被替换。

这是我认为造成麻烦的线：

```
COALESCE(GroupId,3) AS GroupId 
```

每次将记录插入 vwTest 时，我都需要将“3”插入 tblTest.GroupId。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T22:20:50.107

**在视图上创建一个代替触发器**

[SQL小提琴](http://sqlfiddle.com/#!3/37d19b/1/0)

**样品表/视图**

```
create table tblTest( id int identity, c1 varchar(10), groupid int );

create view vwtest as select c1, COALESCE(GroupId,3) GroupId 
from tblTest
where GroupID = 3; 
```

**创建触发器**

```
CREATE TRIGGER InsteadTrigger on vwTest
INSTEAD OF INSERT
AS
BEGIN
  INSERT INTO tblTest (c1, GroupID)
       SELECT c1, 3
       FROM inserted
END; 
```

**将一些测试数据放入表/视图中**

```
insert into tblTest( c1, groupid ) select 'row 1' ,3 ;
insert into tblTest( c1, groupid ) select 'row 2' ,1 ;
insert into vwTest(c1) select 'row 3'; 
```

**看看我们得到了什么**

```
select * from tblTest;
select * from vwTest; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:46:52.410

我相信做到这一点的唯一方法是在每个视图上定义一个而不是触发器。

# winforms - Mono 控制台应用程序：Winforms 方法在没有 X 的 Linux 上引发异常

> ID：16202759
> 
> 赞同：1
> 
> 时间：2013-04-24T21:44:18.487
> 
> 标签：winforms, ubuntu, mono, x11

我有一个想在 Linux 上运行的 C# 控制台应用程序。我已经在 MonoDevelop 中编译了它，并且在我的机器（Ubuntu 12.04 LTS，64 位）上运行良好。但是，在我租用的 VPS 上（相同的操作系统但没有 X11），虽然应用程序启动没有问题，但我在运行时遇到异常。

导致异常的调用是 System.Windows.Forms.TextRenderer 类的 MeasureText 方法。如果您想知道此方法在控制台应用程序中的作用，它需要测量以某种字体呈现的文本长度，以计算其创建的 SVG 文件中文本元素的正确位置。异常消息和堆栈跟踪摘录如下：

```
An exception was thrown by the type initializer for System.Windows.Forms.XplatUI

at System.Windows.Forms.TextRenderer.MeasureTextInternal (IDeviceContext dc, System.String text, System.Drawing.Font font, Size proposedSize, TextFormatFlags flags, Boolean useMeasureString) [0x00000] in <filename unknown>:0 
at System.Windows.Forms.TextRenderer.MeasureText (System.String text, System.Drawing.Font font) [0x00000] in <filename unknown>:0 
```

我想我已经在服务器上正确安装了有问题的字体，至少当我调用 fc-list 时它会显示出来。那么我需要 X 还是有办法解决它？我只是错过了服务器上的一些软件包安装吗？如果做不到这一点，是否有替代方法可以用来实现文本测量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T20:41:46.007

我尝试了上面提出的建议，它奏效了。我安装了 xvfb，现在通过 xvfb-run 运行单声道。异常消失了，服务器上的内存使用量并没有增加太多。

# batch-file - 如果 Windows“管理员”用户名已更改，批处理文件转到下一个 xcopy 命令

> ID：16202760
> 
> 赞同：2
> 
> 时间：2013-04-24T21:44:30.667
> 
> 标签：batch-file, xcopy

我希望能够只运行 xcopy 的一个实例而不是多个实例，从 USB 驱动器到 .\admin\desktop 在我插入它的计算机上，但是可能有一些我使用的计算机更改了管理员用户名以该人的名义。Windows 的管理员用户帐户是否有通用的批处理命名约定？如果是这样，我只想使用它可能是什么，而不是列出每个计算机的每个人的用户名并猜测它可能是什么而无需每次都查看。这是我到目前为止所拥有的，如果我知道“管理员”用户仍被标记为“管理员”这一事实，它会很好地工作。

```
@echo off

xcopy "%~dp0M1k_SWPCB\*.*" "C:\Documents and Settings\Admin\Desktop\SWPCB\" /d /s /h /v /c /f /k /y

pause 
```

我也尝试了“所有用户”，但在某些情况下，该目录不存在并且无法正常工作。另外，如果计算机有多个用户，我不希望它出现在每个人的桌面上。

任何帮助将非常感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T22:36:30.370

所有用户都有一个 SID 标识符，并且本地管理员帐户始终以 -500 后缀结尾，因此您可以通过检查注册表上的 SID 来获取管理员用户名：

```
@Echo OFF

FOR /F "Tokens=*" %%@ IN ('Reg Query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList" ^| FIND "-500"') DO (
    FOR /F "Tokens=2,*" %%A IN ('Reg Query "%%@" /v "ProfileImagePath" ^| FIND /V "%%@"') DO (
        Echo    Admin SID: %%~n@
        Echo Admin Folder: %%B
    )
)

Pause>NUL&Exit 
```

**输出：**

```
 Admin SID: S-1-5-21-148789306-3749789949-2179752015-500
Admin Folder: C:\Users\Administrador 
```

另一种方法是使用 VBScript，您可以在批处理文件中使用它并将管理员名称写入文本文件，然后接下来您将使用文本文件的内容设置一个变量。（我没有写这个函数）：

```
Set objNetwork = CreateObject("Wscript.Network")
objComputerName = objNetwork.ComputerName

Set objwmi = GetObject("winmgmts:{impersonationLevel=impersonate}!//" & objComputerName)
qry = "SELECT * FROM Win32_Account where Domain = '" & cstr(objComputerName) & "'"

For Each Admin In objwmi.ExecQuery(qry)
    If (Left(Admin.sid, 6) = "S-1-5-" And Right(Admin.sid,4) = "-500") Then MsgBox Admin.name)
Next 
```

PS：也许有人会发布其他解决方案，说列出组名是另一种选择......但是 groupnames 不是通用解决方案，因为母语。

# javascript - 使用 lambda 修改值

> ID：16202761
> 
> 赞同：3
> 
> 时间：2013-04-24T21:44:43.670
> 
> 标签：hogan.js, javascript, node.js, hogan.js

假设我有一个我想用[hogan.js](/questions/tagged/hogan.js "显示标记为“hogan.js”的问题")渲染的模板：

```
var template = '{{#numbers}}'
             +     '{{#capitalize}}{{percentage}}{{/capitalize}} complete.\n'
             + '{{/numbers}}'; 
```

我用ff编译它：

```
var hello = hogan.compile(template);

var rendered = hello.render({
  numbers: [
    { percentage: .3 },
    { percentage: .6 },
    { percentage: .8 }
  ],
  capitalize: function() {
    return function(num) {
      // console.log(num);
      return num * 100;
    }
  }
})

console.log(rendered) 
```

我如何得到数字乘以 100 而不是得到`NaN`？

```
NaN complete.
NaN complete.
NaN complete. 
```

此外，当您取消注释上面的行时，`num = {{percentage}}`而不是数字本身。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-25T00:23:31.713

根据@akonsu 的回复，这里有一个示例，说明如何在 Hogan.js 中获取 lambda 的值。

我在示例中有两个辅助函数`manual`和`automatic`，它们可以根据所需的行为环绕 lambda 函数定义。

```
var source = '{{#numbers}}'
           +     'test1 = {{#test1}}{{percentage}}{{/test1}}\n'
           + '{{/numbers}}'
           + '{{#numbers}}'
           +     'test2 = {{#test2}}{{percentage}}{{/test2}}\n'
           + '{{/numbers}}';

var template = Hogan.compile(source);

var renderer = function(context) {
    return function(text) {
        return template.c.compile(text, template.options).render(context);
    };
};

var manual = function(lambda) {
    return function(text) {
        var render = renderer(this);
        return lambda.call(this, text, render);
    };
};

var automatic = function(lambda) {
    return manual(function(text, render) {
        return lambda.call(this, render(text));
    });
};

var rendered = template.render({
    numbers: [
        { percentage: .3 },
        { percentage: .6 },
        { percentage: .8 }
    ],
    test1: manual(function(text, render) {
        return render(text) * 100;
    }),
    test2: automatic(function(num) {
        return num * 100;
    })
});

console.log(rendered); 
```

输出如下所示：

```
test1 = 30
test1 = 60
test1 = 80
test2 = 30
test2 = 60
test2 = 80 
```

这是一个演示解决方案的 jsfiddle：http: [//jsfiddle.net/potatosalad/h5cU4/2/](http://jsfiddle.net/potatosalad/h5cU4/2/)

请注意，此解决方案不适用于部分（如果它们是从 lambda 部分内部引用的）。

Hogan.js 2.0.0 的相关代码是[lambda 替换部分](https://github.com/twitter/hogan.js/blob/gh-pages/builds/2.0.0/hogan-2.0.0.js#L175-L195)和[高阶函数](https://github.com/twitter/hogan.js/blob/gh-pages/builds/2.0.0/hogan-2.0.0.js#L158-L167)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-04T20:25:50.517

```
capitalize: function(num) {
   return num * 100;
} 
```

应该为你工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T22:44:00.767

我认为这个例子是相关的：[https](https://github.com/janl/mustache.js#functions) ://github.com/janl/mustache.js#functions 。我的猜测是这应该会有所帮助：

```
capitalize: function() {
  return function(text, render) {
    return render(text) * 100;
  }
} 
```

类似的帖子：[How to get the value when using Lambda in Hogan.js](https://stackoverflow.com/questions/14460350/how-to-get-the-value-when-using-lambda-in-hogan-js)

# java - 在java中，关于访问修饰符，“世界”这个词是什么意思？

> ID：16202763
> 
> 赞同：2
> 
> 时间：2013-04-24T21:44:50.677
> 
> 标签：java, modifiers

我在 stackoverflow 上看到了一篇文章，其中有关于 java 中的访问修饰符的简单而清晰的摘要。我明白只有一件事很奇怪：“世界”这个词代表什么？这是什么意思？

我已经删除了模式摘要的显示，因为渲染很奇怪：s 所以请看下面的链接>>>

这是帖子的链接： [在 Java 中，default、public、protected 和 private 之间的区别](https://stackoverflow.com/questions/215497/in-java-whats-the-difference-between-public-default-protected-and-private)

提前谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:50:27.923

这意味着如果我有这样的课程：

```
package com.example;

public class Foo {
    public int bar;
} 
```

我可以从这个词的最一般含义的“外部”访问它，例如：

```
package com.client;         // not in the same package of `Foo`

class Client {              // not a subclass of `Foo`
    Foo foo = new Foo();    // possible because `Foo` is world-visible
    public int foobar() {
        return foo.bar;     // possible because `bar` is world-visible
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:48:04.247

“World”是使用包外部的非反射引用时的可见性描述，如在库引用中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:48:13.047

World 意味着您可以调用该方法，或访问该字段或类，无论代码是在哪里编写的，无论包装、子类等如何。

如果您愿意，它甚至可以是“宇宙”。

# android - 解析 JSONObject 并将它们设置在视图中

> ID：16202772
> 
> 赞同：-1
> 
> 时间：2013-04-24T21:45:56.353
> 
> 标签：android, json

我正在 ping 服务器以获取`JSON`响应。这是响应的样子：

```
{
"notifications":{
  "0":{
     "id":"17546",
     "uID":"6698",
     "text":"Earned 22 points for searching",
  },
  "1":{
     "id":"17545",
     "uID":"6698",
     "text":"Earned 1 point for searching",
  },
  "2":{
     "id":"17544",
     "uID":"6698",
     "text":"Earned 1 point for searching",
  },
  "3":{
     "id":"17543",
     "uID":"6698",
     "text":"Earned 1 point for searching",
  },
  "4":{
     "id":"17528",
     "uID":"6698",
     "text":"Earned 1 point for searching",
  },
  "notificationCount":5 
```

} }

我收到了从服务器收到的全部通知。我怎样才能将其用于我的目的。

我必须解析“文本”获取`text`并将其粘贴到视图上。我做错了。这是我所做的：

```
JSONObject jNotification0 = jSearchData.getJSONObject("0");
JSONObject jNotification1 = jSearchData.getJSONObject("1");
JSONObject jNotification2 = jSearchData.getJSONObject("2");
JSONObject jNotification3 = jSearchData.getJSONObject("3");
JSONObject jNotification4 = jSearchData.getJSONObject("4");

String jText0 = jNotification0.getString("text");
String jText1 = jNotification1.getString("text");
String jText2 = jNotification2.getString("text");
String jText3 = jNotification3.getString("text");
String jText4 = jNotification4.getString("text");

TextView notificationText1 = (TextView) dialogLoggedInNotification.findViewById(R.id.notificationText1);
TextView notificationText2 = (TextView) dialogLoggedInNotification.findViewById(R.id.notificationText2);
TextView notificationText3 = (TextView) dialogLoggedInNotification.findViewById(R.id.notificationText3);
TextView notificationText4 = (TextView) dialogLoggedInNotification.findViewById(R.id.notificationText4);
TextView notificationText5 = (TextView) dialogLoggedInNotification.findViewById(R.id.notificationText5);

notificationText1.setText(jText0);
notificationText2.setText(jText1);
notificationText3.setText(jText2);
notificationText4.setText(jText3);
notificationText5.setText(jText4); 
```

我想这不是我应该进行解析的方式。请指导我。

任何形式的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T22:22:41.587

你听说过[格森](https://code.google.com/p/google-gson/)吗？它可以帮助您将 JSON 对象解析为 Java 对象。不过，您的 JSON 数据有点奇怪。为什么响应的通知没有存储在数组中，而是存储在单独的 JSON 对象中？

我的意思是为什么不：

```
{
    "notification": [
         {
              "id":"17546",
              "uID":"6698",
              "text":"Earned 22 points for searching",
         },
         {
              "id":"17545",
              "uID":"6698",
              "text":"Earned 1 point for searching",
         },
         {
              "id":"17544",
              "uID":"6698",
              "text":"Earned 1 point for searching",
         },
         {
              "id":"17543",
              "uID":"6698",
              "text":"Earned 1 point for searching",
         },
         {
              "id":"17528",
              "uID":"6698",
              "text":"Earned 1 point for searching",
         }
    ],
    "notificationCount": 5
} 
```

如果你能有这样的东西，GSON 是非常容易使用的。创建这些 Java Bean：

```
public class JsonObj {
    private List<Notification> list;
    private int notificationCount;

    public JsonObj { }

    public JsonObj(List<Notification> list, int notificationCount) {...}

    public List<Notification> getList() {...}

    .... get/set methods
}

public class Notification {
    private Long id;
    private Long uID;
    private String text;

    public Notification { }

    public Notification(Long id, Long uId, String text) {...}

    public Long getId() {...}

    .... get/set methods
} 
```

然后，当您获得 Json 字符串时，只需执行以下操作：

```
JsonObj obj = new Gson().fromJson(jsonData, JsonObj.class); 
```

要获取文本：

```
String txt = obj.getList().get(index).getText(); 
```

注意：您也可以通过`getList().size();`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T22:12:53.523

只需遍历结果并设置文本。

```
for (int i = 0; i<totalNotification; i++)
{
    TextView notificationText = (TextView) dialogLoggedInNotification.findViewById(findId(i));
    notificationText.setText((String)jSearchData.getJSONObject(Integer.toString(i)).get("text"));      
} 
```

查找 ID 的辅助函数

```
public int findId(int idIn)
{
    switch (idIn)
    {
        case 1:
            return R.id.notificationText1;
        case 2:
            return R.id.notificationText2;
        case 3:
            return R.id.notificationText3;
        case 4:
            return R.id.notificationText4;
        case 5:
            return R.id.notificationText5;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T22:17:02.780

如果您的 jSearchData 是正确的对象，那么这应该有效

```
String text = jSearchData.getJSONObject("0").getString("text"); 
```

您可以为此创建一个循环。此外，您的回复有一个不需要的逗号。

```
 "0":{
     "id":"17546",
     "uID":"6698",
     "text":"Earned 22 points for searching"**,** //<-- This comma should not exist  
  } 
```

# struts - 找不到 Struts bean

> ID：16202776
> 
> 赞同：0
> 
> 时间：2013-04-24T21:46:03.410
> 
> 标签：struts, struts-1, struts-html

我在使用 Struts 时遇到问题。它没有识别 bean，即使它在上面定义了一行

我有这个代码

```
<logic:iterate id="com" name="Handler" property="commandList">
23:                             <optgroup id="${com.id}" style="display:none;">
24:                                 <logic:iterate id="rem" name="com" property="remotes">
25:                                     <option value="${rem.id}"><bean:write name="rem" property="name"/></option>
26:                                 </logic:iterate>
27:                             </optgroup>
28:                         </logic:iterate> 
```

我在第 25 行收到以下错误：

```
javax.servlet.ServletException: javax.servlet.jsp.JspException: Cannot find bean: "rem" in any scope 
```

这没有意义，因为 bean 是在第 24 行上面定义的

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T08:42:03.280

正如您所说，您的代码语法是正确的。我的猜测是`remotes`bean 的对象之一是空值。在这种情况下，根据[struts1 参考](http://struts.apache.org/development/1.x/struts-taglib/tagreference.html#logic%3aiterate)：

> 如果您正在迭代的集合可以包含空值，则仍将执行循环，但不会为该循环迭代创建页面范围属性（由 id 属性命名）。您可以使用 `<logic:present>`and`<logic:notPresent>`标签来测试这种情况。

标签将`<bean:write name="rem" property="name"/>`被执行，但 rem 不会存在于任何范围内。检查 Array/List/Map/etc 中的空值`remotes`，或使用`<logic:present>`标签添加测试。

# php - 多维数组 - 拉取数据

> ID：16202781
> 
> 赞同：0
> 
> 时间：2013-04-24T21:46:36.597
> 
> 标签：php, multidimensional-array

PHP 新手，在这里花了几个小时研究之后，似乎没有什么是我所需要的。我有一个多维数组，我希望从中提取数据和 COUNT。例如：

```
array (
  'loyola' => NULL,
  'gold_coast' => NULL,
  'lincolnpark' => 
  array (
    0 => 'Building 1',
    1 => 'Building 2',
    2 => 'Building 3',
    3 => 'Building 4'
  ),
  'lakeview' => 
  array (
    0 => 'Building 1',
    1 => 'Building 2',
    2 => 'Building 3'

  ),
) 
```

我希望基本上创建一个列出所有建筑物的表格，并在下一列中列出该建筑物出现的次数。

这是我到目前为止所得到的，但它只显示所有建筑物。

```
$buildings = unserialize($row['buildings']);
$lincolnpark = $buildings['lincolnpark'];
$loyola= $buildings['loyola'];
$gold_coast = $buildings['gold_coast'];
$lakeview = $buildings['lakeview'];

foreach ($lakeview as $value)
{                       
    echo $value;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:50:02.783

分两次执行：一次用于计算单独数组中的建筑物出现次数，另一次用于输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T22:38:18.547

试试下面的代码。它将递归地导航到数组中，并打印每个构建出现的 qtd。

```
<?php

$arr = array (
        'loyola' => NULL,
        'gold_coast' => NULL,
        'lincolnpark' =>
        array (
                0 => 'Building 1',
                1 => 'Building 2',
                2 => 'Building 3',
                3 => 'Building 4'
        ),
        'lakeview' =>
        array (
                0 => 'Building 1',
                1 => 'Building 2',
                2 => 'Building 3'

        ),
);
$ret = array();

countBuildings($arr);

foreach($ret as $key=>$value){
    echo "Building: $key ==> qtd : $value <br>";
}
function countBuildings($arr = array()){
    global $ret;
    foreach($arr as $value){
        if(is_array($value)){
            countBuildings($value);
        }else{
            if($value != NULL){
                if(isset($ret[$value])){
                    $ret[$value] += 1;
                }else{
                    $ret[$value] = 1;
                }
            }
        }
    }
} 
```

# javascript - 对文本块的延迟自动滚动效果

> ID：16202783
> 
> 赞同：2
> 
> 时间：2013-04-24T21:46:44.050
> 
> 标签：javascript, autoscroll

我对 JS 很陌生……请温柔一点。

谁能建议一种方法来对文本块产生延迟的自动滚动效果？

值得一提的是，我的最终目标是在 iOS 设备上的弹出模式窗口中使用它。而且因为 iOS 浏览器在用户交互之前不会显示滚动条，所以我使用了自动滚动。

实际上：我想加载页面，等待几秒钟，然后开始慢慢向下滚动。滚动旨在向用户提示有更多可用内容，因此，如果有任何方法可以停止或暂时暂停用户交互时的自动滚动，那将是最佳选择。

我已经搜索了几个小时的答案，但是在无法将找到的代码初始化到我的设计（再次，我相当环保）和无法找到实现我需要的一切的解决方案之间 - 我我正在转向更聪明的头脑。

我用我的 HTML 和 CSS 设置了一个小提琴：http: [//jsfiddle.net/zfMsQ/](http://jsfiddle.net/zfMsQ/)

任何帮助是极大的赞赏！

ps：这是我在 StackOverflow 上的第一篇文章 :)

我的代码：

```
Extensive. Linked above. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T22:10:11.970

给你：http: [//jsfiddle.net/zfMsQ/3/](http://jsfiddle.net/zfMsQ/3/)

```
var roll = true;
var max = 0;
var text = $("#content");

function scroll() {
    text.scrollTop(text.scrollTop() + 1)
    var top = text.scrollTop()
    if (top > max) {
        max = top
        if (roll) {
            setTimeout(scroll, 50)
        }
    }
}

text.on("mouseenter mouseover mousedown", function(){
 roll = false;   
})

setTimeout(scroll, 2000) 
```

# c# - C# Pars html 字符串标记文本

> ID：16202784
> 
> 赞同：0
> 
> 时间：2013-04-24T21:46:45.783
> 
> 标签：c#, html, wpf, parsing

我想解析一个 HTML 字符串，如：

```
<b><a href="/wiki/Schizophrenie" title="Schizophrenie">Schizophrenie</a></b> ist eine schwere psychische Erkrankung. Sie 
```

或者

```
 <h2 class="sectionedit2" id="zu_treffende_massnahmen">zu treffende Maßnahmen</h2>
<div class="level2">
<ul><li class="level1"><div class="li">An- und Abfahrtswege freihalten; Einweisung nachrückender Kräfte, evtl. Einbahnregelung vorsehen</div> 
```

这样所有的 Text 都会获得一些额外的字体样式元素 ( `<font style = "color:red;">..</font>`)，例如：

```
<b><a href="/wiki/Schizophrenie" title="Schizophrenie"><font style = "color:red;">Schizophrenie</font></a></b><font style = "color:red;"> ist eine schwere psychische Erkrankung. Sie</font> 
```

或者

```
<h2 class="sectionedit2" id="zu_treffende_massnahmen"><font style = "color:red;">zu treffende Maßnahmen</font></h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"><font style = "color:red;"> An- und Abfahrtswege freihalten; Einweisung nachrückender Kräfte, evtl. Einbahnregelung vorsehen</font></div> 
```

有没有简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:21:47.070

如果您要制作一个 html 查看器或编辑器 - avalonedit 可以这样做：

[http://www.codeproject.com/Articles/42490/Using-AvalonEdit-WPF-Text-Editor](http://www.codeproject.com/Articles/42490/Using-AvalonEdit-WPF-Text-Editor)

它已经为 html 提供了 syntaxhighlight 定义——确实是一个不错的控件。

但如果是自己动手的挑战 - 你可以从这里开始：

[http://khason.net/blog/richtextbox-syntax-highlighting/](http://khason.net/blog/richtextbox-syntax-highlighting/)

# mysql - MySQL - 返回所有没有预订的人？

> ID：16202788
> 
> 赞同：1
> 
> 时间：2013-04-24T21:46:56.227
> 
> 标签：mysql

我正试图让 MySQL 将所有在某个时间没有预订的讲师归还给我。此查询本质上是搜索查询。因此，返回所有基本上尚未预订的教练及其详细信息。有人可以帮我完成它吗？

```
SELECT
  AddressTypes.AddressTypeName,
  Addresses.*,
  InstructorSettings.*,
  Users.*,
  BookedSlots.DateTime
FROM Users
  LEFT OUTER JOIN InstructorSettings
    ON Users.UserID = InstructorSettings.UserID
  LEFT OUTER JOIN Addresses
    ON Users.UserID = Addresses.UserID
  INNER JOIN AddressTypes
    ON Addresses.AddressTypeID = AddressTypes.AddressTypeID
  LEFT OUTER JOIN BookedSlots
    ON Users.UserID = BookedSlots.UserID
WHERE Users.AccountTYpe = 3 AND Addresses.PostCode1 IN ('l13') AND BookedSlots.DateTime <> '2013-04-25 11:00:00' 
```

上面的查询没有返回任何内容，但如果我取出“AND BookedSlots.DateTime <> '2013-04-25 11:00:00'”，它会返回所有讲师的详细信息。

数据库

![](https://i.stack.imgur.com/SnB4V.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T13:36:33.203

要检查特定时间段上没有任何预订，请在加入条件中包含时间段并选择时间段 id 为空的位置 - 如下所示：

```
SELECT
  AddressTypes.AddressTypeName,
  Addresses.*,
  InstructorSettings.*,
  Users.*,
  BookedSlots.DateTime
FROM Users
  LEFT OUTER JOIN InstructorSettings
    ON Users.UserID = InstructorSettings.UserID
  LEFT OUTER JOIN Addresses
    ON Users.UserID = Addresses.UserID
  INNER JOIN AddressTypes
    ON Addresses.AddressTypeID = AddressTypes.AddressTypeID
  LEFT OUTER JOIN BookedSlots
    ON Users.UserID = BookedSlots.UserID AND 
                      BookedSlots.DateTime = '2013-04-25 11:00:00'
WHERE Users.AccountTYpe = 3 AND 
      Addresses.PostCode1 IN ('l13') AND 
      BookedSlots.UserID is null 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T22:06:29.773

在我看来，您正在寻找的是在指定时间内 BookedSlots*中不存在记录*。

我不确定这是否被认为是 MySQL 最佳实践，但我通常不是使用 a `join`，而是使用子选择或临时表来完成该任务，如下所示：

```
SELECT
  AddressTypes.AddressTypeName,
  Addresses.*,
  InstructorSettings.*,
  Users.*,
FROM Users
  LEFT OUTER JOIN InstructorSettings
    ON Users.UserID = InstructorSettings.UserID
  LEFT OUTER JOIN Addresses
    ON Users.UserID = Addresses.UserID
  INNER JOIN AddressTypes
    ON Addresses.AddressTypeID = AddressTypes.AddressTypeID
WHERE Users.AccountType = 3 AND Addresses.PostCode1 IN ('l13') 
AND Users.UserID not in (SELECT BookedSlots.InstructorID FROM BookedSlots 
     WHERE BookedSlots.DateTime = '2013-04-25 11:00:00') 
```

编辑：根据评论，将选择语句更改为排除 BookedSlots，并将子选择更改为返回 InstructorId（在预订时匹配教师而不是学生）。

# apache - 重写 URL SEO

> ID：16202789
> 
> 赞同：0
> 
> 时间：2013-04-24T21:46:56.947
> 
> 标签：apache, .htaccess, url, mod-rewrite, seo

我的网站有这样的网址

```
http://www.mydomain.com/index.php?page=doctors&docid=99 
```

使用 SEO 重写

```
RewriteRule ^doctors/([0-9]+)/(.*).html$ index.php?page=doctors&docid=$1 [L] 
```

我明白了

```
www.mydomain.com/doctors/13/Dr.-John-Smith.html 
```

但我想要一个像这样更友好的网址

```
www.mydomain.com/Dr.-John-Smith.html 
```

我怎样才能获得这个网址。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:00:44.310

重写查询字符串

如果您受雇从头开始重建现有网站，您可能会使用 URL 重写将旧网站上的 20 个最受欢迎的 URL 重定向到新网站上的位置。这可能涉及将 prod.php?id=20 之类的内容重定向到 products/great-product/2342，它本身会被重定向到实际的产品页面。

Apache 的 RewriteRule 仅适用于 URL 中的路径，不适用于 id=20 之类的参数。要进行这种类型的重写，您需要参考 Apache 环境变量 % `{QUERY_STRING}`。这可以像这样完成：

```
RewriteEngine On
RewriteCond   %{QUERY_STRING}           ^id=20$                   
RewriteRule   ^prod.php$             ^products/great-product/2342$      [L,R=301]
RewriteRule   ^products/(.*)/([0-9]+)$  ^productview.php?id=$1             [L] 
```

在此示例中，第一个 RewriteRule 触发从旧网站的 URL 到新网站的 URL 的永久重定向。第二条规则将新 URL 重写为显示产品的实际 PHP 页面。

我希望这会有所帮助，在这里了解更多关于重写的信息：http: [//coding.smashingmagazine.com/2011/11/02/introduction-to-url-rewriting/](http://coding.smashingmagazine.com/2011/11/02/introduction-to-url-rewriting/)

它以非常直接的方式布局。希望对您有所帮助，如果您还有其他问题，请告诉我。谢谢你。

# node.js - 使用 Node.js 从字符串上传文件到 Box API

> ID：16202792
> 
> 赞同：2
> 
> 时间：2013-04-24T21:47:13.040
> 
> 标签：node.js, express, box-api

我正在使用 Box API 的第 2 版并尝试上传文件。我的 Oauth 2 都可以正常工作，但是在进行实际上传时遇到了麻烦。

我正在使用 Node.js 和 Express，以及“请求”模块。我的代码看起来像这样：

```
request.post({
  url: 'https://upload.box.com/api/2.0/files/content',
  headers: {
    Authorization: 'Bearer ' + authToken
  },
  form: {
    filename: ????,
    parent_id: '0'
  }
}, function (error, response, body) {
  // ...
}); 
```

现在，我正在尝试上传到根文件夹，如果我理解正确，该文件夹的 ID 为“0”。

我*真的*不确定给“文件名”赋予什么价值。我没有要读取的真实文件，但我确实有一个长字符串表示我要上传的文件内容。

我应该如何最好地上传这个“文件”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T02:41:43.503

对于 Box，我相信您想使用 requests 多部分/表单数据实现。它应该看起来像这样：

```
var request = require('request');
var fs = require('fs');

var r = request.post(...);
var form = r.form();
form.append('filename', new Buffer("FILE CONTENTS"), {filename: 'file.txt'});
form.append('parent_id', 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-21T06:49:41.840

```
var fs = require('fs');
var request = require('request');
var path = require('path');

function requestCallback(err, res, body) {
    console.log(body);
}

var accessToken = 'SnJzV20iEUw1gexxxxvB5UcIdopHRrO4';
var parent_folder_id = '1497942606';

var r = request.post({
    url: 'https://upload.box.com/api/2.0/files/content',
    headers: { 'Authorization': 'Bearer ' + accessToken }
    }, requestCallback);

var form = r.form();
form.append('folder_id', parent_folder_id);
form.append("filename", fs.createReadStream(path.join(__dirname, 'test.mp4'))); 
```

# jquery - JQuery + 用 ; 查找复选框 在身份证

> ID：16202794
> 
> 赞同：1
> 
> 时间：2013-04-24T21:47:22.537
> 
> 标签：jquery

我目前正在使用 Jquery 来更改第 3 方产品并遇到了这个特殊的限制......我认为

目前，复选框 ID 和名称值具有 ; 在里面见下文

```
<input id="K48_h6;547ECE8D417501D623E11F94E0DF94FD" name="K48_1" value="h6;547ECE8D417501D623E11F94E0DF94FD" type="checkbox" style="cursor: pointer;"> 
```

我试图强制 Jquery 选中此框。这是我现在拥有的 Jquery。

```
$("#K48_h6;547ECE8D417501D623E11F94E0DF94FD").prop("checked",true); 
```

这导致我有一个对象不支持此属性或方法。

由于这是第 3 方产品，因此我无法使用 ;，Jquery 在服务器端代码加载后运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:56:00.047

`id`除了转义，这是一个很好的解决方案，在作为属性过滤时似乎不存在此限制，如下所示：

```
$("input[id='K48_h6;547ECE8D417501D623E11F94E0DF94FD']").prop("checked",true); 
```

查看[**工作演示**](http://tinker.io/9612c)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:51:05.067

使用原生 JS`document.getElementById()`而不仅仅是 jQuery。

[http://jsfiddle.net/droppedonjapan/ppFSh/1/](http://jsfiddle.net/droppedonjapan/ppFSh/1/)

# 编辑

如果您需要将该元素包装在 jQuery 中，您可以在使用 getElementById() 捕获元素后包装它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T21:53:08.093

您是否考虑过转义（注意`\\`前面的`;`）无效字符：

```
jQuery(function() {
    $('#K48_h6\\;547ECE8D417501D623E11F94E0DF94FD').prop('checked',true);
}) 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/ppFSh/2/)。

请注意，我不特别建议尝试解决在您`id`的 s 中使用无效字符的问题，我会*认真*且非常强烈地建议您更改您正在使用的任何 3rd 方产品，以便能够生成*有效* `id`属性/属性的产品。

# python - OpenCV 中的分水岭

> ID：16202798
> 
> 赞同：1
> 
> 时间：2013-04-24T21:47:29.373
> 
> 标签：python, opencv

我想使用分水岭方法对图像进行过度分割。阅读文档，我需要使用 findContour 和 drawContour 函数来创建标记。我该如何使用它？

这是我当前的代码，

```
import cv2
import numpy as np

im=cv2.imread('balls.jpg')
marker=np.zeros(im.shape[:2])
marker[::30,::30]=200
marker=np.int32(marker)

cv2.watershed(im,marker)
out=cv2.convertScaleAbs(marker)

cv2.namedWindow('Out')
cv2.imshow('Out', out)
cv2.waitKey() 
```

P/S：关于这个还有另一个问题，但他们使用了其他方法（基于前景和背景。我想改用轮廓）。

这是我的目标：产生图像的过度分割：

![在此处输入图像描述](https://i.stack.imgur.com/gL1N5.jpg)

输入图像可以从这里下载： http: [//decsai.ugr.es/~javier/denoise/peppers256.png](http://decsai.ugr.es/~javier/denoise/peppers256.png)

# java - 读取两个文件，然后找到增长率

> ID：16202803
> 
> 赞同：-3
> 
> 时间：2013-04-24T21:47:47.917
> 
> 标签：java

我需要帮助来阅读两个包含 2010 年和 2000 年人口普查的文件。我必须阅读这两个文件，然后找出这两个文件之间的人口增长。我一直在为单个状态获取 null。我知道我对 inLine1 和 inLine2 有空值。

文件看起来像这样

```
Alabama,4779736
Alaska,710231
Arizona,6392017
Arkansas,2915918 
```

## 代码：

```
 import java.util.ArrayList;
import java.util.Scanner;
import java.io.*;
public class pa10
{
  public static void main(String[] args, char[] inLine2, char[] inLine1)
    throws java.io.IOException
  {
    String fileName1 = "Census2000growth.txt";
    String fileName2 = "Census2010growth.txt";
    int i;

    File f = new File("Census2010growth.txt");
    if(!f.exists()) {
        System.out.println( "file does not exist ");
    }
    Scanner infile = new Scanner(f);
    infile.useDelimiter ("[\t|,|\n|\r]+"); //create a delimiter 
    final int MAX = 51;
    int [] myarray = new int [MAX];
    String[] statearray = new String[MAX];
    int fillsize;

      // set up input stream1
    FileReader fr1 = new
        FileReader(fileName1);
      // buffer the input stream
    BufferedReader br1 =
        new BufferedReader(fr1);

      // set up input stream2
    FileReader fr2 = new
        FileReader(fileName2);
      // buffer the input stream
    BufferedReader br2 =
        new BufferedReader(fr2);

      // read and display1
    String buffer1 = "";

    ArrayList<String> firstFile1 = new ArrayList<String>();
    while ((buffer1 = br1.readLine()) != null) {
        firstFile1.add(buffer1);
      System.out.println(inLine1);  // display the line
  }
  br1.close();

    //Now read the second file or make for this separate method
      // read and display2
    String buffer2 = "";

    ArrayList<String> firstFile2 = new ArrayList<String>();
    while ((buffer2 = br2.readLine()) != null) {
        firstFile2.add(buffer2);
      System.out.println(inLine2);  // display the line
  }
  br2.close();

    //Read all the lines in array or list
    //After that you can calculate them.
 }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:51:55.667

阅读`BufferedReader`文档。您的文件未使用预期的行分隔符类型进行格式化。我建议使用 a`Scanner`并将行分隔符设置为适当的模式，或者使用`String.split`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:52:36.953

您有两个不同的变量，`buffer1`并且`inline1`. 由于您从未设置 的值`inline1`，因此它将始终为`null`。

# grails - Grails 2.1 dateCreated 在域保存时间歇性地为空

> ID：16202805
> 
> 赞同：0
> 
> 时间：2013-04-24T21:47:55.663
> 
> 标签：grails, grails-orm, grails-2.0, datecreated

**tl：博士；**这有点涉及问题，欢迎任何建议，感谢提前阅读:)

我和我的同事一直在为我们的批处理应用程序中的奇怪行为而苦苦挣扎。我们最近将它从 Grails 1.3.7 升级到 2.1

堆栈跟踪显示以下错误：

```
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: 
  Cannot insert the value NULL into column 'date_created', 
  table 'dev.dbo.notification_log'; column does not allow nulls. INSERT fails.
  ...
[quartzScheduler_Worker-1] [||] ERROR hibernate.AssertionFailure  - an assertion failure occured (this may indicate a bug in Hibernate, but is more likely due to unsafe use of the session)
org.hibernate.AssertionFailure: null id in com.virtuwell.domain.NotificationLog entry (don't flush the Session after an exception occurs)
    at org.quartz.core.QuartzScheduler.notifyJobListenersWasExecuted(QuartzScheduler.java:1891)
    at org.quartz.core.JobRunShell.notifyJobListenersComplete(JobRunShell.java:352)
    at org.quartz.core.JobRunShell.run(JobRunShell.java:223)
    at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:546)

[quartzScheduler_Worker-1] [||] ERROR listeners.SessionBinderJobListener  - Cannot flush Hibernate Sesssion, error will be ignored
org.hibernate.AssertionFailure: null id in com.virtuwell.domain.NotificationLog entry (don't flush the Session after an exception occurs)
    at org.quartz.core.QuartzScheduler.notifyJobListenersWasExecuted(QuartzScheduler.java:1891)
    at org.quartz.core.JobRunShell.notifyJobListenersComplete(JobRunShell.java:352)
    at org.quartz.core.JobRunShell.run(JobRunShell.java:223)
    at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:546) 
```

这是该特定域对象（NotificationLog）的代码

```
class NotificationLog implements Serializable{
    Date dateCreated
    Notification notification
    NotificationDeliveryState deliveryState
    String message

    static mapping = {
       message type: 'text'
    }
} 
```

然而，奇怪的是，每次持久化域对象时都不会发生此错误，并且我们在代码中只有一个位置会持久化对象，如下所示：

```
class NotificationLogService {

    boolean transactional = true

    def logNotification(Notification notification, message, deliveryState) {

        def notificationLog = new NotificationLog(
                notification: notification,
                deliveryState: deliveryState,
                message:message
        )

        try{
            notificationLog.save(failOnError:true)
        } catch (Exception e) { // Failure to save a notificationLog should not rollback the calling transaction
            log.error "NotificationLog State:[$deliveryState] for notification:${notification?.id} did not save. Errors: ${notificationLog?.errors}, Message:$message", e
        }

    }
} 
```

我们在下面的 SO 问题中发现了一种解决方法的“hack”，通过将其添加到域对象中，我们不再定期在日志中看到错误

```
static mapping = {
    autoTimestamp true
} 
```

但这不是我们看到的唯一一个域，SAME 定期保存失败（因此，我需要将映射添加到其他域），如果这确实是`dateCreated`在 Grails 2.1 中正常运行所必需的，我需要将其添加到更多域！

更糟糕的是，我无法在单元或集成测试中重现它，它只发生在我们正在运行的开发和 QA 实例上。

## 所以，**2个问题：**

1.  有谁知道为什么这个错误可能会定期发生？

2.  如果没有，有没有办法可以将此映射*全局*`autoTimestamp true`添加到我项目的所有域对象（除了将其设置为之外，我根本找不到有关如何添加它的文档`false`）

**相关的 SO 问题：** [Grails 2.0 中的 dateCreated、lastUpdated 字段](https://stackoverflow.com/questions/9052292/datecreated-lastupdated-fields-in-grails-2-0)

**相关 Grails 邮件列表讨论** [http://grails.1312388.n4.nabble.com/dateCreated-lastUpdated-in-Grails-2-0-td4337894.html](http://grails.1312388.n4.nabble.com/dateCreated-lastUpdated-in-Grails-2-0-td4337894.html)

**关于 autoTimestamp GORM 属性的相关 Grails 文档** [http://grails.org/doc/latest/guide/GORM.html#eventsAutoTimestamping](http://grails.org/doc/latest/guide/GORM.html#eventsAutoTimestamping)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T22:55:33.017

要回答这两个问题：

1.  **编辑**尝试`flush: true`，`save`否则`autoTimestamp true`是最后的手段。我没有研究找出这个问题的原因。

2.  您可以设置此属性`Config.groovy`以使其适用于所有`domain`类。

    ```
    grails.gorm.default.mapping = {
        autoTimestamp true //or false based on your need
    } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:59:42.790

您是否尝试在创建新的 NotificationLog 时手动插入日期？像这样：

```
class NotificationLogService {

boolean transactional = true

def logNotification(Notification notification, message, deliveryState) {

    def notificationLog = new NotificationLog(
            dateCreated: new Date(),
            notification: notification,
            deliveryState: deliveryState,
            message:message
    )

    try{
        notificationLog.save(failOnError:true)
    } catch (Exception e) { // Failure to save a notificationLog should not rollback the calling transaction
        log.error "NotificationLog State:[$deliveryState] for notification:${notification?.id} did not save. Errors: ${notificationLog?.errors}, Message:$message", e
    }

} 
```

}

# nhibernate - 另一个类中的链接属性上的 NHibernate JoinQueryOver

> ID：16202810
> 
> 赞同：0
> 
> 时间：2013-04-24T21:48:20.680
> 
> 标签：nhibernate, queryover

简单地说，我有这 3 个类

```
class Bag { int Id; }

class Candy { int Id; }

class CandyBag
{
    int Id;
    Candy candy;
    Bag bag;
} 
```

我需要列出所有包含某种糖果的包，我认为它是这样的：

```
session.QueryOver<Bag>(() => bagAlias)
    .JoinQueryOver<CandyBag>()
        .Where(candyBag => candgyBag.Bag.Id == bagAlias.Id)
        .And(candyBag => candgBag.Candy.Id == userSelectedCandy.Id)
    .List(); 
```

问题是，我不能在 Bag 类中拥有 CandyBag 或 Candy 的属性，因为我有更多的包可以容纳的物品（如 Cloth/ClothBag Food/FoodBag）。我这么说是因为我做不到

```
session.QueryOver<Bag>(() => bagAlias)
    .JoinQueryOver<CandyBag>(bag => bag.CandyBag, () => candyBagAlias)
        .Where(candyBag => candyBag.Bag.Id == bagAlias.Id)
    .List(); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-22T20:25:16.443

根据您的示例，我创建了此类：

```
public class Bag { 
    public int Id {get; set;} 
}
public class Candy {
    public int Id { get; set; } 
}
public class CandyBag
{
    public int Id { get; set; }
    public Candy Candy { get; set; }
    public Bag Bag { get; set; } 
} 
```

和这个 NHibernate 映射

```
 <class name="Bag" table="Bag" lazy="false" >
        <id name="Id">
            <generator class="identity" />
        </id>
        <!--<property name="CreationDate" />-->
    </class>
    <class name="Candy" table="Candy" lazy="false" >
        <id name="Id">
            <generator class="identity" />
        </id>
        <!--<property name="CreationDate" />-->
    </class>
    <class name="CandyBag" table="CandyBag" lazy="false" >
        <id name="Id">
            <generator class="identity" />
        </id>
        <many-to-one name="Candy" column="CandyId" lazy="false" />
        <many-to-one name="Bag" column="BagId" lazy="false" />
    </class> 
```

获得某糖果包的收集：

```
IList<Bag> bags = null;
using (var session = OpenSession())
{
    CandyBag candyBagAlias = null;
    bags = session.QueryOver<CandyBag>(() => candyBagAlias)     
        .Where(() => candyBagAlias.Candy.Id == userSelectedCandyId )
        .List()
        .Select(cb => cb.Bag).ToList();

    // or with LINQ
    bags = (
        from bag in session.Query<Bag>()
        join candyBag in session.Query<CandyBag>() on bag equals candyBag.Bag
        where candyBag.Candy.Id == userSelectedCandyId 
        select bag 
    ).ToList();
}
return bags; 
```

我更喜欢 LINQ 方式，因为它非常容易理解。

# ember.js - Ember this.get('controller') 返回一个父控制器

> ID：16202811
> 
> 赞同：0
> 
> 时间：2013-04-24T21:48:23.703
> 
> 标签：ember.js

我有一个`graphHolderController`呈现这个模板的：

```
{{#each controller.graphs}}
  {{view sidePanelView}}
  {{view graph}}
{{/each}} 
```

在`SidePanelView`，我想调用一个方法`SidePanelController`，但是我发现在`SidePanelView`，`this.get('controller')`返回一个实例`graphHolderController`。如何在`SidePanelController`from上调用方法`SidePanelView`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:53:13.860

问题是`{{view}}`helper 确实渲染了您作为第一个参数传递的视图，但绑定了与父视图中相同的控制器。

`graphHolderController`如果您需要知道动作来自哪个图表，请将您的方法移动到并将模型作为该动作的参数发送。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-26T14:02:45.420

如果您希望视图由其自己的单独控制器管理，我建议使用 render helper: `{{render sidePanel}}`。这将呈现由和 单例`side_panel`支持的模板。`sidePanelView``sidePanelController`

如果`sidePanelController`需要管理特定模型的状态，请将该模型作为上下文传递：（`{{render sidePanel this}}`其中`this`表示模型）。这将生成一个新的非单例`sidePanelController`来管理这个模型。由于您在一个`{{each}}`块内进行渲染，我猜您想采用这种方法。

# c# - 为什么我的非关闭流仍然关闭？

> ID：16202816
> 
> 赞同：3
> 
> 时间：2013-04-24T21:48:47.560
> 
> 标签：c#, serialization, stream

我有一个非关闭流类，它包含在带有二进制读取器的 using 块中，但由于某种原因，当块结束时，我的非关闭流仍然关闭。

流定义为：

```
internal class NonClosingStream : Stream, IDisposable
{
    private Stream baseStream;

    public NonClosingStream(Stream baseStream)
    {
        this.baseStream = baseStream;
    }

    public override bool CanRead{ get { return baseStream.CanRead; } }
    public override bool CanSeek{ get { return baseStream.CanSeek; } }
    public override bool CanWrite { get { return baseStream.CanWrite; } }

    public override void Flush()
    {
        baseStream.Flush();
    }

    public override long Length { get { return baseStream.Length; } }

    public override long Position
    {
        get { return baseStream.Position; }
        set { baseStream.Position = value; }
    }

    public override int Read(byte[] buffer, int offset, int count)
    {
        return baseStream.Read(buffer, offset, count);   
    }

    public override long Seek(long offset, SeekOrigin origin)
    {
        return baseStream.Seek(offset, origin);
    }

    public override void SetLength(long value)
    {
        baseStream.SetLength(value);
    }

    public override void Write(byte[] buffer, int offset, int count)
    {
        baseStream.Write(buffer, offset, count);
    }

    public override void Close()
    {
        // Disconnects from base stream, but does not close it
        this.baseStream = null;
    }

    void IDisposable.Dispose()
    {
        // Disconnects from base stream, but does not close it
        this.baseStream = null;
    }
} 
```

读取块如下所示：

```
public T Deserialize<T>(Stream stream)
{
    using (NonClosingStream nonClosingStream = new NonClosingStream(stream))
    using (BinaryReader reader = new BinaryReader(nonClosingStream, Encoding.ASCII, true))
    {
        // Read the type name, then convert it to an actual type
        String typeName = reader.ReadString();
        Type graphType = AvailableTypes.GetType(typeName);

        // If a deserializer for this type already exists, use it.
        if (deserializerFunctions.ContainsKey(graphType))
        {
            return (T)deserializerFunctions[graphType](reader);
        }

        // Otherwise, create one and use it
        T graph = (T)FormatterServices.GetUninitializedObject(graphType);

        typeof(ServiceSerializer).GetMethod("DeserializeObject",
                BindingFlags.NonPublic | BindingFlags.Static)

            .MakeGenericMethod(graphType)
            .Invoke(this, new Object[] { reader, graph });

        return graph;
    }
} 
```

我究竟做错了什么？

**更新**

所以我写了这个小家伙：

```
static void Main()
{
    MemoryStream stream = new MemoryStream();
    using (NonClosingStream nonCloser = new NonClosingStream(stream))
    using (BinaryWriter writer = new BinaryWriter(nonCloser))
    using (BinaryReader reader= new BinaryReader(nonCloser))
    {
        writer.Write("Lorem ipsum");

        stream.Seek(0, SeekOrigin.Begin);
        String data = reader.ReadString();

        Console.WriteLine(data);
    }

    stream.Seek(0, SeekOrigin.Begin);

    using (NonClosingStream nonCloser = new NonClosingStream(stream))
    using (BinaryWriter writer = new BinaryWriter(nonCloser))
    using (BinaryReader reader = new BinaryReader(nonCloser))
    {
        writer.Write("Lorem ipsum");

        stream.Seek(0, SeekOrigin.Begin);
        String data = reader.ReadString();

        Console.WriteLine(data);
    }

    Console.ReadLine();
} 
```

它似乎工作正常，流保持打开状态，就像它应该的那样。所以我认为共识是正确的。不知何故，我正在关闭其他地方的流。当我弄清楚我会发布结果时。谢谢大家。

**更新**

Gaaaahhh，我发现了问题。因此，代码的工作方式是在序列化/反序列化对象时，然后从表达式树构建自定义序列化器，然后对其进行编译，以便将来的序列化更加流畅。这意味着我的代码充满了这样的东西：

```
Action<BinaryReader, Object> assignmentAction = delegate(BinaryReader bReader, Object oGraph)
{
    bReader.ReadByte();      // Read the next action
    bReader.ReadString();    // Read the field name
    bReader.ReadByte();      // Read the field type

    // Call the assignment lambda
    assignmentLambda(reader, deserializerFunctions[primitiveType], (T)oGraph);
}; 
```

你抓到了吗？不？我显然也没有。让我们添加一些上下文：

```
private static void DeserializeObject<T>(BinaryReader reader, T graph)
{
    ...

    Action<BinaryReader, Object> assignmentAction = delegate(BinaryReader bReader, Object oGraph)
    {
        bReader.ReadByte();      // Read the next action
        bReader.ReadString();    // Read the field name
        bReader.ReadByte();      // Read the field type

        // Call the assignment lambda
        assignmentLambda(reader, deserializerFunctions[primitiveType], (T)oGraph);
    };

    ...
} 
```

lambda 正在`reader`从外部块关闭，而不是`bReader`在缓存的反序列化程序运行时使用提供的。因此，当反序列化器运行时，它使用的是已经丢弃的二进制读取器对象，而不是提供给它的新读取器对象。我想问题不在于我正在关闭流，而在于我使用的是已处置的阅读器。至少这解释了为什么它会工作一次，然后第二次失败，因为第二次它依赖于缓存的反序列化器。哎呀！

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T21:59:55.003

由于您的流不会创建内部流，因此外部代码很可能会关闭您的内部流。您的代码可能如下所示：

```
 NonClosingStream nonClosing;
 using(var stream = new FileStream(...))
 {
   nonClosing = new NonClosingStream(stream );
  ....
 } 
 // inner stream now closed and nonClosing will fail all operations. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T00:54:21.837

```
void IDisposable.Dispose() 
```

你的类有**两个**Dispose() 方法。您明确实施的那个。以及您从 Stream 类继承的那个。问题是，BinaryStream 不知道你的 bean。它只知道 Stream 实现的那个。此外，当您使用 BinaryStream(Stream) 构造函数时，BinaryStream 对象将承担传递的 Stream 对象的所有权。这意味着它会在它自己处置时处置该流。也许您现在看到了问题，继承的 Dispose() 方法将被调用，而不是您的。它关闭了基本流。

这就是 Stream 实现 Dispose 模式的原因。你需要让它看起来像这样：

```
internal class NonClosingStream : Stream {
    protected override Dispose(bool disposing) {}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:57:03.907

这取决于您的 NonClosingStream 类包装的流是否在其他地方引用。如果不是，那么底层流将没有引用，因此在之后的某个时刻，它的终结器将关闭该流。

# wcf - 使用 winDbg 解释故障转储中的数据

> ID：16202818
> 
> 赞同：3
> 
> 时间：2013-04-24T21:48:51.893
> 
> 标签：wcf, windbg

我正在尝试调试不时崩溃的 WCF 服务。我使用 adplus 创建了一个故障转储文件，这很简单，我使用了这个命令。

```
adplus.exe -crash -pmn myservicehost.exe -o c:\dump 
```

我正在使用 winDbg x64 版本 6.2.9200 打开文件 .dmp 文件。当我查看线程时！线程我看到有一堆线程正在等待回调完成（我认为）。

```
0:031> ~~[1b00]s
ntdll!NtWaitForMultipleObjects+0xa:
00000000`778d18ca c3              ret
0:029> ~~[1b00]s
ntdll!NtWaitForMultipleObjects+0xa:
00000000`778d18ca c3              ret 
```

最终它崩溃了。这是我使用 !PrintException /d -nested 00000002814ad6d0 查看该异常的调用堆栈时的输出

```
Exception object: 00000002814af4c8
Exception type:   System.Runtime.CallbackException
Message:          A user callback threw an exception.  Check the exception stack and inner exception to determine the callback that failed.
InnerException:   System.ServiceModel.CommunicationObjectAbortedException, Use !PrintException 00000002814ad6d0 to see more.
StackTrace (generated):
    SP               IP               Function
    000000000FA89D40 000007FEDD9AD3E2 System_ServiceModel_ni!System.ServiceModel.Channels.CommunicationObject.OnClosed()+0x262
    000000000FA8C240 000007FEDD93759D System_ServiceModel_ni!System.ServiceModel.ServiceHostBase.OnClosed()+0x6d
    000000000FA8C290 000007FEDD9433D0 System_ServiceModel_ni!System.ServiceModel.ServiceHost.OnClosed()+0x10
    000000000FA8C2C0 000007FEDE185B86 System_ServiceModel_ni!System.ServiceModel.Channels.CommunicationObject.Abort()+0x2b6
    000000000FA8C3C0 000007FE8ABAC89C MyCompany_WcfApp_WcfAppServiceHost!MyCompany.WcfApp.WcfAppServiceHost.WcfAppServiceHost.FaultedServiceHandler(System.Object, System.EventArgs)+0x26c
    000000000FA8C5F0 0000000000000000 mscorlib_ni!System.EventHandler.Invoke(System.Object, System.EventArgs)+0x1
    000000000FA8C5F0 000007FEDE184E9A System_ServiceModel_ni!System.ServiceModel.Channels.CommunicationObject.OnFaulted()+0x1ca
    000000000FA8C670 000007FEDE184784 System_ServiceModel_ni!System.ServiceModel.Channels.CommunicationObject.Fault()+0x94
    000000000FA8C6E0 000007FEDE184E9A System_ServiceModel_ni!System.ServiceModel.Channels.CommunicationObject.OnFaulted()+0x1ca
    000000000FA8C760 000007FEDE184784 System_ServiceModel_ni!System.ServiceModel.Channels.CommunicationObject.Fault()+0x94
    000000000FA8C7D0 000007FEDE184E9A System_ServiceModel_ni!System.ServiceModel.Channels.CommunicationObject.OnFaulted()+0x1ca
    000000000FA8C850 000007FEDE184784 System_ServiceModel_ni!System.ServiceModel.Channels.CommunicationObject.Fault()+0x94
    000000000FA8C8C0 000007FEDE475407 System_ServiceModel_ni!System.ServiceModel.Channels.MsmqInputChannelBase.TryReceive(System.TimeSpan, System.ServiceModel.Channels.Message ByRef)+0x4f7
    000000000FA8EBF0 000007FEDE5409AE System_ServiceModel_ni!System.ServiceModel.Dispatcher.InputChannelBinder.TryReceive(System.TimeSpan, System.ServiceModel.Channels.RequestContext ByRef)+0x2e
    000000000FA8EC50 000007FEDEAC29E2 System_ServiceModel_ni!System.ServiceModel.Dispatcher.ErrorHandlingReceiver.TryReceive(System.TimeSpan, System.ServiceModel.Channels.RequestContext ByRef)+0x646022
    000000000FA8ECB0 000007FEDE47C8D6 System_ServiceModel_ni!System.ServiceModel.Dispatcher.ChannelHandler.TryTransactionalReceive(System.Transactions.Transaction, System.ServiceModel.Channels.RequestContext ByRef)+0x396
    000000000FA8ED70 000007FEDE47BE07 System_ServiceModel_ni!System.ServiceModel.Dispatcher.ChannelHandler.TransactedLoop()+0xb7
    000000000FA8EDF0 000007FEDE47BD31 System_ServiceModel_ni!System.ServiceModel.Dispatcher.ChannelHandler.SyncTransactionalMessagePump()+0x21
    000000000FA8EE20 000007FEDE47A829 System_ServiceModel_ni!System.ServiceModel.Dispatcher.ChannelHandler.OnStartSyncMessagePump(System.Object)+0x209
    000000000FA8EED0 000007FEDB6DE651 System_ServiceModel_Internals_ni!System.Runtime.IOThreadScheduler+ScheduledOverlapped.IOCallback(UInt32, UInt32, System.Threading.NativeOverlapped*)+0x71
    000000000FA8EF30 000007FEDB77A260 System_ServiceModel_Internals_ni!System.Runtime.Fx+IOCompletionThunk.UnhandledExceptionFrame(UInt32, UInt32, System.Threading.NativeOverlapped*)+0x9bcd0
    000000000FA8EF90 000007FEDF225C26 mscorlib_ni!System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32, UInt32, System.Threading.NativeOverlapped*)+0x96 
```

问题是，这并没有真正帮助我。我需要找出是什么造成了所有这些锁。有人对我如何做到这一点有任何建议吗？我从来没有遇到过需要这种级别的调试的问题，老实说，我不是 100% 确定我在做什么。如果我没有提供足够的信息，请告诉我，我很乐意为您提供我能提供的任何其他信息。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-02T16:20:49.093

如果有死锁，请尝试使用`!SyncBlk`SOS 命令确定死锁。

# php - Postfix - Html 电子邮件包含随机字符

> ID：16202827
> 
> 赞同：1
> 
> 时间：2013-04-24T21:49:51.773
> 
> 标签：php, imap, postfix-mta

我将我的`postfix`电子邮件存储到`mysql`.

我注意到一些邮件中出现了一些奇怪的字符，而其他电子邮件则没有。所以，这是随机的。

这是我看到的：

```
--1001534069-1142425087-1366837456=:47630
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable

=0A=0AConfirmation: We received your membership (one-year) p=
ayment  =0A=0A   =0A =0A =0A  =0A =0A =0A =0A=0A Confirmation:: We received =
your membership (one-year) payment=0AHi John Smith,=0AWe re=
............

--1001534069-1142425087-1366837456=:47630
Content-Type: text/html; charset=utf-8
Content-Transfer-Encoding: quoted-printable

<html><body><div style=3D"color:#000; background-color:#fff; font-family:ti=
mes new roman, new york, times, serif;font-size:12pt"><div><br></div><div s=
tyle=3D"font-family: 'times new roman', 'new york', times, serif; font-size=
: 12pt;"><div style=3D"font-family: 'times new roman', 'new york', times, s=
erif; font-size: 12pt;"><div class=3D"y_msg_container"><div id=3D"yiv684532=
7653"><div>=0A    <div class=3D"yiv6845327653moz-forward-container">=0A    =
  =0A      <title>Confirmation: We received your membership=
............................ 
```

我包括了两种内容类型，奇怪的字符相当引人注目。我将每封电子邮件保存到一个列类型中：`text`，并带有排序规则：`utf8_unicode_ci`

对于那些对我使用什么来提取我的后缀电子邮件感兴趣的人，我正在使用 PHP`imap_*`函数。

无论如何，有谁知道为什么那些奇怪的角色会被插话？（而其他电子邮件具有完美的 html 或纯文本？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T22:31:17.270

那是引用的可打印编码。您需要撤消可能引用 printable 或 base64 的 content-transfer-encoding。

# scheme - 创建一个以列表为参数的过程

> ID：16202829
> 
> 赞同：2
> 
> 时间：2013-04-24T21:50:08.990
> 
> 标签：scheme, racket

我是计划中的新手，我正在尝试编写一个始终找到列表尾部第一个元素的过程。这在递归调用中很重要。

这是我的程序：

```
(define second (lambda (x) (car(cdr(x)))) 
```

这就是我尝试检查它是否正确运行的方式：

```
>(define x (list 1 2 3 4))
>(second x) 
```

这是错误：

```
procedure application: expected procedure, given: (1 2 3 4) (no arguments)

 === context ===
stdin::184: second
/usr/share/racket/collects/racket/private/misc.rkt:85:7 
```

可能是什么问题？你能给我一个灵感吗？我对“第二”的定义是错误的还是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:53:44.590

您的代码中有一对额外的、不必要的括号。这修复了它：

```
(define second (lambda (x) (car (cdr x)))) 
```

需要明确的是，这是错误的：`(cdr(x))`. 正确的形式是：`(cdr x)`。请记住，每当您需要将函数`f`应用于参数`x`时，正确的方法是：`(f x)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:54:23.633

Scheme 使用 S 表达式，因此`car(x)`您应该使用`(car x)`. 在你的情况下，这意味着 `(car (cdr x))`，不是`car(cdr(x))`。

# php - 带有尺寸表的 MySQL 购物项目表

> ID：16202832
> 
> 赞同：1
> 
> 时间：2013-04-24T21:50:29.503
> 
> 标签：php, mysql, left-join

请伸出援助之手。

我有一个包含以下内容的项目表

```
item_id(pk), name, price, color 
```

然后我有一张尺寸表

```
item_id(fk), size, count, sequence 
```

我试图让用户搜索一个 LEFT JOIN 语句的项目

```
SELECT table.*, sizes.* FROM item LEFT JOIN sizes ON size.item_id = item.item_id 
```

问题是我需要不重复具有多种尺寸的项目的结果，我还想知道如何只显示尺寸计数大于 0 的项目

希望有人可以帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T22:00:44.927

您将需要使用一些聚合和分组依据

首先只在输出中选择你需要的字段（例如你不想要大小所以不要包括它）

你想要'count'字段的总和 - 所以使用 sum 函数

您需要按未汇总的字段进行分组

并且您可以使用 where 子句（假设没有负数）或 have 子句来排除零行

```
SELECT item_id, item.name, item.price, item.color, sum(size.count) 
FROM item LEFT JOIN sizes 
where sizes.count > 0
ON sizes.item_id = item.item_id
group by item_id, item.name, item.price, item.color 
```

# ios - 除了显示警报之外，SKDownloadStateFailed 该怎么办？

> ID：16202834
> 
> 赞同：4
> 
> 时间：2013-04-24T21:50:35.337
> 
> 标签：ios, objective-c, in-app-purchase, storekit

我找不到`StoreKit`正确处理`SKDownloadStateFailed`. 充其量他们显示一个`UIAlertView`. 我无法以编程方式重试下载吗？用户应该如何重新下载 Apple 托管的内容？

我发现的唯一方法是重新开始购买。但这首先询问用户是否要花钱。在此之后，它会告诉用户他已经购买了它并且可以免费下载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-14T01:15:37.523

您可以通过先暂停所有下载然后恢复所有下载来重新启动下载。以下是我使用的辅助方法。请注意，我使用了一个实例变量，其中包含对正在下载的每个 SKTransaction 的强引用。

```
- (void)pauseAllDownloads {
    METHOD;
    for (SKPaymentTransaction *transaction in self.transactionsBeingDownloaded) {
        [[SKPaymentQueue defaultQueue] pauseDownloads:transaction.downloads];
    }
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];  //stop the dl activity icon in the status bar
}

- (void)resumeAllDownloads {
    METHOD;
    if (self.transactionsBeingDownloaded.count == 0) {
        [self restoreCompletedTransactions];
    } else {
        for (SKPaymentTransaction *transaction in self.transactionsBeingDownloaded) {
            NSLog(@"state: %i", transaction.transactionState);
            [[SKPaymentQueue defaultQueue] resumeDownloads:transaction.downloads];
        }
    }
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:YES];  //show the dl activity icon in the status bar
} 
```

# jquery - 从 html() 方法中删除存储的元素

> ID：16202839
> 
> 赞同：0
> 
> 时间：2013-04-24T21:51:15.153
> 
> 标签：jquery

我正在尝试从我存储在 html() 方法的变量中的代码块中删除一些元素。例子。

```
<div id="block">
  <div id="temp"><span>dsgdgdgdgdg</span></div>
  <ul>
    <li>dsfdsfsdfds</li>
    <li>dsfdsfsdfds</li>
    <li>dsfdsfsdfds</li>
  </ul>

</div> 
```

JS代码

```
 var html = $('#block').html();
    html.remove('#temp'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:53:29.567

你应该把它转过来：

```
$('#block #temp').remove(); 
```

这将删除每个元素`id = "temp"`的后代`id = "block"`

您正在尝试搜索 HTML，但 html 只是一个字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:58:04.323

一旦你有了一个字符串，你就不能再在它上面调用 jQuery 方法了。您必须从字符串重新创建 jQuery 对象，但您可以只创建 jQuery 对象的副本以开始，删除 div，然后获取 html 字符串，而不是这样做：

```
var $block = $('#block').clone();
$('#temp', $block).remove();
var html = $block.html(); 
```

[JSFiddle](http://jsfiddle.net/78whr/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T21:59:29.453

您的代码中有两个问题需要克服。

第一种是`remove(selector)`从与选择器匹配的集合中删除项目的方法，您不想这样做，您想删除子元素。

第二个是你的`html`变量是一个包含 html 的字符串，而不是一个 jQuery 对象。

这是一种克服两者的方法...

```
var html = $('#block');

// Some other code...

$('#temp', html).remove(); 
```

更新...上面的示例从原始块中删除了元素，要对字符串进行操作，您需要将其带回 jQuery 对象 - 这是一个示例...

```
var html = $('#block').html();

var test = $('<div />').html(html); // get string into a jQuery object
$('#temp', test).remove(); // remove the temp element
html = test.html(); // get the update html string

alert(html); 
```

# sql - 使用连接插入缺失的行

> ID：16202852
> 
> 赞同：3
> 
> 时间：2013-04-24T21:52:24.607
> 
> 标签：sql, sql-server, tsql

我有一个返回这个派生表的 SQL 脚本。

```
MM/YYYY  Cat    Score
01/2012  Test1  17
02/2012  Test1  19
04/2012  Test1  15
05/2012  Test1  16
07/2012  Test1  14
08/2012  Test1  15
09/2012  Test1  15
12/2012  Test1  11
01/2013  Test2  10
02/2013  Test2  15
03/2013  Test2  13
05/2013  Test2  18
06/2013  Test2  14
08/2013  Test2  15
09/2013  Test2  14
12/2013  Test2  10 
```

如您所见，我缺少一些 MM/YYYY（03/2012、06/2012、11/2012 等）。

我想用 Cat 和 0（零）填写缺少的 MM/YYYYs 分数。

我试图加入一个表，其中包含将运行查询的范围的所有 MM/YYYY，但这只会返回第一次出现的缺失行，它不会为每个 Cat 重复（应该知道这一点）。

所以我的问题是，我可以使用连接来执行此操作，还是必须在临时表中执行此操作，然后输出数据。

AHIGA、LarryR……</p>

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-24T21:58:48.977

您需要交叉加入您的类别和范围内所有日期的列表。由于您没有发布任何表格结构，我将不得不稍微猜测您的结构，但假设您有一个日历表，您可以使用如下内容：

```
SELECT  calendar.Date,
        Category.Cat,
        Score = ISNULL(Scores.Score, 0)
FROM    Calendar
        CROSS JOIN Catogory
        LEFT JOIN Scores
            ON Scores.Cat = Category.Cat
            AND Scores.Date = Calendar.Date
WHERE   Calendar.DayOfMonth = 1; 
```

如果您没有日历表，您可以使用系统表生成日期列表`Master..spt_values`：

```
 SELECT  Date = DATEADD(MONTH, Number, '20120101')
    FROM    Master..spt_values
    WHERE   Type = 'P'; 
```

其中硬编码日期“20120101”是您范围内的第一个日期。

**附录**

如果您需要实际插入缺失的行，而不仅仅是填写空白的查询，您可以使用以下命令：

```
INSERT Scores (Date, Cat, Score)
SELECT  calendar.Date,
        Category.Cat,
        Score = 0
FROM    Calendar
        CROSS JOIN Catogory
WHERE   Calendar.DayOfMonth = 1
AND     NOT EXISTS
        (   SELECT  1
            FROM    Scores
            WHERE   Scores.Cat = Category.Cat
            AND     Scores.Date = Calendar.Date
        ) 
```

虽然，在我看来，如果您有一个查询来填补插入数据的空白，这有点浪费时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T21:58:38.320

要获得您想要的，请从驱动程序表开始，然后使用`left outer join`. 结果是这样的：

```
select driver.cat, driver.MMYYYY, coalesce(t.score, 0) as score
from (select cat, MMYYYY
      from (select distinct cat  from t) c cross join
           themonths  -- use where to get a date range
     ) driver left outer join
     t
     on t.cat = driver.cat and t.MMMYYYY = driver.MMYYYY 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T07:02:08.837

试试这个——

```
DECLARE @temp TABLE (FDOM DATETIME, Cat NVARCHAR(50), Score INT)

INSERT INTO @temp (FDOM, Cat, Score)
VALUES 
    ('20120101', 'Test1', 17),('20120201', 'Test1', 19),
    ('20120401', 'Test1', 15),('20120501', 'Test1', 16),
    ('20120701', 'Test1', 14),('20120801', 'Test1', 15),
    ('20120901', 'Test1', 15),('20121001', 'Test1', 13),
    ('20121201', 'Test1', 11),('20130101', 'Test1', 10),
    ('20130201', 'Test1', 15),('20130301', 'Test1', 13),
    ('20130501', 'Test1', 18),('20130601', 'Test1', 14),
    ('20130801', 'Test1', 15),('20130901', 'Test1', 14),
    ('20131201', 'Test1', 10),('20120601', 'Test2', 10)

;WITH enum AS 
(
    SELECT Cat, StartDate = MIN(FDOM), EndDate = MAX(FDOM)
    FROM @temp
    GROUP BY Cat

    UNION ALL

    SELECT Cat, DATEADD(MONTH, 1, StartDate), EndDate
    FROM enum 
    WHERE StartDate < EndDate
)
SELECT e.StartDate, t.Cat, Score = ISNULL(t.Score, 0)
FROM enum e
LEFT JOIN @temp t ON e.StartDate = t.FDOM AND e.Cat = t.Cat
ORDER BY e.StartDate, t.Cat 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T22:02:13.063

从“完整表”到“不完整表”进行左连接，并设置 where 语句来检查“不完整”表的日期列。因此，您只会在选择查询中获得缺失的结果。之后，只需在之前设置一个“插入表名”。

在第一次运行中，它将找到两行，它们尚未在不完整的表中。所以它会被`insert into`语句插入，影响两行。在第二次运行中，select 语句中的结果有 0 行，所以什么也没有发生。零行受影响:-)

示例：[http](http://sqlfiddle.com/#!2/895fe/6) ://sqlfiddle.com/#!2/895fe /6 （只需标记 select 语句；insert into 语句不需要只是查看，join 是如何工作的）

```
Insert Into supportContacts

Select * FROM 

(

Select
'01/2012' as DDate,   'Test1' as Cat,  17  as Score
UNION 
Select
'02/2012' as DDate,   'Test1' as Cat,  17  as Score
UNION 
Select
'03/2012' as DDate,   'Test1' as Cat,  17  as Score
UNION 
Select
'04/2012' as DDate,   'Test1' as Cat,  17  as Score
UNION 
Select
'05/2012' as DDate,   'Test1' as Cat,  17  as Score

) CompleteTable

LEFT JOIN

(

Select
'01/2012' as DDate,   'Test1' as Cat,  17  as Score
UNION 
Select
'02/2012' as DDate,   'Test1' as Cat,  17  as Score
UNION 
Select
'03/2012' as DDate,   'Test1' as Cat,  17  as Score

) InCompleteTable

ON CompleteTable.DDate = IncompleteTable.DDate

WHERE IncompleteTable.DDate is null 
```

# cassandra - Cassandra SSTable 用于跨节点的列族

> ID：16202855
> 
> 赞同：0
> 
> 时间：2013-04-24T21:52:55.867
> 
> 标签：cassandra

我正在运行“nodetool cfstat”，它会返回该节点/机器上每个列族的 Keyspace 和 cfstats 列表。cfstats 结果具有每个列族的 SSTable 计数值。我的问题是，列族的 SSTable 值在节点之间是否相同，特别是对于那些 SSTable 计数为 0 的 CF？原因是如果列族的 SSTable 为 0，那么删除这些列族是安全的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T10:47:34.350

cfstats 输出是每个节点的，因此仅对 nodetool 连接到的节点有效。要获得 SSTable 的总计数，您需要对所有节点求和。任何节点上没有 SSTable 的列族为空。

因为计数是每个节点的，所以它们会因复制而膨胀。因此，例如，所有键计数的总和将大约是复制因子的一个因子，该因子高于实际键计数。

# c - 如何在 C# 中为 DLL 导入指定正确的封送处理

> ID：16202857
> 
> 赞同：0
> 
> 时间：2013-04-24T21:52:59.990
> 
> 标签：c, dll, pinvoke, marshalling, dllimport

我正在使用 DLL Import 来使用 C dll 中的某些功能。该函数的签名是

```
int dllfunction(myfile **fptr, const char *filename, int *status); 
```

什么编组代码进入下面的行以便我可以访问该函数？

```
[DllImport("name.dll")]
public static extern int dllfunction(??); 
```

我努力了

```
[DllImport("name.dll")]
public static extern int dllfunction(
    IntPtr fptr,
    [In] ref char filename, 
    ref int status); 
```

查看 MSDN 还没有帮助。如果您能够给出答复，您是否介意也提供一个调用示例（即如果需要强制转换）。

感谢寻找！

巴克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T02:00:55.220

这是发布的少量信息的最佳猜测：

```
[DllImport("name.dll", CallingConvention = CallingConvention.Cdecl)]
public static extern int dllfunction(
    out IntPtr fptr, 
    string filename, 
    ref int status
); 
```

# java - 删除 JTable 位的所有行，其占用空间仍然存在

> ID：16202862
> 
> 赞同：0
> 
> 时间：2013-04-24T21:53:12.593
> 
> 标签：java, swing, jtable

我正在`JTable`使用以下方法删除 a 的所有行：

```
myTableModel.getDataVector().removeAllElements();
myTableModel.setRowCount(0); 
```

但是删除后它的足迹仍然存在！请检查此屏幕截图：
![删除后的JTable](https://i.stack.imgur.com/zvy8V.png)

这只发生在我删除所有行时，如果只有一行就会出现问题！
为什么会发生这种情况？我该如何解决？
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T23:50:10.183

使用 a `DefaultTableModel`，您唯一的选择是使用模型提供的功能，`removeRow`

`removeRow`将触发所需的适当事件来告诉`JTable`它需要自我更新。桌子已经过优化，以改善绘画过程

![在此处输入图像描述](https://i.stack.imgur.com/UzkgZ.png)![在此处输入图像描述](https://i.stack.imgur.com/EA1HK.png)

```
import java.awt.BorderLayout;
import java.awt.EventQueue;
import java.awt.event.ActionEvent;
import javax.swing.AbstractAction;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableModel;

public class TestTable {

    public static void main(String[] args) {
        new TestTable();
    }

    public TestTable() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                DefaultTableModel model = new DefaultTableModel();
                JTable table = new JTable(model);
                for (int index = 0; index < 10; index++) {
                    model.addColumn(index);
                }
                for (int row = 0; row < 1000; row++) {
                    String[] values = new String[10];
                    for (int col = 0; col < 10; col++) {
                        values[col] = row + "x" + col;
                    }
                    model.addRow(values);
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new JScrollPane(table));
                frame.add(new JButton(new DeleteRowsFromDefaultModel(model)), BorderLayout.SOUTH);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }

        });
    }

    public class DeleteRowsFromDefaultModel extends AbstractAction {

        private final DefaultTableModel model;

        public DeleteRowsFromDefaultModel(DefaultTableModel model) {
            this.model = model;
            putValue(NAME, "Delete All");
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            model.setRowCount(0);
        }

    }

} 
```

如果您真的担心性能，您将需要创建自己的模型并创建自己的`clear`方法来触发适当的事件。

```
import java.awt.BorderLayout;
import java.awt.EventQueue;
import java.awt.event.ActionEvent;
import java.util.ArrayList;
import java.util.List;
import javax.swing.AbstractAction;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;
import javax.swing.table.AbstractTableModel;
import javax.swing.table.DefaultTableModel;

public class TestTable1 {

    public static void main(String[] args) {
        new TestTable1();
    }

    public TestTable1() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                MyTabelModel model = new MyTabelModel();
                JTable table = new JTable(model);

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new JScrollPane(table));
                frame.add(new JButton(new DeleteRowsFromMyModel(model)), BorderLayout.SOUTH);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class DeleteRowsFromMyModel extends AbstractAction {

        private final MyTabelModel model;

        public DeleteRowsFromMyModel(MyTabelModel model) {
            this.model = model;
            putValue(NAME, "Delete All");
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            model.clear();
        }
    }

    public class MyTabelModel extends AbstractTableModel {

        private List<String[]> rows;

        public MyTabelModel() {
            rows = new ArrayList<>(1000);
            for (int row = 0; row < 1000; row++) {
                String[] values = new String[10];
                for (int col = 0; col < 10; col++) {
                    values[col] = row + "x" + col;
                }
                rows.add(values);
            }
        }

        @Override
        public int getRowCount() {
            return rows.size();
        }

        @Override
        public int getColumnCount() {
            return 10;
        }

        @Override
        public String getColumnName(int column) {
            return String.valueOf(column);
        }

        @Override
        public Object getValueAt(int rowIndex, int columnIndex) {
            String[] row = rows.get(rowIndex);
            return row[columnIndex];
        }

        public void clear() {
            int old = getRowCount();
            if (old > 0) {
                rows.clear();
                fireTableRowsDeleted(0, old - 1);
            }
        }
    }
} 
```

# ios - 词法或预处理器问题 - 关于 FacebookSDK、Cordova 2.5.0 和 Facebook 插件

> ID：16202866
> 
> 赞同：0
> 
> 时间：2013-04-24T21:53:19.783
> 
> 标签：ios, xcode, facebook, cordova

我按照此处的说明 ( [https://github.com/phonegap/phonegap-facebook-plugin](https://github.com/phonegap/phonegap-facebook-plugin) ) 使用 Phonegap 应用程序设置 Facebook 连接。但是，在完成了我被告知的一切之后，我永远无法成功地构建项目。

有一次我试图通过删除我的框架搜索路径（现在是空的）来解决这个问题，现在我尝试像这样引用“用户标题搜索路径”中的标题（“$（SRCROOT）/../. ./FacebookSDK/FacebookSDK.framework/Headers/FacebookSDK.h") 但我仍然没有运气。

我需要做什么才能构建这个项目？我试过清理然后构建，然后重新启动 Xcode，但仍然没有运气。我将“始终搜索用户路径”设置为“是”。

运行 Xcode 4.6、Cordova 2.5.0、最新的 Facebook 插件和 Facebook SDK 3.5.1

此处的错误截图：http: [//imgur.com/6MTaLOQ](http://imgur.com/6MTaLOQ)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T21:36:49.770

其实，我想通了。问题是 Facebook Phonegap 插件中的重复引用。

# java - 从不同实体到同一实体的 JPA ManyToOne 关系

> ID：16202874
> 
> 赞同：0
> 
> 时间：2013-04-24T21:53:34.553
> 
> 标签：java, sql, jpa, many-to-one

我的模型中有不同的实体，并且不止一个需要一个地址，有没有办法做到这一点而没有包含重复信息的表？例如，具有 User 和 EnglishClass 实体的模型都需要具有相同数据的地址，如城市、国家、州等。有没有办法只在一个地方拥有此地址信息（没有 AddressUser 和 AddressEncglisClass 实体）并且没有包含 User 和 EnglishClass 对象的地址表？我想避免这种情况以避免出现空值。

# c++ - 使用 boost 创建相对路径

> ID：16202876
> 
> 赞同：4
> 
> 时间：2013-04-24T21:53:45.230
> 
> 标签：c++, boost, filesystems, relative-path

我正在尝试使用 boost 创建相对路径。

我最初的计划是：

```
string base_directory;  // input
boost::filesystem::path base_path;
string other_directory;  // input
boost::filesystem::path other_path;
// assume base_path is absolute - did that already (using complete() 
// if path is relative, to root it in the current directory)  -> 
base_directory = base_path.string();

if (other_path.empty())
  other_directory = base_directory;
else
{
  other_path = boost::filesystem::path(other_directory);        
  if(!other_path.is_complete())
  {
    other_path = base_path / other_path;
    other_directory = other_path.string();          
  }
  if(!boost::filesystem::exists(boost::filesystem::path(other_path)))
  {
    boost::filesystem::create_directory(other_path);
  }
} 
```

如果 other_directory 是绝对的或只是一个名称（或相对于 base_directory 的内部），这可以正常工作。

但是如果我尝试输入“..”或“../other”，我最终会得到奇怪的结构，例如“c:\test..”或“c:\test..\other”

如何正确创建相对路径，最好使用 boost ？我试图查看文档......没有积极的成功。

我正在使用 Windows（我对 boost 的偏好是它应该是多平台的，我已经依赖它了）

编辑：我有提升 1.47

谢谢你的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T22:03:46.003

Boost 文件系统不知道是`"C:\test"`指文件还是目录，因此它不会假设尾随`"\"`是正确的。

如果添加`"\"`，则可以使用该功能[`boost::filesystem::canonical()`](http://www.boost.org/doc/libs/1_49_0/libs/filesystem/v3/doc/reference.html#canonical)来简化删除`.`和`..`元素的路径。

```
other_path = boost::filesystem::path( other_directory + "\" );        
if(!other_path.is_complete())
{
  other_path = boost::filesystem::canonical( base_path / other_path ); 
```

# java - 如何继承静态字段并更改其值？

> ID：16202884
> 
> 赞同：9
> 
> 时间：2013-04-24T21:54:26.420
> 
> 标签：java, inheritance, static

我正在开发带有参数的静态实用程序类的程序/游戏。

```
class ParamsGeneral {
   public static final int H_FACTOR = 100;
   public static int MAX_SCORE = 1000;
   ...
} 
```

那么我需要在某些特定情况下覆盖此值，例如在分数有限的地图上玩。所以我做了以下事情：

```
class ParamsLimited extends ParamsGeneral {
   public static int MAX_SCORE = 500;
   // other params stay same
} 
```

预期用途如下：

```
class Player {
   ParamsGeneral par;
   public Player() {
      if(onLimitedMap()){
          par = new ParamLimited();
      }
   }

   public boolean isWinner() {
      if(this.score == par.MAX_SCORE) {
          return true;
      }
      return false;
   }
} 
```

我还没有实际测试过这段代码，因为 IDE 抱怨通过实例调用静态字段以及字段隐藏。我清楚地看到这段代码很臭，那么有没有办法实现这一点，还是我必须分别编写每个参数类？

PS：我知道我应该使默认类抽象并使用getter，我只是好奇是否有办法使这些值可以静态访问。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T21:57:40.533

您不能覆盖静态成员 - 在 Java 中，方法和字段都不能被覆盖。但是，在这种情况下，您似乎不需要执行任何操作：因为您`ParamsGeneral`在`par`变量中有一个 的实例，所以非静态方法可以通过常规覆盖完成您需要的操作。

```
class ParamsGeneral {
    public int getMaxScore() {
        return 1000;
    }
}
class ParamsLimited extends ParamsGeneral {
    @Override public int getMaxScore() {
        return 500;
    }
}

...

public boolean isWinner() {
    // You do not need an "if" statement, because
    // the == operator already gives you a boolean:
    return this.score == par.getMaxScore();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T21:58:36.850

我不会将子类化用于一般游戏与有限游戏。我会使用枚举，例如：

```
public enum Scores {
    GENERAL (1000),
    LIMITED (500),
    UNLIMITED (Integer.MAX_INT);

    private int score;
    private Scores(int score) { this.score = score; }
    public int getScore() { return score; }
} 
```

然后，在构建游戏时，您可以执行以下操作：

```
Params generalParams = new Params(Scores.GENERAL);
Params limitedParams = new Params(Scores.LIMITED); 
```

等等。

这样做可以让您改变游戏的性质，同时保持您的价值观集中。想象一下，如果对于您想到的每种类型的参数，您都必须创建一个新类。它可能会变得非常复杂，你可能有数百个类！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T22:04:06.550

最简单的解决方案是这样做：

```
class ParamsGeneral {
   public static final int H_FACTOR = 100;
   public static final int MAX_SCORE = 1000;
   public static final int MAX_SCORE_LIMITED = 500;
   ...
}

class Player {

   int maxScore;

   public Player() {
      if(onLimitedMap()){
          maxScore = ParamsGeneral.MAX_SCORE_LIMITED;
      }
      else {
          maxScore = ParamsGeneral.MAX_SCORE;
      }
   }

   public boolean isWinner() {
      if(this.score == this.maxScore) {
          return true;
      }
      return false;
   }
} 
```

不需要有 ParamsGeneral 的实例，它只是您游戏的静态定义的集合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T21:57:56.330

具有`MAX_SCORE`公共静态获取器的私有静态；然后你可以打电话`ParamsGeneral.getMaxScore`，`ParamsLimited.getMaxScore`你会分别得到 1000 和 500

# java - 带有双输入的 JOptionpane 验证

> ID：16202888
> 
> 赞同：0
> 
> 时间：2013-04-24T21:54:53.617
> 
> 标签：java, arrays, validation, double, joptionpane

我正在学习java。我尝试声明一个双数组。对于输入法，我想使用 JOptionPane。我的问题是如何为这个数组创建验证。（例如：我想验证薪水输入将从 2000 到 10000）。我很抱歉我写得不好。感谢你们！

这是我的代码！

```
import javax.swing.JOptionPane;

public class Testing {

    /**
     * @param args
     */
    public static void main(String[] args) {

        double[] salary = new double[10];

        for(int i = 0; i < salary.length; i++)
        {
            salary[i] = Double.parseDouble(JOptionPane.showInputDialog(null," Enter Salary: "));
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T23:38:15.043

阅读 Swing 教程中关于[Stopping Automatic Dialog Closing](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html#stayup)的部分。自定义代码以进行特定编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T22:11:55.333

我认为这将有助于您解决您的问题。

```
int i = 0;
double temp;
    while(i < salary.length) {
       // parseDouble throws NumberFormatException, handle it
      temp = Double.parseDouble(JOptionPane.showInputDialog(null," Enter Salary: "));
       if (temp >= 2000.0 && temp <= 10000.0){
           salary[i] = temp;
           i++;     // if in range change counter to next count
          // do something
       } else {
          // do something for out of range
       }
} 
```

# jquery - History.js 和 IE

> ID：16202891
> 
> 赞同：4
> 
> 时间：2013-04-24T21:55:00.600
> 
> 标签：jquery, internet-explorer, history.js

history.js 和[这个问题](https://stackoverflow.com/questions/10809935/history-js-plugin-how-to-use)以及它的后续答案给我带来了更多问题。

**问题1：**

`popstate`and`statechange`听众似乎都被 and 触发了，`pushState()`根据`popState()`那个回答者的说法，这是设计使然？

我只想监听 popstate 事件，我知道我可以使用 data 参数进行检查，但是将 data 和 title 参数设置为任何内容都不会`null`在 IE8/9 的哈希中添加一堆额外的东西，如下所示：

```
http://www.site.com/#about/?_suid=13383514298760299522541335484 
```

我知道我可以创建一个额外的 var 来解决这个问题，但我不想这样做。

* * *

**问题2：**

同样在 IE8-9 中，如果我这样做，您现在如何删除主页的哈希

```
History.pushState(null, null, 'http://www.site.com'); 
```

网址原来是这样的：

```
http://www.site.com/#http%2A//www.site.com 
```

如果我这样做：

```
History.pushState(null, null, '');
History.pushState(null, null, '/'); 
```

网址原来是这样的：

```
http://www.site.com/#./ 
```

但我希望 url 采用以下任何一种格式：

```
http://www.site.com
http://www.site.com/
http://www.site.com/#
http://www.site.com/#/ 
```

我正在使用 jQuery 历史插件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-23T04:52:18.867

我不确定问题 #1 的答案。

但是，对于问题 2，该问题与 HTML5 浏览器与 HTML4 浏览器的功能有关。从文档中：

> 对于 HTML5 浏览器，这意味着您可以直接修改 URL，而无需再使用哈希。对于 HTML4 浏览器，它将恢复使用旧的 onhashchange 功能。

因此，HTML4 浏览器被哈希 URL 卡住了。对不起。

# java - Java：多次设置int的值

> ID：16202896
> 
> 赞同：0
> 
> 时间：2013-04-24T21:55:32.367
> 
> 标签：java, math, integer, int

我使用这种方法来获取屏幕外的随机位置以生成所有僵尸。

```
public void initZombie(){ 
            for(int i = 0; i < 100; i++){
                int randomXSpawn = (int) Math.random() * -300 + -50;
                int randomYSpawn = (int) Math.random() * -100 + 800;
                int[][] spawn = {{randomXSpawn,randomYSpawn}};
                for(int j = 0; j < spawn.length; j++){
                    zombie.add(new Zombie(spawn[j][0],spawn[j][1]));
                }
            }
        } 
```

我遇到的问题是获得随机位置的两个整数只运行一次，因此每个僵尸都在彼此内部完全相同的位置产卵。我怎样才能让整数多次运行，以便僵尸在不同的位置产生？我尝试将它们放在 run() 方法中，然后它们运行两次，以便第一个僵尸在一个位置生成，然后其他 99 个僵尸在彼此内部的另一个位置生成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T22:04:00.723

您正在转换`Math.random()`为一个整数，该整数会降低该值。由于`Math.random()`生成一个 double `0 <= x < 1`，它*总是*四舍五入为 0。这就是为什么你得到完全相同的生成位置。

您需要在演员表中添加括号：

```
int randomXSpawn = (int) (Math.random() * -300 + -50);
int randomYSpawn = (int) (Math.random() * -100 + 800); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T22:01:28.467

如果我是你，我会使用[Random](http://docs.oracle.com/javase/7/docs/api/java/util/Random.html#Random%2)对象，然后调用`nextInt`函数

```
Random rnd = new Random();

for(...)
{
    int randInt = rnd.nextInt(300) //300 is the maximum
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T22:05:04.123

你不索引你的`spawn`数组。事实上，我认为你甚至不需要一个。尝试这个

```
public void initZombie(int maxZombies){
        Random r=new Random();
        for(int i = 0; i < maxZombies; i++){
                zombie.add(new Zombie(r.nextInt(MAX_X), r.nextInt(MAX_Y));
        }
    } 
```

如果以后需要调用僵尸的生成位置，可以将其保存为僵尸实例中的私有 int。

原始代码也会给你负坐标，因为你乘以一个负常数。即使它确实有效，你最终会得到比你想要的更多的僵尸，因为`new Zombie()`代码在内部循环中运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-24T22:33:08.367

有几件事会导致代码出现问题。正如 Supericy 所说，您不小心过早地转换了所有随机数，截断了它们的值，并且正如 SJuan76 在评论中提到的那样，您的 for 循环设置不正确。（它有效，但它可以更清洁。）

* * *

**首先，转换问题：**当您将 double 转换为 int 时，小数部分会向下舍入。

```
int num = (int) 0.999; //num == 0 
```

`Math.random()`总是返回一个介于 0 和 1 之间的双精度数，因此当转换为 int 时，它也总是被截断为零。

所以这意味着你的线

```
int randomXSpawn = (int) Math.random() * -300 + -50; 
```

评估如下：

```
int randomXSpawn = (int) Math.random() * -300 + -50;
int randomXSpawn = (int) 0.xxxx * -300 + -50;
int randomXSpawn = 0 * -300 + -50;
int randomXSpawn = -50; 
```

要解决此问题，只需添加括号以强制在强制转换之前进行乘法和加法，就像 Supericy 所说：

```
int randomXSpawn = (int) (Math.random() * -300 + -50);
int randomYSpawn = (int) (Math.random() * -100 + 800); 
```

* * *

**其次，for 循环：**这就是你现在所拥有的。它工作正常，但可以写得更清楚。

```
for(int i = 0; i < 100; i++) {
    int randomXSpawn = (int) Math.random() * -300 + -50;
    int randomYSpawn = (int) Math.random() * -100 + 800;
    int[][] spawn = {{randomXSpawn,randomYSpawn}};
    for(int j = 0; j < spawn.length; j++){
        zombie.add(new Zombie(spawn[j][0],spawn[j][1]));
    }
} 
```

在外部 for 循环的单次迭代中会发生什么？

```
 //int i = 0;
    int randomXSpawn = (int) Math.random() * -300 + -50;
    int randomYSpawn = (int) Math.random() * -100 + 800;
    int[][] spawn = {{randomXSpawn,randomYSpawn}};
    for(int j = 0; j < spawn.length; j++){
        zombie.add(new Zombie(spawn[j][0],spawn[j][1]));
    } 
```

首先，您生成两个随机数：

```
 int randomXSpawn = (int) Math.random() * -300 + -50;
    int randomYSpawn = (int) Math.random() * -100 + 800; 
```

然后，您存储这些数字，以便以后获取它们：

```
 int[][] spawn = {{randomXSpawn,randomYSpawn}}; 
```

最后，进入最终的 for 循环：

```
 for(int j = 0; j < spawn.length; j++){
        zombie.add(new Zombie(spawn[j][0],spawn[j][1]));
    } 
```

里面会发生什么？我们知道这`spawn`是一个二维数组。由于您刚刚在上面声明了它，我们也知道它有 dimensions `[1][2]`。这意味着 for 循环将迭代一次： when `j = 0`，因为`j = 1`下一次迭代时的when`j < spawn.length`将不再为真。

由于您声明 的方式`spawn`，我们知道`spawn[0][0] == randomXSpawn`and `spawn[0][1] == randomYSpawn`，因此内部 for 循环中间的行有效地执行了此操作：

```
 zombie.add(new Zombie(randomXSpawn,randomYSpawn)); 
```

这建议了一种使代码更清晰的方法：您可以删除`spawn`数组和内部 for 循环，以便使用and直接调用`Zombie`构造函数。`randomXSpawn``randomYSpawn`

这就是变化的样子：

```
for(int i = 0; i < 100; i++) {
    int randomXSpawn = (int) Math.random() * -300 + -50;
    int randomYSpawn = (int) Math.random() * -100 + 800;
    zombie.add(new Zombie(randomXSpawn,randomYSpawn));
} 
```

* * *

将这两个更改放在一起，我们得到：

```
for(int i = 0; i < 100; i++) {
    int randomXSpawn = (int) (Math.random() * -300 + -50);
    int randomYSpawn = (int) (Math.random() * -100 + 800);
    zombie.add(new Zombie(randomXSpawn,randomYSpawn));
} 
```

如果你不喜欢我建议的 for 循环重组，你不必改变它。我认为您现在拥有它们的方式可以正常工作。这只是我的观点，它很难阅读，如果你不同意，那是允许的 =)。但是，关于使用括号来控制强制转换的第一个变化是导致您在问题中提到的问题的原因，并且需要加以注意。

# c# - 对于循环错误检查

> ID：16202898
> 
> 赞同：0
> 
> 时间：2013-04-24T21:55:43.830
> 
> 标签：c#, asp.net

一切正常，但不起作用的一件事是它正在为每个帐户做笔记，即使没有为该帐户完成/找到任何事情。

```
for (int j = 0; j < accounts.Length; j++)
        {
            SqlConnection connection = new SqlConnection(SqlDataSource1.ConnectionString);

            SqlCommand SqlComm = new SqlCommand("insert into TableHistory (id, startDate, dueDate, userid, amount, number, needsReview, offer, dateAdded, dateRejected, rejectedBy) " +
                       "select (select max(id) + 1 from Table1), startDate, dueDate, userid, amount, number, needsReview, offer, dateAdded, GETDATE(), @userID from Table1 where number = @number " +
                       "delete from Table1 where number = @number", connection);
            SqlComm.Parameters.Add("@number", SqlDbType.Int).Value = Convert.ToInt32(accounts[j].ToString());
            SqlComm.Parameters.Add("@userID", SqlDbType.Int).Value = userID;

            connection.Open();

            SqlComm.ExecuteNonQuery();

            connection.Close();

            NoteAccount note = new NoteAccount("Personal Note", accounts[j].ToString(), userID);
            note.makeNote();
        } 
```

假设 Account 11 中没有任何内容`Table1`。什么都不会失败，因为 insert 语句不会触发，因为 select 语句不返回任何 from `Table1`，这很好。

但是`note.makeNote();`当不需要添加时，会触发并向帐户添加“个人”注释。如果帐户存在，是否有一种简单的方法可以仅添加注释`Table1`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:58:14.473

`ExecuteNonQuery`将返回您受影响的行数，因此您可以在此基础上进行检查。如果大于 0，则记下。

```
if(SqlComm.ExecuteNonQuery()>0)
{
   NoteAccount note = new NoteAccount("Personal Note", accounts[j].ToString(), userID);
   note.makeNote();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T21:58:50.943

如果我理解正确，我认为您可以使用`ExecuteNonQuery`. 这将返回受查询影响的行数，因此您可以测试它是否大于 0，并且仅在大于 0 时才记下。

# regex - 仅在特定行之间使用 sed

> ID：16202900
> 
> 赞同：20
> 
> 时间：2013-04-24T21:55:50.603
> 
> 标签：regex, unix, sed

我有这个 sed 命令用于删除逗号后的空格。

```
 sed -e 's/,\s\+/,/g' example.txt 
```

我该如何更改它，它将仅在特定行号之间进行修改。

（例如在第二行和第三行之间）。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-04-24T21:57:54.007

采用：

```
sed '2,3s/,\s\+/,/g' example.txt 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-25T04:27:01.503

由于 OSX (BSD sed) 与 linux (GNU) sed 有一些语法差异，我想我会从我的一些来之不易的笔记中添加以下内容：

OSX（BSD）SED 在同一文件中的（地址）块（起点和终点模式（/../）或行#s）内查找/替换（[此处](http://www.grok2.com/sedfaq4.html)[通过](http://www.grymoire.com/Unix/Sed.html#uh-25)& [via](http://www.cyberciti.biz/faq/sed-display-text/) & [via](http://www.alexonlinux.com/sed-the-missing-manual#sed_addresses) & 第 4.20 节）：

句法：

```
$ sed '/start_pattern/,/end_pattern/ [operations]' [target filename] 
```

**标准查找/替换示例：**

```
$ sed -i '' '2,3 s/,\s\+/,/g' example.txt
$ sed -i '' '/DOCTYPE/,/body/ s/,\s\+/,/g' example.txt 
```

使用复杂的运算符和分组查找/替换示例（由于标准输入的流使用，无法在没有分组语法的情况下进行操作）。分组中的所有语句必须在单独的行上，或用分号分隔：

**复杂运算符示例（将删除包含匹配项的整行）：**

```
$ sed -i '' '2,3 {/pattern/d;}' example.txt 
```

**多文件查找 + sed：**

```
$ find ./ -type f -name '*.html' | xargs sed -i '' '/<head>/,/<\/head>/ {/pattern/d; /pattern2/d;}' 
```

希望这对某人有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T21:57:45.217

```
sed -e '2,3!b;s/,\s\+/,/g' example.txt 
```

如果您以后想要添加更多命令来处理所需的行，此版本可能很有用。

# php - onclick 没有调用我的 javascript 函数

> ID：16202901
> 
> 赞同：-2
> 
> 时间：2013-04-24T21:55:53.600
> 
> 标签：php, javascript, onclick

我正在尝试从 onclick 调用 javascript 函数，但它似乎没有注册。我无法追踪问题，因为 chrome 检查元素中没有报告错误。

我的按钮代码如下所示：

```
$button = "<button class=\"btn btn-mini btn-success\" id = \"$divName\" onClick\"return upVote($linkID, $linkUser)\">$votes Votes</button>"; 
```

我的java脚本看起来像这样：

```
function upVote(id, userID)
    {

        alert(id);

        return false;
    } 
```

您可以尝试此页面上博客链接选项卡上的按钮：

[http://www.beerportfolio.com/beerPage2.php?id=f5DoHi](http://www.beerportfolio.com/beerPage2.php?id=f5DoHi)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T21:57:09.677

您缺少“=”中的

```
onClick=\"return upVote($linkID, $linkUser)\" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T21:57:17.327

首先，不要使用onClick。其次，这样写：`onclick="upVote(1,2)"`

# ember.js - EmberJS“使用 Ember.js 构建应用程序”错误路由

> ID：16202902
> 
> 赞同：0
> 
> 时间：2013-04-24T21:55:56.323
> 
> 标签：ember.js, ember-router, ember-1

我使用 EmberJS 1.0.0 RC3。
这些文件基于本教程：[http](http://www.youtube.com/watch?feature=player_embedded&v=Ga99hMi7wfY#) ://www.youtube.com/watch?feature=player_embedded&v=Ga99hMi7wfY# ！（来自 emberjs.com/guides/）。

我`index.html`的是：

```
<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="ie6"> <![endif]--> 
<!--[if IE 7 ]>    <html lang="en" class="ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="ie8"> <![endif]--> 
<!--[if IE 9 ]>    <html lang="en" class="ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en"> <!--<![endif]-->
    <head>
        <meta charset="UTF-8">    

        <title>Test</title>
        <meta name="description" content="">
        <meta name="author" content="">

        <link rel="stylesheet" href="app/Ressources/public/css/normalize-2.1.1.min.css">
        <link rel="stylesheet" href="app/Ressources/public/css/bootstrap-2.3.1.min.css">
        <link rel="stylesheet" href="app/Ressources/public/css/bootstrap-responsive-2.3.1.min.css">
        <link rel="stylesheet" href="app/Ressources/public/css/jquery.mobile.structure-1.3.1.min.css">
        <!--[if lt IE 9]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <link rel="stylesheet" href="app/Ressources/public/css/style.css">
    </head>
    <body>

        <script type="text/x-handlebars" >
            <div class="navbar">
                <div class="navbar-inner">
                    <a class="brand" href="#">Bloggr</a>
                    <ul class="nav">
                        <li><a href="#">Posts</a></li>
                        <li>{{#linkTo 'about'}}About{{/linkTo}}</li>
                    </ul>
                </div>
            </div>
            {{outlet}}
        </script>

        <script type="text/x-handlebars" id="about">
            <div class="about">
                <p>Test</p>
            </div>
        </script>

        <script src="vendor/jquery/jquery-2.0.0.min.js"></script>
        <script src="vendor/jquery/mobile/jquery.mobile-1.3.1.min.js"></script>
        <script src="vendor/handlebars/handlebars-1.0.0-rc.3.js"></script>
        <script src="vendor/ember/ember-1.0.0-rc.3.min.js"></script>
        <script src="vendor/ember/ember-data-12.js"></script>
        <script src="vendor/bootstrap/bootstrap-2.3.1.min.js"></script>
        <script src="vendor/moment/moment-2.0.0.min.js"></script>
        <script src="app/main2.js"></script>

    </body>
</html> 
```

我的`main2.js`文件是：

```
var App = Ember.Application.create();

App.Router.map(function() {
    this.resource('about');
}); 
```

当我在：my_app.local/index.html，它工作正常，我可以看到我的菜单。中的链接`About`是 my_app.local/index.html#/about 所以它是正确的。但是，当我点击它时，我转到 my_app_client.local/about 并且服务器找不到这个文件（它没有找到它是正确的，顺便说一下只`index.html`存在）。

在此示例中，我将 WAMP 与 vhost 一起使用。我尝试使用 file://My_path_to_my_app/index.html，我可以去 index.html#/about 但 chrome 没有找到它。

你能猜到我的错误在哪里吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T20:06:42.040

我只是在 index.hmtl 中删除了这一行：

```
<script src="vendor/jquery/mobile/jquery.mobile-1.3.1.min.js"></script> 
```

现在它正在工作。我不知道兼容性有什么问题，但它是这样工作的。

# java - 将一个 double 值与两个短裤相除的结果相乘

> ID：16202910
> 
> 赞同：2
> 
> 时间：2013-04-24T21:56:41.130
> 
> 标签：java

我的程序的目的是显示员工（经理编码器）的工资，具体取决于该员工在一个月内工作了多少小时。包含 3 名员工的数组作为参数转到会计。会计返回每个员工的工资。编码员和经理的薪水以不同的方式计算。

这是我的Java代码：

```
 public class OOP
    {  
       public static void main(String[] args)
       {  
    // fill the staff array with three Employee objects.

    Employee[] staff = new Employee[3];

    staff[0] = new Manager("Carl Cracker",75000.00,(short)160);
    staff[1] = new Coder("Harry Hacker", 50000.00,(short)165);
    staff[2] = new Coder("Tony Tester", 40000.00,(short)200);

    Accountant Counter = new Accountant();
    Counter.printSalary(staff, (byte)2);

       }
    }

    abstract class Employee
    {  
       public Employee(String n, double w, short h)
    {  
      name = n;

      wageRate = w;

      workedHours = h;

    }

     public String getName()
     {
         return name;
     }

     public double getSalary(short workingHours)
     {

        this.salary = this.wageRate * (this.workedHours/workingHours);
        return salary;
     }

     private String name;
     protected double wageRate;
     protected short workedHours;
     protected double salary;
    }
    class Coder extends Employee
    {
        public Coder (String n, double w, short h)
        {
            super( n,  w,  h);
        }

        public double getSalary(short workingHours)
        {
            return super.getSalary(workingHours);
        }
    }
    class  Manager extends Employee
    {
        public Manager (String n, double w, short h)
        {
            super( n,  w,  h);
        }
        public double getSalary(short workingHours)
        {
            if (workingHours > workedHours)
            return  super.getSalary(workingHours)*0.7;
            else
                {
                   salary = wageRate;
                   return salary;
                }

         }
     }
    class Accountant
    {
        public Accountant ()
        {
        }
        public void printSalary(Employee[] emp, byte monthInd)
        {
            Employee[] workers = emp;
            byte MID = monthInd;
            MID = (byte) (MID - 1);
            for (Employee worker : workers)
                {
                    System.out.printf("%s's salary this month is %8.2f",worker.getName(), worker.getSalary(workingHours[MID]));
                    System.out.println();
                }
        }

        private short[] workingHours = new short[]{168,160,160,172,162,154,184,168,168,184,168,172};
     } 
```

预期结果：

Carl Cracker 这个月的工资是 75000

Harry Hacker 这个月的工资是 51562.5

Tony Tester 这个月的工资是 50000

实际结果：

Carl Cracker 这个月的薪水是 75000,00

Harry Hacker 这个月的薪水是 50000,00

Tony Tester 这个月的薪水是 40000,00

有人可以解释一下为什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T22:06:05.957

你是 Java 中整数除法的受害者。

即使有`short`值，也适用[整数除法](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.17.2)(JLS 15.17.2)，其中非整数结果会被截断。第二个月，索引 1，是 160 个工作小时。Tony Tester 有 200 小时。在普通数学中，200 / 160 = 1.25，但在 Java 整数除法中，200 / 160 = 1。这就是为什么你会看到 40000 而不是 50000。

在 Employee 的`getSalary`方法中，将其中一个值转换为 a`double`以获得浮点除法，这样结果就是你想要的。

```
this.salary = this.wageRate * ((double) this.workedHours/workingHours); 
```

您的代码输出：

```
$ java OOP
Carl Cracker's salary this month is 75000.00
Harry Hacker's salary this month is 50000.00
Tony Tester's salary this month is 40000.00 
```

更改代码的输出：

```
$ java OOP
Carl Cracker's salary this month is 75000.00
Harry Hacker's salary this month is 51562.50
Tony Tester's salary this month is 50000.00 
```

# ios - 删除折线时 iOS GoogleMaps SDK 崩溃

> ID：16202913
> 
> 赞同：2
> 
> 时间：2013-04-24T21:56:59.573
> 
> 标签：ios, xcode, google-maps, google-maps-sdk-ios

我在使用适用于 iOS v1.2 的 GoogleMaps SDK 时遇到了这个问题，当我删除折线时代码会崩溃。

在 redrawPolylines 中，我从地图中剥离所有折线并使用新集合进行更新。该部分运行得很好，但是当 GoogleMaps 进入重新绘制地图的阶段时，它会在 Google 自己的代码中的某个地方崩溃

省去我删除旧折线并且没有崩溃的位

```
-(void) redrawPolylines
{

    for (GMSPolyline* polyline in self.mapView.polylines) {
        polyline.map=nil;
    }

    [self drawPolylines];
} 
```

有人反对这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T05:26:57.253

谷歌昨天迅速发布了 1.2.1，修复了折线崩溃。我会先试试。

# java - Java 点对点聊天应用程序

> ID：16202915
> 
> 赞同：2
> 
> 时间：2013-04-24T21:57:01.077
> 
> 标签：java, multithreading, chat

我正在尝试开发一个点对点聊天应用程序，它允许多个客户端相互聊天，目前我只能允许用户相互聊天，我的建立连接的代码如下。如何更改代码以允许多个连接？

```
import java.io.*;
import java.net.*;
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
   // import all the class that you will need for functionailty

   // extends jframe to develop gui's in java
   public class Server extends JFrame{

private JTextField userInput; // 
private JTextArea theChatWindow; //
private ObjectOutputStream output; // stream data out
private ObjectInputStream input; // stream data in
private ServerSocket server;
private Socket connection; // socket means set up connetion between 2 computers

//Constructor

public Server(){

    super("My Chat Service");
    userInput = new JTextField();
    userInput.setEditable(false); // set this false so you dont send messages when noone is available to chat
    // action event listener to check when the user hits enter for example
    userInput.addActionListener(new ActionListener(){

        public void actionPerformed(ActionEvent event){
            sendMessage(event.getActionCommand()); // string entered in the textfield
            userInput.setText(""); // reset text area to blank again

        }
    }
    );
    // create the chat window
    add(userInput, BorderLayout.NORTH);
    theChatWindow = new JTextArea();
    add(new JScrollPane(theChatWindow));
    setSize(300,150);
    setVisible(true);
}

// run the server after gui created
public void RunServer(){

    try{
        server = new ServerSocket(6789, 100); // 1st number is port number where the application is located on the server, 2nd number is the amount of people aloud to connect
        while(true){

            try{
                waitForConnection(); // wait for a connection between 2 computers 
                setupStreams();  // set up a stream connection between 2 computers to communicate
                whileChatting();  // send message to each other
                // connect with someone and have a conversation
            }catch(EOFException eofException){

                showMessage("\n Server ended Connection");
            }finally{

                closeChat();
            }
        }
    }catch(IOException ioException){

        ioException.printStackTrace();
    }
}

//Wait for a connection then display connection information

private void waitForConnection(){

    showMessage("waiting for someone to connect to chat room....\n");
    try {
        connection = server.accept();
    } catch (IOException ioexception) {

        ioexception.printStackTrace();
    }
    showMessage("Now connected to"+ connection.getInetAddress().getHostName());
}
 // stream function to send and recive data
private void setupStreams() throws IOException{

    output = new ObjectOutputStream(connection.getOutputStream()); // set up pathway to send data out
    output.flush(); // move data away from your machine
    input = new ObjectInputStream(connection.getInputStream()); // set up pathway to allow data in
    showMessage("\n Connection streams are now setup \n");

}

// this code while run during chat conversions
private void whileChatting() throws IOException{

    String message = " You are now connected ";
    sendMessage(message);
    allowTyping(true); // allow user to type when connection
    do{
        // have conversion while the client does not type end
        try{

            message = (String) input.readObject(); // stores input object message in a string variable
            showMessage("\n " +message);
        }catch(ClassNotFoundException classnotfoundException){

            showMessage("\n i dont not what the user has sent");
        }
    }while(!message.equals("CLIENT - END"));// if user types end program stops

}

private void closeChat(){

    showMessage("\n closing connections...\n");
    allowTyping(true);
    try{

        output.close(); // close output stream
        input.close(); // close input stream
        connection.close(); // close the main socket connection

    }catch(IOException ioexception){

        ioexception.printStackTrace();
    }
}

// send message to the client
private void sendMessage(String message){

    try{

        output.writeObject("Server - "+ message);
        output.flush(); // send all data out
        showMessage("\nServer - "+ message);

    }catch(IOException ioexception){

        theChatWindow.append("\n ERROR: Message cant send");
    }

}

// update the chat window (GUI)
private void showMessage(final String text){

    SwingUtilities.invokeLater(

            new Runnable(){

                public void run(){

                    theChatWindow.append(text);

                }
            }

            );

}

// let the user type messages in their chat window

private void allowTyping(final boolean trueOrFalse){

    SwingUtilities.invokeLater(

            new Runnable(){

                public void run(){

                    userInput.setEditable(trueOrFalse);

                }
            }

            );

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T22:17:30.680

查看 XMPP 协议 - 它是聊天协议的事实标准之一，可以为您的项目提供示例或想法。我认为 XMPP 更适合服务器到多客户端，但它实际上只是一堆来回发送的 XML 文档。

[http://en.wikipedia.org/wiki/XMPP](http://en.wikipedia.org/wiki/XMPP)

[http://xmpp.org/](http://xmpp.org/)

和一个了不起的开源社区，目前有一个非常好的遵循 XMPP 协议标准的服务器和客户端。他们有一个很棒的社区，所以可能会跳到那里与一些开发人员讨论设计理念等，或者看看他们的源代码：

[http://www.igniterealtime.org/](http://www.igniterealtime.org/)

# android - 在 1 个 LinearLayout 中使用 2 个 ListView 设置 ListView 高度

> ID：16202916
> 
> 赞同：0
> 
> 时间：2013-04-24T21:57:03.163
> 
> 标签：android, android-layout, android-listview

这是我的 xml 文件`layout`：

```
<com.handmark.pulltorefresh.library.PullToRefreshScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/pull_to_refresh_scrollview_feat"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <ListView
            android:id="@+id/listViewFriends"
            android:layout_width="match_parent"
            android:layout_height="1100dp" >
        </ListView>

        <ListView
            android:id="@+id/listViewTrending"
            android:layout_width="match_parent"
            android:layout_height="1100dp" >
        </ListView>
    </LinearLayout>

</com.handmark.pulltorefresh.library.PullToRefreshScrollView> 
```

出于某种原因，显示两者的唯一方法`ListViews`是在实际中设置高度`dp`。我不能使用`wrap_content`或`layout_weights`。

这是使用多个的限制`ListViews`吗？还是我做错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T19:40:14.233

我只是放弃了这个想法并使用了 a`MergeAdapter`并得到了我想要的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T22:01:02.170

我认为`PullToRefreshScrollView`是某种`ScrollView`. 您不应该`ListView`在 a 中使用 a `ScrollView`；他们只是玩得不好。您不仅必须为列表设置显式布局高度，而且两个视图在处理触摸事件时会相互影响。

如果将 提升`LinearLayout`到容器层次结构的顶部，则可以为每个设置以下属性`ListView`：

```
. . .
android:layout_height="0dp"
android:layout_weight="1"
. . . 
```

然后它们应该占据相同的垂直空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T22:01:05.440

我还没有尝试过，但是您可以将 layout_height=0dp 和 layout_weight=1 设置为您的 ListViews 并看看会发生什么？

希望能帮助到你。

# iis - 传入 HttpRequestWrapper 时来自 DotNetOpenAuth 的 ReadAuthorizationRequest 的错误消息

> ID：16202921
> 
> 赞同：3
> 
> 时间：2013-04-24T21:57:15.867
> 
> 标签：iis, httprequest, dotnetopenauth

我的 OAuth 控制器中的 Authorize 方法有一个自定义授权过滤器。当授权过滤器注意到用户已登录时，它会将当前的 OAuth 请求填充到会话中，并将它们发送出去以进行登录。

登录后，在我的 /OAuth/Authorize 端点中，我检查该请求是否在会话中，而不是立即失败，因为当前请求没有附加授权请求。然后，我使用该请求对象调用授权服务器。

我的授权操作中的代码如下所示：

```
 [AcceptVerbs(HttpVerbs.Get | HttpVerbs.Post)]
    [ExternalAppAuthorizeAttribute]
    public ActionResult Authorize() {
        Object requestObject = this.HttpContext.Session["AuthRequest"];
        HttpRequestBase request = null;
        if ((requestObject != null) && (requestObject.GetType() == typeof(HttpRequestWrapper)))
        {
            request = (HttpRequestWrapper)requestObject;
            this.HttpContext.Session.Remove("AuthRequest");
        }
        EndUserAuthorizationRequest pendingRequest = null;
        if (request != null)
        {
            pendingRequest = this.authorizationServer.ReadAuthorizationRequest(request);
        } else
        {
            pendingRequest = this.authorizationServer.ReadAuthorizationRequest();
        }
        if (pendingRequest == null) {
            throw new HttpException((int)HttpStatusCode.BadRequest, "Missing authorization request.");
        } 
```

但是，当在会话中找到并恢复请求时，ReadAuthorizationRequest 失败。错误消息不是很有帮助：“值不在预期范围内。”

这是堆栈跟踪：

```
[ArgumentException: Value does not fall within the expected range.]
   System.Runtime.InteropServices.Marshal.ThrowExceptionForHRInternal(Int32 errorCode, IntPtr errorInfo) +0
   System.Runtime.InteropServices.Marshal.ThrowExceptionForHR(Int32 errorCode) +10
   System.Web.Util.Misc.ThrowIfFailedHr(Int32 hresult) +9
   System.Web.Hosting.IIS7WorkerRequest.GetServerVariableInternal(String name) +36
   System.Web.Hosting.IIS7WorkerRequest.GetServerVariable(String name) +49
   System.Web.HttpRequest.AddServerVariableToCollection(String name) +22
   System.Web.HttpRequest.FillInServerVariablesCollection() +85
   System.Web.HttpServerVarsCollection.Populate() +36
   System.Web.HttpServerVarsCollection.Get(String name) +42
   System.Collections.Specialized.NameValueCollection.get_Item(String name) +10
   DotNetOpenAuth.Messaging.MessagingUtilities.GetPublicFacingUrl(HttpRequestBase request, NameValueCollection serverVariables) +61
   DotNetOpenAuth.Messaging.MessagingUtilities.GetPublicFacingUrl(HttpRequestBase request) +43
   DotNetOpenAuth.Messaging.Channel.ReadFromRequestCore(HttpRequestBase request) +69 
```

我在飞行中检查了我的请求，[oauth](https://github.com/DotNetOpenAuth/DotNetOpenAuth/blob/3d37ff45cab6838d80b22e6b782a0b9b4c2f4aeb/src/DotNetOpenAuth.Core/Messaging/MessagingUtilities.cs#L372)在其中使用的所有内容看起来都很好：标头、URI 等。我不知道是什么原因造成的。

有谁知道为什么会这样？或者，如果您对在用户进行身份验证时存储 oauth 请求有其他建议，我愿意接受。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T18:31:51.423

事实证明，HttpRequestWrapper 上的 ServerVariables 在调用时抛出了异常（现在从堆栈跟踪中可以明显看出这一点）。我相信这是因为请求尚未命中控制器操作，因为它被过滤器拦截了。我猜想当控制器操作处理请求时设置了 ServerVariables ？

我通过创建一个实现 HttpRequestBase 的新类解决了这个问题。我将存储的 oauth 请求和实际请求传递给它，并从 oauth 请求中返回 HttpRequestBase 中除 ServerVariables 之外的所有内容的属性，这些属性是我从当前请求返回的。

# ruby-on-rails - 找出导致 Rails 请求缓慢的原因

> ID：16202926
> 
> 赞同：1
> 
> 时间：2013-04-24T21:57:44.237
> 
> 标签：ruby-on-rails, activerecord

我看到控制器中的创建操作请求非常缓慢（所有其他操作都在可接受的范围内）。跟踪日志告诉我，视图和活动记录虽然不是最快的，但只是总加载时间的一小部分。这是我看到的：

```
Completed 200 OK in 37023ms (Views: 530.1ms | ActiveRecord: 251.2ms | Sphinx: 0.0ms) 
```

有没有办法查看剩余的时间都花在了哪里？我试过 Mini Profiler，但它并没有告诉我时间花在哪里。

为了添加一些额外的上下文，模型（故事）有一个 has_many :through 将它连接到用户模型。似乎只有当用户被分配到故事时才会出现减速。如果没有选择用户，则响应时间很好。问题可能是连接模型上缺少索引吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-16T13:09:00.937

像这样使用基准：

```
def some_action
    benchmark 'running queries' do
       # some code for running queries
    end
    benchmark 'some other operation' do
       # some other code
    end
end 
```

您将在 development.log 中获得结果。您也可以在视图中使用它：

```
<% benchmark 'some partial' do %>
    <div>copde here</div>
<% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T22:25:14.013

我的一种做法是将日志添加到您的操作中。例如

```
def some_action_which_is_very_slow
  logger.debug "== line 1, #{Time.now}"
  # statement 1 
  logger.debug "== line 2, #{Time.now}"
  # statement 2 
  logger.debug "== line 3, #{Time.now}"
  # statement 3
end 
```

ps 使用 #{Time.now} 不够聪明。您应该配置您的日志文件以支持时间格式。我建议使用 log4r。请参阅此堆栈帖子：[如何使用 Rails 3.0.x 配置 Log4r？](https://stackoverflow.com/questions/5664136/how-to-configure-log4r-with-rails-3-0-x)

# scala - Option[Map[String, String]] 可以奇怪地得到一个值

> ID：16202929
> 
> 赞同：0
> 
> 时间：2013-04-24T21:57:48.300
> 
> 标签：scala, scala-collections

我发现`Option[Map[String, String]]`奇怪的作品是这样的：

```
 scala> val fileInfo: Option[Map[String, String]] = Some(Map( "type" -> "hoge" ))
 fileInfo: Option[Map[String,String]] = Some(Map(type -> hoge))

 scala> fileInfo.get("type")
 res1: String = hoge 
```

我认为`Option`“get”方法不需要任何参数，所以这对我来说非常奇怪。为什么它有效？它是隐式转换还是错误？我想确定它是如何工作的。

我的规格是：

*   斯卡拉版本 2.9.2
*   Java 1.6.0_43

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-24T22:20:59.620

这对`fileInfo.get.apply("type")`, 即你并没有真正将参数传递给`Option#get`, 而是调用[`.apply("type")`](http://www.scala-lang.org/api/current/scala/collection/Map.html)结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-24T22:00:40.957

Scala 允许您[在某些情况下省略大括号，](https://stackoverflow.com/questions/1181533/what-are-the-precise-rules-for-when-you-can-omit-parenthesis-dots-braces-f)而您一直是该功能创建的模棱两可的受害者：您所做的只是展开 Option（并获取底层 Map）—— Option 不仅广泛使用`.getOrElse`，而且不安全`.get`方法在没有异常时失败：

```
val fileInfo: Option[Map[String, String]] = Some(Map( "type" -> "hoge" ))
val map = fileInfo.get
// map: Map[String,String] = Map(type -> hoge)
// now actual map lookup
map("type")
// res0: String = hoge

// but this obviously won't work
val throwy: Option[Map[String, String]] = Option(null) // None
throwy.get("type")
// java.util.NoSuchElementException: None.get 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-24T22:23:49.800

```
fileInfo.get("type") 
```

被翻译成：

```
fileInfo.get().apply("type") 
```

因此，您打开选项，然后在`Map`. （`apply`获取非可选的映射元素，即如果键不存在则失败）。

# vb.net - 我需要 SQL Server 的空间查询以返回最近的十个位置

> ID：16202930
> 
> 赞同：1
> 
> 时间：2013-04-24T21:57:49.777
> 
> 标签：vb.net, visual-studio-2010, sql-server-2008

我正在使用 Visual Studio 2010 和 vb.net 创建一个 .asmx 网络服务，并使用 SQL Server 2008，但下面的查询提供了数据库中的所有地址。我需要将下面的查询修改为返回十个最近位置的空间查询。Lat 和 Long 是小数，但数据库中有一个名为 [Location] 的地理列。帮助！

```
<WebMethod()> _
Public Function GetFuelStops(ByVal Lat as Double, ByVal Long as Double) As FuelStop()
    Dim resultList = New List(Of FuelStop)()

    Using sqlCon As New SqlConnection()
    sqlCon.ConnectionString = "Data Source=(local);Initial Catalog=Example_DB;User ID=Turd;Password=Fergison"
    Dim sql = <sql>
        SELECT
            [Physical_Address_Street]
            , [Physical_Address_Local]
            , [Physical_Address_State]
            , [Physical_Address_Zip]
            , [Lat]
            , [Long]
            , [Phone_Number]
        FROM Gas_Stations
        WHERE Location_Type = 1
        </sql>

    Dim command As New SqlCommand()
    command.CommandText = CStr(sql)
    command.Connection = sqlCon
    sqlCon.Open()

    Using reader = command.ExecuteReader()
        While reader.Read()
            Dim fuelStop = New FuelStop()
            fuelStop.Physical_Address_Street = reader.GetString(0)
            fuelStop.Physical_Address_Local = reader.GetString(1)
            fuelStop.Physical_Address_State = reader.GetString(2)
            fuelStop.Physical_Address_Zip = reader.GetString(3)
            fuelStop.Phone_Number = reader.GetString(4)

            resultList.Add(fuelStop)
        End While
       End Using
    End Using
Return resultList.Skip(skip).Take(take).ToArray()

End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T22:24:03.953

我强烈建议您仔细研究 SQL Server 中的地理空间功能，而不是寻求实际的解决方案。这是一项强大的功能，但如果以错误的方式使用，可能会降低性能。

以下查询应该做你想做的事：

```
DECLARE @center GEOGRAPHY

SET @center = geography::Point(46.969345, 8.592703, 4326)

SELECT TOP 10
    [Physical_Address_Street]
    , [Physical_Address_Local]
    , [Physical_Address_State]
    , [Physical_Address_Zip]
    , [Lat]
    , [Long]
    , [Phone_Number]
FROM Gas_Stations
WHERE Location_Type = 1
ORDER BY @center.STDistance(Location) ASC 
```

# postgresql - 在 PostgreSQL 中为当前时间戳添加间隔

> ID：16202934
> 
> 赞同：0
> 
> 时间：2013-04-24T21:57:59.540
> 
> 标签：postgresql, date

我想在 PostgreSQL 中为当前日期和时间添加 23 小时的间隔。查询应如下所示：

`SELECT timestamp LOCALTIMESTAMP(0) + interval '23 hours';`

由于某种原因，前面的语句返回错误。这里可能有什么问题，为什么它不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T22:03:50.353

删除 TimeStamp 关键字

```
SELECT LOCALTIMESTAMP(0) + interval '23 hours' 
```

或使用

```
SELECT now() + interval '23 hours' 
```

# javascript - casper评估修改全局变量

> ID：16202937
> 
> 赞同：1
> 
> 时间：2013-04-24T21:58:14.887
> 
> 标签：javascript, web-scraping, casperjs

我是 CasperJS 的新手，我遇到了 evaluate() 函数的问题。我有以下示例代码：

```
var results = [];  // a global var
var links = [link1, link2 ,....];  //a list of urls
var current = 0;

function search(url){
  this.start(url, function(){
    results = this.evaluate(function() { 
      var returnVal = [];
      //some code to store data into returnVal
      return returnVal;
      };
  })
}

function check(){
  if(current<7){
    this.echo('---Page' + (current + 1) + '---');
    search.call(this, links[current]);
    console.log(results.length);
    this.run(check);
    current++;
  } else{
    this.exit();
}

casper.start()
casper.then(function(){this.echo("starting");});
casper.run(check); 
```

所以基本上代码应该从 7 页中收集一些数据并将数据存储在全局 var 结果中。每页有 50 个要存储的数据。所以预期的输出是：

```
Starting
---Page1---
50
---Page2---
100
---Page3---
150
... 
```

但实际输出是：

```
Starting
---Page1---
0
---Page2---
50
---Page3---
50
... 
```

我预计每次迭代后结果的长度都会增加。但是，当我运行它时，结果的长度保持不变，这意味着在第一次迭代之后，它从未改变过。另外，我不明白为什么page1上的长度为0。我不明白为什么会这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T23:34:08.297

我认为这是因为每次测试运行时，都会重新分配全局“结果”。您需要附加到数组而不是在每一步之后重新分配它。就像是

```
var tempResults = this.evaluate(function() {
    var returnVal = [];
    // load your data from the page
    return returnVal;
};

for(var i=0, j=tempResults.length; i < j; i++) {
    //append to global here
    results.push(tempResults[i]);
} 
```

# sql - 将 T-SQL 查询转换为 SQLite 的简单工具？

> ID：16202938
> 
> 赞同：1
> 
> 时间：2013-04-24T21:58:23.363
> 
> 标签：sql, sql-server, sqlite

我想要一个简单的工具来将查询从 T-SQL (SQL Server) 转换为 SQLite。

有人知道吗？谢谢。

# ios-simulator - CLLocationManager 没有返回正确的位置

> ID：16202942
> 
> 赞同：2
> 
> 时间：2013-04-24T21:58:37.770
> 
> 标签：ios-simulator, cllocationmanager, cllocation, reverse-geocoding, clgeocoder

我正在开发一个应用程序，它每分钟左右检查一次您的位置，看看您的位置是否发生了变化。我正在使用 xCode 中的模拟位置来模拟位置变化。首先我会做伦敦，然后当它更新时我会将它更改为东京之类的东西，然后当它再次检查位置时它不会更新，它仍然认为它在伦敦。

```
-(void)recheckLocation{
    locationManager = nil;

    [recheckLocation invalidate];

    locationManager = [[CLLocationManager alloc]init];
    locationManager.delegate = self;
    locationManager.desiredAccuracy = kCLLocationAccuracyNearestTenMeters;
    [locationManager startUpdatingLocation];
}

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
    geocoder = [[CLGeocoder alloc] init];

    [locationManager stopUpdatingLocation];

    // Reverse Geocoding
    [geocoder reverseGeocodeLocation:newLocation completionHandler:^(NSArray *placemarks, NSError *error) {
        NSLog(@"Found placemarks: %@, error: %@", placemarks, error);
        if (error == nil && [placemarks count] > 0) {

            placemark = [placemarks objectAtIndex:0];
            NSString *Location = [NSString stringWithFormat:@"%@, %@",placemark.locality, placemark.administrativeArea];

            recheckLocation = [NSTimer scheduledTimerWithTimeInterval:60.0f target:self selector:@selector(recheckLocation) userInfo:nil repeats:YES]; 

        } else {
            NSLog(@"%@", error.debugDescription);
        }
    } ];

} 
```

无论我更改了多少次位置，它每次都会给我相同的位置，而不是正确的位置。有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-21T20:20:05.063

它的帖子有点旧，我对 CLLocationManager 的东西有基本的了解，但我仍在努力解决这个问题。我从您上面的代码中了解到 CLLocationManager 每次都会重新创建。CLLocationManager 就像一个单例类，您不需要每次都重新创建。你只需要调用 [locationManager startUpdatingLocation]; .

每次您调用 [geocoder reverseGeocodeLocation:xxx] 时也是如此。可能您需要在执行此操作之前找到准确性，这样它就不会被一次又一次地调用。

# jquery - 单击按钮时暂时暂停功能

> ID：16202946
> 
> 赞同：0
> 
> 时间：2013-04-24T21:58:45.233
> 
> 标签：jquery, settimeout

我一直在努力弄清楚如何做到这一点，但还没有真正做到。单击按钮时，我需要暂停下面的功能，并在第二次单击时重新启动它。

```
var About = function(dom) {
    this.text_spans = $('li', dom);
    this.len = this.text_spans.length;
    this.index = 0;

    this.init();

}

$.extend(About.prototype, {
    interval: 2.5 * 1000,
    init: function() {
        var that = this;
        setTimeout(function() {
            that.text_spans.eq(that.index++ % that.len).removeClass('visible');
                that.text_spans.eq(that.index % that.len).addClass('visible');
            setTimeout(arguments.callee, that.interval);
        }, that.interval);
    }
}); 
```

此函数的目标是隐藏一系列文本（例如，in `li`'s）并无限循环返回。单击按钮/链接时，该功能将暂停并停止更改文本。

我知道这`setTimeout()`与 clearTimeout() 有关，但我并不真正了解使其工作的语法或方法。谁能帮我理解它？非常感谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:28:18.823

尝试这样的事情（[演示](http://jsfiddle.net/Mottie/Xb5Xg/2/)）：

```
$.extend(About.prototype, {
    interval: 2.5 * 1000,
    init: function () {
        var that = this;
        $('a.toggle').click(function(){
            var running = $(this).hasClass('running');
            $(this).toggleClass('running', !running);
            if (running){
                clearInterval(that.timer);
            } else {
                that.timer = setInterval(function () {
                    that.text_spans.eq(that.index++ % that.len).removeClass('visible');
                    that.text_spans.eq(that.index % that.len).addClass('visible');
                }, that.interval);
            }
        }).click(); // start timer
    }
}); 
```

HTML

```
<a class="toggle" href="#">Click me to pause function</a> 
```

# android - 如何从 google eclipse 插件 1.7.7 更改为 1.7.5

> ID：16202947
> 
> 赞同：2
> 
> 时间：2013-04-24T21:58:46.827
> 
> 标签：android, eclipse, google-app-engine, google-eclipse-plugin, gae-eclipse-plugin

由于[谷歌领域的一个错误，](https://code.google.com/p/google-plugin-for-eclipse/issues/detail?id=117)我需要从 GEP 1.7.7 更改为版本 1.7.5 或 1.7.6。我将如何影响这种变化？我从 eclipse 中查看 eclipse 市场，但插件是按 3.6、3.7、3.8/4.2 等 eclipse 版本排列的。哪个是 1.7.5 或 1.7.6？我在 mac osx 上使用 eclipse Juno Service Release 2。

另外，这是否与`SDK(App-engine 1.7.6)`或相同`SDK(App-engine 1.7.5)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T17:39:34.243

您可以通过下载 SDK 手动进行降级。

试试这个链接[https://code.google.com/p/googleappengine/downloads/detail?name=appengine-java-sdk-1.7.5.zip&can=2&q=label%3AOpSys-All](https://code.google.com/p/googleappengine/downloads/detail?name=appengine-java-sdk-1.7.5.zip&can=2&q=label%3AOpSys-All)

然后您必须通过以下方式将其添加到 Eclipse：

> 窗口 > 首选项 > Google > App Engine。

然后单击“添加”按钮，并添加下载旧 SDK 的文件夹

添加后，您必须通过以下方式配置项目：

> 属性 > Google > App Engine，然后选择 1-7-5 SDK

你应该准备好了

# mysql - 我的查询每次返回相同（date2）

> ID：16202948
> 
> 赞同：0
> 
> 时间：2013-04-24T21:58:47.677
> 
> 标签：mysql, sql

```
SELECT  o.Date1, o.Date2 
FROM customers AS c, products AS p, products_ids AS pi, orders AS o, temptable AS te 
WHERE p.productid = pi.productidD 
AND pi.prodno = te.prodno 
AND c.custid = o.custid
AND o.custid = te.custid 
AND te.custid =  '24' 
GROUP BY pi.productiD 
```

即使mysql内部的日期不同，查询的结果每次都向所有行返回相同的日期（一行）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T22:28:38.497

如前所述，为了清楚起见，值得切换到较新的 ANSI 92 JOIN 语法，这可以避免意外的交叉连接，因此您的查询将变为：

```
SELECT  o.Date1, o.Date2 
FROM    customers AS c
        INNER JOIN orders AS o
            ON c.custid = o.custid
        INNER JOIN temptable AS te 
            o.custid = te.custid 
        INNER JOIN products AS p
            ON pi.prodno = te.prodno
        INNER JOIN products_ids AS pi
            ON p.productid = pi.productidD 
WHERE   te.custid =  '24' 
GROUP BY pi.productiD; 
```

但是，这不是您的查询中的问题，问题在于您正在滥用 MySql 中的功能，您可以通过以下方式选择不属于该组的项目：

在这里，您告诉查询为 的每个不同值选择 1 行，每个和`pi.ProductID`可能有多个不同的值，`o.Date1`并且您没有向查询提供有关从这些多种可能性中进行选择的提示。`o.Date2``pi.ProductID`

ANSI 标准允许在 select 中使用不在 group by 中的列，但仅当 select 中的列在功能上依赖于 group by 中的列时，这很难遵守，因此大多数 DBMS 根本不允许列在不属于 group by 的 select 中。

为了演示考虑这个数据集（T）

```
OrderID ProductID   Date1       Date2
1       1           20130401    20130402
2       1           20130402    20130403
3       2           20130403    20130404
4       2           20130404    20130405
5       2           20130405    20130406 
```

如果（如您的情况）您做了：

```
SELECT  OrderID, ProductID, Date1, Date2
FROM    T
GROUP BY ProductID 
```

你可能会得到：

```
OrderID ProductID   Date1       Date2
1       1           20130401    20130402
3       2           20130403    20130404 
```

只需为每个产品 ID 获取第一行，但是由于查询是不确定的，因此查询返回每个产品 ID 的最后一行同样正确：

```
OrderID ProductID   Date1       Date2
2       1           20130402    20130403
5       2           20130405    20130406 
```

这是一个常见的神话，添加 order by 将对此有所帮助，例如

```
SELECT  OrderID, ProductID, Date1, Date2
FROM    T
GROUP BY ProductID
ORDER BY OrderID; 
```

MySql 在应用 order by 之前确定要返回的行，因此即使添加`ORDER BY OrderID`也不能保证返回每个 productID 的第一个订单。

MySQL[文档](http://dev.mysql.com/doc/refman/5.0/en/group-by-extensions.html)状态

*服务器可以从每个组中自由选择任何值，因此除非它们相同，否则选择的值是不确定的。此外，从每个组中选择值不会受到添加 ORDER BY 子句的影响。*

最后详细说明我所说的功能相关列，因为在这个数据集中`OrderID`是一个主键，根据 ANSI 标准，你可以写：

```
SELECT  OrderID, ProductID, Date1, Date2
FROM    T
GROUP BY OrderID; 
```

所以，虽然我还没有真正回答你的问题，但我希望已经表明你哪里出了问题。您确实需要通过 group by 确定您要实现的目标，如果您仍然没有解决方案，那么我会提出一个新的、更具建设性的问题，其中包含示例数据和具有明确规则的预期输出为什么expexted输出是expexted。

# css - 如何在 DIV 浮动旁边创建 DIV“行”？

> ID：16202952
> 
> 赞同：1
> 
> 时间：2013-04-24T21:58:53.250
> 
> 标签：css, html

我正在尝试制作一个浮动到我的内容左侧的大型 DIV，然后使用位于内容旁边的行的其他 DIV。

我将如何做到这一点并确保每个“行” div 实际上是一行，但仍然尊重左侧较大的 DIV（前几个不应该在它下方弹出）。

我在这里复制了 jsFiddle 上的问题：

[http://jsfiddle.net/Dracorat/Xf9Qv/1/](http://jsfiddle.net/Dracorat/Xf9Qv/1/)

CSS：

```
.DropCapImage {
    border: 2px solid purple;
    color: #EEE;
    display: block;
    width: 200px;
    height: 300px;
    float: left;
    margin: 0 10px 10px 0;
}

.DialogAction {
    padding: 10px;
    font-style: italic;
    float: left;
    clear: right;
}

.DialogLine {
    float: left;
    clear: right
}

.DialogWho {
    font-weight: bold;
    float: left;
    width: 100px;
}

.DialogWhat {
    float: left;
    white-space: pre-wrap;
    font-family: 'consolas', monospace;
} 
```

HTML：

```
<div class="DropCapImage">Pretty Image Here</div>

<div class="DialogLine">
    <div class="DialogWho">KING CLAUDIUS</div>
    <div class="DialogWhat">Short Text</div>
</div>

    <div class="DialogAction">Exeunt all but HAMLET</div>

    <div class="DialogAction">Something Else</div>

    <div class="DialogAction">Another Else</div>

    <div class="DialogLine">
        <div class="DialogWho">HAMLET</div>
        <div class="DialogWhat">O, that this too too solid flesh would melt
Thaw and resolve itself into a dew!
Or that the Everlasting had not fix'd
His canon 'gainst self-slaughter! O God! God!
How weary, stale, flat and unprofitable,
Seem to me all the uses of this world!
Fie on't! ah fie! 'tis an unweeded garden,
That grows to seed; things rank and gross in nature
Possess it merely. That it should come to this!
But two months dead: nay, not so much, not two:
So excellent a king; that was, to this,
Hyperion to a satyr; so loving to my mother
That he might not beteem the winds of heaven
Visit her face too roughly. Heaven and earth!
Must I remember? why, she would hang on him,
        ... etc</div>
</div>

    <div class="DialogLine">
        <div class="DialogWho">Speaker Below</div>
        <div class="DialogWhat">This should be below the purple area
    </div> 
```

如您所见，浮动完全是虚假的，带有小 div。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T22:07:00.523

不要浮动`.DialogLine`and`.DialogAction`元素

只要给他们正确的`margin-left`（*等于左栏的宽度*）

并且不要忘记也给`overflow:hidden`他们，以便将扩展以适应他们的内容..

```
.DialogAction {
    padding: 50px;
    font-style: italic;
    margin-left:210px;
}
.DialogLine {
    margin-left:210px;
    overflow:hidden;
} 
```

演示在[http://jsfiddle.net/gaby/Xf9Qv/4/](http://jsfiddle.net/gaby/Xf9Qv/4/)

# asp.net - 在 IIS 7 服务器中发生故障后自动重新启用 ASP.NET 服务

> ID：16202953
> 
> 赞同：1
> 
> 时间：2013-04-24T21:58:55.310
> 
> 标签：asp.net, iis-7

由于我的 Web 应用程序中的异常（我现在正在修复），ASP.NET v4.0 服务池停止（我必须重新启动它），我的问题是......有没有办法配置 IIS 服务器因此，如果发生这种情况，它会在一段时间后再次启用服务池吗？

这会在任何意义上损坏服务器吗？（在这种情况下，我知道的例外是由于同时从多个线程写入文件，但这个问题我会很快解决。我问的是以防万一将来由于其他原因发生新问题）。

提前致谢。

PD（我是服务器新手）

# android - 创建一个可刷新的listView

> ID：16202955
> 
> 赞同：0
> 
> 时间：2013-04-24T21:58:58.687
> 
> 标签：android

我想用另一个 listView 中的项目创建一个 listView。我有一个页面和一个按钮。当我按下按钮时，我想打开一个列表。当我单击该列表中的一个项目时，我想用所选项目填充第一页（使用我按下的按钮）并在我要创建的列表上进行刷新。我还想将创建的列表（选择的项目）存储在一个表中。有人可以帮我做一些教程吗？我进行了很多搜索，但没有找到可以帮助我解决此问题的方法。感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:07:56.660

这是关于如何在 android 中使用列表视图的一个很好的教程： [http ://www.vogella.com/articles/AndroidListView/article.html](http://www.vogella.com/articles/AndroidListView/article.html)

要刷新数据，只需将新数据`notifyDataSetChanged`放在列表适配器上并使用

# java - 获取给定时区的当前时间：android

> ID：16202956
> 
> 赞同：20
> 
> 时间：2013-04-24T21:59:01.767
> 
> 标签：java, android, android-date

我是 Android 新手，目前在给定时区的情况下获取当前时间时遇到问题。

我得到格式为“GMT-7”的时区，即字符串。我有系统时间。

有没有一种干净的方法来获取上述给定时区的当前时间？任何帮助表示赞赏。谢谢，

编辑：尝试这样做：

```
public String getTime(String timezone) {
    Calendar c = Calendar.getInstance();
    c.setTimeZone(TimeZone.getTimeZone(timezone));
    Date date = c.getTime();
    SimpleDateFormat df = new SimpleDateFormat("dd/MM/yyyy");
    String strDate = df.format(date);
    return c.getTime().toString();
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-24T23:34:56.467

我让它像这样工作：

```
TimeZone tz = TimeZone.getTimeZone("GMT+05:30");
Calendar c = Calendar.getInstance(tz);
String time = String.format("%02d" , c.get(Calendar.HOUR_OF_DAY))+":"+
            String.format("%02d" , c.get(Calendar.MINUTE))+":"+
.                   String.format("%02d" , c.get(Calendar.SECOND))+":"+
    .           String.format("%03d" , c.get(Calendar.MILLISECOND)); 
```

此外，基于此日期的所有其他时间转换也应与此时区一起使用，否则将使用设备的默认时区，并且将基于该时区转换时间。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-24T22:03:50.800

```
// Backup the system's timezone
TimeZone backup = TimeZone.getDefault();

String timezoneS = "GMT-1";
TimeZone tz = TimeZone.getTimeZone(timezoneS);
TimeZone.setDefault(tz);
// Now onwards, the default timezone will be GMT-1 until changed again

Calendar cal = Calendar.getInstance();
Date date = cal.getTime();
String timeS = String.format("Your time on %s:%s", timezoneS, date);
System.out.println(timeS);

// Restore the original timezone
TimeZone.setDefault(backup);
System.out.println(new Date()); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-11-28T05:04:55.973

# java.time

与 Java 捆绑在一起的旧日期时间类和第三方 Joda-Time 库都已被Java 8 及更高版本中内置的[java.time框架所取代。](http://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)这些类取代了旧的麻烦的日期时间类，例如`java.util.Date`. 请参阅[Oracle 教程](http://docs.oracle.com/javase/tutorial/datetime/TOC.html)。许多 java.time 功能在 ThreeTen-Backport 中向后移植到 Java 6 和 7，并在[ThreeTenABP](https://github.com/JakeWharton/ThreeTenABP)[中](http://www.threeten.org/threetenbp/)进一步适应 Android 。

顺便说一句，永远不要使用一位数的小时数来引用与[UTC 的偏移量](https://en.wikipedia.org/wiki/Offset_from_UTC)，例如`-7`，因为这是非标准的，并且与各种协议和库不兼容。始终用零填充第二个数字，例如`-07`.

如果您只有一个偏移量而不是时区，请使用`OffsetDateTime`该类。

```
ZoneOffset offset = ZoneOffset.ofHours( -7 );
OffsetDateTime odt = OffsetDateTime.now( offset );
String output1 = odt.toLocalTime().toString();
System.out.println( "Current time in " + offset + ": " + output1 ); 
```

> 当前时间在-07:00: 19:41:36.525

如果您有一个完整的时区，它是一个偏移量*加上*一组用于处理诸如夏令时 (DST) 等异常的规则，而不仅仅是与 UTC 的偏移量，请使用`ZonedDateTime`该类。

```
ZoneId denverTimeZone = ZoneId.of( "America/Denver" );
ZonedDateTime zdt = ZonedDateTime.now( denverTimeZone );
String output2 = zdt.toLocalTime().toString();
System.out.println( "Current time in " + denverTimeZone + ": " + output2 ); 
```

> 美国/丹佛当前时间：20:41:36.560

[在 Ideone.com 中](http://ideone.com/ZL8tSF)查看此代码。

# 乔达时间

您可以在 Android 中使用[Joda-Time](http://www.joda.org/joda-time/) 2.7。使日期时间工作更容易。

```
DateTimeZone zone = DateTimeZone.forID ( "America/Denver" );
DateTime dateTime = new DateTime ( zone );
String output = dateTime.toLocalTime ().toString (); 
```

转储到控制台。

```
System.out.println ( "zone: " + zone + " | dateTime: " + dateTime + " | output: " + output ); 
```

运行时……</p>

> 地区：美国/丹佛 | 日期时间：2016-07-11T20:50:17.668-06:00 | 输出：20:50:17.668

# 从纪元开始计数

[我强烈建议不要](https://stackoverflow.com/a/29836873/642706)按自计数按时间[跟踪](https://en.wikipedia.org/wiki/Epoch_(reference_date))。但如果有必要，您可以通过调用a 上的方法来提取 Joda-Time 的内部毫秒自纪元（[Unix 时间](https://en.wikipedia.org/wiki/Unix_time)，1970 UTC 的第一时刻）。[`getMillis`](http://www.joda.org/joda-time/apidocs/org/joda/time/base/BaseDateTime.html#getMillis--)[`DateTime`](http://www.joda.org/joda-time/apidocs/org/joda/time/DateTime.html)

请注意使用 64 位`long`而不是 32 位`int` [原始类型](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)。

在 java.time. 请记住，您可能会在这里丢失数据，因为 java.time 的分辨率高达纳秒。从纳秒到毫秒意味着最多截断一秒的十进制小数的六位数字（毫秒为 3 位，纳秒为 9 位）。

```
long millis = Instant.now ().toEpochMilli (); 
```

在乔达时代。

```
long millis = DateTime.now( denverTimeZone ).getMillis(); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-05-13T10:00:57.170

将时区设置为格式化程序，而不是日历：

```
public String getTime(String timezone) {
    Calendar c = Calendar.getInstance();
    Date date = c.getTime(); //current date and time in UTC
    SimpleDateFormat df = new SimpleDateFormat("dd/MM/yyyy");
    df.setTimeZone(TimeZone.getTimeZone(timezone)); //format in given timezone
    String strDate = df.format(date);
    return strDate;
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-04-24T22:01:39.530

尝试这个：

```
SimpleDateFormat df = new SimpleDateFormat("dd/MM/yyyy");
df.setTimeZone(TimeZone.getTimeZone("YOUR_TIMEZONE"));
String strDate = df.format(date); 
```

YOUR_TIMEZONE 可能类似于：GMT、UTC、GMT-5 等。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-03-24T03:54:38.887

是的你可以。通过调用 TimeZone`setDefault()`方法。

```
public String getTime(String timezone) {
    TimeZone defaultTz = TimeZone.getDefault();

    TimeZone.setDefault(TimeZone.getTimeZone(timezone));
    Calendar cal = Calendar.getInstance();
    Date date = cal.getTime();
    String strDate = date.toString();

    // Reset Back to System Default
    TimeZone.setDefault(defaultTz);

    return strDate;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-06-21T17:25:56.160

我找到了一种更好更简单的方法。

应用程序的第一个设置时区使用

```
 TimeZone.setDefault(TimeZone.getTimeZone("America/Los_Angeles")); 
```

然后调用 Calander 在内部获取日期，它使用上面通过应用程序设置的默认时区。

```
 Calendar cal = Calendar.getInstance();
     Log.d("Los angeles time   ",cal.getTime().toString()); 
```

它将根据时区给出当前时间。

**D/洛杉矶时间：2018 年 6 月 21 日星期四 13:52:25 PDT**

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-10-19T18:46:01.550

**在科特林：**

```
 val mTime: Calendar = Calendar.getInstance()
 val timeZone = TimeZone.getDefault().displayName // based on the device time zone it will calculate. 
```

输出 ：

```
IST // it will return device time zone 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-01-31T04:55:57.643

```
 TimeZone tz = TimeZone.getTimeZone(TimeZoneID);
 Calendar c= Calendar.getInstance(tz);
 String time=new SimpleDateFormat("dd/MM/yyyy HH:mm:ss").format(new Date(cal.getTimeInMillis())); 
```

TimeZoneID 可以是以下之一，根据您的选择

```
String[] ids=TimeZone.getAvailableIDs(); 
```

然后可以根据上面接受的答案获得时间

```
String time = String.format("%02d" , c.get(Calendar.HOUR_OF_DAY))+":"+
            String.format("%02d" , c.get(Calendar.MINUTE))+":"+
                  String.format("%02d" , c.get(Calendar.SECOND))+":"+
               String.format("%03d" , c.get(Calendar.MILLISECOND)); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-01-30T10:35:23.293

处理时区和毫秒值的一种方法：

```
val currentDateTime = Calendar.getInstance().apply {
        timeZone?.let {
            val tzCalendar = Calendar.getInstance(it)
            this.set(Calendar.HOUR_OF_DAY, tzCalendar.get(Calendar.HOUR_OF_DAY))
            this.set(Calendar.MINUTE, tzCalendar.get(Calendar.MINUTE))
        }
    }.time 
```

这样，您就可以获得特定时区的毫秒数。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-06-21T21:00:24.110

最干净的方法是使用 SimpleDateFormat

```
SimpleDateFormat = SimpleDateFormat("MMM\nd\nh:mm a", Locale.getDefault()) 
```

或者您可以指定语言环境

# java - 绑定任何可能的字母或使用 KeyListener？

> ID：16202959
> 
> 赞同：2
> 
> 时间：2013-04-24T21:59:20.900
> 
> 标签：java

我需要为任何语言的任何字母获取键盘输入。我已经用 KeyListener 创建了一个可以正常工作的脏示例，但是键绑定听起来很有趣。键绑定的问题在于，我似乎需要手动将每个键与一个操作绑定，这在我的情况下几乎是不可能的，因为应用程序需要获取多种语言的输入字符。

那么，有什么方法可以创建与 ANY_ALPHABETICAL_KEY 之类的绑定？

提前致谢。

PS：这不是重复的:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T23:34:48.637

键绑定仅适用于单个键。是的，您需要将每个键与一个 Action 绑定，所以这不是一个好的选择。

如果您需要监听整个键盘，那么使用 KeyListener 或者[Global Event Listeners](http://tips4java.wordpress.com/2009/08/30/global-event-listeners/)中的一个想法可能会有所帮助。

如果没有更具体的要求，我们只是猜测。

# cocoa - 使用 CWLSynthesizeSingleton.h 时的内存问题

> ID：16202966
> 
> 赞同：1
> 
> 时间：2013-04-24T21:59:57.230
> 
> 标签：cocoa, singleton

我正在使用[CWLSynthesizeSingleton.h](https://github.com/incbee/CWLSynthesizeSingleton/blob/master/CWLSynthesizeSingleton.h)创建一个单例。但是在 Xcode 中分析源代码时，它会显示此错误：

```
Object with a +0 retain count returned to caller where a +1 (owning) retain count is expected 
```

在这条线上

```
CWL_SYNTHESIZE_SINGLETON_FOR_CLASS_WITH_ACCESSOR(MyManager, sharedManager) 
```

我在这个项目中不使用 ARC。任何建议如何解决？它应该忽略它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-06T22:27:51.120

简单的答案：不要使用该代码，它已经过时且不再推荐。这些天创建单例的正确方法是使用`dispatch_once`：

```
+ (instancetype)sharedInstance
{
    static dispatch_once_t once;
    static id sharedInstance;
    dispatch_once(&once, ^{
        sharedInstance = [(id)[super alloc] init];
    });
    return sharedInstance;
} 
```

如果你想阻止你的类的用户直接分配一个实例，那么`unavailable`在你的头文件中为那些你不想调用的方法使用编译器属性：

```
+ (instancetype)alloc __attribute__((unavailable("alloc not available, call sharedInstance instead")));
- (instancetype)init __attribute__((unavailable("init not available, call sharedInstance instead")));
+ (instancetype)new __attribute__((unavailable("new not available, call sharedInstance instead"))); 
```

# javascript - For循环敌人重生

> ID：16202967
> 
> 赞同：0
> 
> 时间：2013-04-24T22:00:14.167
> 
> 标签：javascript, html, html5-canvas

在游戏中处理敌人重生功能但是我的 for 循环似乎没有效果，因为我仍然只有一个敌人在屏幕上移动，谢谢

```
Monster.prototype.draw = function () {      
        for (var i=0; i <5; i++){
        clearMonster();
        monsterCon.drawImage(sprite, this.locationX, this.locationY, this.width, this.height, this.destinationX, this.destinationY, this.width, this.height);
                    this.checkKeys();
        }
    }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T22:09:08.307

在再次添加之前，您要在循环的每次迭代中清除怪物。

# gis - 使用leaflet mapping api，你如何确定折线中的哪个点被点击了？

> ID：16202968
> 
> 赞同：3
> 
> 时间：2013-04-24T22:00:14.670
> 
> 标签：gis, leaflet, openstreetmap

我正在使用传单映射 API。我想确定折线中的哪个点被点击了。折线是我使用 MapQuest Open 的方向服务渲染的。

相关代码为：

```
for ( var i = 0; i < latlngs.length; i++ )
   {

   // the equals method uses a small fudge factor to decide if the two 
   // points are the same.

   if ( latlng.equals( latlngs[ i ] ))
      {
      return i;
      }
   } 
```

.equals() 应该将点与软糖因子进行比较。当我单击折线时，我会收到一个带有 lat/lngs 的事件，例如：

```
'38.83966582989183','-77.0083075761795' 
```

我在折线中的纬度/经度精度较低，如下所示：

```
'38.841289','-77.008842' 
```

因此，当我遍历寻找匹配项时，`equals()`永远不会返回 true。显然，点击事件正在触发，所以传单知道我点击了折线，但似乎没有一种干净的方法来获取点击的 latlng 的实际偏移量。

我正在考虑只是降低鼠标单击返回的精度，但这并不“感觉”是正确的解决方案。

任何帮助/指针将不胜感激。

编辑：

设置`L.LatLng.MAX_MARGIN`为`1.0E-3`似乎有效，但这似乎是一个非常粗略的边距。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-30T05:01:55.600

我的传单代码：

```
var _getClosestPointIndex = function(lPoint, arrayLPoints) {
    var distanceArray = [];
    for ( var i = 0; i < arrayLPoints.length; i++ ) {
        distanceArray.push( lPoint.distanceTo(arrayLPoints[i]) );
    }
    return distanceArray.indexOf(  Math.min.apply(null, distanceArray) );
};    

var polyLine = L.polyline(arrayLatLngCollection, lineOpt);
        polyLine.addEventListener('click dblclick', function(e) {
            var index = _getClosestPointIndex(e.latlng, arrayLatLngCollection);
            var popup = L.popup()
                .setLatLng(new L.latLng(arrayLatLngCollection[index]))
                .setContent('<p>Hello world!<br />This is a nice popup.</p>')
                .openOn(self.map);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T00:28:47.307

我想出了一个可能不漂亮但似乎可行的解决方案。我注意到折线中有一个 _originalPoints 数组。polyline 事件中还有一个 layerPoint 成员，它是一个 Point 对象。

我不喜欢使用未记录的 API，但使用 L.LineUtil.pointToSegmentDistance 循环遍历点以找到与单击点最近的点似乎可以按以下方式工作：

```
 var point = e.layerPoint;

var points = polyline._originalPoints;

for ( var i = 0; i < points.length; i++ )
    {

    if ( i < points.length - 2 )
        {

        if ( min_distance > L.LineUtil.pointToSegmentDistance( point, points[i], points[ i + 1] ) )
            {
            min_distance = L.LineUtil.pointToSegmentDistance( point, points[i], points[ i + 1] );
            min_offset = i;
            }

        }

    } 
```

# api - “地球”按钮未显示以从谷歌地图切换到谷歌地球

> ID：16202970
> 
> 赞同：0
> 
> 时间：2013-04-24T22:00:19.223
> 
> 标签：api, google-maps, google-earth

我查看了几个关于如何在谷歌地球和谷歌地图版本 3 之间切换的示例，但我一直遇到同样的问题。我可以复制代码并将我自己的 API 用于谷歌地图，谷歌地图显示并运行良好。问题是切换到谷歌地球的按钮没有显示在“卫星”和“地图”按钮旁边。我是否需要创建自己的按钮或复选框或其他东西来在两者之间切换，如果需要，我该如何调用它？我从谷歌图书馆得到我的例子：http: [//google-maps-utility-library-v3.googlecode.com/svn/trunk/googleearth/examples/earth.html](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/googleearth/examples/earth.html) 我复制的代码显示在：[http:// /digcrust.groups.et.byu.net/GEandGMexample.html](http://digcrust.groups.et.byu.net/GEandGMexample.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:26:27.787

为了在您的浏览器上查看 Google 地球插件以及您的地图，您需要获取地球 API 密钥：[https](https://developers.google.com/earth/documentation/) ://developers.google.com/earth/documentation/ 。此示例似乎反映了您正在寻找的内容：[http ://earth-api-samples.googlecode.com/svn/trunk/examples/maps-integration.html](http://earth-api-samples.googlecode.com/svn/trunk/examples/maps-integration.html)

# matlab - 我怎么知道哪些维度是主要组成部分？

> ID：16202972
> 
> 赞同：0
> 
> 时间：2013-04-24T22:00:26.310
> 
> 标签：matlab, linear-algebra, pca, eigenvalue, dimensionality-reduction

我使用matlab的princomp函数做PCA。根据我的理解，我可以检查潜在的来决定我需要多少个维度。

```
[coeff, score, latent, t2] = princomp(fdata);
 cumsum(latent)./sum(latent); 
```

通过使用 trainMatrix = coeff(:,1:10) （我选择前 10 个维度）和 newData = data*trainMatrix，我可以获得减少的数据。

但是我怎么能知道哪个维度减少了，剩下的10个维度呢？

我的意思是如果我有 30 个特征，我可以在 princomp 之后弄清楚我保留了哪 10 个特征（原始数据的列索引）吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T22:31:45.993

新维度对应于原始维度的线性组合，即每个新特征都用具有不同权重的所有旧特征来表示。

# ruby - 记住如何调用 ruby 注入的助记符是什么？

> ID：16202980
> 
> 赞同：3
> 
> 时间：2013-04-24T22:00:55.327
> 
> 标签：ruby

我永远不记得它是否

```
array.inject{|memo,obj| block} 
```

或者

```
array.inject{|obj,memo| block} 
```

有没有人有记住顺序的好技巧？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T22:10:33.437

`inject`/`reduce`只不过是一个[左折叠](http://en.wikipedia.org/wiki/Fold_%28higher-order_function%29)（因此在其他语言中称为`foldl`/ `foldLeft`），就是这样，元素与二元运算符的递归**左关联组合：**

```
(1..5).reduce(:+) == (((1 + 2) + 3) + 4) + 5 #=> true
(1..5).reduce(:-) == (((1 - 2) - 3) - 4) - 5 #=> true 
```

因此，将累加器作为块的左/第一个参数传递是很自然的。在正确的折叠上，累加器将是正确的/第二个参数。

不是真正的助记符，但一旦你意识到这`reduce`是左弃牌，你就不会忘记累加器的去向。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T22:07:32.593

它是 的反面`each_with_object`，我确实记得（首先是`each`，然后是`object`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T23:07:45.447

如果你真的认为它在操纵 a`memo`和 an`object`那么它是按字母顺序排列的：

```
array.inject{|memo,obj| block} 
```

您的助记符是备忘录按字母顺序出现在对象之前。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T22:05:30.163

> **当使用短块注入时，将参数命名为 |a, e| （助记符：累加器，元素）**

或者

> **不好，但它对我有帮助：“备忘录”首先出现（按字母顺序），所以它是 inject(memo, obj)**

```
[1, 2, 3, 4, 5, 6].inject([]) do |result, elm|
  result << elm * 2 if elm % 2 == 0
  result
end
# => [4, 8, 12] 
```

> 那么这是在做什么呢？注入英文是：
> 
> 从某个对象（我们的空数组）开始，然后将调用者 ([1, 2, 3, 4, 5, 6]) 中的每个元素传递给块。提供块可以自由更改的结果对象。结果从我们的第一个参数（空数组）开始，然后成为块最后评估的任何内容。

更多详细信息[`Here`](http://www.potstuck.com/2011/07/25/map-if-in-ruby-and-an-introduction-to-rubys-inject/)

# macos - 图片不动（-setNeedsDisplay:YES 不调用 drawRect:)

> ID：16202993
> 
> 赞同：0
> 
> 时间：2013-04-24T22:01:58.083
> 
> 标签：macos, image, drawrect, setneedsdisplay

很抱歉再次打扰您关于`- (void)setNeedsDisplay`which does not call `- (void)drawRect:`方法...但我在这个问题上花了很多时间

我是 Objective-C 的初学者，我正在尝试做一个简单的拍摄。（我知道我需要工作）

但是现在，我只想在视图中举起一张图片。例如，图片出现在视图的 (0,0) 处，我希望每次按下 NSButton 时都能使这张图片上升（10 像素）。

**问题是图片不动；（**你们中的一些人可以检查一下？这是代码：

```
#import <Cocoa/Cocoa.h>

@interface maVue : NSView {

    NSImageView * monMonstre;
    int nombre;
}
@property (readwrite) int nombre;

- (IBAction)boutonClic:(id)sender;

@end

#import "maVue.h"

@implementation maVue

- (id)initWithFrame:(NSRect)frame {
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code here.
        nombre = 2;
        monMonstre = [[NSImageView alloc]init];
    }
    return self;
}

- (void)drawRect:(NSRect)dirtyRect 
{
    // Drawing code here.
    [monMonstre setFrame:CGRectMake(0,[self nombre],100,100)];
    [monMonstre setImage:[NSImage imageNamed:@"monstre.jpg"]];
    [self addSubview:monMonstre];
}

- (IBAction)boutonClic:(id)sender
{
    [self setNombre:[self nombre]+10];
    [self setNeedsDisplay:YES];

}

- (void)setNombre:(int)nouveauNombre
{
    nombre=nouveauNombre;
}

- (int)nombre
{
    return nombre;
}
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:16:54.130

你**不需要** `- (void)setNeedsDisplay`！

只需对`NSView`属性使用标准`frame`。

你应该重写你的代码：

```
#import <Cocoa/Cocoa.h>

@interface maVue : NSView
{
  NSImageView * monMonstre;
  int nombre;
}
@property (readwrite) int nombre;

- (IBAction)boutonClic:(id)sender;

@end

#import "maVue.h"

@implementation maVue

- (void)initWithFrame:(CGRect)frame
{
  if(self = [super initWithFrame:frame])
  {
    nombre = 2;
    monMonstre = [[NSImageView alloc] init];
    [monMonstre setImage:[NSImage imageNamed:@"monstre.jpg"]];
    NSSize mSize = [monMonstre image].size;
    NSRect monstreFrame;
    monstreFrame = NSMakeRect(0.0f, [self nombre], mSize.width, mSize.height);
    [monMonstre setFrame:monstreFrame];
    [self addSubview:monMonstre];
    [monMonstre release]; // <-- only if you don't use ARC (Automatic Reference Counting)
  }
  return self;
}

- (IBAction)boutonClic:(id)sender
{
  [self setNombre:[self nombre]+10];

  NSRect frame = [monMonstre frame];
  frame.origin.y = [self nombre];

  [monMonstre setFrame:frame]
}

- (void)setNombre:(int)nouveauNombre
{
  nombre=nouveauNombre;
}

- (int)nombre
{
  return nombre;
}

@end 
```

# jquery - 下拉子菜单不起作用

> ID：16202995
> 
> 赞同：1
> 
> 时间：2013-04-24T22:02:02.933
> 
> 标签：jquery, css, menu, navigation, superfish

[http://www.lumivase.com/](http://www.lumivase.com/)

在上述网站上。尝试使用菜单的子菜单时菜单消失。即在站点菜单上转到市场研究加>资源中心>（如果尚未关闭）然后转到十几个问题...

我尝试将 css 恢复为原始样式，尽管这确实完全弄乱了菜单宽度，但即使使用原始 css 编码，问题仍然存在。

附件是我当前的css文件，如果你能指导我什么规则控制菜单的子菜单，那就太好了。

```
/* -------------------[ Top Navigation ]------------------- */

#topnav {

    width: 970px;

    padding: 1px 0 0;

    margin: 0 auto;

    background:url(images/navbg.gif) top left;

    -moz-box-shadow: 0px 3px 3px 0px; rgba(0,0,0,0.3);

    -webkit-box-shadow: 0px 3px 3px 0px; rgba(0,0,0,0.3);

    box-shadow: 0px 3px 3px 0px; rgba(0,0,0,0.3);

    }

#topnav .limit {

    width:970px;

    margin:0 auto;

    padding:0;

    -moz-box-shadow: 0px 3px 3px 0px; rgba(0,0,0,0.3);

    -webkit-box-shadow: 0px 3px 3px 0px; rgba(0,0,0,0.3);

    box-shadow: 0px 3px 3px 0px; rgba(0,0,0,0.3);

    }

#topnav ul {

    height: auto;

    width:970px;

    list-style: none;

    padding: 0 0px;

    margin: 0 auto;

    float:left;

    -moz-box-shadow: 0px 3px 3px 0px; rgba(0,0,0,0.3);

    -webkit-box-shadow: 0px 3px 3px 0px; rgba(0,0,0,0.3);

    box-shadow: 0px 3px 3px 0px; rgba(0,0,0,0.3);

    }

#topnav ul a, #topnav ul a:link, #topnav ul a:visited {

    height: auto;

    display: block;

    text-decoration: none;

    padding: 0 10px;

    margin:0 auto;

    color:#fff;

    overflow:hidden;

    float:left;

    }

#topnav ul a:hover, #topnav ul a:active  {

    background:#0A1F33;

    height: auto;

    }

#topnav li {

    height: auto;

    line-height:40px;

    float: left;

    }

#topnav li ul {

    float:left;

    z-index:9999;

    position: absolute;

    left: -999em;

    height: auto;

    width: 400px;

    margin-top: 35px;

    padding: 0 10px;

    border-top:1px solid #f5f5f5;

    background:#0A1F33;

    }

#topnav li li {

    height: auto;

    line-height:30px;

    border-bottom:1px solid #000;

    }

#topnav ul li ul a, #topnav ul li ul a:link, #topnav ul li ul a:visited {

    height: auto;

    width:380px;

    float:left;

    }

#topnav ul li ul a:hover, #topnav ul li ul a:active  {

    height: auto;

    background:#000;

    }

#topnav li ul ul {

    height: auto;

    border:0;

    margin: -30px 0 0 400px;

    height: auto;

    }

#topnav li:hover ul ul, #topnav li:hover ul ul ul, #topnav li.sfhover ul ul, #topnav li.sfhover ul ul ul {

    height: auto;

    left: -999em;

    height: auto;

    }

#topnav li:hover ul, #topnav li li:hover ul, #topnav li li li:hover ul, #topnav li.sfhover ul, #topnav li li.sfhover ul, #topnav li li li.sfhover ul {

    left: auto;

    height: auto;

    }

#topnav li:hover, #topnav li.sfhover {

    background:#0A1F33;

    height: auto;

    } 
```

# php - 是否可以在不使用 PHP 的情况下将数据提交到数据库？

> ID：16202998
> 
> 赞同：0
> 
> 时间：2013-04-24T22:02:25.050
> 
> 标签：php, ajax, database, jquery, database-connection

我在不允许 PHP 的第三方平台上工作，但我仍然需要将信息从表单提交到数据库。所以我需要一种无需 PHP 就可以将数据提交到数据库的方法。

这可能吗？我可以采取其他途径来存储信息吗？

我已经阅读了其他几篇文章，但看不到明确的答案。这是我能想到的最接近我想要实现的目标......但不是我可以采取的路线。 [通过 Ajax 直接访问服务器数据库（无需 PHP 或其他中间体）](https://stackoverflow.com/questions/2256310/directly-accessing-server-database-via-ajax-without-php-or-some-other-intermedi)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T05:51:30.980

如果您不关心安全性（您可以使用 vbscript 或Shockwave，或者只是使用 javascript 对象表示法），这是可能的，但是如果数据库位于服务器上，您是否没有意识到它将对您的数据库和网站造成什么灾难？

PHP 的创建是因为它在语言上的简单性，在 PHP 3 发布之前我是 perl 中的代码，在 CGI 时代很难理解 Perl 语法。使用基于服务器的脚本的主要原因是我们的数据库和网络内容的安全性。

你想开发第三方平台吗？也许你可以用你的新脚本开发新的网络浏览器技术，也许你的新平台会成功。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T13:52:09.593

如果只是不能使用 PHP，请尝试使用其他平台。

这里有几个：

*   Java Servlet - [Tomcat](http://tomcat.apache.org/)
    *   [JDBC 基础知识](http://docs.oracle.com/javase/tutorial/jdbc/basics/)
    *   [Java 数据库连接指南](https://stackoverflow.com/questions/241454/best-way-to-manage-database-connection-for-a-java-servlet)
*   红宝石 -[主网站](http://www.ruby-lang.org/en/)
    *   [Ruby 数据库适配器列表](https://www.ruby-toolbox.com/categories/SQL_Database_Adapters)
*   ASP -[主网站](http://www.asp.net/)（仅限微软服务器）
    *   [如何使用 ADO.NET](http://www.w3schools.com/aspnet/aspnet_dbconnection.asp)
*   ColdFusion -[主网站](http://www.adobe.com/products/coldfusion-family.html)
    *   [如何使用冷融合连接到数据库](http://helpx.adobe.com/coldfusion/kb/database-connections-handled-coldfusion.html)

显然还有很多其他的。但是您将需要在某个地方使用服务器端编程语言。如果您尝试直接连接到数据库，您的网站将非常不安全。