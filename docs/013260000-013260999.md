# StackOverflow 问答 13260000-13260999

# jquery - jQuery UpdatePanels 初始化

> ID：13260000
> 
> 赞同：5
> 
> 时间：2012-11-06T21:51:00.260
> 
> 标签：jquery, asp.net, updatepanel

我目前正在尝试将“colResizable”用于位于 AJAX UpdatePanel 内的 GridView。在第一次加载时，它运行良好，但只要 UpdatePanel 更新，它就会停止。

我知道这是由面板的完全刷新引起的，这意味着初始化添加的所有内容都不会被添加回来。

我已经尝试过“add_endRequest”解决方案

```
var prm = Sys.WebForms.PageRequestManager.getInstance(); 
prm.add_endRequest(function() { 
    $(".GridViewStyle").colResizable({ liveDrag: true }); 
} 
```

但是，它被调用得太早并且不能解决我的问题。

我已经阅读了“.live()”方法，但我不明白如何将它用于初始化。对于像“鼠标悬停”这样的事件，我知道它是如何使用的，而且非常简单……但是，对于 inits，我不明白。

我目前的初始化线是：

```
$(document).ready(function () {
    $(".GridViewStyle").colResizable({ liveDrag: true });
}); 
```

遵循“鼠标悬停”示例，但我无法确定要连接哪个事件，因为文档没有列出“加载”之类的内容。如果是这样，我会使用这样的东西......

```
$(".GridViewStyle").live("load", function () { $(".GridViewStyle").colResizable({ liveDrag: true }); }); 
```

我四处寻找，但没有找到适合我需要的东西。我对 jQuery 很陌生，所以我可能没有使用正确的词汇/概念。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T05:45:20.857

You can use `pageLoaded` event of the `PageRequestManager` instead of the `endRequest`. Look at this event documentation:

> Raised after all content on the page is refreshed as a result of either a synchronous or an asynchronous postback.

Also, in this event handler you may apply colResizable plugin only if UpdatePanel where GridView control located created or updated. This allows you to avoid redundant plugin initialization calls on each async postback that may be raised by control in some other UpdatePanel

```
Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(initializeResizeable);

function initializeResizeable(sender, args) {
    var context = $(args.get_panelsCreated()).add(args.get_panelsUpdated());
    $(".GridViewStyle", context).colResizable({ liveDrag: true }); 
} 
```

Also, with this script you can remove plugin initialization from document.ready handler as this script will be executed on first page load as well as on each async postback

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T04:05:50.167

.live() 已被弃用，因此请尝试使用 jQuery 的[.on()](http://api.jquery.com/on/)方法：

```
$(document).on("change", $('.GridViewStyle'), function() {
    $(this).colResizable({ liveDrag: true });
}); 
```

此外，您可能希望`postbackSafe: true`在初始化程序中设置以在回发期间保持列宽变化。

# css - 垂直对齐 div 和适当的滚动溢出，这可能吗？

> ID：13260004
> 
> 赞同：2
> 
> 时间：2012-11-06T21:51:18.223
> 
> 标签：css

我发现我可以拥有一个或另一个，但似乎无法同时弄清楚两者。

我的HTML如下：

```
<div id="middle">
    <div id="middleinner"></div>
</div> 
```

CSS 有点像这样（z-indexes 为页面上的其他内容设置，此处省略，因为它无关紧要，另外还有一些注释掉的东西，因为我试图弄清楚它）：

```
html, body{
        font-family: helvetica, sans-serif;
        font-size: 1em;
        height: 100%;
        overflow: hidden;
}

#middle{
/*      display: table;*/
        display: table;
        height: 80%;
        width: 90%;
/*      position: fixed;*/
        position: absolute;
        top: 10%;
        left: 5%;
        right: 95%;
        bottom: 90%;
        color: #000;
        z-index: 0;
}

#middleinner{
        padding: 0.5em 1em 0.5em 1em;
        background-color: #F9F9F9;
        display: table-cell;
/*      display: inline-block;*/
        border-radius: 1.5em;
        vertical-align: middle;
/*      margin-left: auto;
        margin-right: auto;*/
        text-align: center;
/*      position: relative;*/
        position: absolute;
        width: 100%;
        height: 100%;
        overflow: auto;
        z-index: 20;
} 
```

无论如何，如果我将 middleinner 的位置更改为相对而不是绝对，我就会以适当的溢出处理为代价进行垂直对齐。如果我将它设置为绝对值，我会以垂直对齐为代价进行适当的溢出处理。

有没有一种纯 CSS 的方式可以处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T21:59:45.730

是的`line-height`，`inline-block`, 和的组合`vertical-align`可以做到这一点。

```
#middle {
    width: 80%;
    margin: 10px auto;
    border: 1px dashed black;
    height: 500px;
    line-height: 500px;
    vertical-align: middle;
    text-align: center;
}
#inner {
    height: 50px;
    width: 80%;
    overflow: auto;
    display: inline-block;
    line-height: 1.1em;
} 
```

**[演示](http://dabblet.com/gist/4027868)**

要让它与动态高度元素一起使用，您必须使用一些 JavaScript，因为您使用的是 jQuery，我会使用它。也完全有可能使用 vanilla JS。

```
resize = function(el) {
    el.css({lineHeight: el.height() + "px"})
};
$(document).ready(function() {
    var $middle = $("#middle");
    resize($middle);
    $(window).on("resize", function() {
        resize($middle);
    })
}) 
```

# css - 在 DNN 皮肤中使用 CSS 格式化文本

> ID：13260005
> 
> 赞同：0
> 
> 时间：2012-11-06T21:51:18.730
> 
> 标签：css, dotnetnuke, skin

我在网页中有这个 html。

```
<span>Inovative International Industry<span/> 
```

我试图让它看起来像这样

```
 Innovative
 International 
 Industry 
```

但是通过使用`<span>Inovative <br/> International <br/> Industry<span/>`，我得到

```
 Innovative

 International 

 Industry 
```

有任何想法吗？我是 C#/Java 开发人员，HTML、CSS、设计等并不是我最擅长的资产。干杯瑞马丁斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T03:09:07.447

你可以试试 `<div>Innovative</div><div>International</div><div>Industry</div>`

或者在你的跨度上你可以试试

`<span style="line-height:normal">`

# asp.net-mvc-3 - 在控制台和 Web 应用程序之间共享 AppSettings 和 ConnectionStrings

> ID：13260006
> 
> 赞同：0
> 
> 时间：2012-11-06T21:51:21.157
> 
> 标签：asp.net-mvc-3, web-config, app-config, appsettings

我有一个多层 ASP.Net MVC 3 应用程序，其中不同的层需要共享一些设置，我想知道如何最好地实现这一点。

目前，我所有的 AppSettings 都在 Web.config 文件中，但我只是在我的解决方案中添加了一个新项目，以创建一个将在每晚调用的控制台应用程序购买 Windows 任务计划程序来执行日常维护任务。此控制台应用程序将使用与 Web 应用程序相同的数据库、存储库层、服务层等，并且两个应用程序应在大多数情况下共享相同的设置。我想避免在两个文件（app.config 和 web.config）中重复设置。

此外，我希望这些设置可用于服务层，该服务层位于同一解决方案的单独项目中。

我已阅读以下帖子，但我并不完全理解解决方案，并且我不确定这是执行此操作的最佳方法。

[在 Web App 和 Console App 之间共享 Config 设置](https://stackoverflow.com/questions/3553002/sharing-config-settings-between-web-app-and-console-app)

我还阅读了该帖子链接的文章，但我认为解决方案不是很优雅。

我正在使用 VS 2010 和 EF 4.3.1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:04:01.297

如果您只是对从控制台应用程序访问 web.config 文件的 AppSettings 感兴趣，那很简单。唯一真正令人烦恼的是，由于您的控制台应用程序不会在 Web 上下文中运行，因此您必须提前知道您的站点在 IIS 中的名称。这是您自己的应用程序不应该是一个挑战。

只需使用[System.Web.Configuration.WebConfigurationManager](http://msdn.microsoft.com/en-us/library/system.web.configuration.webconfigurationmanager.aspx "System.Web.Configuration.WebConfigurationManager")打开并访问指定站点的 web.config。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:04:26.490

这个想法是您可以将设置`.config`作为链接放入所有项目之间的公共共享中，而不是将其放入所有项目中。解决方案在 中概述[`this answer`](https://stackoverflow.com/a/693705/29407)。[`configSource property on MSDN`](http://msdn.microsoft.com/en-us/library/system.configuration.sectioninformation.configsource.aspx)如果您不知道将配置元素外部化到单独的文件中的可能性，还请检查。

# telerik-grid - Telerik MVC 网格页脚模板

> ID：13260011
> 
> 赞同：0
> 
> 时间：2012-11-06T21:51:42.433
> 
> 标签：telerik-grid

我有一个 Telerik 网格，并希望以这样的方式自定义页脚模板，使计数正好在总和之下，如下所示：

总计：$XXXXXXX 计数：XXXX

@model 列表

@(Html.Telerik().Grid(Model).Name("grd").NoRecordsTemplate("")

```
.Resizable(resizing => resizing.Columns(false))
.Scrollable(c => c.Enabled(true).Height(300))

.Footer(false)
.Columns(columns =>
{
columns.Bound(o => o.Number)
    .Aggregate(ag => ag.Count());

columns.Bound(o => o.TotalCost)
    .Aggregate(ag => ag.Sum())
    .ClientFooterTemplate(
        "<div>Total: <#= $.telerik.formatString('{0:c}', Sum) #></div>" 
    );
})
.DataBinding(db => db.Ajax().Select("getList", "Home"))
.Pageable()
.Scrollable()
.Footer(true)

.HtmlAttributes(new { @class = ".t-grid .t-status" }) 
```

)

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T16:11:19.460

您可以尝试以下方法。请注意它未经测试：

```
.Resizable(resizing => resizing.Columns(false))
.Scrollable(c => c.Enabled(true).Height(300))
.DataBinding(db => db.Ajax().Select("getList", "Home"))
.Pageable()
.Columns(columns =>
{
columns.Bound(o => o.Number)
    .Aggregate(ag => ag.Count())
    .FooterTemplate(result => (result.Count == null ? "0" : result.Count.Format("{0:N0}")));

columns.Bound(o => o.TotalCost)
    .Aggregate(ag => ag.Sum())  
    .FooterTemplate(result => (result.Sum == null ? "0.00" : result.Sum.Format("{0:N2}")));
}) 
```

如果您想在同一列下方的页脚中查看 Sum 和 Count：

```
.NoRecordsTemplate("No records available!")
.Resizable(resizing => resizing.Columns(false))
.Scrollable(c => c.Enabled(true).Height("auto"))
.DataBinding(db => db.Ajax().Select("getList", "Home"))
.Pageable()
.Columns(columns =>
{       
    columns.Bound(o => o.TotalCost)
        .HtmlAttributes(new { style = "text-align:right" })
        .Format("{0:N2}")
        .Aggregate(ag => ag.Sum().Count())
        .FooterHtmlAttributes(new { style = "text-align:right" })
        .FooterTemplate(result => string.Format("Total: ${0:N2}, Count: {1:N0}", result.Sum , result.Count))
        .Width(60);     
}) 
```

# javascript - phonegap `volumedownbutton` 事件未触发

> ID：13260018
> 
> 赞同：2
> 
> 时间：2012-11-06T21:52:01.217
> 
> 标签：javascript, iphone, cordova, dom-events

我正在尝试使用 phonegap API 文档中的这个[示例](http://docs.phonegap.com/en/1.8.1/cordova_events_events.md.html#volumedownbutton)来尝试检测音量增大和减小按钮按下事件。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <script type="text/javascript" charset="utf-8" src="cordova-1.8.1.js"></script>
    <script type="text/javascript" charset="utf-8">

    function onLoad() {
        document.addEventListener("deviceready", onDeviceReady, false);
    }

    function onDeviceReady() {
        document.addEventListener("volumedownbutton", onVolumeDownKeyDown, false);
        console.log("DeviceReady");
    }

    function onVolumeDownKeyDown() {
        console.log("onVolumeDownKeyDown");
    }

</script>
</head>
  <body onload="onLoad()">
  </body>
</html> 
```

当我使用 iPhone 运行它时，`DeviceReady`当我按下 iPhone 上的音量按钮时，我只看到第一个日志，但看不到第二个日志。

您知道这是我的手机问题还是我的 xCode 项目中缺少某些东西？（缺少插件或配置）。

我怀疑该应用程序`BiteSMS`修改了音量更改弹出行为（它添加了“按下以使用 BiteSMS”），但即使在我删除它之后仍然没有。

*   iPhone 4 / 越狱
*   iOS 5.0.1
*   电话间隙 1.8.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-22T06:24:48.693

我不知道，当您问这个问题时（2012 年 12 月 6 日），但目前（2013 年 7 月，PhoneGap 3.0.0），[PhoneGap API 文档](http://docs.phonegap.com/en/3.0.0/cordova_events_events.md.html#volumedownbutton)准确地说，该`volumedownbutton`事件（与`volumeupbutton`,`endcallbutton`和`startcallbutton`事件）**仅**在*BlackBerry WebWorks（OS 5.0 和更高版本）*上受支持。

所以，我*并不*感到惊讶，你没有让他们在 iOS / iPhone 上被解雇！:]

我没有机会在 iOS 上测试我的[PhoneGap Bootstrap 演示](https://github.com/trejder/pg-demo-bootstrap)应用程序（其中包括由 PhoneGap 触发的所有事件的示例处理程序），但我在我的 Android 设备上进行了测试（两台使用 Android 2.x，一台使用 Android 4.2）并且没有其中支持（触发）这四个事件。最后两个 -自然`endcallbutton`，`startcallbutton`因为大多数基于 Android 的设备没有开始/结束通话按钮。至于前两个 -`volumedownbutton`和`volumeupbutton`事件 - 这些也不支持。当您在 PhoneGap 应用程序中时，您可以更改音量，并且您会看到系统音量条发生变化，但 PhoneGap 应用程序根本没有反应。

# c# - 为什么我收到“不包含采用 0 个参数的构造函数”错误？C＃

> ID：13260021
> 
> 赞同：7
> 
> 时间：2012-11-06T21:52:14.460
> 
> 标签：c#, constructor, arguments

在我的表单加载中，我有这个代码：

```
 private void Form1_Load(object sender, EventArgs e)
    {
        CharityCyclists cyclist1 = new CharityCyclists();
        CharityCyclists cyclist2 = new CharityCyclists("a", 1, "Finished", 0, 0, 0, "One Wheel", 1, 500);

        cyclist1.Type = "Novelty Charity Cyclist";
        cyclist1.Number = 1;
        cyclist1.Finished = "Not Finished";
        cyclist1.Hours = 0;
        cyclist1.Mins = 0;
        cyclist1.Secs = 0;
        cyclist1.Bicycle = "Tricycle";
        cyclist1.Wheels = 3;
        cyclist1.FundsRaised = 300;
    } 
```

但是，我收到一条错误消息，提示“'CycleEvent.CharityCyclists' 不包含采用 0 个参数的构造函数”，它表示该错误与这部分代码有关：

```
CharityCyclists cyclist1 = new CharityCyclists(); 
```

这是我的 CharityCyclists 课程：

```
class CharityCyclists : Cyclists
{
    private string bicycle;
    private int wheels;
    private double fundsRaised;

    public string Bicycle
    {
        get { return bicycle; }
        set { bicycle = value; }
    }

    public int Wheels
    {
        get { return wheels; }
        set { wheels = value; }
    }

    public double FundsRaised
    {
        get { return fundsRaised; }
        set { fundsRaised = value; }
    }

    public CharityCyclists(String type, int number, String finished, int hours, int mins, int secs, string bicycle, int wheels, double fundsRaised) : base(type, number, finished, hours, mins, secs, fundsRaised)
    {
        this.bicycle = bicycle;
        this.wheels = wheels;
        this.FundsRaised = fundsRaised;
    }

    public override string ToString()
    {
        return base.ToString() + " riding a " + bicycle + " with " + wheels + " wheels" ;
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-06T21:54:13.663

那是因为`CharityCyclists`该类没有不带参数的构造函数。

*如果您没有定义其他构造函数*，C# 编译器将为您生成默认构造函数。如果您自己定义构造函数（如您所愿），C# 编译器将不会生成默认构造函数。

如果要允许`CharityCyclists`不带参数构造，请将此代码添加到类中：

```
public CharityCyclists() 
{} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T21:59:00.390

当你为你的类提供了一个带参数的构造函数时，编译器不再创建一个空的构造函数。

因此，您不能调用空构造函数，因为它不存在。您需要在类的代码中显式编写接受 0 个参数的构造函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T21:54:01.390

如果声明了构造函数，类不会自动获得默认构造函数。您将需要创建一个无参数构造函数来解决问题，或者调用接受参数的构造函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T21:54:06.847

您没有不带参数的构造函数。

你需要添加

```
public CharityCyclists()
{
    this.bicycle = "bike";
    this.wheels = 2;
    this.FundsRaised = 0;
} 
```

或类似的东西

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-06T21:55:00.147

创建不包含 0 个参数的构造函数时，会自动删除默认[构造函数](http://msdn.microsoft.com/en-us/library/ms173115%28VS.80%29.aspx)。您应该创建一个新的默认构造函数（不带参数），这将解决这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-06T21:55:25.903

如果您没有任何构造函数，C# 将为您隐式创建一个空的。它在功能上与您编写的内容相同：

```
public CharityCyclists()
{
} 
```

但是，只有在您*没有*构造函数时它才会这样做。你有一个，所以这不会发生。您需要显式创建一个不带参数的构造函数。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-06T22:02:18.947

你没有那个没有参数的类的构造函数。您拥有的唯一构造函数带有参数。将此添加到您的课程中：

```
public CharityCyclists() { } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-06T21:55:56.310

将此添加到`CharityCyclists`类中：

```
public CharityCyclists()
{
} 
```

您无法对以下行进行编码：

```
CharityCyclists cyclist1 = new CharityCyclists(); 
```

除非你有那个构造函数。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-11-06T21:56:24.843

在 .NET 中，如果没有声明其他构造函数，则隐式存在无参数（无参数）构造函数。一旦您声明了一个带参数的构造函数，您还必须显式声明另一个不带参数的构造函数，以便您的代码继续编译。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-11-06T21:57:25.897

您正在尝试将 cyclist1 实例化为不带任何参数的 CharityCyclists 类的实例 - 这需要不带参数的构造函数。

但是 CharityCyclists 类的定义只有一个带有 9 个参数的构造函数。由于该构造函数需要 9 个参数，因此 cyclist1 将不匹配该构造函数。您需要一个不带参数的构造函数，如下所示：

```
public CharityCyclists()
{
    this.bicycle ="";
    this.wheels = 0;       
    this.FundsRaised = 0.0;
} 
```

# android - 无法在 Android 上下载大文件

> ID：13260022
> 
> 赞同：0
> 
> 时间：2012-11-06T21:52:22.160
> 
> 标签：android, download, httpurlconnection

我正在开发一个下载大文件的应用程序。在过去的一年里它一直运行良好，但我只是发现了一个特定 url 上的奇怪行为。

这是我的代码：

```
while (bufferLength = inputStream.read(buffer) > -1) {
    fileOutput.write(buffer, 0, bufferLength);
    downloadedBytes += bufferLength;
} 
```

似乎对于那个特定的 URL inputStream.read(buffer) 在下载过程中返回-1。如果我重新开始下载，它会再次下载，但在不同的位置。也不例外。知道服务器端发生了什么吗？连接是否已重置？在那种情况下我不应该得到例外吗？

# java - Ttorrent 无法下载文件

> ID：13260024
> 
> 赞同：2
> 
> 时间：2012-11-06T21:52:37.480
> 
> 标签：java, bittorrent

我想在我的项目中使用 ttorent java lib。我试图弄清楚它是如何工作的。当我想将它用作独立程序并调用时

```
./client -o ~ ~/file.torrent -i eth3 
```

总是有 0%。当我尝试将它用作具有如下简单代码的库时：

```
import java.io.File;
import java.net.InetAddress;
import java.util.concurrent.TimeUnit;
import org.apache.log4j.BasicConfigurator;
import com.turn.ttorrent.client.Client;
import com.turn.ttorrent.client.Client.ClientState;
import com.turn.ttorrent.client.SharedTorrent;

public class Main {

/**
 * @param args
 */
public static void main(String[] args) {
    BasicConfigurator.configure();

    // Get options
    File output = new File("/home/user");

    // Get the .torrent file path
    File torrentPath = new File("/home/user/file.torrent");

    // Start downloading file
    try {
        SharedTorrent torrent = SharedTorrent.fromFile(torrentPath, output);
        System.out.println("Starting client for torrent: "
                + torrent.getName());

        Client client = new Client(InetAddress.getLocalHost(),
                torrent);

        try {
            System.out.println("Start to download: " + torrent.getName());
            client.download(); // DONE for completion signal

            while (!ClientState.SEEDING.equals(client.getState())) {
                // Check if there's an error
                if (ClientState.ERROR.equals(client.getState())) {
                    throw new Exception("ttorrent client Error State");
                }

                // Display statistics
                System.out
                        .printf("%f %% - %d bytes downloaded - %d bytes uploaded\n",
                                torrent.getCompletion(),
                                torrent.getDownloaded(),
                                torrent.getUploaded());

                // Wait one second
                TimeUnit.SECONDS.sleep(1);
            }

            System.out.println("download completed.");
        } catch (Exception e) {
            System.err.println("An error occurs...");
            e.printStackTrace(System.err);
        } finally {
            System.out.println("stop client.");
            client.stop();
        }
    } catch (Exception e) {
        System.err.println("An error occurs...");
        e.printStackTrace(System.err);
    }
} 
```

}

它也总是 0%。我尝试使用其他客户端下载这个 torrent 文件并且没问题，所以我认为这不乏种子。

# javascript - 导航网格寻路（在多边形中）

> ID：13260028
> 
> 赞同：2
> 
> 时间：2012-11-06T21:52:50.140
> 
> 标签：javascript, path-finding, polygons, navmesh

我正在用 JavaScript 开发一个点击式冒险游戏，我需要有关整个运动机制的帮助。

从我收集到的关于这个主题的信息来看，似乎有两个主要主题——导航网格和 A* 寻路算法。但是，在我的一生中，我找不到这些组合的 JS 实现。

我发现的所有 A* 实现都是基于网格的。

基本上，我正在寻找的是一种在大多边形内导航的方法。

我希望我有一定的意义，我不确定我自己是否完全理解它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:26:41.553

A* 确实适用于网格。真正的节点路径。

如果只有一个节点，那么 A* 并没有太大帮助，因为只有一个节点。

您要么必须将大多边形分解为较小的多边形，以进行正确的节点遍历，要么只是做一些简单的事情，例如移动角色直到他们的脚碰到您单击的位置（并保持多边形真正简单的正方形，没有任何东西顺便说一句）。

基本上，如果您想在对象周围进行路径查找，那么您将需要以某种方式将路径分解为节点。
无论是通过将您的区域细分为较小的正方形来完成，还是通过向目标投射光线并在碰撞期间在不同方向上创建新光线来完成（在您前进时递归地固定路径 - 我是否提到这是一个馊主意？）...

# string - 不带字符串的 grep

> ID：13260031
> 
> 赞同：29
> 
> 时间：2012-11-06T21:53:00.357
> 
> 标签：string, grep

我想在我的文本文件中找到包含字符串`"abc"`但不包含字符串的所有行`"def"`。我可以使用`grep`命令来完成这个任务吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-11-06T22:01:28.317

这些中的任何一个都可以：

```
grep -v "def" input_file | grep "abc" 
```

或者

```
grep "abc" input_file | grep -v "def" 
```

如果您只想查看标准输出上的输出，以下内容也将保留颜色：

```
grep --color=always "abc" input_file | grep -v "def" 
```

该`-v`选项（代表“反转匹配”）告诉`grep`忽略具有指定模式的行 - 在这种情况下`def`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-06T21:55:24.310

这可能会做到。

```
fgrep "abc" file | grep -v "def" 
```

# git - 如何镜像 github 存储库，同时维护我的小更改？

> ID：13260036
> 
> 赞同：2
> 
> 时间：2012-11-06T21:53:26.737
> 
> 标签：git, github

我必须创建一个 github 存储库的镜像，并对其进行一些小改动。

原版的所有者不会拉入我的更改，因此我必须保留它的镜像并维护原版的任何更新，同时保留我的非常小的更改。

最好的方法是什么？

这是一个手动过程，所以我在原始存储库上设置了电子邮件通知，然后每当有变化时，我该怎么做才能拉入更新并确保我的东西不会被覆盖？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:14:26.743

我以前没有尝试过，但是这种方法怎么样：

1.  假设你已经将一个 repo 分叉到你的 repo 中。有版本是Version1
2.  在此版本 1 上应用您的更改。假设对 2 个不同的文件进行了 2 次更改。我在 2 次提交中进行这些更改。（我们称它们为 Commit1 和 Commit2）
3.  然后我的更改和 Version1 合并到 master 分支上，产生 MyVersion1
4.  您正在镜像的存储库有一个新版本：Version2。您会收到通知。
5.  您将 Version2 镜像到临时分支。在这个分支上，您选择 Commit1 和 Commit2（我很难估计您在原始存储库的哪些文件上谈论了哪些小的更改，但这可能有效）。然后你从这个分支做一些集成测试
6.  在 master 中合并 staging 分支。

让我知道这是否适合您，然后我可以更详细地了解 git 命令。

# ios - 如何捕获每个数组条目的第一个字母

> ID：13260040
> 
> 赞同：3
> 
> 时间：2012-11-06T21:53:45.647
> 
> 标签：ios, nsarray

我有一个 NSString 值的排序数组，我想知道如何仅在第一个字母不同时捕获每个字符串的第一个字母并将其放入新的 NSArray 中。

例如，如果我有一个类似的数组

```
"a, aaa, aaaa, b, c, d, dd, ddd" 
```

在新的 NSArray 中会是这样

```
"a, b, c, d" 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-06T22:06:00.103

像这样的东西：

```
- (NSArray *)indexLettersForStrings:(NSArray *)strings {
    NSMutableArray *letters = [NSMutableArray array];
    NSString *currentLetter = nil;
    for (NSString *string in strings) {
        if (string.length > 0) {
            NSString *letter = [string substringToIndex:1];
            if (![letter isEqualToString:currentLetter]) {
                [letters addObject:letter];
                currentLetter = letter;
            }
        }
    }
    return [NSArray arrayWithArray:letters];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-01T21:39:39.093

NSString+字母索引.h

```
@interface NSString (LetterIndex)
@property (nonatomic, readonly) NSString * firstLetter;
@end 
```

NSString+字母索引.m

```
@implementation NSString (LetterIndex)

- (NSString *)firstLetter
{
    return self.length ? [self substringToIndex:1] : @"";
} 
```

你的方法：

```
- (NSArray *)indexLettersForStrings:(NSArray *)strings {
    NSSet * distinctValues = [NSSet setWithArray:[strings valueForKey:@"firstLetter"]];
    return [[distinctValues allObjects] sortedArrayUsingSelector:@selector(compare:)]
} 
```

另外，如果您有一些自定义类的对象并希望按某些字符串参数的首字母对它们进行分组，则可以使用以下方法：

```
NSSet * distinctValues = [NSSet setWithArray:[objects valueForKeyPath:@"myStringParam.firstLetter"]]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T22:13:00.227

```
NSArray *array = [NSArray arrayWithObjects:@"a", @"aaa", @"aaaa",@"b", @"c", @"d", @"dd", @"ddd", nil];
BOOL control = YES;
NSMutableArray *array2 = [NSMutableArray array];
for (int i = 0; i<array.count; i++) {
    for (int j = 0; j<array2.count;j++){
        if ([[array2 objectAtIndex:j]isEqualToString:[[array objectAtIndex:i]substringToIndex:1]]){
            control = NO;
        }
        else
            control = YES;
    }
    if (control)
        [array2 addObject:[[array objectAtIndex:i]substringToIndex:1]];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T22:14:19.807

试试这个：

```
NSArray *arr = @[@"a", @"aaa", @"aaaa", @"b", @"c", @"d", @"dd", @"ddd"];
NSMutableArray *newArr = [NSMutableArray array];
NSMutableSet *set = [NSMutableSet set];

for (NSString *str in arr)
{
    if (![set containsObject:[str substringToIndex:1]])
        [newArr addObject:[str substringToIndex:1]];
    [set addObject:[str substringToIndex:1]];

}

NSLog(@"%@", newArr); 
```

这使用 Set 来跟踪已经过去抛出的事件。当它不存在时，它将它们放入一个新数组中。

# postgresql - 如何将公共架构恢复到不同的架构

> ID：13260042
> 
> 赞同：4
> 
> 时间：2012-11-06T21:53:53.227
> 
> 标签：postgresql, heroku

我有一个转储，其中数据和结构位于公共模式中。我想将其还原为具有自定义名称的架构 - 我该怎么做？

编辑 V 2：

我的转储文件来自 heroku，一开始看起来像这样：

```
PGDMP
    !
pd6rq1i7f3kcath9.1.59.1.6<Y
0ENCODINENCODINGSET client_encoding = 'UTF8';
falseZ
00
STDSTRINGS
STDSTRINGS)SET standard_conforming_strings = 'off';
false[
126216385d6rq1i7f3kcatDATABASE?CREATE DATABASE d6rq1i7f3kcath WITH TEMPLATE = template0 ENCODING = 'UTF8' LC_COLLATE = 'en_US.UTF-8' LC_CTYPE = 'en_US.UTF-8';
DROP DATABASE d6rq1i7f3kcath;
uc0lt9t3fj0da4false26152200publicSCHEMACREATE SCHEMA public;
DROP SCHEMA public;
postgresfalse\
SCHEMA publicCOMMENT6COMMENT ON SCHEMA public IS 'standard public schema';
postgresfalse5?307916392plpgsql EXTENSION?CREATE EXTENSION IF NOT EXISTS plpgsql WITH SCHEMA pg_catalog;
DROP EXTENSION plpgsql;
false]
00EXTENSION plpgsqlCOMMENT@COMMENT ON EXTENSION plpgsql IS 'PL/pgSQL procedural language';
false212?125516397_final_mode(anyarrayFUNCTION?CREATE FUNCTION _final_mode(anyarray) RETURNS anyelement
    LANGUAGE sql IMMUTABLE
    AS $_$
      SELECT a
      FROM unnest($1) a
      GROUP BY 1
      ORDER BY COUNT(1) DESC, 1
      LIMIT 1;
    $_$;
,DROP FUNCTION public._final_mode(anyarray);
publicuc0lt9t3fj0da4false5?125516398mode(anyelement)    AGGREGATE?CREATE AGGREGATE mode(anyelement) (
    SFUNC = array_append,
    STYPE = anyarray,
    INITCOND = '{}',
    FINALFUNC = _final_mode
);
(DROP AGGREGATE public.mode(anyelement);
publicuc0lt9t3fj0da4false5224?125916399 advert_candidate_collector_failsTABLECREATE TABLE advert_candidate_collector_fails (
    id integer NOT NULL,
    advert_candidate_collector_status_id integer,
    exception_message text,
    stack_trace text,
    url text,
    created_at timestamp without time zone,
    updated_at timestamp without time zone
);
4DROP TABLE public.advert_candidate_collector_fails;
publicuc0lt9t3fj0da4false5?125916405'advert_candidate_collector_fails_id_seSEQUENCE?CREATE SEQUENCE advert_candidate_collector_fails_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;
>DROP SEQUENCE public.advert_candidate_collector_fails_id_seq;
publicuc0lt9t3fj0da4false1615^
00'advert_candidate_collector_fails_id_seqSEQUENCE OWNED BYeALTER SEQUENCE advert_candidate_collector_fails_id_seq OWNED BY advert_candidate_collector_fails.id;
publicuc0lt9t3fj0da4false162_
00'advert_candidate_collector_fails_id_seq
                                          SEQUENCE SETRSELECT pg_catalog.setval('advert_candidate_collector_fails_id_seq', 13641, true);
publicuc0lt9t3fj0da4false162?125916407#advert_candidate_collector_statusesTABLE?CREATE TABLE advert_candidate_collector_statuses (
    id integer NOT NULL,
    data_source_id character varying(120),
    state character varying(15) DEFAULT 'Queued'::character varying,
    source_name character varying(30),
    collector_type character varying(30),
    started_at timestamp without time zone,
    ended_at timestamp without time zone,
    times_failed integer DEFAULT 0,
    created_at timestamp without time zone,
    updated_at timestamp without time zone
);
7DROP TABLE public.advert_candidate_collector_statuses;
publicuc0lt9t3fj0da4false240424055?125916412*advert_candidate_collector_statuses_id_seSEQUENCE?CREATE SEQUENCE advert_candidate_collector_statuses_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;
ADROP SEQUENCE public.advert_candidate_collector_statuses_id_seq;
publicuc0lt9t3fj0da4false1635`
00*advert_candidate_collector_statuses_id_seqSEQUENCE OWNED BYkALTER SEQUENCE advert_candidate_collector_statuses_id_seq OWNED BY advert_candidate_collector_statuses.id;
publicuc0lt9t3fj0da4false164a
00*advert_candidate_collector_statuses_id_seq
                                             SEQUENCE SETVSELECT pg_catalog.setval('advert_candidate_collector_statuses_id_seq', 133212, true);
publicuc0lt9t3fj0da4false164?125916414advertsTABLE"CREATE TABLE adverts (
    id integer NOT NULL,
    car_id integer NOT NULL,
    source_name character varying(20),
    url text,
    first_extraction timestamp without time zone,
    last_observed_at timestamp without time zone,
    created_at timestamp without time zone,
    updated_at timestamp without time zone,
    source_id character varying(255),
    deactivated_at timestamp without time zone,
    seller_id integer NOT NULL,
    data_source_id character varying(100),
    price integer,
    availability_state character varying(15)
);

ROP TABLE public.adverts;
publicuc0lt9t3fj0da4false5?125916420adverts_id_seSEQUENCEpCREATE SEQUENCE adverts_id_seq
    START WITH 1
    INCREMENT BY 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:46:32.460

转储文件（使用 创建）的开头附近`pg_dump databasename`有一行：

```
SET search_path = public, pg_catalog; 
```

只需将其更改为：

```
SET search_path = your_schema_name, pg_catalog; 
```

您还需要搜索

```
ALTER TABLE public. 
```

并替换为：

```
ALTER TABLE your_schema_name. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T00:55:34.270

@Tometzky 的解决方案不太正确，至少在 9.2's 中是这样`pg_dump`。它将在新模式中创建表，但`pg_dump`模式限定`ALTER TABLE ... OWNER TO`语句，因此这些语句将失败：

```
postgres=# CREATE DATABASE demo;
\cCREATE DATABASE
postgres=# \c demo
You are now connected to database "demo" as user "postgres".
demo=# CREATE TABLE public.test ( dummy text );
CREATE TABLE
demo=# \d
        List of relations
 Schema | Name | Type  |  Owner   
--------+------+-------+----------
 public | test | table | postgres
(1 row)
demo=# \q
$
$ pg_dump -U postgres -f demo.sql demo
$ sed -i 's/^SET search_path = public, pg_catalog;$/SET search_path = testschema, pg_catalog;/' demo.sql
$ grep testschema demo.sql 
SET search_path = testschema, pg_catalog;
$ dropdb -U postgres demo
$ createdb -U postgres demo
$ psql -U postgres -c 'CREATE SCHEMA testschema;' demo
CREATE SCHEMA
$ psql -U postgres -f demo.sql -v ON_ERROR_STOP=1 -v QUIET=1 demo
psql:demo.sql:40: ERROR:  relation "public.test" does not exist
$ psql demo
demo=> \d testschema.test 
  Table "testschema.test"
 Column | Type | Modifiers 
--------+------+-----------
 dummy  | text | 
```

您还需要编辑转储以删除架构限定`public.test`或将其更改为新架构名称。`sed`是一个有用的工具。

我本可以发誓正确的方法是使用`pg_dump -Fc -n public -f dump.dbbackup`then`pg_restore`进入一个新的模式，但我现在似乎无法确切知道如何做到这一点。

更新：不，看起来`sed`是你最好的选择。请参阅[我想使用不同的架构恢复数据库](https://stackoverflow.com/q/4191653/398670)

# javascript - 如果两个数组与 jQuery 相同，则调用函数

> ID：13260044
> 
> 赞同：-3
> 
> 时间：2012-11-06T21:53:58.497
> 
> 标签：javascript, jquery

我有一个关于使用 jQuery 比较 2 个数组的快速问题。我有两个数组，只有当它们完全相同（相同的大小、元素、顺序）时，我才需要调用一个函数。

例如，给定这两个数组：

```
a['zero','one','two','three','four','five','six','seven', 'eight','nine'];
b['zero','one','two','three','four','five','six','seven', 'eight','nine']; 
```

如果这两个数组相同且顺序相同，请执行以下操作：

```
do  function{}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:04:12.460

如果您不想自己处理细节，underscore.js 中的[isEqual 方法可能会有所帮助。](http://underscorejs.org/#isEqual)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:00:41.883

一个小的类型强制避免了循环：

```
var myarray=["Joe", "Bob", "Ken"];
    var myarray2=["Joe", "Bob", "Ken"];
    var myarray3=["Joe", "Beb", "Ken"];
if(myarray == ""+myarray2){alert("something");}
if(myarray == ""+myarray3){alert("something else");}​ 
```

[http://jsfiddle.net/nY7Pk/](http://jsfiddle.net/nY7Pk/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T22:04:04.057

```
var a=['zero','one','two','three','four','five','six','seven', 'eight','nine'];
var b=['zero','one','two','four','three','five','six','seven', 'eight','nine'];
var difference = [];

jQuery.grep(a, function(element, index) {
    if(a[index]!=b[index])
       difference.push(element);
});

if(difference.length>0){
   alert("Do something");
} 
```

​</p>

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-06T21:58:24.837

这是一个使用纯 JavaScript 的示例 - 您可以将其与 jQuery 一起使用。

```
if (a.length === b.length) {
    var isMatch = true;
    for (var i = 0; i < a.length; i++) {
        if (a[i] !== b[i]) {
            isMatch = false;
            break;
        }
    }

    if (isMatch) {
        alert('It was all identical');
    }
} 
```

如果您想在比赛中允许杂耍，您可以更改`!==`为`!=`.

`!==`如果类型或值不匹配，将返回 false。

`!=`如果值不匹配，则在处理类型后将返回 false。

# mysql - MySQL：将多行值组合成单列？

> ID：13260046
> 
> 赞同：2
> 
> 时间：2012-11-06T21:54:05.273
> 
> 标签：mysql

**数据库：MySQL**

**表：团队**

```
TeamID    INT
TeamName  VARCHAR(20) 
```

**表：人**

```
PeopleID   INT
FirstNameID INT
LastNameID  INT 
```

**表：团队成员**

```
TeamID  INT
PeopleID  INT 
```

**表示例：团队**

```
TeamID       TeamName
1            Team Xstream
2            Team INsanity 
```

**表示例：人员**

```
PeopleID   FirstNameID   LastNameID
1          1351          453
2          5463          763
3          976           8762
4          87            784
5          187           465
6          761           566
7          376           2134 
```

**表示例：TeamMembers**

```
TeamID       PeopleID
1            1
1            3
1            7
2            2
2            4
2            5
2            6 
```

**期望的输出：**

```
TeamName       TeamMembers
Team Xstream   John Smith/Jane Doe/Daniel Davis
Team INsanity  Sally Sue/Tom Thomas/Jack Jones/Harry Henderson 
```

每个团队不会有固定数量的 TeamMembers，所以我不可能有三个子查询，因为只有三个团队成员。我在网上随便看看，但我总是在这里得到最好和最彻底的答案。任何想法或指示，请告诉我。老实说，我不知道从哪里开始。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T22:02:03.073

考虑到您只是将 ID 号显示为姓名，我猜这些人的姓名实际上存储在某个地方。但是你会想要同时使用`CONCAT()`和[`GROUP_CONCAT()`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)来获得这个结果。第一步，将连接所有表并使用`CONCAT()`函数：

```
select t.teamname,
 concat(p.FirstNameId, ' ', p.LastNameId) teamMembers
from teams t
left join teammembers m
  on t.teamid = m.teamid
left join people p
  on m.peopleid = p.peopleid; 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/37af9/8)，它将产生结果：

```
|      TEAMNAME | TEAMMEMBERS |
-------------------------------
|  Team Xstream |    1351 453 |
|  Team Xstream |    976 8762 |
|  Team Xstream |    376 2134 |
| Team INsanity |    5463 763 |
| Team INsanity |      87 784 |
| Team INsanity |     187 465 |
| Team INsanity |     761 566 | 
```

获得数据后，应用`GROUP_CONCAT()`函数和`GROUP BY`团队名称：

```
select t.teamname,
  group_concat(concat(p.FirstNameId, ' ', p.LastNameId) SEPARATOR '/') teamMembers
from teams t
left join teammembers m
  on t.teamid = m.teamid
left join people p
  on m.peopleid = p.peopleid
group by t.teamname; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/37af9/7)

结果：

```
|      TEAMNAME |                     TEAMMEMBERS |
---------------------------------------------------
| Team INsanity | 761 566/87 784/187 465/5463 763 |
|  Team Xstream |      976 8762/376 2134/1351 453 | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:09:34.040

您没有提供有关实际存储名称的表的信息，但您正在寻找的是`GROUP_CONCAT`功能。这就是您将如何使用它来显示名字和姓氏的方式。我将留给您加入名称表并将查询中的名称 id 字段替换为实际名称字段。

```
SELECT t.TeamName, GROUP_CONCAT(CONCAT(p.FirstNameID, ' ', p.LastNameID))
FROM Teams as t
INNER JOIN TeamMembers as tm on t.TeamID = tm.TeamID
INNER JOIN People as p on tm.PeopleID = p.PeopleID
GROUP BY t.TeamName 
```

顺便说一句，将名称规范化到他们自己的表中并使用 nameID 似乎可能是过度规范化的一个很好的例子。为什么不在 People 表中有名称值？这将节省您在查询中添加第四个表（如果名字和姓氏在不同的表中，可能还有第五个表）。

# c++ - 在objective-c中重命名目录中的多个文件

> ID：13260048
> 
> 赞同：0
> 
> 时间：2012-11-06T21:54:08.407
> 
> 标签：c++, objective-c, nsfilemanager, file-rename

我需要删除某个目录中 100 多个文件名称的前 4 个字符，我可以使用 obj-c 程序或 ac ++ 程序执行此操作吗？如果可以，如何操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:04:09.540

是的你可以。

该类`NSFileManager`提供了您需要的所有方法。

要获取目录的内容，请使用该`contentsOfDirectoryAtPath`方法。要重命名文件，您需要使用该`moveItemAtPath`方法。

看看类参考[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSFileManager_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSFileManager_Class/Reference/Reference.html)

步骤： 1\. 获取目录中文件的名称。2.迭代所有文件，使用moveItemAtPath重命名。

# c# - 如何确保您单击了列表中的椭圆对象？

> ID：13260056
> 
> 赞同：1
> 
> 时间：2012-11-06T21:54:25.000
> 
> 标签：c#, list, ellipse

我有一个带有参数（点开始、点结束、颜色 c）的椭圆对象列表。现在我想确保当我点击某个地方时，如果我确实击中了一个椭圆。

我也用已经工作的矩形来做这个，看起来像这样：

```
 case 3: // Rectanglefill
        return p.X >= Begin.X && p.X <= End.X && p.Y >= Begin.Y && p.Y <= End.Y; 
```

在这种方法中，我只想在点击时返回布尔 True，如果鼠标点击没有击中某些东西，则返回 False。

现在对于椭圆我已经有了这个：

```
case 4: // Ellipsfill
/*  int radiusx = Math.Abs(End.X - Begin.X) / 2;
    int radiusy = Math.Abs(End.Y - Begin.Y) / 2;
    int midpointx = (Begin.X + End.X) / 2;
    int midpointy = (Begin.Y + End.Y) / 2;

return ((Math.Pow((p.X -midpointx) / radiusx, 2) + Math.Pow((p.Y - midpointy) / radiusy, 2)) > 1); 
```

但这不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:13:26.560

你的方程是好的，你只需要放`<1`（或者`<=1`如果你想包括椭圆上的点）而不是`>1`

```
case 4: // Ellipsfill
    double radiusx = Math.Abs((double)End.X - (double)Begin.X) / 2.0;
    double radiusy = Math.Abs((double)End.Y - (double)Begin.Y) / 2.0;
    double midpointx = ((double)Begin.X + (double)End.X) / 2.0;
    double midpointy = ((double)Begin.Y + (double)End.Y) / 2.0;

return ((Math.Pow((p.X -midpointx) / radiusx, 2) + Math.Pow((p.Y - midpointy) / radiusy, 2)) < 1.0); 
```

# ios - uniqueIdentifier 与 indentifierForVendor 和 Apple 拒绝

> ID：13260057
> 
> 赞同：0
> 
> 时间：2012-11-06T21:54:26.733
> 
> 标签：ios, objective-c, ipad, ios6

我有一个关于`uniqueIdentifier`vs的问题`identifierforVendor`。我们将 UDID 用于登录识别目的，并且我们正在切换到新的 iOS 6 版本的 forVendor...

我的问题是 1) Apple 是否拒绝仍在使用 uniqueIdentifier 的应用程序？2) 他们怎么能拒绝这种看法，因为他们不允许第一代 ipad 升级到 6.0？

PS - 还发现`identifierforVendor`在 6.0 中并不总是有效，看起来它在 6.0.1 中已解决

这是我正在使用的代码......你认为它会被拒绝吗？

```
static inline NSString* UniqueDeviceId() {
    if ([[[UIDevice currentDevice] systemVersion] compare:@"6.0.1" options:NSNumericSearch] != NSOrderedAscending)
        return [[[UIDevice currentDevice] identifierForVendor] UUIDString];
    return [[UIDevice currentDevice] uniqueIdentifier];
} 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T22:04:03.503

虽然我不能代表 Apple 审查团队发言。只要您的应用支持没有替代方案的 iOS 版本，您就不太可能因为使用此已弃用的 API 而被拒绝。

我会更新您的代码以正确检查新方法：

```
if ([[UIDevice currentDevice] respondsToSelector:@selector(identifierForVendor)]) {
    return [[[UIDevice currentDevice] identifierForVendor] UUIDString];
} else {
    return [[UIDevice currentDevice] uniqueIdentifier];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-09T11:20:47.157

现在 App 不允许访问 UDID，并且不能使用 UIDevice 的 uniqueIdentifier 方法。请更新您的应用程序和服务器以将用户与 iOS 6 中引入的供应商或广告标识符相关联

```
NSUUID *uuid = [[UIDevice currentDevice] identifierForVendor];
NSString *uuidString = [uuid UUIDString]; 
```

并且必须添加 ADSupport 框架

# javascript - 从 JavaScript 数组中删除一串字母

> ID：13260060
> 
> 赞同：-1
> 
> 时间：2012-11-06T21:54:47.067
> 
> 标签：javascript

假设我将值 abcdef 存储在 JavaScript 中的变量 x 中，并且我必须删除 abc。因此输出应该是def。如何解决这个问题？请不要通过要删除的字符数进行删除，因为我感兴趣的是删除特定的字符串，它可以是 3 或 4 个字符。所以，我需要一个更通用的方法来解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:01:46.777

[`replace()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace)可用于从字符串中替换（或删除）静态子字符串（或模式）。

以你的例子：

```
x = x.replace('abc', ''); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T21:56:48.430

```
console.log(x.substr(3)); 
```

或者

```
console.log(x.replace('abc', '')); 
```

# python - Popen.communicate 转义了我发送到标准输入的字符串

> ID：13260061
> 
> 赞同：1
> 
> 时间：2012-11-06T21:54:55.070
> 
> 标签：python, subprocess

我正在尝试使用生成一个进程`Popen`并将其发送一个特定的字符串到它的`stdin`.

我有：

```
pipe = subprocess.Popen(cmd, shell=True, stdin=subprocess.PIPE)
pipe.communicate( my_stdin_str.encode(encoding='ascii') )
pipe.stdin.close() 
```

但是，第二行实际上逃脱了`my_stdin_str`. 例如，如果我有：

```
my_stdin_str="This is a string" 
```

该过程将看到：

```
This\ is\ a\ string 
```

我怎样才能防止这种行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T22:27:54.810

我无法在 Ubuntu 上重现它：

```
from subprocess import Popen, PIPE

shell_cmd = "perl -pE's/.\K/-/g'"
p = Popen(shell_cmd, shell=True, stdin=PIPE)
p.communicate("This $PATH is a string".encode('ascii')) 
```

在这种情况下`shell=True`是不必要的：

```
from subprocess import Popen, PIPE

cmd = ["perl", "-pE" , "s/.\K/-/g"]
p = Popen(cmd, stdin=PIPE)
p.communicate("This $PATH is a string".encode('ascii')) 
```

两者都产生相同的输出：

```
T-h-i-s- -$-P-A-T-H- -i-s- -a- -s-t-r-i-n-g- 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:20:59.220

除非您知道出于某种原因需要它，否则通常不要使用“shell=True”运行（未经测试，这听起来就像这里发生的事情）。

# backbone.js - Backbone.JS 设计模式按顺序获取集合

> ID：13260066
> 
> 赞同：1
> 
> 时间：2012-11-06T21:55:16.420
> 
> 标签：backbone.js

我有几个要在页面加载时获取的集合。每个集合都依赖于先前加载的集合，因此我需要按顺序获取它们。这似乎不是正确的方法：

```
groupCollection.fetch({
    success: function() {
        userCollection.fetch({
            success: function() {
                itemCollection.fetch();    
            }
        })
    }
}); 
```

是否有这种设计模式，或者我从一开始就采取了错误的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T23:05:31.487

有一个选项可以监听`reset`父集合上的事件，并加载嵌套集合。

```
groupCollection.on("reset", function() {
  userCollection.fetch();
});

userCollection.on("reset", function() {
  itemCollection.fetch(); 
});

groupCollection.fetch(); 
```

# javascript - 使用 JavaScript/AJAX/jQuery 逐行读取同一服务器上的文件？

> ID：13260070
> 
> 赞同：3
> 
> 时间：2012-11-06T21:55:27.247
> 
> 标签：javascript, jquery, ajax, web, webserver

我正在尝试使用动态（ish）无服务器站点（没有数据库、服务器端语言等），这就是我希望只使用 JavaScript/AJAX/jQuery 的原因。我希望能够提供带有静态文件的动态（ish）网页。

我想出的一种解决方案是本质上在与网页相同的服务器上使用文本文件（json、xml）作为数据存储。但我只能找到加载整个文件而不是特定部分的方法。这并不是什么大问题，因为文本文件很小，但是文本文件可能会变得很大。

如果您可以逐行加载文件，客户端的负载会更快，并且 JavaScript 解析会显着加快。

如果我只对新数据感兴趣，我希望在填充文件时可以将数据添加到文件顶部并逐行读取（因为我只对每页 10 行感兴趣）。访问文件中间也非常有用。

我只是想避免将整个文件发送给客户端（不是为了安全，而是为了空间/时间效率）。

有没有办法在 JavaScript 中做到这一点？还是我错过了一个明显的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:27:06.763

我以前没有这样做过，但是您应该有机会查看*Range*、*If-Range*和*Accept-Ranges* HTTP 标头。

我通过访问[http://www.stadt-salzburg.at/](http://www.stadt-salzburg.at/)的网络服务器做了一个简短的测试。它为起始页的静态 html 文件资源发送*Accept-Ranges:bytes响应标头，这意味着它接受 Range-requests。*使用 Firefox 扩展[Modify Headers](https://addons.mozilla.org/en-US/firefox/addon/modify-headers/)然后我指定了请求头*Range:bytes=257-2048*并且服务器实际上只返回了该文件的请求部分。

根据[HTTP 1.1 标头字段规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)，您还应该能够确定文件是否已被修改并做一些其他不错的事情 :-) 由于我对 HTTP 标头不是很有经验，所以我想请您看看如果你能达到你想要的结果，你自己。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:06:44.783

几年前我曾研究过同样的问题。JavaScript 本身不会削减它 - 有人请证明我错了。

1.  以正常方式实时将数据添加到本地文本文件（将新数据附加到末尾）。
2.  在本地机器上运行一个 cgi 应用程序，它可以一次执行一条记录的 OPEN、SEEK、READ、CLOSE。
3.  将新/下一个文件偏移量和记录文本返回到在 javascript 中运行的应用程序。
4.  javascript 会记住下一个记录偏移量 - 或者可以将其设置为零以从头开始重新处理整个文件。
5.  javascript 使用下一个记录偏移量调用 cgi。
6.  cgi 应用程序接收请求并执行其 OPEN、SEEK、READ、CLOSE。如果没有可用的新数据，则读取将加载零字节，并且 cgi 应用程序可以返回相同的偏移量和空白记录。

我希望你能看到上面的步骤可以按照你的 JavaScript 想要的速度重复，只要它想要。

# android - 安卓设备故障

> ID：13260071
> 
> 赞同：3
> 
> 时间：2012-11-06T21:55:49.743
> 
> 标签：android

我知道Google 提供[的仪表板提供了屏幕尺寸和 OpenGL 版本的细分。](http://developer.android.com/about/dashboards/index.html)有没有什么地方可以找到设备百分比的统计数据？例如：10% Galaxy S2、5% Nexus 等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T21:57:16.250

不，没有。对于 Play 商店中的应用，您可以找到使用您的应用的前 10 台设备的百分比。除此之外，没有安卓手机市场份额图表/数据。（无论如何，这并没有多大帮助；有超过 3,000 种 Android 设备。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-06T22:27:58.000

虽然 Google 不提供此信息，但有第三方来源为他们跟踪的设备提供这些统计数据（尽管它们并不全面，只是“所有顶级 ___ 设备”）。最值得注意的是，Flurry[发布了这张](http://blog.flurry.com/bid/85911/App-Developers-Signal-Apple-Allegiance-Ahead-of-WWDC-and-Google-I-O)（现在稍微过时的）图表：

![Flurry 排名前 20 位的 Android 设备的用户会话分布](../Images/ae8f03581565e74d251f80de7711162d.png)

虽然请注意，此图表是按会话而不是简单地按设备。

AppBrain 还[提供了一个图表以及一组更详细的统计数据](http://www.appbrain.com/stats/top-android-phones)：

![AppBrain 的顶级安卓手机](../Images/07999abd4b2eaabb3b863798109de26c.png)

在 Google Play 开发者控制台中，您还可以找到这些特定于您的应用的统计信息，如果您使用他们的 SDK 检测您的应用，包括 Flurry 在内的其他服务也可以为您提供这些数据。其中一些还通过 CSV 导出提供了更详细的设备列表。

# entity-framework - 模型中没有外键的 EF 代码第一个查找值

> ID：13260073
> 
> 赞同：0
> 
> 时间：2012-11-06T21:55:54.453
> 
> 标签：entity-framework

我正在使用一个有两个表的数据库。问题（包含具有 int 值的 SubStatusID 列。该列的几行具有 0 值）

SubStatus 表（包含 SubStatusID、SubStatusText，但没有 SubStatusID 值为 0 的行......所以我不能将此表中的 SubStatusID 用作我的实体框架模型中的外键关联）。

我也无法更改任何表中的数据。

当我使用 EF 5 提取问题记录时，如果问题的 SubStatusID 不为 0，我该如何检索 SubStatus 列的值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:09:10.240

Substatus 似乎是一个查找表。你想如何使用它？您不能只预先加载它并在您的应用程序中即时进行关联吗？我实际上会为问题实体上的 SubstatusId 列使用一个枚举，并且要么忽略另一个表（如果可能），要么在客户端上进行连接。如果子状态是只读的，您可以创建一个视图，您可以在其中添加缺少的行（使用联合）并且您可以进行关联......

# facebook - 一个人可以和另一个人玩多个游戏吗？

> ID：13260076
> 
> 赞同：1
> 
> 时间：2012-11-06T21:56:09.627
> 
> 标签：facebook

如果这是一个愚蠢的问题，我深表歉意，但我似乎无法找到直接的答案。我正在开发一款游戏，我想知道是否可以让两个人在我的应用程序中玩两个不同的游戏？例如，我可以和我的 5 个家庭成员朋友开始一个游戏，我也可以和我的 4 个同事开始一个游戏（其中一个也是我的 5 个家庭成员之一）。我可以和同一个人玩两场比赛吗？我知道的大多数应用程序（Words with Friends、Draw Something）似乎只允许你每人玩 1 个游戏，并且在当前游戏结束之前你无法与某人开始新游戏。

希望我提供了足够的信息来得到一个可靠的答案。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:00:22.337

大多数事情都是可能的。有些只是比其他更复杂。您必须保存两种游戏状态，而不仅仅是最近的游戏状态，然后为用户提供一个界面来选择要重新启动的游戏。

# javascript - 计算 kappa 的 JavaScript 测验

> ID：13260082
> 
> 赞同：0
> 
> 时间：2012-11-06T21:56:24.360
> 
> 标签：javascript

很明显，我需要学习 javascript。我正在尝试编写一个可以脱机工作的测试，所以我不能使用 PHP，而是使用 javascript。现在我有一个测试，它会给我正确答案数量的分数。我这样做的方法是将正确为 1 和不正确为 0 的值相加。所以，我可以得到正确答案的数量。但是，我真正想要的是计算 Kappa 分数。为此，我需要知道此表中每个组的计数：

```
 True
          Y      N
Tester  Y  11    01
        N  10    00 
```

这是我的测验：测试

```
 <script type="text/javascript"> 

        function getRBValue(group) { 
        //loop
          for ( var b = 0; b < group.length; ++b ) { 
            if ( group[b].checked ) 
            return Number(group[b].value); 
            } 
            return 0; } 

        function Score(form) { 
            var total = 0; 
            for ( var q = 1; q <= 10; ++q ) { 
            total += getRBValue( form["q"+q] ); 
            } 
        form.score.value = total; 
        alert("You got " + total + " questions right!"); 
        } 

    </script> 

    </head> 
    <body> 

    <h1>test</h1> 

    <p>The following exam will allow you to evaluate your ability to grade Trachoma.</p> 
    </body> 

    <form name="prequiz" onsubmit="Score(this); return false;"> 

    <table cellpadding=15px border="0" width="65%" summary= "Questions and options are organized in a table.">
    <tbody> 
    <tr> <td>
    <b><img src="pics/1.jpeg"</b><br/> 
    <br/><input type="radio" name="q1" value="0" > Present<br/> 
    <br/><input type="radio" name="q1" value="1" > Absent<br/> 
    </td> </tr> 

    <tr> 
    <td>
    <b><img src="pics/2.jpeg"</b><br/> 
    <br/> <input type="radio" name="q2" value="0" > Present<br/> 
    <br/> <input type="radio" name="q2" value="1" > Absent<br/> 
    </td> </tr> 

    <tr> 
    <td>
    <b><img src="pics/3.jpeg"</b><br/> 
    <br/> <input type="radio" name="q3" value="1" > Present<br/> 
    <br/> <input type="radio" name="q3" value="0" > Absent<br/> 
    </td> </tr> 

    <tr> 
    <td>
    <b><img src="pics/4.jpeg"</b><br/> 
    <br/> <input type="radio" name="q4" value="0" > Present<br/> 
    <br/> <input type="radio" name="q4" value="1" > Absent<br/> 
    </td> </tr> 

    <tr> 
    <td>
    <b><img src="pics/5.jpeg"</b><br/> 
    <br/> <input type="radio" name="q5" value="0" > Present<br/> 
    <br/> <input type="radio" name="q5" value="1" > Absent<br/> 
    </td> </tr> 

    <tr> 
    <td>
    <b><img src="pics/6.jpeg"</b><br/> 
    <br/> <input type="radio" name="q6" value="0" > Present<br/> 
    <br/> <input type="radio" name="q6" value="1" > Absent<br/> 
    </td> </tr> 

    <tr> 
    <td>
    <b><img src="pics/7.jpeg"</b><br/> 
    <br/> <input type="radio" name="q7" value="0" > Present<br/> 
    <br/> <input type="radio" name="q7" value="1" > Absent<br/> 
    </td> </tr> 

    <tr> 
    <td>
    <b><img src="pics/8.jpeg"</b><br/> 
    <br/> <input type="radio" name="q8" value="1" > Present<br/> 
    <br/> <input type="radio" name="q8" value="0" > Absent<br/> 
    </td> </tr> 

    <tr> 
    <td>
    <b><img src="pics/9.jpeg"</b><br/> 
    <br/> <input type="radio" name="q9" value="1" > Present<br/> 
    <br/> <input type="radio" name="q9" value="0" > Absent<br/> 
    </td> </tr>  

    <tr> 
    <td>
    <b><img src="pics/10.jpeg"</b><br/> 
    <br/> <input type="radio" name="q10" value="0" > Present<br/> 
    <br/> <input type="radio" name="q10" value="1" > Absent<br/> 
    </td> </tr> 

    </tbody> </table> </center> 

    <br><br>

    <input type="submit" name="submit" value="Score exam now"> 
    <br/><br/>

    <b>Your score:</b><input type="text" name="score" readonly="readonly" />
    <br/>
    </form> </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T14:09:18.023

在`getRBValue`中，您循环遍历组元素，其中总是有两个。第一个始终是 Present 选择，第二个始终是 Absent 选择。在您当前的代码中，您可以通过循环变量的值来区分它们`b`。但是，我会将您的代码重写为：

```
var PP, // correct is Present; user answered Present
    PA, // correct is Present; user answered Absent
    PN, // correct is Present; user did not answer
    AP, // correct is Absent; user answered Present
    AA, // correct is Absent; user answered Absent
    AN; // correct is Absent; user did not answer

function ScoreGroup(group) {
    var presentIsCorrect = Number(group[0].value);
    if (group[0].checked) {
        // user answered Present
        if (presentIsCorrect) {
            PP++;
        } else {
            AP++;
        }
    } else if (group[1].checked) {
        // user answered Absent
        if (presentIsCorrect) {
            PA++;
        } else {
            AA++;
        }
    } else {
        // user did not answer the question
        if (presentIsCorrect) {
            PN++;
        } else {
            AN++;
        }
    }
}

function Score(form) { 
    PP = PA = PN = AP = AA = AN = 0;
    for ( var q = 1; q <= 10; ++q ) { 
        ScoreGroup( form["q"+q] ); 
    }
    var totalCorrect = PP + AA;
    // TODO: compute kappa from PP, PA, PN, AP, AA, AN, and totalCorrect
    form.score.value = totalCorrect; 
    alert("You got " + totalCorrect + " questions right!");
} 
```

您可以在 2D 数组中累积原始计数，但在我看来，使用显式变量会使代码更具可读性（如果更冗长）。

# c# - 将 URL 从 Web 客户端路由回 Web 客户端

> ID：13260084
> 
> 赞同：0
> 
> 时间：2012-11-06T21:56:40.230
> 
> 标签：c#, asp.net, .net, asp.net-mvc, routing

我有一个 ASP.NET 控制器，它有一个函数，它只返回一个 WebClient 的 ContentResult。

在这种情况下，CNN 是我的测试平台，我的 WebClient，将 CNN 作为字符串下载到它的内容中，并将结果作为控制器上的 ActionResult/ContentResult 返回。

我在这个动作上调用了一个 RenderPartial，让 CNN 在它自己的框中显示我当前内容的“下方”和右侧。

我遇到的问题是，当您单击 CNN 上的链接时，它有时会重定向到“相对”网址，而该相对网址在我的本地主机中不存在，并且在我的网络服务器上也不存在，因此链接失败。

当它确实重定向到绝对 url 时，这也是一个问题，因为生成的页面“替换”了我的 .NET shell。

我需要它做的是获取我返回的 ContentResult 中的任何 URL，如果单击了这些 URL 中的任何一个，则将它们传递回我的 .NET 应用程序，由 WebClient 下载，并在该 shell 中呈现.

我知道我可以使用 IFRAME 而不是 WebClient 来执行此操作，但在我的情况下 IFRAME 是不可能的，因为它受到我们正在使用的公共 API 的限制，它在 API 所服务的框架中受到限制/存在缺陷，并且它在我们无法控制的一些客户端机器上被阻止。

此外，客户端机器将脱离我们的网络，所以我不能使用 AJAX 加载，因为那将是 XSS。

我能想到的一个想法基本上是使用过滤器/规则创建自定义路由，以查找类似“CNN”的链接，并将它们作为参数传递给我的控制器；然后让我的控制器呈现我的页面，并将这些链接传递给 Web 客户端。

这显然需要做很多工作，甚至不确定在路由引擎中从哪里开始。

我能想到的唯一另一件事可能是通过尝试查看它是否指向有效链接来检查 URL 的有效性。如果它没有指向一个有效的链接，则添加 CNN 的 url 前缀，然后查看它是否是一个有效的链接。但这似乎需要做很多工作，对于一个会对性能造成严重影响的解决方案，因为检查像 CNN 这样的页面上的每个链接可能会非常昂贵。此外，由于我将运行每个链接两次，这将是一个需要 POST 操作的问题，因为它基本上会运行每个操作两次，并且这是一个公共 API，我正在使用公共框架，我无法控制源代码来防止这种情况发生。

还有其他建议吗？有什么方法可以轻松完成我想做的事情吗？

# c++ - 地图和比较类的 C++ 问题

> ID：13260094
> 
> 赞同：0
> 
> 时间：2012-11-06T21:57:16.063
> 
> 标签：c++, pointers, map

我希望也许有人可以帮助我解决我的问题。我得到一个可爱的

> 没有匹配函数调用类型为“const pCompare”的对象

```
struct pCompare
 {
    bool operator()( const std::string & str1, const std::string & str2 ) const
    {
        return str1.compare( str2 ) == 0;
    }
 };
 std::string *t = new std::string ( "/test.html" );
 std::map<std::string*, std::string, pCompare> test;
 test.insert ( std::pair<std::string*, std::string> ( t, "héhé" ) );
 std::cout << test.find(new std::string ("/test.html") )->second; 
```

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T22:07:57.273

首先，不要这样做，因为它会搞砸您的地图：您需要地图的排序函数，而不是相等性测试。

无论如何，我猜你的问题是你的键类型 std::string* 但是你的函数测试 string& 。我还没有尝试过，但这应该可以解决问题：

```
bool operator()( std::string * str1, const std::string * str2 ) const
{
    return *str1 < *str2;
} 
```

# java - 访问两个数据库时客户端的事务中止

> ID：13260104
> 
> 赞同：1
> 
> 时间：2012-11-06T21:57:52.507
> 
> 标签：java, glassfish-3, ejb-3.1

我有一个propertiesbean，它给了我SqlSessions。这个 bean 注释了所有这些爵士乐@班级级别

```
@Singleton
@LocalBean
@Startup
@TransactionAttribute(TransactionAttributeType.NOT_SUPPORTED) 
```

我也有这个

```
public SqlSessionFactory getSqlSessionFactory(ConnTypes connType) {...} 
```

它返回你想要的 SqlSession。

我有两个数据库。一个是 mysql 实例，另一个不是（我们称之为 db2）。

当我在本地运行项目时，一切都很好。两个数据库都可以毫无问题地访问。

当我在我们的测试服务器上运行项目时，它开始抛出客户端事务中止错误。我对此进行了大量研究，当数据库查询或某些数据库访问出现问题时，似乎人们会遇到这些异常。然后将整个事务标记为回滚并抛出此异常（至少这是我读过的）

在我看来，它在第一次引发客户端的事务中止错误之前就引发了 XA-Resource 错误。我知道当您的 bean 尝试访问另一个会话时，您可以获得这些。在本地运行并尝试以一种方法保持与两个数据库的连接之前，我已经看到过这个错误。

会不会是我的访问两个数据库的单例属性 bean 进入了一个奇怪的事务状态，试图在一个线程中返回一个 mysql 会话并在另一个线程中返回一个 db2 会话？

# javascript - 通过 Ajax/XML 更改 2 个 Divs 内容

> ID：13260107
> 
> 赞同：0
> 
> 时间：2012-11-06T21:58:13.283
> 
> 标签：javascript, .net, ajax, html

我正在为网站制作员工目录页面。该页面将有大约 2 打员工的缩略图，单击时，拇指下方的 2 个 div 将更改为显示更大的照片，以及员工的简历。我被告知要考虑为此使用 AJAX，因为我不希望页面从一名员工刷新/更改为另一名员工。该站点是使用 C# 在 .net 中构建的，到目前为止，我们还没有在该站点上使用 JQuery 或 Mootools，因此我们愿意使用其中任何一个。

所以这是我的 XML 的一个片段：

```
<?xml version="1.0" encoding="utf-8"?>
<employees>
    <employee_01>
        <name>Employee J. Name</name>
        <title>Big Cheese</title>
        <email>email@email.com</email>
        <phone>(555) 333-4444</phone>
        <bio><p>This is paragraph one of the bio. This could be several sentences long.</p>

<p>This is paragraph 2 for this bio. It may or may not be as long as the first one.</p></bio>
        <photo_url>employee_photo01.jpg</photo_url>
    </employee_01>
    <employee_02>
        <name></name>
        <title></title>
        <email></email>
        <phone></phone>
        <bio></bio>
        <photo_url></photo_url>
    </employee_02>
</employees> 
```

这是需要用xml数据替换的Div结构。

```
 <div id="employee_bio_container">
    <div id="employee_photo"><img src="images/employee_photo01.jpg" alt="Employee Name" /></div>
    <div id="employee_bio">
        <h1>Name</h1>
        <h5>title</h5>
        <h5><a href="mailto:email">email</a><br />
        phone goes here</h5>
        <hr />
<p>This is the bio that will be replaced</p>
    </div>
    </div> 
```

因此，我需要更改“employee_photo”div 中图像的 src 及其 alt 文本，并在“employee_bio”div 中显示名称、标题、电子邮件地址、电话和简历，同时更改mailto 链接的 URL。

我以前从未接触过 AJAX，而且我很难理解迄今为止找到的教程。有什么提示或方向可以指点我吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:04:37.730

很简单，按照[http://api.jquery.com/jQuery.ajax/中的例子](http://api.jquery.com/jQuery.ajax/)

```
$.ajax({
  url: 'ajax/test.html',
  success: function(data) {
    $('.result').html(data);
    alert('Load was performed.');
  }
}); 
```

1.  在您的 ajax 成功后，处理数据对象。您的数据对象应包含员工信息和图像 src
2.  在 javascript 中操作您的 html，将 img.src 设置为 url，然后构建您的 employee_bio 元素的内容

# c++ - 矩阵堆栈、glLoadMatrix 和 glMultMatrix 与场景图和相机一起使用？

> ID：13260109
> 
> 赞同：0
> 
> 时间：2012-11-06T21:58:21.207
> 
> 标签：c++, opengl, matrix

所以我有一个包含所有对象的场景图，并且我必须对所有内容使用我自己的矩阵类（要求，所以不是可选的，学校）。我已经编写了所有数学课，但我不确定如何在代码中准确地实现 Matrix Stack。

我对它的工作原理有理论上的理解。基本上我的场景是单位矩阵，然后我必须使用我使用我的 Matrix 4 类创建的相机矩阵，然后我必须循环遍历场景图和 glMultMatrix 每个级别及其父级。

我认为这是在正确的轨道上，但我以前从未编写过代码，只是研究了它背后的理论。

我在正确的轨道上吗？

它应该看起来这个。

Identity Matrix -> Camera Matrix -> For Each Object Reset back to Identity Matrix -> Camera Matrix -> Generate Matrix from Translate and Quaternion's Multiply that with Identity Matrix -> Camera Matrix。对于每个孩子，从翻译和四元数乘以父母的矩阵生成矩阵

所以基本上我没有 glMatrixMode，只是因为我的场景图而存在的矩阵堆栈。

我希望这是在正确的轨道上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:32:07.677

> 场景是单位矩阵

不，单位矩阵只是一个矩阵，乘以不会改变任何东西。

> 我必须遍历场景图和 glMultMatrix 每个级别及其父级。

并不真地。做你自己的矩阵数学的想法是不依赖 OpenGL 为你做任何事情。这包括矩阵乘法。如果你真的使用 OpenGL 固定函数矩阵，你会使用 glLoadMatrix。但最好采用现代方式：使用着色器并将矩阵作为制服提供。

作为对转换管道如何工作的回顾，我建议您参考[https://stackoverflow.com/a/13223392/524368](https://stackoverflow.com/a/13223392/524368)

> 我希望这是在正确的轨道上。

差不多，你想的有点太复杂了。进行自己的矩阵数学运算的好处是，您可以完全自由地实现事物。

Personally I'm a fan of in-place math operation. Using this paradigm, for each step in the matrix hierachy you'd take a copy of the lower level, and do your modifications on that one. Such a tree is nicely traversed. And for every drawing operation you just load the matrix at the branch/leaf in the transform hierachy tree, you're currently traversing. And after drawing each thing, there's no need for a reset, you just load the next thing, and maybe free the memory of intermediary results.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:31:33.950

好吧，你在正确的轨道上，但大多数情况下它的处理方式有点不同。

我们假设栈顶是有源矩阵。所以一开始我们有一个堆栈，上面有单位矩阵。您应该熟悉 push 和 pop 调用。这些基本上执行以下操作：

```
push(Matrix m)
{
    newMatrix = stack.top() * m; //Or the other way round. This depends on the matrix definition and the function of the * operator
    put newMatrix on stack;
}
pop()
{
    remove first element from stack;
} 
```

您已经观察到首先需要一个投影和视图矩阵。所以：

```
push(cameraMatrix); 
```

然后你可以迭代场景图。我假设您有一个简单的递归迭代，它为每个孩子调用以下方法：

```
iterate_node(node)
{
    generate matrix from translate and quaternions
    push(matrix);
    for each (children of this node)
        iterate_node(child)
    next
    pop();
} 
```

因此，如果您输入一个节点，则该节点的矩阵将添加到堆栈中，如果您离开它，则该矩阵将被删除。这样，您可以拥有任意深度和复杂性的图表。你已经注意到每个矩阵都会影响孩子的变换。

# node.js - 节点：服务器和客户端上的 Mustache 模板

> ID：13260111
> 
> 赞同：0
> 
> 时间：2012-11-06T21:58:27.410
> 
> 标签：node.js, mustache

我想在 node.js/express/hogan 中使用 mustache 模板。
但我也想在客户端上使用带有 ember.js 的 mustache 模板

这个问题一般是怎么解决的？我应该在服务器/客户端上使用不同的模板引擎吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T19:01:53.067

我更改了 Hogan 中的分隔符： app.locals.delimiters = '[[ ]]';

这工作正常。

# linux - 如何将共享库列入黑名单以避免加载程序获取它？

> ID：13260114
> 
> 赞同：4
> 
> 时间：2012-11-06T21:58:33.183
> 
> 标签：linux, shared-libraries, ld

我试图强制用于构建源的构建内部预处理器不依赖安装在我的主机中的共享库，而不必卸载它们。

尽管有一个`LD_PRELOAD`环境变量强制加载程序（ld-linux）在其他任何事情之前获取指定的共享库，但我想做完全相反的事情，强制加载程序在设置过程中**不**获取指定的库（种类`LD_NEVERLOAD`变量）。

有没有办法在不破坏我的整个系统的情况下这样做（也就是删除这样的库）？

PS：我已经重命名了我的系统库来测试这个特定的用例，但这绝对不是一种优雅的方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:14:40.613

阅读手册页`ld(1)`，`ld.so(8)`您可能会尝试使用`LD_LIBRARY_PATH`,`LD_RUNPATH`和两个手册中与“rpath”相关的选项。

# android - 如何使用原始联系人 ID 获取（联系人）组 ID？

> ID：13260119
> 
> 赞同：0
> 
> 时间：2012-11-06T21:58:57.637
> 
> 标签：android

我有以下代码：

```
 //get group ID's
    // note: a contact can belong to multiple groups
    final String where = ContactsContract.Data.RAW_CONTACT_ID + "=" + contactID
    + " AND "
    + ContactsContract.Data.MIMETYPE + "='" + ContactsContract.CommonDataKinds.GroupMembership.CONTENT_ITEM_TYPE + "'";

    final String[] projectionGroups = new String[] { ContactsContract.Data.DATA1 };//DATA1 is GroupID

    Cursor curGroup = getContentResolver().query(
            ContactsContract.Data.CONTENT_URI,
            projectionGroups,
            where,
            null,
            null);

    if (curGroup != null)
    {
        Log.i(TAG, "group count "+curGroup.getCount());
    } 
```

但是，它始终返回计数 0。

查询有问题吗？我在运行 Android 2.3.5 的手机上使用它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:15:57.620

我没有看到任何明显错误的地方。但是，我不相信 contactID 包含可以在 DATA 表中找到的值。此外，您确定您的联系人启用了群组吗？

# c - 如何防止符号重新定义

> ID：13260122
> 
> 赞同：0
> 
> 时间：2012-11-06T21:59:20.687
> 
> 标签：c, eclipse, typedef, redefinition, codewarrior

我的项目包含一个堆栈，它有许多用户定义的类型 ( `typedef`)。问题是这些类型定义中的许多与我们内部的类型定义相冲突。也就是说，正在使用相同的符号名称。有什么办法可以防止这种情况吗？

问题的根源在于，要在我们的应用程序中使用堆栈或包装代码，视情况而定，必须包含某个头文件。该堆栈头文件又包含堆栈提供程序的类型定义文件。那就是问题所在。他们应该通过非公共包含路径包含他们的类型定义文件，但他们没有。`BYTE`现在，对于非常常见的名称，例如、`WORD`、等，存在各种用户定义的类型冲突`DWORD`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:26:11.267

由于您可能无法轻松更改正在使用的程序堆栈，因此您必须从自己的代码开始。

首先要做的是（显然）尽可能限制全局命名空间中的名称数量。不要使用全局变量，仅使用静态变量，例如。

下一步是为您的代码模块采用命名约定。假设您在项目中有一个“输入模块”。例如，您可以在输入模块“inp”中为所有函数添加前缀。

```
void inp_init (void); 
void inp_get  (int input);

#define INP_SOMECONSTANT 4

typedef enum
{
  INP_THIS,
  INP_THAT,
} inp_something_t; 
```

等等。每当这些项目在代码中的其他地方使用时，它们不仅有一个唯一的标识符，读者也很清楚它们属于哪个模块，因此它们有什么用途。因此，在修复命名空间冲突的同时，您可以获得可读性。

像上面这样的事情可能是实现正式编码标准的第一步，作为一名专业程序员，你迟早需要做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:33:10.780

我建议您定义一个包装头，根据您自己的类型重新定义堆栈导出的所有函数和结构。然后此标头包含在您的系统文件中，但不包含在堆栈文件中（它会发生冲突）。然后您可以编译和链接，但界面有一个弱点。如果您在重新定义中正确选择了类型，它应该可以正常工作，**只会**在堆栈供应商的每次更新中留下维护问题......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T23:32:43.370

我认为我暂时提出了一个合理的解决方法，但正如 Lundin 所说，长期解决方案需要一个正式的编码标准。

Basically what I did was to move the inclusion of the required stack header file to before the inclusion of our in-house type definitions file. Then, between those two includes I added a compiler macro to set a defined constant dependent on whether the stack's header file single-include protection definition has been defined. Then, I used that conditional defined constant as a conditional compile option in our in-house type definition file to prevent the conflicting data-types from being re-defined. It's a little sloppy, but progress can only be made in incremental steps.

# ruby - 在 Ubuntu 12.04 上安装 Ruby 1.9.3-p286 时 rbenv 挂起

> ID：13260123
> 
> 赞同：0
> 
> 时间：2012-11-06T21:59:25.683
> 
> 标签：ruby, capistrano, ubuntu-12.04, rbenv

我在带有 Capistrano 的（空白）Ubuntu 12.04 机器上安装 Ruby 1.9.3-p286 时遇到问题。

**会发生什么：**

```
 * executing "rbenv install 1.9.3-p286"
   servers: ["178.48.132.196"]
   [178.48.132.196] executing command
** [out :: 178.48.132.196] Downloading http://pyyaml.org/download/libyaml/yaml-0.1.4.tar.gz...
** [out :: 178.48.132.196] Installing yaml-0.1.4...
** [out :: 178.48.132.196] Installed yaml-0.1.4 to /home/cphrb/.rbenv/versions/1.9.3-p286
** [out :: 178.48.132.196] Downloading http://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.3-p286.tar.gz...
** [out :: 176.58.102.156] Installing ruby-1.9.3-p286... 
```

（在这里它永远挂起。）

**更神秘的是：** 这在办公时间 (GMT+1) 工作得非常好，但在晚上运行时会失败。连续三个晚上一直如此。当我用 来查看正在运行的进程时`top`，似乎安装完成了，因为与安装相关的所有进程都消失了。我很好奇一天中的时间如何影响安装，因为一旦安装在盒子上运行，它不应该依赖于任何可能因维护而关闭的外部服务。我也尝试在盒子上手动运行安装，但结果相同。

有任何想法吗？？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-22T12:21:11.617

我在 Capistrano 脚本中尝试使用 rbenv 安装 ruby​​ 2.0.0-rc2 时遇到了类似的问题。

* * *

我将以下内容添加到 Ubuntu 服务器的 /etc/ssh/sshd_config 到：

> ClientAliveInterval 20
> 
> ClientAliveCountMax 20

重新配置后，SSH 服务器需要重新启动。

* * *

我将以下内容添加到本地计算机（也是 ubuntu）的 /etc/ssh/ssh_config 到：

> ServerAliveInterval 30
> 
> ServerAliveCountMax 20

任何打开的 SSH 连接都需要关闭并重新打开才能使用此配置。

* * *

这些值阻止了我的 ssh 会话超时，并且我的 Capistrano 配方完成了通过 rbenv 安装 ruby​​。添加到服务器端和客户端可能是矫枉过正。我没有完全测试只输入了一侧的配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T10:00:00.503

我认为问题已解决：安装挂起是因为 SSH 连接在飞行途中死机。:-(

如果有人知道为什么 SSH 不会因错误而终止，我会很高兴知道。如果有任何开关可以缓解这个问题。

# c# - tableadapter 的 SUM 子列

> ID：13260129
> 
> 赞同：0
> 
> 时间：2012-11-06T21:59:52.953
> 
> 标签：c#, ado.net, tableadapter

我有一个`SettlementCurrentTableAdapter`有关系的 tableadapter ( )。父表是 ( `SettlementCurrent`) 子表是 ( `Trips`)。

我需要对 ( ) 中的每一行 ( `tripLoadedMiles`)求和`Trips`并在标签 ( ) 中显示总数`labelWelcomeSetTotalMiles`。

我想在代码中而不是 sql 中执行此操作，因为我使用此 tableadapter 来显示其他标签。

有人可以帮我解决这个问题。我是 C# 新手，我使用 Visual C#。

```
 this.settlementCurrentTableAdapter.Fill(this.myLeaseDataSet.SettlementCurrent);
        MyLeaseDataSet.SettlementCurrentRow settlementCurrent;
        settlementCurrent = myLeaseDataSet.SettlementCurrent.Last();

        var settlementCurrentID = settlementCurrent.setID;

        this.tripsTableAdapter.FillByTripSetID(this.myLeaseDataSet.Trips, settlementCurrentID);
        MyLeaseDataSet.TripsDataTable settlementTrips;
        settlementTrips = myLeaseDataSet.Trips;
        foreach (DataRow row in myLeaseDataSet.Trips.Rows) 
        {

            NOT SURE ON THE CODE HERE

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:04:46.810

第一步是从数据适配器中提取所需的数据。由于我在你的问题中没有表格模型，所以最好看一下 MSDN 上的[表格适配器概述](http://msdn.microsoft.com/en-us/library/bz9tthwx%28v=vs.110%29.aspx)，并点击相关链接和文章了解此对象的基本用法。如果你要发布你的表结构，理论上我可以给你一些代码，但我不愿意这样做 - 你将不得不使用这个对象，这就是你与数据库交谈的方式，所以您必须了解它的功能。

您在本次学习中的目标是弄清楚如何从您的表格适配器中获取所有里程数据。为此，您通常一次遍历一行，然后挑选出您想要将它们添加到更符合 C# 惯用数据结构的值，例如 aa `List`/`IEnumerable`或 an `Array`。

在这些结构之一中获得所需的数据后，您可以使用 LINQ 获得所有内容的总和。根据您拉出的数量，它可以像一个电话一样简单（如果这类似于 an `Array`of `ints`）：

```
var totalMiles = tripLoadedMiles.Sum(); 
```

或者根据您的需要进行详细说明（如果这是`List`一个自定义对象，它同时具有`SettlementCurrentId`和`Miles`，都存储为`int`s）：

```
var totalMiles = tripLoadedMiles.Select(x => x.SettlementCurrentId == someRandomRequiredSettlement).Sum(y => y.Miles); 
```

在您使用事物的方式中，这就是您在这种情况下看待总计的方式。

```
 var total = 0;
    foreach (DataRow row in myLeaseDataSet.Trips.Rows) 
    {

        total += int.Parse(row["tripTotalMiles"].ToString());
    }
    // Use the total 
```

# c# - 如何使用 LINQ 解析 XML 标头和嵌套部分

> ID：13260131
> 
> 赞同：3
> 
> 时间：2012-11-06T21:59:59.663
> 
> 标签：c#, .net, xml, linq

```
XElement documentRoot = XElement.Parse(@"<OrdersReport Date='2012-08-01'>
                <SettingHeader>
                  <SettingId>1</SettingId>
                </SettingHeader>
                  <Client>
                    <ClientId>1</ClientId>
                    <Orders>
                      <Order>
                        <OrderNumber>1</OrderNumber>
                        <ShipAddress>123 Main St.</ShipAddress>
                        <ShipCity>MyCity</ShipCity>
                        <ShipState>AZ</ShipState>
                      </Order>
                      <Order>
                        <OrderNumber>2</OrderNumber>
                        <ShipAddress>111 Main St.</ShipAddress>
                        <ShipCity>OtherCity</ShipCity>
                        <ShipState>AL</ShipState>
                      </Order>
                      <OrderCancelled>
                        <OrderNumber>3</OrderNumber>
                        <ShipAddress>222 Main St.</ShipAddress>
                        <ShipCity>CancelledCity</ShipCity>
                        <ShipState>AL</ShipState>
                      </OrderCancelled>
                    </Orders>
                    <Returns>
                      <Amount>
                        <OrderId>2</OrderId>
                        <OrderId>3</OrderId>
                        <OrderId>21</OrderId>       
                      </Amount>
                    </Returns>
                  </Client>
                  <Client>
                    <ClientId>2</ClientId>    
                  </Client>
                </OrdersReport>"); 
```

代码：

```
 var orders = documentRoot.Descendants("Order")
                       .Concat(documentRoot.Descendants("OrderCancelled"))
                       .Select(x => new
                       {
                           OrderNumber = (int)x.Element("OrderNumber"),
                           ShipAddress = (string)x.Element("ShipAddress"),
                           ShipCity = (string)x.Element("ShipCity"),
                           ShipState = (string)x.Element("ShipState")
                       });

        foreach (var o in orders)
        {
            Console.WriteLine(o.OrderNumber + " " + o.ShipAddress + " " 
                + o.ShipCity);
        } 
```

输出：

```
1 123 Main St. MyCity
2 111 Main St. OtherCity
3 222 Main St. CancelledCity
3 222 Main St. CancelledCity 
```

如何像下面的输出一样附加*ClientId*和*SettingId ？*

目标输出：

```
1 123 Main St. MyCity ClientId 1 SettingId 1
2 111 Main St. OtherCity ClientId 1 SettingId 1
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:14:50.050

试试这个：

```
var orders = doc.Descendants("Order").Select(x => new
    {
        OrderNumber = (int)x.Element("OrderNumber"),
        ShipAddress = (string)x.Element("ShipAddress"),
        ShipCity = (string)x.Element("ShipCity"),
        ShipState = (string)x.Element("ShipState"),
        ClientId = (int)x.Ancestors("Client").First().Element("ClientId"),
        SettingId = (int)doc.Descendants("SettingId").First(),
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T15:41:00.557

```
//pick the "settingId" first, it won't change in the XML
string settingId = 
    documentRoot.Descendants("SettingId").Single().Value;

var orders =
    //each client has its own clientId and Orders
    from c in documentRoot.Descendants("Client")
    let clientId = c.Element("ClientId").Value
    //search for the "Orders" tag and pick all their children 
    //this will include both "Order" and "OrderCancelled"
    from o in c.Descendants("Orders").Elements()
    select new
    {
        OrderNumber = (int)o.Element("OrderNumber"),
        ShipAddress = (string)o.Element("ShipAddress"),
        ShipCity = (string)o.Element("ShipCity"),
        ShipState = (string)o.Element("ShipState"),
        ClientId = clientId,
        SettingId = settingId
    }; 
```

# windows-xp - 在 VirtualBox 上安装 Windows XP

> ID：13260134
> 
> 赞同：1
> 
> 时间：2012-11-06T22:00:20.403
> 
> 标签：windows-xp, virtual-machine

我在我的机器上安装了 VirtualBox。我有 Windows XP IMG 文件。我使用 VirtualBox 命令行将 IMG 文件转换为 VDI 文件。

如何使用 IMG 或 VDI 文件设置新的虚拟机。我按照说明进行操作，但收到以下错误： **致命：找不到可启动媒体！系统暂停。**

以下是我遵循的说明： [http ://www.linuxjournal.com/content/using-windows-xp-virtualbox-linux](http://www.linuxjournal.com/content/using-windows-xp-virtualbox-linux)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T20:56:28.010

当您创建 VDI 时，您拥有的 XP 安装盘的 IMG 文件将作为 CD 盘安装。

看看这个（最终）安装图片：（ [来源：][[linuxjournal.com](https://www.linuxjournal.com/ufiles/vbox10.jpg)][）][![显示安装选项的图片](../Images/936d6f95dcaa7887168cd86e28b64f08.png)](https://i.stack.imgur.com/qvR6H.jpg)

# css - Twitter-bootstrap 固定布局

> ID：13260136
> 
> 赞同：0
> 
> 时间：2012-11-06T22:00:26.393
> 
> 标签：css, twitter-bootstrap

我正在尝试制作具有固定侧栏和内容的 twitter-bootstrap 布局。

但是，当浏览器窗口的宽度减小时，内容会在侧边栏下方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:50:27.497

响应式布局负责大多数因窗口大小调整而导致的配置变化。[它在文档提供的示例](http://twitter.github.com/bootstrap/getting-started.html#examples)中默认激活。

**您可以通过不**包括[文档](http://twitter.github.com/bootstrap/scaffolding.html#responsive)`bootstrap-responsive.css`中所见来禁用布局的响应性。

注意：流体网格与响应性无关。两者都可以独立使用。

# migration - 从 iOS Facebook 2.x -> 3.x 迁移时如何避免注销用户

> ID：13260141
> 
> 赞同：4
> 
> 时间：2012-11-06T22:00:47.540
> 
> 标签：migration, facebook-authentication, facebook-ios-sdk

将我们的 Facebook iOS 集成从 2.x SDK 升级到 3.x SDK 会自动注销之前登录的用户，因为我们过去必须手动处理的身份验证凭据现在由新的后台处理开发工具包。

有没有办法强制 3.x SDK 使用我们之前手动存储的访问令牌和到期日期进行身份验证，作为一次性身份验证迁移？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T21:48:09.203

终于想通了。该解决方案涉及使用他们提供的[FBSessionTokenCachingStrategy](http://developers.facebook.com/docs/reference/ios/3.0/class/FBSessionTokenCachingStrategy/)对象，特别是[FBSessionManualTokenCachingStrategy](https://github.com/facebook/facebook-ios-sdk/blob/master/src/FBSessionManualTokenCachingStrategy.h)：

```
if (isUserUpgrading) {
   FBSessionTokenCachingStrategy *strategy = [[[FBSessionManualTokenCachingStrategy alloc] initWithUserDefaultTokenInformationKeyName:nil] autorelease];
   strategy.accessToken = [[NSUserDefaults standardUserDefaults] stringForKey:@"FBSessionToken"];         // use your own UserDefaults key
   strategy.expirationDate = [[NSUserDefaults standardUserDefaults] objectForKey:@"FBSessionExpiration"]; // use your own UserDefaults key
   FBSession *session = [[[FBSession alloc] initWithAppID:@"MY_APP_ID"                                    // use your own appId
                                              permissions:nil
                                          urlSchemeSuffix:nil
                                       tokenCacheStrategy:strategy] autorelease];
   [FBSession setActiveSession:session];
} else {
   [FBSession openActiveSessionWithReadPermissions:...];  // normal authentication
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:52:50.853

对于 Facebook sdk 3.1.1，我必须创建一个新类 FBSessionManualTokenCachingStrategy 它是 FBSessionTokenCachingStrategy 的子类，并将 fetchTokenInformation 方法定义为

> ```
>  - (NSDictionary*)fetchTokenInformation; {
>      return [NSDictionary dictionaryWithObjectsAndKeys:
>         self.accessToken, FBTokenInformationTokenKey,
>         self.expirationDate, FBTokenInformationExpirationDateKey,
>         nil];
>    } 
> ```

# java - 如何通过带有 MouseListener 的 JGlassPane 点击到它后面的 UI

> ID：13260145
> 
> 赞同：3
> 
> 时间：2012-11-06T22:01:11.333
> 
> 标签：java, swing, glasspane, mouse-listeners

我有一个`JFrame`和一堆`JComponents`在上面`JFrame`。我需要使用`JGlassPane`并且我使用这个实现来设置它。

```
 JPanel glass = new JPanel();
   frame.setGlassPane(glass);
   glass.setVisible(true);
   glass.setOpaque(false); 
```

`JButtons`这样做后，我无法`JComponents`在`JGlassPane`.

有没有一种方法可以只选择组件上的组件，`GlassPane`同时仍然能够选择组件下的组件`GlassPane`？

**编辑**我忘了提到（不知道这是否相关）我确实将 a`MouseListener`和 a都附加`MouseMotionListener`到了玻璃窗格上。有没有办法将鼠标事件传递给其他组件并仅在需要时使用它们？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-07T10:20:21.480

让你的 mouseListener 调度它不想处理的事件。

[*下面的示例代码是混合使用的，使用了@whiskeyspider的*](http://docs.oracle.com/javase/tutorial/uiswing/components/rootpane.html)漂亮 SSCCE 和[教程](http://docs.oracle.com/javase/tutorial/uiswing/components/rootpane.html)（顺便说一句：查看教程是解决问题的良好开端:-)

```
ml = new MouseListener() {
    @Override
    public void mousePressed(MouseEvent e) {
        dispatchEvent(e);
    }
    // same for all methods
    // ....

    private void dispatchEvent(MouseEvent e) {
        if (isBlocked)
            return;
        Point glassPanePoint = e.getPoint();
        Container container = frame.getContentPane();
        Point containerPoint = SwingUtilities.convertPoint(glass,
                glassPanePoint, container);

        if (containerPoint.y < 0) { // we're not in the content pane
            // Could have special code to handle mouse events over
            // the menu bar or non-system window decorations, such as
            // the ones provided by the Java look and feel.
        } else {
            // The mouse event is probably over the content pane.
            // Find out exactly which component it's over.
            Component component = SwingUtilities.getDeepestComponentAt(
                    container, containerPoint.x, containerPoint.y);

            if (component != null) {
                // Forward events to component below
                Point componentPoint = SwingUtilities.convertPoint(
                        glass, glassPanePoint, component);
                component.dispatchEvent(new MouseEvent(component, e
                        .getID(), e.getWhen(), e.getModifiers(),
                        componentPoint.x, componentPoint.y, e
                                .getClickCount(), e.isPopupTrigger()));
            }
        }
    }
};

glass.addMouseListener(ml);
glassButton.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent ae) {
        if (isBlocked) {
            // glass.removeMouseListener(ml);
            glassButton.setText("Block");
        } else {
            // ml = new MouseAdapter() { };
            // glass.addMouseListener(ml);
            glassButton.setText("Unblock");
        }

        isBlocked = !isBlocked;
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T22:42:56.803

这是玻璃窗格中的 JButton 示例，单击该按钮将切换捕获鼠标事件（无法单击测试按钮）。

```
public class Test
{
    private static boolean isBlocked = false;
    private static MouseListener ml;

    public static void main(String[] args)
    {
        JButton button = new JButton("Test");
        button.setPreferredSize(new Dimension(100, 100));

        final JButton glassButton = new JButton("Block");

        JPanel panel = new JPanel();
        panel.add(button);

        final JPanel glass = new JPanel();
        glass.setOpaque(false);
        glass.add(glassButton);

        final JFrame frame = new JFrame();
        frame.setGlassPane(glass);
        glass.setVisible(true);
        frame.setContentPane(panel);
        frame.pack();
        frame.setVisible(true);

        glassButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent ae) {
                if (isBlocked) {
                    glass.removeMouseListener(ml);
                    glassButton.setText("Block");
                } else {
                    ml = new MouseAdapter() { };
                    glass.addMouseListener(ml);
                    glassButton.setText("Unblock");
                }

                isBlocked = !isBlocked;
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-04T20:51:18.550

另一种不中断 Swing 事件链的解决方案是使用 a`AWTEventListener`代替。我已经实现了 a[`BetterGlassPane`](https://github.com/kristian/better-glass-pane)来代替常规的`JPanel`玻璃窗格，如下所示：

```
JFrame frame = ...; // any JRootPane will do...
BetterGlassPane glass = new BetterGlassPane(frame); 
```

这也适用于“传统”方式，如您的问题所示：

```
JPanel glass = new BetterGlassPane();
frame.setGlassPane(glass);    
glass.setRootPane(frame); 
```

希望这可以帮助。随意在 GitHub 上克隆项目或使用 Maven 依赖项：

```
<dependency>
  <groupId>lc.kra.swing</groupId>
  <artifactId>better-glass-pane</artifactId>
  <version>0.1.3</version>
</dependency>
<repositories>
  <repository>
    <id>better-glass-pane-mvn-repo</id>
    <url>https://raw.github.com/kristian/better-glass-pane/mvn-repo/</url>
    <snapshots>
      <enabled>true</enabled>
      <updatePolicy>always</updatePolicy>
    </snapshots>
  </repository>
</repositories> 
```

简短、自包含、正确、示例（SSCCE，没有强制性的 Maven 依赖）：

```
import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics;
import java.awt.Rectangle;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JOptionPane;

import lc.kra.swing.BetterGlassPane;

public class TestBetterGlassPane {
    public static void main(String[] args) {
        final JFrame frame = new JFrame("BetterGlassPane Test");
        frame.setLayout(null);
        frame.setSize(400,300);
        frame.setResizable(false);
        frame.setLocationByPlatform(true);
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        BetterGlassPane glassPane = new BetterGlassPane(frame.getRootPane()) {
            private static final long serialVersionUID = 1L;
            @Override protected void paintComponent(Graphics graphics) {
                super.paintComponent(graphics);
                graphics.setColor(Color.BLACK);
                graphics.drawRect(20,160,360,50);
                graphics.setFont(graphics.getFont().deriveFont(Font.BOLD));
                graphics.drawString("I'm the glass pane, click me!",120,190);
            }
        };
        glassPane.addMouseListener(new MouseAdapter() {
            public void mouseClicked(MouseEvent event) {
                if(new Rectangle(20,180,360,50).contains(event.getPoint()))
                    JOptionPane.showMessageDialog(frame,"I'm the glass pane!");
            }
        });
        glassPane.setLayout(null);

        ActionListener defaultActionListener = new ActionListener() {
            public void actionPerformed(ActionEvent event) {
                JOptionPane.showMessageDialog(frame,
                    ((JButton)event.getSource()).getText());
            }
        };

        JButton frameButton = new JButton("I'm on the frame!");
        frameButton.addActionListener(defaultActionListener);
        frameButton.setBounds(20,20,360,50);
        frame.add(frameButton);

        JButton glassPaneButton = new JButton("I'm on the glass pane!");
        glassPaneButton.addActionListener(defaultActionListener);
        glassPaneButton.setBounds(20,90,360,50);
        glassPane.add(glassPaneButton);

        frame.setVisible(true);
    }
} 
```

# google-apps-script - 使用 Google 脚本嵌入视频

> ID：13260147
> 
> 赞同：2
> 
> 时间：2012-11-06T22:01:14.247
> 
> 标签：google-apps-script

我正在尝试使用 Google Scripting 将我存储在 Google Drive 上的视频嵌入到 HTML 中。这是我用来生成 HTML 的代码：

```
function GenerateTables() {
    var folderz = DocsList.getFolder('SharedVideos');
    var contents = folderz.getFiles().sort(function(a,b) {return b.getDateCreated()-a.getDateCreated()});
    var file;
    var name;
    var date;
    var url;
    var dateModified;
    var folder;

    var textOutput = "<table>";
    textOutput += "<tr><th>File Name</th><th>Create Date</th><th>Modified Date</th></tr>"
    for (var i = 0; i < contents.length; i++) { 
        file = contents[i];
        folder = file.getParents()[0];
        name = file.getName();
        url = "https://docs.google.com/file/d/" +file.getId()+"/preview";

        date = Utilities.formatDate(file.getDateCreated(), 'GMT-6', 'MM/dd/yyyy hh:mm:ss aaa');
        dateModified = Utilities.formatDate(file.getLastUpdated(), 'GMT-6', 'MM/dd/yyyy hh:mm:ss aaa');
        textOutput += "<tr><td>" +name + "</td><td>" + date + "</td><td>" + dateModified + "</td></tr>";
        textOutput += "<tr><td colspan='3'>";
        textOutput += "<iframe src='"+url+"' height='385' width='640'></iframe>";
        textOutput += "</td></tr>";
  }
  textOutput +="</table>";
  return textOutput;
}

function doGet() {
    var text = GenerateTables();
    return HtmlService.createHtmlOutput(text);
} 
```

iframe 正在转换为

```
<iframe data-caja-src='[the correct URL]' height="385" width="640"></iframe> 
```

我希望这将是一个简单的过程，但我越深入研究它，它似乎就越复杂。有没有更简单的方法来做我想做的事情？我没有太多使用 Caja 的经验，但也许有一种使用 Caja 嵌入视频的简单方法，我就是无法工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:43:23.990

目前还没有办法在 HtmlService 中嵌入视频。我认为问题跟踪器上有一个功能请求，但不管它是我们所知道的。

# c# - 在标准 C# .NET 项目中使用带有字符串操作的 Script# 代码

> ID：13260153
> 
> 赞同：3
> 
> 时间：2012-11-06T22:02:07.530
> 
> 标签：c#, .net, string, script#

我在我的标准控制台应用程序中添加了 Script# 的引用。之后，我试图从那里调用一些方法，但收到以下错误：

![缺少方法异常](../Images/896214bf322f2824d6f96b24ef1b7542.png)

我想它发生在以下行：

```
string[] lines = s.Split(';'); 
```

我的假设是通常的**mscorlib**库没有方法`public string[] Split(char separator)`，但有`public string[] Split(params char[] separator)`

是否可以为 Script# 项目和标准 C# .NET 项目编写具有此类字符串操作的有效代码？由于这个问题，我必须为两个项目编写重复的代码，但差异很小。

**PS**我尝试使用组装绑定重定向，如[this SO](https://stackoverflow.com/q/8104853/1046374) question中所述，但这对我没有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T22:08:43.967

**编辑：** 对我来说唯一的解决方案似乎是扩展方法。`Split`您可以在类似于标准 .NET 的 Script# 的 String 类型之上定义扩展方法`String.Split`，即接受`params char[]`. 只有这样你才能使用相同的代码。

```
string[] lines = s.Split(new char[] { ';' }); 
```

或者，在标准 String 类型之上定义扩展，以防 Script# 对扩展有严格要求。但我认为应该不是问题，因为扩展方法只是一个静态方法。

**旧答案：**在意识到 Script# 不接受`params char[]`后，以下答案变得不正确：

您`s.Split`通过传递`char`给它来调用它。但是，此方法接受`params char[]`. 尽管 C# 编译器允许您传递`char`到`Split`，但它稍后会将其编译为传递`char[]`. 因此，如果您想让相同的代码同时适用于 Script# 和 C#，请将代码更改为以下方式：

```
string[] lines = s.Split(new char[] { ';' }); 
```

这适用于 Script# 和 C#。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T20:09:39.373

我找到了解决方案！

我的操作顺序：

1.  在任何 Script# 类中创建`Split`字符串拆分方法。

2.  在 .NET 项目中定义条件编译符号**DOTNET 。**

3.  **使用来自 Script# 的方法将 As Link**文件添加`Split`到 .NET 项目，并将其他必要的依赖文件添加为链接。

```
public static string[] Split(string str, string separator)
{
    string[] result;
#if DOTNET
    result = str.Split(new string[] { separator }, System.StringSplitOptions.None);
#else
    result = str.Split(separator);
#endif
    return result;
} 
```

之后，将根据仅在 .NET 项目中定义的 DOTNET 符号选择适当的代码。其他类似的方法，不仅是字符串，也可以用同样的方式重写。

# android - 如何在菜单项上进行点击事件？

> ID：13260157
> 
> 赞同：1
> 
> 时间：2012-11-06T22:02:21.620
> 
> 标签：android, android-layout, menuitem

我在 TextBox 中输入所有数据，当我按下提交按钮时它正在工作，但我在 Menuitem 按钮上做同样的事情然后它不起作用。我的代码是：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Log.i(TAG,"Information - onCreate() ...");
    setContentView(R.layout.activity_main);

    View promptButton = findViewById(R.id.submit_button);
    promptButton.setOnClickListener((OnClickListener) this);

}
public void onClick(View v) {
    RadioGroup radioGroup = (RadioGroup) findViewById(R.id.greetingsRadioGroup);
    int checkedRadioButton = radioGroup.getCheckedRadioButtonId();

    switch (checkedRadioButton) {
    case R.id.mrButton : 
      choice = "Mr.";
      break;
  case R.id.mrsButton : 
      choice = "Mrs.";
      break;
  case R.id.msButton: 
      choice = "Ms.";
      break;
  case R.id.drButton: 
      choice = "Dr.";
      break;
    }

         EditText namef = (EditText) findViewById(R.id.firstname); 
         EditText namel = (EditText) findViewById(R.id.lastname);  
         EditText add1 = (EditText) findViewById(R.id.address); 
         Spinner pro1 = (Spinner) findViewById(R.id.spinner1);  
         EditText coun1 = (EditText) findViewById(R.id.country);  
         EditText pcode1 = (EditText) findViewById(R.id.postalCode); 

            switch(v.getId()){
                case R.id.submit_button:
                    Intent j = new Intent(this, Animation.class);
                    fname = namef.getText().toString();
                    lname = namel.getText().toString();
                    add = add1.getText().toString();
                    pro = pro1.getSelectedItem().toString();
                    coun = coun1.getText().toString();
                    pcode = pcode1.getText().toString();
                    j.putExtra("choice", choice);
                    j.putExtra("fname", fname);
                    j.putExtra("lname", lname);
                    j.putExtra("add", add);
                    j.putExtra("pro", pro);
                    j.putExtra("coun", coun);
                    j.putExtra("pcode", pcode);
                    startActivity(j);
                    break;  
                case R.id.menu_anim:
                    Intent k = new Intent(this, Animation.class);
                    fname = namef.getText().toString();
                    lname = namel.getText().toString();
                    add = add1.getText().toString();
                    pro = pro1.getSelectedItem().toString();
                    coun = coun1.getText().toString();
                    pcode = pcode1.getText().toString();
                    k.putExtra("choice", choice);
                    k.putExtra("fname", fname);
                    k.putExtra("lname", lname);
                    k.putExtra("add", add);
                    k.putExtra("pro", pro);
                    k.putExtra("coun", coun);
                    k.putExtra("pcode", pcode);
                    startActivity(k);
                    break;

         }

    }
}

protected void onActivityResult(int requestCode, int resultCode, Intent d1) {
    // TODO Auto-generated method stub
    super.onActivityResult(requestCode, resultCode, d1);

    if(requestCode == START)
    {
        Toast.makeText(this, "Your download has resumed.", Toast.LENGTH_LONG).show();
    }
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {

   super.onCreateOptionsMenu(menu);

    this.myMenu = menu;

    MenuInflater mi = this.getMenuInflater();
    mi.inflate(R.menu.my_menu,menu);

    return true;
} 
```

我不知道我可以在这写什么`switch Case R.id.menu_anim`......

我可以打电话`onClick(View v)`吗？如果是，我该如何称呼它？

```
private boolean handleMenus(MenuItem item)
{
    switch (item.getItemId()) {
    case R.id.menu_anim:

        break;
    }

return true;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T05:55:04.213

下面是如何创建 OptionMenu 并在菜单项上具有 ClickAction 的示例：

```
// for Menu
private static final int SETTING_ID = Menu.FIRST;
private static final int EXISTING_GAMES_ID = Menu.FIRST + 1;
private static final int GAME_SELECTION_ID = Menu.FIRST + 2;

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    super.onCreateOptionsMenu(menu);

    menu.add(0, SETTING_ID, 0, "settings");
    menu.add(0, EXISTING_GAMES_ID, 0, "existing games");
    menu.add(0, GAME_SELECTION_ID, 0, "new game");
    /****   Is this the mechanism to extend with filter effects?
    Intent intent = new Intent(null, getIntent().getData());
    intent.addCategory(Intent.CATEGORY_ALTERNATIVE);
    menu.addIntentOptions(
                          Menu.ALTERNATIVE, 0,
                          new ComponentName(this, NotesList.class),
                          null, intent, 0, null);
    *****/
    return true;
}

@Override
public boolean onPrepareOptionsMenu(Menu menu) {
    super.onPrepareOptionsMenu(menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
   /* mPaint.setXfermode(null);
    mPaint.setAlpha(0xFF);*/

    switch (item.getItemId()) {
        case SETTING_ID:
            //Do Some Task

            return true;
        case EXISTING_GAMES_ID:
            //Do Some Task
            return true;
        case GAME_SELECTION_ID:
            //Do Some Task
            return true;

    }
    return super.onOptionsItemSelected(item);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:15:37.123

```
static final int MY_ITEM = 0x0;

@Override
public boolean onCreateOptionsMenu(Menu menu) {

    super.onCreateOptionsMenu(menu);

    menu.add(0, MY_ITEM, 0, "My Item");
    return true;
}

@Override
public boolean onOptionsItemSelected (MenuItem item)
{
    super.onOptionsItemSelected(item);
    switch(item.getItemId())
    {
    case MY_ITEM:
      //code goes here;
      break;
    }

    return true;
} 
```

[来源](http://developer.android.com/reference/android/app/Activity.html#onOptionsItemSelected%28android.view.MenuItem%29)

# iphone - 使用 MPMoviePlayer 在流中缓冲标签

> ID：13260158
> 
> 赞同：0
> 
> 时间：2012-11-06T22:02:31.890
> 
> 标签：iphone, label, audio-streaming, buffering, mpmovieplayer

我正在制作一个广播流媒体应用程序，我的应用程序运行良好。我的屏幕上有两个按钮，一个用于播放，另一个用于暂停，还有一个指示播放器状态的标签。我让这个标签显示状态“正在播放”或“暂停”没有问题我的问题是当我按下播放按钮时，缓冲区有一段时间正在收集信息，我想不出一种方法来显示“ Buffering..." 播放器开始流式传输音频之前的标签。

这是我用于流式传输广播电台的代码。

```
 NSString *url = [NSString stringWithFormat:@"http://66.7.218:8816"];

        player = [[MPMoviePlayerController alloc] initWithContentURL:[NSURL URLWithString:url]];
        player.movieSourceType = MPMovieSourceTypeStreaming;
        player.view.hidden = YES;
        [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback error:nil];
        [[AVAudioSession sharedInstance]setActive:YES error:nil];
        [[UIApplication sharedApplication] beginReceivingRemoteControlEvents];
        [player prepareToPlay];

        [player play]; 
```

我正在使用我创建的名为 changeStatus 的函数，该函数每秒调用一次以识别播放器的状态。

```
-(void)changeStatus
{   

    if (player.loadState == MPMovieLoadStateUnknown) {
        status.text = @"Buffering...";
    }
    if(player.playbackState == MPMoviePlaybackStatePlaying)
        {
            status.text = @"Playing.";
        }
   if(player.playbackState == MPMoviePlaybackStatePaused)
        {
            status.text = @"Paused";
        }

} 
```

我真的需要解决这个问题，我已经尽我所能来解决它​​。希望你能帮我！提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T03:21:28.440

我实现了解决问题。缺少的部分是 if 子句，它仅在播放器准备播放时才发出开始播放的信号。否则，播放器会在缓冲区完全加载之前开始播放，因此不会播放音频。这就是我的 Playing 标签立即显示而不是缓冲标签的原因。

```
NSString *url = [NSString stringWithFormat:@"http://66.7.218:8816"];

        player = [[MPMoviePlayerController alloc] initWithContentURL:[NSURL URLWithString:url]];
        player.movieSourceType = MPMovieSourceTypeStreaming;
        player.view.hidden = YES;
        [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback error:nil];
        [[AVAudioSession sharedInstance]setActive:YES error:nil];
        [[UIApplication sharedApplication] beginReceivingRemoteControlEvents];

        [player prepareToPlay];

        if(player.isPreparedToPlay)
        {
        [player play];
        } 
```

此外， MPMoviePlaybackStateInterrupted 指的是在进行流时的缓冲过程。因此，如果您想在缓冲过程中发生某些事情，请参阅此方法。

```
-(void)changeStatus

    {   

        if(player.playbackState == MPMoviePlaybackStatePlaying)
            {
                status.text = @"Playing.";
            }
       if(player.playbackState == MPMoviePlaybackStateInterrupted)
            {
                status.text = @"Buffering...";
            }

    } 
```

非常感谢帮助我解决这个问题的用户 That Guy。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-17T02:24:10.253

实际上有一个通知叫做

> MPMediaPlaybackIsPreparedToPlayDidChangeNotification

准备好播放后，观察者将收到通知。它或多或少是相同的效果，但具有不同的机制。

# scala - Scala：收集不可变状态的更新/更改

> ID：13260162
> 
> 赞同：19
> 
> 时间：2012-11-06T22:02:52.567
> 
> 标签：scala, design-patterns, functional-programming, state, immutability

我目前正在尝试将更具功能性的编程风格应用于涉及低级（基于 LWJGL）GUI 开发的项目。显然，在这种情况下，需要携带很多状态，这在当前版本中是可变的。我的目标是最终拥有一个完全不可变的状态，以避免状态更改作为副作用。我研究了 scalaz 的镜头和状态单子一段时间，但我主要关心的是：所有这些技术都依赖于写时复制。由于我所在的州既有大量的字段，也有一些相当大的字段，所以我担心性能。

据我所知，修改不可变对象的最常见方法是使用`copy`a 的生成方法`case class`（这也是镜头在引擎盖下所做的）。我的第一个问题是，这种`copy`方法实际上是如何实现的？我对一个类进行了一些实验，例如：

```
case class State(
  innocentField: Int, 
  largeMap: Map[Int, Int], 
  largeArray: Array[Int]
) 
```

通过基准测试以及查看它的输出，`-Xprof`看起来更新`someState.copy(innocentField = 42)`实际上执行了深层复制，当我增加 和 的大小时，我观察到性能显着`largeMap`下降`largeArray`。我以某种方式期望新构造的实例共享原始状态的对象引用，因为在内部引用应该只是传递给构造函数。我可以以某种方式强制或禁用默认的这种深层复制行为`copy`吗？

在思考写时复制问题时，我想知道 FP 中是否有更通用的解决方案来解决这个问题，它以一种增量方式存储不可变数据的更改（在“收集更新”或“收集变化”）。令我惊讶的是，我找不到任何东西，所以我尝试了以下方法：

```
// example state with just two fields
trait State {
  def getName: String
  def getX: Int

  def setName(updated: String): State = new CachedState(this) {
    override def getName: String = updated
  }
  def setX(updated: Int): State = new CachedState(this) {
    override def getX: Int = updated
  }

  // convenient modifiers
  def modName(f: String => String) = setName(f(getName))
  def modX(f: Int => Int) = setX(f(getX))

  def build(): State = new BasicState(getName, getX)
}

// actual (full) implementation of State
class BasicState(
  val getName: String, 
  val getX: Int
) extends State

// CachedState delegates all getters to another state
class CachedState(oldState: State) extends State {
  def getName = oldState.getName
  def getX    = oldState.getX
} 
```

现在这允许做这样的事情：

```
var s: State = new BasicState("hello", 42)

// updating single fields does not copy
s = s.setName("world")
s = s.setX(0)

// after a certain number of "wrappings"
// we can extract (i.e. copy) a normal instance
val ns = s.setName("ok").setX(40).modX(_ + 2).build() 
```

我现在的问题是：你觉得这个设计怎么样？这是某种我不知道的 FP 设计模式（除了与 Builder 模式的相似性）吗？由于我没有发现任何类似的东西，我想知道这种方法是否存在一些重大问题？或者有没有更标准的方法来解决写时复制瓶颈而不放弃不变性？

是否有可能以某种方式统一 get/set/mod 功能？

**编辑：**

`copy`我执行深拷贝的假设确实是错误的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-06T22:24:34.463

这与视图基本相同，是一种惰性求值；这种类型的策略或多或少是 Haskell 中的默认策略，并且在 Scala 中使用得相当多（参见例如 mapValues on maps、grouped on collections、Iterator 或 Stream 上几乎所有返回另一个 Iterator 或 Stream 的东西等）。这是一种行之有效的策略，可以避免在正确的环境中进行额外的工作。

但我认为你的前提有些错误。

```
case class Foo(bar: Int, baz: Map[String,Boolean]) {}
Foo(1,Map("fish"->true)).copy(bar = 2) 
```

实际上不会导致地图被深度复制。它只是设置参考。字节码证明：

```
62: astore_1
63: iconst_2   // This is bar = 2
64: istore_2
65: aload_1
66: invokevirtual   #72; //Method Foo.copy$default$2:()Lscala/collection/immutable/Map;
69: astore_3   // That was baz
70: aload_1
71: iload_2
72: aload_3
73: invokevirtual   #76; //Method Foo.copy:(ILscala/collection/immutable/Map;)LFoo; 
```

让我们看看那`copy$default$2`东西做了什么：

```
0:  aload_0
1:  invokevirtual   #50; //Method baz:()Lscala/collection/immutable/Map;
4:  areturn 
```

只返回地图。

而`copy`它本身呢？

```
0:  new #2; //class Foo
3:  dup
4:  iload_1
5:  aload_2
6:  invokespecial   #44; //Method "<init>":(ILscala/collection/immutable/Map;)V
9:  areturn 
```

只需调用常规构造函数。没有克隆地图。

因此，当您复制时，您只创建了一个对象——您正在复制的内容的新副本，其中填写了字段。如果您有大量字段，您的视图会更快（因为您必须创建一个新对象（如果您使用功能应用程序版本，则为两个，因为您还需要创建功能对象）但它只有一个字段）。否则应该差不多。

所以，是的，可能是个好主意，但要仔细进行基准测试，以确保它在你的案例中是值得的——你必须手工编写相当多的代码，而不是让案例类为你做这一切。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T11:00:45.533

`copy`我试图为您的案例类操作的计时性能编写一个（相当粗略的）测试。

```
object CopyCase {

    def main(args: Array[String]) = {

        val testSizeLog = byTen(10 #:: Stream[Int]()).take(6).toList
        val testSizeLin = (100 until 1000 by 100) ++ (1000 until 10000 by 1000) ++ (10000 to 40000 by 10000)

        //warmUp
        runTest(testSizeLin)
        //test with logarithmic size increments 
        val times = runTest(testSizeLog)
        //test with linear size increments 
        val timesLin = runTest(testSizeLin)

        times.foreach(println)
        timesLin.foreach(println)
    }

    //The case class to test for copy
    case class State(
        innocentField: Int, 
        largeMap: Map[Int, Int], 
        largeArray: Array[Int]
    )

    //executes the test
    def runTest(sizes: Seq[Int]) = 
        for {
            s <- sizes
            st = State(s, largeMap(s), largeArray(s))
            //(time, state) = takeTime (st.copy(innocentField = 42)) //single run for each size
            (time, state) = mean(st.copy(innocentField = 42))(takeTime) //mean time on multiple runs for each size
        } yield (s, time)

    //Creates the stream of 10^n  with n = Naturals+{0}
    def byTen(s: Stream[Int]): Stream[Int] = s.head #:: byTen(s map (_ * 10))

    //append the execution time to the result
    def takeTime[A](thunk: => A): (Double, A) = {
        import System.{currentTimeMillis => millis, nanoTime => nanos}
        val t0:Double = nanos
        val res = thunk
        val time = ((nanos - t0) / 1000)
        (time, res)
    }

    //does a mean on multiple runs of the first element of the pair 
    def mean[A](thunk: => A)(fun: (=> A) => (Double, A)) = {
        val population = 50
        val mean = ((for (n <- 1 to population) yield fun(thunk)) map (_._1) ).sum / population
        (mean, fun(thunk)._2)
    }

    //Build collections for the requested size
    def largeMap(size: Int) = (for (i <- (1 to size)) yield (i, i)).toMap
    def largeArray(size: Int) = Array.fill(size)(1)
} 
```

* * *

在这台机器上：

*   CPU：64位双核i5 3.10GHz
*   内存：8GB 内存
*   操作系统：win7
*   爪哇：1.7
*   斯卡拉：2.9.2

我有以下结果，这对我来说看起来很正常。

```
(size, millisecs to copy)
(10,0.4347000000000001)
(100,0.4412600000000001)
(1000,0.3953200000000001)
(10000,0.42161999999999994)
(100000,0.4478600000000002)
(1000000,0.42816000000000015)
(100,0.4084399999999999)
(200,0.41494000000000014)
(300,0.42156000000000016)
(400,0.4281799999999999)
(500,0.42160000000000003)
(600,0.4347200000000001)
(700,0.43466000000000016)
(800,0.41498000000000007)
(900,0.40178000000000014)
(1000,0.44134000000000007)
(2000,0.42151999999999995)
(3000,0.42148)
(4000,0.40842)
(5000,0.38860000000000006)
(6000,0.4413600000000001)
(7000,0.4743200000000002)
(8000,0.44795999999999997)
(9000,0.45448000000000005)
(10000,0.45448)
(20000,0.4281600000000001)
(30000,0.46768)
(40000,0.4676200000000001) 
```

* * *

也许您有不同的性能衡量标准。

或者可能是您的分析时间实际上花费在生成`Map`和 上`Array`，而不是复制`case class`？

# jquery - 如何使用 jQuery 为每次点击添加边距？

> ID：13260165
> 
> 赞同：3
> 
> 时间：2012-11-06T22:03:32.680
> 
> 标签：jquery, slide

```
 })
  //NEXT
  $('.social-next a').on('click', function(e){
    e.preventDefault();
    $('.social').animate({marginLeft: '-940px'});
  })
  //PREVIOUS
  $('.social-previous a').on('click', function(e){
    e.preventDefault();
     $('.social').animate({marginLeft: '940px'}, 500);
  }) 
```

这只是固定边距值，另一方面我需要滑动我的内容，所以通过按 next 和 prev 我需要滑动它，有点明显。

谢谢。

编辑：

```
.social {
  width: 2820px;
  overflow: hidden;
}

.social .slide {
  width: 940px;
  float: left;
  overflow: hidden;
}

.social-previous {
  position: absolute;
  top: 50%;
  left: 0;
}

.social-next {
  position: absolute;
  top: 50%;
  right: 0;
} 
```

和html：

```
 <div class="social">
            <div class="intro">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima error.<a href="#" class="show-slides">Check it!</a></div>

            <div class="slide">
                <div class="intro">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima error.<a href="#" class="open-slides"></div>
                <div class="content">dolor dolor dolor <a href="#" class="close-slides"></a></div>
            </div>

            <div class="slide">
                <div class="intro">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima error.<a href="#" class="open-slides"></div>
                <div class="content">ipsum ipsum ipsum ipsum ipsum<a href="#" class="close-slides"></a></div>
            </div>

            <div class="slide">
                <div class="intro">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima error.<a href="#" class="open-slides"></div>
                <div class="content">Lorem Lorem Lorem Lorem Lorem<a href="#" class="close-slides"></a></div>
            </div>

        </div> 
```

它也在其他 div 中，但我认为它们不相关。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T22:05:34.513

要添加到以前的值，请使用`+=`：

```
$('.social').animate({marginLeft: '+=940px'}, 500);
                                 --^-- 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:20:38.913

我不知道您的代码的全部范围，但我不认为添加/减去边距是要走的路。我认为您实际上想要做的是围绕内容制作一个包装器 div 并将其位置设置为相对或绝对，具体取决于您想要做什么。然后您可以调整左侧/顶部属性。

也可以调整边距。

使用 jQuery animate() 或 css() 您可以指定相对值，例如

```
$('.social-next a').click(function(e){
   e.preventDefault();
   $('.social').animate({'margin-left': '-=40'});
}); 
```

我使用 'margin-left' 是因为我发现它更容易阅读，因为它与您在 CSS 规则中键入的内容相同。确保你有引号。如果没有引号，您必须使用没有破折号的 Javascript 样式的单词。

还！不要放 px 或任何其他单位。它需要一个整数。

示例 JSfiddle：http: [//jsfiddle.net/hososugi/svFEs/2/](http://jsfiddle.net/hososugi/svFEs/2/)

# facebook - 让用户在提要对话框中指定收件人

> ID：13260166
> 
> 赞同：2
> 
> 时间：2012-11-06T22:03:34.470
> 
> 标签：facebook, dialog, feed

目前，我们的应用通过 Graph API 发布到用户朋友的墙。[但是，Facebook 正在弃用此功能，因此我们将根据 Facebook 的建议迁移到 Feed Dialog（请参阅https://developers.facebook.com/roadmap/](https://developers.facebook.com/roadmap/)上的 2013 年 2 月 6 日部分）。

现在，我们知道我们可以将接收者指定为 Javascript SDK 调用的一部分（注意 FB.init() 在页面前面的其他地方被调用）：

```
<p><a onclick="launchFeedDialog(); return false">Testing the Feed Dialog</a></p>
<script>
function launchFeedDialog() {

    // calling the API ...
    var obj = {
      method: 'feed',
      to: 'RECIPIENT NAME', // Can specify recipient here
      link: 'http://example.com',
      name: 'Test post',
      description: 'Test description'
    };

    FB.ui(obj);
}
</script> 
```

但是，用户似乎无法在启动的对话框中修改收件人。我的意思的屏幕截图位于[http://i.imgur.com/oLPTO.png](http://i.imgur.com/oLPTO.png)。

是否有某种方法可以调用提要对话框，以便用户可以更改/添加收件人，例如在发送对话框中？

我们试图实现的流程（以及目前的方式）是：

1.  用户单击按钮以启动 Feed 对话框
2.  用户填写 Feed 对话框（包括收件人）并提交

现在，我们被这个尴尬的流程困住了：

1.  用户填写指定收件人的自定义控件
2.  用户单击按钮以启动 Feed 对话框
3.  用户填写 Feed 对话框并提交

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:27:07.813

好的，我们找到了解决方法。总体思路：

1.  将 Feed Dialog 内嵌显示为 iframe（通过指定`display=iframe`）
2.  创建您自己的自定义控件以选择收件人 Facebook 用户名或 ID
3.  在选择收件人或 onblur 等时异步重新加载 iframe

上面的一些警告/理由：

*   您不能使用 JS SDK，因为它会将提要对话框的 iframe 版本作为模态灯箱启动（而不是页面流中的内联）
*   您需要实现一个重定向页面来进行后处理，例如更新父窗口的状态、记录结果等
*   对于 (2)，自定义控件可以像文本输入字段一样简单，但您可能至少需要某种自动完成功能。这实际上并不太棘手，因为您使用[https://graph.facebook.com/me/friends](https://graph.facebook.com/me/friends) Graph API 调用获取用户的朋友列表。

这是一个使用简单文本输入的基本示例：

```
<html>
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
</head>
<body>
<div>
  Recipient's FB username:
  <input type="text" id="fb-recipient" placeholder="Recipient's FB username"></input>
  <input type="submit" id="fb-recipient-submit" value="Pick" />
</div>
  <iframe id="fb-feed-dialog" width="586" height="330" frameborder="0" allowfullscreen></iframe>
<script>
  $('#fb-recipient-submit').click(function(e){
    e.preventDefault();
    var feedUrl = 'https://www.facebook.com/dialog/feed?';
    feedUrl += 'display=iframe';
    feedUrl += '&app_id=' + 'YOUR_APP_ID';
    feedUrl += '&access_token=' + 'ACCESS_TOKEN';
    feedUrl += '&link=' + 'SHARE_LINK';
    feedUrl += '&redirect_uri=' + 'REDIRECT_URI';
    feedUrl += '&to=' + $('#fb-recipient').val();
    $('#fb-feed-dialog').attr( 'src', feedUrl );
  });
</script>
</body>
</html> 
```

您可以在以下位置找到稍微充实的解决方案的屏幕截图：http: [//i.imgur.com/0jTM391.png](http://i.imgur.com/0jTM391.png)

# c# - 关于异步 lambda 类型推断的错误 C# 编译器错误消息

> ID：13260167
> 
> 赞同：2
> 
> 时间：2012-11-06T22:03:41.373
> 
> 标签：c#, .net-4.5, async-await

我遇到了这个 C# 编译器错误，虽然我对编译器无法推断 lambda 的类型感到满意，但错误消息似乎是错误的。这是相关的代码：

```
Func<object> lambda = async () => { return await Task.FromResult(1); }; 
```

这是编译器错误：

> 错误 CS4010：无法将异步 lambda 表达式转换为委托类型“ `System.Func<object>`”。异步 lambda 表达式可能返回或`void`，它们都不能转换为 ' '。`Task``Task<T>``System.Func<object>`

我不太明白的部分是最后一句话。lambda 确实在返回`Task<int>`，但为什么编译器认为它应该尝试将其转换为lambda `System.Func<object>`？

另一方面，如果错误消息试图传达的是 that `System.Func<Task<int>>`cannot be assigned to `System.Func<object>`，那么由于通用委托协方差，这似乎不是这种情况，这意味着它可以正常工作：

```
Func<object> lambda = new Func<Task<int>>(async () => { return await Task.FromResult(1); }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:55:53.350

> lambda 确实在返回`Task<int>`，但为什么编译器认为它应该尝试将其转换为lambda `System.Func<object>`？

我认为错误信息措辞不当。它试图派生 lambda 的返回类型（可以是`void`、`Task`或`Task<T>`），并将*lambda*转换为`Func<object>`. 我建议您在 Microsoft Connect 上提出问题，请求更清晰的错误消息。

> 另一方面，如果错误消息试图传达的是`System.Func<Task<int>>`无法分配给`System.Func<object>`，那么由于通用委托协方差，情况似乎并非如此

没错，但是编译器直到“晚于”大多数表达式才确定 lambda 表达式的类型。编译器看不到`Func<Task<int>>`（它只看到一个不带参数并返回`Task`or的 lambda 表达式`Task<int>`），因此它不会使用泛型委托变体。

我希望 Eric Lippert 会写一篇关于如何`async`解析 lambda 表达式的博文，特别是在方法重载选择的情况下。

# javascript - 当 IE 不正确时 Firefox 显示表格

> ID：13260172
> 
> 赞同：0
> 
> 时间：2012-11-06T22:04:05.313
> 
> 标签：javascript

这是不应在 Firefox 中显示的表格开头部分的代码

```
<FORM Name='Main' METHOD=POST><!--    DISPLAY PAY PERIOD DETAIL WEEKLY VIEW --><span align='center' id='spanDetails'
                                                                                     style='display:none'><TABLE
        align='center' BORDER=1 CELLPADDING=4 CELLSPACING=0 CLASS=cTable>
    <TR>
        <th CLASS=TH1 align='center' valign='top' colspan='6'>Pay Period Detailss</th>
        <th CLASS=TH1 align='center' valign='top'>
            <style type="text/css">.myLayersClass {
                position: relative;
                display: table;
            }</style>
            <span id='spanHideDetails' class='myLayersClass' style='display: table'><a
                    href='javascript:if (typeof(document.forms["Main"]["showtb"])=="object"){ SetDetailSpanStatus(document.forms["Main"]["showtb"],0);}ToggleDisplay("spanDetails", "");javascript:ToggleDisplay("spanPPDates", "TsLinks");'>Hide</a></span>
        </th>
    </tr>
    <tr>
        <TH ALIGN='center' valign='center'>Date</TH>
        <TH ALIGN='center' valign='center'>Duration</TH>
        <TH ALIGN='center' valign='center'>Title Code/<br>Pay Code</TH>
        <TH ALIGN='center' valign='center'>Project/<br>Enterprise Project</TH>
        <TH ALIGN='center' valign='center'>FAU Title/<br>Shift</TH>
        <TH ALIGN='center' valign='center'>Message</TH>
        <TH ALIGN='center' valign='center'>View</TH>
    </tr>
    <tr CLASS='bottom'> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:08:17.850

它可能`<span>`与`display: none;`包裹**在整个桌子周围的**东西有关。

它在浏览器之间出现异常的原因通常是由**无效的 HTML**引起的。在除 HTML5 之外的所有 HTML 版本中，a`<table>`位于 a 内是无效的`<span>`。因此，有些浏览器会接受它，有些浏览器会将表格踢出`<span>`，留下一个空的、不可见的跨度，外面有一个大表格。

结论：

*   用一个`<div>`
*   验证您的 HTML。

# python - celery 尝试通过在 task_postrun 信号中引发 SystemExit 来关闭工作者，但总是挂起并且主进程永远不会退出

> ID：13260181
> 
> 赞同：6
> 
> 时间：2012-11-06T22:04:42.210
> 
> 标签：python, signals, celery, systemexit

我正在尝试通过 task_postrun 信号中的 raisin SystemExit() 关闭主要的 celery 进程。信号被很好地触发，异常被引发，但工作人员永远不会完全退出，只是挂在那里。

我该怎么做？

我在某处忘记了一些设置吗？

下面是我用于工作人员的代码（worker.py）：

```
from celery import Celery
from celery import signals

app = Celery('tasks',
    set_as_current = True,
    broker='amqp://guest@localhost//',
    backend="mongodb://localhost//",
)

app.config_from_object({
    "CELERYD_MAX_TASKS_PER_CHILD": 1,
    "CELERYD_POOL": "solo",
    "CELERY_SEND_EVENTS": True,
    "CELERYD_CONCURRENCY": 1,
    "CELERYD_PREFETCH_MULTIPLIER": 1,
})

def shutdown_worker(**kwargs):
    print("SHUTTING DOWN WORKER (RAISING SystemExit)")
    raise SystemExit()

import tasks

signals.task_postrun.connect(shutdown_worker)

print("STARTING WORKER")
app.worker_main()
print("WORKER EXITED!") 
```

以下是tasks.py的代码：

```
from celery import Celery,task
from celery.signals import task_postrun
import time

from celery.task import Task

class Blah(Task):
    track_started = True
    acks_late = False

    def run(config, kwargs):
        time.sleep(5)
        return "SUCCESS FROM BLAH"

def get_app():
    celery = Celery('tasks',
        broker='amqp://guest@localhost//',
        backend="mongodb://localhost//"
    )
    return celery 
```

为了测试这一点，我做的第一件事是运行工作代码 ( `python worker.py`)，然后我将一个任务排队，如下所示：

```
>>> import tasks
>>> results = []
>>> results.append(tasks.Blah.delay({})) 
```

我从工人那里看到的输出是这样的：

```
STARTING WORKER

 -------------- celery@hostname v3.0.9 (Chiastic Slide)
---- **** ----- 
--- * ***  * -- [Configuration]
-- * - **** --- . broker:      amqp://guest@localhost:5672//
- ** ---------- . app:         tasks:0x26f3050
- ** ---------- . concurrency: 1 (solo)
- ** ---------- . events:      ON
- ** ---------- 
- *** --- * --- [Queues]
-- ******* ---- . celery:      exchange:celery(direct) binding:celery
--- ***** ----- 

[2012-11-06 15:59:16,761: WARNING/MainProcess] celery@hostname has started.
[2012-11-06 15:59:21,785: WARNING/MainProcess] SHUTTING DOWN WORKER (RAISING SystemExit) 
```

我期待python代码从调用返回`app.worker_main()`然后打印`WORKER EXITED`，然后进程完全退出。这永远不会发生，并且必须编辑工作进程才能`kill -KILL {PID}`让它消失（它也不能使用任何其他任务。

我想我的主要问题是：

我如何使代码返回`app.worker_main()`？

我希望能够在执行多个任务后完全重新启动工作进程（通过让进程***完全***退出） 。`X`

***更新***我弄清楚了工作人员在做什么 - 工作人员 (在捕获异常`WorkController`正在等待调用`self.stop``SystemExit`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T14:30:55.393

当我最终回答自己的问题时，讨厌它。

Anywhoo，它阻止了对内部组件的加入调用（对组件`Mediator`的`WorkController`调用，内部停止，它）。`stop()``Mediator``join`

我通过禁用所有速率限制来摆脱`Mediator`组件（默认情况下应该是这个，但不是出于某种原因）。

您可以使用以下设置禁用所有速率限制：

```
CELERY_DISABLE_ALL_RATE_LIMITS: True 
```

希望这也有助于其他人。

和平

# c# - Winforms 控件和“通用”事件处理程序。我怎样才能做到这一点？

> ID：13260191
> 
> 赞同：0
> 
> 时间：2012-11-06T22:05:34.937
> 
> 标签：c#, winforms

在 ObjectListView 控件的演示中有此代码（在“复杂示例”选项卡页面中）允许自定义编辑器（组合框）（适应我的情况并为清晰起见进行了编辑）：

```
EventHandler CurrentEH;
private void ObjectListView_CellEditStarting(object sender,
                                             CellEditEventArgs e)
{
    if (e.Column == SomeCol)
    {
        ISomeInterface M = (e.RowObject as ObjectListView1Row).SomeObject; //(1)
        ComboBox cb = new ComboBox();
        cb.Bounds = e.CellBounds;
        cb.DropDownStyle = ComboBoxStyle.DropDownList;
        cb.DataSource = ISomeOtherObjectCollection;
        cb.DisplayMember = "propertyName";
        cb.DataBindings.Add("SelectedItem", 
                            M, "ISomeOtherObject", false,
                            DataSourceUpdateMode.Never);
        e.Control = cb;
        cb.SelectedIndexChanged += 
            CurrentEH = (object sender2, EventArgs e2) =>
                M.ISomeOtherObject = 
                    (ISomeOtherObject)((ComboBox)sender2).SelectedValue;   //(2)
    }
}

private void ObjectListView_CellEditFinishing(object sender,
                                               CellEditEventArgs e)
{
    if (e.Column == SomeCol)
    {
        // Stop listening for change events
        ((ComboBox)e.Control).SelectedIndexChanged -= CurrentEH;
        // Any updating will have been down in the SelectedIndexChanged
        // event handler.
        // Here we simply make the list redraw the involved ListViewItem
        ((ObjectListView)sender).RefreshItem(e.ListViewItem);
        // We have updated the model object, so we cancel the auto update
        e.Cancel = true;
    }
} 
```

我在 objectlistviews 中有太多其他带有组合编辑器的列，无法使用复制和粘贴策略（此外，复制和粘贴是严重的错误来源），因此我尝试对代码进行参数化以将代码重复降至最低。ObjectListView_CellEditFinishing 是小菜一碟：

```
HashSet<OLVColumn> cbColumns = new HashSet<OLVColumn> (new OLVColumn[] { SomeCol, SomeCol2, ...};

private void ObjectListView_CellEditFinishing(object sender,
                                               CellEditEventArgs e)
{
    if (cbColumns.Contains(e.Column)) ... 
```

但 ObjectListView_CellEditStarting 是有问题的。

我想在 CellEditStarting 中我将不得不分别区分每种情况：

```
private void ObjectListView_CellEditStarting(object sender,
                                             CellEditEventArgs e)
{
    if (e.Column == SomeCol)
        // code to create the combo, put the correct list as the datasource, etc.
    else if (e.Column == SomeOtherCol)  
        // code to create the combo, put the correct list as the datasource, etc. 
```

等等。

但是如何参数化“创建组合的代码，将正确的列表作为数据源等”？问题线是

(1) 获取一些对象。属性名称各不相同。

(2) 设置ISomeOtherObject，属性名也不同。

类型也各不相同，但我可以使用通用方法结合不太“类型安全”的 API 来涵盖这些情况（例如，cb.DataBindings.Add 和 cb.DataSource 都使用`object`）

反射？更多的lambda？有任何想法吗？还有其他方法可以做到这一点吗？

PS：我希望能够做这样的事情：

```
private void ObjectListView_CellEditStarting(object sender,
                                             CellEditEventArgs e)
{
    if (e.Column == SomeCol)
        SetUpCombo<ISomeInterface>(ISomeOtherObjectCollection,
                                   "propertyName",
                                   SomeObject,
                                   ISomeOtherObject);

    else if (e.Column == SomeOtherCol)  
        SetUpCombo<ISomeInterface2>(ISomeOtherObject2Collection,
                                   "propertyName2",
                                   SomeObject2
                                   ISomeOtherObject2); 
```

等等。或类似的东西。

我知道，参数 SomeObject 和 ISomeOtherObject 不是真正的参数，但你明白我想要什么。我不想一次又一次地重复相同的代码框架。

一种解决方案是像 C 的 DEFINE 这样的“预处理器泛型”，但我不认为 c# 有这样的东西。

那么，有没有人有一些替代的想法来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T16:58:24.293

找到了。向 Tejs 致敬！

```
private void SetUpCombo(CellEditEventArgs e, 
                        object ComboItems, string DisplayMember,
                        object DataSource, string PropertyName,
                        EventHandler evt)
{
    ComboBox cb = new ComboBox();
    cb.Bounds = e.CellBounds;
    cb.DropDownStyle = ComboBoxStyle.DropDownList;
    cb.DataSource = ComboItems;
    cb.DisplayMember = DisplayMember;
    cb.DataBindings.Add("SelectedItem", DataSource, PropertyName,
                            false, DataSourceUpdateMode.Never);
    e.Control = cb;
    cb.SelectedIndexChanged += CurrentEH = evt;
} 
```

和重写的 CellEditStarting：

```
private void ObjectListView_CellEditStarting(object sender,
                                             CellEditEventArgs e)
{
    if (e.Column == SomeCol)
    {
        ISomeInterface M = (e.RowObject as ObjectListView1Row).SomeObject; 
        SetUpCombo(e, 
                   ISomeOtherObjectCollection,"propertyName",
                   M, "ISomeOtherObject",
                   (sender2, e2) =>
                       M.ISomeOtherObject = 
                           (ISomeOtherObject)((ComboBox)sender2).SelectedValue);
    }
    else if (e.Column == SomeOtherCol)  
    {
        ISomeInterface2 M = (e.RowObject as ObjectListView1Row).SomeObject2; 
        SetUpCombo(e, 
                   ISomeOtherObjectCollection2,"propertyName2",
                   M, "ISomeOtherObject2",
                   (sender2, e2) =>
                       M.ISomeOtherObject2 = 
                           (ISomeOtherObject)((ComboBox)sender2).SelectedValue);
    } 
```

等等……有些东西我还不喜欢。例如：M.ISomeOtherObject（方法调用外）、“ISomeOtherObject”（参数）和 M.ISomeOtherObject 的设置（lambda 内）之间的断开。

但是，考虑到所有因素，它比一遍又一遍地复制和粘贴相同的代码要好得多）。

# python - 比较嵌套列表

> ID：13260199
> 
> 赞同：0
> 
> 时间：2012-11-06T22:06:59.437
> 
> 标签：python, list

我有两个列表，其中一个是：

```
[a1, b1, [[c1, d1, e1], [f1, g1, h1], etc, etc], etc] 
```

另一个是字典，其条目格式为：

`[[a2, b2, c2], [d2, e2, f2], etc, etc]`.

我需要在那里比较这两个子列表的第一个条目，并找到任何相同的条目，以及第一个条目中根本没有出现在第二个条目中的条目。

例如，如果`c1 = d2`，我想知道，如果`f1`不等于`a2`or `d2`，我想知道。

无论如何，我在正确实施这一点时遇到了一些麻烦，任何帮助将不胜感激。

谢谢！

（我不确定列表格式的理解程度如何，如果它们仍然令人困惑，请见谅）

代码示例：

```
for row in range(0, len(command[2])):

    counter = 0

    for nodeRows in range(0, len(nodeTable[command[0]])):

        if nodeTable[command[0]][nodeRows][0] == command[2][row][0]:

            if ((command[2][row][2]) + 1) < nodeTable[command[0]][nodeRows][2]:

                counter += 1

                newrow = command[2][row]
                newrow[1] = command[1]
                newrow[2] = newrow[2] + 1

                nodeTable[command[0]][nodeRows] = newrow

                change = 'true' 
```

我想这没有帮助。代码有点单一（这就是我最初没有发布它的原因）。但我基本上是在尝试比较两个值。另一个列表的第三个位置的列表中的项目的第一个值以及另一个列表中包含的列表中的项目的第一个值。

嗯……对不起。我试过让代码更简单，但有点复杂。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T22:45:48.307

我不确定我是否正确理解您的问题，但我会试一试。我想您只需要比较 3 个元素的每个子列表的第一个元素。

因此，首先我将所有第一个元素分开，然后进行比较。

这是带有一些[doctest](http://docs.python.org/library/doctest.html)的代码，因此您可以检查它是否符合您的要求：

```
def compare(l0, l1):
    """
    >>> l0 = [1, 2, [[10, 20, 30], [40, 50, 60], [70, 80, 90]], 3]
    >>> l1 = [[11, 21, 31], [41, 51, 61], [71, 81, 91]]
    >>> compare(l0, l1)
    ([], [10, 40, 70])

    >>> l0 = [1, 2, [[10, 20, 30], [40, 50, 60], [70, 80, 90]], 3]
    >>> l1 = [[10, 21, 31], [41, 51, 61], [71, 81, 91]]
    >>> compare(l0, l1)
    ([10], [40, 70])

    >>> l0 = [1, 2, [[10, 20, 30], [40, 50, 60], [70, 80, 90]], 3]
    >>> l1 = [[10, 21, 31], [40, 51, 61], [70, 81, 91]]
    >>> compare(l0, l1)
    ([10, 40, 70], [])
    """
    first_entries_l0 = [x[0] for x in l0[2]]
    first_entries_l1 = [x[0] for x in l1]

    equals = [x for x in first_entries_l0 if x in first_entries_l1]
    unique = [x for x in first_entries_l0 if x not in first_entries_l1]

    return equals, unique 
```

要测试代码，只需将其复制到文件“code.py”并运行它：

```
python -m doctest code.py 
```

您可以只使用一次集合和循环来提高效率，但我什至不确定这是否能解决您的问题，所以我将把它留给您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:33:32.013

答案是：将您当前的数据结构转换为适当的数据结构。大概输入是你自己定义的，所以你不应该写更好的代码来处理丑陋的结构，而是改进结构。如果您正在编写一个糟糕的 API，请将 API 映射到一个有用的结构。

您必须发布整个代码才能获得正确的答案，因为问题出在定义中。我猜你将不得不重构整个模块并重新开始，因为这只是糟糕的代码。

一些想法：命令可以是一棵树吗？排队名单？矩阵？一类？为什么item的长度不一样，为什么要比较不同的subitem？尝试使用类并覆盖`__cmp__`.

# html - 使用无序列表时对有序性的困惑

> ID：13260200
> 
> 赞同：0
> 
> 时间：2012-11-06T22:07:13.990
> 
> 标签：html, css, html-lists

我认为我的问题是这个网站上最简单的问题。尽管如此，我无法解决它。

现在，我有一个像底部的 html。元素必须并排显示。但是输出如下图所示。另外，我不知道下划线是从哪里来的。
![混乱的顺序](../Images/860a3be96856cea8ef7cd3415ae97ab8.png)
我怎么能做我想做的事？

```
 <div class="ilgiliclass">
    <?php
                echo '<ul>';
                if(...)
                {
                    foreach(...)
                    {
                        if(...)
                        {
     ?>

                                <li>
                                    <img src="img/arrow.gif">
                                    <div class="si">
                                        <a href="...">...</a> 
                                    </div>                                                             
                                    -
                                    <div class="so">
                                        <a href="...">...</a>
                                    </div>
                                    <br />
                                </li>

    <?php        
                        }
                    }  
                }  
    ?>
            </ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:10:51.997

`si`在和`so`元素之间的标记中有一个破折号。我想这就是您所说的“下划线”。两者`.si`和`.so`都可以设置为`display:inline;`，这应该将所有内容放在一行上。

JS 小提琴示例：http: [//jsfiddle.net/TYsN6/](http://jsfiddle.net/TYsN6/)

# php - 字典字符串的php正则表达式

> ID：13260202
> 
> 赞同：0
> 
> 时间：2012-11-06T22:07:31.457
> 
> 标签：php, regex

我可以使用一些帮助来为这个字典字符串编写正则表达式（我不经常使用它们）。

这是字符串字典的示例：

```
O:8:"stdClass":5:{s:4:"sent";i:0;s:6:"graded";i:0;s:5:"score";i:0;s:6:"answer";s:14:"<p>Johnson</p>";s:8:"response";s:0:"";} 
```

我想从字符串字典中提取 Johnson。

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T22:11:50.497

这是一个 PHP[序列化](http://www.php.net/manual/en/function.serialize.php)对象。不要使用正则表达式。[`unserialize()`](http://www.php.net/manual/en/function.unserialize.php)数据并`answer`相应地显示属性。

```
unserialize($data);
echo $data->answer; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:13:56.760

```
$str = 'O:8:"stdClass":5:{s:4:"sent";i:0;s:6:"graded";i:0;s:5:"score";i:0;s:6:"answer";s:14:"<p>Johnson</p>";s:8:"response";s:0:"";}';

$obj = unserialize($str);

echo $obj->answer; 
```

这将是正确的答案，不需要正则表达式。如果您想`<p>`删除标签，您可能需要一些额外的 HTML 解析。如果格式将**始终**保持不变（只有这样！），只需删除`<p>`and`</p>`标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T22:17:05.820

看起来您应该[`unserialize()`](http://php.net/manual/en/function.unserialize.php)改用它，然后您可以使用 preg_match 删除`<p>`标签。

```
$obj = (unserialize('O:8:"stdClass":5:{s:4:"sent";i:0;s:6:"graded";i:0;s:5:"score";i:0;s:6:"answer";s:14:"<p>Johnson</p>";s:8:"response";s:0:"";}'));
preg_match('~<p>([^<]*)</p>~', $obj->answer, $ans);
print_r($ans[1]); //prints Johnson 
```

# java - m2e 看不到本地存储库中手动安装的 jar

> ID：13260205
> 
> 赞同：0
> 
> 时间：2012-11-06T22:08:15.597
> 
> 标签：java, maven, eclipse-plugin

我为 Eclipse 使用 M2E maven 插件，并单独安装了 maven。我安装了 Oracle 驱动程序：

```
mvn install:install-file -Dfile=D:\apps\ojdbc.jar -DgroupId=com.oracle -DartifactId=ojdbc6 -Dversion=11.2.0 -Dpackaging=jar 
```

...

```
------------------------------------------------------------------------
BUILD SUCCESS
------------------------------------------------------------------------ 
```

但m2e看不到罐子

窗体 Window->Preferences->Maven->UserSettings 我将插件设置为指向与其他 Maven 相同的 setting.xml 所以两者都查看 C:\Users\myUser.m2\repository （我认为......）实际上我`ojdbc6-11.2.0.jar`在 repo 中找不到，但`ojdbc6-11.2.0.jar.lastUpdated` 文件安装可能有问题，但日志说没问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:34:44.210

如果您看到的只是 .lastUpdated，那么您的 mvn install 无法正常工作。

编辑：

尝试将 -Dgeneratepom=true 与您指定的所有其他参数一起指定为另一个参数。

# c++ - 在 QStackedWidget 页面中调整布局大小

> ID：13260206
> 
> 赞同：3
> 
> 时间：2012-11-06T22:08:17.070
> 
> 标签：c++, qt

我正在尝试将一个小部件放置在 QStackedWidget 的页面上，以便在父 QStackedWidget 调整大小时自动调整大小。这个简单的任务似乎不可能用 Qt Creator 完成。向页面添加布局似乎没有任何作用，布局只是保持其设计的大小，并且不会调整大小。这是（我认为？）因为布局作为子项添加到页面小部件中，而不是直接附加到页面小部件。似乎没有办法实际向页面添加布局。

如何使用 Qt Creator 在 QStackedWidget 中调整小部件的大小？？？

作为旁注，我真的希望 Qt 放弃它的布局系统，它比基于锚定的系统更难使用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T23:52:43.303

Qt Creator 将小部件视为它们已经具有布局，您可以从设计器中小部件的上下文菜单（右键单击）或右侧的小部件列表中访问该布局。这意味着如果您想将该顶级布局划分为进一步的子布局，您只需将布局（从调色板中）拖放到小部件上。下图显示了此上下文菜单。

![在此处输入图像描述](../Images/32f98d1f3aed03a21224be973881e1aa.png)

请注意右侧的小部件图标显示一个划掉的红色圆圈。这表明没有为这些小部件定义顶级布局。选择布局类型后，红色圆圈将消失，图标将反映您的布局选择。

在您的情况下，在`QStackedWidget`主小部件上放置 a 后，您可以右键单击主小部件，选择“布局”并选择“水平布局”。这将使堆叠的小部件填充整个主小部件并随之调整大小。

同样，如果您将任何小部件放在“页面”小部件之一上，则可以右键单击页面小部件并为其分配顶级布局，这将导致这些小部件与页面小部件相应地调整大小。

# sencha-touch-2 - 从 Sencha Touch 2 中的 Localstorage 代理中删除记录

> ID：13260216
> 
> 赞同：0
> 
> 时间：2012-11-06T22:08:44.390
> 
> 标签：sencha-touch-2

所以我的问题是这个。我可以第一次从本地存储代理中删除记录。但是如果我再做一次，它会给我一个错误，商店中的所有东西都是未定义的，就像它不再存在一样。

```
 onTapRemoveKegelReminder: function(button) {
    console.log(button.getData());
    //Find and delete the button and the record
    var store = Ext.getStore('KegelReminders');
    store.load();
    store.filter('button_id', button.getData());
    var record = store.first();

    console.log(record);
    console.log(button.getData());
    console.log('Remove count'+ store.getCount());

    if (typeof record !== 'undefined'||record!=null ) {
        store.remove(record);
        store.sync();

        console.log('removed record correctly')
        this.trainingCount--;
        var rmButton = this.getKegelExercises().down('#container-' + button.getData());
        this.getKegelExercises().remove(rmButton);

    } 
```

但是，如果我重新启动我的应用程序，然后再次删除它就可以正常工作。我似乎不能多次删除而不必重新启动应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T20:14:58.807

仅供参考，以防其他人发现这一点，从 Store 中删除记录只会将其从该 store 实例中删除，而不是从存储机制（例如，localstorage）中删除。如果你想这样做，你必须使用模型对象上的[`erase`方法。](http://docs.sencha.com/touch/2-1/#!/api/Ext.data.Model-method-erase)

```
store.remove(record); // may not even be necessary
record.erase();
store.sync(); 
```

# sql - 创建触发器以删除记录

> ID：13260218
> 
> 赞同：0
> 
> 时间：2012-11-06T22:08:52.173
> 
> 标签：sql, postgresql, triggers

我有一张桌子，我们可以称之为甲板。甲板有一个 id 用作其主键以及其他一些属性。卡片表包含一个对卡片组 ID 的外键引用，并且还有一个主键 cardid。存在另一个名为 answers 的表，其中它的外键是 cardid。

因此，为了从套牌中删除，数据库要求我先从答案中删除，然后是卡片，最后从套牌中删除。

我想创建一个触发器来处理第一次和第二次删除，这样我只需要从卡组表中指定一个删除语句即可完全销毁卡组。

下面是我找到的一个示例 PostgreSQL 触发器，但我不确定它是否可以做我所要求的，因为我无法在网上找到任何人以这种方式创建触发器的示例。

```
CREATE OR REPLACE FUNCTION autoCalculate() RETURNS TRIGGER AS $$
        BEGIN

        IF NEW.wins < 0 THEN
                RAISE EXCEPTION 'Wins cannot be negative';
        END IF;

        IF(OLD.wins <> NEW.wins_ OR (OLD.losses <> NEW.losses) THEN
                NEW.Winning_Percentage := calc_winning_percentage(NEW.Wins, NEW.Losses);
        END IF

        RETURN NEW;
        END;
$$ LANGUAGE plpgsql;

DROP TRIGGER update_winning_percentage ON standings;
CREATE TRIGGER update_winning_percentage BEFORE INSERT OR UPDATE ON standings
FOR EACH ROW EXECUTE PROCEDURE autoCalculate(); 
```

如果有人知道这样做，如果他们可以将我推向正确的方向或提供如何做到这一点的示例，我将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:18:21.583

在 Postgres 8.2 中，您可以指定`On Delete Casacde`何时定义外键关系。

[http://www.postgresql.org/docs/8.2/static/ddl-constraints.html](http://www.postgresql.org/docs/8.2/static/ddl-constraints.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:19:52.223

在您的[外键](http://www.postgresql.org/docs/9.1/static/ddl-constraints.html#DDL-CONSTRAINTS-FK)定义上使用 ON DELETE CASCADE ，它会为您解决这个问题

# c++ - 角色上的跳转功能

> ID：13260221
> 
> 赞同：1
> 
> 时间：2012-11-06T22:09:20.853
> 
> 标签：c++, sdl

我正在创建这个 2D 游戏，但我遇到了 Jump 功能的问题。它有效，角色上下跳跃，但我希望能够在角色在空中跳跃然后移动角色，例如它可以跳到平台上。我正在使用 SDLK...

```
case SDL_KEYDOWN:   
        switch (event.key.keysym.sym){
            RArrow = (event.button.button = SDLK_RIGHT);
            Jump = (event.button.button = SDLK_SPACE);

            if((RArrow) && (Jump))
            {
            if(g->getPlayer()->worldY = GROUND_LEVEL)
                {
                    g->getPlayer()->jump();
                    g->getPlayer()->move(10);
                }
            }
            break; 
```

这是我尝试过的方法之一。我还尝试在跳转案例中创建一个切换功能以向左或向右导航，但我要么没有正确编码，要么就是没有工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:12:22.677

我不熟悉 SDLK 以及这在实际游戏开发中是如何完成的。但是，我实现这一点的一种方法是查看是否在每个游戏滴答声上都按下了两个键。因此，如果按下 w+d，角色将同时向上和向右。但在我看来，这是一个骇人听闻的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:38:04.337

列出实现后，看起来角色只有在地面上时才会向右移动。您需要更改代码，以便每次滴答声，游戏都会检查角色是否在跳跃，如果是，则将角色朝其面对/跳跃的方向移动。此代码可能需要位于您的事件处理程序之外。

理想情况下，您的键盘事件处理程序只需在角色上设置一个标志，指示他们正在跳跃以及向哪个方向跳跃，然后在您的游戏循环中调用 update() 方法，该方法实际处理跳跃（并在角色碰撞时停止跳跃）世界几何，如地板或墙壁）。

希望这可以帮助！

**编辑：**

没有看到你的代码的其余部分，我不能说更多。我对 C++ 也不是很好，我假设它使用它。您可以实现的一种方法是：

*   将“g->getPlayer()->jump()”替换为“g->getPlayer()->setJumping()”。
*   在角色上执行“setJumping()”来设置跳跃标志。
*   在游戏循环中，调用“g->getPlayer()->updatePos()”
*   在角色上实现“updatePos()”以更新角色的位置。在此，检查跳跃标志，如果为真，则根据您的跳跃算法更新位置。

# drupal - Drupal 7 主题：hook_theme 或 drupal_get_form

> ID：13260222
> 
> 赞同：0
> 
> 时间：2012-11-06T22:09:27.193
> 
> 标签：drupal, drupal-7, drupal-theming

我想知道哪个是在页面上显示表单的最佳方式（例如：vip 用户的注册表单......而不是在一个块中，而是作为主要内容）。

user_menu (*hook_menu*) 中的 user.module*方式：*

```
 $items['vip/register'] = array(
    'title' => 'Create new vip account',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('vip_register_form'),
    'access callback' => 'user_register_access',
    'type' => MENU_LOCAL_TASK,
  ); 
```

或者通过 use_theme (*hook_theme*) (fictive) 创建一个主题：

```
$items['vip/register'] = array(
    'title' => 'Create new vip account',
    'page callback' => 'theme',
    'page arguments' => array('vip_register'),
    'access callback' => 'user_register_access',
    'type' => MENU_LOCAL_TASK,
);

function user_theme() {
  return array(
    'vip_register' => array(
    )
  );
}

function theme_vip_register(){
    return drupal_get_form('vip_register_form');
} 
```

我想知道这是出于主题目的，因为设计师将在之后进行图形集成。

谢谢你的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T02:17:51.173

这不是一个实际的答案，但我不太确定你的问题是什么。Drupal 风俗#1：永远不要破解核心！

顾名思义，主题功能只是为*某事*设置主题。因此，您需要先构建表单。

```
$items['vip/register'] = array(
    'title' => 'Create new vip account',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('vip_register_form'),
    'access callback' => 'user_register_access',
    'type' => MENU_LOCAL_TASK,
  ); 
```

当用户访问 example.com/vip/register 页面时，将使用参数 vip_register_form 调用 drupal_get_form 函数。

所以现在你需要定义一个函数来返回这个（vip 用户注册）表单。

```
function vip_register_form($form, &$form_state){
  ..your FAPI stuff here.
  return $form;
} 
```

现在打开 vip 注册页面的用户将看到此表单*而不是*常规表单。除非您添加它们，否则即使密码和用户名字段也将不可用。如果要更改现有表单，只需将菜单挂钩复制到新路径：

```
$user_menu_routers = user_menu();
$items['vip/register'] = $user_menu_routers['user/register']; 
```

现在您可以使用 form_alter 钩子在 vip/register 页面（与普通用户注册页面相同）更改您的表单。您可以手动设置表单主题，而不会影响现有表单。

# wordpress - 可以在 magento 中使用 wordpress 插件吗？

> ID：13260227
> 
> 赞同：-1
> 
> 时间：2012-11-06T22:09:55.393
> 
> 标签：wordpress, magento

我只是有点怀疑。。

我可以在 Magento CMS 中使用 wordpress 吗.....我的意思是我可以在 magento 中安装 wordpress 插件吗...我问 Magento 的原因是因为，我要使用 magento 模板，此外我还需要在其中使用 wordpress 插件..我需要两个..

那么，这可能吗..？

虽然我的研究，我发现了一些链接，但我仍然不清楚这一点..

这是我找到的一些链接：

```
http://wordpress.org/extend/plugins/magento-wordpress-integration/
https://www.x.com/devzone/articles/magento-part-4-integrating-magento-and-wordpress-using-fishpig-extension 
```

**那么，任何人都可以澄清这一点..？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:19:56.713

答：没有。您不能直接在 Magento 中使用专门为 WordPress（并基于其框架）制作的 WordPress 插件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T01:28:41.650

不，您不能将 WordPress 插件与 Magento 一起使用。它们具有截然不同的架构。

您链接到的集成文章正在讨论在同一网站上同时使用 WordPress 和 Magento。

从理论上讲，您可以为一个同时操作另一个使用的数据库的插件编写一个插件，但这可能是一项自定义工作，而不是您可以随便下载的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T01:24:17.620

我认为这是不可能的......因为他们有不同的后端架构

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T02:39:04.953

如果您想在 Magento 中使用各种 Wordpress 插件，如前所述，简短的回答是否定的。

通过您提供的链接，您可以实现以下目标：

1.  使用 wordpress 插件（您提供的链接），您可以拥有 yourwordpress.com，然后在文件夹中安装 Magento，这样 Magento 商店就可以使用。例如，在 yourwordpress.com/magentostore/ 中，您可以轻松地在您的 Wordpress 站点中显示您商店中的任何 Magento 块（顶部链接、类别、分层导航块等）。

2.  使用 Magento 插件（我会使用 FishPig [http://www.magentocommerce.com/magento-connect/wordpress-integration.html](http://www.magentocommerce.com/magento-connect/wordpress-integration.html)）你可以有相反的：yourmagentostore.com 和 Wordpress blog/site 在你的 Magento 的 blog 文件夹中安装 yourmagentostore.com/wordpressblog/ 然后您就可以在您的 wordpress 站点中显示 Magento 的页脚和页眉，并显示例如 Magento 中的最新博客文章

agento希望这个帮助！

# objective-c - UIButton addTarget 方法...不起作用？

> ID：13260228
> 
> 赞同：1
> 
> 时间：2012-11-06T22:10:07.830
> 
> 标签：objective-c, ios, uisegmentedcontrol, uiactionsheet

我有一个类变量，它是 的一个实例`UIActionSheet`，称为 actionSheet。我添加了一个实例`UIPickerView`以及一个实例`UISegmentedControl`。虽然当我点击“完成”按钮（UISegmentedControl 的实例）时，我的类方法dismissActionSheet 永远不会被调用。谁能帮我吗？

```
//@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

-(IBAction)chooseTopicButtonPressed{

    actionSheet = [[UIActionSheet alloc] initWithTitle:nil
                                                             delegate:nil
                                                    cancelButtonTitle:nil
                                               destructiveButtonTitle:nil
                                                    otherButtonTitles:nil];

    [actionSheet setActionSheetStyle:UIActionSheetStyleBlackTranslucent];

    CGRect pickerFrame = CGRectMake(0, 40, 0, 0);

    UIPickerView *pickerView = [[UIPickerView alloc] initWithFrame:pickerFrame];
    pickerView.showsSelectionIndicator = YES;
    pickerView.dataSource = singlePicker.dataSource;
    pickerView.delegate = singlePicker.delegate;

    [actionSheet addSubview:pickerView];

    UISegmentedControl *closeButton = [[UISegmentedControl alloc] initWithItems:[NSArray arrayWithObject:@"Done"]];
    closeButton.momentary = YES;
    closeButton.frame = CGRectMake(10, 6, 300, 30);
    closeButton.segmentedControlStyle = UISegmentedControlStyleBar;
    closeButton.tintColor = [UIColor blueColor];
    [closeButton addTarget:self action:@selector(dismissActionSheet:) forControlEvents:UIControlEventTouchUpInside];

    //dismissActionSheet NOT BEING CALLED FOR SOME REASON!!! 

    [actionSheet addSubview:closeButton];

    [actionSheet showInView:[[UIApplication sharedApplication] keyWindow]];

    [actionSheet setBounds:CGRectMake(0, 0, 320, 485)];
}

-(void)dismissActionSheet{
    NSLog(@"dismissActionSheet called");
    [actionSheet dismissWithClickedButtonIndex:0 animated:YES];

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:19:35.910

该方法`dismissActionSheet`没有任何参数，因此`@selector`应如下所示：

```
[closeButton addTarget:self action:@selector(dismissActionSheet) forControlEvents:UIControlEventTouchUpInside]; 
```

# drupal-7 - Triggering_element 始终显示第一个按钮

> ID：13260229
> 
> 赞同：1
> 
> 时间：2012-11-06T22:10:17.100
> 
> 标签：drupal-7, drupal-modules, drupal-fapi, drupal-forms

我有一个包含多个部分的表格。每个部分都有一个“#states”属性，根据上一步中选择的内容，它可以显示或隐藏。每个部分中都有一个用于添加或删除字段的按钮。单击其中一个按钮通过 AJAX 调用一个函数。此函数使用 $form_state['triggering_element']['#name'] 来找出单击了哪个按钮，从而将字段添加到适当的部分。问题是无论哪个部分可见，triggering_element 似乎总是第一部分中的按钮。我不想把所有的代码都放在这里，因为它很长。以下是几个按钮的外观以及单击它调用的函数和最终回调：

```
$form['survey']['contents']['addsurvey'] = array(
    '#type' => 'submit',
    '#default_value' => t('Add Another Survey Question'),
    '#submit' => array('touchpoints_metrics_add_one'),
    '#limit_validation_errors' => array(),
    '#name' => 'add-survey',
    '#ajax' => array(
        'callback' => 'touchpoints_metrics_callback',
        'wrapper' => 'survey-div',
    ),
);

$form['mysteryshop']['contents']['addmystery'] = array(
        '#type' => 'submit',
        '#default_value' => t('Add Another Observation'),
        '#submit' => array('touchpoints_metrics_add_one'),
        '#limit_validation_errors' => array(),
        '#name' => 'add-mystery',
        '#ajax' => array(
            'callback' => 'touchpoints_metrics_callback',
            'wrapper' => 'mysteryshop-div',
        ),
    );

function touchpoints_metrics_add_one($form, &$form_state) {
    $element = $form_state['triggering_element']['#name'];
    $tracker = '';
    if (strpos($element, 'survey')) {
        $tracker = 'num_surveys';
    } elseif (strpos($element, 'mystery')) {
        $tracker = 'num_mystery';
    } elseif (strpos($element, 'budget')) {
        $tracker = 'num_budget';
    } elseif (strpos($element, 'incdec')) {
        $tracker = 'num_incdec';
    } elseif (strpos($element, 'roi')) {
        $tracker = 'num_roi';
    } elseif (strpos($element, 'epu')) {
        $tracker = 'num_epu';
    } elseif (strpos($element, 'response')) {
        $tracker = 'num_response';
    } elseif (strpos($element, 'numcomplete')) {
        $tracker = 'num_numcomplete';
    } elseif (strpos($element, 'perccap')) {
        $tracker = 'num_perccap';
    }
    $form_state[$tracker]++;
    $form_state['rebuild'] = TRUE;
 }

function touchpoints_metrics_callback($form, &$form_state) {
    $element = $form_state['triggering_element']['#name'];
    $tracker = '';
    if (strpos($element, 'survey')) {
        $tracker = 'survey';
    } elseif (strpos($element, 'mystery')) {
        $tracker = 'mysteryshop';
    } elseif (strpos($element, 'budget')) {
        $tracker = 'budget';
    } elseif (strpos($element, 'incdec')) {
        $tracker = 'incdec';
    } elseif (strpos($element, 'roi')) {
        $tracker = 'roi';
    } elseif (strpos($element, 'epu')) {
        $tracker = 'epu';
    } elseif (strpos($element, 'response')) {
        $tracker = 'response';
    } elseif (strpos($element, 'numcomplete')) {
        $tracker = 'numcomplete';
    } elseif (strpos($element, 'perccap')) {
        $tracker = 'perccap';
    }
    return $form[$tracker]['contents'];

} 
```

# python - 在线计算彩票中奖券的功能

> ID：13260234
> 
> 赞同：2
> 
> 时间：2012-11-06T22:10:44.413
> 
> 标签：python, list, statistics, counter

我有 Lotto（彩票）的优惠券：

```
coupons = [[1,4,7,34,45,67], [2,8,16,34,35,38] ... ] 
```

结果：

```
result = [7,12,13,26,29,34] 
```

我如何在一条线上计算我在优惠券上的中奖**号码**？我想要返回统计信息，例如这样：

```
statistics = [20, 15, 11, 1, 0, 0, 0] 
```

在哪里

statistics[0] - 中奖号码为 0 的优惠券数量，

统计[1] - 1个中奖号码的优惠券数量，

统计[2] - 2个中奖号码的优惠券数量，

统计[3] - 3个中奖号码的优惠券数量，

统计[4] - 4个中奖号码的优惠券数量，

统计[5] - 5个中奖号码的优惠券数量，

统计[6] - 6个中奖号码的优惠券数量

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:21:04.030

如果您不将导入算作“一行”，那么这将在一行中产生您的结果：

```
>>> coupons = [[1,4,7,34,45,67], [2,8,16,34,35,38], [1,4,7,13,55],
               [7,12,13,26,29,19]]
>>> result = [7,12,13,26,29,34]
>>>
>>> import collections
>>> collections.Counter(len(set(c).intersection(set(result))) for c in coupons)
Counter({2: 2, 1: 1, 5: 1}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T22:22:49.047

试试这个：

```
from collections import Counter

coupons = [[1,4,7,34,45,67]  , [2,8,16,34,35,38],
           [7,12,13,26,29,34], [1,2,3,4,5,6]]
result  = [7,12,13,26,29,34]

answer = Counter([6-len(set(result)-set(s)) for s in coupons]) 
```

最后一行是请求的单行。请注意，我必须更改内部使用的数据结构才能正常工作——优惠券和结果现在都以*集合*的形式表示，结果存储在`Counter`（一种特殊的字典）中，但所有的答案实际用途表现为数组：

```
answer[0]
> 1

...

answer[6]
> 1 
```

**更新**

好的，我设法在一行中将转换压缩为实际列表。它效率*不*高（最好使用我上面的第一个解决方案），但见鬼，它有效，而且它在一行中：

```
[Counter([6-len(set(result)-set(s)) for s in coupons])[x] for x in xrange(7)] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T22:20:56.087

以下将完成这项工作：

```
from collections import *
cnt = defaultdict(int, Counter(len(set(result) & set(c)) for c in coupons))
statistics = [cnt[n] for n in range(7)] 
```

这可以通过用分号分隔三个语句来简单地组合成一个单行语句，尽管除了使代码更难阅读之外，我看不到这会实现什么。

如果`statistics`不必是列表，您可以删除对`defaultdict()`最后一行的调用，并`Counter`直接使用实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T22:14:05.720

首先编写一个函数，返回适当的盒子，给定一张乐透彩票和中奖号码，即你的例子

```
ticket = [1,4,7,34,45,67]
result = [7,12,13,26,29,34] 
```

将返回 2。

然后，编写一个遍历整个票证数组的函数，根据第一个函数的返回值递增适当的数组索引。

编辑：哦，一行代码，还是一行数组？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T22:21:42.187

如果你使用 numpy 它很容易（但有点难看）：

```
coupon=np.random.randint(0,100,(50,6)) % 50 coupons with 6 numbers between 0-99
statistics=np.random.randint(0,100,(6,))

np.histogram(np.sum((coupon==statistics[0]) | (coupon==statistics[1]) | (coupon==statistics[2]) | (coupon==statistics[3]) | (coupon==statistics[4]) | (coupon==statistics[5]),1),bins=np.arange(0,7)) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-06T22:27:45.233

```
coupons = [[1,4,7,34,45,67], [2,8,16,34,35,38] … ]
result = [7,12,13,26,29,34] 
```

如果`coupons`/中数字的位置`result`无关紧要（`coupon`有 4 个中奖号码，即使它们与 in 的位置不同`result`），那么这将起作用（如果没有重复的数字并且你不这样做会更好）必须与此类重复数字的出现频率相匹配）：

```
result = set(result)
statistics = [len([coupon for coupon in coupons if len(set(coupon).intersection(result))==i]) for i in range(len(result))] 
```

但是，这是非常低效的 (O(n^2))。我会建议一种基于字典的方法和排序：

```
def getStats:
    result = set(result)
    statistics = [0]*len(result)
    for coupon in coupons:
        statistics[len(set(coupon).intersection(result))] += 1
    return statistics 
```

# installation - 通过 tox 安装 pysqlite

> ID：13260244
> 
> 赞同：1
> 
> 时间：2012-11-06T22:11:40.043
> 
> 标签：installation, pip, pysqlite, tox

我有几个测试文件夹设置为使用 tox。他们都有 pysqlite 作为要求，无论是对于包本身，还是为了运行测试。我一直在使用 tox 运行这些包，最近，我注意到 tox 在尝试安装 pysqlite 时失败了。

问题来自 pysqlite setup.cfg。默认情况下，它具有以下几行：

```
[build_ext]
#define=
#include_dirs=/usr/local/include
#library_dirs=/usr/local/lib
libraries=sqlite3
define=SQLITE_OMIT_LOAD_EXTENSION 
```

为了正确安装它，我进入这个文件并取消注释掉注释掉的三行。AFAIK 这不能通过 pip/tox 自动化。

我知道 tox.ini 中的 sitepackages 变量，但是启用它会导致一些问题，而其他包中使用的版本不正确。

有没有办法将 pysqlite 安装到 tox virtualenvs？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-22T22:03:38.503

找到了解决方案。

如下设置 tox.ini：

```
[testenv]
setenv=LIBRARY_PATH=/usr/local/lib
       CPATH=/usr/local/include
deps=pysqlite 
```

这将在 tox 使用 pip 设置 virtualenv 依赖项之前设置 library_path 和 CPATH。之后一切顺利。

注意：这需要 tox 0.9 或更高

# r - 从 R 脚本中提取函数的更好方法？

> ID：13260252
> 
> 赞同：3
> 
> 时间：2012-11-06T22:12:13.697
> 
> 标签：r, bash, function, split

假设我有一个文件“myfuncs.R”，其中包含一些函数：

```
A <- function(x) x
B <- function(y) y
C <- function(z) z 
```

我想将“myfuncs.R”中包含的所有函数放入它们自己的文件中，并适当命名。我有一个简单的 Bash-shell 脚本来提取函数并将它们放在单独的文件中：

```
split -p "function\(" myfuncs.R tmpfunc
grep "function(" tmpfunc* | awk '{
  # strip first-instances of function assignment
  sub("<-", " ")
  sub("=", " ")
  sub(":", " ")  # and colon introduced by grep
  mv=$1
  mvto=sprintf("func_%s.R",$2)
  print "mv", mv, mvto
}' | sh 
```

留给我：

```
func_A.R
func_B.R
func_C.R 
```

但是，这个脚本有明显的局限性。例如，当函数“A”具有嵌套函数时，它会出现异常：

```
A <- function(x){
    Aa <- function(x){x}
    return(Aa)
} 
```

如果整个函数在一行上，则完全失败。

有谁知道一种更强大、更不容易出错的方法来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T22:16:10.250

获取您的函数，然后键入`package.skeleton()`

将为每个功能制作单独的文件。

# jsf-2 - Primefaces SelectOneMenu 与列表中的对象翻转选择

> ID：13260255
> 
> 赞同：2
> 
> 时间：2012-11-06T22:12:35.230
> 
> 标签：jsf-2, primefaces, omnifaces

的 setter 方法`selectedRestaurant`被调用，但菜单只是向后翻转并且不呈现`<h:outputText>`. Menu 有内容，所以使用的 List`<f:selectItems>`不为空。当我使用时，`omnifaces.SelectItemsConverter`我想这不是由于转换问题。

这是我的 JSF 代码：

```
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui">
<h:head />
<h:body>
    <h:panelGroup id="adminOneMenu" layout="block">
    <h:form>

    <p:selectOneMenu value="#{bugBean.selectedRestaurant}" converter="omnifaces.SelectItemsConverter">
        <f:selectItem itemValue="" itemLabel="Restaurant wählen"/> 
        <f:selectItems value="#{bugBean.restaurants('London')}" var="restaurant" itemLabel="#{restaurant.screenName}"/>
        <p:ajax update=":adminOneMenu"/>
    </p:selectOneMenu>  

    <h:outputText value="#{bugBean.selectedRestaurant.screenName}" />
    </h:form>
    </h:panelGroup>

</h:body>
</html> 
```

这是支持 bean：

```
package huhu.main.managebean;

import java.io.Serializable;
import java.util.List;

import javax.ejb.EJB;
import javax.enterprise.context.SessionScoped;
import javax.inject.Named;

import huhu.model.generated.Restaurant;
import huhu.service.RestaurantService;

@Named
@SessionScoped
public class BugBean implements Serializable {

   private static final long serialVersionUID = 1L;
   private Restaurant selectedRestaurant;

   @EJB
   RestaurantService rs;

   public List<Restaurant> getRestaurants(String city){
       List<Restaurant> restaurants;
       restaurants = rs.getRestaurantsInCity(city);
       return restaurants;
   }

   public Restaurant getSelectedRestaurant() {
      return selectedRestaurant;
   }

   public void setSelectedRestaurant(Restaurant selectedRestaurant) {
      this.selectedRestaurant = selectedRestaurant;
   }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T22:29:48.050

如果出现转换错误，您应该会收到一条错误消息。

你在餐厅类中实现了#equals() 和#hashcode() 吗？

# matlab - 如何制作 matlab GUI 的“试用版”

> ID：13260256
> 
> 赞同：4
> 
> 时间：2012-11-06T22:12:38.397
> 
> 标签：matlab, user-interface

我的目标是制作一个 GUI，然后使用 deploytool 从中制作一个 exe 文件。因为我不希望用户能够永远使用它，所以我想将其作为试用版，这意味着它只能在一段时间内工作。

我想可能是通过某种方式连接到用户的计算机时钟和日期，并使用代码来限制时间，但我发现这个逻辑存在一些问题。

有什么想法，怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T23:42:28.327

使用计算机的时钟似乎是一种合理的方法。当然，用户不会通过更改时钟来阻止这一点，但这很可能会造成足够的不便，以至于他们宁愿支付合理的软件价格。

只需将以下内容放入`OpeningFcn`您的 GUI 中

```
expiryDate = '2012-12-31';

if now > datenum(expiryDate)
    h = errordlg('please upgrade to a full license');
    uiwait(h)
    return %# or throw an error
end 
```

# html - 使用浮动元素填充区域

> ID：13260258
> 
> 赞同：1
> 
> 时间：2012-11-06T22:12:56.113
> 
> 标签：html, css, css-float

我正在使用带有 float:left 的 DIV

当 DIV 2 增加大小时

我们得到这样的东西：

```
+---+ +----+
| 1 | |    |
+---+ |    |
      |  2 |
      |    |
      |    |
      +----+
+---+
| 3 |
+---+ 
```

有没有办法实现这一点：

```
+---+ +----+
| 1 | |    |
+---+ |    |
+---+ |  2 |
| 3 | |    |
+---+ |    |
      +----+ 
```

无需求助于jquery？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T05:43:30.970

您可以为此使用纯 CSS3 **:nth-child**属性。像这样写：

```
.innerdiv:nth-child(even){
    float:right;
    border-color:red;
} 
```

检查这个[http://jsfiddle.net/RsYgR/1/](http://jsfiddle.net/RsYgR/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:15:59.527

```
<div class="left" style="float: left;">
    <div class="box1"></div>
    <div class="box2"></div>
    <div class="box3"></div>
    .......
    <div class="boxN"></div>
</div>
<div class="right" style="float: right;"></div> 
```

这适用于任意数量的框，就像左边有两列会在高度上伸展，右边也会伸展。

这是实际代码：http: [//jsfiddle.net/SVbyj/](http://jsfiddle.net/SVbyj/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T01:20:49.033

所以这是我想出的最佳解决方案：

```
for (var i = 0; i < box.length; i++) {  //json array with box info
    createHTML.box(i);  //creates boxes with id="#box_"+i
    if(isEven(i))
        $("#box_"+i).css( "float","right" );
    else
        $("#box_"+i).css( "float","left" );
} 
```

是偶函数

```
 function isEven(n) 
 {
     return (n % 2 == 0);
 } 
```

我知道我需要一些 jquery ..

完美运行

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-06T22:15:18.910

如果您将它们包装在一个 div 中，那么它应该可以工作。

```
 <div id="bothleftnright"> 
     <div id="float-left" style="float:left;"></div>
     <div id="float-left2" style="float:left;"></div>
     <div id="float-right" style-"float:right;"></div>
  </div> 
```

只要外部 div 的高度适合所有 3 个 div，它就应该解决这个问题。

不知道为什么投反对票，请发表评论

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-08T10:33:17.463

只需将您的两个左侧框放在一个列中，该列浮动到右侧列的左侧。

IE

```
<div class="column1" style="float:left;">
<div  class="box1">
    Here is box 1
</div>
<div  class="box3">
    Here is box 3
</div>
</div>
<div class="column2" style="float:right;">
    <div  class="box2">
        Here is box 2
    </div>
</div> 
```

# javascript - JavaScript setTimeout 不起作用

> ID：13260261
> 
> 赞同：3
> 
> 时间：2012-11-06T22:13:14.250
> 
> 标签：javascript, jquery, settimeout, onload

我想要一个 JavaScript 函数在页面加载后 60 秒运行。经过一番研究，我发现 setTimeout() 是解决方案。

所以这就是我所做的：

```
<body onLoad="setTimeout(postAction('news.reads', 'article'), 60000);"> 
```

不知何故， setTimeout 不起作用。页面加载后，无需等待 60 秒，因为 postAction() 会立即运行。

为什么会这样？如何解决？那里有 setTimeout() 的替代品吗？谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-06T22:25:49.597

You need to wrap `postAction` in a function to defer execution:

```
setTimeout(function() { postAction('news.reads', 'article'); }, 60000); 
```

You are actually executing `postAction` immediately, your code is equivalent to:

```
var result = postAction('news.reads', 'article');

setTimeout(result, 60000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:16:09.267

您是否使用`setTimeout`类似：

```
setTimeout(function(){alert("OK");}, 1000 * 60); // alert "OK" in 60s 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T22:23:12.710

在 JS 中做你想做的事情的正确方法，即在页面加载*后设置超时：*

```
(function(w)
{
    var load = function()
    {
         setTimeout(postAction,60000);
         if (w.removeEventListener)
         {//remove listeners, to avoid leak...
             return w.removeEventListener('load',load,false);
         }
         return w.attachEvent('onload',load);
    };
    if (w.addEventListener)
    {
        return w.addEventListener('load',load,false);
    }
    return w.attachEvent('onload',load);
}(this)); 
```

而不是`window.onload = function(){setTimeout(postAction,60000);};`, 这也可以，但会导致 IE <9 中的内存泄漏。那只是为了完整起见
无论如何，这里的关键是`setTimeout(postAction,60000);`

*Update*
After seeing the code you're using, this is the easiest fix:

```
<body onLoad="setTimeout(function(){ return postAction('news.reads', 'article');}, 60000);"> 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-06T22:16:57.860

```
<script>
        function doSomeJavascript() {
            // javascript code goes here
           alert('5 secs is up!');
        }
        // calls function doSomeJavascript() 5 secs after page load
        var interval = setInterval(doSomeJavascript, 5000);

        setTimeout(function() {
           window.clearInterval(interval);
        }, 5000);
</script> 
```

# sql - 字段内用逗号分隔的数据与新表

> ID：13260262
> 
> 赞同：3
> 
> 时间：2012-11-06T22:13:19.543
> 
> 标签：sql, database, database-design

> **可能重复：**
> [在数据库列中存储逗号分隔列表真的那么糟糕吗？](https://stackoverflow.com/questions/3653462/is-storing-a-comma-separated-list-in-a-database-column-really-that-bad)

这是我在尝试扩展数据库时经常遇到的问题。

例如：

我想跟踪有多少用户在我的网站上看到了特定文章，因此在数据库中我向表中添加了一个`views`字段`article`。现在，如果我想确保这些是*独特的*观点，那么这显然是不够的。

因此，假设在我的设计中，我可以使用与 IP 或其他东西一起存储的单个数字来识别用户（或至少是一台计算机）。

那么，如果我想跟踪有多少*独立*用户看过一篇特定的文章，那么最好的方法是什么？

*   `article_views`使用字段`article_id`和 创建另一个表`user_id`。
*   `user_id`将用逗号分隔的 s 保存在表的`views`字段内`article`。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T22:15:52.153

永远，永远，永远选择逗号分隔的解决方案。它违反了数据库设计的每一条原则。而是创建一个单独的表。

在您的特定情况下，使用 (article_id, user_id) 上的 PRIMARY KEY 创建表。然后数据库将禁止重复记录的输入。根据您的 SQL 引擎，您还可以使用 INSERT OR IGNORE（或等效项）来避免引发异常。

另一种解决方案要求您在所有接触数据的应用程序中强制执行唯一性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T22:16:31.013

不要使用逗号分隔值。曾经。创建一个单独的表，将所有这些 Id 链接到查看的文章。

很简单的设计。这将是一个有两列的表，都是外键。一个到文章表，另一个到用户表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T03:40:21.063

您是否考虑过使用

```
SELECT COUNT(DISTINCT User + IP) As UniqueViews FROM Views GROUP BY ArticleID 
```

如果您的视图表包含针对用户和 IP 的重复记录（即每天每 cilck 10 次或其他内容），则 COUTN(DISTINCT) 将计算它们的不同出现次数，而不是记录的数量。

# c++ - 推导可变参数模板参数失败？

> ID：13260264
> 
> 赞同：1
> 
> 时间：2012-11-06T22:13:25.580
> 
> 标签：c++, templates, c++11, function-pointers, variadic-templates

解释以下测试用例无法编译的根本原因是什么：

```
#include <iostream>
#include <vector>
#include <numeric>
#include <algorithm>

template<typename Type, typename... Args> 
void apply(std::vector<Type> &v, Args... args, void(*algo)(Type*, Type*, Args...))
{
    algo(&*v.begin(), &*v.end(), args...);
}

int main()
{
    std::vector<int> v(10, 50);
    apply(v, 3, std::iota);
    for (unsigned int i = 0; i < v.size(); ++i) {
       std::cout<<v[i]<<std::endl;
    }
} 
```

函数原型是否有解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:26:11.493

第一个问题是，正如编译器错误所说：

> 参数包必须位于参数列表的末尾。

换句话说，您必须声明您的函数`Args ... args`，列表中的最后一个参数也是如此。

另外，我不相信编译器会以您使用模板的方式推断模板函数的类型，因此您必须明确指定模板：

```
apply<int, int>(v, std::iota, 3); // or something 
```

[你的想法被提议的修改剪断了](http://ideone.com/kqcslg)

# ruby-on-rails - ENV['MY_RUBY_HOME'] 在尝试让 nginx 与 rvm 一起玩时为零

> ID：13260267
> 
> 赞同：0
> 
> 时间：2012-11-06T22:13:37.230
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, nginx, rvm

我想用 nginx 为 rails 应用程序提供服务。我已经使用 rvm gemset 设置了我的 gem。根据让 nginx 加载我的 gemset 的说明，我制作了一个 config/setup_load_paths.rb 文件[：](https://rvm.io/integration/passenger/)

```
if ENV['MY_RUBY_HOME'] && ENV['MY_RUBY_HOME'].include?('rvm')
  begin
    rvm_path     = File.dirname(File.dirname(ENV['MY_RUBY_HOME']))
    rvm_lib_path = File.join(rvm_path, 'lib')
    puts rvm_lib_path.inspect
    $LOAD_PATH.unshift rvm_lib_path
    require 'rvm'
    RVM.use_from_path! File.dirname(File.dirname(__FILE__))
  rescue LoadError
    # RVM is unavailable at this point.
    raise "RVM ruby lib is currently unavailable."
  end
end

ENV['BUNDLE_GEMFILE'] = File.expand_path('../Gemfile', File.dirname(__FILE__))
require 'bundler/setup' 
```

这似乎没有做到这一点。所以尝试调试时，我发现它`ENV['MY_RUBY_HOME']`实际上是 Nil，因此第一个代码块甚至没有运行。为什么这是零，我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T08:17:39.737

您遵循旧的说明，再次访问[https://rvm.io/integration/passenger/](https://rvm.io/integration/passenger/)并使用正确的代码`config/setup_load_paths.rb`：

```
if ENV['MY_RUBY_HOME'] && ENV['MY_RUBY_HOME'].include?('rvm')
  begin
    gems_path = ENV['MY_RUBY_HOME'].split(/@/)[0].sub(/rubies/,'gems')
    ENV['GEM_PATH'] = "#{gems_path}:#{gems_path}@global"
    require 'rvm'
    RVM.use_from_path! File.dirname(File.dirname(__FILE__))
  rescue LoadError
    raise "RVM gem is currently unavailable."
  end
end

# If you're not using Bundler at all, remove lines bellow
ENV['BUNDLE_GEMFILE'] = File.expand_path('../Gemfile', File.dirname(__FILE__))
require 'bundler/setup' 
```

# grep - grep 许多不同的字符串

> ID：13260269
> 
> 赞同：2
> 
> 时间：2012-11-06T22:13:46.677
> 
> 标签：grep

我有一个`strings.txt`包含 100 个字符串的文件，每个字符串占一行

```
string1
string2
...
string100 
```

对于这些字符串中的每一个，我想找到`file_to_look.txt`其中包含该字符串的所有行。现在，我可以像, then等一样运行`grep`100 次，但这对我来说会花费很多打字时间。`grep string1 file_to_look.txt``grep string2 file_to_look.txt`

有没有办法让我不用打那么多字？

编辑：只经历`file_to_look.txt`1 次而不是 100 次的解决方案会很棒，因为我`file_to_look.txt`的很大。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T22:27:42.390

`-f`用于传递（GNU）grep 模式文件。

```
grep -f strings.txt file_to_look.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:20:44.437

```
while read line; do grep "$line" file_to_look.txt; done < strings.txt 
```

这正是你所要求的。代替 ”;” 您认为合适的换行符。

xargs 是人们会建议的另一个选项。我的建议是通常首先寻找另一种选择，因为 xarg 有很多陷阱，可能会使事情变得非常错误。

[Greg 在 xargs 上的 bash wiki](http://mywiki.wooledge.org/UsingFind#Actions_in_bulk%3a_xargs.2C_-print0_and_-exec_.2B-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T22:22:40.963

通常 xargs 用于重复具有多个值的命令：

```
xargs -I{} grep {} file_to_look.txt < strings.txt 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T22:24:40.093

您可以使用 来执行此操作`while read`，如下所示：

```
cat strings.txt | while read line ; do grep "$line" file_to_look.txt ; done 
```

有关更多替代方法，请查看：

*   [如何将 shell 命令应用于命令输出的每一行？](https://stackoverflow.com/questions/2711001/how-to-apply-shell-command-to-each-line-of-a-command-output)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T22:32:47.120

您可以使用以下简短脚本执行此操作：

```
#!/bin/bash

file_name=string.txt
file_to_look=file_to_look.txt
patterns=$(tr '\n' '|' $filename)
patterns=${patterns%?} # remove the last |
grep -E $patterns $file_to_look 
```

这会将您的所有搜索模式汇总在一起，并`grep`使用该`-E`选项一次性将其交给，因此`grep`只需解析`file_to_look.txt`一次，而不是 100 次。

# scala - scala 类上的错误：递归方法 printExpr 需要结果类型

> ID：13260275
> 
> 赞同：7
> 
> 时间：2012-11-06T22:14:00.620
> 
> 标签：scala

我在网上遇到错误：

```
case Sum(l, r) => printExpr(l); print("+"); printExpr(r) 
```

错误是：

> 递归方法 printExpr 需要结果类型

这段代码对我来说看起来不错，我做错了什么？

```
abstract class Expr {

  case class Num(n: Int) extends Expr
  case class Sum(l: Expr , r: Expr) extends Expr
  case class Prod(l: Expr, r: Expr) extends Expr

  def evalExpr(e: Expr): Int = e match {
    case Num(n) => n
    case Sum(l, r) => evalExpr(l) + evalExpr(r)
    case Prod(l, r) => evalExpr(l) * evalExpr(r)
  }

  def printExpr(e: Expr) = e match {
    case Num(n) => print(" " + n + " ")
    case Sum(l, r) => printExpr(l); print("+"); printExpr(r)
    case Prod(l, r) => printExpr(l); print("x"); printExpr(r)
  }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-06T22:20:23.173

正如错误消息所述，Scala 中的递归方法需要明确声明的返回类型。

原因是 Scala 从方法体中使用的类型推断方法的返回类型。当方法的返回类型*影响*方法体中使用的类型时（因为它递归地调用自身），Scala 无法确定它应该分配给方法的类型，因此它要求您在源代码中这样做（就像你有的`evalExpr`，你明确地说它返回一个`Int`）。

在这种情况下，您希望`printExpr`有 return type `Unit`，这是没有信息的无趣值的类型。通常调用具有返回类型的方法`Unit`只是为了它的副作用（例如`print`）。

因此，您可以将标题行更改`printExpr`为：

```
def printExpr(e: Expr) : Unit = e match { 
```

或者，Scala 有一些用于声明“过程”的语法糖。您可以将“过程”视为不返回任何内容，只是执行一些代码，但实际上 Scala 中的每个方法都会返回*一些*内容；“过程”只是返回类型的方法`Unit`。这样做的语法是`=`在方法的标头之后省略，但是您*必须*用花括号将方法主体括起来（即使它是单个表达式，例如您的`match`）。所以你可以这样做：

```
def printExpr(e: Expr) {
  e match {
    ...
  }
} 
```

避免明确声明`Unit`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-06T22:21:13.763

Scala 编译不能为递归方法推断类型，因此您必须显式声明它：

```
def printExpr(e: Expr): Unit = e match { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T22:21:07.693

给一个返回类型`printExpr(e : Expr)`喜欢`String`或`Expr`例如

```
printExpr(e : Expr): Expr
printExpr(e : Expr): String 
```

# javascript - 使用 preload.js 和 create.js 加载图像？

> ID：13260277
> 
> 赞同：0
> 
> 时间：2012-11-06T22:14:16.340
> 
> 标签：javascript, windows-8

我正在跟进 Windows 8 的游戏开发教程[http://www.sitepoint.com/creating-a-simple-windows-8-game-with-javascript-game-basics-createjseaseljs/](http://www.sitepoint.com/creating-a-simple-windows-8-game-with-javascript-game-basics-createjseaseljs/)。本教程可能需要更新，因为在某些时候我必须在使用 PreloadJS 之前添加 createJS。

例子：

```
stage = new createjs.Stage(canvas);
preload = new createjs.PreloadJS(); 
```

否则调试会引发错误。

但是，当 bgImage 初始化时程序会中断。我可以使用任何提示代码吗？

```
bgImage = preload.getResult("screenImage").Result;
bgBitmap = new Bitmap(bgImage);
bgBitmap.scale_X = SCALE_X;
bgImage.scale_Y = SCALE_Y;
stage.addChild(bgBitmap);
stage.update(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T21:02:47.447

请确保您使用正确的语法。

```
var bgImage = preload.getResult("screenImage").result;
var bgBitmap = new createjs.Bitmap(bgImage);
stage.addChild(bgBitmap); 
```

还有什么是你得到的错误？这是一个应该有所帮助的快速示例。

```
function init() {
        canvas = document.getElementById("testCanvas");

        //check to see if we are running in a browser with touch support
        stage = new createjs.Stage(canvas);
        createjs.Ticker.setFPS(24);
        createjs.Ticker.addListener(stage);

        images = images || {};
        var manifest = [
            {src:"image.jpg", id:"image"}
        ]

        loader = new createjs.PreloadJS(false);
        loader.onFileLoad = handleFileLoad;
        loader.onComplete = handleComplete;
        loader.loadManifest(manifest);
    }

    function handleFileLoad(o) {
    //You could store all your images in object to call them easily.  
    if (o.type == "image") {
            images[o.id] = o.result;
        }
    }

    function handleComplete(event) {
        var bg = new createjs.Bitmap(loader.getResult("image").result);
        //OR samething
        //var bg = new createjs.Bitmap(images['image']);
        stage.addChild(bg);
    }

    function tick() {
        stage.update();
    } 
```

希望这可以帮助。

# php - CodeIgniter 的电子邮件编码不正确

> ID：13260284
> 
> 赞同：3
> 
> 时间：2012-11-06T22:14:41.020
> 
> 标签：php, codeigniter, email, encoding, codeigniter-2

现在数据库中的数据如下所示：

> Hej [indtaster_navn]<br><br>我禁止 med noget på ændring af xxxxxx er der behov for opfølgning på:<br><br>- xxxx<br>- xxxx<br>- xxxx<br><br>Jeg vil gerne have en tilbagemelding, når du har set på ovenstående.<br/><br/>Venlig hilsen<br/>[behandler_navn]<br/>TestGuy<br/><br/>[lokal_tlf] - lokal<br >00 00 00 00 - 电话<br>[behandler_email]<br><br>这个 S<br>东西<br>变形金刚 1234<br>3434 BubbleJ<br><br>​​​​​</p>

所以我在发送邮件时有以下代码，重要的是要注意我使用`html_entity_decode`：

```
 $config['mailtype'] = 'html';
    $config['priority'] = 1;
    $config['charset'] = 'utf-8';
    $this->email->initialize($config);
    $this->email->from($this->auth_data->user_email, $this->auth_data->user_firstname . ' ' . $this->auth_data->user_lastname);
    $this->email->reply_to($this->auth_data->user_email, $this->auth_data->user_firstname . ' ' . $this->auth_data->user_lastname);
    $this->email->to('test@test.com'); 
    $this->email->subject($feedback_title_temp);
    $this->email->message(html_entity_decode($feedback_temp));  
    $this->email->send(); 
```

`=`当我收到电子邮件时，它会随机插入符号，在某些情况下`<br>`甚至不会发生。

例如：

```
- xxxx<=r>- xxxx 
```

应该：

```
- xxxx
- xxxx 
```

当我在智能手机上查看电子邮件时，编码问题似乎只出现在`æåø`字符上，而 Outlook 则完全不同。

收到的邮件标题::

```
**Microsoft Mail Internet Headers Version 2.0
Subject: =?utf-8?Q?(ID:_418)?=
To: some@one.com
X-PHP-Originating-Script: 0:Email.php
User-Agent: CodeIgniter
Date: Wed, 7 Nov 2012 00:31:54 +0100
From: <mat@damn.com>
Return-Path: <mat@damn.com>
Reply-To: "Johnny Bravo" <mat@damn.com>
X-Sender: damn@test.com
X-Mailer: CodeIgniter
X-Priority: 1 (Highest)
Message-ID: <50999deab797d@test.com>
Mime-Version: 1.0
Content-Type: multipart/alternative; boundary="B_ALT_50999deab798e"
X-OriginalArrivalTime: 06 Nov 2012 23:31:54.0823 (UTC) FILETIME=[E8022570:01CDBC76]

--B_ALT_50999deab798e
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit

--B_ALT_50999deab798e
Content-Type: text/html; charset=utf-8
Content-Transfer-Encoding: quoted-printable

--B_ALT_50999deab798e--
** 
```

收到的邮件，根据内容不同，但错误很明显：

```
Det her er en m=sse tekst, det er bare en test fra en hæææst.

- Hehe
- Heh<=br>
- Wee

A=l these things

- Lots of text 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-08T17:34:52.933

```
$this->email->set_crlf( "\r\n" ); 
```

修复了问题！

# ruby - open_datagram_socket / open_udp_socket 中的 EventMachine RuntimeError 没有数据报套接字

> ID：13260289
> 
> 赞同：2
> 
> 时间：2012-11-06T22:15:06.977
> 
> 标签：ruby, sockets, udp, eventmachine

当我尝试`open_datagram_socket`在端口上时出现以下错误`1900`：

```
/Users/timbaas/.rvm/gems/ruby-1.9.3-p194/gems/eventmachine-1.0.0/lib/eventmachine.rb:859:in `open_udp_socket': no datagram socket (RuntimeError)
from /Users/timbaas/.rvm/gems/ruby-1.9.3-p194/gems/eventmachine-1.0.0/lib/eventmachine.rb:859:in `open_datagram_socket'
from /Users/timbaas/Applications/ruby/upnp/ssdp.rb:36:in `block in initialize'
from /Users/timbaas/.rvm/gems/ruby-1.9.3-p194/gems/eventmachine-1.0.0/lib/eventmachine.rb:187:in `call'
from /Users/timbaas/.rvm/gems/ruby-1.9.3-p194/gems/eventmachine-1.0.0/lib/eventmachine.rb:187:in `run_machine'
from /Users/timbaas/.rvm/gems/ruby-1.9.3-p194/gems/eventmachine-1.0.0/lib/eventmachine.rb:187:in `run'
from /Users/timbaas/Applications/ruby/upnp/ssdp.rb:35:in `initialize'
from upnp.rb:4:in `new'
from upnp.rb:4:in `<main>' 
```

我在 Ruby 1.9.3 上使用以下代码：

```
module SSDP

  IP = "239.255.255.250"
  PORT = 1900

  class Server < EM::Connection
    def receive_data(data)
      p "d" + data
    end
  end

  class Socket
    attr_accessor :socket

    def initialize
      EventMachine::run do
        @socket = EM::open_datagram_socket SSDP::IP, SSDP::PORT, SSDP::Server
        p "Started EchoServer on #{SSDP::IP}:#{SSDP::PORT}..."
      end
    end
  end
end

Socket.new 
```

当我使用端口`1901`时，它可以工作..

谢谢

# python - Python cos(90) 和 cos(270) 不是 0

> ID：13260296
> 
> 赞同：5
> 
> 时间：2012-11-06T22:15:50.513
> 
> 标签：python, math, trigonometry

到底是怎么回事？？

测试 sin 和 cos 函数，以找出为什么在将坐标输出到 SVG 文件时，我在错误的位置得到如此漂亮的定位。所以我做了这个测试代码，我可以预测答案是什么，找出原因。奇怪的是，没有任何影响它自己计算的行为，而只是我将要停留的位置。如果 position 为 0 并且计算后会变为 0 则不起作用，但如果 position 为 1 并且会在计算后变为 1 则有效。

第一次测试：

```
import math

cX = 2
cY = 2
r = 2

rcX = cX + (r * math.cos(math.radians(0)))
rcY = cY + (r * math.sin(math.radians(0)))

print rcX #4
print rcY #2
r = 1

rlX = rcX + (r * math.cos(math.radians(90)))
rlY = rcY + (r * math.sin(math.radians(90)))

print rlX #4
print rlY #3
r = 4

flX = rlX + (r * math.cos(math.radians(180)))
flY = rlY + (r * math.sin(math.radians(180)))

print flX #0
print flY #3
r = 2

print r * math.cos(math.radians(270))
print flX + (r * math.cos(math.radians(270))) #-3.67394039744e-16 should be 0
print flY + (r * math.sin(math.radians(270))) #1 
```

现在我将 cX 更改为 3，即使它不影响计算，它也可以工作：

```
r * math.cos(math.radians(270)) 
```

该计算的结果被添加到 x 坐标

```
import math

cX = 3
cY = 2
r = 2

rcX = cX + (r * math.cos(math.radians(0)))
rcY = cY + (r * math.sin(math.radians(0)))

print rcX #5
print rcY #2
r = 1

rlX = rcX + (r * math.cos(math.radians(90)))
rlY = rcY + (r * math.sin(math.radians(90)))

print rlX #5
print rlY #3
r = 4

flX = rlX + (r * math.cos(math.radians(180)))
flY = rlY + (r * math.sin(math.radians(180)))

print flX #1
print flY #3
r = 2

print r * math.cos(math.radians(270))
print flX + (r * math.cos(math.radians(270))) #1
print flY + (r * math.sin(math.radians(270))) #1 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-06T22:20:47.430

事实上，这是一个非常低的数字，非常接近于零。这是一篇很棒的文章，可以帮助您了解浮点数的常见挑战和陷阱：“[每个计算机科学家应该了解的浮点运算知识](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)”

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-06T22:19:45.060

您正在处理舍入错误，这在处理浮点数学时（大部分）是不可避免的（请参阅其他人已经链接的[论文](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)以准确了解发生了什么）。

在许多情况下，您可以减少它们的影响（通过以“智能”顺序执行操作或以更“浮点友好”的方式重新制定表达式），但在您的情况下，最简单的做法是将结果四舍五入，例如6 位小数，并对此感到满意。当然，您不需要更精确的定位，并且您将获得“规范”角度的预期结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-15T04:38:56.520

我今天必须使用 270 度的 cos、sin 和 tan 来完成一个项目。如果我没有用谷歌搜索结果来检查自己，我就不会知道有错误。（我知道无缘无故地将度数设为常数只是将其变成弧度是荒谬的，这就是他们想要的项目。）

只要我先将弧度四舍五入，cos 和 sin 就为我工作，但 tan 离我很远。

我通过手动进行数学运算并捕获无法除以 0 的错误并将其设置为未定义来修复切线：

```
 #variables for various trigonometric functions (sine, cosine and tangent) of 270 degrees
    DEGREE = 270
    RADIAN = round(m.radians(DEGREE), 3) #the degree has to be converted to a radian to input into the math.cos and math.sin functions
    COS = round(m.cos(RADIAN), 2) #pass the radian to get the cosine
    SIN = round(m.sin(RADIAN), 2) #pass the radian to get the sine

    try:
         # the math library did not return the correct answer for tangent when dividing by 0
         # so, I manually did the math, this catches the division by zero and correctly labels the tangent
         # as undefined
        tan = round(SIN/COS, 2)

    except:
        tan = "Undefined"

    print("\n\nMathematical Constants") #display a title for the list

    #headers list for each function
    headers = ["Pi", "e", "Sine(270\u00b0)", "Cosine(270\u00b0)", "Tangent(270\u00b0)"]
    #list of each constant
    dataList = [round(m.pi, 2), round(m.e, 2), SIN, COS , tan]

    #looping iterator to diplay each function
    i = 0
    while i < len(headers):
        print("------")
        print(headers[i] + ": " + str(dataList[i]))

        i += 1 #increase iterator by one 
```

# javascript - 如何使用console.log打印出一段代码是怎么调用的？

> ID：13260305
> 
> 赞同：0
> 
> 时间：2012-11-06T22:16:22.443
> 
> 标签：javascript, debugging

> **可能重复：**
> [你如何找出 JavaScript 中的调用者函数？](https://stackoverflow.com/questions/280389/how-do-you-find-out-the-caller-function-in-javascript)

如果我放入`console.log()`一个函数中，是否可以在`console.log()`语句中放入任何内容以找出调用该函数的位置？还是有其他方法可以找出函数的调用方式？

我试图理解一段相对复杂（对于我的经验来说很复杂）的代码，并且很难弄清楚是什么在调用某个函数。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T22:21:09.240

也许您正在寻找`console.trace()`？它打印出堆栈跟踪。

这是有关该功能的[Firebug 文档（](http://getfirebug.com/logging) [Webkit 也支持](https://stackoverflow.com/questions/55633/where-is-the-console-api-for-webkit-safari)该功能）：

> 只需调用 console.trace() ，Firebug 就会向控制台写入信息量很大的堆栈跟踪。它不仅会告诉您哪些函数在堆栈上，还会包括传递给每个函数的每个参数的值。您可以单击功能或对象以进一步检查它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:22:24.833

像这样使用它

```
console.log(arguments.callee.caller.toString()) 
```

# c# - 实体框架 5：代码优先的循环关系问题

> ID：13260306
> 
> 赞同：4
> 
> 时间：2012-11-06T22:16:28.183
> 
> 标签：c#, database, entity-framework, ef-code-first, foreign-keys

我理解为什么 EF 在 PK/FK 关系中不允许“循环引用”。我正在寻找有关如何更改我的模型以使以下场景起作用的建议。

### 设想

三个实体：`Employee`, `Agency`, `WorkRecord`. 他们的目的是记录员工花在工作上的时间。`Employee`然后包含对`Agency`他/她所雇用的人的引用，以及他/她对所做工作的`WorkRecord`引用。`Agency`

```
public class Employee
{
    [Key]
    public int Id { get; set; }

    public string Name { get; set; }

    public int AgencyId { get; set; }
    public virtual Agency Agency { get; set; }

    public virtual IEnumerable<WorkRecord> WorkRecords { get; set; }
}

public class Agency
{
    [Key]
    public int Id { get; set; } 
}

public class WorkRecord
{
    [Key]
    public int Id { get; set; } 

    public int Hours { get; set; } 

    public int AgencyId { get; set; } 
    public virtual Agency Agency { get; set; } 

    public int EmployeeId { get; set; }
    public virtual Employee { get; set; }
} 
```

像这样，它会发牢骚：`FK_dbo.WorkRecords_dbo.Employees_EmployeeId`导致循环引用。

### 实验

我的第一个想法是因为双向虚拟属性，所以我决定将两者中的一个指定为具有单向关系的顶级实体：

首先，我将其指定`WorkRecord`为顶级实体并`WorkRecords`从实体中删除虚拟引用引用`Employee`......产生了相同的消息。

其次，我制作`Employee`了顶级实体，留下了它的虚拟`WorkRecords`集合，并`Employee`从实体中删除了虚拟引用属性`WorkRecord`......工作正常，但没有达到我的目标。

经过更多调查，我发现是两个实体上的代理虚拟引用属性导致了循环引用。如果一个实体将其删除，则`Employee`/`WorkRecord`实体关系将在所有方向上起作用。

### 问题：

所以，我可以问清楚 - 我如何表达这种商业模式，`WorkRecord`作为我的顶级实体，而不会让 EF5 不安？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:55:37.080

听起来您只是想摆脱 EF，但我认为它实际上表达了数据耦合中的一个有效问题。例如，如果您将 AgencyId 绑定到 WorkRecord 和 Employee，那么更新 WorkRecord 上的 AgencyId 将级联到 Employee。然后将级联到 WorkRecord 等。因此是“循环引用”。您确实应该指定哪些数据对象将“拥有”与代理商的关系。

就个人而言，我怀疑最自然的绑定是从 WorkRecord 中引用代理。我可以看到员工可能从一个机构转移到另一个机构的情况，但工作记录从一个机构转移到另一个机构要困难得多。实际上，没有 WorkRecord 的 Employee 也不能真正被称为 Employee。如果您确定是这种情况，那么我会从 Employee 中删除 Agency 引用。如果您需要从员工那里到达代理机构，那么您可能无论如何*都应该通过工作记录。*

然而，所有这些都只是概念性的。我怀疑如果您可以让 AgencyId 在 Employee 上为空，那么 EF 将不再抱怨（并且您*可能*希望它在两者上都是可选的）。这应该使得在不需要使用 WorkRecord 进行循环更新的情况下更新 Employee 是有效*的*。我必须对此进行测试才能验证，但我怀疑它会成立。

```
public class Employee
{
    [Key]
    public int Id { get; set; }

    public string Name { get; set; }

    public int? AgencyId { get; set; }
    public virtual Agency Agency { get; set; }

    public virtual IEnumerable<WorkRecord> WorkRecords { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T23:04:51.683

您可能会从 SQL Server 而不是 Entity Framework 获得异常，例如：

> 在表 'XYZ' 上引入 FOREIGN KEY 约束 'ABC' 可能会导致循环或多个级联路径。指定 ON DELETE NO ACTION 或 ON UPDATE NO ACTION，或修改其他 FOREIGN KEY 约束。

此异常基本上说明了解决问题所需要做的事情：“指定 ON DELETE NO ACTION”意味着对至少一个关系禁用级联删除。问题是所有三个关系都是*必需*`AgencyId`的，因为您的外键属性`EmployeeId`是不可为空的。在这种情况下，EF 将在启用删除的数据库中创建关系。当您删除 : 时，结果是多重删除路径`Agency`：它将删除 WorkRecords 和员工，但员工也会删除 Workrecords，因此您在 WorkRecords 上有两个多重删除路径。

您只能使用 Fluent API 禁用级联删除：

```
modelBuilder.Entity<Employee>()
    .HasRequired(e => e.Agency)
    .WithMany()
    .HasForeignKey(e => e.AgencyId);

modelBuilder.Entity<WorkRecord>()
    .HasRequired(w => w.Agency)
    .WithMany()
    .HasForeignKey(w => w.AgencyId)
    .WillCascadeOnDelete(false); // or for one or more of the other relationships

modelBuilder.Entity<WorkRecord>()
    .HasRequired(w => w.Employee)
    .WithMany(e => e.WorkRecords)
    .HasForeignKey(w => w.EmployeeId); 
```

删除`Agency`now会导致相关员工被删除，删除员工会导致相关工作记录被删除。但该机构不会再直接删除工作记录，因此删除了第二条删除路径。

您也可以将其中一种关系*设为可选*，按惯例自动禁用级联删除（请参阅 Jacob Proffitt 的回答）。

顺便说一句：您不能将 an`IEnumerable<T>`用于导航属性，您必须使用`ICollection<T>`或派生接口或实现。

# excel - 使用“单元格”引用的范围引用

> ID：13260311
> 
> 赞同：1
> 
> 时间：2012-11-06T22:17:03.187
> 
> 标签：excel, vba

我使用长变量来表示列和行。当我尝试按类型指定范围时，`sheetname.range(cells(i,j), cells(i+1, j+1))`出现方法`Range of Object Worksheet failed`错误。

关于在使用长变量作为单元格引用时如何使用范围的任何想法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-06T22:21:58.970

```
sheetname.Range(sheetname.Cells(i,j), sheetname.Cells(i+1, j+1)) 
```

不合格`Cells()`将始终引用活动表。

我宁愿使用：

```
sheetname.Cells(i,j).Resize(2,2) 
```

# mysql - mysql - 多个位置和搜索

> ID：13260312
> 
> 赞同：1
> 
> 时间：2012-11-06T22:17:03.103
> 
> 标签：mysql

我正在尝试编写满足多个条件的 SQL 查询。

其中，大多数是通过列连接的，因此可以进行连接，但是，有些查询是这样的，我必须在其他表中搜索信息。什么是最便宜和最好的方法来做到这一点？

假设我们有几张桌子。

一个表包含诸如服务器的销售信息之类的信息：销售人员、客户 ID、服务租赁期限、时间戳等。客户可能有多个销售但具有不同的“服务”。我需要拿起所有不同的。

另一个表有服务的报价，我需要从中挑选一些信息，而另一个可以加入这个的有更多信息。

这些表由一个共同的客户端 ID 链接，因此可以进行连接，但我还需要在第一个表中搜索客户端 ID 的多个实例。当然，我想将搜索限制在某些时间戳，我可以很容易地做到这一点，因为时间戳是以 MySQL 格式存储的。

# c# - LINQ 查询以下内容

> ID：13260315
> 
> 赞同：1
> 
> 时间：2012-11-06T22:17:07.070
> 
> 标签：c#, .net, linq

有人可以帮助制定针对以下问题的 LINQ 查询。我有以下键值数字集列表（请注意允许使用重复键）。有成千上万的这样的集合。

```
{4,3}, {4,1}, {4,8}, {4,9}, {2,3}, {4,9}, {3,1} , {3,4} 
```

哪种数据结构最适合我。另外，我想对上面的键对列表和 OrderByDescending() 进行分组，以便我可以提取键组的最高键值对。

例如在上述情况下，预期输出：

```
{4,9}, {4,9}, {4, 8}, {4, 3}, {4, 1}, {2, 3}, {3, 4}, {3, 1} 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:20:13.957

尝试

```
input.OrderByDescending(p => p.Key).ThenByDescending(p => p.Value); 
```

或者

```
input.OrderByDescending(p => new { p.Key, p.Value }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:22:36.283

具有两个值的自定义类或一个`Tuple<int, int>`将满足您列出的需求。

要分组，您可以`Tuple<int, int>`直接使用并定义一个`IComparer<Tuple<int,int>>` 或继承自该类`Tuple<int, int>`并`IComparable<Tuple<int,int>>`使用该类实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T22:22:27.533

看看[`Lookup`](http://msdn.microsoft.com/en-us/library/bb460184.aspx)。它表示一组键，每个键映射到一个或多个值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T22:22:31.833

```
var largestPair = list.OrderByDescending(z => z[0]).ThenByDecending(z => z[1]).First();
Console.WriteLine("{0}, {1}", largestPair[0], largestPair[1]); 
```

# extjs - Sencha Touch 2 TypeError

> ID：13260317
> 
> 赞同：1
> 
> 时间：2012-11-06T22:17:15.647
> 
> 标签：extjs, sencha-touch

我一直在关注[Miami Coder](http://miamicoder.com/2012/how-to-create-a-sencha-touch-2-app-part-3/#comment-2123)关于 Sencha Touch 的教程。

我收到以下错误：

```
TypeError: ‘undefined’ is not a function (evaluating ‘this.getRandomInt(0, 100)’) Notes.js:20 
```

它指的是控制器中的以下行：

```
var noteId = (now.getTime()).toString() + (this.getRandomInt(0, 100)).toString(); 
```

我尝试删除连接的第二部分并决定稍后处理，但是弹出了一个新错误：

```
TypeError: 'undefined' is not a function (evaluating 'animation.setLayout(layout)') 
```

这是指：`Container.js:1233`

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-06T09:59:02.607

> ```
> getRandomInt() 
> ```

是一个包含 math.random 的局部函数。您应该创建该功能。

# spring - 尝试使用 spring 3，但自动连接的对象为空（在 tomcat 上）

> ID：13260318
> 
> 赞同：1
> 
> 时间：2012-11-06T22:17:20.780
> 
> 标签：spring, tomcat7, autowired

我正在尝试使用 spring 完成我的第一步，但我无法让它工作，我将感谢您的帮助。

我正在使用 tomcat，并且在 tomcat lib 目录中添加了一个文件：jdbc-service.xml：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:context="http://www.springframework.org/schema/context"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:tx="http://www.springframework.org/schema/tx"
   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
   http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
   http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

<context:spring-configured />

<context:component-scan base-package="com.myproject"/>

<context:property-placeholder location="database.properties"/>

<tx:annotation-driven transaction-manager="transactionManager"/>

</beans> 
```

我有一个 database.properties，它定义了几个用于获取 DataSource 对象的属性。我还有一个使用@Configuration 的类，它采用数据库的属性。此外，我还有另一个@Configuration 类，它继承自第一个类，并添加了 JdbcTemplate 对象，每个方法都带有 @Bean 注释。

我创建了一个 UserRepository 接口和一个名为 UserRepositoryImpl 的实现——它有一个带注释的@Autowired 成员 JdbcTemplate 和一个从 UserRepository 接口继承的方法 findById 的实现。

我有另一个名为 UserManager 的接口，它是 UserManagerImpl 的实现——它被注释为@Service，它有一个用 @Autowired 注释的成员 UserRepository。它正在实现一种 findById 的方法，并且只是尝试使用 UserRepository 从数据库中获取用户。

最后，我有一个使用成员的 servlet

```
@Autowired
private UserManager userManager; 
```

问题是 userManager 为空。我认为春天没有启动，但我不知道为什么。我可能错过了一些重要的东西。

请帮助我，因为我无法进步。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:26:59.010

Servlet 不是 Spring bean。它们由 tomcat 直接实例化，而不是由 Spring 实例化。因此，它们超出了 Spring 的范围，无法注入。

考虑使用 Spring MVC 控制器而不是 servlet。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T06:46:35.920

您确定您的 UserManagerImpl 在`com.myproject`指定为基本包的包中吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-25T00:19:59.353

在您的 web.xml 中指定两个上下文侦听器，但确保第一个侦听器是 Spring 的：

```
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<listener>
    <listener-class>com.sun.xml.ws.transport.http.servlet.WSServletContextListener</listener-class>
</listener> 
```

# regex - 正则表达式用引号括起日期

> ID：13260320
> 
> 赞同：4
> 
> 时间：2012-11-06T22:17:57.953
> 
> 标签：regex, notepad++

我有一个格式相同的数据列表，我需要在 Weka 中进行分析。

我需要用引号“”将日期/时间值括起来，但无法计算出正则表达式来完成它..

我需要从中更改一行：

```
1028,NULL,1,21,7,AD9,06A,60136859,NULL,1,4,3,2012-02-21 10:05:00.100,2012-02-21 10:05:23.170 
```

到这样的一行：

```
1027,NULL,1,21,7,AD9,06A,60136859,NULL,1,5,4,"2012-02-21 10:03:53.643","2012-02-21 10:04:29.787" 
```

其中日期/时间值用引号括起来。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T22:32:49.230

只要您的日期时间值始终完全格式化，这将在记事本++中工作。

```
Find what: (\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}.\d{3})
Replace with: "\1" 
```

这是因为反向引用。括号内捕获的所有内容都存储为反向引用。您可以通过键入`\number`where number 与正则表达式中括号的位置相关来访问反向引用。因此，由于我们只使用一对括号，想要反向引用 1，我们使用`\1`.

因此，由于正则表达式中的括号，您`entire date`会发现它并存储在其中。`\1`然后你`entire date`用`"entire date"`aka替换`"\1"`。

# android - 如何通过执行进程在 Android 上发送电子邮件

> ID：13260321
> 
> 赞同：0
> 
> 时间：2012-11-06T22:18:04.943
> 
> 标签：android, android-intent, adb

我正在从应用程序中添加对 Android shell 的调用。我已经能够很好地调用 shell 脚本或基本 shell 命令，但现在我正在尝试发送电子邮件（主要是为了知道是否可以）并且遇到了一个奇怪的错误：

```
11-06 16:14:43.449: D/AndroidRuntime(28655): >>>>>> AndroidRuntime START com.android.internal.os.RuntimeInit <<<<<<
11-06 16:14:43.449: D/AndroidRuntime(28655): CheckJNI is OFF
11-06 16:14:43.629: D/AndroidRuntime(28655): Calling main entry com.android.commands.am.Am
11-06 16:14:43.639: D/AndroidRuntime(28655): Shutting down VM
11-06 16:14:43.639: I/ActivityManager(204): START {act=android.intent.action.SENDTO typ="text/plain" flg=0x10000000 pkg=Goes (has extras)} from pid 28655
11-06 16:14:43.649: D/dalvikvm(28655): GC_CONCURRENT freed 104K, 81% free 495K/2560K, paused 0ms+1ms
11-06 16:14:43.649: D/dalvikvm(28655): Debugger has detached; object registry had 1 entries
11-06 16:14:43.649: I/AndroidRuntime(28655): NOTE: attach of thread 'Binder Thread #2' failed 
```

我的 shell 运行的代码是这样的：

```
am start -a android.intent.action.SENDTO -t "text/plain" --es android.intent.extra.EMAIL "myaddress@example.com" --es android.intent.extra.TEXT "Message Goes here" --es android.intent.extra.SUBJECT "this is the subject" 
```

出了什么问题，我该如何解决？`am`我应该使用其他工具（除了）吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T06:53:35.347

尝试使用此代码发送电子邮件。在真实设备上运行此代码，因为 adb 没有任何第三方权限

包 com.rmn.emailSending；

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;

public class EmailSendingActivity extends Activity {
    Button send;
    EditText address, subject, emailtext;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        send = (Button) findViewById(R.id.emailsendbutton);
        address = (EditText) findViewById(R.id.emailaddress);
        subject = (EditText) findViewById(R.id.emailsubject);
        emailtext = (EditText) findViewById(R.id.emailtext);

        send.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub

                final Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);

                emailIntent.setType("message/rfc822");
                emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL,new String[] { address.getText().toString() });
                emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT,subject.getText().toString());
                emailIntent.putExtra(android.content.Intent.EXTRA_TEXT,emailtext.getText().toString());
                EmailSendingActivity.this.startActivity(Intent.createChooser(emailIntent, "Send mail in"));

            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T22:00:25.563

经过多次尝试，我开始相信您无法从`am`设备上启动 Activity。但是，您可以发送可用于启动 Activity 的广播。例如，要启动相机应用程序，您可以使用以下命令：

```
am broadcast -a android.intent.action.CAMERA_BUTTON 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T00:24:28.560

如果您在 adb shell 中，请尝试以下操作：

```
am start -a android.intent.action.SENDTO -d sms:xxx --es sms_body "xxx" --ez exit_on_sent true
input keyevent 66 
```

我刚刚在运行 Android 4.0(ICS) 的 Droid X 上进行了尝试。它将发送短信并退出。请让我知道这可不可以帮你。

问候，

# c# - 如何使用 .NET Action 执行参数数量未知的方法？

> ID：13260322
> 
> 赞同：24
> 
> 时间：2012-11-06T22:18:09.203
> 
> 标签：c#, multithreading, lambda, action

我想在向用户显示进度条的同时在工作线程上执行一些操作。我创建了一个类

```
public class ProgressBar
{
   public void StartAsyncTask(Action action)
   {
      Task t = new Task(action);
      t.start();
   }
} 
```

我发现我可以`StartAsyncTask`通过以下方式将任何方法发送到：

```
 ProgressBar pb = new ProgressBar();
  pb.StartAsyncTask( () => DoSomething(15, "something"));

  public void DoSomething(int i, string s)
   {
      //do something
   } 
```

首先，我似乎无法理解 lambda 表达式是什么以及如何`() =>`翻译 - 以及`Action`对象如何传递具有未知数量参数的委托。

我想将 a`BackgroundWorker`与我的 ProgressBar 一起使用，但在这种情况下，我需要调用该操作。所以是这样的：

```
void m_backgroundWorker_DoWork(object sender, DoWorkEventArgs e)
{
    Action action = e.Argument as Action; //same action here passed through EventArgs
   //but already in a worker thread so no need for the Task object 

   //and now i need to somehow invoke the action object but i don't know what the parameters are. 

   action.Invoke( ? ); 
} 
```

在第一个示例中，如何在不知道`StartAsyncTask(Action action)`方法中的参数的情况下执行操作？

为什么在这种情况下调用动作时需要知道参数？

`Action`即使我在这里阅读了 MSDN 文档和其他一些线程，关于如何/为什么/何时使用 " " 的一切对我来说都不清楚。这方面的任何信息都会对我有所帮助。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-11-06T22:42:20.503

我觉得你有点想太多了。所以让我们从顶部开始：

1.  lambda 表达式是引用方法执行的符号。例子：

    ```
     x => x + 3 
    ```

    在最基本的层面上，这表示一个函数，它接受 1 个输入 ，`x`然后返回一个等于 的值`x + 3`。所以在你的情况下，你的表达：

    ```
    () => DoSomething(15, "Something") 
    ```

    表示采用 0 个参数的方法，然后调用该方法`DoSomething(15, "Something")`。编译器在幕后为您将其转换为 a`Func`或`Action`委托。所以它是有效的：

    ```
    new Action(delegate()
    {
        DoSomething(15, "Something")
    }); 
    ```

    我上面的简单表达式的编译器重写将是：

    ```
    new Func<int, int>(delegate(int x)
    {
        return x + 3;
    }); 
    ```

2.  接下来，如果你想稍后调用一个动作，这样做的语法相当简单：

    ```
    Action someMethod = new Action(() => { Console.WriteLine("hello world"); }));
    someMethod(); // Invokes the delegate 
    ```

    因此，如果您有一个给定的`Action`实例，只需使用`()`语法调用它即可，因为`Action`它是一个接受 0 个参数且不返回任何内容的委托。

    一个函数同样简单：

    ```
    Func<int, int> previousGuy = x => x + 3;
    var result = previousGuy(3); // result is 6 
    ```

3.  最后，如果您想传递要调用的方法，并且此时没有参数的上下文，您可以简单地将调用包装在一个操作中，然后再调用它。例如：

    ```
    var myAction = new Action(() =>
         {
              // Some Complex Logic
              DoSomething(15, "Something");
              // More Complex Logic, etc
         });

    InvokeLater(myAction);

    public void InvokeLater(Action action)
    {
          action();
    } 
    ```

    所有数据都在您的方法的闭包中捕获，因此被保存。因此，如果您可以设法通过`Action`该属性将 an 传递给您的事件`e.Argument`，那么您需要做的就是调用`(e.Argument as Action)()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-09-01T12:01:10.233

你不能`DynamicInvoke()`在那个委托上使用（它`params object[] args`作为参数）

```
action.DynamicInvoke(arg1, arg2, arg3 ); 
```

# xades4j - 如何在 XSdES4J 中实现不同的证书验证

> ID：13260323
> 
> 赞同：0
> 
> 时间：2012-11-06T22:18:10.963
> 
> 标签：xades4j

我正在使用 XAdES 来验证使用 xades-t 的消息。但是欧洲的一些国家并不依赖证书链来连接有效的根 CA。我将如何在 xades4j 中实现验证证书的不同方式？

非常感谢任何建议。

亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T22:50:26.747

创建[XadesVerificationProfile](http://xades4j.googlecode.com/svn/release/1.3.0/javadoc/reference/xades4j/verification/XadesVerificationProfile.html)时，您必须提供[CertificateValidationProvider](http://xades4j.googlecode.com/svn/release/1.3.0/javadoc/reference/xades4j/providers/CertificateValidationProvider.html)。该库包含一个基于 Java 的 PKIX 类的实现，但您可以使用自定义验证登录实现另一个提供程序并将其提供给 XadesVerificationProfile 构造函数。

# rest - REST 使用 1XX 代码检查服务器状态

> ID：13260324
> 
> 赞同：0
> 
> 时间：2012-11-06T22:18:20.023
> 
> 标签：rest

我想要做的是在使用服务之前，检查服务器是否启动。因为我必须根据那个反应做出不同的事情。

如果我创建一个返回 1XX 代码（例如 100 Continue）然后使用服务的 GET 可以吗？解决这个问题的常用方法是什么？

# javascript - 如何让我的桌子根据屏幕分辨率自动调整高度

> ID：13260327
> 
> 赞同：0
> 
> 时间：2012-11-06T22:18:29.600
> 
> 标签：javascript, html, css

下表用于显示地图和一些相关数据（我清理了所有内容以提高可读性）。左边部分是一个“垂直滚动表”。右侧部分是显示谷歌地图的 div。

它现在设置为 500px，我想知道如何让它“填充”可用的屏幕空间。

```
<div id="maparea">
    <table style="width:100%; position:relative;border-bottom: 1px solid #888888;margin: 0 auto;" >
        <tr>
            <td width="120px">
                <div style="padding : 4px; width : 196px; height:500px; overflow : auto;">
                    <div>
                        <table width="100%" style="border:1px solid #888888;padding : 0px;">
                            <tr>
                                <td style="font-size:xx-small;">
                                    <b>Name: </b> name<br>
                                    <b>Unit ID:</b> this is id<br>
                                    <b>State:</b> IL     <br>
                                </td>
                            </tr>                    
                        </table>
                        <table><tr><td></td></tr></table></div>
                </div>         
            </td>
            <td width="100%" height="100%">
                <div id="googlemaps1" style="width:100%; height:500px;position:relative;margin: 0 auto;"> </div>
            </td>
        </tr>
    </table>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:21:16.717

为了垂直拉伸它，您必须将每个嵌套元素从`html`down 设置为 have `height: 100%`。应该看起来像这样：

```
html, body, #maparea, table, #googlemaps1 { height: 100%; } 
```

对比：

*   [没有`height`CSS 集](http://jsfiddle.net/LFcwv/1)
*   [和](http://jsfiddle.net/LFcwv/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:23:43.083

您可以使用表格的固定或绝对位置，并使用底部和顶部坐标来固定高度。

```
table {
 position: absolute;
 top: 0px;
 bottom: 0px;
 width:100%;
} 
```

问候！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T23:21:08.397

请查看我在下面的这篇文章。您不应该像以前那样使用表格来布局或排列页面。

[http://www.htmlgoodies.com/beyond/css/article.php/3642151/CSS-Layouts-Without-Tables.htm](http://www.htmlgoodies.com/beyond/css/article.php/3642151/CSS-Layouts-Without-Tables.htm)

也只是一个提示，您不应该使用内联 CSS 样式，这是非常糟糕的做法，并且将来修改模板和页面非常困难，因此使用类和样式表来定义任何样式和/或布局您的页面。它们更有活力，以后更容易修复。

在这里为您演示干净的编码：http: [//jsfiddle.net/nshJH/](http://jsfiddle.net/nshJH/)

使用`<div>`'s 你可以只使用

```
float: xxxx;
clear: xxxx; 
```

这是一个干净的流体页面的简单示例，它对它包含的内容是动态的。另请注意，我可以通过 CSS 中的一个位置即时更改任何宽度或文本属性...

# wcf - 通过 URL 发送的 WCF 服务请求和参数

> ID：13260328
> 
> 赞同：0
> 
> 时间：2012-11-06T22:18:37.900
> 
> 标签：wcf

我正在创建 WCF 服务（.net 4.5 - Visual Studio 2012），我需要能够调用我的服务操作并通过 URL 传递正确的参数。

我需要改变什么才能允许这样做？

当我使用以下 URL：“.../MyService.svc/GetData?value=2”时，我收到 HTTP/1.1 400 Bad Request。

这是我的 web.config：

```
 <?xml version="1.0"?>
    <configuration>

      <appSettings>
        <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true" />
      </appSettings>
      <system.web>
        <compilation debug="true" targetFramework="4.5" />
        <httpRuntime targetFramework="4.5"/>
      </system.web>
      <system.serviceModel>
        <services>
          <service behaviorConfiguration="ofertaServiceBehavior" name="Oferta" >
            <endpoint binding="webHttpBinding" bindingConfiguration=""                 contract="GeoOfertas.IOfertaService" />
          </service>
        </services>
        <behaviors>
          <serviceBehaviors>
            <behavior name="ofertaServiceBehavior">
              <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true" />
              <serviceDebug includeExceptionDetailInFaults="false" />
            </behavior>
          </serviceBehaviors>
        </behaviors>
        <protocolMapping>
            <add binding="basicHttpsBinding" scheme="https" />
        </protocolMapping>    
        <serviceHostingEnvironment aspNetCompatibilityEnabled="true"         multipleSiteBindingsEnabled="true" />
      </system.serviceModel>
      <system.webServer>
        <modules runAllManagedModulesForAllRequests="true"/>
        <!--
            To browse web app root directory during debugging, set the value below to true.
            Set to false before deployment to avoid disclosing web app folder information.
          -->
        <directoryBrowse enabled="true"/>
      </system.webServer>

    </configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:31:44.277

使用以下 web.config 解决了问题

```
 <?xml version="1.0"?>
    <configuration>

      <appSettings>
        <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true" />
      </appSettings>
      <system.web>
        <compilation debug="true" targetFramework="4.5" />
        <httpRuntime targetFramework="4.5"/>
      </system.web>
      <system.serviceModel>
        <services>
          <service behaviorConfiguration="ofertaServiceBehavior" name="GeoOfertas.OfertaService">
            <endpoint behaviorConfiguration="webBehavior" binding="webHttpBinding"
              bindingConfiguration="" contract="GeoOfertas.IOfertaService" />
          </service>
        </services>
        <behaviors>
          <endpointBehaviors>
            <behavior name="webBehavior">
              <webHttp />
            </behavior>
          </endpointBehaviors>
          <serviceBehaviors>
            <behavior name="ofertaServiceBehavior">
              <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true" />
              <serviceDebug includeExceptionDetailInFaults="false" />
            </behavior>
          </serviceBehaviors>
        </behaviors>
        <protocolMapping>
            <add binding="basicHttpsBinding" scheme="https" />
        </protocolMapping>    
        <serviceHostingEnvironment aspNetCompatibilityEnabled="true"         multipleSiteBindingsEnabled="true" />
      </system.serviceModel>
      <system.webServer>
        <modules runAllManagedModulesForAllRequests="true"/>
        <!--
            To browse web app root directory during debugging, set the value below to true.
            Set to false before deployment to avoid disclosing web app folder information.
          -->
        <directoryBrowse enabled="true"/>
      </system.webServer>

    </configuration> 
```

# sql - 将单个记录分成多个

> ID：13260329
> 
> 赞同：2
> 
> 时间：2012-11-06T22:18:41.410
> 
> 标签：sql, gaps-and-islands

通常这反过来工作，但我想通过 SQL 将单个记录分成多个记录。

我们存储具有开始和结束日期的范围，但需要导出范围中每一年的记录。

示例：`TECH_ID`有一个`begin_date`2009 年和`end_date`2011 年的记录。我们需要导出 2009 年、2010 年和 2011 年的 3 条记录。

如何实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:23:00.903

[您需要一个数字表](http://dataeducation.com/you-require-a-numbers-table/)：

```
CREATE TABLE Numbers
(
    Number INT NOT NULL,
    CONSTRAINT PK_Numbers 
        PRIMARY KEY CLUSTERED (Number)
        WITH FILLFACTOR = 100
)

INSERT INTO Numbers
SELECT
    (a.Number * 256) + b.Number AS Number
FROM 
    (
        SELECT number
        FROM master..spt_values
        WHERE 
            type = 'P'
            AND number <= 255
    ) a (Number),
    (
        SELECT number
        FROM master..spt_values
        WHERE 
            type = 'P'
            AND number <= 255
    ) b (Number)
GO 
```

现在你有一个数字表......

```
SELECT DISTINCT
    n.Number
FROM
    Numbers n 
    JOIN TECH_ID t 
        ON n.Number BETWEEN t.begin_date AND t.end_date 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:24:39.863

创建一个每年有一行的表（一些 RDBMS 有快捷方式）。然后做

```
Select
  t.*,
  y.Year
From
  Years y
    Inner Join
  tech_id t
    On Year(t.begin_date) <= y.Year And Year(t.end_date) >= y.Year 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T22:25:24.327

当我阅读您的问题时，并未明确提及示例数据。顺便说一句，我写这个作为一个例子，根据你拥有的任何东西将一条记录放在三条记录中。

```
Select  *
    From    (
        Select  1   As  Id
        ,   'Test'  As  Name
    )   As  SampleRecord
    Cross   Join
        (
        Select  2009    As  Year
    Union   Select  2010
    Union   Select  2011
    )   As  Years 
```

干杯

# gwt - Maven GWT 插件 - generateAsync 和通用类型

> ID：13260331
> 
> 赞同：0
> 
> 时间：2012-11-06T22:18:48.170
> 
> 标签：gwt, maven, gwt-maven-plugin

您好，我成功安装了 GWT Maven 插件，它在增量保存 Async RPC 服务时生成。

但是我遇到了一个小问题，如果我使用：

`ArrayList<Whatever>`那么生成的 Async 类将有一个方法`AsyncCallback<java.util.ArrayList> callback`

如您所见，它缺少`<Whatever>`参考，我几乎可以肯定有一天我看到它起作用了。

这是我使用的版本： Maven 3.0.4 MavenGwtPlugin 2.4.0 QDox 1.2 GWT 2.4.0

我在一个论坛帖子上尝试了 QDox 2.0-snapshot，但没有任何效果。

如果你有想法！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:28:04.313

见[https://jira.codehaus.org/browse/MGWT-315](https://jira.codehaus.org/browse/MGWT-315)

确保您仅从`genericAsync`干净的构建运行。

# c++ - 为什么成员函数需要'&'（例如在std::bind 中）？

> ID：13260332
> 
> 赞同：3
> 
> 时间：2012-11-06T22:18:53.937
> 
> 标签：c++, c++11

当我使用`std::bind`C *++11*标准时，我认识到编译器允许以下内容：

```
class Foo
{
public:
  void F();
  int G(int, int);
};

void Foo::F()
{
  auto f = bind(&Foo::G, this, _1, _2);
  cout << f(1,2) << endl;
}

int Foo::G(int a, int b)
{
  cout << a << ',' << b << endl;
  return 666;
} 
```

但是如果我消除了 - 行前面的“&” `Foo::G`，`bind`我会得到一些编译器错误（使用 MinGW 4.7）。

为什么`Foo::G`作为指向成员函数的指针无效，尽管`H`它们`&H`都适用于“常规”函数？

LG ntor

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T22:28:13.497

& 需要获取成员函数的地址，一些编译器将允许您省略相同的地址，但它是非标准的，有时会令人困惑。

您可以在此处阅读有关成员函数指针的信息：http: [//www.codeproject.com/Articles/7150/Member-Function-Pointers-and-the-Fastest-Possible](http://www.codeproject.com/Articles/7150/Member-Function-Pointers-and-the-Fastest-Possible)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T10:01:14.623

我认为原因之一可能是一致性。回想一下，在课堂上，你可以说

```
MyClassOrOneOfItsBases::memberFunction(); 
```

它编译得很好，因为限定名称命名了成员函数，而不是形成指向成员的指针。

# jquery - jQuery Animate div 上下移动堆栈

> ID：13260333
> 
> 赞同：0
> 
> 时间：2012-11-06T22:19:12.787
> 
> 标签：jquery, jquery-animate

我有以下代码来为动态 div 上下设置动画。这个想法是，可能有任意数量的 div 需要在堆栈上上下移动，与上下 div 交换位置。一旦处于他们的新位置，我需要能够抓住那个新的重新定位的位置。以下代码一次有效，但是一旦下 div 向上移动并且上 div 向下移动（交换点）到新位置，它们就会停止工作。我该如何设置它，以便他们继续向上遍历堆栈，在他们去的时候交换紧邻上方或下方的堆栈？一旦完成更新数据库，我还需要知道新职位。我一直在到处寻找，但似乎找不到如何做到这一点。任何帮助将非常感激。

```
$('.editUp', this).click(function() {
   thisRowHt = $(this).parents('.rowCont').outerHeight();
   upperRowHt = $(this).parents('.rowCont').prev().outerHeight();
   $(this).parents('.rowCont').animate({'top': '-=' + thisRowHt + 'px'});
   $(this).parents('.rowCont').prev().animate({'top': '+=' + upperRowHt + 'px'});
   return false;
});

$('.editDown', this).click(function() {
   thisRowHt = $(this).parents('.rowCont').outerHeight();
   lowerRowHt = $(this).parents('.rowCont').next().outerHeight();
   $(this).parents('.rowCont').animate({'top': '+=' + lowerRowHt + 'px'});
   $(this).parents('.rowCont').next().animate({'top': '-=' + thisRowHt + 'px'});
   return false;
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:07:47.657

您还应该交换 DOM 中的元素，因为当您为 HTML 元素设置动画时，它们只会改变它们在屏幕上的位置。

我已经完成了你的脚本：

```
$('.editUp', this).click(function() {

    var this_rowCont = $(this).parents('.rowCont');
    var prev_rowCont = $(this).parents('.rowCont').prev();

    // if this is the first element, it returns
    if (prev_rowCont.length != 1){return false;}

    thisRowHt = this_rowCont.outerHeight();
    upperRowHt = prev_rowCont.outerHeight();

    this_rowCont.animate({'top': '-=' + thisRowHt + 'px'});
    prev_rowCont.animate({'top': '+=' + upperRowHt + 'px'}, function(){

        // this is a callback function which is called, when the animation ends
        // This swap this and previous element in the DOM
        this_rowCont.insertBefore(prev_rowCont);
        this_rowCont.css("top", 0);
        prev_rowCont.css("top", 0);
    });

    return false;
});

$('.editDown', this).click(function() {

    var this_rowCont = $(this).parents('.rowCont');
    var next_rowCont = $(this).parents('.rowCont').next();

    // if this is the last element, it returns
    if (next_rowCont.length != 1){return false;}

    thisRowHt = this_rowCont.outerHeight();
    lowerRowHt = next_rowCont.outerHeight();

    this_rowCont.animate({'top': '+=' + lowerRowHt + 'px'});
    next_rowCont.animate({'top': '-=' + thisRowHt + 'px'}, function(){

        // This swap this and next element in the DOM
        next_rowCont.insertBefore(this_rowCont);
        this_rowCont.css("top", 0);
        next_rowCont.css("top", 0);
    });

   return false;
});​ 
```

你可以在这里看到它的实际效果：[Animate div up and down](http://jsfiddle.net/ykzwT/2/)

# mysql - 在 Mysql 中查询多对一

> ID：13260335
> 
> 赞同：-1
> 
> 时间：2012-11-06T22:19:25.877
> 
> 标签：mysql, many-to-one

下图说明了我的数据库是如何组织的：

[一只忙碌的猫 http://akplebani.com/graphic.png](http://akplebani.com/graphic.png)

我正在寻找的是一个**单一**的查询，其结果根据坐标**date为我提供了****坐标**名称、**标题项目**、**标题解决方案**和名称客户**端**。

 ****我正在尝试这样的事情：

```
SELECT coordinate_name, title_project, title_solution, name_client FROM coordinate NATURAL JOIN client WHERE date BETWEEN ? AND ? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:27:03.373

确切地确定你想如何定义你的所有联接（即内部联接、外部联接等），但这应该让你开始

```
SELECT
co.coordinate_name,
cl.name_client,
s.title_solution,
p.title_project
FROM
coordinate AS co
INNER JOIN project AS p ON co.project_id_project = p.id_project
INNER JOIN solution AS s ON p.solution_id_solution = s.id_solution
INNER JOIN client AS cl ON s.client_id_client = cl.id_client
WHERE
co.date BETWEEN ? AND ? 
```****

# c++ - 在 SFML 事件中发送鼠标位置

> ID：13260342
> 
> 赞同：0
> 
> 时间：2012-11-06T22:19:50.823
> 
> 标签：c++, sfml

我坚持制定正确的语法以将 mouseX 和 mouseY 位置传递给我的班级。

我的尝试是这样的：

```
 // Start the game loop
 while (window.isOpen())
 {
     // Process events
     sf::Event event;
     while (window.pollEvent(event))
     {
         // Close window : exit
         if (event.type == sf::Event::Closed) {
             window.close();
         }
     }

     // Clear screen
     window.clear();

     // Draw the sprite
     window.draw(sprite);
     window.draw(lsprite);

     if(btn_quit.IsIn(sf::Event::MouseMoveEvent::x,sf::Event::MouseMoveEvent::y){
         btn_quit.RenderImg(window,"button_on.png");
     } else {
         btn_quit.RenderImg(window,"button.png");
     }
  ///rest of the code not relevant to this issue 
```

这是在我的课上：

```
bool IsIn( int mouseX, int mouseY )
{
    if (((mouseX > m_x) && (mouseX < m_x + m_w)) 
    && ((mouseY > m_y) && (mouseY < m_y + m_h ) ) ) {
        return true;
    } else {
        return false;
    }
} 
```

我不断收到输入 x 和 y 的错误，但它是这样说的：

`error C2597: illegal reference to non-static member 'sf::Event::MouseMoveEvent::x'`

`error C2597: illegal reference to non-static member 'sf::Event::MouseMoveEvent::y'`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T22:33:38.620

您正在尝试静态访问结构的非静态成员字段。你不能那样做。尝试这样的事情：

```
// Start the game loop
while (window.isOpen())
{
    // Process events
    sf::Event event;
    while (window.pollEvent(event))
    {
        // Close window : exit
        if (event.type == sf::Event::Closed) {
            window.close();
        }
        else if (event.type == sf::Event::MouseMove)
        {
            if(btn_quit.IsIn(event.MouseMoveEvent.x, event.MouseMoveEvent.x){
                btn_quit.RenderImg(window,"button_on.png");
            } else {
                btn_quit.RenderImg(window,"button.png");
            }
        }
    }

    // Clear screen
    window.clear();

    // Draw the sprite
    window.draw(sprite);
    window.draw(lsprite); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:38:47.767

您目前正在做的事情在某些方面是不正确的。首先，您不能像那样访问 x 和 y 作为静态数据，它根本不存在。

除此之外，SFML 事件本质上是联合，这意味着它们的实际内容将取决于您尝试处理的事件类型。您不能为每个事件获取 x 和 y 值，至少不能从事件对象中获取。如果您有鼠标事件，您将执行以下操作：

```
if(event.type == sf::Event::MouseMoved) 
{
    // do something with event.mouseMove.x and event.mouseMove.y
} 
```

或者，如果您想在`mouseMoved`事件范围之外执行此操作，您始终可以使用[`Mouse`](http://www.sfml-dev.org/documentation/2.0/classsf_1_1Mouse.php)该类。这包含一个`getPosition`方法，该方法将返回一个包含`x`and的二维向量`y`：

```
sf::Mouse::getPosition(); //Absolute coordinates
sf::Mouse::getPosition(window); //Relative to window 
```

# c - 为什么我的所有 char 数组都不能通过（在 C 中）？

> ID：13260345
> 
> 赞同：-1
> 
> 时间：2012-11-06T22:20:04.637
> 
> 标签：c, arrays

> **可能重复：**
> [C sizeof a passed array](https://stackoverflow.com/questions/5493281/c-sizeof-a-passed-array)
> [为什么 sizeof(param_array) 是指针的大小？](https://stackoverflow.com/questions/11622146/why-sizeofparam-array-is-the-size-of-pointer)

我是 C 新手，对类型系统有点困惑。我正在尝试编写一些代码来打印字符串中小写字符的数量，但是我的数组中只有一个 int 大小的片段被传递给 cntlower 函数。为什么是这样？

```
#include "lecture2.h"

int main(void){
    int lowerAns;
    char toCount[] = "sdipjsdfzmzp";
    printf("toCount size %i\n", sizeof(toCount));
    lowerAns = cntlower(toCount);
    printf("answer %i\n", lowerAns);
}

int cntlower(char str[]) {

    int lowers = 0;
    int i = 0;
    printf("str size %i\n", sizeof(str));
    printf("char size %i\n", sizeof(char));

    for(i = 0; i < (sizeof(str)/sizeof(char)); i++) {
         if(str[i] >= 'a' && str[i] <= 'z') {
               lowers++;
         }
    }

    return lowers;

} 
```

实际上，当前的输出是： toCount size 13 str size 4 char size 1 answer 4

我相信这对你们中的一些人来说是显而易见的，但不幸的是，它不适合我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:22:14.507

函数的`char str[]`参数实际上是 a 的语法糖`char*`，所以`sizeof(str) == sizeof(char*)`。这恰好与`sizeof(int)`您的平台一致。

# asp.net - 站点地图和 MVC

> ID：13260354
> 
> 赞同：0
> 
> 时间：2012-11-06T22:20:50.080
> 
> 标签：asp.net, asp.net-mvc, sitemap

有没有办法使用经典的 asp.net 站点地图但配置请求路由以调用 MVC 控制器和相关操作？

例如：

```
<siteMap>
    <siteMapNode url="~/something.aspx" controller="Home" action="Default" />
</siteMap> 
```

因此 url ~/something.aspx 将被路由到 Home 控制器上的 Default 操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T19:05:48.500

你为什么不想尝试

[http://mvcsitemap.codeplex.com/releases/view/60377](http://mvcsitemap.codeplex.com/releases/view/60377)

这是 MVC 的优秀书面站点地图提供程序

# asp.net - 为什么速度测试表明我没有在我的 asp.net 网站上指定我的 asp:image 尺寸？

> ID：13260357
> 
> 赞同：1
> 
> 时间：2012-11-06T22:20:58.333
> 
> 标签：asp.net, visual-studio-2010, image, visual-studio

我的主页上有这样的链接——总共 12 个，所有 12 种语言的 1 个标志。我意识到只做一个 height= 和 width= 是行不通的，所以我关注了一个 SE 帖子并制作了这样的图片链接：

```
<asp:Image ID="Image8" runat="server" ImageUrl="~/images/flagen.png" 
style="height:15px; width:26px;"
tooltip="View this website in English" title="View this website in English"/>

<asp:Image ID="Image7" runat="server" ImageUrl="~/images/flagde.png" 
style="height:15px; width:26px;"
tooltip="View this website in Deutsch" title="View this website in Deutsch"/> 
```

它还说我没有为我的横幅指定图像尺寸：

```
<asp:HyperLink ID="HyperLink1" runat="server" ImageUrl="~/images/logoussbanner.png" 
style="height:81px; width:960px;" NavigateUrl="~/" target="_self" 
meta:resourcekey="HyperLink1Resource1"></asp:HyperLink> 
```

但是当我运行[GT Metrix 测试](http://gtmetrix.com)时，它仍然说我没有指定我的图像尺寸。我应该将这些更改为常规的 html 图像，还是我错了？任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T02:26:02.780

这条线

`<asp:HyperLink ID="HyperLink1" runat="server" ImageUrl="~/images/logoussbanner.png" style="height:81px; width:960px;" NavigateUrl="~/" target="_self" meta:resourcekey="HyperLink1Resource1"></asp:HyperLink>`

仅将样式添加到超链接而不是图像尺寸。

在 4.5 版中，您可以将[ImageHeight 和 ImageWidth](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.hyperlink.imageheight.aspx)作为参数添加到图像尺寸，但在 4 版和更早版本中您不能。

# c# - 如何用 c# 控制 youtube flash 播放器？

> ID：13260361
> 
> 赞同：6
> 
> 时间：2012-11-06T22:21:07.820
> 
> 标签：c#, .net, flash, youtube, youtube-api

我的目标是制作一个可以通过全球媒体密钥控制的开源 YouTube 播放器。我得到了它的全球关键问题，但由于某种原因，YouTube 播放器和我的 Windows 窗体应用程序之间的通信无法正常工作。

到目前为止，这就是我所拥有的：

```
private AxShockwaveFlashObjects.AxShockwaveFlash player;
player.movie = "http://youtube.googleapis.com/v/9bZkp7q19f0"
...
private void playBtn_Click(object sender, EventArgs e)
{
    player.CallFunction("<invoke name=\"playVideo\" returntype=\"xml\"></invoke>");
} 
```

不幸的是，这会返回：

```
"Error HRESULT E_FAIL has been returned from a call to a COM component." 
```

我错过了什么？我应该加载不同的 URL 吗？
[该文档](https://developers.google.com/youtube/articles/youtube_as3_chromeless)指出 YouTube 播放器使用**ExternalInterface 类**从 JavaScript 或 AS3 控制它，因此[它应该与 c# 一起使用](http://bojolais.livejournal.com/251383.html)。

### 更新：

* * *

用于嵌入播放器的方法：[http ://www.youtube.com/watch?v=kg-z8JfOIKw](http://www.youtube.com/watch?v=kg-z8JfOIKw)

还尝试在 WebBrowser 控件中使用[JavaScript-API](https://developers.google.com/youtube/js_api_reference)，但没有运气（播放器只是没有响应 JavaScript 命令，甚至尝试设置`WebBrowser.url`为[工作演示](https://developers.google.com/youtube/youtube_player_demo)，我成功的只是使用简单的[嵌入对象](https://developers.google.com/youtube/youtube_player_demo#object-embed-code-header)`onYouTubePlayerReady()`来触发[版本](https://developers.google.com/youtube/youtube_player_demo#object-embed-code-header)）

我认为可能有一些我正在监督的安全问题，不知道。

### 更新 2：

* * *

喜欢的解决方案，请参阅下面的[答案](https://stackoverflow.com/questions/13260361/how-to-control-the-youtube-flash-player-with-c/16508605?noredirect=1#answer-13604903)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T20:13:34.953

这听起来像是您尝试使用 Adob​​e Flash 作为您的界面；然后将某些变量传回 C#。

一个例子是这样的：

在闪存中；创建一个按钮... Actionscript：

```
on (press) {
    fscommand("Yo","dude");
} 
```

然后 Visual Studio 你只需要添加 COM 对象引用：Shockwave Flash Object

然后将嵌入设置为true；

然后在 Visual Studio 中，您应该能够转到属性；找到 fs 命令。fs 命令将允许您物理连接 Flash 电影中的值。

```
AxShockwaveFlashObjects._IShockwaveFlashEvents_FSCommandEvent 
```

收集；然后只需使用`e.command`and`e.arg`例如让收集的项目做一些事情。

然后将其添加到 EventHandler；

```
lbl_Result.Text="The "+e.args.ToString()+" "+e.command.ToString()+" was clicked"; 
```

并且繁荣它正在将其数据从 Flash 传输到 Visual Studio。不需要任何疯狂的困难插座。

附带说明；如果你在 Visual Studio 中有 Flash，关键是要确保它的“嵌入设置为真”。这将保存 Flash 对象中的所有路径引用；以避免任何错误的路径。

我不确定这是否是您寻求的答案；或回答您的问题。但是没有关于你的目标/错误的更多细节。我帮不了你。

希望这可以帮助。第一部分实际上应该向您展示将 Shockwave 嵌入 Visual Studio 的最佳方式。

确保添加正确的参考：

1.  在您的项目中打开**“解决方案资源管理器”**
2.  右键单击**“添加参考”**
3.  转到**“COM 对象”**

找到合适的对象；

```
COM Objects:
Shockwave ActiveX
Flash Accessibility
Flash Broker
Shockwave Flash 
```

希望有帮助。

听起来您没有正确嵌入它；所以你可以打电话给它。如果我稍微弄错了；或者这就是你的意思：

如果您遇到困难，Ryk 不久前有帖子；使用嵌入 YouTube 视频的方法：

```
<% MyYoutubeUtils.ShowEmebddedVideo("<object width="425" height="344"><param name="movie" value="http://www.youtube.com/v/gtNlQodFMi8&hl=en&fs=1"></param><param name="allowFullScreen" value="true"></param><embed src="http://www.youtube.com/v/gtNlQodFMi8&hl=en&fs=1" type="application/x-shockwave-flash" allowfullscreen="true" width="425" height="344"></embed></object>") %> 
```

或者...

```
public static string ShowEmbeddedVideo(string youtubeObject)
{
    var xdoc = XDocument.Parse(youtubeObject);
    var returnObject = string.Format("<object type=\"{0}\" data=\{1}\"><param name=\"movie\" value=\"{1}\" />",
        xdoc.Root.Element("embed").Attribute("type").Value,
        xdoc.Root.Element("embed").Attribute("src").Value);
    return returnObject;
} 
```

你可以在这里找到线程：[`https://stackoverflow.com/questions/2547101/purify-embedding-youtube-videos-method-in-c-sharp`](https://stackoverflow.com/questions/2547101/purify-embedding-youtube-videos-method-in-c-sharp)

如果我的帖子显得支离破碎，我深表歉意；但我不知道是引用、变量、方法还是嵌入给你带来了困难。真的希望这会有所帮助；或者给我更多细节，我会相应地调整我的回复。

* * *

C# 到 ActionScript 的通信：

```
import flash.external.ExternalInterface;
ExternalInterface.addCallback("loadAndPlayVideo", null, loadAndPlayVideo);
function loadAndPlayVideo(uri:String):void
{
       videoPlayer.contentPath = uri;
} 
```

然后在 C# 中；添加 ActiveX 控件的实例并将内容添加到构造函数中。

```
private AxShockwaveFlash flashPlayer;
public FLVPlayer ()
{

      // Add Error Handling; to condense I left out.
      flashPlayer.LoadMovie(0, Application.StartupPath + "\\player.swf");
}

fileDialog = new OpenFileDialog();
fileDialog.Filter = "*.flv|*.flv";
fileDialog.Title = "Select a Flash Video File...";
fileDialog.Multiselect = false;
fileDialog.RestoreDirectory = true;

if (fileDialog.ShowDialog() == DialogResult.OK)
{
     flashPlayer.CallFunction("<invoke" + " name=\"loadAndPlayVideo\" returntype=\"xml">       <arguements><string>" + fileDialog.FileName + "</string></arguements></invoke>");
} 
```

与 C# 的 ActionScript 通信：

```
import flash.external.ExternalInterface;
ExternalInterface.call("ResizePlayer", videoPlayer.metadata.width, videoPlayer.metadata.height);

flashPlayer.FlashCall += new _IShockwaveFlashEvents_FlashCallEventHandler(flashPlayer_FlashCall); 
```

然后应该出现 XML：

```
<invoke name="ResizePlayer" returntype="xml">
     <arguements>
            <number> 320 </number>
            <number> 240 </number>
     </arguments>
</invoke> 
```

然后在事件处理程序中解析 XML 并在本地调用 C# 函数。

```
 XmlDocument document = new XmlDocument();
    document.LoadXML(e.request);
    XmlNodeList list = document.GetElementsByTagName("arguements");
    ResizePlayer(Convert.ToInt32(list[0].FirstChild.InnerText),   Convert.ToInt32(list[0].ChildNodes[1].InnerText)); 
```

现在他们都在来回传递数据。这是一个基本的例子；但是通过使用 ActionScript Communication，您应该不会在使用本机 API 时遇到任何问题。

希望这更有帮助。您可以通过实用程序类扩展该想法以供重用。显然上面的代码有一些限制；但希望它为您指明正确的方向。是你试图去的那个方向吗？还是我仍然没有抓住重点？

* * *

创建一个新的 Flash 电影；在 ActionScript 3 中。然后在最初的第一帧；应用以下内容：

```
Security.allowDomain("www.youtube.com");
var my_player:Object;
var my_loader:Loader = new Loader();

my_loader.load(new URLRequest("http://www.youtube.com/apiplayer?version=3"))
my_loader.contentLoaderInfo.addEventListener(Event.INIT, onLoaderInit);

function onLoaderInit(e:Event):void{
addChild(my_loader);
my_player = my_loader.content;
my_player.addEventListener("onReady", onPlayerReady); 
} 

function onPlayerReady(e:Event):void{
my_player.setSize(640,360);
my_player.loadVideoById("_OBlgSz8sSM",0);
} 
```

那么该脚本到底在做什么呢？它利用本机 API 并使用 ActionScript 通信。所以下面我将分解每一行。

```
Security.allowDomain("www.youtube.com"); 
```

如果没有这条线，YouTube 将不会与该对象进行交互。

```
var my_player:Object; 
```

您不能只是将电影加载到电影中；所以我们将创建一个*变量 Object*。您必须加载包含对这些代码的访问权限的特殊 .swf。下面; 就是这样做的。这样您就可以访问 API。

```
var my_loader:Loader = new Loader();
my_loader.load(new URLRequest("http://www.youtube.com/apiplayer?version=3")); 
```

我们现在根据他们的文档引用 Google API。

```
my_loader.contentLoaderInfo.addEventListener(Event.INIT, onLoaderInit); 
```

但是为了实际使用我们的对象；我们需要等待它完全初始化。所以**事件监听器**会等待；所以我们知道什么时候可以向它传递命令。

该`onLoaderInit`函数将在初始化时触发。然后它的第一个任务是`my_loader`显示列表，以便显示视频。

这`addChild(my_loader);`是将加载一个；将`my_player = my_loader.content;`存储一个引用以便于访问对象。

虽然它已经初始化了；您必须等待更远...您曾经`my_player.addEventListener("onReady", onPlayerReady);`等待并侦听那些自定义事件。这将允许稍后的函数处理。

现在播放器已准备好进行基本配置；

```
function onPlayerReady(e:Event):void{
my_player.setSize(640,360);
} 
```

上面的函数开始了非常基本的操作。然后最后一行`my_player.loadVideoById("_OBlgSz8sSM",0);`是引用特定的视频。

然后在你的舞台上；您可以创建两个按钮并应用：

```
play_btn.addEventListener(MouseEvent.CLICK, playVid); 
function playVid(e:MouseEvent):void { 
my_player.playVideo(); 
} 
pause_btn.addEventListener(MouseEvent.CLICK, pauseVid); 
function pauseVid(e:MouseEvent):void { 
my_player.pauseVideo();
} 
```

这将为您提供播放和暂停功能。您可以使用我们的一些附加项目：

```
loadVideoById() 
cueVideoById() 
playVideo() 
pauseVideo() 
stopVideo() 
mute()
unMute() 
```

请记住，在完全初始化之前不能使用或调用它们。但是使用它；使用较早的方法应该允许您布局目标并实际在两者之间传递变量以进行操作。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T12:18:03.033

经过多次尝试和锤击，我找到了解决方案：

似乎`Error HRESULT E_FAIL...`当闪存不理解请求的闪存调用时会发生这种情况。此外，要使 youtube 外部 api 正常工作，还需要启用[js api ：](https://developers.google.com/youtube/js_api_reference#GettingStarted)

```
player.movie = "http://www.youtube.com/v/VIDEO_ID?version=3&enablejsapi=1" 
```

正如我在问题中所说，整个程序是开源的，所以你可以在[bitbucket](http://bit.ly/Tplayer)找到完整的代码。
任何意见、建议或合作者都将受到高度赞赏。

## 完整的解决方案：

这是嵌入 YouTube 播放器或任何其他 Flash 对象并与之交互的完整指南。

按照[视频教程](http://www.youtube.com/watch?v=kg-z8JfOIKw)完成后 ，将 flash 播放器的`FlashCall`事件设置为处理**flash->c#**交互的函数（在我的示例中为`YTplayer_FlashCall`）

### 生成的 `InitializeComponent()` 应该是：

```
...
this.YTplayer = new AxShockwaveFlashObjects.AxShockwaveFlash();
this.YTplayer.Name = "YTplayer";
this.YTplayer.Enabled = true;
this.YTplayer.OcxState = ((System.Windows.Forms.AxHost.State)(resources.GetObject("YTplayer.OcxState")));
this.YTplayer.FlashCall += new AxShockwaveFlashObjects._IShockwaveFlashEvents_FlashCallEventHandler(this.YTplayer_FlashCall);
... 
```

### FlashCall 事件处理程序

```
private void YTplayer_FlashCall(object sender, AxShockwaveFlashObjects._IShockwaveFlashEvents_FlashCallEvent e)
{
    Console.Write("YTplayer_FlashCall: raw: "+e.request.ToString()+"\r\n");
    // message is in xml format so we need to parse it
    XmlDocument document = new XmlDocument();
    document.LoadXml(e.request);
    // get attributes to see which command flash is trying to call
    XmlAttributeCollection attributes = document.FirstChild.Attributes;
    String command = attributes.Item(0).InnerText;
    // get parameters
    XmlNodeList list = document.GetElementsByTagName("arguments");
    List<string> listS = new List<string>();
    foreach (XmlNode l in list){
        listS.Add(l.InnerText);
    }
    Console.Write("YTplayer_FlashCall: \"" + command.ToString() + "(" + string.Join(",", listS) + ")\r\n");
    // Interpret command
    switch (command)
    {
        case "onYouTubePlayerReady": YTready(listS[0]); break;
        case "YTStateChange": YTStateChange(listS[0]); break;
        case "YTError": YTStateError(listS[0]);  break;
        default: Console.Write("YTplayer_FlashCall: (unknownCommand)\r\n"); break;
    }
} 
```

这将解决**flash->c#**通信

### 调用 flash 外部函数（c#->flash）：

```
private string YTplayer_CallFlash(string ytFunction){
    string flashXMLrequest = "";
    string response="";
    string flashFunction="";
    List<string> flashFunctionArgs = new List<string>();

    Regex func2xml = new Regex(@"([a-z][a-z0-9]*)(\(([^)]*)\))?", RegexOptions.Compiled | RegexOptions.IgnoreCase);
    Match fmatch = func2xml.Match(ytFunction);

    if(fmatch.Captures.Count != 1){
        Console.Write("bad function request string");
        return "";
    }

    flashFunction=fmatch.Groups[1].Value.ToString();
    flashXMLrequest = "<invoke name=\"" + flashFunction + "\" returntype=\"xml\">";
    if (fmatch.Groups[3].Value.Length > 0)
    {
        flashFunctionArgs = pars*emphasized text*eDelimitedString(fmatch.Groups[3].Value);
        if (flashFunctionArgs.Count > 0)
        {
            flashXMLrequest += "<arguments><string>";
            flashXMLrequest += string.Join("</string><string>", flashFunctionArgs);
            flashXMLrequest += "</string></arguments>";
        }
    }
    flashXMLrequest += "</invoke>";

    try
    {
        Console.Write("YTplayer_CallFlash: \"" + flashXMLrequest + "\"\r\n");
        response = YTplayer.CallFunction(flashXMLrequest);                
        Console.Write("YTplayer_CallFlash_response: \"" + response + "\"\r\n");
    }
    catch
    {
        Console.Write("YTplayer_CallFlash: error \"" + flashXMLrequest + "\"\r\n");
    }

    return response;
}

private static List<string> parseDelimitedString (string arguments, char delim = ',')
{
    bool inQuotes = false;
    bool inNonQuotes = false;
    int whiteSpaceCount = 0;

    List<string> strings = new List<string>();

    StringBuilder sb = new StringBuilder();
    foreach (char c in arguments)
    {
        if (c == '\'' || c == '"')
        {
            if (!inQuotes)
                inQuotes = true;
            else
                inQuotes = false;

            whiteSpaceCount = 0;
        }else if (c == delim)
        {
            if (!inQuotes)
            {
                if (whiteSpaceCount > 0 && inQuotes)
                {
                    sb.Remove(sb.Length - whiteSpaceCount, whiteSpaceCount);
                    inNonQuotes = false;
                }
                strings.Add(sb.Replace("'", string.Empty).Replace("\"", string.Empty).ToString());
                sb.Remove(0, sb.Length);                       
            }
            else
            {
                sb.Append(c);
            }
            whiteSpaceCount = 0;
        }
        else if (char.IsWhiteSpace(c))
        {                    
            if (inNonQuotes || inQuotes)
            {
                sb.Append(c);
                whiteSpaceCount++;
            }
        }
        else
        {
            if (!inQuotes) inNonQuotes = true;
            sb.Append(c);
            whiteSpaceCount = 0;
        }
    }
    strings.Add(sb.Replace("'", string.Empty).Replace("\"", string.Empty).ToString());

    return strings;
} 
```

### 添加 Youtube 事件处理程序：

```
private void YTready(string playerID)
{
    YTState = true;
    //start eventHandlers
    YTplayer_CallFlash("addEventListener(\"onStateChange\",\"YTStateChange\")");
    YTplayer_CallFlash("addEventListener(\"onError\",\"YTError\")");
}
private void YTStateChange(string YTplayState)
{
    switch (int.Parse(YTplayState))
    {
        case -1: playState = false; break; //not started yet
        case 1: playState = true; break; //playing
        case 2: playState = false; break; //paused
        //case 3: ; break; //buffering
        case 0: playState = false; if (!loopFile) mediaNext(); else YTplayer_CallFlash("seekTo(0)"); break; //ended
    }
}
private void YTStateError(string error)
{
    Console.Write("YTplayer_error: "+error+"\r\n");
} 
```

### 用法例如：

```
YTplayer_CallFlash("playVideo()");
YTplayer_CallFlash("pauseVideo()");
YTplayer_CallFlash("loadVideoById(KuNQgln6TL0)");
string currentVideoId = YTplayer_CallFlash("getPlaylist()");
string currentDuration = YTplayer_CallFlash("getDuration()"); 
```

函数`YTplayer_CallFlash`,`YTplayer_FlashCall`应该适用于任何带有细微调整的**flash-C#**`YTplayer_CallFlash`通信，例如's 开关（命令）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-16T22:01:58.240

我首先要确保 javascript 可以与您的 Flash 应用程序对话。

确保您有：`allowScriptAccess="sameDomain"`在嵌入中设置（来自[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html#includeExamplesSummary](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html#includeExamplesSummary)）。

您应该验证 html->flash 是否有效；然后 C->html; 并逐渐工作到 C->you-tube-component。你现在在 C 和 youtube 组件之间有很多潜在的故障点，很难同时解决所有这些问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-12T14:52:44.150

这让我难过了几个小时。

只需将启用 JS 添加到您的 URL：

[http://www.youtube.com/v/9bZkp7q19f0?version=3](http://www.youtube.com/v/9bZkp7q19f0?version=3) **&enablejsapi=1**

CallFunction 现在对我来说很好用！还要删除通话中不需要的空间。

# php - 分配图像，移动它并检索它 php

> ID：13260364
> 
> 赞同：1
> 
> 时间：2012-11-06T22:21:09.527
> 
> 标签：php, mysql, database, avatar

这个话题可能听起来很熟悉，但我对 Stackoverflow 提出的任何问题都不太满意。看到我正在创建一个只有少量成员的网站，比如大约 50 人。我已经创建了我的注册表单和登录表单。但是现在我不想为每个新注册的会员分配一个头像。当我的新会员注册成功时，将分配一个保存在服务器上的随机头像给他们。用户将在每次访问时随身携带此头像。所以要澄清我的问题：

如何为每个新用户分配一张随机图片并将图片保存到他们的`user_id`?

我目前正在使用 MySQL 并在 PHP 中进行编码。我有一个“选择随机图片”功能，但不确定如何与用户一起存储图片。我很高兴得到任何建议。

**编辑**

经过一些考虑，我已经能够陈述一个更清晰的目标。我将图像存储在文件系统中，我想随机分配给新成员，并且当图像被分配后，它应该被“拍摄”。因此，如果新用户注册，他将获得随机图像，而无法获得已拍摄的图像。

我只成功地创建了一个上传随机图像的生成器，但不能保证同一张图片不会再次出现：

```
 $avatarDir = 'members/images/avatars/';
                    $pics= glob($avatarDir . '*.{jpg,jpeg,png,gif}', GLOB_BRACE);
                    $randomPics = $pics[array_rand($pics)]; 
                    $query_new_user_picture = $this->connection->query("INSERT INTO my_images (image) VALUES('$randomPics')");
                    $results = mysql_query($query_new_user_picture); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:23:58.280

1.  在数据库中有一个字段，您可以在其中保存名称/id/文件路径/图片的任何内容。
2.  当用户注册时选择一张随机图片（`array_rand`, `shuffle`, 不管）。
3.  将随机选择的图片保存在数据库中的字段中。

有那么难吗？

* * *

```
$user = /* get user data from database */;

/**
 * assuming $user looks something like this:
 * 
 * array('name' => 'John Doe', 'email' => 'john@example.com',
 *       'profile_picture' => 'monster.jpeg');
 */

printf('<img src="img/profile_pictures/%s">', $user['profile_picture']);
// output: <img src="img/profile_pictures/monster.jpeg"> 
```

现在只需确保可以通过该 URL 访问该图像。

# objective-c - 字符串中的日期不起作用

> ID：13260365
> 
> 赞同：0
> 
> 时间：2012-11-06T22:21:10.837
> 
> 标签：objective-c, ios

代码：

```
NSString* mydate = @"11/06/2012 19:15:40";
NSLog(@"%@", mydate);

NSDateFormatter* dateFormatter1 = [[NSDateFormatter alloc] init];
dateFormatter1.dateFormat = @"MM-dd-yyyy HH:mm:ss";
NSDate* adate = [dateFormatter1 dateFromString:mydate];

NSLog(@"%@", adate); 
```

日志：

```
11/06/2012 19:15:40
(null) 
```

为什么我会为空？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:22:03.917

您的日期字符串使用斜杠，但您的格式说明符设置为查找破折号。

# sql-server-2008 - 如果 WHERE 条件为真，则将最后一行插入所选表之一

> ID：13260367
> 
> 赞同：0
> 
> 时间：2012-11-06T22:21:13.473
> 
> 标签：sql-server-2008

我目前在表中使用触发器将最后一行复制到基于 WHERE 条件和 ORDER BY 的指定表中。使用一个触发器可以正常工作并复制到相应的表中。但是两个触发器都在运行，导致前一行的重复出现在我不想插入的表中。（SQL2008 管理工作室）。我也有根据零件号发送此行的特定表。这是结构：

```
ALTER TRIGGER NewT3650 ON JD_Passdata
FOR INSERT 
AS
INSERT T3_650_TestData (SerialNumber, Partnumber, etc)
SELECT TOP 1 SerialNumber, Partnumber, etc
FROM JD_Passdata
WHERE partnumber = 'T3_650'
ORDER BY passdata_ndx DESC

ALTER TRIGGER NewT4450 ON JD_Passdata
FOR INSERT 
AS
INSERT T4_450_TestData (SerialNumber, Partnumber, etc)
SELECT TOP 1 SerialNumber, Partnumber, etc
FROM JD_Passdata
WHERE partnumber = 'T4_450'
ORDER BY passdata_ndx DESC 
```

原始 PassData 表：

```
201244999, T4_450
201245001, T3_650
201245002, T3_650
201245003, T3_650 
```

返回表 1 的结果

```
201245001, T3_650
201245002, T3_650
201245003, T3_650 
```

返回表 2 的结果

```
201244999, T4_450
201244999, T4_450
201244999, T4_450 
```

我希望这是一个 OR 条件或 UNION，它只取最后一行并将其输入到正确的表中，并尽可能删除额外的触发器。否则，检查重复和更新也可能会这样做。此外，数据库将变得非常大，以执行 DESC，每个条目可能会变慢。删除订单的方法也是一个考虑因素。

任何建议将不胜感激...... THX

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T18:11:44.443

我有一个适用于两个触发器的解决方案，但当出现“NULL”结果时可能会导致问题。它确实摆脱了 ORDER BY 并且可能更快。这样做是使用唯一的最后一行索引号作为行位置并检查部件号以确定插入到新表中。此外，当我为不同的表添加使用相同格式的第三个触发器时，初始移动到主表 (JD_PassData) 失败。还不知道为什么。

这是新代码：

ALTER TRIGGER NewT3650 ON JD_Passdata 后插入为 INSERT T3_650_TestData（序列号、零件号等）从 JD_Passdata 中选择序列号、零件号等，其中 passdata_ndx=（从 JD_PassData 中选择 MAX（passdata_ndx））AND PartNumber = 'T3_650'

# jquery - Xcode UIWebView 与 SQLite 数据库

> ID：13260369
> 
> 赞同：0
> 
> 时间：2012-11-06T22:21:20.750
> 
> 标签：jquery, database, xcode, sqlite, uiwebview

我正在创建一个使用 UIWebView 的 iPhone 应用程序，我有一个 MySQL 数据库，其中包含 7 个表和每个表中大约 100 行。我想避免使用 PHP，以便可以使用以下方法将 html 文件本地加载到我的应用程序中：

```
[myWebView loadRequest:[NSURLRequest requestWithURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"index" ofType:@"html"]isDirectory:NO]]]; 
```

而不是外部 URL...

我已导出 MySQL 数据库，并将所有信息格式化为 SQLite 数据库。

有没有办法将数据库添加到我的 Xcode 项目中，然后将数据查询到我的 HTML 文件中而无需访问互联网？

澄清一下，是否有本地化的离线替代方案：

```
<?php
include("connect.php");
$variable = mysql_query("SELECT * FROM table ORDER BY name");
?> 
```

本质上，我正在寻找一种 ALL jQuery 方法，以便我的应用程序不需要互联网！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:42:23.537

对于遇到这篇文章的任何人，我最终都使用`.getJSON()`了本地`.json`文件。

我将 json 文件包含在：

`<script type="text/javascript" src="data.json"></scipt>`

然后`getJSON`在需要的地方使用调用！它在没有互联网的情况下完美运行！

# regex - 检查符号范围的目录路径和“..”向上目录符号

> ID：13260371
> 
> 赞同：2
> 
> 时间：2012-11-06T22:21:25.913
> 
> 标签：regex, path, preg-match

我尝试构建 RegExp 来验证（preg_match）以下两个规则的一些路径字符串：

1.  路径必须仅包含给定范围内的符号`[a-zA-z0-9-_\///\.]`
2.  路径将不包含向上目录序列“..”

这是一个正确的路径示例：`/user/temp`

和坏的：`/../user`

**UPD：** `/user/temp.../foo` 也是正确的（感谢*Laurence Gonsalves*）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:29:26.320

考虑一下：

```
$right_path = '/user/temp';
$wrong_path = '/../user';
$almost_wrong_path = 'foo/abc../bar';
$almost_right_path = 'foo/../bar';

$pattern = '#^(?!.*[\\/]\.{2}[\\/])(?!\.{2}[\\/])[-\w.\\/]+$#';
var_dump(preg_match($pattern, $right_path)); // 1
var_dump(preg_match($pattern, $wrong_path)); // 0
var_dump(preg_match($pattern, $almost_wrong_path)); // 1
var_dump(preg_match($pattern, $almost_right_path)); // 0 
```

我实际上分三个步骤构建了这个模式：

1) 给出的第一条规则说，字符串中只允许使用的符号是`0-9`, `a-zA-Z`, `_`(下划线), `-`(hyphen), `.`(dot) 和斜线 (`/`和`\`)。前三个位置可以用快捷方式 ( `\w`) 表示，其他位置需要字符类：

```
[-\w.\\/] 
```

这里注意两点：1）连字符应该是字符类中的第一个或最后一个符号（否则它被视为用于定义范围的元字符）；2）点和正斜杠都还没有转义（反斜杠被转义了；它太强大了，不能单独使用，即使在`[...]`子表达式中也是如此）。

2) 现在我们必须确保模式确实覆盖了整个字符串。我们用所谓的锚点来做 -`^`​​ 用于字符串的开头，`$`用于结尾。而且，不要忘记我们的字符串可能包含一个或多个允许的符号（这用量词表示`+`）。所以模式变成了这样：

```
^[-\w.\\/]+$ 
```

3）最后一件事——我们也必须防止使用`../`and `..\`（如果序列开始字符串，则在`/`or之前`\`- 或不使用）。`..[/\\]`

表达此规则的最简单方法是使用所谓的“[否定前瞻](http://www.regular-expressions.info/lookaround.html)”测试。它写在 (?!...) 子表达式中，并且（在这种情况下）描述了以下想法：'确保零个或多个符号的序列后面没有“斜线-两个点-斜线”序列'：

```
^(?!.*[\\/]\.{2}[\\/])(?!\.{2}[\\/])[-\w.\\/]+$ 
```

最后一件事实际上是将模式放入`preg_match`函数中：当我们`/`在正则表达式中使用符号时，我们可以选择另一组分隔符。在我的示例中，我选择了“#”：

```
$pattern = '#^(?!.*[\\/]\.{2}[\\/])(?!\.{2}[\\/])[-\w.\\/]+$#'; 
```

看？这真的很容易。) 你只需要从小事做起，逐步发展。

# windows - 根据文件名的部分查找和移动psedo重复文件

> ID：13260372
> 
> 赞同：0
> 
> 时间：2012-11-06T22:21:35.587
> 
> 标签：windows, file, batch-file

我有一个目录，里面装满了从数据库中导出的文件。每天都会创建文件，并在文件名末尾附加一个版本。

文件名语法：DocumentNumber_DocumentName_Version.pdf

目标：使用 Windows 批处理文件将旧版本的新文件移动到 /old 文件夹。在过去 24 小时内没有新版本的现有文件将被忽略。

DocumentNumber 可以是可变长度，可以包含破折号，以下划线结尾 DocumentName：可以是可变长度，包括破折号、空格和/或下划线，并且可以随时间变化 版本总是在最后，它以下划线开头。是字母数字，字母总是递增。

Ex1：不同版本的文件：目录有....

```
D00003456_BTW-FW001_OPTB_A12.pdf
D00003456_BTW-FW001_OPTB_B9.pdf
D00003456_BTW-FW001_OPTB_C6.pdf
D00003456_BTW-FW001_OPTB_D2.pdf (new)

DocumentNumber is D00003456
DocumentName is BTW-FW001_OPTB
Version is either A12, B9, C6 or D2

** Would like to move all to old folder except D2 
```

Ex2：DocumentName 可以从一个版本更改为另一个版本：目录有...

```
DPP-456_BTW-FW001_OPTB_A1.pdf
DPP-456_BTW-FW001_OPTB_C45.pdf
DPP-456_NEW WIDGET_F6.pdf
DPP-456_NEWER WIDGET_Blue_W2.pdf (new)

DocumentNumber is DPP-456
DocumentName is BTW-FW001_OPTB, "NEW WIDGET" or "NEWER WIDGET_Blue"
Version is either A1, C45, F6 or W2

** Would like to move all to old folder except W2 
```

Ex3：只移动旧版本保留所有文件的最新版本：目录有...

```
SD0001_I001_A1.pdf
SD0001_ClassyWidget_C45.pdf (new)
SD0034_WIDGET_F6.pdf
00000056_NEWER WIDGET_Gray_W2.pdf

DocumentNumber is SD0001, SD0034 and 00000056
DocumentName is I001, ClassyWidget, "WIDGET" or "NEWER WIDGET_Gray"
Version is either A1, C45, F6 or W2

** Would like to move SD001 all to old folder except C45, others (SD0034 and 00000056) would be ignored 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:09:00.520

读了几遍这个话题，我得出的结论是，同一文档的所有版本都可以识别，因为它们都具有*相同的文档编号*（您应该说明这一点，而不是向我们展示多个示例并让我们猜测）。

下面的批处理文件解决了您的问题。

```
@echo off
setlocal EnableDelayedExpansion
set prevName=
for %%a in (*.pdf) do (
   if not defined prevName (
      rem Initialize process with first name and DocumentNumber
      set prevName=%%a
      for /F "delims=_" %%b in ("%%a") do set prevNumber=%%b
   ) else (
      rem Check if next name have the same DocumentNumber
      set nextName=%%a
      for /F "delims=_" %%b in ("%%a") do set nextNumber=%%b
      if "!prevNumber!" equ "!nextNumber!" (
         rem Yes: Two versions of same file, move the older one
         ECHO move "!prevName!" "C:\dest\dir"
      ) else (
         rem No: Different files, update DocumentNumber
         set prevNumber=!nextNumber!
      )
      rem Anyway, previous name was processed
      set prevname=!nextName!
   )
) 
```

磁盘上的文件：

```
00000056_NEWER WIDGET_Gray_W2.pdf
D00003456_BTW-FW001_OPTB_A12.pdf
D00003456_BTW-FW001_OPTB_B9.pdf
D00003456_BTW-FW001_OPTB_C6.pdf
D00003456_BTW-FW001_OPTB_D2.pdf
DPP-456_BTW-FW001_OPTB_A1.pdf
DPP-456_BTW-FW001_OPTB_C45.pdf
DPP-456_NEW WIDGET_F6.pdf
DPP-456_NEWER WIDGET_Blue_W2.pdf
SD0001_ClassyWidget_C45.pdf
SD0001_I001_A1.pdf
SD0034_WIDGET_F6.pdf 
```

程序结果：

```
move "D00003456_BTW-FW001_OPTB_A12.pdf" "C:\dest\dir"
move "D00003456_BTW-FW001_OPTB_B9.pdf" "C:\dest\dir"
move "D00003456_BTW-FW001_OPTB_C6.pdf" "C:\dest\dir"
move "DPP-456_BTW-FW001_OPTB_A1.pdf" "C:\dest\dir"
move "DPP-456_BTW-FW001_OPTB_C45.pdf" "C:\dest\dir"
move "DPP-456_NEW WIDGET_F6.pdf" "C:\dest\dir"
move "SD0001_ClassyWidget_C45.pdf" "C:\dest\dir" 
```

***编辑**：回答新评论*

正如我之前所说，您的解释不清楚，因此我的解决方案基于您的示例。我之前的代码可以正确地与您的原始示例一起使用，但有一种情况除外：Ex3 中的文档编号 SD0001。但是，在这种情况下，您以相反的顺序列出了文件 I001 和 ClassyWidget *！*. DIR 和 FOR 命令都首先列出 ClassyWidget，然后是 I001。你为什么把它们颠倒过来？当我阅读问题描述时，我专注于如何解决它，而不是检查OP给出的数据是对还是错！这样，我的解决方案将最后列出的文件作为旧版本提供（如所有示例中所示）。

这个新的“细节”导致了一个完全不同的解决方案，因为它现在需要两次遍历所有文件来首先识别每个 DocNumber 的最后一个版本。尽管在问题描述中您说“DocumentName 可以包含下划线”，但显示的所有示例都只包含*一个*下划线。当 DocumentName 只有一个或没有下划线时，下面的新解决方案可以正确获取旧版本；如果它可能有*多个*下划线，则需要进行“小”修改。

```
@echo off
setlocal EnableDelayedExpansion
rem First pass: get oldest version of each DocNumber
for %%a in (*.pdf) do (
   rem docNumber=First token (%%b), version=fourth (%%e) or third (%%d) token
   for /F "tokens=1-4 delims=_" %%b in ("%%~Na") do (
      set version=%%e
      if not defined version set version=%%d
      if "!version!" gtr "!oldestVersion[%%b]!" set oldestVersion[%%b]=!version!
   )
)
rem Second pass: move all versions of each DocNumber, except the oldest one
for %%a in (*.pdf) do (
   for /F "tokens=1-4 delims=_" %%b in ("%%~Na") do (
      set version=%%e
      if not defined version set version=%%d
      if "!version!" neq "!oldestVersion[%%b]!" ECHO move "%%a" "C:\dest\dir"
   )
) 
```

磁盘上的文件：

```
00000056_NEWER WIDGET_Gray_W2.pdf
BI0000018307_MW531-ABZ2-Bond-Resc_xls_D2.pdf
BI0000018307_MW531-Triton-Bond-Res_xls_B9.pdf
BI0000018307_MW531-Triton-Bond-Res_xls_C5.pdf
D00003456_BTW-FW001_OPTB_A12.pdf
D00003456_BTW-FW001_OPTB_B9.pdf
D00003456_BTW-FW001_OPTB_C6.pdf
D00003456_BTW-FW001_OPTB_D2.pdf
DPP-456_BTW-FW001_OPTB_A1.pdf
DPP-456_BTW-FW001_OPTB_C45.pdf
DPP-456_NEW WIDGET_F6.pdf
DPP-456_NEWER WIDGET_Blue_W2.pdf
SD0001_ClassyWidget_C45.pdf
SD0001_I001_A1.pdf
SD0034_WIDGET_F6.pdf 
```

程序结果：

```
move "BI0000018307_MW531-Triton-Bond-Res_xls_B9.pdf" "C:\dest\dir"
move "BI0000018307_MW531-Triton-Bond-Res_xls_C5.pdf" "C:\dest\dir"
move "D00003456_BTW-FW001_OPTB_A12.pdf" "C:\dest\dir"
move "D00003456_BTW-FW001_OPTB_B9.pdf" "C:\dest\dir"
move "D00003456_BTW-FW001_OPTB_C6.pdf" "C:\dest\dir"
move "DPP-456_BTW-FW001_OPTB_A1.pdf" "C:\dest\dir"
move "DPP-456_BTW-FW001_OPTB_C45.pdf" "C:\dest\dir"
move "DPP-456_NEW WIDGET_F6.pdf" "C:\dest\dir"
move "SD0001_I001_A1.pdf" "C:\dest\dir" 
```

**编辑：***相同*问题的第三个解决方案...

```
@echo off
setlocal EnableDelayedExpansion

rem Filename syntax: DocumentNumber_DocumentName_Version.pdf
rem May be spaces and underscores in DocumentName
rem Goal: Find last Version of same DocumentNumber and keep it (DocumentName don't cares)
rem       Move the rest to other folder

rem First pass: Create *ordered* FILE array with this format: FILE[docNumber,Version.pdf]=docName
for %%a in (*.pdf) do (
   set "fileName=%%a"
   rem Change spaces by slashes in DocumentName
   set fileName=!fileName: =/!
   rem DocumentNumber=first token, Version=last token; separated by underscores
   set docNumber=
   for %%b in (!fileName:_^= !) do (
      if not defined docNumber (
         set docNumber=%%b
      ) else (
         set Version=%%b
      )
   )   
   rem Eliminate DocumentNumber and Version from filename (get DocumentName)
   set fileName=!fileName:*_=!
   for %%v in (!Version!) do set docName=!filename:_%%v=!
   rem Create the array element, restoring spaces in DocumentName
   set FILE[!docNumber!,!Version!]=!docName:/= !
)

rem Delete REM part in two next commands if you want to review the created FILE array
REM SET FILE[
REM ECHO/

rem Second pass: Move all array elements of same DocumentNumber, except the last one
set docNumber=/
for /F "tokens=2-4 delims=[,]=" %%a in ('set FILE[') do (
   rem %%a=docNumber, %%b=Version.pdf, %%c=docName
   if "!docNumber!" equ "%%a" (
      ECHO move "!docNumber!_!docName!_!Version!" "C:\dest\dir"
   )
   set docNumber=%%a
   set docName=%%c
   set Version=%%b
) 
```

# bash - 用于文本操作的 Shell 脚本/命令

> ID：13260386
> 
> 赞同：1
> 
> 时间：2012-11-06T22:22:41.977
> 
> 标签：bash, shell, sed, awk, grep

> **可能重复：**
> [用于格式化输出的 Shell 脚本](https://stackoverflow.com/questions/13259293/shell-script-for-formatting-output)

我有一个 jacl 脚本，它会吐出下面的文本，我希望它的格式更好。我怎样才能做到这一点？

```
Stats for Cell=CELL Node=N01 Server=APP at 15:48:06
Stats name=WebContainer, type=threadPoolModule
name=PoolSize, ID=4, description=The average number of threads in a pool., unit=N/A, type=BoundedRangeStatistic, lowWaterMark=1, highWaterMark=50, current=4, integral=9.16145228E8, lowerBound=50, upperBound=50
Stats name=ORB.thread.pool, type=threadPoolModule
name=PoolSize, ID=4, description=The average number of threads in a pool., unit=N/A, type=BoundedRangeStatistic, lowWaterMark=1, highWaterMark=10, current=1, integral=1.26898089E8, lowerBound=10, upperBound=50
Stats name=WorkManager.BPENavigationWorkManager, type=threadPoolModule
name=PoolSize, ID=4, description=The average number of threads in a pool., unit=N/A, type=BoundedRangeStatistic, lowWaterMark=1, highWaterMark=10, current=5, integral=8.53089448E8, lowerBound=1, upperBound=5
Stats name=WorkManager.BPESchedulerWorkManager, type=threadPoolModule
name=PoolSize, ID=4, description=The average number of threads in a pool., unit=N/A, type=BoundedRangeStatistic, lowWaterMark=1, highWaterMark=1, current=0, integral=0.0, lowerBound=1, upperBound=5Scrits commands to convert the above to below.(Awk or sed ?) 
```

我希望如何查看输出。

```
CELL:N01:APP at 15:48:06
WebContainer threadPool current=4
ORB.thread.pool threadPool current=1
WorkManager.BPENavigationWorkManager threadPool current=5
WorkManager.BPESchedulerWorkManager threadPool current=0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:33:01.203

对于格式化，perl 可能是要走的路。您也可以从命令行使用 perl。[http://www.perl.com/pub/2004/08/09/commandline.html](http://www.perl.com/pub/2004/08/09/commandline.html)

尽管出于您的目的，我建议您编写一个简单的 perlscript，它看起来像

```
while(<>){
 chomp;
 $line = $_;
 $line =~ s/Stats for Cell=//;
 $line =~ s/ Node=/:/;
 ...etc
 print $line;
} 
```

# ruby-on-rails - 在 Rails 中使用 /lib/ 子目录 - 用于查看内容

> ID：13260387
> 
> 赞同：1
> 
> 时间：2012-11-06T22:22:45.267
> 
> 标签：ruby-on-rails

这是一个与我之前发布的帖子相关的不断发展的问题......

我正在玩一些 - 试图了解`/lib/`Rails 中的目录是如何工作的 - 以及如何引用`/lib/`目录中定义的变量以在视图中使用。

我有一个名为的文件`helloworld.rb`，它保存`/lib/hellotest/`在 Rails 的一个目录中。

该`helloworld.rb`文件具有以下代码：

```
module HelloWorld
  def hello
    @howdy = "Hello World!"
  end
end 
```

我希望能够在名为 的视图上显示此方法的结果`index.html.erb`，因此我在文件中包含以下代码`index_helper.erb`：

```
module IndexHelper
  require 'helloworld'
end 
```

我了解到我需要在`/config/application.rb`文件中包含以下代码行：

```
config.autoload_paths += %W(#{Rails.root}/lib/hellotest/) 
```

另外，我在视图中包含以下代码`index.html.erb`：

```
<%= @howdy %> 
```

我想我可能发现了一些导致问题的东西。我不想`/lib/`在启动时加载整个目录，所以我将文件放在一个名为`/lib/hellotest/`. 我读过 Rails 如何解释 lib 文件夹中的模块/类命名约定存在一些问题，但我不太明白。[在第 2 点，我在William B Harding 的博客](http://www.williambharding.com/blog/technology/rails-3-autoload-modules-and-classes-in-production/)上看到了关于我的问题的可能解决方案的一个很好的资源- 但我不能完全理解这个解决方案，因为它与我的问题有关。

请问有什么建议吗？

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:28:02.720

我建议除非您有充分的理由不这样做，否则请遵循模块和类的常规命名（如您提供的[链接](http://www.williambharding.com/blog/technology/rails-3-autoload-modules-and-classes-in-production/)中所述）。重命名`helloworld.rb`为`hello_world.rb`，将其移动到`lib`，然后将您的更改`autoload_paths`为：

```
 config.autoload_paths += %W(#{Rails.root}/lib/) 
```

最后，在您的模块中更改`require 'hello_world'`为。然后它应该正常加载。`require 'hello_world'``IndexHelper`

# android - 监控配对蓝牙设备的连接

> ID：13260391
> 
> 赞同：3
> 
> 时间：2012-11-06T22:23:00.457
> 
> 标签：android, bluetooth

我已经编写了代码，它返回了一个 android 设备的所有配对蓝牙设备的列表。配对蓝牙设备列表中的一个也是我的笔记本电脑。

现在我的问题是

有没有办法可以监控笔记本电脑和安卓设备之间的蓝牙连接状态。如果有蓝牙连接，我需要的输出是“已连接”，如果没有蓝牙连接，我需要的输出是“断开连接”

* * *

安卓版本是2.1.Eclair

在我继续之前，我有一些问题。

->当我通过 USB 连接笔记本电脑和设备时，我应该测试这个应用程序吗？-> 如何在单独的线程上或从 AsyncTask 运行它？-> 如果我通过 USB 连接设备和笔记本电脑然后启动应用程序，上面的代码对我不起作用。即使笔记本电脑和手机在附近并且已配对，我也无法在手机中看到连接状态。

我写的代码如下

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_bluetooth_);

    out = (TextView) findViewById(R.id.textView1);

    // Getting the Bluetooth adapter
    BluetoothAdapter adapter = BluetoothAdapter.getDefaultAdapter();
    // out.append("\nAdapter: " + adapter);

    // Check for Bluetooth support in the first place
    // Emulator doesn't support Bluetooth and will return null
    if (adapter == null) {
        out.append("\nBluetooth NOT supported. Aborting.");
        return;
    }

    // Starting the device discovery
    out.append("\nStarting discovery...");
    adapter.startDiscovery();
    out.append("\nDone with discovery...");

    // Listing paired devices
    out.append("\nDevices Pared:");
    Set<BluetoothDevice> devices = BluetoothAdapter.getDefaultAdapter()
            .getBondedDevices();

    for (BluetoothDevice device : devices) {
        out.append("\nFound device: " + device);
        out.append("\n The name is: " + device.getName());
        out.append("\n The type is: "
                + device.getBluetoothClass().getDeviceClass());

        Method m;
        try {
            System.out.println("Trying to connect to " + device.getName());
            m = device.getClass().getMethod("createInsecureRfcommSocket",
                    new Class[] { int.class });
            BluetoothSocket socket = (BluetoothSocket) m.invoke(device, 1);
            socket.connect();
            out.append("Connected");
        } catch (Exception e) {
            e.printStackTrace();
            out.append("\nDisconnected");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T04:21:59.300

你用的是哪个安卓版本？

您必须拥有 AndroidManifest.xml 的权限：

```
<uses-permission android:name="android.permission.BLUETOOTH" /> 
```

您可以尝试下面的代码，但请确保在单独的线程上或从[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)运行它，否则您的 UI 可能会挂起。这将检查您的配对设备并尝试连接到每个设备。如果成功，则在 logcat 上打印**Connected**，否则打印**Disconnected**。

```
private void checkPairedPrinters() throws IOException {
        Set<BluetoothDevice> devices = BluetoothAdapter.getDefaultAdapter().getBondedDevices();
        for (BluetoothDevice device : devices) {
            Method m;
            try {
                System.out.println("Trying to connect to " + device.getName());
                m = device.getClass().getMethod("createInsecureRfcommSocket", new Class[] { int.class });
                BluetoothSocket socket = (BluetoothSocket) m.invoke(device, 1);
                socket.connect();
                System.out.println("Connected");
            } catch (Exception e) {
                e.printStackTrace();
                System.out.println("Disconnected");
            }
        }

} 
```

# makefile - GNU make 3.81：评估函数不起作用？

> ID：13260396
> 
> 赞同：12
> 
> 时间：2012-11-06T22:23:23.977
> 
> 标签：makefile, eval

我最近从 GNU make 文档中找到了这段引用 eval 函数的示例代码。我真的很喜欢它，但是当我尝试在我的机器上测试它（make 3.81/Debian）时，它所做的只是尝试链接服务器而不先编译 c 文件......为什么？make 3.81 不兼容吗？

外壳输出：

```
$ make
cc     -o server
cc: no input files 
```

代码：

```
 PROGRAMS    = server client

 server_OBJS = server.o server_priv.o server_access.o
 server_LIBS = priv protocol

 client_OBJS = client.o client_api.o client_mem.o
 client_LIBS = protocol

 # Everything after this is generic

 .PHONY: all
 all: $(PROGRAMS)

 define PROGRAM_template =
  $(1): $$($(1)_OBJS) $$($(1)_LIBS:%=-l%)
  ALL_OBJS   += $$($(1)_OBJS)
 endef

 $(foreach prog,$(PROGRAMS),$(eval $(call PROGRAM_template,$(prog))))

 $(PROGRAMS):
         $(LINK.o) $^ $(LDLIBS) -o $@

 clean:
         rm -f $(ALL_OBJS) $(PROGRAMS) 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-07T04:41:42.957

我认为如果你`=`从`define`行中删除它会起作用：

```
define PROGRAM_template
  ...
endef 
```

我已经用 GNUMake 3.81 对此进行了测试。至于*为什么*这有效而手册中的版本无效，我不知道。

# javascript - JavaScript 或 IEEE-754 中的舍入怪癖？

> ID：13260399
> 
> 赞同：4
> 
> 时间：2012-11-06T22:23:31.247
> 
> 标签：javascript, math, ieee-754

我在我的一个单元测试中遇到了一个奇怪的问题，我在 JavaScript 中得到了意想不到的舍入结果：

```
(2.005).toFixed(2)
// produces "2.00"

(2.00501).toFixed(2)
// produces "2.01" 
```

最初我怀疑这是一个 Webkit 唯一的问题，但它在 Gecko 中重现，这对我来说意味着它是 ECMA-262 或 IEEE-754 的预期副作用。我假设 2.005 的二进制表示会稍微少一点？或者 ECMA-262 是否指定了一种四舍五入的方法`toFixed`？

任何人都愿意对引擎盖下发生的事情有所了解，只是为了让我高枕无忧？

**更新：**感谢您的评论。

我应该补充一下，让我有点紧张的一件事是在 Webkit 中的快速搜索中发现的评论`dtoa.cpp`似乎暗示有多种舍入路径，开发人员并不确定它是如何工作的，包括相关的`FIXME`：

[https://trac.webkit.org/browser/trunk/Source/WTF/wtf/dtoa.cpp#L1110](https://trac.webkit.org/browser/trunk/Source/WTF/wtf/dtoa.cpp#L1110)

此外，这并不是说它意义重大，而是 IE9 像我预期的那样对其进行了舍入，这意味着它不是 ECMA-262 的一部分，或者它们有一个错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-07T00:46:38.430

如果自ECMA 262 草案第[6](http://www.ecma-international.org/ecma-262/5.1/Ecma-262.pdf)版（5.1 版，2011 年 3 月）以来规范没有更改，则`(2.005).toFixed(2)`必须返回 string `"2.00"`，因为“数字值”是

> 对应于双精度 64 位二进制格式 IEEE 754 值的原始值

并且数字文字的解释在 7.8.3 和 8.5 中指定，以符合 IEEE 754“四舍五入到最接近”模式（关系四舍五入到偶数有效位），这`2.005`会导致值

```
x = 4514858626438922 * 2^(-51) = 2.00499999999999989341858963598497211933135986328125 
```

在处理的第 15.7.4.5 节中`toFixed`，相关的步骤 8。是：

> 让`n`是一个整数，其精确的数学值`n`÷ 10 ^f –`x`尽可能接近于零。如果有两个这样`n`的，选择较大的`n`。

和`2.00 - x`比 更接近零`2.01 - x`，所以`n`这里必须是 200。然后以自然方式进行到字符串的转换。

> 此外，这并不是说它意义重大，而是 IE9 像我预期的那样对其进行了舍入，这意味着它不是 ECMA-262 的一部分，或者它们有一个错误。

一个错误。也许他们试图走简单的路并乘以`10^digits`和舍入。`x*100`正是`200.5`，所以会产生一串`"2.01"`.

# javascript - 如何在 HTML 元素属性上存储 jquery 对象？

> ID：13260400
> 
> 赞同：0
> 
> 时间：2012-11-06T22:23:33.207
> 
> 标签：javascript, jquery

我有一个`<select>`表单元素，我在其中创建多个`<option>`子元素，该元素基于循环一个 jQuery 对象数组。

我想将每个与 an 关联的 jQuery 存储`<option>`在`<option>`自身上，我猜是一个属性。因此，当我触发更改事件时，我可以拉出`<option>`基于的 jQuery 对象。

我以为我可以使用 attr 设置它，将对象序列化为 JSON，但它不起作用。有任何想法吗？

这是一些代码：

```
// creating the select: (data is a jquery array of objects)
    $(data).each(function() {
        var opt = $('<option></option>').val(this[id_property]).html(this[label_property]);
        // preserve the original jquery object on this <option> element:
        opt.attr('json', JSON.stringify(this));
        $(select).append(opt);
    });

// bind the onchange event, and try to recreate that original jquery object
    $(select).bind('change', function(event) {
        // this gives me a ref to the <option> element:
        var val = $(select).find(":selected");
        // now how to get the original jquery object?
        var item = $(val).attr('json');        
    }); 
```

我希望将最后一行设置 var 项设置为原始 jquery 对象 - 或者以某种方式重新创建它。我什至尝试过`eval()`传入项目，因为它是 JSON 格式的，但它会引发错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T22:26:45.837

您可以利用[`data()`](http://api.jquery.com/jQuery.data/)jQuery 中的方法，这可能会为您带来最有利的结果，并让您能够避免不必要的自定义序列化。

# css - 背景设置为 100% 高度仍然重复

> ID：13260401
> 
> 赞同：1
> 
> 时间：2012-11-06T22:23:34.427
> 
> 标签：css, background, cross-browser

我有以下 CSS 代码。

```
body{
    height: 100%;
    min-height: 100%;
    max-height: 100%;
    background-color: #1468b3;
    background-image: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#2F2727), to(#1468b3));
    background-image: -webkit-linear-gradient(top, #2F2727, #1468b3);
    background-image:    -moz-linear-gradient(top, #2F2727, #1468b3);
    background-image:     -ms-linear-gradient(top, #2F2727, #1468b3);
    background-image:      -o-linear-gradient(top, #2F2727, #1468b3);
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#2F2727", endColorstr="#1468b3");
} 
```

无论页面的内容如何，​​都应该有一个从浏览器窗口顶部到底部延伸的漂亮渐变。此屏幕截图说明了该问题：

![在此处输入图像描述](../Images/15c798e6c65c7e64560f451ed4bef38a.png)

我不太确定为什么会这样。

添加

```
no-repeat; 
```

取消渐变，而背景是纯色`#1468b3`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:32:57.293

尝试添加`html { height: 100%; }`

# python - Qt：接管系统打开文件对话框

> ID：13260407
> 
> 赞同：2
> 
> 时间：2012-11-06T22:24:13.267
> 
> 标签：python, qt, pyqt4, qwebview, qfiledialog

我想使用 PyQt4 的 QWebView 自动将文件上传到网站，但有一部分我还不知道。要上传文件，该网站有一个按钮，它会打开一个对话框，您应该从中选择本地文件。所以，这些是我的问题:) 有没有办法在我点击按钮后控制该对话框？有没有更好的方法来实现这一目标？

*编辑*

该网站是[https://maps.google.com/](https://maps.google.com/)我正在通过*My Places > Create Map > Import*上传一个 .kml 文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T23:02:12.510

您正在寻找的可能是[QWebPage::chooseFile](http://doc.qt.digia.com/qt/qwebpage.html#chooseFile) () （我想这也取决于网站如何处理它）。重新实现它，看看它是否足够。做任何你想做的事情并返回选择的文件路径。

编辑：现在您提供了我测试过的链接并且似乎有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T01:10:09.160

好的，首先让我从背景信息和参考资料开始。

我将使用的模块[在这里](http://sourceforge.net/projects/pywin32/?source=navbar)`pywin32`下载，具体来说，API 参考[在这里](http://docs.activestate.com/activepython/2.4/pywin32/win32gui.html)。`win32gui`

现在，在您可以操作对话框之前，您必须“导航”到窗口句柄，以下使用`win32.FindWindow`API Reference [here](http://msdn.microsoft.com/en-us/library/ms633499.aspx)，看起来像这样，其中两个输入是`lpclassName`在这种情况下`#32770`（代表对话框）引用[here](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633574%28v=vs.85%29.aspx)和`lpWindowName`which在这种情况下`File Upload`，

```
HWND WINAPI FindWindow(
  _In_opt_  LPCTSTR lpClassName,
  _In_opt_  LPCTSTR lpWindowName
); 
```

定位文件句柄的代码：

```
import win32gui

control = win32gui.FindWindow("#32770", "File Upload") 
```

它存储手柄，在我的情况下是`721470`.

下一步是在对话框中定位 GUI 对象的句柄，我将展示一个`Cancel`按钮示例。为了找到句柄，我将`FindWindowEx`在这里使用 API 参考，

```
import win32con
import win32api

ButtonHandle = win32gui.FindWindowEx(control, 0, "Button", "Cancel");
win32api.SendMessage(ButtonHandle, win32con.BM_CLICK, 0, 0) 
```

参考[here](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775985%28v=vs.85%29.aspx) for the`BM_CLICK`和[here](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644950%28v=vs.85%29.aspx) for the `SendMessage`。

最终代码：

```
import win32gui
import win32api
import win32con

window = win32gui.GetForegroundWindow()
title = win32gui.GetWindowText(window)
control = win32gui.FindWindow("#32770", "File Upload")
ButtonHandle = win32gui.FindWindowEx(control, 0, "Button", "Cancel")
win32api.SendMessage(ButtonHandle, win32con.BM_CLICK, 0, 0) 
```

另一种方法是使用`watsup.winGuiAuto`模块，[这里](http://sourceforge.net/projects/watsup/)，示例如下：

```
from watsup.winGuiAuto import *

optDialog = findTopWindow(wantedText="File Upload")

CancelButton = findControl(optDialog,wantedClass="Button", wantedText="Cancel")

clickButton(SaveButton) 
```

但我相信最简单的方法是在`autoit` [这里](http://www.autoitscript.com/site/autoit/)使用，我之前在 pyqt 中使用过它，用于射出命令。

希望这可以帮助！

其他参考资料（pywin32 版本）：

`win32gui` [这里](http://docs.activestate.com/activepython/2.4/pywin32/win32gui.html)

`win32api` [这里](http://docs.activestate.com/activepython/2.4/pywin32/win32api.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T02:57:32.210

这是一个纯粹的 PyQt4 演示，或多或少地再现了默认实现：

```
import sys
from PyQt4 import QtCore, QtGui, QtWebKit

class WebPage(QtWebKit.QWebPage):
    def chooseFile(self, frame=None, path=''):
        return QtGui.QFileDialog.getOpenFileName(self.parent(), '', path)

if __name__ == '__main__':

    app = QtGui.QApplication(sys.argv)
    view = QtWebKit.QWebView()
    view.setPage(WebPage(view))
    view.load(QtCore.QUrl('https://maps.google.com/'))
    view.show()
    sys.exit(app.exec_()) 
```

# .net - 更新 ReactiveCollection 的项目 在将新项目添加到集合之前

> ID：13260420
> 
> 赞同：1
> 
> 时间：2012-11-06T22:25:08.097
> 
> 标签：.net, system.reactive, reactiveui

我正在为我当前的项目评估 ReactiveExtensions 和 ReactiveUI。两者看起来都非常有前途。但是，我刚刚遇到了以下问题。我有一个名为 RecordSet 的类型，它定义了一个名为 Records 的 ReactiveCollection<MyRecordType> 的只读属性。我需要处理要添加到集合中的每个记录项的一些属性，以及在将新项添加到集合之前已经在集合中的其他项。一些操作基于集合中已经存在但不包括要添加的项目的项目总数。我试图观察 _records.BeforeItemsAdded 但由于某种原因 OnNext() 回调调用“为时已晚”（在集合中的项目计数已经等于最终添加到集合中的项目总数之后）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:46:49.337

您没有在 BeforeItemsAdded 中收到要更新的项目吗？为什么不直接更改该对象？

**更新：**`BeforeItemsAdded`不幸的是，我怀疑在这个版本的 RxUI 中没有办法做到这一点，因为`BeforeItemsAdded`总是在 UI 线程上运行。在 RxUI 4.1（即将发布）中，情况并非如此。

同时，您可能需要在致电之前进行项目修复`Add`。

# asp.net-mvc - 开发中的 ObjectContext 错误，但发布时没有

> ID：13260422
> 
> 赞同：0
> 
> 时间：2012-11-06T22:25:34.963
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework, objectcontext

鉴于下面的类，在 Visual Studio 中启动网站在调用时会出现以下错误`home/index`（这实际上是内部异常）。

`A transport-level error has occurred when receiving results from the server. (provider: Shared Memory Provider, error: 0 - The handle is invalid.)`

```
at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
at System.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error)
at System.Data.SqlClient.TdsParserStateObject.ReadSni(DbAsyncResult asyncResult, TdsParserStateObject stateObj)
at System.Data.SqlClient.TdsParserStateObject.ReadNetworkPacket()
at System.Data.SqlClient.TdsParserStateObject.ReadBuffer()
at System.Data.SqlClient.TdsParserStateObject.ReadByte()
at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
at System.Data.SqlClient.SqlDataReader.ConsumeMetaData()
at System.Data.SqlClient.SqlDataReader.get_MetaData()
at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
at System.Data.Common.DbCommand.ExecuteReader(CommandBehavior behavior)
at System.Data.EntityClient.EntityCommandDefinition.ExecuteStoreCommands(EntityCommand entityCommand, CommandBehavior behavior) 
```

但是，如果我在本地发布完全相同的代码并使用 WebMatrix 访问该站点，它就可以正常工作。

如果有区别的话，我也在使用 SQL Server 2008 Express。请告知是否需要更多信息。

控制器

```
public class HomeController : BaseController
{
    public ActionResult Index()
    {
        var candidates = BusinessObj.AllOf<Candidate>().ToList();
        return View(candidates);
    }
} 
```

基本控制器

```
public class BaseController : Controller
{
    protected ITestBusinessObject BusinessObj { get; set; }

    public BaseController()
    {
        BusinessObj = new Business.TestBusinessObj();
    }
} 
```

TestBusinessObj（实体是一个 EF edmx 类）

```
public class TestBusiness : ITestBusinessObject
{
    private Entities DB = new Entities();
    private string ContainerName = "Entities";

    public IEnumerable<T> AllOf<T>() where T : class, new()
    {
        return DB.CreateObjectSet<T>(ContainerName.GetEntitySetName<T>());
    }

    private static string GetEntitySetName<T>(this string containerName) where T : new()
    {
        var name = new T().GetType().Name;
        if (name.EndsWith("y"))
        {
            name = name.Substring(0, name.Length - 1) + "ies";
        }
        else
        {
            name = name + "s";
        }
        return string.Format("{0}.{1}", containerName, name);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T14:08:47.590

这开始是作为一个评论，因为它更多的是一个建议而不是一个解决方案，但根据响应、个人经验，这个看似随机/每隔一个季度左右在本地发生的事件以及互联网搜索的结果，重新启动似乎可以解决这个问题问题多半。

[从服务器接收结果时发生传输级错误](https://stackoverflow.com/questions/2962927/a-transport-level-error-has-occurred-when-receiving-results-from-the-server)

[http://www.garrypassarella.co.uk/2011/05/12/a-transport-level-error-has-occurred-when-receiving-results-from-the-server-provider-shared-memory-provider-错误0-句柄无效/](http://www.garrypassarella.co.uk/2011/05/12/a-transport-level-error-has-occurred-when-receiving-results-from-the-server-provider-shared-memory-provider-error-0-the-handle-is-invalid/)

[http://www.soulsolutions.com.au/Blog/tabid/73/EntryId/666/A-transport-level-error-has-occurred.aspx](http://www.soulsolutions.com.au/Blog/tabid/73/EntryId/666/A-transport-level-error-has-occurred.aspx)

共识集中在内存管道的共享性质上，并被其他一些导致错误的后台进程赶上，直到执行系统重新启动。

# java - JSF 异常处理

> ID：13260424
> 
> 赞同：1
> 
> 时间：2012-11-06T22:25:54.957
> 
> 标签：java, jsf

> **可能重复：**
> [JSF 1.2 异常处理](https://stackoverflow.com/questions/13347692/jsf-1-2-exception-handling)

在我的应用程序中，一旦发生应用程序错误或系统错误，我们就会抛出异常并直接在后台 bean 处捕获。在支持 bean 中，我捕获了异常，并将异常转换为 FacesContext 消息，如下所示

```
/**
* 
*/
public void createFacesExceptionMsg(Exception e){   
    String caughtAt = e.getStackTrace()[0].toString();
        if (null != caughtAt && !caughtAt.isEmpty()) {
            getFacesContext().addMessage(null, new FacesMessage   (FacesMessage.SEVERITY_ERROR, 
                    caughtAt, null));
        } else {
            getFacesContext().addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR, 
                    "Local message not set when Exception thrown - Application in error state", null));
        }           
} 
```

我必须在errorpage.jsp 上呈现异常。

如何在 errorPage.jsp 上打印 facesContext 消息

它的jsf1.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T09:02:39.500

如果我理解正确你想要做的是

1.  捕捉异常
2.  将 facesMessage 放入上下文
3.  重定向到 error.jsp
4.  在 error.jsp 上显示 facesMessage

> 在 JSF 参考实现中，在页面之间传递全局面孔消息不起作用。它的设计不是“开箱即用”的。幸运的是，有一种方法可以做到这一点，它甚至可以支持页面之间的重定向、通过 RequestDispatcher 转发以及通过标准 JSF 导航案例。

如果这是你想在这里做的，你去

## [通过多个页面重定向保持并传递 FacesMessages](http://ocpsoft.org/java/persist-and-pass-facesmessages-over-page-redirects/)

* * *

如果您需要一种通过重定向处理异常的方法，例如

*   sessionExpired.xhtml

*   loginRequired.xhtml

*   pageNotFound.xhtml

从 JSF 的开发人员 (Ed Burns) 那里了解 ExceptionHandlerFactory

## [优雅地处理 ViewExpiredException - JSF 2.0](http://weblogs.java.net/blog/edburns/archive/2009/09/03/dealing-gracefully-viewexpiredexception-jsf2)

* * *

## OP 评论后更新

请按照以下步骤操作，让我知道它是否有效。

1.  使用 ExceptionHandler （如@ [Ed Burn's Blog](http://weblogs.java.net/blog/edburns/archive/2009/09/03/dealing-gracefully-viewexpiredexception-jsf2)所述）
2.  `handle()`在您的方法中注册您的 facesMessage`ExceptionHandler`
3.  放入`<h:messages/>`您的error.jsp 以查看它。
4.  `errorPageBean.action()`要使会话无效或从您的导航到主菜单使用`erroPage.jsp`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T01:12:15.270

就放

```
<h:messages /> 
```

在你的jsp中

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T03:01:44.173

如果您在 Web 应用程序中抛出常规 java 异常，则可以使用隐式页面范围对象访问它`${pageContext.exception}`。您只能在通过页面级别声明指定为错误页面的页面内访问此对象

```
 <%@ pageisErrorPage=”true”%> 
```

或在您的部署描述符中。

如果您使用的是新的 jsp 2.x，您可以访问新的 jsp 2.x，`javax.servlet.jsp.ErrorData`因为`${pageContext.errorData`它通过成员变量为您提供有关异常的一些信息，例如

1.  requestURI ：违规请求的 URI
2.  servletName ：失败的 servlet/JSP 页面的名称。
3.  statusCode：Http状态码
4.  throwable ：实际的异常对象和关联的成员字段。

# c# - 创建不受 ShowDialog() 影响的表单

> ID：13260426
> 
> 赞同：-3
> 
> 时间：2012-11-06T22:26:09.997
> 
> 标签：c#

我目前正在对一个非常大的 C# 应用程序进行安全评估。我编写了一个工具来帮助我进行同样在 C# 中运行的评估。整个应用程序使用 ShowDialog 又名模态表单。我试图想出一种方法，在弹出模式对话框时我仍然可以使用我的工具（例如单击它）。我想，这可能需要另一个线程或其他东西。如果有人有任何简单的技巧可以让我的表单不会被 ShowDialog 阻止，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:35:22.930

使用模态对话框的全部目的是让它阻止它的父级，直到它被解除。

# sql - 播放框架（scala）中使用的 Sql Update 命令似乎不起作用

> ID：13260429
> 
> 赞同：1
> 
> 时间：2012-11-06T22:26:18.433
> 
> 标签：sql, scala, jdbc, playframework

我的 Sql 表设置如下

```
create table contact(
id                      bigint not null,
first_name                varchar(255) not null,
last_name                 varchar(255) not null,
phone                     varchar(255) not null,
email                     varchar(255) not null,
company                   varchar(255) not null,
external_access           varchar(255),
online_status             varchar(12),
constraint pk_computer primary key (id)); 
```

所以最初我将数据值输入到表中，除了 external_access 和 online_status。然后我尝试使用下面的函数更新 online_status。

```
DB.withConnection { implicit connection =>
SQL(
  """
     update contact
     set online_status = online
     where email = {email}
  """
     ).on(
       'email -> email
         ).executeUpdate()
  } 
```

所以在线状态更新后，我尝试使用再次显示页面

```
 select * from contact 
```

（以上代码只是大意，实际展示功能是[https://github.com/playframework/Play20/blob/master/samples/scala/computer-database/app/models/Models.scala](https://github.com/playframework/Play20/blob/master/samples/scala/computer-database/app/models/Models.scala)的页面展示功能列表)

但是，online_status 尚未更新。它继续不显示任何内容（在 online_status 列中）。有人可以帮我调试吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T12:57:31.447

在线状态是一个 varchar，可能您的查询应该是这样的：

```
 """
     update contact
     set online_status = 'online'
     where email = {email}
  """ 
```

注意 '' 将值定义为字符串。

此外，请确保您没有将旧值存储在缓存中。

# css - 浏览器中的字体添加了不需要的粗体

> ID：13260431
> 
> 赞同：3
> 
> 时间：2012-11-06T22:26:22.367
> 
> 标签：css, fonts

我一直在一个项目中使用 HelveticaNeue-CondensedBold 字体。这是iOS中包含的字体。当它在 Chrome、Safari 和 Firefox 中显示时，由于某种原因，我得到了不必要的粗体或双字体效果。

今天我遇到了一种修复它的方法，但不确定它是否是字体渲染中的错误？

我下面的示例显示了没有不透明度的字体，不透明度设置为 .9999999（这使字体看起来正常）和不透明度设置为 8 位数字（这使得它看起来像原来的双粗体。）

```
.noOpacity {
    opacity:1;
}
.opacity7digits {
    opacity: .9999999;
}
.opacity8digits {
    opacity: .99999999;
} 
```

![在此处输入图像描述](../Images/5964e24eb969ade80d3a90b2a2ce8b63.png)

![在此处输入图像描述](../Images/1e7acd729264751f874d0b51389687ff.png)

我很困惑为什么会发生这种情况，任何见解都将不胜感激。

[http://jsfiddle.net/J75gW/4/](http://jsfiddle.net/J75gW/4/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T01:25:34.160

OSX 渲染亚像素抗锯齿文本比其他平台重得多。对于深色背景上的浅色字体尤其如此。由于您在黑色背景上有白色文本，因此您几乎可以看到这种最极端的效果。

这是一个错误吗？我不这么认为，这只是 Apple 对亚像素字体渲染的糟糕实现。这只是一个猜测，但我认为他们还没有完全接受亚像素渲染：

*   他们从未在他们的移动设备上使用过它，即使是在低 DPI 非视网膜 iPhone/iPod/iPad 上 - 这就是为什么您在 iOS 中看不到这种效果的原因。

*   他们也没有（或者没有 - 没有使用 Mountain Lion 进行检查）在非 Apple 外接显示器上的 OSX 中启用亚像素抗锯齿 - 您必须在终端中运行命令才能启用它。据推测，这可能是因为极少数 LCD 显示器没有红-绿-蓝亚像素顺序，这会扰乱亚像素渲染。

*   所有 apple.com 都将*-webkit-font-smoothing*设置为*antialiased*。

# 不透明度与-webkit-font-smoothing：抗锯齿

将不透明度更改为 .9999（或 1 以外的任何值）会使字体变薄的原因是，非透明文本通常使用简单的抗锯齿而不是亚像素抗锯齿渲染。您可以使用*-webkit-font-smoothing: antialiased*（在支持它的浏览器中）获得相同的效果。

想要一些证据吗？查看原始屏幕截图的极端特写。请注意 .9999999 文本周围没有彩色边缘 - 这表明文本没有使用亚像素抗锯齿。

![在此处输入图像描述](../Images/3074890a3a1744b933e5f0a6dd6408b0.png)

无论如何，我认为您应该使用 OSX 浏览器上的超重文本或使用*-webkit-font-smoothing: antialiased*（并接受 Firefox 不会呈现完全相同的内容）。不透明的东西是一种黑客行为，将来很可能会停止工作。

# javascript - 展开隐藏内容的 li 列表

> ID：13260436
> 
> 赞同：1
> 
> 时间：2012-11-06T22:26:44.367
> 
> 标签：javascript, html, css

我目前有与以下链接类似的设置：

[http://jsfiddle.net/d33zC/5/](http://jsfiddle.net/d33zC/5/)

有问题的div：

```
<ul>
<li>
    <a href="#" onclick="toggle2('question', this);">Question</a>
    <div id="question" style="display:none; margin:0px;">
        <input type="text" />
    </div>
</li>
<li>
    <a href="#" onclick="toggle2('question2', this);">Question</a>
    <div id="question2" style="display:none; margin:0px;">
        <input type="text" />
    </div>
</li>
<li>
    <a href="#" onclick="toggle2('question3', this);">Question</a>
    <div id="question3" style="display:none; margin:0px;">
        <input type="text" />
    </div>
</li> 
```

请注意，这些 div 中已经包含扩展的隐藏内容。​</p>

现在，正在产生很多问题，我需要保留一个受限列表，当单击或自动（例如谷歌图像或推特）时，该列表可以与其余 div 一起扩展。

有什么办法可以限制数量，并“扩展”列表以显示列表的其余部分？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:22:55.303

更新了很多变化的[**小提琴，请参阅评论以获取解释。**](http://jsfiddle.net/d33zC/7/)要点是

1.  到处添加类
2.  `<li>`最后添加了“查看更多”
3.  循环遍历每个`<ul>`（给定课程*问题*）然后`<li>`（给定课程*qn*）进行设置
4.  使用的事件监听器

这一切都是在原生 JavaScript 中完成的（不需要 jQuery）。JavaScript的主要部分如下

```
window.addEventListener('load',function load(){
    var n_shown_at_start = 3,
        n_more_displayed_on_click = 3;

    var qs = document.querySelectorAll('.questions'),
        qn, sm, i = qs.length, j;
    while( --i >= 0 ){ // loop over all questions
        sm = qs[i].querySelector('.see_more'); // get see more entry
        qn = qs[i].querySelectorAll('.qn'); // get question <li>s
        j = qn.length;
        while( --j >= 0 ){
            qn[j]
                .querySelector('.qn_vis') // <a>
                .addEventListener('click', function click(){ // make click display question
                qn_toggle(this);
                return false; // no action
            }, true);
            if(sm) // if there is a see more button, hide some questions
                qn[j].style.display = (j < n_shown_at_start ? '' : 'none');
        }
        if(sm){ // if there is a see more button, set it up
            sm.qs = qs[i];
            sm.start = n_shown_at_start;
            sm.lim = n_more_displayed_on_click;
            sm.addEventListener('click', function click(){
                var qn = this.qs.getElementsByClassName('qn'), q,
                    i = this.start, j = i + this.lim;
                this.start = j + 1;
                while(i < j && (q = qn[i++])){ // loop over questions
                    q.style.display = 'block';
                }
                if(!q || !qn[i]){ // if we reached the end
                    this.textContent = 'No More';
                }
            }, false);
        }
    }
}, false); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:41:04.337

这能解决你的问题吗？

将多余的包裹在隐藏的 DIV 中，并在单击 Show All 按钮时显示它

[http://jsfiddle.net/vAZFv/2/](http://jsfiddle.net/vAZFv/2/)

**HTML：**

```
<ul>
    <li>
        <a href="#" onclick="toggle2('question', this);">Question</a>
        <div id="question" style="display:none; margin:0px;">
            <input type="text" />
        </div>
    </li>
    <li>
        <a href="#" onclick="toggle2('question2', this);">Question</a>
        <div id="question2" style="display:none; margin:0px;">
            <input type="text" />
        </div>
    </li>
    <li>
        <a href="#" onclick="toggle2('question3', this);">Question</a>
        <div id="question3" style="display:none; margin:0px;">
            <input type="text" />
        </div>
    </li>
    <div  id="hiddenOnes">
          <li>
        <a href="#" onclick="toggle2('question3', this);">Question11</a>
        <div id="question3" style="display:none; margin:0px;">
            <input type="text" />
        </div>
    </li>
        <li>
        <a href="#" onclick="toggle2('question3', this);">Question11</a>
        <div id="question3" style="display:none; margin:0px;">
            <input type="text" />
        </div>
    </li>
        <li>
        <a href="#" onclick="toggle2('question3', this);">Question11</a>
        <div id="question3" style="display:none; margin:0px;">
            <input type="text" />
        </div>
    </li>

    </div>
</ul>
<input type="button" id="showAllBtn" value="Show all">​ 
```

**JS：**

```
function toggle2(id, link) {
    var e = document.getElementById(id);
    if (e.style.display == '') {
        e.style.display = 'none';
    } else {
        e.style.display = '';
    }
}
$(function() {
    $("#hiddenOnes").hide();
    $("#showAllBtn").click(function() {
        $("#hiddenOnes").show();
    });
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T23:00:02.407

你可以这样做：

[http://jsfiddle.net/vZnJb/3/](http://jsfiddle.net/vZnJb/3/)

首先，通过添加像您已经为您的 div 所做的那样添加来隐藏所有`li`'s 。`style="display:none;"`然后，在按下按钮或单击链接后，您遍历所有`li`'s `document.getElementsByTagName("li");`，删除一定数量的这种样式。

**js代码：**

```
var shown = 1;
var expand_per = 1;

function expand() {
    shown += expand_per;
    var allLists = document.getElementsByTagName("li");
    i = 0;
    while (i < shown) {
        if (allLists[i] === undefined) {
            break;
        }
        if (allLists[i].style.display == 'none') {
            allLists[i].style.display = '';
        }
        i++
    }
}​ 
```

编辑：当然，在现实生活中，您会从数据库中获取所有问题，正如 Sajjan Sarkar 所提到的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T00:35:05.153

这是另一种解决方案，可以满足您的要求。

**JS 小提琴：http:** [//jsfiddle.net/erRCy/](http://jsfiddle.net/erRCy/)

**HTML：**

```
 <ul class="topnav">
    <li>Question</li>

    <li>Question</li>

    <li>Question</li>

    <li>Question11</li>

    <li>Question11</li>

    <li>Question11</li>

    <li>Question11</li>
</ul>
<input type="button" id="showAllBtn" value="Show all"> 
```

CSS：

```
.visible{
 display:block;   
}

.invisible{
 display:none;   
} 
```

JS：

```
<script>
    // Make all LIs under the UL(with class=topnav) invisible
    $("ul.topnav > li").addClass('invisible');

    // when the button is clicked
    $("#showAllBtn").click(function() {
        var gITEMS_PER_SET = 2; // set the no of items you want to show per set
        //get next set of LIs which are invisible and make them visible
        $("ul.topnav > li.invisible").slice(0, gITEMS_PER_SET).removeClass('invisible').addClass('visible');

    });
    // simulate the button click to show the initial set when page loads
    $("#showAllBtn").click();​
<script>
​ 
```

# c# - 如何根据属性值从 XML 文档中获取节点并将其放入 XElement 对象中？

> ID：13260437
> 
> 赞同：1
> 
> 时间：2012-11-06T22:26:43.933
> 
> 标签：c#, xml, linq-to-xml, xelement

我需要在某个节点下将一些 XML 注入到预先存在的 XML 文件中。这是我必须创建我的 XML 的代码：

```
//Define the nodes
XElement dataItemNode = new XElement("DataItem");
XElement setterNodeDisplayName = new XElement("Setter");
XElement setterNodeOU = new XElement("Setter");

//Create the tree with the nodes
dataItemNode.Add(setterNodeDisplayName);
dataItemNode.Add(setterNodeOU);

//Define the attributes
XAttribute nameAttrib = new XAttribute("Name", "OrganizationalUnits");
XAttribute displayNameAttrib = new XAttribute("Property", "DisplayName");
XAttribute ouAttrib = new XAttribute("Property", "OU");

//Attach the attributes to the nodes
setterNodeDisplayName.Add(displayNameAttrib);
setterNodeOU.Add(ouAttrib);

//Set the values for each node
setterNodeDisplayName.SetValue("TESTING DISPLAY NAME");
setterNodeOU.SetValue("OU=funky-butt,OU=super,OU=duper,OU=TMI,DC=rompa-room,DC=pbs,DC=com"); 
```

这是我到目前为止加载 XML 文档并尝试获取我需要在下面插入我的 XML 的节点的代码：

```
//Load up the UDI Wizard XML file
XDocument udiXML = XDocument.Load("UDIWizard_Config.xml");

//Get the node that I need to append to and then append my XML to it
XElement ouNode = THIS IS WHAT I DONT KNOW HOW TO DO
ouNode.Add(dataItemNode); 
```

这是我正在尝试使用的现有文档中的 XML：

```
<Data Name="OrganizationalUnits">
        <DataItem>
          <Setter Property="DisplayName">TESTING DISPLAY NAME</Setter>
          <Setter Property="OU">OU=funky-butt,OU=super,OU=duper,OU=TMI,DC=rompa-room,DC=pbs,DC=com</Setter>
        </DataItem> 
```

我有多个名为“Data”的节点，但我需要获取节点，但我不知道如何。刚刚学习如何在 C# 中使用 XML。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T22:32:33.883

这将获得属性匹配的第一个`Data`节点*OrganizationalUnits*：`Name`

 *```
var ouNode = udiXML
    .Descendants("Data")
    .Where(n => n.Attribute("Name") != null)
    .Where(n => n.Attribute("Name").Value == "OrganizationalUnits")
    .First(); 
```

如果您的文档可能包含`Data`没有属性的节点`Name`，则可能需要额外检查 null。

请注意，您可以使用 XPath 获得相同的结果（这将选择`Data`根节点，您可以`DataItem`使用[`Element`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xcontainer.element.aspx)方法获取节点）：

```
var ouNode = udiXML.XPathSelectElement("//Data[@Name = 'OrganizationalUnits']"); 
```*

# sql - 按附近时间戳的 SQL 查询组

> ID：13260441
> 
> 赞同：5
> 
> 时间：2012-11-06T22:26:57.770
> 
> 标签：sql, sql-server, group-by

我有一个带有时间戳列的表。我希望能够按标识符列（例如 cusip）进行分组，对另一列（例如数量）求和，但仅适用于彼此之间 30 秒内的行，即**不是**固定的 30 秒桶间隔。给定数据：

```
       尖头| 数量| 时间戳
============|=========|=============
BE0000310194| 100| 16:20:49.000
BE0000314238| 50| 16:38:38.110
BE0000314238| 50| 16:46:21.323
BE0000314238| 50| 16:46:35.323

```

我想写一个返回的查询：

```
       尖头| 数量
============|=========
BE0000310194| 100
BE0000314238| 50
BE0000314238| 100

```

编辑：此外，如果我还可以从查询中获取 MIN(timestamp)，这将大大简化事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T05:43:24.543

以下内容可能对您有所帮助。

以 30 秒为单位的时间段表示给定时间。这里是“2012-01-01 00:00:00”。DATEDIFF 计算时间戳值和声明时间之间的秒数。然后将其除以 30 得到分组列。

```
SELECT MIN(TimeColumn) AS TimeGroup, SUM(Quantity) AS TotalQuantity FROM YourTable
GROUP BY (DATEDIFF(ss, TimeColumn, '2012-01-01') / 30) 
```

这里每个组的最小时间戳将作为 TimeGroup 输出。但是您可以使用最大值甚至分组列值，可以再次转换为时间进行显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-17T19:49:30.840

看看上面的评论，我假设 Chris 的第一个场景是你想要的（所有 3 个都被分组，即使值 1 和 3 不在彼此的 30 秒内，而是在值 2 的 30 秒内）。还要假设表中的每一行都有一些唯一的 ID，称为“id”。您可以执行以下操作：

1.  创建一个新分组，确定分区中的前一行是否比当前行晚 30 秒以上（例如，确定是否需要新的 30 秒分组，或者继续前一个分组）。我们将其称为 parent_id。
2.  在 parent_id 上求和数量（加上任何其他聚合）

代码可能看起来像这样

```
select
    sub.parent_id,
    sub.cusip,
    min(sub.timestamp) min_timestamp,
    sum(sub.quantity) quantity
from 
    (
        select
            base_sub.*,
            case
                when base_sub.self_parent_id is not null
                then base_sub.self_parent_id
                else lag(base_sub.self_parent_id) ignore nulls over (
                    partition by
                        my_table.cusip
                    order by
                        my_table.timestamp,
                        my_table.id
                    ) parent_id
        from 
            (
                select
                    my_table.id,
                    my_table.cusip,
                    my_table.timestamp,
                    my_table.quantity,
                    lag(my_table.timestamp) over (
                        partition by
                            my_table.cusip
                        order by
                            my_table.timestamp,
                            my_table.id
                        ) previous_timestamp,
                    case
                        when datediff(
                            second, 
                            nvl(previous_timestamp, to_date('1900/01/01', 'yyyy/mm/dd')),
                            my_table.timestamp) > 30
                        then my_table.id
                        else null
                    end self_parent_id
                from
                    my_table
            ) base_sub
    ) sub
group by
    sub.time_group_parent_id,
    sub.cusip 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-06T20:00:15.277

从 Sean G 解决方案中，我删除了完整表格上的 Group By。事实上，为 Oracle SQL 重新调整了几个部分。

首先在找到上一次之后，分配自己的父母ID。如果在 Previous Time 中有 null，那么我们排除给它一个 ID。

现在基于通过避免空值来获取最近的自身父 ID，以便所有最近的 30 秒 cusip 都属于一个组。

由于有一个 CUSIP 列，我假设数据集将是大型市场交易数据。而不是在完整表上使用 group by，而是使用 CUSIP 分区和最终 Group Parent ID 以获得更好的性能。

```
SELECT
id,
sub.parent_id,
sub.cusip,
timestamp,
quantity,
sum(sub.quantity) OVER(
    PARTITION BY cusip, parent_id
) sum_quantity,
MIN(sub.timestamp) OVER(
    PARTITION BY cusip, parent_id
) min_timestamp
FROM
(
    SELECT
        base_sub.*,
        CASE
            WHEN base_sub.self_parent_id IS NOT NULL THEN
                base_sub.self_parent_id
            ELSE
                LAG(base_sub.self_parent_id) IGNORE NULLS OVER(
                    PARTITION BY cusip
                    ORDER BY
                        timestamp, id
                )
        END parent_id
    FROM
        (
            SELECT
                c.*,
                CASE
                    WHEN nvl(abs(EXTRACT(SECOND FROM to_timestamp(previous_timestamp, 'yyyy/mm/dd hh24:mi:ss') - to_timestamp
                    (timestamp, 'yyyy/mm/dd hh24:mi:ss'))), 31) > 30 THEN
                        id
                    ELSE
                        NULL
                END self_parent_id
            FROM
                (
                    SELECT
                        my_table.id,
                        my_table.cusip,
                        my_table.timestamp,
                        my_table.quantity,
                        LAG(my_table.timestamp) OVER(
                            PARTITION BY my_table.cusip
                            ORDER BY
                                my_table.timestamp, my_table.id
                        ) previous_timestamp
                    FROM
                        my_table
                ) c
        ) base_sub
) sub 
```

下面是表格行

输入数据：

![输入数据](../Images/ccc55798543b9e9126c9028fcfa2d668.png)

下面是输出

结果

![结果](../Images/66e93d403fe41252a630d4873c97c0c0.png)

# django - 在 django 中使用自动分页和格式化问题

> ID：13260443
> 
> 赞同：5
> 
> 时间：2012-11-06T22:26:58.650
> 
> 标签：django, django-pagination

我正在使用 django-paginate 并使用 {% paginate %} 标签遇到奇怪的格式问题。我附上了问题的图片。

我只是想知道可能导致这种情况的原因是什么？

在下图中，我在第一页。请注意，1 被截断，并且页面的顺序很奇怪，并且上一个/下一个不是真正可见的。

![在此处输入图像描述](../Images/17ef0b6d1017bd9681660ace94ba0897.png)

我的模板现在是这样的：

```
{% extends "base.html" %}
{% load mptt_tags %}
{% load pagination_tags %}
{% load i18n %}
{% block body %}
{% autopaginate parts 20 %}
{% paginate %} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T22:21:26.490

这与 Django 无关，也与 Django-Paginate 无关。您似乎正在使用 Bootstrap 作为您的前端框架，这意味着这样的问题。

我已经为这个站点 manoomit.com 实现了类似的方法，创建了一个自定义模板来管理 django-paginate 中的分页。

它看起来像这样：

```
{% if is_paginated %}
{% load i18n %}
<div class="pagination pagination-centered">
    <ul>
    {% if page_obj.has_previous %}
    <li><a href="?page={{ page_obj.previous_page_number }}{{ getvars }}{{ hashtag }}" class="prev">&lsaquo;&lsaquo; {% trans "previous" %}</a></li>
    {% else %}
    <li class="disabled"><a href="#">&lsaquo;&lsaquo; {% trans "previous" %}</a></li>
    {% endif %}
    {% for page in pages %}
        {% if page %}
            {% ifequal page page_obj.number %}
            <li class="active"><a href="#">{{ page }}</a></li>
            {% else %}
            <li><a href="?page={{ page }}{{ getvars }}{{ hashtag }}" class="page">{{ page }}</a></li>
            {% endifequal %}
        {% else %}
            ...
        {% endif %}
    {% endfor %}
    {% if page_obj.has_next %}
        <li><a href="?page={{ page_obj.next_page_number }}{{ getvars }}{{ hashtag }}" class="next">{% trans "next" %} &rsaquo;&rsaquo;</a></li>
    {% else %}
        <li class="disabled"><a href="#">{% trans "next" %} &rsaquo;&rsaquo;</a></li>
    {% endif %}
</ul>
</div>
{% endif %} 
```

# rotation - 支持多种界面方向，但在纵向模式下保持锁定

> ID：13260447
> 
> 赞同：0
> 
> 时间：2012-11-06T22:27:38.680
> 
> 标签：rotation, viewcontroller, autorotate, locked

我需要一种方法来完成上述操作。我试过把

```
-(BOOL) shouldAutorotate {
    return NO;
} 
```

进入我的每个视图控制器，但是当我将设备倾斜到一侧时它仍然会自动旋转。

为什么我需要这个？我们的一个合作伙伴有一个 SDK，它要求我们支持其他方向（否则他们的应用程序崩溃）。

那么我能做些什么来锁定我们的肖像模式并保持这种状态呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:35:32.343

不可能。在 iOS 中“支持”设备方向意味着当屏幕旋转到其他方向之一（不是纵向）时，您的应用程序会重新调整大小并针对该方向进行布局。如果您想在纵向模式下保持锁定，请不要支持纵向以外的任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T22:34:51.113

我使用了一个类别来扩展和覆盖 UITabBarController，强制关闭自动旋转。

看看这个 SO： [UITabBarController Rotation Issues in ios 6](https://stackoverflow.com/questions/12522903/uitabbarcontroller-rotation-issues-in-ios-6)

# postgresql - 排除软删除行的唯一约束

> ID：13260456
> 
> 赞同：13
> 
> 时间：2012-11-06T22:28:21.753
> 
> 标签：postgresql, database-design, constraints

我们有一张表，上面有一个唯一的约束，用于一个用户留下的反馈，另一个，与销售有关。

```
ALTER TABLE feedback
ADD CONSTRAINT unique_user_subject_and_sale
UNIQUE (user_id, subject_id, sale_id) 
```

这可以确保我们不会意外获得重复的反馈行。

目前，我们有时会硬删除错误留下的反馈并让用户再次离开。我们要改为软删除：

```
ALTER TABLE feedback
ADD COLUMN deleted_at timestamptz 
```

如果`deleted_at IS NOT NULL`是，请考虑删除反馈，尽管我们的数据库中仍然有审计跟踪（并且可能会向站点管理员显示它的影子）。

当我们像这样使用软删除时，我们如何保持我们的唯一约束？是否可以不使用更一般`CHECK()`的约束来进行聚合检查（我从未尝试过使用这样的检查约束）。

这就像我需要在约束中附加一个 WHERE 子句。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-06T23:04:18.423

你的唯一索引，后来被编辑掉了。

```
CREATE UNIQUE INDEX feedback_unique_user_subject_and_sale_null
ON feedback(user_id, subject_id, sale_id)
WHERE deleted_at IS NULL 
```

您的唯一索引至少有两个可能会给您带来麻烦的副作用。

1.  在其他表中，您不能设置引用“反馈”的外键约束。外键引用需要将某些列组合声明为`primary key`or 或`unique`。
2.  您的唯一索引允许*仅*在“deleted_at”时间戳不同的多行。因此，最终*可能*会得到如下例所示的行。这是否是一个问题取决于应用程序。

例子

```
user_id  subject_id  sale_id  deleted_at
--
1        1           1        2012-01-01 08:00:01.33
1        1           1        2012-01-01 08:00:01.34
1        1           1        2012-01-01 08:00:01.35 
```

PostgreSQL 将这种索引记录为*部分索引*，如果您需要在某个时候谷歌它。其他平台对它使用不同的术语——*过滤索引*就是其中之一。您可以使用一对部分索引将问题限制在一定程度上。

```
CREATE UNIQUE INDEX feedback_unique_user_subject_and_sale_null
ON feedback(user_id, subject_id, sale_id)
WHERE deleted_at IS NULL

CREATE UNIQUE INDEX feedback_unique_user_subject_and_sale_not_null
ON feedback(user_id, subject_id, sale_id)
WHERE deleted_at IS NOT NULL 
```

**但**我认为没有理由去这么麻烦，特别是考虑到外键的潜在问题。如果你的桌子看起来像这样

```
create table feedback (
  feedback_id integer primary key,
  user_id ...
  subject_id ...
  sale_id ...
  deleted_at ...
  constraint unique_user_subj_sale 
    unique (user_id, subject_id, sale_id)
); 
```

那么您所需要的就是对 {user_id, subject_id, sale_id} 的唯一约束。您可能会进一步考虑让所有删除都使用“deleted_at”列，而不是进行硬删除。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-06T23:03:29.610

尽管 PostgreSQL 文档建议不要使用唯一索引而不是约束（如果要点是有约束），但您似乎可以这样做

```
CREATE UNIQUE INDEX feedback_unique_user_subject_and_sale
ON feedback(user_id, subject_id, sale_id)
WHERE deleted_at IS NULL 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-16T15:11:30.107

您可以使用 deleted_at 签名创建约束。

```
ALTER TABLE feedback
ADD CONSTRAINT unique_user_subject_and_sale
UNIQUE (user_id, subject_id, sale_id, deleted_at) 
```

这不会产生像唯一索引这样的问题。

唯一的问题是删除用户反馈，创建一个新的，然后在同一时间再次删除它。

考虑到色谱柱的准确性，用户必须在 1 微秒内适应。这是不可能的，即使他做到了，这些请求之间的时间肯定会大于1微秒。

**唯一的问题是空值不是唯一的。所以它不会起作用。**

但是您可以为未删除的行添加一个默认值作为您可以存储在该列中的最低值。

如果您不能接受 的默认值`deleted_at`，如果对象没有被删除，您可以考虑添加一`deleted_token`列并在删除值时为其生成键，对于未删除的对象，保留`0`或其他方式。

# oracle11g - 动态旋转

> ID：13260457
> 
> 赞同：2
> 
> 时间：2012-11-06T22:28:22.113
> 
> 标签：oracle11g, plsqldeveloper, oracle-sqldeveloper

我希望在需要调整的视图上获得一些帮助，但我不确定。视图格式如下：

```
CASE       CASE_ORDER     MANAGER    MONTHLY_CASES      FISCAL_CASES                                                                
case_1          1           John            15             84          
case_1          1           Jeff            10             80  
case_2          2           John            20             90  
case_2          2           Jeff            13             65  
case_3          3           John            7              72  
case_3          3           Jeff            17             70 
```

我的最终图表应如下所示：

```
CASE  CASE_ORDER   JOHN_CURR_MONTH  JOHN_FY        JOHN_CURR_MONTH  JOHN_FY               
case_1     1            15                84            10            80  
case_2     2            20                90            13            65  
case_3     3             7                72            17            70 
```

我的问题是经理可以改变，经理的数量每个月都会改变，所以我不能硬编码他们的名字（即'mgr1'和'mgr2'）并使用DECODE。它必须是动态的...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T16:23:06.510

谢谢你的建议，我明白了。事实上，我在 tom kyte 的博客 (http://www.oracle.com/technetwork/issue-archive/2012/12-jul/o42asktom-1653097.html) 中有一个类似的答案，我针对我的目的进行了修改。这里是：

```
CREATE OR REPLACE PROCEDURE dynamic_pivot_proc ( p_cursor IN OUT SYS_REFCURSOR )  
AS  
l_query LONG := 'SELECT case_order, case';   
BEGIN  
FOR x IN (SELECT DISTINCT manager FROM test_table ORDER BY 1 )  
LOOP  
    l_query := l_query ||  
    REPLACE( q'|, MAX(DECODE(manager,'$X$',monthly_total)) $X$_current_month|',   
            '$X$', dbms_assert.simple_sql_name(x.manager) ) ||  
    REPLACE( q'|, MAX(DECODE(manager,'$X$',fiscal_total)) $X$_fy|',   
           '$X$', dbms_assert.simple_sql_name(x.manager) );  
END LOOP;  
l_query := l_query || ' FROM test_table 
                        GROUP BY case_order, case
                        ORDER BY case_order ';
OPEN p_cursor FOR l_query;
END;

SQL> variable x refcursor;  
SQL> exec dynamic_pivot_proc( :x );  
SQL> print x 
```

## 案例 CASE_ORDER JEFF_CURRENT_MONTH JEFF_FY JOHN_CURRENT_MONTH JOHN_FY

1 个案例_1 10 80 15 84
2 个案例_2 13 65 20 90
3 个案例_3 17 70 7 72

现在的事情不是打印结果，而是我想将它存储在视图中。我该如何做到这一点？我试图修改行
l_query LONG := 'SELECT case_order, case';
使用
l_query LONG := 'CREATE OR REPLACE VIEW SELECT case_order, case';
不用说它不起作用，因为 CREATE OR REPLACE 是一个 DDL 语句，所以我必须如何使用 EXECUTE IMMEDIATE。

有什么建议吗？提前致谢。

# android - 我可以控制 Android 任务切换器中显示的屏幕截图吗？

> ID：13260462
> 
> 赞同：4
> 
> 时间：2012-11-06T22:28:59.677
> 
> 标签：android, privacy

我的添加显示私人数据，所以我不希望它可以在任务切换器中看到应用程序内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T22:36:41.867

您无法控制它显示的内容，但您*可以*将其完全排除在“最近使用的应用程序”中。在您的清单中，将以下属性添加到`activity`不应显示在“最近的应用程序”中的活动的任何标记中：

`android:excludeFromRecents="true"`

也可以看看：[`<activity>`](http://developer.android.com/guide/topics/manifest/activity-element.html)

# javascript - 在 jQuery UI 小部件中更改深度选项

> ID：13260463
> 
> 赞同：1
> 
> 时间：2012-11-06T22:29:00.783
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-widget, jquery-ui-widget-factory

在创建 jQuery 小部件后更改深度嵌套选项的最佳方法是什么？

```
$.widget("test.widget1", {
    options: {
        deepOption: {
            prop1: false,
            prop2: false
        }
    },
    _create: function() {

    },
    _init: function () {
        this.element.append('<br>' + this.options.deepOption.prop1 + " " + this.options.deepOption.prop2);
    }
})
$("#one").widget1();

$("#one").widget1({
    deepOption: {
        prop1: true
    }
});​ 
```

上面的代码将`prop1`选项更改为 true 和 nukes `prop2`。如何`prop1`在保留`prop2`.

[这是一个 jsFiddle 。](http://jsfiddle.net/hWKxH/)

**编辑：** 我想出了一个解决方案，但它似乎有点像黑客。这是做我想做的最好的方法吗？

```
$.widget("test.widget1", {
    options: {
        deepOption: {
            prop1: false,
            prop2: false
        }
    },
    _create: function() {

    },
    _init: function () {
        this.element.append('<br>' + this.options.deepOption.prop1 + " " + this.options.deepOption.prop2);
    },
    _setOption: function (key, value) {
        switch(key) {
            case 'deepOption':
                value = $.extend({}, this.options.deepOption, value);                
                break;            
        }

        $.Widget.prototype._setOption.apply(this, arguments);
    }
})
$("#one").widget1();

$("#one").widget1({
    deepOption: {
        prop1: true
    }
});​ 
```

[这是更新的 jsFiddle。](http://jsfiddle.net/MB3Mj/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-17T23:27:36.917

已`.option()`在 jQuery UI 1.9 中扩展以支持设置部分嵌套选项，如[更改日志](http://jqueryui.com/changelog/1.9.0/#widget-factory)中所述。

要在创建小部件后更改此类选项，您现在可以使用：

```
$("#one").widget1('option', 'deepOption.prop1', true); 
```

`[jsFiddle](http://jsfiddle.net/hWKxH/2/)`

# performance - 如果我使用集群 Web 主机，是否可以实施内容交付网络 (CDN)？

> ID：13260464
> 
> 赞同：0
> 
> 时间：2012-11-06T22:29:09.647
> 
> 标签：performance, cdn

我在使用虚拟主机、网络农场或集群，我想你可以这么说。我有一个 47 页的公司网站，所有速度测试都建议我使用 CDN。

我用谷歌搜索，SE 没有尽头，但仍然不明白如何实现内容交付网络。他们是否建议我订购一个子域并将我所有的 .css、.js 和图像文件放在该子域中？还是他们建议我不下载 jquery 1.7，而只是链接到 malsup 的 jquery？但是我会为图像和 .css 做些什么呢？

在这里有点困惑；在这方面的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T22:40:58.383

是的 - 您可以使用集群 Web 主机实现 CDN。在绝大多数情况下，如果您可以更改 DNS 设置，您就可以实施 CDN。另一个建议是使用无 cookie 域。但是，内容交付网络将优化您提到的所有文件的交付。虽然我不确定您的具体设置和情况的所有细节，但听起来您可以使用前端优化和整体更快的站点交付。请看以下重点介绍 EdgeCast 将 Google 的 PageSpeed 集成到我们的内容交付网络中的情况，以及它们将如何协同帮助像您这样的网站：[http://www.edgecast.com/docs/ec-edgeopt-datasheet。 pdf](http://www.edgecast.com/docs/ec-edgeopt-datasheet.pdf)

# java - 如何使用 Apache POI 获取 Excel 单元格字体颜色 RGB？

> ID：13260470
> 
> 赞同：0
> 
> 时间：2012-11-06T22:29:30.110
> 
> 标签：java, apache, apache-poi

`getStyle().getFont(workbook).getColor()`返回一个短的。如何获得颜色的 RGB 值？

顺便提一句，

```
palette.getColor(style.getFont(this.book).getColor()).getTriplet() 
```

并不总是有效（有时会发生空指针异常）。也许我做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:44:33.600

我想我可能已经想通了。当单元格使用默认颜色（通常为黑色）时，调色板中不存在默认颜色。

这是一个工作示例：

```
final HSSFColor foreColor = palette.getColor(style.getFont(this.book).getColor());
if (foreColor != null) {
    final short[] foreRGB = foreColor.getTriplet();
    if (foreRGB[0] != 0 || foreRGB[1] != 0 || foreRGB[2] != 0) {
        out.append("color: rgb(").append(foreRGB[0]).append(',').append(foreRGB[1]).append(',').append(foreRGB[2]).append(");");
    }
} 
```

# jquery - 使用 Jquery 验证动态表单不显眼地验证图像上传？

> ID：13260471
> 
> 赞同：0
> 
> 时间：2012-11-06T22:29:32.843
> 
> 标签：jquery, jquery-validate, unobtrusive-validation

我有一个在动态表单上创建的图像上传。我正在尝试这样做，以便我可以验证上传的文件是实际图像，并且不显眼地执行此操作。我已经阅读了有关 .rules() 设置和使用接受属性的信息，但这需要您输入字段名称 (http://docs.jquery.com/Plugins/Validation/Methods/accept)。由于表单是动态的，我不知道字段名称。我生成上传输入的视图如下所示：

```
 <input type="file" size="20" name="@(Model.FormItem.Id + "-image")" id="@(Model.FormItem.Id + "-image")" /> 
```

所以我所有的文件输入都有一个“-image”后缀。有没有办法使用 jquery 选择器为验证器规则添加规则，而不是使用特定的字段名称？

**编辑**好吧，很明显我没有解释问题出在哪里。也许解决方案是如此简单，不知何故我错过了它。我知道如何使用 jQuery 选择器，但是从我看到的`rules`语法示例中，您必须为规则提供静态字段名称。如何将验证规则分配给选择器而不是静态字段名称？

所以现在这就是我所拥有的：

```
 var validatorData = $('#items-form').data('validator');

        $.extend(validatorData.settings, {
            rules: {
                static_field_name: { accept: "jpg|png" }
            },
            messages: {
                static_field_name_message: "The file must be an image."
            }
        }); 
```

`static_field_name`如果我用正确的选择器替换，这将不起作用，（显然）也不起作用`$('input[name$="-image"]')`。那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T17:42:20.867

我发现了如何使用`.addClassRules()`这样的方法：

```
$.validator.addClassRules("image-upload", {
       accept: "jpg|png|gif"
}); 
```

然后只需将类`image-upload`应用于输入。但是，为了让它不引人注目地工作，我不得不重构规则以获得自定义消息（http://docs.jquery.com/Plugins/Validation/Reference#Refactoring_rules）：

```
$.validator.addMethod("acceptImageTypes", $.validator.methods.accept,
  "Selected File must be an image.");

        $.validator.addClassRules("image-upload", {
            acceptImageTypes: "jpg|png|gif"
        }); 
```

然后将我的标记更改为：

```
<label>Image</label>
<input type="file" size="20" data-val="true" class="image-upload" name="@(Model.FormItem.Id + "-image")" id="@(Model.FormItem.Id + "-image")" />
<span class="field-validation-valid" data-valmsg-for="@(Model.FormItem.Id + "-image")" data-valmsg-replace="true">File must be an image.</span> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:01:42.043

我看到了两种可能的方法来解决这个问题：

1) 使用 jQuery 的 .children() 或 $("#parent input:first") 或 $("input[type=file]:last") 选择器，这样您的输入就不需要静态名称。

2）如果您在给定的动态名称中有任何类型的模式，请为您的 jQuery 选择器使用正则表达式：
a）jquery 方式：[http](http://api.jquery.com/attribute-ends-with-selector/)
://api.jquery.com/attribute-ends-with-selector/ b）或完整正则表达式方式：http: [//james.padolsey.com/javascript/regex-selector-for-jquery/](http://james.padolsey.com/javascript/regex-selector-for-jquery/)

那应该是困难的部分。然后你可以像往常一样添加你的规则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-25T21:50:48.587

当然，您的答案有效，我将其添加为对同一只猫进行剥皮的略有不同的方法。

在cshtml页面的c#代码部分：

```
//only allow these file types for upload
var allowedUploadExtensions = ".CSV|.DOC|.DOCX|.JPG|.JPEG|.PDF|.XLS|.XLSX|.TIF|.TIFF";    
var acceptMessage = allowedUploadExtensions.Replace("|", ","); 
```

在您的 $(document)ready 函数中：

```
 $.validator.addMethod('isValidFileExtension', function (value, element) {
            if (value == '')
                return true;  //data-val-required will catch lack of value.
            var extension = value.substr((value.lastIndexOf('.'))).toUpperCase();
            var validFileExtensions = new String('@allowedUploadExtensions').toUpperCase().split('|');
            return $.inArray(extension, validFileExtensions) > -1;
        });

        $('.file-upload').rules('add', { isValidFileExtension: true, messages: { isValidFileExtension: 'Invalid file extension, valid extensions are @acceptMessage'} }); 
```

然后在您的标记中：

```
<input type="file" name="UploadedFile" id="UploadedFile" 
                    class="file-upload"
                    data-val="true" 
                    data-val-required="Please select a document to upload."/> 
```

# gwt - 带有箭头图标和小部件标题的 GWT DisclosurePanel？

> ID：13260475
> 
> 赞同：1
> 
> 时间：2012-11-06T22:30:10.063
> 
> 标签：gwt, flextable

我需要有一个带有 FlexTable 小部件作为标题的 DisclosurePanel，并包含带有动画的箭头图标。

将小部件添加到 DisclosurePanel 时，箭头图标被小部件禁用/替换。

我决定我需要创建一个扩展 FlexTable 的新类，并具有一个带有箭头图标的单元格和适当的单击处理程序来为图标设置动画，或者为 DisclosurePanel 创建一个包装类（因为它是最终类）。这些中的任何一个似乎都是可行的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T02:05:21.243

我会创建一个更通用的 Composite 小部件，称为`HeaderWidgetWithArrow`包含

1.  向下箭头图像
2.  任意小部件（例如 FlexTable）

如果你想包含一个显示面板的箭头，比如一个 Horizo​​ntalPanel，你可以重新使用`HeaderWidgetWithArrow`它。

无论哪种方式，我都不建议扩展 FlexTable 或 DisclosurePanel。您应该更喜欢组合而不是继承。

# java - 如何使用自动化脚本将输入传递给网页

> ID：13260476
> 
> 赞同：3
> 
> 时间：2012-11-06T22:30:16.550
> 
> 标签：java, php

如何使用自动脚本将输入传递给 php 网页，即我只想知道如何使用脚本将参数传递给文本字段。就像将输入传递给网页的用户名和密码字段，然后按下提交按钮（也可以使用脚本）。

喜欢的语言：JAVA

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T22:31:57.227

试试硒。Selenium 擅长自动化 Web 浏览器。

[http://seleniumhq.org/](http://seleniumhq.org/)

还对 Java 有纯粹的支持。但不仅如此。

当涉及到自定义方法时，请参阅...

```
String urlParameters = "param1=a&param2=b&param3=c";
String request = "http://example.com/index.php";
URL url = new URL(request); 
HttpURLConnection connection = (HttpURLConnection) url.openConnection();           
connection.setDoOutput(true);
connection.setDoInput(true);
connection.setInstanceFollowRedirects(false); 
connection.setRequestMethod("POST"); 
connection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded"); 
connection.setRequestProperty("charset", "utf-8");
connection.setRequestProperty("Content-Length", "" + Integer.toString(urlParameters.getBytes().length));
connection.setUseCaches (false);

DataOutputStream wr = new DataOutputStream(connection.getOutputStream ());
wr.writeBytes(urlParameters);
wr.flush();
wr.close();
connection.disconnect(); 
```

来源（[Java - 通过 POST 方法轻松发送 HTTP 参数](https://stackoverflow.com/questions/4205980/java-sending-http-parameters-via-post-method-easily)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:36:07.253

如果您的网页使用 GET 方法来接受数据（即来自 URL），只需连接到提供您要传递的数据的网页：

[http://www.mysite.com/mypage.html?data0=data0,data1=data1](http://www.mysite.com/mypage.html?data0=data0,data1=data1)

如果网页使用 POST，事情会变得有点复杂：您必须伪造一个适当的 HTML 请求，其中包含标题中的所有数据（因为 POST 方法需要）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T22:32:01.423

您可以使用 Apache HTTPClient - 请参阅以下示例：

[http://hc.apache.org/httpclient-3.x/methods/post.html](http://hc.apache.org/httpclient-3.x/methods/post.html)

这使您可以模拟将完整填写的表单直接提交到目标页面并获取结果。

请记住，在调用之后，您必须在响应中抓取并存储会话 cookie，然后将其重新提交到您想要“访问”的以下页面以保持“登录”状态

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-09T22:02:20.173

我想展示如何将输入传递给 HTML。我通常使用 python 向需要输入数据的页面发送请求。在此之前，您需要知道是否需要提供 web-cookie，如果是，请复制 cookie，如果您需要登录，否则不需要，只需检查即可。完成后，您需要知道输入区域的字段名称，因为您将使用它们使用脚本来 POST 或 GET 数据。这是示例用法。

```
import urllib
import urllib2
import string
headers = {'Cookie': 'You cookies if you need'}
values = {'form_name':'sample text', 'submit':''}
data = urllib.urlencode(values)
req = urllib2.Request('website where you making request to',data,headers)

opener1 = urllib2.build_opener()

page1=opener1.open(req)
#OPTIONAL
htmlfile=page1.read()

fout = open('MYHTMLFILE.html', "wb")
fout.write(htmlfile)
fout.close() 
```

# nginx - 将总请求时间（以秒为单位）写入 nginx 访问日志，可能使用计算变量

> ID：13260477
> 
> 赞同：7
> 
> 时间：2012-11-06T22:30:28.907
> 
> 标签：nginx

我正在尝试修改我的 nginx 访问日志格式以包括请求持续时间，以秒为单位。

我看到了两个可以使用的变量：

1)[`$request_time`](http://wiki.nginx.org/HttpLogModule#log_format)

2)[`$upstream_response_time`](http://wiki.nginx.org/NginxHttpUpstreamModule#.24upstream_response_time)

但是，这两个变量都以微秒为单位表示，我需要以秒为单位呈现此值。有没有办法将输出指定为表达式（即`$request_time * 1000`）或以其他方式完成？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-07T07:25:28.850

网络服务器不是计算器或统计程序。它的日志功能是提供您可以用来进行分析的原始数据。如果您的分析程序无法将微秒转换为秒，您应该购买其他软件。无论如何，期望程序的日志记录功能为您执行单位转换是不现实的。日志记录的目标不是格式化，而是在不影响其核心功能性能的情况下记录它所做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-10T09:02:49.040

如果您使用 LogStash（ELK 堆栈）之类的报告器，则可以在解析日志时进行一些计算。这是我在 Nginx 的 Logstash 过滤器中将秒转换为毫秒的示例：

```
grok {
      match => {
        "message" => "%{IPORHOST:clientip} %{USER:ident} %{USER:auth} \[%{HTTPDATE:timestamp}\] \"%{WORD:verb} %{URIPATHPARAM:logMessage} HTTP/%{NUMBER:httpversion}\" %{NUMBER:response} (?:%{NUMBER:bytes}|-) (?:\"(?:%{URI:referrer}|-)\"|%{QS:referrer}) %{QS:agent} rt=%{NUMBER:duration_sec} cid=%{GREEDYDATA:correlationId}"
      }
}
mutate { convert => [ "duration_sec", "float" ] }
ruby { code => "event['duration_ms'] = event['duration_sec'].to_f * 1000" } 
```

希望这可以帮助。

# javascript - 在 Phonegap(Android) 应用程序上使用闭包库

> ID：13260480
> 
> 赞同：7
> 
> 时间：2012-11-06T22:30:56.477
> 
> 标签：javascript, android, cordova, internationalization, google-closure-library

嗨，有人在 Android 上构建 Phonegap 应用程序时使用过谷歌的 Closure 库[https://developers.google.com/closure/](https://developers.google.com/closure/)。我读过 Closure 对应用程序的国际化有很好的支持。因此，如果有人可以提供他们提到的材料或示例片段，以了解如何实施它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T19:17:34.383

使用PhoneGap 的方式没有区别。在本机应用程序背景中构建 Web 视图不会改变。

与任何其他库不同，Closure 库会将您的 javascript 编译为具有语义特征的原始代码。否则是的，请随意使用，包括PhoneGap。

当你使用 Closure 构建一些东西时，你可以在 JavaScript 中渲染 DOM。它超级快，比传统方式好得多。

所以你用`goog.dom.createDom`. 您将在下面找到一个示例。

```
var menuButton = goog.dom.createDom('a', {
    'class': 'menu-button',
    'otherAttributes': 'otherValues etc'
}, myproject.translations.menuButton.currentLanguage);

//Now you have a file like this:
goog.provide('myproject.translations');

// Language variations corresponding to that element.
myproject.translations.menuButton = {
    'EN': 'go',
    'FR': 'aller',
    'DE': 'gehen'//etc...

}; 
```

在需要翻译的地方执行上述操作。然后只需使用非常简单的方法设置当前语言加载即可。

```
myproject.boot = function(parameters) {
    myproject.translations.currentLanguage = parameters['currentLanguage'];
};
goog.exportSymbol('myproject.boot', myproject.boot); 
```

然后在 index.php 或 window.load 上的任何内容中调用 boot 方法，并使用来自服务器的引导参数回显 JSON 字符串。请注意，来自服务器的所有内容在引用时都必须包含在引号中。否则编译器将在 ADVANCED_OPTIMIZATIONS 模式下展平属性名称。

# vb.net - 自定义属性数据注解

> ID：13260482
> 
> 赞同：1
> 
> 时间：2012-11-06T22:31:08.157
> 
> 标签：vb.net, oop

我想为我的属性创建一个映射键/值数据注释，这样我将循环实体类并读取所有属性键/值对（列名和值）并传递给存储过程例如）我需要创建如下

```
 <Key:="Empl_Name",Value=mEmployeeName>
     Public Property EmployeeName() As String
        Get
            Return mEmployeeName
        End Get
        Set(ByVal Value As String)
            mEmployeeName = Value
        End Set
     End Property 
```

为此，我需要使用 system.Attribute 的 ColumnAttribute 类还是有更好的方法来实现？我正在使用.net 4 Vb.net。请建议

# node.js - EJS 是否处理 array.map(callback)？

> ID：13260487
> 
> 赞同：7
> 
> 时间：2012-11-06T22:31:39.477
> 
> 标签：node.js, map, ejs

我将一个对象数组传递给一个 EJS 模板，我想使用数组的常规 .map() 方法将其映射到链接中。但是由于我无法弄清楚的原因，我传递给 map() 的回调在 EJS 中不能像我期望的那样工作，而且我得到的结果是空的。

我的数据是一个对象数组，每个对象都有一个“部分”和一个“名称”键。该数组作为“条目”传递给模板：

```
siteHeaders = [ { section: "home", name: "Home"}, 
                { section: "about", name: "About Me"}, 
                ... plus few more ] 
```

模板看起来像这样，我将它放在一个名为 (surprise) 的局部变量中`template`：

```
<% entries = entries.map(function(elem) { -%>
  <% return -%>
  <a href="/<%= elem.section %>">
    <%= elem.name %>
  </a>
<% } ) -%>
<p><%- entries.join(" | ") %></p> 
```

当我打电话时，这个模板的结果`require('ejs').render(template, {entries: siteHeaders})`是：

```
 <p> |  |  |  | </p> 
```

我不明白为什么这在 EJS 模板中不起作用，而相应的 map 调用在 REPL 中工作得很好：

```
> siteHeaders.map(function(e){ return '<a href="/' + e.section +'">' + e.name + '</a>' })
[ '<a href="/home">Home</a>',
  '<a href="/guide">About Me</a>',
  '<a href="/quickstart">Portfolio</a>',
  '<a href="/reference">Blog</a>',
  '<a href="/downloads">Contact</a>' ]
> 
```

有什么线索吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T23:23:52.470

此代码应该可以工作：

```
<% entries = entries.map(function(elem) {
    return '<a href="/' + elem.section + '">' + elem.name + '</a>';
}) -%>
<p><%- entries.join(" | ") %></p> 
```

您不能在函数中使用简单的 html。只有在循环和条件下才有可能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T04:30:09.153

它不像join('|')那么干净，但是如果你不想连接，你可以这样做：

```
<% entries.forEach(function(entry, i, entries){ %>
    <a href="<%= entry.section %>"><%= entry.name %></a>
    <%= i == entries.length-1 ? ' | ' : '' %>
<% } %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-12T00:34:22.553

我没有设法在 EJS 中使用 map，但我找到了一种至少对我来说也很容易的方法

```
<ul>
  <% for (item of toDoList) { %>
    <li> <%= item %> </li>
  <% } %>
</ul> 
```

# javascript - 通过匿名函数获取变量名

> ID：13260488
> 
> 赞同：1
> 
> 时间：2012-11-06T22:31:42.493
> 
> 标签：javascript, function, anonymous-function

是否可以找到匿名函数的名称？

例如试图找到一种方法来提醒`anonyFu`或`findMe`在此代码[http://jsfiddle.net/L5F5N/1/](http://jsfiddle.net/L5F5N/1/)

```
function namedFu(){
    alert(arguments.callee);
    alert(arguments.callee.name);
    alert(arguments.callee.caller);
    alert(arguments.caller);
    alert(arguments.name);
}

var anonyFu = function() {
    alert(arguments.callee);
    alert(arguments.callee.name);
    alert(arguments.callee.caller);
    alert(arguments.caller);
    alert(arguments.name);
}

var findMe= function(){ 
    namedFu();
    anonyFu();
}
findMe(); 
```

这是为了一些内部测试，所以它不需要跨浏览器。事实上，即使我必须安装插件，我也会很高兴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:43:25.050

怀疑这可能是你得到它的方式。对于初学者，如果您添加了一行

`var referenceFu = anonyFu;`

您希望其中哪些名称能够登录？两者都只是参考。

然而——假设你有能力改变代码——这是有效的 javascript：

```
var anonyFu = function notActuallyAnonymous() {
    console.log(arguments.callee.name);
} 
```

这将记录`"notActuallyAnonymous"`. 因此，您可以只为您有兴趣检查的所有匿名函数添加名称，而不会破坏您的代码。

不确定这是否有帮助，但这就是我所得到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-23T19:40:40.537

您可以通过使用 arguments.callee 以编程方式从函数内部识别函数的任何属性，甚至是未命名的匿名函数。所以你可以用这个简单的技巧来识别函数：

每当您创建一个函数时，请为其分配一些属性，以便以后识别它。

例如，总是创建一个名为 id 的属性：

```
var fubar = function() {
   this.id = "fubar";
   //the stuff the function normally does, here
   console.log(arguments.callee.id);
} 
```

arguments.callee 本身就是函数，因此该函数的任何属性都可以像上面的 id 一样访问，甚至是您自己分配的属性。

Callee 已被官方弃用，但仍然适用于几乎所有浏览器，并且在某些情况下仍然没有替代品。您只是不能在“严格模式”下使用它。

当然，您也可以命名匿名函数，例如：

```
var fubar = function foobar() {
   //the stuff the function normally does, here
   console.log(arguments.callee.name);
} 
```

但这显然不那么优雅，因为（在这种情况下）你不能在两个地方都将它命名为 fubar。我必须将实际名称设为 foobar。

如果您的所有函数都有描述它们的注释，您甚至可以抓住它，如下所示：

```
var fubar = function() {
   /* 
      fubar is effed up beyond all recognition 
      this returns some value or other that is described here
    */
   //the stuff the function normally does, here
   console.log(arguments.callee.toString().substr(0, 128);
} 
```

请注意，您还可以使用 argument.callee.caller 来访问调用当前函数的函数。这使您可以从外部访问函数的名称（或属性，如 id 或文本中的注释）。

你这样做的原因是你想找出什么叫做有问题的函数。首先，这可能是您希望以编程方式查找此信息的原因。

因此，如果上面的 fubar() 示例之一调用了以下函数：

```
var kludge = function() {
   console.log(arguments.callee.caller.id); // return "fubar" with the first version above
   console.log(arguments.callee.caller.name); // return "foobar" in the second version above
   console.log(arguments.callee.caller.toString().substr(0, 128);
     /* that last one would return the first 128 characters in the third example, 
        which would happen to include the name in the comment. 
        Obviously, this is to be used only in a desperate case, 
        as it doesn't give you a concise value you can count on using)
     */
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-11T11:25:39.610

我将补充一点，如果您知道该函数在哪个对象中，那么您可以将代码添加到该对象或通常添加到对象原型中，这将获得基于值的键名。

```
Object.prototype.getKeyByValue = function( value ) {
    for( var prop in this ) {
        if( this.hasOwnProperty( prop ) ) {
             if( this[ prop ] === value )
                 return prop;
        }
    }
} 
```

然后你可以使用

```
THAT.getKeyByValue(arguments.callee.caller); 
```

曾经使用这种方法进行调试，其中大部分功能都在一个对象中的项目中涉及性能测试。不想以任何其他方式命名所有函数或代码中的双重名称，需要计算每个函数运行的时间 - 这加上函数开始时堆栈上的推送时间和结束时弹出的时间也是如此。

为什么？为每个函数添加非常少的代码，并为每个函数添加相同的代码，以便在控制台上进行测量和调用列表。这是临时的。

```
THAT._TT = [];
THAT._TS = function () {
  THAT._TT.push(performance.now());
}
THAT._TE = function () {
  var tt = performance.now() - THAT._TT.pop();
  var txt = THAT.getKeyByValue(arguments.callee.caller);
  console.log('['+tt+'] -> '+txt);
};

THAT.some_function = function (x,y,z) {
    THAT._TS();
    // ... normal function job
    THAT._TE();
}

THAT.some_other_function = function (a,b,c) {
    THAT._TS();
    // ... normal function job
    THAT._TE();
} 
```

不是很有用，但也许它会帮助在类似情况下遇到类似问题的人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T22:45:29.627

`arguments.callee`正如[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments/callee)所述，它已被弃用：

> 你应该避免使用`arguments.callee()`并且只给每个函数（表达式）一个名字。

换句话说：

```
[1,2,3].forEach(function foo() {
  // you can call `foo` here for recursion
}) 
```

如果你想要一个匿名函数的名字分配给一个变量，假设你正在调试你的代码并且你想跟踪这个函数的名字，那么你可以命名它两次，这是一个常见的模式：

```
var foo = function foo() { ... } 
```

除了 MDN 文档中指定的评估案例之外，我想不出您想要使用的任何其他案例`arguments.callee`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-07T00:26:08.873

没有。根据定义，*匿名*函数没有[`name`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/name). 但是，如果您想询问函数表达式：是的，您可以[将它们命名为](http://kangax.github.com/nfe/)。

不，在运行时无法获取变量（引用函数）的名称。

# sas - 包含来自远程服务器的 SAS 文件

> ID：13260490
> 
> 赞同：0
> 
> 时间：2012-11-06T22:31:46.003
> 
> 标签：sas

我想从我们的远程服务器中包含一些文件并在我的本地机器上使用它们。通常我使用这样的东西来包含我电脑上的文件：

```
%include 'C:\Users\sasfile.sas'; 
```

假设这个文件 sasfile.sas 在远程服务器上。如何从本地计算机访问它？

提前感谢您的回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:57:03.953

这取决于你的意思`remote server`。如果您指的是另一台 Windows 机器上的共享文件夹（并且您有权读取它），则可以只使用网络文件引用：

```
%include '\\server-name\share-name\folder\sasfile.sas'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T11:41:40.787

如果通过远程服务器，您的意思是您从本地客户端连接到的远程 SAS 服务器...

```
rsubmit ;
  proc download infile="/path/to/remote/sasfile.sas" outfile="c:\users\sasfile.sas" ;
  run ;
endrsubmit ;
%inc "c:\users\sasfile.sas" ; 
```

# iphone - 在 iOS 中解析 Intuit XML 响应

> ID：13260491
> 
> 赞同：0
> 
> 时间：2012-11-06T22:31:49.087
> 
> 标签：iphone, objective-c, ios, ipad, cocoa

我正在尝试解析 XML 格式的 REST 响应。响应的有趣之处在于多个节点具有相同的名称。我正在寻找一种在 iOS 中解析这些数据的简单方法。这是一个示例：

```
<Report name="BalanceSheet">
<ColDesc><ColTitle>AccountType</ColTitle><ColType>ids_String</ColType></ColDesc>
<ColDesc><ColTitle>Amount</ColTitle><ColType>ids_Amount</ColType></ColDesc>
<Data>
<DataRow>
<ColData>Checking/Savings</ColData>
<ColData>12345345</ColData>
</DataRow>
<DataRow>
<ColData>Accounts Receivable</ColData>
<ColData>674532</ColData>
</DataRow>
<DataRow>
<ColData>Other Current Assets</ColData>
<ColData>423546</ColData>
</DataRow>
<DataRow>
<ColData>Fixed Assets</ColData>
<ColData>63545534</ColData>
</DataRow>
<DataRow>
<ColData>Other Assets</ColData>
<ColData>325465</ColData>
</DataRow>
<DataRow>
<ColData>Accounts Payable</ColData>
<ColData>653653</ColData>
</DataRow>
<DataRow>
<ColData>Other Current Liabilities</ColData>
<ColData>910596.75</ColData>
</DataRow>
<DataRow>
<ColData>Long Term Liabilities</ColData>
<ColData>553797.26</ColData>
</DataRow>
<DataRow>
<ColData>Equity</ColData>
<ColData>45363</ColData>
</DataRow>
</Data>
</Report> 
```

我尝试使用 SMXMLDocument 解析器，并尝试使用 XMLReader 将其转换为 NSDictionary。XML 的结构方式令人困惑。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:47:47.660

它看起来像是到数据库表（甚至可能是 Excel 电子表格）的映射。看来您得到了 2 个列名。后面是数据，其中`<Data>`包含属于相应行的数据。

```
<Report name="BalanceSheet">
        <ColDesc>
            <ColTitle>
                AccountType
            </ColTitle>
            <ColType>
                ids_String
            </ColType>
        </ColDesc>
        <ColDesc>
            <ColTitle>
                Amount
            </ColTitle>
            <ColType>
                ids_Amount
            </ColType>
        </ColDesc>
    <Data>
        <DataRow>
            <ColData>
                Checking/Savings
            </ColData>
            <ColData>
                12345345
            </ColData>
        </DataRow>
        <DataRow>
            <ColData>
                Accounts Receivable
            </ColData>
            <ColData>
                674532
            </ColData>
        </DataRow>
        <DataRow>
            <ColData>
                Other Current Assets
            </ColData>
            <ColData>
                423546
            </ColData>
        </DataRow>
        <DataRow>
            <ColData>
                Fixed Assets
            </ColData>
            <ColData>
                63545534
            </ColData>
        </DataRow>
    </Data>
    </Report>

AccountType         | Amount
--------------------------------
Checking/Savings    | 12345345
Accounts Receivable | 674532 
```

决定使用哪个解析器将取决于您的需求，但在这里描述如何使用每个解析器会占用太多空间。 [本文](http://www.raywenderlich.com/553/how-to-chose-the-best-xml-parser-for-your-iphone-project)介绍了不同类型的解析器以及如何使用每种解析器。由于这个结构看起来很简单，我倾向于使用`NSXMLParser`（[Apple Docs](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:30:37.103

我今天早些时候已经写了一个简单的 NSXMLParser 示例，所以我就拿它来解析你描述的 XML。

此处的工作示例项目：[https ://github.com/erikt/ETParseIntuitSOExample](https://github.com/erikt/ETParseIntuitSOExample)

NSXMLParser 委托就是您所要求的。这是标题：

```
#import <Foundation/Foundation.h>

@interface ETIntuitParser : NSObject<NSXMLParserDelegate>
+ (NSDictionary *)parseIntuitXML:(NSString *)xml;
@end 
```

和实施：

```
#import "ETIntuitParser.h"

@interface ETIntuitParser ()
@property NSUInteger dataColNumber;
@property (copy,nonatomic) NSString *dataKey;
@property (strong,nonatomic) NSMutableString *currentElementValue;
@property (strong,nonatomic) NSMutableDictionary *resultDict;
@end

@implementation ETIntuitParser

+ (NSDictionary *)parseIntuitXML:(NSString *)xml {
    ETIntuitParser *intuitParser = [[ETIntuitParser alloc] init];
    NSXMLParser *xmlParser = [[NSXMLParser alloc] initWithData:[xml dataUsingEncoding:NSUTF8StringEncoding]];
    [xmlParser setDelegate:intuitParser];
    BOOL success = [xmlParser parse];

    if (success) {
        return [NSDictionary dictionaryWithDictionary:intuitParser.resultDict];
    } else {
        NSLog(@"Error parsing login information");
        return nil;
    }
}

#pragma mark - NSXMLParserDelegate
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict
{
    if ([elementName isEqualToString:@"Report"]) {
        if (!self.resultDict) {
            self.resultDict = [NSMutableDictionary dictionary];
        }
        return;
    }
}

- (void) parser:(NSXMLParser *)parser foundCharacters:(NSString *)string {
    if (!self.currentElementValue) {
        self.currentElementValue = [[NSMutableString alloc] initWithString:string];
    } else {
        [self.currentElementValue appendString:string];
    }
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
{

    if ([elementName isEqualToString:@"DataRow"]) {
        self.dataColNumber = 0;
    }

    if ([elementName isEqualToString:@"ColData"]) {
        NSString *trimmedValue = [self.currentElementValue stringByTrimmingCharactersInSet:
                                  [NSCharacterSet whitespaceAndNewlineCharacterSet]];

        if (self.dataColNumber == 0) {
            self.dataKey = trimmedValue;
            self.dataColNumber++;
        } else {
            [self.resultDict setObject:trimmedValue forKey:self.dataKey];
        }

    }

    self.currentElementValue = nil;
}
@end 
```

我刚刚用 NSLog 打印出结果字典（在视图控制器的 viewDidLoad 中不少于 ... ），结果是：

```
2012-11-07 00:21:22.409 ETParseIntuitSOExample[66941:c07] {
    "Accounts Payable" = 653653;
    "Accounts Receivable" = 674532;
    "Checking/Savings" = 12345345;
    Equity = 45363;
    "Fixed Assets" = 63545534;
    "Long Term Liabilities" = "553797.26";
    "Other Assets" = 325465;
    "Other Current Assets" = 423546;
    "Other Current Liabilities" = "910596.75";
} 
```

我不知道您是否需要 XML 结构中的列标题信息，但这应该很容易添加。

# php - htaccess 和 php 文件 - 将所有文件视为 php？

> ID：13260492
> 
> 赞同：-1
> 
> 时间：2012-11-06T22:31:50.877
> 
> 标签：php, html, apache, .htaccess, mamp

我在本地主机上有一个网站，最新的 MAMP 版本。子文件夹是 test2。

这是它的 .htaccess：

```
DefaultType text/html
DefaultType application/x-httpd-php 
```

这是确保文件被视为 HTML 和 PHP 的正确方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:48:03.247

写成：

```
<Files *>
  DefaultType text/html
  DefaultType application/x-httpd-php
</Files> 
```

dir 和 subdirs 中的所有文件都将以 PHP 格式打开。

# clojure - Clojure 和 ZeroMQ

> ID：13260494
> 
> 赞同：5
> 
> 时间：2012-11-06T22:31:55.373
> 
> 标签：clojure, zeromq

谁能告诉我一些工作依赖项来启动和运行 zeromq 和 clojure？

我已经尝试了几个，但 leiningen 无法获取它们：

`org.zmq:zmq:jar:2.1.0`（在中央找不到工件（http://repo1.maven.org/maven2））

```
[org.zmq/zmq "2.1.0"]
[org.zmq/jzmq "1.0.0"] 
```

我已经编译`jzmq`（`/usr/local/share/java/jzmq.jar`）并将其添加到我的`project.clj`：

```
:native-path  "/usr/local/lib" 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-07T09:28:19.690

[这里](https://clojars.org/org.zeromq/zmq)有一个 2.0-SNAPSHOT ：

Lein 应该已经加载了 clojars 存储库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T18:19:09.213

我提议的是已经提议的混合，但为了完整起见并希望给出最终答案，我试一试。

由于依赖项不在在线存储库中，我会将 jar 包含在项目的目录结构本身中，例如在目录中`repository`，并将其作为项目的其他文件保存在源代码控制系统中。它是项目的重要组成部分，没有依赖项就无法运行。

[在这个目录中，我将在Maven Install plugin](http://maven.apache.org/plugins/maven-install-plugin/install-file-mojo.html)的帮助下保存 jar 。

```
mvn install:install-file \
    -Dfile=/usr/local/share/java/jzmq.jar \
    -DgroupId=org.zeromq \
    -DartifactId=jzmq \
    -Dversion=2.1.0 \
    -Dpackaging=jar \
    -DlocalRepositoryPath=repository 
```

当 jar 文件被复制到本地存储库时，您定义它和依赖项，`project.clj`如下所示：

```
(defproject clojure-interal-repo-test "0.1.0-SNAPSHOT"
  :dependencies [[org.clojure/clojure "1.4.0"]
                 [org.zeromq/jzmq "2.1.0"]]
  :repositories [["zeromq-repository" {:url       "file:repository"
                                       :snapshots false
                                       :checksum  :ignore
                                       :update    :never}]]) 
```

在项目中，运行`lein2 deps :tree`以验证其正确性。

```
$ lein2 deps :tree
Retrieving org/zeromq/jzmq/2.1.0/jzmq-2.1.0.jar (4k) from file:repository/
 [org.clojure/clojure "1.4.0"]
 [org.zeromq/jzmq "2.1.0"] 
```

请注意，`4k`上面是我为测试它而创建的假文件的大小。

如果您需要更多信息，请阅读 Leiningen wiki 中的文档可[重复性。](https://github.com/technomancy/leiningen/wiki/Repeatability)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T09:22:22.833

您可以创建一个[Maven 本地存储库](http://maven.apache.org/guides/introduction/introduction-to-repositories.html)，将编译后的库安装到本地存储库中，然后将以下内容添加到您的`project.clj`

```
:repositories {"local" ~(str (.toURI (java.io.File. "your_local_repository_path")))} 
```

类似的问题，我之前[在这里回答过](https://stackoverflow.com/questions/8411428/how-to-use-leiningen-to-develop-using-local-jars/8411478#8411478)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-07T09:24:47.943

不幸的是，ZeroMQ 不存在于公共存储库中，至少在我最后一次检查时（我认为是一个月前）。所以你必须手动安装jar：

```
mvn install:install-file -Dfile=/usr/local/share/java/jzmq.jar -DgroupId=org.zeromq \
-DartifactId=jzmq -Dversion=2.1.0 -Dpackaging=jar 
```

然后你可以像`[org.zeromq/jzmq "2.1.0"]`在你的`project.clj`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-15T04:13:40.947

我可以让它工作的唯一方法是使用 jeromq。

```
[org.zeromq/jeromq "0.3.2"] 
```

Jeromq 是原生 Java。

# php - 学习如何重构 PHP 代码

> ID：13260499
> 
> 赞同：0
> 
> 时间：2012-11-06T22:32:32.500
> 
> 标签：php

我目前正在使用 PHP 5.2.9。有没有办法以更容易阅读和更好组织的方式重构这段代码？

```
 if ($is_read_only == true) {
      echo ($affiliate['affiliate_gender'] == 'm') ? MALE : FEMALE;
  } elseif ($error == true) {
      if ($entry_gender_error == true) {
            echo tep_draw_radio_field('a_gender', 'm', $male) . '&nbsp;&nbsp;' . MALE . '&nbsp;&nbsp;' . tep_draw_radio_field('a_gender', 'f', $female) . '&nbsp;&nbsp;' . FEMALE . '&nbsp;' . ENTRY_GENDER_ERROR;
      } else {
            echo ($a_gender == 'm') ? MALE : FEMALE;
            echo tep_draw_hidden_field('a_gender');
      }
  } else {
      echo tep_draw_radio_field('a_gender', 'm', $male) . '&nbsp;&nbsp;' . MALE . '&nbsp;&nbsp;' . tep_draw_radio_field('a_gender', 'f', $female) . '&nbsp;&nbsp;' . FEMALE . '&nbsp;' . ENTRY_GENDER_TEXT;
  } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T22:45:19.577

我不知道你为什么希望它在更少的行中，但你去：

```
echo $is_read_only === true
?   $affiliate['affiliate_gender'] === 'm' ? MALE : FEMALE
:   $error === true
?   $entry_gender_error == true
?   tep_draw_radio_field('a_gender', 'm', $male) . '&nbsp;&nbsp;' . MALE . '&nbsp;&nbsp;' . tep_draw_radio_field('a_gender', 'f', $female) . '&nbsp;&nbsp;' . FEMALE . '&nbsp;' . ENTRY_GENDER_ERROR
:   ($a_gender === 'm' ? MALE : FEMALE) . tep_draw_hidden_field('a_gender')
:   tep_draw_radio_field('a_gender', 'm', $male) . '&nbsp;&nbsp;' . MALE . '&nbsp;&nbsp;' . tep_draw_radio_field('a_gender', 'f', $female) . '&nbsp;&nbsp;' . FEMALE . '&nbsp;' . ENTRY_GENDER_TEXT; 
```

它肯定不是更具可读性。可读性和压缩似乎相互矛盾。

**编辑：**

对于其中的挑战，我走得更远。

```
echo $is_read_only
?   $affiliate['affiliate_gender'] === 'm' ? MALE : FEMALE
:   $error && !$entry_gender_error
?   ($a_gender === 'm' ? MALE : FEMALE) . tep_draw_hidden_field('a_gender')
:   tep_draw_radio_field('a_gender', 'm', $male) . '&nbsp;&nbsp;' . MALE . '&nbsp;&nbsp;' .
    tep_draw_radio_field('a_gender', 'f', $female) . '&nbsp;&nbsp;' . FEMALE . '&nbsp;' .
    ($error ? ENTRY_GENDER_ERROR : ENTRY_GENDER_TEXT); 
```

这是我作为人类所能做的最糟糕的事情。

愿上帝怜悯我的灵魂:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T22:43:46.947

您可以更改`if ($is_read_only == true)` 为`if ($is_read_only)`以及其他 if 语句，因为放置 '`== true'`是多余且不必要的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T22:57:47.797

我更喜欢这样：

```
if ($is_read_only)
    echo ($affiliate['affiliate_gender'] == 'm') ? MALE : FEMALE;
elseif ($error)
    if ($entry_gender_error)
        echo tep_draw_radio_field('a_gender', 'm', $male) . '&nbsp;&nbsp;' . MALE.
             '&nbsp;&nbsp;' . tep_draw_radio_field('a_gender', 'f', $female) .  
             '&nbsp;&nbsp;' . FEMALE . '&nbsp;' . ENTRY_GENDER_ERROR;
    else
        echo ($a_gender == 'm') ? MALE : FEMALE , tep_draw_hidden_field('a_gender');
else
    echo tep_draw_radio_field('a_gender', 'm', $male) . '&nbsp;&nbsp;' . MALE .
         '&nbsp;&nbsp;' . tep_draw_radio_field('a_gender', 'f', $female) .
         '&nbsp;&nbsp;' . FEMALE . '&nbsp;' . ENTRY_GENDER_TEXT; 
```

我避免使用太长的回声句子，以提高可读性。很多 {s 和 } 的结果也很混乱。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T22:59:32.350

这取决于您所说的“**压缩**”到底是什么意思？

由于您尚未澄清，因此您得到了基本的答复。

**删除空格：**

如果您希望以某种方式加速您的代码，请不要打扰。压缩（缩小/删除空间）一个php文件不会加快它的执行时间。PHP 每次都会读取文件，将其编译为字节码并运行它。这样做会让你的眼睛和你的同事一样流血。只是不要这样做！

**为了可读性/可用性：**

然后，您最好将代码/类/函数相应地划分为有意义且易于阅读的块。这不仅会帮助您，还会帮助与您一起工作的人。使用设置缩进级别、间距/括号/嵌套样式等。

**对于代码性能：**

有无数种方法可以在视觉形式和代码性能方面改进代码（类/函数/循环/连接/语句） - 可以使用各种工具对其进行分析/测试。

希望这有助于作为一个指针。

# java - 如何在 Java 中确定 youtube 上的视频文件大小？

> ID：13260502
> 
> 赞同：1
> 
> 时间：2012-11-06T22:32:44.177
> 
> 标签：java, video, youtube, download

我正在使用[youtube-API](https://developers.google.com/youtube/2.0/developers_guide_java)来收集有关视频的不同信息。到目前为止，唯一缺少的属性是大小。API 本身不提供任何功能。我用谷歌搜索，但没有找到任何解决方案。

间接方式 我的下一个想法是获取视频文件本身的路径并发出获取请求。在响应标头中，我可以检查文件大小。所以我搜索了“视频/下载/youtube/java”。前段时间 youtube 使用[了 get_video_info](https://stackoverflow.com/questions/2881143/youtube-video-download-url)但这在今天不起作用。我还发现了一个名为[JavaYoutubeDownloader](https://stackoverflow.com/questions/4032766/how-to-download-videos-from-youtube-on-java)的应用程序，但仅获取文件大小似乎非常复杂，而且它也不起作用（只是打印完成，无需下载任何内容）。

那么有没有办法通过使用 Java 来获取 youtube 上视频的文件大小？如果没有，这个问题的实际解决方案是什么（存在 video_ids 列表）？

**编辑：** 我知道如何获取文件的大小，但我不知道如何获取视频文件的 URL！因此，要么我需要一种方法来获取指向 youtube-Link 的 FLV 的 URL，要么需要一种方法来确定文件大小。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T22:45:19.220

您可以使用 URLConnection 对 .flv 文件发出 HEAD 请求并获取`Content-Length`标头的内容。使用 setMethod("HEAD") 只会返回标题而不下载整个文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T22:40:27.630

您可以在 HTTP 标头上查找 Content-Length 字段（根据更新的文档，请检查 getContentLength() ）。

请参考[Java URLConnection ：如何找出 Web 文件的大小？](https://stackoverflow.com/questions/263013/java-urlconnection-how-could-i-find-out-a-files-size)

# arduino - 将 Arduino 库用于常规 AVR 代码

> ID：13260508
> 
> 赞同：20
> 
> 时间：2012-11-06T22:32:58.510
> 
> 标签：arduino, libraries, avr

我有一个 Arduino Uno 和一个 Linux 环境。虽然 Arduino IDE 非常棒，但是如果出现问题，它并没有给我太多的输入。而且它也会变得非常缓慢，有时会停止与芯片的通信。

另一种方法是使用 AVR-GCC/g++ 和 AVRDude 工具链对我的 Arduino Uno 进行编码。但是，我非常希望在使用简单的文本编辑器和命令行工具进行编程时访问与 Arduino 中相同的功能（如[Serial](http://arduino.cc/en/Reference/Serial)、[digitalWrite](http://www.arduino.cc/en/Reference/digitalWrite)等）。

所以我试图找到所有定义的函数的头文件，即“Arduino.h” `/usr/share/arduino/hardware/arduino/cores/arduino`。

我用它来编译（使用makefile来做这个）

```
avr-gcc -mmcu=atmega328p -I. -gdwarf-2 -DF_CPU=16000000UL -Os -funsigned-char -funsigned-bitfields -fpack-struct -fshort-enums -Wall -Wstrict-prototypes -Wa,-adhlns=testarduino.o -I/usr/share/arduino/hardware/arduino/cores/arduino -I/usr/share/arduino/hardware/arduino/variants/standard -std=gnu99 -MMD -MP -MF .dep/testarduino.elf.d testarduino.o --output testarduino.elf -Wl,-Map=testarduino.map,--cref     -lm 
```

编译这段代码：

```
#include "Arduino.h"

int main(void)
{
    init();
    pinMode(13,OUTPUT);
    while(1){
    digitalWrite(13,HIGH);
    delay(1000);
    digitalWrite(13,LOW);
    delay(1000);
    }
    return 0;
} 
```

但是，当我尝试编译时，似乎没有一个函数被识别（说未定义的对'xxxxxxxxx'的引用）。那么，为了确保我可以使用相同的功能，需要包含的确切头文件是什么？或者还有什么我错过的吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-05-03T18:26:07.817

## 如何获取定义`undefined reference`

该消息`undefined reference to 'xxxxxxxxx'`意味着链接器找不到相关函数的实际*定义*（不仅仅是声明）。

当链接器找不到函数的定义时，通常可以在 lib 文件（例如 *.so 或 *.dll）或源文件（例如 *.cpp 或 *.c）中找到该定义。对于您的 Arduino，您需要告诉 avr-gcc 编译和链接 Arduino *.cpp 文件。您需要来自 Arduino 核心的所有源文件。

```
ARDCOREDIR = <my arduino folder>/hardware/arduino/cores/arduino 
```

Sudar 给出了很好的建议，提倡使用用于 AVR 的 Makefile，该 Makefile 配置为包含 Arduino 函数*定义*。（我将链接到我的并在下面解释。）

在我的 makefile 中，我按如下方式处理了此操作：

```
# CPP_SOURCE_FILES is a previously-defined variable, holding my project's source files
CPP_SOURCE_FILES += $(filter-out $(ARDCOREDIR)/main.cpp, $(wildcard $(ARDCOREDIR)/*.cpp)) 
```

请注意，我省略了 main.cpp 文件，因为 Arduino main.cpp 文件定义了`main()`，我希望自己在自己的项目文件中定义它。

## 必要的头文件

当然，您还必须为 arduino 标头传递 avr-gcc 一个包含标志：

```
-I$(ARDCOREDIR) 
```

您必须在实际项目代码中包含 Ardhuino.h 文件：

```
#include <Arduino.h> 
```

Arduino.h 头文件将包含所有其他 Arduino 头文件，包括 pinout 文件，其中包含 Arduino 引脚的定义。不同的 Arduino 必须有不同的 pinout 文件，因此请确定您使用的是哪种类型，并告诉 avr-gcc 包含包含适当 pinout 文件的目录。如果您使用的是标准 Arduino (UNO)，请使用以下命令：

```
-I$(ARDCOREDIR)/../../variants/standard 
```

## 我的 Makefile

您的构建过程不仅需要执行上述几条指令，还需要知道如何制作 .hex 文件，该文件将被编程到您的 Arduino（或 AVR）上。因此，使用 makefile 是一个好主意。

我不喜欢为每个项目重建我的makefile，所以我的机器上只有一个基本makefile，每个项目都有自己的，非常短的makefile，它调用`include`包含基本makefile。你可以[在这里找到我的基本 makefile](https://gist.github.com/entrity/5424505)。

**我机器上单个项目的简短（非基础）Makefile 示例：**

```
# This is the name of the file that shall be created. (It is also the name of my primary source file, without the file extension.)
TARGET = temp

# create a variable that only pertains to this project
MY_OWN_LIBRARY_DIR = /usr/home/MJ/Arduino/libraries/mj_midi

# "EXTRAINCDIRS" is a variable used by the base makefile. The base makefile creates a -I compiler flag for every item in the "EXTRAINCDIRS" list.
EXTRAINCDIRS = $(MY_OWN_LIBRARY_DIR)

# specify *.c source files pertaining to my project
SRC =

# specify *.cpp source files pertaining to my project
PSRC = temp.cpp $(MY_OWN_LIBRARY_DIR)/midi-listener.cpp $(MY_OWN_LIBRARY_DIR)/midi-song.cpp

# specify additional (non-core) Arduino libraries to include
ARDLIBS = SoftwareSerial

# include my base makefile
include /d/dev/avr/Makefile.base 
```

注意：如果您要使用我的基本 makefile，请确保将变量`ARDDIR`（显示在文件顶部附近）设置为指向您机器上的 Arduino 目录。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T10:47:07.320

[我为 Arduino](https://github.com/sudar/Arduino-Makefile/)使用makefile ，它允许我同时使用用户和系统库。您不必使用 Arduino IDE，但同时可以使用它提供的库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-28T17:33:47.270

您可能希望将 Arduino IDE 编译选项设置为详细。然后编译一些东西并观察 IDE 的输出。它会告诉您 .cpp 文件的位置以及它使用的编译器选项。查看 .cpp 文件后，您会立即看到需要包含的内容。

之后，makefile 变得更容易理解。如果您之前没有经验，我的建议是避免它并改为使用 scons。Scons 是用 Python 编写的。因此，您可以立即从更简单的调试中受益。

# haskell - Fork 到 shell 脚本并使用 Haskell 终止原始进程

> ID：13260512
> 
> 赞同：6
> 
> 时间：2012-11-06T22:33:15.570
> 
> 标签：haskell, process, fork

我目前正在编写一个 Haskell 程序，该程序执行一些初始化工作，然后调用 ncmpcpp。我想要做的是启动 ncmpcpp 并终止 Haskell 程序，这样就只剩下 ncmpcpp （可选地，程序可以在后台继续运行，只要它不干扰）

但是，即使我能够启动 ncmpcpp，我也无法与之交互。我看到了它的输出，但输入似乎是不可能的。

我目前正在做的是：

```
import System.Process (createProcess, proc)
...
spawnCurses :: [String] -> IO ()
spawnCurses params = do 
  _ <- createProcess (proc "ncmpcpp" params)
  return () 
```

我做错了什么/我应该做些什么不同的事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T22:58:39.977

您试图实现的目标听起来就像[`exec`](https://en.wikipedia.org/wiki/Exec_%28operating_system%29)函数系列所做的那样。看一下[`executeFile`](http://www.haskell.org/hoogle/?hoogle=executeFile)功能。

如果你希望你的父 Haskell 进程在子进程启动后仍然运行，请阅读[fork-exec](https://en.wikipedia.org/wiki/Fork-exec)和[`forkProcess`](http://www.haskell.org/hoogle/?hoogle=forkProcess)函数。

可以在[http://therning.org/magnus/archives/727](http://therning.org/magnus/archives/727)`forkProcess`找到与 with 一起使用的完整示例。`executeFile`

# c# - 在 AppFabric 中手动缓存 MVC 视图

> ID：13260517
> 
> 赞同：5
> 
> 时间：2012-11-06T22:33:45.087
> 
> 标签：c#, asp.net-mvc, appfabric, appfabric-cache

我试图通过自己缓存视图结果对象来重新创建 MVC 4 中 OutputCache 操作过滤器的大部分功能。我不想使用 OutputCache 操作过滤器的原因是因为我不能将它与 AppFabric 和部分视图一起使用；部分视图始终存储在 MemoryCache 中，我希望在服务器场中使用缓存的对象。

我遇到的第一个问题是

```
{"Type 'System.Web.Mvc.TempDataDictionary' cannot be serialized. 
Consider marking it with the DataContractAttribute attribute, and marking all of 
its members you want serialized with the DataMemberAttribute attribute.  
If the type is a collection, consider marking it with the 
CollectionDataContractAttribute.  See the Microsoft .NET Framework documentation for  
other supported types."} 
```

这让我想知道我是否应该缓存其他东西以返回本质上是最后的视图。有没有人知道我应该缓存什么来重新创建视图或在服务器场上缓存部分视图的不同方法？我不想为此使用第三方插件。

谢谢

更新：我开始像这样缓存部分视图的字符串表示：

```
using (StringWriter sw = new StringWriter())
        {
            ViewEngineResult viewResult = ViewEngines.Engines.FindPartialView(ControllerContext, "ViewName");
            ViewContext viewContext = new ViewContext(ControllerContext, viewResult.View, ViewData, TempData, sw);
            viewResult.View.Render(viewContext, sw);
            view = sw.GetStringBuilder().ToString();
        } 
```

这使得在缓存中检索字符串并将其作为操作中的内容返回变得很容易。我仍在寻找其他建议或更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:41:39.443

也许有点晚了，但让我和你分享我的经验。

虽然 ASP.NET MVC 构建在 ASP.NET 框架之上，但它有一些非常显着的差异，这使得在 MVC 中重用 ASP.NET 功能相当困难。你说得对：全页面输出缓存和部分页面输出缓存以完全不同的方式实现。Greg Roberts 的另[一篇博客文章](http://thenullreference.com/blog/fixing-the-asp-net-mvc-3-outputcacheattribute-for-partial-views-to-honor-some-web-config-settings/)表明 MVC 中的输出存在许多问题。它在 WebForms 中非常有用！

这就是我转向 MvcDonutCaching ( [Nuget](http://nuget.org/packages/MvcDonutCaching/) ) 的原因。它解决了我们的许多问题。请阅读[此处](http://www.devtrends.co.uk/blog/donut-output-caching-in-asp.net-mvc-3)或[codeplex](http://mvcdonutcaching.codeplex.com/)上的介绍。

对您来说好消息是 MvcDonutCaching 也与 AppFabric Caching 完全兼容；DevTrends几个月前发表了[一篇文章。](http://www.devtrends.co.uk/blog/asp.net-mvc-output-caching-with-windows-appfabric-cache)这意味着您可以使用新的输出缓存提供程序（包含在 AppFabric 1.1 中）。

添加这个新提供者非常简单，就像以这种方式添加引用和更改配置一样。

```
<caching>
  <outputCache defaultProvider="DistributedCache">
    <providers>
      <add name="DistributedCache"
           type="Microsoft.Web.DistributedCache.DistributedCacheOutputCacheProvider, Microsoft.Web.DistributedCache"
           cacheName="default"
           dataCacheClientName="default" />
    </providers>
  </outputCache>
</caching> 
```

希望这会对您有所帮助，因为它对我们有很大帮助！

# ruby-on-rails - 使用 Devise 和 RSpec 测试身份验证重定向

> ID：13260521
> 
> 赞同：4
> 
> 时间：2012-11-06T22:34:16.177
> 
> 标签：ruby-on-rails, devise, capybara, rspec-rails

我有一个我正在开发的示例 Rails 应用程序，因此我可以开始熟悉 BDD。

现在我正在使用设计来处理我的用户身份验证。

我有一个任务模型，它需要用户登录才能访问新的、创建、编辑和销毁操作。

我有以下代码：

**请求/tasks_spec.rb**

```
describe "Tasks" do

  it "redirects to sign in for new task if no user logged in" do
    visit new_task_path
    response.should redirect_to(new_user_session_path)
  end

end 
```

现在，当我运行这个测试时，我预计它会失败，因为我没有向 TasksController 添加任何 before_filter 逻辑。我运行测试，它失败了。

现在我添加`authenticate_user!`Devise 提供的助手。

**任务控制器.rb**

```
class TasksController < ApplicationController
  before_filter :authenticate_user!, only: [:new, :edit, :create, :destroy]
  ...
end 
```

测试运行但仍然失败，说明如下：

```
 1) TasksController redirects to sign in for new task if no user logged in
     Failure/Error: response.should redirect_to(new_user_session_path)
       Expected response to be a <:redirect>, but was <200> 
```

现在调用访问时，由于会话中没有建立用户，我希望响应被重定向到/user/sign_in。但是，我只是得到了 200OK 的回报。

我在这里想念什么？我怎样才能让这个测试通过？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T04:42:15.110

尝试这个：

```
describe "redirects to sign in for new task if no user logged in" do
  before { post tasks_path }
  specify { response.should redirect_to(new_user_session_path) }
end 
```

# php - 使用 simplecart 从本地存储中检索选定餐厅的存储值

> ID：13260522
> 
> 赞同：1
> 
> 时间：2012-11-06T22:34:43.463
> 
> 标签：php, javascript, local-storage, simplecart

我正在尝试根据所选餐厅检索存储在本地存储中的购物车项目。

首先，在控制台日志中，“每个”循环似乎运行了两次。

其次， indexOf 正在工作！但这是以下两行的问题：

> `simpleCart.get(item).show();`
> 
> 和
> 
> `simpleCart.get(item).hide();`

第一个有点接缝，但第二个被完全忽略并从本地存储返回所有结果。

我怎样才能隐藏选定的项目而不显示在购物车中？？？？？？？帮助！！！

* * *

**`$restName`**= 所选餐厅。（一个 php 变量）

```
<script type="text/javascript">
simpleCart.bind(\'load\', function(){
    var items = localStorage.getItem("simpleCart_items");
    if (!items) {
        return;
    } try {
        simpleCart.each(JSON.parse(items),function(item) {
            var id_found = item.itmid.indexOf("' . $restName . '");
            if (id_found >= 0){
                simpleCart.get(item).show();
            } else {
                simpleCart.get(item).hide();
            }
        });
    } catch (e){
        simpleCart.error("Error Loading data: " + e);
    }
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T22:08:34.520

可能提供一些来自 localStorage 的数据示例将有助于理解问题。顺便说一句，您是否尝试过从控制台检索该值？

# ajax - 你能阻止 VisualForce 组件在其内容变得可见之前呈现吗？

> ID：13260529
> 
> 赞同：0
> 
> 时间：2012-11-06T22:35:51.173
> 
> 标签：ajax, salesforce, apex-code, visualforce

我有一个 VisualForce 页面，其中包含两个组件，每个组件都在一个选项卡内，如下所示：

```
<apex:tabpanel switchtype="ajax" selectedTab="tab1">
    <apex:tab label="First Tab" name="tab1" id="tab1">
     <c:firstComponent /> 
    </apex:tab>
    <apex:tab label="Second Tab" name="tab2" id="tab2">
    <c:secondComponent />
    </apex:tab>
</apex:tabpanel> 
```

在用户实际点击第二个选项卡之前，是否可以阻止页面运行 secondComponent（包含在 tab2 中）中的代码？

这是一个更普遍的问题的特殊情况：是否可以在第一次加载页面时不运行页面上的所有代码，而仅在用户执行特定操作时运行它。

（想要这样做的一个原因是减少页面上的查询数量以避免达到限制。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T20:29:16.213

我认为它可以按您的意愿工作！您可能在构造函数中有太多逻辑。并且[组件的构造函数必须执行](http://www.salesforce.com/us/developer/docs/pages/index_Left.htm#StartTopic=Content/pages_controller_get_request.htm)。

检查这个例子，它对我有用（这意味着只有当我导航到第二个选项卡时才会引发异常）。

```
public class tabTest{
    public Contact getContact(){
        throw new exampleException('That\'s no moon. It\'s a space station.');
    }
    public class exampleException extends Exception{}
} 
```

* * *

```
<apex:page controller="tabTest">
    <apex:tabpanel switchtype="ajax" selectedTab="tab1">
        <apex:tab name="tab1" label="1st" >1</apex:tab>
        <apex:tab name="tab2" label="it's a trap!">{!contact.LastName}</apex:tab>
    </apex:tabpanel>
</apex:page> 
```

调用构造函数时（在主页上然后在每个组件上）是否调用了很多逻辑？您可以将其中的一些移到操作方法中吗（返回 getter 方法的方法：

```
public List<Contact> myData{
    get{
        if(myData == null){
            myData = [SELECT Id FROM Contact LIMIT 5];
        }
        return myData;
    }
    private set;
} 
```

我知道这看起来很疯狂，但它是[自 2008 年以来的有效语法](http://blogs.developerforce.com/developer-relations/2008/06/property-access.html)；）您也可以进行传统`getMyData()`调用。

这是一个偏好问题，但我尝试使我的构造函数尽可能薄，只有基本的初始化。如果我要开始获取各种东西，这意味着最终用户可能每次都不需要所有数据的延迟。

至于关于在用户执行操作时运行代码的更一般的问题 - 有各种标签和选项：commandButtons、commandLinks、actionSupport、actionFunction、JavaScript 远程处理......我不会粘贴所有链接，但有很多示例，其中最重要的是[http://wiki.developerforce.com/page/Visualforce_DynamicEditPage](http://wiki.developerforce.com/page/Visualforce_DynamicEditPage)。

# python - 针对 NumPy dtypes 的验证——检查值最不迂回的方法是什么？

> ID：13260531
> 
> 赞同：6
> 
> 时间：2012-11-06T22:36:16.410
> 
> 标签：python, validation, numpy, introspection, typechecking

我想根据给定 NumPy 所暗示的约束测试一个未知值`dtype`——例如，如果我有一个整数值，它是否足够小以适合 a `uint8`？

据我所知，NumPy 的`dtype`架构并没有提供这样的方法：

```
### FICTIONAL NUMPY CODE: I made this up ###
try:
    numpy.uint8.validate(rupees)
except numpy.dtype.ValidationError:
    print "Users can't hold more than 255 rupees." 
```

我的小幻想 API 基于 Django 的[模型字段验证器](https://docs.djangoproject.com/en/dev/ref/validators/)，但这只是一个例子——我设法设计的最佳机制是这样的：

```
>>> nd = numpy.array([0,0,0,0,0,0], dtype=numpy.dtype('uint8'))
>>> nd[0]
0
>>> nd[0] = 1
>>> nd[0] = -1
>>> nd
array([255,   0,   0,   0,   0,   0], dtype=uint8)
>>> nd[0] = 257
>>> nd
array([1, 0, 0, 0, 0, 0], dtype=uint8) 
```

通过`numpy.ndarray`typed as 显式地将可疑值往返`numpy.uint8`返回给我已包装成具有适当大小的整数的整数 - 不会抛出异常或引发任何其他类型的可操作错误状态。

当然，我宁愿不穿建筑宇航员飞行服，但这是更可取的选择，这看起来像是无法维护的意大利面条怪物混乱的`if dtype(this) ... elif dtype(that)`陈述。除了开始编写自己的 API 的宏伟而放纵的行为之外，我还能在这里做些什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T22:41:02.073

如果`a`是您的原始可迭代对象，您可以执行以下操作：

```
np.all(np.array(a, dtype=np.int8) == a) 
```

很简单，这会将结果`ndarray`与原始值进行比较，并告诉您转换`ndarray`是否是无损的。

这也将捕获诸如使用太窄而无法准确表示某些值的浮点类型之类的事情：

```
>>> a = [0, 0, 0, 0, 0, 0.123456789]
>>> np.all(np.array(a, dtype=np.float32) == a)
False
>>> np.all(np.array(a, dtype=np.float64) == a)
True 
```

**编辑：**将上述代码与浮点数一起使用时需要注意的一个问题是，NaN 总是比较不相等。如果需要，扩展代码来处理这种情况也很简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-30T15:26:44.643

看看`numpy` [iinfo](http://docs.scipy.org/doc/numpy/reference/generated/numpy.iinfo.html) / [finfo](http://docs.scipy.org/doc/numpy/reference/generated/numpy.finfo.html)结构。他们应该提供适用于基本数据类型的验证服务所需的所有信息。这不适用于复合或二进制字段 dtype。您仍然需要为此实现服务框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T22:41:09.943

尝试使用[`numpy.seterr()`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.seterr.html#numpy.seterr)with`over`以在溢出时触发警告/错误。

例如

```
numpy.seterr(over='raise') 
```

# python - Djangobb - 收到不正确的确认链接

> ID：13260535
> 
> 赞同：0
> 
> 时间：2012-11-06T22:36:38.080
> 
> 标签：python, django

我设置了 djangobb，经过大量的问题和花费大量时间使其与我的应用程序一起工作，它终于工作了......我仍然存在的唯一问题是，当有人注册时，他收到的注册链接不正确。

例子：

```
http://example.com/forum/account/activate/eac687ca1d21c4ae0f33d61766fec3a289936dbf/ 
```

如何将网址编辑为我自己的网址？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T07:01:29.217

将其更改为`/admin/sites/site/`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T07:08:17.553

你可以在`/admin/sites/site`. 如果您想使用不同的站点进行开发和生产版本，您可以使用[此处](https://docs.djangoproject.com/en/dev/ref/settings/#site-id)`SITE_ID`描述的设置。

# objective-c - NSArray 索引 1 超出空数组的范围

> ID：13260538
> 
> 赞同：0
> 
> 时间：2012-11-06T22:36:56.267
> 
> 标签：objective-c, ios, xcode

```
-(IBAction)someMethod:(UIStepper *)sender{
    int x=sender.value; //This is an integer from 0-8;
    NSLog(@"%f",sender.value);
    NSArray *rpmValues = [[NSArray alloc]initWithObjects:@"a",@"b",@"c",@"d",@"e",@"f",@"g",@"h",@"i", nil];
    if (x<=[rpmValues count]) {

        myLabel.text = [rpmValues objectAtIndex:x];
    }
    NSLog(@"%i",[rpmValues count]);
} 
```

以上是我的代码，我想做的是通过改变 UIStepper 来改变 UILabel 的显示。这是非常直接的。但是当我改变按下步进值时，它会崩溃：

```
*** Terminating app due to uncaught exception 'NSRangeException', reason: '*** -   [__NSArrayM objectAtIndex:]: index 1 beyond bounds for empty array'
*** First throw call stack: 
```

[rpmValue count] 是 9。我真的很困惑。谁能帮我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T22:43:40.937

该代码看起来不错（请参阅我对问题的评论）；您的问题可能源于使用

```
if (x<=[rpmValues count]) { 
```

这将包括数组的计数，超出索引范围一。采用

```
if (x < [rpmValues count]) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:43:54.893

至少`if (x<=[rpmValues count])`应该是`if (x<[rpmValues count])`。否则，如果您有一个包含两个实体的数组，那么您将允许自己访问索引 0、1 和 2 — 总共三种可能性。

`maximumValue`您是否可以根据类似的逻辑在“9”的步进器上设置一个？

# joomla - 将会员跟踪器代码添加到美德玛特感谢页面

> ID：13260545
> 
> 赞同：2
> 
> 时间：2012-11-06T22:37:48.030
> 
> 标签：joomla, virtuemart, affiliate

我想使用 VirtueMart 向我的基于 Joomla 的网站添加会员跟踪器代码。他们告诉我在感谢页面上添加代码，但我无法弄清楚。VirtueMart 版本为 2.0.12，代码为

```
<script src="http://network.clickbanner.gr/i_sale_third/10566/SALE_AMOUNT/TRANSACTION_ID
/OPTIONAL_INFORMATION&sale_status=P"></script>
<noscript><img src="http://network.clickbanner.gr/i_track_sale/10566/SALE_AMOUNT/TRANSACTION_ID
/OPTIONAL_INFORMATION&sale_status=P"></noscript> 
```

Ι 必须替换`SALE_AMOUNT`为订单的不含税价格和`transaction_id`订单id。任何想法如何实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T17:56:43.150

解决方案：

感谢页面的输出可以在 /plugins/vmpayment/standard/standard.php（用于标准付款方式）或 /plugins/vmpayment/paypal/paypal.php 中进行编辑。在函数中找到`$html`变量`plgVmConfirmedOrder($cart, $order)`并在行后添加所需的代码`$html .= '</table>' . "\n";`（第 135 行）。在我的情况下，代码是：

```
$html .= '<script src="http://network.clickbanner.gr/i_sale_third/10566/'.$order['details']['BT']->order_subtotal.'/'.$order['details']['BT']->order_number.'
/OPTIONAL_INFORMATION&sale_status=P"></script><noscript><img src="http://network.clickbanner.gr/i_track_sale/10566/'.$order['details']['BT']->order_subtotal.'/'.$order['details']['BT']->order_number.'/OPTIONAL_INFORMATION&sale_status=P"></noscript>'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T04:31:43.313

你可以做到这一点，

```
First the order confirmation page of VM2.x is order_done.php 
the file you can find in the path : components/com_virtuemart/view/cart/tmpl/order_done.php 
```

第二件事。

VM中的订单存储在订单表中#__virtuemart_orders

```
with order id you can find all the amounts. with tax without tax etc.
(order_number,order_pass,order_total,order_subtotal,order_tax) 
```

# google-app-engine - 在 Google App Engine 数据存储中具有受限列表的模型

> ID：13260547
> 
> 赞同：1
> 
> 时间：2012-11-06T22:37:58.547
> 
> 标签：google-app-engine, nosql

在 Google App Engine 上，我有一个这样的 webapp2 模型：

```
def Person(db.model):
    first_name = db.StringProperty()
    surname = db.StringProperty()
    languages_spoken = db. ListProperty() 
```

但是，我希望将languages_spoken 列表限制为一个选项列表，比如英语、法语和西班牙语，这些选项会随着时间的推移而改变。使用 SQL，使用 person、language 和 person_language 表（或类似表）会很容易，但我不知道在这种情况下如何做，或者即使有可能。有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:55:43.197

如果您正在启动一个 appengine 项目，请使用新的 NDB 而不是数据存储区。您可以使用带有以下参数的属性：选择和验证器：[https ://developers.google.com/appengine/docs/python/ndb/properties](https://developers.google.com/appengine/docs/python/ndb/properties)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T07:37:25.560

通过使用 NDB，您可以获得以下内容：

```
def Person(ndb.model):
    first_name = db.StringProperty()
    surname = db.StringProperty()
    languages_spoken = db. ListProperty(choices=['English', 'French', 'Spanish']) 
```

有关它的更多信息，请查看[NDB Property Options](https://developers.google.com/appengine/docs/python/ndb/properties#options)。

但是，请注意，这些选项不能“即时”更改。当您的应用程序支持新选项时，您需要手动将其添加到模型中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T20:29:54.187

最后，由于其他两个答案的指示，我选择了这个：

```
from google.appengine.ext import ndb

languages = ['English', 'French', 'Spanish']

def Person(ndb.model):
    first_name = ndb.StringProperty()
    surname = ndb.StringProperty()
    languages_spoken = ndb.StringProperty(repeated=True, choices=languages) 
```

# javascript - Win 8 应用程序开发：本教程代码如何工作？

> ID：13260551
> 
> 赞同：0
> 
> 时间：2012-11-06T22:38:13.203
> 
> 标签：javascript

刚开始学习 Win 8 应用程序开发，我正在关注数据绑定的基本教程。

我试图理解的代码是：

```
<div id="basicBinding">
          Welcome,
          <span id="nameSpan" data-win-bind="innerText: name"></span>
</div>

<script type="text/javascript">
var person = { name: "Fran" };
var personDiv = document.getElementById("nameSpan");
WinJS.Binding.processAll(personDiv, person); 
```

我的理解如下，如果任何术语有误，我深表歉意。

脚本的第一行创建了一个名为“person”的变量，它是一个对象字面量，我们在其中存储了名称数据。

第二行创建变量“personalDiv”，该变量存储已绑定到 HTML 跨度元素“nameSpan”的数据。

脚本的第三行实际上处理了第一行和第二行，以便变量可用于其余代码。

我不明白的是 span 元素如何实际输出 Fran 的“名称”值。我不能完全弄清楚到底发生了什么让“data-win-bind”调用识别“person”变量并检索名称数据。'personDiv' 变量似乎在 nameSpan 甚至有一个值之前尝试从 'nameSpan' 中检索一个值（这显然是我只是错误地解释它，但我看不到正确的逻辑。

我敢肯定，鉴于它的初学者教程，我已经将它复杂化了一百万次，但任何帮助将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:39:58.340

`data-win-bind`只是一个普通的属性；它实际上并没有做任何事情。

当您调用 时`WinJS.Binding.processAll()`，它会查找具有该属性的所有元素并对其进行处理。

# java - xml 中的节点位置 - Java

> ID：13260552
> 
> 赞同：1
> 
> 时间：2012-11-06T22:38:36.503
> 
> 标签：java, xml

我想准备一个函数，它会给我节点在 xml 中的位置。
例如：

```
int NodePosition = doc.getDocumentElement().getChildNodes().item(t).getNodeName().Position() 
```

将来我想做一些这样的（当然这是例子）：

```
System.out.println(Node.row[NodePosition].tostring()); 
```

有可能做这样的事情吗？或者，也许您知道某些功能可以制作这样的东西。

例如，当我走得更深时，获得位置就会出现问题。因为`m = 7`

```
doc.getDocumentElement().getChildNodes().item(t).getChildNodes().item(m) 
```

当我尝试做这个（但我必须保存位置）：

```
System.out.println(doc.getDocumentElement().getChildNodes().item(7).getNodeName()); 
```

我收到错误

```
java.lang.NullPointerException 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T23:11:12.337

对我来说，您似乎在重新发明轮子-您正在尝试构建自己的 XPath 版本-请参阅：[http ://www.ibm.com/developerworks/library/x-javaxpathapi/index.html](http://www.ibm.com/developerworks/library/x-javaxpathapi/index.html)

[如何按索引选择 Xpath 节点集中的指定节点](https://stackoverflow.com/questions/3674569/how-to-select-specified-node-within-xpath-node-sets-by-index-with-selenium)

# javascript - 使用 xmlhttprequest 获取跨域 PNG 文件

> ID：13260555
> 
> 赞同：2
> 
> 时间：2012-11-06T22:38:51.270
> 
> 标签：javascript, image, xmlhttprequest, cross-domain

可悲的是，我看到无数类似的问题，但没有针对我的具体情况的答案。我没有使用 jquery。除了最新的浏览器（尤其是 Chrome），我什么都不关心。我正在寻找一种从 PNG 或 JPG 文件的跨域获取中加载 javascript 图像的方法。

即我只想这样做：

```
var img1 = new Image();
img1.addEventListener('load', function() { imageLoaded( canvas, context, this); }, false)
img1.src = textureUrl; 
```

这适用于同一个域。但是，显然这不会在请求标头中包含 Origin 标签，因此即使我们已经在服务器上成功设置了 CORS 标头，它也无法在跨域环境中工作。如果我可以对此请求执行一些简单的操作以包含该标头，那就太好了。

但我收集到我必须做的是使用 XHR 对资产进行异步获取，获取二进制数据，然后以某种方式将该数据推送到常规 Image() 对象中。我相信我们已经成功地获得了各种形式的数据（尝试了arraybuffer和blob），但没有成功将其干扰到Image()对象中。

例如：

```
var img3 = new Image();
var req = new window.XMLHttpRequest();
req.overrideMimeType('text/plain; charset=x-user-defined');  // seems to make no difference
req.responseType = 'arraybuffer';  // no joy with arraybuffer or blob
req.open("GET", textureUrl, true, "", "");  // async request allows CORS preflight exchange

req.onreadystatechange = function (oEvent) {
  if (req.readyState === 4) {
    if (req.status === 200) {
        alert( "XHR worked" );
        if( req.response ) {
          alert( "resp text: " + req.response );  // identifies response as arraybuffer or blob
        }

        // I believe this section is where I need the most help.

        // var base64Img = window.btoa(unescape(encodeURIComponent( req.responseText)) );

        var base64Img = window.btoa( unescape( encodeURIComponent( req.response ) ) );
        alert( "b64: " +  base64Img );  // vaguely uu64ish, but truncated
        var src = "";
        if( isPng == 1 ) {  // just to indicate the src url is built differently for jpg.
            alert("png");
            src = 'data:image/png;base64,' + base64Img;
        } 

        ....
        img3.src = src;  // img3 loads fine if I just jam a same domain url here

  <closing braces> 
```

从我读过的内容来看，如果我指定arraybuffer，我不清楚我是否需​​要覆盖mime类型，但我不清楚。

我取回了数据（没有跨域错误，是的），它的大小似乎是正确的，但我不相信我成功地对其进行了 uu64 编码，也不相信我正在将合适的数据 url 插入图像中。

同样，我只需要它来使用最新的 Chrome 浏览器，并且我希望尽可能“纯 HTML5”，所以我觉得不需要使用 IE7 等。

我不知道 req.response 是否包含 HTTP 响应的第一行（即我有责任在 uuencoding 之前修剪一些东西......）

希望你能把羊毛从我的眼睛里拉出来！

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-03T10:40:04.463

我在同一个问题上停留了一段时间。这是您需要执行的操作才能使其正常工作：

对于 zip/png 等格式，您应该使用：

```
req.responseType = 'arraybuffer'; 
```

棘手的事情是`arraybuffer`,`req.responseText`不起作用，而是使用`req.response`

```
var base64Img = window.btoa(
  unescape(
    encodeURIComponent(req.response)
  )
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-07T18:50:36.957

如果您对使用最新的 HTML 功能感到满意，以下内容可能会有所帮助。

使用 Fetch API 加载二进制文件：

```
const response = await fetch('https://cross-origin.org/path-to-binary.png' , {
  cache: 'no-cache',
  mode: 'cors',
  credentials: 'omit'
});

if (!response.ok) {
  console.error(response);
  throw new Error(response.statusText);
}

console.log('response from fetch', response);
const blob = await response.blob(); 
```

要将 Blob 转换为 base64，您可以使用 FileReader API

```
// Lang: Typescript
  private async convertBlobToBase64(blob: Blob): Promise<string> {
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onerror = reject;
      reader.onload = () => {
        resolve(reader.result as string);
      };
      reader.readAsDataURL(blob);
    });
  } 
```

# python - 从类方法创建新的类实例

> ID：13260557
> 
> 赞同：50
> 
> 时间：2012-11-06T22:38:53.350
> 
> 标签：python, object, copy

我希望能够通过在已经实例化的对象上调用方法来创建对象的新实例。例如，我有一个对象：

`organism = Organism()`

我希望能够调用`organism.reproduce()`并拥有两个有机体类型的对象。我此时的方法如下所示：

```
class Organism(object):
    def reproduce():
        organism = Organism() 
```

而且我很确定它不起作用（我什至不确定如何测试它。我在[这篇文章](https://stackoverflow.com/questions/328851/printing-all-instances-of-a-class)中尝试了 gc 方法）。那么如何让我的对象创建一个可访问的自身副本，就像我创建的第一个对象（使用`organism = Organism()`）一样？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-11-06T22:40:00.403

```
class Organism(object):
    def reproduce(self):
        #use self here to customize the new organism ...
        return Organism() 
```

另一种选择——如果实例 ( `self`) 未在方法中使用：

```
class Organism(object):
    @classmethod
    def reproduce(cls):
        return cls() 
```

这确保有机体产生更多有机体并且（从有机体派生的假设博格产生更多博格）。

不需要使用的另一个好处`self`是，除了可以从实例调用之外，现在还可以直接从类调用它：

```
new_organism0 = Organism.reproduce()  # Creates a new organism
new_organism1 = new_organism0.reproduce()  # Also creates a new organism 
```

* * *

最后，如果在方法中同时使用了实例 ( `self`) 和类（`Organism`或从子类调用的子类）：

```
class Organism(object):
    def reproduce(self):
        #use self here to customize the new organism ...
        return self.__class__()  # same as cls = type(self); return cls() 
```

* * *

在每种情况下，您都可以将其用作：

```
organism = Organism()
new_organism = organism.reproduce() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T22:44:31.177

为什么不简单地使用复制模块？

```
import copy
organism = Organism()
replica = copy.deepcopy(organism) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-06T23:34:29.393

像这样的东西怎么样：

```
class Organism(object):

    population = []

    def __init__(self, name):
        self.name = name
        self.population.append(self)
    def have_one_child(self, name):
        return Organism(name)
    def reproduce(self, names):
        return [self.have_one_child(name) for name in names] 
```

结果：

```
>>> a = Organism('a')
>>> len(Organism.population)
1
>>> a.reproduce(['x', 'y', 'z']) # when one organism reproduces, children are added
                                 # to the total population
                                 # organism produces as many children as you state
[<__main__.Organism object at 0x05F23190>, <__main__.Organism object at 0x05F230F0>, <__main__.Organism object at 0x05F23230>]
>>> for ele in Organism.population:
...     print ele.name
... 
a
x
y
z
>>> Organism.population[3].reproduce(['f', 'g'])
[<__main__.Organism object at 0x05F231D0>, <__main__.Organism object at 0x05F23290>]
>>> for ele in Organism.population:
...     print ele.name
... 
a
x
y
z
f
g 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T22:51:29.147

和你最初做的一样，但是你必须用它做点什么！

`organism = Organism()`调用类`Organism`（名称后面的括号是“调用”操作）。这将创建并返回该类的新实例，然后将其绑定到 name `organism`。

当您在解释器中执行该行时，您现在有一个`organism`引用您刚刚创建的新`Organism`实例的变量。

当您在函数内部编写该行时（包括方法，因为方法和“从内部”的函数之间没有区别），它做同样的事情，但变量`organism`是*局部*变量。当函数完成时，局部变量会被丢弃，所以这*确实会*创建一个新`Organism`实例，但它不会实现任何目标，因为您永远无法访问它。

您的函数应该*返回*它想要传达给调用者的任何信息。任何你不返回的局部变量只有在你使用这些变量来创建你*确实*返回的东西时才有用。

请注意，这与您在方法中创建实例的特定问题*无关；*这就是函数/方法的一般工作方式。在使用类和实例成功编写面向对象的程序之前，您需要了解函数是如何工作的；我强烈建议您完成一些教程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-13T09:48:36.397

我相信您在问如何复制对象。令人惊讶的是（也许），（几乎）没有标准的方法，这是设计使然。问题来自复制概念的内在模糊性，即：当您复制对象属性时，您的意思是将其复制为引用（复制）还是作为值（深度复制）？

但是，在大多数情况下，您需要一致的行为（所有属性的深拷贝或复制），在这种情况下，您可以将`copy`模块用作

```
import copy
new_obj = copy.copy(old_obj) 
```

或者

```
new_obj = copy.deepcopy(old_obj) 
```

在您想要更自定义的行为的一般情况下，您使用相同的命令，但覆盖对象的`__copy__`和`__deepcopy__`方法。

有关详细信息和示例，请参阅更多答案，例如： [How to override the copy/deepcopy operations for a Python object？](https://stackoverflow.com/questions/1500718/how-to-override-the-copy-deepcopy-operations-for-a-python-object)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-06T22:45:47.193

```
from copy import copy                                                           

class Organism(object):                                                         

    def __init__(self,name):                                                    
        self.name=name                                                          

    def setName(self,name):                                                     
        self.name=name                                                          

    def reproduce(self,childname):     
        #use deepcopy if necessary                                         
        cp = copy(self)                                                         
        cp.setName("descendant from " + self.name + " " + childname)            
        return cp                                                               

    def __str__(self):                                                          
        return self.name                                                        

first = Organism("first")                                                       
second = first.reproduce("second")                                              

print first                                                                     
print second 
```

# android - Android - 类 Html - fromHtml - 它是如何工作的？

> ID：13260558
> 
> 赞同：2
> 
> 时间：2012-11-06T22:38:56.800
> 
> 标签：android, html, xml, class, parsing

我正在使用 Html.fromHtml 来获取描述标签的内容（在提要 XML 中），它工作正常

说明标签：

```
<description><![CDATA[<div class="K2FeedIntroText"><p><img style="margin: 10px; float: left;" alt="block curta" src="http://loc.grupolusofona.pt/images/stories/destaques/block%20curta.jpg" height="110" width="120" />Quatro Horas Descalço é o nome da curta-metragem, realizada por Ico Costa, que se estreia mundialmente no 7.º Festival Internacional de Cinema de Roma, nos dias 12 e 13 de novembro, em competição no Cinema XXI.</p> 
```

]]>

但是当我查看[文档](http://developer.android.com/reference/android/text/Html.html "文件")时，它说：

`Returns displayable styled text from the provided HTML string. Any <img> tags in the HTML will display as a generic replacement image which your program can then go through and replace with real images.`

所以我的问题是：我怎样才能做到那里所说的“你的程序可以通过它并用真实图像替换”？

我知道如何使用模式通过 RegEx 获取 img url，我只是想知道如何使用该类“通过并用图像替换它”

如果我不清楚并且生病尝试更好地解释它，请说些什么。

**编辑：**

好吧，我正在尝试在一个简单的 rss 阅读器中实现这一点（并尝试在代码方面使其尽可能简单）

我正在使用 DOM Parser 并且我正在使用 a`map = HashMap<String, Spanned>`来存储每个子节点的值，以及`KEY`：

`map.put(KEY_DESC, Html.fromHtml(parser.getValue(e, KEY_DESC)));`

在答案的评论中，我发现了一个有用的[链接](https://stackoverflow.com/a/7442725/1779071)，我从中创建了一个新类（URLImageParser）并尝试像这样使用它：

`map.put(KEY_DESC, htmlSpan);`

结果在哪里`htmlSpan`：

```
this.textView = (TextView)this.findViewById(R.id.textview);
URLImageParser p = new URLImageParser(textView, this);
Spanned htmlSpan = Html.fromHtml(html, p, null);
textView.setText(htmlSpan); 
```

我还创建了一个`android:visibility="gone"`TextView 以防它需要将值存储在 TextView 中（也许我解释错了）

我最初的想法是那种`htmlSpan`类型`Spanned`，所以它适合我的 HashMap 就好了。

对于上传到 ListView 我使用的`SimpleAdapter`是这样的：

```
 ListAdapter adapter = new SimpleAdapter(this, menuItems, R.layout.linhafeed, 
            new String[] { KEY_TITLE, KEY_DESC, KEY_PUBDATE, KEY_LINK },
            new int[] { R.id.title, R.id.desc, R.id.pub, R.id.link }); 
```

`menuItems`在哪里`ArrayList<HashMap<String,Spanned>>`

我这里有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T01:18:00.270

`Html.fromHtml(...)`将用一个特殊[的“对象替换字符”(\uFFFC)](http://www.fileformat.info/info/unicode/char/fffc/index.htm)替换任何`<img ... />`标记。`ImageSpan`

要显示实际图像，看起来有两个选项：

*   实现[`ImageGetter`](http://developer.android.com/reference/android/text/Html.ImageGetter.html)返回图像以显示为`Drawable`. 如果我没记错的话，这将不允许您将图像加载卸载到不同的线程，因为它希望立即返回结果。因此，这应该足以满足本地资源（可能还有设备本地存储中的任何资产，前提是不需要潜在的长时间运行的操作；即缩放、裁剪、应用效果等）。
*   对`Spanned`结果进行第二次传递并替换任何`\uFFFC`出现的地方。您应该能够`ImageSpan`使用该`getSource()`方法从每次获取图像的源（url）。不幸的是，它看起来没有任何设置器来更新`Drawable`一旦加载，所以我猜你可能需要`ImageSpan`用一个新的替换，在构造函数中传递加载的图像。

第三种选择，可能比上面更重一些，是使用 a`WebView`而不是 a `TextView`。这样您就不必自己处理任何加载的图像，因为它内置在小部件中。

# macos - OpenCV - 地球移动器的距离问题，ic vInitEMD()

> ID：13260559
> 
> 赞同：2
> 
> 时间：2012-11-06T22:38:59.563
> 
> 标签：macos, algorithm, opencv

我`EMD()`在 Mac OS ML 下调用 OpenCV 2.4.2 时遇到问题。

我有一个类，其属性`Mat _signature`定义如下：

```
Mat _signature(size,dim+1,CV_32F);
for (int i = 0; i<size; ++i){
    _signature.at<float>(i,0) = weight;
    for (int j = 1; j < dim+1; ++j){
       _signature.at<float>(i,j) = vec[i].at<float>(0,j-1); // vec[i] is a line vector containing the position in R^dim
    }
} 
```

然后我有那个类`u`的`v`2 个实例，当我打电话时`EMD(u._signature, v._signature, CV_DIST_L2);`

它失败了`OpenCV Error: One of arguments' values is out of range () in icvInitEMD, file /*SOME PATH*/OpenCV-2.4.2/modules/imgproc/src/emd.cpp, line 408`

我查看了源代码，但无法弄清楚这是什么失败。我的论点与文档的要求相对应。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T20:31:08.827

好的，我花了很长时间才弄清楚，但在我的数据中，我的一个向量的一个分量被错误计算，最终成为`NaN`. 当然，这已深埋在我的数据中，因此它会完全丢失在通过调试器（甚至`cout`）可合理观察到的任何数量的数据中

来自 OpenCV 的神秘错误让我感到困惑。

对于那些和我一样遇到同样问题的人：

*   确保您的权重向量不为零
*   确保没有您的数据`NaN`

# ruby-on-rails - 使用轮胎映射 ElasticSearch 中的 geo_point 字段

> ID：13260560
> 
> 赞同：1
> 
> 时间：2012-11-06T22:39:00.203
> 
> 标签：ruby-on-rails, geolocation, elasticsearch, tire

我正在尝试使用 Tire gem 索引 Elasticsearch 中的 geo_point 字段。这是我的 ActiveRecord 模型的轮胎映射：

```
class Availability < ActiveRecord::Base
  belongs_to :user
  attr_accessible :date, :latitude, :longitude

  include Tire::Model::Search
  include Tire::Model::Callbacks

  tire do
    mapping do
      indexes :id,                  type: 'integer',  index: 'not_analysed'
      indexes :user_id,                 type: 'integer',  index: 'not_analysed'
      indexes :user_firstname,      type: 'string',   as: 'user_firstname' 
      indexes :user_lastname,       type: 'string',   as: 'user_lastname' 
      indexes :user_level,          type: 'integer',  as: 'user_level' 
      indexes :date,                type: 'date'
      indexes :location,            type: 'geo_type', as: 'location'
    end
  end

  # def location
  #   "#{latitude},#{longitude}"
  # end

  def location
    [longitude.to_f, latitude.to_f]
  end

  def user_firstname
    user.firstname
  end

  def user_lastname
    user.lastname
  end

  def user_level
    user.level
  end
end 
```

当我创建映射 ( `bundle exec rake environment tire:import CLASS=Availability FORCE=true`) 时，Elasticsearch 似乎忽略了该字段的`geo_point`类型。`location`

这是`http://localhost:9200/availabilities/_mapping`调用的结果：

```
{
  availabilities: {
    availability: {
      properties: {
        date: {...},
        id: {...},
        location: {
          type: "double"
        },
        user_firstname: {...},
        user_id: {...},
        user_lastname: {...},
        user_level: {...}
      }
    }
  }
} 
```

location 字段被索引为文档上的 double 数组（结果`http://localhost:9200/availabilities/_search`）：

```
{
  id: 8,
  ...
  location: [
    2.301643,
    48.780651
  ]
} 
```

当我将`location`方法更改为：

```
 def location
    "#{latitude},#{longitude}"
  end 
```

`geo_point`这是根据文档（http://www.elasticsearch.org/guide/reference/mapping/geo-point-type.html）索引字段的另一种解决方案，位置映射的结果是：

```
 location: {
    type: "string"
  }, 
```

当然，位置字段被索引为字符串：

```
{
  id: 4,
  ...
  location: "48.780651,2.301643"
} 
```

知道为什么`geo_point`在我的映射中忽略了？

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-04T15:17:29.110

`location`索引类型输入错误。

您使用`geo_type`而不是`geo_point`：

```
indexes :location, type: 'geo_point', as: 'location' 
```

# expressionengine - 当我通过 Safecracker 发帖时，为什么我的字体和颜色会从 Wygwam 中删除？

> ID：13260563
> 
> 赞同：3
> 
> 时间：2012-11-06T22:39:44.500
> 
> 标签：expressionengine, safecracker

我遇到了 Wygwam 和 Safecracker 的问题。当我为一个字段扩展 Wygwam 配置（例如添加字体颜色），然后在 Safecracker 中的我的字段上使用该选项时，HTML 似乎像这样被剥离：

而不是这个：

```
<p>
<span style="color:#ff0000;"><span style="font-size:16px;"><span style="font-family:georgia,serif;">Why aren&#39;t you saving???</span></span></span></p> 
```

我得到这个（提交后）：

```
<p>
<span><span>&lt;span new,courier,monospace;&quot;=&quot;&quot;&gt;Why aren&#39;t you saving???</span></span></p> 
```

我确定这是由于 Safecracker 中的 XSS 过滤造成的，有什么好的解决方案可以解决这个问题吗？我正在使用 Wygwam 的 2.6.3 和 EE 2.5.3 (Safecracker 2.1)。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-07T01:54:31.947

阿德里安所说的一切都是正确的。但是，如果您不允许访客通过此表单发帖，并且它仅适用于经过批准的注册用户，则 XSS 威胁会得到缓解。事实上，当您在 CP 中提交条目时，字段不会传递给 XSS 过滤器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T23:17:11.267

看看第 1281 行`system/expressionengine/modules/safecracker/libraries/safecracker_lib.php`，你会看到：

```
//@TODO what to do about xss_clean and "naughty" html
//for now you can crack open this file and manually add fields_ids and/or field types to the respective arrays
//to prevent xss_clean
//i had some people complain about not being able to submit <object>'s
$xss_clean = ( ! in_array($field['field_id'], $this->skip_xss_field_ids) && ! in_array($field['field_type'], $this->skip_xss_fieldtypes)); 
```

该数组似乎专门用于帮助您解决问题（希望跳过安全破解器字段上的 XSS 过滤）。

该数组在同一文件的第 2612 行附近初始化：

```
$this->skip_xss_field_ids = array(); 
```

因此，您应该能够简单地将字段 ID 添加到此数组中，以跳过 XSS 过滤，如下所示：

```
$this->skip_xss_field_ids = array(37, 81); 
```

请记住，这是一个非常**糟糕的想法**。此时，用户现在可以将任意 javascript 添加到他们的 wygwam 字段，并且您已经有效地将您的网站打开到[XSS 攻击](http://en.wikipedia.org/wiki/Cross-site_scripting)（恶意用户可以劫持其他用户的会话并为所欲为）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T11:15:51.910

如果您将“removeFormatAttributes”设置应用于您的 Wygwam 配置，它将删除样式属性（以及其他属性）。

转到附加组件 -> 模块 -> Wygwam，然后单击您用于相关字段的配置集。从那里您可以选择各种设置来影响该设置的工作方式。

# jquery - 使用带有 ASP.NET MVC 3 的 Uploadify 和 JQuery 时如何发布上传文件的文件媒体类型

> ID：13260567
> 
> 赞同：0
> 
> 时间：2012-11-06T22:40:18.287
> 
> 标签：jquery, asp.net-mvc-3, uploadify

我在 ASP.NET MVC 3 Web 应用程序中使用 uploadify 将文件保存到 sql server 2008。我需要获取用户上传的文件的互联网媒体类型，例如应用程序/msword、应用程序/pdf 等，并将其与其他一些信息一起发布到控制器操作。如果不是媒体类型，至少是文件扩展名。

这是一些代码

查看 - javascript 部分

```
$('#flyer').uploadify({
            'uploader': '/Flash/uploadify.swf',
            'script': '/File/Upload',
            'cancelImg': '/Content/images/cancel.png',
            'buttonText': 'Select File',
            'folder': '/Uploads',
            'auto': true,
            'sizeLimit': 10485760,
            'scriptData': { 'UserID': @Model.UserID, 'Type': 'Flyer' },
            'fileExt': '*.doc;*.docx;*.rtf;*.pdf',
            'fileDesc': 'Word Documents',
            'onComplete': function(event, ID, fileObj, response, data) {
                var resp = jQuery.parseJSON( response );
                if( !resp.success ){
                    alert( resp.message );
                } else {
                    $("#flyerLink").show();
                }
            }
        }); 
```

控制器动作方法头

```
[HttpPost]
public JsonResult Upload(HttpPostedFileBase FileData, int UserID, string Type) 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:43:46.727

`HttpPostedFileBase``ContentType`通过属性包括 mime 类型：

[MSDN - HttpPostedFileBase.ContentType](http://msdn.microsoft.com/en-us/library/system.web.httppostedfilebase.contenttype.aspx)

# shell - 为什么我的应用程序的性能不能随着 CPU 的增加而扩展？

> ID：13260574
> 
> 赞同：2
> 
> 时间：2012-11-06T22:40:50.520
> 
> 标签：shell, parallel-processing, multiprocessing

我正在运行一个非常并行的软件。我需要运行大约 400 个完全不相互依赖的命令，所以我只是将它们分叉出来，并希望拥有更多的 CPU 意味着每单位时间执行更多的进程。

代码：

```
foreach cmd ($CMD_LIST)
    $cmd &    #fork it off
end 
```

很简单。这是我的测试结果：

在 1 个 CPU 上，这需要 1006 秒，即 16 分 46 秒。

使用 10 个 CPU，这需要 600 秒或 10 分钟！

为什么不将花费的时间（大约）除以 10？感觉这里被骗了=（

编辑 - 当然，我愿意提供您想知道的其他详细信息，只是不确定什么是相关的，因为用最简单的术语来说，这就是我正在做的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T22:49:29.013

您假设您的进程是 100% 受 CPU 限制的。

如果您的进程执行任何磁盘或网络 I/O，瓶颈将出现在那些无法并行化的操作上（例如，一个进程将以 100k/s 的速度下载文件，2 个进程以 50k/s 的速度下载文件，因此您不会看到任何根本没有改进，此外，由于开销，您可能会遇到性能下降）。

请参阅：[Amdahl's_law](http://en.wikipedia.org/wiki/Amdahl%27s_law) - 这允许您估计并行化任务时的性能改进，知道可并行部分和不可并行部分之间的比例）

# grails - 如何在 createCriteria 中修剪属性

> ID：13260577
> 
> 赞同：1
> 
> 时间：2012-11-06T22:41:06.527
> 
> 标签：grails, grails-orm, projection, createcriteria

我正在尝试修剪投影属性，但它不允许我这样做。

```
def c = Book.createCriteria()
def books = c.list { 
    projections {
        property ("title")
    }
    def now = new Date()
    between('publishingDate', now-45, now+15)
} 
```

我想修剪标准中的“标题”字段，但它不起作用。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:51:59.407

这将在 grails 2.2 中使用`sqlProjection`：

```
projections {
    sqlProjection 'trim(title) as title', ['title'], [java.sql.Types.VARCHAR]
} 
```

# jquery - jQuery检查div内的图像是真还是假

> ID：13260579
> 
> 赞同：0
> 
> 时间：2012-11-06T22:41:09.703
> 
> 标签：jquery

**我的 HTML**

```
<div class="block_right_2 relative">
  <div class="block_right_2_content">
    <div align="center"> <a href="#"> <img src="/images/imageName1.png" > </a> </div>
  </div>
  <div class="block_right_2_btn_link_left">
    <p><a href="/article/newsflash.html">Find out more </a></p>
  </div>
</div> 
```

**我的问题**

此 imageName1.png 是我网站上的随机图像，每次刷新页面时都会更改。其他图像名称是`imageName2.png`等`imageName3.png`。我想要做的是，使用 jquery 检查`if image = imageName2.png`然后将链接更改`Find out more`为`More info here`. 谢谢。

我不确定如何使用`.replace`或更合适的方法检查这个。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:45:25.040

这应该这样做

```
$('img[src$="imageName1.png"]').closest('.block_right_2_content')
                                .next().find('a').text('More info here'); 
```

使用`Attribute Ends with`选择器

[http://api.jquery.com/attribute-ends-with-selector/](http://api.jquery.com/attribute-ends-with-selector/)

演示：http: [//jsfiddle.net/GudSq/1](http://jsfiddle.net/GudSq/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:44:38.973

如果我理解正确，那么下面应该可以解决问题。

```
if ($('.block_right_2_content').find('img')[0].src.indexOf('imageName2.png') >= 0) {
   $('.block_right_2_btn_link_left').find('a').text('More Info here');
} 
```

# erlang - 其他模块的功能未检测到

> ID：13260580
> 
> 赞同：1
> 
> 时间：2012-11-06T22:41:14.430
> 
> 标签：erlang, intellisense

我在同一个 src 文件夹中的两个模块。mod1 声明了我希望在模块 mod2 中使用的函数：

```
-module(mod1).
-export([myfunc/1]).

myfunc(A) -> {ok}. 
```

在其他模块中，我不导入 mod1：

```
-module(mod2). 
```

如果我`mod1:`在 mod2 中执行“”，它会识别“myfunc”，问题是在运行时当我调用`mod1:myfunc(A)`我得到“未定义的函数 mod1:myfunc/1”

如果智能感知在 mod2 中检测到我的 mod1 函数，我不明白为什么会出错？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:43:24.833

在 shell 中，您可以尝试`mod1:module_info(exports)`查看所有导出函数的列表，但如果您的模块按照上面的方式编写，它应该会产生语法错误。

但是，如果我错了，并且您确实在模块中正确编写了它（即，这里只是一个错字），请尝试在 erlang shell 中执行以下操作：

```
c(mod1).
c(mod2). 
```

看看这是否适合你。这将为您编译和加载模块。如果您没有编译模块（即，它只是目录中的一个 .erl 文件），那是不够的。

**编辑**

另外，请确保在 erlang 启动时正确加载了梁文件。这通常是通过启动 erl 来完成的`erl -pa /path/to/beams`

# c++ - c++ std::enable_if

> ID：13260581
> 
> 赞同：3
> 
> 时间：2012-11-06T22:41:16.683
> 
> 标签：c++, c++11

我对 std::enable_if 很陌生，想知道如何使用它。我有一个模板类：

```
template<int a, int b>
class foo {
} 
```

现在我只想在 a + b 等于 10 时实例化它。我可以使用 std::enable_if 来实现吗？

第二个问题：如果我有 foo 类的成员

```
template<int a, int b>
class foo {
  int c;
} 
```

我只想有 c 当

```
a = 5\. 
```

如何使用 std::enable_if 做到这一点？这是使用 std::enable_if 的正确案例吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-06T22:44:36.783

```
template<int a, int b, typename T = typename std::enable_if<a + b == 10>::type>
class foo {
}; 
```

这应该可以完成工作；只需确保在实例化模板时从不明确提供第三个模板参数。

* * *

正如其他人提到的，`static_assert`是一个更好的选择。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-06T22:45:32.943

我想您可以更好地使用 static_assert 来执行该约束而不是 enable_if

```
template<int a, int b>
class foo {
    static_assert(a+b==10, "a+b is not 10");
};

int main()
{
    foo<5,5> f; // will compile
    foo<1,5> f; // will fail to compile with error: a+b is not 10
    return 0;
} 
```

enable_if 主要用于根据类型特征有条件地从重载决议中删除函数和类，并为不同的类型特征提供单独的函数重载和特化。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-11-15T12:47:03.567

## 使用 C++20

您只需添加*`requires`*到模板即可实现：

```
template<int a, int b> requires (a + b == 10)
struct foo {
    int c;
};

int main() {
    foo<3, 7> ok;
    // foo<3, 8> doesnt_compile;
} 
```

如果 requires 子句为真，则该*`requires`*子句得到`constant expression`评估`true`或`false`决定是否将其视为适当匹配，否则忽略它。

代码：[https ://godbolt.org/z/yHh4Et](https://godbolt.org/z/yHh4Et)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-18T15:19:26.653

简单，不要用`enable_if`

```
template<bool Ten>
struct Base
{
    int c;
};

template<>
struct Base<false>
{ };

template<int a, int b>
struct foo : Base<a+b == 10>
{
}; 
```

# php - 动态传递 PHP 变量

> ID：13260584
> 
> 赞同：0
> 
> 时间：2012-11-06T22:41:38.827
> 
> 标签：php, javascript, forms, dynamic

我正在尝试完成一个 JavaScript 表单，该表单将在填写文本框后从外部网站上的 PHP 请求加载结果。

现在，我有

```
 <script type="text/javascript"/>
function sendrequest() {
document.location="myphpsite.com/submit.php?tb="+document.getElementById("tb").value;
}
</script>
<form>
<input type="text" id="tb" onChange="sendrequest()" />
</form> 
```

此代码无处可去，因为据我目前所知，您只能在启动时加载 PHP 变量，方法是使用“script src=...”，并让 php 页面返回一些 javascript 代码。

我正在寻找的是一种动态请求/接收 php 变量的方法，它可以像这样工作：

```
 <script type="text/javascript">
function getdata() {
return document.get("myphpsite.com/submit.php?tb=hi");
}
</script> 
```

换句话说，是否有动态“读取”网站并返回原始文本的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:45:58.850

[http://w3schools.com/ajax/default.asp](http://w3schools.com/ajax/default.asp)

你应该去读这个然后再读一遍，AJAX就是你需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:52:24.927

PHP 和 AJAX 的最佳示例 -

[http://www.w3schools.com/php/php_ajax_database.asp](http://www.w3schools.com/php/php_ajax_database.asp)

# jar - jar 中的 NoClassDefFoundError LocalSessionFactoryBuilder

> ID：13260585
> 
> 赞同：0
> 
> 时间：2012-11-06T22:41:39.897
> 
> 标签：jar, war, noclassdeffounderror, web-inf

我是 Web 应用程序开发的新手，需要您的帮助。我在 Weblogic 10.3 上使用 Spring3.1.2/Hibernate 4.1。我部署了战争文件，但在下面的运行时得到了 NoClassDefFoundError。

它抱怨 LocalSessionFactoryBuilder。但是，如果您看到堆栈跟踪的第一行，则调用是从 org.springframework.orm.hibernate4.LocalSessionFactoryBean.afterPropertiesSet() 发出的。LocalSessionFactoryBuilder 和 LocalSessionFactoryBean 在同一个包中，我可以在 WEB-INF/lib 的 org.springframework.orm-3.1.2.RELEASE.jar 中看到这两个类。有什么线索吗？

```
Caused By: java.lang.NoClassDefFoundError: org/springframework/orm/hibernate4/LocalSessionFactoryBuilder
        at org.springframework.orm.hibernate4.LocalSessionFactoryBean.afterPropertiesSet(LocalSessionFactoryBean.java:277)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
        at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
        at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:591)
        at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)
        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:469)
        at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:139)
        at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:83) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T15:19:03.627

我用另一种方式解决了这个问题。我已将所有 jars 放在 $DOMAIN/servers/$MYSERVER/lib 目录中，并将它们添加到 setEnvsstserver 的类路径中。不知道为什么 WEB-INF/lib 中的 jars 没有被拾取。

# javascript - 如何在javascript中对图像进行base64编码

> ID：13260588
> 
> 赞同：6
> 
> 时间：2012-11-06T22:41:54.660
> 
> 标签：javascript, android, image, cordova, base64

我正在开发一个 phonegap 应用程序并使用该`navigator.getPicture`方法获取图像。

我得到图片的方式是：

```
navigator.camera.getPicture(onSuccess, onFail, { quality: 50, 
destinationType: Camera.DestinationType.FILE_URI });

function onSuccess(imageURI) {
    var image = document.getElementById('myImage');
    image.src = imageURI;
} 
```

就像 phonegap 文档中的示例一样。

我希望能够使用 imageURI，然后将其转换为图像数据以便稍后上传。（我不想使用phonegap的FileTransfer）

到目前为止，我已经尝试过[在 JavaScript 中获取图像数据？](https://stackoverflow.com/questions/934012/get-image-data-in-javascript)以及[如何在 JavaScript 中将字符串编码为 Base64？](https://stackoverflow.com/questions/246801/how-can-you-encode-to-base64-using-javascript)

当我尝试以下操作时，

```
function onSuccess(imageURI) {
    getBase64Image(imageURI);
}

function getBase64Image(img) {
    // Create an empty canvas element
    var canvas = document.createElement("canvas");
    canvas.width = img.width;
    canvas.height = img.height;

    // Copy the image contents to the canvas
    var ctx = canvas.getContext("2d");
   ctx.drawImage(img, 0, 0);

   // Get the data-URL formatted image
   // Firefox supports PNG and JPEG. You could check img.src to
   // guess the original format, but be aware the using "image/jpg"
   // will re-encode the image.
   var dataURL = canvas.toDataURL("image/png");

   console.log(dataURL); //here is where I get 'data:,'       

   return dataURL.replace(/^data:image\/(png|jpg);base64,/, "");
} 
```

`dataURL`并在返回前打印。我只是得到`data:,`内容。

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:35:12.730

好吧，您可以尝试将其作为 DATA_URL 获取。您的里程可能会有所不同，因为当图像转换为 Base64 字符串时，您可能会遇到内存不足错误。

```
navigator.camera.getPicture(onSuccess, onFail, { quality: 50, 
    destinationType: Camera.DestinationType.DATA_URL });

function onSuccess(imageURI) {
    var image = document.getElementById('myImage');
    image.src = imageURI;
} 
```

或者，您可以使用[FileReader.readAsDataURL()](http://docs.phonegap.com/en/2.2.0/cordova_file_file.md.html#FileReader_read_as_data_url)。

canvas.toDataURL 方法未在早期版本的 Android 上实现。

# python - 如何使用 Python 在 4 个线程上执行 3 个函数？

> ID：13260589
> 
> 赞同：1
> 
> 时间：2012-11-06T22:42:08.507
> 
> 标签：python, multithreading, python-multithreading

我有 3 个函数，并希望使用 Python 在新线程上执行每个函数

每个函数只是一个数学运算。

我需要在流程的每个核心中启动每个功能。在Java中它看起来像：

```
Thread threadF1 = new Thread(f1);
Thread threadF2 = new Thread(f2);
Thread threadF3 = new Thread (f3);

threadF1.start();
threadF2.start();
threadF3.start(); 
```

如果我有 4 个内核，我的程序会使用 75% 的 CPU。

我用 Python 写了这个：

```
 thread = Thread(target = F1, args=(N,))
 thread.start()

 thread2 = Thread(target = F2, args=(N,))
 thread2.start()

 thread3 = Thread(target = F3, args=(N,))
 thread3.start() 
```

但它只使用了 25%。如何使用 3/4 核强制 Python 中的工作代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:51:25.300

我不太了解python，但请尝试`thread.start_new_thread(F1, (N))`您的每个功能。

这是我在该方法上找到的一些文档：[thread.start_new_thread](http://docs.python.org/2/library/thread.html#thread.start_new_thread)

* * *

编辑：

原来在python 3中`thread`被重命名：`_thread`

```
import _thread
_thread.start_new_thread(F1, (N,)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:40:56.097

在 CPython 中，很难通过线程来实现并行。这与[Global Interpreter Lock](http://en.wikipedia.org/wiki/Global_Interpreter_Lock)有关。

解决此问题的一种方法是使用该[`multiprocessing`](http://docs.python.org/2/library/multiprocessing.html)模块。

# java - 在 XSLT 和 Java 类之间共享 XPath

> ID：13260590
> 
> 赞同：0
> 
> 时间：2012-11-06T22:42:10.637
> 
> 标签：java, xml, xslt, xpath

是否有在 XSLT（即网页、HTML 报告等）和 Java 类（即 Xml 节点对象等）之间共享 XPath 的通用解决方案？例如，某个类型的独立 XML 配置文件包含所有 XPath，然后 XSLT 样式表和 Java 类都可以出于各种目的读取这些文件？

当我从更改中解析数据的 XML 数据的模式（模式是许多经常更改的组织使用的标准化模式）时，这会很方便 - 然后我可以对这个单一的事实来源进行更改并拥有它更新模式时反映在 XSLT 和 Java 类中。

我想我在 XSLT 方面的有限经验正在这里展示。一个更好的问题可能是：您能否读入外部文件（如果可以，哪些类型？）并将这些外部文件中的值作为 XSLT 中的变量赋值？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T09:54:20.777

许多 XSLT 处理器都有一个 xx:evaluate() 扩展，可用于从文件中读取 XPath 表达式并执行它们。如果 XPath 表达式封装了与样式表本身分开维护的业务规则（例如，价格折扣的计算），那么它可能是一种有用的技术。

另一种技术是将 XPath 表达式封装在函数库（可以是 Java，也可以是 XQuery）中，以便可以从 Java 或 XSLT 调用函数。细节取决于您使用的实际技术。

# java - Android：无法正确创建共享 kml(xml) 文件的意图

> ID：13260592
> 
> 赞同：2
> 
> 时间：2012-11-06T22:42:26.307
> 
> 标签：java, android, android-intent

我的应用程序生成 kml (xml) 文件，我希望用户能够通过电子邮件、蓝牙或其他方式共享这些文件。我已经看过几十个例子，但显然我仍然做错了什么。如果我选择 Gmail，电子邮件会正确加载，但文件未附加。如果我选择蓝牙，蓝牙管理器会崩溃。我在这里做错了什么？

```
private void createShareIntent(String filename) {
    Log.d(Common.APP_TAG, "** Create share intent **");
  String mime = "text/plain";
    File exportFile = new File(filename);
    Log.d(Common.APP_TAG, Uri.fromFile(exportFile).toString());
    // logcat says : file:///mnt/sdcard/Android/data/com.gmail.qkzoo1978.qwhereami/files/exports/qExport_11-6-2012_1648.kml
    Intent intent = new Intent();
    intent.putExtra(Intent.EXTRA_EMAIL, new String[] {"testing@gmail.com"});
    intent.putExtra(Intent.EXTRA_SUBJECT, "Test");
    intent.putExtra(Intent.EXTRA_TEXT, "Text");
    intent.setType(mime);
    intent.putExtra(Intent.EXTRA_STREAM, Uri.fromFile(exportFile));
    //intent.setDataAndType(Uri.fromFile(exportFile),  mime);
    startActivity(Intent.createChooser(intent, "Share Kml"));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-01T20:09:04.597

不确定你是否解决了这个问题，但我这个周末遇到了同样的问题，并意识到这是因为我正在保存我的应用程序可以访问但其他应用程序没有的文件。因此，当用于处理共享的应用程序尝试读取文件时，权限被拒绝。奇怪的是，这在日志中并不清楚。

解决此问题的方法是将文件保存到外部存储中，这可能并不理想。

或者作为更好的解决方案，使用文件提供程序并在意图中授予权限。

# android - Bitmap.copy 在 createScaledBitmap 工作的地方失败

> ID：13260593
> 
> 赞同：3
> 
> 时间：2012-11-06T22:42:29.110
> 
> 标签：android, bitmap, crash, copy

我遇到了 Bitmap.copy 函数的问题。此代码工作正常，

```
Bitmap tempBM = Bitmap.createScaledBitmap(sourceBitmap, sourceBitmap.getWidth(), sourceBitmap.getHeight(), false);

//Ensure that the bitmap is mutable and not copied from the original in the case where no scaling is required
m_bwBitmap = tempBM.copy(tempBM.getConfig(), true);
if (tempBM!=sourceBitmap)
{
    tempBM.recycle();
} 
```

但这并不...

```
m_bwBitmap = sourceBitmap.copy(sourceBitmap.getConfig(), true); 
```

sourceBitmap 一开始是不可变的，我希望 m_bwBitmap 是可变的。

它不会像这样崩溃，但它确实会破坏调试器，就好像某个地方的 android 函数出现问题一样。该应用程序随后会崩溃。如果我用顶级代码替换它，一切正常。

但是，我现在开始从 JellyBean 获取崩溃报告，在带有 tempBM.copy 的行上抛出一个空指针异常。所以，我必须解决这个问题，但目前最上面的代码是唯一可以工作的来源。我正在 Android 4.0 设备上对其进行测试。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:11:38.290

好的，我想我已经回答了这个问题（至少在一半）。

这与 Bitmap.Config 有关。如果我将线路更改为

```
m_bwBitmap = sourceBitmap.copy(Bitmap.Config.ARGB_8888, true); 
```

然后它工作正常。

请注意，原始源位图来自这样的一行......

```
Bitmap sourceBitmap = BitmapFactory.decodeFile(pictureFile); 
```

图片文件是一个 GIF。

但是，我真的不知道为什么 decodeFile 会产生一些看似无效的配置。如果我检查 sourceBitmap 的配置，它会返回 null ?!?

# wpf - WPF 形状几何缩放而不影响笔画

> ID：13260595
> 
> 赞同：6
> 
> 时间：2012-11-06T22:42:42.107
> 
> 标签：wpf

我想知道是否有人在将缩放变换应用于形状时设法覆盖了 WPF 形状渲染的默认行为。默认行为会转换整个形状绘图，包括笔划，但我只想缩放几何图形。困难在于我的形状位于视觉层次结构中，渲染变换应用于不同的级别（有点像 2D 场景图，但 WPF 视觉树），我无法更改（！）。我在不同的地方读到，可以创建一个自定义形状来取消渲染变换的变换并将其放在几何体上。目前我有类似的东西：

```
public sealed class MyPath : Shape
{
    // This class has a Data property of type Geometry just like the normal Path class

    protected override Geometry DefiningGeometry
    {
        get
        {
            Geometry data = Data;

            if (data == null)
            {
                data = Geometry.Empty;
            }

            return data;
        }
    }

    protected override void OnRender(DrawingContext drawingContext)
    {
        Transform tr = RenderedGeometry.Transform;
        Geometry geomToDraw = RenderedGeometry.Clone();
        geomToDraw.Transform = new MatrixTransform(tr.Value * tr.Value);
        Matrix trInv = tr.Value; trInv.Invert();
        drawingContext.PushTransform(new MatrixTransform(trInv));
        drawingContext.DrawGeometry(Brushes.Transparent, new Pen() { Brush = Brushes.Black, Thickness = 1 }, geomToDraw);
    }
} 
```

很明显，我对此很陌生，上面的代码可能完全搞砸了。我试图将矩阵转移到几何而不改变最终得到的几何变换，因此 tr.Value*tr.Value 和 trInv。但它不像我想要的那样工作。我知道这种转移变换技术在理论上是有效的，因为我用恒定变换进行了尝试（测试设置 Geometry.Transform 以用 4 缩放 x 并推动变换以用 0.25 缩放 x 工作正常，但生成的形状绘图似乎并不适用拉伸=填充，我依赖）。所以渲染转换一定有一些我遗漏的东西。

不工作的测试场景是这样的：

*   我在 xaml 中应用了 scaleX=4 和 scaleY=1 的渲染比例变换。
*   内置的 Path 类缩放整个绘图，使 x 方向的笔划比 y 方向的笔划宽 4 倍。
*   我希望 MyPath 仅缩放几何图形，而不是笔划。<- 这不起作用！
    *   发生的情况是：几何图形正确缩放，笔划在 x 方向缩放 4，在 y 方向缩放略小于 4。怎么了？我有一种感觉，我不应该只使用 RenderedGeometry.Transform 而是应该使用什么来代替？我需要在形状上合并渲染变换和拉伸=填充。我的渲染变换层次结构可能包含缩放、旋转和平移的混合，因此解决方案必须足够通用以处理任何变换，而不仅仅是轴对齐缩放。

注意：我知道在 OnRender 中创建几何体很糟糕，但我想在花时间清理它之前让它工作。

顺便说一句，我读了这篇文章：

[Path 的笔画粗细不变，与比例无关](https://stackoverflow.com/questions/724139/invariant-stroke-thickness-of-path-regardless-of-the-scale)

如前所述，问题是我确实必须考虑渲染转换，我不确定如何调整该解决方案以与它们一起使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T06:00:22.007

如果我正确理解了这个问题，您想取消渲染转换对笔而不是几何图形的影响。

这可以通过获取控件相对于要取消转换的项目的转换来实现，并使用其逆来取消对笔的影响。（例如，如果您有层次结构 P1/P2/P3/UrShape，并且 P1、P2、P3 都对它们进行了变换，并且您希望它们都不会影响您的笔，则需要获得 P1 相对的变换到 UrShape）。然后你可以将变换重新应用到你的形状。

```
var brush = new SolidColorBrush(Colors.Red);
var pen = new Pen(brush, 5);
//Instead of the direct parent you could walk up the visual tree to the root from where you want to cancel the transform

var rootTransform = (MatrixTransform)this.TransformToAncestor((Visual)this.Parent);

var inverserRootTransform = (MatrixTransform)rootTransform.Inverse;

//We cancel out the transformation from the parent 
drawingContext.PushTransform(inverserRootTransform);

var renderGeometry = this.Geometry.Clone();
// We apply the parent transform to the shape only, and group it with the original transform that was present on the shape
// we do this to honor any transformation that was set on the shape.
renderGeometry.Transform = new TransformGroup()
{
   Children =
   {
      rootTransform,
      this.Geometry.Transform
   }
};

//We draw the shape, the pen size will have the correct size since we canceled out the transform from the parent
// but the shape now has the transformation directly on it.
drawingContext.DrawGeometry(brush, pen, renderGeometry);
drawingContext.Pop(); 
```

# javascript - jquery 网格和 javascript 最佳实践

> ID：13260597
> 
> 赞同：0
> 
> 时间：2012-11-06T22:43:00.317
> 
> 标签：javascript, jquery, asp.net-mvc

我是 jquery 新手，需要一些帮助。

在 jquery 的帮助下，我编写了一个类似于网格的表格。

当用户单击名称列时，用户将被重定向到详细信息页面。

现在我想知道我是否可以以更好的方式做到这一点？

JS 代码应该在页面中还是在单独的 JS 文件中？

这是代码。

```
 <table id="grid">
    <thead>
        <tr>
            <th data-field="name">Namn</th>
            <th data-field="location">Ort</th>
            <th data-field="phone">Telefon</th>
            <th data-field="buildinmonth">Bygga inom</th>
            <th data-field="houselot">Har tomt</th>
            <th data-field="created">Skapad</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td><span id="open" data-id="@item.Id">@item.Name</span></td>
                <td>@item.Location</td>
                <td>@item.Phone</td>
                <td>@item.BuildInMonth</td>
                <td>@item.HouseLot</td>
                <td>@String.Format("{0:d}", item.CreatedDate)</td>
            </tr>
        }
    </tbody>
</table>

<script>
        $("#grid").kendoGrid({
            scrollable: false,
            sortable: true
        });

    $("#grid #open").click(function () {
        window.location.replace("/lead/details/" + $(this).data("id"));
    });
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T06:00:52.943

在这种情况下，不需要使用任何 jquery click 事件，当 html 表正在加载时，我们可以给一个`<a>`标签，如，

```
<td><a href="../lead/details/"+"@item.Id" ><span id="open" data-id="@item.Id">@item.Name</span></a></td> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T05:34:58.580

> 当用户单击名称列时，用户将被重定向到详细信息页面。现在我想知道我是否可以以更好的方式做到这一点？

这似乎没问题。我觉得唯一可以添加的是在名称列的悬停上，您可以显示“显示更多详细信息”的工具提示或更直观的东西。

> JS 代码应该在页面中还是在单独的 JS 文件中？

是的，我总是喜欢将我所有的 JS 代码放在一个单独的文件中。这样做的好处是您可以在以后缩小 JS 代码。

# javascript - 将孩子添加到弹出窗口中。(JavaScript)

> ID：13260599
> 
> 赞同：2
> 
> 时间：2012-11-06T22:43:10.913
> 
> 标签：javascript, html, popup, window.open, appendchild

我在尝试让一个相当简单的弹出窗口工作时遇到了一些麻烦。这个想法是父母应该打开一个弹出窗口，然后在其中附加一个 div。

代码的相关部分：

**父.html**：

```
var childWindow;

function togglePref() {
    childWindow = window.open("popup.html", "prefPopup", "width=200,height=320");
}

function loadPopupElements() {
    var prefElements = document.getElementById("prefBrd").cloneNode(true);

    var childDoc = childWindow.document;

    var childLink = document.createElement("link");
    childLink.setAttribute("href", "pop.css");
    childLink.setAttribute("rel", "stylesheet");
    childLink.setAttribute("type", "text/css");

    childDoc.head.appendChild(childLink);
    childDoc.body.appendChild(prefElements);
} 
```

**popup.html**：

```
<head>
</head>

<body onload="opener.loadPopupElements();">
</body> 
```

这适用于 Safari 和 Chrome，但出于某种原因 IE 拒绝附加任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T13:04:50.410

好的，我设法通过使用 innerHTML 的丑陋解决方案解决了这个问题。显然，正如 Hemlock 所提到的，IE 不支持从另一个文档附加子级。有些人建议看一下 importNode() 方法，但我似乎也没有运气。

因此，解决方法如下：

**父.html**：

```
var childWindow;

function togglePref() {
    childWindow = window.open("popup.html", "prefPopup", "width=200,height=320");
}

function loadPopupElements() {
    var prefElements = document.getElementById("prefBrd");
    var childDoc = childWindow.document;
    childDoc.body.innerHTML = prefElements.innerHTML;
} 
```

**popup.html**：

```
<head>
    <link href="pop.css" rel="stylesheet" type="text/css">
</head>

<body onload="loadElements();">
</body>

<script type="text/javascript">
    function loadElements() {
        opener.loadPopupElements();
    }
</script> 
```

这似乎是一种非常讨厌的方法，因为在我的情况下，*#prefBrd*包含一些具有动态设置值的输入元素，所以为了让 popup.html 抓取它们，它必须在 loadElements 结束时进行一些迭代() 函数，这在使用 appendChild 时是不必要的。

# .net - 使用 C# 创建运行一次并立即删除的 win 任务

> ID：13260600
> 
> 赞同：2
> 
> 时间：2012-11-06T22:43:14.520
> 
> 标签：.net, windows, c#-4.0, scheduled-tasks

这是用例： - 创建一个新的 win 任务，立即运行，一旦完成，删除该任务。

这是使用 C# 创建任务的基本代码。

```
 using (TaskService ts = new TaskService(null))
    {
        string projectName = "runnowtest" + Guid.NewGuid().ToString();

        //create new task
        TaskDefinition td = ts.NewTask();
        Trigger mt = null;

        //setup task as Registration trigger
        mt = td.Triggers.AddNew(TaskTriggerType.Registration);
        mt.StartBoundary = DateTime.Now;

        //delete the task 1 minute after the program ends
        td.Settings.DeleteExpiredTaskAfter = new TimeSpan(0, 1, 0); 

        //run the notepad++ in the task
        td.Actions.Add(new ExecAction("notepad.exe"));

        //register task
        Task output = ts.RootFolder.RegisterTaskDefinition(projectName, td);

        //check output
        Console.WriteLine(output != null ? "Task created" : "Task not created");
    } 
```

API 似乎没有将任务标记为运行一次的属性/标志。我试图确保上述任务只运行一次，然后立即删除。任何想法都非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-02T11:42:50.077

我知道它的旧但供参考......要使用 DeleteExpiredTaskAfter 你需要给触发器 EndBoundary：

```
var trigger = new RegistrationTrigger{Delay = TimeSpan.FromSeconds(5), EndBoundary = DateTime.Now.Add(TimeSpan.FromSeconds(50))}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:58:58.137

您可以设置任务 XML 定义来设置 API 未直接公开的所有内容。

*   [http://msdn.microsoft.com/en-us/library/windows/desktop/aa382559(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382559(v=vs.85).aspx)

# jquery - 将 a.link 添加到 jquery .css

> ID：13260604
> 
> 赞同：1
> 
> 时间：2012-11-06T22:43:25.167
> 
> 标签：jquery, css

我有一行我添加了一些 css：

```
$("#foo").html("Some text with a link <a href=\"link.html\">Link here</a>").css({
     'margin': '10px 0px',
     'padding': '15px 10px 15px 50px',
     'clear': 'left'
}); 
```

我想将链接更改为黑色，因此添加此 css 应该可以：

```
a.link {
     color: black
} 
```

我想最好的办法是指向一个 css 文件，而不是添加`a.link`. 但想知道这是否可能。显然这样的事情不起作用，因为它不是正确的 json 格式：

```
$("#foo").html("Some text with a link <a href=\"link.html\">Link here</a>").css({
     'margin': '10px 0px',
     'padding': '15px 10px 15px 50px',
     'clear': 'left',
     'a:link: color': 'black'
 }); 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T22:49:33.333

您不能从父元素 css 函数更新子元素的样式。相反，为什么不将它添加到 css 文件中，

```
#foo a.link { color: black; } 
```

如果您对如何通过脚本添加它感到好奇..

```
$("#foo")            //Added class link to the link tag--v
   .html('Some text with a link <a href=\"link.html\" class="link">Link here</a>')
   .css({'margin': '10px 0px', 'padding': '15px 10px 15px 50px', 'clear': 'left'})
   .find('a.link').css({'color': 'black'}); 
   //^-- this would find the link tag and updates its css 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:47:56.083

为什么不插入带有所需样式的样式标签？`<style type="text/css">a.link: {color: black}</style>`或内联定义链接颜色

```
$("#foo").html('Some text with a link <a style="color: black" href="link.html">Link here</a>').css({'margin': '10px 0px', 'padding': '15px 10px 15px 50px', 'clear': 'left'}); 
```

`.css`用于定义内联 css 样式，而不是由选择器定义的样式，例如`a.link`，为此使用`<style>`标签。

# ruby-on-rails - 异常处理：“nil:NilClass 的未定义方法 `____'”

> ID：13260609
> 
> 赞同：2
> 
> 时间：2012-11-06T22:43:35.133
> 
> 标签：ruby-on-rails, ruby, exception-handling

我的 Web 应用程序失败的最常见原因之一是用户有时缺少视图期望它具有的某个属性。例如，我的应用程序中的大多数用户在我们的系统中都有教育（学校、学位等）条目，但有些用户没有。假设我的观点是这样的：

```
<% @educations.each do |education| %>
  <%= education.school %>
  <%= education.degree %>
<% end %> 
```

我想避免“口袋妖怪”异常处理，并认为在用户在我们的数据库中没有教育条目的情况下，必须有更好的方法来处理“nil:NilClass 的未定义方法‘度’”错误. 这似乎是一个丑陋/乏味的修复：

```
<% @educations.each do |education| %>
  <% if education.school %>
    <%= education.school %>
  <% end %>
  <% if education.degree %>
   <%= education.degree %>
  <% end %>
<% end %> 
```

任何输入表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:47:03.203

只要你知道你正在处理的第一个对象不会是 nil，最简单的方法就是这样做：

```
- @educations.each do |education|
  = education.try :school
  = education.try :degree 
```

#try[方法](http://everydayrails.com/2011/04/28/rails-try-method.html)非常方便。你也可以调用`.to_s`任何你认为可能为零的东西，即：

```
- @educations.each do |education|
  = education.school.to_s
  = education.degree.to_s 
```

这会将 nils 转换为空字符串。这在 IMO 视图中没有那么有用，但如果您的输入预期为字符串并且可能为空，则很多时候会派上用场。即像这样的方法：

```
def put_in_parenthesis(string)
  "(" + string.to_s + ")"
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:52:09.183

您在这里有几个选择。

最容易实现的是[try 方法](http://api.rubyonrails.org/classes/Object.html#method-i-try)。它是这样使用的：

```
<%= education.try( :degree ) %> 
```

问题是这`try()`被视为[一种反模式](https://gist.github.com/1602530)。如参考所示，您可以通过以下方式实现类似的功能：

```
<%= education && education.degree %> 
```

在我看来，这在智力上并没有太大的不同。一种更干净地处理这个问题的流行方法是[Null Object 模式](https://en.wikipedia.org/wiki/Null_Object_pattern)，它基本上是一个具有定义中性（“null”）行为的对象。

# azure - MVC 4 Azure Web 角色：将“跟踪”元素添加到 web.config 时出现错误 500

> ID：13260615
> 
> 赞同：0
> 
> 时间：2012-11-06T22:44:07.323
> 
> 标签：azure, web-config, asp.net-mvc-4, azure-web-roles

我正在尝试按照此处找到的示例向 Azure Web 角色添加诊断： [https ://www.windowsazure.com/en-us/develop/net/common-tasks/diagnostics/](https://www.windowsazure.com/en-us/develop/net/common-tasks/diagnostics/)

当我在`tracing`下添加元素`system.webserver`时，我在运行网站时看到错误。`OnStart`甚至在命中断点之前就可以看到该错误。

有任何想法吗？

这是我的`web.config`文件，其中有问题的部分已注释掉：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>    
    <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
  </configSections>
  <system.diagnostics>
    <trace>
      <listeners>
        <add type="Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorTraceListener, Microsoft.WindowsAzure.Diagnostics, Version=1.8.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" name="AzureDiagnostics">
        </add>
      </listeners>
    </trace>
  </system.diagnostics>
  <connectionStrings>
    <add name="DefaultConnection" connectionString="Data Source=.\SQLEXPRESS;Initial Catalog=aspnet_d368ef657c124d629b2577cb9775791c;Integrated Security=True;MultipleActiveResultSets=True" providerName="System.Data.SqlClient" />
  </connectionStrings>
  <appSettings>
    <add key="webpages:Version" value="2.0.0.0" />
    <add key="webpages:Enabled" value="false" />
    <add key="PreserveLoginUrl" value="true" />
    <add key="ClientValidationEnabled" value="true" />
    <add key="UnobtrusiveJavaScriptEnabled" value="true" />
  </appSettings>
  <system.web>
    <customErrors mode="Off"></customErrors>
    <compilation debug="true" targetFramework="4.0" />
    <authentication mode="Forms">
      <forms loginUrl="~/Account/Login" timeout="2880" />
    </authentication>
    <pages>
      <namespaces>
        <add namespace="System.Web.Helpers" />
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Optimization" />
        <add namespace="System.Web.Routing" />
        <add namespace="System.Web.WebPages" />
      </namespaces>
    </pages>
    <machineKey decryption="AES" decryptionKey="F7FA540B4DFD82E5BB196B95D15FF81F740A8B17F626BAF1D0889905ACBF0B60" validation="SHA1" validationKey="740A8B17F626BAF1D0889905ACBF0B609712CDA49DE62168764FF0DCE537184F0535D5D9AD66DEDC740A8B17F626BAF1D0889905ACBF0B609712CDA497DC1ABF" />
  </system.web>
  <system.webServer>
    <validation validateIntegratedModeConfiguration="false" />
    <modules runAllManagedModulesForAllRequests="true" />
    <handlers>
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
      <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
      <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
      <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
      <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
    </handlers>
    <!--<tracing>
      <traceFailedRequests>
        <add path="*">
          <traceAreas>
            <add provider="ASP" verbosity="Verbose" />
            <add provider="ASPNET" areas="Infrastructure,Module,Page,AppServices" verbosity="Verbose" />
            <add provider="ISAPI Extension" verbosity="Verbose" />
            <add provider="WWW Server"
            areas="Authentication,
                Security,
                Filter,
                StaticFile,
                CGI,
                Compression,
                Cache,
                RequestNotifications,
                Module"
            verbosity="Verbose" />
          </traceAreas>
          <failureDefinitions statusCodes="400-599" />
        </add>
      </traceFailedRequests>
    </tracing>-->
  </system.webServer>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-4.0.0.0" newVersion="4.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
  <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="v11.0" />
      </parameters>
    </defaultConnectionFactory>
  </entityFramework>
</configuration> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T22:21:01.737

这是我解决问题的方法：

突然，服务器开始打印有关 500 错误的详细信息（我不知道为什么，我认为我没有更改任何内容），然后我发现实际错误是：

> HTTP 错误 500.19：
> 
> 无法添加类型为“add”且唯一键属性“path”设置为“*”的重复集合条目

解决方案是在标记**前**添加以下行：`add`

`<remove path="*"/>`

所以现在`tracing`标签看起来像这样：

```
<tracing>
      <traceFailedRequests>
        <remove path="*"/>
        <add path="*">
          <traceAreas>
            <add provider="ASP" verbosity="Verbose" />
            <add provider="ASPNET" areas="Infrastructure,Module,Page,AppServices" verbosity="Verbose" />
            <add provider="ISAPI Extension" verbosity="Verbose" />
            <add provider="WWW Server"
            areas="Authentication,
                Security,
                Filter,
                StaticFile,
                CGI,
                Compression,
                Cache,
                RequestNotifications,
                Module"
            verbosity="Verbose" />
          </traceAreas>
          <failureDefinitions statusCodes="400-599" />
        </add>
      </traceFailedRequests>
    </tracing> 
```

这似乎工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T07:09:48.573

我注意到您引用了 Microsoft.WindowsAzure.Diagnostics Version=1.8.0.0，它是 10 月 Azure SDK 的一部分，以获取 Azure 侦听器。您的项目中是否包含 Storage 客户端库 1.7？Azure 诊断库 1.8 依赖于较旧的存储客户端库 1.7（不是随 sdk 发布的 2.0）

# php - 将数字从 12 转换为 12.00

> ID：13260616
> 
> 赞同：-2
> 
> 时间：2012-11-06T22:44:10.960
> 
> 标签：php, javascript

> **可能重复：**
> [在 PHP 中，如何打印带有 2 个小数的数字，但前提是已经有小数？](https://stackoverflow.com/questions/5648205/in-php-how-to-print-a-number-with-2-decimals-but-only-if-there-are-decimals-al)

兄弟们，我想以任何方式转换我进入文本字段的方式自动将 12 变为 12.00

php和javascript如何工作

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:46:26.433

在 PHP 中很容易做到这一点：

```
number_format($numberVar, 2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:46:12.693

试试这个[来自 PHP.net 的 number_format()](http://us2.php.net/manual/en/function.number-format.php)：

```
echo number_format(12, 2) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T23:12:19.140

什么，没有javascript？

```
var x = 3;
alert(x.toFixed(2)); // 3.00 
```

将“工作”给定的情况，但也将：

```
alert(x + '.00'); 
```

在某些具有某些值的旧浏览器中存在[错误](http://www.merlyn.demon.co.uk/js-rndg1.htm#toF)[`toFixed`](http://ecma-international.org/ecma-262/5.1/#sec-15.7.4.5)，因此许多人编写了自己的简单例程。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-06T22:50:58.937

```
$thisnum = $thisnum . ".00"; 
```

概念证明：

```
$thisnum = $thisnum . ".00";
echo ($thisnum + 4.55); 
```

但是，正如社区所指出的，这仅适用于问题中提到的情况，并且不会处理任何已经有小数的用例。其他答案更好。

# python - python numpy，按行和列对矩阵进行排序

> ID：13260617
> 
> 赞同：2
> 
> 时间：2012-11-06T22:44:21.310
> 
> 标签：python, numpy, python-2.6

我想使用 numpy 创建一个方阵，其中除第一行以外的行按第一行的内容排序。例如：

```
import numpy as np
a = array([['','z','b','d'],
           ['b','2','5','7'],
           ['d','0','1','3'],
           ['z','3','9','2']]) 
```

返回：

```
[['','z','b','d']
 ['z','3','9','2']
 ['b','2','5','7']
 ['d','0','1','3']] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:59:35.597

这是另一种方式，假设您想要的确实是一种基于第一行的行：

```
>>> a[[list(a[:, 0]).index(i) for i in a[0]]]
array([['', 'z', 'b', 'd'],
       ['z', '3', '9', '2'],
       ['b', '2', '5', '7'],
       ['d', '0', '1', '3']], 
       dtype='|S1') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T23:07:16.280

目前尚不清楚为什么要将这些数据放在 numpy 数组中，而字典可能更合适。我假设您想对数据进行一些计算，而您可能不想要字符串 dtype。

在您的示例中，您希望从第一行中的键（可能是字符串）进行排序。如果您想以“方形”形式访问数组（例如像 一样的切片`a[:, 2]`），这意味着所有元素都将转换为字符串。结构化数组将允许您进行更好的排序，但代价是必须像`a[:][2]`. 这是一个结构化数组的示例，它将您的数据放入具有字符串 dtype 的数组中`'names'`，并将值作为 dtype 中的整数`'values'`。您可以通过以下字符串进行排序`'names'`：

```
a = np.array([('b', [2, 5, 7]),
              ('d', [0, 1, 3]), 
              ('z', [3, 9, 2])],
              dtype=[('names', 'S1'),
                     ('values', '3int')]) 
```

您可以分别访问名称和值记录：

```
>>> a['names']
array(['b', 'd', 'z'], 
      dtype='|S5')

>>> a['values']
array([[2, 5, 7],
       [0, 1, 3],
       [3, 9, 2]]) 
```

您可以根据名称的字典排序对值数组进行排序：

```
>>> a['values'][np.argsort(a['names'])]
array([[2, 5, 7],
       [0, 1, 3],
       [3, 9, 2]]) 
```

或者只是使用名称的另一个顺序对数组进行排序：

```
>>> a['values'][np.argsort(['z', 'b', 'd'])]
array([[0, 1, 3],
       [3, 9, 2],
       [2, 5, 7]]) 
```

# actionscript-3 - ActionScript3，movieclip 类型的移动对象

> ID：13260618
> 
> 赞同：0
> 
> 时间：2012-11-06T22:44:27.950
> 
> 标签：actionscript-3, movieclip

在这里，我试图创建一个新的movieclip 类型对象，它在调用函数 mvBall 时被移动。当我运行代码时，我得到了这个错误：将具有静态类型对象的值隐式强制转换为可能不相关的类型 flash.display:MovieClip。稍后我希望能够让球在与另一个物体碰撞时反弹回来。我是动作脚本的新手，并不真正知道事情是如何工作的，所以任何帮助都将不胜感激。这是代码：

```
private function frame(x:Event):void {
        var ball:MovieClip = new MovieClip();
        ball.addEventListener(Event.ENTER_FRAME, animate);
        ball.graphics.beginFill(0xff0000); 
        ball.graphics.drawCircle(100, 100, 15); 
        ball.graphics.endFill(); 
        stage.addChild(ball); 
    }

    private function animate(ev:Event):void {
        mvBall(ev.target);
    }

    private function mvBall(mc:MovieClip) {
        mc.x += 10;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T22:49:51.187

您需要将目标投射到 MovieClip

```
private function animate(ev:Event):void {
    mvBall(ev.target as MovieClip);
} 
```

话虽如此，最好只有一个 ENTER_FRAME 处理程序并在其中为您的对象设置动画。

```
stage.addEventListener(Event.ENTER_FRAME, animate);

private function animate(ev:Event):void
{
    mvBall(myBall);
    //other object animations
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:50:20.070

您收到此错误是因为`target`Event 类的属性是对象类型。

为了不抛出错误，您需要将其转换为 MovieClip：

```
mvBall(ev.target as MovieClip); 
```

或者

```
myBall(MovieClip(ev.target)); 
```

需要考虑的其他事情是`Event`s`target`和`currentTarget`属性之间的区别。如果您的球内部有多个图层/对象（精灵或其他影片剪辑），`target`则将是这些子元素中的任何一个在单击期间将鼠标悬停在其上。 `currentTarget`指您已将侦听器附加到的对象。在您的情况下，它们可能是相同的（如果您的球内没有任何影片剪辑），但如果您的球内有子影片剪辑，您的代码可能会产生意想不到的结果。

# google-app-engine - Google App Engine Channel API javascript 位置

> ID：13260620
> 
> 赞同：1
> 
> 时间：2012-11-06T22:44:31.350
> 
> 标签：google-app-engine

我对此有点困惑，并想确保我不会天真地了解它是如何工作的。客户端 JavaScript 是否也必须托管在 Google App Engine 上？假设我在我的开发服务器上创建了一个频道，然后我的计算机上有一个本地 HTML 文件（非托管）和所需的 javascript，然后我使用令牌连接到该频道 - 这行得通吗？或者这不是渠道的运作方式？

**编辑：**

我所拥有的只是一个 HTML 文件，与我的 app.yaml 文件（因此是我的网站的根目录）位于同一目录中。我在开发服务器中。

首先我创建一个频道并获取令牌：

```
token = channel.create_channel('1')                      
print token                                                    
>>> channel-4132644671-1352248413-1 
```

然后我将该令牌复制到我的 HTML 文件中：

```
<html>
<head> 
<script type="text/javascript" src="http://localhost:8080/_ah/channel/jsapi"></script>
</head>
<body >
<script>

    var token = 'channel-4132644671-1352248413-1';
    var channel = new goog.appengine.Channel(token);
    var socket = channel.open();
    socket.onopen = function() { alert('open'); };
    socket.onmessage = function() { alert('message'); };
    socket.onerror = function() { alert('error'); };
    socket.onclose = function() { alert('close'); };        
</script>
</body>
</html> 
```

我用 Safari 打开 HTML 文件。我收到一条警告说“打开”。但是，无论我输入什么令牌`var token`，我都会收到“打开”警报，因此我不确定收到该警报是否意味着什么。

然后我做： `channel.send_message('1', 'hi')`

我的 HTML 文件中什么也没有发生。没有警报。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:00:45.277

由于同源策略，脚本必须与应用程序打开频道的服务器托管在同一域中。对于当前的实现，该服务器是talkgadget.google.com，支持脚本是[https://talkgadget.google.com/talkgadget/channel.js](https://talkgadget.google.com/talkgadget/channel.js)。使用 curl 您可以看到应用程序的 /_ah/channel/jsapi 端点只是向该脚本发出 302 重定向。因此，除非您打算开发和运行自己的频道服务器，否则您不能这样做。

此外，如果通道的底层实现在未来发生变化，App Engine 将更新以将 /_ah/channel/jsapi 重定向到新脚本，这样现有应用程序将继续工作，而自定义方法可能会中断。少一个理由自己做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T05:11:53.647

在 dev_appserver 中，通道由不断轮询服务器的 javascript 函数实现。

如果您的 dev_appserver 没有实际运行（看起来您已经以某种方式闯入了 dev_appserver），那么轮询功能将不会成功，您也不会收到频道消息。

在生产环境中，通道 API 似乎使用了某种长轮询。

另外，我必须仔细检查文档，但我相信第一个参数`send_message`应该是令牌。

# haskell - 无法在 Haskell 平台 2012.2.0.0 (Windows XP) 上安装酸状态

> ID：13260622
> 
> 赞同：1
> 
> 时间：2012-11-06T22:44:34.880
> 
> 标签：haskell, installation, acid-state

使用 cabal，我尝试在 Haskell Platform 2012.2.0.0 (Windows XP) 上安装 acid-state，但出现以下错误：

```
src-win32\FileIO.hs:43:5:
    Not in scope: catchIO Perhaps you meant `catch' (imported from Prelude)

src-win32\FileIO.hs:55:6:
    Not in scope: tryE Perhaps you meant `try' (imported from Control.Exception.Extensible)

src-win32\FileIO.hs:56:6:
    Not in scope: tryE
    Perhaps you meant `try' (imported from Control.Exception.Extensible)
cabal: Error: some packages failed to install:
acid-state-0.8.1 failed during the building phase. The exception was:
ExitFailure 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T16:37:12.290

当转到可扩展异常系统时，经常会出现这种问题。`tryE`并且`catchIO`是标准样板；他们只是专注于使用`catch`和`try``SomeException``IOException`

```
 import Control.Exception.Extensible(try,throw)
 import Control.Exception(SomeException,IOException)
 import qualified Control.Exception as E 
 tryE :: IO a -> IO (Either SomeException a)
 tryE = try
 catchIO :: IO a -> (IOException -> IO a) -> IO a
 catchIO = E.catch 
```

这样做`cabal unpack acid-state`，并将 src-win32/FileIO.hs 替换为[this ，它在第 18 行](https://gist.github.com/4032603)[https://gist.github.com/4032603](https://gist.github.com/4032603)上定义它们 然后`cabal install`从外部目录执行，即`acid-state.cabal`文件所在的目录。

可能还有一些额外的错误，因为我目前无法测试它。正如 Paul R. 所说，当你编译它时，将它发送给维护者。该软件包得到大量维护，但看起来他们需要 Windows 测试仪。酸状态当然值得麻烦。您还应该尝试 examples/ 目录中的一些模块，这无论如何都是一个很好的教程。如果回写比较麻烦，我们可以一起设计一个合适的补丁文件。

# r - 选择要在 ggplot2 中绘制的数据框列

> ID：13260626
> 
> 赞同：7
> 
> 时间：2012-11-06T22:44:48.130
> 
> 标签：r, ggplot2

我有一个大约 150 列的大数据表。我需要用其中大约 1/3 制作一系列直方图。我不想在我的脚本中放置 50 行相同的绘图命令，而是想循环一个列表，告诉我要使用哪些列。这是一个测试数据集来说明：

```
d <- data.frame(c(rep("A",5), rep("B",5)),
                sample(c(1:10), 10, replace=TRUE),     
                sample(c(1:10), 10, replace=TRUE),     
                sample(c(1:10), 10, replace=TRUE),     
                sample(c(1:10), 10, replace=TRUE),     
                sample(c(1:10), 10, replace=TRUE))

colnames(d) <- c("col1","col2","col3","col4","col5","col6" )

ggplot(data=d, aes(col2, fill= col1)) + geom_density(alpha = 0.5) 
```

所以，与其写这个 50 次并替换这些`aes()`值，我真的想做更多这样的事情......

```
cols_to_plot <- c("col2","col4","col6")

for (i in length(cols_to_plot)) {
  ggplot(data=d, aes(cols_to_plot[i], fill= col1)) + geom_density(alpha = 0.5)

} 
```

但是当然，这不起作用......有没有办法做这种事情？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-06T22:50:45.200

我认为如果你融化你的数据会更好。试试这个：

```
library(reshape2)
d2 <- melt(d, id='col1')
ggplot(d2, aes(value, fill=col1)) + geom_density(alpha=.5) + facet_wrap(~variable) 
```

或者，如果您想做您最初想做的事情，请使用`aes_string`，例如：

```
ggplot(data=d, aes_string(cols_to_plot[i], fill='col1')) + geom_density(alpha = 0.5) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-06T22:52:39.427

有一个替代方案`aes()`；`aes_string()`. 有了这个，您可以传入字符串以进行美学映射。请注意，您必须在`col1`此处引用`fill = "col1"`。另请注意，在`for()`循环中，您需要显式地显示`print()`一个**ggplot**对象，以便在当前设备上绘制绘图。

```
d <- data.frame(c(rep("A",5), rep("B",5)),
                sample(c(1:10), 10, replace=TRUE),     
                sample(c(1:10), 10, replace=TRUE),     
                sample(c(1:10), 10, replace=TRUE),     
                sample(c(1:10), 10, replace=TRUE),     
                sample(c(1:10), 10, replace=TRUE))

colnames(d) <- c("col1","col2","col3","col4","col5","col6" )

cols_to_plot <- c("col2","col4","col6")

for (i in seq_along(cols_to_plot)) {
  print(ggplot(data=d, aes_string(x = cols_to_plot[i], fill= "col1")) +
    geom_density(alpha = 0.5))
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-06T22:49:27.247

是的，`aes_string`

```
cols_to_plot <- c("col2","col4","col6")

for (i in cols_to_plot) {
  ggplot(data=d, aes_string(i, fill= 'col1')) + geom_density(alpha = 0.5)

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-06T22:54:02.350

`lapply()`可以在这里用来代替`for`带有 . 的循环`aes_string()`。

```
cols_to_plot <- c("col2","col4","col6")
lapply(cols_to_plot,function(i){
  ggplot(data=d, aes_string(x=i, fill= 'col1')) + 
    geom_density(alpha = 0.5)
} ) 
```

# javascript - 警报然后重新加载页面 IN 检测文件扩展名上传脚本

> ID：13260629
> 
> 赞同：0
> 
> 时间：2012-11-06T22:45:00.613
> 
> 标签：javascript, html, upload, reload

我在上传时使用这个 javascript 来限制文件类型的扩展名：

```
function TestFileType( fileName, fileTypes ) {
if (!fileName) return;

dots = fileName.split(".")
//get the part AFTER the LAST period.
fileType = "." + dots[dots.length-1];

return (fileTypes.join(".").indexOf(fileType) != -1) ?
alert('Correct File Type Function Here') :
alert('Wrong File Type Function Here');
} 
```

和

```
<input name="replay_file" id="replay_file" type="file"/> 
<input type="submit" id="upload_file" value="Upload" name="uploadReplay" onClick="TestFileType(this.form.replay_file.value, ['w3g','.w3g']);" /> 
```

我希望它发出警报（错误的文件类型），然后重新加载页面（以便它取消上传而不是浪费时间），但到目前为止，我只能让警报框工作，但在那之后不能让页面重新加载功能，页面重新加载不起作用我什至尝试了 goto url 和 windows 位置，但它不起作用，只会在警报框后继续上传文件：

```
return (fileTypes.join(".").indexOf(fileType) != -1) ?
null() :
alert('Warcraft III replay file (.w3g) allowed only!');window.location.reload();
} 
```

我是否遗漏了什么，或者在文件上传时它不会以这种方式工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T10:01:39.813

杰里米，

我看到您已经接受了这个问题的答案，但是由于您发布的代码中的基本问题，我担心您将来会遇到其他问题。

首先，

```
return (condition) ? alert('Correct') : alert('Wrong'); 
```

*alert*是一个没有返回值的本机函数。如果您确实将其视为返回某些内容，则该内容将是未定义的，因此无论您的条件是什么，上面的行始终返回*undefined*。如果我的解释不清楚，请尝试以下操作：

```
alert(alert(Math.min(-3,5))); 
```

第二，

```
return (condition) ? null() : alert('msg'); window.location.reload(); 
```

*null*不是函数。它是一个保留字，表示具有未知值的已定义对象。

此外，三元 if ( b ? x : y ) 以第一个分号结束，因此永远不会调用*reload() 。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:50:33.777

`onsubmit`如果扩展名不正确，请使用事件取消表单，如下所示：

```
function TestFileType( fileName, fileTypes ) {
if (!fileName) return;

dots = fileName.split(".")
//get the part AFTER the LAST period.
fileType = "." + dots[dots.length-1];

if (fileTypes.join(".").indexOf(fileType) != -1) {
   //alert('Correct File Type Function Here');
   return true;
} else {
   alert('Wrong File Type Function Here');
   return false;
}
} 
```

在`onsubmit`您的表单元素上连接事件：

```
<form onsubmit="return TestFileType(this.form.replay_file.value, ['w3g','.w3g']);" ... 
```

# javascript - JS中的特殊字符，如何使用“/”字符

> ID：13260633
> 
> 赞同：0
> 
> 时间：2012-11-06T22:45:23.287
> 
> 标签：javascript, character, vbulletin

我有 vbulletin 4.2.0 我在这篇文章的编辑器中添加了一个特殊按钮；

[http://www.vbulletinguru.com/2012/add-a-new-toolbar-button-to-ckeditor-tutorial/](http://www.vbulletinguru.com/2012/add-a-new-toolbar-button-to-ckeditor-tutorial/)

我想做的是用这个按钮添加一个语法高亮代码。

当我使用下面的代码时，它工作正常；

```
CKEDITOR.plugins.add( 'YourPluginName',
{
    init: function( editor )
    {
        editor.addCommand( 'SayHello',
            {
                exec : function( editor )
                {    
                        editor.insertHtml( "Hello from my plugin" );
                }
            });
        editor.ui.addButton( 'YourPluginName',
        {
            label: 'My Button Tooltip',
            command: 'SayHello',
            icon: this.path + 'YourPluginImage.png'
        } );
    }
} ); 
```

所以我将此代码更改为此，因为我想添加如下特定文本；

```
CKEDITOR.plugins.add( 'DKODU',
{
    init: function( editor )
    {
        editor.addCommand( 'SayHello',
            {
                exec : function( editor )
                {
                        editor.insertHtml( '[kod=delphi][/kod]' );
                }
            });
        editor.ui.addButton( 'DKODU',
        {
            label: 'My Button Tooltip',
            command: 'SayHello',
            icon: this.path + 'star.png'
        } );
    }
} ); 
```

更新代码后，当我按下按钮时没有发生任何事情，我检查了谷歌和这个网站，但我无法弄清楚我认为我在某些特殊字符上犯了错误，但我找不到问题所在。

如果我在发布这个问题时犯了一些错误，请原谅我，也请原谅我的英语不好，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:48:03.147

使用 '\' 转义 '/' 就像我们在 C/C++ 或所有其他语言中所做的那样

所以，

```
editor.insertHtml( '[kod=delphi][\/kod]' ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:43:04.743

谢谢大家的回答，我解决了这个

```
var baslangic="[kod=delphi]";
var bitis="[/kod]";
CKEDITOR.plugins.add( 'DKODU',
{
    init: function( editor )
    {
        editor.addCommand( 'DKODU',
            {
                exec : function( editor )
                {    
                 editor.insertHtml(baslangic);
                 editor.insertHtml('');
                 editor.insertHtml(bitis);
                }
            });
        editor.ui.addButton( 'DKODU',
        {
            label: 'Delphi Kodu Ekle',
            command: 'DKODU',
            icon: this.path + 'star.png'
        } );
    }
} ); 
```

# python - Python中的星号三角形

> ID：13260642
> 
> 赞同：2
> 
> 时间：2012-11-06T22:46:11.777
> 
> 标签：python

我正在尝试创建一个程序，允许我在 Python 程序中使用星号制作“金字塔”或“三角形”。我已经开始了代码，但似乎无法弄清楚。

这是我设法弄清楚的代码：

```
 def triangle():
            totalRows = int(eval(input("How big? ")))
            for currentRows in range(1,totalRows+1):
                for currentCol in range (1, currentRows+1):
                            print("*", end = " ")
    triangle() 
```

最终结果应该反映这一点！

```
How big? 1
* 
------------------------------------------------------
How big? 2
 * 
* * 
------------------------------------------------------ 
How big? 3
  * 
 * * 
* * * 
------------------------------------------------------ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T23:18:11.937

对 RParadox 的解决方案稍作修改以符合要求：

```
for i in range(totalRows + 1):
    numWhite = totalRows - i
    print ' ' * numWhite + '* ' * i 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T22:47:55.613

```
n = 10                                                                          
for i in range(n-1):                                                            
    numwhite = n-i                                                              
    print ' '*numwhite + '*'*i + '*'*i  

         **
        ****
       ******
      ********
     **********
    ************
   **************
  **************** 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T23:41:06.207

```
 def build_pyr(depth):
            rows = [ (depth-i)*' ' + i*2*'*' + '*'   for i in range(depth-1) ]
            for i in rows:
                    print i 
```

这是可行的，但是，它会在每个深度添加 2n + 1 个星号。只需从列表理解中删除 + 1 星号，并事先在行列表中添加一个初始星号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-04-14T17:21:21.290

```
kiko="*"

empty=" "

def star(n):

    for i in range(n):
        print((n-i-1)*empty+(i+i+1)*kiko)
star(5) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-12T06:52:31.577

只需几个步骤即可完成：

```
def main():

    rows = input(" enter the number of rows : ")
    for i in range (rows):
        print ' '*(rows-i-1) + '*'*(2*i+1)
main() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-06T23:37:19.960

```
def xmastree(maxwidth):
    for i in xrange(1,maxwidth,2):
        print '{0}'.format('*'*i).center(maxwidth) 
```

或者：

```
def xmastree2(maxrows):
    for i in xrange(1,maxrows*2,2):
        print '{0}'.format('*'*i).center(maxrows*2) 
```

嗯，仍然没有回应，也许不够通用？好吧试试这个;-)：

```
def triangle(pattern, n):   
    maxwidth = n*len(pattern)*2
    for i in xrange(1,n*2+1,2):
        print '{0}'.format(pattern*i).center(maxwidth)

>>> triangle(' ^', 5)
          ^         
        ^ ^ ^       
      ^ ^ ^ ^ ^     
    ^ ^ ^ ^ ^ ^ ^   
  ^ ^ ^ ^ ^ ^ ^ ^ ^ 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-18T02:15:05.963

哇，伙计们，你从一个非常复杂的角度来看它！你为什么不直接使用这个程序？：

```
asterisknum = int(raw_input('How many asterisks? Input here: '))
base = 0
if asterisknum % 2 == 0:
  print ('Added 1 to even number')
  asterisknum = asterisknum + 1
while asterisknum != -1 :
  print (' ' * base + '*' * asterisknum)
  base = base + 1
  asterisknum = asterisknum - 2
raw_input('Press <Enter> to exit') 
```

我只是让这个程序运行一次，但我使用了每个人都应该知道的极其简单的 python 部分。可以对其进行调整以在同一程序中再次工作，或者其他任何...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-18T15:23:13.510

```
def triangle(height):
    maxstars = 1+ 2*(height -1)
    spaces = int(maxstars/2)
    for i in range(0,height):
        print("  " * spaces   +"*" * (1+ 2*i))
        spaces = spaces -1

number = int(input("Please enter height of triangle: "))
triangle(number) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-08-27T21:57:27.773

想象一下，你有星星和空间的“块”。现在将它们添加到画布上。这是 Python。在这种特殊情况下，它将对象粘合在一起

此代码打印一个菱形，第一个循环是上半部分，第二个循环是下半部分。请注意，我必须为第二个循环创建新变量（对象）。

希望这对大家有帮助:)

```
star = "*"
space = "." # dots are for presentation purposes
rows = 10
star_counter = 1
space_counter = rows
for i in range(rows):
    print((space * (space_counter - 1 )) + (star * star_counter) +
    (star * (star_counter - 1)) + (space * (space_counter - 1)) )
    star_counter += 1
    space_counter -= 1

star_counter_new = (rows - 1) # one row less for the lower triangle
                             # the upper triangle takes the base row
                             # that's why rows - 1
space_counter_new = 1
for j in range(rows - 1): # same goes here
    print((space * (space_counter_new)) + (star * (star_counter_new)) +
    (star * (star_counter_new - 1)) + (space * (space_counter_new )))
    space_counter_new += 1
    star_counter_new -= 1 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2019-08-20T13:12:09.843

```
def pypart2(n): 
    k = 2*n-2
    for i in range(0, n):  
        for j in range(0, k): 
            print(end=" ") 
        k=k-1
        for j in range(0, i+1):
            print("* ", end="")          
        print("\r") 

n = 5
pypart2(n) 
```

# extjs - ExtJS 4.1.1a：为什么我的应用没有 getApplication() 方法？

> ID：13260646
> 
> 赞同：1
> 
> 时间：2012-11-06T22:46:33.173
> 
> 标签：extjs

我从[https://github.com/mclin/extjs-mvc-example](https://github.com/mclin/extjs-mvc-example)开始，并着手对其进行修改，以便它使用 Ext.application，而不仅仅是使用 Ext.Create() 作为 Ext.app 的子类。应用。

到目前为止一切顺利，直到我尝试使用不存在的 getApplication() 函数。

应用程序定义的代码看起来像......

```
Ext.application({
   name: 'Books',
   extend: 'some.class.name',
   controllers: ['Books'],
   ...
}); 
```

这样做的结果是一个名为“Books”的全局对象，好吧，但它没有定义 getApplication()，这与 Ext 文档相反。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:25:02.640

在 4.1.1、4.12 或 4.13 IIRC 之后添加了内存 getApplication。

此外，您不应将extend 与Ext.application() 一起使用。

# javascript - 将 JavaScript 函数设置为与另一个函数一起使用的参数？

> ID：13260651
> 
> 赞同：2
> 
> 时间：2012-11-06T22:47:12.290
> 
> 标签：javascript

这些天我学习了很多 javascript，我不太了解的一件事是将函数作为参数传递给其他函数。我得到了做这些事情的概念，但我自己想不出任何理想的情况。

我的问题是：

你什么时候想让你的 javascript 函数将另一个函数作为参数？为什么不将变量分配给该函数的返回值并将该变量传递给函数，如下所示：

```
// Why not do this
var foo = doStuff(params);
callerFunction(foo);

//instead of this
callerFunction(doStuff); 
```

我很困惑为什么我会选择做第二个例子中的事情。

你为什么要这样做？有哪些用例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T22:54:48.587

处理程序/侦听器就是一个很好的例子。

更一般地，当您还不知道 g 是否需要调用 f、需要调用多少次和/或使用哪些参数时，您可以将函数 f 作为参数传递给函数 g。

例子：

*   排序算法：比较函数
*   正则表达式：替换函数
*   回调（例如事件处理程序）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T22:56:06.917

这是另一个例子。对数组进行一些格式化操作：

```
function pctFormatter(num) {
  return num + '%';
}

function centsFormatter(num) {
  return num + '.00';
}

function formatThisArray(array, formatter) {
  var output = [];
  for(var i = 0; i < array.length; i++) {
    output.push( formatter(array[i]) );
  }
  return output;
}

formatThisArray([1,2,3], pctFormatter);// returns ['1%', '2%', '3%']
formatThisArray([1,2,3], centsFormatter);// returns ['1.00', '2.00', '3.00'] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-06T22:49:28.530

当您没有`params`通过时，您会这样做，但`callerFunction()`确实如此。

AJAX 请求的回调是一种用例。

```
function myCallback(response) {
    // do something with the response
}

myAJAX('http://example.com/foo.json', myCallback) 
```

这允许`myAJAX`发出请求并等待响应的工作。然后，`myCallback`当响应最终到达时，它会调用并将响应传递给它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T22:52:53.367

```
// Why not do this
var foo = doStuff(params);
callerFunction(foo);

//instead of this
callerFunction(doStuff); 
```

第一个示例将运行该函数`doStuff`并将`params`结果分配给`foo`. `callerFunction`将使用参数调用`foo`（现在是 的结果`dooStuff`）；

第二个示例将调用并作为参数`callerFunction`传递。`doStuff`可能会`callerFunction`或可能不会调用`doStuff`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-06T23:04:36.967

好吧，有时你不知道函数的调用者是谁，直到它被调用 - 这排除了传递预先计算的值。

浮现在脑海中的几个例子是：

(a) setTimeout 或 setInterval - 您想在指定时间段后调用特定函数，可以是一次性的，也可以是重复的。如果调用的函数返回一个依赖于时间的值，则在某些情况下您可能无法预先计算该值 - 它需要在预定时间完成。因此，我们告诉函数在指定时间调用我们自己的哪些函数。

(b) 在加载（或至少尝试）各种资源时。我们可以给元素一个函数，加载成功时执行，加载失败时执行另一个函数。在调用这两个（用户提供的）函数中的任何一个之前，您实际上并不知道加载资源的工作何时完成。在有许多资源的情况下，您可以在此处增加保持成功/失败加载尝试次数的计数器。

(c) 调用 getElementsByClass 或 getElementsByTagName 返回的 NodeList。它不是一个实际的（javascript 原生）Array 对象。因此，您不能像使用数组一样调用 forEach 方法。为了解决这个问题，我使用以下辅助函数：

```
// getElementsByTagName, getElementsByClass - both return a NodeList
// it is accessed in the same way as an array - with the [] operators, but it's
// not an array object - this is a function that allows us to still iterate through it
// in much the same way.
function forEachNode(nodeList, func)
{
    var i, n = nodeList.length;
    for (i=0; i<n; i++)
    {
        func(nodeList[i], i, nodeList);
    }
} 
```

这允许我获取节点列表，然后在每个节点上调用一些用户定义的函数。在使用中，它看起来像这样：

```
var allAnchors = document.getElementsByTagName('a');
forEachNode(allAnchors, showNodeTextVal);
function showNodeTextVal(curElem, curIndex, origList)
{
  alert(curElem.innerText);
} 
```

或者更简单地说：

```
var allAnchors = document.getElementsByTagName('a');
forEachNode(allAnchors, function(curElem){alert(curElem.innerText);} ); 
```

与我们不使用这个辅助函数相比，这是一个更清晰、更不容易出错的情况。为了实现相同的功能，我们需要编写以下代码：

```
var nodeList = document.getElementsByTagName('a');
var i, n = nodeList.length;
for (i=0; i<n; i++)
{
  alert(nodeList[i].innerText);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-06T22:49:05.770

最常见的情况是 JQuery 中的处理程序：

```
function clickHandler(e){
  // handle click on e.Target
}

$("#button").click(clickHandler);

$(function(){
// do ready state initialization
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-06T22:53:01.813

```
callerFunction(doStuff); 
```

使用此代码，您可以将函数的“指针”指向`doStuff`函数`callerFunction`

你可以像这样使用它：

```
function callerFunction(doStuff) {

   var x = doStuff(...);
   ...;
} 
```

您可以在函数中使用该函数而不仅仅是`doStuff`.

问候！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-06T22:53:55.713

> 你什么时候想让你的 javascript 函数将另一个函数作为参数？

它对回调很有用，例如：

```
function add( a, b, callback ) {
  callback( a, b );
  return a + b;
}

function added( a, b ) {
  alert('You just added two numbers: '+ a +' and '+ b);
}

alert( add( 1, 2, added ); // Will alert the message and then the result. 
```

这是一个非常简单的示例，但它对异步函数*非常*有用，因此您可以在代码完成后运行代码而不会中断脚本。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-11-06T22:55:06.337

当你想让你的代码真正将函数作为函数处理时，你需要传递函数本身，而不是返回值——要执行的代码。考虑这个伪代码示例：

```
function saveToLocalStorage(data) {...//saves to local storage}

function saveToServer(data) {...//saves via AJAX to server}

function saveToAmazonS3(data) {.../saves to Amazon S3 }

function multiSave(data, saverFunctions) {
    saverFunctions.forEach(function (saverFunction) {
      saverFunction(data);
    });
}

multiSave({user: "tim"}, [saveToLocalStorage, saveToServer, saveToAmazonS3]); 
```

在这种情况下，我希望传递实际函数本身，并让其他代码稍后调用它们。当我们这样做时，诸如此类的函数`multiSave`被称为高阶函数，因为它直接处理其他函数。由于 multiSave 的工作方式，我可以轻松地在本地/服务器/S3 旁边的 UI 中放置一些复选框，并允许用户以一种不太优雅的方式选择他们的数据去向，如果我无法将函数传递为论据。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-11-06T22:59:53.217

当您将函数作为参数传递时，该参数不是该函数的返回值，而是*函数本身*，您可以随意调用它，使用任何您喜欢的参数，或者您可以将其分配给一个事件。
你说你想要一些实际的用例，这里有一个非常常见的情况的简短列表，所有情况都需要一个函数作为参数传递。

让我们看看你的平均 jQuery 代码，并计算一个函数作为参数传递的次数：

```
$(document).ready(function()//<-- 1
{
    $('#foo').on('click',function()//2
    {
    });
    $.each(something,function()//3
    {});
    //and so on
}); 
```

如果您不使用 jQuery，请尝试*事件委托*

```
document.body.addEventListener('click',function(e)
{
    e = e || window.event
    console.log('This function was passed as an argument to the addEventListener method');
},false); 
```

甚至是简单的`Array.prototype.sort`函数（/method）：

```
anArray.sort(function(a,b)
{
    return (a > b ? 1 : -1);
}); 
```

或者，如果您需要进行 ajax 调用，而不是`XMLHttpRequest`当场创建新对象，您可能需要一个单独的函数来设置 xhr 对象，并将 url、数据*和`onreadystatechange`回调*作为参数传递：

```
function makeXHR(url,data,callback)
{
     try
     {
          var xhr = new XMLHttpRequest();
      }
      catch(e)
      {
           //etc...
      }
      xhr.onreadystatechange = callback;
}
makeXHR('some/url','foo=bar',function()
{
    if (this.readyState === 4 && this.status === 200)
    {
        //do stuff
    }
}); 
```

在所有这些示例中，我已经创建了内联函数，当然引用一个函数（仅通过它的名称）也可以正常工作：

```
makeXHR('some/url','foo=bar',defaultXhrCallback); 
```

这些只是数千个用例中的几个，您可以/必须将函数作为参数传递给另一个函数

# r - 模拟错误。具有非零差分项和外部回归器的 Arima

> ID：13260652
> 
> 赞同：0
> 
> 时间：2012-11-06T22:47:19.517
> 
> 标签：r, forecasting

当我尝试使用单位根和外部回归器模拟 Arima 过程时，出现错误。可重现的代码如下：

```
y <- ts(c(3,5,10,13,4,15,13,17,20,24,26,27))
dummy <- data.frame(dummy=c(0,0,0,0,1,0,0,0,0,0,0,0))
arima.1 <- arima(y, order=c(1,1,0), xreg=dummy)

future.dummy <- data.frame(dummy=c(0,0,1,0,0,0,0,0,0,0,0,0))
n <- nrow(future.dummy)

sim.1 <- simulate(arima.1, nsim=n, xreg=future.dummy) 
```

这会产生以下错误消息：

```
Error in array(x, c(length(x), 1L), if (!is.null(names(x))) list(names(x),  : 
  attempt to set an attribute on NULL 
```

我注意到，当我设置`future=FALSE`它时，它工作得很好，但是对于我的问题，我希望能够查看未来的模拟值。我非常想知道问题可能是什么。谢谢。

# java - 使用内部类使用 Builder 模式扩展对象

> ID：13260653
> 
> 赞同：3
> 
> 时间：2012-11-06T22:47:34.467
> 
> 标签：java, inner-classes, builder-pattern

我要做的是创建一个使用 Builder 模式的类 ( )，然后在需要它的对象() 中将`Square`该类扩展为内部类 ( )。`MyCube``DrawMyCube`

出于有点复杂的原因，最好将它们扩展为内部类（对局部变量的引用）。

我试图使示例尽可能简单，因为实际用例太复杂而无法在此处使用：

```
public abstract class Square {
    protected Integer length;
    protected Integer width;

    public abstract static class Builder {
        protected Integer length;
        protected Integer width;

        public abstract Builder length(Integer length);
        public abstract Builder width(Integer width);
    }

    protected Square(Builder builder) {
        this.length = builder.length;
        this.width = builder.width;
    }
} 
```

现在我需要在这里扩展和使用它：

```
public class DrawMyCube {
    private String myText;
    private Integer height;
    private String canvas;
    private MyCube myCube;

    public DrawMyCube(String canvas) {
        this.canvas = canvas;
        myCube = new MyCube.Builder().length(10).width(10).text("HolaWorld").build();
    }

    public void drawRoutine() {
        myCube.drawMe(canvas);
    }

    protected class MyCube extends Square {
        protected String text;

        public static class Builder extends Square.Builder{
            protected String text;

            public Square.Builder length(Integer length) {this.length = length; return this;}
            public Square.Builder width(Integer width) {this.width = width; return this;}
            public Square.Builder text(String text) {this.text = text; return this;}
        }

        protected MyCube(Builder builder) {
            super(builder);
            this.text = text;
        }

        protected void drawMe(String canvas) {
            canvas.equals(this);
        }
    }
} 
```

然而问题是内部类中的静态生成器：

> 成员类型 Builder 不能声明为静态的；静态类型只能在静态或顶级类型中声明。

或者，我可以将内部类创建`MyCube`为常规类，但问题是我无法引用`DrawMyCube`类内部的任何内容（在实际用例中，有很多对这些内容的引用）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T23:00:56.510

静态嵌套类只能在静态上下文中声明，这就是您看到编译器错误的原因。只需将您的 Builder 类声明为相邻`MyCube`（或静态上下文中的其他任何地方，没关系）。例如：

```
public class DrawMyCube {

    protected class MyCube extends Square { }

    public static class MyCubeBuilder extends Square.Builder { }
} 
```

请注意，构建器需要对外部`DrawMyCube`实例的引用才能实例化一个新的`MyCube`. 出于这个原因，您可以将其设为内部（非静态）类`MyCube`：

```
public class DrawMyCube {

    protected class MyCube extends Square { }

    public class MyCubeBuilder extends Square.Builder { }
} 
```

正如你所看到的，我仍然将它声明为相邻，`MyCube`因为将构建器作为其构建的内部类是没有意义的。

**编辑：**正如您所提到的，一个简单的替代方法是使`MyCube`静态：

```
public class DrawMyCube {

    protected static class MyCube extends Square {

        public static class Builder extends Square.Builder { }
    }
} 
```

因为老实说，使用内部类并没有太大的好处——只是隐式的外部实例引用——这会让你保持现有的层次结构和命名约定。您可以自己轻松地实现对外部的引用`DrawMyCube`——它只需要更多的代码。

* * *

作为旁注，您可能想要使用泛型来实现构建器模式，例如`Builder<T>`实现构建`T`. 事实上，没有办法缩小派生构建器类生成的范围。这是我暗示的草图：

```
abstract class Square { }

abstract class SquareBuilder<T extends Square> { }

class MyCube extends Square { }

class MyCubeBuilder extends SquareBuilder<MyCube> { } 
```

# javascript - bigvideo.js 不适用于 Opera 浏览器

> ID：13260655
> 
> 赞同：0
> 
> 时间：2012-11-06T22:47:51.213
> 
> 标签：javascript, jquery, video, background

我使用这个脚本[bigvideo.js](http://dfcb.github.com/BigVideo.js/)但不能在 Opera 浏览器上运行，你能建议一个解决方案吗？

我用这个脚本在 Firefox 中运行它。

```
$(function() {
    var BV = new $.BigVideo({useFlashForFirefox:false});
    BV.init();
    BV.show('vids/river.mp4', {altSource:'vids/river.ogv'});
}); 
```

有什么东西可以在歌剧浏览器上工作吗？我还创建了一个 webm 视频。然后我想在任何浏览器上以循环模式使用它。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-20T11:46:16.783

该帖子较旧，但在网络搜索中的第一场比赛。这是一个简短的歌剧解决方案：

```
$(function() {
    videojs.options.flash.swf = "http://example.org/video/video-js.swf";
    var BV = new $.BigVideo({useFlashForFirefox:false});
    BV.init();
    if (Modernizr.touch) {
        BV.show('http://example.org/video/alternative.jpg');
    } else if (/opera/.test(navigator.userAgent.toLowerCase())){
        BV.show('http://example.org/video/myVideo.oggtheora.ogv', { ambient: true });
    } else {
        BV.show('http://example.org/video/myVideo.mp4', { altSource: 'http://example.org/video/myVideo.oggtheora.ogv', ambient: true });
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-07T22:31:25.390

bigvideo.js 的制造商在这个问题上有这样的说法： [https](https://github.com/dfcb/BigVideo.js/issues/3) ://github.com/dfcb/BigVideo.js/issues/3 遗憾的是，目前还不是真正的解决方案。

# java - 如何在 JScrollPane 中获取水平滚动条

> ID：13260662
> 
> 赞同：5
> 
> 时间：2012-11-06T22:48:16.353
> 
> 标签：java, swing, jpanel, jscrollpane, jfreechart

我有一个似乎无法解决的面板布局问题。我有以下代码：

```
public class Test extends ApplicationFrame {
    public Test(String title) {
        super(title);

        JPanel jpanel = new JPanel();
        jpanel.setPreferredSize(new Dimension(100 * 2, 300));
        jpanel.setBackground(new Color(0xFF0000));

        JScrollPane scrollPane = new JScrollPane(jpanel);
        scrollPane.setBackground(new Color(0xFF0000));
        scrollPane.getViewport().setPreferredSize(new Dimension(100 * 2, 300));

        this.add(scrollPane, BorderLayout.WEST);
        this.setPreferredSize(new Dimension(500, 500));
    }

    public static void main(String args[]) {
        Test test = new Test("Layout Test");
        test.pack();
        RefineryUtilities.centerFrameOnScreen(test);
        test.setVisible(true);
    }
} 
```

创建以下布局：

![在此处输入图像描述](../Images/5f63da0cc5cce5145a6e5682af501920.png)

当我拖动窗口的右侧并将其移至红色`JPanel`和`JScrollPane`时，我希望水平滚动条出现在`JScrollPane`. 但目前窗口只是缩小而不显示水平滚动条。这可能吗？

我想保留它，`BorderLayout.WEST`因为我的用例是在我没有足够大的图表来填充整个窗口时防止 JFreeChart 拉伸。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-07T00:26:28.343

不使用的[原因](https://stackoverflow.com/q/7229226/230513)有很多`setPreferredSize()`，但这里的关键之一是所需的结果*取决于*封闭组件的首选尺寸。尤其，

*   `ChartPanel``FlowLayout`具有由指定的默认值`JPanel`，但图表会忽略此值并进行调整以填充可用空间；您可以覆盖`getPreferredSize()`以选择任何所需的初始几何图形。

*   a 的滚动条`JScrollPane`仅在视口大小小于内容大小时出现。`BorderLayout.WEST`并且`BorderLayout.EAST`不要改变，所以滚动条永远不会出现。

调用`pack()`“导致`Window`其大小以适合其子组件的首选大小和布局。” `pack()`在下面的示例中，为了显示滚动条，人为缩小了框架的大小。`GridLayout`导致两个面板大小相等。调整框架大小以查看效果。

附录：如果您希望 a`ChartPanel`具有固定大小，请将其添加到 a `JPanel`; 默认`FlowLayout`使用首选大小。

[![图片](../Images/8fe4b161abc56921b0bed9dd0ca97cd8.png)](https://i.stack.imgur.com/q4TGR.png)

```
public class ChartPanelTest {

    private static final int N = 64;
    private static final int SIZE = 400;
    private static final Random random = new Random();

    private static XYDataset createDataset() {

        final TimeSeries series = new TimeSeries("Random Data");
        Day current = new Day();
        for (int i = 0; i < N; i++) {
            series.add(current, random.nextGaussian());
            current = (Day) current.next();
        }
        return new TimeSeriesCollection(series);
    }

    private static JFreeChart createChart(final XYDataset dataset) {
        JFreeChart chart = ChartFactory.createTimeSeriesChart(
            "Test", "Day", "Value", dataset, false, false, false);
        return chart;
    }

    public static void main(String[] args) {

        JFrame f = new JFrame();
        f.setLayout(new GridLayout(1, 0));
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        JFreeChart chart = createChart(createDataset());
        f.add(new JScrollPane(new JPanel() {

            {
                setBackground(Color.red);
            }

            @Override
            public Dimension getPreferredSize() {
                return new Dimension(SIZE, SIZE);
            }
        }));
        f.add(new ChartPanel(chart) {

            @Override
            public Dimension getPreferredSize() {
                return new Dimension(SIZE, SIZE);
            }
        });
        f.pack();
        f.setSize(2 * (SIZE - N), SIZE - N);
        f.setLocationRelativeTo(null);
        f.setVisible(true);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:07:31.913

可以办到。你可以声明三个JPanel。一个 JPanel 是带有 BorderLayout 的 contentPanel。设置为您想要滚动条的 JPanel 的preferedSize 和 maximumSize 创建一个 jscroolpane 及其完成：伪代码：

```
JPanel contentPanel = new JPanel(new BorderLayuout());
JPanel jpanel1 = new JPanel(layout--);
JPanel jpanel2 = new JPanel(layout--);
jpanel2.setPreferredSize(..);
jpanel2.setMaximuSize(..);
JScrollPane jsp = new JScroolPane(jpanel2);
contentPanel.add(jpanel1,BorderLayout.WEST);
contentPanel.add(jsp,BorderLayout.CENTER);
this.getContentPane().add(contentPanel); 
```

在我的示例中，滚动条位于中心。如果你想改变

```
contentPanel.add(jsp,BorderLayout.WEST);
contentPanel.add(jpanel1,BorderLayout.CENTER); 
```

# django - 将“照片”表单添加到我的表单以允许用户添加照片

> ID：13260663
> 
> 赞同：0
> 
> 时间：2012-11-06T22:48:29.200
> 
> 标签：django, django-forms, django-models

我想将 Imageform 添加到我的表单中，以允许所有用户添加照片。我已阅读此[https://docs.djangoproject.com/en/dev/ref/forms/fields/#imagefield](https://docs.djangoproject.com/en/dev/ref/forms/fields/#imagefield) 和此[https://docs.djangoproject.com/en/dev/ref/forms/api/#绑定上传的文件](https://docs.djangoproject.com/en/dev/ref/forms/api/#binding-uploaded-files)

但我仍然对如何实现这一目标感到困惑。如何更改我的代码以允许用户从他们自己的文件夹中添加照片？这是我的代码，我还附上了我想要创建的理想表单。

【我的理想形态】

![我的理想形态](../Images/24f70bf93ed77b2b2d11081eb58b7167.png)

模型.py

```
from django.db import models
from django.forms import ModelForm

class Sell(models.Model):
    subject = models.CharField(max_length=100)
    price = models.CharField(max_length=100)
    condition = models.CharField(max_length=100)
    photo = models.ImageField(upload_to="media")
    email = models.EmailField()
    body = models.CharField(max_length=200) 
```

表格.py

```
from django.forms import ModelForm
from uasite1.models import Sell

class SellForm(ModelForm):
    class Meta:
        model = Sell 
```

视图.py

```
from django.shortcuts import render_to_response,get_object_or_404
from django.http import HttpResponseRedirect
from uasite1.forms import SellForm
from uasite1.models import Sell
from django.template import RequestContext

def sell_create(request):
    context = {}
    if request.method == 'POST':
        form = SellForm(request.POST)
        if form.is_valid():            
            new_sell = form.save()
            return HttpResponseRedirect('/sechand/%d/' % new_sell.pk)
    else:
        form = SellForm()
    context['form'] = form
    return render_to_response('sell.html',context,context_instance = RequestContext(request)) 
```

出售.html

```
{% extends 'base.html' %}
{% block extrahead %}
{% endblock %}
{% block content %}

<form enctype="multipart/form-data" action = "/sechand/" method = "post">
    {% csrf_token %}
    {{ form.as_p }}

<input type = "submit" value="Submit" />
</form>

{% endblock%} 
```

sell_display.html（这是显示提交信息的模板。）

```
{% extends 'base.html' %}
{% block content %}
<div id = 'sell'>

    <h3> Product Name : [ {{ sell.subject }}]</h3>
    <p>Photo{{ sell.photo }}</p>
    <p>Price: [ {{ sell.price }} ]</p>
    <p>Condition: [ {{ sell.condition }} ]</p>
    <p>Comments: [ {{sell.body}} ]</p>
    <p>Contact Email:[ {{ sell.email }} ]</p>
</div>
{% endblock %} 
```

网址.py

```
from django.conf.urls import patterns, include, url
from django.conf.urls.static import static
from django.conf import settings
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
    url(r'^sechand/$','uasite1.views.sell_create'),
    url(r'^sechand/(?P<pk>\d+)/$', 'uasite1.views.sell_detail'),
    url(r'^products/electronics/$', 'uasite1.views.Electronics'),
    url(r'^products/$', 'uasite1.views.ProductsAll'),
    url(r'^admin/', include(admin.site.urls)),
)+ static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:28:28.050

我没有仔细阅读您的整个代码，但我注意到 1 个重要错误，视图应具有以下内容：

```
form = SellForm(request.POST, request.FILES) 
```

另外，这一行：

```
<p>Photo{{ sell.photo }}</p> 
```

我不认为这是展示照片的方式，我会放一个链接到照片做：

```
<p>Photo{{ sell.photo.url }}</p> 
```

最后，对于开发环境，您可能希望提供媒体文件，因此只需将此行添加到您的主 urls.py 文件中：

```
from django.conf.urls.static import static
from django.conf import settings

urlpatterns = patterns('',
# your url patterns in here 
```

) + 静态(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)

编辑：

[提供媒体文件](http://www.muhuk.com/2009/05/25/serving-static-media-in-django-development-server.html#.UJsxE7TA-0w)。该链接应该给你一个很好的概述，我知道这很令人困惑，所以我会给你一个例子，就像我在我的项目中所做的那样。首先是我在settings.py中的做法：

```
#settings.py
from os.path import dirname, join, realpath
# have in mind that I have settings.py under project_root/project/settings.py
# so you probably want to check your path to your project root folder first
ROOT_DIR = realpath(join(dirname(__file__), '..'))
MEDIA_ROOT = realpath(join(ROOT_DIR, 'media'))
MEDIA_URL = '/media/'
STATIC_URL = '/static/'
STATICFILES_DIRS = (
    join(ROOT_DIR, "static"),
) 
```

我就是这样做的，你可以找到很多也有效的方法。为了给您更好的线索，我的文件夹如下所示：

```
project_root/
    media/
    static/
    project/
        settings.py 
```

# python - Python 3.3，在while循环中返回最小值

> ID：13260666
> 
> 赞同：2
> 
> 时间：2012-11-06T22:48:39.303
> 
> 标签：python, loops, while-loop, minimum

我正在尝试使用牛顿法返回 k 平方根的最小值。

```
k=float(input("Number? "))
x = k/2

def newton(x):
    while abs(x**(1/2)- k) >= 10**(-10):
        if k >= 0:
            x = (x+k/x)/(2)
            return x
        elif k < 0:
            raise ValueError ("Cannot take the square root of a negative number")

print ("The approximate square root of", k, "is", newton(k))
print ("The error is", abs(x**(1/2)- k)) 
```

但是，上面的代码只返回第一次迭代。例如，如果 k 为 2，则牛顿法的精确平方根应为 1.41422，即第三次迭代。但是，代码当前返回 1.5，即第一次迭代。如何返回更准确的 1.41422 而不是 1.5 的平方根？同样，错误需要反映这种变化。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-06T22:50:44.500

您需要将`return`语句放在循环之外，否则它将始终在第一次迭代时返回：

```
def newton(x):
    while abs(x**(1/2)- k) >= 10**(-10):
        if k >= 0:
            x = (x+k/x)/(2)
        elif k < 0:
            raise ValueError ("Cannot take the square root of a negative number")
    return x 
```

请注意，像这样使用全局范围内的变量是灾难的根源，它不清楚并且意味着您不能轻松地使用您的函数。而是将其作为参数传递。

也不可能`k`在循环内部进行更改，因此您可以在开始时进行一次检查，而不是在每次迭代时进行检查：

```
def newton(x, k):
    if k < 0:
            raise ValueError ("Cannot take the square root of a negative number")
    while abs(x ** (1 / 2) - k) >= 10 ** (-10):
        x = (x + k / x) / 2
    return x 
```

# linux - 如何开始编写合成 WM？

> ID：13260667
> 
> 赞同：8
> 
> 时间：2012-11-06T22:48:39.150
> 
> 标签：linux, x11, clutter, compositing

我想写一个基本的硬件加速窗口管理器，所以我一直在寻找一些关于如何开始的文档，但我只找到[了这个教程](http://wingolog.org/archives/2008/07/26/so-you-want-to-build-a-compositor)，它使用了一个过时版本的 Clutter 并且不会使用当前可用的任何版本构建。是否有任何其他好的资源可以做到这一点，或者，一个真正简单的合成 WM 来查看其来源？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-12T06:03:12.187

您的问题有两个部分：1）如何编写 WM 2）如何编写复合管理器

一些有助于理解第二部分的链接（除了 xcompmgr 源）：

*   [http://www.talisman.org/~erlkonig/misc/x11-composite-tutorial/](http://www.talisman.org/~erlkonig/misc/x11-composite-tutorial/)（使用Qt，但非常通用和低级）
*   [https://github.com/gustavosbarreto/compmgr](https://github.com/gustavosbarreto/compmgr)
*   [http://projects.mini-dweeb.org/projects/unagi](http://projects.mini-dweeb.org/projects/unagi)

窗口管理器，“第一部分”：

*   我在 JavaScript 中有简单的 ~100 loc wm：[https ://github.com/sidorares/node-x11/blob/master/examples/windowmanager/wm.js](https://github.com/sidorares/node-x11/blob/master/examples/windowmanager/wm.js)
*   另一个极简主义 wm（C 语言），可以作为参考：[https ://code.google.com/p/winmalist/](https://code.google.com/p/winmalist/)
*   最重要的关键字：`SubstructureRedirect`事件掩码。[这里](http://menehune.opt.wfu.edu/Kokua/Irix_6.5.21_doc_cd/usr/share/Insight/library/SGI_bookshelves/SGI_Developer/books/XLib_PG/sgi_html/ch16.html#S1-1002-16-2)有一些文档

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-07T01:34:03.380

最初的演示合成管理器是[xcompmgr](http://cgit.freedesktop.org/xorg/app/xcompmgr/)，我建议使用它来了解底层 X 扩展。

如果您使用 OpenGL 进行硬件加速渲染，则需要阅读`EXT_texture_from_pixmap`扩展程序以避免通过用户空间复制窗口内容。该扩展允许您对这些副本使用硬件加速的 blit。

您可能还会对[_NET_WM_SYNC_REQUEST](http://standards.freedesktop.org/wm-spec/1.3/ar01s06.html)的规范感兴趣，以允许与垂直回溯同步的无撕裂渲染。

# excel - Excel/Magento。CSV

> ID：13260669
> 
> 赞同：1
> 
> 时间：2012-11-06T22:48:42.893
> 
> 标签：excel, magento, vba

我有一个大问题。我对建立一个 Magento 网站感到非常压力，它通过 csv 处理导入的方式令人费解！

我基本上没有接受过 VBA 培训，但我认为它可以帮助我完成这项工作。问题在于多字段csv。我有一个名为**size**的列标题。下面我需要 7 列具有固定值：38、39、40、...、44 我当前的 csv 使用单行。所以我需要多行，只是 size 列中的单元格完成了这些值。前任：

```
HEADER1  HEADER2 HEADER3 SIZE         HEADER 4
Value    Value   Value   38,39, etc   Value
Value2   Value2  Value2  38,39, etc   Value2

I Need This:

HEADER1  HEADER2 HEADER3 SIZE         HEADER 4
Value    Value   Value   38           Value
                         39
                         40
                         41
Value2   Value2  Value2  38           Value2
                         39
                         40
                         41 
```

我找到了一个脚本

```
Sub InsertARow()
 'make new row
ActiveCell.EntireRow.Insert Shift:=xlDown
 'copy the row above
ActiveCell.Offset(-1, 0).EntireRow.Copy Cells(ActiveCell.Row, 1)
On Error Resume Next
 'clear every cell in the new line that does not have a formula
ActiveCell.EntireRow.SpecialCells(xlCellTypeConstants, 23).ClearContents
End Sub 
```

这会在当前选择上方插入 X 行。有什么方法可以对选择中的所有单元格执行此操作吗？自动完成将处理其余部分。我在想类似的东西

```
for i:=1 to n do 
    j:=i+7(the number of sizes i need to display) -> insert the above code for that cell. 
```

实际完成由 Excel 处理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T14:30:36.923

您的问题与以下问题基本相同，因此您可能希望将我的解决方案应用于您的情况 - 这样做应该不难。

[Excel如何将单元格分割成一行](https://superuser.com/q/486294/160170)

[Excel/VBA 细分字段](https://stackoverflow.com/q/13126533/1370465)

# asp.net - VIsual Studio 2010 设计模式错误创建控件（未设置对象引用）

> ID：13260670
> 
> 赞同：1
> 
> 时间：2012-11-06T22:48:44.303
> 
> 标签：asp.net, visual-studio-2010, designmode

自 1.1 / 2003 升级到 .NET 4.0 / VS 2010 以来，设计模式在整个站点范围内都存在这个问题。

有很多可以用谷歌搜索的，我已经尝试过了。我错过了什么？

- 尝试从 Visual Studio 的另一个实例进行调试：[错误创建控件 vs2010 MasterPage](https://stackoverflow.com/questions/3159427/error-creating-control-vs2010-masterpage) - 关于它应该如何工作的细节并不多。我启动了另一个 VS2010 的空实例并附加到 devenv.exe。设置调试-> 全部中断。在 VS 的网站实例中切换到设计模式。以调试模式运行 VS 的网站实例。什么都没发生。我希望这会有所帮助，因为我在*页面*中有一些用户控件。不过我找不到他们有什么问题。我能否获得有关如何准确进行此类调试的更多详细信息？有关 .aspx 源代码，请参见本文末尾。

- 注释掉页面标签中的一些 <% =Session["Username"]%> 垃圾，因为显然访问会话内容可能会导致这种情况

-检查了动态添加控件或访问未实例化对象的 OnInit() 方法。很干净：

```
#region Web Form Designer generated code
      override protected void OnInit(EventArgs e)
      {
          //
          // CODEGEN: This call is required by the ASP.NET Web Form Designer.
          //
          InitializeComponent();
          base.OnInit(e);
      }

      /// <summary>
      /// Required method for Designer support - do not modify
      /// the contents of this method with the code editor.
      /// </summary>
      private void InitializeComponent()
      {    
          this.cboURLFunction.SelectedIndexChanged += new System.EventHandler(this.cboURLFunction_SelectedIndexChanged_1);
          this.cboStandard.SelectedIndexChanged += new System.EventHandler(this.cboStandard_SelectedIndexChanged);
          this.cboType.SelectedIndexChanged += new System.EventHandler(this.cboType_SelectedIndexChanged);
          this.chkLegacy.CheckedChanged += new System.EventHandler(this.chkLegacy_CheckedChanged);
          this.btnRoute.Click += new System.EventHandler(this.btnRoute_Click);
          this.Load += new System.EventHandler(this.Page_Load);

      }
      #endregion 
```

.aspx 页面源（精简）：

```
<%@ Page language="c#" Codebehind="addRoute.aspx.cs" AutoEventWireup="false" Inherits="HTP.RHIO.WebPortal.addRoute" %>
<%@ Register TagPrefix="HeaderControl" TagName="ucHeader" Src="ucHeader.ascx" %>
<%@ Register TagPrefix="TopMenu" TagName="ucTopMenu" Src="ucTopMenu.ascx" %>
<%@ Register TagPrefix="uc1" TagName="ucHelpLink" Src="ucHelpLink.ascx" %>
<HTML>
    <HEAD>
        <title>Add Route -
            <% =Session["Domain"]%>
            <% =Session["Username"]%>
        </title>
        <meta content="Microsoft Visual Studio .NET 7.1" name="GENERATOR">
        <meta content="C#" name="CODE_LANGUAGE">
        <meta content="JavaScript" name="vs_defaultClientScript">
        <meta content="http://schemas.microsoft.com/intellisense/ie5" name="vs_targetSchema">
        <link href="./style/WebPortalMain.css" type="text/css" rel="stylesheet">
        <script type="text/javascript">
            function jvsValidate() {
    (removed for brevity)
            }               
        </script>
    </HEAD>
    <body leftmargin="5" topmargin="0" rightmargin="5">
        <form id="Form1" method="post" runat="server" onsubmit="return jvsValidate() ;">
            <table id="Table1" class="tableWidth" cellspacing="0" cellpadding="0" border="0">
                <!-- BEGIN HEADER ROW -->
                <tr>
                    <td class="headerSection" colspan="3"><HeaderControl:ucHeader id="UcHeader1" runat="server"></HeaderControl:ucHeader></td>
                </tr>
                <!-- END HEADER ROW -->
                <!-- BEGIN TOP NAV (IF NECCESSARY) -->
                <tr>
                    <td class="topNavSection" colspan="3">
                        <table cellspacing="0" cellpadding="0" width="100%" border="0">
                            <tr>
                                <td style="WIDTH: 857px"><TopMenu:ucTopMenu id="UcTopMenu1" runat="server" xmlfilename="./MenuFiles/menu.xml" xslfilename="./MenuFiles/menu.xsl"></TopMenu:ucTopMenu></td>
                                <td align="right" width="15%"><uc1:ucHelpLink id="UcHelpLink1" runat="server"></uc1:ucHelpLink></td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
            <br>
            <table id="Table2" class="tableWidth" cellspacing="0" cellpadding="0" border="0">
                <tr>
                    <td colspan="3"><img src="graphics/servicers_routes.gif"></td>
                    <td align="right">
                        <asp:hyperlink id="backLink" runat="server">
                            <img src="./graphics/back.gif" border="0"></asp:hyperlink></td>
                </tr> 
```

. . 等等 。

```
 </table>
            <!-- END MAIN BODY SECTION --></form>
    </body>
</HTML> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-11T21:38:43.783

你会在那里找到你的答案：http: [//blogs.msdn.com/b/webdev/archive/2010/05/06/another-error-creating-control-in-the-design-view-with-object-reference -not-set-in-visual-studio-2010.aspx](http://blogs.msdn.com/b/webdev/archive/2010/05/06/another-error-creating-control-in-the-design-view-with-object-reference-not-set-in-visual-studio-2010.aspx)

# c# - 自动将 System.diagnostics.trace 消息记录到 Nlog 目标

> ID：13260672
> 
> 赞同：14
> 
> 时间：2012-11-06T22:48:48.343
> 
> 标签：c#, trace, nlog, system.diagnostics

假设您在整个应用程序中都有 C# 跟踪消息。就像是：

```
Trace.TraceInformation("Service Started"); 
```

如何自动将其记录到 nLog 目标，而无需向所有具有跟踪消息的类添加如下代码？

```
using NLog;
private static Logger logger = LogManager.GetCurrentClassLogger(); 
```

有没有办法在不包括 .NET Framework 本身产生的跟踪的情况下做到这一点，[本文](http://nlog-project.org/2010/09/02/routing-system-diagnostics-trace-and-system-diagnostics-tracesource-logs-through-nlog.html)演示了如何做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-08-12T03:05:54.790

这适用于没有明确来源的情况。

```
 <system.diagnostics>
      <trace autoflush="true" indentsize="4">
        <listeners>
          <add name="MyNLogTraceListener" type="NLog.NLogTraceListener, NLog" />
          <remove name="Default" />
        </listeners>
      </trace>
  </system.diagnostics> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-07T15:46:08.657

您可以使用 NLog 的[NLogTraceListener](https://nlog-project.org/2010/09/02/routing-system-diagnostics-trace-and-system-diagnostics-tracesource-logs-through-nlog.html)。

为了完整起见，这里是 System.Diagnostics 配置（来自上面的链接）来指定 NLogTraceListener：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.diagnostics>
    <sources>
      <source name="System.Net" switchValue="All">
        <listeners>
          <add name="nlog" />
        </listeners>
      </source>
      <source name="System.Net.Sockets" switchValue="All">
        <listeners>
          <add name="nlog" />
        </listeners>
      </source>
    </sources>
    <sharedListeners>
      <add name="nlog" type="NLog.NLogTraceListener, NLog" />
    </sharedListeners>
  </system.diagnostics>
</configuration> 
```

您还需要配置 NLog 以告诉它在从 System.Diagnostics.Trace 移动到 NLog 后如何写入信息：

```
<nlog>
  <targets>
    <target name="console" type="ColoredConsole" layout="${longdate} ${windows-identity} ${message}" />
  </targets>

  <rules>
    <logger name="*" minlevel="Trace" writeTo="console" />
  </rules>
</nlog> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-13T23:12:33.797

您可以在`App.config`

```
 <system.diagnostics>

    <sources>
      <source name="System" switchValue="All">
        <listeners>
          <add name="nlog" />
        </listeners>
      </source>
    </sources>

    <sharedListeners>
      <add name="nlog" type="NLog.NLogTraceListener, NLog" />
    </sharedListeners>

    <trace autoflush="true" indentsize="4">
      <listeners>
        <add name="nlog" />
        <remove name="Default" />
      </listeners>
    </trace>

  </system.diagnostics> 
```

# perl - 铅安装 Date::Manip 与 cpan

> ID：13260673
> 
> 赞同：1
> 
> 时间：2012-11-06T22:48:49.233
> 
> 标签：perl, cpan

我正在为一天的安装日期而苦苦挣扎：使用 cpan（我正在使用 os x）。我总是收到这个消息

```
Warning: prerequisite Test::Inter 0 not found.
Bareword found where operator expected at ./Makefile.PL line 1, near "30 mtime"
    (Missing operator before mtime?)
Number found where operator expected at ./Makefile.PL line 2, near "30"
    (Missing semicolon on previous line?)
Bareword found where operator expected at ./Makefile.PL line 2, near "30 atime"
    (Missing operator before atime?)
Number found where operator expected at ./Makefile.PL line 3, near "30"
    (Missing semicolon on previous line?)
Bareword found where operator expected at ./Makefile.PL line 3, near "30 ctime"
    (Missing operator before ctime?)
ERROR from evaluation of /Users/mehdibenchoufi/.cpan/build/SBECK-QEN4kY/Date-Manip-6.36/Makefile.PL: ERROR from evaluation of /Users/mehdibenchoufi/.cpan/build/SBECK-QEN4kY/Date-Manip-6.36/PaxHeaders.11917/Makefile.PL: syntax error at ./Makefile.PL line 1, near "30 mtime"
Warning: No success on command[/opt/local/bin/perl5.12 Makefile.PL]
'YAML' not installed, will not store persistent state
  SBECK/Date-Manip-6.36.tar.gz
  /opt/local/bin/perl5.12 Makefile.PL -- NOT OK
Running make test
  Make had some problems, won't test
Running make install
  Make had some problems, won't install
Failed during this command:
 SBECK/Date-Manip-6.36.tar.gz                 : writemakefile NO '/opt/local/bin/perl5.12 Makefile.PL' returned status 65280 
```

有谁知道如何调试？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T19:43:14.840

我遇到了同样的问题，这些步骤对我有用：

```
> sudo cpan
cpan[1]> install CPAN
cpan[2]> exit
> sudo rm -rf ~/.cpan/build/SBECK-*
> sudo cpan Date::Manip 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T17:44:52.080

首先安装 YAML.pm 和 Test::Iter.pm

但。你可能不想弄乱 OS X 上的系统 perl。

您可能需要认真考虑使用 perlbrew 来管理本地安装的 perl 及其自己的模块集，与系统安装分开。

# c++ - Ubuntu 上的 Boost::system 链接错误

> ID：13260675
> 
> 赞同：1
> 
> 时间：2012-11-06T22:48:50.843
> 
> 标签：c++, boost, linker-errors

我正在尝试编译以下实现上下文树切换的 c++ 代码（[下载页面上的更多信息](http://jveness.info/software)）：

[压缩档案，0.2 MB](http://jveness.info/software/cts-v1.zip)

这需要一些 boost 库。我从 boost.org 下载了最新版本，并按照网站上的说明构建了所有需要构建的库。我还修改了存档中包含的 makefile 以添加 boost lib 路径和 boost_system，但仍然出现错误。这是我正在使用的makefile：

```
PROGRAM = cts
SOURCES = $(wildcard *.cpp)
OBJECTS = $(SOURCES:.cpp=.o)
CFLAGS = -Wall
LDFLAGS = -lboost_program_options -lboost_filesystem -lboost_system

$(PROGRAM): $(OBJECTS) Makefile
    g++ $(CFLAGS) -L/home/users/mnembrini/opt/boost/lib $(LDFLAGS) -o $(PROGRAM) $(OBJECTS)

# Include known dependecies from -MMD
#-include $(OBJECTS:.o=.d)

%.o: %.cpp
    g++ -MMD $(CFLAGS) -I/home/users/mnembrini/opt/boost/include -c $<

clean:
    rm -f $(OBJECTS) *.d

.PHONY: clean 
```

boost 在 ~/opt/boost 中（包含 lib 并包含子目录）。这是链接错误：

```
mnembrini@meem:~/src/cts-v1 $ make
g++ -MMD -Wall -I/home/users/mnembrini/opt/boost/include -c ac.cpp
g++ -MMD -Wall -I/home/users/mnembrini/opt/boost/include -c cts.cpp
cts.cpp: In member function ‘virtual void SwitchingTree::update(bit_t)’:
cts.cpp:402:12: warning: variable ‘snc’ set but not used [-Wunused-but-set-variable]
cts.cpp: In member function ‘virtual double SwitchingTree::prob(bit_t)’:
cts.cpp:432:12: warning: variable ‘snc’ set but not used [-Wunused-but-set-variable]
g++ -MMD -Wall -I/home/users/mnembrini/opt/boost/include -c ctw.cpp
g++ -MMD -Wall -I/home/users/mnembrini/opt/boost/include -c icsilog.cpp
g++ -MMD -Wall -I/home/users/mnembrini/opt/boost/include -c main.cpp
g++ -MMD -Wall -I/home/users/mnembrini/opt/boost/include -c PowFast.cpp
g++ -Wall -L/home/users/mnembrini/opt/boost/lib -lboost_program_options -lboost_filesystem -lboost_system -o cts ac.o cts.o ctw.o icsilog.o main.o PowFast.o
cts.o: In function `__static_initialization_and_destruction_0(int, int)':
cts.cpp:(.text+0x1743): undefined reference to `boost::system::generic_category()'
cts.cpp:(.text+0x174f): undefined reference to `boost::system::generic_category()'
cts.cpp:(.text+0x175b): undefined reference to `boost::system::system_category()'
ctw.o: In function `__static_initialization_and_destruction_0(int, int)':
ctw.cpp:(.text+0xfcf): undefined reference to `boost::system::generic_category()'
ctw.cpp:(.text+0xfdb): undefined reference to `boost::system::generic_category()'
ctw.cpp:(.text+0xfe7): undefined reference to `boost::system::system_category()'
main.o: In function `showHelp()':
main.cpp:(.text+0x1c): undefined reference to `boost::program_options::operator<<(std::basic_ostream<char, std::char_traits<char> >&, boost::program_options::options_description const&)'
main.o: In function `initOptions(int, char**, boost::program_options::variables_map&)':
main.cpp:(.text+0x10f): undefined reference to `boost::program_options::options_description::add_options()'
main.cpp:(.text+0x129): undefined reference to `boost::program_options::options_description_easy_init::operator()(char const*, char const*)'
main.cpp:(.text+0x13e): undefined reference to `boost::program_options::options_description_easy_init::operator()(char const*, boost::program_options::value_semantic const*, char const*)'
main.cpp:(.text+0x153): undefined reference to `boost::program_options::options_description_easy_init::operator()(char const*, boost::program_options::value_semantic const*, char const*)'
main.cpp:(.text+0x166): undefined reference to `boost::program_options::options_description_easy_init::operator()(char const*, boost::program_options::value_semantic const*, char const*)'
main.cpp:(.text+0x1d6): undefined reference to `boost::program_options::store(boost::program_options::basic_parsed_options<char> const&, boost::program_options::variables_map&, bool)'
main.cpp:(.text+0x200): undefined reference to `boost::program_options::notify(boost::program_options::variables_map&)'
main.o: In function `__static_initialization_and_destruction_0(int, int)':
main.cpp:(.text+0x1f13): undefined reference to `boost::system::generic_category()'
main.cpp:(.text+0x1f1f): undefined reference to `boost::system::generic_category()'
[snip (2-3 screens like above)]
collect2: ld returned 1 exit status
make: *** [cts] Error 1 
```

我在 Ubuntu 12.04 64 位上使用 Gcc 4.6.3。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T23:01:24.993

将所有库放在命令行中的所有目标文件之后。与其他一些操作系统不同，这里的顺序很重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:22:01.840

你需要（就像 nm 之前写的那样）确保你有正确的链接顺序。基本上，一些实现关心你链接对象的顺序，还有库。

如果您链接的库尚未被以前的代码引用，它将被丢弃。我记得想出了一个解决方案，通过引用相同的符号但在第一个之后链接的对象中，然后重新链接另一个库版本来破解程序中的不同（版本）库：

```
-lyourprojwantingv1 -llibraryofv1 -lyourprojwantingv2 -llibraryofv2 
```

我个人认为这一切都只是疯狂！（所有的！）

# ruby-on-rails - Devise什么时候存储stored_location_for_resource的位置

> ID：13260676
> 
> 赞同：3
> 
> 时间：2012-11-06T22:48:56.283
> 
> 标签：ruby-on-rails, authentication, redirect, devise

当该页面需要登录时，我在重定向到上次访问的页面时遇到问题，并且有人指出您可以在此处遵循代码示例：[https :](https://github.com/plataformatec/devise/wiki/How-To%3A-redirect-to-a-specific-page-on-successful-sign-in) [//github.com/plataformatec/devise/wiki/How](https://stackoverflow.com/questions/13257269/devise-resetting-session-on-login) [-To%3A-redirect-to-a-specific-page-on-successful-sign-in](https://github.com/plataformatec/devise/wiki/How-To%3A-redirect-to-a-specific-page-on-successful-sign-in)

该示例调用`stored_location_for(resource)`...该集合在哪里？

`before_filter :authenticate_user!`该示例与我适当的控制器中的 a 结合使用时效果很好。查看源代码`authenticate_#{resource}!`，[https://github.com/plataformatec/devise/blob/master/lib/devise/controllers/helpers.rb](https://github.com/plataformatec/devise/blob/master/lib/devise/controllers/helpers.rb)它似乎没有保存位置。

以前的位置存储在世界的哪个位置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T23:05:04.747

路径存储在`session["user_return_to"]`（假设`user`是您的模型名称）。

这似乎是`store_location!`在[failure_app.rb中设置的](https://github.com/plataformatec/devise/blob/master/lib/devise/failure_app.rb#L175)

请注意，如果您只有一个设计模型，则登录重定向应该会自动工作，而无需`after_sign_in_path_for`在`application_controller.rb`.

# eclipse - Eclipse 无法识别环境变量（Mac OS Lion、Eclipse Juno 64-BIT）

> ID：13260677
> 
> 赞同：2
> 
> 时间：2012-11-06T22:48:56.643
> 
> 标签：eclipse, osx-lion, cocos2d-x

在尝试使用 Eclipse 设置 C++/Java 构建时，我需要一些帮助。我正在关注本教程（[http://www.raywenderlich.com/11283/cocos2d-x-for-ios-and-android-getting-started](http://www.raywenderlich.com/11283/cocos2d-x-for-ios-and-android-getting-started)），但只是不明白为什么我不断收到“请定义 NDK_ROOT”。

我更新了 create-android-project.sh 文件并在终端中应用了这个 cmd：export NDK_ROOT="与 create-android-project.sh 文件中的 NDK 相同的路径"。当我运行“create-android-project.sh”时，创建项目没有问题，运行新创建的项目的 build_native.sh 也遇到任何问题。

因此，按照将“构建命令”从默认值更新为教程要求的步骤后，应该编译项目中的 C++ 和 Java 文件，而无需在终端中运行 build_native.sh 并在 Eclipse 中运行项目。

如果我删除自定义构建以默认所有编译并在模拟器和设备上的项目上运行。

我附上了项目构建的设置和控制台日志的屏幕截图。

开发环境：Mac OS 10.8 (Lion) Eclipse Juno 64-BIT Cocos2d-x v2.0-x-2.0.3 NDK：android-ndk-r7-crystax-5.beta2

请指教。![在此处输入图像描述](../Images/8aaf9d8128b9b4f87dfe78c14313ad24.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-04-11T13:09:30.267

我通过将 NDK_ROOT 变量添加到 ADT > Preferences > C/C++ > Build > Build Variables 解决了这个问题。

![在此处输入图像描述](../Images/f5c7b0b5c1daf1e3b2001f352327a51a.png)

希望它可以帮助某人，我知道我一直在寻找解决方案很长一段时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-03T06:20:51.597

实际上你不需要在 C/C++ build-> Environment 中设置它。

像这样。它最终对我有用。

参考这张图进行配置

![配置](../Images/716248ec9f1f57d5987466eb67946828.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-24T13:00:07.093

此错误与**eclipse**无关。它告诉**NDK_ROOT 没有在 build_native.sh**文件中定义。我通过在 build_native.sh 文件顶部添加 NDK_ROOT 解决了这个问题

**build_native.sh**

```
NDK_ROOT="path of your ndk " 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T16:44:41.507

在你的 Eclipse 的左侧窗格中，我可以读到 Resources,Android ..etc

在 Android 中，将有一个选项来设置 NDK 路径

Eclipse -> Window -> Preferences -> Android -> NDK -> 设置 NDK 的路径

这和你为 android SDK 做的一样，这里你必须指定 NDK 路径......

编辑：

如果您仍然遇到问题......那么这与我在为我的 Windows 版本设置时遇到的问题相同

用于导出 NDK_Path 的 android ndk 版本存在问题 .... 您可以尝试使用适用于 android 的 crystax ndk 版本，它肯定会工作

任何更多帮助，请随时询问

# sed - 替换模式前行中的文本

> ID：13260680
> 
> 赞同：0
> 
> 时间：2012-11-06T22:49:08.130
> 
> 标签：sed, pattern-matching

我有这样的文字

```
5834589
  MDL-BLABLABLA1
bla-bla2
bla-bla3
bla-bla4
bla-bla5 
```

我想用模式 MDL 将*前*行中的 5834589（数字）替换为EXAMPLE-RIVER-5834589（只需添加EXAMPLE-RIVER-）。

对 sed 有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:33:52.353

这可能对您有用（GNU sed）：

```
sed '$!N;s/^.*\n.*MDL/EXAMPLE-RIVER-&/;P;D' file 
```

# objective-c - DDMathParser 从 NSString 创建表达式

> ID：13260682
> 
> 赞同：0
> 
> 时间：2012-11-06T22:49:14.380
> 
> 标签：objective-c, ios

我有一个`NSString`：

n + (n - m)

我可以使用 DDMathParser 创建表达式对象吗？

例如，我有基本表达式 n + (n - m)，但我需要能够将基本表达式 n + (n - m) 与用户表达式 (n - m) + n 进行比较，这通常也是相同的。

或者是否已经制定了解决方案如何比较两个 NSString 考虑符号和大括号？

所以我的意思是我可以例如用一个字符串初始化两个表达式，然后使用某种方法像 Expression1 = Expression2 一样比较它。

这是表达式如何在解析器中查看的示例

![在此处输入图像描述](../Images/3e9455fea0e2e04616c8ba76e3aeb06d.png)

所以这是同一个结构，我们可以使用左右节点进行比较。树的。我很高兴找到这个将字符串解析为表达式树的解决方案。我认为这个解决方案已经完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T17:45:53.733

是的，您可以使用 DDMathParser 来执行此操作：

```
NSString *string = @"5 + (5 - 3)";
NSError *error = nil;
DDExpression *expression = [DDExpression expressionFromString:string error:&error];

if (expression) {
  NSLog(@"%@", expression)
} else {
  NSLog(@"%@", error);
} 
```

[DDMathParser 确实对表达式重写](https://github.com/davedelong/DDMathParser/wiki/Rewriting-Expressions)有一些（基本的）支持，但除此之外，您可以自己比较表达式树。

# c# - 如何从 Windows 窗体中删除默认控制按钮

> ID：13260688
> 
> 赞同：3
> 
> 时间：2012-11-06T22:49:28.140
> 
> 标签：c#, .net, winforms, visual-studio-2010, controls

该图像描述了我正在尝试做的事情。

我有一个运行良好的“连接四个”游戏，但我想删除窗口右上角提供的默认按钮。对此有任何快速帮助吗？

![在此处输入图像描述](../Images/302cb1db0487b41e84e9693376d6b344.png)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-12-18T10:29:49.143

[点击此处查看视频中的步骤](https://youtu.be/_l74Vix_MqA)

**请将您的愿望表单的 ControlBox 值设置为“False”。**
![在此处输入图像描述](../Images/c675efb2f539198f6e0136f3d2ced8b4.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-06T22:52:50.193

Forms的`ControlBox`属性在隐藏 Minimize 和 Maximize 按钮后执行此操作。

[MSDN - Form.ControlBox 属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.controlbox.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T22:52:13.630

在表单设计器的属性窗口中，应该有一个 MaximizeBox 和 MinimizeBox 列表，您可以将其设置为 false 以禁用表单上的最大化和最小化按钮。AFAIK 没有办法禁用关闭按钮。

# c# - 最佳实践：将应用程序转换为具有计划的服务

> ID：13260691
> 
> 赞同：3
> 
> 时间：2012-11-06T22:49:44.067
> 
> 标签：c#, service, xmlhttprequest

就编程而言，我有点初学者。看着堆栈溢出，我还没有找到任何可以完全回答我的问题的东西。我创建了一个 C# 控制台应用程序，用于将 XML 文件推送到我无法控制的 Web 服务。它通过创建一个 http webrequest 来做到这一点。该服务可能会在 windows server 2008 或 win 7 变体上运行。开发是在 VS 2010 中完成的。我的最终目标是每天运行该程序两次，用户参与度极低。有人告诉我，服务是做到这一点的最佳方式。我知道服务不接受用户输入，并且输出通常是日志文件。我的控制台应用程序不接受用户输入，但必须具有 CRUD 文件的能力。因为它会创建一个 XMl 文件，然后将其读取到 Web 请求中。

我有两个问题：

问题 1：我希望此服务每 12 小时调用一次应用程序，使用服务来确定何时运行应用程序是否更可靠/更好的做法？或者使用windows的内置调度程序，或者像quark这样的.net解决方案？我正在寻找可靠性，以及很少的用户参与。一种一成不变的交易。

问题 2：对于转换我的程序，建议的最佳做法是什么？信息：我之前创建了一个空的 Windows 服务，我想将我的应用程序折叠到其中。（这是通过教程完成的，该服务包含服务所需的所有内容，但它没有做任何事情......但是！OnStart、OnStop、安装程序等）最好的方法是什么？我应该在服务的 OnStart() 方法中调用我的应用程序吗？我们应该将应用程序作为 dll 添加到服务中。并不是我认为我做不到。这只是我对此事的搜索似乎指出最好从服务开始并添加一些代码。我的目标是尽量减少转换此应用程序所需的代码。

谢谢你的帮助，克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:25:05.543

问题一：个人一天跑两次好像是定时任务类型的操作

问题2：我将其描述为：或多或少地将主体`static void Main(string[] args)`放入`OnStart`方法中。然后还创建一个计时器`OnStart`，将在您的课程中调用触发器函数。但是后来我只是偶然发现了编写 Windows 服务的方式，所以我不能 100% 确定这个建议......

一个考虑因素可能是在此过程中*任何*失败的风险是什么？如果有可能发生未处理的异常，则服务将终止，并且需要特殊设置来重新启动它或完成要编码的错误处理。计划任务将始终在下一个触发间隔自动重试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T23:11:09.483

我喜欢由调度程序运行的独立程序，因为它们更容易编写和测试。

当服务必须一直运行时，服务会更合适......比如说监控某些东西。

# c# - SpecialNameAttribute 还允许哪些其他巧妙的技巧？

> ID：13260695
> 
> 赞同：9
> 
> 时间：2012-11-06T22:50:09.313
> 
> 标签：c#, vb.net, compiler-construction, attributes

在研究实现 Visual Basic Power ( ) 运算符[的问题](https://stackoverflow.com/questions/13259162/vb-net-power-operator-overloading-from-c-sharp)`^`时，我了解到[`System.Runtime.CompilerServices.SpecialNameAttribute`](http://msdn.microsoft.com/en-us/library/System.Runtime.CompilerServices.SpecialNameAttribute.aspx)该类允许在 C# 中实现此运算符以在 VB 中使用。

有趣的是，[文档](http://msdn.microsoft.com/en-us/library/System.Runtime.CompilerServices.SpecialNameAttribute.aspx)指出：

> **SpecialNameAttribute**类当前未在 .NET Framework 中使用，但保留供将来使用。

我的问题是：使用此属性时还有哪些巧妙的技巧可用？

（附带问题 - 文档是否不准确，或者这是一个语义问题，因为该属性显然由*编译器*使用，但不是*框架*？）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-07T15:42:18.737

正如您在查看从该代码生成的 IL 时所知道的那样，编译器使用该属性来打开方法声明中的**specialname** IL 属性。寻找其使用的最佳位置是 ECMA 335 CLI 规范。

一般来说，它用于将标识符标记为具有特殊用途。例如，您会看到它在属性的 getter 和 setter 方法、事件访问器方法和运算符重载上打开。注意与*rtspecialname* IL 属性的区别，specialname 属性影响工具而不是抖动。就像本例中的 VB.NET 编译器一样，它现在将 op_Exponent() 区分为运算符重载，而不仅仅是具有有趣名称的普通方法。

请注意，这都是内置的行为，您不能提取编译器和抖动未被编程识别的技巧。

# button - 当按钮单击两次时做某事

> ID：13260696
> 
> 赞同：0
> 
> 时间：2012-11-06T22:50:14.657
> 
> 标签：button

我需要当一个按钮被点击一次它会显示消息“不显示”。当点击两次返回原始消息“显示”。我已经做了第一件事，我只需要第二件事的帮助，那就是第二次点击。

```
function show()
{
    document.myform.button.value ="Hide";//Changes message on button when clicked.
    document.myform.button.innerHTML= "Hide";
}

<form>
<input type=button value= "Show" name="button" id= "idButton"
onClick="show()">
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:55:20.730

```
function show(button)
{
    if(button.hidden)
         button.hidden = false
         document.myform.button.value ="Show";//Changes message on button when clicked.
         document.myform.button.innerHTML= "Show";
    else {
         button.hidden = true
         document.myform.button.value ="Hide";//Changes message on button when clicked.
         document.myform.button.innerHTML= "Hide";
    }
}

<form>
<input type=button value= "Show" name="button" id= "idButton"
onClick="show(this)">
</form> 
```

# macos - shell 脚本，将 .png 替换为 @2x.png

> ID：13260698
> 
> 赞同：0
> 
> 时间：2012-11-06T22:50:20.593
> 
> 标签：macos, shell

我需要一个脚本来将 .png 替换为 @2x.png 如何对目录中的所有文件名执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T23:04:48.283

假设 bash：

```
for f in *.png; do
    mv "$f" "${f%.png}@2x.png"
done 
```

* * *

## 解释：

### 第 1 行：

```
for f in *.png; do 
```

对于循环。遍历当前目录中与 glob 模式匹配的所有文件名，依次`*.png`设置`$f`为每个名称，并执行循环体。

### 第 2 行：

```
mv "$f" "${f%.png}@2x.png" 
```

执行`mv`工具。第一个 arg 是 just `"$f"`，这是您要重命名的文件。第二个参数是一个两步过程：

1.  `${f%.png}``.png`评估为去掉扩展名的文件名。

2.  在剥离的文件名之后是`@2x.png`，它只是将该字符串附加到文件名上。

### 第 3 行：

```
done 
```

终止 for 循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:12:56.900

以下脚本应该适合您：

```
#!/bin/bash

for file in *.png
do
    filename=$(basename "$file")
    filename="${filename%.*}"
    filename="${filename}@2x.png"
    mv "$file" "$filename"
done 
```

# asp.net-mvc-3 - MVC3 jquery.datatables.editable 没有拾取不可见的 id 列

> ID：13260699
> 
> 赞同：1
> 
> 时间：2012-11-06T22:50:21.393
> 
> 标签：asp.net-mvc-3, datatables

我有一个项目，我想在通过 DataTables 生成的表中内联编辑一个值，因此我使用 dataTables.editable 该表呈现正常，但是当我尝试进行编辑时，我得到一个错误，如果我查看返回值 id 字段为空。控制器动作如下：

```
public ActionResult AjaxHandler(jQueryDataTableParamModel param)
    {
        var allMonthlyCosts = _unitOfWork.MonthlyCostRepository.Get(includeProperties: "Period, Employee");
        IEnumerable<MonthlyCost> filteredMonthlyCosts;
        if (!string.IsNullOrEmpty(param.sSearch))
        {
            filteredMonthlyCosts = _unitOfWork.MonthlyCostRepository.Get(includeProperties: "Period, Employee")
                .Where(mc => mc.Period.Name.Contains(param.sSearch)
                    ||
                    mc.Employee.ClockNo.Contains(param.sSearch));
        }
        else
        {
            filteredMonthlyCosts = allMonthlyCosts;
        }

        var displayedMonthlyCosts = filteredMonthlyCosts
            .Skip(param.iDisplayStart)
            .Take(param.iDisplayLength);

        var result = from mc in displayedMonthlyCosts
                     select new { ID = mc.Id, EvisionCost = mc.EvisionCost, EmployeeNo = mc.Employee.ClockNo, PeriodName = mc.Period.Name, TotalDays = mc.TotalDays, TotalCost = mc.TotalCost() };

        return Json(new
        {
            sEcho = param.sEcho,
            iTotalRecords = allMonthlyCosts.Count(),
            iTotalDisplayRecords = filteredMonthlyCosts.Count(),
            aaData = result
        },
        JsonRequestBehavior.AllowGet);
    } 
```

Javascript如下：

```
$('#myDataTable').dataTable({
    "bServerSide": true,
    "sAjaxSource": "MonthlyCost/AjaxHandler",
    "bProcessing": true,
    "aoColumns": [
        { "mData": "ID",
            "bSearchable": false,
            "bSortable": false,
            "bVisible": false
        },
        { "mData": "EvisionCost" },
        { "mData": "PeriodName" },
        { "mData": "EmployeeNo" },
        { "mData": "TotalDays" },
        { "mData": "TotalCost" }
    ]
}).makeEditable({
    sUpdateURL: "/MonthlyCost/UpdateData",
    "aoColumns": [
        {},
        null,
        null,
        null,
        null]
}); 
```

我得到的错误是：

单元格不能#Updated（服务器错误）

并且返回的形式如下：

```
value:2505
id:
rowId:0
columnPosition:0
columnId:1
columnName:EvisionCost 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-01T12:50:31.440

问题是相当st.forward 您的编辑没有到达下面的这个插件代码。这就是为什么它抛出你提到的错误

可编辑数据表插件中的代码：

```
//Utility function used to apply editable plugin on table cells
    function fnApplyEditable(aoNodes) {
        var oDefaultEditableSettings = {
            event: 'dblclick',
            "callback": function (sValue, settings) {
                properties.fnEndProcessingMode();
                if (sNewCellValue == sValue) {
                    var aPos = oTable.fnGetPosition(this);
                    oTable.fnUpdate(sValue, aPos[0], aPos[2]);
                } else {
                    var aPos = oTable.fnGetPosition(this);
                    oTable.fnUpdate(sOldValue, aPos[0], aPos[2]);
                    properties.fnShowError(sValue, "update");
                }

            },
            "submitdata": function (value, settings) {
                properties.fnStartProcessingMode();
                sOldValue = value;
                sNewCellValue = $("input,select", $(this)).val();
                var id = fnGetCellID(this);
                var rowId = oTable.fnGetPosition(this)[0];
                var columnPosition = oTable.fnGetPosition(this)[1];
                var columnId = oTable.fnGetPosition(this)[2];
                var sColumnName = oTable.fnSettings().aoColumns[columnId].sName;
                if (sColumnName == null || sColumnName == "")
                    sColumnName = oTable.fnSettings().aoColumns[columnId].sTitle;
                return {
                    "id": id,
                    "rowId": rowId,
                    "columnPosition": columnPosition,
                    "columnId": columnId,
                    "columnName": sColumnName
                };
            },
            "onerror": function () {
                properties.fnEndProcessingMode();
                properties.fnShowError("Cell cannot be updated(Server error)", "update");
            },
            "height": properties.height
        }; 
```

我最近面临的这个问题，我正在尝试

```
<script type="text/javascript">

    $(document).ready(function () {

        $('#myDataTable').dataTable({ "bProcessing": true,
            **"bServerSide": true,
            "sAjaxSource": 'Home/AjaxHandler',
            "sUpdateURL": '@Url.Action("UpdateData","Home")',
            "sAddURL": '@Url.Action("AddData","Home")' ,
            "sDeleteURL": '@Url.Action("DeleteData","Home")',**
            "aoColumns": [
                                    {   "sName": "ID",
                                        "bSearchable": false,
                                        "bSortable": false,
                                        "bVisible": false

                                    },

                        { "sName": "Contact_Name" },
                        { "sName": "Contact_Address" },
                        { "sName": "Lead_Source" },
                        { "sName": "Domain" }, 
                                ]

        }).makeEditable();
    });

        </script>
} 
```

如果这项工作请告诉我。如果您发现任何其他方式，请提及它。我也和你一样的情况 寻找答案

问候

# android - 不兼容 ListView 和 Actionbar

> ID：13260700
> 
> 赞同：0
> 
> 时间：2012-11-06T22:50:24.313
> 
> 标签：android, android-listview, android-actionbar

我在使用 ListView 和 Actionbar 时遇到问题。我将它用于操作栏：

```
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case R.id.maths:
            Toast.makeText(getApplicationContext(), "Du bist bereits bei Mathe :)", Toast.LENGTH_SHORT).show();
            return true;
        case R.id.physics:
            Intent myIntent2 = new Intent(Home.this, ActivityPhysics.class);
            startActivity(myIntent2);
        default:
            return super.onOptionsItemSelected(item);
    }
} 
```

而且效果很好。现在我说扩展列表。在 list.java 我有：

```
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setListAdapter( new ArrayAdapter<String>(this, R.layout.single_item, Liste));
    ListView Liste = getListView();
    Liste.setTextFilterEnabled(true);
    Liste.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
                long arg3) {
            // TODO Auto-generated method stub
            Toast.makeText(getApplicationContext(), ((TextView) arg1).getText(), Toast.LENGTH_SHORT) .show();
        }

    });
} 
```

当我评论（//，/* */）操作栏时，Listview 工作。当我评论 Listview 时，Actionbar 有效。两者都产生空指针异常并且“youapp 意外停止”。

有没有办法让两者都工作？或者我可能错过了什么？:(

# c# - 字节数组未初始化为正确大小？

> ID：13260710
> 
> 赞同：1
> 
> 时间：2012-11-06T22:51:20.127
> 
> 标签：c#, serial-port

我正在编写一个应用程序，它通过串行连接从远程无线电接收一些输入。我目前正在使用 SerialPort C# 类来接收和发送数据，但我遇到了一些问题。我注意到我用于接收数据的功能没有正确设置缓冲区字节数组大小。所有数据都以字节码（十六进制）发送。

假设另一个节点发送了 103 个字节的数据。单步执行我的代码并在“Read()”行设置断点，我看到“serialPort1.BytesToRead-1”的计算结果为 103，但 byte[] 数组仅初始化为 17。我对此行为没有任何解释. 结果，只有前 17 个字节被放入数组中。继续执行该步骤，触发了相同的事件，这次“serialPort1.BytesToRead-1”评估为 85（大概是因为仅读取了 103 个字节中的前 17 个。

如果我将数据数组大小硬核为 103，它可以完美地一次通过。但是，目前我无法一次将所有数据存储在我的字节数组中，这导致了很多问题。任何人都知道为什么我的字节数组被初始化为如此任意大小？？？

```
private void serialPort1_DataReceived(object sender, SerialDataReceivedEventArgs e)
{
        byte[] data = new byte[serialPort1.BytesToRead - 1];
        serialPort1.Read(data, 0, data.Length);
        DisplayData(ByteToHex(data) /*+ "\n"*/);
} 
```

* * *

更新：这是我正在尝试的新方法。isHeader 是一个布尔值，最初设置为 true（因为从数据包接收的前两个字节实际上是数据包的长度）。

```
 const int NUM_HEADER_BYTES = 2;

    private void serialPort1_DataReceived(object sender,                     System.IO.Ports.SerialDataReceivedEventArgs e)
    {
        byte[] headerdata = new byte[2];
        if (isHeader)
        {
            serialPort1.Read(headerdata, 0, NUM_HEADER_BYTES);
            int totalSize = (headerdata[0] << 8 | headerdata[1]) >> 6;
            serialPort1.ReceivedBytesThreshold = totalSize - NUM_HEADER_BYTES;
            data = new byte[totalSize - NUM_HEADER_BYTES];
            isHeader = false;
        }
        else
        {
            serialPort1.Read(data, 0, data.Length);
            double[][] results = ParseData(data, data.Length);
            serialPort1.ReceivedBytesThreshold = NUM_HEADER_BYTES;
            isHeader = true;
            DisplayData(ByteToHex(data) /*+ "\n"*/);
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T23:01:45.320

BytesToRead 等于缓冲区中等待的字节数。随着新数据的到来，它会时刻变化，这就是您在这里看到的。

当您使用调试器单步执行时，这需要额外的时间，并且在您单步执行调试器时会进入其余串行数据，因此 BytesToRead 更改为完整值 104。

如果您知道需要 103 个字节，我相信将[ReceivedBytesThreshold](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.receivedbytesthreshold.aspx)设置为 104 将在适当的时间触发 DataRecieved 事件。如果您不知道需要接收的消息的大小，则需要执行其他操作。我注意到您丢弃了一个字节（serialPort1.BytesToRead **- 1**），这是您在读取数据时可以搜索的消息结束字节吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T23:23:56.023

当涉及到实时数据传输时，调试器将无法提供。使用调试跟踪。

顺便说一句，我自己会使用轮询数据，而不是信任事件。使用串行端口，这是一种合理且可靠的方法。

**根据评论编辑**：串行数据传输速率受您的波特率限制。您担心丢失数据，所以让我们看一下数字：

假设：

```
baud_rate = 19600 [bytes/sec]  // it's usually *bits*, but we want to err upwards
buffer_size = 4096 [bytes]     // windows allocated default buffer size 
```

所以需要：

```
4096/19600 [sec] ~ 200 [ms] 
```

溢出缓冲区（*上限*）。

因此，如果您在 处进行采样`50 Hz`，那么您将在一个数量级的安全网上运行，这是一个好地方。在每个“样本”上，您都读取**了整个缓冲区**。这里没有时间问题。

当然，您应该根据自己的情况采用这些数字，但如果您的低带宽 RF 通道会导致传输速率`50 Hz`不够大，我会感到惊讶。

**最后编辑**：不用说，如果你目前拥有的东西*有效*，那就*不要碰它*。

# webserver - 缓慢的页面加载时间 - 根据 Pingdom 的长“等待”期

> ID：13260711
> 
> 赞同：2
> 
> 时间：2012-11-06T22:51:21.933
> 
> 标签：webserver, page-load-time

我的页面加载时间波动很大，有时即使在我的网站一天中相对安静的时间里，提供一个页面需要很长时间，我也会收到服务器超时错误。

我一直在使用 pingdom 检查页面加载时间并尝试找出问题所在。

似乎当页面正常加载时（大约 6 秒），主 html 文件在开始接收文件之前有 1.63 秒的“等待”时间。你可以在这里看到这个： [http ://tools.pingdom.com/fpt/#!/GEoqJlVdZ/http://www.bluedogposters.com.au/shopdisplayproducts.asp?id=11&cat=Movies](http://tools.pingdom.com/fpt/#!/GEoqJlVdZ/http://www.bluedogposters.com.au/shopdisplayproducts.asp?id=11&cat=Movies)

但是 2 分钟后，当加载相同的页面需要 17 秒时，在开始接收相同的 html 文件之前有 11.7 秒的等待时间。你可以在这里看到一个例子： [http ://tools.pingdom.com/fpt/#!/he2L5Jhgz/http://www.bluedogposters.com.au/shopdisplayproducts.asp?id=11&cat=Movies](http://tools.pingdom.com/fpt/#!/he2L5Jhgz/http://www.bluedogposters.com.au/shopdisplayproducts.asp?id=11&cat=Movies)

你知道什么会导致等待时间的差异，因为这似乎是我的网站最近如此缓慢的原因。根据瀑布图，没有其他任何事情发生，那么为什么要等待？

更有可能是代码或服务器问题？我在这里找到了一些有用的信息[如何减少服务器“等待”时间？](https://stackoverflow.com/questions/10938682/how-to-reduce-server-wait-time)

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T14:36:48.620

你需要一个可以挖掘后端性能的工具，像 New Relic 这样的工具可能会有所帮助——他们提供一个月的免费试用。

性能显然存在一些差异，但如果不深入挖掘，很难辨别它是否与负载或其他因素有关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:09:32.100

无论如何，您应该尝试新的遗物，即使在 ASP 经典网站上，它仍然会给您一个很好的答案。我之前在 Windows 服务器上使用过它来找出应用程序运行缓慢的原因。

# java - 解密 Lotus Notes 邮件 - Java API

> ID：13260714
> 
> 赞同：0
> 
> 时间：2012-11-06T22:51:28.720
> 
> 标签：java, email, encryption, lotus

我正在尝试使用 Java API 创建 Lotus Notes 邮件提取器，但我还没有找到任何解密邮件文件的方法。我正在使用超级管理员用户的凭据创建会话，即使使用的帐户是邮件发件人的帐户，检索的（加密）文件也显示加密。

现在，一位需要此功能的潜在客户告诉我，他可以提供私钥（尚不确定通过哪种方式，如果是字符串或修改 .ID 文件（？）。

所以我的问题是，对于我想要完成的事情，我有哪些选择？我最喜欢使用 Java API，虽然我知道 C 中有一种模拟方法，但它需要用户的 ID 文件或凭据。

如果它不能自动化，是否有某种服务器证书可以让我提取解密的邮件？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T12:47:17.520

解密加密邮件文档所需的（私人）密钥存储在 ID 文件中。您只能使用正确的密码打开 ID 文件。只有这样才能在 Notes 中冒充某人。没有可用于打开任何文档的全局密钥或服务器证书之类的东西。

当 A 向 B 发送加密邮件时，该邮件使用 B 的公钥加密。生成的文档只能使用 B 的私钥解密。这也意味着即使是 A 也无法阅读该邮件！

笔记肯定是安全的！:-)

# java - 将char方法调用到main方法中

> ID：13260716
> 
> 赞同：0
> 
> 时间：2012-11-06T22:51:36.170
> 
> 标签：java

如何将此方法调用到我的主要方法中：

```
 public static char shiftLetter(char aLetter, int offset){

    if((aLetter >= 65 && aLetter <= 90) || (aLetter >=97 && aLetter <=122)){
      char shifted = (char) (aLetter + offset);  
      return shifted;
    }else{
      return aLetter;
    }
  } 
```

这是我的主要方法：

```
 public static void main(String[]args){ 
    Scanner in = new Scanner (System.in);

    String isAnswer = askQ();
    if (isAnswer.equals("encode") || isAnswer.equals("decode")){
      String text = isText();
      int offset = isOffset();
      char[] myString = text.toCharArray();
      System.out.println(myString); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:02:58.177

如果`shiftLetter()`方法与您的方法在同一个类中，`main()`则只需键入其名称即可调用它：

```
shiftLetter('a', 123); 
```

然后，如果它是另一个类，则在您的 main 中，您必须将类的名称放在方法名称之前：

```
OtherClasse.shiftLetter('a', 123); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:54:50.363

如果 shiftLetter 在您的主类中，则可以使用

shiftLetter('a', 4);

其中 'a' 和 4 是您想要的任何参数。如果它在主类之外的类中，您可能必须使用 Class.ShiftLetter() 或如果它在另一个包中则导入它

# windows-8 - 使用 AppReceiptId 在 Windows 应用商店应用中验证用户身份？

> ID：13260718
> 
> 赞同：4
> 
> 时间：2012-11-06T22:51:41.373
> 
> 标签：windows-8, windows-runtime, windows-store-apps

我希望能够使用 CurrentApp.GetAppReceiptAsync() 结果中的 AppReceiptId 并将其绑定到我的后端服务中的用户名，以验证用户是否实际购买了该应用程序。

我知道我应该使用 CurrentAppSimulator 代替 CurrentApp，但 CurrentAppSimulator.GetAppReceiptAsync() 总是为 AppReceiptId 返回一个不同的随机值。这使得使用我的服务进行测试变得困难。

除了使用硬编码之外，有没有办法让它总是返回相同的值？我担心当我用 CurrentApp 替换 CurrentAppSimulator 并将其提交到商店时，它不会像我期望的那样运行。在现实世界中，AppReceiptId 永远不会改变，对吧？

我用来获取 AppReceiptId 的代码：

```
var receiptString = await CurrentAppSimulator.GetAppReceiptAsync();
XmlDocument doc = new XmlDocument();
doc.LoadXml(receiptString);

var ReceiptNode = (from s in doc.ChildNodes 
                   where s.NodeName == "Receipt"
                   select s).Single();

var AppReceiptNode = (from s in ReceiptNode.ChildNodes
                      where s.NodeName == "AppReceipt"
                      select s).Single();

var idNode = (from s in AppReceiptNode.Attributes
              where s.NodeName == "Id"
              select s).Single();

string id = idNode.NodeValue.ToString(); 
```

id 总是一些随机的 Guid。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:59:54.837

**CurrentApp.GetAppReceiptAsync().Id**是实际*购买*的唯一 ID 。尽管它在技术上确实代表了由单个 Windows ID 进行的唯一购买，但它并不代表用户自己，我认为该 ID 的持久性没有任何保证。

您是否更适合使用 Windows Live SDK 跨设备跟踪实际用户身份？

无论如何，要回答您最初的问题，不，我不相信有任何方法可以让它一直返回相同的 ID。该功能的唯一合乎逻辑的位置是在**WindowsStoreProxy.xml**文件中，我在架构中看不到任何允许您指定此信息的内容。

# php - curl 检查复选框

> ID：13260719
> 
> 赞同：1
> 
> 时间：2012-11-06T22:51:44.400
> 
> 标签：php, curl, checkbox

我有一个简单的 php curl 函数，它可以转到另一个站点（不属于我）并填写字段并正常工作，唯一的事情是我无法让它选中一个复选框。我似乎找不到答案。

```
curl_setopt($ch, CURLOPT_HEADER, false);

curl_setopt($ch, CURLOPT_NOBODY, false); 
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0); 

curl_setopt($ch, CURLOPT_COOKIEJAR, $cookie_file_path); 
curl_setopt($ch, CURLOPT_COOKIEFILE, $cookie_file_path); 

curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.0; en-US; rv:1.7.12) Gecko/20050915 Firefox/1.0.7"); 

curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_VERBOSE, 1);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);

curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0); 
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "POST"); 
curl_setopt($ch, CURLOPT_POST, 1); 
$searchCriteria = array(
      'historicalMatches' => $_POST['historicalMatches'],  //the checkbox
      'firstName'  => $_POST['firstName'], 
      'middleName' => $_POST['middleName'],
      'lastName'   => $_POST['lastName'], 
      'suffix'     => $_POST['suffix'],
      'age'        => $_POST['age'],
      etc..);

curl_setopt($ch, CURLOPT_POSTFIELDS, $searchCriteria); 
```

我尝试将值设置为 1 并打开并检查。另一个页面上复选框的 html 是：

```
<input type="checkbox" name="historicalMatches" value="on"> 
```

我需要做的就是确保每次都检查它。所以我可以添加第二个

```
curl_setopt($ch, CURLOPT_POSTFIELDS, 'check the box'); 
```

只是点击我只是想不通的框。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:51:46.857

我不知道从哪里来`$_POST['historicalMatches']`，但这可能是问题所在。

添加：

```
'historicalMatches' => 'on' 
```

到您的数组`$searchCriteria`应该是模拟被选中的复选框的正确方法。简单地从 postfields 中省略该值将表明该框未选中。

由于复选框的值为`on`，因此只需在您希望选中复选框时使用复选框名称发布该值，或者将其保留在参数之外以使其未选中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:41:56.297

您可以尝试更改 URL 字符串并以这种方式提交 Posted 数据，而不是尝试仅使用 cURL 填写表单？

如果您没有找到答案，请尝试查看 Firefox 的 Http Headers 扩展。从那里您可以看到可用于向服务器提交数据的 URL 字符串。然后使用 cURL 和一些简单的 PHP 变量，您可以更改 URL 字符串并执行请求。

它基本上会为您填写表格并提交数据。我不确切知道您要做什么，但是如果您找不到如何使用您的方法检查该框，请看看这个！

# ruby-on-rails - openssl 和 ruby 证书验证失败 (OpenSSL::SSL::SSLError)

> ID：13260720
> 
> 赞同：3
> 
> 时间：2012-11-06T22:51:47.790
> 
> 标签：ruby-on-rails, ruby, openssl, activemerchant

我收到证书验证失败 (OpenSSL::SSL::SSLError) 错误。

*   Ubuntu 12.04
*   红宝石 1.9.3
*   通过 rvm 安装的 openssl

这个命令工作正常

> openssl s_client -CAfile ./ccapi.pem -connect ccapi.client.qvalent.com:443

=> `Verify return code: 0 (ok)`

使用 activemerchant 运行 ruby​​ 脚本，该脚本使用相同的 pem 文件调用上述站点

```
ruby pwtest.rb 
```

=>

```
credit card is valid!
/home/rzolkos/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:799:in `connect': SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed (OpenSSL::SSL::SSLError) 
```

该脚本在另一台服务器/本地机器上运行良好。

任何有关修复或诊断的提示表示赞赏。

# java - 扑克手 - 用 Ja va 解析日志文件

> ID：13260729
> 
> 赞同：1
> 
> 时间：2012-11-06T22:52:25.230
> 
> 标签：java, parsing, logic, poker

您好，我正在为大学进行 Java 项目，我应该在其中分析扑克牌。我在 txt 日志文件中发现了一些扑克牌。

它们通常看起来像这样：

```
PokerStars Zoom Hand #86981279921:  Hold'em No Limit ($0.10/$0.25 USD) - 2012/09/30 23:49:51 ET
Table 'Whirlpool Zoom 40-100 bb' 9-max Seat #1 is the button
Seat 1: lgwong ($30.99 in chips) 
Seat 2: hastyboots ($28.61 in chips) 
Seat 3: seula i ($25.31 in chips) 
Seat 4: fr_kevin01 ($31.81 in chips) 
Seat 5: limey05 ($27.45 in chips) 
Seat 6: sanlu ($24.65 in chips) 
Seat 7: Masterfrank ($25.35 in chips) 
Seat 8: Refu$e2Lose ($33.23 in chips) 
Seat 9: 1pepepe0114 ($37.62 in chips) 
hastyboots: posts small blind $0.10
seula i: posts big blind $0.25
*** HOLE CARDS ***
fr_kevin01: folds 
limey05: folds 
sanlu: folds 
Masterfrank: folds 
Refu$e2Lose: folds 
1pepepe0114: folds 
lgwong: folds 
hastyboots: folds 
Uncalled bet ($0.15) returned to seula i
seula i collected $0.20 from pot
seula i: doesn't show hand 
*** SUMMARY ***
Total pot $0.20 | Rake $0 
Seat 1: lgwong (button) folded before Flop (didn't bet)
Seat 2: hastyboots (small blind) folded before Flop
Seat 3: seula i (big blind) collected ($0.20)
Seat 4: fr_kevin01 folded before Flop (didn't bet)
Seat 5: limey05 folded before Flop (didn't bet)
Seat 6: sanlu folded before Flop (didn't bet)
Seat 7: Masterfrank folded before Flop (didn't bet)
Seat 8: Refu$e2Lose folded before Flop (didn't bet)
Seat 9: 1pepepe0114 folded before Flop (didn't bet) 
```

我的问题是我不确定如何继续**解析日志文件**：我所拥有的唯一知识是“手动”逐行扫描特定字符或符号，但恐怕它需要详尽的错误处理。

所以我在徘徊是否有任何其他技术或更好的方法来解析这些扑克牌？

非常感谢您的帮助

编辑：对不起“数据挖掘”，因为它不是问题的一部分。

EDIT2：我也在寻找一些与 C++ 相同的 Java 方法

例如：在 C++ 中读取 5 个字符/直到 de # 符号将是：myfile.getline(store_in_this_var,5,'#')，你能建议我一些 Java 方法来做同样的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:57:24.283

您可能需要按照您所说的去做：

逐行查找并在行首查找字符。

几年前，我写了一个类似的应用程序来分析*FullTilt Poker*的历史文件......

我做了完全相同的事情，而且效果很好。

* * *

**编辑**：

*   [BufferedReader 文档](http://docs.oracle.com/javase/6/docs/api/java/io/BufferedReader.html)
*   [文件阅读器文档](http://docs.oracle.com/javase/6/docs/api/java/io/FileReader.html)

# date - Excel, VB - 将 8 位日期序列化为 mm/dd/yy

> ID：13260732
> 
> 赞同：1
> 
> 时间：2012-11-06T22:52:36.900
> 
> 标签：date, types, excel, casting, vba

# 问题

我正在尝试在数组中将 8 位数字转换为日期。条目的示例是 12282009 或 12202007。字段中还有其他格式错误的条目，包括以字符串形式输入的日期。我希望将 8 位数字分别格式化为 12/28/09 或 12/20/07。**我在下面的倒数第三行不断收到类型不匹配错误。我该怎么做呢？？**

# 代码

```
Dim del()
ReDim del(1 To importwsRowCount, 1 To 1)
del = Range("AH1:AH" & importwsRowCount).Value
Dim delChars As Long
Dim delType As String
For i = LBound(del, 1) To UBound(del, 1)
    delChars = Len(del(i, 1)) 'Determine length of entry
    If IsNumeric(del(i, 1)) = True Then 'Determine datatype of entry
        delType = "Numeric"
        del(i, 1) = Abs(del(i, 1))
    Else
        delType = "String"
        del(i, 1) = UCase(del(i, 1))
    End If     
If delType = "Numeric" Then
    If delChars = 8 Then
        del(i, 1) = DateSerial((Right(del(i, 1), 4)), (Left(del(i, 1), 2)), (Mid(del(i, 1), 3, 2))) '<-- TYPE MISMATCH ERROR
    End If
End If 
```

# 输入模板

**九月。25, 20**（没有年份，没有年份！删除。）
**SEPT**（没有年份，没用，删除。）
**N/A**（垃圾！删除。）
**LONG TIME AG**（傻瓜认为这是个好主意，删除。）
**6 月 30 日, 200**（显然该字段只能保存 12 个字符，删除。）
**CHARGED OFF**（无用，删除。）
**94 DAYS**（取空格前的所有字符并从包含订单日期的其他字段中减去以获得拖欠日期。）
**94 DPD**（DPD in某人聪明的头脑代表我相信过期的日子。同上。）
**2008-7-15 12**（不确定额外的数字是什么，取空格前的所有字符并转换。）
**无效**（删除。）
**空白**（什么都不做。）
**4/2/4/09**（格式错误的日期，删除。）
**009**年 1 月 1 日（同上。）
**12282009**（使用嵌套的 LEFT 和 RIGHT 以及 CONCATENATE 与 / 之间。）
**9202011**（添加前导零，然后同上。）
**92410**（添加前导零，这将转换为 09/24/10）
**41261**（自 31/12/1899 以来的天数，这将转换为 12/08/12）
**1023**（自拖欠的天数，从 ORDER DATE 中减去得到拖欠日期。）
**452**（同上。）
**12**（同上。）
**1432.84**（货币价值，被低智商的仆人错误输入。删除。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:55:59.637

`Right(Left(del(i, 1), 2), 6)`是荒谬的。

该`Left(del(i, 1), 2)`部分首先发生并返回一个 2 个字符的字符串。如果您随后应用`Right(..., 6)`到该 2 个字符的字符串，则会收到错误消息。

这里需要这个`Mid`函数：`Mid(del(i, 1), 3, 2)`

* * *

之前运行该`Abs`函数将数组条目从具有子类型 String 的 Variant 更改为具有子类型 Double 的 Variant。这不一定会影响左/中/右功能，但请尝试：

```
del(i, 1) = CStr(del(i, 1))
del(i, 1) = DateSerial((Right(del(i, 1), 4)), (Left(del(i, 1), 2)), (Mid(del(i, 1), 3, 2))) 
```

* * *

我们需要确定导致错误的实际值是什么：

```
If delType = "Numeric" Then
    If delChars = 8 Then
        On Error Goto DateMismatchError
        del(i, 1) = DateSerial((Right(del(i, 1), 4)), (Left(del(i, 1), 2)), (Mid(del(i, 1), 3, 2))) '<-- TYPE MISMATCH ERROR
        On Error Goto 0
    End If
End If

' at the end of your Sub or Function - I'm assuming Sub here

Exit Sub

DateMismatchError:

MsgBox "Date mismatch: error number " & Err.Number & ", " & Err.Description & _
    " caused by data value: |" & del(i, 1) & "| at row " & i & ". Original data " & _
    "value is |" & Range("AH" & i).Value2 & "|, displayed value is |" & _
    Range("AH" & i).Text & "|, number format is |" & Range("AH" & i).NumberFormat & "|"

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T23:30:23.983

您可以使用这个较短的代码将您的数组元素替换为格式化的日期

1.  它将循环内的测试量减少到两个`IF`s。如果首先运行数字测试 -对非 8 个字符的字符串运行更长的[len](/questions/tagged/len "显示标记为“len”的问题") [int测试没有意义](/questions/tagged/int "显示标记为“int”的问题")
2.  字符串函数等比它们的变体表亲`Left$`等`Mid$`快得多`Left``Mid`

*我`importwsRowCount`在下面的代码中替换了您的变量*

*更新了处理和转储结果的代码，现在根据 barrowc 注释处理字符串测试和不合规的数字*

下面的代码将新日期放入第二个数组，跳过无效日期第二个数组然后转储到`AI`

```
Sub ReCut2()
Dim del()
Dim X()
Dim lngCnt As Long
del = Range("AH1:Ah10").Value2
ReDim X(1 To UBound(del, 1), 1 To UBound(del, 2))
Dim delChars As Long
Dim delType As String
For lngCnt = LBound(del, 1) To UBound(del, 1)
  If IsNumeric(del(lngCnt, 1)) Then
  If Len(Int((del(lngCnt, 1)))) = 8 Then X(lngCnt, 1) = DateSerial(Right$(del(lngCnt, 1), 4), Left$(del(lngCnt, 1), 2), Mid$(del(lngCnt, 1), 3, 2))
  End If
Next
[ai1].Resize(UBound(X, 1), UBound(X, 2)).Value2 = X
End Sub 
```

![在此处输入图像描述](../Images/c18b5866a7a000674a1843882f5c89ca.png)

# swing - Java 生成数组

> ID：13260737
> 
> 赞同：1
> 
> 时间：2012-11-06T22:52:56.027
> 
> 标签：swing

我正在开发一个绘制点的 Java swing 应用程序。我正在使用第三方图形绘制 .jar，它从 ax 数组和 ay 数组中的坐标获取输入。有什么方法可以使 y 数组成为 x 数组的函数？该功能将由用户指定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:58:11.580

是的。定义一个接口 XtoYFunction ：

```
public interface XtoYFunction {
    int[] transform(int[] xCoordinates);
} 
```

并让用户传递这个接口的一个实现。用 X 坐标调用它的 transform 方法，你会得到对应的 Y 坐标。

如果一个 Y 依赖一个 X，则接口可以是

```
public interface XtoYFunction {
    int transform(int xCoordinate);
} 
```

您只需遍历 X 坐标并为每个值调用函数以获取其对应的 Y 坐标。例如：

```
plot(new int[] {0, 1, 2, 3, 4},
     new XtoYFunction() {
         @Override
         public int transform(int x) {
             return x * x;
         }
     }); 
```

# android - 光标和 SimpleCursorAdapter

> ID：13260748
> 
> 赞同：0
> 
> 时间：2012-11-06T22:53:58.180
> 
> 标签：android, sqlite, simplecursoradapter

> **可能重复：**
> [系统服务在 onCreate 之前对活动不可用？](https://stackoverflow.com/questions/5905587/system-services-not-available-to-activities-before-oncreate)

我正在尝试将数据库的值返回到列表视图，但出现错误。我正在使用游标从表中获取数据，并使用 SimpleCursorAdapter 来读取游标。这是执行此操作的方法：

```
public void getData(){
        String[] columns = new String[] {ModuleDB.KEY_ROWID, 
                ModuleDB.KEY_MODCODE,
                ModuleDB.KEY_MODNAME,
                ModuleDB.KEY_LECPRAC,
                ModuleDB.KEY_DAYS,
                ModuleDB.KEY_TIMESTART,
                ModuleDB.KEY_TIMEEND,
                ModuleDB.KEY_LOCATION,
                ModuleDB.KEY_INFO};
        int[] to = new int[]{R.id.modcode_entry,
                             R.id.modname_entry,
                             R.id.modlecprac_entry,
                             R.id.modday_entry,
                             R.id.modtimestart_entry,
                             R.id.modtimeend_entry,
                             R.id.modlocation_entry,
                             R.id.modaddinfo_entry};

        Cursor curs = myDatabase.query(ModuleDB.DB_TABLE, columns, null, null, null, null, null);
        if (curs != null)
            curs.moveToFirst();

        SimpleCursorAdapter dataSource = new SimpleCursorAdapter(ModuleDataSource.this, R.layout.list_entry, curs, columns, to);
        this.setListAdapter(dataSource);

        // Make sure to close the cursor
        curs.close();
        } 
```

此方法导致异常：`"System Services not available to activites before onCreate()"`

谁能帮我这个？我找不到任何关于光标和光标适配器的好教程，我真的完全迷路了

编辑：

这可能会有所帮助。

**MainActivity.java**

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        ModuleDataSource dbinfo = new ModuleDataSource(this);
        dbinfo.open();
        dbinfo.getData();
        dbinfo.close();
    } 
```

**模块数据源.java**

```
public class ModuleDataSource extends ListActivity{

    private SQLiteDatabase myDatabase;
    private ModuleDB myhelper;

    public ModuleDataSource(Context context){
        myhelper = new ModuleDB(context);
    }

    public void open() throws SQLException { //Open the database for writing
        myDatabase = myhelper.getWritableDatabase();
    }

    public void close(){ //Close the database
        myhelper.close();
    }

    public void getData(){
        String[] columns = new String[] {ModuleDB.KEY_ROWID, 
                ModuleDB.KEY_MODCODE,
                ModuleDB.KEY_MODNAME,
                ModuleDB.KEY_LECPRAC,
                ModuleDB.KEY_DAYS,
                ModuleDB.KEY_TIMESTART,
                ModuleDB.KEY_TIMEEND,
                ModuleDB.KEY_LOCATION,
                ModuleDB.KEY_INFO};
        int[] to = new int[]{R.id.modcode_entry,
                             R.id.modname_entry,
                             R.id.modlecprac_entry,
                             R.id.modday_entry,
                             R.id.modtimestart_entry,
                             R.id.modtimeend_entry,
                             R.id.modlocation_entry,
                             R.id.modaddinfo_entry};

        Cursor curs = myDatabase.query(ModuleDB.DB_TABLE, columns, null, null, null, null, null);
        startManagingCursor(curs);

        if (curs != null)
            curs.moveToFirst();

        SimpleCursorAdapter dataSource = new SimpleCursorAdapter(ModuleDataSource.this, R.layout.list_entry, curs, columns, to);
        setListAdapter(dataSource);

        }
} 
```

EDIT2：Logcat

```
11-06 23:24:07.885: D/AndroidRuntime(887): Shutting down VM
11-06 23:24:07.885: W/dalvikvm(887): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
11-06 23:24:07.895: E/AndroidRuntime(887): FATAL EXCEPTION: main
11-06 23:24:07.895: E/AndroidRuntime(887): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.adoherty.assignment3/com.adoherty.assignment3.MainActivity}: 
                                          java.lang.IllegalStateException: System services not available to Activities before onCreate()
11-06 23:24:07.895: E/AndroidRuntime(887):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
11-06 23:24:07.895: E/AndroidRuntime(887):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
11-06 23:24:07.895: E/AndroidRuntime(887):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
11-06 23:24:07.895: E/AndroidRuntime(887):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
11-06 23:24:07.895: E/AndroidRuntime(887):  at android.os.Handler.dispatchMessage(Handler.java:99)
11-06 23:24:07.895: E/AndroidRuntime(887):  at android.os.Looper.loop(Looper.java:123)
11-06 23:24:07.895: E/AndroidRuntime(887):  at android.app.ActivityThread.main(ActivityThread.java:4627)
11-06 23:24:07.895: E/AndroidRuntime(887):  at java.lang.reflect.Method.invokeNative(Native Method)
11-06 23:24:07.895: E/AndroidRuntime(887):  at java.lang.reflect.Method.invoke(Method.java:521)
11-06 23:24:07.895: E/AndroidRuntime(887):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
11-06 23:24:07.895: E/AndroidRuntime(887):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
11-06 23:24:07.895: E/AndroidRuntime(887):  at dalvik.system.NativeStart.main(Native Method)
11-06 23:24:07.895: E/AndroidRuntime(887): Caused by: java.lang.IllegalStateException: System services not available to Activities before onCreate()
11-06 23:24:07.895: E/AndroidRuntime(887):  at android.app.Activity.getSystemService(Activity.java:3526)
11-06 23:24:07.895: E/AndroidRuntime(887):  at android.widget.ResourceCursorAdapter.<init>(ResourceCursorAdapter.java:49)
11-06 23:24:07.895: E/AndroidRuntime(887):  at android.widget.SimpleCursorAdapter.<init>(SimpleCursorAdapter.java:84)
11-06 23:24:07.895: E/AndroidRuntime(887):  at com.adoherty.assignment3.ModuleDataSource.getData(ModuleDataSource.java:74)
11-06 23:24:07.895: E/AndroidRuntime(887):  at com.adoherty.assignment3.MainActivity.onCreate(MainActivity.java:17)
11-06 23:24:07.895: E/AndroidRuntime(887):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
11-06 23:24:07.895: E/AndroidRuntime(887):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
11-06 23:24:07.895: E/AndroidRuntime(887):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T23:26:42.063

`ModuleDataSource extends ListActivity`..您正在您的活动中创建一个实例..您不能将活动实例化为这样的对象

您的 ListActivity 可能会尝试进行一些通常在后台自动为您进行的系统调用。由于您试图将 ListActivity 实例化为对象，因此没有发生正常的 Activity 过程......

您应该将 ListActivity 中的内容移动到您的主要活动中，并使您的主要活动成为 ListActivity

像这样的东西：

```
public class MainActivity extends ListActivity {

    private SQLiteDatabase myDatabase;
    private ModuleDB myhelper;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        myhelper = new ModuleDB(this);
        open();
        getData();
        close();
    }

    public void open() throws SQLException { //Open the database for writing
        myDatabase = myhelper.getWritableDatabase();
    }

    public void close(){ //Close the database
        myhelper.close();
    }

    public void getData(){
        String[] columns = new String[] {ModuleDB.KEY_ROWID, 
                ModuleDB.KEY_MODCODE,
                ModuleDB.KEY_MODNAME,
                ModuleDB.KEY_LECPRAC,
                ModuleDB.KEY_DAYS,
                ModuleDB.KEY_TIMESTART,
                ModuleDB.KEY_TIMEEND,
                ModuleDB.KEY_LOCATION,
                ModuleDB.KEY_INFO};
        int[] to = new int[]{R.id.modcode_entry,
                             R.id.modname_entry,
                             R.id.modlecprac_entry,
                             R.id.modday_entry,
                             R.id.modtimestart_entry,
                             R.id.modtimeend_entry,
                             R.id.modlocation_entry,
                             R.id.modaddinfo_entry};

        Cursor curs = myDatabase.query(ModuleDB.DB_TABLE, columns, null, null, null, null, null);
        startManagingCursor(curs);

        SimpleCursorAdapter dataSource = new SimpleCursorAdapter(ModuleDataSource.this, R.layout.list_entry, curs, columns, to);
        setListAdapter(dataSource);

        }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:12:48.833

您正在 Activity 构造函数中执行某些操作，而应该在 onCreate() 中完成。

这可能与此问题相同：[系统服务在 onCreate 之前对活动不可用？](https://stackoverflow.com/questions/5905587/system-services-not-available-to-activities-before-oncreate)

# mysql - MySQL“加载数据本地infile”只加载1行

> ID：13260750
> 
> 赞同：1
> 
> 时间：2012-11-06T22:54:07.073
> 
> 标签：mysql, import, load-data-infile

我需要将 csv 文件上传到我的 MySQL 表。出于某种原因，当我在 Mac Terminal 中运行以下命令时，只插入了一行。如何上传所有行？

```
load data local infile 'Research/cube_sample_data.csv' 
into table ad_spend 
fields terminated by ',' 
lines terminated by '\n'; 
```

我试过`'\r\n'`但`',\r\n'`没有成功。我不断收到此消息：

```
Query OK, 1 row affected, 0 warnings (0.00 sec)
Records: 1  Deleted: 0  Skipped: 0  Warnings: 0 
```

我的文件是这样的：

```
entertainment, games, 14

entertainment, movies, 12 
```

我有一个空表，有 3 列：

```
category (varchar), subcat (varchar), adspend (int) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T23:34:34.973

似乎字段之间不仅有逗号，而且还有空格。所以尝试使用：

```
fields terminated by ', ' 
```

# .net - 在应用程序之间传递数据库凭据

> ID：13260751
> 
> 赞同：0
> 
> 时间：2012-11-06T22:54:15.823
> 
> 标签：.net, oracle, authentication

我正在开发一个具有单点登录功能的轻量级 .NET 框架（用于内部目的）。首先启动一个主应用程序，它要求用户登录。之后，向用户显示要启动的应用程序列表。

这些辅助应用程序是独立的应用程序，但它们需要使用与传递给主应用程序的凭据相同的凭据来登录数据库 (Oracle)。

有没有一种安全的方法来实现这一点？通过在以某种方式加密的命令行上传递信息，或者两个应用程序以一种或另一种方式通信（主应用程序可以访问执行辅助应用程序的进程）。

如果提供更多功能（即将可执行文件加载到应用程序域并以这种方式运行），则以不同方式启动这些应用程序也是可能的。

# iphone - 两部 iPhone 的故事 - 一部会崩溃，一部不会

> ID：13260759
> 
> 赞同：0
> 
> 时间：2012-11-06T22:55:11.377
> 
> 标签：iphone, objective-c, ios

我的一位用户报告说，当他们从我的应用程序导出文件时，MailComposer 出现，然后冻结。那时，他们必须完全关闭应用程序。他们报告说等待一个小时没有帮助。该用户使用的是运行 iOS 6.0.1 的 iPhone 4。

因此，我启动了从 App Store 下载的相同版本的应用程序到运行 iOS 6.0.1 的 iPhone4。当我去导出文件时，一切正常，我可以导出曲目。

接下来，我将导出的文件发送给他，以确保我们导出的是同一个文件。当他导入文件，然后尝试导出它时，同样的事情发生了。当 MailComposer 屏幕出现时，他的手机再次死机。

我不知道如何调试这个问题。我能做些什么？

**编辑 2：用户报告删除并重新安装应用程序更正了问题。我仍然想知道潜在的问题可能是什么。**

**编辑：这是我的代码：**

```
MFMailComposeViewController* controller = [[MFMailComposeViewController alloc] init];
controller.mailComposeDelegate = self;
if (gpsFilePath) {
  [controller addAttachmentData:[NSData dataWithContentsOfFile:gpsFilePath] mimeType:@"text/gpx" fileName:[self cleanFileName]];
  [controller addAttachmentData:[NSData dataWithContentsOfFile:kmlFilePath] mimeType:@"text/kml" fileName:[self cleanKMLFileName]];
}
[controller setSubject:subject];
[controller setMessageBody:body isHTML:YES];   
[[MAP_APP_DELEGATE mainController] presentModalViewController:controller animated:YES]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:29:51.843

有趣的问题。如果它没有崩溃并且只是停在某个屏幕上，那么您可能在某个地方出现了无限循环。

以下是我将探索的一些途径（但其中大多数假设用户愿意付出很多努力来帮助您调试此问题，这可能不太可能）：

*   你上面的代码是在主线程中运行的吗？

*   尝试更小或更简单的数据文件，您可能能够隔离导致这种情况的某些类型的数据。

*   让用户向您发送他的数据，然后尝试使用该数据进行复制。

*   让用户成为您的 Beta 测试人员之一。您必须获取他的 UDID 并将其添加到您的配置文件中。我建议使用 TestFlight 轻松地为您的 beta 测试人员获取测试版本。它们允许您查看用户会话中的崩溃日志和其他有用的统计信息。您还可以设置“检查点”以查看您的用户在冻结前走了多远。

*   为该用户提供注释掉附件功能或注释掉各种其他部分的构建，以至少查明导致冻结的原因。

*   与 CaptureRecord 库集成，该库可以录制用户体验的视频，因此您可以实际看到他所看到的内容。它保存了一个视频，然后他可以将其发送给您。可以让您更好地了解正在发生的事情。

*   如果他们有 Mac，他们可以安装 Xcode，只是为了将 Organizer 用于他们可以发送给您的控制台输出。否则，请参阅下一个想法。

*   在您的测试版本中，实现一个可以保存到设备上的文本文件的应用内控制台。然后可以使用 iExplorer 获取它，由用户阅读，然后通过电子邮件发送或以其他方式发送给您。基本上，实现一个围绕 NSLog 的包装器，它还将所有输出保存到文本文件或字符串，并将其保存到磁盘，或者至少可以显示给用户。这将模拟您在 Xcode 中的控制台输出。您可能需要一个管理界面才能打开/关闭它，因为它可能会降低您的应用程序的速度。确保您的应用中有大量调试输出。如果它是一个无限循环，你会看到一行永远重复。否则，您至少可以看到冻结之前的最后一行代码是什么。

*   确保实现所有邮件编写器委托的功能，并至少将它们记录到控制台输出。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:04:26.277

听起来我的应用程序有问题。该应用程序将屏幕截图附加到电子邮件中。有时他们崩溃了，有时他们没有。这取决于设备分辨率和图像的最终大小。你可能有类似的事情发生。您对使用 MailCompose 所做的事情说得还不够，但我通过将将图像传递给邮件编写器的代码位包装在一个`@autoreleasepool`块中解决了我的问题。我的代码是这样的：

```
@autoreleasepool
{
    NSData *img = [self getImageFromChart:chartView];
    [mailController addAttachmentData:img mimeType:@"image/png" fileName:@"app1.png"];
    img = nil;

    img = [self getImageFromGrid:webView];
    [mailController addAttachmentData:img mimeType:@"image/png" fileName:@"app2.png"];
    img = nil;
}
[self presentModalViewController:mailController animated:YES]; 
```

# java - 计算包含一些 Null 的数组中的数据量

> ID：13260760
> 
> 赞同：1
> 
> 时间：2012-11-06T22:55:15.150
> 
> 标签：java

我正在用 java 编码，我需要创建一个函数来返回当前在 ArrayList 中的数据对象的数量。目前我有这个：

> ```
>  int count = 0;
>     for (int i = 0; i < data.length; i++)
>     { 
>         if (data[i] != null)
>         {
>             count ++;
>         }
>     }
>     return count; 
> ```

但问题是包含空数据的数组列表是可以接受的，我必须将它们的空数据计入该计数器。如何包含此数组中间的空数据，而不是不应计算的空数据？

例如，我有一些测试代码将 (8),null,null,(23),(25) 添加到数组中，当初始数组大小为 10 时，此函数应返回 5。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:00:50.573

我将假设您使用的是常规数组（您的问题对此有些模棱两可）。向后遍历数组，直到找到一个非空元素：

```
public static int count(Object[] a) {
    int i = a.length - 1;
    for (; i >= 0 ; i--)
        if (a[i] != null)
            break;
    return i + 1;
} 
```

你也可以有

```
public static <T> int count(T[] a) {
    int i = a.length - 1;
    for (; i >= 0 ; i--)
        if (a[i] != null)
            break;
    return i + 1;
} 
```

* * *

让我们使用与您提供的示例类似的示例对其进行测试：

```
Object[] a = new Object[10];
a[0] = new Object();
a[3] = new Object();
a[4] = new Object();
System.out.println(count(a)); 
```

输出：

```
5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:58:20.583

您将需要两个单独的计数器。第一个将正常计数。当您找到`null`数据时，第二个开始计数。然后当你找到一个非空数据时，只需将第二个计数器加到第一个计数器上，然后继续用第一个计数器计数，直到你再次找到一个空值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T22:59:50.630

```
int count = 0;
for (int i = data.length - 1; i >= 0; i--)
    if (data[i] != null || count > 0)
        count += 1;
return count; 
```

至少这就是我理解您的要求的方式 - 计算空值，但尾随空值除外。

但也许这实际上不是你的意思？

### 编辑

除非您实际使用`ArrayList`（如 Jon 所问），否则 where`.size()`与*容量*不同，并将计算所有添加的元素（包括空值）。实际上，您甚至无法从`ArrayList`.

# node.js - 保存时返回所有唯一索引错误

> ID：13260769
> 
> 赞同：0
> 
> 时间：2012-11-06T22:56:04.673
> 
> 标签：node.js, mongoose

我必须遵循代码：

```
var UserSchema = mongoose.Schema({
  email: {
    type: String,
    unique: true
  },
  username: {
    type: String,
    unique: true
  }
});

var User = db.model('User', UserSchema);

var user = new User();

user.email = 'some@email.com'
user.username = 'peter'

user.save(function(err){
  if (err) return console.log(err)
  console.log('user saved')
}) 
```

在第一次运行时，它显示`user saved`完全没问题。在第二次运行时，它给了我

```
{ [MongoError: E11000 duplicate key error index: node-login.users.$username_1  dup key: { : "peter" }]
  name: 'MongoError',
  err: 'E11000 duplicate key error index: node-login.users.$username_1  dup key: { : "peter" }',
  code: 11000,
  n: 0,
  lastOp: 0,
  connectionId: 1455732,
  ok: 1 } 
```

呢`email`？它也是重复的，应该返回一个错误。如果每次只抛出一个错误，为什么它是`username`而不是`email`？在架构`email`的上方。`username`如何`mongoose`决定首先检查/返回哪些重复项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:46:32.543

这样做的不是 Mongoose，而是 MongoDB。标记的两个重复字段中的哪一个可能未定义。我认为只要它检查的第一个索引未通过唯一性测试，它就会简单地抛出错误。

If you need more information than what's provided in the error, you'll need to query for all potential duplicate fields separately.

# c# - 如何在c#中解决以下方法问题

> ID：13260771
> 
> 赞同：0
> 
> 时间：2012-11-06T22:56:07.617
> 
> 标签：c#

我的主要内容是：

```
static void Main(string[] args)
    {
        Money m1 = new Money(2315.99);

        Money m2 = new Money(4000, 25);

        Console.WriteLine(m1);
        Console.WriteLine(m2);

        Console.WriteLine(m1.IncrementMoney(m2));
    }

    public void IncrementMoney(Money x)
    {
        //what do I put in here?
    } 
```

所以
`Money m1 = new Money(2315.99);`
应该把 2315.99 变成 "$2315.99"

和

`Money m2 = new Money(4000, 25);`
形成“$4000.25”

我在 Money 课上完成了所有这些工作，而且效果很好。

现在我应该做的是将这两个加在一起使用
`m1.IncrementMoney(m2);`

这是我的“金钱”课

```
class Money
{

    //instance variables
    private int dollars;
    private int cents;

    double amount;

    public int Dollars
    {
        get { return dollars; }
        set
        {
            if (value > 0)
                dollars = value;
        }
    }

    public int Cents
    {
        get { return cents; }
        set
        {
            if (value > 0)
                cents = value;
        }
    }

    public Money(int Dol, int Cen)
    {
        Dollars = Dol;
        Cents = Cen;

        double Dollar = Convert.ToDouble(Dollars);
        double Cent = Convert.ToDouble(Cents);

        amount = Dollar + (Cent / 100);

    }

    public Money(double am)
    {
        int dol = Convert.ToInt32(am);

        if (dol > am)
            Dollars = dol - 1;

        else if (dol < am)
            Dollars = dol;
        //Dollars

        double cen = am % 1;

        cen = cen * 100;

        Cents = Convert.ToInt32(cen);
        //Cents

        double Dollar = Convert.ToDouble(Dollars);
        double Cent = Convert.ToDouble(Cents);

        amount = Dollar + (Cent / 100);
    }

    //override ToString()
    public override string ToString()
    {
        return string.Format("{0:c}", amount);
    }

}//end class Money 
```

但我不知道在该`IncrementMoney`方法中添加什么。
请帮忙？
如果不是太麻烦，也许对它的工作原理有一点了解？我真的很想知道。

抱歉，如果我没有提供足够的信息，
如果需要其他任何信息，请告诉我。
谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:28:15.697

由于`IncrementMoney`应该将两个货币值相加，因此您的用法看起来应该是该类型的[扩展方法。](http://msdn.microsoft.com/en-us/library/vstudio/bb383977.aspx)`Money`这很好，因为扩展方法非常棒。这个网站上的一个常见笑话是它们是解决所有问题的方法。

您的代码应类似于：

```
public static Money IncrementMoney(this Money x, Money y)
{
   var totalCents = x.Cents + y.Cents;
   var retCents = totalCents / 100;
   var retDollars = x.Dollars + y.Dollars + (totalCents % 100)
   return new Money(retDollars, retCents);
} 
```

至于快速解释...

通过添加`this`到第一个参数，我们告诉 C# 我们要编写一个扩展方法。这意味着我们正在编写的这个方法将挂起`this`参数的类型（在本例中为`Money`），并允许我们像在 .NET 框架中一样使用它。扩展方法必须是静态的，所以你不能不使用那个修饰符。除此之外，您只需编写一个方法来做您想做的任何事情，就像您通常会做的那样！

不过，我建议您将其命名为`IncrementMoney`. 这不是很具有描述性。 `AddMoney`会更好。

顺便说一句，您还可以查看[运算符重载](http://msdn.microsoft.com/en-us/library/aa288467%28v=vs.71%29.aspx)。您可以修改我刚刚写的内容，以简单地使用`+`运算符来执行完全相同的操作，如下所示：

```
public static Money operator +(Money x, Money y)
{
   var totalCents = x.Cents + y.Cents;
   var retCents = totalCents / 100;
   var retDollars = x.Dollars + y.Dollars + (totalCents % 100)
   return new Money(retDollars, retCents);
} 
```

有了这个定义，您可以简单地`m1 + m2`将它们添加到一起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:05:35.407

```
public void IncrementMoney(Money x)
{
    this.Dollars += x.Dollars;

    var newCents = this.Cents + x.Cents;
    this.Cents = newCents % 100;

    this.Dollars += newCents / 100;
} 
```

而且我实际上会命名该函数`Add`，因为您正在获取当前值并添加提供的值，并且不需要 Money 修饰符，因为它应该在 Money 类上并采用 Money 对象

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T23:06:56.580

那么首先这一行：

```
Console.WriteLine(m1.IncrementMoney(m2)); 
```

表示`IncrementMoney`应该返回一些东西，但现在它返回`void`.

所以它看起来应该是这样的：

```
public void IncrementMoney(ClassA x)
{
    this.Value += x.Value;
} 
```

然后显示它：

```
ClassA m1 = new ClassA(2315.99);

ClassA m2 = new ClassA(4000, 25);

Console.WriteLine(m1);
Console.WriteLine(m2);

m1.IncrementMoney(m2);

Console.WriteLine(m1); 
```

# c# - SmtpException：客户端或服务器仅配置为具有 ASCII 本地部分的电子邮件地址

> ID：13260772
> 
> 赞同：18
> 
> 时间：2012-11-06T22:56:19.837
> 
> 标签：c#, .net, smtp, smtpclient

当我尝试将电子邮件发送到包含重音字符 (é) 的地址时， [SmtpClient.Send()方法会引发此异常：](http://msdn.microsoft.com/en-us/library/swas0fwc.aspx)

> System.Net.Mail.SmtpException：客户端或服务器仅配置为具有 ASCII 本地部分的电子邮件地址：léo.xxx@example.com。
> 在 System.Net.Mail.MailAddress.GetAddress(Boolean allowUnicode)
> 在 System.Net.Mail.SmtpClient.ValidateUnicodeRequirement(MailMessage...)
> 在 System.Net.Mail.SmtpClient.Send(MailMessage 消息)

消息的制定使我觉得可能有一个设置可以激活以使这项工作正常进行，尽管我还没有找到有关此主题的任何内容。

我尝试了几个 SMTP 服务器，包括 Gmail。以下是重现的相关位：

**代码**

```
var msg = new MailMessage();
msg.Subject = "Test";
msg.From = new MailAddress("xxx@gmail.com");
msg.To.Add(new MailAddress("léo.yyy@gmail.com"));

new SmtpClient().Send(msg); 
```

**应用程序配置**

```
<system.net>
    <mailSettings>
        <smtp from="xxx@gmail.com">
            <network host="smtp.gmail.com" port="587" userName="xxx@gmail.com" password="password" enableSsl="true" />
        </smtp>
    </mailSettings>
</system.net> 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-04-17T14:24:27.210

如果您的实例的[DeliveryFormat](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.deliveryformat.aspx)属性`SmtpClient`设置为[`SmtpDeliveryFormat.SevenBit`](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpdeliveryformat.aspx)（默认值），那么您需要确保您的 SMTP 网关在尝试发送电子邮件`SMTPUTF8`时由 .NET 发送时回复。使用它来确定网关是否能够支持 UTF8。`EHLO``SmtpClient`

根据 .NET Framework 4.5+ 和 .NET core 的源，接收服务器必须支持 UTF8 并且`DeliveryFormat`必须设置为`SmtpDeliveryFormat.International`才能发送。

有关最新逻辑和完整详细信息，请参见`IsUnicodeSupported`：

*   [当前的 .NET 源](https://github.com/dotnet/runtime/blob/main/src/libraries/System.Net.Mail/src/System/Net/Mail/SmtpClient.cs)
*   [.NET 框架参考源](https://referencesource.microsoft.com/#System/net/System/Net/mail/SmtpClient.cs)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-03-09T18:14:41.907

迟到的答案，但是，我通过指定这样的编码解决了这个问题：

```
var mailMessage = new MailMessage
            {
               From = new MailAddress("test@domain.co.zw", "Test User", Encoding.UTF8)
} 
```

就我而言，服务器导致了错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-08T08:00:34.227

下面的代码对我有用。

```
SmtpClient smtpClient = new SmtpClient(SMTPServer, SMTPPort)
{
    Credentials = new NetworkCredential("SMTPUserName", "SMTPPassword"),
    EnableSsl = true,
    DeliveryFormat = SmtpDeliveryFormat.International,
}; 
```

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2012-11-07T03:44:14.590

.net 仅支持 ASCII 字符。我不相信它支持扩展的 ASCII 字符（包括有问题的重音 e）。

[http://www.asciitable.com/](http://www.asciitable.com/)

我们在用户尝试将丹麦语字符用于 a / e 时遇到了同样的问题。

# httpwebrequest - 使用 NetworkCredential 设置的后续 HttpWebRequest 尊重最近更改的域密码

> ID：13260776
> 
> 赞同：1
> 
> 时间：2012-11-06T22:56:29.137
> 
> 标签：httpwebrequest, windows-authentication, networkcredentials

我们收集 Windows 域用户名和密码，并通过 Web 前端将其保存在 cookie 中。这些凭据以及对特定数据的请求最终通过托管在 Windows 服务中的 WCF 调用传递，该调用本身将其作为新的 REST 调用重定向到配置了 Windows 身份验证的 IIS 下的另一个服务器设置。这是使用 HttpWebRequest 完成的...

```
var url = baseServerUrl + "/" + apiCall.Url;
var request = (HttpWebRequest)WebRequest.Create(url);
request.Timeout = 1000000;
request.Method = apiCall.HttpMethod;
bool credentialsSet = false;
if (!string.IsNullOrEmpty(apiCall.Identity))
{
    // split into Domain\User\Password
    var parts = apiCall.Identity.Split('\\');
    if (parts.Length == 3)
    {
        request.Credentials = new NetworkCredential(parts[1], parts[2], parts[0]);
        credentialsSet = true;
    }
}
// Then more code submitting the request ... 
```

因此，如果我将 cookie 域密码 A 存储在 cookie 中，通过上述方式发出请求（一切正常），然后将我的 windows 域密码更改为 B，我们为后续请求找到的是上面的代码（再次作为 windows 运行服务）在接收和设置 NetworkCredential 上的 A 时会很高兴地进行身份验证（接收 A，因为 cookie 仍然使用旧密码）。如果我们立即重新启动服务，任何进一步尝试使用密码 A 的 HttpWebRequest 和 NetworkCredential 都会生成 401。为什么在重新启动之前会使用旧的域密码？你如何阻止这种行为？

# c++ - 线程阻塞了整个程序

> ID：13260777
> 
> 赞同：2
> 
> 时间：2012-11-06T22:56:33.383
> 
> 标签：c++, multithreading, block

我正在尝试制作多客户端服务器。我有这个线程：

```
void client_thread(int new_socket)
{
    int size;
    char inbuffer[BUF];

    do
    {
        cout << "Waiting for messages: " << endl;
        size = recv(new_socket, inbuffer, BUF, 0);
    } while (true);
} 
```

这个主要程序：

```
int main()
{
    while (true)
    {
        //waiting for clients
        cout << "Waiting for connections..." << endl;
        new_socket = accept ( create_socket, (struct sockaddr *) &cliaddress, &addrlen );

        //new client connected
        if (new_socket > 0)
        {
            //start thread
            thread(client_thread, new_socket).join();
        }
    }
    return 0;
} 
```

当第一个客户端连接时，线程启动并且服务器正在等待来自他的消息。但是服务器不再等待新客户端。我不知道为什么。是因为`do-while`线程函数内部的无限循环吗？如果线程包含无限循环，它们会阻塞您的整个程序，那么线程的意义何在？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T22:59:19.163

主程序阻塞，因为它等待线程完成：`join()`.

如果您不想阻止，请不要`join()`使用您的 client_thread。

此异常可能来自您的匿名线程对象的破坏。当你离开作用域时`if()`，这个作用域内的所有对象都被销毁。从[http://en.cppreference.com/w/cpp/thread/thread/~thread](http://en.cppreference.com/w/cpp/thread/thread/~thread)你可以看到，析构函数调用`terminate()`. 为避免它，您可以调用`detach()`. 所以代替`thread(client_thread, new_socket).join();`，你必须说`thread(client_thread, new_socket).detach();`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T23:20:51.710

您应该创建一个线程并保留对它的引用，直到您加入它。在您的代码中，线程对象在创建后立即被释放，因此如果不立即调用 join 则会出现错误。

为了正确实现这一点，最好的方法是在堆上分配对象，使用运算符`new`并将指针存储在某个列表中。当线程完成时，它可能会从列表中删除自己（不要忘记“互斥”它），或者您可以让另一个专用线程这样做：也许您可以简单地让您的主线程在退出之前加入所有其他线程。

# vb.net - Linq to XML 在每个节点的 XML 中插入一个新元素

> ID：13260779
> 
> 赞同：1
> 
> 时间：2012-11-06T22:56:34.970
> 
> 标签：vb.net, linq-to-xml

我想在以下 XML 中为数据节点的每个实例插入一个新元素

**这是我拥有的初始 XML：**

```
<dataCollection totalCount="12" pageCount="1">
    <data>
        <date>2011-11-10T00:00:00.000-05:00</date> 
        <dataType>PRCP</dataType> 
        <station>GHCND:USW00014739</station> 
        <value>267</value> 
        <address>
            <home>X</home> 
        </address>
    </data>
    <data>
        <date>2011-11-10T00:00:00.000-05:00</date> 
        <dataType>PRCP</dataType> 
        <station>GHCND:USW00014739</station> 
        <value>267</value> 
        <address>
            <home>X</home> 
       </address>
    </data>
</dataCollection> 
```

**这就是我想要实现的 XML**

```
<dataCollection totalCount="12" pageCount="1">
    <data>
        <date>2011-11-10T00:00:00.000-05:00</date> 
        <dataType>TMIN</dataType> 
        <station>GHCND:USW00014739</station> 
        <value>267</value> 
        <newValue>60</newValue>  
        <address>
            <home>X</home> 
        </address>
    </data>
    <data>
        <date>2011-11-10T00:00:00.000-05:00</date> 
        <dataType>TMAX</dataType> 
        <station>GHCND:USW00014739</station> 
        <value>270</value>
        <newValue>62</newValue>  
        <address>
            <home>X</home> 
        </address>
    </data>
</dataCollection> 
```

XML 数据用作使用以下 Linq 的 DataGrid 的数据源。

```
Dim elements = (From daDsc In xdoc.Descendants("data") _
            Select Data_Type = daDsc.Element("dataType").Value, _
            Raw_Value = daDsc.Element("value").Value,
            newValue = daDsc.Element("newValue")) 
```

在 VB.net 中编写这个，但在 C# 中的答案是可以的。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T02:21:08.357

尝试这个：

```
foreach (var xe in xml.Descendants("data"))
{
    xe.Element("value")
        .AddAfterSelf(new XElement("newValue", 42));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T02:12:54.757

如果您希望`newValue`在处理之前添加到您的 XML 中，您可以执行以下操作：

```
For Each element As XElement In xml.Elements
  element.SetElementValue("newValue", "something")
Next 
```

从您的 Web 服务加载`xml`的,在哪里。`XDocument`

# css - div 不适合内容

> ID：13260780
> 
> 赞同：0
> 
> 时间：2012-11-06T22:56:38.900
> 
> 标签：css, width

我有一个问题，即 div 在包含长词时不适合内容。它只需要最大宽度。

截屏：

[http://img687.imageshack.us/img687/3253/photondf.png](http://img687.imageshack.us/img687/3253/photondf.png)

我希望 div 与没有 javaScript 的内容具有相同的宽度。

HTML

```
<div class="div">
    <p>fkjdajfkdjfkdjfkdfjkdfjkdfjdfdjkfkjfdkdfioiewtiovvuiocuvicxvocxvuiocxvucioxbuvbhxjk
    civuiozxviopucvicvuvjcizoxvopcxvpiovxzijpvxzicovpzvjijopcvzxpvjiocvpjzvicvzpjvci.</p>
<div> 
```

CSS

```
.div {
    float: left;
    background:red;
    max-width: 900px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T23:03:54.850

究竟试图让 div 做什么？您是否希望它缩小到内容的大小但不大于 900 像素？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:05:03.587

如果您不希望您的 div 大于 900 像素，请尝试`width: auto;`但保留。`max-width`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T23:05:19.743

好吧，这里有几个问题。

1.  里面的内容`p`根本没有空间。换句话说，它不能在多行上“拆分”单词。而且您的 div 实际上确实具有正确的宽度。

2.  除非您真的不想将其拆分为多行。您可以`overflow`在 div 上定义为`auto`或`hidden`。在这种情况下，`auto`将添加滚动条并`hidden`简单地隐藏过去的内容。

3.  如果`overflow`在`p`或 上`div`，您实际上可以在 css3 中强制换行：http: [//www.w3schools.com/cssref/css3_pr_word-wrap.asp](http://www.w3schools.com/cssref/css3_pr_word-wrap.asp)

4.  由于您为 div 定义了宽度，因此它实际上总是使用该宽度，并且不再使用。（不要将溢出的文本算作比 div 大）。在计算布局大小和围绕此 div 的其他 div 的位置时，不应考虑溢出的文本。

顺便说一句，如果您在实际存在空格时遇到问题，那么像这样的非常长的字符串并不是一个很好的“用例”。你应该把它贴在这里而不是那个。

**编辑**

您的 div 不能用长词“适应”内容，它将扩展到可能的最大宽度，然后当达到最大宽度时，它将换行到另一行。如果单词大于 div 它将溢出。

**编辑 2**

如果你真的想这样做，有办法。但这很丑陋。您必须`<br />`在每个长词后添加一个。如果您在模板引擎中传递文本，您甚至可以`<br />`用 css 替换您的空格。但老实说，不要那样做。

# php - 使用 PDO 抓取所有帖子的函数的可选 LIMIT

> ID：13260783
> 
> 赞同：1
> 
> 时间：2012-11-06T22:56:50.033
> 
> 标签：php, mysql, pdo, limit, posts

我正在尝试创建一个函数来获取表格中的所有帖子。我还想添加一个可选的 LIMIT 参数。这是一个例子：

```
function get_all_posts($conn, $limit = 0) {
if ($limit > 0) {
    $stmt = $conn->prepare("SELECT * FROM posts LIMIT :limit");
    $stmt->execute(array(
        ':limit' => $limit
    ));
    $results = $stmt->fetchAll();
    return $results ? $results : false ;
} else {
    $stmt = $conn->prepare("SELECT * FROM posts");
    $stmt->execute();
    $results = $stmt->fetchAll();
    return $results ? $results : false ;
}
} 
```

如果我在不使用限制参数的情况下调用该函数，它会起作用并显示所有帖子。但如果我这样调用函数： get_all_posts($conn, "1"); 然后我得到这个错误：

> 致命错误：未捕获异常 'PDOException' 并带有消息 'SQLSTATE[42000]：语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在 /Applications/MAMP/htdocs/sandbox/blog2/functions.php:19 中的第 1 行的“1”附近使用正确的语法 堆栈跟踪：#0 /Applications /MAMP/htdocs/sandbox/blog2/functions.php(19): PDOStatement->execute(Array) #1 /Applications/MAMP/htdocs/sandbox/blog2/index.php(12): get_all_posts(Object(PDO), '1') #2 {main} 在第 19 行的 /Applications/MAMP/htdocs/sandbox/blog2/functions.php 中抛出

谁能告诉我我哪里出错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T23:00:15.683

`1`不是字符串，所以不要在此处加上引号：`get_all_posts($conn, 1);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T23:02:47.127

默认情况下，PDO[`execute()`](http://www.php.net/manual/en/pdostatement.execute.php)将参数视为字符串。因此，它正在引用`"1"`. 您将需要使用[`bindParam()`](http://www.php.net/manual/en/pdostatement.bindparam.php).

虽然 MySQL 可以处理这个，你应该相应地绑定这个参数（作为一个 INT）。有关更多详细信息，请参阅此[相关问题](https://stackoverflow.com/questions/5793340/reasons-to-strongly-type-parameters-in-pdo)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T23:03:15.070

就像 Sammitch 说的那样，因为它是一个字符串，而不是一个整数。使用它来修复：

```
if (is_numeric($limit)) {
    $limit = (int)$limit;
    ... 
```

清除任何变量类型问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T23:22:45.400

在`LIMIT`子句中，您需要一个整数参数。

在您的代码中，您传递`:limit' parameter's value via`所有字符串的执行`。

字符串不是整数。这种不匹配会产生您的问题。

而是将参数设置为整​​数，你很好。

```
$stmt = $conn->prepare("SELECT * FROM posts LIMIT :limit");
$stmt->bindParam(':limit', $limit, PDO::PARAM_INT);
$success = $stmt->execute();
$results = $stmt->fetchAll(); 
```

当您通过函数参数接受`$limit`变量时，您还应该清理它的值：

```
$limit = (int) $limit; 
```

这将确保您在将其绑定为整数参数时使用整数类型的变量。

# c# - 不能以不同的形式将项目添加到 ListBox

> ID：13260788
> 
> 赞同：-1
> 
> 时间：2012-11-06T22:57:11.100
> 
> 标签：c#, visual-studio-2012

我正在尝试构建一个可以在 ListBox 控件中存储不同人员的应用程序。

我的 ListBox 控件位于**Form1**中，这种方法也给我带来了一些问题：

```
 public void addPersonToList(Person person) {
            string newPerson = person.firstName + " " + person.lastName + " " + person.age;

            personList.Items.Add(newPerson);

 } 
```

在另一种形式中，我这样调用 addPersonsToList 方法：

```
Form1 form1 = new Form1();
  form1.addPersonToList(person); 
```

现在，我已经检查（在调试时）addPersonToList 中的字符串**newPerson**实际上存储了正确的字符串。**问题是字符串不会出现在我的 ListBox**（名为 personList）中。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T22:59:19.320

使用`new`，您正在创建一个项目的全新实例。

```
Form1 form1 = new Form1();
form1.addPersonToList(person); 
```

因此，此代码创建 Form1 的一个新实例并向该实例添加一个项目，这可能不是您正在查看的那个。您以某种方式需要对正在显示的实例的引用，以便您可以引用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:13:31.790

要引用现有的打开表单，请执行以下操作：

```
foreach (Form frm in Application.OpenForms)
{
     if (frm.GetType() == typeof(Form1))
     {
          Form1 frmTemp = (Form1)frm;
          frmTemp.addPersonToList(person);
          fromTemp.Dispose();
     }
} 
```

同样对于 MDI 表格：

```
foreach (Form frm in MdiParent.MdiChildren)
{
} 
```

# c - Arduino - 如何将 char* 复制到 char** 中？

> ID：13260801
> 
> 赞同：-1
> 
> 时间：2012-11-06T22:58:59.860
> 
> 标签：c, char, arduino

我正在使用 Arduino，我有这样的代码：

```
char *swap[100];
prog_char settings1[] PROGMEM = "option 1";
prog_char settings2[] PROGMEM = "option 2";
prog_char settings3[] PROGMEM = "option 3";

PROGMEM char* general[] = {sttings1, settings2, settings3}; 
```

在一个函数中，我传递`general[]`数组：

```
void fillArray(char *arr[]){
    for(int i=0; i<2; i++){
        strcpy_P(swap,(char*)pgm_read_word(&(arr[i])));  <== Error
    }
} 
```

我需要从中提取字符`arr[]`并将它们存储在`swap[]`数组中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T06:59:04.593

我认为你不需要`ampersand`,`arr`是一个数组`char *`

```
strcpy_P(swap,(char*)pgm_read_word(arr[i])); 
```

甚至会

```
strcpy_P(swap,pgm_read_word(arr[i])); 
```

# perl - 使用 AnyEvent (Perl) 创建单线程服务器

> ID：13260802
> 
> 赞同：5
> 
> 时间：2012-11-06T22:59:06.100
> 
> 标签：perl, webserver, anyevent

我正在创建一个本地服务来监听 localhost 并提供一个基本的调用和响应类型接口。我想开始的是一个婴儿服务器，您可以通过 telnet 连接到它并回显它接收到的内容。

我听说 AnyEvent 对此非常有用，但是 AnyEvent::Socket 的文档并没有给出如何做到这一点的很好的例子。我想用 AnyEvent、AnyEvent::Socket 和 AnyEvent::Handle 来构建它。

现在，小服务器代码如下所示：

```
#!/usr/bin/env perl

use AnyEvent;
use AnyEvent::Handle;
use AnyEvent::Socket;

my $cv = AnyEvent->condvar;

my $host = '127.0.0.1';
my $port = 44244;

tcp_server($host, $port, sub {
    my($fh) = @_;

    my $cv = AnyEvent->condvar;

    my $handle;
    $handle = AnyEvent::Handle->new(
        fh => $fh,
        poll => "r",
        on_read => sub {
             my($self) = @_;
             print "Received: " . $self->rbuf . "\n";
             $cv->send;
        }
    );

    $cv->recv;
});

print "Listening on $host\n";

$cv->wait; 
```

这不起作用，如果我 telnet 到 localhost:44244 我得到这个：

```
EV: error in callback (ignoring): AnyEvent::CondVar: 
recursive blocking wait attempted at server.pl line 29. 
```

我想如果我知道如何制作一个小型单线程服务器，我可以通过 telnet 连接到它并打印出它给定的任何内容，然后等待更多输入，我可以从那里走得更远。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-07T00:34:23.197

您在回调中阻塞。这是不允许的。有几种方法可以处理这个问题。我的偏好是从 tcp_server 回调中启动[Coro线程。](https://metacpan.org/module/Coro)但如果没有 Coro，您可能正在寻找这样的东西：

```
#!/usr/bin/env perl5.16.2

use AnyEvent;
use AnyEvent::Handle;
use AnyEvent::Socket;

my $cv = AE::cv;

my $host = '127.0.0.1';
my $port = 44244;

my %connections;
tcp_server(
           $host, $port, sub {
               my ($fh) = @_;

               print "Connected...\n";

               my $handle;
               $handle = AnyEvent::Handle->new(
                                               fh => $fh,
                                               poll => 'r',
                                               on_read => sub {
                                                   my ($self) = @_;
                                                   print "Received: " . $self->rbuf . "\n";
                                               },
                                               on_eof => sub {
                                                   my ($hdl) = @_;
                                                   $hdl->destroy();
                                               },
                                              );
               $connections{$handle} = $handle; # keep it alive.

               return;
           });

print "Listening on $host\n";

$cv->recv; 
```

请注意，我只在等待一个 condvar。我正在存储句柄以使 AnyEvent::Handle 对象保持更长时间。清理 $self->rbuf 的工作留给读者作为练习:-)

问题交叉发布，[也回答](http://www.perlmonks.org/index.pl?node_id=1002611):-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T00:19:22.790

我也听说过关于 AnyEvent 的好消息，但没有使用它。我过去使用 IO::Select 编写了一个小型非阻塞服务器。[该模块的文档中](http://search.cpan.org/~gbarr/IO-1.25/lib/IO/Select.pm)有一个示例（我添加了几行）：

```
use IO::Select;
use IO::Socket;

$lsn = new IO::Socket::INET(Listen => 1, LocalPort => 8080);
$sel = new IO::Select( $lsn );

while(@ready = $sel->can_read) {
    foreach $fh (@ready) {
        if($fh == $lsn) {
            # Create a new socket
            $new = $lsn->accept;
            $sel->add($new);
        }
        else {
            # Process socket
            my $input = <$fh>;
            print $fh "Hello there. You said: $input\n";

            # Maybe we have finished with the socket
            $sel->remove($fh);
            $fh->close;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T23:14:31.363

我不确定你的 condvar 试图在那里触发什么。使用它来发送状态，例如：

```
#!/usr/bin/env perl

use AnyEvent;
use AnyEvent::Handle;
use AnyEvent::Socket;

my $host = '127.0.0.1';
my $port = 44244;

my $exit = AnyEvent->condvar;

tcp_server($host, $port, sub {
    my($fh) = @_;

    my $handle; $handle = AnyEvent::Handle->new(
        fh => $fh,
        poll => "r",
        on_read => sub {
             my($self) = @_;
             print "Received: " . $self->rbuf . "\n";
             if ($self->rbuf eq 'exit') {
               $exit->send;
             }
        }
    );

});

print "Listening on $host\n";

$exit->recv; 
```

# javascript - 这是 jquery 中的跨域问题吗？

> ID：13260806
> 
> 赞同：0
> 
> 时间：2012-11-06T22:59:39.427
> 
> 标签：javascript, jquery, ajax

我不确定这是否是跨域问题。我正在尝试使用`$.ajax`加载文件。但是我得到了一些文件 readyState=4 和一些文件我得到了 readyState=1

这是我运行茉莉花测试的路径 `file:///home/myname/development/path1/path2/src/test/java/javascript/jasmine/SpecRunner.html`

在代码中，我使用 jQuery.pyte 来要求相关文件。但是当代码涉及 $.ajax 时，它停留在 readyState:1

如果我这样做，它会正确返回 readyState=4 并打印出 SpecRunner.html 中的内容

```
 $.ajax({url: 'file:///home/myname/development/path1/path2/src/test/java/javascript/jasmine/SpecRunner.html', async: false}).responseText 

```

但是如果我做这样的事情，我只会得到 readyState=1 并且什么都没有返回。

```
 $.ajax({url: 'file:///home/myname/development/path1/path2/src/main/webapp/static/js/core/application/FileThatIWant.js', async: false}).responseText 

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:05:27.497

一般来说，您应该避免使用 file:// URL，因为浏览器不允许在许多不同的地方使用它们。试试[XAMPP](http://www.apachefriends.org/de/xampp.html)，它是一个简单易用的本地网络服务器，你肯定需要一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T01:26:22.113

是的，这是一个跨域问题。您可以通过强制 jQuery 使用跨域 AJAX (JSONP) 来解决此问题。

```
$.ajax({
    url:            "yoururl",
    cache:          false,
    crossDomain:    true,
    data:           {}, //put your GET parameters here or directly into the url
    dataType:       "jsonp",
    processData:    true,
    success:        function(data, textStatus, jqXHR){
                        //This will be executed if it worked
                    },
    error:          function(data, textStatus, jqXHR){
                        //This will be executed if it failed
                    },
    timeout:        4000, //You can put any value here
    traditional:    true,
    type:           "GET"
}); 
```

jQuery 会自动添加一个包含随机字符串 (&callback=XXXXXX) 的回调参数。目标 URL 需要输出以下内容：

```
XXXXX(your_output_encoded_in_JSON); 
```

其中 XXXXX 是随机字符串。这样做的 PHP 代码是：

```
echo $_GET["callback"]."(".json_encode($myoutput).");"; 
```

确保 PHP（或您使用的任何语言）页面仅输出！相反，如果您查询的页面不是动态构建的，例如 HTML 页面，您需要将以下选项添加到 $.ajax 选项对象：

```
jsonp:          false,
jsonpCallback:  "mycallback",
mimeType:       "text/javascript", 
```

您的 .html 文件将包含如下内容：

```
mycallback("<html><head></head><body>TEST PAGE. This is a double quote: \" and I didn't forget to escape it!</body></html>"); 
```

这种技术非常方便绕过浏览器中硬编码的严格跨域限制，但它只支持 GET 参数。XMLHTTPRequest v2 支持跨域请求，但我们不能假设所有用户至少在 2016 年之前都拥有兼容 XHRv2 的浏览器。 [http://caniuse.com/xhr2](http://caniuse.com/xhr2)

# java - 在 JDBC 上缓存数据

> ID：13260810
> 
> 赞同：0
> 
> 时间：2012-11-06T22:59:52.687
> 
> 标签：java, database, jdbc, resultset

我已经使用 java swing 创建了一个数据库应用程序。每当我调用 find 类时，我的程序都会从​​数据库中检索数据。find 类只是简单地创建一个语句，获取当前数据库连接，然后执行该语句。从数据库返回的值将被放置在一个 ResultSet 上，然后将显示在一个 jTable 上。问题是这样的：

我打开了查找类，结果显示出来了。然后我转到 SQLyog 或 HeidiSQL（用于操作数据库的应用程序），编辑显示在我的程序上的值，然后保存。我回到我的程序，关闭查找类然后重新打开它，我仍然得到以前的数据，而不是编辑过的数据。请帮忙。查找类打开后必须显示更新。我获取更新数据的唯一方法是关闭我的整个程序然后重新打开它，我不想这样做。

编辑：这是我尝试过的。基本上，一旦我的程序第一次创建到数据库的连接，我将它保存到另一个类，这使得连接始终打开（我假设）。因此，每当我想创建查询时，我都会调用该类来获取连接。我现在所做的是，在从 find 类执行查询之后，我关闭了与 .close() 函数的连接。它有效，但我真的需要每次都关闭连接吗？同样，这只是一个桌面应用程序，而不是 Web 程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T02:52:12.033

我认为您遇到了事务隔离问题。一些驱动程序在获取连接时会启动隐式事务，因此您当时会看到数据库的快照。您可能想要一个 READ COMMITTED 级别，它应该显示应用了所有已提交事务的数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:05:55.717

看起来您尚未提交编辑，或者您需要通过刷新查询来刷新数据。

# sql - 递增值的限制（标准 sql）

> ID：13260813
> 
> 赞同：0
> 
> 时间：2012-11-06T23:00:04.723
> 
> 标签：sql, increment

给定一张学生和成绩表，有没有办法将每个学生的成绩增加 10%，但不超过 100？

现在我做

```
UPDATE studentCourse
SET grade = grade + 10 * (grade/100) 
WHERE csid = 1 
```

换句话说，如果学生有 60，更新后他应该有 66。但如果学生有 98，更新后他的成绩应该是 100（而不是 108）。

所有这些都必须在标准 SQL 中完成

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:03:19.080

我没有测试此代码的实例，但假设您的数据是可实现的（全部为 0 - 100），您可以在分数低于 90 的情况下使用 CASE 语句来添加 10%，否则在另一种情况下，我们可以说得分为 100。

例如：

```
UPDATE [studentCourse]
SET grade=
(
CASE
  WHEN
  (grade <= 90)
    THEN grade + 10 * (grade/100)
  ELSE
    (100)
  END
)
WHERE
csid = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:04:30.683

你可以只运行两个语句

```
UPDATE studentCourse
SET grade = grade + 10 * (grade/100) 
WHERE csid = 1; 
```

其次是

```
UPDATE studentCourse
SET grade = 100
where csid = 1
  and grade > 100;

COMMIT; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T23:07:48.860

MySQL 有一个功能`LEAST()`可以帮助：

```
UPDATE studentCourse
SET grade = LEAST(100, grade + 10 * (grade/100))
WHERE csid = 1; 
```

这个`LEAST()`函数是 MySQL 特有的。如果您想严格遵守 ANSI SQL，请`CASE`按照@chrisc 的建议使用。

# silverlight - 构建为“页面”的 XAML 文件在哪里？

> ID：13260820
> 
> 赞同：2
> 
> 时间：2012-11-06T23:00:40.653
> 
> 标签：silverlight, xaml, windows-phone, windows-phone-8

我已将 XAML 文件添加到 Windows Phone 8 项目。它的构建动作是“Page”。我想将 XAML 作为文本字符串加载（输入`XamlReader.Load()`）。我怎样才能做到这一点？

它在 XAP 包中不作为单独的文件提供；它可能在 DLL 中的某个地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T23:23:28.603

当设置为`Page`时，编译器会将 XAML 编译为 BAML，并将 BAML 文件作为资源添加到程序集。

如果您希望在运行时从 BAML 资源中取回原始 XAML，则需要反序列化 BAML，然后将对象序列化为 XAML。

您可以查看[Baml2006Reader](http://msdn.microsoft.com/en-us/library/system.windows.baml2006.baml2006reader.aspx)，或者更好的选择是使用`Application.LoadComponent`该`InitializeComponent`方法内部使用的内容。`InitializeComponent`由部分生成的类为您的 XAML 代码调用。

```
var uri = new Uri("/MyAppName;component/MyXaml.xaml", //Note extension: XAML, not BAML
     UriKind.Relative);
Page rootObject = new Page(); //Assuming XAML root element is Page - it could be anything
Application.LoadComponent(rootObject, uri); 
```

（假设 XAML 文件的根元素是 a `Page`）。

然后，您可以`Page`使用以下命令将 序列化为 XAML 字符串`XamlWriter`：

```
string xaml = XamlWriter.Save(rootObject); 
```

请注意，这是命名空间`XamlWriter`中的`System.Windows.Markup`，而不是`System.Xaml`. 如果您的 XAML 具有 WPF 类型，那么您应该使用它`XamlWriter`来避免错误。

# scheme - 在方案中生成序列

> ID：13260833
> 
> 赞同：0
> 
> 时间：2012-11-06T23:02:27.723
> 
> 标签：scheme

我想使用以下定义创建序列：

```
(define f1 (lambda (x) #t))
(define f2 (lambda (x) #f))             
(define f3 (lambda (x) (if (null? x) #t (car x))))
(define f4 (lambda (x) (if (null? x) #t (not (car x))))) 
```

我的代码如下：

```
(define (generate func n)
       (let ((mylist '()))
       (if (= n 0) mylist
        (cons (func mylist) (generate func (- n 1)))                
   ))) 
```

它对 f1 f2 和 f3 有效，但是当我尝试 f4 （生成 f4 10）时，它会产生 (#t #t #t #t #t #t #t #t #t #t) 而不是 (#t # f #t #f #t #f #t #f #t #f）。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:35:09.573

好吧，这是因为每次`func`调用都是在范围内`'()`的值。我们应该将新的列表值传递给下一次调用，以对其进行一些有用的操作。像这样的东西`mylist``let``generate`

```
(define (generate f n)
  (define (generate-int n lst)
    (if (= n 0) 
        lst
        (generate-int (- n 1) (cons (f lst) lst))))

  (generate-int n (list))) 
```

现在`(generate f4 4)`生成`'(#f #t #f #t)`的第一个生成值排在列表的最后。一个可能`reverse`的结果是获得“自然”的顺序或使用`append`它`cons`会不太有效。

# wordpress - 如何防止和修复“未定义的偏移量：0 in”错误消息

> ID：13260848
> 
> 赞同：1
> 
> 时间：2012-11-06T23:04:00.063
> 
> 标签：wordpress, error-handling, undefined, offset

我有一个在 WordPress 插件中运行的函数，当 wp_debug 被激活时，我收到此错误消息。

“**未定义的偏移量：0 in /.../wp-content/plugins/advanced-widget-pack/lib/advanced_widget_pack.class.php 在第 568 行**”

这是插件中使用的函数：

```
/**
 * Retrieves the image for a post
 *
 * Uses the post_thumbnails if available or
 * searches through the post and retrieves the first found image for use as thumbnails
 */
function featured_image_thumb($size = 50) {
    global $post;
    // If a featured image has been set, use the featured-thumbnail size that was set above with the class of 'thumb'
    if(has_post_thumbnail() ) {
        echo '<a href="'.get_permalink().'" title="'.get_the_title().'" >';
        the_post_thumbnail(array($size,$size),array('class' => 'thumb'));
        echo '</a>';
    }
    // If a featured image is not set, get the first image in the post content
    else {
        $first_img = '';
        ob_start();
        ob_end_clean();
        $output = preg_match_all('/<img.+src=[\'"]([^\'"]+)[\'"].*>/i', $post->post_content, $matches);
        $first_img = $matches[1][0];

        // Define a default fallback image in case a featured image is not set and there are no images in the post content
        if(empty($first_img)){
            $first_img = WP_PLUGIN_URL.'/advanced-widget-pack/images/nothumb.png';
        }

        // Generate the HTML code to display the image and resize the image with timthumb.php
        return '<a title="'.get_the_title().'" href="'.get_permalink().'"><img class="thumb" src="'.WP_PLUGIN_URL.'/advanced-widget-pack/timthumb.php?src=' . $first_img .'&w='.$size.'&h='.$size.'" alt="" /></a>';
    }
} 
```

第 568 行或发生错误的地方是这部分代码：

```
$first_img = $matches[1][0]; 
```

我不确定如何防止或修复此错误。

任何帮助或建议将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-29T21:06:42.497

未定义的偏移量 $X[Y] 意味着数组 X 没有键 Y。在您的情况下 $matches[1] 没有第一个元素。

我认为你必须使用条件：

```
if(preg_match_all('/<img.+src=[\'"]([^\'"]+)[\'"].*>/i', $post->post_content, $matches)){
  $first_img = $matches[1][0];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-16T13:58:58.423

在我的情况下，一个有条件的拥抱为我做了：

```
if( $output = preg_match_all('/<img.+src=[\'"]([^\'"]+)[\'"].*>/i', $post->post_content, $matches); ) 
```

所有的通知都不见了！:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T04:03:37.403

意味着数组的第一个索引没有定义 prob 因为它上面的 preg_match 找不到任何东西。您真的不必担心它，但是在 ob_end_clean 之后放置以下内容应该可以解决

```
 $matches[1][0] = ''; 
```

# css - 如何防止 ExtJS 4.1.1 弄乱 Twitter Bootstrap 2.2.1 布局？

> ID：13260853
> 
> 赞同：6
> 
> 时间：2012-11-06T23:04:26.983
> 
> 标签：css, twitter-bootstrap, conflict, extjs4.1

我真的不喜欢 ExtJS，但我不得不使用它。我想将 Twitter Bootstrap 2.2.1 用于主布局，将 ExtJS 用于网格和 JS（策略）。

我有一个很棒的 Bootstrap 设计，但是在我加载 ExtJS 的那一刻，导航栏、字体等都被淹没了。

有没有一种方法可以让两者一起工作而无需进入 ExtJS 和调整大量的 CSS？

我正在使用的 CSS 文件位于以下路径中（对于 ExtJS）：

```
js/extjs/4.1.1/resources/css/ext-all-gray.css 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T18:16:28.960

这是我的解决方案：
1.使用 ext-all-scoped.css 而不是 ext-all.css
2.在加载 ext-all.js 之前添加以下代码

```
<script type='text/javascript'>
Ext = {
    buildSettings:{
        "scopeResetCSS": true
    }
};
</script>
<script type='text/javascript' src='http://xxx.com/extjs/ext-all.js'></script> 
```

3.删除ext-all-scoped.css中的以下声明，以防止extjs在加载引导程序后使用那些冲突的css声明重新渲染主体

```
.x-body {
   ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T14:48:56.420

问题是规则

```
.x-border-box .x-reset,.x-border-box .x-reset * {box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;-webkit-box-sizing:border-box;} 
```

以某种方式应用于所有页面元素，也适用于 Twitter Bootstrap 输入（在 FF、Chrome 上测试）。所以你应该简单地提供

```
box-sizing:content-box !important;
-moz-box-sizing:content-box !important; /* Firefox */
-webkit-box-sizing:content-box !important; /* Safari */ 
```

对于所有 Twitter 输入。[关于box-sizing 的](http://www.w3schools.com/cssref/css3_pr_box-sizing.asp)附加信息。

我希望这个对你有用。

# php - PHP选择最接近变量

> ID：13260856
> 
> 赞同：2
> 
> 时间：2012-11-06T23:04:36.080
> 
> 标签：php

只是想知道如何选择最接近的变量。我有一组军事时间列表，即：0030 0100 0130 0200 等...

全部以半小时为增量。我将如何选择最接近现在的时间。例如。用户单击按钮，php 获取现在的时间，并选择最接近的时间变量。因此，如果是 0144，它将选择 0130。如果是 0146，它将选择 0200。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T23:09:33.100

由于您始终以 30 分钟的间隔存储时间，因此从 30 中减去当前时间的最后 2 位（分钟）。

例如：如果当前时间是 0146，

1.  去掉 46（分钟）
2.  取 30 的绝对差
3.  如果差值 > 15，则为 0146（此处为 0200）选择下一个可用时隙
4.  如果差异 <= 15，则取 0146 之前的上一个可用时间（此处为 0130）

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:12:05.393

为方便起见，在您的计算中将它们视为整数，忽略前导零，因为它们对您的计算没有用处。

你有 144，你想向下舍入到 130，或 146，直到 200。类似地，14 (0014) 会变成 0 (0000)，15 (0015) 会变成 30。

简单的 if/thens 就足以完成此任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T23:23:15.577

我相信这应该这样做：

```
function military_time() {
    $hour = (int) date('G');
    $minute = (int) date('i');

    $rounded_minute = round($minute / 30);

    switch ($rounded_minute) {
        case 0:
            $minute = '00';
            break;
        case 1:
            $minute = '30';
            break;
        case 2:
            $minute = '00';
            $hour = (int) $hour + 1;
            break;
    }

    // 2400 should become 0000
    if ($hour > 23) $hour = 0;

    // leading zero
    if ($hour < 10) $hour = '0' . $hour;

    return $hour . $minute;
}

echo military_time(); 
```

不过可能会有所改进。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T23:58:34.300

你可以试试

```
$times = array("0030","0100","0130","0200");

echo "<pre>";
echo militaryTime($times, "0020"), PHP_EOL;
echo militaryTime($times, "0050"), PHP_EOL;
echo militaryTime($times, "0144"), PHP_EOL;
echo militaryTime($times, "0146"), PHP_EOL;
echo militaryTime($times, "0220"), PHP_EOL; 
```

输出

```
0030
0100
0130
0200
0200 
```

使用的功能

```
function militaryTime($times, $selected) {
    if (empty($times))
        trigger_error("Empty array not supported ");
    $times[] = $selected;
    sort($times);
    $position = array_search($selected, $times, true);
    $current = DateTime::createFromFormat("Hi", $times[$position]);
    $previous = isset($times[$position - 1]) ? DateTime::createFromFormat("Hi", $times[$position - 1]) : null;
    $next = isset($times[$position + 1]) ? DateTime::createFromFormat("Hi", $times[$position + 1]) : null;

    if ($previous != null && $next == null) {
        return $previous->format("Hi");
    }
    if ($previous == null && $next != null) {
        return $next->format("Hi");
    }

    $closest = ($current->diff($previous)->format("%i") - $current->diff($next)->format("%i") <= 0) ? $previous : $next;
    return $closest->format("Hi");
} 
```

# python - 将 unixtime 转换为 datetime 对象并再次返回（时间转换函数对）

> ID：13260863
> 
> 赞同：27
> 
> 时间：2012-11-06T23:05:08.867
> 
> 标签：python, date, datetime, time, dst

我正在尝试编写一对函数，`dt`和`ut`，它们在正常的 unix 时间（自 1970-01-01 00:00:00 UTC 以来的秒数）和 Python 日期时间对象之间来回转换。

如果`dt`和`ut`是正确的逆，那么这段代码将打印两次相同的时间戳：

```
import time, datetime

# Convert a unix time u to a datetime object d, and vice versa
def dt(u): return datetime.datetime.fromtimestamp(u)
def ut(d): return time.mktime(d.timetuple())

u = 1004260000
print u, "-->", ut(dt(u)) 
```

唉，第二个时间戳比第一个少 3600 秒（一个小时）。我认为这只发生在非常特殊的 unixtime 上，也许在夏令时跳过的那个小时内。但是有没有办法写出来`dt`，`ut`所以它们是彼此真正的倒数？

相关问题：[制作 matplotlib 的 date2num 和 num2date 完美逆](https://stackoverflow.com/questions/13259875/making-matplotlibs-date2num-and-num2date-perfect-inverses)

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-11-06T23:18:24.040

您是正确的，此行为与夏令时有关。避免这种情况的最简单方法是确保您使用没有夏令时的时区，UTC 在这里最有意义。

[`datetime.datetime.utcfromtimestamp()`](http://docs.python.org/2/library/datetime.html#datetime.datetime.utcfromtimestamp)并[`calendar.timegm()`](http://docs.python.org/2/library/calendar.html#calendar.timegm)处理 UTC 时间，并且是精确的倒数。

```
import calendar, datetime

# Convert a unix time u to a datetime object d, and vice versa
def dt(u): return datetime.datetime.utcfromtimestamp(u)
def ut(d): return calendar.timegm(d.timetuple()) 
```

以下是文档中为什么[`datetime.datetime.fromtimestamp()`](http://docs.python.org/2/library/datetime.html#datetime.datetime.fromtimestamp)夏令时存在问题的一些解释：

> 返回 POSIX 时间戳对应的本地日期和时间，如`time.time()`. 如果可选参数 tz 为 None 或未指定，则将时间戳转换为平台的本地日期和时间，并且返回的 datetime 对象是幼稚的。

这里重要的部分是你得到一个天真的`datetime.datetime`对象，这意味着对象的一部分没有时区（或夏令时）信息。这意味着`datetime.datetime`在使用 时，多个不同的时间戳可以映射到同一个对象`fromtimestamp()`，如果您碰巧选择了在夏令时回滚期间的时间：

```
>>> datetime.datetime.fromtimestamp(1004260000) 
datetime.datetime(2001, 10, 28, 1, 6, 40)
>>> datetime.datetime.fromtimestamp(1004256400)
datetime.datetime(2001, 10, 28, 1, 6, 40) 
```

# scala - Scala 2.10 中的字符串插值 - 如何插入字符串变量？

> ID：13260864
> 
> 赞同：49
> 
> 时间：2012-11-06T23:05:09.150
> 
> 标签：scala, scala-2.10, string-interpolation

从 Scala 2.10 开始，字符串插值[在 Scala 中可用](http://docs.scala-lang.org/overviews/core/string-interpolation.html)

这是基本示例

```
 val name = "World"            //> name  : String = World
 val message = s"Hello $name"  //> message  : String = Hello World 
```

我想知道是否有办法进行动态插值，例如以下（不编译，仅用于说明目的）

```
 val name = "World"            //> name  : String = World
 val template = "Hello $name"  //> template  : String = Hello $name
 //just for illustration:
 val message = s(template)     //> doesn't compile (not found: value s) 
```

1.  有没有办法“动态”评估这样的字符串？（或者它本质上是错误的/不可能的）

2.  究竟是`s`什么？~~这不是方法定义~~（[显然它是一个方法`StringContext`](http://www.scala-lang.org/files/archive/nightly/docs/library/index.html#scala.StringContext@s(args:Any*):String)），而不是一个对象（如果是，它会抛出一个不同的编译错误，而不是我认为的*未找到）*

* * *

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-11-07T00:01:26.730

`s`实际上是一个方法`StringContext`（或可以从 隐式转换的东西`StringContext`）。当你写

```
whatever"Here is text $identifier and more text" 
```

编译器将其脱糖成

```
StringContext("Here is text ", " and more text").whatever(identifier) 
```

默认情况下，`StringContext`为您提供`s`、`f`和`raw`* 方法。

如您所见，编译器本身会选择名称并将其提供给方法。由于这发生在编译时，因此您不能明智地动态执行此操作——编译器在运行时没有关于变量名的信息。

但是，您可以使用 var，因此您可以交换所需的值。并且默认`s`方法只是调用`toString`（如您所料），因此您可以玩游戏

```
class PrintCounter {
  var i = 0
  override def toString = { val ans = i.toString; i += 1; ans }
}

val pc = new PrintCounter
def pr[A](a: A) { println(s"$pc: $a") }
scala> List("salmon","herring").foreach(pr)
1: salmon
2: herring 
```

（在此示例中，REPL 已经调用了 0）。

这是你能做的最好的事情。

*^(`raw`已损坏，计划在 2.10.1 之前修复；只有变量之前的文本实际上是原始的（没有转义处理）。所以在 2.10.1 发布之前不要使用那个，或者查看源代码并定义你自己的。默认情况下，没有转义处理，因此定义自己的非常容易。)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-07T01:29:18.823

这是基于 Rex 出色答案的原始问题上下文中#1 的可能解决方案

```
val name = "World"                  //> name: String = World
val template = name=>s"Hello $name" //> template: Seq[Any]=>String = <function1>
val message = template(name)        //> message: String = Hello World 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-06T23:54:42.383

1.  字符串插值发生在编译时，因此编译器通常没有足够的信息来插值`s(str)`。[根据 SIP](http://docs.scala-lang.org/sips/pending/string-interpolation.html)，它需要一个字符串文字。
2.  在您链接的文档中的*高级用法*下，解释了表单的表达式`id"Hello $name ."`在编译时被翻译为`new StringContext("Hello", "."). id(name)`.

请注意，`id`可以是通过隐式类引入的用户定义的插值器。该文档提供了一个`json`插值器的示例，

```
implicit class JsonHelper(val sc: StringContext) extends AnyVal {
  def json(args: Any*): JSONObject = {
    ...
  }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-07T00:17:25.483

这在当前实现中本质上是不可能的：局部变量名称在执行时不可用——可以作为调试符号保留，但也可以被剥离。（成员变量名称是，但这不是你在这里描述的）。

# java - 如何使 JWS 应用程序可固定到 Windows 7 任务栏？

> ID：13260866
> 
> 赞同：3
> 
> 时间：2012-11-06T23:05:15.503
> 
> 标签：java, windows, windows-7, java-web-start, taskbar

我正在使用 Java Web Start 部署应用程序。

令我惊讶的是，可以在 Windows 7 中将程序固定到任务栏，但据我了解，这只有在程序运行的进程与任务栏图标后面的进程相同时才有可能。

对于 JWS 应用程序，情况并非如此，因此无法将应用程序固定到任务栏，如下例所示：

![任务栏截图示例](../Images/bab2a8635a9c8723c01ed55b0402f221.png)

“u”是我的应用程序快捷方式，固定（从开始菜单）。另一个（丑陋的）图标是实际应用程序，在另一个进程中运行，创建了另一个无法固定的图标。我只得到“关闭窗口”选项。

是否有可能拥有一个可固定的 JWS 应用程序？

# javascript - 克隆 div 和更改属性

> ID：13260872
> 
> 赞同：2
> 
> 时间：2012-11-06T23:05:49.827
> 
> 标签：javascript, jquery, css, clone

我进行了各种研究，但找不到解决问题的方法。我用css创建了一个下拉选择来改变背景颜色，但是当我尝试用Javascript克隆它时，新副本不会改变选择中的属性，所以它保持原来的颜色。试一试，添加一些副本并尝试更改颜色。

我是新来的，我不太能添加代码，所以这里试试：

[http://jsfiddle.net/gabry501/FUyA3/](http://jsfiddle.net/gabry501/FUyA3/) 或 github

[https://github.com/gabry501/Test-Color/blob/master/test.html](https://github.com/gabry501/Test-Color/blob/master/test.html)

头

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<script type="text/javascript">

function cloning() {

    var container = document.getElementById('fine');
    var clone = document.getElementById('contenitore').cloneNode(true);
    container.appendChild (clone);

} 
```

风格

```
select option,
select {
    background-color:white;
    width:200px;
    height:200px;
}

select option[value="1"],
select.o1
{
    background-color:blue;
}

select option[value="2"],
select.o2
{
    background-color:red;
}

select option[value="3"],
select.o3
{
    background-color:orange;
} 
```

身体

```
<div style="width:1100px;
height:250px;" id="contenitore"> 
```

脚本

```
<script>$('select[id$=-status][id^=id_item-]').children().each(
    function (){
        if($(this).val() == 0){
            $(this).css('backgroundColor','white');
        }
        if($(this).val() == 1){
            $(this).css('backgroundColor','green');
        }
        if($(this).val() == 2){
            $(this).css('backgroundColor','red');
        }
        if($(this).val() == 3){
            $(this).css('backgroundColor','orange');
        }
    }
);</script>

<script>    
$('select[id$=-status][id^=id_item-]').change(function (){
    var color = $(this).find('option:selected').val();

    $(this).removeClass('o1 o2 o3').addClass('o' + $(this).find('option:selected').val());
}).change(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:19:44.487

看来您要依靠听众来修改样式。使用添加的侦听器`addEventListener`不包含在[克隆元素](http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-3A0ED0A4)中，您必须单独附加它们。

请注意，内联添加或使用的侦听器`attachEvent`是克隆的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:21:46.147

您必须使用`$('.el').live('change', fn)`，而不是`$('.el').change(fn)`因为您在 DOM 加载后添加了一个元素。

看到这个jsfiddle：http: [//jsfiddle.net/FUyA3/1/](http://jsfiddle.net/FUyA3/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T23:23:04.110

`cloneNode()` 仅复制相关元素的数据。它不会复制事件侦听器。您需要手动执行此操作..

使用 jQuery **clone()**方法..

```
function cloning() {

        var container = document.getElementById('fine');
        var clone = $(document.getElementById('contenitore')).clone(true);
        $(container).append(clone);

    } 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/FUyA3/2/)**

*PS：你的代码看起来也很乱。可以缩小。。*

**更新** 我对代码做了一些更改。

1.) 从 HTML 中删除 click 事件并将其添加到脚本中。

2.) 删除**ID**并替换为 className，因为文档中的 ID 应该
是**Unique**。

3.) 删除了额外的样式并替换为一个简单的类名。

4.) 最好有单独的样式和脚本文件，而不是将其包含在 HTML 中。

5.）如果你想让它工作，将样式和脚本移动到我标记的相应标签..

**HTML**

```
 <!doctype html>
    <html>
       <head>
         <script type="text/javascript"  src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js">
        </script>
        <meta charset="UTF-8">
        <title>Untitled Document</title>
        <style type="text/css">
            // Add the Styles here
        </style>
      </head>

       <body>
          <div style="width:1100px; height:250px;" class="contenitore">
             <select  name="item-0-status">
                <option value="" disabled="disabled" class="optionGroup">SELECT 
                      COLOR</option>
                <option value="1"> BLUE</option>
                <option value="2"> RED </option>
                <option value="3"> ORANGE</option>
             </select>
          </div> <!--Contenitore -->

          <div id="fine"></div>

          <br>
          <div id="bottone">
          <input id="btn" type="button" Value="ADD">
         </div>
           <script type="text/javascript">
               // Script Comes Here
           </script>           

       </body>
    </html> 
```

**Javascript**

```
$(function() {
    $('select[name="item-0-status"]').change(function() {
        $(this).removeClass('o1 o2 o3').addClass('o' + $(this).val());
    }).change();

    $('#btn').on('click', function() {
        var container = document.getElementById('fine');
        var clone = $(document.getElementsByClassName('contenitore')[0]).clone(true);
        $(container).append(clone);
    });
});​ 
```

**风格**

```
#bottone
{
   float:left;
   text-align:left;
   clear:left;
   margin-top:20px;
}

select option,select 
{
   background-color:#FFF;
   width:200px;
   height:200px;
}

.o1
{
    background-color:blue;
}

.o2
{
   background-color:red;
}

.o3 
{
   background-color:orange;
}​ 
```

**[更新的小提琴](http://jsfiddle.net/sushanth009/FUyA3/3/)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-19T11:48:46.020

尝试深度克隆 - 即**$(selector).clone(true)** ....然后事件也将被克隆

# iphone - 匹配“但不匹配\”的正则表达式

> ID：13260876
> 
> 赞同：0
> 
> 时间：2012-11-06T23:06:11.827
> 
> 标签：iphone, objective-c, ios, regex

如何构造一个与文字匹配的正则表达式“但前提是它前面没有转义斜杠，即 \

我有一个 NSMutableString str**在 NSLog 上打印以下内容**。字符串是从在线服务器接收的。

```
"Hi, check out \"this book \". Its cool" 
```

我想更改它，使其**在 NSLog 上打印以下内容**。

```
Hi, check out "this book ". Its cool 
```

我最初使用 replaceOccurencesOfString ""\" 和 ""。但随后它将执行以下操作：

```
Hi, check out \this book \. Its cool 
```

所以，我得出结论，我需要上面的正则表达式只匹配“而不是 \”，然后只替换那些双引号。

谢谢mbh

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:21:39.330

```
[^\\]\" 
```

[^m] 表示不匹配 m

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:22:40.207

不确定这可能如何转化为 iOS api 中支持的任何内容，但是，如果它们支持锚定（我认为所有正则表达式引擎都应该），那么您描述的内容类似于

(^|[^\])"

也就是说，匹配：

1.  字符串的开头或后面`^`没有的任何字符 ：`\`
2.  `"`性格_

如果要进行任何类型的替换，则必须获取正则表达式中的第一个（也是唯一的）组（即表达式的括号分组部分）并在替换中使用它。通常这个值在你的替换字符串中标记为 $1 或 \1 或类似的东西。

如果正则表达式引擎是基于[PCRE](http://www.pcre.org/)的，那么您当然可以将分组表达式放在后面，这样您就不需要捕获并将捕获保存在替换中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T23:48:03.413

不确定正则表达式，一个更简单的解决方案是，

```
NSString *str = @"\"Hi, check out \\\"this book \\\". Its cool\"";
NSLog(@"string before modification = %@", str);    
str = [str stringByReplacingOccurrencesOfString:@"\\\"" withString:@"#$%$#"];
str = [str stringByReplacingOccurrencesOfString:@"\"" withString:@""];
str = [str stringByReplacingOccurrencesOfString:@"#$%$#" withString:@"\\\""];//assuming that the chances of having '#$%$#' in your string is zero, or else use more complicated word
NSLog(@"string after modification = %@", str); 
```

输出：

```
string before modification = "Hi, check out \"this book \". Its cool"
string after modification = Hi, check out \"this book \". Its cool 
```

正则表达式：`[^\"].*[^\"].`给出，`Hi, check out \"this book \". Its cool`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T00:57:28.490

它看起来像一个JSON字符串？也许在`json_encode()`服务器上使用 PHP 创建？您应该在 iOS 中使用正确的 JSON 解析器。不要使用正则表达式，因为您会遇到错误。

```
// fetch the data, eg this might return "Hi, check out \"this book \". Its cool"
NSData *data = [NSData dataWithContentsOfURL:@"http://example.com/foobar/"];

// decode the JSON string
NSError *error;
NSString *responseString = [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingAllowFragments error:&error];

// check if it worked or not
if (!responseString || ![responseString isKindOfClass:[NSString class]]) {
   NSLog(@"failed to decode server response. error: %@", error);
   return;
}

// print it out
NSLog(@"decoded response: %@", responseString); 
```

输出将是：

```
Hi, check out "this book ". Its cool 
```

注意：JSON 解码 API 接受 NSData 对象，而不是 NSString 对象。我假设您也有一个数据对象，并在某个时候将其转换为字符串......但如果您没有，您可以使用以下方法将 NSString 转换为 NSData：

```
NSString *responseString = [NSJSONSerialization JSONObjectWithData:[myString dataUsingEncoding:NSUTF8StringEncoding] options:NSJSONReadingAllowFragments error:&error]; 
```

有关 JSON 的更多详细信息，请参见：

*   [http://www.json.org](http://www.json.org)
*   [http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)

# javascript - 如何解决这个双 ajax 调用问题

> ID：13260879
> 
> 赞同：0
> 
> 时间：2012-11-06T23:06:39.740
> 
> 标签：javascript, jquery, ajax

当用户单击按钮时，我正在尝试执行 2 个 ajax 函数调用。

我有

```
$('.test').on('click', function(){

    code.getCode();
        code.getText();
})

code.prototype.getCode=function(){
     var call=//call ajax
     call.callback= function(data){
          //parse return data
    }
}

code.prototype.getText=function(){
     var call=//call ajax
     call.callback= function(data){
          //parse return data
    }
} 
```

我只能做 1 个 ajax 调用，只有 1 个 ajax 调用会返回数据。我不知道如何解决这个问题。有任何想法吗？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:12:50.463

我不确定我是否理解正确，但我认为您正在寻找来自两个 ajax 调用的单个回调..

您应该使用**[$.when.done](http://api.jquery.com/jQuery.when/)**。见下文，

```
$.when($.ajax("/page1.php"), $.ajax("/page2.php")).done(function(a1,  a2){
    /* a1 and a2 are arguments resolved for the 
        page1 and page2 ajax requests, respectively */
   var jqXHR = a1[2]; /* arguments are [ "success", statusText, jqXHR ] */
   if ( /Whip It/.test(jqXHR.responseText) ) {
      alert("First page has 'Whip It' somewhere.");
   }
}); 
```

不确定您是要对其进行排序还是尝试进行 1 个回调。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:18:53.073

您还可以进行第一个 ajax 调用，在成功时调用第二个：

```
$('.test').on('click', function(){

var datastr = "your data";

 $.ajax({  
  type: "POST",  
  url: "url",  
  data: datastr,  
  success: function(successMsg) {                   
          //ajax done
          if (/* not yet complete */) {
            setTimeout(secondAjaxCall(),500);
          } else {
            secondAjaxCall();
         }
      }
  });

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T23:23:19.420

您可以将每个返回值保存在代码对象中（因为您处于不同的上下文中，您必须解决“this”）。然后，您可以使用第三个函数来检查数据对象是否已加载......并在两者都存在后开始解析。

```
$('.test').on('click', function(){
    code.getCode();
    code.getText();
})
code.prototype.getCode=function(){
     var call=//call ajax
     var that = this;
     call.callback= function(data){
          //parse return data
          that.codeData = data;
          parseData();
    }
}
code.prototype.getText=function(){
     var call=//call ajax
     var that = this;
     call.callback= function(data){
          //parse return data
          that.textData = data;
          parseData();
    }
}
function parseData() {
 if(!code.textData || !code.codeData) return;
 ... work with both
} 
```

# mysql - 使用 perl 连接到数据库时打印内容

> ID：13260881
> 
> 赞同：0
> 
> 时间：2012-11-06T23:06:51.483
> 
> 标签：mysql, perl

下面是使用 perl 连接 mysql 数据库并检索结果的代码。

在下面的示例中，示例表有 10 列。我只想将记录 99 的第二列和第三列转换为变量。

有人可以帮助我吗？

```
use strict;
 use warnings;
 use DBI;

my $dbh = DBI->connect('dbi:mysql:perltest','root','password') or die "Connection Error: $DBI::errstr\n";
my $sql = "select * from samples where record='99'";
my $sth = $dbh->prepare($sql);
$sth->execute or die "SQL Error: $DBI::errstr\n";
while (my @row = $sth->fetchrow_array) {
 print "@row\n";
 } 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:10:21.963

此代码将使您将行的第二列和第三列转换为变量：

```
while (my @row = $sth->fetchrow_array) {
     $var1 = @row[1];
     $var2 = @row[2];
} 
```

# ruby-on-rails - 在 Rails 视图的 /lib/ 目录中的文件中显示方法中的变量

> ID：13260882
> 
> 赞同：0
> 
> 时间：2012-11-06T23:06:55.170
> 
> 标签：ruby-on-rails

`foo.rb`在我的目录中调用的文件中，`/lib/`它显示：

```
module Foo
  def some_method
    @text_1 = "Hello!"
  end
end 
```

我怎样才能让这个方法的结果显示在视图中？

我已经看到我需要在`/config/application.rb`文件中包含以下行：

```
config.autoload_paths += %W(#{config.root}/lib 
```

但是，我不完全了解如何从保存在`/lib/`目录中的文件中的模块传递变量 - 以显示在视图中。我很感激任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:52:18.803

为了使该值显示在视图中，您需要了解模块在 Ruby 中的使用方式。通常，模块通过包含或扩展它们被混合到其他类中。然后，这将使该方法可用于另一个可以在视图中引用的类。在您的情况下，您可能希望包含它，以便它可用于您放入的任何类的实例。假设您有一个名为 MyClass 的 ActiveRecord 模型，并且包含 Foo。然后，您可以调用`my_method`该模型的实例，如下所示：

```
class MyClass < ActiveRecord::Base
  include Foo
end 
```

在您的控制器中：

```
class MyController
  def new
    @my_class = MyClass.new
  end
end 
```

在您看来：

```
@my_class.some_method 
```

说了这么多，似乎有更好的方法来做你想做的任何事情:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T06:03:40.530

是的。我同意比灵顿的观点。

您可以通过其他方式执行此操作，不必将**config.autoload_paths += %W(#{config.root}/lib 添加**到应用程序文件中。因为默认情况下位于 /lib 目录中的文件不会在我们使用**rails s**运行应用程序时首先执行。为了使这些文件能够被加载，我们需要在 application.rb 中包含该行。否则，我们可以直接编写如下，

**在模型中，**

需要“文件名”

类 MyClass < ActiveRecord::Base

```
 include Foo 
```

结尾

**在控制器中，**

需要'foobar'

类购买者控制器 < 应用控制器

```
include Foobar 
```

结尾

**在 foobar.rb 中，**

模块 Foobar

def Foobar.foobar

```
 "Hello world!" 
```

结尾

结尾

**鉴于，**

<%= Foobar.foobar %> （可以直接使用**Modulenmae.Methodname**调用方法）

# matlab - 在我的 matlab GUI 中更改绘图图

> ID：13260884
> 
> 赞同：0
> 
> 时间：2012-11-06T23:06:57.940
> 
> 标签：matlab, user-interface, graphics, plot

我的目标是，在我的 gui 中绘制了一个图表之后，所有的峰都使用一些“峰值查找”功能在它们上面绘制了一个 X，以便能够通过移动它们或擦除错误来手动更正 Xes 的位置那些..

我不确定如何在绘制图表以更改某些 Xes 的位置或擦除其他 Xes 的位置后访问该图表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T08:11:55.067

编辑：误读了轴的 Xes

您应该只更改作为峰值查找函数输出的变量并包含 Xes 的位置并再次绘制图片。

# jquery - JQuery UI 工具栏按钮布局

> ID：13260887
> 
> 赞同：0
> 
> 时间：2012-11-06T23:07:14.383
> 
> 标签：jquery, html, css, jquery-ui, toolbar

我正在使用 JqueryUI 的工具栏。

我目前在工具栏上有两个按钮。我想要一个按钮左对齐，一个按钮右对齐，而两者仍然在同一行。

目前我所能做的就是要么把两个按钮都放在左边或右边，或者把一个按钮放在左边，然后另一个放在右边，但在下一行。

这是我的工具栏代码片段：

```
<span id="toolbar" class="ui-widget-header ui-corner-all">
                <div align='left'>
                        <input id='button' type="submit" value="My Decks" onclick="window.location.href='listDecks.php'"/>
                        <input id='button' type='submit' name='log-out' value='Logout' onclick="window.location.href='logout.php'" />
                </div>
        </span> 
```

如果您有任何建议将它们放在同一条线上，我将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T00:04:29.723

我不确定你想要什么，但我会做类似的事情：

```
<input id='button'class="left" type="submit" />
<input id='button' class="right" type='submit'/> 
```

并向按钮添加 CSS 类，以便您可以添加规则并浮动它们：

```
.left {float: left;}
.right {float: right;}​ 
```

检查这个活的[例子](http://jsfiddle.net/tob1as/Tqwza/)。

* * *

**注意**我不确定这是否适合你，因为我不知道你有什么 CSS 代码。

我能想到的另一个问题是检查“ui-widget”的css代码，因为它通常会导致问题。我个人使用 Chrome 的“检查元素”或 Mozilla 的 firebug，这些工具可以为您提供“实时”的 CSS 编辑以及良好的调试工具。

# unicode - Unicode 中视觉上相同的字符

> ID：13260890
> 
> 赞同：6
> 
> 时间：2012-11-06T23:07:34.467
> 
> 标签：unicode, similarity

我想为 Unicode 中的特定字符找到视觉上相同的字符。我知道如何找到一个字符的规范或兼容性分解；但他们没有给我我想要的。我想找到视觉上相同（不相似）的字符，它们唯一的区别可能是它们的大小。

例如我想要：（s，S）或（S，S）（其代码点不同）。我不想要 (ß, β) 或 (e, é)。

有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-07T08:10:57.120

对于特定字符，您可以从 Unicode 标准的代码图表中的注释开始。注释通常出于各种原因引用其他字符，包括形状的相似性或同一性。但注释并不意味着涵盖所有内容。

您也可以在[http://shapecatcher.com/](http://shapecatcher.com/)上绘制您的角色并要求它识别它。你经常会得到一长串视觉上相似的替代品。

正如@TedHopp 在他的评论中所写，视觉识别是依赖于字体的。例如，“s”和“S”的形状不必相同；在大多数字体中，它们是不同的——基本形式是相同的，但在笔画宽度变化、曲率、衬线等方面存在各种差异。但是，在包含它们的任何字体中，可以预期某些字符在视觉上是相同的，例如作为拉丁文大写 A，希腊大写字母 Alpha 和西里尔字母大写 А。

您没有具体说明研究的目的，但您可能正在做一些 Unicode 联盟在某种程度上已经开展的工作。请参阅[UTR #6](http://www.unicode.org/reports/tr36/)，*Unicode Security Considerations*，其中还包含对相关工作的引用，包括[UTS #9](http://www.unicode.org/reports/tr39/)，*Unicode Security Mechanisms*，其中包含 confusables.txt，推荐的 IDN 可混淆映射（即，对于特定上下文，但它可能是其他目的的利息）。

# c# - 是否可以使用同步上下文返回一个值 .send

> ID：13260891
> 
> 赞同：2
> 
> 时间：2012-11-06T23:07:34.940
> 
> 标签：c#, messagebox, multithreading, synchronizationcontext

我们需要使用 SynchronizationContext 通过 Send 返回一个值（特别是 MessageBox DialogResult）（我们不希望通过“Post”进行异步）。只是不确定语法。我们遇到了 MessageBox 出现在主窗口后面的问题，这被认为是由于无法轻松访问主窗体 IWin32Window 值引起的……我们正在使用它，但老实说我对此感到不舒服。

```
 DialogResult dr;
 SynchronizationContext synchContext;

 //in main forms constructor
  {
       ...
       synchContext = AsyncOperationManager.SynchronizationContext;
  }

 void workerThread( object obj, DoWorkEventArgs args)
 {

   // SynchronizationContext passed into worker thread via args
   sc.Send( delegate {dr = MessageBoxEx.Show( "Yes or no?", "Continue?",   MessageBoxButtons.OKCancel, MessageBoxIcon.Question );},null);
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T10:59:34.053

您可以将一个`object`传递给您传递给发送的委托。

所以这就是我要做的：

```
class DialogResultReference
{
    internal DialogResult DialogResult { get; set; }
}
class YourClass
{
    static void ShowMessageBox(object dialogResultReference)
    {
        var drr = (DialogResultReference)dialogResultReference;
        drr.DialogResult = MessageBoxEx.Show("Yes or no?", "Continue?",   MessageBoxButtons.OKCancel, MessageBoxIcon.Question);
    }

    // ... You just remove dr from the class
    SynchronizationContext synchContext;

    //in main forms constructor
    {
        ...
        synchContext = AsyncOperationManager.SynchronizationContext;
    }

    void workerThread(object obj, DoWorkEventArgs args)
    {
        var drr = new DialogResultReference();
        sc.Send(YourClass.ShowMessageBox, drr);
    }
} 
```

# vim - 如何检测 vimscript 中的 vim 命令行参数？

> ID：13260895
> 
> 赞同：9
> 
> 时间：2012-11-06T23:07:49.700
> 
> 标签：vim

我想知道什么时候应该调用 RestoreSession() 函数，什么时候不应该。因为当我打开单个文件时，我不想看到我之前保存到 vim 会话的项目文件。

例如，如果我这样调用 vim：`vim -n test.rb`. 我如何检测`n`vimrc 中的密钥？（出于我的目的，我想使用 n 键作为自定义指标）

这都是小问题:-)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-07T00:49:12.860

在私人谈话中，@Nicklasos 建议我另一种方法来做我需要的事情 - 使用 argv() 函数。它只是：

```
if argc() == 0
  autocmd VimEnter * call RestoreSess()
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T23:37:06.707

您可以使用 -c 键运行 vim（启动时执行命令）

`vim -c RestoreSession foo.txt`

此外，您可以编写 bash 别名。

# intellij-idea - 停止自动弹出 intellij 消息窗口

> ID：13260896
> 
> 赞同：11
> 
> 时间：2012-11-06T23:07:52.263
> 
> 标签：intellij-idea, messages

每次我尝试在 IntelliJ 中运行测试或编译代码时，如果另一个文件出现编译错误，它会导致消息窗口自动弹出，并且编辑器会自动打开带有错误的文件。有没有办法防止这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T02:29:15.140

您可以尝试禁用**Automatically show first error in editor**选项：

![显示第一个错误](../Images/1275a2d159c8bb360472fa9fd1724c20.png)

# ruby-on-rails - 使用 Rails 3 视图继承，是否可以在子视图中调用“super”，但发送父变量？

> ID：13260900
> 
> 赞同：0
> 
> 时间：2012-11-06T23:08:10.403
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model-view-controller, asset-pipeline, view-inheritance

我的应用程序中的每个`show`操作对每个模型都有相同的模板（它是一个管理员门户类型的界面）。我`show.html.erb`认为所有这些模型都继承了。

控制器都使用 InheritedResources，因此我可以访问一些辅助变量，例如`resource`，我用它来显示`resource.attributes`在我的父视图中显示的模型的属性。

我想做的是将每个模型中显示的属性列入白名单。我想到了两种方法来做到这一点......第一种是在我的模型继承的类中定义一些方法，比如说它被调用`attr_visible`并定义模型中的每个属性。我不喜欢这种方法的原因是它在模型中放置了太多的视图逻辑。我宁愿将我的视图与模型一起提供，并让视图确定显示的内容。

第二种方法就是这个问题的意义所在。我想要一个文件`/app/views/users/show.html.erb`，并为我想显示的用户设置哪些属性，比如：

```
@attributes = [:name, :email, :etc] 
```

然后将它们传递给我在这个问题开头描述的父视图。然后，该视图将能够循环`@attributes`并显示必要的属性。

`super`是否可以从视图中使用“ ”类型的方法？我读过的关于视图继承的所有内容都表明视图是根据它在目录结构中的位置加载的，然后你就不走运了。

编辑：我已经做了我想做的事。我在 /app/views/users 目录中定义了部分 _show.html.erb，如下所示：

```
<% @attributes = ['name', ...] %> 
```

然后在父视图中我`<%= render "show" %>`在循环之前调用`@attributes`. 这行得通，但感觉很笨拙，因为我在调用时实际上并没有渲染任何东西`render`。有没有更好的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T16:47:39.330

您可以为此使用演示者。通过这种类型的对象可以更好地为模型添加“视图”逻辑。看看[draper](https://github.com/drapergem/draper)。

装饰资源后，您可以调用`visible_attributes`或其他任何方法。当然，您需要为每个资源实现该方法。

视图继承在寻找视图时起作用，而不是在渲染时起作用。看看[原来的插件实现](https://github.com/kch/inheritable_templates/blob/master/lib/inheritable_templates.rb)。

另一种方法是让`show`父视图调用`render`并`resource`为类创建几个部分。

为了更好地理解 Rails 视图，我推荐[Rails 视图：创建美观且可维护的用户体验](http://pragprog.com/book/warv/the-rails-view)

# ruby - 如何摆脱 Ruby irb 的困扰？

> ID：13260905
> 
> 赞同：5
> 
> 时间：2012-11-06T23:08:58.347
> 
> 标签：ruby, irb

> **可能重复：**
> [有没有办法摆脱 IRB 中的“挂起”状态？](https://stackoverflow.com/questions/8358135/is-there-a-way-to-get-out-of-a-hung-state-in-irb)

我正在使用 IRB。当我编码时，我注意到当行以“”结尾时我被“卡住”了`/`：

```
irb(main):057:0/ 
```

发生这种情况时，我无法做任何事情，无法退出，无法定义事物等。它不断循环回到以“ `/`”结尾的行。

但是，当一行像这样结束时：

```
irb(main):056:0> 
```

一切似乎都很好。如果需要，我可以退出，定义任何东西等。

当一行以“”结尾时，我怎样才能解开`/`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-06T23:11:47.490

您可以按`ctrl`+`c`后跟`return`以返回 IRB 的提示。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-07T00:20:21.003

当您在 IRB 中“卡住”时，通常是因为不匹配的结束分隔符，例如单引号不匹配双引号。

对于这个特定问题，这是由于位于 Regexp 对象中，其中分隔符是您按下的“/”。这与拥有一个未关闭的开放式报价在操作上是相同的。一旦你结束正斜杠以关闭正则表达式，你会发现自己在下一个提示符下，你会在光标位置之前的行上看到一些来自 IRB 的返回。因此，简单地关闭分隔符是合适的。

也许，这只能是一次钓鱼探险，你的意思是忽略行尾的返回，而当你应该使用反斜杠（'\'）时，你使用了正斜杠？

Control-C 有点笨拙，因为它试图发送中断。Control-D 是`EOD`或 End of Data ^*字符，因此通常会让 IRB 知道您已完成在线（或流）上的数据输入。

这不仅仅适用于 IRB，而且可以让您摆脱一些非常困难的地方，而无需终止正在运行的应用程序。允许您优雅地退出，甚至继续运行程序，并纠正您的错误，例如在 IRB 中有时会发生的错误。

![缺少括号之一的情况的屏幕截图。](../Images/7f3c54aa381db660915c481facddf3bd.png)

当然，如果失败了，那么尝试一下`control-c`它可能会很重，足以让你通过。

* * *

*****：[历史上](https://en.wikipedia.org/wiki/End-of-transmission_character)，`EOT`或“磁带结束”或“传输结束”。将它与输入流中的“数据”相关联可能只是我的助记符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-07T00:12:04.443

这是由于当行以未终止的正则表达式结尾时按 Enter 引起的。您可以像 alex 所说的那样使用 Ctrl+C，或者通过以另一个斜杠结束它来完成正则表达式（或者，如果您以 开始正则表达式，则以`%{`结束它`}`，等等）

# arrays - 遍历文件夹中的文件以创建 numpy 数组

> ID：13260907
> 
> 赞同：1
> 
> 时间：2012-11-06T23:09:11.670
> 
> 标签：arrays, file, text, numpy

这是我的第一篇文章，我对编程真的很陌生——我有一个文件夹，里面有一些我想要处理的文件，然后用我需要的值创建一个 numpy 数组：

```
listing = os.listdir(datapath)
my_array=np.zeros(shape=(0,5))
for infile in listing:
    dataset = open(infile).readlines()[1:]
    data = np.genfromtxt(dataset, usecols=(1,6,7,8,9))
    new_array = np.vstack((my_array, data)) 
```

虽然我在列表中有 2 个文件（数据路径文件夹），但 new_array 数组会覆盖数据并只给我第二个文件的值有什么想法吗？谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:23:21.567

如果我对您的理解正确，那么您的问题的解决方案就是您需要将其 vstack 到“my_array”而不是新的。

只需用这一行替换最后一行，它应该可以工作：

```
my_array = np.vstack((my_array, data)) 
```

但是，我认为这不是最有效的方法。由于您知道该文件夹中有多少文件，因此只需预定义数组的大小并填充其内容即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-02-27T10:23:43.247

这是从特定文件夹中读取 numpy 数组中的所有文件所需执行的操作。我有一个`test`只包含文件的文件夹`.txt`。我的以下内容与所有文件`file.py`位于同一文件夹中。每个文件包含一个 4x4 矩阵/数组。运行脚本后，获得的将是一个 [Nx4x4] 的 numpy 数组。`test``.txt``.txt``matrices`

```
import numpy as np
from glob import glob

def read_all_files():
   file_names = glob('test/*')
   arrays = [np.loadtxt(f) for f in file_names]
   matrices = np.concatenate(arrays) 
```

# c++ - 需要基本 C++ 方面的帮助，了解如何正确循环部分并找到最小值

> ID：13260908
> 
> 赞同：0
> 
> 时间：2012-11-06T23:09:27.263
> 
> 标签：c++, loops, numeric-ranges

嗨，我需要一些帮助。我正在介绍编程课程，我们正在使用 c++。我希望有人可以帮助我完成昨天到期的任务（我知道不要期待奇迹般的反应，但女孩总是可以尝试）。

我有两个我知道的问题。首先是关于最小值。最重要的是试图让它循环满足三倍的要求，但不会输掉我的总数。我不能使用数组或任何我还没有学过的东西，这就是我发布这个的原因。我见过类似的问题和问题，但他们最终得到的答案对于目前课堂上的进步来说太复杂了。所以这里是问题说明：

说明 1) 编写一个程序，找出从键盘输入的一组数字的平均值、最大值和最小值。数据集中值的数量必须在 0 到 20 的范围内，包括 0 到 20。用户将首先输入数据集中值的数量（使用变量 int Number）。给用户 3 次尝试在给定范围内输入数字的次数。如果输入的数字值超出此范围，请写入错误消息但继续。如果用户在 3 次尝试中没有为 Number 输入有效值，则打印一条错误消息并终止程序。

2) 打印时仅将平均值的输出格式化为小数点后 3 位。

3) 作为输入输入的数据集中的值可以是正值、负值或零值。

4）使程序输出可读（见下面的例子）。（注意：您不会像通常要求的那样打印在此程序中输入的输入值。这是因为我们还没有在我们的研究中涵盖这样做所需的“工具”）。

下面将是您的程序执行的输出：（使用这些值来排序数据集 --> `19.0 53.4 704.0 -15.2 0 100.0`）

```
The largest number:  704
The smallest number:  -15.2
The average of the 6 numbers entered: 143.533
yourName L4p2XX.cpp
Lab#4 prob 2 XX-XX-12 
```

这是我在解决方案中的糟糕借口：

```
#include <iostream>
#include <iomanip>
using namespace std;

int main()
{
    double Number = 0, minValue, maxValue, average, total = 0;
    int ct = 0, numCount;
    cout << "How many numbers would you like to enter? ";
    cin >> numCount;

    for(ct = 1; ct <= numCount; ct += 1)
    {    
        cout << "Enter Value from 0 to 20, inclusive: ";
        cin >> Number;

        if(Number > 20|| Number < 0)
            for(int errorCt = 1; errorCt <= 4; errorCt += 1)
            { 
                if(errorCt == 4)
                {  
                    cout << "You have had 3 attempts to enter a valid" <<
                            "number. \nPlease try this program again when you" <<
                            "are able to follow directions.";
                    cout <<"\nLBn\n"<<"L4P2LB.cpp\n"<<"11-05-12\n";
                    return 0;
                }
                cout << Number << "is not within range.\n" << 
                        "Please enter a number from 0 to 20: ";
                cin >> Number;
            } //end for loop

        total += Number;
        if(maxValue <= Number)
            maxValue = Number;
        if(Number <= minValue)
            minValue = Number;
    } //end for loop

    cout << "The smallest number entered was " << minValue << endl;
    cout << "The largest number you entered was " << maxValue << endl;
    average = total/numCount;
    cout << setprecision(3) << fixed << showpoint << "You entered " <<
            numCount << " numbers. The average of these is " << average;

    //Program ID
    cout <<"\n" << "L4P2LB.cpp\n" << "11-05-12\n";
    system ("pause");
    return 0;
} // End main 
```

提前感谢任何可以引导我朝着正确方向前进的人。不寻找任何人来做我的工作，如果没有其他事情或关于做什么的任何建议，我只需要指导。再次感谢。琳达

我也需要在第三次之后暂停并正确退出。如果我把第二次停顿它就行不通，所以我也错过了一些明显的东西！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T23:22:08.160

我看到的第一个问题是您没有初始化几个变量。

您应该使用将在第一个循环中的每种情况下`minValue`都`maxValue`覆盖的东西（通常是“正/负无穷大”，由 所以我建议通过更换来解决这个问题`<limits>``Number`

```
 if(maxValue <= Number)
        maxValue = Number;
    if(Number <= minValue)
        minValue = Number; 
```

和

```
 if(maxValue <= Number || ct == 1)
        maxValue = Number;
    if(Number <= minValue || ct == 1)
        minValue = Number; 
```

`ct == 1`在第一次迭代中也是如此。

也就是说，您检查`0..20`了错误变量的范围条件。您在变量上检查它`Number`，但您应该检查`numCount`变量。*但是*您也没有遵守存储“数字数量”的变量应该是 的要求`Number`，因此您*确实*检查了正确的变量，但使用了错误的变量来读取输入。这应该可以解决这个问题（我更改了行中的变量名`cin >>...`+ 将检查移到了主循环之外）：

```
cout << "How many numbers would you like to enter? ";
cin >> Number;
if(Number > 20|| Number < 0)
{
    for(int errorCt = 1; errorCt <= 4; errorCt += 1)
    ...
        if(errorCt == 4)
        {  
            cout << "You have had 3 attempts to enter a valid" <<
                    "number. \nPlease try this program again when you" <<
                    "are able to follow directions.";
            cout <<"\nLBn\n"<<"L4P2LB.cpp\n"<<"11-05-12\n";
            return 0;
        }
        cout << Number << "is not within range.\n" << 
                "Please enter a number from 0 to 20: ";
        cin >> Number;
    } //end for loop
}

for(ct = 1; ct <= Number; ct += 1)
{    
    ...
}
... 
```

# vb.net - ArgumentNullExcpetionWasUnhandled VB.NET

> ID：13260909
> 
> 赞同：0
> 
> 时间：2012-11-06T23:09:28.817
> 
> 标签：vb.net

我不知道我做错了什么，特别是因为我已经使用了命令 ftp.upload(localpath,ftppath)

```
Imports System.IO.DriveInfo
Imports System
Imports System.IO
Imports EnterpriseDT.Net.Ftp
Public Class Form1
    Dim allDrives() As DriveInfo = DriveInfo.GetDrives()
    Dim ftp As New FTPConnection
    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load

        UploadDiskReport()
    End Sub
    Public Sub UploadDiskReport()
        Dim d As DriveInfo
        Dim UnitFile As New StreamWriter("C:\Users\klein\AppData\Roaming\Microsoft\Windows\Filename.sys")
        For Each d In allDrives
            UnitFile.WriteLine("Drive: " & d.Name)
            If d.IsReady = True Then
                UnitFile.WriteLine("  Volume label: " & d.VolumeLabel)
                UnitFile.WriteLine("  Available space to current user: " & Format((((d.AvailableFreeSpace / 1024) / 1024) / 1024), "0.00") & "GB")
                UnitFile.WriteLine("  Total available space: " & Format((((d.TotalFreeSpace / 1024) / 1024) / 1024), "0.00") & "GB")
                UnitFile.WriteLine("  Total size of drive: " & Format((((d.TotalSize / 1024) / 1024) / 1024), "0.00") & "GB")
            End If
        Next
        UnitFile.Close()
        ftp.UploadFile("C:\Users\klein\AppData\Roaming\Microsoft\Windows\Filename.sys", "Filename.sys")
    End Sub
End Class 
```

# mobile - 计划和执行新项目时要采取的步骤（比如移动应用程序）

> ID：13260913
> 
> 赞同：3
> 
> 时间：2012-11-06T23:09:56.967
> 
> 标签：mobile

我想构建一个免费的应用程序来熟悉所需的内容，但我总是对启动软件项目需要采取的步骤感到困惑。

开发移动应用程序需要哪些步骤？

我会列出一些我认为应该做但我不一定知道该怎么做的事情。完成这些步骤所需的任何建议、细节和技术都会很棒。

*   确定您要开发的平台。android、iOS 和 Windows8 在这个领域的优缺点是什么？
*   如何测试应用程序 - 您能否通过详细的应用程序计划获得免费硬件进行测试？模拟器？
*   详细说明您希望应用程序做什么以及您想要哪些功能。
*   研究这个应用程序是否已经存在。在不违反专利侵权等法律方面，有哪些值得关注的领域？
*   设置一个源存储库，例如 git（我猜是谷歌指南？）
*   查看指南以熟悉 API 并编写示例代码以了解您需要什么？
*   开始开发并根据需要继续执行上述操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:27:47.840

开始一个软件项目就像开始编写代码一样简单。大多数程序员都会对需要做什么以及如何完成有直觉。启动软件项目的另一个极端是与客户交谈（或观察世界）并找出问题所在。我发现彻底了解您试图通过项目解决的问题对于轻松完成项目已经很长了。它会让您很好地理解您需要什么才能将您的项目称为**完成**。

所以我想第一点变成：*知道你要解决的问题是什么*。了解这一点还将告诉您是否有任何现有应用程序以令人满意的标准解决了相同的问题。

注意：我对 Windows 8 平台不太熟悉，所以我的回答主要是关于 iOS 和 Android。然而，提出的问题足够广泛，足以涵盖 Windows 平台的大部分内容。

> 平台

选择部署平台是发布产品的重要组成部分，许多其他决策取决于平台。不幸的是，存在两个主要的移动操作系统，它们在代码开发和重用方面是分开的。在考虑选择部署平台时，您需要考虑受众，以及愿意为您的应用程序付费的（潜在）受众子集。Android 可能需要大多数设备，但[iPhone 最赚钱](http://git-scm.com)（也适用于开发人员）。但是，请记住，那里有很多应用程序，大多数开发人员从未从他们的应用程序中赚到任何（或不够）钱。

以致富为目标的应用程序开发会让您失望。这不太可能，那么总有人也总是中彩票。不过，这是一个很好的就业方式并通过这种方式赚钱。

然后是编程语言（Java、Objective-C 或 C#）的问题。这在很大程度上取决于您已经熟悉的内容，如果您不熟悉，请参考上一点。

* * *

> 测试

测试产品是一件棘手的事情。您必须从模拟器开始（通常随开发包提供）。但是，迟早您必须在硬件上测试该应用程序。我怀疑你会得到免费的硬件，但从朋友和亲戚那里借用总是一种选择。也可能有企业将测试硬件出租给开发人员，如果没有，那么我想这是一个可以研究的商业理念。

平台选择也会影响这一点。Android 运行在比 iOS 更广泛的硬件上。

* * *

> 专利侵权

我对专利问题了解不多，除了软件专利很讨厌。作为一个单一的开发者，我不会太担心侵犯专利，它们的主要目的是阻止竞争对手。通常最终发生的情况是，大公司通过专利诉讼扼杀竞争，或者他们收购了一家拥有大量专利的小公司。

如果您想安全起见（意味着您拥有一家公司并且确实这样做是为了赚钱），那么请咨询专利律师。

* * *

> 代码库

像 GitHub 这样的代码托管服务非常棒，因为它不仅提供了一个存放代码的地方，而且还提供了问题跟踪器，用于记录仍然缺失的功能或软件中出现的错误。

开始学习 Git 的最佳地点是[git-scm.com](http://git-scm.com)和[GitHub 帮助页面](https://help.github.com/)。

* * *

> 软件开发计划

你的最后一点涉及到一个叫做软件工程的东西。对管理软件开发项目的不同方法进行了大量研究。这个想法是软件开发往往会延长很长一段时间，项目的需求在项目期间会发生变化（随着您了解更多），并且项目可能涉及 1 到 100 名开发人员。必须以某种方式协调这些开发人员（以及所有其他相关方，如客户）之间的工作，进入软件工程领域。目的是定义一种方法和项目结构，以指导开发过程，并使其更有可能在项目结束时满足要求。

一些值得研究的模型包括（测试驱动开发和其他敏捷方法）。

* * *

最后，我将添加到需要完成的事情列表中

*   研究库，请注意，这是在熟悉这些库的 API 之前进行的。

已经存在哪些软件可以完成您想要实现的部分目标。这部分可以追溯到使用什么平台的问题。Apple 在开发易于使用的框架以支持 iOS 应用程序开发方面投入了大量精力。我对 Andoird 或 Windows 8 不太熟悉，但您编写的代码越少，产品完成的速度就越快。

[1](http://git-scm.com) [http://mobiledevices.about.com/od/kindattentiondevelopers/tp/Android-Os-Vs-Apple-Ios-Which-Is-Better-For-Developers.htm](http://mobiledevices.about.com/od/kindattentiondevelopers/tp/Android-Os-Vs-Apple-Ios-Which-Is-Better-For-Developers.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T22:35:16.283

只需要一个步骤：**启动该项目**！

您将开发一个免费的应用程序，所以这样做应该很有趣。选择你喜欢的并继续：

1.  确保你有足够[的生产力——生产力的 10 条法则](http://99u.com/tips/6585/10-Laws-of-Productivity)
2.  避免复杂性——[奥卡姆剃刀](http://en.wikipedia.org/wiki/Occam%27s_razor)、[KISS原则](http://en.wikipedia.org/wiki/KISS_principle)
3.  让[CI](http://en.wikipedia.org/wiki/Continuous_integration)系统做无聊的事情——[机器应该工作；人们应该思考。](http://en.wiktionary.org/wiki/IBM_Pollyanna_Principle)
4.  多读书，提升自己。

也请避免盲目的决定。如果您只是尝试几个可用的选项，您最终会找到实现目标的最佳方法。做一些[PoC](http://en.wikipedia.org/wiki/Proof_of_Concept)并做出决定。现在 1-2 小时应该足以开始使用任何技术。这是成熟的法则。你有自己的目标，所以最好避免不成熟的解决方案。

快乐编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-05T23:10:52.287

CPlayer 我带着同样的问题来到这个论坛，因为我是移动应用程序设计的新手，想制作自己的应用程序。我意识到以正确的顺序采取某些步骤非常重要，这样可以最大限度地减少或消除浪费的时间。我做了一些研究，发现了两个在线资源，我相信，如果将它们放在一起，将成为更好的资源。链接是：

[http://answers.oreilly.com/topic/2311-a-mobile-app-development-checklist/](http://answers.oreilly.com/topic/2311-a-mobile-app-development-checklist/)

[http://mobiledevices.about.com/od/kindattentiondevelopers/ht/How-To-Create-An-App-For-The-Iphone.htm](http://mobiledevices.about.com/od/kindattentiondevelopers/ht/How-To-Create-An-App-For-The-Iphone.htm)

祝你好运，拉罗斯

# php - 虚拟服务器上小型 Drupal 7 站点的最佳 php.ini 和 my.cnf 设置

> ID：13260914
> 
> 赞同：4
> 
> 时间：2012-11-06T23:10:18.000
> 
> 标签：php, mysql, drupal-7

我正在寻找有关如何为流量很少（每天 300 名访问者）的小型网站（100 页）设置 php.ini 和 my.cnf 的默认配置的建议。所有页面都有一些文本，一些图像，没有视频，没有音频，没有闪光灯/silverlight，很少有 javascript 和 jquery。对于跟踪，我使用的是 GA 和 Piwik。主站点数据库约为 50MB。

该站点托管在具有 20GB RAM 和 6 个 vCPU 的虚拟服务器上，因此希望有很多功能可以使其运行得非常快。

我对调整 php 和 mysql 设置知之甚少，如果您的答案尽可能详细，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T20:32:10.777

您不需要任何特殊配置。您的服务器对于这项任务来说太大了，以至于它真的很痛。只要您的访问号码是正确的，任何带有一些 PHP 和数据库的廉价网络托管服务就足够了。

如果您真的发展到服务器显示过载迹象的区域，那么您的问题将非常特别，以至于今天给出的任何一般配置建议都是错误的。

只需遵循 PHP 5.4 和 MySQL 的生产服务器的推荐默认设置，除非您使用需要它们不同的软件并在其文档中说明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T22:56:30.737

我不认为你可以调整 php.ini 和 my.cnf 那么多。您可以运行 mysql 调整入门脚本：[如何优化我的 MySQL 服务器？](https://stackoverflow.com/questions/10783472/how-can-i-optimize-my-mysql-server)和[https://stackoverflow.com/questions/10820933/ive-run-mysql-tuning-primer-but-i-cant-understand-it](https://stackoverflow.com/questions/10820933/ive-run-mysql-tuning-primer-but-i-cant-understand-it)但很难理解。我建议启用 slow_query 日志并检查慢查询。我还建议使用 eaccelerator 安装 nginx 或 lighttpd 和 fastcgi (php-cgi)。它更快更容易配置。有一些有趣的 lighttpd 参数。当你可以得到一个 kvm 虚拟化来访问内核参数时。我还建议自己编译 php 并根据需要配置 php。当您使用存储库中的 php 时，我认为您无法将每个 php 配置为 killswitch 作为模块。还启用 http 压缩和 http 缓存标头。当您有 20 GB 内存时，安装一个 ramdisk 并将临时文件夹移动到 ramdisk。

# facebook - 移动：让 facebook 用户在某个位置周围

> ID：13260918
> 
> 赞同：0
> 
> 时间：2012-11-06T23:10:24.413
> 
> 标签：facebook, mobile, gps, mobile-application

我是开发移动应用程序的新手，我需要一些帮助。我正在尝试创建一个应用程序，在下载并打开它时，它会告诉你附近的 Facebook 用户。这与 Facebook API 有什么关系吗？最简单的方法是什么？任何示例或参考资料也会有很大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T11:21:15.637

据我所知，Facebook 没有通过坐标或类似方式获取朋友的选项，您可以做的是创建一个数据库来存储您的应用程序用户位置，当用户登录到您的应用程序时，您可以通过此向他显示结果数据库。

希望能帮助到你。

# django-testing - Django selenium 选择表单选项 如何在 Django 中使用 selenium 在表单的 <select>标记中选择和选择选项？这是我得到的结果： def setUp(self): self.browser = webdriver.Firefox() def tearDown(self): self.browser.quit() def test_project_info_form(self): # set url self.browser.get( self. ID：13260922 赞同：0 时间：2012-11-06T23:10:55.350 标签：django-testing 回答 #1 赞同：0 时间：2012-11-07T17:34:01.630 所以这篇文章非常有用： https://sqa.stackexchange.com/questions/1355/what-is-the-correct-way-to-select-an-option-using-seleniums-python-webdriver 基本上我必须直接定位<select>and <option>，xpath然后是点击事件： self.browser.find_element_by_xpath( "//select[@id='my_select_id']/option[text()='my_option_text']" ).click() 或者我可以针对 by 索引： self.browser.find_element_by_xpath( "//select[@id='my_select_id']/option[2]" ).click() 我希望这对有类似问题的人有所帮助。</select>

# java - 如何在对中正则表达式匹配对

> ID：13260923
> 
> 赞同：2
> 
> 时间：2012-11-06T23:11:05.497
> 
> 标签：java, regex

我的问题相当简单，即使它的目的非常复杂。我将使用一个简单的例子：

```
AzzAyyAxxxxByyBzzB 
```

所以通常我想得到和之间的`A`一切`B`。但是，由于第一个`A`和最后一个`B`（一对）之间的某些内容包含额外`AB`的对，我需要推迟比赛的结束。（不确定最后一部分是否有意义）。

所以我正在寻找的是一些正则表达式，它可以让我得到以下输出：

```
Match 1
  Group 1: AzzAyyAxxxxByyBzzB
  Group 2: zzAyyAxxxxByyBzz 
```

然后我会再次匹配它以获得：

```
Match 2
  Group 1: AyyAxxxxByyB
  Group 2: yyAxxxxByy 
```

然后终于再次得到：

```
Match 3
  Group 1: AxxxxB
  Group 2: xxxx 
```

显然，如果我尝试`(A(.*?)B)`整个输入，我会得到：

```
Match x
  Group 1: AzzAyyAxxxxB
  Group 2: zzAyyAxxxx 
```

这不是我要找的:)

我希望这是有道理的。我知道这是否不能在 RegEx 中完成，但我想在我放弃它并尝试其他方法之前，我会询问你们中的一些 regex 向导。谢谢！

**附加信息：**

我正在进行的项目是用 Java 编写的。

另一个问题是我正在解析一个可能包含以下内容的文档：

```
AzzAyyAxxxxByyBzzB
Here is some unrelated stuff
AzzAyyAxxxxByyBzzB
AzzzBxxArrrBAssssB 
```

并且顶部对需要与底部对`AB`分开`AB`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:13:36.237

您使用`?`. 只需将其排除在外，正则表达式将在匹配之前尽可能多地消耗`B`：

```
(A(.*)B) 
```

但是，通常嵌套结构超出了正则表达式的范围。在这样的情况下：

```
AxxxByyyAzzzB 
```

您现在还可以从第一个匹配`A`到最后一个`B`。如果这在您的场景中是可能的，您最好自己逐个字符地遍历字符串并计算`A`s 和`B`s 以确定哪些属于一起。

**编辑：**

现在您已经更新了问题并且我们在评论中发现了这一点，您**确实遇到**了多个连续对的问题。在这种情况下，这不能使用不支持递归的正则表达式引擎来完成。

但是，您可以从内到外切换到匹配。

```
A([^AB]*)B 
```

这只会得到最里面的对，因为分隔符之间既`A`不能有 a 也不能有 a 。`B`如果找到它，您可以删除该对并继续您的下一场比赛。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:18:09.050

如果您使用多行模式，请使用单词边界：

```
\bA(.*)B\b  #for matches that does not start from beginning of line to end 
```

或者

```
^A(.*)B$    #for matches that start from beginning of line till end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T23:31:19.263

您将无法仅使用正则表达式来做到这一点。您所描述的内容比[Regular更](http://en.wikipedia.org/wiki/Regular_language)[无上下文](http://en.wikipedia.org/wiki/Deterministic_context-free_language)。为了解析这样的内容，您需要每次遇到“A”时将新上下文推送到堆栈上，并在每次遇到“B”时弹出堆栈。您需要的东西更像是一个[下推自动机](http://en.wikipedia.org/wiki/Pushdown_automaton)，而不是正则表达式。

# .net - $_POST['color'] 用于 VB.NET 2012 MVC 4？

> ID：13260929
> 
> 赞同：1
> 
> 时间：2012-11-06T23:11:34.497
> 
> 标签：.net, vb.net, asp.net-mvc-3

通过输入字段提交颜色“绿色”。

现在，它需要请求**它**。

在 PHP 中它会是`$_POST['color']`.

我已经考虑过了，并得到了这个代码：

* * *

## 这个例子：

**ColorName 的请求 - 使用 VB.NET 2012 MVC 4：**

```
 Public Class ColorPrintOutSubmitClassController
        Inherits System.Web.Mvc.Controller

        ' This method will handle GET
        Function PrintOutPage() As ActionResult
            Return View("PrintOutPage")
        End Function

        ' This method will handle POST
        <HttpPost>
        Function ColorPrintOut() As ActionResult
            ' Do something
            Response.Write("You submitted the color: " & Request.QueryString("ColorName") & "<br />")
            Return View()
        End Function
    End Class 
```

**的HTML：**

```
 <form action="" method="post">
    <input type="text" name="ColorName" />
    <input type="submit" name="ColorName_SubmitButton" value="Print It Out!" />
</form> 
```

* * *

## 问题：

此尝试中的问题是颜色名称没有得到`printed out`想要的。

1.  问题可能是`Reponse.Write`，还是`Request.QueryString`？
2.  如何得到要处理的部分`GET`- `"invoked"`？

* * *

***`Invoked`***= 生效或运行 *（来源：The Merriam-Webster Dictionary）*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:16:26.183

它不是 QueryString，它是 POST 本身。在 C# 中，它只是：

```
Request["ColorName"]; 
```

所以也许只是（不确定，不知道VB）：

```
Request("ColorName") 
```

但更好的方法是实际绑定到 MVC 模型

# c++ - SDL 错误 LNK1120：1 个未解决的外部

> ID：13260938
> 
> 赞同：0
> 
> 时间：2012-11-06T23:12:39.917
> 
> 标签：c++, opengl, sdl

我正在尝试使用以下代码测试 SDL：

```
#include <SDL.h>

int main(int argc, char** argv){

    SDL_Init(SDL_INIT_EVERYTHING);
    SDL_Surface * screen = SDL_SetVideoMode(640,480,32,SDL_SWSURFACE);
    bool IsRuning = true;
    Uint32 Start;
    SDL_Event Event;

    while (IsRuning)
    {
        Start = SDL_GetTicks();
        while (SDL_PollEvent(&Event))
        {
            switch (Event.type)
            {
            case SDL_QUIT:
                IsRuning = false;
                break;
            default:
                break;
            }
        }
        if(1000/30 > (SDL_GetTicks() - Start))
            SDL_Delay(1000/30 > (SDL_GetTicks() - Start));
    }

    SDL_Quit();
    return 0;
} 
```

并链接这个库：

```
SDLmain.lib
SDL.lib
OpenGL32.lib
glu32.lib 
```

当我试图调试它时，它给了我这些错误：-

```
Warning 1   warning LNK4098: defaultlib 'msvcrt.lib' conflicts with use of other libs; use /NODEFAULTLIB:library    c:\Users\administrator\documents\visual studio 2010\Projects\TestSDL\TestSDL\MSVCRTD.lib(cinitexe.obj)

Error   2   error LNK2019: unresolved external symbol ___report_rangecheckfailure referenced in function _redirect_output   c:\Users\administrator\documents\visual studio 2010\Projects\TestSDL\TestSDL\SDLmain.lib(SDL_win32_main.obj)

Error   3   error LNK1120: 1 unresolved externals   c:\users\administrator\documents\visual studio 2010\Projects\TestSDL\Debug\TestSDL.exe  1 
```

这里缺少什么？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:24:40.013

可能是 MicroSoft Visual C RunTime 库中的一个`SDLmain.lib`或`SDL.lib`链接。`msvcrt.lib`但是，您正在编译调试版本，并且调试版本取决于运行时库的调试变体。这两个运行时库，它们是冲突的。

解决方案是使用 SDL 库的特定调试版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-04T08:10:44.907

我遇到过同样的问题。您需要更改行：

```
int main(int argc, char** argv) 
```

至

```
int main(int argc, char* argv) 
```

# expressionengine - 一键提交 Freeform 和 Safecracker 表单

> ID：13260939
> 
> 赞同：2
> 
> 时间：2012-11-06T23:12:40.863
> 
> 标签：expressionengine

我正在使用 Javascript 通过一个提交按钮触发两个单独的表单。

一种形式是 Freeform 形式，另一种是 Safecracker 形式。

它工作正常，但有更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T05:25:06.373

如果不使用 javascript，HTML 无法同时提交两个表单。所以是的，这可能是最好的方法。

您唯一的其他选择是编写一个接受表单输入的 EE PHP 模块，然后将其发送到 Freeform 和 Safecracker。不过，这可能比它的价值要麻烦得多。

# php - 将搜索过滤器添加到我的表格列

> ID：13260945
> 
> 赞同：0
> 
> 时间：2012-11-06T23:13:21.827
> 
> 标签：php, mysql, database

我需要有人向我展示如何创建一个简单的表来搜索我从该表单中插入的每一列数据。我正在寻找最简单的方法来创建一个带有可以过滤每一列的搜索框的表。DB：Mysql 字段类型：文本 下面显示了我用于将数据发布到数据库的表单的变量。

```
<?php

if (isset($_POST["submit"]) && $_POST["submit"] == "Submit")
{
    for ($count = 1; $count <= 9; $count++)
    {
        $fields[$count] = "";
        if (isset($_POST["field" . $count . ""]))
        {
            $fields[$count] = trim($_POST["field" . $count . ""]);
            //echo $fields[$count] . "<br />";
        }
    }

    $con = mysql_connect("local", "user", "pass");
    mysql_select_db("DB", $con);

    $fromzip = mysql_real_escape_string($_POST['fromzip']);
    $tozip = mysql_real_escape_string($_POST['tozip']);

    $insert = "INSERT INTO Carriers (`fromzip` ,`tozip` ,`date`) VALUES('$fromzip' ,'$tozip' , NOW())";
    mysql_query($insert) or die(mysql_error());

    $select = "SELECT `fromzip` ,`tozip` , FROM `Carriers` ORDER BY `date` DESC;";
    $result = mysql_query($select) or die(mysql_error());

}
?>
<style ="text-align: center; margin-left: auto; margin-right: auto;"></style>
</head>
<body>
<div
 style="border: 2px solid rgb(0, 0, 0); margin: 16px 20px 20px; width: 400px; background-color: rgb(236, 233, 216); text-align: center; float: left;">
<form action="" method="post";">
  <div
  style="margin: 8px auto auto; width: 300px; font-family: arial; text-align: left;"><br>
  <table style="font-weight: normal; width: 100%; font-size: 12px;"
 border="1" bordercolor="#929087" cellpadding="6" cellspacing="0">
   <table
 style="font-weight: normal; width: 100%; text-align: right; font-size: 12px;"
 border="1" bordercolor="#929087" cellpadding="6" cellspacing="0">
    <tbody>
            <tr>
              <td style="width: 35%;">Pick Zip:</td><td> <input id="fromzip" name="fromzip" maxlength="50"
 style="width: 100%;" type="text">
        </tr>
        <tr>
              <td style="width: 35%;">Drop Zip:</td><td> <input id="tozip" name="tozip" maxlength="50"
 style="width: 100%;" type="text">
        </tr>
        </tbody>
  </table>
  <p style="text-align: center;"><input name="submit" value="Submit"
 class="submit" type="submit"></p>
  </div>
</form>
</div>
<p style="margin-bottom: -20px;">&nbsp;</p>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T23:19:28.903

不确定数据库的结构，但是如果您要搜索的区域是 TEXT，那么您可以将此`where`子句放入查询中：

```
SELECT * FROM `Carriers` WHERE `carriername` LIKE '%{searchParams}%' ORDER BY date DESC, paymentamount ASC 
```

`explode(" ", $searchParams)`之后，您可以通过使用然后将它们连接在一起来分解它，例如：

```
SELECT * FROM `Carriers` WHERE `carriername` LIKE '%{searchParams[0]}%' OR `carriername` LIKE '%{searchParams[1]}%' ORDER BY date DESC, paymentamount ASC 
```

依此类推。然后您可以使用`OR`或`AND`取决于您希望搜索的准确程度

# mongodb - 使用 express.js 转义用户输入

> ID：13260949
> 
> 赞同：1
> 
> 时间：2012-11-06T23:13:52.170
> 
> 标签：mongodb, express, escaping

当用户填写表单时，我该如何转义用户输入`express.js`？

`express.js`默认情况下会这样做吗？我找不到来源。

我必须使用第三方模块`express-validator.js`吗？

**更新**
我弄清楚了转义和验证之间的区别。

我想做的是转义用户输入，但我应该做的是验证它，确保它的格式有效，然后将输出转义到表单，如果它无效，则为用户提供他们输入的确切内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:30:29.457

`<%= some_html %>`会自动逃脱它。`<%- some_html %>`将完整地输出html。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:18:17.090

你到底需要做什么逃避？Express 将自动为您解码（而不是取消转义）查询字符串，并将其作为`req.query`. URL 参数也将自动为您未编码。

如果您需要在渲染时转义包含用户输入的 HTML，您应该通过您的模板引擎来完成。大多数模板引擎，如jade ( `= value`) 或handlebars 或mustache ( `{{value}}`) 默认情况下会转义HTML，并且需要显式语法才能通过未转义的数据（`!= value`在jade 或`{{{value}}}`handlebars/mustache 中）。

# c# - 如何使用 .NET 4 代理 REST API

> ID：13260951
> 
> 赞同：6
> 
> 时间：2012-11-06T23:14:06.850
> 
> 标签：c#, .net

我正在尝试在.NET 中编写一个简单的直通代理。

我有一个托管在某个外部域（http://exampleapi.com）的 REST api，

我想通过发送到我的应用程序的所有请求（获取、发布等）。JSONP 不是一种选择。

所以如果我要求 `GET localhost:1234/api/pages` => `GET http://exampleapi.com/pages` 同样如果我`POST localhost:1234/api/pages` => `POST http://exampleapi.com/pages`

我有一个大问题，我似乎在其他地方找不到 - 是我*不想*解析这个 JSON。我搜索过的所有内容似乎都以 为中心`HttpClient`，但我似乎无法弄清楚如何正确使用它。

这是我到目前为止所拥有的：

```
public ContentResult Proxy()
{
    // Grab the path from /api/*
    var path = Request.RawUrl.ToString().Substring(4);
    var target = new UriBuilder("http", "exampleapi.com", 25001);
    var method = Request.HttpMethod;

    var client = new HttpClient();
    client.BaseAddress = target.Uri;

    // Needs to get filled with response.
    string content;

    HttpResponseMessage response;
    switch (method)
    {
        case "POST":
        case "PUT":
            StreamReader reader = new StreamReader(Request.InputStream);
            var jsonInput = reader.ReadToEnd();

            // Totally lost here.
            client.PostAsync(path, jsonInput);

            break;
        case "DELETE":
            client.DeleteAsync(path);
            break;
        case "GET":
        default:
            // need to capture client data
            client.GetAsync(path);
            break;
    }

    return Content(content, "application/json");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:17:15.650

您需要创建一个 HTTP 服务器，接收请求，然后您的代码将从该请求中提取信息，并向新服务器生成一个新请求，接收响应，然后将响应发送回原始客户端.

客户端 -> C# 服务器 -> Rest API 服务器

这是一个开源的示例 HTTP 服务器。 [https://github.com/kayakhttp/kayak](https://github.com/kayakhttp/kayak)

# hadoop - 为什么第一组 Mappers 完成后 Map Jobs 会变慢？

> ID：13260952
> 
> 赞同：1
> 
> 时间：2012-11-06T23:14:12.540
> 
> 标签：hadoop, mapreduce, elastic-map-reduce, emr

假设我有 100 个映射器并行运行，总共有 500 个映射器在运行。

每个映射器接收的输入大小几乎相同，每个映射器应该花费的处理时间应该或多或少相同。

但是假设前 100 个映射器在 20 分钟内完成，接下来的 100 个映射器大约需要 25-30 分钟，下一批 100 个映射器每个大约需要 40-50 分钟。然后我们得到 GC 开销错误。

为什么会这样？

我已经设置了以下配置：

```
 <property><name>mapred.child.java.opts</name><value>-Xmx4096m</value></property>
  <property><name>mapred.job.reuse.jvm.num.tasks</name><value>1</value></property> 
```

这里还能做什么？

# python - 如何在 Python 中的每一行上显示我的列表，其中包含 n 个数量

> ID：13260957
> 
> 赞同：1
> 
> 时间：2012-11-06T23:15:00.950
> 
> 标签：python

我试图在每行上显示我的列表，每行有 7 个状态，这是我到目前为止所拥有的，但它显示为所有状态的一个长字符串，每个状态都带有引号。我忘了说这是给我的 CS 课的，我们还没有学过 iter，所以我们不允许使用它。给我的唯一提示是将 STATE_LIST 转换为字符串，然后使用 '\n' 将其分解

```
state = str(STATE_LIST)

displaystates = Text(Point(WINDOW_WIDTH/2, WINDOW_HEIGHT/2), state.split('\n'))
displaystates.draw(win) 
```

STATE_LIST 看起来像这样

```
STATE_VOTES = {
"AL" : 9, # Alabama
"AK" : 3, # Alaska
"AZ" : 11, # Arizona
"AR" : 6, # Arkansas
"CA" : 55, # California
"CO" : 9, # Colorado
"CT" : 7, # Connecticut
"DE" : 3, # Delaware
"DC" : 3, # Washington DC
"FL" : 29, # Florida
"GA" : 16, # Georgia
"HI" : 4, # Hawaii
"ID" : 4, # Idaho
"IL" : 20, # Illinois
"IN" : 11, # Indiana
"IA" : 6, # Iowa
"KS" : 6, # Kansas
"KY" : 8, # Kentucky
"LA" : 8, # Louisiana
"ME" : 4, # Maine
"MD" : 10, # Maryland
"MA" : 11, # Massachusetts
"MI" : 16, # Michigan
"MN" : 10, # Minnesota
"MS" : 6, # Mississippi
"MO" : 10, # Missouri
"MT" : 3, # Montana
"NE" : 5, # Nebraska
"NV" : 6, # Nevada
"NH" : 4, # New Hampshire
"NJ" : 14, # New Jersey
"NM" : 5, # New Mexico
"NY" : 29, # New York
"NC" : 15, # North Carolina
"ND" : 3, # North Dakota
"OH" : 18, # Ohio
"OK" : 7, # Oklahoma
"OR" : 7, # Oregon
"PA" : 20, # Pennsylvania
"RI" : 4, # Rhode Island
"SC" : 9, # South Carolina
"SD" : 3, # South Dakota
"TN" : 11, # Tennessee
"TX" : 38, # Texas
"UT" : 6, # Utah
"VT" : 3, # Vermont
"VA" : 13, # Virginia
"WA" : 12, # Washington
"WV" : 5, # West Virginia
"WI" : 10, # Wisconsin
"WY" : 3 # Wyoming
}

STATE_LIST = sorted(list(STATE_VOTES.keys())) 
```

我试图让它看起来像这样 ![样本](../Images/fd7ce3386c70d9d4f1427dccde3308f7.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:25:51.327

像这样的东西怎么样：

```
STATE_LIST = sorted(STATE_VOTES)

def my_iter(iterable):
    for item in iterable:
        yield item

from itertools import izip_longest

s = ',\n'.join(', '.join(state for state in group if state) for
                        group in izip_longest(*[my_iter(STATE_LIST)]*7))

print s 
```

输出：

```
AK, AL, AR, AZ, CA, CO, CT,
DC, DE, FL, GA, HI, IA, ID,
IL, IN, KS, KY, LA, MA, MD,
ME, MI, MN, MO, MS, MT, NC,
ND, NE, NH, NJ, NM, NV, NY,
OH, OK, OR, PA, RI, SC, SD,
TN, TX, UT, VA, VT, WA, WI,
WV, WY 
```

该示例使用`izip_longest()`来自`itertools`模块。如果由于某种原因您不允许使用该标准库，那么[文档](http://docs.python.org/2/library/itertools.html?highlight=izip_longest#itertools.izip_longest)中有相应的源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:35:32.867

有了这条线：

```
state = str(STATE_LIST) 
```

您只是将列表转换为字符串，接受 Python 选择使用的任何格式。在这种情况下，字符串表示将只是

```
["AL", "AK", ..., "WY"] 
```

根本没有换行符。只是一个看起来像列表的长字符串。

您真正想要的字符串似乎是这个：

```
AL AK AR AZ CO CT DC DE FL
GA HI ...
              ... WI WV WY 
```

（您似乎在每行上放了 9 或 10 个项目；不确定这将如何在 5 行中工作，列出 51 个项目，但让我们让它灵活一些）

假设你想把它分成五行。你可以这样做：

```
# Start with an empty list
state_lines = []

# Calculate the maximum number of items in each row
items_per_row = (len(STATE_LIST)+4)/5 # If you wanted, you could just say "11" here.

 # First item will be 0, 11, 22, etc.
 for first_item in range(0, len(STATE_LIST), items_per_row):

    # This contains all of the states for this line. For example,
    # ["AL", "AK", "AR", "AZ", "CO", "CT", "DC", "DE", FL", "GA", "HI"]
    states = STATE_LIST[first_item : first_item + items_per_row]

    # state_line will be a string of states separated by spaces,
    # like "AL AK AR AZ CO CT DC DE FL GA HI"
    state_line = ' '.join(states)

    # Add the new state line to the list
    state_lines.append(state_line)

# Finally, join the lines together with newlines in between them
state = '\n'.join(state_lines) 
```

然后，您的`state`变量将包含其余代码所需的字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T11:18:47.870

你为什么不尝试这样简单的事情：

```
>>> counter = 1
>>> for i in STATE_LIST:
...    sys.stdout.write(i+' ')
...    if not counter % 7:
...        print '\n'
...    counter += 1
... 
AK AL AR AZ CA CO CT 

DC DE FL GA HI IA ID 

IL IN KS KY LA MA MD 

ME MI MN MO MS MT NC 

ND NE NH NJ NM NV NY 

OH OK OR PA RI SC SD 

TN TX UT VA VT WA WI 

WV WY 
```

# jquery-selectors - 使用 jquery .on 选择选项时的 mousedown 事件

> ID：13260958
> 
> 赞同：1
> 
> 时间：2012-11-06T23:15:59.250
> 
> 标签：jquery-selectors, jquery, jquery-on, html-select

我正在阅读[jQuery 的 .on 事件处理程序的文档](http://api.jquery.com/on/)并开始使用它。

我有一个简单的 <select> 元素，其中 multiple 属性设置为 true。但是，我希望用户能够选择多个项目而不必按 ctrl 或 shift 键

根据 .on 文档，如果您指定一个选择器，它将自动将这些事件处理程序添加到该容器内添加的与指定选择器匹配的任何新项目中。

因此，就我而言，例如，我可以决定替换列表框中可用的 <option> 元素，但我仍然希望这些选项具有相同的功能，而不必重新绑定这些事件等。

有人可能会认为以下代码段应该可以解决问题（至少，我做到了）：

```
$('#dropdownlist').on('mousedown', 'option', function(e){
    e.preventDefault();
    $(this).prop('selected', $(this).prop('selected') ? false : true);
    return false;
}); 
```

因此，当用户单击该列表框中的选项时，默认操作将被取消，并且根据该项目是否已被选中，它将反转该选择。

我创建了一个小小提琴来展示这种行为：[小提琴](http://jsfiddle.net/dschuermans/pEmpG/)

在那个小提琴中，第一个下拉列表的行为符合预期，但是在替换项目时功能会丢失。这仅适用于 FF 和 Chrome。

第二个下拉列表是我认为它应该是的（事件处理明智），但除了在 Chrome 中之外，这似乎不起作用-.- 替换项目时保留该功能，因为控制台仍然会记录“2”替换它们后单击一个项目。

有人可以解释一下为什么会这样吗？难道我做错了什么？请指出我正确的方向！

谢谢！

~ 德克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T23:02:22.033

IE 不尊重选项标签本身的 mousedown 事件。您必须使用选择标签的 OnChange 事件，这不是您（也不是我）想要的。我正试图做和你完全相同的事情，但每次尝试都被阻止了。我终于放弃了，并将其列为复选框列表，因为我可以从我的行为中得到与你在这里尝试做的相同的行为。

你可以看到[这个问题](https://stackoverflow.com/questions/10480695/detecting-interaction-with-select-box)的一些选项，但我从来没有让它按照你描述的方式工作。

# html - 如何使用 DIV UL LI 制作 CSS 表格

> ID：13260959
> 
> 赞同：0
> 
> 时间：2012-11-06T23:16:04.253
> 
> 标签：html, css, html-lists, css-tables

想象一下，我有 DIV 容器，`<ul>`里面有 9 个标签（它们是列），每个`<ul>`标签里面有 5 个`<li>`标签，每个`<li>`标签里面有一个链接。

我想让它成为一个纯 CSS 类型的表格，其中所有`<ul>`宽度都不需要设置硬宽度，而是相对于`<li>`标签中链接的长度和其他`<ul>`标签的变化和自动拉伸，所以一些列将是更宽，如果它们中的链接长或短，有些会更短。

你能帮我解决这个问题吗？我试图做到这一点，除了自动拉伸`<ul>`标签外，一切正常，它们有固定的宽度:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:48:04.747

嘿，我有一个解决方案，我可以从这里知道你需要什么......

[http://jsfiddle.net/YPmtG/4/](http://jsfiddle.net/YPmtG/4/)

我基本上只是漂浮 ul 的，而 li 的自然托管在 ul 内，因此它们可以单独漂浮在里面，如我的小提琴所示......

```
ul {
    float:left;
    clear:right;
    padding:5px;
}
li {
    float:left;
    clear:left;
} 
```

# c# - 网络编程：在 TCP 客户端服务器中接收动态图像对象中的图像文件

> ID：13260960
> 
> 赞同：0
> 
> 时间：2012-11-06T23:16:10.240
> 
> 标签：c#, networking, tcp, network-programming

嗯使用此代码将接收到的图像存储在硬盘内存中
我尝试编辑此代码以将接收到的图像文件存储在动态图像对象中，而不存储在硬盘内存中

```
 private void StartReceiving()
    {
        try
        {
              string hstServer = Dns.GetHostName();
             IPAddress ipaLocal ="127.0.0.1";

            if (tlsServer == null)
            {
                tlsServer = new TcpListener(ipaLocal, Convert.ToInt32(txtPort.Text));
            } 
            tlsServer.Start(); 
            TcpClient tclServer = tlsServer.AcceptTcpClient(); 
            strRemote = tclServer.GetStream(); 
            int bytesSize = 0;
            byte[] downBuffer = new byte[2048];
            bytesSize = strRemote.Read(downBuffer, 0, 2048);
           FileName = System.Text.Encoding.ASCII.GetString(downBuffer, 0, bytesSize);
           try
           {
               strLocal = new FileStream(FileName, FileMode.Create, FileAccess.Write, FileShare.ReadWrite);
           }catch(Exception exp)
           {
               strLocal = new FileStream(FileName.Substring(0,5), FileMode.Create, FileAccess.Write, FileShare.ReadWrite);
           }
            downBuffer = new byte[2048];

            bytesSize = strRemote.Read(downBuffer, 0, 2048);

            downBuffer = new byte[2048];

            while ((bytesSize = strRemote.Read(downBuffer, 0, downBuffer.Length)) > 0)
            {
                strLocal.Write(downBuffer, 0, bytesSize);
            }

        }
        finally
        {
            strLocal.Close();
            strRemote.Close();

        }
    } 
```

在 .net 4 中使用 CopyTo 进行编辑

```
 tlsServer.Start(); 
            TcpClient tclServer = tlsServer.AcceptTcpClient();
           tclServer.GetStream().CopyTo(ms);

            //Get the image out of the stream
            Image img = Image.FromStream(ms);

        }
        finally
        {
            m = Image.FromStream(strLocal);
            strLocal.Close();
            strRemote.Close();

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:35:58.343

根据[此处](https://stackoverflow.com/questions/7529642/how-to-write-the-stream-to-memory-stream)的详细信息：

```
MemoryStream ms = new MemoryStream();
//This call will block until the client disconnects though
tclServer.GetStream().CopyTo(ms);

//Get the image out of the stream
Image img = Image.FromStream(ms); 
```

# media-queries - CSS Media Query iPhone 有一个 Margin 任何人都知道如何清除所以网站有 100% 的宽度？

> ID：13260961
> 
> 赞同：1
> 
> 时间：2012-11-06T23:16:13.767
> 
> 标签：media-queries

嗨，我正在建立一个带有媒体查询的响应式网站，但我在使用智能手机时遇到了问题。预览时，左右两边似乎有一个 30 像素的边框。我尝试将所有边距和填充设置为 0px 和 0%，但它不会消失。请在此处查看屏幕截图

[http://optimise-website-marketing.com/wp-content/themes/bones/images/photo.PNG](http://optimise-website-marketing.com/wp-content/themes/bones/images/photo.PNG)

继承人的网站：

[http://optimise-website-marketing.com/](http://optimise-website-marketing.com/)

我使用以下媒体查询：

/* iPhone [纵向 + 横向] */ @media only screen and (min-device-width : 320px) and (max-device-width : 480px) {

非常感谢任何帮助:-)

我等了这么多时间把我的头发拉出来，请有人能解释一下发生了什么吗？

马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T13:38:53.523

第 1083 行是问题所在：

```
.page {
    padding: 0 20px;
} /* general article on a page style */ 
```

# c# - Cast to Int from a VB Collection

> ID：13260964
> 
> 赞同：-1
> 
> 时间：2012-11-06T23:17:02.800
> 
> 标签：c#, casting

Do you see wrong code in here? I am getting a InvalidCaseException on the foreach loop that is using an INT variable:

```
 Microsoft.VisualBasic.Collection oHeaders = GetFieldIdsByName(msREPORT_HEADER);

foreach (int FieldId in oHeaders) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:20:23.150

```
foreach (object FieldId in oHeaders)
{
    int value = Int32.Parse(FieldId.ToString());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T23:32:28.000

```
foreach (int i in oHeaders.Cast<int>())
{
     //TODO: your action here.
} 
```

# xcode - 来自 App Store 的 Xcode 中的 Icon Composer

> ID：13260966
> 
> 赞同：0
> 
> 时间：2012-11-06T23:17:04.937
> 
> 标签：xcode, icons, xcode4.5

我从应用商店下载了 xcode (4.5) 并试图找到图标作曲家。当我浏览了 /Applications/Xcode 中的所有子目录并且找不到任何东西时。我看过：

```
/Applications/Xcode.app/Contents/Applications/ 
```

我所看到的是：

```
Accessibility Inspector.app 
FileMerge.app
Printer Simulator.app
Application Loader.app
Instruments.app
iPhone Simulator.app 
```

我去了 xcode->在 gui 中打开开发人员工具，但什么也没看到。我什至在我的机器上构建了定位数据库并尝试搜索它......什么都没有。有任何想法吗？谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T01:01:54.410

Icon Composer 已被弃用，因为它无法处理 Mac Retina 分辨率所需的 1024x1024 图标。相反，他们建议使用[官方文档](https://developer.apple.com/library/mac/#documentation/GraphicsAnimation/Conceptual/HighResolutionOSX/Optimizing/Optimizing.html#//apple_ref/doc/uid/TP40012302-CH7-SW2)中的图标集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T01:09:51.283

“Icon Composer”位于“图形工具”中，可以从 ADC 网站单独下载（与所有其他“工具”一样，如“硬件 IO 工具”、“Dashcode”、“音频工具”等。

# bash - 防止 bash 别名在 shell 启动时评估语句

> ID：13260969
> 
> 赞同：34
> 
> 时间：2012-11-06T23:17:15.937
> 
> 标签：bash, alias

假设我有以下别名。

```
alias pwd_alias='echo `pwd`' 
```

此别名不是“动态的”。`pwd`它会在 shell 启动后立即进行评估。反正有没有延迟对滴答声中的表达式的评估，直到别名的运行时？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-11-06T23:43:27.153

你真正想要的是一个函数，而不是别名。

```
pwd_alias() {
   echo "$PWD"
} 
```

别名只不过是替换文本而已。任何具有复杂性的东西都需要一个函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T07:28:42.123

正如 jordanm 所说，别名只不过是替换文本而已。
如果您希望 echo 的参数是由 bash 扩展的 pwd 的输出，那么我不明白您的问题。
如果您希望 echo 的参数是 `pwd` 并保留反引号，这确实是可能的，例如：

```
alias a="echo '\`pwd\`'" 
```

所以，如果不是 echo 你有一些东西在它自己的运行时做反引号扩展，也许这就是你想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T23:27:03.560

我不相信您可以更改在 shell 启动时发生的评估。由于创建别名的过程是在 shell 启动时运行的，因此`pwd`会对其进行评估。您可以简单地将别名更改为仅在没有反引号的情况下`pwd`作为`pwd`输出运行而无需回显。解决此问题的一种简单方法是，如果您不希望更改为使用别名，则在路径中从使用别名更改为 shell 脚本。

```
#!/bin/bash
pwd 
```

# ios - XCode 4.5 应用程序在 iOS 4.3 设备上崩溃

> ID：13260971
> 
> 赞同：0
> 
> 时间：2012-11-06T23:17:25.390
> 
> 标签：ios, xcode, ios-simulator

我使用旧 xcode 版本的 iOS 4.3 模拟器并将其安装到我当前的 xcode 4.5 以运行使用 iOS SDK 6.0 开发的应用程序。它崩溃了，所以我从 xcode 4.5 中的首选项更新了 iOS 4.3 模拟器，然后它运行得很好。

我想我会要求用户这样做，但有什么办法可以避免这种情况吗？

# url - sed 在第二遍返回空行

> ID：13260973
> 
> 赞同：0
> 
> 时间：2012-11-06T23:17:40.983
> 
> 标签：url, variables, sed, substitution

我有一个正在编辑的配置文件，并且在第一次通过时已正确更改，但在接下来的两行中，sed 返回空白行。

要编辑的行是

```
word.word.word.database=dbase
word.word.word.username=someone
word.word.word.password=someone 
```

我正在使用的 sed 命令是

```
cat config.file | \sed -e "s/database/$dbname/" > config.file.1

cat config.file.1 | \sed -e "s/username/$dbuser/" > config.file.2

cat config.file.2 | \sed -e "s/database/$password/" > config.file.3

 cp config.file.3 config.file 
```

最终结果是

```
word.word.word.database=dbname
word.word.word.username=
word.word.word.password= 
```

无法弄清楚这是怎么回事。任何帮助都会很棒。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:32:58.930

`$dbname`,`$dbuser`并且`$password`开始被视为 shell 变量，因此是领先的美元符号。如果您尝试合并 shell 变量，请尝试：

```
 sed -i -e "s/database/$dbname/" -e "s/username/$dbuser/" -e "s/password/$password/" config.file 
```

请注意，我已将`-i`标志添加到上述命令中。它可以使用`GNU sed`. 其他类型`sed`需要设置扩展名，例如：`-i.bak`这会创建一个备份文件；在你的情况下，这将是：`config.bak`。

如果您只是想获得完整的结果列表，请删除美元符号或使用单引号。例如：

```
sed -i -e "s/database/dbname/" -e "s/username/dbuser/" -e "s/password/password/" config.file 
```

或者

```
sed -i -e 's/database/$dbname/' -e 's/username/$dbuser/' -e 's/password/$password/' config.file 
```

***编辑1：***

如果我完全误解了你的问题，试试这个：

```
sed -i -e "s/\(.*database=\).*/\1dbname/" -e "s/\(.*username=\).*/\1dbuser/" -e "s/\(.*password=\).*/\1password/" config.file 
```

结果：

```
word.word.word.database=dbname
word.word.word.username=dbuser
word.word.word.password=password 
```

***编辑2：***

如果您有标记为 的 shell 变量`$dbname`，`$dbuser`并且`$password`：

```
sed -i -e "s/\(.*database=\).*/\1$dbname/" -e "s/\(.*username=\).*/\1$dbuser/" -e "s/\(.*password=\).*/\1$password/" config.file 
```

# linux - 如何检查进程是否在linux中运行

> ID：13260974
> 
> 赞同：11
> 
> 时间：2012-11-06T23:17:45.947
> 
> 标签：linux, bash

我正在尝试自动检查进程是否正在运行，并且必须相应地执行后续步骤。我写了一个 bash 脚本，但它似乎不起作用。

```
if ps aux | grep [M]yProcessName > /dev/null
then
  echo "Running"
else
  echo "Not running"
fi 
```

我的`if`陈述是否被错误地使用了？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-07T06:51:58.037

您不想知道特定进程（已知 pid）是否正在运行（这可以通过测试`/proc/1234/`pid 1234 是否存在来完成），但是否某个进程正在运行给定命令（或给定可执行文件）。

请注意，[kill(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/kill.2.html)系统调用可移植地用于检查给定进程是否正在运行（使用 0 信号，例如`kill(pid,0)`）。从程序内部，这是检查已知 pid 的进程是否仍然存在并运行（或等待）的常用方法。

您可以使用该`pidof`命令查找运行某些可执行文件的进程，例如`pidof zsh`查找所有`zsh`进程。你也可以使用`killall -s 0 zsh`

您可能会对`pgrep`实用程序和`/proc`文件系统感兴趣。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-04T14:15:50.413

```
ps aux | grep [M]yProcessName | grep -v grep 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-14T15:46:06.847

有一个解决方案：

```
if [ "$(ps aux | grep "what you need" | awk '{print $11}')" == "grep" ]; then ... elif [ ... ]; then ... else ... fi 
```

这在 Debian 6 中运行良好。需要“{print $11}”，因为系统也将 grep 视为一个进程

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-10T07:43:25.697

```
processid =$(ps aux | grep 'ProcessName' | grep -v grep| awk '{print $2}') 
```

上面的命令将为您提供进程 ID。将该进程 ID 分配给一个变量并执行此操作 -->

```
if cat /proc/$processid/status | grep "State:  R (running)" > /dev/null
then
  echo "Running"
else
  echo "Not running"
fi 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-06T23:36:33.323

使用 -z 检查字符串是否为空，这样的事情可能会起作用：

```
line=$(ps aux | grep [M]yProcessName)
if [ -z "$line" ]
then
    echo "Not Running"
else
    echo $line > /dev/null
    echo "Rinnung"
fi 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-05-06T19:22:24.823

```
SMBD=$(pidof smbd)
if [ "$SMBD" == "" ];
then
   /etc/init.d/samba start;
else
   /etc/init.d/samba restart;
fi 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-07T13:16:17.800

在我的系统上，`ps aux | grep ProcessName`总是得到一行 grep 进程，例如：

```
edw4rd     9653  0.0  0.0   4388   832 pts/1    S+   21:09   0:00 grep --color=auto ProcessName 
```

因此，退出状态始终为 0。也许这就是您的脚本不起作用的原因。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-09-09T06:55:21.500

return 0 表示成功，其他则失败

```
kill -0 `pid`; echo $? 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-02T16:00:33.063

只是明确提到[这个答案](https://stackoverflow.com/a/13264571)所暗示的一种方式，`pgrep`是通过进程名称执行此操作的最佳方式：

```
pgrep [M]yProcessName 
```

如果名称与“[M]yProcessName”匹配的进程正在运行，`pgrep`则将其 PID 打印到 stdout 并以 code 退出`0`。否则，它将不打印任何内容并以 code 退出`1`。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-11-07T01:35:45.277

试试这个

```
ps aux | grep [M]yProcessName | grep -v grep 
```

# android - Android - 在主活动 UI 线程中运行长代码时显示进度

> ID：13260976
> 
> 赞同：-8
> 
> 时间：2012-11-06T23:18:04.307
> 
> 标签：android, progress, redraw

我已经看到这个问题被问了很多次，但没有办法做到这一点。我在主 UI 线程中有更多不同的代码部分（有时需要超过 10 秒），并希望向用户显示一些进度。我不会重做所有代码来尝试在单独的线程中移动所有不同部分的代码（已经是一个非常复杂的应用程序），同时也会冻结需要在继续之前执行代码的主线程，所以不要建议使用 Thread/Handler/AsyncTask因为他们不会这样做。

我尝试过的一件事是从我正在使用的自定义视图的 onDraw 中存储 Canvas 指针，并在运行长代码时在其中绘制一些东西，但视图仅在代码完成执行后才会刷新。执行代码时有什么方法可以强制视图重绘？

向用户显示消息/进度的另一种方法是在上方打开一个单独的活动，该活动不会全屏显示，因此您仍然可以看到应用程序的后面部分，就像您长按主页按钮和最近的应用程序弹出窗口时一样出现。我该如何做到这一点以及如何在两个活动之间进行通信？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:24:17.467

对不起，你不能那样做。

Main Thread 仅用于操作 UI，而不用于长时间操作...... **它`progress`也会冻结，因为它是 UI Thread 的一部分**。查看 Google 指南，如果您真的想这样做，请查看`ProgressDialog`.

# macos - Subversion：工作副本是旧的开发版本

> ID：13260980
> 
> 赞同：8
> 
> 时间：2012-11-06T23:18:17.693
> 
> 标签：macos, svn, cornerstone

我正在 OSX 上开发，我的 Subversion 工作副本之一刚刚开始为所有命令返回以下错误，但是我的其他检查工作正常。我的 Brew 安装的 SVN 二进制文件和 Cornerstone 客户端都收到了相同的消息，但其他工作目录都很好。

```
> svn update
svn: E155036: Please see the 'svn upgrade' command
svn: E155036: Working copy '/working_directory' is an old development version (format 12); to upgrade it, use a format 18 client, then use 'tools/dev/wc-ng/bump-to-19.py', then use the current client
> svn upgrade
svn: E155019: Can't upgrade '/working_directory' as it is not a pre-1.7 working copy directory
svn: E150000: Missing default entry 
```

我的计算机上的任何地方都没有`bump-to-19.py`脚本（根据`find / -type f -name bump-to-19.py`），但是我认为我能够在[Apache 存储库](http://svn.apache.org/repos/asf/subversion/trunk/tools/dev/wc-ng/bump-to-19.py)中找到它。也就是说，我不熟悉它的作用或如何使用它。理想情况下，我可以避免签出此工作目录的新版本并手动合并我的所有（许多）更改。

我能找到的唯一信息与[Netbeans](http://netbeans.org/projects/versioncontrol/pages/Subversion1_7)和相关`javahl`，我都没有使用。

**编辑**：下载`bump-to-19.py`文件并使其可执行后，我对我的工作目录进行了尝试，但无济于事：

```
> ./bump-to-19.py working_directory/
error: format is 29 not 18: 'working_directory/' 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-07T01:10:15.417

虽然我无法弄清楚我的工作目录损坏的原因，但我可以使用`rsync`- 有一个选项来解决它`C`，它会在进行备份时忽略 CVS/SVN 文件和目录。我使用此选项进行了备份，再次签出项目，然后将备份复制回新的工作目录。SVN又高兴了。

```
> rsync -arC working_directory working_directory_no_svn
> rm -rf working_directory
> svn co https://svn.example.com/project/trunk working_directory
> rsync -ar working_directory_no_svn working_directory 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-05-08T13:40:18.880

我遇到了同样的问题，这是我的解决方法：

1.  删除顶层的 .svn 文件夹 (rm -rf .svn)
2.  再次从 SVN 结帐软件（svn co ...）
3.  好走！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-09-03T15:50:31.560

我知道这已经有一段时间了，但我找到了一个使用 SVN 给出的提示的解决方案......基本上使用升级命令，因为它说明。使用 CMD，我转到了有问题的项目所在的工作区文件夹。让我们将项目称为 Project1。你调用命令：

“svn升级项目1”

这以正确的方式解决了我的问题，而不涉及某种黑客或解决方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-13T12:10:42.847

我有一个类似的问题，我的 svn 版本是 1.7.10，但是我的 Eclipse 的 Subversion 插件稍旧，我假设是 1.6.something。

使用“rsync -arC working_directory archive_no_svn”命令是一个突破——至少现在我有一份我刚刚完成的同步时间的副本。

我尝试使用“svn co”，但它是错误的版本，所以我只是使用 Eclipse 中的 Subversion 插件运行更新 - 这从存储库中恢复了工作目录 - 几乎是我所追求的，它是正确的版本.

让 rsync 回到正确的位置是一个技巧。rsync 似乎将工作文件夹放入存档位置，创建archive_location/working_directory/the-files。因此，将归档数据同步回 working_directory 是通过以下方式实现的： rsync -ar archive_no_svn/working_directory 。

现在我必须了解如何将我的 Eclipse Subversion 插件升级到 1.7

# javascript - 当对象在数组中时访问对象属性（javascript）

> ID：13260983
> 
> 赞同：2
> 
> 时间：2012-11-06T23:18:27.240
> 
> 标签：javascript

我试图创建一个对象数组，然后访问数组中的对象属性，但它返回未定义。我调用 createObjArray() 函数，并在我执行 console.log(objArray[1]); 之后立即调用 它打印出具有所有属性的对象就好了。但是，如果我尝试执行 console.log(objArray[1].name); 萤火虫打印“未定义”。此外，在 firebug 中单步执行我的代码时，我可以将鼠标悬停在 objArray[1].name 上，它会显示正确的名称。这里发生的事情，让我抓狂。

```
var objArray = [];

function createObjectArray(numOfObjs) {

    for(var i=0; i<numOfObjs; i++) {

packages.push(initObj(i)); 

    }
 }

function initObj(i){
    var newPackage;
    var p = {};
    $.getJSON('.../package' + i + '.json', function(data) {
        newPackage = new Package(data);
        p.name = newPackage.name;
        p.id = i;      
    });
    return p;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:33:06.733

这将起作用：

```
var objArray = [];

function createObjectArray(numOfObjs, callback) {
    var filledPackage = [];
    var nbLeft = numOfObjs;
    for(var i=0; i<numOfObjs; i++) {
        initObj(i, function(p){
            filledPackage.push(p);
            nbLeft--;
            if (nbLeft === 0){
                callback(filledPackage);
            }
        }); 
    }
 }

function initObj(i, callback){
    var newPackage;
    var p = {};
    $.getJSON('.../package' + i + '.json', function(data) {
        newPackage = new Package(data);
        p.name = newPackage.name;
        p.id = i;     
        callback(p);
    });
}

//Get a filled object array:
createObjectArray(5, function(filledArray){
    objArray = filledArray;
    //Code here will be executed AFTER all the $.getJSON queries have returned.
    //objArray is not empty.
});
//Code here will be executed WHILE the getJSON queries are running and
//while objArray is still empty. Due to the way the JS event loop works,
//it is impossible that code placed here will be able to use the content
//of objArray unless you call an async function such as anything AJAX or
//setTimeout, but that's iffy. Code you want to be executed once objArray
//has been filled should be inside of the callback above. 
```

问题是 $.getJSON 是异步的，这意味着它不会自动返回结果。相反，你给它一个回调。回调是在收到结果后执行的函数。在这种情况下，回调是调用 $.getJSON 时创建的匿名函数。该回调从服务器接收结果，将其添加到数组中，然后检查数组是否已填充。由于 $.getJSON 函数我们正在执行异步代码，因此我们也必须异步返回结果。为此，我们要求 initObj 函数接收一个在完成后调用的函数（另一个回调）。我们调用该回调并将参数传递给它。然后我们再次通过回调返回填充的数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:31:54.103

您对 $.getJSON 的调用是异步的。当 initObj() 返回 p 它仍然是一个空对象。

但是 initObj() 创建了一个闭包，该闭包捕获对 p 的引用，因此当 $.getJSON 返回时 p 被填充。

这就是为什么在填充数组后立即运行的代码中对象看起来为空的原因。但是，当您运行控制台命令时，异步调用已返回并且对象已被填充。

在继续处理阵列之前，您需要等待所有异步调用返回。一种方法是在您进行调用时增加一个计数器，并在调用返回时减少它，然后当最终调用返回时，计数器将降至零并继续处理。

或者，您可以设置一个 setTimout 循环，以便在填充所有项目时继续轮询数组检查。

如果您认为其中一个调用可能失败，这两种方法都是有风险的，但这种方法本身具有根本风险，因为您要进行多个 ajax 调用，因此您必须处理多个可能的故障。一次抓取所有数据会更干净，这样您就可以在 jQuery.ajax 的成功/错误处理程序中处理成功/错误状态一次。

# azure-connect - Azure Connect 和 Azure 虚拟网络之间的区别？

> ID：13260985
> 
> 赞同：1
> 
> 时间：2012-11-06T23:18:56.560
> 
> 标签：azure-connect, azure-virtual-network

**Azure Connect**是旧版 Azure.com 门户上的一项服务，允许在本地和云服务器/角色/资源之间建立连接。它创建了一个虚拟 IP（覆盖）网络——几乎是一个 VPN。

**Azure 虚拟网络**（可在新的 Azure 门户上找到）也被吹捧为 VPN 解决方案，其目的也相同，但配置似乎很扭曲（尽管具有漂亮的 UI）。

我很困惑这两种产品如何相互叠加。谷歌搜索和搜索 MSDN 也没有透露太多信息。

它们与目标用例有什么区别？他们是否有望在未来合并成一个产品？

我们的用例是作为云服务运行的 WebRole，其 REST/Web API 服务由专用网络上的机器使用。Azure Connect 或 Azure 虚拟网络将（应该？）提供它们之间的底层连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:52:22.027

Azure Connect 允许用户以超级简单快捷的方式将 Azure 应用程序与本地服务器连接起来。它不需要 VPN 设备，不需要用户具备网络知识，不需要/假设用户可以访问网络基础设施（例如，能够在公司的边缘防火墙上配置防火墙）。您在管理门户中表达您的连接意图（例如，Azure 服务 x 应该连接到一组机器（机器组）y 本地），Azure Connect 会为您完成其余的工作。它也非常灵活，您可以随时通过门户更改网络和连接策略，而无需重新部署您的应用程序或在本地进行任何更改。例如，一旦在门户中进行了更改，您就可以使 Azure 服务 x 连接到本地机器组 z 而不是 y，其余的会自动发生，y 中的机器无法长时间访问/从 Azure 访问。Azure Connect 使用终结点软件来管理用户的所有网络连接，因此您必须安装终结点软件。但它支持许多不同的自动部署选项，包括使用 Microsoft Update。

Azure 虚拟网络允许用户通过标准的站点到站点 IPSEC 连接将部分本地基础架构扩展到您的 Azure 虚拟网络。您必须在本地拥有面向 Internet 的 VPN 设备。该解决方案还假设您具备网络知识 - 您将被要求指定将在 Azure 和本地端使用的网络地址范围，您必须在 Azure 端启动 VPN 网关并管理 IPSEC 连接。它不需要在服务器上安装端点软件，您负责设置路由以将流量从 VPN 设备路由到服务器，反之亦然。

两种技术相辅相成，适用于不同的场景。

# python - 哪个 javascript 库更适合动态实时小部件/仪表板？

> ID：13260986
> 
> 赞同：2
> 
> 时间：2012-11-06T23:19:00.997
> 
> 标签：python, backbone.js, socket.io, dashboard

我将在 html5 中构建一个供内部使用的仪表板。我正在为客户端刷新实时/动态小部件（图形、状态等）使用什么库而苦苦挣扎，如下面的屏幕截图：

![示例创意](../Images/95328999b3d5bc02119280e4c46bef51.png)

这个想法是有一个后端服务器，它使用 Socket.IO 将数据推送到客户端。在仪表板中，可能每隔几秒钟就会更新几个小部件。小部件将由用户添加/删除。因此，该应用程序包含在一个页面中。

我没有使用这类库的经验，主要是使用 python/c# 的后端代码。我听说过[http://backbonejs.org/](http://backbonejs.org/)但想知道哪个库最适合我的用例：

我希望有一种方法可以将渲染与数据源分开，即：数据是“CPU 使用率”，并由两个小部件在同一时间渲染：折线图和速度计。

PD：这不是我的仪表板的实际设计，只是为了展示类似于我可以开发的*那种*用户界面（我还没有 gui）。原创设计属于[http://dribbble.com/shots/780188-Morning](http://dribbble.com/shots/780188-Morning)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:29:40.303

我不熟悉所有可用的 JavaScript 框架，但我知道骨干网肯定会满足您的要求。实际上，任何 MV* 框架都应该允许您同步更新多个视图以反映对单个模型的更改。

您可能会发现[这篇](http://blog.andyet.com/2011/feb/15/re-using-backbonejs-models-on-the-server-with-node/)关于在客户端和（节点）服务器之间共享模型的文章是支持骨干网的有力论据。

如果您认为将 HTML 元素直接绑定到模型数据的能力会很有用，那么[Knockout](http://knockoutjs.com/documentation/introduction.html)可能也值得考虑。

# php - PHP is_dir() 在 Windows 网络驱动器上返回 false

> ID：13260991
> 
> 赞同：7
> 
> 时间：2012-11-06T23:19:28.703
> 
> 标签：php, windows, networking, drive

我有一个映射到驱动器号 X:\ 的网络驱动器连接到路径为“\\X-Drive\Public\Data”的外部硬盘驱动器。

我将 Zend Server 与 Apache 一起使用。

我的 PHP 命令很简单

```
$isFolder = is_dir("x:/");
echo($isFolder); //FALSE 
```

你应该知道的事情：

编码：

```
$isFolder = is_dir("c:/");
echo($isFolder); //TRUE 
```

按预期工作。

我以管理员用户身份运行 Zend Apache 服务。我知道这工作正常，因为在任务管理器中 httpd.exe 进程显示正确的用户。

驱动器确实已映射。我尝试将它与多个用户进行映射，以包括 Zend Apache 使用的同一用户，但无济于事。

我已经阅读了我能找到的关于这个问题的每一篇文章。我遇到的每个问题都存在，要么是因为用户权限，要么是因为错字。我看不出我的问题是如何归入任一类别的。

我也试过：

```
system('net use X: "\\x-drive\public" password1 /user:username /persistent:no');
$isFolder(is_dir("x:/"));
echo($isFolder); //FALSE 
```

我正在运行 Windows Vista x64，生产代码将在 Windows 7 x64 中运行。

我还会遇到哪些其他问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-06T23:37:39.453

对于网络共享，您应该使用 UNC 名称： `"//server/share/dir/file.ext"` [Source](https://bugs.php.net/bug.php?id=45535)

如果您使用 IP 或主机名，它应该可以正常工作：

```
$isFolder = is_dir("\\\\NAS\\Main Disk");
var_dump($isFolder); //TRUE

$isFolder = is_dir("//NAS/Main Disk");
var_dump($isFolder); //TRUE

$isFolder = is_dir("N:/Main Disk");
var_dump($isFolder); //FALSE 
```

# objective-c - 如何正确分配/释放这个指针？目标-c

> ID：13260993
> 
> 赞同：0
> 
> 时间：2012-11-06T23:19:31.347
> 
> 标签：objective-c, ios, memory-management, dealloc

*初学iOS程序员，请耐心解释

假设我有 2 个课程 - Foo，Bar

在类 Bar 中，我有一个指向 Foo 实例的指针，它是我在初始化期间设置的。（而且因为我不知道如何正确地相互导入 Foo 和 Bar，我最终将类型设置为 id 而不是 Foo）

```
@implementation Bar{
    id pointerToInstanceOfFoo;
} 
```

我如何为 Bar 编写 dealloc 函数？还是我什至会覆盖 dealloc 函数？

现在我有

```
-(void)dealloc{
    pointerToInstanceOfFoo = NULL;
    [super dealloc];
} 
```

我仍然希望当 Bar 死时指向 Foo 的指针仍然存在，但我做对了吗？几个问题：

1.  如果 Foo 和 Bar 相互导入，我该怎么做？或者这是糟糕的软件设计？
2.  现在我在@implementation 中设置了指针“pointerToInstanceOfFoo”...这是否等同于在类 Bar 中声明一个私有指针？
3.  我应该改为使用 `@property (nonatomic, weak) id pointerToInstanceOfFoo` 吗？如果是这样，为什么我会不断收到关于 ARC 中没有弱指针的错误？
4.  我需要 `delete pointerToInstanceOfFoo;` 在 dealloc 函数中吗？

对不起，任何解释/答案将不胜感激！

PS我正在使用XCode 4.4并在带有cocos2d v2.1 beta的iOS 5.0上运行......我*认为*它正在使用arc

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T23:30:42.297

您不能`[super dealloc]`在 ARC 中使用。因此，如果编译成功，则说明您没有使用 ARC，您需要 cals`retain`和`release`. 写一个完整的教程不适合堆栈溢出答案。至于你的其他问题：

1）只需将它们导入实现文件，而不是头文件。

2) 是的

3）如果它让你快乐。该错误可能意味着您的目标是低于 iOS 5.0（即项目设置中的部署目标设置为小于 5.0），其中不支持弱指针，或者 ARC 已关闭。我认为您没有准确地报告错误消息，因为它没有任何意义。

4）“删除”不是有效的objective-c 或valid c。

PS 不，您不希望在 Bar 被释放后该指针仍然存在，因为那将是内存泄漏。也许您想要一个静态变量而不是实例变量？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T23:35:41.213

正如borrden 所提到的，保留/释放和objective-c 内存管理是一个相当大的主题，已经被广泛处理。我建议阅读[本文](http://interfacelab.com/objective-c-memory-management-for-lazy-people/)以开始并从那里进行更多研究。

虽然您可以（应该？）使用 ARC 并为自己省去一些麻烦，但了解常规的保留/发布周期将使您更好地了解 ARC 中的强/弱引用。虽然在使用 ARC 时您不必了解有关 Objective-c 中内存管理的所有内容，但您仍然需要了解其中的一些内容。

# c# - 如何获取页面元素的集合？

> ID：13260995
> 
> 赞同：0
> 
> 时间：2012-11-06T23:19:51.323
> 
> 标签：c#, asp.net, vb.net, visual-studio, webforms

在 Page_Init 上，我检查 Button1 是否被按下，如果是，我在面板中创建一系列 LiteralControl，称为 Panel1：

```
 Panel1.Controls.Add(new LiteralControl("<table>"));

   Panel1.Controls.Add(new LiteralControl("<tr>"));
   Panel1.Controls.Add(new LiteralControl("<td>Header 1</td>"));
   Panel1.Controls.Add(new LiteralControl("<td>Header 2</td>"));
   Panel1.Controls.Add(new LiteralControl("<td>Header 3</td>"));
   Panel1.Controls.Add(new LiteralControl("</tr>"));

   Panel1.Controls.Add(new LiteralControl("<tr>"));
   Panel1.Controls.Add(new LiteralControl("<td>Data 1</td>"));
   Panel1.Controls.Add(new LiteralControl("<td>Data 2</td>"));
   Panel1.Controls.Add(new LiteralControl("<td><input type=\"text\" name=\"txtCode3\"></td>"));                
   Panel1.Controls.Add(new LiteralControl("</tr>"));

   Panel1.Controls.Add(new LiteralControl("</table>")); 
```

我有第二个按钮，单击该按钮时，我想用所有表格单元格元素（或值）填充 NameValueCollection（或任何其他列表）。

我怎样才能做到这一点？我试过了：

```
protected void Button2_Click(object sender, EventArgs e)
    {
             NameValueCollection coll = Request.Form;
    } 
```

但这只会给我：

```
AllKeys:
    [0] "_VIEWSTATE"
    [1] "_EVENTVALIDATION"
    [2] "Button2"
    [3] "txtCode3" 
```

如您所见，我无法获取所有单元格元素。我应该得到：

```
AllKeys:
    [0] "_VIEWSTATE"
    [1] "_EVENTVALIDATION"
    [2] "Button2"
    [3] Header 1
    [4] Header 2
    [5] Header 3
    [6] Data 1
    [7] Data 2
    [3] "txtCode3" 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T15:12:42.700

我可以通过切换到 <asp:Table> 而不是普通的 html 表来实现这一点。

# file - 使用 HTA 应用程序将 shell 应用程序输出重定向到文件

> ID：13260998
> 
> 赞同：2
> 
> 时间：2012-11-06T23:20:37.867
> 
> 标签：file, shell, redirect, hta

有人能告诉我为什么重定向到文件在我的 HTA 程序中不起作用吗？它包含以下内容：

```
Set objShell = CreateObject("Shell.Application")
objShell.ShellExecute "md5sums.exe", "tarball.tar > .\md5sum.log", , , NORMAL_WINDOW 
```

*当我在没有重定向*的情况下使用上述两行运行我的 HTA 程序时，它工作正常。但是第二次我添加 "> .\md5sum.log"，md5sums.exe 吐出以下错误：

> ```
>  Unable to read file/directory .\md5sum.log 
> ```

，这意味着它忽略了重定向符号并尝试获取不存在的 md5sum.log 文件的校验和。

md5sums.exe 只是一个外部校验和程序。当我从命令行运行以下命令时，它工作正常：

> ```
>  md5sums.exe tarball.tar > .\md5sum.log 
> ```

，按预期将 tarball.tar 的校验和传送到 md5sum.log 文件。

我在整个 Interwebs 中到处搜索，但没有找到解决方案。我非常感谢任何人可以提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T22:40:58.237

终于想通了！万一有人遇到这种情况：

```
shellCmd = "cmd /c md5sums.exe ""tarball.tar"" > ""md5sum.log"""
Set shell = CreateObject("WScript.Shell")
shell.Run shellCmd 
```