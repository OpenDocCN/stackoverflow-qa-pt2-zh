# StackOverflow 问答 14691000-14691999

# perl - 如何使用 DBIx::Class 在 PostGIS 几何列上创建 GiST 索引？

> ID：14691001
> 
> 赞同：0
> 
> 时间：2013-02-04T16:27:09.210
> 
> 标签：perl, postgis, dbix-class

我有一个带有几何列的 Postgres + PostGIS 数据库。

我想为它们添加索引，例如

```
create index plot_idx_location on plot using gist (location); 
```

我知道如何使用 sqlt_deploy_hook 方法在 DBIx::Class 中创建索引，但我不确定 add_index 生成上述语句的语法是什么。

阅读 SQL::Translator 文档（[http://search.cpan.org/~frew/SQL-Translator-0.11016/lib/SQL/Translator/Schema/Index.pm](http://search.cpan.org/~frew/SQL-Translator-0.11016/lib/SQL/Translator/Schema/Index.pm)）似乎没有帮助。没有使用“选项”参数的示例，并且简要查看源代码，我怀疑它甚至不被支持。

那么有没有办法做到这一点，还是我需要在 sqlt_deploy_hook 方法中硬编码 SQL 语句？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-04T17:04:45.710

DBIx::Class 本身不会生成 DDL 查询，而 SQL::Translator 会。您必须自己生成此类特殊索引，例如在架构类中的 after 'deploy' 方法修饰符或使用 deployment_statements 方法。

# javascript - Jquery/Javascript 外部文件不工作

> ID：14691003
> 
> 赞同：0
> 
> 时间：2013-02-04T16:27:23.670
> 
> 标签：javascript, jquery, external

谁能明白为什么我的 javascript/jquery 不工作？谢谢！！！

HTML (就业.php)

```
 <html>
    <head>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="resume_script.js"></script>
    </head>

    <title>Employment</title>

    <body onload="load">
        <h1>Employment History</h1>
        <button type="button" id="add_job">+</button>
        <form action="result.php">
            Start Date: <input type="text" id="start_date"> End Date: <input type="text" id="end_date"> <br><br>
            Description:<br> <textarea id="position"></textarea> <br>

            <div id="add_form"></div>

            <input type="submit">
        </form>
    <div id="footer">
            <ul>
                <li><a href="contact.php">Contact</a></li>
                <li><a href="position.php">Position</a></li>
                <li><a href="employment.php">Employment</a></li>
                <li><a href="resume.php">Resume</a></li>
            </ul>
    </div>

    </body>

    </html> 
```

JAVASCRIPT (resume_script.js)

```
 $(function(){
        alert("test");
        $('#add_job').click(addJob);

    });

    function load(){
        alert("Page is loaded");
    }

    function addJob(){
        alert('test');
        $('Start Date: <input type="text" name="start_date"> End Date: <input type="text" name="end_date"> <br><br>').appendTo('#add_job')
    } 
```

我没有收到任何警报

* * *

我想通了，这只是一个小的语法错误。感谢大家的帮助并推荐我使用控制台！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T16:34:09.660

```
 function addJob(){
        alert('test');
        $'Start Date: <input type="text" name="start_date"> End Date: <input type="text" name="end_date"> <br><br>'.appendTo('#add_job')
 } 
```

应该：

```
function addJob(){
        alert('test');
        $('Start Date: <input type="text" name="start_date"> End Date: <input type="text" name="end_date"> <br><br>').appendTo('#add_job');
} 
```

# asp.net - MVC 4 视图中的错误

> ID：14691010
> 
> 赞同：1
> 
> 时间：2013-02-04T16:27:43.420
> 
> 标签：asp.net, asp.net-mvc-4

有没有办法检查给定对象在 ASP.NET MVC 4 中是否有错误。

就像是

```
 @Html.PasswordFor(model => model.Username, new { placeholder = Html.DisplayFor(model => model.Username) })
    @if(Html.ErrorFor(model => model.Username)) {
    <small class="error">@Html.ValidationMessageFor(model => model.Username)</small>
} 
```

**更新：** 它不是整个模型，而是我需要检查的给定元素，所以 f.eks。do mode.Username有错误！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:44:50.250

我通过创建 2 个方法解决了这个问题。

```
 public static bool HasErrorFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression)
    {
        if (expression == null)
            throw new ArgumentNullException("expression");

        string modelName = htmlHelper.ViewContext.ViewData.TemplateInfo.GetFullHtmlFieldName(ExpressionHelper.GetExpressionText(expression));
        if (!htmlHelper.ViewData.ModelState.ContainsKey(modelName))
            return false;

        ModelState modelState = htmlHelper.ViewData.ModelState[modelName];
        return modelState.Errors.Count > 0;
    }
    public static MvcHtmlString GetErrorMessageFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression)
    {
        if (expression == null)
            throw new ArgumentNullException("expression");

        string modelName = htmlHelper.ViewContext.ViewData.TemplateInfo.GetFullHtmlFieldName(ExpressionHelper.GetExpressionText(expression));
        if (!htmlHelper.ViewData.ModelState.ContainsKey(modelName))
            return new MvcHtmlString(null);

        ModelState modelState = htmlHelper.ViewData.ModelState[modelName];
        if (modelState.Errors.Count > 0)
        {
            return new MvcHtmlString(modelState.Errors.FirstOrDefault().ErrorMessage);
        }

        return new MvcHtmlString(null);
    } 
```

以及如何使用它

```
<div class="row">
    <div class="six columns">
        @Html.TextBoxFor(model => model.Username, new { placeholder = Html.GetDisplayFor(model => model.Username) })
        @if (Html.HasErrorFor(model => model.Username))
        {
        <small class="error">@Html.GetErrorMessageFor(model => model.Username)</small>
        }
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:40:49.303

使用`ModeState.IsValid`属性检查模型的有效性

```
if(ModelState.IsValid)
{
 //DO update/insertion/deletion
}
else
{
 // return your view
} 
```

显示错误。[阅读这篇文章以获取有关 ModelState 错误显示的更多信息](https://stackoverflow.com/questions/5510814/c-sharp-net-mvc3-modelstate-isvalid)

```
var errors = ModelState
    .Where(x => x.Value.Errors.Count > 0)
    .Select(x => new { x.Key, x.Value.Errors })
    .ToArray(); 
```

对于特定属性尝试这样`ModelState["yourProperty"]`。获取包含模型状态和模型绑定验证状态的模型状态字典对象。

```
 if (ModelState["yourProperty"].Errors.Count >0) //then error 
```

# php - 仅显示谷歌地图的一部分

> ID：14691011
> 
> 赞同：0
> 
> 时间：2013-02-04T16:27:45.560
> 
> 标签：php, javascript, css, google-maps

我正在构建小型网站，但无法在页面的“位置”部分显示 Google 地图。查看“ [http://sunlark.besaba.com/vile/12](http://sunlark.besaba.com/vile/12) ”，单击“位置”选项卡. 一小部分地图显示在左上角，而不是全部。我看了一下CSS，但我找不到可能是什么问题......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T16:44:41.820

如果我没记错的话，这与隐藏时创建的地图有关。显示选项卡后，您应该能够在地图上调用调整大小，这应该可以纠正您看到的问题。

对于 V3 API，请使用：

`google.maps.event.trigger(map, "resize");`

在 V2 API 中，您可以调用`checkResize()`您的地图对象。

# asp.net-mvc - 使用 Web API 发布附件和其他表单字段

> ID：14691018
> 
> 赞同：0
> 
> 时间：2013-02-04T16:28:08.767
> 
> 标签：asp.net-mvc, asp.net-web-api

我正在尝试创建一个表单，允许用户使用 web api 和 jquery 指定主题、正文、附件并发布到操作。我不知道如何解决这个问题。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T16:36:17.893

您可以使用 Json 来保存主题和正文，然后使用 formdata 发送文件。您可以使用 $.ajax 函数将数据数据发送到服务器。然后，您可以在服务器代码中解析 Json。

# javascript - Javascript 参数参数和谷歌地图

> ID：14691020
> 
> 赞同：1
> 
> 时间：2013-02-04T16:28:15.317
> 
> 标签：javascript, function, google-maps, google-maps-api-3, parameters

我正在向自己介绍 Google Maps API 以及 JavaScript。

我已经在我的网站上设置了我的地图，现在我正在尝试在同一张地图上动态设置多个标记。

为此，我编写了这个函数：

```
function teste(lat,long){
        alert (lat);
        alert (long);
        //var companyPos3 = new google.maps.LatLng(41.545308,-8.421782);
        var companyPos3 = new google.maps.LatLng(lat,long);
        var companyMarker3 = new google.maps.Marker({
              position: companyPos3,
              map: map,
             // icon: companyLogo,
              title:"Mar!!!" });
            //}      
        ...
    } 
```

我的问题就在这里。我无法使用 'lat' 和 'long' 函数参数设置 google.maps.LatLng。但是，会弹出警告对话框消息，显示来自 PHP 的值。

我也尝试删除警报功能，但标记也没有显示。

我不确定是否有 Google Maps API 技巧或 JavaScript 技巧。

哦，如果我将值设置为注释行，它可以工作，但我不想要这个解决方案:)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T16:41:55.677

long 是 JS 中的保留字。[请在此处查看](http://www.quackit.com/javascript/javascript_reserved_words.cfm)。因此，请尝试使用 lng 而不是 long 来设置图标，请参见[此处](https://developers.google.com/maps/documentation/javascript/overlays#Icons)。尝试类似的东西

```
function teste(lat,lng){
    alert (lat);
    alert (lng);
    //var companyPos3 = new google.maps.LatLng(41.545308,-8.421782);
    var companyPos3 = new google.maps.LatLng(lat,lng);
    var companyMarker3 = new google.maps.Marker({
          position: companyPos3,
          map: map,
         // icon: companyLogo,
          title:"Mar!!!" });
        //}      
    ...
} 
```

# python - python-twitter 程序仅在 shell 中运行

> ID：14691021
> 
> 赞同：0
> 
> 时间：2013-02-04T16:28:16.223
> 
> 标签：python, twitter, python-twitter

我是 Twitter API 和 python-twitter 的新手。我正在尝试运行下面的简单程序：

```
import twitter
api = twitter.Api()
user = 'GoldmanSachs'
statuses = api.GetUserTimeline(screen_name=user)
for s in statuses:
    print s 
```

当我在 Python Shell 中运行程序时，我得到了下面的预期输出。

> {“created_at”：“2013 年 1 月 28 日星期一 22:21:14 +0000”，“收藏”：false，“id”：296020134164836353，“retweet_count”：2，“转推”：false，“来源”：“web” , "text": "ICYMI: WSJ 的达沃斯直播博客与 FX de Mallmann 就欧洲公司在债券市场筹集资金进行了交谈。http://t.co/hCLGBOOy ["](http://t.co/hCLGBOOy) , ....}

但是，当我尝试保存程序然后运行它时，我得到一个 AttributeError：

```
Traceback (most recent call last):
  File "\twitter.py", line 1, in <module>
    import twitter
  File "\twitter.py", line 6, in <module>
    api = twitter.Api()
AttributeError: 'module' object has no attribute 'Api' 
```

任何关于为什么会发生这种情况的想法将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T16:29:24.090

很可能您命名了您的程序`twitter.py`并且它是 shadowing `python-twitter`。重命名您的脚本。

# c# - .Net 2.0 在通用列表中搜索成员对象

> ID：14691022
> 
> 赞同：-3
> 
> 时间：2013-02-04T16:28:17.053
> 
> 标签：c#, list, generics, search

我正在使用.Net 2.0

我有一个通用的

```
List< MyContainerObject > MyList; 
```

和

```
MyContainerClass MyContainerObject = new MyContainerClass(); 
```

和

```
Public Class MyContainerClass
{
    public BasicClass BasicObject;
    public AdvanceClass AdvanceObject
} 
```

如何有效地在 MyList 中搜索 BasicObject？

添加了示例代码

```
namespace WindowsApplication4
{
    public class Program
    {
        private List<ContainerClass> MyList;
        public Program()
        {
            MyList = new List<ContainerClass>();
        }

        private void Add(object sender, EventArgs e)
        {
            ContainerClass objContainer1 = new ContainerClass("B1","A1");
            ContainerClass objContainer1 = new ContainerClass("B2", "A2");
            MyList.Add(objContainer1);
            MyList.Add(objContainer2);            
        }
        private void Get(BasicClass objBasic)
        {
            //How to retreive ContainerClass from MyList that has objBasic ??
        }
    }

    public class ContainerClass
    {
        private BasicClass BasicObject;
        private AdvancedClass AdvancedObject;
        public ContainerClass(string baseID, string AdvanceID)
        {
            BasicObject = new BasicClass();
            BasicObject.ID = baseID;
            AdvancedObject = new AdvancedClass();
            AdvancedObject.ID = AdvanceID;
        }

    }

    public class BasicClass
    {
        public  string ID;
        public int name;
    }

    public class AdvancedClass
    {
        public string ID;
        public int name;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T16:40:17.493

我认为如果您使用高于 2.0 的 .Net 版本而不是使用 linq 来简单地从列表中获取您想要的对象，那将是非常好的。

但您可以使用委托和查找方法

[http://msdn.microsoft.com/en-us/library/x0b5b5bc.aspx](http://msdn.microsoft.com/en-us/library/x0b5b5bc.aspx)

可能是这样的

```
 MyContainerClass MyContainerObject  = MyList.Find(delegate(MyContainerClass p) {return
 BasicObject.Val == someval; }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T16:32:18.223

```
var found = MyList.FirstOrDefault(o => o.BasicObject == someObject); 
```

请注意，除非 BasicObject 实现`IEquatable<BasicObject>`和/或重载`Equals`/`operator==`您最终会`object.ReferenceEquals(o.BasicObject, someObject)`有效。

哎呀。.NET 2.0。出色地：

```
BasicObject FindBy(List<MyContainerClass> list, BasicObject o)
{
     foreach (MyContainerClass i in list)
     {
          if (i.BasicObject == o) // same caveats on Equality
              return i;
     }
     return null;
} 
```

# entity-framework - 实体框架：交叉连接导致 OutOfMemoryException

> ID：14691023
> 
> 赞同：3
> 
> 时间：2013-02-04T16:28:26.910
> 
> 标签：entity-framework, cross-join

我在 SQL Server 2008 上有一个包含 150 万条记录的表。有一个 varchar 列“ReferenzNummer”被索引。

在 SQL Management Studio 中执行的以下查询有效且速度快：

```
SELECT v1.Id, v2.Id FROM Vorpapier as v1 cross join Vorpapier as v2
WHERE v1.ReferenzNummer LIKE '7bd48e26-58d9-4c31-a755-a15500bce4c4'
    AND v2.ReferenzNummer LIKE '7bd4%' 
```

（我知道这样的查询没有多大意义，会有更多的约束，但这暂时不重要）

现在我想从 Entity Framework 5.0 执行这样的查询，我的 LINQ 看起来像这样：

```
var result = (from v1 in vorpapierRepository.DbSet
              from v2 in vorpapierRepository.DbSet
              where v1.ReferenzNummer == "7bd48e26-58d9-4c31-a755-a15500bce4c4" &&
                  v2.ReferenzNummer.StartsWith("7bd4")
              select new { V1 = v1.Id, V2 = v2.Id })
            .Take(10)
            .ToList(); 
```

这会尝试将整个表加载到内存中，一段时间后会导致 OutOfMemoryException。我试图移动 WHERE 部分，但没有成功：

```
var result = (from v1 in vorpapierRepository.DbSet.Where(v => v.ReferenzNummer == "7bd48e26-58d9-4c31-a755-a15500bce4c4")
              from v2 in vorpapierRepository.DbSet.Where(v => v.ReferenzNummer.StartsWith("7bd4"))
                        select new { V1 = v1.Id, V2 = v2.Id })
                        .Take(10)
                        .ToList(); 
```

是否可以告诉 Entity Framework 创建一个交叉连接语句，就像我自己写的那样？

**更新 1**

EF 生成的 SQL 如下所示（对于两个查询）

```
SELECT [Extent1].[Id]             AS [Id],
     [Extent1].[VorpapierArtId] AS [VorpapierArtId],
     [Extent1].[ReferenzNummer] AS [ReferenzNummer],
     [Extent1].[IsImported]     AS [IsImported],
     [Extent1].[DwhVorpapierId] AS [DwhVorpapierId],
     [Extent1].[Datenbasis_Id]  AS [Datenbasis_Id]
FROM   [dbo].[Vorpapier] AS [Extent1] 
```

**更新 2**

当我更改 LINQ 查询并在字段 DatenbasisIDd 上将表与自身连接时（这不完全是我想要的，但它可能会起作用），EF 创建一个连接：

```
 var result = (from v1 in vorpapierRepository.DbSet 
                      join v2 in vorpapierRepository.DbSet
                          on v1.DatenbasisId equals v2.DatenbasisId
                      where v1.ReferenzNummer == "7bd48e26-58d9-4c31-a755-a15500bce4c4" && v2.ReferenzNummer.StartsWith("7bd4")
                        select new { V1 = v1.Id, V2 = v2.Id })
                        .Take(10)
                        .ToList(); 
```

生成的 SQL 查询如下所示。它可以工作并且足够快。

```
SELECT TOP (10) 1              AS [C1],
            [Extent1].[Id] AS [Id],
            [Extent2].[Id] AS [Id1]
FROM   [dbo].[Vorpapier] AS [Extent1]
   INNER JOIN [dbo].[Vorpapier] AS [Extent2]
     ON ([Extent1].[Datenbasis_Id] = [Extent2].[Datenbasis_Id])
         OR (([Extent1].[Datenbasis_Id] IS NULL)
             AND ([Extent2].[Datenbasis_Id] IS NULL))
WHERE  (N'7bd48e26-58d9-4c31-a755-a15500bce4c4' = [Extent1].[ReferenzNummer])
   AND ([Extent2].[ReferenzNummer] LIKE N'7bd4%') 
```

我仍然不明白，为什么 EF 不在原始查询中创建交叉联接。它根本不支持吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T16:31:22.533

如果您在 linq 语句中使用连接，它将被传递回 SQL Server。以下是 linq 中连接运算符的一些示例：http: [//code.msdn.microsoft.com/LINQ-Join-Operators-dabef4e9](http://code.msdn.microsoft.com/LINQ-Join-Operators-dabef4e9)

# c# - 我如何在 asp.NET 中构建整个 mailto 锚点

> ID：14691024
> 
> 赞同：0
> 
> 时间：2013-02-04T16:28:30.700
> 
> 标签：c#, asp.net, hyperlink, anchor, stringbuilder

我有一个文字标签，它传递了一个字符串列表。我希望传递给它的字符串之一是电子邮件。我希望电子邮件成为超链接。这就是我到目前为止所得到的，

```
tenancyManager.UserEmail = "a@b.c";
if (null != tenancyManager.UserEmail)
{
    var emailAnchor = "<a href="+"mailto:"+tenancyManager.UserEmail+">"+ "</a>";
    builder.Append(emailAnchor);
    builder.Append("<br />");
} 
```

这似乎不起作用，任何人都可以帮助我的语法吗？我也试过

```
var email = string.Format("<a href={0}{1} Text={2}> </a>", "mailto:", tenancyManager.UserEmail, tenancyManager.UserEmail); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-04T16:32:21.703

你的`string.Format()`代码是错误的。尝试：

```
var email = string.Format("<a href='mailto:{0}'>{0}</a>", tenancyManager.UserEmail); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:39:40.537

这将做你想要的：

```
StringWriter stringWriter = new StringWriter();
using (HtmlTextWriter tag = new HtmlTextWriter(stringWriter))
{
    tag.AddAttribute(HtmlTextWriterAttribute.Href, string.Format("mailto:{0}", tenancyManager.UserEmail));
    tag.RenderBeginTag(HtmlTextWriterTag.A);
    tag.Write(tenancyManager.UserEmail);
    tag.RenderEndTag();

}
literal.Text = stringWriter.ToString(); 
```

虽然我不确定你为什么不只使用`<asp:Hyperlink>`? 像这样：

```
<asp:HyperLink id="hypEmail" runat="server" />
hypEmail.NavigateUrl = string.Format("mailto:{0}", tenancyManager.UserEmail);
hypEmail.Text = string.Format("mailto:{0}", tenancyManager.UserEmail); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T16:46:22.900

您的 formatString 错误：a html 标记没有 text 属性。

```
string.Format("<a href=\"mailto:{0}\">{0}</a>", tenancyManager.UserEmail); 
```

`string.format`（对同一文本使用 2 个不同的占位符是没有意义的）

无论如何，我认为使用`asp:HyperLink` [http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.hyperlink.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.hyperlink.aspx)而不是文字更干净。

```
hl.NavigateUrl = string.Format("mailto:{0}", tenancyManager.UserEmail);
hl.Text = tenancyManager.UserEmail; 
```

或者，如果您想拥有完整的 html 输出控制，请使用`GenericHtmlControl` [http://msdn.microsoft.com/en-us/library/system.web.ui.htmlcontrols.htmlgenericcontrol.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.htmlcontrols.htmlgenericcontrol.aspx) 或`HtmlAnchor` [http://msdn.microsoft.com /en-us/library/system.web.ui.htmlcontrols.htmlanchor.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.htmlcontrols.htmlanchor.aspx)

恕我直言，使用文字控件注入 html 是一种不好的做法

# python - 使用 genfromtxt 创建具有空列的 numpy 数组

> ID：14691029
> 
> 赞同：2
> 
> 时间：2013-02-04T16:28:57.360
> 
> 标签：python, arrays, numpy, concatenation, genfromtxt

我正在使用 导入数据`numpy.genfromtxt`，并且我想添加一个从数据集中的一些值派生的值字段。由于这是一个结构化数组，因此向数组添加新列的最简单、最有效的方法似乎是使用`numpy.lib.recfunctions.append_fields()`. [我在这里](http://www.astropython.org/resource/2011/7/recfunctions)找到了这个库的一个很好的描述。

有没有办法在不复制数组的情况下做到这一点，也许是通过强制`genfromtxt`创建一个我可以附加派生值的空列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-09T20:47:14.150

我试图`genfromtxt`读这个：

```
11,12,13,14,15
21,22,
31,32,33,34,35
41,42,43,,45 
```

使用：

```
import numpy as np
print np.genfromtxt('tmp.txt',delimiter=',',filling_values='0') 
```

但它没有用。我不得不更改输入添加逗号来表示空列：

```
11,12,13,14,15
21,22,,,
31,32,33,34,35
41,42,43,,45 
```

然后它起作用了，返回：

```
[[ 11\.  12\.  13\.  14\.  15.]
 [ 21\.  22\.   0\.   0\.   0.]
 [ 31\.  32\.  33\.  34\.  35.]
 [ 41\.  42\.  43\.   0\.  45.]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-08T22:11:57.337

这是一个使用生成器向数据文件添加字段的简单示例，使用**genfromtxt**

我们的示例数据文件将是*data.txt*，其内容为：

```
1,11,1.1
2,22,2.2
3,33,3.3 
```

所以

```
In [19]: np.genfromtxt('data.txt',delimiter=',')
Out[19]:
array([[  1\. ,  11\. ,   1.1],
       [  2\. ,  22\. ,   2.2],
       [  3\. ,  33\. ,   3.3]]) 
```

如果我们制作一个生成器，例如：

```
def genfield():
    for line in open('data.txt'):
        yield '0,' + line 
```

它将逗号分隔的 0 添加到文件的每一行，然后：

```
In [22]: np.genfromtxt(genfield(),delimiter=',')
Out[22]:
array([[  0\. ,   1\. ,  11\. ,   1.1],
       [  0\. ,   2\. ,  22\. ,   2.2],
       [  0\. ,   3\. ,  33\. ,   3.3]]) 
```

您可以使用以下推导执行相同的操作：

```
In [26]: np.genfromtxt(('0,'+line for line in open('data.txt')),delimiter=',')
Out[26]:
array([[  0\. ,   1\. ,  11\. ,   1.1],
       [  0\. ,   2\. ,  22\. ,   2.2],
       [  0\. ,   3\. ,  33\. ,   3.3]]) 
```

# javascript - jQuery插件需求：用鼠标控制方向的字幕文本

> ID：14691034
> 
> 赞同：3
> 
> 时间：2013-02-04T16:29:32.150
> 
> 标签：javascript, jquery-plugins, scroll, marquee, sliding

我正在搜索一个 jQuery 插件来选取 div 中的文本并用鼠标控制方向。我发现了一个用纯 Javascipt 编写的示例[。](http://www.dynamicdrive.com/dynamicindex2/crawler/index.htm)

该插件必须具有以下功能：

*   鼠标悬停时开始滚动
*   滚动方向必须通过缪斯动作来改变。

如果滚动速度也随着鼠标移动而变化，那就太好了。

# r - 如何仅删除 R cdplot 中的左轴标签？

> ID：14691042
> 
> 赞同：1
> 
> 时间：2013-02-04T16:30:02.087
> 
> 标签：r, graphics

所附示例生成条件密度图。在示例中，我可以使用`ylab = NA`删除“x”轴标签，如果我`yaxlabels = "n"`同时使用左右刻度标签，则删除。

如何仅抑制左侧标签（即“0”和“1”）并保持右侧概率标度？

```
# Example
Forest = c(1,0,1,1,1,0,1,1,0,1)
change = c(-1, 3, 1, 4, 1, 1, -1, 1, -1, 6)
mydata = data.frame(Forest,change)

x = factor(mydata$Forest)

cdplot(x~mydata$change, ylab = NA, xlab = NA) 
```

![在此处输入图像描述](../Images/df25919a13db31a8162b7a71842580ab.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T16:37:33.630

如您所说，您可以使用`yaxlabels = "n"`删除两侧的 y 标签。不仅仅是通过添加右侧轴`axis(4)`。

```
Forest = c(1,0,1,1,1,0,1,1,0,1)
change = c(-1, 3, 1, 4, 1, 1, -1, 1, -1, 6)
mydata = data.frame(Forest,change)

x = factor(mydata$Forest)

cdplot(x~mydata$change, ylab = NA, xlab = NA, yaxlabels = "n")
axis(4) 
```

![在此处输入图像描述](../Images/54bee778077468d00cf0cf002ce40bdb.png)

# google-apps-script - 导入 CSV 期间超过最大执行时间

> ID：14691051
> 
> 赞同：-1
> 
> 时间：2013-02-04T16:30:40.773
> 
> 标签：google-apps-script, google-sheets, import-from-csv

我遵循了 Google 的[Interacting With Your Docs List 教程](https://developers.google.com/apps-script/articles/docslist_tutorial?hl=en)，了解如何编写导入 CSV 文件的脚本。经过大量的帮助后，我得到了它的工作。但是，当我尝试复制它或以任何方式修改它时，它会超时并显示错误消息：

> 超过最大执行时间。

...并且不运行。为什么会发生这种情况？

这是`importFromCSV()`教程中的功能：

```
function importFromCSV() {
  var fileName = Browser.inputBox("Enter the name of the file in your Docs List to import (e.g. myFile.csv):");

 var files = DocsList.getFiles();
  var csvFile = "";

  for (var i = 0; i < files.length; i++) {
    if (files[i].getName() == fileName) {
      csvFile = files[i].getContentAsString();
      break;
    }
  }
  var csvData = CSVToArray(csvFile, ",");
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getActiveSheet();
  for (var i = 0; i < csvData.length; i++) {
    sheet.getRange(i+1, 1, 1, csvData[i].length).setValues(new Array(csvData[i]));
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T21:09:40.523

CSV 导入示例`CSVToArray`对每一行进行调用。那很慢。

查看[最佳实践文档](https://developers.google.com/apps-script/best_practices)中的建议。第一条指导是减少对其他服务的调用；更改示例以更新数组的所有行，然后`var arrData = [[]]`只调用一次，您将大大提高性能。

替换这个：

```
for (var i = 0; i < csvData.length; i++) {
  sheet.getRange(i+1, 1, 1, csvData[i].length).setValues(new Array(csvData[i]));
} 
```

有了这个：

```
sheet.clear();

var numRows = csvData.length;
var numCols = csvData[0].length; // assume all rows are same width

// Make a single call to spreadsheet API to write values to sheet.
sheet.getRange(1, 1, numRows, numCols).setValues( csvData );
SpreadsheetApp.flush(); 
```

我还发现我需要在 中更改几行`var arrData = new Array()`，而不是像这样声明数组：`setValues()`，我使用了这个：`setValues`。这应该没关系（在 JavaScript 中），但确实如此（在 Google Apps 脚本中）。

# java - 将文本插入到 gwt textarea 中的特定位置

> ID：14691054
> 
> 赞同：-1
> 
> 时间：2013-02-04T16:30:47.870
> 
> 标签：java, gwt, textarea

在传统的 java jTextArea 中，我们有`insert(String value, int Postion)`在特定位置插入文本的方法。但我在 gwt 等效项中找不到相同的功能。

我可以取出整个字符串，在我想要的位置插入我想要的内容，然后将结果设置回 textarea，但是将整个文本取出并每次设置回来似乎效率不高。有没有办法在我选择的位置插入文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T16:35:31.653

您可以使用 Formatter 在当前光标位置插入 HTML。

```
 RichTextArea.Formatter formatter = myRichTextArea.getFormatter();
    formatter.insertHTML(html); 
```

如果您需要不同的位置，您仍然需要将文本添加到 String 并替换 TextArea 内容。我认为用户甚至不会注意到这一点——它发生得非常快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:48:53.763

Woomma .. 我们的 Gwt 前辈遇到了所有这些头脑风暴问题，并为我们实施了一些儿童图书馆..

我坚信你正在寻找这个，希望它对你有帮助

[替换 GWT 的字符串](http://www.java2s.com/Code/Java/GWT/ReplacestringforGWT.htm)

您需要做的只是将小方法添加到您的类中并用作

```
 String returnedString =  replace(text, searchString, replacement, -1); 
```

谈到您的`EVERYTIME`更换问题...我们目前没有其他选择

# .net - 将客户端证书与 HttpListener 一起使用

> ID：14691055
> 
> 赞同：3
> 
> 时间：2013-02-04T16:30:48.397
> 
> 标签：.net, ssl, httplistener

我`HttpListener`用来实现一个简单的网络服务器。我正在绑定到端口 44430——我没有与 IIS 共享端口。我已经使用以下配置了服务器证书`netsh`：

```
netsh http add sslcert ipport=0.0.0.0:44430 ^
    certhash=a614ebdfd07968dedd3afdb1cb8c696988dd7734 ^
    appid="{00112233-4455-6677-8899-AABBCCDDEEFF}" 
```

现在，我想要求客户证书。我添加`clientcertnegotiation=enable`到上面的命令，然后它显示为启用`netsh http show sslcert`。

我在我的服务器中使用以下代码：

```
var context = listener.GetContext();
var clientCertificate = context.Request.GetClientCertificate(); 
```

...但是当我使用 Internet Explorer 浏览该站点时，`clientCertificate`则为`null`.

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-14T08:06:04.420

您必须在 Windows 证书存储中拥有客户端证书。

证书需要由服务器主机上受信任的 CA（证书颁发机构）签名。

然后 IE 应该能够找到客户端证书并将其传递给服务器。

# .net - 使用主机属性与参数的 T4 模板

> ID：14691059
> 
> 赞同：0
> 
> 时间：2013-02-04T16:31:06.450
> 
> 标签：.net, code-generation, t4

在预处理的 T4 模板中，在将值传递给模板时，使用自定义主机属性与参数是否有任何约定或良好做法？

有什么优势吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T02:16:21.570

就个人而言，我喜欢参数指令，仅仅是因为它让来维护模板的人非常清楚，参数及其类型是什么。生成的代码为您提供了几个解决这些值的选项。但是，我知道有一些人更喜欢在生成的类旁边的部分类中简单地添加参数，并使用它来设置其值，可能使用自定义构造函数。

老实说，我认为 Host 属性在预处理模板中有点像白象，除非您同时拥有相同代码的预处理版本和设计时版本。

# bash - 使用 \copy 时的 Postgres 变量替换

> ID：14691064
> 
> 赞同：2
> 
> 时间：2013-02-04T16:31:20.200
> 
> 标签：bash, postgresql, variables

我正在使用 psql 命令 \copy 并且我想从 shell 向它传递一个变量（用于表名），就像我在编写查询脚本时所做的那样。我在文档中读到：

> 该命令的语法类似于 SQL COPY 命令的语法。请注意，正因为如此，特殊的解析规则适用于 \copy 命令。特别是，变量替换规则和反斜杠转义不适用。

这似乎很确定，但是我想知道是否有人知道工作方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T16:48:08.553

您可以使用带有 heredoc 语法的 shell 变量替换。例子：

```
#!/bin/sh
tablename=foo
psql -d test <<EOF
\copy $tablename FROM '/path/to/file'
EOF 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-21T18:47:11.700

您可以使用命令行参数将变量从 shell 传递给 psql （或在导出后`-v psql_var="$shell_var"`直接使用 shell 转义访问它）。然后，您可以在另一个元命令（本地或服务器端）``echo "$shell_var"``中构建元命令。例子：`\copy``\set``\gset`

```
#!/bin/sh
tablename=foo
psql -d test -v tbl="$tablename" <<\EOF
\set cmd '\\copy ' :tbl ' FROM ''/path/to/file'''
\echo :cmd
:cmd
EOF 
```

# plone - 克隆中的自动重定向？

> ID：14691068
> 
> 赞同：2
> 
> 时间：2013-02-04T16:31:33.737
> 
> 标签：plone

我重命名了一个对象 ID，并认为我必须在我的虚拟主机中编写一个重定向，但是在尝试使用旧 url（重命名对象 ID 之前的那个）访问我的对象后，我看到 plone 将我重定向到新对象的网址。

有人能告诉我哪些产品或功能启用了这种行为吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T17:30:20.170

此功能由 plone.app.redirector ( [http://pypi.python.org/pypi/plone.app.redirector/](http://pypi.python.org/pypi/plone.app.redirector/) ) 提供，它是 Plone 核心发行版的一部分。

# javascript - d3js 箭头未显示

> ID：14691077
> 
> 赞同：2
> 
> 时间：2013-02-04T16:32:13.327
> 
> 标签：javascript, svg, d3.js

我有一个力有向图的例子。我想显示箭头，但无论我尝试什么，我都看不到它们。

这是我的 javascript

```
 var nodes = {};

    // Compute the distinct nodes from the links.
    links.forEach(function(link) {
        link.source = nodes[link.source] || (nodes[link.source] = {
            name: link.source
        });
        link.target = nodes[link.target] || (nodes[link.target] = {
            name: link.target
        });
    });

    var width = 960,
        height = 500;

    var force = d3.layout.force()
        .nodes(d3.values(nodes))
        .links(links)
        .size([width, height])
        .linkDistance(100)
        .charge(-300)
        .on("tick", tick)
        .start();

    var svg = d3.select("body").append("svg")
        .attr("width", width)
        .attr("height", height);

    svg.append("svg:defs").selectAll("marker")
        .data(["arrow"])
        .enter().append("svg:marker")
        .attr("id", "arrow")
        .attr("viewBox","0 0 10 10")
        .attr("refX","20")
        .attr("refY","5")
        .attr("markerUnits","strokeWidth")
        .attr("markerWidth","9")
        .attr("markerHeight","5")
        .attr("orient","auto")
        .append("svg:path")
        .attr("d","M 0 0 L 10 5 L 0 10 z")
        .attr("fill", "#f0f0f0");

    var link = svg.append("svg:g").selectAll("line")
        .data(force.links())
        .enter().append("svg:line")
        .attr("class", "link")
        .attr("marker-mid", "url(#arrow)");

    var node = svg.append("svg:g").selectAll(".node")
        .data(force.nodes())
        .enter().append("g")
        .attr("class", "node")
        .call(force.drag);

    node.append("circle")
        .attr("r", 8);

    node.append("text")
        .attr("x", -22)
        .text(function(d) {
        return d.name;
    });

    function tick() {
        link.attr("x1", function(d) {
            return d.source.x;
        })
            .attr("y1", function(d) {
            return d.source.y;
        })
            .attr("x2", function(d) {
            return d.target.x;
        })
            .attr("y2", function(d) {
            return d.target.y;
        });
        link.attr("marker-mid", "url(#arrow)");

        node.attr("transform", function(d) {
            return "translate(" + d.x + "," + d.y + ")";
        });
    } 
```

这[是我的jsfiddle](http://jsfiddle.net/Kobayakawa/eFxFC)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T16:42:35.553

来自[MDN 文档`marker-mid`](https://developer.mozilla.org/en-US/docs/SVG/Attribute/marker-mid)：

> marker-mid 定义了在给定元素或基本形状**的第一个和最后一个顶点以外的每个顶点**绘制的箭头或多标记。

所以标记将插入每个顶点，但开始和结束。

然而，一条简单的线段没有其他顶点，只有它的起点和终点。因此，您的代码中没有显示任何标记。

如果你改变你`marker-mid`的，例如，`marker-end`你会看到箭头（虽然现在，它们不是那么漂亮）：[小提琴](http://jsfiddle.net/eFxFC/4/)。

另一种方法是将`line`-elements 更改为`path`elements 并在中间添加一个额外的顶点。然而，这将需要一些更充分的代码。

# angularjs - 用于指令添加功能的 angularjs 模拟元素

> ID：14691080
> 
> 赞同：0
> 
> 时间：2013-02-04T16:32:16.073
> 
> 标签：angularjs

我使用 angular js 1.0.3 并尝试测试我的指令。

我们使用由 angular 自动加载的 jQuery，并且可以作为传递给指令的 angular.element 访问。

如何在指令与范围链接之前向元素添加属性？？？

```
var def = '<input data-my-directive="" />';

var scope = $rootScope.$new();
var linked = $compile(def);
// do something to add property something that jq is adding
var directive = linked(scope); 
```

我的指令类似于

```
return function(scope, element, attrs) {
    element.jq-plugin-method();
} 
```

我的目标是链接后传递给指令的元素。

感谢帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T09:49:41.683

回答我自己的问题。添加就足够了

```
var jqLite = angular.element;
jqLite.prototype.jq-plugin-method = function(c) {...}; 
```

前

```
linked = $compile(definition); 
```

昨天我是盲人什么的，或者我在编译后添加了这一行，为时已晚。

# c# - 我可以在将传递给构造函数但不公开的类中创建一个委托吗？

> ID：14691084
> 
> 赞同：0
> 
> 时间：2013-02-04T16:32:31.170
> 
> 标签：c#, generics, delegates

我有这样的课。

```
public class Step<T>
{
    public delegate void Act<T>();

    Act<T> _act;

    public Step(Act<T> action)
    {
        Contract.Requires(action != null);

        _act = action;
    }

    public void PerformStep()
    {
        _act.Invoke();
    }
} 
```

我的问题如下。我希望此类的构造函数能够接受具有您在类中看到的定义的委托。我不希望那个代表成为我班的公共成员。另一种方法是在班级之外有一个公共代表，但没有其他班级，但这个班级需要它。有没有办法可以将代表设为私有？

如果该解决方案不可行，是否有替代方案？此步骤类只是要按顺序运行的委托的包装器。如果我可以有更通用的解决方案，则无需签名。

编辑：更多信息以供澄清。

此类的目的是能够允许用户执行以下操作。

如果我有一辆Class Car。这辆车将具有 Drive、Stop、Turn 等方法。使用此 Step 类，该类的用户应该能够创建其类的实例，然后执行以下操作。

```
Car c = new Car();
Step<Car> step1 = new Step<Car>(c.TurnLeft);
Step<Car> step2 = new Step<Car>(c.Drive);
Step<Car> step3 = new Step<Car>(c.TurnRight);
//add steps to a collection
c.AddNewRoutine(collection of steps);
c.RunRoutine(identify which routine); 
```

这些步骤将被添加到允许它们按顺序执行的数据结构中。汽车类将包含一个可以保存这些步骤组的数据结构。然后，这允许创建任何类并让用户设置该类要采取的步骤，而无需类或主程序对行为进行硬编码。

完成。我需要步骤类保持原样。我只是不想允许以任何形式公开访问该委托，因为唯一需要它的类是 Step 类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T16:35:40.310

如果其他类需要使用委托，那么您需要将其公开。时期。

您唯一真正的选择是添加一个构造函数，该构造函数接受一些其他类型的参数，然后构造函数可以将其转换为该委托类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T16:38:57.277

您的示例使用不带参数且没有返回值的自定义委托。为此，这`System.Action`可能是理想的。如果您的自定义委托需要提供返回值，请`System.Func`改用。

[http://msdn.microsoft.com/en-us/library/system.action.aspx](http://msdn.microsoft.com/en-us/library/system.action.aspx)

[http://msdn.microsoft.com/en-us/library/bb534960.aspx](http://msdn.microsoft.com/en-us/library/bb534960.aspx)

从您提供的示例来看，您想要的更像是这样的：

```
public class Step<T>
{
    Action _action;

    public Step(Action action)
    {
        Contract.Requires(action != null);

        _action = action;
    }

    public void PerformStep()
    {
        _action.Invoke();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T16:36:39.273

一起移除委托并使用一个动作：

```
private Action<T> _action;

public Step(Action<T> action)
{
   _action = action;
} 
```

**编辑：**

你也可以有一个`System.Action`没有类型参数的简单

```
private Action _action;

public Step(Action action)
{
   _action = action;
} 
```

**但是**，请记住，执行此操作时：

```
var c = new Car();
var step1 = new Step(c.TurnLeft); 
```

您将step1 绑定到实际实例`c`，您将无法将该步骤重用于另一个实例：

```
var c2 = new Car(); //There's no way to call step1 on this =( 
```

# jquery - 突出显示 div 中两个表中的行和列

> ID：14691085
> 
> 赞同：0
> 
> 时间：2013-02-04T16:32:35.663
> 
> 标签：jquery, html, twitter-bootstrap

我在一个 div 中有 2 个表，我想同时突出显示两个表上的同一行。现在我只设法让它突出显示 1 个表中的列和行。

（例如：如果我将鼠标悬停在 中的“Row2 Column3”上`tbl-2`，`tbl-1`则应突出显示 Row2 中的内容，反之亦然）

另外，我如何让它也突出显示`th`标签？

```
<div class="row">
<div class="span2 pull-left">
    <table class="table table-bordered pull-left" id="compare-tbl-1">
        <thead>
            <th>Column 1</th>
        </thead>
        <tbody>
            <tr>
                <td>
                    Row1
                </td>
            </tr>
            <tr>
                <td>
                    Row2
                </td>
            </tr>
            <tr>
                <td>
                    Row3
                </td>
            </tr>
            <tr>
                <td>
                    Row4
                </td>
            </tr>
            <tr>
                <td>
                    Row5
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="span10 pull-right">
    <table class="table table-bordered" id="compare-tbl-2">
        <thead>
            <th>Column 1</th><th>Column 2</th><th>Column 3</th><th>Column 4</th><th>Column 5</th>
        </thead>
        <tbody>
            <tr>
                <td>Row1 Column1</td><td>Row1 Column2</td><td>Row1 Column3</td><td>Row1 Column4</td><td>Row1 Column5</td>
            </tr>
            <tr>
                <td>Row2 Column1</td><td>Row2 Column2</td><td>Row2 Column3</td>    <td>Row2 Column4</td><td>Row2 Column5</td>
            </tr>
            <tr>
                <td>Row3 Column1</td><td>Row3 Column2</td><td>Row3 Column3</td><td>Row3 Column4</td><td>Row3 Column5</td>
            </tr>
            <tr>
                <td>Row4 Column1</td><td>Row4 Column2</td><td>Row4 Column3</td><td>Row4 Column4</td><td>Row4 Column5</td>
            </tr>
            <tr>
                <td>Row5 Column1</td><td>Row5 Column2</td><td>Row5 Column3</td><td>Row5 Column4</td><td>Row5 Column5</td>
            </tr>
        </tbody>
    </table>
</div> 
```

```
<script>
    $("#compare-tbl-2 td").hover(function() {
            $(this).parents('table').find('td:nth-child(' + ($(this).index() + 1) + ')').
                  add($(this).parent()).addClass('compare-hover');
      },
      function() {
            $(this).parents('table').find('td:nth-child(' + ($(this).index() + 1) + ')').
                  add($(this).parent()).removeClass('compare-hover');
      });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:08:23.053

尝试用这个替换你的脚本：

```
$("#compare-tbl-2 td").hover(function() {
$(this).closest('tr').addClass('compare-hover');
var idx = $(this).closest('tr')[0].sectionRowIndex + 1;

$('#compare-tbl-1').find('tr:nth-child(' + idx + ')').addClass('compare-hover');
  },
  function() {
      $(this).closest('tr').removeClass('compare-hover');
      $('#compare-tbl-1').find('tr').removeClass('compare-hover');
  }); 
```

[jsFiddle](http://jsfiddle.net/markps/Q4tLX/7/)

# sql-server-2008 - 从 SQL Server 2008 升级到 2012 后的 SSRS 第 x 页，共 0 页

> ID：14691087
> 
> 赞同：2
> 
> 时间：2013-02-04T16:32:45.527
> 
> 标签：sql-server-2008, reporting-services, sql-server-2012

遇到一个问题，在将 SQL Server 从 2008/R2 升级到 2012 后，SSRS 报告在呈现为 PDF 时将在底部显示“第 x 页，共 0 页”（x = 报告的页码）。这只发生在 PDF 中。

我打开报告，全局参数的正确用法就在那里。如果我将报告重新部署到升级后的 SSRS，它工作正常。

看来是升级问题。应用 SQL Server 2012 SP1 也无济于事。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T18:28:17.740

所以我们用MS开了一张票。简而言之，当运行就地升级时，存储在 ReportServer DB 中的 RDL 是“单独存在的”。由于 MS 仅将 Globals!TotalPages 更改为 Globals!OverAllTotalPages 并且在升级过程中从未触及 RDL，因此会发生错误。

这也解释了为什么当您获取未修改的原始报告并重新上传/部署报告时。有用。

如果您只是更新本地服务器，这很好。当您有 4500 多个安装（最多可支持 N 个用户）和 180 多个报告时。当客户升级时，我们会收到一张故障单。那可能是很多麻烦票。

不知道为什么 MS 没有将 Globals!TotalPages 升级为 Globals!OverAllTotalPages。没有得到那个答案。

# eclipse - autotools eclipse 插件中的 MALLOC 选项

> ID：14691089
> 
> 赞同：0
> 
> 时间：2013-02-04T16:32:49.293
> 
> 标签：eclipse, malloc, autotools

我正在为 Eclipse 中的 autotools 插件和我下载的一些 C++ 项目而苦苦挣扎。

我的目标包括对 arm 处理器进行交叉编译，因此该项目已经配置为使用 autotools，但是当我尝试交叉编译时出现以下问题

```
In file included from /usr/include/c++/4.6/bits/stl_algo.h:61:0,
                 from /usr/include/c++/4.6/algorithm:63,
                 from dtntracepath.cpp:17:
/usr/include/c++/4.6/cstdlib:119:11: error: ‘::malloc’ has not been declared 
```

我已经检查了我的项目的配置输出并注意到了这一点

```
...
checking for stdlib.h... (cached) yes
checking for GNU libc compatible malloc... no
checking for memset... yes
... 
```

我知道如何通过添加选项通过 linux 终端修复它

```
export ac_cv_func_malloc_0_nonnull=yes 
```

但不能通过 Eclipse 或 autotools 插件，因为项目的设置不可用。你能启发我吗？

亲切的问候，

提前致谢

PS：我在 autotools 插件中设置的参数如下：

```
-Command: configure  CFLAGS="-m32" LDFLAGS="-m32"  CC=/home/t/s/arm-mv5sft-linux-gnueabi/SW3.2p1/bin/arm-mv5sft-linux-gnueabi-gcc CC=c99
-All options :  --host=arm-mv5sft-linux-gnueabi --build=i686-linux --target=arm-mv5sft-linux-gnueabi --with-sysroot=/home/t/s/arm-mv5sft-linux-gnueabi/SW3.2p1/arm-mv5sft-linux-gnueabi/ 
```

编辑：

我已经使用以下配置尝试了 ldav1s 建议

```
configure CC=/home/t/s/arm-mv5sft-linux-gnueabi/SW3.2p1/bin/arm-mv5sft-linux-gnueabi-gcc CXX=/home/t/s/arm-mv5sft-linux-gnueabi/SW3.2p1/bin/arm-mv5sft-linux-gnueabi-g++  CFLAGS="-m32" LDFLAGS="-m32" 
```

我收到这些错误

```
Command-line environment variables:
     LDFLAGS="-m32" LDFLAGS="-m32" CC="/home/t/s/arm-mv5sft-linux-gnueabi/SW3.2p1/bin/arm-mv5sft-linux-gnueabi-gcc" CXX="/home/t/s/arm-mv5sft-linux-gnueabi/SW3.2p1/bin/arm-mv5sft-linux-gnueabi-g++"

sh -c /home/t/ibrdtn/ibrdtn-tools-0.8.0/configure      ++ --host=arm-mv5sft-linux-gnueabi --with-sysroot=/home/t/s/arm-mv5sft-linux-gnueabi/SW3.2p1/arm-mv5sft-linux-gnueabi/ 
configure: WARNING: you should use --build, --host, --target
configure: WARNING: invalid host type: ++
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for arm-mv5sft-linux-gnueabi-strip... no
checking for arm-mv5sft-linux-gnueabi-strip... no
checking for strip... strip
configure: WARNING: using cross tools not prefixed with host triplet
checking for a thread-safe mkdir -p... /bin/mkdir -p
checking for gawk... gawk
checking whether make sets $(MAKE)... yes
Invalid configuration `++': machine `++' not recognized
configure: error: /bin/bash ./config.sub ++ failed
configure: error: /bin/bash ./config.sub ++ failed
checking build system type... 

Configuration failed with error 
```

EDIT2 重新安装eclipse后，第一版的++错误消失了，现在如果我使用以下配置

```
configure CC=/home/t/s/arm-mv5sft-linux-gnueabi/SW3.2p1/bin/arm-mv5sft-linux-gnueabi-gcc CXX=/home/t/s/arm-mv5sft-linux-gnueabi/SW3.2p1/bin/arm-mv5sft-linux-gnueabi-g++ CFLAGS="-m32" LDFLAGS="-m32"--host=arm-mv5sft-linux-gnueabi --build=i686-linux --target=arm-mv5sft-linux-gnueabi 
```

它正在正确编译，我看到了一些 arm/le 输出，但是我收到了与其中一个库有关的错误

```
make[3]: Entering directory `/home/t/ibrdtn/ibrcommon-0.8.0/ibrcommon/net'
  CXX    tcpclient.lo
  CXX    tcpserver.lo
  CXX    tcpstream.lo
  CXX    udpsocket.lo
  CXX    MulticastSocket.lo
  CXX    UnicastSocket.lo
  CXX    stopandwait.lo
  CXX    vsocket.lo
  CXX    vinterface.lo
  CXX    vaddress.lo
  CXX    LinkManager.lo
In file included from LinkManager.cpp:16:
../../ibrcommon/net/NetLinkManager.h:19:29: error: netlink/netlink.h: No such file or directory
../../ibrcommon/net/NetLinkManager.h:20:26: error: netlink/attr.h: No such file or directory
make[3]: *** [LinkManager.lo] Error 1
make[3]: Leaving directory `/home/t/ibrdtn/ibrcommon-0.8.0/ibrcommon/net'
make[2]: Leaving directory `/home/t/ibrdtn/ibrcommon-0.8.0/ibrcommon'
make[2]: *** [all-recursive] Error 1
make[1]: Leaving directory `/home/t/ibrdtn/ibrcommon-0.8.0/ibrcommon'
make[1]: *** [all] Error 2
make: *** [all-recursive] Error 1

**** Build Finished **** 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:58:10.290

您尚未将 C++ 编译器 ( `CXX`) 设置为 的参数的一部分，也未将 C`configure`编译器 ( ) 进行多重定义`CC`。

您似乎正在为构建机器选择编译器（中的那些`/usr/include`），而不是交叉编译器的编译器（中的那些`/home/t/s/arm-mv5sft-linux-gnueabi/SW3.2p1`）。

# excel - 在 Coldfusion Excel 导出中将撇号转换为 '

> ID：14691093
> 
> 赞同：1
> 
> 时间：2013-02-04T16:33:00.250
> 
> 标签：excel, coldfusion, coldfusion-8

我的输出中的一些撇号/单引号正在转换为`&#39;`. 我不知道为什么有些人会，有些人不会。有没有办法普遍确保这个字符和其他非字母数字不会转换为 ASCII？

```
<cfsetting enablecfoutputonly="yes" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<cfheader name="Content-Disposition" value="filename=#filename#.xls">
<cfcontent type="application/msexcel" />
<cfoutput>#TheReport.Data#</cfoutput> 
```

更新：输出本身的样本

```
<cfset delimiter = Chr(9) />
<cfset new_line = Chr(13) & Chr(10) />
<cfoutput query="report">
  <cfset output = output & "#id##delimiter##first_name##delimiter##last_name#">
  <cfset output = output & new_line />
</cfoutput> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T22:45:09.147

如果您删除 cfheader 和 cfcontent（并查看源代码以查看实际内容），问题会消失吗？

如果不是，则编码的引号在原始`TheReport.Data`变量中，与输出为 application/msexcel 文件无关。

# apache - apache没有加载htaccess

> ID：14691096
> 
> 赞同：0
> 
> 时间：2013-02-04T16:33:19.487
> 
> 标签：apache, .htaccess, drupal-7

我试图让 Apache 识别我的 Drupal 网站根目录下的 htaccess 文件，但无论我尝试什么设置，它都会被忽略。mod_rewrite 模块已加载，AllowOverride 设置为 All 并且所有路径都正确。htaccess 文件有我能找到的最基本的设置，但没关系，因为如果我用垃圾文本填充它仍然无法工作。我已经在网上搜索试图找到答案，但还没有任何效果。您可能有的任何想法都会有所帮助。我正在使用 Apache 2.2.15 和 Drupal 7 运行 CentOS 6.3。

这是 .htaccess 文件：

```
</IfModule>

# Various rewrite rules.
<IfModule mod_rewrite.c>
  RewriteEngine on

# If you do not have mod_rewrite installed, you should remove these
# directories from your webroot or otherwise protect them from being
# downloaded.
  RewriteRule "(^|/)\." - [F] 

# Pass all requests not referring directly to files in the filesystem to
# index.php. Clean URLs are handled in drupal_environment_initialize().
  RewriteCond %{REQUEST_FILENAME} !-f 
  RewriteCond %{REQUEST_FILENAME} !-d 
  RewriteCond %{REQUEST_URI} !=/favicon.ico
  RewriteRule ^ index.php [L] 

# Rules to correctly serve gzip compressed CSS and JS files.
# Requires both mod_rewrite and mod_headers to be enabled.
  <IfModule mod_headers.c>
# Serve gzip compressed CSS files if they exist and the client accepts gzip.
    RewriteCond %{HTTP:Accept-encoding} gzip
    RewriteCond %{REQUEST_FILENAME}\.gz -s
    RewriteRule ^(.*)\.css $1\.css\.gz [QSA]

# Serve gzip compressed JS files if they exist and the client accepts gzip.
    RewriteCond %{HTTP:Accept-encoding} gzip
    RewriteCond %{REQUEST_FILENAME}\.gz -s
    RewriteRule ^(.*)\.js $1\.js\.gz [QSA]

# Serve correct content types, and prevent mod_deflate double gzip.
    RewriteRule \.css\.gz$ - [T=text/css,E=no-gzip:1]
    RewriteRule \.js\.gz$ - [T=text/javascript,E=no-gzip:1]

    <FilesMatch "(\.js\.gz|\.css\.gz)$">
 # Serve correct encoding type.
      Header set Content-Encoding gzip
 # Force proxies to cache gzipped & non-gzipped css/js files separately.
      Header append Vary Accept-Encoding
    </FilesMatch>
  </IfModule>
</IfModule> 
```

谢谢，-戴夫

# android - 在sqlite中将浮点数存储为varchars？

> ID：14691099
> 
> 赞同：-1
> 
> 时间：2013-02-04T16:33:27.757
> 
> 标签：android, sqlite, floating-point, varchar

我正在做一个涉及小数点数字（浮点数）的项目。现在我的问题是，您认为将浮点数作为字符串存储在 varchar 字段中，然后在我想对它们执行数学运算时转换它们是个好主意吗？

还是应该将它们存储到 REAL 字段中？（这就是我现在正在做的事情）。

我真的很想就这个主题发表一些意见，也许还有一些利弊。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:00:51.110

在一般情况下，您应该将数字存储为数字。它更快，使用更少的空间，避免舍入错误，并防止您的代码出现在 The Daily WTF 上。

由于您的项目的一些非常不寻常的限制，可能存在将数字存储为文本的特定情况，在没有告诉我们您的项目的情况下，您要求我们发明这样的限制。

所以，没有优点。

# mahout - Mahout - 类 LongPair

> ID：14691100
> 
> 赞同：0
> 
> 时间：2013-02-04T16:33:28.790
> 
> 标签：mahout

我正在使用 Mahout 创建推荐引擎，为了过滤基于项目的推荐，以下方法需要“LongPair”类型：

```
GenericItemBasedRecommender.mostSimilarItems(long[] itemIDs, int howMany, Rescorer<LongPair> rescorer) 
```

我必须承认我没有听说过 org.apache.mahout.common.LongPair，所以我检查了 javadoc。不幸的是我找不到任何例子，所以仍然不明白这对长数字对 Rescorer 代表什么。

第一个是索引，第二个是值吗？还有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T16:51:42.807

rescorer 机制允许您将所需的任何业务逻辑注入结果中。您可以更改答案或从结果中删除答案。在这里，结果按一项与其他项之间的相似性排序。您的逻辑可能是这些值中的一个或两个的函数。因此，rescorer 将向您传递有问题的两个项目的 ID。

# eclipse - 无法将 BAR 文件部署到 BlackBerry 10 Dev Alpha Simulator

> ID：14691101
> 
> 赞同：2
> 
> 时间：2013-02-04T16:33:29.630
> 
> 标签：eclipse, blackberry-simulator, blackberry-10, blackberry-android

我正在尝试使用 BB Android Runtime SDK 将我的 Android 应用程序移植到 BB10。我已成功打包应用程序并创建了一个 BAR 文件，但无法将其安装在 BB 10 Dev Alpha 模拟器上。我已经尝试使用 Run As->BlackBerry Android Launch 从 Eclipse 运行应用程序，并使用 BlackBerry Tablet OS Graphical Aid 'Install' 选项，在这两种情况下我都得到了这个输出：

```
Info: Sending request: Install
Info: Action: Install
Info: File size: 1709216
Info: Installing ...
Info: Processing 1709216 bytes 
```

在 Eclipse 中，我还收到错误“无法部署项目...”。在 BB 图形辅助中，我只是在“操作输出”窗口中获得上述输出。从看到其他帖子看来，我应该看到更多的日志条目，例如“信息：进度 0%...”、“信息：进度 50%...”等，我没有看到。任何想法可能是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T10:38:39.790

已安装全新的 BB 10 Dev Simulator 版本 10.1 - 允许选择启动到 Z10 或 Q10 设备的版本，我现在可以每次在 Windows 上部署我的应用程序。只能假设问题是由以前的模拟器版本中的错误引起的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T09:05:14.550

通过完全卸载 VMPlayer 和 BB10 模拟器，清理我的注册表然后重新安装解决了这个问题。仍然不知道为什么它不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T09:13:59.713

我的经验是仔细检查应用程序是否已经存在。如果是，您必须首先从模拟器中删除/卸载它（通过长按应用程序的图标并单击右上角的回收图标）。

# powershell - XCOPY 部署脚本 - 如何包含某些文件？

> ID：14691108
> 
> 赞同：0
> 
> 时间：2013-02-04T16:33:56.263
> 
> 标签：powershell, xcopy

我只需要使用 Powershell 复制文件夹的某些部分，特别是这个列表：

```
$files = @("MyProgram.exe",
           "MyProgram.exe.config",
           "MyProgram.pdb",
           ".\XmlConfig\*.xml") 
```

以人类可读的形式：目标文件夹根目录下的 3 个特定文件和本身位于源路径根目录下的文件夹`MyProgram.*`下的所有 XML 文件（在我的情况下）。如果文件夹不存在，则必须在目标中创建文件夹。`XmlConfig``..\bin\Release\``XmlConfig`

**我试过的：**

(1) 我尝试了以下方法，但没有成功，即在目标路径没有创建文件夹或文件：

```
Copy-Item -Recurse -Path "..\bin\Release\" -Destination ".\Test\" -Include $files 
```

(2)`-Include`删除时，整个文件夹结构创建成功，包括子文件夹和文件：

```
Copy-Item -Recurse -Path "..\bin\Release\" -Destination ".\Test\" 
```

`-Include`我对过滤器工作原理的理解一定有问题：

(3) 我测试了一个需要通配符数组的假设`-Include`，但这也不起作用：

```
$files = @("*MyProgram.exe*",
           "*MyProgram.exe.config*",
           "*MyProgram.pdb*",
           "*.\XmlConfig\*.xml*") 
```

* * *

请就`Copy-Item`我的情况如何正确提供建议。

**更新（基于以下答案）：**

我正在寻找一个采用字符串数组的*通用实现。*它打开了将所有必要的文件/路径放在一个地方的可能性，以便于编辑，以便非 Powershell 知识的人可以根据需要理解和修改它。因此，最终它将是为任何项目执行 XCOPY 部署的单个脚本，输入文件是唯一的可变部分。对于上面的例子，输入看起来像这样（保存`input.txt`并作为参数传递给主脚本）：

```
MyProgram.exe
MyProgram.exe.config
MyProgram.pdb
.\XmlConfig\*.xml 
```

我更喜欢通配符方法，因为没有多少人知道正则表达式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:13:19.150

我不知道过滤器有什么问题，但你仍然可以这样做

```
$files | % { copy-item ..\bin\release\$_ -Destination .\test} 
```

如果您想保留直接结构，则必须稍微弱化一下，例如：

```
$sourcedir="c:\temp\test"
$f=@("existing.txt","hf.csv";"..\dir2\*.txt")
$f |%{
     $source=ls (join-Path $sourcedir $_) |select -expand directoryname    
     if ("$source" -like "$sourcedir*"){
        $destination=$source.Substring($sourcedir.Length)+".\" 
     }
     else{
        $destination=$_
     }  
    copy-item $sourcedir\$_ -Destination $destination -WhatIf
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:31:03.300

AFAICT -Include 仅适用于文件名或目录名，而不适用于组合，即路径。你可以尝试这样的事情：

```
$files = 'MyProgram\.exe|MyProgram\.exe\.config|MyProgram\.pdb|XmlConfig\\.*?\.xml'

Get-ChildItem ..\bin\release -r | Where {!$_.PSIsContainer -and ($_.FullName -match $files)} | 
    Copy-Item -Dest .\test 
```

使用通配符，您可以这样做：

```
$files = @('*MyProgram.exe','*MyProgram.exe.config','*MyProgram.pdb','*\XmkConfig\*.xml')
Get-ChildItem ..\bin\release -r |
    Foreach {$fn=$_.Fullname;$_} | 
    Where {!$_.PSIsContainer -and ($files | Where {$fn -like $_})} | 
    Copy-Item -Dest .\test 
```

# shell - 基于公共列合并2个文件的数据

> ID：14691109
> 
> 赞同：0
> 
> 时间：2013-02-04T16:33:58.833
> 
> 标签：shell, unix

当使用以下命令加入它们时，我正在尝试基于第一列 348.csv 和 349.csv 合并 2 个文件

> 加入 -a1 -a2 -1 2 -2 2 348.csv 349.csv

没有得到正确的输出，即输出混乱。

猫 348.csv：

> ```
> Timestamp                   BRM Servers 
>                               348  
> 1/28/2013 02:00 AM PST        176  
> 1/28/2013 02:30 AM PST        150
> 1/28/2013 03:00 AM PST        140
> 1/28/2013 03:30 AM PST        100 
> ```

猫 349.csv：

> ```
> Timestamp                   BRM Servers
>                                349  
> 1/28/2013 02:00 AM PST         99
> 1/28/2013 02:30 AM PST         115
> 1/28/2013 03:00 AM PST         101
> 1/28/2013 03:30 AM PST         78 
> ```

预期如下：

> ```
> Timestamp                   BRM Servers 
>                              348  349 
> 1/28/2013 02:00 AM PST       176  99 
> 1/28/2013 02:30 AM PST       150  115 
> 1/28/2013 03:00 AM PST       140  101
> 1/28/2013 03:30 AM PST       100  78 
> ```

并按顺序。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T16:38:04.070

尝试这个：

```
awk 'NR==FNR{i=NF<5?"__":$1$2$3$4;a[i]=$0;next} FNR==1{print}{i=NF<5?"__":$1$2$3$4}FNR>1&&i in a{print a[i],$NF}' file1 file2 
```

用你的数据测试：

```
kent$  head f1 f2
==> f1 <==
Timestamp                   BRM Servers 
                              348  
1/28/2013 02:00 AM PST        176  
1/28/2013 02:30 AM PST        150
1/28/2013 03:00 AM PST        140
1/28/2013 03:30 AM PST        100

==> f2 <==
Timestamp                   BRM Servers
                               349  
1/28/2013 02:00 AM PST         99
1/28/2013 02:30 AM PST         115
1/28/2013 03:00 AM PST         101
1/28/2013 03:30 AM PST         78

kent$  awk 'NR==FNR{i=NF<5?"__":$1$2$3$4;a[i]=$0;next} FNR==1{print}{i=NF<5?"__":$1$2$3$4}FNR>1&&i in a{print a[i],$NF}' f1 f2
Timestamp                   BRM Servers
                              348   349
1/28/2013 02:00 AM PST        176   99
1/28/2013 02:30 AM PST        150 115
1/28/2013 03:00 AM PST        140 101
1/28/2013 03:30 AM PST        100 78 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:37:23.780

我假设您的文件是制表符分隔的。如果不是，“第 1 列”中的空格将使这项任务变得更加困难。

```
sed 1q 348.csv
join -t $'\t' -j 1 -o 0,1.2,2.2 <(sed 1d 348.csv) <(sed 1d 349.cvs) 
```

给出制表符分隔的输出，如下所示：

```
Timestamp       BRM Servers 
        348     349  
1/28/2013 02:00 AM PST  176     99
1/28/2013 02:30 AM PST  150     115
1/28/2013 03:00 AM PST  140     101
1/28/2013 03:30 AM PST  100     78 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:44:06.293

我假设您的文件是制表符分隔的

```
join -a1 -a2 -1 1 -2 1 -t $'\t'  348.csv 349.csv 
```

# python - 如何在内存中编辑加载的模块？

> ID：14691110
> 
> 赞同：0
> 
> 时间：2013-02-04T16:34:01.483
> 
> 标签：python, reflection, python-2.x

假设我有一个文件

```
# func.py:

def function():
    print 'Hello'
    print 'World' 
```

我在同一个目录中有另一个文件

```
# load.py:

import sys
import inspect
from func import function 
```

我现在可以通过以下方式访问函数源：

```
code = inspect.getsourcelines(sys.modules['function']) 
```

无论如何我可以编辑函数的行以进行打印：

“Hello There World”而不是“Hello World”？

我想通过就地编辑函数来在内存中完成这一切。我目前正在通过读取源代码并在将其写入临时文件并导入临时文件时对其进行编辑来实现相同的效果，但我想完全避免使用外部文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:18:33.297

您是否想到[猴子修补](http://en.wikipedia.org/wiki/Monkey_patch)而不是实际替换该代码。

```
 import func

  func.function()

  def monkey_boy():
      print "Monkey Boy"

  func.function = monkey_boy

  func.function() 
```

给出：

```
Hello
World
Monkey Boy 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:05:56.943

你想要一个带参数的函数：

```
def function(greeting='Hello', target='World'):
    print greeting, target 
```

在另一个文件中：

```
function()   #prints Hello World

function(target='To The World')  #prints Hello To The World 
```

如果这不是您想要的，那么请解释*用例*是什么，因为我很确定您将按照您的描述创建一个**巨大**的设计缺陷。

正如我在评论中所说，自修改程序在 40 年代/50 年代被使用，但在那之后就没有了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T16:43:28.663

这实际上并没有就地编辑函数，但它确实用没有临时文件的新函数替换了该模块上的函数（这可能已经足够好了）：

```
import inspect
import func

code = inspect.getsourcelines(func.function)
lines = code[0]
lines.insert(2,"    print 'There'\n")

exec ''.join(lines)
func.function = function 
```

# java - 将转储文件导入 mysql JDBC

> ID：14691112
> 
> 赞同：1
> 
> 时间：2013-02-04T16:34:08.167
> 
> 标签：java, mysql, jdbc, mysqlimport

我正在将 Java 与 MySQL (JDBC) 一起使用，并且我想将转储文件导入数据库。这样做的正确方法是什么？我尝试了以下代码：

```
// function "connectToDB" connects to the Database, and not the server.
// variable sourcePath refers to the dumpfile.
    Connection con = connectToDB(USERNAME, PASSWORD); 
    String q = "source " + sourcePath;
    System.out.println("Q is: " + q);
    try {
        Statement statement = con.createStatement();
        statement.executeUpdate(q);
    } catch (Exception ex) {
        ex.printStackTrace();
    }
    closeConnection(con); 
```

但我得到一个 MySQLSyntaxErrorException ：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'source C:...\Desktop\dumpfile.sql' 附近使用正确的语法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T20:16:58.517

感谢大家的帮助，阅读了他们的想法，我终于导入了 dumpfile.sql 所以如果有人有同样的问题，对我有用的示例代码是这样的：

```
Connection con = connectToDB(USERNAME, PASSWORD);
/* Note that con is a connection to database, and not the server.
if You have a connection to the server, the first command in the dumpfile should be the
USE db_name; */
String q = "";
File f = new File(sourcePath); // source path is the absolute path of dumpfile.
try {
    BufferedReader bf = new BufferedReader(new FileReader(f));
        String line = null;
        line = bf.readLine();
        while (line != null) {
            q = q + line + "\n";
            line = bf.readLine();
        }
    } catch (Exception ex) {
        ex.printStackTrace();
    }
// Now we have the content of the dumpfile in 'q'.
// We must separate the queries, so they can be executed. And Java Simply does this:
String[] commands = q.split(";");

try {
    Statement statement = con.createStatement();
    for (String s : commands) {
        statement.execute(s);
    }
} catch (Exception ex) {
}
closeConnection(con); 
```

**编辑：**添加 connectToDB 函数：

```
private Connection connectToDB(String username, String password) {
    try {
        Class.forName("com.mysql.jdbc.Driver");
        String url = "jdbc:mysql://localhost:3306/" + DATABASE;
        Properties objProperties = new Properties();
        objProperties.put("user", username);
        objProperties.put("password", password);
        objProperties.put("useUnicode", "true");
        objProperties.put("characterEncoding", "utf-8");

        Connection con = DriverManager.getConnection(url, objProperties);
        return con;
    } catch (Exception ex) {
        System.out.println("Connection to sql database failed.");
        ex.printStackTrace();
        return null;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-08-04T08:08:16.943

我实际上使用了@Makan Tayebi 自己的答案，但我觉得可以做出一些改进。如果转储文件大小过大，则可能会出现第一个问题，而不是这种方法不是最佳的。如果表中的数据包含特殊字符“;”，则可能会出现第二个问题 在 '' 内表示数据，将字符串中读取的文件拆分在 ; 也会就此分裂；并且会发生异常。现在，这是我的解决方案。刚刚编辑了他的：

```
Connection con = connectToDB(USERNAME, PASSWORD);
/* Note that con is a connection to database, and not the server.
if You have a connection to the server, the first command in the dumpfile should be the
USE db_name; */
 //String q = "";
        try {
            File f = new File(path); // source path is the absolute path of dumpfile.

            BufferedReader bf = new BufferedReader(new FileReader(f));
            String line = null,old="";
            line = bf.readLine();
            while (line != null) {
                //q = q + line + "\n";
                if(line.endsWith(";")){
                    stmt.executeUpdate(old+line);
                    old="";
                }
                else
                    old=old+"\n"+line;
                line = bf.readLine();
            }
    } catch (Exception ex) {
        ex.printStackTrace();
   }
closeConnection(con); 
```

此代码假定使用 mysqldump 或任何其他在每个语句结束后换行的程序创建 sql 转储。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-04T16:49:03.427

您需要分别运行每个语句并删除注释

*   以空命令字符串开头
*   阅读每一行
*   修剪线
*   丢弃以-开头的那些
*   将行添加到您的命令字符串
*   如果行以 ; 结尾 运行命令并重复到步骤 1

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-04T16:47:22.737

因为它在 SQL 语句的错误中列出，所以您正在尝试执行以下查询

```
source C:...\Desktop\dumpfile.sql 
```

以上不是有效的 SQL 语句，因此它会在第 1 行给您错误。您需要打开包含 SQL 的文件，然后将其主体用作

```
q 
```

# c++ - 如何使用 wcout 显示 L"أَبْجَدِيَّة عَرَبِيَّة‎中文"？

> ID：14691114
> 
> 赞同：10
> 
> 时间：2013-02-04T16:34:10.407
> 
> 标签：c++, windows-7, unicode, io, widestring

我想使用 wcout 显示混有中文的阿拉伯语消息。

下面的代码是可以的：

```
#include <iostream>

using namespace std;

int main()
{
    wcout.imbue(locale("chs"));
    wcout << L"中文"; // OK
} 
```

但是，以下代码不起作用：

```
#include <iostream>

using namespace std;

int main()
{
    wcout.imbue(locale(/* What to place here ??? */));
    wcout << L"أَبْجَدِيَّة عَرَبِيَّة‎中文"; // Output nothing. VC++ 2012 on Win7 x64
    // Why does the main advantage of unicode not apply here?
} 
```

我认为在采用 unicode 之后应该弃用代码页的概念。

**Q1。wout显示这样一个文本的机制是什么？**

**Q2。为什么 Windows 作为基于 unicode 的操作系统，不支持在其控制台窗口中输出 unicode 字符？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T16:51:32.477

默认情况下，CRT 会将文件的所有输出视为 ANSI。您可以在程序开始时使用此行更改它

```
_setmode(_fileno(stdout), _O_WTEXT); 
```

很好的参考@http [://www.siao2.com/2008/03/18/8306597.aspx](http://www.siao2.com/2008/03/18/8306597.aspx)

仅供参考，双向语言支持在大多数命令提示符中都是有限的，据我了解，这是导致此问题的限制。为什么不/支持它是我无法回答的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-12-29T23:28:46.080

您不能使用标准 C++ 工具可移植地打印宽字符串。

相反，您可以使用[开源 {fmt} 库](https://github.com/fmtlib/fmt)来便携式打印 Unicode 文本。例如（[https://godbolt.org/z/nccb6j](https://godbolt.org/z/nccb6j)）：

```
#include <fmt/core.h>

int main() {
  fmt::print("أَبْجَدِيَّة عَرَبِيَّة‎中文&quot;);
} 
```

印刷

```
أَبْجَدِيَّة عَرَبِيَّة‎中文 
```

这需要使用`/utf-8`MSVC 中的编译器选项进行编译。

`wcout`为了比较，在 Linux ( [https://godbolt.org/z/h9WKsY](https://godbolt.org/z/h9WKsY) ) 上写入：

```
std::wcout << L"أَبْجَدِيَّة عَرَبِيَّة‎中文&quot;; 
```

印刷

```
???????????? ????????????? 
```

除非您将全局语言环境切换为 eg `en_US.utf8`。Windows 上存在类似的问题，没有标准的方法来修复它（您必须使用非标准 CRT 函数或 Windows API）。

**免责声明**：我是 {fmt} 的作者。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-10T00:55:08.047

我刚读了这篇文章

“总结...

如果您使用 Visual C++，则不能使用 UTF-8 将文本打印到 std::cout。

如果你仍然想，请阅读这篇关于如何使 wcout 和 cout 工作的惊人的长文章，但它并没有真正给出一个简单的解决方案 - 最终落入重新定义流缓冲区......” [http://alfps.wordpress .com/2011/12/08/unicode-part-2-utf-8-stream-mode/](http://alfps.wordpress.com/2011/12/08/unicode-part-2-utf-8-stream-mode/)

（来自这个博客[http://blog.cppcms.com/post/105](http://blog.cppcms.com/post/105)）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-14T19:55:21.643

你可以试试这个：

我假设您能够仅呈现中文文本。这表示你有中文字体文件。

您请尝试仅使用阿拉伯语文本。如果您能够渲染，则表示您的系统中有阿拉伯字体。

但是当你混合使用阿拉伯文 + 中文时，你需要强制选择一个包含两个字形集的字体文件。我认为 wcout 拾取的默认字体文件没有阿拉伯字形。

我假设你可能会得到阿拉伯 unicode 的盒子。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-11-03T03:43:45.263

```
#include <iostream>
#include <io.h>
#include <fcntl.h>

int main() {
    _setmode(_fileno(stdout), _O_U16TEXT); // or _O_WTEXT
    std::wcout << L"أَبْجَدِيَّة عَرَبِيَّة‎中文" << std::endl;
} 
```

[http://www.cplusplus.com/forum/beginner/126557/](http://www.cplusplus.com/forum/beginner/126557/)

# php - 使用可调用的服务管理器的奇怪行为

> ID：14691115
> 
> 赞同：-1
> 
> 时间：2013-02-04T16:34:19.783
> 
> 标签：php, zend-framework2

我仍在学习理解 ZF2，恕我直言，最好的方法是做事。我遇到了这个奇怪的问题，想知道这是否是预期的行为。

在我的应用程序中，我有以下代码

```
//In module.php getServiceConfig()
return array(
    'invokables' => array(
        'hardwareEntity'        => 'Hardware\Model\Hardware',
    ),
} 
```

在我的控制器中，我从一团文本中检索数据，这会导致 x 元素数组让我们以 3 为例

```
$hardwares = array(
    'hw1' => array(
        'name'  => 'router1'
        'ip'    => '192.168.0.200',
        'type'  => 'router',
    ),

    'hw2' => array(
        'name'  => 'pc1'
        'ip'    => '192.168.0.210',
        'type'  => 'pc',
    ),

    'hw3' => array(
        'name'  => 'pc2'
        'ip'    => '192.168.0.211',
        'type'  => 'pc',
    ),
); 
```

我在硬件模块中有一个硬件类

```
namespace Hardware\Model\;
class Hardware
{
    protected $name = null;
    protected $ip   = null;
    protected $type = null;

    public function exchangeArray(array $data) {

        $this->name = (isset($data['name']))    ? $data['name'] : $this->name;
        $this->ip   = (isset($data['ip']))      ? $data['ip']   : $this->ip;
        $this->type = (isset($data['type']))    ? $data['type'] : $this->type;
    }
} 
```

好的，当我执行以下 foreach 循环时，魔法就来了，我得到了不同的结果

```
foreach($hardwares as $hw) {
    $h = $this->getServiceManager()->get('hardwareEntity');
    $h->exchangeData($hw);
    $aObjects[] = $h
} 
```

$aObjects 数组现在包含 3 个元素，其对象类型为 Hardware\Model\Hardware，但包含最后一个 $hardwares 元素的数据（也就是在循环时用数据覆盖所有类）

结果：

```
array(3) {
    [0]=> 
    object(Hardware\Model\Hardware)#219 {
        ["name":protected]=>
        string(7) "pc2"
        ["ip":protected]=>
        string(13) "192.168.0.211"
        ["type":protected]=>
        string(6) "pc"
    }
    [1]=> 
    object(Hardware\Model\Hardware)#219 {
        ["name":protected]=>
        string(7) "pc2"
        ["ip":protected]=>
        string(13) "192.168.0.211"
        ["type":protected]=>
        string(6) "pc"
    }
    [2]=> 
    object(Hardware\Model\Hardware)#219 {
        ["name":protected]=>
        string(7) "pc2"
        ["ip":protected]=>
        string(13) "192.168.0.211"
        ["type":protected]=>
        string(6) "pc"
    } 
```

但是当我这样做时

```
foreach($hardwares as $hw) {
    $h = new \Hardware\Model\Hardware();
    $h->exchangeData($hw);
    $aObjects[] = $h
} 
```

它用新实例化的类填充 $aObjects 数组，每个类包含不同的数据。

结果：

```
array(3) {
    [0]=> 
    object(Hardware\Model\Hardware)#219 {
        ["name":protected]=>
        string(7) "router1"
        ["ip":protected]=>
        string(13) "192.168.0.200"
        ["type":protected]=>
        string(6) "router"
    }
    [1]=> 
    object(Hardware\Model\Hardware)#220 {
        ["name":protected]=>
        string(7) "pc1"
        ["ip":protected]=>
        string(13) "192.168.0.210"
        ["type":protected]=>
        string(6) "pc"
    }
    [2]=> 
    object(Hardware\Model\Hardware)#221 {
        ["name":protected]=>
        string(7) "pc2"
        ["ip":protected]=>
        string(13) "192.168.0.211"
        ["type":protected]=>
        string(6) "pc"
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T16:46:58.907

从[服务管理器快速入门](http://framework.zend.com/manual/2.0/en/modules/zend.service-manager.quick-start.html#using-configuration)

> shared，服务名称/布尔值对的数组，指示是否应共享服务。默认情况下，ServiceManager 假定所有服务都是共享的，但您可以在此处指定布尔值 false 以指示应返回新实例。

所以你可能需要做这样的事情......

```
//In module.php getServiceConfig()
return array(
    'invokables' => array(
        'hardwareEntity'        => 'Hardware\Model\Hardware',
    ),
    'shared' => array(
         'hardwareEntity' => false,
    ),
} 
```

# html - 两侧带有灵活装饰图像的 CSS 标题

> ID：14691117
> 
> 赞同：3
> 
> 时间：2013-02-04T16:34:26.197
> 
> 标签：html, css

我正在尝试在两侧制作带有水平线的装饰性标题，类似于[http://www.impressivewebs.com/centered-heading-horizo](http://www.impressivewebs.com/centered-heading-horizontal-line/) ​​ntal-line/但有以下限制：

*   支持任意标题文本
*   流体 - 拉伸以适应页面的宽度
*   水平线是图像 - 每条线都由一个装饰性的“提示”图像组成，然后是一个重复部分，该部分应根据需要拉伸以填充页面宽度
*   装饰性提示图像是固定宽度（每个 297 像素）
*   解决方案必须使用网页上的背景图片
*   随着页面宽度的缩小，图像的重复部分变得更小并最终消失。如有必要，中间的标题文本会换成多行。

我试图仅将 CSS 用于解决方案，但如果无法使用纯 CSS 完成，我会考虑使用 JavaScript 帮助。

我在 SO 上看到了一些类似的问题，但我认为任何解决方案都不能完全满足我的要求。

这是我自己的幼稚尝试（也在[http://jsfiddle.net/39qLr/1/](http://jsfiddle.net/39qLr/1/)）。为简单起见，我将“提示”图像涂成红色，将灵活的重复图像涂成黄色。明显的问题是黄色部分现在没有出现！

HTML：

```
<div class="heading-container">
    <div class="left-tip"></div>
    <div class="left-filler"></div>
    <h1>Heading Text</h1>
    <div class="right-filler"></div>
    <div class="right-tip"></div>
</div> 
```

CSS：

```
.heading-container {
    display: table;
    width: 100%;
}

.left-tip, .right-tip {
    background-color: red;
    width: 297px;
    display: table-cell;
}

.left-filler, .right-filler {
    background-color: yellow;
    display: table-cell;
}

h1 {
    text-align: center;
    display: table-cell;
} 
```

我非常感谢任何指导！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:29:49.657

在一位同事的帮助下，我们设法尽可能接近：

[http://jsfiddle.net/rbCvq/](http://jsfiddle.net/rbCvq/)

HTML（与以前相同）：

```
<div class="heading-container">
    <div class="cell left-tip">&nbsp;</div>
    <div class="cell left-filler">&nbsp;</div>
    <h1 class="cell heading-text">Heading Text</h1>
    <div class="cell right-filler">&nbsp;</div>
    <div class="cell right-tip">&nbsp;</div>
</div> 
```

CSS：

```
.heading-container {
    display: table;
    width: 100%;
}

.cell
{
    display: table-cell;
}

.left-tip, .right-tip {
  width: 297px;
  background: red;
}

.left-filler, .right-filler {
  background: yellow;
}

.heading-text {
  width: 1px;
  white-space: nowrap;
} 
```

使它起作用的秘诀似乎是：

*   标题元素上的 1px 宽度
*   添加`white-space: nowrap`
*   在`nbsp;`空的 DIV 中

当然，这不符合我将文本换成多行的原始标准，但我认为整体效果与我们希望的一样好。此外，DIV 上的标记有点重，没有语义目的。

感谢您的所有建议，我希望有一天这对其他人有用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:53:05.847

我认为您正在寻找接近此的东西：

[http://jsfiddle.net/39qLr/2/](http://jsfiddle.net/39qLr/2/)

我将图像推入填充物内，以便您可以利用相对位置的绝对位置。这将把它们固定到最后。

摆弄你的宽度以使其正确并注意高度。

```
<div class="right-filler">
        <div class="right-tip"></div>
</div>

.left-tip, .right-tip {
    background-color: red;
    width: 297px;
    height:50px;
    position:absolute;
}
.left-tip{
    left:0;
}
.right-tip{
    right:0;
} 
```

# c# - 翻译 XAML 元素

> ID：14691122
> 
> 赞同：1
> 
> 时间：2013-02-04T16:34:44.073
> 
> 标签：c#, .net, wpf, vb.net, internationalization

我有一个 WinForm 项目。我们使用字符串扩展方法“翻译”通过翻译文件翻译我们的消息。

```
translatedString = myString.Translate() 
```

在那个项目中，我们使用了一些 WPF 控件。

我在 WPF XAML 控件中有类似的东西。

```
<MenuItem Name="tsmiCopier"
      Header="Copier"
      Command="Copy"> 
```

我需要翻译“标题”中的文本。所以我需要通过该`Translate()`函数传递所有“可翻译”的 XAML 字符串。

换句话说，我需要做
`tsmiCopier.Header = tsmiCopier.Header.Translate()`，但对于所有的 menuItems。也许不仅是 MenuItems，还有 XAML 中的其他“标题”，用户可以在 GUI 中看到。

如何做得更好？

也许 WPF 翻译还有其他机制，但由于应用程序的其余部分，我们被迫使用独特的 Translate() 方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:24:31.190

我通过披露不必本地化 WPF 应用程序来回答这个问题。

以下是一些可能有帮助的选项：

1.  看看[WPF 本地化扩展](http://wpflocalizeextension.codeplex.com)。

2.  如果您必须使用该`Translate()`方法，您可以创建一个转换器。有几种方法可以转换值，通过直接绑定或通过绕过 Binding 表达式的参数。

**XAML**

```
<Window x:Class="so.Localization.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:Localization="clr-namespace:so.Localization" Title="Tranlate"
        Width="525"
        Height="350"
        WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <Localization:TranslateConverter x:Key="Translater" />
    </Window.Resources>
    <Grid>
        <Menu>
            <MenuItem Header="{Binding Converter={StaticResource Translater}, ConverterParameter='Copier', FallbackValue='Copier'}" />
        </Menu>
    </Grid>
</Window> 
```

**代码背后**

```
using System;
using System.Globalization;
using System.Windows;
using System.Windows.Data;

namespace so.Localization
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }
    }

    [ValueConversion( typeof( string ), typeof( string ) )]
    public class TranslateConverter : IValueConverter
    {
        #region Implementation of IValueConverter

        public object Convert( object value, Type targetType, object parameter, CultureInfo culture )
        {
            // if using binding
            if( value != null && value is string )
            {
                return ( (string)value ).TranslateBinding();
            }

            // if using a general paramater
            if( parameter != null && parameter is string )
            {
                return ( (string)parameter ).TranslateParameter();
            }

            return DependencyProperty.UnsetValue;
        }

        public object ConvertBack( object value, Type targetType, object parameter, CultureInfo culture )
        {
            throw new NotImplementedException();
        }

        #endregion
    }

    public static class Ext
    {
        public static string TranslateBinding( this string input )
        {
            // translat to whatever...
            return input + " (translated binding)";
        }

        public static string TranslateParameter( this string input )
        {
            // translat to whatever...
            return input + " (translated parameter)";
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T08:54:58.173

一个）

```
 Public Sub TranslateHeaderedItemsLogical(ByVal myFrameworkElement As FrameworkElement)
    For Each element In LogicalTreeHelper.GetChildren(myFrameworkElement)
      If TypeOf element Is HeaderedItemsControl Then
        Dim objHeaderedVisual As HeaderedItemsControl = DirectCast(element, HeaderedItemsControl)
        If (objHeaderedVisual.Header IsNot Nothing) Then
          objHeaderedVisual.Header = objHeaderedVisual.Header.ToString().Translate()
        End If
      End If
    Next element
  End Sub 
```

b)

```
 Private Sub MyWPFControl_Loaded(sender As Object, e As System.Windows.RoutedEventArgs) Handles Me.Loaded
    TranslateHeaderedItemsLogical(Me.ContextMenu)
  End Sub 
```

# javascript - 用 id jquery 连接变量

> ID：14691123
> 
> 赞同：0
> 
> 时间：2013-02-04T16:34:50.507
> 
> 标签：javascript, jquery, loops

> **可能重复：**
> [在 Javascript 中将字符串转换为变量名](https://stackoverflow.com/questions/5613834/convert-string-to-variable-name-in-javascript)

我有不同的变量（var1、var2、var3、.. 到 var10）。我想使用这样的 for 循环更新它们：

```
for(var i=0; i<10;i++){
 var+i = i+20;
} 
```

要获得这样的东西：

```
var1 = 21;
var2 = 22;
var3 = 23;
...
var10 = 30; 
```

我的问题在于我无法将变量的名称与其 id/位置连接起来。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T16:35:51.067

使用[**数组**](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array)而不是变量。

**[现场演示](http://jsfiddle.net/CBE8Q/)**

```
arr = []
for(var i=0; i<10;i++){
 arr[i] = i+20;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T16:38:42.247

全局变量（如果它们是这样的话）是`window`对象的属性，因此您可以执行以下操作：

```
for(var i=0; i<10;i++){
    window["var"+i] = i+20;
} 
```

当然，我会建议您使用不同且更简单的方法：数组！

```
var data = [];
for(var i=0; i<10;i++){
    data[i] = i+20;
} 
```

# c++ - 为什么c ++向量会导致oom-killer？

> ID：14691124
> 
> 赞同：0
> 
> 时间：2013-02-04T16:34:53.200
> 
> 标签：c++, vector, out-of-memory, embedded-linux

代码需要查找和处理还没有在embedded-linux上处理的文件。getDir 用于返回目录的排序内容。下面的代码在处理了几十个或可能超过 100 个文件后完美运行，但随后因 oom-killer 而死。这是使用 c++ 向量（循环向量内的循环向量）的坏方法吗？这种方法可能会导致 oom-killer 吗？是否有另一种方法可以在不爆炸的情况下起作用？每个向量超出范围时不应该被销毁吗？是否需要使用 new/delete 来代替？另外：用于查找内存泄漏的 valgrind 未集成在此处理器 (TI DM368) 的 sdk 中，但代码非常短且没有新语句。笔记：实际代码会检查 sql 数据库中已处理的文件，但此代码仍会导致 oom-killer，其中 sql 代码已被注释掉，因此为简单起见将其省略。文件路径格式为 /YYYYmmdd/HH/MMSS.SS.ext。

```
void getDir (string dir, vector<string> &files) {
    ...
    while ((dirp = readdir(dp)) != NULL) {
        files.push_back(string(dirp->d_name));
    closedir(dp);
    sort(files.begin(), files.end());

while (true) {
    vector<string> days;
    getDir(database_location, days);
    for (uint d=0; d<days.size(); d++) {
        vector<string> hours;
        getDir(database_location+days[d], hours);
        for (uint h=0; h<hours.size(); h++) {
            vector<string> files;
            string dir = database_location+days[d]+"/"+hours[h];
            getDir(dir, files);
            for (uint f=0; f<files.size(); f++) process(dir, files[f]); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T16:42:00.053

1.  Linux OOM 杀手是出了名的愚蠢。默认情况下，不要开始责怪自己的代码。
2.  您只有三个大小合理的向量。（如果向量大小不合理，那是因为单个目录中的文件数量也不合理）。
3.  你不需要`new/delete`。

由于您不会运行多线程，因此请考虑制作三个向量`static`。哈克，但可能只是工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:50:20.717

为了节省一些内存，您可以尝试使用[string::shrink_to_fit()](http://www.cplusplus.com/reference/string/string/shrink_to_fit/)和[vector::shrink_to_fit](http://www.cplusplus.com/reference/vector/vector/shrink_to_fit/)一旦每个字符串或向量达到其最终大小（但当然不能在此之前）。

另一件事可能是，不要`hours`先收集到向量，如果那是一个很长的向量，而是在阅读时处理每个目录条目，然后以某种方式对所有内容进行排序。

# c# - 使用 openxml 和 C# 将 Excel 嵌入到 Powerpoint 2007

> ID：14691129
> 
> 赞同：1
> 
> 时间：2013-02-04T16:35:07.753
> 
> 标签：c#, excel, charts, powerpoint, openxml

遇到两个问题，我希望有人可以提供帮助。

我正在尝试使用 openxml 以编程方式将与图表相关的 excel 2007 文件嵌入到 pptx 2007 中。我手动创建了一个包含一张幻灯片的空 PPTx，然后我做了：

```
EmbeddedPackagePart newEmbeddedPackagePart = slidePart.AddNewPart<EmbeddedPackagePart>("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","rId10");
newEmbeddedPackagePart.FeedData(File.Open(@"C:\Book1.xlsx", FileMode.Open));
Drawing.Charts.ExternalData newEmbeddedPackagePart = new DocumentFormat.OpenXml.Drawing.Charts.ExternalData();
newEmbeddedPackagePart.Id = "rId10"; 
```

这基本上是 SDK 代码反射器编写它的方式，除了二进制数据在字符串中（我在其中打开文件）之外保存。但是，这段代码在 xl\drawings\charts\embeddings\ 中放置了一个“package.bin”文件，而我的手动嵌入将文件放入 ppt\embeddings。有没有人遇到过这个问题，并找到了解决文件位置不正确以及“.bin”扩展名的方法？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T08:46:33.453

刚刚通过添加2行解决了这个问题:)

```
// Create new Embedded Package Part    
EmbeddedPackagePart embPackage = myChartPart.AddNewPart<EmbeddedPackagePart>("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "rId1"); 
// Feed imported data from an excel file into the embedded package               
embPackage.FeedData(new FileStream(@"C:\PATH_TO_FILE\data.xlsx", FileMode.Open, FileAccess.ReadWrite)); 
```

# c# - 将 CIImage 转换为 UIImage 后，AsJPEG().Save 不起作用

> ID：14691130
> 
> 赞同：0
> 
> 时间：2013-02-04T16:35:12.577
> 
> 标签：c#, xamarin.ios, crop, core-image, ciimage

我正在使用 CIImage 的 ImageByCroppingToRect 函数来裁剪最初是 UIImage 的图像。庄稼起作用了。当我执行“originalImage.AsJPEG().Save”时也可以。我已经测试并确认它保存的文件是工作 JPEG。但是当我执行“croppedImage.AsJPEG().Save”时，我在其行上收到“System.NullReferenceException：对象引用未设置为对象的实例”错误。originalImage 和croppedImage 都是UIImages，唯一的区别是croppedImage 来自一个转换后的CIImage 进行了裁剪......但是为什么会导致这个错误呢？这是一个 UIImage 所以它应该可以工作，对吧？而且我知道croppedImage 中的图像存在是因为“view.Image = croppedImage;”行

以下是源代码，此链接是包含 jpg 图像的实际项目： [https ://www.dropbox.com/s/erh0yrew8pyuye7/TestImageCrop.zip](https://www.dropbox.com/s/erh0yrew8pyuye7/TestImageCrop.zip)

```
 // Create an image from a file
        UIImage originalImage = UIImage.FromFile("IMG_0072.jpg");

        // Create a UIImageView
        UIImageView view = new UIImageView(new RectangleF(0,0,300,300));
        this.View.AddSubview(view);

        // Crop the image using CIImage's ImageByCroppingToRect function
        CIImage testCIImage = new CIImage(originalImage).ImageByCroppingToRect(new RectangleF(0,0,500,500));
        UIImage croppedImage = new UIImage(testCIImage);
        view.Image = croppedImage;

        // Store the image to a file
        string Path = Environment.GetFolderPath ( Environment.SpecialFolder.MyDocuments ) + "/";
        NSError err = new NSError();
        originalImage.AsJPEG().Save(Path+"originalImage.jpg", true, out err);
        // Here is where the error is happening.  If I save the originalImage as a JPEG, it works just fine.
        // But if I save the croppedImage as a JPEG, it errors out saying "System.NullReferenceException: Object reference not set to an instance of an object" 
        croppedImage.AsJPEG().Save(Path+"croppedImage.jpg", true, out err); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:43:45.703

我认为您遇到的问题是文档中的此注释：

> [如果图像没有数据或底层 CGImageRef 包含不受支持的位图格式的数据，此函数可能会返回 nil](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIKitFunctionReference/Reference/reference.html#//apple_ref/c/func/UIImageJPEGRepresentation)

我似乎记得在使用核心图像功能之前遇到过这个问题，我不知道具体是什么。使用核心图形进行裁剪可以正常工作：

```
 // crop using core graphics instead of CIImage
    SizeF newSize = new SizeF(500,500);
    UIGraphics.BeginImageContextWithOptions(size:newSize, opaque:false, scale:0.0f);
    originalImage.Draw (new RectangleF(0,0,originalImage.Size.Width,originalImage.Size.Height));
    UIImage croppedImage = UIGraphics.GetImageFromCurrentImageContext();
    UIGraphics.EndImageContext(); 
```

# django - 如何替换 django 管理添加页面

> ID：14691134
> 
> 赞同：1
> 
> 时间：2013-02-04T16:35:35.290
> 
> 标签：django, django-admin

我正在使用 Django 1.4 和 Grappelli

我需要一个与同一模型上的更改页面完全不同的管理员添加页面。不同的字段集，不同的 readonly_fields（实际上没有添加），不同的内联（实际上没有添加）。当它被提交时，我需要将它指向一个工厂函数，而不是沿着正常的创建路径。但我需要它看起来和操作起来像一个管理页面，而且我特别需要外键选择器，就像我在一个普通的管理页面上一样。

我试着和 get_readonly_fields 和朋友们混了一阵子，但 get_inline_instances 只是 1.5，我找不到另一个用于删除内联的钩子。

然后我尝试使用 get_urls 替换视图和表单，但我无法弄清楚需要进入上下文以使模板呈现。

我也尝试弄乱 get_form，但 ModelAdmin 仍然希望表单具有相同的字段。

其中之一是否朝着正确的方向前进？有人知道我需要做什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T11:06:58.407

所以最终起作用的是创建一个带有我想要显式实例化的特定字段的常规表单（而不是模型表单）。

然后我将 django.contrib.admin.options 中的 ModelAdmin.add_view 复制到我的 ModelAdmin 中，然后我对副本进行了大量修改，其中一半的代码用于内联，所以剩下的一半是保存的，我也不需要。

在剩余的位中，您至少要查找和替换字段集、只读字段、表单和标题。

最后我使用 get_urls 将添加 url 重定向到我的新视图。

这种方法的好处是进行了一些重构，它可以用于在管理员的任何地方弹出通用输入表单。

Grappelli 的一件小事，要进行自动完成和相关查找，您需要在某个对象上指定 autocomplete_lookup_fields 和/或 related_lookup_fields 并将该对象作为 model_admin 传递给 helpers.AdminForm，通常这将是您的 ModelAdmin，但它似乎没有关心对象实际上是什么，所以我把它们放在表单上并通过了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:03:03.710

您可以通过将 ModelAdmin 的 form 属性设置为您自己的表单类来覆盖管理表单。

例如参见： [https ://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.form](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.form)

```
class PersonForm(forms.ModelForm):

    class Meta:
        model = Person
        exclude = ['name']

class PersonAdmin(admin.ModelAdmin):
    exclude = ['age']
    form = PersonForm 
```

# javascript - 我的页面加载被 Chrome 状态“等待 api.mixpanel.com”冻结 - 这是什么，我该如何避免它？

> ID：14691135
> 
> 赞同：2
> 
> 时间：2013-02-04T16:35:36.670
> 
> 标签：javascript, performance, mixpanel

我现在遇到一些间歇性的互联网连接问题，结果是我的网页加载（对于我的网站）被卡住了。

下角的 Chrome 状态显示：“等待 api.mixpanel.com”

Chrome 开发者工具打不开。

发生了什么，我该如何编写 mixpanel api 调用来避免这种情况？即：我的网站仍然可以运行并且我可以访问，但 mixpanel 不是——我希望网页在这种情况下仍然可以加载。

*** 编辑：2013 年 2 月 6 日添加附加信息 ***

@raylu 我在上个月得到了我的 mixpanel javascript，所以它是最近的。我不确定如何获得 mixpanel 版本，但这里有一些片段：

我把它放在我的 html 页面的 <head> 中：

```
<!-- start Mixpanel -->
...
src=("https:"===e.location.protocol?"https:":"http:")+'//cdn.mxpnl.com/libs/mixpanel-2.2.min.js';
...
)};b.__SV=1.2}}) 
```

然后，我有我的 html 正文内容。然后，我关闭身体：

```
</body>
<script type="text/javascript">mixpanel.track('some tag');</script>

<script type="text/javascript">mixpanel.name_tag('some id');</script>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T08:36:10.717

当`mixpanel.track`被调用时，Mixpanel JS 库会触发 XHR（对于大多数浏览器）。这使它看起来像您的页面正在加载（选项卡上的微调器），直到请求完成。然而，XHR 是完全异步的，不会影响页面上任何其他 JS 的性能，因为它不会阻止任何其他 JS 运行。

唯一可能不好的情况是，如果您将回调传递给`track`：

```
mixpanel.track('some event', {'some prop': 'some value'}, function() {
    window.location = '/thanks';
}); 
```

如果您没有连接，则回调将永远不会触发。但是，只要您不依赖这种行为而只是跟踪，最坏的情况就是您会丢失一些事件。

# javafx-2 - 使用 Javafx 选择一个特定选项卡时如何执行某些操作

> ID：14691138
> 
> 赞同：18
> 
> 时间：2013-02-04T16:35:45.727
> 
> 标签：javafx-2, javafx

单击我的 tabPane 的一个选项卡时，我正在尝试做某事，我尝试过使用 Action Event 但它不起作用：

```
public void tabPressClicked (ActionEvent event){
        comboBoxPresYear.setVisible(true);
        lblPresYear.setVisible(true);
    } 
```

**[编辑]**

这样做的正确方法：

```
tabPresentation.setOnSelectionChanged(new EventHandler<Event>() {
            @Override
            public void handle(Event t) {
                if (tabPresentation.isSelected()) {
                    comboBoxPresYear.setVisible(true);
                    lblPresYear.setVisible(true);
                }
            }
        }); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-04T17:27:17.603

我不确定您要做什么/您期望什么 ActionEvent，但请尝试以下任一方法：

```
tabPane.getSelectionModel().selectedIndexProperty().addListener(new ChangeListener<Number>() {
    @Override
    public void changed(ObservableValue<? extends Number> ov, Number oldValue, Number newValue) {
        // do something...
    }
}); 
```

如果您想在选择更改时执行某些操作（任何选项卡）

或尝试：

[http://docs.oracle.com/javafx/2/api/javafx/scene/control/Tab.html#setOnSelectionChanged%28javafx.event.EventHandler%29](http://docs.oracle.com/javafx/2/api/javafx/scene/control/Tab.html#setOnSelectionChanged%28javafx.event.EventHandler%29)

对于特定的选项卡（虽然我还没有尝试过）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-10-11T05:06:52.377

你用Puce 所说的`selectedItemProperty`or那样做。`selectedIndexProperty`这里的解决方案`selectedItemProperty`我认为更好，因为你得到了选定的`Tab`项目本身

```
tabPane.getSelectionModel().selectedItemProperty().addListener(new ChangeListener<Tab>() {

    @Override
    public void changed(ObservableValue<? extends Tab> observable, Tab oldTab, Tab newTab) {
        if(newTab == tabPresentation) {
            comboBoxPresYear.setVisible(true);
            lblPresYear.setVisible(true);}
        }
    }); 
```

我假设`tabPresentation`是`Tab`对象本身。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-01-04T22:35:54.790

这不是最简单的方法吗

```
 tab.selectedProperty().addListener((observable, oldValue, newValue) -> {
        if (newValue) {
            comboBoxPresYear.setVisible(true);
            lblPresYear.setVisible(true);}
        }
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-25T00:33:36.947

导入 javafx.event.Event；导入 javafx.event.EventHandler；

```
 tab1.setOnSelectionChanged((EventHandler<Event>) t -> {
        if (tab1.isSelected()) {
            System.out.println(tab1.getText() + " is selected");
        }
    }); 
```

# apache - 将 .html 文件重定向到 .php 等效项，并且不显示任何文件的 .php 扩展名

> ID：14691139
> 
> 赞同：1
> 
> 时间：2013-02-04T16:35:48.970
> 
> 标签：apache, .htaccess, mod-rewrite, redirect

我最近将我网站上的文件扩展名从 .html 切换为 .php。因此，我想做以下事情：

1.  将 .html 文件重定向到它们的 .php 等价物

2.  从所有 url 中删除 .php 扩展名

3.  无扩展 url 应该可以工作（例如，foo.com/bar 应该显示位于 foo.com/bar.php 的页面）

这是我目前的方法，我从各种来源拼凑而成：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)\.html$ $1.php [L]
RewriteRule ^([^\.]+)$ $1.php [NC,L] 
```

我的方法至少存在三个问题：

1.  当尝试访问 foo.domain/bar.php 时，.php 扩展名仍然存在（但值得注意的是，foo.domain/bar*确实*显示了正确的 .php 页面）

2.  虽然对 .html 文件的请求*确实*显示了正确的 .php 页面，但 .html 扩展名仍然存在（我不希望显示扩展名）

3.  现在无法在 url 中不包含 index.php 的情况下访问目录（例如，foo.com/bar/ 会引发 404 错误）

很明显，我发现 mod_rewrite 真的很难。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:59:59.587

在我的头顶

```
RewriteEngine On
RewriteBase /
Options -MultiViews

# redirect /foo.html to /foo
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^\.]+)\.html$ $1 [L,R=302]

# redirect /foo.php to /foo
RewriteCond %{THE_REQUEST} \.php
RewriteRule ^([^\.]+)\.php$ $1 [L,R=302]

# rewrite /foo to /foo.php if and only if /foo.php exists
RewriteCond %{DOCUMENT_ROOT}/$1.php -f
RewriteRule ^([^\.]+)$ $1.php [NC,L] 
```

# android - Android OpenGL ES 2.0 纹理更新显示黑色

> ID：14691144
> 
> 赞同：2
> 
> 时间：2013-02-04T16:36:03.027
> 
> 标签：android, opengl-es, opengl-es-2.0, textures

我正在尝试将 XML 布局呈现到 OpenGL 表面。这工作正常，我可以在布局上做 3D 效果。但是，当我尝试更新它并再次渲染它时，它不起作用。通过玩弄和尝试不同的功能，最终结果要么是黑色对象，表面外部小部件上的图形损坏，要么是未经任何修改的原始对象。

我将视图转换为位图的代码是：

```
public static Bitmap toBitmap(final View view) {
    final Bitmap bitmap = Bitmap.createBitmap(400, 100,
            Bitmap.Config.ARGB_8888);
    final Canvas canvas = new Canvas(bitmap);
    final Paint paint = new Paint();

    view.setDrawingCacheEnabled(true);

    final int width = MeasureSpec.makeMeasureSpec(canvas.getWidth(),
            MeasureSpec.EXACTLY);
    final int height = MeasureSpec.makeMeasureSpec(canvas.getHeight(),
            MeasureSpec.EXACTLY);
    view.measure(width, height);
    view.layout(0, 0, view.getMeasuredWidth(), view.getMeasuredHeight());

    canvas.drawBitmap(view.getDrawingCache(), 0, 0, paint);

    return bitmap;
} 
```

然后，在我的对象的构造函数中，我调用：

```
public static int loadTexture(final Bitmap bitmap) {
    GLES20.glGenTextures(1, textureHandle, 0);

    if (textureHandle[0] != 0) {
        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textureHandle[0]);
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D,
                GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST);
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D,
                GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_NEAREST);
        GLUtils.texImage2D(GLES20.GL_TEXTURE_2D, 0, bitmap, 0);

        bitmap.recycle();
    }

    if (textureHandle[0] == 0) {
        throw new RuntimeException("Error loading texture.");
    }

    return textureHandle[0];
} 
```

`loadTexture()`使用更新的布局再次调用该方法会将其呈现为黑色。我写了另一个小方法来尝试不同的方法：

```
public static int updateTexture(final Bitmap bitmap) {
    GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textureHandle[0]);
    GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D,
            GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST);
    GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D,
            GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_NEAREST);

    GLUtils.texSubImage2D(GLES20.GL_TEXTURE_2D, 0, 0, 0, bitmap);
    //GLUtils.texImage2D(GLES20.GL_TEXTURE_2D, 0, bitmap, 0);
    // GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, 0);

    return textureHandle[0];
} 
```

这使原始纹理保持不变，并产生错误：

```
<qgl2DrvAPI_glTexSubImage2D:502>: GL_INVALID_VALUE
glStartTilingQCOM: 0x501 
```

评论`texSubImage2D()`调用并将其替换为`texImage2D()`不执行任何操作，并且不会产生错误消息。

如果有人可以阐明我可能做错了什么，那将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:52:00.460

您是从 OpenGL 线程调用更新方法吗？如果您使用的是 texSubImage 函数，则无需再次指定纹理参数。

# svn - 将本地目录变成 svn repo

> ID：14691145
> 
> 赞同：1
> 
> 时间：2013-02-04T16:36:03.847
> 
> 标签：svn

我找到了这个教程： http: [//masstransmit.com/garage_blog/create-svn-existing-project/](http://masstransmit.com/garage_blog/create-svn-existing-project/)

但我卡在第 3 步

我所做的是：

1.  `svnadmin create /root/cinnamon-for-crux`
2.  `svn import /root/cinnamon file:///root/cinnamon-for-crux`

现在第 3 步应该按照教程进行：`svn co /root/cinnamon-for-crux`. 但后来我收到一条消息错误的论点。

谁能告诉我如何使这项工作如此 cinnamon-for-crux 将成为一个包含所有数据和 cinnamon 内容的 svn 存储库？

编辑1：所以`svn co file:///cinnamon-for-crux`应该工作

编辑 2：如果我从编辑 1 执行命令，`svn co file://cinnamon-for-crux`我会看到以下错误消息：

```
svn: E1800001: Unable to connect to a repo at url 'file:///cinnamon-for-crux' 
svn : E1800001 : Unable to open a ra-local session to URL
svn: E1800001: Unable to open repo at url 'file:///cinnamon-for-crux 
```

编辑3：它有效。谁能告诉我将本地树上传到我在 googlecode 上的页面的命令是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T16:44:46.487

存储库路径始终是 URL。你需要使用`file:///root/cinnamon-for-crux`.

# java - Android YouTube API - 无缓冲处理方向变化

> ID：14691146
> 
> 赞同：2
> 
> 时间：2013-02-04T16:36:05.870
> 
> 标签：java, android, youtube-api, buffer, android-youtube-api

我正在使用 Android YouTube API 以纵向模式显示视频。播放视频并将设备转为横向模式后，视频会从停止的位置继续播放，但会重新缓冲。我正在寻找如何避免重新缓冲的解决方案。

我知道这是可能的，因为谷歌[在这里](https://developers.google.com/youtube/android/player/sample-applications)提供了一个例子，它完美地工作，除了我似乎无法让它与我的应用程序一起工作。我不确定要覆盖哪些函数以及哪些函数实际上删除了重新缓​​冲。

编辑：这是 ListView 中单元格的完整 xml；YouTubePlayerView 在最后一个 TextView 之后以编程方式添加。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/youtube_ll"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/background_shape"
    android:orientation="vertical" >

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:background="@drawable/header_background"
        android:weightSum="2" >

        <TextView
            android:id="@+id/youtube_username_tv"
            android:layout_width="0px"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:gravity="top|left"
            android:paddingLeft="15dp"
            android:paddingTop="8dp"
            android:paddingBottom="5dp"
            android:textColor="@android:color/darker_gray"
            android:textSize="13sp" />

        <TextView
            android:id="@+id/youtube_when_tv"
            android:layout_width="0px"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:gravity="top|right"
            android:paddingRight="15dp"
            android:paddingTop="8dp"
            android:paddingBottom="5dp"
            android:textColor="@android:color/darker_gray"
            android:textSize="13sp" />
    </LinearLayout>

    <TextView
        android:id="@+id/youtube_content_tv"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:paddingLeft="20dp"
        android:paddingRight="17dp"
        android:paddingTop="8dp"
        android:paddingBottom="15dp"
        android:textSize="15sp" />

</LinearLayout> 
```

我知道在java中你需要覆盖“onConfigurationChanged(Configuration newConfig)”，也许还需要覆盖“onFullscreen(boolean isFullscreen)”，但是你究竟如何在不重新缓冲的情况下“增长”youtube视图？我尝试使用全屏示例中的代码，但它似乎不适合我。这是播放器本身：

```
public class YouTubeParser extends YouTubeBaseActivity implements YouTubePlayer.OnInitializedListener, YouTubePlayer.PlayerStateChangeListener, YouTubePlayer.OnFullscreenListener {

    private static final int RECOVERY_DIALOG_REQUEST = 1;
    private String youtubeUrl;
    private com.google.android.youtube.player.YouTubePlayerView youtube;
    private YouTubePlayer player;
    private Context mContext;
    private boolean fullscreen;

    private static final int PORTRAIT_ORIENTATION = Build.VERSION.SDK_INT < 9
            ? ActivityInfo.SCREEN_ORIENTATION_PORTRAIT
                    : ActivityInfo.SCREEN_ORIENTATION_SENSOR_PORTRAIT;

    public YouTubeParser(View v, Context context, Post post, String lastUrl) {
        this.mContext = context;
        youtubeUrl = post.getYoutubeUrl();
        TextView username = (TextView) v.findViewById(R.id.youtube_username_tv);
        TextView when = (TextView) v.findViewById(R.id.youtube_when_tv);
        TextView content = (TextView) v.findViewById(R.id.youtube_content_tv);

        if (username != null)
            username.setText(post.getUsername());
        if (when != null)
            when.setText(post.getWhen());
        if (content != null) {
            content.setText(Html.fromHtml(post.getContent()));
            content.setMovementMethod(LinkMovementMethod.getInstance());
        }
        if (lastUrl != youtubeUrl) {
            youtube = new com.google.android.youtube.player.YouTubePlayerView(context);
            LinearLayout.LayoutParams params = new LinearLayout.LayoutParams((int) LayoutParams.MATCH_PARENT, (int) LayoutParams.WRAP_CONTENT);
            youtube.setLayoutParams(params);

            LinearLayout ll = (LinearLayout) v.findViewById(R.id.youtube_ll);
            if (ll.getChildCount() == 4)
                ll.removeViewAt(2);
            ll.addView(youtube, 2);
        }
        if (youtube != null) {
            youtube.initialize(DeveloperKey.DEVELOPER_KEY, this);
        }
    }

    @Override
    public void onInitializationFailure(YouTubePlayer.Provider provider, YouTubeInitializationResult errorReason) {
        if (errorReason.isUserRecoverableError()) {
            errorReason.getErrorDialog(this, RECOVERY_DIALOG_REQUEST).show();
        } else {
            String errorMessage = String.format(getString(0), errorReason.toString());
            Toast.makeText(this, errorMessage, Toast.LENGTH_LONG).show();
        }
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        if (requestCode == RECOVERY_DIALOG_REQUEST) {
            // Retry initialization if user performed a recovery action
            getYouTubePlayerProvider().initialize(DeveloperKey.DEVELOPER_KEY, this);
        }
    }

    @Override
    public void onInitializationSuccess(YouTubePlayer.Provider provider, YouTubePlayer player, boolean wasRestored) {
        this.player = player;
        player.setPlayerStateChangeListener(this);
        if (!wasRestored) {
            player.cueVideo(youtubeUrl);
            Log.i("Position", "video cued: " + youtubeUrl);
        }
    }

    protected YouTubePlayer.Provider getYouTubePlayerProvider() {
        return youtube;
    }

    public void setNoLandscape() {
        if (player != null) {
            int controlFlags = player.getFullscreenControlFlags();
            controlFlags &= ~YouTubePlayer.FULLSCREEN_FLAG_ALWAYS_FULLSCREEN_IN_LANDSCAPE;
            player.setFullscreenControlFlags(controlFlags);
            if (mContext.getResources().getConfiguration().orientation == Configuration.ORIENTATION_PORTRAIT)
                player.pause();
        }
    }

    public void setToLandscape() {
        if (player != null) {
            int controlFlags = player.getFullscreenControlFlags();
            controlFlags |= YouTubePlayer.FULLSCREEN_FLAG_ALWAYS_FULLSCREEN_IN_LANDSCAPE;
            player.setFullscreenControlFlags(controlFlags);
        }
    }

    @Override
    public void onAdStarted() {
    }

    @Override
    public void onError(ErrorReason arg0) {
    }

    @Override
    public void onLoaded(String arg0) {
    }

    @Override
    public void onLoading() {
    }

    @Override
    public void onVideoEnded() {
        setNoLandscape();
    }

    @Override
    public void onVideoStarted() {
        int controlFlags = player.getFullscreenControlFlags();
        controlFlags |= YouTubePlayer.FULLSCREEN_FLAG_ALWAYS_FULLSCREEN_IN_LANDSCAPE;
        player.setFullscreenControlFlags(controlFlags);
    }

    @Override
    public void onFullscreen(boolean isFullscreen) {
        fullscreen = isFullscreen;
        doLayout();

    }

    private void doLayout() {
        LinearLayout.LayoutParams playerParams =
                (LinearLayout.LayoutParams) youtube.getLayoutParams();
        if (fullscreen) {
            // When in fullscreen, the visibility of all other views than the player should be set to
            // GONE and the player should be laid out across the whole screen.
            playerParams.width = LayoutParams.MATCH_PARENT;
            playerParams.height = LayoutParams.MATCH_PARENT;

        } else {
            if (getResources().getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE) {
                playerParams.width = 0;
                playerParams.height = WRAP_CONTENT;
                playerParams.weight = 1;
            } else {
                playerParams.width = MATCH_PARENT;
                playerParams.height = WRAP_CONTENT;
                playerParams.weight = 0;
            }
        }
    }

    @Override
    public void onConfigurationChanged(Configuration newConfig) {
        super.onConfigurationChanged(newConfig);
        doLayout();
    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-09-25T22:39:52.450

通过将 configChanges 添加到您的 android 清单中：

```
<activity android:name=".InfoActivity"
        android:configChanges="keyboardHidden|orientation|screenSize"
        android:label="@string/app_name" >
</activity> 
```

简单地解决我的问题：

*   再次开始缓冲
*   重新从头开始

当屏幕旋转时。

干杯。

# android - Android 遇到 CAudioPlayer 的未知 AudioTrack 事件 5

> ID：14691150
> 
> 赞同：1
> 
> 时间：2013-02-04T16:36:19.673
> 
> 标签：android, audiotrack, opensl

我正在使用 OpenSL 在 Android 上播放声音。我不断收到此错误：遇到 CAudioPlayer 的未知 AudioTrack 事件 5。根据 android_AudioPlayer.cpp，这不应该发生，因为值 5 (EVENT_BUFFER_END) 不被视为错误。我使用安卓 4.1.1。

# html - CSS - 未使用元素的样式？

> ID：14691153
> 
> 赞同：0
> 
> 时间：2013-02-04T16:36:28.277
> 
> 标签：html, css, stylesheet, maintainability

我是否应该在我的样式表中包含甚至在我的页面上没有使用的元素的“默认”样式？

例如，当我只使用`h1`, `h2`, `h3`and`h4`时，我真的需要为`h5`and添加样式`h6`吗？或者当我在我的网页上不使用表格时，是否需要为此添加基本样式？

当然可以说“以防万一……”，但另一方面，所有数据都必须传输。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T16:39:51.097

我认为这是一个问题，您是否确定它们永远不会被使用。您是否在一个包含您不亲自控制的 CMS 和标记的网站上工作？你能确定在任何情况下都没有人会使用 h5 吗？

如果它是一个只有你会编辑的静态网站，那么他们无论如何都知道你在使用什么，你没有使用什么，并且你可能会在发布之前仔细预览任何更改，所以我看不到通过删除你根本不使用的东西来保持你的 CSS 更精简是有害的。

但是，如果您不确定，我认为添加几行来覆盖它以防万一的开销是最小的，真的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:38:40.280

是和否。您可以使用规范化类型 css 将所有元素重置为基本级别。但除此之外，创建好的部分，以便当您需要添加 h6 时，您或继承您的文件的任何人都可以轻松找到合适的位置。

[http://necolas.github.com/normalize.css/](http://necolas.github.com/normalize.css/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T16:41:08.657

如果您不设置它们，您将依赖浏览器对此类元素的默认呈现。

Here you can find the most common CSS reset scripts (so you're sure to have a consistent rendering on every browser): [http://www.cssreset.com/](http://www.cssreset.com/)

# udp - 流式传输音频时的 UDP 数据包大小/延迟权衡？

> ID：14691158
> 
> 赞同：1
> 
> 时间：2013-02-04T16:36:36.287
> 
> 标签：udp, audio-streaming

我正在构建一个通过 udp 在线流式传输实时音频的应用程序，我希望最大限度地减少延迟。音频以其生成的形式发送，这意味着生成一秒钟的音频需要一秒钟，它不能以比音频速率更快的速度发送。

我最初的想法是发送压缩音频的小数据包，以便客户端可以尽快开始播放。使用 Opus 编解码器，我应该能够发送小至 5 毫秒的音频数据包（最小为 2.5 毫秒），这意味着用户可以很快开始播放，比如说在发送了 2 个这样的数据包之后。

然而，当使用如此小的数据包大小时，会有很多带宽开销。假设每个 5ms 的音频包是 35 个字节，ip 和 udp 标头总共占 28 个字节，这是很多额外的数据。

我的问题是，有没有办法发送具有较大数据包大小但延迟低的实时音频？例如，是否可以在我的应用程序正在生成数据时开始发送数据（部分 udp 数据包），还是必须等待整个数据包的有效负载生成？（以字节为单位的长度会提前知道）。

如果是这样，我可以使用更大的数据包，但可以更快地开始传输数据。

还是网络抖动可能太大以至于我必须缓冲超过 5 毫秒？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T04:52:26.020

您肯定会缓冲超过 5 毫秒。5ms 是一个极低的缓冲，即使对于播放声卡本身也是如此。只有带有特殊驱动程序（如 ASIO）的声音设备才能达到如此低的水平，而且几乎与它们一样低。您是否通过您自己的 LAN 发送这些数据包，您可以在其中控制和优先发送？这是真正保证性能的唯一方法。有专门为此构建的第 2 层协议，例如 Ethersound。这取决于您正在构建什么以及您的要求是什么。

网络软件的常见缓冲区大小约为 1400-1500 字节，这接近于[您可以通过典型以太网网络发送每个数据包的最大值](https://stackoverflow.com/a/3074427/362536)。这是我为您的应用程序推荐的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T06:23:36.587

我建议您最多使用 534 个字节。如果您想避免碎片化以及因此可能导致的数据丢失，这就是限制。

# apache-pig - 带有 -tagsource 选项的 PIG 行为怪异

> ID：14691162
> 
> 赞同：1
> 
> 时间：2013-02-04T16:36:41.903
> 
> 标签：apache-pig

我在加载输入数据时使用 -tagsource 选项以识别输入源。看来，后来虽然我只从输入元组中投影选定的字段，但有一些假设，并且某些字段一直被投影，尽管我试图忽略它们。

看看我的脚本。

> rawdata = load 'data/201212*' using PigStorage(' ', '-tagsource') as (filename:chararray, ts: int, ip: chararray, domain: chararray, answer: chararray);
> 
> A = foreach rawdata generate ts, ip, domain, answer, CONCAT(CONCAT(filename, '_'), UPPER(SUBSTRING(domain, 0, 1))) as domain_index, filename as filename;
> 
> B = foreach A 生成 ip 为 ip, SUBSTRING(domain, 0, 1) 为 domain_first_char, 文件名；
> 
> 转储 A；
> 
> 转储 B；
> 
> 说明 B；

在创建 B 时，我试图仅包含 A 中的选定字段。但是，如果我转储 B，则“ts”字段（A 中的第一个字段）会继续出现在 B 中。但是在 ILLUSTRATE B 中，一切看起来都像预期的那样好。

> A的转储：
> 
> (100,123.98.11.123,google.com,{(google)},20121201_G,20121201)
> 
> (95,500.98.11.123,yahoo.com,{(yahoo)},20121201_Y,20121201)
> 
> (107,123.98.11.123,google.com,{(google)},20121201_G,20121201)
> 
> (156,123.98.11.123,cnn.com,{(cnn)},20121201_C,20121201)
> 
> B的转储：
> 
> (100,g,20121201)
> 
> (95,y,20121201)
> 
> (107,g,20121201)
> 
> (156,c,20121201)

说明 B：

> 乙| ip:chararray | domain_first_char:chararray | 文件名：字符数组
> 
> | 123.98.11.123 | 克 | 20121202

如 Dump B 所示，它不是将 ip 值打印为第一个字段（如图 B 所示），而是打印 ts 字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T21:06:12.417

在互联网上搜索，我发现这是 PigStorage 中的一个错误，并找到了解决方法。

使用 flag 启动 pig`-t ColumnMapKeyPrune`有助于解决此问题，即使用 command 启动 pig `pig -x local -t ColumnMapKeyPrune sample.pig`。

感谢猪用户组的[Rereemiah Rounds](http://mail-archives.apache.org/mod_mbox/pig-user/201208.mbox/%3CCAOjnRsY99p1+z2W10Zp6UjOPGjU-MGNjgfU0eMjoBRqG0ojoOQ@mail.gmail.com%3E)。

# osgi - OSGi 包中的 Java Web 应用程序过滤器的等价物是什么？

> ID：14691163
> 
> 赞同：4
> 
> 时间：2013-02-04T16:36:45.290
> 
> 标签：osgi, security

我们的应用程序由多个 OSGi 包组成，它们通过 RESTful URI 公开其功能。保护这些 URI 的最佳方法是什么，以便只有登录和授权的用户才能访问它们？对于普通的 Web 应用程序，我会使用 Web 过滤器来控制对所有这些 URI 的访问。有没有一种方法可以只使用一个安全过滤器（或等效的）来保护 OSGi 中所有这些 URI 的访问？或者，我是否需要在每个 OSGi 捆绑包中包含安全过滤器？如果重要的话，我们使用的容器是 Apache Karaf。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T17:18:18.463

[Apache Felix Http Jetty](https://www.jpm4j.org/#/p/org.apache.felix/org.apache.felix.http.jetty/)服务包括一个过滤器工具。最简单的使用方法是安装[Apache Felix Http Whiteboard](https://www.jpm4j.org/#/p/org.apache.felix/org.apache.felix.http.whiteboard/)包，然后注册一个过滤器服务......

不幸的是，这还没有在 OSGi 规范中，但可能会成为下一轮规范的一部分。6 个月来，我一直在使用这个模型来满足你的安全类型，它就像一个魅力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T06:31:10.967

另一个支持这一点的白板扩展器是 Pax-Web。但不仅是白板，如果与 std. OSGi http-service 它支持过滤器和 JSP。从 2.0 版开始，它还支持 servlet 3.0 注释。Pax-Web 的下一个版本也将仅支持 Jar 中没有 web.xml 的带注释的 Servlet。有关更多信息，请查看[http://team.ops4j.org/wiki/display/paxweb/Pax+Web](http://team.ops4j.org/wiki/display/paxweb/Pax+Web)

# vb.net - 想从数组列表中选择一个随机数

> ID：14691164
> 
> 赞同：1
> 
> 时间：2013-02-04T16:36:53.693
> 
> 标签：vb.net, arraylist

必须从数组列表中选择一个随机数，以从数据库中生成正确的信息，此时它在 rnd 行上的窃听

```
 Dim rn As New List(Of Integer)
    Dim QPass As String
    rn.Add(71)
    rn.Add(72)
    rn.Add(79)
    rn.Add(80)
    Dim index As Integer = CInt(Math.Floor(Rnd() * 4))
    Dim randomValue As Integer = CInt(rn(index))
    QPass = randomValue.ToString()
    Session("Pt2") = rn
    PT2imgImage.ImageUrl = "showImage.ashx?i=" + QPass
    PT2imgImage.Width = Unit.Pixel(600) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T16:41:00.217

这里

```
rn = rn(Rnd() * 4) 
```

您试图将一个整数（从 ArrayList 中选择的值）放入声明为 ArrayList 的变量中。那是行不通的。使用新变量：

```
Dim index As Integer = CInt(Math.Floor(Rnd() * 4))
Dim randomValue As Integer = CInt(rn(index))

QPass = randomValue.ToString()
Session("Pt2") = randomValue 
```

`CInt(Math.Floor(...))`确保从返回的浮点值`Rnd() * 4`正确向下舍入并转换为整数，然后可用于索引数组列表。最终，您可能希望用更 .NET 的方式替换它以获取随机数（例如[`Random.Next`](http://msdn.microsoft.com/en-us/library/2dx6wyd4.aspx)）。`Rnd`主要是为了向后兼容。

`CInt`around是必需的`rn(index)`，因为您使用旧的、无类型`ArrayList`的而不是新的、闪亮的、强类型的`List(Of Integer)`. 如果您使用后者，您可以删除外部`CInt`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T15:14:21.070

```
 Dim rn As New List(Of Integer)
    Dim QPass As String
    Dim rnd As New Random
    rn.Add(7)
    rn.Add(8)
    rn.Add(15)
    rn.Add(16)
    Dim randomValue As Integer = rn(Rnd.Next(0, 4))
    QPass = randomValue.ToString() 
```

以为我会按照建议使用较新的样式

# c++ - SDL 中的调度事件

> ID：14691166
> 
> 赞同：0
> 
> 时间：2013-02-04T16:37:02.087
> 
> 标签：c++, events, sdl

也许我只是在[docs](http://www.libsdl.org/intro.en/usingevents.html)中遗漏了一些东西，但我不知道如何从不同的程序线程为应用程序分派事件。
我的伪代码：

```
void main() {
   SDL_init();
   createThread(&secondThread);
   while(!quit) {
     /*EVENT HANDLER*/
     SDL_Event event;
     SDL_WaitEvent(&event);
     switch(event.type) {
         /*manage events*/
     }
   }
   SDL_Quit();
}
void secondThread() {
   char output[255];
   readSocket(output);  //Blocking function
   if(output=="EXIT")
      SDL_dispatchEvent(SDL_QUIT);
   return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T16:39:12.987

听起来您正在寻找[`SDL_PushEvent()`](http://wiki.libsdl.org/moin.cgi/SDL_PushEvent).

它甚至被记录为线程安全的，这当然不是许多库通常可以假设的。

# sap - 如何通过 URL 传递包含括号的参数值

> ID：14691169
> 
> 赞同：1
> 
> 时间：2013-02-04T16:37:11.793
> 
> 标签：sap, crystal-reports-2008, business-objects, opendocument

我正在尝试通过 URL 传递参数值，它适用于大多数值，除非该值包含括号。我已经尝试使用反斜杠 () 来逃避它们，但它似乎不起作用。

这是网址

```
http://<server>/OpenDocument/opendoc/openDocument.aspx?sViewer=html&sDocName=<DocName>&sType=rpt&promptex-<ParamName>=VALUE_CONTAINING_(PARENTHESIS) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:24:17.887

我发现该值可以用引号引起来，然后进行 URI 转义。

网址变成

```
http://<server>/OpenDocument/opendoc/openDocument.aspx?sViewer=html&sDocName=<DocName>&sType=rpt&promptex-<ParamName>=URI_ESCAPE("VALUE_CONTAINING_(PARENTHESIS)") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:01:19.433

您正在寻找的是 URL 编码。括号将不是您唯一的问题。因此，对于完整的答案，我建议查看可用的表格[http://www.w3schools.com/tags/ref_urlencode.asp](http://www.w3schools.com/tags/ref_urlencode.asp)

对于您的具体答案：
( = %28
) = %29

&promptex-=VALUE_CONTAINING_(PARENTHESIS) 变为 &promptex-=VALUE_CONTAINING_%28PARENTHESIS%29

然后这将被 servlet 引擎取消编码。

# android - 从 MapView 拨打电话

> ID：14691171
> 
> 赞同：-1
> 
> 时间：2013-02-04T16:37:14.583
> 
> 标签：android, android-mapview, itemizedoverlay, phone-call

当我单击警报对话框按钮时，我正在尝试拨打电话，此警报对话框附加到每个地理点的地图视图。我想我在这里做错了这是我的logcat：

```
02-04 16:21:22.578: E/AndroidRuntime(432): FATAL EXCEPTION: main
02-04 16:21:22.578: E/AndroidRuntime(432): java.lang.NullPointerException
02-04 16:21:22.578: E/AndroidRuntime(432):  at fsg.mpssri.MEGAMAG.ListItimizedOverlay$CallMeclass.access$0(ListItimizedOverlay.java:88)
02-04 16:21:22.578: E/AndroidRuntime(432):  at fsg.mpssri.MEGAMAG.ListItimizedOverlay$1.onClick(ListItimizedOverlay.java:66)
02-04 16:21:22.578: E/AndroidRuntime(432):  at com.android.internal.app.AlertController$ButtonHandler.handleMessage(AlertController.java:159)
02-04 16:21:22.578: E/AndroidRuntime(432):  at android.os.Handler.dispatchMessage(Handler.java:99)
02-04 16:21:22.578: E/AndroidRuntime(432):  at android.os.Looper.loop(Looper.java:130)
02-04 16:21:22.578: E/AndroidRuntime(432):  at android.app.ActivityThread.main(ActivityThread.java:3683)
02-04 16:21:22.578: E/AndroidRuntime(432):  at java.lang.reflect.Method.invokeNative(Native Method)
02-04 16:21:22.578: E/AndroidRuntime(432):  at java.lang.reflect.Method.invoke(Method.java:507)
02-04 16:21:22.578: E/AndroidRuntime(432):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
02-04 16:21:22.578: E/AndroidRuntime(432):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
02-04 16:21:22.578: E/AndroidRuntime(432):  at dalvik.system.NativeStart.main(Native Method) 
```

这里是我的 ListItimizedOverlay 类的代码

```
package fsg.mpssri.MEGAMAG;

import java.util.ArrayList;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.DialogInterface.OnClickListener;
import android.content.Intent;
import android.graphics.drawable.Drawable;
import android.net.Uri;
import android.widget.Toast;

import com.google.android.maps.ItemizedOverlay;
import com.google.android.maps.OverlayItem;

public class ListItimizedOverlay extends ItemizedOverlay<OverlayItem> {

    public CallMeclass clme;
    public String phoneNum = "55-223-014";
    public GeoloMe geololome; 
    private Context context;
    private ArrayList<OverlayItem> arrayListOverlayItem = new ArrayList<OverlayItem>();
    public ListItimizedOverlay(Drawable defaultMarker) {
        // TODO Auto-generated constructor stub

        super(boundCenterBottom(defaultMarker));
    }

    public ListItimizedOverlay(Drawable defaultMarker, Context pContext) 
    {
      super(boundCenterBottom(defaultMarker));
      this.context = pContext;
    }

    @Override
    protected OverlayItem createItem(int i) {
        // TODO Auto-generated method stub
        return arrayListOverlayItem.get(i);
    }

    @Override
    public int size() {
        // TODO Auto-generated method stub
        return arrayListOverlayItem.size();
    }

    @Override
    protected boolean onTap(int index) {
        // TODO Auto-generated method stub
        OverlayItem item = arrayListOverlayItem.get(index);
          AlertDialog.Builder dialog = new AlertDialog.Builder(context);
          dialog.setIcon(R.drawable.icon__telephone);
          dialog.setTitle(item.getTitle());
          dialog.setMessage(item.getSnippet());
           //phoneNum = item.getSnippet();
          dialog.setPositiveButton("call us", new OnClickListener() {

            @Override
            public void onClick(DialogInterface dialog, int which) {
                // TODO Auto-generated method stub
                //geololome.makeUrcall(phoneNum);
                Toast.makeText(context, "azerty", Toast.LENGTH_SHORT);

              clme.goCallMe(phoneNum);

            }

        });
          dialog.show();
          return true;
    }

    public void addOverlayItem(OverlayItem overlay) 
    {
        arrayListOverlayItem.add(overlay);
        populate();
    }

private class CallMeclass extends Activity{

    private void goCallMe(String phonenumber ) {
        // TODO Auto-generated method stub
        Intent i = new
                Intent(android.content.Intent.ACTION_CALL,
                        Uri.parse(phonenumber));
        startActivity(i);
    }
}

} 
```

希望朋友们能帮帮我 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T16:42:52.857

您没有`clme`在任何地方实例化。这就是您获得 NPE 的原因。

在`clme = new CallMeclass();`调用方法之前先做。

这里不需要 CallMeclass。您可以直接从您的点击处理程序触发意图。

# python - 如何更新 0.0.0.0:5000 以在工头、ubuntu 上显示 app.py 的更改

> ID：14691183
> 
> 赞同：1
> 
> 时间：2013-02-04T16:37:56.367
> 
> 标签：python, ubuntu, heroku, localhost, foreman

因此，我正在使用`heroku`开发人员学习绳索，`ubuntu`并且在使用 PHP 时遇到了一些对我来说完全自动的事情。

您如何刷新本地主机以查看您对文件所做的更新，即`app.py`？

这是应用程序代码：

```
import os
from flask import Flask

app = Flask(__name__)

@app.route('/')
def hello():
    return 'Hello World!'

if __name__ == '__main__':
    # Bind to PORT if defined, otherwise default to 5000.
    port = int(os.environ.get('PORT', 5000))
    app.run(host='0.0.0.0', port=port) 
```

一旦我使用 启动工头`$ foreman start`，它就会运行；但是，一旦我进行了一些更改，例如在返回字符串中添加一些随机字母，我在刷新后看到`0.0.0.0:5000`的内容与我在启动工头后看到的内容相同。

我如何才能开始看到我所做的更改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:43:13.610

查看[快速入门指南](http://flask.pocoo.org/docs/quickstart/)。您需要以调试模式运行服务器以监视文件更改。像这样：

```
app.run(host='0.0.0.0', port=port, debug=True) 
```

# wpf - 从 wpf 数据网格中获取选定的单元格值

> ID：14691185
> 
> 赞同：1
> 
> 时间：2013-02-04T16:38:03.540
> 
> 标签：wpf, datagrid, cell

我正在尝试从 WPF 表单上的 DataGrid 获取单元格值。

下面的代码循环遍历行就好了。

```
for (int i = 0; i < dataGrid.Items.Count; i++)
{
    DataGridRow row = (DataGridRow)dataGrid.ItemContainerGenerator.ContainerFromIndex(i);
    TextBlock cellContent = dataGrid.Columns[0].GetCellContent(row) as TextBlock;
    if (cellContent != null)
    {
        object item = dataGrid.Items[i];
        dataGrid.SelectedItem = item;
        dataGrid.ScrollIntoView(item);
        row.MoveFocus(new TraversalRequest(FocusNavigationDirection.Next));
        break;
    }
} 
```

但是我有点卡住了。我只需要 Cell 值。而且我只会在我的 cellContent 值中得到 Null 。

所有其他示例都传入一个列名来选择一个值....但是我不知道他们会选择哪个单元格。所以我需要在单击时获取标题值以及单元格值......或右键单击单元格。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:39:49.937

我没有对此进行测试，但尝试将数据网格上的**SelectionUnit**属性设置为**Cell**（默认为 FullRow）

# jquery - 如何将所需的 jQuery 对象向下传递到内部对象中？

> ID：14691187
> 
> 赞同：-2
> 
> 时间：2013-02-04T16:38:13.283
> 
> 标签：jquery

```
 jQuery.fn.extend({
    fillCurrency : (function() {
        $this = jQuery(this);

        function _usd(string1) {
            $this.text("$" + parseFloat(string1).toFixed(2));

            return $this;
        }

        return {
            usd : _usd
        };
    })()
});

var text = 2;
jQuery("#total").fillCurrency.usd(text);

<p id="total"></p> 
```

尝试了几种选择，我想我现在已经接近了。现在的问题是 Object [object global] 没有方法“createDocumentFragment”。有人知道这里有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T16:58:03.853

首先，我建议在函数的参数中传递货币，`fillCurrency`然后在您的代码中出现**拼写错误**：

```
jQuery("#total").fillCurency.usd(text); 
```

应该

```
jQuery("#total").fillCurrency.usd(text); 
```

但即使你修正了你的错字，它也不会给你你想要的

这就是我的建议：

```
(function ($) {
    $.fn.fillCurrency = function (currency, value) {
        return this.each(function () {
            if (currency === "usd") {
                $(this).text(parseFloat(value).toFixed(2));
            }
        });
    }
})(jQuery);

$(function () {
    var text = 2;
    $("p#total").fillCurrency("usd", text);
}); 
```

[http://jsfiddle.net/pWcBD/](http://jsfiddle.net/pWcBD/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T14:06:14.400

我得到了解决方案：

```
jQuery.fn.extend({
Currency : function() {
        var $this = this;

        var _Fill = {
            usd : function(string) {
                $this.text("$" + parseFloat(string).toFixed(2));

                return $this;
   }
        }

        var _Get = {
            usd : function(string) {
                $this.text("$" + parseFloat(string).toFixed(2));

                return $this;
   }
        }

        return {
            Fill : _Fill,
            Get : _Get
        }
    }
}); 
```

这会将 jQuery 对象向下传递到内部对象中，例如插件。

# java - 带有 DB appender 的 Java 记录器框架

> ID：14691188
> 
> 赞同：0
> 
> 时间：2013-02-04T16:38:13.307
> 
> 标签：java, logging, log4j, log4net

我正在寻找像 log4net(c#) 这样的**java记录器框架。**

我需要一个带有附加器的记录器，例如 log4net 中的 AdoNetAppender，它可以将日志插入到自定义的表和列中。

记录器还必须具有其他附加器，例如文件附加器。

我看到 log4j 2.0 即将推出，但它似乎仍然没有 db appender。

Logback 的 DB appender 对我来说也不好，因为它使用了 3 个对其设计专有的表。

我有一个 .net 服务和一个 java 应用程序，我希望他们将日志写入数据库中的同一个表。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T16:39:37.683

log4net 基于 log4j，而不是相反。

有一个 DbAppender：

[http://logging.apache.org/log4j/companions/receivers/apidocs/org/apache/log4j/db/DBAppender.html](http://logging.apache.org/log4j/companions/receivers/apidocs/org/apache/log4j/db/DBAppender.html)

# ios - 带有文本字段删除值的自定义单元格中的 dequeueReusableCellWithIdentifier 的 iPhone 问题

> ID：14691189
> 
> 赞同：1
> 
> 时间：2013-02-04T16:38:17.143
> 
> 标签：ios, uitableview

在 UITableView 上滚动时，我的单元格文本字段值出现问题。当我向下滚动并隐藏自定义单元格时，会删除 textField 的值。dequeueReusableCellWithIdentifier 方法不起作用。我有这个：

```
- (UITableViewCell *)tableView:(UITableView *)tableView
         cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

 static NSString *SectionsTableIdentifier = @"MyCustomCell";

 MyCustomCell *cell = (MyCustomCell *) [tableView dequeueReusableCellWithIdentifier:SectionsTableIdentifier];

    if (cell == nil) {
        NSArray *objects = [[NSBundle mainBundle] loadNibNamed:@"MyCustomCell" owner:self options:nil];
        cell = [objects objectAtIndex:0];
    }

 cell.labelCustomAttribute.text= @"Attribute Name";
 cell.textFieldCustomAttribute.delegate = self;

 return cell;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T21:46:45.757

我发现在 viewDidLoad 方法中使用 tableView 注册自定义单元格更容易，然后只需使用 dequeueReusableCellWithIdentifier。如果您注册了单元格，出队方法将自动选择一个可重复使用的单元格或分配一个新的自定义单元格（如果没有可用的）。

例子：

```
-(void)viewDidLoad
{
    [super viewDidLoad];

    // Get a point to the customized table view cell for MyCustomCell
    UINib *myCustomCellNib = [UINib nibWithNibName:@"MyCustomCell" bundle:nil];
    // Register the MyCustomCell with tableview
    [[self tableView] registerNib:myCustomCellNib forCellReuseIdentifier:@"MyCustomCell"];
}

-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    static NSString *SectionsTableIdentifier = @"MyCustomCell";
    MyCustomCell *cell = [tableView dequeueReusableCellWithIdentifier:SectionsTableIdentifier];

    cell.labelCustomAttribute.text= @"Attribute Name";
    cell.textFieldCustomAttribute.delegate = self;

    return cell;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:41:50.797

通常重用标识符是在 UITableViewCell 的`initWithStyle:reuseIdentifier:`方法中分配的，您没有使用该方法，因为您正在从 Nib 加载视图。

之后不能设置此属性，因为它是只读的。

也许您可以尝试使用标准实例化单元格`initWithStyle:reuseIdentifier:`并将 Nib 中的视图添加为单元格 ContentView 的子视图...

现在，您的情况发生的是，每次表格视图需要显示一个新单元格时，您都会创建一个新单元格。显然，这是行不通的。实际上，如果您要重用单元格，您还必须将文本字段的内容存储在某个地方（最好是在您的数据源中），并在重用单元格时将其放置。如果不存储它，当单元格将被重用时，它将包含显示它的上一行的数据。

# vb.net - 由于未知原因，枚举似乎以不同的方式分支

> ID：14691195
> 
> 赞同：1
> 
> 时间：2013-02-04T16:38:54.640
> 
> 标签：vb.net, enums, boolean

*请仔细*阅读我的问题。你将看到一大堆很可能是非常糟糕的逻辑。

```
Dim num As Boolean
Select Case MyFoo
   Case MyFoo.num
      num = True
   Case Else
      num = False
End Select 
```

我的问题是：这个case语句是否有任何*可能的*方式根据环境或构建选项等进行不同的分支......我并不是说它随机分支，而是一个环境看到它总是分支到Case Else，另一个环境总是看到它分支到 Case MyFoo.num

构建选项/开关、优化规则、环境设置等...

编辑 - 假设我的对象看起来像这样：

```
Public Enum MyFoo
   word = 1
   otherword = 2
   num = 3
   blahblah = 4
End Enum 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T16:44:20.043

> 这个case语句是否有任何可能的方式根据环境或构建选项等进行不同的分支......

这将分支不同的唯一方法是，如果在您的语句中的`MyFoo`变量中存储了不同的值。`Select Case`环境不应更改分支逻辑。

话虽如此，您永远不会显示设置`MyFoo`. 根据某些环境设置，变量的设置可能不同，这可能会导致您看到这种行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:44:10.870

您可以使用条件编译

```
Dim num as boolean
#if myfoo
    Num = true
#else
    Num = false
#end if 
```

然后，您可以在该构建环境的项目选项中声明 myfoo 常量

# javascript - Chrome 没有获取选定的 html 字符串包装标签（contenteditable）

> ID：14691196
> 
> 赞同：3
> 
> 时间：2013-02-04T16:38:55.163
> 
> 标签：javascript, html, dom, contenteditable

我正在使用Tim Down 的[这个](https://stackoverflow.com/a/6668159/1491124)解决方案在 contenteditable div 中获取选定的 html，它工作正常（谢谢 Tim！）但是使用 Chrome，如果我在 html 标签的边界处选择一个 html 字符串，就像在这个图片： http: [//i.imgur.com/UiYzrcp.png](https://i.imgur.com/UiYzrcp.png?1) ?1 ：

我得到的只是纯文本（`test`在这种情况下）。

如果我将选择扩展到下一个字符（`c`例如字母），则会得到正确的 html ( `<strong>test</strong> c`)。

我可以通过选择图像中的单词来获取 Webkit 中的完整 html 吗？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T18:18:18.777

并不真地。WebKit 在将任何范围的每个边界添加到选择中时都会对其进行规范化，以使其符合 WebKit 在文档中有效选择/插入符号位置的想法。您可以更改原始函数，以便它检测包含元素内所有文本的选择的情况，并扩展选择范围以包围该元素（而不实际更改选择）。这是一个简单的示例（对于更一般的情况，您可能需要更聪明的方法，例如当文本在嵌套元素内时，检测块/内联元素等）：

演示：http: [//jsfiddle.net/btLeg/](http://jsfiddle.net/btLeg/)

代码：

```
function adjustRange(range) {
    range = range.cloneRange();

    // Expand range to encompass complete element if element's text
    // is completely selected by the range
    var container = range.commonAncestorContainer;
    var parentElement = container.nodeType == 3 ?
            container.parentNode : container;

    if (parentElement.textContent == range.toString()) {
        range.selectNode(parentElement);
    }

    return range;
}

function getSelectionHtml() {
    var html = "", sel, range;
    if (typeof window.getSelection != "undefined") {
        sel = window.getSelection();
        if (sel.rangeCount) {
            var container = document.createElement("div");
            for (var i = 0, len = sel.rangeCount; i < len; ++i) {
                range = adjustRange( sel.getRangeAt(i) );
                container.appendChild(range.cloneContents());
            }
            html = container.innerHTML;
        }
    } else if (typeof document.selection != "undefined") {
        if (document.selection.type == "Text") {
            html = document.selection.createRange().htmlText;
        }
    }
    return html;
} 
```

# paypal - 贝宝沙箱不再工作

> ID：14691204
> 
> 赞同：2
> 
> 时间：2013-02-04T16:39:13.010
> 
> 标签：paypal, paypal-ipn, paypal-sandbox

上周五一切正常，但今天我收到以下消息：

[![点击查看完整分辨率](../Images/ee0b9d9d35d101e224df3281531577fa.png)](http://img687.imageshack.us/img687/4879/screenshotfrom201302041.png).

尝试使用贝宝沙箱付款时收到的消息是：

> 我们目前无法处理您的付款，请稍后再试。对于给您带来的不便，我们深表歉意。

一整天都是这样，不知道是我的系统出了什么问题，还是paypal的沙箱出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T11:17:31.517

**来自贝宝的通知：**

> 通知：预配置帐户的沙盒问题 - 1 月 24 日

来源：[https ://www.x.com/content/notification-issues-sandbox-preconfigured-accounts-jan-24](https://www.x.com/content/notification-issues-sandbox-preconfigured-accounts-jan-24)

**解决方法：**

创建非英国预配置帐户或创建手动帐户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:51:08.657

如果一切正常，那么可能是时间搞砸了，所以请等待时间或稍后再检查:)。如果太长，请联系贝宝支持。

# jquery - JQuery 在带有类的 iframe 中找到嵌套的 ul 并将其替换

> ID：14691205
> 
> 赞同：1
> 
> 时间：2013-02-04T16:39:12.307
> 
> 标签：jquery

我有一个 iframe，里面有一个嵌套的无序列表。我想找到具有“扩展”类的嵌套 ul 并将其更改为“折叠”。

```
<iframe id='Catalog'>
  <html>
    <body>
      <ul id='items'>
        <li><ul></ul></li>
        <li><ul class='expanded'></ul></li>
        <li><ul></ul></li>
      </ul>
    </body>
  </html>
</iframe> 
```

我尝试了很多事情，但还没有完全正确。

这是我想要获得的示例：

```
$('iframe#Catalog')
            .contents()
            .find('ul#items li ul')
            .hasClass('expanded')
            .removeClass('expanded')
            .addClass('collapsed'); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T16:41:45.053

`hasClass`返回一个布尔值，它不过滤元素，您可以使用类选择器。

```
$('#Catalog')
          .contents()
          .find('ul.expanded')
          .removeClass('expanded')
          .addClass('collapsed'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:42:44.027

您的 jQuery 代码是在 iframe 中还是在 iframe 之外？如果您的代码在 iframe 之外，在容器页面上，出于安全原因，我认为您无法访问 iframe 内的 html。如果您将代码（如果可能的话）移动到 iframe 内容，那么它应该可以工作。

# html - 用于浏览器停止 url 的 ajax 和 jquery

> ID：14691206
> 
> 赞同：0
> 
> 时间：2013-02-04T16:39:24.927
> 
> 标签：html, url, jquery

我只是有一个关于如何使用 ajax 或 jquery 来控制浏览器 url 部分中的 stop(esc) 的问题。这是因为有些数据非常大，所以要等待很长时间。如果用户不想等待，他可以单击 url 中的 stop(esc)（之前是“刷新”）。用户单击停止按钮“X”然后 html 页面将执行一些事件。你能告诉我如何操纵吗？它有我可以直接使用的 API 吗？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T16:49:44.003

```
 var code = (e.keyCode ? e.keyCode : e.which);
 if(code == 13) { //Enter keycode
   //Do something
 } 
```

![在此处输入图像描述](../Images/9c19f30cfab9925e5b10940ac74860de.png)

# jquery-ui - 如何禁用可选列表的特定元素

> ID：14691214
> 
> 赞同：4
> 
> 时间：2013-02-04T16:39:56.083
> 
> 标签：jquery-ui, jquery-ui-selectable

我想禁用可选列表的*特定*元素。我可以禁用整个列表，但是当我尝试使用特定元素时，它不起作用。

```
$('#disableButton').click(function(){  

    $('#selectable li#b ').selectable('disable');
}); 
```

[http://jsfiddle.net/Komlan/RYWaZ/1/](http://jsfiddle.net/Komlan/RYWaZ/1/)

这是我的代码

```
 //reset seats
function resetSelect(){
    var options = { filter: "li.selectable" };
$( "#selectable").selectable(options);               

}
//Ajax get taken seats
$('input[name="choice"]').change(function(){
    resetSelect();
    var sc_id = $('input:radio[name=choice]:checked').val();

    $.ajax({
        url: 'seatings.php',
        data:{ sc_id:sc_id},
        type: "POST",
        dataType:'text',
        success: function(data){
             var id = data.split(",");
             for (var i=0;i<id.length -1;i++){
             alert(id[i]);
                var string = "#"+id[i];
                $(string).css("color","red");
                $('#selectable li'+string).removeClass("selectable ui-selected"); 
             }
                var options = { filter: "li.selectable" };
            $( "#selectable" ).selectable('destroy').selectable(options);                
        }

    }); 
}); 
```

总之，每次我的单选按钮组发生变化时，我都会得到一系列 id 并一个接一个地禁用它们。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-04T17:17:15.930

没有直接的方法可以做到这一点（AFAIK），但这里有一个你可以使用的小技巧（记住，这只是一个技巧，也许不是最好的）：

添加 css 类“可选”（或任何你想要的）：

```
<ol id="selectable">
  <li class="ui-widget-content selectable" id="ok"> 1</li>
  <li class="ui-widget-content selectable"> 2</li>
  <li class="ui-widget-content selectable"> 3</li>
  <li class="ui-widget-content selectable"> 4</li>
  <li class="ui-widget-content selectable"> 5</li>
  <li class="ui-widget-content selectable"> 6</li>
  <li class="ui-widget-content selectable"> 7</li>
</ol> 
```

然后在该 css 类上使用[过滤器：](http://api.jqueryui.com/selectable/#option-filter)

```
// Create a filter to only make <li> with the specified css class, selectable.
var options = { filter: "li.selectable" };
$( "#selectable" ).selectable(options);

$('#lol').click(function(){
    console.log('dsfds');

    // Remove/add (toggle) the class used in the filter on the <li> you want to remove the selectable.
    // (Also remove the ui-selected in case it's selected.)
    $('#selectable li#ok').toggleClass("selectable").removeClass("ui-selected");

    // Now destroy the selectable and re-create it with the filter again.
    // We removed the css class from a <li> used in the filter, so it won't be selectable again.
    $( "#selectable" ).selectable('destroy').selectable(options);
}); 
```

**更新：http:** [//jsfiddle.net/RYWaZ/7/](http://jsfiddle.net/RYWaZ/7/)

参考：

*   [可选择的过滤器](http://api.jqueryui.com/selectable/#option-filter)
*   [.toggleClass()](http://api.jquery.com/toggleClass/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-02-23T07:59:37.550

实际上，您现在可以实现这一点。你必须在你的项目中添加你想要的类，例如“不可选择”，并在你的过滤器选项中使用这个 css 技巧：item:not(.unselectable)

网页：

```
<ul id="selectable">
 <li class="unselectable"> 1</li>
 <li> 2</li>
 <li> 3</li>
</ul> 
```

查询：

```
$( "#selectable" ).selectable({
 filter:"li:not(.unselectable)"
}); 
```

您将能够选择 #selectable 的所有 li 子项，但具有 .unselectable 类的 li 除外。然后你只需要在必要时切换这个类。

# sql - postgres sql, date_trunc 没有额外的零

> ID：14691220
> 
> 赞同：8
> 
> 时间：2013-02-04T16:40:28.933
> 
> 标签：sql, postgresql, date, date-format

这是我的 sql 查询的摘录

```
SELECT
date_trunc(
    'day',
    to_timestamp(requests.date_created)
)AS DAY, 
```

这是我的输出 `2013-02-04 00:00:00+00`

我希望这只是 `2013-02-04`

我怎样才能得到想要的结果？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-04T16:43:58.530

请试试

```
SELECT date_trunc(...)::date; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-04T16:45:15.767

您可以使用 to_date 指定您的日期格式

```
TO_DATE(date_col, 'yyyy-mm-dd') 
```

# jquery - Jquery window.load 不工作

> ID：14691224
> 
> 赞同：0
> 
> 时间：2013-02-04T16:40:39.393
> 
> 标签：jquery

```
$("#footer_privacy_policy").click(function(){

    window.location = "aboutus.php";    

    $(window).load(function(){

              alert("window is loaded");

             $(".about").load("./about/privacy_policy.txt");
     });
}); 
```

因此，当我单击 id 时，我加载了页面“aboutus.php”，但从未弹出警报。任何人都可以帮助解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T16:43:36.053

一旦您使用 设置 url `window.location`，页面就会重新加载，因此`$(window).load()`不会发生，因为它在 click 事件回调中。

您是否有理由使用`window.location`而不是依赖`href`属性并链接到已包含内容的页面？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:44:34.433

当您设置`window.location`时，浏览器会立即导航到该页面。在该点之后不会执行当前页面上的其他代码。事实上，您在当前页面上设置的任何事件处理程序或回调都会被清除。

# algorithm - 算法设计（带约束）将二分图简化为树/森林

> ID：14691225
> 
> 赞同：1
> 
> 时间：2013-02-04T16:40:42.790
> 
> 标签：algorithm, graph, graph-algorithm

我有一个关于设计算法以使二分图无环的问题。我希望有人可以在这里帮助我。问题陈述描述如下：

考虑一个无向二分图 G = (U,V,E)，其中 U = {u_1, u_2, ...u_M} 是一组 M 个节点，V = {v_1, v_2, ..., v_N} 是一个N 个节点的集合，E 是将 U 中的节点连接到 V 中的节点的边的集合。为简单起见，假设图是连通的和循环的，即具有循环。

目的是设计一种消除循环并将图简化为树或森林的算法，如下所示。算法循环进行。一轮被描述为选择 U 中的每个节点 u_i, i = 1, 2, ..., M, 并移除与其连接的边。如果节点 u_i 是孤立的（即，它没有连接到它的边），我们将忽略它并继续。这样每轮最多删除 M 条边。当图形在某一轮结束时减少为一棵树或森林时，该算法停止。

我想知道是否有可能有一个多项式时间算法（以 M，N 为单位）来设计轮次，以使轮数最小化（用于将图形减少为树/森林）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:49:44.403

[请参阅Wikipedia](http://en.wikipedia.org/wiki/Cycle_%28graph_theory%29#Cycle_detection)上的 Cycle 文章。

要检测任何无向图中的循环，请执行 DFS，维护访问节点列表。如果检测到后边缘，则它是循环的一部分，您可以从图中删除该边缘。没有后边缘的 DFS 没有循环。复杂度为 O(M+N)。

# netbeans - 如何在 Netbeans 中禁用/自定义实时错误检查

> ID：14691230
> 
> 赞同：3
> 
> 时间：2013-02-04T16:40:51.013
> 
> 标签：netbeans

我使用 vim，在那里我做了一个键盘映射 (CTRL + L) 来开始错误检查。事实是实时错误检查有时和烦人一样有用，所以我想知道 Netbeans 中是否有类似的方法（我使用的是 7.2.1 版，用 PHP 编码）。

这是所需的行为：

*   *不要*自动检查错误；
*   有一些键映射和/或菜单操作来*手动*检查错误。

可能吗？

TIA,

# javascript - 上一个文件进度达到 100% 与停止/完成事件之间的差距大吗？

> ID：14691236
> 
> 赞同：3
> 
> 时间：2013-02-04T16:41:24.220
> 
> 标签：javascript, jquery, file-upload, blueimp

我正在使用[blueimp 文件上传插件](https://github.com/blueimp/jQuery-File-Upload)来实现一些文件上传功能，我注意到在我的最后一个文件进度条达到 100% 和停止和完成事件触发之间可能会有很大的时间间隔。我有以下代码：

```
 $('#fileupload').fileupload({
            dataType: 'json',
            progress: function (e, data) {
                var progress = parseInt(data.loaded / data.total * 100, 10);
                var bar = data.context.children().children(".progress");
                $(bar).css("width", progress + "%");
            },
            add: function (e, data) {
                data.context = $("<div></div>").html("Uploading...<div class='progressHolder'><div class='progress'>&nbsp;</div></div>").appendTo($("#files"));
                data.submit();
                $("#processing").fadeIn();
            },
            stop: function (e, data) {
                $("#uploadFiles").fadeIn();
                $("#processing").fadeOut();
            },
            done: function (e, data) {
                $.each(data.result.files, function (index, file) {
                    idArray.push(file.Id);
                });
            }
        }); 
```

有谁知道为什么会发生这种情况？我怎样才能做到这一点，以便在调用完成/停止时考虑进度条？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-04T16:52:57.280

当您上传文件时，文件首先（显然）上传到服务器，然后服务器将执行请求的服务器端脚本，然后您在其中处理文件。如果请求的*“处理文件”*部分不是即时的，则在进度达到 100% 和触发完成回调之间会有延迟。如果有网络延迟，也可能会有延迟。

progress 事件只跟踪上传的进度，而不是请求的进度。

一种解决方案是让您的进度条停在 say 处，`90%`然后`100%`在 done 回调中将其撞到。`data.total`简单地乘以`1.1`

```
 progress: function (e, data) {
            var progress = parseInt(data.loaded / (data.total*1.1) * 100, 10);
            var bar = data.context.children().children(".progress");
            $(bar).css("width", progress + "%");
        }, 
```

# c++ - 计算结构大小而不填充字节的函数

> ID：14691237
> 
> 赞同：3
> 
> 时间：2013-02-04T16:41:28.600
> 
> 标签：c++, c, struct

嗨，我想创建一个计算结构大小而不填充字节的函数。

例子 ：

```
struct test{
    int   x;
    char  y;
    int   z;
}; 
```

如果我计算上述结构的大小，我必须得到 9 个字节（即没有填充字节）

并考虑我可能不知道结构中存在的变量的情况。

例子 ：

```
struct test{
    int   x;
    ....
    ....
    ....
    int   z;
}; 
```

所以如果我计算尺寸，它应该给出正确的尺寸。

是否可以编写这样的函数？我尝试阅读结构，但我没有找到任何解决方案。我看到有一些编译器选项存在，我可以得到，但我不想要任何构建编译器选项。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T16:43:50.470

不，C 没有足够的自省来使这成为可能。在运行时，没有任何信息可供程序用来“了解”结构中的哪些字段，或者它们的类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T16:44:46.943

编译器构造应该给你“`sizeof`编译器看到的”对象的大小。大多数编译器会在 4 字节边界上对齐结构，以便以空间为代价进行有效的内存访问。尝试

```
#include <stdio.h>
int main() {
  struct test{
    int x;
    char a;
    int y;
  };
  struct test myStruct;
  printf("size of myStruct is %ld\n", sizeof(myStruct));
} 
```

当我运行它时，我得到

```
size of myStruct is 12 
```

这表明我的编译器在这种情况下为“a”分配了四个字节。我认为这就是你的答案......除非我真的误解了你的问题，特别是你的“没有填充字节”的评论。

重写 as 的定义`struct`：

```
 struct test{
    int x;
    char a;
    int y;
  }__attribute__((packed)); 
```

输出变为

```
size of myStruct is 9 
```

这仅在编译时有效 - 所以它不是真正的“函数”。如果您在编译时不知道您的结构，则它不适用。因此，我认为我的答案与上面@unwind 给出的答案并没有矛盾。

# jquery - On Scroll Animate/SlideUp div

> ID：14691238
> 
> 赞同：0
> 
> 时间：2013-02-04T16:41:36.753
> 
> 标签：jquery, html, scroll, scrollto

嗨伙计们，我整天都在谷歌上搜索，但找不到如何实现它的答案。滚动后，我希望屏幕底部的 div 位置向上滑动到该站点：

[http://www.chanel.com/en_SG/](http://www.chanel.com/en_SG/)。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T02:54:02.123

这可以通过一点 jQuery 来完成。

这是您可以使用的一些基本示例：（[http://jsfiddle.net/ujmMk/5/](http://jsfiddle.net/ujmMk/5/)）

```
$(function(){
    $(window).scroll(function(){ //onscroll
        var scrolleddown = false;//used to keep the state
        if($(window).scrollTop() > 1){ //if they've scrolled down
            if(scrolleddown == false){
                scrolleddown = true;
                $('#content').stop(true, false).animate({top:'0%'},500,function(){//show it
                    $('#topcontent').hide();//hide to original content, in this case "hi!"'s
                    $(this).css("position","relative"); //make it be able to scroll down
                });
            }
        }else{
            //below resets everything back to original state when user scrolls back up
            scrolleddown = false;
            $('#topcontent').show();
                $('#content').css("position","fixed").stop(true, false).animate({top:'99%'},500)
        }
    });
}); 
```

# javascript - 单击使用 javascript 预加载图像

> ID：14691246
> 
> 赞同：0
> 
> 时间：2013-02-04T16:41:58.953
> 
> 标签：javascript, preload

直接调用 preload 函数没有任何问题。但是当在点击时调用 preload() 时，即使在加载图像之后，也不会结束其处理，这可以在浏览器中被视为“正在加载...”

```
function preload(images) {
    if (document.images) {
        var i = 0;
        var imageArray = new Array();
        imageArray = images.split(',');
        var imageObj = new Image();
        for(i=0; i<=imageArray.length-1; i++) {
            document.write('<img src="' + imageArray[i] + '" width="335px" height="180px" alt="[Alternative text]" />');
            imageObj.src=imageArray[i];
        }
     }
}

<a href="javascript:onclick=preload('1.jpg,2.jpg');">Gallery</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T16:44:13.977

`document.write`页面加载后不能调用。如果你想在页面上添加一些东西，你必须调用像[document.createElement 这样的 DOM 操作函数（见例子）](https://developer.mozilla.org/en-US/docs/DOM/document.createElement)。

但是你在你的函数中所做的看起来不像是预加载，而是像在页面中直接插入图像。

如果要预加载图像，即要求浏览器缓存它们，以便以后立即可用，那么您最好使用`XmlHttpRequest`而不是创建`Image`元素。发出`XmlHttpRequest`请求不会使浏览器显示沙漏，并且用户不会觉得有什么事情正在发生。

上周末我为此制作了一个小型“图书馆”：轻松预加载资源。

```
var preload = (function(){
    var queue = [], nbActives = 0;
    function bip(){
        if (queue.length==0 || nbActives>=4) return;
        nbActives++;
        var req = new XMLHttpRequest(), task=queue.shift();
        req.open("GET", task.src, true);
        req.onload = function () {
            nbActives--;
            bip();
            if (task.callback) task.callback(task.src);
        };
        req.send();
    }
    return function(src, priority, callback) {
        queue[priority?'unshift':'push']({src:src, callback:callback});
        bip();
    }
})(); 
```

用法 ：

```
preload('path/to/file.png'); // preload the file

preload('path/to/file.png', true); // preload the file with high priority

preload('path/to/file.png', false, callback); // preload the file and be notified when it's finished 
```

Github 存储库：[https ://github.com/Canop/preload](https://github.com/Canop/preload)

# ios - 在 iOS 示例中拉出侧边菜单

> ID：14691249
> 
> 赞同：0
> 
> 时间：2013-02-04T16:42:01.777
> 
> 标签：ios

我见过像 Facebook 应用程序中那样的显示菜单。但这不是我想要的。我想要一个箭头，当你点击按钮时，滑动菜单应该从隐藏中滑出。

是否有任何代码示例或开源库能够做到这一点？

在这方面需要一些指导。谢谢..

例如，我有一个按钮，带有一个名为 pull me 的图像，它位于底部，当我拉动它时，菜单会出现在现有视图的顶部。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:28:40.317

要实现此功能，您需要创建一个自定义容器控制器类并使用子视图控制器对其进行实例化。子视图控制器的视图将由容器控制器使用自定义动画进行管理。

如果您构建自己的容器控制器会更好，但如果您真的需要一个库，这里有一个： http: [//www.cocoacontrols.com/controls/slide-navigation-view-controller](http://www.cocoacontrols.com/controls/slide-navigation-view-controller)

它管理在 4 个方向（上、左、下、右）中的任何一个方向上滑动主视图/根视图。

希望这可以帮助

# ruby-on-rails - 如何在 Rails 中保存通过 JSON API 发送的图像？

> ID：14691252
> 
> 赞同：0
> 
> 时间：2013-02-04T16:42:11.683
> 
> 标签：ruby-on-rails, rest, paperclip

在编写此代码之前，我想确保以正确的方式进行操作。我有一个移动应用程序，它将通过 JSON API 将图像发送到服务器，最好作为用户的属性（或任何正在成像的东西）。

我目前的想法是让移动应用程序发送以 Base64 编码的图像，这样它就可以作为文本包含在用户资源 API 调用中，如下所示：

```
PUT "/users/1", {"image":"Base64EncodedImageString", "name":"Dan"} 
```

但是我读过将图像存储在 Base64 中会使数据库太大太快。因此，我的计划是获取该字符串，以某种方式将其转换为图像（我确信它与 Paperclip gem 有关）并将其存储在服务器的文件系统中。然后，移动应用程序可以通过图像 MIME 类型 URL 直接下载这些图像，该 URL 将是一些标记在用户 JSON 上的 URL：

```
{"name":"Dan", "image_url":"http://mysite.com/images/dan.png"} 
```

这是个好主意吗？

# ios - 苹果是否允许底部的双标签栏

> ID：14691253
> 
> 赞同：2
> 
> 时间：2013-02-04T16:42:13.357
> 
> 标签：ios, ios5, ios6, uitabbarcontroller

我们正在为我们的社交媒体区域进行布局设计，想知道以下布局是否会被 Apple 拒绝？如图所示的用例是否允许底部的双 Tabbar 设计？

![双标签栏](../Images/4867fe7975a0924e67fceffb11fc6c86.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T16:47:30.583

一般来说——你不会得到关于什么会被苹果批准和不会被苹果批准的明确答案。因为这不是可以给出明确答案的东西。他们有指导方针，并在*他们*认为合适的时候应用它们。

但是 - 在这种情况下，我会说不。出于以下原因。

1.  标签栏通常应该用作应用程序的根视图。如果你有一个嵌入另一个，什么是根视图。
2.  有两个而不是一个会占用很多屏幕空间，它不像是工具栏
3.  它很丑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:47:15.017

Apple 保留拒绝任何违反其人机界面指南 (HIG) 的应用程序的权利。Stacked `UITabBar`s 违反了 HIG。话虽如此，这里不是问的地方。这里没有人能告诉你某个特定的评论者在特定的一天会做什么。

# php - 比较 40 个陈述而不写出每一个？

> ID：14691255
> 
> 赞同：0
> 
> 时间：2013-02-04T16:42:14.633
> 
> 标签：php

我必须写一个声明，让我比较某些东西的版本并返回一个特定的字母/数字。目前传递的版本格式正确（例如：如果它的版本 14 作为版本 D 传递给我，这是需要返回的）但我还需要检查它是否不是这些 40ish 结果。

例如，如果我通过了一个 99999 作为我们需要返回的版本范围之外的版本，那么我只需要返回一个 X。有没有一种简单的方法可以做到这一点而无需写出 40 个 if 语句或换壳？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T16:44:38.157

您可以轻松地为此使用数组。

```
$versions = array(
    14 => 'D',
    15 => '...',
    ...
);
if(!isset($versions[$input])) {
    $version = 'X';
}
else {
    $version = $versions[$input];
}

return $version; // Or whatever you need to do 
```

# git - 在 .gitignore 中忽略 directory/ 和 .directory/ 的简短语法？

> ID：14691262
> 
> 赞同：1
> 
> 时间：2013-02-04T16:42:56.037
> 
> 标签：git, gitignore

是否有忽略的简短语法

```
directory/
.directory/ 
```

在我的 .gitignore （行中的东西`\.?directory/`）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T16:44:11.120

不，Gitignore 使用 glob 模式，它只支持 '?' 和“*”通配符分别表示“一个任意字符”或“任意数量的任意字符”。

# ios - 生成大型 PDF 时如何降低内存攀升

> ID：14691264
> 
> 赞同：3
> 
> 时间：2013-02-04T16:43:02.993
> 
> 标签：ios, objective-c, cocoa-touch, memory-management

> **可能重复：**
> [无法在 iOS 上创建超过 400 页的 PDF 文档](https://stackoverflow.com/questions/5878538/cannot-create-pdf-document-with-400-pages-on-ios)

我的应用程序生成 PDF 文件。由于用户能够添加页面，这些 PDf 可能会很大，可能不受限制，尽管通常约为。10\. 我遇到了 iPhone 4 用户在 PDF 生成阶段遇到崩溃的问题。一些调查工作显示该应用程序在 PDF 生成阶段内存不足，我收到内存不足警告，然后最终崩溃。如果我在 iPhone 5 上添加 50 多个页面，在 iPhone 4 上添加更多页面，而不是在预期的模拟器上，我可以重现该问题。

任何人都可以建议我如何在生成 PDf 文件时减少这种强烈的内存攀升和最终崩溃。

我研究过 SO：[iPhone App 由于内存不足而崩溃，但在模拟器](https://stackoverflow.com/questions/4275323/iphone-app-crashes-due-to-low-memory-but-works-fine-in-simulator)和[Quartz PDF API 中运行良好，导致内存不足崩溃](https://stackoverflow.com/questions/3088376/quartz-pdf-api-causing-out-of-memory-crashes)

```
@interface ICPDFPreviewController ()
@property (nonatomic, strong) Certificate *certificate;
@property (nonatomic, strong) NSData *pdfData;
@property (nonatomic) BOOL viewHasUnloaded;
- (void)generatePdf;
- (void)pdfDone:(NSData *)data;
- (NSData *)createPdfWithPages:(NSArray *)pages;
@end

@implementation ICPDFPreviewController
@synthesize certificate=_certificate;
@synthesize scrollView=_scrollView;
@synthesize webView=_webView;
@synthesize pdfData=_pdfData;
@synthesize viewHasUnloaded=_viewHasUnloaded;

- (void)generatePdf
 {
 NSMutableArray *pagesArray = [NSMutableArray array];

 if ([self.certificate.certificateType.title isEqualToString:@"Minor Works"]) {
[pagesArray addObject:[[ICPDFMinorWorksPage1 alloc] initWithCertificate:self.certificate]];
[pagesArray addObject:[[ICPDFMinorWorksPage2 alloc] initWithCertificate:self.certificate]];

} else if ([self.certificate.certificateType.title isEqualToString:@"EIC"]) {
[pagesArray addObject:[[ICPDFEICPage1 alloc] initWithCertificate:self.certificate]];
[pagesArray addObject:[[ICPDFEICPage2 alloc] initWithCertificate:self.certificate]];
[pagesArray addObject:[[ICPDFEICPage3 alloc] initWithCertificate:self.certificate]];
[pagesArray addObject:[[ICPDFEICPage4 alloc] initWithCertificate:self.certificate]];
[pagesArray addObject:[[ICPDFEICPage5 alloc] initWithCertificate:self.certificate]];
[self addDistributionBoardsToPagesArray:pagesArray];
ICPDFEICPageFinal *pageFinal = [[ICPDFEICPageFinal alloc] initWithCertificate:self.certificate];
pageFinal.pageNumber.text = [NSString stringWithFormat:@"%d", pagesArray.count+1];
[pagesArray addObject:pageFinal];

} else if ([self.certificate.certificateType.title isEqualToString:@"Domestic EIC"]) {
[pagesArray addObject:[[ICPDFDomesticEICPage1 alloc] initWithCertificate:self.certificate]];
[pagesArray addObject:[[ICPDFDomesticEICPage2 alloc] initWithCertificate:self.certificate]];
[pagesArray addObject:[[ICPDFDomesticEICPage3 alloc] initWithCertificate:self.certificate]];
[pagesArray addObject:[[ICPDFDomesticEICPage4 alloc] initWithCertificate:self.certificate]];
[self addDistributionBoardsToPagesArray:pagesArray];
[pagesArray addObject:[[ICPDFDomesticEICPageFinal alloc] initWithCertificate:self.certificate]];

} else if ([self.certificate.certificateType.title isEqualToString:@"EICR"]) {
[pagesArray addObject:[[ICPDFEICRPage1 alloc] initWithCertificate:self.certificate]];
[pagesArray addObject:[[ICPDFEICRPage2 alloc] initWithCertificate:self.certificate]];
[self addObservationsToPagesArray:pagesArray];
[self addDistributionBoardsToPagesArray:pagesArray];
[pagesArray addObject:[[ICPDFEICRInspection alloc] initWithCertificate:self.certificate]];
[pagesArray addObject:[[ICPDFEICRInspectionPage1 alloc] initWithCertificate:self.certificate]];
[pagesArray addObject:[[ICPDFEICRInspectionPage2 alloc] initWithCertificate:self.certificate]];
[pagesArray addObject:[[ICPDFEICRInspectionPage3 alloc] initWithCertificate:self.certificate]];
[pagesArray addObject:[[ICPDFEICRPageFinal alloc] initWithCertificate:self.certificate]];
 }

// Set page count on all pages
int pageNumber = 0;
for (ICCertificateComponent *page in pagesArray) {
page.pageNumber.text = [NSString stringWithFormat:@"%d", ++pageNumber];
page.pageCount.text = [NSString stringWithFormat:@"%d", pagesArray.count];
}

NSData *pdfData = [self createPdfWithPages:pagesArray];
[self performSelectorOnMainThread:@selector(pdfDone:) withObject:pdfData waitUntilDone:YES];

 }

- (void)pdfDone:(NSData *)data
{
self.pdfData = data;
[self.webView loadData:self.pdfData MIMEType:@"application/pdf" textEncodingName:@"utf-8"   baseURL:nil];
[ICUtils removeProgressView];
}

- (NSData *)createPdfWithPages:(NSArray *)pages
 {
// Creates a mutable data object for updating with binary data, like a byte array
NSMutableData *pdfData = [NSMutableData data];

 ICCertificateComponent *firstPage = [pages objectAtIndex:0];

UIGraphicsBeginPDFContextToData(pdfData, firstPage.contentView.bounds, nil);

 for (int i = 0; i < pages.count; i++) {
ICCertificateComponent *thisPage = [pages objectAtIndex:i];
UIGraphicsBeginPDFPageWithInfo(thisPage.contentView.bounds, nil);
    ////////////////////////////////////////////////////////////////////
   //tried adding this after research on SO, did not stop app crash
  // CGContextSetInterpolationQuality((__bridge CGContextRef)(thisPage), kCGInterpolationHigh);    CGContextSetRenderingIntent((__bridge CGContextRef)(thisPage), kCGRenderingIntentDefault);
 /////////////////////////////////////////////////////////////////////

CGContextRef pdfContext = UIGraphicsGetCurrentContext();
[thisPage.contentView.layer renderInContext:pdfContext];
}

UIGraphicsEndPDFContext();

return pdfData;
}

- (void)addDistributionBoardsToPagesArray:(NSMutableArray *)pagesArray
{
int pageCount = pagesArray.count;
NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"createdAt"    ascending:YES];
NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:sortDescriptor, nil]; 
NSArray *boards = [self.certificate.distributionBoards   sortedArrayUsingDescriptors:sortDescriptors];
for (DistributionBoard *thisBoard in boards) {
DebugLog(@"Creating a board page");
ICPDFDistributionBoard *boardPage = [[ICPDFDistributionBoard alloc]   initWithDistributionBoard:thisBoard];
boardPage.pageNumber.text = [NSString stringWithFormat:@"%d", ++pageCount];
DebugLog(@"Page number is %d", pageCount);
[pagesArray addObject:boardPage];

NSSortDescriptor *circuitDescriptor = [[NSSortDescriptor alloc] initWithKey:@"createdAt" ascending:YES];
NSArray *circuitDescriptors = [[NSArray alloc] initWithObjects:circuitDescriptor, nil]; 
NSArray *circuits = [thisBoard.circuits sortedArrayUsingDescriptors:circuitDescriptors];

//int circuitCount = circuits.count;
ICPDFCircuitDetails *circuitDetails = boardPage.circuitDetails;

int circuitCount = 0;
for (Circuit *thisCircuit in circuits) {
    circuitCount++;
    if (circuitCount > 16) {
        // Add an extension page
        DebugLog(@"Adding an extension sheet");
        circuitCount = 1;
        ICPDFDistributionBoardExtension *boardExtension = [[ICPDFDistributionBoardExtension  alloc] initWithDistributionBoard:thisBoard];
        [pagesArray addObject:boardExtension];
        boardExtension.pageNumber.text = [NSString stringWithFormat:@"%d", ++pageCount];
        circuitDetails = boardExtension.circuitDetails;
     }
    NSString *key = [NSString stringWithFormat:@"circuitRow%d", circuitCount];
    ICCircuitRow *circuitRow = [circuitDetails valueForKey:key];
    [circuitRow populateFromCircuit:thisCircuit];
    }
  }
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T17:05:29.940

通常，内存是有限的，而您生成的输出不是，因此使其工作的方法是确保：

*   在生成 PDF 时，您不会在内存中累积整个 PDF
*   您不必为每个页面保留渲染的副产品

在您的情况下， using`UIGraphicsBeginPDFContextToData`意味着您将整个 PDF 呈现为不断扩展的 NSData。当数据变得太大时，您将被杀死。相反，尝试`UIGraphicsBeginPDFContextToFile`. 同样在渲染页面的内部循环中，考虑插入一个`@autoreleasepool { ... }`块以防止对象在长期运行期间不必要地构建。我不确定您的`pagesArray`一堆东西实际上有多大，以及您是否可以考虑在生成时一次“分页”一页。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T17:53:35.623

编辑：我认为 Ben Zotto 的解决方案是要走的路：使用`UIGraphicsBeginPDFContextToFile`.

* * *

几个月前有人问过这个问题。我写了一个内存映射数据消费者，它可能会有所帮助：

[https://gist.github.com/3748250](https://gist.github.com/3748250)

它使用内存映射的 PDF 上下文而不是普通内存。

# iphone - core data - 将数组存储到 core data 一对多关系表中

> ID：14691265
> 
> 赞同：0
> 
> 时间：2013-02-04T16:43:08.343
> 
> 标签：iphone, ios, objective-c, cocoa-touch, core-data

![在此处输入图像描述](../Images/8d77fa596dc11a1724a8c99c7bbc9246.png)

在我的联系人表中，我插入了从 iphone 通讯录中挑选的联系人的信息。

我存储联系人的姓名和号码（在第 0 个索引处）并通过此代码添加另外两个字段 twilio number 和 bool 检查。

```
AppDelegate *appDelegate =
[[UIApplication sharedApplication] delegate];

NSManagedObjectContext *context =
[appDelegate managedObjectContext];

Contacts * newContact = [NSEntityDescription
                         insertNewObjectForEntityForName:@"Contacts"
                         inManagedObjectContext:context];

newContact.name = name;
newContact.number = phone;
newContact.isEligible = isEligible;
newContact.twilionumber = tempTwilioNumber; 
```

该场景是选择所有其他电话号码（第 0 个索引除外），它们以数组的形式保存在具有电话号码属性的 ContactDetail 表中。案例是一个联系人可以有多个其他号码。

我如何将该数组插入到contactDetail表中，以针对contacts表中的一个条目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:56:07.767

您的 ContactDetail 关系应该是一对多，而不是一对一。您还需要向 ContactDetail 添加一个“索引”属性。这样，当您获取联系人实例的详细信息（详细信息将采用 NSSet 的形式）时，您可以按索引对它们进行排序

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T14:03:08.107

只需遵循代码就可以了；

```
 AppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];

  NSManagedObjectContext *context = [appDelegate managedObjectContext];

  Contacts * newContact = [NSEntityDescription
                         insertNewObjectForEntityForName:@"Contacts"
                         inManagedObjectContext:context];

newContact.name = name;
newContact.number = phone;
newContact.isEligible = isEligible;
newContact.twilionumber = tempTwilioNumber;

for (int i=1; i<otherContactNumbersArray.count; i++)
{
    ContactDetail * newContactDetail = [NSEntityDescription
                                        insertNewObjectForEntityForName:@"ContactDetail"
                                        inManagedObjectContext:context];

    newContactDetail.phoneNumber = (__bridge_transfer NSString*)ABMultiValueCopyValueAtIndex(phoneNumbers, i);
    newContactDetail.contactInfo = newContact;
}

NSError *myError;
[context save:&myError]; 
```

非常感谢三打访客，他们甚至没有费心提高问题的评分，以便我早日找到解决方案.... :)

# algorithm - Mergesort：更改分割点时计算复杂度如何变化？

> ID：14691269
> 
> 赞同：4
> 
> 时间：2013-02-04T16:43:15.880
> 
> 标签：algorithm, sorting, complexity-theory, big-o, mergesort

我必须从我的算法书中做一个练习。假设实现了一个合并排序，以将一个数组拆分为 α，α 的范围为 0.1 到 0.9。

这是计算分割点的原始方法

```
middle = fromIndex + (toIndex - fromIndex)/2; 
```

我想把它改成这样：

```
factor = 0.1; //varies in range from 0.1 to 0.9
middle = fromIndex + (toIndex - fromIndex)*factor; 
```

所以我的问题是：

1.  这会影响计算复杂度吗？
2.  对递归树深度有什么影响？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T18:00:33.637

这确实改变了实际复杂度，但不会改变渐近复杂度。

如果你考虑一下你会得到的新的递归关系，它会是

> T(1) = 1
> 
> T(n) = T(αn) + T((1 - α)n) + Θ(n)

纵观递归树，树的每一层仍有每层总共有 Θ(n) 个工作，但层数会更多。具体来说，假设 0.5 ≤ α < 1。那么在 k 次递归调用之后，递归中剩余的最小块的大小将具有大小 n α ^k。当它达到大小一时，重复停止。求解，我们得到：

> n α ^k = 1
> 
> α ^k = 1/n
> 
> k log α = -log n
> 
> k = -log n / log α
> 
> k = log n / log (1/α)

换句话说，改变 α 会改变递归深度的对数项上的常数因子。当 α = 0.5 时，上述方程最小化（因为我们受到 α ≥ 0.5 的限制），因此这将是最佳的分割方式。然而，选择其他拆分仍然会给出运行时 Θ(n log n)，尽管具有更高的常数项。

希望这可以帮助！

# javascript - 标记对象数组在 Google Maps API v3 中导致未捕获的错误

> ID：14691270
> 
> 赞同：0
> 
> 时间：2013-02-04T16:43:21.283
> 
> 标签：javascript, arrays, google-maps, object

在 php 中，我创建了一个字符串，该字符串被传输到一个 javascript 对象数组中：

```
<?php
$markers = '';
while($loc = mysql_fetch_assoc($qry)){
    $markers .= "{id:'".$loc['id']."', title:'".$loc['city']."', pos: new google.maps.LatLng(".$loc['latitude'].",".$loc['longitude'].")},";
}
?> 
```

在 javascript 中 Google Maps api 的初始化函数中：

```
<script type="text/javascript">
    <?php
    if($markers){
        echo 'var locations     = [' . rtrim($markers, ",") . ']';
        unset($markers);
    }
    ?>  

    //...

    //add old markers
    var markers = new Array();
    for (var i=0; i < locations.length; i++)
    {
        marker_stack[ locations[i].id ] = new google.maps.Marker({
            map: map,
            position: locations[i].pos,
            title: locations[i].title
        });
    }

    //...

</script> 
```

我用标记填充了一个数组，因为我以后可能需要删除其中的一些。当我这样做时，我只想使用要删除的 id 引用 marker_stack 数组。

我从上面的代码中得到的错误信息在谷歌服务器上的一个 js 文件中：

```
Uncaught Error: Ungültiger Wert für Bauunternehmer-Parameter 0: [object Object],[object Object],[object Object],[object Object],[object Object],[object Object] main.js:36 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T16:57:11.190

这里的问题是您的`pos:`属性是一个字符串：`new google.maps.LatLng(51,0)` 并且您不能将字符串传递给 Marker 构造函数。

解决方案是将`pos_lat`和设置`pos_lng`为数字并在构造函数中使用它们：

```
<?php
$markers = '';
while($loc = mysql_fetch_assoc($qry)){
    $markers .= "{id:'".$loc['id']."', title:'".$loc['city']."', pos_lat: ".$loc['latitude'].", pos_lng: ".$loc['longitude']."},";
}
?> 
```

```
for (var i=0; i < locations.length; i++)
    {
        marker_stack[ locations[i].id ] = new google.maps.Marker({
            map: map,
            position: new google.maps.LatLng(locations[i].pos_lat,locations[i].pos_lng),
            title: locations[i].title
        });
    } 
```

# eclipse - 在带有 m2e 的 Eclipse 中，如何获取“快速 Javadoc”（F2）以显示 Maven 依赖项？

> ID：14691271
> 
> 赞同：2
> 
> 时间：2013-02-04T16:43:22.620
> 
> 标签：eclipse, javadoc, m2e

在 Eclipse (Indigo) 中，使用 m2e 插件，我希望能够使用`F2`来自第 3 方依赖项的方法名称（即我没有源的方法名称），并查看 Javadoc。

例如，假设我正在使用 Spring Framework JAR（我没有本地的源代码，但它在 Maven 中心可用）。

我发现`F2`如果我已经在本地下载了源代码（即通过 Ctrl-Clicking 进入该方法），那将可以正常工作；但是，*否则*`F2`不起作用，即它不显示 Javadoc。

 *有什么建议么？如果有一个配置设置在我点击时使 m2e 自动下载源，我什至很好`F2`，为了查看文档而失去上下文真的很烦人！

提前致谢。（我相信我已经审查了关于 SO 的类似问题，但似乎没有一个完全符合我的情况。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-03T10:20:02.060

`Right-click`在您的 Maven 项目上，`Maven` `Download JavaDoc`将所有项目代码的 JavaDoc 下载到本地 Maven 存储库。因此，您将能够在按 F2 时查看 JavaDoc。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-09T12:27:24.297

查看 perferences-> maven 中的“下载工件源”和“下载工件 JavaDoc”。然后重启eclipse。*

# ruby-on-rails - Mongoid 3.1.0 CounterCache 不起作用

> ID：14691272
> 
> 赞同：2
> 
> 时间：2013-02-04T16:43:26.643
> 
> 标签：ruby-on-rails, mongoid, counter-cache

我正在尝试使用 Mongoid CounterCache 但它不起作用。

我试着用

```
belongs_to  :user, counter_cache: true 
```

但它返回

```
Problem:
Invalid option :counter_cache provided to relation :user.

Summary:
Mongoid checks the options that are passed to the relation macros to ensure that no ill side effects occur by letting something slip by.

Resolution:
Valid options are: autobuild, autosave, dependent, foreign_key, index, polymorphic, touch, class_name, extend, inverse_class_name, inverse_of, name, relation, validate, make sure these are the ones you are using. 
```

所以我加了

```
include Mongoid::CounterCache 
```

重新启动我的网络服务器，然后再次尝试，但它返回

```
uninitialized constant Mongoid::CounterCache 
```

关于这个问题的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T19:24:08.723

我遇到了同样的事情。这对我有用。

假设您的应用程序中已经有这些类，并且您决定稍后添加 counter_cache。所以你添加`counter_cache: true`到你的孩子类

```
class User
    include Mongoid::Document
    field :name, type: String
    has_many :things
end

class Thing
    include Mongoid::Document
    field :name, type: String
    belongs_to :user, counter_cache: true
end 
```

然后你跳到你的控制台并执行以下操作：

```
u = User.first
u.things.count #=> 10
u.things_count #=> NoMethodError: undefined method things_count
User.update_counters(u.id, things_count: u.things.count)
u.reload
u.things_count #=> 10 
```

如果有人有更简单或更清洁的方法来做到这一点，那就太棒了。

# php - Doctrine 2.2 ORM：从数据库进行逆向工程后，抛出 MappingException

> ID：14691273
> 
> 赞同：0
> 
> 时间：2013-02-04T16:43:28.050
> 
> 标签：php, zend-framework, orm, doctrine-orm

我正在使用没有虚拟机的 Zend Framework 样板。

我的 Application.ini 看起来像这样：

```
;resources.doctrine.orm.entityManagers.default.metadataDrivers.annotationRegistry.annotationFiles[]     = APPLICATION_PATH "/../library/Doctrine/ORM/Mapping/Driver/DoctrineAnnotations.php"
resources.doctrine.orm.entityManagers.default.metadataDrivers.drivers.0.adapterClass          = "Doctrine\ORM\Mapping\Driver\XmlDriver"
resources.doctrine.orm.entityManagers.default.metadataDrivers.drivers.0.mappingNamespace      = "Square\Entity"
resources.doctrine.orm.entityManagers.default.metadataDrivers.drivers.0.mappingDirs[]         = APPLICATION_PATH "\..\library\Square\Entity"
;resources.doctrine.orm.entityManagers.default.metadataDrivers.drivers.0.annotationReaderClass = "Doctrine\Common\Annotations\AnnotationReader"
;resources.doctrine.orm.entityManagers.default.metadataDrivers.drivers.0.annotationReaderCache = default
;resources.doctrine.orm.entityManagers.default.metadataDrivers.drivers.0.annotationReaderNamespaces.Square = "Square\Entity" 
```

我已经在 CLI 中运行了命令，如此处的示例所示：

[http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/tools.html#reverse-engineering](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/tools.html#reverse-engineering)

更具体地说，这个：

```
$ php doctrine orm:convert-mapping --from-database xml /path/to/mapping-path-converted-to-xml 
```

这使用以下命名模式生成了我的 xml 文件：**{Entity}.dcm.xml**

我已经根据这些 XML 文件生成了我的实体类，然后尝试使用以下命令保存到数据库中：

```
 try{
        $this->_em->persist($this->_apikey);
        $this->_em->flush();
    }catch (Exception $e){
        echo "Something went bad --> ".$e;
    } 
```

在`$this->_apikey = new Square\Entity\Apikeys();`构造方法中的位置。

实体管理器抛出异常：

```
exception 'Doctrine\ORM\Mapping\MappingException' with message 'No mapping file found' 
```

如果 Entity 类是在它们上生成的，为什么 Doctrine 要求映射文件？

难道我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T08:09:51.917

Doctrine 2.2 要求您保留 xml 文件，即使它的 PHP 类是从它们逆向工程的。

# c# - 多项目解决方案中的配置文件

> ID：14691275
> 
> 赞同：0
> 
> 时间：2013-02-04T16:43:31.903
> 
> 标签：c#, .net, configuration-files

我有一个解决方案，其中一个项目是数据层，另一个项目是 Web 前端，其中有 DL 项目作为参考。DL 项目有自己的 app.config 文件，其中存储了 Linq-to -Sql (.dbml) 文件使用的连接字符串。Web 前端还有一个 web.Config 文件，其中有自己的设置。

如何使 DL 项目使用来自 Web 前端的 Web.config 文件而不是来自 app.config 文件的连接字符串？

基本上，如果我在任何 WebApp 中引用数据层，它将从 web.config 而不是从 DL 项目中的 app.config 文件中选择值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T16:46:54.710

将 DL .config 文件中的相关配置复制到 web.config 文件中。它应该这样工作。

# vba - Excel 不会显示工作簿工作表

> ID：14691277
> 
> 赞同：7
> 
> 时间：2013-02-04T16:43:36.270
> 
> 标签：vba, hidden, worksheet, excel

我有一个包含三个工作表的 Excel 工作簿。然而，所有工作表似乎都被隐藏了，尽管它们的可见性设置为 xlSheetVisible（通过查看 VBA 编辑器中的工作表属性找到）。

这是我迄今为止尝试解决的问题。

*   搜索谷歌寻求帮助，但所有类似的问题都已通过将可见性从 xlSheetHidden 更改为 xlSheetVisible 来解决。但在我的情况下，该设置已设置为 xlVisible。

    *   通过使用 VBA，我尝试激活工作表而没有任何结果。

通过阅读本文，您可能已经猜到我能够从 VBA 编辑器查看和访问工作表。

尽管查看了普通的 Excel 用户界面，但所有按钮都被禁用，并且单击左上角的办公室/文件按钮不允许我保存工作簿。但是，如果我对 VBA 本身进行任何更改并尝试关闭工作簿，则 Excel 会询问我是否要保存工作簿。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-04T20:36:48.570

你描述的一切让我相信你隐藏了**工作簿窗口**，而不是工作表。当工作簿窗口被隐藏时，所有工作表都将被隐藏，工具栏中的大部分功能都会变灰。

在 Visual Basic 编辑器中，您还可以看到所有工作表，它们的可见性为`xlVisible`，但在屏幕上看不到。这是因为它们是可见的，但显示它们的窗口不可见。

请尝试单击工具栏中的**查看**选项卡，然后在**窗口**窗格下单击**取消隐藏**。

![在此处输入图像描述](../Images/36098f1c85326c464102a72d6b7a65a9.png)

如果这不起作用，请尝试切换工作簿的可见性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:56:06.947

听起来这可能真的是你的问题......

[http://vbadud.blogspot.co.uk/2010/08/hide-sheet-tabs-using-vba-hide-excel.html](http://vbadud.blogspot.co.uk/2010/08/hide-sheet-tabs-using-vba-hide-excel.html)

# jquery - jquery click 事件在隐藏文件输入时被触发两次

> ID：14691280
> 
> 赞同：1
> 
> 时间：2013-02-04T16:43:40.607
> 
> 标签：jquery

我有一个输入文件列表，对用户隐藏。有一个按钮，单击该按钮会触发文件输入。此按钮和隐藏表单控件列表在模式窗口上呈现。第一次它正常工作，但在保存数据后，模式被关闭，我再次尝试添加文件，点击事件被触发两次。在第一次选择文件并选择时，文件浏览再次选择。代码在下面给出。

```
this._control.button.name = '#fileselector';
....
this._current.fileControl = $('.file-0');
...

$(document)
    .on('click', this._control.button.name, function(event) {
                self._current.fileControl.trigger("click");
            })
    .on().... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T16:56:36.143

尝试像这样解绑点击事件

```
$("#buttonid").unbind('click').click(function (e) {    
}); 
```

# iphone - 是否可以使用 iOS 6.1 从我的应用程序中使用 iMessage 发送带有文本的图片？

> ID：14691281
> 
> 赞同：0
> 
> 时间：2013-02-04T16:43:42.373
> 
> 标签：iphone, objective-c, imessage

有人在 2011 年问过：[iPhone:send image+text to iMessage from my own app](https://stackoverflow.com/questions/8445197/iphonesend-imagetext-to-imessage-from-my-own-app)，但也许现在有一种方法可以做到。有人知道关于这个话题的一些消息吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T16:50:09.563

不，仍然无法通过`MFMessageComposeViewController`.

`MFMessageComposeViewController`是从“消息”访问撰写屏幕的唯一授权方式，并且[文档仍然清楚地说明](http://developer.apple.com/library/ios/#documentation/MessageUI/Reference/MFMessageComposeViewController_class/Reference/Reference.html#//apple_ref/doc/uid/TP40009668)：

> 不支持使用此类发送彩信

此独立视图控制器中不存在通常在消息应用程序中找到的相机图标，这意味着无法发送任何形式的多媒体（条形文本）。

# sql - 如何编写一个hql来获取所有没有权限的记录

> ID：14691284
> 
> 赞同：-1
> 
> 时间：2013-02-04T16:43:46.207
> 
> 标签：sql, hibernate, hql

我有三张桌子

```
Project
   id, name
ProjectAuthorization
   id,  project_id, user_id , permission
User
   id, name 
```

项目.java

```
@OneToMany(mappedBy = "project", cascade = CascadeType.ALL)
private List<ProjectAuthorization> permissions; 
```

用户.java

```
@OneToMany(mappedBy = "user",cascade =CascadeType.ALL)
private List<ProjectAuthorization> permissions; 
```

项目授权.java

```
@ManyToOne()
private Project project;
@ManyToOne()
private User user; 
```

我想在没有任何权限的情况下获取当前用户的所有项目，如何通过休眠查询编写它？

**更新**

像这样的hql：

```
select p from Project as p left join p.permissions as pa where pa.user.id!=:userid and p.id not in (select pa2.project.id from ProjectAuthorization as pa2 where pa2.user.id=:userid)"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T20:35:36.723

例如，可以使用以下查询（也是有效的 JPQL，没有使用特定于 Hibernate 的构造）：

```
SELECT p
FROM Project p
WHERE p.id NOT IN
  (SELECT authorization.project.id
   FROM ProjectAuthorization authorization
   WHERE authorization.user = :currentUser) 
```

# ruby-on-rails - 需要基于平台的宝石

> ID：14691289
> 
> 赞同：1
> 
> 时间：2013-02-04T16:43:59.983
> 
> 标签：ruby-on-rails, gemfile

我通常在开发过程中使用 Red Hat Linux；在那里我需要使用像`therubyracer`and之类的宝石`libv8`。但是，有时我希望能够在 Windows 上进行开发，而不是拥有这些宝石。

是否可以根据操作系统限制 Gemfile 中的 gem？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T16:47:45.397

您可以使用群组

```
group :unix do
  gem 'therubyracer'
  gem 'libv8'
end

# when bundling on windows:
bundle install --without unix 
```

# linux - BASH If [[ "$a" == *"$b"* ]] 始终为真，即使它不应该是

> ID：14691296
> 
> 赞同：4
> 
> 时间：2013-02-04T16:44:12.540
> 
> 标签：linux, bash, shell

我正在尝试编写一个小的 bash 脚本来监视 RiotShield（英雄联盟的第 3 方玩家刮板）的输出是否崩溃。如果在日志中找到关键字，它应该终止进程并重新启动它。

这是我的 bash 脚本：

```
#!/bin/bash
crash[1]="disconnected"
crash[2]="38290209"
while true; do
    list=$(tail log.log)
    #clear
    echo "Reading Log"
    echo "========================================"
    echo $list
    for item in ${list//\\n/ }
    do
            for index in 1 2
            do
                    c=${crash[index]}
                    #echo "Crash Word:" $c
                    if [[ "$c" == *"$item"* ]]; then
                            echo "RiotShield has crashed."
                            echo "Killing RiotShield."
                            kill $(ps aux | grep '[R]iotShield.exe' | awk '{print $2}')
                            echo "RiotShield killed!"
                            echo "Clearing log."
                            echo > log.log
                            echo "Starting RiotShield"
                            (mono RiotShield.exe >> log.log &)

                    fi
            done

    done

    sleep 10
done 
```

我的崩溃数组是我知道在崩溃时在日志中显示的关键字。我在那里有 38290209 仅用于测试目的，因为它是我在英雄联盟中的召唤者 ID，当我搜索我的召唤者名称时，ID 会显示在日志中。

问题是即使断开连接并且 38290209 也不会出现在我的日志中

```
if [[ "$c" == *"$item"* ]]; then 
```

触发，终止 RiotShield 进程，然后重新启动它。

随着我找到更多的崩溃关键字，崩溃数组的长度会增加，所以我不能这样做

```
if [[ "$c" == "*disconnected*" ]]; then 
```

请并感谢 SOF

编辑：

添加工作代码：

```
#!/bin/bash
crash[1]="disconnected"
crash[2]="error"
while true; do
    list=$(tail log.log)
    clear
    echo "Reading Log"
    echo "========================================"
    echo $list
    for index in 1 2
    do
            c=${crash[index]}
            #echo "Crash Word:" $c
            if [[ $list == *$c* ]]; then
                    echo "RiotShield has crashed."
                    echo "Crash Flag: " $c
                    echo "Killing RiotShield."
                    kill $(ps aux | grep '[R]iotShield.exe' | awk '{print $2}')
                    echo "RiotShield killed!"
                    echo "Clearing log."
                    echo > log.log
                    echo "Starting RiotShield"
                    (mono RiotShield.exe >> log.log &)
                    fi
            done
    sleep 10
done 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T17:02:54.267

我认为你的表达式中的操作数是错误的。它应该是：

```
if [[ $item == *$c* ]]; then 
```

因为您想查看 ( `$c`) 行中是否存在关键字 ( `$item`)。

另外，我不确定为什么需要通过这样做将行分成项目：`${list//\\n/ }`. 你可以匹配整条线。

另请注意，在`[[`.

# shell - 如何在 shell 脚本中执行 awk 命令

> ID：14691299
> 
> 赞同：0
> 
> 时间：2013-02-04T16:44:21.340
> 
> 标签：shell, awk, ksh

我有一个 awk 命令，它从 csv 文件的第 3 行中提取第 16 列并打印前 4 个字符。

```
awk -F"," 'NR==3{print $16}' sample.csv|sed -e 's/^[ \t]*//'|awk '{print substr($0,0,4)}' 
```

这工作正常。

但是当我从 shell 脚本执行它时，我得到了错误

```
#!/bin/ksh
YEAR=awk -F"," 'NR==3{print $16}' sample.csv|sed -e 's/^[ \t]*//'|awk '{print substr($0,0,4)}' 
```

错误信息：

```
 -F,: not found 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:08:46.250

使用[命令替换](http://tldp.org/LDP/abs/html/commandsub.html)将命令的输出分配给变量，如下所示：

```
YEAR=$(awk -F"," 'NR==3{print $16}' sample.csv|sed -e 's/^[ \t]*//'|awk '{print substr($0,0,4)}') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:05:29.697

做这个：

```
year=$(awk -F, 'NR==3{sub(/^[ \t]+/,"",$16); print substr($16,1,4); exit }' sample.csv) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:34:00.463

根据您的描述，您似乎想从第 16 个字段中提取年份，该字段可能包含前导空格。您可以通过调用 AWK 一次来完成它：

```
YEAR=$(awk -F, 'NR==3{sub(/^[ \t]*/, "", $16); print ">" substr($16,1,4) "<" }') 
```

更好的是，您甚至不必使用 awk。由于您已经在编写 shell 脚本，所以让我们全部在 shell 脚本中完成：

```
{ read line; read line; read line; } < sample.csv # Get the third line
IFS=, set $line   # Breaks line into comma-separated fields
IFS=" " set ${16} # Trick to remove leading spaces, field 16 becomes field 1
YEAR=${1:0:4}     # Extract the first 4 char from field 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T17:11:17.323

你要求外壳做：

```
VAR=value command [arguments...] 
```

这意味着：启动`command`但`VAR=value`首先将其传递给环境（例如： `LC_ALL=C grep '[0-9]*' /some/file.txt` : 将`grep`输入一个数字`file.txt`（并且`LC_ALL`变量设置为`C`仅在调用期间`grep`）

所以在这里：您要求外壳程序启动`-F","`命令（即，`-F,`一旦外壳程序将参数解释`","`为`,` 参数`'NR==3..........`并将变量`YEAR`设置为`awk` 命令调用期间的值。

只需将其替换为：

```
#!/bin/ksh
YEAR="$(awk -F',' 'NR==3{print $16}' sample.csv|sed -e 's/^[ \t]*//'|awk '{print substr($0,1,4)}')" 
```

（我没有尝试过，但我希望它们对您和您的 sample.csv 文件有用）

（请注意，您使用“0”来匹配字符位置 1，这适用于许多 awk 实现但并非全部（即大多数（但不是全部）在您写 0 时假定为 1））

# c#-4.0 - 依赖注入到泛型类

> ID：14691301
> 
> 赞同：0
> 
> 时间：2013-02-04T16:44:32.230
> 
> 标签：c#-4.0, dependency-injection, ninject

我有通用的`Result<T>`泛型类，我经常在方法中使用它来返回这样的结果

```
public Result<User> ValidateUser(string email, string password) 
```

类中有用于记录服务注入的`ILoggingService`接口，`Result`但我找不到注入实际实现的方法。

我试图执行下面的代码，但`TestLoggingService`实例没有注入`LoggingService`属性。它总是返回 null。任何想法如何解决它？

```
 using (var kernel = new StandardKernel())
            {               
                kernel.Bind<ILoggingService>().To<TestLoggingService>();
                var resultClass = new ResultClass();
                var exception = new Exception("Test exception");
                var testResult = new Result<ResultClass>(exception, "Testing exception", true);                
            }  

      public class Result<T>
        {

           [Inject]
           public ILoggingService LoggingService{ private get; set; } //Always get null

            protected T result = default(T);
            //Code skipped

            private void WriteToLog(string messageToLog, object resultToLog, Exception exceptionToLog)
            {

                LoggingService.Log(....); //Exception here, reference is null

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:22:30.040

您正在使用手动创建实例`new`。Ninject 只会注入由`kernel.Get()`. 此外，您似乎尝试将某些东西注入不推荐的 DTO。最好在创建结果的类中进行日志记录：

```
public class MyService
{
    public MyService(ILoggingService loggingService) { ... }

    public Result<T> CalculateResult<T>() 
    {
        Result<T> result = ...
        _loggingService.Log( ... );
        return result;
    }
} 
```

# c# - 创建枚举列表并将其传递给方法

> ID：14691312
> 
> 赞同：6
> 
> 时间：2013-02-04T16:44:57.303
> 
> 标签：c#, generics, enums

我创建了一个方法，它接受一个枚举并将其转换为字典，其中每个 int 都与枚举的名称（作为字符串）相关联

```
// Define like this
public static Dictionary<int, string> getDictionaryFromEnum<T>()
{
   List<T> commandList = Enum.GetValues(typeof(T)).Cast<T>().ToList();
   Dictionary<int, string> finalList = new Dictionary<int, string>();
   foreach (T command in commandList)
   {
    finalList.Add((int)(object)command, command.ToString());
   }
 return finalList;
 } 
```

（ps。是的，我有双重转换，但该应用程序是一个非常便宜且肮脏的 C#-enum 到 Javascript-enum 转换器）。

这可以像这样轻松使用

```
private enum _myEnum1 { one = 1001, two = 1002 };
private enum _myEnum2 { one = 2001, two = 2002 };
// ... 
var a = getDictionaryFromEnum<_myEnum1>();
var b = getDictionaryFromEnum<_myEnum2>(); 
```

现在，我想知道是否可以创建一个枚举列表以用于一系列调用来迭代我的调用。

**这是最初的问题：[为什么我不能这样称呼？]**

我应该怎么做才能创建这样的电话？

```
List<Type> enumsToConvertList = new List<Type>();
enumsToConvertList.Add(typeof(_myEnum1));
enumsToConvertList.Add(typeof(_myEnum2));
// this'll be a loop
var a = getDictionaryFromEnum<enumsToConvertList.ElementAt(0)>(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T16:50:56.440

您不能在运行时指定通用参数类型（好吧，没有反射）。因此，只需创建接受类型参数的非泛型方法`Type`：

```
public static Dictionary<int, string> getDictionaryFromEnum(Type enumType)
{
    return Enum.GetValues(enumType).Cast<object>()
               .ToDictionary(x => (int)x, x => x.ToString());
} 
```

用法：

```
List<Type> enumsToConvertList = new List<Type>();
enumsToConvertList.Add(typeof(_myEnum1));
enumsToConvertList.Add(typeof(_myEnum2));

var a = getDictionaryFromEnum(enumsToConvertList[0]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T16:50:03.887

> 为什么我不能调用这个？

在这种情况下，您将传入`System.Type`，这与通用说明符不同，后者是编译时值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-23T15:11:21.083

这是另一种方法，它将 Enum 作为泛型并返回所有成员的字典

```
 public static Dictionary<int, string> ToDictionary<T>()
    {
        var type = typeof (T);
        if (!type.IsEnum) throw new ArgumentException("Only Enum types allowed");
        return Enum.GetValues(type).Cast<Enum>().ToDictionary(value => (int) Enum.Parse(type, value.ToString()), value => value.ToString());
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T16:49:43.040

简单来说，泛型的类型参数必须在编译时知道。

您试图将运行时`System.Type` *对象*作为泛型类型说明符传递，这是不可能的。

* * *

至于您要完成的工作，您的方法实际上不需要是通用的，因为您总是返回一个`Dictionary<int, string>`. 正如@lazyberezovsky 演示的那样，尝试将`Type`作为参数传递给方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-04T16:57:02.000

稍后转换为类型：

```
List<Type> enumsToConvertList = new List<Type>();
enumsToConvertList.Add(_myEnum1);
var a = getDictionaryFromEnum<typeof(enumsToConvertList.ElementAt(0))>(); 
```

# css-float - 为什么 css float 的行为与 和 ?

> ID：14691315
> 
> 赞同：0
> 
> 时间：2013-02-04T16:45:02.290
> 
> 标签：css-float, css

取自[w3schools](http://www.w3schools.com/css/tryit.asp?filename=trycss_float5)（访问链接查看它的外观）：

```
<!DOCTYPE html>
<html>
  <head>
    <style>
      ul
      {
        float:left;
        width:100%;
        padding:0;
        margin:0;
        list-style-type:none;
      }
      a
      {
        float:left;
        width:6em;
        text-decoration:none;
        color:white;
        background-color:purple;
        padding:0.2em 0.6em;
        border-right:1px solid white;
      }
      a:hover {background-color:#ff3300;}
      li {display:inline;}
    </style>
  </head>

  <body>
    <ul>
      <li><a href="#">Link one</a></li>
      <li><a href="#">Link two</a></li>
      <li><a href="#">Link three</a></li>
      <li><a href="#">Link four</a></li>
    </ul>

    <p>
    In the example above, we let the ul element and the a element float to the left.
    The li elements will be displayed as inline elements (no line break before or after the element). This forces the list to be on one line.
    The ul element has a width of 100% and each hyperlink in the list has a width of 6em (6 times the size of the current font).
    We add some colors and borders to make it more fancy.
    </p>

  </body>
</html> 
```

所以，`ul`并且`a`是`float:left;`。现在，float 表示下一个元素应该在它周围浮动，但文本*不会*。我错过了什么？

第二：`float`从 中删除`ul` **使文本围绕它流动**。严重的是什么鬼？

第三：删除`inline`from`li` **什么都不做**。然而，删除`float`from`a` **会在元素之间放置空格**。

*任何人都*可以尝试解释为什么会发生这些事情并且不做他们应该做的事情吗？

（最新铬）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T16:47:36.143

的宽度`<ul>`为`100%`。文字无处可去，只能在其下方。

`float:left`从will 中删除`<ul>`会使文本显示在右侧的原因是，`<ul>`将不再占用视觉空间，因为内容都浮动在非浮动容器中。它将是 0px 高，并且`<p>`由于 100% 的宽度，它仍然会下降到它的下方，但是您不会在视觉上注意到它。您可以通过给`<ul>`a 边框来测试它，看看会发生什么。将`<p>`浮动在最后一个浮动的旁边`<li>`。

`<li>`s 不是内联项。`display:inline;`并且`display:block`都是不正确的。他们是`display:list-item;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T16:49:07.783

这是因为当您将`<ul>`宽度设置为 100% 时，它`<ul>`会占据整个宽度并将内容推到其下方。`<ul>`将宽度更改为`auto`将达到您想要的效果：

```
 ul
  {
    float:left;
    width:auto;
    padding:0;
    margin:0;
    list-style-type:none;
  } 
```

# java - 如何从groovy调用参数化sql过程

> ID：14691316
> 
> 赞同：4
> 
> 时间：2013-02-04T16:45:14.177
> 
> 标签：java, sql, groovy

我正在从 groovy 运行一些程序：

```
 sql.call("{call SCHEMA.NAME_PROCEDURE($par1,$par2,$par3)}"){} 
```

其中 sql 是数据库连接的实例

这很好用。

现在我需要参数化 SCHEMA 所以我尝试这样的事情：

```
 sql.call("{call ${schema}.NAME_PROCEDURE($par1,$par2,$par3)}"){} 
```

或者

```
 sql.call("{call " + schema + ".NAME_PROCEDURE($par1,$par2,$par3)}"){} 
```

但没有成功。我不知道为什么这两个代码片段不起作用。还有一些sqlException。我做错了什么？

请帮忙

编辑：

我发现了类似的问题，但仍然没有答案：

[http://groovy.329449.n5.nabble.com/Calling-stored-procedures-td344943.html](http://groovy.329449.n5.nabble.com/Calling-stored-procedures-td344943.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T18:59:59.710

为了比上面@mtk 的答案更明确，请尝试更改：

```
sql.call("{call " + schema + ".NAME_PROCEDURE($par1,$par2,$par3)}"){} 
```

到：

```
sql.call(GString.EMPTY + "{call " + schema + ".NAME_PROCEDURE($par1,$par2,$par3)}"){} 
```

您的第一次尝试将不起作用-这是尝试绑定过程的名称，它将生成以下形式的 SQL：

```
 { call ?.NAME_PROCEDURE(?,?,?) } 
```

第二个稍微不那么明显。Groovy SQL 使用 GString 对象来生成 SQL 和绑定列表。但是，因为您从原始字符串开始，表达式的结果将是原始字符串，所以传递给 sql.call 的内容如下所示：

```
 { call schema.NAME_PROCEDURE(par1,par2,par2) } 
```

不是：

```
 { call schema.NAME_PROCEDURE(${par1},${par2},${par3}) } 
```

这是你真正想要的。如果 par1-3 都是数字，你可以接受，但如果它们是字符串（或其他一些会通过替换被强制转换为字符串的类型），这可能不是有效的 SQL，因此你的 SQL 异常。

基本上字符串 + GString = 字符串。Groovy SQL 需要一个 GString 实例，以便它可以为此查询正确设置绑定列表。

您可以通过将字符串强制为“GString”实例来解决此问题。GString 被定义为 GString + String = GString。您可以在 groovy 控制台上看到这一点：

```
groovy> def par1 = 1 
groovy> def par2 = 2 
groovy> def par3 = 3 
groovy> def schema = 'myschema' 
groovy> println (("{call " + schema + ".NAME_PROCEDURE($par1,$par2,$par3)}").class) 
groovy> println ((GString.EMPTY + "{call " + schema + ".NAME_PROCEDURE($par1,$par2,$par3)}").class) 

class java.lang.String
class groovy.lang.GString$2 
```

通过将“{call”强制为 GString 实例，这将沿着“加号”调用级联，因此您可以确保 Groovy SQL 获得创建“正确”绑定列表/SQL 所需的输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T10:20:32.403

我对此并不精通，但只是在[文档](http://groovy.codehaus.org/api/groovy/sql/Sql.html#call%28groovy.lang.GString%29)中挖掘这就是我所看到的，以及可能发生的其他可能性 -

1.  参数期望是 a`GString`与 不同`String`。希望它确实被转换了，但是通过用变量组合一个字符串来显式地尝试，然后将它转换为一个 GString 对象作为 [ [GString info](http://groovy.codehaus.org/Strings+and+GString) ]

    ```
    GString g = GString.EMPTY + normal_str_variable; 
    ```

2.  `schema`变量未设置正确的值。

3.  Sql 实例可能已关闭并且您没有正确检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T04:49:15.433

[希望它是从 Java / JPA 调用存储过程](https://stackoverflow.com/questions/3572626/calling-stored-procedure-from-java-jpa)的问题的重复

但我的回答是：查看代码片段

```
//getDBUSERByUserId is a stored procedure
String getDBUSERByUserIdSql = "{call getDBUSERByUserId(?,?,?,?)}";
callableStatement = dbConnection.prepareCall(getDBUSERByUserIdSql);
callableStatement.setInt(1, 10);
callableStatement.registerOutParameter(2, java.sql.Types.VARCHAR);
callableStatement.registerOutParameter(3, java.sql.Types.VARCHAR);
callableStatement.registerOutParameter(4, java.sql.Types.DATE);

// execute getDBUSERByUserId store procedure
callableStatement.executeUpdate();

String userName = callableStatement.getString(2);
String createdBy = callableStatement.getString(3);
Date createdDate = callableStatement.getDate(4); 
```

示例代码：

存储过程：

```
CREATE OR REPLACE PROCEDURE getDBUSERByUserId(
       p_userid IN DBUSER.USER_ID%TYPE,
       o_username OUT DBUSER.USERNAME%TYPE,
       o_createdby OUT  DBUSER.CREATED_BY%TYPE,
       o_date OUT DBUSER.CREATED_DATE%TYPE)
IS
BEGIN

  SELECT USERNAME , CREATED_BY, CREATED_DATE
  INTO o_username, o_createdby,  o_date 
  FROM  DBUSER WHERE USER_ID = p_userid;

END; 
```

通过 CallableStatement 调用存储过程

```
public class JDBCCallableStatementOUTParameterExample {

    private static final String DB_DRIVER = "oracle.jdbc.driver.OracleDriver";
    private static final String DB_CONNECTION = "jdbc:oracle:thin:@localhost:1521:MKYONG";
    private static final String DB_USER = "user";
    private static final String DB_PASSWORD = "password";

    public static void main(String[] argv) {
        try {
            callOracleStoredProcOUTParameter();
        } catch (SQLException e) {
            System.out.println(e.getMessage());
        }
    }
    private static void callOracleStoredProcOUTParameter() throws SQLException {
        Connection dbConnection = null;
        CallableStatement callableStatement = null;
        String getDBUSERByUserIdSql = "{call getDBUSERByUserId(?,?,?,?)}";
        try {
            dbConnection = getDBConnection();
            callableStatement = dbConnection.prepareCall(getDBUSERByUserIdSql);
            callableStatement.setInt(1, 10);
            callableStatement.registerOutParameter(2, java.sql.Types.VARCHAR);
            callableStatement.registerOutParameter(3, java.sql.Types.VARCHAR);
            callableStatement.registerOutParameter(4, java.sql.Types.DATE);
            // execute getDBUSERByUserId store procedure
            callableStatement.executeUpdate();
            String userName = callableStatement.getString(2);
            String createdBy = callableStatement.getString(3);
            Date createdDate = callableStatement.getDate(4);
            System.out.println("UserName : " + userName);
            System.out.println("CreatedBy : " + createdBy);
            System.out.println("CreatedDate : " + createdDate);
        } catch (SQLException e) {
            System.out.println(e.getMessage());
        } finally {
            if (callableStatement != null) {
                callableStatement.close();
            }
            if (dbConnection != null) {
                dbConnection.close();
            }
        }
    }
    private static Connection getDBConnection() {
        Connection dbConnection = null;
        try {
            Class.forName(DB_DRIVER);
        } catch (ClassNotFoundException e) {
            System.out.println(e.getMessage());
        }
        try {
            dbConnection = DriverManager.getConnection(
                DB_CONNECTION, DB_USER,DB_PASSWORD);
            return dbConnection;
        } catch (SQLException e) {
            System.out.println(e.getMessage());
        }
        return dbConnection;
    }
 } 
```

希望这可以帮助你。谢谢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-13T23:34:39.570

这个问题要求常规的解决方案，所以 vanilla java 是不合时宜的。这是一个使用“内联过程”来更好地处理参数的解决方案。在 grails 2.4 之后还有一个 sql.callWithRows 和 sql.callWithAllRows 可用

```
 def calculateTotals(map) {
    //initialize variables
    Double returnTotalOriginalOut = 0
    Double returnTotalOtherOut = 0
    Double returnTotalNetOut = 0

    def sql = new Sql(sessionFactory.currentSession.connection())
    //calculate the totals
    sql.call("""
             DECLARE
                return_orig_chgs      number := 0;
                return_non_orig_chgs  number := 0;
                return_net_inst_chgs  number := 0;
             BEGIN
               SCHEMA.NAME_PROCEDURE(id         => ${map.id},
                                     term_in        => ${map.term},
                                     orig_chgs      => return_orig_chgs,
                                     non_orig_chgs  => return_non_orig_chgs,
                                     net_inst_chgs  => return_net_inst_chgs);
             ${Sql.DOUBLE} := return_orig_chgs;
             ${Sql.DOUBLE} := return_non_orig_chgs;
             ${Sql.DOUBLE} := return_net_inst_chgs;
            END ;
    """) { return_orig_chgs, return_non_orig_chgs, return_net_inst_chgs ->
        returnTotalOriginalOut = return_orig_chgs
        returnTotalOtherOut = return_non_orig_chgs
        returnTotalNetOut = return_net_inst_chgs
    }

    def returnMap = [:]
    returnMap = [returnTotalOriginal: returnTotalOriginalOut, returnTotalOther: returnTotalOtherOut, returnTotalNet: returnTotalNetOut]
    return returnMap
} 
```

# c# - 注入IKernel insted业务接口依赖是一个好习惯

> ID：14691320
> 
> 赞同：1
> 
> 时间：2013-02-04T16:45:24.400
> 
> 标签：c#, dependency-injection, ninject

我正在开发和应用程序，我使用 NInject 框架来解决依赖问题，但构造函数太大了。一些构造函数有 5、8、10 个参数。为了解决这个问题，我有一个想法..

而是像这样的代码类。

```
public class UserBLL
{
    private IA a;
    private IB b;
    ...
     UserBLL(IA a, IB b, IC c ...)
    {
        this.a = a;
        this.b = b
        ...
    }   

} 
```

我想像这样编写我的课程。

```
 public class UserBLL
    {
        private IA a;
        private IB b;
        ...
         UserBLL(IKernel kernel)
        {
            this.a = kernel.Get<IA>();
            this.b = kernel.Get<IB>()
            ...
        }   

    } 
```

我想知道这是否是一个好主意，以及我将来是否会遇到任何问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T16:50:35.680

在您的第二个示例中，您根本没有*简化*构造函数。您添加了一个*额外的*依赖项。这不是一个好主意。您希望您的组件取决于它所依赖的接口，而不是`IKernel`.

如果您的班级有 8-10 个依赖项，这可能[表明班级正在尝试做太多的事情](http://www.oodesign.com/single-responsibility-principle.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T16:53:34.440

> 注入IKernel insted业务接口依赖是一个好习惯

不，我认为这不是一个好习惯，您正在尝试将其`IKernel`用作*超级工厂*，但请记住，您还会在代码中的任何地方创建依赖关系`IKernel`，这不是*业务类*，而是*基础设施类*。

在您的情况下，您可能违反单一责任原则，尝试将您的班级划分为更小的班级将是这种情况下的最佳选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T16:52:28.463

我认为您在这里有一个好主意的萌芽，但我不会像这样实施。内核对象的目标是使情况更清晰而不是钝。例如，我会这样：

```
interface IKernel 
{
    public IA GetIA();
    public IB GetIB();      
} 
```

注1：我会走得更远，并实际解释他们在界面中的内容：

```
interface IKernel
{ 
   public IA GetUserUIPreferences();
   public IB GetPrintingParameters();
} 
```

注 2：我希望 IKernel 的任何实现都包含注入的功能——否则，拥有 DI 的意义何在

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T17:08:04.370

`IKernel`不，注入实例是不行的。

注入一个能够任意解析其他组件的组件称为*服务定位器*，被认为是一种反模式。

Service Locator 最糟糕的事情是它不再清楚某个类依赖于什么。这会产生一个维护问题，可能不会马上明显，但以后会咬你。

这是一篇关于为什么使用服务定位器不是一个好主意的好文章：http: [//blog.ploeh.dk/2010/02/03/ServiceLocatorIsAnAntiPattern.aspx](http://blog.ploeh.dk/2010/02/03/ServiceLocatorIsAnAntiPattern.aspx)

关于构造函数参数过多的问题：考虑改变设计。在大多数情况下，这是应用单一职责原则的问题，正如 Iain Galloway 在[他的回答](https://stackoverflow.com/a/14691407/390819)中所建议的那样。基本上，您可以尝试在单独的类中分解独立的逻辑部分，这些部分将成为当前类的依赖项，但同时会“窃取”一些现有的依赖项。

因此，例如，如果类`A`有 10 个依赖项，您可以将逻辑拆分为三个类`B`：`C`和`D`。这些中的每一个都可能有 3-4 个以前`A`直接使用的依赖项。

如果您认为 3-4 个依赖项也太多，您也可以对那些较小的类重复此过程。

# .net - 为什么这个 MSDN 指南？

> ID：14691321
> 
> 赞同：1
> 
> 时间：2013-02-04T16:45:28.263
> 
> 标签：.net, memory-management, garbage-collection

在[这个 msdn 页面上](http://msdn.microsoft.com/en-us/library/ee787088.aspx)，它说

> 在堆上分配的对象越少，垃圾收集器要做的工作就越少。分配对象时，不要使用超出需要的四舍五入值，例如只需要 15 个字节时分配 32 个字节的数组。

有谁知道为什么这个建议在这里（除了显而易见的 - 我怀疑他们为什么在这里有这个）？

分配四舍五入到单词边界的空间有什么害处？

它对性能有影响吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T17:00:49.200

在复杂的堆管理器可用之前，在过去的非托管代码时代，四舍五入是一种策略。它减少了堆碎片的不良影响，堆中有一堆无法组合成更大的小空块。从而使程序以 OOM 终止，并带有大量未使用的内存。今天没有任何意义，Windows 低碎片堆解决了这个问题，尽管它也对分配进行了四舍五入。对于小型分配，最多为 8 的倍数。从 XP 开始可用，Vista 及更高版本默认开启。

当你有一个可以压缩并消除漏洞的垃圾收集器时，它就没有意义了。你只是给它更多的工作，移动未使用的内存，没有任何好处。

堆碎片在托管代码中并不是一个完全解决的问题，大对象堆最终可能会出现难以重用的空洞。LOH 没有被压缩，太多的数据无法移动。对大于 80 KB 的对象进行四舍五入实际上仍然有意义。只有当内存分析器显示您遇到 LOH 问题时，您才会这样做。此时您应该*首先*考虑迁移到 64 位操作系统。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T16:48:13.093

> 分配四舍五入到单词边界的空间有什么害处？

坏处是你可以创建比需要更多的对象，这会导致更大的 GC 压力。这正是指南所说的。没有任何关于它作为单词边界的具体内容 - 它更多的是分配比需要更多的内存的问题。

> 它对性能有影响吗？

是的，它会对性能产生负面影响，因为它会导致 GC 需要更加努力地工作。

# javascript - 使用 AngularJS 设置交替的部分颜色

> ID：14691325
> 
> 赞同：0
> 
> 时间：2013-02-04T16:45:52.507
> 
> 标签：javascript, html, angularjs

与使用表格相反，我有结构化的部分，这些部分曾经是 div。我想知道是否有办法在显示的每个部分之间动态交替行颜色：

```
<div>
  <name-section></name-section> (blue)
  <address-section></address-section> (green)
  <city-section></city-section> (blue)
  <postal-section></postal-section> (green)
</div> 
```

等等

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T17:04:12.530

看看[这个 jsFiddle](http://jsfiddle.net/phoenecke/5AWNm/1/)。这使用 css 来完成。

```
div > *:nth-child(even) {background: green}
div > *:nth-child(odd) {background: blue} 
```

# bash - 在 bash 脚本中将字符串写入标准输入

> ID：14691330
> 
> 赞同：1
> 
> 时间：2013-02-04T16:46:06.117
> 
> 标签：bash, shell

我正在尝试使用 bash 自动启动特定服务

当使用 init.d (/etc/init.d/openvpn.custom) 启动服务时，它会提示输入用户名和密码 - 然后连接

已安装版本无法使用 auth-user-pass from-file，并且由于依赖关系无法升级

所以我正在尝试编写一个简单的 bash 脚本来执行 init.d 脚本，休眠一会儿，输入用户名，返回，休眠一会儿，输入密码 - 你会得到流程。

像[http://pastebin.com/qWHX7Di5](http://pastebin.com/qWHX7Di5)

我已经尝试过回声，但它似乎不起作用

这是一个相当旧的防火墙，我被要求保持连接。

这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:03:41.203

我会使用`expect`而不是`bash`. `bash`如果您还需要执行其他任务，您仍然可以从内部调用它。

在`expect`中，脚本将类似于以下内容（未经测试）：

```
#!/usr/bin/expect -f
set username "username"
set password "password"

spawn /etc/init.d/openvpn.custom start
expect "Username:"
send "$username\r"
expect "Password:"
send "$password\r"
expect eof 
```

您希望更改`expect "Username:"`&行以匹配脚本`expect "Password:"`输出的实际登录提示。`init.d`

有关更多详细信息，请参见[`expect`手册页](http://linux.die.net/man/1/expect)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:05:37.630

您可以尝试使用[here-doc](http://en.wikipedia.org/wiki/Here_document)：

```
/path/to/init.d << END
$username
$password
END 
```

# jaxb - 输出空元素

> ID：14691333
> 
> 赞同：7
> 
> 时间：2013-02-04T16:46:25.737
> 
> 标签：jaxb

我有一个包含两个字段“名称”和“地址”的对象。JAXB 在将对象转换为 XMl 时忽略空元素。

例如：如果我有 name="xyz" 和 address=null 那么 out 将是

```
<name>xyz</name> 
```

但我想要作为输出

```
<name>xyz</name>
<address></address> 
```

我已经看到了该选项`@XmlElement(nillable="true")`，但这给出了输出

```
<name>xyz</name>
<address xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/> 
```

请帮助我获得所需的输出。

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-04T16:51:57.620

[JAXB (JSR-222)](http://jcp.org/en/jsr/detail?id=222)实现将输出一个空字符串值`""`作为一个空元素。您可以将`address`属性设置为此以获得所需的效果。

* * *

**更新#1**

> 我已经更新了我的问题。基本上地址元素是NULL。该解决方案是否也适用于此？

您可以利用[Marshal 事件回调](http://docs.oracle.com/javase/6/docs/api/javax/xml/bind/Marshaller.html#marshalEventCallback)来调整`address`.

```
import javax.xml.bind.Marshaller;
import javax.xml.bind.annotation.*;

@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class Customer {

    private String name;
    private String address;

    private void beforeMarshal(Marshaller marshaller) {
        if(null == address) {
            address = "";
        }
    }

    private void afterMarshal(Marshaller marshaller) {
        if("".equals(address)) {
            address = null;
        }
    }

} 
```

* * *

**更新#2**

> 唯一需要担心的是，如果我在课堂上有 10 个字段，我将不得不为所有字段编写 if。还有其他解决方案吗？

如果您使用[**EclipseLink MOXy**](http://www.eclipse.org/eclipselink/moxy.php)作为您的 JAXB 提供程序（我是 MOXy 的负责人），那么您可以将 an`XmlAdapter`用于此用例。

**XmlAdapter（字符串适配器）**

```
package forum14691333;

import javax.xml.bind.annotation.adapters.XmlAdapter;

public class StringAdapter extends XmlAdapter<String, String> {

    @Override
    public String marshal(String string) throws Exception {
        if(null == string) {
            return "";
        }
        return string;
    }

    @Override
    public String unmarshal(String string) throws Exception {
        if("".equals(string)) {
            return null;
        }
        return string;
    }

} 
```

**包信息**

然后，如果您在包级别指定它，它将应用于该包中的所有映射字段/类型`String`的属性。

```
@XmlJavaTypeAdapter(value=StringAdapter.class, type=String.class)
package forum14691333;

import javax.xml.bind.annotation.adapters.*; 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2012/02/jaxb-and-package-level-xmladapters.html](http://blog.bdoughan.com/2012/02/jaxb-and-package-level-xmladapters.html)
*   [http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html](http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-25T09:12:52.050

如果您使用 EclipseLink MOXy 作为您的 JAXB 提供程序，那么您可以使用

```
@XmlNullPolicy(emptyNodeRepresentsNull = true, nullRepresentationForXml = XmlMarshalNullRepresentation.EMPTY_NODE)
@XmlElement(name = "address", nillable = true)
private String address; 
```

通过这种方式，您不必为所有字段编写适配器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-16T16:25:19.943

只需在字段上设置一个空字符串默认值。

```
@XmlElement(required="true")
private String address = ""; 
```

你会得到

```
<address></address> 
```

# php - 如何在 CDN 托管的网站中提交表单

> ID：14691336
> 
> 赞同：1
> 
> 时间：2013-02-04T16:46:46.050
> 
> 标签：php, wordpress, cdn

我的网站托管在 CDN 中，使用 wordpress 开发。我在前端有一个表格。问题是，当我提交表单时，它显示 404 错误。我已经在表单中给出了操作页面的完整链接。但它仍然会进入相同的 404 页面。当 CDN 被禁用时，此表单可以正常工作。这是使用cdn的问题吗？那么，如何在 CDN 托管网站中提交表单？

如果我的表格像 `<form name="form1" action="domain.com/target.php" action="post" > <input name="field1" type="text" /> <input name="field2" type="text" /> <input type="submit" name="submit-form" /> </form>`

我应该将我的帖子请求的目标指向哪里？我知道可以在 CDN 托管网站中锻炼表格。我们在我们的站点中使用 Wp-poll 插件，并且基于 ajax。它工作正常。

我也准备将表单更改为 ajax。我知道如何使用 jquery post 发送 post 请求。但是我怎样才能在 CDN 中做同样的事情呢？. 我应该在哪里指出我的帖子请求？请提供一些例子。请解释一下，wp-poll 的结果如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:01:25.513

您的问题有点细节，但通常 CDN 提供商只提供静态文件 - 它不能运行服务器端代码。因此，您的 POST 请求的目标无法在 CDN 上运行。

但是，出现 404 的最可能原因是您要发布到的文件不存在 - 您要么未将其上传到 CDN，要么将其定向到不存在的 URL。

# android - 果冻豆上的 ActionBarSherlock 选项卡高度不可调节

> ID：14691342
> 
> 赞同：9
> 
> 时间：2013-02-04T16:46:59.780
> 
> 标签：android, android-actionbar, actionbarsherlock, android-4.2-jelly-bean

我正在使用 ActionBarSherlock 创建一个应用程序并使用 ActionBar 选项卡。以下是我定义选项卡的方式：

```
actionBar.addTab(actionBar.newTab().setText("test").setTabListener(new TabListener<AccountsListFragment>(this, "accounts",AccountsListFragment.class))); 
```

我正在尝试更改选项卡的高度。据我了解，无法仅更改选项卡的高度。您还必须更改主操作栏的高度（我正在从中提取主操作栏的定义） [http://developer.android.com/design/patterns/actionbar.html#considerations-split-action-bars](http://developer.android.com/design/patterns/actionbar.html#considerations-split-action-bars) 因此，如何更改操作栏的高度是在主主题中使用以下样式

```
 <item name="actionBarSize">100dp</item>
    <item name="android:actionBarSize">100dp</item> 
```

上面的代码似乎适用于所有设备，以更改主操作栏和除了 jellybean 之外的选项卡。我在 4.1.2 银河系上对此进行了测试。同样在 4.2 Nexus 7 上。两者似乎都一样。它只会更改主操作栏，而根本不会更改选项卡高度。

我们还为对我们没有帮助的选项卡尝试了自定义视图。

如果有人能指出我在谷歌的哪个位置，它说他们不再允许更改标签的高度（我怀疑是这种情况）或者给我一种解决这个问题的风格。我将不胜感激。如果你甚至给我一个关于普通动作栏的例子而不是夏洛克，那应该对我有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-05T05:46:40.600

对我来说，这听起来像是一个无声的错误修复。他们在每个新版本中都会制作其中的一些。改变操作栏的高度应该增加标签的大小是没有意义的，这不是谷歌鼓励的东西，而是开发人员发现很好用的黑客。您唯一的其他选择是自己制作，但它非常复杂并且可能被证明是耗时的。

类似的帖子： [更改 Android JellyBean 上的操作栏高度](https://stackoverflow.com/q/15098206/969325)

# php - 在 PHP 中使用密码加密变量

> ID：14691343
> 
> 赞同：0
> 
> 时间：2013-02-04T16:47:06.457
> 
> 标签：php, encryption, passwords

> **可能重复：**
> [PHP 中的双向加密](https://stackoverflow.com/questions/1391132/two-way-encryption-in-php)

我需要一个用密码加密变量的 PHP 脚本。我不是说像 md5($var); 这样的哈希值。或 sha1($var);

我需要一个可以制作（例如） md5($var); 的脚本 哈希但也从 md5($var); 有用的字符串。

期待喜欢

```
$password = "SomePassword"; 
$data = "TheVerySecretString";
$encrypted = TheEncyptionFunctionINeed($password, $data); // Output some useless strings
$decrypted = TheDecryptionFunctionINeed($password, $data); // Output: "TheVerySecretString" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T16:49:07.483

[PHP中的双向加密](https://stackoverflow.com/questions/1391132/two-way-encryption-in-php)

> 抱歉几年后打开它，但我认为它很重要，因为它在顶级搜索排名中......
> 
> PHP 5.3 引入了一种非常易于使用的新加密方法。
> 
> 它是 openssl_encrypt 和 openssl_decrypt ......这里没有很好的记录，所以这里有一个简单的例子......

```
$textToEncrypt = "My super secret information.";
$encryptionMethod = "AES-256-CBC";  // AES is used by the U.S. gov't to encrypt top secret documents.
$secretHash = "25c6c7ff35b9979b151f2136cd13b0ff";

//To encrypt
$encryptedMessage = openssl_encrypt($textToEncrypt, $encryptionMethod, $secretHash);

//To Decrypt
$decryptedMessage = openssl_decrypt($encryptedMessage, $encryptionMethod, $secretHash);

//Result
echo "Encrypted: $encryptedMessage <br>Decrypted: $decryptedMessage"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:51:15.063

这里有2个功能：

```
函数加密数据（$值）{
   $key = "最高机密密钥";
   $文本= $值；
   $iv_size = mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_ECB);
   $iv = mcrypt_create_iv($iv_size, MCRYPT_RAND);
   $crypttext = mcrypt_encrypt(MCRYPT_RIJNDAEL_256, $key, $text, MCRYPT_MODE_ECB, $iv);
   返回$密文；
}

函数解密数据（$值）{
   $key = "最高机密密钥";
   $crypttext = $值；
   $iv_size = mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_ECB);
   $iv = mcrypt_create_iv($iv_size, MCRYPT_RAND);
   $decrypttext = mcrypt_decrypt(MCRYPT_RIJNDAEL_256, $key, $crypttext, MCRYPT_MODE_ECB, $iv);
   返回修剪（$解密文本）；
}
?>

```

检查功能手册： mcrypt_encrypt 和 mcrypt_decrypt

# web-services - 在不更改值的情况下“碰撞”SharePoint ListItem

> ID：14691345
> 
> 赞同：0
> 
> 时间：2013-02-04T16:47:15.783
> 
> 标签：web-services, sharepoint, sharepoint-2007, caml

首先，我正在使用什么：

*   共享点 2007
*   JavaScript
*   CAML 查询
*   标准网络服务 (_vti_bin/lists.asmx)

我根据某些条件从列表中选择一个或多个项目。我得到这些物品，并对它们执行另一个条件。如果满足条件，我想碰撞该项目，意思是：将“修改”列更改为当前日期/时间，但不应更改任何值。

这可能吗？如果是这样，如何做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T13:50:59.650

我已经不得不做同样的事情了。虽然我找不到代码，但我找到了那个帮助我的帖子。它是用 C# 编写的，但很容易适应 javascript：

```
public void Test()
        {
            string webUrl = "http://myserver";
            string listName = "docs";
            Lists.ListsSoapClient listsClient = this.GetListsClient(webUrl);

            // 1st a call to Lists.GetList - we need the list's version - it is returned in the Version attribute
            XElement listData = XElement.Parse(listsClient.GetList(listName).OuterXml);
            string listID = listData.Attribute("ID").Value;
            string version = listData.Attribute("Version").Value;
            // in the updateFields parameter of Lists.UpdateList the full schema of the fields should be provided
            string updateFields = @"<Fields>
   <Method ID='1'>
      <Field ID='{28cf69c5-fa48-462a-b5cd-27b6f9d2bd5f}' ColName='tp_Modified' RowOrdinal='0' ReadOnly='FALSE' Type='DateTime' Name='Modified' DisplayName='Modified' StorageTZ='TRUE' SourceID='http://schemas.microsoft.com/sharepoint/v3' StaticName='Modified' FromBaseType='TRUE' Version='4' ShowInNewForm='FALSE' ShowInEditForm='FALSE' />
   </Method>
   <Method ID='2'>
      <Field ID='{8c06beca-0777-48f7-91c7-6da68bc07b69}' ColName='tp_Created' RowOrdinal='0' ReadOnly='FALSE' Type='DateTime' Name='Created' DisplayName='Created' StorageTZ='TRUE' SourceID='http://schemas.microsoft.com/sharepoint/v3' StaticName='Created' FromBaseType='TRUE' Version='4' ShowInNewForm='FALSE' ShowInEditForm='FALSE' />
   </Method>
</Fields>";
            XmlDocument doc = new XmlDocument();
            doc.LoadXml(updateFields);
            // Lists.UpdateList: set fields to not read-only
            XElement result = XElement.Parse(listsClient.UpdateList(listID, null, null, doc.DocumentElement, null, version).OuterXml);
            // get updated version from the result XML - for the second call of Lists.UpdateList
            version = result.Elements().Where(el => el.Name.LocalName == "ListProperties").First().Attribute("Version").Value;

            // prepare the XML for the list item update
            string updateDates = @"<Batch OnError='Continue'>
  <Method ID='M0' Cmd='Update'>
    <Field Name='ID'>1</Field>
    <Field Name='FileRef'>/docs/zt.txt</Field>
    <Field Name='Modified'>2010-04-04T22:17:00Z</Field>
    <Field Name='Created'>2010-01-01T00:05:00Z</Field>
  </Method>
</Batch>";

            doc.LoadXml(updateDates);
            // Lists.UpdateListItems: update Created & Modified
            result = XElement.Parse(listsClient.UpdateListItems(listID, doc.DocumentElement).OuterXml);

            // revert the fields' schema
            updateFields = updateFields.Replace("ReadOnly='FALSE'", "ReadOnly='TRUE'");
            doc.LoadXml(updateFields);
            // Lists.UpdateList: set fields back to read-only
            result = XElement.Parse(listsClient.UpdateList(listID, null, null, doc.DocumentElement, null, version).OuterXml);
        } 
```

基本上，我们必须在尝试更新之前将字段的只读属性设置为 false，并在更新后将该属性设置回 true。

资料来源： [http ://stefan-stanev-sharepoint-blog.blogspot.com.br/2010/04/updating-read-only-fields-with-lists.html](http://stefan-stanev-sharepoint-blog.blogspot.com.br/2010/04/updating-read-only-fields-with-lists.html)

# iframe - 在 iframe 中显示 Linkedin 文章

> ID：14691347
> 
> 赞同：2
> 
> 时间：2013-02-04T16:47:17.190
> 
> 标签：iframe, linkedin

我想在我的网站上的 iframe 中显示 Linkedin 文章，但是当我使用 iframe 时，它​​只是显示一个空白页面。Linkedin 是否为 iframe 设置了安全性？我可以做些什么来显示这样的 iframe 吗？

这是我的代码：

```
<iframe src="http://www.linkedin.com/today/post/article/20130117141235-20017018-stop-using-these-16-terms-to-describe-yourself?trk=mp-details-rc" frameborder="0" width="100%" height="100%"  > Don't work </iframe> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-04T16:50:32.877

> Linkedin 是否为 iframe 设置了安全性？

是的，一句话。查看浏览器的错误控制台，您会知道为什么它不起作用：

```
Refused to display document because display forbidden by X-Frame-Options. 
```

LinkedIn 明确禁止第三方对其内容进行 iframe。

[http://en.wikipedia.org/wiki/X-Frame-Options#Frame-Options](http://en.wikipedia.org/wiki/X-Frame-Options#Frame-Options)

# ruby-on-rails - heroku run rake > 没有要加载的文件——faker

> ID：14691354
> 
> 赞同：5
> 
> 时间：2013-02-04T16:47:31.060
> 
> 标签：ruby-on-rails, heroku

运行“heroku run rake”时出现此错误：

```
 no such file to load -- faker
/app/lib/tasks/sample_data.rake:1:in `require'
/app/lib/tasks/sample_data.rake:1:in `<top (required)>' 
```

我有 gem 'faker', '0.3.1' 组：development, :test 在 Gemfile 中做。

我在 sample_data.rake 中需要 'faker'

```
source 'https://rubygems.org'

gem 'rails', '3.2.11'
gem 'gravatar_image_tag', '0.1.0'

group :development, :test do
  gem 'sqlite3', '1.3.5'
  gem 'rspec-rails', '2.8'
 gem 'guard-spork', '1.2.0'
 gem 'faker', '0.3.1'
  gem 'spork', '0.8.4'
  gem 'will_paginate', '3.0'
gem 'webrat', '0.7.1'
 gem 'capybara', '1.1.2'
gem 'annotate', '2.5.0'
gem 'factory_girl_rails', '1.0'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '3.2.5'
  gem 'coffee-rails', '3.2.2'
  gem 'uglifier', '1.2.3'
end

gem 'jquery-rails', '2.0.2'

group :production do
  gem 'pg', '0.12.2'
end 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-04T17:24:32.527

Heroku 默认不安装`test`或`development`gems。

如果你想`fake`在你的作品中加载，你应该`gem 'faker', '0.3.1'`从 中删除`group :development, :test do`并将其放在任何组之外：

```
 source 'https://rubygems.org'
  gem 'rails', '3.2.11'
  gem 'gravatar_image_tag', '0.1.0'
  gem 'faker', '0.3.1'

  group :development, :test do
  gem 'sqlite3', '1.3.5'
  ... 
```

但是，如果您不想加载`fake`，则必须确保`require fake`仅在调用任务时才需要您：

```
task :sample_data => :environment do
  require 'faker'  #must be inside the task.
  ...
end 
```

希望能帮助到你。

**编辑**

您可以通过以下方式告诉 Bundler 不加载 Gem：

```
 gem 'faker', '0.3.1', :require => false 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-11T10:34:30.887

我在“Rub on Rails 3 教程”中遇到了这个问题。根据 gabrielhilals 的回答，解决方法是将 require 'faker' 移到任务内部

修复前：

```
require 'faker'
namespace :db do
  desc "Fill database with sample data"
  task :populate => :environment do
    ...
    ...
  end
end 
```

修复后：

```
namespace :db do
  require 'faker'
  desc "Fill database with sample data"
  task :populate => :environment do
    ...
    ...
  end
end 
```

# c# - 如何在 DotNetOpenAuth“OAuth2ClientChannel”类上设置“JsonReaderQuotas”属性

> ID：14691358
> 
> 赞同：0
> 
> 时间：2013-02-04T16:47:52.147
> 
> 标签：c#, asp.net-mvc-4, dotnetopenauth, instagram

我正在使用 DotNetOpenAuth 对 Instagram 进行身份验证。不幸的是，我收到以下错误

> 已超过最大读取深度 (2)，因为正在读取的 XML 数据的嵌套级别超过了配额所允许的级别。可以通过更改创建 XML 阅读器时使用的 XmlDictionaryReaderQuotas 对象的 MaxDepth 属性来增加此配额。

环顾四周，我发现 DotNetOpenAuth 4.2 版中添加了一个修复程序，允许您覆盖默认的最大级别，这是`JsonReaderQuotas`在`OAuth2ClientChannel`. 但是，我似乎看不到如何设置或覆盖此属性来解决问题。

有谁知道如何覆盖默认值或知道更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T04:24:47.463

```
ClientBase someClient; // initialized elsewhere
someClient.JsonReaderQuotas.MaxDepth = 10; 
```

# solr - 在 Solr 中搜索多值类别树（左/右）

> ID：14691360
> 
> 赞同：1
> 
> 时间：2013-02-04T16:48:01.460
> 
> 标签：solr

我使用 Solr 来存储产品。每个产品可以有多个类别。

```
<field name="id" type="string" indexed="true" stored="true" required="true" multiValued="false" /> 
<field name="sku" type="text_en_splitting_tight" indexed="true" stored="true" omitNorms="true"/>
<field name="cat" type="string" indexed="true" stored="true" multiValued="true"/>
<field name="cat_left" type="int" indexed="true" stored="true" multiValued="true"/>
<field name="cat_right" type="int" indexed="true" stored="true"  multiValued="true"/> 
```

我想找到属于某个类别和以下子类别的所有产品。为了避免递归搜索，我计算每个类别节点的[LEFT/RIGHT](http://en.wikipedia.org/wiki/LR_parser)值。在 SQL 数据库中它运行良好。示例查询如下所示：

```
SELECT * FROM Products p JOIN Categories c WHERE c.left > 2 AND c.right < 8 
```

我不能在 Solr 中做同样的事情，因为多个左右值没有配对。如果我有 2 对分配给一个产品：

```
{left: 2, right: 3}
{left: 6, right: 8} 
```

我会查询：

```
+cat_left:[4 TO *] +cat_right:[* TO 5] 
```

很明显，该产品将被返回，因为最小的左侧值为 2，而右侧的最大值为 8。Solr 不知道对于 left 等于 2 right end on 3。这些字段没有关联。

我喜欢左/右方法，因为它是查询树的快速方法，但可以将它与 Solr 一起使用吗？也许我过于复杂并且 Solr 有很好的树支持？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T11:36:06.377

我的问题的答案是一维[多边形字段](http://khaidoan.wikidot.com/solr-data-types)（[如果值与几个间隔之一匹配，则 Solr 查询](https://stackoverflow.com/questions/10312441/solr-query-if-value-matches-one-of-several-intervals)）

# ios - 无法协调视图控制器

> ID：14691368
> 
> 赞同：0
> 
> 时间：2013-02-04T16:48:18.030
> 
> 标签：ios, objective-c, uiviewcontroller, delegation

我的应用程序中内置了以下视图控制器。呈现控制器是“PatientSelectViewController”（我们称之为控制器 A），它允许在文本字段中手动输入患者 ID 或按下“扫描条形码”按钮，该按钮将执行对另一个视图控制器的 segue - 即“BarcodeScanViewController "（我们称它为控制器 B）。

当 B 完成扫描条形码并返回结果（患者 ID）时，我将通知呈现视图控制器 (A)，A 负责在数据库中查找 ID。此时控制器 B 应该被解散。如果找到了 ID，那么我们过渡到第三个视图控制器 - “PatientConfirmViewController”（我们称之为 C）。但是，如果没有找到 ID，那么我想要一条弹出消息，说明并再次转到控制器 B 再次扫描条形码。

同样，如果用户决定在文本字段中手动输入 ID 而不是扫描它，那么成功的 ID 会将我带到控制器 C，而不成功的 ID 会弹出消息并留在控制器 A 中再次尝试。

我还希望将控制器嵌入到导航控制器中，这样我总是有标签栏按钮可以带我回到以前的视图控制器。例如，我将有一个标签栏按钮从 B 或 C 返回到 A。理想情况下，如果我在成功扫描条形码后到达 C，我希望标签栏按钮将我带回 B - 而不是 A！- 如果用户决定她不想确认此 ID，则其想法是用户可能想要重新扫描条形码。但这并不重要。

由于某种原因，我无法实现这一点。这是一个搞砸行为的例子：我打电话给 A 然后打电话给 B（扫描条形码）并扫描我知道在数据库中的条形码。这正确地将我带到 C 并显示患者信息。但后来我决定使用标签栏按钮“输入患者 ID”返回 A 然后我再次按下“扫描条形码”按钮，再次扫描与以前相同的条形码，但这次不是成功转换到 C，我得到了这个屏幕 - 注意搞砸的标签栏！它必须同时说“确认 ID”和“输入患者 ID”，然后按钮返回登录（这是首先调用 A 的控制器）和“扫描条形码” - 即控制器 B好像它以前从未弹出过一样！ ![搞砸了标签栏](../Images/f288db8229c6adde906599086f4b8720.png) 这可能会在 2 次或 3 次或更多次成功扫描后随机发生。日志显示如下：

> 嵌套推送动画可能导致导航栏损坏
> 
> 开始/结束外观转换的不平衡调用。
> 
> 在意外状态下完成导航转换。导航栏子视图树可能会损坏。

以下是我的实现方式：

在视图控制器 A 中：

```
-(void)prepareForSegue: (UIStoryboardSegue *)segue sender: (id)sender
{
    if ([[segue identifier] isEqualToString:@"BarcodeScanView"])
    {
        self.p_usingBarcodeScan=YES;
        [[segue destinationViewController]setViewDelegate:self]; //sets itself as a delegate for receiving the result of a barcode scan from controller B 
    }
    if ([[segue identifier] isEqualToString:@"ConfirmID"])
    {
        [[segue destinationViewController] setP_userInfo:p_userInfo]  ; //passes the data to the controller C
    }
} 
```

接收条码扫描结果的委托方法（仍在控制器A中）：

```
- (void) didScanBarcode:(NSString *)result
{

    self.p_userID = result;

    [self.navigationController popViewControllerAnimated:YES];//Pop B from the navigation stack to return to A - is this right????

    //Run the database query
    [self lookUpID];
} 
```

在数据库中查找ID的方法（还在A中）：

```
- (void) lookUpID{

    /*.....
    Does something here and gets a result of the lookup...
    */

    // Do something with the result
    if ([[result  p_userName] length] > 0 ){ //Found the user!
        p_userInfo = result;
        [self performSegueWithIdentifier: @"ConfirmID" sender: self];

    }
    else {
        UIAlertView * messageDlg = [[UIAlertView alloc] initWithTitle:nil message:@"User was not found. Please try again"
                                                             delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
        [messageDlg show];

        //Here I'd like to perform this seque to B only if I got here after a barcode scan... 
        //Otherwise I am just staying in A...
        if (self.p_usingBarcodeScan == YES ){
            [self performSegueWithIdentifier: @"BarcodeScanView" sender: self];
        }  
    }
    return;
} 
```

为了完整起见，在 B 中，一旦我设法扫描了条形码，我将其称为：

```
- (void)decodeResultNotification: (NSNotification *)notification {

    if ([notification.object isKindOfClass:[DecoderResult class]])
    {
        DecoderResult *obj = (DecoderResult*)notification.object;
        if (obj.succeeded)
        {
            decodeResult = [[NSString alloc] initWithString:obj.result];

            [[self viewDelegate] didScanBarcode:decodeResult];
        }
    }
} 
```

我正在使用从 A 到 B 和从 A 到 C 的推送序列并使用情节提要。这是情节提要的快照，从 A 到 B（“BarcodeScan”）和从 A 到 C（“ConfirmID”）可见。两者都是 push segues：

![故事板快照](../Images/07d242cc391922d887b9f43854c6ed11.png)

提前非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:25:55.983

您没有说您当前是使用导航控制器和推送转场，还是使用模态转场呈现。

这里：

```
 [self.navigationController popViewControllerAnimated:YES];//Pop B from the navigation stack to return to A - is this right????
    [self dismissViewControllerAnimated:YES completion:nil];**//is this right???** 
```

第一个适用于从 push segue 返回，第二个适用于模态/呈现 segue。当您在导航控制器中使用后退按钮时，实际上会发生 push-return 方法。

**更新** 我认为你需要稍微解开你的导航方法。我的建议

*   在 B 中，有一个委托方法

    *   检查患者 ID
    *   如果它很好在 A 中设置 self.p_userID
    *   将 BOOL 成功/失败返回给
        B。_
*   基于该结果，要么：

    *   弹出自己（你可以`[self.navigationController popViewController]`直接在B中使用）或

    *   **在 B 中**显示您的警报。鉴于您在 B 中有一个后退按钮，并且（可能）有一个重新扫描按钮，您的警报可能不需要提供任何选择。

在**一个**：

```
- (void) viewWillAppear:(BOOL)animated
{
    NSLog (@"viewControllers %@",self.navigationController.viewControllers);

    [super viewWillAppear:animated];
    if (self.p_userID) {
        [self performSegueWithIdentifier: @"ConfirmID" sender: self];
        self.p_userID = nil;
    }
} 
```

（只有当你还在 B 中设置 self.p_userID 时才会发生这种 performSegue）

键入的用户 ID 逻辑更简单。再次检查患者 ID。如果它不存在，则在 A 中发出警报（同样，您不需要提供选择，因为所有导航选项都可以在没有警报的情况下使用）。如果存在，将 self.p_userID 设置为 ID 并启动 segue。

在`prepareForSegue`您应该进行查找以从 self.p_userID 获取 userInfo 字典以传递给 C，然后将 self.p_userID 设置为 nil。或者（更好）只需将 self.p_userID 传递给 C 并在 C 中进行查找（假设您有一个单独的模型源对象）。不管你做什么，当你离开 A 时一定要设置`self.p_userID`为 nil，这样你就不会自动触发你不想要的 segue！也许在“viewWillDisappear”中也可以将其归零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:21:24.067

好的，我正在尝试部分回答我自己的问题。即使在实施了上面的 He Was 建议之后，我的麻烦仍然存在，甚至成倍增加（关于这些的一些细节在我在讨论线程中的评论[https://chat.stackoverflow.com/rooms/23918/discussion-between-peterd-and-he -是](https://chat.stackoverflow.com/rooms/23918/discussion-between-peterd-and-he-was)）

但是，通过一些更改，我搜索了我收到的日志消息：“嵌套推送动画可能导致导航栏损坏”并最终阅读了这个答案：[https](https://stackoverflow.com/a/5616935/1959008) ://stackoverflow.com/a/5616935/1959008 ，这表明我的问题是使用

```
 [self.navigationController popViewControllerAnimated:YES]; 
```

即动画设置为YES。一旦我将它设置为 NO，标签栏的问题就消失了（一些小怪癖仍然存在，我希望尽快解决它们）。这真的很奇怪 - 在我看来更像是一个错误而不是一个功能，但我当然可能是错的......

# c++ - 忽略第二个 if 语句

> ID：14691370
> 
> 赞同：-1
> 
> 时间：2013-02-04T16:48:32.273
> 
> 标签：c++, if-statement, dev-c++

我正在尝试编写一个程序来计算要添加到球形或矩形鱼缸中的调节剂的体积和数量。

我希望它询问用户坦克是否是圆形的，他们将回答“y”、“Y”或“n”、“N”。但是，每当我运行程序并输入 n 或 N 时，它仍然会运行 y 或 Y 的 if 语句。

*请注意，我对这一切都很陌生。这是对编程和逻辑类的介绍。*

这是我的源代码：

```
#include <iostream>

using namespace std;

int main()
{
char Circle = ' ';
int RADIUS = 0;
int HEIcircle = 0;
int LEN = 0;
int WID = 0;
int HEI = 0;
double AMTcondCIR;
double AMTcondREC;
cout << "Is tank circular? ";
cin >> Circle;

if (Circle = 'Y' or 'y')
{

cout << "Enter radius: ";
cin >> RADIUS;
cout << "Enter height: ";
cin >> HEIcircle;
AMTcondCIR = ((4/3) * 3.14 * (RADIUS^3)) * 0.01;
cout << "Amount of Conditioner to add (in mL): " << AMTcondCIR << endl;
}
if (Circle = 'N' or 'n')
{

cout << "Enter length: ";
cin >> LEN;
cout << "Enter width: ";
cin >> WID;
cout << "Enter height: ";
cin >> HEI;
AMTcondREC = (LEN * WID * HEI) * 0.01;
cout << "Amount of Conditioner to add (in mL): " << AMTcondREC << endl;
}
system("pause");
return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T16:51:59.200

在 C++`=`中是赋值运算符。为了平等，请使用`==`. 也就是改变

```
if (Circle = 'Y' or 'y') 
```

进入

```
if (Circle == 'Y' || Circle == 'y') 
```

和

```
if (Circle = 'N' or 'n') 
```

进入

```
if (Circle == 'N' || Circle == 'n') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T16:51:19.063

您的 if 语句条件完全错误；这没有任何部分做你认为它做的事情：`if (Circle = 'Y' or 'y')`.

你正在寻找`if (Circle == 'Y' || Circle == 'y')`. 由于几个原因，您所写的内容是错误的；它使用赋值运算符（`=`而不是`==`），并且二进制的另一半`or`始终为真。

你写的基本上是这样的：

```
if ('Y') {
  if ('y') {

  }
} 
```

并且字符 'Y' 转换为 boolean `true`，就像字符 'N' 一样，因此两个`if`语句的条件都评估为真。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T16:51:34.740

`if`将您的陈述更改为

```
if (Circle == 'Y' || Circle == 'y')
...
if (Circle == 'N' || Circle == 'n') 
```

比较是`==`，而赋值是`=`。

# ios - 如何创建具有渐变和突出显示的 UIButton？

> ID：14691372
> 
> 赞同：4
> 
> 时间：2013-02-04T16:48:37.280
> 
> 标签：ios, objective-c, uibutton, cagradientlayer

我正在尝试创建一个具有渐变背景的 UIButton。我做得很好，但是选择时按钮没有突出显示（默认行为是按钮变暗）。

这是我的按钮：

```
-(UIButton *)createLoginButtonForSize:(CGSize)size {
    UIButton *loginButton = [UIButton buttonWithType:UIButtonTypeCustom];
    loginButton.translatesAutoresizingMaskIntoConstraints = FALSE;
    loginButton.layer.cornerRadius = 8;
    loginButton.titleLabel.text = @"Login";

    [loginButton addTarget:self action:@selector(loginCheck:) forControlEvents:UIControlEventTouchUpInside];

    [loginButton addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"H:[loginButton(WIDTH)]"
                                                                        options:0
                                                                        metrics:@{@"WIDTH": [NSNumber numberWithFloat:size.width]}
                                                                          views:NSDictionaryOfVariableBindings(loginButton)]];

    [loginButton addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"V:[loginButton(HEIGHT)]"
                                                                        options:0
                                                                        metrics:@{@"HEIGHT": [NSNumber numberWithFloat:size.height]}
                                                                          views:NSDictionaryOfVariableBindings(loginButton)]];

    CAGradientLayer *layer = [UIColor greenGradient];
    layer.frame = CGRectMake(0, 0, size.width, size.height);
    layer.cornerRadius = 8;

    [loginButton.layer insertSublayer:layer atIndex:0];

    return loginButton;
} 
```

我需要自己处理突出显示吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T17:50:01.010

是的，您将需要处理突出显示自己。不过，与其滚动您自己的代码，不如查看 Jeff Lamarche 令人难以置信的易于使用的[iPhone Gradient Buttons Project](http://code.google.com/p/iphonegradientbuttons/)。它完全符合您的要求。它只有 2 个文件，因此很容易合并到您的项目中：

[http://code.google.com/p/iphonegradientbuttons/source/browse/trunk/Classes/GradientButton.h](http://code.google.com/p/iphonegradientbuttons/source/browse/trunk/Classes/GradientButton.h) [http://code.google.com/p/iphonegradientbuttons/source/browse/trunk/Classes/GradientButton.m](http://code.google.com/p/iphonegradientbuttons/source/browse/trunk/Classes/GradientButton.m)

下面的截图取自[Jeff 的博客讨论该项目](http://iphonedevelopment.blogspot.com/2010/05/improved-gradient-buttons.html)。

![无图像渐变按钮](../Images/e5b32f540efc9f418d7457ed7a670713.png)

# php - PHPMailer 不发送 CC 或 BCC

> ID：14691373
> 
> 赞同：6
> 
> 时间：2013-02-04T16:48:38.220
> 
> 标签：php, email, phpmailer

我已经测试以下代码几个小时了。电子邮件将发送到通过添加的地址，`$mail->AddAddress()`并且在收到的电子邮件中注明抄送，但抄送人没有收到电子邮件。我到处寻找，找不到解决办法来解决为什么会发生这种情况。我已经运行了测试，并且所有变量都正确地提交给了这个代码。

我的服务器正在运行 Linux Red Hat

我的代码：

```
require_once('../smtp/class.phpmailer.php');
//include("class.smtp.php"); // optional, gets called from within class.phpmailer.php if not already loaded
$mail = new PHPMailer(true); // the true param means it will throw exceptions on errors, which we need to catch
$mail->IsSMTP(); // telling the class to use SMTP
try {
  $mail->SMTPDebug  = 0;                     // enables SMTP debug information (for testing)
  $mail->SMTPAuth   = true;                  // enable SMTP authentication
  $mail->SMTPSecure = "tls";                 // sets the prefix to the server
  $mail->Host       = "smtp.gmail.com";      // sets GMAIL as the SMTP server
  $mail->Port       = $port;                 // set the SMTP port for the GMAIL server  465 or 587
  $mail->Username   = $username;             // GMAIL username
  $mail->Password   = $password;             // GMAIL password

  // Add each email address
  foreach($emailTo as $email){ $mail->AddAddress(trim($email)); }
  if($cc!=''){ foreach($cc as $email){ $mail->AddCC(trim($email)); } }
  if($bcc!=''){ foreach($bcc as $email){ $mail->AddBCC(trim($email)); } }

  $mail->SetFrom($emailFrom, $emailName);
  $mail->AddReplyTo($emailFrom, $emailName);
  $mail->Subject = $subject;
  $mail->AltBody = 'To view the message, please use an HTML compatible email viewer!'; // optional - MsgHTML will create an alternate automatically
  $mail->MsgHTML($content);
 // $mail->AddAttachment('images/phpmailer.gif');      // attachment
 // $mail->AddAttachment('images/phpmailer_mini.gif'); // attachment

  $mail->Send();
  echo'1';exit();
} catch (phpmailerException $e) {
  echo $e->errorMessage(); //Pretty error messages from PHPMailer
} catch (Exception $e) {
  echo $e->getMessage(); //Boring error messages from anything else!
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-02-18T13:52:51.730

Old question, but I ended up here looking for an answer. Just learned elsewhere that those functions **AddCC** and **AddBCC** only work with **win32 SMTP**

Try using:

```
$mail->addCustomHeader("BCC: mybccaddress@mydomain.com"); 
```

See [http://phpmailer.worxware.com/?pg=methods](http://phpmailer.worxware.com/?pg=methods)

Hope this helps someone, cheers!

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-05-01T08:06:38.103

```
$address = "xxxxx@gmail.com";
$mail->AddAddress($address, "technical support");

$address = "yyyyyy@gmail.com";
$mail->AddAddress($address, "other");

$addressCC = "zzzzzz@gmail.com";
$mail->AddCC($addressCC, 'cc account');

$addressCC = "bcc@gmail.com";
$mail->AddBCC($addressCC, 'bcc account'); 
```

# c# - WCF 服务 wsdl 客户端错误

> ID：14691375
> 
> 赞同：2
> 
> 时间：2013-02-04T16:48:44.777
> 
> 标签：c#, .net, wcf, wsdl

我有一个用 .NET 4.5 编写的 WCF Web 服务，它运行良好。

我用来调用它的客户端（SQL CLR 存储过程）必须使用 .NET 2，因为它用于 Sql Server (2005)。

当我使用内置的 WCF 测试客户端测试 Web 服务时，一切正常。同样，如果我使用 .NET 3+ 和 svcutil.exe 构建客户端，它也可以工作。

但是，由于我必须使用 .NET 2，我找到的唯一解决方案是使用 wsdl.exe 生成客户端（[原始问题](https://stackoverflow.com/a/14649752/1324019)）——它成功地完成了，但我没有设法让它工作。

我得到错误`The message with Action 'action removed' cannot be processed at the receiver, due to a ContractFilter mismatch at the EndpointDispatcher. This may be because of either a contract mismatch (mismatched Actions between sender and receiver) or a binding/security mismatch between the sender and the receiver. Check that sender and receiver have the same contract and the same binding (including security requirements, e.g. Message, Transport, None).`

我发现[了这个问题](https://stackoverflow.com/q/5487791/1324019)，但是它建议查看`EndpointDispatcher` 我没有使用的类，因为我在 .NET 2.0 上。

据我所知，我所有的命名空间都是相同的——但仍然没有运气。我也尝试过使用服务跟踪实用程序，但它似乎没有向我展示任何有用的东西。

甚至可以使用以这种方式制作的客户端和这种方式的服务吗？还是端点永久不兼容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T20:13:30.303

我最终用 wsdl 重新生成了我的客户，因为我改变了一些东西，结果证明我有。客户更新了我的命名空间，从那时起一切正常。

# angularjs - 带有中继器的 AngularJS 指令模板

> ID：14691376
> 
> 赞同：0
> 
> 时间：2013-02-04T16:48:49.983
> 
> 标签：angularjs, angularjs-directive

我有这个模板的指令，其中包括一个转发器：

```
template:   '<div class="btn-group">' +
                    '<a href="javascript:void(0)" class="btn" ng-repeat="option in options" ng-click="select($event, scope)" value="{{option.value}}">{{option.label}}</a>' +
                '</div>' 
```

在我的链接函数中，除非我把它放在 $timeout 中，否则下面会返回一个空数组：

```
var tmp = element.find('.btn'); 
```

小提琴链接：http: [//jsfiddle.net/dkrotts/XF3RY/1/](http://jsfiddle.net/dkrotts/XF3RY/1/)

这些元素不应该在链接时可用吗？如果没有，是否有更清洁的方法来处理这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:32:39.130

显然 ng-repeat 稍后发生，在您的链接功能运行后：[https ://stackoverflow.com/a/13771751/215945](https://stackoverflow.com/a/13771751/215945)

您可能想尝试使用两个指令，类似于Angular 主页示例中的`tabs`和指令。`pane`该指令可以在其控制器上`radio-buttons`定义一个方法（使用），该指令可以在单击时调用。`this``radio-button`

有关选项卡和窗格指令如何通信的详细信息，请参阅[https://stackoverflow.com/a/14168699/215945](https://stackoverflow.com/a/14168699/215945)

# jquery - 在导入的 html 页面中导入 html 页面

> ID：14691383
> 
> 赞同：1
> 
> 时间：2013-02-04T16:49:13.680
> 
> 标签：jquery, html

我有一个 html5 应用程序，它通过 jquery 将几个 html 页面之一导入 div：

```
var path = "../" + folderName + "/" + pageName + ".html";
$("#container").load(path);

<div id="container"></div> 
```

这部分工作得很好，但现在我最近被要求将其中一些导入的页面也导入其他 html 页面。
我尝试使用相同的技术，但无法显示页面。不过，它并没有在调试器上声明错误。

```
var subPath = "../" + folderName + "/" + subPageName + ".html";
$("#subContainer").load(subPath );

<div id="subContainer"></div> 
```

subPage 中的代码只是通过 CSS 设置的背景颜色。我还没有添加任何东西。

PS：我不能使用php，服务器显然没有处理它

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T16:52:44.193

假设`subContainer`代码位于您在 first 中获得的代码中`load()`，您需要将其放入单独的 js 文件中并执行以下操作：

```
$("#container").load(path, function(){
    $.getScript("path/to/subContainer.js"); 
}); 
```

默认情况下，脚本不会在您使用 ajax 加载的内容上执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:55:05.973

你可以试试这个：

```
 $(function(){
            $('.a').load('b.php',function(){
                $('.b').load('c.php');
            });
        }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T16:56:39.287

在要导入的页面的末尾插入一个`<script>`带有您的代码的块，如下所示：

```
<script>
$(function(){
   // jquery code you want to run after all elements on page are loaded
})
</script> 
```

# java - 与 Java 的间接 telnet 连接

> ID：14691385
> 
> 赞同：2
> 
> 时间：2013-02-04T16:49:18.473
> 
> 标签：java, ssh, telnet, jsch

## 设想

我在一个 Java 项目中，我们必须与其他机器的 CLI 进行通信。不幸的是，我们无法直接连接到这些其他机器，另一个不幸的是它们只支持 telnet。所以我们有以下设置，它是刻在石头上的（当然）：

```
application <---- telnet or ssh ----> gateway <---- telnet ----> machine_001
(10.0.0.1)                         (192.168.1.1)               (192.168.2.1)
                                                               (192.168.2.2)
                                                               (    ...    ) 
```

可以通过 SSH 或 telnet 手动连接到网关（例如使用 PuTTY），从这个 shell telnet 到其中一台机器并使用它的 CLI。由于我们希望通信自动发生，因此应用程序必须能够自行与机器通信；所以我需要一个程序化的解决方案。

## 到目前为止我尝试过的

在互联网上进行了一些研究后，我发现了一个名为[JSch](http://www.jcraft.com/jsch/)的库，看起来很有希望，但我遇到了一个邪恶的问题。当应用程序连接到网关时，telnet 命令以及目标机器的整个 CLI 从应用程序的角度来看都是一个命令。因此，如有必要，我将不得不与非终止 InputStream、不同步的 OutputStream 和线程作斗争。

下一个尝试是建立一个从 L127.0.0.1:1234 到 192.168.2.1:23（通过网关）的 SSH 隧道，但是使用此配置，无法远程登录到 127.0.0.1:1234（无论是通过编程方式还是手动方式） .

## 实际问题

如何让我的应用程序使用 telnet 通过网关与机器通信？

# android - 在 TabHost 选项卡切换时 Drawables Alpha 发生变化

> ID：14691387
> 
> 赞同：0
> 
> 时间：2013-02-04T16:49:21.653
> 
> 标签：android, tabs, android-tabhost, tabwidget

当我在 TabHost 中的选项卡之间单击时，我需要更改选项卡的可绘制对象的 alpha。我这样做：

```
getTabHost().setOnTabChangedListener(new OnTabChangeListener() {

                        public void onTabChanged(String tabId) {
                            Activity currentActivity = getCurrentActivity();
                            Log.i("choosed activity", currentActivity.toString());
                            if (currentActivity instanceof LoginActivity) {
                                Log.i("current activity", "LoginActivity");
                                getResources().getDrawable(R.drawable.login).setAlpha(255);
                                getResources().getDrawable(R.drawable.signup).setAlpha(80);
                                getResources().getDrawable(R.drawable.close).setAlpha(80);
                            }
                            if (currentActivity instanceof RegisterActivity) { 
                                Log.i("current activity", "RegisterActivity");
                                getResources().getDrawable(R.drawable.login).setAlpha(80);
                                getResources().getDrawable(R.drawable.signup).setAlpha(255);
                                getResources().getDrawable(R.drawable.close).setAlpha(80);
                            }
}); 
```

Current Activity 确定成功，但只有当我翻转设备时，alpha 才会发生变化。请告诉我如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T13:28:47.330

也许您应该尝试：`invalidate()`在设置新的 alpha 值之后

# android - 为什么 RemoteViewsFactory 方法 getViewAt 工作错误但并非总是如此？

> ID：14691388
> 
> 赞同：1
> 
> 时间：2013-02-04T16:49:29.430
> 
> 标签：android, widget, scroll, adapter

有时当我的小部件更新时，我会在日志中看到：

> ..
> 
> getViewAt 位置 = 7
> 
> getViewAt 位置 = 7 ..

第一次 RemoteViews 对象被放置在位置 0 上，第二次放置在位置 7 上。为什么会这样？为什么它调用 id 为 7 的对象但将其放在位置 0 上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T17:52:44.617

答：在 ListView 中，您无法设置高度 wrap_context，因为如果您有 10、20、100 或更多元素，视图不知道它是什么。

# django - NoReverseMatch Django URL

> ID：14691394
> 
> 赞同：8
> 
> 时间：2013-02-04T16:49:54.580
> 
> 标签：django, django-templates

当前遭受 Django URL 标记的 NoReverseMatch 错误。一直在关注 Django 的权威指南，Django 文档，并在此处和互联网上搜索

网址：

```
url(r'^test/', Search_Page),
url(r'^search/', Search),
url(r'^details/', Details_Main),
url(r'^Link/(d+)/$', Link),
url(r'^$', 'Parks.views.Link', name="home"),
url(r'^(?P<result_name>)/$', Link), 
```

观点：

```
def Link(request, result_name):
    return render_to_response('Search_Page.html') 
```

模板：

```
{% for result in results %}
    <a href="{% url name result.name %}">test</a> 
```

错误：

```
NoReverseMatch at /search/
Reverse for 'name' with arguments '(u'North West Thrill Centre',)' and keyword arguments '{}' not found.Request Method: GET 
Request URL: http://127.0.0.1:8000/search/?search=a&type=parks&submit=Search 
Django Version: 1.4.2 
Exception Type: NoReverseMatch 
Exception Value: Reverse for 'name' with arguments '(u'North West Thrill Centre',)' and keyword arguments '{}' not found. 
Exception Location: C:\Python27\lib\site-packages\django\template\defaulttags.py in render, line 424 
Python Executable: C:\Python27\python.exe 
Python Version: 2.7.3 
Python Path: ['C:\\Users\\User\\Documents\\Django\\ParkManager',
 'C:\\Windows\\system32\\python27.zip',
 'C:\\Python27\\DLLs',
 'C:\\Python27\\lib',
 'C:\\Python27\\lib\\plat-win',
 'C:\\Python27\\lib\\lib-tk',
 'C:\\Python27',
 'C:\\Python27\\lib\\site-packages'] 
Server time: Mon, 4 Feb 2013 16:44:27 +0000 

Error during template rendering
In template C:\Users\User\Documents\Django\ParkManager\Templates\Details_Main.html, error at line 23 
```

提前致谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-04T16:55:12.743

你试图调用什么视图？您正在调用`name`视图上的 URL，但该 URL`name`不存在。由于您只有一个命名视图，因此`home`我假设这是您尝试使用的视图。

您的视图和 URL 都没有参数，但您`result.name`在 URL 中作为参数传递。

您需要接受视图中的参数`def Link(request, result_name):`并通过正则表达式将其捕获到您的 URL 中`(?P<result_name>..`，或者在没有传递参数的情况下调用您的 URL：

```
{% for result in results %}
    <a href="{% url home %}">test</a> 
```

由于您的视图中还没有逻辑，并且正在传递一个多字参数而不是“slugifying”它 - 我假设您想要执行后者并且只需从 URL 调用中删除参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T18:43:01.967

您的 {% url name result.name %} 是问题所在。

由于您的 Link 方法有一个关键字参数，因此您的 url 反向模板标签应该有一个匹配的关键字参数。

## 模板.html

```
<a href="{% url search result_name=result.name %}">test</a> 
```

继续阅读以明确问题所在，正如您现在设置的那样，在模板中反转 url 的正确方法是：
{% url [name] [args] [kwargs] %}

其中，
[name] 是以下之一：test、search_start、details、link、home 或 search。或者查看功能的完整路径，但我建议现在保持简单。
[args] 可以是空的，也可以是参数列表。
[kwargs] 可以是空的，也可以是关键字参数列表。

可以在此处找到 url 标签上的文档并概述其他使用方法（[https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#url](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#url)）。

***顺便说一句，您将遇到搜索字符串中允许的 url 中不允许使用的字符（如空格和 & 符号）的问题。**

## 网址.py

```
url(r'^test/', Search_Page, name="test"),
url(r'^search/', Search, name="search_start"),
url(r'^details/', Details_Main, name="details"),
url(r'^Link/(d+)/$', Link, name="link"),
url(r'^$', 'Parks.views.Link', name="home"),
url(r'^(?P<result_name>)/$', Link, name="search"), 
```

## another_template.html

```
<a href="{% url search result_name=result.name %}">test</a>
<!-- and more examples -->
<a href="{% url test %}">link to test</a>  
<a href="{% url search_start %}">link to search</a> 
<a href="{% url details %}">link to details</a> 
{% for a_link in links %}
    <a href="{% url link a_link.id %}">link to details (of a_link)</a> 
{% endfor %}
<a href="{% url home %}">home</a> 
```

# asp.net-mvc - 为 ViewModel 配置自定义 MetadataProvider

> ID：14691396
> 
> 赞同：1
> 
> 时间：2013-02-04T16:49:58.440
> 
> 标签：asp.net-mvc, entity-framework-4, modelmetadataprovider

我有一个希望能够动态设置元数据属性的 ViewModel。例如，我希望能够使用其他模型属性的值自定义 DisplayName 和验证错误消息。[根据Brad Wilson 的文章](http://bradwilson.typepad.com/blog/2010/01/why-you-dont-need-modelmetadataattributes.html)，我计划使用自定义 MetadataProvider 来执行此操作。

我希望提供程序仅与选定的 ViewModel 一起使用。所以我的问题是，我该如何配置？我已经看到使用 的示例`ModelMetadataProviders.Current = new MyModelMetadataProvider()`，但这可能会为所有模型类实体使用自定义提供程序。是否可以为单个 ViewModel 配置提供程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T09:49:25.660

你不能。

但是，您可以充当所有其他模型的代理。就像是：

```
public class YourProvider<TViewModel>
{
    public YourProvider(InnerProvider provider) {}

    public ModelMetaData GetMetaData(SomeContext context)
    {   
        if (context.ModelType != typeof(TViewModel))
            return _innerProvider.GetMetaData(context);

        //Other logic here.

    }
} 
```

最后将其分配为：

```
ModelMetadataProviders.Current 
    = new MyModelMetadataProvider<CustomViewModel>(ModelMetadataProviders.Current); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:17:24.457

一旦您开始在站点上获得多个用户，我很确定在 ViewModel 中更改当前模型元数据提供程序是不安全的，更不用说线程安全了。您也许可以使用属性方法，但您仍然必须实现自己的 ModelMetadataProvider 并在应用程序开始时将其设置为 Current，然后检查某些属性并确定要返回的 ModelMetaData，如果没有则返回一直到基础实现。虽然老实说，你在谈论的限制数量，让它只处理选定的视图模型，但不允许知道或测试这些视图模型？听起来你在其他地方做错了什么......

**更新：**当我需要一个 ModelMetadata 提供者时，我创建了一个看起来像这样的提供者......

```
public class MyMetadataProvider : DataAnnotationsModelMetadataProvider
{
    protected override ModelMetadata CreateMetadata(IEnumerable<Attribute> attributes, Type containerType, Func<object> modelAccessor, Type modelType, string propertyName)
    {
        if ((containerType != typeof(MyType))
            return base.CreateMetadata(attributes, containerType, modelAccessor, modelType, propertyName);

        //setup custom ModelMetadata here
    }
} 
```

# ipython - 使用 rmagic 扩展的 Ipython 笔记本崩溃

> ID：14691400
> 
> 赞同：2
> 
> 时间：2013-02-04T16:50:13.667
> 
> 标签：ipython, rpy2

我正在尝试运行[rmagic 函数扩展](http://nbviewer.ipython.org/urls/raw.github.com/ipython/ipython/3607712653c66d63e0d7f13f073bde8c0f209ba8/docs/examples/notebooks/rmagic_extension.ipynb)示例，但 ipython 崩溃并显示控制台错误消息 '\u 在以“c:\u”开头的字符串中未使用十六进制数字。我怀疑这是由 rmagic 传递 c:\path 而不是 c:\ 或 c:/ 引起的 R 错误消息。

可能有一种简单的方法可以解决这个问题（IPython 或 Notebook 启动参数？），但是，作为 rmagic 和 rpy2 的新手，我需要一些专家的帮助。

示例中的以下简单片段会导致内核死机：

```
import rpy2
%load_ext rmagic
%R x=1 
```

我是windows用户...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:51:20.553

[在这里](https://github.com/ipython/ipython/issues/2533)找到了这个 ipython/windows 问题的解决方案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-19T02:40:05.680

我是 Windows 用户。我去了我的 IPython 扩展文件夹，对我来说是： `C:\Python27\Lib\site-packages\IPython\extensions` 并打开`rmagic.py`编辑。找到线路

```
self.r('png("%s/Rplots%%03d.png",%s)' % (tmpd, png_args)) 
```

并将其替换为以下行：

```
self.r('png("%s/Rplots%%03d.png",%s, type="cairo")' % (tmpd.replace('\\', '/'), png_args)) 
```

[此处](https://github.com/ipython/ipython/issues/2533) 和[此处](https://groups.google.com/forum/#!topic/pythonxy/xX3lZFkX23g)描述了您这样做的原因

# entity-framework - Visual Studio 2012 迁移（实体框架）连接字符串错误

> ID：14691404
> 
> 赞同：0
> 
> 时间：2013-02-04T16:50:32.457
> 
> 标签：entity-framework, visual-studio-2012, migration, connection-string

我正在使用 Visual Studio 2012，EF，尝试使用控制台更新我的数据库，但它失败了。我收到一条消息，表明连接字符串不正确，尽管实际上它很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T08:40:29.297

只是想将这条信息分享给任何可能需要它的人。

如果您收到连接字符串错误，并且在检查字符串的实际有效性后，您仍然遇到迁移问题，您可能需要尝试在解决方案中设置作为启动项目的数据库更新项目（并在那里设置连接字符串，就像它应该的那样）。

显然 VS 使用启动项目的配置文件。

希望这可以帮助。

# java - 在 Spring 中向 Advice 发送外部参数

> ID：14691406
> 
> 赞同：2
> 
> 时间：2013-02-04T16:50:34.117
> 
> 标签：java, spring, spring-aop

我需要确保特定方法的执行时间小于指定值。我想做一些类似以下的事情

```
@Around("execution(* com.foo.bar.executeTask2(..))" + " && someExternalParams(500)")
@Around("execution(* com.foo.bar.executeTask(..))" + " && someExternalParams(5)")
public void checkSLA(ProceedingJoinPoint joinPoint, int maxtime) throws Throwable {

//get staarttime
joinPoint.proceed();
// get endtime

if(endtime - starttime > maxtime)
  System.out.println("Task took longertime");

} 
```

如何使用 Spring AOP 实现这一点。一种解决方案是从文件中读取最大时间。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T21:11:56.487

嗨，您可以`@SLA`在您的方面进行注释并从中读取该值。您显然必须更改建议以匹配该注释并用`@SLA`注释标记您的所有方法。

它与您的方法有点不同，但我认为为这种方面进行注释会更好。这样，您不必每次要处理新方法时都更新切入点。只需为此方法添加注释即可。请参见下面的示例。

注解：

```
@Target(METHOD)
@Retention(RUNTIME)
public @interface SLA {
    int maxtime();
} 
```

方面：

```
@Aspect
public SLAAscpet {
    @Around("execution(@com.foo.bar.SLA * *(..))")
    public void aroundSLAMethod(final JoinPoint joinPoint) {
        MethodSignature signature = (MethodSignature) joinPoint.getSignature();
        SLA annotation = signature.getMethod().getAnnotation(SLA.class)
        int maxtime = annotation.maxtime()
        ...
    }
} 
```

用法：

```
...
@SLA(maxtime=500)
public void someMethodForSLA() {
     ...
}
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T17:34:54.503

你的方面是 Spring 管理的，所以我会从我的方面 bean 中的属性中读取。

```
@Aspect
public class MyAspect {
    @Value("${my.system.property.for.max.time}")
    private int maxTime;

    @Around("execution(* com.foo.bar.executeTask(..))")
    public void checkSLA(ProceedingJoinPoint joinPoint) throws Throwable {

        //get staarttime
        joinPoint.proceed();
        // get endtime

        if(endtime - starttime > maxTime)
            System.out.println("Task took longertime");
        }
    }
} 
```

# java - 从 Web 应用程序获取 Alfresco 内容

> ID：14691408
> 
> 赞同：0
> 
> 时间：2013-02-04T16:50:48.697
> 
> 标签：java, rest, repository, alfresco

直到今天，我都使用 RESTFul Api 从 Alfresco 存储库中提取内容，因此，通过 Alfresco Web 脚本，我能够获得所需的正确内容。直到今天。现在，我需要从 Alfresco 中提取翻译的内容，但似乎 Alfresco Javascript API 不支持内容的多语言翻译。您知道还有另一种方法可以从我的 Web 应用程序中获取 Alfresco 内容吗？

我尝试使用 Alfresco Web Service API for Java：

```
WebServiceFactory.setEndpointAddress(alfresco_webservicefactory);
AuthenticationUtils.startSession(getAlfrescoLogin(session), getAlfrescoPassword(session)); 
```

但我得到了这个例外：

```
05:41:25,576 ERROR ApplicationProperty [72]  - Can not initiate session with Alfresco server.
 java.lang.NullPointerException
    at org.apache.axis.client.Service.getEngineConfiguration(Service.java:813) 
```

似乎无法打开从我的 Tomcat 到 Alfresco 的连接，因为从一个简单的 Java 主类尝试它可以工作（但非常慢且不适用于 Web 应用程序）

有什么建议吗？

# java - 比较 JUnit 中的两个对象数组

> ID：14691410
> 
> 赞同：-2
> 
> 时间：2013-02-04T16:51:02.927
> 
> 标签：java, arrays, junit, tdd

我已经实现了一个纸牌游戏，需要测试洗牌方法。我正在使用 netbeans 7.2，现在遇到问题，因为在我调用 instance.shuffleDeck 方法后，deckBeforeShuffle 是空的，所以我无法将它与我的 deckAfterShuffle 数组进行比较以查看它是否被洗牌！这是我第一次使用 JUnit 并尝试了不同的方法来解决这个问题，但一切都是徒劳的。

```
@Test
public void testShuffleDeck() {
    System.out.println("shuffleDeck");
    CardDeck instance = new CardDeck(1);
    ArrayList<Card> deckBeforeShuffle = instance.getDeck();         
    instance.shuffleDeck();        
    ArrayList<Card> deckAfterShuffle = instance.getDeck();        
    boolean isShuffled = false;
    int position = 0;
    System.out.println(deckBeforeShuffle.size());
    while(position<deckBeforeShuffle.size() && !isShuffled){

        if(deckBeforeShuffle.get(position).getSuitValue() != deckAfterShuffle.get(position).getSuitValue() && deckBeforeShuffle.get(position).getvalue() != deckAfterShuffle.get(position).getvalue()){

        isShuffled = true;

        }
        position++;
    }
    assertEquals(true, isShuffled); 
} 
```

我的洗牌方法！

公共无效 shuffleDeck(){

```
 ArrayList<Card> temp = new ArrayList();
    Random rand = new Random();
    int position;
    while(deck.size() > 0){

        position = rand.nextInt(deck.size());
        temp.add(deck.remove(position));
    }
    deck = temp;
} 
```

我很感激任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T16:56:25.970

实际上，检查不等式就足够了。List 的[`equals()`](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#equals%28java.lang.Object%29)方法将负责其余的工作。

```
assertFalse(deckBeforeShuffle.equals(deckAfterShuffle)); // not equal
assertEquals(deckBeforeShuffle.size(), deckAfterShuffle.size()); // but same size
assertEquals( // and same number of elements
    new HashSet<Card>(deckBeforeShuffle), new HashSet<Card>(deckAfterShuffle); 
```

而对于洗牌，你可以使用现有的[`Collections.shuffle()`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#shuffle%28java.util.List%29)方法。但是请注意，您必须先复制列表，然后再对其进行洗牌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T19:39:41.083

正如这个答案（以及互联网上的许多其他来源）中所描述的，有[assertArrayEquals()](https://stackoverflow.com/questions/3457941/using-assertarrayequals-in-unit-tests#3458053)，它正是这样做的。

# javascript - 实时浏览器大小检测

> ID：14691412
> 
> 赞同：1
> 
> 时间：2013-02-04T16:51:06.363
> 
> 标签：javascript, jquery, css, responsive-design

此代码仅根据加载时浏览器的大小起作用，只是想知道我可以为它实现什么以获得当前浏览器大小并根据当前信息工作。

我尝试过将其包裹起来，`resize()`但它会导致其行为异常，即切换开关连续打开和关闭，或者在缩小的浏览器中加载时它根本不起作用。

它是一个响应式网站，页脚菜单只是大屏幕上的静态链接，但在小屏幕上变成下拉菜单。

```
 var myWidth = 0, myHeight = 0;

    if( typeof( window.innerWidth ) == 'number' ) {
        //Non-IE
        myWidth = window.innerWidth;
        myHeight = window.innerHeight;
    } else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {
        //IE 6+ in 'standards compliant mode'
        myWidth = document.documentElement.clientWidth;
        myHeight = document.documentElement.clientHeight;
    }   

    if(myWidth < 980) {
        $("#footer h3").click(function () {
                $(this).toggleClass("active");
                $(this).parent().find("ul").slideToggle('medium');      
        });
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T16:57:02.100

```
var myWidth = 0, myHeight = 0;

function getSize(){

    if( typeof( window.innerWidth ) == 'number' ) {
        //Non-IE
        myWidth = window.innerWidth;
        myHeight = window.innerHeight;
    } else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {
        //IE 6+ in 'standards compliant mode'
        myWidth = document.documentElement.clientWidth;
        myHeight = document.documentElement.clientHeight;
    }

}

getSize(); // run first time

$(window).resize(function(){
  getSize(); // do it on resize
});

$("#footer h3").click(function () {

        getSize();  // not needed but good to have

        if(myWidth < 980) {
            $(this).toggleClass("active");
            $(this).parent().find("ul").slideToggle('medium');
        }

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T16:56:17.960

您应该改用 css 媒体查询：

```
@media only screen and (max-device-width: 980px) {
   // css goes here...   
} 
```

或者包括条件样式表：

```
<link rel="stylesheet" type="text/css" media="only screen and (max-device-width: 480px)" href="small-device.css" /> 
```

[这是一篇不使用响应式设计的好文章](http://alistapart.com/article/responsive-web-design)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T16:55:41.383

尝试这样的事情：

```
var waitForFinalEvent = (function () {
    var timers = {};
    return function (callback, ms, uniqueId) {
        if (!uniqueId) uniqueId = "Don't call this twice";
        if (timers[uniqueId]) clearTimeout (timers[uniqueId]);
        timers[uniqueId] = setTimeout(callback, ms);
    };
})();

$(window).resize(function(){
    waitForFinalEvent(function(){
        // put all your code here 
    }, 20, "resize"); // replace 20 with every milliseconds to execute during
                      // resize
}) 
```

每次调整窗口大小时，您放入其中的代码都会执行，简单地使用`resize()`并不总是有效，因为它不一定会在您调整大小时进行检查。

# html - 我必须包含html标签吗？

> ID：14691415
> 
> 赞同：-1
> 
> 时间：2013-02-04T16:51:09.593
> 
> 标签：html

我知道这可能听起来像一个愚蠢的问题，但我有一个 .php 文件，我在其中使用 html 标签和 php 代码。标签中不包含任何内容`<html>`，但所有 html 元素似乎都显示得很好。那么这个标签有什么用呢？包括`<html>`标签真的有影响吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T16:52:12.667

元素的开始和结束标签`html`被[定义为可选](http://www.w3.org/TR/html4/struct/global.html#edef-HTML)的（如果上下文要求元素开始或结束，则将由解析器插入）。但是，如果您没有开始标签，`html`则不能`lang`在其上放置属性，并且[应该包含`lang`属性](http://www.w3.org/TR/WCAG20-TECHS/H57.html)。

# php - isset 方法不起作用。请看代码卡在奇怪的情况下

> ID：14691418
> 
> 赞同：-2
> 
> 时间：2013-02-04T16:51:14.787
> 
> 标签：php, html

该`isset`方法对我不起作用。请查看代码，我陷入了奇怪的境地：当我点击登录时，点击注册时什么也没有发生......

返回寄存器作为输出！。对不起，如果这个 qstn 很愚蠢..

```
<?php if (isset($_POST['register'])){
echo "register";}
if (isset($_POST['login'])){
echo "login";}
?>
<form action= "" method="post"  > 
<input type="submit" name="Login"  value="login" />
</form>

<form action= "" method="post"  > 

<input type="submit" name="register"  />

</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T16:53:49.040

改变

```
<input type="submit" name="Login"  value="login" /> 
```

至

```
<input type="submit" name="login"  value="login" /> 
```

请注意大写 L。数组键 in`$_POST`区分大小写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T16:54:27.753

您正在测试小写`login`，但 HTML 中元素的名称是`Login`.

如果您将登录按钮的名称更改为“登录”，它将按您的需要工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T16:56:07.570

你需要这条线

```
<input type="submit" name="login"  value="login" /> 
```

您的代码正在寻找按钮的名称，而您的大写字母放错了位置！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T16:56:37.347

改变这个：

```
<input type="submit" name="Login"  value="login" /> 
```

接着就，随即：

```
<input type="submit" name="login"  value="login" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-04T16:55:06.440

数组键区分大小写。

试试“if (isset($_POST['Login'])){”

请注意，您的登录按钮的名称为“登录”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-04T16:55:58.153

检查字母，您在表单中使用了小写字母，并且正在检查 php 条件中的大写字母

```
if (isset($_POST['Login'])){ 
```

更改`<input type="submit" name="Login" value="login" />`为`<input type="submit" name="Login" value="Login" />`或更改 `if (isset($_POST['Login'])){`为 `if (isset($_POST['login'])){`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-04T16:57:18.133

登录名必须小写。

寄存器需要一个值。

# php - PHP 警告：wpdb::prepare() 缺少参数 2

> ID：14691427
> 
> 赞同：-1
> 
> 时间：2013-02-04T16:51:43.040
> 
> 标签：php, wordpress

大家好，我收到此错误消息：

```
Warning: Missing argument 2 for wpdb::prepare(), called in /home/url.com/wp-content/plugins/WPEC-Personalize-3.8/wpec-personalization.php on line 228 and 326 and defined in /home/url.com/wp-includes/wp-db.php on line 990 
```

我在第 228 和 326 行找到了代码：

```
$add = $wpdb->get_var($wpdb->prepare("SELECT enabled FROM ". $table_name ." WHERE pers_id  = ". $myresults->pers_id." AND product_id = ".$product_id)); 
```

并将其更改为新的 wordpress（3.5 查询）标准：

```
$add = $wpdb->get_var( $wpdb->prepare(
    "SELECT enabled FROM %s WHERE pers_id = %d AND product_id = %d",
    $table_name, 
    $myresults->pers_id, 
    $product_id
)); 
```

我不确定我做错了什么，但是当我更新下面的代码时，我停止收到错误消息，但每次我更新产品时，它都会复制插件正在创建的所有自定义字段。

参见示例：[https ://www.americasfinestmailbox.com/products-page/birds/hummingbird-vertical/](https://www.americasfinestmailbox.com/products-page/birds/hummingbird-vertical/)

任何帮助将不胜感激，因为插件作者不再支持此插件。

我在这里粘贴了整个代码：http: [//www.pastebin.com/gxqEjee2](http://www.pastebin.com/gxqEjee2)

谢谢！威廉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:04:26.197

你的问题是设计问题。当您听到“这对安全性有好处”时，您想使用准备好的声明。但问题是您正在使用它们，就好像它们不是准备好的语句一样。

当您使用准备好的语句时，您希望您的程序像这样工作：

1.  发送和解析不带参数值的查询
2.  发送参数
3.  执行查询并到达 2，而无论参数如何，您都需要查询。

所以你不能在查询中给出参数*，*你必须给出占位符，在worldpress中，以`%`. 然后，在您`prepare`的方法中，您将给出这些值，以便它们将被安全地保护和发送。

# wpf - WPF 3D 光照强度

> ID：14691428
> 
> 赞同：4
> 
> 时间：2013-02-04T16:51:46.923
> 
> 标签：wpf, 3d, light, brightness

我有一个带有 AmbientLight 的 3D 场景。我想添加第二盏灯（SpotLight）来用红色照射一个区域。不幸的是，AmbientLight 比 Spotlight 亮得多，因此不可见。

有人有想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-21T16:40:10.867

在 WPF 中改变 AmbientLight 强度的方法是改变颜色。如果您希望光线不那么强烈，您只需将其设置为较暗的颜色（即灰色而不是白色或海军而不是蓝色）。

# c# - LINQ 查询在请求字节时返回 null

> ID：14691432
> 
> 赞同：2
> 
> 时间：2013-02-04T16:52:03.273
> 
> 标签：c#, asp.net-mvc, linq

我正在尝试使用 MVC 制作可下载的曲目。这是我的代码：

```
public ActionResult DownloadTrack(int albumid, int trackid)
    {
        var track = (from x in database.songs
                     where x.ALBUM_ID == albumid &&
                     x.TRACK_ID == trackid
                     select x).First();
        Byte[] Song = track.MP3;
        return File(Song, ".mp3", "test");
    } 
```

当代码到达 Byte[] Song 它说 track.MP3 = null 但是当我查询我的数据库时它说它已满......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T13:17:53.963

**First**运算符返回序列的第一个元素或与谓词匹配的序列的第一个元素，具体取决于使用的原型。

**顺便说一句：** 如果任何参数为空，则会引发 ArgumentNullException。如果源序列为空或谓词从不返回 true，则会引发 InvalidOperationException。

因此，where 子句中使用的标准很可能不会产生任何结果。

**建议如下：**

**a) 如果您使用的是 MS SQL Server，请使用 SQL Profiler 并确保将正确的 SQL 应用于 DB（从 LINQ 生成的 SQL）**

*   打开 SQL Server 管理工作室
*   转到工具 - SQL Server Profiler
*   同意打开的跟踪属性对话框中的默认值，单击“运行”</li>
*   运行上面提到的 LINQ 并检查 SQL Profiler 中的 SQL 语句（您可以将分析器中的 SQL 直接复制并粘贴到 DB 中，运行并查看它是否产生所需的结果，如果没有，请修改 LINQ）。

**b) 建议使用FirstOrDefault，并处理返回的null**

# google-apps-script - 我可以通过谷歌应用脚 本更改谷歌驱动器项目的所有权吗？

> ID：14691433
> 
> 赞同：0
> 
> 时间：2013-02-04T16:52:03.820
> 
> 标签：google-apps-script, google-drive-api

我进入了一个谷歌应用程序域，我是«超级管理员»。

我知道我可以通过谷歌应用程序控制面板来完成，虽然我更喜欢通过脚本来完成，因为控制面板方式会创建一个新文件夹并将其所有权转移到旧的和新的文件链接文件夹，一个我很不喜欢的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:14:49.903

[Romain Vialard](https://stackoverflow.com/users/1370762/romain-vialard)（GAS 的[主要贡献者](https://developers.google.com/apps-script/support)之一）创建了一个处理该案例的库（以及其他；-）您可以[在此页面上找到所有信息](https://sites.google.com/site/scriptsexamples/new-connectors-to-google-services/driveservice)。

# c# - 如果 ModelState 状态无效，则包含有效字段

> ID：14691434
> 
> 赞同：0
> 
> 时间：2013-02-04T16:52:06.900
> 
> 标签：c#, asp.net-mvc, validation, asp.net-web-api, modelstate

在 ASP.NET Web API 中，我想在向调用者返回错误时包含一个有效字段。

```
public class User 
{
    [Required(ErrorMessage = "ThirdPartyID is required!")]
    public int ThirdPartyID { get; set; }
    [Required(ErrorMessage = "Firstname is required!")]
    public string Firstname { get; set; }
    [Required(ErrorMessage = "Lastname is required!")]
    public string Lastname { get; set; }
} 
```

当调用者发布具有 ThirdParyID 集和 Firstname 集但没有 Lastname 的用户时，我想将 ThirdPartyID 添加到响应中。我正在使用下面的模型验证。

```
public class ModelValidationFilterAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(HttpActionContext actionContext)
    {
        if (actionContext.ModelState.IsValid == false)
        {
            actionContext.Response = actionContext.Request.CreateErrorResponse(HttpStatusCode.BadRequest, actionContext.ModelState);
        }
    }
} 
```

我可以在 User 上设置一些东西来指示应该始终将 ThirdPartyID 包含在返回的错误消息中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:55:05.787

您可以使用 ModelState.AddModelError 方法。

```
ModelState.AddModelError("VariableName", "Error Message"); 
```

# javascript - IE8 中的 decodeURIComponent 错误

> ID：14691437
> 
> 赞同：0
> 
> 时间：2013-02-04T16:52:26.847
> 
> 标签：javascript, internet-explorer, internet-explorer-8, coffeescript, urlencode

我有一个作为 iframe 加载的小部件。它必须知道有关托管页面的一些数据。我有几个从页面获得的 UTF-8 字符串。通常它们是一些俄文文本。页面本身可以使用适当的 HTML5 文档类型和元字符集规范。

然后我的代码是这样工作的：

```
params = "x1=" + encodeURIComponent(s1) + "&x2=" + encodeURIComponent(s2)
url = "http://mysite.com/iframe.html#" + params

create_iframe(url) 
```

create_iframe 在哪里

```
var $if, doc;

$if = $('<iframe>').attr({
  frameborder: 0,
  scrolling: "no",
  allowtransparency: "true"
}).css(css).appendTo($cont);

doc = $if[0].contentWindow.document;

doc.open().write("<head><meta charset=\"UTF-8\"><script>" +
    "var s = \"" + url + "\";" + // <--- here the url is injected into the iframe content
    "function init() { document.location.href = s; }" + 
     "</script></head><body onload=\"init();\">...</body>");

doc.close(); 
```

这里我们使用 jQuery 创建一个 iframe，然后写入其内容以使其加载我们的`url`.

最后，当“ [http://mysite.com/iframe.html](http://mysite.com/iframe.html) ” URL 加载到 iframe 中时，其中的脚本会从哈希中获取参数值：

```
var hash_index, loc, param, params, params_array, params_string, tmp, _i, _len;

loc = document.location.href;

hash_index = loc.indexOf('#');

if (hash_index >= 0) {
  params_string = loc.substring(hash_index + 1);
}

params_array = params_string ? params_string.split('&') : [];

params = {};

for (_i = 0, _len = params_array.length; _i < _len; _i++) {
  param = params_array[_i];
  tmp = param.split('=');
  params[tmp[0]] = decodeURIComponent(tmp[1]);
}

return params; 
```

整个事情在 Chrome 中运行良好。

**在 IE8 中，我在尝试解码 URI 时收到错误消息，提示编码无效**

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:37:13.533

答案是 - IE 截断了太长的 URL，它发生在 2 个 UTF-8 字节之间。

# c - 如何使用 pthread_exit() 重用线程

> ID：14691439
> 
> 赞同：2
> 
> 时间：2013-02-04T16:52:29.933
> 
> 标签：c, pthreads

我的计算机每个进程允许 380 个线程，这对我来说很好。调用sdfpthread_create()函数380次都没问题。但连续调用返回错误 11（资源暂时不可用）。

明显的解决方法是使用pthread_exit()，但是我没有解决问题，限制还是380个线程创建。

我如何重用线程？

```
 #include <stdio.h>
    #include <string.h>
    #include <pthread.h>
    #include <stdlib.h>
    #include <unistd.h>

    void *doSomeThing()
    {
        sleep(99);
        pthread_exit(NULL);
    }

    int main(void)
    {
        pthread_t tid;
        int i;
        int err;

        /* Create threads */
        for (i=0; i<380; ++i)  {
            err = pthread_create(&tid, NULL, doSomeThing, NULL);
            if (err != 0)
                printf("\n1) Can't create thread :[%s]", strerror(err));
        }

        sleep(1);

        /* Reuse threads */
        for (i=0; i<5; ++i)  {
            err = pthread_create(&tid, NULL, doSomeThing, NULL);
            if (err != 0)
                printf("\n2) Can't create thread :[%s]", strerror(err));
        }

        exit(0);
    } 

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T16:57:36.713

您需要调用[`pthread_join(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/pthread_join.3.html)以实际清理线程退出状态，或创建不可连接的线程。

### 编辑0：

请参阅*并阅读*：

*   [`pthread_create(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/pthread_create.3.html)
*   [`pthread_detach(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/pthread_detach.3.html)
*   [`pthread_attr_setdetachstate(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/pthread_attr_setdetachstate.3.html)

# c++ - 尝试编译 C++ 代码并得到错误 LNK1104 无法打开文件 ifwin.lib

> ID：14691440
> 
> 赞同：0
> 
> 时间：2013-02-04T16:52:30.760
> 
> 标签：c++, linker, lnk

我的问题是“错误 LNK1104：无法打开文件“ifwin.lib””我已经尝试转到属性 -> 链接器 -> 输入 -> 附加依赖项并以这种方式添加它。我已经尝试过属性-> 链接器-> 输入-> 忽略特定的默认库，但没有奏效。我在网上寻找可以下载图书馆的地方。所以我带着我的问题来找“你”，希望得到一点指导。

# android - Activity 在切换到横向之前以纵向闪烁

> ID：14691443
> 
> 赞同：0
> 
> 时间：2013-02-04T16:52:41.010
> 
> 标签：android, android-activity, screen-orientation

我正在创建一个 android 游戏，其中每个活动都设置为 xml 清单文件中的横向。

但是，有时在进行新活动时，它会以纵向闪烁一秒钟，然后再校正为横向。

有没有人有任何一般性的原因？

它发生在使用 ScheduledFuture 过早退出关卡完成屏幕时

谢谢安迪

编辑（清单）：

```
 <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.appsolutely.sheepherder"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="com.appsolutely.sheepherder.Main"
        android:label="@string/app_name"
        android:screenOrientation="landscape" >
    </activity>
    <activity
        android:name="com.appsolutely.sheepherder.Game"
        android:label="@string/title_activity_game"
        android:screenOrientation="landscape" >
        <meta-data
            android:name="android.support.PARENT_ACTIVITY"
            android:value="com.appsolutely.sheepherder.LevelSelect" />
    </activity>
    <activity
        android:name="com.appsolutely.sheepherder.LevelSelect"
        android:label="@string/title_activity_level_select"
        android:screenOrientation="landscape" >
        <meta-data
            android:name="android.support.PARENT_ACTIVITY"
            android:value="com.appsolutely.sheepherder.Main" />
    </activity>
    <activity
        android:name="com.appsolutely.sheepherder.Splash"
        android:label="@string/app_name"
        android:screenOrientation="landscape" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.appsolutely.sheepherder.Plague"
        android:label="@string/title_activity_plague"
        android:screenOrientation="landscape"  >
        <meta-data
            android:name="android.support.PARENT_ACTIVITY"
            android:value="com.appsolutely.sheepherder.Main" />
    </activity>
</application> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:59:53.203

尝试添加[`screenOrientation`](http://developer.android.com/guide/topics/manifest/activity-element.html#screen)到您的清单：

```
<activity android:screenOrientation="sensorLandscape" ...> 
```

我建议使用`sensorLandscape`，以便用户可以选择是向右还是向左旋转 div。

# facebook - Facebook SDK 3.1.1 & iOS 6.1 登录错误

> ID：14691444
> 
> 赞同：2
> 
> 时间：2013-02-04T16:52:41.760
> 
> 标签：facebook, ios6, facebook-ios-sdk

我知道这看起来像是一个重复的问题，但我已经查看了与此相关的堆栈溢出的每一个问题，但我仍然收到以下错误：

```
Error Domain=com.facebook.sdk Code=2 "The operation couldn’t be completed. 
(com.facebook.sdk error 2.)" UserInfo=0x1ecbf8e0       
{com.facebook.sdk:ErrorLoginFailedReason=com.facebook.sdk:ErrorLoginFailedReason} 
```

这就是 NSError 的整个 NSLog ..

我已按照教程对信件进行身份验证；

*   在developers.facebook.com 上，我已将我的应用程序设为原生iOS 应用程序，并放入我的捆绑包ID
*   在我的 info.plist 中，我包含了 URL 类型 > 项目 0 > URL 方案 > 项目 0 > fb123456 和 FacebookAppID = 123456，密钥。

我正在尝试使用以下代码进行身份验证；

```
[FBSession openActiveSessionWithReadPermissions:permissions
                               allowLoginUI:YES
                          completionHandler:
 ^(FBSession *session,
   FBSessionState state, NSError *error) {
     [self sessionStateChanged:session state:state error:error];
 }]; 
```

权限设置为零。

我的应用程序委托中也有以下设置

```
- (void)applicationDidBecomeActive:(UIApplication *)application
{
[FBSession.activeSession handleDidBecomeActive];
}

- (void)applicationWillTerminate:(UIApplication *)application
{
[FBSession.activeSession close];
}

- (BOOL)application:(UIApplication *)application
        openURL:(NSURL *)url
  sourceApplication:(NSString *)sourceApplication
     annotation:(id)annotation {
return [FBSession.activeSession handleOpenURL:url];
}

- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url
{
return [FBSession.activeSession handleOpenURL:url];
} 
```

我注意到的一件事是，在我松开按钮后，错误消息几乎立即出现在我的屏幕上，我将手机置于飞行模式并且速度相同，我认为该命令甚至没有离开手机并要去首先是 facebook 服务器。我肯定有网络连接，因为我在 facebook 调用之前访问了一个 google api。

编辑：

如果我使用下面不推荐使用的方法

```
[FBSession openActiveSessionWithPermissions:nil allowLoginUI:YES completionHandler:
 ^(FBSession *session,
   FBSessionState state, NSError *error) {
     [self sessionStateChanged:session state:state error:error];
 }]; 
```

我可以通过 facebook 进行身份验证。

返回的会话是

```
<FBSession: 0x20038450, state: FBSessionStateOpen, loginHandler: 0x2006ba90, appID: 3895930xxxxxxxx, urlSchemeSuffix: , tokenCachingStrategy:<FBSessionTokenCachingStrategy: 0x1ed4ce30>, expirationDate: 2013-04-08 16:25:19 +0000, refreshDate: 2013-02-07 16:25:19 +0000, attemptedRefreshDate: 0001-12-30 00:00:00 +0000, permissions:(
)> 
```

与使用更新的 3.1.1 方法的失败尝试相比此会话

```
<FBSession: 0x1e8970b0, state: FBSessionStateClosedLoginFailed, loginHandler: 0x0, appID: 3895930xxxxxxxx, urlSchemeSuffix: , tokenCachingStrategy:<FBSessionTokenCachingStrategy: 0x1d5853b0>, expirationDate: (null), refreshDate: (null), attemptedRefreshDate: 0001-12-30 00:00:00 +0000, permissions:(
)> 
```

我假设成功登录后会创建丢失的 loginHandler 对象。

虽然这允许我使用我的登录令牌继续开发我的应用程序的其余部分，但我不能接受将我的应用程序实时发送。有谁知道为什么会发生这种情况/可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-10T15:48:16.933

我在 2 个实例上遇到了同样的错误。

1.  当您的 iPhone 在 Settings -> Facebook -> YourAppName 下未打开开关时，以允许您的应用程序使用 facebook 帐户。在这种情况下，我会显示一条警报，要求用户打开应用程序的开关。

2.  当您的应用程序包标识符与您在 Facebook 应用程序设置页面上为您的应用程序指定的包标识符不匹配时。

由于即使没有互联网连接也会发生错误，我认为应该是第一种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:23:19.760

我有一个类似的问题。当我从设置切换 fb 用户时出现错误。[在设备上切换 FB 帐户时，iOS6 上的 Facebook 授权失败](https://stackoverflow.com/questions/12838118/facebook-authorization-fails-on-ios6-when-switching-fb-account-on-device)这解决了我的问题

# performance - 查找文本是否包含列表中的任何单词。哪个更快，为什么？

> ID：14691445
> 
> 赞同：1
> 
> 时间：2013-02-04T16:52:43.960
> 
> 标签：performance, algorithm, text

可能有更好的解决方案，但我首先想到的两个是：

1) 对于列表中的每个单词，检查文本是否包含该单词 2) 将单词存储在集合中。将单词（用空格分隔的任何内容 - 不必太准确）从另一个集合中的文本存储并检查 2 个集合的交集是否为空

我不知道哪个会更好，或者它们是否差不多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T21:59:13.423

这就是集合匹配问题。

让`S`一组模式、`T`你的文本和`n`S 中的元素数量在 T 中找到。然后你可以在时间 O(|T| + |S| + n) [*]**中找到文本中 S 中所有元素的出现**使用[Aho–Corasick 字符串匹配算法](http://en.wikipedia.org/wiki/Aho%E2%80%93Corasick_string_matching_algorithm)。

鉴于您只想找到第一次出现，在最坏的情况下，执行时间会减少到 O(|T| + |S|)，如果 S 足够小，那么它在文本长度上是线性的！

[*] |S| 是集合中所有单词的长度

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T09:23:02.557

从其中一个集合中创建一个[trie](http://en.wikipedia.org/wiki/Trie)，并在其中查找第二个集合的每个单词。考虑到字符串的平均长度为**k**，trie 构造需要**Θ(n*k)**时间，并且检查字符串是否属于 trie 需要**O(k)**。
为简单起见，您可以将运行时间视为**O((n+m)*k)**。然而，更精确的分析给出了**Θ(n*k) + O(n*k)**，因为您实际上可以在扫描整个第二组之前很久就完成。这表明最好从较小的集合构建特里树并从较大的集合中查找元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:13:38.673

n Java、Python 和 C++ 最复杂的实现不使用单一算法进行此类搜索。

使用哪种算法的决定将取决于文本大小、搜索频率、单词分布等。（多种算法也可以一起使用）

如果文本很大，并且您只需要在文本中搜索几个单词，则大多数实现都使用 Boyer-Moore 或 Rabin-Karp 算法的扩展版本。

像 Rabin-Karp 这样的算法，例如搜索一个哈希匹配，如果找到它而不是搜索整个单词，具有良好的滚动哈希函数，它很少发生，

与您的第一个建议相比，存储一组文本单词似乎是一个更好的解决方案，尽管存储单词的哈希值可能是更好的解决方案（哈希值和真实单词之间的附加映射）。

如果您的文本具有很高的独特性，它将无法保持集合。你有更多你所建议的解决方案，我建议你使用谷歌。

# python - Google App Engine 中的基本 Python 脚本，用于获取 GET 参数并相应地使用它

> ID：14691447
> 
> 赞同：0
> 
> 时间：2013-02-04T16:52:48.080
> 
> 标签：python, google-app-engine

我尝试了很多次谷歌搜索并在整个互联网上搜索，但没有找到任何相关的东西。我只想获取当前页面的GET参数。就像我们在 PHP 中写入该页面时得到**$query = $_GET['q']一样。**实际上，在得到这个结果后，我想使用决策声明。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:23:19.953

**网址：example.com?color="green"&flavour="mango"**

```
color_from_url = self.request.get('color')
flavour_from_url = self.request.get('flavour') 
```

你是这个意思吗？如果没有，您能否举例说明源数据（URL）和您想要从中获得的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:24:00.307

我认为这就是您正在寻找的：

[https://developers.google.com/appengine/docs/python/tools/webapp/requestclass](https://developers.google.com/appengine/docs/python/tools/webapp/requestclass)

# msbuild - Visual Studio 调试器只会从中间目录加载符号

> ID：14691450
> 
> 赞同：0
> 
> 时间：2013-02-04T16:52:59.447
> 
> 标签：msbuild, pdb

我有一个使用 MSBuild 构建的 Visual Studio 类库 DLL，当在调试配置中使用它时，它会将 DLL、PDB 和各种资源文件复制到 Web 应用程序中。我遇到的问题是，当我调试 Web 应用程序时，Visual Studio 2010 调试器只会加载 PDB 文件中的符号，这些符号位于构建期间创建的中间目录中。即使我在 VS 中指定符号位置以将文件夹包含在 Web 应用程序中，这始终会被忽略，并且 VS 总是直接进入中间位置，这显然是以某种方式硬编码到 DLL 中。此处的中间目录是指可以在 MSBuild 中使用 BaseIntermediateOutputPath 属性设置的文件夹，如果未明确包含此设置，它将默认创建一个 obj 文件夹。

为什么 Visual Studio 2010 调试器会这样做？我在项目属性的任何地方都看不到对 obj 文件夹的任何显式引用。在尝试配置远程调试器设置时，这给我带来了很大的困难。无论如何要覆盖这种行为，还是 VS 2010 中的错误？

以前有没有人遇到过这样的问题，如果有，有什么解决方法吗？

谢谢，如果你能帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:01:12.687

实际上 pdb 位置*嵌入*在 dll 中。您可以使用找到此路径

```
dumpbin /headers <your.dll> 
```

要搜索的第一个位置将是在您的 dll 中引用您的位置，如果您在与构建机器相同的机器上运行二进制文件，则会找到它。

请参阅有关 pdbs 的这篇精彩文章 @ [http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/05/11/pdb-files-what-every-developer-must-know.aspx](http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/05/11/pdb-files-what-every-developer-must-know.aspx)

本文末尾提供了一种使用自定义 subst.exe 的解决方法。希望有帮助。

# cakephp - 使用条件过滤 HABTM 相关模型

> ID：14691452
> 
> 赞同：5
> 
> 时间：2013-02-04T16:53:00.653
> 
> 标签：cakephp, model, filtering, conditional-statements

序言：几天前我问了一个解决HABTM过滤器的[问题](https://stackoverflow.com/questions/14562932/filter-conditions-from-an-association)，即使有教程我也无法做到，所以“Obi Kwan Kenobi 你是我唯一的希望”。

**我想要实现的目标：按在 StaffStaffgroup 中使用的 GroupID 过滤员工**

我有以下表格布局

*   员工（一个人可以属于多个组）
*   staff_staffgroups（HABTM 链接表）
*   staffgroups（有组名）

变量 $tmp 为我提供了一个工作数组，但问题是 Staff 是 StaffStaffgroups 的子对象。我可以解析并重新组装一个数组，但这不是一个好的解决方案。所以我想**在 Staff 上使用条件**（参见注释行），但随后出现错误 1054“未找到列：1054 未知列”。我尝试绑定和取消绑定，但没有结果。

```
$group_id = 2;
$tmp = $this->Staff->StaffStaffgroup->find('all',
        array('conditions' => array(
            'StaffStaffgroup.staffgroup_id' => $group_id,
            'Staff.isActive =' => "1",
            'Staff.last_name LIKE' => "%$name%",
            )
         )
);

debug($tmp); 
```

* * *

```
//$tmpConditions['AND'][] = array('StaffStaffgroup.staffgroup_id' => $group_ids); 
```

* * *

**编辑：**

我尝试了条件和可控制的行为，但不幸的是它根本没有过滤任何东西

```
 $this->Staff->contain(array('StaffStaffgroup'));
    $this->paginate = array('StaffStaffgroup' =>array(
                                    array('conditions'  => array(
                                            'StaffStaffgroup.staffgroup_id' => '2'
                                        )
                                    )
                                )
    ); 
```

*   我添加到所有模型中： public $actsAs = array('Containable');
*   我也尝试了内部连接，但没有过滤：

    ```
     $this->paginate = array( 
     'conditions' => array('StaffStaffgroup.staffgroup_id' => 2 ),
     'joins' => array(
        array(
            'alias' => 'StaffStaffgroup',
            'table' => 'staff_staffgroups',
            'type' => 'INNER',
            'conditions' => 'StaffGroup_id = StaffStaffgroup.staffgroup_id'
        )
     ) 
    ```

    );

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T14:06:52.350

您不能为此使用 Containable 行为。签出 sql 转储，您将看到查询已完成。

我会分两步做

从 StaffStaffgroup 获取属于您想要的组的员工 ID

```
$staff_ids = $this->Staff->StaffStaffgroup->find(
    'all', 
    array(
        'conditions' => array('StaffStaffgroup.staffgroup_id' => $group_id, ),
        'recursive' => -1,
        'fields' => array('StaffStaffgroup.staff_id'),
    )
); 
```

然后使用之前的结果获取所有员工

```
$staffs = $this->Staff->find(
    'all', 
    array(
        'conditions' => array(
            'Staff.id' => $staff_ids, 
            'Staff.isActive =' => "1",
            'Staff.last_name LIKE' => "%$name%",
        ),
    )
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T09:57:56.417

您应该调查 Containable 行为。

[http://book.cakephp.org/2.0/en/core-libraries/behaviors/containable.html](http://book.cakephp.org/2.0/en/core-libraries/behaviors/containable.html)

这将允许您查询您的 Staff 模型并包含您的 StaffStaffgroup 模型，从而为您提供以您想要的方式组织的数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-14T10:24:45.707

我意识到这个问题是很久以前提出的，但我的评论仍然可以帮助其他人找到这篇文章。

我创建了一个在幕后创建与 HABTM 关联的正确连接的行为，使您能够在 HABTM 模型上使用条件。

## 例子

**该模型：**

```
<?php
class Product extends AppModel {

    public $actsAs = array(
        'FilterHabtm.FilterHabtm',
        'Containable' // If you use containable it's very important to load it AFTER FilterHabtm
    );

    public $hasAndBelongsToMany = array(
        'Category' => array(
            'className' => 'Category',
            'foreignKey' => 'product_id',
            'associationForeignKey' => 'category_id',
            'with' => 'CategoryProduct'
        )
    );

} 
```

**控制器：**

*（行为使以下成为可能）*

```
<?php
class ProductsController extends AppController {

    public $name = 'Products';

    public function index($categoryId = null) {
        $products = $this->Product->find('all', array(
            'conditions' => array(
                'Category.id' => $categoryId // Filter by HABTM conditions
            )
        ));
    }

} 
```

请查看此 url 以获取下载和完整的使用说明：[https ://github.com/biesbjerg/FilterHabtm](https://github.com/biesbjerg/FilterHabtm)

# c# - 私有静态方法。一般好主意？

> ID：14691457
> 
> 赞同：1
> 
> 时间：2013-02-04T16:53:33.620
> 
> 标签：c#, oop, types

以下摘录来自 FX Cop 警告。

> 不访问实例数据或调用实例方法的方法可以标记为静态（在 Visual Basic 中为共享）。将方法标记为静态后，编译器将向这些成员发出非虚拟调用站点。发出非虚拟调用站点将阻止在运行时对每个调用进行检查，以确保当前对象指针不为空。这可以为性能敏感的代码带来可衡量的性能增益。在某些情况下，无法访问当前对象实例代表了正确性问题。

如果私有方法不访问实例数据或方法，我了解将其设为静态的性能优势，但我不确定在大多数情况下上述建议是否良好。如果您正在编写对性能至关重要的代码，并且您别无选择，那么您可以用 c# 编写它，我可以理解这种情绪，但考虑到一般来说，健壮、易于阅读和易于重构的代码应该优于性能你真的听从了这个建议吗？

私有静态方法的问题是，当您需要重构一个类时，我发现静态方法使这样做变得更加困难。如果您有大量静态方法，并且您需要更改一个以使用实例变量，并且该方法被其他私有静态方法使用，那么您最终必须进行更多更改才能使其正常工作。下面是一个例子（请记住，这是一个最小的实现，只是为了说明这一点）：

```
public class Test
    {
        private IService myService;

        private static void DoSomething()
        {
            DoSomethingElse();
        }

        private static void DoSomethingElse()
        {
            DoSomethingMore();
        }

        private static void DoSomethingMore()
        {
            Console.Write("DO SOMETHING");
        }
    } 
```

如果我想`myService`在 DoSomethingMore 方法中使用，这意味着我不仅必须使该方法成为非静态方法，而且还要使前两个方法成为非静态方法。这似乎很麻烦。

其他人对此有何看法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T17:01:18.193

> 这似乎很麻烦。

当您考虑在修改方法时*整个函数调用链*都依赖于一个实例时`DoSomethingMore`，更改“繁重”的感觉应该变成“必要”。

您应该首先考虑的是您正在编写的方法的语义。当您编写一个方法时，您需要问自己代码应该是实例方法（因为它在语义上应该是与单个实例关联的操作）还是静态方法（对于其他任何东西），并且该决定应该驱动您的编写方式方法。

在您**测量**出生产代码中不可接受的性能缺陷之前，您应该根据对您的域有意义的方法来制作方法实例或静态方法，而不是其他任何东西。

# apache - LAMPP 启动失败并出现错误 2

> ID：14691464
> 
> 赞同：0
> 
> 时间：2013-02-04T16:53:55.690
> 
> 标签：apache, ubuntu, xampp, lampp

我正在尝试建立一个网络服务器来测试我的 php 脚本。

我下载了最新版本的lampp（1.8.1）并将其解压到/opt/lampp。

现在我刚刚尝试启动它，但它失败了：

`xxx@xxx-pc1:/opt/lampp$ sudo /opt/lampp/lampp start
Starting XAMPP for Linux 1.8.1...
/opt/lampp/share/lampp/phpstatus: line 4: /opt/lampp/bin/php: cannot execute binary file
XAMPP: Starting Apache with SSL ...
/opt/lampp/bin/httpd: 1: /opt/lampp/bin/httpd: Syntax error: "(" unexpected
XAMPP: Error 2! Couldn't start Apache!
XAMPP: Starting diagnose...
XAMPP: Sorry, I've no idea what's going wrong.
XAMPP: Please contact our forum http://www.apachefriends.org/f/
XAMPP: Starting MySQL...
./bin/my_print_defaults: 1: ./bin/my_print_defaults: Syntax error: "(" unexpected
XAMPP: Couldn't start MySQL!
XAMPP: Starting ProFTPD... XAMPP: /opt/lampp/lampp: line 333: /opt/lampp/sbin/proftpd: cannot execute binary file
XAMPP: Error 126! Couln't start ProFTPD!
XAMPP for Linux started.
xxx@xxx-pc1:/opt/lampp$`

有人知道这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T21:30:35.050

您必须先安装 LAMP，然后它才能运行。在 Ubuntu 中执行此操作的最简单方法是运行此命令。

```
xxx@xxx-pc1: sudo tasksel 
```

这将启动 tasksel，它会打开一个对话框并允许您选择并安装多个组件，其中之一是 LAMP。安装 LAMP 将使您的 Apache、PHP 和 MySQL 全部打包并协同工作。它还将在 /etc/init.d 中创建一个条目以自动为您启动它。

如果未安装 Tasksel，则按如下方式安装：

```
xxx@xxx-pc1: sudo apt-get install tasksel 
```

一旦进入taskel，只需按照输入并提供一些基本答案，您就可以开始运行了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-27T05:40:04.070

“不能执行二进制文件”

如果您无法运行它，请访问[http://www.apachefriends.org/en/xampp-linux.html](http://www.apachefriends.org/en/xampp-linux.html)并下载适合您的 32 位/64 位操作系统的版本。要知道您使用的是哪一个，请输入以下命令 -

```
uname -m 
```

# wpf - 当前上下文中不存在名称“MyLibrary”

> ID：14691467
> 
> 赞同：1
> 
> 时间：2013-02-04T16:54:07.793
> 
> 标签：wpf, visual-studio-2010

当我尝试构建一个项目时，我遇到了这个错误：

`The name 'F7Utils' does not exist in the current context`

每当我尝试构建我的`WPF`项目时，我都会遇到这个错误。`F7Utils`顾名思义，是我自己创建的一个私有库。我在我的项目中引用它。所以，正如它所提到的，我不明白发生了什么......

这是我的结构：

![在此处输入图像描述](../Images/32736b097dea8302084ecfed73381ed6.png)

这就是我所说的：

```
String a = F7Utils.Nullable.NullValue.String; 
```

然后它启动错误。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T16:55:47.040

如果您的库不用`F7Utils`作该`Nullable`类型的命名空间，则可能会发生该错误。如果您的类型不在`public`您的库中，也会发生这种情况。

附带说明一下，我建议不要使用与框架类型相同的类型名称，例如`Nullable`，因为这只会导致您的代码难以维护。

# sql - 如何使用powershell在sql server 2008中执行多个.sql文件？

> ID：14691473
> 
> 赞同：0
> 
> 时间：2013-02-04T16:54:26.607
> 
> 标签：sql, sql-server-2008, powershell

我有 100 多个 .sql 文件要在 sql server 2008 R2 上执行。但我不想手动执行。所以，我搜索了可能的解决方案，发现我可以使用 powershell 来执行这些脚本，但我以前从未使用过 powershell。我发现下面提到的命令-

`Get-ChildItem ".\Stored Procedures\*.sql" | ForEach-Object { sqlcmd -S ServerName -d DatabaseName -E -i $_.FullName }`

我用我的参数替换了它-

`Get-ChildItem "C:\tables\*.sql" | ForEach-Object { sqlcmd -S 10.50.102.124 -d falhpdv1stage -E -i $_.FullName }`

执行此命令后，我刷新了我的数据库，但我无法看到新执行的表？我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:09:05.137

假设您在运行脚本的计算机上安装了 Management Studio：

```
add-pssnapin SqlServerCmdletSnapin100;
Get-ChildItem "C:\tables\*.sql" | ForEach-Object { invoke-sqlcmd -serverinstance 10.50.102.124 -database falhpdv1stage  -inputfile $_.FullName } 
```

这也假设其他一切都是正确的——正确编写的查询、对数据库的适当权限、正确的服务器 IP 和数据库名称等。

# python - 调试请求错误

> ID：14691477
> 
> 赞同：0
> 
> 时间：2013-02-04T16:54:41.387
> 
> 标签：python, python-requests

我有一个应用程序利用请求访问 API（Discogs）数据库。我希望能够在`.get`命令期间查看 URL Requests 实际请求的内容，以解决以下问题：

当我通过输入以下 URL 手动使用 HTTP 请求从 discogs 获取数据时：

```
http://api.discogs.com/database/search?type=master&year=2007&format=album&artist=Radiohead 
```

我收到 JSON 格式的结果。但是，当我以下列方式使用请求时：

```
uri = http://api.discogs.com/database/search
parameters = {'format': 'album', 'year': '2008', 'type': 'master', 'page': 1, 'artist': 'Radiohead'}
headers = (personal information redacted)
requests.get(uri, params=parameters, headers=self._headers) 
```

我没有得到任何结果（这是通过一个 discogs 客户端包装器来解析结果并将它们作为对象返回——我没有包含在此代码中的解析似乎工作正常，我已将问题隔离到请求） .

谁能告诉我我的`.get`请求有什么问题，或者告诉我如何使用请求来生成它实际请求的 URL（使用参数），以便我自己调试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:25:26.507

要在发送之前检查请求，您可以`prepare`这样做。

```
req = requests.Request(url=uri, params=params, headers=headers)
prep = req.prepare()
print(prep.url) 
```

印刷

```
http://api.discogs.com/database/search?year=2008&type=master&page=1&format=album&artist=Radiohead´ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T18:03:55.663

该`requests`库使用该`urllib3`库，该库又使用标准 python`logging`库来记录调试消息。以下配置将向您显示正在运行的确切请求：

```
import logging
logging.basicConfig(level=logging.DEBUG) 
```

这`logging`会将模块配置为在 stderr 上显示调试级别的消息（及以上）。

运行您的示例 URL 和参数，我看到：

```
>>> import logging
>>> import requests
>>> logging.basicConfig(level=logging.DEBUG)
>>> uri = 'http://api.discogs.com/database/search'
>>> parameters = {'format': 'album', 'year': '2008', 'type': 'master', 'page': 1, 'artist': 'Radiohead'}
>>> r = requests.get(uri, params=parameters)
INFO:requests.packages.urllib3.connectionpool:Starting new HTTP connection (1): api.discogs.com
DEBUG:requests.packages.urllib3.connectionpool:"GET /database/search?artist=Radiohead&year=2008&type=master&page=1&format=album HTTP/1.1" 200 379
>>> r.json()
{u'pagination': {u'per_page': 50, u'items': 1, u'pages': 1, u'urls': {}, u'page': 1}, u'results': [{u'style': [u'Experimental', u'Indie Rock'], u'thumb': u'http://api.discogs.com/image/R-90-1379425-1214572945.jpeg', u'format': [u'File', u'MPEG-4', u'Album', u'Copy Protected'], u'country': u'UK', u'title': u'Radiohead - In Rainbows - From The Basement', u'uri': u'/Radiohead-In-Rainbows-From-The-Basement/master/97298', u'label': [u'_Xurbia_Xendless Limited'], u'catno': u'none', u'year': u'2008', u'genre': [u'Electronic', u'Rock'], u'resource_url': u'http://api.discogs.com/masters/97298', u'type': u'master', u'id': 97298}]} 
```

所以对我来说，如果没有设置额外的标头，URL 肯定会按预期工作。

# c# - 如何设置接受稍后要声明的对象的参数？

> ID：14691478
> 
> 赞同：1
> 
> 时间：2013-02-04T16:54:44.873
> 
> 标签：c#, object

在制作游戏时，我偶然发现了一个小问题。我有一个方法 Attack() 必须在我的角色攻击敌人时执行。例如：

```
public override void Attack(Object theEnemy)
{          
      theEnemy.Health = theEnemy.Health - this.attack
} 
```

示例：我攻击一个精灵。Elf对象需要是参数，问题是参数是找Object，而不是Elf。如果我想攻击其他敌方物体，如兽人、矮人等，也是如此。我需要该参数才能接受任何物体。可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-04T16:57:16.747

在这种情况下，您可以使用接口，例如：

```
interface IEnemy
{
    void TakeDamage(int attackPower);
}

public Elf: IEnemy
{
    // sample implementation
    public void TakeDamage(int attackPower)
    {
        this.Health -= attackPower - this.Defense;
    }
}

// later on use IEnemy, which is implemented by all enemy creatures
void Attack(IEnemy theEnemy)
{          
      theEnemy.TakeDamage(attack)
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T16:58:54.550

似乎任何可以“攻击”的东西都必须实现一个接口，以便访问所需的属性和/或方法。

所以例如你可以做

```
public interface IAttackable
{
    void ReduceHealth(int amount);
} 
```

然后为任何可攻击的生物实施它 - 即精灵

```
public class Elf : IAttackable
{
    public void ReduceHealth(int amount)
    {
        this.Health -= amount;
    }
} 
```

那么用法将是

```
public override void Attack(IAttackable theEnemy)
{          
      theEnemy.ReduceHealth(this.attack);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-04T16:59:15.170

您可以创建每个敌人对象实现的接口，也可以创建每个敌人对象所基于的基类。

```
public interface IEnemyCreature{

void ReduceHealth(int Amount)

}

public Elf: IEnemyCreature{
...
} 
```

编辑 - WalkHard 比我更好地描述了代码 9-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-04T16:58:52.760

最好是分离关注点并使用 OOP 概念。使用界面。

```
interface IGameMethods
{
    void Attack(int yourValueForAttackMethod);
} 
```

实施

```
public Elf: IGameMethods
{
    // implementation of IGameMethods
} 
```

# list - 如何在prolog中找到列表的模式？

> ID：14691479
> 
> 赞同：2
> 
> 时间：2013-02-04T16:54:53.377
> 
> 标签：list, prolog, mode

有人可以告诉我如何在 Prolog 中找到列表的模式吗？

我试过这个：

```
count_elt([], _, 0) :- !. 
count_elt([H|T], H, P) :- 
  count_elt(T, H, P1),
  P is P1 + 1, !. 
count_elt([_|T], E, P) :- count_elt(T, E, P). 

listMode([], 0) :- !. 
listMode([_], 1) :- !. 
listMode([H1|[H2|T]], M) :- 
  count_elt([H1|[H2|T]], H1, C),
  listMode([H2|T], C1),
  C > C1,
  M is C, !. 
listMode([_|[H2|T]], M) :- listMode([H2|T], M). 
```

它只返回列表中出现的最多次数。但我需要返回出现次数最多的元素（列表中最频繁的值）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T17:26:01.270

您实际上与 非常接近`count_elt/3`，但您需要更多的非确定性。简而言之，你需要找到一种`count_elt/3`减少剪辑的方式来表达，因为现在你得到了这个：

```
?- count_elt([a,b,a,a,c,b,d,e,a,f], Y, X).
Y = a,
X = 4. 
```

而你想要得到的是：

```
?- count_elt([a,b,a,a,c,b,d,e,a,f], Y, X).
Y = a,
X = 4 ;
Y = b,
X = 2 ;
Y = c,
X = 1 ;
...
Y = f,
X = 1 ;
false. 
```

从那里您只是试图找到具有最大值的解决方案，您可以使用`setof/3`逻辑表达式或使用`aggregate`库来完成。所以首先修复`count_elt/3`并从那里开始。

**编辑**：一些一般性评论：

*   你可以写成`[H1|[H2|T]]`，`[H1,H2|T]`这样更清楚一点。
*   `listMode/2`可能应该将项目返回第二个位置而不是计数。由于您需要计数来执行此过程，因此您可能需要创建一个`listMode/3`或`listMode/5`帮助程序来在递归期间管理您的状态。

**编辑**：解决方案

由于@MaDu_LK 决定展示解决方案，即使这很可能是家庭作业，我想我会分享我的，使用[@false 的具体化相等谓词](https://stackoverflow.com/questions/13664870/reification-of-term-equality-inequality)：

```
count_of([],         _,  0).
count_of([H|Rest], E, N1) :- 
  equality_reified(H, E, Bool),
  count_of(Rest, E, N0),
  (Bool == true -> N1 is N0 + 1 ; N1 = N0).

frequency(L, I, N) :-
  sort(L, LSorted),
  member(I, LSorted),
  count_of(L, I, N).

mode(L, X) :-
  frequency(L, X, NMax),
  \+ (frequency(L, _, NBigger),
      NMax < NBigger). 
```

这具有更令人愉悦的性能特性：

```
% MaDu_LK
?- time(get_mode([a,b,c,a,b,c,a,a,b,c,a,d,b], X)).
% 2,811 inferences, 0.000 CPU in 0.000 seconds (100% CPU, 7117429 Lips)
X = a.

% mine
?- time(mode([a,b,c,a,b,c,a,a,b,c,a,d,b], X)).
% 217 inferences, 0.000 CPU in 0.000 seconds (98% CPU, 3144928 Lips)
X = a ;
% 195 inferences, 0.000 CPU in 0.000 seconds (97% CPU, 3305085 Lips)
false. 
```

即使列表是多模式的，另一种解决方案也只产生一种模式：

```
% MaDu_LK
?- get_mode([a,a,b,b,c], X).
X = a.

% mine
?- mode([a,a,b,b,c], X).
X = a ;
X = b ;
false. 
```

深思熟虑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T18:03:16.143

你已经从 Daniel 那里得到了关于你的代码的好建议。我将展示一种获取信息的库（[聚合）替代方法：](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%27A.1%27,swi%28%27/doc/Manual/aggregate.html%27%29%29)

```
mode_of_list(L, M) :-
    setof(C-E, (member(E, L), aggregate(count, member(E, L), C)), M). 
```

测试

```
?- mode_of_list([a,b,a,a,c,b,d,e,a,f],L).
L = [1-c, 1-d, 1-e, 1-f, 2-b, 4-a]. 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-05T01:34:43.613

希望你已经得到了一些建议。这是适合您的工作代码。

```
count_elt([],_,0):-!.
count_elt([H|T],H,C):-count_elt(T,H,C1),C is C1+1,!.
count_elt([_|T],E,C):-count_elt(T,E,C).

listMode([],0) :- !.
listMode([_],1) :- !.
listMode([H1|[H2|T]], M) :-count_elt([H1|[H2|T]],H1,C),listMode([H2|T],C1),C > C1,M is C,!.
listMode([_|[H2|T]],M) :- listMode([H2|T],M).

get_mode([H|T],M):-listMode([H|T],K),count_elt([H|T],M,K). 
```

# objective-c - 格式字符串不是字符串文字（可能不安全）

> ID：14691480
> 
> 赞同：6
> 
> 时间：2013-02-04T16:55:01.930
> 
> 标签：objective-c, compiler-warnings

> **可能重复：**
> [为什么我的字符串在我的 iOS 应用程序中可能不安全？](https://stackoverflow.com/questions/9961363/why-is-my-string-potentially-unsecure-in-my-ios-application)

将 XCode 升级到 4.6 后的新编译器警告：

![格式字符串不是字符串文字（可能不安全）](../Images/2dd4b18122e7d524adf0125714c458e3.png)

展示最后两行警告的最小示例：

```
 for (NSUInteger i = 0; i < 10; i++) {
    NSString *res = [testInstance generate:i];
    NSString *desc = [NSString stringWithFormat:@"TestData: %d", i];
    STAssertNotNil(res, desc);
    STAssertNotEquals(@"", res, desc);
  } 
```

我查看了与此警告有关的其他问题，但它们源于程序员不必要地使用`stringWithFormat:`- 这里我想要一个动态断言描述，它每次迭代都会改变，但不会每次检查。

我可以将格式字符串和数据传递到断言中，但是我必须独立维护描述。

**如果我要求在日志消息或断言调用中使用描述的格式之前，我该如何避免此警告？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T17:35:45.850

问题是断言中的非文字格式字符串。将它们更改为：

```
STAssertNotNil(res, @"%@", desc);
STAssertNotEquals(@"", res, @"%@", desc); 
```

格式字符串是一个常见的安全问题。当它们对编译器不可见时，它无法检查它们。在您的情况下，它们已隐藏在`desc`.

# sql - 如何删除 SQL 中的多个值？

> ID：14691483
> 
> 赞同：4
> 
> 时间：2013-02-04T16:55:09.217
> 
> 标签：sql, oracle

我知道如何使用如下语句删除一组行：

```
DELETE FROM my_table WHERE id=23 AND year=2012 AND value=16
DELETE FROM my_table WHERE id=17 AND year=2012 AND value=16
DELETE FROM my_table WHERE id=64 AND year=2012 AND value=16 
```

但我想将上述三个语句组合成一个 DELETE，其中 id 为 23、17 或 64。

在 Oracle SQL 中执行此操作的语法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-04T16:56:31.237

您可以使用 SQL`IN`关键字。例如：

```
DELETE FROM my_table WHERE id IN (23, 17, 64) AND year=2012 AND value=16 
```

*注意：* Oracle 在一个列表中限制为 1,000 个项目。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-04T16:56:22.563

```
DELETE FROM my_table 
WHERE id in (17, 23, 64) AND year=2012 AND value=16 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-04T16:57:13.680

您可以链接`AND/OR`条件以达到相同的效果。在这种情况下，一个简单的`IN`就可以解决您的目的。

```
DELETE FROM my_table WHERE id IN (23, 17, 64) AND year=2012 AND value=16 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-04T16:56:50.273

怎么样：

```
DELETE FROM my_table WHERE (id=23 or id=17 or id=64) AND year=2012 AND value=16 
```

# checkout - 存储借记卡信息以供在线使用

> ID：14691484
> 
> 赞同：1
> 
> 时间：2013-02-04T16:55:10.340
> 
> 标签：checkout, pci-dss, pci-compliance

如果我需要存储借记卡信息，必须存储哪些字段？

例如，对于信用卡，字段是

*   卡号
*   到期月/年
*   持卡人姓名
*   邮编（有时）
*   ~~CCV（有时）~~

借记卡呢？~~我需要存储 PIN 码吗？~~

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T00:37:01.090

如果您要存储 CCV，那么您就违反了 PCI-DSS。切勿存储 CVV，您的客户将因此被罚款。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-06T23:32:19.337

基于 PIN 的借记卡是在线购买的非因素。为什么？因为他们需要*通过加密的 PIN 键盘（或其他加密设备）接受 PIN 码。您不能仅通过购买来做到这一点，而只能通过面对面的购买来做到这一点。

而且，当面购买时，您*无法*存储 PIN 码。

# php - php，确定此值是否在我的数组中的有效方法

> ID：14691492
> 
> 赞同：0
> 
> 时间：2013-02-04T16:55:43.600
> 
> 标签：php, arrays, key-value

> **可能重复：**
> [在多维数组中查找值](https://stackoverflow.com/questions/10811908/find-values-in-multidimensional-arrays)

这是我的数组，它包含一个键值对数组。

```
[
   {
    valueA: 0,
    valueB: 0,
    day: "2010-04-09"
   },
   {
    valueA: 0,
    valueB: 0,
    day: "2010-04-10"
   }
] 
```

我想检查某个值是否在任何索引中的键“day”处（如果是，请修改该节点中的值）

有没有一种有效的方法来做到这一点`in_array`？

否则我想我会用嵌套的for循环来做

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:03:33.320

不使用该`in_array`功能，但您可以使用`array_filter`：

```
// assuming $myarray = Array(......);
if( $found = array_filter($myarray,function($a) {return $a['day'] == '2010-04-10';})) {
    // you can now do something with the $found array
} 
```

编辑：刚刚看到你关于使用 PHP 5.2.2 的评论——这个版本不支持匿名函数，所以你需要这个：

```
if( $found = array_filter($myarray,create_function('$a','return $a["day"] == "2010-04-10";'))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T17:07:18.280

仅循环一次并将日期设置为键

```
$hash = array();
foreach ( $array as $v ) {
    $hash[$v['day']][] = $v;
} 
```

现在您可以使用`isset`which is`O(1)`而不是`O(n)` 一直使用

```
if (isset($hash['2010-04-10'])) {
    echo "Here";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:19:10.930

我会改用 array_map 。这将允许您在键匹配时修改数组。array_filter 只允许填充数组。

如果您创建一个新方法（使用 5.2 和 create_function），您可以在其中指定您的逻辑。然后，将其传递给 array_map 方法以获取新的、已处理的数组。

在下面的示例中，我正在检查变量的“day”是否为“2010-04-10” - 如果是，则将该特定数组的 valueA 更改为 1。

```
$processArrayFunction = create_function('$a',
                                        'if ($a["day"] == "2010-04-10") {
                                            $a["valueA"] = 1;
                                        }
                                        return $a;
                                        ');

$newArray = array_map($processArrayFunction, $sourceArray); 
```

# batch-file - 检查命令是否在批处理文件中成功

> ID：14691494
> 
> 赞同：61
> 
> 时间：2013-02-04T16:55:46.650
> 
> 标签：batch-file, exit-code, errorlevel

如何在批处理文件中检查命令

```
start "" javaw -jar %~p0/example.jar 
```

是成功还是产生了错误？

我想使用 if/else 语句来回显此信息。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2013-02-04T17:33:13.787

这可能不适用于`start`，因为这会打开一个新窗口，但要回答您的问题：

如果命令返回错误级别，您可以检查以下方式

**按特定错误级别**

```
commandhere
if %errorlevel%==131 echo do something 
```

**如果有任何错误**

```
commandhere || echo what to do if error level ISN'T 0 
```

**通过如果没有错误**

```
commandhere && echo what to do if error level IS 0 
```

如果它没有返回错误级别但确实给出了输出，您可以在变量中捕获它并通过输出确定，例如（注意标记和分隔符只是示例，可能会因任何特殊字符而失败）

**通过解析完整输出**

```
for /f "tokens=* delims=" %%a in ('somecommand') do set output=%%a
if %output%==whateveritwouldsayinerror echo error 
```

或者您可以只在输出中查找单个短语，例如单词*Error*

**通过检查字符串**

```
commandhere | find "Error" || echo There was no error!
commandhere | find "Error" && echo There was an error! 
```

你甚至可以混合在一起（只要记住在语句`|`中用`^|`if转义`for`）

希望这可以帮助。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2013-02-04T16:57:15.027

您可以使用

```
if errorlevel 1 echo Unsuccessful 
```

在某些情况下。这取决于最后一个返回正确退出代码的命令。如果您的程序正常返回，即使出现异常情况，您也无法判断有什么问题。

小心使用像 Robocopy 这样的程序，它需要更细致的方法，因为从中返回的错误级别是一个位掩码，其中包含的不仅仅是布尔信息，实际成功代码是 AFAIK，3。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-02-10T18:03:54.443

大多数命令/程序在成功时返回 0 和一些其他值，称为`errorlevel`，表示错误。

您可以在批处理中检查这一点，例如：

```
call <THE_COMMAND_HERE>
if %ERRORLEVEL% == 0 goto :next
echo "Errors encountered during execution.  Exited with status: %errorlevel%"
goto :endofscript

:next
echo "Doing the next thing"

:endofscript
echo "Script complete" 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-08-16T15:20:11.983

天哪，我很难找到答案……这里是：

```
cd thisDoesntExist
if %errorlevel% == 0 (
  echo Oh, I guess it does
  echo Huh.
) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-04T17:01:17.000

我不知道 javaw 是否会写入 %errorlevel% 变量，但它可能会。

`echo %errorlevel%`直接运行之后就可以看到了。

除此之外，您可以将 javaw 的输出通过管道传输到文件中，然后使用它`find`来查看结果。在不知道它的输出的情况下，我真的无法帮助你。

# php - 用 PHP 解压文件

> ID：14691496
> 
> 赞同：1
> 
> 时间：2013-02-04T16:55:52.387
> 
> 标签：php, gzip

我有一个 gzip 文件。在这个文件中，我有许多 csv 文件。我只想读取 gzip 文件夹中包含的这些文件之一。我要读取的 gzip 文件夹的名称是“com.instore”。csv 文件的名称是“秒”。

我使用 gzopen() 来读取 gzip 文件夹。但现在我不知道如何读取里面包含的 csv 文件。

1.  那么，我该怎么做呢？
2.  我必须用 gzclose() 关闭吗？
3.  gzip 位于服务器目录中。我怎样才能达到它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:01:36.447

当您 gzopen 时，您不会解压缩它。您只需创建一个指向它的文件指针。

```
<?php
// get contents of a gz-file into a string
$filename = "/usr/local/something.txt.gz";
$zd = gzopen($filename, "r");
$contents = gzread($zd, 10000);
gzclose($zd);
?> 
```

而 $contents 是您的 csv 文件作为字符串。

更多信息@ [http://www.php.net/manual/en/function.gzread.php](http://www.php.net/manual/en/function.gzread.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:01:52.387

您可以使用以下方法提取 gzip 文件： [如何使用 php 提取或解压缩 gzip 文件？](https://stackoverflow.com/questions/11265914/how-can-i-extract-or-uncompress-gzip-file-using-php) 而不是使用这个： [如何在 PHP 中导入 csv 文件？](https://stackoverflow.com/questions/5813168/how-to-import-csv-file-in-php) 填充数据库。

# php - 将图像上传到 linux 服务器返回 500 错误

> ID：14691497
> 
> 赞同：-1
> 
> 时间：2013-02-04T16:55:53.213
> 
> 标签：php, webserver

我有两个服务器的**服务器 A 和服务器 B** 我有一个注册页面，其中包含**用户名**、**电子邮件**、**密码**和**图像**。

我正在使用一个简单的 php 脚本来上传从**ios 设备发送的图像。**

我能够将新用户注册到**服务器 A**。图片上传在以下情况下效果很好

```
Case 1: Uploading via HTML (Success)
Case 2: Uploading Via app (Success) 
```

但是当尝试将图像上传到**服务器 B（LINUX 服务器）**时，图像上传失败。

```
Case 1: Uploading via HTML (Success)
Case : Uploading via app (FAILED) 
```

我已确保文件权限为**777**。但我仍然无法将图像上传到服务器。它返回 500 内部错误。

**实际上，上传到服务器 B 以前可以正常工作。但是突然之间它停止了工作。**

任何人都可以建议我应该检查哪些条件以确保图像能够上传？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:12:38.503

尝试使用 CURL

```
 $ch = curl_init();
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, array('file' => '@/path/file.txt'));
    curl_setopt($ch, CURLOPT_URL, 'http://server2/upload.php');
    curl_exec($ch);
    curl_close($ch); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T17:19:12.810

单独设置文件的权限并不能解决问题。请确保您已将目录设置为可被任何运行 php 的用户写入`upload_tmp_dir`。`php.ini`检查`sys_get_temp_dir()`它返回的内容，确保返回的路径是可写的。如果你可以`ssh`到你的linux服务器，你可以通过以下命令检查临时目录的权限

```
$ls -ld temp_dir_path_here 
```

当然可能还有其他问题导致失败。您可以通过检查服务器错误日志来获取更多信息，或者通过在脚本顶部复制以下代码段来设置错误

```
error_reporting(E_ALL);
ini_set('display_errors', 'on'); 
```

完成后删除上面的代码段。

# c# - 在代码中绑定到 DependencyProperty（除了更改通知）

> ID：14691502
> 
> 赞同：1
> 
> 时间：2013-02-04T16:56:10.840
> 
> 标签：c#, .net, wpf

有没有办法绑定到 C# 中的依赖属性（就像 XAML 一样）？

**我知道我可以做更改通知**，但我希望有一种方法来进行“双向”绑定。（因此更改我的值会更改依赖项属性。）

例子：

在我的用户控制视图中

```
public static readonly DependencyProperty IsRequiredProperty =
    DependencyProperty.Register("IsRequired", typeof(bool), 
        typeof(MyUserControl), new FrameworkPropertyMetadata(default(bool)));

public bool IsRequired
{
    get { return (bool)GetValue(IsRequiredProperty); }
    set { SetValue(IsRequiredProperty, value); }
} 
```

在我的视图模型中：

```
 // This is the one I want bound to the dependency property.
 bool IsRequired { //INotifyPropertyChanged getter and setter}

 public void SomeCommandExec(Object obj)
 {
     // Update the dependency property by doing this:
     IsEnabled = False;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:02:06.467

您可以在 C# 中执行此操作 - 您必须手动构建[绑定：](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.aspx)

```
// You need these instances
var yourViewModel = GetTheViewModel();
var yourView = GetYourView();

Binding binding = new Binding("IsRequired");
binding.Source = yourViewModel;
binding.Mode = BindingMode.TwoWay;
yourView.SetBinding(YourViewType.IsRequiredProperty, binding); 
```

有关详细信息，请参阅[如何：在代码中创建绑定](http://msdn.microsoft.com/en-us/library/ms742863.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T17:16:23.443

嗨试试这样

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        DataContext = new ViewModel();
        Binding binding = new Binding("IsRequired")
        {
            Source = UserControl1.IsRequiredProperty,
            Mode = BindingMode.TwoWay
        };
    }
}

public class ViewModel : INotifyPropertyChanged
{
    private bool isRequired;
    public bool IsRequired
    {
        get { return isRequired; }
        set { isRequired = value; Notify("IsRequired"); }
    }

    public event PropertyChangedEventHandler PropertyChanged;
    private void Notify(string propName)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propName));
    }

    private CommandHandler mycommand;
    public CommandHandler MyCommand { get { return mycommand ?? (mycommand = new CommandHandler((obj) => OnAction(obj))); } }

    private void OnAction(object obj)
    {
        IsRequired = true;
    }

}

public class CommandHandler : ICommand
{
    public CommandHandler(Action<object> action)
    {
        action1 = action;
    }
    Action<object> action1;
    public bool CanExecute(object parameter)
    {
        return true;
    }

    public event EventHandler CanExecuteChanged;

    public void Execute(object parameter)
    {
        action1(parameter);
    }
}

public partial class UserControl1 : UserControl
{
    public UserControl1()
    {
        InitializeComponent();
    }
    public static readonly DependencyProperty IsRequiredProperty = DependencyProperty.Register("IsRequired", typeof(bool), typeof(UserControl1), new FrameworkPropertyMetadata(default(bool)));

    public bool IsRequired
    {
        get { return (bool)GetValue(IsRequiredProperty); }
        set { SetValue(IsRequiredProperty, value); }
    }
}

<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="*"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>
    <local:UserControl1></local:UserControl1>
    <Button Command="{Binding MyCommand}" Grid.Row="1" Content="Action"/>
</Grid> 
```

我希望这将有所帮助。

# visual-studio-2010 - 首次启动时的 Visual Studio 2010 条件引用

> ID：14691503
> 
> 赞同：1
> 
> 时间：2013-02-04T16:56:14.550
> 
> 标签：visual-studio-2010, visual-studio, visual-c++

我很乐意评论这个问题的答案，[visual studio 2010 条件引用](https://stackoverflow.com/questions/6523008/visual-studio-2010-conditional-references)，但由于某种原因，我找不到这个功能，因此是一个新问题。

我的问题是条件引用只能从第二次启动开始正常工作。在解决方案的第一次启动时，或者如果我删除 *.suo 文件，则不会处理条件引用并且解决方案无法构建。我的情况是这样的：

```
<Choose>
<When Condition=" '$(Configuration)'=='DebugUsingDLL' or '$(Configuration)'=='ReleaseUsingDLL' ">
  <ItemGroup>
  <ProjectReference>...</ProjectReference>
  </ItemGroup>
</When>
</Choose> 
```

我了解所选配置存储在 *.suo 文件中，这就是为什么只要磁盘上存在 *.suo 就可以正常工作的原因。

但是，因为我们使用解决方案来自动化我们的构建，所以我们总是在新文件夹中签出源代码，但不能签入 *.suo 文件，因为它取决于用户。

为了更好地理解，我们使用了四种配置“Debug”“Release”“DebugUsingDLL”和“ReleaseUsingDLL”，并且我们有不同的 DLL 和静态库项目：因此引用必须基于此更改。
我试图在解决方案中只包含 DebugUsingDLL 和 ReleaseUsingDLL，这意味着测试应该始终为该解决方案产生 true，但引用也没有正确处理。

你能确认这看起来像 IDE 中的错误吗？你能建议一个替代方案吗？

# vb.net - 连接到 vb.net 中的本地 sql 服务器 - 连接错误以及本地和商业之间的区别？

> ID：14691505
> 
> 赞同：0
> 
> 时间：2013-02-04T16:56:14.530
> 
> 标签：vb.net, visual-studio-2010, sql-server-2008

我是一名使用 Visual Studio 2010 在 VB.Net 中构建网站的开发人员。当用户根据他们在前一个屏幕上的决定访问网站时，我试图填充一些字段。

我的连接信息如下：

```
Dim myDataReader As SqlDataReader
Dim myConnection As SqlConnection
Dim myCommand As SqlCommand
Dim strSQL As String

myConnection = New SqlConnection("Data Source=localhost\sqlexpress; Database=PREP; Integrated Security=SSPI;")
Try
    myConnection.Open()
Catch ex As Exception
    MsgBox(ex.Message)
End Try

strSQL = "SELECT * FROM Charts where ID=1"

myCommand = New SqlCommand(strSQL, myConnection)

myDataReader = myCommand.ExecuteReader()

If myDataReader.Read() Then
    TextBox1.Text = myDataReader.Item("Priority1")
Else
    MsgBox("Didn't work...")
End If 
```

我继续得到的错误是：

> 无法通过登录打开数据库“PREP”。登录失败。用户“OR-AA-Me\Me”登录失败

我假设因为它是一个本地数据库，所以我不需要用户名和密码。我错了吗？

此外，当我将其传输到商业环境时，上述代码中是否有明显的做法是不明智的？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:02:52.500

解决了：

连接字符串只需要额外的文件路径信息。

成功连接信息为：

> myConnection = New SqlConnection("Data Source=.\SQLEXPRESS; AttachDbFilename=|DataDirectory|\PREP.mdf; Integrated Security=True; User Instance=True")

不需要用户名，因为集成安全设置为 True 假定计算机将在他正在使用的实际计算机上使用用户的登录信息。

* * *

# ios - 无法在 iOS 上获取位置 - 不调用委托方法

> ID：14691508
> 
> 赞同：0
> 
> 时间：2013-02-04T16:56:20.260
> 
> 标签：ios, delegates, location, locationmanager

我在 iOS 6 下的 locationManager 有问题。

```
-(void) getLocationTest {
// Create a location manager instance to determine if location services are enabled. This manager instance will be
// immediately released afterwards.

manager = [[CLLocationManager alloc] init];
if (![manager locationServicesEnabled]) {
    UIAlertView *servicesDisabledAlert = [[UIAlertView alloc] initWithTitle:@"Location Services Disabled" message:@"You currently have all location services for this device disabled. If you proceed, you will be asked to confirm whether location services should be reenabled." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
    [servicesDisabledAlert show];
    //[servicesDisabledAlert release];
}
manager.delegate = self;
manager.desiredAccuracy = kCLLocationAccuracyKilometer;
// Set a movement threshold for new events.
manager.distanceFilter = 500;
[manager startUpdatingLocation];

//[manager release];
}

-(void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation {
double testDe = 2.434;
testDe = testDe * 2;
}

-(void)locationManager:(CLLocationManager *)manager
 didUpdateLocations:(NSArray *)locations {
CLLocation *location = [locations objectAtIndex:0];
double locDouble = location.coordinate.latitude;
NSString* locName = [[NSString alloc] initWithFormat:@"Hello, %f!", locDouble];
//[locations lastObject];
//NSLog(@"lat%f - lon%f", location.coordinate.latitude, location.coordinate.longitude);
}

-(void)locationManager:(CLLocationManager *)manager didFailWithError:(NSError *)error {
double testD = 2.434;
testD = testD * 2;
} 
```

我在所有委托方法中都有断点，但没有一个被调用。有人知道我在做什么错吗？或者我怎么能找出错误在哪里？

我将不胜感激每一个答案！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:38:03.887

您是在设备上还是在模拟器中进行测试？在模拟器中，您必须从模拟器应用程序菜单中手动设置一些位置。它在调试/位置/。

# python - 基于 x,y,r 作为 python 中的向量绘制许多圆圈

> ID：14691510
> 
> 赞同：0
> 
> 时间：2013-02-04T16:56:23.897
> 
> 标签：python, matplotlib, geometry

x,y 是圆的位置，r 是半径 - 所有向量。我想一次绘制它们。就像是：

```
import matplotlib.pyplot as plt
from matplotlib.patches Circle

#define x,y,r vectors

fig = plt.figure()
ax1 = fig.add_subplot(1,1,1)
plt.Circle((x,y),r,color='r')
plt.show() 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:24:48.947

[plt.scatter](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.scatter)允许您定义绘制点的半径。

从文档

```
matplotlib.pyplot.scatter(x, y, s=20, c='b', marker='o')
[...]

s:
    size in points^2\. It is a scalar or an array of the same length as x and y. 
```

玩，`facecolor`你`edgecolor`应该能够得到你想要的

您可以在[如何为 matplot 散点图中的每个气泡设置_gid() 中找到一个示例？](https://stackoverflow.com/questions/14687089/how-to-set-gid-for-each-bubble-in-matplot-scatter-chart)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T21:12:00.450

我不了解 Circles 补丁，但您可以使用标准绘图命令执行此操作：

```
import numpy as np
import matplotlib.pyplot as plt

x = np.array([0.2,0.4])
y = np.array([0.2,1.2])
r = np.array([0.5,0.3])

phi = np.linspace(0.0,2*np.pi,100)

na=np.newaxis

# the first axis of these arrays varies the angle, 
# the second varies the circles
x_line = x[na,:]+r[na,:]*np.sin(phi[:,na])
y_line = y[na,:]+r[na,:]*np.cos(phi[:,na])

plt.plot(x_line,y_line,'-')
plt.show() 
```

基本思想是给`plt.plot(...)`命令两个二维数组。在这种情况下，它们被解释为一个地块列表。特别是对于许多情节（=许多圆圈），这比逐圈绘制要快得多。

# android - 使用 Spannable 的 TextView - ellipsize 不起作用

> ID：14691511
> 
> 赞同：28
> 
> 时间：2013-02-04T16:56:24.077
> 
> 标签：android

我要解决的问题如下：我有 a`TextView`并且我正在使用 a`Spannable`将一些字符设置为粗体。文本需要有 2 行`android:maxLines="2"`的最大值（

这是简单的代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:orientation="vertical"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent">

    <TextView android:id="@+id/name"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:gravity="center"
              android:maxLines="2"
              android:ellipsize="end"
              android:bufferType="spannable"
              android:text="@string/app_name"
              android:textSize="15dp"/>

</LinearLayout> 
```

和活动：

```
public class MyActivity extends Activity {

    private TextView name;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        name= (TextView) findViewById(R.id.name);

        name.setText("Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy ");
        Spannable spannable = (Spannable)name.getText();
        StyleSpan boldSpan = new StyleSpan( Typeface.BOLD );
        spannable.setSpan( boldSpan, 10, 15, Spannable.SPAN_INCLUSIVE_INCLUSIVE );

    }
} 
```

文本被截断，不显示“...”。 ![在此处输入图像描述](../Images/c2b8af6c2b53dc11b9b7bfe1810a537b.png)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2015-05-25T22:28:30.390

我意识到这是一个非常古老的帖子，但是看到它仍然没有答案，我今天也遇到了这个问题，我想我会发布一个解决方案。希望它可以帮助将来的人。

```
ViewTreeObserver viewTreeObserver = textView.getViewTreeObserver();
viewTreeObserver.addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener()
{
    @Override
    public void onGlobalLayout()
    {
        ViewTreeObserver viewTreeObserver = textView.getViewTreeObserver();
        viewTreeObserver.removeOnGlobalLayoutListener(this);

        if (textView.getLineCount() > 5)
        {
            int endOfLastLine = textView.getLayout().getLineEnd(4);
            String newVal = textView.getText().subSequence(0, endOfLastLine - 3) + "...";
            textView.setText(newVal);
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-02-08T23:14:46.347

有同样的问题，似乎以下对我有用：

```
Spannable wordtoSpan = new SpannableString(lorem); 
wordtoSpan.setSpan(new ForegroundColorSpan(0xffff0000), 0, 10, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
wordtoSpan.setSpan(new ForegroundColorSpan(0xff00ffff), 20, 35, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
textView.setText(wordtoSpan); 
```

在 xml 中，textView 已`android:multiLine`设置，和`android:ellipsize="end"`，和`android:singleLine="false`；

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-07T16:12:14.873

您在那个椭圆中是对的，在 xml 或代码中声明的将不适用于可跨文本。

但是，通过一些调查，您实际上可以自己进行椭圆化：

```
private TextView name;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    name= (TextView) findViewById(R.id.name);
    String lorem = "Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy "
    name.setText(lorem);

    Spannable spannable = (Spannable)name.getText();
    StyleSpan boldSpan = new StyleSpan(Typeface.BOLD);
    spannable.setSpan( boldSpan, 10, 15, Spannable.SPAN_INCLUSIVE_INCLUSIVE);
    int maxLines = 2;
    // in my experience, this needs to be called in code, your mileage may vary.
    name.setMaxLines(maxLines);

    // check line count.. this will actually be > than the # of visible lines
    // if it is long enough to be truncated
    if (name.getLineCount() > maxLines){
        // this returns _1 past_ the index of the last character shown 
        // on the indicated line. the lines are zero indexed, so the last 
        // valid line is maxLines -1; 
        int lastCharShown = name.getLayout().getLineVisibleEnd(maxLines - 1); 
        // chop off some characters. this value is arbitrary, i chose 3 just 
        // to be conservative.
        int numCharsToChop = 3;
        String truncatedText = lorem.substring(0, lastCharShown - numCharsToChop);
        // ellipsize! note ellipsis character.
        name.setText(truncatedText+"…");
        // reapply the span, since the text has been changed.
        spannable.setSpan(boldSpan, 10, 15, Spannable.SPAN_INCLUSIVE_INCLUSIVE);
    }

} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-11-09T11:02:04.643

通过使用反射来解决这个问题，这可能是一个小技巧。看了AOSP的源码，TextView.java中DynamicLayout只包含一个名为sStaticLayout的静态字段成员，它是由new StaticLayout(null)构造的，没有包括maxLines在内的任何参数。

因此，doEllipsis 将始终为 false，因为 mMaximumVisibleLineCount 默认设置为 Integer.MAX_VALUE。

```
boolean firstLine = (j == 0);
boolean currentLineIsTheLastVisibleOne = (j + 1 == mMaximumVisibleLineCount);
boolean lastLine = currentLineIsTheLastVisibleOne || (end == bufEnd);

    ......

if (ellipsize != null) {
    // If there is only one line, then do any type of ellipsis except when it is MARQUEE
    // if there are multiple lines, just allow END ellipsis on the last line
    boolean forceEllipsis = moreChars && (mLineCount + 1 == mMaximumVisibleLineCount);

    boolean doEllipsis =
                (((mMaximumVisibleLineCount == 1 && moreChars) || (firstLine && !moreChars)) &&
                        ellipsize != TextUtils.TruncateAt.MARQUEE) ||
                (!firstLine && (currentLineIsTheLastVisibleOne || !moreChars) &&
                        ellipsize == TextUtils.TruncateAt.END);
    if (doEllipsis) {
        calculateEllipsis(start, end, widths, widthStart,
                ellipsisWidth, ellipsize, j,
                textWidth, paint, forceEllipsis);
    }
} 
```

所以我扩展了 TextView 并创建了一个名为 EllipsizeTextView 的视图

```
public class EllipsizeTextView extends TextView {
public EllipsizeTextView(Context context) {
    super(context);
}

public EllipsizeTextView(Context context, AttributeSet attrs) {
    super(context, attrs);
}

public EllipsizeTextView(Context context, AttributeSet attrs, int defStyleAttr) {
    super(context, attrs, defStyleAttr);
}

@Override
protected void onDetachedFromWindow() {
    super.onDetachedFromWindow();
}

public EllipsizeTextView(Context context, AttributeSet attrs, int defStyleAttr, int defStyleRes) {
    super(context, attrs, defStyleAttr, defStyleRes);
}

@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    StaticLayout layout = null;
    Field field = null;
    try {
        Field staticField = DynamicLayout.class.getDeclaredField("sStaticLayout");
        staticField.setAccessible(true);
        layout = (StaticLayout) staticField.get(DynamicLayout.class);
    } catch (NoSuchFieldException e) {
        e.printStackTrace();
    } catch (IllegalAccessException e) {
        e.printStackTrace();
    }

    if (layout != null) {
        try {
            field = StaticLayout.class.getDeclaredField("mMaximumVisibleLineCount");
            field.setAccessible(true);
            field.setInt(layout, getMaxLines());
        } catch (NoSuchFieldException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        }
    }
    super.onMeasure(widthMeasureSpec, heightMeasureSpec);
    if (layout != null && field != null) {
        try {
            field.setInt(layout, Integer.MAX_VALUE);
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        }
    }
} 
```

}

问题解决了！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-03-22T18:23:25.770

另一种解决方案是覆盖`onDraw`. `TextView`以下建议的解决方案不使用任何反射技术。因此，将来不应中断，以防任何成员变量命名发生更改。

```
import android.annotation.TargetApi;
import android.content.Context;
import android.graphics.Canvas;
import android.os.Build;
import android.text.Layout;
import android.text.SpannableStringBuilder;
import android.util.AttributeSet;
import android.widget.TextView;

import androidx.annotation.Nullable;
import androidx.annotation.RequiresApi;

public class EllipsizeTextView extends TextView {
    private static final String THREE_DOTS = "...";
    private static final int THREE_DOTS_LENGTH = THREE_DOTS.length();

    private volatile boolean enableEllipsizeWorkaround = false;
    private SpannableStringBuilder spannableStringBuilder;

    public EllipsizeTextView(Context context) {
        super(context);
    }

    public EllipsizeTextView(Context context, @Nullable AttributeSet attrs) {
        super(context, attrs);
    }

    public EllipsizeTextView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

    @RequiresApi(api = Build.VERSION_CODES.LOLLIPOP)
    @TargetApi(Build.VERSION_CODES.LOLLIPOP)
    public EllipsizeTextView(Context context, @Nullable AttributeSet attrs, int defStyleAttr, int defStyleRes) {
        super(context, attrs, defStyleAttr, defStyleRes);
    }

    public void setEnableEllipsizeWorkaround(boolean enableEllipsizeWorkaround) {
        this.enableEllipsizeWorkaround = enableEllipsizeWorkaround;
    }

    // https://stackoverflow.com/questions/14691511/textview-using-spannable-ellipsize-doesnt-work
    // https://blog.csdn.net/htyxz8802/article/details/50387950
    @Override
    protected void onDraw(Canvas canvas) {
        if (enableEllipsizeWorkaround && Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {
            final Layout layout = getLayout();

            if (layout.getLineCount() >= getMaxLines()) {
                CharSequence charSequence = getText();
                int lastCharDown = layout.getLineVisibleEnd(getMaxLines()-1);

                if (lastCharDown >= THREE_DOTS_LENGTH && charSequence.length() > lastCharDown) {
                    if (spannableStringBuilder == null) {
                        spannableStringBuilder = new SpannableStringBuilder();
                    } else {
                        spannableStringBuilder.clear();
                    }

                    spannableStringBuilder.append(charSequence.subSequence(0, lastCharDown - THREE_DOTS_LENGTH)).append(THREE_DOTS);
                    setText(spannableStringBuilder);
                }
            }
        }

        super.onDraw(canvas);
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-06-04T03:11:04.240

至于单行情况，*android:maxLines*不工作，但*android:singleLine 没问题*。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-07-08T11:11:37.453

这是 Android 框架中的一个已知问题：[https ://code.google.com/p/android/issues/detail?id=67186](https://code.google.com/p/android/issues/detail?id=67186)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-01-26T11:52:25.083

**一个简单而有效的解决方案**

这是我的代码->

```
<TextView
        android:id="@+id/textViewProfileContent"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:singleLine="false"
        android:ellipsize="end"
        android:maxLines="3"
        android:textSize="14sp"
        android:textColor="#000000" />

 SpannableStringBuilder sb = new SpannableStringBuilder();
 SpannableString attrAdditional = new SpannableString(additionalText);
                 attrAdditional.SetSpan(new StyleSpan(TypefaceStyle.Bold), 0, additionalText.Length, 0);...

 sb.Append(attrAdditional);...

 ProfileContent.SetText(sb, **TextView.BufferType.Normal**); 
```

[结果](https://i.stack.imgur.com/8z2Ii.jpg)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-10-31T14:31:54.640

[![在此处输入图像描述](../Images/138db38cf8ecb0c9e1c6e469c3f4afd9.png)](https://i.stack.imgur.com/VvARg.png)

[https://github.com/lsjwzh/FastTextView](https://github.com/lsjwzh/FastTextView) 对此有一个清晰的解决方案。您应该首先包装您的跨区字符串，然后覆盖 getSpans、getSpanStart、getSpanEnd... [https://github.com/lsjwzh/FastTextView/blob/master/widget.FastTextView/src/main/java/android/text/EllipsisSpannedContainer。爪哇](https://github.com/lsjwzh/FastTextView/blob/master/widget.FastTextView/src/main/java/android/text/EllipsisSpannedContainer.java)

第 207 行向您展示了如何使用。[https://github.com/lsjwzh/FastTextView/blob/master/widget.FastTextView/src/main/java/com/lsjwzh/widget/text/FastTextView.java](https://github.com/lsjwzh/FastTextView/blob/master/widget.FastTextView/src/main/java/com/lsjwzh/widget/text/FastTextView.java)

您也可以使用 FastTextView 代替 Android TextView

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-06-03T07:41:39.997

```
@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    super.onMeasure(widthMeasureSpec, heightMeasureSpec);
    if (maxLength < 0) {
        Layout layout = getLayout();
        if (layout.getLineCount() > getMaxLines()) {
            maxLength = layout.getLineVisibleEnd(getMaxLines() - 1) - 1;
            setSpannableString();
        }
    }
} 
```

“setSpannableString()”如下所示：

```
private void setSpannableString() {
    // ShowString is real visible string. FullString is original string which
    // is useful when caching and calculating.
    String showString = fullString;
    if (maxLength > 0) {
        showString = fullString.substring(0, maxLength) + THREE_DOTS;
    }
    SpannableStringBuilder builder = new SpannableStringBuilder(showString);
    for (int i = 0; i < mHighLightColor.size(); i++) {
        String highLightString = mHighLightString.get(i);
        int color = mHighLightColor.get(i);
        int start = fullString.indexOf(highLightString);
        int end = Math.min(start + highLightString.length(), showString.length());
        if (mClickableSpanList.get(i) != null) {
            builder.setSpan(mClickableSpanList.get(i), start, end, Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
            setMovementMethod(LinkMovementMethod.getInstance());
        }
        builder.setSpan(new ColorBoldSpan(color), start, end, Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
    setText(builder, BufferType.SPANNABLE);
} 
```

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2018-04-12T13:45:33.820

试试这对我有用。

> 这是我的文本视图

```
 <TextView
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
         android:maxLines="2"
         android:ellipsize="end"
         android:text="Type here maximum characters."
         android:textSize="16sp" /> 
```

[![在此处输入图像描述](../Images/095aabae0117847a24e7b0cf434291cb.png)](https://i.stack.imgur.com/NRgaL.png)

# javascript - Socialite.js 回调或加载事件

> ID：14691514
> 
> 赞同：0
> 
> 时间：2013-02-04T16:56:27.963
> 
> 标签：javascript, jquery

我第一次使用[Socialite.js](https://github.com/dbushell/Socialite)。[这是一个 js 插件，用于在页面加载后或任何时候加载社交媒体插件] 看起来真的很棒，但我想隐藏加载插件并在社交名流完成它的魔力后显示它们。[opacity 0>1 with css transitions] 文档没有说明回调，我在谷歌上找不到任何东西。

我想知道：

*   如果社交名流有回调？
*   或者如果它给出了一个我可以听的完成事件？
*   或另一种方法来检测我的社交插件 [fb 和 twitter] 是否已加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:36:52.210

它没有记录，但可以通过阅读源代码找到。在加载每个单独的小部件后调用回调。如果你使用的是 jQuery，你可以使用类似的东西：

```
Socialite.load(null, null, null, function(target) {
    $(target).hide().fadeIn("slow");
}); 
```

更好的方法是最初通过 css 隐藏小部件并仅调用：

```
Socialite.load(null, null, null, function(target) {
    $(target).fadeIn("slow");
}); 
```

# php - 缩小 HTML 输出，但保留某些标签

> ID：14691519
> 
> 赞同：2
> 
> 时间：2013-02-04T16:56:40.850
> 
> 标签：php, string, escaping

我正在开发一个功能，通过去除不必要的空格、换行符和制表符以及其中的注释来缩小我的页面的 HTML 代码。但是，我想保留以

```
 "<!-- google_ad_section... -->" 
```

因为他们告诉谷歌我页面的哪些部分要强调。

我当前修剪代码的代码片段是这个，在这个伟大网站的另一个地方找到。我对参数编码的理解与第二个参数的第一部分清除了所有注释一样多。但是如何保留所有包含“google_ad_section”字符串的标签？

```
function sanitize_output2($buffer){
return preg_replace(
array(
    '/ {2,}/',
    '/<!--.*?-->|\t|(?:\r?\n[ \t]*)+/s'
),
array(
    ' ',
    ''
),
$buffer
);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:17:58.763

这个解决方案怎么样：

*   [通过DOMDocument](http://www.php.net/manual/de/class.domdocument.php)运行您的 HTML
*   使用选项[preserveWhiteSpace](http://www.php.net/manual/de/class.domdocument.php#domdocument.props.preservewhitespace) with`false`删除所有多余的空格
*   过滤所有与您需要的评论不同的评论

也许它看起来像这样：

```
$html = '<html>[…]</html>';

$doc = new DOMDocument;
$doc->preserveWhiteSpace = false; 
$doc->loadHtml($html);

$xpath = new DOMXPath($doc);
$comments = $xpath->query('//comment()');
foreach ($comments as $comment) {
    if (!preg_match('/^google_ad_section /', $comment->nodeValue)) {
        $comment->parentNode->removeChild($comment);
    }
}

$html = $doc->saveHTML(); 
```

我是用心写的，没有测试。所以也许它不是 100% 准确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T17:25:53.883

请务必查看 strip_tags() 函数；尤其是第二个参数。

```
strip_tags($html_string,$allowable_tags); 
```

[http://php.net/manual/en/function.strip-tags.php](http://php.net/manual/en/function.strip-tags.php)

还有 trim() 函数；再次检查第二个参数。

```
 trim($html_string,$charlist) 
```

[http://www.php.net/manual/en/function.trim.php](http://www.php.net/manual/en/function.trim.php)

您可能还想查看 Apache 的 mod_deflate，它将压缩输出。

[http://httpd.apache.org/docs/2.2/mod/mod_deflate.html](http://httpd.apache.org/docs/2.2/mod/mod_deflate.html)

但这仅适用于 HTML 文件。要压缩 PHP 输出，您需要在站点范围内的 php.ini 文件中或在运行时使用 zlib.output_compression = On

```
ini_set("zlib.output_compression", "On"); 
```

[http://php.net/manual/en/zlib.configuration.php](http://php.net/manual/en/zlib.configuration.php)

# c# - winform中列表的空值异常

> ID：14691522
> 
> 赞同：0
> 
> 时间：2013-02-04T16:56:51.093
> 
> 标签：c#, winforms, arraylist, html-agility-pack

我有 2 个列表：

```
public List<string> my_link = new List<string>();
public List<string> english_word = new List<string>(); 
```

我正在从页面中抓取一些链接并将它们保存到“my_link”中；为此，我正在使用以下代码：

```
HtmlWeb web = new HtmlWeb();
HtmlAgilityPack.HtmlDocument doc = web.Load("http://search.freefind.com/find.html?id=59478474&pid=r&ics=1&query=" + x);
HtmlNodeCollection nodes=doc.DocumentNode.SelectNodes("//font[@class='search-results']//a");

try
{
    foreach (HtmlNode n in nodes)
    {
        link = n.InnerHtml;
        link = link.Trim();
        my_link.Add(link);
    }
}
catch (NullReferenceException )
{
    MessageBox.Show("NO link found ");            
} 
```

然后我正在抓取我抓取的链接上的一些内容，并将每个链接的内容存储在一个`english_word.Add(q);`它可以从除最后一个链接之外的所有链接中抓取内容。我的代码就是这样

```
foreach (string ss in my_link)
{
    HtmlWeb web2 = new HtmlWeb();
    HtmlAgilityPack.HtmlDocument doc2 = web2.Load(ss);
    HtmlNodeCollection nodes2 = doc2.DocumentNode.SelectNodes("//table[@id='table1']//tr[position()>1]//td[position()=2]");
    try
    {
        foreach (HtmlNode nn in nodes2)
        {
            q = nn.InnerText;
            q = System.Net.WebUtility.HtmlDecode(q);
            q = q.Trim();
            english_word.Add(q);
        }
    }
    catch (NullReferenceException ex)
    {
        MessageBox.Show("No english word is found ");
    }
} 
```

仅对于最后一个链接，它显示“未找到英文单词”

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:09:10.437

1.  更改您的 catch 语句以捕获所有异常，而不仅仅是 NullReferenceException。
2.  调试器是你的朋友，使用它。我猜你在向列表中添加新单词之前会在某个地方遇到异常。在 foreach 循环中设置断点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T07:37:25.413

首先，在这里捕捉`NullReferenceException`不是一个好主意。最好检查`null`您期望空值的位置。

其次，如果没有找到节点，您很可能会因为`HtmlNode.SelectNodes`方法返回`null`（不是一个空的节点集合，正如您所期望的那样）而得到此异常。请参阅 HTML [Agility Pack Null 参考](https://stackoverflow.com/a/5802547/102112)、[C#/ Html Agility Pack 错误“值不能为空。](https://stackoverflow.com/a/10000565/102112)[参数名称：Source。”</a>，以及CodePlex](http://htmlagilitypack.codeplex.com/workitem/29175)[上的讨论](https://stackoverflow.com/a/10000565/102112)。

`try .. catch`因此，您可以使用以下内容而不是块：

```
if (nodes2 != null)
{
    foreach (HtmlNode nn in nodes2)
    {
        q = nn.InnerText;
        q = System.Net.WebUtility.HtmlDecode(q);
        q = q.Trim();
        english_word.Add(q);
    }
}
else
{
    MessageBox.Show("No english word is found ");
} 
```

# qt - 为 QTreeWidget 设置列宽

> ID：14691525
> 
> 赞同：7
> 
> 时间：2013-02-04T16:56:52.720
> 
> 标签：qt, pyqt, pyside, qtreewidget

有没有办法从代码中为 QTreeWidget 设置列宽？我想改变第一列的默认宽度。我正在使用 PySide。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-04T17:59:56.843

[QHeaderView::resizeSection()](http://qt-project.org/doc/qt-4.8/qheaderview.html#resizeSection)应该可以解决问题，在 C++ 中它看起来像这样：

```
myTreeWidget->headerView()->resizeSection(0 /*column index*/, 100 /*width*/); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-03-26T10:36:00.617

对于寻找 C++ Qt 解决方案（使用 5.12 测试）的人：

```
// Important to call setMinimumSectionSize because resizeSection wont work if your width is less than the minimum
treeWidget->header()->setMinimumSectionSize(25);
treeWidget->header()->resizeSection(1 /*column index*/, 25 /*width*/);

// You might also need to use this if you want to limit the size of your last column:
treeWidget->header()->setStretchLastSection(false); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-12-25T08:02:24.020

在 Pyside2 中没有`resizeSection`

你可以在 PySide2 中使用它：

```
header = self.treeWidget.header()
header.setSectionResizeMode(QtWidgets.QHeaderView.ResizeToContents)
header.setStretchLastSection(False)
header.setSectionResizeMode(5, QtWidgets.QHeaderView.Stretch) 
```

# ios - 有关旋转和自定义视图对象的详细信息

> ID：14691529
> 
> 赞同：0
> 
> 时间：2013-02-04T16:57:04.070
> 
> 标签：ios, uiview, uiviewcontroller, subview, screen-rotation

我已经设置了一个带有两个子视图和一个按钮的自定义视图。我试图更好地理解 CGRect 并找出应该用于高度/宽度的内容以及如何正确居中项目。我想使用这样的确切数字：

```
UIButton *facebookLoginButton = [[UIButton alloc] initWithFrame:CGRectMake(0, 0, 300,75)]; 
```

...不是完成此操作的正确方法。当设备旋转时，没有什么适合屏幕了。

我还想知道如何不允许在一个视图控制器上旋转。例如，我可以停止旋转对视图进行任何操作的设置，然后稍后在应用程序旋转中将再次使用。

我浏览了设计苹果文档，但不确定我在寻找什么。我正在寻找设置边界/中心项目/大小（宽度/高度）/使用多个子视图以及它们在以编程方式创建视图时如何布局的最佳实践。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:36:11.083

您可以检查设备方向，然后调整相关尺寸。

```
[UIDevice currentDevice].orientation 
```

如果您使用的是 iOS6，您可以查看约束。或者只是使用界面构建器，在那里管理这些东西非常简单（如果您不需要以编程方式进行）。

对于纵向/横向，请查看： [在不需要的视图中触发的备用横向](https://stackoverflow.com/questions/14650127/alternate-landscape-triggered-at-unwanted-view/14651219#14651219)

有了这个，我设法只在一个视图控制器上执行横向旋转，而应用程序的所有其余部分都保持纵向（但您当然可以根据您的需要采用）。

# c - SDL_Mixer 设置声音位置

> ID：14691530
> 
> 赞同：2
> 
> 时间：2013-02-04T16:57:04.967
> 
> 标签：c, audio, skip, sdl-mixer

我想知道 lib 中是否有一个功能`SDL_Mixer`可以跳到 wav 文件中的某个位置。我发现有一个函数被调用`Mix_SetMusicPosition`，但它不适用于`.wav`文件，它不会让你选择一个频道。任何建议将不胜感激。

编辑：我想出了怎么做。我没有调用其他函数，而是更改了结构中`abuf`变量的起始指针`Mix_Chunk`。`.wav`我计算了以 44khz 播放的 16 位文件中每秒有多少字节，并将`abuf`该数字的起始指针更改为我想跳过的秒数。然后改变 的长度`alen`，也是一个位于`Mix_Chunk`结构中的变量，具有相同的字节数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:51:28.090

我刚刚阅读了 SDL Music 的文档，显然 Mix_SetMusicPosition 只支持 OGG、MP3 和 MOD 文件。

链接： http://jcatki.no-ip.org:8080/SDL_mixer/ [SDL_mixer_65.html#SEC65](http://jcatki.no-ip.org:8080/SDL_mixer/SDL_mixer_65.html#SEC65)

明显的解决方案；转换你的 wav。文件到您最喜欢的前面提到的文件格式。

# sed - sed 分隔符选项

> ID：14691536
> 
> 赞同：0
> 
> 时间：2013-02-04T16:57:21.547
> 
> 标签：sed, delimiter

在我的代码中，我需要用地址替换变量赋值：

```
sed -i "s/^variable = .*$/variable = http://myaddress/" 
```

显然，这不起作用，因为地址中的正斜杠在 sed 命令中被识别。

我想保留`$`第一个表达式的末尾，以便将任何内容替换到行尾。我也不想这样逃避美元符号，`\$`因为它会搜索美元符号。

另外，我不想只是转义地址中的正斜杠，因为地址的某些地方也有变量。

我尝试使用`#`而不是，`/`但必须包含我不想包含的内容 - `\$`.

是否有适合我情况的替代分隔符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:01:32.370

`$`由您的外壳解释。将整个参数包装到 sed`'`以防止这种情况发生。

```
sed -i 's#^variable = .*$#variable = http://myaddress#' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:03:04.933

```
sed -i "s@^variable = .*$@variable = http://myaddress@" file 
```

应该为你工作。

请注意，`$`第一个表达式中的不是文学“美元”，而是一个正则表达式，表示行尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T19:47:21.410

```
sed -i 's#^variable = .*#variable = http://myaddress#' 
```

# php - 如何在编辑表单中自动选择值？

> ID：14691537
> 
> 赞同：0
> 
> 时间：2013-02-04T16:57:25.877
> 
> 标签：php, html, mysql

你能帮我更正这段代码吗

```
<select name="ClassHall">
    <?php
    while ($Hall = mysql_fetch_array($resultHall, MYSQL_ASSOC)) {
    ?>
    <option value="<?php echo $Hall['HallName'];?>"

    <?php if($ClassHall == '$Hall['HallName']'){ echo(' selected '); } ?>

     > <?php echo $Hall['HallName'];?> </option>

    <?php
    }
    ?>
</select> 
```

我想在编辑表单中自动选择值。它在 '$Hall['HallName']' 部分有语法错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T16:59:10.777

您在这一行的单引号中有变量：

```
 <?php if($ClassHall == '$Hall['HallName']'){ echo(' selected '); } ?> 
```

尝试将其更改为：

```
 <?php if($ClassHall == $Hall['HallName']){ echo(' selected '); } ?> 
```

# java - 玩！输入字段需要 Flash

> ID：14691539
> 
> 赞同：0
> 
> 时间：2013-02-04T16:57:26.847
> 
> 标签：java, playframework, playframework-1.x

我正在使用 Play 1.2.5。在下面的语句中（在 Docs 中得到它）：

```
Name: <input type="text" name="name" value="${flash.name}" /> 
```

输入文本参数的用途/需要是`value`什么`${flash.name}`，值字段的含义是什么？

请让我知道这件事。

问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:06:02.187

value 将是“默认”值或页面加载时要填充的值（例如，当用户输入无效数据并且您想要显示或离开他已经放置在该字段中的内容，或拥有文本字段时）已为用户填写）。更多信息在这里：[网站](http://www.w3schools.com/tags/att_input_value.asp)

flash 是键\值对的`flash.name`“容器”，由 cookie 在请求中接收并由您之前设置，它像会话一样工作，但只持续一个请求。您可以在此处找到更多信息：[网站](http://www.playframework.org/documentation/1.2.5/controllers#session)

# windows-ce - 如何在 ARM - Windows CE 6.0 上使用 USB GPRS 调制解调器？

> ID：14691543
> 
> 赞同：2
> 
> 时间：2013-02-04T16:57:39.883
> 
> 标签：windows-ce, device-driver, modem, gprs, arm9

我参与了一个项目，我必须在安装了 Windows CE 6.0 的 ARM 板 (RSC-W910) 上安装和使用 USB GPRS 调制解调器。调制解调器是 Sierra Wireless 产品 GL6110 ( [GL61x0](http://www.sierrawireless.com/productsandservices/AirLink/Programmable_Modems/GL6100_GL6110.aspx) )，我只需要将它用于数据，使 HttpWebRequests (TCP) 发送/接收 XML 数据。首选的开发工具是 C# 和 .Net Framework 3.5。

当调制解调器通过 USB 连接到板时，出现的错误消息是“未识别的 USB 设备”，我认为这是正常的。

Siera Wireless(SW) 为 ARM920 提供驱动程序，但使用“wceload.exe”安装失败。错误是“设置失败”，我可以在连接到板上的小 LCD 屏幕上看到。要安装驱动程序，我通过 Telenet 连接到开发板，CAB 文件存储在 SD 卡上。我是否认为无法安装驱动程序可能与 Win CE 映像具有基于 RAM 的注册表有关？

如果 SW 没有为调制解调器提供驱动程序，这是否意味着我必须开发自己的驱动程序？还是有一个我可以使用的通用驱动程序？

我是否必须为板创建一个新的 Win CE 映像以支持调制解调器，或者是否可以使用 C# 应用程序中的代码来访问它？

任何帮助将不胜感激！

谢谢，

缺口

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T14:33:05.003

没有通用驱动程序，没有。Sierra 调制解调器通常具有 CE 支持（我没有检查过这个模型，但它可能会工作）。你需要的是：

1.  为 ARM 和 CE 6.0 或 7.0 构建的驱动程序 DLL（CE 5.0 驱动程序模型不同，因此 CE 5.0 驱动程序可能不起作用）
2.  枚举设备时 device.exe 查找的注册表项

这些有时会出现在 CAB 中，有时不会出现。一般来说，当他们不这样做时，我更喜欢它，但两者都可以。

如果 CAB 文件安装失败，可能是因为它被标记为其他平台。我会使用 WinZip 或 WinRAR 之类的东西将其拆开，重命名 DLL 并提取必要的 reg 条目（取决于 CAB 格式的难易程度）。

不过，一般来说，您需要将驱动程序 DLL 复制到 \Windows 文件夹，然后应用注册表项。然后当设备插入时，它会读取注册表，将它指向DLL，然后加载。“未识别的 USB 设备”通常表示未找到注册表项。

这一切都可以在不滚动新操作系统映像的情况下完成，尽管有时新映像比在启动时进行必要的复制更简单，特别是如果设备在启动时插入。

# php - MVC 概念 - 谁负责加载模型？

> ID：14691544
> 
> 赞同：2
> 
> 时间：2013-02-04T16:57:41.137
> 
> 标签：php, model-view-controller, model

好的，我现在了解 MVC 概念的基础知识，我知道有人问过类似的问题，但仍然没有找到明确的答案。阅读 MVC 时我发现了一些相互矛盾的例子，所以我想找出哪个概念更好。

我应该使用我的控制器从模型中加载数据，然后将该数据传递给视图，还是应该让视图从模型中加载数据并使用控制器来选择适当的视图。

对我来说更自然（正确）的方式是控制器应该加载模型，但如果我需要具有 2 个不同视图的相同内容，例如：

1.  视图显示简单的文章文本
2.  视图显示相同的文章文本，但也显示带有文章作者信息的框。

让我感到困惑的是我有一个请求，给我看 ID 为 33 的文章。在第一种情况下，一切都很清楚，但现在我的第二个视图使用显示附加数据（关于作者）的不同模板进行渲染，所以我应该让查看从模型（关于作者）请求数据还是整个逻辑应该由控制器完成？

这很令人困惑，因为现在控制器应该根据视图应该呈现的模板从模型中请求适当的数据。

希望我有道理:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:15:18.560

**简短回答**：将模型传递给控制器​​和视图。

**长答案**：在 MVC 中，控制器不会“从模型加载数据然后将该数据传递给视图”。视图与模型有直接关系，并从中请求数据。请参阅：[MVC 应该如何在 CodeIgniter](https://stackoverflow.com/questions/13813046/how-is-mvc-supposed-to-work-in-codeigniter)和[http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)中工作：“视图从模型请求它需要的信息生成输出表示。”

因此，要启用松散耦合，请完全独立地启动模型视图和控制器，并将它们相互传递。

这允许严格分离 MVC 提倡的关注点，并允许您将任何组件与任何其他组件重用，因为没有任何东西是硬编码的。

就像是：

```
$model = new Model;
$controller = new Controller($model);
$view = new View($model, $controller);
echo $view->output(); 
```

控制器不应选择视图，也不应选择模型。通过将此责任放在控制器中，控制器不能与其他视图或模型重用。

**编辑**：我已更新此内容以回答 tresko 关于视图为何需要了解其控制器的评论。

视图需要控制器以避免将控制器硬编码到视图中。这是为了让视图知道它在当前上下文中与哪个控制器配对并可以回发给它。

事件（用户操作）在视图中触发，需要由控制器处理。

有3种方法：

1）硬编码视图：控制器关系，在网络上这是通过使用来实现的`<a href="/some/hardcoded/route"`；或`<a href="' . $this->router->create('someController, 'action') . '>'`这消除了将视图与任何其他不希望的控制器一起使用的可能性。

2）将控制器传递给视图并让视图知道其事件将被触发到哪个控制器。在网络上，使用这种方法，视图还需要一个路由器，它将控制器操作转换为路由。例如`<a href="' . $this->router->getRoute($this->controller, 'action') . '>'`

3）将视图传递给控制器​​并让控制器在视图上设置操作：（控制器代码）`$this->view->setEvent('buttonClick', $this->router->getRoute($this, 'action'))`...（视图代码）`<a href="' . $this->getEvent('buttonClick') . '>'`

这些，

1) 是最不可取的，因为它严重影响了灵活性。视图只能在非常特定的控制器上调用操作。

2) 对开发人员来说是最少的工作量，但每个控制器都需要一个特定的接口。

3）这提供了最大的技术灵活性，但开发人员需要做更多的工作，并且控制器需要了解很多关于其视图的信息，除了 API 之外，它还必须知道视图中可用的事件。如果一个视图被更新并且有一个新的动作，每个控制器都需要被更新来解释它。这也适用于 2)，但是因为 2 可以使用接口轻松处理，所以跟踪使用它的每个类要容易得多。

在我看来，2 和 3 都是很好的方法，但 2 更好，因为它允许更健壮的系统并允许最多的重用，缺点是控制器必须实现特定的接口。3 允许控制器有任何接口，但它必须知道很多关于它的视图。

CakePHP 和其他流行的框架在他们的示例中倾向于对关系进行硬编码（例如[http://book.cakephp.org/2.0/en/views.html](http://book.cakephp.org/2.0/en/views.html)），`echo $this->Html->link('edit', array( 'action' => 'edit', $post['Post']['id'])); ?>`链接只能转到“编辑”控制器。这严重影响了重用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-04T17:03:33.763

我的建议是，将数据源与视图结合起来的逻辑应该完全发生在控制器中。视图不应绑定到特定的数据源。

例如，如果您有一个使用 Smarty 语法（或类似语法）和命名占位符的视图，那么您可以使用任何数据源、文本、模型等来提供信息以呈现到模板中。如果视图与模型相关联，您需要修改模型和视图，同时了解对另一个的影响。

与松散耦合相比，像这样的紧密耦合会因意外忽略某些东西而导致更多问题，松耦合使您意外破坏某些东西的机会更少。

例子：

```
class Page_Controller extends Controller {

  // __construct/__destruct/__callStatic/__call/etc, whatever you need in your implementation

  // -------------------------------------------------------
  // Adjust to suit your situation for passing data
  // This controller doesn't care where objSource comes from
  // -------------------------------------------------------
  private function pageSpecificImplementation($objSource = null){

    // using a factory class - but assume a view is created in whatever way works for you
    // the key thing here is that the view could be anything that can be returned as a string - but use whatever works for you
    $tplMain = make::view( 'template-url-or-path' )->assign(array(
       'placeholder1' => $objSource->value1,
       'placeholder2' => $objSource->value2
    ));

    $tplSub = make::view( 'template-url-or-path' )->assign( $objSource );

    $tplMain->assign('sub',$tplSub->render())->render();

    // $tpl is some form of html? csv?, who knows - not relevant at THIS stage

    // okay - now I know what I want to do!
    // decide what to do with it here - output headers for html
    // save to a file
    // output and cache the output, whatever works for you here
    // output to pdf?
    // send as an email?
    output::html( $tplMain, $cacheable, $cachetime... );
    // output::email( $tplMain, $extra_params );
    // output::pdf( $tplMain, $extra_params );
  }

} 
```

在这里，您使用的是视图，而没有将其与输出紧密耦合。您的控制器可以在运行时根据正在运行的任何业务规则修改输出，但数据源不绑定到视图，输出也不绑定到视图。

我建议以遵循类似原则的方式分离的“一些”实现。YMMV 取决于您正在做什么以及您希望如何实现它，但请尝试在 MVC 中保持每个元素分开。

在某些实现中，您会看到在视图中“替换”事物的逻辑，而无需提及“什么”视图。这通常在 Smarty 中完成。然后可以由控制器的流程确定视图。可以从多个模型或其他来源中提取数据，这可能会或可能不会影响哪个视图是合适的。

因此，您绝对应该将数据加载与视图分开。将它保存在控制器中，这是应该做出决定的地方。除非您考虑到特定的用例，否则视图不应与模型连接，例如具有紧密耦合主题视图的主题模型，其中不涉及额外的业务逻辑（不太可能但可能？）。

# c++ - 显式模板实例化在 XLC 上产生编译错误，但适用于其他编译器

> ID：14691545
> 
> 赞同：0
> 
> 时间：2013-02-04T16:57:48.110
> 
> 标签：c++, implementation, c++03, xlc

以下代码是我尝试为客户要求实现的功能的简化最小版本。

它无法在 IBM 的 XLC 编译器（版本 9 和 11）上编译并出现错误`A non-type template parameter cannot have type "int X::*".`。但是，我用 g++ 4.7.2、clang++ 3.2 和 Intel-13.0 尝试了相同的代码，它们编译成功。

我很想知道 XLC 是否是这里唯一理智的声音，或者其他编译器是否正确？

```
struct X {
    X() : y(123) {}
    int y;
};

struct XFoo {
   typedef int X::* Type;
};

template <typename Name, typename Name::Type value>
struct Bar {
    typename Name::Type getValue(Name) {
        return value;
    }
};

template class Bar<XFoo, &X::y>;    // xlc error here, works fine on others

int main() {} 
```

我多次阅读了 C++ 2003 标准章节中关于模板的内容，但无法最终找到禁止`<type> <class>::*`用作非模板类型的内容。我已经通过 SO 和搜索引擎搜索了解释，但没有遇到任何可以帮助我做出决定的权威来源。

我知道这可能不是一个好的编码实践，但这是客户端代码所必需的，因为它们的要求有些独特。我也尝试了其他各种替代方案，但对他们不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:19:16.767

明确允许指向成员模板参数的指针，应向 XLC 提供错误报告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T17:19:34.030

C++03 标准的第 14.1/4 节**允许**将指向成员的指针作为模板参数：

> **非类型**模板参数应具有以下类型之一（可选 cv 限定）：
> 
> *   整数或枚举类型，
> *   指向对象的指针或指向函数的指针，
> *   引用对象或引用函数，
> *   **指向成员**的指针。

相应地，根据 § 14.3.2/1：

> **非类型**、非模板模板参数的模板参数应为以下**之一**：
> 
> *   整数或枚举类型的整数常量表达式；或者
> *   非类型模板参数的名称；或者
> *   具有外部链接的对象或函数的地址，包括函数模板和函数模板 ID，但不包括非静态类成员，表示为 & id-expression 其中 & 是可选的，如果名称指的是函数或数组，或者如果相应的模板参数是参考；或者
> *   **指向成员的指针，如 5.3.1 中所述**。

因此，非类型模板参数*可以*是指向成员的指针。有一些限制适用于模板专业化，但它们似乎不适用于这种情况。

# java - 在 Eclipse 中从 UML/OCL 模型自动生成测试用例

> ID：14691547
> 
> 赞同：0
> 
> 时间：2013-02-04T16:57:58.707
> 
> 标签：java, uml, modeling, ocl

我正在做基于模型的测试，我已经使用 UML 图对我的应用程序进行了建模，并且还编写了使用 OCL 进行测试的所有约束，我想知道是否有 eclipse 的工具或插件可以帮助从 UML/OCL 模型生成测试用例可用于黑盒测试。（提前致谢）

' @Christian 感谢您的回复，下面是我的 OCL 表达式的一部分

```
post: numberOfTrials = numberOfTrials@pre + 1
and if userPin = customer.card.pin and numberOfTrials <= 3
then pinAccepted and result = PinResult::Correct
else not pinAccepted
and if numberOfTrials <= 3
then result = PinResult::Wrong
else result = PinResult::Abort
endif
endif
context ATMController::withdraw(amount:Real) : Boolean
pre: pinAccepted
post: if (amount <= customer.account.balance)
then customer.account.balance =
customer.account.balance@pre - amount
and result = true
else customer.account.balance =
customer.account.balance@pre
and result = false
endif 
```

'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T18:42:06.943

由于您的查询似乎处理模型类的实例，您可以从 org.eclipse.uml 模型生成 EMF（ecore）（创建 genmodel 并选择 .uml-file 作为源），然后使用 Eclipse OCL 执行您的查询，如下所述：[http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.emf.query.doc/tutorials/oclQueryTutorial.html](http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.emf.query.doc/tutorials/oclQueryTutorial.html)

# vb.net - Visual Studio 2010 从 gridview 中获取价值

> ID：14691549
> 
> 赞同：0
> 
> 时间：2013-02-04T16:58:01.060
> 
> 标签：vb.net, visual-studio-2010, gridview

当一个人连续点击“选择”链接时，如何在网格视图中获取值？

如果我有数据绑定，我可以获得该值。但是我试图突出显示某些标签。“HighlightTex”功能让我突出显示用户选择的一些单词。

这是一个片段：我正在尝试获取“lblinvnum”的值。

```
<asp:GridView ID="gvDetails" runat="server"     AutoGenerateColumns="False" AllowPaging="True"
AllowSorting="True" DataSourceID="SqlDataSource1"     Width="540px" 
        CssClass="Gridview" >
<HeaderStyle BackColor="#df5015" />
<Columns>
   <asp:TemplateField HeaderText="Invnum"     ItemStyle-Wrap="False">
   <ItemTemplate>
  <asp:Label ID="lblInvnum" Text='<%#     HighlightText(Eval("Invnum").ToString()) %>' runat="server"     />
   </ItemTemplate> 
```

... ... ... 对于下面列出的“AmtPaid”，我可以获取该值。我无法弄清楚如何将“lblInvnum”的值获取到上面列出的片段中。

```
 <asp:BoundField DataField="AmtPaid" HeaderText="AmtPaid" 
        SortExpression="AmtPaid" DataFormatString="{0:c}" > 
```

在 Visual Basic 中，这就是我如何获得上述 AmtPaid 的方法。

```
 Dim index As Integer = Convert.ToInt32(e.CommandArgument)
        Dim selectedRow As GridViewRow = gvDetails.Rows(index)
        Dim contactCell As TableCell = selectedRow.Cells(1)
        Dim contact As String = contactCell.Text 
```

建议？

# php - 加入 MySQL 不起作用

> ID：14691552
> 
> 赞同：0
> 
> 时间：2013-02-04T16:58:03.833
> 
> 标签：php, mysql, join, where

我已经尝试了一切，但没有任何效果..即使在我编写的其他代码中，它也有效。但由于某种原因，现在不会。

我想加入两个 ID = userID 的表。当我加载页面时，我收到此错误：

> 警告：mysql_fetch_array()：提供的参数不是第 17 行 /home/ynxwleus/domains/mustseenmovies.nl/public_html/films/userinfo.php 中的有效 MySQL 结果资源

有没有人可以帮助我解决这个问题？

**代码：**

```
$userID = $_SESSION['s_userID'];
        echo $userID;
        $query = "SELECT userID, userName, userFrontname, userSurname, filmID 
        FROM users
        JOIN seenIt
        ON users.userID = seenIt.userID 
        WHERE (userID ='$userID')";

        $res = mysql_query($query);
                while ($row = mysql_fetch_array($res)) {
                    echo $row['userName'];
                    echo $row['userFrontname'];
                    echo $row['userSurname'];
                    echo $row['filmID'];
                } 
```

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-04T16:59:30.870

您的 where 子句需要一个别名：

```
 WHERE (users.userID ='$userID') 
```

您的 select 子句还需要 userId 的别名：

```
 SELECT users.serID, userName, userFrontname, userSurname, filmID 
```

事实上，*总是*使用别名是一个非常好的主意：

```
SELECT u.userID, u.userName, u.userFrontname, u.userSurname, si.filmID 
FROM users u join
     seenIt si
    ON u.userID = si.userID 
WHERE u.userID ='$userID' 
```

原始查询有语法错误，因为 SQL 引擎不知道`userID`引用的是哪个。哦，您在想“这很明显，因为`on`子句指定值是相同的。” 嗯，人类比 SQL 编译器更聪明，至少在常识方面是这样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T17:03:13.340

如果您的查询返回错误，则`mysql_query`返回 boolean `false`。您可以使用 打印出此错误`mysql_error()`。

```
$res = mysql_query($query) or die(mysql_error()); 
```

此外，`mysql_fetch_row`它不适用于布尔值，因此您会收到编译错误。

正如 Gordon 指出的那样，您的查询有错误。

此外，我建议不要再使用`mysql`，因为它已被弃用。使用`MySQLi`, 或`PDO`代替。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-07T10:13:06.637

```
$query = "SELECT userID, userName, userFrontname, userSurname, filmID 
          FROM users
          JOIN seenIt
          WHERE users.userID = seenIt.userID 
          AND  users.userID = ".$userID." "; 
```

# c# - 运行单元测试时如何禁用 PostSharp？

> ID：14691554
> 
> 赞同：3
> 
> 时间：2013-02-04T16:58:05.673
> 
> 标签：c#, unit-testing, nunit, aop, postsharp

我希望我的 nunit 测试不应用我的任何 PostSharp 方面，以便我可以单独测试我的方法。这可以在测试夹具设置中以某种方式完成，还是只能在每个项目级别上完成？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T21:23:07.560

您可以在测试版本上设置“SkipPostSharp”标志，这样它就不会首先编译到您的二进制文件中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-18T15:56:52.550

你可以在你的方面有一个静态标志来打开/关闭它并检查你的方面实现中标志的状态。

然后在您的单元测试设置中，只需关闭静态标志。

例如

```
 public static bool On = true; 
```

...

```
 public override void OnInvoke(MethodInterceptionArgs args)
    {
        if (!CacheAttribute.On)
        {
            args.ReturnValue = args.Invoke(args.Arguments);
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-25T05:30:10.243

如果您在单元测试中使用 Typemock，您可以使用类似

```
MyAspect myAspectMock = Isolate.Fake.Instance<MyAspect>(Members.MustSpecifyReturnValues);
Isolate.Swap.AllInstances<MyAspect>().With(myAspectMock); 
```

这使您可以控制使用方面的测试以及不使用方面的测试，从而使您可以测试方法本身并应用建议。

大概会有与其他模拟框架类似的机制

# r - R中的西里尔编码输出

> ID：14691555
> 
> 赞同：5
> 
> 时间：2013-02-04T16:58:06.400
> 
> 标签：r, encoding, output

编码对我来说总是很痛苦，而且再次用俄语文本编写文件是不可能的。我该怎么办？

```
 >test = c("привет","пока")
 >test
 [1] "\320\277\321\200\320\270\320\262\320\265\321\202" "\320\277\320\276\320\272\320\260"

 >Encoding(test)
 [1] "unknown" "unknown"

 > f = file("test.txt", encoding = "UTF-8")

 > write(t,f)
 Error in cat(list(...), file, sep, fill, labels, append) : 
 argument 1 (type 'closure') cannot be handled by 'cat'

 > Encoding(test) = "UTF-8"
 > test
 [1] "<U+043F><U+0440><U+0438><U+0432><U+0435><U+0442>" "<U+043F><U+043E><U+043A><U+0430>"  

 > write(t,f)
 Error in cat(list(...), file, sep, fill, labels, append) : 
 argument 1 (type 'closure') cannot be handled by 'cat' 
```

我使用 R-studio 0.97.312、Mac OS 10.7.5、

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-12T15:57:08.357

如果您只是访问 Encoding() 的帮助页面，您会发现本机函数 enc2native(x)，这将起到如下作用

```
test = enc2utf8(c("привет","пока")) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-03T06:20:07.607

我知道您对编码问题的痛苦:(希望这会对您有所帮助：

```
 > Sys.setlocale(,"ru_RU")
    [1] "ru_RU/ru_RU/ru_RU/C/ru_RU/C"
    > test = c("привет","пока")
    > write(test, file="test.txt") 
```

之后您甚至可以使用西里尔文变量`Sys.setlocale(,"ru_RU")`：

```
 > привет <- rnorm(100)
   > min(привет)
   [1] -2.54578 
```

Так что удачи！:)

# android - Android 轮式加载图标

> ID：14691556
> 
> 赞同：2
> 
> 时间：2013-02-04T16:58:24.740
> 
> 标签：android, android-ui

我正在尝试在一项活动中呈现加载圈，该活动的数据由异步任务填充。我没有使用默认进度条，因为旧版 Android 中的图标如下所示：

![在此处输入图像描述](../Images/64157981b5dafe38585cab7cfdcf38f9.png)

我知道如何使用带有自定义图像和旋转动画的 ImageView 或 ProgressBar，但我无法在任何地方找到新的官方 Android 外观图标。看起来像这样的一个：

![在此处输入图像描述](../Images/b003bd90ddc83aa3103857eb11f9c720.png)

或者也许还有另一种方法可以在 Android 2.2 中生成这种旋转轮动画。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-04T17:11:30.597

一般来说，最好坚持该系统上设置的样式。

如果您仍想要较新的纺车动画，请`indeterminateDrawable`在 ProgressBar 上设置 XML 属性。`[android-sdk]\platforms\android-17\data\res\drawable`您可以在 SDK 文件夹中的called`progress_medium.xml`和 others下找到可绘制的 XML 文件。您还需要存储在`drawable-****`文件夹中的引用图标文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T17:05:45.493

检查文件夹 SDK_DIR\platforms\android-x\data\res\drawable-hdpi。应该有像“微调器...”这样的微调器可绘制对象

# jquery - 通过 Ctrl + 单击选择多个 DataTable 行

> ID：14691558
> 
> 赞同：1
> 
> 时间：2013-02-04T16:58:32.697
> 
> 标签：jquery, datatables

DataTables 网站上有一个示例[，](http://www.datatables.net/release-datatables/extras/TableTools/select_multi.html)显示单击即可实现多项选择。

此功能的可用性相当低，因为通过按住`Ctrl`并单击行来更好地呈现多项选择。

源代码太混乱，无法深入研究。有没有人这样做过并指出我正确的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:54:07.697

只需向 TR 添加一个单击事件并切换“选定”类（可以是您想要的任何类名或属性。关键方面是使用 event.ctrlKey 检查控制键是否关闭并使用 jqueries .siblings() 和.removeClass() 函数。

```
$("#demo tbody").delegate("tr", "click", function(event){
    var $row = $(event.target);
    if($row[0].tagName !== "TR") $row = $row.parent();
    $row.toggleClass("selected");
    if(event.ctrlKey === false) {
        $row.siblings().removeClass("selected");
    }
}); 
```

[http://jsfiddle.net/9FMBv/](http://jsfiddle.net/9FMBv/)

# opengl - 几秒钟后Opengl速度增加

> ID：14691563
> 
> 赞同：0
> 
> 时间：2013-02-04T16:58:54.883
> 
> 标签：opengl

我正在开发一个以 OpenGL 作为基础渲染器的渲染引擎。渲染器在开始时以 150 fps 开始，大约 30 秒后 fps 增加到 500。我已经分别为引擎的每个部分计时，唯一提高速度的部分是绑定 [静态]VBO 和调用的 drawMesh 函数glDrawArrays。

我还评论了 glPush 和 glGet 函数，它们的行为与结果相同。

每次我运行引擎时都会发生这种情况，即使相机没有移动并保持渲染完全相同的场景。

有谁知道这是怎么发生的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:22:29.873

**问题**

问题源于 VBO 在创建后被映射到缓冲区。模型类执行一次以更新其边界；并且在粒子的情况下用所需的数据更新缓冲区。

似乎视频卡（或至少在我的情况下具有*Geforce GTS 450*）在取消映射 VBO 后不会直接将数据复制回视频卡，特别是在使用 GL_READ_WRITE_ARB 标志映射缓冲区时。它会将数据保存在外部 RAM 中几秒钟，然后再将数据复制回 VRAM。

**解决方案**

通过使用 GL_READ_ONLY_ARB 标志来映射应该只读取数据的数据，缓冲区将几乎直接复制回 VRAM。但是，在我的情况下，在网格对话期间计算边界并且在为此目的创建 VBO 后根本不访问数据会更有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:09:16.240

也许是因为着色器是在首次使用之前即时编译的。

看看[GL_ARB_get_program_binary](http://www.opengl.org/registry/specs/ARB/get_program_binary.txt)

此外，在初始化阶段加载它们时，尝试使用着色器渲染三角形（可能会在屏幕外执行此操作）。

# java - 如何在 jxpath 中实现昂贵的查询？

> ID：14691565
> 
> 赞同：0
> 
> 时间：2013-02-04T16:58:55.230
> 
> 标签：java, jxpath

想象一下，有人使用 JXPath 作为一种访问语言，访问一棵树，该树具有某些节点，这些节点表示在内存中保存的集合非常大或昂贵 - 例如，

```
.../customers[id=12345] 
```

客户确实在数据库中，并且数量众多。我不需要人们可以想象的所有查询的全部通用性——只需要像这样的几种索引良好的查询。

有没有一种实用的方法来使用 jxpath 的自定义功能来实现这些？如果是这样，你能指出我的例子、相关文档等吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-21T11:22:12.867

查看[JXPath 用户指南](http://commons.apache.org/proper/commons-jxpath/users-guide.html#Custom_Extension_Functions)。您可以创建一个将查询作为参数的扩展函数。

```
public static NodeSet getCustomers(String query){
    List<Customer> l=getCustomersFromMyDatabase(query);
    BasicNodeSet bns=new BasicNodeSet();
    putCustomersIntoNodeSet(bns,l);
    return bns;
} 
```

然后你的 xpath 看起来像

```
getCustomers('id=123') 
```

你也可以有一个**ExpressionContext**类型的第一个参数，如果你需要它可以给你上下文对象，等等。

# dynamic - 如何在 SSRS 2008 中映射动态创建的列？

> ID：14691566
> 
> 赞同：0
> 
> 时间：2013-02-04T16:59:09.343
> 
> 标签：dynamic, reporting-services, names

我写了一个存储过程，它的结果包括 4 个列，它们的名称会随着时间而改变。它们对应于周数。因此，一列将是“1”，另一列将是“2”，依此类推。报表运行时，它们会不断变化，即'49'、'50'、'51'、'52'。在报表生成器中，您必须将列名映射到列名，但列名会改变，它们不是静态的。

知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T00:26:29.343

SSRS 不支持动态列名。我会重新编码您的存储过程以返回值为 1、2 等的 Week 列。

# c# - 反序列化 json，以便我可以对其进行数据绑定

> ID：14691567
> 
> 赞同：2
> 
> 时间：2013-02-04T16:59:10.630
> 
> 标签：c#, asp.net

我有一个 json 字符串，我想对其进行反序列化并将其放入列表中。我的代码在下面，有人可以帮助我朝正确的方向吗？当我运行 Response.Write(reports.Count); 在我尝试反序列化之后，它确实计算了 2 个条目，但我似乎无法绑定到它。有什么建议吗？

```
public class Report
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
}

on page_load.....

    responseData = [{"FirstName":"George","LastName":"Clooney"},{"FirstName":"Brad","LastName":"Pitt"}]

    IList<Report> reports = new JavaScriptSerializer().Deserialize<IList<Report>>(responseData);

    Response.Write(reports.Count);

    ReportRepeater.DataSource = reports;
    ReportRepeater.DataBind(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:10:26.527

试试这个（`Main()`来自 LinqPad，但它应该给你一个想法）

```
void Main()
{
    string responseData = "[{\"FirstName\":\"George\",\"LastName\":\"Clooney\"},{\"FirstName\":\"Brad\",\"LastName\":\"Pitt\"}]";

    Report[] reports = new System.Web.Script.Serialization.JavaScriptSerializer().Deserialize<Report[]>(responseData);

    reports.Dump(); // <-- Dump() is  another LinqPad extension method that can be ignored.
}

public class Report
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

# java - Webdriver 2.28 是否会自动截取异常/失败/错误的屏幕截图？

> ID：14691571
> 
> 赞同：8
> 
> 时间：2013-02-04T16:59:28.157
> 
> 标签：java, selenium, webdriver, selenium-webdriver

Webdriver 2.28 是否会自动截取异常/失败/错误的屏幕截图？

如果是这样，我在哪里可以找到屏幕截图？哪个目录是默认的？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-05T20:26:47.760

不，它不会自动执行。您可以尝试两种选择：

1.  使用[`WebDriverEventListener`](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/support/events/WebDriverEventListener.html#onException%28java.lang.Throwable,%20org.openqa.selenium.WebDriver%29)可连接到[`EventFiringWebDriver`](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/support/events/EventFiringWebDriver.html)您可以简单地包裹在您常用的驱动程序上的它。这将为`Exception`底层的每个抛出的屏幕截图`WebDriver`，但如果您未通过`assertTrue()`检查，则不会。

    ```
    EventFiringWebDriver driver = new EventFiringWebDriver(new InternetExplorerDriver());
    WebDriverEventListener errorListener = new AbstractWebDriverEventListener() {
        @Override
        public void onException(Throwable throwable, WebDriver driver) {
            takeScreenshot("some name");
        }
    };
    driver.register(errorListener); 
    ```

2.  如果您使用的是 JUnit，请使用[`@Rule`](http://kentbeck.github.com/junit/javadoc/4.10/org/junit/Rule.html)and [`TestRule`](http://kentbeck.github.com/junit/javadoc/4.10/org/junit/rules/TestRule.html)。如果测试因任何原因失败，这将截取屏幕截图。

    ```
    @Rule
    public TestRule testWatcher = new TestWatcher() {
        @Override
        public void failed(Throwable t, Description test) {
            takeScreenshot("some name");
        }
    }; 
    ```

在这两种情况下的`takeScreenshot()`方法都是：

```
public void takeScreenshot(String screenshotName) {
    if (driver instanceof TakesScreenshot) {
        File tempFile = ((TakesScreenshot)driver).getScreenshotAs(OutputType.FILE);
        try {
            FileUtils.copyFile(tempFile, new File("screenshots/" + screenshotName + ".png"));
        } catch (IOException e) {
            // TODO handle exception
        }
    }
} 
```

...其中[`FileUtils.copyFile()`](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html#copyFile%28java.io.File,%20java.io.File%29)方法是 Apache Commons IO（也随 Selenium 提供）中的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T09:22:44.317

WebDriver 本身不会截取屏幕截图。但是你的猫是这样接受的：`((TakesScreenshot)webDriver).getScreenshotAs(OutputType.FILE);`

然后将屏幕截图保存在您想要的任何位置。

你也可以使用像修昔底德这样的东西，它可能会在每个动作或错误时截取屏幕截图并将其放入漂亮的报告中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T09:22:56.817

简短的回答是否定的。WebDriver 是一个与浏览器交互的 API。您可以使用它制作屏幕截图，但您应该知道何时执行此操作。所以它不会自动完成，因为 WebDriver 对测试一无所知。

如果您使用 TestNG 作为测试库，您可以实现侦听器，其方法将在不同的事件（失败、成功或其他）上执行。在这些方法中，您可以实现所需的逻辑（例如制作屏幕截图）。

# css - Highcharts - 在饼图中放置一个楔形的样式和更改样式的位置

> ID：14691574
> 
> 赞同：2
> 
> 时间：2013-02-04T16:59:49.193
> 
> 标签：css, styles, highcharts, pie-chart

我在这里有一个 Highcharts 饼图：http: [//jsfiddle.net/6PbbR/52/](http://jsfiddle.net/6PbbR/52/)

```
$(function () {

    var chart;
    $(document).ready(function() {

      // Radialize the colors
    Highcharts.getOptions().colors = Highcharts.map(Highcharts.getOptions().colors, function(color) {
        return {
            radialGradient: { cx: 0.5, cy: 0.3, r: 0.7 },
            stops: [
                [0, color]
            ]
        };
    });

    // Build the chart
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
                shadow: true,
                    },
            tooltip: {
                enabled: false
            },
            title: {
                text: ""
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    size:'68%',
                    cursor: 'pointer',
                    shadow: true,
                    dataLabels: {
                        enabled: true,
                        distance: -40,
                        style: {
                        width: '100px'
                    },
                        color: '#fff',
                        connectorColor: '#000000',
                        formatter: function() {
                            return '<b style="font-family:arial;font-size:10px;font-weight:bold">'+ this.point.name +'</b> ';
                        }
                    }
                }
            },
            series: [{
                type: 'pie',
                 name: 'Income Investments',
                data: [
                     ['FLOATING RATE FUNDS',   16.667],
                    {
                        name: 'Corporate Capital Trust',
                        y: 16.667,
                        sliced: true,
                        selected: true
                    },                                     
                    ['BONDS',   16.667],
                    ['ANNUITIES',       16.667],
                    ['REITs',    16.667],
                    ['CDs',     16.667]
                ]
            }],

        colors: [
                     '#83a3c6',
                      '#98012e', 
                    '#19699b', 
                    '#ae9e8e', 
                    '#5283b0', 
                    '#958370'
                      ],
        });
    });

}); 
```

两个问题：

1) 我对在 plotOptions{pie{formatter. 哪里有更好的地方使用 API 来执行此操作，而不是强制使用内联样式？

2）我想更改红色楔形的字体系列（并可能调整其定位/边距）。这样做的最佳方法是什么？

编辑：理想情况下，我可以在不需要超出上述功能的情况下完成我的需求。是否可以使用 API 将样式附加到一个数据点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:14:57.023

这是一个简单的 html，所以你可以添加一个`class`or`id`然后使用`css`.

js

```
formatter: function() {
    return '<b id="myTooltipId">'+ this.point.name +'</b> ';
} 
```

css

```
#myTooltipId {
    font-family: arial;
    font-size: 10px;
    font-weight:bold
} 
```

**更新**：

在格式化程序内部，您可以使用`this`.
所以你只需要检查切片是否是你想要的。

```
formatter: function() {
    // key is the slice name
    if (this.key == 'CDs') {
        return '<b id="myTooltipId">'+ this.point.name +'</b> ';
    } else {
        return this.value;
    }
} 
```

# php - 从 html 源代码中删除 php 短标签

> ID：14691575
> 
> 赞同：1
> 
> 时间：2013-02-04T16:59:53.347
> 
> 标签：php, regex, php-shorttags

我正在用 curl 解析一些 html 代码。某些网站的 html 源代码，例如：

```
<div id="content">
    some words
</div>
<?    
    $box_social['dimensioni']="80";
        $box_vota=array();
    $box_vota["novideo"]='';
    $box_vota["nofoto"]='';
    $box_vota["id_articolo"]='1003691';
    include($_SERVER['DOCUMENT_ROOT']."/incs/box_social.php");    
?>
<div id="footer">
   some words
</div> 
```

如何从 html 源代码中删除 php 短标签？我需要

```
<div id="content">
    some words
</div>
<div id="footer">
   some words
</div> 
```

我使用`preg_replace('/<\?(.*?)\?>/','',$html);`，但 php 短标签部分仍然存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:09:42.013

此正则表达式符合您的情况：

```
$html = htmlspecialchars(preg_replace('/<\?([\w\W]*)\?>/','',$html));
$html = htmlspecialchars(preg_replace('/<\?(.*)\?>/s','',$html)); 
```

如果存在多个 PHP 块，这也匹配：

```
$html = htmlspecialchars(preg_replace('/<\?([^\?>]*)\?>/','',$html)); 
```

[来自](http://php.net/manual/en/reference.pcre.pattern.modifiers.php)PHP.NET

> s (PCRE_DOTALL) 如果设置了此修饰符，则模式中的点元字符匹配所有字符，包括换行符。没有它，换行符被排除在外。这个修饰符等价于 Perl 的 /s 修饰符。诸如 [^a] 之类的否定类始终匹配换行符，与此修饰符的设置无关。

# json - ASCII 绘图显示为对 Google 的请求的 JSON 响应

> ID：14691578
> 
> 赞同：6
> 
> 时间：2013-02-04T16:59:57.007
> 
> 标签：json, request

我目前正在开发一个小型 php 库，它允许用户从 Google Play 开发者控制台访问数据，并将其插入数据库以供将来使用。

为此，我使用 GET 和 POST 请求（这部分仍然可以）对相应的 Google 服务进行身份验证，然后执行各种 POST 请求以获取我需要的所有数据。

一切正常，我让脚本本身运行（用于获取 JSON 响应）自 2 或 3 周以来，从那时起我每天都启动它：没问题。

今天，我尝试再次启动它，作为任何 POST 请求的 JSON 响应，我得到了这个：

![在此处输入图像描述](../Images/43eb35ae689224a3af883fe471d262d7.png)

我发誓这不是假的，但它非常可怕。谷歌现在在拖钓我吗？另外，控制台的网络版本仍然有效，只是我的外部请求似乎没有。

我正在使用本地主机，所以黑客攻击的可能性接近（如果不是）0，我真的很担心我所做的所有这些工作都是徒劳的。

如果谷歌真的试图阻止我获取数据，再加上让我愤怒，他们做得对。

我一直在用各种关键字搜索这个，仍然没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T11:05:11.533

实际上，我已经解决了这个问题。由于 Google Webkit 似乎会定期更改其 JSON 响应的格式，因此我的解析和正则表达式不再适用于获取正确的身份验证标识符。我仍然认为谷歌在欺骗用户或非官方 API 的开发人员，但现在我找到了一个解决方案：手动检查我的解析函数，调整它们以获得每个正确的值，然后它又可以工作了。

这很痛苦，但如果有人遇到这个问题并在这里结束，你知道该怎么做！

（我不能更准确，因为这些变化是完全随机的，但这些都是指导方针。）

# excel - 如何仅使用公式计算excel中由分隔符分隔的字符串中的值？

> ID：14691601
> 
> 赞同：2
> 
> 时间：2013-02-04T17:01:28.050
> 
> 标签：excel

我正在尝试计算以下字符串中的名称：

约翰/比尔/罗伯特/爱德华

我需要知道内置公式来计算名称。根据上面的例子，我应该得到 4 作为结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:09:14.283

也许计算斜线并添加 1 - 为单个单元格的此公式提供空白

`=IF(A1="",0,LEN(A1)-LEN(SUBSTITUTE(A1,"/",""))+1)`

如果您想跨范围计数，请使用此版本

`=SUMPRODUCT((A1:A10<>"")+0,LEN(A1:A10)-LEN(SUBSTITUTE(A1:A10,"/",""))+1)`

# php - 使用 php 和 jQuery 验证验证码和联系表单

> ID：14691605
> 
> 赞同：0
> 
> 时间：2013-02-04T17:01:48.467
> 
> 标签：php, jquery, ajax, validation, captcha

我是 jQuery 的新手。

我有一个带有验证码的 html 联系表单。

该表单使用 jQuery 来验证姓名、电子邮件地址和消息。

但是我在集成验证码验证时遇到了麻烦。

`verifyimage.php`使用以下代码（通过）生成验证码：

```
<?php
session_start();
error_reporting( 0 );
if( !function_exists( "imagecreatefrompng" ) )
{
    exit( "You need to recompile with the GD library included in PHP for this feature to be able to function" );
}
$alphanum = "ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";
$rand = substr( str_shuffle( $alphanum ), 0, 6 );
$image = imagecreatefrompng( "../images/verify.png" );
$textColor = imagecolorallocate( $image, 150, 150, 150 );
imagestring( $image, 5, 14, 22, $rand, $textColor );
$_SESSION['image_random_value'] = md5( $rand );
header( "Expires: Mon, 26 Jul 1997 05:00:00 GMT" );
header( "Last-Modified: ".gmdate( "D, d M Y H:i:s" )." GMT" );
header( "Cache-Control: no-store, no-cache, must-revalidate" );
header( "Cache-Control: post-check=0, pre-check=0", false );
header( "Pragma: no-cache" );
header( "Content-type: image/png" );
imagepng( $image );
imagedestroy( $image );
?> 
```

表单的 HTML 如下：

```
<!-- Contact Form -->
<div id="contactForm">
        <form action="/contact.php" method="post">
        <div class="oneThird">
            <div class="row">
                <label for="contactName">Full Name</label>
                <input id="contactName" name="contactName" type="text" />
            </div>
            <div class="row topMargin">
                <label for="contactEmail">Email Address</label>
                <input id="contactEmail" name="contactEmail" type="text" />
            </div>
                        <div class="row topMargin">
                <label for="contactVerify">Captcha</label>
                <input style="background-image: url(/php/verifyimage.php);" id="contactVerify" name="contactVerify" type="text" />
            </div>
                    </div>
        <div class="twoThird lastColumn">
            <div class="row">
                <label for="contactMessage">Message</label>
                <textarea id="contactMessage" name="contactMessage" cols="10" rows="9"></textarea>
            </div>
        </div>
        <div class="clearfix">
        </div>
        <button type="submit" class="colorButton">Send Message</button>
    </form>
    </div> 
```

jQuery 包含以下与验证表单名称、电子邮件和消息部分相关的代码：

```
// Contact
    if ($('#contactForm').length != 0)
    {
        var labelName = $('#contactForm label[for="contactName"]').text();
        var labelEmail = $('#contactForm label[for="contactEmail"]').text();
        var labelMessage = $('#contactForm label[for="contactMessage"]').text();
        var emailPattern = new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);

        if ($('#contactVerify').length != 0)
        {
            var labelVerify = $('#contactForm label[for="contactVerify"]').text();
        }

        $('#contactForm button').click(function()
        {
            if ($('#contactName').val() == '')
            {
                $('#contactForm label[for="contactName"]').addClass('error').text(labelName + ' is required');
            }
            else
            {
                $('#contactForm label[for="contactName"]').removeClass('error').text(labelName);
            }

            if ($('#contactEmail').val() == '')
            {
                $('#contactForm label[for="contactEmail"]').addClass('error').text(labelEmail + ' is required');
            }
            else if (!emailPattern.test($('#contactEmail').val()))
            {
                $('#contactForm label[for="contactEmail"]').addClass('error').text(labelEmail + ' is invalid');
            }
            else
            {
                $('#contactForm label[for="contactEmail"]').removeClass('error').text(labelEmail);
            }

            if ($('#contactMessage').val() == '')
            {
                $('#contactForm label[for="contactMessage"]').addClass('error').text(labelMessage + ' is required');
            }
            else
            {
                $('#contactForm label[for="contactMessage"]').removeClass('error').text(labelMessage);
            }

            if (typeof labelVerify != 'undefined')
            {
                if ($('#contactVerify').val() == '')
                {
                    $('#contactForm label[for="contactVerify"]').addClass('error').text(labelVerify + ' is required');
                }
                else
                {
                    $('#contactForm label[for="contactVerify"]').removeClass('error').text(labelVerify);
                }

            }

            if ($('#contactForm label.error').length == 0)
            {
                $('#contactForm form').append('<input type="hidden" value="1" name="contactValid" />');
            }
            else
            {
                return false;
            }
        });
    } 
```

我对如何实现验证码验证感到困惑。我是否将其包含在`contact.php`发布到的表单中？

或者我可以在表格发布之前验证验证码吗？就像电子邮件地址一样？

我试过添加：

```
<?php
session_start();
$cap = 'notEq';
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    if (md5($_POST['contactVerify']) == $_SESSION['image_random_value']) {
        // contactVerify verification is Correct. Do something here!
        $cap = 'Eq';
    } else {
        // contactVerify verification is wrong. Take other action
        $cap = '';
    }
}
?> 
```

到 HTML 表单的顶部。然后还添加：

```
var capch = '<?php echo $cap; ?>';
                if(capch != 'notEq'){
                    if(capch == 'Eq'){
        // My PHPMailer script //
                    }
                    else{
                        $('#contactForm label[for="contactVerify"]').addClass('error').text(labelVerify + ' is invalid');
                    }
                }                

            }); 
```

作为脚本。但没有任何喜悦。无论验证码是否无效，都会发送表单。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T21:02:29.200

您需要将验证码保存到 PHP 中的 $_SESSION 并检查它，而不考虑本地验证。

接下来，人们很少使用本地验证码验证的原因是因为它需要对服务器进行“检查”，脚本会询问服务器是否正确，然后告诉用户是否正确（否则 Web 浏览器会知道验证码的价值会破坏目的，因为任何编码人员都可以抓住它并利用它）。

我建议做的是使用异步表单提交（在提交时隐藏表单而不刷新页面，使用 javascript 提交表单而不是整个页面重新加载到 /contact.php。接下来，让 HTTP 响应是PHP返回“成功”或失败原因，当客户端收到失败响应时，会再次显示表单（注意，由于没有刷新，数据仍然在字段中），给一个新的验证码这样某人就不能不断地轮询相同的验证码，并给用户一些指示，表明他们所做的事情已经失败。

[抛开手头的问题不谈，所有这些在Angular JS](http://angularjs.org/)中都非常简单。我强烈推荐它。

希望这有帮助！

# ui-automation - 使用 UI 自动化访问原生 iPhone 应用程序中的 webview 元素

> ID：14691610
> 
> 赞同：1
> 
> 时间：2013-02-04T17:02:11.860
> 
> 标签：ui-automation

我正在使用 Apple 的 UIAutomation 框架为原生 iPhone 应用程序进行 UI 测试自动化，该应用程序使用 Web 视图进行结帐交易。我面临的问题是，当我从本机应用程序中点击 Checkout 按钮时，应用程序内的 web 视图会打开，其中有一个我无法访问的名为“Complete Checkout”的按钮。我曾尝试使用`target.logElemenTree()`来获取 WebView 的元素，但我在 Instruments 中看不到任何东西。谁能让我知道如何在 iOS 上的本机应用程序中访问 webview 元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-31T06:24:00.883

如果您的结帐按钮是 web 视图中的链接，那么您将能够访问它。检查“完整结帐”的属性。不推荐使用 X 和 Y 坐标进行攻丝。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:35:54.837

您可以获取 Complete Checkout 按钮的 X、Y 坐标并让 UI 自动化点击它。例如，如果按钮的 X、Y 坐标为 x:10, y:20，您将运行 target.tap({x:10, y:20});

# javascript - Sencha Touch 无法在移动浏览器中启动

> ID：14691611
> 
> 赞同：0
> 
> 时间：2013-02-04T17:02:12.373
> 
> 标签：javascript, sencha-touch, mobile-safari, android-browser

我一直在开发基于 Sencha Touch 2.1 的移动应用程序，主要是在 iOS 上使用桌面 Chrome 和 PhoneGap / Cordova 包进行测试。最近我决定将它作为一个“原生”应用程序和一个功能减少的网络应用程序启动。

在我的测试中，Web 应用程序将在桌面浏览器（Mac 的 Safari 和 Chrome）上加载，但不会在移动浏览器上加载（我已经在 iOS 上测试了 Safari 和 Chrome，以及 Android 2.3 浏览器）。

我正在使用包构建进行测试，但测试构建并没有更好。使用 Safari 开发者控制台，我可以看到 Ext 对象似乎已完全加载，并且我的所有视图、控制器、模型和存储都加载到我的应用程序的命名空间中——但是，`app`and`config`属性*不*存在，并且该`launch()`功能永远不会跑。控制台中没有错误。

有人遇到这个问题并知道解决方案（或一些故障排除提示）吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T06:12:08.907

你能确认你的 app.json 吗？如果您使用 "x-bootstrap": true 添加了 cordova.js 的路径，则该文件永远不会复制到您的构建目标中。

```
"js": [
    {
        "path": "touch/sencha-touch.js",
        "x-bootstrap": true
    },
    {
        "path": "lib/cordova.js",
        /*"x-bootstrap": true*/
    },
    {
        "path": "app.js",
        "bundle": true,
        "update": "delta"
    }
], 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T23:54:50.140

包含`cordova.js`在 app.json 中导致了直接的问题。但更大的问题似乎是 Sencha Touch 的生产版本不包含外部库，以使应用程序可以访问它们。尽管我之前认为我在打包和测试构建时遇到了问题，但此时我发现只有生产构建会中断，并且只有在包含外部库时（在我的情况下，`cordova.js`）。

# python - pyqt - 如何从我的文本编辑中更改单词的颜色

> ID：14691614
> 
> 赞同：2
> 
> 时间：2013-02-04T17:02:35.800
> 
> 标签：python, pyqt, textedit

这是一种从我的 textedit 中复制一个单词并将其设置为我的 tableview 的新行的方法。我需要的是：如何更改我在文本编辑中选择的单词的颜色？我的文本编辑的名称是“编辑器”，当我复制单词时，我需要更改该单词的颜色，但我不知道该怎么做。请帮忙 ：）。请举个例子~~

```
 def addLineTable(self):

    row = self.model.rowCount()   #create a line into my tableview
    self.model.insertRows(row)
    column = 0
    index = self.model.index(row, column)        
    tableView = self.TABLE            
    tableView.setFocus()
    tableView.setCurrentIndex(index)
    cursor = self.editor.textCursor()
    textSelected = cursor.selectedText()  #set text to cursor
    self.model.setData(index, QVariant(textSelected)) #set text to new tableview line 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T18:34:08.137

如果我正确理解您的问题，您只想更改文本的颜色，对吗？您可以通过[在此处](http://doc.qt.digia.com/4.2/stylesheet.html)为您的文档分配`StyleSheets`css 来做到这一点。`QWidgets`

下面的示例：

```
from PyQt4 import QtGui, QtCore

class Window(QtGui.QDialog):
    def __init__(self):
        QtGui.QDialog.__init__(self)
        self._offset = 200
        self._closed = False
        self._maxwidth = self.maximumWidth()
        self.widget = QtGui.QWidget(self)
        self.listbox = QtGui.QListWidget(self.widget)
        self.editor = QtGui.QTextEdit(self)
        self.editor.setStyleSheet("QTextEdit {color:red}")
        layout = QtGui.QHBoxLayout(self)
        layout.addWidget(self.widget)
        layout.addWidget(self.editor)

if __name__ == '__main__':

    import sys
    app = QtGui.QApplication(sys.argv)
    window = Window()
    window.move(500, 300)
    window.show()
    sys.exit(app.exec_()) 
```

# 编辑

或者你可以 setStyleSheet 到你所有的`QTextEdit`，试试这个：

```
......

app = QtGui.QApplication(sys.argv)
app.setStyleSheet("QTextEdit {color:red}")
...... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T22:09:47.323

你已经得到了`QTextCursor`. 您需要做的就是将格式 ( [`QTextCharFormat`](http://qt-project.org/doc/qt-4.8/qtextcharformat.html)) 应用于此光标，所选文本将被相应地格式化：

```
def addLineTable(self):

    row = self.model.rowCount()   #create a line into my tableview
    self.model.insertRows(row)
    column = 0
    index = self.model.index(row, column)        
    tableView = self.TABLE            
    tableView.setFocus()
    tableView.setCurrentIndex(index)
    cursor = self.editor.textCursor()

    # get the current format
    format = cursor.charFormat()
    # modify it
    format.setBackground(QtCore.Qt.red)
    format.setForeground(QtCore.Qt.blue)
    # apply it
    cursor.setCharFormat(format)

    textSelected = cursor.selectedText()  #set text to cursor
    self.model.setData(index, QVariant(textSelected)) #set text to new tableview line 
```

# php - 按经过时间计算价格 php mssql 服务器

> ID：14691615
> 
> 赞同：1
> 
> 时间：2013-02-04T17:02:35.857
> 
> 标签：php, sql-server-2008

我有一个停车系统，我尝试制作一个 php 脚本来计算价格，而不是打印到 POS 打印机。

我从 mssql 得到了插入的时间，例如：2013-01-04 12:49:49

我想计算经过时间`timenow();`

比在几分钟内设置的值：

```
if 30 = 0;
if 60 = 1;
if 120 = 2,50 
```

......和和:-)

是否可以？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:07:23.297

请尝试使用[`DATEDIFF`](http://www.w3schools.com/sql/func_datediff.asp)：

```
 SELECT CASE `X.ElapsedTime` 
               WHEN  MOD 30 = 0 THEN 0
               WHEN MOD 60 = 0 THEN 1 
               WHEN MOD 120 = 0 THEN 2 
               ELSE Null END AS `ElapsedCount` 
   FROM (SELECT  DATEDIFF(mi, startime, GetDate()) AS `ElapsedTime`
   FROM yourtable) X; 
```

另一种方法是（如果你需要，你可以四舍五入）：

```
 SELECT (`X.ElapsedTime`/60 + '.' + `X.ElapsedTime` MOD 60) as `ElapsedCount`
   FROM (SELECT  DATEDIFF(mi, startime, GetDate()) AS `ElapsedTime`
   FROM yourtable) X; 
```

或使用`hh`：

```
 SELECT  DATEDIFF(hh, startime, GetDate()) AS `ElapsedCount`
   FROM yourtable; 
```

* * *

## 在评论中编辑 OP 的查询以使用 JOIN

```
SELECT top 1 dbo.Partners.IdPartner AS pid, 
dbo.Partners.PartnerName AS name, dbo.Partners.MemberNumber AS nr, 
dbo.T_PAID_KARTE.MAGNETNA_COD, dbo.T_PAID_KARTE.ACTIVE AS active, 
dbo.T_PAID_KARTE.TYP AS cardnime, dbo.T_PAID_KARTE.ID_PAIDBY, 
dbo.T_LOGG.EXIT AS exittime, DATEDIFF(mi, exittime, GetDate()) AS ElapsedCount, 
dbo.T_LOGG.ID_PARTNER 
FROM dbo.Partners
INNER JOIN dbo.T_PAID_KARTE
ON 
INNER JOIN dbo.T_LOGG
ON 
; 
```

# reporting-services - 具有 500 多个值的 SSRS 报告参数

> ID：14691616
> 
> 赞同：2
> 
> 时间：2013-02-04T17:02:42.110
> 
> 标签：reporting-services, parameters, reportbuilder

我在 SSRS 报告中的参数之一称为客户。用户希望能够从下拉列表中选择多个客户。我们的客户名单超过 500 多个条目。如何在下拉列表中获得这么多值。就此而言，一个参数将处理多少个值？有没有办法将下拉列表设置为能够输入提示值？最后一个问题的一个例子就像在大多数要求您居住的州的表格上，您可以单击列表并键入“TX”，它会向下移动到德克萨斯州，而不必向下滚动。我希望这是有道理的。提前感谢您的所有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:20:29.447

您不能让参数的字段与自动完成文本一起使用。我同意在小字段中有 500 个值对用户不友好。

我的建议是将参数拆分为 2-4 个不同的参数（为了使客户搜索更容易），每个参数将根据 ABC 具有客户名称（例如第一个参数将包含来自 AI 的客户名称，第二个JR，最后一个SZ）

如果是这样，您的查询应如下所示：

```
SELECT customerName,customerAddress,customerCity,...
FROM customerTable
WHERE (customerID IN (@customerParam1) OR customerID IN (@customerParam2) customerID IN (@customerParam3)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T02:56:05.793

我不知道如何通过输入值来完成第二部分，但我可以帮助设置下拉列表。首先编写一个查询，为客户选择客户名称和唯一值。

例子：

```
SELECT CUSTOMER_NAME, CUSTOMER_ID
FROM CUSTOMER_TABLE 
```

然后添加参数并选择您的数据类型和“允许多个值”复选框。然后在属性中单击“可用值”选项卡。打开后，选择“从查询中获取值”并选择您刚刚编写的查询。选择后，转到“值”字段并从您的查询中选择唯一值，并为“标签”字段选择客户名称，它们都应该显示出来。

在主查询中使用参数值时，您需要确保使用 IN 函数而不是 =。这是因为您不会只获得一个价值，而是一次获得所有价值。

例子：

```
SELECT CUSTOMER_NAME,CUSTOMER_ADDRESS,CUSTOMER_CITY,...
FROM CUSTOMER_TABLE
WHERE CUSTOMER_ID IN (@CUSTOMERNAMEPARAMETER) 
```

参数的名称是您需要使用的变量名称。

另外一个提示，您可以通过转到默认值并选择“从查询中获取值”并再次选择您的查询和唯一值来将它们全部默认选中。

此外，我认为列表框上的项目数量限制没有问题。我已经达到了将近 1,000 并且没有任何问题。

# eclipse - 使用 Eclipse 开发 CloudFoundry 应用程序时，允许哪些项目类型？

> ID：14691618
> 
> 赞同：2
> 
> 时间：2013-02-04T17:02:56.883
> 
> 标签：eclipse, cloud-foundry

我可以要求澄清一下哪些类型的项目可以成功部署到 vcap_dev 吗？我想要部署的是一个包含 java 和 javascript 的动态 Web 项目，但这似乎是不允许的。是否可以在已部署的应用程序中包含 javascript/html/css 工件？如果是这样，我应该使用什么项目类型？

谢谢，约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T15:34:08.087

您可以使用[vmc 命令行工具](http://docs.cloudfoundry.com/tools/vmc/vmc-quick-ref.html)查看您的 vcap_dev 设置支持哪些运行时和框架。根据`vmc`您安装的版本，命令会略有不同：

*   使用`vmc runtimes`或`vmc info --runtimes`查看支持哪些运行时
*   使用`vmc frameworks`或`vmc info --frameworks` 查看支持哪些框架

此问题也已发布到[vcap Google 组](https://groups.google.com/a/cloudfoundry.org/d/topic/vcap-dev/uRqV36XGTfc/discussion)，有关更多详细信息，请参阅该线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:44:50.583

您可以通过为 SpringSource 工具套件 (STS) 和 Eclipse ( [http://docs.cloudfoundry.com/tools/STS/configuring-STS.html](http://docs.cloudfoundry.com/tools/STS/configuring-STS.html) ) 安装 Cloud Foundry 集成扩展来使用 spring 框架。然后你可以添加 javascript/css/html 文件作为资源。

让我知道这是否回答了您的问题。

谢谢，

希特什

# vim - 如何使波浪号运算符在 Vim 中将 '==' 更改为 '!='？

> ID：14691620
> 
> 赞同：4
> 
> 时间：2013-02-04T17:03:01.173
> 
> 标签：vim

我希望普通模式命令 tilde `~`除了更改字母的大小写之外，还能够将文本 更改 `==`为 `!=`和 。`!=``==`

我发现我经常这样做，我想要一个仍然使用波浪号的快捷方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T17:03:01.173

这在 vimscript 中相当简单。从不同的文件将以下内容添加到您的`.vimrc`或`source`此代码中。

```
" ----------------------
"  Tilde switches ==/!=
" ----------------------
function! TildeSwitch()
  " Gets the pair of characters under the cursor, before and behind.
  let cur_pair = getline(".")[col(".") - 2 : col(".") - 1]
  let next_pair = getline(".")[col(".") - 1 : col(".")]

  if cur_pair == "=="
    normal! "_ch!
    normal! l
  elseif next_pair == "=="
    normal! r!
  elseif cur_pair == "!="
    normal! "_ch=
    normal! l
  elseif next_pair == "!="
    normal! r=
  else
    " If == and != are not found, simply use the regular tilde.
    normal! ~
  endif
endfunction

nnoremap <silent> ~ :silent call TildeSwitch()<cr> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T20:15:25.950

让我提出这个扩展`~` 命令的替代实现：

```
nnoremap <silent> ~ :call SwitchNeq()<cr>~

function! SwitchNeq()
    let [s, c] = [@/, getpos('.')]
    s/[!=]\ze\%#=\|\%#[!=]\ze=/\='!='[submatch(0)=='!']/e
    let @/ = s
    call setpos('.', c)
endfunction 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T07:12:00.827

在两个选项（如`==`和`!=`）之间切换只是在多个选项之间切换的一种特殊情况。我建议不要重载二进制`~`命令，而是使用`<C-A>`/ `<C-X>`。SwapIt [- 可扩展的关键字交换插件](http://www.vim.org/scripts/script.php?script_id=2294)提供了这一点，并且实际上有一个默认选项来切换`==`, `!=`,`<=`等。

# c++ - 是否有可用于 c++ 的广泛使用的多处理抽象库？

> ID：14691621
> 
> 赞同：5
> 
> 时间：2013-02-04T17:03:02.530
> 
> 标签：c++, fork, multiprocessing

我来自 Python，全速进入 C++。而且，我最近提出的一个问题是：C++ 中是否有广泛使用的开源多处理抽象库？我正在考虑使多处理（ala [fork](http://en.wikibooks.org/wiki/C_Programming/POSIX_Reference/unistd.h/fork)）更易于管理的东西，**类似于 Python 的[多处理](http://docs.python.org/2/library/multiprocessing.html)stdlib 库**。

我想没有这样的东西。我完全期望会有一个**Boost::Process**就像有一个[Boost::Thread](http://www.boost.org/doc/libs/1_53_0/doc/html/thread.html)一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:09:54.850

[MPI](http://www.open-mpi.org/)适合吗？我认为一旦你理解了它就很容易编程。它是真正的多进程

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T17:10:58.477

OpenMP (Open *Multi-Processing* ) 是我所知道的唯一一个[http://en.wikipedia.org/wiki/OpenMP](http://en.wikipedia.org/wiki/OpenMP)库——但是它并没有像 Python 通过创建新进程来处理事情。OpenMP 是一个编译器扩展，由[Microsoft](http://msdn.microsoft.com/en-us/library/tt15eb9t%28v=vs.80%29.aspx)和[GNU GCC](http://gcc.gnu.org/wiki/openmp)支持。

示例：[埃拉托色尼的 OpenMP 筛](http://create.stephan-brumme.com/eratosthenes/)

```
// odd-only sieve
int eratosthenesOdd(int lastNumber, bool useOpenMP)
{
  // enable/disable OpenMP
  omp_set_num_threads(useOpenMP ? omp_get_num_procs() : 1);
  // instead of i*i <= lastNumber we write i <= lastNumberSquareRoot to help OpenMP
  const int lastNumberSqrt = (int)sqrt((double)lastNumber);
  int memorySize = (lastNumber-1)/2;
  // initialize
  char* isPrime = new char[memorySize+1];
  #pragma omp parallel for
  for (int i = 0; i <= memorySize; i++)
    isPrime[i] = 1;
  // find all odd non-primes
  #pragma omp parallel for schedule(dynamic)
  for (int i = 3; i <= lastNumberSqrt; i += 2)
    if (isPrime[i/2])
      for (int j = i*i; j <= lastNumber; j += 2*i)
        isPrime[j/2] = 0;
  // sieve is complete, count primes
  int found = lastNumber >= 2 ? 1 : 0;
  #pragma omp parallel for reduction(+:found)
  for (int i = 1; i <= memorySize; i++)
    found += isPrime[i];
  delete[] isPrime;
  return found;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:09:22.167

[Intel TBB](http://threadingbuildingblocks.org/)和[Microsoft PPL](http://msdn.microsoft.com/en-us/library/dd492418.aspx)是两个基于任务的多线程库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-14T13:58:28.100

我正在寻找[POCO](http://pocoproject.org/slides/150-Processes.pdf)库，其中有一个关于多处理的部分。
我也在考虑[fork()](https://stackoverflow.com/questions/4243880/substitute-for-forking-in-windows?lq=1)，它也有一些 Windows 实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-23T08:28:09.500

看看[http://pocoproject.org/](http://pocoproject.org/) (Process::launch()) 和[http://www.highscore.de/boost/process/](http://www.highscore.de/boost/process/)。如果必须选择，我会选择第二个，但实际上它们都与 Python 提供的便利相去甚远（叹息）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-20T23:40:16.213

现在有对多处理的 Boost 支持：[https ://www.boost.org/doc/libs/1_76_0/doc/html/boost_process/tutorial.html](https://www.boost.org/doc/libs/1_76_0/doc/html/boost_process/tutorial.html)

从我的编译器（LLVM/clang）返回的一些消息来看，它看起来像是`boost::process`POSIX 的包装器`fork`（以及 Windows 的相应包装器），就像 POCO 库一样。

# jquery - 当表单域处于活动状态时使 div 出现

> ID：14691628
> 
> 赞同：1
> 
> 时间：2013-02-04T17:03:14.553
> 
> 标签：jquery, css, focus, blur

我需要创建一个 div，当表单域处于活动状态时显示包含提示，当表单域不再处于活动状态时消失。我的表单字段都有 ID，例如 #monthly_rent，我的小费有一个 .monthly_rent_tip 类。我怎样才能使它在必要时出现和消失。

这是我目前拥有但不起作用的代码。

```
<script type="text/javascript">
jQuery(document).ready(function()
   {
        jQuery('.tip.left.monthly_rent_tip').hide(); //hide 
        jQuery('#monthly_rent').focus(function(){  
            jQuery('.tip.left.monthly_rent_tip').show(); //show
        }).blur(function(){  
            jQuery('.tip.left.monthly_rent_tip').hide(); //hide again
        });

  });
</script> 
```

提示 div 的 CSS 在这里：

```
.tip {
position:relative;
padding:15px;
margin:1em 0 3em;
border:5px solid #f18500;
background:#fff;
/* css3 */
-webkit-border-radius:10px;
-moz-border-radius:10px;
border-radius:10px;
}

.monthly_rent_tip {
top:1060px;
left:-130px;
} 
```

目前这没有任何作用，任何人都可以指出我正在犯的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:05:41.977

查看此示例以了解您的问题

[http://jquerytools.org/demos/tooltip/form.html](http://jquerytools.org/demos/tooltip/form.html)

这是同一主题的stackoverflow问题

[JQuery 表单工具提示](https://stackoverflow.com/questions/1874067/jquery-form-tooltip)

# msmq - 群集 MSMQ 问题

> ID：14691636
> 
> 赞同：0
> 
> 时间：2013-02-04T17:03:48.677
> 
> 标签：msmq

我在群集环境中遇到 MSMQ 问题。我有以下设置：

在 Windows 故障转移中设置了 2 个节点，我们将它们称为“节点 A”和“节点 B”。

然后我设置了一个 MSMQ 的集群实例，我们称之为“MSMQ 实例”。

我还设置了 DTC 的集群实例，我们称之为“DTC 实例”。

在 DTC 实例中，我允许在本地和通过集群实例进行访问，基本上我已取消所有身份验证以进行测试。

我还创建了我们内部应用程序的集群实例，我们称之为“应用程序实例”。在此应用程序实例中，我添加了其他资源，这些资源是应用程序使用的其他服务以及 Net.MSMQ 适配器。

问题.......

当我似乎对应用程序实例进行集群时，它似乎总是将所有者设置为我正在使用的相反节点，所以如果我在节点 A 上创建集群实例，它总是将当前所有者设置为节点 B，但是那是不是问题。

我遇到的问题是，只要应用程序实例在节点 B 上运行，MSMQ 似乎就可以工作。

出站队列在本地创建，接收消息，然后通过 MSMQ 群集进行处理。

如果我随后故障转移到节点 A，MSMQ 将拒绝工作。未创建出站队列，因此未处理任何消息。

我在事件查看器中收到错误：

“版本检查失败并出现错误：'无法识别的错误 -1072824309 (0xc00e000b)'。无法检测到 MSMQ 的版本所有排队通道上的操作都将失败。确保 MSMQ 已安装并且可用”

如果我然后故障转移回节点 B，它就可以工作。

应用程序已设置为使用 MSMQ 实例，并且所有权限均正确。

我是否需要拥有 DTC 的集群实例，或者我可以将其配置为 MSMQ 实例中的资源吗？

任何人都可以对此有所了解，因为我在这堵砖墙上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T12:59:25.343

是的，您需要进行集群 DTC 设置。

对于您的集群 MSMQ 实例，您需要将集群 DTC 配置为“ `dependendy`”右键单击`MSMQ -> Properties -> Dependencies`

我不知道这是否在所有情况下都是强制性的，但在我们的集群上，我们还有一个文件共享配置为 MSMQ 的依赖项。据我了解，这应该确保 MSMQ 所需的临时文件在节点切换后仍然可用。

此外，我发现这里有两篇文章对设置集群节点很有帮助。它们可能有助于逐步确认您的配置是否正确：

*   “[构建 MSMQ 集群](http://blogs.msdn.com/b/mismail/archive/2007/04/18/building-an-msmq-cluster.aspx)”。您会在该文章中找到其他几个链接，这些链接将进一步指导您。
*   微软也有一份详细的文档：《[Deploying Message Queuing (MSMQ) 3.0 in a Server Cluster](http://www.microsoft.com/downloads/details.aspx?FamilyID=349D6584-9510-46F5-904E-2C58FA16EB85&displaylang=en&displaylang=en)》。

# java - 接口类型的 Java 变量

> ID：14691647
> 
> 赞同：1
> 
> 时间：2013-02-04T17:04:35.633
> 
> 标签：java, interface

我知道分配给类型为接口的引用变量的对象可能是实现接口的类的实例。但是对于以下代码块：

```
public interface foo {
    public abstract void method_1();
}

class bar implements foo {  
    @Overide
    public void method_1() { //Implementation... }

    public void method_2() { //Do some thing... } 
}
.....

foo variable = new bar();
variable.method_1(); // OK;
variable.method_2(); // Is it legal? 
```

是否可以使*变量*（其声明类型为 foo 但实际类型为 bar）调用未在接口中声明的 *方法*_2 ？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:05:56.990

`variable.method_2()`不会按`variable`类型编译`foo`。`foo`没有方法`method_2()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T17:06:11.797

是的，您可以投射：

```
((bar)variable).method_2(); 
```

但你可能不应该。接口的全部意义在于只使用它提供的方法。如果它们还不够，请不要使用该界面。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-04T17:06:13.030

不它不是。如果你想访问`method_2`，你必须声明的类型`variable`是`bar`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-04T17:07:26.580

`Is it possible to make the variable (whose declared type is foo but actual type is bar) call the method_2 which is not declared in the interface ?`

不是它不可能。这将是一个编译时错误。

您的代码中还有其他标准偏差

1.  接口和类名应该大写驼峰式（这是 UpperCamelCase）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-04T17:08:00.060

不，这是不合法的。但是，您可以在运行时检查类型并转换为正确的类型：

```
if (variable instanceof bar) ((bar)variable).method_2(); 
```

（严格来说，`instanceof`如果您确定类型正确，则可以在不检查的情况下进行强制转换，或者如果您错了，很乐意抛出异常。）

# django - 尝试将数据添加到数据库时出错

> ID：14691653
> 
> 赞同：2
> 
> 时间：2013-02-04T17:04:49.513
> 
> 标签：django, visual-studio, python-2.7

尝试使用 Python Tool for Visual Studio 运行 shell 命令时收到以下错误。我已将数据库添加到设置文件中，并且能够运行 django 应用程序而没有错误，但是当我尝试使用 shell 添加数据时，它会抛出此错误：

```
>>> from ProjectTrackerServer.projects.models import Project
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "C:\djangoapps\ProjectTrackerServer\ProjectTrackerServer\projects\models.py", line 1, in <module>
    from django.db import models
  File "C:\Python27\lib\site-packages\django\db\__init__.py", line 11, in <module>
    if DEFAULT_DB_ALIAS not in settings.DATABASES:
  File "C:\Python27\lib\site-packages\django\utils\functional.py", line 184, in inner
    self._setup()
  File "C:\Python27\lib\site-packages\django\conf\__init__.py", line 40, in _setup
    raise ImportError("Settings cannot be imported, because environment variable %s is undefined." % ENVIRONMENT_VARIABLE)
ImportError: Settings cannot be imported, because environment variable DJANGO_SETTINGS_MODULE is undefined. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:09:48.297

该错误说明了问题。这是因为您忘记提供项目设置 DJANGO_SETTINGS_MODULE。您可以通过提供它来修复它。您需要设置 DJANGO_SETTINGS_MODULE 环境变量。

```
When you use Django, you have to tell it which settings
you're using. Do this by using an environment variable, 
DJANGO_SETTINGS_MODULE.

The value of DJANGO_SETTINGS_MODULE should be in 
Python path syntax, e.g. mysite.settings. Note 
that the settings module should be on the 
Python import search path. 
```

[https://docs.djangoproject.com/en/dev/topics/settings/](https://docs.djangoproject.com/en/dev/topics/settings/)

# javascript - 通过 Javascript 将 cookie 设置为 HttpOnly

> ID：14691654
> 
> 赞同：118
> 
> 时间：2013-02-04T17:04:50.330
> 
> 标签：javascript, http, cookies

我有一个不是的 cookie我可以通过 JavaScript`HttpOnly`设置这个 cookie吗？`HttpOnly`

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2013-02-04T17:08:08.147

`HttpOnly`cookie 意味着它**不适**用于 JavaScript 等脚本语言。所以在 JavaScript 中，绝对没有 API 可用于获取/设置`HttpOnly`cookie 的属性，否则会破坏`HttpOnly`.

只需使用服务器端使用的任何服务器端语言在服务器端设置它。如果 JavaScript 是绝对必要的，你可以考虑让它发送一些（ajax）请求，例如一些特定的请求参数，触发服务器端语言创建一个 HttpOnly cookie。但是，这仍然会让黑客很容易`HttpOnly`通过 XSS 来更改它，并且仍然可以通过 JS 访问 cookie，从而使`HttpOnly`你的 cookie 完全无用。

# actionscript-3 - TimerEvent 函数忽略定时器延迟

> ID：14691655
> 
> 赞同：0
> 
> 时间：2013-02-04T17:04:51.890
> 
> 标签：actionscript-3, events, air, timer, flash-cs6

我在 AS3、Flash AIR 3.2 for iOS SDK 中工作。我仅在`myLoader`完成加载图像后才尝试运行部分程序。我有一个`myTimer.start();`在里面运行`myLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onLoaderComplete);`。

目前的问题似乎是程序忽略了 1000 毫秒。该程序在完成后*正在*运行`myLoader`，但就延迟而言，它似乎只是在做自己的事情。

编辑：在这里更精确......该程序似乎忽略了定时器延迟。即使 Timer 设置为 100000ms。加载图像后，它似乎正在运行程序的其余部分。

编辑：我的方法仍然在我的 Main() 以及代码中的 timerListener() 中运行。以为我评论了他们。哎呀！

```
var myTimer:Timer = new Timer(1000);

public function Main()
    {
        init();
        displayImage();

        myTimer.addEventListener(TimerEvent.TIMER, timerListener);
        myTimer.addEventListener(TimerEvent.TIMER_COMPLETE, timerDone);

    }

public function displayImage():void {

        myLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onLoaderComplete);

        myLoader.load(fileRequest);
    }

public function onLoaderComplete(e:Event) {
        //start Timer event here
        myTimer.start();
    }

public function timerListener (e:TimerEvent):void{
        trace("Timer is Triggered");
        myTimer.stop();

        aMethod();
        anotherMethod();
        moreMethods();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T23:16:41.800

您并没有真正阐明“计时器正在做自己的事情”的意思。计时器比您预期的短还是长？

我认为这里可能发生的是您的计时器滴答声和帧速率不同步。如果您熟悉[elastic racetrack](http://www.craftymind.com/2008/04/18/updated-elastic-racetrack-for-flash-9-and-avm2/)的概念，您就会知道 Flash 的单线程特性（除非您使用工作线程）意味着屏幕无法在脚本期间更新，反之亦然。这意味着如果您的计时器在显示列表更新时触发，它只需要等到显示列表完成，甚至可能必须等到其他脚本运行，这取决于 Flash 如何对其队列中的不同事物进行优先级排序。

从[计时器 API](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/Timer.html)：

> 根据 SWF 文件的帧速率或运行时环境（可用内存和其他因素），运行时可能会以稍微偏移的间隔调度事件。例如，如果 SWF 文件设置为以每秒 10 帧 (fps) 的速度播放，即 100 毫秒的间隔，但您的计时器设置为以 80 毫秒的间隔触发事件，则该事件将在接近 100 毫秒的间隔时调度. 内存密集型脚本也可能抵消事件。

# c++ - Direct2D 教程窗口不显示

> ID：14691656
> 
> 赞同：0
> 
> 时间：2013-02-04T17:04:54.410
> 
> 标签：c++, windows, direct2d

我正在尝试使用 MSDN 的 Direct2D 基础教程，但窗口不会显示，它输出的是正常的调试信息，但没有窗口。我尝试过使用 WinMain() 参数和 ShowWindow() 函数，但它仍然拒绝工作。在调试信息中也有这个，但我认为它不相关。\NVIDIA Corporation\coprocmanager\nvdxgiwrap.dll'。无法找到或打开 PDB 文件。

这是代码。

```
#include "RenderHeader.h"

//Main window function.
int WINAPI WinMain(
HINSTANCE /* hInstance */,
HINSTANCE /* hPrevInstance */,
LPSTR /* lpCmdLine */,
int /* nCmdShow */)
{
    // Use HeapSetInformation to specify that the process should
    // terminate if the heap manager detects an error in any heap used
    // by the process.
    // The return value is ignored, because we want to continue running in the
    // unlikely event that HeapSetInformation fails.

    HeapSetInformation(NULL, HeapEnableTerminationOnCorruption, NULL, 0);

    if (SUCCEEDED(CoInitialize(NULL)))
    {
        {
        GameRender app;

        if (SUCCEEDED(app.Initialize()))
        {
            //Runs the application message loop.
        app.RunMessageLoop();
        }
        }
        CoUninitialize();
    }
    return 0;
}

GameRender::GameRender() :
    m_hwnd(NULL),
    m_pDirect2DFactory(NULL),
    m_pRenderTarget(NULL),
    m_pLightSlateGrayBrush(NULL),
    m_pCornflowerBlueBrush(NULL)
{
}

GameRender::~GameRender()
{
    SafeRelease(&m_pDirect2DFactory);
    SafeRelease(&m_pRenderTarget);
    SafeRelease(&m_pLightSlateGrayBrush);
    SafeRelease(&m_pCornflowerBlueBrush);
}

HRESULT GameRender::Initialize()
{
    HRESULT hRes;

    /* Initialize device-indpendent resources, such
     as the Direct2D factory.*/
    hRes = CreateDeviceIndependantResources();

    if (SUCCEEDED(hRes))
    {
        WNDCLASSEX Window = { sizeof(WNDCLASSEX) } ;
        Window.style = CS_HREDRAW | CS_VREDRAW;
        Window.lpfnWndProc = GameRender::WndProc;
        Window.cbClsExtra = 0;
        Window.cbWndExtra = sizeof(LONG_PTR);
        Window.hInstance = HINST_THISCOMPONENT;
        Window.hbrBackground = NULL;
        Window.lpszMenuName = NULL;
        Window.hCursor = LoadCursor(NULL, IDI_APPLICATION);
        Window.lpszClassName = L"D2DDemoApp";

        RegisterClassEx(&Window);

        /* Because the CreateWindow function takes its size in pixels,
         obtain the system DPI and use it to scale the window size.*/
        FLOAT DpiX, DpiY;

        /* The factory returns the current system DPI. This is also the value it will use
         to create its own windows.*/
        m_pDirect2DFactory->GetDesktopDpi(&DpiX, &DpiY);

        //Create Window
        m_hwnd = CreateWindow(L"D2PDemoApp", 
            L"Direct 2D Demo App", 
            WS_OVERLAPPEDWINDOW,
            CW_USEDEFAULT, 
            CW_USEDEFAULT,
            static_cast<UINT>(ceil(640.f * DpiX / 96.f)),
            static_cast<UINT>(ceil(480.f * DpiY / 96.f)),
            NULL, 
            NULL,
            HINST_THISCOMPONENT, 
            this);

        hRes = m_hwnd ? S_OK : E_FAIL;
        if (SUCCEEDED(hRes))
        {
        ShowWindow(m_hwnd, SW_SHOWNORMAL);
        UpdateWindow(m_hwnd);
        }
    }
    return hRes;
}

HRESULT GameRender::CreateDeviceIndependantResources()
{
HRESULT hr = S_OK;

    //Create a direct2D Factory
hr = D2D1CreateFactory(D2D1_FACTORY_TYPE_SINGLE_THREADED, &m_pDirect2DFactory);
return hr;
}

HRESULT GameRender::CreateDeviceDependantResources()
{
    HRESULT hr = S_OK;
    if(!&m_pRenderTarget)
    {
RECT rc;
GetClientRect(m_hwnd, &rc);

D2D1_SIZE_U size = D2D1::SizeU(rc.right - rc.left, rc.bottom - rc.top);

//Create a render target.
hr = m_pDirect2DFactory->CreateHwndRenderTarget(D2D1::RenderTargetProperties(), D2D1::HwndRenderTargetProperties(m_hwnd, size), &m_pRenderTarget);
    if (SUCCEEDED(hr))
        {
            // Create a gray brush.
            hr = m_pRenderTarget->CreateSolidColorBrush(
                D2D1::ColorF(D2D1::ColorF::LightSlateGray),
                &m_pLightSlateGrayBrush);
        }
    if (SUCCEEDED(hr))
        {
            // Create a blue brush.
            hr = m_pRenderTarget->CreateSolidColorBrush(
                D2D1::ColorF(D2D1::ColorF::CornflowerBlue),
                &m_pCornflowerBlueBrush
                );
        }
    }
    return hr;
}

void GameRender::DiscardDeviceResources()
{
    SafeRelease(&m_pRenderTarget);
    SafeRelease(&m_pLightSlateGrayBrush);
    SafeRelease(&m_pCornflowerBlueBrush);
}
void GameRender::RunMessageLoop()
{
    MSG Message;
    while (GetMessage(&Message, NULL, 0, 0))
    {
        TranslateMessage(&Message);
        DispatchMessage(&Message);
    }
}
HRESULT GameRender::OnDraw()
{
    HRESULT hr = S_OK;

    hr = CreateDeviceDependantResources();

    if (SUCCEEDED(hr))
    {
        m_pRenderTarget->BeginDraw();

        m_pRenderTarget->SetTransform(D2D1::Matrix3x2F::Identity());

        m_pRenderTarget->Clear(D2D1::ColorF(D2D1::ColorF::White));

        D2D1_SIZE_F rtSize = m_pRenderTarget->GetSize();

        // Draw a grid background.
        int width = static_cast<int>(rtSize.width);
        int height = static_cast<int>(rtSize.height);

        for (int x = 0; x < width; x += 10)
        {
            m_pRenderTarget->DrawLine(
                D2D1::Point2F(static_cast<FLOAT>(x), 0.0f),
                D2D1::Point2F(static_cast<FLOAT>(x), rtSize.height),
                m_pLightSlateGrayBrush,
                0.5f
                );
        }

        for (int y = 0; y < height; y += 10)
        {
            m_pRenderTarget->DrawLine(
                D2D1::Point2F(0.0f, static_cast<FLOAT>(y)),
                D2D1::Point2F(rtSize.width, static_cast<FLOAT>(y)),
                m_pLightSlateGrayBrush,
                0.5f
                );
        }

        // Draw two rectangles.
        D2D1_RECT_F rectangle1 = D2D1::RectF(
            rtSize.width/2 - 50.0f,
            rtSize.height/2 - 50.0f,
            rtSize.width/2 + 50.0f,
            rtSize.height/2 + 50.0f
            );

        D2D1_RECT_F rectangle2 = D2D1::RectF(
            rtSize.width/2 - 100.0f,
            rtSize.height/2 - 100.0f,
            rtSize.width/2 + 100.0f,
            rtSize.height/2 + 100.0f
            );

        // Draw a filled rectangle.
        m_pRenderTarget->FillRectangle(&rectangle1, m_pLightSlateGrayBrush);

        // Draw the outline of a rectangle.
        m_pRenderTarget->DrawRectangle(&rectangle2, m_pCornflowerBlueBrush);

        hr = m_pRenderTarget->EndDraw();
    }

    if (hr == D2DERR_RECREATE_TARGET)
    {
        hr = S_OK;
        DiscardDeviceResources();
    }

    return hr;
}

void GameRender::OnResize(UINT width, UINT height)
{
    if (m_pRenderTarget)
    {
        // Note: This method can fail, but it's okay to ignore the
        // error here, because the error will be returned again
        // the next time EndDraw is called.
        m_pRenderTarget->Resize(D2D1::SizeU(width,
        height));
    }
}
LRESULT CALLBACK GameRender::WndProc(
HWND hwnd,
UINT message,
WPARAM wParam,
LPARAM lParam)
{
    LRESULT result = 0;

    if (message == WM_CREATE)
    {
        LPCREATESTRUCT pcs = (LPCREATESTRUCT)lParam;
        GameRender *pGameRender = (GameRender *)pcs->lpCreateParams;

        ::SetWindowLongPtrW(
            hwnd,
            GWLP_USERDATA,
            PtrToUlong(pGameRender)
            );

        result = 1;
    }
    else
    {
        GameRender *pGameRender = reinterpret_cast<GameRender *>(static_cast<LONG_PTR>(
            ::GetWindowLongPtrW(
                hwnd,
                GWLP_USERDATA
                )));

        bool wasHandled = false;

        if (pGameRender)
        {
            switch (message)
            {
            case WM_SIZE:
                {
                    UINT width = LOWORD(lParam);
                    UINT height = HIWORD(lParam);
                    pGameRender->OnResize(width, height);
                }
                result = 0;
                wasHandled = true;
                break;

            case WM_DISPLAYCHANGE:
                {
                    InvalidateRect(hwnd, NULL, FALSE);
                }
                result = 0;
                wasHandled = true;
                break;

            case WM_PAINT:
                {
                    pGameRender->OnDraw();
                    ValidateRect(hwnd, NULL);
                }
                result = 0;
                wasHandled = true;
                break;

            case WM_DESTROY:
                {
                    PostQuitMessage(0);
                }
                result = 1;
                wasHandled = true;
                break;
            }
        }

        if (!wasHandled)
        {
            result = DefWindowProc(hwnd, message, wParam, lParam);
        }
    }

    return result;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T09:02:06.290

假设“RenderHeader.h”存在于您的项目目录中并且它包含 Windows 标头，那么您的问题是您没有向 WinMain 传递它需要运行的变量。'HINSTANCE', 'LPSTR' 和 'int' 都是变量类型，但是你需要给它们一个名字，否则它们不存在，函数将不起作用。所以这是对的

```
int WINAPI WinMain( HINSTANCE hInstance,
                    HINSTANCE hPrevInstance,
                    LPSTR     lpCmdLine,
                    int       uCmdShow )
{
    // The rest of the code
} 
```

变量的名称已在您的问题中的代码中注释掉：P

# excel - 如何以与 Excel 中的加权平均值类似的方式计算偏度和峰度？

> ID：14691658
> 
> 赞同：1
> 
> 时间：2013-02-04T17:05:10.877
> 
> 标签：excel, statistics, skew, kurtosis

我想计算一些关于下表信息的描述性统计数据。我想描述的主要内容是价格组件。

```
价格 数量
  493 5
 4500 8
 2107 14
  269 1

```

加权平均值是直截了当的`=sumproduct(Price,Qty)/sum(Qty)`。但是，当我想计算`=skew()`and时，它变得更具挑战性`=kurt()`。在理想情况下，我将拥有未聚合的数据，但不幸的是，我只有聚合数据。

有人对如何使用上述数据在 Excel 中获得偏度和峰度有一个聪明的想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:28:36.993

有两种方法可以做到这一点，但我认为您不会喜欢这个答案，因为 Excel 函数不适用于聚合数据。

第一种方法是展开数据。

```
Price
493
493
493
493
493
4500
4500 (x 7 more times, one per row)
2107
2107 (x 13 more times, one per row)
269 
```

偏斜、峰度和标准差都适用于展开的数据。

这是另一种方式。

扩展您的示例：

```
Price Qty AggPrice
 493   5    2465
4500   8   36000
2107  14   29498
 269   1     269

AggPrSum   =sum(c2:c5)
mean       =sum(c2:c5)/sum(b2:b5) 
```

然后，您可以通过应用[方程](http://ncalculators.com/statistics/skewness-calculator.htm)来计算偏斜。当您计算平均值时，其余部分应该变得清晰。（您可以从添加一个新列 D 开始，即价格减去均值，差的立方。）

# android - 将字符串复制到 strings.xml

> ID：14691662
> 
> 赞同：0
> 
> 时间：2013-02-04T17:05:26.680
> 
> 标签：android, eclipse, string, locale

每个人都知道，如果我们有：

```
ekran3.setText("VAT Tax:"); 
```

我们可以（甚至我们应该）将其转换为：

```
ekran3.setText(getString(R.string.kwotaVat)); 
```

并添加strings.xml：

```
<string name="kwotaVat">VAT Tax:</string> 
```

但是有什么技巧可以自动完成吗？例如通过单击文本上的人民币并选择一些选项？很高兴知道它实际上会比我们手动执行它节省很多时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:15:06.277

如果您使用的是 Eclipse，您可以通过将鼠标放在字符串中并按 Ctrl + 1 将字符串直接提取到 strings.xml 文件中。它将弹出如下对话框，您可以选择“提取字符串”。然后你给它一个名字（例如：kwotaVat），你就完成了。

![图像](../Images/80023a4179a14e4fe7baf43838595c73.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:19:25.277

嘿，您不需要使用 getString() 将其转换为字符串值 xml 文件已经具有字符串形式的数据，因此您只需要使用以下代码来设置字符串

```
ekran3.setText(R.string.kwotaVat); 
```

其中 ekran3 是您的文本视图的对象，而 kwotaVat 是您的值字符串的 id

有关更多详细信息 od android 代码，请查看此处[http://grabcodes.blogspot.com/](http://grabcodes.blogspot.com/)

# javascript - 使用 javascript 正则表达式验证日期的问题

> ID：14691664
> 
> 赞同：-1
> 
> 时间：2013-02-04T17:05:36.820
> 
> 标签：javascript, regex, date, validation

我正在尝试使用 javascript 正则表达式来验证日期输入，但它返回的有效日期无效。我不是正则表达式专家，所以我不知道它有什么问题：

```
/^([0-9]d{2})+(\.|-|\/)+([0-9]d{2})+(\.|-|\/)+([0-9]d{4})+$/ 
```

我希望接受这些日期格式：

2001 年 4 月 23 日

23-04-2001

23.04.2001

最初我有这个，但它最后接受了其他字符的日期，如 23/04/2001jhsdgf：

```
/\d{2}(\.|-|\/)\d{2}(\.|-|\/)\d{4}/; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T17:06:32.617

拿你原来的正则表达式，然后从你的新正则表达式中添加`^`和。`$`问题解决了。

编辑：虽然，真的，这`(\.|-|\/)`是一团糟，应该是`[.\/-]`。

编辑2：也就是说，如果你制作第一个，`([.\/-])`那么你可以用它替换第二个`\1`，然后它需要两个分隔符相同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-04T19:08:42.727

您可以使用如下正则表达式检查日期在语法上是否正确：

```
/^(\d{1,2})([-\.\/])(\d{1,2})\2(\d{4})$/ 
```

*   `^`并`$`分别匹配字符串的开头和结尾
*   `\d{1,2}`匹配 1 位或 2 位数字
*   `\d{4}`完全匹配 4 位数字
*   `\2`匹配在第二个捕获组 ( `- . /`)中捕获的字符串

如果匹配，您可以使用匹配的日期、月份和年份来构建一个新日期，并将生成的日期、月份、年份与匹配的值进行比较。这是一个可以做到这一点的函数：

```
function checkDate(dateText) {
    var match = dateText.match(/^(\d{1,2})([-\.\/])(\d{1,2})\2(\d{4})$/);
    // "31.04.2012" -> ["31.04.2012", "31", ".", "04", "2012"]
    if (match === null) {
        return false;
    }
    var date = new Date(+match[4], +match[3] - 1, +match[1]);
    return date.getFullYear() == +match[4] && 
      date.getMonth() == +match[3] - 1 && 
      date.getDate() == +match[1];
}
checkDate("30.04.2013"); // true
checkDate("31-04-2013"); // false (April has 30 days) 
```

*   `+`用于将字符串转换为数字（`+"01"`变成`1`）
*   月份从 0 开始（0 = 一月，1 = 二月，...）
*   上面的例子假设日期是`dd-mm-yyyy`格式

[Date](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)对象尝试更正无效日期。尝试创建一个日期，例如`31-4-2013`yield `1-05-2013`，上面的函数将结果日期与输入参数进行比较以检查有效性。

# php - wamp 本地子域和 htaccess 重写规则

> ID：14691670
> 
> 赞同：1
> 
> 时间：2013-02-04T17:05:45.333
> 
> 标签：php, .htaccess, mod-rewrite, wamp, mod-vhost-alias

我最近用 php mvc 魔法修复了我的网站，为此我在 .htaccess 中使用了这些设置：

```
Options +FollowSymLinks
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-l
RewriteRule ^([a-zA-Z0-9]*)/?([a-zA-Z0-9]*)?/?([a-zA-Z0-9]*)?/?$ index.php?controller=$1&action=$2&arg=$3 [NC,L] 
```

它就像一个魅力。我遇到的唯一问题是，当我相对引用 css 或图像之类的文件时，由于 url localhost/projectname/controllername/action/id 中的破折号，浏览器假定我们向下移动了文件夹结构

因此，在 localhost/controllername/action/id/css/styles.css 请求了 css/styles.css，其绝对路径解决了该问题，但在有本地​​测试服务器和远程实时和开发服务器后无法正常工作没有“项目名称”- 文件夹

我决定配置我的本地 wamp 服务器，以便我可以将我的不同项目作为子域访问到我的本地主机，如“ [http://projectname.localhost](http://projectname.localhost) ”。

我激活了相关的 apache 模块，编辑了我的 hosts 文件并将我的 httpd-vhosts.conf 更改为

```
NameVirtualHost *:80
<VirtualHost *:80>
    ServerName localhost.com
    ServerAlias www.localhost.com
    DocumentRoot "C:\wamp\www"
    ErrorLog "logs\errors.log"
    <directory "C:\wamp\www">
        Options Indexes FollowSymLinks
        AllowOverride all
        Order Deny,Allow
        Deny from all
        Allow from all
    </directory>
</VirtualHost>

<VirtualHost *:80>
    ServerName localhost.com
    ServerAlias *.localhost.com
    VirtualDocumentRoot "C:\wamp\www\subdomains\%1"
    ErrorLog "logs\errors.log"
    <directory "C:\wamp\www\subdomains\%1">
        Options Indexes FollowSymLinks
        AllowOverride all
        Order Deny,Allow
        Deny from all
        Allow from all
    </directory>
</VirtualHost> 
```

现在，当我调用 projectname.localhost.com/controllername/action/id 时，它告诉我在此服务器上找不到请求的 URL /subdomains/projectname/index.php。虽然 projectname.localhost.com/index.php 仍然为我提供了正确的文件。

我听说 $_SERVER['DOCUMENT_ROOT']; 可能有问题。这没有正确设置，但知道这还没有帮助我解决这个问题。

有人可以指出我正确的方向或建议在这些情况下进行测试的另一种环境配置吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T07:22:22.453

将我的 .htaccess 更改为

```
Options +FollowSymLinks
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-l
RewriteRule ^([a-zA-Z0-9]*)/?([a-zA-Z0-9]*)?/?([a-zA-Z0-9]*)?/?$ index.php?controller=$1&action=$2&arg=$3 [NC,L] 
```

解决了那个问题。魔术线是`RewriteBase /`

似乎服务器真的在错误的地方寻找 index.php。

希望这可以帮助其他有同样问题的人...... :)

# javascript - Style.Transform for phonegap

> ID：14691673
> 
> 赞同：2
> 
> 时间：2013-02-04T17:06:00.063
> 
> 标签：javascript, css, cordova

我开始为有电话间隙的手机编程。我使用这条线在浏览器中缩放我的 iframe，document.getElementById("IFM").style.transform="scale(0.5,0.5)";

它适用于我的电脑浏览器，但它不适用于我的 android 应用程序！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:19:00.107

`webkitTransform`除了使用`transform`

```
document.getElementById("IFM").style.webkitTransform = "scale(0.5)"; 
```

# linux - 着色尾部输出

> ID：14691680
> 
> 赞同：29
> 
> 时间：2013-02-04T17:06:20.380
> 
> 标签：linux, bash, shell

我一直在努力让 tail 对于服务器初创公司更具可读性。我当前的命令从启动中过滤掉大部分 INFO 和 DEBUG 消息：

```
tail -F ../server/durango/log/server.log | grep -e "ERROR" -e "WARN" -e "Shutdown" -e "MicroKernel" | grep --color=auto -E 'MicroKernel|$' 
```

我想做的是制作一些东西，用黄色突出显示**WARN** ，用红色突出显示**ERROR ，用绿色突出显示****MicroKernel**。我尝试了多次管道**grep --color=auto**，但唯一幸存的颜色是管道中的最后一个命令。

有没有一个班轮可以做到这一点？甚至是多班轮？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-04T17:22:48.853

是的，有办法做到这一点。也就是说，只要您的终端支持**[ANSI 转义序列](http://en.wikipedia.org/wiki/ANSI_escape_code)**。这是存在的大多数终端。

我想我不需要解释如何 grep、sed 等。点颜色对吗？

见下文，这将使

```
WARN yellow
ERROR red
foo   green 
```

这是示例：

```
kent$ echo "WARN
ERROR
foo"|sed 's#WARN#\x1b[33m&#; s#ERROR#\x1b[31m&#; s#foo#\x1b[32m&#' 
```

**注意**:`\x1b`是*ESC*字符 ( `^V``Esc`) 的十六进制。

查看结果：

![在此处输入图像描述](../Images/598aeced8e7ab8937435da89ec4d973d.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-03-17T19:27:06.953

几年前我为此写[了一个脚本](https://github.com/goodell/highlight)。`highlight`您可以通过管道对彼此的连续调用轻松覆盖多种颜色的情况。

从自述文件：

```
Usage: ./highlight [-i] [--color=COLOR_STRING] [--] <PATTERN0> [PATTERN1...]

This is highlight version 1.0.

This program takes text via standard input and outputs it with the given
perlre(1) pattern(s) highlighted with the given color.  If no color option
is specified, it defaults to 'bold red'.  Colors may be anything
that Perl's Term::ANSIColor understands.  This program is similar to
"grep --color PATTERN" except both matching and non-matching lines are
printed.

The default color can be selected via the $HIGHLIGHT_COLOR environment
variable.  The command-line option takes precedence.

Passing -i or --ignore-case will enable case-insensitive matching.

If your pattern begins with a dash ('-'), you can pass a '--' argument
after any options and before your pattern to distinguish it from an
option. 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-01-18T06:24:23.397

多年来，我一直在使用一个名为 grc 的工具。奇迹般有效。它为许多标准日志输出和格式提供了一些非常好的模板，并且很容易定义您自己的模板。我经常使用的一个命令是

```
grc tail -f /var/log/syslog 
```

它将系统日志输出着色，因此很容易发现错误（通常标记为红色。

在这里找到工具：

[https://github.com/garabik/grc](https://github.com/garabik/grc)

（它也可以作为大多数常见 linux 风格的包提供）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T17:13:14.137

我使用了我破解的一个版本： [python log watcher](http://code.activestate.com/recipes/577968-log-watcher-tail-f-log/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-18T02:04:08.087

您可以创建彩色日志，而不是使用复杂的命令。

![在此处输入图像描述](../Images/f28a1045a38be751b49ee8a530c01d4e.png)

对于php是这样的：

```
echo "^[[30;43m".$ip."^[[0m"; 
```

**关键是**在vim的insert模式下使用Ctrl-v ctrl-[输入一个绿色的^[，直接输入^[是不行的。

![在此处输入图像描述](../Images/a192199a44c3f06115d709f8fa9d6de0.png)

[更多信息在这里](https://markbuild.com/how-to-have-tail-f-show-colored-output/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-18T16:49:42.403

我写了[TxtStyle](https://github.com/armandino/TxtStyle)，一个用于为日志着色的小实用程序。您定义正则表达式以在`~/.txts.conf`文件中突出显示：

```
[Style="example"]
!red: regex("error")
green: regex("\d{4}-\d\d-\d\d")
# ... 
```

然后应用样式：

```
txts -n example example.log 
```

或者你也可以通过管道输出

```
tail -f example.log | txts -n example 
```

[![在此处输入图像描述](../Images/8a0f4be4418b45a6b671f7aa03ca2400.png)](https://i.stack.imgur.com/cpUaS.png)

# iframe - iframe 中的嵌入视频冻结浏览器

> ID：14691686
> 
> 赞同：0
> 
> 时间：2013-02-04T17:06:35.400
> 
> 标签：iframe, razor

我以这种方式在我的视图中显示视频

```
<iframe frameborder="0" scrolling="no" src="http://myUrlHere" width="340" height="220">
</iframe> 
```

问题是当列表中有一些长视频时，我的浏览器会冻结一段时间。

我用 IE8 和 firefox 试过这个，都给出了相同的结果。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T13:33:35.823

这可能很奇怪，但我通过更改 iframe 的宽度解决了这个问题，现在它工作得很好

# wpf - WPF - 如何替换滚动条 ContextMenu

> ID：14691687
> 
> 赞同：3
> 
> 时间：2013-02-04T17:06:36.797
> 
> 标签：wpf, scrollbar, contextmenu

我正在尝试替换 ScrollBars 的 ContextMenu 并且我已经编写了以下代码：

```
<ContextMenu x:Key="ScrollBarContextMenu" x:Shared="True">
    <MenuItem Header="Scroll _Here" Name="SH" Command="ScrollBar.ScrollHereCommand" />
    <Separator/>
    <MenuItem Header="_Top" Name="T" Command="ScrollBar.ScrollToTopCommand" />
    <MenuItem Header="_Bottom" Name="B" Command="ScrollBar.ScrollToBottomCommand" />
    <Separator/>
    <MenuItem Header="Page _Up" Name="PU" Command="ScrollBar.PageUpCommand" />
    <MenuItem Header="Page _Down" Name="PD" Command="ScrollBar.PageDownCommand" />
    <Separator/>
    <MenuItem Header="Scroll U_p" Name="SU" Command="ScrollBar.LineUpCommand" />
    <MenuItem Header="Scroll Dow_n" Name="SD" Command="ScrollBar.LineDownCommand" />
</ContextMenu>

<Style x:Key="{x:Type ScrollBar}" TargetType="{x:Type ScrollBar}">
    <Setter Property="SnapsToDevicePixels" Value="True"/>
    <Setter Property="OverridesDefaultStyle" Value="true"/>
    <Setter Property="ContextMenu" Value="{DynamicResource ScrollBarContextMenu}"/>
    <Style.Triggers>
        <Trigger Property="Orientation" Value="Horizontal">
            <Setter Property="Width" Value="Auto"/>
            <Setter Property="Height" Value="18" />
            <Setter Property="Template" Value="{StaticResource HorizontalScrollBar}" />
        </Trigger>
        <Trigger Property="Orientation" Value="Vertical">
            <Setter Property="Width" Value="18"/>
            <Setter Property="Height" Value="Auto" />
            <Setter Property="Template" Value="{StaticResource VerticalScrollBar}" />
        </Trigger>
    </Style.Triggers>
</Style> 
```

ContextMenu 已设置，但它的行为很奇怪。最初它的所有菜单项都被禁用。当您滚动滚动条时，它们都会启用，除了永远禁用的 ScrollHere 命令。此外，当单击一个选项时，即“Page Up”选项，它仅在承载滚动条的控件获得焦点时才起作用（它不会自动获得焦点）。有谁知道如何解决这些问题？

**编辑：** 我的猜测是，也许默认的 ContextMenu 处理`Opening`事件并聚焦控件，加上它存储某处用鼠标单击的点的位置。但是我怎样才能把这个功能放在 XAML 文件中？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T21:18:18.060

好的。这是您的操作方法：

```
 <ContextMenu x:Key="VScrollBarContextMenu" x:Shared="true">
            <MenuItem Header="{DynamicResource ScrollHere}" Command="ScrollBar.ScrollHereCommand" CommandTarget="{Binding Path=PlacementTarget, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContextMenu}}}"/>
            <Separator/>
            <MenuItem Header="{DynamicResource ScrollTop}" Command="ScrollBar.ScrollToTopCommand" CommandTarget="{Binding Path=PlacementTarget, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContextMenu}}}" />
            <MenuItem Header="{DynamicResource ScrollBottom}" Command="ScrollBar.ScrollToBottomCommand" CommandTarget="{Binding Path=PlacementTarget, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContextMenu}}}" />
            <Separator/>
            <MenuItem Header="{DynamicResource ScrollPageUp}" Command="ScrollBar.PageUpCommand" CommandTarget="{Binding Path=PlacementTarget, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContextMenu}}}" />
            <MenuItem Header="{DynamicResource ScrollPageDown}" Command="ScrollBar.PageDownCommand" CommandTarget="{Binding Path=PlacementTarget, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContextMenu}}}" />
            <Separator/>
            <MenuItem Header="{DynamicResource ScrollUp}" Command="ScrollBar.LineUpCommand" CommandTarget="{Binding Path=PlacementTarget, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContextMenu}}}" />
            <MenuItem Header="{DynamicResource ScrollDown}" Command="ScrollBar.LineDownCommand" CommandTarget="{Binding Path=PlacementTarget, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContextMenu}}}" />
        </ContextMenu>

        <ContextMenu x:Key="HScrollBarContextMenu" x:Shared="true">
            <MenuItem Header="{DynamicResource ScrollHere}" Command="ScrollBar.ScrollHereCommand" CommandTarget="{Binding Path=PlacementTarget, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContextMenu}}}"/>
            <Separator/>
            <MenuItem Header="{DynamicResource ScrollLeftEnd}" Command="ScrollBar.ScrollToLeftEndCommand" CommandTarget="{Binding Path=PlacementTarget, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContextMenu}}}" />
            <MenuItem Header="{DynamicResource ScrollRightEnd}" Command="ScrollBar.ScrollToRightEndCommand" CommandTarget="{Binding Path=PlacementTarget, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContextMenu}}}" />
            <Separator/>
            <MenuItem Header="{DynamicResource ScrollPageLeft}" Command="ScrollBar.PageLeftCommand" CommandTarget="{Binding Path=PlacementTarget, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContextMenu}}}" />
            <MenuItem Header="{DynamicResource ScrollPageRight}" Command="ScrollBar.PageRightCommand" CommandTarget="{Binding Path=PlacementTarget, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContextMenu}}}" />
            <Separator/>
            <MenuItem Header="{DynamicResource ScrollLeft}" Command="ScrollBar.LineLeftCommand" CommandTarget="{Binding Path=PlacementTarget, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContextMenu}}}" />
            <MenuItem Header="{DynamicResource ScrollRight}" Command="ScrollBar.LineRightCommand" CommandTarget="{Binding Path=PlacementTarget, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContextMenu}}}" />
        </ContextMenu> 
```

我错过了命令目标...

# ms-access - 如何管理或转换超大型程序

> ID：14691688
> 
> 赞同：1
> 
> 时间：2013-02-04T17:06:39.110
> 
> 标签：ms-access

我有一个 Microsoft Access 业务关键数据库，它最初是在 90 年代创建的，此时已扩大并升级到 Access 2007。我们一直在使用这个数据库作为自定义编写的 ERP 系统的前端。很久以前，我们已经将大部分数据转移到 SQL 服务器，但我们仍然使用 MS Access 作为前端。随着项目的发展，我们有一个全职的开发人员，我们已经开始遇到稳定性问题和未知原因的极其频繁的崩溃。

例如：10 次左右，如果我更改 1 个特定字段中的数据，某个表单会崩溃。当时没有代码触发，数据在一个本地临时表中，大部分时间通常只有 5 行。如果我更改表中的数据没有任何问题，但如果我在表单上更改它，Access 将硬崩溃并将我转储到桌面。我还可以提供其他无法解释的崩溃示例

我正在寻找关于此时去哪里的建议——访问前端具有运行我们公司的所有业务逻辑，所以我不能放弃它。理想情况下，我们会用其他语言重写整个前端。问题是，作为一家小公司，我们没有足够的资源在一个好的时间框架内重新编写整个系统，也没有现金流来支付其他人的费用。我理想的解决方案是从访问前端到另一个端点的某种转换——无论是网络还是本地窗口——但我在这里和谷歌上的搜索看起来像是一个非首发。

所以基本上我看到的每条途径似乎都是死胡同：

*   我们找不到崩溃的根源来稳定我们当前的系统，

*   只要重新编写它，我们就不能停止我们当前系统的生产，

*   我们付不起钱请别人写一个新系统，

*   自动转换工具似乎在浪费钱

是否有其他选择，或者我认为哪个选项看起来最好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T21:24:39.230

我们有一个带有 Access 前端和 SQL Server 后端的企业级程序。我想知道将程序分成不同的部分进行诊断是否无济于事。例如，如果您有订单输入和库存管理，您可以为每个功能设置一个前端。 *（是的，我可以听到背景中的嚎叫声，但如果只是为了诊断，可能会有所帮助......）*
您还可以将 Access 数据库对象导出到文本文件，然后将它们导入到新的数据库中以获取在某些情况下摆脱奇怪的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T04:21:24.117

好吧，我想我会在这里重新表述基本问题。如果您有两名计算机科学专业的毕业生，那么他们早就应该预料到他们已经达到了 Access 的极限。我认为这与现在有太多顾客的餐馆里的过度劳累的烤箱或没有能力向顾客运送货物的送货卡车有什么不同。

由于不存在可重写的资金，因此您的员工未能按月拨出资金来处理这种情况，而现在由于延迟采取行动来处理这个日益严重的问题，您的选择使您陷入困境.

您的计算机科学人员早就应该看到这堵墙并限制您的到来。根据我的经验，大多数 CS 人员是否认为访问权限相当有限，因此这里应该敲响更多的警钟，这意味着你陷入这种不幸困境的借口更少。

因此，假设您拥有的计算科学人员很好地维护了这个应用程序（我欣然接受这种情况），那么合乎逻辑的结论是这个应用程序已经达到或超过了 Access 的限制。如前所述，这种限制早就应该预料到了。

正如您很好地指出的那样，现在不存在用于重写的资金，那么没有这样的资金就几乎没有选择。

但是，您的情况可能还不错，因为我们现在知道您的员工中有经验丰富的开发人员。鉴于这种情况，我的建议是考虑从应用程序中拆分出模块或小的可管理部分和功能，并让训练有素且经验丰富的开发人员构建 Web 界面，或者甚至使用 .net 之类的东西，如果你希望保持 100% 的桌面。所以这个机会“窗口”是考虑改变架构的好机会）

由于数据限制是 SQL server 而不是 Access，因此应用程序（现有的访问前端）和新部件都可以很好地轻松地对相同的数据进行操作。执行此操作时，您可以从 Access 应用程序中拆分并删除现有部分。这将建议您最终在 Access 应用程序中恢复到可接受的稳定性。此时，您可以继续，也可以停止以节省资金。

如前所述，如果没有资金重写，那么唯一的选择就是想办法每月释放一些有限的资源来解决这个问题。

归根结底，这个问题的解决方案是更多的资源，但是如果没有这些资源，那么这里就很少有技术选择和选择。根据迄今为止提供的信息，您已经明确表示您在这里没有资源。然而，这里解决这个问题需要资源分配和规划。

换句话说，在没有分配资源的情况下对这个问题进行技术修复对您来说不太可能是一个可用的选项。

对于无法在这里为您提供技术解决方案，我深表歉意，但这看起来是一个需要为问题分配资源的解决方案，并且这里不存在简单的捷径或技巧或灵丹妙药。

# c# - 在 C# 中初始化结构？

> ID：14691689
> 
> 赞同：3
> 
> 时间：2013-02-04T17:06:41.123
> 
> 标签：c#

我正在修改的一些代码广泛使用结构来与一些工厂设备进行通信，方法是将它们加载到字节数组或从字节数组加载。

这是这种结构的一个虚构的超简化示例。

```
[StructLayout(LayoutKind.Sequential, Pack = 1)]
public struct K_FOO
{
    public byte a_byte;    // 1 byte
    public BYTE3_TYPE b3;  // 3 bytes
    public int num;        // happens to be 4 bytes
} 
```

BYTE3_TYPE 看起来像这样......

```
[StructLayout(LayoutKind.Sequential, Pack = 1)]
public class BYTE3_TYPE
{
    [System.Runtime.InteropServices.MarshalAs(UnmanagedType.ByValArray, SizeConst = 3)]
    public byte[] L = new byte[3];
} 
```

如果我只是做一个

```
 K_FOO origFoo = new K_FOO(); 
```

int 和 byte 被初始化为 0，我假设因为它们是本机类型，但字节数组 b3 是 * *un* *initialized - 所有空值。我必须明确加载它，例如，

```
 BYTE3_TYPE b3 = new BYTE3_TYPE();
    origFoo.b3 = b3; 
```

...而且我想不出任何替代方案，因为结构不采用无参数构造函数，但真正的结构很大。

但我注意到了一些有趣的事情。我们有例程将这些结构复制到字节数组和从字节数组复制。例如 。. .

```
 public static T ByteArrayToStructure<T>(byte[] buffer) where T : struct
    {
        int length = buffer.Length;
        IntPtr ptr = Marshal.AllocHGlobal(length);   // allocate (length) bytes
        Marshal.Copy(buffer, 0, ptr, length);  // copies into UNmanaged space
        T result = (T)Marshal.PtrToStructure(ptr, typeof(T));
        Marshal.FreeHGlobal(ptr);
        return result;
    } 
```

...如果我称之为...

```
 K_FOO retFoo = ByteArrayToStructure<K_FOO>(buffer.bytes); 
```

...结果结构返回完全初始化，字节数组中的字节都分配了空间，因此可以加载它们，显然是在*PtrToStructure()*调用中。这意味着.Net“知道”如何初始化这样的结构。那么有没有办法让 .Net 为我做到这一点，这样我就可以避免编写数百行显式初始化代码？提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T17:08:35.283

如果您`BYTE3_TYPE`使用结构而不是类，则默认构造函数（调用 `K_FOO origFoo = new K_FOO();`）会将整个事物正确初始化为零。

如果您尝试匹配现有规范并将其传递给自定义硬件，这也可能是正确的方法。

# r - 在R中对非常大的数字求幂

> ID：14691690
> 
> 赞同：1
> 
> 时间：2013-02-04T17:06:43.730
> 
> 标签：r, logarithm, exponential

我有非常大的值的对数，例如：

```
log_a = 1347 
log_b = 1351 
```

我正在尝试解决这个表达式：

```
exp(log_a) - (0.1 * exp(log_b)) 
```

或者等效地这个（相同的表达式只是以不同的形式）：

```
exp( log_a ) - exp( log(0.1) + log_b ) 
```

但当然，每次我尝试计算 exp(log_a) 或 exp(log_b) 值时，我都会得到 Inf。有什么技巧可以用来获得对数或指数形式的 exp(log_a) - (0.1 * exp(log_b)) 的真实结果？

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-04T17:28:52.237

```
library(Brobdingnag)
a <- as.brob(exp(1))^1347
a*(1-0.1*exp(4))
#[1] -exp(1348.5) 
```

或手动计算：

```
-(exp(1347+log(0.1*exp(4)-1))=-exp(1347+1.4951...)=-exp(1348.4951...) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-04T17:45:24.660

```
X = exp(log_a) - (0.1 * exp(log_b))
  = exp(log_a) * (1 - 0.1 * exp(log_b) / exp(log_b))
  = exp(log_a) * (1 - exp(-log(10) + log_b - log_a))
  = -exp(log_a) * expm1(-log(10) + log_b - log_a) 
```

`expm1`是一个内置函数，可以准确计算`exp(x)-1`接近于`x`零的值。只有当参数为负时，您才能获得 this 的对数，`expm1`从而整个表达式为正。然后你可以只取绝对值的对数。

```
log X = log_a + log(-expm1(-log(10) + log_b - log_a)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T17:29:45.230

您可以使用 R 的 gmp 库，它支持大数（据我所知，任意大）

例如

```
> bigz('11111111111111111111111111111111111111111111111111111111111111111111111111111')
Big Integer ('bigz') :
[1] 11111111111111111111111111111111111111111111111111111111111111111111111111111 
```

我认为幂运算符包含在包中的某处。手册在这里：[http ://cran.r-project.org/web/packages/gmp/gmp.pdf](http://cran.r-project.org/web/packages/gmp/gmp.pdf)

# clojure - 用于线程之间同步的 Clojure 惯用语

> ID：14691691
> 
> 赞同：5
> 
> 时间：2013-02-04T17:06:48.843
> 
> 标签：clojure

我尝试解决的场景如下，我有一个测试程序，可以将网络连接到系统上的网络端点。

这个测试程序有一个在其上运行的 jetty web 服务器，它期望来自外部系统的回调，以完成一个成功的测试周期。如果在特定时间范围（超时）内未收到回调，则测试失败。

为此，我希望测试运行程序等待码头处理程序将在回调时设置的“事件”。

我考虑过使用 java 的 CyclicBarrier，但我想知道 clojure 中是否有一种惯用的方法来解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T17:12:20.260

你可以使用`promise`你最近问过的:) 像这样的东西：

```
(def completion (promise))

; In test runner.
; Wait 5 seconds then fail.
(let [result (deref completion 5000 :fail)]
   (if (= result :success) 
     (println "Great!") 
     (println "Failed :(")))

; In jetty on callback
(deliver completion :success) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T17:15:05.243

在直接的 Clojure 中，使用跟踪未完成回调的代理是有意义的，尽管在实践中我建议使用[Aleph](https://github.com/ztellman/aleph)，这是一个**用于异步 Web 编程的库**，它甚至可以使驱动处理程序变得相当容易。它生成环处理程序，听起来它很适合您现有的代码。

# php - 如何在 Linux 上的 PHP 中触摸文件并读取修改日期？

> ID：14691692
> 
> 赞同：1
> 
> 时间：2013-02-04T17:06:49.907
> 
> 标签：php

我需要从一个 PHP 脚本中触摸一个文件并读取上次从另一个脚本中触摸该文件的时间，但是无论我如何触摸文件并读出修改日期，修改日期都不会改变，下面是一个测试文件。

如何触摸日志文件从而更改修改日期，然后读取此修改日期？

```
class TestKeepAlive {

    protected $log_file_name;

    public function process() {
        $this->log_file_name = 'test_keepalive_log.txt';
        $this->_writeProcessIdToLogFile();

        for ($index = 0; $index < 10; $index++) {
            echo 'test' . PHP_EOL;
            sleep(1);
            touch($this->log_file_name);
            $this->_touchLogFile();
            $dateTimeLastTouched = $this->_getDateTimeLogFileLastTouched();
            echo $dateTimeLastTouched . PHP_EOL;
        }
    }

    protected function _touchLogFile() {
        //touch($this->log_file_name);
        exec("touch {$this->log_file_name}");
    }

    protected function _getDateTimeLogFileLastTouched() {
        return filemtime($this->log_file_name);
    }

    protected function _writeProcessIdToLogFile() {
        file_put_contents($this->log_file_name, getmypid());
    }

}

$testKeepAlive = new TestKeepAlive();
$testKeepAlive->process(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T17:19:01.087

您应该使用[PHP 手册](http://php.net/manual/en/function.clearstatcache.php)`clearstatcache`中的函数

> PHP 缓存这些函数（filemtime）返回的信息以提供更快的性能。但是，在某些情况下，您可能需要清除缓存的信息。例如，如果在一个脚本中多次检查同一个文件，并且该文件在该脚本的操作期间有被删除或更改的危险，您可以选择清除状态缓存。在这些情况下，您可以使用 clearstatcache() 函数来清除 PHP 缓存的有关文件的信息。

功能：

```
protected function _getDateTimeLogFileLastTouched() {
    clearstatcache();
    return filemtime($this->log_file_name);
} 
```

# matlab - .mat 树状结构设置预处理参数

> ID：14691693
> 
> 赞同：0
> 
> 时间：2013-02-04T17:06:52.353
> 
> 标签：matlab

我还有一个关于打开 .mat 文件的问题。它是一个“树状结构”，指定了图像分析的预处理步骤，是一个 SPM5 批处理文件。有没有比逐节浏览更简单的方法来查看这个文件？我正在尝试更新它以进行重新分析。

例如，通过键入...

工作{2}.spatial{2}.coreg{1}.estimate

我可以看到为估计设置了哪些参数。但是，有没有办法获得整个树状结构的输出？或者有没有更简单的方法来查看树状结构的最终级别？

我希望这是有道理的，再次抱歉，我是新用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T20:16:49.523

据我所知，Matlab 没有任何内置方式来显示递归结构的全部内容。但是，如果您知道您的编程 abc，那么编写一个递归函数来显示它并不是一项艰巨的任务。只需从顶部开始，使用 遍历所有字段`fieldnames(...)`，确定每个字段是离开还是结构，并且可能体面并重复。

问候

# javascript - 如何在 Aptana Studio 3 中设置最大列数？

> ID：14691695
> 
> 赞同：4
> 
> 时间：2013-02-04T17:07:05.933
> 
> 标签：javascript, code-formatting, aptana3

我使用 Aptana 3 进行 Web 开发。我被要求将我的 .js 和 html 文件的代码行保持在 80 列以内。我试图配置内置的格式化程序和编辑器，但我所能做的就是设置着色限制，而我想实际换行。我想知道我是否可以在 Aptana 中或使用外部格式化程序轻松地做到这一点。提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T17:34:22.640

您可以通过进入`Window > Preferences > General > Editors > Text Editors`并选中“显示打印边距”框来在您选择的任何列号处显示一条垂直线 - 这里有一个框来说明您想要它的列号。但是，这不会导致文本自动换行。

我不确定您是否要打开文本换行，因为对于在您的环境之外获取您的代码的任何人来说，这无助于使您的行宽小于 80 列，而且我认为您不希望 Aptana 自动添加当您达到 80 列时也会返回，因为如果您不注意，这可能会破坏您的代码。

您可以`Window > Preferences > Aptana Studio > Editors`通过选中“启用自动换行”并重新启动 Aptana 来启用自动换行。但就像我说的，这不会影响您的代码，因此它不会满足您的客户将代码保持在 80 列的任何要求。

# java - 当我尝试从 java 运行批处理文件时，我得到“dig 不被识别为内部或外部命令”

> ID：14691696
> 
> 赞同：1
> 
> 时间：2013-02-04T17:07:05.913
> 
> 标签：java, windows-7, cmd

```
import java.io.*;

public class Main {
    public static void main(String[] args) throws IOException, StringIndexOutOfBoundsException
    {
        Runtime.getRuntime().exec("cmd /c start C:\\dig-files3\\query3.bat");
    }
} 
```

我正在尝试通过 java 程序启动批处理文件，但我在 cmd 屏幕中收到“挖掘无法识别为内部或外部命令...”消息。但是，当我双击窗口中的批处理文件时，它运行良好。我怎样才能解决这个问题？这是批处理文件的内容：

```
SET /a VAR=0 
:HOME 
SET /a VAR=VAR+1 

IF %VAR%==200000 goto :End 

 dig @10.3.1.166 6.4.0.3.5.5.5.9.9.9.com. naptr
goto :HOME 

:END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T10:56:25.627

您应该为工作目录创建一个文件对象，以防止路径中出现空格问题，然后使用该对象启动批处理脚本：

```
File workdir = new File("C:\\dig-files3");
Runtime.getRuntime().exec("query3.bat", null, workdir); 
```

您的批处理脚本中还有一个缺陷：您可能想要编写`SET /a VAR=%VAR%+1`以便`%VAR%`在递增之前对其进行评估。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T17:16:49.580

这可能是因为“dig”尚未添加到您的 PATH 变量中。尝试打开一个新的终端窗口并输入“dig”，它可能会显示相同的错误。您必须转到控制面板 -> 系统 -> 系统属性 -> 高级选项选项卡 -> 环境变量。

在那里，您必须搜索 PATH 变量并在最后（以及在最后一个命令中添加“;”之后）添加“dig”可执行文件的完整路径（可执行文件本身除外，例如 c:\foo\bar）。然后再试一次。此环境变量告诉 Windows 在其中包含的路径列表中查找您尝试运行的可执行文件。

另一种解决方案是将已编译的 java 文件复制到 dig 可执行文件所在的位置并从那里运行它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T21:24:33.413

好的，可能有另一种方法来解决这个问题，但我就是这样做的。我正在使用 Eclipse，并将 dig 应用程序复制到项目目录 C:\User\username\workspace\projectName

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T17:13:28.890

您的问题是系统 PATH 变量中没有批处理文件。将批处理文件的路径插入系统PATH，它应该可以正常工作

# javascript - 使用 jQuery 根据日期值对表格进行排序

> ID：14691697
> 
> 赞同：1
> 
> 时间：2013-02-04T17:07:09.563
> 
> 标签：javascript, jquery, sorting, html-table

我有一个与这个问题非常相似的问题：[jQuery table sort](https://stackoverflow.com/questions/3160277/jquery-table-sort)

单击日期标题时，我想根据日期对表格行进行排序，而不是基于文本。

我的代码基于这个 jsFiddle [http://jsfiddle.net/gFzCk/](http://jsfiddle.net/gFzCk/)，它是上述问题的答案之一，它确实进行了排序，但它将日期视为普通文本，而不是日期。

通常我可以修改原始代码以满足我的需要，但这个代码只是有点超出我的能力。

这是我的 jsFiddle [http://jsfiddle.net/S6dM6/](http://jsfiddle.net/S6dM6/)

HTML

```
<table>
    <tr>
        <th id="dateHeader">Date</th>
        <th>Phone #</th>
        <th id="city_header">City</th>
        <th>Speciality</th>
    </tr>
    <tr>
        <td>01/02/2013</td>
        <td>00001111</td>
        <td>Amsterdam</td>
        <td>GGG</td>
    </tr>
    <tr>
        <td>24/02/2013</td>
        <td>55544444</td>
        <td>London</td>
        <td>MMM</td>
    </tr>
    <tr>
        <td>28/02/2013</td>
        <td>33332222</td>
        <td>France</td>
        <td>RRR</td>
    </tr>
    <tr>
        <td>13/02/2013</td>
        <td>88884444</td>
        <td>Auckland</td>
        <td>AA</td>
    </tr>
    <tr>
        <td>04/02/2013</td>
        <td>11115555</td>
        <td>New York</td>
        <td>BBB</td>
    </tr>
</table> 
```

JS

```
var table = $('table');

$('#dateHeader')
    .wrapInner('<span title="sort this column"/>')
    .each(function(){

        var th = $(this),
            thIndex = th.index(),
            inverse = false;

        th.click(function(){

            table.find('td').filter(function(){

                return $(this).index() === thIndex;

            }).sortElements(function(a, b){

                return $.text([a]) > $.text([b]) ?
                    inverse ? -1 : 1
                    : inverse ? 1 : -1;

            }, function(){

                // parentNode is the element we want to move
                return this.parentNode; 

            });

            inverse = !inverse;

        });

    }); 
```

并且引用了这个js文件： [https ://raw.github.com/padolsey/jQuery-Plugins/master/sortElements/jquery.sortElements.js](https://raw.github.com/padolsey/jQuery-Plugins/master/sortElements/jquery.sortElements.js)

以防万一您要建议某种表格排序插件，请注意单击标题时我的最终结果不会排序，排序函数将从我的javascript中的各个位置调用，我只是使用此单击示例作为使概念发挥作用的简单起点，并作为提出此问题的简单方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T18:08:47.080

像这样修改你的`sortElements`方法：

```
 }).sortElements(function(a, b){

            var strDate = $.text ([a]);
            var dateParts = strDate.split("/");
            var date = new Date(dateParts[2], (dateParts[1] - 1), dateParts[0]);
            var a1 = date.getTime ();
            strDate = $.text ([b]);
            dateParts = strDate.split("/");
            date = new Date(dateParts[2], (dateParts[1] - 1), dateParts[0]);
            b1 = date.getTime ();

            return a1 > b1 ?
                inverse ? -1 : 1
                : inverse ? 1 : -1; 
```

# versioning - NuGet 如何决定是否使用本地包缓存？

> ID：14691698
> 
> 赞同：13
> 
> 时间：2013-02-04T17:07:10.403
> 
> 标签：versioning, nuget, nuget-package

今天我在安装包时遇到了 NuGet 的奇怪行为。

简要说明：由于我的构建脚本，有一个 NuGet 包。我不会每次都更改版本，因此每次构建都会生成`MyPackage.1.0.0.nupkg`. 作为构建的最后一步，我将包推送到部署在本地网络中的 NuGet 服务器。

现在，在另一台机器上，我运行`nuget install MyPackage -Source http://myserver/nuget`，它显然安装了 NuGet 包。

当我推送`MyPackage`版本的另一个更新时，问题就出现了`1.0.0`。当我尝试在客户端机器上重新安装它时，我得到了以前版本的包。

我发现[这是本地缓存的问题](http://nuget.codeplex.com/wikipage?title=Machine%20Level%20Cache%20Part%201)：如果安装了包，它会进入本地缓存，下次安装**相同版本的包时**，它会从缓存中取出。很公平！

但是，另一方面，`-NoCache`该命令有一个选项`nuget install`，我希望它忽略本地缓存。

然而，事实并非如此。我第一次运行它时`-NoCache`，它会更新缓存并安装真正的最新版本。但是，下次包仍然从缓存中取出，即使有`-NoCache`选项。

是预期的吗？是不是因为版本没改？

以防万一：所有 NuGet 操作都是通过`NuGet.exe`PowerShell 会话完成的。

**更新**：我观察到奇怪的行为，我只能通过缓存过期来解释。当包被缓存时，所有`nuget install`从缓存中拉取包的后续调用，**直到经过一段时间**。我没有注意到确切的时间，但肯定是一个多小时。之后，`nuget install`更新缓存中的包，情况也一样了……

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-09-17T13:11:27.583

颜，

NuGet 将它下载的包缓存在本地硬盘上。对于我的 Windows 7 机器，缓存位于 C:\Users\jmelosegui\AppData\Local\NuGet\Cache。所以你可以从本地缓存目录中删除你想忘记的nuget包。然后下次安装软件包时，您将从服务器获得最新版本。

顺便说一句：我同意@matthew-skelton。

> 您不应该推送多个具有特定版本的包：包应该是不可变的。如果您更改了包中的某些内容，请增加内部版本号 abC 并推送新版本的包。

我希望这种方法适合您的情况

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-08-16T20:41:29.167

颜，

> 我推送了 MyPackage 的另一个更新 - 仍然是 version `1.0.0`。

您不应该推送多个具有特定版本的包：包应该是不可变的。如果您更改了包中的某些内容，请增加内部版本号`a.b.C`并推送包的新版本。

您遇到的行为是 NuGet 期望能够基本上无限期地缓存给定包版本的副作用。

# php - 会话登录脚本不会将表单变量值传递给 $_POST？

> ID：14691700
> 
> 赞同：-1
> 
> 时间：2013-02-04T17:07:18.567
> 
> 标签：php, html

不断收到*错误：以管理员身份登录*时管理员登录（管理员表单）。客户**还没有**表（db_table_customers）。

**编辑**：使用 Wamp 它给了我这个

* * *

```
( ! ) Warning: mysqli_num_rows() expects parameter 1 to be mysqli_result, boolean given in C:\wamp\www\dev6\login.php on line 36
Call Stack
#   Time    Memory  Function    Location
1   0.0003  692264  {main}( )   ..\login.php:0
2   0.0121  710400  mysqli_num_rows ( ) ..\login.php:36 
```

第 36 行是`$rows = mysqli_num_rows($result);`

此外，var_dump()ing $result 和 $row 分别在 Web 浏览器中打印以下内容：

> 布尔假
> 
> 无效的

* * *

这应该意味着 login.php 与我的 db_table_admins 表中为 admin 提供的登录名不匹配。但我正在为管理员提供正确的登录信息。检查了多次。

**形式**

```
<form name="admin_login" method="POST" action="login.php">
        <h3>Admin:</h3>
        Username: <input type="text" id="username" name="admin_login[username]"><br>
        Password: <input type="password" id="password" name="admin_login[password]"><br>
        <input type="submit" name="admin_submit" value="Login">
</form> 

<form name="customer_login" method="POST" action="login.php">
        <h3>Customer:</h3>
        Username: <input type="text" id="username" name="customer_login[username]"><br>
        Password: <input type="password" id="password" name="customer_login[password]"><br>
        <input type="submit" name="customer_submit" value="Login">
</form> 
```

**登录.php**

```
<?php

    require('connection.inc.php');

    $username = null;
    $password = null;
    $administrator = false;
    $result = null;

    $link = mysqli_connect($db_host, $db_username, $db_password, $db_database) or die("Can't connect");

    if(isset($_POST['admin_submit'])){
            $administrator = true;
            $username = $_POST['admin_login']['username'];
            $passname = $_POST['admin_login']['password'];
    }else{
            $username = $_POST['customer_login']['username'];
            $passname = $_POST['customer_login']['password'];
    }

    if($administrator){
        $query = "SELECT * FROM $db_table_admins WHERE username='$username' AND password='$password'";
        $result = mysqli_query($link, $query);
        $rows = mysqli_num_rows($result);

        if($rows == 1){
            $_SESSION['admin'] = true;
            header("location:login_success.php");
        }else{
            echo "Error: admin login";
        }
    }else{
        $query = "SELECT * FROM $db_table_customers WHERE username='$username' AND password='$password'";
        $result = mysqli_query($link, $query);
        $rows = mysqli_num_rows($result);

        if($rows == 1){
            $_SESSION['admin'] = false;
            header("location:login_success.php");
        }else{
            echo "Error: customer login";
        }
    }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:10:04.180

你有`$administrator = true;`，但你测试`if($admin){`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:24:26.320

您的管理员登录按钮称为`admin_submit`：

```
 <input type="submit" name="admin_submit" value="Login"> 
```

但在您的代码中，您检查`admin_login`：

```
if($_POST['admin_login']){ 
```

您需要检查（并更改为...）`admin_submit`已`admin_login`用于您的文本字段

**编辑：**正如所指出的，你有一个 sql 注入问题。这意味着，例如，您的某个`'`字符`$_POST`会破坏您的查询。

除此之外，您似乎正在使用变量作为表名；这些是从哪里来的/它们是从哪里来的？

# iphone - Xcode 谷歌地图搜索栏

> ID：14691703
> 
> 赞同：5
> 
> 时间：2013-02-04T17:07:28.000
> 
> 标签：iphone, xcode, google-maps, google-maps-sdk-ios

我正在制作一个基于 iPhone 位置的应用程序，但我在它的最后一个方面遇到了问题。我想知道是否有人知道如何集成与我们可以使用的地图相关的搜索栏`MKMapView`。

它实际上是地图上方的一个搜索栏，用户可以在一个区域中键入它，它会将他们带到那里。

这可能吗？

我四处寻找教程，但我只找到了如何制作一个带有地图视图、注释和添加标注的应用程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T23:50:24.443

您正在寻找的是地理编码 - 将搜索栏中的地址转换为纬度/经度坐标的过程，然后您可以将地图的位置设置为。

[这个问题](https://stackoverflow.com/questions/2281798/how-to-search-mkmapview-with-uisearchbar)有两个主要答案。[此答案](https://stackoverflow.com/a/2292587/148241)显示如何使用 Google API 进行地理编码，而[此答案](https://stackoverflow.com/a/11101249/148241)显示如何使用 Apple API 进行地理编码。

如果您使用 MapKit（从 iOS 6.0 开始使用 Apple 地图），那么您可能应该使用 Apple API（您不应该将 Google Maps API 与非 Google 地图一起使用）。

如果您使用[新的 Google Maps SDK for iOS](https://developers.google.com/maps/documentation/ios/)，您可能希望使用 Google API 进行地理编码。虽然请注意我链接到的答案是使用带有 MapKit 的 Google API（因为它是在 MapKit 使用 Google Maps 时写回的），所以您需要对其进行一些修改。

# python - 使用 Python 使用 Photoshop 打开 PDF

> ID：14691704
> 
> 赞同：0
> 
> 时间：2013-02-04T17:07:37.953
> 
> 标签：python, photoshop

我想使用 Python 在 Photoshop 中打开 PDF。我知道如何使用 python 打开 photoshop (.psd) 文件，但我想知道是否有办法指定用于打开文件的程序。

到目前为止，我打开 Photoshop 文档所做的一切是：

```
psd = "path\to\photoshop\document"
os.startfile(psd) 
```

但是当我在 PDF 上使用 os.startfile 时，它​​会使用 Adob​​e Acrobat 打开。我想在 Photoshop 中打开 PDF。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-11-27T06:54:17.473

```
from comtypes.client import GetActiveObject

# Start up Photoshop application
# app = Dispatch('Photoshop.Application')

# Or get Reference to already running Photoshop application instance
app = GetActiveObject("Photoshop.Application")
fileName = "C:\Git\PS_Samples_Files\MyPDFFile.pdf"
docRef = app.Open(fileName) 
```

更多示例在[https://github.com/lohriialo/photoshop-scripting-python](https://github.com/lohriialo/photoshop-scripting-python)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-20T07:30:18.200

Photoshop 具有打开 PDF 文档的选项，称为`Photoshop.PDFOpenOptions`

您需要 win32com 来发送 Photoshop 应用程序。请参阅下面的示例代码

```
import win32com.client
import os, glob
folderin = r'D:\in'
if (__name__ == '__main__'):
    psApp = win32com.client.Dispatch('Photoshop.Application')
    for infile in glob.glob(os.path.join(folderin, '*.pdf')):
            options = win32com.client.Dispatch('Photoshop.PDFOpenOptions')
            options.CropPage = 0   # BoundingBox
            options.Resolution = 300   # Pixels
            options.Mode = 1    # Grayscale
            options.BitsPerChannel = 8  # 8 bits per channel
            options.AntiAlias = True
            options.ConstrainProportions = True #Deprecated for Adobe Photoshop CS3

            doc = psApp.Open(infile, options)
            doc.flatten
            doc.Trim(1)
            doc.Close(2)

    psApp.Quit() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:14:06.443

`os.startfile`[只需使用其默认应用程序](http://docs.python.org/2/library/os.html#os.startfile)启动指定文件。将 PDF 的默认应用程序更改为 Photoshop 会得到您想要的结果，但代价是在其他情况下打开 PDF 真的很烦人。

要正确执行此操作，您需要使用 photoshop 的 COM 接口编写脚本。我没有尝试过，但[本教程](http://techarttiki.blogspot.co.uk/2008/08/photoshop-scripting-with-python.html)看起来可能适合您的需求。

# ios - NSAttributedString 是如何遵循 MVC 范式的？

> ID：14691707
> 
> 赞同：3
> 
> 时间：2013-02-04T17:07:46.580
> 
> 标签：ios, objective-c, model-view-controller, nsattributedstring

谁能向我解释 NSAttributedString 如何正确遵循 MVC 范式？我知道它不是从 NSString 继承的，但它仍然是一个字符串，所以我会说这是我模型的一部分。但是，在谈论 MVC 时，设置 UI 属性（例如下划线、字体、阴影等）显然是 View 的一部分，所以我不太确定这是如何遵循规则的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-04T17:15:55.813

NSAttributedString 是一个模型类。

它只是具有属性字符串的表示。

仅仅因为它存储了属性，所以它不负责属性的显示。

想象一下，你有一个自定义的形状类。如果您有一个正方形并存储了它的颜色，它仍然是一个模型对象，因为由呈现视图来绘制正方形并用颜色填充它，模型对象只是存储属性的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T19:46:27.010

`NSAttributedString`提供基础设施并且是 Cocoa 的样式化文本模型类的超类，`NSTextStorage`. An`NSTextStorage`只是一个`NSAttributedString`可以与布局管理器交谈并在编辑方面做一些簿记/便利方法的人。

控制器职责由 处理`NSLayoutManager`。其中很多与将 unicode 字符串转换为字形、样式化它们以及进行各种几何计算有关。它针对`NSTextContainer`对象执行所有这些操作，这些对象（在基类的情况下）只是花哨`NSSize`的，布局管理器可以用来计算字形应该在哪里描边，应该在哪里发生换行等等。

Cocoa 的样式文本视图类是`NSText`及其子类，与标尺、字体和颜色面板一起使用。 `NSTextView`是一个`NSText`子类，并且`NSCells`共享一个`NSText`对象来编辑它们的内容。 `NSText`是一个`NSResponder`并且它接受其 textStorage 和 layoutManager 的文本编辑消息（如果存在）。

# excel - 检查特定列中每个单元格的长度

> ID：14691712
> 
> 赞同：0
> 
> 时间：2013-02-04T17:08:03.167
> 
> 标签：excel, excel-formula, excel-2010

我有一个 Excel 电子表格，它给我一个特定列的错误。这是一个截断错误，所以我需要检查 O 列中的每个单元格的长度 >= 8000。数据类型是 varchar(max)，所以通过检查我可以看到哪一行被拒绝。尝试将数据导入 SQL Server 时发生此错误。我需要找到导致错误的行并修复它，以便我可以导入数据。该错误实际上表明它是截断异常或无效字符，因此此方法至少可以解决其中一个问题。如果重要的话，第一行是列名。我相信我需要像这样的 LEN(Column O) >= 8000 但我不是很精通所以希望我能在这里找到帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:17:12.147

在原始数据中创建一个新列。称之为“大于 8000” 将公式放在下一个单元格中（我假设为第 2 行）。然后把这个公式放在那里：

`=IF(LEN(O2)>8000,"YES","NO")`

将公式复制并粘贴到最后一个单元格行。

然后对数据应用过滤器（点击 a1，然后点击 Home-->Sort & Filter --> Filter）。然后转到新列“大于 8000”并过滤“是”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:17:32.270

LEN(InsertYourCellHere) 确实会给你单元格内的文本长度。您可以做的是在条件格式菜单中创建一个新规则 => 使用公式来确定要格式化的单元格。在那里您将输入 LEN() 公式。

# xsl-fo - Why does region-start begin at the top of the page when a region-before is present?

> ID：14691715
> 
> 赞同：2
> 
> 时间：2013-02-04T17:08:05.300
> 
> 标签：xsl-fo, apache-fop

According to the [Formatting Object documentation](http://www.w3.org/TR/2001/REC-xsl-20011015/slice6.html#fo_simple-page-master) the region-start (the region to the left of the body) spans **between** region-before (the header) and region-after (the footer), but when I generate a PDF with [FOP](http://xmlgraphics.apache.org/fop/) (v1.1) region-start will begin at the **top of the page** and will push the region-before to the right.

So, is there any attribute or anything that makes the generator to place the region-start to begin **below** region-before?

Here is some example code:

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:fo="http://www.w3.org/1999/XSL/Format">

<xsl:template match="/">
    <fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format">
        <fo:layout-master-set>
            <fo:simple-page-master master-name="A4-cover"
                page-width="210mm" page-height="297mm" margin="12mm">
                <fo:region-body margin-top="60mm" margin-left="85mm" />
                <fo:region-before extent="55mm" />
                <fo:region-start extent="80mm" />
            </fo:simple-page-master>
        </fo:layout-master-set>

        <fo:page-sequence master-reference="A4-cover">
            <fo:static-content flow-name="xsl-region-before">
                <fo:block background-color="blue">
                    Before area
                </fo:block>
            </fo:static-content>

            <fo:static-content flow-name="xsl-region-start">
                <fo:block background-color="red">
                    Start area
                </fo:block>
            </fo:static-content>

            <fo:flow flow-name="xsl-region-body">
                <fo:block background-color="green">
                    Body area
                </fo:block>
            </fo:flow>
        </fo:page-sequence>
    </fo:root>
</xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:13:50.170

First I thought that it should work as you expected it by default.

But it turns out that `precedence="true"` must be set on `region-before` to get the wanted behaviour (preventing `region-start` from extending into the corner). See [http://www.w3.org/TR/xsl11/#precedence](http://www.w3.org/TR/xsl11/#precedence).

It is not very clearly stated in the XSL-FO specification, but as I understand it `precedence` only applies to `region-before` and `region-after`.

Here is a mailing list thread with a discussion of the topic: [http://apache-fop.1065347.n5.nabble.com/page-layout-bug-td8766.html](http://apache-fop.1065347.n5.nabble.com/page-layout-bug-td8766.html).

# python - 使用 Django 在 Amazon RDS 上按距离对点进行排序

> ID：14691717
> 
> 赞同：1
> 
> 时间：2013-02-04T17:08:11.400
> 
> 标签：python, mysql, django, amazon-rds, geodjango

快速背景，我正在尝试创建一个 django 应用程序，该应用程序按与一个点的距离对一堆位置进行排序。该应用程序将在 EC2 服务器上运行，我想将 RDS 用于数据库。因为 PostgreSQL 在 RDS 上不可用，所以我选择使用 MySQL。

**问题：**

当我尝试运行视图时，出现错误：

> NotImplementedError：距离存储过程在 mysql 后端不可用。

这是视图：

```
from django.shortcuts import render_to_response
from models import CampSite
from geopy import geocoders
from django.contrib.gis.geos import *
from django.contrib.gis.measure import D
from django.template import RequestContext

def results(request):
     query = request.GET['q']
     g = geocoders.Google(resource='maps')
     results = []
     geocodes = g.geocode(query, exactly_one=False)
     for geocode in geocodes:
         location, (lat, lon) = geocode
         pnt = fromstr("POINT(%s %s)" % (lon, lat))
         distance_from_point = {'mi':'2000'}
         results.append(CampSite.objects.filter(
            lonlat__distance_lte=(
                    pnt,
                    D(**distance_from_point)
                    )
            ).distance(pnt).order_by('distance')
         )
       return render_to_response('results.html',{'location': location,
             'lat': lat, 'lon': lon, 'results':results[0]},
             context_instance=RequestContext(request)) 
```

从我读过的内容来看，我认为问题在于 MySQL 不符合 OGC 标准，并且使用 GDAL 获取信息可以工作，但我不知道如何实现它。

有谁知道我如何让应用程序使用 RDSpreferably 和 MySQL 工作？（我想避免 Heroku）

ps 我正在使用 geopy 向 Google 发出请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-11-10T16:47:41.677

想起来很有趣，但在你问这个问题的时候，MySQL 5.6 版不可用，因此不支持距离查询。[根据维基百科，](https://en.wikipedia.org/wiki/MySQL#Milestones)这个版本在您提出问题后的几天内可用。

从那以后，一些事情发生了变化：

1.  MySQL 拥有并支持空间数据类型和查询。但它仍然不符合 OGC 标准。
2.  Amazon RDS 现在[支持 PostgreSQL](https://aws.amazon.com/rds/postgresql/)。

我个人对空间数据库的偏好是带有 PostGIS 的 PostgreSQL，我建议使用它。

最后，假设您的`CampSite`模型有一个`Point`名为“pnt”的字段，并且您想要进行查询以返回按与参考点（命名为：）的距离排序的 Camp Sites `ref_pnt`，您可以使用以下查询：

```
CampSites.objects.annotate(dist=Distance('pnt', ref_pnt)).orderby('dist') 
```

# asp.net - 数字和特殊字符的正则表达式

> ID：14691719
> 
> 赞同：0
> 
> 时间：2013-02-04T17:08:13.120
> 
> 标签：asp.net, regex

我有以下正则表达式

```
^\d+(\,\.\d+)?$ 
```

我正在尝试匹配以下内容

1.  23
2.  23.45
3.  1,156
4.  12,523
5.  1.24
6.  1.1

我的表达不起作用，我正在寻找建议。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:10:45.957

```
^\d+([,.]\d+)?$ 
```

您有**一系列**逗号和句号，而不是一组。

# ajax - Fancybox ajax 内容未在 IE 中加载

> ID：14691720
> 
> 赞同：1
> 
> 时间：2013-02-04T17:08:15.977
> 
> 标签：ajax, internet-explorer, fancybox

我正在尝试将 HTML 加载到 fancybox 弹出窗口中。除了 IE 8（我还没有检查过其他版本的 IE），其他所有浏览器都运行良好。弹出窗口打开，但其中没有任何内容。

这是我的js：

```
$(".fancyPopup").live('click', function(ev){            
    ev.preventDefault();            
    var selectedStrip =  '#' + $(this).attr('id');          
$(".fancyPopup").live('click', function(ev){            
    ev.preventDefault();            
    var selectedStrip =  '#' + $(this).attr('id');          
    $.fancybox(     
        {
        href: '/snapav/mkting/html/rackPowerStripSuggestions.html',
        type: 'ajax',
        fitToView   : false,
        afterShow: function(){          
            hideSeries();           
            $('.strips:not("' + selectedStrip + '")').hide('slow', function(){              
                $('ul' + selectedStrip).addClass('flagged');                            
            });                 
        }       
        });     

}); 
```

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:22:22.717

这实际上是 2 个问题。

1.  为了让内容填充 IE 中的弹出窗口，我需要添加一个 DOCTYPE 和所有进入纯 HTML 页面的信息。没有意识到这一点。

2.  IE 在动画方面遇到了困难。你必须在你的动画中让你的 CSS 中的属性完全匹配。因此，如果您的 CSS 中有“padding: 4px 0”，则必须在 CSS 中将其分解为“padding-top: 4px 和 padding-bottom: 4px”，因为您无法在 jQuery 中为速记 CSS 设置动画。

在这里学到了很多！希望这可以在将来对其他人有所帮助。

# svn - IntelliJ Idea 无法与 svn update 一起正常工作

> ID：14691722
> 
> 赞同：5
> 
> 时间：2013-02-04T17:08:23.927
> 
> 标签：svn, intellij-idea

在 IntelliJ Idea 社区版中的 svn 更新或比较操作期间，我经常遇到相同的错误：

```
svn: E175002: Received fatal alert: unexpected_message
svn: E175002: OPTIONS request failed on '/projects/repo/home/.' 
```

环境：

*   IntelliJ Idea 社区版 12.0.3
*   SVN 1.7.7
*   视窗 7 x64

但它从命令行非常好用：

```
D:\projects\repo\home>svn update
Updating '.':
At revision 382293. 
```

有想法日志：

```
2013-02-05 00:43:53,684 [  17976]   INFO -  org.jetbrains.idea.svn.SvnVcs - SENT
OPTIONS /projects/repo/home HTTP/1.1
Host: subversion.repo.home.com
User-Agent: SVN/1.7.7 SVNKit/1.7.7-SNAPSHOT (http://svnkit.com/) r9513_v20121218_1752
Keep-Alive:
Connection: TE, Keep-Alive
TE: trailers
Content-Length: 0
Accept-Encoding: gzip
Content-Type: text/xml; charset="utf-8"
DAV: http://subversion.tigris.org/xmlns/dav/svn/depth
DAV: http://subversion.tigris.org/xmlns/dav/svn/mergeinfo
DAV: http://subversion.tigris.org/xmlns/dav/svn/log-revprops

2013-02-05 00:43:53,957 [  18249]   INFO -  org.jetbrains.idea.svn.SvnVcs - socket output stream requested... 
2013-02-05 00:43:53,957 [  18249]   INFO -  org.jetbrains.idea.svn.SvnVcs - Received fatal alert: unexpected_message 
javax.net.ssl.SSLException: Received fatal alert: unexpected_message
    at sun.security.ssl.Alerts.getSSLException(Alerts.java:208)
    at sun.security.ssl.Alerts.getSSLException(Alerts.java:154)
    at sun.security.ssl.SSLSocketImpl.recvAlert(SSLSocketImpl.java:1977)
    at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:1093)
    at sun.security.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1328)
    at sun.security.ssl.SSLSocketImpl.writeRecord(SSLSocketImpl.java:702)
    at sun.security.ssl.AppOutputStream.write(AppOutputStream.java:122)
    at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)
    at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:140)
    at org.tmatesoft.svn.core.internal.util.SVNLogOutputStream.flush(SVNLogOutputStream.java:48)
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPConnection.sendData(HTTPConnection.java:316)
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPRequest.dispatch(HTTPRequest.java:168)
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPConnection.request(HTTPConnection.java:449)
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPConnection.request(HTTPConnection.java:367)
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPConnection.request(HTTPConnection.java:355)
    at org.tmatesoft.svn.core.internal.io.dav.DAVConnection.performHttpRequest(DAVConnection.java:708)
    at org.tmatesoft.svn.core.internal.io.dav.DAVConnection.exchangeCapabilities(DAVConnection.java:628)
    at org.tmatesoft.svn.core.internal.io.dav.DAVConnection.open(DAVConnection.java:103)
    at org.tmatesoft.svn.core.internal.io.dav.DAVRepository.openConnection(DAVRepository.java:1016)
    at org.tmatesoft.svn.core.internal.io.dav.DAVRepository.getLatestRevision(DAVRepository.java:180)
    at org.tmatesoft.svn.core.internal.wc2.ng.SvnNgRepositoryAccess.getRevisionNumber(SvnNgRepositoryAccess.java:118)
    at org.tmatesoft.svn.core.internal.wc2.SvnRepositoryAccess.getLocations(SvnRepositoryAccess.java:148)
    at org.tmatesoft.svn.core.internal.wc2.ng.SvnNgRepositoryAccess.createRepositoryFor(SvnNgRepositoryAccess.java:45)
    at org.tmatesoft.svn.core.internal.wc2.remote.SvnRemoteGetInfo.run(SvnRemoteGetInfo.java:46)
    at org.tmatesoft.svn.core.internal.wc2.remote.SvnRemoteGetInfo.run(SvnRemoteGetInfo.java:31)
    at org.tmatesoft.svn.core.internal.wc2.SvnOperationRunner.run(SvnOperationRunner.java:20)
    at org.tmatesoft.svn.core.wc2.SvnOperationFactory.run(SvnOperationFactory.java:1235)
    at org.tmatesoft.svn.core.wc2.SvnOperation.run(SvnOperation.java:291)
    at org.tmatesoft.svn.core.wc.SVNWCClient.doInfo(SVNWCClient.java:2461)
    at org.jetbrains.idea.svn.SvnAuthenticationNotifier.validationImpl(SvnAuthenticationNotifier.java:319)
    at org.jetbrains.idea.svn.SvnAuthenticationNotifier.passiveValidation(SvnAuthenticationNotifier.java:303)
    at org.jetbrains.idea.svn.SvnAuthenticationNotifier.isAuthenticatedFor(SvnAuthenticationNotifier.java:227)
    at org.jetbrains.idea.svn.SvnVcs.isVcsBackgroundOperationsAllowed(SvnVcs.java:1177)
    at com.intellij.openapi.vcs.changes.committed.CommittedChangesCache.loadIncomingChanges(CommittedChangesCache.java:589)
    at com.intellij.openapi.vcs.changes.committed.CommittedChangesCache$8.run(CommittedChangesCache.java:693)
    at com.intellij.openapi.progress.ProgressManagerQueue.runStuff(ProgressManagerQueue.java:62)
    at com.intellij.openapi.progress.ProgressManagerQueue.runStuff(ProgressManagerQueue.java:23)
    at com.intellij.openapi.progress.AbstractTaskQueue$MyWorker.run(AbstractTaskQueue.java:78)
    at com.intellij.openapi.progress.ProgressManagerQueue$1.run(ProgressManagerQueue.java:33)
    at com.intellij.openapi.progress.impl.ProgressManagerImpl$TaskRunnable.run(ProgressManagerImpl.java:501)
    at com.intellij.openapi.progress.impl.ProgressManagerImpl$2.run(ProgressManagerImpl.java:191)
    at com.intellij.openapi.progress.impl.ProgressManagerImpl.executeProcessUnderProgress(ProgressManagerImpl.java:232)
    at com.intellij.openapi.progress.impl.ProgressManagerImpl.runProcess(ProgressManagerImpl.java:181)
    at com.intellij.openapi.progress.impl.ProgressManagerImpl$8.run(ProgressManagerImpl.java:406)
    at com.intellij.openapi.application.impl.ApplicationImpl$6.run(ApplicationImpl.java:465)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
    at com.intellij.openapi.application.impl.ApplicationImpl$1$1.run(ApplicationImpl.java:153)
2013-02-05 00:43:53,959 [  18251]   INFO -  org.jetbrains.idea.svn.SvnVcs - svn: E175002: Received fatal alert: unexpected_message 
java.lang.Exception: svn: E175002: Received fatal alert: unexpected_message
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPConnection.request(HTTPConnection.java:739)
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPConnection.request(HTTPConnection.java:367)
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPConnection.request(HTTPConnection.java:355)
    at org.tmatesoft.svn.core.internal.io.dav.DAVConnection.performHttpRequest(DAVConnection.java:708)
    at org.tmatesoft.svn.core.internal.io.dav.DAVConnection.exchangeCapabilities(DAVConnection.java:628)
    at org.tmatesoft.svn.core.internal.io.dav.DAVConnection.open(DAVConnection.java:103)
    at org.tmatesoft.svn.core.internal.io.dav.DAVRepository.openConnection(DAVRepository.java:1016)
    at org.tmatesoft.svn.core.internal.io.dav.DAVRepository.getLatestRevision(DAVRepository.java:180)
    at org.tmatesoft.svn.core.internal.wc2.ng.SvnNgRepositoryAccess.getRevisionNumber(SvnNgRepositoryAccess.java:118)
    at org.tmatesoft.svn.core.internal.wc2.SvnRepositoryAccess.getLocations(SvnRepositoryAccess.java:148)
    at org.tmatesoft.svn.core.internal.wc2.ng.SvnNgRepositoryAccess.createRepositoryFor(SvnNgRepositoryAccess.java:45)
    at org.tmatesoft.svn.core.internal.wc2.remote.SvnRemoteGetInfo.run(SvnRemoteGetInfo.java:46)
    at org.tmatesoft.svn.core.internal.wc2.remote.SvnRemoteGetInfo.run(SvnRemoteGetInfo.java:31)
    at org.tmatesoft.svn.core.internal.wc2.SvnOperationRunner.run(SvnOperationRunner.java:20)
    at org.tmatesoft.svn.core.wc2.SvnOperationFactory.run(SvnOperationFactory.java:1235)
    at org.tmatesoft.svn.core.wc2.SvnOperation.run(SvnOperation.java:291)
    at org.tmatesoft.svn.core.wc.SVNWCClient.doInfo(SVNWCClient.java:2461)
    at org.jetbrains.idea.svn.SvnAuthenticationNotifier.validationImpl(SvnAuthenticationNotifier.java:319)
    at org.jetbrains.idea.svn.SvnAuthenticationNotifier.passiveValidation(SvnAuthenticationNotifier.java:303)
    at org.jetbrains.idea.svn.SvnAuthenticationNotifier.isAuthenticatedFor(SvnAuthenticationNotifier.java:227)
    at org.jetbrains.idea.svn.SvnVcs.isVcsBackgroundOperationsAllowed(SvnVcs.java:1177)
    at com.intellij.openapi.vcs.changes.committed.CommittedChangesCache.loadIncomingChanges(CommittedChangesCache.java:589)
    at com.intellij.openapi.vcs.changes.committed.CommittedChangesCache$8.run(CommittedChangesCache.java:693)
    at com.intellij.openapi.progress.ProgressManagerQueue.runStuff(ProgressManagerQueue.java:62)
    at com.intellij.openapi.progress.ProgressManagerQueue.runStuff(ProgressManagerQueue.java:23)
    at com.intellij.openapi.progress.AbstractTaskQueue$MyWorker.run(AbstractTaskQueue.java:78)
    at com.intellij.openapi.progress.ProgressManagerQueue$1.run(ProgressManagerQueue.java:33)
    at com.intellij.openapi.progress.impl.ProgressManagerImpl$TaskRunnable.run(ProgressManagerImpl.java:501)
    at com.intellij.openapi.progress.impl.ProgressManagerImpl$2.run(ProgressManagerImpl.java:191)
    at com.intellij.openapi.progress.impl.ProgressManagerImpl.executeProcessUnderProgress(ProgressManagerImpl.java:232)
    at com.intellij.openapi.progress.impl.ProgressManagerImpl.runProcess(ProgressManagerImpl.java:181)
    at com.intellij.openapi.progress.impl.ProgressManagerImpl$8.run(ProgressManagerImpl.java:406)
    at com.intellij.openapi.application.impl.ApplicationImpl$6.run(ApplicationImpl.java:465)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
    at com.intellij.openapi.application.impl.ApplicationImpl$1$1.run(ApplicationImpl.java:153)
2013-02-05 00:43:53,960 [  18252]   INFO -  org.jetbrains.idea.svn.SvnVcs - svn: E175002: Received fatal alert: unexpected_message 
2013-02-05 00:43:53,960 [  18252]   INFO - .svn.SvnAuthenticationNotifier - some other exc 
org.tmatesoft.svn.core.SVNException: svn: E175002: Received fatal alert: unexpected_message
svn: E175002: OPTIONS request failed on '/projects/repo/home'
    at org.tmatesoft.svn.core.internal.wc.SVNErrorManager.error(SVNErrorManager.java:106)
    at org.tmatesoft.svn.core.internal.wc.SVNErrorManager.error(SVNErrorManager.java:90)
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPConnection.request(HTTPConnection.java:741)
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPConnection.request(HTTPConnection.java:367)
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPConnection.request(HTTPConnection.java:355)
    at org.tmatesoft.svn.core.internal.io.dav.DAVConnection.performHttpRequest(DAVConnection.java:708)
    at org.tmatesoft.svn.core.internal.io.dav.DAVConnection.exchangeCapabilities(DAVConnection.java:628)
    at org.tmatesoft.svn.core.internal.io.dav.DAVConnection.open(DAVConnection.java:103)
    at org.tmatesoft.svn.core.internal.io.dav.DAVRepository.openConnection(DAVRepository.java:1016)
    at org.tmatesoft.svn.core.internal.io.dav.DAVRepository.getLatestRevision(DAVRepository.java:180)
    at org.tmatesoft.svn.core.internal.wc2.ng.SvnNgRepositoryAccess.getRevisionNumber(SvnNgRepositoryAccess.java:118)
    at org.tmatesoft.svn.core.internal.wc2.SvnRepositoryAccess.getLocations(SvnRepositoryAccess.java:148)
    at org.tmatesoft.svn.core.internal.wc2.ng.SvnNgRepositoryAccess.createRepositoryFor(SvnNgRepositoryAccess.java:45)
    at org.tmatesoft.svn.core.internal.wc2.remote.SvnRemoteGetInfo.run(SvnRemoteGetInfo.java:46)
    at org.tmatesoft.svn.core.internal.wc2.remote.SvnRemoteGetInfo.run(SvnRemoteGetInfo.java:31)
    at org.tmatesoft.svn.core.internal.wc2.SvnOperationRunner.run(SvnOperationRunner.java:20)
    at org.tmatesoft.svn.core.wc2.SvnOperationFactory.run(SvnOperationFactory.java:1235)
    at org.tmatesoft.svn.core.wc2.SvnOperation.run(SvnOperation.java:291)
    at org.tmatesoft.svn.core.wc.SVNWCClient.doInfo(SVNWCClient.java:2461)
    at org.jetbrains.idea.svn.SvnAuthenticationNotifier.validationImpl(SvnAuthenticationNotifier.java:319)
    at org.jetbrains.idea.svn.SvnAuthenticationNotifier.passiveValidation(SvnAuthenticationNotifier.java:303)
    at org.jetbrains.idea.svn.SvnAuthenticationNotifier.isAuthenticatedFor(SvnAuthenticationNotifier.java:227)
    at org.jetbrains.idea.svn.SvnVcs.isVcsBackgroundOperationsAllowed(SvnVcs.java:1177)
    at com.intellij.openapi.vcs.changes.committed.CommittedChangesCache.loadIncomingChanges(CommittedChangesCache.java:589)
    at com.intellij.openapi.vcs.changes.committed.CommittedChangesCache$8.run(CommittedChangesCache.java:693)
    at com.intellij.openapi.progress.ProgressManagerQueue.runStuff(ProgressManagerQueue.java:62)
    at com.intellij.openapi.progress.ProgressManagerQueue.runStuff(ProgressManagerQueue.java:23)
    at com.intellij.openapi.progress.AbstractTaskQueue$MyWorker.run(AbstractTaskQueue.java:78)
    at com.intellij.openapi.progress.ProgressManagerQueue$1.run(ProgressManagerQueue.java:33)
    at com.intellij.openapi.progress.impl.ProgressManagerImpl$TaskRunnable.run(ProgressManagerImpl.java:501)
    at com.intellij.openapi.progress.impl.ProgressManagerImpl$2.run(ProgressManagerImpl.java:191)
    at com.intellij.openapi.progress.impl.ProgressManagerImpl.executeProcessUnderProgress(ProgressManagerImpl.java:232)
    at com.intellij.openapi.progress.impl.ProgressManagerImpl.runProcess(ProgressManagerImpl.java:181)
    at com.intellij.openapi.progress.impl.ProgressManagerImpl$8.run(ProgressManagerImpl.java:406)
    at com.intellij.openapi.application.impl.ApplicationImpl$6.run(ApplicationImpl.java:465)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
    at com.intellij.openapi.application.impl.ApplicationImpl$1$1.run(ApplicationImpl.java:153)
Caused by: javax.net.ssl.SSLException: Received fatal alert: unexpected_message
    at sun.security.ssl.Alerts.getSSLException(Alerts.java:208)
    at sun.security.ssl.Alerts.getSSLException(Alerts.java:154)
    at sun.security.ssl.SSLSocketImpl.recvAlert(SSLSocketImpl.java:1977)
    at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:1093)
    at sun.security.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1328)
    at sun.security.ssl.SSLSocketImpl.writeRecord(SSLSocketImpl.java:702)
    at sun.security.ssl.AppOutputStream.write(AppOutputStream.java:122)
    at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)
    at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:140)
    at org.tmatesoft.svn.core.internal.util.SVNLogOutputStream.flush(SVNLogOutputStream.java:48)
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPConnection.sendData(HTTPConnection.java:316)
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPRequest.dispatch(HTTPRequest.java:168)
    at org.tmatesoft.svn.core.internal.io.dav.http.HTTPConnection.request(HTTPConnection.java:449)
    ... 39 more 
```

我已经尝试了以下步骤：

1.  重启创意；
2.  重新结帐项目；
3.  重新安装svn客户端；

有人有其他建议吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-06-24T13:02:18.363

我遇到了与原始海报非常相似的问题。上面拉曼的建议对我不起作用。我的问题很可能是由于在 Java 7 中运行 IntelliJ 以及为 SVN 服务的配置错误的 Apache 服务器引起的。Java 7 实现了 SNI，这可能导致与错误配置的 HTTPS 服务器的连接失败（以前使用 Java 6，它们可以正常工作）。

我用来解决这个问题的解决方案是在 $IDEA_HOME/bin/idea64.vmoptions 或 $IDEA_HOME/bin/idea64.vmoptions 中酌情添加以下行：

```
-Djsse.enableSNIExtension=false 
```

这将为运行 IntelliJ 的 JVM 禁用 SNI 扩展（不要在运行应用程序的生产服务器上使用此设置 - 对于运行 dev IntelliJ 的 VM 应该没问题）

这个回复中的答案是从[这个通用的stackoverflow帖子中挑选出来的](https://stackoverflow.com/questions/7615645/ssl-handshake-alert-unrecognized-name-error-since-upgrade-to-java-1-7-0)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-05T06:47:29.247

在文件中添加`-Dsvnkit.http.sslProtocols=SSLv3`选项`IDEA_HOME\bin\idea.exe.vmoptions`为我解决了问题。

请参阅[http://youtrack.jetbrains.com/issue/IDEA-90335](http://youtrack.jetbrains.com/issue/IDEA-90335)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-12T22:18:16.460

只是我刚刚遇到它时对此的另一个说明。Java 8 Update 60 (8u60) 的发行说明（此处为：[https](https://java.com/en/download/faq/release_changes.xml) ://java.com/en/download/faq/release_changes.xml）中有关于禁用密码套件的列出位置的说明，即在`$JAVA_HOME/jre/lib/security`文件中`java.security`。

您可以通过从禁用列表中删除各种禁用的密码来重新启用它们。

某人。

# ios - CoreData：nil 不是合法的 NSManagedObjectContext 参数

> ID：14691724
> 
> 赞同：2
> 
> 时间：2013-02-04T17:08:41.990
> 
> 标签：ios, core-data

我对 Core Data 非常陌生，并且一直在尝试学习许多教程，但其中大多数都将所有 Core Data 方法都放入了 AppDelegate。我读过最好远离 AppDelegate 并使用自定义数据模型类来管理这些方法。

我创建了一个自定义类来管理我的所有名为`MyDataModel`. 我实现了样板核心数据代码。在我的一个视图控制器中，我有一个使用 Core Data 实现一些数据的简单方法：

```
- (void)getProfile {
/*
 * getProfile
 */
    NSLog(@"%@", _Model.managedObjectContext);
    Users *user = (Users *)[NSEntityDescription insertNewObjectForEntityForName:@"Users" inManagedObjectContext:_Model.managedObjectContext];

    // Set Data
    [user setValue:@"John" forKey:@"fname"];
    [user setValue:@"Smith" forKey:@"lname"];
    NSError *error;
    [_Model.managedObjectContext save:&error];
} 
```

头文件中的代码：

```
#import <UIKit/UIKit.h>
#import "Users.h"
#import <CoreData/CoreData.h>
#import "DataModel.h"

@interface ProfileViewController : UIViewController

// CoreData Related
@property (strong, nonatomic) DataModel *Model;

// Instance Methods
- (void)updateProfileData;

// Core Data Method
- (void)getProfile;

@end 
```

此方法在视图控制器的方法中调用`viewDidLoad`。当我运行它时，我收到以下错误：

```
'+entityForName: nil is not a legal NSManagedObjectContext parameter searching for entity name 'Users'' 
```

我在 StackOverflow 上发现了一个类似的问题，可能会有所帮助，但我仍然不明白解决方案实际上是什么。

['+entityForName: nil 不是合法的 NSManagedObjectContext 参数 - 核心数据](https://stackoverflow.com/questions/11596487/entityforname-nil-is-not-a-legal-nsmanagedobjectcontext-parameter-core-data)

该线程中声明的解决方案是他将上下文传递给 ViewController。这是如何实现的？我已经认为我正在这样做。

编辑`DataModel.h`：：

```
#import <Foundation/Foundation.h>
#import <CoreData/CoreData.h>
#import "Workouts.h"
#import "sqlite3.h"

@interface DataModel : NSObject {
    sqlite3 *Database;
}

@property (nonatomic, strong) Workouts *currentWorkout;

// Core Data Properties
@property (nonatomic, strong) NSManagedObjectContext *managedObjectContext;
@property (nonatomic, strong) NSManagedObjectModel *managedObjectModel;
@property (nonatomic, strong) NSPersistentStoreCoordinator *storeCoordinator;

+ (DataModel *)sharedInstance;
- (void)saveContext;
- (NSURL *)applicationDocumentsDirectory;

@end 
```

`DataModel.m`：

```
#import "DataModel.h"

@implementation DataModel

#pragma mark - Core Data

+ (DataModel *)sharedInstance {
   static DataModel *sharedModel = nil;
   static dispatch_once_t onceToken;

   dispatch_once(&onceToken, ^{
       sharedModel = [[DataModel alloc] init];
       //sharedInstance.storeCoordinator = [sharedInstance storeCoordinator];
       //sharedInstance.managedObjectContext = [sharedInstance managedObjectContext];
   });
   return sharedModel;
}

- (void)saveContext {
    NSError *error = nil;
    if (_managedObjectContext != nil) {
        if ([_managedObjectContext hasChanges] && ![_managedObjectContext save:&error]) {
            NSLog(@"error: %@", error.userInfo);
        }
    }
}

#pragma mark - Core Data Stack

- (NSManagedObjectContext *)managedObjectContext {

    if (_managedObjectContext != nil) {
        return _managedObjectContext;
    }

    NSPersistentStoreCoordinator *coordinator = [self storeCoordinator];
    if (coordinator != nil) {
        _managedObjectContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSMainQueueConcurrencyType];
        [_managedObjectContext setPersistentStoreCoordinator: coordinator];
    }
    return _managedObjectContext;
}

- (NSManagedObjectModel *)managedObjectModel {
    if (_managedObjectModel != nil) {
        return _managedObjectModel;
    }
    NSURL *modelURL = [[NSBundle mainBundle] URLForResource:@"DataModel" withExtension:@"momd"];
    _managedObjectModel = [[NSManagedObjectModel alloc] initWithContentsOfURL:modelURL];
    return _managedObjectModel;
}

- (NSPersistentStoreCoordinator *)persistentStoreCoordinator {
    if (_storeCoordinator != nil) {
        return _storeCoordinator;
    }

    NSURL *storeURL = [[self applicationDocumentsDirectory] URLByAppendingPathComponent:@"model.sqlite"];

    NSError *error = nil;
    _storeCoordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:_managedObjectModel];
    if (![_storeCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:storeURL options:nil error:&error]) {
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    }

    return _storeCoordinator;
}

#pragma mark Application's Documents Directory

- (NSURL *)applicationDocumentsDirectory {
return [[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask] lastObject];
}

@end 
```

更新：我意识到对象是`(null)`. 我试图调用`sharedInstance`单例方法，但他们没有正确调用。正在调用 getter 并将进入一个不断调用 getter 的循环。我正确使用了合成变量`_managedObjectContext`和`_storeCoordinator`. 对象现在适当地分配内存并返回引用。感谢大家的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T18:10:05.563

在 Application Delegate 中创建的 Core Data Stack 没有任何问题。你在哪里读到过这种情况。

调用 Application Delegate 以获取托管对象上下文当然被认为是糟糕的设计，但大多数人所做的是将托管对象上下文的引用从 Application Delegate 传递给使用它的其他视图控制器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T06:02:51.023

愚蠢的问题：您的模型实际上命名为DataModel？

# css - 网页布局设计工具

> ID：14691725
> 
> 赞同：-1
> 
> 时间：2013-02-04T17:08:45.130
> 
> 标签：css, user-interface, web, wordpress-theming

我刚开始尝试为自己的业务建立一个网站。网页设计不是我的主要工作，所以我基本上希望它能够尽快运行。我希望布局设计具有一定的灵活性，所以我避免使用千篇一律的模板。

我开始选择 Wordpress 论文主题。随着时间的推移，我已经排好大部分网站内容。但是，我正在努力将所有部分放在一起，以使网站设计看起来统一和专业。我尝试了一点 CSS，花了很多时间在对齐 Web 元素、字体大小、颜色协调之类的事情上，并且觉得我需要很长时间才能完成这个网站。

有没有人建议适合初学者技能水平的免费工具，以减少开发时间并与 Wordpress 论文主题兼容？

我的业务是销售产品。所以这个网站很像一个包含图片、内容、新闻和博客的产品目录。

我在这个网站上阅读了一些关于 CSS 框架的内容，还查看了 jQuery-UI。只是不确定它们是否是我想要完成的正确方法。

任何建议都非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:12:01.453

Checkout [Artisteer](http://www.artisteer.com/)，它是一个所见即所得的主题版本，可以渲染 Wordpress 主题。99 美元，但物有所值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:12:20.683

WebMatrix 是一个免费且轻量级的 Web 开发工具。轻松创建、发布和维护您的网站。它来自微软的免费工具。
你可以从微软官网下载

[http://www.microsoft.com/web/webmatrix/](http://www.microsoft.com/web/webmatrix/)

# php - 2 个时间戳之间的 PHP 小时、分钟和秒

> ID：14691727
> 
> 赞同：1
> 
> 时间：2013-02-04T17:08:48.793
> 
> 标签：php, timestamp

PHP 4

```
$a = 1359994013   (Mon, 04 Feb 2013 16:06:53)
$b = 1359997483   (Mon, 04 Feb 2013 17:04:43) 
```

如何计算这两个时间戳之间的差异并将结果显示为：

```
w days, x hours, y mins, z seconds. 
```

例如：0 天、0 小时、58 分钟、10 秒

谢谢 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T17:21:17.900

如果您参与计算并坚持使用 PHP 4：

```
$a = 1359994013;
$b = 1359997483;

$difference = $b-$a;

$second = 1;
$minute = 60*$second;
$hour   = 60*$minute;
$day    = 24*$hour;

$ans["day"]    = floor($difference/$day);
$ans["hour"]   = floor(($difference%$day)/$hour);
$ans["minute"] = floor((($difference%$day)%$hour)/$minute);
$ans["second"] = floor(((($difference%$day)%$hour)%$minute)/$second);
echo $ans["day"] . " days, " . $ans["hour"] . " hours, "  . $ans["minute"] . " minutes, " . $ans["second"] . " seconds"; 
```

这给你`0 days, 0 hours, 57 minutes, 50 seconds`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:11:39.053

您可以尝试使用日期功能：

[http://php.net/manual/it/function.date.php](http://php.net/manual/it/function.date.php)

# c# - Azure 错误引用本地路径

> ID：14691730
> 
> 赞同：1
> 
> 时间：2013-02-04T17:08:53.777
> 
> 标签：c#, asp.net-mvc, azure, azure-web-roles

我在 Azure 上部署了一个 Web 应用程序，但在 Azure 部署中出现错误，显示对同一解决方案中的类库的引用。

但是错误消息显示了我本地的文件路径：

*你调用的对象是空的。* **XXX.Domain.Concrete.EFBusinessRepository.PrepForConversionToHtml(XXX x) 在 c:\dev\repos\Jeff\ClassLibrary\Concrete\EFBusinessRepository.cs:1280**

而不是 Azure 更典型的一种：

*你调用的对象是空的。* **E:\sitesroot\0\bin 中的 XXX.Domain.Concrete.EFBusinessRepository.PrepForConversionToHtml(XXX x) .....**

我对这件事反应过度了吗？它在我的本地显示一条路径似乎很愚蠢。我正在追踪新 Azure 部署的所有错误，如果这是预期行为，我深表歉意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:29:53.810

在此处添加分辨率作为答案。

pdb 文件包含您的二进制文件的其他调试信息。在部署了 pdb 的机器上出现的任何故障都将显示更丰富的堆栈信息，这些信息会引用带有行号等的源代码文件。删除 pdb 将解决您的问题。另外，理想情况下，除非您在生产中积极调试某些东西，否则您最好不要将 pdb 与您的零售产品位一起部署。

# java - 如何清除我的 Jpanel 但保留网格线？

> ID：14691733
> 
> 赞同：1
> 
> 时间：2013-02-04T17:09:00.120
> 
> 标签：java, swing, drawing, jpanel, graphics2d

我正在使用绘图组件和图形 2D 在 JPanel 上绘制线条，但是 JPanel 的背景设置为在用户输入某些尺寸时绘制的网格。单击按钮时如何清除在 JPanel 上绘制的线条，但使用绘制的网格线重新生成一个新面板？使用清除按钮的动作事件方法，我尝试使用 repaint()、removeAll() 并创建 JPanel 的新实例，但这些似乎都不起作用。

这是具有主面板和按钮功能的类的代码：

```
package floorplan;

/**
*
* @author xodkx
*/

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Graphics;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JRadioButton;
import javax.swing.SwingUtilities;

public class FloorPlan extends JFrame 
{

private JPanel backPanel = new JPanel();
private JPanel toolsPanel = new JPanel();
private JFrame chooseFurniture;
private JFrame chooseFixture;
private JFrame chooseFramework;
private JButton furnitureButton = new JButton();
private JButton fixturesButton = new JButton();
private JButton frameworkButton = new JButton();
private JButton deleteButton = new JButton();
private JButton saveButton = new JButton();
private JButton clearButton = new JButton();
private JButton closeButton = new JButton();
private JRadioButton wall = new JRadioButton("Wall");
private JRadioButton door = new JRadioButton("Door");
private JRadioButton window = new JRadioButton("Window");

Floor floor = new Floor();

public FloorPlan()
{
     super("Floor Plan Generator");  
     createWindow();
     buttonFunctions();
     setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
     pack();
     setVisible(true);
}

private void createWindow()
{
  backPanel.setLayout(new BorderLayout());
  backPanel.setBorder(BorderFactory.createEmptyBorder(200, 200, 200, 200));
  GridLayout panelLayout = new GridLayout();
  frameworkButton.setText("Framework");
  fixturesButton.setText("Fixtures");
  furnitureButton.setText("Furniture");
  deleteButton.setText("Delete");
  saveButton.setText("Save");
  clearButton.setText("Clear");

  add(backPanel, BorderLayout.CENTER);
  backPanel.add(toolsPanel, BorderLayout.NORTH);
  backPanel.add(floor, BorderLayout.CENTER);
  backPanel.setBorder(BorderFactory.createEmptyBorder(20, 20, 20, 20));
  toolsPanel.add(frameworkButton);
  toolsPanel.add(fixturesButton);
  toolsPanel.add(furnitureButton);
  toolsPanel.add(deleteButton);
  toolsPanel.add(saveButton);
  toolsPanel.add(clearButton);
  add(backPanel); 
}

private void buttonFunctions()
{
    frameworkButton.addActionListener(new ActionListener()
    {
        @Override
        public void actionPerformed(final ActionEvent e)
        {
           chooseFramework = new JFrame("Pick A Framework");
           chooseFramework.setSize(250,250);
           chooseFramework.setLayout(new GridLayout(4,1));
           chooseFramework.add(wall);
           chooseFramework.add(door);
           chooseFramework.add(window);
           chooseFramework.add(closeButton);
           closeButton.setText("Close");

           wall.addActionListener(new ActionListener() 
          {
                @Override
                public void actionPerformed(ActionEvent e) 
          {

               floor.setFramework(Framework.WALL);

        }});

            door.addActionListener(new ActionListener() 
          {
                @Override
                public void actionPerformed(ActionEvent e) 
          {

               floor.setColor(Color.RED);
               floor.setFramework(Framework.DOOR);

        }});

            window.addActionListener(new ActionListener() 
          {
                @Override
                public void actionPerformed(ActionEvent e) 
          {
               floor.setColor(Color.BLUE);
               floor.setFramework(Framework.WALL);

        }});

           closeButton.addActionListener(new ActionListener() 
           {
                @Override
            public void actionPerformed(ActionEvent e) 
            {
               chooseFramework.setVisible(false);

            }
           });

            setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            pack();
            chooseFramework.setVisible(true);
        }
    });

    furnitureButton.addActionListener(new ActionListener()
    {
        @Override
        public void actionPerformed(final ActionEvent e)
        {
           chooseFurniture = new JFrame("Pick Furniture to add");
           chooseFurniture.setSize(250,250);
           chooseFurniture.setLayout(new GridLayout(4,1));
           chooseFurniture.add(closeButton);
           closeButton.setText("Close");

           closeButton.addActionListener(new ActionListener() 
           {
                @Override
            public void actionPerformed(ActionEvent e) 
            {
               chooseFurniture.setVisible(false);
            }
           });

            setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            pack();
            chooseFurniture.setVisible(true);
        }
    });

    fixturesButton.addActionListener(new ActionListener()
    {
        @Override
        public void actionPerformed(final ActionEvent e)
        {
           chooseFixture = new JFrame("Pick Furniture to add");
           chooseFixture.setSize(250,250);
           chooseFixture.setLayout(new GridLayout(4,1));
           chooseFixture.add(closeButton);
           closeButton.setText("Close");

           closeButton.addActionListener(new ActionListener() 
           {
                @Override
            public void actionPerformed(ActionEvent e) 
            {
               chooseFixture.setVisible(false);
            }
           });

            setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            pack();
            chooseFixture.setVisible(true);
        }
    });

      **clearButton.addActionListener(new ActionListener()
    {
        @Override
        public void actionPerformed(final ActionEvent e)
        {  
          **//THIS IS WHERE I WANT TO CLEAR THE JPANEL WHEN THIS BUTTON IS CLICKED**  
        }
   });**
}    
public static void main(String[] args) 
{
    SwingUtilities.invokeLater(new Runnable()
     {

        @Override
          public void run()
          {
            FloorPlan floorPlan = new FloorPlan();
          }

     });
}
} 
```

这是处理所有图形内容并绘制到 JPanel 上的类

```
package floorplan;

/**
*
* @author xodkx
*/

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import java.awt.image.BufferedImage;
import java.awt.event.MouseListener;

public class Floor extends JPanel implements MouseListener, MouseMotionListener
{

private static final int WIDTH = Integer.parseInt(JOptionPane.showInputDialog("Please    
                                                   enter the width of your room"));
private static final int LENGTH = Integer.parseInt(JOptionPane.showInputDialog("Please 
                                                 enter the width of your room"));
private static final Color BACKGROUND = Color.WHITE;
private static final Color INITIAL_COLOUR = Color.BLACK;
private static final Framework INITIAL_FRAMEWORK = Framework.WALL;

private MouseState state = MouseState.IDLE;
private Framework frameworkType = INITIAL_FRAMEWORK;
private Color colour = INITIAL_COLOUR;

private Point start = null;
private Point end = null;
private Point startpt = null;
private Point endpt = null;

private BufferedImage bufImage = null;

public Floor()
{
    setPreferredSize(new Dimension(LENGTH,WIDTH));
    setBackground(Color.white);
    setBorder(BorderFactory.createLineBorder (Color.black, 5));

    this.addMouseListener(this);
    this.addMouseMotionListener(this);

}

public void setColor(Color color)
{
    colour = color;

}

public void setFramework(Framework framework)
{
    frameworkType = framework;
}

@Override
public void paintComponent(Graphics g)
{
    super.paintComponent(g);
    Graphics2D g2 = (Graphics2D)g;
    g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, 
      RenderingHints.VALUE_ANTIALIAS_ON);

    if(bufImage == null)
    {
        int h = this.getHeight();
        int w = this.getWidth();
        bufImage = (BufferedImage)this.createImage(h,w);
        Graphics2D gc = bufImage.createGraphics();
        gc.setColor(BACKGROUND);
        gc.fillRect(0, 0, w, h);
    }

    g2.drawImage(bufImage,null,0,0);

    drawGrid(g2);

    if(state == MouseState.DRAGGING)
    {
        createComponent(g2);
    }
}

public void drawGrid(Graphics g2)
{
    int gridDivisions = 20;
    int divisionSize = WIDTH/gridDivisions;
    int grid = WIDTH*LENGTH;

    g2.setColor(Color.lightGray);

    for(int i=1; i<grid; i++)
    {
        int x = i * divisionSize;
        g2.drawLine(x,0,x,getSize().height);
    }

    for(int i=1; i<grid; i++)
    {
        int y = i*divisionSize;
        g2.drawLine(0,y,getSize().width,y);
    }
}

public void createComponent(Graphics2D g2)
{
    g2.setColor(colour);

    switch (frameworkType)
    {
        case WALL:
            g2.setStroke(new BasicStroke(5));
            g2.drawLine(start.x, start.y, end.x,end.y);
            break;

        case DOOR:
            g2.setStroke(new BasicStroke(5));
            g2.drawLine(start.x, start.y, end.x,end.y);
            break;

        case WINDOW:
            g2.setStroke(new BasicStroke(5));
            g2.drawLine(start.x, start.y, end.x,end.y);
            break;

        default:
            g2.drawString("test", 10, 20);
            break;
    }
}

@Override
public void mousePressed(MouseEvent e)
{
    state = MouseState.DRAGGING;
    start = e.getPoint();
    end = start;
}

@Override

public void mouseDragged(MouseEvent e)
{

    state = MouseState.DRAGGING;
    end = e.getPoint();
    this.repaint();

}

@Override
public void mouseReleased(MouseEvent e)
{
    end = e.getPoint();
    if(state == MouseState.DRAGGING)
    {
        state = MouseState.IDLE;
        createComponent(bufImage.createGraphics());
        this.repaint();
    }
}

@Override
public void mouseClicked(MouseEvent e)
{

}

@Override
public void mouseEntered(MouseEvent e)
{

}

@Override
public void mouseExited(MouseEvent e)
{

}

@Override
public void mouseMoved(MouseEvent e)
{

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T19:01:46.910

目前尚不清楚您希望如何结合显示网格的逻辑。这是一个示例，如何切换它只是为了给您一个想法。在`Floor`类`boolean`中添加控制是否显示网格的标志。然后在`Floor.paintComponent()`根据这个`boolean`标志的值绘制网格。更改标志的值应触发重绘。然后，从类中更改此标志的值`FloorPlan`，以响应操作或其他一些程序逻辑。这是一个简单的实现，在`clear`单击按钮时切换网格：

*楼层类：*

```
private boolean displayGrid = true;

public boolean isDisplayGrid() {
    return displayGrid;
}
public void setDisplayGrid(boolean displayGrid) {
    this.displayGrid = displayGrid;
    repaint();
}

@Override
public void paintComponent(Graphics g) {
    super.paintComponent(g);
    ...
    if (displayGrid)
        drawGrid(g2);
} 
```

*平面图类：*

```
clearButton.addActionListener(new ActionListener() {
    @Override
    public void actionPerformed(final ActionEvent e) {
        floor.setDisplayGrid(!floor.isDisplayGrid());
    }
}); 
```

***编辑：***

似乎我完全误解了你的问题。如果我理解正确，您想在单击按钮时清除图纸。看起来所有的图纸都是`bufImage`在`Floor`课堂上完成的。只需重置此图像，即：

*楼层类：*

```
public void clear() {
    bufImage.flush();
    bufImage = null;
    repaint();
} 
```

*平面图类：*

```
clearButton.addActionListener(new ActionListener() {
    @Override
    public void actionPerformed(final ActionEvent e) {
        floor.clear();
    }
}); 
```

# java - JPA CriteriaBuilder 加入额外的 ON 子句参数（谓词）

> ID：14691734
> 
> 赞同：1
> 
> 时间：2013-02-04T17:09:02.083
> 
> 标签：java, sql, jpa

如何加入额外的 ON 子句参数？我有一个 SQL：

```
select * from Address address left outer join  AddressLine line 
              on line.id = address.lineId AND line.type = 'MA'
where address.id = 1; 
```

我有代码：

```
CriteriaBuilder cb = em.getCriteriaBuilder();
CriteriaQuery<AddressResult> query = cb.createQuery(AddressResult.class);
Root<Address> r = query.from(Address.class);
Join<Address, AddressLineMA >linesMA= r.join(Address_.linesMajor, JoinType.LEFT); 
```

从数据库中获取数据。此查询未按预期工作我得到这样的 SQL：

```
select * from Address address left outer join  AddressLine line 
              on line.id = address.lineId 
    where address.id = 1; 
```

**AND line.type = 'MA'**缺失。有人知道如何解决这个问题吗？

我的 AddressLineMA.class 看起来像这样：

```
@Entity
@DiscriminatorValue(value = "MA")
public class AddressLineMA extends AddressLine {

}
@Entity
@Table(name = "AddressLine")
@DiscriminatorColumn(name = "TYPE", discriminatorType = DiscriminatorType.STRING)
public abstract class AddressLine {
   private Long id;
   private String type;
   private String line;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T18:58:39.350

默认情况下，JPA 查询始终返回所有子类。因此，如果您只需要 AddressLineMA 的实例，则必须将查询和关系更改为在 AddressLineMA 上，而不是在继承根类 AddressLine 上。

如果还有其他要排除的 AddressLineMA 子类，则可以使用 JPA 2.0 中添加的 TYPE 运算符：

```
 query.where(cb.equal(linesMA.type(), package.AddressLineMA.class)); 
```

不幸的是，仅在尚未发布的 JPA 2.1 规范中支持将其添加到 ON 子句中：

```
 linesMA.on(cb.equal(linesMA.type(), package.AddressLineMA.class)); 
```

# vba - 在 Excel 2010 中使用输入框复制和粘贴 - VBA

> ID：14691738
> 
> 赞同：0
> 
> 时间：2013-02-04T17:09:12.630
> 
> 标签：vba, excel, excel-2010

需要帮助。我是 VBA 的新手，并试图从简单的宏开始。但即使失败得很惨。我要做的就是使用输入框从一个工作表复制并粘贴到另一个工作表以指定要复制的范围。现在我知道输入框是：

```
Application.InputBox("Enter the range from which you want to copy : ", Type:=8) 
```

但是我需要什么行才能复制到另一个工作表中的单元格？

我提前为自己是个白痴道歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:55:35.333

这是你正在尝试的吗？

```
Option Explicit

Sub Sample()
    Dim rngCopyFrom As Range

    On Error Resume Next
    Set rngCopyFrom = Application.InputBox("Enter the range from which you want to copy", Type:=8)
    On Error GoTo 0

    If Not rngCopyFrom Is Nothing Then
        '~~> Copy the range to say Cell A1 of Sheets("weekly raw")
        rngCopyFrom.Copy ThisWorkbook.Sheets("weekly raw").Range("A1")
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T18:33:17.333

一种方法是这样的：

```
Sub CopyRange()
    Dim FromRange As Range
    Dim ToRange As Range

    Set FromRange = Application.InputBox("Enter the range from which you want to copy : ", Type:=8)
    Set ToRange = Application.InputBox("Enter the range to where you want to copy : ", Type:=8)

    FromRange.Copy ToRange
    'Or you can do it like this if you need some flexibility on Paste 
    'FromRange.Copy
    'ToRange.PasteSpecial xlPasteValues, xlPasteSpecialOperationNone
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:57:15.083

这是一些示例代码：

```
Option Explicit

Sub CopyStuff()

Dim x As Range
Dim y As Range

Set x = Application.InputBox("Select what copy using the mouse", Type:=8)
Set y = ActiveWorkbook.Sheets("Sheet2").Range("A1")

x.Copy y

End Sub 
```

# jquery - KendoUI：未调用错误 jQuery

> ID：14691739
> 
> 赞同：0
> 
> 时间：2013-02-04T17:09:13.450
> 
> 标签：jquery, kendo-ui

调用 jsonp 响应但收到错误：未调用 jQuery18207158344800118357_1359997121430。有人可以让我知道如何解决这个问题吗？感谢你的帮助。以下是客户端代码：

```
var dataSource = new kendo.data.DataSource({
serverPaging: true,
                    pageSize: 2,
                    type: "odata",
                    error: function(e) {
                        console.log("Error " + e);
                        alert(e.errorThrown);
                    },
                    transport: {
                        read: {
                            url: "http://localhost:50675/movie/GetAll", // the remove service url
                            dataType: "jsonp"
                        },
                        parameterMap: function(options) {
                            alert("Inside parameterMap")
                            alert(JSON.stringify(options, null, 4));
                            return {
                                q: "javascript",
                                page: options.page,
                                rpp: options.pageSize,
                            };
                        }
                  },
                  schema: {
                         errors: function(response) {
                            return response.errors;
                        },
                        data: function(data) {
                             if (data.movieList.length == 0) {
                                return [];
                             }
                            return data.movieList;
                        },
                        total: function(data) {
                            alert(data.movieList.length);
                            return data.movieList.length;
                        }
                   }
            });

            $("#localListView").kendoMobileListView({
                dataSource: dataSource,
                pullToRefresh: true,
                appendOnRefresh: true,
                template: $("#categories-template").html(),
                pullParameters: function(item) {
                    alert("Inside pullParameters")
                    alert(item.length);
                    alert(JSON.stringify(item, null, 4));
                    return {
                        page: 1
                    };
                }
            }); 
```

在 Chrome 开发人员工具中检查时，成功接收到来自服务器的响应。以下是来自服务器的 jsonp 响应：

({"movieList":[{"ID":1,"Title":"Movie","ReleaseDate":"/Date(487189800000)/","Genre":"Comedy","Price":30}, {"ID":1,"Title":"Movie","ReleaseDate":"/Date(487189800000)/","Genre":"Comedy","Price":30}],"count":4} )

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T21:57:42.293

It seems to me that your JSONP is not complete, I think it should be something like:

```
jQuery18207158344800118357_1359997121430({"movieList":[{"ID":1,"Title":"Movie","ReleaseDate":"\/Date(487189800000)\/","Genre":"Comedy","Price":30},{"ID":1,"Title":"Movie","ReleaseDate":"\/Date(487189800000)\/","Genre":"Comedy","Price":30}],"count":4}); 
```

Where `jQuery18207158344800118357_1359997121430` is variable and you will receive it as `$callback` request parameter.

# ruby-on-rails - NGINX CONF 与 LINODE 上的 RAILS

> ID：14691742
> 
> 赞同：0
> 
> 时间：2013-02-04T17:09:16.427
> 
> 标签：ruby-on-rails, ruby, nginx, capistrano, unicorn

这是我的**nginx.conf**文件

```
upstream unicorn {
  server unix:/tmp/unicorn.blog.sock fail_timeout=0;
}

server {
  listen 80 default deferred;
# server_name example.com;
  root /home/deployer/apps/blog/current/public;

  location ^~ /assets/ {
    gzip_static on;
    expires max;
    add_header Cache-Control public;
  }

  try_files $uri/index.html $uri @unicorn;
  location @unicorn {
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header Host $http_host;
    proxy_redirect off;
    proxy_pass http://unicorn;
  }

  error_page 500 502 503 504 /500.html;
  client_max_body_size 4G;
  keepalive_timeout 10;
} 
```

我尝试添加 SSL - 我重新部署并重新启动了 NGINX 和服务器。我撤消了重新部署的所有内容，它已备份....现在我尝试了同样的事情。尝试添加 SSL 失败。解开。现在服务器宕机了。[这](https://github.com/Ruekompa/blog)是带有修订的github！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:25:42.023

跑 /etc/init.d/unicorn_blog start 并重新启动独角兽。有效

# macos - Mac OS X 应用程序文件权限

> ID：14691744
> 
> 赞同：1
> 
> 时间：2013-02-04T17:09:26.007
> 
> 标签：macos, permissions, umask

我们的程序创建了它需要读取和写入的各种设置文件。但是，如果 OS X 用户有一个全局 umask 集，这样在没有写入权限的情况下创建文件，我们的应用程序就无法写入它们。

要求：

1.  要求用户更改全局 umask 不是一种选择。
2.  我们的应用程序应该创建每个人都可以读/写的文件。

我曾想过创建一个 bash 脚本，该脚本设置`umask 000`然后启动是真正的可执行文件。然后，我们将 bash 脚本设置为我们的应用程序包 info.plist 中的可执行文件。

有没有人知道解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:15:35.083

Yon 可以`umask()`直接从您的代码中调用。`umask()`是一个 Unix 的系统调用，它完全符合您的需要。第 2 节中的RTFM `umask`。

# ember.js - 回滚父记录不会删除子记录

> ID：14691745
> 
> 赞同：5
> 
> 时间：2013-02-04T17:09:31.830
> 
> 标签：ember.js, ember-data

回滚父记录似乎不会删除可能已添加到其中的任何新子记录。不确定这是错误还是功能。

```
App.Company = DS.Model.extend({
  name: DS.attr('string'),
  employees: DS.hasMany('App.Employee')
});

App.Employee = DS.Model.extend({
  name: DS.attr('string'),
  company: DS.belongsTo('App.Company')
})

var company = App.Company.find(1);
//Initially: company.get('employees.length') => 0

var employee = company.get('employees').createRecord();
//Now: company.get('employees.length') => 1

employee.get('transaction').rollback();
//Still: company.get('employees.length') =>1
//Also: employee.get('isDeleted') => true

company.get('transaction').rollback();
//Even now: company.get('employees.length') =>1

//How do I rollback such that company.get('employees.length') == 0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-17T04:35:18.763

我的应用程序中有一个 rollbackAll() 方法，它使用 get 和 promises 进行深度优先遍历，然后在回滚父级之前将它们全部回滚。它看起来像这样：

```
rollbackAll: function() {
  // recursively rollback on all children and self
  this.get('children').then(function (children) {
    children.forEach(function(child) {
      child.rollbackAll();
    });
  });
  this.rollback();
} 
```

我应该提到那是因为我的应用程序中碰巧有递归关系（即对象树，每个对象都可以有自己的父对象）。

这里的模式是每个模型“类”都可以获得自己的 rollbackAll 方法，它知道如何回滚自己的关联，然后只需在每个模型上调用 rollbackAll() 即可。（如果您有多个级别，则首先是最深的孩子）。

# wordpress - Wordpress InnoDB 和 MyISAM 表

> ID：14691747
> 
> 赞同：2
> 
> 时间：2013-02-04T17:09:38.783
> 
> 标签：wordpress, innodb, myisam

我正在尝试解决大型 wordpress 安装（大约 600K 帖子）上的一些严重问题，并注意到 wp_posts 表是 INNODB 但 wp_posts_meta 是 MyISAM

对我来说看起来有点奇怪。

任何人都知道此表引擎配置可能存在的问题，尤其是具有不同引擎的表之间的连接？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:05:46.253

我只知道混合 innodb 和 myisam 时事务可能会中断。在您的情况下，这没问题，因为 wordpress 没有使用事务。但是，将帖子表设​​置为 innodb 是一个奇怪的选择。混合类型可能是有益的，因为 myisam 在不经常更改的表上往往更快。当 myisam 表上的一行被更新时，整个表被锁定，而 innodb 只是锁定该行。

post表就是这样一个表（偶尔写，读很多次）。但是您的设置似乎相反。这不是一个大问题，但是通过保留该表 innodb 并没有获得任何好处。

关于您的问题：由于您没有具体说明您的问题是什么，因此我不能说它们听起来是否相关。但我猜这不是罪魁祸首。

免责声明：如果配置正确，很多人声称 innodb 和 myisam 一样快。可能是这样，但是周围没有很多配置良好的设置，更不用说知道如何针对给定任务优化 mysql 的人了。还有很多人在共享主机上，或者无法自己更改设置。对于他们来说，将表切换到 innodb（或其他方式）可以工作。

# orchardcms - 如何从 Orchard 的后台任务中更新内容项（草稿）？

> ID：14691748
> 
> 赞同：4
> 
> 时间：2013-02-04T17:09:40.697
> 
> 标签：orchardcms, background-process

我有一个简单的`IBackgroundTask`实现，它执行查询，然后根据特定项目是否存在执行插入或一个或多个更新。但是，*更新*没有持久化，我不明白为什么。*新项目*按预期创建。

我正在更新的内容项有一个`CommonPart`，并且我尝试过以有效用户身份进行身份验证。我还尝试在`Sweep`方法结束时刷新内容管理器。我错过了什么？

这是我的`Sweep`，为简洁起见略作编辑：

```
public void Sweep()
{
    // Authenticate as the site's super user
    var superUser = _membershipService.GetUser(_orchardServices.WorkContext.CurrentSite.SuperUser);
    _authenticationService.SetAuthenticatedUserForRequest(superUser);

    // Create a dummy "Person" content item
    var item = _contentManager.New("Person");
    var person = item.As<PersonPart>();
    if (person == null)
    {
        return;
    }
    person.ExternalId = Random.Next(1, 10).ToString();
    person.FirstName = GenerateFirstName();
    person.LastName = GenerateLastName();

    // Check if the person already exists
    var matchingPersons = _contentManager
        .Query<PersonPart, PersonRecord>(VersionOptions.AllVersions)
        .Where(record => record.ExternalId == person.ExternalId)
        .List().ToArray();
    if (!matchingPersons.Any())
    {
        // Insert new person and quit
        _contentManager.Create(item, VersionOptions.Draft);
        return;
    }

    // There are at least one matching person, update it
    foreach (var updatedPerson in matchingPersons)
    {
        updatedPerson.FirstName = person.FirstName;
        updatedPerson.LastName = person.LastName;
    }

    _contentManager.Flush();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:52:22.077

尝试添加`_contentManager.Publish(updatedPerson)`. 如果您不想发布，而只是为了保存，则无需执行任何其他操作，因为 Orchard 中的更改会自动保存，除非环境事务被中止。`Flush`根本不需要调用 to 。在常规请求和后台任务中都是这种情况。

# unit-testing - 按顺序运行 TestNG 组并在每个组中并行测试

> ID：14691756
> 
> 赞同：1
> 
> 时间：2013-02-04T17:10:07.067
> 
> 标签：unit-testing, automated-tests, integration-testing, testng

我有几个基于他们测试的功能的测试套件，我想并行运行它们 - 以更快地完成。事实证明，在一个套件中，我需要放置几个针对不同环境设置运行的测试。我想我可以通过将测试分配给组来做到这一点，然后使用 @BeforeGroups 注释插入一个设置环境设置的方法。但是我不知道如何使每个组内的测试并行运行，并使组相互等待 - 否则会有测试在错误的环境中工作。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T12:55:11.113

您可以在 xml.xml 中定义组的依赖关系。[这里的](http://testng.org/doc/documentation-main.html#dependencies-in-xml)例子

# php - 无法在 cakephp 中使用带有 $i 的 if 语句

> ID：14691757
> 
> 赞同：0
> 
> 时间：2013-02-04T17:10:17.197
> 
> 标签：php, cakephp, file-upload, if-statement, cakephp-2.0

我目前正在尝试学习[教程](http://www.tuxradar.com/content/cakephp-tutorial-build-file-sharing-application)，并且已经到达使用 if 语句的部分，该语句将向我显示我存储在文件夹中的所有可能的可下载数据。

但是我遇到的问题是 if 语句，它一直告诉我`Undefined variable: i`在这个 if 语句中有一个 ..

```
<p>Welcome <?php print $this->Session->read('Auth.User.name');
echo ' ';
echo $this->Html->link('Logout', array('controller' => 'Users', 'action' => 'logout'));?> </p>
<dt> <?php if ($i % 2 == 0) echo $class; ?> <?php __('Download'); ?></dt>
<dd> <?php if ($i++ % 2 == 0) echo $class; ?> 
<?php echo $this->Html->link(__('Download', true), array('action' => 'download', $upload['Upload']['uploadID'])); ?>
</dd> 
```

这是控制器中的下载功能：

```
function download($id = null) {
        if (!$id) {
            $this->Session->setFlash(__('Invalid id for upload', true));
            $this->redirect(array('action' => 'view'));
        }
        $this->Upload->bindModel(array('hasOne' => array('UploadsUser')));
        $upload = $this->Upload->find('first', array(
            'conditions' => array(
                'Upload.uploadID' => $id,
                'OR' => array(),
                                 )
                                                    ));
        if (!$upload) 
            {
            $this->Session->setFlash(__('Invalid id for upload', true));
            $this->redirect(array('action' => 'view'));
            }
        $this->view = 'media';
        $filename = $upload['Upload']['fileName'];
        $this->set(array(
            'id' => $upload['Upload']['uploadID'],
            'name' => substr($filename, 0, strrpos($filename, '.')),
            'extension' => substr(strrchr($filename, '.'), 1),
            'path' => APP . 'uploads' . DS,
            'download' => true,
        ));
    } 
```

我也知道在 if 语句中应该是 =、== 或 ===，但出于某种原因，在本教程中他使用了 % ? 如果您还可以解释为什么使用它，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:14:53.977

您需要`$i`使用一些值进行初始化，例如，`$i = 10;`或者`$i = 0;`但似乎`$i`是先前操作的结果，请检查未定义的原因。

% 是模数（除法的其余部分）。更多信息：[http ://www.php.net/manual/en/language.operators.arithmetic.php](http://www.php.net/manual/en/language.operators.arithmetic.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:15:00.060

尝试用 ($i+1) 替换 $i++

% 是除法的其余部分。

例如：5%2=1（5/2=4，其余为 1）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:17:08.983

好吧，`$i`真的没有定义，所以你得到了那个消息。你可能忘了设置它`$i = 0;`

该`%`运算符称为[模数](http://www.php.net/manual/en/language.operators.arithmetic.php)并返回 的余数`$i/2`，因此您的表达式在偶数时为真，在`$i`不偶数时为假`$i`。

在大多数 if 语句中，您只使用`==`或更严格的`===`. 使用`=`通常是一个错误，大多数 IDE 都会警告您。

# c# - 设置标签边框的大小

> ID：14691758
> 
> 赞同：0
> 
> 时间：2013-02-04T17:10:16.823
> 
> 标签：c#, winforms, label, border

我制作了一个由 9 x 9 个标签组成的网格，每个标签都有一个边框。在一行/列中的每 3 个标签之后，我希望边框比之前的更厚。我找不到添加这种大小的边框的方法。

我在谷歌上搜索，但找不到任何有用的东西。

谁能帮我？

```
 private void AddNodesToGrid()
{
  pnlGrid.Controls.Clear();
  rooster = new NewLabel[9, 9];
  int Xpos = 0;
  int Ypos = 0;
  for (int I = 0; I < 9; I++)
  {
    for (int T = 0; T < 9; T++)
    {
      rooster[I, T] = new NewLabel(new Node());
      rooster[I, T].Left = Xpos;
      rooster[I, T].Top = Ypos;
      rooster[I, T].Width = 30;
      rooster[I, T].Height = 30;
      rooster[I, T].BorderStyle = BorderStyle.FixedSingle;
      rooster[I, T].TextAlign = ContentAlignment.MiddleCenter;
      pnlGrid.Controls.Add(rooster[I, T]);
      Xpos += 30;
    }
    Xpos = 0;
    Ypos += 30;
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:26:35.957

如果是我，我更喜欢自己画桌子。但是如果你需要使用你的标签，我建议你自己画边界：

```
public class NewLabel : Label
{
    //...

    private int _borderWidth = 1;
    public int BorderWidth
    {
        get { return _borderWidth; }
        set
        {
            _borderWidth = value;
            Invalidate();
        }
    }

    private Color _borderColor = Color.Black;
    public Color BorderColor
    {
        get { return _borderColor; }
        set
        {
            _borderColor = value;
            Invalidate();
        }
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        base.OnPaint(e);

        int xy = 0;
        int width = this.ClientSize.Width;
        int height = this.ClientSize.Height;
        Pen pen = new Pen(_borderColor);
        for (int i = 0; i < _borderWidth; i++)
            e.Graphics.DrawRectangle(pen, xy + i, xy + i, width - (i << 1) - 1, height - (i << 1) - 1);
    }
} 
```

现在您的`NewLabel`类具有您可以设置`BorderWidth`的`BorderColor`属性。

（注：我以前画边框的方法是最快的。创建一个需要宽度的笔效果不好，因为GDI+把线的中心放在指定的坐标上。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:54:10.863

实现此目的的更好方法是使用嵌套的`TableLayoutPanel`. 从设计师那里创建它并将您的标签放在里面。脚步 ：

*   放置一个 3x3 `TableLayoutPanel`（父面板）。
*   在父面板的每个单元格中放置一个 3x3 `TableLayoutPanel`（子面板）。
*   为父表和子表设置`CellBorderStyle`为`Single`。
*   将`Margin`子表设置为`0,0,0,0`.

你会得到这样的效果：

![在此处输入图像描述](../Images/fa6b500deaf8ae56df2d0688597bb395.png)

# .htaccess - 将根目录下的html文件重写到目录

> ID：14691760
> 
> 赞同：0
> 
> 时间：2013-02-04T17:10:24.320
> 
> 标签：.htaccess, mod-rewrite, url-rewriting

嗨，我需要一些帮助。问题：我现在使用 CMS 使我的网站成为多语言的，它处理 index.php 中的所有内容我正在尝试重定向所有从 root 访问的 .html 页面，例如

[http://www.website.com/englishpage.html](http://www.website.com/englishpage.html) 我想把它重定向到 [http://www.website.com/en/englishpage.html](http://www.website.com/en/englishpage.html)

然后二次重定向将剖析该信息并将其发送到 index.php，然后它将提供正确的页面。

现在，我收到太多重定向错误

```
# The Friendly URLs part
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*\.html)$ en/$1\.html [R=301,L]
RewriteRule ^(en|ru)?(\/)?(.*)$ index.php?c=$1&q=$3 [L,QSA] 
```

我在这里做错了什么

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:07:01.843

`(.*\.html)`不够具体，因此也匹配`/en/englishpage.html`. 它还不断添加`.html`到结尾。

所以`/englishpage.html`重定向到`/en/englishpage.html.html`，重定向到`/en/en/englishpage.html.html.html`等等。

要解决这两个问题：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^/]+)\.html$ en/$1\.html [R=301,L]

RewriteRule ^((en|ru)/)?(.*)$ index.php?c=$1&q=$3 [L,QSA] 
```

PS没必要逃了`/`

# android - 图标集可见复制菜单

> ID：14691761
> 
> 赞同：1
> 
> 时间：2013-02-04T17:10:24.350
> 
> 标签：android, android-actionbar, actionbarsherlock

在我的操作栏中，我有 2 个菜单项：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:id="@+id/refresh"
          android:title="Refresh"
          android:icon="@drawable/refresh"
          android:showAsAction="ifRoom" >
    </item>
    <item android:id="@+id/back"
          android:title="Back"
          android:icon="@drawable/back"
          android:showAsAction="ifRoom" >
    </item>
</menu> 
```

我试图将我的菜单项“Refresh”变为“不可见”，当我调用函数 refreshinvisible() 时，Refresh 项消失了，但现在操作栏显示了两个“后退”项……为什么？（我正在使用 SherlockActionBar）

我的 refreshinvisible() 函数：

```
public void refreshinvisible(){
        MenuItem item = menu.findItem(R.id.refresh);
        item.setVisible(false);
} 
```

有人知道如何进行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:05:45.890

你可以阅读[这个](http://developer.android.com/guide/topics/ui/menus.html)。

**在运行时更改菜单项**

> 活动创建后，onCreateOptionsMenu() 方法只被调用一次，如上所述。系统保留并重复使用您在此方法中定义的菜单，直到您的活动被销毁。如果您想在第一次创建选项菜单后随时更改它，您必须重写 onPrepareOptionsMenu() 方法。这会将当前存在的 Menu 对象传递给您。如果您想根据应用程序的当前状态删除、添加、禁用或启用菜单项，这将非常有用。

例如

```
@Override
public boolean onPrepareOptionsMenu(Menu menu) {
     super.onPrepareOptionsMenu(menu);
     MenuItem item = menu.findItem(R.id.refresh);
     item.setVisible(false);
     return true;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T21:14:46.877

有一个名为[onPrepareOptionsMenu()](http://developer.android.com/reference/android/app/Fragment.html#onPrepareOptionsMenu%28android.view.Menu%29)的方法，每次在菜单显示之前调用它，即*在调用* [onCreateOptionsMenu()](http://developer.android.com/reference/android/app/Activity.html#onCreateOptionsMenu%28android.view.Menu%29)之前。您可以使用活动的[invalidateOptionsMenu()](http://developer.android.com/reference/android/app/Activity.html#invalidateOptionsMenu%28%29)方法来触发选项菜单的重绘。因此，您可以轻松地在考虑某些条件的情况下重新创建菜单。

这是一些代码。定义两个布尔值作为类的字段，例如：

```
private boolean showRefresh;
private boolean showBack; 
```

覆盖该`onPrepareOptionsMenu()`方法并根据相应的设置菜单项的可见性`boolean`：

```
@Override
public boolean onPrepareOptionsMenu( Menu menu ) {

    super.onPrepareOptionsMenu( menu );

    menu.findItem( R.id.refresh ).setVisible( showRefresh );
    menu.findItem( R.id.back ).setVisible( showBack );

    return true;
} 
```

不，每次您想更改某个菜单项的可见性时，相应地设置相应的`boolean`并调用该`invalidateOptionsMenu()`方法。

# ruby-on-rails - 计费系统的故障保护？

> ID：14691764
> 
> 赞同：1
> 
> 时间：2013-02-04T17:10:39.290
> 
> 标签：ruby-on-rails, billing

我目前有一个计费系统，其中每晚脚本检查从脚本运行之日起一个月到期的订阅，例如：

```
 Subscription.where(:expires => (Date.today + 30.days)).find_each do |sub|
  unless sub.month_reminder_sent
    reminder.total += 1
    reminder.subscriptions << sub
    BillingMailer.monthly_reminder(sub.user).deliver
    sub.month_reminder_sent = true
  end 
```

我还有另一套要在到期前一周运行。如果未续订，则子会自动过期（我只是检查`sub.expiry_date`尚未通过以检查子是否处于活动状态）。

如果服务器停机，我需要采取哪些应急措施？或者脚本没有运行或失败？（因此缺少一些记录。）

以上甚至是进行计费的最佳方式吗？还是我不必要地担心，以上就足够了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T21:00:01.970

在您的模型中添加另一个日期列（即已处理的日期），您需要在检查期间对其进行更新，然后向您的脚本添加一个附加条件，该条件将处理所有过期记录+这些之前未处理的记录。如果服务器关闭或脚本未正确执行 - 您将在下次处理丢失的记录。还要考虑一些报告，即：处理的记录数、先前运行处理的记录数等。

# android - Android debug.keystore 问题

> ID：14691767
> 
> 赞同：1
> 
> 时间：2013-02-04T17:10:51.247
> 
> 标签：android

我在为我正在开发的应用程序生成我的 SHA1 时遇到了一个小问题（请理解我对 android 开发真的很陌生）。我在 win 7 上使用 ECLIPSE，并且 .android/debug.keystore 文件似乎已正确生成...关键是：当我通过 Windows 控制台在 c:\Users\myUser.android 内导航时，我尝试运行以这种方式归档：

```
c:\Users\myUser\.android>debug.keystore 
```

当我按下提交时，它打开“不可能打开文件”窗口，它要求我选择一个程序，本地或互联网上，以便能够运行文件..

我知道这是非常简单的操作，但我对此很生气......我做错了什么？

谢谢你们

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T12:39:27.387

解决了！prosper 的答案其实是对的，我应该在包含 keytool 的 JDK 文件夹中执行 keytool 命令... 非常感谢大家

```
C:\Program Files\Java\jdk1.7.0_09\bin>keytool -list -v -keystore "C:\Users\your_user_name\.android\debug.keystore" -alias androiddebugkey -storepass android -keypass android 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-06T07:45:36.557

更准确地说是这样

keytool -exportcert -alias androiddebugkey -keystore C:\Users\your_account_name.android\debug.keystore | C:\OpenSSL\bin\openssl sha1 -binary | C:\OpenSSL\bin\openssl base64

您必须下载 OpeSSL 并解压到一个文件夹中，我的是 C:\OperSSL 在 JDK bin 文件夹中执行此代码

# mysql - MySQL：分表后测试性能

> ID：14691771
> 
> 赞同：0
> 
> 时间：2013-02-04T17:10:58.533
> 
> 标签：mysql, sql, performance, indexing

我做了一个测试，看看划分索引大表是否会提高性能。

原始表：20000 行。子表：4x5000 行。

主表分为4张表，所有表都有索引，在测试中每个sql查询循环执行10000次，以测量更准确的查询次数。

当我在表中搜索索引列时，我发现性能没有差异，原始（20000 行）表和新（5000 行）表的查询时间相同。

我通过删除所有表的索引尝试了相同的测试，没有索引，性能差异很明显，在子表中搜索比在大表中搜索快 6 倍。但是索引的性能是相同的。

所以你认为把我的桌子分成更小的桌子是浪费时间吗？

注意：20000大小只是为了测试，我的真实数据会在100M以上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T22:23:58.747

您实际上所做的是重新发明了[Partitioning of Tables](http://dev.mysql.com/doc/refman/5.1/en/partitioning-overview.html)。我不会使用您自己的子表方案，而专注于使用分区表将自动意味着使用内部子表，如果您适当地制定 SQL，如果不需要，子表将自动从操作中排除。

但是，所有分区的管理都将在服务器本身上进行，因此您的客户端代码可以保持简单，您仍然只需要处理单个表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:41:00.740

是的，这是浪费时间。数据库可以轻松处理数百万行，而 20,000 行相对较小。正如您所注意到的，索引可以快速查找数据。在大多数情况下，数据的大小不会显着影响查找速度。如果大小差异为 100 或 1000 倍，则查询可能需要几毫秒，但您正在处理的规模不会产生真正的差异。

# node.js - 带有 node.js 绑定的磁盘查找表

> ID：14691772
> 
> 赞同：1
> 
> 时间：2013-02-04T17:11:01.160
> 
> 标签：node.js, key-value, lookup-tables

对于一个项目，我正在创建一个排队库，并且基本上将 URL 存储在一个 Set 中（它实际上是一个对象，我将键设置为 true，但可以将其视为一个数组），因此队列只接受每个 url 一次。这工作得很好，但是我面临的问题是有很多 URL，因此 RAM 使用率变得非常高。

因此我想使用磁盘键值存储（实际上只需要键，不知道是否有一些不同的方法）具有以下要求：

*   无需将整个数据集加载到 RAM 中
*   快速查找
*   Node.js 绑定

它不必太安全（偶尔丢失数据不是一个大问题，低 RAM 要求更重要），即使我在这种情况下使用 Node.JS，这个查找也不一定需要运行异步的。

实际上，一个附带问题是是否有比磁盘键值方法更好的方法。一个术语会很好。Lookuptables 总能让我找到数据集（IP、邮政编码等）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-18T06:47:41.250

如果它真的“不必太安全”，另一种设计是继续将所有内容存储在内存中，但限制您存储的 URL 数量，例如使用 LRU 缓存。

[您可以使用 node.js 中的缓存（通过 Google](https://www.google.com/search?q=node.js+lru)很容易找到）或使用单独的 memcached 服务器，可能在同一台机器上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:56:52.223

我会使用带有单列的 sql 表（存储 url）。比 redis 更好地控制内存使用（几乎所有内容都存储在内存中）。

*   易于检查是否已经存在相同的值
*   易于插入
*   轻松移除一个元素

# c++ - C++ 11 unordered_map 分段错误

> ID：14691781
> 
> 赞同：1
> 
> 时间：2013-02-04T17:11:26.090
> 
> 标签：c++, multithreading, concurrency, segmentation-fault, unordered-map

因此，当我使用多个线程运行此程序时，我不断遇到分段错误：

```
class InvertedIndex {
private:
    unordered_map<string, Details> index;
    mutex indexInsert;

public:
  void addTerms(pair<string, list<string>> parsedReport) {
    unordered_map<string, Details>::iterator indexIterator;

        for (auto term = parsedReport.second.begin(); term != parsedReport.second.end(); ++term) {
            indexInsert.lock();
            indexIterator = index.find(*term);

            if (indexIterator == index.end()) {
                Details details;
                details.addOccurrence(parsedReport.first);
                index.insert(pair <string, Details> (*term, details));
            } else
                indexIterator->second.addOccurrence(parsedReport.first);

            indexInsert.unlock();
        }
    }
} 
```

当我使用 GDB 调试程序时，它告诉我问题出在 index.find(*term) 上，这与散列有关。当我用一个我觉得奇怪的线程运行它时它运行良好，因为我在它周围有锁。

* * *

编辑：这是所要求的堆栈跟踪：

```
Using host libthread_db library "/lib64/libthread_db.so.1".
[New Thread 0x7ffff75de700 (LWP 3842)]
[New Thread 0x7ffff6ddd700 (LWP 3843)]
[New Thread 0x7ffff65dc700 (LWP 3844)]
[New Thread 0x7ffff5ddb700 (LWP 3845)]
[New Thread 0x7ffff55da700 (LWP 3846)]
[New Thread 0x7ffff4dd9700 (LWP 3847)]
[New Thread 0x7ffff45d8700 (LWP 3848)]
[New Thread 0x7ffff3dd7700 (LWP 3849)]

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0x7ffff65dc700 (LWP 3844)]
0x000000000041c8bf in std::__detail::_Hash_code_base<std::string, std::pair<std::string const, Details>, std::_Select1st<std::pair<std::string const, Details> >, std::hash<std::string>, std::__detail::_Mod_range_hashing, std::__detail::_Default_ranged_hash, true>::_M_bucket_index (this=0x7fffffffde10, __p=0xc0, __n=467) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/bits/hashtable_policy.h:793
793       { return _M_h2()(__p->_M_hash_code, __n); }
(gdb) bt
#0  0x000000000041c8bf in std::__detail::_Hash_code_base<std::string, std::pair<std::string const, Details>, std::_Select1st<std::pair<std::string const, Details> >, std::hash<std::string>, std::__detail::_Mod_range_hashing, std::__detail::_Default_ranged_hash, true>::_M_bucket_index (this=0x7fffffffde10, __p=0xc0, __n=467)
    at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/bits/hashtable_policy.h:793
#1  0x0000000000419591 in std::_Hashtable<std::string, std::pair<std::string const, Details>, std::allocator<std::pair<std::string const, Details> >, std::_Select1st<std::pair<std::string const, Details> >, std::equal_to<std::string>, std::hash<std::string>, std::__detail::_Mod_range_hashing, std::__detail::_Default_ranged_hash, std::__detail::_Prime_rehash_policy, true, false, true>::_M_bucket_index (
    this=0x7fffffffde10, __n=0xc0) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/bits/hashtable.h:461
#2  0x000000000041561c in std::_Hashtable<std::string, std::pair<std::string const, Details>, std::allocator<std::pair<std::string const, Details> >, std::_Select1st<std::pair<std::string const, Details> >, std::equal_to<std::string>, std::hash<std::string>, std::__detail::_Mod_range_hashing, std::__detail::_Default_ranged_hash, std::__detail::_Prime_rehash_policy, true, false, true>::_M_find_before_node (
    this=0x7fffffffde10, __n=57, __k="bypass", __code=1325113244381254371) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/bits/hashtable.h:1081
#3  0x0000000000410672 in std::_Hashtable<std::string, std::pair<std::string const, Details>, std::allocator<std::pair<std::string const, Details> >, std::_Select1st<std::pair<std::string const, Details> >, std::equal_to<std::string>, std::hash<std::string>, std::__detail::_Mod_range_hashing, std::__detail::_Default_ranged_hash, std::__detail::_Prime_rehash_policy, true, false, true>::_M_find_node (
    this=0x7fffffffde10, __bkt=57, __key="bypass", __c=1325113244381254371) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/bits/hashtable.h:478
#4  0x000000000040c9e6 in std::_Hashtable<std::string, std::pair<std::string const, Details>, std::allocator<std::pair<std::string const, Details> >, std::_Select1st<std::pair<std::string const, Details> >, std::equal_to<std::string>, std::hash<std::string>, std::__detail::_Mod_range_hashing, std::__detail::_Default_ranged_hash, std::__detail::_Prime_rehash_policy, true, false, true>::find (this=0x7fffffffde10, __k=
    "bypass") at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/bits/hashtable.h:939
#5  0x0000000000408e50 in InvertedIndex::addTerms (this=0x7fffffffdd00, parsedReport=...) at InvertedIndex.hpp:83
#6  0x00000000004091f2 in InvertedIndex::addReport (this=0x7fffffffdd00, fileName="/home/brodie/workspace/inverted_index/resources/test_reports/report6.xml") at InvertedIndex.hpp:104
#7  0x0000000000409e26 in InvertedIndex::loadIndex()::{lambda()#1}::operator()() const (__closure=0x6448e0) at InvertedIndex.hpp:169
#8  0x0000000000425128 in std::_Function_handler<void (), InvertedIndex::loadIndex()::{lambda()#1}>::_M_invoke(std::_Any_data const&) (__functor=...)
    at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/functional:1926
#9  0x0000000000426ba4 in std::function<void ()>::operator()() const (this=0x6448b0) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/functional:2311
#10 0x0000000000426df1 in std::__invoke<std::function<void ()>>(std::function<void ()>&) (__f=...) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/functional:235
#11 0x0000000000426dc6 in std::reference_wrapper<std::function<void ()> >::operator()<>() const (this=0x7ffff65dbcc0) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/functional:468
#12 0x0000000000426cc2 in std::_Bind_simple<std::reference_wrapper<std::function<void ()> > ()>::_M_invoke<>(std::_Index_tuple<>) (this=0x7ffff65dbcc0)
    at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/functional:1598
#13 0x0000000000426a3b in std::_Bind_simple<std::reference_wrapper<std::function<void ()> > ()>::operator()() (this=0x7ffff65dbcc0)
    at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/functional:1586
#14 0x0000000000426717 in std::_Function_handler<void (), std::reference_wrapper<std::_Bind_simple<std::reference_wrapper<std::function<void ()> > ()> > >::_M_invoke(std::_Any_data const&) (__functor=...)
    at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/functional:1956
#15 0x0000000000426ba4 in std::function<void ()>::operator()() const (this=0x7fffd40008c8) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/functional:2311
#16 0x000000000042681e in std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>, std::__future_base::_Result_base::_Deleter>, void>::operator() (this=0x7fffd40008c0)
    at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/future:1236
#17 0x0000000000426587 in std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> (), std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>, std::__future_base::_Result_base::_Deleter>, void> >::_M_invoke(std::_Any_data const&) (__functor=...) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/functional:1912
#18 0x000000000040bde5 in std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>::operator()() const (this=0x7ffff65dbce0)
#19 0x0000000000408568 in std::__future_base::_State_base::_M_do_set(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>&, bool&) (this=0x644838,
    __f=..., __set=@0x7ffff65dbc1f: false) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/future:473
#20 0x000000000041b403 in std::_Mem_fn<void (std::__future_base::_State_base::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>&, bool&)>::operator()(std::__future_base::_State_base*, std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>&, bool&) const (this=0x7ffff65dbba8, __object=0x644838,
    __args#0=..., __args#1=@0x7ffff65dbc1f: false) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/functional:554
#21 0x00000000004184fb in std::_Bind_simple<std::_Mem_fn<void (std::__future_base::_State_base::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>&, bool&)> (std::__future_base::_State_base*, std::reference_wrapper<std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()> >, std::reference_wrapper<bool>)>::_M_invoke<0ul, 1ul, 2ul>(std::_Index_tuple<0ul, 1ul, 2ul>) (this=0x7ffff65dbb90) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/functional:1598
#22 0x000000000041429f in std::_Bind_simple<std::_Mem_fn<void (std::__future_base::_State_base::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>&, bool&)> (std::__future_base::_State_base*, std::reference_wrapper<std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()> >, std::reference_wrapper<bool>)>::operator()() (this=0x7ffff65dbb90) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/functional:1586
#23 0x000000000040fa7f in std::__once_call_impl<std::_Bind_simple<std::_Mem_fn<void (std::__future_base::_State_base::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>&, bool&)> (std::__future_base::_State_base*, std::reference_wrapper<std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()> >, std::reference_wrapper<bool>)> >() () at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/mutex:787
#24 0x00000036e920cac0 in pthread_once () at ../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_once.S:103
#25 0x0000000000404266 in __gthread_once (__once=0x6448a4, __func=0x403eb0 <__once_proxy@plt>) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/x86_64-redhat-linux/bits/gthr-default.h:718
#26 0x000000000040bc8d in std::call_once<void (std::__future_base::_State_base::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>&, bool&), std::__future_base::_State_base* const, std::reference_wrapper<std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()> >, std::reference_wrapper<bool> >(std::onc---Type <return> to continue, or q <return> to quit---
e_flag&, void (std::__future_base::_State_base::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>&, bool&), std::__future_base::_State_base* const&&, std::reference_wrapper<std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()> >&&, std::reference_wrapper<bool>&&) (__once=...,
    __f=<unknown type in /home/brodie/workspace/inverted_index/src/InvertedIndexMain, CU 0x0, DIE 0x3f48a>) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/mutex:819
#27 0x0000000000408333 in std::__future_base::_State_base::_M_set_result(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>, bool) (this=0x644838, 
    __res=..., __ignore_failure=false) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/future:362
#28 0x0000000000425f92 in std::__future_base::_Task_state<void ()>::_M_run() (this=0x644838) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/future:1271
#29 0x0000000000425c9c in std::packaged_task<void ()>::operator()() (this=0x644928) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/future:1379
#30 0x0000000000425ad8 in any_packaged<void>::execute (this=0x644920) at ThreadPool.hpp:27
#31 0x0000000000408743 in any_packaged_task::operator() (this=0x7ffff65dbdd0) at ThreadPool.hpp:40
#32 0x0000000000404baf in Worker::operator() (this=0x641120) at ThreadPool.hpp:109
#33 0x0000000000426068 in std::_Bind_simple<Worker ()>::_M_invoke<>(std::_Index_tuple<>) (this=0x641120) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/functional:1598
#34 0x0000000000425cb9 in std::_Bind_simple<Worker ()>::operator()() (this=0x641120) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/functional:1586
#35 0x0000000000425af6 in std::thread::_Impl<std::_Bind_simple<Worker ()> >::_M_run() (this=0x641108) at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/thread:115
#36 0x00000036ec6b2a20 in std::(anonymous namespace)::execute_native_thread_routine (__p=<optimized out>) at ../../../../../libstdc++-v3/src/c++11/thread.cc:73
#37 0x00000036e9207d15 in start_thread (arg=0x7ffff65dc700) at pthread_create.c:308
#38 0x00000036e8ef246d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:114 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T09:11:00.570

在我看来，您的`mutex`类型实际上并没有提供互斥。你记得使用`-pthread`编译器标志吗？

# delphi - Delphi中的网页抓取

> ID：14691782
> 
> 赞同：5
> 
> 时间：2013-02-04T17:11:28.063
> 
> 标签：delphi, web-scraping

你知道 Delphi 的网页抓取库吗？喜欢 Beautiful Soup 或 Scrapy for Python 吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-04T19:05:05.717

好吧，这不是针对 Delphi，而是针对 FreePascal，因为我没有最近的 Delphi 版本，但是它们之间的移植应该不是那么困难。

无论如何，我的[Internet 工具](http://www.benibela.de/sources_en.html#internettools)可能是目前最好的 Pascal 网络抓取库。

例如，您可以打印页面上的所有链接：

```
uses simpleinternet, xquery;

var a: IXQValue;
begin
  for a in process('http://stackoverflow.com', '//a/@href') do
    writeln(a.toString);
end. 
```

它们独立于平台；完全支持 XPath 2、XQuery、CSS 3 选择器（这些选择器没有经过很好的测试，无论如何 XPath 更好）和模式匹配；解析xml和html；并通过http和https下载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-01-23T19:04:56.807

使用 TWebBrowser 组件加载页面后，查询 IHTMLDocument2 接口的 TWebBrowser.Document 属性，然后您可以枚举元素。

您可以 getElementsById、getElementsByTagName、getElementsByName，例如：

```
var
  Elem: IHTMLElement;
begin
   Elem := GetElementById(WebBrowser1.Document, 'myid') as IHTMLElement;
end; 
```

或获取所有 HTML 文本并使用您想要的任何方式，例如：

```
sourceHTML := WebBrowser.Document as IHTMLDocument2;
sourceHTML.body.innerHTML; 
```

# php - AS3：使用 AS3 和 PHP 的多人游戏？

> ID：14691784
> 
> 赞同：1
> 
> 时间：2013-02-04T17:11:33.137
> 
> 标签：php, actionscript-3, amf

我尝试使用 AS3 和 PHP 在 Google 上搜索“在线多人游戏”，因为我要开发 Flash 游戏，所有用户都可以登录并创建他/她自己的角色，他们可以四处走动和聊天客厅。

### 我的计划是

MySql 将 User_Information 发送到 PHP，然后将数据发送到 Flash (AS3) 以显示信息

（我尝试使用 PHP，因为现在我使用的是 PHP 服务器，我不想更改它，对此感到**抱歉**）

> MSQL > PHP > 闪存

我从谷歌得到了一些结果，但我用 C# 得到了 AS3

[https://playerio.com/documentation/tutorials/building-flash-multiplayer-games-tutorial/](https://playerio.com/documentation/tutorials/building-flash-multiplayer-games-tutorial/)

和带有 JAVA 的 AS3

[http://techylib.com/en/view/hihatclover/free_ebook_actionscript_3.0_for_multiplayer_game_and_virtual](http://techylib.com/en/view/hihatclover/free_ebook_actionscript_3.0_for_multiplayer_game_and_virtual)

所以有任何方法可以将 AS3 与 PHP 然后 MYSQL 一起使用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T17:26:07.777

我使用 AMFPHP ( [http://www.silexlabs.org/amfphp/](http://www.silexlabs.org/amfphp/) ) 与远程服务器通信。它是免费的并且超级容易安装。在此处查看文档 ( [http://www.silexlabs.org/amfphp/documentation/](http://www.silexlabs.org/amfphp/documentation/) )

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T19:46:56.793

存在其他用于闪存的 MMO 技术，其**扩展性比 AMFPHP 好得多。**

在构建 MMO 时，请考虑后端将如何处理故障。真正繁忙的服务不可避免地会出现某种程度的故障。问题是有多少用户受到故障的影响。

如果服务器端是“无状态”基于 REST 的协议，或者您正在构建一个将状态保存在服务器内存中的服务器，那么可伸缩性问题会有所不同。

如果你真的对 AMFPHP 施加了负载，AMF Serializer 将成倍地拖累服务器的性能。从 Java 转换到 AMF 服务器端根本不是一种线性可扩展的算法。

我发现**SmartFox Server** ( [http://www.smartfoxserver.com/](http://www.smartfoxserver.com/) ) 是多人游戏的一个很好的替代方案（用 java 编写）。它也是可扩展的，使用java。它使用套接字工作，AMF 序列化是在客户端使用提供的 SmartFox ActionScript 库完成的。

从“服务质量”的角度来看，在服务器上运行多个 SmartFox 进程（在不同端口上运行）并让每个进程只管理几个用户是明智的。这样，如果 SmartFox 进程死亡，整个服务器不会受到影响，只有少数用户受该进程管理。

安全限制是**每个进程 < 15 个用户**。理论上，如果您的目标是在服务器上同时支持 10000 个用户，那么您将有 667 个 SmartFox 进程在 667 个不同的端口上运行。

当然，这取决于服务器端的设置/逻辑，但在最简单的情况下，来自客户端的实时 MMO 数据由 SmartFox 简单地复制并广播到连接到该流程实例的所有玩家。

请记住，如果您需要更多的服务器逻辑，您可以使用 Java 扩展 SmartFox 服务器。但是请记住，扩展服务器越多，完成的工作就越多，最终可以支持的连接就越少（每台服务器）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-10T09:47:14.277

有几个多人游戏服务器可用.. 我最喜欢的是 SmartFoxServer 2x [http://smartfoxserver.com/](http://smartfoxserver.com/)

但是，您可以使用 php 和 Flash as3 开发多人游戏，因为您必须创建一个 PHP 套接字服务器程序来处理 Actionscript 请求。这可以在您完成创建 PHP 套接字服务器之后实现，您必须从闪存创建套接字连接并连接到 php 套接字服务器。

请参阅此链接以在 php 中创建套接字程序：http: [//www.christophh.net/2012/07/24/php-socket-programming/](http://www.christophh.net/2012/07/24/php-socket-programming/)

请参考此链接以创建动作脚本套接字编程 [http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7cfb.html](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7cfb.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T18:10:56.967

您可以在 Flash Builder 中编写 Actionscript 3，它提供了更高级的工具来使用 PHP 服务，Flash Builder 也能够生成基本的 CRUD 来使用 Zend 框架来使用这些服务，这里是 PHP 程序员的基本教程：[http:// /corlan.org/flex-related/flex-for-php-developers/](http://corlan.org/flex-related/flex-for-php-developers/) 也看看这里 [http://www.adobe.com/es/products/flash-builder-php.html](http://www.adobe.com/es/products/flash-builder-php.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-04T17:20:22.327

我正在开发一种类似的游戏，并且我也在使用 php 与 mysql 进行通信。

我正在使用的教程是：

[http://active.tutsplus.com/tutorials/actionscript/create-a-flash-login-system-using-php-and-mysql-part-1/](http://active.tutsplus.com/tutorials/actionscript/create-a-flash-login-system-using-php-and-mysql-part-1/)

至于playerio，我也有点困惑。

# ajax - Jquery Ajax 请求失败，没有明确的错误

> ID：14691786
> 
> 赞同：0
> 
> 时间：2013-02-04T17:11:45.900
> 
> 标签：ajax, jquery

只是想提前澄清一下我对 jquery 很陌生。我想进行 ajax 调用以从端点检索一些 json 数据，但我尝试的一切都失败了（我得到状态代码 0 并且没有响应文本）。

这是我试图从中检索数据的端点： `http://www.corpcomm.com/ccgwebapi/sample.ashx`

我正在使用`JQuery 1.9.0`并尝试在 被调用 `json`时加载数据。`document.ready`

任何帮助将不胜感激。

```
$.ajaxSetup({
error: AjaxError
});

function AjaxError(x, e) {
if (x.status == 0) {
alert(x.status);
} else if (x.status == 404) {
alert('Requested URL not found.');
} else if (x.status == 500) {
alert('Internel Server Error.');
} else {
alert('Unknow Error.\n' + x.responseText);
}
}

$.get("http://www.corpcomm.com/ccgwebapi/sample.ashx",function () {
alert("success");
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:17:59.630

如果要获取 json 数据，则必须使用`$.getJSON()`：

```
$.getJSON('http://www.corpcomm.com/ccgwebapi/sample.ashx', function(data) {
   $.each(data, function(key, val) {
     console.log(val);
   });
}); 
```

`Same origin policy`必须考虑到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:19:08.560

试试这个 JSBIN 并查看控制台我让 JSON 恢复正常：http: [//jsbin.com/iwujew/1/edit](http://jsbin.com/iwujew/1/edit)

这是回应：

```
{
  "ok": true,
  "error": false
} 
```

希望对你有帮助^^

# php - Drupal 7 渲染评论对象

> ID：14691793
> 
> 赞同：1
> 
> 时间：2013-02-04T17:12:21.680
> 
> 标签：php, drupal, drupal-7

所以这就是我遇到的问题。如果我有一个评论对象，我想创建一个使用该评论的显示设置的可渲染数组。到目前为止，这就是我所拥有的：

```
$commentNew = comment_load($var);
$reply[] = field_view_value('comment', $commentNew, 'comment_body', $commentNew->comment_body['und'][0]); 
```

这很好用，因为我没有为身体设置任何特定的设置。但我也有图像字段和视频嵌入字段，我需要按照它们在系统中的设置方式进行渲染。我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T17:58:44.097

Drupal 核心通过以下[`comment_view()`](http://api.drupal.org/api/drupal/modules%21comment%21comment.module/function/comment_view/7)功能实现：

```
$comment = comment_load($var);
$node = node_load($comment->nid);
$view_mode = 'full'; // Or whatever view mode is appropriate
$build = comment_view($comment, $node, $view_mode); 
```

如果您需要更改默认字段的特定字段，请使用[`hook_comment_view()`](http://api.drupal.org/api/drupal/modules!comment!comment.api.php/function/hook_comment_view/7)：

```
function MYMODULE_comment_view($comment, $view_mode, $langcode) {
  $comment->content['body'] = array('#markup' => 'something');
} 
```

或者如果实现钩子不适用于您的用例，则只需根据需要编辑`$build`接收自的数组。`comment_view()`

# android - 在安卓手机上监控电池电量

> ID：14691795
> 
> 赞同：2
> 
> 时间：2013-02-04T17:12:24.867
> 
> 标签：android, performance, intentfilter, batterymanager

如何以编程方式监控我的 android 设备上的电池电量？我已经阅读了在 stackoverflow 上发布的示例以及`BatteryManager`我们需要为`ACTION_BATTERY_CHANGED`. 我的问题是我需要持续监控电池电量。当我使用`ACTION_BATTERY_CHANGED`意图时，更新保持在一个恒定值，直到我退出并重新启动我的应用程序。有没有办法在我的应用程序运行的整个过程中监控电池电量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T17:27:01.647

只需尝试使用以下代码，如果您运行它，您将获得不同的电池信息。您还可以获得更多信息，但因此您应该在 android api 中为电池拍摄正确的命令。

```
 public void getActualData(){

    IntentFilter ifilter = new IntentFilter(Intent.ACTION_BATTERY_CHANGED);
    Intent batteryStatus = this.registerReceiver(null, ifilter);

    //are we charging / charged?
    int status = batteryStatus.getIntExtra(BatteryManager.EXTRA_STATUS, -1);
    boolean isCharging = status == BatteryManager.BATTERY_STATUS_CHARGING || status == BatteryManager.BATTERY_STATUS_FULL;

    if(isCharging == true){
        tvCharged.setText("CHARGING");
    }else{
        tvCharged.setText("NOT CHARGING");
    }

    //how are we charging
    int chargePlug = batteryStatus.getIntExtra(BatteryManager.EXTRA_PLUGGED, -1);
    boolean usbCharge = chargePlug == BatteryManager.BATTERY_PLUGGED_USB;
    boolean acCharge = chargePlug == BatteryManager.BATTERY_PLUGGED_AC;

    if(usbCharge == true){
        tvHowCharging.setText("USB");
    }else{
        tvHowCharging.setText("ELECTRICAL OUTLET");
    }

    //get battery level and print it out
    int level = batteryStatus.getIntExtra(BatteryManager.EXTRA_LEVEL, -1);
    tvLevelOutput.setText(level + " / 100");
    pbLevel.setProgress(level);
    pbLevel.invalidate();

    //get battery temperatur
    int temp = batteryStatus.getIntExtra(BatteryManager.EXTRA_TEMPERATURE, -1);
    tvTempOutput.setText(temp + "Grad");
    pbTemp.incrementProgressBy(temp);
    pbTemp.invalidate();

    //get battery voltage
    int voltage = batteryStatus.getIntExtra(BatteryManager.EXTRA_VOLTAGE, -1);
    tvVoltageOutput.setText(voltage + " V");
    pbVoltage.incrementProgressBy(voltage);
    pbVoltage.invalidate();
} 
```

# ios - UITableview 的触摸事件

> ID：14691797
> 
> 赞同：0
> 
> 时间：2013-02-04T17:12:26.680
> 
> 标签：ios, uitableview, event-handling, hittest, touch-event

我有一个`UIView`覆盖子类的`UITableview`. 问题是，我无法让表格视图滚动。我尝试过覆盖`touchesBegan`, `touchesMoved`, `touchesEnded`. 然后我尝试覆盖 hittest 但这似乎没有影响。

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *touch = [touches anyObject];
    CGPoint touchPoint = [touch locationInView:self];
    NSLog(@"SMTable.touches began %@",NSStringFromCGPoint(touchPoint));
    [super touchesBegan:touches withEvent:event];

}
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event{
    UITouch *touch = [touches anyObject];
    CGPoint touchPoint = [touch locationInView:self];
    NSLog(@"SMTable.touches moved %@ for :%p",NSStringFromCGPoint(touchPoint),touch.view);
    [super touchesMoved:touches withEvent:event];
}
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event{
    UITouch *touch = [touches anyObject];
    CGPoint touchPoint = [touch locationInView:self];
    NSLog(@"SMTable.touches ended %@",NSStringFromCGPoint(touchPoint));
    [super touchesEnded:touches withEvent:event];
}
- (void)touchesCancelled:(NSSet*)touches withEvent:(UIEvent*)event {
    [super touchesCancelled:touches withEvent:event];
}
- (UIView*) hitTest:(CGPoint)point withEvent:(UIEvent *)event {
    //NSLog(@"SMTable.hitTest %@",NSStringFromCGPoint(point));
    return [super hitTest:point withEvent:event];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:21:54.990

如果您在您`UIView`的上方`UITableView`，则所有触摸事件都将落在其中`UIView`并且您`UITableView`将不会滚动。您需要为最顶层的 `UIView 禁用交互

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:33:51.043

当您需要创建一个专业`UITableView`时，您几乎总是最好使用`UIViewController`包含 a 的 a而不是在可能的情况下在层次结构中`UITableView`四处乱窜。`UITableView`Apple 在 tableview 层次结构中做了很多事情，这使得向其中添加您自己的自定义视图经常出错。所以，简短的回答是：避免将您自己的视图插入到 tableView 层次结构中。

事实上，我几乎不再使用`UITableViewController`子类了。我总是发现自己需要以一种不容易支持的方式自定义视图控制器`UITableViewController`——例如创建一个视图来覆盖 tableView。相反，像这样创建你的控制器：

```
@interface MyViewController : UIViewController <UITableViewDataSource, UITableViewDelegate>

@property (nonatomic,strong) IBOutlet UITableView *tableView

@end 
```

如果您使用的是 Interface Builder，请将您的 tableView 放入视图控制器的视图中，并将委托和数据源设置为视图的所有者。`viewDidLoad`或者您可以通过该方法在代码中执行相同的操作。在任何一种情况下，此时您都可以**将视图控制器完全视为 UITableViewController 并具有额外的好处，即能够执行诸如插入视图之类的`self.view`事情而不会出现可怕的错误。**

# unix - cd 进入目录时显示自定义消息

> ID：14691798
> 
> 赞同：2
> 
> 时间：2013-02-04T17:12:35.103
> 
> 标签：unix, rvm, rvmrc

我正在寻找一种在 cd 进入目录时显示自定义消息的方法。例如

```
$ cd some_folder
Warning: Don't edit these files!
some_folder $ 
```

从一篇旧帖子中，我发现了将其添加到我的 .bashrc 文件的建议：

```
reminder_cd() {
  builtin cd "$@" && { [ ! -f .cd-reminder ] || cat .cd-reminder 1>&2; }
}

alias cd=reminder_cd 
```

使用此脚本，如果我的文件夹中有 .reminder_cd 文件，则当我 cd 进入该文件时会显示该文件的内容。

那行得通，但是当您 cd 进入目录时，它似乎会杀死其他执行操作的脚本。具体来说，当您 cd 进入目录时，它会破坏 Ruby RVM 使用 .rvmrc 切换 ruby​​ 版本的能力。

有没有办法修改上面的函数（或使用完全不同的技术），以便它不会清除输入文件夹时使用的任何现有脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T23:52:23.317

RVM 对大多数命令都有挂钩，您可以创建一个：

```
hook="$rvm_path/hooks/after_cd_reminder"
echo "[ ! -f .cd-reminder ] || cat .cd-reminder 1>&2" > "$hook"
chmod +x "$hook" 
```

# ruby - 如何动态包含 ruby 文件

> ID：14691802
> 
> 赞同：0
> 
> 时间：2013-02-04T17:12:48.660
> 
> 标签：ruby

我想将所有 ruby​​ 文件包含在实现该功能的目录中`toto()`。

在python中我会做：

```
res = []
for f in glob.glob("*.py"):
  i = __import__(f)
  if "toto" in dir(i):
    res.append(i.toto) 
```

我可以像这样使用列表：

```
for toto in res:
  toto() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:04:15.043

在 Ruby 中导入与在 Python 中非常不同 - 在 Python 中，文件和模块或多或少是相同的东西，而在 Ruby 中它们不是。您必须手动创建模块：

```
res = []
Dir.glob("*.rb") do |file|
  # Construct a class based on what is in the file,
  # and create an instance of it
  mod = Class.new do
    class_eval File.read file
  end.new

  # Check if it has the toto method
  if mod.respond_to? :toto
    res << mod
  end
end

# And call it
res.each do |mod|
  mod.toto
end 
```

或者更符合 Ruby 的习惯：

```
res = Dir.glob("*.rb").map do |file|
  # Convert to an object based on the file
  Class.new do
    class_eval File.read file
  end.new
end.select do |mod|
  # Choose the ones that have a toto method
  mod.respond_to? :toto
end

# Later, call them:
res.each &:toto 
```

# java - 覆盖paintComponent(); 绘制多个缓冲图像

> ID：14691804
> 
> 赞同：0
> 
> 时间：2013-02-04T17:12:50.600
> 
> 标签：java, swing, graphics

我正在尝试制作塔防游戏。到目前为止，我已经制作了显示所有内容的`JFrame`（称为`GameFrame`），添加了背景图像（`.PNG`），我正在尝试创建怪物并让它们在我创建的路径上“移动”。所以，我创建了一个`GlassPane`类，我`glassPane`在`GameFrame`.

这是代码`GlassPane`：

```
public class GlassPane extends JComponent implements ActionListener{

    private ArrayList<MyPoint> path; //list of Points-pixel positions- (x,y pair) that monsters will follow
    private ArrayList<Monster> wave; //list of monsters that will try to reach the rift
    private Timer timer; //javax.swing.Timer
    private boolean waveEnd;//signing that the wave has ended(ignore it)

    public GlassPane(){

        super();
        createPath();//method is below
        wave = new ArrayList<Monster>();//monsters added in nextWave()
        timer = new Timer(4,this);//timer in order to slow down and smooth the movement of monsters
        waveEnd = false;
    }

    @Override
    protected void paintComponent(Graphics g){
            super.paintComponent(g);
            for(Monster m:wave){
               if(m.isVisible())//visible is a private variable in Monster class(defines whether i want to paint that monster or not)
                {
               g.drawImage(m.getImage(), m.getX(), m.getY(), this);
                }
             }
    }

    public void nextWave(){

        waveEnd = false;
                for(int i =0;i<20;i++)
                    wave.add(new Monster());
                wave.get(0).setVisible(true);//sets the first monster to be visible(paintable)
                int visibles = 1;//index 0 is visible,so index 1 is next to become visible
        while(!waveEnd){
                        if(visibles<19 && wave.get(0).getPathIndex()%50 == 0){
                        //meaning until all 20 monsters are visible(indexes 0-19),"every 50 steps(pixels) the first monster moves"
                           wave.get(visibles).setVisible(true);
                           //make another monster visible and start moving it
                           visibles++;//visible(moving) monsters increased by 1
            timer.start();//"move all visible monsters one step forward with a small delay until the next movement to make it soft"
        }
        JOptionPane.showMessageDialog(new JFrame(), "Finished!","All monsters reached the rift!",JOptionPane.INFORMATION_MESSAGE);//let me know then wave is finished
    }

    private void createPath(){
                //just making a lsit of pixels that I want monsters to follow
        path = new ArrayList<MyPoint>();
        for(int x=0;x<175;x++){
            path.add(new MyPoint(x,0));
        }

        for(int y=0;y<175;y++){
            path.add(new MyPoint(174,y));
        }

        for(int x=175;x<325;x++){
            path.add(new MyPoint(x,174));
        }

        for(int y=175;y<425;y++){
            path.add(new MyPoint(299,y));
        }

        for(int x=325;x<575;x++){
            path.add(new MyPoint(x,424));
        }

        for(int y=424;y>175;y--){
            path.add(new MyPoint(574,y));
        }

        for(int x=575;x<1001;x++){
            path.add(new MyPoint(x,174));
        }   
    }

    @Override

    public void actionPerformed(ActionEvent arg0) {
             for(Monster m:wave)
                if(m.isVisible())
            m.move(path);
                //"move every visible monster by one step"
        if(m.get(19).getPathIndex() == 1674)//1674 is the path's last index
            waveEnd = true;//if the last monster reaches the end,then all have
                //meaning the wave is finished
        this.repaint();//refresh any changes to the monsters' positions
        }
} 
```

问题是只有第一个怪物在路径中移动，这意味着当我调用时只有一个被绘制`repaint()`。我在 p 做错了`aintComponent(Graphics g)`什么？因为我相信那是我的错误所在……我怎样才能一次又一次地绘制所有“可用”图像？

`.PNG`注意：如果这很重要，它们是格式的缓冲图像。

我虽然关于添加`Monster`类代码，但我相信解释方法的功能足以理解发生了什么。如果有人需要更多详细信息，请告诉我。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:48:42.673

我认为你必须在你的循环周围加上括号。速记仅在循环后的第一行上循环

```
//Output: 
//AAAAAAAAAAAAAAAAAA
//AAAAAAAAAAAAAAAAAA
//AAAAAAAAAAAAAAAAAA
//AAAAAAAAAAAAAAAAAA
//BBBBBBBBBBBBBBBBBB
for(Monster m:wave)
System.out.println("AAAAAAAAAAAAAA");
System.out.println("BBBBBBBBBBBBBBB");

//Output: 
//AAAAAAAAAAAAAAAAAA
//AAAAAAAAAAAAAAAAAA
//AAAAAAAAAAAAAAAAAA
//AAAAAAAAAAAAAAAAAA
//BBBBBBBBBBBBBBBBBB
//BBBBBBBBBBBBBBBBBB
//BBBBBBBBBBBBBBBBBB
//BBBBBBBBBBBBBBBBBB  
for(Monster m:wave)
{
System.out.println("AAAAAAAAAAAAAA");
System.out.println("BBBBBBBBBBBBBBB");
} 
```

# c++ - 具有多种实现的 C++ 具体类型

> ID：14691805
> 
> 赞同：0
> 
> 时间：2013-02-04T17:12:58.537
> 
> 标签：c++

我正在设计一个分布式算法，我将功能分离如下：

```
class Peer {
public:
  void send(PeerId destination, ...) //send some data
}

class MyDistributedAlgorithm {
public:
  MyDistributedAlgorithm(Peer& self);
  doX(); //calls self.send()
} 
```

以这种方式分离出来的价值是我可以将算法重用于 Peer 的不同实现（tcp/ip 套接字或线程等）

我意识到的一件事是 PeerId 可能取决于 Peer 的实现，但 MyDistributedAlgorithm 需要存储一个带有 PeerId 类型键的映射，因此它必须是一个具体类型。

我在 C++ 中相当缺乏经验，在 C 中，我对这个问题的解决方案是将 PeerId 定义为 void* 并将其转换为每个 Peer 实现所必需的。在 C++ 中有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:22:07.003

您可以制作`PeerId`经典的继承层次结构；因为没有一个实际的派生类可能有一个指针（因为它们确实是值），所以使用`std::shared_ptr`（或者 `boost::shared_ptr`，如果你没有 C++11）可能是安全的。

或者，您可以`PeerId`包装（共享）指针；为其提供必要的接口，并将其转发给指向的实现。

我在这里假设它`PeerId`是不可变的（赋值除外）。这似乎是标识符最有可能的情况，但如果不是，您将不得不考虑上述建议实现引用语义而不是期望值语义的事实。（对于不可变对象，您无法真正区分两者。）

# java - 正则表达式元字符“*”和“*？” 在 JAVA 的 replaceAll() 方法中表现异常

> ID：14691808
> 
> 赞同：18
> 
> 时间：2013-02-04T17:13:22.120
> 
> 标签：java, regex, string, replace

> **可能重复：**
> [String.replaceAll() 异常与正则表达式中的贪婪量词 正则表达式中的](https://stackoverflow.com/questions/8604286/string-replaceall-anomaly-with-greedy-quantifiers-in-regex)
> [奇怪行为](https://stackoverflow.com/questions/9228509/strange-behavior-in-regexes)

尽管

```
"a".replaceAll("a", "b")
"a".replaceAll("a+", "b")
"a".replaceAll("a+?", "b") 
```

全部返回`b`，为什么

```
"a".replaceAll("a*", "b") 
```

返回`bb`和

```
"a".replaceAll("a*?", "b") 
```

返回`bab`？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-04T17:23:39.320

```
"a".replaceAll("a*", "b") 
```

首先替换`a`为`b`，然后将指针移过`b`。然后它匹配字符串的结尾，并替换为`b`. 由于它匹配了一个空字符串，它使指针前进，从字符串中掉出，然后结束，结果是`bb`.

```
"a".replaceAll("a*?", "b") 
```

first 匹配字符串的开头并替换为`b`. 它不匹配，`a`因为`?`in`a*?`表示“非贪婪”（尽可能少匹配）。由于它匹配一个空字符串，它推进指针，跳过`a`。然后它匹配字符串的结尾，替换为`b`并退出字符串，导致`bab`. 最终结果与您所做的相同`"a".replaceAll("", "b")`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-04T17:25:08.993

发生这种情况是因为零宽度匹配。

```
"a".replaceAll("a*", "b") 
```

将匹配两次：

1.  在字符串的开头尝试匹配，贪婪`*`将其`a`作为匹配项。
2.  前进到字符串中的下一个位置（现在在字符串的末尾），在那里尝试匹配，空字符串匹配。

    ```
    " a "
     \| \___ 2\. match empty string
      \_____ 1\. match "a" 
    ```

```
"a".replaceAll("a*?", "b") 
```

还将匹配两次：

1.  在字符串的开头尝试匹配，非贪婪`*?`匹配空字符串而不消耗`a`.
2.  前进到字符串中的下一个位置（现在在字符串的末尾），尝试在那里匹配，空字符串匹配。

    ```
    " a "
     \  \___ 2\. match empty string
      \_____ 1\. match empty string 
    ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T17:26:54.357

在`"a".replaceAll("a*", "b")`

```
* - 对于 0 或更多，所以在 `a*` 中
```

```
1\. a - replaced by b
2\. * - is also true as empty string is true for *,so, replaced by b 
```

并且在`"a".replaceAll("a*?", "b")`

```
1\. *? - makes anything non-greedy means it makes regrex to match as little
        as possible,
2\. so,the pre and post empty string would be replaced by "b" and 
   as a*? is non-greedy, it will not replace it 
```

# android - 仅使用 AChartEngine 隐藏 y 轴

> ID：14691817
> 
> 赞同：3
> 
> 时间：2013-02-04T17:13:51.687
> 
> 标签：android, achartengine

我不知道如何只隐藏 y 轴。我希望数字保留但删除线。你知道怎么做吗？

BR

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-04T18:07:42.023

您可以通过这种方式隐藏两个轴：

```
renderer.setShowAxes(false); 
```

您可以独立隐藏网格：

```
renderer.setShowGridY(false); 
```

如果以上还不够，可以设置Y轴不可见等边距，将Y轴标签向右移动：

```
renderer.setMargins(new int[] {20, -1, 10, 20});
renderer.setYLabelsAlign(Align.LEFT);
renderer.setYLabelsPadding(-10); 
```

# maven - 使用 hudson 从 maven 到 sonar 的项目版本

> ID：14691818
> 
> 赞同：0
> 
> 时间：2013-02-04T17:13:52.777
> 
> 标签：maven, sonarqube

我在进行声纳分析时正在使用 maven2 、 hudson 和 sonar - 我想通过某种方式将 Hudson build# 附加到项目的 maven 版本中

项目版本每 2 周更改一次 - 以前 2 周为例：

```
<version>abc-SNAPSHOT</version> 
```

两周后，下一个版本可能类似于：

```
<version>xyz-SNAPSHOT</version> 
```

我想要的是将 build# 附加到 pom 中已经存在的版本中 - 它正在被拾取并传递给声纳

笔记：

```
-Dsonar.projectVersion=xyz-SNAPSHOT-${BUILD_NUMBER} 
```

在这里 - 我正在硬编码版本并动态传递构建#

我想要的是能够从 maven 动态获取版本（不更改它）并简单地附加 build# 动态

关于如何实现这一点的任何想法？谢谢，萨蒂什

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T12:22:40.910

您可以使用 Groovy 脚本读取版本并添加环境变量： [Getting Maven Version in Jenkins](https://stackoverflow.com/questions/9893503/getting-maven-version-in-jenkins)

我按时使用这个脚本来解析版本：

```
def project = new XmlParser().parse("/pom.xml")
def artifactId =  project.artifactId.text().trim()
def version = project.version.text().trim()
println "ArtifactId: [" + artifactId + "]"
println "Version: [" + version + "]" 
```

设置“附加属性”字段后：-Dsonar.projectVersion=${MAVEN_VERSION}-${BUILD_NUMBER}

如果 Jenkins 没有得到变量，请尝试安装： [https ://wiki.jenkins-ci.org/display/JENKINS/EnvInject+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/EnvInject+Plugin)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-06T20:31:33.020

您可以使用此 Jenkins 功能：[https ://github.com/jenkinsci/jenkins/pull/933/files](https://github.com/jenkinsci/jenkins/pull/933/files)

基本上你可以在构建时访问 env 变量，由 Jenkins 从 Maven GAV info 映射

*   POM_DISPLAYNAME
*   POM_DISPLAYNAME
*   POM_VERSION
*   POM_GROUPID
*   POM_ARTIFACTID
*   POM_PACKAGING
*   POM_RELATIVEPATH

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T01:08:06.810

这不是真正的声纳问题。这是 Maven 项目版本控制。

快照被设计为动态的。您会发现 Maven 在您的 Maven 存储库中保存了带时间戳的版本（我不知道如何将这些时间戳传递到 Sonar，这可能是您想要的）。快照构建非常适合 CI 作业。非开发人员从未使用过的软件。

我建议要么停止使用快照（每次构建一个“发布”），要么只是接受 Maven 中有两种构建的事实。我的规则是，如果代码被其他人使用，那么它不再是快照，应该被视为发布。这给持续部署等新兴方法带来了挑战……如果每个构建都进入生产（或生产副本），那么快照就变得无关紧要了。

每次都构建一个版本并不是那么糟糕。首先命名约定，我建议：

```
<major>.<minor>.<patch>.<hudson build num> 
```

[Maven 的发布插件](http://maven.apache.org/maven-release/maven-release-plugin/)将自动化管理发布细节（更新 POM、标记 SCM 系统）中的大部分痛苦。最后还有一个有用的[M2_Release 插件](http://wiki.hudson-ci.org/display/HUDSON/M2+Release+Plugin)，可以让您从 Hudson GUI 触发发布。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T20:16:52.553

感谢 Andre 将我指向我尝试过的另一个链接，但遇到了一些问题，如评论中所述假设我所做的只是一种解决方法并且有更好的解决方案？（我正在使用 Hudson）所以我在 Hudson 中定义了一个新的 Job（构建一个 Maven 2/3 项目（Legacy））在这里我定义了一个“Groovy PostBuild”复制了 Andre 指向我的链接中的代码：

```
import hudson.model.*;
import hudson.util.*;

def thr = Thread.currentThread();
def currentBuild = thr?.executable;
def mavenVer = currentBuild.getParent().getModules().toArray()[0].getVersion();
def newParamAction = new hudson.model.ParametersAction(new           
hudson.model.StringParameterValue("MAVEN_VERSION", mavenVer));
currentBuild.addAction(newParamAction); 
```

然后我“在其他项目上触发参数化构建”并提到了我希望将 maven 版本作为 pom 中的mentioend 的工作

定义了一个参数 - ${MAVEN_VERSION}

然后我能够在“其他”作业中获取此参数的值

所以首先感谢安德烈 - 他为我提供了一个解决方案，我很想知道这是否是一个好方法我的另一个问题是（也许我会开始一个新线程）是 - 哈德逊“自由风格”工作与“Maven 2/3 遗留项目”

我问的原因是同一个 Groovy 脚本在“自由风格”中失败，而它在“Maven 遗产”中工作

谢谢，萨蒂什

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-08T12:47:55.737

有相同的需求并按照 Groovy 解析 pom 的建议解决。

```
import jenkins.util.*;
import jenkins.model.*;

def thr = Thread.currentThread();
def currentBuild = thr?.executable;
def workspace = currentBuild.getModuleRoot().absolutize().toString();

def project = new XmlSlurper().parse(new File("$workspace/pom.xml"))

def param = new hudson.model.StringParameterValue("project.version", project.version.toString())
currentBuild.addAction(new hudson.model.ParametersAction(param)); 
```

将此脚本添加为“执行系统 ​​Groovy 脚本”类型的后期步骤（因此不需要安装 Groovy）并将代码粘贴到“Groovy 命令”中。

# javascript - 构建 JSON 数组并检索其元素的更好方法

> ID：14691823
> 
> 赞同：0
> 
> 时间：2013-02-04T17:14:18.103
> 
> 标签：javascript, arrays, json

这是我初始化和构建数组的方式：

```
var newCountyInfo = new Object();

newCountyInfo.name = newCountyName;
newCountyInfo.state = newCountyState;
newCountyInfo.zips = newCountyZips;
newCountyInfo.branchID = newCountyBranchID; 
```

所以我在数组中有四个元素。然后，我将 newCountyInfo 传递给另一个函数，以提取元素以在某些 HTML 元素中显示。

**我**知道如何获取使用它们的函数中的各个元素的唯一方法是：

```
JSON.parse(JSON.stringify(newCountyValidation)).name
JSON.parse(JSON.stringify(newCountyValidation)).state
... etc... 
```

必须有更好/更短/更优雅的方式来做到这一点！

它是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T17:17:01.543

你为什么要序列化*？*我不明白 JSON 与此有什么关系，除非您使用[web workers](https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers)、[ajax](https://developer.mozilla.org/en-US/docs/AJAX)或其他需要序列化的东西。[从对象文字语法](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Values,_variables,_and_literals#Object_literals)开始：

```
var newCountyInfo = {
    name: newCountyName,
    state: newCountyState,
    zips: newCountyZips,
    branchID: newCountyBranchID
}; 
```

只需将整个对象传递给另一个函数：

```
someOtherFunction(newCountyInfo); 
```

[可以使用普通的旧属性访问](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Member_Operators)来访问字段：

```
function someOtherFunction(foo) {
    console.log(foo.name); // whatever was in newCountyname
} 
```

没有任何JSON。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T17:17:14.323

像这样的东西应该可以正常工作：

```
var newCountyInfo = {
    name: newCountyName,
    state: newCountyState,
    zips: newCountyZips,
    branchID: newCountyBranchID
}

function test(newCountyValidation)
{
    alert(newCountyValidation.name);
}

test(newCountyInfo); 
```

# java - 类之间枚举的 Set() 方法

> ID：14691824
> 
> 赞同：0
> 
> 时间：2013-02-04T17:14:30.817
> 
> 标签：java, enums

假设我在一个类中有以下代码：

```
enum Currency
{
  PENNY(1), NICKEL(5), DIME(10), QUARTER(25);
  private int value;
  private Bonus(int value)
  {
    this.value = value;
  }
  public int getValue()
  {
    return value;
  }
};
public class Coin
{
  Currency c;
  public Coin(Currency c)
  {
    this.c = c;
  }
  public void setCurrency(Currency c)
  {
    this.c = c;
  }
} 
```

如果我有一个单独的类来创建具有某个 Currency 枚举的 Coin 对象，我怎么能在那个单独的类中编写一个方法来将枚举从 PENNY 设置为 DIME？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:24:54.010

您只需从您创建的单独类中调用硬币类中的方法 setCurrency 并传递您要设置的货币枚举。

例子：

假设您创建了一个货币枚举为 PENNY 的 Coin 对象：

```
Coin coin = new Coin (Currency.Penny); 
```

现在您可以在要调用它的单独类中创建一个单独的方法，并将新的货币枚举设置为：

```
coin.setCurrency(currency.DIME); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:26:40.457

根据您的问题，您所做的事情是有道理的。由于您已将`enum`中的定义`same java file`为`public class`，因此`enum's scope`将是`default`并且它`accessed`只能在 中`same package`。

所以我会建议`moving`它`another file`去做`public`。

# openerp - 如何控制在 OpenERP 中首先安装哪个依赖模块？

> ID：14691825
> 
> 赞同：0
> 
> 时间：2013-02-04T17:14:32.317
> 
> 标签：openerp

我有一个依赖于 Product 模块的自定义模块，我已经将 Product 放在**openerp**的依赖部分中。但是，当我尝试安装自己的模块时，我遇到了与 Product 模块提供的字段有关的错误。有没有办法让我控制模块安装顺序，在我自己之前先安装产品模块。

做一个单独的单独模块（产品然后是我的模块）是可行的，但我想只安装一个模块。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T20:38:50.200

不幸的是，您无法完全控制早期加载的模块您可以做两件事来影响这一点：

1.  **将依赖模块添加到相关模块的openerp** .py 中的 'depends' 属性中，例如：'depends': ['stock','sale']，
2.  模块加载是按字母顺序影响的，所以给你的模块起一个以 x 或 z 开头的名称，这应该有助于它最后加载。

# tfs-sdk - TFS 连续构建识别构建失败事件

> ID：14691827
> 
> 赞同：0
> 
> 时间：2013-02-04T17:14:36.027
> 
> 标签：tfs-sdk

我已经使用 TFS windows 工作流实现了连续构建。在此我创建了一个自定义活动，它将帮助我创建文件夹的自定义模板。

**有什么方法可以监视构建的状态，也就是说，如果构建由于某些异常而失败，我想在我创建的数据库表中设置一个标志失败。**

我只想在 C# TFS API 中处理这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:52:30.747

是的，您可能需要创建自定义构建活动才能在数据库中输入您的记录。您可以将此自定义活动放在 Run on Agent Sequence 的最末尾的模板中，并检查 Microsoft.TeamFoundation.Build.Client.BuildStatus.Failed 的状态以了解构建是否失败

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T10:09:33.727

您可以使用服务 API 中的[`QueryBuilds`](http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.build.client.ibuildserver.querybuilds.aspx)方法`IBuildServer`来查询 TFS 内的所有构建。您可以将构建状态指定为过滤器之一，以及数据库中构建数量增长过大时的日期范围。

# c# - 文件上传在 ASP.NET MVC4 中不起作用 - 移动模板

> ID：14691828
> 
> 赞同：3
> 
> 时间：2013-02-04T17:14:37.673
> 
> 标签：c#, file-upload, asp.net-mvc-4

我将 C# 和 ASP.NET MVC4 用于 Web 应用程序（移动模板）。

现在我的视图中有以下代码：

```
 @using (Html.BeginForm("Index", "Home", FormMethod.Post, new { enctype = "multipart/form-data" }))
     { 
     <label for="file">Upload:</label>
     <input type="file" name="file" id="file"/>
     <input type="submit" value="Upload" />
     } 
```

这在我的控制器中：

```
 [HttpPost]
    public ActionResult Index(HttpPostedFileBase file)
    {
        string path = System.IO.Path.Combine(Server.MapPath("~/Content"), System.IO.Path.GetFileName(file.FileName));
        file.SaveAs(path);
        ViewBag.Message = "File uploaded successfully";
        return View();
    } 
```

当我运行应用程序并尝试上传文件时，我得到“对象引用未设置为对象的实例”。Visual Studio 中的消息。但是我知道上面的代码在 ASP.NET MVC3 中运行良好，因为我以前使用过它。

谁能帮我这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T17:59:52.533

将此属性添加到您的表单：`data-ajax="false"`

```
@using(Html.BeginForm("Index", "Home", FormMethod.Post,  new { enctype="multipart/form-data", data_ajax="false"})){
     <label for="file">Upload:</label>
     <input type="file" name="file" id="file"/>
     <input type="submit" value="Upload" />
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T17:38:37.887

您不必使用`HttpPostedFileBase`，事实上您不必在 [HttpPost] 操作中接收任何参数。只要您的表单设置为`enctype = "multipart/form-data"`（您已经这样做了），您就可以像这样从请求中获取文件：

```
var file = Request.Files[0]; 
```

# .net - 管理代码库产品密钥的最佳方式是什么？

> ID：14691830
> 
> 赞同：0
> 
> 时间：2013-02-04T17:14:41.653
> 
> 标签：.net, installation, wix, production, trial

像许多现代软件公司一样，我的公司使用产品密钥来检查用户对某个软件的合同。解析产品密钥时，我可以检查某人拥有什么类型的产品（试用版/完整版等）。我们希望用户能够从代码库的免费版本升级到付费版本，并希望能够检查产品密钥是否有效的试用版。

试用版不包含完整版的所有代码。使用算法检查产品密钥（它不使用 Web 服务或类似的东西），因此可以非常快速地完成。

这里有两个子问题：

*   从试用版到完整版。我正在考虑通过 MSI 升级解决这个问题，但不确定如何实现。（使用 WIX）
*   制作一个包含额外代码的试用版，用于检查它是否是试用版。我知道使用#if 语句可以做到这一点，但我想知道是否也可以更改 DLL - 更准确地说：为检查试用版的每种类型添加静态构造函数。

我的问题是：这是正确的方法吗？如果是这样，是否有实现这种功能的标准方法（或工具）？如果没有，最好的方法是什么？

**更新**

到目前为止，感谢您提供的所有出色答案。我认为是时候根据答案来解释更多的背景了——幸运的是，我们似乎或多或少地走在了正确的轨道上。

对于我们的产品，将其安装在私有（非互联网连接）VLAN 上是有意义的，这样就可以使用产品密钥......我真的不想像“电话激活”那样麻烦微软做到了:-)。因此，正如建议的那样，我目前正在使用加密一些数据的产品密钥，这些数据被解密以查看密钥是否对给定产品有效。当然，我可能是软件盗版的受害者，但我想我们现在将其视为一种“营销工具”。

正如其中一个答案所建议的，我目前正在生成多个 MSI 文件：一个用于 x64，一个用于 x86。然后是试用版、完整版和蓝图版。总共有 6 个 MSI 文件 (pfff)。在进程混淆过程中，会发生强命名和代码签名。蓝图版本包括完整的源代码。

我比较关心试用版。当然，我可以在这里和那里添加一些检查，但我宁愿自动在每个类中放置检查...我想过复制所有 CS 文件并添加/更改静态 c'tors (f.ex.使用 cecil 或 nrefactory .. 或只是几个正则表达式 ...)。在我看来，我不是唯一想要这个的人。必须有更好的方法，对吧？

此外，我真的不想考虑更新和升级，因为这似乎是在重新发明 MSI 轮子。从试用版到完整版在我看来像是 MSI 升级，就像完整版到蓝图版感觉像是 MSI 升级。但是，结合正常升级，我担心这是否可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:17:12.400

试用[Rhino 许可](http://www.hibernatingrhinos.com/oss/rhino-licensing)（开源）

> 使用计算机 SID、HDD 序列号、CPU 标识符等机器唯一标识符将生成的许可证绑定到个人机器。使用浮动许可证并在运行时检查服务器上许可证的可用性。Rhino Licensing 为您提供必要的基础设施来实现这一目标。Rhino Licensing 还可以在许可证文件中包含自定义数据，这样您就可以轻松地将客户信息存储在许可证文件中。综上所述，在您的应用程序上拥有许可方案并不意味着您是完全安全的。黑客和破解者试图对您的应用程序代码进行逆向工程以查看许可是如何完成的，因此您需要考虑其他安全问题，建议使用混淆工具来使恶意用户更难做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:21:56.203

您可以只发布完整版并禁用试用版的某些功能。当用户升级他的许可证时，他不需要下载任何东西。不要太担心裂缝和keygens。如果有人破解了你的软件，那就意味着你成功了，而且你已经赚了很多钱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:25:05.810

为了解决我们的应用程序的这个问题，我们使用了一个 Guid 并在 Guid 中选择了设置点，让我们知道他们正在使用什么版本。之后，我们只是安装了完整的系统并在软件启动时使用了布尔值。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-04T17:27:56.797

混合试用和生产环境可能会变得混乱。如果可能，请为每个安装两个单独的安装程序。

使您的保护尽可能强大有一些先决条件：

*   用你能买到的最好的混淆器来混淆你的代码。
*   在代码中的几个关键位置传播有效签名的检查，不要在启动时只检查一次。
*   了解 .NET 加密 API，例如非对称加密和 [签名](https://stackoverflow.com/questions/8437288/signing-and-verifying-signatures-with-rsa-c-sharp)
*   请记住，生成的产品密钥可能会被逆向工程，如果您的应用程序是大容量或高价值的，这主要是一个问题

**激活场景：**

在安装后或之后的一段时间内，您可以要求用户“激活”您的产品。激活时，您可以生成一个纯文本 XML 文件，其中包含一些标识系统的组件 - CPU ID、HDD ID、域名、用户名等。将所述 XML 发送到您的 Web 服务。

然后，该服务可以附加一个随机标签，将数据散列在一起并使用私钥对其进行签名，然后返回签名和随机标签。

您的客户端软件将内置匹配的公钥，并将随机标签和签名存储在本地。

要检查许可证文件是否有效，应用程序会将明文数据和随机标签一起散列，并检查签名是否与该散列匹配。

这为您提供了一种非常可靠的方法来确定您的客户端正在运行的实例是否已购买，并且几乎可以保证他们不能只修改 XML 本身。

**没有激活的场景：**

购买后发送包含一些客户数据的文件，例如他们的姓名、电子邮件、电话等 - 使其有点个人化，这样用户将不愿意分享他们自己的许可证文件。

包括一个随机标签并将所有数据散列在一起。对哈希进行签名并将其也存储在文件中。

用户必须将文件保存在预定位置或将其粘贴到应用程序的文本框中。

# macos - 如何为加密图像添加缩略图？

> ID：14691839
> 
> 赞同：0
> 
> 时间：2013-02-04T17:15:14.500
> 
> 标签：macos, cocoa

我使用[AES](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)算法加密图像。加密和解密效果很好。现在图像的缩略图是默认图像。

![在此处输入图像描述](../Images/afbda4de2853d77389d7195750578291.png)

但我想要一些对用户有用的东西。像这张图片。

![在此处输入图像描述](../Images/8b4ea0029810939f09b2db654fb0f99b.png)

我搜索了很多，但我只能找到基于文档的应用程序的快速查找。如何为 jpeg、png 或 tiff 图像添加缩略图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T20:10:32.147

我假设您在创建文件时知道文件的路径，并且您的项目中有图标图像，因此只需使用 NSWorkspace 方法**setIcon:forFile:options:**。

# json - System.TypeLoadException 使用 Newtonsoft JSON 反序列化

> ID：14691840
> 
> 赞同：2
> 
> 时间：2013-02-04T17:15:16.613
> 
> 标签：json, serialization, xamarin.ios, json.net

我真的被难住了。这是我返回的 JSON：

```
{"ResponseData":[{"ClusterID":"c02f1f5c-c61b-4f2c-ab5a-249966b3cdef","ClusterName":"Northeast","Courses":[{"CourseID":"8ab4f2b3-8160-4d7e-b79f-8d8b58926cc0","CourseName":"Home Course","SubCourses":[{"SubCourseName":"SubCourse1","SubCourseNumber":18}]},{"CourseID":"b3223464-333b-4c54-89c2-23908e0510c9","CourseName":"Away Course","SubCourses":[{"SubCourseName":"SubCourse1","SubCourseNumber":19}]}],"IsHomeCluster":true},"ResponseErrors":[]} 
```

这是我的反序列化代码：

```
 JArray jArr = (JArray)JsonConvert.DeserializeObject(json);
        foreach (var item in jArr) {
            foreach (var subitem in item["ResponseData"]) {
                Console.WriteLine (subitem ["ClusterID"]);
            }
        } 
```

项目编译得很好，但是当我在模拟器中运行它时，我得到了这个错误：

> System.TypeLoadException：发生类型加载异常。在 Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize (Newtonsoft.Json.JsonReader reader, System.Type objectType, Boolean checkAdditionalContent) [0x00000] 在 Newtonsoft.Json.JsonSerializer.DeserializeInternal (Newtonsoft.Json.JsonReader reader, System.在 Newtonsoft.Json.JsonSerializer.Deserialize (Newtonsoft.Json.JsonReader reader, System.Type objectType) [0x00000] in :0 中键入 objectType) [0x00000] 在 Newtonsoft.Json.JsonConvert.DeserializeObject (System.String 值, System.Type 类型，Newtonsoft.Json.JsonSerializerSettings 设置）[0x00000] 在：0 在 Newtonsoft.Json.JsonConvert.DeserializeObject（System.String 值）[0x00000] 在：0 在 AppMultiView.CourseInformationScreen。
> 在 /Users/Dan/Desktop/AppTouch_dev /Main.cs:18 中的 AppMultiView.Application.Main (System.String[] args) [0x00000]

我是否试图反序列化错误的东西？

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:03:05.377

我不完全确定您看到的问题是什么。可能只是您的 json 格式错误。

它有帮助，我通常解决这个问题的方法是：

1.  使用[http://chris.photobooks.com/json/](http://chris.photobooks.com/json/)之类的工具来验证 JSON - 在这种情况下，这向我显示了一个错误 - 您的“ResponseData”数组未终止。固定代码是：

    ```
    {"ResponseData":[
        {"ClusterID":"c02f1f5c-c61b-4f2c-ab5a-249966b3cdef","ClusterName":"Northeast",
        "Courses":
        [
        {"CourseID":"8ab4f2b3-8160-4d7e-b79f-8d8b58926cc0","CourseName":"Home Course","SubCourses":
            [{"SubCourseName":"SubCourse1","SubCourseNumber":18}]},
        {"CourseID":"b3223464-333b-4c54-89c2-23908e0510c9","CourseName":"Away Course","SubCourses":
            [{"SubCourseName":"SubCourse1","SubCourseNumber":19}]}
        ],
        "IsHomeCluster":true}
    ]
    ,"ResponseErrors":[]} 
    ```

2.  将更正后的 JSON 复制到[http://json2csharp.com/](http://json2csharp.com/)

    这给了我这样的课程：

    ```
    public class SubCours
    {
        public string SubCourseName { get; set; }
        public int SubCourseNumber { get; set; }
    }

    public class Cours
    {
        public string CourseID { get; set; }
        public string CourseName { get; set; }
        public List<SubCours> SubCourses { get; set; }
    }

    public class ResponseData
    {
        public string ClusterID { get; set; }
        public string ClusterName { get; set; }
        public List<Cours> Courses { get; set; }
        public bool IsHomeCluster { get; set; }
    }

    public class RootObject
    {
        public List<ResponseData> ResponseData { get; set; }
        public List<object> ResponseErrors { get; set; }
    } 
    ```

3.  使用`JsonConvert.DeserializeObject<RootObject>(json)`获取反序列化的 RootObject

* * *

还有一个用于 JSON 的新粘贴为类功能：http: [//blogs.msdn.com/b/webdev/archive/2012/12/18/paste-json-as-classes-in-asp-net-and -web-tools-2012-2-rc.aspx](http://blogs.msdn.com/b/webdev/archive/2012/12/18/paste-json-as-classes-in-asp-net-and-web-tools-2012-2-rc.aspx)

# database - 有条件地创建数据库用户语法错误

> ID：14691841
> 
> 赞同：0
> 
> 时间：2013-02-04T17:15:17.650
> 
> 标签：database, tsql, sql-server-2008-r2

如果数据库中尚不存在用户，我将使用以下内容创建用户：

```
use DBExample
GO

IF NOT EXISTS (SELECT * from sys.database_role_members WHERE USER_NAME(member_principal_id) = 'user1')
BEGIN
CREATE USER [user1] WITH PASSWORD = 'abc')
END

EXEC sp_addrolemember 'role1', 'user1'
GO 
```

DBExample 已经有一个 user1，因此当我尝试运行该脚本时，SQL Server Management Studio 会抱怨“'user1' 附近的语法不正确”。（在创建用户行中）

我缺少什么来完成这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:32:38.590

我认为您对此感到困惑`Logins`-`Users`至少在 SQL Server 2008R2 中，您不能没有另一个。我建议您快速浏览一下联机丛书以了解这些概念。

您可能正在寻找类似的东西：

```
IF NOT EXISTS (SELECT * from sys.server_principals WHERE name = 'user1')
BEGIN
CREATE LOGIN [user1] WITH PASSWORD = 'abc';
END
GO  

USE DBExample
GO

IF NOT EXISTS
(
  SELECT * from sys.database_principals dp
  INNER JOIN sys.server_principals sp on dp.sid = sp.sid
  WHERE dp.name = 'user1' or sp.name = 'user1'
)
BEGIN
CREATE USER [user1] FOR LOGIN [user1]
END
GO

IF NOT EXISTS (SELECT * from sys.database_role_members WHERE USER_NAME(member_principal_id) = 'user1')
BEGIN
EXEC sp_addrolemember 'role1', 'user1'
END

GO 
```

`Login`如果它不存在，则创建 a，然后转到数据库，然后如果它不存在则创建 a ，然后将 a与 a`User`关联。`User``Role`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:01:49.430

I used the answer found here: [https://stackoverflow.com/a/6159882](https://stackoverflow.com/a/6159882) to make use of variables to substitute the user name to get around the 'There is already login/user named xxx in the database' error SSMS was complaining about. The code looks like this at the end:

```
USE DBExample
GO

DECLARE @userName varchar(100)

SET @userName = 'user1'

IF NOT EXISTS (SELECT * from sys.server_principals WHERE name = @userName)
BEGIN
DECLARE @LoginSQL varchar(200);
SET @LoginSQL = 'CREATE LOGIN ' + @userName + ' WITH PASSWORD = abc';
EXEC (@LoginSQL);
END

IF NOT EXISTS (SELECT * from sys.database_principals WHERE name = @userName)
BEGIN
DECLARE @UserSQL varchar(200);
SET @UserSQL = 'CREATE USER ' + @userName + ' FOR LOGIN ' + @userName;
EXEC (@UserSQL);
END

IF NOT EXISTS (SELECT * from sys.database_role_members WHERE USER_NAME(member_principal_id) = @userName)
BEGIN
EXEC sp_addrolemember 'role1', @userName
END

GO 
```

# c - 温度转换器挑战

> ID：14691843
> 
> 赞同：-1
> 
> 时间：2013-02-04T17:15:21.843
> 
> 标签：c

我正在为一个网站做一个编码挑战，前提是：

> 在这个挑战中，编写一个接受三个参数的程序，一个起始温度（摄氏度）、一个结束温度（摄氏度）和一个步长。以步长为单位打印从 > 开始温度到结束温度的表格；如果步长不完全匹配，您实际上不需要打印最终结束温度。您应该执行输入验证：不接受低于下限（您的代码应指定为常数）或高于上限（您的代码也应指定）的起始温度。您不应允许步长大于温差。（本练习基于 C 编程语言中的一个问题）。

我得到了与解决方案相同的结果，但我很好奇为什么他们的解决方案更有效（我想是这样）。有谁能给我解释一下吗？他们的解决方案首先是我的。

```
#include <stdio.h>

#define LOWER_LIMIT 0
#define HIGHER_LIMIT 50000

int main(void) {
    double fahr, cel;
    int limit_low = -1;
    int limit_high = -1;
    int step = -1;
    int max_step_size = 0;

    /* Read in lower, higher limit and step */
    while(limit_low < (int) LOWER_LIMIT) {
       printf("Please give in a lower limit, limit >= %d: ", (int) LOWER_LIMIT);
       scanf("%d", &limit_low);
    }
while((limit_high <= limit_low) || (limit_high > (int) HIGHER_LIMIT)) {
    printf("Please give in a higher limit, %d < limit <= %d: ", limit_low, (int) HIGHER_LIMIT);
    scanf("%d", &limit_high);
}
max_step_size = limit_high - limit_low;
while((step <= 0) || (step > max_step_size)) {
    printf("Please give in a step, 0 < step >= %d: ", max_step_size);
    scanf("%d", &step);
}

/* Initialise Celsius-Variable */
cel = limit_low;

/* Print the Table */
printf("\nCelsius\t\tFahrenheit");
printf("\n-------\t\t----------\n");
while(cel <= limit_high) {
    fahr = (9.0 * cel) / 5.0 + 32.0;
    printf("%f\t%f\n", cel, fahr);
        cel += step;
    }
    printf("\n");

    return 0;
} 
```

我的解决方案：

```
#include <stdio.h>
#include <stdlib.h>

#define LOW 0
#define HIGH 50000

int main(void)
{
int lower, higher, step, max_step;
float cel, fahren;

printf("\nPlease enter a lower limit, limit >= 0: ");
scanf("%d", &lower);

if (lower < LOW)
{
    printf("\nERROR: Lower limit must be >= 0.");
    exit(1);
}

printf("\nPlease enter a upper limit, limit <= 50000: ");
scanf("%d", &higher);

if (higher > HIGH)
{
    printf("\nERROR: Upper limit must be <= 50,000.");
    exit(1);
}

printf("\nPlease enter an increment amount, 0 < step <= 10: ");
scanf("%d", &step);

max_step = higher - lower;

if (step > max_step)
{
    printf("\nERROR: Step size cannot exceed difference between higher and lower limit.");
    exit(1);
}

printf("Celsuis \tFahrenheit\n");
printf("------- \t-----------\n\n");

cel = (float)lower;

while (cel < higher)
{
    fahren = cel * 9/5 + 32;
    printf("%f \t%f\n", cel, fahren);
    cel = cel + step;
}

return 0; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:06:22.210

嗯，哪个更有效......在做出这个声明之前，我们需要一些指标，我们在这里谈论什么？运行？二进制大小？只是一个简单的例子......我们可以编译这两个解决方案并使用“时间”命令和最坏的情况（0-50000，步长为 1）运行它们，以查看我们使用的时间类型：

* * *

“他们的”解决方案大小：

```
text       data     bss     dec     hex filename
1937        276       8    2221     8ad a.out 
```

“他们的”解决方案运行时间：

```
user  0m 0.024s
sys   0m 0.601s 
```

* * *

您的解决方案尺寸：

```
text       data     bss     dec     hex filename
2054        276       8    2338     922 a.out 
```

您的解决方案运行时间：

```
user   0m 0.025s
sys    0m 1.047s 
```

* * *

因此，您的解决方案需要更长的时间并且图像尺寸更大。我们现在可以说“他们”有一个更有效的程序吗？不是真的，`time`在这个规模上并不完全准确（以及系统中发生的其他事情），所以我们需要多次运行。平均四次^*运行：

```
// you
user    0.0178
system  0.9015
// "them"
user    0.016
system  0.914 
```

所以不，它们并没有真正比你更“高效”。

我们可以做一些琐碎的事情来提高这里的“效率”，但是因为解决方案非常相似，而且代码非常简单（单步遍历），我不确定它是否有那么重要。

就“有效”代码大小而言，您会注意到您的`.text`大小大于其他解决方案。您的消息更加冗长和可读，因此您会受到影响。这样更有效率吗？也许如果大小很重要，但我个人认为可读性更重要，除非我们谈论的是嵌入式解决方案。

^(* - 你需要更多的运行和更敏感的计时机制，但这只是一个简单的例子)

# iphone - UIWebView 旋转

> ID：14691846
> 
> 赞同：0
> 
> 时间：2013-02-04T17:15:29.170
> 
> 标签：iphone, objective-c, ipad, uiwebview, rotation

我在我的应用程序中使用 UIWebView，当我旋转 iPhone 时，webview 也会随之旋转，效果很好。但是，当它旋转时，您会看到我的 webview 后面的背景视图的角落，并且在旋转时它看起来有点闪烁。

所以我去我的 iPhone 上尝试了 Safari，使用相同的网站，但它不同。在 Safari 中，如果我旋转，它会更加平滑，我还可以看到它略微缩放。

例如，我在苹果的主页上以纵向模式，完全缩小以查看整个页面。我旋转到横向，内容缩放，据我观察，这就是它看起来更平滑的原因。

所以，我的问题是，我怎样才能在我的应用程序中实现这一点？

我玩过“Scales Page To Fit”选项，但没有成功。

*当前：* 旋转缩放网页以适应视图。（整个页面被缩小才能看到）。

*必需：* 旋转时，而不是重新缩放页面，只需让它根据需要缩放。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:58:49.097

不知道这是否对您有帮助，但您可能会发现更改 webview 后面视图的背景颜色（甚至背景图像）很有用，这可能会缓解您看到角落的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T20:41:05.473

如果您还没有找到解决方案... 作为替代方案，您可以尝试刷新 webview，如果您注意到设备已旋转，刷新 webview 并且 webkit 应该再次渲染它，还可以使用 HTML 元视口标签（初始缩放、缩放等）和 CSS 媒体查询以支持不同的缩放。对于 HTML 文档，请尝试在 CSS 规则中使用*em*和*pt*单位。

```
//reload webview
[self.webView reload]; 
```

[链接](https://stackoverflow.com/questions/6111013/view-rotation-notifications-why-didrotatefrominterfaceorientation-doesnt-get)方向通知

希望这对某些事情有所帮助

# objective-c - 在 Objective-C 方法中重新指向指针

> ID：14691848
> 
> 赞同：2
> 
> 时间：2013-02-04T17:15:51.353
> 
> 标签：objective-c, pointers

首先，对不起，如果我的英语不是绝对正确。这不是我的母语，但我会尽力解释自己。

我很难理解以下问题。考虑以下代码：

```
// On a class named SPOTest
- (void)referenceTest:(NSMutableString *)originalText
{
    [originalText appendString:@" world!!!"]
}

// From another place
NSMutableString *myText = [NSMutableString stringWithString:@"Hello"];
NSLog(@"Contents of myText BEFORE: %@", myText);
SPOTest *myTest = [[SPOTest alloc] init];
[myTest referenceTest:myText];
NSLog(@"Contents of myText AFTER: %@", myText); 
```

输出：

```
Contents of myText BEFORE: Hello
Contents of myText AFTER: Hello world!!! 
```

我觉得可以理解。我正在使用指针，所以如果我改变事物和指针的结尾，我会为所有指向它的指针改变那个事物。另一方面，如果我更改代码并执行此操作：

```
// On a class named SPOTest
- (void)referenceTest:(NSMutableString *)originalText
{
    NSMutableString *newText = [NSMutableString stringWithString:@"Hello world!!!"];
    originalText = newText;
}

// From another place
NSMutableString *myText = [NSMutableString stringWithString:@"Hello"];
NSLog(@"Contents of myText BEFORE: %@", myText);
SPOTest *myTest = [[SPOTest alloc] init];
[myTest referenceTest:myText];
NSLog(@"Contents of myText AFTER: %@", myText); 
```

然后我得到这个：

```
Contents of myText BEFORE: Hello
Contents of myText AFTER: Hello 
```

这是为什么？我想正确的方法是使用双重间接和类似于`NSError`机制使用的实现，但我想了解为什么我会获得这种行为。如果我可以从第一个示例中的方法更改内容和`myText`指针的结尾`referenceTest:`，为什么我不能`myText`从第二个示例中的相同方法更改地址？

我知道我遗漏了一些微不足道的东西，但我找不到它，我想理解这一点以更好地理解`NSError`机制背后的推理。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:18:53.367

在第二种情况下，您正在更改该指针的本地副本。如果要在调用范围内重新指向它，则需要使用指向指针的指针，即：

```
- (void)referenceTest:(NSMutableString **)originalText
{
    NSMutableString *newText = [NSMutableString stringWithString:@"Hello world!!!"];
    *originalText = newText;
} 
```

并这样称呼它：

```
[myTest referenceTest:&myText]; 
```

值得注意的是 stringWithString 返回一个自动释放的字符串，这意味着你的函数也是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-22T14:15:00.727

对象和指向对象的指针是有区别的。

有人创建了一个 NSMutableString 对象，该对象存在于内存中的某处。我们真的不在乎它在哪里。有人收到了指向 NSMutableString 对象的 NSMutableString*。该 NSMutableString* 的副本已提供给您的方法 referenceTest。可以有任意数量的指向该 NSMutableString 对象的指针，但只有一个对象。

appendString 方法改变了 NSMutableString 对象本身。

stringWithString 方法创建一个新的 NSMutableString 对象并返回一个指向它的指针。所以现在我们有两个对象，newText 是指向第二个对象的指针。当您将 newText 分配给 originalText 时，originalText 将成为指向第二个 NSMutableString 对象的指针。但是， originalText 只是您方法中的参数。调用方法持有的指针不会因此而改变。

# java - 如何有效地锁定代码块以避免乐观锁定异常

> ID：14691850
> 
> 赞同：1
> 
> 时间：2013-02-04T17:15:55.970
> 
> 标签：java, multithreading, jpa, optimistic-locking

我对Java中的多线程不是很有经验。我想要的是为代码块设置一个锁。就我而言，我想避免乐观锁定异常，同时为某个用户进行一些同步。该方法`replicateUser`可以由同一用户的多个线程调用。但不能保证，那`authenticatedUser`总是同一个相同的对象。

那么我怎样才能有效地锁定这个部分呢？我不想要的是，该部分已锁定所有线程，但仅适用于具有相同用户的线程。我可以使用下面的示例对字符串对象进行锁定`getUserName()`吗？

```
private void replicateUser(AuthenticatedUser authenticatedUser) {
    //
    // How to synchronize the following block correctly?
    //
    synchronized (authenticatedUser.getUserName()) {
        User dbUser = userRepository.findOne(authenticatedUser.getUserName());
        if (!checkIsUserReplicated(authenticatedUser, dbUser)) {
            doReplication(dbUser);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:45:57.660

您最好锁定，`authenticatedUser.getUserName ().intern ()`因为一旦两个字符串的内容相同，就可以保证`intern ()`为它们返回相同的对象。

此外，如果在您的系统中保证只有一个`AuthenticatedUser`具有特定用户名的类实例，那么您可以直接锁定`authenticatedUser`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T18:44:56.787

正如您所提到的，在 authenticatedUser.getUserName() 上同步将不起作用，因为您可能有多个 authenticatedUser 实例。如果从不同的 EntityManager 上下文中读取，两个线程读取相同的 authenticatedUser 数据将获得不同的实例。为了解决这个问题，您可以通过使用 try/catch 块包装 doReplication 方法来解决偶尔出现的乐观锁异常，然后检查更改是否由另一个线程（使用 em.refresh）进行，或者您可以切换到使用此处描述的悲观锁定：http: [//wiki.eclipse.org/EclipseLink/Examples/JPA/Locking#Pessemistic_Locking](http://wiki.eclipse.org/EclipseLink/Examples/JPA/Locking#Pessemistic_Locking) [http://wiki.eclipse.org/EclipseLink/Examples/JPA/PessimisticLocking](http://wiki.eclipse.org/EclipseLink/Examples/JPA/PessimisticLocking)

锁定 authenticatedUser 后，您可以检查它是否已被复制并释放锁定或执行复制。

# digital-signature - 对数据而非文档进行数字签名

> ID：14691852
> 
> 赞同：2
> 
> 时间：2013-02-04T17:16:12.057
> 
> 标签：digital-signature, electronic-signature

什么构成*Web 表单*（而非文档）的“合法”数字签名？

**选项 1**：我参与了一个医生记录患者健康状况的项目。提交 Web 表单后，会生成 PDF 并使用数字 .CER 证书进行数字签名，并将 PDF 保存到文件系统中。每个医生都有自己的 .CER 文件和密码，这是要维护的真正 PITA，生成、存储和备份 PDF 的开销非常高。

还有像 CoSign 这样的第三方解决方案，它允许用户在提交表单时对 CoSign 进行身份验证，如果经过适当的身份验证，可以以某种方式对该表单进行数字签名。我相信所有这些解决方案都需要导出到各种类型的文档，然后存储文档，并要求最终签名者拥有 CoSign 帐户。那是行不通的...

所有这些签名都需要将数据存储在一个文档中，这对于许多项目来说并不理想。

**选项 2**：我去美国购物中心的微软商店购买了一个新的 Surface（稍后会退回：/），结账时他们给了我一个平板电脑（讽刺的是它不是 Surface）和一支笔，我记下了我的签名。另一个例子是 Square 应用程序，它还要求用户在某种触摸屏上记下他们的签名。我会假设签名作为图像存储在数据库中的某处，但这是否构成“合法”文件？

我曾在一家小型医疗设备公司工作，他们的医生在网络上评估测试并以数字方式“签署”他们的评估结果，但所做的只是上传保存在数据库中的签名图像。

**选项 3**：我看到的另一种方式是在当天填写我的 FAFSA 以获得大学学费资助时。他们会要求您查看条款，yada yada，然后我必须在底部输入我的法定全名“如上所示”并提交表格。**他们在窗帘后面做什么**？

我正在从事的项目是一份简单的一页合同，适用于一家建筑公司，其中解释了要提供的所有服务，并且需要签名和日期。此表格的电子版本将收集所有需要的数据，并将其保存到一个数据存储中。

我最初的反应是提供一个基于 <canvas> 的 HTML5 元素，可以在 iPad 或其他东西上签名。数据是否需要导出到文档，然后使用数字签名进行签名，或者数据是否合法并在数据存储中“签名”？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T07:14:21.647

你问了几个问题，其中只有一个是合法性问题。

预先披露：我为 CoSign 工作。

第一个问题：

**以数字方式签署 Web 表单与签署文档（PDF 等）** 是的，这是数字签名的常见应用程序。CoSign 支持它。通常的技术是首先将 Web 表单表示为 XML 文件。然后对 XML 文件进行数字签名。CoSign 的 SAPI api 直接支持根据[W3 标准对 XML 文件进行数字签名。](http://www.w3.org/TR/xmldsig-core/)从 SAPI 程序员指南中了解更多信息。可从[CoSign 开发者网站获得](http://www.arx.com/forum/dev.php)。

**验证数字签名的 XML 文件**您需要能够加密验证数字签名的 XML 文件。您可以为此使用 CoSign，或者还有许多其他应用程序也可以验证 XML 文件。Google for "verify xml digital signature" 看到一长串。数字签名的身份、意图和文档完整性的独立验证是使用标准数字签名的关键优势。

第二个问题：

**有什么办法可以解决用于数字签名的数字证书个人副本的高成本？** 正如您所发现的，颁发、跟踪、维护、替换和淘汰个人数字证书的成本非常高。这是使用颁发给个人签名者（智能卡、usb 令牌等）的硬件证书进行数字签名的一个常见（且很大）缺点。解决这个问题的方法是像 CoSign 和其他一些人一样集中存储证书。CoSign 自动与 Active Directory / LDAP 等同步，以摆脱单个硬件证书的支持和维护成本。

第三个问题：

**外部签名者是否需要在 CoSign 框中拥有自己的帐户？那是行不通的。** 对于外部签名者（组织外部的某个人，例如经常只签名一次的客户/客户/患者），可以通过编程方式创建签名帐户，对 XML 文档进行签名，然后删除该帐户。这种情况并不少见。CoSign SAPI api 支持为此目的创建/维护/删除帐户。

第四个问题：

**“所有这些签名都要求将数据存储在一个不适合许多项目的文档中”，这对吗？** 不，您可以按照我上面的解释对 XML 文档进行数字签名。Microsoft 的 InfoPath 表单系统、IBM Forms 系统和其他人也可以对从 Web 表单创建的 XML 文档进行签名。它是数字签名的常见应用程序。

第五个问题：

**Square 和其他网络表单签名应用程序在做什么？”**

在许多情况下，他们正在做“电子签名”而不是“数字签名”。

简而言之，电子签名是个人签名的图形表示。这就是文档中的全部内容。因此，文件本身并不能保证完整性或信誉不佳。即，某人可以更改文档（例如，通过策略性地添加单词“not”）并且签名看起来仍然相同。

为了增强固有的弱电子签名的强度，各种电子签名服务会将文档存储在其服务器上，从而为他们的公司提供文档完整性等方面的保证。您的选项 3 可能属于此类。Square，您的选项 2 也可能是电子签名。在他们的案例中，Square 本身保证在签署后没有任何改变。

电子签名在美国通常是合法的，但您应该咨询律师了解详情。由于依赖第三方（供应商）进行验证，许多组织不接受电子签名也是这种情况。电子签名的文件无法独立验证——您需要依赖供应商。例如，制药公司不能向 FDA 提交带有电子签名的文件，需要数字签名。在美国以外，由于技术的固有弱点，电子签名通常不再被接受。

**数字签名**可以对文档或 XML 文件或任何其他内容进行数字签名。数字签名通过加密技术保证文档没有被更改（完整性），签名是不可靠的（签名者标识）以及签名者在签名时的意图声明。任何人都可以使用许多地方提供的验证软件或应用程序来验证数字签名的文件。数字签名遵循开放标准，而电子签名则不遵循。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T09:22:50.060

> 什么构成 Web 表单（而非文档）的“合法”数字签名？

存在现有法律和实践的问题，如果法律是由不了解电子签名、数字签名和数字数据性质的人编写的，那么它们应该是什么问题。

在我看来，电子签名（手绘签名的图像）永远不应被视为具有法律约束力，伪造电子签名数据或创建包含签名图像的伪造数据是微不足道的。它们可以并且经常用于低安全性情况，但是它们对于断言数据的真实性或完整性毫无价值。在非常有限的情况下，它们可能有些安全，例如当有一个可信的、防篡改的设备来收集手绘签名（如 EFTPOS 或可信平板电脑）时，不应将消费者和（通常）商家的平板电脑视为可信设备.

另一方面，数字签名使用加密技术嵌入可以自动验证的签名，以断言文档/数据的真实性。只要私钥的安全性保持私密并且签名算法没有发现缺陷，这是一个非常有力的保证。在我看来，假设各方都理解数字签名，这是在任何情况下都应被视为具有法律约束力的唯一电子签名形式。

可以让受信任的第三方充当公证人，来断言文档或 Web 表单提交的真实性。该系统的安全性取决于公证人的声誉，当受信任的公证人使用适当的可信赖协议完成时，它可以具有法律约束力。一些电子公证人采用某种形式的数字签名，因此他们的断言在仅由数字签名提供的保证之上增加了一层额外的保证。

许多司法管辖区允许某些类型的交易使用较弱形式的电子签名。检查您当地的法律，如果对使用较弱的签名形式有疑问，请咨询精通电子交易的律师。正确使用数字签名来消除任何疑虑。

任何有限长度的二进制流都可以签名，它不必在文档中。但是，要拥有嵌入签名而不是外部签名，所包含的数据必须支持包含签名。

# ios - Quartz 2D 对创建自定义视图有用吗？

> ID：14691859
> 
> 赞同：0
> 
> 时间：2013-02-04T17:16:43.173
> 
> 标签：ios, iphone, cocoa, quartz-2d

Quartz 2D 是创建自定义视图的好选择吗？还有其他选择吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:30:20.997

是的！
这是标准的方法。
（另见 ios View Programming Guide，[自定义视图](http://developer.apple.com/library/ios/#documentation/windowsviews/conceptual/viewpg_iphoneos/CreatingViews/CreatingViews.html#//apple_ref/doc/uid/TP40009503-CH5-SW23)一章）

我已经使用`Quartz2D/Core Graphics`in `UIView::drawRect()` （罗盘、标尺、MkapView 的自定义用户位置）等完成了所有自定义视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:49:57.823

完全取决于你想做什么。进行 2d 绘图非常好，但您也可以使用图像。我更喜欢`CALayer`自己使用简单的效果。

我发布了关于[创建自定义控件](https://stackoverflow.com/a/5651516/474896)的答案以及将控件绘制到不同问题的几个选项，但它也适用于此处。

# excel-dna - 如何使用 ExcelDNA 选择单元格？

> ID：14691860
> 
> 赞同：1
> 
> 时间：2013-02-04T17:16:46.923
> 
> 标签：excel-dna

我想将焦点强制到一个特定的单元格上，我通过 XlCall.Excel(XlCall.xlfCaller) 有一个参考。我知道如何在 VSTO 中做到这一点，但是有没有办法用 ExcelDNA 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T13:06:43.500

可以使用 ExcelDNA：

```
var activeCell = new ExcelReference(5, 5);
ExcelAsyncUtil.QueueAsMacro(() => XlCall.Excel(XlCall.xlcSelect, activeCell)); 
```

可以跳过“ExcelAsyncUtil.QueueAsMacro”，这取决于您调用 Excel 命令的上下文。如果你从另一个 Excel 函数调用它 - 你应该用 QueueAsMacro 包装它

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T20:11:47.763

一种方法是使用 COM 自动化接口，就像使用 VBA 或 VSTO 一样。只要确保使用`Application`您从中获得的对象`ExcelDnaUtil.Application`作为您的根。要将`ExcelReference`您收到的转换`xlfCaller`为 COM`Range`对象，您可以尝试（这是 VB.NET 版本）：

```
Private Function ReferenceToRange(ByVal xlRef As ExcelReference) As Object 
     Dim strAddress As String = XlCall.Excel(XlCall.xlfReftext, xlRef, True) 
     ReferenceToRange = ExcelDnaUtil.Application.Range(strAddress) 
End Function 
```

如果您想坚持使用 C API，您首先必须选择正确的工作表，然后选择实际的单元格。所以你可能有：

```
string myCellSheet = (string)XlCall.Excel(XlCall.xlSheetNm, myCell);
XlCall.Excel(XlCall.xlcWorkbookSelect, new object[] { myCellSheet });
XlCall.Excel(XlCall.xlcFormulaGoto, myCell); 
```

您将无法更改工作表函数中的选择，因此我假设您是从宏或功能区处理程序中调用它。

# c++ - 将整数数组转换为 void 指针 - pthread_create

> ID：14691864
> 
> 赞同：0
> 
> 时间：2013-02-04T17:17:02.740
> 
> 标签：c++, type-conversion, void-pointers

对于传递参数，pthread 需要 void 指针。我想传递两个变量，`int`并且`long`. 为了省点麻烦，我将通过两个`long`代替。所以这就是我所做的：

```
int main(int argc, char *argv[])
{
   /*SOCKET INIT*/
   pthread_t socketTh;
   long data[2] = {ip2l(IP),80};
   pthread_create(&socketTh, 0, &serverConnect, (void*)data);   //ERROR HERE
   while(true) {
       /*event loop*/
   }
   quit_thread(&sockerTh);      //just an EXAMPLE! I don't know how to quit threads, I will google it later
   return 0;
 } 
```

### 错误：

> 错误：从 'void (*)(void*)' 到 'void* (*)(void*)' 的无效转换

但似乎这不是将长指针重新键入为 void 指针的正确方法。我不知道 Stackoverflow 建议我没有帮助的线程以及任何 Google 搜索。所以也许，试着慢慢地解释它，因为我是初学者，我仍然迷失在数据类型上。
谢谢你。

**更新：**
我`unsigned long*`在 main() 中创建。这意味着这个变量将与程序本身一样长。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T17:36:47.707

错误消息指的是**第三个**参数。`pthread_create`想要一个指向接受 a`void*`并返回的函数的指针`void*`。显然该函数`serverConnect`是一个接受 a`void*`并返回的函数`void`。

# python - 使用 python 查询网站/网络服务

> ID：14691865
> 
> 赞同：-1
> 
> 时间：2013-02-04T17:17:04.207
> 
> 标签：python, twitter, urllib2, urllib

我正在尝试每天为 Twitter 句柄查找推文，我发现这个名为“ [http://www.howoftendoyoutweet.com/](http://www.howoftendoyoutweet.com/) ”的网站 - 当您提供推特句柄时，它会每天为您提供推文。我希望我的 python 脚本查询该网站以获取 Twitter 句柄列表，并每天从页面中提取推文。

我知道我必须为此使用 urllib2 和 json，但不能。有没有更好的方法来每天查找推文？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:23:20.857

似乎[python-twitter](http://code.google.com/p/python-twitter/)库可能会给你更好的结果。

# c++ - 排除 PC-Lint 中的所有消息

> ID：14691869
> 
> 赞同：3
> 
> 时间：2013-02-04T17:17:12.840
> 
> 标签：c++, lint, pc-lint

我正在为我的 C++ 项目使用[PC-Lint 。](http://www.gimpel.com/html/pcl.htm)有没有办法默认关闭所有错误和警告消息，这样我就可以明确地重新引入所需的消息？

我已阅读 PC-Lint 手册中题为“错误抑制选项”的章节，我能找到的最好的方法是将 wLevel 设置为 -w0 无消息（致命错误除外）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T08:16:46.557

Yes, it is possible, you can simply use `-e*` or `-w0`. However, the manual truly states (Chapter 16\. Living with Lint):

> DO NOT simply suppress all warnings with something like: -e* or -w0 as this can disguise hard errors and make subsequent diagnosis very difficult.

So, yes, you can use it if your code is basically cleaned, and you want to review recent changes for a certain set of messages. But if you want to start cleaning your code, and are swamped with messages because of the default warning level `-w3`, I suggest to start using `-w1`, and resolve all issues there; most of the warnings/errors given at level one indicate problems with finding all header files, having al implicit macros set properly, and/or mimicking the compiler you use normally in a sufficiently precise way.

As always, I hesitate to advertise my own work, but if you want, take a look at my "[How to wield PC Lint](http://www.bezem.de/pdf/htwpl.pdf)" PDF, where I have documented detailed instructions to handle the initial deployment of PC Lint and tackling the many warnings/errors/infos/notes you may be buried under.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-24T13:04:21.303

当我开始将 PC-Lint 引入一个新项目时，我做了以下事情：

1.  正如 Johan Bezem 所建议的那样，`-w1`对整个事情进行了水平检查。这实际上并没有发现任何新问题，而是检查您的程序在语法上是否有效并发现任何配置问题。没什么大不了的，假设您的项目已经编译。

2.  `-w2`使用level再次运行测试。这发现了 53,000 个问题，一口气解决了很多问题。

3.  选择一个典型的坏文件，然后抑制任何看起来不相关或不紧急的错误（例如，`error 525: (Warning -- Negative indentation from line xxx)` 添加`-e525`到命令行或配置文件，直到找到一个看起来很严重的错误。在我的情况下 `error 442: (Warning -- for clause irregularity: testing direction inconsistent with increment direction)`，这是一个“for”循环看起来应该是在倒计时。

4.  在这种情况下，将测试级别重置为`-w1`按编号添加到关键问题中。`-w1 +e442`在整个项目中重新运行它，然后修复该问题的所有实例。

5.  返回第 2 阶段并重试。

这种解决实际问题和抑制可能的误报的组合很快就能让您的数字得到控制。

因此，随着时间的推移，一切都会变得更好，我们还实现了一个脚本，对创建或修改的任何文件进行彻底（完整`-w2`或）检查。`-w3`

我还发现[LintProject](http://www.codeproject.com/Articles/8526/LintProject-Improving-the-Usability-of-PC-Lint-wit)工具非常有用，因为它可以一次性完成整个 Visual Studio 解决方案，其中包含包含错误数量和最严重违规者的表格！

# java - 如何从 java.sql.Connection 获取用户名？

> ID：14691874
> 
> 赞同：6
> 
> 时间：2013-02-04T17:17:18.000
> 
> 标签：java, sql-server, jdbc, weblogic, jndi

我有一个在 Weblogic 中使用用户名“sa”创建的 SQLServer 数据源。

在代码中，我使用以下来获取用户名。

```
Context ctx = new InitialContext(prop);
Object obj = ctx.lookup("sqlserver1");
System.out.println("Data Source Found….");
DataSource ds = (DataSource) obj;
Connection conn = ds.getConnection();
DatabaseMetaData mtdt = conn.getMetaData();
// Get UserName
System.out.println("User name: " + mtdt.getUserName()); 
```

但上面的代码总是返回 'dbo' 作为用户名。我希望用户名是“sa”。如果数据库是 Oracle，它可以正常工作。我是否有一种通用的方法来获取所有不同类型数据库的用户名。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T19:25:19.163

正确的方法应该是`DatabaseMetaData.getUserName()`，但正如您所演示的，并非所有数据库都正确实现。另一种方法是使用 JDBC 函数转义，`USER()`例如（例如`SELECT {fn USER()} FROM DUAL`），但并非所有驱动程序都实现所有 JDBC 转义，它可能只是返回与`DatabaseMetaData`. 您也可以尝试在查询中定义`CURRENT_USER`（或`USER`）的 SQL 标准，但是您有两个问题：1）某些数据库要求您从表中选择（例如`DUAL`在 Oracle 中，有些则不需要）和 2）并非所有数据库都实现SQL 标准的所有部分，因此`CURRENT_USER`or`USER`上下文变量可能不存在。

但是当您拥有 DataSource 对象时，您可以尝试`user`从数据源中获取属性（它在 JDBC 4.1 规范的表 9.1 中定义，尽管此处描述的属性名称并非都是必需的）。

例如：

```
Method getter = new PropertyDescriptor("user", ds.getClass()).getReadMethod();
String value = (String) getter.invoke(ds); 
```

这假设 1)`DataSource ds`具有 a`getUser()`和 2) 它实际上已设置（例如，对于 SQL Server 集成安全性，数据源不需要了解用户）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-27T13:31:41.400

FWIW，Java 1.7 提供了[Connection.getSchema()](http://docs.oracle.com/javase/7/docs/api/java/sql/Connection.html#getSchema%28%29)方法。但是，我不知道此时 1.7 的采用范围有多广，因此这可能只是为了将来参考而牢记在心。

# jquery - 使用 JQuery 在标签内包装一组表行

> ID：14691875
> 
> 赞同：1
> 
> 时间：2013-02-04T17:17:17.517
> 
> 标签：jquery, html, ajax

我对 Jquery 有点陌生，但希望我能在某个问题上获得一些帮助。

**我创建了这段代码：**

```
if( jQuery.inArray(categoryList, movieArray) == -1 ){
         $('<h3 class="category"></h3>').html(categoryList).appendTo('#movieList');
          movieArray.push(categoryList);  
          $("#movieList").append("<thead><tr><th class='long'>" + txtTitle + "</th><th>" + txtLength + "</th><th>" + txtLanguage + "</th></thead>"); 
    }

    var rows = "<tr><td>" + title + "</td><td>" + movieTime + "</td><td>" + language + "</td></tr>";

    $("#movieList").append(rows);
});

    $('#movieList .category').each(function(){ 
        var $set = $(this).nextUntil(".category");
        $set.wrapAll('<div class="movieTable"><table class="table dataTable"></table></div>');
    }); 
```

基本上，我希望能够包装在标签中生成的 TR 标签组。原因是我想使用表格排序器插件，但除非表格区分 THEAD 和 TBODY，否则它将无法工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:36:55.457

为什么不直接附加表，然后将行附加到正确的类别？我不知道这个函数是如何运行的，但我认为这可能有效：

```
if( jQuery.inArray(categoryList, movieArray) == -1 ){
  $('<h3 class="category"></h3>').html(categoryList).appendTo('#movieList');
  movieArray.push(categoryList);
  $("#movieList").append("<div class='movieTable'><table class='table dataTable " + categoryList + "'><thead><tr><th class='long'>" + txtTitle + "</th><th>" + txtLength + "</th><th>" + txtLanguage + "</th></thead><tbody></tbody></table></div>");
}
$('table.' + categoryList).find('tbody').append("<tr><td>" + title + "</td><td>" + movieTime + "</td><td>" + language + "</td></tr>"); 
```

如果这不起作用，如果您提供基本演示会有所帮助。

# javascript - 实现 jQuery 计时器

> ID：14691877
> 
> 赞同：0
> 
> 时间：2013-02-04T17:17:24.177
> 
> 标签：javascript, jquery, timer

我从数据库中获取笔记列表并将它们显示到视图中，如果笔记不到 15 分钟，那么我将显示一个编辑按钮，允许用户内联编辑笔记并保存新信息。我有这部分工作充分。我现在正在尝试在不到 15 分钟的笔记上附加一个计时器，并在计时器到时隐藏按钮。NB 用户可以编辑多个注释，只要它们小于 15 分钟。由于我对 jQuery 和 Javascript 不太熟悉，我该怎么做呢？感谢您的任何回复，因为我对这个论坛的东西很陌生，我不确定您是否需要代码来回答这个问题。所以如果有人想看，我会放上去的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:21:27.387

我会为仍然可编辑的笔记添加一个 .editable 类，并在不再可编辑时将其删除。您可以在 data-time="1359999066" 属性中保留注释的时间（假设它是 unix 时间戳）。如果您需要我暗示的代码的进一步帮助，请告诉我。

```
(function checkTimer() {
    $('.note.editable').each(function() {
        //check for timestamp, remove .editable and hide button
    });
    if ( $('.note.editable').length ) setTimeout(checkTimer, 5000);
})();
// this will check every 5 seconds 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:21:49.307

用法

```
 var timer = $.timer(function() {
            alert('This message was sent by a timer.');
    });

    timer.set({ time : 5000, autostart : true });

    timer.set(options);
    timer.play(reset);  // Boolean. Defaults to false.
    timer.pause();
    timer.stop();  // Pause and resets
    timer.toggle(reset);  // Boolean. Defaults to false.
    timer.once(time);  // Number. Defaults to 0.
    timer.isActive  // Returns true if timer is running
    timer.remaining // Remaining time when paused 
```

[http://code.google.com/p/jquery-timer/](http://code.google.com/p/jquery-timer/)

它可能会解决您的问题..请参阅链接上的完整文章和演示

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:35:27.477

在服务器端，您可以将数据属性附加到包含创建时间的每个注释：

```
<div class="note" data-creation="1360000265027">
   <!-- milliseconds from 01.01.1970 (UTC) -->
   <p>My content</p>
   <button>edit</button>
</div> 
```

现在您可以检查这是否超过 15 分钟：

```
(function checkTimer() {
     $('.note').each(function(){
         var creation = $(this).data('creation'),
              // time in milliseconds from 01.01.1970 (UTC) minus 15min (900000milsec)
              fifteenAgo = (new Date).getTime() - 9e5;
         if (creation <= fifteenAgo) {
              $(this).find('button').remove();
         }
    });
    if ( $('.note button').length ) setTimeout(checkTimer, 5000);
})(); 
```

# java - 文档侦听器不活动 Java

> ID：14691879
> 
> 赞同：0
> 
> 时间：2013-02-04T17:17:37.540
> 
> 标签：java, swing, jcombobox, documentlistener

我正在尝试从 ComboBox 编辑器中获得响应。所以我`document listener`在组合框中添加了一个。问题是文档侦听器似乎根本没有工作。我认为听众没有连接到`combobox editor`. 我知道我错过了一些东西。这是代码：

```
 // constructor of GUI class
    ComboBoxDocumentHandler handle = new ComboBoxDocumentHandler();

    JTextComponent comboEditorComponent =(JTextComponent) InstantSearchBox.getEditor().getEditorComponent();

    doc = comboEditorComponent.getDocument();

    doc.addDocumentListener(handle);

   // Document Handler class and its method
private class ComboBoxDocumentHandler implements DocumentListener
{

    @Override
    public void changedUpdate(DocumentEvent event) {
    System.out.println("Inside"); // this statement is not printing when I add something to the combobox editor
    }
} 
```

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T17:39:27.970

*   所有这些事件都不会最终确定，直到派生的带有 JList 的 JPopup 可见，并且来自 Action 或 ItemListener 的所有事件都已完成，

*   派生文档的使用使我对 AutoComplete JComboBox 有意义（基本上必须包含文档并带有偏差）

*   有关所有相关事件和侦听器的示例

编辑

```
import java.awt.Component;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;
import javax.swing.plaf.basic.BasicComboBoxRenderer;
import javax.swing.text.Document;
import javax.swing.text.JTextComponent;

public class ComboBoxHoverOver {

    private JComboBox combo = new JComboBox();

    public ComboBoxHoverOver() {
        combo.setPrototypeDisplayValue("XXXXXXXXXXXXXXXXXXXXXX");
        combo.setRenderer(new ComboToolTipRenderer(combo));
        combo.addItemListener(new ItemListener() {

            @Override
            public void itemStateChanged(ItemEvent e) {
                System.out.println("itemStateChanged");
            }
        });
        combo.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                System.out.println("actionPerformed");
            }
        });
        combo.addItem("");
        combo.addItem("Long text 4");
        combo.addItem("Long text 3");
        combo.addItem("Long text 2");
        combo.addItem("Long text 1");
        combo.setEditable(true);
        JTextComponent tc = (JTextComponent) combo.getEditor().getEditorComponent();
        tc.getDocument().addDocumentListener(new DocumentListener() {

            @Override
            public void insertUpdate(DocumentEvent e) {
                updateLog(e, "inserted into");
            }

            @Override
            public void removeUpdate(DocumentEvent e) {
                updateLog(e, "inserted into");
            }

            @Override
            public void changedUpdate(DocumentEvent e) {
                updateLog(e, "inserted into");
            }

            public void updateLog(DocumentEvent e, String action) {
                Document doc = e.getDocument();
                int changeLength = e.getLength();
                System.out.println((changeLength + " character"
                        + ((changeLength == 1) ? " " : "s ")
                        + action + " " + doc.getProperty("name") + "."
                        + "  Text length = " + doc.getLength()));
            }
        });
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.add(combo);
        f.pack();
        f.setVisible(true);
    }

    private class ComboToolTipRenderer extends BasicComboBoxRenderer {

        private static final long serialVersionUID = 1L;
        private JComboBox combo;
        private JList comboList;

        ComboToolTipRenderer(JComboBox combo) {
            this.combo = combo;
        }

        @Override
        public Component getListCellRendererComponent(JList list, Object value, int index, boolean isSelected, boolean cellHasFocus) {
            super.getListCellRendererComponent(list, value, index, isSelected, cellHasFocus);
            System.out.println(value + ", " + index + ", " + isSelected + ", " + cellHasFocus);
            if (comboList == null) {
                comboList = list;
                KeyAdapter listener = new KeyAdapter() {

                    @Override
                    public void keyReleased(KeyEvent e) {
                        System.out.println("keyReleased " + e.getKeyCode());
                        if (e.getKeyCode() == KeyEvent.VK_DOWN || e.getKeyCode() == KeyEvent.VK_UP) {
                            int x = 5;
                            int y = comboList.indexToLocation(comboList.getSelectedIndex()).y;
                            System.out.println("keyReleased " + comboList.getSelectedIndex());
                        }
                    }
                };
                combo.addKeyListener(listener);
                combo.getEditor().getEditorComponent().addKeyListener(listener);
                comboList.addListSelectionListener(new ListSelectionListener() {

                    public void valueChanged(ListSelectionEvent e) {
                        if (e.getValueIsAdjusting()) {
                            JList list = (JList) e.getSource();
                            int item = list.getSelectedIndex();
                            if (item > -1) {
                                String string = list.getSelectedValue().toString();
                                System.out.println("valueChanged " + list.getSelectedValue().toString());
                            }
                        }
                    }
                });
            }
            if (isSelected) {
                System.out.println("isSelected " + value.toString());
            }
            return this;
        }
    }

    public static void main(String[] args) {

        java.awt.EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                ComboBoxHoverOver comboBoxHoverOver = new ComboBoxHoverOver();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:24:49.260

您的编辑器应该是 a `BasicComboBoxEditor`，然后您可以使用它的方法并使用该方法`addActionListener(yourListener);`

# perl - 如何在 Perl 中保留哈希的顺序？

> ID：14691881
> 
> 赞同：4
> 
> 时间：2013-02-04T17:17:46.200
> 
> 标签：perl, hash

我有一个 .sql 文件，我正在从中读取我的输入。假设文件包含以下输入....

```
Message Fruits Fruit="Apple",Color="Red",Taste="Sweet";

Message Flowers Flower="Rose",Color="Red"; 
```

现在我已经编写了一个 perl 脚本来从这个文件生成哈希..

```
use strict;
use Data::Dumper;

if(open(MYFILE,"file.sql")){
    my @stack;
    my %hash;
    push @stack,\%hash;
    my @file = <MYFILE>;
    foreach my $row(@file){
        if($row =~ /Message /){
            my %my_hash;
            my @words = split(" ",$row);
            my @sep_words = split(",",$words[2]);

            foreach my $x(@sep_words){
                my($key,$value) = split("=",$x);
                $my_hash{$key} = $value;
            }
            push @stack,$stack[$#stack]->{$words[1]} = {%my_hash};
            pop @stack;
        }
    }
    print Dumper(\%hash);
} 
```

我得到以下输出..

```
$VAR1 = {
          'Flowers' => {
                         'Flower' => '"Rose"',
                         'Color' => '"Red";'
                       },
          'Fruits' => {
                        'Taste' => '"Sweet";',
                        'Fruit' => '"Apple"',
                        'Color' => '"Red"'
                      }
        }; 
```

现在这里的哈希不保留读取输入的顺序。我希望我的哈希与输入文件中的顺序相同。我找到了一些像 Tie::IxHash 这样的库，但我想避免使用任何库。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T17:52:58.690

对于低调的方法，您始终可以将键保存在一个数组中，该数组确实有一个顺序。

```
foreach my $x(@sep_words){
    my($key,$value) = split("=",$x);
    $my_hash{$key} = $value;
    push(@list_keys,$key);
} 
```

然后提取，遍历键

```
foreach my $this_key (@list_keys) {
    # do something with $my_hash{$this_key}
} 
```

但这确实存在问题，您依赖于键数组和哈希保持同步。如果您不小心，您也可能不小心多次添加相同的密钥。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-04T17:47:53.980

Joel 说得对——你不能可靠地相信 Perl 中的哈希顺序。如果您需要某个订单，则必须将您的信息存储在一个数组中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-04T17:47:44.477

哈希是一组具有唯一键的键值对。集合本身永远不会被订购。

数组是任意数量的标量的序列。数组本身是有序的，但必须在外部强制执行唯一性。

这是我对您的问题的看法：

```
#!/usr/bin/perl

use strict; use warnings;
use Data::Dumper;

local $/ = ";\n";

my @messages;

while (<DATA>) {
    chomp;
    my ($msg, $to, $what) = split ' ', $_, 3; # limit number of fragments.
    my %options;
    while($what =~ /(\w+) = "((?:[^"]++|\\.)*)" (?:,|$)/xg) {
        $options{$1} = $2;
    }
    push @messages, [$to => \%options];
}

print Dumper \@messages;

__DATA__
Message Fruits Fruit="Apple",Color="Red",Taste="Sweet";
Message Flowers Flower="Rose",Color="Red"; 
```

我将消息放入一个数组中，因为它必须进行排序。另外，我不会用我不需要的堆栈做奇怪的体操。

我不会拆分所有换行符，因为您可以引用包含换行符的值。出于同样的原因，我不会盲目地拆分`,`或`=`使用合理的正则表达式。可能值得添加错误检测，例如`die if not defined pos $what or pos($what) != length($what);`在末尾（需要`/c` 正则表达式上的标志），以查看我们是否实际处理了所有内容或过早地被抛出循环。

这会产生：

```
$VAR1 = [
      [ 'Fruits',
        {
          'Taste' => 'Sweet',
          'Fruit' => 'Apple',
          'Color' => 'Red'
        }
      ],
      [ 'Flowers',
        {                                                                   
          'Flower' => 'Rose',                                               
          'Color' => 'Red'                                                  
        }
      ]
]; 
```

（有其他缩进，但这无关紧要）。

存在一个问题：文件必须由换行符终止，否则最后一个分号未被捕获。

# php - 以月日分或秒显示相关日期格式？

> ID：14691883
> 
> 赞同：0
> 
> 时间：2013-02-04T17:17:50.967
> 
> 标签：php, mysql

我试图将 mysql 时间戳转换为几个月或几天或几小时或几分钟的时间。

所以输出将如下所示：

添加于 1 个月前 / 添加： 0 小时前 / 添加： 21 分钟前 / 添加于 30 秒前

所以我只想要一种时间格式，具体取决于多少分钟或多少小时或多少天等，因此 60 分钟转换为 1 小时前或 24 小时转换为 1 天前，48 小时转换为 2 天前。

到目前为止我有这个代码：

```
<?
    $datetime1 = new DateTime();
    $datetime2 = new DateTime ($news['date_added']);
    $interval = $datetime1->diff($datetime2);
    str_replace('0 hours', '', $variable);
    echo $interval->format('%h hours %i minutes');
    ?> 
```

这将输出以下内容：

添加于 0 小时前 57 分钟前。

有人可以帮助我或告诉我需要做什么才能使格式正确显示，我对 php 真的很陌生，我不确定我该怎么做。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T17:37:22.680

来自[http://php.net/manual/en/ref.datetime.php](http://php.net/manual/en/ref.datetime.php)

只需在调用函数时将 $precision 更改为 1 并在日期之前和之后添加您想要的任何文本。您必须确保将日期对象转换为时间戳，但这对您来说应该不是问题。

```
/**
 * this code assumes php >= 5.1.0\. if using < 5.1, read
 * php.net/strtotime and change the condition for checking
 * for failure from strtotime()
 */

// $t1, $t2: unix times, or strtotime parseable
// $precision: max number of units to output
// $abbr: if true, use "hr" instead of "hour", etc.
function date_diff ($t1, $t2, $precision = 6, $abbr = false) {
    if (preg_match('/\D/', $t1) && ($t1 = strtotime($t1)) === false)
        return false;

    if (preg_match('/\D/', $t2) && ($t2 = strtotime($t2)) === false)
        return false;

    if ($t1 > $t2)
        list($t1, $t2) = array($t2, $t1);

    $diffs = array(
        'year' => 0, 'month' => 0, 'day' => 0,
        'hour' => 0, 'minute' => 0, 'second' => 0,
    );

    $abbrs = array(
        'year' => 'yr', 'month' => 'mth', 'day' => 'day',
        'hour' => 'hr', 'minute' => 'min', 'second' => 'sec'
    );

    foreach (array_keys($diffs) as $interval) {
        while ($t2 >= ($t3 = strtotime("+1 ${interval}", $t1))) {
            $t1 = $t3;
            ++$diffs[$interval];
        }
    }

    $stack = array();
    foreach ($diffs as $interval => $num)
        $stack[] = array($num, ($abbr ? $abbrs[$interval] : $interval) . ($num != 1 ? 's' : ''));

    $ret = array();
    while (count($ret) < $precision && ($item = array_shift($stack)) !== null) {
        if ($item[0] > 0)
            $ret[] = "{$item[0]} {$item[1]}";
    }

    return implode(', ', $ret);
}

$t1 = 'Feb 4, 2008 12:16:00';
$t2 = 'Jul 3, 2006 16:15:30';

echo date_diff($t1, $t2), "\n",
    date_diff($t1, $t2, 3), "\n",
    date_diff($t1, $t2, 2, true), "\n";

?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T17:46:16.687

这是一个可能的解决方案。您将时差格式化为带有月-日-小时-分钟-秒的字符串，然后查看该字符串以查找第一个非零数字：这就是您想要的...

```
$mdhms = explode('-',$interval->format('%m-%d-%H-%i-%s'));

$labels = Array(' months', ' days', ' hours', ' minutes', ' seconds');
$i = 0;
foreach($mdhms as $t){
  if($t > 0) break;
  $i+=1;
}
if ($i < 5) echo "It happened ".$t.$labels[$i]." ago";
else echo "It is happening right now!" 
```

# php - 创建用户对象

> ID：14691889
> 
> 赞同：0
> 
> 时间：2013-02-04T17:18:13.303
> 
> 标签：php, codeigniter

我正在开发一个 codeigniter 应用程序，并想在我的应用程序中创建一个用户对象，仅用于测试。

以下代码在后端控制器中运行，我不确定是否应该这样做。

```
class Backend_Controller extends MY_Controller 
{
    public $current_user = new stdClass;
    public $current_user->group = 'User Group';
    public $current_user->name = 'Kevin Smith';

    public function __construct()
    {
        parent::__construct();  

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:20:54.407

`$current_user->group`不是变量声明。您只是分配给已声明变量的属性。

此外，您不能像那样在类声明中进行函数调用，您只能设置常量。

PHP 文档：[http ://www.php.net/manual/en/language.oop5.properties.php](http://www.php.net/manual/en/language.oop5.properties.php)

您需要使用构造函数来制作对象。

```
class Backend_Controller extends MY_Controller 
{
    public $current_user;

    public function __construct()
    {
        parent::__construct();

        $this->current_user = new stdClass;
        $this->current_user->group = 'User Group';
        $this->current_user->name = 'Kevin Smith';

    }
} 
```

# excel - 将表格行大小更改为另一个表格行大小

> ID：14691893
> 
> 赞同：1
> 
> 时间：2013-02-04T17:18:26.200
> 
> 标签：excel, excel-2013

我在一张表中有一个通过 SQL 命令提供的表 1，我在另一张表中有另一个表 2 引用了表 1。我需要 table2 来根据 table1 调整行数，我该怎么做（希望没有 VBA）？

Table2 是一个具有计算列的表，然后每隔一列都是 table1 列。

我在 table2 中的引用是这样的：

`calc(table1[column1]) table1[column1] table1[column2] ....`

**注意：**我曾尝试在列参考中使用@，但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:47:14.430

我使用 VBA 解决了它，所以在有人在这里发布 VBAless 解决方案之前，您需要做的是：

1.  创建一个命名范围，我们将`range1`在**公式菜单 -> 名称管理器上调用它**

    =OFFSET('table2'!$A$1,0,0,ROWS(table1[#All]),COLUMNS(table2[#All]))

2.  转到 VBA 并创建以下子：

    ```
    Sub ResizeMyTable()

        ThisWorkbook.Sheets("sheet2").ListObjects("table2").Resize [range1]

    End Sub 
    ```

以下逻辑取决于您，我创建了一个按钮并执行`call ResizeMyTable`了更新表格。

# asp.net-mvc - 当我通过保持文本框填充/空来提交部分视图时，在这两种情况下都会加载完整视图。我如何调用 Ajax 来发布它？

> ID：14691895
> 
> 赞同：0
> 
> 时间：2013-02-04T17:18:33.470
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2, razor

我在 MVC3 中有 Area ，如下所述。

![在此处输入图像描述](../Images/eace3e5b5278d36d5f4e9d36a4cee76c.png)

**模型**

```
public class AdminModule
{
    [Display(Name = "MyName")]
    [Required(ErrorMessage = "MyName is missing")]
    public String MyName { get; set; }
} 
```

**我有以下代码的部分视图。**

```
@model _1.Areas.Admin.Models.AdminModule
@using (Ajax.BeginForm(new AjaxOptions { UpdateTargetId = "myForm" }))
{
    @Html.LabelFor(i => i.MyName)
    @Html.TextBoxFor(i => i.MyName)
    @Html.ValidationMessageFor(i => i.MyName)
    <p id="getDateTimeString">
    </p>
    <input type="submit" value="Click here" id="btn" />
} 
```

**看法**

```
@model _1.Areas.Admin.Models.AdminModule
@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutPage1.cshtml";
}
<h2>
    Index</h2>
<script src="/Scripts/jquery-1.5.1.min.js" type="text/javascript">
</script>
<script type="text/javascript" src="/scripts/jquery.unobtrusive-ajax.js">
</script>
<div id="myForm">
    @Html.Partial("_PartialPage1", Model)
</div> 
```

**布局**

```
<!DOCTYPE html>

<html>
<head>
    <title>@ViewBag.Title</title>
</head>
<body>
    <div>
        @RenderBody()
    </div>
</body>
</html> 
```

**控制器动作**

```
[HttpPost]
public ActionResult Index(AdminModule model)
{
    return PartialView(model);
}
[HttpGet]
public ActionResult Index()
{
    AdminModule model = new AdminModule();
    model.MyName = "My Name";
    return View(model);
} 
```

**混乱**

当我第一次提交。

我得到如下输出

![在此处输入图像描述](../Images/8bb58b8e17b81ed625b232006007b4b0.png)

和这样的形式显示。问题是 -**为什么索引词会出现两次？**

![在此处输入图像描述](../Images/a112bc89cbf8722da0c063f74b5fd59a.png)

当我第二次单击时，表单外观保持不变，输出如下所示。

问题 - 为什么 Jquery 来了这么多次？

![在此处输入图像描述](../Images/e7e3c230db9edbe00df05bce9d5140d5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T20:27:07.480

您可以使用 an`Ajax.BeginForm`而不是常规形式。但首先您应该决定在 AJAX 调用之后要更新页面的哪个部分。

让我们假设以下场景：如果 AJAX 调用成功，您想用一些结果更新 DOM 的某些部分，如果 AJAX 失败，您想更新表单并显示错误消息。

要实现这一点，您可以首先将表单放在部分 ( `_MyForm.cshtml`) 中：

```
@model _1.Models.HomeModels
@using (Ajax.BeginForm(new AjaxOptions { UpdateTargetId = "myForm" }))
{
    @Html.LabelFor(i => i.MyName)
    @Html.TextBoxFor(i => i.MyName)
    @Html.ValidationMessageFor(i => i.MyName)
    <input type="submit" value="Click here" id="btn" />
}

@if (Model.SomeResultProperty != null)
{
    <div>@Model.SomeResultProperty</div>
} 
```

然后你可以让你的主视图引用这个部分：

```
@model _1.Models.HomeModels
<div id="myForm">
    @Html.Partial("_MyForm", Model)
</div> 
```

下一步是更新将处理 AJAX 调用的控制器操作：

```
[HttpPost]
public ActionResult Index(HomeModels model)
{
    if (ModelState.IsValid)
    {
        // validation succeeded => we could set the result property
        // on the model to be displayed:
        model.SomeResultProperty = "this is the result";
    }
    return PartialView("_MyForm", model);
} 
```

最后，您需要将`jquery.unobtrusive-ajax.js`脚本包含到您的页面中，以便`Ajax.BeginForm`帮助程序工作：

```
<script type="text/javascript" src="@Url.Content("~/scripts/jquery.unobtrusive-ajax.js")"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:22:22.947

请改用 Ajax.BeginForm。

您是否在页面中引用了验证脚本？

# c# - Windows Phone 7 在页面之间传递值

> ID：14691899
> 
> 赞同：0
> 
> 时间：2013-02-04T17:18:43.267
> 
> 标签：c#, windows-phone-7

> **可能重复：**
> [如何将一个 xaml 页面中的图像值传递到 windows phone 7 中的另一个 xaml 页面？](https://stackoverflow.com/questions/3213354/how-to-pass-the-image-value-in-one-xaml-page-to-another-xaml-page-in-windows-pho)
> [在页面之间传递数据](https://stackoverflow.com/questions/4953491/passing-data-from-page-to-page)

我认为不是重复的，因为我没有找到我的问题的答案，我没有传递图像，我在 Page2 中传递了 2darray[3,3] 值。我正在开发一个 Windows Phone 7 应用程序。我有两个页面（主页和第 2 页）。我在主页上写了代码。我有一个带有值的二维数组。如何在 page2 中使用此数组？请给出一步一步的答案，我是初学者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:39:13.193

您可以使用 JSON 序列化您的数组。你可以像我一样使用[JSON.net 。](http://json.codeplex.com/)请记住，您不能将每个字符串都传递给您的 Uri - 如果它包含像**“&”**这样的字符，您的应用程序将会崩溃。这就是你必须使用**Uri.UnescapeDataString**的原因。

这是二维字符串数组的示例。如果您需要传递复杂的对象，仍然可以使用 JSON.net（请参阅文档）。只要记住在序列化后使用**Uri.UnescapeDataString 即可**。

**在从 JSON 反序列化数组之前**，您必须对其进行转义（**Uri.UnescapeDataString**）。

在您的源页面中：

```
using System;
using System.Net;
using System.Windows;
using Microsoft.Phone.Controls;
using Newtonsoft.Json;

namespace PhoneApp2
{
    public static class Extensions
    {

        public static string GetHtmlDecoded(this string str)
        {
            return HttpUtility.HtmlDecode(str);
        }

        public static string GetHtmlEncoded(this string str)
        {
            return HttpUtility.HtmlEncode(str);
        }

    }

    public partial class MainPage : PhoneApplicationPage
    {
        // Constructor
        public MainPage()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, RoutedEventArgs e)
        {

            var arrStr = new[,]
                {
                    {"aaaa$ffeaw&fewa=324&fewa", "fewa"},
                    {"aafw&fewa=324&fewa", "fefewa"},
                };

            string param = JsonConvert.SerializeObject(arrStr);
            param = Uri.EscapeDataString( param);

            var destination = new Uri("/Page1.xaml?arr=" + param, UriKind.Relative);
            NavigationService.Navigate(destination );
        }
    }
} 
```

在目标页面中：

```
using System;
using Microsoft.Phone.Controls;
using Newtonsoft.Json;

namespace PhoneApp2
{
    public partial class Page1 : PhoneApplicationPage
    {
        public Page1()
        {
            InitializeComponent();
        }

        protected override void OnNavigatedTo(System.Windows.Navigation.NavigationEventArgs e)
        {
            base.OnNavigatedTo(e);
            var param = Uri.UnescapeDataString(NavigationContext.QueryString["arr"]);
            var arr = JsonConvert.DeserializeObject<string[,]>(param);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:25:01.763

我还不熟悉 Windows Phone 7，但我想可以在 Page2 上声明一个公共属性并在创建后用数组填充它。

# android - 跟随教程时的 OSMDroid 路由问题

> ID：14691901
> 
> 赞同：1
> 
> 时间：2013-02-04T17:18:51.807
> 
> 标签：android, map, routing, osmdroid, openstreetmap

我利用以下代码将路线叠加到 OSM 机器人地图上，使用从以下教程 ( [http://code.google.com/p/osmbonuspack/wiki/Tutorial_1](http://code.google.com/p/osmbonuspack/wiki/Tutorial_1) ) 获得的代码，但稍微调整为自定义方法，而不是在 OnCrerate 方法中使用。

现在这确实路由并在地图上产生绿色覆盖。但是，从 For 循环开始就出现了一个问题。这是因为 road.mNodes 的大小始终为零，表示没有指令下来。

顺便说一句，我还检查了 RoadNodes 和 RoadItems，它们的大小也都是零。这意味着气泡（ExtendedOVerlayItems）永远不会显示在路线上。

任何建议将不胜感激。

```
//======================================================================================================
/**
 *  Add a route overlay between two geopoints with Bubble overlays on the route points.
 *  
 * @param startPoint Route start.
 * @param endPoint Route end.
 *//
//======================================================================================================
public void addRouteOverlay(GeoPoint startPoint, GeoPoint endPoint)
{
     //1 Routing via road manager
    RoadManager roadManager = new OSRMRoadManager();
    roadManager.addRequestOption("routeType=bicycle");

    //Then, retreive the road between your start and end point:
    ArrayList<GeoPoint> waypoints = new ArrayList<GeoPoint>();
    waypoints.add(startPoint);
    waypoints.add(endPoint); //end point

    Road road = roadManager.getRoad(waypoints);

    // then, build an overlay with the route shape:
    PathOverlay roadOverlay = RoadManager.buildRoadOverlay(road, map.getContext());
    roadOverlay.setColor(Color.GREEN);

    //Add Route Overlays into map
    map.getOverlays().add(roadOverlay);

    map.invalidate();//refesh map

    Drawable    marker = ctx.getResources().getDrawable(R.drawable.map_marker_blue);

    final ArrayList<ExtendedOverlayItem> roadItems = 
              new ArrayList<ExtendedOverlayItem>();
            ItemizedOverlayWithBubble<ExtendedOverlayItem> roadNodes = 
              new ItemizedOverlayWithBubble<ExtendedOverlayItem>(ctx, roadItems, map);

      for (int i=0; i<road.mNodes.size(); i++)
      {
              RoadNode node = road.mNodes.get(i);
              ExtendedOverlayItem nodeMarker = new ExtendedOverlayItem("Step "+i, "", node.mLocation, ctx);
              nodeMarker.setMarkerHotspot(OverlayItem.HotspotPlace.CENTER);
              nodeMarker.setMarker(marker);
              roadNodes.addItem(nodeMarker);

              nodeMarker.setDescription(node.mInstructions);
              nodeMarker.setSubDescription(road.getLengthDurationText(node.mLength, node.mDuration));
              Drawable icon = ctx.getResources().getDrawable(R.drawable.ic_continue);
              nodeMarker.setImage(icon);

      }//end for

      map.getOverlays().add(roadNodes);

}//=================================================================================================== 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-20T11:39:40.807

我今天遇到了这个问题并设法解决了它。问题在于奖金包的旧版本。我从 osmbonuspack_v3.8.jar 更新到版本 osmbonuspack_v4.1.jar 并解决了问题。我还使用了 MapQuestRoadManager() 选项，而不是 OSRMRoadManager()。但是，值得记住的是，在执行此操作时，奖励包中的一些超级类型方法发生了变化 - 例如所需的 ExtendedOverlayItem 上的 onOpen() 方法调用后要转换的参数。

```
final RoadManager manager= new MapQuestRoadManager();
manager.addRequestOption("routeType=fastest"); 
```

# php - 跳过结帐步骤

> ID：14691906
> 
> 赞同：0
> 
> 时间：2013-02-04T17:18:59.793
> 
> 标签：php, magento

我将 magento 实现为组织的内部网店。所有订单的运输、账单和付款信息都是相同的（它们将由 自动填写`LDAP`）。因此，我想跳过前 4 个结帐步骤并进入订单“审核”。

我已经看过课程：

```
Controller/Checkout/controllers/OnepageController.php
Model/Checkout/Model/Type/Onepage.php 
```

但我找不到，哪个 Method 是由 button 触发的`proceed the checkout`。

我怎样才能意识到它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T15:24:49.917

由于您要完成的不是默认的 magento 结帐工作流程，因此您可以尝试以编程方式创建自己的自定义结帐，这样您就可以完全控制并绕过单页结帐的同谋。

请参阅 [在 Magento 中以编程方式创建订单](http://inchoo.net/ecommerce/magento/programmatically-create-order-in-magento/)

# python - 使用 Python 的新正则表达式模块创建模糊匹配异常

> ID：14691908
> 
> 赞同：4
> 
> 时间：2013-02-04T17:19:03.257
> 
> 标签：python, regex, pypi-regex

我正在测试新的 python[正则表达式](http://pypi.python.org/pypi/regex/)模块，它允许模糊字符串匹配，到目前为止，它的功能给我留下了深刻的印象。但是，我在使用模糊匹配处理某些例外时遇到了麻烦。以下是一个很好的例子。我想和1 的编辑距离内的`ST LOUIS`所有变体相匹配。但是，我想对这条规则做一个例外：编辑不能包括在包含字母、、或的最左侧字符的左侧插入。在以下示例中，我希望输入 1 - 3 与 ref 匹配，而输入 4 则失败。但是，使用以下`ST LOUIS``ref``N``S``E``W``ref`使其匹配所有四个输入。熟悉新的正则表达式模块的人是否知道可能的解决方法？

```
input1 = 'ST LOUIS'
input2 = 'AST LOUIS'
input3 = 'ST LOUS'
input4 = 'NST LOUIS'

ref = '([^NSEW]|(?<=^))(ST LOUIS){e<=1}'

match = regex.fullmatch(ref,input1)
match
<_regex.Match object at 0x1006c6030>
match = regex.fullmatch(ref,input2)
match
<_regex.Match object at 0x1006c6120>
match = regex.fullmatch(ref,input3)
match
<_regex.Match object at 0x1006c6030>
match = regex.fullmatch(ref,input4)
match
<_regex.Match object at 0x1006c6120> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T17:36:07.113

尝试否定前瞻：

```
(?![NEW]|SS)(ST LOUIS){e<=1} 
```

`(ST LOUIS){e<=1}`匹配满足放置在其上的模糊条件的字符串。您想阻止它以`[NSEW]`. 负前瞻可以为您做到这一点`(?![NSEW])`。但是您想要的字符串`S`已经以 a 开头，您只想排除以`S`添加到字符串开头的字符串。这样的字符串会以 开头`SS`，这就是为什么它被添加到负前瞻中。

请注意，如果您允许错误 > 1，这可能无法按预期工作。

# emacs - 如何在emacs中用空格替换'_'

> ID：14691909
> 
> 赞同：2
> 
> 时间：2013-02-04T17:19:06.603
> 
> 标签：emacs

我有一个文本文件，我只能看到某些单词之间有下划线，仅使用 emcas 编辑器而不是其他编辑器，例如 vi。我不知道如何使用 emacs，但我想在 emacs 编辑器自动方式中用空格替换这些下划线“_”。我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T18:06:56.203

我相信那些下划线并不是真正的下划线，而是不间断的空格（[U+00A0 unicode char](http://en.wikipedia.org/wiki/Non-breaking_space)），Emacs 显示为具有不同颜色的下划线。您可能不需要替换它们，但如果确实需要，只需使用`M-x replace-string`并杀死并拉出要替换的字符串中的不间断空格之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:10:43.300

如果前面的答案不能解决它：请记住这是一个编码系统错误。使用 Cx = 检查是否为 char 95。如果不是，请检查变量 coding-system-for-read、coding-system-for-write、buffer-file-coding-system

最后，通过 help-gnu-emacs@gnu.org 获取 emacs 核心开发人员

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:36:14.927

点击`M-x`组合键（即按住元键 - Windows 上的 alt - 并点击 x）类型 replace-string 并点击回车。然后可以输入[下划线]回车[空格]回车。

在 Emacs 表示法中：

`M-x replace-string RET _ RET " "`

# php - Codeigniter：像这样加密密码安全吗？

> ID：14691914
> 
> 赞同：0
> 
> 时间：2013-02-04T17:19:19.723
> 
> 标签：php, security, codeigniter

我想知道是否有人可以给我一些建议吗？我想知道以下代码用于使用 Codeigniter 加密密码有多安全/不安全或其他垃圾？

```
$safe_password = sha1($password, $config['encryption_key']) 
```

如果不安全，人们可以给我一些提示以使其使用 Codeigniter 更安全吗？

非常感谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:25:11.293

众所周知，sha1 容易受到碰撞攻击，请尝试使用 bcrypt，因为它是最好的之一。如果 bcrypt 对您不起作用，请使用 sha512 并添加盐。
bcrypt 可能看起来令人生畏，但这里有一篇关于为什么你应该使用它的文章：http: [//phpmaster.com/why-you-should-use-bcrypt-to-hash-stored-passwords/](http://phpmaster.com/why-you-should-use-bcrypt-to-hash-stored-passwords/)

sha1 不安全的原因是因为碰撞攻击，这里是暴露 sha1 安全风险的论文之一：[http ://www.schneier.com/blog/archives/2005/02/cryptanalysis_o.html](http://www.schneier.com/blog/archives/2005/02/cryptanalysis_o.html)

如果您想使用 sha512，您需要做的就是：

```
hash('sha512', $password.$salt); 
```

并确保您始终使用盐，否则有人可以使用彩虹表（数据库）来查看您的哈希是否与数据库中的通用密码匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:25:40.210

更好的解决方案是使用 bcrypt，看看这个[教程](http://codahale.com/how-to-safely-store-a-password/)。

这是一个可以与 Codeigniter 一起使用的小型库[https://github.com/waldirbertazzijr/codeigniter-bcrypt](https://github.com/waldirbertazzijr/codeigniter-bcrypt)

另一个相关的[问题](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php/6337021#6337021)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:26:00.333

sha1 和 md5 等散列算法不适用于密码存储。它们的设计非常高效。这意味着暴力破解非常快。即使黑客获得了您散列密码的副本，暴力破解也很快。如果您使用盐，它会使彩虹表的效果降低，但对蛮力没有任何作用。使用较慢的算法会使蛮力无效。例如，bcrypt 算法可以随心所欲地变慢，并且它在内部使用盐来防止彩虹表。如果我是你，我会采用这种方法或类似方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T17:27:05.137

来自 PHP 文档

> string sha1 ( string $str [, bool $raw_output = false ] ) 如果可选**raw_output 设置为 TRUE**，则​​ sha1 摘要以长度为 20 的原始二进制格式返回，否则返回值为 40 个字符十六进制数。

我的建议使用`BCRYPT`它更安全以便于实施，您可以尝试[password_compat](https://github.com/ircmaxell/password_compat)

例子

```
$hash = password_hash($password, PASSWORD_BCRYPT); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-04T17:27:55.000

不，`sha1()`不被认为是安全的，例如在这里： [http ://www.php.net/manual/en/faq.passwords.php#faq.passwords.fasthash](http://www.php.net/manual/en/faq.passwords.php#faq.passwords.fasthash)

目前，一个不错的选择可能是使用盐的 SHA512：`hash('sha512', 'text+salt')`

# html - 使用 HTML5 元素/ARIA 角色的首选技术

> ID：14691920
> 
> 赞同：5
> 
> 时间：2013-02-04T17:20:13.107
> 
> 标签：html, semantics, progressive-enhancement, graceful-degradation, wai-aria

所以这是我时常思考的一个小问题。大约一两年来，我一直对使用 HTML5 元素的最佳方式感到好奇。

我看到的最常见的技术 - 除了类和 ARIA 角色之外，使用页眉、页脚、部分等元素。对旧版浏览器使用 html5shiv.js。

这更符合优雅降级而不是渐进增强。如果 JS 在较旧的移动/桌面浏览器中未启用/根本不可用，我们将失去对仅使用 HTML5 元素构建的布局进行样式设置的能力。

我见过的另一种方法更符合渐进增强，并且不依赖于在旧浏览器中启用 JS 以使布局正常工作。我已经与 Josh Clark[Global Moxie] 简单讨论过这个问题。他们在 m 中使用了这种方法。人物杂志版。[http://www.people.com/people/mobile/home/](http://www.people.com/people/mobile/home/)他们使用 HTML5 元素来帮助勾勒文档的语义和带有样式类的 div。没有样式依赖于 HTML5 元素，如页眉、页脚、旁边、部分。

我的一个问题是，如果已经在 div 上设置了 ARIA 角色，那么在我的 div/spans 周围分层 HTML5 元素是否有益于为文档标记提供更好的轮廓？除了“语义化”之外，这还有什么好处？

如果在用于样式的 div 周围添加 HTML5 元素，将 ARIA 角色从 div 移动到 HTML5 元素是否有益？我假设它会，但希望获得有关此技术的更多反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T18:48:49.243

HTML5 规范极大地改进了大纲算法的自动化，因此浏览器和屏幕阅读器肯定会从您包含的 html5 标签和 ARIA 角色中受益。

Mozilla 就该主题制作了一篇很棒的文档，该文档解决了将 html5 元素合并到 html4 文档中的问题。这应该是一个很好的例子，说明您可以将一些 div 换成更多语义元素。在这里找到：[https ://developer.mozilla.org/en-US/docs/HTML/Sections_and_Outlines_of_an_HTML5_document](https://developer.mozilla.org/en-US/docs/HTML/Sections_and_Outlines_of_an_HTML5_document)

话虽如此，HTML5 的新语义元素确实占据了 div 的大部分领域，但当没有其他符合您的目的的语义上合适的元素时，仍应使用 div。html5 Doctor 也大大扩展了这一点。在这里找到：http: [//html5doctor.com/you-can-still-use-div/](http://html5doctor.com/you-can-still-use-div/)

# tfs - TFS 2012 API - 设置版本控制权限？

> ID：14691924
> 
> 赞同：1
> 
> 时间：2013-02-04T17:20:23.713
> 
> 标签：tfs, tfs-sdk

我正在尝试通过 TFS API 设置 TFS 项目的各种版本控制权限。这是我正在使用的代码，它成功设置了给定文件夹路径的读取和签出权限：

```
 IIdentityManagementService ims = tpc.GetService<IIdentityManagementService>();
        TeamFoundationIdentity userIdentity = ims.ReadIdentity(IdentitySearchFactor.AccountName,
                                                "Guest",
                                                MembershipQuery.None,
                                                ReadIdentityOptions.IncludeReadFromSource);

        ISecurityService ss = tpc.GetService<ISecurityService>();
        SecurityNamespace securityNamespace = ss.GetSecurityNamespace(SecurityConstants.RepositorySecurityNamespaceGuid);

        securityNamespace.SetPermissions(folderPath, userIdentity.Descriptor, RegistryServicePermissions.AllPermissions, 0, true); 
```

我不明白的是在 SetPermissions 的第三个参数（“允许”参数）中使用的值，以便设置各种内容，例如签入、管理分支等。MSDN 文档含糊不清。

```
 public abstract AccessControlEntry SetPermissions(
            string token,
            IdentityDescriptor descriptor,
            int allow,
            int deny,
            bool merge
    ) 
```

“允许”参数的描述简单地说：

```
 allow
    Type: System.Int32 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:34:30.077

allow 的内容应该是您希望对该特定身份允许的确切权限的值，例如。VersionedItemPermissions.Read

因为它是一个枚举，所以它被列为 int32，因为枚举支持 TFS 中的各种实体，即构建、版本控制、工作项跟踪等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-15T19:20:50.730

您可以像这样使用 int 参数：

```
 int allow = (int)Microsoft.TeamFoundation.VersionControl.Common.VersionedItemPermissions.Read;
    int deny = (int)(Microsoft.TeamFoundation.VersionControl.Common.VersionedItemPermissions.AdminProjectRights |
                        Microsoft.TeamFoundation.VersionControl.Common.VersionedItemPermissions.Checkin |
                        Microsoft.TeamFoundation.VersionControl.Common.VersionedItemPermissions.CheckinOther |
                        Microsoft.TeamFoundation.VersionControl.Common.VersionedItemPermissions.PendChange |
                        Microsoft.TeamFoundation.VersionControl.Common.VersionedItemPermissions.Label |
                        Microsoft.TeamFoundation.VersionControl.Common.VersionedItemPermissions.ReviseOther |
                        Microsoft.TeamFoundation.VersionControl.Common.VersionedItemPermissions.LabelOther |
                        Microsoft.TeamFoundation.VersionControl.Common.VersionedItemPermissions.Lock |
                        Microsoft.TeamFoundation.VersionControl.Common.VersionedItemPermissions.ManageBranch |
                        Microsoft.TeamFoundation.VersionControl.Common.VersionedItemPermissions.Merge |
                        Microsoft.TeamFoundation.VersionControl.Common.VersionedItemPermissions.UndoOther |
                        Microsoft.TeamFoundation.VersionControl.Common.VersionedItemPermissions.UnlockOther); 
```

# java - 是否有一个简单的 CLI Java linter？

> ID：14691926
> 
> 赞同：94
> 
> 时间：2013-02-04T17:20:38.987
> 
> 标签：java, lint

我一直在尝试找到一个能够在 CLI 上运行的 Java linter，它与 Eclipse 不同，我可以将其称为 git 的提交钩子或我们的自动构建脚本。这样的事情存在吗？

理想情况下，它需要检查未使用的导入和变量，遵循样式指南，正确使用异常等。尽管这些功能的某些子集会比我们现在拥有的更好 - 什么都没有！

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2013-02-04T17:31:23.320

*   [SpotBugs](https://spotbugs.github.io/)（早期的[Findbugs](http://findbugs.sourceforge.net/)）用于查找现有错误。很好！
*   [PMD](http://pmd.sourceforge.net/)用于查找可能导致错误的模式（例如未使用的变量）
*   [Checkstyle](http://checkstyle.sourceforge.net/)强制执行编码标准和约定（例如空格、Javadoc）
*   [容易出错](http://errorprone.info/)的钩子直接进入应用程序的编译步骤
*   [clang-format](https://clang.llvm.org/docs/ClangFormat.html)支持 java 并且可能已经在您的系统上可用

所有这些工具都有一些重叠的规则。还有许多其他类似的工具，但这些是最受欢迎和受支持的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-01-14T15:19:25.270

另外，请查看[Sonar](http://www.sonarqube.org/)，它结合了许多其他工具并为它提供了一个很好的视图。

> 来自 Checkstyle、FindBugs、PMD、Clirr、fb-contrib 的规则。

* * *

不确定如何将其添加到提交后挂钩，但[http://docs.codehaus.org/display/SONAR/Analyzing+with+Maven](http://docs.codehaus.org/display/SONAR/Analyzing+with+Maven)可能是一个很好的起点（特别是如果您使用的是 maven）。

甚至可以考虑使用[http://docs.codehaus.org/display/SONAR/Continuous+Integration](http://docs.codehaus.org/display/SONAR/Continuous+Integration)中列出的方法之一，因为您似乎正在尝试为整个团队寻找更好的工具（“尽管这些功能会比*我们*现在拥有的更好——什么都没有！”

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2014-07-29T19:07:13.777

这正是我正在做的事情：一个对 CLI 友好的工具，用于检查 Java 代码的质量。它还具有交互模式。您可以运行单个查询（以检查单个警告）或同时运行所有查询。

这些工具还处于早期阶段，但我几乎每天都在研究它。可在此处获得：

[https://github.com/ftomassetti/effectivejava](https://github.com/ftomassetti/effectivejava)

请让我知道您对此有何看法，并随时提出问题。

# asp.net-mvc - MVC 中的子域 URL 重定向

> ID：14691928
> 
> 赞同：0
> 
> 时间：2013-02-04T17:20:44.643
> 
> 标签：asp.net-mvc, url, iis, subdomain, url-redirection

我是 MVC 的新手，我有一个 url 重定向列表：

•website1.domain.com 转到 domain.com\websites\1

•website2.domain.com 转到 domain.com\websites\2

这是一个像这样的动态映射： websiteN.domain.com 转到 domain.com\websites\N

我如何在 MVC 中做到这一点，我需要使用路由吗？或者我只需要 URL 重定向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:28:02.277

**这是一个重复的问题。**

您需要的一切都可以在 IIS 中完成。

请访问此堆栈链接：

[在 IIS 中为 Web 应用程序处理子域](https://stackoverflow.com/questions/5960442/handling-sub-domains-in-iis-for-a-web-application)

（同一个用户问了这个问题并转发[了How can we make an ASP.NET MVC4 route based on a subdomain?](https://stackoverflow.com/questions/14632057/how-can-we-make-an-asp-net-mvc4-route-based-on-a-subdomain)）

您可以获得更详细的信息：

[http://www.dotnetexpertguide.com/2012/04/aspnet-iis-dns-records-sub-domain-on.html](http://www.dotnetexpertguide.com/2012/04/aspnet-iis-dns-records-sub-domain-on.html) [http://content.websitegear.com/article/subdomain_setup.htm](http://content.websitegear.com/article/subdomain_setup.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:28:37.337

我遇到过类似的情况，我需要确保语言代码在 url 中。

我的解决方案是编写一个 http 模块。您将希望此模块检查请求并查看请求所在的子域。如果它是子域，那么您需要将它们重定向到 domain.com 下的正确目录

# paypal - 将运费添加到 PayPal 简单链式付款？

> ID：14691929
> 
> 赞同：1
> 
> 时间：2013-02-04T17:20:46.960
> 
> 标签：paypal, paypal-adaptive-payments, chained

我正在使用 PayPal 简单的链式支付流程，而不是嵌入到我网站的交易中。是否可以让买家在交易中选择他们经过 PayPal 验证的送货地址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T06:31:15.867

据我所知，（目前）不允许用户在自适应支付流程中从他们的帐户中选择送货地址，但是，如果您让用户将送货地址填写到您的应用中，您可以使用[SetPaymentOptions](https://www.x.com/developers/paypal/documentation-tools/api/setpaymentoptions-api-operation)将送货地址绑定到付款在某一点。

您将调用 Pay 并将操作设置为 CREATE，然后在其后调用 SetPaymentOptions 以配置您想要的任何其他选项。您可以通过该额外调用添加很多东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:15:24.157

不，送货地址仅在嵌入式支付流程中受支持。

# swing - 这是 JDK1.6/JDK1.7 中 Swing 中的错误，但 JDK1.5 中没有？

> ID：14691930
> 
> 赞同：1
> 
> 时间：2013-02-04T17:20:50.307
> 
> 标签：swing, java

我有一个应用程序，其 GUI 是在 Java Swing JDK1.5 中开发的。我计划将 JDK 升级到 JDK1.6，但这样做会给我带来问题。

问题陈述：如果我打开几个对话框（比如 10 个）并处理它们，然后调用方法 'getOwnedWindows()' ，它在 JDK1.5 中返回 0，但在 JDK1.6 中返回 10。与在 JDK1.6 中它返回 10 一样，我设置焦点的算法无法正常工作，因为它能够找到 invlaid/disposed 对话框并尝试将焦点设置在它上，但不能设置在正确且有效的对话框或组件上，因为算法使用 getOwnedWindows () 获取有效且当前打开的对话框。

谁能建议我在JDK1.6中避免这个问题的解决方法？

下面的一段代码可以证明这个问题。

自定义对话框类：Java 代码：

```
import javax.swing.JDialog;
import java.awt.event.ActionListener;
import javax.swing.JPanel;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JButton;
import java.awt.event.ActionEvent;

public class CustomDialog extends JDialog implements ActionListener {
    private JPanel myPanel = null;
    private JButton yesButton = null;
    private JButton noButton = null;
    private boolean answer = false;
    public boolean getAnswer() { return answer; }

    public CustomDialog(JFrame frame, boolean modal, String myMessage) {
    super(frame, modal);
    myPanel = new JPanel();
    getContentPane().add(myPanel);
    myPanel.add(new JLabel(myMessage));
    yesButton = new JButton("Yes");
    yesButton.addActionListener(this);
    myPanel.add(yesButton);
    noButton = new JButton("No");
    noButton.addActionListener(this);
    myPanel.add(noButton); 
    pack();
    setLocationRelativeTo(frame);
    setVisible(true);
    //System.out.println("Constrtuctor ends");
    }

    public void actionPerformed(ActionEvent e) {
    if(yesButton == e.getSource()) {
        System.err.println("User chose yes.");
        answer = true;
        //setVisible(false);
    }
    else if(noButton == e.getSource()) {
        System.err.println("User chose no.");
        answer = false;
        //setVisible(false);
    }
    }

    public void customFinalize() {
        try {
            finalize();
        } catch (Throwable e) {
            e.printStackTrace();
        }
    }
} 
```

主类：

Java 代码：

```
import java.awt.event.ActionListener;
import javax.swing.JFrame;
import javax.swing.JButton;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.awt.event.ActionEvent;
import java.awt.FlowLayout;
import java.awt.Window;

public class TestTheDialog implements ActionListener {
    JFrame mainFrame = null;
    JButton myButton = null;
    JButton myButton_2 = null;

    public TestTheDialog() {
        mainFrame = new JFrame("TestTheDialog Tester");
        mainFrame.addWindowListener(new WindowAdapter() {
                public void windowClosing(WindowEvent e) {System.exit(0);}
            });
        myButton = new JButton("Test the dialog!");
        myButton_2 = new JButton("Print no. of owned Windows");
        myButton.addActionListener(this);
        myButton_2.addActionListener(this);
        mainFrame.setLocationRelativeTo(null);

        FlowLayout flayout = new FlowLayout();
        mainFrame.setLayout(flayout);

        mainFrame.getContentPane().add(myButton);
        mainFrame.getContentPane().add(myButton_2);

        mainFrame.pack();
        mainFrame.setVisible(true);
    }

    public void actionPerformed(ActionEvent e) {
        if(myButton == e.getSource()) {
            System.out.println("getOwnedWindows 1 " + mainFrame.getOwnedWindows().length);
            createMultipleDialogs();

            int i = 0;
            for (Window singleWindow : mainFrame.getOwnedWindows()) {
                System.out.println("getOwnedWindows " + i++ + " "
                        + singleWindow.isShowing() + " "
                        + singleWindow.isVisible() + " " + singleWindow);
            }
            System.out.println("getOwnedWindows 2 " + mainFrame.getOwnedWindows().length);
            //System.gc();
            System.out.println("getOwnedWindows 3 " + mainFrame.getOwnedWindows().length);
            //System.gc();
            System.out.println("getOwnedWindows 4 " + mainFrame.getOwnedWindows().length);
        } else if (myButton_2 == e.getSource()) {
            System.out.println("getOwnedWindows now: " + mainFrame.getOwnedWindows().length);
        }
    }

    public void createMultipleDialogs() {
        for (int a = 0; a < 10; a++) {
            CustomDialog myDialog = new CustomDialog(mainFrame, false,
                    "Do you like Java?");
            myDialog.dispose();
            myDialog.customFinalize();
        }
    }

    public static void main(String argv[]) {

        TestTheDialog tester = new TestTheDialog();
    }
} 
```

运行上面的代码会为 JDK1.5 和 JDK1.6 提供不同的输出

我将感谢您在这方面的帮助。

谢谢

# android - Android布局剪切按钮背景

> ID：14691932
> 
> 赞同：0
> 
> 时间：2013-02-04T17:21:01.427
> 
> 标签：android, xml, android-layout, layout

按钮背景 ( ) 的一小部分`button.png`被截断。这里的`res/layout/activity_home_screen.xml`文件：

```
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".HomeScreen"
    android:background="@drawable/bg_repeat"
    android:padding="20dp"
    android:stretchColumns="0" >

    <TableRow
        android:layout_margin="10dp" >

            <Button
                android:id="@+id/news_button"
                android:textSize="40sp"
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:background="@drawable/button"
                android:text="@string/news_button"

                android:onClick="gotoNews" />

    </TableRow>
    <TableRow
        android:layout_margin="10dp">

        <Button
            android:id="@+id/events_button"
            style="@style/AppBaseTheme"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/button"
            android:text="@string/events_button"
            android:textSize="40sp"
            android:onClick="gotoEvents" />

    </TableRow>
    <TableRow
        android:layout_width="match_parent" 
        android:layout_margin="10dp">

        <Button
            android:id="@+id/nav_button"
            style="@style/AppBaseTheme"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/button"
            android:text="@string/nav_button"
            android:textSize="40sp"

            android:onClick="gotoNav" />

    </TableRow>
</TableLayout> 
```

如何不切断背景？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:33:10.440

尝试使用 LinearLayout 而不是 TableLayout。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"
android:padding="20dp"
tools:context=".HomeScreen" >

<Button
    android:id="@+id/news_button"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_margin="10dp"
    android:onClick="gotoNews"
    android:text="@string/news_button"
    android:textSize="40sp" />

<Button
    android:id="@+id/events_button"
    style="@style/AppBaseTheme"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_margin="10dp"
    android:onClick="gotoEvents"
    android:text="@string/events_button"
    android:textSize="40sp" />

<Button
    android:id="@+id/nav_button"
    style="@style/AppBaseTheme"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_margin="10dp"
    android:onClick="gotoNav"
    android:text="@string/nav_button"
    android:textSize="40sp" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:48:23.773

这是因为你已经投入了保证金

查看

```
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"

    android:stretchColumns="0" >

    <TableRow

         >

            <Button
                android:id="@+id/news_button"
                android:textSize="12sp"
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:background="@drawable/button"
                android:text="News"

                />

    </TableRow>
    <TableRow
        android:layout_margin="10dp">

        <Button
            android:id="@+id/events_button"
            style="@style/AppBaseTheme"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/button"
            android:text="Events"
            android:textSize="40sp"
             />

    </TableRow>
    <TableRow
        android:layout_width="match_parent" 
        android:layout_margin="10dp">

        <Button
            android:id="@+id/nav_button"

            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/button"
            android:text="Nave"
            android:textSize="40sp"

             />

    </TableRow>
</TableLayout> 
```

希望能帮助到你！

# sql - H2 列名选择返回不正确的列名；“未找到列“OUT_ID”；SQL 语句：”

> ID：14691934
> 
> 赞同：0
> 
> 时间：2013-02-04T17:21:09.313
> 
> 标签：sql, import, h2, csv

我正在使用[H2 数据库](http://www.h2database.com/html/main.html)，版本“H2 1.3.170 (2012-11-30)”

我有以下**制表**符分隔的文件内容：

```
in:value1:String    out:id:Int  out:description:String
N/A 0   N/A
Forced Available    1   Forced Available
Forced Not Available    2   Forced Not Available 
```

我正在使用以下语句来创建表：

```
CREATE TABLE xo_coverage_voip_on_xo_override AS SELECT * FROM CSVREAD('C:\Temp\xo_coverage_voip_on_xo_override.tab', 'in_value_1' || chr(9) || 'out_id' || chr(9) || 'out_description', 'UTF-8', chr(9)); 
```

我尝试将创建的表与此一起使用：

```
SELECT out_id FROM xo_coverage_voip_on_xo_override; 
```

我收到这个错误：

```
"Column "OUT_ID" not found; SQL statement:" 
```

我哪里错了？

此外，我真的很想在插入之前从表中删除第一行。但是，我无法让 WHERE 子句起作用。

您能提供的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:02:40.753

因此，解决方案最终成为以下语句：

```
CREATE TABLE xo_coverage_voip_on_xo_override1(in_value1 varchar, out_id int, out_description varchar)
  AS SELECT * FROM CSVREAD('C:\Temp\xo_coverage_voip_on_xo_override.tab', null, 'UTF-8', chr(9)); 
```

关键是让 CSVREAD 查询将数据加载到完全指定的表中。并为标题行提供“null”，以便在文件中跳过它。

# codeigniter - codeigniter 中的 ajax 错误

> ID：14691937
> 
> 赞同：0
> 
> 时间：2013-02-04T17:21:15.273
> 
> 标签：codeigniter, jquery

我有一个具有以下脚本的控制器

```
class get extends CI_Controller
{
    function get_password()
    {
        $this->load->model('fetch_model');
        $user_pass=$this->fetch_model->get_password(); 
        $data['user_pass'] = json_encode($user_pass);
        echo $data['user_pass'];
    }
} 
```

和视图页面上的脚本是这样的

```
function get_password(){
    $.post("<?php echo base_url();?>admin.php/get/get_password",function(data)
    {      
        for(i=0;i<data.length;i++)
        {
            $('#password').val(data[i].password);
            $('#username').val(data[i].username);
        }
    },"json");
} 
```

现在，如果我在模型中使用以下脚本，那么 ajax 帖子可以完美运行..

```
class fetch_model extends CI_Model
{
    function get_password()
    {
        return  $this->db->query("SELECT * FROM td_admin_user")->result_array();
    }
} 
```

但是当我将模型脚本更改为此时，ajax 脚本不起作用

```
class fetch_model extends CI_Model
{
    function get_password()
    {
        foreach($this->db->query("SELECT * FROM td_admin_user")->result() as $r_pass)
        {
            $pass=$r_pass->password;
            $user=$r_pass->username;
        }
        $user_pass=array('username'=>$user,
                         'password'=>$pass);
        return $user_pass;
    }
} 
```

但坦率地说，我需要通过以下方式发送数据

```
$user_pass  =   array('username'=>$user, 'password'=>$pass); 
```

而不是 result_array()

所以请在这种情况下帮助我，在此先感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:13:24.857

这不是错误！您是否甚至查看了每次调用中返回的数据类型？

在您的 JS 中，您正在使用：

```
$('#password').val(data[i].password); 
```

索引数组在哪里`data`- 正是返回的内容`->result_array()`

但是你希望它是一个基于键的数组：

```
$user_pass=array('username'=>$user, 'password'=>$pass); 
```

如果是这种情况，您应该忘记在 JS 上使用 for 循环（特别是如果您的查询只产生一行）并使用

```
 $('#password').val(data.password); 
```

反而。

还要查看`console.log`（如果您使用的是萤火虫/开发者工具）并尝试`print_r`或`var_dump`在 PHP 端了解您返回的数据格式。

# haskell - 功能依赖中的模糊类型

> ID：14691939
> 
> 赞同：3
> 
> 时间：2013-02-04T17:21:17.997
> 
> 标签：haskell, ghc

在 haskell**功能依赖** [wiki](http://www.haskell.org/haskellwiki/Functional_dependencies)中：

鉴于这些定义：

```
data Vector = Vector Int Int deriving (Eq, Show)
data Matrix = Matrix Vector Vector deriving (Eq, Show)
instance Num Vector where
  Vector a1 b1 + Vector a2 b2 = Vector (a1+a2) (b1+b2)
  Vector a1 b1 - Vector a2 b2 = Vector (a1-a2) (b1-b2)
  {- ... and so on ... -}

instance Num Matrix where
  Matrix a1 b1 + Matrix a2 b2 = Matrix (a1+a2) (b1+b2)
  Matrix a1 b1 - Matrix a2 b2 = Matrix (a1-a2) (b1-b2)
  {- ... and so on ... -}
class Mult a b c where
  (*) :: a -> b -> c

instance Mult Matrix Matrix Matrix where
  {- ... -}

instance Mult Matrix Vector Vector where
  {- ... -} 
```

我不明白为什么会有模棱两可的类型：

```
m1, m2, m3 :: Matrix
(m1 * m2) * m3              -- type error; type of (m1*m2) is ambiguous 
```

显然，当*m1*和*m2*是*Matrix*时，唯一可能的返回类型是*Matrix*，即应用`instance Mult Matrix Matrix Matrix`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T18:08:10.120

问题在于类型类声明

```
class Mult a b c where
  (*) :: a -> b -> c 
```

通过应用`(*)`两个参数，您无法确定结果的类型。假设您有两个实例：

```
instance Mult Int Int Int where ...
instance Mult Int Int Integer where ... 
```

然后`2 * 4`可以是 type`Int`以及 of `Integer`。

现在你可以争辩说你只有一个实例，所以编译器不应该抱怨。但是 Haskell 类型的类生活在一个开放的世界中。您总是可以添加更多实例，并且它*不能在其他地方破坏代码*。因此，即使您只有一个实例，另一个库中的其他人也可以添加另一个实例。而且，您将有两个库，每个库都可以工作，但一起失败。这显然是不正确的。请参阅Real World Haskell[中的生活在开放世界中。](http://book.realworldhaskell.org/read/using-typeclasses.html#id608052)

因此，通常类型类中函数的返回类型必须可从其参数派生。这正是功能依赖的用途。如果你声明

```
class Mult a b c | a b -> c where 
```

那么编译器总能分辨出`(*)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T18:05:53.810

因为您忘记了所有其他可能性，例如

```
 instance Mult Matrix Matrix Vector where
 instance Mult Vector Matrix Vector where
 instance Mult Float Matrix Float where
 instance Mult Matrix Matrix Float where  -- etc.

 a :: Vector
 a = (m1 >< m2:: Vector) >< m3

 b :: Float
 b = (m1 >< m2:: Float) >< m3 
```

向类定义添加功能依赖：

```
instance Mult a b c | a b -> c 
```

将意味着

```
instance Mult Matrix Matrix Matrix 
```

决定两个矩阵的问题，并且

```
instance Mult Matrix Matrix Vector
instance Mult Matrix Matrix Float 
```

被排除在外，因为它们提供了另一种查看“a`Matrix`和 a的乘积”的方式`Matrix`。因此，您发现直观的事态是您将获得的功能依赖关系。

如果函数依赖是这样制定的：

```
 instance Mult a b c | b -> a c 
```

这也将允许您陈述的两个实例，

```
 instance Mult Matrix Matrix Matrix where
 instance Mult Matrix Vector Vector where 
```

但排除我想象的其他人，他们都`Matrix`在这个`b`位置（因为他们不得不这样做，因为在模棱两可的例子`m3`中被解释为一个`Matrix`而不是矩阵乘积的结果。

# java - java中的预测文本

> ID：14691942
> 
> 赞同：0
> 
> 时间：2013-02-04T17:21:21.833
> 
> 标签：java, swing, user-interface, autocomplete

> **可能重复：**
> [如何在文本字段中输入时列出建议](https://stackoverflow.com/questions/6674462/how-to-list-suggestions-to-when-typing-inside-the-text-field)

有没有办法在 java swing 中的 JTextField 中获取预测文本？就像如果我想从用户那里获取城市的名称，那么它应该预测城市。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:32:03.663

SwingX 提供自动完成功能：[http ://swingx.java.net/](http://swingx.java.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:38:53.653

我的一些程序中有一个自动完成功能。不幸的是，我无法找到我在互联网上获得信息的地方。我发布了我拥有的代码，但我不是这个 AutoCompleteDocument 类的“原始”作者。如果您在互联网上找到它，请给我链接，以便将功劳归于原作者。

```
public class AutoCompleteDocument extends PlainDocument {

    private final List<String> dictionary = new ArrayList<String>(); 
    private final JTextComponent jTextField;

    public AutoCompleteDocument(JTextComponent field, String[] aDictionary) {
        jTextField = field;
        dictionary.addAll(Arrays.asList(aDictionary));
    }

    public void addDictionaryEntry(String item) {
        dictionary.add(item);
    }

    @Override
    public void insertString(int offs, String str, AttributeSet a)
            throws BadLocationException {
        super.insertString(offs, str, a);
        String word = autoComplete(getText(0, getLength()));
        if (word != null) {
            super.insertString(offs + str.length(), word, a);
            jTextField.setCaretPosition(offs + str.length());
            jTextField.moveCaretPosition(getLength());
        }
    }

    public String autoComplete(String text) {
        for (Iterator<String> i = dictionary.iterator(); i.hasNext();) {
            String word = i.next();
            if (word.startsWith(text)) {
                return word.substring(text.length());
            }
        }
        return null;
    }  
} 
```

然后使用它只需用类似的东西初始化它

```
AutoCompleteDocument autoCompleteDoc;

autoCompleteDoc = new AutoCompleteDocument(aJTextField, anArray);
aJTextField.setDocument(autoCompleteDoc); 
```

希望它会有所帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:40:19.240

这是一种可能的实现：

```
public class Predict
{
    private final static String [] COLORS = new String [] {"red", "orange", "yellow", "green", "cyan", "blue", "violet"};

    public static void main (String [] args)
    {
        final JTextField field = new JTextField ();

        field.getDocument ().addDocumentListener (new DocumentListener()
        {
            @Override
            public void removeUpdate (DocumentEvent e)
            {
                // Do nothing
            }

            @Override
            public void insertUpdate (DocumentEvent e)
            {
                if (e.getOffset () + e.getLength () == e.getDocument ().getLength ())
                    SwingUtilities.invokeLater (new Runnable()
                    {
                        @Override
                        public void run ()
                        {
                            predict (field);
                        }
                    });
            }

            @Override
            public void changedUpdate (DocumentEvent e)
            {
                // Do nothing
            }
        });

        JFrame frame = new JFrame ("Auto complete");
        Container contentPane = frame.getContentPane ();
        contentPane.setLayout (new BorderLayout ());
        contentPane.add (field, BorderLayout.CENTER);
        frame.pack ();
        frame.setDefaultCloseOperation (JFrame.EXIT_ON_CLOSE);
        frame.setVisible (true);
    }

    private static void predict (JTextField field)
    {
        String text = field.getText ();

        String prediction = null;

        for (String color: COLORS)
        {
            if (color.startsWith (text) && !color.equals (text))
            {
                if (prediction != null) return;

                prediction = color;
            }
        }

        if (prediction != null)
        {
            field.setText (prediction);

            field.setCaretPosition (text.length ());
            field.select (text.length (), prediction.length ());
        }
    }
} 
```

# file - 在 IE8 客户端浏览器中从指向远程服务器的 Windows 2008 R2 Web 服务器显示文件

> ID：14691945
> 
> 赞同：0
> 
> 时间：2013-02-04T17:21:33.270
> 
> 标签：file, asp.net-mvc-4, iis-7.5, windows-server-2008-r2

问题涉及同一域中的以下机器：
服务器 A：Microsoft Windows Server 2003、标准
服务器 B：Microsoft Windows Server 2008 R2、标准（IIS 7.5）
客户端 A：Windows XP、IE8
客户端 B：Windows 7、IE9

我们在服务器 B 上运行了一个 MVC Web 应用程序。在其中一个页面上，有指向服务器 A 上的 PDF 文件的链接。如果通过客户端 B 访问，PDF 显示得很好。但是，在客户端 A 上，单击链接时没有响应 - 不起作用。该页面最初的实现方式大不相同，但由于访问文件的问题，它已被简化以重新创建服务器 A 上的旧应用程序（它正在被替换）是如何执行此操作的（如下所示）。当我将此测试页面放在另一个运行 2003（服务器 C）的 Web 服务器上时，PDF 链接使用客户端 A 可以正常工作。公司内网用户在不久的将来都使用 IE8，所以我想制定以下具体实现在进行更广泛的浏览器支持之前。

测试页标记：

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Marketing - Direct Mail Test</title>
        <style type="text/css">
            table tr th { text-align: left; }
            table tr td { text-align: left; }
        </style>
    </head>
    <body >
        <h3>Direct Mail Test</h3>
        <p>Direct mail advertisements that have been mailed to this customer. Click <b>Preview</b> to view.</p>
        <table width="700">
        <tr>
            <th>Start Date</th>
            <th>End Date</th>
            <th></th>
            <th class="w100p">Offer Name</th>
            <th class="nowrap">File Type</th>
        </tr>
        <tr>
            <td>11/13/2012</td>
            <td>4/1/2013</td>
            <td><a href="\\ServerName\ShareName\SomeDirectory\TestFile.pdf" title="TestFile.pdf" target="_blank">preview</a></td>
            <td>TestFile</td>
            <td>pdf</td>
        </tr>
        </table>
    </body>
</html> 
```

有谁知道如何使它适用于客户端 A/服务器 B？在这种情况下，为 IE8 配置选项不是一个实用的解决方案，因为客户公司已经为用户的机器建立了标准映像。

我已经尝试过以下操作：
- 将服务器 B 的网站上的应用程序池标识设置为具有文件共享权限的域用户帐户
- 将服务器 B 的网站“连接为”设置设置为具有文件共享权限的域用户帐户
- 在服务器 B 的网站的配置编辑器，设置 useAppPoolCredentials=true

提前感谢您的回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T15:37:48.897

在其中一位网络管理员在服务器 B 上创建了指向服务器 A 上的文件夹的映射驱动器后，此问题已得到解决。服务器 B 网站上的应用程序池标识也必须设置为具有权限的域用户帐户文件共享。但是，上面提到的其他两个 IIS 设置不是必需的。

# c++ - 局部变量的值没了？

> ID：14691951
> 
> 赞同：-6
> 
> 时间：2013-02-04T17:21:47.400
> 
> 标签：c++

我有这个实现：

```
//header file:

InfoTables* localInforTable;

typedef txdr_int32 InfoTable;

typedef struct
{
  int sendID;
  InfoTable *data;
} InfoTables;

// in cpp file
void Retrieval::InfoTableCallBack(int sendID,
                  InfoTables& infoTables)
{
    localInforTable = new InfoTables();

    localInforTable.sendId=sendID;
    localInforTable->data = infoTables.data;

    printf("Data %d, %d\n", localInforTable.sendId, localInforTable->data[0]); // correct data
}

void Retrieval::CheckInfoData()
{
    printf("Data %d, %d\n", localInforTable.sendId, localInforTable->data[0]); // sendID is OK but data9[0] is just printing the address
} 
```

我想将方法​​ InforTableCallBack 中的 inforTables 复制到可用于其他方法的局部变量。但是数据在 CheckInfoData() 中被清理了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T17:23:48.810

代码存在各种错误。首先，`data`不指向任何分配的内存。其次，[`memcpy`](http://en.cppreference.com/w/cpp/string/byte/memcpy)对于不可复制的用户定义类型根本不起作用。您可以改用`MyData`' 赋值运算符：

```
void myMethod1(Mydata &otherdata)
{
  *data = otherdata;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:26:59.960

添加到 juanchopanza 的答案：

假设代码有错字（如果真的是`memcpy()`）

`memcpy(&data, &otherdata, sizeof(otherdata));`将根本无法正常工作，因为`data`它已经是一个指针。并且指针上的“&”是指针的地址=只是错误使用`memcpy`

# xml - 使用 VBA 的 XMLImport 和 ImportMap

> ID：14691962
> 
> 赞同：0
> 
> 时间：2013-02-04T17:22:17.893
> 
> 标签：xml, excel, xsd, xmlmapper, vba

这是我的问题..

我目前已经构建了一个代码，因此我可以通过 URL 导入我的 XML 数据。问题是当我使用此代码时，它会丢弃任何没有数据的列。我需要包含这些列，因为我有预先设定的公式，可以用数据填充其他工作表。我想我需要一个 XML 映射才能这样做。然后我创建了一个代码，以便通过 XSD URL 将 XML 映射引入文件。在逐步浏览 VBA 之后，我注意到通过以下代码将正确的 XSD 映射带入文件：

```
Dim strRestXSD As String 'References URL to retrieve XSD
Dim oMap As xmlmap
Set oMap = ActiveWorkbook.XmlMaps.Add(strRestXSD) 
```

问题出在下面的代码中。我使用下面的代码，然后使用附加到 XML URL 的字符串提取 XML。无论出于何种原因，当想要使用上面标识的 XMLMap 时，都会忽略 ImportMap。下面的代码实际上创建了一个新地图，并忽略了使用上面的代码创建的地图。

```
Dim strRestURL As String XML data

ActiveWorkbook.XmlImport URL:=strRestURL, ImportMap:=oMap, Overwrite:=False,
Destination:=Range("A$1" & lngRow) 
```

有人知道我可以在不丢失空列的情况下导入 XML 数据的方法吗？或者您知道我可以将我的 XML 映射映射到 XML 导入的方法吗？

在此先感谢您的帮助！

阿里·阿克巴里

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-04-15T17:15:30.477

Setting Destination:=Nothing 应该将数据导入现有地图。此外，您可能需要设置 Overwrite:=True; 否则，将追加现有映射表中的数据。

# eclipse - Eclipse Juno 使用“Maven Project Builder”构建错误

> ID：14691964
> 
> 赞同：15
> 
> 时间：2013-02-04T17:22:24.897
> 
> 标签：eclipse, eclipse-plugin, m2eclipse, eclipse-juno

当我尝试清理和构建我的 Maven 项目时，我收到以下错误：

```
Errors occurred during the build.
Errors running builder 'Maven Project Builder' on project '(Hid Project Name)'.
org/apache/maven/project/MavenProject
Errors running builder 'Maven Project Builder' on project '(Hid Project Name)'.
org/apache/maven/project/MavenProject 
```

与 clean all 过程类似，它会抛出以下内容：

```
Errors occurred during the build.
Errors running builder 'Maven Project Builder' on project '(Hid Project Name)'.
loader constraint violation: loader (instance of org/eclipse/osgi/internal/baseadaptor/DefaultClassLoader) previously initiated loading for a different type with name "org/apache/maven/plugin/MojoExecution"
Errors running builder 'Maven Project Builder' on project '(Hid Project Name)'.
org/apache/maven/plugin/MojoExecution
Errors running builder 'Maven Project Builder' on project '(Hid Project Name)'.
org/apache/maven/plugin/MojoExecution
Errors running builder 'Maven Project Builder' on project '(Hid Project Name)'.
org/apache/maven/plugin/MojoExecution
Errors running builder 'Maven Project Builder' on project '(Hid Project Name)'.
org/apache/maven/plugin/MojoExecution
Errors running builder 'Maven Project Builder' on project '(Hid Project Name)'.
org/apache/maven/plugin/MojoExecution
Errors running builder 'Maven Project Builder' on project '(Hid Project Name)'.
org/apache/maven/plugin/MojoExecution
Errors running builder 'Maven Project Builder' on project '(Hid Project Name)'.
org/apache/maven/plugin/MojoExecution
Errors running builder 'Maven Project Builder' on project '(Hid Project Name)'.
org/apache/maven/plugin/MojoExecution
Errors running builder 'Maven Project Builder' on project '(Hid Project Name)'.
org/apache/maven/plugin/MojoExecution
Errors running builder 'Maven Project Builder' on project '(Hid Project Name)'.
org/apache/maven/plugin/MojoExecution 
```

任何想法是什么原因造成的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-04-23T07:28:04.370

如果您使用的是外部 maven，请检查是否已选中 ![在此处输入图像描述](../Images/1e032d347674835fa059ba4ef0b7ac7f.png)

也尝试删除 .m2 并检查那里的设置文件是否指向 localRepository 标记中的正确位置

C:\Users\sunny.m2\repository

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-02T19:24:44.220

我通过更正 JDK 的 eclipse (eclipse.ini) vm 值来修复我的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-17T16:57:05.490

除了 Maven 安装点，还要检查 Maven 的“用户设置”。我的指向一个默认位置，但我在某个地方也有导致问题的 settings.xml。

# mongoid - 嵌入文档的聚合不起作用

> ID：14691967
> 
> 赞同：1
> 
> 时间：2013-02-04T17:22:39.777
> 
> 标签：mongoid

我正在尝试使用 Mongoid 对嵌入式文档进行一些简单的聚合，但它不起作用，尽管如果值在顶级文档中它可以工作。

这行得通；

```
Accounts.avg("sale_price") 
>>  500.0 
```

但如果要平均的字段在嵌入文档中，则返回 0

```
Accounts.avg("sales.sale_price") 
>> 0.0 
```

我使用错误的语法来引用嵌入的值还是这些聚合方法不适用于嵌入的文档？

# c# - 如何获得角度属性

> ID：14691969
> 
> 赞同：0
> 
> 时间：2013-02-04T17:22:45.213
> 
> 标签：c#, .net, wpf

我可以像这样应用**角度**

```
double angle = 30;
Rectangle r = new Rectangle();
r.Width = 5;
r.Height = 130;
r.Fill = Brushes.Black;
r.RenderTransform = new RotateTransform(angle);
canvas1.Children.Add(r); 
```

但我不确定如何取回 **角度**值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:29:52.457

您可以保存旋转变换并稍后访问它；

```
RotateTransform rTransform = new RotateTransform(angle);
...
var temp = rTransform.Angle; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T17:49:40.697

您可能总是尝试将元素`RenderTransform`转换为 a`RotateTransform`并且（在成功转换的情况下）从`Angle`属性中获取角度值：

```
var element = canvas1.Children[0];
var transform = element.RenderTransform as RotateTransform;
var angle = transform != null ? transform.Angle : 0.0; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:35:59.093

变换是 3x3 矩阵。[您可以在此处](http://en.wikipedia.org/wiki/Rotation_matrix)阅读有关旋转特定位的信息

您可以通过使用该`RenderTransform.Value`属性来访问矩阵（而不是像之前的理论那样将一根电线插入您的后脑勺）

使用`Matrix.M11`、`Matrix.M12`和值`Matrix.M21`来`Matrix.M22`计算您的角度！

# ruby-on-rails - 如何返回 array1 中不在 array2 中的元素？

> ID：14691973
> 
> 赞同：-1
> 
> 时间：2013-02-04T17:22:52.083
> 
> 标签：ruby-on-rails, ruby

我有一个对象数组，类型为 Lab,`existing_labs`和不同的 Labs 数组`new_labs`。`==`我已经为 Lab定义了自己的比较器。

`existing_labs`是数据库中已经存在的实验室。 `new_labs`是否要保存实验室，基于它们已经存在于数据库中。

现在我正在这样做

```
new_labs.each do |l|
  lab = Lab.new(l)
  exists = existing_labs.map{ |existing_lab| lab == existing_lab }
  lab.save unless exists.include? true
end 
```

这可行，但如果其中一个或两个数组很大，则可能会很慢。我相信必须有更好的方法来做到这一点！

为清楚起见进行编辑：

我的问题是：有没有一种好方法可以使用我的方法返回所有存在于`new_labs`中但不存在于中的 Lab ？`existing_labs``==`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:30:43.960

您的问题根本不清楚，但这里是您的代码的重构：

```
(new_labs.map{|l| Lab.new(l)} - existing_labs).each(&:save) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T20:26:47.667

```
new_labs.each do |l|
  lab = Lab.new(l)
  lab.save unless existing_labs.any?{|existing_lab| lab == existing_lab }
end 
```

应该更快一些，因为没有为每个实验室创建真假数组。此外，找到`any?`一个时退出`true`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T17:26:38.460

用它们制作一[组](http://www.ruby-doc.org/stdlib/libdoc/set/rdoc/Set.html)并应用该`difference`方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T17:28:13.453

您可以简单地使用以下`-`方法：

```
> ary1 = [1, 2, 3, 4, 5]
> ary2 = [2,3]
> ary1 - ary2
=> [1, 4, 5] 
```

另一个：

```
ary1.select { |e| not ary2.include? e } 
```

这些方法中的任何一种都意味着在后台进行迭代，但我认为该`-`方法在性能上获胜，也许几个基准测试会很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-04T18:32:12.837

**返回 array1 中不在 array2 中的元素**

```
> ary1 = [1, 2, 3, 4, 5]
> ary2 = [2,7,9,3]
> ary1 - ary2
=> [1, 4, 5] 
```

**返回 array2 中不在 array1 中的元素**

```
> ary1 = [1, 2, 3, 4, 5]
> ary2 = [2,7,9,3]
> ary2 - ary1
=> [7,9] 
```

# c# - 将 JavaScript 数组传递给 IEnumerable 会给出空值

> ID：14691977
> 
> 赞同：3
> 
> 时间：2013-02-04T17:22:59.263
> 
> 标签：c#, javascript, jquery, asp.net-mvc, asp.net-mvc-4

我在 MVC 3 中将 Javascript 数组传递给我的控制器时遇到了很大的麻烦。我不断收到空值，感觉我已经尝试了所有传递数组的方法。下面是 JavaScript、相关的视图模型`Questions`和控制器签名。我会很感激任何帮助。我的 JavaScript 没有出现任何错误，我认为我一定遗漏了一些基本的东西。

控制器正确接收`id`和的值。`response-id`

**javascript**

```
$("#form-submit-scores").submit(function () {

        var question = [],
        var item = [],

        $('.questionRow').each(function (index) {
            question[index] = new Array();
            var fullQuestionId = $(this).attr('id');
            var fullQuestionParts = fullQuestionId.split('-');
            question[index].QuestionId = fullQuestionParts[fullQuestionParts.length - 1];
            question[index].QuestionScore = $('.scoreBoard').val();
        });

        $('.itemRow').each(function (index) {
            item[index] = new Array();
            item[index].ItemId = $(this).attr('id');
            item[index].ItemScore = $('.scoreBoard').val();
        });

        var url = "/ctr/SaveResponse",
            data = {
                Id: $('#id').val(),
                ResponseId: $('#response-id').val(),
                Questions: question,
                Items : item
            },

        if (isSubmitScores) {
            url = "/ctr/SubmitResponse"
        }

        $.ajax({
            url: url,
            type: 'Post',
            data: data,
            traditional:true,
            datatype: "json",
            contentType: "application/json; charset=utf-8",
            success: function (result) {
                if (!result.Success) {

....
....
.... 
```

**视图模型**

```
public class SubmitResponseViewModel
    {
        public int Id { get; set; }
        public int ResponseId { get; set; }
        IEnumerable<SubmitResponseScoresQuestionViewModel> Questions {get;set;}
        IEnumerable<SubmitResponseScoresItemViewModel> Items { get; set; }
    }

public class SubmitResponseScoresQuestionViewModel
    {
        public int QuestionId { get; set; }
        public decimal? QuestionScore { get; set; }
    } 
```

**控制器签名**

```
public JsonResult SubmitResponseScores(SubmitResponseScoresViewModel model) 
```

因此，正如我上面所说，我的模型现在包含正确的 and 值`Id`，但and的`response-id`值为空。我已经确认我正在 AJAX 调用中填充，所以我认为我没有为控制器提供适当格式的数据。`Questions``Items``data`

**编辑：1**

Chrome JS 调试器：AJAX 数据对象

```
 JSON.stringify(data, null, 2)
"{
  "Id": "1027",
  "ResponseId": "26",
  "Questions": [
    {
      "QuestionId": "7",
      "QuestionScore": "0"
    },
    {
      "QuestionId": "2",
      "QuestionScore": "0"
    },
    {
      "QuestionId": "1",
      "QuestionScore": "0"
    }
  ],
  "Items": [
    {
      "ItemId": "434",
      "ItemScore": "0"
    }
  ]
}" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T18:07:20.057

您想使用 JSON.stringify
[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify将数组序列化为 JSON](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify)

1) 在 Nuget 中安装 Json.net 以包含 JsonFilter 表示法

```
PM> Install-Package Newtonsoft.Json 
```

2）在您的操作方法上放置一个 Json Filter 注释

```
[JsonFilter(Param = "attributes", JsonDataType = typeof(AttributeViewModel[]))]
  JsonResult SubmitResponseScores(SubmitResponseScoresViewModel model) 
```

3）在你的ajax调用中：

```
 data:  JSON.stringify(data), 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T13:51:25.657

您的问题和项目集合需要公开，否则它们将不会在回发时绑定到模型

# vb.net - 将“Double”或“Single”转换为“Integer”的最简洁方法，无需四舍五入

> ID：14691978
> 
> 赞同：7
> 
> 时间：2013-02-04T17:23:02.897
> 
> 标签：vb.net, floating-point, type-conversion

[使用CInt](https://msdn.microsoft.com/en-us/library/s2dy91zy.aspx)或将浮点数转换为整数`CType`将导致该数字的值被四舍五入。该`Int`函数 和`Math.Floor`可用于将浮点数转换为整数，向负无穷大舍入，但两个函数都返回浮点值，这些浮点值不能在没有强制转换的情况下隐式用作`Integer`值。

是否有简洁和惯用的替代方法`IntVar = CInt(Int(FloatingPointVar));`？Pascal 包含`Round`和`Trunc`返回的函数`Integer`；在 VB.NET 语言或 .NET 框架中是否有一些等价物？

一个类似的问题，*[CInt 不会一致地舍入 Double 值 - 如何删除小数部分？](https://stackoverflow.com/questions/7684176)*在 2011 年被问到，但它只是询问是否有办法将浮点数转换为整数；答案提出了一个两步过程，但它没有深入了解框架中存在或不存在的内容。我很难相信框架没有类似于[Pascal的东西](http://en.wikipedia.org/wiki/Pascal_%28programming_language%29) `Trunc`函数，因为在使用浮点操作数执行图形操作时经常需要这样的东西[此类操作需要呈现为离散像素，并且应该以这样的方式舍入round(x)-1 = round(x -1) 适用于 +/- (2^31-1) 范围内的所有 x；即使这样的操作被四舍五入，也应该使用Floor(x+0.5)，而不是四舍五入，以保证上述性质]

顺便说一句，在 C# 中，从使用符号`Double`到`Int`使用`(type)expr`符号的类型转换使用舍入到零的语义；这与 VB.NET 行为不同的事实表明，一种或两种语言都使用自己的转换例程，而不是框架中包含的显式转换运算符。框架似乎应该定义一个转换运算符？框架内是否存在这样的运算符？它有什么作用？有没有办法从 C# 和/或 VB.NET 调用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T18:27:37.790

经过一番搜索，VB似乎没有干净的方法来实现这一点，只需要编写一个扩展方法。

C#`(int)`转换直接转换`conv.i4`为 IL。[VB 没有这样的操作符](http://www.panopticoncentral.net/2004/06/07/conversion-operators-in-vb/)，而且似乎没有框架函数可以提供替代方案。

[早在 2005 年，Usenet 就对此进行了一次有趣的讨论](http://bytes.com/topic/visual-basic-net/answers/377806-cant-real-double-integer-cast-vb-net)——当然从那以后发生了很多变化，但我认为这仍然存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:30:44.247

您可以使用该[`Math.Truncate`](http://msdn.microsoft.com/en-us/library/system.math.truncate.aspx)方法。

> 计算指定双精度浮点数的整数部分。

例如：

```
Dim a As double = 1.6666666
Dim b As Integer = Math.Truncate(a) ' b = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-14T13:51:00.523

我知道这是一个老案例，但我没有看到有人建议使用 Math.Round() 函数。

是的 Math.Round 需要一个双精度并返回一个双精度。但是，它返回一个已四舍五入为整数的数字。它应该使用 cInt 轻松简洁地转换为整数。这样就够了吗？

cInt(math.round(10000.54564)) ' = 10001 cInt(math.round(10000.49564)) ' = 10000

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2013-02-04T17:31:46.313

您可能需要提取浮点数的 Int 部分：

```
float num = 12.234;
string toint = "" + num;
string auxil = toint.Split('.');
int newnum = Int.Parse(auxil[0]); 
```

# javascript - 检查用户是否输入了带有变量的特定字符串

> ID：14691979
> 
> 赞同：1
> 
> 时间：2013-02-04T17:23:15.873
> 
> 标签：javascript, jquery, variables, if-statement

为了使用下面的语句简化我的问题，我怎样才能让我的 javascript 始终打印以控制台用户键入的内容？

我的代码中的一个亮点

```
if (userTyped === 'getname '+ variable) { 
```

其中“变量”将始终等于他们键入的字符串的后半部分。例如，如果用户键入“getname 398502”然后将其记录到控制台，或者如果用户键入“getname 598024”然后将其记录到控制台。

因此，只要他们输入“getname”，然后打印他们输入的所有内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:31:59.007

您可以使用正则表达式来验证命令并提取参数。就像是：

```
var input = 'getname 19395029'; //Sample input
var re = /^getname (\d+)$/g;
var match = re.exec(input);
if(match) // Input matches command format
    window.alert('Getting name: ' + match[1]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T17:34:41.760

您需要确保`'getname '`位于字符串的开头：

```
if (userTyped.indexOf('getname ') === 0) {
    console.log(userTyped);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T17:36:03.083

尝试

```
if( /^getname /i.test( input ) ) { 
    console.log( input.replace( /^getname /i, "" ) ); 
} 
```

[**在这里**](http://jsfiddle.net/bruno/epDSN/)提琴[](http://jsfiddle.net/bruno/epDSN/)

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T17:32:54.023

> 可以等于用户输入的任何内容

然后，您不想针对变量（具有特定值）进行测试。相反，您想要测试第一部分`'getname'`并将第二部分解析为变量。您可以使用[正则表达式](http://www.regular-expressions.info/)来做到这一点，例如：

```
var match = userTyped.match(/^getname (\d+)$/);
if (match) {
    var variable = match[1]; // maybe parseInt(match[1], 10) ?
} 
```**

# spring - 为什么 Cobertura 不能在我的 Spring/Hibernate Webapp 中工作？

> ID：14691985
> 
> 赞同：1
> 
> 时间：2013-02-04T17:23:34.253
> 
> 标签：spring, hibernate, tomcat, cobertura, java-bytecode-asm

我想在我的 Web 应用程序中使用 Cobertura 代码覆盖率记录，但无法让它工作。我怀疑，问题是 Spring 或 Hibernate 和 Cobertura 之间存在一些冲突，因为这三个都使用 ASM lib 来进行字节码操作。

我做了以下事情：

*   我使用 Cobertura Ant 任务在“WEB-INF/lib”中检测我的 jar，并生成了“cobertura.ser”文件
*   我将“cobertura.jar”添加到“WEB-INF/lib”
*   我启动 tomcat 提供 cobertura 文件位置 (net.sourceforge.cobertura.datafile=cobertura.ser)

当我启动 Tomcat 时，在初始化 Spring 上下文时收到以下错误消息：

```
java.lang.NoSuchMethodException: com.foo.MyClass.setInstance($Proxy28)
  at com.foo.common.runtime.spring.PluginInjector.findBestMatchingMethod(PluginInjector.java:252)
  at com.foo.common.runtime.spring.PluginInjector.invokeMethod(PluginInjector.java:198)
  at com.foo.common.runtime.spring.PluginInjector.afterPropertiesSet(PluginInjector.java:174)
  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452) 
```

我已经知道，cobertura 附带的 asm.jar 不应该在类路径中，因此我只将 cobertura.jar 复制到了 WEB-INF\lib。

此外，我还尝试了 Emma，它奏效了。然而，cobertura 看起来更现代、更活跃（最后一次更新是 2010 年而不是 2005 年）并且生成更好的报告，所以我更喜欢它而不是 Emma。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T10:28:29.530

我必须进行两项更改才能使这项工作：

1.  我必须`proxy-target-class="true"`在 Spring 配置中进行设置，因此 Spring 使用 CGLIB 来生成代理，而不是使用 JDK 动态代理（请参阅[Spring 代理机制](http://static.springsource.org/spring/docs/3.0.0.M3/reference/html/ch08s06.html)）。

2.  我必须设置 JVM Parameter `-XX:-UseSplitVerifier`，这会导致 JVM 使用旧的字节码验证器。这似乎是必要的，因为 Cobertura 的字节码操作与 Java 7 不兼容。

# php - PHP：这是一个错误：shuffle() 期望参数 1 是数组，给定对象？

> ID：14691987
> 
> 赞同：2
> 
> 时间：2013-02-04T17:23:41.727
> 
> 标签：php, arrays, object

我有一个实现 ArrayableInterface 的对象（顺便说一句，它来自 Laravel 的 Eloquent ORM）。

这个对象是 $articles。所以很自然，我可以这样做：

```
foreach ($articles as $article)
    echo $article->title . "<br/>"; 
```

但**我不能这样做：**

```
shuffle($articles); 
```

我得到`shuffle() expects parameter 1 to be array, object given`警告。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T17:32:39.777

不，这不是错误。

PHP 5 允许您使用`foreach()`循环遍历不是数组的对象。这些对象称为`Iterators`.

不幸的是，旧的基于数组的函数，比如`shuffle()`不能处理迭代器。

这样做的主要原因是迭代器甚至可能无法排序——例如，您可以让迭代器直接从文件或 URL 中读取，并在每次`foreach()`循环循环时读取新的数据行。这显然无法排序，因为它是在`foreach()`过程中读取的。

[`iterator_to_array()`](http://php.net/manual/en/function.iterator-to-array.php)您可以使用巧妙命名的函数将 Iterator 转换为数组。但是，如果您不知道迭代器要处理多少数据，这可能不是一个好主意，因为您可能会发现它使用了大量内存。

一些迭代器可能会在迭代器对象本身内提供用于对数据进行排序或过滤的方法。如果是这样，这是一个比尝试将其作为数组排序更好的解决方案。

如果您正在使用 ORM，那么这意味着您的 Iterator 对象正在从数据库中读取数据。在这种情况下，通过 DB 查询（即`ORDER BY`或 ORM 提供的任何方法）对其进行排序可能比在 PHP 中对数据进行排序更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T17:26:57.570

我不知道接口做了什么..但洗牌功能也不会，因为它只识别数组。你需要这样做：

```
$array = iterator_to_array($articles);
$shuffled = shuffle($array); 
```

从 OOP 的角度来看，实际上，您的对象应该包含 shuffle 实现：

```
 $articles->shuffle(); 
```

# php - 如何添加添加到管理员的链接 category_id (JToolBarHelper::addNew)？- Joomla 2.5

> ID：14691990
> 
> 赞同：0
> 
> 时间：2013-02-04T17:23:46.513
> 
> 标签：php, joomla, joomla2.5

如何添加添加到管理员的链接**category_id ？**(Joomla 2.5)

你可以写在函数`JToolBarHelper::addNew('select.add');`或其他函数中......例如，

> index.php?option=com_pictures&view=select&layout=edit& **category_id** =14

请帮忙。提前致谢

***回复大卫 F：***

嗨，大卫 F。我几乎明白了。
点击“添加”后出现`category_id=14`，其余点击“编辑”、“保存”、“保存关闭”... -`category_id=0`
我一直在编程。这是一个例子：

```
...
protected $catid;

public function __construct($config = array()) {
    parent::__construct($config);

    if (empty($this->catid)) {
        $this->catid = JRequest::getInt('category_id', 0);
    }
}

protected function allowAdd($data = array()) {
    $user = JFactory::getUser();
    $categoryId = JArrayHelper::getValue($data, 'catid', JRequest::getInt('filter_category_id'), 'int');
    $allow = null;

    if ($categoryId) {
        $allow = $user->authorise('core.create', $this->option . '.category.' . $categoryId);
    }

    if ($allow === null) {
        return parent::allowAdd($data);
    } else {
        return $allow;
    }
}

protected function allowEdit($data = array(), $key = 'id') {
    $recordId = (int) isset($data[$key]) ? $data[$key] : 0;
    $categoryId = 0;

    if ($recordId) {
        $categoryId = (int) $this->getModel()->getItem($recordId)->catid;
    }

    if ($categoryId) {
        return JFactory::getUser()->authorise('core.edit', $this->option . '.category.' . $categoryId);
    } else {
        return parent::allowEdit($data, $key);
    }
}

protected function getRedirectToItemAppend($recordId = null, $urlVar = 'id') {
    $append = parent::getRedirectToItemAppend($recordId);
    $append .= '&category_id=' . $this->category_id;

    return $append;
}

protected function getRedirectToListAppend() {
    $append = parent::getRedirectToListAppend();
    $append .= '&category_id=' . $this->category_id;

    return $append;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T21:34:21.267

我相信您正在寻找的功能是 JController 的一部分，应该添加到您的控制器中。在您的情况下，这可能是基于您 url 中的视图名称的 select.php 控制器。

您可以在类别组件中看到一个很好的示例，特别是在管理员/组件/com_categories/controllers/category.php 中。

以下是 com_categories 中的代码。您可能希望将扩展名重命名为“category_id”，并且可能希望从 JInput 而不是当前类中获取值：

```
/**
 * Gets the URL arguments to append to an item redirect.
 *
 * @param   integer  $recordId  The primary key id for the item.
 * @param   string   $urlVar    The name of the URL variable for the id.
 *
 * @return  string  The arguments to append to the redirect URL.
 *
 * @since   1.6
 */
protected function getRedirectToItemAppend($recordId = null, $urlVar = 'id')
{
    $append = parent::getRedirectToItemAppend($recordId);
    $append .= '&extension=' . $this->extension;

    return $append;
}

/**
 * Gets the URL arguments to append to a list redirect.
 *
 * @return  string  The arguments to append to the redirect URL.
 *
 * @since   1.6
 */
protected function getRedirectToListAppend()
{
    $append = parent::getRedirectToListAppend();
    $append .= '&extension=' . $this->extension;

    return $append;
} 
```

*编辑：

您还必须将其添加为表单的一部分。这是简单但重要的部分。只需确保表单具有隐藏的输入值或将其添加到表单操作部分的 url 中：

```
<form action="<?php echo JRoute::_('index.php?option=com_component&layout=edit&id='.(int) $this->item->id . '&category_id='.$this->category_id); ?>" method="post" name="adminForm"> 
```

或使用这个：

```
<input type="hidden" name="category_id" value="<?php echo $this->category_id; ?>" /> 
```

为了进一步解释发生了什么，当您单击一个项目转到表单时，您可能会添加您需要的变量。然后将其添加到表单中，以便在单击其中一个项目时，它将与表单一起提交。Joomla 处理此表单并根据单击的工具栏按钮保存或不保存它。然后 Joomla 重定向，要么返回表单，要么返回列表视图。如果没有控制器中的功能，您的变量就会丢失。

# xml - 查找包含 milti 行模式的 xml 文件

> ID：14691992
> 
> 赞同：0
> 
> 时间：2013-02-04T17:23:54.993
> 
> 标签：xml, sed

我正在尝试在大量 xml 文件中搜索缺少特定标记或该标记内的值为 0 的文件。

基本上，每个 xml 文件都有一个或多个 LIBRARY 标签，并且嵌套在这些标签内的是一个或多个 SECTION 标签，而这些标签内是一个或多个 SHELF 标签。在 SHELF 标签内*应该*有一个 BOOK 标签，其整数值不为零。

我需要查找此 BOOK 值为 0 或缺少 BOOK 的文件，但**仅**在每个 SECTION 的**第一个**SHELF 中。因此，如果多个 LIBRARY 标签内嵌套了多个 SECTION 标签，我需要检查每个 SECTION 中的第一个 SHELF。

```
<LIBRARY>
    <SECTION>
        <SHELF>
            <BOOK>10000</BOOK>
        </SHELF>
    </SECTION>
</LIBRARY> 
```

I am trying to write a Unix script to achieve this by searching each file in a given directory and returning a list of the files that match the pattern. I have been searching for a way to do it with sed, but I can't seem to find the solution to this particular problem. Also, the xml files are multi-line files, as shown above. Thank you guys for any help you can provide!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:39:58.570

您可以使用 XPath 检查是否存在没有书或 0 书的第一个书架：

```
exists(//LIBRARY/SECTION/SHELF[1][empty(BOOK) or BOOK = 0]) 
```

或者使用 XPath 2 更容易阅读，检查每个第一个书架是否有非 0 书：

```
not(every $shelf in //LIBRARY/SECTION/SHELF[1] satisfies $shelf/BOOK[. != 0]) 
```

现在您需要一个 xml 工具来将该 xpath 应用于每个文件并列出匹配的文件。

如果 XPath 条件为真，我的[Xidel](http://videlibri.sourceforge.net/xidel.html)可以直接打印文件名/url：

```
 xidel --quiet -e 'if (not(every $shelf in //LIBRARY/SECTION/SHELF[1] satisfies $shelf/BOOK[. != 0])) then $url else ""' *.xml 
```

（虽然如果你有几千个文件可能会很慢，但从来没有用这么多文件测试过）

# ios - self.view addSubview:(UIView *)logInHome];

> ID：14691994
> 
> 赞同：-3
> 
> 时间：2013-02-04T17:23:58.310
> 
> 标签：ios, objective-c, xcode

下面是我正在使用的代码，但由于某种原因，它没有带我进入我正在创建的应用程序的下一个 segue。所以基本上如果输入了错误的密码，你会收到一个提示错误密码的警报，但是如果你输入正确的密码，它应该允许你继续下一个 segue。我对此很陌生。任何人都可以帮助我确定我在代码中遗漏了一些东西，或者我没有正确链接一些东西。请帮忙。先感谢您。

使用 xcode 4.6

```
- (IBAction)enterPassword
{
    NSString *passwordString = [NSString stringWithFormat:@"1234"];

    if ([passwordField.text isEqualToString:passwordString]) {
        [self.view addSubview:(UIView *)logInHome];

    }
    else {
        // Password is incorrect
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Incorrect Password" message:@"Please try again." delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil];
        [alert show];

    }
} 
```

@结尾

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:51:56.253

我认为你走错了路。您应该阅读有关方法`performSegueWithIdentifier`和`prepareForSegue`.

在您的按钮单击操作中检查用户名和密码，如果可以`performSegueWithIdentifier`，使用 id 调用下一个视图，否则显示您的警报消息。

在`prepareForSegue`您可以传入用户名和密码作为下一个视图的参数。

您必须在情节提要中设置视图。

# ruby-on-rails - 有没有办法在不使用条件的情况下根据当前用户呈现不同的模板

> ID：14691997
> 
> 赞同：1
> 
> 时间：2013-02-04T17:24:01.787
> 
> 标签：ruby-on-rails

我有两种不同的布局，一种是完全自定义的，另一种是引导的。对于管理员，我们想要渲染一个引导视图，对于非管理员，我们正常渲染它。在大多数情况下，这很简单，因为管理员和用户不会共享很多视图 - 但有一些。

我最初的想法涉及覆盖`render`，以便它检查是否有文件的引导版本。因此，例如，将会有`_user.html.erb`并且`_user.bootstrap.html.erb`会有特定于引导程序的模板。

我不想如此理想地修改任何控制器，类似的东西`render 'form'`会表现得很聪明并检查是否有`_form.bootstrap.html.erb`，如果没有，它会回退到`_form.html.erb`

## 第一次尝试

我的第一次尝试看起来像这样

```
# I don't think this is the actual method signature of render
def render(options=nil, extra_options, &block)
  # if it should render bootstrap and options is a string and there exists a bootstrap version
  #   set it up to render the bootstrap view
  super(options, extra_options, &b)
end 
```

## 当前尝试

我正在考虑注册一个模板，该模板基本上检查文件是否存在，然后使用 erb。我还没有在这方面取得任何进展。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T21:03:16.740

我想到了。我是这样做的：

这是在应用程序控制器中设置的，带有`before_filter :render_bootstrap`

```
def render_bootstrap
  return unless bootstrap?
  new_action = "#{self.action_name}.bootstrap"
  has_bs_view = template_exists?(new_action,params[:controller],false) ||  template_exists?(new_action,params[:controller], true)
  if has_bs_view
    self.action_name = new_action
  end
end 
```

我决定进一步扩展它，以便在像`show.bootstrap.html.erb`你这样的视图内部仍然可以`render "form"`不做`render "form.bootstrap"`. 这是通过覆盖 rails 渲染助手来完成的。

# android - 8x7 和 8x5 平板电脑中的 android 主屏幕小部件

> ID：14691998
> 
> 赞同：0
> 
> 时间：2013-02-04T17:24:03.887
> 
> 标签：android, android-widget

我有一个主屏幕小部件，它旨在在 8x7 平板电脑（三星和摩托罗拉）中正常工作。现在我想让小部件在 8x5 平板电脑（nexus 10）中正常工作。我已经减小了小部件的尺寸以使其在 8x5 中工作。现在如何配置小部件尺寸以便它可以在 8x7 和 8x5 中工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T17:36:07.593

只需将其添加到您的小部件提供程序 XML 中：

android:resizeMode="水平|垂直"

这确保用户可以调整小部件的大小以适应可用的屏幕尺寸。您还可以设置默认大小和最小大小。

[http://developer.android.com/guide/topics/appwidgets/index.html#MetaData](http://developer.android.com/guide/topics/appwidgets/index.html#MetaData)