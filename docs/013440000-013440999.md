# StackOverflow 问答 13440000-13440999

# android - 处理不同的布局和不同的方向

> ID：13440009
> 
> 赞同：0
> 
> 时间：2012-11-18T12:18:23.500
> 
> 标签：android, android-layout

我有一个想要适应平板电脑和手持设备的应用程序

*   当手持设备处于纵向或景观时，我要显示`ListView`，并且选择列表项时，我启动另一个活动。
*   当平板设备处于纵向时 - 见上文。
*   当平板设备处于横向时，我想在屏幕`ListView`的一个部分显示，而在屏幕的另一部分显示选定的项目内容。基本上是这样的：![在此处输入图像描述](../Images/cb7771b2026f720c4ebfe80ee9fa7fed.png)

我应该如何做到这一点？我在为每个方向考虑不同的活动和布局资源。但我有一种感觉，有一种更聪明更好的方法。

当然，我可以以某种方式将所有内容都塞进一项活动中，但感觉不对。也不好看:)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T12:21:58.857

您想要实现的目标可以使用`Fragments`. 这是一个描述使用的[示例](http://developer.android.com/training/basics/fragments/index.html)`Fragments`。

要在片段之间进行通信，请参阅此[链接](http://developer.android.com/training/basics/fragments/communicating.html)。

# c# - NHibernate 无状态会话游标泄漏

> ID：13440013
> 
> 赞同：1
> 
> 时间：2012-11-18T12:19:02.477
> 
> 标签：c#, oracle, nhibernate, cursor

我有一个带有线程静态会话的多线程应用程序，它可以处理文件。它使用 NH 从服务中消费并在 oracle db 上运行，到目前为止一切都很好。

每个线程都有一个详细的日志，使用无状态会话更轻量级。顺便说一句，当处理某些文件时，我可以看到在 oracle 中为日志会话管理了许多游标。

例如日志：

*   第324章
*   第310章
*   第121章

和应用程序本身：

*   31 SPC_PRODUCTION_LINE_TEST
*   27 SPC_PRODUCTION_LINE_TEST
*   21 SPC_PRODUCTION_LINE_TEST

这驱使我用完 Oracle 游标 ORA-01000。

**有人知道可能导致这种情况的原因吗？游标与插入有关还是仅与更新有关？我想每个线程在它生命的尽头都会关闭所有会话，常规的和无状态的。**

仅供参考，我正在这样写日志：

*   在会话工厂

    ```
    public IStatelessSession GetUserStatelessContext(ConnectionStringSettings connection)
    {
        lock (Padlock)
        {
            string key = GetConnectionKey(connection);

            if (StatelessSessions == null)
            {
                StatelessSessions = new Dictionary<string, IStatelessSession>();
            }

            if (!StatelessSessions.ContainsKey(key))
            {
                StatelessSessions.Add(key, Factories[connection.ConnectionString].OpenStatelessSession());
            }

            return StatelessSessions[key];
        }
    } 
    ```

*   并在日志中写入：

    ```
     using (ITransaction tx = this.LogProcessErrorRepository.BeginTransaction())
            {
                this.LogProcessErrorRepository.Add(log);
                if (log.Informations != null)
                {
                    foreach (AdditionalInformation info in log.Informations)
                    {
                        info.Text = this.OracleCLOBHack(info.Text);

                        this.AdditionalInformationRepository.Add(info);
                    }
                }

                tx.Commit();
            } 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T09:17:40.030

作为记录，问题的原因是使用 MS Oracle 客户端 ( *System.Data.OracleClient* ) 而不是 Oracle 数据提供程序 ( *Oracle.DataAccess* )。流利的很容易混淆，因为第一个是*OracleClientConfiguration*和 ODP.Net *OracleDataClientConfiguration*，因为我们知道 MS 客户端已停产。

现在数据库性能提高了 400%，而且完全没有游标泄漏。所以从我的角度来看，永远不要使用 MS 客户端。

# mysql - 添加“1”返回“BLOB”

> ID：13440015
> 
> 赞同：2
> 
> 时间：2012-11-18T12:19:07.813
> 
> 标签：mysql, blob

JobID 如下所示：ALC-YYYYMMDD-001。前三个是公司的首字母缩写，后三个是一个递增的数字，每天重置，并且随着工作的增加，一天内最多增加 999 个工作；我正在尝试使用的正是这最后三个。

我正在尝试获取一个插入前触发器来查找当天的最大 JobID，并添加一个，这样我就可以让触发器派生正确的 JobID。对于第一份工作，它当然会返回 null。这就是我到目前为止所拥有的。

通过以下我可以得到'000'的结果。

```
set @maxjobID = 
 (select SUBSTRING(
  (Select MAX(
   SUBSTRING((Select JobID FROM jobs WHERE SUBSTRING(JobID,5,8)=date_format(curdate(), '%Y%m%d')),4,12)
             )
  ),14,3)
 );

select lpad((select ifnull(@maxjobID,0)),3,'0') 
```

但我真的需要添加一个保留前导零以增加当天的第一个和后续工作。我的问题是，一旦尝试添加“1”，我就会得到“BLOB”的返回。那是：

```
select lpad((select ifnull(@maxjobID,0)+1),3,'0') 
```

返回“BLOB”

我需要它返回“001”，这样我就可以将该结果与 CO 首字母缩写和当前日期连接起来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T12:23:58.377

尝试将 VARCHAR 转换回 INTEGER

```
SELECT lpad(SELECT (COALESCE(@maxjobID,0, CAST(@maxjobID AS SIGNED)) + 1),3,'0') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T13:07:51.370

如果您使用的是 MyISAM 存储引擎，则可以使用 完全实现这一点[`AUTO_INCREMENT`](http://dev.mysql.com/doc/en/example-auto-increment.html)，而无需将数据非规范化为分隔字符串：

> 对于`MyISAM`表，您可以`AUTO_INCREMENT`在多列索引中的辅助列上指定。在这种情况下，`AUTO_INCREMENT`列的生成值计算为。当您要将数据放入有序组时，这很有用。[`MAX(*auto_increment_column*) + 1 WHERE prefix=*given-prefix*`](http://dev.mysql.com/doc/en/group-by-functions.html#function_max)

在你的情况下：

1.  规范化您的架构：

    ```
    ALTER TABLE jobs
      ADD initials CHAR(3)              NOT NULL FIRST,
      ADD date     DATE                 NOT NULL AFTER initials,
      ADD seq      SMALLINT(3) UNSIGNED NOT NULL AFTER date,
    ; 
    ```

2.  规范化现有数据：

    ```
    UPDATE jobs SET
      initials = SUBSTRING_INDEX(JobID, '-',  1),
      date     = STR_TO_DATE(SUBSTRING(JobID, 5, 8), '%Y%m%d'),
      seq      = SUBSTRING_INDEX(JobID, '-', -1)
    ; 
    ```

3.  设置`AUTO_INCREMENT`：

    ```
    ALTER TABLE jobs
      DROP PRIMARY KEY,
      DROP JobID,
      MODIFY seq SMALLINT(3) UNSIGNED NOT NULL AUTO_INCREMENT,
      ADD PRIMARY KEY(initials, date, seq)
    ; 
    ```

然后，您可以`JobID`根据需要重新创建`SELECT`（甚至从此类查询创建[视图）：](http://dev.mysql.com/doc/en/views.html)

```
SELECT CONCAT_WS(
         '-',
         initials,
         DATE_FORMAT(date, '%Y%m%d'),
         LPAD(seq, 3, '0')
       ) AS JobID,
       -- etc. 
```

如果您使用的是 InnoDB，虽然您无法以这种方式生成序列号，但我仍然建议您如上所述规范化您的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T06:22:03.943

所以，我找到了一个有效的查询（到目前为止）。

```
Declare maxjobID VARCHAR(16);
Declare jobincrement SMALLINT;
SET maxjobID =
(Select MAX(
    ifnull(SUBSTRING(
        (Select JobID FROM jobs WHERE SUBSTRING(JobID,5,8)=date_format(curdate(), '%Y%m%d')),
            5,
            12),0)
        )
    );

if maxjobID=0
then set jobincrement=1;
else set jobincrement=(select substring(maxjobID,10,3))+1;
end if;

Set NEW.JobID=concat
(New.AssignedCompany,'-',date_format(curdate(), '%Y%m%d'),'-',(select lpad(jobincrement,3,'0'))); 
```

感谢您的回复！特别是指出 MyISAM 中的 auto_increment 功能。

# mime - 使用 MIME 了解 Lync 客户端多部分 SDP

> ID：13440016
> 
> 赞同：0
> 
> 时间：2012-11-18T12:19:23.357
> 
> 标签：mime, lync, sdp, multipart-alternative

谁能给我一些纯粹的见解如何创建多部分 sdp 以及这个给定 SDP 的 all 属性的含义是什么。

```
Content-Type: multipart/alternative;boundary="----=_NextPart_000_001B_01CDC5AC.EC1E2DE0"
ms-routing-phase:from-uri-routing-done

------=_NextPart_000_001B_01CDC5AC.EC1E2DE0
Content-Type: application/sdp
Content-Transfer-Encoding: 7bit
Content-ID: <67c36ea12e87436e8fd1133d26194444@afdgs.com>
Content-Dis; handling=optional; ms-proxy-2007fallback

v=0
o=- 0 0 IN IP4 192.168.0.179
s=session
c=IN IP4 192.168.0.179
b=CT:99980
t=0 0
m=audio 19384 RTP/AVP 114 9 112 111 0 8 116 115 4 97 13 118 101
a=candidate:oKpwKDjMnfFmkSeXlIgoUEYW0BiriMilFQluFogmIQ8 1 XJoleCXuzzNJHAdN0G5MHg UDP 0.830 192.168.0.179 19384
a=candidate:oKpwKDjMnfFmkSeXlIgoUEYW0BiriMilFQluFogmIQ8 2 XJoleCXuzzNJHAdN0G5MHg UDP 0.830 192.168.0.179 19385
a=cryptoscale:1 client AES_CM_128_HMAC_SHA1_80 inline:28zhxoLlrww36J41bGxjePNf0ft/BbQkHXd2Pwf2|2^31|1:1
a=crypto:2 AES_CM_128_HMAC_SHA1_80 inline:EHIG0MBaCja1hyD1kJJvm3A8Ld8sIbCyeY26J5TI|2^31|1:1
a=crypto:3 AES_CM_128_HMAC_SHA1_80 inline:4y2YFeVNzH/rdIrbkSD+kMMFYP5OlccmnfBeELrW|2^31
a=maxptime:200 
```

特别是 a=candidate: 的加密值，如何解密和创建它。

是否有任何doc或rfc请指出。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T06:53:58.060

答案是它是一个旧的 ICE 候选和 SDP，它由 Lync 客户端支持，具有新的 ICE 候选支持。所以它是多部分的，它为单个客户端启用新旧 ICE 支持。（如果客户端同时支持 ICE )

# regex - 添加 http://www. 到这个正则表达式并禁止子域

> ID：13440017
> 
> 赞同：0
> 
> 时间：2012-11-18T12:19:30.760
> 
> 标签：regex

我一直在使用这个正则表达式来验证域名，它做得很好。我需要添加一个`http://www.`或`https://www.`。我怕我会把事情搞砸。它目前不使用`http://www.`

另外，有什么办法可以改变它，所以它会拒绝子域？

所以总而言之：

```
http://www.domain.com -> valid
www.domain.com - > Invalid (Should have the http://www. part)
http://sub.domain.com - > Invalid (Subdomain)
http://www.sub.domain.com -> Invlaid (Subdomain) 
```

我试着用这部分做事`http://www.`，但以错误结束。我不知道如何做子域拒绝部分。

```
 function isurl($this_url)
    {
            if(preg_match("/^([a-z0-9]([-a-z0-9]*[a-z0-9])?\.)+((a[cdefgilmnoqrstuwxz]|aero|arpa)|(b[abdefghijmnorstvwyz]|biz)|(c[acdfghiklmnorsuvxyz]|cat|com|coop)|d[ejkmoz]|(e[ceghrstu]|edu)|f[ijkmor]|(g[abdefghilmnpqrstuwy]|gov)|h[kmnrtu]|(i[delmnoqrst]|info|int)|(j[emop]|jobs)|k[eghimnprwyz]|l[abcikrstuvy]|(m[acdghklmnopqrstuvwxyz]|mil|mobi|museum)|(n[acefgilopruz]|name|net)|(om|org)|(p[aefghklmnrstwy]|pro)|qa|r[eouw]|s[abcdeghijklmnortvyz]|(t[cdfghjklmnoprtvwz]|travel)|u[agkmsyz]|v[aceginu]|w[fs]|y[etu]|z[amw])$/i", $this_url)) 
                {
                return true;
                }

    }

    $this_url = "www.domain.com";

    if (isurl($this_url)) 
    {echo "Success";} 
    else 
    {echo "Fail";} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T12:23:33.067

在 htaccess 中试试这个

```
RewriteCond %{HTTP_HOST} !^(www\.)?mysite\.tld$ [NC]
RewriteRule ^ - [F,L]

RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule ^ http://www.%{HTTP_HOST}%{REQUEST_URI} [L,R=301] 
```

或使用这个正则表达式

```
/^(http?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/ 
```

针对特定的

```
 /^http?://([a-z0-9-]+\.)*blah\.com(/.*)?$/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T12:40:07.830

这应该适合你：

```
<?php
    function isurl($this_url) {
        return (filter_var($this_url, FILTER_VALIDATE_URL) && preg_match("#^https?://www\.#", $this_url));
    }
?> 
```

使用[`filter_var`](http://php.net/manual/en/function.filter-var.php)和一个简单的正则表达式。

# android - 如何从我的应用程序启动 Facebook 应用程序？

> ID：13440019
> 
> 赞同：0
> 
> 时间：2012-11-18T12:19:44.997
> 
> 标签：android, facebook, android-intent, url-scheme

> **可能重复：**
> [从其他应用程序启动 facebook 应用程序](https://stackoverflow.com/questions/4191492/launch-facebook-app-from-other-app)

我想使用方案 url 从我自己的应用程序中打开 Facebook 应用程序。但我不知道该怎么做。我的方案网址如下所示：fb://page/133105433423897。也许通过`inent`和/或`parseUri`。任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T15:01:07.637

查看以下描述类似问题的帖子：

[在 android 中打开 facebook 应用程序的 URL](https://stackoverflow.com/questions/6256804/url-to-open-facebook-app-in-android)

复制以供快速参考：

您需要使用意图。以下是调用 FB 应用程序的方法（如果已安装）：

```
Intent intent = new Intent();
intent.setClassName("com.facebook.katana","com.facebook.katana.ProxyAuth");
intent.putExtra("client_id", applicationId);
mAuthActivityCode = activityCode;
activity.startActivityForResult(intent, activityCode); 
```

# java - Big-O 用于各种斐波那契实现

> ID：13440020
> 
> 赞同：23
> 
> 时间：2012-11-18T12:19:48.813
> 
> 标签：java, algorithm, complexity-theory, big-o, time-complexity

我刚刚尝试用各种方法实现代码（在 Java 中），通过这些方法可以计算斐波那契数列的第 n 项，我希望验证我所学到的。

迭代实现如下：

```
public int iterativeFibonacci(int n)
{
  if ( n == 1 ) return 0;
  else if ( n == 2 ) return 1;
  int i = 0, j = 1, sum = 0;
  for ( ; (n-2) != 0; --n )
  {
    sum = i + j;
    i = j;
    j = sum;
  }
  return sum;
} 
```

递归实现如下：-

```
 public int recursiveFibonacci(int n)
  {
    if ( n == 1 ) return 0;
    else if ( n == 2 ) return 1;
    return recursiveFibonacci(n-1) + recursiveFibonacci(n-2);
  } 
```

记忆的实现如下： -

```
 public int memoizedFibonacci(int n)
  {
    if ( n <= 0 ) return -1;
    else if ( n == 1 ) return 0;
    else if ( n == 2 ) return 1;
    if ( memory[n-1] == 0 )
      memory[n-1] = memoizedFibonacci(n-1);
    if ( memory[n-2] == 0 )
      memory[n-2] = memoizedFibonacci(n-2);
    return memory[n-1]+memory[n-2];
  } 
```

在试图找出这些实现的 Big-O 时，我有点怀疑。我相信*迭代实现是 O(n)*，因为它循环 N-2 次。

在递归函数中，有重新计算的值，因此我认为它是*O(n^2)*。

在 memoized 函数中，超过一半的值是基于 memoization 访问的。我读过*一个算法是 O(log N) 如果它需要恒定的时间来将问题空间减少一个分数*，并且*一个算法是 O(N) 如果它需要恒定的时间来将问题空间减少一个恒定的数量*。我是否相信记忆化实现的复杂性是*O(n)*？如果是这样，迭代实现不是三者中最好的吗？（因为它不使用记忆所需的额外内存）。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-18T12:34:21.237

递归版本不是多项式时间 - 它是指数的，[严格限制在 φ ^(*n*)](https://stackoverflow.com/a/360938/)处，其中 φ 是黄金比例（≈ 1.618034）。递归版本将使用*O* ( *n* ) 内存（使用来自堆栈）。

记忆版本在第一次运行时将花费*O* ( *n* ) 时间，因为每个数字只计算一次。但是，作为交换，您当前的实现也需要*O* ( *n ) 内存（* *n*来自存储计算值，也用于第一次运行时的堆栈）。如果多次运行，时间复杂度将变为*O* ( *M* + *q* )，其中*M*是所有输入*n*的最大值，*q*是查询数。内存复杂度将变为*O* ( *M* )，它来自包含所有计算值的数组。

如果您考虑一次运行，则迭代实现是最好的，因为它也在*O* ( *n* ) 中运行，但使用恒定数量的内存*O* (1) 来计算。对于大量运行，它将重新计算所有内容，因此其性能可能不如 memoization 版本。

（但实际上，早在性能和内存问题之前，即使是 64 位整数，数字也可能溢出，因此准确分析必须考虑计算完整数字时进行加法所需的时间） .

正如 plesiv 所提到的，斐波那契数也可以通过矩阵乘法在*O* (log *n* ) 中计算（使用与快速求幂相同的技巧，通过在每一步将指数减半）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-08T20:23:53.993

使用矩阵乘法查找斐波那契数的java实现如下：

```
private static int fibonacci(int n)
{
    if(n <= 1)
        return n;

    int[][] f = new int[][]{{1,1},{1,0}};

    //for(int i = 2; i<=n;i++)
        power(f,n-1);

    return f[0][0];
}

// method to calculate power of the initial matrix (M = [][]{{1,1},{1,0}})

private static void power(int[][] f, int n)
{
    int[][] m = new int[][]{{1,1},{1,0}};

    for(int i = 2; i<= n; i++)
        multiply(f, m);

}

// method to multiply two matrices
private static void multiply(int[][] f, int[][] m)
{

    int x = f[0][0] * m[0][0] + f[0][1] * m[1][0];
    int y = f[0][0] * m[0][1] + f[0][1] * m[1][1];
    int z = f[1][0] * m[0][0] + f[1][1] * m[1][0];
    int w = f[1][0] * m[0][1] + f[1][1] * m[1][1];

    f[0][0] = x;
    f[0][1] = y;
    f[1][0] = z;
    f[1][1] = w;

} 
```

计算斐波那契数的另一种比矩阵求幂法更快的方法是快速加倍法。两种方法的摊销时间复杂度都是 O(logn)。该方法遵循以下公式 F(2n) = F(n)[2*F(n+1) – F(n)] F(2n + 1) = F(n)2 + F(n+1)2

一种用于快速加倍方法的 Java 实现如下：

```
private static void fastDoubling(int n, int[] ans)
{
    int a, b,c,d;

    // base case
    if(n == 0)
    {
        ans[0] = 0;
        ans[1] = 1;
        return;
    }

    fastDoubling((n/2), ans);

    a = ans[0];  /* F(n) */
    b = ans[1];  /* F(n+1) */
    c = 2*b-a;

    if(c < 0)
        c += MOD;

    c = (a*c) % MOD;  /* F(2n)  */
    d = (a*a + b*b) % MOD ;  /*  F(2n+1) */

    if(n%2 == 0)
    {
        ans[0] = c;
        ans[1] = d;
    }
    else
    {
        ans[0] = d;
        ans[1] = (c+d);
    }

} 
```

# php - PHP/js 会话过期在 dv 中加载整个页面

> ID：13440027
> 
> 赞同：0
> 
> 时间：2012-11-18T12:21:10.287
> 
> 标签：php, mysql, session, html

我有一个受密码保护的网站——想象一下像linkedin这样的网站——如果会话到期，系统会提示您再次登录。

但是，有些页面有 ajax 调用，会将内容从服务器加载到 div 中。

如果你在会话过期后回到打开的 div 并尝试输入一些东西，另一端的 php 在 div 内进行重定向，并且基本上将整个登录页面加载到 div 内。这会在页面中创建一个页面，这是一个明显的错误，它告诉用户，该站点无法正常工作。

而不是出现在打开的div中的登录页面，我希望div关闭并且整个页面重定向到登录。但是，我无法做到这一点。

现在我正在使用包含检查会话并允许您继续或将您撞到登录页面的包含进行密码保护。

```
If ($_SESSION['login'] != '1') {
header("Location: relogin.php"); } 
```

我将此包含在由 ajax 调用触发的脚本中以填充 div，因此用户无法绕过安全性。它是一个包罗万象的包含，还包含一些全局变量、函数等。

我可以添加检测调用是否来自 ajax 或其他东西的代码，以便不进行重定向而是向登录提供消息。或者理想情况下，关闭 div 并重定向整个页面？

因为它是一个大型站点，所以我想找到一个可以进入全局包含的代码块。

将不胜感激任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T12:28:15.053

您将需要在 JS 端进行重定向。

让我们先回顾一下 PHP 方面。您想给您的 AJAX 处理程序一个清晰、明确、有状态的响应：“抱歉，您没有被授权”。让我们借用一下 REST 吧？

每个 AJAX 调用的顶部：

```
<?php if (!YouAreLoggedIn()) {
header($_SERVER['SERVER_PROTOCOL']." 403 Forbidden");
exit(); ?> 
```

这将向访问者抛出 403 错误，并将终止脚本。jQuery 中的 403 错误算作 XHR 错误，因此您可以独立于其他所有内容进行映射。

您的典型 AJAX 调用将变为：

```
$.ajax({
  url: "your.url.here.php",
  type: "POST",
  success: function(d) { YourSuccessCallHere(); },
  error: function() { window.location.href='your.redirect.here.php'; }
}); 
```

这是最干净的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T12:29:02.270

您可以通过 User-Agent 或其他标头字段来区分这两个不同的调用。

按照以下链接中的说明使用 setRequestHeader()：

[JQuery Ajax 请求：更改用户代理](https://stackoverflow.com/questions/5771878/jquery-ajax-request-change-user-agent)

[http://www.w3.org/TR/2007/WD-XMLHttpRequest-20070618/#dfn-setrequestheader](http://www.w3.org/TR/2007/WD-XMLHttpRequest-20070618/#dfn-setrequestheader)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T12:29:07.233

每当您通过 Ajax 调用请求 URL 时，您都可以向请求 URL 添加一个 GET 变量：

myurl.php?ajax=Y

然后在 myurl.php 上，检查它是否是一个 ajax 调用：

```
if(!isset($_SESSION['login']) || $_SESSION['login'] != '1') {
    if(isset($_GET['ajax'])){
        echo json_encode("Please login!");
        exit;
    }
    else{
        header("Location: relogin.php"); 
        exit;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-18T12:38:31.627

使用以下标头检查请求是否为 AJAX 请求：

```
X-Requested-With: XMLHttpRequest 
```

使用以下命令读取 php 中的标头：

```
$_SERVER['HTTP_X_REQUESTED_WITH']; 
```

# .net - AppDomain 卸载后程序集未卸载？

> ID：13440030
> 
> 赞同：6
> 
> 时间：2012-11-18T12:21:16.993
> 
> 标签：.net, appdomain, .net-assembly

我正在使用 AppDomain 来加载程序集然后卸载它们。

但是，我遇到了一个非常严重的问题。卸载 AppDomain 后 - 我仍然可以在进程资源管理器中看到某些程序集被多次加载！为什么有剩余的加载程序集？AppDomain.Unload 不会释放所有 AppDomain 加载的内存吗？

您可以在附图中看到：

总 AppDomain 为 3（我在进程的生命周期中创建了 3 个 AppDomain）

AppDomains：1（目前只有 1 个 AppDomain 存在）

由于某种原因，正如您在下面加载的 DLL 部分中看到的那样 - 程序集被多次加载到进程中..

代码：

```
AppDomain fetcherDomain = AppDomain.CreateDomain("StatusFetcher");
try
{
    var fetcher = (LocalStatusFetcher)fetcherDomain.CreateInstanceFromAndUnwrap(Assembly.GetExecutingAssembly().CodeBase, typeof(LocalStatusFetcher).FullName);
    //doing some other stuff that is not interesting...
}
finally
{
    AppDomain.Unload(fetcherDomain);
} 
```

是的，LocalStatusFetcher 确实继承了 MarshalByRefObject...

![在此处输入图像描述](../Images/b4d1791a6ebad61cf35ad547be340b77.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T01:50:22.260

您正在加载到外部应用程序域的程序集很有可能被导入当前的程序集。有很多*方法*可以发生这种情况，但您的问题尤其是传递`Assembly.GetExecutingAssembly().CodeBase`给`CreateInstanceFromAndUnwrap`方法。调用`Assembly.GetExecutingAssembly()`将当前执行的程序集加载到*当前*应用程序域中，并将`.CodeBase`属性传递给 `CreateInstanceFromAndUnwrap`将尝试在实例化目标代理之前将目标程序集（位于应用程序路径或 GAC 中）加载到目标域中。目前，除了可能的出血问题外，我认为此代码没有任何问题。

如果您有多个应用程序域，那么您将在 LoadFrom 上下文中看到程序集的多个副本，因为在 AppDomains 之间共享的*唯一*程序集是 mscorlib.dll。除非我误解了你的问题，否则我认为你所看到的都是正常的。

# javascript - Google Calendar API javascript 错误：来源不匹配

> ID：13440031
> 
> 赞同：5
> 
> 时间：2012-11-18T12:21:31.860
> 
> 标签：javascript, oauth, google-calendar-api

我正在研究我在这里找到的一个简单的javascript代码：http: [//googleappsdeveloper.blogspot.com/2011/12/using-new-js-library-to-unlock-power-of.html](http://googleappsdeveloper.blogspot.com/2011/12/using-new-js-library-to-unlock-power-of.html)

它基本上获取对谷歌日历的身份验证并检索其中包含的事件列表。我已经注册了我的 Web 应用程序并获得了客户端 ID 和 API 密钥。

我正面临这个错误：“错误：来源不匹配”，我正在使用 localhost 在本地运行 javascript，并且我在 google 应用程序注册中也将我的主页设置为 localhost。

任何帮助将不胜感激。

编码：

```
<html>
  <body>
    <div id='content'>
      <h1>Events</h1>
      <ul id='events'></ul>
    </div>
    <a href='#' id='authorize-button' onclick='handleAuthClick();'>Login</a>

    <script>
    var clientId = '506979856128.apps.googleusercontent.com';
var apiKey = 'AIzaSyAGbQAZQU0YNL8hK5EU69exIg7_sOg3JoA';
var scopes = 'https://www.googleapis.com/auth/calendar';

      function handleClientLoad() {
  gapi.client.setApiKey(apiKey);
  window.setTimeout(checkAuth,1);
  checkAuth();
}

function checkAuth() {
  gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: true},
      handleAuthResult);
}

function handleAuthResult(authResult) {
  var authorizeButton = document.getElementById('authorize-button');
  if (authResult) {
    authorizeButton.style.visibility = 'hidden';
    makeApiCall();
  } else {
    authorizeButton.style.visibility = '';
    authorizeButton.onclick = handleAuthClick;
   }
}

function handleAuthClick(event) {
  gapi.auth.authorize(
      {client_id: clientId, scope: scopes, immediate: false},
      handleAuthResult);
  return false;
}

function makeApiCall() {
  gapi.client.load('calendar', 'v3', function() {
    var request = gapi.client.calendar.events.list({
      'calendarId': 'primary'
    });

    request.execute(function(resp) {
      for (var i = 0; i < resp.items.length; i++) {
        var li = document.createElement('li');
        li.appendChild(document.createTextNode(resp.items[i].summary));
        document.getElementById('events').appendChild(li);
      }
    });
 });
}
    </script>
    <script src="https://apis.google.com/js/client.js?onload=handleClientLoad">                 </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T12:59:19.067

今天我得到了同样的错误来源不匹配。经过一番搜索，我得到了原因。

在创建 Google Api Access 时，我们必须指定***Authorized Redirect URIs***和***Authorized Redirect URIs***。

现在，如果您从未在***Authorized Redirect URIs***中指定的 URI 调用登录，`error:Unknown Origin is thrown`

**仅供参考**：我已经看到您使用 localhost 在本地运行 javascript。这意味着您尚未将 localhost uri 添加到授权重定向 URI。

但是不要浪费你的时间。授权重定向 URI 不会接受 localhost uri。这是由于 Chrome 的同源策略。如果你使用 disable-web-security 标志运行 chrome，它也可以在本地工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-11T04:02:37.090

在**Google Developers Console**中创建**客户端 ID**时，可以通过注意**重定向 URI**和**Javascript**来源来解决来源不匹配的问题。

 ******Javascript**起源 不应**以**. _`/`

*示例*： `http://example.com/`--> 正确的格式是`http://example.com`.****

# php - 如何在不使用 drupal 界面的情况下更改 tmp 目录

> ID：13440034
> 
> 赞同：2
> 
> 时间：2012-11-18T12:21:39.017
> 
> 标签：php, drupal-7

我已将我的实时网站 drupal 移至 Windows localhost(xammp)，但我收到很多“无法创建文件”错误。如果我以管理员身份登录该站点，则根本无法返回任何页面。如果我不登录，我可以查看它并显示错误。

有没有办法从`ini`文件或通过`mysql`数据库更改临时文件位置，而不是通过界面登录。

`NOTE: without login in admin panel and : admin/config/media/file-system`

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T12:28:15.553

在`variable`表中存在名称 = 'file_temporary_path' 的行。使用以下 SQL 更改它的值：

```
UPDATE 
    variable 
SET 
    variable.value = 's:5:"\\xammp\\temp";' 
WHERE
    variable.name='file_temporary_path'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T00:06:45.030

如果要更改变量数据库表的内容，请记住该值中的每个值都通过[serialize()](http://php.net/manual/en/function.serialize.php)进行序列化；`serialize("\\xammp\\temp")`返回`'s:11:"\xammp\temp";'`。

如果您安装了[Drush](http://drupal.org/project/drush)，您可以使用[drush vset](http://drush.ws/#variable-set)来设置 Drupal 变量。

# domain-driven-design - 域驱动设计 - 域实体的访问修饰符

> ID：13440039
> 
> 赞同：2
> 
> 时间：2012-11-18T12:22:17.413
> 
> 标签：domain-driven-design, entities

我刚刚开始使用域驱动设计，并且有一个针对我的域的项目，其结构如下：

领域

*   /实体
*   /边界
*   /用户故事

据我了解 DDD，除了外部世界与域通信的边界之外，域中的一切都应该是不可见的。我在域中看到的所有实体类示例都有一个公共访问修饰符，例如这里我有一个名为 Message 的实体：

```
public class Message
{        
        private string _text;

        public string Text
        {
            get { return _text; }
            set { _text = value; }
        }

        public Message()
        {

        }

        public bool IsValid()
        {
           // Do some validation on text
        }
} 
```

如果实体类及其成员被标记为内部，那么它只能在域项目中访问，这不是更正确吗？

例如：

```
internal class Message
{        
        private string _text;

        internal string Text
        {
            get { return _text; }
            set { _text = value; }
        }

        internal Message()
        {

        }

        internal bool IsValid()
        {
           // Do some validation on text
        }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T12:59:47.287

我认为这里有一个混淆：有界上下文是一个概念，它定义了模型在其中有效的上下文，实际上并没有名为 Boundary 的类。也许这些是用于反腐败目的的对象，但实际上聚合根应该处理有界上下文中的那个或某个入口点。

我不会像这样构建域，这是人为的，您应该根据现实世界过程中有意义的方式构建域。您正在使用 DDD 在代码中对真实世界的流程进行建模，我还没有听到软件开发人员以外的任何人谈论实体或值对象。他们谈论订单、产品、价格等

顺便说一句，消息几乎可以肯定是一个值对象，除非域确实需要唯一标识每个消息。这里的 Message 是一个域的概念，我希望你不是指命令或事件。您应该将验证放在构造函数或给出新值的方法中。

公平地说，这段代码是一种简单化的方式，也许你选择了错误的例子。关于类是内部的还是公共的，它们可能是一个或另一个，这不是规则，这取决于很多事情。在一个极端情况下，您将采用几乎每个对象都是内部对象但实现应用程序通用的公共接口的方法，这可能非常低效。

经验法则：如果该类在域程序集之外使用，则将其公开，如果它是域内部使用的东西和/或实现公共接口，则将其设为内部。

# coffeescript - 在 Coffeescript 中扩展具有属性的对象？

> ID：13440041
> 
> 赞同：2
> 
> 时间：2012-11-18T12:22:43.643
> 
> 标签：coffeescript

我有一个字符串文字数组，我想循环它们，将它们解析为 JSON 并向结果对象添加一个属性。我想将此结果分配给一个变量。

我希望它看起来很漂亮:)

现在我正在这样做：

```
strings = ['{"a": "A", "b": "B"}', '{"c": "C", "d": "D"}']
objects = for string in strings
  obj = JSON.parse string
  obj.e = 'E'
  obj 
```

这给了我一个看起来像这样的数组：

```
[{ a: 'A', b: 'B', e:'E' }, { c: 'C', d: 'D', e:'E' }] 
```

现在这可行，但看起来有点难看。我想我想要的是[http://documentcloud.github.com/underscore/#extend](http://documentcloud.github.com/underscore/#extend)之类的东西（但我不想只为那一种方法包含下划线）

我发现了这个问题：[https](https://github.com/jashkenas/coffee-script/issues/880) ://github.com/jashkenas/coffee-script/issues/880 和这个 pullrequest：[https](https://github.com/jashkenas/coffee-script/pull/2177) ://github.com/jashkenas/coffee-script/pull/2177 但是 pullrequest 是开放的并且问题已关闭，所以我认为至少没有操作员可以这样做？

但是在编写该代码时，我不禁想到必须有更好的方法，所以欢迎任何提示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T12:34:59.183

这里有一些参考：[http ://coffeescript.org/documentation/docs/helpers.html](http://coffeescript.org/documentation/docs/helpers.html)

```
extend = exports.extend = (object, properties) ->
  for key, val of properties
    object[key] = val
  object

strings = ['{"a": "A", "b": "B"}', '{"c": "C", "d": "D"}']
objects = for string in strings
  extend JSON.parse(string), e: 'E' 
```

# asp.net-mvc - jquery post提交阻止验证

> ID：13440042
> 
> 赞同：0
> 
> 时间：2012-11-18T12:22:50.593
> 
> 标签：asp.net-mvc, jquery

我可以通过将取消类添加到提交按钮来阻止对我的表单进行验证。在某些情况下，我想`$("#myForm").ajax`使用类型为 : post 的 jquery 发布表单，并且还会触发验证过程。在这种情况下如何防止验证发生？（“获取”不是一个选项）

# android - Android 4.2 过滤掉 CHANGE_CONFIGURATION 权限？

> ID：13440045
> 
> 赞同：6
> 
> 时间：2012-11-18T12:23:46.673
> 
> 标签：android

我遇到了一个奇怪的问题，我有一个应用程序允许自由更改 Android 设备上的字体大小（[字体大小设置](https://play.google.com/store/apps/details?id=fr.gatay.android.fss%20%7C%20Font%20Size%20Setter)器）。它使用自省来调用一些内部 Android api。要执行此调用，它需要以下权限：`android.permission.CHANGE_CONFIGURATION`. 它在 Android 4.0 和 4.2 下就像一个魅力，它不再工作了。挖掘日志我发现我无法更新字体大小，因为它错过了这个权限。调试以检查有效权限，我在检查与我的应用程序对应的 PackageInfo 时得到了这些

```
requestedPermissions = {java.lang.String[2]@830038778728}
    [0] = {java.lang.String@830038778760}"android.permission.CHANGE_CONFIGURATION"
    [1] = {java.lang.String@830038778896}"android.permission.WRITE_SETTINGS"
requestedPermissionsFlags = {int[2]@830038779016}
    [0] = 1
    [1] = 3 
```

有人对正在发生的事情有任何线索，或者有任何解决方法的想法吗？非常感谢您阅读我。

根据请求，AndroidManifest.xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
          package="fr.gatay.android.fss"
          android:versionCode="1"
          android:versionName="1.0">
    <uses-sdk android:minSdkVersion="14"/>
    <uses-permission android:name="android.permission.CHANGE_CONFIGURATION" />
    <uses-permission android:name="android.permission.WRITE_SETTINGS"/>
    <application android:label="@string/app_name" android:icon="@drawable/app_icon">
        <activity android:name=".MainActivity"
        android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-02-06T03:46:36.057

检查这篇文章 [http://blog.sightidea.com/?p=44](http://blog.sightidea.com/?p=44)

您可以要求您的用户使用工具授予应用程序权限`adb`：

```
>adb shell
>pm grant com.yourapp.packagename android.permission.CHANGE_CONFIGURATION 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-25T08:50:09.667

自 Android v4.2 起，CHANGE_CONFIGURATION 权限的保护级别已从“危险”（v4.1 及以下）更改为“系统|签名|开发”（v4.2）

第 3 部分应用程序似乎无法在 Android 4.2+ 设备上获得 CHANGE_CONFIGURATION 权限。:-(

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-18T13:23:38.140

至少目前，`CHANGE_CONFIGURATION`要求您的应用程序由固件签名密钥签名或安装在系统分区上。您可以通过检查定义了这些权限[的框架清单来看到这一点。](https://github.com/android/platform_frameworks_base/blob/master/core/res/AndroidManifest.xml)

# autoit - autoit-如何最小化在 ff.au3 上打开的窗口？

> ID：13440048
> 
> 赞同：2
> 
> 时间：2012-11-18T12:24:05.813
> 
> 标签：autoit

这是我的代码：

```
#Include <FF.au3>

_FFStart()

If _FFIsConnected() Then
    $sStringToSearch = "www.google.com"
    sleep (2000)
    If _FFSearch($sStringToSearch) Then
        ; add a new tab with an URL
        _FFWindowOpen("http://ff-au3-example.thorsten-willert.de/")
        Sleep(1000)
        _FFWindowOpen("www.msn.com")
        Sleep(1000)
        _FFWindowOpen("www.yahoo.com")
        Sleep(1000)
        _FFWindowOpen("google.com")
    EndIf
Else
EndIf 
```

根据脚本，当我访问谷歌时，它会打开第一个链接，然后是其他链接；现在，一旦它们打开，我如何将它们最小化。

我也不断收到 ErrorstdOut 任何解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:31:46.090

试试 WinSetState ( "title", "text", flag ) 这里是 api 的链接：[http ://www.autoitscript.com/autoit3/docs/functions/WinSetState.htm](http://www.autoitscript.com/autoit3/docs/functions/WinSetState.htm)

一个示例是： WinSetState("Calculator", "", @SW_MINIMIZE )

# ios - 应用内购买上限

> ID：13440049
> 
> 赞同：8
> 
> 时间：2012-11-18T12:24:21.817
> 
> 标签：ios, iphone, in-app-purchase

我听说苹果新为应用内购买产品提供了额外的 10,000 个项目（除了原来的 10,000 个项目）.. 如果这是正确的，我该如何实现？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T19:24:17.080

登录到[iTunes 连接](https://itunesconnect.apple.com)。在底部面板中，单击联系我们。在出现的下拉菜单中，选择“管理您的应用内购买”。在第二个下拉菜单中，选择“有资格进行应用内购买”。

这将在苹果文档中打开一个包含相关链接的部分。如果这没有回答，将会有一个“联系我们”链接直接将您带到一个问题表，该表将直接提交给 Apple 客户服务。那应该是您最终获得答案的地方。

# sql-server - SQL Server：选择和案例

> ID：13440050
> 
> 赞同：0
> 
> 时间：2012-11-18T12:24:43.340
> 
> 标签：sql-server, case

我正在尝试根据传递给我的存储过程的一些参数来选择数据。我有年龄问题，我正在尝试做这样的事情：

如果我的存储过程参数`@Age = 1`然后我选择 15 到 18 岁之间的年龄，`@Age = 2`然后选择 19 到 25 岁...，显然这是不正确的，任何人都可以提供帮助。谢谢。：

```
SELECT
    User 
FROM
    [Member] m
WHERE 
    ((m.Gender = @Gender) or @Gender IS NULL)
    and ((DATEDIFF(hour,m.DOB,GETDATE())/8766) Between 
       CASE    
         WHEN @Age = 1 THEN (SELECT DATEDIFF(hour, m.DOB, GETDATE())/8766 WHERE (SELECT DATEDIFF(hour, m.DOB, GETDATE())/8766) between 15 and 18)
         WHEN @Age = 2 THEN (SELECT DATEDIFF(hour,m.DOB,GETDATE())/8766 WHERE (SELECT DATEDIFF(hour,m.DOB,GETDATE())/8766) between 19 and 25) 
       END) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T12:30:36.917

我认为这就是您所追求的（可能带有一些多余的括号）：

```
Select 
  [User]
From
  [Member] m
Where (
    (m.Gender = @Gender) or 
    @Gender Is Null
  ) And (
    (@Age = 1 And DateDiff(hour, m.Dob, GetDate())/8766 Between 15 and 18) Or
    (@Age = 2 And DateDiff(hour, m.Dob, GetDate())/8766 Between 19 and 25) 
  ) 
```

如果您有很多子句，则可能更容易阅读为（假设 MemberID 主键）

```
Select
  [User]
From
  [Member] m
    Inner Join (
      Select
        MemberID,
        DateDiff(hour, m.Dob, GetDate())/8766 As Years
      From
        [Member]
    ) As y
    On m.MemberID = y.MemberID
Where (
    (m.Gender = @Gender) or 
    @Gender Is Null
  ) And (
    (@Age = 1 And y.Year Between 15 and 18) Or
    (@Age = 2 And y.Year Between 19 and 25) 
  ) 
```

更好的是，您可以将范围添加到名为`AgeRanges`

```
+-------+------------+----------+
| AgeID | StartYears | EndYears |
+-------+------------+----------+
|     1 |         15 |       18 |
|     2 |         19 |       25 |
|   ... |        ... |      ... |
+-------+------------+----------+

Select
  [User]
From
  [Member] m
    Inner Join
  [AgeRanges] a
    On DateDiff(hour, m.Dob, GetDate())/8766 Between a.StartYears and a.EndYears And
       a.AgeID = @Age 
```

您还可以`DateDiff(hour, m.Dob, GetDate())/8766`在成员表上创建一个计算列以简化事情（如果性能成为问题，则可以进行索引）。

# python - Flask-sqlalchemy `create_all()`，指定模型

> ID：13440052
> 
> 赞同：2
> 
> 时间：2012-11-18T12:24:59.180
> 
> 标签：python, flask, flask-sqlalchemy

我有带有命令的文件，与模型分开。`models`这些模型只有在我将所有模型从我的`starter`文件中导入后才执行。

```
db = SQLAlchemy(app)                      

from models import *                     

try:                                      
    argv = sys.argv[1]                    
    argv == '--run' and app.run()         
    argv == '--create' and db.create_all() 
```

但这对我来说很模棱两可。我在 Flask-Sqlalchemy 源代码中走来走去。我看见：

```
def get_tables_for_bind(self, bind=None):
    """Returns a list of all tables relevant for a bind."""
    result = []
    for table in self.Model.metadata.tables.itervalues():
        if table.info.get('bind_key') == bind:
            result.append(table)
    return result 
```

我理解的`self.Model`是：

```
def make_declarative_base(self):
    """Creates the declarative base."""
    base = declarative_base(cls=Model, name='Model',
                            mapper=signalling_mapper,
                            metaclass=_BoundDeclarativeMeta)
    base.query = _QueryProperty(self)
    return base 
```

我是否有更明确的方法来指定要执行的模型？以及如何`self.Model`知道必须执行哪些表（导入后）？

# java - 查看在java中通过套接字传输的文件时出现奇怪的东西

> ID：13440053
> 
> 赞同：0
> 
> 时间：2012-11-18T12:25:05.870
> 
> 标签：java, sockets, gedit

好吧，我正在尝试使用 java 中的套接字传输文件

这是代码

## 客户代码

```
try{
    // get streams
    DataOutputStream dos = new DataOutputStream(socket.getOutputStream());
    DataInputStream  din = new DataInputStream (socket.getInputStream());
    dos.writeUTF(fileName);
    dos.flush();

    boolean isOk = din.readBoolean();
    if(!isOk){
        throw new StocFileNotFound("Fisierul: " + fileName +" was not found on:" + address.toString());
    } else {
        baos = new ByteArrayOutputStream();
        byte biti [] = new byte[1024];

        while(din.read(biti,0,1024) != -1){
            baos.write(biti,0,biti.length);
        }
    }

}
catch(IOException e){}
finally {
    try{ socket.close(); } catch (IOException  e){}
} 
```

然后我返回`baos.toByteArray()`并使用 OutputStream 的 write 方法将其写入文件。

## 服务器代码

```
try{
    DataOutputStream dos = new DataOutputStream(socket.getOutputStream());
    DataInputStream  din = new DataInputStream (socket.getInputStream());

    // check if it is really a file or if it is an existing file
    File file = new File(din.readUTF());

    // write false
    if ( !file.exists() || !file.isFile() ){
        dos.writeBoolean(false);
        dos.flush();
    }

    // write true and write the file
    else {
        byte biti[] = new byte[1024];
        dos.writeBoolean(true);

        FileInputStream fis = new FileInputStream(file);

        while(fis.read(biti,0,1024) != -1){
            dos.write(biti,0,biti.length);
        }

        dos.flush();

        try{ fis.close(); } catch (IOException e){}

    }

} catch (IOException e){}
finally {
    try{socket.close();}catch(IOException e){}
} 
```

## 问题

当我传输`.txt`文件并在其中查看它时，`gedit`它会显示文本，后跟多个`\00\00\00`，但当我使用它打开它时，`notepad(in wine)`它只显示文本。另外还可以查看图像和`.doc`作品。那么它与我的程序有关`gedit`还是与我的程序有关？

编辑我正在发送类似“嗨，希望它有效！”之类的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T12:29:13.273

这是问题（或至少*是*问题）：

```
while(fis.read(biti,0,1024) != -1)
{
    dos.write(biti,0,biti.length);
} 
```

您*总是*写出整个缓冲区，但实际上读取了许多字节。你应该有：

```
int bytesRead;
while ((bytesRead = fis.read(biti, 0, 1024)) != -1)
{
    dos.write(biti, 0, bytesRead);
} 
```

（你在这两个代码中都遇到了同样的问题。）

你可能想看看[Guava](http://guava-libraries.googlecode.com)，它有各种实用方法，可以让你从一遍又一遍地编写这种代码的大量乏味（和可能的错误）中解脱出来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T12:33:32.607

read 方法将返回从流中读取的实际字节数。您应该将其用作您的 write 方法的参数，否则您将向其写入垃圾。

# c# - 当 winform c# 中的另一个项目发生更改时，如何更新 propertygrid 项目值？

> ID：13440056
> 
> 赞同：8
> 
> 时间：2012-11-18T12:25:39.050
> 
> 标签：c#, propertygrid

我有一个包含 2 个项目的属性网格。国家和城市。我在数据库中有 1 个表：保存 LocationId、Title、ParentId 的 CountryCityTable。对于国家，parentId = 0，对于城市，是 countryid。

在我的 propertygrid 中，我使用这些并显示在 2 个组合框项目中。请看我的代码：

```
namespace ProGrid
{
    public class KeywordProperties
    {
        [TypeConverter(typeof(CountryLocationConvertor))]
        public string CountryNames { get; set; }

        [TypeConverter(typeof(CityLocationConvertor))]
        public string CityNames { get; set; }
    }
} 
```

和

```
namespace ProGrid
{
    public class CountryLocationConvertor : StringConverter 
    {
        public override bool GetStandardValuesSupported(ITypeDescriptorContext context)
        {
            return true;
        }

        public override StandardValuesCollection GetStandardValues(ITypeDescriptorContext context)
        {            
            HumanRoles Db = new HumanRoles();
            List<LocationsFieldSet> Items = new List<LocationsFieldSet>();
            Items = Db.LoadLocations(0,0);
            string[] LocationItems = new string[Items.Count];
            int count = 0;
            foreach (LocationsFieldSet Item in Items)
            {
                LocationItems[count] = Item.Title;
                count++;
            }
            return new StandardValuesCollection(LocationItems);
        }

        public override bool GetStandardValuesExclusive(ITypeDescriptorContext context)
        {
            return true;//false : If you want the user to be able to type in a value that is not in the drop-down list.
        }
    }

    public class CityLocationConvertor : StringConverter
    {
        public override bool GetStandardValuesSupported(ITypeDescriptorContext context)
        {
            return true;
        }

        public override StandardValuesCollection GetStandardValues(ITypeDescriptorContext context)
        {
            HumanRoles Db = new HumanRoles();
            List<LocationsFieldSet> Items = new List<LocationsFieldSet>();
            Items = Db.LoadLocations(1,20);
            string[] LocationItems = new string[Items.Count];
            int count = 0;
            foreach (LocationsFieldSet Item in Items)
            {
                LocationItems[count] = Item.Title;
                count++;
            }
            return new StandardValuesCollection(LocationItems);
        }

        public override bool GetStandardValuesExclusive(ITypeDescriptorContext context)
        {
            return true;
        }
    }
} 
```

和

```
KeywordProperties Kp = new KeywordProperties();
myPropertyGrid.SelectedObject = Kp; 
```

现在，我想当用户在 propertygrid 中更改国家名称时，更新城市列表（只显示这些的 parentid = countryid 的城市）。

另外，在我的课堂上，我如何将我的代码（**Db.LoadLocations(1,20);**）中的数字 20 更改为选定的国家/地区 ID？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T12:42:06.540

您将需要实现类似于`INotifyPropertyChanged`

[Microsoft INotifyPropertyChange 文档](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)

换句话说，当您遇到一个属性时，您将需要引发一些事件。据我记得，属性网格会自动检查该类型的事件/接口，并在引发事件时刷新正确的属性节点。

重要的部分是：

```
private void NotifyPropertyChanged([CallerMemberName] String propertyName = "")
{
    if (PropertyChanged != null)
    {
        PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
} 
```

和

```
public bool MyBoolProperty
{
    get { return  myBoolField; }
    set
    {
        myBoolField = value;
        NotifyPropertyChanged();
    }
} 
```

如果你想做一些 PropertyGrid 没有涵盖的事情，你只需要在`PropertyChanged`事件中注册你自己的方法，然后做任何你想做的事情。

# html - NodeJS + HTML5 + Telnet = 有可能吗？

> ID：13440062
> 
> 赞同：3
> 
> 时间：2012-11-18T12:26:14.793
> 
> 标签：html, node.js, express, websocket, telnet

我有这个项目用于我目前正在学习的课程。这里是：

*   用于 Telnet 的网页客户端不在标准端口上，具有选择端口和连接的能力

我的机器上有 telnet 服务器，只是在等待连接。

所以我的想法是在专用机器上设置一个带有 express 服务器的 nodeJS。这将通过 telnet 处理连接并为客户端托管一个页面，该页面将使用 socket.io 与服务器端交换信息。

但由于我是此类技术的新手（电信学生），我想知道这是否可能。我发现了类似的东西 - Peter Nitsch 的 jsterm.com，但我发现代码中有一些巨大的差距，并且演示并没有真正起作用，所以我不知道它是否真的有效。有人试过这个吗？

我的另一个问题是 - 当我通过 websockets 向 nodeJS 服务器发送信息时，这对我来说似乎可以实现，我该如何处理这些信息？我是否只是设置另一个 websocket 将我从客户端 websocket 获得的相同数据直接传递到 telnet 端口？

套接字可以直接连接到特定端口，而另一端没有任何 websocket 等待吗？

如果我的想法是错误的，任何人都可以帮助我 - 也许存在一些不错的解决方案 - 例如，我正在考虑 Anyterm，但我看到它需要一个 apache 服务器并运行完全不同的技术......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T16:33:10.280

需要说明的是，WebSocket 连接不是原始 TCP 套接字连接。它们在每个数据包中都有额外的标头信息，浏览器到服务器的数据使用正在运行的 XOR 等进行屏蔽。

为了让浏览器与普通的 TCP 服务器（例如 telnet 服务器）通信，您需要某种桥接服务。碰巧这样的事情已经存在。[websockify](https://github.com/kanaka/websockify)是一个接受 WebSocket 连接并将它们桥接到原始 TCP 服务器的服务器。

事实上，websockify 项目已经包含了一个可用的 telnet 客户端作为示例应用程序。但是，请注意 websockify 的一个限制（出于安全原因）是客户端无法选择任意服务器地址/端口来连接。目标地址必须预先定义，可以是在 websockify 的命令行上指定的单个目标，也可以是配置文件中指定的多个目标（并通过 WebSocket 连接字符串中的标记选择）。

websockify 有多种不同语言（python、C、node、ruby、Clojure）的实现，但是，目前只有 python 版本通过配置文件支持多个目标。

**免责声明**：我创建了[websockify](https://github.com/kanaka/websockify)。

# ios - 使用 GKSession 进行点对点时如何获得精确的时钟同步？

> ID：13440064
> 
> 赞同：2
> 
> 时间：2012-11-18T12:26:23.980
> 
> 标签：ios, p2p, gamekit, bonjour, gksession

我制作了一个简单的游戏，它使用来自 GameKit 的 GKSession 连接到其他对等方。它很容易设置，但我发现了一些问题：

*   延迟变化很大。有时消息会立即到达其他设备。有时，向其他对等方发送数据的延迟大于 1 秒。数据只是一个包含 10 个字符的字符串。

*   我的游戏依赖于精确的时钟同步。游戏有音乐播放，当它没有在所有连接的设备上同时开始播放时听起来很奇怪。

我在文档中找不到有关如何同步计时的任何内容。问题是开始游戏的“主”码头立即开始播放音乐，然后所有其他码头稍后收到消息，因此延迟后开始播放。

然后我尝试在向所有码头发送开始消息后延迟播放游戏音乐，但有时延迟更低或更高，我无法获得良好的可靠同步。

是否有一个开源框架可以让点对点和时钟同步在 iOS 上更可靠、更容易使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T01:54:55.227

不幸的是，你在这里受到了伤害。通过网络接口进行精确的时钟同步是非常困难的。您需要您的设备在此处同步到 20 毫秒内。

我建议您执行以下操作：以 50 毫秒的间隔发送一堆 ping 数据包，让客户端立即响应。取其平均值，得出平均往返时间 (RTT)，然后将其减半以估计单向延迟。然后发送您的“开始时钟”消息并循环旋转，直到您等待单向延迟并开始播放音乐。客户端应在收到“开始时钟”后立即播放其音乐。

这里概述了一个更强大的长期同步解决方案：[http ://en.wikipedia.org/wiki/Precision_Time_Protocol](http://en.wikipedia.org/wiki/Precision_Time_Protocol)

# python - python中的递归代码

> ID：13440069
> 
> 赞同：1
> 
> 时间：2012-11-18T12:27:01.873
> 
> 标签：python, recursion

我是 python 新手，正在尝试解决我的作业...我正在尝试创建一个递归函数，该函数采用数字列表 [a, b, c....] 并将其转换为以下列表：[a , a+b, a+b+c, ....]。

这是我的代码：

```
def rec_cumsum(numbers):
    ''' Input: numbers - a list of numbers,
            Output: a list of cumulative sums of the numbers'''
    new_list=numbers
    last=new_list[-1]
    if numbers==[]:
         return numbers
    if len(numbers) == 1:
         return numbers[0]
    new_list.remove(last)
    rec= rec_cumsum(new_list)
    new_list.append(rec+last)
    return last+rec 
```

这可行，但因为我使用了最后+rec 的return，所以我不能使用return 来取回列表（new_list）。请向我解释我做错了什么...谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T13:20:59.580

让我们编写一些测试用例并实践一些测试驱动的开发：

```
tests = [[],         # Desired answer: []
         [1],        # [1]
         [1,2],      # [1, 3] 
         [1,2,3],    # [1, 3, 6]
         [1,2,1,3]]  # [1, 3, 4, 7]
for t in tests:
    print(rec_cumsum(t)) 
```

如果我们将其添加到您的代码中并[运行它，我们会得到](http://ideone.com/0poZkF)：

```
 last=new_list[-1]
IndexError: list index out of range 
```

为什么是这样？显然 -1 是一个超出范围的索引。为什么没有`new_list`-1索引？

啊哈。如果`new_list`为空，就会发生这种情况。所以我们需要首先解决基本情况。当我们这样做的时候，让我们也使用@MartijnPieters 的建议：

```
if len(numbers) <= 1:
     return numbers 
```

获得

```
def rec_cumsum(numbers):
    ''' Input: numbers - a list of numbers,
            Output: a list of cumulative sums of the numbers'''
    if len(numbers) <= 1:
         return numbers
    new_list=numbers
    last=new_list[-1]
    new_list.remove(last)
    rec = rec_cumsum(new_list)
    new_list.append(rec[-1]+last)
    return last+rec 
```

现在再次运行测试。[这次我们得到](http://ideone.com/r53hcb)

```
 return last+rec
TypeError: unsupported operand type(s) for +: 'int' and 'list' 
```

所以现在 Python 说`last`is an`int`和`rec`is a `list`，我们不能把两者加在一起。

好的，`rec`应该是一个列表，因为它是`rec_cumsum(new_list)`. 应该换`last+rec`什么？

让我们考虑一个具体的例子。如果`rec`是，`[a, a+b]`那么我们要返回`[a, a+b, a+b+c]`。我们如何形成`a+b+c`？

如何将最后一个元素添加到最后`rec`一个元素`numbers`：

```
rec[-1]+last 
```

我们想将其附加到末尾`rec`：

```
rec.append(rec[-1]+last) 
```

让我们做出改变，看看会发生什么。但是在我们编辑的同时，让我们也清理一些我们从未使用过的代码。我们可以删除`new_list.append(rec[-1]+last)`：

```
def rec_cumsum(numbers):
    ''' Input: numbers - a list of numbers,
            Output: a list of cumulative sums of the numbers'''
    if len(numbers) <= 1:
         return numbers
    new_list=numbers
    last=new_list[-1]
    new_list.remove(last)
    rec = rec_cumsum(new_list)
    rec.append(rec[-1]+last)
    return rec 
```

[现在我们的程序返回](http://ideone.com/OGC5sS)

```
[]
[1]
[1, 3]
[1, 3, 6]
[2, 3, 4, 7] 
```

万岁，我们的程序运行没有错误。但是等等......它返回错误的结果。看最后一行。

`rec_cumsum([1,2,1,3])`正在返回`[2,3,4,7]`，而正确答案是`[1,3,4,7]`。为什么第一个数字是错误的？

它与`new_list.remove(last)`. 此命令删除第*一次*出现的`last`from `new_list`。我们要删除*最后一次*出现。

所以相反，让我们使用

```
new_list = numbers[:-1] 
```

所以程序变成了：

```
def rec_cumsum(numbers):
    ''' Input: numbers - a list of numbers,
            Output: a list of cumulative sums of the numbers'''
    if len(numbers) <= 1:
         return numbers
    new_list=numbers[:-1]
    last=numbers[-1]
    rec = rec_cumsum(new_list)
    rec.append(rec[-1]+last)
    return rec 
```

[运行测试](http://ideone.com/Coi3Cm)。有用！现在回顾一下我们的解决方案，看看如何将其收紧并变得更优雅，这是一个很好的做法。我看到我们使用`new_list`和`last`作为临时变量。我们真的需要它们吗？

```
def rec_cumsum(numbers):
    if len(numbers)<=1:
        return numbers
    result = rec_cumsum(numbers[:-1])
    result.append(result[-1]+numbers[-1])
    return result 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T12:43:02.847

你的函数应该总是返回一个列表；对于空列表的情况，一个空列表，对于只有一个元素的情况，一个只有一个元素的*列表*。

但是您的代码返回一个元素，而不是一个包含一个元素的列表：

```
if len(numbers) == 1:
     return numbers[0] 
```

将其更改为仅返回`numbers`：

```
if len(numbers) == 1:
     return numbers 
```

您可以将其与其他最终状态测试结合使用：

```
if len(numbers) < 2:
     return numbers 
```

下一个问题是您在创建变量时没有创建列表的副本`new_list`；您创建对*同一个列表*的引用，您必须使用切片或创建一个明确的新列表：

```
new_list = numbers[:] 
```

如果您无论如何要从该列表中删除一个值，您也可以稍微调整一下切片，并在测试*后*`numbers`放置（为什么要这样做）：

```
if len(numbers) < 2:
     return numbers
new_list = numbers[:-1]
last = numbers[-1] 
```

在您的代码中，您实际上没有计算总和；您的号码不会添加任何内容。您从不添加`a`,`b`等`c`。此外，您似乎专注于*最后一个*数字，而您的作业表明您需要将*第一个*值与列表的其余部分相加。

那里有一个模式。不仅你`a`加到`b`，而且`a`+的总和`b`被加到`c`，然后那个总和被加到`d`，等等。让我们利用它：

```
def rec_cumsum(numbers, culmulated_sum=0):
    if len(numbers) < 1:
        return numbers
    sum = numbers[0] + culmulated_sum
    return [sum] + rec_cumsum(numbers[1:], sum) 
```

请注意，我现在什至不*费心*存储数字副本；也可以将它作为除第一个元素之外的所有内容的一部分传递给下一个递归。我们还使用 from 的*第一个*元素`numbers`来创建我们的 sum ( `numbers[0]`)。

此外，我们现在传递到目前为止的累积和，从 0 开始；这意味着我们需要改变递归函数的结束条件；我们本质上是添加`[0]`到列表的开头，并且我们要确保始终将其与下一个元素相加。

这现在可以满足您的需要：

```
>>> rec_cumsum([5, 1, 10, 2, 3])
[5, 6, 16, 18, 21] 
```

# facebook - OAuth 和 facebook access_token 不起作用，需要 OAuth 专家

> ID：13440076
> 
> 赞同：4
> 
> 时间：2012-11-18T12:28:22.210
> 
> 标签：facebook, facebook-graph-api, oauth-2.0, facebook-oauth

我已经阅读了 1000 多篇关于如何在两次 OAuth 调用中 redirect_uri 必须相同才能获得用户令牌的博客，但是 100% 的时间，无论我如何格式化 URL，它都会失败：

```
{
   "error": {
      "message": "Error validating verification code. Please make sure your redirect_uri is identical to the one you used in the OAuth dialog request",
      "type": "OAuthException",
      "code": 100
   }
} 
```

我一直一丝不苟地确保两个调用中的 URL 完全相同。我的网址必须有一个？在其中，我尝试用 %3f 替换它，但这没有帮助。必须有其他可能导致此错误的原因，我需要了解可能是什么？

在过去的一个月里，这似乎打破了我。我们在 7 月下旬做了一个节目，一切正常（该节目的基本 URL 不同，因为它是不同的服务器）。会不会是 URL 是这种格式：

```
someprestuff.morestuff.mainurl.com?prm=value 
```

Facebook 接受的 URL 是否有太多“部分”？

我正在寻找替代的东西来寻找。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T12:40:30.593

url 应该相同，并且必须转义。在 url 中，它必须如下所示：

```
http%3A//someprestuff.morestuff.mainurl.com%3Fprm%3Dvalue 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-18T23:14:22.117

吉姆上面的评论有效，但要澄清的是，这是一个正斜杠，它为我们修复了它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-24T15:39:24.137

今天遇到了同样的问题，原来是redirect_uri使用了http:// URL Schema，而Facebook只接受https://

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-30T14:32:30.157

我刚刚在负载均衡器后面的服务器上完成了对这个问题的跟踪。事实证明，当负载均衡器传递`HTTP_X_FORWARDED_PROTO`标头时，不知何故，在 V3 PHP Facebook 库、PHP 和 Apache 之间，标头没有被识别。

以下是库中的相关代码：

```
 protected function getHttpProtocol() {
    if ($this->trustForwarded && isset($_SERVER['HTTP_X_FORWARDED_PROTO'])) {
      if ($_SERVER['HTTP_X_FORWARDED_PROTO'] === 'https') {
        return 'https';
      }
      return 'http';
    }
    /*apache + variants specific way of checking for https*/
    if (isset($_SERVER['HTTPS']) &&
        ($_SERVER['HTTPS'] === 'on' || $_SERVER['HTTPS'] == 1)) {
      return 'https';
    }
    /*nginx way of checking for https*/
    if (isset($_SERVER['SERVER_PORT']) &&
        ($_SERVER['SERVER_PORT'] === '443')) {
      return 'https';
    }
    return 'http';
 } 
```

如您所见，这里适应了一些场景，因此您必须确保正确配置适用于您的任何情况，以便此代码块成功。

最可能的解决方案是在您的 facebook 配置数组中`trustForwarded`设置`true`。

# ios - 带有上一个和下一个按钮滚动问题的 UItableview 和键盘 - iPhone

> ID：13440078
> 
> 赞同：1
> 
> 时间：2012-11-18T12:28:59.873
> 
> 标签：ios, uitableview, keyboard, scrollview

在这里，我在滚动视图上有一个 tableView。每行包含一个文本字段。下一个按钮没问题（在 upword 上正确查看动画）但是当我按下键盘上的上一个按钮时，我必须根据 textField 一个一个地显示视图。我该如何解决这个问题？我必须在很多方面都这样做。请尽快帮助我。我非常需要它。可能是我在某个地方做错了。对不起我的语言问题。示例代码可能会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T06:47:42.753

您好请尝试以下方法根据选择的文本字段上下滚动您的表格视图，在文本字段委托方法中编写此代码

```
- (void)textFieldDidEndEditing:(UITextField *)textField{

  // calculate the nsindexpath based on the textfield which is selected

 //- (void)scrollToRowAtIndexPath:(NSIndexPath *)indexPath atScrollPosition:(UITableViewScrollPosition)scrollPosition animated:(BOOL)animated;

[yourtableview scrollToRowAtIndexPath:calcutaedIndexPath atScrollPosition:UIScrollViewPositionTop animated:YES];

} 
```

希望对你有帮助

# python - Python/Django：如何最快地获取文件（基于路径和名称）

> ID：13440079
> 
> 赞同：0
> 
> 时间：2012-11-18T12:28:58.903
> 
> 标签：python, operating-system

我的网站用户可以上传图像文件，然后需要在页面上显示它们时找到它们（使用 src = ""）。目前，我将所有图像放在一个目录中。如果有很多文件怎么办 - 找到正确的文件会很慢吗？他们被索引了吗？我应该创建子目录吗？

我使用 Python/Django。一切都在网络派系上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T12:32:24.133

单个文件的访问时间不受同一目录中文件数量的影响。

在包含更多文件的目录上运行`ls -l`当然需要更长的时间。与在文件浏览器中查看该目录相同。当然，如果您将这些图像存储在由用户名定义的子目录中，则使用这些图像可能会更容易。但这仅取决于您将要对它们做什么。这样做没有技术原因。

像这样想。图像文件的完整路径 ( `/srv/site/images/my_pony.jpg`) 是文件的实际地址。您的 Web 服务器进程查看那里，并返回它找到的任何数据，如果没有，则返回 404。它不做的是列出所有文件`/srv/site/images`并查看该列表以查看它是否包含名为`my_pony.jpg`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T12:41:18.677

如果仅出于组织目的，并且为了帮助系统维护，您应该创建子目录。否则，您几乎不会遇到目录可以容纳的[最大文件数。](https://stackoverflow.com/a/466596/790387)

对 Web 的性能影响可以忽略不计。但是，对于其他应用程序（文件列表、ftp、备份等），可能会产生后果，但前提是您需要处理*大量*文件。

# android - android listview获取正确的图标

> ID：13440082
> 
> 赞同：0
> 
> 时间：2012-11-18T12:29:02.790
> 
> 标签：android, listview, icons

我有带图标的 ListView。每个 ListView 行要么有不同的图标，要么没有图标。

我能够为应该有它们的行获得正确的图标，但问题是，在不应该有任何图标的行中有一些图标。

```
public View getView(int position, View convertView, ViewGroup parent) {
    // TODO Auto-generated method stub
     View vi=convertView;
        if(convertView==null)
            vi = inflater.inflate(R.layout.list_item, null);

        TextView title = (TextView) vi.findViewById(R.id.name);
        ImageView icon = (ImageView) vi.findViewById(R.id.icon);

        HashMap<String, String> item = new HashMap<String, String>();
        item = data.get(position);

        String imgPath = ASSETS_DIR + item.get(myTable.KEY_PIC) + ".png";

            try {
                Bitmap bitmap = BitmapFactory.decodeStream(vi
                        .getResources().getAssets().open(imgPath));
                icon.setImageBitmap(bitmap);

            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        title.setText(item.get(myTable.KEY_NAME));

    return vi;
} 
```

`KEY_PIC`总是有一个值，如果`KEY_PIC`的值等于某个图标的文件名，那么它应该显示图标。我不知道如何编码。我猜我应该在 if-else 中做点什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T15:31:46.043

可能的问题是视图正在被回收，并且您永远不会清除先前设置的图像，请尝试以下方法来证明这一点：

```
 String imgPath = ASSETS_DIR + item.get(myTable.KEY_PIC) + ".png";

        try {
            Bitmap bitmap = BitmapFactory.decodeStream(vi
                    .getResources().getAssets().open(imgPath));
            icon.setImageBitmap(bitmap);

        } catch (Exception e) {
            e.printStackTrace();
            icon.setImageDrawable(null);
        } 
```

但是，依靠异常处理来获得完全有效的结果并不是一个好的做法（也不是性能友好的）。我建议你让你的 myTable.KEY_PIC 列返回 null，然后你可以这样做：

```
 String imageName = item.get(myTable.KEYP_PIC);
 if (imageName == null) {
   icon.setImageDrawable(null);
 } else {
   //your code
 } 
```

哪个更干净。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T12:56:56.530

`HashMap<String, String> item = new HashMap<String, String>();`首先，您通过放入getView()做了一件坏事。现在，您正在为重新显示的每一行制作一个新的，这是不需要的。只需删除它并使用：

```
String imgPath = ASSETS_DIR + data.get(position).get(myTable.KEY_PIC) + ".png"; 
```

老实说，如果您声称如果该行不应该显示某些内容，那么您的路径不会导致任何事情，我无法理解您如何看到一个图标。如果它运行良好，那么您可以简单地捕获设置时可能发生的异常并且不对其执行任何操作。研究该职位的实际价值`data`应该会产生洞察力。如果是我，我只会摆`null`在那些位置上。

一个临时的替代解决方案是为列表视图中的每个位置创建一个布尔数组，然后仅在该位置的值签出时才执行图标设置。

```
boolean[] varIcon = {
            true, 
            false, 
            false, 
            true,
            false,
            true };
// ...
// then in the getView() now;

if (varIcon[position] == true) {
                String imgPath = ASSETS_DIR + data.get(position).get(myTable.KEY_PIC) + ".png";
                 try {
                        Bitmap bitmap = BitmapFactory.decodeStream(vi
                                .getResources().getAssets().open(imgPath));
                        icon.setImageBitmap(bitmap);

                    } catch (IOException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
            } 
```

# svn - 颠覆 - 删除绿色刻度

> ID：13440086
> 
> 赞同：2
> 
> 时间：2012-11-18T12:29:32.787
> 
> 标签：svn, tortoisesvn

颠覆新手警告！

我在 Windows Server 2003 上安装了 Subversion 和 TortoiseSVN v 1.6.6。

我有一个在 IIS 下从位置 c:\websites\rdlm 运行的简单网站。

在开发服务器上，网站代码位于 c:\codebase\rdlm

以前，网站将作为简单的文件副本从开发服务器复制到生产 Web 服务器。这在生产文件夹上留下了一个绿色勾号。我的猜测是，这是因为该文件夹被复制到包括所有隐藏的 .svn 文件夹中。

为了尝试解决这个问题，我首先从开发服务器上的开发文件夹运行“导出”到部署文件夹 (c:\deployments\rdlm)。这似乎确实有效，临时文件夹上没有绿色勾号。然后我将此文件夹复制到生产 Web 服务器。令我惊讶的是，生产服务器 c:\websites\rdlm 上出现了绿色勾号。我已经在文件夹中搜索了隐藏的 .svn（首先启用资源管理器以便显示隐藏的文件夹和文件），但没有。

谁能解释为什么我在产品服务器上的 c:\websites\rdlm 上仍然有绿色的勾号？

我的观点是，甚至不应该在 prod 服务器上安装 tortoise SVN - 然后我假设没有绿色勾号，但我仍然想知道这个问题的答案，以便我更好地了解颠覆是如何工作的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T12:37:09.487

TortoiseSVN 状态缓存 TSVNCache.exe 应用了图标覆盖（“绿色勾号”）。它还没有赶上 .svn 目录已被删除的事实，因此它将覆盖层保留在那里。

我同意 TortoiseSVN 不应该在你的生产服务器上；它甚至不应该在您的开发服务器上。您应该有一个构建和部署过程（通过持续集成服务器管理），该过程负责将应用程序放在需要的位置，在需要的配置中。至少对于开发环境。对于生产，您应该有一个非常明确的、可重复的过程来获取服务器上的位，并限制对该服务器的访问，这样您就可以确保只有指定的人员在应该发布代码时才将代码发布到生产环境（并发布正确的代码）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T12:35:27.073

绿色勾号与服务器上安装的内容无关，它是 TortoiseSVN 客户端的一个特性。但是，图标覆盖被大量缓存并且失效有点不可靠。稍等片刻，比如一天左右，图标覆盖就会消失。

# javascript - FadeIn 在循环延迟时停止工作

> ID：13440090
> 
> 赞同：0
> 
> 时间：2012-11-18T12:30:19.347
> 
> 标签：javascript, jquery, delay, fadein

我想为此添加 .delay() ，因此每个项目都会一个接一个地进行动画处理。问题是，如果我将 delay() 添加到元素中，fadeIn 将停止工作。

工作代码（但没有延迟......）

```
time = 500;

for (var i=1;i<=5;i++){

    delay2 = (i * time);
    $('<tr><td><h3>Hello</h3></td><td>'+i+'</td</tr>').hide().appendTo('#table').fadeIn("slow").css('display', 'table-row');

    // do more stuff here

}; 
```

[jsfiddle 示例](http://jsfiddle.net/pYYFM/4/)

FadeIn 不工作（因为它有延迟......）

```
time = 500;

for (var i=1;i<=5;i++){

    delay2 = (i * time);
    $('<tr><td><h3>Hello</h3></td><td>'+i+'</td</tr>').hide().appendTo('#table').delay(delay2).fadeIn("slow").css('display', 'table-row');

    // do more stuff here

}; 
```

[jsfiddle 示例](http://jsfiddle.net/u5dEp/2/)

有谁知道是什么问题？在第二个示例中，它应该一个接一个地为项目设置动画，但这不会发生，它们甚至都没有动画。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T12:36:47.943

您的答案：

```
$('<tr><td><h3>Hello</h3></td><td>'+i+'</td</tr>')
.hide()
.appendTo('#table')
.delay(delay2)
.fadeIn("slow")
.queue(function() { $(this).css('display', 'table-row'); }); 
```

解释很简单：当您将进入队列的事件和未进入队列的事件串联起来时，未进入队列的事件将绕过它。$.css() 不会进入 fx 队列，所以会立即执行。

对此的解决方案是使用 $.queue() 函数将不可排队的调用排队到 fx 队列中。

**工作小提琴**：http: [//jsfiddle.net/u5dEp/6/](http://jsfiddle.net/u5dEp/6/)

（一个答案中有很多队列）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T12:37:28.237

试试这个：

```
$('<tr><td><h3>Hello</h3></td><td>'+i+'</td</tr>')
.appendTo('#table')
.hide()
.delay(delay2)
.show('slow'); 
```

这里的问题是 css 更改会立即发生，而您希望它在淡入完成后发生。您根本不需要`fadeIn`这里，特别是因为`show`会记住`display`属性值并自动恢复它。

这是一个小提琴：http: [//jsfiddle.net/u5dEp/7/](http://jsfiddle.net/u5dEp/7/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-18T12:45:09.297

即使这样也可以工作：http: [//jsfiddle.net/pYYFM/8/](http://jsfiddle.net/pYYFM/8/)

```
time = 500;

for (var i=1;i<=5;i++){

delay2 = (i * time);
    $('<tr><td><h3>Hello</h3></td><td>'+i+'</td></tr>').hide().appendTo('#table').delay(delay2).fadeIn("slow").queue();
                                               ^-------missed this
};​ 
```

# c++ - 对重载函数的模糊调用（学习模板）

> ID：13440091
> 
> 赞同：2
> 
> 时间：2012-11-18T12:30:26.077
> 
> 标签：c++

我开始学习模板，并从书中复制了代码，但编译器给了我这个错误

> 错误 1 ​​错误：“交换”：对重载函数的模糊调用”

这是我的程序

```
#include <iostream>

template <typename X>
void swap(X &a, X &b);

int _tmain(){
    using namespace std;
    int a, b;

    cout << "enter two numbers:\n";
    cin >> a >> b;
    cout << "Your numbers are: " << a << ", " << b << endl;

    swap(a, b); //error is here
    cout << "Your numbers reversed are: " << a << ", " << b << endl;

    return 0;
}

template <typename X>
void swap(X &a, X &b){
    X temp = a;
    a = b;
    b = temp;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T12:33:44.610

您正在使用相同的签名重新定义函数交换，因此您对它的定义不明确，因此是一个不明确的调用。

如果您想维护具有相同签名的函数，您应该选择不使用“using namespace std;”，这不会影响您的 swap() 定义，或者只是在另一个命名空间中定义函数。

例子：

```
namespace your_namespace {

    template <typename X>
    void swap(X &a, X &b) {
        X temp = a;
        a = b;
        b = temp;
    }

}

int foo(10), bar(20);
std::cout << "foo: " << foo << "; bar: " << bar << std::endl;

your_namespace::swap(foo, bar);
std::cout << "foo: " << foo << "; bar: " << bar << std::endl; 
```

输出：

```
foo: 10; bar: 20
foo: 20; bar: 10 
```

问候！

# json - 将 PhoneGap BlackBerry App 连接到在线服务器

> ID：13440094
> 
> 赞同：1
> 
> 时间：2012-11-18T12:30:43.190
> 
> 标签：json, cordova, mobile, blackberry-webworks, mobile-application

我正在创建一个 BlackBerry 应用程序，它提供现有 Web 应用程序的功能，但使其适合手机用户。我正在使用 PhoneGap 并利用 BlackBerry WebWorks SDK 创建移动应用程序。我需要从移动应用程序向运行 Web 应用程序的服务器发送数据和接收数据（提交表单、更新配置文件）。我还希望应用程序的用户通过 BlackBerry Internet Service (BIS) 与移动应用程序的其他用户聊天。我希望移动应用程序能够查询已为现有 Web 应用程序创建的数据库，以便已下载该应用程序的现有用户可以在其 BlackBerry 设备而不是计算机上查看其详细信息。有人可以推荐一个解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:39:43.780

使用 phonegap，您可以通过 AJAX 发送 XMLHttpRequest。您可以使用纯 JavaScript 或使用 jQuery 更轻松地完成此操作。

您需要使用服务器端语言（如 php）来处理数据库。

这是一个简单的示例，假设您在 Phonegap 应用程序中包含了 jQuery。

```
window.onload = function (){
document.addEventListener("deviceready", deviceReady, false);
}
function deviceReady{
    var userName = 'Hans';
    var userShoeSize = 'Medium';
    $.post("http://example.com/responseHandler.php", {
        userName: userName, userShoeSize:userShoeSize}, 
        function(data) {
            alert(data.greeting+data.shoeSize);
    }, "json");
} 
```

并在 responseHandler.php 中的服务器上：

```
<?php
    header("Access-Control-Allow-Origin: *");
    $response = array();
    $response['greeting'] = 'Hi, '.$_POST['userName'];
    $response['shoeSize'] = 'Your shoes are size '.$_POST['userShoeSize'];
    echo json_encode($response);
?> 
```

通过在服务器上回显一个 JSON 编码的字符串，javascript 可以轻松地解析响应。您不必使用 JSON，您可以处理在服务器上回显的任何内容。

请记住将您的页面列入白名单并允许来自服务器上其他来源的查询字符串。

# c++ - OpenCV/C - 提高耗时循环的速度？

> ID：13440096
> 
> 赞同：2
> 
> 时间：2012-11-18T12:31:18.430
> 
> 标签：c++, opencv

我最近使用 OpenCV 2.31(C++) 实现了一种图像变形方法。但是，这种方法非常耗时......经过一些调查和改进，我成功地将处理时间从 400ms 减少到大约 120ms，这非常好。我通过展开循环来实现这个结果（它将时间从 400 毫秒减少到 330 毫秒），然后我在我的 VC++ 编译器 2008 快速版（启用 O2 标志）上启用了优化标志——最后一个修复将处理时间提高到了 120 毫秒左右。

然而，由于我有一些其他处理要围绕这个扭曲实现，我想把这个处理时间减少到 20 毫秒以上——当然低于这个值会更好，但我不知道这是否可能！ ！...

还有一件事，我想使用免费提供的库来做到这一点。所有建议都非常受欢迎。

贝娄，你会找到我所说的方法。

感谢您的帮助

阿里尔 B。

```
cv::Mat Warp::pieceWiseWarp(const cv::Mat &Isource, const cv::Mat &s, TYPE_CONVERSION type)
{       
cv::Mat Idest(roi.height,roi.width,Isource.type(),cv::Scalar::all(0));
float xi, xj, xk, yi, yj, yk, x, y;
float X2X1,Y2Y1,X2X,Y2Y,XX1,YY1,X2X1_Y2Y1,a1, a2, a3, a4,b1,b2,c1,c2;
int x1, y1, x2, y2;
char k;     
int nc = roi.width;
int nr = roi.height;
int channels = Isource.channels();
int N = nr * nc;

float *alphaPtr = alpha.ptr<float>(0);
float *betaPtr = beta.ptr<float>(0);
char *triMaskPtr = triMask.ptr<char>(0);
uchar *IdestPtr = Idest.data;

for(int i = 0; i < N;  i++, IdestPtr += channels - 1)       
        if((k = triMaskPtr[i]) != -1)// the pixel do belong to delaunay
        {

            cv::Vec3b t = trianglesMap.row(k);

            xi = s.col(1).at<float>(t[0]); yi = s.col(0).at<float>(t[0]); 
            xj = s.col(1).at<float>(t[1]); yj = s.col(0).at<float>(t[1]); 
            xk = s.col(1).at<float>(t[2]); yk = s.col(0).at<float>(t[2]);                       

            x = xi + alphaPtr[i]*(xj - xi) + betaPtr[i]*(xk - xi);
            y = yi + alphaPtr[i]*(yj - yi) + betaPtr[i]*(yk - yi);

            //...some bounds checking here...

            x2 = ceil(x); x1 = floor(x);
            y2 = ceil(y); y1 = floor(y);                

            //2\. use bilinear interpolation on the pixel location - see wiki for formula...
            //...3\. copy the resulting intensity (GL) to the destination (i,j)

            X2X1 = (x2 - x1);
            Y2Y1 = (y2 - y1);
            X2X  = (x2 - x);
            Y2Y  = (y2 - y);
            XX1  = (x - x1);                
            YY1  = (y - y1);

            X2X1_Y2Y1 = X2X1*Y2Y1;
            a1 = (X2X*Y2Y)/(X2X1_Y2Y1);
            a2 = (XX1*Y2Y)/(X2X1_Y2Y1);
            a3 = (X2X*YY1)/(X2X1_Y2Y1);
            a4 = (XX1*YY1)/(X2X1_Y2Y1);

            b1 = (X2X/X2X1);
            b2 = (XX1/X2X1);

            c1 = (Y2Y/Y2Y1);
            c2 = (YY1/Y2Y1);

            for(int c = 0; c < channels; c++)// Consider implementing this bilinear interpolation elsewhere in another function 
            {
                if(x1 != x2 && y1 != y2)
                    IdestPtr[i + c] = Isource.at<cv::Vec3b>(y1,x1)[c]*a1
                                                + Isource.at<cv::Vec3b>(y2,x1)[c]*a2
                                                + Isource.at<cv::Vec3b>(y1,x2)[c]*a3
                                                + Isource.at<cv::Vec3b>(y2,x2)[c]*a4;                       
                if(x1 == x2 && y1 == y2)
                    IdestPtr[i + c] = Isource.at<cv::Vec3b>(y1,x1)[c];

                if(x1 != x2 && y1 == y2)
                    IdestPtr[i + c] = Isource.at<cv::Vec3b>(y1,x1)[c]*b1 + Isource.at<cv::Vec3b>(y1,x2)[c]*b2;

                if(x1 == x2 && y1 != y2)
                    IdestPtr[i + c] = Isource.at<cv::Vec3b>(y1,x1)[c]*c1 + Isource.at<cv::Vec3b>(y2,x1)[c]*c2;                      
            }                       
        }

if(type == CONVERT_TO_CV_32FC3)
    Idest.convertTo(Idest,CV_32FC3);
if(type == NORMALIZE_TO_1)
    Idest.convertTo(Idest,CV_32FC3,1/255.);
return Idest;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T11:55:20.687

我会建议：

1.将除以公因数改为乘法。即从a = a1/d；b = b1/d 到 d_1 = 1/d；a = a1*d_1; b = b1*d_1

2.消除四个if测试到一个单一的双线性插值。

我不确定这是否对你有帮助。你可以试一试。

# python - Django ModelForm booleanfield 必填字段不起作用

> ID：13440097
> 
> 赞同：4
> 
> 时间：2012-11-18T12:31:45.777
> 
> 标签：python, django, django-forms, django-formwizard

我不知道为什么不起作用，但这是一个非常简单的例子

**模型.py**

```
class Reg(models.Model):
    event = models.ForeignKey(Event, verbose_name=u'Мероприятие')
    #первый автор
    fam_author = models.CharField(max_length=200, verbose_name=u'Фамилия автора' )
    name_author = models.CharField(max_length=100, verbose_name=u'Имя автора' )
    ot_author = models.CharField(max_length=200,blank=True, null=True, verbose_name=u'Отчество автора' )
    no_ot = models.BooleanField(blank=True,verbose_name=u'Для граждан, не имеющих отчество по паспорту, отметить галочкой следующее поле')
    ...................
    personal = models.BooleanField(verbose_name=u'Согласие на обработку и использование персональных данных')

    class Meta:
        verbose_name = 'Автор'
        verbose_name_plural = 'Автор'

    class Admin:
        pass

    def __unicode__(self):
        return u'%s (%s)' % (self.fam_author, self.name_author) 
```

**表格.py**

```
class GenForm11(ModelForm):
    class Meta:
        model = Reg
        exclude = ('event') 
```

**网址.py**

```
(r'^kras/', ContactWizard.as_view([GenForm11, GenForm31, GenForms4, GenForms5, GenForms6, GenForms7])), 
```

pytnon manage.py syncdb

在管理截图中

![](../Images/21650dbe58a080687fb3b5071fda2df9.png)

在网站上 ![](../Images/1a45c53b9119753d9e27dce9dc6da5f4.png)

为什么会这样？多次从基础模型中删除并再次创建

UPD1

**python manage.py sqlall**

```
CREATE TABLE `reg_reg` (
    `id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY,
    `event_id` integer NOT NULL,
    `fam_author` varchar(200) NOT NULL,
    `name_author` varchar(100) NOT NULL,
    `ot_author` varchar(200),
    `no_ot` bool NOT NULL,
    `birth_author` date NOT NULL,
    `tel_m_author` varchar(15) NOT NULL,
    `tel_r_author` varchar(15),
    `tel_d_author` varchar(15),
    `email_author` varchar(75) NOT NULL,
    `email_d_author` varchar(75),
    `text_author` longtext,
    `facultet_diplom` varchar(50),
    `napravl_diplom` varchar(50),
    `kurs_diplom` varchar(50),
    `group_diplom` varchar(50),
    `text_diplom` longtext,
    `post_diplom` varchar(200),
    `sec` varchar(200) NOT NULL,
    `personal` bool NOT NULL
)
; 
```

`personal`布尔非空

:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:01:16.637

模型.py

```
from django.core.exceptions import ValidationError

    def clean(self):
        if not self.personal:
            raise ValidationError('blah') 
```

或者您可以在表单中验证它...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T13:03:03.663

“必需”确实有效 - 它是一个 BooleanField，默认为`False`且不为空。
未选中它是一个有效值 (False)。

您可以覆盖 clean() 方法以确保它设置为 true。例如：

```
class Reg(models.Model):
    # ...

    def clean(self):
        from django.core.exceptions import ValidationError
        if not self.personal:
            raise ValidationError('CUSTOM ERROR HERE') 
```

或以下列形式验证它：

```
class GenForm11(ModelForm):
    class Meta:
        model = Reg
        exclude = ('event')

    def clean_personal(self):
        personal = self.cleaned_data['personal']

        if not personal:
            raise ValidationError('CUSTOM ERROR HERE')

        return personal 
```

# c# - 如何设置进度条的值

> ID：13440098
> 
> 赞同：0
> 
> 时间：2012-11-18T12:32:01.487
> 
> 标签：c#, winforms, progress-bar

我使用 C# Winforms 编写了一个用户控件。在用户控件中，我有三个文本框：

*   txtStartNumber - 输入类型：int。
*   txtEndNumber - 输入类型：int。
*   txtQuantity - iput 的类型为：int。（值 = txtEndNumber - txtStartNumber）

进度条表示编号。添加到数据库的记录及其总范围设置为等于 txtQuantity。

当一条或多条记录重复时，进度条停止。

我的问题是：

1.  如何设置进度条的初始值？
2.  如何管理进度条显示的进度？

我如何将其保存到数据库中：

```
for (long i = from; i < to; i++)
{
    for (int j = 0; j < (to - from); j++)
    {
        arrCardNum[j] = from + j;
        string r = arrCardNum[j].ToString();
        try
        {
            sp.SaveCards(r, 2, card_Type_ID, SaveDate, 2);
            progressBar1.Value = j;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-18T12:52:37.107

尝试这个：

```
private void StartBackgroundWork() {
    if (Application.RenderWithVisualStyles)
        progressBar.Style = ProgressBarStyle.Marquee;
    else {
        progressBar.Style = ProgressBarStyle.Continuous;
        progressBar.Maximum = 100;
        progressBar.Value = 0;
        timer.Enabled = true;
    }
    backgroundWorker.RunWorkerAsync();
}

private void timer_Tick(object sender, EventArgs e) {
    progressBar.Value += 5;
    if (progressBar.Value > 120)
        progressBar.Value = 0;
} 
```

Marquee 样式需要启用 VisualStyles，但它会自行持续滚动而无需更新。我将其用于不报告进度的数据库操作。

这是另一个[进度条教程](http://www.dotnetperls.com/progressbar)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-20T19:32:14.383

要更改值，请使用：

```
private void timer1_Tick(object sender, EventArgs e)
    {
        progressBar2.Value = progressBar2.Value - 15;
    } 
```

在 C# 中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-17T20:53:03.837

您不能使用循环来使用进度条执行此操作。在 for、while、do...while 循环或计时器中运行代码是有区别的。循环中的代码立即完成，您看不到这一点，在计时器中您可以。即使您尝试在计数器中放入循环，它也不起作用：

```
for(int i=a;i<b;++i)
{
    if (cnt < 1000000)
    {
        IncrProgressBar();
        cnt++;
    }
    else
    {
        cnt = 0;
    }
} 
```

如果要使用进度条执行此操作，则必须放入将数据添加到数据库的计时器 OnTick 事件代码，并在此事件中增加进度条值。这与更改表单组件的其他属性（文本、大小...）类似。如果你想看到组件的变化，你必须使用计时器。

# eclipse - 尝试运行测试时出现“无法联系 RemoteTestNG 客户端”错误

> ID：13440099
> 
> 赞同：5
> 
> 时间：2012-11-18T12:32:05.307
> 
> 标签：eclipse, maven, testng

## 问题

在 Maven 托管项目上使用 TestNG，我似乎无法通过 TestNG eclipse 插件运行测试。尝试运行测试时，会弹出以下错误消息（在对话窗口内）：

> 无法联系 RemoteTestNG 客户端。确保您的类路径中没有旧版本的 testng.jar。
> 
> 原因：
> 尝试联系 RemoteTestNG 时超时。

如何解决这个问题？

## 我尝试过的事情

（在询问了办公室 QA 部门的**所有**同事，并通过常见的搜索引擎和 TestNG 论坛查找信息后）

*   确保我的课程路径上没有旧版本（自然）。
*   消除 maven 导入的 jar 和 TestNG eclipse 插件使用的 jar 之间可能发生的冲突（两者都是 6.7 版本，并且该项目已`pom.xml`确认仅使用其自己的依赖 jar）。
*   在上述更改后执行 Maven 更新和构建。
*   在不同的 JRE（特别是 1.7.0）上运行。

## 相关信息

### 环境：

*   **操作系统：** Win XP pro SP3
*   **JRE：** 1.6.0 更新 31
*   **测试NG：** 6.7
*   **Maven：** 3.0.3
*   **IDE：** Eclipse Juno Java EE SR1

### `pom.xml`内容：

```
<?xml version="1.0" encoding="UTF-8" ?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <artifactId>SGTest</artifactId>
    <name>SGTest</name>
    <description>Service Grid Test project for XAP</description>

    <parent>
        <groupId>com.my_product.quality.sgtest</groupId>
        <artifactId>SGTest-parent</artifactId>
        <version>3.0.0</version>
        <relativePath>http://mvn-srv:8081/artifactory/libs-snapshot-local/com/my_product/quality/sgtest/SGTest-parent/3.0.0/SGTest-parent-3.0.0.pom</relativePath>
    </parent>

    <properties>
        <xap.home>${env.XAP_LATEST}</xap.home>
    </properties>

    <dependencies>
        <dependency>
            <groupId>com.my_product</groupId>
            <artifactId>my_opensource_product</artifactId>
            <version>${gsVersion}</version>
            <scope>system</scope>
            <systemPath>${xap.home}/lib/required/my_opensource_product.jar</systemPath>
        </dependency>
        <dependency>
            <groupId>com.my_product</groupId>
            <artifactId>gs-runtime</artifactId>
            <version>${gsVersion}</version>
            <scope>system</scope>
            <systemPath>${xap.home}/lib/required/gs-runtime.jar</systemPath>
        </dependency>
        <dependency>
            <groupId>com.my_product.quality</groupId>
            <artifactId>DashboardReporter</artifactId>
            <version>0.0.1</version>
        </dependency>
        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>apps</artifactId>
            <version>${project.version}</version>
            <type>pom</type>
        </dependency>
        <dependency>
            <groupId>com.my_product.quality</groupId>
            <artifactId>webuitf</artifactId>
            <version>1.0.0</version>
        </dependency>
        <dependency>
            <groupId>com.my_product.quality</groupId>
            <artifactId>wanem</artifactId>
            <version>0.0.1-SNAPSHOT</version>
        </dependency>
        <dependency>
            <groupId>org.my_opensource_product.xenserver</groupId>
            <artifactId>xenserver-machine-provisioning</artifactId>
            <version>2.0.0</version>
        </dependency>
        <dependency>
            <groupId>org.swift.common</groupId>
            <artifactId>confluence-soap</artifactId>
            <version>0.5</version>
        </dependency>
        <dependency>
            <groupId>org.testng</groupId>
            <artifactId>testng</artifactId>
            <version>6.7</version>
        </dependency>
        <dependency>
            <groupId>org.apache.ant</groupId>
            <artifactId>ant-jsch</artifactId>
            <version>1.8.3</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
        </dependency>
        <dependency>
            <groupId>com.thoughtworks.xstream</groupId>
            <artifactId>xstream</artifactId>
            <version>1.4.2</version>
        </dependency>
        <dependency>
            <groupId>javax.mail</groupId>
            <artifactId>mail</artifactId>
            <version>1.4.5</version>
        </dependency>
        <dependency>
            <groupId>org.codehaus.groovy</groupId>
            <artifactId>groovy-all</artifactId>
            <version>1.8.6</version>
        </dependency>
        <dependency>
            <groupId>org.apache.commons</groupId>
            <artifactId>commons-vfs2</artifactId>
            <version>2.0</version>
        </dependency>
        <dependency>
            <groupId>org.hyperic</groupId>
            <artifactId>sigar</artifactId>
            <version>1.6.5</version>
            <scope>system</scope>
            <systemPath>${xap.home}/lib/platform/sigar/sigar.jar</systemPath>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-jms</artifactId>
            <version>3.1.1.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>hsqldb</groupId>
            <artifactId>hsqldb</artifactId>
            <version>1.8.0.10</version>
        </dependency>
        <dependency>
            <groupId>org.hamcrest</groupId>
            <artifactId>hamcrest-all</artifactId>
            <version>1.3</version>
        </dependency>
    </dependencies>

    <build>
        <testSourceDirectory>src/main/java</testSourceDirectory>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <version>2.12.4</version>
                <configuration>
                    <classpathDependencyExcludes>
                        <classpathDependencyExcludes>com.my_product.quality.sgtest.apps.security:processor</classpathDependencyExcludes>
                        <classpathDependencyExcludes>com.my_product.quality.sgtest.apps.archives:customSecurityProcessor</classpathDependencyExcludes>
                        <classpathDependencyScopeExclude>runtime</classpathDependencyScopeExclude>
                    </classpathDependencyExcludes>
                    <argLine>-Xmx2048m -XX:MaxPermSize=512m</argLine>
                    <includes>
                        <include>${includes}</include>
                    </includes>
                    <excludes>
                        <exclude>${excludes}</exclude>
                    </excludes>
                    <disableXmlReport>true</disableXmlReport>
                    <reportsDirectory>${sgtest.summary.dir}</reportsDirectory>
                    <reportFormat>xml</reportFormat>
                    <properties>
                        <property>
                            <name>configfailurepolicy</name>
                            <value>continue</value>
                        </property>
                        <property>
                            <name>suitename</name>
                            <value>${sgtest.suiteName}${sgtest.suiteId}</value>
                        </property>
                        <property>
                            <name>testname</name>
                            <value>${sgtest.suiteName}${sgtest.suiteId}</value>
                        </property>
                        <property>
                            <name>outputDir</name>
                            <value>${sgtest.summary.dir}</value>
                        </property>
                        <property>
                            <name>listener</name>
                            <value>framework.testng.SGTestNGListener,framework.testng.SGTestNgSuiteSplitter,framework.testng.report.TestNgReporterImpl</value>
                        </property>
                    </properties>
                    <systemProperties>
                        <sgtest.suiteId>${sgtest.suiteId}</sgtest.suiteId>
                        <sgtest.numOfSuites>${sgtest.numOfSuites}</sgtest.numOfSuites>
                        <selenium.browser>${selenium.browser}</selenium.browser>
                        <org.apache.commons.logging.Log>org.apache.commons.logging.impl.Jdk14Logger</org.apache.commons.logging.Log>
                        <com.gs.logging.level.config>true</com.gs.logging.level.config>
                        <java.util.logging.config.file>${basedir}/logging/sgtest_logging.properties</java.util.logging.config.file>
                        <sgtest.buildFolder>${sgtest.buildFolder}</sgtest.buildFolder>
                        <sgtest.url>http://192.168.9.121:8087/sgtest3.0-xap/</sgtest.url>
                        <sgtest.disconnect.machines>${sgtest.disconnect.machines}</sgtest.disconnect.machines>
                        <com.gs.work>${com.gs.work}</com.gs.work>
                        <com.gs.deploy>${com.gs.deploy}"</com.gs.deploy>
                        <cppOS>${cppOS}</cppOS>
                    </systemProperties>
                    <testFailureIgnore>true</testFailureIgnore>
                    <detail>true</detail>
                </configuration>
            </plugin>
            <plugin>
                <artifactId>maven-assembly-plugin</artifactId>
                <version>2.3</version>
                <configuration>
                    <descriptors>
                        <descriptor>src/main/assembly/assembly.xml</descriptor>
                    </descriptors>
                    <appendAssemblyId>false</appendAssemblyId>
                </configuration>
                <executions>
                    <execution>
                        <id>make-assembly</id> <!-- this is used for inheritance merges -->
                        <phase>package</phase> <!-- bind to the packaging phase -->
                        <goals>
                            <goal>single</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
</project> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-05T21:33:16.483

通过错误地配置我的 TestNG 启动配置（在 Eclipse 中），我能够使确切的问题发生。具体来说，我指定它作为 JVM 参数传递以下内容：

```
-runTestAsTool=true 
```

代替

```
-DrunTestAsTool=true 
```

添加缺少`D`的为我修复了它。因此，可能会仔细检查您的启动配置是如何配置的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-12T17:59:33.660

此问题源于在 Windows 上运行长 Java 类路径时发生的问题（这些超出了*进程创建命令限制*）。它已在 Eclipse 错误跟踪系统上进行了报告，并且在 Stackoverflow 上也进行[了](https://bugs.eclipse.org/bugs/show_bug.cgi?id=327193)[讨论](https://stackoverflow.com/questions/201816/how-to-set-a-long-java-classpath-in-msdos-windows)。

要在 Eclipse Juno 版本上解决这个问题，我们可以绕过命令限制（使用上面[链接的帖子](https://stackoverflow.com/questions/201816/how-to-set-a-long-java-classpath-in-msdos-windows)中建议的解决方案），或者应用报告的错误中的补丁。

[Ivan Sim](https://coderwall.com/ivanhcsim)[在他的 coderwall 上](https://coderwall.com/p/795oma)发布了修补说明，但为了完整起见，我将摘录一段：

> 1.  从上面的[链接下载 bug3271933.4.2hack.zip](https://bugs.eclipse.org/bugs/show_bug.cgi?id=327193)
> 2.  备份现有的 eclipse/plugins/org.eclipse.jdt.launching_3.4.*.jar
> 3.  将补丁中的类复制并粘贴到 org.eclipse.jdt.launching JAR 中的 org/eclipse/jdt/internal/launching（替换现有文件）
> 4.  通过删除从第一个“NAME:”条目开始的所有内容，编辑 org.eclipse.jdt.launching JAR 文件中的 META-INF /MANIFEST.MF 文件。确保在文件末尾留下两 (2) 个换行符。
> 5.  重新启动日食

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-01T09:43:25.963

请确保您的 Mac OS 或 Windows 上的 Sock5 代理已关闭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-06T08:13:59.200

似乎 TestNG 试图通过创建到“localhost”的套接字连接到 JVM 实例，并且在我的 /etc/hosts（我使用 linux）文件中，我将 localhost 重命名为其他名称，因此它被炸毁了。

改回本地主机，一切都很好。

# gis - 获取城市边界框

> ID：13440102
> 
> 赞同：15
> 
> 时间：2012-11-18T12:32:27.037
> 
> 标签：gis

我想知道特定地理坐标与城市列表的距离（“远”表示坐标与城市之间的欧几里德距离，不考虑道路）。为此，我需要为每个位于以色列的城市找到一个边界框。

[这篇文章](https://stackoverflow.com/questions/5187402/working-out-the-bounding-box-of-a-coutnry)讨论了国家边界框，但我在城市级别需要它们。

除了在地图上手动绘制矩形并提取坐标之外，还有什么方法可以获取一长串城市的这些信息？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-09-12T05:02:15.100

[您可以在www.mapdevelopers.com/geocode_bounding_box.php](http://www.mapdevelopers.com/geocode_bounding_box.php)找到这些城市的边界框。进入城市会在地图上显示一个方框，并给出每一边的纬度和经度。希望这将为您提供所需的信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-07-08T23:02:04.383

对于很长的城市列表，请使用[Google 地理编码服务](https://developers.google.com/maps/documentation/javascript/geocoding)。设置完成后，您可以使用任何语言访问 REST API。例如，您可以使用流行的 Python 标准[请求](http://docs.python-requests.org/en/latest/)库。

或者，您可以使用 Google 自己的 Google Maps [Java API](https://github.com/googlemaps/google-maps-services-java/)、[Python API](https://github.com/googlemaps/google-maps-services-python)或[JavaScript API](https://developers.google.com/maps/documentation/javascript/geocoding)。其中任何一个都包含 Google 地理编码服务。

在此处查看 Python 和 Java 库的一些简单示例：[https](https://developers.google.com/maps/documentation/webservices/client-library) ://developers.google.com/maps/documentation/webservices/client-library 。

这是地理编码结果的架构：

```
results[]: {
 types[]: string,
 formatted_address: string,
 address_components[]: {
   short_name: string,
   long_name: string,
   postcode_localities[]: string,
   types[]: string
 },
 partial_match: boolean,
 place_id: string,
 postcode_localities[]: string,
 geometry: {
   location: LatLng,
   location_type: GeocoderLocationType
   viewport: LatLngBounds,
   bounds: LatLngBounds
 }
} 
```

边界框位于`geometry>viewport`变量中，看起来像这样

```
"viewport" : {
           "northeast" : {
              "lat" : 37.4238253802915,
              "lng" : -122.0829009197085
           },
           "southwest" : {
              "lat" : 37.4211274197085,
              "lng" : -122.0855988802915
           }
        } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-06-24T19:41:55.043

[您可以在http://boundingbox.klokantech.com/](http://boundingbox.klokantech.com/)找到这些城市的边界框。 输入城市/国家将在地图上显示一个框，并给出每一边的纬度和经度。但准确性高于[http://www.mapdevelopers.com/geocode_bounding_box.php](http://www.mapdevelopers.com/geocode_bounding_box.php)（感谢@Fred 的回答）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-22T06:38:31.737

我认为，您不需要边界框，而是城市边界。因为使用边界框，您的分析将非常粗糙，并且要获得边界框，您首先需要一个边界。

如果您现在只有城市列表，则需要获取空间数据，即所有城市的边界。要查找此数据，您可以尝试[此链接](https://gis.stackexchange.com/questions/495/are-there-any-free-administrative-boundaries-available-as-shapefiles)。我建议检查 Open Street Maps。然后，您可以使用任何 GIS 软件（例如，开源 Quantum GIS）并在那里计算您的点与城市边界之间的欧几里德距离。

希望这可以帮助。

# php - 在 TinyMCE 中更改语言

> ID：13440113
> 
> 赞同：1
> 
> 时间：2012-11-18T12:35:05.967
> 
> 标签：php, javascript, tinymce

我想将语言“en”更改为“ur”。我从[http://www.tinymce.com/i18n/index.php?ctrl=lang&act=download&pr_id=1](http://www.tinymce.com/i18n/index.php?ctrl=lang&act=download&pr_id=1)下载了语言文件夹，并将其三个文件夹**主题、插件、**语言替换为 tinymce\jscripts\tiny_mce 文件夹。然后我在示例文件夹中更改了 full.html 代码，如下所述：

```
<!DOCTYPE html>
<html>
<head>

<title>آپ سادہ مرکزی خیال</title>
<meta charset="utf-8" />
<!-- TinyMCE -->
<script type="text/javascript" src="../jscripts/tiny_mce/tiny_mce.js"></script>
<script type="text/javascript">
    tinyMCE.init({
        // General options
        language : "ur",
        mode : "textareas",
        theme : "advanced",
        plugins : "advhr,advimage,advlink,emotions,fullpage,media,paste,searchreplace,style,table,template,xhtmlxtras", 
```

除乌尔都语文本外，其他代码相同。

但我的输出没有显示工具栏、文本区域。

请告诉我做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T15:02:12.083

这些步骤可能对您有所帮助：

1.  包括 jQuery 和`jquery.tinymce.js`文件。
2.  为您的控件分配`textarea`属性`class="tinymce"`
3.  在 JavaScript 中：

    ```
    $(function(){
        $("textarea.tinymce").tinymce({
            // Location of TinyMCE script
            script_url : "js/tiny_mce/tiny_mce.js",

            // General options
            theme : "advanced",
            plugins : "safari,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template",

            // Example content CSS (should be your site CSS)
            content_css : "css/style.css",

            // Theme options
            theme_advanced_buttons1 : "save,newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,styleselect,formatselect,fontselect,fontsizeselect",

        });
    }); 
    ```

# c++ - Ubuntu 12.04 中的 CUDA 链接错误

> ID：13440114
> 
> 赞同：4
> 
> 时间：2012-11-18T12:35:24.450
> 
> 标签：c++, linux, ubuntu, cuda, makefile

我一直在到处寻找解决问题的方法：我无法使用 CUDA 运行 .cpp 文件。我认为这是一个模块错误，因为我收到以下错误：

```
g++ -L/usr/local/cuda/lib64 -L~/NVIDIA_GPU_Computing_SDK/shared/lib/linux -L~/NVIDIA_GPU_Computing_SDK/C/common/lib/linux -L~/NVIDIA_GPU_Computing_SDK/C/lib -lcutil -lcudpp -lcuda -lcudart -lcurand -o my_file my_file.o
/usr/bin/ld: cannot find -lcutil
/usr/bin/ld: cannot find -lcudpp 
```

我的生成文件如下所示：

```
EXECUTABLE := my_file
SDKPATH := ~/NVIDIA_GPU_Computing_SDK
CUDAPATH := /usr/local/cuda

LDFLAGS := -L$(CUDAPATH)/lib64 -L$(SDKPATH)/shared/lib/linux -L$(SDKPATH)/C/common/lib/linux -L$(SDKPATH)/C/lib -lcutil -lcudpp -lcuda -lcudart -lcurand
CXFLAGS := -I$(CUDAPATH)/include -I$(SDKPATH)/shared/inc -I$(SDKPATH)/C/common/inc

CXX := g++
NVCC := $(CUDAPATH)/bin/nvcc

$(EXECUTABLE): my_file.o
    $(CXX) $(LDFLAGS) -o $(EXECUTABLE) my_file.o

my_file.o: my_file.cu
    $(NVCC) $(CXFLAGS) -c my_file.cu 
```

当我尝试手动运行文件时，我得到以下输出：

```
/usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crt1.o: In function `_start':
(.text+0x20): undefined reference to `main'
my_file.o: In function `__cudaUnregisterBinaryUtil()':
tmpxft_00000e8f_00000000-1_my_file.cudafe1.cpp:(.text+0xf): undefined reference to `__cudaUnregisterFatBinary'
my_file.o: In function `__sti____cudaRegisterAll_59_tmpxft_00000e8f_00000000_4_my_file_cpp1_ii_71dc03a4()':
tmpxft_00000e8f_00000000-1_my_file.cudafe1.cpp:(.text+0x1f): undefined reference to `__cudaRegisterFatBinary'
collect2: ld returned 1 exit status 
```

当谈到 linux 时，我是一个完全的菜鸟。任何人都可以对这种情况有所了解。

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T12:49:13.797

您在构建的链接阶段遇到了排序问题。因为您指定的库是在需要它们的文件*之前提供的，所以它们会被丢弃。*如果您将 makefile 更改为以下内容：

```
LDFLAGS := -L$(CUDAPATH)/lib64 -L$(SDKPATH)/shared/lib/linux -L$(SDKPATH)/C/common/lib/linux
LIBS := -lcutil -lcudpp -lcuda -lcudart -lcurand

....

$(EXECUTABLE): my_file.o
    $(CXX) $(LDFLAGS) -o $(EXECUTABLE) my_file.o $(LIBS) 
```

你应该会发现问题消失了。

# c - 删除填充数据

> ID：13440118
> 
> 赞同：0
> 
> 时间：2012-11-18T12:36:11.810
> 
> 标签：c, padding

我有 a`char nom[100];`但是当 a`nom`的大小小于 100 时，我必须使用填充。我使用字符'。继续。但是当我读取数据时，我看到例如`a.txt..............................................................................................`

我该怎么做才能删除填充的“。” 在 C 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T12:38:34.147

您可以初始化您的 char *nom，如下所示：

```
char nom[100] = {'\0'}; 
```

或者在您希望字符串“nom”具有的长度之后插入一个 '\0'，如下所示：

```
nom[5] = '\0' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T12:42:44.710

你想在结尾处修剪字符串：

```
int i
int paddedLength=strlen(str);
int realLength = paddedLength;
char padChar = '.';

for(i=paddedLength-1; i>=0; i--) {
    if(str[i]!=padChar)
        break;
    realLength--;
}
str[realLength+1] = '\0'; 
```

*   内联输入，不保证但一般方法有效

# sql - Sql Server 选择不同的记录和 OrderBy NEWID()

> ID：13440121
> 
> 赞同：1
> 
> 时间：2012-11-18T12:36:34.127
> 
> 标签：sql, sql-server

这是存储过程，我需要选择 Distinct Records 并以随机顺序显示它们，但我面临一个错误，即选择 Distinct 不能与 newid() 一起使用，那么我该如何解决这个问题？

```
USE [OtlobODR]
GO
/****** Object:  StoredProcedure [OtlobFood].[ListOffersItems]    Script Date: 11/18/2012 13:01:34 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER procedure [OtlobFood].[ListOffersItems] 
@Fk_CampaignID int
as
select distinct
    CampaignID, CampaignOffers.OldPrice 
    ,   dbo.ItemSizes.IS_Id,
    , dbo.Items.[Item_Description_L2] as Item_Description 
    , dbo.Items.[Item_Image]
    , dbo.Items.[Item_Details]
    , dbo.ItemSizes.[IS_Price] as Price
    -- if null then it is not a featured meal
    , dbo.ProviderItems.[PI_Id] as ProviderItems_PI_ID
    , dbo.ItemCategories.[ItemCat_Id]
    , dbo.Providers.Provider_Name_L2 as Provider_Name
    , dbo.Providers.Provider_Menu_Logo
    , dbo.Providers.Provider_Id
FROM Items  
INNER JOIN ProviderItems ON Items.Item_Id = ProviderItems.Item_Id 
INNER JOIN dbo.ItemSizes ON dbo.Items.Item_Id = dbo.ItemSizes.Item_Id
INNER JOIN CampaignOffers ON CampaignOffers.ItemID = ItemSizes.IS_Id
INNER JOIN dbo.ItemCategories ON dbo.Items.ItemCat_Id = dbo.ItemCategories.ItemCat_Id
INNER JOIN dbo.Providers ON dbo.ProviderItems.Provider_Id = dbo.Providers.Provider_Id 
INNER JOIN dbo.Branches  ON dbo.Providers.Provider_Id = dbo.Branches.Provider_Id 
where Fk_CampaignID=@Fk_CampaignID 
group by  NEWID(),      
    CampaignID, CampaignOffers.OldPrice ,
    dbo.ItemSizes.IS_Id,
    dbo.Items.[Item_Description_L2],
    dbo.Items.[Item_Image], 
    dbo.Items.[Item_Details],
    dbo.ItemSizes.IS_Id,
    dbo.ItemSizes.[IS_Price] ,
    -- if null then it is not a featured meal
    dbo.ProviderItems.[PI_Id] , 
    dbo.ItemCategories.[ItemCat_Id],
      dbo.Providers.Provider_Name_L2,
    dbo.Providers.Provider_Menu_Logo
    ,dbo.Branches.Branch_Id,
    dbo.Providers.Provider_Id,CampaignID,CampaignOffers.OldPrice 
order by NEWID() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T12:59:14.637

从查询中删除 NEWID() 并用

```
SELECT * FROM (
   <your query>
) as t
ORDER BY NEWID() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T12:49:40.017

您需要将 SELECT DISTINCT 推送到内部查询中（此时您也可能会丢失 GROUP BY），然后在外部查询中执行 NEWID()。一般形式是

```
select
    newid(), X.*
from
    (
    select distinct <cols>
    from <tables>
    where <whatever>
    ) X
order by 1 
```

在你的情况下，我认为这就是你想要的：

```
select
    newid(), X.*
from
    (
    select distinct
        CampaignID, CampaignOffers.OldPrice ,
        dbo.ItemSizes.IS_Id,
        dbo.Items.[Item_Description_L2] as Item_Description ,
        dbo.Items.[Item_Image], 
        dbo.Items.[Item_Details],
        dbo.ItemSizes.[IS_Price] as Price,
        -- if null then it is not a featured meal
        dbo.ProviderItems.[PI_Id] as ProviderItems_PI_ID, 
        dbo.ItemCategories.[ItemCat_Id],
        dbo.Providers.Provider_Name_L2 as Provider_Name,
        dbo.Providers.Provider_Menu_Logo,
        dbo.Providers.Provider_Id
    FROM
        Items
        INNER JOIN ProviderItems ON Items.Item_Id = ProviderItems.Item_Id 
        INNER JOIN dbo.ItemSizes ON dbo.Items.Item_Id = dbo.ItemSizes.Item_Id
        inner join CampaignOffers ON CampaignOffers.ItemID = ItemSizes.IS_Id
        INNER JOIN dbo.ItemCategories ON dbo.Items.ItemCat_Id = dbo.ItemCategories.ItemCat_Id
        INNER JOIN dbo.Providers ON dbo.ProviderItems.Provider_Id = dbo.Providers.Provider_Id 
        INNER JOIN dbo.Branches ON dbo.Providers.Provider_Id = dbo.Branches.Provider_Id 
    where
        Fk_CampaignID = @Fk_CampaignID 
    ) X
order by 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T12:48:42.380

这个查询没有多大意义，没有聚合，那么group by语句的目的是什么？并且按 NEWID() 进行分组无论如何都不会给您带来任何分组。

将多余的 group by 与 distinct 子句结合起来，感觉更像是您有一个不正确的连接条件导致笛卡尔，并且您拼命尝试使用 distinct 和 group by 来消除该笛卡尔，拥有它们当然没有什么意义在声明中，以及 group by 中的 newid 都应该被删除。

# ruby-on-rails - 使用 rspec 测试关联：类别没有 post_id 外键

> ID：13440122
> 
> 赞同：2
> 
> 时间：2012-11-18T12:36:41.080
> 
> 标签：ruby-on-rails

我正在尝试测试与 RSpec 的一些关联，但我遇到了这些失败：

```
Category 
   Failure/Error: it {should belong_to :post}
   Expected Category to have a belongs_to association called post (Category does not have  a post_id foreign key.)
 # ./spec/models/category_spec.rb:7:in `block (2 levels) in <top (required)>'

Post 
 Failure/Error: it {should have_one (:category)}
   Expected Post to have a has_one association called category (Category does not have a post_id foreign key.)
 # ./spec/models/post_spec.rb:8:in `block (2 levels) in <top (required)>' 
```

这是我的模型：

```
class Post < ActiveRecord::Base
  has_one :category
  validates_presence_of :author, :category, :post
end

class Category < ActiveRecord::Base
  belongs_to :post
  validates_presence_of :name
end 
```

和我的测试：

```
require 'spec_helper'

describe Post do
  it {should validate_presence_of(:author)}
  it {should validate_presence_of(:post)}
  it {should validate_presence_of(:cathegory)}
  it {should have_one (:category)}  
end

describe Category do
  it {should validate_presence_of :name}
  it {should belong_to :post}
end 
```

和我的计划

```
 ActiveRecord::Schema.define(:version => 20121118131441) do

   create_table "categories", :force => true do |t|
     t.string   "name"
     t.datetime "created_at", :null => false
     t.datetime "updated_at", :null => false
     t.integer  "post_id"
   end

   create_table "posts", :force => true do |t|
     t.string   "author"
     t.string   "cathegory"
     t.text     "post"
     t.datetime "created_at",  :null => false
     t.datetime "updated_at",  :null => false
     t.integer  "category_id"
   end

end 
```

有人知道发生了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T13:06:53.507

在没有看到您的架构的情况下，您的数据库表似乎缺少外键列。创建添加以下内容的迁移应该可以修复它：

```
add_column :categories, :post_id
add_column :posts, :category_id 
```

*更新*

正如我在下面的评论中所说，还要确保您运行`rake db:test:prepare`以确保您的测试数据库具有最新的模式。

# jquery - 如何让用户登录离线网络应用程序？

> ID：13440131
> 
> 赞同：10
> 
> 时间：2012-11-18T12:37:40.743
> 
> 标签：jquery, html, web-applications, local-storage, web-sql

我正在构建一个针对 iPhone 和其他移动设备的离线网络应用程序。有什么方法可以使用 WebSql 本地存储保存用户身份验证？

因此，当您在离线时打开 Web 应用程序时，我希望要么用户已经登录，要么用户应该能够登录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T14:49:15.927

我不知道如何存储或使用客户端状态数据（[iOS 中的钥匙串](https://developer.apple.com/library/mac/#documentation/security/Conceptual/keychainServConcepts/iPhoneTasks/iPhoneTasks.html)也在[Android](http://developer.android.com/reference/android/security/KeyChain.html)中），但对于 Web 应用程序而言，您无需执行任何操作。您不必做任何事情，因为如果可以的话，它是不安全的。登录后，服务器将设置仅存在几天或几周的[HTTP cookie 。](http://en.wikipedia.org/wiki/HTTP_cookie#HttpOnly_cookie)在这段时间内，向服务器发出[的带有凭据](https://developer.mozilla.org/en/docs/HTTP_access_control#Requests_with_credentials)的请求始终由浏览器进行身份验证。您可以从服务器请求登录电子邮件或其他任何内容。出于额外的安全目的，服务器可能会请求[XSRF 令牌](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#General_Recommendation%3a_Synchronizer_Token_Pattern)。在这种情况下，将其保存在 localStorage 中。失去这个令牌意味着什么。

这是最安全的方式，移动客户端也使用它，包括通过 WebView 进行的网上银行。使用浏览器进行身份验证是最安全和最简单的，因为存在很多弱点，例如凭据存储、检查正确的 ssl 证书、加密等。使用 webview，一切都由浏览器处理。

如果您对这些服务器代码的内容感兴趣，我对[Appengine 跨域身份验证服务器代码进行](http://dev.yathit.com/auth/gae-login-server.html)了解释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T13:18:03.443

如果我正确理解了这个问题，那么您可以这样做：

登录时（在线）：

*   针对服务器进行身份验证，如果正确，将用户名和散列密码（例如使用[Crypto JS](http://code.google.com/p/crypto-js/#SHA-2)）存储在 WebSql 数据库中。
*   如果该帐户已经存在于本地数据库中，无论如何都要生成一个新的哈希值，以防用户自上次登录后更改了密码。

登录（离线）时：

*   针对本地数据库进行身份验证。

当然，这将要求用户在本地登录之前至少使用在线版本登录一次。例如，当有人在断开连接的情况下尝试登录其 Microsoft 帐户时，Windows 8 就是这样做的。

# c# - Windows Phone 8：如何为页面导航设置动画？

> ID：13440133
> 
> 赞同：21
> 
> 时间：2012-11-18T12:37:53.510
> 
> 标签：c#, windows-phone, windows-phone-8

我是 Win Phone 8 开发的新手，经过令人厌烦的谷歌搜索，我在这里发布了这个简单的问题：

如何动画页面导航？

是的，我知道如何从一个页面导航到另一个页面：

```
NavigationService.Navigate(new Uri("/AnotherPage.xaml", UriKind.Relative)); 
```

但这种导航是即时的，不包括任何类型的过渡。请帮助！

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-11-18T14:00:13.327

使用 Nuget 安装 Windows Phone 工具包：[https](https://nuget.org/packages/WPtoolkit) ://nuget.org/packages/WPtoolkit 。

在 app.xaml.cs 中：

> RootFrame = new TransitionFrame();

然后，在您的页面 XAML 中：

> xmlns:toolkit="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls.Toolkit"

和

```
<toolkit:TransitionService.NavigationInTransition>
    <toolkit:NavigationInTransition>
        <toolkit:NavigationInTransition.Backward>
            <toolkit:TurnstileTransition Mode="BackwardIn" />
        </toolkit:NavigationInTransition.Backward>
        <toolkit:NavigationInTransition.Forward>
            <toolkit:TurnstileTransition Mode="ForwardIn" />
        </toolkit:NavigationInTransition.Forward>
    </toolkit:NavigationInTransition>
</toolkit:TransitionService.NavigationInTransition>
<toolkit:TransitionService.NavigationOutTransition>
    <toolkit:NavigationOutTransition>
        <toolkit:NavigationOutTransition.Backward>
            <toolkit:TurnstileTransition Mode="BackwardOut" />
        </toolkit:NavigationOutTransition.Backward>
        <toolkit:NavigationOutTransition.Forward>
            <toolkit:TurnstileTransition Mode="ForwardOut" />
        </toolkit:NavigationOutTransition.Forward>
    </toolkit:NavigationOutTransition>
</toolkit:TransitionService.NavigationOutTransition> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-18T13:01:51.250

您可以使用工具包中的导航转换。 [http://phone.codeplex.com/](http://phone.codeplex.com/)

# java - tomcat7 vs. tomcat6，它们的性能有什么显着差异吗？

> ID：13440137
> 
> 赞同：9
> 
> 时间：2012-11-18T12:38:19.143
> 
> 标签：java, performance, tomcat6, tomcat7, stress-testing

我一直在对 Java Web 应用程序（JSP+Tomcat6+Struts2+Hibernate+mysql）进行压力测试，而且我得到的结果并不值得吹嘘！于是我把tomcat版本升级到了7，哇！我得到的请求/秒比以前好 5 倍。

所以请赐教，tomcat6和tomcat7的性能有这么大的区别吗？还是我的配置和东西有问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-18T14:04:05.493

Tomcat [“哪个版本”](http://tomcat.apache.org/whichversion.html)页面包含对不同 Tomcat 版本之间差异的高级概述。Tomcat 7.x 的部分并未声称 Tomcat 7.x 与 Tomcat 6.x 相比性能大幅提升。谷歌搜索也没有提供任何明确的证据。

我倾向于认为 5 倍的吞吐量提高是：

*   Java / Tomcat 配置和/或调优问题，
*   您的 Web 应用程序有点不寻常，或者
*   您进行性能测量的方式的未知人工制品。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-02-15T03:59:01.353

Tomcat 7.0 和 Tomcat 6.0 有什么区别？

*   由于一些安全代码修复和添加（例如 CSRF 预防过滤器），Tomcat 7.0 比 Tomcat 6.0 提高了安全性。

*   Tomcat 7.0 包含 Servlet 3.0 API，它本身就是对之前版本（由 Tomcat 6.0 使用）的改进版本。

*   因此，Tomcat 7.0 支持需要 Servlet 3 容器的第 3 方应用程序。

*   Tomcat 7.0 中的可配置性更好，它包括新的容器组件（例如 ExpiresFilter 和 AddDefaultCharsetFilter），可以更好地处理以前留给 Web 应用程序解决的问题。

*   Tomcat 7.0 支持 Java 6 或更高版本，而 Tomcat 6.0 支持 Java 5 或更高版本。

*   最后，Tomcat 7.0 包括在所需位置使用泛型的更简洁和现代化的代码。

# core-animation - 如何强制 CALayer 以更高分辨率重绘？

> ID：13440139
> 
> 赞同：0
> 
> 时间：2012-11-18T12:38:24.423
> 
> 标签：core-animation, calayer

![两个 CALayers](../Images/e389230d2e9e9426bb2a998f96ad3651.png)

我有两个 CALayer 子类的实例。

它们之间的唯一区别是这一行：

```
[self setTransform:CATransform3DMakeScale(2, 2, 2)]; 
```

我还需要什么才能使大图层在 2x 的比例下看起来不错？

PS：（为避免混淆）这些图层还包括一些控制按钮、阴影和圆角，以模仿窗口系统中窗口的外观，但这些不是 NSWindows 实例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T15:09:12.887

简短的回答是，不要使用转换。变换通过放大图层来缩放图层，而无需重新渲染。

通过使用 CAShapeLayer 并对路径进行动画更改，您可以获得非常相似的效果。但是，这会给您带来清晰的渲染，因为它的路径动画确实会重新渲染像素。

我说“类似”效果是因为 CAShapeLayers 对整个图层使用 lineWidth 属性。您可以为值之间的线宽设置动画，并使用小数值，但您必须进行一些微调以使线宽与形状大小成比例地上下动画。另一个考虑是图形系统使用抗锯齿来绘制小数宽度路径，因此当线宽不是整数值时，它们看起来会略微柔和。您可以关闭抗锯齿，但它们看起来会非常锯齿。

# android - Android ListView 在创建时设置行颜色

> ID：13440142
> 
> 赞同：2
> 
> 时间：2012-11-18T12:38:37.743
> 
> 标签：android, listview, colors, background, row

我试图在我的列表视图中为各个行设置背景颜色，我在运行时从我的数据库中检索颜色的信息，我在试图弄清楚如何做到这一点时遇到了一些问题。

当我尝试访问 onCreate 中的列表视图以便更改颜色时，我不断收到错误消息。谁能想到解决方案？

提前致谢。

```
 @Override
        protected void onCreate(Bundle savedInstanceState) {
            // TODO Auto-generated method stub
            super.onCreate(savedInstanceState);
            requestWindowFeature(Window.FEATURE_NO_TITLE);
            setContentView(R.layout.item_list);

        // Read var from Intent
        Intent intent= getIntent();
        final String ListID = intent.getStringExtra("ListID");
        golbalItemID = ListID;

        ivAdd = (ImageView) findViewById(R.id.ivAdd);
        ivCancel = (ImageView) findViewById(R.id.ivCancel);
        tvTotItems = (TextView) findViewById(R.id.tvTotItems);

        final myDBClass myDb = new myDBClass(this);
        final ArrayList<HashMap<String, String>> MebmerList = myDb.SelectAllItemData(ListID);       

        myData =  myDb.SelectItemData(Integer.parseInt(ListID.toString())); 

        // listView1
        final ListView lisView1 = (ListView)findViewById(R.id.listView1); 

        registerForContextMenu(lisView1);

        SimpleAdapter sAdap;
        sAdap = new SimpleAdapter(ListItems.this, MebmerList, R.layout.activity_column,
                new String[] {"Name", "Price", "Quan"}, new int[] {R.id.ColName, R.id.ColTel, R.id.ColQuan});      
        lisView1.setAdapter(sAdap); 

        lisView1.setOnItemClickListener(new OnItemClickListener() {
              public void onItemClick(AdapterView<?> myAdapter, View myView, int position, long mylng) {
                  int iChk = 0;
                // Show Data
                String arrData[] = myDb.SelectItemData((MebmerList.get(position).get("ItemID").toString()));
                if(arrData != null)
                {
                    iChk = Integer.parseInt(arrData[4]);    
                }

                if(iChk == 1)
                {
                    ischkCheck(Integer.parseInt(MebmerList.get(position).get("ItemID").toString()), 0);
                    change_color(lisView1, position, 255, 255, 255);

                    System.out.println("POSITION!ichk=1" + myAdapter.getItemAtPosition(position).toString());
                    setTitle(myAdapter.getItemAtPosition(position).toString());
                }

                else if(iChk == 0)
                {
                    ischkCheck(Integer.parseInt(MebmerList.get(position).get("ItemID").toString()), 1);
                    change_color(lisView1, position, 155, 155, 138);

                    System.out.println("POSITION!ichk=0" + myAdapter.getItemAtPosition(position).toString());
                }

              }});

        ivAdd.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                Intent newActivity = new Intent(ListItems.this,AddItem.class);
                newActivity.putExtra("ListID", ListID);
                startActivity(newActivity);
                finish();
            }
        });

        ivCancel.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                Intent newActivity = new Intent(ListItems.this,MenuScreen.class);
                startActivity(newActivity); 
                finish();
            }
        }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T12:44:26.173

如果最有可能使用自己的适配器更简单，覆盖`getView();`方法（您可以简单地调用`super.getView();`然后在返回视图之前设置自己的背景颜色。

```
public class MyAdapter extends SimpleAdapter {

  @Override
  View getView(int position, View convertView, ViewGroup parent) {

      View view = super.getView( position, convertView, parent );
      view.setBackgroundColor( 0xff00ff00 );

      return view;
  }
} 
```

应该让你的行变绿。

# python - 在字典中使用拆分？

> ID：13440145
> 
> 赞同：0
> 
> 时间：2012-11-18T12:39:20.873
> 
> 标签：python

我怎么去：

```
{' electronic equipment, petroleum, natural gas, wood, wood products, palm oil, rubber, textiles, chemicals'} 
```

至

```
{'electronic equipment', 'petroleum', 'natural gas', 'wood', 'wood products', 'palm oil', 'rubber', 'textiles', 'chemicals'} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:16:33.700

第一项是**`set`**由单个字符串而不是字典组成。你可以像这样清理它：

```
s = {' electronic equipment, petroleum, natural gas, wood, wood products, palm oil, rubber, textiles, chemicals'}
s = set( x.strip() for x in s.pop().split(',') ) 
```

结果将是另一个`set`具有多个字符串成员的：

```
{'rubber', 'natural gas', 'petroleum', 'electronic equipment', 'wood products', 'chemicals', 'wood', 'palm oil', 'textiles'} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T12:43:39.647

那不是字典，是集合。可能你应该使用一个字符串：

```
In [16]: strs=' electronic equipment, petroleum, natural gas, wood, wood products, palm oil, rubber, textiles, chemicals'

In [17]: strs.split(",")
Out[17]: 
[' electronic equipment',
 ' petroleum',
 ' natural gas',
 ' wood',
 ' wood products',
 ' palm oil',
 ' rubber',
 ' textiles',
 ' chemicals'] 
```

或者如果你只想在那个集合上工作，那么试试这样的东西。但是您可能无法通过这种方式获得订购的商品：

```
In [25]: s={' electronic equipment, petroleum, natural gas, wood, wood products, palm oil, rubber, textiles, chemicals'}

In [26]: {y for x in s for y in x.split(",")}
Out[26]: 
set([' natural gas',
     ' chemicals',
     ' petroleum',
     ' rubber',
     ' wood',
     ' wood products',
     ' palm oil',
     ' electronic equipment',
     ' textiles']) 
```

或@Jon Clements 建议您可以尝试以下操作：

```
In [43]: next(iter(s)).split(",")
Out[43]: 
[' electronic equipment',
 ' petroleum',
 ' natural gas',
 ' wood',
 ' wood products',
 ' palm oil',
 ' rubber',
 ' textiles',
 ' chemicals'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T12:49:43.930

你可以试试这个：

```
>>> s = {'hello,world'}
>>> set(s.pop().split(','))
set(['world', 'hello']) 
```

但是您可能已经注意到它不会被排序（不能保证顺序）。

# objective-c - NSTextField - 如何更改文本/编辑区域的大小和位置？

> ID：13440146
> 
> 赞同：3
> 
> 时间：2012-11-18T12:39:32.787
> 
> 标签：objective-c, macos, cocoa, appkit

好吧，我得到了这个：[http ://d.pr/i/jItM](http://d.pr/i/jItM)

我显然想将文本向下移动并远离左边缘。我有 NSTextField 的子类，我在其中绘制背景，但我无法找到这个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T14:15:53.360

知道了。两者都需要被覆盖。

```
- (void)editWithFrame:(NSRect)aRect inView:(NSView *)controlView editor:(NSText *)textObj delegate:(id)anObject event:(NSEvent *)theEvent
{
    aRect.origin.y += 9;
    aRect.origin.x += 10;
    [super editWithFrame:aRect inView:controlView editor:textObj delegate:anObject event:theEvent];
}

- (void)selectWithFrame:(NSRect)aRect inView:(NSView *)controlView editor:(NSText *)textObj delegate:(id)anObject start:(NSInteger)selStart length:(NSInteger)selLength
{
    aRect.origin.y += 9;
    aRect.origin.x += 10;
    [super selectWithFrame:aRect inView:controlView editor:textObj delegate:anObject start:selStart length:selLength];
} 
```

# mysql - OSX 10.8.2 上 Python 2.7 的 MySQLdb 和两者都是 64 位

> ID：13440147
> 
> 赞同：12
> 
> 时间：2012-11-18T12:39:33.583
> 
> 标签：mysql, mysql-python

这是我的问题：我无法让 MySQLdb 让 python 工作。大多数与此相关的其他帖子都引用了 MySQL/Python 的不同架构。我查了一下，都是64位的。我有 Python 2.7.2（标准 OS X）和最新的 MySQL OS X 10.8.2。

**我原来的错误日志：**

尝试导入 MySQL db 给了我这个错误：

```
 Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/Library/Python/2.7/site-packages/MySQL_python-1.2.4b4-py2.7-macosx-10.8-intel.egg/MySQLdb/__init__.py", line 19, in <module>
    import _mysql
ImportError: dlopen(/Library/Python/2.7/site-packages/MySQL_python-1.2.4b4-py2.7-macosx-10.8-intel.egg/_mysql.so, 2): Library not loaded: libmysqlclient.18.dylib
  Referenced from: /Library/Python/2.7/site-packages/MySQL_python-1.2.4b4-py2.7-macosx-10.8-intel.egg/_mysql.so
  Reason: image not found 
```

这可能也有帮助，我安装 mysql-python 1.2.4b4 时的控制台输出

```
xxx-MBP:MySQL-python-1.2.4b4 me$ sudo python setup.py clean
running clean
removing 'build/temp.macosx-10.8-intel-2.7' (and everything under it)
xxx-MBP:MySQL-python-1.2.4b4 me$ sudo python setup.py install
running install
running bdist_egg
running egg_info
writing MySQL_python.egg-info/PKG-INFO
writing top-level names to MySQL_python.egg-info/top_level.txt
writing dependency_links to MySQL_python.egg-info/dependency_links.txt
writing MySQL_python.egg-info/PKG-INFO
writing top-level names to MySQL_python.egg-info/top_level.txt
writing dependency_links to MySQL_python.egg-info/dependency_links.txt
reading manifest file 'MySQL_python.egg-info/SOURCES.txt'
reading manifest template 'MANIFEST.in'
writing manifest file 'MySQL_python.egg-info/SOURCES.txt'
installing library code to build/bdist.macosx-10.8-intel/egg
running install_lib
running build_py
copying MySQLdb/release.py -> build/lib.macosx-10.8-intel-2.7/MySQLdb
running build_ext
creating build/bdist.macosx-10.8-intel/egg
copying build/lib.macosx-10.8-intel-2.7/_mysql.so -> build/bdist.macosx-10.8-intel/egg
copying build/lib.macosx-10.8-intel-2.7/_mysql_exceptions.py -> build/bdist.macosx-10.8-intel/egg
creating build/bdist.macosx-10.8-intel/egg/MySQLdb
copying build/lib.macosx-10.8-intel-2.7/MySQLdb/__init__.py -> build/bdist.macosx-10.8-intel/egg/MySQLdb
copying build/lib.macosx-10.8-intel-2.7/MySQLdb/connections.py -> build/bdist.macosx-10.8-intel/egg/MySQLdb
creating build/bdist.macosx-10.8-intel/egg/MySQLdb/constants
copying build/lib.macosx-10.8-intel-2.7/MySQLdb/constants/__init__.py -> build/bdist.macosx-10.8-intel/egg/MySQLdb/constants
copying build/lib.macosx-10.8-intel-2.7/MySQLdb/constants/CLIENT.py -> build/bdist.macosx-10.8-intel/egg/MySQLdb/constants
copying build/lib.macosx-10.8-intel-2.7/MySQLdb/constants/CR.py -> build/bdist.macosx-10.8-intel/egg/MySQLdb/constants
copying build/lib.macosx-10.8-intel-2.7/MySQLdb/constants/ER.py -> build/bdist.macosx-10.8-intel/egg/MySQLdb/constants
copying build/lib.macosx-10.8-intel-2.7/MySQLdb/constants/FIELD_TYPE.py -> build/bdist.macosx-10.8-intel/egg/MySQLdb/constants
copying build/lib.macosx-10.8-intel-2.7/MySQLdb/constants/FLAG.py -> build/bdist.macosx-10.8-intel/egg/MySQLdb/constants
copying build/lib.macosx-10.8-intel-2.7/MySQLdb/constants/REFRESH.py -> build/bdist.macosx-10.8-intel/egg/MySQLdb/constants
copying build/lib.macosx-10.8-intel-2.7/MySQLdb/converters.py -> build/bdist.macosx-10.8-intel/egg/MySQLdb
copying build/lib.macosx-10.8-intel-2.7/MySQLdb/cursors.py -> build/bdist.macosx-10.8-intel/egg/MySQLdb
copying build/lib.macosx-10.8-intel-2.7/MySQLdb/release.py -> build/bdist.macosx-10.8-intel/egg/MySQLdb
copying build/lib.macosx-10.8-intel-2.7/MySQLdb/times.py -> build/bdist.macosx-10.8-intel/egg/MySQLdb
byte-compiling build/bdist.macosx-10.8-intel/egg/_mysql_exceptions.py to _mysql_exceptions.pyc
byte-compiling build/bdist.macosx-10.8-intel/egg/MySQLdb/__init__.py to __init__.pyc
byte-compiling build/bdist.macosx-10.8-intel/egg/MySQLdb/connections.py to connections.pyc
byte-compiling build/bdist.macosx-10.8-intel/egg/MySQLdb/constants/__init__.py to __init__.pyc
byte-compiling build/bdist.macosx-10.8-intel/egg/MySQLdb/constants/CLIENT.py to CLIENT.pyc
byte-compiling build/bdist.macosx-10.8-intel/egg/MySQLdb/constants/CR.py to CR.pyc
byte-compiling build/bdist.macosx-10.8-intel/egg/MySQLdb/constants/ER.py to ER.pyc
byte-compiling build/bdist.macosx-10.8-intel/egg/MySQLdb/constants/FIELD_TYPE.py to FIELD_TYPE.pyc
byte-compiling build/bdist.macosx-10.8-intel/egg/MySQLdb/constants/FLAG.py to FLAG.pyc
byte-compiling build/bdist.macosx-10.8-intel/egg/MySQLdb/constants/REFRESH.py to REFRESH.pyc
byte-compiling build/bdist.macosx-10.8-intel/egg/MySQLdb/converters.py to converters.pyc
byte-compiling build/bdist.macosx-10.8-intel/egg/MySQLdb/cursors.py to cursors.pyc
byte-compiling build/bdist.macosx-10.8-intel/egg/MySQLdb/release.py to release.pyc
byte-compiling build/bdist.macosx-10.8-intel/egg/MySQLdb/times.py to times.pyc
creating stub loader for _mysql.so
byte-compiling build/bdist.macosx-10.8-intel/egg/_mysql.py to _mysql.pyc
creating build/bdist.macosx-10.8-intel/egg/EGG-INFO
copying MySQL_python.egg-info/PKG-INFO -> build/bdist.macosx-10.8-intel/egg/EGG-INFO
copying MySQL_python.egg-info/SOURCES.txt -> build/bdist.macosx-10.8-intel/egg/EGG-INFO
copying MySQL_python.egg-info/dependency_links.txt -> build/bdist.macosx-10.8-intel/egg/EGG-INFO
copying MySQL_python.egg-info/top_level.txt -> build/bdist.macosx-10.8-intel/egg/EGG-INFO
writing build/bdist.macosx-10.8-intel/egg/EGG-INFO/native_libs.txt
zip_safe flag not set; analyzing archive contents...
creating 'dist/MySQL_python-1.2.4b4-py2.7-macosx-10.8-intel.egg' and adding 'build/bdist.macosx-10.8-intel/egg' to it
removing 'build/bdist.macosx-10.8-intel/egg' (and everything under it)
Processing MySQL_python-1.2.4b4-py2.7-macosx-10.8-intel.egg
removing '/Library/Python/2.7/site-packages/MySQL_python-1.2.4b4-py2.7-macosx-10.8-intel.egg' (and everything under it)
creating /Library/Python/2.7/site-packages/MySQL_python-1.2.4b4-py2.7-macosx-10.8-intel.egg
Extracting MySQL_python-1.2.4b4-py2.7-macosx-10.8-intel.egg to /Library/Python/2.7/site-packages
MySQL-python 1.2.4b4 is already the active version in easy-install.pth

Installed /Library/Python/2.7/site-packages/MySQL_python-1.2.4b4-py2.7-macosx-10.8-intel.egg
Processing dependencies for MySQL-python==1.2.4b4
Finished processing dependencies for MySQL-python==1.2.4b4 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-15T14:43:37.140

我想我明白了！这就是我所做的。

好的，这非常令人沮丧。

最终使它起作用的是在终端中执行此操作：

```
sudo ln -s /usr/local/mysql/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib 
```

但在那之前还有很多其他的东西。我混合了来自两个来源的方向：

[如何在 Mac OS X 上安装 MySQLdb（MySQL 的 Python 数据访问库）？](https://stackoverflow.com/questions/1448429/how-to-install-mysqldb-python-data-access-library-to-mysql-on-mac-os-x) 和 [http://birdhouse.org/blog/2009/02/21/python-mysql-connections-on-mac-os/](http://birdhouse.org/blog/2009/02/21/python-mysql-connections-on-mac-os/)

我使用第一个清理 python 并更改构建文件……我使用第二个添加 64 位标志来安装和构建……</p>

然后我[在 Mac OSx 10.8.1 上的 Error importing MySQLdb in Python 2.7.2 中](https://stackoverflow.com/questions/12327737/error-importing-mysqldb-in-python-2-7-2-on-mac-osx-10-8-1)使用了一个答案 （这是使它工作的最后一件事。）

让我越过边缘。

我不确定究竟是什么有所作为，因为我做了很多事情。我从 2.7 python 文件夹中删除了一堆东西……以及其他东西。但我唯一可以确定的是，混合来自这两个来源的方向会产生影响。感谢所有的帮助，伙计们……哈哈，我希望这能让人头疼。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-26T06:14:37.057

我列出了我面临的 4 个配置障碍，我已经列出了它们。

export CFLAGS=-Qunused-arguments export CPPFLAGS=-Qunused-arguments 从 xcode 首选项/下载 sudo ln -s /usr/local/mysql/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18 安装命令行工具。 dylib

# java - PriorityQueue.poll() 调用 compareTo()？

> ID：13440148
> 
> 赞同：1
> 
> 时间：2012-11-18T12:39:41.310
> 
> 标签：java, priority-queue

我正在`PriorityQueue`我的程序中实现一个。为此，我也实施了`compareTo()`. 当`compareTo()`我执行时，正在调用`add()`，这是预期的。但是当我执行时也会调用它`poll()`。
我认为**poll()**的功能只是去除头部。为什么需要调用**compareTo()**？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T12:45:56.387

优先级队列的实现方式通常是通过堆来完成的。部分`poll()ing`需要重组堆，这需要堆来比较元素......因此`compareTo()`。这只是一个猜测（即我没有深入研究源代码来验证我的说法）。

如果您有兴趣，可以快速搜索如何使用堆实现优先级队列：http: [//pages.cs.wisc.edu/~vernon/cs367/notes/11.PRIORITY-Q.html#imp](http://pages.cs.wisc.edu/~vernon/cs367/notes/11.PRIORITY-Q.html#imp)

实际上只是为了好玩，我会以一种不严谨的方式描述它是如何工作的。堆是满足*堆属性*的树：父母总是小于或等于他们的孩子（最小堆）或父母总是至少和他们的孩子一样大（最大堆）。`PriorityQueue`是一个minheap所以`poll()`删除根（确保您理解这一点）。但是如果你去掉根，树会发生什么？它不再是一棵树......所以他们解决这个问题的方法是将树的根移动到一个叶子节点（可以在不破坏树/使堆属性无效的情况下拔出它），并将其他一些节点放入根。但是您将哪个节点放入根目录？直觉上你可能会认为他们会放置根的左子或右子（那些“几乎和原始根一样小”）。你可以这样做，但是你需要修复以那个孩子为根的子树（而且代码很丑）。相反，它们（从概念上）做同样的事情，但做起来略有不同，以使代码更好。尤其是，他们采摘叶节点并将其粘贴在根中（通常您交换根和叶节点以同时执行这两个步骤）。但是，那*不再必须满足*堆属性（我们卡在根中的叶节点可能非常大！）。*为了解决这个问题，你“冒泡”新的根，直到你把它放到正确的位置。具体来说，您将新根与左右子节点进行比较，并不断交换（如果父节点大于至少一个子节点），直到满足堆属性。请注意，这种交换确实会导致有效的堆（您可以证明这一点，但它很直观）。*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T12:45:43.570

一切都在[JavaDoc](http://docs.oracle.com/javase/7/docs/api/java/util/PriorityQueue.html)中（重点是我的）：

> 基于**优先级堆**的无界优先级队列。

在你的[源代码中`poll()`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/util/PriorityQueue.java#PriorityQueue.poll%28%29)你会发现：

```
public E poll() {
    //...
    if (s != 0)
        siftDown(0, x);
    return result;
} 
```

在哪里`siftDown()`：

```
/**
 * Inserts item x at position k, maintaining heap invariant by
 * demoting x down the tree repeatedly until it is less than or
 * equal to its children or is a leaf.
 * [...]
 */
private void siftDown(int k, E x) {
    if (comparator != null)
        siftDownUsingComparator(k, x);
    else
        siftDownComparable(k, x);
} 
```

JavaDoc 上的注释`siftDown()`至关重要，请仔细阅读。基本上，底层的实现`PriorityQueue`使用了一个堆，每次通过轮询修改它时都必须对其进行重组。

你为什么要为此烦恼？`compareTo()`应该是轻量级、幂等且无副作用的方法，例如`equals()`. 你不应该对它施加任何限制。*

# android - android：将字符串数组从一个活动捆绑到另一个活动

> ID：13440165
> 
> 赞同：0
> 
> 时间：2012-11-18T12:42:14.643
> 
> 标签：android, bundle, arrays

我正在做一个测验，其中需要将问题和答案列表从活动 1 传递到活动 2。提取的相关编码如下：

## 活动一：Num_index.java

```
 String[] NUM_ALLL_QuestionNames; 
   String[] NUM_ALLL_AnswerNames;   

   @Override
   public void onCreate(Bundle savedInstanceState) 
   {
      super.onCreate(savedInstanceState); 
      setContentView(R.layout.main_num_index); 

      Button ButtonStart= (Button) findViewById(R.id.buttonStart);
      ButtonStart.setOnClickListener(startButtonListener);

      Button ButtonBackkk= (Button) findViewById(R.id.buttonBackkk);

      CheckTextView = (TextView) findViewById(R.id.checktextView); 

      NUM_SIM_QuestionNames = getResources().getStringArray(R.array.Num_Q_Simple_List);
      NUM_MED_QuestionNames = getResources().getStringArray(R.array.Num_Q_Medium_List);
      NUM_DIF_QuestionNames = getResources().getStringArray(R.array.Num_Q_Diff_List);
      NUM_EXP_QuestionNames = getResources().getStringArray(R.array.Num_Q_Expert_List);

      NUM_SIM_AnswerNames = getResources().getStringArray(R.array.Num_A_Simple_List);
      NUM_MED_AnswerNames = getResources().getStringArray(R.array.Num_A_Medium_List);
      NUM_DIF_AnswerNames = getResources().getStringArray(R.array.Num_A_Diff_List);
      NUM_EXP_AnswerNames = getResources().getStringArray(R.array.Num_A_Expert_List);

      NUM_ALL_QuestionNames = new ArrayList<String>();
      NUM_ALL_AnswerNames = new ArrayList<String>();                              
   };

   private OnClickListener startButtonListener = new OnClickListener() 
   {
      @Override
      public void onClick(View v) 
      {
          CheckBox CheckSim = (CheckBox) findViewById(R.id.checkBox2);
          // other similar checkBox omitted here for simplicity // 

          NUM_ALL_QuestionNames.clear();
          NUM_ALL_AnswerNames.clear();  

          if (CheckSim.isChecked()) 
          {
              QuestionImport= 0;                  
              QuestionImport = NUM_SIM_QuestionNames.length;
              int i =0;
              while (i<QuestionImport)
              {
                  String Q_toimport = NUM_SIM_QuestionNames[i];
                  String A_toimport = NUM_SIM_AnswerNames[i];   

                  NUM_ALL_QuestionNames.add(Q_toimport);
                  NUM_ALL_AnswerNames.add(A_toimport);                    
                  ++i;                    
              }           
          };    

         // other similar checkBox omitted here for simplicity // 

          if ((!CheckSim.isChecked()) && (!CheckMed.isChecked()) && (!CheckDif.isChecked()) && (!CheckExp.isChecked()))  
          {
              int k = 0;
              if (NUM_ALL_QuestionNames.size() >0) {k= NUM_ALL_QuestionNames.size();}
              CheckTextView.setText(String.valueOf(k));

                AlertDialog.Builder builder = new AlertDialog.Builder(Num_index.this);
                builder.setTitle("Error");
                builder.setMessage("Please select at least one choice!!");
                builder.setCancelable(false);
                builder.setPositiveButton("OK", null);                 
                AlertDialog ErrorDialog = builder.create();
                ErrorDialog.show();                   
          }

          if ((CheckSim.isChecked()) || (CheckMed.isChecked()) || (CheckDif.isChecked()) || (CheckExp.isChecked()))  
          {
              NUM_ALLL_QuestionNames = new String[NUM_ALL_QuestionNames.size()]; //convert ArrayList<String> to String[]
              NUM_ALLL_AnswerNames = new String[NUM_ALL_AnswerNames.size()]; //convert ArrayList<String> to String[]

              Intent senddata = new Intent (Num_index.this, Num.class); //transmit the list to num.java
              Bundle bundle = new Bundle();
              bundle.putStringArray("dataQ",NUM_ALLL_QuestionNames);
              bundle.putStringArray("dataA",NUM_ALLL_AnswerNames);
              senddata.putExtras(bundle);
              startActivity(senddata);                            

              int k = 0;
              if (NUM_ALLL_QuestionNames.length >0) {k= NUM_ALLL_QuestionNames.length;}
              CheckTextView.setText(String.valueOf(k));                                   
          }           

           Intent intent = new Intent (Num_index.this, Num.class);
           startActivity(intent);
           Num_index.this.finish();               

      } // end method onClick
   }; // end OnClickListener 
```

## 活动二：Num.java

```
 private String[] NUM_ALL_QuestionNames;
   private String[] NUM_ALL_AnswerNames;

   @Override
   public void onCreate(Bundle savedInstanceState) 
   {
      super.onCreate(savedInstanceState);
      setContentView(R.layout.main_num); 

      //get bundle from Num_index.java
      Bundle bundle = this.getIntent().getExtras();
      if (bundle!= null)
      {
          NUM_ALL_QuestionNames = bundle.getStringArray("dataQ");
          NUM_ALL_AnswerNames = bundle.getStringArray("dataA");          
      }
      else
      {
          NUM_ALL_QuestionNames = getResources().getStringArray(R.array.Num_Q_Simple_List);
          NUM_ALL_AnswerNames = getResources().getStringArray(R.array.Num_A_Simple_List);             
      } 
```

## 日志猫：

```
11-18 20:26:20.905: E/AndroidRuntime(5463): FATAL EXCEPTION: main
11-18 20:26:20.905: E/AndroidRuntime(5463): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.pearappx.iq_3/com.pearappx.iq_3.Num}: java.lang.NullPointerException
11-18 20:26:20.905: E/AndroidRuntime(5463):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1967)
11-18 20:26:20.905: E/AndroidRuntime(5463):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1992)
11-18 20:26:20.905: E/AndroidRuntime(5463):     at android.app.ActivityThread.access$600(ActivityThread.java:127)
11-18 20:26:20.905: E/AndroidRuntime(5463):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1158)
11-18 20:26:20.905: E/AndroidRuntime(5463):     at android.os.Handler.dispatchMessage(Handler.java:99)
11-18 20:26:20.905: E/AndroidRuntime(5463):     at android.os.Looper.loop(Looper.java:137)
11-18 20:26:20.905: E/AndroidRuntime(5463):     at android.app.ActivityThread.main(ActivityThread.java:4511)
11-18 20:26:20.905: E/AndroidRuntime(5463):     at java.lang.reflect.Method.invokeNative(Native Method)
11-18 20:26:20.905: E/AndroidRuntime(5463):     at java.lang.reflect.Method.invoke(Method.java:511)
11-18 20:26:20.905: E/AndroidRuntime(5463):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
11-18 20:26:20.905: E/AndroidRuntime(5463):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
11-18 20:26:20.905: E/AndroidRuntime(5463):     at dalvik.system.NativeStart.main(Native Method)
11-18 20:26:20.905: E/AndroidRuntime(5463): Caused by: java.lang.NullPointerException
11-18 20:26:20.905: E/AndroidRuntime(5463):     at com.pearappx.iq_3.Num.onCreate(Num.java:73)
11-18 20:26:20.905: E/AndroidRuntime(5463):     at android.app.Activity.performCreate(Activity.java:4470)
11-18 20:26:20.905: E/AndroidRuntime(5463):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1052)
11-18 20:26:20.905: E/AndroidRuntime(5463):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1931) 
```

第 73 行是

```
NUM_ALL_QuestionNames = bundle.getStringArray("dataQ"); 
```

这意味着 StringArray 未正确存储在 Activity1 中或无法在 Activity2 中正确获取。它显示 NullPointerException。

## 问题：

我已经通过这个网站搜索过这个网站，比如[String back from Bundle](https://stackoverflow.com/questions/7652829/string-back-from-bundle)，以及[如何将 selectedListItem 的对象传递给另一个活动？](https://stackoverflow.com/questions/6277662/how-to-pass-the-selectedlistitems-object-to-another-activity)并按照描述的方法进行操作，但仍然失败。但为什么是 NullPointerException？如何解决这个问题？

非常感谢！！

PS：在活动1中我有

```
 if (NUM_ALLL_QuestionNames.length >0) {k= NUM_ALLL_QuestionNames.length;}
              CheckTextView.setText(String.valueOf(k)); 
```

k 给出正确数量的项目。这意味着 NUM_ALLL_QuestionNames 不为空。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T12:50:44.717

[http://developer.android.com/guide/components/activities.html#StartingAnActivity](http://developer.android.com/guide/components/activities.html#StartingAnActivity)

您应该以您的第二个意图发送您的数据包。并完全删除第一个意图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T12:49:14.453

就像在您的当前代码中一样，您正在启动`Num.class`Activity 两次，第一次使用`startActivity(senddata);` ，第二次 `startActivity(intent);`不包含捆绑对象，这就是您得到的原因`NullPointerException`

# android - 线宽在按钮单击时增加并减小，但在 linedecr 按钮单击时未显示减小的线

> ID：13440166
> 
> 赞同：1
> 
> 时间：2012-11-18T12:42:25.563
> 
> 标签：android, android-widget

这是我的 mainactivity 代码：ResizeLineActivity.java 在其中我可以增加 lineincr 按钮单击时的线宽，而 linedecr 按钮单击时线宽正在减小，但问题是减小的线宽仅显示在 lineincr 按钮单击上。我不明白代码中有什么问题。驾驶室有人解释或更正此代码以在 linedecr 按钮单击时显示减少的行吗？

```
package edu.interview;
import android.app.Activity;
import android.graphics.Color;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.LinearLayout;
import android.widget.Toast;

public class ResizeLineActivity extends Activity {
DrawLine drawLine;
Button Lineincr;
Button linedecr;
LinearLayout.LayoutParams layoutParams;
int i=0;
static float x1=50;
static float y1=100;
static float x2=90;
static float y2=100;
static int temp=0;
@Override
protected void onCreate(Bundle savedInstanceState) {

    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    Lineincr =(Button)(findViewById(R.id.btn_incr));
    linedecr= (Button)findViewById(R.id.btn_decr);
    final LinearLayout linearltdrawLine=(LinearLayout)findViewById(R.id.linearlayout_showLineView);
//  linearltdrawLine.addView(new DrawLine(this, 50, 100, 100, 100));
    Lineincr.setOnClickListener(new View.OnClickListener() {
    LinearLayout.LayoutParams layoutParams=new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT,LinearLayout.LayoutParams.WRAP_CONTENT);
        @Override
        public void onClick(View v) {
        //  temp=++i;
            // TODO Auto-generated method stub
            linearltdrawLine.removeAllViews();
            Toast.makeText(getApplicationContext(), "hello Line", Toast.LENGTH_SHORT).show();
            linearltdrawLine.addView(new DrawLine(getApplicationContext(), x1, y1, x2, y2));
            int width1=linearltdrawLine.getWidth();
            /*  TextView txtv=(TextView) findViewById(R.id.linearlayout_showLineView);
            txtv.setBackgroundColor(Color.CYAN);
            txtv.setText("Insteas of line");*/
            linearltdrawLine.invalidate();
            linearltdrawLine.refreshDrawableState();
        //  linearltdrawLine.addView(txtv,layoutParams);
            linearltdrawLine.setVisibility(View.GONE);
            //linearltdrawLine.setVisibility(View.VISIBLE);
        //  linearltdrawLine.invalidate();
        //  linearltdrawLine.removeView(new DrawLine(getApplicationContext(), x1, y1, x2, y2));
            for(i=0;i<=1;++i){
                x2=x2+1;
                linearltdrawLine.setVisibility(View.VISIBLE);
                linearltdrawLine.addView(new DrawLine(getApplicationContext(), x1, y1, x2, y2));
            //  linearltdrawLine.refreshDrawableState();

            }
        }
    });

    linedecr.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v1) {
            // TODO Auto-generated method stub
            Toast.makeText(getApplicationContext(), "Line is decreasing", Toast.LENGTH_SHORT).show();
            linearltdrawLine.addView(new DrawLine(getApplicationContext(), x1, y1, x2, y2));
            linearltdrawLine.invalidate();

            linearltdrawLine.refreshDrawableState();
            //linearltdrawLine.setVisibility(View.GONE);
            for(i=1;i>0;i--){
                linearltdrawLine.removeView(new DrawLine(getApplicationContext(),x1,y1,x2,y2));
                x2=x2-1;
                linearltdrawLine.invalidate();
                linearltdrawLine.addView(new DrawLine(getApplicationContext(), x1, y1, x2, y2));
                linearltdrawLine.setVisibility(View.VISIBLE);
            }
        }
    });
} 
```

}

画线.java

```
package edu.interview;
import android.graphics.Canvas;
import android.graphics.Paint;
import android.content.Context;
import android.view.View;
import android.widget.LinearLayout;
import android.graphics.Color;

public class DrawLine extends View{
private final float X1,Y1,X2,Y2;
private final Paint paint=new Paint(Paint.ANTI_ALIAS_FLAG);
public DrawLine(Context context,float x1,float y1,float x2, float y2) {
    // TODO Auto-generated consructor stub
    super(context);
    this.X1=x1;
    this.Y1=y1;
    this.X2=x2;
    this.Y2=y2;

}

@Override
protected void onDraw(Canvas canvas) {
    // TODO Auto-generated method stub
    super.onDraw(canvas);
    paint.setTextSize(20);
    paint.setColor(Color.RED);

    canvas.drawLine(X1, Y1, X2, Y2, paint);
} 
```

}

主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:weightSum="1"
android:background="#BEE40F" >
<TextView android:layout_width="fill_parent" 
android:layout_height="wrap_content" 
android:text="@string/hello"
/>
<LinearLayout android:layout_height="wrap_content" android:layout_width="match_parent" android:id="@+id/linearlayout_showLineView" android:orientation="vertical" android:layout_weight="0.81" android:weightSum="1">
<LinearLayout android:layout_height="wrap_content" android:layout_width="match_parent" android:id="@+id/linearLayout_showtxt" android:orientation="vertical" android:layout_weight="0.26"></LinearLayout>
</LinearLayout>
<RelativeLayout android:id="@+id/relativeLayout1" android:background="@android:color/white" android:layout_width="fill_parent" android:layout_height="50dp" android:layout_weight="0.06">
    <Button android:layout_height="wrap_content" android:id="@+id/btn_incr"
         android:layout_width="wrap_content" android:text="Line++"
          android:layout_alignParentTop="true" android:layout_alignParentRight="true"
         android:layout_marginRight="106dp" android:layout_alignParentBottom="true" 
         >
    </Button>
    <Button android:layout_height="wrap_content" android:id="@+id/btn_decr"
             android:layout_width="wrap_content" android:text="Line --" 
             android:layout_toLeftOf="@+id/btn_decr" android:layout_marginRight="19dp"
              android:layout_alignParentBottom="true" android:layout_alignParentTop="true">
    </Button>
</RelativeLayout>
</LinearLayout> 
```

# types - 在 PostgreSQL 中将数据类型“Varchar”更改为“TimeStamp”

> ID：13440168
> 
> 赞同：1
> 
> 时间：2012-11-18T12:42:39.463
> 
> 标签：types, timestamp, varchar, sqldatatypes

我的数据集包含一个列，其中包含“varchar”数据类型中的日期和时间，如下所示：

2009 年 4 月 23 日 11:34:01

上述列的数据类型是varchar，我想问我如何将数据类型更改为“时间戳”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:25:41.260

我会在表中添加一个新的目标类型的 NULLable 列。

然后，您可以尝试根据数据的幼稚解析来填充列数据库。

然后，您可以运行 SELECT 将原始日期字符串与新日期字符串进行比较，但也可以使用输出格式化程序函数，以便字符串应该是相同的。然后让 SQL 使用 HAVING 子句比较这两个值。

一旦您有了能够转换现有数据的解决方案。

你应该努力改变策略。这可能需要更改软件。这可以通过首先确保 INSERT、UPDATE 将数据保存在 BOTH 列中的所有数据来完成。

然后，您对所有现有数据运行转换过程。

此时，对数据库的所有更改都应始终保持旧列和新列。也许您需要审核/运行系统一段时间以确保所有内容都被捕获，因为您现在可以随时重新运行比较/验证步骤。

然后，您可以处理 SELECT 用例。然后最后实际删除 VARCHAR 列。

所有这一切的重点是一个受控的逐步过程，其中有回滚选项并在每次更改之间进行测试。

# c - C 创建数组并检查输入错误

> ID：13440172
> 
> 赞同：0
> 
> 时间：2012-11-18T12:43:23.573
> 
> 标签：c, arrays, validation, input, conditional-statements

简单的问题。我正在尝试构建一个简单的脚本，它会询问你一个数字。该整数将是您总共输入的数字数量。然后你的程序找到最大的数字和最小的数字。我已经建立了它。简单的。

```
 int CHECK=100;
  int a[50],size,i,max,min;

  printf("\nEnter the size of the array: ");
  scanf("%d",&size);
  printf("\nEnter %d numbers: ", size);
  for(i=0;i<size;i++)
  scanf("%d",&a[i]);
  }
  max=a[0];
  for(i=1;i<size;i++){
     if(max<a[i])
       max=a[i];
  }
 printf("\nLargest element: %d",max);
 printf("\n");
 min=a[0];
 for(i=1;i<size;i++){
  if(min>a[i])
       min=a[i];
}
printf("Smallest element: %d",small);
printf("\n");

return 0;
} 
```

我的问题是，我怎么能告诉检查条件。例如，用户只能输入小于 100 的正数。因此，如果您输入 -4 或 201，则必须显示一个错误，告诉您重试。关于我们如何以简单的方式做到这一点的任何想法。或者甚至指出我正确的方向。

我很感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:35:03.843

这真的很容易——至少和 Python 一样容易。我坚持用你`scanf`来说明情况，但请参阅@j_random_hacker 的评论 (++)。

```
for(i=0; i < size; i++) {
    scanf("%d",&a[i]);
    if ( a[i] < 0 || a[i] > 99 ) {
        fprintf(stderr, "Number '%d' is out of range, try again: ", a[i]);
        i--;
    }
} 
```

顺便说一句`{`，您的代码中缺少一个，我认为这是一个转置错误。（一致的缩进将有助于拾取这样的错误——这不仅仅是 Python 中的一个好主意）。

# javascript - JavaScript 中的正则表达式条件验证

> ID：13440173
> 
> 赞同：0
> 
> 时间：2012-11-18T12:43:28.597
> 
> 标签：javascript, asp.net, regex

实际上我正在尝试将验证添加到 ASP.NET 中的文本框字段。验证就像前 2 个字符必须是字母，最后两个字符是数字，最大长度为 4 ..这是代码块

```
 function IsValidate(evt) {
    var charCode = (evt.which) ? evt.which : evt.keyCode;
    var Con = String.fromCharCode(charCode);
    var exp= new RegExp("[A-Za-z]{2}[0-9]{2}");
    if(exp.match(Con))
    {
    return true;
    }
    else
    {
    return false;
    }
    }

<asp:TextBox ID="txttest" runat="server" MaxLength="4" onkeypress="return IsValidate(event);"> 
</asp:TextBox> 
```

任何帮助将不胜感激......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:02:08.677

我不是 ASP.NET 方面的专家，但快速搜索显示您可以使用 RegularExpressionValidator 来验证文本字段的内容。

```
<asp:TextBox ID="txttest" runat="server" MaxLength="4"> 
</asp:TextBox>

<asp:RegularExpressionValidator 
  id="RegularExpressionValidator1" 
  runat="server" 
  ControlToValidate="txttest" 
  ErrorMessage="Your input must be 2 letters followed by 2 numbers" 
  ValidationExpression="^[A-Za-z]{2}[0-9]{2}$">
</asp:RegularExpressionValidator> 
```

[欲了解更多信息，请在此处](http://msdn.microsoft.com/en-us/library/aa479013.aspx#aspnet-validateaspnetservercontrols_topic6)访问 MSDN

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T12:48:26.737

您正在尝试将单个字符验证为期望匹配 4 个字符的正则表达式...

将验证移至 onblur 事件或表单提交。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T12:55:04.807

只是一些建议

*   像这样设置正则表达式“/..../”
*   在表达式中定义字符串的开头和结尾
*   定义修饰符

所以正则表达式会以这样的方式结束：

```
var exp = /^[A-Z]{2}[0-9]{2}$/i 
```

我希望它有所帮助，最好的问候。

# c# - 将整个 XML 文件加载到内存中

> ID：13440175
> 
> 赞同：1
> 
> 时间：2012-11-18T12:43:30.220
> 
> 标签：c#, xml

是否`XDocument.Load`将整个文件加载到内存中？如果不是，我应该使用哪种方法来做到这一点？

我需要有一个临时文件的内容，即使在文件被删除或更改后，也可以随时进行处理。这些文件通常很小，因此将整个内容放在内存中不是问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T15:41:11.933

是的，`XDocument.Load("filePath")`将立即将完整文件加载到内存中。

MSDN [http://msdn.microsoft.com/en-us/library/bb343181.aspx](http://msdn.microsoft.com/en-us/library/bb343181.aspx)说：

> 此方法使用底层 XmlReader 将 XML 读入 XML 树。

要通过**LINQ to XML**提供全部功能`XDocument`（这是方法的结果） ，必须立即构建。`Load`**`XML tree`**

 ***注意：对内存中数据的任何操作都不会影响文件，反之亦然。`document.Save(path)`必须调用显式......所以`Load`才会真正将数据读入内存***

# ios - UIView 工厂和委托

> ID：13440178
> 
> 赞同：0
> 
> 时间：2012-11-18T12:43:50.373
> 
> 标签：ios, uiview, delegates

我想在`UIView`. 问题是如何将数据（点）获取到视图中。如果我创建一个协议并将其设置`UIViewController`为委托，我在哪里`UIView`调用委托方法（`initWithFrame`？可能是早期的，并且可能没有设置委托，`awakeFromNib`？但是视图是 100% 在代码中创建的，它没有笔尖文件） ..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T12:56:27.903

> 初始化框架？可能太早了，并且可能没有设置委托。

事实上，委托**不能**在你进入的时候设置`initWithFrame:`，因为你在分配后对一个对象做的第一件事就是初始化，即在 init 方法返回之前，你不能调用（好吧，不这样做是惯用的所以，至少）任何其他方法。

您需要做的是有一个`loadData`or`reloadData`方法，委托必须在将自己设置为视图的委托后显式调用该方法。即，从视图控制器，您可以这样调用它：

```
@implementation ChartViewController

- (id)init
{
    if ((self = [super init])) {
        chartView = [[ChartView alloc] initWithFrame:self.view.frame];
        chartView.delegate = self;
        [self.view addSubview:chartView];
        [chartView reloadData];
    }
    return self;
} 
```

然后，在您的图表绘制视图中，执行`- reloadData`如下：

```
- (void)reloadData
{
    // Call the delegate here,
    // then do the drawing
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T12:50:14.327

制定协议，但不要称其为委托。称之为数据源：D

无论如何，当你第一次需要数据时调用它..尽可能晚..不在 init 中..可能在 setDataSource 调用中。

或者当您第一次绘制并看到您没有数据时..

* * *

看看 UITableView 看看他是怎么做的并模仿它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T12:57:29.020

更好的方法是使用`UIViewController`而不是`UIView`. 因为您的那个视图必须管理数据。管理数据是 UIViewController 的工作。

# ios - NSURLConnection 和 sendAsynchronousRequest:queue:completionHandler: - 完成块是否在主线程中运行

> ID：13440179
> 
> 赞同：4
> 
> 时间：2012-11-18T12:43:52.987
> 
> 标签：ios, asynchronous, nsurlconnection

如果我使用`NSURLConnection`with `sendAsynchronousRequest:queue:completionHandler:`，我是否需要在完成处理程序中采取任何特别的预防措施？具体来说，是否通过`NSURLConnection`与使用相同/相似的方式直接异步发送`dispatch_async`，因为完成块需要返回到主线程才能与 UI 交互？

例如：在`dispatch_async`用于与 UI 交互（可能是错误的词）之后，应用程序必须使用`performSelectorOnMainThread`.

这完全是一个考虑因素`sendAsynchronousRequest:queue:completionHandler:`吗？

注意：我发现了类似的问题，但不是这个。例如，在[NSURLConnection 是否阻塞了主线程？](https://stackoverflow.com/questions/3364021/does-nsurlconnection-block-the-main-thread)indiekiduk 特别声明它是一个新线程，尽管是一个内部线程——我认为这是有缺陷的，因为我认为它只是在运行循环的末尾——但我仍在学习并且可能/可能是错误的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T12:48:38.373

`NSURLConnection`队列参数的状态文档`sendAsynchronousRequest:queue:completionHandler:`

> *queue*
> 当请求完成或>失败时，处理程序块被分派到的操作队列。

该块将在设置传入队列的任何线程上执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T12:45:49.167

NSURLConnection sendAsync 安排在线程的 RunLoop 上，它在 AFAIK 上，因此在您启动它的线程中调用该块

# windows - 虚拟 IP 地址

> ID：13440180
> 
> 赞同：1
> 
> 时间：2012-11-18T12:43:57.653
> 
> 标签：windows, networking, ip, lan

我正在开发一个与网络相关的应用程序。它的前提是机器必须有一个IP地址才能正常工作。

当我在我的家庭网络上时，我的机器通过我网络上的 DHCP 获取 IP 地址。但是，当我的机器处于独立模式时，例如在旅行时，我无法获得 IP 地址并且状态为 LAN DISCONNECTED。

是否有解决方法，以便我可以在独立模式下获得 IP 地址或虚拟 IP 地址？

我已经尝试使用环回地址和其他 IP 地址进行配置。

我可以通过在我的机器上安装 dhcp 服务器来做到这一点吗？我的系统使用WINXP？

网卡：BroadcomNettxtreme 57XX 千兆以太网。

我强烈认为申请细节与它无关。因为，当机器有一个 IP 地址时，它开始正常工作。

我仍然对想法持开放态度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T12:49:35.947

我建议您在虚拟机中工作，然后分配您方便的虚拟 IP 和虚拟 MAC。您可以使用 Virtual Box 或 VMWare。

# php - laravel 视图中的 Foreach 和 Mysql

> ID：13440181
> 
> 赞同：-3
> 
> 时间：2012-11-18T12:44:00.527
> 
> 标签：php, pdo, laravel

我已经让 Laravel 来处理简单的 HTML 页面，路由工作，正如我的[这个问题](https://stackoverflow.com/questions/13433683/using-css-in-laravel-views)所定义的那样，但我不确定如何让 MySQL 和 PDO 在视图中工作。

我可以让“传统的”Hello world PHP/MySQL 查询在视图中工作，但不太确定如何使用 Laravel 的框架来做到这一点。

我通读了文档，但找不到有关如何执行此操作的任何信息-有人有任何想法吗？

目前我有一个基本页面，但想要一个简单的 foreach 查询工作，从这个表中回显数据：

**testingdb 表名** ：test1

```
name VARCHAR (255)
town VARCHAR (255)
biography TEXT 
```

如果不使用教程中通常提到的传统 PHP/MySQL 方法并使用 pdo 代替（源代码，nettuts，为什么应该使用 PDO 文章），我将如何使其工作？

我需要做些什么，创建一个控制器等吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T12:51:12.997

您可以在此处的文档中找到答案[http://laravel.com/docs/database/eloquent](http://laravel.com/docs/database/eloquent)

给你看一个例子：1）首先形成你的模型（例如.test1）2）建立一个数据库表连接和foreach，如下所示：

```
foreach (test1::all() as $test)
{
     echo $test->name;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T18:14:00.450

*   检索数据：这是[Laravel 的 Eloquent ORM 的一个很好的教程](http://daylerees.com/2012/04/04/laravel-eloquent-orm/)。
*   将数据传递给视图：请参阅相关的[Laravel 文档](http://laravel.com/docs/views#binding-data-to-views)页面。

# c# - 使用 C# 在 Metro 应用程序中的机器中搜索文件

> ID：13440185
> 
> 赞同：1
> 
> 时间：2012-11-18T12:44:38.067
> 
> 标签：c#, windows-8, microsoft-metro

我正在使用 C# 和 XAML 开发 Metro 应用程序，众所周知，我们可以使用以下代码在音乐库中搜索音乐文件。

```
IReadOnlyList<IStorageItem> itemsList  = await KnownFolders.MusicLibrary.GetItemsAsync(); 
```

其他驱动器（分区）中的音乐文件怎么样`D:`，`E:`等等。有没有办法在其他驱动器中搜索音乐文件？ **简介：**我想`.mp3`从我的硬盘驱动器中搜索文件并在 Gridview 中显示它们，有什么有效的方法可以实现吗？请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:17:11.200

Windows 应用商店应用程序仅限于在应用程序的 KnownFolders 或 LocalFolder 中搜索，因此您无法在其他驱动器中搜索

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T23:08:52.550

可以在其他文件夹或驱动器中搜索，但需要使用 FolderPicker 来选择 StorageFolder...

```
async Task<IEnumerable<StorageFile>> FindMusicFiles()
{
    var folderPicker = new FolderPicker()
    {
        CommitButtonText = "Yippie!",
        SuggestedStartLocation = PickerLocationId.ComputerFolder,
        ViewMode = PickerViewMode.List
    };

    folderPicker.FileTypeFilter.Add("*");
    StorageFolder folder = await folderPicker.PickSingleFolderAsync();

    if (folder != null)
    {
       StorageFileQueryResult queryResult = folder.CreateFileQuery();
       queryResult.ApplyNewQueryOptions(new QueryOptions(CommonFileQuery.OrderByName, new[] { ".mp3" }));
       IReadOnlyList<StorageFile> files = await queryResult.GetFilesAsync();
       return files;
    }

    return new StorageFile[] { };
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T13:02:21.060

该应用程序还可以记住您使用 FolderPicker 选择的文件夹，请参阅我在[Windows 8 应用程序和访问文件系统](https://stackoverflow.com/questions/13266423/windows-8-app-and-access-to-file-system)的帖子，其中我已经解释了如何使用 FutureAccessList...

# java - 在 For/in 循环中调用 map.get 会引发 nullpointerexception 而迭代器不会

> ID：13440186
> 
> 赞同：2
> 
> 时间：2012-11-18T12:44:43.320
> 
> 标签：java, generics, iterator

我为此花了几个小时的时间，但需要继续并找到一个丑陋的解决方法，但我很乐意清理我的代码，这是问题所在：

```
public static void function1(Map<String, Float> map)
{
    for(String key : map.keySet()) {
        Float val = map.get(key);
        // val is null here, throws NPE as soon as we try to use it
    }
}

public static void function2(Map<String, Float> map)
{
    Iterator<Entry<String, Float>> it = map.entrySet().iterator();
    while(it.hasNext()) {
        Entry<String, Float> entry = it.next();
        String key = entry.getKey();
        Float val = entry.getValue();
        // do something with key & val, works fine
    }
} 
```

当然，参数`Map<String, Float> map`已正确初始化并且不包含任何空值。

附带说明一下，如果我将参数更改为 Map map 并仅使用字符串对，则 function1 可以正常工作。我的目标是只有一个泛型函数`Map<? extends Object, ? extends Object> map`可以用于两种类型的地图。

任何建议表示赞赏，谢谢！托马斯

* * *

编辑：我添加了一些非常基本的内省以使该函数与泛型一起使用。我可以确认在使用键集时我仍然得到空值，而我按照下面的建议来使用条目集。下面是我的代码（第一个函数工作正常，而第二个函数返回空元素。

```
// yeah, it's aweful, but it works.
public static JsonNode map2JSON(Map<? extends Object, ? extends Object> map)
{
    ObjectNode dummyObject = Json.newObject();
    ArrayNode result = dummyObject.putArray("dummyKey");
    for(Entry<?, ?> entry : map.entrySet()) {
        ObjectNode mapElementNode = result.addObject();
        if("java.lang.String".equalsIgnoreCase(entry.getKey().getClass().getName())) {
            String key = (String)entry.getKey();
            if("java.lang.Float".equalsIgnoreCase(entry.getValue().getClass().getName())) {
                Float val = (Float)entry.getValue();
                mapElementNode.put(key, val);
            } else if("java.lang.String".equalsIgnoreCase(entry.getValue().getClass().getName())) {
                String val = (String)entry.getValue();
                mapElementNode.put(key, val);
            }
        }
    }
    return result;
}

// result here contains valid keys (the string part) and null values (the float part)
@Deprecated
public static JsonNode mapSF2JSON(Map<String, Float> map)
{
    ObjectNode dummyObject = Json.newObject();
    ArrayNode result = dummyObject.putArray("dummyKey");
    for(String key : map.keySet()) {
        ObjectNode mapElementNode = result.addObject();
        mapElementNode.put(key, map.get(key));
    }
    return result;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:33:09.757

您可能在地图中插入了 NULL 键字符串。这在使用 HashMap 时是可能的。尽量避免添加 NULL 键。此外，您可以使用 TreeMap。

顺便说一句，遍历条目集也不错，您可以像在 function1 中所做的那样，在 function2 中使用 foreach 来清理代码：

这看起来像：

```
for(Entry<String, Float> entry : map.entrySet()) {
    Float val = entry.getValue();
} 
```

虽然没有必要清理function2。但是您应该找到将 NULL 键插入地图的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T17:50:05.330

function1 使用了一个 foreach 循环，当 map 为 null 时会抛出 NullPointerException。在使用 foreach 迭代之前，您应该检查地图是否为空

进一步你应该重写丑陋的

```
if("java.lang.String".equalsIgnoreCase(entry.getKey().getClass().getName())) { 
```

至

```
 if (entry.getKey().getClass() == String.class) { 
```

# security - 安全模型和现有数据库

> ID：13440188
> 
> 赞同：2
> 
> 时间：2012-11-18T12:45:38.073
> 
> 标签：security, asp.net-mvc-4, dbcontext

我已经创建了一个带有代码优先和 DbContext 的数据库。

但是，这与新 MVC 4 站点上的安全模型数据库分开。

我的问题是如何将现有数据库与安全模型结合起来，或者出于正当理由将它们分开

例如这是最好的解决方案 [http://blog.spontaneouspublicity.com/include-asp-net-simple-membership-tables-as-part-of-your-entity-framework-model](http://blog.spontaneouspublicity.com/including-asp-net-simple-membership-tables-as-part-of-your-entity-framework-model)

当我第一次运行应用程序时，这将重新创建安全模型和角色。

或者有没有其他方法可以做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:45:14.510

出于这个原因，我喜欢新的 MVC 和 Simplemembership Provider。您可以很容易地将您的模型与 asp.net 帐户模型结合起来。

当您使用默认 Internet 模板时，它会创建一个名为 UsersContext 的上下文。要执行一些简单的操作，例如向 UserProfile 对象添加其他字段以在数据库中进行跟踪，您需要做 3 件简单的事情。

1.  将属性添加到模型（如果您使用默认模板，则在帐户模型中）
2.  在帐户控制器上的注册操作中，添加新字段 IE：

    ```
    public ActionResult Register(RegisterModel model)
    {
        if (ModelState.IsValid)
        {
            var db = new UsersContext();
            // Attempt to register the user
            try
            {
                WebSecurity.CreateUserAndAccount(model.UserName, model.Password, new { FirstName = model.FirstName, LastName = model.LastName, Address = model.Address, Company = model.Company, Phone = model.Phone, Country = model.Country, City = model.City, State = model.State, Zip = model.Zip });            
                WebSecurity.Login(model.UserName, model.Password);

                return RedirectToAction("Index", "Dashboard");
            }
            catch (MembershipCreateUserException e)
            {
                ModelState.AddModelError("", ErrorCodeToString(e.StatusCode));
            }
        }

        // If we got this far, something failed, redisplay form
        return View(model);
    } 
    ```

注意 new 关键字，我从传递的模型中获取值并将它们与模型匹配。（模型绑定可能会也可能不会在这里工作，但我还没有测试过）

3）更改注册视图和模型以传递所需的所有信息

当这第一次完美无缺且没有奇怪错误时，我几乎哭了。

祝你好运

# crash - win7上的ring0 APC DLL注入崩溃目标进程

> ID：13440192
> 
> 赞同：4
> 
> 时间：2012-11-18T12:46:03.083
> 
> 标签：crash, driver, apc, dll-injection

我正在尝试实现 ring0 dll 注入器驱动程序并通过 APC 注入实现。该代码在win XP上完美运行。在win7上，它不断崩溃目标进程。

这是代码：

```
NTSTATUS InjectDll( IN ULONG ulProcessId, HANDLE hEvent, IN TCHAR * pszDllPath )
{
    NTSTATUS            ntStatus;
    HANDLE              hProcess = NULL;
    OBJECT_ATTRIBUTES   ObjectAttributes;
    CLIENT_ID           ClientId;
    PKEVENT             pevtWait;
    PKPROCESS           pPcb = NULL;
    PVOID               pArg = NULL;
    ULONG               ulSize = 0;
    KAPC_STATE          ApcState;
    PKAPC               pApc;
    PVOID               pTcb;
    PVOID               pfnLoadLibrary;
    KPROCESSOR_MODE     PreviousMode = ExGetPreviousMode();
    LARGE_INTEGER       nTimeout;

    nTimeout.QuadPart = (LONGLONG) -300000000;

    do
    {
        InitializeObjectAttributes( 
            &ObjectAttributes,
            NULL,
            0,
            NULL,
            NULL)

        ClientId.UniqueProcess = (HANDLE)ulProcessId;
        ClientId.UniqueThread = 0;

        ntStatus = ZwOpenProcess(
            &hProcess,
            PROCESS_ALL_ACCESS,
            &ObjectAttributes,
            &ClientId
        );
        if ( NT_ERROR(ntStatus) )
        {
            DbgPrint("Open process %d failed - error 0x%X\r\n", ulProcessId, ntStatus);
            break;
        }

        ulSize = MAX_FILENAME_LEN * sizeof(WCHAR);
        ntStatus = ZwAllocateVirtualMemory(
            hProcess,
            &pArg,
            0,
            &ulSize,
            MEM_RESERVE|MEM_COMMIT,
            PAGE_READWRITE);
        if ( NT_ERROR(ntStatus) )
        {
            DbgPrint("ZwAllocateVirtualMemory failed - error 0x%X\r\n", ntStatus);
            // thus, make it leak in target process space!
            break;
        }

        ntStatus = ObReferenceObjectByHandle( 
            hProcess,
            PROCESS_ALL_ACCESS,
            0,//should be PsProcessType,
            PreviousMode,
            (PVOID*)&pPcb,
            NULL);
        if ( NT_ERROR(ntStatus) )
        {
            DbgPrint("ObReferenceObjectByHandle 0x%X failed - error 0x%X\r\n", hProcess, ntStatus);
            break;
        }

        //enter target process space
        KeStackAttachProcess(pPcb,&ApcState);

        pfnLoadLibrary = GetLoadLibraryAddress(pPcb);
        if (!pfnLoadLibrary)
        {
            DbgPrint("Failed to get address of LoadLibrary\r\n");
            // leave target process space
            KeUnstackDetachProcess(&ApcState);
            break;
        }
        else
        {
            DbgPrint("Get address of LoadLibrary : 0x%X\r\n", pfnLoadLibrary);
        }

        RtlCopyMemory( pArg, pszDllPath, MAX_FILENAME_LEN * sizeof(TCHAR));

        // leave target process space
        KeUnstackDetachProcess(&ApcState);

        // get target thread
        pTcb = GetThreadByProcess(pPcb);
        if (!pTcb)
        {
            DbgPrint("Get thread failed!\r\n");
            ntStatus = STATUS_UNSUCCESSFUL;
            break;
        }

        // start inject
        pApc = (PKAPC)ExAllocatePoolWithTag(NonPagedPool,sizeof(KAPC),POOL_TAG);
        if (!pApc)
        {
            DbgPrint("Failed to allocate memory for the APC structure\r\n");
            ntStatus = STATUS_INSUFFICIENT_RESOURCES;
            break;
        }

        KeInitializeApc(
            pApc,
            (PETHREAD)pTcb,
            OriginalApcEnvironment,
            &ApcKernelRoutine,
            NULL,
            (PKNORMAL_ROUTINE)pfnLoadLibrary,
            UserMode,
            pArg);

        if (!KeInsertQueueApc(pApc,NULL,NULL,0))
        {
            DbgPrint("Failed to insert APC\r\n");
            ntStatus = STATUS_UNSUCCESSFUL;
            ExFreePool(pApc);
            break;
        }

    } while (0);

    if ( pPcb )
    {
        ObDereferenceObject(pPcb);
    }

    if ( hProcess)
    {
        ZwClose(hProcess);
    }

    DbgPrint("InjectDll end - status = 0x%X\r\n", ntStatus);
    return ntStatus;
} 
```

injectDll 由 DeviceIoControl 服务例程调用。

```
 DRIVER_DISPATCH InjectorDeviceControl;
NTSTATUS NTAPI InjectorDeviceControl( 
    IN PDEVICE_OBJECT pDeviceObject, 
    PIRP pIrp)
{
    PIO_STACK_LOCATION pStack;
    PINJECT_DLL_PARAM pParam;
    NTSTATUS ntStatus;

    DbgPrint("call InjectorDeviceControl...\r\n");

    /* Get the stack location and parameters */
    pStack = IoGetCurrentIrpStackLocation(pIrp);
    pParam = (PINJECT_DLL_PARAM)pIrp->AssociatedIrp.SystemBuffer;

    if (pStack->Parameters.DeviceIoControl.IoControlCode != IOCTL_INJECTDLL)
    {
        /* Unsupported command */
        ntStatus = STATUS_NOT_IMPLEMENTED;
    }
    else
    {
        /* Validate the input buffer length */
        if (pStack->Parameters.DeviceIoControl.InputBufferLength < sizeof(INJECT_DLL_PARAM))
        {
            /* Invalid buffer */
            ntStatus = STATUS_INVALID_PARAMETER;
        }
        else
        {
            /* Inject dll */
            ntStatus = InjectDll(pParam->ulProcessId, pParam->hEvent, pParam->DllName);
        }
    }

    IoCompleteRequest(pIrp, IO_NO_INCREMENT);
    return ntStatus;
} 
```

这是目标进程的崩溃堆栈跟踪。

```
FAULTING_IP: 
ntdll!RtlActivateActivationContextUnsafeFast+9c
7770f59a 8933            mov     dword ptr [ebx],esi

EXCEPTION_RECORD:  ffffffff -- (.exr 0xffffffffffffffff)
ExceptionAddress: 7770f59a (ntdll!RtlActivateActivationContextUnsafeFast+0x0000009c)
   ExceptionCode: c0000005 (Access violation)
  ExceptionFlags: 00000000
NumberParameters: 2
   Parameter[0]: 00000001
   Parameter[1]: 00000000
Attempt to write to address 00000000

DEFAULT_BUCKET_ID:  NULL_POINTER_WRITE

PROCESS_NAME:  QQProtect.exe

ERROR_CODE: (NTSTATUS) 0xc0000005 - 0x%08lx

EXCEPTION_CODE: (NTSTATUS) 0xc0000005 - 0x%08lx

EXCEPTION_PARAMETER1:  00000001

EXCEPTION_PARAMETER2:  00000000

WRITE_ADDRESS:  00000000 

FOLLOWUP_IP: 
ntdll!RtlActivateActivationContextUnsafeFast+9c
7770f59a 8933            mov     dword ptr [ebx],esi

NTGLOBALFLAG:  0

FAULTING_THREAD:  00000300

PRIMARY_PROBLEM_CLASS:  NULL_POINTER_WRITE

BUGCHECK_STR:  APPLICATION_FAULT_NULL_POINTER_WRITE

LAST_CONTROL_TRANSFER:  from 77740baa to 7770f59a

STACK_TEXT:  
021df8a0 77740baa 75655a2c 00000000 02790000 ntdll!RtlActivateActivationContextUnsafeFast+0x9c
021df91c 77740461 002b5cd0 021dfab8 756559bc ntdll!LdrpProcessStaticImports+0x1b8
021dfa8c 7774232c 021dfaec 021dfab8 00000000 ntdll!LdrpLoadDll+0x314
021dfac0 759088ee 0026f074 021dfb00 021dfaec ntdll!LdrLoadDll+0x92
021dfaf8 75dc3c12 00000000 00000000 00000001 KERNELBASE!LoadLibraryExW+0x15a
021dfb0c 77726f7d 02790000 00000000 00000000 kernel32!LoadLibraryW+0x11
021dff88 75dc3c45 00000000 021dffd4 777437f5 ntdll!KiUserApcDispatcher+0x25
021dff94 777437f5 00295fe8 75655ce4 00000000 kernel32!BaseThreadInitThunk+0xe
021dffd4 777437c8 7770fd0f 00295fe8 00000000 ntdll!__RtlUserThreadStart+0x70
021dffec 00000000 7770fd0f 00295fe8 00000000 ntdll!_RtlUserThreadStart+0x1b

STACK_COMMAND:  ~1s; .ecxr ; kb

SYMBOL_STACK_INDEX:  0

SYMBOL_NAME:  ntdll!RtlActivateActivationContextUnsafeFast+9c

FOLLOWUP_NAME:  MachineOwner

MODULE_NAME: ntdll

IMAGE_NAME:  ntdll.dll

DEBUG_FLR_IMAGE_TIMESTAMP:  4ce7b96e

FAILURE_BUCKET_ID:  NULL_POINTER_WRITE_c0000005_ntdll.dll!RtlActivateActivationContextUnsafeFast

BUCKET_ID:  APPLICATION_FAULT_NULL_POINTER_WRITE_ntdll!RtlActivateActivationContextUnsafeFast+9c

WATSON_STAGEONE_URL:  http://watson.microsoft.com/StageOne/QQProtect_exe/3_0_1_3629/50a06369/ntdll_dll/6_1_7601_17514/4ce7b96e/c0000005/0002f59a.htm?Retriage=1

Followup: MachineOwner 
```

任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-08-17T12:50:27.247

我一直在努力解决这个问题`dll-injetion`，`apc`并遇到了同样的问题。
在进行了一些逆向工程之后，我找到了它发生的原因。

这是当当前线程`TEB`没有`ActivationContextStackPointer`成员时引起的：

```
ntdll!_TEB
   +0x000 NtTib            : _NT_TIB 
   +0x01c EnvironmentPointer : (null) 
   +0x020 ClientId         : _CLIENT_ID
   +0x028 ActiveRpcHandle  : (null) 
   +0x02c ThreadLocalStoragePointer : (null) 
   +0x030 ProcessEnvironmentBlock : 0x7ffd8000 _PEB
   +0x034 LastErrorValue   : 0
   +0x038 CountOfOwnedCriticalSections : 0
   +0x03c CsrClientThread  : (null) 
   +0x040 Win32ThreadInfo  : (null) 
   +0x044 User32Reserved   : [26] 0
   +0x0ac UserReserved     : [5] 0
   +0x0c0 WOW32Reserved    : (null) 
   +0x0c4 CurrentLocale    : 0x804
   +0x0c8 FpSoftwareStatusRegister : 0
   +0x0cc SystemReserved1  : [54] (null) 
   +0x1a4 ExceptionCode    : 0n0
   +0x1a8 ActivationContextStackPointer : (null) <---it's null 
```

该`RtlActivateActivationContextUnsafeFast`函数尝试在`ActivationContext`列表中插入一个节点，但是`ActivationContextStackPointer`is `null`，所以`ACCESS_VIOLATION`引发了 an 。

```
 mov     dword ptr [ebx],esi  //ebx = teb->ActivationContextStackPointer  which is 000000000  esi = node 
```

这`ActivationContext`有点与清单有关`DLL`。

[您可以在Microsoft 帮助](https://docs.microsoft.com/en-us/windows/desktop/sbscs/searching-for-assembly-files)中获得更多信息。

`dll`使用清单文件加载 a时，将`RtlActivateActivationContextUnsafeFast`调用 。

在这种情况下，我通过禁用我`dll`的清单文件的生成解决了这个问题：

> 链接器 - > ( `/MANIFEST:NO`)

或者您可以尝试`ActivationContextStack`通过使目标线程调用`ActivateActCtx`函数来强制系统为目标线程分配一个（我不确定是否可能？）。

希望这可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-18T13:31:50.970

我偶然发现了同样的问题，在 Windows 10 上的崩溃略有不同（无效的地址访问，但不是 NULL 指针取消引用）。我不喜欢王云路的解决方案，因为我希望能够加载任何 DLL。对我有用的是`NtQueueApcThread`直接调用而不是使用`QueueUserAPC`. 在这种情况下，`RtlDispatchAPC`被绕过并且不调用激活函数。

参考：
[https ://repnz.github.io/posts/apc/user-apc/#queueuserapc-kernelbase-dll-layer](https://repnz.github.io/posts/apc/user-apc/#queueuserapc-kernelbase-dll-layer)

# java - 如何在java中调整文本大小

> ID：13440201
> 
> 赞同：5
> 
> 时间：2012-11-18T12:46:56.877
> 
> 标签：java, image, swing, text, java-2d

我已经看到，在 Photoshop 中，只需拖动它们即可轻松调整文本的大小。我们如何在 Java 中做同样的事情？关于如何在java中调整文本大小的任何想法？添加了在 Photoshop 中调整大小的字母“A”的快照

![在此处输入图像描述](../Images/969031be89e681071db88fec20d522af.png)

* * *

请让我知道这段代码有什么问题？

```
public class ResizeImage extends JFrame {

    public ResizeImage(){
        JPanel panel = new JPanel(){
            public void paintComponent(Graphics g) {
                // In your paint(Graphics g) method
                // Create a buffered image for use as text layer
                BufferedImage textLayer = new BufferedImage(240, 240, 
                                              BufferedImage.TYPE_INT_RGB);

                // Get the graphics instance of the buffered image
            Graphics2D gBuffImg = textLayer.createGraphics();

                // Draw the string
                gBuffImg.drawString("Hello World", 10, 10);

                // Rescale the string the way you want it
                gBuffImg.scale(200, 50);

                // Draw the buffered image on the output's graphics object
                g.drawImage(textLayer, 0, 0, null);
                gBuffImg.dispose();
            }
        };
        add(panel);
    }

    public static void main(String [] args){
        ResizeImage frame = new ResizeImage();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
        frame.setSize(300, 300);
        frame.setVisible(true);
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-18T13:25:21.030

一种方法是使用一个[`AffineTransform`](http://docs.oracle.com/javase/tutorial/2d/advanced/transforming.html)（这个变体也会淡化颜色）。

![使用 Serif 字体拉伸（和淡出）文本](../Images/b8151a08d14cbe18fbb3cc8062d8361d.png)

```
import java.awt.*;
import java.awt.geom.AffineTransform;
import java.awt.image.BufferedImage;
import javax.swing.*;
import java.io.File;
import javax.imageio.ImageIO;

public class StretchText {

    public static void main(String[] args) throws Exception {
        // used to stretch the graphics instance sideways
        AffineTransform stretch = new AffineTransform();
        int w = 640; // image width
        int h = 200; // image height
        int f = 21; // Font size in px
        String s = "The quick brown fox jumps over the lazy dog.";

        final BufferedImage bi = new BufferedImage(
                w,h,BufferedImage.TYPE_INT_RGB);
        Graphics2D g = bi.createGraphics();
        g.setFont(new Font("Serif",Font.PLAIN,f));
        g.setRenderingHint(
                RenderingHints.KEY_TEXT_ANTIALIASING, 
                RenderingHints.VALUE_TEXT_ANTIALIAS_ON);

        // paint BG
        g.setColor(Color.WHITE);
        g.fillRect(0, 0, w, h);
        g.setColor(Color.BLACK);

        for (int i=0; (i*f)+f<=h; i++) {
            g.drawString(s, 0, (i*f)+f);
            // stretch
            stretch.concatenate(
                    AffineTransform.getScaleInstance(1.18, 1d));
            g.setTransform(stretch);

            // fade
            Color c = g.getColor();
            g.setColor(new Color (
                    c.getRed(),
                    c.getGreen(),
                    c.getBlue(),
                    (int)(c.getAlpha()*.75)));
        }

        g.dispose();

        ImageIO.write(bi, "png", new File(
                new File(System.getProperty("user.home")), 
                "StretchText.png"));
        Runnable r = new Runnable() {
            @Override
            public void run() {
                JLabel gui = new JLabel(new ImageIcon(bi));
                JOptionPane.showMessageDialog(null, gui);
            }
        };
        SwingUtilities.invokeLater(r);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-18T15:18:49.820

您可以使用来获取几何图形，如此[处](https://stackoverflow.com/a/8282330/230513)`TextLayout`所示。该示例缩放图像以填充框架。可能是利用框架的调整大小功能的好选择。[或者，此处](https://stackoverflow.com/a/11944233/230513)引用的示例显示了如何单击和拖动多个选择。[`JInternalFrame`](http://docs.oracle.com/javase/tutorial/uiswing/components/internalframe.html)

![图片](../Images/11d24c0089d4f4b8b2c6887faf35fc22.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-18T12:54:28.730

你可以定义字体类型

例如

```
Font f = new Font("SansSerif", Font.BOLD, 40) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-18T13:49:51.377

不幸的是，java api 没有原生的自由格式缩放/转换方法字体。

[`scale(x, y)`但是，您可以使用方法](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/Graphics2D.html#scale%28double,%20double%29)重新缩放 BufferedImage 或 Graphics 对象。因此，您可以尝试使用“层”的方法。即先在自己的图层（即一个BufferedImage）中绘制对象，例如文本，然后再在实际的图形输出上。

所以像往常一样在 BufferedImage 上绘制文本并按照你想要的方式重新调整它。这是一些简单的示例代码，可帮助您入门。

```
// In your paint(Graphics g) method

// Create a buffered image for use as text layer
BufferedImage textLayer = new BufferedImage(240, 240, 
                                  BufferedImage.TYPE_INT_ARGB);

// Get the graphics instance of the buffered image
Graphics2D gBuffImg = buffImg.createGraphics();

// Draw the string
gBuffImg.drawString("Hello World", 0, 0);

// Rescale the string the way you want it
gBuffImg.scale(240, 120);

// Draw the buffered image on the output's graphics object
g.drawImage(gBuffImg, 0, 0, null); 
```

文本层的实际大小可以在 FontMetrics 对象的帮助下确定，但我将把它作为 OP 的练习。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-21T05:04:36.643

这可以在图形级别使用`Graphics.setTransform()`. 但是我相信在字体级别使用鲜为人知的[`Font.deriveFont(transform)`](https://docs.oracle.com/javase/7/docs/api/java/awt/Font.html#deriveFont%28java.awt.geom.AffineTransform%29). 例如

```
// create transform
AffineTransform affineTransform = new AffineTransform();
affineTransform.scale(1d, 3d);

// create font using that transform
Font stretchedFont = g.getFont().deriveFont(affineTransform);

// set font as normal
g.setFont(stretchedFont);

// render as normal
g.drawString("Stretched", 23, 45); 
```

# php - 通过将时间戳与当前时间戳进行比较来检查时间戳是否已过期

> ID：13440202
> 
> 赞同：0
> 
> 时间：2012-11-18T12:46:59.557
> 
> 标签：php, datetime, timestamp, compare

我需要通过将其与当前时间戳进行比较来检查时间戳是否已过期

所以我有 ：

```
$current_timestamp = time();
$db_timestamp = 134500809 
```

我的问题是，在所有情况下都正确吗（总是正确的）：

```
if($current_timestamp > $db_timestamp){
 // $db_timestamp is expired for sure
} 
```

或者在某些情况下这应该是 FALSE 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T12:58:41.790

如果数据库中的时间戳在将来，它将`false`是，因此它将正常工作。

尝试在您的数据库中插入一行并将时间戳设置为`time() + 3600`，然后您将看到您的 if 语句被正确评估并返回`false`，直到一小时过去。

# php - JS、AJAX、PHP 没有刷新评论部分

> ID：13440203
> 
> 赞同：1
> 
> 时间：2012-11-18T12:47:03.417
> 
> 标签：php, ajax

最近开始学习 AJAX，我正在尝试创建一个评论部分，如前所述。youtube，无需刷新页面即可加载提交的评论。这是我到目前为止所得到的：

HTML：

```
<head><script src="JS/AJAX.js"></script>
<body>
  <form method="post" action="">
    User: <input type="text" id="name" /><br>
    Comment:<br>
    <textarea rows="5" cols="50" wrap="on" id="comment></textarea><br>
    <button id="submit">Submit</button>
  </form>

  <h3>Comments go here:</h3>
  <div id="commentarea"></div>
</body> 
```

我不知道如何在不刷新页面的情况下将评论插入数据库。如果我使用比方说 insert.php（将字段中的数据插入数据库）作为它将刷新页面的操作。

JS/AJAX（现在使用 XMLHttpRequest(); 不包括 try 和 catch 块来找出浏览器）：

```
function ajaxFunction(){
  var ajaxRequest = new XMLHttpRequest();

  ajaxRequest.onreadystatechange = function(){
    if(ajaxRequest.readyState == 4){
      document.getElementById("commentarea").innerHTML = ajaxRequest.responseText;
      }
  }
  ajaxRequest.open("GET","fetch-data.php",true);
  ajaxRequest.send(null);
} 
```

PHP（获取数据.php）：

```
<?php
$con = mysql_connect("localhost","root","") or die(mysql_error());

$mysql_select_db('localh',$con);

$query = mysql_query("SELECT User, UserComment FROM content");
if(!$query){
  die(mysql_error());
}

while($row = mysql_fetch_array($query)){
  echo "<h3>".$row['User']."</h3>"."<br>";
  echo "<p>".$row['UserComment']."</p>";
}

mysql_free_result($query);
mysql_close($con);
?> 
```

单独加载或使用“包含”显示提取过程有效。

据我了解，在我按下提交后，它应该将评论和用户插入数据库。然后 ajax 应该使用 fetch-data 脚本来提取数据，然后将其添加到 id 为“commentarea”的 div 中。我无法弄清楚这将如何工作，更确切地说，我无法从表单中调用 ajax 函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:17:32.387

您可以以 action="..." 属性的形式调用 javascript 函数。如果该函数返回 false，则不会通过通常的 post 请求提交表单，但您可以将输入数据用于 ajax 请求。

# php - PHP中随机长十六进制字符串的生成器

> ID：13440206
> 
> 赞同：15
> 
> 时间：2012-11-18T12:47:13.837
> 
> 标签：php, generator

我已经编写了一个字符串生成器，但我不知道如何创建一个长度为 100 位的*随机十六进制*字符串以插入数据库。所有这些字符串必须具有相同的长度。

如何生成随机十六进制字符串？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2014-02-28T19:33:37.707

从带有 OpenSSL 扩展的 PHP 5.3 开始：

```
function getRandomHex($num_bytes=4) {
  return bin2hex(openssl_random_pseudo_bytes($num_bytes));
} 
```

对于您的 100 位数字示例：

```
$str = getRandomHex(50); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-18T12:51:37.213

虽然这回答了 OP 的问题，但如果您正在寻找的是**random**，那么 @danorton 的答案可能更合适。

* * *

像这样：

```
$val = '';
for( $i=0; $i<100; $i++ ) {
   $val .= chr(rand(65, 90));
} 
```

65 是`A`90 是`Z`. 如果您不喜欢“幻数”，则此表格可能更具可读性：

```
$val = '';
for( $i=0; $i<100; $i++ ) {
   $val .= chr(rand(ord('A'), ord('Z')));
} 
```

出于性能原因，我`ord()`会将结果设为变量并将其移出循环：

```
$A = ord('A');
$Z = ord('Z');
$val = '';
for( $i=0; $i<100; $i++ ) {
   $val .= chr(rand($A, $Z));
} 
```

或者您可以粘贴`sha1()`s 的输出（其中三个）并减少到 100 个字符。或`md5()`改用（但我会坚持使用`sha1()`）。

**EDIT** `sha1()`输出 40 个字符长的字符串，`md5()`32 个字符长。因此，如果您不想按字符粘合字符（如我在上面给出的循环中），请尝试使用此功能

```
function getId($val_length) {
    $result = '';
    $module_length = 40;   // we use sha1, so module is 40 chars
    $steps = round(($val_length/$module_length) + 0.5);

    for( $i=0; $i<$steps; $i++ ) {
      $result .= sha1(uniqid() . md5(rand());
    }

    return substr($result, 0, $val_length);
} 
```

其中函数参数是要返回的字符串的长度。称它为`getId(100);`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-07-15T11:30:42.120

```
$randHexStr = implode( array_map( function() { return dechex( mt_rand( 0, 15 ) ); }, array_fill( 0, $strlen, null ) ) ); 
```

其中 $strlen 是随机十六进制字符串的长度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-21T13:39:57.917

衬里技术这样做，但就字符串长度而言，它有点复杂和硬编码。

$rand4 = substr(sha1(rand(0,getrandmax())),rand(0,24),16);

如果要更改输出字符串的长度，则需要更改函数的最后一个变量（我设置为 16），另外还有一个 rand(0,24)，其中数字 24 将根据第三个更改变量，它不应该超过 40-thirdvariable...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-29T00:37:01.583

我喜欢有一个可以处理类似情况的通用功能。我的意思是一个函数，它接收生成的字符串的所需长度和其中可能出现的字符。

这样一个函数就可以创建：40位十进制数、16位大写十六进制数、100个字母小写字符串等...

这是我的实现：

```
/**
 * Generate a random string.
 *
 * @param int    $length Length of the generated string.
 * @param string $chars  The string containing all of the available characters.
 *
 * @return string The generated string.
 */
function getRandomString($length = 10, $chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789') {
    $str = '';

    $size = strlen($chars);
    for ($i = 0; $i < $length; $i++) {
        $str .= $chars[mt_rand(0, $size - 1)];
    }

    return $str;
} 
```

**重要提示：**请勿出于任何安全目的使用此函数生成随机字符串。对于安全的字符串生成器，请查看@danorton 的答案。

# javascript - Javascript JQuery 递归

> ID：13440211
> 
> 赞同：0
> 
> 时间：2012-11-18T12:48:16.300
> 
> 标签：javascript, jquery, siblings

我正在编写一个 javascript 递归函数，但总是给我 0 值。下面是我的代码片段和显示标记的屏幕截图：

```
 getOdometerEnd: function(object){
    var previous = jQuery(object).closest('tr').prevAll();
    var odometerEnd = parseInt(previous.find('input[name=odometer_end\\[\\]]').val());
    console.log(previous.find('input[name=destination\\[\\]]').val());
    if(odometerEnd == 0){
        this.getOdometerEnd(previous);
    }
    return odometerEnd;
},
updateOdometer: function(){
    var self = this;
    var distance = 0;
    var odometerStart = 0;
    var odometerEnd = 0;
    jQuery('.app-table tr').each(function(index, object){
        distance = jQuery(object).find('input[name=distance\\[\\]]').val();
        if(typeof distance != 'undefined' && distance > 0){
            if(index == 1){
                odometerStart = jQuery(object).find('input[name=vehicle_odometer\\[\\]]').val();
            }else {
                odometerStart = self.getOdometerEnd(object);
            }
            odometerEnd = parseInt(odometerStart)+parseInt(self.userDistance(distance));
            jQuery(object).find('input[name=odometer_start\\[\\]]').val(odometerStart);
            jQuery(object).find('input[name=odometer_end\\[\\]]').val(odometerEnd);
        }

    });
}, 
```

我不知道我在哪里弄错了，但它在倒数第二次递归时给了我正确的值，但最后它再次返回 0。请你帮帮我。我在此处附上了一张显示我的标记的图片。

PS Stack 溢出不允许我发布图片。或者，您可以在此处查看图片：http: [//www.yourcarlog.com/odometer-problem.jpg](http://www.yourcarlog.com/odometer-problem.jpg)

提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T15:43:54.330

首先，给元素类以使选择更容易和更快。按名称选择很麻烦。

其次，您会发现：

*   维护一个正在运行的`odo_cumulative`变量，从而避免需要在表中查找有效的早期值`odo_end`.
*   无条件地设置`odo_start`和`odo_end`值，从而允许`odo_cumulative`通过空行传播。
*   （如果必须）执行第二次行扫描以清零`odo_start`和`odo_end`空行。

替换`updateOdometer`为以下版本：

```
updateOdometer: function(){
    var self = this;
    var odo_cumulative;
    var $rows = jQuery('.app-table tr').each(function(index, tr){
        var $tr = jQuery(tr);
        if(!odo_cumulative) {
            odo_cumulative = parseInt($tr.find('input.vehicle_odometer').val());
        }
        var odo_start = odo_cumulative;
        var odo_cumulative = odo_end = parseInt(odo_start) + parseInt(self.userDistance($tr.find('input.distance').val()));
        $tr.find('input.odometer_start').val(odo_start);
        $tr.find('input.odometer_end').val(odo_end);
    });
    //Now, if you absolutely must, :) DESPITE BEING TOTALLY ILLOGICAL AND AGAINST ALL MY ADVICE :), scan the table rows again to zero out the start/end values where distance ==0;
    $rows.each(function(index, tr){
        var $tr = jQuery(tr);
        if(parseInt($tr.find('input.distance').val()) == 0){
            $tr.find('input.odometer_start, input.odometer_end').val(0);
        }
    });
}, 
```

*未经测试*

第三，该`getOdometerEnd`方法不再被调用，因此可以删除，除非其他地方需要。

## 编辑：

如果这可行，那么这个更简单，避免重复扫描的需要也应该如此：

```
updateOdometer: function(){
    var self = this,
        odo_cumulative;
    var $rows = jQuery('.app-table tr').each(function(index, tr){
        var $tr = jQuery(tr),
            $inputs = $tr.find('input'),
            distance = parseInt(self.userDistance($inputs.filter('.distance').val()));
        if(!odo_cumulative) {
            odo_cumulative = parseInt($inputs.filter('.vehicle_odometer').val());
        }
        $inputs.filter('.odometer_start').val((distance == 0) ? 0 : odo_cumulative);
        odo_cumulative += distance;
        $inputs.filter('.odometer_end').val((distance == 0) ? 0 : odo_cumulative);
    });
}, 
```

*未经测试*

# c# - .net mvc4 HttpPost 空值

> ID：13440212
> 
> 赞同：2
> 
> 时间：2012-11-18T12:48:16.600
> 
> 标签：c#, asp.net, .net, razor, http-post

使用 HttpPost 传递对象时出现问题...提交表单后，模型在控制器端设置为“null”，我不知道问题出在哪里。

这是我的控制器：

```
 public ActionResult AddUser(int id = 0)
    {
        Group group = db.Groups.Find(id);
        List<User> finalList = db.Users.ToList() ;

        return View(new AddUserTemplate()
            {
                group = group,
                users = finalList
            });
//Everything is fine here, the object is greatly submitted to the view
    }

    [HttpPost]
    public ActionResult AddUser(AddUserTemplate addusertemplate)
    {
//Everytime we get in, "addusertemplate" is NULL
        if (ModelState.IsValid)
        {
//the model is null
        }
        return View(addusertemplate);

    } 
```

这是 AddUserTemplate.cs ：

```
 public class AddUserTemplate
{
    public Group group { get; set; }
    public User selectedUser { get; set; }
    public ICollection<User> users { get; set; }
} 
```

这是向控制器返回空值的表单（请注意，下拉列表中大量填充了好的值）：

```
@using (Html.BeginForm()) {
<fieldset>
    <legend>Add an user</legend>
    @Html.HiddenFor(model => model.group)
    @Html.HiddenFor(model => model.users)
    <div class="editor-field">
//Here, we select an user from Model.users list
        @Html.DropDownListFor(model => model.selectedUser, new SelectList(Model.users))
    </div>
    <p>
        <input type="submit" value="Add" />
    </p>
</fieldset>
} 
```

非常感谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:26:57.287

我试过你的代码，在我的例子中，`addusertemplate`模型不是空的，但它的属性都是空的。

这是因为一些模型绑定问题：`Html.HiddenFor`并且`Html.DropDownListFor`不适用于复杂类型（例如`Group`or `User`）（至少默认情况下是这样）。

此外，`Html.HiddenFor`无法处理集合。

以下是解决这些问题的方法：

*   而不是`@Html.HiddenFor(model => model.group)`应该`@Html.HiddenFor`为您需要绑定的组的每个属性都有一个

*   而不是`@Html.HiddenFor(model => model.users)`您需要遍历用户列表并为每个对象添加`@Html.HiddenFor`您需要绑定的用户的每个属性

*   而不是`@Html.DropDownListFor(model => model.selectedUser [...]`，创建一个类似的属性`int SelectedUserId {get;set;}`并在 DropDownList 中使用它（因为它不能处理复杂类型）。

这是有效的代码：

**1.**`User` and`Group`类，正如我想象的那样：

```
public class User
{
    public int Id { get; set; }
    public string Name { get; set; }
}

public class Group
{
    public int Id { get; set; }
    public string Name { get; set; }
} 
```

**2.**调整`AddUserTemplate`类：

```
public class AddUserTemplate
{
    public Group Group { get; set; }
    public IList<User> Users { get; set; }

    public int SelectedUserId { get; set; }

    public User SelectedUser
    {
        get { return Users.Single(u => u.Id == SelectedUserId); }
    }
} 
```

调整：

*   `Users`已从 更改`ICollection`为`IList`，因为我们需要通过索引访问元素（参见视图代码）
*   添加`SelectedUserId`的属性，将在 DropDownList 中使用
*   不是`SelectedUser`只读属性，它返回当前选择的`User`.

**3.**视图的调整代码：

```
@using (Html.BeginForm())
{
    <fieldset>
        <legend>Add an user</legend>

        @*Hidden elements for the group object*@
        @Html.HiddenFor(model => model.Group.Id)
        @Html.HiddenFor(model => model.Group.Name)

        @*Hidden elements for each user object in the users IList*@
        @for (var i = 0; i < Model.Users.Count; i++)
  {
            @Html.HiddenFor(m => m.Users[i].Id)
            @Html.HiddenFor(m => m.Users[i].Name)
  }
        <div class="editor-field">
            @*Here, we select an user from Model.users list*@
            @Html.DropDownListFor(model => model.SelectedUserId, new SelectList(Model.Users, "Id", "Name"))
        </div>
        <p>
            <input type="submit" value="Add" />
        </p>
    </fieldset>
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T14:35:06.930

另一个不需要一堆隐藏字段的选项是简单地指定您希望将模型传递给控制器​​。我认为这更清洁。

```
@using(Html. BeginForm("action","controller", Model, FormMethod.Post)){
...
} 
```

# php - 我网站部分内的 PHP 元生成代码不会在每个元标记之间添加新行

> ID：13440218
> 
> 赞同：-2
> 
> 时间：2012-11-18T12:48:57.470
> 
> 标签：php, html

我在里面有以下php代码**我网站的一部分。**

 **这是一个非常简单的代码，它添加了元名称 robots、wmt 工具验证元和 rss 元。

它工作正常，但有一件事：

当我使用 IE 或 Fireforx 查看页面的源代码时，我看不到元数据之间的新行。它们在一行中一个接一个地显示。

如何添加新行？有任何想法吗？如果我让他们这样，会有什么问题吗？

这是代码：

```
if((is_home() && $currentpage == 1) || (is_single() && $title != 'Online' && $title != 'Cam') || (is_category() && $robots == 'y')){
        echo '<meta name="robots" content="index,follow"/>';   
    } else {
        echo '<meta name="robots" content="noindex,follow"/>';
    } 
    if(get_option('enable_wmt') == 'y'){
        echo '<meta name="google-site-verification" content="'.get_option('wmt').'"/>';
    }
    if (is_home() && $currentpage == 1){
        echo '<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="'.$site_current.'/feed/"/>';
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T12:54:26.027

好吧，实际上原因很简单，就是您没有指定任何换行符。如果要生成换行符，也必须输出换行符，就像其他所有内容一样。

我通常使用这种语法，因为它不会使代码不可读：

```
if((is_home() && $currentpage == 1) || (is_single() && $title != 'Online' && $title != 'Cam') || (is_category() && $robots == 'y')){
        echo '<meta name="robots" content="index,follow"/>'."\n";   
    } else {
        echo '<meta name="robots" content="noindex,follow"/>'."\n";
    } 
    if(get_option('enable_wmt') == 'y'){
        echo '<meta name="google-site-verification" content="'.get_option('wmt').'"/>'."\n";
    }
    if (is_home() && $currentpage == 1){
        echo '<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="'.$site_current.'/feed/"/>'."\n";
    } 
```

说明：序列`\n`是单个换行符的描述。无法直接输入字符有两个原因：

1.  它是一个空白，因此编辑人员很难处理

2.  “正常”换行符在语言语法中具有特殊含义。

在 php 中使用该换行符时，您必须将其括在双引号 ( `"`) 中。只有当包含在双引号中时，这样的特殊字符才会被 php.ini 解释。如果您使用单引号 ( `'`)，这些序列将保持未解释状态。这是一个不时派上用场的区别......在这种情况下，它可以帮助我们坚持简单易读的方式，即如何将要输出的字符串移交给 echo 命令。我们使用冒号 ( `.`) 连接两个字符串，并使用双引号来解释特殊字符序列。

为了完整起见，另一个注意事项：在不同的情况下，有不同的方式来指定换行符。最值得注意的是，这是由不同的操作系统处理的。经典的 unix 系统（因此也是 Linux）使用上面引用的字符（`\n`十六进制表示法中的 0x10），MS-Windows 使用*两个*字符来指定单个换行符：（`\n\r`十六进制 0x10 0x13，或换行符和回车）。旧的 MacOS 系统再次使用了不同的东西，尽管当前的 MacOSX 系统也是基于 unix 的。由于互联网传统上属于 unix 领域（已在类似 unix 的系统下开发和增强），因此在互联网技术的许多部分都可以发现和预期类似 unix 的行为。**

# android - 从 android 日历中检索上次添加事件的数据

> ID：13440224
> 
> 赞同：6
> 
> 时间：2012-11-18T12:49:16.513
> 
> 标签：android, uri, google-calendar-api, android-calendar

我想从**android calendar检索****最后添加的事件**的数据。我正在使用此代码获取最后一个 ID。

 **```
 public static long getNewEventId(ContentResolver cr, Uri cal_uri)
 {
        Uri local_uri = cal_uri;
        if (cal_uri == null)
        {
            local_uri = Uri.parse("content://com.android.calendar/events");
        }
        Cursor cursor = cr.query(local_uri,
                new String[] { "MAX(_id) as max_id" }, null, null, "_id");
        cursor.moveToFirst();
        long max_val = cursor.getLong(cursor.getColumnIndex("max_id"));
        return max_val + 1;
 } 
```

然后我只需使用以下代码添加一个事件：

```
Intent intent = new Intent(Intent.ACTION_EDIT);
intent.setType("vnd.android.cursor.item/event");
intent.putExtra("beginTime", SelectedDate);
intent.putExtra("allDay", false);
intent.putExtra("rrule", "FsREQ=DAILY");
intent.putExtra("endTime", SelectedDate + 60 * 60 * 1000);
intent.putExtra("title", "Advance Scheduler Event");
startActivity(intent); 
```

在此之后，我只需使用以下代码检索此事件的数据：

```
public CalendarData EventDetails(int ID)
{
    CalendarData temp = null;

    // -------------------------------------------------------------------------------

    ContentResolver cr = getContentResolver();

    Cursor cursor_calendar;
    if (Integer.parseInt(Build.VERSION.SDK) >= 8)
    {
        cursor_calendar = cr.query(
                Uri.parse("content://com.android.calendar/calendars"),
                new String[] { "_id", "displayname" }, null, null, null);
    }
    else
    {
        cursor_calendar = cr.query(
                Uri.parse("content://calendar/calendars"), new String[] {
                        "_id", "displayname" }, null, null, null);
    }
    cursor_calendar.moveToFirst();
    String[] CalNamess = new String[cursor_calendar.getCount()];
    int[] CalIdss = new int[cursor_calendar.getCount()];
    for (int i = 0; i < CalNamess.length; i++)
    {
        CalIdss[i] = cursor_calendar.getInt(0);
        CalNamess[i] = cursor_calendar.getString(1);
        cursor_calendar.moveToNext();
    }
    cursor_calendar.close();

    // -------------------------------------------------------------------------------

    Cursor cursor_event;
    if (Integer.parseInt(Build.VERSION.SDK) >= 8)
    {
        cursor_event = cr.query(
                Uri.parse("content://com.android.calendar/events"),
                new String[] { "calendar_id", "title", "description",
                        "dtstart", "dtend", "eventLocation" }, null, null,
                null);
    }
    else
    {
        cursor_event = cr.query(Uri.parse("content://calendar/events"),
                new String[] { "calendar_id", "title", "description",
                        "dtstart", "dtend", "eventLocation" }, null, null,
                null);
    }

    boolean flag = false;
    String add = null;
    cursor_event.moveToFirst();
    String[] CalNames = new String[cursor_event.getCount()];
    int[] CalIds = new int[cursor_event.getCount()];
    for (int i = 0; i < CalNames.length; i++)
    {
        CalIds[i] = cursor_event.getInt(0);
        if (ID == CalIds[i])
        {
            flag = true;
            Toast.makeText(getApplicationContext(),
                    "ID Found : " + CalIds[i], Toast.LENGTH_LONG).show();
            CalNames[i] = "Event"
                    + cursor_event.getInt(0)
                    + ": \nTitle: "
                    + cursor_event.getString(1)
                    + "\nDescription: "
                    + cursor_event.getString(2)
                    + "\nStart Date: "
                        + cursor_event.getLong(cursor_event
                            .getColumnIndex("dtstart"))
                    + cursor_event.getLong(cursor_event
                            .getColumnIndex("dtend"))
                    + cursor_event.getString(5);

            temp = new CalendarData();

            temp.Title = cursor_event.getString(1);
            temp.Description = cursor_event.getString(2);
            // temp.StartDate = new Date(cursor_event.getLong(3));
            // temp.EndDate = new Date(cursor_event.getLong(4));

            temp.StartDate = cursor_event.getLong(cursor_event
                    .getColumnIndex("dtstart"));
            temp.EndDate = cursor_event.getLong(cursor_event
                    .getColumnIndex("dtend"));
            temp.Location = cursor_event.getString(5);
            break;
        }
        cursor_event.moveToNext();
    }
    return temp;
} 
```

但我无法获取此事件的数据。我不知道问题出在哪里。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-02T09:05:57.880

使用此代码。它在我的 aap 中工作

```
public long GetMaxID(ContentResolver cr, Uri cal_uri, Context context)
    {
        Uri local_uri = cal_uri;
        if (cal_uri == null)
        {
            // local_uri = Uri.parse("content://calendar/calendars/" +
            // "events");
            local_uri = Uri.parse("content://com.android.calendar/events");
        }
        Cursor cursor = cr.query(local_uri, new String[]
        { "MAX(_id) as max_id" }, null, null, "_id");

        cursor.moveToFirst();
        long max_val = cursor.getLong(cursor.getColumnIndex("max_id"));
        return max_val + 1;

    }

public static CalendarData GetEventDetails(String ID, Context context)
    {

        CalendarData temp = null;
        ContentResolver contentResolver = context.getContentResolver();

        // Fetch a list of all calendars synced with the device, their display
        // names and whether the

        cursor = contentResolver.query(
                Uri.parse("content://com.android.calendar/calendars"),
                (new String[]
                { "_id", "displayName", "selected" }), null, null, null);

        HashSet<String> calendarIds = new HashSet<String>();

        try
        {
            System.out.println("Count=" + cursor.getCount());
            if (cursor.getCount() > 0)
            {
                System.out
                        .println("the control is just inside of the cursor.count loop");
                while (cursor.moveToNext())
                {

                    String _id = cursor.getString(0);
                    String displayName = cursor.getString(1);
                    Boolean selected = !cursor.getString(2).equals("0");

                    System.out.println("Id: " + _id + " Display Name: "
                            + displayName + " Selected: " + selected);
                    calendarIds.add(_id);
                }
            }
        }
        catch (AssertionError ex)
        {
            ex.printStackTrace();
        }
        catch (Exception e)
        {
            e.printStackTrace();
        }

        // For each calendar, display all the events from the previous week to
        // the end of next week.
        // for (String id : calendarIds)
        for (int id = 0; id <= calendarIds.size(); id++)
        {
            Uri.Builder builder = Uri.parse(
                    "content://com.android.calendar/instances/when")
                    .buildUpon();
            // Uri.Builder builder =
            // Uri.parse("content://com.android.calendar/calendars").buildUpon();
            long now = new Date().getTime();

            ContentUris
                    .appendId(builder, now - DateUtils.DAY_IN_MILLIS * 10000);
            ContentUris
                    .appendId(builder, now + DateUtils.DAY_IN_MILLIS * 10000);

            Cursor eventCursor = contentResolver.query(builder.build(),
                    new String[]
                    { "_id", "title", "begin", "end", "allDay" },
                    "Calendars._id=" + id, null, null);

            System.out.println(id + " eventCursor count="
                    + eventCursor.getCount());
            if (eventCursor.getCount() > 0)
            {

                eventCursor.moveToFirst();

                while (eventCursor.moveToNext())
                {
                    Object mbeg_date, beg_date, beg_time, end_date, end_time;

                    final String eventID = eventCursor.getString(0);
                    final String title = eventCursor.getString(1);
                    final Date begin = new Date(eventCursor.getLong(2));
                    final Date end = new Date(eventCursor.getLong(3));
                    final Boolean allDay = !eventCursor.getString(4)
                            .equals("0");

                    if (eventID.equals(ID))
                    {
                        temp = new CalendarData();
                        temp.Title = eventCursor.getString(1);
                        temp.StartDate = eventCursor.getLong(2);
                        temp.EndDate = eventCursor.getLong(3);

                        break;
                    }

                }
            }
            // break;

        }
        return temp;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T01:11:29.377

我使用以下代码检索日历上的所有数据：

```
cr = getApplicationContext().getContentResolver();
        caluri=CalendarContract.Events.CONTENT_URI;
        atteuri=CalendarContract.Attendees.CONTENT_URI;
try
            {
                cur1 = cr.query(caluri, new String[]{Events.CALENDAR_ID,Events._ID, Events.TITLE, Events.DESCRIPTION,Events.DTSTART, Events.DTEND, Events.EVENT_LOCATION }, null, null, null);         
                    if(cur1!=null){
                        while(cur1.moveToNext()){
                            cal_ID=cur1.getString(cur1.getColumnIndex(Events.CALENDAR_ID));
                            event_ID=cur1.getString(cur1.getColumnIndex(Events._ID));
                            cur2=cr.query(atteuri,new String[]{Attendees.ATTENDEE_NAME,Attendees.ATTENDEE_EMAIL}, Attendees.EVENT_ID +"=" +event_ID, null, null);
                            if(cur2!=null){
                                while(cur2.moveToNext()){
                                    event_Title=cur1.getString(cur1.getColumnIndex(Events.TITLE));
                                    event_Desc=cur1.getString(cur1.getColumnIndexOrThrow(Events.DESCRIPTION));
                                    event_Start=new Date(cur1.getLong(cur1.getColumnIndex(Events.DTSTART)));
                                    event_end=new Date(cur1.getLong(cur1.getColumnIndex(Events.DTEND)));
                                    event_loc=cur1.getString(cur1.getColumnIndex(Events.EVENT_LOCATION));
                                    attendee_name=cur2.getString(cur2.getColumnIndex(Attendees.ATTENDEE_NAME));
                                    attendee_Email=cur2.getString(cur2.getColumnIndex(Attendees.ATTENDEE_EMAIL));
                                    all_attendee +="\n"+attendee_name;
                                    all_Emails +="\n"+attendee_Email;
                                }
                                cur2.close();
                            }   
                            all +="Event title: " + event_Title + "\n" + "Event Description: " + event_Desc + "\n" +"Event Start: " + event_Start + "\n" + "Events End: " + event_end + "\n" + "Event Location: " + event_loc + "\n" + "Attendees: " + "\n" + all_attendee + "\n" + "Emails: "+ "\n" + all_Emails + "\n";
                        }
                        cur1.close();
                    }
            }
            catch(Exception e)
         {
             e.printStackTrace();
         } 
```

所以我猜你需要做的就是稍微调整一下获取最后一个事件的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-22T06:11:54.857

```
ContentResolver cr = getContentResolver();
            Uri caluri = CalendarContract.Events.CONTENT_URI;
            Uri atteuri = CalendarContract.Attendees.CONTENT_URI;
            Cursor cur1, cur2;
            String all = null;
            try
            {
                cur1 = cr.query(caluri
                    , new String[]{ Events.CALENDAR_ID, Events._ID, Events.TITLE, Events.DESCRIPTION, Events.DTSTART, Events.DTEND, Events.EVENT_LOCATION }
                    , null, null, null);
                if (cur1 != null)
                {
                    while (cur1.moveToNext())
                    {
                        String event_Title = cur1.getString(cur1.getColumnIndex(Events.TITLE));
                        String event_Desc = cur1.getString(cur1.getColumnIndexOrThrow(Events.DESCRIPTION));
                        Date event_Start = new Date(cur1.getLong(cur1.getColumnIndex(Events.DTSTART)));
                        Date event_end = new Date(cur1.getLong(cur1.getColumnIndex(Events.DTEND)));
                        String event_loc = cur1.getString(cur1.getColumnIndex(Events.EVENT_LOCATION));
                        String all_attendee = null;
                        String all_Emails = null;

                        String cal_ID = cur1.getString(cur1.getColumnIndex(Events.CALENDAR_ID));
                        String event_ID = cur1.getString(cur1.getColumnIndex(Events._ID));
                        cur2 = cr.query(atteuri, new String[]{ Attendees.ATTENDEE_NAME, Attendees.ATTENDEE_EMAIL }
                            , Attendees.EVENT_ID + "=" + event_ID, null, null);
                        if (cur2 != null)
                        {
                            while (cur2.moveToNext())
                            {
                                String attendee_name = cur2.getString(cur2.getColumnIndex(Attendees.ATTENDEE_NAME));
                                String attendee_Email = cur2.getString(cur2.getColumnIndex(Attendees.ATTENDEE_EMAIL));

                                all_attendee += "\n" + attendee_name;
                                all_Emails += "\n" + attendee_Email;
                            }
                            cur2.close();
                        }
                        all += "Event title: " + event_Title + "\n"
                                + "Event Description: " + event_Desc + "\n"
                                + "Event Start: " + event_Start + "\n" + "Events End: "
                                + event_end + "\n" + "Event Location: " + event_loc
                                + "\n" + "Attendees: " + "\n" + all_attendee + "\n"
                                + "Emails: " + "\n" + all_Emails + "\n";
                    }
                    cur1.close();
                }
                System.out.println("My log--------" + all); 
```**

# arrays - 将 li 推入 jQuery 数组

> ID：13440229
> 
> 赞同：1
> 
> 时间：2012-11-18T12:49:45.560
> 
> 标签：arrays, push

我有一个简单的“ul”列表

```
 <ul class="home>
      <li><a href="#"><img src"image1.jpg" /></a></li>
      <li><a href="#"><img src"image2.jpg" /></a></li>
      <li><a href="#"><img src"image3.jpg" /></a></li>
      <li><a href="#"><img src"image4.jpg" /></a></li>
      <li><a href="#"><img src"image5.jpg" /></a></li>
    </ul> 
```

我想将每个“li”及其内容添加到数组中。
我以为我可以这样做，但我认为它不起作用。

```
 jQuery(function($){

        var imgArr = [];

        $('.home li').each(function(){
            imgArr.push(this);
            alert(imgArr);
        })

    }); 
```

如何将每个“li”添加到数组中？如何显示数组以查看其内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T12:57:05.833

您的 HTML 类名无效（缺少双引号），因此您的 jquery 选择器不起作用。以下 JS 将在控制台中为您提供一系列 LI。

```
 jQuery(function(){

        var imgArr = [];

        $('.home li').each(function(){
            imgArr.push(this);
        })

         console.log(imgArr);   
    });​ 
```

[演示](http://jsfiddle.net/DQhbH/1/)

# css - 为什么 IE 显示引导主题错误？我可以在样式（css）中改变什么？

> ID：13440230
> 
> 赞同：1
> 
> 时间：2012-11-18T12:49:48.863
> 
> 标签：css, internet-explorer, twitter-bootstrap, cross-browser, internet-explorer-10

我将这个模板[http://twitter.github.com/bootstrap/examples/carousel.html](http://twitter.github.com/bootstrap/examples/carousel.html)用于 twitter boostrap。

如果我用 Internet Explorer (IE) 10 打开网站： 标题图片不在顶部！

我在 IE 中需要相同的布局。我可以在样式文件中更改什么？请给我一个提示！非常感谢。

**IE 10（错误）：** ![IE 10](../Images/9f14b1812db68ed5aa16e17e9db2363b.png) **Chrome（正确）：** ![铬合金](../Images/83a4cbebcc2ecad638fc78663849f83e.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T17:52:36.363

我解决了这个问题`<meta http-equiv="X-UA-Compatible" content="IE=9" />`！谢谢你的帮助。

# jquery - Bootstrap-alert 关闭父容器

> ID：13440231
> 
> 赞同：0
> 
> 时间：2012-11-18T12:49:49.563
> 
> 标签：jquery, html, twitter-bootstrap, coffeescript, haml

Bootstrap-alert 插件的工作方式非常奇怪。我有以下haml结构：

```
.flashes
  .message.fade.in
    %p Hi there! 
```

还有一些咖啡：

```
jQuery ->
  $('.flashes').on 'click', '.message', ->
    $(this).alert('close') 
```

很简单。我希望调用`alert('close')`只会关闭单击`.message`的元素。但是插件关闭了整个`.flashes`块。想不通，有什么问题。任何人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T19:09:19.207

显然`$(x).alert('close')`期望`x`是一个关闭按钮——而不是实际的警报框——所以它关闭了`x`父元素。例如，给出这个 HTML：

```
<div class="flashes">
    <div class="message fade in">
        <p>Hi <span>there!</span></p>
        <p>Where is pancakes house?</p>
    </div>
</div> 
```

还有这个 CoffeeScript：

```
$('.flashes').on 'click', '.message', ->
    $(@).find('span').alert('close')​​​ 
```

单击将关闭第一个`<p>`并离开`.flashes`,`.message`和第二个`<p>`。

演示：http: [//jsfiddle.net/ambiguous/JJbCz/](http://jsfiddle.net/ambiguous/JJbCz/)

但是，如果您将 CoffeeScript 更改为`.alert('close')`第一个孩子：

```
$('.flashes').on 'click', '.message', ->
    $(@).find(':first-child').alert('close') 
```

那么你应该得到你期望的结果。

演示：http: [//jsfiddle.net/ambiguous/wm6jh/](http://jsfiddle.net/ambiguous/wm6jh/)

我在任何地方都看不到您将任何内容包装在警报中（即`$(x).alert()`），所以也许您只是在滥用`.alert('close')`并且应该使用简单的手动[`.fadeOut`](http://api.jquery.com/fadeOut/)调用：

```
$('.flashes').on 'click', '.message', ->
    $(@).fadeOut('slow') 
```

演示：http: [//jsfiddle.net/ambiguous/uhV6P/](http://jsfiddle.net/ambiguous/uhV6P/)

​</p>

# jsf-2 - JSF h:commandLink 不适用于过滤器

> ID：13440232
> 
> 赞同：0
> 
> 时间：2012-11-18T12:50:05.740
> 
> 标签：jsf-2, servlet-filters

我为我的 jsf 项目创建了简单的登录系统。在项目中，我创建过滤器来检查用户登录状态。

*   如果登录，继续请求的页面。

*   如果没有登录或会话被破坏，重定向到登录页面

我的问题是，如果我应用过滤器，那么所有 h:commandLink 在单击后都不会处理任何内容。但是当我删除过滤器时，一切正常。

我尝试将 h:commandButton 与 fileter 一起使用，然后一切正常。

我该如何解决这个问题？我研究了很长时间，但没有找到任何解决方案。请帮我！

过滤器代码：

```
 @WebFilter(filterName = "AuthenticationFilter", urlPatterns = {"*.htm"}, dispatcherTypes = {DispatcherType.FORWARD, DispatcherType.REQUEST})
public class AuthenticationFilter implements Filter {

    // The filter configuration object we are associated with.  If
    // this value is null, this filter instance is not currently
    // configured. 
    private FilterConfig filterConfig = null;

    @Inject
    private AuthenticationManager authenticationManager;  

    public AuthenticationFilter() {
    } 

    /**
     * @param request The servlet request we are processing
     * @param response The servlet response we are creating
     * @param chain The filter chain we are processing
     *
     * @exception IOException if an input/output error occurs
     * @exception ServletException if a servlet error occurs
     */
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
        throws IOException, ServletException {

        Throwable problem = null;        
        try {
            HttpServletRequest req = (HttpServletRequest) request; 
            String requestUrl = req.getRequestURI(); 

            String contextPath = req.getContextPath(); 
            if(contextPath.equals("/")){
                contextPath = "";
            }
            String jsfUrl = requestUrl.replaceFirst(contextPath, "");

            if (authenticationManager.allowedAccess(jsfUrl) || requestUrl.equalsIgnoreCase(contextPath+"/login.htm")) {
                chain.doFilter(request, response);                
            } 
            else {
                String redirectPath = contextPath+"/login.htm";
                ((HttpServletResponse) response).sendRedirect(redirectPath); // Not logged in, so redirect to error page.
            }
        } 
        catch (Throwable t) {
            // If an exception is thrown somewhere down the filter chain,
            // we still want to execute our after processing, and then
            // rethrow the problem after that.
            problem = t;
        }

        // If there was a problem, we want to rethrow it if it is
        // a known type, otherwise log it.
        if (problem != null) {
            if (problem instanceof ServletException) {
                throw (ServletException) problem;
            }
            if (problem instanceof IOException) {
                throw (IOException) problem;
            }
            sendProcessingError(problem, response);
        }
    }

    /**
     * Return the filter configuration object for this filter.
     */
    public FilterConfig getFilterConfig() {
        return (this.filterConfig);
    }

    /**
     * Set the filter configuration object for this filter.
     *
     * @param filterConfig The filter configuration object
     */
    public void setFilterConfig(FilterConfig filterConfig) {
        this.filterConfig = filterConfig;
    }

    @Override
    public void destroy() {        
    }

    @Override
    public void init(FilterConfig filterConfig) {        
        this.filterConfig = filterConfig;
        if (filterConfig != null) {
        }
    }
} 
```

jsf代码：

```
<h:body>
<f:view contentType="text/html" locale="#{authenticationManager.languageCode}">
<div class="header">
    <h:form id="topForm" prependId="false">
        <div class="logo">
            <h1><img src="#{facesContext.externalContext.requestContextPath}/resources/images/login-logo2.png" width="220" height="64"/></h1>
        </div>  
        <ul class="navTop">
            <li>
                <a href="#"><span class="pictograms">f</span>#{authenticationManager.currentUser.firstName} #{authenticationManager.currentUser.lastName}</a>
            </li>
            <li>
                <a href="#"><span class="pictograms">m</span>Messages</a>
            </li>
            <li class="logout">
                <h:commandButton action="#{authenticationManager.logout()}" value="aaaaaaa" style="color:#fff;" />
                <h:commandLink action="#{authenticationManager.logout()}" value="#{label.Logout}"/>
                <h:commandLink immediate="true" action="#{authenticationManager.logout}" id="logoutLink">
                    <span class="pictograms">E</span>***This link is not work correctly***
                </h:commandLink>
            </li>
        </ul>           
        <ui:insert name="mainmenu"/>
    </h:form>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:16:20.040

您的具体问题是因为 JSF 默认资源的服务`jsf.js`已被过滤器阻止。此资源对于 JSF 命令链接和 JSF ajax 请求的功能是必需的（没有 ajax 的普通命令按钮可以正常工作）。

您需要从身份验证检查中排除 JSF 资源。您可以通过检查请求 URI 是否在 webapp 上下文路径[`ResourceHandler.RESOURCE_IDENTIFIER`](http://docs.oracle.com/javaee/6/api/javax/faces/application/ResourceHandler.html#RESOURCE_IDENTIFIER)（其值为`/javax.faces.resource`）之后开始来做到这一点。

所以，基本上：

```
HttpServletRequest req = (HttpServletRequest) request;

if (req.getRequestURI().startsWith(req.getContextPath() + ResourceHandler.RESOURCE_IDENTIFIER)) {
    chain.doFilter(request, response); // Let it continue.
    return;
} 
```

检查文件扩展名很笨拙，并且不足以涵盖所有可能的资源请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T13:07:52.063

经过研究，我没有找到任何解决方案。所以我邀请了很多可能的方式，并找到了关于这个的解释。

我使用过滤器模式“*.htm”过滤所有内容，然后每个请求（如 .js.htm、.css.htm、.gif.htm、.jpg.htm）都将重定向到 login.htm 页面。

重点是将 .js.htm 重定向到登录页面而不是正确的文件。所以像 jsf.js.htm 这样的重要库被重定向到 login.htm，这是导致 h:commandLink 无法正常工作的主要原因。

跳这会帮助像我这样的人。

```
try {
        HttpServletRequest req = (HttpServletRequest) request; 
        String requestUrl = req.getRequestURI(); 

        if(requestUrl.endsWith(".js.htm") 
            || requestUrl.endsWith(".css.htm") 
            || requestUrl.endsWith(".gif.htm") 
            || requestUrl.endsWith(".png.htm") 
            || requestUrl.endsWith(".jpg.htm") 
            || requestUrl.endsWith(".jpeg.htm")){
            chain.doFilter(request, response);            
        }
        else{
            String contextPath = req.getContextPath(); 
            if(contextPath.equals("/")){
                contextPath = "";
            }
            String jsfUrl = requestUrl.replaceFirst(contextPath, "");

            if (authenticationManager.allowedAccess(jsfUrl) || requestUrl.equalsIgnoreCase(contextPath+"/login.htm")) {
                chain.doFilter(request, response);                
            } 
            else {
                String redirectPath = contextPath+"/login.htm";
                ((HttpServletResponse) response).sendRedirect(redirectPath); // Not logged in, so redirect to error page.
            }
        }
    } 
```

# magento - Magento 块放置

> ID：13440235
> 
> 赞同：0
> 
> 时间：2012-11-18T12:50:26.637
> 
> 标签：magento, magento-1.7

我想在上面的产品详细信息部分添加下面的块部分

如下图所示

![如图所示](../Images/1b1687cd88ae1f6628ee54718b7e6835.png)

有人知道吗？

我的布局是

脸书评论第一名

```
<reference name="product.info">
<block type="facebookcomments/catalog_product_comments" name="product.info.facebookcomments" template="facebookcomments/catalog/product/comments.phtml"/> 
```

第二个是Facebook之类的

```
<reference name="product.info">
    <block type="facebookilike/catalog_product_facebookilike" name="product.info.facebookilike" template="facebookilike/catalog/product/facebookilike.phtml"/> 
```

仍然没有得到这个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:54:22.507

处理`catalog_product_view`您的主题/模块布局：

（**请注意**，我是基于屏幕截图中的调试块名称的伪编码。我可能没有正确的块/模板/句柄，但你明白了）

```
<reference name="content">
    <block type="mageplace_facebook/like_catalog_product_facebooklike" 
           after="product.info" 
           name="facebook.like.block.name" 
           template="path/to/facebooklike/template.phtml" />
</reference> 
```

检查 Facebook 评论模块的布局 xml，因为它显然在正确的位置。

# c - 为什么 X86 提供了一对除法和乘法指令？

> ID：13440242
> 
> 赞同：11
> 
> 时间：2012-11-18T12:50:51.577
> 
> 标签：c, x86

我注意到，unsigned int 和 int 共享相同的加法和减法指令。但是为整数除法和乘法提供 idivl / imull ，为 unsigned int 提供 divl / mull 。我可以知道这个的根本原因吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-18T13:25:45.390

乘法或除法时的结果会有所不同，具体取决于您的参数是有符号还是无符号。

这真的是二进制补码的魔力，它允许我们对有符号和无符号加减法使用相同的操作。这在其他表示中是不正确的——一个的补码和符号大小都使用与无符号算术不同的加法和减法算法。

例如，对于 32 位字，用`-1`表示`0xffffffff`。对此进行平方，您会得到签名和未签名版本的不同结果：

```
Signed: -1 * -1 = 1 = 0x00000000 00000001
Unsigned: 0xffffffff * 0xffffffff = 0xfffffffe 00000001 
```

注意结果的低位字是一样的。在不给你高位的处理器上，只需要一条乘法指令。在 PPC 上，有 3 条乘法指令 - 一条用于低位，两条用于高位，具体取决于操作数是有符号还是无符号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T13:00:19.860

大多数微处理器使用[**移位和加法算法**](http://www.engineering.uiowa.edu/~carch/lectures06/55035-060227-prn.pdf)（或类似算法）实现乘法和除法。这当然需要单独处理操作数的符号。使用加减法
实现乘法和除法时不必担心关于符号，因此允许互换处理有符号和无符号整数值，它的效率要低得多，这可能就是为什么不使用它的原因。

我刚刚读到一些现代 CPU 交替使用[**Booth 编码**](http://en.wikipedia.org/wiki/Booth_encoding)方法，但该算法也意味着断言值的符号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T13:24:36.057

在 x86 符号存储在字的高位（如果将谈论整数和无符号整数） ADD 和 SUB 命令使用一种算法来进行有符号和无符号输入 - 它在两者中都得到正确的结果。

对于 MULL 和 DIV，这是行不通的。你应该“告诉”CPU你想要“使用”有符号或无符号的int。对于无符号使用 MULL 和 DIV。它只是操作文字 - 它很快。对于签名使用 MULL 和 IDIV。它将单词转换为绝对（正）值，为结果存储符号，然后进行操作。这比 MULL 和 DIV 慢。

# php - PHP - 通过变量获取对象属性

> ID：13440244
> 
> 赞同：16
> 
> 时间：2012-11-18T12:51:13.210
> 
> 标签：php, object, syntax

我有一个有很多属性的对象。一些属性的名称以相同的文本字符串开头（在我的示例中为“bullet”），后跟一个整数。

我可以按如下方式获取属性值：

```
echo $objectName->bullet1;
echo $objectName->bullet2;
echo $objectName->bullet3; 
```

等等。

我正在尝试编写一个 for 循环来获取其中的前 20 个，目前它看起来有点像：

```
for ($i = 1; $i <= 20; $i++){
 if ($objectName->bullet$i){
  echo $objectName->bullet$i;
 }
} 
```

但这行不通。我知道我可以写类似的东西

```
$bulletsArray[1] = $objectName->bullet1;
$bulletsArray[2] = $objectName->bullet2;
$bulletsArray[3] = $objectName->bullet3; 
```

一直到 20，然后在上面放一个 for 循环，但我相信一定有一个更干净的方法。有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-18T12:56:18.317

您可以这样做：

```
for ($i = 1; $i <= 20; $i++){
    $propertyName = "bullet$i";
    if ($objectName->$propertyName){
        echo $info->$propertyName;
    }
} 
```

虽然我认为使用数组而不是对象会是一个更好的解决方案。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-18T13:02:44.087

之前的两个答案都有“尝试一下，如果它不起作用，请继续”并且正在针对非常具体的情况工作。让我给你一个更通用的方法，遗憾的是，它需要 PHP 5。

**一点关于反射**

反射允许您反射对象或类以提取有关它的有用信息。特别是，您可以使用反射来获取类中设置的所有属性，无论是静态的、运行时的还是动态生成的。

为此，首先启动您的反射对象（假设您的类对象是 $object），如下所示：

```
$refObj = new ReflectionObject($object); 
```

这将为您提供一个反射界面。注意这个有用的`ReflectionObject::getProperties()`方法——它允许你获取一个类中设置的所有属性（如果需要，你可以按公共、受保护、私有等进行过滤）。我们将使用这个：

```
$yourNewArray = array();
$PropertyArray = $refObj->getProperties();
$pCount = count($PropertyArray);
for ($i = 0; $i < $pCount; $i++) {
   $yourNewArray[$PropertyArray[$i]->getName()] = $PropertyArray[$i]->getValue($object);
} 
```

完毕。完全通用，可在任何地方使用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-18T12:54:18.923

```
$var = 'myVariable';
$value = $object->$var; 
```

是在 PHP 中按名称访问字段的正确语法。

在您的情况下，它看起来像这样：

```
for ($i = 1; $i <= 20; $i++) 
{
     $var = 'bullet'.$i;

     if ($objectName->$var)
     {
          echo $info->$var;
     }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-15T12:51:03.207

在我的系统中，这不允许我这样做

```
$myPropertyValue = $object->$property; 
```

我仍然可以使用以下函数获取“变量”属性名称的值；您可以设置 $property 而不会 php 抱怨语法或抛出错误。

```
<?php
    class MyClass{
    public function getProperty($propertyName){
        $props=get_object_vars($this);
        if (array_key_exists($propertyName,$props)){
            return $props[$propertyName];
        }else{
            return FALSE;
        }
    }
}
?> 
```

# django - 根据调试状态提供 Django 静态内容

> ID：13440246
> 
> 赞同：1
> 
> 时间：2012-11-18T12:51:24.673
> 
> 标签：django

我最近设置了我们的项目来提供来自 Amazon S3 的静态和媒体文件。这反过来又使我们的项目即使在本地工作时也可以提供来自 S3 的所有内容。

我们的静态设置设置为以下以与 S3 一起使用：

```
STATIC_ROOT = "/%s/" % STATIC_S3_PATH
STATIC_URL = '//s3.amazonaws.com/%s/static/' % AWS_STORAGE_BUCKET_NAME 
```

在 URLs conf 文件中，我们添加了以下内容以匹配 Django 文档：

```
if settings.DEBUG:
    urlpatterns += patterns('django.contrib.staticfiles.views',
        url(r'^static/(?P<path>.*)$', 'serve'),
        url(r'^media/(?P<path>.*)$', 'serve'), 
    ) 
```

显然，这些 URL 模式不起作用，因为我们在“//s3.ama...”上提供文件。我以我的智慧认为我可以写一段正则表达式来解决这个问题并尝试替换：

```
url(r'^static/(?P<path>.*)$', 'serve'), 
```

和：

```
url(r'//s3.amazonaws.com/%s/static/(?P<path>.*)$' % settings.AWS_STORAGE_BUCKET_NAME, 'serve'), 
```

这也不起作用。所以为了最终解决这个问题，我在设置文件中添加了一个条件语句来决定从哪里提供静态文件：

```
if DEBUG:
    STATIC_URL = '/static/'
else:
    STATIC_URL = '//s3.amazonaws.com/%s/static/' % AWS_STORAGE_BUCKET_NAME 
```

人们如何看待这个解决方案？我对它的前进并不十分满意。我的替代方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:12:04.993

设置中的条件是一个很好的解决方案。

另一种选择是使用单独的设置文件进行本地设置。

# php - 连接断开时如何解决 Yii 网格错误？

> ID：13440247
> 
> 赞同：0
> 
> 时间：2012-11-18T12:51:26.253
> 
> 标签：php, yii

现在，如果我有两个表用户和订单并且它们有关系，所以每个订单都有 user_id 但现在如果我出于任何原因有一些 user_id=0 或某些订单为空，如果我尝试使用 yii cgridview 尝试排序时会出现问题或搜索，因为没有找到用户 id=0 的另一行，任何人都可以建议我如何解决这个问题，我尝试更改连接类型，但它仅适用于内部连接，当然不会显示所有行，因为它是内部的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T16:54:08.500

您可以做的是修改模型的搜索功能以排除所有没有有效 user_id 的模型。

就像是

```
public function search(...)
{
     if ($this->user) // Points to your relation
     {
          // Search stuff here
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T12:59:46.943

这对我有用

```
array(            
              'name'=>'user_id', 
              'value'=>'(empty($data->user->user_id)) ? "" : $data->user->user_id',

            ),   // user being your relation, that code goes inside the CgridView 
```

# php - Facebook 登录错误：无法打开流：HTTP 请求失败！HTTP/1.0 400 错误请求

> ID：13440248
> 
> 赞同：9
> 
> 时间：2012-11-18T12:51:29.677
> 
> 标签：php, facebook, oauth, facebook-php-sdk, facebook-oauth

我正在尝试按照示例从[此处](https://developers.facebook.com/docs/howtos/login/server-side-login)创建到 Facebook 的服务器端登录，但没有运气。在第 7 步中，当我尝试使用令牌交换代码并将其存储在会话中以供以后使用时，我总是收到此错误：

```
 file_get_contents(): failed to open stream: HTTP request failed! HTTP/1.0 400 Bad Request 
```

我知道这已经问过很多次了，但我仍然无法解决这个问题，根据[这个问题](https://stackoverflow.com/questions/12839065/failed-to-open-stream-http-request-failed-http-1-1-400-bad-request-in)，我尝试使用 cURL，但它仍然不起作用，它只是返回 false。

[其他问题](https://stackoverflow.com/questions/12141941/function-file-get-contents-failed-to-open-stream-http-request-failed-http-1)告诉我使用 PHP SDK，但我不知道使用哪种方法。所以我完全迷失在这里。

* * *

这是我调用登录表单的代码：

```
<a href="<?php echo LOGIN_URL; ?> ?>" class="btn btn-primary">Login with Facebook</a> 
```

其中 LOGIN_URL 定义为：

```
define("LOGIN_URL", $facebook->getLoginUrl(array("redirect_uri" => APP_URL . "fb_login"))); 
```

在 fb_login 中，我有以下代码：

```
$app->get("/fb_login", function() use($app, $facebook)
{
    $code = $_REQUEST["code"];

    $token_url = "https://graph.facebook.com/oauth/access_token?"
       . "client_id=" . APP_ID . "&redirect_uri=" . APP_URL . $_SESSION["request_uri"] // Previous URL
       . "&client_secret=" . APP_SECRET . "&code=" . $code;

    $response = file_get_contents($token_url); // Doesn't work
    $params = null;
    parse_str($response, $params);

    $_SESSION["access_token"] = $params["access_token"];

    // Let's try with cURL...
    // $ch = curl_init();
    // curl_setopt($ch, CURLOPT_URL, $token_url);
    // curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    // $output = curl_exec($ch); // Returns false
    // curl_close($ch);

    $graph_url = "https://graph.facebook.com/me?access_token="
      . $params["access_token"];

    $user = json_decode(file_get_contents($graph_url));
    echo("Hello " . $user->name);

    var_dump($code); die();
}); 
```

任何帮助表示赞赏。之前谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T23:23:57.410

要直接回答这个问题，问题很可能是您没有`urlencode`（确保 URL 传输安全）重定向 URL。最快的修复将是：

```
$token_url = "https://graph.facebook.com/oauth/access_token?"
   . "client_id=" . APP_ID . "&redirect_uri=" . urlencode(APP_URL . $_SESSION["request_uri"])
   . "&client_secret=" . APP_SECRET . "&code=" . $code; 
```

但是，我还建议您查看 Facebook SDK，因为它可以为您完成这一切。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T05:53:28.170

您是否检查过 PHP SDK 上的文档...它非常广泛和不错..您只需要按以下方式设置您的 Facebook SDK

```
$facebook = new Facebook(array(
                'appId' => 'your app id',
                'secret'=> 'your app secret')); 
```

然后您可以将登录 URL 检索为

```
$loginURL = $facebook->loginUrl(array(
                'scope' => 'read_stream',
                'redirect_uri' => 'http://yourdomain/path/to/page')); 
```

此外，SDK 可能会更好地描述由它处理的错误，这可能是由于重定向 URI 与应用程序的配置不匹配或应用程序 ID 或机密或完全不同的东西错误。[从这里](https://github.com/facebook/facebook-php-sdk)下载 SDK

# jquery - 使用 Ajax 在数组中传递 Javascript 数组

> ID：13440249
> 
> 赞同：2
> 
> 时间：2012-11-18T12:51:32.173
> 
> 标签：jquery, ajax, json, tinymce

我得到了我的字段，比如带有 javascript 的数组。每个数组字段都是带有比例的数组。

例子。

```
arr[0]
{
  'id':'1',
  'title':'testtitle',
  'value': 'test value'
}
arr[1]
{
  'id':'2',
  'title':'testtitle',
  'value': 'test value'
}
arr[2]
{
  'id':'3',
  'title':'testtitle',
  'value': 'test value'
} 
```

我`JSON.stringify(arr);`用来将数组发送到 php 并读取这个数组。我的问题是，值选项是文本形式的文本区域。当我使用简单的文本时，我没有问题。但我需要使用`TinyMCE`编辑器。当我粘贴一些具有这样的html的文本时：

```
style="font-size:12px;" and other ... 
```

阵列崩溃。我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T12:56:12.317

在发送之前，先用 Base64 之类的东西对该文本区域的内容进行编码。在 PHP 中，您可以解码并再次使用它。

JS ( [`btoa()`](https://developer.mozilla.org/en-US/docs/DOM/window.btoa)):

```
arr.value = window.btoa( textareaContent ); 
```

PHP ( [`base64_decode()`](http://de1.php.net/base64_decode)):

```
$value = base64_decode( encodedString ); 
```

# android - 超过 4k 字符的 Android TTS 文本无法播放

> ID：13440251
> 
> 赞同：3
> 
> 时间：2012-11-18T12:51:50.137
> 
> 标签：android, text-to-speech, android-4.2-jelly-bean

我`TextToSpeech`有时会播放一些长文本，我注意到`Android 4.1.2`如果文本超过 4000 个字符，它就不会播放。

我没有收到任何错误，但不会播放文本。到目前为止，我能够在`Android 4.1.2`（Samsung Galaxy Nexus，Nexus7）上重现这一点。

这是一个错误`4.1.2`还是正常的（尽管我没有找到有关此行为的任何文档）？

我还发现了一个帖子：[如果收到的 TTS 太长，则 onUtteranceCompleted() 丢失，](https://stackoverflow.com/questions/6863107/onutterancecompleted-lost-if-tts-received-is-too-long)这表明超过 4000 个字符的文本存在不同的问题。

**编辑：**我试图将我的字符串拆分为 4k 长度的块，并将其发送给`TTS`using `QUEUE_ADD`，但我遇到了另一个[错误](https://stackoverflow.com/questions/13482899/android-jelly-bean-tts-queue-add-does-not-work)：`QUEUE_ADD`不起作用，而是刷新现有队列，并且只播放最后一个块。

**EDIT2**：这是我的电话`TTS`

```
mTTS.speak(longText, TextToSpeech.QUEUE_FLUSH, null); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T22:53:00.213

TtsService.java 中的 MAX_SPEECH_ITEM_CHAR_LENGTH = 4000，在 4.1 上我在代码中看到警告：

```
 @Override
    public boolean isValid() {
        if (mText == null) {
            Log.wtf(TAG, "Got null text");
            return false;
        }
        if (mText.length() >= MAX_SPEECH_ITEM_CHAR_LENGTH) {
            Log.w(TAG, "Text too long: " + mText.length() + " chars");
            return false;
        }
        return true;
    } 
```

看起来像 2.3 拆分了文本，所以理论上你的代码应该在 android < 4.1 上运行而不是更新（我不知道拆分何时被删除），相反你有相反的 :) 这有点奇怪

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T13:30:59.017

我的解决方案是用来[`onUtteranceCompleted(String utteranceId)`](http://developer.android.com/reference/android/speech/tts/TextToSpeech.OnUtteranceCompletedListener.html)知道第一个块何时完成，然后将下一个块提供给它们，`TextToSpeech`直到它们全部完成。

```
@Override
public void onInit(int status) { //On TTS init
    //guava Splitter
    mChunks=Lists.newLinkedList(Splitter.fixedLength(3999).split(mExtractedText));
    mTTS.setOnUtteranceCompletedListener(this);
    playNextChunk();
}

private void playNextChunk(){
    HashMap<String, String> params = new HashMap<String, String>();
    params.put(TextToSpeech.Engine.KEY_PARAM_UTTERANCE_ID, ""+mChunks.size());
    mTTS.speak(mChunks.poll(), TextToSpeech.QUEUE_FLUSH, params);
}

@Override
public void onUtteranceCompleted(String utteranceId) {
    playNextChunk();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-11T11:18:34.400

在 4.4.2 上没问题...我这样拆分字符串...

```
//textToSpeech can only cope with Strings with < 4000 characters
int dividerLimit = 3900;
if(textForReading.length() >= dividerLimit) {
    int textLength = textForReading.length();
    ArrayList<String> texts = new ArrayList<String>();
    int count = textLength / dividerLimit + ((textLength % dividerLimit == 0) ? 0 : 1);
    int start = 0;
    int end = textForReading.indexOf(" ", dividerLimit);
    for(int i = 1; i<=count; i++) {
        texts.add(textForReading.substring(start, end));
        start = end;
        if((start + dividerLimit) < textLength) {
            end = textForReading.indexOf(" ", start + dividerLimit);
        } else {
            end = textLength;
        }
    }
    for(int i=0; i<texts.size(); i++) {
        textToSpeech.speak(texts.get(i), TextToSpeech.QUEUE_ADD, null);
    }
} else {
    textToSpeech.speak(textForReading, TextToSpeech.QUEUE_FLUSH, null);
} 
```

# php - 如何使用PHP计算文件夹内的文件？

> ID：13440252
> 
> 赞同：2
> 
> 时间：2012-11-18T12:51:50.750
> 
> 标签：php, dir, subdirectory

以下代码计算文件夹内的文件数。

```
<?php
function folderlist(){
  $directoryist = array();
$startdir = './';
//get all image files with a .jpg extension.
  $ignoredDirectory[] = '.';
  $ignoredDirectory[] = '..';
   if (is_dir($startdir)){
       if ($dh = opendir($startdir)){
           while (($folder = readdir($dh)) !== false){
               if (!(array_search($folder,$ignoredDirectory) > -1)){
                 if (filetype($startdir . $folder) == "dir"){
                       $directorylist[$startdir . $folder]['name'] = $folder;
                       $directorylist[$startdir . $folder]['path'] = $startdir;
                   }
               }
           }
           closedir($dh);
       }
   }
return($directorylist);
}

$folders = folderlist();

$total_files = 0;
foreach ($folders as $folder){
    $path = $folder['path'];
    $name = $folder['name'];
    $count = iterator_count(new DirectoryIterator($path . $name));
    $total_files += $count;

    echo '<li>';
    echo '<a href="' .$path .'index.php?album=' .$name . '" class="style1">';
    echo '<strong>' . $name . '</strong>';
    echo ' (' . $count . ' files found)';
    echo '</a>';
    echo '</li>';
}
  echo "Total Files:". $total_files;
?> 
```

但是由于某种原因，计数减少了 2。我有一个包含 13 个文件的文件夹，但此代码返回计数为 15。对于空文件夹，这返回计数 2。

有人可以指出上述代码段的问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T13:21:09.197

我正在使用[DirectoryIterator](http://lv1.php.net/manual/en/class.directoryiterator.php)

```
$files_in_directory = new DirectoryIterator($path_to_folder);
$c = 0;

foreach($files_in_directory as $file)
{
    // We want only files
    if($file->isDot()) continue;
    if($file->isDir()) continue;
    $c++;
}

var_dump($c); 
```

用作函数：

```
function folderlist($directories = array(), $extensions = array())
{
    if(empty($directories))
        return false;

    $result      = array();
    $total_count = 0;
    foreach($directories as $directory)
    {
        $files_in_directory = new DirectoryIterator($directory);
        $c                  = 0;

        foreach($files_in_directory as $file)
        {
            // We want only files
            if($file->isDot()) continue;
            if($file->isDir()) continue;

            // This is for php < 5.3.6
            $file_extension = pathinfo($file->getFilename(), PATHINFO_EXTENSION);

            // If you have php >= 5.3.6 you can use following instead
            // $file_extension = $fileinfo->getExtension()

            if(in_array($file_extension, $extensions)){
                $c++;
                $result['directories'][$directory]['files'][$c]['name'] = $file->getFilename();
                $result['directories'][$directory]['files'][$c]['path'] = $file->getPath();
                $result['directories'][$directory]['count']             = $c;
            }     
        }
        $total_count += $c;    
    }

    $result['total_count'] = $total_count;

    return $result;    

} 
```

基于 GET 超全局显示结果：

```
if(isset($_GET['album']) && !empty($_GET['album']) && !isset($_GET['listfiles']))
    {
        // We are in directory view mode
        $album = $_GET['album'];

        // View all directories and their file count for specified album
        $view_directory = folderlist(array($album), array('jpeg', 'jpg', 'log'));

        // Loop the folders and display them with file count
        foreach ($view_directory['directories'] as $folder_name => $folder_files){

            $count = $folder_files['count'];
            echo '<li>';
            echo '<a href="files.php?album=' . $folder_name . '&listfiles=1" class="style1">';
            echo '<strong>' . basename($folder_name) . '</strong>';
            echo ' (' . $count . ' files found)';
            echo '</a>';
            echo '</li>';  

        }

        echo "Total Files:". $get_dir_info['total_count'];   

    }
    elseif(isset($_GET['album'], $_GET['listfiles']) && !empty($_GET['album']))
    {
        // We are in file view mode for folder
        $album = $_GET['album'];

        // View all files in directory
        $view_files = folderlist(array($album), array('jpeg', 'jpg', 'log'));   

        echo 'Showing folder content of: <b>'.basename($album).'</b>';
        foreach($view_files['directories'][$album]['files'] as $file)
        {     

            $path = $file['path'];
            $name = $file['name'];

            echo '<li>';
            echo '<a href="files.php?file=' . $name . '&path=' . $path . '" class="style1">';
            echo '<strong>' . $name . '</strong>';
            echo '</a>';
            echo '</li>';   
        } 
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T12:56:49.843

此行仍在返回“。” 和 '..' 变量。

```
if (!(array_search($folder,$ignoredDirectory) > -1)) 
```

见： http: [//php.net/manual/en/language.types.boolean.php](http://php.net/manual/en/language.types.boolean.php)

尝试

```
if (!array_search($folder,$ignoredDirectory)) 
```

编辑：

也改变这个：

```
$ignoredDirectory[] = '.';
$ignoredDirectory[] = '..'; 
```

至

$ignoredDirectory = array('.', '..');

# php - 从php中的数组键中提取部分并将它们组合起来

> ID：13440260
> 
> 赞同：0
> 
> 时间：2012-11-18T12:52:22.527
> 
> 标签：php, arrays

我也有类似的问题。我有一个数组，我需要从数组的键中提取部分并将它们组合起来。你能建议最好的方法吗？

```
$myarray=Array(
[0]=>'unwanted text'

[1]=>'unwanted+needed part1'

[2]=>'needed part2'

[3]=>'needed part3'

[4]=>'unwanted text'

) 
```

我怎样才能只提取需要的部分并将它们组合起来。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T12:59:09.640

不完全确定这是否符合您的要求，但是循环和复制到新数组应该基本上可以实现您的结果（一旦您阐明如何决定需要或不需要哪些部分字符串）

```
$myarray = array(…);
$new_array = array();
$unwanted = 'some_string';
foreach($myarray as $k => $v) {
  $new_value = preg_replace("/^$unwanted/", '', $v); # replace unwanted parts with empty string (removes them);
  if(!empty($new_value)) { # did we just remove the entry completely? if so, don't append it to the new array
    $new_array[] = $v; # or $new_array[$k] if you want to keep indices.
  }
} 
```

假设您要连接数组条目并获得一个字符串作为结果，请使用[`implode`](http://php.net/implode)PHP 的函数：`$string = implode(' ', $new_array);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T12:56:03.703

根据您想要执行的操作，您所追求的功能将是以下各项的组合：`array_splice`、`array_flip`、`array_combine`。

**array_splice()** 允许您通过键偏移量提取数组的一部分。它将从源中永久删除元素，并在新数组中返回这些元素

**array_flip()** 将键转换为值，将值转换为键。如果您有多个相同的值，则最后一个具有优先权。

**array_combine()**接受两个参数：一个键数组和一个值数组，并返回一个关联数组。

不过，您需要提供有关您想要做什么的更多信息，以便我的回答更具体。

# javascript - 在 Javascript 中将 ASCII 范围之外的字符编码为相应 %uxxxx 的最快方法

> ID：13440262
> 
> 赞同：0
> 
> 时间：2012-11-18T12:52:35.350
> 
> 标签：javascript, unicode, encode

在 Javascript 中，将 ASCII 范围之外的 unicode 字符编码为它们各自的 %uxxxx 的最快方法是什么。我需要使用此方法对数百 KB 的数据进行编码（此数据中 ASCII 范围之外的 unicode 字符数相当少）。我目前一直在使用“转义”，但考虑到它还编码许多其他字符而不仅仅是非 ASCII，这非常慢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:42:11.417

`escape`是本机代码。用 JS 编写的代码没有什么能比得上...

# php - 如何检测视图中的上下文

> ID：13440266
> 
> 赞同：0
> 
> 时间：2012-11-18T12:53:25.000
> 
> 标签：php

我的视图有简单的模板系统，例如：

```
<h2>%var1%</h2> 
```

当我想要转义变量时，我使用过滤器：

```
<h2>%var1|html%</h2> 
```

但我想写“系统”来检测当前变量的上下文。系统将根据当前上下文返回 html、xml、css 或其他，并且变量将被正确转义。

你能帮我从哪里开始吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:13:39.903

这可能是一篇不错的博客文章：[Context-aware HTML escaping](http://php.vrana.cz/context-aware-html-escaping.php) Nette 是迄今为止支持[Context-aware HTML escaping的一个框架](http://doc.nette.org/en/templating#toc-context-aware-escaping)

# python - 解析这些数据和舍入数字的建议

> ID：13440269
> 
> 赞同：-1
> 
> 时间：2012-11-18T12:53:59.303
> 
> 标签：python, rounding

我在一个文本文件中有一些数据，我使用正则表达式解析文件中的数据并将数字和索引存储在两个变量中。我想将数字四舍五入到相同的小数位并将其写入一个新文件（索引为 A、B、C）

本组数据均为小数点后3位

11,000.233

乙 4.000

C 14,798.241

另一组数据在小数点后2位

11,000.23

乙 4.00

C 14,798.24

当我使用 readlines() 阅读它们时，它们最初都是字符串格式

但是当我将第一组数据中的字符串转换为浮点数，然后使用 str(round(float(number),2)) 将其从小数点后 3 位舍入到小数点后 2 位

我遇到了两个问题

1.  它会给我 A (11,000.233) 和 C (14,798.241) 的 ValueError

    我知道这是由11,000.23 中的**,​​ 引起的。**但我不知道如何处理它。有人能给我一些关于如何处理它的建议吗？

2.  对于 B，当我尝试用相同的方法转换数字时，它给了我 4.0 而不是 4.00。反正有没有可以输出 4.00 而不是 4.0 的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:02:31.940

1.  使用字符串`replace()`方法删除`,`之前使用的`float()`.

    ```
    float("1,123.4567".replace(",", "")) 
    ```

2.  使用 string`format()`方法更改浮点数的字符串表示。

    ```
    format(4.0, ".2f") 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T13:00:37.950

拆分字符串`","`并使用`"".join()`：

```
In [32]: strs="11,000.233"

In [33]: float("".join(strs.split(",")))
Out[33]: 11000.233

In [34]: strs="14,798.24"

In [35]: float("".join(strs.split(",")))
Out[35]: 14798.24 
```

您可以使用字符串格式来获取`4.00`：

```
In [36]: strs="4.00"

In [37]: float(strs)
Out[37]: 4.0

In [39]: format(float(strs),".2f")
Out[39]: '4.00'

In [40]: "{0:.2f}".format(float(strs))
Out[40]: '4.00' 
```

# android - 我需要使用哪个意图标志，以便当我按下后我不再看到该活动？

> ID：13440270
> 
> 赞同：2
> 
> 时间：2012-11-18T12:54:05.670
> 
> 标签：android

我有一个活动会导致另一个活动。我想做到这一点，以便第一个活动一旦指向另一个活动就不会再次打开

clear_top 不起作用。需要哪个标志？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:33:07.120

这将启动一个包含新信息且没有历史记录的活动

```
Intent intent = new Intent(MainActivity.this, TargetActivity.class);
intent.setAction(Intent.ACTION_VIEW);
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
intent.setFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT);
MainActivity.startActivity(intent); 
```

供您参考，您可以阅读 android 文档：[单击此处](http://developer.android.com/reference/android/content/Intent.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T13:15:58.887

您还可以`android:noHistory="true"`用于 AndroidManifest.xml 中的第一个活动。不需要意图标志。

[http://developer.android.com/guide/topics/manifest/activity-element.html#nohist](http://developer.android.com/guide/topics/manifest/activity-element.html#nohist)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T13:19:22.410

您可以在致电后`finish()`第一次`Activity`致电`startActivity(...)`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-18T13:04:12.057

```
i = new Intent(HomeActivity.this, LoginActivity.class);
i.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP); 
```

那应该这样做。

# c++ - 如何在 C++ 控制台中删除已写入的字符

> ID：13440272
> 
> 赞同：6
> 
> 时间：2012-11-18T12:54:11.563
> 
> 标签：c++

我正在尝试制作一个 C++ 程序来读取密码。我将程序制作为 cout `*`，而不是我写的字符，但我的问题是当我想删除字符时，因为它们是错误的。
**示例：** 我的固定密码是`12345`
如果我进入`1235` 程序将显示`****`，我必须删除最后一个字符。将其从字符串中删除很简单，但我希望最后一个`*`从控制台中消失，就像您介绍 Windows 密码时一样。
可能吗？如果是，有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-18T12:59:59.867

输出退格字符 '\b' 可能有助于将输出点向后移动。

具体来说，输出字符串 "\b \b" 应该清除最后一个字符输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-01T10:18:28.483

```
printf("\b "); 
```

该语句肯定有效，因为在光标返回一个字符后，上面**printf**语句中给出的空格将覆盖控制台输出上的打印字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-10T11:21:53.870

当我使用 putch 函数（来自 conio.h ）写信给控制台来模拟退格键时

```
std::cout << '\b'; 
```

或者

```
printf("\b "); 
```

不工作我必须写：

```
cout << '\b' << " " << '\b'; 
```

或者

```
putch('\b');
putch(' ');
putch('\b'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-18T12:58:43.677

尝试退格 \b 或删除整行并再次打印。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-18T13:07:20.370

简单地将`'\b'`字符写入 stdout `std::cout<<"\b"`。如果您使用 cpp 或`printf("\b")`纯 C

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-17T00:08:37.323

我最近遇到了同样的事情，使用`\b`was** 将光标向后移动** 但它没有删除 char （或 * ）。我意识到之后您输入的下一个字符`\b`将替换（要删除的字符）。所以，我想出了这样的事情

```
printf(“\b \b”); 
```

使用`space key`after`\b`将替换要删除的字符，然后再次使用 the`\b`将使您再次回到一个位置（到错误字符所在的位置，但这次字符将不存在）这样您的输出看起来会很流畅。希望对你有帮助

# php - 复制内容文件 php 另一个文件 php 替换标题

> ID：13440279
> 
> 赞同：-1
> 
> 时间：2012-11-18T12:54:41.040
> 
> 标签：php

> **可能重复：**
> [将文件从一个目录复制到另一个目录](https://stackoverflow.com/questions/3616602/copy-a-file-from-one-dir-to-another-dir)

我想从 php 文件中的本地内容复制并将其复制到另一个文件，然后再复制 php 并使特定内容替换 php 文件。我执行以下操作：

```
chmod ('../archivo.php',0777);
$archivo= fopen("../archivo.php" , "r"); 
$get=file_get_contents($archivo);
$nuevoarchivo = fopen('../new-archivo.php', "w+");
fwrite($nuevoarchivo,$get);
fclose($nuevoarchivo); 
```

但是不要复制任何东西我怎么能？非常感谢并拥抱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:00:46.543

不要混用`file_get_contents`和`fopen`。

```
// Read file content
$file_content = file_get_contents('../archivo.php');

// do the replacements, modifications, etc. on $file_content
// This is just an example
$file_content = str_replace('old_title', 'new_title', $file_content);

// write the content to a new file
file_put_contents('../new-archivo.php', $file_content); 
```

另外，您能否更具体地说明要替换的内容？

# sql - 协助查询 SQL Server 2012 中的实体属性值模型（“动态属性”）

> ID：13440285
> 
> 赞同：0
> 
> 时间：2012-11-18T12:56:06.463
> 
> 标签：sql, tsql, sql-server-2012, entity-attribute-value, sql-tuning

我需要帮助来从包含一个特定对象（即产品）表和一个动态属性表的模型中查询。

假设我可以存储带有`Chocolate`, 等属性的 a ，也可以存储带有`Price`, `Color`,等属性`Weight`的 a 。 `Car``Engine``Gears``Color`

在我的示例中，我有一个名为 Products 的表，其中包含以下列：

```
 Id (Int),   
 Name (NVarchar) 
```

我有另一个名为`dynamicAttributes`以下列的表：

```
Id (int)               -- of the attribute
ProductId (int)        -- of the specific product
AttributeType (int)    -- enum with the following values ("Color", "Price","Height", "Width".... )
StringValue -- of the product
IntValue -- of the product
DoubleValue -- of the product
BooleanValue -- of the product 
```

我从客户那里得到一个属性代码列表和一个值列表。

我可以获取每个属性的值类型（又名布尔、字符串、整数）。

从我的应用程序查询此模型的最佳选择是什么？

仅动态 sql 吗？使用 Pivot 关键字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T21:42:49.923

正如其他人所指出的，执行大量 PIVOT 查询效率非常低，并且编写和调试使用 PIVOT 的 SQL 查询很费力。

另一种方法是以数据的存储方式从数据库中取回数据，即多行。然后在您的数据库访问层中编写代码以将行按摩到单个对象实例中，为每个数据库行的对象添加一个属性。这在 Martin Fowler 的《企业应用程序架构模式》一书中称为[表模块模式。](http://martinfowler.com/eaaCatalog/tableModule.html)

如果您花一些时间以可重用的方式编写 DBAL 代码，您可以让应用程序中的后续代码非常容易地读取和保存存储在 EAV 表中的对象。

但是，是的，我同意其他评论者的观点。 [我一般反对使用 EAV 设计](http://karwin.blogspot.com/2009/05/eav-fail.html)。编写代码以弥补 EAV 破坏数据库约定的方式需要大量工作。我认为你有更好的事情来处理你的时间！

有关替代方案，请参阅：

*   [我对如何为多种产品设计产品表的](https://stackoverflow.com/questions/695752/product-table-many-kinds-of-product-each-product-has-many-parameters/695860#695860)回答，其中每种产品都有很多参数

*   我的演讲[SQL 中的实用面向对象模型](http://www.slideshare.net/billkarwin/practical-object-oriented-models-in-sql)

*   我的书[SQL 反模式：避免数据库编程的陷阱](http://pragprog.com/book/bksqla/sql-antipatterns)

# c++ - 光线追踪三角形网格物体

> ID：13440291
> 
> 赞同：3
> 
> 时间：2012-11-18T12:56:44.497
> 
> 标签：c++, geometry, raytracing

我正在尝试为任何由三角形网格形成的对象编写光线追踪器。我正在使用外部库从 .ply 格式加载多维数据集，然后对其进行跟踪。到目前为止，我已经实现了大部分跟踪器，现在我尝试用单个立方体对其进行测试，但由于某种原因，我在屏幕上看到的只是一条红线。我已经尝试了几种方法来修复它，但我根本无法弄清楚。对于这个主要测试，我只创建主要光线，如果它们击中我的立方体，然后我将该像素着色为立方体的漫反射颜色并返回。为了检查射线与对象的交点，我将遍历所有形成该对象的三角形并将距离返回到最近的那个。如果您可以查看代码并告诉我可能出了什么问题以及在哪里出错，那就太好了。我将不胜感激。

射线三角交点：

```
bool intersectTri(const Vec3D& ray_origin, const Vec3D& ray_direction, const Vec3D& v0, const Vec3D& v1, const Vec3D& v2, double &t, double &u, double &v) const
    {

        Vec3D edge1 = v1 - v0;  
        Vec3D edge2 = v2 - v0;
        Vec3D pvec = ray_direction.cross(edge2);
        double det = edge1.dot(pvec);
        if (det > - THRESHOLD && det < THRESHOLD)
            return false;
        double invDet = 1/det;  
        Vec3D tvec = ray_origin - v0;
        u = tvec.dot(pvec)*invDet;
        if (u < 0 || u > 1)
            return false;
        Vec3D qvec = tvec.cross(edge1);
        v = ray_direction.dot(qvec)*invDet;
        if (v < 0 || u + v > 1)
            return false;
        t = edge2.dot(qvec)*invDet;
        if (t < 0)
            return false;
        return true;
    }   

//Object intersection
bool intersect(const Vec3D& ray_origin, const Vec3D& ray_direction, IntersectionData& idata, bool enforce_max) const
    {

        double tClosest;
        if (enforce_max)
        {
            tClosest = idata.t;
        }
        else
        {
            tClosest = TMAX;
        }

        for (int i = 0 ; i < indices.size() ; i++)
        {
            const Vec3D v0 = vertices[indices[i][0]];
            const Vec3D v1 = vertices[indices[i][1]];
            const Vec3D v2 = vertices[indices[i][2]];
            double t, u, v;
            if (intersectTri(ray_origin, ray_direction, v0, v1, v2, t, u, v))
            {
                if (t < tClosest)   
                {
                    idata.t = t;
                    tClosest = t;                   
                    idata.u = u;
                    idata.v = v; 
                    idata.index = i;
                }
            }
        }
        return (tClosest < TMAX && tClosest > 0) ? true : false;
    }

Vec3D trace(World world, Vec3D &ray_origin, Vec3D &ray_direction)
{

Vec3D objColor = world.background_color;
IntersectionData idata;
double coeff = 1.0;
int depth = 0;

double tClosest = TMAX; 
Object *hitObject = NULL;   
for (unsigned int i = 0 ; i < world.objs.size() ; i++)
{       
    IntersectionData idata_curr;
    if (world.objs[i].intersect(ray_origin, ray_direction, idata_curr, false)) 
    {
        if (idata_curr.t < tClosest && idata_curr.t > 0) 
        {
            idata.t = idata_curr.t;
            idata.u = idata_curr.u;
            idata.v = idata_curr.v;
            idata.index = idata_curr.index; 
            tClosest = idata_curr.t;            
            hitObject = &(world.objs[i]);
        }
    }
}
if (hitObject == NULL)
{
    return world.background_color;
}
else
{
    return hitObject->getDiffuse();
}
}

int main(int argc, char** argv)
{

parse("cube.ply");
Vec3D diffusion1(1, 0, 0);
Vec3D specular1(1, 1, 1);
Object cube1(coordinates, connected_vertices, diffusion1, specular1, 0, 0);
World wrld;
// Add objects to the world
wrld.objs.push_back(cube1);
Vec3D background(0, 0, 0);
wrld.background_color = background;
// Set light color
Vec3D light_clr(1, 1, 1);
wrld.light_colors.push_back(light_clr);
// Set light position
Vec3D light(0, 64, -10);
wrld.light_positions.push_back(light);

int width = 128;
int height = 128;
Vec3D *image = new Vec3D[width*height];
Vec3D *pixel = image;

// Trace rays
for (int y = -height/2 ; y < height/2 ; ++y)
{
    for (int x = -width/2 ; x < width/2 ; ++x, ++pixel)
    {
        Vec3D ray_dir(x+0.5, y+0.5, -1.0);
        ray_dir.normalize();
        Vec3D ray_orig(0.5*width, 0.5*height, 0.0);
        *pixel = trace(wrld, ray_orig, ray_dir);        
    }
}   

savePPM("./test.ppm", image, width, height);
return 0; 
} 
```

我刚刚运行了一个测试用例，我得到了这个：

[![](../Images/1c3366ee2c79e29afa3724c1e6efb189.png)](http://s17.postimage.org/71y7pt60v/test.png)

对于一个以 (0,0, -1.5) 为中心并在 X 和 Y 轴上按 100 缩放的单位立方体。投影似乎有问题，但我无法从结果中准确判断出什么。此外，在这种情况下（立方体以 (0,0) 为中心），最终对象不应该也出现在图片中间吗？修复：我通过在规范化和调用跟踪函数之前执行 ray_dir = ray_dir - ray_orig 解决了居中问题。不过，这种观点似乎是完全错误的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:20:45.767

我继续工作，现在我开始根据 Phong 实现漫反射。

Vec3D trace(World world, Vec3D &ray_origin, Vec3D &ray_direction) {

```
Vec3D objColor = Vec3D(0);
IntersectionData idata;
double coeff = 1.0;
int depth = 0;
do
{
    double tClosest = TMAX; 
    Object *hitObject = NULL;   
    for (unsigned int i = 0 ; i < world.objs.size() ; i++)
    {       
        IntersectionData idata_curr;
        if (world.objs[i].intersect(ray_origin, ray_direction, idata_curr, false)) 
        {
            if (idata_curr.t < tClosest && idata_curr.t > 0) 
            {
                idata.t = idata_curr.t;
                idata.u = idata_curr.u;
                idata.v = idata_curr.v;
                idata.index = idata_curr.index; 
                tClosest = idata_curr.t;            
                hitObject = &(world.objs[i]);
            }
        }
    }   
    if (hitObject == NULL)
    {
        return world.background_color;
    }

    Vec3D newStart = ray_origin + ray_direction*idata.t;

    // Compute normal at intersection by interpolating vertex normals (PHONG Idea)
    Vec3D v0 = hitObject->getVertices()[hitObject->getIndices()[idata.index][0]];
    Vec3D v1 = hitObject->getVertices()[hitObject->getIndices()[idata.index][1]];
    Vec3D v2 = hitObject->getVertices()[hitObject->getIndices()[idata.index][2]];   

    Vec3D n1 = hitObject->getNormals()[hitObject->getIndices()[idata.index][0]];
    Vec3D n2 = hitObject->getNormals()[hitObject->getIndices()[idata.index][1]];
    Vec3D n3 = hitObject->getNormals()[hitObject->getIndices()[idata.index][2]];

//  Vec3D N = n1 + (n2 - n1)*idata.u + (n3 - n1)*idata.v;
    Vec3D N = v0.computeFaceNrm(v1, v2);
    if (ray_direction.dot(N) > 0)
    {
        N = N*(-1);
    }
    N.normalize();

    Vec3D lightray_origin = newStart;

    for (unsigned int itr = 0 ; itr < world.light_positions.size() ; itr++)
    {

        Vec3D lightray_dir = world.light_positions[0] - newStart;
        lightray_dir.normalize();

        double cos_theta = max(N.dot(lightray_dir), 0.0);
        objColor.setX(objColor.getX() + hitObject->getDiffuse().getX()*hitObject->getDiffuseReflection()*cos_theta);
        objColor.setY(objColor.getY() + hitObject->getDiffuse().getY()*hitObject->getDiffuseReflection()*cos_theta);
        objColor.setZ(objColor.getZ() + hitObject->getDiffuse().getZ()*hitObject->getDiffuseReflection()*cos_theta);
        return objColor;
    }

    depth++;

} while(coeff > 0 && depth < MAX_RAY_DEPTH);
return objColor; 
```

}

当我用主光线到达一个物体时，我向位于 (0,0,0) 处的光源发送另一条光线，并根据 Phong 照明模型返回颜色进行漫反射，但结果确实不是预期的：[http](http://s15.postimage.org/vc6uyyssr/test.png) ://s15.postimage.org/vc6uyyssr/test.png 。立方体是一个以 (0,0,0) 为中心然后平移 (1.5, -1.5, -1.5) 的单位立方体。从我的角度来看，立方体的左侧应该得到更多的光线，而且确实如此。你怎么看呢？

# python - 如何使用 Python 执行 x-http 请求（客户端）

> ID：13440292
> 
> 赞同：0
> 
> 时间：2012-11-18T12:56:47.430
> 
> 标签：python

我正在尝试使用 Python 重现使用 Charles（Web 调试代理）捕获的 x-http 请求，但我找不到任何文档（或者不知道要查找什么或在哪里查找）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:13:53.113

我会为此使用该[`requests`库](https://requests.readthedocs.io/en/latest/)，因为它使此类任务更容易。

您捕获的请求似乎正在发布 JSON 数据，尽管`text/javascript`内容类型为：

```
import requests
import json

headers = {'Content-Type': 'text/javascript;charset=utf-8')
data = json.dumps({'mod': 'calendar.field', 'action': 'mini', 'vars': {"current": 0}})
r = requests.post('http://www.kavka.be/xhttp.mod', data=data, headers=headers) 
```

其中`data`是从与您的代理捕获的 POST 相同的信息创建的 JSON 字符串。

或者，如果您只想使用标准库，请使用[`urllib2`](http://docs.python.org/2/library/urllib2.html)：

```
import urllib2
import json

headers = {'Content-Type': 'text/javascript;charset=utf-8')
data = json.dumps({'mod': 'calendar.field', 'action': 'mini', 'vars': {"current": 0}})
req = urllib2.Request('http://www.kavka.be/xhttp.mod', data, headers)
r = urllib2.urlopen(req) 
```

# django - Django-如何使用带有电子邮件而不是用户名的内置登录视图？

> ID：13440298
> 
> 赞同：8
> 
> 时间：2012-11-18T12:56:58.783
> 
> 标签：django, django-authentication, django-registration, django-login

我在我的应用程序中使用内置登录。有一些自定义后端或包来处理这个问题。但其中许多不是我想要的。

我在注册时通过 django-registration 使电子邮件独一无二。现在我只想在登录页面而不是用户名中询问电子邮件。

但如果我使用一些自定义后端（如[django 电子邮件）作为用户名](https://github.com/dabapps/django-email-as-username)，它在与 django-registration 一起使用时会崩溃。

我不想更改所有身份验证后端，我只想更改登录页面。

在站点的其余部分，我将使用用户名。pe 在我的自定义管理页面中，当我写：

```
welcome {{user}} 
```

它必须呈现用户名。不是电子邮件。

我需要找到解决办法。我被困住了。

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-18T14:23:46.480

默认情况下`django.contrib.auth.urls`将从此模式创建一个登录页面

```
(r'^login/$', 'django.contrib.auth.views.login'), 
```

您需要避免/覆盖此 url，然后创建一个新视图来处理新类型的登录。

例如

在 urls.py 中创建一个新的登录 url

```
(r'^emaillogin/$', 'email_login_view'), 
```

在views.py中创建视图以支持使用电子邮件登录

```
# get default authenticate backend
from django.contrib.auth import authenticate, login
from django.contrib.auth.models import User

# create a function to resolve email to username
def get_user(email):
    try:
        return User.objects.get(email=email.lower())
    except User.DoesNotExist:
        return None

# create a view that authenticate user with email
def email_login_view(request):
    email = request.POST['email']
    password = request.POST['password']
    username = get_user(email)
    user = authenticate(username=username, password=password)
    if user is not None:
        if user.is_active:
            login(request, user)
            # Redirect to a success page.
        else:
            # Return a 'disabled account' error message
    else:
        # Return an 'invalid login' error message. 
```

参考：[https ://docs.djangoproject.com/en/1.4/topics/auth/#django.contrib.auth.login](https://docs.djangoproject.com/en/1.4/topics/auth/#django.contrib.auth.login)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-30T12:31:26.390

上述方法在 django 1.9 上不再适用。另一种方法可能是将视图中使用的身份验证表单覆盖为：

```
class EmailLoginForm(AuthenticationForm):
def clean(self):
    try:
        self.cleaned_data["username"] = get_user_model().objects.get(email=self.data["username"])
    except ObjectDoesNotExist:
        self.cleaned_data["username"] = "a_username_that_do_not_exists_anywhere_in_the_site"
    return super(EmailLoginForm, self).clean() 
```

然后在定义登录url时，定义如下：

```
url(r'^login/$', django.contrib.auth.views.login, name="login", kwargs={"authentication_form": EmailLoginForm}),
url(r'^', include('django.contrib.auth.urls')), 
```

上述方法最好的一点是，您在身份验证过程中并没有真正触及任何东西。这不是一个真正的“干净”解决方案，但它是一个快速的解决方法。当您在包含 auth.urls 之前定义登录路径时，它将被评估而不是基本登录表单

# android - 如何与列表中的一行中的对象进行交互

> ID：13440302
> 
> 赞同：2
> 
> 时间：2012-11-18T12:57:14.530
> 
> 标签：android, list, textview

我的应用程序中有一个列表。列表中的每一行都有一个图像和一个 textView。

当单击相应的行时，我希望 textView 向右移动。

我怎样才能“得到”里面的textView `"setOnItemClickListener"`？

这是我的适配器：

```
public class MyAdapter extends ArrayAdapter<String> {
private final Context context;
private final String[] values;
private TextView textView;
private ImageView icon;
public boolean first;

public MyAdapter(Context context, String[] values) {
    super(context, R.layout.rowlayout, values);
    this.context = context;
    this.values = values;
    this.first = true;
}

@SuppressWarnings("deprecation")
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    LayoutInflater inflater = (LayoutInflater) context
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    View rowView = inflater.inflate(R.layout.rowlayout, parent, false);
    textView = (TextView) rowView.findViewById(R.id.row_text_view);
    icon = (ImageView) rowView.findViewById(R.id.icon);
    if (first) {
        rowView.setBackgroundColor(Color.TRANSPARENT);
        textView.setBackgroundColor(Color.TRANSPARENT);
        icon.setBackgroundColor(Color.TRANSPARENT);
        first = false;
        rowView.setClickable(false);
        rowView.setEnabled(false);
    } else {
        rowView.setBackgroundColor(Color.WHITE);
        textView.setBackgroundColor(Color.WHITE);
        icon.setBackgroundDrawable(context.getResources().getDrawable(R.drawable.ic_launcher));
    }
    textView.setText(values[position]);

    return rowView;
}} 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T13:23:21.890

`OnItemClickListener`具有以下签名的方法：

```
onItemClick(AdapterView<?> parent, View view, int position, long id) 
```

所以你点击了行用户。您现在可以从行中获取文本视图：

```
view.findViewById(R.id.row_text_view)`. 
```

# iphone - AVAudioPlayer 是从磁盘流式传输文件，还是一次将其全部加载到内存中？

> ID：13440304
> 
> 赞同：0
> 
> 时间：2012-11-18T12:58:04.093
> 
> 标签：iphone, ios, ipad, avfoundation, avaudioplayer

我想播放长达一小时的很长的音频文件。AVAudioPlayer 似乎是最简单的解决方案。但它是否也很有效，还是在播放之前将整个文件加载到内存中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:05:41.027

苹果的[AVAudioPlayer](http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVAudioPlayerClassReference/Reference/Reference.html)文档说：

> AVAudioPlayer 类的一个实例，称为音频播放器，提供文件或内存中音频数据的播放。
> 
> Apple 建议您将此类用于音频播放，除非您正在播放从网络流中捕获的音频或需要非常低的 I/O 延迟。

# .net - GroupBy 和 Select 语法选项

> ID：13440306
> 
> 赞同：0
> 
> 时间：2012-11-18T12:58:33.290
> 
> 标签：.net, linq, entity-framework, entity-framework-4

查看下面的代码，我想按客户 ID 汇总/分组查询结果，其中客户 ID 列旁边的销售和收据列的总和。

```
var sales = from s in context.Sales
            select new { id = s.CustomerID, sales = s.Amount, receipts = (decimal)0 };

var receipts = from r in context.Receipts
            select new { id = r.CustomerID, sales = (decimal)0, receipts = r.Amount };

var summary = sales.Union(receipts).ToList(); 
```

我尝试使用以下组合来实现相同的目的：

```
var summary = sales.Union(receipts).GroupBy(e=>e.id).Select( ... ) 
```

……但无济于事。

期待获得正确的相关语法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T17:33:29.683

试试这个

```
 var salesAndreceipts = from data in context.Receipts
                               join data2 in context.Receipts on data.CustomerID on data2.CustomerID
                               select new { id = r.CustomerID, sales = data.Sales, receipts = data2.Amount }; 
```

**更新** 从销售和收据中获取数据后，请尝试以下操作：

```
 var salesAndReceipts = sales.Union(receipts).ToList(); 

        var groupedData = from data in salesAndreceipts
                          group data by new {id=data.CustomerID}
                              into SalesRecepientGroup
                              Select new
                              {
                                  id = SalesRecepientGroup.Key.CustomerID,
                                  sales = SalesRecepientGroup.Sum(x=>x.Sales),
                                  receipts = SalesRecepientGroup.Sum(x=>x.Amount)

                              }; 
```

希望这可以帮助.. ：）

**更新**

然后，您可以检查它在 EFProfiler 下生成的查询并优化这些查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:19:51.313

你很接近，尽管我们必须猜测`Select( ... )`里面有什么。你可以这样做：

```
summary
    .GroupBy(s => s.id)
    .Select(g => new { id = g.Key,
                       salesSum = g.Sum(x => x.sales), 
                       receiptsSum = g.Sum(x => x.receipts)
                     }) 
```

# javascript - 如何从一个文本框计算值并使用 jquery 将其设置到另一个文本框

> ID：13440307
> 
> 赞同：0
> 
> 时间：2012-11-18T12:58:34.230
> 
> 标签：javascript, jquery, ajax, struts2

> **可能重复：**
> [无法使用 jQuery 获取文本字段值](https://stackoverflow.com/questions/13438570/unable-to-get-textfield-value-using-jquery)

我有一张发票，我正在从列表中迭代值。我有一个名为的文本框`subtotal`，这个文本框包含一些数字。另一个名为 的文本框`discountamt`，在这个文本框中，用户将输入折扣数字，这将被称为`discountamt percentage subtotal`.ie( `discountamt % subtotal`) 例如。小计的 10%。
计算出的金额应从小计中减少，并应设置在名为`overalltotal`.

请看我下面的图片，它显示了我的输出应该如何...... ![在此处输入图像描述](../Images/877a9dae6e5147297fe3bc582ea6d948.png)

下面是我的代码，我正在尝试实现这个

```
 <tr>
           <td height="1%" valign="top" width="100%"> 
                  <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
                               <tr style="height: 10px;"> 
                                   <td width="100%" align="right" colspan="5" style="font-weight: b"> 
                                       Sub Total. <s:textfield name="subtotal" value=" "  size="5"/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                  </td>
                               </tr> 
                   </table>  
         </td>
      </tr> 
         <tr>
           <td height="1%" valign="top" width="100%"> 
                  <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
                               <tr style="height: 10px;"> 
                                   <td width="100%" align="right" colspan="5"> 
                                          Discount:<sj:textfield name="discountamt"  size="1"  placeholder=" %"/>  
                                  </td>
                               </tr> 
                   </table>  
         </td>
      </tr> 

      <tr>
           <td height="1%" valign="top" width="100%"> 
                  <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
                               <tr style="height: 10px;"> 
                                   <td width="100%" align="right" colspan="5" style="font-weight: bolder;">
                                   <s:set var="total" value="%{0}" />   
                                       Over All Total Amount: <s:textfield name="overalltotal  size="4"></s:textfield>  
                                  </td>
                               </tr> 
                   </table>  
         </td>
      </tr> 
```

**更新正确答案：**

```
 $('input[name="discountamt"]').keyup(function() 
                { 
                     var disamount=$('[name=discountamt]').val();
                     var linetotal = $('[name=subtotal]').val();  
                     var priceafterdisc=linetotal-(((disamount)/100)*linetotal);   
                    $('[name=overalltotal]').val(priceafterdisc); 
               }); 
```

请帮我解决这个问题...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T13:10:53.587

试试这个：

html:

```
<input name="box1" id="box1" type="text">
<input name="box2" id="box2" type="text"> 
```

jQuery：

```
$('#box2').val($('#box1').val()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T13:14:08.013

尝试改变`name='whatever'`元素`id='whatever'`

例如：`<s:textfield name="overalltotal" size="4"></s:textfield>`

更改为：`<s:textfield id="overalltotal" size="4"></s:textfield>`

# gtk - pygtk 菜单栏固定

> ID：13440308
> 
> 赞同：3
> 
> 时间：2012-11-18T12:58:40.870
> 
> 标签：gtk, pygtk, fixed, menubar

我是 pyGTK 的新手，现在我正在尝试创建一个具有固定布局的菜单栏，但我只获得项目的背景，而不是整个栏。我的代码：

```
import gtk

class App(gtk.Window):
    def __init__(self):
        super(App,self).__init__()
        self.set_size_request(640,480)
        self.set_position(gtk.WIN_POS_CENTER)

        menubar = gtk.MenuBar()

        menu_file= gtk.Menu()
        menuitem_file = gtk.MenuItem("File")
        menuitem_file.set_submenu(menu_file)

        menuitem_exit = gtk.MenuItem("Exit")
        menuitem_exit.connect("activate",gtk.main_quit)
        menu_file.append(menuitem_exit)

        menubar.append(menuitem_file)

        fixed = gtk.Fixed()

        vbox = gtk.VBox(False, 2)
        vbox.pack_start(menubar, False, False, 0)

        fixed.add(vbox)

        self.add(fixed)

        self.connect("destroy",gtk.main_quit)
        self.show_all()

App ()
gtk.main () 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T19:45:01.223

您需要确定`vbox`请求大小，例如添加`vbox.set_size_request (300,50)`并查看差异。它的尺寸不正确，但我不知道你为什么要使用它`gtk.Fixed`。在 99.95% 的情况下，您*不需要*`gtk.Fixed`. 尤其是如果您是 GTK+ 的新手，您可能会认为您需要它，而实际上您并不需要。

# html - 如何在图像上放置文字

> ID：13440311
> 
> 赞同：1
> 
> 时间：2012-11-18T12:59:04.243
> 
> 标签：html, css, image

我正在尝试使用下面的 CSS 和 HTML 在图像上写文本，但它不起作用..

**CSS**

```
.social_media_head{
background: url(newsletter_image.gif) no-repeat center;
position: relative;
right: -9px;
height: 0;
width: 325px;
padding: 30px 0 0 5px;     
}

.media_name h2{
position: relative;
top: 2px;
}

.media_name {
position: relative;
top: 2px;
} 
```

**HTML**

```
 <div class="social_media_head">
    <h2 class="media_name">Social Media</h2>
    </div> 
```

示例[jsfiddle](http://jsfiddle.net/fCUTm/)

**更新** 如果我指的是错误的图像，我很抱歉。我想在上面放文字的图像是社交媒体图标（facebook、twitter、youtube）顶部的图像……即类中的图像=“social_media_head”。

再次为混乱感到抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:04:23.953

您可以通过将文本的 z-index 设置为高于图像和绝对位置来做到这一点

```
.text{
z-index:101;
position:absolute;
/set the position of text you want
}

.image{
z-index:100;
} 
```

并在图像上方显示文字

`.media_name h2`应该`h2.media_name`

```
h2.media_name {
    color: red;
    margin-top: -30px;

    top: 2px;
} 
```

[**全屏结果**](http://jsfiddle.net/Ej5CX/embedded/result/)和[**小提琴**](http://jsfiddle.net/Ej5CX/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T13:55:36.787

尝试以下操作以避免 H-tags，并且对于调整高度的框，图像是内联而不是背景：（[请参见此处的代码 http://jsfiddle.net/jySZB/1/](http://jsfiddle.net/jySZB/1/)）

（由于更新，旧代码被删除并保留在上面的链接中 - 请参阅下面的新链接和代码） -

更新：如果“在图像上”的意思是在上面而不是在上面（在这种情况下*确实*更有意义），请尝试以下代码：

[http://jsfiddle.net/jySZB/2/](http://jsfiddle.net/jySZB/2/)

HTML：

```
<div class="social_media_head">
    <div>Social Media</div>
    <img src="http://satcomng.com/types/twitter.png" alt="" />
    <img src="http://satcomng.com/types/twitter.png" alt="" />
    <img src="http://satcomng.com/types/twitter.png" alt="" />
</d 
```

CSS：

```
.social_media_head {
    display:block;
}
.social_media_head div {
    color:red;
    font-size:26px;
    font-weight:bold;
    font-family:sans-serif;
    clear:both;
} 
```

结果：

![结果 2](../Images/465e84909e87d9e54aa6731f2a57c737.png)

提示：由于图像在这里是内联的，因此它们很容易转换为可点击的链接以访问社交网站（例如，我只使用了一张图像）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T13:13:55.223

为我工作（简化）：http: [//jsbin.com/uqazel/1/](http://jsbin.com/uqazel/1/)

也许你需要设置一个合适的`height`.

# c - C中二维数组的排序

> ID：13440314
> 
> 赞同：2
> 
> 时间：2012-11-18T12:59:15.150
> 
> 标签：c, multidimensional-array

我是c的初学者。并且对在 python 中非常容易的二维数组有点困惑。假设我声明了一个数组 [100][2] 并读取它们的值。然后我只想通过一维对元素进行排序。如果我不能说清楚，这是在 python 中完美运行的代码（这个逻辑）。但在 c 中，它在排序时会出错。

```
int array[100][2],i,j,n=50,temp[1][2];
for(i=0;i<n;i++){
    scanf("%d %d",&list[i][0],&list[i][1]);
}
/*heres's the sorting part which gives error*/

for(i=0;i<n-1;i++){
    for(j=i+1;j<n;j++){
        if(list[j][1]>list[i][1]){
            temp=list[i];
            list[i]=list[j];
            list[j]=temp;
        }
    }
} 
```

那么C中的正确方法应该是什么？如果你不明白我的问题，请评论！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T13:07:57.237

除了用于交换二元素数组的部分外，您的代码很干净。有两种方法可以修复它：

*   使用数组的替代表示 -在这种情况下，`int *array[100]`您需要使用单个元素，或者`malloc``free`
*   用于`memcpy`在交换代码中交换二元素数组。
*   只需交换两个元素，您可以一次交换一个整数的两个元素数组，而无需使用`memcpy`

这是一种方法：

```
int temp[2];
memcpy(temp, list[i], sizeof(temp));
memcpy(list[i], list[j], sizeof(temp));
memcpy(list[j], temp, sizeof(temp)); 
```

# xmpp - xmpp - 乒乓球

> ID：13440315
> 
> 赞同：1
> 
> 时间：2012-11-18T12:59:28.440
> 
> 标签：xmpp

因此，为了知道是否仍有活动的数据连接，我每隔 5 分钟发送一次 ping，并等待服务器响应。所以基本上，我使用 iq id 作为这个 ping 方法的关键。我将发送一个 ping，并存储 iq id，假设 noDataConnection = true。现在，如果我收到一个具有相同 iq id 的 pong，我假设连接是活动的，所以我将设置 noDataConnection = false。但是，如果没有数据连接，我将继续发送设置 noDataConnection = true 的 ping，并且永远不会收到任何数据，因此除非它恢复并获得数据连接，否则它将保持为真。

摘自[http://xmpp.org/extensions/xep-0199.html#s2c](http://xmpp.org/extensions/xep-0199.html#s2c)：PING：

```
<iq from='juliet@capulet.lit/balcony' to='capulet.lit' id='c2s1' type='get'>
  <ping xmlns='urn:xmpp:ping'/>
</iq> 
```

乒乓：

```
<iq from='capulet.lit' to='juliet@capulet.lit/balcony' id='c2s1' type='result'/> 
```

我对此唯一担心的是，如果我收到的 iq 不是我的 ping 的结果，并且我的应用程序将假定 noDataConnection = true，因为它收到的 iq id 与我的 ping iq id 不匹配已发送。有没有办法知道我收到的 iq 是否是我 ping 的结果？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T09:58:11.760

我的解决方案是在我发送的 iq id 前面加上一个文本“ping”，所以基本上如果我收到一个带有“ping”的 iq 前缀，那么它就是我的 ping 的 pong。

# ruby-on-rails - Ruby on Rails 配置 gem 难度

> ID：13440316
> 
> 赞同：0
> 
> 时间：2012-11-18T12:59:34.057
> 
> 标签：ruby-on-rails, rubygems

Ruby on Rails 新手配置问题：

我通过运行“gem install pg”搞砸了我的 rails 配置。现在，当我尝试进行捆绑安装时，出现此错误：

/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/resolver.rb:287:in `resolve': 找不到 gem 'pg (> = 0) ruby​​' 在这台机器上可用的宝石中。(捆绑器::GemNotFound)

如果我尝试重新安装 pg gem，我会得到：

![在此处输入图像描述](../Images/f85b7300737f36c602a502633b2e1381.png)

任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T16:09:34.317

您是否安装了 Postgres 并正常工作？如果您还没有，heroku 提供的应用程序是最轻松的方式[。](http://postgresapp.com/)

# android - 函数不将数据保存到文件 onDestroy() Android

> ID：13440318
> 
> 赞同：0
> 
> 时间：2012-11-18T12:59:51.373
> 
> 标签：android, android-layout

我在主要活动中执行以下功能

```
 @Override
 public void onDestroy() {
 super.onDestroy();
 SimpleBookManager.getSimpleBookManager().saveChanges(this);  
} 
```

当 Android 稍后在我关闭应用程序时调用方法函数 saveChanges() 时，我得到“SaveChanges”输出，但不是最后一个打印“After Saving”，这意味着它没有执行整个函数并且我没有得到任何输出打印例外行。你知道为什么吗？我是 android 新手，不明白您是否可以在 onDestroy() 上运行此代码。=)

```
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.util.ArrayList;

import android.content.Context;

public class SimpleBookManager implements BookManager, java.io.Serializable {

    private ArrayList<Book> allBooks = new ArrayList<Book>();
    private static SimpleBookManager ref;       

    public void saveChanges(Context context){
        try{
            System.out.println("SaveChanges");
            FileOutputStream f_out = context.openFileOutput("myobject.data",Context.MODE_PRIVATE);

            // Write object with ObjectOutputStream
            ObjectOutputStream obj_out = new    ObjectOutputStream (f_out);
        // Write object out to disk
        obj_out.writeObject(allBooks);
        System.out.println("After Saving");

    }catch (FileNotFoundException e) {
        System.out.println("No file found saveChanges");
    } catch (IOException e) {
        System.out.println("IOException in SaveChanges");
    }   
}

public void loadBooks(Context context){
    try{
    // Read from disk using FileInputStream
        FileInputStream f_in = context.openFileInput("myobject.data");

    // Read object using ObjectInputStream
    ObjectInputStream obj_in =  new ObjectInputStream (f_in);

    // Read an object
    Object obj = obj_in.readObject();
    //System.out.println(obj);
    if (obj instanceof ArrayList<?>)
    {
        allBooks = (ArrayList<Book>) obj;

        System.out.println("Worked");
        System.out.println(allBooks);

    }
    }catch (FileNotFoundException e) {
        System.out.println("No file found LoadBooks");
    } catch (IOException e) {

    System.out.println("IOException in loadBooks");
    } 
    catch (ClassNotFoundException e) {
        System.out.println("ClassNotFound in loadBooks");
    }

}

  public static SimpleBookManager getSimpleBookManager()
  {
    if (ref == null){
        ref = new SimpleBookManager();
    }

    return ref;
  }
public SimpleBookManager(){
    Book book1 = createBook();
    book1.setAuthor("RandomBookAuthor");
    book1.setCourse("Kunskap");
    book1.setPrice(199);
    book1.setTitle("Some Random Title");
    book1.setIsbn("9780590353403");
} 
```

}

在 main 中执行 onCreate() 时，我也会得到 IOException，所以我的加载和保存函数确实有些可疑。

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        SimpleBookManager.getSimpleBookManager().loadBooks(this);
        setContentView(R.layout.activity_action_bar_main);
} 
```

***_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* *_* __ *_* __ *_* __ _ *_* __ *_* __ *_***

我已经在清单的最后几行添加了写入存储的权限。

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.av.BookApp"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="11"
        android:targetSdkVersion="16" />

    <application
        android:icon="@drawable/ic_launcher"

        >
        <activity
            android:name=".BookApp"
            android:label="@string/title_bookapp"
            android:uiOptions="splitActionBarWhenNarrow" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
            <activity
        android:name=".AddBookActivity"
        android:uiOptions="splitActionBarWhenNarrow" >
        <meta-data
            android:name="android.support.PARENT_ACTIVITY"
            android:value="edu.chalmers.BookApp" />
    </activity>
     <activity
        android:name=".DetailActivity"
        android:uiOptions="splitActionBarWhenNarrow" >
        <meta-data
            android:name="android.support.PARENT_ACTIVITY"
            android:value="edu.chalmers.BookApp" />
    </activity>
     <activity
        android:name=".EditBookActivity"
        android:uiOptions="splitActionBarWhenNarrow" >
        <meta-data
            android:name="android.support.PARENT_ACTIVITY"
            android:value="edu.chalmers.BookApp" />
    </activity>

    </application>
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"></uses-permission>
</manifest> 
```

* * *

**编辑**

在我遵循下面的建议之后，我现在在 saveChanges() 中得到一个 IOException

我确实像这样正确设置数据（在 SimpleBookManager 中）

```
public SimpleBookManager(){
Book book1 = createBook();
    book1.setAuthor("RandomBookAuthor");
    book1.setCourse("Kunskap");
    book1.setPrice(199);
    book1.setTitle("Some Random Title");
    book1.setIsbn("9780590353403");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:41:01.657

重新排序您的`onCreate()`方法

```
 @Override
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_action_bar_main);
    SimpleBookManager.getSimpleBookManager().loadBooks(this);
 } 
```

和覆盖`onStop()`方法和不覆盖`onDestroy`方法：

```
 @Override
 public void onStop() {
    super.onStop();
    SimpleBookManager.getSimpleBookManager().saveChanges(this);  
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T13:06:52.457

我认为您将数据保存在 onResume 方法中，以保证系统会在终止进程之前执行操作

# php - 在 while 语句中使用 foreach

> ID：13440320
> 
> 赞同：1
> 
> 时间：2012-11-18T12:59:53.537
> 
> 标签：php, arrays, foreach, while-loop

我不确定这是否可能，因为我对`foreach`陈述没有太多经验，但这就是我所拥有的

```
<?php $string = file_get_contents('data.xml') ?>

<?php

include("../connect.php");

$xml = new SimpleXMLElement($string);

//Loop trough multiple products
print "<table border='1' bordercolor='#6600FF' style='width='100%' cellpadding='3' cellspacing='3'>
<th>Campaign Name</th><th>Countries</th><th>Rate</th><th>Cash</th><th>Points</th>";

$cats = mysql_query("SELECT * FROM `offer_cats`");

while ($off = mysql_fetch_array($cats)) {

    $cnames = array($off['name']);
    $cnamess = implode(",", $cnames);
    $cname = explode(",", $cnamess);

    print_r($cnames);

    foreach ($cnames as $category) {
        $cat = $category;
    }

}

foreach($xml->item as $item) { 

    $count = count(explode(", ",$item->countries));

    if ($count >= 5) {
        $country = "ALL INTL";
    } else {
        $country = $item->countries;
    }

    $rate = number_format((float)$item->rate, 2, '.', '');
    $crates = $rate * 0;
    $prates = $rate * 45;
    $crate = number_format((float)$crates, 2, '.', '');
    $prate = number_format((float)$prates, 2, '.', '');

    echo'<tr><td>'.$item->name.'<br /><font color="limegreen" size="2">Incent: '.$item->incent.'</font><br /><select name="req" style="width:200px"><option value ="'.$item->requirements.'">'.$item->requirements.'</option></select>
<select style="width:200px" name="cat" id="cat"><option value="'.$cat.'">'.$cat.'</option></select><input type="button" name="add" value="+" /></td>';    
    echo '<td>'.$country.'</td>';
    echo '<td>'.$item->rate.'</td>';
    echo '<td><input type = "text" name="cash" value="'.$crate.'" style = "width:75px" /></td>';
    echo '<td><input type = "text" name="points" value="'.$prate.'" style = "width:75px" /></td>';
    // echo $item->incent;
    // echo '<br/>';
}
?>

</tr>
</table> 
```

我正在尝试加载这一行中的所有类别，`<select style="width:200px" name="cat" id="cat"><option value="'.$cat.'">'.$cat.'</option></select>`但它始终只加载数组中的最后一个类别。虽然我很确定`implode`and`explodes`并不是真正需要的，但它试图修复错误，但它是徒劳的。我到底做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T13:06:43.877

您的第一个循环基本上只是不断覆盖 $cat 变量：

```
foreach($cnames as $category){
    $cat = $category;
} 
```

您需要将此循环放在要循环的位置并输出选项，例如

```
echo '<select style="width:200px" name="cat" id="cat">';
foreach($cnames as $category){
    echo '<option value="'.$cat.'">'.$cat.'</option>';
}
echo '</select>'; 
```

# c# - C#：将 int[] 转换为字符串的最有效方法

> ID：13440323
> 
> 赞同：2
> 
> 时间：2012-11-18T13:00:26.887
> 
> 标签：c#, arrays, string, optimization, int

我知道这类问题已经回答过很多次了。虽然我找到了很多可能的答案，但它们仍然没有解决我的问题，即**实现将整数数组转换为单个字符串的最快方法**。我有例如：

```
int[] Result = new int[] { 1753387599, 1353678530, 987001 } 
```

我希望它反转，所以我相信最好在进一步的代码之前

```
Array.Reverse(Result); 
```

虽然我不是从末尾迭代，但相当于倒车，因为我从末尾调用元素。所以我已经这样做了。只是为了让您知道 - 如果您能想到除我之外的任何其他解决方案，我建议使用此 Array.Reverse，因为解决方案必须颠倒。我总是只关心数字的最后 9 位数字——比如模 1 000 000 000。这就是我想要得到的：

```
987001|353678530|753387599 
```

分隔符只是为了现在清楚。我编写了自己的函数，它比使用 .ToString() 快 50%。tempint - int 数组的当前元素，StrArray - 字符串数组。使用 StringBuilder 或对字符串求和是不值得的，所以最后我只需加入 AnswerArr 的元素即可获得结果。IntBase - 一个包含 1000 个元素的数组，字符串中的数字从“000”到“999”，索引为 0 到 999。

```
 for (i = 0; i < limit; i++)
    {
    //Some code here

    j = 3 * (limit - i);

    //Done always
    StrArray[j - 1] = IntBase[tempint % 1000];

    if (tempint > 999999) 
    {
        //Done in 99/100 cases
        StrArray[j - 2] = IntBase[tempint % 1000000 / 1000]; 
        StrArray[j - 3] = IntBase[tempint % 1000000000 / 1000000];
    }
    else
    {
        if (tempint > 999) 
        {
            //Done just once
            StrArray[j - 2] = IntBase[tempint % 1000 / 1000];
        }
    }
    }
    //Some code here

    return string.Join(null, StrArray); 
```

在这部分之前有很多计算，它们完成得非常快。虽然一切都在 714 毫秒内完成，但没有对整数求和，它只有 337 毫秒。

提前感谢您的帮助。

最好的问候， 伦道夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T13:02:48.843

快点？最有效？我不确定，你应该试试。但是一种简单的转换方法

```
int[] Result = new int[] { 1753387599, 1353678530, 987001 };
var newstr = String.Join("|", Result.Reverse().Select(i => i % 1000000000)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T13:12:16.007

对于大多数情况，我会建议 LB 的答案。但是，如果您追求最高效率，以下是我的建议：

*   您可以从末尾迭代数组，因此无需调用`Reverse`任何类型的
*   `IntBase[tempint % 1000000 / 1000]`相同，`IntBase[tempint % 1000]`因为除法的优先级高于模数
*   我敢打赌，整个`IntBase`中间步骤会大大减慢你的速度

我的建议是这样的——很像 LB 的代码，但命令式的并且略微优化。

```
var sb = new StringBuilder();
var ints; // Your int[]

// Initial step because of the delimiters.
sb.Append((ints[ints.Length - 1] % 1000000000).ToString());

// Starting with 2nd last element all the way to the first one.
for(var i = ints.Length - 2; i >= 0; i--)
{
    sb.Append("|");
    sb.Append((ints[i] % 1000000000).ToString());
}

var result = sb.ToString(); 
```

# scala - 以 scalaz.NonEmptyList[A] 作为成员且 ===、等于、== 的案例类

> ID：13440324
> 
> 赞同：2
> 
> 时间：2012-11-18T13:00:28.830
> 
> 标签：scala, equals, scalaz

我想将案例类与 scalaz`NonEmptyList`字段进行比较。`==`or`euqls`不起作用，我知道这是因为方法`NonEmptyList.equals`检查比较对象是否与调用者相同。另一方面，如果必须在范围内隐含，则 scalaz`===`函数可以正常工作。`NonEmptyList``Equals`

问题是我想让我的案例类通用，并希望它的实例易于比较。

这该怎么做？

如果唯一的解决方案是提供自定义`def equals(obj: Any): Boolean`方法，请在下面发布。

我的代码：

```
object Problem {

  case class CC[M, N](s: M, nel: NonEmptyList[N])

  CC(1, 2.wrapNel) == CC(1, 2.wrapNel) //false

  CC(1, 2.wrapNel) equals CC(1, 2.wrapNel) //false

  implicit def cCEquals[M, N] = equalA[CC[M, N]]

  CC(1, 2.wrapNel) === CC(1, 2.wrapNel) //false

  //override def equals(obj: Any): Boolean = ???
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T14:30:59.203

我知道它可能对您没有帮助，但是该`equals`方法`NonEmptyList`在 Scalaz 7 中按预期工作。（编辑：实际上这[现在在 Scalaz 6](https://github.com/scalaz/scalaz/commit/5a6e6080)中也已修复，所以如果您愿意从源代码构建或等待 6.0\. 5，你会没事的。）

不过，在 Scalaz 6.0.4 或更早版本中仍然有一种自然的方法可以解决这个问题`Equal`——您只需要确保`Equal`为 构建正确的实例`CC[M, N]`：

```
implicit def ccEqual[M: Equal, N: Equal] =
  Equal.equalBy[CC[M, N], (M, NonEmptyList[N])] {
    case CC(s, nel) => (s, nel)
  } 
```

在这里，我们要求两者都`M`具有`N`实例`Equal`。然后编译器可以构建一个`Equal`实例 for`NonEmptyList[N]`然后 for `(M, NonEmptyList[N])`。`CC[M, N]`并且有一个从到的明显映射`(M, NonEmptyList[N])`，我们可以用 将其转换为所需的实例`Equal.equalBy`。

如果您愿意对`M`and使用普遍平等`N`，您可以这样做：

```
implicit def ccEqual[M, N] = new Equal[CC[M, N]] {
  def equal(a: CC[M, N], b: CC[M, N]) =
    a.s == b.s && Equal.NonEmptyListEqual(Equal.equalA[N]).equal(a.nel, b.nel)
} 
```

甚至只是：

```
implicit def ccEqual[M, N] = new Equal[CC[M, N]] {
  def equal(a: CC[M, N], b: CC[M, N]) = a.s == b.s && a.nel.list == b.nel.list
} 
```

使用一点类型级别的魔法（例如，通过 Scalaz 7`typelevel`或更容易使用[Shapeless](https://github.com/milessabin/shapeless)），您可以让编译器`Equal`为任何带有其成员实例的案例类生成实例`Equal`，但自己写出来并不难。

# java - Java 编译器或 JVM 可以交换独立指令的指令顺序吗？

> ID：13440329
> 
> 赞同：4
> 
> 时间：2012-11-18T13:00:47.633
> 
> 标签：java, compiler-construction, jvm, instructions

让我们采取以下陈述：

```
int d0, d1;
int[] ds = {0, 0}; 
```

现在一个线程具有以下说明：

```
d0++;
d1++; 
```

而另一个线程有这个指令：

```
ds[1] = d1;
ds[0] = d0; 
```

如果我们并行运行这些线程，显然有三种组合`ds`可以看起来像：{0, 0}、{1, 1} 和 {1, 0}。

现在最大的问题是：也可以有 {0, 1} 吗？编译器/JVM 可以简单地交换指令，因为它认为它们不相关吗？如果是，那么这种行为的“规则”到底是什么，这取决于编译器还是 JVM？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T13:04:22.260

是的，`{0, 1}`也是可以的。在这种情况下，Java 内存模型不足以保证排序。这甚至不需要指令重新排序——如果你在除 x86 或 x86_64 之外的任何东西上运行程序，这无论如何都会发生。

在这里要清楚的是，实际的 CPU 硬件将重新排序这些加载和存储，如果它是 x86 则不会。

请参阅[Java 内存模型常见问题解答](http://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html#reordering)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T13:33:55.830

在没有适当同步的情况下，这确实是可能的。

Java 语言规范在第 17 章中定义了多线程 Java 程序的语义。那一章很难理解，但它确实包含了可以依赖的官方规则。特别是，它[写道](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4)：

> 给定程序和该程序的执行轨迹，内存模型描述该执行轨迹是否是程序的合法执行。Java 编程语言内存模型的工作原理是检查执行跟踪中的每个读取，并根据某些规则检查该读取观察到的写入是否有效。
> 
> 内存模型描述了程序的可能行为。一个实现可以自由地生成它喜欢的任何代码，只要程序的所有结果执行产生的结果可以由内存模型预测。

为了给出一个粗略的概述，内存模型定义了一个[happens-before关系，](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4.5)任何重新排序都必须[与](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4.7). 为不同线程执行的操作建立happens-before的常用方法是[同步](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4.4)这些操作，例如使用`synchronized`块或写入或读取易失性变量。

在没有这种同步的情况下，运行时将独立执行线程，允许*当前*线程无法观察到的任何重新排序。

也就是说，如果你有可变的共享状态，你通常需要同步访问它的线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T13:09:48.547

是的，编译器和 jvm（即时编译器）都可以进行指令重新排序。而且，硬件处理器可以做到。为防止不必要的重新排序， 应使用[内存屏障。](http://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html#reordering)

# node.js - 文件操作权限-nodejs

> ID：13440330
> 
> 赞同：2
> 
> 时间：2012-11-18T13:00:49.070
> 
> 标签：node.js, filesystems

[在用扳手](https://github.com/ryanmcgrath/wrench-js/)[`copyDirSyncRecursive`](https://github.com/ryanmcgrath/wrench-js/blob/master/lib/wrench.js#L166)（用）进行文件操作时`opts: { preserve: false }`，我得到了`Error: EPERM, operation not permitted`错误。

[正如我所指出的](https://stackoverflow.com/questions/8496212/node-js-fs-unlink-function-causes-eperm-error)，这是文件系统中的权限违规吗？如果是，有没有办法对我进行身份验证`admin / root`以执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:45:41.967

4条评论：

*   不要使用同步操作。Node.js 本质上是异步的。如果您想编写同步代码，请使用另一种脚本语言，例如 python。如果您使用单个同步函数，您将阻塞整个事件循环，其余异步函数将需要等待。
*   不要使用 wrench.js。它存在错误并且错误管理很差，尤其是在并行异步函数（readdirRecursive、rmdirRecursive 等）中。我无法理解一个可以毁掉你整个应用程序的错误代码是如何获得 150 多颗星的。
*   不要使用 wrench.js。它使用同步函数促进了对 node.js 的不良使用。
*   如果要执行禁止操作，请使用管理员权限 (windows) 或 root 权限 (linux) 启动 node.js。

# plugins - 插件和共享对象库

> ID：13440332
> 
> 赞同：3
> 
> 时间：2012-11-18T13:00:59.333
> 
> 标签：plugins, dll, shared-libraries

我了解插件是具有特定功能并加载以供应用程序使用的组件。

linux 中的共享对象库 (.so) 和 windows 中的 .dll 是应用程序在运行时加载的库。

我想了解如果 .dll / .so 始终是插件会怎样。所有插件都是.dll / .sos吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:35:50.837

实际上，`.dll`'s 和`.so`'s 是动态库。还有其他类型库称为静态库。在 Linux 中，它们的扩展名为`.a`.

程序员倾向于使用库来轻松维护他们的代码。此外，如果库将被多个应用程序共享，则选择共享库是因为主内存使用情况。

您可以将此逻辑应用于包含插件的结构。如果代码片段仅由应用程序的单个进程使用，则可以使用静态库作为插件。但是，如果代码将由多个进程共享，则应该使用共享库，即使这些进程是同一应用程序的实例。

当您将共享库用作插件时，您不得将库作为已知方法包含在内，并且不得将可执行文件直接链接到库。相反，您必须使用`libdl`. 看看[这里](http://www.yolinux.com/TUTORIALS/LibraryArchives-StaticAndDynamic.html)并寻找`dynamic loading`.

# eclipse - Eclipse 控制台命令转到行 - 反向搜索

> ID：13440341
> 
> 赞同：1
> 
> 时间：2012-11-18T13:02:20.140
> 
> 标签：eclipse, parameters, line, goto, inverse

有没有办法让 Eclipse 跳到控制台外的特定行？

例如

```
/usr/bin/eclipse --file=/foo/bar --line=3456 
```

如果已经打开一个新的 Eclipse 实例，则无需打开它。

具体来说，我正在使用 TeXlipse 创建 PDF 文件。在我的 PDF 查看器中，我可以获得当前选择的 TeX 行并使用它执行控制台命令，以便将我的 TeX-Editor (Eclipse) 导航到该行。

相关[这里](https://bugs.eclipse.org/bugs/show_bug.cgi?id=305336)。

# c++ - 如何将 '\n' 包含在 while (cin >> x) 习语中？

> ID：13440354
> 
> 赞同：1
> 
> 时间：2012-11-18T13:04:20.457
> 
> 标签：c++

我的理解是运算符`>>`返回左操作数，因此`cin >> x`返回`cin`值是`false`如果我们遇到`EOF`错误或其他错误。现在我的猜测是，由于`cin`跳过了空格，`\n`因此不会存储诸如此类的字符。我想做的是这样的：

```
int x;

while((cin >> x) and x != '\n')
    // do stuff 
```

因此，当`cin`在流中遇到换行符时，它会退出输入循环（就像它通常对 say, 所做的那样`EOF`）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T13:15:42.583

直接使用`>>`运算符将​​不起作用，因为正如您所说，它会跳过包括换行符在内的空格。

您可以做的是使用 读取单行`std::getline`，然后您可以使用 读取该行的所有输入`std::stringstream`。

```
std::string line;
if (std::getline(std::cin, line)) {
    std::istringstream ss(line);
    int x;
    while (ss >> x) {
        //....
    }
} 
```

# php - Facebook（多朋友）请求对话：跟踪邀请的用户数量？

> ID：13440360
> 
> 赞同：0
> 
> 时间：2012-11-18T13:04:46.333
> 
> 标签：php, facebook, facebook-graph-api

我正在开发一款集成了 Facebook 的在线游戏，并希望在 PHP 中执行以下操作：

我希望用户能够根据他们使用多朋友请求 API（[https://developers.facebook.com/docs/reference/dialogs/requests/](https://developers.facebook.com/docs/reference/dialogs/requests/)）邀请的朋友数量来“解锁”某些功能。

基本上我正在寻找类似于这个工作的代码：

```
if($user['friendsInvited'] => 5){
echo "You invited 5 or more friends"
} else {
echo "<button onclick='showInviteDialogue()'>Invite Friends</button>"
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:10:08.597

关闭...您刚刚得到了 = 和 > 倒退...试试这个

```
if($user['friendsInvited'] >= 5) 
```

记住顺序的最简单方法是读为“大于或等于”

至于获取实际数字，当用户完成共享时，facebook 将在包含用户 ID 数组的查询字符串中使用“to”参数访问您的页面，您可以对此进行计数（或添加数一数他们之前分享过多少人）。

查看您链接到的页面上的“返回数据”部分

# in-app-purchase - Google 钱包应用内 API 发生了哪些变化？

> ID：13440363
> 
> 赞同：1
> 
> 时间：2012-11-18T13:05:01.610
> 
> 标签：in-app-purchase, android-pay

用于应用内购买的 Google jsapi 发生了什么变化？此代码在 2 天前工作，昨天停止工作。

[我从这里](http://www.google.com/jsapi)加载脚本

然后加载付款：

```
 google.load('payments', '1.0', {
        'packages': ['sandbox_config']

    }); 
```

然后当我打电话购买时：

```
goog.payments.inapp.buy({ etc ... 
```

我得到的是脚本错误“goog”未定义。

# git - 使用 Netbeans 对 Java EE 项目的 git 存储库进行不同设置

> ID：13440364
> 
> 赞同：0
> 
> 时间：2012-11-18T13:05:08.323
> 
> 标签：git, jakarta-ee, netbeans, github

托管在 github 中的 git 存储库主要在 Netbeans IDE 中进行管理。如果我克隆到一台新计算机，在清理和构建后不久，project.properties 和 private.properties 就会更改。在提交这些更改并将其推送到存储库后，必须再次更改从第一个项目设置中提取的更改。Persistance.xml 和 glassfish-resources.xml 中的 JPA 设置也必须每次都更改。作为解决方案，我将这些文件添加到 .gitignore 中，但是克隆新存储库的后续操作未被识别为 Netbeans 项目。

如何为不同的计算机设置不同的设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T13:24:03.020

您可以通过执行 rm --cached 从 git 中删除这些属性文件。这将保留您的本地副本，但会将它们从存储库中删除。还要将它们添加到 gitignore，以便将来不会添加它们。问题是当您更改属性时，您需要在另一台计算机上进行相同的更改，因为 git 将不再同步这些。我有同样的问题，没有解决方案。

您的问题是文件仍在存储库中，因此您仍然每次都提取它们。即使他们在 gitignore 中。

# algorithm - 构建堆函数

> ID：13440368
> 
> 赞同：3
> 
> 时间：2012-11-18T13:06:13.717
> 
> 标签：algorithm, heapsort

在我的大学笔记中，构建堆的伪代码几乎是这样写的（唯一的区别是括号我有括号）：

![在此处输入图像描述](../Images/052059256e1160a5453ee3f7de3fb0e1.png)

我在互联网上搜索，有几个这样的：

但不应该是这样的吗？

```
BuildHeap(A) {
   heapsize <- length[A]
   for i <- floor(length[A]/2) downto 1
      Heapify(A,i)
} 
```

为什么他们写 heap_size[A] = length[A]？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T02:11:57.747

如果你有很多堆，A、B、C。而且只有一个可变堆大小，你将如何记住所有堆的大小？**您将拥有所有堆的属性 heap-size。**

在许多伪代码中，对象 O 的属性写为`Attriubute[O]` 或`Attribute(O)`，（有时它们也写为`O.attribute`）。

第一个示例假定您将特定堆的堆大小存储为堆的属性。

第二个示例可能是将堆大小存储在一个局部变量中，该变量从`Length[A]`堆的长度属性 () 中获取其值。

以下是算法简介中关于伪代码的文本：

> 复合数据通常组织成对象，这些对象由属性或字段组成。使用字段名称后跟方括号中的对象名称来访问特定字段。例如，我们将数组视为一个对象，其属性长度表示它包含多少个元素。要指定数组 A 中元素的数量，我们写 length[A]。尽管我们对数组索引和对象属性都使用方括号，但通常可以从上下文中清楚地看出它的意图是什么

# sql - 使用视图提取数据

> ID：13440369
> 
> 赞同：0
> 
> 时间：2012-11-18T13:06:16.447
> 
> 标签：sql, oracle, join

我需要使用视图从运输数据库中查找行程详细信息。

我怎么做不到。我需要进行查询以查找不超过 2 条腿的所有行程，即具有 1 个或 2 个目的地的行程，并显示行程编号 (TripNo)、行程起点 (Start)、第一个目的地 (Stop1) 和第二个目的地（Stop2），格式如下。

```
 TripNo START STOP1 STOP2
 - - - - - - - - - - - - - - - -
 05 CatmanSt Chinatwon MayflowerSt
 03 MayflowerSt Auckland 
```

这是下表。

```
TRIP( TripNo,LicenseCardNo,CarReg,TRIP_DATE,)
PRIMARY KEY (TripNo),
FOREIGN KEY (LicenseCardNo) REFERENCES DRIVER(LicenseCardNo),
FOREIGN KEY (CarReg) REFERENCES TRUCK(CarReg)

( 1, DR1, 'SJG123', ADD_MONTHS(TRUNC(SYSDATE),0)-135 )
( 2, DR2, 'GBC222', ADD_MONTHS(TRUNC(SYSDATE),0)-135 )
( 3, DR1, 'GBC270', ADD_MONTHS(TRUNC(SYSDATE),0)-133 )
( 4, DR3, 'SJG123', ADD_MONTHS(TRUNC(SYSDATE),0)-130 )
( 5, DR22, 'SJG123', ADD_MONTHS(TRUNC(SYSDATE),0)-130 )
( 6, DR22, 'GBC222', ADD_MONTHS(TRUNC(SYSDATE),0)-124 ) 
```

三重桌

```
TRIPLEG(  TripNo, LEGNo, DEPARTURE, DSTINATION )    
CONSTRAINT TRIPLEG_PKEY PRIMARY KEY (TripNo, LEGNo),
CONSTRAINT TRIPLEG_UNIQUE UNIQUE(TripNo, DEPARTURE, DESTINATION),
CONSTRAINT TRIPLEG_FKEY1 FOREIGN KEY (TripNo) REFERENCES TRKTRIP(TripNo) );

INSERT INTO TRIPLEG VALUES( 1, 1, 'Armidale', 'Liverpool');
INSERT INTO TRIPLEG VALUES( 1, 2, 'Liverpool', 'Adelaide');
INSERT INTO TRIPLEG VALUES( 1, 3, 'Adelaide', 'Armidale');
INSERT INTO TRIPLEG VALUES( 3, 1, 'MayflowerSt', 'Auckland');
....
INSERT INTO TRIPLEG VALUES( 5, 1, 'CatmanSt', 'Chinatwon');
INSERT INTO TRIPLEG VALUES( 5, 2, 'Chinatwon', 'MayflowerSt'); 
```

我需要使用视图来实现。怎么做 ？我根本无法检索它。我应该使用左连接还是右连接

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T14:00:33.500

这应该这样做：

```
select st.tripno, 
       st.departure as "START",
       st.dstination as stop1,
       stp1.dstination as stop2
from tripleg st
  left join tripleg stp1 
         on stp1.tripno = st.tripno 
        and stp1.departure = st.dstination
where st.legno = 1
  and st.tripno in (select tripno
                    from tripleg 
                    group by tripno
                    having count(*) < 3); 
```

这是一个 SQLFiddle 演示：[http ://sqlfiddle.com/#!4/7f773/1](http://sqlfiddle.com/#!4/7f773/1)

如果您需要从中创建视图，只需运行：

```
create or replace view v_short_trips
as
select ... 
```

有关如何创建基于视图的更多详细信息，请[参阅手册](http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_8004.htm)

# android - phonegap/cordova 文件编写器和阅读器不工作

> ID：13440374
> 
> 赞同：1
> 
> 时间：2012-11-18T13:06:56.917
> 
> 标签：android, eclipse, cordova

我正在使用cordova 2.2.0 在eclipse 上开发一个Android 应用程序。似乎获得了 Phonegap 的文件 API，但无法读取或写入文件。

我已经从 xcode 复制了脚本，在那里我完成了适用于 iOS 的应用程序，并且它可以工作。

这是我的脚本，使用控制台输出进行跟踪：

```
window.onload = function (){
    console.log('1: onload');
    document.addEventListener("deviceready", getSettings, false);
}
function getSettings(){
    console.log('2: getSettings()');
    fileSys('settings.txt', 'getContent', null);
    //fileSys('settings.txt', 'replaceContent', 'new settings');
}
function fileSys(fileName, action, data){
    console.log('3: fileSys - '+fileName+' - '+action);
    var directory = (fileName == 'sidur') ? 'appin/sidur':'appin';
    window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, gotFS, fail);
    function gotFS(fileSystem) {
    console.log('4: Got file system, get directory...');
    fileSystem.root.getDirectory(directory, {create: true}, gotDir, fail);
    }
    function gotDir(dirEntry) {
        console.log('5: Got directory. Get file...');
        dirEntry.getFile(fileName, {create: true, exclusive: false}, gotFileEntry, fail);
    }
    function gotFileEntry(fileEntry){
        console.log('6: got file. Perform action: '+action+'...');
        if(action == 'getContent') readAsText(fileEntry);
        if(action == 'replaceContent') fileEntry.createWriter(gotFileWriter, fail);
    }
    function gotFileWriter(writer){
        console.log('7: got file writer...');
        writer.write(data); //function variable of fileSys();
        writer.onwriteend = function(evt) {
        console.log('8: file written');
        };
    }
    function readAsText(file) {
        console.log('7: read as text...');
        var reader = new FileReader();
        reader.readAsText(file);
        reader.onloadend = function(evt) {
            console.log('9: done reading file');
            init(evt.target.result);
        }
    }
    function fail(error){
        console.log('fail: '+error.code);

    }
}
function init(settings){
    console.log('Init. Settings: '+JSON.stringify(settings));
} 
```

运行此脚本会提供以下控制台输出：

*   1：加载
*   2：获取设置（）
*   3：fileSys-settings.txt-getContent
*   4：获取文件系统，获取目录...
*   5：得到目录。获取文件...
*   6：得到文件。执行操作：getContent...
*   7：读为​​文本...

And there it stops. reader.onloadend is never called, and no error is specified. If I run again, but instead call fileSys('settings.txt', 'replaceContent', 'new settings'); and outcomment the other call to fileSys, the console outputs:

*   1: onload
*   2: getSettings()
*   3: fileSys - settings.txt - replaceContent
*   4: Got file system, get directory...
*   5: Got directory. Get file...
*   6: got file. Perform action: replaceContent...
*   7: got file writer...

I have:

*   set the correct permissions/plugins in res/config.xml and in the android manifest.xml
*   Verified that the Phonegap API is included and working (with notifications)

I am new to app development as well as eclipse, so this could very well be some basic thing I've missed. Any suggestions and pointers are most welcome.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T19:21:07.733

Alright, I figured this one out. The problem was in the structure of my code.

This works fine on ios:

```
function readAsText(file) {
    var reader = new FileReader();
    reader.readAsText(file);
    reader.onloadend = function(evt) {
        console.log('9: done reading file');
        init(evt.target.result);
    };
} 
```

But somehow, phonegap for Android requires you to declare the variable for the reader's onloadend method above the reader's readAsText method. Like so:

```
function readAsText(file) {
    var reader = new FileReader();
    reader.onloadend = function(evt) {
        console.log('9: done reading file');
        init(evt.target.result);
    };
    reader.readAsText(file);
} 
```

In retrospect this makes perfect sense to me. It seems strange that iOS has allowed the other way.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:53:49.187

Actually, it is NOT the order of your statements, because both Android and iOS will interpret them in the same sequential order. What is different is the speed at which the readAsText completes, because its work happens asynchronously in another thread. Here's an example of what happened on iOS:

```
reader.readAsText - this starts the read process in another thread
reader.onloadend = function... - you set up your handler
-- on separate thread, readAsText finally completes and sees your handler and calls it 
```

this is what happened on Android:

```
reader.readAsText - this starts the read process in another thread
-- on separate thread, readAsText completed quickly but your handler has not been set yet so it does not get called
reader.onloadend = function... - you set up your handler too late, the read already completed in its own thread 
```

In asynchronous calls, you can't guarantee when other tasks complete. It's not a difference between Android and iOS, it's just the nature of multi-threaded operations. There are all kinds of ways to deal with asynchronous calls (ordering and nesting callbacks properly, using jquery deferred, some type of semaphore mechanism, and many more, I'm sure). The main thing is, never, ever, rely on or assume that tasks will complete in a certain time. Reliance on timing can bite you big time and is VERY difficult to debug.

# java - 在构造函数中调用虚方法：Java 和 C++ 的区别

> ID：13440375
> 
> 赞同：18
> 
> 时间：2012-11-18T13:07:11.060
> 
> 标签：java, c++, virtual-functions, object-lifetime, vptr

在 Java 中：

```
class Base {
    public Base() { System.out.println("Base::Base()"); virt(); }
    void virt()   { System.out.println("Base::virt()"); }
}

class Derived extends Base {
    public Derived() { System.out.println("Derived::Derived()"); virt(); }
    void virt()      { System.out.println("Derived::virt()"); }
}

public class Main {
    public static void main(String[] args) {
        new Derived();
    }
} 
```

这将输出

```
Base::Base()
Derived::virt()
Derived::Derived()
Derived::virt() 
```

但是，在 C++ 中，结果是不同的：

```
Base::Base()
Base::virt() // ← Not Derived::virt()
Derived::Derived()
Derived::virt() 
```

（有关C++ 代码，请参阅[http://www.parashift.com/c++-faq-lite/calling-virtuals-from-ctors.html ）](http://www.parashift.com/c++-faq-lite/calling-virtuals-from-ctors.html)

是什么导致了 Java 和 C++ 之间的这种差异？是初始化vtable的时间吗？

**编辑：**我确实了解 Java 和 C++ 机制。我想知道的是这个设计决策背后的见解。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-18T13:24:35.390

这两种方法显然都有缺点：

*   在 Java 中，调用转到一个无法`this`正确使用的方法，因为它的成员尚未初始化。
*   在 C++ 中，如果您不知道 C++ 如何构造类，则会调用一种不直观的方法（即不是派生类中的方法）。

*为什么*每种语言都这样做是一个悬而未决的问题，但两者都可能声称是“更安全”的选择：C++ 的方式防止使用未初始化的成员；Java 的方法允许在类的构造函数中使用多态语义（在某种程度上）（这是一个完全有效的用例）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-18T13:27:34.350

好吧，您已经链接到[常见问题解答的讨论](http://www.parashift.com/c++-faq-lite/calling-virtuals-from-ctors.html)，但这主要是面向问题的，而不是进入基本原理，*为什么*。

简而言之，它是为了**类型安全**。

这是 C++ 在类型安全上击败 Java 和 C# 的少数情况之一。;-)

当您创建一个类`A`时，在 C++ 中，您可以让每个`A`构造函数初始化新实例，以便所有关于其状态的常见假设（称为**类不变量**）都成立。例如，类不变量的一部分可以是指针成员指向一些动态分配的内存。当每个公开可用*的方法都保留类不变量*时，就可以保证每个方法的入口也保持不变，这极大地简化了事情——至少对于精心挑选的类不变量而言！

然后在每种方法中都不需要进一步检查。

相比之下，使用 Microsoft 的 MFC 和 ATL 库中的两阶段初始化，您永远无法确定在调用方法（非静态成员函数）时是否所有内容都已正确初始化。这与 Java 和 C# 非常相似，只是在这些语言中缺乏类不变性保证来自这些语言仅启用但不积极支持类不变式的概念。简而言之，从基类构造函数调用的 Java 和 C# 虚拟方法可以在*尚未初始化*的派生实例上调用，其中（派生）类不变量尚未建立！

因此，这种对类不变量的 C++ 语言支持非常棒，有助于消除大量检查和许多令人沮丧的令人费解的错误。

然而，在基类构造函数中进行特定于*派生类的初始化*有点困难，例如在最顶层的 GUI`Widget`类的构造函数中进行一般性操作。

FAQ 项目[“好的，但是有没有办法模拟这种行为，就好像动态绑定在我的基类构造函数中的 this 对象上起作用一样？”](https://isocpp.org/wiki/faq/strange-inheritance#calling-virtuals-from-ctor-idiom) 稍微深入一点。

有关最常见情况的更全面处理，另请参阅我的博客文章[“如何使用零件工厂避免后期施工”](http://alfps.wordpress.com/2010/05/12/how-to-avoid-post-construction-by-using-parts-factories/)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-18T13:13:52.877

不管它是如何实现的，语言定义所说的应该发生的事情是不同的。Java 允许您在尚未完全初始化的派生对象上调用函数（它已被零初始化，但其构造函数尚未运行）。C++ 不允许这样做；在派生类的构造函数运行之前，没有派生类。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-18T14:28:55.170

希望这会有所帮助：

当你的行`new Derived()`执行时，首先发生的是内存分配。该程序将分配一块足够大的内存来容纳 和 的`Base`成员`Derrived`。此时，*没有对象*。这只是未初始化的内存。

当`Base`的构造函数完成时，内存将包含一个类型的对象`Base`，并且类不变量`Base`应该保持不变。那个记忆中仍然没有`Derived`对象。

*在*基的构造过程中，`Base`对象处于部分构造状态，但语言规则足够信任您，可以让您在部分构造的对象上调用自己的成员函数。该`Derived`对象不是部分构造的。它不存在。

您对虚函数的调用最终会调用基类的版本，因为在那个时间点，`Base`它是对象的最派生类型。**如果要调用`Derived::virt`，它将`Derived`使用非 type 的 this 指针`Derrived`**调用 的成员函数，从而破坏类型安全。

从逻辑上讲，一个类是被构造的，有函数调用它，然后被销毁的东西。不能在尚未构造的对象上调用成员函数，也不能在对象被销毁后调用其成员函数。这对 OOP 来说是相当基础的，C++ 语言规则只是帮助你避免做破坏这个模型的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-18T13:11:44.503

在 Java 中，方法调用是基于对象类型的，这就是它表现得那样的原因（我对 c++ 了解不多）。

这里你的对象是 type `Derived`，所以 jvm 调用`Derived`对象上的方法。

如果清楚地理解虚拟概念，java中的等价物是抽象的，那么您现在的代码并不是java术语中的真正虚拟代码。

如果有问题，很高兴更新我的答案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-18T13:22:00.317

> 其实我想知道这个设计决策背后的洞察力是什么

可能在 Java 中，每个类型都派生自 Object，每个 Object 都是某种叶子类型，并且所有对象都在一个 JVM 中构建。

在 C++ 中，许多类型根本不是虚拟的。此外，在 C++ 中，基类和子类可以分别编译为机器码：因此，基类做它所做的事情，而不管它是否是其他东西的超类。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-22T08:06:16.387

# ios - 在 Xcode 中添加框架项目

> ID：13440379
> 
> 赞同：3
> 
> 时间：2012-11-18T13:07:19.617
> 
> 标签：ios, xcode, github, static-libraries

我是 iOS 开发的新手，我找到了一个我想在我的应用程序中使用的库：

[https://github.com/ustwo/US2FormValidator](https://github.com/ustwo/US2FormValidator)

我按照作者在他们的文档中描述的步骤将他们的项目导入我的，但我无法从我的代码中#import 导入的项目的 .h 文件。我还看到目标构建阶段中的库项目仍为红色。也许我没有正确导入项目，我将整个项目文件夹复制到我的文件夹中，然后在我项目的Xcode项目导航器中：右键单击>将文件添加到项目>选择我要导入的项目的.xcodeproj文件，并且已复制到我的项目文件夹中。这是这样做的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T14:28:45.223

我最终通过设置*Header Search Paths*使其工作，之前添加了目标依赖项并将二进制文件与 Build Phases 中的库链接......谢谢大家的回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T15:44:58.160

您似乎已正确导入项目。（您不必将项目文件夹复制到您的文件夹中，但个人喜好...）通常 Xcode 会正确连接头文件和源文件，但我不得不偶尔手动将文件添加到目标的构建阶段窗户。（特别是如果您的子项目构建静态库，则将标头添加到 Copy Headers 构建阶段。）说到这一点，请确保将适当的目标添加到 Target Dependencies 列表中，以便 Xcode 知道编译其必需的文件。

# loops - 计算文件中的行数并存储在变量中

> ID：13440389
> 
> 赞同：11
> 
> 时间：2012-11-18T13:08:40.773
> 
> 标签：loops, powershell, for-loop

我需要计算文本文件中的行数并将其用作循环的循环变量`for`。问题是这样的：

```
$lines = Get-Content -Path PostBackupCheck-Textfile.txt  | Measure-Object -Line 
```

尽管这确实返回了行数，但它以无法与我的循环中的整数进行比较的状态返回它：

```
for ($i=0; $i -le $lines; $i++)
    {Write-Host "Line"} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-18T13:50:06.387

`Measure-Object`返回一个`TextMeasureInfo`对象，而不是整数：

```
PS C:\> $lines = Get-Content .\foo.txt | Measure-Object -Line
PS C:\> $lines.GetType()

IsPublic IsSerial Name                 BaseType
-------- -------- ----                 --------
True     False    TextMeasureInfo      Microsoft.PowerShell.Commands.MeasureInfo 
```

您要使用的信息由该`Lines`对象的属性提供：

```
PS C:\> $lines | Get-Member

   TypeName: Microsoft.PowerShell.Commands.TextMeasureInfo

Name        MemberType Definition
----        ---------- ----------
Equals      Method     bool Equals(System.Object obj)
GetHashCode Method     int GetHashCode()
GetType     Method     type GetType()
ToString    Method     string ToString()
Characters  Property   System.Nullable`1[[System.Int32, mscorlib, Vers...
Lines       Property   System.Nullable`1[[System.Int32, mscorlib, Vers...
Property    Property   System.String Property {get;set;}
Words       Property   System.Nullable`1[[System.Int32, mscorlib, Vers... 
```

该属性返回一个实际的整数：

```
PS C:\> $lines.Lines.GetType()

IsPublic IsSerial Name                 BaseType
-------- -------- ----                 --------
True     True     Int32                System.ValueType

PS C:\> $lines.Lines
5 
```

所以你可以在你的循环中使用它：

```
PS C:\> for ($i = 0; $i -le $lines.Lines; $i++) { echo $i }
0
1
2
3
4
5
PS C:\> _ 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-02-17T20:34:12.460

对于它的价值，我发现上面的示例返回了错误的行数。我发现这返回了正确的计数：

```
$measure = Get-Content c:\yourfile.xyz | Measure-Object 
$lines = $measure.Count
echo "line count is: ${lines}" 
```

您可能想测试这两种方法，以确定是什么给了您想要的答案。使用“Line”返回 20，“Count”返回 24。该文件包含 24 行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-05-02T03:23:40.900

$lines = 获取内容-路径 PostBackupCheck-Textfile.txt | 测量-对象-线 | 选择-展开行

# c++ - dllexport 一个全内联类？

> ID：13440390
> 
> 赞同：4
> 
> 时间：2012-11-18T13:08:48.013
> 
> 标签：c++, visual-c++, dll, dllexport

考虑一个简单的类，它只包含内联的成员函数。例如：

```
template <typename T1, typename T2>
class Point2D {
public:
    typedef Point2D<T1,T2> ThisType;
    typedef T1 Tx;
    typedef T2 Ty;
    T1 x;
    T2 y;
    inline Point2D() : x(0), y(0) {}
    inline Point2D(T1 nx, T2 ny) : x(nx), y(ny) {}
    inline Point2D(const Point2D& b) : x(b.x), y(b.y) {}
    inline Point2D& operator=(const Point2D& b) { x=b.x; y=b.y; return *this; }
    inline ~Point2D() {}
};

typedef Point2D<int,int> Int2; 
```

当我想导出到 DLL 的`Int2`另一个类（例如 class `MyClass`、 member ）中使用类型对象时，我收到以下警告：`Int2 point`

警告 C4251：“MyClass::point”：“Point2D”类需要有 dll 接口才能供“MyClass”类的客户端使用

但是，如果我`__declspec(dllexport)`按照警告提示输入“Point2D”的定义（这对我来说似乎很愚蠢，因为所有函数都是内联的，而且它是一个模板，[请参阅 SO question](https://stackoverflow.com/questions/8876279/c-inline-functions-with-dllimport-dllexport)），我在尝试使用时收到以下错误另一个项目中的 DLL：

错误 LNK2019：无法解析的外部符号“__declspec(dllimport) public: __thiscall lwin::Point2D::Point2D(int,int)” ...

请注意， 的定义`Point2D`在所有项目可见的标题中给出。

我应该怎么办？跳过`dllexport`并忽略警告？还是有一些巧妙的技巧可以避免这种编译器混淆？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:13:17.107

用`Int2`成员替换成员来解决这个问题。在构造函数中创建实例并在析构函数中删除。`MyClass``Int2*``Int2``MyClass``MyClass`

模板类无法导出，因此您不能将其声明为 `__declspec(dllexport)`. 显示 C4251，因为容器类大小可能不同，如果 Dll 及其客户端使用不同的编译选项进行编译，则会导致未定义的行为。另一方面，指针始终具有相同的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-09T12:04:04.610

尝试将`__declspec(dllexport)`/`__declspec(dllimport)`分别添加到每个内联方法。对于非模板类，这将是一个错误，但模板类/函数似乎也需要添加这个 per-method。

# javascript - 我可以将函数名作为数组变量吗？

> ID：13440391
> 
> 赞同：1
> 
> 时间：2012-11-18T13:09:02.153
> 
> 标签：javascript, function

我可以有这样的 JavaScript 循环吗？

```
SB = new Array;

for (i = 1; i < 6; i++) {

   function SB[i]() {

         (code)

   } // end of function

} // end of for loop 
```

我知道这行不通，但我怎么能做出这样的事情呢？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:10:23.440

创建一个匿名函数并将其返回给变量。

```
var SB = [];
for (i=1;i<6;i++) {
    SB[i] = function() {
        //(code)
    }
} 
```

请注意，javascript 中的数组是 0 索引的。

因此，您使用获取数组中的第一项

```
myArray[0] 
```

最后一次使用

```
myArray[ myArray.length - 1 ] 
```

* * *

所以我认为你想循环 `i=0`：

```
var SB = [];
for ( var i = 0; i < 5 ; i++) {
    SB[i] = function() {
        //(code)
    }
} 
```

……

```
console.log(SB) // [function() {},function() {},function() {},function() {},function() {}] 
```

代替：

```
[undefined, function() {}, function() {}, function() {}, function() {}, function() {}] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T13:10:23.243

```
var SB=[];
for (i=1;i<6;i++) {
    SB[i] = function () {
        ...
    }
} 
```

您现在可以这样调用它：

```
SB[1](); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T13:10:19.693

使用括号表示法：

```
for ( var i = 1; i < 6; i++ ) {

    SB[i] = function() {

    };

} 
```

这会将函数表达式附加到索引处的数组`i`。你可以这样称呼它：

```
SB[ 1 ]();
SB[ 2 ]();

// etc.. 
```

# python - 如何将python 2编写的程序编译成exe

> ID：13440396
> 
> 赞同：0
> 
> 时间：2012-11-18T13:09:53.330
> 
> 标签：python, pyinstaller

请帮我在 Windows 的 exe 文件中构建程序，我的应用程序是用 python 2 编写的。为此，我尝试使用 pyinstaller

pyinstaller 手册在这里：[http ://www.pyinstaller.org/export/develop/project/doc/Manual.pdf](http://www.pyinstaller.org/export/develop/project/doc/Manual.pdf)

结果，我得到了一个文件，但它不是 exe

我问你们朋友，向我解释一下如何正确地做到这一点

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T14:11:39.423

使用 py2exe 为 Windows 构建 exe。

您可以从这里下载 py2exe：http: [//sourceforge.net/projects/py2exe/](http://sourceforge.net/projects/py2exe/)

你可以在这里找到教程：http: [//www.py2exe.org/index.cgi/Tutorial](http://www.py2exe.org/index.cgi/Tutorial)

# ios - UIView工厂创建过程

> ID：13440406
> 
> 赞同：1
> 
> 时间：2012-11-18T13:10:37.393
> 
> 标签：ios, uiview, delegates, factory

我有一个可以绘制图表的视图......将会有不止一种图表类型......我如何将它们包装在工厂类中？所以我有一个`MyChart`类（`UIView`子类）......如果用户可以做类似的事情：

```
MyChart *chart = [[Mychart alloc] initWithFrame:frame andType:1]; 
```

并且图表实际上将成为一个`MyLineChart`对象......或 myChart 可以创建的其他对象？我是否只是在 myChart 类的 init 中创建 thouse 视图 .. 并返回它们而不是返回 self？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:41:12.830

像这样的伪代码

```
typedef enum {
    MyChartTypeLine,
    MyChartTypePoint,
    ...
} MyChartType;

MyLineChart *chart = [MyChart chartWithType:MyChartTypeLine]; 
```

在 MyChart.m 添加一个类方法：

```
+ (id)chartWithType:(MyChartType)type
{
    switch (type) {
        case MyChartTypeLine:
            return [[MyLineChart alloc] init];
        case...
    }
    return nil;
} 
```

# html - 如何根据计数器添加图像？

> ID：13440407
> 
> 赞同：0
> 
> 时间：2012-11-18T13:10:47.330
> 
> 标签：html

我想创建一个获取外部信息的网页，并以图像数量显示计数。例如：如果它得到 10，它将显示 10 杯水。最好的方法是什么？

谢谢！

谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:22:00.553

要添加到@HasanTahsin 的答案，请使用 jQuery（它比纯 javascript 更容易）：

```
// Add jQuery
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

// Your script for adding images
<script type="text/javascript">
    $(document).ready(function(){
        for (i=1; i <=n; i++) $(<selector to add html>).append('<img src="blabla"/>');
    });
</script> 
```

n 在您的示例 10 中。

对于外部信息，您将需要一些服务器端客户端（PHP、python 等）来为您进行选择。您可以通过 ajax 调用它，再次使用 jQuery，它就像[`$.get()`](http://api.jquery.com/jQuery.get/)

这是一个[例子](http://openenergymonitor.org/emon/node/107)。

# javascript - 如何获取所有输入值并进行加法

> ID：13440411
> 
> 赞同：0
> 
> 时间：2012-11-18T13:11:12.080
> 
> 标签：javascript, jquery

```
 <ul class="liste_couleur_qty">
         <li style="margin-bottom: 20px;">
                <dl>
                        <table width="200" border="0">
                      <tbody><tr>
                        <td width="50%">
                        <span style="display: block; font-size: 13px; line-height: 16px; margin-bottom: 2px;margin-right: 0px;margin-left: 20px;">Noir</span>
                    </td>

                        <td width="50%"><div class="add-to-cart">

                          <label for="qty-2195">qty :</label>

                          <input type="text" class="input-text qty calcul_qty_product" title="Qté" value="0" autocomplete="off" maxlength="5" data-product_color="127" id="qty-2195" name="qty-2195" onblur="addToCartPlus(2195, 127, this);">

                        </div></td>
                      </tr>
                    </tbody></table>
                    </dl>
            </li>

            <li style="margin-bottom: 20px;">
                <dl>
                        <table width="200" border="0">
                      <tbody><tr>
                        <td width="50%">
                        <span style="display: block; font-size: 13px; line-height: 16px; margin-bottom: 2px;margin-right: 0px;margin-left: 20px;">Blanc</span>
                    </td>

                        <td width="50%"><div class="add-to-cart">

                          <label for="qty-2196">qty :</label>

                          <input type="text" class="input-text qty calcul_qty_product" title="Qté" value="0" autocomplete="off" maxlength="5"  id="qty-2196" name="qty-2196" onblur="addToCartPlus();">

                        </div></td>
                      </tr>
                    </tbody></table>
                    </dl>
            </li>
<li style="margin-bottom: 20px;">
                <dl>
                        <table width="200" border="0">
                      <tbody><tr>
                        <td width="50%">
                        <span style="display: block; font-size: 13px; line-height: 16px; margin-bottom: 2px;margin-right: 0px;margin-left: 20px;">Blanc</span>
                    </td>

                        <td width="50%"><div class="add-to-cart">

                          <label for="qty-2196">qty :</label>

                          <input type="text" class="input-text qty calcul_qty_product" title="Qté" value="0" autocomplete="off" maxlength="5"  id="qty-2196" name="qty-2196" onblur="addToCartPlus();">

                        </div></td>
                      </tr>
                    </tbody></table>
                    </dl>
            </li>

                </ul> 
```

如何获取所有输入值，然后将它们全部添加到变量中。如果在 jquery 中，我知道该怎么做。

```
var length = $('liste_couleur_qty li input').length;
var input = $('liste_couleur_qty li input').val;
for(var i=0;i< length;i++){
  var result += input;
} 
```

结果将得到所有值。但我的代码仍然无法工作。我的 jquery 代码有什么问题？如果我不想使用 jquery 只使用 javascript。我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:15:57.067

这应该适用于 jQuery：

```
var result = "";
$('liste_couleur_qty li input').each(function() {
   result += $(this).val();
}); 
```

第一：`jQuery.val`不是属性，而是方法。第二：它将返回结果集中第一个元素的值，而不是所有值。第三：在您的 for 循环中-我什至无法猜测您要做什么。您总是使用相同的值`length`时间。此外，一旦您尝试获取数值，您应该使用[undefined](https://stackoverflow.com/a/13440475/1558311)`parseInt/parseFloat`提到的方法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T13:16:04.417

```
var result = 0;
$('.liste_couleur_qty li input').each(function(){
    result += $(this).val();
});
console.log(result); 
```

这并不完全准确。正如@undefined 所指出的，您需要使用`parseInt`来执行数字加法而不是连接。那是：

```
result += parseInt($(this).val()); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-18T13:17:51.947

你的选择器什么都没有选择，你错过了`.`类选择器，也是`val`一个方法而不是一个属性，你可以使用`each`方法和`parseInt`函数：

```
var result = 0;
$('.liste_couleur_qty li input').each(function(){
     result += parseInt(this.value, 10);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-18T13:16:08.490

```
var length = $('liste_couleur_qty li input').length;
var input = $('liste_couleur_qty li input').val();
for(var i=0;i< length;i++){
  var result += input;
} 
```

# qt - Qt app 64位架构错误

> ID：13440413
> 
> 赞同：0
> 
> 时间：2012-11-18T13:11:25.710
> 
> 标签：qt, qt-creator

我正在研究 Qt 并向我的 Qt Gui 应用程序添加插槽时出现以下错误。

```
 symbol(s) not found for architecture x86_64. 
```

当我注释掉`slots`块时，一切似乎都很好。

```
public slots: 
```

QtCreator 中是否存在某种错误，或者我做错了什么。

我在 Mac Osx 10.8（山狮）上使用基于 Qt 4.8.3（64 位）的 Qt Creator 2.5.2

`Edit:`这是我的完整课程

```
#include <QMainWindow>
#include "qextserialport.h"

namespace Ui {
class MainWindow;
}

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();

private:
    Ui::MainWindow *ui;
    QextSerialPort *port;

public slots:
    void onDataAvailable();
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T00:40:40.043

从您发布的代码来看，您似乎没有实现您的插槽功能。这样就可以解释了。

如果你这样做了，那么你可能必须删除 makefile 并重新生成它：

```
make distclean
qmake 
```

以便更新 moc 规则。

# java - getLocation() 总是返回 null，搜索 Twitter

> ID：13440414
> 
> 赞同：2
> 
> 时间：2012-11-18T13:11:32.320
> 
> 标签：java, get, twitter, twitter4j

每次我在推文中搜索位置时，它都会返回 null，这是我的代码，有什么想法吗？

```
ConfigurationBuilder cb = new ConfigurationBuilder();
cb.setOAuthConsumerKey("8888888888888888888");
cb.setOAuthConsumerSecret("8888888888888888888888888");
cb.setOAuthAccessToken("8888888888888888888888");
cb.setOAuthAccessTokenSecret("8888888888888888888888888888");

Twitter twitter = new TwitterFactory(cb.build()).getInstance();
Query query = new Query("London");
query.setRpp(1000000);

QueryResult result = twitter.search(query);

ArrayList tweets = (ArrayList) result.getTweets();

for (int i = 0; i < tweets.size(); i++) {
  Tweet t = (Tweet) tweets.get(i);
  String user = t.getFromUser();
  GeoLocation l = t.getGeoLocation();
  String locNam = t.getLocation();
  String msg = t.getText();
  Date d = t.getCreatedAt();
  println(locNam + ""); 
```

我可以`getGeoLocation()`正常工作，它们很少而且相距甚远，但是我确实得到了一些，但是`getLocation`每次搜索都返回null。

任何帮助，将不胜感激！干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T14:37:10.177

@JohnSmith，我让它工作了。

如果用户单击按钮以将位置添加到他们的推文，则结果是 Status.getLocation()（或 Tweet.getLocation()）有效。如果您选择不这样做，则不会发布您的位置，并将返回 null。

我使用我的测试 Twitter 帐户对此进行了测试：[@Saviour_Self](https://twitter.com/Saviour_Self "@Saviour_Self") 在我最近的帖子中，我提供了一个位置，当我运行我的应用程序时，它返回了该位置。我运行了一个循环以从我的帐户中获取所有状态更新，其中只有一个返回了位置。

```
for (Status s : tweets) {
    System.out.println(s.getLocation()); //Returned the location of the tweet.
    System.out.println(s.getUser().getLocation());  /* Returned the 
                                              User Profile  Location (always constant)*/
} 
```

请记住，我使用 JTwitter 来执行此操作，而不是 Twitter4j，但结果应该是相同的。继续在我的帐户上测试您的程序。只有最近的帖子才会返回非空位置。

# java - 如何在 Tomcat 5.5.x 中部署 EJB 3.1

> ID：13440421
> 
> 赞同：1
> 
> 时间：2012-11-18T13:12:11.610
> 
> 标签：java, jakarta-ee, ejb-3.1, openejb

我有支持的托管计划

i) Tomcat - 5.5.xSupport

ii) JDK - 1.6.x 支持

iii) JSP/servlet - 2.0 支持

我可以在此设置上部署 EJB 3.1 吗？我听说 Tomcat 不支持 EJB，但希望有一个解决方法。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T13:14:08.807

没错，Tomcat*只是*一个 servlet 容器，因此您可以部署 servlet 和 JSP，但不能部署 EJB。您需要像 JBoss 或 Glassfish 这样的应用程序服务器。

还有一个构建在 Tomcat 之上的[Apache TomEE](http://tomee.apache.org/apache-tomee.html)项目，您可能可以在 Tomcat 中嵌入一些轻量级的 EJB 容器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T13:40:08.087

如果我没记错的话，Apache TomEE 以前是 openEJB 项目。您可以使用提供的 openEJB 库在您的 tomcat 实例上部署 ejb。有关如何设置的更多信息，请访问以下链接：

[http://openejb.codehaus.org/tomcat.html](http://openejb.codehaus.org/tomcat.html)

# android - Android split ActionBar - 更改图标的布局

> ID：13440427
> 
> 赞同：4
> 
> 时间：2012-11-18T13:13:02.870
> 
> 标签：android, split, android-actionbar

好的，这个问题很快，如何更改拆分操作栏中​​的操作栏图标的布局定位？

在我的应用程序中，它们总是均匀地放置在底部操作栏的所有宽度上，但我希望能够将一些向右对齐，另一些向左对齐。

我应该如何处理这个？

非常感谢你:)

PS：我正在使用 ActionBarSherlock，以防万一。

* * *

***编辑：***

这是我的应用程序屏幕之一：

![按钮放置均匀](../Images/ce6549d1c7784b6bb4ff2e3856c4f521.png)

这就是我希望它现在的样子：

![按钮理想地放置在右侧](../Images/8715248b4f79246de59cb18dd5238160.png)

这就是我希望它带有三个按钮的样子：

![3 个按钮位置理想](../Images/2e34844ccbe8b59549f259159b9acd68.png)

* * *

我已经通过 menu.xml 文件添加了这些项目：

```
<menu xmlns:android="http://schemas.android.com/apk/res/android" >
    <item
        android:id="@+id/AB_add"
        android:icon="@android:drawable/ic_menu_add"
        android:showAsAction="always"
        android:title="@string/menu_add_item_to_shopping_list">
    </item>
    <item
        android:id="@+id/AB_delete"
        android:icon="@android:drawable/ic_menu_delete"
        android:showAsAction="always"
        android:title="@string/menu_delete_item_from_shopping_list">
    </item>
</menu> 
```

并通过 onCreateOptionsMenu() 实例化它们

```
 public boolean onCreateOptionsMenu(Menu menu) {
            MenuInflater inflater = getSupportMenuInflater();

            inflater.inflate(R.menu.activity_recipe_detail, menu);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T03:22:00.033

我认为这个问题可以通过一种丑陋的方式解决，希望这对你有帮助

```
<menu xmlns:android="http://schemas.android.com/apk/res/android" >
    <item
        android:id="@+id/action_write1"
        android:icon="@drawable/statusnewactivity_send_light"
        android:showAsAction="always"
        android:title="reply1"/>
    <item
        android:id="@+id/space1"
        android:checkable="false"
        android:enabled="false"
        android:showAsAction="always"/>
    <item
        android:id="@+id/space2"
        android:checkable="false"
        android:enabled="false"
        android:showAsAction="always"/>
    <item
        android:id="@+id/action_write2"
        android:icon="@drawable/statusnewactivity_send_light"
        android:showAsAction="always"
        android:title="reply2"/>
    <item
        android:id="@+id/action_write3"
        android:icon="@drawable/statusnewactivity_send_light"
        android:showAsAction="always"
        android:title="reply3"/>
</menu> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T16:03:23.240

不幸的是，使用标准 Android ActionBar 代码或 ActionBarSherlock 无法实现这一点。我遇到了类似的问题，发现处理它的唯一方法是使用类似于 ActionBar 的自定义 LinearLayout。

根据您使用的设备，拆分的 ActionBar 看起来会非常不同。在手机（“窄”屏幕）上，它将显示在屏幕底部。但是，在横向模式或平板电脑上，它根本不会被拆分。这也会影响您是否要进行自定义工作的决定。

# java - 如何将 JDK 附带的 Java DB 集成到 Netbeans 6.9.1

> ID：13440430
> 
> 赞同：0
> 
> 时间：2012-11-18T13:13:34.100
> 
> 标签：java, jdbc, netbeans-6.9

我正在使用 Netbeans IDE 6.9.1 和 jdk1.7.0_04 x64。我在 Netbeans 的“服务”选项卡的“数据库”节点中没有得到任何东西？

如何在 Netbeans 中集成 Java DB？我必须为 Netbeans 下载任何工具吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T11:23:53.150

我得到了答案，我不知道，但它不适用于 Netbeans 6.9.1，我重新安装了它但找不到。然后我安装了最新的 Netbeans - 7.2.1，我让它工作了。Netbeans 7.2.1 集成了 Java DB。

谢谢大家。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T05:48:09.303

您需要创建与数据库的新连接。

在“服务”选项卡中，右键单击“数据库”-->“新建连接”。

应该打开新的连接向导。从组合框中选择驱动程序。Netbeans 应反映所选 jdbc 驱动程序类型的路径。点击下一步。

提供 JDBC 连接 URL 参数，如主机、用户名、密码，然后单击“测试连接”。

您应该收到“连接成功”消息，否则检查参数值。

单击完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-28T17:34:20.943

根据[NetBeans Docs & Support](https://netbeans.org/kb/docs/ide/java-db.html)，我们需要有 NetBeans 7.0、7.1、7.2、7.3 或 Java EE 才能使用 JavaDB。

# angularjs - Angularjs 指令解析控制器集合

> ID：13440432
> 
> 赞同：0
> 
> 时间：2012-11-18T13:13:47.423
> 
> 标签：angularjs

在 angularjs 中处理寻呼机指令。当我对示例集合 ($scope.installations) 进行硬编码时，一切正常，但是当我从服务器中提取数据时，指令中的“选项”属性始终为“未定义”。

这是我的指令：

```
angular.module("qusion.ui.pager", [])
    .directive("qnPager", [
        function() {
            return {
                restrict: 'A',
                link: function(scope, element, attrs) {
                    var options = scope.$eval(attrs.qnPager);
                    var settings = {
                        source: null,
                        paging: null,
                        schema: {
                            page: 'PageNumber',
                            size: 'Size',
                            totalPages: 'TotalPages',
                            totalCount: 'TotalCount'
                        }
                    };

                    angular.extend(settings, options);

                    scope.$watch(settings.source, function(value) {
                        console.log(settings.source); // UNDEFINED ???
                    });

                }
            };
        }
    ]); 
```

我是这样称呼它的。

```
<ul qn:pager="{source: installations}"> 
```

最后是我的控制器示例

```
function MyController(Installation){
   $scope.installations = [];
   // get sample (this works)
   // $scope.installations = [{ID: 1, Title: 'Test 1'}, {ID: 2, Title: 'Test 2'}]
   // get from server (this don't work)
   Installation.getAll().then(function(data) {
       $scope.installations = data.Installations;
   });

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T04:20:23.240

看看这是否解决了你的问题：

而不是分配一个新的数据阵列安装 - 即，而不是`$scope.installations = data.Installations;`- 尝试填充相同的阵列。当您为安装分配一个新数据数组时，您可能会丢失与旧数组的绑定——即，该指令可能仍绑定到以前的数据数组。

```
$scope.installations.length = 0
for(var i = 0; i < data.Installations.length; i++){
    $scope.installations.push(data.Installations[i]);
} 
```

有关更多信息，请参阅[https://stackoverflow.com/a/12287364/215945](https://stackoverflow.com/a/12287364/215945)。

**更新：** 可以/应该使用[angular.copy()代替：](http://docs.angularjs.org/api/angular.copy)

```
angular.copy(data.Installations, $scope.installations); 
```

当向 copy() 方法提供目标时，它将首先删除目标的元素，然后从源中复制新的元素。

# android - android Wifilock-移动数据访问锁怎么样？

> ID：13440433
> 
> 赞同：6
> 
> 时间：2012-11-18T13:13:47.517
> 
> 标签：android, android-wifi, 3g-network

如果有一个 wifiLock 用于获取 wifi 并使其即使在手机空闲和睡眠时也能正常工作，是否恰好有它的对应物用于移动数据访问？

您会看到，如果用户处于 wifi 连接状态，现在一切正常。但不知何故，使用移动数据访问，当手机空闲时，它似乎正在断开连接。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T13:21:30.067

移动数据不会进入休眠状态。但是，如果您的套接字保持打开状态并且有一段时间未使用，它可能会被关闭。这就是为什么 C2DM（可能还有 GCM）必须每 30 分钟左右发送一次心跳，以确保与 Google 服务器的开放套接字连接保持打开状态。

# c++ - 无法解释的向量的“std::out_of_range”

> ID：13440434
> 
> 赞同：-1
> 
> 时间：2012-11-18T13:13:52.490
> 
> 标签：c++

我有一个无法解释的向量超出范围错误！

```
for (unsigned int i = 0; i < studentsVector.size(); i++) {

    bool anyFailedFacultyCourse = false;
    bool anyFailedElectiveCourse = false;
    // Check if all faculty courses are done
    std::cout << currentSemester << std::endl;
    if (currentSemester > 1) {
        std::cout << "hi" << std::endl;

        for (int j = 0; j < currentSemester - 1; j++) {
            if (studentsVector.at(i)->getPlan().at(j).size() > 0) {

                anyFailedFacultyCourse = true;
            }
        }

        std::cout << "bye" << std::endl; 
```

调试后，我注意到程序确实进入了第一个 for 循环，为 and 分配了适当的值`AnyFailedFacultyCourse`，`anyFailedElectiveCourse`打印了 int `currentSemester`。它停在那里！我在以下位置放置了一个调试断点：

```
if (currentSemester > 1) 
```

它甚至在它检查之前给了我一个`out_of_range error`！这意味着它甚至没有进入`if (currentSemester > 1)` 但两者之间没有任何东西！我的意思是，当它抛出错误的地方，我对任何向量什么都没做时，它怎么会抛出类似的东西！

我知道这有点神秘，请询问您需要的任何进一步信息。

更多信息：如何声明学生向量：

```
std::vector<Student*> studentsVector;
currentSemester:

int currentSemester = 1; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:25:30.603

我敢打赌，您设置的断点不会被触发，因为条件不是`true`：也就是说，`currentSemester`条件`1`很清楚`false`，代码会跳到条件块之后发生的任何事情。但是，您还没有展示那里发生了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T13:33:53.720

> ```
> for (int j = 0; j < currentSemester - 1; j++) {
>        if (studentsVector.at(i)->getPlan().at(j).size() > 0) { 
> ```

在这里你不检查`studentsVector.at(i)->getPlan()`有`j`元素。您的代码只是根据实际情况假设它`currentSemester`，但您从不检查。很明显，这种相关性已经在某个地方崩溃了。

# gem - 如何重命名宝石？

> ID：13440438
> 
> 赞同：22
> 
> 时间：2012-11-18T13:14:01.230
> 
> 标签：gem, rubygems

我有一个我想重命名的宝石。它[发布在 RubyGems 上](https://rubygems.org/gems/croptoelie)。我最关心的是想要更新它的人。

我看到了两条路径，但真的很想听听那些重命名他们的 gem 的人，他们是如何做到的。

## 1.把旧的变成一个元包

*   创建一个新的 gem（命名为`smart-cropper`）
*   添加`smart-cropper`为`croptoelie`（旧宝石）的依赖项
*   删除所有的库、箱和其他代码`croptoelie`

我看到的一个问题是它太透明了，人们可能没有意识到他们使用的 gem 不再被维护。

另一个问题是版本控制变得更加困难：每次我发布重命名 ( `smart-cropper`) gem 的新版本时，我都必须升级旧“元包”的版本，否则人们将永远无法获得新版本。

## 2.抛出弃用警告

我可以发送旧版 gem 的版本，它会简单地抛出弃用警告以及人们应该安装新版 gem 的消息。

我看到的问题是它可能非常具有侵入性，并且可能使人们[1] 完全远离宝石。

还有其他选择吗？“RubyGems”中是否内置了一些东西来适应名称的变化？

[1] 没有太多人在使用它；因为名字很难找到。:)

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-04T01:21:09.323

*您只需使用新名称推送新 gem 并告诉您的用户新名称。没有重命名宝石的机制。*-- [RubyGems 支持人员，2012 年 2 月 20 日](http://help.rubygems.org/discussions/questions/104-how-should-i-handle-the-rename-of-a-gem)

为此，以下是一些技巧（其中一些我看到你已经完成了）。

## 在旧宝石中，抛出弃用警告

例子：

```
warn "[DEPRECATION] This gem has been renamed to _____ and will no longer be supported. Please switch to _____ as soon as possible." 
```

## 在旧宝石的`.gemspec`文件中

安装旧 gem 后使用[post_install_message](http://guides.rubygems.org/specification-reference/#post_install_message)属性显示一条消息。以下示例基于[Heroku gem](https://github.com/heroku/heroku/blob/master/heroku.gemspec#L15-L19)。

```
gem.post_install_message = <<-MESSAGE
!    The '_____' gem has been deprecated and has been replaced by '_____'.
!    See: https://rubygems.org/gems/_____
!    And: https://github.com/_____/_____
MESSAGE 
```

## 在旧的 GitHub 存储库页面上

-1- 在页面顶部：*向此存储库添加描述：（*提供新名称）

```
Moved to ---> "_____". 
```

-2- 在页面顶部：*将网站添加到此存储库：（*将此作为新存储库的 URL）

```
https://github.com/_____/_____ 
```

-3- 上传新的`README.markdown`：

```
# OLD NAME

Moved to [new name](https://github.com/_____/_____). 
```

-4- 考虑删除所有非必要文件。

## 在新 gem 的`.gemspec`文件中

`summary`在or`description`属性的末尾包含以下通知：

```
Formerly known as '_____'. 
```

## 拉出旧宝石

在某个遥远的地方，您可能想要从 RubyGems 中删除旧的 gem。从 RubyGems`1.3.6`和 gemcutter `0.5.0`（大约 2010 年 2 月）开始，您可以使用*gem install 和其他 gem 命令*`gem yank`来删除您的 gem。但是，gem 仍然可以下载，主要原因有两个：

 *1.  可能已推送其他宝石，具体取决于您的宝石。
2.  可以轻松防止大量删除基于社区的重要 gem。

[转到此处以获取有关 yank 的更多信息。](http://help.rubygems.org/kb/gemcutter/removing-a-published-rubygem)*

# ruby-on-rails - 使用 RSpec 和 Factory Girl 进行模拟时获取重复项

> ID：13440442
> 
> 赞同：1
> 
> 时间：2012-11-18T13:14:20.473
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, rspec2, factory-bot

当使用 factory girl 和 RSpec 来测试我的控制器时，我得到了错误：

```
Failures:

  1) ProductsController Handling POST for create should redirect to products after success
     Failure/Error: response.should redirect_to(products_path)
        Expected response to be a <:redirect>, but was <200> 
```

根据日志文件，看起来对象已经存在于数据库中（并且不满足控制器中的重定向子句），这引发了两个问题：

1.  为什么电话没有被嘲笑/存根？
2.  如果我想访问数据库，解决方法是什么？使用`@params = FactoryGirl.build(:product).attributes.except(:id, :created_at, :updated_at)`也不行。

任何帮助都是极好的。谢谢你。

测试日志：

```
Processing by ProductsController#create as HTML
Parameters: {"product"=>{"name"=>"Fruit Mania", "description"=>"The mania that is taking over the planet!", "price"=>"9.99", "inventory"=>"1", "product_image"=>"#<File:0x00
User Load (0.3ms)  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
Product Exists (0.1ms)  SELECT 1 AS one FROM "products" WHERE LOWER("products"."name") = LOWER('Fruit Mania') LIMIT 1 
```

products_controller_spec.rb：

```
describe ProductsController, "Handling POST for create" do
  def sign_in_user
    user = FactoryGirl.create(:user)
    sign_in user, @user
  end

  def do_post
    post :create, :product => @params
  end

  before do
    @product = mock_model(Product, :save=> true)
    Product.stub!(:create).and_return(@product)
    @params = FactoryGirl.attributes_for(:product)
  end

  it "should redirect to products after success" do 
     sign_in_user
     do_post
     pending "need to figure out why redirect fails"
     response.should redirect_to(products_path)
  end
end 
```

工厂：

```
FactoryGirl.define do
  factory :product do
    name "Fruit Mania"
    description "The mania that is taking over the planet!"
    price "9.99"
    inventory 1
    product_image { File.open(File.join(Rails.root, 'spec', 'support', 'uploads', '1000x450.jpeg')) }
  end
end 
```

控制器：

```
 def create
    @product = Product.new(params[:product])
    if !@product.valid?
      flash.now[:error] = ("The product was not added: <br><li>" + @product.errors.full_messages.join("<li>")).html_safe
      render "new"
    else
      if @product.save
        redirect_to products_path, :notice => "Product created successfully!"
      else
        flash.now[:error] = ("There were issues adding the product to the database. Please retry")
        render "new"
      end
    end
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:44:46.667

我可以告诉你为什么首先发生数据库调用。

你应该替换这一行：

```
Product.stub!(:create).and_return(@product) 
```

和：

```
Product.any_instance.stub!(:save).and_return(true) 
```

您正在对类方法进行存根`Product::create`，但您确实需要对实例方法进行存根`Product#save`。

我想以下方法也可以：

```
Product.stub!(:new).and_return(@product)
@product.stub(:save).and_return(true) 
```

由于`save`您无法通过`render`给出 HTTP 响应 200 的路径，而不是您期望的 302。

至于它为什么要访问数据库，恐怕我不能说为什么模型已经存在于给定的上下文中。如果你只运行这个单一的测试，它有效吗？尝试查看这个问题以获得更多想法：

[为什么 factory_girl 不为我进行交易操作？- 测试后行保留在数据库中](https://stackoverflow.com/questions/3497135/why-isnt-factory-girl-operating-transactionally-for-me-rows-remain-in-databa/3498959#3498959)

我希望这会有所帮助。

# php - 将带有列表文件的数组传递给 curl 循环

> ID：13440445
> 
> 赞同：0
> 
> 时间：2012-11-18T13:14:35.160
> 
> 标签：php, arrays, file, list, curl

我怀疑我是否可以将包含文件链接的数组传递给 curl 循环以创建单个循环，而不是每次我需要上传文件内容时，复制并粘贴具有不同文件名的相同 curl 调用.

这是我编写的将单个文件上传到服务器的代码。我为每个文件复制并粘贴相同的代码，这样一切正常，但我想了解如何创建一个循环给“$data = array('file'=>$fn);” 包含所有文件内容的循环，并在调用函数“file_get_contents($fn)”时自动执行一个函数中的所有调用。

```
//file to upload

$fn = ("fn.rdf");

//curl loop to upload single file
    $data = array('file'=>$fn);
    $ch = curl_init(); 
    curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: application/rdf+xml'));
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_URL, 'http://www.example.com/index.php?update=true');
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, file_get_contents($fn));  
    curl_exec($ch);
    $info = curl_getinfo($ch); var_dump($info);
    $result = curl_exec($ch); 
     if ($result === false) {
       die(curl_error());
     }else{
       echo "<br>"."upload ok"."<br>";
     } 
```

谢谢！

编辑：嗨，我再次有疑问。如果我想将该脚本用作函数以将其方法调用到另一个脚本中，该脚本逐篇阅读文章，那么我必须将 `function updateContent(){}`调用方法放入另一个脚本中`updateContent()`？正如我已经说过的， $fn 包含一个带有文件列表的数组。如果我想调用`updateContent()`创建但仅针对特定的 file1.rdf 是否正确使用该命令`updateContent($files['0']);`调用仅为元素 0（对应于提到的数组的 file1.rdf）指定的方法来更新它的状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:28:03.153

你的意思是这样的吗？

```
$files = array('1.rdf', '2.rdf', '3.rdf', 'x.rdf', 'whatever.xyz');

$ch = curl_init(); 
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: application/rdf+xml'));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_URL, 'http://www.example.com/index.php?update=true');
curl_setopt($ch, CURLOPT_POST, true);

foreach ($files as $fn) {
    curl_setopt($ch, CURLOPT_POSTFIELDS, file_get_contents($fn));  
    $result = curl_exec($ch);
    $info = curl_getinfo($ch); 
    var_dump($info);
    if ($result === false) {
       die(curl_error());
    }else{
       echo "<br />".$fn." upload ok"."<br />";
    }
} 
```

# wordpress - 管理员添加新用户（wordpress）时添加自定义字段？

> ID：13440447
> 
> 赞同：1
> 
> 时间：2012-11-18T13:15:14.547
> 
> 标签：wordpress, admin, field, add

当管理员添加新用户（Wordpress）时，我很感兴趣如何添加字段（作为输入）。不是在用户注册时，而是在管理员添加新用户时。例如，我在网上找到了，但仅适用于要编辑用户的字段，但我想添加新用户。以及来自输入的新数据——并将它们保存在用户元表中。有没有人做这个练习。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-06T03:35:38.800

~~重新审视这个有趣的问题，我会说不，**这是不可能的**。~~

分析文件[**`/wp-admin/user-new.php`**](http://core.trac.wordpress.org/browser/tags/3.5.1/wp-admin/user-new.php)，没有允许这样做的**动作挂钩。**甚至在`<form>`导致无处可循的功能。

一个可能且肮脏的解决方案是使用 jQuery 注入字段。

将新用户添加到数据库时，我们可以使用挂钩[**`user_profile_update_errors`**](http://core.trac.wordpress.org/browser/tags/3.5.1/wp-admin/includes/user.php#L153)来更新用户元数据（也可以作为 hack）。

**更新：**可以添加一个新字段：

```
add_action( 'user_new_form', function( $type ){
    if( 'add-new-user' !== $type )
        return;
    echo '<input type="text" name="custom_user_field" id="custom_user_field" value=""/>';
}); 
```

要获取发布的数据并对其进行处理，请使用：

```
add_action( 'user_profile_update_errors', function( $data )
{
    if ( is_wp_error( $data->errors ) && ! empty( $data->errors ) ) 
        return;

    # Do your thing with $_POST['custom_user_field'] 
    wp_die( sprintf( '<pre>%s</pre>', print_r( $_POST, true ) ) );
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-05T09:54:03.430

由于 wordpress 3.7 有一个钩子。

使用钩子“user_new_form”。它在提交按钮被插入之前触发。这样您就可以在新用户表单中显示您自己的自定义字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-17T15:31:05.220

我发现这里建议的“user_profile_update_errors”钩子没有给我 user_id 来让我保存元字段。因此，我改为使用“user_register”，如下面的代码所示。

希望这会对其他人有所帮助。

```
//  add fields to new user form
add_action( 'user_new_form', 'mktbn_user_new_form' );

function mktbn_user_new_form()
{
?>    

<table class="form-table">
    <tbody>
    <tr class="form-field">
        <th scope="row"><label for="business_name">Company </label></th>
        <td><input name="business_name" type="text" id="business_name" value=""></td>
    </tr>    

    <tr class="form-field">
        <th scope="row"><label for="business_type">Profession </label></th>
        <td><input name="business_type" type="text" id="business_type" value=""></td>
    </tr>    

    <tr class="form-field">
        <th scope="row"><label for="user_mobile">Mobile </label></th>
        <td><input name="user_mobile" type="text" id="user_mobile" value=""></td>
    </tr>

    </tbody>
</table>

<?php   
}

//  process the extra fields for new user form
add_action( 'user_register', 'mktbn_user_register', 10, 1 );

function mktbn_user_register( $user_id )
{
    mikakoo_log( 'user_register: ' . $user_id );

    if ( isset( $_POST['business_name'] ))
    {
        update_user_meta($user_id, 'business_name', $_POST['business_name']);
    }

    if ( isset( $_POST['business_type'] ))
    {
        update_user_meta($user_id, 'business_type', $_POST['business_type']);
    }

    if ( isset( $_POST['user_mobile'] ))
    {
        update_user_meta($user_id, 'user_mobile', $_POST['user_mobile']);
    }
} 
```

# python - 打印具有足够前导空格的字符串？

> ID：13440448
> 
> 赞同：3
> 
> 时间：2012-11-18T13:15:31.363
> 
> 标签：python, function

Python 提供了一个名为 len 的内置函数，它返回字符串的长度，因此 的`len('allen')`值为`5`。

编写一个名为的函数`right_justify`，它接受一个名为的字符串`s`作为参数，并打印带有足够前导空格的字符串，以便字符串的最后一个字母在显示的第 70 列中。

```
>>> right_justify('allen')
                                                       allen 
```

我是这样解决的：

```
def right_justify(s):
    print "                                                                 " + s    

right_justify('allen') 
```

这样对吗？

是否有内置的 Python 方法来做我需要做的事情？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-18T13:20:20.990

[字符串格式化](http://docs.python.org/2/library/stdtypes.html#string-formatting-operations)很容易：

```
def right_justify(s):
    print "%70s" % s 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T13:24:58.313

使用[`format`](http://docs.python.org/2/library/functions.html#format)：

```
In [60]: strs="allen"

In [61]: format(strs,">70s")
Out[61]: '                                                                 allen'

In [62]: format(strs,">70s").index('n')
Out[62]: 69 
```

或使用[`str.format`](http://docs.python.org/2/library/string.html#format-string-syntax)：

```
In [68]: "{0:>70s}".format(strs)
Out[68]: '                                                                 allen' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-18T13:19:27.853

当然，您可以在这里应用一个巧妙的小技巧：

```
def right_justify(s, total_length=70):
    return ' ' * (total_length - len(s)) + s 
```

如果不是很清楚，这将打印出 total_length - s 个空格的长度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-30T11:34:14.907

```
def right_justify(s):
    print ('')
    print ('Number of chars: ' + str(len(s)))
    print ('')
    print (' '* (70 - len(s)) + s)

word = input('Enter any word: ')
right_justify(word) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-11-18T00:02:04.807

```
def right_justify(s):
    print len(s)
    print ' '* (70 - len(s)) + s

word = raw_input('enter any word')
right_justify(word) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-15T19:52:44.360

```
 def right_justify(s):
         print((70-len(s))*' '+s) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-18T13:17:14.777

我不会为你做作业，但这里有一个简单的算法：

1.  找出你的字符串有多长（提示：）`len()`。

2.  找出你需要打印多少个空格（提示：如果你的字符串是 5 个字符并且总长度应该是 70，你想打印 65 个空格）。

3.  打印空格。

4.  打印字符串。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-11T18:10:02.410

这是工作代码

```
 def right_justify(s):

    length = len('s')

    spaces = 70 - length 
    print "required space is",spaces

    print(" " * spaces) + s

right_justify('allen') 
```

输出

```
required  space is  69
                                                                     allen 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-11-28T11:42:47.967

```
def right_justify(s):
    length =len(s)
    spaces = 70-length
    print((" " * spaces) + s)

word = "monty"
right_justify(word) 
```

定义后，长度取决于选择的单词，而不是（s）......所以你创建了公式。长度、空格和打印应缩进。必须发明一个变量，以便单词可以从 str 转换为变量格式。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-08-18T21:22:38.653

为了让最后一个字母出现在第 70 列中，您需要`s`从 70 中减去 的长度，如下所示

```
def right_justify(s):
    print(" " * (70 - (len(s)) + s) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-10-04T02:26:03.827

```
def right_justify (s):
    x = ' '
    w = (70-len(s))*x + s
    print (w) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-10-17T19:33:23.880

也许我误读了这个问题，但如果变量是一个字符长，似乎给出的答案只会给出正确的结果。我对编码也很陌生，所以这可能有点离谱。

```
def right_justify(s):
        length = len(s)
        adjustedLength = len(s) -1
        spaces = 70 - length + adjustedLength
        print(spaces * " " + "s")

s = "whatever you want to enter"
right_justify(s) 
```

我这样做了，所以无论 s 被定义为什么，你都会得到 69 个空格，然后是“s”。

如果这是错误的，请告诉我，以便我可以调整我的思维方式。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-02-11T06:12:16.087

```
def right_justify(s):
...  length=len(s)
...  spaces=70-length
...  print (' ' * spaces) + s
...
>>> right_justify('allen') 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-06-30T04:26:02.140

我会做这样的事情，这是许多简单的方法之一：

```
def right_just(s):    
    print(s.rjust(70))

right_just('allen') 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-06-30T04:32:10.243

Just thought of yet another way to make it more dynamic :)

# Function

def right_justify(s,num):

```
print(s.rjust(num)) 
```

# Call Function

right_justify("Allen",50)

# javascript - 三.js 跟踪模型（对象）

> ID：13440454
> 
> 赞同：3
> 
> 时间：2012-11-18T13:15:56.867
> 
> 标签：javascript, webgl, three.js

我正在使用 THREE.OBJLoader() 加载 .obj 文件，并在将每个对象添加到屏幕后将其推送到 myobj[] 数组中。

```
var myObjs = [];
var loader = new THREE.OBJLoader();
loader.addEventListener( 'load', function ( event ) {
var object = event.content;
object.position.x=xpos;
object.position.y = ypos;
scene.add( object );
teeth.push(object);
});
loader.load( 'obj/myobj1.obj' );
loader.load('obj/myobj2.obj');
loader.load('obj/myobj3.obj'); 
```

我可以使用以下代码检查是否单击了对象：

```
function onDocumentMouseDown( event ) {

event.preventDefault();
var vector = new THREE.Vector3( ( event.clientX / window.innerWidth ) * 2 - 1, - (   event.clientY / window.innerHeight ) * 2 + 1, 0.5 );

projector.unprojectVector( vector, camera );

var ray = new THREE.Ray( camera.position, vector.subSelf( camera.position ).normalize() );
var intersects = ray.intersectObjects( teeth, true );

if ( intersects.length > 0 ) {

intersects[0].object.position.z=50;
} 
```

到现在为止还挺好。现在我想不通的是如何跟踪 myobjs[] 数组中的哪个对象被点击，或者我应该说如何在 myobjs 数组中映射 intersects[0].object 。

问候， ZB

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T13:40:34.523

该对象将完全相同，即`intersects[0].object`，某些`myobjs`数组成员都将引用同一实例。如果你想找到`myobjs`数组的索引（例如为了从那里删除它），你有几个选择：

1.  交集后，循环`myobjs`并比较`intersects[0].object.id`（`myobj[i].id`每个three.js对象都有一个唯一的`id`属性）。
2.  您还可以自由地将任何合适的自定义属性分配给`load`事件处理程序中的对象，因此只需`object.myId = myobjs.length;`在将其推送到之前添加一行`myobjs`，您就可以稍后使用`intersects[0].object.myId`.

# c# - 如何禁止选择组合框的项目之一或不显示它，或更改索引属性？

> ID：13440463
> 
> 赞同：1
> 
> 时间：2012-11-18T13:16:48.977
> 
> 标签：c#, .net

假设我的 cobobox 中有下一个项目：

```
myComboBox.Items.AddRange(new object[] {"item1", "item2", "item3", "item4"}); 
```

我需要的是用户将无法选择`item3`，或者`item3`是不可见的（不会显示）但`item4`仍然具有`.SelectedIndex`属性等于`3`（作为第 4 项）。

或第二个适合我需要的解决方案，在此之后：

```
myComboBox.Items.AddRange(new object[] {"item1", "item2", "item4"}); 
```

`item4`有`.SelectedIndex`属性等于`3`。

有没有办法做这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T19:06:20.000

绑定到 a `DataView`，然后您应该能够按任何条件进行过滤，并且只选择您希望出现在列表中的项目。此方法支持对列表进行动态更改，例如即时更改标准或添加/删除项目。请参阅[.Net DataView 和 DataTable 绑定](https://stackoverflow.com/questions/1334877/net-dataview-and-datatable-binding)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T13:22:48.087

只需使用`data-binding`, 或您现在使用的相同技术，但在第一种情况下*，不要添加您要否定访问的项目*。

换句话说，*仅*使用与当前应用程序状态相关的数据填充组合。

# gwt - 如何使用 GWT 客户端将参数传递给 Restlet

> ID：13440464
> 
> 赞同：1
> 
> 时间：2012-11-18T13:17:01.390
> 
> 标签：gwt, restlet-2.0

我尝试使用 GWT 客户端遵循来自 Restlet 的“[第一个应用程序](http://wiki.restlet.org/docs_2.1/13-restlet/21-restlet/318-restlet/303-restlet.html#dsy303-restlet_gwt)”示例，但我的参数没有从客户端传递到服务器。

服务器接口：

```
public interface SeriesResource {
    @Get
    public ArrayList<SeriesPoint> getSeries(String pair, int barSize, int numBars, long toDate);
} 
```

服务器实现：

```
public class SeriesServerResource extends ServerResource implements SeriesResource {
    @Get
    public ArrayList<SeriesPoint> getSeries(String pair, int barSize, int numBars, long toDate) {
        ...
    }
} 
```

客户：

```
public interface SeriesResourceProxy extends ClientProxy {
    @Get
    public void getSeries(String pair, int barSize, int numBars, long toDate, Result<ArrayList<SeriesPoint>> callback);
} 
```

我检查了为 SeriesResourceProxyImpl.java 生成的代码，看看它对参数做了什么，但实际上它没有对它们做任何事情，这解释了为什么它们没有被发送到服务器。为了让编译器生成提交参数所需的代码，我还需要做些什么吗？

# regex - 如何在 django 上结合正则表达式以匹配 ("string" )？

> ID：13440467
> 
> 赞同：0
> 
> 时间：2012-11-18T13:17:12.827
> 
> 标签：regex, django, django-urls

我正在尝试制作以下网址：

```
www.example.com/series/the-walking-dead/season-1/episode-1/ 
```

以及我的 urls.py 上的以下网址

```
url(r'^series/(?P<se>[a-zA-Z0-9_-]+)/season-(?P<tp>\d+)/episode-(?P<ep>\d+)/$'
    ,EpisodioView), 
```

但它不匹配。可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:37:38.143

抱歉，错误出在应用程序中……正则表达式工作正常。

真的对不起各位。

# javascript - 显示具有不同值的复选框列表

> ID：13440480
> 
> 赞同：1
> 
> 时间：2012-11-18T13:18:01.243
> 
> 标签：javascript, jquery, jquery-mobile

我有一个带有预先保存值的复选框列表。

我想显示这个列表来检查选中的，取消选中未选中的。

我使用 JqueryMobile。

```
function CheckExistingDays(DayId, DaysList, DayName)
        {
            var Len = DaysList.length;
            var FoundLessCounter = 0;
            for(var i =0;i<Len;i++)
             {
                 //alert("Day Id is : "+ DayId+" Day At List is "+ DaysList[i]);
                 if(DayId== DaysList[i])
                 {
                     $("#WeekDays fieldset").append('<input type="checkbox" name="'+ DayName+'" CheckboxId="'+ DayId +'" id="cool'+ i +'" class="custom" checked /><label for="cool'+ i +'">'+ DayName +'</label>');

                 }

                 else
                 {
                     FoundLessCounter++;
                     if(FoundLessCounter == Len)
                     {
                         $("#WeekDays fieldset").append('<input type="checkbox" name="'+ DayName+'" CheckboxId="'+ DayId +'" id="cool'+ i +'" class="custom"/><label for="cool'+ i +'">'+ DayName +'</label>');
                     }

                 }

             }

        } 
```

其中 DaysList 包含保存的值。

已选中的框正确显示，但未选中的框以磨损的方式显示： ![复选框视图](../Images/d729ac91809d72b7bef4534c36818a66.png)

但是应该检查的日子之一也是输出错误的日子，它旁边有一个正确的标记。

那么，有没有一种方法可以修复此代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T09:50:31.347

问题在于 id 处的“i”计数器。

在未经检查的日子里，它没有正确增加，所以我只是改变了这个：

```
 $("#WeekDays fieldset").append('<input type="checkbox" id="cool'+ i +'" class="custom" checked /><label for="cool'+ i +'">'+ DayName +'</label>'); 
```

到

```
 $("#WeekDays fieldset").append('<input type="checkbox" id="cool'+ DayId+'" class="custom" checked /><label for="cool'+ DayId +'">'+ DayName +'</label>'); 
```

更正 ID 后，一切都已修复:) `

# javascript - 在加载另一个 javascript 的 javascript 中添加 javascript

> ID：13440482
> 
> 赞同：1
> 
> 时间：2012-11-18T13:18:02.350
> 
> 标签：javascript, dom

我想动态添加一个 javascript 标记，其 src 指向外部源，其结果将生成一些其他 javascript。该 javascript 将绘制外部数据，即足球队的表格。

如果我将它包含在内，`document.write`它就可以正常工作。

```
<script type="text/javascript">
var everysport_u="http://puff.everysport.com/team_puff_competitiontable_normal_script_52764:0.html";
document.write("<scr"+"ipt type='text/javascript' charset='ISO-8859-1' src='"+everysport_u);
var everysport_r=Math.floor(Math.random()*99999999999);
document.write("?_r="+everysport_r);
document.write("'><\/scr"+"ipt>");
</script> 
```

然而，使用 DOM 操作却没有。

```
var script = document.createElement('script');
var everysport_r=Math.floor(Math.random()*99999999999);
var everysport_u = "http://puff.everysport.com/team_puff_competitiontable_normal_script_52764:0.html";
script.src = everysport_u;
script.type = 'text/javascript';
document.getElementById('everysport-accordion').appendChild(script); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:27:44.247

[http://puff.everysport.com/team_puff_competitiontable_normal_script_52764:0.html](http://puff.everysport.com/team_puff_competitiontable_normal_script_52764:0.html)上的脚本使用`document.write`. `document.write`只能在页面加载期间包含使用的脚本。页面加载后，`document.write`不再按预期运行。

可以包含一个脚本，该脚本本身通过 DOM 操作进行 DOM 操作。但事实是，`document.write`无论它位于何处，都希望能够立即将其写入文档。在页面加载后尝试`document.write`将清除当前页面并覆盖它。

查看这个简单的示例： http: [//jsbin.com/azumus/1/](http://jsbin.com/azumus/1/)（并单击**刷新**几次）。

如果您`document.write`在页面加载期间添加了一个用于页面较高元素的脚本，`document.write`则将写入页面，但*不会写入您想要的位置*。`document.write`只会写页面当前加载的位置；它不能用于写入您想要的任何元素。

有关示例，请参见此页面：http: [//jsbin.com/ayomoz/1/](http://jsbin.com/ayomoz/1/)（并查看源代码）。

## 总之

将您的`<script>`标签放在您打算写入文档的任何位置。如果要使用 id 写入元素`everysport-accordion`，则需要执行以下操作：

```
...

<div id="everysport-accordion">
    <script type="text/javascript">
        var everysport_u="http://puff.everysport.com/team_puff_competitiontable_normal_script_52764:0.html";
        document.write("<scr"+"ipt type='text/javascript' charset='ISO-8859-1' src='"+everysport_u);
        var everysport_r=Math.floor(Math.random()*99999999999);
        document.write("?_r="+everysport_r)
        document.write("'><\/scr"+"ipt>");
    </script>
</div>

... 
```

# ios - 如何在IOS中启动新屏幕？

> ID：13440483
> 
> 赞同：4
> 
> 时间：2012-11-18T13:18:12.280
> 
> 标签：ios

这是一个非常简单的问题，但我不知道该怎么做。

我发现的第一件事是我必须添加一个导航控制器。虽然我不需要展示导航控制器，但我试过了。我找到了这些教程： [http ://www.ralfebert.de/tutorials/iosdev/navigationcontroller/](http://www.ralfebert.de/tutorials/iosdev/navigationcontroller/)

[http://www.techotopia.com/index.php/Creating_a_Navigation_based_iOS_4_iPhone_Application_using_TableViews](http://www.techotopia.com/index.php/Creating_a_Navigation_based_iOS_4_iPhone_Application_using_TableViews)

[http://iosmadesimple.blogspot.de/2012/09/navigation-based-project-doing-it-using.html](http://iosmadesimple.blogspot.de/2012/09/navigation-based-project-doing-it-using.html)

和其他人，它说，我必须将导航控制器连接到窗口对象。但在 .xib 中没有窗口对象。似乎有一些更新，我发现在 AppDelegate.m 中以编程方式创建的窗口对象

这是否意味着我必须以编程方式连接它们，如果是，如何连接？

我正在为 5.1 使用 Xcode 4.4.1 构建。

然后我发现了 hacky 方法来替换这里描述的视图：http: [//fuelyourcoding.com/ios-basics-how-to-load-a-uiview-without-a-navigation-controller/](http://fuelyourcoding.com/ios-basics-how-to-load-a-uiview-without-a-navigation-controller/)

但我想知道这样做的标准方法是什么。

在 Apple 的开发指南中，有一些关于故事板的内容。那是我需要的吗？

如果可能的话，我需要知道如何启动一个单独的新屏幕（当然还有自己的控制器和 .xib），而不必向应用程序添加导航栏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T13:28:56.500

最好的方法是使用导航控制器。

在 AppDelegate 应用程序WillFinishLaunchingWithOptions 把这个...

```
UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:<the view controller you want to use first>];

self.window.rootViewController = self.navController;
[self.window makeKeyAndVisible]; 
```

这将使用 NavigationController 启动您的应用程序，您看到的第一件事将是您的初始视图控制器。

隐藏栏...

在初始视图控制器的 viewWillAppear 部分...

```
[self.navigationController setNavigationBarHidden:YES animated:YES]; 
```

这将隐藏该控制器的导航栏。

要推送到新的视图控制器...

```
MyNewViewController *newVc = [[MyNewViewController... (set it up).

[self.navigationController pushViewController:newVc animated:YES]; 
```

这是从初始视图控制器完成的。

然后弹回来。在新的 VC 中，只需执行此操作...

```
[self.navigationController popViewControllerAnimated:YES]; 
```

你永远不会真正“拥有”导航控制器，也永远不会真正看到它。它只是在您的应用程序后面管理过渡和内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T14:34:08.240

如果您不想使用 NavigationController，则可以显示模式视图。在这个 SO 问题中，您可以找到如何做到这一点：[Present and dismiss modal view controller](https://stackoverflow.com/questions/1529632/present-and-dismiss-modal-view-controller)

是否使用 NavigationController 呈现视图取决于该视图的目的，并且它与您的屏幕流程有关。如果您必须“向下钻取”到一系列 UITableView 或只是在到达特定屏幕之前浏览不同的屏幕，您应该使用 UINavigationController 来处理它。看看[http://developer.apple.com/library/ios/#documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html)

我个人更喜欢将 StoryBoards 用于具有大量视图的应用程序，因为它可以帮助我清晰地“了解”它们的层次结构以及每个应用程序之间的关系。

最后只是口味问题。如果您想了解有关 StoryBoards 的更多信息，我向您推荐这篇文章：[http ://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1](http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1)

如果您想知道如何使用 StoryBoards 创建模态视图，显示它的最简单方法是创建一个新项目，在下一个屏幕中选择“单一视图应用程序”选项并选中“使用故事板”选项。一旦你有了，你必须在 Xcode 的项目文件夹中选择你的“MainStoryboard.storyboard”文件。然后从右下角拖动一个“视图控制器”（第一个带有正方形的橙色圆圈）并将其放入您的 StoryBoard 中，在已创建的旁边。

现在你应该有两个不同的 ViewController。只需将 UIButton 从右下角（您需要滚动列表以查看“圆形矩形按钮”选项）拖动到第一个 ViewController（有一个从左侧指向它的箭头）。

最后，您必须按住 Control + 单击该 UIButton 并将该按钮与另一个 ViewController 链接。完成此操作后，它将显示“Action Segue”对话框。只需选择模态，瞧！

这就是您的 StoryBoard 的样子：

![模态视图控制器](../Images/5a78a415f319584e57d3347888cd0465.png)

**注意**：我已经更改了第二个 ViewController 的颜色，以使其更明显地切换。

我建议您先阅读 raywenderlich 的教程，然后按照以下步骤进行模态视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T13:30:03.903

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {    
    // Override point for customization after application launch.
    YourViewController *viewController = [[YourViewController alloc] init];
    navController = [[UINavigationController alloc] initWithRootViewController:viewController];
    // Add the view controller's view to the window and display.
    [window addSubview:navController.view];
    [window makeKeyAndVisible];
    return YES;
} 
```

# java - db4o：如何按存储时间 desc 查询对象

> ID：13440486
> 
> 赞同：0
> 
> 时间：2012-11-18T13:18:30.210
> 
> 标签：java, db4o

```
ObjectContainer oc;
oc.store(new Info(1));
oc.store(new Info(2));
oc.store(new Info(3));

List<Info> list=oc.query(Info.class); 
```

名单是：

*   信息(1)
*   信息(2)
*   信息(3)

如何获得这样的列表：

*   信息(3)
*   信息(2)
*   信息(1)

中是否有任何本机方法`db4o`？

`Collections.reverse(list)`抛出`java.lang.UnsupportedOperationException`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T17:53:45.753

[您可以通过构建 SODA 查询](http://community.versant.com/documentation/reference/db4o-7.13-flare/java/Content/object_lifecycle/querying/soda_query/building_soda_queries.htm)来实现此目的。

构建您的查询，例如

```
ObjectContainer oc = Db4o.openFile("mydb.yap");
Query query = oc.query();
query.constrain(Info.class);
query.descend("id").orderDescending();
ObjectSet<Info> resultSet = query.execute(); 
// ResultSet would be order desending by id
while(resultSet.hasNext()){
    Info info  = resultSet.next();
    info.getId() ;
} 
```

# php - 加载页面后使用 Jquery 更新带有图像大小的表单

> ID：13440489
> 
> 赞同：1
> 
> 时间：2012-11-18T13:18:35.277
> 
> 标签：php, jquery, image-size

我已经测试了我的代码的多个实例，但有一些我无法弄清楚的不一致之处。所以希望各位聪明人能帮忙。

我在标题中有这个 jquery 代码

```
function real_image_size () {
    var img = document.getElementById('target'); 
    //or however you get a handle to the IMG
    var real_width = img.clientWidth;
    var real_height = img.clientHeight;

    $('#rw').attr('value', real_width);
    $('#rh').attr('value', real_height);

} 
```

我有这个 html/php 代码，我想用显示的图像的尺寸进行更新

```
<img width="1000px" class="crop_img" id="target" src="$image_address" />

<form action="/save_cropped_image.php" method="post" onsubmit="checkCoords();">
      <input type="text" size="4" id="image_source" name="image_source" hidden="hidden" value="$image_address" />
      <input id="x" name="x" />
      <input id="y" name="y" />
      <input id="w" name="w" />
      <input id="h" name="h" />
      <input id="rw" name="rw" />
      <input id="rh" name="rh" />
      <input type="submit" value="Lagre nytt bilde" />
</form> 
```

呈现页面时，我正在运行一个脚本来填充输入字段`rw`和`rh`显示图像的尺寸`$target`。

我的问题是`rw`正确更新，但`rh`总是更新为“2”。第一次呈现页面时。

如果我从下拉框中选择另一个图像（代码中未描述）。然后脚本更新`#image`，然后更新两者`rw`，并`rh`使用相同的功能正确更新`(image_size_update())`，而不仅仅是`rw`....

```
</script>

    <script>
    $(window).ready(real_image_size());

</script> 
```

- - - 更新 - - -

我试图在加载图像后在函数上添加 setTimeout。但没有任何变化......仍然得到错误的rh（real_image_height）

```
$('#target').load(setTimeout(real_image_size(),10000)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:24:11.477

您的问题是一个简单但非常不起眼的问题。实际上，在加载时，您的图像可能尚未加载。浏览器已经知道它的宽度（因为它始终保持不变并且可能已经渲染了图像的至少一部分），但不知道总高度。

您需要做的是错开 JS 调用，直到您的第一个图像完全加载。这可以通过使用 jQuery 的 loaded() 事件来完成，或者在纯 JavaScript 中使用 onLoad 事件来完成（它们是相同的）。这应该为您提供正确的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T13:24:58.303

尝试`$(window).load`代替`ready`

# ubuntu - 无法安装 Composer - php-fpm

> ID：13440490
> 
> 赞同：6
> 
> 时间：2012-11-18T13:18:47.530
> 
> 标签：ubuntu, nginx, php, composer-php

终于启动并运行了带有 nginx 和 php-fpm 的 Ubuntu 12.10。现在我想用 Ratchet 运行一个 websocket 服务器，但我需要先安装 Composer。所以我这样做：

```
 curl -s https://getcomposer.org/installer | php 
```

正如 Composer 网站所指示的那样，但我收到以下错误：

```
The program 'php' is currently not installed. 
```

我认为它可能与最后的 php 有关，所以我将其更改为 php5-fpm 然后它告诉我：

```
[18-Nov-2012 05:01:30] ERROR: An another FPM instance seems to already listen on /var/run/php5-fpm.sock
[18-Nov-2012 05:01:30] ERROR: FPM initialization failed 
```

有人遇到过这种情况么？有什么解决办法吗？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-22T03:06:51.750

作曲家至少需要 php 5.3.2。你的php版本是什么？您需要 php 命令行才能使其工作。正如错误消息提示的那样，您最好安装“php”。在 ubuntu 中，你可以使用

```
 sudo apt-get install php5-cli 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-09T03:28:26.693

利用

```
usr/bin/php or /usr/bin/php instead of php 
```

如果您不确定您的 php 位于何处，请通过以下方式进行检查

```
whereis php 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-18T13:31:39.800

你有安装 php5-cli 吗？

```
dpkg -l | grep php5-cli 
```

如果没有，请键入

```
sudo apt-get install php5-cli 
```

# postgresql - 将单独的年、月、日、小时、分钟和秒列集成为单个时间戳列

> ID：13440492
> 
> 赞同：4
> 
> 时间：2012-11-18T13:19:13.743
> 
> 标签：postgresql, types, timestamp

我的数据集包含单独的年、月、日、小时、分钟和第二列，如下所示，以空格分隔：

```
+-------------------+
|2007|09|28|21|14|06|
|2007|09|28|21|14|06|
|2007|09|28|21|14|06|
|2007|09|28|21|14|06|
|2007|09|28|21|14|06|
+-------------------+ 
```

我想将它们集成为时间戳数据类型下的单个列。我在时间戳数据类型中创建了一个新列，并通过以下代码更新该列：

```
 Update s2
 set dt = year || '-' || month  || '-' || day
               || ' ' || hour  || ':' || min  || ':' || second 
```

但是我遇到了以下错误：

```
ERROR:  column "dt" is of type timestamp without time zone but expression is of type text
LINE 1:  Update temp set dt= year || '-' || month  || '-' || day  ||...
                             ^
HINT:  You will need to rewrite or cast the expression.

********** Error **********

ERROR: column "dt" is of type timestamp without time zone but expression is of type text
SQL state: 42804
Hint: You will need to rewrite or cast the expression.
Character: 22 
```

此外，我可以按`varchar`数据类型进行集成。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T13:55:07.067

你得到了解释错误的答案：你需要明确地`text`转换为。`timestamp`

但是，正确的解决方案是使用[`to_timestamp()`](http://www.postgresql.org/docs/current/interactive/functions-formatting.html#FUNCTIONS-FORMATTING-TABLE)

```
UPDATE s2
SET dt = to_timestamp(year || '-' || month  || '-' || day || ' '
                           || hour  || ':' || min  || ':' || second
                     ,'YYYY-MM-DD hh24:mi:ss'); 
```

为什么？
普通`'text'::timestamp`转换取决于日期/时间格式的本地设置，并且可能在一个安装中工作，但在另一个 PostgreSQL 安装中“突然”失败。给定的语句保证工作，独立于[`datestyle`](http://www.postgresql.org/docs/current/interactive/runtime-config-client.html#GUC-DATESTYLE)设置和语言环境。

好吧，准确地说，示例 ( `'YYYY-MM-DD hh24:mi:ss'`) 中的模式匹配 ISO 8601（SQL 标准），这对*任何*语言环境都有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T13:47:09.290

您需要从`text`to 进行简单的转换`timestamp without time zone`：

```
(expression)::timestamp without time zone 
```

例如：

```
Update s2 set dt = (year || '-' || month  || '-' || day  || ' ' || hour  || ':' || min  || ':' || second)::timestamp without time zone 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-18T13:48:55.080

表达式的结果

```
year || '-' || month  || '-' || day || ' ' || hour  || ':' || min  || ':' || second 
```

不是时间戳，而是纯文本。错误消息只是告诉您，该类型`text`不适合该`dt`列的类型。

您必须像这样转换*完整*的表达式：

```
(year || '-' || month  || '-' || day || ' ' || hour  || ':' || min  || ':' || second)::timestamp 
```

# eclipse - 在 osgi 包中使用 Eclipse 4 IEventBroker

> ID：13440494
> 
> 赞同：1
> 
> 时间：2012-11-18T13:19:23.597
> 
> 标签：eclipse, osgi, eclipse-rcp

我正在开发一个基于 Eclipse 4 应用平台的 RCP 应用。我的应用程序由几个自己的 OSGi 包组成，这些包实现为声明性服务。现在我想`IEventBroker`很好地利用我可以在我的应用程序中使用的服务。

但是可以`IEventBroker`在我的单独捆绑包中使用该服务吗？将服务作为字段注入不起作用：

```
@Inject IEventBroker eventBroker; 
```

并且在我的类的构造函数中注入服务也不起作用：

```
@Inject
public TestUserService(IEventBroker eventBroker) {
..
} 
```

每次都`eventBroker`注射。`NULL`一般情况下是否`IEventBroker`可以在自己的 OSGi 包中使用？我是否必须将任何必需的插件添加到我的捆绑包中？是否有另一种方法可以将此类服务放入自己的 OSGi 包中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T11:06:05.300

@Inject 不适用于纯捆绑包。您需要使用 Activator 或依赖注入机制，如 Blueprint 或 DS。

因此，尝试使用上述机制之一将 IEventBorker 查找为 OSGi 服务并将其注入到您的类中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-15T06:45:17.147

我知道，现在回答这个问题有点晚了，但我也在努力解决这个问题。我能够在[Tom Schindel](http://tomsondev.bestsolution.at/ "汤姆辛德尔") ( [e(fx)clipse](http://www.eclipse.org/efxclipse/index.html "e(fx)剪辑") ) 和 Lars vogel (vogella turials，例如[EventAdmin 教程](http://www.vogella.com/articles/Eclipse4EventSystem/article.html "EventAdmin 教程")) 的帮助下解决它。

后来我向拉斯[建议更新本教程](https://groups.google.com/d/msg/vogella/Y6l7ZWeix70/SG0vFidVzpkJ "建议更新本教程")，他可以将我的发现整合到他的教程中（不过我不知道他是否已经这样做了）

短期内，您需要将以下**附加**捆绑包（其他捆绑包请参阅 Lars Vogel 的教程）集成到您的程序中：

*   **org.eclipse.e4.core.contexts**
*   **org.eclipse.e4.ui.services**
*   **org.eclipse.e4.ui.di**

此外，我需要稍微更改事件捕获方法注释：

```
@Inject handleSomething(@Optional @EventTopic("foo") Object bar) {...} 
```

代替

```
@Inject @Optional handleSomething(@UIEventTopic("foo") Object bar) {...} 
```

请注意，由于我不想使用 e4 而不是 JavaFX，因此您可能仍需要使用 UIEventTopic，而我需要切换到纯 EventTopic - 这会导致限制警告:-(

我希望，您可能仍然对它感兴趣并且可以使用它！

# vb.net - VB.NET - IEnumerator 简介

> ID：13440500
> 
> 赞同：0
> 
> 时间：2012-11-18T13:20:15.623
> 
> 标签：vb.net

请看下面的代码：

```
'Form1.vb
Imports System.Data.SqlClient

Public Class Form1

    Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        'ExecuteDataReader(Function(x) New Person With {.URN = x("URN")})
        Try
            Dim results As IEnumerable(Of Person) = ExecuteDataReader(Function(x) New Person With {.URN = x("URN")})
            For Each c As Person In results 'Line 4
            Next
        Catch ex As Exception

        Finally

        End Try

    End Sub

    Public Function ExecuteDataReader(ByVal castRow As Func(Of IDataRecord, Person)) As IEnumerable(Of Person)
        Try
            Dim objCon As New SqlConnection("Data Source=IANSCOMPUTER;Initial Catalog=Test;Integrated Security=True")
            Dim objCommand As New SqlCommand
            Dim objDR As SqlDataReader
            objCon.Open()
            objCommand.Connection = objCon
            objCommand.CommandText = "SELECT URN FROM Person"
            objDR = objCommand.ExecuteReader()
            Do While objDR.Read
                castRow(objDR)
            Loop
        Catch ex As Exception

        End Try

    End Function
End Class

'Person.vb
Public Class Person
    'Implements IEnumerator, IEnumerable
    Public URN As String
End Class 
```

为什么第 4 行的结果变量为空。我是 IEnumberators 的新手。我使用的 .NET 版本 (3.5) 不允许使用 Yield 关键字。

**更新** Damien_The_Unbeliever 已更正代码。你认为这种模式适合数据逻辑层吗？我相信我有四个选择：

1) 将数据表而不是数据读取器返回到业务逻辑层。然后我可以将代码包装在 Using 语句中。
2）使用 Damien_The_Unbeliever 的答案中描述的模式将数据读取器返回到业务逻辑层（不在 Using 语句中包装一次性对象）。
3) 将数据读取器返回到业务对象层，并且仅在关闭数据读取器时关闭连接，即`dr = cmd.ExecuteReader(CommandBehavior.CloseConnection)`
4) 没有数据访问层。在需要时打开和关闭业务逻辑层中的连接。我相信这会降低代码的可维护性。

如果还有其他选择，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:41:01.620

试试这个：

```
Public Function ExecuteDataReader(ByVal castRow As Func(Of IDataRecord, Person)) As IEnumerable(Of Person)
    Using objCon As New SqlConnection("Data Source=IANSCOMPUTER;Initial Catalog=Test;Integrated Security=True")
      Using objCommand as New SqlCommand("SELECT URN FROM Person",objCon)
        Dim objDR As SqlDataReader
        objCon.Open()
        objDR = objCommand.ExecuteReader()
        Dim ret as New List(Of Person)
        Do While objDR.Read
            ret.Add(castRow(objDR))
        Loop
        Return ret
      End Using
    End Using
End Function 
```

其中a）删除了“错误处理”的坏例子，它默默地吞下错误，b）包装`SqlCommand`和`SqlConnection`对象，以便它们得到正确处理，以及c）实际上从函数返回一些东西，这是你出错的地方。

# mysql - 在mysql表中存储和查询json

> ID：13440504
> 
> 赞同：2
> 
> 时间：2012-11-18T13:20:44.770
> 
> 标签：mysql, sql, database, database-design, data-modeling

我试图避免项目中的反模式，我必须允许用户创建、修改和删除表字段。所以我正在寻找在表中存储 JSON 数据。例如我有餐桌产品：

```
Products
----------------
id,
user_id,
created,
modified,
price,
_custom <-- there will be stored additional columns for each product needs
        {"adjustment":0.13, "weight":14.60, "have_some_individual_label":"value"} 
```

但我看不出如何`_column`在查询中包含参数。例如，如何查询`user_id = 1`AND的所有产品`have_some_individual_label = value`。第二个参数可以是一个或多个（它将用于过滤器和分析）。如果这是一种不好的方法 - 什么会更好？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:30:41.860

> 如果这是一种不好的方法 - 什么会更好？

[实体-属性-价值模型](http://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model)模型：

```
CREATE TABLE `ProductInfo` (
  `ProductID` BIGINT UNSIGNED NOT NULL,
  `AttributeKey` VARCHAR(20) NOT NULL,
  `AttributeVal` VARCHAR(20),
  PRIMARY KEY (`ProductID`, `AttributeKey`),
  FOREIGN KEY (`ProductID`) REFERENCES `Products` (`id`)
);

INSERT INTO ProductInfo
  (`ProductID`, `AttributeKey`              , `AttributeVal`)
VALUES
  (         1 , 'adjustment'                ,         '0.13'),
  (         1 , 'weight'                    ,        '14.60'),
  (         1 , 'have_some_individual_label',        'value')
; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T13:33:53.617

您建议的 JSON 方法可能适用于您只想比较等价的情况。我宁愿建议将额外的单个属性存储在单独的表中，并通过其 ID 将其链接到 Products 表。

```
CREATE TABLE custom_attrs(prodID int, customAttr varchar(32),
       customValue varchar(32)); 
```

这可能是一种更好的方法，即使它给表格带来了一些复杂性。

# java - 查找字符串中的所有数字

> ID：13440506
> 
> 赞同：26
> 
> 时间：2012-11-18T13:20:57.150
> 
> 标签：java, string, algorithm

例如，我输入了字符串：“ *qwerty1qwerty2* ”；

作为输出，我想要*[1,2]*。

我目前的实现如下：

```
import java.util.ArrayList;
import java.util.List;

public class Test1 {

    public static void main(String[] args) {
        String inputString = args[0];
        String digitStr = "";
        List<Integer> digits = new ArrayList<Integer>();

        for (int i = 0; i < inputString.length(); i++) {
            if (Character.isDigit(inputString.charAt(i))) {
                digitStr += inputString.charAt(i);
            } else {
                if (!digitStr.isEmpty()) {
                    digits.add(Integer.parseInt(digitStr));
                    digitStr = "";
                }
            }
        }
        if (!digitStr.isEmpty()) {
            digits.add(Integer.parseInt(digitStr));
            digitStr = "";
        }

        for (Integer i : digits) {
            System.out.println(i);
        }
    }
} 
```

但是经过仔细检查后，我忽略了几点：

1.  有些代码行重复了两次。

2.  我使用列表。我认为这不是一个好主意，最好使用数组。

所以你怎么看？

你能提供任何建议吗？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-11-18T13:34:57.243

使用全部替换：

```
String str = "qwerty1qwerty2";      
str = str.replaceAll("[^0-9]+", " ");
System.out.println(Arrays.asList(str.trim().split(" "))); 
```

输出：

```
[1, 2] 
```

**[编辑]**

如果要包括`-`ae 减号，请添加`-?`：

```
String str = "qwerty-1qwerty-2 455 f0gfg 4";      
str = str.replaceAll("[^-?0-9]+", " "); 
System.out.println(Arrays.asList(str.trim().split(" "))); 
```

输出：

```
[-1, -2, 455, 0, 4] 
```

* * *

*描述*

```
[^-?0-9]+ 
```

*   `+`一次到无限次，尽可能多次，按需回馈
*   `-?`字符“-？”之一</li>
*   `0-9`介于“0”和“9”之间的字符</li>

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-18T13:27:40.427

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

...

Pattern pattern = Pattern.compile("[0-9]+"); 
Matcher matcher = pattern.matcher("test1string1337thingie");

// Find all matches
while (matcher.find()) { 
  // Get the matching string  
  String match = matcher.group();
} 
```

是一种正则表达式解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-18T13:55:01.587

试试这个代码

```
String s = "qwerty1qwerty2";
for(int i=0;i<s.length();i++)
{
   if(Character.isDigit(s.charAt(i)))
   System.out.print(s.charAt(i)+"  ");
} 
```

# sql - 如何检查 SQL Server 表是否有行并将表名作为列名和值返回 true 或 false

> ID：13440510
> 
> 赞同：0
> 
> 时间：2012-11-18T13:21:06.180
> 
> 标签：sql, sql-server, sql-server-2008

我需要创建一个视图，它将查询几个指定的表并返回一个包含一行的视图表。表必须由具有表名的列组成，并且必须返回一行，其值为 True/False，具体取决于表是否有行。

例如，我有四个表：

```
Medication / Patient / User / Appointment 
```

我需要检查它们是否有行，并返回一个包含一行和一列的视图表。

```
Medication | Patient | User | Appointment
True       | False   | False| True 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:30:53.027

有很多方法可以做到这一点，如果只是这 4 个表，你可以使用这个：

```
select
(select Case When (select COUNT(*) FROM Medication) > 0 then 'true' else 'false' end) as Medication,
(select Case When (select COUNT(*) FROM Patient) > 0 then 'true' else 'false' end) as Patient,
(select Case When (select COUNT(*) FROM Appointment) > 0 then 'true' else 'false' end) as Appointment 
```

# algorithm - 每个加密算法都可以加密 ASCII 密钥吗？

> ID：13440515
> 
> 赞同：0
> 
> 时间：2012-11-18T13:21:46.380
> 
> 标签：algorithm, encryption, cryptography

例如，基于切比雪夫多项式的加密算法。消息的域必须在 [-1,1] 而 ASCII 表是 0 - 255 它是如何加密的？

切比雪夫多项式：[http ://www.cecm.sfu.ca/CAG/papers/Cheb.pdf](http://www.cecm.sfu.ca/CAG/papers/Cheb.pdf)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:06:02.210

`0-255`将您的输入从范围规范化为`[-1,1]`:`N(x) = x/128 - 1`并`N(x)`用作加密算法的输入，而不是`x`. 对于其他范围，只需使用不同的归一化函数。

# javascript - 在 Eventlistener 中访问原型成员

> ID：13440516
> 
> 赞同：0
> 
> 时间：2012-11-18T13:21:56.063
> 
> 标签：javascript, google-maps, event-handling, prototype

当我在事件监听器中时，如何访问对象的成员？这是一个例子，我认为这更容易理解；）

```
MapProvider = function(mapID, autocompleteID) {
  // some other members
  MapProvider.prototype.map = null;
  MapProvider.prototype.autocomplete = null;

  // init function
  MapProvider.prototype.initAutocomplete = function() {  
   // some other stuff and now i create an autocompleteObj
   this.autocomplete = new google.maps.places.Autocomplete(this.inputField, myOptions);
   this.autocomplete.bindTo('bounds', this.map);

   // until now everything went fine
   // now i want to listen to the autocompleteObj
   // the handler is working fine aswell
   google.maps.event.addListener(this.autocomplete, 'place_changed', function() {
     // but now i want to acces the autocompleteObj again, but i cant :(
     // how can i access my members that i deklared in my first lines ?
     console.log(this.autocomplete.getPlace());
   });

 } 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:34:47.197

试试这样：

```
MapProvider = function(mapID, autocompleteID) {
    // some other members
    MapProvider.prototype.map = null;
    MapProvider.prototype.autocomplete = null;

    // init function
    MapProvider.prototype.initAutocomplete = function() {  

        this.autocomplete = new google.maps.places.Autocomplete(this.inputField, myOptions);
        this.autocomplete.bindTo('bounds', this.map);

        var _this = this;

        google.maps.event.addListener(this.autocomplete, 'place_changed', function() {

            console.log(_this.autocomplete.getPlace());
        });

    }
} 
```

# jvm - Java SE 的软件架构与 JDK、JRE 和 JVM 的关系？初学者

> ID：13440520
> 
> 赞同：1
> 
> 时间：2012-11-18T13:22:20.057
> 
> 标签：jvm, java

我的问题很简单，我可以`Java SE`在这个图表的哪里添加？`Utility Classes`Java 术语是什么？请

![在此处输入图像描述](../Images/78e15ee9cf6864fe3c8276f49df2304b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:59:35.817

`Java SE`包罗万象。它是整个 Java 平台，但标准版。

`Utility classes`是Java API。

# c# - AVR char 和 C# byte 不同

> ID：13440523
> 
> 赞同：1
> 
> 时间：2012-11-18T13:22:49.357
> 
> 标签：c#, avr-gcc

我编写了一个小型 C# 应用程序，将字节写入 COM 端口：

```
SerialPort serialPort = new SerialPort
{
    PortName = "COM6",
    BaudRate = 57600,
    DataBits = 8,
    Parity = Parity.None,
    StopBits = StopBits.One,
    Handshake = Handshake.None
};

serialPort.DataReceived += delegate
{
    var read = serialPort.ReadByte();
    Console.WriteLine("Recv: {0}", read);
    Trace.WriteLine(read);
};

serialPort.Open();

for (Byte i = 0; i < 250; i++)
{
    Console.WriteLine("Send: {0}", i);
    serialPort.Write(new[] {i}, 0, 1);
    Thread.Sleep(250);
} 
```

现在我用我的 ATMega328P 接收这些信号并将我收到的信息发回：

```
void InitUart()
{
    // Enable receiver and transmitter
    UCSR0B |= (1 << RXEN0) | (1 << TXEN0) | (1 << RXCIE0);

    // Set baud rate
    UBRR0H = (UART_BAUD_PRESCALE  >> 8);
    UBRR0L = UART_BAUD_PRESCALE;

    // Set frame: 8data, 1 stop bit
    UCSR0C |= (1 << USBS0) | (1 << UCSZ00) | (1 << UCSZ01);

    // Enable all interrupts
    sei();
}

void UART_Send(char b)
{
    UDR0 = b;
    while ((UCSR0A & (1 << TXC0)) == 0) {};
}

ISR(USART_RX_vect)
{
    char b = UDR0;
    _delay_ms(125);
    UART_Send(b);
} 
```

但是会发生什么：

```
Send: 0
Recv: 128
Send: 1
Recv: 129
Send: 2
Recv: 130
Send: 3
Recv: 131
Send: 4
Recv: 132
Send: 5
Recv: 133
Send: 6
Recv: 134
Send: 7
Recv: 135
Send: 8
Recv: 136
Send: 9
Recv: 137
Send: 10
Recv: 138
Send: 11
Recv: 139
Send: 12
Recv: 140
Send: 13
Recv: 141
Send: 14
...
Recv: 250
Send: 123
Recv: 251
Send: 124
Recv: 252
Send: 125
Recv: 253
Send: 126
Send: 127
Send: 128
Recv: 128
Send: 129
Recv: 129
Send: 130
Recv: 130
Send: 131
Recv: 131
Send: 132
Recv: 132
Send: 133
Recv: 133
Send: 134
Recv: 134
Send: 135
Recv: 135
Send: 136
Recv: 136
Send: 137
Recv: 137
Send: 138
Recv: 138
Send: 139
Recv: 139
Send: 140
Recv: 140 
```

所以它上升到 127 然后它突然正确了。

不知何故，字节值有 128 个差异，但我无法掌握它。

编辑：经过更多测试后，我注意到了这一点：

```
Send: 0 (0)
Recv: 128 (10000000)
Send: 1 (1)
Recv: 129 (10000001)
Send: 2 (10)
Recv: 130 (10000010)
Send: 3 (11)
Recv: 131 (10000011)
Send: 4 (100)
Recv: 132 (10000100)
Send: 5 (101)
Recv: 133 (10000101) 
```

我似乎补码与 C# 和 AVR C 不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T20:13:24.860

解决方案是我为串行端口使用了错误的速度，因此数据包无法正确到达。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T23:19:37.530

我在我的项目中遇到了类似的问题，但我是 c#（和 VB）的新手，它是关于 ASCI 和 ASCII 的。您在 AVR 中的代码接缝很好。

**我做了什么（在VB中）：**

将 byte_conv(10) 调暗为字节

byte_conv(0) = Pg

...

comPort.Write(byte_conv, 0, 10)

**在你的情况下：**

将 byte_conv(1) 调暗为字节

byte_conv(0) = 我

comPort.Write(byte_conv, 0, 1)

# c++ - 重载成员访问运算符有什么用？

> ID：13440526
> 
> 赞同：1
> 
> 时间：2012-11-18T13:23:26.853
> 
> 标签：c++, operator-overloading, member-access

> **可能重复：**
> [运算符重载](https://stackoverflow.com/questions/4421706/operator-overloading)

成员访问运算符 -> 可以重载以返回指向数据成员或其他变量的指针。

这个功能在哪里使用？它解决了哪些编码问题，或者，它使什么变得更容易？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T13:34:20.347

成员访问运算符是一个有点奇怪的生物：它旨在返回一个指针或一个重载成员访问运算符的类。一旦它到达一个指针，它就会访问相应的成员。重载成员访问运算符的主要用途是智能指针，例如`std::shared_ptr<T>`和`std::unique_ptr<T>`。如果没有此运算符，您将需要使用类似的东西

```
sp.get()->member 
```

或者

```
(*sp).member 
```

代替

```
sp->member 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T13:38:53.170

请注意，“覆盖”和“重载”这两个术语都具有很大的误导性。规范`->`运算符访问通过指针引用的对象的成员，即`X* x; x->foo;`访问指针类型（或更准确地说是*原始指针）**指向*的对象。`x`

 *但是，`operator->`您可以在聚合类型（即“类”）中将其实现为非静态成员函数会做一些不同的事情。In `X* x; x->foo;`,`->`仍然*是*规范结构运算符，*不能*更改。但是， in`Y y; y->foo`会`->`调用 的`operator->`成员函数`Y`。这个看似很小的区别至关重要，因为一个运算符*只能*应用于原始指针类型，而另一个*只能*应用于非指针类型。

这通常用于允许类型在*语法上表现得*好像它们是原始指针（有一些语义差异），就像在`shared_ptr`et al. 如果没有这种语言支持，这是无法实现的，`shared_ptr<X>`并且如果不允许模仿适用于（但不是）的规范运算符，则`X*`无法以相同的方式使用。`shared_ptr<X>::operator->``->``X*``X`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T13:34:33.063

当您对指针进行建模时，为了方便起见，您希望保持通常的语法。看看 std::unique_ptr 和 std::shared_ptr。:)*

# windows - 如何获得写入注册表项的权限？

> ID：13440530
> 
> 赞同：4
> 
> 时间：2012-11-18T13:23:49.987
> 
> 标签：windows, winapi

我正在尝试在注册表的 HKLM 部分下编写一些注册表项。我使用 RegCreateKeyEx() 和 RegSetValueEx() 的方式类似于我见过的一些 MSDN 示例。

但是，RegSetValueEx() 调用失败并出现错误 5，FormatMessage() 表示“访问被拒绝”

我想我需要请求提升权限，但我不知道执行此操作所需的 API 调用？

这是我的代码：

```
HKEY hk;
DWORD dwDisp;
LONG result = RegCreateKeyEx(HKEY_LOCAL_MACHINE, _T("Software\\MyApp"), 0, NULL,
    REG_OPTION_NON_VOLATILE, KEY_WRITE, NULL, &hk, &dwDisp);
if(result == ERROR_SUCCESS)
{       
    BYTE value[] = "Hello world!";

    result = RegSetValueEx(hk, _T("MyValue"), 0, REG_EXPAND_SZ, value, strlen((char*)value)+1);
    if(result != ERROR_SUCCESS)
    {
        DBG_PRINT2("RegSetValueEx failed with code: %d\n", result);
    }

    RegCloseKey(hk);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-18T13:46:16.730

为了拥有对 HKLM 的写入权限，您的进程需要以具有管理员权限的用户身份运行。此外，在包含 UAC（Vista 及更高版本）的系统上，您的进程将需要运行提升。要`requireAdministrator`在您的[应用程序清单](http://msdn.microsoft.com/en-us/library/windows/desktop/bb756929.aspx)中指定。

除非绝对必要，否则不要以提升的权限运行应用程序，这一点很重要。您可以将需要写入的应用程序部分移动到`HKLM`一次性操作中，例如您的安装程序。或者您可以将您的应用程序分成两部分：以正常权限运行的大部分，以及需要提升权限的小部分。

您可能需要将应用程序拆分为更小的部分的原因是用户令牌是在进程启动时分配的，并且在进程的生命周期内无法修改。因此，如果您希望提升应用程序的某些部分，而其他部分不提升，您需要有两个不同的进程。

# jquery - .on 与切换 jQuery

> ID：13440531
> 
> 赞同：-3
> 
> 时间：2012-11-18T13:23:55.567
> 
> 标签：jquery

我将函数切换与动态插入的 div 一起使用，而不是仅运行特定元素，切换执行所有 div 内容。

HTML：

```
<div style="text-align: center;">
    <p class="button-style add-comment"><a href="#">Add Comment</a></p>
    <div class="insert-comment" style="display: none;">
        <textarea rows="8" cols="50" class="insert-comment-text"></textarea>
    </div>
</div> 
```

jQuery：

```
$(document).on('click', '.add-comment', function(e){
    $(".insert-comment").toggle(); 
}); 
```

如何只打开一个特定的 div 而不是全部？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:28:06.970

我猜你只想打开下一个 div。如果是这样，而不是

```
 $(".insert-comment").toggle(); 
```

利用

```
 $(this).next("div.insert-comment").toggle(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T13:28:47.350

我会添加链接以在标签上开始“切换”，`<a>`然后使用下面的代码：

**JavaScript：**

```
$(".add-comment").onClick(function(){
    $(".insert-comment").toggle();
}); 
```

**HTML：**

```
<div style="text-align: center;">
    <p class="button-style"><a href="#" class="add-comment">Add Comment</a></p>
    <div class="insert-comment" style="display: none;">
        <textarea rows="8" cols="50" class="insert-comment-text"></textarea>
    </div>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T13:26:46.760

也许这就是你需要的？

```
$(this).next(".insert-comment").toggle(); 
```

事实上，如果所有带有类`add-comment`的元素后面总是跟着需要切换的 div，那么第二个选择器只会让你慢下来：

```
$(document).on('click', '.add-comment', function(e){
    $(this).next().toggle();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-18T13:26:55.127

### 只需相对更改您的代码，这样：

```
$(document).on('click', '.add-comment', function(e){
    $(this).next().toggle();
}); 
```

或者**更具体地说**，尝试：

```
$(document).on('click', '.add-comment', function(e){
    $(this).next(".insert-comment").toggle();
}); 
```

# javascript - 如何用双括号声明数组

> ID：13440542
> 
> 赞同：1
> 
> 时间：2012-11-18T13:25:15.557
> 
> 标签：javascript, arrays

我正在尝试以这种方式制作一个数组：

```
var cell = [];    
cell[0][0] = "Förnamn:";    
cell[0][1] = "Efternamn:";    
cell[0][2] = "Telefon:";    
cell[1][1] = "Leitet";    
cell[1][2] = "7716";    
cell[2][0] = "Mats";    
cell[2][1] = "Loock";    
cell[2][2] = "7714"; 
```

但我得到这个错误：

> 无法设置未定义的属性“0”

我也试过这个：

```
var cell = new array[] 
```

并收到此消息：

> 意外的标记 ]

并尝试了这个：

```
var cell = new array() 
```

但是得到这个错误：

> 数组未定义

所以我需要帮助来声明我的变量。以下工作很重要：

```
cell[0][0] = "Förnamn:";
cell[0][1] = "Efternamn:";
cell[0][2] = "Telefon:";
cell[1][0] = "Johan";
cell[1][1] = "Leitet";
cell[1][2] = "7716";
cell[2][0] = "Mats";
cell[2][1] = "Loock";
cell[2][2] = "7714"; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T13:29:06.070

```
var a = new Array();
a[0] = new Array(); 
```

或者

```
var a = [[]]; 
```

适用于您的案例：

```
// if you want to be explicit
var cell = [] 
cell[0] = ["Förnamn:", "Efternamn:", "Telefon:"]
cell[1] = ["Johan",    "Leitet",     "7716"    ]
cell[2] = ["Mats",     "Loock",      "7714"    ]

// or
var cell = [
    ["Förnamn:", "Efternamn:", "Telefon:"],
    ["Johan", "Leitet", "7716"],
    ["Mats", "Loock", "7714"]
] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T13:30:44.630

像这样

```
var array = [[]]; 
```

在 JS 中应该使用文字，而不是构造函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-18T13:32:44.663

创建文字数组的最简单方法是

```
var cell=[
  [
    "Förnamn:",        
    "Efternamn:",
    "Telefon:"
  ],[
    "Johan",
    "Leitet",
    "7716"
  ],[
    "Mats",
    "Loock",
    "7714
  ]
] 
```

然后，当你想添加另一行时，你可以做

```
cell.push(["John", "Dvorak", "3455"]) 
```

* * *

如果你真的想使用

```
cell[0][0] = "Förnamn:";    
cell[0][1] = "Efternamn:";    
cell[0][2] = "Telefon:";    
cell[1][1] = "Leitet";    
cell[1][2] = "7716";     
cell[2][0] = "Mats";    
cell[2][1] = "Loock";    
cell[2][2] = "7714"; 
```

，然后执行以下操作：

```
var cell=[];
cell[0]=[];
cell[1]=[];
cell[2]=[];

cell[0][0] = "Förnamn:";    
cell[0][1] = "Efternamn:";    
cell[0][2] = "Telefon:";    
cell[1][1] = "Leitet";    
cell[1][2] = "7716";     
cell[2][0] = "Mats";    
cell[2][1] = "Loock";    
cell[2][2] = "7714"; 
```

或者

```
var cell = [];

cell[0] = [];
cell[0][0] = "Förnamn:";    
cell[0][1] = "Efternamn:";    
cell[0][2] = "Telefon:";   
cell[1] = []; 
cell[1][1] = "Leitet";    
cell[1][2] = "7716";  
cell[2] = [];   
cell[2][0] = "Mats";    
cell[2][1] = "Loock";    
cell[2][2] = "7714"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-18T13:32:17.283

```
var cell = [
    [
        "Förnamn:",
        "Efternamn:",
        "Telefon:"
    ],
    [
        "Leitet",
        "7716"
    ],
    [
        "Mats",
        "Loock",
        "7714"
    ]
]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-18T13:31:05.363

Javascript 不像 C 那样具有二维数组。您可以通过使用数组数组来模拟它，如下所示：

```
var cell = [];
for (var i = 0; i < 3; i++) {
  cell[i] = [];
}

cell[0][0] = "Förnamn:";
cell[0][1] = "Efternamn:";
cell[0][2] = "Telefon:";
cell[1][0] = "Johan";
cell[1][1] = "Leitet";
cell[1][2] = "7716";
cell[2][0] = "Mats";
cell[2][1] = "Loock";
cell[2][2] = "7714"; 
```

阅读您的评论后，我想知道您的老师是否想要这样的东西：

```
var cell = [ // The outside array
  [],        // this is cell[0]
  [],        // cell[1]
  []         // cell[2]
];           // and closing the outside array 
```

像这样压缩成一行：

```
var cell = [ [], [], [] ];
// or
var cell = [[],[],[]]; 
```

或者，您可以创建我们所说的对象字面量，然后说出您想要的内容...

```
var cell = [
  [
    "Förnamn:",
    "Efternamn:",
    "Telefon:"
  ],
  [
    "Leitet",
    "7716"
  ],
  [
    "Mats",
    "Loock",
    "7714"
  ]
]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-18T13:37:40.790

在第一个示例中，您可以使其像这样工作：

```
var cell = [];    
cell[0] = [];
cell[0][0] = "Förnamn:";    
cell[0][1] = "Efternamn:";    
cell[0][2] = "Telefon:";    
cell[1] = [];
cell[1][1] = "Leitet";    
cell[1][2] = "7716";    
cell[2] = [];
cell[2][0] = "Mats";    
cell[2][1] = "Loock";    
cell[2][2] = "7714"; 
```

在你的代码中抛出异常是因为没有`cell[0]`- 它是未定义的，所以你必须先定义它。

一旦你使用了数组构造函数，它应该是这样的：

```
var cell = new Array(); 
```

并不是：

```
var cell = new array[] 
```

或者

```
var cell = new array(); 
```

第一个构造是非法的，第二个不起作用，因为 JS 是区分大小写的语言。但是无论如何，您在这里都会遇到第二级问题。无论如何都必须定义每个第一级数组，就像在第一个代码块中一样。

# arrays - IF函数后删除的Excel宏多维数组值

> ID：13440548
> 
> 赞同：1
> 
> 时间：2012-11-18T13:26:30.697
> 
> 标签：arrays, multidimensional-array, visual-studio-macros

我遇到了 Excel 宏的一些问题。我也在尝试将工作表的各个单元格中的值复制到一个数组中，以便稍后与其他工作表的单元格值进行比较。

但是，我被困在数组中以存储我试图分配给它的所有值。

下面是我完成的代码片段。

```
Sub singleEntry(suppRow As Integer)

Dim j As Integer
Dim myArray() As Variant
Dim a As Integer
Dim b As Integer
Dim c As Integer

Worksheets("Ind. Supp. Plan Time").Select
Cells(suppRow, "I").Select

For j = 9 To 13
    c = j - 8

ReDim myArray(5, 4) As Variant
myArray(c, 1) = c

'ReDim Preserve myArray(5, 4) As Variant
If Cells(suppRow, j).Value = "*" Then
    ReDim Preserve myArray(5, 4) As Variant
    'myArray(j - 8, 1) = j - 8
    myArray(j - 8, 2) = Cells(suppRow, "P").Value
    myArray(j - 8, 3) = Cells(suppRow, "Q").Value
    myArray(j - 8, 4) = Cells(suppRow, "R").Value
    MsgBox "array = {" & myArray(c - 1, 2) & "}"
Else
    ReDim Preserve myArray(5, 4) As Variant
    myArray(j - 8, 2) = "1"
    myArray(j - 8, 3) = "1"
    myArray(j - 8, 4) = "1"
    MsgBox "array(1,3) = {" & myArray(1, 3) & "}"
End If

Next j

ReDim Preserve myArray(5, 4) As Variant
'For a = 1 To 5
'    For b = 1 To 4
'        MsgBox "Array = {" & myArray(a, b) & "}"
'    Next b
'Next a

End Sub 
```

我放入 MsgBox 查看执行代码的结果，我确定这些行按预期执行。如果我在分配一个值后立即打印数组的值，则打印的值是正确的。但是，现在我无法解决这个问题。

希望知道这个的人可以给我帮助。

非常感谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T14:31:41.700

不知道为什么你不能检索值。我对此进行了测试，并且可以正常工作。

```
Sub singleEntry(suppRow As Integer)
    Dim arrStore(1 To 5, 1 To 4) As Variant, col As Integer, r As Integer, c As Integer

    Worksheets("Ind. Supp. Plan Time").Select

    For col = 9 To 13
        arrStore(col - 8, 1) = col - 8
        arrStore(col - 8, 2) = IIf(Cells(suppRow, col) = "*", Cells(suppRow, "P"), 1)
        arrStore(col - 8, 3) = IIf(Cells(suppRow, col) = "*", Cells(suppRow, "Q"), 1)
        arrStore(col - 8, 4) = IIf(Cells(suppRow, col) = "*", Cells(suppRow, "R"), 1)
    Next col

    For r = 1 To 5
        For c = 1 To 4
           Debug.Print arrStore(r, c)
        Next c
    Next r

End Sub 
```

注意事项：

*   鉴于您总是填充数组，因此无需`ReDim`. 这是多余的（而且很昂贵）
*   我使用三元`IIF`语句来整理代码，即 if "*" then x else 1
*   我认为您不需要该变量`c`，因此我已将其删除
*   我在最后添加了一个简单的循环来打印出数组（这对我有用）

这能解决吗？

# linux - GCC详细模式输出说明

> ID：13440549
> 
> 赞同：23
> 
> 时间：2012-11-18T13:26:43.987
> 
> 标签：linux, gcc, verbose

我是 linux 新手。谁能向我解释我的 hello world 程序的以下详细模式输出？另外，文件`crt1.o`、`crti.o`、`crtend.o`、`crtbegin.o`和`crtn.o`和`lc`有`lgcc`什么作用？也欢迎任何其他解释性链接。

```
$ gcc -v hello.c

Reading specs from /usr/lib/gcc-lib/i686/3.3.1/specs
Configured with: ../configure --prefix=/usr
Thread model: posix
gcc version 3.3.1
 /usr/lib/gcc-lib/i686/3.3.1/cc1 -quiet -v -D__GNUC__=3 
 -D__GNUC_MINOR__=3 -D__GNUC_PATCHLEVEL__=1 
 hello.c -quiet -dumpbase hello.c -auxbase hello -Wall
 -version -o /tmp/cceCee26.s
GNU C version 3.3.1 (i686-pc-linux-gnu)
 compiled by GNU C version 3.3.1 (i686-pc-linux-gnu)
GGC heuristics: --param ggc-min-expand=51 
 --param ggc-min-heapsize=40036
ignoring nonexistent directory "/usr/i686/include"
#include "..." search starts here:
#include <...> search starts here:
 /usr/local/include
 /usr/include
 /usr/lib/gcc-lib/i686/3.3.1/include
 /usr/include
End of search list.
 as -V -Qy -o /tmp/ccQynbTm.o /tmp/cceCee26.s
GNU assembler version 2.12.90.0.1 (i386-linux)
using BFD version 2.12.90.0.1 20020307 Debian/GNU
Linux
/usr/lib/gcc-lib/i686/3.3.1/collect2
 --eh-frame-hdr -m elf_i386 -dynamic-linker
 /lib/ld-linux.so.2 /usr/lib/crt1.o /usr/lib/crti.o
 /usr/lib/gcc-lib/i686/3.3.1/crtbegin.o
 -L/usr/lib/gcc-lib/i686/3.3.1
 -L/usr/lib/gcc-lib/i686/3.3.1/../../.. /tmp/ccQynbTm.o
 -lgcc -lgcc_eh -lc -lgcc -lgcc_eh
 /usr/lib/gcc-lib/i686/3.3.1/crtend.o
 /usr/lib/crtn.o 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-19T14:41:50.273

第一部分是编译器驱动程序的版本和配置数据（这是`gcc`二进制文件，实际上不是编译器本身）：

```
Reading specs from /usr/lib/gcc-lib/i686/3.3.1/specs
Configured with: ../configure --prefix=/usr
Thread model: posix
gcc version 3.3.1 
```

然后它打印它用来调用真实编译器的命令，`cc1`：

```
 /usr/lib/gcc-lib/i686/3.3.1/cc1 -quiet -v -D__GNUC__=3 
 -D__GNUC_MINOR__=3 -D__GNUC_PATCHLEVEL__=1 
 hello.c -quiet -dumpbase hello.c -auxbase hello -Wall
 -version -o /tmp/cceCee26.s 
```

并`cc1`打印它的版本和配置信息。

```
GNU C version 3.3.1 (i686-pc-linux-gnu)
 compiled by GNU C version 3.3.1 (i686-pc-linux-gnu)
GGC heuristics: --param ggc-min-expand=51 
 --param ggc-min-heapsize=40036 
```

然后`cc1`告诉您它将在哪些目录中搜索包含文件。

```
ignoring nonexistent directory "/usr/i686/include"
#include "..." search starts here:
#include <...> search starts here:
 /usr/local/include
 /usr/include
 /usr/lib/gcc-lib/i686/3.3.1/include
 /usr/include
End of search list. 
```

编译器现在已经完成，所以`gcc`告诉你它将使用的汇编器命令。

```
 as -V -Qy -o /tmp/ccQynbTm.o /tmp/cceCee26.s 
```

汇编器 ,`as`给出它的版本信息。

```
GNU assembler version 2.12.90.0.1 (i386-linux)
using BFD version 2.12.90.0.1 20020307 Debian/GNU
Linux 
```

汇编器现在完成了，因此`gcc`给出了链接器命令。它`collect2`用作真正链接器的中介`ld`，但这在这里并不重要。

```
/usr/lib/gcc-lib/i686/3.3.1/collect2
 --eh-frame-hdr -m elf_i386 -dynamic-linker
 /lib/ld-linux.so.2 /usr/lib/crt1.o /usr/lib/crti.o
 /usr/lib/gcc-lib/i686/3.3.1/crtbegin.o
 -L/usr/lib/gcc-lib/i686/3.3.1
 -L/usr/lib/gcc-lib/i686/3.3.1/../../.. /tmp/ccQynbTm.o
 -lgcc -lgcc_eh -lc -lgcc -lgcc_eh
 /usr/lib/gcc-lib/i686/3.3.1/crtend.o
 /usr/lib/crtn.o 
```

链接器没有给出详细的输出（try `-Wl,-v`），就是这样。

“crt”文件的意思是“C RunTime”。它们是在程序开头和结尾插入的一小段代码。他们负责初始化您的全局变量、堆和堆栈。在`atexit`您从`main`. 除此之外还有一些。

希望有帮助。

# c# - Des Cryptography 的两种方法返回两个不同的结果？

> ID：13440553
> 
> 赞同：0
> 
> 时间：2012-11-18T13:27:06.573
> 
> 标签：c#, encryption, cryptography, des, 3des

我想计算**MAC（消息验证码）** CBC 芯片（Ansi x9.9），我找到了一个基于循环计算 MAC 的示例，在每一轮中，加密的结果必须与下一轮纯文本块和结果应该被加密以用于下一步，这个循环重复4次，直到最后一个加密值必须作为MAC返回。

> 加密密钥 = 0123456789abcdef

文本是“7654321 Now is the time for”的ASCII码。

> 文本 = 37363534333231204e6f77206873207468652074696d6520666f7220
> 
> 时间---纯文本---------------DES输入块--------DES输出块
> 
> 1 ---- 3736353433323120 -------- 3736353433323120 -------- 21fb193693a16c28
> 
> 2 ---- 4e6f772068732074 -------- 6f946e16fad24c5c -------- 6c463f0cb7167a6f
> 
> 3 ---- 68652074696d6520 -------- 04231f78de7b1f4f -------- 956ee891e889d91e
> 
> 4 ---- 666f722000000000 -------- f3019ab1e889d91e -------- f1d30f6849312ca4

我试图实现这个示例。在第一步，我得到了与样本相同的结果，但对于下一步，我的 Des 加密函数返回不同的结果作为样本的第二步。我使用硬件设备加密每个 Des 输入块，它返回与样本返回相同的 DES 输出块。[要么我在这里](http://www.codeproject.com/Articles/54672/DES-and-Triple-DES-Implementation-in-VB-NET)找到了另一个 DES 实现示例，它也重新输入了正确的加密。但是我在 msdn 上使用 microsft 示例的应用程序返回的步骤 2,3 和 4 的结果不正确，但步骤 1 除外。这是我的代码：

```
 public  byte[] EncryptPart(byte[] toEncrypt, byte[] Key, byte[] IV)
    {
        try
        {

            MemoryStream mStream = new MemoryStream();
            DES DESalg = DES.Create();
            DESalg.Mode = CipherMode.CBC;
            DESalg.Padding = PaddingMode.None;

            CryptoStream cStream = new CryptoStream(mStream,
                DESalg.CreateEncryptor(Key, IV),
                CryptoStreamMode.Write);
            cStream.Write(toEncrypt, 0, toEncrypt.Length);
            cStream.FlushFinalBlock();
            byte[] ret = mStream.ToArray();
            cStream.Close();
            mStream.Close();
            return ret;
        }
        catch (CryptographicException e)
        {
            Console.WriteLine("A Cryptographic error occurred: {0}", e.Message);
            return null;
        }
    } 
```

在这里我使用了该功能

```
 var IV = new byte[8];//empty byte array
        var key = new byte[] { 0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef };
        var result = new byte[8];
        int LoopCount = data.Length / 8;
        for (int i = 0; i < LoopCount; i++)
        {
            byte[] Part= new byte[8];

            Array.Copy(data, i * 8, Part, 0, 8);
            Part = XorArray(Part, result);
            result = EncryptPart(Part, key, IV);
        }
        int remain=data.Length % 8;
        if (remain != 0)
        {
            byte[] LastPart = new byte[8];//
            Array.Copy(data, data.Length - remain, LastPart, 0, remain);
            LastPart=XorArray(LastPart, result);
            result = EncryptPart(LastPart, key, IV); 
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T15:09:56.167

您应该重复使用密码，而不是每次都使用密钥和 IV 重新初始化它。

调用代码：

```
var IV = new byte[8];//empty byte array
var key = new byte[] { 0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef };

var data = Encoding.ASCII.GetBytes("7654321 Now is the time for ");

DES DESalg = DES.Create();
DESalg.Mode = CipherMode.CBC;
DESalg.Padding = PaddingMode.None;
ICryptoTransform crypt = DESalg.CreateEncryptor(key, IV);

var result = new byte[8];
int LoopCount = data.Length / 8;
for (int i = 0; i < LoopCount; i++)
{
    Console.WriteLine("=============Round {0}==============", i + 1);
    byte[] part = new byte[8];

    Array.Copy(data, i * 8, part, 0, 8);
    Console.WriteLine("Plain text : {0}", ByteArrayToString(part));
    part = XorArray(part, result);
    Console.WriteLine("DES INPUT  : {0}", ByteArrayToString(part));
    result = EncryptPart(crypt, part);

}
int remain = data.Length % 8;
if (remain != 0)
{
    Console.WriteLine("===========Final Round==============");
    byte[] LastPart = new byte[8];//
    Array.Copy(data, data.Length - remain, LastPart, 0, remain);
    Console.WriteLine("Plain text : " + ByteArrayToString(LastPart));
    LastPart = XorArray(LastPart, result);
    Console.WriteLine("DES INPUT  : " + ByteArrayToString(LastPart));
    result = EncryptPart(crypt, LastPart);
}

Console.WriteLine("Result: {0}", ByteArrayToString(result)); 
```

以及修改后的 Encrypt 部分方法：

```
public static byte[] EncryptPart(ICryptoTransform crypt, byte[] toEncrypt)
{
    try
    {

        MemoryStream mStream = new MemoryStream();

        CryptoStream cStream = new CryptoStream(mStream,
            crypt,
            CryptoStreamMode.Write);
        cStream.Write(toEncrypt, 0, toEncrypt.Length);
        cStream.FlushFinalBlock();
        byte[] ret = mStream.ToArray();
        cStream.Close();
        mStream.Close();

        Console.WriteLine("DES OUTPUT : " + ByteArrayToString(ret));
        return ret;
    }

    catch (CryptographicException e)
    {
        Console.WriteLine("A Cryptographic error occurred: {0}", e.Message);
        return null;
    }
} 
```

结果：

```
=============Round 1============== 
Plain text : 3736353433323120 
DES INPUT  : 3736353433323120 
DES OUTPUT : 21fb193693a16c28
=============Round 2============== 
Plain text : 4e6f772069732074
DES INPUT  : 6f946e16fad24c5c 
DES OUTPUT : 6c463f0cb7167a6f
=============Round 3============== 
Plain text : 68652074696d6520 
DES INPUT  : 04231f78de7b1f4f 
DES OUTPUT : 956ee891e889d91e
===========Final Round============ 
Plain text : 666f722000000000 
DES INPUT  : f3019ab1e889d91e 
DES OUTPUT : f1d30f6849312ca4 
Result: f1d30f6849312ca4 
```

这些值与您指定的值以及本[规范中的值相匹配](http://www.itl.nist.gov/fipspubs/fip113.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-08T03:20:08.123

错误的根本原因来自 FIPS 113 文档提供的十六进制字符串。

文字：“7654321现在是”
十六进制（错误）：“37363534333231204C7720 **68** 73204220”六
十六进制（正确）：“ **37363534333231204220/373635343332312042206236696062066659606236659686520746968652074696060607604220/73665960606074696060666596062066604220**

# apache - web服务器如何在目录中没有索引文件的情况下列出文件

> ID：13440556
> 
> 赞同：2
> 
> 时间：2012-11-18T13:27:17.580
> 
> 标签：apache, browser, nginx, webserver

如果我们没有在web根目录下放置任何索引文件并且该目录具有读取权限，我如何自定义web服务器在`index.*`web根目录或其子目录中没有文件时执行的列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T14:44:14.283

好吧，这取决于您使用的网络服务器。

在**Apache**的情况下，目录索引由名为[mod_autoindex](http://httpd.apache.org/docs/trunk/mod/mod_autoindex.html)的模块处理。

当您想自定义目录列表时，您必须知道 Apache 需要三个“视图”文件：

*   Header — 默认情况下由 Apache 自动生成
*   目录列表——必须由 Apache 生成
*   页脚 — 称为“自述文件”

页眉和页脚部分基本上是用纯 HTML 编写的。目录列表由 Apache 生成，但您可以在其上应用 CSS。

整个事情是一个相当长的故事，所以我可以建议的是一篇写得很好的文章，其中包含有关此“目录列表自定义”的详细信息：

[使用 .htaccess 获得更好的默认目录视图](http://perishablepress.com/better-default-directory-views-with-htaccess/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T13:38:16.627

您可以使用该指令将页面设置为显示目录 url `index`，它不需要指向名为 index.* 的东西，也可以是`whatever.html`. 有关详细信息，请参阅[http://nginx.org/en/docs/http/ngx_http_index_module.html#index](http://nginx.org/en/docs/http/ngx_http_index_module.html#index)

或者您可以设置`autoindex on`提供生成的文件/目录列表，您可以使用`autoindex_exact_size`和`autoindex_localtime`进一步自定义该列表。详见[http://nginx.org/en/docs/http/ngx_http_autoindex_module.html](http://nginx.org/en/docs/http/ngx_http_autoindex_module.html) _

第 3 个选项，如果您的 nginx 是用它编译的，则为`random_index`，请参阅[http://nginx.org/en/docs/http/ngx_http_random_index_module.html](http://nginx.org/en/docs/http/ngx_http_random_index_module.html)了解详细信息。

注意：要了解您的 nginx 是否使用所需的`--with-http_random_index_module`选项编译，请使用命令`nginx -V`

# vb.net - 数组边界不能出现在类型说明符中

> ID：13440557
> 
> 赞同：2
> 
> 时间：2012-11-18T13:27:32.547
> 
> 标签：vb.net, winforms

我在我的代码行中不断出现这个错误，我似乎无法修复它。

这是我的代码：

```
con.Open()
    Dim dt As DataTable
    Dim ds As DataSet
    ds.Tables.Add(dt)
    Dim da As OleDbDataAdapter

    da = New OleDbDataAdapter("Select From * product info", con)
    da.Fill(dt)

    Dim newRow As DataRow = dt.NewRow
    With newRow
        .Item("Product Name:") = txtItemName.Text
        .Item("Description") = txtDescription.Text
        .Item("Quantity:") = txtItemCount.Text
        .Item("Type:") = cmbItemType.Text
        .Item("Date Received:") = txtDate.Text
        .Item("Barcode:") = txtBarcode.Text
        .Item("Price:") = txtPrice.Text
    End With

    dt.Rows.Add(newRow)
    Dim cb As OleDbCommandBuilder(da)
    da.Update(dt)
    con.Close() 
```

在这一`Dim cb As OleDbCommandBuilder(da)`行中，我得到了错误`da`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T13:43:23.807

您混合了变量**cb**的初始化和声明。
要使用的正确语法是

```
Dim cb As OleDbCommandBuilder = new OleDbCommandBuilder(da) 
```

或者

```
Dim cb As OleDbCommandBuilder      'declaration
cb = new OleDbCommandBuilder(da)   'initialization 
```

或（如下康拉德所解释）

```
Dim cb As New OleDbCommandBuilder(da) 
```

# lucene - 如何通过 REST 在 neo4j 全文 api 中使用配置 Lucene 标准分析器

> ID：13440563
> 
> 赞同：0
> 
> 时间：2012-11-18T13:28:01.677
> 
> 标签：lucene, neo4j

如何通过 REST api 在 Neo4j 的全文索引中将分析器设置为标准分析器而不是空白分析器。

我看到我可以配置一个“分析器”属性，但该值应该是什么？

我尝试了以下操作，当我尝试创建它时它会引发错误，然后留下一个损坏的索引。

```
{
  "name" : "Standard4",
  "config" : {
    "type" : "fulltext",
    "provider" : "lucene",
 "analyzer": "org.apache.lucene.analysis.standard.StandardAnalyzer"
  }
} 
```

现在我所有的索引都出错了，它似乎已经炸毁了 neo4j 中的所有索引

在 REST api 中使用 GET 显示：

```
Caused by: java.lang.InstantiationException: org.apache.lucene.analysis.standard.StandardAnalyzer
    at java.lang.Class.newInstance0(Class.java:340)
    at java.lang.Class.newInstance(Class.java:308)
    at org.neo4j.index.impl.lucene.IndexType.getByClassName(IndexType.java:265) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T19:50:23.960

它应该是完全限定的类名，在这种情况下是 org.apache.lucene.analysis.standard.StandardAnalyzer。请记住，一旦创建索引，您就无法更改索引配置。所以用这个配置创建索引，即第一次用这个配置请求它。

# java - 以与 textarea prob 相同的格式保存文件

> ID：13440566
> 
> 赞同：0
> 
> 时间：2012-11-18T13:28:24.183
> 
> 标签：java, swing

> **可能重复：**
> [将多行 JTextArea 内容写入文件](https://stackoverflow.com/questions/13438104/writing-multiline-jtextarea-content-into-file)

我已经编写了从我的文本区域保存文件的代码问题是它把它全部保存在新文本文件中的一行上，而不是像我的文本框中那样。下面是我的代码

```
 String text = dna_ta.getText();

    JFileChooser chooser = new JFileChooser();
    chooser.setCurrentDirectory( new File( "./") );
    int actionDialog = chooser.showSaveDialog(this);
    if (actionDialog == JFileChooser.APPROVE_OPTION)
    {
        BufferedWriter out = null;
        try {
            File fileName = new File(chooser.getSelectedFile( ) + "" );
            if(fileName == null)
                return;
            if(fileName.exists())
            {
                actionDialog = JOptionPane.showConfirmDialog(this,
                                   "Replace existing file?");
                if (actionDialog == JOptionPane.NO_OPTION)
                    return;
            }
            out = new BufferedWriter(new FileWriter(fileName));
            out.write(text);
            out.close(); 
```

在我的文本区域中是这样的

```
 asd
 aaaaaa 
```

但在我保存的文本文件中如下

```
 asdaaaaaa 
```

我不知道哪里出了问题，将其保存为与我的 textarea 中相同的格式。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T13:33:20.330

您可以使用 JTextArea 的`write(...)`方法为您执行此操作：

```
out = new BufferedWriter(new FileWriter(fileName));
dna_ta.write(out);
out.close(); // after first checking if null 
```

从 JTextComponent 派生的所有组件，包括 JTextArea，都具有此方法，该方法将使用操作系统特定的换行符写入新行。

# asp.net - 没有自动回发的 ASP 数据绑定下拉列表

> ID：13440568
> 
> 赞同：1
> 
> 时间：2012-11-18T13:28:38.290
> 
> 标签：asp.net, data-binding, drop-down-menu, autopostback

我有一个简单的表单，下拉列表绑定到一个字符串数组（作为一个简单的例子）。当用户点击一个按钮时，表单被提交。

我想查询列表中的选定项目。我阅读了下拉列表的 SelectedValue 成员，无论我在表单中选择什么，它始终包含默认项。

我不能在列表中使用自动回发，因为在我的生产环境中，表单使用 jquery 显示在动态 div 中。

如果我删除绑定并使用 ListItems 标签在 asp 文件中添加列表项，那么它会神奇地起作用。

我的示例 asp 代码：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>

        <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
        <br />
        <asp:DropDownList ID="DropDownList1" runat="server">
        </asp:DropDownList>
        <br />
        <asp:Button ID="Button1" runat="server" Text="Button" onclick="Button1_Click" />

    </div>
    </form>
</body>
</html> 
```

和代码隐藏文件：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        string[] items = { "bindItem1", "bindItem2", "bindItem3" };
        DropDownList1.DataSource = items;
        DropDownList1.DataBind();
    }
    protected void Button1_Click(object sender, EventArgs e)
    {
        string text = TextBox1.Text;
        string item = DropDownList1.SelectedValue;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T13:32:15.767

只有在 Page.IsPostBack==False 时才在 page_load 中进行数据绑定。

```
 if (!IsPostBack)
    {
        //do the data binding
    } 
```

您的代码现在在每次页面加载时都会一次又一次地绑定数据，因此所选值“不会”改变。

# php - 为什么这不起作用？$array = explode('？', $str);

> ID：13440575
> 
> 赞同：1
> 
> 时间：2012-11-18T13:29:02.157
> 
> 标签：php, regex

我有一个带有句号（也称为“句号”）和问号的中文段落。我想将段落分解成句子数组。我似乎无法`preg_split(/。|？|！/, $str)`处理任何包含问号或感叹号的内容。它忽略了问号和感叹号。

我已经尝试了以下，它工作正常：

```
$array = explode('。', $okresult); 
```

但下面只返回一个数组，其中一个索引填充了整个段落：

```
$array = explode('？', $okresult); 
```

这是我要拆分的段落。它在语法上不正确，我只是将其用作测试：

> 比如说，5世纪，尼希米头作为人类的省长，他尽心竭力做上帝的事！上帝有米上帝没有注意到他的最后一句经文呢？ /p>

这也不起作用：`mb_split('？', $okresult);`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T13:33:54.110

您[`/u`缺少](http://php.net/manual/en/reference.pcre.pattern.modifiers.php)[`preg_split`](http://php.net/preg_split). _ 在这里使用字符类也更短：

```
preg_split('/[。？！]/u', $str) 
```

# javascript - 视差滚动问题 - 在 webkit 浏览器中滚动时 div 元素抖动

> ID：13440577
> 
> 赞同：18
> 
> 时间：2012-11-18T13:29:26.727
> 
> 标签：javascript, jquery, css, google-chrome, webkit

我创建了一个视差滚动，它似乎在 Firefox 中运行良好，但是在 chrome 浏览器中滚动时正文文本略有跳跃。[点击这里滚动到关于部分](http://iamnatesmithen.com/DGI/)。我不确定这是 css 还是 JS 问题。下面是我已合并到视差函数中的片段

有谁知道我如何解决这个问题？

```
$(document).ready(function(){

// Cache the Window object
$window = $(window);

// Cache the Y offset and the speed of each sprite
$('[data-type]').each(function() {  
    $(this).data('offsetY', parseInt($(this).attr('data-offsetY')));
    $(this).data('Xposition', $(this).attr('data-Xposition'));
    $(this).data('speed', $(this).attr('data-speed'));
});

// For each element that has a data-type attribute
$('[data-type="background"]').each(function(){

    // Store some variables based on where we are
    var $self = $(this),
        offsetCoords = $self.offset(),
        topOffset = offsetCoords.top;

    // When the window is scrolled...
    $(window).scroll(function() {

        // If this section is in view
        if ( ($window.scrollTop() + $window.height()) > (topOffset) &&
             ( (topOffset + $self.height()) > $window.scrollTop() ) ) {

            // Scroll the background at var speed
            // the yPos is a negative value because we're scrolling it UP!                              
            var yPos = -($window.scrollTop() / $self.data('speed')); 

            // If this element has a Y offset then add it on
            if ($self.data('offsetY')) {
                yPos += $self.data('offsetY');
            }

            // Put together our final background position
            var coords = '50% '+ yPos + 'px';

            // Move the background
            $self.css({ backgroundPosition: coords });

           $('[data-type="scroll-text"]', $self).each(function() {
                    var $text= $(this);
                     var pos = ($window.scrollTop()/10) * $text.data('speed');
                     var curP = $text.css('margin-top'); 
                     var is_chrome = navigator.userAgent.toLowerCase().indexOf('chrome') > -1;
                     if(is_chrome) {
                         $text.animate({
                         paddingTop: pos,
                        }, 200, 'linear', function() {
                            // Animation complete.
                        });
                     } else {
                     $text.css('padding-top', pos);
                     }
            }); 

        }; // in view

    }); // window scroll

}); // each data-type

      }); // document ready 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T16:20:50.487

一些建议：

1.)`position: fixed`用于避免任何抖动，因为您将从文档流中取出元素。然后，您可以使用 z-index 定位它。

2.) 尽可能多地缓存以减少处理时间。

3.) Math.round 可能不是必需的，但尝试将此 CSS 添加到您的移动区域：`-webkit-transform: translate3d(0,0,0);`这将强制 Chrome 中的硬件加速，这可能会缓解一些抖动。（当我用 Inspector 添加它时，它在我的屏幕上看起来更流畅，但它并没有摆脱滚轮的跳跃。）注意：不要在整个文档（例如正文标签）上这样做，因为它可能导致您当前的布局出现一些问题。（例如，您的导航栏没有粘在窗口顶部。）

4.）如果您有任何动画作为视差逻辑的一部分运行（将边距补间或沿着这些线），请将其删除 - 这可能会导致您看到的跳跃。

希望这可以帮助。祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T14:54:36.753

我在 FireFox 和 Chrome (Mac) 中看到了同样的抖动。查看您的容器，让我眼前一亮的一件事是正在计算/使用的像素位置。

```
Chrome: <div id="about-title" style="margin-top: 1562.3999999999999px;">
FireFox: <div id="about-title" style="margin-top: 1562.4px;"> 
```

浏览器不允许内容位于 1/2 像素，更不用说 0.3999999 像素了。我认为它正在移动它，并试图计算是向上舍入还是向下舍入。它会抖动，因为每次点击鼠标滚轮都会进行计算。

因此，我会尝试将 Math.round() 添加到您的位置，以便容器永远不会陷入困境。

看看这里的代码：[http ://webdesigntutsplus.s3.amazonaws.com/tuts/338_parallax/src/index.html](http://webdesigntutsplus.s3.amazonaws.com/tuts/338_parallax/src/index.html)

Firebug 中的一些元素，您会看到它们唯一的像素分数是“0.5”。他们中的大多数（大部分）都是整数值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T14:59:31.303

您是否尝试过在滚动功能中添加 preventdefault ？

```
$(window).scroll(function(e) {
    e.preventDefault();
    // rest of your code
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T14:54:28.610

您将不得不更改滚动的工作方式（即更改间距的计算方式），但这可以通过将`position:fixed`CSS 元素添加到正在滚动的页面元素来解决。问题来自于 JavaScript 处理和渲染所花费的时间。

例如，在您的页面上，您可以将每个`<div>`包含文本的标签设置为固定位置，然后使用 JavaScript/JQuery 函数更新`top:`CSS 元素。这应该使页面滚动顺畅。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T14:08:50.753

在上一个问题中，我创建了一个相当不错的视差滚动实现。[Jquery Parallax Scrolling effect - Multi directional](https://stackoverflow.com/questions/12461710/jquery-parallax-scrolling-effect-multi-directional/12714412#12714412)你可能会发现它很有用。

这是 JSFiddle [http://jsfiddle.net/9R4hZ/40/](http://jsfiddle.net/9R4hZ/40/)使用向上/向下箭头或滚轮。

使用填充和边距进行定位可能是您遇到渲染问题的原因。虽然我的代码使用滚动或键盘输入来实现效果，但您可以循环相关部分并检查 $moving 变量，直到您到达屏幕上所需的元素。

```
function parallaxScroll(scroll) {
    // current moving object
    var ml = $moving.position().left;
    var mt = $moving.position().top;
    var mw = $moving.width();
    var mh = $moving.height();
    // calc velocity
    var fromTop = false;
    var fromBottom = false;
    var fromLeft = false;
    var fromRight = false;
    var vLeft = 0;
    var vTop = 0;
    if($moving.hasClass('from-top')) {
        vTop = scroll;
        fromTop = true;
    } else if($moving.hasClass('from-bottom')) {
        vTop = -scroll;
        fromBottom = true;
    } else if($moving.hasClass('from-left')) {
        vLeft = scroll;
        fromLeft = true;
    } else if($moving.hasClass('from-right')) {
        vLeft = -scroll;
        fromRight = true;
    }
    // calc new position
    var newLeft = ml + vLeft;
    var newTop = mt + vTop;
    // check bounds
    var finished = false;
    if(fromTop && (newTop > t || newTop + mh < t)) {
        finished = true;
        newTop = (scroll > 0 ? t : t - mh);
    } else if(fromBottom && (newTop < t || newTop > h)) {
        finished = true;
        newTop = (scroll > 0 ? t : t + h);
    } else if(fromLeft && (newLeft > l || newLeft + mw < l)) {
        finished = true;
        newLeft = (scroll > 0 ? l : l - mw);
    } else if(fromRight && (newLeft < l || newLeft > w)) {
        finished = true;
        newLeft = (scroll > 0 ? l : l + w);
    }
    // set new position
    $moving.css('left', newLeft);
    $moving.css('top', newTop);
    // if finished change moving object
    if(finished) {
        // get the next moving
        if(scroll > 0) {
            $moving = $moving.next('.parallax');
            if($moving.length == 0)
                $moving = $view.find('.parallax:last');
        } else {
            $moving = $moving.prev('.parallax');
            if($moving.length == 0)
                $moving = $view.find('.parallax:first');
        }
    }
    // for debug
    $('#direction').text(scroll + " " + l + "/" + t + " " + ml + "/" + mt + " " + finished + " " + $moving.text());
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-12-27T12:10:55.797

可能与您的具体情况无关，但我有一个跳跃的视差滚动问题，我能够解决它为页面的固定部分添加以下 CSS：

```
@supports (background-attachment: fixed)
{
    .fixed-background
    {
        background-attachment: fixed;
    }
} 
```

不确定所有细节，但可以在[Alternate Fixed & Scroll Backgrounds找到](https://codyhouse.co/demo/alternate-fixed-scroll-background/index.html)

# php - 有人可以告诉我应该使用哪种语言

> ID：13440578
> 
> 赞同：1
> 
> 时间：2012-11-18T13:29:27.290
> 
> 标签：php, jquery, ajax, curl

大家好，请你们帮忙吗？我尝试阅读有关 jquery、ajax、json、curl 的信息，但我真的迷路了，所以我寻求帮助以指导我走上正确的道路，非常感谢。

我想要做的是：从 html 中获取

```
<form method="GET" action="https://exemple.com/.../api/work.php">
<input type="hidden" name="method" value="link"/>
<input type="text" name="params[login]"  value="ready" />
</br><input type="text" name="params[pass]"  value="download"/></br>
<input type="text" size="80" name="params[link]" placeholder="get ready"/></br>
  <input type="submit" formtarget="txt" value="Submit">
</form> 
```

把它变成这个

```
<form>
<input type="text" size="80" name="params[link]" placeholder="get ready"/></br>
  <input type="submit" formtarget="txt" value="Submit">
</form>
<iframe type="hidden" name="txt"></iframe> 
```

我想验证 - name="method" value="link" 的第一个输入 - name="params[login]" value="ready" 的第二个输入 - name="params[pass] 的第三个输入“ value="download" 到这个 url [https://exemple.com/api/work.php](https://exemple.com/api/work.php)（这是一个不同的域“跨域”）与 GET 请求

我正在使用的 API 是私有的像这样。

https://exemple.com/...loadlink[login]=USERNAME¶ms[pass]=PASSWORD¶ms[link]=LINK
这就是提交的方式。结论

我不希望访问者看到 url 或他们可以提交他们想要检查的链接的 3 个输入。

非常感谢，我希望有人能指导我正确的方式我现在迷路了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:32:09.220

如果您不想显示密码，则需要使用服务器端语言进行实际的 API 调用 - PHP 可能是一个不错的选择。使用它进行 HTTP 请求是现在使用的简单问题`file_get_contents($URL)`。

这意味着您需要将来自客户端的值传递给它。两种选择：JavaScript（通过 AJAX）或普通的旧 HTTP 请求。

不过有一件事。如果您提供的 URL 结构是正确的，那么编写该 API 的人就需要被枪决，因为 CSRF 很可能在这方面被滥用。

# sqlalchemy - 查询由多对多关系过滤的多个连接继承表

> ID：13440579
> 
> 赞同：0
> 
> 时间：2012-11-18T13:29:34.047
> 
> 标签：sqlalchemy, flask-sqlalchemy

我有一个大致如下所示的 SQLAlchemy 方案：

```
participation = db.Table('participation',
        db.Column('artist_id', db.Integer, db.ForeignKey('artist.id'),
                  primary_key=True),
        db.Column('song_id', db.Integer, db.ForeignKey('song.id'),
                  primary_key=True),
)

class Streamable(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    kind = db.Column(db.String(10), nullable=False)
    score = db.Column(db.Integer, nullable=False)
    __mapper_args__ = {'polymorphic_on': kind}

class Artist(Streamable):
    id = db.Column(db.Integer, db.ForeignKey('streamable.id'), primary_key=True)
    name = db.Column(db.Unicode(128), nullable=False)
    __mapper_args__ = {'polymorphic_identity': 'artist'}

class Song(Streamable):
    id = db.Column(db.Integer, db.ForeignKey('streamable.id'), primary_key=True)
    name = db.Column(db.Unicode(128), nullable=False)
    artists = db.relationship("Artist", secondary=participation,
                              backref=db.backref('songs'))
    __mapper_args__ = {'polymorphic_identity': 'song'}

class Video(Streamable):
    id = db.Column(db.Integer, db.ForeignKey('streamable.id'), primary_key=True)
    song_id = db.Column(db.Integer, db.ForeignKey('song.id'), nullable=False)
    song = db.relationship('Song', backref=db.backref('videos', lazy='dynamic'),
                           primaryjoin="Song.id==Video.song_id")
    __mapper_args__ = {'polymorphic_identity': 'video'} 
```

我想对具有特定艺术家的歌曲或视频进行一次查询；即，这两个查询在一个查询中（所有查询都应该是`.order_by(Streamable.score)`）：

```
q1=Streamable.query.with_polymorphic(Video)
q1.join(Video.song, participation, Artist).filter(Artist.id==1)
q2=Streamable.query.with_polymorphic(Song)
q2.join(participation, Artist).filter(Artist.id==1) 
```

这是我达到的最好的；它发出可怕的 SQL 并且总是产生空结果（不知道为什么）：

```
p1=db.aliased(participation)
p2=db.aliased(participation)
a1=db.aliased(Artist)
a2=db.aliased(Artist)
q=Streamable.query.with_polymorphic((Video, Song))
q=q.join(p1, a1).join(Video.song, p2, a2)
q.filter(db.or_((a1.id==1), (a2.id==1))).order_by('score') 
```

如果有的话，执行此查询的正确方法是什么（也许关系数据存储不是我工作的正确工具......）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T12:19:57.937

您的查询基本上是正确的。我认为从`join`to的更改`outerjoin`应该可以解决问题：

```
q=q.outerjoin(p1, a1).outerjoin(Video.song, p2, a2) 
```

我还将替换为`order_by`：

```
q = q.order_by(Streamable.score) 
```

# javascript - Javascript - 从一个项目淡入到另一个项目都会短暂弹出

> ID：13440580
> 
> 赞同：0
> 
> 时间：2012-11-18T13:29:40.740
> 
> 标签：javascript

我的网站上有一个推荐区域，该区域从一个推荐消失到另一个。我遇到了一个问题，即在下一个项目消失之前它会淡出太慢，导致两者都出现，使得一个大的 div 看起来很难看。

我希望它从一个推荐消失到另一个推荐，而不会同时跳跃和闪烁。

你可以在这里看到一个例子：http: [//ledragonvert.com/index_test.php](http://ledragonvert.com/index_test.php)

这是我的 Javascript 代码：

```
function rotate_p() {
if (p_current == p_count) {
p_current = 1;
} else {
p_current++;
}
var $container = $('#container');
$container.find('p').fadeOut();
$container.find('p:nth-child(' + p_current + ')').fadeIn();
}

var p_count;
var p_current = 0;
var p_interval;
$(document).ready(function () {
rotate_p();
p_count = $('#container').find('p').length;
p_interval = setInterval(function () {rotate_p();}, 7000);
}); 
```

非常感谢您抽出时间来帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:49:49.323

该解决方案是基于 CSS 的。由于“p”元素的位置是静态的，并且您同时调用了fadeOut 和fadeIn，因此存在重叠，因为**两个**p 元素不可避免地会一起显示。要将它们*放在另一个之上，*您需要在 p 元素上使用绝对定位，如下所示：

```
 #container {
 position:relative;
  }
 #container>p {
    position:absolute;
   //use any values you wish, to set the testimonial relative to #container:
   top:10px; 
   left:50px; 
   } 
```

# php - Contenteditable/Jquery/Ajax/PHP/mysql - 无法从 URL 识别 $_GET 变量

> ID：13440582
> 
> 赞同：2
> 
> 时间：2012-11-18T13:30:05.990
> 
> 标签：php, mysql, ajax, contenteditable

我正在尝试构建一个站点，您可以在其中直接使用 contenteditable 结合 jquery、ajax 和 PHP 修改和更新 mysql 数据库。该代码通过带有一些 jquery/ajax 的 $_POST['content'] 捕获数据以加载 php 文件（save.php）。save.php 文件运行 mysql UPDATE 以使用用户提供的 contenteditable 输入的 $_POST['content'] 信息更新数据库。

在 save.php 文件中，我使用唯一 ID 来标识必须更新的行。此 ID 可通过 URL 访问。我尝试通过 $_GET['id'] 捕获 ID 并将其转换为 $var_id=$_GET['id']。我的问题是，当我尝试访问从 URL 获得的 id ($var_id) 变量时

前任。[http://www.website.org/selectedvariant.php?id=100](http://www.website.org/selectedvariant.php?id=100)

在 save.php 文件中无法识别 $var_id 并且 mysql UPDATE 不起作用。我知道这是访问 $var_id 变量的问题，因为当我手动输入 variable_id='100' 时，它可以正常工作。表明 save.php 文件没有得到 $var_id 变量的正确值。

任何有助于解决这一长期挑战的帮助将不胜感激！

保存.php

```
<?php mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

$content=mysql_real_escape_string ($_POST['content']); //gets the posted content
$var_id=$_GET['id'];

$sql="update table_list set column='$content' where id='$var_id'";
if (mysql_query($sql))
{echo 1;
}
?> 
```

other.php 文件（仅相关（我认为？））信息

```
 $(document).ready(function() {

    $("#save").click(function (e) {         
        var content = $('#editable').html();    

        $.ajax({
            url: 'save.php',
            type: 'POST',
            data: {
            content: content
            }, 
```

大部分代码已从教程中提取：

[http://gazpo.com/2011/09/contenteditable/](http://gazpo.com/2011/09/contenteditable/)

谢谢，罗恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:42:24.180

当您进行 ajax 调用时，您需要同时通过某种方法（get 或 post）来`content`传递`id`。在您的代码中，您通过方法将`content`数据发送到. 无论如何都不会发送到您的 php 脚本。将您的参数更改为 -`POST``save.php``ID``url`

```
url:'save.php?id='+WhatYouHaveInHand 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T13:40:21.550

您没有在任何地方传递 ID。这就是问题所在。

对于同样返回 GET 参数的 AJAX POST 调用，参数必须在查询字符串中。所以，例如，如果你想传递一个随机 ID，你会做

```
$("#save").click(function (e) {         
    var content = $('#editable').html();    
    var randomID = Math.floor(Math.random()*1000);
    $.ajax({
        url: 'save.php?id='+randomID,
        type: 'POST',
        data: {
        content: content
        },this: 
```

您显然需要对此进行调整以提供真实 ID。然而，这个想法是存在的。

# symfony - 分组依据的教义2分页器错误

> ID：13440583
> 
> 赞同：1
> 
> 时间：2012-11-18T13:30:07.323
> 
> 标签：symfony, doctrine-orm, dql

我使用此 DQL 获取一些数据，但在使用教义 2 分页器时出现错误：

```
SELECT f FROM DankeForumBundle:Forumusermessage f
  WHERE f.recipientdelete=0
  GROUP BY f.forwarder
  HAVING f.recipient=:recipient 
```

这是因为教义执行这个查询来计算页数：

```
SELECT count(DISTINCT f.id) FROM Forumusermessage AS f
  WHERE f.recipientdelete=0
  GROUP BY f.forwarder_id
  HAVING f.recipient_id=:recipient 
```

有没有办法在不使用本机 SQL 查询的情况下对其进行分页？

编辑：

这是一个示例 PHP 代码：

```
$query = $this->getEntityManager()->createQuery('SELECT f FROM DankeForumBundle:Forumusermessage f
  WHERE f.recipientdelete=0
  GROUP BY f.forwarder
  HAVING f.recipient=:recipient');
$query->setParameter('recipient', $user);
$query->setFirstResult(0);
$query->setMaxResults(10);
$paginator = new \Doctrine\ORM\Tools\Pagination\Paginator($query);
echo count($paginator); // wrong page count 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T14:14:39.683

我找到了使用子查询的解决方法：

```
SELECT f FROM DankeForumBundle:Forumusermessage f
WHERE
  f.recipientdelete=0 AND
  f.recipient=:recipient
  AND f.id IN (
    SELECT fn FROM DankeForumBundle:Forumusermessage fn
    GROUP BY fn.forwarder
  ) 
```

# css - 如果没有完美尺寸的图像，如何创建一个好看的响应式图像库？

> ID：13440584
> 
> 赞同：2
> 
> 时间：2012-11-18T13:30:31.550
> 
> 标签：css, twitter-bootstrap, gallery, responsive-design

我正在使用 Wordpress 和用户上传的图片。我正在尝试使用 Bootstrap 构建响应式图片库，但遇到了一些麻烦：

[Picture.png http://img339.imageshack.us/img339/6838/picturehq.png也可以在](http://img339.imageshack.us/img339/6838/picturehq.png)[jsfiddle](http://jsfiddle.net/ExdzX/) 上找到它，（确保将输出窗口设置得足够大，以便它们切换到多列）

一些现实世界的挑战和我的一些限制：

*   图像不会都是相同的大小
*   图像不必全部相同
*   图库需要响应式（图像可以缩小/增长，可以从 2、3、4 列等更改）
*   字幕可以是任意长度，并且应该自动截断/隐藏/等。
*   我希望图像具有适当的纵横比，例如不`width:100%; height:100%`
*   字幕应该以某种方式排列

**我试过的**

在响应式设计之前，我用来创建图像画廊的一种棘手方法是让 Wordpress 创建两种图像尺寸，一种具有最大宽度，另一种具有最大高度，两者都具有我想要的大小的软裁剪画廊缩略图。在生成图库时，我会检查哪些没有溢出边界，然后使用该图像作为缩略图。另一种方法是只使用接近我想要的大小的图像，然后将图像设置`background-url`为位置设置为的包含元素的a `center/center`。这适用于固定宽度的设计，**但不适用于响应式！**:)

另外，据我所知，响应式设计/ css 无法设置背景图像的比例。`<img>`使用标签而不是通过 CSS`<div>`的集合来编码图像似乎在语义上更准确。`background-image`

如果没有响应式设计，您可能还会有固定的列数，因此您可以`clear:left`在每 n^个图像上执行一次，以防止发生奇怪的包装。但是通过响应式设计，列数可能会从 2、3、4 等变化。

此外，如果没有响应式设计，您可以使用 Javascript 循环遍历图像/缩略图容器并标准化它们的高度。在响应式设计上执行此操作并非不可能，但是您必须等待页面完全加载，因为高度设置为以百分比开始，并且在加载所有资源之前可能不准确。然后，您必须担心窗口大小调整或方向更改会发生什么。这似乎是一种技巧，而不是正确的方法。

我还尝试设置元素的`min-height`区域并将包含图像的区域设置为以及将其设置为具有。结果更好，但仍然不是很好：`.thumbnail``<a>``display:block``min-height`

3栏： [图片.png http://img818.imageshack.us/img818/9472/picturemk.png](http://img818.imageshack.us/img818/9472/picturemk.png)

4列：

[图片1.png http://img525.imageshack.us/img525/706/picture1uh.png](http://img525.imageshack.us/img525/706/picture1uh.png)

### 那么，如果没有完美尺寸的图像，如何创建一个好看的响应式图像库呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:04:24.323

虽然这*不需要*“完美尺寸的图像”，但对于纯 CSS 的解决方案，它确实需要特定尺寸的`li`元素，以及它们的`overflow`to `hidden`（这样图像的比例不会歪斜，尽管它可能会被裁剪由父`li`容器）。

将`li`元素 设置为`float: left;`与定义相结合`width`并`height`允许统一的呈现/分布，画廊能够根据窗口/父级的宽度自适应和重排`ul`：

```
li {
    width: 160px;
    height: 160px;
    padding: 4px;
    float: left;
    position: relative;
    overflow: hidden;
}

li p {
    position: absolute;
    color: #fff;
    opacity: 0;
    bottom: 0;
    left: 0;
    right: 0;
    margin: 0 0 -1px 0;
}

li:hover p {
    opacity: 1;
    background-color: #000;
    background-color: rgba(0,0,0,0.5);
    -webkit-transition: all 1s linear;
} 
```

[JS Fiddle 演示（带`float: left;`）](http://jsfiddle.net/davidThomas/ExdzX/3/)。

（删除了`display: inline-block`解决方案，因为它似乎不允许后代元素相对于`li`具有该`display`属性的 进行绝对定位。）

如果 JavaScript 解决方案是可能的，那么还有[jQuery-required Masonry](http://masonry.desandro.com/) (and [non-jQuery Masonry](http://vanilla-masonry.desandro.com/) ) 和[Isotope (requires jQuery)](http://isotope.metafizzy.co/)等等。

虽然，如果您能够忍受`li`s 的受限宽度，并且跨浏览器支持^([*兼容性*](http://www.quirksmode.org/css/contents.html#t410))有些受限，您可以使用 CSS 列：

```
ul {
    -moz-column-width: 160px;
    -moz-column-gap: 0;
    -ms-column-width: 160px;
    -ms-column-gap: 0;
    -o-column-width: 160px;
    -o-column-gap: 0;
    -webkit-column-width: 160px;
    -webkit-column-gap: 0;
    column-width: 160px;
    column-gap: 0;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/ExdzX/2/)。

# exchangewebservices - subscribeToPullNotifications 未检测到收件箱中的新电子邮件

> ID：13440588
> 
> 赞同：7
> 
> 时间：2012-11-18T13:30:49.020
> 
> 标签：exchangewebservices, ewsjavaapi

我正在尝试使用 subscribeToPullNotifications 检测收件箱中的新电子邮件，如下所示：

```
PullSubscription subscription = service.subscribeToPullNotifications(
                folder, 1, null, EventType.NewMail);

        GetEventsResults events = subscription.getEvents();
        System.out.println("####### EVENTS: "
                + events.getItemEvents().toString());
        for (ItemEvent itemEvent : events.getItemEvents()) {
            if (itemEvent.getEventType() == EventType.NewMail) {
                EmailMessage message = EmailMessage.bind(service,
                        itemEvent.getItemId());
                System.out.println("######## NEW EMAIL MESSAGE IS: "
                        + message.getSubject());
            }
        } 
```

但`events.getItemEvents()`始终是空的，即使我可以在收件箱中看到新电子邮件。此外，如何在应用程序运行时始终重复上述代码，以便每分钟检查新电子邮件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-17T07:59:31.267

这取决于您何时调用它，如果假设您将其作为特定间隔调用，那么您需要在新请求中传递先前响应的“WaterMark”，否则在两者之间发生的所有事件都将丢失。 **方法：subscription.getWaterMark()**

**需要将此作为第三个参数传递给方法 subscribeToPullNotifications()**

否则，您可以通过将其置于循环中来不断地使用相同的服务：

```
 while (true) {

    GetEventsResults events = null;

    try {
         events = subscription.getEvents();
    } catch (Exception e1) {
         e1.printStackTrace();
    }

    for (ItemEvent itemEvent : events.getItemEvents()) {
        // do something...
    }

 } 
```

***但这会不断地从服务器增加的负载中拉出来，所以宁愿使用第一种方法，定期订阅，并在请求中传递先前的水印。***

# windows - 从 windows cmd 检索文件属性

> ID：13440589
> 
> 赞同：5
> 
> 时间：2012-11-18T13:30:49.037
> 
> 标签：windows, node.js, powershell, cmd

因为 node.js 没有提供在 Windows 上检索和修改文件属性的方法，所以我需要执行一个子进程。我想获取所有文件属性，即：

*   尺寸
*   档案
*   隐
*   只读
*   系统
*   创建/修改/访问时间
*   文件？/目录？/符号链接？（交界处）

如果我要执行一个子进程，我不想调用 fs.stat，因为它是一个额外的 I/O 访问（而且 Stats 不会在 Windows 上提供太多信息）。如果我执行一个子进程，我想一次检索所有数据。

所以，我写了一个powershell脚本：

```
var cmd = "powershell -Command \"$item=get-item a -force;[bool]($item.attributes -band [io.fileattributes]::directory);[bool]($item.attributes -band [io.fileattributes]::archive);[bool]($item.attributes -band [io.fileattributes]::reparsepoint);[bool]($item.attributes -band [io.fileattributes]::hidden);[bool]($item.attributes -band [io.fileattributes]::readonly);[bool]($item.attributes -band [io.fileattributes]::system);$item.length;$tmp=$item.creationtime;$tmp.year;$tmp.month;$tmp.day;$tmp.hour;$tmp.minute;$tmp.second;$tmp.millisecond;$tmp=$item.lastaccesstime;$tmp.year;$tmp.month;$tmp.day;$tmp.hour;$tmp.minute;$tmp.second;$tmp.millisecond;$tmp=$item.lastwritetime;$tmp.year;$tmp.month;$tmp.day;$tmp.hour;$tmp.minute;$tmp.second;$tmp.millisecond;$s\""; 
```

这将返回：（曾经在 javascript 中拆分过`split("\r\n")`：）

```
[ 'False', //directory?
  'True', //archive?
  'False', //symlink?
  'False', //hidden
  'False', //readonly?
  'False', //system?
  '3', //length (if directory, empty string)
  '2012', //creation time, year
  '11', //creation time, month
  '18', //creation time, day
  '6', //creation time, hour
  '8', //creation time, min
  '44', //creation time, ysec
  '457', //creation time, millis
  '2012', //last access time, year...
  '11',
  '18',
  '6',
  '8',
  '44',
  '457',
  '2012', //last modified time, year...
  '11',
  '18',
  '14',
  '0',
  '38',
  '859',
  '' ] 
```

问题是windows XP不附带powershell，你需要安装它（顺便说一句，现在谁在使用带有node.js的windows xp？傻），所以我正在搜索一个可以检索相同信息的cmd命令。我已经看到它`dir`可以显示我需要的所有内容，但它不显示秒和毫秒，而且我还没有找到一种方法来确定文件是否是符号链接......

* * *

编辑：解决方案似乎在 Windows Script Host 中。从 Windows 98 开始可用，脚本是用 javascript 编写的。

解决方案：

jscript 中的 Windows 主机脚本：

**whs.js**

```
var fs = new ActiveXObject ("Scripting.FileSystemObject");
var name = WScript.Arguments.item (0);
var file;
try{
    file = fs.getFile (name);
}catch (e){
    file = fs.getFolder (name);
}
//http://msdn.microsoft.com/en-us/library/windows/desktop/gg258117%28v=vs.85%29
//-1 if true, 0 if false
WScript.echo (!!(file.attributes & 1)); //Read-only
WScript.echo (!!(file.attributes & 2)); //Hidden
WScript.echo (!!(file.attributes & 4)); //System
WScript.echo (!!(file.attributes & 16)); //Directory
WScript.echo (!!(file.attributes & 32)); //Archive
WScript.echo (!!(file.attributes & 1024)); //Reparse point (symbolic link)
WScript.echo (file.size); //0 if directory
WScript.echo (file.dateCreated);
WScript.echo (file.dateLastAccessed);
WScript.echo (file.dateLastModified); 
```

节点.js：

```
var file = "a";
require ("child_process").exec ("cscript " + __dirname +
        "/wsh.js " + file + " //Nologo",
        function (error, stdout, stderr){
            if (error) return console.log (error);
            if (stderr) return console.log (stderr);
            stdout = stdout.split ("\r\n");
            console.log(stdout)
}); 
```

结果：

```
[ '0',
  '0',
  '0',
  '0',
  '-1',
  '0',
  '3',
  '18/11/2012 15:45:04',
  '18/11/2012 15:45:04',
  '18/11/2012 15:45:12',
  '' ] 
```

无法检索毫秒但没关系（linux atime，mtime没有ms）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T09:54:02.647

您已经回答了自己。但是有一种方法可以[使用批处理文件读取一些文件属性](http://www.robvanderwoude.com/ntforfileattributes.php) ：

```
c:\>for /f %A in ("example.file") do echo %~aA 
```

在批处理脚本中：

```
for /f %%A in ("example.file") do echo %%~aA 
```

或使用属性：

```
c:\>attrib + semitest.bat /s /d 
```

其中属性是：

```
 R  Read-only (1)
    H  Hidden (2)
    A  Archive (32)
    S  System (4) 
```

扩展属性：

```
 E  Encrypted
    C  Compressed (128:read-only)
    I  Not content-indexed
    L  Symbolic link/Junction (64:read-only)
    N  Normal (0: cannot be used for file selection)
    O  Offline
    P  Sparse file
    T  Temporary 
```

# internet-explorer - 谷歌地图和 CSS 缩放

> ID：13440594
> 
> 赞同：0
> 
> 时间：2012-11-18T13:31:07.530
> 
> 标签：internet-explorer, google-maps, css, google-maps-api-3

我有一个要缩小的地图 div。我是这样做的

```
<div style="
-moz-transform: scale(0.60);
-webkit-transform: scale(0.60);
-o-transform: scale(0.60);
-ms-zoom:0.60;">
<div id="map" style="width:500px; height:500px;"></div>
</div> 
```

所以如你所见，我想缩小到 60%。在 firefox、chrome、opera 和 safari 中完美运行。但是总有资源管理器... -ms-zoom: 1.0 正常工作 100%。2.0 的工作是因为是 200% 等等。但是如果我尝试低于 100%，地图 div 会变灰并且地图不可见......我尝试了这些变化：

```
-ms-zoom:0.60;
-ms-zoom:0.6;
-ms-zoom:60%;
zoom:0.60;
zoom:0.6;
zoom:60%; 
```

没别的了。地图仍然是灰色的...... div 变小了，但我不明白为什么地图不可见。我使用 api V2，但我尝试使用 V3 并得到相同的结果

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T13:36:47.020

您不应该使用 css zoom 来缩放 Google 地图。[相反，请使用Maps Documentation V3](https://developers.google.com/maps/documentation/javascript/reference#MapOptions)中描述的 MapOptions 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T13:37:14.927

我在发布问题 2 分钟后才找到解决方案。对此感到抱歉。答案是

```
-ms-transform: scale(0.60); 
```

我在最新的浏览器中测试了这个，仍然不知道它是否适用于旧版本。我要测试它并在这里发布结果

# c# - 获取从 StartDate 到 EndDate 的日期列表

> ID：13440595
> 
> 赞同：2
> 
> 时间：2012-11-18T13:31:09.170
> 
> 标签：c#, linq, lambda

如何使用 linq 或 lambda 表达式获取开始日期和结束日期之间的日期列表。

```
DateTime StartDate = DateTime.Now;
DateTime EndDate = DateTime.Now.AddMonths(13);
List<DateTime> ListofDates = //Contains list of all dates only between start and end date. 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-18T13:33:09.367

```
Enumerable.Range(0, (EndDate - StartDate).Days).Select(i => StartDate.AddDays(i)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T14:45:36.657

首先，当你想要`Dates`而不是`Datetimes`你最好使用`DateTime.Now.Date`而不是仅仅`DateTime.Now`

我已经编辑了 SLaks 代码，所以你可以得到你想要的日期列表。

```
DateTime StartDate = DateTime.Now.Date;
DateTime EndDate = DateTime.Now.Date.AddMonths(13);
IEnumerable<double> daysToAdd = Enumerable.Range(0,
                                                (EndDate - StartDate).Days + 1)
                                            .ToList().ConvertAll(d => (double)d);
IEnumerable<DateTime> ListOfDates = daysToAdd.Select(StartDate.AddDays).ToList(); 
```

请注意，我已`+1`在可枚举中添加，因此您可以同时拥有日期`start`和`end`日期（您没有指定它）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T15:16:31.260

```
List<DateTime> ListofDates = Enumerable.Range(0, (EndDate - StartDate).Days)
                                       .Select(i => StartDate.AddDays(i))
                                       .ToList(); 
```

# regex - Reg Expr 格式删除手机号码中的标点符号

> ID：13440601
> 
> 赞同：2
> 
> 时间：2012-11-18T13:32:01.280
> 
> 标签：regex, replace

我有一个巨大的文件，其中的字符串如下所示：

```
ABS; Ba; Accountant / Belastingconsulent;Nederlands;2001/04/03;2001/04/03;Hollestraat 32a 9450 HAALTERT;straat xxa;9450;HALTER;+32 (53) 12.34.56;+32 (53) 12.34.56;;Beekstraat 67/1 9300 AALST;Beekstraat 67/1;9300;AALST;+32 (53) 12.34.56;+32 (53) 12.34.56;+32 (474) 12.34.56;;
1;emailaddr@email.com; deepurllink; 
```

数字字段现在是不可用的格式：

```
;+32 (53) 12.34.56;+32 (53) 12.34.56;;Somestraat 67/1 9300 AALST;Somestraat 67/1;9300;AALST;+32 (53) 12.34.56;+32 (53) 12.34.56;+32 (474) 12.34.56;; 
```

我至少需要找到手机号码并将其格式化为：

```
;+32 (474) 12.34.56; 
```

至

```
;+32474123456; 
```

如果有人可以建议一个 reg expr 来查找和替换它，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T14:15:11.190

我不想猜测..这里的信息可以帮助你：

正则表达式： `/;(\+[0-9]{2}) \(([0-9]{2,3})\) ([0-9]{2}).([0-9]{2}).([0-9]{2})/g`

图案： `;(\+[0-9]{2}) \(([0-9]{2,3})\) ([0-9]{2}).([0-9]{2}).([0-9]{2})`

用。。。来代替： `;$1$2$3$4$5`

在这里，我们捕获了 5 个组：

```
group 1: (\+[0-9]{2})
group 2: ([0-9]{2})
group 3: ([0-9]{2})
group 4: ([0-9]{2})
group 5: ([0-9]{2}) 
```

输入：

```
ABS; Ba; Accountant / Belastingconsulent;Nederlands;2001/04/03;2001/04/03;Hollestraat 32a 9450 HAALTERT;straat xxa;9450;HALTER;+32 (53) 12.34.56;+32 (53) 12.34.56;;Beekstraat 67/1 9300 AALST;Beekstraat 67/1;9300;AALST;+32 (53) 12.34.56;+32 (53) 12.34.56;+32 (474) 12.34.56;;1;emailaddr@email.com; deepurllink 
```

输出：

```
ABS; Ba; Accountant / Belastingconsulent;Nederlands;2001/04/03;2001/04/03;Hollestraat 32a 9450 HAALTERT;straat xxa;9450;HALTER;+3253123456;+3253123456;;Beekstraat 67/1 9300 AALST;Beekstraat 67/1;9300;AALST;+3253123456;+3253123456;+32474123456;;1;emailaddr@email.com; deepurllink 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-18T14:29:10.403

为了`;+32 (474) 12.34.56;`成为`;+32474123456;`，找到`/[.() ]/g`并替换为无。

# javascript - 从 JavaScript 中的私有方法访问成员变量

> ID：13440602
> 
> 赞同：0
> 
> 时间：2012-11-18T13:32:04.910
> 
> 标签：javascript, private-methods

lick() 是 Cat 的私有方法。不幸的是，在 lick() 中无法访问 Cat 的 this.paw。有没有一种简单的方法来创建一个可以访问其包含类的成员变量的私有方法？

```
<!doctype html>
<html>
<head>
<meta charset="utf-8">
</head>
<body>
<p id="catStatus">???</p>
<script>
function Cat() {

    this.paw;

    var lick = function() {
        alert(this.paw);
        if(this.paw == "sticky") {
            alert("meow");
            document.getElementById("catStatus").innerHTML = "*Slurp*";
        }
    };

    this.beCat = function() {
        this.paw = "sticky";
        lick();
    }
}
var kitty = new Cat();
kitty.beCat();
</script>
</body>
</html> 
```

![结果](../Images/9f83a23f1da29c005f580fa30c04fe19.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:35:12.643

的值`this`取决于您如何调用该方法。
由于您没有在对象实例上调用该方法，因此`this`成为全局对象。

相反，您需要保存`this`在一个变量中：

```
function Cat() {
    this.paw = ...;

    var me = this;

    var lick = function() {
        alert(me.paw);
        if(me.paw == "sticky") {
            alert("meow");
            document.getElementById("catStatus").innerHTML = "*Slurp*";
        }
    };

    this.beCat = function() {
        this.paw = "sticky";
        lick();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T13:38:30.103

有几种方法可以解决这个问题。问题是 lick 内部的上下文不是 cat 的实例。您可以：

使用 call 方法设置上下文

```
this.beCat = function() {
    this.paw = "sticky";
    lick.call(this);
}; 
```

或使用闭包

```
var instance = this;
var lick = function() {
    alert(instance.paw);
    if(instance.paw == "sticky") {
        alert("meow");
        document.getElementById("catStatus").innerHTML = "*Slurp*";
    }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-18T13:42:17.540

this 的上下文取决于谁调用了该函数。在这种情况下，它是 beCat。但是，您可以使用 call 显式指定 this 范围。

在你的情况下：

```
 this.beCat = function () {
        this.paw = "sticky";
        lick.call(this);
    } 
```

或者您可以将 this 存储在变量中。

[您可以在此处](http://unschooled.org/2012/03/understanding-javascript-this/)阅读有关此范围/如何工作的更多信息。

# php - 按时间戳条目聚合和可视化 SQLite 数据库中的条目

> ID：13440609
> 
> 赞同：1
> 
> 时间：2012-11-18T13:32:26.607
> 
> 标签：php, javascript, sql, sqlite, d3.js

我有一个很大的 SQLite - 包含如下条目的数据库：

```
rowID   timestamp    employee  sold         
1       1345294648   myer      1
2       1351508109   miller    2          
3       1351508109   smith     8
4       1351508109   miller    10
5       1351508109   smith     1
6       1353243448   myer      10 
```

它代表某些员工在特定时间售出的单位数量。

使用 php 中的以下代码，我可以获得每个员工的销售单位：

```
<?php

$response = array();
$db = new PDO("sqlite:./db.sqlite");

$query_count = $db -> query("SELECT * FROM myTable GROUP BY employee");

while ($row = $query_count -> fetch(PDO::FETCH_ASSOC)) {

$current_employee = $row['employee'];

$response[$current_employee]["sold"] = $row['sold'];

}

echo json_encode($response);

?> 
```

这将返回以下 JSON 格式的数据：

```
{ 
  "miller" : { "sold" : 12 },
  "myer" : { "sold" : 11 },
  "smith" : { "sold" : 9 }
} 
```

现在我想将销售分成不同的月份，如下所示：

```
{
   "miller":{
      "sold":{
         "january":1,
         "february":8,
         "march":9
      }
   },
   "myer":{
      "sold":{
         "january":10,
         "february":11,
         "march":13
      }
   },
   "smith":{
      "sold":{
         "january":11,
         "february":10,
         "march":10
      }
   }
} 
```

之后，我想用条形图可视化数据，像这样但非堆叠：

[http://bl.ocks.org/1134768](http://bl.ocks.org/1134768)

是否有可以帮助我的 SQL 请求/PHP 脚本？

我很高兴每一个答案，提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T08:16:21.083

SQLite 提供不同的日期函数，按日期聚合数据：

[http://www.sqlite.org/lang_datefunc.html](http://www.sqlite.org/lang_datefunc.html)

# python - Flask 和 SQLAlchemy 以及 MetaData 对象

> ID：13440610
> 
> 赞同：3
> 
> 时间：2012-11-18T13:32:35.863
> 
> 标签：python, sqlalchemy, flask, flask-sqlalchemy

这是我第一次使用这种环境。

我愿意使用的 SQLAlchemy 部分只是允许我使用带有 autoload = True 的 Table 对象查询数据库的部分。我这样做是因为我的表已经存在于数据库（mysql 服务器）中，并且不是通过定义烧瓶模型创建的。

我浏览了所有文档，但似乎没有找到答案。这是一些代码：

```
app = Flask(__name__)
app.config.from_object(__name__)

metadata = None

def connect_db():
    engine = create_engine(app.config['DATABASE_URI'])
    global metadata
    metadata = MetaData(bind=engine)
    return engine.connect()

@app.before_request
def before_request():
    g.db = connect_db()

@app.teardown_request
def teardown_request(exception):
    g.db.close() 
```

现在您可能想知道为什么我使用名为元数据的全局变量。好的，还有一些代码：

```
@app.route('/test/<int:id>')
def test(test_result_id):

    testTable = Table('test_table', metadata , autoload=True) 
```

如您所见，我需要该对象是全局的，以便从函数中访问它。

此外，我在每个需要它的函数中声明了相同的 var testTable。我觉得这不是正确的方法。对于像我这样的案例，我找不到任何最佳实践建议。

谢谢大家！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-10T06:43:03.867

你在 SQLAlchemy 文档中看到过[这个片段吗？](http://docs.sqlalchemy.org/en/rel_0_8/core/schema.html#reflecting-all-tables-at-once)

也许这会起作用：

```
# This is fine as a global global
metadata = MetaData()

@app.before_first_request
def autoload_tables():
    meta.reflect(bind=g.db.bind)

@app.route('/')
def index():
    users_table = meta.tables['users'] 
```

这样，您的表格在每个进程中只反映一次，这可能是您想要的。请注意，您的引擎也应该是全局的，因此您无需在 @app.before_request 中创建新引擎 - 应用程序创建是一个更合适的地方。

如果您的情况非常特殊，每个请求可能需要一个引擎，在这种情况下，您应该考虑[ThreadLocalMetaData](http://docs.sqlalchemy.org/en/rel_0_8/core/schema.html#sqlalchemy.schema.ThreadLocalMetaData)类。

# c++ - 如何将 boost::multi_array 保存到文件中

> ID：13440611
> 
> 赞同：1
> 
> 时间：2012-11-18T13:32:36.253
> 
> 标签：c++, boost, save, binaryfiles, boost-multi-array

我正在寻找一种简单的方法来保存和从文件中加载 3D boost::multi_array。据我所知，Boost 库中没有我觉得奇怪的方法。

我不需要该文件是人类可读的，因此二进制文件会更好地提高性能。谁能指点我一个现成的解决方案或给我有关如何实现此类读/写方法的想法？

我使用 bool 和 ints 类型的 3D multi_arrays，所以我需要使用模板。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T06:46:46.093

不需要使用一些特殊的序列化库，因为你的数据已经在内存中序列化了，你可以通过如下方式获取（假设`A`是包含`int`数据的数组：

```
int *data = A.data();
size_t size = A.num_elements(); 
```

您可以将其一一写入文件。更好的方法可能是使用`mmap`，如下所示：

```
int fd = open("myfile", O_RDWR);
size_t bytes = size * sizeof(int);
ftruncate(fd, bytes);
void *buf = mmap(NULL, bytes, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0);
memcpy(buf, data, bytes);
close(fd);
munmap(buf, bytes); 
```

将数据从文件重新加载到`A`. 只需省略`ftruncate`和 call的调用`memcpy(data, buf, bytes);`。

更好的方法是，如果您的数据很大，您只需将数据存储在一个文件中，用于`mmap`将其映射到内存地址，然后将地址传递给`multi_array_ref`. 在这种情况下，您不需要专门将其写入文件。它是由操作系统芳香地完成的。

上面的代码是为 Linux 考虑的，但我相信其他平台应该有类似的功能。为清楚起见，省略了错误检查。

# vim - vim 和 emacs 中的代码导航

> ID：13440613
> 
> 赞同：5
> 
> 时间：2012-11-18T13:32:50.477
> 
> 标签：vim, emacs, tags, cscope

我在 emacs 和 vim 中最怀念的 IDE 功能是代码导航和查找用法。这两个编辑器都具有以下相似的功能：

*   标签 - 来自指定文件的标识符被索引，当您按下作为标识符的单词上的快捷方式时，您将被导航到那里
*   CScope - 它允许您导航到标识符的“用法”

据我了解，这两个系统都非常不精确。如果我们有相同名称的相似标识符，则标签和范围可能会混淆它们。有没有更好的选择以及它们的精确度如何？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T13:56:01.987

我在 Emacs 中使用 cscope 和语义。这对我来说已经足够了。

在 cscope 中，我经常使用的两个函数是 cscope-find-global-definition 和 cscope-find-this-symbol。前面的函数非常精确。

```
C-c s s         Find symbol. 
C-c s d         Find global definition. 
```

至于语义（动态索引，不需要生成TAGS）。

```
(global-set-key [f8] 'semantic-ia-fast-jump) ;; jump to definition.
(global-set-key [S-f8]                       ;; jump back
                (lambda ()
                  (interactive)
                  (if (ring-empty-p (oref semantic-mru-bookmark-ring ring))
                     (error "Semantic Bookmark ring is currently empty"))
                  (let* ((ring (oref semantic-mru-bookmark-ring ring))
                         (alist (semantic-mrub-ring-to-assoc-list ring))
                         (first (cdr (car alist))))
                    (if (semantic-equivalent-tag-p (oref first tag)
                                                   (semantic-current-tag))
                        (setq first (cdr (car (cdr alist)))))
                    (semantic-mrub-switch-tags first)))) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-18T14:15:22.697

有许多程序可以输出与 ctags 兼容的`tags`文件。它们通常是特定于语言的，因为 ctags 中存在一些低级限制，但是当您有多个同名方法时，它们和 ctags 都不能帮助您，因为这些工具只完成索引部分的工作。搜索索引实际上是 Vim 的工作，*因为它是一个可怕的文本编辑器，而不是 IDE*，它以**零**平均值来决定哪个方法声明是正确的。

幸运的是，当有多个点击时，Vim 会显示一个可操作的列表。但这就是你能走多远。

Cscope 比 ctags 更智能一点，并且当在 Vim 中使用时，它可以进行搜索和索引。但是，和 ctags 一样，cscope*仍然是一个代码索引器。*

实际上可以同时使用两者，`set cscopetags`但这对您的命名问题没有帮助。

你可以试试 GNU Global。但它不支持 JavaScript，所以我从来没有真正使用它足够长的时间来发表意见。

IDE 通常通过在后台针对您的代码运行的特定于语言的解析器/静态分析工具来发挥作用。Vim 至少有一个限制和一个特性，这让你很难想象它会达到你想要的代码意识水平：

1.  Vim 不是多线程的。所以它不能在后台运行静态分析工具。

2.  Vim 支持数百种语言。对于任何规模的组织来说，为这么多语言提供这种功能是不可能的。

但这对我来说都不是问题，因为**Vim 不是 IDE。**

而且因为我的项目中没有多个同名的方法。

`<C-]>`, `<C-w>}`,`:tag /foo<Tab>`并且`:cs f c bar`足以满足我卑微的需求。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-18T13:43:04.833

[例如， GNU Global](https://www.gnu.org/software/global/)允许重复标识符，您可以选择需要的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-19T09:20:43.183

请参阅[eclim](http://eclim.org/)，它有一个非常有用的[emacs 界面](https://github.com/senny/emacs-eclim)，它支持与 Eclipse 相同级别的 java 代码导航。

Eclim 还支持 C/C++ 等，虽然在 emacs-eclim 中还没有实现对此的支持，但是如果你知道 Elisp，那么实现它是非常简单的，因为对于 java，所有必要的基础设施都已经存在，所以你只需要为 c++ 调用添加实现。

# ms-access - 无法引用失焦的表单控件

> ID：13440617
> 
> 赞同：1
> 
> 时间：2012-11-18T13:33:11.737
> 
> 标签：ms-access, textbox, focus, vba

[这是我之前](https://stackoverflow.com/questions/11986227/update-textbox-during-typing)询问的关于如何在输入时更新文本框的问题的后续。在我之前的问题中，我有三个文本框，其中两个已启用，一个未启用。它们看起来像这样：

![三个文本框图像](../Images/69c15e0f62494ab5b4a3cdcfc3ea8123.png)

我的目标是使用两个文本框的名字和姓氏在另一个文本框中填写“个人代码”。当我输入名字和姓氏时，我希望 Code Personal 文本框立即更新，格式为**LLLLLL_F**（例如：BERNAS_P）。但是，每当我尝试更新 Code Personal 文本框时，都会收到此错误：

![错误图片](../Images/8be068e5398d28c5dee4ecfe1af754db.png)

我用来创建代码个人格式和更新文本框的代码是：

```
Private Sub TxtFName_Change()

firstName = Me.TxtFName.Value
lastName = Me.txtLName.Value
firstPart = Left(lastName, 6)
secondPart = Left(firstName, 1)

nameCode = firstPart + "_" + secondPart
upperNameCode = UCase(nameCode)

txtCodePersonal.Text = upperNameCode 'My debug tells me I have an error here
End Sub 
```

我尝试通过: 将焦点设置到*txtCodePersonal*文本框`[txtCodePersonal].SetFocus`，但仍然收到错误消息（MS Access 无法将焦点移到控件*txtCodePersonal*。）

关于在输入其他两个文本框时如何更新“个人代码”文本框的任何想法？

提前感谢您的所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T14:07:36.853

`.Value`对文本框的属性而不是其属性进行赋值`.Text`。这些中的任何一个都应该起作用：

```
Me.txtCodePersonal.Value = upperNameCode
Me.txtCodePersonal = upperNameCode 
```

`.Value`是文本框的默认属性，因此您不需要显式包含它。如果您觉得它使代码更清晰，请包含它。

# java - J2ME PIM 单独获取联系人号码

> ID：13440621
> 
> 赞同：0
> 
> 时间：2012-11-18T13:33:33.127
> 
> 标签：java, java-me, jsr, pim

有没有办法可以使用 PIM API 读取联系人号码。我正在使用下面的代码，它只是返回名称。我希望代码仅从联系人返回号码。

```
pim = PIM.getInstance();
    ContactsList.setModel(new DefaultListModel());
    try {
        String[] pimListNames = pim.listPIMLists(PIM.CONTACT_LIST);
        for (int i = 0; i < pimListNames.length; ++i) {
            ContactList cl = (ContactList) pim.openPIMList(
                    PIM.CONTACT_LIST, PIM.READ_ONLY, pimListNames[i]);
            Enumeration items = cl.items();
            while (items.hasMoreElements()) {
                Contact c = (Contact) items.nextElement();
                ContactsList.addItem(c.getString(Contact.FORMATTED_NAME, 0));
            }
        }
    } catch (PIMException ex) {
        WittyClassObject.showAlert("error", ex.toString());
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T12:21:17.527

你试过用

```
c.getString(Contact.TEL, 0) // instead of c.getString(Contact.FORMATTED_NAME, 0) ? 
```

# javascript - iframe加载站点可以访问的参数

> ID：13440629
> 
> 赞同：0
> 
> 时间：2012-11-18T13:33:59.240
> 
> 标签：javascript, jquery, parameters

我正在尝试使用参数值并将这些值传递给带有 javascript 的 iframe 加载站点。这些网站可以有多种风格，所以我需要某种开关。我想使用参数，但由于某种原因，如果网站加载到 iframe 中，它就无法读取参数。

```
somesite.com?style=black 
```

那么这可能吗？

如果使用下面的代码从 url 获取值

```
 var urlParams = {};
    (function(){
        var match,
            pl     = /\+/g,  // Regex for replacing addition symbol with a space
            search = /([^&=]+)=?([^&]*)/g,
            decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
            query  = window.location.search.substring(1);

        while (match = search.exec(query))
           urlParams[decode(match[1])] = decode(match[2]);
    })(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T16:06:58.830

我在代码中有错字。为了解决我的问题，我不得不使用 top.window.location ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T16:15:31.790

这有什么问题？如果我`console.log(urlParams)`在 iframe 中，我会得到预期的`{ style : "black" }`. 您的 iframe 和嵌入页面是否托管在同一个域上？

# objective-c - 使用objective-c编译ansi c供应商库

> ID：13440643
> 
> 赞同：2
> 
> 时间：2012-11-18T13:35:24.213
> 
> 标签：objective-c, c, linker, ansi

我正在使用 ObjC 来构建我的应用程序的 ui，我的应用程序依赖于 ansi c 库，我有 ansi c 库的源代码。如何使用 Xcode 编译这个应用程序（为了开发，我可以将库安装到我的 Mac 中）。但是我想在没有任何外部依赖的情况下将我的应用程序发送给用户，就像任何其他应用程序一样，用户不需要安装依赖项，那么我该如何实现呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T05:20:50.230

If you have static library then add the same to your Xcode project and compile application. During linking phase library is linked with Application binary and hence no separate installation required for the library.

In case library is dynamic library then check the installation path. If the library installation directory is outside application bundle then you need to create installer to install library to installation directory. On the other hand if installation directory is relative to @excutable path then you can keep the library inside your application bundle and no installation required. You can use copy file phase to copy library into your application bundle.[Refer Apple documentation](https://developer.apple.com/library/mac/#documentation/developertools/conceptual/DynamicLibraries/100-Articles/UsingDynamicLibraries.html#//apple_ref/doc/uid/TP40002182-SW10)

# .htaccess - htaccess rewritecond 搜索结果

> ID：13440644
> 
> 赞同：0
> 
> 时间：2012-11-18T13:35:31.810
> 
> 标签：.htaccess, search, mod-rewrite

我的朋友。

拜托，我对 ReWriteCond 有疑问。我想创建友好的搜索结果。我只是用 ReWriteRule 来做，但我想做相反的路径。

这工作得很好： RewriteRule ^search/([^/]*)$ /index.php?p=search&query=$1 [L]

**但我想将 /index.php?p=search&query=$1 转换为搜索/查询**

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:58:28.667

从“丑陋”的搜索表单 GET 请求重定向到漂亮的 URL，如下所示：

```
RewriteEngine On
RewriteCond %{QUERY_STRING} ^p=search&query=(.*)$
RewriteRule ^index\.php$ /search/%1? [R=301,L] 
```

然后你必须确保“好”的 URL 会像这样到达你的脚本：

```
RewriteRule ^search/(.*)$ index.php?query=%1&p=search [L] 
```

注意参数的不同顺序/它可以防止无限循环

# c# - 将参数从一个方法传递到 button.click 的另一种方法

> ID：13440646
> 
> 赞同：3
> 
> 时间：2012-11-18T13:36:05.453
> 
> 标签：c#, winforms, parameters, parameter-passing

我有一个主按钮功能，我在其中解析文本框文本值，然后将这些值传递给另一个方法。执行第一次计算后，我想将这些参数传递给另一个按钮功能。

我想 从主按钮分配`int valueOF1, int valueOF2`给这个方法。`public void testfunction(object sender, EventArgs ea)`

我怎样才能做到这一点？？感谢您的帮助。

这是代码：

```
private void b_calculate_Click(object sender, EventArgs e)
    {

        int valueOF1;
        int.TryParse(t_Offset1.Text, NumberStyles.Any,
                     CultureInfo.InvariantCulture.NumberFormat, out valueOF1);

        int valueOF2;
        int.TryParse(t_Offset2.Text, NumberStyles.Any,
                     CultureInfo.InvariantCulture.NumberFormat, out valueOF2);

        int pRows = PrimaryRadGridView.Rows.Count;
        int sRows = SecondaryRadGridView.Rows.Count;

        if (pRows == 1 && sRows == 1)
        {
            calculatePS(valueOF1, valueOF2);
        }

}

private void calculatePS(int valueOF1, int valueOF2)
{
    MessageBox.Show("You are using : P-S");
    // Do some calculation & go to the next function ///
    Button2.Enabled = true;
    Button2.Click += testfunction; // Here i want to pass the valueOF1 & valueOF2

}

public void testfunction(object sender, EventArgs ea)
{
    MessageBox.Show("you...!");
    Button2.Enabled = false;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T13:43:15.960

在您的函数 calculatePS 中更改最后一行，如下所示

```
Button2.Click += new EventHandler(delegate 
{ 
  // within this delegate you can use your value0F1 and value0F2
  MessageBox.Show("you...!");
  Button2.Enabled = false;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T13:42:32.563

您可以将`valueOF1`和声明`valueOF2`为类字段，因此您可以从不同的方法访问它们。

代码如下所示：

```
int valueOF1 = 0;
int valueOF2 = 0;

private void b_calculate_Click(object sender, EventArgs e)
{
    int.TryParse(t_Offset1.Text, NumberStyles.Any,
                 CultureInfo.InvariantCulture.NumberFormat, out valueOF1);

    int.TryParse(t_Offset2.Text, NumberStyles.Any,
                 CultureInfo.InvariantCulture.NumberFormat, out valueOF2);

    int pRows = PrimaryRadGridView.Rows.Count;
    int sRows = SecondaryRadGridView.Rows.Count;

    if (pRows == 1 && sRows == 1)
    {
        calculatePS();
    }
}

private void calculatePS()
{
    // ** you can use valueOF1 and valueOF2 here **

    MessageBox.Show("You are using : P-S");
    // Do some calculation & go to the next function ///
    Button2.Enabled = true;

    //probably no need to register the Button2.Click event handler
    //except when the form is created
    //
    //Button2.Click += testfunction; 
}

public void testfunction(object sender, EventArgs ea)
{
    // ** you can use valueOF1 and valueOF2 here as well **

    MessageBox.Show("you...!");
    Button2.Enabled = false;
} 
```

***附加说明：** `int.TryParse`返回一个`bool`告诉您解析是否成功的值。如果返回是`false`，您可能希望以某种方式处理解析错误，而不是继续正常流程。*

# cordova - 在 JQuery Mobile 和 Phonegap 中使用快速按钮更改页面的动态列表

> ID：13440648
> 
> 赞同：1
> 
> 时间：2012-11-18T13:36:16.773
> 
> 标签：cordova, jquery-mobile, android-emulator

这是我在移动应用程序中尝试做的事情的简单描述。最终结果应该是一个页面，其中包含动态生成的（运动员）列表，并链接到显示点击运动员详细信息的页面。那是工作的部分，但点击速度很慢，所以我尝试从列表中的按钮中制作快速按钮。很高兴知道：我使用 phonegap 并在 Eclipse 中的 android 模拟器上进行测试。我有 2 个 html 页面（在一个文件中，作为建议的最佳实践）、包含列表的页面和包含详细信息的页面

```
<div data-role="page" id="page_athletes_list"  data-theme="a">
  <div data-role="header" data-position="fixed">
    <h1>My app</h1>
  </div>

  <div id = "content_athletes_list" data-role="content">
    <h2>Athletes Finder</h2>
      <ul id="ul_athletes_list" data-role="listview" data-divider-theme="b" data-inset="true">
        <li data-role="list-divider" data-role="heading">Name, Firstname</li>
      </ul>
  </div>

</div> 
```

详情页：

```
<div data-role="page" id="page_athlete_details"  data-theme="a">
    <div data-role="header" data-position="fixed">
        <h1>My app</h1>
    </div>
    <div id = "content_athletes_details" data-role="content">
        <h2 id = "name_athlete_details"></h2>
        <img id = "img_athlete_details" src=""></img>
        <div id = "birthday_athlete_details"></div>
    </div>
</div> 
```

javascript 我用户无需快速按钮即可动态创建列表。此列表需要在 pagecreate 上创建一次。注意：要更改页面，在锚点的 href 中硬编码页面链接，例如 href="#mypage?index=1" 会导致 phonegap 出现问题。首次创建详细信息后，它永远不会显示任何其他数据。为了绕过这一点，我将页面链接放在 data-url 属性中，我检索该属性并将其与 JQuery "$.mobile.changePage" 函数一起使用。

```
 /*
function create a list to the detail page with an index parameter. 
The index correspond to the the index of an array LIST_OF_ATHLETES where you can find the details information for all the athletes.
This array is used to fill the data in the details page.
*/
$('#page_athletes_list').live('pagecreate',function(){
    try {
        for (var i = 0; i < LIST_OF_ATHLETES.length; i ++){
                var athlete = LIST_OF_ATHLETES[i]; //LIST_OF_ATHLETES is an array that contains all the infos about the athletes. 
            $("#ul_athletes_list").append("<li data-theme='a'><a id='ul_athletes_list_item_" + i + "' data-url='#page_athlete_details?index=" + i + "' > " + athlete.lastname +", " + athlete.firstname + "</a></li>");     
        }
    }
    catch (error) { alert("page_athletes_list : " + error); }
});

    //change page on "touchend" event. Use the data-url attribute of the anchor.
    $("#content_athletes_list li a").live("touchend", function(){
    var dataUrl = $(this).attr("data-url");
    changePage(dataUrl);
});

function changePage(dataUrl) {
    var page = getParameterByName('#', dataUrl);

    $.mobile.changePage(page, {dataUrl: dataUrl});  
}

//get a parameter by name from a url (source).
function getParameterByName(name, source) {
    if(name == "#"){
        var indexStart=source.indexOf('#');
        var indexEnd = source.length-indexStart;
        var indexParam = source.indexOf("?");
        if(indexParam > indexStart){
            indexEnd = indexParam-indexStart;
        }
        return source.substring(indexStart, indexEnd);
    }
    else{
        var match = RegExp('[?&]' + name + '=([^&]*)').exec(source);
        return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
    }
} 
```

现在我尝试了许多不同的方法来在其中包含谷歌快速按钮，但似乎没有任何效果。您可以在此处找到快速按钮的代码：[https ://github.com/h5bp/mobile-boilerplate/blob/master/js/helper.js](https://github.com/h5bp/mobile-boilerplate/blob/master/js/helper.js)

我尝试的第一件事是在创建锚点后添加一个新的快速按钮。例子 ：

```
$("#ul_athletes_list").append("<li data-theme='a'><a id='ul_athletes_list_item_" + i + "'  > " + athlete.lastname +", " + athlete.firstname + "</a></li>"); 
new MBP.fastButton(document.getElementById('ul_athletes_list_item_' + i), function(){changePage("#page_athlete_details?index=" + i )}); 
```

当我这样做时，document.getElementById 找不到锚“ul_athletes_list_item_”+i。可能是因为它还没有在dom中。我改变了策略并尝试通过 javascript 列出元素，然后创建新创建的元素的按钮。

```
$('#page_athletes_list').live('pagecreate',function(){
    try {
        for (var i = 0; i < LIST_OF_ATHLETES.length; i ++){
            var athlete = LIST_OF_ATHLETES[i];
            var page = "#page_athlete_details?index=" + i ;
            var list = document.getElementById("ul_athletes_list");
            var li = document.createElement("li");
            var anchor = document.createElement("a");
            anchor.innerHTML = athlete.lastname +", " + athlete.firstname;
            new MBP.fastButton(anchor, function(){changePage(page)}); //the fastbutton on the current element of the list
            li.appendChild(anchor);
            list.appendChild(li);       
        }
    }
    catch (error) { alert("page_athletes_list : " + error); }
}); 
```

这行不通。所有按钮都重定向到“#page_athlete_details”，索引值等于数组 LIST_OF_ATHLETES 的最后一个元素。如果我的数组中有 6 个元素，则所有按钮都将重定向到 url“#page_athlete_details.index=5”。而不是索引= 0的第一个按钮，索引= 1的第二个按钮等...

所以最后，问题是，如果有人知道为什么这不起作用或有替代解决方案，我会很高兴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T03:19:15.853

MBP.fastButton 是异步的 - 回调函数`changePage(page)`直到循环完成后才会真正运行，此时 i 设置为 5。

为了在循环中可靠地使用回调，每次迭代都需要一个新的范围。我通常通过用递归函数替换它来使循环本身异步，但在这种情况下，循环体中的自执行函数可能更合适。

```
(function(page_local) {
    new MBP.fastButton(anchor, function(){changePage(page_local)}); 
})(page_global); 
```

我重命名了变量以阐明正在使用哪个变量，但在这种情况下，是否在不同的范围内使用相同的名称并不重要。

# python - qtableview 的垂直标题中的数据？

> ID：13440649
> 
> 赞同：0
> 
> 时间：2012-11-18T13:36:18.303
> 
> 标签：python, pyqt, qtableview

Tableview 使用 QSqlRelationalTableModel。如何从垂直标题的列中插入数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T21:53:47.550

最简单的方法是继承`QSqlRelationalTableModel`和覆盖`headerData`方法（负责显示标题的数据：

```
class MyModel(QtSql.QSqlRelationalTableModel):
    def headerData(self, section, orientation, role=QtCore.Qt.DisplayRole):
        if orientation == QtCore.Qt.Vertical:
            index = self.index(section, 0) # assuming ID is the first column
            return self.data(index, role)
        else:
            # return original headers for horizontal orientation
            return super(MyModel, self).headerData(section, orientation, role) 
```

然后用这个代替`QSqlRelationalTableModel`. 如果需要，您可以在with中隐藏该`ID`列（因为它会被复制）：`QTableView``setColumnHidden`

```
myTableView.setColumnHidden(0, True) # again assuming ID is the first column 
```

# foursquare - 如何在开发过程中获得foursquare托管场所的模拟API响应

> ID：13440651
> 
> 赞同：1
> 
> 时间：2012-11-18T13:36:28.983
> 
> 标签：foursquare

我正在尝试使用 Foursquare 上的[托管场所 API](https://developer.foursquare.com/docs/venues/managed)。由于我没有管理任何场所，因此调用`https://api.foursquare.com/v2/venues/managed`总是返回一个空的场所列表。

[其他答案](https://stackoverflow.com/questions/12785680/empty-list-of-managed-foursquare-venues)表明存在一个`/simulate/venues/managed`端点（API 文档中没有记录）。这个端点似乎存在，但也返回一个空列表。

是否有其他方法可以使用`managed venues`端点开发工具，或者我必须注册托管场所？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T18:52:55.973

使用您的用户 ID 和 OAuth 客户端 ID 向 api@foursquare.com 发送电子邮件。我们可以为您设置一个测试场所，您可以通过它来测试这些端点。

# python - 从 3d 数组中删除图像帧

> ID：13440654
> 
> 赞同：3
> 
> 时间：2012-11-18T13:36:47.803
> 
> 标签：python, image, numpy, matplotlib, dicom

我是一个新的 Python 用户，想做一些简单的图像处理。本质上，我将拥有一个动态医学图像——在不同时间点的一系列 2D 图像，我想将其存储为 3D 数组。由于扫描技术的性质，在某些成像帧期间可能会偶尔出现患者运动，从而使数据无法使用。我想删除这样的帧并重铸数组 - 新维度（n-1、256、256）。删除框架后，我想更新图像显示。实现这一目标的最佳方法是什么？这是我到目前为止的骨架代码：

```
import dicom
import numpy as np
import pylab 
from matplotlib.widgets import Slider, Button

ds = dicom.read_file("/home/moadeep/Dropbox/FS1.dcm")
#data = ds.pixel_array
data = np.random.rand(16,256,256)
nframes = data.shape[0]

ax = pylab.subplot(111)
pylab.subplots_adjust(left=0.25, bottom=0.25)

frame = 0
l = pylab.imshow(data[frame,:,:]) #shows 1024x256 imagge, i.e. 0th frame*

axcolor = 'lightgoldenrodyellow'
axframe = pylab.axes([0.35, 0.1, 0.5, 0.03], axisbg=axcolor)

#add slider to scroll image frames
sframe = Slider(axframe, 'Frame', 0, nframes, valinit=0,valfmt='%1d'+'/'+str(nframes))

ax_delete = pylab.axes([0.8,0.025,0.1,0.04], axisbg=axcolor)

#add slider to scroll image frames

#Delete button to delete frame from data set
bDelete = Button(ax_delete, 'Delete')

def update(val):
    frame = np.around(sframe.val)
    pylab.subplot(111)
    pylab.subplots_adjust(left=0.25, bottom=0.25)
    pylab.imshow(data[frame,:,:])

sframe.on_changed(update)

pylab.gray()
pylab.show() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T17:56:01.957

您的问题的简短答案是 use `numpy.delete`。例如

```
import numpy as np
data = np.arange(1000).reshape((10,10,10))

# Delete the third slice along the first axis 
# (note that you can delete multiple slices at once)
data = np.delete(data, [2], axis=0)

print data.shape 
```

但是，如果您要多次删除单个切片，这是一种糟糕的方法。

更长的答案是避免每次要删除切片时都这样做。

Numpy 数组在内存中必须是连续的。因此，这将每次制作一个新副本（并删除旧副本）。这将相对较慢，并且需要您有两倍的可用内存空间来存储数组。

在您的情况下，为什么不存储二维数组的 python 列表？这样你就可以毫无问题地弹出你不想要的切片。如果您之后需要它作为 3D 数组，只需使用`numpy.dstack`它来创建它。

当然，如果您需要进行 3D 处理，则需要 3D 数组。因此，另一种方法是存储“坏”索引列表并在最后使用删除它们`numpy.delete`（请注意，要删除的项目是一个列表，因此您可以传入“坏”索引列表）。

* * *

附带说明一下，您更新图像的方式将非常缓慢。

您正在创建大量图像，因此每次都会重新绘制每个图像，并且随着您的继续，更新将变得非常缓慢。

您最好设置图像的数据 ( `im.set_data(next_slice)`) 而不是每次都创建一个新图像。

更好的是，使用 blitting，但对于 matplotlib 中的图像数据，由于 matplotlib 对图像的缓慢重新缩放，它不如其他类型的绘图那么有利。

举个简单的例子：

```
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.widgets import Slider

def main():
    # Set up 3D coordinates from -10 to 10 over a 200x100x100 "open" grid
    x, y, z = np.ogrid[-10:10:200j, -10:10:100j, -10:10:100j]

    # Generate a cube of interesting data
    data= np.sin(x*y*z) / (x*y*z)

    # Visualize it
    viewer = VolumeViewer(data)
    viewer.show()

class VolumeViewer(object):
    def __init__(self, data):
        self.data = data
        self.nframes = self.data.shape[0]

        # Setup the axes.
        self.fig, self.ax = plt.subplots()
        self.slider_ax = self.fig.add_axes([0.2, 0.03, 0.65, 0.03])

        # Make the slider
        self.slider = Slider(self.slider_ax, 'Frame', 1, self.nframes, 
                            valinit=1, valfmt='%1d/{}'.format(self.nframes))
        self.slider.on_changed(self.update)

        # Plot the first slice of the image
        self.im = self.ax.imshow(data[0,:,:])

    def update(self, value):
        frame = int(np.round(value - 1))

        # Update the image data
        dat = self.data[frame,:,:]
        self.im.set_data(dat)

        # Reset the image scaling bounds (this may not be necessary for you)
        self.im.set_clim([dat.min(), dat.max()])

        # Redraw the plot
        self.fig.canvas.draw()

    def show(self):
        plt.show()

if __name__ == '__main__':
    main() 
```

# javascript - slideDown 上 IE 的“对象不支持此属性或方法”

> ID：13440655
> 
> 赞同：0
> 
> 时间：2012-11-18T13:36:52.860
> 
> 标签：javascript, jquery, internet-explorer

这似乎是一个常见问题，我不知道如何解决。

所以，我有一堆`<div>`'s，我出于某种原因决定将其 id 存储在定义为的数组中

```
buttons = ["news", "info", "prog", "evnt"]; 
```

因此，我用来将它们向下滑动的方法之一如下：

```
for (var i in buttons) $("#" + buttons[i]).slideDown (); 
```

我也在代码中使用它：

```
for (var i in buttons)
   $("#" + buttons[i]).css ({display: "block"}); 
```

如果按钮不可见，则两者都不起作用（在 IE 7 和 8 上），在这些块之后，我会得到通常的“对象不支持此属性或方法”。有任何想法吗？

我还收到一个关于 jQuery 的奇怪的“无法识别的表达式”错误，这让我很困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:45:50.400

几件小事：

*   1 - 你总是可以**附加**在选择器上

    `$("#news, #info, #prog, #evnt").slideDown();`

*   2 - 始终使用**顺序`for`循环**

    `for (var i = 0; i < buttons.length; i++) { // do something }`

*   3 - 隐藏时，如果您使用 jQuery，**为什么不[`hide`](http://api.jquery.com/hide/)**呢？

    `for (var i = 0; i < buttons.length; i++) { $("#" + buttons[i]).hide(); }`

# sql - 将代码组合在一个匿名块中

> ID：13440656
> 
> 赞同：0
> 
> 时间：2012-11-18T13:36:58.440
> 
> 标签：sql, oracle

我需要一些帮助来将我的三个代码组合在一个匿名块中，并且我需要放置一个用户将使用的替换值。知道我该怎么做吗？我正在使用 oracle 10g express，这是我的代码：

代码 1：显示“美洲”中每个部门的部门名称和每个部门的员工人数。

```
select department_name, count(employee_id) "number of employees"
from employees, departments, locations, countries, regions
where employees.DEPARTMENT_ID = departments.DEPARTMENT_ID 
AND departments.location_ID = locations.location_ID 
AND locations.country_ID = countries.country_ID 
AND countries.region_ID = regions.region_ID 
AND regions.region_name = 'Americas'
group by department_name 
```

* * *

代码 2：每个职位的平均工资是多少？

```
SELECT job_ID, AVG(salary) as "avg salary"
FROM employees
GROUP BY job_ID 
```

* * *

代码3：每个部门的平均工资是多少？

```
SELECT department_ID, AVG(salary) as "avg salary"
FROM employees
GROUP BY department_ID 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:16:11.137

在 Oracle 中不可能将完全不同的数据集组合成一个块。匿名块用于执行一系列 PL/SQL 命令。一个查询（即任何返回结果集的查询，例如：）`SELECT ...`只能返回一个结果，因此它需要是三个单独的查询。

如果您正在使用`SQL*Plus`所有这些，则可以从命令行和/或使用`.sql`脚本文件来完成。您也可以在命令行上指定参数（我不知道这是否是您对第一个查询的意思，但我还是添加了它）。

# 脚本（`foo.sql`）：

```
-- Set page size to something larger than the expected result set.
-- NOTE: You don't want to put 0 (unlimited) as it supresses the column headers.
SET pagesize 50000

-- Get the parameter from the command line:
VAR region VARCHAR2(256)
EXEC :region := '&1'

SELECT 'Processing for region: ' || :region
FROM dual;

-- Query 1
promp "Employee detail in specified region:"
select department_name, count(employee_id) "number of employees"
from HR.employees, HR.departments, HR.locations, HR.countries, HR.regions
where employees.DEPARTMENT_ID = departments.DEPARTMENT_ID
AND departments.location_ID = locations.location_ID
AND locations.country_ID = countries.country_ID
AND countries.region_ID = regions.region_ID
AND regions.region_name = :region
group by department_name
;

-- Query 2:
promp "Average salary by position:"
SELECT job_ID, AVG(salary) as "avg salary"
FROM HR.employees
GROUP BY job_ID;

-- Query 3:
promp "Average salaries by department:"
SELECT department_ID, AVG(salary) as "avg salary"
FROM HR.employees
GROUP BY department_ID;

exit 
```

# 输出：

```
$ sqlplus myuser/mypass@lvm01xe @sample.sql Americas

SQL*Plus: Release 11.2.0.2.0 Production on Sun Nov 18 09:11:11 2012

Copyright (c) 1982, 2010, Oracle.  All rights reserved.

Connected to:
Oracle Database 10g Express Edition Release 10.2.0.1.0 - Production

PL/SQL procedure successfully completed.

'PROCESSINGFORREGION:'||:REGION
--------------------------------------------------------------------------------
Processing for region: Americas

"Employee detail in specified region:"

DEPARTMENT_NAME                number of employees
------------------------------ -------------------
Administration                                   1
Accounting                                       2
IT                                               5
Purchasing                                       6
Executive                                        3
Shipping                                        45
Finance                                          6
Marketing                                        2

8 rows selected.

"Average salary by position:"

JOB_ID     avg salary
---------- ----------
IT_PROG          5760
AC_MGR          12000
AC_ACCOUNT       8300
ST_MAN           7280
PU_MAN          11000
AD_ASST          4400
AD_VP           17000
SH_CLERK         3215
FI_ACCOUNT       7920
FI_MGR          12000
PU_CLERK         2780
SA_MAN          12200
MK_MAN          13000
PR_REP          10000
AD_PRES         24000
SA_REP           8350
MK_REP           6000
ST_CLERK         2785
HR_REP           6500

19 rows selected.

"Average salaries by department:"

DEPARTMENT_ID avg salary
------------- ----------
          100       8600
           30       4150
                    7000
           90 19333.3333
           20       9500
           70      10000
          110      10150
           50 3475.55556
           80 8955.88235
           40       6500
           60       5760
           10       4400

12 rows selected.

Disconnected from Oracle Database 10g Express Edition Release 10.2.0.1.0 - Production 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T22:12:41.017

显然，任何以相同标准聚合的东西都*可以*很容易地组合起来。因此，您可以像这样将第三个查询与第一个查询合并：

```
select department_name
       , count(employee_id) as "number of employees"
       , avg(salary) as "avg salary"
from employees, departments, locations, countries, regions
where employees.DEPARTMENT_ID = departments.DEPARTMENT_ID 
AND departments.location_ID = locations.location_ID 
AND locations.country_ID = countries.country_ID 
AND countries.region_ID = regions.region_ID 
AND regions.region_name = :region_name
group by department_name 
```

我已调整您的代码以传入绑定变量`:region_name`. 在 Apex 中有多种指定变量的方法。 [了解更多](http://www.talkapex.com/2011/01/variables-in-apex.html)。

没有任何有意义的方法可以包含您的第二个查询。JOB_ID 的值与 DEPARTMENT_ID 的值交叉，因此没有可加入的公共键。

# php - 保护 php 代理？

> ID：13440663
> 
> 赞同：1
> 
> 时间：2012-11-18T13:38:20.383
> 
> 标签：php, hash, proxy, md5

因此，在我的网站 (https://example.com) 上，我有一个页面可以解析 last.fm API 并从他们的 akamai CDN 中提取图像并将它们显示在页面上。

问题是所有图像都仅在 HTTP 上提供，不支持 https。

例如：[http ://userserve-ak.last.fm/serve/64s/76030502.png](http://userserve-ak.last.fm/serve/64s/76030502.png)

我有一个用 php 编写的图像代理：

```
<?php
header('Content-Type: image/png');
if(isset($_GET['img'])){echo file_get_contents($_GET['img']);}
?> 
```

这完美地工作，但是，根本不安全，我想要它，以便只有我的服务器可以使用图像代理，因此 URL 中的哈希可能是最好的选择？

`https://example.com/proxy.php?url=http://last.fm/image.jpg&hash=hashhere`

我曾想过使用：

```
md5($_GET['img']."privatekeyhere"); 
```

然后我的问题转向了，如何在全世界都无法访问的情况下将私钥放入 javascript 代码中？

非常感谢任何帮助。

* * *

从那以后，我编写了这个脚本，它有点有效，但仍然可以被规避：

```
<?php
$args = $_GET['q'];
$date = date('m-d-Y-h-i', time());

list($hash,$img,$auth) = explode("/", $args);

if($hash=="need" && $auth=="key"){
    $checksum = md5($img.$date);
    echo $checksum;
}

if($hash==md5($img.$date))
{
    header('Content-Type: image/png');
    echo file_get_contents('http://userserve-ak.last.fm/serve/64s/' . $img);
}
?> 
```

这可以这样调用：`https://www.mylesgray.com/lastfm/need/76030502.png/key`

然后可以插入身份验证代码以显示图像：`https://www.mylesgray.com/lastfm/{code-here}/76030502.png`

然而，很快就会有人发现他们可以设置一个脚本来每分钟轮询一个密钥——有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:43:38.293

生成唯一令牌。你在正确的轨道上使用哈希，但如果你保持你的私钥不变，它最终会被暴力破解。从那里，彩虹桌打招呼。

您实际上将不得不从用于防止 CSRF 滥用的机制中借用一两片叶子，因为您实际上是在尝试做同样的事情：将用户限制为每个令牌一个查询，并且令牌无法通过以下方式重新生成他们。

有很多方法可以做到这一点，通常的权衡是在效率和安全性之间。最简单的是您所建议的 - 这很容易暴力破解。在频谱的另一端是 DB 方法 - 每次访问生成一个唯一令牌，将其存储在 DB 中，并针对此验证后续调用。它是数据库密集型的，但效果相对较好 - 除非令牌生成很弱，否则几乎不可能破解。

# java - 如何在 android 客户端和自定义 java 服务器之间使用 SSL 套接字

> ID：13440664
> 
> 赞同：0
> 
> 时间：2012-11-18T13:38:22.787
> 
> 标签：java, android, security, ssl

我正在尝试编写一个通过安全连接（SSL / TLS）与java PC服务器通信的android应用程序，我已经阅读了几个教程并遵循了它们，以下代码在PC到PC上使用时有效，但是当我是客户端时android (3.2) 设备上的代码在 SSL 或 TLS 握手上停滞。以下是客户端通信代码：

```
public class ClientCommunicationManager implements Runnable{
    /**
     * Application context
    */
    private Context context;
    /**
     * Host string
    */
    private String host;
    /**
    * port number
    */
    private int port;
      /**
       * Report Recieved Listeners vector
       */
      private Vector<ReportRecievedListener> rrListeners;
      /**
       * Connection to the client
       */
      private DataInputStream din;

      /**
       * Connection to the client
       */
      private DataOutputStream dout;

      /**
       * KeyStore for storing our public/private key pair
       */
      private KeyStore clientKeyStore;

      /**
       * KeyStore for storing the server's public key
       */
      private KeyStore serverKeyStore;

      /**
       * Used to generate a SocketFactory
       */
      private SSLContext sslContext;

      /**
       * A list of visible postings
       */
      private Set postings = new HashSet();

      /**
       * Passphrase for accessing our authentication keystore
       */
      static private final String passphrase = "a1n2d3r4o5i6d";

      /**
       * A source of secure random numbers
       */
      static private SecureRandom secureRandom;

      public ClientCommunicationManager( String host, int port,Context context ) {
          this.context = context;
          this.host = host;
          this.port = port;

          rrListeners = new Vector<ReportRecievedListener>();

          secureRandom = new SecureRandom();
          secureRandom.nextInt();      

      }

      public void registerRRListener(ReportRecievedListener listener){
          rrListeners.add(listener);
      }

      private void setupServerKeystore() throws GeneralSecurityException, IOException {
        serverKeyStore = KeyStore.getInstance( "BKS" );

        serverKeyStore.load( context.getResources().openRawResource(R.raw.serverbks), 
                            "public".toCharArray() );
      }

      private void setupClientKeyStore() throws GeneralSecurityException, IOException {
        clientKeyStore = KeyStore.getInstance( "BKS" );
        clientKeyStore.load( context.getResources().openRawResource(R.raw.clientbks),
                           passphrase.toCharArray() );
      }

      private void setupSSLContext() throws GeneralSecurityException, IOException {
        TrustManagerFactory tmf =       TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
        tmf.init( serverKeyStore );

        KeyManagerFactory kmf =     KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
        kmf.init( clientKeyStore, passphrase.toCharArray() );

        sslContext = SSLContext.getInstance( "SSL" );
        sslContext.init( kmf.getKeyManagers(),
                         tmf.getTrustManagers(),
                         secureRandom );
      }

      public void connect() {
         new Thread(new Runnable() {

            public void run() {
                try {
                    setupServerKeystore();
                    setupClientKeyStore();
                    setupSSLContext();
                } catch (GeneralSecurityException e1) {
                    // TODO Auto-generated catch block
                    e1.printStackTrace();
                } catch (IOException e1) {
                    // TODO Auto-generated catch block
                    e1.printStackTrace();
                }

               SSLSocketFactory sf = sslContext.getSocketFactory();

               SSLSocket socket= null;
               InputStream in = null;
               OutputStream out = null;

            try {
                 socket = (SSLSocket)sf.createSocket( host, port );
                 socket.setUseClientMode(true); 

                 socket.startHandshake();

                 in = socket.getInputStream();
                 out = socket.getOutputStream();
            } catch (UnknownHostException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

               din = new DataInputStream( in );
               dout = new DataOutputStream( out );

               if(socket!=null)
                  new Thread( this ).start();

            }
        }).start();

      }

      public void run() {
          boolean isConnected = true;
        try {
          while (isConnected) {
            String msg = din.readUTF();
            if(msg.equals("END"))
                isConnected = false;
            else
                fireReportRecievedEvent(new ReportRecievedEvent(msg));

          }
        } catch( IOException ie ) {
          ie.printStackTrace();
        }
      }

     private void fireReportRecievedEvent(ReportRecievedEvent event){
         for(ReportRecievedListener listener : rrListeners){
             listener.onReportRecieved(event);
         }
     }

} 
```

以下是服务器代码：

```
public class CommunicationManager implements Runnable{

  private int port = Constants.SERVER_PORT;
  private HashSet<ConnectionProcessor> connections = new     HashSet<ConnectionProcessor>();
  private KeyStore clientKeyStore;
  private KeyStore serverKeyStore;
  private SSLContext sslContext;
  static private SecureRandom secureRandom;
  private boolean running;
  private SSLServerSocket ss=null;

  private static CommunicationManager instance=null;

private CommunicationManager(){

}

public static CommunicationManager getInstance(){
    if(instance == null){
        instance = new CommunicationManager();
    }

    return instance;
}

public int getSecureRandom(){
    SecureRandom securerandom = new SecureRandom();
    return securerandom.nextInt();

}

public boolean isRunning() {
    return running;
}

public void setRunning(boolean running) {
    this.running = running;
}

public void startServer(){
    if(!isRunning()){
        setRunning(true);
        new Thread(this).start();
    }

}

public void stopServer(){
    setRunning(false);
    for(ConnectionProcessor cp : connections){
        cp.close();
    }

    try {
        if(ss!=null)
            ss.close();
    } catch (IOException e) {

        e.printStackTrace();
    }

}

private void setupClientKeyStore() throws GeneralSecurityException, IOException {
    clientKeyStore = KeyStore.getInstance( "JKS" );
    clientKeyStore.load( new FileInputStream( "resources/client.public" ),
                       "public".toCharArray() );
  }

  private void setupServerKeystore() throws GeneralSecurityException, IOException {
    serverKeyStore = KeyStore.getInstance( "JKS" );
    serverKeyStore.load( new FileInputStream( "resources/server.private" ),
                        Constants.SERVER_KEYSTORE_PWD.toCharArray() );
  }

  private void setupSSLContext() throws GeneralSecurityException, IOException {
    TrustManagerFactory tmf = TrustManagerFactory.getInstance( TrustManagerFactory.getDefaultAlgorithm() );
    tmf.init( clientKeyStore );

    KeyManagerFactory kmf = KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm() );
    kmf.init( serverKeyStore, Constants.SERVER_KEYSTORE_PWD.toCharArray() );

    sslContext = SSLContext.getInstance( "TLS" );
    sslContext.init( kmf.getKeyManagers(),
                     tmf.getTrustManagers(),
                     secureRandom );
  }

  @Override
  public void run() {

      try {
          setupClientKeyStore();
          setupServerKeystore();  
          setupSSLContext();
    } catch (GeneralSecurityException | IOException e) {
        e.printStackTrace();
    }

      SSLServerSocketFactory sf = sslContext.getServerSocketFactory();

      try {
        ss = (SSLServerSocket)sf.createServerSocket( port );
    } catch (IOException e) {

        e.printStackTrace();
    }

      // Require client authorization
      ss.setNeedClientAuth( true );

      System.out.println( "Listening on port "+port+"..." );
      while (isRunning()) {
        Socket socket=null;
        try {
            socket = ss.accept();
        } catch (IOException e) {

            if(e.getClass() == SocketException.class){
                System.out.print("accept() threw SocketException because of close\n");
            }
        }
        if(socket!=null && socket.isConnected()){
            System.out.println( "Got connection from "+socket );

            ConnectionProcessor cp = new ConnectionProcessor( this, socket );
            connections.add( cp );
        }

      }

     closeServer();
  }

  private void closeServer() {
    for(ConnectionProcessor cp : connections){
        cp.close();
    }

    try {
        ss.close();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

}

/**
   * Remove a connection that has been closed from our set
   * of open connections
   */
  public void removeConnection( ConnectionProcessor cp ) {
    connections.remove( cp );
  }

  /**
   * Return an iteration over open connections
   */
  public Iterator getConnections() {
    return connections.iterator();
  }
  /**
   * Broadcast a report over all connections
   */
  public void broadcastReport(String report){
      for(ConnectionProcessor cp : connections){
          cp.send(report);
      }
  }
  /**
   * Broadcast a report over all connections using a new thread
   */

public void broadcastOnThread(final String report) {
    Thread t = new Thread(new Runnable() {

        @Override
        public void run() {
            if(isRunning())
                broadcastReport(report);    

        }
    }) ;

    t.start();
}

 /**
   * recieve a new report to be broadcasted
   */
public void acceptReport(String report_string) {
    broadcastOnThread(report_string);

}

} 
```

任何帮助或见解将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T01:15:56.067

问题是（尚未）交换数据，因此握手从未完成。

# java - 一个 BufferedImage 上的多个渐变

> ID：13440668
> 
> 赞同：1
> 
> 时间：2012-11-18T13:38:54.277
> 
> 标签：java, gradient, java-2d, slick2d

我正在使用 RadialGradientPaint 创建一个 cricle 渐变，将它放在一个 BufferedImage 上并将图像渲染到我的 2d 游戏屏幕上，从而创建一个很好的暗光效果。但是，我想创建更多光源，但是为每个灯创建和渲染一个新的 BufferedImage 并不能完成这项工作（通常只看到最后一个灯，其他所有灯都是黑色的）。是否可以将一些 RadialGradientPaint 烘焙到一个 BufferedImage 中或以其他方式实现多灯效果？

附上你可以找到一盏灯的样子的图像。它是一个黑色的 BufferedImage，在屏幕顶部应用了 RadialGradientPaint。我想以某种方式添加更多这些。

![单灯](../Images/6157f6096308739babf3daa08797c0e8.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T12:11:02.590

这个问题的解决方案是使用这个（正如@JanDvorak 评论中指出的那样：[合并两个图像](https://stackoverflow.com/questions/2318020/merging-two-images)

我使用的确切代码是这样的：

```
public static BufferedImage mergeImages2(BufferedImage base, Collection<Light> images) {
    BufferedImage output = new BufferedImage(base.getWidth(), base.getHeight(), BufferedImage.TYPE_INT_ARGB);

    Graphics2D g = output.createGraphics();
    g.drawImage(base, 0, 0, null);
    g.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_IN, 1.0f));
    for (Light l : images) {
        g.drawImage(l.LIGHT_IMAGE, l.x, l.y, null);
        l.LIGHT_IMAGE.flush();
    }
    g.dispose();
    output.flush();
    return output;
} 
```

注意：这解决了问题，但会产生内存泄漏，我已经描述过希望在这里得到一些帮助：[BufferedImage.createGraphics() memory leak](https://stackoverflow.com/questions/13528788/bufferedimage-creategraphics-memory-leak)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T17:38:41.933

另一种方法是通过两次不同的方式混合您的图像。第一次通过，您只需在黑色矩形上添加多个辐射点，来自 White-Green-Transparency。

然后，在同一点，您从第 1 步中挖掘出您的第一张图像，并进行了 XOR 混合。

结果：

[http://img11.imageshack.us/img11/7066/step3yr.png](http://img11.imageshack.us/img11/7066/step3yr.png)

编码：

```
public void creerLightMap(){
        lightMap = new BufferedImage(this.getWidth(), this.getHeight(), BufferedImage.TYPE_INT_ARGB);
        Graphics2D g = lightMap.createGraphics();
         g.setColor(Color.BLACK);
         g.fillRect(0, 0, this.getWidth(), this.getHeight());
         float radius = 100;
         //create color circle
         for(int i=0; i<lumiere.size(); i++){
            Point2D center = lumiere.get(i);
            float[] dist = {0.0f, 0.5f, 1.0f};
            Color[] colors = {new Color( 1.0f , 1.0f , 1.0f , 1.0f), new Color( 0.0f , 1.0f , 0.0f , 0.5f) , new Color( 0.0f , 1.0f , 0.0f , 0.0f)};
            RadialGradientPaint p = new RadialGradientPaint(center, radius, dist, colors);
            g.setPaint(p);
            g.fillRect(0, 0, this.getWidth(), this.getHeight());
        }

         //add an alpha into theses same circle
         for(int i=0; i<lumiere.size(); i++){
            Point2D center = lumiere.get(i);
            float[] dist = {0.0f, 1.0f};
            Color[] colors = {new Color( 1.0f , 1.0f , 1.0f , 1.0f) , new Color( 1.0f , 1.0f , 1.0f , 0.0f)};
            RadialGradientPaint p = new RadialGradientPaint(center, radius, dist, colors);
            g.setComposite(AlphaComposite.getInstance(AlphaComposite.XOR, 1.0f));
            g.setPaint(p);
            g.fillRect(0, 0, this.getWidth(), this.getHeight());
         }
         g.dispose();
    }

    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g);

        Graphics2D g2d = (Graphics2D)g;
        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                RenderingHints.VALUE_ANTIALIAS_ON);
        g2d.drawImage(this.lightMap, 0, 0, null);
    } 
```

# c++ - 在函数内部，调用它的重载版本

> ID：13440670
> 
> 赞同：1
> 
> 时间：2012-11-18T13:39:00.593
> 
> 标签：c++, class, overloading

我想知道一件事。我有一个有 1 个重载成员函数的类：

```
class A{
    public:
    class const_iterator{};
    class iterator : public const_iterator{};
    iterator find(const K &key);
    const_iterator find(const K &key) const;
}; 
```

广告。iterator 继承自 const_iterator，但它没有添加任何内容。

我想做的是，在正常的 find 调用 const find 中。像这样的东西：

```
typename A::iterator A::find(const K &key){
     const_iterator it(find(key));
     return (*(iterator*)&it);
} 
```

我不需要非常量查找 ATM 的不同实现。有可能做这样的事情吗？因为现在我进入了无限循环，在 find 之前添加“A::”并没有改变任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:40:19.910

```
const_cast<const A*>(this)->find(key); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T13:41:10.767

不幸的是，总的来说，对此没有干净的解决方案。

您*可以*`find`通过简单地转换`this`为来调用重载`A const*`- 但结果将是错误的类型（`const_iterator`而不是`iterator`），并且在一般情况下可能不会在这些之间进行转换（`(*(iterator*)&it)`在您的情况下您不会工作）。

但是，当然，在您的特殊情况下，由于您定义了这两个类，您可以通过添加适当的构造函数来*定义*`iterator`这样的转换：

```
class iterator : public const_iterator {
    iterator(const_iterator const& other) { 
        // Construct …
    }
}; 
```

然后你可以重写你的非`const` `find`实现如下：

```
A::iterator A::find(const int &key){
    const_iterator it(const_cast<A const*>(this)->find(key));
    return static_cast<iterator>(it);
} 
```

顺便说一句，请注意`typename`返回类型中没有。由于`A::iterator`不是从属名称，因此您不需要（并且至少在 C++03 中不允许）`typename`在此处使用。

# java - 替换所有特殊字符

> ID：13440672
> 
> 赞同：1
> 
> 时间：2012-11-18T13:39:03.877
> 
> 标签：java, string, replace

我有一个看起来像这样的字符串：

```
<a href=\"test\" /> 
```

我想替换`/"`to `"`，使它看起来像这样`<a href="test" />`。

因此我正在使用这段代码：

```
content = content.replaceAll("\\\"", "\""); 
```

由于某种原因，它没有找到`\"`. 所以不会被替换。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T13:45:05.837

试试这个代码：`string.replaceAll(Pattern.quote("\\\""), "\"");`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T13:40:30.653

`replaceAll`需要一个正则表达式。因此，您必须像这样逃脱逃脱：

```
s = s.replaceAll("\\\\\"", "\""); 
```

# jquery - 在 jQuery 中创建新元素时保留拖动选项

> ID：13440675
> 
> 赞同：0
> 
> 时间：2012-11-18T13:39:18.027
> 
> 标签：jquery, jquery-ui, jquery-ui-draggable, jquery-ui-resizable

我正在 jQuery 中创建一个带有可拖动可调整大小插件的小应用程序。

我的问题是，当我通过 jQuery 创建一个新元素时，它不会让我的可拖动设置保持可调整大小。

你能帮我解决这个问题吗？

这是我的代码：http: [//jsfiddle.net/ewYwC/1/](http://jsfiddle.net/ewYwC/1/)

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Untitled Document</title>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.1/themes/base/jquery-ui.css" />
<script src="http://code.jquery.com/jquery-1.8.2.js"></script>
<script src="http://code.jquery.com/ui/1.9.1/jquery-ui.js"></script>
<style>
body { margin:0px; padding:0px; border:0px; font-family:Arial, Helvetica, sans-serif; }

#PageOptions { width:240px; height:100%; border-right:1px solid #E5E5E5; margin:0px; padding:5px; background:#FFF8E7; position:absolute; }

#PageContainer { width:986px; height:676px; border:3px solid #CCC; margin:10px 10px 10px 265px; background:#F1F1F1; position:absolute; }
#AdContainer { width:460px; height:670px; border:1px dashed #666; margin:0px; position:absolute; background:#FFF; }
.ui-widget-content { width:150px; height:150px; z-index:0; }
.handle { cursor: move; background-color:#CCC; padding:0px; margin:0px; }
.ui-resizable-helper { border: 1px dotted #900; }

#ObjList {width:100%; height:80px; border-bottom:1px solid #E5E5E5; display:block; background:#F1F1F1; }
ul, li { margin:0px; padding:0px; list-style-image:none; }
li { width:50px; height:50px; border:1px solid #CCC; display:inline-block; background:#F0E8BB; margin:5px; padding:5px; overflow:hidden; font-size:12px;  border-radius: 10px; }
</style>
<script>
$(function() {

    $("#adSize").text("Taille de la publicité: " + $("#AdContainer").width() + "x" + $("#AdContainer").height());

    $(".ui-widget-content")
        .draggable({
            containment: "#AdContainer",
            scroll: false,
            // grid: [5, 5],
            handle: ".handle",
            snap: true,
            stack: "div",
            drag: function(event, ui) {
                var objId = $(this).attr("id");
                var objPos = $(this).position();
                $("#objName").text("Comportement: " + objId);
                $("#objTopPos").text("Marge à gauche:  " + objPos.left + "px");
                $("#objLeftPos").text("Marge en haut: " + objPos.top + "px");
            }
    })

        .resizable({
            animate: true,
            containment: "#AdContainer",
            resize: function(event, ui) {
                var objWidth = ui.size.width;
                var objHeight = ui.size.height;
                $("#objWidthSize").text("Largeur: " + objWidth + "px");
                $("#objHeightSize").text("Hauteur: " + objHeight + "px");
            },
            minHeight: 100,
            minWidth: 100,
    })

    $(".deleteObj").click(function () {
        $(this).parents('.ui-widget-content').remove();
    })

    // Obj creation
    $(".createObjImage").click(function () {
        var newObjImage = $('<div id="Image" class="ui-widget-content"><p class="handle"><span class="deleteObj">[x]</span> Image</p></div>').draggable().resizable();
        $("#AdContainer").append(newObjImage);
    })

});
</script>
</head>

<body> 
    <div id="ObjList">
        <ul>
            <li class="createObjImage">Image</li>
            <li class="createObjAccordeon">Accordeon</li>
            <li class="createObjSwipe">Swipe</li>
            <li class="createObjVideo">Video</li>
            <li class="createObjFlip">Flip</li>
            <li class="createObjSlider">Slider</li>
        </ul>
    </div>

    <div id="PageOptions">
        <span id="adSize"></span><br />
        ----------<br />
        <span id="objName"></span><br />
        <span id="objTopPos"></span><br />
        <span id="objLeftPos"></span><br />
        <span id="objWidthSize"></span><br />
        <span id="objHeightSize"></span>
    </div>

    <div id="PageContainer">
        <div id="AdContainer">
            <div id="Accordeon" class="ui-widget-content">
                <p class="handle"><span class="deleteObj">[x]</span> Accordeon</p>
            </div>
            <div id="Flip" class="ui-widget-content">
                <p class="handle"><span class="deleteObj">[x]</span> Flip</p>
            </div>
            <div id="Swipe" class="ui-widget-content">
                <p class="handle"><span class="deleteObj">[x]</span> Swipe</p>
            </div>
        </div>
    </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:53:52.750

这里的问题是，您只为最初存在的元素使用自定义选项初始化插件。您添加的动态元素不会使用您的自定义选项和事件处理程序进行初始化，您只需`.draggable()`使用可拖动插件的默认选项即可。您应该将设置保存到变量并将它们传递给您初始化的任何需要这些选项的可拖动对象：

```
var draggableOptions = {
  // your custom options go here
}

$('element').draggable(draggableOptions); 
```

这是一个基于您的代码的缓存自定义可拖动选项的工作示例：http: [//jsfiddle.net/XdFsg/](http://jsfiddle.net/XdFsg/)。可调整大小也是如此。

# facebook - og：描述警告

> ID：13440677
> 
> 赞同：0
> 
> 时间：2012-11-18T13:39:30.463
> 
> 标签：facebook, facebook-opengraph, tumblr

我刚刚尝试通过 OpenGraph API将我的[编程笑话博客连接到 Facebook。](http://thejoysofcode.tumblr.com)但是，当我使用开发人员调试工具进行检查时，它会发出警告：

```
Objects of this type do not allow properties named 'fb:description' 
```

和

```
The parser's result for this metadata did not match the input metadata. Likely, this was caused by the data being ordered in an unexpected way, multiple values being given for a property only expecting a single value, or property values for a given property being mismatched. Here are the input properties that were not seen in the parsed result: 'fb:description' 
```

如果我反向删除此属性，它会告诉我应该明确定义它。这个警告会给我带来麻烦吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T15:56:59.493

`<meta property="fb:description" content="For all those people who know what C is but can still remember what fun is">`

应该

`<meta property="og:description" content="For all those people who know what C is but can still remember what fun is">`

关键部分是`og:description`

# python - 如何从 .t xt 文件中读取行？

> ID：13440682
> 
> 赞同：-2
> 
> 时间：2012-11-18T13:40:08.273
> 
> 标签：python, text, io

我有一个`.txt`包含 100 个 50 位数字的文件。每个数字都在不同的行上。

文件示例：

```
37107287533902102798797998220837590246510135740250
46376937677490009712648124896970078050417018260538
74324986199524741059474233309513058123726617309629
91942213363574161572522430563301811072406154908250
23067588207539346171171980310421047513778063246676
#95 more numbers 
```

我希望能够在打开文件后将每个数字附加到列表中。我怎样才能做到这一点？

我知道如何打开文件：`fo = open('file_name', 'r')`. 以及如何在最后关闭它：`fo.close()`。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T13:42:14.077

您可以非常轻松地遍历文件中的行：

```
for line in fo:
    # Do whatever with the line 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T13:44:44.940

Python教程的第7章可以回答这个问题： http: [//docs.python.org/3/tutorial/inputoutput.html#reading-and-writing-files](http://docs.python.org/3/tutorial/inputoutput.html#reading-and-writing-files)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-18T13:52:40.493

这是我能想到的最简单的方法：

```
with open('numbers.txt') as file:
    lst = [line.strip() for line in file] 
```

# c# - 管理表中记录的最佳方式

> ID：13440685
> 
> 赞同：0
> 
> 时间：2012-11-18T13:40:13.817
> 
> 标签：c#, sql, winforms, linq

我很抱歉他们问这个问题已经被问了很多次了，但我仍然没有找到最好的答案。

我担心**应用程序需要很长时间**才能**下载记录**或**过滤记录**。假设我有一个**名为 tbl_customer**的表。并在 tbl_customer 中记录超过**10,000 行**。

**第一个问题**，我使用**Data Grid View 来显示记录**。如果我**将最多 10,000**行的所有记录下载到数据网格视图中会很理想吗？或者我最好设置**记录行限制？**

**第二个问题**，过滤**tbl_customer**中记录的**最佳方法**是什么。我们只需要**使用 SQL 进行查询吗？**还是**使用 LINQ？**或者也许有更好的方法？

 ******目前，我只使用这种方式：

```
DataTable dtCustomer = new DataTable();

 using (SqlConnection conn = new SqlConnection(cs.connString))
        {
            string query = "SELECT customerName,customerAddress FROM tbl_customer WHERE customerAddress = '"+addressValue+"' ORDER BY customerName ASC;";

            using (SqlDataAdapter adap = new SqlDataAdapter(query, conn))
            {
                adap.Fill(dtCustomer);

            }
        }

dgvListCustomer.DataSource = dtCustomer 
```

然后我了解**了 LINQ**，所以我喜欢这样

```
 DataTable dtCustomer = new DataTable();

         using (SqlConnection conn = new SqlConnection(cs.connString))
                {
                    string query = "SELECT * FROM tbl_customer ORDER BY customerName ASC;";

                    using (SqlDataAdapter adap = new SqlDataAdapter(query, conn))
                    {
                        adap.Fill(dtCustomer);

                    }
                }

var resultCustomer = from row in dtCustomer.AsEnumerable()
                                         where row.Field<string>("customerAddress") == addressValue
                                         select new
                                         {
                                             customerName = row["customerName"].ToString(),
                                             customerAddress = row2["customerAddress"].ToString(),

                                         };

 dgvListCustomer.DataSource = resultCustomer; 
```

Workflow **SQL> DATATABLE> LINQ > DataGridView**适合过滤记录吗？或者如果有更好的建议欢迎。

谢谢..：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:53:29.057

> 我担心应用程序需要很长时间才能下载记录或过滤记录。

欢迎 - 您似乎生活在像我这样的世界中，性能毫秒以毫秒为单位，是的，在低功耗服务器上，热加载和过滤 10.000 行可能需要超过一毫秒（0.001 秒）。

因此，我的建议是不要将该数据库放在平板电脑或手机上，而是至少为数据库服务器使用一个像样的桌面级计算 r 或 VM。

作为提示：我经常对十亿行表进行查询，而且速度很快。如今，任何低于一百万行的东西都是一个笑话——事实上，当我在 15 多年前开始使用数据库时，这没什么值得一提的。你是那种问是法拉利还是保时捷更好的人，因为你担心这些情况是否超过 20 公里/小时。

> 如果我将最多 10,000 行的所有记录下载到数据网格视图中会很理想吗？

为了被解雇？是的。数据库的旧规则：永远不要加载超过你必须加载的数据，尤其是当你不知道的时候。忘记 SQL 方面 - 你会遇到 10.000 行及更多行的 UI 问题，尤其是可用性问题。

> 我们只需要使用 SQL 进行查询吗？还是使用 LINQ？

提示：Linq 也在后台使用 SQL。问题更多 - 您想花多少时间为示例中的手写 SQL 编写无聊的重复代码？特别是考虑到您还做了“聪明”的事情，例如按名称引用字段，而不是序数，并要求“选择 *”而不是字段列表，机器人明显的初学者错误。

你绝对不应该做的——但你应该做的——是使用 DataTable。获得一本关于编程数据库的体面的书。RTFSM 可能有帮助 - 两种 LINQ（我不确定你的意思 - LINQ 是编译器的一种语言，你需要一个实现者，所以它可能是 NHibernate、实体框架、Linq2Sql、BlToolkit，仅举几个例子从 LINQ 查询到 sql 语句）。

> Workflow SQL> DATATABLE> LINQ > DataGridView 适合过滤记录吗？

一辆法拉利也适合将 20 吨煤炭从 A 运输到 B—​​—这对它来说是最糟糕的汽车。GSour 堆栈可能是我见过的最糟糕的堆栈，但它是合适的，因为你可以做到 - 缓慢，大量使用内存，但你会得到一个结果并希望被解雇。您将数据从高性能数据库提取到数据表中，然后使用非集成技术 (LINQ) 进行过滤（不使用数据表中的索引）以进入另一层。

只是给你一个想法——这会让你从相当多的“入门编程”课程中删除。

关于什么：

LINQ

观点。

拉取一组进入 UI 的业务对象。时期。

至少阅读您使用的技术的一些示例代码。******

# yii - Yii 在使用 Has_Many 关系后提取值

> ID：13440690
> 
> 赞同：0
> 
> 时间：2012-11-18T13:40:44.590
> 
> 标签：yii

关系：

```
'attendances' => array(self::HAS_MANY, 'Attendance', 'atd_atbs_Id') 
```

控制器：

```
$report=AtbStud::model()->with('attendances')->findAll('atbs_atb_Id='.$id);
    foreach ($report->attendances as $value) {
        echo Yii::trace(CVarDumper::dumpAsString($value->atd_Date),'vardump');;
    } 
```

错误：

```
"$report->attendances" Trying to get property of non-object. 
```

如果我们使用 has_many 关系，我们如何访问值。

# jquery - jquery ...计时器插件

> ID：13440691
> 
> 赞同：1
> 
> 时间：2012-11-18T13:40:52.000
> 
> 标签：jquery, countdown, chronometer

我正在搜索一个 jquery 插件，其中： - 您可以设置时间倒计时 - 当倒计时到达 0 时设置一个函数；- 开始/停止/暂停/重置倒计时

谁能帮我？非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T14:00:04.467

您可以很容易地在没有库的情况下自己编写一个：

```
<!-- HTML -->
<a href="#" class="start">start</a>
<a href="#" class="stop">stop</a>
<a href="#" class="pause">pause</a>
<a href="#" class="reset">reset</a>

<div class="time"></div> 
```

- ​</p>

```
//Javascript
var startValue = 120000; //Number of milliseconds
var time = new Date(startValue);
var interv;

function done(){
    alert("Timer reached 00:00!");
}
$(function(){
    displayTime();
    $(".start").on("click", function(){
    interv = setInterval(function(){
        time = new Date(time - 1000);
        if(time<=0){
            done();
            clearInterval(interv);
        }
        displayTime();
    }, 1000);
    });
    $(".stop").on("click", function(){
        clearInterval(interv);
        time = new Date(startValue);
        displayTime();
    });
    $(".pause").on("click", function(){
        clearInterval(interv);
    });
    $(".reset").on("click", function(){
        time = new Date(startValue);
        displayTime();
    });
});

function displayTime(){
    $(".time").text(fillZeroes(time.getMinutes()) + ":" + fillZeroes(time.getSeconds()));
}

function fillZeroes(t){
    t = t+"";
    if(t.length==1)
        return "0" + t;
    else
        return t;
}
​ 
```

[提琴手](http://jsfiddle.net/VfaB8/2/)

# jquery - jquery选择器以内容开头

> ID：13440701
> 
> 赞同：0
> 
> 时间：2012-11-18T13:41:38.707
> 
> 标签：jquery

> **可能重复：**
> [Jquery 选择所有带有以字符串开头的 innerHTML 的元素？](https://stackoverflow.com/questions/3631199/jquery-select-all-elements-with-an-innerhtml-that-starts-with-a-string)

我的代码：

```
<a href="#">Prefix today is monday</a>
<a href="#">Prefix today is wednesday</a>
<a href="#">other links</a> 
```

是否有一个 jquery 选择器可以通过以“前缀”开头的内容来选择元素？

我知道有一个这样的包含选择器：

```
$("a:contains('Prefix')") 
```

但它是“包含”，是否有“StartWith”内容选择器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T13:44:50.290

```
$("a:contains('Prefix')").filter(function(){
    return this.innerHTML.indexOf('Prefix') == 0;
}) 
```

如果您不希望 HTML 干扰，您还可以检查文本：

```
$("a:contains('Prefix')").filter(function(){
    return $(this).text().indexOf('Prefix') == 0;
}) 
```

# xml - 在 windows phone 7 silverlight 应用程序中使用 geoplugin

> ID：13440702
> 
> 赞同：1
> 
> 时间：2012-11-18T13:41:40.697
> 
> 标签：xml, web-services, windows-phone-7.1, reverse-geocoding

我试图在 Windows Phone 7 应用程序中使用 Web 服务：[http](http://www.geoplugin.com/webservices/extras) ://www.geoplugin.com/webservices/extras来获取基于纬度/经度的位置的详细信息。我首先尝试了具有随机值的 Web 服务并得到了这个 xml 文件

```
<geoPlugin>
    <geoplugin_place>Redmond</geoplugin_place>
    <geoplugin_countryCode>US</geoplugin_countryCode>
    <geoplugin_region>Washington</geoplugin_region>
    <geoplugin_regionAbbreviated>WA</geoplugin_regionAbbreviated>
    <geoplugin_latitude>47.6739900</geoplugin_latitude>
    <geoplugin_longitude>-122.1215100</geoplugin_longitude>
    <geoplugin_distanceMiles>0.07</geoplugin_distanceMiles>
    <geoplugin_distanceKilometers>0.11</geoplugin_distanceKilometers>
</geoPlugin> 
```

但是当我在我的应用程序中尝试使用它时，它返回了一个空的 xml 文件。这是代码：

```
private void Button_Click(object sender, RoutedEventArgs e)
    {
        GeoCoordinateWatcher pos = new GeoCoordinateWatcher();
        pos.Start();
        var mypos = pos.Position;
        pos.Stop();
        double latitude = 47.674;
        double longitude = -122.12;
        if (!mypos.Location.IsUnknown)
        {
            latitude = mypos.Location.Latitude;
            longitude = mypos.Location.Longitude;
        }
        WebRequest.RegisterPrefix("http://www.geoplugin.net/extras", WebRequestCreator.ClientHttp);
        Uri req = new Uri(string.Format("http://www.geoplugin.net/extras/location.gp?lat={0}&long={1}&format=xml", latitude, longitude));
        WebClient downloader = new WebClient();
        downloader.OpenReadCompleted += new OpenReadCompletedEventHandler(downloader_OpenReadCompleted);
        downloader.OpenReadAsync(req);
    }
void downloader_OpenReadCompleted(object sender, OpenReadCompletedEventArgs e)
    {
        if (e.Error == null)
        {
            XmlReader reader = XmlReader.Create(e.Result);
            reader.ReadStartElement("geoplugin_place");
            textBox1.Text = reader.ReadContentAsString();

        }
    } 
```

它给出了一个例外：找不到元素'geoplugin_place'。第 2 行，位置 2。

我的代码或服务有什么问题吗？或者，如果我可以使用任何其他服务来获得相同的结果，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T23:54:11.303

我丢弃了 geoplugin api 并使用了 Bing maps api，它运行良好。

# android - SQLite：如何获取长类型值的平均值

> ID：13440703
> 
> 赞同：1
> 
> 时间：2012-11-18T13:41:52.097
> 
> 标签：android, sqlite

我正在制作一个记录触摸屏操作时间戳的应用程序，这让我成为了我的用户。

然后，在 SQLite 表中记录读数后，我在最后取每列的平均值。但是，我收到一个错误：

```
E/AndroidRuntime(1344): java.lang.NumberFormatException: Invalid long: "1.40024e+08" 
```

当我尝试取每列的平均值时会发生这种情况，我正在这样做：

```
public long[] getAvg()
{
    String selectQuery = "SELECT  AVG(dwell_1), AVG(dwell_2), AVG(dwell_3),  AVG(dwell_4), AVG(dwell_5), AVG(dwell_6), AVG(dwell_7), AVG(dwell_8), AVG(dwell_9), AVG(flight_12), AVG(flight_23), AVG(flight_34), AVG(flight_45), AVG(flight_56), AVG(flight_67), AVG(flight_78), AVG(flight_89) FROM " + TABLE;

    SQLiteDatabase db = this.getWritableDatabase();
    Cursor cursor = db.rawQuery(selectQuery, null);

    long[] row = new long[17];

    if (cursor.moveToFirst()) {
        for (int j=0; j<17; j++)
            row[j] =  Long.parseLong(cursor.getString(j));

    }

    return row;

} 
```

它似乎是 SQLite 查询显示结果的方式的函数。有什么办法可以规避/解决这个问题吗？顺便说一句，我需要精度，所以我不能使用 int 或其他东西。

奇怪的是，当我运行查询以直接显示表中的每条记录时，它工作正常。

任何帮助将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T13:52:15.570

我相信`SQLite`AVG() 函数返回一个`float`您试图将其解析为的值`Long`，因此是异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T13:56:19.983

尝试这个 ：

```
 public long[] getAvg()
 {
      String selectQuery = "SELECT  AVG(dwell_1), AVG(dwell_2), AVG(dwell_3),  AVG(dwell_4), AVG(dwell_5), AVG(dwell_6), AVG(dwell_7), AVG(dwell_8), AVG(dwell_9), AVG(flight_12), AVG(flight_23), AVG(flight_34), AVG(flight_45), AVG(flight_56), AVG(flight_67), AVG(flight_78), AVG(flight_89) FROM " + TABLE;

      SQLiteDatabase db = this.getWritableDatabase();
      Cursor cursor = db.rawQuery(selectQuery, null);

      long[] row = new long[17];

      if (cursor.moveToFirst()) {
          for (int j=0; j<17; j++)
               row[j] =  cursor.getLong(j);
      }

      return row;
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-18T14:00:13.717

SQLite 返回浮点结果，您尝试将其保存为 long。

可能的解决方案：

1.  在 Java 端使用浮点/双精度变量。
2.  或者使用强制 SQLite 输出整数/长整数

    ```
    SELECT CAST(avg(field) AS INTEGER) AS avg_field... 
    ```

    在您的情况下，如果原始结果是 SQLite INTEGER，则结果应该仍然适合 Java。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-28T20:33:39.857

考虑一个获取实体平均评分的简单方法。额定浮点值存储在 0.0 到 5.0 之间。

```
 public static float getAverageReviews(SQLiteDatabase db) {
        String selectQuery = "SELECT  SUM(stars) * FROM " + DatabaseHelper.TABLE_STORE_REVIEWS;
        Cursor c = db.rawQuery(selectQuery, null);
        int count = c.getCount();
        float totalSum = 0;
        if(count > 0 && c.moveToFirst())
        {
            do {
                String result = c.getString(c.getColumnIndex(StoreReviews.KEY_STARS));
                totalSum  += Float.parseFloat(result);
            } while (c.moveToNext());
        }
        else {
            return 0;
        }
        return totalSum/count;
    } 
```

# php - 来自 HTTP JSON API 的响应模式

> ID：13440710
> 
> 赞同：0
> 
> 时间：2012-11-18T13:42:33.923
> 
> 标签：php, api, response, httpresponse

我有一个 HTTP JSON API，它在一个小框架上运行在 php 上。此 API 是数据库 pgsql 函数的包装器。PHP 框架以这种方式返回响应：

```
{
  code: 200,
  data: []
} 
```

代码是 HTTP 代码响应（例如 200、301、302 等）。pgsql 函数返回它们自己的代码（负值表示错误，正值表示成功结果）、消息（代码的含义）和结果数据：

```
{
  code: -1,
  message: 'Wrong data',
  data: []
} 
```

所以，我的 API 包是：

```
{
  code: 200,
  data: {
    code: 1
    message: 'Succeed'
    data: []
  }
} 
```

不是很乱吗？在编写请求此 API 的客户端代码时出现一些混淆。也许有一些标准模式可以制作某种 API 包。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:49:52.180

看到你必须以迭代的方式阅读回复。您可以读取 JSON 响应，然后检查数据字段是否有另一个对象/数组。

您必须评估代码并在除 200 之外的所有代码上显示错误消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T13:50:20.830

您的 API 布局并不混乱。正如 Botond 所建议的，这实际上是非常合乎逻辑的。我要对其进行的唯一更改是将您的状态代码移动到 HTTP 标头而不是 JSON 数据中，以稍微减少格式。这也将允许您轻松区分成功的调用和错误。

假设你的 API 可以回答 4 个不同的代码：200、201、403、404。分别是：完成、未更改、禁止、未找到。您可以轻松地将其绑定到 HTTP 响应标头中，而不是将其作为 JSON 变量传递，因为这些值已经存在并且很好理解。就像在[这个问题](https://stackoverflow.com/questions/3290182/rest-http-status-codes)中一样，这是一种非常受欢迎的提供状态代码的方法，前提是您没有将此特定标头用于其他任何事情。

# apache - 如何拒绝使用 .htaccess 访问文件？

> ID：13440715
> 
> 赞同：0
> 
> 时间：2012-11-18T13:43:28.623
> 
> 标签：apache, .htaccess, nginx

我需要使用 .htaccess 阻止对目录中特定文件（包含私有数据）的访问。这可能吗？

我们使用 Apache 和 nginx。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T18:28:03.503

如果您想阻止查看特定文件，例如图片.jpg：

```
<files picture.jpg>
     order allow,deny
     deny from all
</files> 
```

用您的文件更改图片.jpg。

如果您想拒绝访问所有带有 .jpg 扩展名的文件：

```
<files  ~ "\.jpg$">
  Order allow,deny
  Deny from all
</files> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T18:12:11.967

```
<Files "yourfile">
  Order allow,deny
  Deny from all
  Satisfy all
</Files> 
```

有关更多信息，请参阅[apache 文档](http://httpd.apache.org/docs/2.2/mod/core.html#files)...

# ios - 如何在Xcode中调用带参数的url

> ID：13440718
> 
> 赞同：2
> 
> 时间：2012-11-18T13:43:55.613
> 
> 标签：ios, xcode, push-notification, apple-push-notifications

我有一个用于推送通知服务和工作的 php 文件.. 我想在 xcode 中使用该 php 文件，例如发送设备令牌和消息，如查询字符串..

我用了这段代码

```
NSString *urlString = @"http://xxxxxx.com/send-notification.php?token=%@&message=test";                       
NSString *escapedString = [urlString stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
NSURL *add = [NSURL URLWithString:[NSString stringWithFormat:@"%@%@",escapedString,token]];` 
```

但不工作我不知道如何调用这个php ..

感谢所有帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:10:04.460

您将需要以不同的方式创建您的网址。在您的代码中，后面`%@`的初始`urlString`不会被替换。

相反，请尝试像这样编写代码：

```
NSString *urlString = [NSString stringWithFormat:@"http://xxxxxx.com/send-notification.php?token=%@&message=test", token];
NSString *escapedString = [urlString stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
NSURL *add = [NSURL URLWithString:escapedString]; 
```

创建 NSUrl 实例后，您必须打开到该 url 的 http 连接。

# android - Android：将手势事件传递给另一个视图

> ID：13440720
> 
> 赞同：19
> 
> 时间：2012-11-18T13:44:11.557
> 
> 标签：android, listview, ontouchlistener

我继续在我的 Sticky ListView 上工作，其中 ListView 中的指定视图在经过时会粘在顶部和/或底部。我通过设置一个与列表项相同的视图来实现这一点，并在列表项在屏幕上和离开屏幕时显示或隐藏它。

我的问题是，当这些“粘性”项目出现时，我希望它们对触摸做出反应，就好像它们是列表视图本身的一部分一样。例如，在顶部粘性上的向下甩应该使列表视图向下滚动。

我的问题是是否可以为这个视图分配一个触摸监听器，然后将这些事件直接传递给列表。

我希望它会像这样简单：

```
ListView list;

....

stickyview.setOnTouchListener(new OnTouchListener() {

        @Override
        public boolean onTouch(View arg0, MotionEvent motionEvent) {
            list.onTouchEvent(motionEvent);
            return false;
        }

    }); 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-18T15:50:15.173

我通过一些细微的调整得到了它：

```
stickyView.setOnTouchListener(new View.OnTouchListener() {
        @Override
        public boolean onTouch(View v, MotionEvent event) {
            return list.onTouchEvent(event);
        }
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-11-02T22:34:11.777

在我的情况下，我不得不使用它`dispatchTouchEvent(MotionEvent event)`来实现这一点

# joomla - 无法将模块添加到 Joomla 模板 3.0.2

> ID：13440726
> 
> 赞同：0
> 
> 时间：2012-11-18T13:44:49.373
> 
> 标签：joomla, joomla-template

我在 Joomla 3.0.2 平台上创建了一个模板。模板没问题，但我遇到了错误：我无法将 Joomla 的任何模块添加到我的模板中。例如，在文件 index.php 中我有一个`<div>`标签：

```
 <div id="find"> </div> 
```

我想包含在这个“搜索”模块中，然后我在标签 div 中插入这段代码：

```
 <jdoc:include type="modules" name="find" style="xhtml" /> 
```

最后，我更新了我的 templateDetails.xml：

```
 <position> find </position> 
```

但是当我尝试在“查找”位置插入“搜索”模块时，它不起作用，请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T14:58:05.217

您的模板中存在以下问题：

1.  在您的清单文件`<position> find </position>`中与 不一样`<position>find</position>`，因此请删除空格。作为一般规则，不要在标签之间使用空格（在 XML 中以及在 XHTML 中）。

2.  每个文件夹都应该包含一个空的 index.html 文件。

3.  不要使用绝对路径来链接 CSS 和图像。

仔细看看 Protostar 模板是如何构建的，你可能会从中学到很多东西。

# php - phpThumb 仍然是一个好的解决方案吗？

> ID：13440734
> 
> 赞同：2
> 
> 时间：2012-11-18T13:45:30.300
> 
> 标签：php, image, libraries, phpthumb

很久以前，我使用一个名为 phpThumb 的 PHP 库在我的网站上显示不同大小的图像。

今天我也需要这样做。谷歌搜索 phpThumb 给了我 2 个结果：

*   [http://phpthumb.sourceforge.net/](http://phpthumb.sourceforge.net/)
*   [http://phpthumb.gxdlabs.com/](http://phpthumb.gxdlabs.com/)

他们是一样的吗？

我应该坚持使用 phpThumb，还是今天有更好的库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T13:53:33.483

它们对我来说看起来不一样，但后一个链接肯定比前者更新（它们是不同的版本号，前者最后一次更新是在 2011 年 8 月）所以如果我现在选择一个使用，我会选择[http://phpthumb.gxdlabs.com/](http://phpthumb.gxdlabs.com/)。

不幸的是，我不知道任何其他用于 PHP 的缩略图生成库。我一直只是使用[ImageMagick](http://php.net/manual/en/book.imagick.php)生成缩略图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T14:07:53.713

大多数人只是使用 ImageMagick（转换）。我也在使用 phpThumb，因为它涵盖了您想要对图像执行的大多数行为。在后台它使用 ImageMagick（如果可用）。该库具有缓存功能，您可以将图像输出到字符串以构建自己的缓存（例如，用于非常常用的图像的 memcache）。

我认为它仍然是图像转换和调整大小的最佳 php 库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T14:00:13.317

个人来说，我还是用phpThumb。我通常使用的CMS系统（Modx）有一个内置的Extra，据我所知，它仍然像一个魅力，即使它有点旧。

phpThumb（Sourceforge 的那个）刚问世时是一个优秀的库，现在仍然非常强大。我不知道任何其他具有相同级别的自定义和优化的 PHP 库，尤其是缓存。

我建议现在坚持使用图书馆，除非你有充分的理由不这样做。您也可以尝试用谷歌搜索，`php thumbnail library`但您很可能必须深入挖掘才能找到与 phpThumb 一样好的东西。

顺便说一句，对于其他人来说，phpThumb 使用 ImageMagic 函数来进行压缩。

# ocaml - 使用 OPAM 安装 camlimage

> ID：13440741
> 
> 赞同：3
> 
> 时间：2012-11-18T13:46:16.303
> 
> 标签：ocaml, opam

我正在尝试使用 opam 安装模块 camlimages。当我`opam install camlimages`在我的 shell 中启动时，camlimages 的编译失败并且我有这个消息：

```
* pngwrite.c: In function ‘write_png_file_rgb’:

* pngwrite.c:65: error: dereferencing pointer to incomplete type
* pngwrite.c: In function ‘write_png_file_index’:
* pngwrite.c:174: error: dereferencing pointer to incomplete type
* *** omake: targets were not rebuilt because of errors:
*    src/pngwrite.o
*       depends on: src/pngwrite.c

'opam install camlimages' failed 
```

如果有人帮助我，那会很酷，因为我需要这个模块来完成一个项目。我在山狮（版本 10.8.2）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T09:30:38.480

关于 caml-list 已经进行了完整的讨论，特别是以下消息：

[Caml 列表上的消息](https://groups.google.com/d/topic/fa.caml/E3ye-blN6Kg/discussion)

它提供了一个包含应该在 Mac OS X 上编译的 camlimages 的存储库的链接。

# c - 如何将数据导出为 GNUplot 可读的 .txt

> ID：13440742
> 
> 赞同：0
> 
> 时间：2012-11-18T13:46:20.427
> 
> 标签：c, export, gnuplot

昨天我太累了，无法发布正确和具体的问题。所以它是：

```
if (t==2){
    printf ("abc\n");
    printf ("abc = "); scanf ("%f",&r);
    printf ("abc = "); scanf ("%d",&n);
    printf ("abc = "); scanf ("%d",&k);
    a=2*r;
    b=2*r;
    c=2*r;

    for (i=0;i<=n;i++){
        float x=(float)rand()/((float)RAND_MAX/a);
        float y=(float)rand()/((float)RAND_MAX/b);
        float z=(float)rand()/((float)RAND_MAX/c);

        if ((x-(r))*(x-(r))+(y-(r))*(y-(r))+(z-(r))*(z-(r))<=(r*r))
            m++;

            if ( i % k ==0 && i > 0 ){
                freopen ( "data.txt","w", stdout );
                printf("%s %s      %s \n","#","n","Vka");
                Vka = ( 2*r*2*r*2*r )*m/i;
                printf("% 6.2f % 6.2f \n",n,Vka);
                fclose (stdout);
            }

    }

    Vk=(2*r*2*r*2*r)*m/n;
    printf ("abc =%d\n", m);
    printf ("abc=%d\n", n);
    printf("abc =%f", Vk);

    } 
```

不幸的是，程序不能像我希望的那样工作。它应该将数据导出到文件“data.txt”，但文件仍然如下所示：

```
# n      Vka 
0.00   0.00 
```

Morover 程序在创建此文件后完成操作，而我希望它完成在终端中打印 Vk 的操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:48:49.493

1.  在循环之前打开文件
2.  使用写入循环内的文件`fprintf`
3.  循环后关闭文件

这个程序根本没有理由乱七八糟`stdout`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T14:36:35.130

使用**open()**系统调用打开文件`write.txt`并将其分配给 fd，例如`fdout`. 然后`dup2(fdout, 1)`用于标准输出。

默认情况下，您的操作系统中有 3 个打开的预定义文件描述符，甚至在您到达之前`main`：
0 分配给标准输入，1 分配给标准输出，2 分配给标准错误。

从手册页`dup2`：

`dup2(int oldfd, int newfd)`成为`newfd`的副本，必要时先`oldfd`关闭。`newfd`

该`dup2`调用将替换`stdout`为您打开的文件`write.txt`。因此，当您`printf`将数据写入 时`stdout`，它将被写入您的文件，而不是操作系统预先定义的 fd 设置。

这不仅可以完成您的工作，stdout 的打开和关闭不再是您的头疼。

# iphone - SInvalidArgumentException'，原因：'-[__NSArrayM objectForKey:]:

> ID：13440743
> 
> 赞同：2
> 
> 时间：2012-11-18T13:46:36.297
> 
> 标签：iphone, objective-c, ios, xcode

我不知道为什么索引处的对象失败。我想知道这里是否有人知道如何纠正这个问题。失败的具体代码`NSURL *imgURLLogo = [NSURL URLWithString:[[firstMessage objectForKey:@"message"] objectForKey:@"photo"]];`位于 void load image 的底部，谁能帮我解决这个问题？

```
static NSString *CellIdentifier = @"Cell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
//  if (cell == nil) {
    cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault     reuseIdentifier:CellIdentifier] autorelease];

    // Configure the cell...
    NSMutableArray *arrMessages = [objectsForContacts objectForKey:[arrayOfUsers   objectAtIndex:indexPath.row]];

    NSMutableDictionary *firstMessage = [arrMessages objectAtIndex:0];

    UILabel *lblFriendName = [[UILabel alloc] initWithFrame:CGRectMake(10, 5, 200, 20)];
    lblFriendName.textAlignment = UITextAlignmentLeft;
    lblFriendName.backgroundColor = [UIColor clearColor];
    lblFriendName.textColor = [UIColor blackColor];
    lblFriendName.font = [UIFont boldSystemFontOfSize:16.0];
    lblFriendName.text = [[firstMessage objectForKey:@"message"] objectForKey:@"toname"];
    [cell.contentView addSubview:lblFriendName];

    UILabel *lblLastMessage = [[UILabel alloc] initWithFrame:CGRectMake(10, 25, 280, 35)];
    lblLastMessage.textAlignment = UITextAlignmentLeft;
    lblLastMessage.numberOfLines = 2;
    lblLastMessage.backgroundColor = [UIColor clearColor];
    lblLastMessage.textColor = [UIColor blackColor];
    lblLastMessage.font = [UIFont systemFontOfSize:13.0];
    lblLastMessage.text = [[firstMessage objectForKey:@"message"] objectForKey:@"text"];
    [cell.contentView addSubview:lblLastMessage];

    UILabel *lblTime = [[UILabel alloc] initWithFrame:CGRectMake(10, 60, 280, 20)];
    lblTime.textAlignment = UITextAlignmentLeft;
    lblTime.backgroundColor = [UIColor clearColor];
    lblTime.textColor = [UIColor blackColor];
    lblTime.font = [UIFont systemFontOfSize:13.0];
    lblTime.text = [NSString stringWithFormat:@"%@",[[[firstMessage objectForKey:@"message"] objectForKey:@"postedat"] substringToIndex:16]];
    [cell.contentView addSubview:lblTime];

    cell.backgroundColor = appDelegate.pref_TableViewCellColorValue;
    //    cell.textLabel.text = [[dict objectForKey:@"post"] objectForKey:@"title"];
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
     NSMutableDictionary *dict = [[objectsForCharacters objectForKey:[arrayOfCharacters objectAtIndex:indexPath.section]] objectAtIndex:indexPath.row];

    UIImageView *imgUser = [[UIImageView alloc] initWithFrame:CGRectMake(5, 1, 48, 48)];
    if (![dict objectForKey:@"cellimage"]) {
        UIImage *img = [appDelegate imageByScalingProportionallyToSize:CGSizeMake(48, 48) img:[UIImage imageNamed:@"smily.png"]];
        imgUser.image = img;
        NSMutableArray *arrObject = [[NSMutableArray alloc] init];
        [arrObject addObject:arrMessages];
        [arrObject addObject:imgUser];
        [NSThread detachNewThreadSelector:@selector(loadImage:) toTarget:self withObject:arrObject];
    } else {
        UIImage *img = [appDelegate imageByScalingProportionallyToSize:CGSizeMake(48, 48) img:[dict objectForKey:@"cellimage"]];
        imgUser.image = img;
    }

    [cell.contentView addSubview:imgUser];

    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    cell.backgroundColor = appDelegate.pref_TableViewCellColorValue;
    return cell;
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    return 80.0;
}

- (void)loadImage :(NSMutableArray *)arrObjects {   
    NSAutoreleasePool* pool = [[NSAutoreleasePool alloc] init];
    NSMutableDictionary *firstMessage= [arrObjects objectAtIndex:0];
    NSURL *imgURLLogo = [NSURL URLWithString:[[firstMessage objectForKey:@"message"] objectForKey:@"photo"]];
    NSLog(@"%@",[[firstMessage objectForKey:@"message"] objectForKey:@"photo"]);
    UIImage *imgLogo = [UIImage imageWithData:[NSData dataWithContentsOfURL:imgURLLogo]];
    if (imgLogo)
        [firstMessage setObject:imgLogo forKey:@"cellimage"];
    else
        [firstMessage setObject:[appDelegate imageByScalingProportionallyToSize:CGSizeMake(48, 48) img:[UIImage imageNamed:@"smily.png"]] forKey:@"cellimage"];
    [self performSelectorOnMainThread:@selector(loadingImageComplete:) withObject:arrObjects waitUntilDone:YES];
    [pool release];
}

-(void) loadingImageComplete :(NSMutableArray *)arrayOfUsers1 {
    NSMutableDictionary *dict = [arrayOfUsers1 objectAtIndex:0];
    UIImageView*imgUser1 = [arrayOfUsers1 objectAtIndex:1];
    UIImage *img = [appDelegate imageByScalingProportionallyToSize:CGSizeMake(48, 48) img:[dict objectForKey:@"cellimage"]];
    imgUser1.image = img;
 } 
```

这是正在发生的事情的nslog。

```
 {
    message =         {
        id = 20;
        name = Road;
        postedat = "2012-11-17 17:11:51";
        status = sent;
        text = "mickey d";
        toname = Road;
        userid = 52;
    };
},
    {
    message =         {
        id = 23;
        name = Road;
        postedat = "2012-11-17 17:11:40";
        status = sent;
        text = "ok message gone wierd";
        toname = Road;
        userid = 52;
    };
},
    {
    message =         {
        id = 17;
        name = Road;
        postedat = "2012-11-17 17:11:29";
        status = sent;
        text = my;
        toname = Road;
        userid = 52;
    };
},
    {
    message =         {
        id = 19;
        name = Road;
        postedat = "2012-11-17 17:11:26";
        status = sent;
        text = moo;
        toname = Road;
        userid = 52;
    };
},
    {
    message =         {
        id = 22;
        name = Road;
        postedat = "2012-11-17 17:11:19";
        status = sent;
        text = loops;
        toname = Road;
        userid = 52;
    };
},
    {
    message =         {
        id = 21;
        name = Road;
        postedat = "2012-11-17 17:11:09";
        status = sent;
        text = ok;
        toname = Road;
        userid = 52;
    };
},
    {
    message =         {
        id = 18;
        name = Road;
        postedat = "2012-11-17 17:11:05";
        status = sent;
        text = moo;
        toname = Road;
        userid = 52;
    };
},
    {
    message =         {
        id = 13;
        name = Road;
        postedat = "2012-10-24 13:10:48";
        status = sent;
        text = test;
        toname = Road;
        userid = 52;
    };
},
    {
    message =         {
        id = 16;
        name = Road;
        postedat = "2012-10-24 13:10:39";
        status = sent;
        text = hi;
        toname = Road;
        userid = 52;
    };
},
    {
    message =         {
        id = 15;
        name = Road;
        postedat = "2012-10-24 13:10:36";
        status = sent;
        text = test;
        toname = Road;
        userid = 52;
    };
},
    {
    message =         {
        id = 14;
        name = Road;
        postedat = "2012-10-24 13:10:26";
        status = sent;
        text = yes;
        toname = Road;
        userid = 52;
    };
} 
```

)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:50:17.320

看起来 arrMessages 是一个 NSArray 的数组。所以 arrMessages 的第一个元素是 not`NSArray`类型`NSDictionary`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T13:55:50.770

```
NSMutableArray *arrMessages = [objectsForContacts objectForKey:[arrayOfUsers   objectAtIndex:indexPath.row]]; 
```

什么是objectsForContacts？它是数组还是字典？如果它是一个数组，那就是你出错的地方。

# c++ - CMake：如何根据不同的主要条目进行编译

> ID：13440744
> 
> 赞同：7
> 
> 时间：2012-11-18T13:46:38.483
> 
> 标签：c++, cmake

假设我有两个`main`条目，一个 in`main1.cpp`和一个 in `main2.cpp`（还有其他文件，但只有两个主要条目）。如何配置`CMakeLists.txt`文件以便我可以包含`main1.cpp`或`main2.cpp`基于不同的目标？即我最终将能够使用“make target1”来生成`exec1`基于`main1.cpp`和“make target2”来生成`exec2`基于`main2.cpp`以及其他文件。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-18T14:01:01.437

听起来像是用除主电源之外的所有来源制作图书馆的案例。然后只需添加两个可执行目标，每个目标都链接到库。

```
add_executable(MyExe1 main1.cpp)
add_executable(MyExe2 main2.cpp)
add_library(MyLib <all the other files>)

target_link_libraries(MyExe1 MyLib)
target_link_libraries(MyExe2 MyLib) 
```

您*可以*只包含所有源代码两次，因此`MyExe1`除了 main2.cpp 和`MyExe2`除 main1.cpp 之外的所有源代码都将包含在内，但这将涉及两次编译源代码并且效率低下。

# ruby-on-rails - Rail 3，回形针自定义插值

> ID：13440747
> 
> 赞同：1
> 
> 时间：2012-11-18T13:47:18.680
> 
> 标签：ruby-on-rails, paperclip

我正在使用[这个上传文件示例](https://github.com/tors/jquery-fileupload-rails-paperclip-example)。

我正在尝试修改附加文件的：url。它无法以某种方式工作。我在终端中收到此错误：

```
NoMethodError (undefined method `upload_file_size' for #<Paperclip::Attachment:0x8ca35e8>): 
```

我的上传.rb：

```
class Upload < ActiveRecord::Base
  attr_accessible :upload, :upload_file_name, :upload_file_size

Paperclip::interpolates :upload_file_size do |attachment, style|
  attachment.instance.upload_file_size
end
  has_attached_file :upload,

                    :url =>"/system/Files/CEL-Files/:upload_file_size/:basename.:extension",
                    :path =>":rails_root/public/system/Files/CEL-Files/:piks/:basename.:extension"

  include Rails.application.routes.url_helpers 
```

这是我的 schema.rb：

```
ActiveRecord::Schema.define(:version => 20120731045929) do

  create_table "uploads", :force => true do |t|
    t.string   "upload_file_name"
    t.string   "upload_content_type"
    t.string   "user"
    t.integer  "upload_file_size"
    t.datetime "upload_updated_at"
    t.datetime "created_at",          :null => false
    t.datetime "updated_at",          :null => false
  end

end 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:41:46.800

您在回形针插值中使用的符号/字符串与您的模型属性“upload_file_size”冲突。尝试将回形针插值自定义名称从“upload_file_size”更改为其他名称。如下所示：

```
Paperclip::interpolates :size_of_file do |attachment, style|
  attachment.instance.upload_file_size
end 
```

# php - 正则表达式跳过嵌入模式

> ID：13440749
> 
> 赞同：2
> 
> 时间：2012-11-18T13:48:07.603
> 
> 标签：php, regex

我正在用 php 过滤一些文本。我寻找这样的模式：

```
Mary [qtip:had|past tense of have] little lamb. 
```

我从工具提示“have 的过去时”中提取锚文本“had”]

部分处理是使用正则表达式`/\[qtip:([^\|\\]]+)\|?([^\\]]*)?\]/`

这工作正常

我正在尝试扩展功能。

```
Mary [qtip:had|past [otherFunction:tense|verb form signalling time] of have] little lamb. 
```

我头脑简单的模式发现`"had"`&`"past [otherFunction:tense|verb form indicating time"`

我想要一个跳过嵌入`[]`对的模式。这些在锚或工具提示中是不允许的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:53:37.497

为什么要逃避`|`和双重逃避`]`？为了解决您的问题，只需禁止`[`在您的模式内打开即可。`]`这要求模式在不遇到任何嵌套方括号的情况下达到结束。

```
preg_match_all('/\[qtip:([^|[\]]+)\|?([^[\]]*)\]/', $input, $matches); 
```

我还删除了最后一个，因为如果您在应该成为可选的模式上`?`使用 use ，它是多余的。`*`

# c# - C#中的嵌套循环

> ID：13440750
> 
> 赞同：-1
> 
> 时间：2012-11-18T13:48:12.960
> 
> 标签：c#, loops

我正在做一个简单的 c# 练习。这就是问题所在：编写一个名为 SquareBoard 的程序，该程序使用两个嵌套的 for 循环显示以下 n×n (n=5) 模式。这是我的代码：

```
Sample output:
# # # # #
# # # # #
# # # # #
# # # # #
# # # # # 
```

这是我的代码：

```
for (int row = 1; row <=5; row++) {
    for (int col = 1;col <row ; col++)
    {
        Console.Write("#");
    }
    Console.WriteLine();
} 
```

但这不起作用。谁能帮助我。谢谢你..

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-18T13:50:14.760

```
int n = 5;
for (int row = 1; row <= n; row++) {
    for (int col = 1;col <= n; col++) {
        Console.Write("# ");
    }
    Console.WriteLine();
} 
```

类似的东西？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-18T13:51:15.710

```
for (int row = 0; row < 5; row++)
{

    for (int col = 0; col < 5; col++)
    {
        Console.Write("# ");
    }
    Console.WriteLine();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-18T13:51:32.363

这段代码：

```
col <row 
```

正在给你带来问题。

将其更改为：

```
col <=5 
```

它应该可以工作

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-18T13:54:51.520

我认为这应该有效：

```
int n = 5;
for (int row = 1; row <=n; row++) 
{
    string rowContent = String.Empty;
    for (int col = 1;col <=n; col++)
    {
        rowContent += "# ";
    }
    Console.WriteLine(rowContent);
} 
```

当然，`StringBuilder`如果你经常做这种事情，你可能想要使用 a 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-18T13:51:56.517

在第一次迭代中，您比较`col`，`row`它们都是 1。您检查一个是否高于另一个，并且第二个循环永远不会运行。像这样重写：

```
 for (int row = 1; row <=5; row++) {    
            for (int col = 1;col <= 5 ; col++)
            {
                Console.Write("#");
            }
            Console.WriteLine();
 } 
```

第二次迭代每次都需要从 1 运行到 5 次。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-13T20:44:41.350

这绝对有效：

```
 for (int i = 1; i <= 5; i++)
        {

            for (int j = 1; j <= 5; j++)
            {
                Console.Write("# ");
            }
            Console.Write("\n");

        } 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-12-06T18:39:52.463

```
for(int i=0; i<5 ; i++)

    for(int j=0 ; j <5 ; j++)
    Console.Write("#");

Console.WriteLine(); 
```

# jquery-mobile - jQuery Mobile 1.2 自动分割器工作不一致

> ID：13440754
> 
> 赞同：-1
> 
> 时间：2012-11-18T13:48:39.973
> 
> 标签：jquery-mobile

如果我创建一个学者列表视图并显示他们的标题，例如。如果我删除标题并仅列出 Joe Bloggs 不再有自动分隔符，那么自动分隔符会起作用吗？

下面是一个代码片段：

```
<ul data-role="listview"  data-filter="true" data-autodividers="true">
    @foreach (var academic in Model)
    {
      <li >@academic.Name ()</li> 
    }
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T07:47:43.067

事实证明，数据库中的某些名称以空格开头，因此在将其删除后，一切都按预期工作。

# vim - 我的脚本中的错误

> ID：13440759
> 
> 赞同：3
> 
> 时间：2012-11-18T13:49:34.480
> 
> 标签：vim

我不喜欢必须按下`ESC`才能更改为正常模式，所以我正在编写一个小脚本来为我做这件事，一段时间后。但我收到以下错误：

```
Error detected while processing InsertEnter Auto commands for "*":
E521: Number required after =: updatetime=aunm 
```

这是脚本

```
let aunm=800
au InsertEnter * let aunm_restore=&updatetime | set updatetime=aunm | au CursorHoldI * :stopinsert
au InsertLeave * let &updatetime=aunm_restore 
```

如果我手动删除`let aunm=800`并设置`set updatetime=800`它会完美运行。但如果需要，我希望有一个全局变量来更改时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T14:06:43.467

采用

```
let &updatetime=aunm 
```

. `set`不接受表达式。

* * *

顺便说一句，我看到你的代码不断添加 CursorHoldI 事件而不清除它们，这样你最终可能会得到一百个。你应该使用

```
autocmd! CursorHoldI * :stopinsert 
```

（用 bang）或只添加一次（在 之前有一行`au InsertEnter`），在任何情况下它都不会在插入模式下被触发。注意：此命令将清除*所有* `CursorHoldI`具有模式`*`且不在任何组中的事件，因此如果您有更多事件，则必须将它们或 this 放入 a `augroup {GroupName} | au … | augroup END`（最好将两者都放入）。

# java - 在 JPanel 中嵌入 VLCJ

> ID：13440760
> 
> 赞同：6
> 
> 时间：2012-11-18T13:49:37.257
> 
> 标签：java, jpanel, vlcj

我已经阅读[了这个 SO 线程](https://stackoverflow.com/questions/10609338/trying-to-embed-vlcj-media-player-in-a-windowscanvas-inside-a-jpanel)，当我尝试使用代码进行一些更改时，我得到的只是一个黑色窗口，有人能告诉我我在这里做错了什么吗，我只有一个带有 main 函数的类：

```
import java.awt.Color;
import javax.swing.JFrame;
import javax.swing.JPanel;

import com.sun.jna.NativeLibrary;

import uk.co.caprica.vlcj.player.MediaPlayerFactory;
import uk.co.caprica.vlcj.player.embedded.EmbeddedMediaPlayer;
import uk.co.caprica.vlcj.player.embedded.videosurface.CanvasVideoSurface;
import uk.co.caprica.vlcj.runtime.windows.WindowsCanvas;

public class Canvas_Demo {

    // Create a media player factory
    private MediaPlayerFactory mediaPlayerFactory;

    // Create a new media player instance for the run-time platform
    private EmbeddedMediaPlayer mediaPlayer;

    private JPanel panel;
    private WindowsCanvas canvas;
    private JFrame frame;

    //Constructor
    public Canvas_Demo(String url){

        //Creating a panel that while contains the canvas
        panel = new JPanel();
        panel.setBackground(Color.BLACK);

        //Creating the canvas and adding it to the panel :
        canvas = new WindowsCanvas();
        panel.add(canvas);
        panel.revalidate();
        panel.repaint();

        //Creation a media player :
        mediaPlayerFactory = new MediaPlayerFactory();
        mediaPlayer = mediaPlayerFactory.newEmbeddedMediaPlayer();
        CanvasVideoSurface videoSurface = mediaPlayerFactory.newVideoSurface(canvas);
        mediaPlayer.setVideoSurface(videoSurface);

        //Construction of the jframe :
        frame = new JFrame("Demo with Canvas AWT");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLocation(100, 100);
        frame.setSize(700, 500);

        //Adding the panel to the 
        frame.add(panel);
        frame.setVisible(true);

        //Playing the video
        mediaPlayer.playMedia(url);

    }
    //Main function :
    public static void main(String[] args) {
        NativeLibrary.addSearchPath("libvlc", "C:/Program Files/VideoLAN/VLC");

        final String url = "C:/MyVideo.mp4";

        new Canvas_Demo(url);

    }

} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T11:23:00.880

当我将视频 url（也称为 MRL 作为媒体资源定位器）更改为：`C:\\MyVideo.mp4`我在窗口中获得了视频。

这个[讨论](https://github.com/caprica/vlcj/issues/29)帮助了我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T13:41:36.610

```
//Creating the canvas and adding it to the panel :
canvas = new WindowsCanvas();
canvas.setSize(700, 500);
panel.add(canvas); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-12T03:49:36.310

我做了这样的事情

```
EmbeddedMediaPlayerComponent mediaPlayerComponent = new EmbeddedMediaPlayerComponent();
        EmbeddedMediaPlayer embeddedMediaPlayer = mediaPlayerComponent.getMediaPlayer();

        Canvas videoSurface = new Canvas();
        videoSurface.setBackground(Color.black);
        videoSurface.setSize(800, 600);

        List<String> vlcArgs = new ArrayList<String>();

        vlcArgs.add("--no-plugins-cache");
        vlcArgs.add("--no-video-title-show");
        vlcArgs.add("--no-snapshot-preview");

        MediaPlayerFactory mediaPlayerFactory = new MediaPlayerFactory(vlcArgs.toArray(new String[vlcArgs.size()]));
        mediaPlayerFactory.setUserAgent("vlcj test player");
        embeddedMediaPlayer.setVideoSurface(mediaPlayerFactory.newVideoSurface(videoSurface));
        embeddedMediaPlayer.setPlaySubItems(true);

        final PlayerControlsPanel controlsPanel = new PlayerControlsPanel(embeddedMediaPlayer);
        PlayerVideoAdjustPanel videoAdjustPanel = new PlayerVideoAdjustPanel(embeddedMediaPlayer);

//            mediaPlayerComponent.getMediaPlayer().playMedia(Constant.PATH_ROOT + Constant.PATH_MEDIA + "tmp.mp4");
        JFrame mainFrame = new JFrame();
        mainFrame.setLayout(new BorderLayout());
        mainFrame.setBackground(Color.black);
        mainFrame.add(videoSurface, BorderLayout.CENTER);
        mainFrame.add(controlsPanel, BorderLayout.SOUTH);
        mainFrame.add(videoAdjustPanel, BorderLayout.EAST);

        //create a button which will hide the panel when clicked.
        mainFrame.pack();
        mainFrame.setVisible(true);

        embeddedMediaPlayer.playMedia("tmp.mp4"); 
```

# recursion - 递归地跟随哈希映射clojure中的值

> ID：13440764
> 
> 赞同：2
> 
> 时间：2012-11-18T13:49:56.213
> 
> 标签：recursion, clojure, hashmap

我在为以下搜索哈希映射和其他类似键、值存储的递归函数提供边缘案例时遇到问题。

```
(def hashbrownies
  {"Mary","Dave"
   "Dave","Anne"
   "Anne","Tim"}) 
```

目前的方法

```
(defn recursive-lookup
  [key-lst search-func conditional]
  (let [next-key (search-func (first key-lst))]
    (if (conditional next-key)
      (reverse key-lst)
      (recur (cons next-key key-lst) search-func conditional)))) 
```

有效的例子

```
>> (recursive-lookup ["Mary"] #(hashbrownies %) (partial = nil))
=> ("Mary" "Dave" "Anne" "Tim")

>> (recursive-lookup ["Mary"] #(hashbrownies %) #(< (.length %) 4))
=> ("Mary" "Dave" "Anne") 
```

有问题的：

```
>> (recursive-lookup ["Mary"] #(hashbrownies %) #(> (.length %) 4))
=> NullPointerException   clojure.lang.Reflector.invokeNoArgInstanceMember (Reflector.java:296) 
```

我可以看出问题所在：由于无法满足条件，该函数`#(> (.length %) 4)`将`nil`（最后一个可能的返回值）作为参数。但是作为 Clojure 的新手，我不知道如何解决这个问题。有没有惯用的方法？

解决方案：

```
(defn recursive-lookup
  [key-lst search-func conditional]
  (let [next-key (search-func (first key-lst))]
    (if (or (nil? next-key)
            (conditional next-key))
      (reverse key-lst)
      (recur (cons next-key key-lst) search-func conditional)))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T14:03:23.883

你需要处理`nil`你的条件函数。您可以为此使用[fnil](https://github.com/nbeloglazov/clojure-interactive-tasks.git)。`fnil`用一些默认值替换 nil。所以你可以试试：

```
(fnil #(> (.length %) 4) "") 
```

如果此条件函数接收`nil`到它，则将其替换`nil`为空字符串“”，然后调用您的函数`#(> (.length %) 4)`。

您也可以`count`改用`.length`. Count 为 nil 返回 0：

```
(count "123") => 3
(count nil) => 0 
```

# asp.net-mvc - 在 VB.NET MVC 应用程序中创建实体框架伙伴类以扩展验证

> ID：13440770
> 
> 赞同：1
> 
> 时间：2012-11-18T13:50:17.813
> 
> 标签：asp.net-mvc, vb.net, entity-framework-4, buddy-class

在实体数据模型中，我有以下复杂类型

```
<EdmComplexTypeAttribute(NamespaceName:="MEMORABLEModel", Name:="EDMspGetContact_Result")>
<DataContractAttribute(IsReference:=True)>
<Serializable()>
Partial Public Class EDMspGetContact_Result
    Inherits ComplexObject
#Region "Factory Method"
.... etc 
```

我正在 VB.Net 中编写一个 MVC 4.0 应用程序

我想在我的解决方案的另一个项目中为复杂类型定义添加验证

我试图在我的 MVC 项目中定义一个部分类，但即使它编译我也知道它是错误的，因为脚手架模板不会生成所有属性

在过去的 6 个月里，我已经从传统编码转向面向对象编码，我真的很难克服这样的问题。感谢指导我哪里出错了。我试过添加一个命名空间。

```
<MetadataType(GetType(EDMspGetContact_ResultMD))> _
<ScaffoldTable(True)> _
Partial Public Class EDMspGetContact_Result
    ' Note this class has nothing in it.  It's just here to add the class-level attribute.
End Class

Public Class EDMspGetContact_ResultMD
    '    ' Name the field the same as EF named the property - "FirstName" for example.
    '    ' Also, the type needs to match.  Basically just redeclare it.
    '    ' Note that this is a field.  I think it can be a property too, but fields definitely should work.

    <Required()> _
    <Display(name:="Last Name")> _
    Public LastName As String

End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T15:37:46.763

以上哪个类定义是EF生成的模型类？如果是最后一个，也需要将其标记为 Partial，以便您的分部类中定义的扩展成员成为同一类的一部分。这可能意味着更改 EF 用于生成模型类的 T4 模板。

这是假设您首先使用数据库或模型。如果您首先使用代码，我想您只需要将主模型类设为部分。

# jquery - 表格排序器排序；多个复选框，多列

> ID：13440772
> 
> 赞同：4
> 
> 时间：2012-11-18T13:50:35.440
> 
> 标签：jquery, tablesorter

我的桌面分拣机几乎按照我想要的方式运行，还有一件事我不知道该怎么做。

现在，我有一个表格，您可以在其中搜索列，您可以通过按下一个按钮来快速过滤表格，该按钮在列的搜索字段中放置一个值。

问题是我希望人们能够检查多个复选框，以便根据此输入过滤表格。这些复选框是“分组的”，每个组都应该在其相应的列上进行过滤（例如，检查不同的月份应该过滤月份列）。应该可以检查多个组中的多个复选框。例如，您可以检查在国家列中过滤的“荷兰”、“比利时”，并检查在月份列中添加过滤器的“八月”和“九月”。您可以查看我的示例网站以了解我的意思。

复选框不应像现在的按钮那样在搜索字段中输入它们的值。

最后，我想包括一个清除所有搜索查询并因此重置表的按钮（它现在已经这样做了），但它也应该取消选中所有复选框。

我不是程序员，但凭借一些基本知识、大量研究和反复试验，我设法让 tablesorter 运行起来。我真的希望有一种方法可以使用复选框。

示例页面：[http](http://www.yellowtipi.nl/tablesortertest/index.html) ://www.yellowtipi.nl/tablesortertest/index.html（这是一个无样式版本以使代码清晰，最终版本将有 100+ 行）。

如果有任何不清楚的地方，请告诉我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T14:26:34.720

您需要做的就是注释掉或删除一行 - `filters.val('');`：

这是代码和[演示](http://jsfiddle.net/Mottie/abkNM/107/)（我还为每个集合添加了清除按钮以允许清除过滤器列）

```
$('button.search').click(function() {
    var filters = $('table').find('input.tablesorter-filter'),
        col = $(this).data('filter-column'),
        txt = $(this).data('filter-text');
    // filters.val('');
    filters.eq(col).val(txt).trigger('search', false);
}); 
```

* * *

此外，此代码需要我[的 tablesorter 分支](http://mottie.github.com/tablesorter/docs/)才能工作。以下是可能感兴趣的其他人的代码：

HTML 示例：

```
<button class="search" data-filter-column="4" data-filter-text="Netherlands">Netherlands</button>
<button class="search" data-filter-column="4" data-filter-text="Belgium">Belgium</button>
<button class="search" data-filter-column="4" data-filter-text="Germany">Germany</button>
<button class="search" data-filter-column="4" data-filter-text="">Clear</button>

<table id="festivaloverzichttable" class="tablesorter">
  <thead>
    <tr>
      <th width="17%" data-placeholder="Search...">Event</th>
      <th width="18%" data-placeholder="Search...">Date</th>
      <th width="9%" data-placeholder="Search...">Duration</th>
      <th width="12%" data-placeholder="Search...">Place</th>
      <th width="10%" data-placeholder="Search...">Country</th>
      <th data-placeholder="Zoek...">Genre(s)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Event 1</td>
      <td data-date="06-02">TBA</td>
      <td>2</td>
      <td>Oisterwijk</td>
      <td>Netherlands</td>
      <td>Hardstyle</td>
    </tr>
    <tr>
      <td>Event 2</td>
      <td data-date="10-11">11 October t/m 13 October</td>
      <td>3</td>
      <td>Volkel</td>
      <td>Netherlands</td>
      <td>Pop, Rock, Urban, Electronic</td>
    </tr>
    <tr>
      <td>Event 3</td>
      <td data-date="06-02">TBA</td>
      <td>1</td>
      <td>Amsterdam</td>
      <td>Netherlands</td>
      <td>Electronic</td>
    </tr>
    <tr>
      <td>Event 4</td>
      <td data-date="09-01">TBA</td>
      <td>1</td>
      <td>Utrecht</td>
      <td>Netherlands</td>
      <td>Electronic, Urban</td>
    </tr>
    <tr>
      <td>Event 5</td>
      <td data-date="07-06">6 July - 7 July</td>
      <td>2</td>
      <td>Beek en Donk</td>
      <td>Netherlands</td>
      <td>Electronic, Hardstyle</td>
    </tr>

    ...

  </tbody>
</table>​ 
```

Javascript（我删除了数据解析器代码和默认过滤器小部件选项以避免混淆）

```
$("#festivaloverzichttable").tablesorter({
    sortList: [[0, 0]],
    widgets: ['zebra', 'filter', 'saveSort'],
    widgetOptions: {
        filter_reset: 'button.reset'
    }
});

$('button.search').click(function() {
    var filters = $('table').find('input.tablesorter-filter'),
        col = $(this).data('filter-column'),
        txt = $(this).data('filter-text');
    filters.eq(col).val(txt).trigger('search', false);
}); 
```

* * *

更新：要允许多个选项，请将按钮搜索更改为以下（[更新的演示](http://jsfiddle.net/Mottie/abkNM/182/embedded/result/)）

```
$('button.search').click(function() {
    var filters = $('table').find('input.tablesorter-filter'),
        col = $(this).data('filter-column'),
        txt = $(this).data('filter-text'),
        cur = filters.eq(col).val(),
        mult, i;

    if (cur && txt !== '') {
        mult = cur.split('|');
        i = $.inArray(txt, mult);
        if (i < 0) {
            mult.push(txt);
        } else {
            mult.splice(i,1);
        }
        txt = mult.join('|');
    }        
    filters.eq(col).val(txt).trigger('search', false);
}); 
```

# c++ - 监控套接字描述符

> ID：13440773
> 
> 赞同：-1
> 
> 时间：2012-11-18T13:50:37.803
> 
> 标签：c++, c, linux, monitoring

我有一个应用程序，它一次打开许多套接字描述符。我只想监视这些是否有任何活动，并关闭一段时间以来没有看到任何活动的描述符。我有一些解决方案，但不确定这是否可以通过防火墙规则完成。我不想把我的精力浪费在可以通过某些系统服务或配置来实现的事情上。

它必须在基于linux的系统上完成。

我想到的解决方案是使用 timerfd_create 并在描述符上使用计时器来监视所有活动的套接字。任何以更好的方式实现这一目标的建议都会有所帮助。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T08:08:27.277

我在 timerfd.h 中使用了 timerfd_create 和 timerfd_settime api。检测已关闭套接字的其他选项是 sysconf 中的 keep_alive 超时。如果套接字处于活动状态但没有活动，keep_alive 超时没有太大帮助，因此必须使用较早的选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T13:58:11.823

用于监视套接字，手册[页](http://linux.die.net/man/2/select)`select()`末尾有一个示例。基本上，您将文件描述符添加到 an并在可以读取或写入其中一个受监视的文件描述符时调用它返回，或者如果您设置了超时，则可以使用 select 和一个小的超时来检查计时器回调中的 fd并关闭那些没有准备好的。`fd_set``select()`

# c# - ASP.NET MVC AJAX 操作模型

> ID：13440774
> 
> 赞同：0
> 
> 时间：2012-11-18T13:50:58.127
> 
> 标签：c#, jquery, asp.net-mvc

我想在 ASP.NET 4 中编写某种 TagCloud/Selection。

这样我就有了一个标签列表，我可以通过单击文本来添加其中的一些。

最好的方法是什么？

**想法 1** 使用包含所有可用标签和选定标签的模型。当点击一个标签时，整个模型被发送到控制器，并且选定的标签被添加到列表中。

我认为如果有很多可用的标签，这将消耗大量流量。

**想法 2**

只需在stackoverflow上添加标签即可。

但是我怎样才能更新我的模型呢？

如何将内容发布到控制器？

提前致谢

问候

斯蒂芬

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T14:13:56.373

不要在模型中存储所有标签的列表，只需存储已选择的标签列表。将该模型绑定到您的视图。

使用代表您的标签的字符串参数向您的控制器添加一个 post 方法。做一些逻辑。

然后编写一个 javascript 或 jquery ajax 调用到您传递标签名称的方法。

如果您的视图需要更新，您可能需要将 html 替换为 ajax 调用。

或者你可以通过一个普通的帖子来完成所有这些。这仅取决于您的需求。

# java - 如何解决 Java 中的字节填充问题？

> ID：13440775
> 
> 赞同：0
> 
> 时间：2012-11-18T13:51:03.697
> 
> 标签：java, io, binaryfiles

我正在读取 Java 中的二进制文件，该文件在保存时是字节填充的，因此在读取时必须反转操作。填充在于在一个字节之后添加一个额外的零`FF`字节。读取时必须丢弃该零字节。我正在使用 a`DataInputStream`来读取文件，尽管这不应该有太大的区别，看看我是如何只对程序的那一部分使用“原始”读取到数组函数的。

无论如何，这是我到目前为止所得到的：

```
public static byte[] unstuff(byte[] stuffed) {
    int bytesToSkip = 0;
    for(int i=0;i<stuffed.length - 1;++i) {
        if(stuffed[i] == 0xFF && stuffed[i+1] == 0) {
            ++bytesToSkip;
        }
    }
    if(bytesToSkip == 0) return stuffed;

    byte unstuffed[] = new byte[stuffed.length - bytesToSkip];
    int j=0;
    for(int i=0;i<stuffed.length - 1;++i) {
        if(stuffed[i] == 0xFF && stuffed[i+1] == 0) {
            ++i;
            continue;
        }
        else {
            unstuffed[j] = stuffed[i];
            ++j;
        }
    }
    return unstuffed;
} 
```

基本上，该函数计算要跳过的字节数，然后分配一个比原始填充数组短该字节数的数组，并将它们复制过来，跳过不需要的零字节。

问题是：有没有其他方法可以做到这一点，也许更流畅、更高效、更直接？将字节放在另一个容器中然后删除它们而不是复制整个数组会更好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T16:08:42.960

您可以将其作为`InputStream`自身的包装器：

```
new DataInputStream(new FilterInputStream(stream)) {
  int buf = -1;

  public int read() {
    if (buf != -1) {
      int result = buf;
      buf = -1;
      return result;
    } else {
      int b = super.read();
      if (b == 0xFF) {
        super.skip(1); // skip the 0 byte
      }
      return b;
    }
  }

  public int read(byte[] bytes, int off, int len) {
    int dst = 0;
    while (dst == 0) {
      int readBytes = super.read(bytes, off, len);
      if (readBytes == -1) return -1;
      int dst = 0;
      for (int i = 0; i < readBytes; i++) {
        bytes[off + dst] = bytes[off + i];
        if (bytes[off + i] == (byte) 0xFF) {
          i++; // skip the 0 byte afterwards
        }
      }
    }
    return dst;
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T14:18:37.370

最优化的方法是使用原始数组进行`FF 00`压缩。只要满足条件，就不要增加目标索引。完成后，数组将包含您想要的序列，但它可能太大，最后有额外的字节。然后，您要么复制到一个较短的数组，要么按原样使用原始数组，但将其传递给接受偏移量+计数到数组的方法，传递较低的字节数。

```
int target = 0;
for (int i = 1; i < stuffed.length; ++i) {
    if (stuffed[i-1] == 0xFF && stuffed[i] == 0) continue;
    if (i != target) stuffed[target++] = stuffed[i];
} 
```

# android - 修复当前 Mapview 并仍然处理 onTouch 事件（GoogleMaps Android）

> ID：13440777
> 
> 赞同：0
> 
> 时间：2012-11-18T13:51:27.953
> 
> 标签：android, android-mapview

我正在尝试在 Android 中修复我的 MapView 上的当前位置，但仍想处理 onTouch 事件。

背景：我的地图视图旁边有一些按钮。如果我选择“移动”，则需要 mapView 的正常行为。

如果我选择另一个按钮，当前地图应该被锁定，所以我可以在地图上画一些东西。因此我需要地图的onTouch-Event ...

我修复 mapView 的唯一解决方案是将 setClickable 设置为 false ......但是当我这样做时，将不再支持 onTouch 事件......

我怎样才能让它发生？

对不起我的英语不好，

丹尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T17:13:02.430

为避免`MapView`处理运动事件，请不要调用`super.dispatchTouchEvent()`并返回 true；

示例代码：

```
@Override   
public boolean dispatchTouchEvent(MotionEvent ev) {
    if(drawMode){
        //do my drawing here
        return true;
    } else retrun super.dispatchTouchEvent(ev);   
} 
```

问候。

# mysql - 没有得到这个mysql查询

> ID：13440780
> 
> 赞同：1
> 
> 时间：2012-11-18T13:52:00.977
> 
> 标签：mysql

我没有收到的部分查询；这些内部连接在做什么？

我有一个包含所有数据的表speeldatum，在我的项目中。下面的查询正在改变rownum列的值，我怎么不明白。在查询中没有内部连接，rownum 列的值为零，我对查询中的 mysql 用户定义的变量没有正确理解。

样本输出（不要考虑 ROWNUM 值的顺序）
....，rownum 0 ....

...，rownum 1，...
...，rownum 2，...

```
 from speeldatums  as t 
    inner join (select @rownum:=0) as r
    inner join (select @prev:="") as r2
    inner join (select @prevdatum:="") as r3** 
```

完整查询：

```
'create temporary table rr_prepare ( rownum INT NOT NULL, datum_unix 
   INT(11) NULL, categorie VARCHAR(20) NOT NULL, entry_id INT NOT NULL,

   INDEX(rownum), INDEX(datum_unix), INDEX(categorie), INDEX(entry_id) )
   ENGINE=MyISAM

   select t.*, @rownum:=if(@prev=t.categorie and
   @prevdatum=t.datum,@rownum+1,0) as rownum, @prev:=t.categorie as
   prevcategorie, @prevdatum:=t.datum as prevdatum

   from speeldatums  as t  inner join (select @rownum:=0) as r 
  inner join (select @prev:="") as r2 
  inner join (select @prevdatum:="") as r3 '; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T14:07:08.653

连接正在引入一些变量并在查询中初始化它们。

您也可以在 2 个查询中单独执行此操作：

```
set @rownum:=0;
select @rownum := rownum + 1, .... ; 
```

但是，如果您只想运行一个查询，您可以使用子选择在查询中动态声明和初始化一个变量

```
... inner join (select @rownum:=0) r ... 
```

# javascript - 以 svg 为单位获取 g 边界框

> ID：13440783
> 
> 赞同：3
> 
> 时间：2012-11-18T13:52:25.333
> 
> 标签：javascript, svg

我正在尝试在*Javascript中实现一个**菜单*，其中单个*菜单项*为. 要将一个项目标记为选中，我想在*menu-item*顶部移动另一个。**`svg:g``svg:g`**

 ***为此，我需要获取*菜单项*(= `svg:g`) 的边界框，以便将矩形 (x, y, width, height) 应用于另一个。我还没有找到一种方便的方法来获取 a 的边界框`svg:g`。

我能想到的唯一方法是递归到孩子身上并手动计算边界框（近似值）。有没有更优雅的方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T14:45:09.203

您应该能够使用[`getBBox`](http://www.w3.org/TR/SVG/types.html#__svg__SVGLocatable__getBBox)您的 group 元素的方法。
例如[http://jsfiddle.net/PFnre/1/](http://jsfiddle.net/PFnre/1/)

```
var root = document.createElementNS("http://www.w3.org/2000/svg", "svg");
document.body.appendChild(root);

var g = document.createElementNS("http://www.w3.org/2000/svg", "g");
root.appendChild(g);

var r = document.createElementNS("http://www.w3.org/2000/svg", "rect");
r.setAttribute("x", "50");
r.setAttribute("y", "60");
r.setAttribute("width", "100");
r.setAttribute("height", "110");
r.setAttribute("fill", "blue");
g.appendChild(r);

var c = document.createElementNS("http://www.w3.org/2000/svg", "circle");
c.setAttribute("cx", "150");
c.setAttribute("cy", "140");
c.setAttribute("r", "60");
c.setAttribute("fill", "red");
g.appendChild(c);

var bbox = g.getBBox();

var o = document.createElementNS("http://www.w3.org/2000/svg", "rect");
o.setAttribute("x", bbox.x);
o.setAttribute("y", bbox.y);
o.setAttribute("width", bbox.width);
o.setAttribute("height", bbox.height);
o.setAttribute("stroke", 'black')
o.setAttribute("fill", 'none');
root.appendChild(o);
```***

# ios - 将多个联系人导入通讯录 iOS6\Xcode

> ID：13440784
> 
> 赞同：2
> 
> 时间：2012-11-18T13:52:25.140
> 
> 标签：ios, cocoa-touch, ios6

主要问题：

我创建了一个应用程序，其中包含三个选项卡中的人员目录（按位置、专业和名称）。该人可以在应用程序中选择一个联系人并呼叫他们；但是，接收呼叫的电话仅显示一个号码而不是名称（因为联系人不在通讯录中，而是在我的应用程序的 sqlite db 中）。

解决方法：

我不太确定是否有任何其他方法可以解决这个问题，但由于呼叫和接收电话都将安装应用程序，我的解决方法是从我的 sqlite3 数据库（或数据库的数组）中导入联系人被拉入）到 iPhone 的通讯录中。一旦进入 iPhone 的通讯录，当有人打电话时，它会显示一个名字而不是一个号码。

问题：

我可以找到将单个联系人添加到地址簿的文档，但不能添加多个人（数据库当前包含大约 150 个联系人）。我想过尝试做一个循环，但我真的不知道从哪里开始..任何人都可以帮助我找到正确的方法来完成这个:)

另外，在后台执行此操作的最佳方法是什么，以免导致应用程序暂停\冻结。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T11:30:49.100

尝试这个....

```
nameArray = [[NSMutableArray alloc]init];

for (int index = 0 ; index< ABAddressBookGetPersonCount(addressBookObj); index++)
{
    recordRefObj = CFArrayGetValueAtIndex(arrayRefObj, index);
    NSString *nameStr = (__bridge NSString*) ABRecordCopyValue(recordRefObj, kABPersonFirstNameProperty);
    [nameArray addObject:nameStr];
} 
```

# jquery - 使用 jQuery 获取复选框属性

> ID：13440787
> 
> 赞同：2
> 
> 时间：2012-11-18T13:52:49.603
> 
> 标签：jquery, html, checkbox

例如，我有几个复选框。

```
<input type="checkbox" value="27" name="option_value[12][]" id="option_value_27"  class="filtered option_value" cat="121">
<input type="checkbox" value="27" name="option_value[12][]" id="option_value_27"  class="filtered option_value" cat="141"> 
```

两个问题：

1.  `cat`属性声明是否有效？
2.  `cat`例如，当我单击按钮时，如何访问属性值？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-18T13:55:36.457

不，`cat`不是有效属性，您可以使用 HTML5`data-*`属性和 jQuery`data`方法：

```
<input type="checkbox" value="27" name="option_value[12][]" id="option_value_27"  class="filtered option_value" data-cat="121"> 
```

```
$('#button').click(function(){
    var cat = $('#option_value_27').data('cat');
}) 
```

或`attr`方法：

```
var cat = $('#option_value_27').attr('data-cat'); 
```

或者如果你不使用 jQuery，你也可以使用`dataset`属性：

```
var cat = document.getElementById('option_value_27').dataset.cat; 
```

另请注意，ID 必须是唯一的。如果要获取所有`cat`属性的值，可以使用`map`方法：

```
var cats = $('.filtered').map(function(){
    return this.dataset.cat
    // or $(this).attr('data-cat')
}).get()
// console.log(cats) 
```

现在`cats`是所有`data-cat`属性值的数组。

# java - struts 忽略该方法并且不显示异常

> ID：13440788
> 
> 赞同：1
> 
> 时间：2012-11-18T13:52:50.340
> 
> 标签：java, struts

我有一个 struts 方法，在我添加验证之前它工作正常，但是一旦我添加了验证方法，我调用的方法就不会被调用，它也没有显示异常。

struts-config.xml

```
<action path="/RolesAction"  name="SecurEyesForm" type="com.secureyes.eswastha.struts.web.action.RolesAction" scope="request" parameter="method" validate="true" input="/WEB-INF/Masters/RolesMaster.jsp">
  <forward name="rolesHome" path="/WEB-INF/Masters/RolesMaster.jsp"></forward>        
</action> 
```

动作类：

```
package com.secureyes.eswastha.struts.web.action;

import com.secureyes.eswastha.struts.web.dao.RolesDAO;
import com.secureyes.eswastha.struts.web.viewmodel.RolesViewModel;
import com.secureyes.eswastha.struts.web.viewmodel.UserViewModel;
import java.util.ArrayList;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;
import org.apache.struts.validator.DynaValidatorForm;

public class RolesAction extends SecureyesAction {

    private String forwardRequestTo = "authentication-failed";

    public ActionForward goToHome(ActionMapping mapping, ActionForm form,
            HttpServletRequest request, HttpServletResponse response)
            throws Exception {

        DynaValidatorForm formObj = (DynaValidatorForm) form;
        int resourceid = 0;
        String pageToken = "";
        boolean isValidMenuRequest = false;
        UserViewModel userVM = new UserViewModel();

        if (request.getSession(false).getAttribute("userDetails") != null) {
            userVM = (UserViewModel) request.getSession(false).getAttribute("userDetails");
        }
        if (formObj.get("pagetoken") != null) {
            pageToken = formObj.get("pagetoken").toString();
        }

        if (formObj.get("resourceid") != null) {
            resourceid = Integer.parseInt(formObj.get("resourceid").toString());
        }

        boolean isValidPageToken = isValidPageToken(userVM.getPagetoken(), pageToken);
        if (isValidPageToken) {
            isValidMenuRequest = isValidMenuRequest(resourceid, userVM.getUserRoleid());
            if (isValidMenuRequest) {
                forwardRequestTo = "rolesHome";
            }
        }
        disableAutocompleteFeature(response);
        return mapping.findForward(forwardRequestTo);
    }

    public ActionForward saveRolesDetails(ActionMapping mapping, ActionForm form,
            HttpServletRequest request, HttpServletResponse response)
            throws Exception {
        System.out.println("save roles");

        DynaValidatorForm formObj = (DynaValidatorForm) form;
        String rolename = "", description = "", functionType = "", roleid = "", saveOrupdateStatus = "", pageToken = "";
        int loggedinuserid = 0;
        UserViewModel userVM = new UserViewModel();
        RolesViewModel dvm = new RolesViewModel();
        RolesDAO rolesDAO = new RolesDAO();

        if (formObj.get("rolename") != null) {
            rolename = formObj.get("rolename").toString();
        }

        if (formObj.get("description") != null) {
            description = formObj.get("description").toString();
        }

        if (formObj.get("functionType") != null) {
            functionType = formObj.get("functionType").toString();
        }

        if (formObj.get("roleid") != null) {
            roleid = formObj.get("roleid").toString();
        }

        if (formObj.get("pagetoken") != null) {
            pageToken = formObj.get("pagetoken").toString();
        }

        if (request.getSession(false).getAttribute("userDetails") != null) {
            userVM = (UserViewModel) request.getSession(false).getAttribute("userDetails");
        }

        loggedinuserid = userVM.getUserid();

        boolean isValidPageToken = isValidPageToken(userVM.getPagetoken(), pageToken);
        if (isValidPageToken) {
            if (functionType.equals("add")) {
                dvm.setRolename(rolename);
                dvm.setDescription(description);
                dvm.setUserid(loggedinuserid);
                saveOrupdateStatus = rolesDAO.saveRolesDetails(dvm, functionType);
            } else if (functionType.equals("edit")) {
                dvm.setRoleid(Integer.parseInt(roleid));
                dvm.setRolename(rolename);
                dvm.setDescription(description);
                dvm.setUserid(loggedinuserid);
                saveOrupdateStatus = rolesDAO.saveRolesDetails(dvm, functionType);
            }
            request.setAttribute("message", saveOrupdateStatus);
            forwardRequestTo = "rolesHome";
        }
        return mapping.findForward(forwardRequestTo);
    }

    public ActionForward deleteRoles(ActionMapping mapping, ActionForm form,
            HttpServletRequest request, HttpServletResponse response)
            throws Exception {
        DynaValidatorForm formObj = (DynaValidatorForm) form;
        String saveOrupdateStatus = "", pageToken = "", roleid = "";
        RolesDAO rolesDAO = new RolesDAO();
        UserViewModel userVM = new UserViewModel();

        if (formObj.get("roleid") != null) {
            roleid = formObj.get("roleid").toString();
        }

        if (formObj.get("pagetoken") != null) {
            pageToken = formObj.get("pagetoken").toString();
        }

        if (request.getSession(false).getAttribute("userDetails") != null) {
            userVM = (UserViewModel) request.getSession(false).getAttribute("userDetails");
        }

        boolean isValidPageToken = isValidPageToken(userVM.getPagetoken(), pageToken);
        if (isValidPageToken) {
            saveOrupdateStatus = rolesDAO.deleteRoles(Integer.parseInt(roleid));
            request.setAttribute("message", saveOrupdateStatus);
            forwardRequestTo = "rolesHome";
        }
        return mapping.findForward(forwardRequestTo);
    }

    public List getAutocompleteRolesData(String rolesName) {
        List rolesNameList = new ArrayList<String>();
        RolesDAO rolesDAO = new RolesDAO();
        try {
            rolesNameList = rolesDAO.getAutocompleteRolesData(rolesName);
        } catch (Exception ex) {
            ex.printStackTrace();
        }
        return rolesNameList;
    }

    public List getRolesDescriptionAutocompleteData(String rolesDescription) {
        List rolesNameList = new ArrayList<String>();
        RolesDAO rolesDAO = new RolesDAO();
        try {
            rolesNameList = rolesDAO.getRolesDescriptionAutocompleteData(rolesDescription);
        } catch (Exception ex) {
            ex.printStackTrace();
        }
        return rolesNameList;
    }

    private String constructRolesSearchQuery(String rolename, String description) {
        StringBuilder rolesSearchQuery = new StringBuilder();
        rolesSearchQuery.append("select roles.rolename,roles.description,roles.roleid from m_roles as roles ");
        if (!rolename.equals("")) {
            rolesSearchQuery.append(" where roles.rolename='").append(rolename).append("' ");
        }
        if (!description.equals("")) {
            if (!rolename.equals("")) {
                rolesSearchQuery.append(" and roles.description='").append(description).append("'");
            } else {
                rolesSearchQuery.append(" where roles.description='").append(description).append("'");
            }
        }
        return rolesSearchQuery.toString();
    }

    public Map getRolesResultHTML(String rolename, String description,HttpServletRequest request) {
        Map roleHTMLMap = new LinkedHashMap();
        String roleQuery = "";
        String path=request.getContextPath();
        roleQuery = constructRolesSearchQuery(rolename, description);
        RolesDAO rolesDAO = new RolesDAO();
        roleHTMLMap = rolesDAO.getRolesResultHTML(roleQuery,path);
        return roleHTMLMap;
    }

    public boolean isRolesExist(String rolename) {
        boolean isRolename = false;
        RolesDAO rolesDAO = new RolesDAO();
        isRolename = rolesDAO.isRolesExist(rolename);
        return isRolename;
    }

    public Map getRoles() {
        Map map = new LinkedHashMap();
        RolesDAO dao = new RolesDAO();
        map = dao.getRoles();
        return map;
    }
} 
```

这就是我调用该方法的方式：

```
function dataSave() {
                alert("data Save");
                getBlanket('continueDIV');
                document.forms[0].action="RolesAction.htm";
                document.forms[0].method.value="saveRolesDetails";
                document.forms[0].submit();   
            } 
```

# wpf - 依赖属性使用

> ID：13440789
> 
> 赞同：0
> 
> 时间：2012-11-18T13:52:51.633
> 
> 标签：wpf, xaml, dependency-properties, attached-properties

我有一个工作附加行为，我想添加一个 DP。我可以在 XAML 中设置该属性，但当我尝试访问它时它为空。

解决方法是什么？

干杯，
贝里尔

# xml

```
<Button Command="{Binding ContactCommand}" local:ContactCommandBehavior.ResourceKey="blah" >
    <i:Interaction.Behaviors>
        <local:ContactCommandBehavior />
    </i:Interaction.Behaviors>
</Button> 
```

# 行为代码

```
internal class ContactCommandBehavior : Behavior<ContentControl>
{
    ...

    public static readonly DependencyProperty ResourceKeyProperty = 
        DependencyProperty.RegisterAttached("ResourceKey", typeof(string), typeof(ContactCommandBehavior));

    public static string GetResourceKey(FrameworkElement element)
    {
        return (string)element.GetValue(ResourceKeyProperty);
    }

    public static void SetResourceKey(FrameworkElement element, string value)
    {
        element.SetValue(ResourceKeyProperty, value);
    }

    private void SetProperties(IHaveDisplayName detailVm)
    {

        //************ 
        var key = GetResourceKey(AssociatedObject);
        //************ 
        ....
    }

} 
```

# 为 HighCore 编辑。

我将代码更改如下，将 RegisterAttached 更改为 Register 并使属性非静态。当我尝试获取它时，该值仍然为空

```
public static readonly DependencyProperty ResourceKeyProperty =
    DependencyProperty.Register("ResourceKey", typeof (string), typeof (ContactCommandBehavior));

public string ResourceKey
{
    get { return (string)GetValue(ResourceKeyProperty); }
    set { SetValue(ResourceKeyProperty, value); }
}

protected override void OnAttached() {
    base.OnAttached();
    if (AssociatedObject == null)
        throw new InvalidOperationException("AssociatedObject must not be null");

    AssociatedObject.DataContextChanged += OnDataContextChanged;
    CultureManager.UICultureChanged += OnCultureChanged;
}

private void OnDataContextChanged(object sender, DependencyPropertyChangedEventArgs e) {
    // do some setup stuff
    SetProperties(vm)
}

private void SetProperties(IHaveDisplayName detailVm)
{
    ////////////////////////////////
    var key = ResourceKey.Replace(TOKEN, cmType);
    /////////////////////////////////
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T15:39:31.517

`DependencyProperty`在`Behavior`而不是附加的中使用常规，然后你可以做

```
<Button Command="{Binding ContactCommand}">
    <i:Interaction.Behaviors>
        <local:ContactCommandBehavior ResourceKey="blah"/>
    </i:Interaction.Behaviors>
</Button> 
```

这是一个更好的语法。此外，请确保您尝试读取这些属性的代码仅在发生之后`OnAttached()`。

# php - Android：在单个页面活动中显示数据库中的数据

> ID：13440798
> 
> 赞同：0
> 
> 时间：2012-11-18T13:54:01.333
> 
> 标签：php, android, database

我正在为我的最后一年项目开发 android 应用程序。参考了一些在线教程和示例，我成功地将一些用户信息和详细信息存储到了数据库中。但是我需要帮助来向主页显示用户和一些用户输入信息。类似于脸书主页。有人可以给我一个方向线索或任何在线文章或教程吗？请感谢您的帮助，谢谢。

这是我存储用户信息和用户输入的 php 文件的一部分。我想在一个页面中显示所有这些。我应该对我的 xml 文件和主要活动类文件进行什么编码？

```
else if ($tag == 'report') {
        //Request type is report location report
        $name = $_POST['name'];
        $address = $_POST['address'];
        $traffic = $_POST['traffic'];
        $whathappen = $_POST['whathappen'];
        $comment = $_POST['comment'];

        //store information
        $report = $db->storeReport($address, $traffic, $whathappen, $comment);
        if($report) {
            //report stored successfully
            //$response["success"] = 1;
            $responce["report"]["name"] = $report["name"];
            $responce["report"]["address"] = $report["address"];
            $responce["report"]["traffic"] = $report["traffic"];
            $responce["report"]["whathappen"] = $report["whathappen"];
            $responce["report"]["comment"] = $report["comment"];
            $responce["report"]["created_at"] = $report["created_at"];
            $responce["report"]["updated_at"] = $report["updated_at"];
            echo json_encode($responce);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T14:01:56.823

有很多选项可以满足您的要求。您可以创建一个活动，其中包含一组`EditText`用于用户输入的框和一组`TextViews`用于显示信息的框。

似乎你需要一个很好的 Android 开发初学者课程来掌握活动、布局、按钮、监听器等。我在这里推荐优秀的官方谷歌开发者指南：

[http://developer.android.com/training/index.html](http://developer.android.com/training/index.html)

如果您知道这些，那么您可以阅读数据库。这是一个很好的教程：

[http://www.androidhive.info/2011/11/android-sqlite-database-tutorial/](http://www.androidhive.info/2011/11/android-sqlite-database-tutorial/)

从数据库中获取数据后，您可以将这些值分配给`TextViews` using`TextView.setText()`方法。

# java - 按对象属性值查找

> ID：13440799
> 
> 赞同：1
> 
> 时间：2012-11-18T13:54:34.010
> 
> 标签：java, collections, properties

我有以下情况。我有一些 A 类，它有 B 类型的对象列表。B 类型有两个属性 X，字符串类型的 Y 和两个 getter getX() getY()。我想在 A 类中有一个方法，它从给定字符串值选择的 B 对象集合中返回一个对象。例如：

```
B findElementByX(String x) {
    for (B i : list) {
         if (i.getX().equals(x)
             return i;
    }
    return null;
} 
```

对于另一个属性 Y，我将有几乎相同的代码，btu 而不是 getX()，将有 getY()。对我来说，这是不必要的代码冗余。我的问题是：如何编写此方法以便通过 X 或 Y 属性值找到一种方法？这是用Java解决这个问题的通用方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T14:09:03.277

你可以有一个功能

```
B findElementByProperty(String prop, PropertyExtractor<B,String> propEx) 
```

where是指向返回类型`PropertyExtractor<B,P>` 函数的泛型函数指针。`B``P`

只是Java没有函数指针。因此`PropertyExtractor<B,P>`，可以改为具有单个方法的接口，例如`P getProperty(B obj)`，您当然需要两个实现（分别包装对`getX`和的调用`getY`）。

但是，您可以很容易地看到这不会为您节省很多代码行。从相反的方面来说。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T20:52:12.060

你可以通过使用像[Guava](http://code.google.com/p/guava-libraries/)这样的东西来减少这样的代码大小，它提供了类似于函数式语言样式列表理解的东西。

您也可以通过定义接口自己滚动其中的一些内容

```
public interface Predicate<T> {
    boolean apply(T obj);
} 
```

然后使用它创建一个查找器方法：

```
B findElementByPredicate(Predicate<B> predicate) {
    for (B b : list) {
        if (predicate.apply(b))
            return b;
    }
    return null;
} 
```

您还可以（如评论中所述）使用反射来获取字段的值。实现 arne.b 的答案中定义的接口，您可以定义

```
public class ReflectivePropertyExtractor<T, P> implements PropertyExtractor<T, P> {

    String fieldName;

    public ReflectivePropertyExtractor(String fieldName) {
        this.fieldName = fieldName;
    }

    @Override
    public P getProperty(T obj) {
        try {
            Method m = B.class.getMethod(makeAccessorName());
            return (P) m.invoke(obj);
        } catch (InvocationTargetException e) {
            return null;
        } catch (NoSuchMethodException e) {
            return null;
        } catch (IllegalAccessException e) {
            return null;
        }
    }

    private String makeAccessorName() {
        return "get" + capitalize(fieldName);
    }

    private String capitalize(String s) {
        if ((s == null) || (s.length() == 0))
            return s;
        return s.substring(0, 1).toUpperCase() + s.substring(1);
    }

} 
```

制作一个适用于指定字段名称的属性提取器，并按照他在答案中描述的那样使用它或基于它制作一个谓词：

```
public class PropertyMatchPredicate<T, P> implements Predicate<T> {
    private final P matchValue;
    private final PropertyExtractor<T, P> extractor;

    public PropertyMatchPredicate(P matchValue, PropertyExtractor<T, P> extractor) {
        this.matchValue = matchValue;
        this.extractor = extractor;
    }

    @Override
    public boolean apply(T obj) {
        return matchValue.equals(extractor.getProperty(obj));
    }
} 
```

然后在`findByPredicate`上面使用该谓词：

```
B findElementByProperty(String matchField, final String matchValue) {
    final ReflectivePropertyExtractor<B, String> extractor = new ReflectivePropertyExtractor<B, String>(matchField);
    return findElementByPredicate(new PropertyMatchPredicate<B, String>(matchValue, extractor));
} 
```

如果您只处理两个属性，所有这些策略都可能会增加而不是减少代码大小。优势只会在更大的范围内出现，并且您可能会付出代价，使不熟悉函数式样式和/或反射的人的代码可读性降低。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-18T14:04:25.117

将 X 或 Y 作为另一个参数传递以查找 getX() 或 getY() 否则返回 null。

```
B findElementByXY(String s,String identifier) {
    for (X i : list)
    {
         if ("X".equals(identifier)&&i.getX().equals(s))
             return i;
         else if ("Y".equals(identifier)&&i.getY().equals(s))
             return i;

    }
    return null;
} 
```

# android - Admob 与 Android 中的 simple-xml 集成？

> ID：13440803
> 
> 赞同：2
> 
> 时间：2012-11-18T13:55:09.133
> 
> 标签：android, admob, integration, simple-framework

我很难将 Admob 横幅集成到我的游戏中。我使用了 simple-xml-2.6.2.jar 库，因为我认为它很容易在我的游戏中实现。现在我有一个布局文件，其中包含发布者 ID 和测试设备的正确代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
          xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
          android:orientation="vertical"
          android:layout_width="fill_parent"
          android:layout_height="fill_parent">
<com.google.ads.AdView android:id="@+id/adView"
                     android:layout_width="wrap_content"
                     android:layout_height="wrap_content"
                     ads:adUnitId="xxxxxxxxxxx"
                     ads:adSize="BANNER"
                     ads:testDevices="TEST_EMULATOR, zzzzzzzzzzzz"
                     ads:loadAdOnCreate="true"/>
</LinearLayout> 
```

游戏以横向模式运行，我希望您将广告显示为顶部或底部的横幅，但没有显示任何测试广告，我不知道为什么会这样. 任何帮助都将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T14:20:05.327

在 xml 中使用下面的代码说 xml 名称是`adview.xml`

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
          android:id="@+id/adView"
          android:orientation="vertical"
          android:layout_width="fill_parent"
          android:layout_height="50dip"/> 
```

现在在您的活动中加载广告。

```
 AdView adView = new AdView(this,AdSize.BANNER,"yourid");
 LinearLayout ll= (LinearLayout) findViewById(R.id.adView);
 ll.addView(adView);
 AdRequest ar = new AdRequest();
 ar.setGender(AdRequest.FEMALE);
 adView.loadAd(ar); 
```

您可以像这样在 xml 中的任何活动中包含此视图（xml）。

```
 <include layout="@layout/adview" />  // your xml 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T13:59:26.283

我有两个可能的想法给你：

1.  从 xml 中删除“zzzzzzzzzz”。

或者

1.  确保您使用的是 SDK 3.2 或更高版本。我最近用这种方法解决了一个类似的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-18T18:11:33.757

试试这个：

```
<?xml version="1.0" encoding="utf-8"?> 
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

    <com.google.ads.AdView
        android:id="@+id/ad"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        ads:adSize="BANNER"
        ads:adUnitId="@string/admob_publisher_id"
        ads:loadAdOnCreate="true" >
    </com.google.ads.AdView>

</RelativeLayout>

AdView adView = (AdView) findViewById(R.id.ad);
AdRequest adRequest = new AdRequest();
adView.loadAd(adRequest); 
```

# iphone - UIWebView 和 Richtext 文件

> ID：13440808
> 
> 赞同：3
> 
> 时间：2012-11-18T13:55:52.297
> 
> 标签：iphone, objective-c, ios, uiwebview, rtf

据我了解，该标准`UIWebView`能够显示许多扩展名的本地文件。由于我需要在我的应用程序中显示格式化文本，我认为这种方法是可行的方法。

因此，我创建了一个名为 test.rtf 的富文本文件，我目前正尝试在我的 web 视图中显示它。但是，我没有成功。我只看到一个空白屏幕，而不是我在 rtf 文件中键入的文本。

有人可以查看我的代码并指出我在实现中出错的地方吗？

头文件：

```
#import <UIKit/UIKit.h>
@interface MainViewController : UIViewController <UIWebViewDelegate> {
UIWebView * webView;
}
@end 
```

主文件：

```
#import "MainViewController.h"
@interface MainViewController ()
@end
@implementation MainViewController

- (id)init
{
self = [super init];
if (self) {
    // Customization at initialization
    self.view.backgroundColor = [UIColor clearColor];

    //Adding a webview to display richtext documents
    int webHeight = self.view.bounds.size.height;
    webView = [[UIWebView alloc] initWithFrame:CGRectMake(0.0, 150.0, 320.0, webHeight-150.0)];
    webView.dataDetectorTypes = NO;
    webView.scrollView.bounces = NO;
    webView.delegate = self;
    [webView setBackgroundColor:[UIColor clearColor]];
    [webView setOpaque: NO];
    [self.view addSubview:webView];
    }
return self;
}

- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view.

// Accessing richtext file
NSString *filePath = [[NSBundle mainBundle] pathForResource:@"test" ofType:@"rtf"];
NSURL *url = [NSURL fileURLWithPath:filePath];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
if (request) {
    // Additional configuration
}

//Adding the content of the webiew
[webView loadRequest:request];
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
} 
```

*   (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType { NSLog(@"委托调用"); // 在这里做任何你想做的事情 return YES; } @结尾

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T14:10:40.077

您应该设置您`UIWebView`的委托并返回`YES`。[UIWebViewDelegate 协议参考](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIWebViewDelegate_Protocol/Reference/Reference.html)说：

> webView:shouldStartLoadWithRequest:navigationType:
> 
> 在 Web 视图开始加载框架之前发送。

因此，您应该`YES`第一次返回以加载您的 test.rtf 文件。

正如您更新了您的问题。你需要设置

```
webView.delegate = self;
//webView.delegate = appDelegate;    // not this line 
```

# java - 当我从终端运行 java 程序时缺少属性文件

> ID：13440812
> 
> 赞同：0
> 
> 时间：2012-11-18T13:56:21.763
> 
> 标签：java, jar, terminal

要运行我的应用程序，我使用命令

```
 java -jar "/home/stelios/NetBeansProjects/Askisi1/dist/Askisi1.jar" 
```

但是，虽然我在此目录中有 config.properties 文件

```
 "/home/stelios/NetbeansProjects/Askisi1/config.properties" 
```

它在netbeans中正常运行但是当我尝试从终端运行它时会产生这个错误

```
 java.io.FileNotFoundException: config.properties (No such file or directory)
    at java.io.FileInputStream.open(Native Method)
    at java.io.FileInputStream.<init>(FileInputStream.java:138)
    at java.io.FileInputStream.<init>(FileInputStream.java:97)
    at askisi1.MainThread.main(MainThread.java:237) 
```

我的属性文件的正确位置应该是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:09:23.510

当您从终端运行程序时，您的当前文件夹将成为 java 应用程序的默认文件夹。因此，如果您希望看到`config.properties`您的应用程序，则需要将其复制到当前文件夹以`/home/stelios/NetbeansProjects/Askisi1/`从那里运行应用程序。

# scala - scalaz.Equal 是如何解决的

> ID：13440814
> 
> 赞同：2
> 
> 时间：2012-11-18T13:56:30.677
> 
> 标签：scala, implicit, scalaz

包中有`Equal`对象`scalaz`：

```
package scalaz

object Equal extends EqualLow {

  // ...

  implicit def Tuple3Equal[A: Equal, B: Equal, C: Equal]: Equal[(A, B, C)] = equal {
    case ((a1, b1, c1), (a2, b2, c2)) => a1 ≟ a2 && b1 ≟ b2 && c1 ≟ c2
  }

  //...
} 
```

编译器怎么可能知道，`implicit def Tuple3Equal`当我调用时会调用该方法：

```
import scalaz._
import Scalaz._

implicitly[Equal[Tuple3[Int,Int,Int]]]
//or
(1,2,3).=== (1,2,3) 
```

请注意，我只导入`scalaz._`包和`Scalaz._`对象，并且没有显式导入 scalaz.Equal._ 包含隐式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T14:20:53.557

因为在寻找 type 的隐含时，总是检查`Foo`伴随对象的。`Foo`有关隐式解析的完整描述，请参阅[此答案](https://stackoverflow.com/a/5598107/9204)。

# emacs - 在 Emacs 中同步文件

> ID：13440816
> 
> 赞同：0
> 
> 时间：2012-11-18T13:56:53.837
> 
> 标签：emacs, org-mode

我是 Emacs 的新手，我对计算不是很好。然而，几周前我发现了 Emacs，我对它的可能性感到非常惊讶。我期待将它用于 LaTeX 文档编辑、一些编程、创建我自己的 elisp 函数，当然还有使用 org-mode 创建计划和笔记。对我来说主要的不便之处在于我在多个地方（我的笔记本电脑、家用电脑和工作电脑）使用 Emacs。在工作中，我未经授权安装软件。如果我在我的 .emacs 文件或待办事项列表中进行了一些更改，我需要将其同步到任何地方。我正在使用保管箱，但这有点烦人，因为在工作中我需要下载它来覆盖旧的等等。我需要一些实用的建议来了解如何同步一些私人文件，在一个地方所做的更改可以快速加载到其他地方地方。

PS对不起我的英语不好:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-20T00:32:28.957

在 org-mode 的任务和事件方面，一种选择是与 Toodledo 服务器同步——大多数流行的移动计算设备都有 Toodledo 应用程序。该库位于以下链接：

[https://github.com/christopherjwhite/org-toodledo](https://github.com/christopherjwhite/org-toodledo)

我已经修改了`org-toodledo`库，使其表现得更像 Toodledo，在我的`.emacs`文件中，我使用：

```
(setq org-todo-keywords '(
  (sequence
  "Active(a)"
  "Next Action(n)"
  "Canceled(c)"
  "Hold(h)"
  "Reference(r)"
  "Delegated(d)"
  "Waiting(w)"
  "Postponed(P)"
  "Someday(s)"
  "Planning(p)"
  "|"
  "None(N)") ))

(setq org-toodledo-status-to-org-map '(
    ("Active" . "Active")
    ("Next Action" . "Next Action")
    ("Reference" . "Reference")
    ("Delegated" . "Delegated")
    ("Waiting" . "Waiting")
    ("Someday" . "Someday")
    ("Planning" . "Planning")
    ("None" . "None")
    ("Hold" . "Hold")
    ("Postponed" . "Postponed")
    ("Canceled" . "Canceled") )) 
```

此外，在库`"DONE"`中提到的任何地方`org-toodledo`，我都将其更改为`"None"`-- 我用于完成的任务/事件。

我还修改了代码的另一个区域，以便我可以像 Toodledo 一样拥有五 (5) 个优先级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T10:16:01.960

You can use Dropbox for sure, but you might also want to check [SugarSync](http://sugarsync.com) since it allows the option of sharing ANY file on your computer with any other device (and is also accessible online on their website).

My structure is like this:

I have a sugarsynced folder "school" where I have my LaTeX files (and pdf's) and R files that are shared. I make my homework, and in class I usually read my pdf's from my phone. Everything syncs automatically.

For my Emacs files, I use Dropbox: the good thing is that at other computers you can just make sure it looks exactly at the same folders.

You generally would like a structure as:

**.../Dropbox/Emacs/.emacs**

In my .emacs, you define all load-paths and requires, such as:

```
 (let ((base "/Username/Dropbox/emacs/.emacs.d/"))
  (add-to-list 'load-path base)
  (dolist (f (directory-files base))
    (let ((name (concat base "/" f)))
      (when (and (file-directory-p name) 
                 (not (equal f ".."))
                 (not (equal f ".")))
        (add-to-list 'load-path name))))) 
```

You should also set a customization file:

```
(setq custom-file "/path-to-dropbox/.emacs.d/emacs-custom.el")
(load custom-file) 
```

and store backups in a folder:

```
(setq backup-directory-alist '(("." . "/path-to-dropbox/.emacs.d/backups"))) 
```

I would suggest such a structure:

```
emacs-display.el    (any visual stuff)
macros.el
misc-functions.el
external-plugins.el  (file for loading external packages and adjusts settings)
keybindings.el  (all your keybbindings) 
```

You also set mode association for loading your personal file, for example for LaTeX:

```
(eval-after-load 'latex '(load "/path-to-dropbox/.emacs.d/personal-emacs-latex")) 
```

In this you can put all the customization for whenever you are using LaTeX.

**.../Dropbox/Emacs/.emacs.d**

In this folder the actual files stored. It becomes really easy to remove something when it wouldn't work for whatever reason.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T15:05:57.960

Emacs 在设计上是可移植的。不依赖于任何平台特定的功能。

所以，理论上，你在这里描述的问题归结为一个纯粹的文件同步问题。如果我说得对，真正的限制是贵公司施加的公司限制。

我认为 DropBox 使用起来很乏味，因为不允许您使用创建完整集成的应用程序，但您受限于 Web 界面......如果是这种情况，您可能会受到所有其他应用程序的限制备择方案。

在这些环境中，我建议的一种选择是安装 Emacs，或者至少将您的 .emacs 文件夹安装在 USB 记忆棒上（我喜欢微型 USB 记忆棒，它看起来像鼠标加密狗，几乎不引人注意）。

您将能够在任何地方使用 emacs，如果您担心备份，您始终可以在您正在使用的另一台机器上实施手动或自动备份解决方案，并且您拥有更多访问权限。

# c++ - glEnd 上的无效操作无缘无故？

> ID：13440817
> 
> 赞同：9
> 
> 时间：2012-11-18T13:57:02.803
> 
> 标签：c++, opengl

我已经在一个 GL 程序上工作了一段时间，突然它开始出现错误。在尝试解决这些问题一段时间后，我编写了一个生成相同行为的简短测试程序：

```
#include <GL/glut.h>
#include <iostream>

#define CHECK_GL_ERR() printError(__LINE__)

void printError(int line)
{
        GLenum err = glGetError();
        if(err != GL_NO_ERROR)
        {
                std::cerr << "GL error on line " << line << ": " << gluErrorString(err) << std::endl;
        }
}

void displayFunc()
{
        CHECK_GL_ERR();
        glBegin(GL_POINTS);
        CHECK_GL_ERR();
        glVertex3f(0, 0, 0);
        CHECK_GL_ERR();
        glEnd();
        CHECK_GL_ERR(); //line 23
        exit(0);
}

int main(int argc, char **argv)
{
        glutInit(&argc, argv);
        glutInitWindowSize(300, 300);
        glutCreateWindow("Test");

        glutDisplayFunc(displayFunc);

        glutMainLoop();
} 
```

当我运行这个程序时，它会给出输出：

```
GL error on line 23: invalid operation 
```

所以似乎`glEnd();`导致错误。文档说：

> GL_INVALID_OPERATION 如果执行 glEnd 而前面没有 glBegin 则生成。

在我的代码中不是这种情况。那么有没有人看到，为什么这段代码会给出错误消息？

PS：当然我知道 glBegin/End 已经被弃用/删除了很长时间，但是将一些少量代码组合在一起非常方便。在 GL 决定脾气暴躁之前，该程序也可以正常运行。

**编辑**

我刚刚用 glslDevil 做了一个跟踪，它给出了：

```
W! Program Start
|  glXQueryExtension(0x1ab03f0, (nil), (nil))
|  glXChooseFBConfig(0x1ab03f0, 0, 0x7fffb8fcf8b0, 0x7fffb8fcf8a4)
|  glXGetVisualFromFBConfig(0x1ab03f0, 0x111)
|  glXGetProcAddressARB(0x7f93c37526e5)
|  glXCreateNewContext(0x1ab03f0, 0x111, 32788, (nil), 1)
|  glXIsDirect(0x1ab03f0, 0x1ac8de8)
|  glXMakeContextCurrent(0x1ab03f0, 123731970, 123731970, 0x1ac8de8)
|  glXMakeContextCurrent(0x1ab03f0, 123731970, 123731970, 0x1ac8de8)
|  glDrawBuffer(GL_FRONT)
|  glReadBuffer(GL_FRONT)
|  glXMakeContextCurrent(0x1ab03f0, 123731970, 123731970, 0x1ac8de8)
|  glViewport(0, 0, 300, 300)
|  glXMakeContextCurrent(0x1ab03f0, 123731970, 123731970, 0x1ac8de8)
|  glXMakeContextCurrent(0x1ab03f0, 123731970, 123731970, 0x1ac8de8)
|  glGetError()
|  glBegin(GL_POINTS)
|  glGetError()
|  glVertex3f(0,000000, 0,000000, 0,000000)
|  glGetError()
|  glEnd()
W! OpenGL error GL_INVALID_OPERATION detected
|  glGetError()
|  glXMakeContextCurrent(0x1ab03f0, 123731970, 123731970, 0x1ac8de8)
|  glXDestroyContext(0x1ab03f0, 0x1ac8de8)
E! Child process exited
W! Program termination forced! 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-18T16:25:11.970

经过一些测试，我发现你的程序有两个简单的问题：

1.  不得在 glBegin/glEnd 块内使用 glGetError。[API](http://www.opengl.org/sdk/docs/man2/xhtml/glGetError.xml)对此很严格。但是错误只发生**在**glEnd 之后。如果您阅读 API，您会发现错误可能会传播：它只发生在 glEnd 之后。
2.  当您在显示函数中使用 exit(0) 时会发生分段错误**（**这只发生在 Intel 驱动程序中。）这是因为 GL 上下文尚未被释放，并且出现了驱动程序错误。所以你应该避免退出显示功能。

# java - 是否可以使用 JDBC 持久化 POJO？

> ID：13440819
> 
> 赞同：2
> 
> 时间：2012-11-18T13:57:54.397
> 
> 标签：java, jpa, jdbc, pojo, persist

愚蠢的问题：我想知道是否可以像使用 JPA 一样使用 JDBC 持久化 POJO？

假设我有包含一个字段的“A”类

```
public class A implements Serializable{

    public String someString = "asd";
} 
```

现在假设我有一个`A`( `A myA = new A();`) 的实例。

我的问题是：是否可以使用 JDBC 保留“myA”，或者我是否必须保留字符串。或者当我想加载“myA”时，我可以加载实例“myA”，还是必须通过加载字符串来构建“myA”并使用加载的字符串创建一个新的实例表单 A。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T14:09:26.790

您可以将序列化的 Java 对象存储到数据库中；例如，通过使用 Blob 类型。

但这通常不是一个好主意：

*   执行 SQL 查询以任何重要的方式测试序列化对象的状态是不切实际的。

*   序列化的对象往往对对象代码的变化很敏感。处理这个可能会很尴尬，不处理它会在数据库中留下无法再反序列化的序列化对象。

如果要将 POJO 持久化到关系数据库，最好使用对象-关系映射，例如 JPA 或 Hibernate。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T14:05:14.120

您将不得不以某种方式进行映射（在持久化和检索之前）。

一种方法是创建我喜欢调用 fillX 的方法，您可以在其中手动进行映射（java 代码）或创建某种约定，例如类中的名称和 DB 中的列。

[例如，这在Spring JDBC](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/jdbc.html)中做得很好。在文档中，您可以看到谁做了什么。

在大多数情况下，使用 JPA 之类的对象关系映射将是可行的方法，但这并不总是一种选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T13:59:11.067

通常，您可以使用 JDBC 持久化字节流。在这种情况下，您应该使用 BLOB（如果它是文本流，则使用 CLOB）。

因此，如果您的 A 类真的实现了 Serializable 接口，您可以将其序列化为字节流并存储。

但是，我仍然建议您改为存储字符串。这是因为使用 BLOB/CLOB 的工作比使用字符串要慢得多。

希望这可以帮助

# cakephp - cakephp 2.0 如何更新认证数据？

> ID：13440820
> 
> 赞同：14
> 
> 时间：2012-11-18T13:57:55.887
> 
> 标签：cakephp, cakephp-2.0

当我更新用户模型中的数据时，身份验证数据不会更新。

更新用户模型时，如何“刷新” $this->Auth->user() 返回的数据？

我不想使用

> $this->Auth->login($data);

更新我的用户表后

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-26T05:28:57.410

我尝试了以下行。它对我来说效果很好修改用户数据后，我写了以下行

```
 $this->Session->write('Auth', $this->User->read(null, $this->Auth->User('id'))); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-18T14:54:40.647

将更新的数据写入 Session 例如：

```
$this->Session->write('Auth.User', $data); 
```

在 CakePHP 2.x 之前，你不能在模型中这样做而不破坏框架设计。

使用 CakePHP 2.x，您可以从模型中加载会话组件并对其进行更新。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-18T19:16:00.840

evert0ns 的答案是正确的。但是您应该使用 AuthComponent::login()，因为数据也保存在 AuthComponent 中，并且不会每次都从会话中获取。

几天前我遇到了这个问题。

```
// AppController.php
/**
 * Renews current user data, e.g. in case of an email address change while being logged in.
 *
 * @param array $newUserData
 * @return void
 */
    protected function renewUserSession($newUserData){
            if(!isset($newUserData) || empty($newUserData)){
                    return;
            }

            // We need to fetch the current user data so custom indexes are copied
            $currentUserData = $this->Auth->user();
            if(!isset($currentUserData) || empty($currentUserData)){
                    return;
            }

            // Merge old with new data
            $newUserData = array_merge($currentUserData, $newUserData);

            // Login with new data
            $this->Auth->login($newUserData);
    } 
```

来源：[我的贴](http://pastebin.com/XmEdp6Z3)

把它放在你的 AppController 中。该方法专门用于合并当前和新用户数据，以保留您可能提供的现有自定义索引。我需要这个，但你可以忽略它。将更新的用户数据作为参数提供给该方法。不在模型中查找形式。例如：

```
$data = array(
    'User' => array(
        'username' => 'bla',
        'passwort' => 'fu',
        'email' => 'hu@bar.com'
    )
);

// Wrong
$this->renewUserSession($data);

// Right
$this->renewUserSession($data['User']); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-08T16:47:27.020

`afterSave`我使用模型中的函数解决了这个问题`User`。如果我们从任何区域更新用户模型，它工作正常。我的代码如下：

```
class User extends AppModel {
    ... ... ...
    public function afterSave($created, $options = array()){
        parent::afterSave($created,$options);

        //updating authentication session
        App::uses('CakeSession', 'Model/Datasource');
        CakeSession::write('Auth',$this->findById(AuthComponent::user('id')));

        return true;
    }
    ... ... ...
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-21T09:03:38.697

**CakePHP 4**答案：-

`$this->Authentication->getResult()->getData()->offsetSet('fullname', $user->fullname);`

where`fullname`将替换为您已更改的用户实体的字段名称。

可能有更好的方法，但这是我玩了很多之后发现的（此时 CakePHP 4 API 尚未发布[https://api.cakephp.org/4.0/](https://api.cakephp.org/4.0/)）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-19T04:19:07.693

我认为func0der的回答很好，但可能会有所改进：

```
protected function renewLogin() {
    if(!empty($this->Auth->user())) {
        $this->loadModel('User');
        $this->User->contain(false);
        $user = $this->User->read(null, $this->Auth->user('id'))['User'];
        unset($user['password']);
        $this->Auth->login($user);
    }
} 
```

您可以将其添加到您的 AppController.php 并在修改登录用户后从任何控制器使用它。

我相信它更干净，即使它意味着对数据库的访问，我认为它不会经常执行到足以成为问题的地步。

您应该始终尝试以“蛋糕”的方式做事。并避免使用诸如编辑会话变量之类的快捷方式。从长远来看，它会让你的事情变得更容易。

请发表评论并添加您的意见:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-29T18:56:53.387

我认为更简单的方法是：

```
$user = $this->Auth->user();
$user['attribute'] = $newValue;
$this->Auth->setUser($user); 
```

# c# - 如何通过同一个 webclient（带有 cookie）实例进行序列 http 请求

> ID：13440824
> 
> 赞同：1
> 
> 时间：2012-11-18T13:58:19.690
> 
> 标签：c#, windows-phone-7, webclient

请考虑我的情况：

我正在开发一个 windows phone 7 应用程序，它将 HTTP POST 请求发送到我们学校的一台服务器以从中获取一些信息。当您访问该网站时，它会显示一个验证码图像，您需要输入您的学校编号、密码以及验证码才能登录。然后，您可以访问任何您想要的内容。

我有经验证实，服务器会在cookie上写入客户端以确保您已登录。但我们知道Windows手机中的[WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient%28v=vs.95%29.aspx)或[HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest%28v=vs.95%29.aspx)类都只支持异步操作。如果我想实现登录过程，我必须在getVerifyCode() 方法的uploadStringCompleted 方法中编写代码。我认为这不是最佳做法。例如：

（注意：这只是一个例子，不是真正的代码，因为要获取验证码我只需要一个GET方法HTTP请求，我认为它可以很好地说明问题让我感到困惑）

```
public void getVerifyCode()
{
    webClient.uploadStringCompleted += new uploadStringCompleted(getVerifyCodeCompleted);
    webClient.uploadStringAsync(balabala, balabala, balabala);
}

private void getVerifyCodeCompleted(object sender, uploadStringCompletedArgs e)
{
    if(e.Error == null)
    {
        webClient.uploadStringCompleted -= getVerifyCodeCompleted;

        // start log in 
        // I don't submit a new request inside last request's completed event handler
        // but I can't find a more elegent way to do this.
        webClient.uploadStringCompleted += loginCompleted;
        webClient.uploadStringAsync(balabala, balabala, balabala);
    }
} 
```

所以简而言之，我想知道解决上述问题的最佳实践或设计模式是什么？

提前非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T23:46:59.420

这是使用 HttpWebRequest.BeginGetRequestStream / EndRequestStream 的代码片段：

```
HttpWebRequest webRequest = WebRequest.Create(@"https://www.somedomain.com/etc") as HttpWebRequest;
webRequest.ContentType = @"application/x-www-form-urlencoded";
webRequest.Method = "POST";

// Prepare the post data into a byte array
string formValues = string.Format(@"login={0}&password={1}", "someLogin", "somePassword");
byte[] byteArray = Encoding.UTF8.GetBytes(formValues);

// Set the "content-length" header 
webRequest.Headers["Content-Length"] = byteArray.Length.ToString();

// Write POST data
IAsyncResult ar = webRequest.BeginGetRequestStream((ac) => { }, null);
using (Stream requestStream = webRequest.EndGetRequestStream(ar) as Stream)
{
    requestStream.Write(byteArray, 0, byteArray.Length);
    requestStream.Close();
}

// Retrieve the response
string responseContent;    

ar = webRequest.BeginGetResponse((ac) => { }, null);
WebResponse webResponse = webRequest.EndGetResponse(ar) as HttpWebResponse;
try
{
    // do something with the response ...
    using (StreamReader sr = new StreamReader(webResponse.GetResponseStream()))
    {
        responseContent = sr.ReadToEnd();
        sr.Close();
    }
}
finally
{
    webResponse.Close();
} 
```

请注意，您应该使用 ThreadPool.QueueUserWorkItem 执行它，以保持 UI/主线程响应。

# java - 将应用程序连接到 postgres 数据库

> ID：13440828
> 
> 赞同：1
> 
> 时间：2012-11-18T13:58:45.913
> 
> 标签：java, android, postgresql, rest

> **可能重复：**
> [驱动 JDBC PostgreSQL 与 Android](https://stackoverflow.com/questions/10435609/driver-jdbc-postgresql-with-android)

我正在创建一个需要连接到我的服务器的应用程序，该服务器有一个 postgis 数据库，其中包含需要从中检索然后显示在 Android 应用程序上的地图上的地理空间数据。

目前我有一个简单的 java 程序，它运行在使用 JDBC 从数据库中检索数据的服务器上。

我想知道让我的应用程序连接到这个 java 程序并请求 postgis 数据的最佳方法是什么，这将导致 java 服务器程序将此数据返回给 Android 应用程序。

您认为我应该为此使用 REST 还是有更好的方法？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:00:59.880

我不会直接连接到数据库。

REST 听起来是个好主意。

如果数据量不是很大，也许您可​​以在设备上使用某种本地缓存。通过这种方法，您可以在没有互联网连接的情况下使用该应用程序。

# linux - Jenkins 的间歇性构建失败

> ID：13440829
> 
> 赞同：3
> 
> 时间：2012-11-18T13:58:46.527
> 
> 标签：linux, git, build, jenkins

我在 Jenkins 中有一个项目（在 linux 上运行），它以定义的时间间隔轮询 SCM 并基于新的更改进行构建。我使用以下控制台输出间歇性地出现构建失败：

```
Started by user MyUser User
Building on master in workspace <http://ci.mybuild.com:8080/job/temp-project/ws/>
Checkout:workspace / <http://ci.mybuild.com:8080/job/temp-project/ws/> - hudson.remoting.LocalChannel@5f2c402a
Using strategy: Default
Cloning the remote Git repository
Cloning repository origin
FATAL: hudson/FilePath$11
java.lang.NoClassDefFoundError: hudson/FilePath$11
    at hudson.FilePath.deleteRecursive(FilePath.java:980)
    at hudson.plugins.git.GitAPI.clone(GitAPI.java:211)
    at hudson.plugins.git.GitSCM$2.invoke(GitSCM.java:1121)
    at hudson.plugins.git.GitSCM$2.invoke(GitSCM.java:1063)
    at hudson.FilePath.act(FilePath.java:851)
    at hudson.FilePath.act(FilePath.java:824)
    at hudson.plugins.git.GitSCM.checkout(GitSCM.java:1063)
    at hudson.model.AbstractProject.checkout(AbstractProject.java:1308)
    at hudson.model.AbstractBuild$AbstractBuildExecution.defaultCheckout(AbstractBuild.java:676)
    at jenkins.scm.SCMCheckoutStrategy.checkout(SCMCheckoutStrategy.java:88)
    at hudson.model.AbstractBuild$AbstractBuildExecution.run(AbstractBuild.java:581)
    at hudson.model.Run.execute(Run.java:1516)
    at hudson.model.FreeStyleBuild.run(FreeStyleBuild.java:46)
    at hudson.model.ResourceController.execute(ResourceController.java:88)
    at hudson.model.Executor.run(Executor.java:236) 
```

我尝试创建一个具有类似配置的新作业，但第一次构建失败并出现此错误。

有人可以帮我指点一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T07:08:31.550

在日志中查看 - **deleteRecursive**失败：

```
...
java.lang.NoClassDefFoundError: hudson/FilePath$11
    at hudson.FilePath.deleteRecursive(FilePath.java:980)
    at hudson.plugins.git.GitAPI.clone(GitAPI.java:211)
... 
```

这可能意味着您的文件系统阻止删除该区域中的文件 -
请检查那里的文件权限（也在文件夹上）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T16:21:02.593

这几乎肯定会发生，因为 Jenkins 正在尝试清理/删除另一个进程同时访问的文件。

看到此错误后立即尝试运行以下命令：

```
lsof /my/repo/dir 
```

这将告诉您哪些文件被锁定在您的 repo 目录中，以及是什么锁定了它们。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-27T19:49:26.570

**问题**

异常的性质是类加载之一。根据实际异常：

```
java.lang.NoClassDefFoundError: hudson/FilePath$11 
```

意味着JVM找不到类定义（显然）。"FilePath" 后面的美元符号和数字 ($11) 表示它找不到在 FilePath 类中定义的匿名内部类，可以在以下位置看到：

[https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/FilePath.java](https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/FilePath.java)

这支持了这个理论，因为有“FileCallable”的匿名实现。

**解决方案**

现在对于困难的部分，该怎么办。

我怀疑您正在某种形式的 Web 容器中运行 jenkins（在当前的问题形式中不知道）。Web 容器因其类加载特性而臭名昭著。如果可以，请尝试独立运行 jenkins，或在另一个容器中运行。

另外，您是否在容器启动时摆弄类路径？它是否在同一台机器上使用构建器奴隶？我建议先调查这些问题。

# jquery - 删除列表项后从列表中删除它

> ID：13440830
> 
> 赞同：0
> 
> 时间：2012-11-18T13:59:03.910
> 
> 标签：jquery, html, jquery-ui

我在搞乱一些代码，我有一个列表，我已经应用了可拖动函数，另一个 div 有一个 drop 函数。

我想要实现的是当列表元素被删除时，它会从父列表中删除并添加到另一个列表中。

这是我正在玩的代码：

```
 <div id='dAvail'>
<ul>
    <li><div class='abox'>1</div></li>
    <li><div class='abox'>2</div></li>
</ul>
</div>
<div id='somewhereToDrop'>
</div>
<div id='newListHere'>
<ul>
</ul>
</div> 
```

JS：

```
$(document).ready(function(){
//add the droppable function to the divs in main list
$('#dAvail ul).each(function(){
   $('li>div).draggable();
});

$('#somewhereToDrop').droppable({
   tolerance:'touch',
   drop:function(event,ui){
   //this is where I am having problems.
   //if I do ui.draggable I get an object representing the object I dragged but not 100% how to remove said object from the orginal list to then append to the new one.
   //this is what i tried.
   var t = ui.draggable[0]; //represents the div that i dropped.
   $(t).parent().parent().remove($(t).parent());
   //that is as far as I have gotten as this returns an error

}); 
```

如果有人能指出如何从列表中删除该对象，那就太好了。我什至试图看看我是否可以做 $(t).parent().eq() 但这不起作用，我的想法是获取列表索引然后像这样删除它。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:01:18.860

`remove()`不带参数。它从 DOM 中删除它的实例。所以，真的，你想要做的就是：

```
$(t).parent().remove(); 
```

# c++ - 如何检查输入是否为整数/字符串？

> ID：13440831
> 
> 赞同：1
> 
> 时间：2012-11-18T13:59:05.890
> 
> 标签：c++

我的问题是我不知道如何插入一个规则，如果用户在字符串上输入了一个数字，它会`cout`警告说它无效，与用户在成绩上输入字符串/字符相同。如何？我一直在尝试，但公式不起作用。

```
int x, cstotal = 100, extotal = 150;

double scorecs, exscore, labtotala, labtotalb, total;

string mystr = "";

cout << "Compute for: " << "\n" << "1\. Laboratory Grade " << "\n" << "2\. Lecture Grade" << "\n" << "3\. Exit" << "\n";
cout << "Please enter a number: ";
cin >> x;
switch (x) {
case 1:

    cout << "Compute for laboratory grade." << "\n";
    cout << "Enter Student Name: ";
    cin >> mystr;

    cout << "Good day, " << mystr << " . Please provide the following grades: " << "\n";
    cout << "CS Score: ";
    cin >> scorecs;

    cout << "Exam Score: ";
    cin >> exscore;

    labtotala = scorecs / cstotal * 0.6;
    labtotalb = exscore / extotal * 0.4;
    total = labtotala + labtotalb;
    cout << "Your Laboratory Grade is " << total * 100 << "\n";
    system("pause");
    break;
case 2:
    cout << "Compute for lecture grade." << "\n";
    cout << "Enter Student Name: ";
    cin >> mystr;
    cout << "Good day, " << mystr << " . Please provide the following grades: " << "\n";
    cout << "CS Score: ";
    cin >> scorecs;
    cout << "Exam Score: ";

    cin >> exscore;
    labtotala = scorecs / cstotal * 0.7;
    labtotalb = exscore / extotal * 0.3;
    total = labtotala + labtotalb;
    cout << "Your Lecture Grade is " << total * 100 << "\n";
    system("pause");
    break; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-18T14:08:18.870

`cin`[`failbit`](http://www.cplusplus.com/reference/iostream/ios/fail/)当它获得无效类型的输入时设置 a 。

```
int x;
cin >> x;

if (!cin) {
    // input was not an integer
} 
```

您还可以使用`cin.fail()`检查输入是否有效：

```
if (cin.fail()) {
    // input was not valid
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-18T14:08:16.313

像这样的东西怎么样：

```
std::string str;
std::cin >> str;

if (std::find_if(str.begin(), str.end(), std::isdigit) != str.end())
{
    std::cout << "No digits allowed in name\n";
} 
```

上面的代码循环遍历整个字符串，调用[`std::isdigit`](http://en.cppreference.com/w/cpp/string/byte/isdigit)每个字符。如果`std::isdigit`函数对任何字符返回 true，即它是一个数字，则[`std::find_if`](http://en.cppreference.com/w/cpp/algorithm/find)返回一个迭代器到字符串中找到它的那个位置。如果没有找到数字，`end`则返回迭代器。这样我们就可以看到字符串中是否有任何数字。

C++11 标准还引入了新的[算法函数](http://en.cppreference.com/w/cpp/algorithm)，可以使用，但基本做到以上。可以使用的一种是[`std::any_of`](http://en.cppreference.com/w/cpp/algorithm/all_any_none_of)：

```
if (std::any_of(str.begin(), str.end(), std::isdigit))
{
    std::cout << "No digits allowed in name\n";
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-01T11:27:04.033

```
 cout << "\n Enter number : ";
    cin >> ch;
    while (!cin) {
        cout << "\n ERROR, enter a number" ;
        cin.clear();
        cin.ignore(256,'\n');
        cin >> ch;
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-18T14:06:38.447

使用`.fail()`流的方法。如下所示：-

```
 cin >> aString;

  std::stringstream ss;
  ss << aString;
  int n;
  ss >> n;

  if (!ss.fail()) {
   // int;
  } else {
  // not int;
   } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-05-30T15:24:13.087

你可以用`cin.fail()`方法！当`cin`失败时`true`，您可以使用一个`while`循环来循环，直到`cin`is `true`：

```
cin>>d;
while(cin.fail()) {
    cout << "Error: Enter an integer number!"<<endl;
    cin.clear();
    cin.ignore(256,'\n');
    cin >> d;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-08T01:10:24.593

```
//this program really work in DEV c++
#include <iostream> 
using namespace std; 
int main()
{
    char input;
    cout<<"enter number or value to check"<<endl;
    cin>>input;
for(char i='a';i<='z';i++)
{
    if(input==i)
    {
        cout<<"character"<<endl;
        exit(0);
    }
}
for(int i=0;i<=1000;i++)
{
    if(input==i)
    {
        cout<<"number"<<endl;   
    }
}
} 
```

# iphone - UIButton 标题未出现或被剪切 - 仅最底部的标签

> ID：13440834
> 
> 赞同：4
> 
> 时间：2012-11-18T13:59:16.193
> 
> 标签：iphone, objective-c, cocoa, uibutton, storyboard

我有一个带有许多按钮的视图。无论我有 3、4 还是 5 个按钮，问题仍然存在。最底部的一个（具有最高 y 坐标）不显示其平铺。通过玩弄坐标，我发现标题有点被删减了。有关详细信息，请参阅屏幕截图。

我在这些示例之间更改的所有内容都是按钮的 y 坐标。它总是发生在屏幕最下方的按钮上。

![都在同一个级别就好了](../Images/70f5aac3bec113123d39f30a3b8a7745.png)

![最低的两个显示为空](../Images/0b54932e61dd151132e1ddcfb14fb910.png)

![当只有一个最低的，那么这个就显得空了](../Images/cfc3aa3bcb1225d21f6bc0c98e6e09c2.png)

![当 y 坐标的差异小于文本高度时，文本似乎以某种方式被截断。](../Images/79ed64891ef17d9ce1f2b96bde558d5d.png)

附加信息：我正在使用情节提要。视图层次结构：

```
- UIView (The default empty UIView that is linked to the view controller's self.view)
--- UIScrollView
------ UIImage (The background image. Deleting it does not change anything)
------ UIButton
------ UIButton
------ UIButton
-------Lots of constraints, automatically generated. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T10:46:22.423

尝试将所有遭受此问题的 UIButton的标题从更改`Plain`为。`Attributed`然后你可以把它们改回来`Plain`，它应该可以解决这个（奇怪的）问题。

![在此处输入图像描述](../Images/7a64c34e284365e8f36ce9a4e86e730a.png)

![在此处输入图像描述](../Images/1a25afb06fceec54eed023786f0be96c.png)

![在此处输入图像描述](../Images/d6b64acffd87f9e248aee95281371aba.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-19T19:36:35.597

我没有确定它的原因。我解决它的方法是删除这 3 个按钮并在 IB（故事板）中再次创建它们。

# javascript - jQuery：在表单选择焦点上，显示 div。隐藏 div 模糊

> ID：13440839
> 
> 赞同：1
> 
> 时间：2012-11-18T14:00:02.490
> 
> 标签：javascript, jquery, jquery-selectors

对不起我的英语不好

我有这个代码：

[jsfiddle](http://jsfiddle.net/mickeymic/gZSgW/2/)

没问题

当“选择”是这样的时，我如何调整代码：

```
<select id="example[164]" name="example[164]" type="text" />
<option value="0">0</option>    
<option value="1">1</option>    
<option value="2">2</option>    
<option value="3">3</option>    
</select>
<div class="test">    
Some text...<br /><input type="checkbox" name="foobar" value="1" /><br />More text...       
</div>` 
```

[jsfiddle](http://jsfiddle.net/mickeymic/AVjFK/2/)

谢谢你的帮助

:D)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T14:16:31.737

除 HTML5 外，此 HTML 无效。`[]`属性中不允许使用字符`id`，应为字母、数字、句点、连字符、下划线和冒号。

要将无效的 id 与 jQuery 匹配，您需要`[]`使用*两个*反斜杠来转义：

```
// Match all select elements beginning with example in the id
$('#example\\[164\\]') 
```

在您的示例的上下文中，更改`$('#example')`为`$('#example\\[164\\]')`

```
$('#example\\[164\\]').focus(function() {
    if (timer)
        clearTimeout(timer);
    $('div.test').css('display','block');
    // etc... 
```

后来也出现为：function(e){

```
 if ($(e.target).closest('.example, #example\\[164\\]').length) return; 
```

但是，由于这*不是*有效的 id 属性（除非您使用 HTML5），您应该改为匹配元素的`name`属性，如果这是在服务器端生成的，请将 id 属性更改为有效的值，例如`<select id='example_164'>`.

```
// [] are valid in a name
$('select[name="example[164]"').focus(function() {
    if (timer)
        clearTimeout(timer);
    $('div.test').css('display','block'); 
```

[这是更新的jsfiddle](http://jsfiddle.net/mickeymic/AVjFK/2/)

# javascript - 虽然不能保证 for..in 循环中的元素排序，但在实践中实现之间存在什么偏差？

> ID：13440846
> 
> 赞同：4
> 
> 时间：2012-11-18T14:00:14.660
> 
> 标签：javascript, object, for-loop, enumeration, for-in-loop

我不记得在哪里，但我曾经看到它说`for..in`循环可以按照实现者喜欢的任何顺序遍历元素，包括向前、向后、随机或在每次执行`for..in`循环时在向前和向后交替。但是，在实践中，不知何故，我不认为后者确实存在任何实现的情况。（虽然，我们知道有某个浏览器喜欢把事情搞砸，所以你永远不能太确定，但我离题了。）

我的观点是，虽然`for..in`在实践中可能没有那么严重的排序偏差，但我想知道 ECMAScript 实现之间存在什么偏差（如果有的话）。我想现在主要的应该是 JScript、Chakra、Futhark、Carakan、JavascriptCore、SquirrelFish、V8、SpiderMonkey 和 TraceMonkey，仅供参考。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T14:46:51.957

首先，这是规范中关于枚举顺序的参考：

> **[12.6.4 for-in 语句](http://es5.github.com/#x12.6.4)**
> 
> ***未指定枚举属性的机制和顺序（第一个算法中的步骤 6.a，第二个算法中的步骤 7.a）。**被枚举对象的属性可能在枚举过程中被删除。如果在枚举期间还没有访问过的属性被删除，那么它就不会被访问。**如果在枚举过程中向正在枚举的对象添加了新属性，则不能保证在活动枚举中访问新添加的属性。**在任何枚举中不能多次访问属性名称。*

我能想到的只有这些：

*   早期*（也许是当前？）*版本的 IE 会将枚举期间添加的新属性放在枚举的末尾，以便当前运行的`for-in`

*   V8 具有不同的枚举顺序，如[本错误报告](http://code.google.com/p/v8/issues/detail?id=164)中所述，该错误报告已作为*WorkingAsIntended关闭*

    ```
     var a = {"foo":"bar", "3": "3", "2":"2", "1":"1"}; 
    ```

    Firefox 和 V8 中的测试显示了不同的顺序。

这不是一个列表。当然可能还有更多。我认为@Pointy 的评论总结了这一点。没有保证。即使您有一个以一致方式可靠枚举的对象，这并不意味着它会在下一个版本升级时这样做。使用工具来指定它们如何工作，而不是仅仅为了*看起来*有效。

# ruby-on-rails - ubuntu 上的红宝石

> ID：13440848
> 
> 赞同：0
> 
> 时间：2012-11-18T14:00:32.420
> 
> 标签：ruby-on-rails, railstutorial.org

我最近刚刚安装了 ubuntu，我正在尝试让 ruby​​ on rails 启动并运行。我正在学习本教程 - [http://ruby.railstutorial.org/ruby-o...c-introduction](http://ruby.railstutorial.org/ruby-o...c-introduction)

当我运行 $ rails -v 或 $ rails new first_app 我收到以下错误...

程序 'rails' 可以在以下软件包中找到： *rails *ruby-railties-3.2 尝试：sudo apt-get install

作为 ubuntu 和 rails 的新手，我不知道在这里做什么。有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T14:10:04.567

安装 ruby​​、rails 等的最佳方式是通过 RVM。按照以下链接。他们会引导你完成。

[http://www.unfoldingcode.com/2011/05/using-rvm-to-install-rails-31-on-ubuntu.html](http://www.unfoldingcode.com/2011/05/using-rvm-to-install-rails-31-on-ubuntu.html) http://siliconchaos.com/2011/07/installing-rails-with-rvm /

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-16T12:27:10.540

以下是`Ruby on rails`在 Ubuntu 上设置的步骤：

1.  您需要导入 RVM GPG 密钥：

`gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3`

2.  然后安装 RVM

`curl -sSL https://get.rvm.io | bash -s stable`

3.  加载 RVM 脚本

`source ~/.rvm/scripts/rvm`

以下是创建新 Rails 应用程序的步骤：

```
1\. rails new demo 
2\. cd demo
3\. rake db:create
4\. rails server 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-16T12:38:41.327

试试这个链接。解释了安装 Ruby 的所有三种方法（RVM、rbenv 和通过源代码）以及为最新版本的 ubuntu 分别设置 rails，包括 DB 设置（MySQL 和 Postgres）。

[https://gorails.com/setup/ubuntu/17.04](https://gorails.com/setup/ubuntu/17.04)

# java - 找不到 Java SAXParserFactory 和 XMLParserConfiguration 文件

> ID：13440850
> 
> 赞同：2
> 
> 时间：2012-11-18T14:00:43.327
> 
> 标签：java, xml, applet

我正在运行一个应该将图片上传到网站的 java 小程序，上传失败并给出以下异常：

```
 java.security.AccessControlException: Access denied (java.net.SocketPermission 192.168.10.25 resolve) 
```

并且积压显示文件`SAXParserFactory`并不`XMLParserConfiguration`能被找到。

我已经尝试创建`crossdomain.xml`文件并授予打开权限，但它没有工作。我还为hosts文件添加了一些映射，因为我认为通过IP地址访问时系统可能无法映射但仍然没有区别。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T16:54:50.010

如果是访问限制问题，请尝试将访问文件的代码按如下方式放置；

```
AccessController.doPrivileged(new PrivilegedAction() {
        public Object run() {
            // privileged code goes here, for example:

        }
    }); 
```

# visual-studio - VisualStudio - 我可以在时间执行中创建一个控制元素吗？

> ID：13440854
> 
> 赞同：0
> 
> 时间：2012-11-18T14:01:16.927
> 
> 标签：visual-studio, directory, visual-studio-2012, checkbox

我有一个包含 100 个子文件夹的文件夹。我的应用程序有 20 个复选框。

当表单加载时，表单会检索所有文件夹名称并为每个复选框提供“checkbox.Text”属性。

显然，如果我只有 25 个复选框和 100 个文件夹，我会得到一个“indexOutOfRange”异常。

如何通过在时间执行中添加更多复选框来解决此问题？有可能吗？

PS：我是VS的初学者

谢谢你阅读

**更新**：语言是 VB.NET 项目是 windows 窗体

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:26:20.533

嗯，像

```
dim newCheckBox as new CheckBox()
newCheckBox.Text = "Foo"
targetControl.Controls.Add(newCheckBox) 
```

应该管用。根据父控件是什么以及它的布局属性是什么，您需要修改 newCheckBox 的属性以使它们与屏幕整齐对齐。

例如可以使用 FlowLayoutPanel。

# javascript - 如何使用 javascript 变量为附近的地方分配类型

> ID：13440866
> 
> 赞同：2
> 
> 时间：2012-11-18T14:03:09.153
> 
> 标签：javascript, api, google-maps

编辑：问题解决了我正在尝试使用这样的变量分配类型

```
 check = [];

if($("#transport").attr("checked"))
check.push('airport','bus_station','train_station','taxi_stand','travel_agency');

if($("#bars").attr("checked"))
check.push('bar','restaurant');

if($("#tourist").attr("checked"))
check.push('art_gallery','campground','museum','aquarium','zoo','library','amusement_park','park');

if($("#shopping").attr("checked")) 
```

check.push('shopping_mall','shoe_store','jewelry_store','grocery_or_supermarket','furniture_store','electronics_store','clothing_store','book_store');

```
 var tmp_types = "";
for(i=0;i<1;i++)
{
    tmp_types += '"'+check[i]+'"';
}

var request = {
    location: latlng,
    radius: '50000',
    types: [ tmp_types ]
  };

service = new google.maps.places.PlacesService(map);
service.nearbySearch(request, callback); 
```

但它不起作用...有人可以帮助我...谢谢

解决方案：只需使用 check 代替 tmp_types 并删除方括号..像这样的类型：检查.. 感谢 Bruno

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T14:29:45.907

您的 for 循环在 0 处退出，因为您的条件是`i < 1`

```
for( var i=0, len = check.length; i < len; i++ ) {
    // your code here
} 
```

此外，根据 API 文档，您正在调用的函数期望请求对象中的*类型*为：

> 包含 Google Places API 中列出的一种或多种受支持类型的数组：支持的地点类型列表。

所以只需像这样使用检查对象

```
var request = {
    location: latlng,
    radius: '50000',
    types: check
}; 
```

更多信息[在这里](https://developers.google.com/maps/documentation/javascript/places#place_search_requests)

# android - 使用静态字段在两个活动之间传输值

> ID：13440868
> 
> 赞同：1
> 
> 时间：2012-11-18T14:03:42.163
> 
> 标签：android, static

将值从第三类的静态字段转移`Activity A`到另一个有什么缺点，而不是？`Activity B``ExtraBundle`

在我的应用程序中，有时我需要在两个`Activity`s 之间传输 15 - 20 个值。在我看来，使用某种`TransferHandler`.

目前，我想到了一个缺点：当`Extras`启动`Activity`B 之前没有输入一个值时，我会得到一个`Exception`. 用静态字段解决，有可能是我忘记赋值了，如果这个值之前是从别的地方赋值的，可能是`Activity`B中使用了错误的值。不过，我认为这是一个“程序员问题” ” 而不是“程序问题”。那么还有其他缺点还是我可以自由选择一种方式？两种变体的性能如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T14:29:54.157

首先，如果您打算使用静态值，您应该使用您的`Application`类来执行此操作（因为 Android 系统向您保证它是一个真正的单例）

因此，您可以将数据存储在自定义应用程序类的属性中，并使用特定方法来存储和获取这些值。这将确保您不会“忘记”任何值。

另外，在 15-20 之间，我强烈建议您制作一个专门的 POJO 类来存储所有这些......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T14:48:26.240

我认为在android中使用静态类传递信息的最大缺点是系统可以随时清除静态字段和对象。这意味着任何静态非最终值都可以**​​始终**为空。

所以它可能在大多数情况下都可以正常工作，但是如果您不确定处理这些空情况并且您的用户开始使用您的应用程序，他们将偶尔遇到空指针异常崩溃，因为系统认为它需要存储在那些静态字段中的内存。

在我看来，在活动之间传递数据的最佳方式是使用 Intents，[请参阅此处以获取一个很好的示例](https://stackoverflow.com/a/2091482/969325)。或者使用数据库或[sharedpreferences](http://developer.android.com/reference/android/content/SharedPreferences.html)。

谷歌也有很好的阅读关于活动/服务之间的传递数据[here](http://developer.android.com/guide/faq/framework.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T14:20:56.747

您不能使用第三类将值从一个活动转移到另一个活动。这是它的问题。您在活动中创建一个对象-a，然后将一些值存储到其中。然后在使用这些值之后，您需要在活动 b 中再创建一个对象，然后在活动 b 中创建的对象将不会具有您在活动 a 中分配的值。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-18T14:39:25.683

您可以使用 SharedPreferences 类来存储变量的值：

```
SharedPreferences settings = getSharedPreferences("shared_pref", MODE_WORLD_READABLE);
    SharedPreferences.Editor editor = settings.edit();
    // With editor you put data
    editor.putString(firstName, "John");
    editor.putString(lastName, "Smith");
    editor.commit(); 
```

您可以在所有活动中访问此数据：

```
// With settings you access to data in different activities 
SharedPreferences settings = getSharedPreferences("shared_pref", MODE_WORLD_READABLE);

String firstName = settings.getString(firstName, null);
String lastName = settings.getString(lastName, null); 
```

# python - 使用 Celery 与 RQ 的优缺点

> ID：13440875
> 
> 赞同：119
> 
> 时间：2012-11-18T14:04:29.207
> 
> 标签：python, redis, celery, scheduled-tasks, python-rq

目前我正在研究需要实现一些后台作业（主要用于电子邮件发送和大量数据库更新）的python项目。我使用 Redis 作为任务代理。所以在这一点上，我有两个候选人：[Celery](http://celeryproject.org/)和[RQ](http://python-rq.org/)。我对这些工作队列有一些经验，但我想请你们分享使用这些工具的经验。所以。

1.  使用 Celery 与 RQ 的优缺点。
2.  任何适合使用 Celery 与 RQ 的项目/任务示例。

Celery 看起来很复杂，但它是功能齐全的解决方案。实际上，我认为我不需要所有这些功能。从另一面看，RQ 非常简单（例如配置、集成），但似乎缺少一些有用的功能（例如任务撤销、代码自动重新加载）

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2015-04-24T02:54:53.267

这是我在尝试回答完全相同的问题时发现的。它可能并不全面，甚至在某些方面可能不准确。

简而言之，RQ 被设计得更简单。芹菜被设计得更健壮。他们都很优秀。

*   文档。[RQ 的文档](http://python-rq.org/)全面而​​不复杂，并且反映了项目的整体简单性——您永远不会感到迷茫或困惑。[Celery 的文档](https://celery.readthedocs.org/en/latest/getting-started/brokers/redis.html)也很全面，但是当你第一次设置时，你会经常重新访问它，因为有太多的选项需要内化
*   监测。[Celery 的 Flower](https://github.com/mher/flower)和[RQ 仪表板](https://github.com/nvie/rq-dashboard)都非常易于设置，并为您提供至少 90% 的您想要的所有信息

*   经纪人支持。Celery 是明显的赢家，RQ 只支持 Redis。这意味着关于“什么是代理”的文档更少，但也意味着如果 Redis 不再适合您，您将来无法切换代理。例如，[Instagram 考虑了 Redis 和 RabbitMQ 与 Celery](https://blogs.vmware.com/vfabric/2013/04/how-instagram-feeds-work-celery-and-rabbitmq.html)。这很重要，因为不同的代理有不同的保证，例如 Redis*不能*（在撰写本文时）保证 100% 的消息被传递。

*   优先队列。RQs 优先队列模型简单而有效——[工作人员按顺序从队列中读取](http://python-rq.org/docs/workers/)。Celery 需要启动多个工人以从不同的队列中消费。两种方法都有效

*   操作系统支持。Celery 是明显的赢家，因为 RQ 只在支持`fork`Unix 系统的系统上运行

*   语言支持。RQ 仅支持 Python，而 Celery 允许您将任务从一种语言发送到另一种语言

*   API。Celery 非常灵活（多个结果后端、漂亮的配置格式、工作流画布支持），但这种能力自然会令人困惑。相比之下，RQ api 很简单。

*   子任务支持。Celery 支持子任务（例如从现有任务中创建新任务）。不知道RQ有没有

*   社区和稳定。Celery 可能更成熟，但它们都是活跃的项目。截至撰写本文时，Celery 在 Github 上拥有约 3500 颗星，而 RQ 拥有约 2000 颗星，这两个项目都显示出积极的发展

在我看来，Celery 并不像它的名声让你相信的那么复杂，但你必须使用 RTFM。

那么，为什么有人愿意用（可以说功能更全的）Celery 来换取 RQ？在我看来，这一切都归结为简单。通过将自身限制为 Redis+Unix，RQ 提供了更简单的文档、更简单的代码库和更简单的 API。这意味着您（以及您项目的潜在贡献者）可以专注于您关心的代码，而不必将有关任务队列系统的详细信息保存在您的工作内存中。我们所有人都对一次可以在脑海中存储多少细节有限制，通过消除在其中保留任务队列细节的需要，RQ 可以让您回到您关心的代码。这种简单性是以牺牲诸如跨语言任务队列、广泛的操作系统支持、100% 可靠的消息保证以及轻松切换消息代理的能力等特性为代价的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T16:05:53.590

芹菜没那么复杂。在其核心，您从 进行逐步配置[`tutorials`](http://celeryproject.org/tutorials/)，创建一个`celery`实例，使用 装饰您的函数，`@celery.task`然后使用 运行任务`my_task.delay(*args, **kwargs)`。

从您自己的评估来看，您似乎必须在缺少（关键）功能或有一些多余的功能之间做出选择。在我的书中，这不是一个太难的选择。

# javascript - AngularJs：有状态的客户端路由

> ID：13440876
> 
> 赞同：1
> 
> 时间：2012-11-18T14:04:30.310
> 
> 标签：javascript, angularjs, url-routing

这是我为提出这个问题而创建的演示以及所要求的内联代码：http: [//jsfiddle.net/Gncja/1/](http://jsfiddle.net/Gncja/1/)

```
<script type='text/ng-template' id='root.html'>
  <list template-id='sidebar.templateId' selected-item-id='sidebar.selectedItemId'></list>
</script>

<script type='text/ng-template' id='sidebar.html'>
<ul style='width:100%;' class='nav nav-list bs-docs-sidenav'>
  <li ng-repeat='item in data' ng-class="{active:item.id==selectedItemId}">
    <a ng-href='#/{{item.id}}'>
      <i class=icon-chevron-right></i>
      <span ng-bind='item.text'></span>
    </a>
  </li>
</ul>    
</script>

<body ng-app='main'>
  <div ng-view></div>
</body>​

function RootCtrl($scope, $routeParams){
  $scope.sidebar = {
    templateId: 'sidebar',
    selectedItemId: $routeParams.navItemId
  };
}

RootCtrl.$inject = ['$scope','$routeParams'];

angular.module('main', []).
  config(['$routeProvider', function($routeProvider) {
  $routeProvider.
      when('/:navItemId', {
        templateUrl: 'root.html',   
        controller: RootCtrl
      }).
      otherwise({redirectTo: '/1'});
}]).
directive('list', function(){
  return {
    restrict: 'E',
    replace: true,
    scope:{
      'templateId': '=',
      'selectedItemId':'='
    }, 
    template:'<ng-include src="templateUrl"></ng-include>',
    controller: function($scope, $element, $attrs){
      $scope.templateUrl = $scope.templateId + '.html';
      $scope.data = [
          {'id':'1', text:'lorem ipsum'},
          {'id':'2', text:'dolor sit amet'},
          ];

    }
  };
});​ 
```

这是我一直在处理的应用程序的一小部分，但它清楚地显示了它在做什么。页面中有导航菜单，菜单项是指向由初始化根控制器的 angular.js 路由处理的哈希的链接等，描述起来相当棘手，但代码示例清楚地表明了这一点。每次单击导航菜单项时，都会重新呈现整个页面内容的问题 - 路由是无状态的，它对以前的状态一无所知。当用户只是在菜单项（或浏览器历史记录）之间导航时，我想通过重新使用导航菜单数据/模板呈现结果来避免这种情况。可能吗？我确定是的，只是想看看有人有没有好主意。谢谢！

**更新：** 我发现了一些可能对我有帮助的东西： [http ://www.bennadel.com/blog/2420-Mapping-AngularJS-Routes-Onto-URL-Parameters-And-Client-Side-Events.htm](http://www.bennadel.com/blog/2420-Mapping-AngularJS-Routes-Onto-URL-Parameters-And-Client-Side-Events.htm)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T18:10:57.313

我会将导航菜单放在 ng-view 之外（因此它不会重新渲染），但是将 ng-class 与 location.path() 结合使用来区分当前选定的项目。例如，

```
<div ng-controller="navCtrl">
  <ul ...>
    <li ng-repeat='item in navData' ng-class="{active:isActiveRoute(item.id)}">
    ...
  </ul>
</div>
<div ng-view></div> 
```

然后在 navCtrl 中：

```
$scope.navData = [
  {'id':'1', text:'lorem ipsum'},
  {'id':'2', text:'dolor sit amet'},
];
$scope.isActiveRoute = function(route) {
   return '/' + route === $location.path();
}; 
```

[小提琴](http://jsfiddle.net/mrajcok/kFCqc/)

# facebook - 无法从 Chrome 扩展加载 facebook js sdk

> ID：13440882
> 
> 赞同：4
> 
> 时间：2012-11-18T14:04:57.193
> 
> 标签：facebook, google-chrome, google-chrome-extension, facebook-javascript-sdk

我正在尝试在 Chrome 扩展程序中使用 facebook sj sdk。我在我的扩展初始化上这样做：

```
window.fbAsyncInit = function() {
        // init the FB JS SDK
        FB.init({
            appId: 'APP_ID', // App ID from the App Dashboard
            //channelUrl : '//www.example.com/', // Channel File for x-domain communication
            status: true, // check the login status upon init?
            cookie: true, // set sessions cookies to allow your server to access the session?
            xfbml: true  // parse XFBML tags on this page?
        });

        // Additional initialization code such as adding Event Listeners goes here
        console.log(FB);

    };

    // Load the SDK's source Asynchronously
    (function(d, debug) {
        var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
        if (d.getElementById(id)) {
            return;
        }
        js = d.createElement('script');
        js.id = id;
        js.async = true;
        js.src = "http://connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
        ref.parentNode.insertBefore(js, ref);
    }(document, /*debug*/false)); 
```

我收到此错误：

**拒绝加载脚本“http://connect.facebook.net/en_US/all.js”，因为它违反了以下内容安全策略指令：“script-src 'self' chrome-extension-resource:”。**

我将清单中的权限设置为`http://*/`. 如何从扩展加载 sdk？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T19:59:30.327

这是因为您正在尝试从 Chrome 扩展程序加载外部脚本。出于安全原因以防止跨站点脚本，您需要在`manifest.json`文件中具有特殊权限。

```
"content_security_policy": "script-src 'self' https://connect.facebook.net; object-src 'self'" 
```

确保使用 https:// 而不是 http://。

# html - 负边距的概念 - 我明白了吗？

> ID：13440883
> 
> 赞同：2
> 
> 时间：2012-11-18T14:05:01.857
> 
> 标签：html, css, margin

我读到负边距顶部和左侧采用元素并将其推向这个方向。另一方面，负的底部和右侧边距将其余内容绘制在元素上。

问题

我有一个浮动元素 float:right; 包裹在body标签中。负左边距会将其移动到左边。

负的 RIGHT 边距根本不会做任何事情，因为文档在这个负边距开始的地方结束并且没有任何东西可以覆盖元素（或拉过它）？

我对么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T14:28:20.910

负边距将始终以与正边距相同的方式在块框上起作用。他们只是在与正边距相反的方向移动一个盒子和/或周围的盒子。哎呀，负利润率甚至会[崩溃](http://www.w3.org/TR/CSS21/box.html#collapsing-margins)。

如果发生任何溢出，则相关框将调整并适应该框的移动。

如果一个元素在某个方向上浮动，那么它被浮动的一侧的边距会影响它自己的位置，而相对位置上的边距会相对于任何后续的浮动来影响它。

> 负的 RIGHT 边距根本不会做任何事情，因为**文档在这个负边距开始的地方结束**并且没有任何东西可以覆盖元素（或拉过它）？

不，有一个东西叫做[画布](http://www.w3.org/TR/CSS21/intro.html#the-canvas)，理论上有无限的扩展空间。是否有将元素推出页面主体或页面根目录的边距？NBD，只需在那个方向展开画布，在用于显示此画布的视口中制作一个滚动条，就完成了。

这就像您在其父元素上具有负边距一样`overflow: auto`，因为[根元素本身`overflow: auto`默认](http://www.w3.org/TR/CSS21/visufx.html#overflow)具有（因为您不能真正让东西明显溢出浏览器窗口本身......）。

[jsFiddle 概念验证](http://jsfiddle.net/BoltClock/rXz9w)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T14:17:52.087

负右边距确实有效！[http://fiddle.jshell.net/H6mjC/](http://fiddle.jshell.net/H6mjC/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T14:26:33.957

还做了一个小提琴。当然负边距是有效的。

[摆弄负边距](http://jsfiddle.net/kasperfish/hVxpF/4/)

![在此处输入图像描述](../Images/eb778c1c440557ddf22574136cac3bb3.png)

```
enter code here 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-18T14:41:26.760

许多人对负利润率也有同样的误解。您描述的行为往往与许多负边距案例相匹配，但它是从有缺陷的角度解释它们。实际上，负边距在框的*任何*一侧都具有相同的效果，但在“移动框”或“在其中绘制其他内容”方面则不然。

例如，a`left-margin: -20px`表示“将元素定位为好像其左边缘距其真正的左边缘向内 20 像素”。A`right-margin: -20px`表示完全相同的东西，但用于右边缘。

在您提供的简单描述中，负左边距确实会将元素本身向左移动，因为它的*左边缘与前一个元素的**右边缘*相邻，但浏览器会假装我们元素的左边缘实际上是*向右移动*的，所以元素本身的内容出现*向左移动*。

使用负的右边距，浏览器将下一个元素的*左边缘*与我们元素的*右*边缘相邻，但它假装我们的元素的*右边缘**向左移动*，因此下一个元素本身看起来*向左移动*。

在这两种情况下，唯一改变的是浏览器对元素边缘位置的概念。

当你有一个右浮动元素时，浏览器会定位它，使其右边缘与前一个右浮动元素的左边缘相邻，或者如果没有前一个右浮动元素，它将与其位置父元素的*右*边缘（它是最近的父元素，其`position`样式不是`static`）。在您的情况下，您没有先前的右浮动元素，因此浏览器定位您的元素，使其*右边缘与父元素的右**边缘*相邻，但它假装您的元素的右边缘*向左移动*，因此您的实际内容是*向右移动*，突出到父元素之外。

[这是一个演示](http://jsbin.com/uxuheq/1/edit)。带有蓝色边框的框的左右边距为负数。它里面的黄色框代表浏览器如何看待它——它比蓝色边框的框窄，因为负边距告诉浏览器向内移动它的边缘，从元素的实际大小中吸取。如您所见，它的定位框与任何元素的放置方式完全相同，在两侧接触其左右兄弟姐妹。并且实际内容在两个方向上的扩展量完全相同，因为它的负边距是相同的。*感知到的*变化是元素本身由于其左边距而向左移动，而随后的内容由于其右边距而向左移动，但是正如您所看到的，实际上，两边的效果完全相同。

# django - 高效选择不同类别的最新商品

> ID：13440885
> 
> 赞同：2
> 
> 时间：2012-11-18T14:05:05.560
> 
> 标签：django, performance, django-queryset

考虑以下模型：

```
 class Data(Model):
        created_at = models.DateTimeField()
        category = models.CharField(max_length=7) 
```

我想为所有类别选择最新的对象。

在[这个问题](https://stackoverflow.com/questions/6429518/django-query-latest-posts-from-different-categories)之后，我选择了不同的类别，然后对它们中的每一个进行单独的查询：

```
 categories = Data.objects.distinct('category').values_list('category', flat=True)
    for category in categories:
        latest_obj = Data.objects.filter(category=category).latest('created_at') 
```

该方法的缺点是它会进行大量查询（1 个用于不同类别，然后每个类别单独查询）。

有没有办法用一个查询来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T15:05:17.010

通常，您会在关系数据库中使用 group by。Django 有一个聚合 API (https://docs.djangoproject.com/en/dev/topics/db/aggregation/#aggregation)，它允许您执行以下操作：

```
from django.db.models import Max
Data.objects.values('category').annotate(latest=Max('created_at')) 
```

这将执行单个查询并返回如下列表：

```
[{'category' : 'cat1', 'latest' : '01/01/01' },{'category' : 'cat2' 'latest' : '02/02/02' }] 
```

但我想您可能还想在此列表中检索数据记录 ID。在这种情况下，Django 不会让你觉得简单。问题是 django 使用 value 子句中的所有字段进行分组，并且您不能从查询中返回额外的列。

**编辑**：我最初建议在基于 Web 资源的查询末尾添加第二个 values() 子句，但这不会在结果集中添加额外的列。

# android - QueryBuilder 上的 OrmLite join() 替换了以前的 join()？

> ID：13440886
> 
> 赞同：0
> 
> 时间：2012-11-18T14:05:07.107
> 
> 标签：android, sqlite, ormlite, android-sqlite

我在 android 中使用 ormlite。图书馆似乎很有帮助，但我对 QueryBuilder 有疑问。我将尝试用一些抽象的例子来解释这一点。假设我们有 4 个表：Projects、Employees、Country、ActiveProject。单个项目可以有多个员工，但员工只能在一个项目上工作。员工来自一个国家。ActiveProject 表有一行表示当前活动的项目。

现在我想列出来自指定国家（“en”）的所有员工，这些员工为当前活动的项目工作。

```
//retrieving Daos:
Dao<Projects, Long> projectDao = helper.getDao(Projects.class);
Dao<Employees, Long> employeeDao = helper.getDao(Employees.class);
Dao<Countries, Long> countryDao = helper.getDao(Countries.class);
Dao<ActiveProject, Long> activeProjectDao = helper.getDao(ActiveProject.class);

//retrieving QueryBuilder
projectQb = projectDao.queryBuilder();
employeeQb = employeeDao.queryBuilder();
countryQb = countryDao.queryBuilder();
activeProjectQb = activeProjectDao.queryBuilder();

//constructing query:
//add WHERE statement for country
countryQb.where().eq(Countries.NAME,"en");
employeeQb.join(countryQb);
//so far so good, when I query from employees here, I'll get all employees from "en"

//limit the results to active project only
projectQb.join(activeProjectQb);
//if I query the projectQb for all projects, I'll get only the active one - as expected.
//but here the problem starts
employeeQb.join(projectQb); 
```

现在，employeeQb.query() 将列出属于活动项目的所有员工，但来自所有国家。“Employees-Country join”和“WHERE”语句已经消失。

我在这里做错了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T03:38:40.473

Unfortunately, at this time, ORMLite only supports JOINs with a single other table. Multi-table joins are not supported at this time. Feel free to add an item to the [feature request](http://sourceforge.net/p/ormlite/feature-requests/) part of the SourceForge site.

If you need to do the multi-table join then you can use the [raw query functionality](http://ormlite.com/docs/raw-queries) but you will have to interpret the results yourself.

# c++ - 指向寄存器变量的指针

> ID：13440890
> 
> 赞同：0
> 
> 时间：2012-11-18T14:05:33.400
> 
> 标签：c++, pointers

> **可能重复：**
> [寄存器变量的地址](https://stackoverflow.com/questions/1256246/address-of-register-variable)

```
register int yy = 6;
int * myptr = &yy;
cout<<myptr<<" "<<&yy<<" "<<*myptr<<" "<<yy<<endl; 
```

Deitel和Deitel第三版C++如何编程：第307页最后一行说——地址运算符不能应用于用存储类寄存器声明的变量。上面的代码怎么打印出来的：0x28ff24 0x28ff24 6 6

我是否遗漏了一些关于指向具有寄存器存储类的变量的指针？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T14:07:36.260

编译器忽略您的`register`请求，因为您的代码采用`yy`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T14:41:48.967

你的书已经过时了。

在现代 C++ 中，`register`不推荐使用关键字，并且对声明没有影响（除了可能向编译器提示该变量可能被大量使用）。它不会阻止您获取变量的地址。

C确实有这个限制；并且可能旧版本的 C++ 也有，但我没有任何历史文件可以证实这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T14:10:43.550

[寄存器变量地址](https://stackoverflow.com/questions/1256246/address-of-register-variable)重复

另外，这里是 IBM 为其编译器之一提供的关于此事的文档：

[http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=%2Fcom.ibm.xlcpp8l.doc%2Flanguage%2Fref%2Fregdef.htm](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=%2Fcom.ibm.xlcpp8l.doc%2Flanguage%2Fref%2Fregdef.htm)

# windows - Win32 - CRITICAL_SECTION 结构是否必须具有特定的（4/8 字节）对齐？

> ID：13440892
> 
> 赞同：0
> 
> 时间：2012-11-18T14:06:08.063
> 
> 标签：windows, alignment, deadlock, critical-section

我正在开发一个默认使用 1 字节对齐的项目，包括在使用 CRITICAL_SECTION 结构的地方。我正在调查某个死锁，我可以看到导致问题的 CRITICAL_SECTION 结构中的数据无效.. 对齐会是问题吗？（我还可以看到，对于这个特定的 CRITICAL_SECTION，对齐确实是 1（奇数地址）..）

谢谢，阿米特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T14:10:43.757

Windows 头文件[需要`/Zp8`打包](http://blogs.msdn.com/b/oldnewthing/archive/2009/04/22/9560726.aspx)。您必须遵守头文件指定的包装。

# hibernate - Hibernate 替代方案中的 buildSessionFactory

> ID：13440894
> 
> 赞同：0
> 
> 时间：2012-11-18T14:06:29.840
> 
> 标签：hibernate, jakarta-ee, orm, sessionfactory, hibernate-4.x

我正在关注关于 Hibernate 的[本教程。](http://www.youtube.com/watch?v=N2F1zCAf_NU&feature=relmfu)该教程已经很老了，因为它仍然使用旧的 buildSessionFactory()。

我的问题是我将如何使用`buildSessionFactory(serviceRegistry)`我刚开始休眠的最新版本。我不知道我将如何实现这一点。这是我的代码

```
public static void main(String[] args) {
    // TODO Auto-generated method stub
    UserDetails ud = new UserDetails();
    ud.setId(1);
    ud.setName("David Jone");

    SessionFactory sessionFactory = new Configuration().configure().buildSessionFactory(serviceRegistry)
    Session session = sessionFactory.openSession();
    session.beginTransaction();
    session.save(ud);
    session.getTransaction().commit();

} 
```

如果你们可以在没有 Maven 的情况下链接 Hibernate 4 的教程，那也会很有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T12:47:27.900

看来您是 Hibernate 的新手，并且正在努力学习它的基础知识。我建议您阅读文档并学习该概念。

[Hibernate Documentation](http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html/ch01.html)是了解一些基础知识的良好起点。

此外，我还写[了一系列关于 Hibernate 的文章](http://viralpatel.net/blogs/introduction-to-hibernate-framework-architecture/)，您可能想阅读这些文章。

对于以编程方式访问 SessionFactory，我建议您使用本教程中给出的以下 Hibernate Utility 类：

[休眠 Hello World 示例](http://viralpatel.net/blogs/hibernate-maven-mysql-hello-world-example-xml-mapping/)

```
package net.viralpatel.hibernate;

import org.hibernate.SessionFactory;
import org.hibernate.cfg.Configuration;

public class HibernateUtil {

    private static final SessionFactory sessionFactory = buildSessionFactory();

    private static SessionFactory buildSessionFactory() {
        try {
            // Create the SessionFactory from hibernate.cfg.xml
            return new Configuration()
                    .configure()
                    .buildSessionFactory();
        } catch (Throwable ex) {
            System.err.println("Initial SessionFactory creation failed." + ex);
            throw new ExceptionInInitializerError(ex);
        }
    }

    public static SessionFactory getSessionFactory() {
        return sessionFactory;
    }
} 
```

一旦你有了这个类，你可以像这样使用它：

```
private static Employee save(Employee employee) {
    SessionFactory sf = HibernateUtil.getSessionFactory();
    Session session = sf.openSession();
    session.beginTransaction();

    Long id = (Long) session.save(employee);
    employee.setId(id);

    session.getTransaction().commit();

    session.close();

    return employee;
} 
```

希望这可以帮助。

# php - 如何在 Wordpress 中启用评论系统

> ID：13440895
> 
> 赞同：-1
> 
> 时间：2012-11-18T14:06:33.467
> 
> 标签：php, wordpress

我正在学习如何从此[页面](http://www.onextrapixel.com/2011/03/08/how-to-code-a-wordpress-3-0-theme-from-scratch)
创建自定义 Wordpress 主题，除了评论系统外，一切正常，因为他们没有描述如何启用它（他们只用于`<?php comment_form(); ?>`将表单插入模板）。我可以在后端看到我的评论，但看不到页面本身（我可以看到一个显示**1 条评论**的链接，但是当我点击它时没有任何反应）。显然我需要一些 PHP 代码来显示我的评论，但不知道从哪里开始！我被卡住了，因为我刚开始学习主题开发并且我的 PHP 知识有限。
谁能给我一个建议或解决这个问题的方法？这对我来说意义重大。
我的 Wordpress 页面在[这里](http://robertpeic.com/wordpress_template/)
谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:11:58.173

您需要做的就是编辑“页面模板”并插入以下代码

```
if ((‘open’ == $post-> comment_status)) { comments_template(); 
```

介于以下两行之间。

```
if (have_posts()) : while (have_posts()) : the_post(); 
  endwhile; endif; 
```

还要检查

[**启用和禁用评论**](http://en.support.wordpress.com/enable-disable-comments/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T14:21:10.040

另一种选择是从基本主题开始。他们拥有所有必要的文件和代码，但实际上没有别的。您可以直接在其中构建自定义主题。我为此推荐 Bones。你可以在这里找到它：[Bones Developer Theme](http://themble.com/bones/)。如果您的 PHP 或 WordPress 知识有限，这是一个不错的选择，因为自定义主题所需的核心内容已经存在，基本上您需要做的就是在其中构建您的设计。

# c# - 使用游标或 C# 代码将行插入表中

> ID：13440898
> 
> 赞同：0
> 
> 时间：2012-11-18T14:06:47.413
> 
> 标签：c#, sql, sql-server-2008

我正在使用 C# 和 sql server 2008，我需要从一个表中选择 10 个随机行并将它们插入到另一个表中，我想在 sql server 中使用游标来执行此操作，但我已经阅读了很多关于游标的缺点。现在我想通过 C# 代码做到这一点。有人有更好的建议吗？提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T14:08:32.927

[从 SQL Server 表中选择 n 个随机行的](https://stackoverflow.com/questions/848872/select-n-random-rows-from-sql-server-table)想法

不需要游标：

```
Insert Into Table1
  (col1, col2)
Select Top 10
  col1, col2
From
  Table2
Order By
  NewID() 
```

# ios - 一个控制器中的两个表视图

> ID：13440899
> 
> 赞同：4
> 
> 时间：2012-11-18T14:06:55.740
> 
> 标签：ios, xcode, uitableview

所以我试图在一个视图中制作两个表格视图，但我遇到了一些麻烦。我已经阅读了一些关于如何做到这一点的其他回复，但它们并没有完全帮助我。

在我的 .h 文件中，我为两个视图创建了两个出口并调用`myFirstViewText`它们`mySecondViewTex`

所以在我的 m 文件中 -`(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{`

我希望能够在每个不同的控制器中打印出单独的值，但我不太确定，因为您只返回 1 个单元格？

到目前为止，我已经完成了

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
static NSString *CellIdentifier = @"Rx";
static NSString *CellIdentifier2 = @"allergies";
UITableViewCell *cell = [tableView dequeueReusableHeaderFooterViewWithIdentifier:CellIdentifier];
UITableViewCell *cell2 = [tableView dequeueReusableHeaderFooterViewWithIdentifier:CellIdentifier2];
if(!cell){
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}
if (!cell2) {
    cell2 = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier2];
}
if (tableView == self.myFirstTextView ) {
       cell.textLabel.text = @"HI JAZZY";//[RxDict objectAtIndex:indexPath.row];
}
if (tableView == self.mySecondTextView) {
      cell.textLabel.text = @"BYE JAZZY";//[RxDict objectAtIndex:indexPath.row];
}
tableView = self.mySecondTextView;
cell2.textLabel.text = @"I love Jazzy :D";
return cell2; 
```

这会在我的第一个 TableView 中打印“I love Jazzy”，而在第二个 TableView 中没有打印任何内容。为什么会发生这种情况，我该如何解决？感谢：D

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T14:21:05.897

所有将您的类的实例设置为数据源的 tableView 都会调用此方法。

这意味着您需要检查*哪个*tableView 要求某某某某单元格编号。

所以，你的方法基本上应该是这样的：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (tableView == rxTableView) {
        //prepare and return the appropriate cell for *this* tableView
    }
    else if (tableView == allergiesTableView) {
        //prepare and return the appropriate cell for *this* tableView
    }
    return nil; //because you don't expect any other tableView to call this method
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-19T04:52:34.557

我的建议是在你的两个表视图上设置一个标签，然后在你的表视图数据源方法中检查你的表视图所在的标签。例如，你可以在代码中的某些地方执行以下操作：

```
myFirstTableView.tag = 1;
mySecondTableView.tag = 2; 
```

稍后当你在

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
   if (tableView.tag == 1) 
   cell.textLabel.text = @"HI JAZZY";//[RxDict objectAtIndex:indexPath.row];

   if (tableView.tag == 2) 
   cell.textLabel.text = @"BYE JAZZY";
 } 
```

此外，如果您有 2 个不同大小的表格视图，您可以这样实现：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
  {
    if (tableView.tag == 1)
         return 1;
    else if (tableView.tag == 2)
         return 2;
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T04:41:43.803

我不经常看到实现的一种方法实际上是使用 NSObject 子类作为每个表的委托和数据源，而不是视图控制器。它消除了对“if (tableView == someTable) ...”代码的需求，并且可能使您的视图控制器和 UITableView 代码都可维护和可读。

您将为每个表创建一个 NSObject 子类。这些子类将包含您的 UITableView 数据源和委托方法的所需实现。然后，您将在视图控制器中实例化其中的一个，并将每个连接到相应的表中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-05T11:07:54.130

问题1：

```
tableView = self.mySecondTextView;     
cell2.textLabel.text = @"I love Jazzy :D";
return cell2; 
```

你在这里所做的总是返回`cell2`，设置它的文本“我喜欢爵士乐：D”所以它总是会填充第一个表视图，因为你不会`tableView=mySecondTextView`在进入方法之前设置。代表总是以`firstTableView`.

```
 -(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath; 
```

问题2：

```
if (tableView == self.myFirstTextView ) {
    cell.textLabel.text = @"HI JAZZY";
    //[RxDict objectAtIndex:indexPath.row];

    //for printing in first table view return cell here like

    return cell;
}
if (tableView == self.mySecondTextView) {
    cell.textLabel.text = @"BYE JAZZY";
    //[RxDict objectAtIndex:indexPath.row];

    //for printing in second tableview return cell two here

    return cell2;
} 
```

在进入此功能之前，请确保您要定位的表已设置。您可以在`numberofsection`方法、视图`didload`方法或您想要显示或目标表视图的其他地方设置它（例如单击某个按钮）。但是你不能在这里设置。

# c++ - 构造函数未调用预期次数

> ID：13440902
> 
> 赞同：0
> 
> 时间：2012-11-18T14:07:24.530
> 
> 标签：c++, class, constructor

这是导致问题的代码：

```
class Base
{
public:
    virtual void fun()
    {
        cout<<"Base";
    }
};
class Der:public Base
{
    Base &pb;
public:
    Der(Base&b):pb(b){}
    virtual void fun()
    {
        cout<<"Der...";
        pb.fun();
    }
};
int main()
{
    Der(Der(Base())).fun();
    return 0;
} 
```

运行这段代码，结果显示“Der...Base...”！这太神奇了，我想不通为什么结果不是“Der...Der...Base”，这在逻辑上是正确的？！然后我用 Der 类中的成员替换并将`Base&pb`代码`Base*pb`更改为合法，最后输出正确，即“Der...Der...Base”！调试了一下代码，发现在使用的时候`Base&pb`，Der的构造函数只跑了一次，使用`Base*pb`的时候，构造函数跑了两次正确！谁能向我解释发生了什么以及为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:11:29.263

在`Der(Der(Base())).fun()`表达式中，内部`Der(Base())`产生一个`rvalue`- 编译器通过使用[复制](https://stackoverflow.com/questions/6383639/conditions-for-copy-elision)省略优化代码并删除不必要的对象复制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T15:01:53.837

除了@icepack的回答和评论中的以下讨论（摘要：代码`Der(der)`是一个演员，可能会或可能不会使用构造函数实现；在你的情况下不是），一个解决方法：你应该做出你的意图通过不使用构造函数来清除。

我会将您的代码重写为如下内容：

```
class Base
{
public:
    virtual void fun()
    {
        cout<<"Base";
    }
};

class Der:public Base
{
    Base &pb;
    Der(Base& b) : pb(b) {}
public:
    static Der Decorate(Base&& b){ return Der(b); }
    virtual void fun()
    {
        cout<<"Der...";
        pb.fun();
    }
};

int main()
{
    Der::Decorate(Der::Decorate(Base())).fun();
    return 0;
} 
```

（[输出：Der...Der...Base](http://ideone.com/VY3KrW)）。

* * *

更改代码以接受指针[很容易](http://ideone.com/vRuU4Q)：

```
class Base
{
public:
    virtual void fun()
    {
        cout << "Base";
    }
};

class Der : public Base
{
    Base* pb;
    Der(Base* b) : pb(b) {}
public:
    static Der Decorate(Base* b){ return Der(b); }
    virtual void fun()
    {
        cout << "Der...";
        pb->fun();
    }
};

int main()
{
    Der::Decorate(&Der::Decorate(&Base())).fun();
    return 0;
} 
```

# python - SQLAlchemy：调用构造函数时返回现有对象而不是创建新对象

> ID：13440905
> 
> 赞同：7
> 
> 时间：2012-11-18T14:07:45.580
> 
> 标签：python, object, model, constructor, sqlalchemy

我想以这样的方式使用 sqlalchemy：

```
email1 = EmailModel(email="user@domain.com", account=AccountModel(name="username"))
email2 = EmailModel(email="otheruser@domain.com", account=AccountModel(name="username")) 
```

通常 sqlalchemy 将为帐户创建两个条目并将每个电子邮件地址链接到此。如果我将帐户名设置为唯一 sqlalchemy 会引发异常，告诉我已经存在具有相同值的条目。这很有意义并且按预期工作。

现在我自己想出了一种方法，它允许上述代码，并且只通过覆盖AccountModel 类的**新构造函数来创建一个帐户：**

```
def __new__(*cls, **kw):
    if len(kw) and "name" in kw:
        x = session.query(cls.__class__).filter(cls[0].name==kw["name"]).first()
        if x: return x
    return object.__new__(*cls, **kw) 
```

这对我来说非常有效。但问题是：

*   这是正确的方法吗？
*   是否有实现相同目标的 sqlalchemy 方法？

我正在使用最新的 0.8.x SQLAlchemy 版本和 Python 2.7.x

谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T14:49:38.413

[在http://www.sqlalchemy.org/trac/wiki/UsageRecipes/UniqueObject](http://www.sqlalchemy.org/trac/wiki/UsageRecipes/UniqueObject)的 wiki 上有这个例子。

不过，最近我更喜欢使用 a`@classmethod`而不是重新定义构造函数，因为显式优于隐式，也更简单：

```
user.email = Email.as_unique('foo@bar.com') 
```

（实际上，我现在要更新 wiki 以更全面地代表此处的使用选项。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T14:39:28.243

我认为这不是实现这一点的最佳方法，因为它会创建构造函数对全局变量的依赖关系，`session`并且还会以意想不到的方式修改构造函数的行为（毕竟`new`预计会返回一个*新对象）。*例如，如果有人将您的类与两个并行会话一起使用，则代码将失败，他将不得不深入研究代码以查找错误。

我不知道有任何“sqlalchemy”方法来实现这一点，但我建议创建一个`createOrGetAccountModel`类似的函数

```
def createOrGetAccountModel(**kw):
    if len(kw) and "name" in kw:
      x = session.query(AccountModel).filter_by(name=kw["name"]).first()
      if x: return x
    return AccountModel(**kw) 
```

# javascript - 理解 jquery 源代码 - jquery.fn.init

> ID：13440907
> 
> 赞同：5
> 
> 时间：2012-11-18T14:08:09.970
> 
> 标签：javascript, jquery

我正在研究 jQuery 源代码的工作原理，我了解 jQuery 对象只是将调用转发到`jQuery.fn.init`where`jQuery.fn`只是对`jQuery.prototype`.

然后在源代码中，有这一行：

```
// Give the init function the jQuery prototype for later instantiation
jQuery.fn.init.prototype = jQuery.fn; 
```

有一条注释可以解释代码的作用，但我仍然无法理解。

1.  有人能解释一下这行代码是什么意思吗？后面的实例化是什么，为什么我们需要将 init 的原型设置为 jquery 的 prototpe？

2.  jQuery源代码使用jQuery.fn而不是直接使用jQuery.prototype是否有原因（例如避免冲突或可读性或其他）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T14:20:21.953

（此回复是假设您对原型继承有所了解。如果您不了解，则需要阅读有关它的文章以完全了解发生了什么。尝试在 Google 上搜索“原型继承 javascript”。）

当内部创建一个新的 jQuery 对象时，它是用`new jQuery.fn.init()`. `init`是一个构造函数，所以`prototype`在这个构造函数上设置属性可以让新创建的jQuery对象继承这个原型的所有属性（所有的方法`jQuery.fn`）。

如果只是`new jQuery()`使用，正如您似乎建议的那样，该对象将继承自，`jQuery.prototype` **但**该`jQuery`函数将被执行，正如您所知，这会做*很多事情*。而是使用`init`构造函数，因为它没有`jQuery`函数的包袱。设置`jQuery.prototype`为与`jQuery.fn.init.prototype`just 相同允许您这样做`jqueryobject instanceof jQuery`，这很好，所以这就是`jQuery`对象具有原型的原因。

# python - 捕获上下文管理器期间发生的异常 - Python

> ID：13440908
> 
> 赞同：3
> 
> 时间：2012-11-18T14:08:11.773
> 
> 标签：python, python-3.x, contextmanager

> **可能重复：**
> [使用带有 try-except 块的 python“with”语句](https://stackoverflow.com/questions/3642080/using-python-with-statement-with-try-except-block)

我`open`用来在 Python 中打开一个文件。我将文件处理封装在一个`with`语句中，如下所示：

```
with open(path, 'r') as f:
    # do something with f
    # this part might throw an exception 
```

这样，即使抛出异常，我也可以确定我的文件已关闭。

但是，我想处理打开文件失败（`OSError`抛出一个）的情况。一种方法是将整个`with`块放在一个`try:`. 只要文件处理代码不抛出 OSError，它就可以工作。

它可能看起来像：

```
try:
   with open(path, 'rb') as f:
except:
   #error handling
       # Do something with the file 
```

这当然行不通，而且真的很难看。有这样做的聪明方法吗？

谢谢

PS：我正在使用python 3.3

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-18T14:10:03.977

首先打开文件，然后将其用作上下文管理器：

```
try:
   f = open(path, 'rb')
except IOError:
   # Handle exception

with f:
    # other code, `f` will be closed at the end. 
```

# git-clone - OpenShift Git 克隆错误

> ID：13440926
> 
> 赞同：4
> 
> 时间：2012-11-18T14:09:42.430
> 
> 标签：git-clone, openshift

我是 OpenShift 的新手，我遇到了问题，

当我做

```
rhc app git-clone mynewapp

Your public ssh key must be uploaded to the OpenShift server.  Would you like us to upload it for you? (yes/no) yes

You can enter a name for your key, or leave it blank to use the default name. Using the same name as an existing key will overwrite
the old key.

Since you do not have any keys associated with your OpenShift account,
your new key will be uploaded as the 'default' key

type: ssh-rsa
content:
AAAAB3NzaC1yc2EAAAADAQABAAABAQCuA9kdmq5Pf5JLyHeMpWQ+XYaEzw8UWziUfXohMR8Dt9ZwkIb4WSHLzcGKKpclZvWOi2UZMQCOp8wCij5VS/ps8/3YPQVYyg+GHAAZIr
WsGDnJdpRF/shUnvoPx6XTzzLFHxBOS92LktjvX/T+xqftS6aVugD0cQ0vVkA6e5FwIjwo4JHoJGRFzgdaSbC5nDiHvDX7zhtnQXe1TeTK5nhjDj/uZPaj5h0hRv4Zx0EzfDYu
Uig0GCoFrWsJ9MTw5F7WEeOtPNtp2uFubuDCDpoBtBBDDmL642AY8r9IV4REGSfUDzV+M0Ab33ubRYKmp+ok6MtBrlTKg94PaVvuf2V5
fingerprint: eb:41:87:1b:e8:4e:ec:c0:8d:c8:c6:5e:a2:6a:ad:b4
Uploading key 'default' from /home/toriq/.ssh/id_rsa.pub
Cloning into 'myapp'...
done 
```

突然出现一个错误：

```
Error in git clone - Agent admitted failure to sign using the key.
Permission denied (publickey,gssapi-keyex,gssapi-with-mic).
fatal: The remote end hung up unexpectedly 
```

有什么解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T19:34:43.163

它可能类似于此[GitHub 帮助页面](https://help.github.com/articles/error-agent-admitted-failure-to-sign)：

> 对于大多数用户来说，只需运行`ssh-add`将您的密钥加载到 SSH 代理中即可解决此问题。

```
$ ssh-add
# Enter passphrase for /home/you/.ssh/id_rsa: [tippy tap]
# Identity added: /home/you/.ssh/id_rsa (/home/you/.ssh/id_rsa) 
```

> 如果您的密钥没有默认文件名，则必须将路径传递给`ssh-add`：

```
$ ssh-add ~/.ssh/my_other_key
# Enter passphrase for /home/you/.ssh/my_other_key: [tappity tap tap]
# Identity added: /home/you/.ssh/my_other_key (/home/you/.ssh/my_other_key) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-08T05:08:04.000

可以安装[rhc openshift 客户端工具](https://www.openshift.com/developers/rhc-client-tools-install)

然后运行安装程序，它将上传您的 ssh 密钥。

```
rhc setup 
```

# prolog - 如何让两个驱动谓词在 prolog 中工作？

> ID：13440927
> 
> 赞同：0
> 
> 时间：2012-11-18T14:09:42.190
> 
> 标签：prolog, win-prolog

```
begin:- 

go,
initialise.             % drive predicate

begin:-
write('Sorry cannot help'),nl,nl.

go:-
write('Below is the list of the current toys available within the 

store.'),nl,nl,nl,nl,
loop_through_list([car, football, action_men, train_tracks, lego, football, bikes, control_car, drees_up, doll, bear, furbies, craft, doll_house]).
loop_through_list([Head|Tail]) :-
    write(Head),
    write(' '),
    loop_through_list(Tail).
initialise:-
nl,nl,nl,nl,
tab(40),write('******************************************'),nl,
tab(40),write('*** TOY GENERATING SYSTEM ***'),nl,
tab(40),write('******************************************'),nl,nl,
write('Please answer the following questions'),
write(' y (yes) or n (no).'),nl,nl, nl, nl. 
```

这里的问题是`go:-`和`initialise:-`单独工作时，而不是放在一起时。`nl`所有的s都有问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T14:50:46.893

问题是`go/0`它不能正常工作。当它打印列表时，它在最后失败了，这意味着执行将在之后停止。因此，当你运行时`begin/0`，`initialize/0`永远不会运行。

要修复它，您需要添加一个基本案例`loop_through_list/0`：

```
loop_through_list([]).
loop_through_list([Head|Tail]) :-
    write(Head),
    write(' '),
    loop_through_list(Tail). 
```

作为旁注，“print_list”将是一个更具描述性的名称`loop_through_list/0`

# java - 如何将二维数组拆分为左右数组？

> ID：13440932
> 
> 赞同：1
> 
> 时间：2012-11-18T14:10:28.880
> 
> 标签：java, split, multidimensional-array, arrays

> **可能重复：**
> [java：如何将二维数组拆分为两个二维数组](https://stackoverflow.com/questions/5463781/java-how-to-split-a-2d-array-into-two-2d-arrays)

需要的是拆分这个数组：

```
int[][] bitblock = {
    {1,0,1,0,1,0,1,0},
    {1,0,1,0,1,0,1,0},
    {1,0,1,0,1,0,1,0},
    {1,0,1,0,1,0,1,0},
    {1,0,1,0,1,0,1,0},
    {1,0,1,0,1,0,1,0},
    {1,0,1,0,1,0,1,0},
    {1,0,1,0,1,0,1,0}}; 
```

这是一个 8*8 的数组，我想把它分成左右数组并存储在这里：

```
int[][] leftblock = new int [bitblock.length][bitblock[0].length/2];
int[][] rightblock = new int [bitblock.length][bitblock[0].length/2]; 
```

我使用了 Syste.arraycopy 方法，并且能够将位块拆分为上下数组，但我很难左右拆分它：

```
System.arraycopy(bitblock, 0, leftblock, 0, leftblock.length);
System.arraycopy(bitblock, rightblock.length, rightblock, 0, rightblock.length) 
```

有人可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T14:28:08.693

这应该可以很好地解决问题：

`int[][] bitblock = {{1, 0, 1, 0, 1, 0, 1, 0}, {1, 0, 1, 0, 1, 0, 1, 0}, {1, 0, 1, 0, 1, 0, 1, 0}, {1, 0, 1, 0, 1, 0, 1, 0}, {1, 0, 1, 0, 1, 0, 1, 0}, {1, 0, 1, 0, 1, 0, 1, 0}, {1, 0, 1, 0, 1, 0, 1, 0}, {1, 0, 1, 0, 1, 0, 1, 0}};`

 ````
 int[][] leftblock = new int[bitblock.length][bitblock[0].length / 2];
    int[][] rightblock = new int[bitblock.length][bitblock[0].length / 2];

    for (int i = 0; i < bitblock.length; i++) {
        for (int j = 0; j < bitblock[0].length / 2; j++) {
            leftblock[i][j] = bitblock[i][j];
        }

        for (int j = bitblock[0].length / 2; j < bitblock[0].length; j++) {
            rightblock[i][j - bitblock[0].length / 2] = bitblock[i][j];
        }
    } 
````  `您还可以使用 System.arraycopy，因为它使代码更加清晰，便于将来检查。至于性能，我认为只要您的阵列很小，这并不重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T14:20:04.847

对于 8x8 数组，使用巧妙的数组复制方法的性能优势可能很小。我建议您使用嵌套的 for 循环简单地编写代码。代码会更简单，你会（本来会）更快地完成工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T14:28:20.457

试试这个：

```
for (int i = 0 ; i < bitblock.length ; i++) {
    System.arraycopy(bitblock[i], 0, leftblock[i], 0, leftblock[i].length);

    System.arraycopy(bitblock[i], bitblock[0].length/2, 
                                    rightblock[i], 0, leftblock[i].length);
} 
```

我个人认为在这种情况下嵌套循环不会更好——你不妨使用 的功能，`System.arraycopy`而不是自己重新发明轮子。在我看来，这也比嵌套循环更容易管理/阅读。`

# android - android R.integer 在创建数组时返回不正确的极大值导致内存不足

> ID：13440937
> 
> 赞同：4
> 
> 时间：2012-11-18T14:10:51.430
> 
> 标签：android, out-of-memory, android-resources, largenumber

我在 xml 中声明了几个整数值，并且需要使用 Class 中的值来定义对象的数组大小。

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <!--     Default Object Count -->
    <item format="integer" name="item1" type="integer">3</item>
    <item format="integer" name="item2" type="integer">1</item>
    <item format="integer" name="item3" type="integer">1</item>
</resources> 
```

我在课堂上使用上述值如下

```
public class InitialiseObjects {
    // For now static number of objects initialized
    private String TAG = "INIT_OBJECTS";
    int ITEM1_COUNT = R.integer.item1;
    int ITEM2_COUNT = R.integer.item2;
    int ITEM3_COUNT = R.integer.item3;

    private Item1[] item1Objs = new Item1[ITEM1_COUNT];
    private Item2[] item2Objs = new Item2[ITEM2_COUNT];
    private Item3[] item3Objs = new Item3[ITEM3_COUNT];
} 
```

我希望项目 1、2、3 的 ITEM*_COUNT 分别为 3、1、1。但是我分别得到 2131034112、2131034113、2131034114

这里有什么问题？

正在使用 Android 2.2 [API-8]

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-18T14:17:43.883

`R.integer.item1`是资源的 ID，因此是一个非常大且任意的整数。

您寻找的价值是 `getContext().getResources().getInteger(R.integer.item1);`

因此，您将无法在静态代码中获取它们。

您应该在代码中使用延迟初始化：

```
private Item1[] item1Objs;
public Item1[] getItem1Array(Context context) {
  if (item1Objs == null) {
     int count = context.getResources().getInteger(R.integer.item1);
     item1Objs = new Item1[count];
     }
  return item1Objs;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T14:14:07.573

这样做：

```
Resources res = getResources();
int maxSpeed = res.getInteger(R.integer.max_speed); 
```

见这里：http: [//developer.android.com/guide/topics/resources/more-resources.html#Integer](http://developer.android.com/guide/topics/resources/more-resources.html#Integer)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-18T14:19:12.480

原因是任何 R.integer.* 都是生成的整数值，它就像一个与您在 xml 中声明的值相关的 id

你宁愿打电话

```
getResources().getInteger(R.integer.*); 
```

# google-apps-script - DocumentApp.getActiveDocument() 返回 null

> ID：13440938
> 
> 赞同：1
> 
> 时间：2012-11-18T14:11:26.393
> 
> 标签：google-apps-script, document

如何访问活动的谷歌文档？

```
function test() {
var doc = DocumentApp.getActiveDocument();
Logger.log(doc.getName());
} 
```

记录器返回空值。但是，存在一个活动的（打开的）文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T17:37:26.280

此功能当前不受支持，因此无法使用。它不应该存在于文档中，我们正在解决这个问题。

如果要与文档交互，请改用[DocumentApp.openById](https://developers.google.com/apps-script/class_documentapp.html#openById)。如果我的文档 URL 是`https://docs.google.com/document/d/1chYJu5ktIeByau-Xtd0XwCYUnMJG32WC7wQe5xMv3TA/edit`，则文档打开如下：

```
 var doc = DocumentApp.openById('1chYJu5ktIeByau-Xtd0XwCYUnMJG32WC7wQe5xMv3TA'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-10T23:41:03.383

如果有任何机会，您真正想要的是获取活动工作表（并且您要求将文档作为中间步骤）：您可以使用[SpreadsheetApp.getActiveSheet()](https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet-app#getactivesheet)来做到这一点。

# amazon-ec2 - 无法登录我的 EC2 Windows 实例

> ID：13440946
> 
> 赞同：0
> 
> 时间：2012-11-18T14:12:34.190
> 
> 标签：amazon-ec2

我刚刚创建了一个 Windows EC2 实例。我得到了密码并下载了 RDP 快捷方式。我尝试使用管理员帐户和提供的密码登录，但它不断给我一条消息，说我的凭据错误。我能做些什么？亚马逊帮助只提供了我所做的简单步骤：1）下载 RDP 快捷方式，2）使用 .PEM 文件检索密码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T14:14:06.073

这是时间问题。我又等了一段时间（虽然它已经准备好并且所有检查都已完成），但只是等待并解决了问题。

# asp.net-mvc-3 - MVC / 存储库模式 - 架构

> ID：13440948
> 
> 赞同：1
> 
> 时间：2012-11-18T14:12:40.253
> 
> 标签：asp.net-mvc-3, nhibernate, architecture, repository-pattern

我有一个使用 NHibernate 和 ASP.Net MVC 的项目。该应用程序旨在允许用户跟踪某些数据，然后根据输入的数据生成统计视图。到目前为止，我的应用程序的结构如下所示：

**NHibernate 层：**包含`Repository<T>`和`UnitOfWork`类，以及实体映射定义。

**核心/服务层**：包含通用`EntityService`类。目前，这只是通过`IUnitOfWork`接口定义事务范围，`IRepository`以提供更高级别的数据访问服务。

**表示层（MVC 应用程序）**：尚未实现，但包含通常的东西加上依赖注入。

我有一些问题：

1.  允许我的 MVC 应用程序处理所有层的依赖注入是糟糕的设计吗？例如，除了将`EntityService`实例依赖注入到控制器中，它还将处理依赖注入`IRepository`到`EntityService`类中。服务层是否应该自己处理这个问题，即使这意味着在两个不同的地方执行依赖注入？

2.  我应该在哪里生成我的统计数据？这个业务逻辑似乎不属于我的服务层，目前它只包含实体类型定义和一个用于修改和访问实体属性的接口。我对此有一些想法，但我不确定我最喜欢哪个：

    *   保持我的服务层不变并创建一个单独的统计项目 - 这完全独立于将要使用的实体类型，这意味着我的 MVC 控制器将必须在我的业务实体和我的（可能是静态的）统计数据之间传递原始数字信息类。这是一个非常巧妙的分离，但可能意味着大量业务逻辑仍保留在表示层中。
    *   创建一个统计项目；但是，在这个项目中的类和我的业务实体之间创建一个紧密耦合。例如，我不会将`Reading`对象的*值*传递给方法，而是传递整个对象（或将它们定义为扩展方法）。这会将业务逻辑从我的 MVC 应用程序中移出，但紧密耦合似乎有点混乱。
    *   将我的所有业务逻辑保留在我的服务层中。定义 的强类型子类`EntityService`，因此我的服务既包含特定于实体的业务方法，也包含数据存储方法，同时将实体类本身保持为纯数据容器。为任何通用统计处理创建一个单独的统计项目，并通过我的派生服务类调用其方法。我的服务类有效地将业务功能与`IRepository<T>`.

我对第三种选择犯了错误，但有人有什么想法吗？替代建议？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T18:09:10.550

初步观察：

我喜欢你描述你的项目的方式，我只是不明白为什么你的**数据访问层**（DAL）被称为 NHibernate 层：这与你没有使用技术名称来描述逻辑的所有其他层很奇怪层（正确）。所以我建议你将它重命名为 DAL，并用它来从 NHibernate 中抽象出你的应用程序。

我对你的问题的看法：

1.  绝对没有。将依赖注入应用于所有层是件好事。几个或它好的原因：

    1.1**测试**：您可以模拟 DAL 接口并使用另一个 DI 配置文件对不带 DAL 的服务层进行单元测试。以同样的方式，您可以模拟 Web 控制器层的服务等。

    1.2**不同的 DAL 实现**：假设您需要不同的 DAL 实现（NOSQL、SQL 或 LINQ 而不是 NHibernate 等）技术用于您项目的不同部署或将来进行扩展。您可以轻松地维护不同的 DI 配置文件。

2.  您可以在不同的项目中部署相同的层。以同样的方式，您可以拥有一个包含不同图层的项目。我认为它们的关系是正交的：项目描述的是物理（开发时间和运行时间）实现。层是合乎逻辑的。所以最初我会用第三个选项保持简单。我只是不明白您为什么要针对此选项说以下内容：

> 为任何通用统计处理创建一个单独的统计项目，并通过我的派生服务类调用其方法。我的服务类有效地将业务功能与 IRepository 创建的存储功能合并。

我将统计信息视为一项或多项服务，因此您可以将其实现为具有服务层内类的命名空间。而且，与任何其他服务一样，您可以注入 DAL 存储库类。而且，与任何其他服务/DAL 一样，模型类可以在不同的服务和 DAL 类之间共享。

* * *

`StatsService.AverageReadingFor(Person p, DateTime start, DateTime end)`听起来不错。

有几个实现选项：

1.  使用底层存储库功能（例如：SQL avg 函数）
2.  使用也可以使用依赖注入实现的[**观察者模式**](http://en.wikipedia.org/wiki/Observer_pattern)
3.  使用面向方面的编程。以[Spring.Net 章节](http://www.springframework.net/doc-latest/reference/html/aop.html)为例。

如果您有多个服务层实例（多个服务器），则必须对 2 和 3 进行调整，以便使用消息传递系统进行进程外通信。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T13:05:38.367

只是一个更新——关于我的第二个问题，我决定定义一个`IStatsService<T>`期望将一个`IEntityService<T>`传递给它的构造函数的。我将使用它来对业务实体进行通用统计处理，并创建更多接口来实现`IStatsService<T>`我需要更多特定于类型的信息。

希望这会帮助那些一直在为类似问题挠头的人！

# ubuntu - 如何在 Linux 上创建 Mono 构建服务器（Ubuntu 上的 Jenkins）

> ID：13440953
> 
> 赞同：4
> 
> 时间：2012-11-18T14:13:29.257
> 
> 标签：ubuntu, build, mono, jenkins, continuous-integration

我正在尝试在 Ubuntu 上为 Mono 项目设置构建服务器。

其动机是让我的 .NET C# 项目能够在 Linux 主机上运行。所以我想在 Windows/Linux 上开发，提交和推送，并在运行 Jenkins 的机器上构建 Linux 的二进制文件（已经有一个为 Windows 构建的实例）

似乎构建的服务器部分更容易，因为 Jenkins 提供了一种简单的方法来做到这一点。对于 Mono 部分，有很多依赖项和软件包可供选择。

所以我基本上遵循了[他们身边为詹金斯提供的说明，](http://pkg.jenkins-ci.org/debian/ "Ubuntu包安装")詹金斯正在运行。

现在的问题是我需要安装什么来让 Jenkins 构建 Mono 项目。我目前正在使用 Mono-Develop 3.0.4.7 并创建了一个测试控制台项目。我猜我不涉及任何第三方库，但我真的不知道 Mono 的 Windows 安装中包含什么。

所以这就是我要的：

*   我**需要**在 Ubuntu 上安装什么，拥有什么会更好？
*   对项目文件有什么特殊要求吗？我读到 Mono 正在使用 Windows 项目格式。那是对的吗？
*   Jenkins 是否有插件支持我为 Mono 构建？
*   有什么需要特别注意的吗？喜欢向 PATH 或某些可能感兴趣的工具添加特殊路径？

任何知识来源都是有意义的。**如果他们解释原因**我会很好，我不喜欢阅读“做这个，然后做那个，然后再做另一件事”，没有人解释背景，那么多;）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T14:17:28.840

> 在运行 Jenkins 的机器上构建的 Linux 二进制文件（已经有一个用于构建 Windows 的实例）

如果你在 Windows 上有一个构建服务器来制作你的 .NET 程序集，那么你就不需要一个 linux 的。在 Windows 上使用 .NET 4.0 构建的程序集将在 linux 上使用最新的 Mono 运行时运行，而无需重新编译它们。只要您确保不使用 Mono 中缺少的任何 API。而且，如果您使用缺少的 API，它无论如何都不会使用 Mono 进行编译。

我建议省去在 Ubuntu 上手动构建 Mono SDK 的麻烦，并与 Windows 构建服务器保持一致。上次我检查你必须在你的 Ubuntu 系统上重建 Mono，因为默认安装的 Mono for Ubuntu 已经过时了。

# css - wordpress 显示缩略图和设置样式

> ID：13440954
> 
> 赞同：0
> 
> 时间：2012-11-18T14:13:36.010
> 
> 标签：css, wordpress

嗨，我想要做的是显示带有缩略图的帖子并显示标题和内容的前三行我想要实现的是这个

```
Date

thumbnail - title
            some content 
```

目前我有特色图片，但我正在努力获取其余部分，只是为了重申我想要左侧的特色图片，旁边是标题日期和旁边的内容。这是目前的样子

![在此处输入图像描述](../Images/403e0afeb44b811b6e00b1f80261b66a.png)

这是我的功能

```
if ( function_exists( 'add_theme_support' ) ) { 
        add_theme_support( 'post-thumbnails' ); } //Adds thumbnails compatibility to the theme
set_post_thumbnail_size( 200, 170, true ); // Sets the Post Main Thumbnails
    add_image_size( 'recent-thumbnails', 55, 55, true ); // Sets Recent Posts Thumbnails}

function recentPosts() {
    $rPosts = new WP_Query();
    $rPosts->query('cat=4&showposts=3&orderby=date');
        while ($rPosts->have_posts()) : $rPosts->the_post(); ?>
            <li>
                <a href="<?php the_permalink();?>"><?php the_post_thumbnail('recent-thumbnails'); ?></a>
                <h2><a href="<?php the_permalink(); ?>"><?php the_title();?></a></h2>
            </li> 
        <?php endwhile; 
    wp_reset_query();
} 
```

这是我的CSS

```
#posts { width:600px; height:auto; float:left; margin-top:20px; font-family:Arial, Helvetica, sans-serif; font-size:14px; color:#080808;}
#posts  .news{ width:600px; height:auto; font-family:Arial, Helvetica, sans-serif; font-size:14px; color:#000000; display:inline-block;}
#posts  a{ font-family:Arial, Helvetica, sans-serif; font-size:14px; color:#000000; display:inline-block;} 
```

这是我如何在我的 index.php 中调用它

```
 <div class="news">
                <?php echo recentPosts(); ?>
                </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T09:16:52.470

要获得缩略图、标题和文本显示，您可以使用以下内容：

```
<a href="<?php the_permalink();?>"><?php the_post_thumbnail('recent-thumbnails'); ?></a>
<h2><a href="<?php the_permalink(); ?>"><?php the_title();?></a></h2>  
<p><?php the_excerpt(); ?></p>

#news img {
float:left;
margin: 0 5px 5px 0; 
}
#news h2 {}
#news p {} 
```

您可以控制摘录长度以仅显示帖子中的一定数量的字符。查看有关在 Wordpress Codex [http://codex.wordpress.org/Function_Reference/the_excerpt上使用摘录功能的更多信息](http://codex.wordpress.org/Function_Reference/the_excerpt)

# python - 通过 Eclipse PyDev 进行交互式 matplotlib

> ID：13440956
> 
> 赞同：6
> 
> 时间：2012-11-18T14:13:45.307
> 
> 标签：python, eclipse, matplotlib, pydev, ipython

[这是通过 Eclipse 线程对这个交互式 matplolib](https://stackoverflow.com/questions/3918889/interactive-matplolib-through-eclipse)的跟进，大约有 2 年的历史，我想知道在此期间是否有任何进展。

我在 Eclipse PyDev 的控制台窗口中运行 IPython 控制台，但是我无法使用 matplotlib 获得与在 Eclipse PyDev**外部**的（Windows）命令提示符下运行 IPython 相同的交互式绘图功能。以下是两者的比较：

**A) 在 Eclipse PyDev 之外的 shell 中运行 IPython**

1.  使用“ipython --pylab”在 Windows 命令提示符下运行 IPython
2.  在 IPython 控制台中输入“plot([1,2,3])”。这将打开一个图形绘图窗口，并且 IPython 控制台已准备好执行进一步的命令（无需关闭图形绘图窗口）。
3.  例如，我可以输入“xlabel('years')”，这将更新我的图形绘图窗口。

**B) 在 Eclipse PyDev 中的交互式控制台中运行 IPython 在 Eclipse PyDev** 中的 IPython 交互式控制台中输入以下内容：

1.  “从 pylab 导入 *”
2.  "plot([1,2,3])" --> 图形绘图窗口不显示。
3.  我必须输入“show()”才能打开图形绘图窗口。但现在的问题是，只要我保持图形绘图窗口打开，IPython 控制台就不会接受任何新命令。
4.  所以我关闭图形绘图窗口，输入“xlabel('years')”，然后再次输入“show()”。这将重新打开以“年”作为我的轴标签的图形绘图窗口，但绘图本身是空的，不再显示 [1,2,3] 数据。

有了这种行为，A) 显然优于 B)，但我想继续在 Eclipse PyDev 中工作，因为我喜欢总是在我的屏幕上显示变量列表（不必像运行 IPython 表单时那样运行命令来显示所有变量一个 Windows 外壳）。正如另一个线程中所建议的那样，使用 Wicked Shell 不起作用（IPython 在 Wicked Shell 中无法正常工作）。

如何在 Eclipse PyDev 中配置 IPython，使其显示与在 Windows 命令提示符下运行它相同的交互行为？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-05-13T14:32:00.400

您可以通过在 PyDev Preference 中为交互式控制台选择 GUI 来解决此问题。

Eclipse -> 窗口 -> 首选项 -> Pydev -> 交互式控制台 -> 启用 GUI 事件循环集成。

就我而言，我选择了 PyQt (qt/qt4)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-25T22:04:04.223

为可能不完整的答案道歉，但希望我能够阐明这个问题。

我相信 OP 描述的是正常行为。事实上，从命令行 ipython 开始，导入 pylab 并发出 plot 命令会产生所描述的阻塞行为，因此这与 pydev 或 eclipse 无关。事实是 matplotlib 中的 show 在交互模式下是阻塞的；当您在以“ipython --pylab”开始的 ipython 会话中使用 matplotlib 时，您正在利用 ipython 开发人员围绕 matplotlib 为您所做的一些“黑客”，允许同时具有交互模式和非阻塞调用。但是，导入 pylab 并不足以应用这些“hacks”。PyDev 似乎不允许解释器调用的标志，所以不能直接调用“ipython --pylab”。

幸运的是，ipython 有一个特殊的命令“pylab”，即使解释器没有以 pylab 标志启动，它也会应用 hack 并导入 pylab。因此，您可以尝试在控制台中输入“pylab”（实际上，您甚至可以自定义您的 pydev 控制台，使其自动完成），您应该会得到所需的行为。但是，我必须报告说，虽然从命令行启动的 ipython 会话对我来说效果很好，但是当我尝试从 Eclipse 内部执行相同操作时出现问题。该命令没有阻止，我得到了 python 图标，但 matplotlib 窗口没有出现。作为记录，我在运行 Snow Leopard 的 Mac 上。我无法判断在 Windows 中是否也会发生同样的问题，OP 似乎正在使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-16T22:10:16.913

只需使用`%matplotlib`*魔法命令*来激活交互式绘图（正是您所描述的）。

该`pylab`命令导入`numpy.*`和`pylab.*`，严重污染您的全局命名空间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T12:55:43.153

我通过在另一个线程中执行绘图功能在 Eclipse PyDev 中实现了类似的行为：

```
import threading
from pylab import *
import matplotlib.animation as animation
import time

x = array(range(0,1000))/100
y = sin(x)

def updateData(self):
    ax.set_data(x,y)

def MyThread():
    global ax
    fig, axarr = subplots(1)
    ax, = axarr.plot(x,y)
    simulation = animation.FuncAnimation(fig, updateData)
    show()

t = threading.Thread(target=MyThread)
t.start()

# console stay active, user can interactively control figure
time.sleep(1)
y = sin(2*x)
time.sleep(2)
ax.get_axes().grid()
ax.get_axes().set_xlabel("time") 
```

使用工具链 Eclipse 4.3、PyDev 2.7.1、Python 3.2、IPython 0.13 测试

# jquery - 创建后无法删除jQuery中的元素

> ID：13440957
> 
> 赞同：1
> 
> 时间：2012-11-18T14:13:48.417
> 
> 标签：jquery, element

我通过 jQuery 创建了一些元素。这些元素是可拖动和调整大小的。我可以删除初始元素（Accordeon、Flip 和 Swipe）。我的问题是当我想创建图像对象时（单击顶部栏上的图像框）。我无法删除它。请你帮助我好吗？谢谢。

这是我的 jsFiddle：http: [//jsfiddle.net/mV75R/](http://jsfiddle.net/mV75R/)

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Untitled Document</title>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.1/themes/base/jquery-ui.css" />
<script src="http://code.jquery.com/jquery-1.8.2.js"></script>
<script src="http://code.jquery.com/ui/1.9.1/jquery-ui.js"></script>
<style>
body { margin:0px; padding:0px; border:0px; font-family:Arial, Helvetica, sans-serif; }

#PageOptions { width:240px; height:100%; border-right:1px solid #E5E5E5; margin:0px; padding:5px; background:#FFF8E7; position:absolute; }

#PageContainer { width:986px; height:676px; border:3px solid #CCC; margin:10px 10px 10px 265px; background:#F1F1F1; position:absolute; }
#AdContainer { width:460px; height:670px; border:1px dashed #666; margin:0px; position:absolute; background:#FFF; }
.ui-widget-content { width:150px; height:150px; z-index:0; }
.handle { cursor: move; background-color:#CCC; padding:0px; margin:0px; }
.ui-resizable-helper { border: 1px dotted #900; }

#ObjList {width:100%; height:80px; border-bottom:1px solid #E5E5E5; display:block; background:#F1F1F1; }
ul, li { margin:0px; padding:0px; list-style-image:none; }
li { width:50px; height:50px; border:1px solid #CCC; display:inline-block; background:#F0E8BB; margin:5px; padding:5px; overflow:hidden; font-size:12px;  border-radius: 10px; }
</style>
<script>
$(function() {

    var draggableOptions = {
        containment: "#AdContainer",
        scroll: false,
        // grid: [5, 5],
        handle: ".handle",
        snap: true,
        stack: "div",
        drag: function(event, ui) {
            var objId = $(this).attr("id");
            var objPos = $(this).position();
            $("#objName").text("Comportement: " + objId);
            $("#objTopPos").text("Marge à gauche:  " + objPos.left + "px");
            $("#objLeftPos").text("Marge en haut: " + objPos.top + "px");
        }
    };

    var resizableOptions = {
            animate: true,
            containment: "#AdContainer",
            resize: function(event, ui) {
                var objWidth = ui.size.width;
                var objHeight = ui.size.height;
                $("#objWidthSize").text("Largeur: " + objWidth + "px");
                $("#objHeightSize").text("Hauteur: " + objHeight + "px");
            },
            minHeight: 100,
            minWidth: 100,
    };

    $("#adSize").text("Taille de la publicité: " + $("#AdContainer").width() + "x" + $("#AdContainer").height());

    $(".ui-widget-content").draggable(draggableOptions).resizable(resizableOptions);

    // Obj creation
    $(".createObjImage").click(function () {
        var newObjImage = $('<div id="Image" class="ui-widget-content"><p class="handle"><span class="deleteObj">[x]</span> Image</p></div>').draggable(draggableOptions).resizable(resizableOptions);
        $("#AdContainer").append(newObjImage);
    })

    $(".deleteObj").click(function () {
        $(this).parents('.ui-widget-content').remove();
    })

});
</script>
</head>

<body> 
    <div id="ObjList">
        <ul>
            <li class="createObjImage">Image</li>
            <li class="createObjAccordeon">Accordeon</li>
            <li class="createObjSwipe">Swipe</li>
            <li class="createObjVideo">Video</li>
            <li class="createObjFlip">Flip</li>
            <li class="createObjSlider">Slider</li>
        </ul>
    </div>

    <div id="PageOptions">
        <span id="adSize"></span><br />
        ----------<br />
        <span id="objName"></span><br />
        <span id="objTopPos"></span><br />
        <span id="objLeftPos"></span><br />
        <span id="objWidthSize"></span><br />
        <span id="objHeightSize"></span>
    </div>

    <div id="PageContainer">
        <div id="AdContainer">
            <div id="Accordeon" class="ui-widget-content">
                <p class="handle"><span class="deleteObj">[x]</span> Accordeon</p>
            </div>
            <div id="Flip" class="ui-widget-content">
                <p class="handle"><span class="deleteObj">[x]</span> Flip</p>
            </div>
            <div id="Swipe" class="ui-widget-content">
                <p class="handle"><span class="deleteObj">[x]</span> Swipe</p>
            </div>
        </div>
    </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:18:44.937

代替

```
$(".deleteObj").click(function () {
        $(this).parents('.ui-widget-content').remove();
    }) 
```

应该有：

```
 $("#AdContainer").on('click', '.deleteObj', function () {
        $(this).parents('.ui-widget-content').remove();
    }) 
```

演示：http: [//jsfiddle.net/mV75R/1/](http://jsfiddle.net/mV75R/1/)

`.click`只会将事件附加到现有元素。一旦您添加了应该具有该处理程序的新元素，您应该明确地将事件处理程序附加到新元素。或者你可以[`.on`](http://api.jquery.com/on/)像上面那样使用（[`.live`](http://api.jquery.com/live/)在旧版本的 jQuery 中）。它也适用于新创建的元素。

另一种选择是在创建新的 Image 元素后添加单击事件处理程序：

```
$(".createObjImage").click(function () {
        var newObjImage = $('<div id="Image" class="ui-widget-content"><p class="handle"><span class="deleteObj">[x]</span> Image</p></div>').draggable(draggableOptions).resizable(resizableOptions);
        $("#AdContainer").append(newObjImage);
        $('.deleteObj', newObjImage).click(function () {
              $(this).parents('.ui-widget-content').remove();
        });
    }) 
```

（当然，删除目标代码可以移动到单独的函数中，而不是复制/粘贴）演示：http: [//jsfiddle.net/mV75R/2/](http://jsfiddle.net/mV75R/2/)

# java - 在搜索栏中获得 onStopTrackingTouch 的进度而不是 onProgressChanged

> ID：13440965
> 
> 赞同：5
> 
> 时间：2012-11-18T14:14:51.157
> 
> 标签：java, android, seekbar

我是 android 开发的新手，我`onProgressChanged`用来获取当前进度，因为进度是函数的参数。

但是当用户释放不是即时值时**，我只想获得进度的最终值。**`seekbar`

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T17:33:08.593

当用户停止滑动（即完成触摸手势）并提供“最终值”时，将调用`onStopTrackTouch`中定义的方法。`OnSeekBarChangeListener``SeekBar`

# mysql - 数据库设计 - 多语言网站

> ID：13440968
> 
> 赞同：0
> 
> 时间：2012-11-18T14:15:23.610
> 
> 标签：mysql, database-design

我有一个多语言网站，它的用户可以拥有不同语言的个人资料，例如每个用户可以将他的个人资料以“英语”、“法语”和“西班牙语”发布，比如 LinkedIn。

现在，我是一个使用“英语”语言查看网站的用户，所以当我转到其他会员个人资料页面时，我应该看到该会员个人资料是“英语”，如果该个人资料没有该语言，我应该在该成员“main_lang”中看到该配置文件。

所以我有一个“成员”表，其中有一列是“published_profile_langs”，在这个 col 中，每个成员发布他的个人资料的语言将用逗号分隔：“english,spanish”和“main_lang”col，即用户的主要语言（他的个人资料肯定会在 main_lang 中发布，因为我们要求提供有关注册步骤的详细信息）。

另一方面，成员详细信息存储在不同的表中，例如“members_details_english”、“members_details_spanish”、“members_details_french”。

我想加入我的查询，但我管理的方式似乎不可能，目前我需要使用 2 个查询来加载上述场景中的成员详细信息，我在“members_profile.php”中的代码是：

```
// FIRST QUERY
$check_member = mysql_query("SELECT main_lang, profile_published_langs FROM members WHERE id = '$this_user_id'");
    while($row = mysql_fetch_array($check_member)){
            $this_main_lang = $row['main_lang'];
            $this_profile_published_langs = $row['profile_published_langs'];
        }
    $this_profile_published_langs_arr = explode(',', $this_profile_published_langs);
    if(!in_array($lang, $this_profile_published_langs_arr)) $lang = $this_main_lang;

$details_table = 'members_details_' . $lang;

// SECOND QUERY
$get_details = mysql_query("SELECT * FROM $details_table WHERE member_id = '$this_user_id'");
        while($row_details = mysql_fetch_array($get_details)){
            //blah blah
        } 
```

有没有更好的方法来实现这一目标？也许以某种方式查询一次而不是两次？这种情况下有更好的数据库结构吗？

我将不胜感激任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T15:03:53.333

尝试将语言视为数据库中的另一个实体。使用该表`members`存储所有不依赖于语言的数据，并有第二个数据表；`members_i18n`- 的缩写`memebers_internationalization`。

在第一个表中，您可以有一个名为的列`main_language_id`，并使用第二个表为每个成员存储不同语言的数据列，方法是使用`member_id`和关联`language_id`。这样，您可以获取所有语言的每个成员的数据，只是他们的主要语言或您需要的任何特定语言集。

另外，您不需要在表中使用序列化数据，例如`profile_published_langs`.

因此，一些示例查询将是：

```
-- Main language
SELECT * 
FROM member AS m
JOIN member_i18n AS mi
  ON m.member_id = mi.member_id
  AND m.main_language_id = mi.language_id

-- Specific language
SELECT * 
FROM member AS m
JOIN member_i18n AS mi
  ON m.member_id = mi.member_id
WHERE mi.language_id = 'eng'

-- All languages
SELECT * 
FROM member AS m
JOIN member_i18n AS mi
  ON m.member_id = mi.member_id 
```

编辑：

就个人而言，我通常使用第三张表，其语言如下所示：

```
CREATE TABLE `language` (
  `language_id` char(3) NOT NULL,
  `name` varchar(30) NOT NULL,
  `code2` char(2) NOT NULL,
  PRIMARY KEY (`language_id`)
);
-- Sample data
INSERT INTO `language` (`language_id`, `name`, `code2`) VALUES
  ('deu', 'Deutsch', 'de'),
  ('eng', 'English', 'en'); 
```

我发现它在打印多语言数据时非常有用。

编辑2：

因此，要以“当前”语言及其主要语言为用户获取数据，只需编写*如下*查询：

```
-- Current language (i.e. 'eng') + member's main language
SELECT * 
FROM member AS m
JOIN member_i18n AS mi
  ON m.member_id = mi.member_id
WHERE mi.language_id = m.main_language_id
  OR mi.language_id = 'eng' 
```

您最终会得到一两行，具体取决于成员的个人资料。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T14:32:21.880

您可以拥有一个表成员（id_user、mainlang、firstname、...）和一个表配置文件（id_user、语言和该语言的所有数据）。对于用户，每种语言都有一行。你的选择是这样的

```
select * from profile where id_user = $userId and language = $lang 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T08:23:18.480

我可能会构建一个用户表、一个语言表和一个映射表

1.  user_main - 所有常用列，此处有邮件语言列
2.  语言表 - 你想保留的任何东西，代码等，加上一个列 - 语言表名（相当于你的 user_details_spanish 等表）
3.  映射表 - 用户 ID、语言 ID（此处的一行表示该特定用户具有该语言的个人资料）

现在，我同意，您可能仍然需要两个查询，但我认为它更易于管理，因为表名可从 lang 表中获得，并且您可以将其保留在会话中（例如，您让用户从下拉列表中选择向下切换到哪种语言，表名本身就可以在那里使用，这样您就不必获取它）...

让我知道这种思想方向是否有帮助..也许我可以提供进一步的帮助...

# python - 在python中以字典的形式从mysql中读取数据库条目

> ID：13440970
> 
> 赞同：0
> 
> 时间：2012-11-18T14:15:36.270
> 
> 标签：python, mysql, database, mysql-python

> **可能重复：**
> [Python：使用 mysqldb 将 MySQL 表作为字典导入？](https://stackoverflow.com/questions/2180226/python-use-mysqldb-to-import-a-mysql-table-as-a-dictionary)

我目前使用命令以数组的形式获取数据库条目

```
db_conn = mdb.connect(host = "localhost", user = "username", passwd = "password", db = "db_name", charset='utf8')
cursor = db_conn.cursor()
cursor.execute(sql_query)
rows = cursor.fetchall() 
```

我以数组的形式获取行值。我可以以列名作为键的字典形式获得吗？我找不到任何这样的命令。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T14:18:59.073

连接时设置光标工厂：

```
db_conn = mdb.connect(
    host="localhost", user="username", passwd="password", db="db_name",
    charset='utf8', cursorclass=mdb.cursors.DictCursor) 
```

# asp.net - 在 asp.net 上处理 XMLHttpRequest 中止

> ID：13440971
> 
> 赞同：2
> 
> 时间：2012-11-18T14:16:03.897
> 
> 标签：asp.net, xmlhttprequest

我使用异步 XMLHttpRequest 调用 ASP.net Web 服务中的函数。
当我在 XMLHttpRequest 上调用 abort 方法时，在服务器接收到请求并对其进行处理后，服务器会继续处理请求。
有没有办法停止服务器上的请求处理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T08:55:50.567

一般来说，不，一旦服务器启动，您就无法停止服务器正在处理的请求。毕竟，服务器如何知道请求何时被中止？

这就像您导航到一个网页，但在第一个网页加载之前浏览到另一个网页。至少在某种程度上（任何客户端工作当然不会发生），该初始请求将得到满足。

如果您确实希望停止服务器上长时间运行的操作，则需要对正在调用的服务进行架构，以便它可以支持被中断。一些伪代码：

```
void MyLongRunningMethod(opId, args)
{
    work = GetWork(args)

    foreach(workItem in work)
    {
        DoWork(workItem)

        //Has this invocation been aborted?
        if(LookUpSet.Contains(opId))
        {
            LookUpSet.Remove(opId)
            return
        }
        //Or try this:
        if(Response.IsClientConnected)
        {
            HttpContext.Current.Response.End();
            return;
        }
    }
}

void AbortOperation(opId)
{
    LookUpSet[opId] = true
} 
```

所以这里的想法是`MyLongRunningMethod`定期检查它是否已被中止，如果是则返回。它的目的`opId`是唯一的，因此您可以根据附加当前时间或其他内容的客户端的会话 ID 生成它（在 Javascript 中，`new Date().getTime()`将为您提供自纪元以来的毫秒数）。

使用这种方法，服务器必须维护状态（`LookUpSet`在我的示例中），因此您将需要一些方法来做到这一点，例如数据库或仅将其存储在内存中。该服务还需要进行架构，以便调用 abort 不会使事物处于非工作状态，这当然在很大程度上取决于它的作用。

另一个非常重要的要求是数据可以被拆分并以块的形式处理。这就是允许服务可中断的原因。

最后，如果要中止某个操作，则`AbortOperation`必须调用 - 简单地中止 XMLHttpRequest 调用将无济于事，因为该操作将一直持续到完成。

**编辑**

来自这个问题：[ASP.Net：浏览器断开连接时如何停止页面执行？](https://stackoverflow.com/questions/5670377/asp-net-how-to-stop-page-execution-when-browser-disconnects?rq=1)

您还可以检查`Response.IsClientConnected`属性以尝试确定调用是否已中止。

一般来说，服务器在尝试向其发送数据之前不会知道客户端已断开连接。请参阅[在 .NET 中检测客户端断开连接的最佳实践？](https://stackoverflow.com/questions/1367319/best-practice-to-detect-a-client-disconnection-in-net)并[立即检测客户端与服务器套接字的断开连接](https://stackoverflow.com/questions/722240/instantly-detect-client-disconnection-from-server-socket?rq=1)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T21:23:42.813

正如 nick_w 所写，一旦服务器启动，您就无法停止服务器正在处理的请求。但是有能力实施解决方案，这将使您能够取消服务器任务。Dino Esposito 有几篇关于如何实现此类事情的精彩文章： [使用 ASP.NET AJAX 取消服务器任务](http://msdn.microsoft.com/en-us/magazine/cc163380.aspx)

并在以下文章中实现对服务器的池化 Dino Esposito 描述了如何使用 SignalR 库：使用 SignalR [构建进度条](http://msdn.microsoft.com/en-us/magazine/hh852586.aspx)； [长轮询和 SignalR](http://msdn.microsoft.com/en-us/magazine/hh882442.aspx)

因此，如果您确实需要取消服务器上的某些任务，这些文章可以作为实施所需解决方案的起点。

# iis - RewriteCond 排除目录 IIS

> ID：13440977
> 
> 赞同：1
> 
> 时间：2012-11-18T14:16:44.027
> 
> 标签：iis, mod-rewrite, rewrite

我的`.htaccess`文件中有以下规则

```
RewriteEngine On
RewriteCond %{REQUEST_URI} ^/admin/
RewriteRule !\.(js|ico|gif|jpg|jpeg|bmp|png|swf|css|html|htm|php|rar|xml|ani|cur|mp3|mp4|flv|tpl|inc)$ /admin/index.php [L,NC]

RewriteCond %{REQUEST_URI} !^/admin/
RewriteRule !\.(js|ico|gif|jpg|jpeg|bmp|png|swf|css|html|htm|php|rar|xml|ani|cur|mp3|mp4|flv|tpl|inc|doc|exe|zip)$ index.php [L,NC] 
```

我想为IIs更改它，如何更改？

```
[ISAPI_Rewrite]
RewriteEngine On

RewriteCond %{REQUEST_URI} !(/admin/.*) [NC]
RewriteRule ^[\w/\%]*(?:\.(?!(?:js|ico|gif|jpg|jpeg|bmp|png|swf|css|html|htm|php|rar|xml|ani|cur|mp3|mp4|flv|tpl|inc|doc|exe|zip|txt)$)[\w\%]*$)? /index.php [I]

RewriteCond %{REQUEST_URI} (/admin/.*) [NC]
RewriteRule ^[\w/\%]*(?:\.(?!(?:js|ico|gif|jpg|jpeg|bmp|png|swf|css|html|htm|php|rar|xml|ani|cur|mp3|mp4|flv|tpl|inc|doc|exe|zip|txt)$)[\w\%]*$)? /admin/index.php [I] 
```

# uitableview - UITableView 仅在 ViewDidAppear 中调整大小

> ID：13440978
> 
> 赞同：0
> 
> 时间：2012-11-18T14:16:51.883
> 
> 标签：uitableview, viewdidload, viewdidappear

我遇到了一个奇怪的问题，我不知道在哪里/如何解决它......

我在 UIViewController 上有 6 个 UITableViews（我正在使用故事板），我想在 ViewDidLoad 中调整它们的大小，但我不能，我发现调整它们大小的唯一方法是在 ViewDidAppear 中，问题是当我旋转我的模拟器时框架变得像 IB 中一样。

你能帮我处理这个案子吗？

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    [_hoursTable setScrollEnabled:NO];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

-(void)viewDidAppear:(BOOL)animated
{
    [_firstTable setFrame:CGRectMake(100, 0, 100, 768)];
    [_secTable setFrame:CGRectMake(200, 0, 100, 100)];
    [_thirdTable setFrame:CGRectMake(300, 0, 100, 100)];
    [_fourthTable setFrame:CGRectMake(400, 0, 100, 100)];
    [_fifthTable setFrame:CGRectMake(500, 0, 100, 100)];
    [_hoursTable setFrame:CGRectMake(600, 0, 100, 100)];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T16:58:46.413

这种类型的代码应该在`layoutSubviews`.

```
- (void)layoutSubviews {
    // your code here
} 
```

# ios - 计数器保持为零

> ID：13440981
> 
> 赞同：0
> 
> 时间：2012-11-18T14:17:32.073
> 
> 标签：ios, ios6

我一定在这里遗漏了一些东西。我已经创建了一个又一个计数器，它们都可以工作，但是在下面的代码中，计数器`i`始终保持为零。计数正确显示 18。其`mapDelays`想法是它将数组值`i`与真或假进行比较。这是从另一种绘制机场阵列（18 个机场）的引脚的方法调用的。数组中的一项是真或假的“延迟”。所以当我绘制机场时，我想看看是否有一个继电器“真​​”，如果有，把针变成红色而不是绿色。是的，我是一个新手，所以任何指针都会有所帮助 - 具体来说，我显然缺少流程和逻辑！

```
- (MKAnnotationView*)mapView:(MKMapView *)mapView viewForAnnotation:
(id<MKAnnotation>)annotation
{
    if ([annotation isKindOfClass:[AirportDetails class]]) {
        static NSString *const kPinIdentifier = @"AirportDetails";
        MKPinAnnotationView *view = (MKPinAnnotationView*)[mapView dequeueReusableAnnotationViewWithIdentifier:kPinIdentifier];

        if (!view) {
            view = [[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:kPinIdentifier];
            view.canShowCallout = YES;
            view.calloutOffset = CGPointMake(-5, 5);
            view.animatesDrop = NO;
        }
        NSLog(@"I am here");
        for (int i = 0; i < self.mapDelays.count; i++) {
            NSLog(@"DelaysCount %i",i);
            NSLog(@" %i",self.mapDelays.count);
            if ([self.mapDelays[i] isEqualToString:@"true"]) {
                view.pinColor = MKPinAnnotationColorRed;
                view.rightCalloutAccessoryView = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
                return view;
            } else
                view.pinColor = MKPinAnnotationColorGreen;
            view.rightCalloutAccessoryView = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
            //}
            return view;
        }
    } 

    return nil;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:27:52.407

在我更改代码格式后，我发现在你的第一个 for 循环中，`i`这`return view;`将停止你的 for 循环。所以你有零。下次你应该小心你的编码风格。特别是对于`{}`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T14:28:43.870

由于 if/else 的两个分支都从该方法返回，因此 for 循环只会执行一次（即 i == 0）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T14:27:38.653

我不知道 NSLog 语句中的任何 %i 说明符。 [格式说明符](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html)

```
NSLog(@"DelaysCount %i",i);
NSLog(@" %i",self.mapDelays.count); 
```

那不应该是

```
NSLog(@"DelaysCount %d",i);
NSLog(@" %d",self.mapDelays.count); 
```

# c++ - 构造函数问题

> ID：13440987
> 
> 赞同：1
> 
> 时间：2012-11-18T14:18:31.857
> 
> 标签：c++, visual-c++

我必须创建一个类直方图并对这个类进行操作。输入可以是一维数组或二维数组。当我将数组转换为矩阵时出现问题。这是我到目前为止所尝试的。错误是`<Unable to read memory>`

直方图.h

```
#ifndef HISTOGRAM_H
#define HISTOGRAM_H
#include<iostream>
class Histogram
{
private:
    int** matrix;
    int lines;
    void SortMatrix();
public:
    Histogram(){ }
    Histogram(int elements[], int elementsNr);
    Histogram(int** m, int l);
    void Print();
};
#endif 
```

直方图.cpp

```
#include"histogram.h"
using namespace std;
Histogram::Histogram(int** m, int l)
{
    matrix=m;
    lines=l;
    SortMatrix();
}

Histogram::Histogram(int elements[], int elementsNr)
{
    lines=0;
    //initialize matrix : elementrNr lines and 2 columns
    int** matrix=new int*[elementsNr];
    for(int i=0;i<elementsNr;i++)
    {
        matrix[i]=new int[2];
        matrix[i][0]=INT_MIN;
        matrix[i][1]=INT_MIN;
    }
    //search each element from the array in the matrix
    bool found=false;
    for(int i=0;i<elementsNr;i++)
    {
        found=false;
        for(int j=0;j<elementsNr;j++)
        {
            //the element was found in the matrix ( on the first column )
            if(matrix[j][0] == elements[i])
            {
                matrix[j][1]++;
                found=true;
                break;
            }
        }
        if(!found)
        {
            matrix[lines][0]=elements[i];
            matrix[lines][1]=1;
            lines++;
        }
    }
    SortMatrix();
}
void Histogram::SortMatrix()
{
    bool flag=true;
    int temp;
    for(int i=0;(i<lines) && flag;i++)
    {
        flag=false;
        if(matrix[i+1][0]>matrix[i][0])
        {
            temp=matrix[i][0];
            matrix[i][0]=matrix[i+1][0];
            matrix[i+1][0]=temp;
            flag=true;
        }
    }
}
void Histogram::Print()
{

    for(int i=0;i<lines;i++)
    {
        cout<<matrix[i][0]<<" : " <<matrix[i][1]<<endl;
    }

} 
```

主文件

```
#include"histogram.h"
#include<iostream>
using namespace std;

int main()
{
    int arr[]={6,7,3,1,3,2,4,4,7,5,1,1,5,6,6,4,5};
    Histogram h(arr,17);
    h.Print();
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-18T14:21:37.440

这里

```
int** matrix=new int*[elementsNr]; 
```

用。。。来代替

```
matrix=new int*[elementsNr]; 
```

因为`matrix`已经是一个成员变量。您正在创建一个名为的新临时变量双指针`matrix`并为其分配内存而不是您的成员变量`matrix`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T14:42:27.103

一些人已经就如何解决这段代码的一些问题给了你建议。我将给出稍微不同的建议，相比之下，这些建议最初可能看起来有点残酷，但我会尝试展示它是如何真正有用而不是令人讨厌的。

我会扔掉你现有的代码，可能会有例外`main`，然后使用`std::map`. 您现在所做的基本上是尝试重新创建`std::map`已经提供的功能（即使您的代码已修复，它也不能像`std::map`开箱即用那样做好工作）。

使用 map，你的*整个*程序会变成这样：

```
std::ostream &operator<<(std::ostream &os, std::pair<int, int> const &d) { 
    return os << d.first << " : " << d.second;
}

int main() { 
    std::map<int, int> h;

    for (int i=0; i<17; i++)
        ++h[arr[i]];

    std::copy(h.begin(), h.end(), 
              std::ostream_iterator<std::pair<int, int> >(std::cout, "\n"));
    return 0;
} 
```

如果你想维护与你的`histogram`类提供的几乎相同的接口，这很容易做到——`for`循环进入构造函数，`copy`进入`print`（并`SortMatrix`消失，因为 a`map`总是排序的）。

通过这样做，您从 O(N ² ) 算法更改为 O(N log N) 算法。其他人指出的错误完全消失了，因为不再需要包含它们的代码。我能看到的唯一真正的缺点是结果可能*会*使用更多的内存——它使用具有单独分配节点的平衡树，这可能会为仅包含 2 `int`s 的节点引入相当多的开销（以及位用于平衡）。不过，我无法完全想象会担心这一点——早在你有足够的节点让内存使用变得重要之前，你有太多的东西要展示，甚至无法考虑展示给用户*。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T14:28:31.500

@mathematician1975 已经为主要问题提供了答案。中还有另一个错误`SortMatrix()`：您只交换第一列的元素，因此在排序后，计数（在第二列中）将不再正确。你必须插入

```
temp=matrix[i][1];
matrix[i][1]=matrix[i+1][1];
matrix[i+1][1]=temp; 
```

让它工作。

# sql - SQL 随机聚合

> ID：13440992
> 
> 赞同：11
> 
> 时间：2012-11-18T14:19:04.913
> 
> 标签：sql, aggregate-functions

假设我有一个包含 3 个字段的简单表：“地点”、“用户”和“字节”。假设，在某个过滤器下，我想按“地点”分组，并且对于每个“地点”，汇总该地点的所有字节，并随机选择该地点的用户（从所有符合条件的用户中统一选择'where' 过滤器和相关的 'place'）。如果有一个“随机选择”聚合函数，我会这样做：

```
SELECT place, SUM(bytes), SELECT_AT_RANDOM(user) WHERE .... GROUP BY place; 
```

...但我找不到这样的聚合函数。我错过了什么吗？什么是实现这一目标的好方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T14:34:58.583

如果您的 RDBMS 支持分析功能。

```
WITH T
     AS (SELECT place,
                Sum(bytes) OVER (PARTITION BY place) AS Sum_bytes,
                user,
                Row_number() OVER (PARTITION BY place ORDER BY random_function()) AS RN
         FROM   YourTable
         WHERE  .... )
SELECT place,
       Sum_bytes,
       user
FROM   T
WHERE  RN = 1; 
```

对于 SQL Server`Crypt_gen_random(4)`或`NEWID()`将是可以替代的示例`random_function()`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T15:27:06.917

我认为您的问题是特定于 DBMS 的。如果您的 DBMS 是 MySql，您可以使用这样的解决方案：

```
SELECT place_rand.place, SUM(place_rand.bytes), place_rand.user as random_user
FROM
  (SELECT place, bytes, user
   FROM place
   WHERE ...
   ORDER BY rand()) place_rand
GROUP BY
  place_rand.place; 
```

子查询以随机顺序排列记录。外部查询按`place`、求和`bytes`并返回第一个随机用户，因为用户不在聚合函数中，也不在 group by 子句中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-14T22:22:54.427

使用自定义聚合函数，您可以编写如下简单的表达式：

```
SELECT place, SUM(bytes), SELECT_AT_RANDOM(user) WHERE .... GROUP BY place; 
```

`SELECT_AT_RAMDOM`将是自定义聚合函数。

这正是**PostgreSQL**中[的一个实现](https://wiki.postgresql.org/wiki/Aggregate_Random)。

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-18T23:24:48.643

我会对 Martin 的解决方案做一些改动：

```
select place, sum(bytes), max(case when seqnum = 1 then user end) as random_user
from (select place, bytes,
             row_number() over (partition by place order by newid()) as sequm
       from t
      ) t
group by place 
```

（其中 newid() 只是获取随机数的一种方法，具体取决于数据库。）

出于某种原因，我更喜欢这种方法，因为它在外部查询中仍然具有聚合功能。如果您正在总结一堆领域，那么这对我来说似乎更清晰。**

# java - 如何在 Java 的主文件夹（或 Windows 的 appdata 文件夹）中获得写权限？

> ID：13440993
> 
> 赞同：3
> 
> 时间：2012-11-18T14:19:09.183
> 
> 标签：java, permissions, io

我试图在 home/appdata 文件夹中保存一些用户设置，但是当我使用 dir.canwrite() 它返回 false。这是我用来确定 home/appdata 文件夹的代码：

```
public static String getAppDataPath() {
    if (System.getProperty("os.name").contains("Windows")) {
        return System.getenv("APPDATA");
    } else {
        return getUnixHome();
    }
}

public static String getUnixHome() {
    String home = System.getProperty("user.home");
    return home != null ? home : "~";
} 
```

这是尝试 mkdir 的代码：

```
public static boolean checkExistenceDir(String path) {
    File dir = new File(path);
    if(!dir.exists()) {
        dir.mkdir();
    }
} 
```

有问题的路径是：

```
getAppDataPath() + ".foo" + File.separatorChar 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T14:27:08.910

您需要以管理员身份启动 Java 进程。

[您可以在 Windows 中创建一个 run.vbs 脚本来启动您的 jar](https://stackoverflow.com/questions/13060215/vbscript-single-line-as-administrator)：

```
Set oShell = CreateObject("Shell.Application")
oShell.ShellExecute "cmd.exe", , , "runas", 1
oShell.Run "java -jar myjar.jar" 
```

要使程序始终以管理员身份运行，您需要它至少以管理员身份运行一次并更新注册表项。

# java - 在 Omnifaces 中找不到类异常

> ID：13440997
> 
> 赞同：0
> 
> 时间：2012-11-18T14:19:29.073
> 
> 标签：java, jsf-2, richfaces, omnifaces

当我尝试使用 omnifaces 时出现此错误

> 引起：java.lang.ClassNotFoundException：org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1516) 的 org.omnifaces.exceptionhandler.FullAjaxExceptionHandlerFactory org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader. java:1361) 在 java.lang.Class.forName0(Native Method) 在 java.lang.Class.forName(Class.java:247) 在 javax.faces.FactoryFinder.getImplGivenPreviousImpl(FactoryFinder.java:591)

请任何人都可以帮助我并告诉我是什么问题？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T14:34:15.977

这意味着您在类路径中缺少一个 jar。找到包含的 jar`org.omnifaces.exceptionhandler.FullAjaxExceptionHandlerFactory`并将其添加到您的类路径中。

# php - 为什么我的正则表达式允许超过 1

> ID：13440999
> 
> 赞同：0
> 
> 时间：2012-11-18T14:19:38.943
> 
> 标签：php, regex

`.`当`www`旁边的规则正常工作时，我的 url 验证正则表达式允许超过 1 个。你能明白为什么以及如何解决它吗？并随时评论我的正则表达式

```
function isurl($this_url)
{
        if(preg_match("/^((http|https):\/{2})+([w]{3})+([\.]{1})+([a-zA-Z0-9-]+)+([\.]{1})+((a[cdefgilmnoqrstuwxz]|aero|arpa)|(b[abdefghijmnorstvwyz]|biz)|(c[acdfghiklmnorsuvxyz]|cat|com|coop)|d[ejkmoz]|(e[ceghrstu]|edu)|f[ijkmor]|(g[abdefghilmnpqrstuwy]|gov)|h[kmnrtu]|(i[delmnoqrst]|info|int)|(j[emop]|jobs)|k[eghimnprwyz]|l[abcikrstuvy]|(m[acdghklmnopqrstuvwxyz]|mil|mobi|museum)|(n[acefgilopruz]|name|net)|(om|org)|(p[aefghklmnrstwy]|pro)|qa|r[eouw]|s[abcdeghijklmnortvyz]|(t[cdfghjklmnoprtvwz]|travel)|u[agkmsyz]|v[aceginu]|w[fs]|y[etu]|z[amw])$/i", $this_url)) 
            {
            return true;
            }

}

$this_url = "http://www..domain.com";

if (isurl($this_url)) 
{echo "Success";} 
else 
{echo "Fail";} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T14:22:07.433

> “([.]{1})+”

加号表示“一次或多次”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-18T14:22:19.513

`([\.]{1})+`评估为`(.){1 or more times}`。在正则表达式中，+**不是**串联。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-18T14:23:24.883

去掉`+`this 中的`([\.]{1})+`，`+`表示一个或多个。试试这个

```
([\.]{1}) 
```