# StackOverflow 问答 15341000-15341999

# python - 运行 bin/python setup.py test-q 的生产服务器上的语法错误

> ID：15341000
> 
> 赞同：1
> 
> 时间：2013-03-11T14:24:43.323
> 
> 标签：python, python-3.x, pyramid

当我尝试在生产服务器上执行以下操作时：

```
 $ sudo -u vretnet ../bin/python setup.py test -q 
```

它会显示以下错误，我应该如何解决这个问题？还是我的 development.ini 出错了？

```
 Traceback (most recent call last):
    File "setup.py", line 34, in <module>
        paster_plugins=['pyramid'],
    File "/opt/python3.2.3/lib/python3.2/distutils/core.py", line 148, in setup
        dist.run_commands()
    File "/opt/python3.2.3/lib/python3.2/distutils/dist.py", line 917, in run_commands
        self.run_command(cmd)
    File "/opt/python3.2.3/lib/python3.2/distutils/dist.py", line 936, in run_command
        cmd_obj.run()
    File "/home/vretnet/env/lib/python3.2/site-packages/distribute-0.6.34-py3.2.egg/setuptools/command/test.py", line 138, in run self.with_project_on_sys_path(self.run_tests)
    File "/home/vretnet/env/lib/python3.2/site-packages/distribute-0.6.34-py3.2.egg/setuptools/command/test.py", line 118, in with_project_on_sys_path 
        func()
    File "/home/vretnet/env/lib/python3.2/site-packages/distribute-0.6.34-py3.2.egg/setuptools/command/test.py", line 164, in run_tests
        testLoader = cks
    File "/opt/python3.2.3/lib/python3.2/unittest/main.py", line 123, in __init__
        self.parseArgs(argv)
    File "/opt/python3.2.3/lib/python3.2/unittest/main.py", line 191, in parseArgs
        self.createTests()
    File "/opt/python3.2.3/lib/python3.2/unittest/main.py", line 198, in createTests
        self.module)
    File "/opt/python3.2.3/lib/python3.2/unittest/loader.py", line 132, in loadTestsFromNames
        suites = [self.loadTestsFromName(name, module) for name in names]
    File "/opt/python3.2.3/lib/python3.2/unittest/loader.py", line 132, in <listcomp>
        suites = [self.loadTestsFromName(name, module) for name in names]
    File "/opt/python3.2.3/lib/python3.2/unittest/loader.py", line 91, in loadTestsFromName
        module = __import__('.'.join(parts_copy))
    File "/home/vretnet/env/ECommerce/ecommerce/__init__.py", line 1, in <module>
        from pyramid.config import Configurator
    File "/home/vretnet/env/lib/python3.2/site-packages/pyramid-1.4-py3.2.egg/pyramid/config/__init__.py", line 10, in <module>
        from webob.exc import WSGIHTTPException as WebobWSGIHTTPException
    File "/home/vretnet/env/lib/python3.2/site-packages/WebOb-1.2.3-py3.2.egg/webob/exc.py", line 1115, in <module>
        from paste import httpexceptions
    File "/home/vretnet/env/lib/python3.2/site-packages/Paste-1.7.5.1-py3.2.egg/paste/httpexceptions.py", line 634
        except HTTPException, exc:
                    ^
    SyntaxError: invalid syntax 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:32:35.843

它是 Python 3，你应该写`as`：

```
except HTTPException as exc: 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-20T09:47:38.133

这花了我几天时间才弄明白><。但请确保您安装了正确的 mod_wsgi 版本。您可以安装使用 python2 或使用 python3 的安装。

如果您安装 python3 wsgi mod 并使用 virtualenv2 来构建您的 python 环境，您将获得不是为 python3 编写的包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-20T12:05:04.080

你只需使用下面的这个补丁。

```
$ 2to3 example.py 
```

[https://docs.python.org/2.7/library/2to3.html#to3-python-2-3](https://docs.python.org/2.7/library/2to3.html#to3-python-2-3)

自动递归地将代码从 python2 转换为 python3。

# cakephp - 为什么 cookie 没有保存在 Cakephp 中？

> ID：15341001
> 
> 赞同：4
> 
> 时间：2013-03-11T14:24:49.193
> 
> 标签：cakephp, cookies

这真让我抓狂。在我的 AppController 中，我有以下内容：

```
public function beforeFilter() {
    $this->Cookie->name = 'MyCookie';
    $this->Cookie->time =  '1 year';
    $this->Cookie->domain = 'http://mydomain.com';
    $firstVisit = $this->Cookie->read('foo');
    if ( empty($firstVisit) ) {
        $this->set('firstVisit', true);
        $this->Cookie->write('foo', 'true');
    } else {
        $this->set('firstVisit', false);
    }
} 
```

这似乎应该可以工作，但没有返回任何内容并且 cookie 是完全空白的。

有什么可能阻止 Cake 实际保存 Cookie？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-07T07:45:57.273

在呈现视图之前不会设置 cookie。也许您没有控制器的视图？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T14:40:15.690

`http://`导致它破裂。删除它可以解决问题。

# ember.js - 两个 Ember.JS ArrayControllers？

> ID：15341005
> 
> 赞同：0
> 
> 时间：2013-03-11T14:24:59.377
> 
> 标签：ember.js

我正在构建的 Ember.JS 应用程序有点问题：

```
 App.userController = Ember.ArrayController.create({
        content: [],

        init: function() {
            this.set('content', []);
            this.refresh();
        },

        refresh: function() {
            //Refresh Action
        }
    });

    App.supplierController = Ember.ArrayController.create({
        content: [],

        init: function() {
            this.set('content', []);
            this.refresh();
        },

        refresh: function() {
            //Refresh Action
        }
    });

    <h1>Users</h1>
    {{#each user in App.userController}}
        {{user.name}} - {{user.age}}
    {{/each}}

    <h1>Suppliers</h1>
    {{#each supplier in App.supplierController}}
        {{supplier.name}} - {{supplier.revenue}}
    {{/each}} 
```

它有效......但用户显示在与供应商相同的列表中？如果我删除供应商控制器，它们会显示在正确的位置。我认为这与有两个实例有关，`Ember.ArrayController`但我不确定。它显示如下：

```
Users
-----------
Suppliers
-----------
User 1 - 
User 2 -
Supplier 1 - £100 
```

什么时候应该显示这个：

```
Users
-----------
User 1 - 30 
User 2 - 25

Suppliers
-----------
Supplier 1 - £100 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:41:50.787

你的代码看起来不错。拥有两个`ArrayController`. 我根据您的问题制作了一个 jsbin，并在正确的位置查看用户/供应商。在这里查看：http: [//jsbin.com/ovitak/1/edit](http://jsbin.com/ovitak/1/edit)

由于您的示例没有显示数据是如何加载的，因此我实现了 refresh() 方法以根据您的预期输出填充用户/供应商列表：

```
App = Ember.Application.create({});

App.userController = Ember.ArrayController.create({
    content: [],

    init: function() {
        this.set('content', []);
        this.refresh();
    },

    refresh: function() {
      this.addObject({name: 'u 1', age: 22});
      this.addObject({name: 'u 2', age: 35});
    }
});

App.supplierController = Ember.ArrayController.create({
    content: [],

    init: function() {
        this.set('content', []);
        this.refresh();
    },

    refresh: function() {
        //Refresh Action
      this.addObject({name: 'supplier 1', revenue: 200});
    }
}); 
```

# javascript - 使用 pdf.js 和 ImageData 将 .pdf 渲染到单个 Canvas

> ID：15341010
> 
> 赞同：17
> 
> 时间：2013-03-11T14:25:07.790
> 
> 标签：javascript, html5-canvas, getimagedata, pdf.js, putimagedata

我正在尝试使用 PDF.js 阅读整个 .pdf 文档，然后在单个画布上呈现所有页面。

我的想法：将每个页面渲染到画布上并获取 ImageData (context.getImageData())，清除画布做下一页。我将所有 ImageDatas 存储在一个数组中，一旦所有页面都在那里，我想将数组中的所有 ImageDatas 放到一个画布上。

```
var pdf = null;
PDFJS.disableWorker = true;
var pages = new Array();
    //Prepare some things
    var canvas = document.getElementById('cv');
    var context = canvas.getContext('2d');
    var scale = 1.5;
    PDFJS.getDocument(url).then(function getPdfHelloWorld(_pdf) {
        pdf = _pdf;
        //Render all the pages on a single canvas
        for(var i = 1; i <= pdf.numPages; i ++){
            pdf.getPage(i).then(function getPage(page){
                var viewport = page.getViewport(scale);
                canvas.width = viewport.width;
                canvas.height = viewport.height;
                page.render({canvasContext: context, viewport: viewport});
                pages[i-1] = context.getImageData(0, 0, canvas.width, canvas.height);
                context.clearRect(0, 0, canvas.width, canvas.height);
                p.Out("pre-rendered page " + i);
            });
        }

    //Now we have all 'dem Pages in "pages" and need to render 'em out
    canvas.height = 0;
    var start = 0;
    for(var i = 0; i < pages.length; i++){
        if(canvas.width < pages[i].width) canvas.width = pages[i].width;
        canvas.height = canvas.height + pages[i].height;
        context.putImageData(pages[i], 0, start);
        start += pages[i].height;
    }
    }); 
```

所以从我理解的方式来看，这应该有效，对吧？当我运行它时，我最终得到的画布足够大，可以包含 pdf 的所有页面，但不显示 pdf ......

感谢您的帮助。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-04-29T22:14:37.347

PDF 操作在所有阶段都是异步的。这意味着您还需要在最后一次渲染时获得承诺。如果你没有抓住它，你只会得到一个空白画布，因为在循环继续到下一页之前渲染还没有完成。

提示：我还建议您使用其他东西，`getImageData`因为这将存储未压缩的位图，例如 data-uri 而不是压缩数据。

这是一种稍微不同的方法，它消除了 for 循环，并为此目的更好地使用了 Promise：

**[现场小提琴](http://jsfiddle.net/epistemex/LUNaJ/)**

```
var canvas = document.createElement('canvas'), // single off-screen canvas
    ctx = canvas.getContext('2d'),             // to render to
    pages = [],
    currentPage = 1,
    url = 'path/to/document.pdf';              // specify a valid url

PDFJS.getDocument(url).then(iterate);   // load PDF document

/* To avoid too many levels, which easily happen when using chained promises,
   the function is separated and just referenced in the first promise callback
*/

function iterate(pdf) {

    // init parsing of first page
    if (currentPage <= pdf.numPages) getPage();

    // main entry point/function for loop
    function getPage() {

        // when promise is returned do as usual
        pdf.getPage(currentPage).then(function(page) {

            var scale = 1.5;
            var viewport = page.getViewport(scale);

            canvas.height = viewport.height;
            canvas.width = viewport.width;

            var renderContext = {
                canvasContext: ctx,
                viewport: viewport
            };

            // now, tap into the returned promise from render:
            page.render(renderContext).then(function() {

                // store compressed image data in array
                pages.push(canvas.toDataURL());

                if (currentPage < pdf.numPages) {
                    currentPage++;
                    getPage();        // get next page
                }
                else {
                    done();           // call done() when all pages are parsed
                }
            });
        });
    }

} 
```

然后，当您需要检索页面时，您只需创建一个图像元素并将 data-uri 设置为源：

```
function drawPage(index, callback) {
    var img = new Image;
    img.onload = function() {
        /* this will draw the image loaded onto canvas at position 0,0
           at the optional width and height of the canvas.
           'this' is current image loaded 
        */
        ctx.drawImage(this, 0, 0, ctx.canvas.width, ctx.canvas.height);
        callback();          // invoke callback when we're done
    }
    img.src = pages[index];  // start loading the data-uri as source
} 
```

由于图像加载，它本质上也是异步的，这就是我们需要回调的原因。如果您不想要异步性质，那么您也可以在上面存储图像元素而不是 data-uris 的渲染承诺中执行此步骤（创建和设置图像元素）。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-11T19:16:38.253

我无法谈论将 pdf 呈现为画布的代码部分，但我确实看到了一些问题。

*   *每次*重置 canvas.width 或 canvas.height 都会自动清除画布内容。因此，在顶部，不需要您的 clearRect，因为在您的每个 page.render 之前，canvas.width 都会清除画布。
*   更重要的是，在底部，每次调整画布大小（哎呀！）都会清除您以前的所有 pdf 绘图。
*   getImageData() 获取一个**数组**，其中每个像素由该数组的 4 个连续元素表示（红色然后绿色然后蓝色然后 alpha）。由于 getImageData() 是一个数组，所以它没有 pages[i].width 或 pages[i].height——它只有 pages[i].length。该数组长度不能用于确定宽度或高度。

因此，为了让您开始，我将首先将您的代码更改为此**（非常非常未经测试！）：**

```
var pdf = null;
PDFJS.disableWorker = true;
var pages = new Array();
//Prepare some things
var canvas = document.getElementById('cv');
var context = canvas.getContext('2d');
var scale = 1.5;
var canvasWidth=0;
var canvasHeight=0;
var pageStarts=new Array();
pageStarts[0]=0;

PDFJS.getDocument(url).then(function getPdfHelloWorld(_pdf) {
    pdf = _pdf;
    //Render all the pages on a single canvas
    for(var i = 1; i <= pdf.numPages; i ++){
        pdf.getPage(i).then(function getPage(page){
            var viewport = page.getViewport(scale);
            // changing canvas.width and/or canvas.height auto-clears the canvas
            canvas.width = viewport.width;
            canvas.height = viewport.height;
            page.render({canvasContext: context, viewport: viewport});
            pages[i-1] = context.getImageData(0, 0, canvas.width, canvas.height);
            // calculate the width of the final display canvas
            if(canvas.width>maxCanvasWidth){
              maxCanvasWidth=canvas.width;
            }
            // calculate the accumulated with of the final display canvas
            canvasHeight+=canvas.height;
            // save the "Y" starting position of this pages[i]
            pageStarts[i]=pageStarts[i-1]+canvas.height;
            p.Out("pre-rendered page " + i);
        });
    }

    canvas.width=canvasWidth; 
    canvas.height = canvasHeight;  // this auto-clears all canvas contents
    for(var i = 0; i < pages.length; i++){
        context.putImageData(pages[i], 0, pageStarts[i]);
    }

}); 
```

**或者，这是一种更传统的完成任务的方式：**

使用单个“显示”画布并允许用户“翻阅”每个所需的页面。

既然您已经开始将每个页面绘制到画布中，为什么不为每个页面保留一个单独的隐藏画布。然后当用户想要查看第 6 页时，您只需将隐藏的画布#6 复制到您的显示画布上。

Mozilla 开发人员在这里的 pdfJS 演示中使用了这种方法：http: [//mozilla.github.com/pdf.js/web/viewer.html](http://mozilla.github.com/pdf.js/web/viewer.html)

您可以在此处查看查看器的代码：http: [//mozilla.github.com/pdf.js/web/viewer.js](http://mozilla.github.com/pdf.js/web/viewer.js)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-10T03:07:46.073

您可以将数字页面传递给承诺，获取该页面的画布数据并在画布上以正确的顺序呈现

 **```
 var renderPageFactory = function (pdfDoc, num) {
        return function () {

            var localCanvas = document.createElement('canvas');

            ///return pdfDoc.getPage(num).then(renderPage);
            return  pdfDoc.getPage(num).then((page) => {
                renderPage(page, localCanvas, num);
            });

        };
    };

    var renderPages = function (pdfDoc) {
        var renderedPage = $q.resolve();
        for (var num = 1; num <= pdfDoc.numPages; num++) {
            // Wait for the last page t render, then render the next
            renderedPage = renderedPage.then(renderPageFactory(pdfDoc, num));
        }
    };

    renderPages(pdf); 
```*  *完整示例

 **```
 function renderPDF(url, canvas) {

    var pdf = null;
    PDFJS.disableWorker = true;
    var pages = new Array();

    var context = canvas.getContext('2d');
    var scale = 1;

    var canvasWidth = 256;
    var canvasHeight = 0;
    var pageStarts = new Array();
    pageStarts[0] = 0;

    var k = 0;

    function finishPage(localCanvas, num) {
        var ctx = localCanvas.getContext('2d');

        pages[num] = ctx.getImageData(0, 0, localCanvas.width, localCanvas.height);

        // calculate the accumulated with of the final display canvas
        canvasHeight += localCanvas.height;
        // save the "Y" starting position of this pages[i]
        pageStarts[num] = pageStarts[num -1] + localCanvas.height;

        if (k + 1 >= pdf.numPages)
        {

            canvas.width = canvasWidth;
            canvas.height = canvasHeight;  // this auto-clears all canvas contents
            for (var i = 0; i < pages.length; i++) {
                context.putImageData(pages[i+1], 0, pageStarts[i]);
            }

            var img = canvas.toDataURL("image/png");
            $scope.printPOS(img);
        }

        k++;

    }

    function renderPage(page, localCanvas, num) {

        var ctx = localCanvas.getContext('2d');

        var viewport = page.getViewport(scale);

        // var viewport = page.getViewport(canvas.width / page.getViewport(1.0).width);
        // changing canvas.width and/or canvas.height auto-clears the canvas
        localCanvas.width = viewport.width;

        /// viewport.width = canvas.width;
        localCanvas.height = viewport.height;

        var renderTask = page.render({canvasContext: ctx, viewport: viewport});

        renderTask.then(() => {
            finishPage(localCanvas, num);
        });

    }

    PDFJS.getDocument(url).then(function getPdfHelloWorld(_pdf) {

        pdf = _pdf;

        var renderPageFactory = function (pdfDoc, num) {
            return function () {

                var localCanvas = document.createElement('canvas');

                ///return pdfDoc.getPage(num).then(renderPage);
                return  pdfDoc.getPage(num).then((page) => {
                    renderPage(page, localCanvas, num);
                });

            };
        };

        var renderPages = function (pdfDoc) {
            var renderedPage = $q.resolve();
            for (var num = 1; num <= pdfDoc.numPages; num++) {
                // Wait for the last page t render, then render the next
                renderedPage = renderedPage.then(renderPageFactory(pdfDoc, num));
            }
        };

        renderPages(pdf);

    });

} 
```****

# .net - String 和 StringBuilder 内存不足

> ID：15341013
> 
> 赞同：-1
> 
> 时间：2013-03-11T14:25:16.947
> 
> 标签：.net, string, out-of-memory, stringbuilder

我先用 StringBuilder 编写了下面的代码，然后遇到 Out Of Memory Exception，阅读相关问题并将其更改为 string += 但仍然收到相同的 OOM 错误。

我有 ~2100+ 个不同大小的文件，总共 ~200MB+。

由于限制，我不能使用附加模式文件访问。有什么建议吗？

```
const string myPath = @"C:\values\";

var files = Directory.EnumerateFiles(myPath).Select(Path.GetFileNameWithoutExtension);
var filesGrouped = files.Where(f => f.Length > 12).GroupBy(f => f.Substring(0, f.Length - 9)).OrderBy(f => f.Key).ToList();

filesGrouped.ForEach(fg =>
    {
        var myRows = string.Empty;

        // download files
        fg.ToList().ForEach(gf =>
            {
                string myFile;
                string fileToRead = string.Format("{0}{1}.csv", myPath, gf);
                using (var sr = new StreamReader(fileToRead)) myFile = sr.ReadToEnd();
                //! OOM Error hits the line below
                myRows += myFile + ControlChars.NewLine;
            });

        // upload new file
        using (var sw = new StreamWriter(myPath + fg.Key + ".csv", false, Encoding.UTF8)) sw.Write(myRows);
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:39:17.530

你可以试试：

```
filesGrouped.ForEach(fg =>
{
    using (var sw = new StreamWriter(myPath + fg.Key + ".csv", false, Encoding.UTF8))
    {
        fg.ToList().ForEach(gf =>
        {
            string fileToRead = string.Format("{0}{1}.csv", myPath, gf);
            using (var sr = new StreamReader(fileToRead))
            {
                foreach (var line in sr.ReadLine())
                {
                    sw.WriteLine(line);
                }
                sw.Write(Environment.NewLine);
            }
        });

    }
}); 
```

如果这也失败了（文件内容在一行上），您必须选择使用相同的原则，[StreamReader.Read](http://msdn.microsoft.com/en-us/library/system.io.streamreader.read.aspx)与[StreamWriter.Write](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.write.aspx)结合使用。

# regex - 正则表达式检查至少 3 个字符？

> ID：15341016
> 
> 赞同：29
> 
> 时间：2013-03-11T14:25:26.983
> 
> 标签：regex

我有这个正则表达式只允许字母数字字符。

如何检查字符串是否也至少包含 3 个字母字符。

我目前的正则表达式，

```
if(!/^[a-zA-Z0-9]+$/.test(val)) 
```

我想强制执行字符串以确保至少有 3 个连续的字母字符；

```
111 // false
aaa1 // true
11a // false
bbc // true
1a1aa // false 
```

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-03-11T14:28:31.573

`+`表示“1 次或多次出现”。

`{3}`意思是“3 次出现”。

`{3,}`表示“出现 3 次或多次”。

`+`也可以写成`{1,}`。

`*`也可以写成`{0,}`。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2013-03-11T14:30:25.920

要在任何地方强制使用三个字母字符，

```
/(.*[a-z]){3}/i 
```

应该足够了。

**编辑。**啊，你已经编辑了你的问题，说三个字母字符必须是连续的。我还看到您可能希望强制*所有*字符都应与您的“接受”字符之一匹配。然后，前瞻可能是最干净的解决方案：

```
/^(?.*[a-z]{3})[a-z0-9]+$/i 
```

请注意，我使用不区分大小写的修饰符`/i`以避免必须编写`a-zA-Z`.

**选择。**您可以在此处阅读有关[环视断言的](http://www.regular-expressions.info/lookaround.html)更多信息。但在这个阶段，它可能有点过头了。这是一个替代方案，您可能会发现根据您已经知道的内容更容易分解：

```
/^([a-z0-9]*[a-z]){3}[a-z0-9]*$/i 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-03-11T14:33:14.843

这应该做的工作：

`^([0-9]*[a-zA-Z]){3,}[0-9]*$`

它检查至少 3 个“零个或多个数字 + 1 个 Alpha”序列 + 零个或多个数字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T14:34:31.523

你想匹配零个或多个数字，然后是 3 个连续的字母，然后是任何其他数字？

`/\d*(?:[a-zA-Z]){3,}\d*/`

# c - 无法使用 CMAKE 构建 Makefile，未指定编译器

> ID：15341019
> 
> 赞同：0
> 
> 时间：2013-03-11T14:25:32.803
> 
> 标签：c, windows, opencv, makefile, cmake

我正在尝试使用 OpenCV for Java Desktop（自 2013 年 2 月 15 日起可用）来做一个简单的人脸识别项目（用于学习目的），我在 Windows 中构建 OpenCV 时遇到问题。

我正在关注本[教程](http://docs.opencv.org/2.4.4-beta/doc/tutorials/introduction/desktop_java/java_dev_intro.html)，但我陷入了构建部分，您需要在其中生成一个 Makefile。

我执行了以下命令（如教程所述）：

`cmake -DBUILD_SHARED_LIBS=OFF`

并得到以下错误：

```
Compiling the CXX compiler identification source file "CMakeCXXCompilerId.cpp" failed.
Compiler: cl 
Build flags: 
Id flags:

The output was:
O sistema não pode encontrar o arquivo especificado(System couldn't find the specified file).

Compiling the CXX compiler identification source file "CMakeCXXCompilerId.cpp" failed.
Compiler: cl 
Build flags: 
Id flags: -c 

The output was:
O sistema não pode encontrar o arquivo especificado(System couldn't find the specified file) 

Compiling the C compiler identification source file "CMakeCCompilerId.c" failed.
Compiler: cl 
Build flags: 
Id flags: 

The output was:
O sistema não pode encontrar o arquivo especificado(System couldn't find the specified file).

Compiling the C compiler identification source file "CMakeCCompilerId.c" failed.
Compiler: cl 
Build flags: 
Id flags: -c

The output was:
O sistema não pode encontrar o arquivo especificado(System couldn't find the specified file).

Compiling the C compiler identification source file "CMakeCCompilerId.c" failed.
Compiler: cl 
Build flags: 
Id flags: -Aa

The output was:
O sistema não pode encontrar o arquivo especificado(System couldn't find the specified file).

Determining if the CXX compiler works failed with the following output: 
```

我是 C 的新手，但我认为这可能是我的编译器的问题，我安装了 MinGW，但我不知道如何指定 CMake 他在哪里。

我也尝试运行 CMake GUI，但它返回了相同的错误。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T20:13:03.083

您无需向 CMake 指定 MinGW 所在的位置，因为它位于 PATH 环境变量中。如果要安装支持 Java Desktop 的 OpenCV 2.4.4，则无需编译所有源代码，只需从[此处](http://sourceforge.net/projects/opencvlibrary/files/opencv-win/2.4.4/)下载可执行文件（也在您提到的教程中指定）并将其解压缩到要安装的目录. 就是这样。

在以前的版本中，当它是实验性的时，为 Java 编译 Opencv 是必要的。

# php - 无法绕过此错误：调用未定义的方法 DateTime::createFromFormat()

> ID：15341021
> 
> 赞同：4
> 
> 时间：2013-03-11T14:25:37.490
> 
> 标签：php

我正在尝试在 php 中转换日期格式。

以下代码会创建持久性错误

```
$myDate = "31/12/1980";

$myDateTime = DateTime::createFromFormat('d/m/Y', "$myDate"); 

$newDate = $myDateTime->format('d M Y');

echo $newDate; 
```

包含 createFromFormat() 的行不断创建错误：“调用未定义的方法”。这发生在我的测试 Apache 服务器和实际服务器上，两者都运行 PHP 5.3+

我需要包含或需要其他文件吗？请帮助 - 我只是 php 的低中级。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T04:34:17.610

您应该收到此错误的*唯一*两个可能原因是：

1.  您实际上并没有使用 PHP 5.3+，因此该方法不存在。仔细检查您的代码运行的 PHP 版本。也许您的 Web 服务器配置有问题。如果确实如此并且您无法更改它，请参阅[*5.2 中的*](https://stackoverflow.com/questions/5399075/php-datetimecreatefromformat-in-5-2?rq=1)[*PHP ？`DateTime::createFromFormat`*](https://stackoverflow.com/questions/5399075/php-datetimecreatefromformat-in-5-2?rq=1)为替代品。
2.  你在一个命名空间中，需要像`\DateTime::createFromFormat(...)`.

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-12T21:56:18.633

我找到了解决方案。日期转换的正确语法是：

```
$myDate = "01-12-1980";
$tempDate = date_create("$myDate");
$newDate = date_format($tempDate, 'j M Y');
echo "$newDate"; 
```

产生输出：1980 年 12 月 1 日（j 而不是 d 从天数中删除前导零）

请注意：

```
$newDate = date("d M Y", strtotime($myDate)); 
```

在此示例中不起作用，因为预期的输入格式是 mm/dd/yyyy，使用任何其他格式将产生不正确的输出日期

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-11T14:32:22.047

如果找不到方法，通常会发生这种情况，这意味着您没有包含包含此方法的文件。您可以发布 DateTime::createFromFormat 的代码吗？

# visual-studio-2012 - 如何将多个值传递给报表查看器数据源

> ID：15341023
> 
> 赞同：0
> 
> 时间：2013-03-11T14:25:45.523
> 
> 标签：visual-studio-2012, client, reporting, rdlc

我正在尝试在 Visual Studio 2012 中开发客户端报告。我的报告适用于不同的选择标准变量。在过滤器中多选列表值时出现错误。将值传递为

```
<SelectParameters>
        <asp:FormParameter DefaultValue="0" FormField="ctl00$MainContent$BasicFilterControls$ddlStartHour" Name="StartHour" />
        <asp:FormParameter DefaultValue="0" FormField="ctl00$MainContent$BasicFilterControls$ddlStartMinute" Name="StartMinute" />
        <asp:FormParameter DefaultValue="2012-11-01" FormField="ctl00$MainContent$BasicFilterControls$txtStartDate" Name="DateFrom" />
        <asp:FormParameter DefaultValue="23" FormField="ctl00$MainContent$BasicFilterControls$ddlEndHour" Name="EndHour" />
        <asp:FormParameter DefaultValue="59" FormField="ctl00$MainContent$BasicFilterControls$ddlEndMinute" Name="EndMinute" />
        <asp:FormParameter DefaultValue="2012-11-01" FormField="ctl00$MainContent$BasicFilterControls$txtEndDate" Name="DateTo" />

        <asp:SessionParameter DefaultValue="5027" Name="AgentList" SessionField="AgentList" />
    </SelectParameters> 
```

在查询中需要 AgentId 作为 SkillTargetID IN (@AgentList)。当我将单个值作为 5000 传递时，它的工作正常并显示记录。但是当我将多个值作为 5000,5001,5002 等传递时，就会出错。将多个值传递给报表查看器的任何建议。我试过

5000,5001,5002

'5000','5001','5002'

(5000,5001,5002)

('5000'),('5001'),('5002')

![错误](../Images/1734492d3d2f10eabe6e4f3f47132fb1.png)

我正在 Visual Studio 2012、Sql server 2008 r2 和 .net framework 4.5 上尝试这个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T11:23:34.010

Sill I couldn't find any proper solution but I solve my problem by changing DataSource SelectCommand query. On report refresh button_click I just change MyDataSource.SelectCommand query as

```
string AgentIds = "5000,5001,5002";
        MyDataSource.SelectComamnd = "Select * from Agent where AgentId IN ('" + AgentIds + "')";
        ReportViewer1.LocalReport.Refresh(); 
```

and it works. If anyone find a batter solution to add multiple values to DataSource variable then please update me.

# hyperlink - 如何在 Sitecore 中使用带有通配符项目的内部链接？

> ID：15341024
> 
> 赞同：6
> 
> 时间：2013-03-11T14:25:53.433
> 
> 标签：hyperlink, sitecore, wildcard, sitecore6, internal

我有一个多站点 Sitecore 解决方案。所有站点共享一个产品范围，该产品范围存储在与站点根节点处于同一级别的“共享数据”节点中。站点上的各个产品页面使用通配符项根据 URL 的最后部分查找产品。

这意味着我们不能在富文本编辑器中使用内部链接来指向任何站点上的产品页面，因为产品项没有特定的站点 URL。

有谁知道克服这个问题的方法，或者可能知道增加内部链接默认行为的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T15:46:19.167

您是否考虑过使用克隆项目，请参阅[此处](http://adeneys.wordpress.com/2011/07/01/virtual-items-in-sitecore/)了解详细信息。

这将允许您共享内容，同时让产品的最终用户在内容树中显示允许您使用 RTE 和内部链接查找？

有关克隆的更多信息，请参见[此处](http://www.sitecore.net/Community/Technical-Blogs/John-West-Sitecore-Blog/Posts/2010/10/Sitecore-CMS-6-4-Cloning.aspx)和[此处](http://sdn.sitecore.net/upload/sitecore6/64/reusing_and_sharing_data-a4.pdf)

如果需要，您还需要在链接提供程序中做一些工作以链接到产品的克隆版本。看到[这个](https://stackoverflow.com/questions/5978599/links-and-references-between-cloned-items-in-sitecore-6-4?rq=1)问题。

# c# - 多个下拉框值发送到控制器

> ID：15341026
> 
> 赞同：5
> 
> 时间：2013-03-11T14:26:13.660
> 
> 标签：c#, asp.net-mvc-2

![在此处输入图像描述](../Images/35f3b3ebe94cb5993b5f7a765f74730d.png)

我必须使用下拉框创建上述类型的动态 UI。下拉框的值如上所示是固定的。

我的问题是我需要将支付类型下拉框值发送到 mvc 控制器。我需要根据服务键发送选定下拉框的值。我不知道该怎么做。任何想法？

**更新**

支付类型可以像枚举。如下所示。

```
public enum PaymentOption
    {
        [Display(Name = "Select Payment Type")]
        None = 1,

        [Display(Name = "Service Hourly")]
        ServiceHourly = 2,

        [Display(Name = "Salary Flat Rate")]
        SalaryFlatRate = 3,

        [Display(Name = "% of Appointment")]
        PercentOfAppointment = 4,

        [Display(Name = "Per Appointment")]
        PerAppointment = 5,

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:49:09.730

您需要为“服务”创建一个列表并将列表项绑定到您的模型。

```
public class Service {
  string Name { get;set;}
  int PaymentType { get;set;}
  float HourlyRate { get;set;}
}

public class MyModel { 
  ICollection<Service> services { get;set;}
  [...]
} 
```

然后，按照本文创建您的视图并正确绑定您的服务列表：

[http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T14:37:27.777

试试这个示例代码

```
var url = '@Url.Action("Youractionname")';

        $.ajax({
            type: "POST",
            url: url,
            data: '{ddl1: "' + ddl1value+ '",ddl2: "' + ddl2value+ '"}',
            contentType: "application/json; charset=utf-8",
            dataType: "json"
        });

    [HttpPost]
    public ActionResult Youractionname(int ddl1, int ddl2)
    {
        //do work
    } 
```

# c# - 检查类中是否存在属性

> ID：15341028
> 
> 赞同：97
> 
> 时间：2013-03-11T14:26:19.713
> 
> 标签：c#, .net, reflection

我试图知道一个属性是否存在于一个类中，我试过这个：

```
public static bool HasProperty(this object obj, string propertyName)
{
    return obj.GetType().GetProperty(propertyName) != null;
} 
```

我不明白为什么第一个测试方法不通过？

```
[TestMethod]
public void Test_HasProperty_True()
{
    var res = typeof(MyClass).HasProperty("Label");
    Assert.IsTrue(res);
}

[TestMethod]
public void Test_HasProperty_False()
{
    var res = typeof(MyClass).HasProperty("Lab");
    Assert.IsFalse(res);
} 
```

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2013-03-11T14:33:14.717

您的方法如下所示：

```
public static bool HasProperty(this object obj, string propertyName)
{
    return obj.GetType().GetProperty(propertyName) != null;
} 
```

*这在一切*`object`的基类上添加了一个扩展。当您调用此扩展程序时，您将其传递给：*`Type`*

 *```
var res = typeof(MyClass).HasProperty("Label"); 
```

您的方法需要一个类的*实例*，而不是一个`Type`. 否则你基本上在做

```
typeof(MyClass) - this gives an instanceof `System.Type`. 
```

然后

```
type.GetType() - this gives `System.Type`
Getproperty('xxx') - whatever you provide as xxx is unlikely to be on `System.Type` 
```

正如@PeterRitchie 正确指出的那样，此时您的代码正在寻找`Label`. `System.Type`该属性不存在。

解决方案是

a) 为扩展提供一个 MyClass的*实例：*

```
var myInstance = new MyClass()
myInstance.HasProperty("Label") 
```

b) 把扩展放在`System.Type`

```
public static bool HasProperty(this Type obj, string propertyName)
{
    return obj.GetProperty(propertyName) != null;
} 
```

和

```
typeof(MyClass).HasProperty("Label"); 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-12-18T15:00:16.807

这回答了一个不同的问题：

如果试图弄清楚一个 OBJECT（不是类）是否有一个属性，

```
OBJECT.GetType().GetProperty("PROPERTY") != null 
```

如果（但不仅是）该属性存在，则返回 true。

在我的例子中，我在一个 ASP.NET MVC 部分视图中，如果属性不存在或者属性（布尔值）为真，我想渲染一些东西。

```
@if ((Model.GetType().GetProperty("AddTimeoffBlackouts") == null) ||
        Model.AddTimeoffBlackouts) 
```

在这里帮助了我。

编辑：如今，使用`nameof`运算符而不是字符串化的属性名称可能很聪明。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-05-17T07:20:01.937

我收到此错误：“类型不包含 GetProperty 的定义”在绑定接受的答案时。

这就是我最终得到的：

```
using System.Reflection;

if (productModel.GetType().GetTypeInfo().GetDeclaredProperty(propertyName) != null)
{

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-11T14:29:13.353

有2种可能性。

你真的没有`Label`财产。

您需要调用适当的[GetProperty 重载](http://msdn.microsoft.com/en-us/library/zy0d4103.aspx)并传递正确的绑定标志，例如`BindingFlags.Public | BindingFlags.Instance`

如果您的财产不是公开的，您将需要使用`BindingFlags.NonPublic`适合您的用例的标志或其他一些标志组合。阅读引用的 API 文档以查找详细信息。

编辑：

哎呀，刚刚注意到你打电话`GetProperty`。是肯定没有财产的。`typeof(MyClass)``typeof(MyClass)``Type``Label`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-22T15:26:31.400

如果您像我一样具有约束力：

```
<%# Container.DataItem.GetType().GetProperty("Property1") != null ? DataBinder.Eval(Container.DataItem, "Property1") : DataBinder.Eval(Container.DataItem, "Property2")  %> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-09T12:36:47.060

我不确定为什么需要这样做的上下文，所以这可能无法为您返回足够的信息，但这是我能够做到的：

```
if(typeof(ModelName).GetProperty("Name of Property") != null)
{
//whatevver you were wanting to do.
} 
```

在我的情况下，我正在运行表单提交中的属性，并且如果条目留空，则还有要使用的默认值 - 所以我需要知道是否有要使用的值 - 我在模型中添加了所有默认值的前缀使用*Default*所以我需要做的就是检查是否有一个以它开头的属性。*

# javascript - 在 Google 地图的类中只获取一个元素

> ID：15341030
> 
> 赞同：0
> 
> 时间：2013-03-11T14:26:26.503
> 
> 标签：javascript, jquery, google-maps

我使用其 Javascript API 将以下内容用于 Google 地图：

```
# HTML markup
<div id="#city_123">
  <div class="map"></div>
</div>

# calling function
marker("#city_123 .map"); // There is only one .map

# marker() function
function marker(shop) {
  var map;
  var mapOptions = {
    zoom: 15,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };

  $(shop).each(function(index) {  
    map = new google.maps.Map(this, mapOptions);

    var marker = new google.maps.Marker({
      position: new google.maps.LatLng($(this).data("lat"), $(this).data("lng")),
      map: map,
    });

    map.setCenter(marker.getPosition());

  });
} 
```

我尝试了多种方法来删除它，`.each`因为它没有必要。我只有一个`.map`。我必须使用类是有原因`.map`的，因为它实际上是动态创建的，但除此之外。

我怎样才能将其重写为友好？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:49:50.753

尝试这个：

# JS

```
function marker(shop) {
    var map;
    var mapOptions = {
        zoom: 15,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map($(shop)[0], mapOptions);
    var marker = new google.maps.Marker({
        position: new google.maps.LatLng($(shop).data("lat"), $(shop).data("lng")),
        map: map,
    });
    map.setCenter(marker.getPosition());
} 
```

# android - sending files to a remote pc (webservices, create a server, internet com..)?

> ID：15341037
> 
> 赞同：0
> 
> 时间：2013-03-11T14:26:43.890
> 
> 标签：android, web-services, file, wifi

i'm working in an **android app** for comunication with a wireless sensors network, i save the data that i receive from the network in a record file, and now, i want to send that file (normally .txt) to a computer, kinda "server", **by WiFi or 3G**.

I already know use sockets communication if the "server" is connected to the same WiFi conexion, but the problem appears if i want maybe to send the file to a pc in other place, connected to other LAN. I've been reading about **WEBSERVICES** but i have some doubts about the communication with web sites, because i don't have one. Maybe, i should create a server online to have some URL where send the record files. (i don't know how to create ir neither :/)

to sum up, i want to send a file from a device (for example with ip 138.100.XX.XX) to another terminal, a pc (for example with ip 192.21.XX.XX)

¿any good tutorial about this? any advice?? what do you think about??

Thank you very much, also for reading :)

Laura

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:44:41.163

This link may have some help [Android device to PC's socket connection](https://stackoverflow.com/questions/3880059/android-device-to-pcs-socket-connection "3880059").

(This talks about basic connection to other PC before sending data/files)

# winapi - Color Converter DSP 的 IMFTransform 接口在 SetInputType/SetOutputType 上给出 E_INVALIDARG

> ID：15341038
> 
> 赞同：3
> 
> 时间：2013-03-11T14:26:45.740
> 
> 标签：winapi, visual-c++, video, ms-media-foundation

我正在尝试使用颜色转换器 DMO（[http://msdn.microsoft.com/en-us/library/windows/desktop/ff819079](http://msdn.microsoft.com/en-us/library/windows/desktop/ff819079(v=vs.85).aspx) ( v=vs.85).aspx）通过媒体将 RBG24 转换为 YV12/NV12基础。我通过 CLSID_CColorConvertDMO 创建了 Color Converter DSP 的实例，然后尝试设置所需的输入/输出类型，但即使使用`GetOutputAvailableType`and返回的媒体类型，调用也总是返回 E_INVALIDARG `GetInputAvailableType`。如果我将媒体类型设置为`NULL`然后我得到媒体类型无效的错误，这是有道理的。我从 MSDN 看到了一些例子，人们也这样做——枚举可用类型，然后将它们设置为输入类型——他们声称它有效，但我有点卡在 E_INVALIDARG 上。我知道如果没有代码示例，这很难回答，如果没有人有类似的经验，我会尝试发布一个 snipplet，但也许有人遇到过同样的问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T16:12:49.380

此 DMO/DSP 是双接口的，既是`IMediaObject`带有`IMFTransform`. 这两个接口有很多共同点，下面是一个测试初始化​​RGB24到YV12转换的代码片段：

```
#include "stdafx.h"
#include <dshow.h>
#include <dmo.h>
#include <wmcodecdsp.h>

#pragma comment(lib, "strmiids.lib")
#pragma comment(lib, "wmcodecdspuuid.lib")

int _tmain(int argc, _TCHAR* argv[])
{
    ATLVERIFY(SUCCEEDED(CoInitialize(NULL)));
    CComPtr<IMediaObject> pMediaObject;
    ATLVERIFY(SUCCEEDED(pMediaObject.CoCreateInstance(CLSID_CColorConvertDMO)));
    VIDEOINFOHEADER InputVideoInfoHeader;
    ZeroMemory(&InputVideoInfoHeader, sizeof InputVideoInfoHeader);
    InputVideoInfoHeader.bmiHeader.biSize = sizeof InputVideoInfoHeader.bmiHeader;
    InputVideoInfoHeader.bmiHeader.biWidth = 1920;
    InputVideoInfoHeader.bmiHeader.biHeight = 1080;
    InputVideoInfoHeader.bmiHeader.biPlanes = 1;
    InputVideoInfoHeader.bmiHeader.biBitCount = 24;
    InputVideoInfoHeader.bmiHeader.biCompression = BI_RGB;
    InputVideoInfoHeader.bmiHeader.biSizeImage = 1080 * (1920 * 3);
    DMO_MEDIA_TYPE InputMediaType;
    ZeroMemory(&InputMediaType, sizeof InputMediaType);
    InputMediaType.majortype = MEDIATYPE_Video;
    InputMediaType.subtype = MEDIASUBTYPE_RGB24;
    InputMediaType.bFixedSizeSamples = TRUE;
    InputMediaType.bTemporalCompression = FALSE;
    InputMediaType.lSampleSize = InputVideoInfoHeader.bmiHeader.biSizeImage;
    InputMediaType.formattype = FORMAT_VideoInfo;
    InputMediaType.cbFormat = sizeof InputVideoInfoHeader;
    InputMediaType.pbFormat = (BYTE*) &InputVideoInfoHeader;
    const HRESULT nSetInputTypeResult = pMediaObject->SetInputType(0, &InputMediaType, 0);
    _tprintf(_T("nSetInputTypeResult 0x%08x\n"), nSetInputTypeResult);
    VIDEOINFOHEADER OutputVideoInfoHeader = InputVideoInfoHeader;
    OutputVideoInfoHeader.bmiHeader.biBitCount = 12;
    OutputVideoInfoHeader.bmiHeader.biCompression = MAKEFOURCC('Y', 'V', '1', '2');
    OutputVideoInfoHeader.bmiHeader.biSizeImage = 1080 * 1920 * 12 / 8;
    DMO_MEDIA_TYPE OutputMediaType = InputMediaType;
    OutputMediaType.subtype = MEDIASUBTYPE_YV12;
    OutputMediaType.lSampleSize = OutputVideoInfoHeader.bmiHeader.biSizeImage;
    OutputMediaType.cbFormat = sizeof OutputVideoInfoHeader;
    OutputMediaType.pbFormat = (BYTE*) &OutputVideoInfoHeader;
    const HRESULT nSetOutputTypeResult = pMediaObject->SetOutputType(0, &OutputMediaType, 0);
    _tprintf(_T("nSetOutputTypeResult 0x%08x\n"), nSetOutputTypeResult);
    // TODO: ProcessInput, ProcessOutput
    pMediaObject.Release();
    CoUninitialize();
    return 0;
} 
```

这应该可以正常工作并打印`S_OK`出两个...

# c# - Visual C# Express 中的无意义错误

> ID：15341041
> 
> 赞同：0
> 
> 时间：2013-03-11T14:26:55.533
> 
> 标签：c#, xna

我开始使用带有 XNA 框架的 C# 编程。我创建了新的解决方案，制作了程序，保存了它。程序正在运行，并且没有错误。在我打开解决方案的第二天，我在一个文件中有很多错误。代码看起来不错，但注释中有错误：

```
using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Audio;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.GamerServices;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;
using Microsoft.Xna.Framework.Media;
using The_Destiny_of_Azureus.Komponenty;

namespace The_Destiny_of_Azureus
{

public class Hra : Microsoft.Xna.Framework.Game
{
    GraphicsDeviceManager graphics;
    public SpriteBatch spriteBatch;

    public int wwidth = 1366;
    public int wheight = 768;

    Texture2D cursor;

    MouseState mouseState;

    public Hra()
    {
        graphics = new GraphicsDeviceManager(this);
        Content.RootDirectory = "Content";
    }

    protected override void Initialize()
    {
        graphics.PreferredBackBufferWidth = wwidth;
        graphics.PreferredBackBufferHeight = wheight;
        graphics.IsFullScreen = false;
        graphics.ApplyChanges();

        MMenu mmenu = new MMenu(this);
        Components.Add(mmenu);           //1 error: } expected

        public Button ngbutton = new Button(this, new Vector2(64, 258), "NEW GAME");     // Keyword 'this' is not available in the current context
        Components.Add(ngbutton);       //3 errors:
                                                     //Invalid token '(' in class, struct, or interface member declaration, 
                                                     //Invalid token ')' in class, struct, or interface member declaration
                                                     //Microsoft.XNA.Framework.Game.Components is a property but is used like a type

        base.Initialize();                       //1 error: Method must have a return type
    }

    protected override void LoadContent()     //1 error: Expected class, delegate, enum, interface, or struct
    {

        spriteBatch = new SpriteBatch(GraphicsDevice);      //1 error: Expected class, delegate, enum, interface, or struct

        cursor = Content.Load<Texture2D>(@"Textury\cursor");
    }

    protected override void UnloadContent()            //1 error: Expected class, delegate, enum, interface, or struct
    {

    }

    protected override void Update(GameTime gameTime)        //1 error: Expected class, delegate, enum, interface, or struct
    {

        if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed)
            this.Exit();

        mouseState = Mouse.GetState();

        base.Update(gameTime);
    }

    protected override void Draw(GameTime gameTime)           //1 error: Expected class, delegate, enum, interface, or struct
    {
        GraphicsDevice.Clear(Color.CornflowerBlue);

        spriteBatch.Begin();
        spriteBatch.Draw(cursor, new Vector2(mouseState.X, mouseState.Y), Color.White);      //1 chyba: Expected class, delegate, enum, interface, or struct
        spriteBatch.End(); 

        base.Draw(gameTime);
    }              //1 error: Type or namespace definition, or end-of-file expected
}
} 
```

错误：

```
Error   } expected  44  35
Error   Invalid token '(' in class, struct, or interface member declaration 47  27
Error   Invalid token ')' in class, struct, or interface member declaration 47  36
Error   Method must have a return type  49  18
Error   Expected class, delegate, enum, interface, or struct    53  28
Error   Expected class, delegate, enum, interface, or struct    56  31
Error   Expected class, delegate, enum, interface, or struct    62  28
Error   Expected class, delegate, enum, interface, or struct    68  28
Error   Expected class, delegate, enum, interface, or struct    81  28
Error   Expected class, delegate, enum, interface, or struct    86  42
Error   Type or namespace definition, or end-of-file expected   90  9
Error   Keyword 'this' is not available in the current context  46  49
Error   'Microsoft.Xna.Framework.Game.Components' is a 'property' but is used like a 'type' 47  13
Error   'The_Destiny_of_Azureus.Hra.ngbutton' is a 'field' but is used like a 'type'    47  28 
```

我尝试将整个解决方案发送给我的朋友，他打开了解决方案并且他在这个文件中没有错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T14:30:26.900

你的问题在这里：

```
Components.Add(mmenu);           //1 error: } expected

public Button ngbutton = new Button(this, new Vector2(64, 258), "NEW GAME");     // Keyword 'this' is not available in the current context
Components.Add(ngbutton);       //3 errors: 
```

该`public`关键字对局部变量无效。您要么从类的成员定义中复制并粘贴它，要么只是`public`错误地添加了。

错误链源于编译器认为您错过了`}`结束`Initialize`并且其余支撑被丢弃的事实。

您的同事不可能拥有确切的代码并构建它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T14:29:55.597

错误是完全正确的。

`public`有一个局部变量是没有意义的。

因此，编译器假定您试图在类上创建一个字段，但忘记了`}`.
这会导致更多错误，因为它在错误假设您需要额外的`}`.

# jquery - jQuery UI Touch Punch draggable()

> ID：15341044
> 
> 赞同：2
> 
> 时间：2013-03-11T14:26:57.100
> 
> 标签：jquery, touch, jquery-ui-touch-punch

在我的应用程序中，我使用拖放，我也想在移动设备上实现。我正在考虑像这样使用 JQuery Ui 触摸打孔器：

```
 var thumb = document.createElement("img");
  $(thumb).draggable({containment: "html"}); 
```

问题是我的图像仅在其父级范围内（见附图）而不是整个页面上拖动。我尝试过更改收容选项，但问题似乎出在其他地方。 ![在此处输入图像描述](../Images/ba66f0c974711ccbf5fcd654cf53e3ab.png)

CSS：

```
html, body { 
   height: 100%;
   background: black;
   margin:0; padding:0;
   overflow:hidden;
}
//one parent
.dhThumbOuter {
    float: left;
    width: 64px;
    height: 64px;
    -webkit-box-shadow: 0px 0px 5px #4d4d4d;
    -moz-box-shadow: 0px 0px 5px #4d4d4d;
    box-shadow: 0px 0px 5px #4d4d4d;
    border:solid gray 1px;
    overflow: hidden;
    padding: 3px;
    margin-left: 3px;
    font-size: smaller;
    position:relative;
    border : solid gray 2px;

}
//other parrent
.dhThumbImage {
    background: lightgray;
    padding: 0;
    width: 64px;
    height: 64px;
    overflow: hidden;
    position:absolute;
}​ 
```

Javascript：

```
 var thout = createElement("div", "dhThumbOuter dhRounded");
            container.appendChild(thout);
            var thinner = createElement("div", "dhThumbImage dhRounded");
            thout.appendChild(thinner);
            thinner.appendChild(thumb); //my image 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:39:19.947

使用该`helper: clone`属性，`draggable()`以便图像在拖动时“脱离”其容器。

在此处查看官方 jQuery UI 可拖动文档：http: [//api.jqueryui.com/draggable/#option-helper](http://api.jqueryui.com/draggable/#option-helper)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-24T18:00:07.373

您还可以添加自定义助手

```
$('#draggable').draggable({
  zIndex: 20,
  drag: function(event){...},
  helper: function(){
    $("#outerElement").append($("#draggable").clone().attr('id', 'itWorks'))
    return $("#itWorks");
  },
}) 
```

其中 outerElement 是包含您的可拖放元素的元素

# php - 获取拼写检查/更正 API？

> ID：15341045
> 
> 赞同：3
> 
> 时间：2013-03-11T14:27:05.623
> 
> 标签：php, api, get, spell-checking

我做了很多研究，但一无所获，但有人知道拼写检查 API 吗？

所以当你向 发送请求时`http://spellcheck.com?spellcheck-api=this is a sentnse`，它会返回`this is a sentence`。

请告诉我如何在不降级的情况下在评论中使我的问题更好，我会尽快修复它。我是新的 SO 成员。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T14:35:13.047

检查这个很棒的脚本：[http ://www.phpspellcheck.com](http://www.phpspellcheck.com)

您实际上所做的只是获取您的`$_GET['spellcheck_api']`(convert `%20`'s 如果需要的话)。并让脚本（`include()`或`require()`）处理检查您的字符串是否存在拼写错误。

祝你好运 ！

# android - Eclipse 上的 Android 调试时遵循正确的 Android 源代码版本

> ID：15341046
> 
> 赞同：2
> 
> 时间：2013-03-11T14:27:06.897
> 
> 标签：android, eclipse, android-source

我正在调试目标**android-17**（最低版本 android-11）的应用程序。
我使用的模拟器有 android 4.0.4，即**android-14**或**android-15**。

当我跟踪到 android 源方法时，调试器会将我带到与**android-14源代码不同的****android-17**源，所以我最终会遵循错误的代码。

 **项目骨架是由 Eclipse 创建的，当时我选择了“New Android Project”。它有一个包含 android-17 代码（Android 4.2）的文件夹，可能是因为目标版本是这样说的。但编译后的应用程序在 android-14 AVD 模拟器上运行。

如何跟随调试器进入正确的 android 源代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:59:23.623

这不是您应该寻找的目标 android 版本，而是**项目构建目标**。

要更改它，请从 Eclipse 的包资源管理器中选择您的项目，然后右键单击并选择**属性**或从菜单栏中选择**项目并选择****属性**。

您的项目的属性窗口将打开，选择**Android**，您应该会看到类似以下内容：

![项目android属性](../Images/71134cf5a9db202ac2d1c19c8deb3afb.png)

从该窗口中，选择您想使用哪个 android 版本来编译您的项目。此外，您在项目向导创建期间选择了项目构建目标（它要求提供目标版本、构建版本（称为“编译方式”）和最低版本）。**

# python - 如何确保多维数组中的唯一值？

> ID：15341047
> 
> 赞同：0
> 
> 时间：2013-03-11T14:27:08.340
> 
> 标签：python

我有这样的事情：

```
color_names = ('red', 'blue', 'orange', 'red') 
```

从上面的列表中，我想做这样的事情：

```
colors = [(0, 'red'), (1, 'blue'), (2, 'orange')] 
```

每种颜色都应该是唯一的，这就是为什么我必须忽略第一个列表中的第二个“红色”。我目前的解决方案有很多循环和条件。我正在寻找更好的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T14:32:29.290

既然您说顺序无关紧要，您可以简单地执行以下操作：

```
list(enumerate(set(color_names))) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T14:34:22.567

如果顺序无关紧要：

```
color_names = ('red', 'blue', 'orange', 'red')
colors = [(i, color) for i, color in enumerate(set(color_names))] 
```

或者：

```
colors = list(enumerate(set(color_names))) 
```

[`set()`](http://docs.python.org/2/library/sets.html)使列表包含唯一元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T14:40:54.307

太罗嗦，但它的工作原理：

```
color_names = ('red', 'blue', 'orange', 'red')
i = 0
res = []
for item in set(color_names):
    res.append((i,item))
    i+=1

print res 
```

# c - 递增后重置 Argv 指针

> ID：15341049
> 
> 赞同：0
> 
> 时间：2013-03-11T14:27:18.083
> 
> 标签：c

我有一个基于 char **argv 命令行参数打开文件的程序。这是逻辑：

```
char * openErrorString = "Error opening file: ";
FILE *fp1 = fopen(*++argv, "r");
if (fp1 == NULL) {
    perror(openErrorString);
    return 1;
}   
FILE *fp2 = fopen(*++argv, "r");
if (fp2 == NULL) {
    perror(openErrorString);
    return 1;
} 
```

问题是，我稍后想比较这两个文件并在文件中的行不匹配时给出有意义的输出。这是我为此编写的代码：

```
while (fgets(fp1Line, max, fp1) != NULL &&
        fgets(fp2Line, max, fp2) != NULL) {
    if (strcmp(fp1Line, fp2Line)) {
        printf("%s\n","Line discrepancy found:");
        printf("%s: %s\n", argv[1], fp1Line);
        printf("%s: %s\n", argv[2], fp2Line);
        fclose(fp1);
        fclose(fp2);
        return 0;
    }
} 
```

但是，当我调用`argv[1]`我的`printf`语句时，我得到 (null)，即 argv 中的最后一个条目。当我打电话时`argv[2]`，我得到了`TERM_PROGRAM=Apple_Terminal`。我不知道那是什么。似乎正在发生的事情是因为我在访问它以打开文件时将 argv 指针增加了两次，所以 argv 现在从第二个命令行参数开始。`*argv--`除了在打开文件后执行两行之外，是否有一种重置此行为的好方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T14:29:00.013

我的建议是不要修改`argv`. 将指针复制到另一个变量中，然后增加它。这样，您可以`argv`一次又一次地使用，而不必担心它现在指向的位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T14:29:33.867

只是不要增加 argv，例如：

```
FILE *fp1 = fopen(argv[0], "r");
// ...
FILE *fp2 = fopen(argv[1], "r"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-11T14:30:23.860

如果您再次需要，没有理由更改 argv 指针。相反，更换

```
FILE *fp1 = fopen(*++argv, "r"); 
```

经过

```
FILE *fp1 = fopen(argv[1], "r"); 
```

和

```
FILE *fp2 = fopen(*++argv, "r"); 
```

经过

```
FILE *fp2 = fopen(argv[2], "r"); 
```

# jquery - jquery插件添加公共方法

> ID：15341052
> 
> 赞同：1
> 
> 时间：2013-03-11T14:27:27.470
> 
> 标签：jquery, jquery-plugins, slider

我正在编写一个简单的滑块插件，只是为了学习一点 jquery，也许可以用于我自己的项目。

滑块工作正常，但我想添加一些公共方法，如 goToSlide(x)，但我不知道如何创建该公共方法。

[你在这里](http://jsfiddle.net/oterox/vvZqj/1/)有一个jsfiddle

我正在尝试类似的东西：

```
var slideto = function(position){
    gotoslide(position);
}; 
```

现在我使用这样的插件：

```
$('#home-slider').pxslider({
    slideWidth: 300,
    speed: 500,
    onSlideBefore: function(){
                $('p.debug span').html('starting animation');
            },
    onSlideAfter: function(){
                $('p.debug span').html('stop animation');
            }

    }); 
```

我想做一些类似的事情：

```
$('#home-slider').pxslider().gotoslide(x);
or
$('#home-slider').pxslider('gotoslide','x'); 
```

jsfiddle 与示例代码[here](http://jsfiddle.net/oterox/vvZqj/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-21T10:09:10.747

我终于用新代码创建了一个插件。

[https://github.com/oterox/jquery.pxslider](https://github.com/oterox/jquery.pxslider)

现在一切都像我想要的那样工作。

# jasper-reports - 在 iReport .jrxml 文件中保留 XML 注释？

> ID：15341057
> 
> 赞同：5
> 
> 时间：2013-03-11T14:27:43.290
> 
> 标签：jasper-reports, ireport

当我在 iReport 中保存 XML 文件时，所有评论都被删除。

如何在 JRXML 文件中包含（或保留）注释？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T16:55:24.443

没有办法[保留评论](http://community.jaspersoft.com/questions/533023/comments-jrxml-are-erased-ireport)；您必须针对 iReport 记录错误。

您可以使用标注解决此问题：

```
<property
  name="ireport.callouts"
  value="##Fri Nov 12 23:12:35 GMT-03:00 2010\\ncallouts.1.text=Hello World!\\ncallouts.1.bounds=294,80,181,73"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-16T10:35:08.103

如果您无法保存使用 CallOut 组件形成 iReport 的评论，您可以使用 CallOut 编写评论。这不是一个完美的解决方案，但在您想要对原始报告发表评论的情况下可以提供很大帮助

它的 V3.7+ 功能，更多详细信息请访问 - [http://community.jaspersoft.com/wiki/ireport-designer-v371-release-notes](http://community.jaspersoft.com/wiki/ireport-designer-v371-release-notes)

# java - 使用 xtype 路径字段迭代子页面

> ID：15341063
> 
> 赞同：2
> 
> 时间：2013-03-11T14:27:54.810
> 
> 标签：java, iterator, aem

我正在尝试创建所有子页面的列表以显示为超链接列表。我让用户选择父文件夹，并且应该相应地列出任何子页面。但是，它出现空白（`children`为空）。

对话框元素：

```
<listRoot
  name (String): ./listRoot
  jcr:primaryType (Name): cq:Widget
  xtype (String): pathfield
> 
```

源代码：

```
<%@include file="/libs/foundation/global.jsp"%>
<%@page
import="java.util.Iterator,
        com.day.cq.wcm.api.PageFilter"
%>
<%@page session="false" %>

<%
    String listroot = properties.get("listRoot", currentPage.getPath());
    Page rootPage = pageManager.getPage(listroot);
    if (rootPage != null) {
        Iterator<Page> children = rootPage.listChildren(new PageFilter(request));
        while (children.hasNext()) {
            Page child = children.next();
            String title = child.getTitle() == null ? child.getName() : child.getTitle();
            String date = child.getProperties().get("date","");
            %><div class="item">
            <a href="<%= child.getPath() %>.html"><b><%= title %></b></a>
            <span><%= date %></span><br>
            <%= child.getProperties().get("jcr:description","") %><br>
            </div><%
        }
    }
%> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T16:38:50.923

您能否检查子页面是否已从导航中隐藏（在页面属性中将选择“隐藏在导航中”属性）。

因为，使用新的[PageFilter(request)](http://dev.day.com/docs/en/cq/5-4/javadoc/com/day/cq/wcm/api/PageFilter.html)会排除所有隐藏的页面。

否则，这段代码对我来说运行得很好。

问候， 拉克什

# mongodb - MongoDB - 在 SSD 上存储索引和在磁性上存储数据集合？

> ID：15341069
> 
> 赞同：4
> 
> 时间：2013-03-11T14:28:19.980
> 
> 标签：mongodb

是否可以将索引集合存储在单独的高性能存储（即闪存/SSD）上，同时将数据集合保存在成本较低的传统存储上？我在使用 MongoDB 时看到的性能问题似乎与索引维护操作有关，并且我必须在单个实例上跨数据库存储桶分区我的数据，以避免写入性能急剧下降 - 一个只能扩展的解决方案长。因此，我想将 SSD 用于索引，但在没有保证的情况下（数据收集）购买高性能存储是没有意义的。

我发现的关于这个主题的唯一讨论有些过时了： [https ://jira.mongodb.org/browse/SERVER-965](https://jira.mongodb.org/browse/SERVER-965)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-15T17:36:43.527

你不能用 MongoDB 做你要求的事情。

解决方法是将您的集合拆分为多个数据库。MongoDB 无法进行连接，因此在数据级别上并没有真正的权衡。您的应用程序必须管理与多个数据库的多个连接。

*   将您的高性能集合放在具有更大 RAM 分配的 SSD 服务器上。
*   将性能较低的集合放在速度较慢的主轴磁盘或 AWS EBS 服务器上。

# python - 在Python中合并由空格分隔的字符串

> ID：15341070
> 
> 赞同：3
> 
> 时间：2013-03-11T14:28:22.830
> 
> 标签：python, string, merge, split

我有一部分代码是这样的：

```
for line in response.body.split("\n"):
    if line != "": 
        opg = int(line.split(" ")[2])
        opc = int(line.split(" ")[3])
        status = int(line.split(" ")[5])
        if command == 'IDENTIFY':
            if opg==opcodegroupr and opc==opcoder:
                if status=="0":
            IEEEAddrRemoteDev = line.split(" ")[6:14]
        ret['success'] = "IDENTIFY: The value is %s " % (IEEEAddrRemoteDev)
        self.write(tornado.escape.json_encode(ret))
        self.finish() 
```

变量 'line' 是这样的，例如：

```
1363011361 2459546910990453036 157 0 17 0 209 61 0 0 0 0 0 0 0 0 0 0 0 0 0 201 
```

例如，我会采用从 6 到 14 的字段并相互“合并”以像整个字符串一样打印 IEEEAddrRemoteDev。

这是

```
IEEEAddrRemoteDev = line.split(" ")[6:14] 
```

正确的方法？如果我写

```
print IEEEAddrRemoteDev 
```

我什么也得不到。

这里有些不对劲...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T14:30:44.440

你想使用`join`：

```
ret['success'] = "IDENTIFY: The value is %s " % (" ".join(IEEEAddrRemoteDev)) 
```

然而，更大的问题是你的`status=="0"`行永远不是真的（因为`status`是一个 int），把它改成

```
if status == 0: 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:35:26.080

我没有完全理解你想要的输出。但是当你写这行时：

```
IEEEAddrRemoteDev = line.split(" ")[6:14] 
```

你正在做的是用空格分割字符串，所以当前的输出是：

```
['209', '61', '0', '0', '0', '0', '0'] 
```

我假设您想要以下输出？

```
'20961000000' ? 
```

如果是这样，只需在您的打印语句之前添加以下行：

```
"".join(IEEEAddrRemoveDev) 
```

# azure - Elmah 登录 Azure Worker 角色？

> ID：15341072
> 
> 赞同：4
> 
> 时间：2013-03-11T14:28:25.800
> 
> 标签：azure, elmah, azure-worker-roles

有谁知道如何为 Azure 辅助角色配置 Elamh？我已经安装了它，但它似乎没有做任何事情 - 当发生异常时，它们不会被记录。它在我的 MVC 项目中完美运行。

是否有针对 Elamh 的 Azure 辅助角色的具体指导？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T14:34:19.067

Azure 辅助角色默认禁用 IIS，这意味着你不能使用 ELMAH。您可能必须尝试更传统的日志记录方法。

在我最近的项目中，我们决定将我们的 Worker Roles 记录到表存储中，并且效果非常好。但是，自从我们刚开始以来，最近出现了一些进步，使记录变得更加容易。

有关详细信息，请查看[在 Windows Azure 中控制日志记录和跟踪](http://msdn.microsoft.com/en-us/magazine/ff714589.aspx)

# angularjs - AngularJS：在特定索引后重复

> ID：15341075
> 
> 赞同：5
> 
> 时间：2013-03-11T14:28:30.353
> 
> 标签：angularjs, angularjs-ng-repeat

我正在使用 AngularJS，我有一个要求，我需要在特定索引*之后重复一个元素。*所以，假设我的代码是：

```
<label ng-repeat="stones in rocks">
    <a href="#">Rock {{$index}}</a>
    <i class="icon-trash"></i>
</label> 
```

现在我希望`<i class="icon-trash"></i>`只*在*索引 3 之后重复。即从第四块石头开始，我希望看到回收站。我如何实现这一目标？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-11T14:38:53.500

[ng-show](http://docs.angularjs.org/api/ng.directive:ngShow)可以接受一个表达式：

```
<label ng-repeat="stones in rocks">
    <a href="#">Rock {{$index}}</a>
    <i class="icon-trash" ng-show="$index > 2"></i><!--$index is 0-based-->
</label> 
```

从版本[1.1.5](https://github.com/angular/angular.js/blob/master/CHANGELOG.md)开始，您可以使用以下命令将不需要的元素排除在 DOM 之外

```
<i class="icon-trash" ng-if="$index > 2"></i> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T14:39:49.847

您可以使用 ng-show 在前 3 次迭代中简单地隐藏它：

```
<label ng-repeat="stones in rocks">
    <a href="#">Rock {{$index}}</a>
    <i class="icon-trash" ng-show="$index>2"></i>
</label> 
```

# android - 设备上的位置为空

> ID：15341077
> 
> 赞同：0
> 
> 时间：2013-03-11T14:28:32.557
> 
> 标签：android

我正在真实设备上测试我的应用程序，并`null`在 GPS 开启时获取位置。当我使用虚拟坐标在模拟器上进行测试时，它工作正常。怎么了？

```
locationManager = (LocationManager) context.getSystemService(context.LOCATION_SERVICE);
listener = new MyLocationListener();
viaGps = locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER);
viaNetwork = locationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER);
if (!viaGps && !viaNetwork) {
    tracking = false;
} else {
    if (viaGps) {
        Log.d("", "gps is on");
        locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, listener);
        location = locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);
    }else if (viaNetwork) {
        Log.d("", "network is on");
        locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, listener);
        location = locationManager.getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
    }
    if (location == null) {
        Log.d("", "location not fouond");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:09:00.337

尝试使用它，它解决了我的问题

```
 double latitude = gps.getLatitude();
  double longitude = gps.getLongitude(); 
```

还要检查您的许可

```
 <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"></uses-permission>
  <uses-permission android:name="android.permission.INTERNET"></uses-permission> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:40:28.933

你需要一个 Location 监听器：

遵循[文档](http://developer.android.com/guide/topics/location/strategies.html)

**更新：**

您也可以尝试这种简单的方法：[在 Android 中获取用户当前位置的最简单、最可靠的方法是什么？](https://stackoverflow.com/a/3145655/944070)

# concurrency - 何时使用破坏者模式，何时使用本地存储窃取工作？

> ID：15341078
> 
> 赞同：11
> 
> 时间：2013-03-11T14:28:38.373
> 
> 标签：concurrency, concurrent-programming, disruptor-pattern, work-stealing

以下是正确的吗？

*   如果必须以多种方式（io 操作或注释）处理每个条目，则**[破坏者模式](http://lmax-exchange.github.com/disruptor/)**具有更好的并行性能和可扩展性，因为可以使用多个消费者并行化而不会发生争用。
*   相反，如果每个条目只能以单一方式处理，**[工作窃取（即在本地存储条目并从其他线程窃取条目）具有更好的并行性能和可伸缩性，因为在中断模式中将条目不相交地分布到多个线程会导致争用。](http://www.cs.cmu.edu/~acw/15740/wsbib.pdf)**

（当涉及多个生产者（即[CAS 操作](http://en.wikipedia.org/wiki/Compare-and-swap)）时，破坏者模式是否仍然比其他无锁多生产者多消费者队列（例如[来自 boost ）快得多？）](http://www.boost.org/doc/libs/1_53_0/doc/html/boost/lockfree/queue.html)

* * *

**我的详细情况**：

处理一个条目可以产生几个新条目，最终也必须处理这些条目。性能具有最高优先级，按 FIFO 顺序处理的条目具有第二优先级。

在当前的实现中，每个线程都使用本地 FIFO，并在其中添加新条目。空闲线程从其他线程的本地 FIFO 窃取工作。线程处理之间的依赖关系使用无锁、[机械同理](http://mechanical-sympathy.blogspot.de/)哈希表（写入时的 CAS，具有桶粒度）来解决。这导致争用非常低，但 FIFO 顺序有时会被破坏。

使用破坏者模式将保证 FIFO 顺序。但是，将条目分配到线程上会不会导致比具有工作窃取的本地 FIFO 更高的争用（例如，读取光标上的 CAS）（每个线程的吞吐量大致相同）？

* * *

**我找到的参考资料**

[关于破坏者的标准技术文件](http://lmax-exchange.github.com/disruptor/files/Disruptor-1.0.pdf)（第 5 + 6 章）中的性能测试不包括不相交的工作分布。

[https://groups.google.com/forum/?fromgroups=#!topic/lmax-disruptor/tt3wQthBYd0](https://groups.google.com/forum/?fromgroups=#!topic/lmax-disruptor/tt3wQthBYd0)是我找到的关于破坏者 + 工作窃取的唯一参考。它指出如果有任何共享状态，每个线程的队列会显着变慢，但没有详细说明或解释原因。我怀疑这句话是否适用于我的情况：

*   使用无锁哈希表解析共享状态；
*   必须在消费者之间不连贯地分发条目；
*   除了工作窃取之外，每个线程只在其本地队列中读写。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-12T07:45:50.173

*更新 - 为最大性能提前做好准备：您需要以惯用语法编写破坏者和工作窃取，然后进行基准测试。*

对我来说，我认为区别主要在于消息与任务焦点之间的区别，因此也在于您想思考问题的方式。尝试解决您的问题，如果它以任务为中心，那么 Disruptor 非常适合。如果问题是针对消息的，那么您可能更适合其他技术，例如窃取工作。

*   当您的实施以**消息为中心**时，使用**工作窃取**。每个线程都可以获取一条消息并运行它直到完成。例如 HTTP 服务器 - 每个入站 http 请求都分配有一个线程。该线程专注于从头到尾处理请求——记录请求、检查安全控制、进行虚拟主机查找、获取文件、发送响应和关闭连接

***   当您的实施以**任务为中心**时，请使用**中断**器。每个线程都可以在处理的特定阶段工作。替代示例：对于任务焦点，处理将分为多个阶段，因此您将拥有一个执行日志记录的线程、一个用于安全控制的线程、一个用于虚拟主机查找的线程等；每个线程专注于其任务并将请求传递给管道中的下一个线程。阶段可能是并行的，但整体结构是一个专注于特定任务的线程，并在线程之间传递消息。** 

 ****当然，您可以更改您的实现以更好地适应每种方法。

在您的情况下，如果您想使用 Disruptor，我会以不同的方式构建问题。通常，您可以通过让单个线程拥有状态并通过该工作线程传递所有任务来消除共享状态 - 在 SEDA 中查找很多这样的图表。这可能有很多好处，但同样，这实际上取决于您的实施。

一些更冗长的：

*   Disruptor - 当需要严格的阶段排序时非常有用，当所有任务的长度一致时会有额外的好处，例如：外部系统没有阻塞，每个任务的处理量非常相似。在这种情况下，您可以假设所有线程将在系统中均匀工作，因此安排 N 个线程来处理每 N 条消息。我喜欢将 Disruptor 视为一种在线程处理阶段实现类似 SEDA 的系统的有效方式。您当然可以拥有一个具有单个阶段和多个并行单元在每个阶段执行相同工作的应用程序，但这并不是我的观点。这将完全避免共享状态的成本。
*   工作窃取 - 当任务具有不同的持续时间并且消息处理的顺序并不重要时使用此选项，因为这允许空闲且已使用其消息的线程继续从另一个任务队列进行。这样，例如，如果您有 10 个线程并且 1 个在 IO 上被阻塞，其余的仍将完成它们的处理。****

# android - 单击删除按钮时，我想删除该特定行

> ID：15341082
> 
> 赞同：-3
> 
> 时间：2013-03-11T14:28:45.590
> 
> 标签：android, listview

# 单击删除按钮时，我想删除该特定行

我在这里提交了我的项目的三个文件，单击删除按钮我想删除该特定行。

list_mobile.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:padding="5dp" >

<ImageView
    android:id="@+id/logo"
    android:layout_width="50px"
    android:layout_height="50px"
    android:layout_marginLeft="5px"
    android:layout_marginRight="20px"
    android:layout_marginTop="5px"
    android:src="@drawable/windowsmobile_logo" >
</ImageView>

<TextView
    android:id="@+id/label"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@+id/label"
    android:textSize="30px" >
</TextView>

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="delete" />
   </LinearLayout> 
```

listmobileactivity.java

```
package com.mkyong.android;
import com.mkyong.android.adaptor.MobileArrayAdapter;
import android.app.ListActivity;
import android.os.Bundle;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.Toast;
import android.view.View;
public class ListMobileActivity extends ListActivity {

static final String[] MOBILE_OS = new String[] { "Android", "iOS",
        "WindowsMobile", "Blackberry"};

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    //setListAdapter(new ArrayAdapter<String>(this, R.layout.list_mobile,
    //      R.id.label, MOBILE_OS));

    setListAdapter(new MobileArrayAdapter(this, MOBILE_OS));

}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {

    //get selected items
    String selectedValue = (String) getListAdapter().getItem(position);
    Toast.makeText(this, selectedValue, Toast.LENGTH_SHORT).show();

}

} 
```

mobilearrayadapter.java

```
package com.mkyong.android.adaptor;
import com.mkyong.android.R;
import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ImageView;
import android.widget.TextView;
public class MobileArrayAdapter extends ArrayAdapter<String> {
private final Context context;
private final String[] values;

public MobileArrayAdapter(Context context, String[] values) {
    super(context, R.layout.list_mobile, values);
    this.context = context;
    this.values = values;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    LayoutInflater inflater = (LayoutInflater) context
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    View rowView = inflater.inflate(R.layout.list_mobile, parent, false);
    TextView textView = (TextView) rowView.findViewById(R.id.label);
    ImageView imageView = (ImageView) rowView.findViewById(R.id.logo);
    textView.setText(values[position]);

    // Change icon based on name
    String s = values[position];

    System.out.println(s);

    if (s.equals("WindowsMobile")) {
        imageView.setImageResource(R.drawable.windowsmobile_logo);
    } else if (s.equals("iOS")) {
        imageView.setImageResource(R.drawable.ios_logo);
    } else if (s.equals("Blackberry")) {
        imageView.setImageResource(R.drawable.blackberry_logo);
    } else {
        imageView.setImageResource(R.drawable.android_logo);
    }

    return rowView;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:35:13.343

您需要从适配器中删除该项目并刷新列表。

```
@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    MobileArrayAdapter la = (MobileArrayAdapter) getListAdapter();
    la.remove(la.getItem(position));
    la.notifyDataSetChanged();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:53:10.490

做这样的事情

```
public class ListMobileActivity extends ListActivity {

String[] MOBILE_OS = new String[] { "Android", "iOS",
"WindowsMobile", "Blackberry"};

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState); 
```

```
//setListAdapter(new ArrayAdapter&lt;String&gt;(this, R.layout.list_mobile,
    //      R.id.label, MOBILE_OS)); 
```

```
}
@Override
protected void onResume() {
super.onResume();
setListAdapter(new MobileArrayAdapter(this, MOBILE_OS));
}
@Override
protected void onListItemClick(ListView l, View v, int position, long id) {

//get selected items
String[] MOBILE_OS = new String[] { "Android", "iOS",
"WindowsMobile", "Blackberry"};
String[] newArray = new String[MOBILE_OS.length()-1];
[tmp] =0;
for(int i=0;i<MOBILE_OS.length();i++){
if(i!=position){
newArray[tmp] = MOBILE_OS[i];
tmp++;
}
} 
MOBILE_OS = newArray;
onResume();

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T15:00:02.220

我重写你`mobilearrayadapter.java`的点击监听器到按钮。我建议改用它`ArrayList<String>`来`String[]`轻松添加和删除行

```
 import ...
.
.
.
public class MobileArrayAdapter extends ArrayAdapter<String> {
private final Context context;
private final String[] values;
private LayoutInflater inflater = null;

public MobileArrayAdapter(Context context, String[] values) {
    super(context, R.layout.list_mobile, values);
    inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    this.context = context;
    this.values = values;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View rowView = convertView;
    if(convertView == null)
         rowView = inflater.inflate(R.layout.list_mobile, parent, false);

    TextView textView = (TextView) rowView.findViewById(R.id.label);
    ImageView imageView = (ImageView) rowView.findViewById(R.id.logo);
    Button delBtn = (Button) rowView.findViewById(R.id.button1);
    delBtn..setOnClickListener(mOnClickListener);
    delBtn.setTag(position);
    textView.setText(values[position]);

    // Change icon based on name
    String s = values[position];

    System.out.println(s);

    if (s.equals("WindowsMobile")) {
        imageView.setImageResource(R.drawable.windowsmobile_logo);
    } else if (s.equals("iOS")) {
        imageView.setImageResource(R.drawable.ios_logo);
    } else if (s.equals("Blackberry")) {
        imageView.setImageResource(R.drawable.blackberry_logo);
    } else {
        imageView.setImageResource(R.drawable.android_logo);
    }

    return rowView;
}

private OnClickListener mOnClickListener = new OnClickListener() {

        @Override
        public void onClick(View v) {
             int position = (Integer) v.getTag();
            Toast.makeText(MainLocalListAdapter.this.context, ""+position, Toast.LENGTH_SHORT).show();

// After remove row from list call this

notifyDataSetChanged();
        }
    };
} 
```

# javascript - 在悬停时显示 div 后，如果悬停该 div 以外的任何位置，则将其隐藏

> ID：15341085
> 
> 赞同：0
> 
> 时间：2013-03-11T14:28:50.657
> 
> 标签：javascript, jquery, hover

我希望 div (.modal) 在鼠标移出时消失，但前提是悬停不在 .modal 或 .tooltip 类上。

我的代码：

```
 jQuery('html').hover(function() {
        jQuery('.modal').fadeOut('fast');
    });        
    jQuery('.tooltip, .modal').hover(function(event){  
        var toolTipId = jQuery(this).attr('id'); 
            modal = jQuery(this).parent().next().find('.'+toolTipId+'');          
        if(!modal.is(":visible")) {
            modal.stop().fadeIn('fast');
        }
        event.stopPropagation();
    }); 
```

如果使用单击而不是悬停，这将非常有效。我怎样才能使它适应悬停工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:46:58.727

你能做这样的事情吗：

```
jQuery('.tooltip, .modal').mouseenter(function(event){  
    //not sure what your modal variable is in your original code but it looks as if it is just the object you are hovering as you use it's id to get it in again so I replaced it with jQuery(this)
    if(!jQuery(this).is(":visible")) {
        jQuery(this).stop().fadeIn('fast');
    }
    event.stopPropagation();
});

jQuery('.tooltip, .modal').mouseleave(function() {
    jQuery(this).stop().fadeOut('fast');
}); 
```

# php - 重定向，但隐藏引荐来源网址

> ID：15341086
> 
> 赞同：3
> 
> 时间：2013-03-11T14:28:55.503
> 
> 标签：php, redirect, header, referrer, http-referer

假设我有一个 URL，`www.mysite.com/go`我想重定向到`www.anothersite.com/site.php?id=999`

诀窍是，我不希望 anothersite.com 能够看到请求来自 mysite.com。看起来地址`www.anothersite.com/site.php?id=999`是由用户手动输入到地址栏中的。

需要注意的是，这与 Google Analytics 无关，并且永远不会存在指向`www.mysite.com/go`任何地方的锚链接。相反，用户将在地址栏中手动输入 www.mysite.com/go（这比长 URL 更容易记住）。

这是如何实现的？有问题的技术是PHP。我想它可以通过该`header()`功能来实现，但谷歌搜索显示这仅适用于 https，而不适用于 http。执行重定向时，我可以通过 PHP 控制客户端提供的引用信息吗？我想如果我想让它看起来像是在地址栏中输入了地址，我将不得不删除推荐人信息。可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T14:32:58.183

通过 HTTP 重定向是不可能的。您无法控制传出的引荐来源标头，因为浏览器完全在客户端处理它。

您可以直接控制的唯一真正选择是使用 HTTPS。值为 HTTPS 页面的引荐来源网址不会被浏览器转发。

示例流程：

1.  `http://www.mysite.com/go`（因此任何现有链接都不必更改）
2.  `https://www.mysite.com/go`
3.  `http://www.anothersite.com/site.php?id=999`

# c# - 一个类是否有可能了解反射是否已用于自身？

> ID：15341092
> 
> 赞同：2
> 
> 时间：2013-03-11T14:29:02.707
> 
> 标签：c#, reflection

X 类使用反射方法来检查 Y 类是否具有特定方法。Y 类有没有办法找出 X 类正在检查的方法的详细信息？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T14:43:02.747

反射是在类型定义而不是实例上执行的。

该实例用于在需要时检索值，并且只是值的存储位置，Type 定义是该存储区域的映射。

因此，无法指示是否已在实例上使用反射...可以确定最近是否已对类型执行反射（在最后一次垃圾收集器运行之前，请考虑反射反射）但是切线最好不要在这里进一步探索，因为它仍然不能解决您打算实现的问题。

当 CLR 执行反射时，它不会留下任何已执行反射的痕迹，从而节省与执行反射相关的内存成本。

如果不修改 CLR，就不可能留下任何此类指示。

解决此问题的另一种方法是提供一个反射缓存，它将类型信息存储在 Dictionary 中，这将允许您确定是否已反映特定类型，然后使用 Dictionary 中的信息，而不是再次执行反射。

请参阅[如何在 C# 中拦截方法调用？](https://stackoverflow.com/questions/25803/how-do-i-intercept-a-method-call-in-c/5345043#5345043)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T14:37:07.883

类 Y 可以知道类 X 反映它的唯一方法是类 X 是否通过调用方法或设置或获取属性的值以某种方式让类 Y 知道。所以直接的答案是否定的。

# wpf - 在 FlowDocumentReader 中设置 FlowDocument 的背景颜色

> ID：15341094
> 
> 赞同：0
> 
> 时间：2013-03-11T14:29:07.340
> 
> 标签：wpf, flowdocumentreader

我一直在使用 a在 WPF 应用程序`RichTextBox`中显示`FlowDocuments`，但我发现有一个叫做的东西`FlowDocumentReader`可以免费为我提供很多功能。问题是，虽然 RichTextBox 中的背景显示为白色，但它现在是完全透明的。

我试过设置`Background`属性，但这只会改变底部的工具栏。

```
<FlowDocumentReader Grid.Row="1" Grid.Column="1" Name="rtbShowDoc" Margin="20, 0" Background="White">
    <FlowDocumentReader.Effect>
        <DropShadowEffect BlurRadius="10" Color="Black" ShadowDepth="3" />
    </FlowDocumentReader.Effect>
</FlowDocumentReader> 
```

![背景集](../Images/e57650a9c583abed865924d2bc5340d8.png)

我可以用 a 做一个丑陋的修复`DockPanel`，但这似乎不是正确的方法。

```
<DockPanel Grid.Row="1" Grid.Column="1" Margin="20, 0" Background="White">
    <DockPanel.Effect>
        <DropShadowEffect BlurRadius="10" Color="Black" ShadowDepth="3" />
    </DockPanel.Effect>
    <FlowDocumentReader Grid.Row="1" Grid.Column="1" Name="rtbShowDoc" Background="White">
    </FlowDocumentReader>
</DockPanel> 
```

如何设置 FlowDocumentReader 的背景？

**编辑：**添加了正在运行的应用程序的屏幕截图。如您所见，阴影效果应用于`FlowDocument`. ![运行应用程序](../Images/8676802713cca9c18b4114aeda5e50e5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T12:53:10.697

尝试设置 FlowDocument 的背景

[FlowDocument.Background 属性](http://msdn.microsoft.com/en-us/library/system.windows.documents.flowdocument.background%28v=vs.100%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-12T10:38:36.517

在 C# 中：

```
FlowDocument.Background = Brushes.Red; 
```

# jquery-ui - JqueryUI 的哪个部分包含动画颜色的代码？

> ID：15341097
> 
> 赞同：0
> 
> 时间：2013-03-11T14:29:25.437
> 
> 标签：jquery-ui

我只想下载[JqueryUI](http://jqueryui.com/download/#!version=1.10.1&components=1111000000000000000011111111111111)的彩色动画部分，或者它所在的任何部分，但我似乎无法找出它在哪个部分。我很确定它在“效果”中，但我需要的不仅仅是效果核？

也有人可以确认我是否需要拥有 JqueryUI 核心本身才能使彩色动画正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:32:43.780

您可以在没有 jQueryUI 的情况下将此功能作为单独的插件下载：[https ://github.com/jquery/jquery-color](https://github.com/jquery/jquery-color)

# php - php从数据库中收集数据

> ID：15341098
> 
> 赞同：-5
> 
> 时间：2013-03-11T14:29:25.410
> 
> 标签：php, mysql

尝试使用我的 sql 数据库中的数据加载 HTML 表单。我使用 Zampp phpmyadmin

```
<?php
$user = 'root';
$password = '';

$database="client";

mysql_connect(localhost,client);
@mysql_select_db($client) or die( "Unable to select database");
echo $query = "SELECT * $title,$service_number,$firstName,$LastName,$dob,$address,$postcode,$tel_number,$mob_number,$email,$partner_id ";
$result = mysql_query($query);

mysql_close();
?> 
```

我有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T14:32:14.183

1.  `mysql_`功能已弃用。使用`PDO`或`mysqli_`
2.  不要使用`@`;来抑制错误。使用错误处理程序（即。`mysql_error`）
3.  您没有从任何表格或任何列中进行选择
4.  执行查询后不获取结果集
5.  在没有绑定参数的情况下将变量传递给查询会使您对 SQL 注入持开放态度

**样品使用`mysqli_`**

```
<?php
$link = mysqli_connect("localhost", "my_user", "my_password", "world");

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$query = "SELECT Name, CountryCode FROM City ORDER by ID DESC LIMIT 50,5";

if ($result = mysqli_query($link, $query)) {

    /* fetch associative array */
    while ($row = mysqli_fetch_assoc($result)) {
        printf ("%s (%s)\n", $row["Name"], $row["CountryCode"]);
    }

    /* free result set */
    mysqli_free_result($result);
}

/* close connection */
mysqli_close($link);
?> 
```

[请参阅文档](http://php.net/manual/en/mysqli-result.fetch-assoc.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T14:32:16.017

您的查询结构不正确。您需要指定应从中选择记录的表名。例如，您应该执行以下操作：

```
SELECT * FROM `tblname` 
```

这将为表中的每条记录选择**所有**字段。您可以通过包含它们（不带通配符）来指定特定字段，`*`如下所示：

```
SELECT `title`, `service_number` FROM `tblname` 
```

尽管现在不推荐使用这组函数，但应该告知您`mysql_*`，您应该使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli)。

您还应该确保对您传入的变量进行转义。您的代码对当前形式的 SQL 注入是开放的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T14:34:25.157

你的查询全错了。正确的`SELECT`查询是这样的：

```
SELECT fields FROM table;
SELECT * FROM table; 
```

您在查询 ( `$title,$service_number...`) 中使用 PHP 变量，在提供的代码中，该变量不存在。您需要修复您的查询。

注意：它是`fields`OR `*`，而不是两者。另外，不要使用 MySQL_*，它在 PHP 5.5 中已被弃用。使用 MySQLi_* 或 PDO

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T14:36:51.547

这应该让你去

```
<?php
$dsn = 'mysql:host=localhost;dbname=client';
$username = 'root';
$password = '';
$options = array(
    PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES utf8',
); 

$dbh = new PDO($dsn, $username, $password, $options);

$sql = $dbh->prepare("SELECT title,service_number,FirstName,LastName,dob,address,postcode,te‌l_number,mob_number,email,partner_id FROM client_table");
$sql->execute();
$results = $sql->fetchAll(PDO::FETCH_ASSOC);

foreach($results as $r){
var_dump($r);
} 
```

# javascript - 如何根据 Oracle Apex 中的选择列表选项显示/隐藏文本字段？

> ID：15341104
> 
> 赞同：5
> 
> 时间：2013-03-11T14:29:39.700
> 
> 标签：javascript, oracle, dynamic, oracle-apex

简单的问题，但我是 Apex 的新手...

基本上我有两个项目：一个选择列表和一个文本字段。默认情况下，不应出现文本字段。选择列表有两个值供用户选择。如果用户选择一个值，则文本字段将保持隐藏状态，但如果用户选择其他值，则文本字段将出现。

例子：

从选择列表中，用户可以选择“显示”或“隐藏”。如果用户选择“隐藏”，则应隐藏文本字段，默认情况下应如此。但是如果用户选择“显示”，那么文本字段就会出现。

我怎样才能做到这一点？

TIA

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-11T23:24:41.653

试试这个：

1.  调出选择列表项。转到**值列表**部分并确保设置了以下内容：

    *   ***显示空值***：否
    *   ***值定义列表：*** `STATIC:SHOW;SHOW,HIDE;HIDE` [如果您愿意，可以将其替换为存储的 LOV]

2.  使用以下属性创建一个新的动态操作：

    ### 主要属性

    *   ***事件***：变化
    *   ***选择类型***：项目
    *   ***项目***：[P1_SELECT_LIST]
    *   ***条件***：等于
    *   ***价值***：展示

        ### 真正的行动

    *   ***行动***：表演

    *   ***当结果为***：真
    *   ***页面加载时触发***：是
    *   ***选择类型***：项目
    *   ***项目***：[P1_TEXT]

        ### 虚假行动

    *   ***行动***：隐藏

    *   ***结果为***: False
    *   ***页面加载时触发***：是
    *   ***选择类型***：项目
    *   ***项目***：[P1_TEXT]

# css - 插入文本的水平分隔线

> ID：15341106
> 
> 赞同：-1
> 
> 时间：2013-03-11T14:29:42.363
> 
> 标签：css, html

我希望有人可以帮助我！我正在尝试从主题森林（[http://themeforest.net/item/lespaul-retina-responsive-wordpress-theme/full_screen_preview/4083224](http://themeforest.net/item/lespaul-retina-responsive-wordpress-theme/full_screen_preview/4083224) - 向下滚动到底部）实现在这个wordpress模板上看到的预期效果。

基本上在页面上重复一个像素分隔符，并在左侧嵌入文本。我已经尝试了很多不同的 CSS 代码和 html ......这应该是一件容易的事，但我似乎无法理解它。

我得到的最接近这种效果的是水平分隔线，下面有 Text ......

/////////////////////////

TEXT（但居中）

但我想拥有

文本 ///////////////////////////

这是我的代码！

```
div.divider17a {
height:5px; width:100%; border:0; background:url(images/divider17.png) repeat-x;
margin:35px 0 25px;
padding:0;
text-align:left;
float:left;
width:100%;
}
div.divider_notext {
margin:50px 0 20px;
}
div.divider_left1 {
text-align:left;
} 
```

HTML

`<div class="divider17a divider_left1"><h3>Strategic Planning</h3></div>`

任何帮助将不胜感激...谢谢=D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:32:19.567

您是否有理由不只是使用他们使用的相同样式？

```
<h3 class="widget-heading separator-heading">
    <span class="text-holder">Companies that trust us</span>
</h3>

.separator-heading {
    background-image: url(../img/separator-heading-diagonal.png);
    background-repeat: repeat-x;
    background-position: 0 50%;
}

.separator-heading .text-holder {
    display: inline-block;
    padding: 0 .6em 0 0;
    background-color: white;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:33:18.747

如果**必须**使用文本，可以使用以下 CSS 样式：

```
.divider17a h3:after{
    content:"//////////////////////////////////////";
    overflow:hidden;
} 
```

并将以下内容添加到您的容器中：

```
div.divider17a{
    overflow:hidden;
    white-space:nowrap;
} 
```

演示：http: [//jsfiddle.net/kyBaN/1/](http://jsfiddle.net/kyBaN/1/)

或者，使用背景图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T14:33:31.300

您能否提供指向您的页面和后续代码的链接？此外，如果您查看他们的代码，这就是他们正在做的事情：

```
.separator-heading, hr.diagonal {
background-image: url(../img/separator-heading-diagonal.png);
background-repeat: repeat-x;
background-position: 0 50%; 
```

}

# highcharts - Highcharts - 移动页面上的多个图表

> ID：15341107
> 
> 赞同：1
> 
> 时间：2013-03-11T14:29:51.043
> 
> 标签：highcharts

我对 HighCharts 有疑问。我正在构建一个移动页面，该页面将在屏幕上包含超过 20 个图表，但是图表呈现有很大的延迟（5 - 10 秒）。我正在使用 DotNet.Highcharts 在服务器端构建图表，然后将创建到页面的 div 和 script 标签呈现出来。

我的问题是：有没有人尝试过类似的事情（我敢肯定我不能是唯一一个），你是如何克服这个问题的，这样你的用户就不会体验到渲染这些图表的“滞后”？

任何帮助或建议将不胜感激。

谢谢，亚当

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:45:12.110

当我第一次开始为我的公司开发仪表板时，我被告知我必须支持 IE8，因为我们的大多数客户都会使用它。

我也不得不即时渲染近 20 张图表……而且我的加载时间确实受到了影响，事实上……它的范围在 30 秒到 2 分钟之间。

我为解决这个问题所做的实际上是将图表分开。我没有将所有 20 个左右的图表放在一页上，而是将它们分成“标签”或页面的不同部分，并且仅在需要显示图表时才初始化图表。不是一个大的延迟，而是几个非常小的延迟。

我不确定这是否是您可以在没有看到它的情况下在您的网站上完成的事情，但它可能值得一试！

# xtend - 在 xtend 中创建逗号分隔的列表

> ID：15341108
> 
> 赞同：5
> 
> 时间：2013-03-11T14:29:52.697
> 
> 标签：xtend

我正在学习 xtend。在 xtend 中创建逗号分隔列表的好方法是什么？（类似于 xpand 中的 SEPARATOR）

我想在生成器中生成一个逗号分隔的参数列表：

```
«FOR param: row.params»
     "«param.value»",
«ENDFOR» 
```

这可行，但我需要省略最后一个逗号。我也试过 row.params.join(",") 但是引号不见了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-11T14:59:51.023

你可能想试试

```
«FOR param: row.params SEPARATOR ','»
     "«param.value»"
«ENDFOR» 
```

或者

```
row.params.join(',') [ value ] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T09:48:16.350

就像是

```
row.params.join(', ')[''' "value" '''] 
```

应该做的伎俩。我在双引号前后放置空格只是为了帮助您查看每个字符，但您可能希望删除它们。

# html - 如何在 VB.net 中制作带有文本的图像按钮？

> ID：15341121
> 
> 赞同：-1
> 
> 时间：2013-03-11T14:30:32.333
> 
> 标签：html, vb.net

嘿，我的问题很简单，我正在尝试做一个与您可以以 vb 形式获得的按钮完全相同的按钮。例如，我想要在我的按钮中添加一些文本，并且我还想要其中的图像。唯一的问题是在 VB.net 中只有两种类型的按钮，第一种是带有图像且根本没有文本的按钮，而第二种是只有文本的按钮。我发现的唯一方法是将图像放在背景中。不幸的是，图像占用了按钮中的所有空间。我想知道是否有办法将背景图像向左或向右对齐

这是我的按钮的 HTML 代码：

```
<asp:Button ID="btn_LoadReport" runat="server" Text="Charger" 
   style="margin-left: 0px; margin-bottom: 0px; margin-right:0px;"                                                   
                            Height="35px" Width="102px" 
                            CssClass="Charger" /> 
```

这是我目前拥有的css代码：

```
.Charger
{
    background-image:url(report.png);
    background-repeat:no-repeat;
    text-align:left;    
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:58:49.330

> 我尝试使用 CSS 将图像放在背景中，但我的文字在图像上方

这就是[`background-position`属性](http://www.w3.org/wiki/CSS/Properties/background-position)的用途。

```
<button>Text</button>

button {
    padding-right:40px;
    background-image:url(myImage.png);
    background-repeat:no-repeat;
    background-position:center right;
} 
```

请注意，该`padding-right`属性用于防止文本与图像重叠。

[JSFiddle 示例](http://jsfiddle.net/NQESB/)。

# jakarta-ee - Java EE：Eclipselink 事务丢失

> ID：15341128
> 
> 赞同：4
> 
> 时间：2013-03-11T14:30:47.317
> 
> 标签：jakarta-ee, jpa, glassfish, eclipselink

我有一个基于 Maven 的 Java EE 项目，应该在 GlassFish v3 上运行。有一个注入 EJB 服务的 JSF ManagedBean。ManagedBean 在发生一些 JPA 操作（创建新实体对象、持久化、刷新）的按钮单击时调用注入的 EJB 方法之一。当被`EntityManager.flush()`调用时，它会引发异常：

```
Caused by: javax.persistence.TransactionRequiredException:  Exception
Description: No transaction is currently active 
```

数据源是具有 JTA 事务类型的 jta 数据源（在 persistence.xml 中定义）。

我已经找到了解决方案，但由于部署问题，它并不令人满意。如果我将下一行代码放入persistence.xml，那么它可以毫无问题地运行：

```
<property name="eclipselink.target-server" value="SunAS9"/> 
```

由于这个原因，我假设这是一个部署问题，当 eclipselink 无法识别 JTA 管理器时。

任何建议将不胜感激，谢谢！

**更新：**

@MRalwasser：这是完整的堆栈跟踪。（对不起，我不得不删除真正的包名，它现在是 masked.package.name）[pastebin 上的堆栈跟踪](http://pastebin.com/raw.php?i=FD4XHAhG)

@Chris：对不起，我忘了提，GeneriDao 类通过工厂方法创建实体管理器，而不是通过依赖注入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T11:40:22.460

默认情况下，只有 EJB 可以在 CMT 中工作。在托管 bean 或 CDI bean 中，您必须实现自己的机制来处理事务并在其中运行您的服务。

```
public class ManagedBean {        

    @Inject
    yourEjbService service;

    @Resource
    UserTransaction utx;

    public void save(){
        try{
            utx.begin();
            service.doAction();
            utx.commit();
        } catch (Exception e) {
            try {
                utx.rollback();
            } catch (Exception ex) {
                ...
            } 
        }
    }
    ...
 } 
```

如果您`EntityManager.flush()`使用`@PersistenceContext`. 它会在 EJB 中的每个方法结束后自动分离实体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-10T22:12:53.003

Java Enterprise 的持久性控制机制有几个选项和特定的设计选择。在我使用的几乎所有 Java EE 实现中，都使用了容器管理事务 (CMT)。在偶尔的情况下，可以选择 bean 管理事务 (BMT)。

**当您需要确定“提交”（或“回滚”）在程序执行期间发生的确切时间时，可以首选**Bean 管理的事务。**这在高性能的时间关键型应用领域可能是必需的。有关 BMT 的示例，请参见示例中的“Bean Managed Transactions”部分[，Bean Managed Transactions](https://www.tutorialspoint.com/ejb/ejb_transactions.htm)**

 ****容器管理事务**意味着应用服务器（“容器”）中的软件在使用持久性上下文的 Java 代码执行之前调用“开始”事务。当代码执行完成时（当调用树返回时，例如作为网络请求的结果），应用服务器调用'commit'。因此，修改后的实体实际上在应用程序数据库中更新。

在 Java EE 中，语句：`@TransactionManagement(TransactionManagementType.CONTAINER)`和`@TransactionManagement(TransactionManagementType.BEAN)`分别表示容器管理事务或 bean 管理事务。Java EE 定义了几种类型的 bean：会话驱动 bean、消息驱动 bean、本地 bean。这些 bean 通常是`@Stateless`，并且都可以与容器管理的事务一起使用。

在 EE 中可以通过添加注释来指定容器管理事务处理的详细控制：

```
@TransactionAttribute(REQUIRES_NEW) 
public void myTopLevelMethodWhichStartsNewInnerTransaction()
....
@TransactionAttribute(REQUIRED)
public void myTopLevelMethodContinueExistingTransactionIfAny()
....
@TransactionAttribute(NEVER)
public void myNoCurrentTransactionAllowedWhenMethodCalled()
.... 
```

*冲洗*

调用“flush”以确保数据库缓存写入磁盘的必要性取决于所使用的数据库类型。例如，对于 Postgress 调用`flush`会有所不同，而对于内存数据库 'derby'，flush 没有效果，并且在后一种情况下可能会导致类似于此问题中报告的错误。因此，效果`flush`取决于数据库。**

# python - 如何在 lambda 函数中执行赋值

> ID：15341130
> 
> 赞同：1
> 
> 时间：2013-03-11T14:30:54.410
> 
> 标签：python, python-2.7, lambda, variable-assignment

Python 2.7.1

我想了解为什么我不能做以下看起来很明智的事情

```
def do_stuff():
    # return a function which takes a map as an argument and puts a key in there
    f = lambda map: map['x'] = 'y' #compilation error
    return f 

x = do_stuff()
map = {}
x(map)
print map['x'] 
```

我可以让那个 lambda 函数变得更简单一些，`f = lambda map: os.path.exists`但是我不能让它改变地图。有人可以告诉我如何实现这一目标吗？如果这根本不可能，为什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-11T14:37:17.890

您不能在表达式中使用赋值，它是一个语句。A`lambda`只能包含*一个*表达式，不包含语句。

但是，您*可以通过使用该*[`operator.setitem()`函数](http://docs.python.org/2/library/operator.html#operator.setitem)来分配给地图：

```
import operator

lambda map: operator.setitem(map, 'x', 'y') 
```

# c# - 当鼠标位于任何 SDI 表单上时如何检测表单名称

> ID：15341131
> 
> 赞同：5
> 
> 时间：2013-03-11T14:30:55.037
> 
> 标签：c#, winforms, winapi

当鼠标放在表单上时，我正在寻找获取表单名称的技巧。假设我有一个 mdi 表单和许多 sdi 表单，例如 form1、form2、form3，并且所有 sdi 表单都已打开。假设我在 form1 上运行了一个计时器，它将定期运行。当鼠标放在任何 SDI 表单窗口上时，我想在 form1 的标签上显示来自计时器滴答事件的表单名称。

这种方式我尝试做到这一点。这是代码

```
private void timer1_Tick(object sender, EventArgs e) {
    var handle = WindowFromPoint(Cursor.Position);
    if (handle != IntPtr.Zero) {
        var ctl = Control.FromHandle(handle);
        if (ctl != null) {
            label1.Text = ctl.Name;
            return;
        }
    }
    label1.Text = "None";
}

[System.Runtime.InteropServices.DllImport("user32.dll")]
private static extern IntPtr WindowFromPoint(Point pos); 
```

上面的代码运行完美，但有一些小故障。当我将鼠标放在 MDI 表单或 Form1 上时，表单名称会显示在 form1 上，但是当我将鼠标放在 Form2 或 Form2 上时，它们的名称不会显示。我无法理解这段代码中有什么问题。请指导我修复它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T16:53:48.303

既然你有控制权，我想你只需要使用这个`FindForm()`功能：

```
var ctl = Control.FromHandle(handle);
if (ctl != null) {
  var form = ctrl.FindForm();
  if (form != null) {
    label1.Text = form.Name;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T16:27:05.453

Form2 的名称未显示的原因是您创建的 Form2 实例没有名称。为了演示这一点，请查看位于 Program.cs 文件中的以下代码块：

```
MDIParent mdi = new MDIParent();
Form1 frm1 = new Form1();
frm1.MdiParent = mdi;
Form2 frm2 = new Form2();
frm2.MdiParent = mdi;
frm1.Show();
frm2.Show();
Application.Run(mdi); 
```

如果添加断点，您将看到 Form2 的名称为空。但是等等，还有更多！

如果您将控件（任何控件）添加到 Form 2，那么在您创建它时它就会有一个名称**。**看起来命名系统在存在多个控件之前不需要为表单控件分配名称，它在`InitializeComponent`调用期间会这样做。你可以看看这段代码。这是为没有控件的“Form3”生成的代码：

```
private void InitializeComponent()
{
    this.components = new System.ComponentModel.Container();
    this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
    this.Text = "Form3";
} 
```

这是添加标签后的相同形式：

```
private void InitializeComponent()
{
    this.label1 = new System.Windows.Forms.Label();
    this.SuspendLayout();
    // 
    // label1
    // 
    this.label1.AutoSize = true;
    this.label1.Location = new System.Drawing.Point(13, 13);
    this.label1.Name = "label1";
    this.label1.Size = new System.Drawing.Size(35, 13);
    this.label1.TabIndex = 0;
    this.label1.Text = "label1";
    // 
    // Form3
    // 
    this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
    this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
    this.ClientSize = new System.Drawing.Size(284, 262);
    this.Controls.Add(this.label1);
    this.Name = "Form3";
    this.Text = "Form3";
    this.ResumeLayout(false);
    this.PerformLayout();

} 
```

如您所见，仅当存在其他控件时，才会为表单分配名称。至于为什么会这样，您可能不得不向编写自动生成代码的人询问该答案。

# ruby - 如何在运行时检索具有存储在 rails 3.2.12 中的字符串变量中的关系的对象？

> ID：15341136
> 
> 赞同：0
> 
> 时间：2013-03-11T14:31:06.527
> 
> 标签：ruby, ruby-on-rails-3

假设有模型`customer`，`account`并且`address`：

```
class Customer
  has_many :accounts
end

class Account 
  belongs_to :customer
  has_many :addresses
end

class Address
  belongs_to :account
end 
```

给定一个对象地址，它的客户可以被检索为：

```
customer = address.account.customer 
```

现在让我们将关系存储在字符串变量`address_relation = 'account.customer'`中。给定一个`address`对象，有没有办法`customer`用字符串变量检索它，`address_relation`例如：

`customer = address.address_relation`?

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:08:52.507

我会做类似的事情

```
customer = address.address_relation.split(".").inject(address) do |object, method| 
  object.send(method)
end 
```

`send`如果您的关系链中`try`有一个 nil 对象，您可以切换

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:04:30.047

不确定我是否正确理解了这个问题，但我想你可以使用 Ruby 的[send](http://ruby-doc.org/core-2.0/Object.html#method-i-send)方法来动态解决模型关系。

```
object  = customer
methods = "account.customer".split(".")

methods.each do |m|
  object = object.send(m)
end 
```

# list - Haskell：将函数的“列表”结果作为“列表列表”返回，而不使用空列表“[]：foo”

> ID：15341139
> 
> 赞同：1
> 
> 时间：2013-03-11T14:31:11.197
> 
> 标签：list, haskell, syntax

返回列表列表（[[a]]）但不使用空列表（[]：[a]）的语法（如果可能的话）是什么？（类似于下面第二个评论的后卫（2），这是不正确的）

这是一个正常工作的功能：

```
-- Split string on every (shouldSplit == true)
splitWith :: (Char -> Bool) -> [Char] -> [[Char]]
splitWith shouldSplit list = filter (not.null) -- would like to get rid of filter
  (imp' shouldSplit list)
  where 
    imp' _ [] = [[]]
    imp' shouldSplit (x:xs)
      | shouldSplit x  = []:imp' shouldSplit xs  -- (1) this line is adding empty lists
--      | shouldSplit x  = [imp' shouldSplit xs]   -- (2) if this would be correct, no filter needed
      | otherwise  = let (z:zs) = imp' shouldSplit xs in (x:z):zs 
```

这是正确的结果

```
Prelude> splitWith (== 'a') "miraaaakojajeja234"
["mir","koj","jej","234"] 
```

但是，它必须使用“过滤器”来清理其结果，所以我想摆脱“过滤器”功能。这是不使用过滤器的结果：

```
["mir","","","","koj","jej","234"] 
```

如果使用“ **| shouldSplit x = imp' shouldSplit xs** ”代替第一个保护，则结果不正确：

```
["mirkojjej234"] 
```

第一个守卫（1）添加空列表，因此（我假设）编译器可以将结果视为列表列表（[[a]]）。

（我对函数的另一个/不同解决方案不感兴趣，只是语法说明。）

```
.
.
. 
```

**答案**：

Dave4420 的回答让我找到了答案，但这是一个评论，而不是一个答案，所以我不能接受它作为答案。问题的解决方案是我问错了问题。这不是语法的问题，而是我的算法的问题。

解决空列表问题的另一个/不同解决方案有几个答案，但它们不是我的问题的答案。然而，他们扩展了我对如何使用基本 Haskell 语法完成事情的方法的看法，我为此感谢他们。

**编辑：**

```
splitWith :: (Char -> Bool) -> String -> [String]
splitWith p = go False
  where 
    go _ [] = [[]]
    go lastEmpty (x:xs)
      | p x        = if lastEmpty then go True xs else []:go True xs
      | otherwise  = let (z:zs) = go False xs in (x:z):zs 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:10:32.960

这个利用模式匹配来完成在单次遍历中不产生空交错列表的任务：

```
splitWith :: Eq a => (a -> Bool) -> [a] -> [[a]]
splitWith f list = case splitWith' f list of
  []:result -> result
  result -> result
  where
    splitWith' _ [] = []
    splitWith' f (a:[]) = if f a then [] else [[a]]
    splitWith' f (a:b:tail) =
      let next = splitWith' f (b : tail)
      in if f a
        then if a == b
          then next
          else [] : next
        else case next of
          [] -> [[a]]
          nextHead:nextTail -> (a : nextHead) : nextTail 
```

运行它：

```
main = do
  print $ splitWith (== 'a') "miraaaakojajeja234"
  print $ splitWith (== 'a') "mirrraaaakkkojjjajeja234"
  print $ splitWith (== 'a') "aaabbbaaa" 
```

产生：

```
["mir","koj","jej","234"]
["mirrr","kkkojjj","jej","234"]
["bbb"] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T15:03:27.410

问题很自然地表示为您要拆分的列表的折叠。您需要跟踪两个状态 - 结果列表和正在构建以附加到结果列表的当前单词。

我可能会写一个像这样的天真的版本：

```
splitWith p xs = word:result
    where
        (result, word)        = foldr func ([], []) xs
        func x (result, word) = if p x
            then (word:result,[])
            else (result, x:word) 
```

请注意，这也会留在空列表中，因为每当它检测到满足 predicate 的新元素时，它都会将当前单词附加到结果中`p`。

要解决此问题，只需将 list cons 运算符替换`(:)`为 new 运算符

```
(~:) :: [a] -> [[a]] -> [[a]] 
```

如果原始列表非空，则仅将一个列表转换为另一个列表。算法的其余部分保持不变。

```
splitWith p xs = word ~: result
    where
        (result, word)        = foldr func ([], []) xs
        func x (result, word) = if p x
            then (word ~: result, [])
            else (result, x:word)
        x ~: xs = if null x then xs else x:xs 
```

哪个做你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T15:11:31.927

我想我和克里斯有类似的想法，我想，即使不是那么优雅：

```
splitWith shouldSplit list = imp' list [] []
  where 
    imp' [] accum result = result ++ if null accum then [] else [accum]
    imp' (x:xs) accum result
      | shouldSplit x  = 
          imp' xs [] (result ++ if null accum 
                                   then [] 
                                   else [accum])
      | otherwise  = imp' xs (accum ++ [x]) result 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-13T00:40:40.620

这基本上只是 and 的交替应用`dropWhile`，`break`不是吗：

```
splitWith p xs = g xs
   where
     g xs = let (a,b) = break p (dropWhile p xs)
            in if null a then [] else a : g b 
```

您说您对除您的解决方案之外的其他解决方案不感兴趣，但其他读者可能会。它确实很短，而且看起来很清楚。随着您的学习，使用基本`Prelude`功能成为第二天性。:)

至于您的代码，以非必要的方式进行了一些修改（使用简短的暗示性函数名称，例如`p`“*谓词”*和`g`主要工作函数），它是

```
splitWith :: (Char -> Bool) -> [Char] -> [[Char]]
splitWith p list = filter (not.null) (g list)
  where 
    g  [] = [[]]
    g (x:xs)
      | p x  = [] : g xs  
      | otherwise  = let (z:zs) = g xs 
                     in (x:z):zs 
```

此外，无需将谓词作为参数传递给工作人员（正如评论中提到的那样）。现在可以说它更具可读性。

接下来，通过最小的变化，它变成

```
splitWith :: (Char -> Bool) -> [Char] -> [[Char]]
splitWith p list = case g list of ([]:r)-> r; x->x
  where 
    g  [] = [[]]
    g (x:xs)
      | p x  = case z of []-> r;    -- start a new word IF not already
                         _ -> []:r  
      | otherwise  = (x:z):zs
           where                    -- now z,zs are accessible
             r@(z:zs) = g xs        -- in both cases 
```

可以按您的意愿工作。顶层`case`在这里最多删除一个空词，在内部函数工作期间的某个时间点用作分隔符。你在这里`filter (not.null)`本质上融合到了worker函数`g`中，*有条件*地打开一个新词1（即空列表的加¹）^。

将您的替换`let`为`where`允许变量（等）在定义`z`的第二个子句的两个分支中都可以访问。`g`

最后，您的算法足够接近，并且代码毕竟可以修复。

* * *

¹在思考“从右到左”时。实际上，该列表是从左到右构建的，以受保护的递归/[尾递归模 cons](http://en.wikipedia.org/wiki/Tail_call#Tail_recursion_modulo_cons)方式。

# java - 乘以 BufferedImage 来设置亮度是正确的吗？

> ID：15341142
> 
> 赞同：0
> 
> 时间：2013-03-11T14:31:21.707
> 
> 标签：java, bufferedimage, brightness

这是一个问题，我是否使用正确的方法。通过正确的方式，我的意思是，有没有一种更节省内存的方式来做到这一点？

我使用 1 个图像源：

```
String imgurl = "imgreadertest8.png";
  BufferedImage loadedimage = ImageIO.read(getClass().getResource(imgurl));
  BufferedImage image = ImageIO.read(getClass().getResource(imgurl)); 
```

我在 paint() 方法中绘制图像。但有时我需要设置亮度：

```
public void setBrightness(float brightness)
{
    RescaleOp rescaleOp = new RescaleOp(brightness, 15, null);
    rescaleOp.filter(loadedimage, image);
} 
```

所以我读了同一张图片，两次。一个有一个“最终”的 BufferedImage （它不是真正的最终......但我不能在这种情况下使用最终，因为它需要在构造函数之外使用（你在这里看不到，但它是））这是用作模板，用于编辑和绘制。

**更多信息：**在尝试这种方式之前，我这样做了：

```
String imgurl = "imgreadertest8.png";
  BufferedImage loadedimage = ImageIO.read(getClass().getResource(imgurl));
  BufferedImage image = loadedimage; 
```

但是当我编辑图像时，它也会编辑加载的图像。几乎是因为它们是同一个对象。

所以......有没有另一种方法来设置这个图像的亮度，而不加载同一个图像两次？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:55:32.737

以下将复制图像。

```
public static BufferedImage copy(BufferedImage img) {
    Hashtable<?,?> properties = new Hashtable<>();
    for (String propertyName : img.getPropertyNames()) {
        properties.put(propertyName, img.getProperty(propertyName));
    }
    return new BufferedImage(img.getColorModel(),
            img.copyData(null),
            img.isAlphaPremultiplied(), properties);

} 
```

通过创建一个空图像，绘制`createGraphics`它（不要忘记处置），可以更慢但更简单地实现同样的事情。如果您需要 Graphics2D 来处理图像，那也可能是一种选择。

# java - 是否有不使用 Java2D API 的高质量图像缩放库？

> ID：15341148
> 
> 赞同：0
> 
> 时间：2013-03-11T14:31:29.683
> 
> 标签：java, image, image-scaling

我需要 Java 中的高缩放图像 API。但是Java的算法太简单了。我已经评估了一些像缩略图器这样的库。但是我看到的所有这些库都只添加了一个围绕 Java2D API 的框架。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:43:02.897

有`imagemagick` [http://www.imagemagick.org/script/api.php#java](http://www.imagemagick.org/script/api.php#java)

从它的网站：

> ImageMagick® 是一个用于创建、编辑、合成或转换位图图像的软件套件。它可以读取和写入各种格式（超过 100 种）的图像，包括 DPX、EXR、GIF、JPEG、JPEG-2000、PDF、PhotoCD、PNG、Postscript、SVG 和 TIFF。使用 ImageMagick 调整大小、翻转、镜像、旋转、扭曲、剪切和变换图像，调整图像颜色，应用各种特殊效果，或绘制文本、线条、多边形、椭圆和贝塞尔曲线。

# scriptella - 使用 scriptella 导入 fixwidth 文本文件

> ID：15341150
> 
> 赞同：0
> 
> 时间：2013-03-11T14:31:37.000
> 
> 标签：scriptella

将 fixwidth 文件导入带有 scriptella 的表的最佳方法是什么？

文本文件：

```
blabla bloblo ble    bli 
```

列宽：

```
(1,7) (8,14) (15,21) (22,24) 
```

桌子：

```
T_IMPORT (
  FIELD1 VARCHAR(8),
  FIELD2 VARCHAR(8),
  FIELD3 VARCHAR(8),
  FIELD4 VARCHAR(4)
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T13:43:33.790

我想出的解决方案是：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE etl SYSTEM "http://scriptella.javaforge.com/dtd/etl.dtd">
<etl>
    <connection id="database" url="jdbc:hsqldb:mem:mymemdb" user="SA" password=""/>
    <connection id="in" driver="text" url="${filePath}test_import.txt" />
    <query connection-id="in">
            <script connection-id="database">
                INSERT INTO T_IMPORT 
                VALUES (
                ?{column0.substring(0,7)},
                ?{column0.substring(8,14)},
                ?{column0.substring(15,21)},
                ?{column0.substring(22,24)});
        </script>
    </query>
</etl> 
```

# jquery - can contenteditable DIV 可以有圆形轮廓

> ID：15341152
> 
> 赞同：0
> 
> 时间：2013-03-11T14:31:46.593
> 
> 标签：jquery, css

在浏览了一些关于 contenteditable 的问题后，我发现我可以更改边框的颜色和宽度（使用轮廓），但由于它不是边框，我无法找到一种方法让轮廓像“border-radius”一样圆润”。

我怎样才能做到这一点？

谢谢

编辑：我发现了一些对我有用的东西：

```
 .editableDiv {
          margin-bottom: 5px;
          outline: 0px solid transparent;
          padding:5px;
        }
        .editableDiv:hover {
          outline: 0px solid transparent;
          box-shadow: 0px 0px 0px 1px #ccc inset;
          border-radius: 10px;
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T14:37:08.163

没有明确的方法来完成这个（截至目前），通常我使用的是硬阴影

```
div {
    background: #eeeeee;
    border-radius:5px;
    margin: 30px;
    height: 100px;
    width: 200px;
    box-shadow: 0px 0px 0px 1px #000 inset;
} 
```

[**演示**](http://jsfiddle.net/WsZsF/)

# ruby - 与创建为“Proc”对象的“块”的“调用”混淆

> ID：15341157
> 
> 赞同：1
> 
> 时间：2013-03-11T14:32:13.170
> 
> 标签：ruby

我创建了一个对象调用`Proc.new`并将一个块作为参数传递给它：

```
a = Proc.new{|x| x = x*10; puts(x)}
#=> #<Proc:0xd26fd8@(irb):3>
a.call(10)
#100
#=> nil
a.call(10,20)
#100
#=> nil
a.call(10,20,40)
#100
#=> nil 
```

我也没用过`splat operator(*)`。但是如何阻止参数`x`能够忽略额外的参数呢？

当我们做同样的事情时，我们会得到一个明确的错误，但为什么块参数不是这种情况？

```
def show(x)
print "X::#{x}"
end
#=> nil
show(10)
#X::10#=> nil
show(10,20)
#ArgumentError: wrong number of arguments (2 for 1)
#        from (irb):6:in `show'
#        from (irb):10
#        from C:/Ruby193/bin/irb:12:in `<main>' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:45:37.277

`Procs`将缺少的参数转换为 nil 而`lambda`没有。

如果您想容忍错误，请使用 Procs。否则你会想去`lambda`

```
l = ->(x) { x = x * 10; puts x }
=> #<Proc:0x007fada3be9468@(pry):12 (lambda)>
l.call(10, 20)
ArgumentError: wrong number of arguments (2 for 1)
from (pry):12:in `block in <main>' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T14:36:55.257

这就是 Procs 的工作方式，在内部，他们不在乎是否传递了太多参数。

`Proc#call`将接受一个参数数组并将它们绑定到块的参数，如果计数不匹配，则不会抱怨。

但是，Proc Lambdas 会抱怨它，这是它们与常规 Procs 之间的区别之一：

```
2.0.0p0 :006 > r = lambda { |x| puts x }
 => #<Proc:0x007fac6913b600@(irb):6 (lambda)>
2.0.0p0 :007 > r.call(1,2)
ArgumentError: wrong number of arguments (2 for 1)
from (irb):6:in `block in irb_binding'
from (irb):7:in `call'
from (irb):7
from /Users/Intrepidd/.rvm/rubies/ruby-2.0.0-p0/bin/irb:16:in `<main>' 
```

# javascript - 使用 raphael.js 进行轨道动画？

> ID：15341165
> 
> 赞同：1
> 
> 时间：2013-03-11T14:32:20.277
> 
> 标签：javascript, raphael

raphael.js 的新手，我正在寻找关于如何做一些事情的解释，比如在轨道上围绕太阳移动行星。我一直试图创建一条路径并为围绕它的圆圈的运动设置动画。

感谢您提供正确方向的任何指示！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T19:23:19.873

我的朋友@Kevin Nielsen 是对的，你会想要“getPointAtLength”。[这里](http://jsfiddle.net/chriswilsondc/Wsv3e/4/)有一个不错的小 Raphael 函数，它添加了一个 .animateAlong() 函数，尽管它需要一些修改才能处理圆形对象。我把它剥离成你的必需品。

假设您认识 1609 年后的天文学，[您将需要椭圆轨道](http://en.wikipedia.org/wiki/Kepler%27s_laws_of_planetary_motion)。（虽然实际上短半径和长半径的差异很小，这就是哥白尼有点偏离标准的原因。）但是你不能使用 .ellipse() 函数，因为你需要椭圆作为路径为了沿着它制作动画。请参阅[椭圆弧](http://www.w3.org/TR/SVG/paths.html#PathDataEllipticalArcCommands)的 SVG 规范，或者只是尝试一堆组合，直到看起来正确，就像我做的那样：

```
var paper = Raphael("canvas", 500, 500);

var center = {x: 200, y: 100 };
var a = 100;
var b = 80;

//see http://www.w3.org/TR/SVG/paths.html#PathDataEllipticalArcCommands
var ellipse = "M" + (center.x - a) + "," + center.y + " a " + a + "," + b + " 0 1,1 0,0.1";

var orbit = paper.path(ellipse); 
```

现在你想在椭圆的一个焦点上画地球，沿着路径画月亮。我们将从[近地点](http://www.merriam-webster.com/dictionary/perigee)开始。

```
var focus = Math.pow(a*a - b*b, 0.5);

var palebluedot = paper.circle(center.x - focus, center.y, 25)
    .attr({
        stroke: 0,
        fill: "blue"    
    });

var moon = paper.circle(center.x - a, center.y, 10)
.attr({
    stroke: 0,
    fill: "#CCC"
}); 
```

这是您修改后的“animateAlong”函数：

```
//Adapted from https://github.com/brianblakely/raphael-animate-along/blob/master/raphael-animate-along.js
Raphael.el.animateAlong = function(path, duration, easing, callback) {
    var element = this;
    element.path = path;
    element.pathLen = element.path.getTotalLength();    
    duration = (typeof duration === "undefined") ? 5000 : duration;
    easing = (typeof easing === "undefined") ? "linear" : duration;

    //create an "along" function to take a variable from zero to 1 and return coordinates. Note we're using cx and cy specifically for a circle    
paper.customAttributes.along = function(v) {
        var point = this.path.getPointAtLength(v * this.pathLen),
            attrs = {
                cx: point.x,
                cy: point.y 
            };
        this.rotateWith && (attrs.transform = 'r'+point.alpha);
        return attrs;
    };    

    element.attr({along: 0 }).animate({along: 1}, duration, easing, function() {
        callback && callback.call(element);
    });    
}; 
```

这是：

```
moon.animateAlong(orbit, 2000); 
```

[jsFiddle](http://jsfiddle.net/chriswilsondc/Wsv3e/4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-04T20:27:38.717

@Chris Wilson 的答案是正确的。

我需要的一项细微修改是让动画无限重复。@boom 没有特别要求，但我可以想象这可能是轨道动画的常见要求，这是我对 Chris 版本的修改`.animateAlong()`：

```
Raphael.el.animateAlong = function(path, duration, repetitions) {
    var element = this;
    element.path = path;
    element.pathLen = element.path.getTotalLength();    
    duration = (typeof duration === "undefined") ? 5000 : duration;
    repetitions = (typeof repetitions === "undefined") ? 1 : repetitions;

    paper.customAttributes.along = function(v) {
    var point = this.path.getPointAtLength(v * this.pathLen),
        attrs = { cx: point.x, cy: point.y };
    this.rotateWith && (attrs.transform = 'r'+point.alpha);
    return attrs;
    };    

    element.attr({along:0});
    var anim = Raphael.animation({along: 1}, duration);
    element.animate(anim.repeat(repetitions)); 
}; 
```

请注意，我已经删除了缓动和回调参数（因为我不需要它们）并添加了`repetitions`指定要执行的重复次数的参数。

一个示例调用（开始一个无限循环的轨道动画）是：

`moon.animateAlong(orbit, 2000, Infinity);`

# python - Python 套接字服务器 - 未在 Windows 上接收 Adob e AIR 客户端数据

> ID：15341170
> 
> 赞同：2
> 
> 时间：2013-03-11T14:32:29.100
> 
> 标签：python, sockets, air, platform

我已经使用以下代码在 Python 中设置了一个套接字服务器（我在 Python 中的第一个程序）：

```
class setupServer(threading.Thread):
def __init__(self, host, port):
    threading.Thread.__init__(self)
    self.host = host
    self.port = port

def now(self):
    d = datetime.datetime.now()
    return d.strftime("%d/%m/%y %H:%M:%S")

def run(self):
    server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    server.bind((self.host, self.port))
    server.setblocking(0)
    server.listen(3)
    inputs = [server]
    print("Server started!")

    while inputs:
        readable, writeable, error = select.select(inputs,[],[])
        for s in readable:
            if s is server:
                conn, addr = s.accept()
                print('contact', addr, 'on', self.now())
                conn.setblocking(0)
                inputs.append(conn)
            else:
                data = s.recv(4096)
                if data:
                    print("Received msg: ", data.decode())
                else:
                    print('close')
                    inputs.remove(s)
                    s.close() 
```

（请注意，除了打印和错误之外，我还没有完成处理接收到的数据）

客户端正在使用 AIR 套接字进行连接。在基于 Unix 的系统上，一切似乎都运行良好。我已经测试了从我的 Android 手机和 OSX 系统发送数据。

但是，在 Windows 客户端上，我可以连接，但我只在 AIR 连接到服务器后立即收到一些东西（它发送一个测试消息）。之后发送的所有内容都不会到达套接字服务器。

我也尝试使用 socket.settimeout 功能，但这给出了完全相同的问题。将AIR更改为Flash，不同的版本也没有什么区别。但考虑到一切都适用于 OSX 和 Android 的事实，我认为问题出在 Windows 上。

任何人都知道如何解决这个问题？（我在 AIR 客户端 PC 上使用 Windows 8。如果需要，我也可以发布 AIR 代码，但它非常基本，使用 writeUTFBytes() 发送消息）

# installation - Office Web 应用程序无人值守服务器安装

> ID：15341177
> 
> 赞同：2
> 
> 时间：2013-03-11T14:32:54.067
> 
> 标签：installation, sharepoint-2013, office-web-components

我们的 IT 部门需要一个脚本来处理应该安装在我们任何服务器上的所有内容。他们不想使用安装向导并单击 next-next-next（不要问我为什么）

我们需要安装[Office Web Apps Server](http://www.microsoft.com/en-us/download/details.aspx?id=35489)才能与我们的 SharePoint 2013 解决方案一起使用。是否可以在不使用向导的情况下安装它？（带脚本）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T09:10:58.447

在 Office Web Apps 服务器文件夹中，有一个名为 Files\setupsilent\ 的文件夹，您可以在其中找到 config.xml。此文件包含有关 Office Web Apps Server 静默安装的信息。

像这样调用安装程序（如果您的 Office Web Apps 服务器安装程序在 c:\OWA 中提取） setup.exe /config files\setupsilent\config.xml

这将是完整的静默设置。您不会看到任何屏幕。如果您希望看到向导和进度条自动进行（被动），您可以将此 config.xml 中的“Display Level="none" 更改为 Display Level="basic"

希望能帮助到你。

# javascript - 未捕获的 SyntaxError：意外的标识符

> ID：15341179
> 
> 赞同：-1
> 
> 时间：2013-03-11T14:32:59.640
> 
> 标签：javascript, jquery

看来我又一次陷入了困境。根据我通过搜索此问题的了解，如果`var`是`int`，则可能会发生此错误。但就我的业余 Javascript 技能而言，我没有在完全[被盗的代码](http://blog.alexmaccaw.com/svbtle-image-uploading)中检测到这样的东西。

```
var createAttachment = function(file) {
    var uid  = [guava_uid, (new Date).getTime(), 'raw'].join('-');

    var data = new FormData();

    data.append('attachment[name]', file.name);
    data.append('attachment[file]', file);
    data.append('attachment[uid]',  uid);

    $.ajax({
      url: '/attachments',
      data: data,
      cache: false,
      contentType: false,
      processData: false,
      type: 'POST',
    }).error(function(){
      console.log('could not upload');
    });

    var absText = '![' file.name + '](/attachments/' + uid + ')'; // <<< ERROR
    $('#editor textarea').insertAtCaret(absText);
}; 
```

`guava_uid`在上面的任何代码之前定义为`guava_uid = "1";`，我也尝试过`guava_uid = 1;`，但结果相同。像往常一样，感谢所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:36:46.747

```
$.ajax({
  url: '/attachments',
  data: data,
  cache: false,
  contentType: false,
  processData: false,
  type: 'POST',
//            ^
//            should not be there
}).error(function(){
  console.log('could not upload');
}); 
```

和：

```
var absText = '![' file.name
//                ^
//            missing + 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:39:06.927

尝试

```
var uid = ["guava_uid", (new Date).getTime(), 'raw'].join('-'); 
```

当我尝试使用这样的代码时：

```
var uuid = some-uid-like-int 
```

我遇到了同样的错误，但是当我像字符串一样使用 uuid 时 - 一切都好。

# iis-7 - IIS - 使用表单身份验证为 AD 身份验证创建 AD 会话

> ID：15341180
> 
> 赞同：0
> 
> 时间：2013-03-11T14:33:14.350
> 
> 标签：iis-7, active-directory

我想要做的是有一个表单身份验证登录页面，用户可以在其中登录。然后用户登录并被重定向到另一个使用 AD 身份验证的网站，而无需用户再次登录。

有人有例子吗？这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:41:00.557

因为您在同一个域中，所以其他网站应该能够读取第一个网站的 cookie，然后询问 website1 这个用户是谁，并且 website1 返回它是“ryan”，然后 website2 将用户身份验证为 ryan。

这假设 website2 信任 website1

# linux - Linux或任何操作系统中的差异黑白系统调用和用户调用

> ID：15341184
> 
> 赞同：0
> 
> 时间：2013-03-11T14:33:23.830
> 
> 标签：linux, operating-system

我正在寻找答案很多天，但他们都没有解决我的问题。黑白系统调用和用户调用有什么区别，我想计算 C 中 printf() 函数的用户 CPU 时间和内核 CPU 时间。用户 cpu 时间是 CPU 执行用户例程所花费的时间和内核 cpu 时间所花费的时间通过 cpu 执行内核例程。我的问题是在调用 printf() 时，最终调用系统调用以在显示时打印字符。我的意思是在例程 printf() 中说哪一部分属于用户，哪一部分属于内核。简单的赋值语句 a=b 是否涉及系统调用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T11:22:34.350

C 中的简单`a=b`语句不涉及系统调用；这完全在用户空间中执行。

在`printf()`中，大部分代码在用户空间中执行（例如，提供参数的格式）。只有将最终格式化文本写入标准输出才会`write`调用系统调用。您可以使用`strace`显示应用程序进行的所有系统调用的工具来查看这一点。

# java - 跟踪提交给 ThreadPoolExecutor 的任务

> ID：15341186
> 
> 赞同：5
> 
> 时间：2013-03-11T14:33:27.330
> 
> 标签：java, multithreading, executor, futuretask

我在 ThreadPoolExecutor 中运行多个任务。我将其初始化如下：

```
private VideoExportExecutor executor;
private BlockingQueue<Runnable> jobQueue;

public void initialiseVideoProcessor()
{
    jobQueue = new LinkedBlockingQueue<Runnable>();
    executor = new VideoExportExecutor(1, 1, Long.MAX_VALUE, TimeUnit.SECONDS, jobQueue);
} 
```

我自己实现了runnable( `VideoExportThread`)，它包含一个`getProgress()`跟踪提交任务进度的方法。我提交的实例如下：

```
executor.submit(new VideoExportThread(gcmPath)); 
```

我正在寻找一种查询 executor/blockingQueue 以获取当前/待处理线程的方法。我尝试使用`jobQueue.toArray()`并覆盖 executor 方法`beforeExecute(Thread t, Runnable r)`，但在这两种情况下，返回的 runnable 都是 FutureTask 类型，它不包含太多数据。有没有办法让我使用它来检索我的原始`VideoExportThread`实例以识别哪些正在运行并查询其进度？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T14:39:08.267

为什么不简单地保留一个 Runnable 列表？

```
List<Runnable> runnables = new ArrayList<> ();
VideoExportThread r = new VideoExportThread(gcmPath);
runnables.add(r);
executor.submit(r); 
```

另请注意，`executor.submit(r);`返回 a `Future`- 您可以调用其`isDone()`方法来检查提交的任务是否仍在运行。

* * *

旁注：手动管理作业队列可能有充分的理由，但如果没有，您可以使用其中一种工厂方法让您的生活更轻松。例如：`ExecutorService executor = Executors.newCachedThreadPool();`。

# javascript - 选择表格行中单击的按钮旁边的 div 文本

> ID：15341187
> 
> 赞同：0
> 
> 时间：2013-03-11T14:33:28.107
> 
> 标签：javascript, jquery

这是一个示例表。

```
<table class="table table-bordered">
<tbody>
<tr>
<tr>
    <td>Stuff<div id="ParentID" style="display:none">145689</div></td>
    <td><button class="btn btn-small">Send</button></td>
</tr>
</tbody>   
</table> 
```

我想在 id=ParentID 的 div 标记中选择最接近单击该按钮的文本。我将来会有多行，所以它必须是该行唯一的。

我现在有

```
var qry =  $(this).closest('#ParentID').text(); 
```

显然不起作用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T14:36:41.190

这是可以做到的：

```
$(".btn").on("click", function() {
    var text = $(this).closest("tr").find("div").text();
    // ...
}); 
```

**请注意**，元素应该具有唯一的 ID，因此不能有多个`<div>`ID为*"ParentID"*的元素。我希望您仅将其用作示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:37:58.810

试试这个

```
$(".btn").on("click", function() {
 $(this).parent('tr').find('div#ParentID').text();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T14:39:17.590

```
$('button').click(function(){
    var dataYouWant = $(this).parent().find('div').html();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T14:43:43.473

您可以这样做，结果如下：

```
$('.btn').click(function() {
    alert($(this).parent().prev().children('div').text());
}); 
```

在这里试试：http: [//jsfiddle.net/YLcjf/2/](http://jsfiddle.net/YLcjf/2/)

（我想你应该对所有这些解决方案进行基准测试。不确定“find”是否有一些与之相关的贪婪算法惩罚）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-11T14:53:23.903

```
$("button").click(function(){

    alert($(this).parents("tr")
          .find("div#ParentID").text());  

}); 
```

JS Fiddle 测试：http: [//jsfiddle.net/leniel/suRfG/](http://jsfiddle.net/leniel/suRfG/)

# ocr - tesseract 输出文本，但只是废话

> ID：15341194
> 
> 赞同：0
> 
> 时间：2013-03-11T14:33:44.183
> 
> 标签：ocr, tesseract

我在 Mac 上使用带有瑞典训练数据的 tesseract，[http://code.google.com/p/tesseract-ocr/downloads/detail ?name=swe.traineddata.gz](http://code.google.com/p/tesseract-ocr/downloads/detail?name=swe.traineddata.gz)

我从命令行运行以下命令： sudo tesseract -l swe my.png my.txt

![my.png 的内容](../Images/0ae5d9351018e912c00f4e8713cdcc4b.png)

这就是它在 my.txt 中输出的内容：

```
uavum-rn om: mgm.
:mm om names N............
m fw.
<>..,...,.....1,». mm. ^V.m..»...1 W u
|............................ mmm
m«.......
n....... ~.«......«y.= mm
Am...
M-Q-..y...@»~.U.M........»...........   
.;.§............. MYM... WU..
M. www
.<W..L.....w.m.,w»
mm... Hm... ^......... a.....ß..... M
M..
Hm... 3....
>«........
N
1
G
n.......
mmm
mmm »
mmm
MW:-u >«..«.......
M.».....«@>-ms... .a »mm »1
mm... nu .<....-...WMA _..
m........m mm
WW» m
mm w
.-...............u. 
|-...M-11.”.
|........m :>...1.1-1»-.N
Kwwm
M...-«
|.~.»...:-u1.«..... ,-...........
mm M
.-M».....m ...A m...m..<....ß.-.W
.mwwm .M M»-..U..........k
.....-W... .W-;-1 
```

是否有一些我错过的参数，一个我做错了？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T21:40:10.313

自从我玩这个引擎已经有一段时间了，但是你的笔记给我敲响了警钟，所以我检查了这个网站。我认为您需要将此文件[瑞典语数据用于 Tesseract 3.02](https://code.google.com/p/tesseract-ocr/downloads/detail?name=tesseract-ocr-3.02.swe.tar.gz&can=2&q=)，因为我怀疑您使用的是先前版本中的训练数据。

如果我找到了您问题的根源，请标记我的答案好吗？;)

# pdf-generation - 将邮件中的附件转换为 Lotus Notes 中的 pdf

> ID：15341198
> 
> 赞同：1
> 
> 时间：2013-03-11T14:33:54.330
> 
> 标签：pdf-generation

我想将邮件文档和附件转换为 pdf，

如果邮件正文中有任何文本以及附件，则邮件内容应在 pdf 的第一页中转换为 pdf，然后是附件（在下一页中）。

我能够将邮件正文和附件转换为单独的 pdf，但不能将它们合并，在邮件正文中作为 pdf 的第一页和附件作为其他。

请帮忙。

# android - 自定义 ActionBar 项 (ActionBarSherlock) 上的 ClickListener

> ID：15341199
> 
> 赞同：3
> 
> 时间：2013-03-11T14:33:54.920
> 
> 标签：android, android-actionbar, actionbarsherlock

我将一些自定义项目放在我的 ActionBarSherlock AB 中，如下所示`SherlockFragmentActivity`：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {

            getSupportMenuInflater().inflate(R.menu.menu_builtin, menu);

            MenuItem selectAll = menu.findItem(R.id.selectall);
            selectAll.setActionView(R.layout.selectalllayout);

            return super.onCreateOptionsMenu(menu);
} 
```

单击自定义项时既`onMenuItemSelected`不会`onOptionsItemSelected`调用也不会调用，当我使用 menu.add(String) 添加“标准项”时会调用它们。我也试过：

```
 selectAll.setOnMenuItemClickListener(new MenuItem.OnMenuItemClickListener() {

        @Override
        public boolean onMenuItemClick(MenuItem item) {
            // TODO Auto-generated method stub
            return false;
        }
    }); 
```

和

```
 selectAll.getActionView().setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub

        }
    }); 
```

他们也没有被调用。我的布局组件是可点击的，与菜单有关的一切都是从 ABS 导入的，而不是从 android 导入的。

关于这里有什么问题的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T21:04:58.653

你可以通过两种方式做到这一点

第一的：

```
 @Override
 protected void onCreate(Bundle savedInstanceState) {
 super.onCreate(savedInstanceState);

    ActionBar actionBar = getSupportActionBar();
    actionBar.setDisplayShowCustomEnabled(true);

    View view = LayoutInflater.from(this).inflate(R.layout.your_layout, null);

    actionBar.setCustomView(view);
    view.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View view) {
                    //Do your click stuff
            }
        });
    } 
```

第二：

```
 <menu xmlns:android="http://schemas.android.com/apk/res/android" >
 <item
    android:id="@+id/view_id"
    android:title="@string/name"
    android:actionLayout="@layout/your_layout"
    android:showAsAction="always" />
 </menu> 
```

在你的活动中

```
 @Override
public boolean onCreateOptionsMenu(Menu menu) {
    super.onCreateOptionsMenu(menu);
    getSupportMenuInflater().inflate(R.menu.main_menu, menu);
    View view = (View) menu.findItem(R.id.view_id).getActionView();

            // to get child view - example:
            //ImageView image  = (ImageView)view.findViewById(R.id.my_item);
            //image.setOnClickListener....

    view.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            //do stuff here
        }
    });

    return true;
} 
```

不要忘记导入这些。

```
 import com.actionbarsherlock.app.ActionBar;
  import com.actionbarsherlock.app.SherlockFragmentActivity;
  import com.actionbarsherlock.view.Menu;
  import com.actionbarsherlock.view.MenuItem; 
```

# c++ - Cuda C++ 内存包装类

> ID：15341201
> 
> 赞同：0
> 
> 时间：2013-03-11T14:34:02.780
> 
> 标签：c++, class, templates, cuda

我有一个用于 CUDA 的内存包装器，它执行简单的引用计数（ala shared_ptr）。我用 nvcc 编译 C++ 类，请参阅[要点](https://gist.github.com/xionluhnis/5134430)。

然后我想简单地在我的基本 c++ 主文件中使用它：

```
#include "CudaMemory.h"
typedef CudaDoubleMemory GPUMemory;

int main(int argc, char** argv) {

    GPUMemory d_mem(3 * 3);

    return 0;
} 
```

但是当我用 nvcc 编译它时，我得到了很多错误：

```
nvcc --shared --compiler-options -fPIC -shared src/CudaMemory.cu -o libmem.so
src/CudaMemory.cu(29): error: return value type does not match the function type
src/CudaMemory.cu(46): error: argument list for class template "CudaMemory" is missing
src/CudaMemory.cu(46): error: explicit type is missing ("int" assumed)
src/CudaMemory.cu(46): error: expected a "{"
src/CudaMemory.cu(47): warning: missing return statement at end of non-void function "CudaMemory"
src/CudaMemory.cu(49): error: argument list for class template "CudaMemory" is missing
src/CudaMemory.cu(49): error: explicit type is missing ("int" assumed)
src/CudaMemory.cu(49): error: expected a "{"
src/CudaMemory.cu(51): error: identifier "d_ptr" is undefined
src/CudaMemory.cu(51): error: identifier "scalar_type" is undefined
src/CudaMemory.cu(53): error: identifier "count" is undefined
src/CudaMemory.cu(54): error: identifier "ref_id" is undefined
src/CudaMemory.cu(56): warning: missing return statement at end of non-void function "CudaMemory"
src/CudaMemory.cu(58): error: argument list for class template "CudaMemory" is missing
src/CudaMemory.cu(58): error: argument list for class template "CudaMemory" is missing
src/CudaMemory.cu(58): error: explicit type is missing ("int" assumed)
src/CudaMemory.cu(58): error: expected a "{"
src/CudaMemory.cu(60): error: identifier "count" is undefined
src/CudaMemory.cu(62): error: identifier "ref_id" is undefined
src/CudaMemory.cu(64): warning: missing return statement at end of non-void function "CudaMemory"
src/CudaMemory.cu(66): error: argument list for class template "CudaMemory" is missing
src/CudaMemory.cu(66): error: argument list for class template "CudaMemory" is missing
src/CudaMemory.cu(66): error: identifier "this_type" is undefined
src/CudaMemory.cu(68): error: identifier "count" is undefined
src/CudaMemory.cu(69): error: identifier "ref_id" is undefined
src/CudaMemory.cu(69): error: identifier "d_ptr" is undefined
src/CudaMemory.cu(74): error: identifier "d_ptr" is undefined
src/CudaMemory.cu(75): error: identifier "ref_id" is undefined
src/CudaMemory.cu(82): error: argument list for class template "CudaMemory" is missing
src/CudaMemory.cu(84): error: identifier "count" is undefined
src/CudaMemory.cu(85): error: identifier "ref_id" is undefined
src/CudaMemory.cu(85): error: identifier "d_ptr" is undefined
src/CudaMemory.cu(89): error: argument list for class template "CudaMemory" is missing
src/CudaMemory.cu(89): error: incomplete type is not allowed
src/CudaMemory.cu(89): error: identifier "scalar_type" is undefined
src/CudaMemory.cu(89): error: identifier "host_ptr" is undefined
src/CudaMemory.cu(89): error: expected a ";"
At end of source: warning: parsing restarts here after previous syntax error
34 errors detected in the compilation of "/tmp/tmpxft_000018e6_00000000-4_CudaMemory.cpp1.ii". 
```

我在这里做错了什么？我读到与**extern "C"**有一些关系，但它是 C++ 代码，而不是 C 代码......

**编辑**：我所做的甚至有意义吗？我的印象是在我的情况下不可能有模板参数，因为 cuda 将无法完成它的工作，因为它不知道将使用什么类型。

然后我应该如何操作来做预期的事情？是将 cudaMalloc、cudaFree 和 cudaMemcpy 封装在外部函数中的唯一解决方案，这些函数我将在 .cu 中实现，其余的都在 .h 中，这样就不需要在 .cu 中进行模板化（但是我'当然会在.h中实现类）？

**解决方案？**：所以我选择了标题中包含所有内容的版本，并且不需要使用 nvcc。它编译甚至运行，但由于“重复”免费而崩溃，尽管没有调用重复的免费（调试输出仅显示一个）。见新[要点](https://gist.github.com/xionluhnis/5134430/3cbccff5401cbb73da4754d722d86b784f07dc80)。由于都在一个头文件中，因此发生了很多变化。

现在当我运行新的主程序时：

```
#include "CudaMemory.h"
typedef gpu::CudaDoubleMemory GPUMemory;
#include <iostream>
int main(int argc, char** argv) {

    // testing the self adjoint eigenvalue kernel
    // selfAdjointEigensTest();
    GPUMemory d_mem(3 * 3);

    std::cout << "Memory size: " << d_mem.size() << std::endl;
    std::cout << "Memory reference: " << d_mem.get() << std::endl;
    std::cout << "Memory reference count: " << d_mem.ref_count() << std::endl;

    return 0;
} 
```

我得到了我要求的结果，但是在程序退出时，它崩溃了（所以这里似乎存在内存问题）。至少解决了代码分离的主要问题。哦，我必须添加**-lcudart**以便 cuda_runtime.h 的东西可用。

```
Memory size: 9
Memory reference: 0x700100000
Memory reference count: 1
Freeing ref#0
*** glibc detected *** /home/alexandre/NetBeansProjects/GPU_TEST/dist/Debug/GNU-Linux-x86/gpu_test: double free or corruption (fasttop): 0x000000000104b3f0 ***
======= Backtrace: =========
/lib/x86_64-linux-gnu/libc.so.6(+0x76d76)[0x7f9bbfd99d76]
/lib/x86_64-linux-gnu/libc.so.6(cfree+0x6c)[0x7f9bbfd9eaac]
/usr/lib/x86_64-linux-gnu/libcudart.so.4(+0x23c32)[0x7f9bc086fc32]
/usr/lib/x86_64-linux-gnu/libcudart.so.4(+0x2012b)[0x7f9bc086c12b]
/usr/lib/x86_64-linux-gnu/libcudart.so.4(+0x26d6b)[0x7f9bc0872d6b]
/usr/lib/x86_64-linux-gnu/libcudart.so.4(+0x26f7b)[0x7f9bc0872f7b]
/usr/lib/x86_64-linux-gnu/libcudart.so.4(+0x19e0c)[0x7f9bc0865e0c]
/lib/x86_64-linux-gnu/libc.so.6(__cxa_finalize+0xa5)[0x7f9bbfd5a175]
/usr/lib/x86_64-linux-gnu/libcudart.so.4(+0x5b66)[0x7f9bc0851b66]
======= Memory map: ========
00400000-00408000 r-xp 00000000 08:07 24633669                           /home/alexandre/NetBeansProjects/GPU_TEST/dist/Debug/GNU-Linux-x86/gpu_test
00607000-00608000 rw-p 00007000 08:07 24633669                           /home/alexandre/NetBeansProjects/GPU_TEST/dist/Debug/GNU-Linux-x86/gpu_test
00f60000-0106b000 rw-p 00000000 00:00 0                                  [heap]
200000000-900000000 ---p 00000000 00:00 0 
7f9bb8000000-7f9bb8021000 rw-p 00000000 00:00 0 
7f9bb8021000-7f9bbc000000 ---p 00000000 00:00 0 
7f9bbd2f4000-7f9bbd2f5000 rw-p 00000000 00:00 0 
7f9bbd2f5000-7f9bbd3f5000 rw-s 369cd5000 00:05 5720                      /dev/nvidia0
7f9bbd3f5000-7f9bbd4f5000 rw-s 368e8c000 00:05 5720                      /dev/nvidia0
7f9bbd4f5000-7f9bbd5f5000 rw-s 368ac3000 00:05 5720                      /dev/nvidia0
7f9bbd5f5000-7f9bbd6f5000 rw-s 00000000 00:04 79644                      /dev/zero (deleted)
7f9bbd6f5000-7f9bbd7f5000 rw-s 38238d000 00:05 5720                      /dev/nvidia0
7f9bbd7f5000-7f9bbd8f5000 rw-s 00000000 00:04 79643                      /dev/zero (deleted)
7f9bbd8f5000-7f9bbd8f6000 rw-s efee6000 00:05 5720                       /dev/nvidia0
7f9bbd8f6000-7f9bbd8f7000 rw-s 382385000 00:05 5720                      /dev/nvidia0
7f9bbd8f7000-7f9bbdcf9000 rw-s 3e39b9000 00:05 5720                      /dev/nvidia0
7f9bbdcf9000-7f9bbe0fb000 rw-s 38eade000 00:05 5720                      /dev/nvidia0
7f9bbe0fb000-7f9bbe0fc000 ---p 00000000 00:00 0 
7f9bbe0fc000-7f9bbe8fc000 rwxp 00000000 00:00 0 
7f9bbe8fc000-7f9bbe912000 r-xp 00000000 08:07 3145792                    /lib/x86_64-linux-gnu/libz.so.1.2.7
7f9bbe912000-7f9bbeb11000 ---p 00016000 08:07 3145792                    /lib/x86_64-linux-gnu/libz.so.1.2.7
7f9bbeb11000-7f9bbeb12000 r--p 00015000 08:07 3145792                    /lib/x86_64-linux-gnu/libz.so.1.2.7
7f9bbeb12000-7f9bbeb13000 rw-p 00016000 08:07 3145792                    /lib/x86_64-linux-gnu/libz.so.1.2.7
7f9bbeb13000-7f9bbf3c0000 r-xp 00000000 08:07 13985100                   /usr/lib/x86_64-linux-gnu/libcuda.so.304.64
7f9bbf3c0000-7f9bbf5c0000 ---p 008ad000 08:07 13985100                   /usr/lib/x86_64-linux-gnu/libcuda.so.304.64
7f9bbf5c0000-7f9bbf6d2000 rw-p 008ad000 08:07 13985100                   /usr/lib/x86_64-linux-gnu/libcuda.so.304.64
7f9bbf6d2000-7f9bbf6fb000 rw-p 00000000 00:00 0 
7f9bbf6fb000-7f9bbf702000 r-xp 00000000 08:07 3145947                    /lib/x86_64-linux-gnu/librt-2.13.so
7f9bbf702000-7f9bbf901000 ---p 00007000 08:07 3145947                    /lib/x86_64-linux-gnu/librt-2.13.so
7f9bbf901000-7f9bbf902000 r--p 00006000 08:07 3145947                    /lib/x86_64-linux-gnu/librt-2.13.so
7f9bbf902000-7f9bbf903000 rw-p 00007000 08:07 3145947                    /lib/x86_64-linux-gnu/librt-2.13.so
7f9bbf903000-7f9bbf91a000 r-xp 00000000 08:07 3145939                    /lib/x86_64-linux-gnu/libpthread-2.13.so
7f9bbf91a000-7f9bbfb19000 ---p 00017000 08:07 3145939                    /lib/x86_64-linux-gnu/libpthread-2.13.so
7f9bbfb19000-7f9bbfb1a000 r--p 00016000 08:07 3145939                    /lib/x86_64-linux-gnu/libpthread-2.13.so
7f9bbfb1a000-7f9bbfb1b000 rw-p 00017000 08:07 3145939                    /lib/x86_64-linux-gnu/libpthread-2.13.so
7f9bbfb1b000-7f9bbfb1f000 rw-p 00000000 00:00 0 
7f9bbfb1f000-7f9bbfb21000 r-xp 00000000 08:07 3145944                    /lib/x86_64-linux-gnu/libdl-2.13.so
7f9bbfb21000-7f9bbfd21000 ---p 00002000 08:07 3145944                    /lib/x86_64-linux-gnu/libdl-2.13.so
7f9bbfd21000-7f9bbfd22000 r--p 00002000 08:07 3145944                    /lib/x86_64-linux-gnu/libdl-2.13.so
7f9bbfd22000-7f9bbfd23000 rw-p 00003000 08:07 3145944                    /lib/x86_64-linux-gnu/libdl-2.13.so
7f9bbfd23000-7f9bbfea3000 r-xp 00000000 08:07 3145953                    /lib/x86_64-linux-gnu/libc-2.13.so
7f9bbfea3000-7f9bc00a3000 ---p 00180000 08:07 3145953                    /lib/x86_64-linux-gnu/libc-2.13.so
7f9bc00a3000-7f9bc00a7000 r--p 00180000 08:07 3145953                    /lib/x86_64-linux-gnu/libc-2.13.so
7f9bc00a7000-7f9bc00a8000 rw-p 00184000 08:07 3145953                    /lib/x86_64-linux-gnu/libc-2.13.so
7f9bc00a8000-7f9bc00ad000 rw-p 00000000 00:00 0 
7f9bc00ad000-7f9bc00c2000 r-xp 00000000 08:07 3145790                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7f9bc00c2000-7f9bc02c2000 ---p 00015000 08:07 3145790                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7f9bc02c2000-7f9bc02c3000 rw-p 00015000 08:07 3145790                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7f9bc02c3000-7f9bc0344000 r-xp 00000000 08:07 3145949                    /lib/x86_64-linux-gnu/libm-2.13.so
7f9bc0344000-7f9bc0543000 ---p 00081000 08:07 3145949                    /lib/x86_64-linux-gnu/libm-2.13.so
7f9bc0543000-7f9bc0544000 r--p 00080000 08:07 3145949                    /lib/x86_64-linux-gnu/libm-2.13.so
7f9bc0544000-7f9bc0545000 rw-p 00081000 08:07 3145949                    /lib/x86_64-linux-gnu/libm-2.13.so
7f9bc0545000-7f9bc062d000 r-xp 00000000 08:07 13986699                   /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.17
7f9bc062d000-7f9bc082d000 ---p 000e8000 08:07 13986699                   /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.17
7f9bc082d000-7f9bc0835000 r--p 000e8000 08:07 13986699                   /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.17
7f9bc0835000-7f9bc0837000 rw-p 000f0000 08:07 13986699                   /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.17
7f9bc0837000-7f9bc084c000 rw-p 00000000 00:00 0 
7f9bc084c000-7f9bc08a7000 r-xp 00000000 08:07 13985818                   /usr/lib/x86_64-linux-gnu/libcudart.so.4.2.9
7f9bc08a7000-7f9bc0aa7000 ---p 0005b000 08:07 13985818                   /usr/lib/x86_64-linux-gnu/libcudart.so.4.2.9
7f9bc0aa7000-7f9bc0aa8000 r--p 0005b000 08:07 13985818                   /usr/lib/x86_64-linux-gnu/libcudart.so.4.2.9
7f9bc0aa8000-7f9bc0aa9000 rw-p 0005c000 08:07 13985818                   /usr/lib/x86_64-linux-gnu/libcudart.so.4.2.9
7f9bc0aa9000-7f9bc0aaa000 rw-p 00000000 00:00 0 
7f9bc0aaa000-7f9bc0ac3000 r-xp 00000000 08:07 24627226                   /home/alexandre/NetBeansProjects/GPU_LIB/libgpu.so
7f9bc0ac3000-7f9bc0cc3000 ---p 00019000 08:07 24627226                   /home/alexandre/NetBeansProjects/GPU_LIB/libgpu.so
7f9bc0cc3000-7f9bc0cc4000 rw-p 00019000 08:07 24627226                   /home/alexandre/NetBeansProjects/GPU_LIB/libgpu.so
7f9bc0cc4000-7f9bc0ce4000 r-xp 00000000 08:07 3145957                    /lib/x86_64-linux-gnu/ld-2.13.so
7f9bc0d9c000-7f9bc0dbd000 rw-p 00000000 00:00 0 
7f9bc0dbd000-7f9bc0ebd000 rw-s 00000000 00:04 79639                      /dev/zero (deleted)
7f9bc0ebd000-7f9bc0ec4000 rw-p 00000000 00:00 0 
7f9bc0ede000-7f9bc0edf000 rw-s efee5000 00:05 5720                       /dev/nvidia0
7f9bc0edf000-7f9bc0ee0000 rw-s 38eba1000 00:05 5720                      /dev/nvidia0
7f9bc0ee0000-7f9bc0ee1000 r--s f2009000 00:05 5720                       /dev/nvidia0
7f9bc0ee1000-7f9bc0ee3000 rw-p 00000000 00:00 0 
7f9bc0ee3000-7f9bc0ee4000 r--p 0001f000 08:07 3145957                    /lib/x86_64-linux-gnu/ld-2.13.so
7f9bc0ee4000-7f9bc0ee5000 rw-p 00020000 08:07 3145957                    /lib/x86_64-linux-gnu/ld-2.13.so
7f9bc0ee5000-7f9bc0ee6000 rw-p 00000000 00:00 0 
7fff2b5ec000-7fff2b60c000 rwxp 00000000 00:00 0                          [stack]
7fff2b60c000-7fff2b60d000 rw-p 00000000 00:00 0 
7fff2b78c000-7fff2b78d000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]

RUN FINISHED; Aborted; real time: 50ms; user: 0ms; system: 0ms 
```

**最后一个可行的解决方案**：以前的要点中有两个错误。新的[要点](https://gist.github.com/xionluhnis/5134430/d2a86f1d94cab9a70fce8a9bdda9ddff34738aec)修复了它们。主要是：

1.  gpu::internal 中的数据必须是静态的（一个不是，我不知道为什么，我猜是错字......）。
2.  在 newReference 中，当使用旧的已释放条目时，引用计数应初始化为 1（与没有可用的已释放条目时的工作方式相同）

至此，现在已经完全解决了。我还添加了 countReferences 以检查最后是否没有泄漏（到目前为止，对于我的测试，没有泄漏）。

**结论**：当没有设备代码时，我们通常可以在没有 nvcc 的情况下编译，我们只需要包含**cuda_runtime.h**来调用 cudaXXX 函数。感谢@罗伯特·克罗维拉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T23:00:54.643

我的工作解决方案：

1.  删除所有非 nvcc 错误，确保它在没有 cuda 特定代码的情况下工作
2.  将所有非 nvcc 代码提取到 .h 标头中
3.  删除特定于 nvcc 的代码，改用**cuda_runtime.h**（并与**-lcudart**链接）

nvcc 可以使用模板，我并不是说不是这样，但我认为不可能有一个类定义是模板，并且它的实现只能完成一次，因为模板是要被实例化的，并且编译器为每个新的实例创建代码，因此使用 nvcc 模板代码编译然后使用 g++ 实例化它是没有意义的。

[它有效](https://gist.github.com/xionluhnis/5134430/d2a86f1d94cab9a70fce8a9bdda9ddff34738aec)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:49:40.057

我解决了 2 个第一个编译错误：
1\. freeIndexes.pop_back() 返回 void 而不是 int...
2\. 你应该`#include <iostream>`

# php - 将输出从 C++ 传递到 PHP

> ID：15341204
> 
> 赞同：3
> 
> 时间：2013-03-11T14:34:12.300
> 
> 标签：php, c++, integration, output

我正在创建一个 PHP 文件以将值传递给 c++ .exe，然后它将计算输出并返回该输出。但是，我似乎无法将 .exe 的输出返回到 PHP 文件中。

PHP代码：

```
$path = 'C:enter code here\Users\sumit.exe';
$handle = popen($path,'w');
$write = fwrite($handle,"37");
pclose($handle); 
```

C++ 代码：

```
#include "stdafx.h"
#include <iostream>
using namespace std;

// Declaation of Input Variables:
int main()
{
int num;
cin>> num;

std::cout<<num+5;
return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T14:53:34.690

我既不建议`system`也不[建议](http://www.php.net/manual/en/function.proc-open.php)命令：`popen`php.net`proc_open`

像这样称呼它

```
$descriptorspec = array(
   0 => array("pipe", "r"),  // stdin is a pipe that the child will read from
   1 => array("pipe", "w"),  // stdout is a pipe that the child will write to
   2 => array("pipe", "w")   // stderr, also a pipe the child will write to
);
proc_open('C:enter code here\Users\sumit.exe', $descriptorspec, $pipes); 
```

之后，您将`$pipes`填充句柄以将数据发送到程序 ( `[0]`) 并从程序 ( ) 接收数据`[1]`。您还`[2]`可以使用它从程序中获取 stderr（或者如果您不使用 stderr，则直接关闭）。

不要忘记使用 关闭进程句柄`proc_close()`和使用`fclose()`. `$pipes[0]`请注意，在您关闭句柄或写入一些空白字符之前，您的程序不会知道输出是否完整。我建议关闭管道。

`system()`在or中使用命令行参数`popen()`是有效的，但如果您打算发送大量数据和/或原始数据，您将遇到命令行长度限制和转义特殊字符的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T14:47:26.490

在您的 C++ 代码中，我没有看到任何用于传递您需要的变量

```
 int main(int argc, char* argv[]) 
```

代替

```
 int main() 
```

请记住 argc 是变量的计数，它包括文件的路径，因此您的参数从 1 开始，每个 argv 都是该参数的 c 字符串。如果您需要小数 atof 是您的朋友或 atoi 为整数。

然后你正在使用popen。 [PHP 文档](http://php.net/manual/en/function.popen.php)说它只能用于读取或写入。它不是双向的。您想使用[proc_open](http://www.php.net/manual/en/function.proc-open.php)来获得双向支持。

无论如何，这就是我编写 C++ 代码的方式：

```
#include "stdafx.h"
#include <iostream>

// Declaation of Input Variables:
int main(int arc, char* argv[])
{
   int num;
   num = atoi(argv[1]);

   std::cout<<num+5;
   return 0;
 } 
```

**注意：**我删除`using namespace std`是因为我注意到您仍在尝试在主函数（即`std::cout`）中使用名称空间，最好将其保留在全局名称空间之外。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T14:36:48.083

您正在写入 exe 文件，您应该传递您的参数，例如

```
system("C:enter code here\Users\sumit.exe 37"); 
```

# wso2 - WSO2 社区体验

> ID：15341205
> 
> 赞同：14
> 
> 时间：2013-03-11T14:34:18.687
> 
> 标签：wso2, soa

在我目前的角色中，我被要求评估许多不同的 SOA 治理堆栈。特别是其中一个堆栈 WSO2 引起了我的注意，因为它似乎是企业级的，并且具有开源的感觉。在 WSO2 网站上，stackoverflow 被列为唯一的社区支持选项。大多数其他拥有活跃用户和开发者社区的开源项目也有线程讨论组和 IRC。但是，因为该站点被列为唯一的社区支持选项，所以这是我查看的唯一一个。

为了确定社区是否响应，我问了一个相当温和的问题。虽然这个问题已经获得了赞成票并且也被查看了很多次，但它没有收到任何回复。然后，在查看了上个月提交给带有 WSO2 标签的 stackoverflow 的问题后，我注意到绝大多数都没有得到回答。

因为我使用社区响应性作为确定在我的公司中使用的最佳 SOA 治理堆栈的一个因素，并且因为 Stackoverflow 是为 WSO2 堆栈列出的唯一社区支持选项，所以我觉得在这里询问 WSO2 社区是合适的反应能力。

问题是：其他人最近是否能够回答有关 WSO2 集成的问题（特别是围绕他们的 Governance Registry 产品）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-03T20:54:08.200

我曾在一家大公司的支持下体验过其他开源产品，根据我的经验，WSO2 社区的支持还没有其他人那么强大。

很遗憾，因为提供的产品确实有效且功能强大（我正在使用它），但确实很复杂。

作为在没有支持的情况下拥有企业级解决方案的整体体验，您需要在构成 WSO2 框架的所有组件中采购真正优秀的技术人员，并准备好花时间在它上面（不要期望使用 eBay 解决方案与开箱即用的下载，我认为有很多只有懂工具的人才能做的微调和宝贵的配置优化）。

正如在上一篇文章中所说，您在这里用金钱换取时间，就像在许多开源项目中一样（在这种情况下可能更多，但我们正在谈论 SOA 平台，因此您可以预料到一些复杂性）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-19T04:38:22.413

社区是一个混合体，我来自 WSO2，所以我不能直接回答你的问题。WSO2 以外的用户需要真正了解这一点。

但是，除了 StackOverfalow 之外，我还可以指出更多的社区渠道。

1.  文档：[http ://docs.wso2.org/wiki/dashboard.action](http://docs.wso2.org/wiki/dashboard.action)
2.  吉拉：[https ://wso2.org/jira/secure/Dashboard.jspa](https://wso2.org/jira/secure/Dashboard.jspa)

您可以查看文档 [1]、报告针对文档的问题、Jira [2] 中的示例。如果没有一个符合预期，则需要使用 StackOverflow 等公共渠道。这些是关于用户社区的。

在开源中，除了用户社区之外，还有开发者社区方面。为此，我们有邮件列表： 架构：[http](http://wso2.markmail.org/search/?q=#query:%20list%3Aorg.wso2.architecture+page:1+state:facets) ://wso2.markmail.org/search/?q=#query:%20list%3Aorg.wso2.architecture+page:1+state:facets 开发：[http://wso2 .markmail.org/search/?q=#query:%20list%3Aorg.wso2.dev+page:1+state:facets](http://wso2.markmail.org/search/?q=#query:%20list%3Aorg.wso2.dev+page:1+state:facets) 使用这些渠道，您可以关注开源开发的进展和进展。

从本质上讲，开源社区不仅仅是用户获得帮助的部分，也是开发者公开合作的部分。所以用户社区只是故事的一半。

此外，“除非您同时为那些花时间省钱的人和那些花钱节省时间的人服务，否则免费和开源软件业务将无法运作” [http://timreview.ca/article/385](http://timreview.ca/article/385)。所以，是的，如果时间允许，社区支持将会到来。[从http://wso2.markmail.org/search/?q=#query:%20list%3Aorg.wso2.carbon-commits+page:1+state:facets](http://wso2.markmail.org/search/?q=#query:%20list%3Aorg.wso2.carbon-commits+page:1+state:facets)可以看出，开发者社区现在很忙。

# jquery - jQuery ajax - 试图捕捉错误 -G 未定义

> ID：15341209
> 
> 赞同：-1
> 
> 时间：2013-03-11T14:34:22.643
> 
> 标签：jquery, json

所以我的服务器端脚本在错误时返回以下 json 键/值对：

```
{"error":"true"} 
```

我通过萤火虫看到了这一点。在我的脚本中，我有

```
$.ajax({
  dataType: "json",
  data:{
    foo: $('#foo').val()
  },
  url: "index.pl",
  async: false,
  cache: false,
  success: function( data ){
    //this part all works fine
  },
  error: function( data ){
    alert('Error returned from server');
  }
}); 
```

我收到一个错误：

```
G is undefined 
```

紧随其后的是 jquery.min 的打包字符串。

如果重要的话，我在 jquery 1.3.2.min.js 上。

我做错了什么，我该如何解决？谢谢。

修正错字

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:45:42.743

我认为您的错误在于您的 JSON 响应。你得到一个字符串 ( `"true"`)。你确定你不需要布尔值吗？如果是这样，您的 JSON 应该是：

```
{"error":true} 
```

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T16:32:22.870

所以我的错误是对 jQuery ajax 的误解，特别是错误。这与连接不良、超时 500 错误有关，而不是像这样通过 json 返回内容。

# r - 替换 R 中的 NA - 适用于练习数据集，但在应用于实际数据时会发出警告消息

> ID：15341211
> 
> 赞同：11
> 
> 时间：2013-03-11T14:34:28.510
> 
> 标签：r, dataframe, reshape, na

我在**R**中有一个数据集，看起来像，并且已经以与以下示例相同的方式重新调整。目的是将 NA 值转换为其他值（例如“FALSE”或“0”），然后可用于创建新列

```
ortho.test<-data.frame(rep("a",10));colnames(ortho.test)=("ODB6")
ortho.test$FBGN=c("FBgn0132258","FBgn0131535","FBgn0138769","FBgn01561235","FBgn0316645","FBgn874916","FBgn5758641","FBgn5279946","FBgn67543154","FBgn2451645")
ortho.test$Species=c("DROME","DROSI","DROSE","DROAN","DROYA","DROPS","DROPE","DROVI","DROGR","DROWI")

ortho<-reshape(ortho.test,direction="wide",idvar="ODB6",timevar="Species")
ortho$FBGN.DROME<-NA
is.na(ortho) 
```

它返回一个向量，告诉我除了 FBGN.DROME 之外的所有内容都是 FALSE 使用以下 str() 输出：

```
> str(ortho)
'data.frame':   1 obs. of  11 variables:
 $ ODB6      : Factor w/ 1 level "a": 1
 $ FBGN.DROME: logi NA
 $ FBGN.DROSI: chr "FBgn0131535"
 $ FBGN.DROSE: chr "FBgn0138769"
 $ FBGN.DROAN: chr "FBgn01561235"
 $ FBGN.DROYA: chr "FBgn0316645"
 $ FBGN.DROPS: chr "FBgn874916"
 $ FBGN.DROPE: chr "FBgn5758641"
 $ FBGN.DROVI: chr "FBgn5279946"
 $ FBGN.DROGR: chr "FBgn67543154"
 $ FBGN.DROWI: chr "FBgn2451645"
 - attr(*, "reshapeWide")=List of 5
  ..$ v.names: NULL
  ..$ timevar: chr "Species"
  ..$ idvar  : chr "ODB6"
  ..$ times  : chr  "DROME" "DROSI" "DROSE" "DROAN" ...
  ..$ varying: chr [1, 1:10] "FBGN.DROME" "FBGN.DROSI" "FBGN.DROSE" "FBGN.DROAN" ... 
```

我将我的 NA 更改为 0

```
ortho[is.na(ortho)]<-0
is.na(ortho) 
```

它返回一个向量，告诉我现在所有都是 FALSE - 成功，因为现在我可以使用 ifelse() 创建一个列，以显示在任何列中哪些行没有 0 或 FALSE（或我用来替换 NA 的任何文本标签） ...

**但是，当我将其应用于完整的数据帧时，NA 不会转换，并且我收到以下警告**

```
> ortho[is.na(ortho)]<-0
There were 12 warnings (use warnings() to see them)
> warnings()
Warning messages:
1: In `[<-.factor`(`*tmp*`, thisvar, value = structure(c(62938L,  ... :
  invalid factor level, NAs generated
2: In `[<-.factor`(`*tmp*`, thisvar, value = structure(c(67667L,  ... :
  invalid factor level, NAs generated
3: In `[<-.factor`(`*tmp*`, thisvar, value = structure(c(122384L,  ... :
  invalid factor level, NAs generated
4: In `[<-.factor`(`*tmp*`, thisvar, value = structure(c(136498L,  ... :
  invalid factor level, NAs generated
5: In `[<-.factor`(`*tmp*`, thisvar, value = structure(c(84764L,  ... :
  invalid factor level, NAs generated
6: In `[<-.factor`(`*tmp*`, thisvar, value = structure(c(162734L,  ... :
  invalid factor level, NAs generated
7: In `[<-.factor`(`*tmp*`, thisvar, value = structure(c(33586L,  ... :
  invalid factor level, NAs generated
8: In `[<-.factor`(`*tmp*`, thisvar, value = structure(c(38959L,  ... :
  invalid factor level, NAs generated
9: In `[<-.factor`(`*tmp*`, thisvar, value = structure(c(149363L,  ... :
  invalid factor level, NAs generated
10: In `[<-.factor`(`*tmp*`, thisvar, value = structure(c(846L,  ... :
  invalid factor level, NAs generated
11: In `[<-.factor`(`*tmp*`, thisvar, value = structure(c(98228L,  ... :
  invalid factor level, NAs generated
12: In `[<-.factor`(`*tmp*`, thisvar, value = structure(c(110267L,  ... :
  invalid factor level, NAs generated 
```

这是 str() 输出

```
 > str(ortho)
    'data.frame':   17217 obs. of  13 variables:
     $ ODB6      : Factor w/ 17217 levels "EOG60023J","EOG60023K",..: 1 2 3 4 5 6 7 8 9 10 ...
     $ FBGN.DROGR: Factor w/ 164289 levels "FBgn0000008",..: 62938 54687 54705 56261 52591 58895 52161 52477 59180 53404 ...
     $ FBGN.DROMO: Factor w/ 164289 levels "FBgn0000008",..: 67667 65117 65951 66506 68291 71722 73134 68667 72523 76080 ...
     $ FBGN.DROVI: Factor w/ 164289 levels "FBgn0000008",..: 122384 121133 120018 121674 NA 125620 123754 123969 127130 130755 ...
     $ FBGN.DROWI: Factor w/ 164289 levels "FBgn0000008",..: 136498 136809 139642 137108 NA 141689 136363 137237 135869 132801 ...
     $ FBGN.DROPE: Factor w/ 164289 levels "FBgn0000008",..: 84764 78121 81229 80829 85509 82276 79001 80267 77133 87679 ...
     $ FBGN.DROPS: Factor w/ 164289 levels "FBgn0000008",..: 162734 158625 162203 158653 158028 22427 158179 13830 19898 160874 ...
     $ FBGN.DROAN: Factor w/ 164289 levels "FBgn0000008",..: 33586 35261 35694 23649 33601 25796 33808 33861 25917 29992 ...
     $ FBGN.DROER: Factor w/ 164289 levels "FBgn0000008",..: 38959 41203 40738 39865 38807 46087 38821 44982 47952 38091 ...
     $ FBGN.DROYA: Factor w/ 164289 levels "FBgn0000008",..: 149363 153417 153106 152243 149654 147146 149664 149482 147635 144838 ...
     $ FBGN.DROME: Factor w/ 164289 levels "FBgn0000008",..: 846 7219 6958 162946 525 1892 125 3510 163839 10111 ...
     $ FBGN.DROSE: Factor w/ 164289 levels "FBgn0000008",..: 98228 94438 94153 102953 98068 95380 98082 92553 93497 95950 ...
     $ FBGN.DROSI: Factor w/ 164289 levels "FBgn0000008",..: 110267 108223 107983 107246 110164 117494 116973 110504 106459 NA ...
     - attr(*, "reshapeWide")=List of 5
      ..$ v.names: NULL
      ..$ timevar: chr "Species"
      ..$ idvar  : chr "ODB6"
      ..$ times  : Factor w/ 12 levels "DROAN","DROER",..: 3 5 10 11 6 7 1 2 12 4 ...
      ..$ varying: chr [1, 1:12] "FBGN.DROGR" "FBGN.DROMO" "FBGN.DROVI" "FBGN.DROWI" ...
    > 
```

你能帮我让主数据框像测试一样玩吗？（PS - 我知道我会得到“这是重复的，请阅读帮助页面并正确搜索”响应 - 但我已经搜索过，这就是我发现如何替换 NA 的方法，但我没有找到任何有同样的问题。）

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-11T14:36:21.623

你有一个因素问题。如果你查看你的真实数据集，你会注意到

```
Factor w/ 164289 levels ..... 
```

例如，

```
R> x = factor(c("A", "B"))
R> x[x=="A"] = 0
Warning message:
In `[<-.factor`(`*tmp*`, x == "A", value = 0) :
  invalid factor level, NAs generated 
```

您需要添加`0`为关卡。所以像：

```
x = factor(x, levels=c(levels(x), 0))
x[is.na(x)] = 0 
```

应该做的伎俩。但是，更好的策略是改变您读取数据的方式。例如，

```
read.table(filename, stringsAsFactors=FALSE) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-16T11:40:25.837

对于那些数据不是来自读取文件的人。可以使用此循环转换每一列`data.frame`（应用不起作用，因为它将 data.frame 转换为矩阵）：

```
for (k in 1:ncol(data)){
   data[[k]] <- as.character(data[[k]])
} 
```

如果水平解决方案不起作用，则应用此[问题的解决方案。](https://stackoverflow.com/questions/2767219/r-how-to-replace-elements-of-a-data-frame)

# java - 哪个是在jsp中创建动态布局管理的更好方法

> ID：15341213
> 
> 赞同：0
> 
> 时间：2013-03-11T14:34:36.093
> 
> 标签：java, jsp, model-view-controller, servlets, tiles

在这里，我开始设计一个明智的门户`home,login,register`......大约 10 个常见`jsp`页面。

为每个门户创建这么多 jsp 页面非常困难，这是一种最优雅的方式。因此决定将 jsp 拆分为`header,body,foote`r 并使用通用页眉和页脚。每次正文都在变化。

```
<jsp:include /header.jsp>...body<jsp:include /footer.jsp> 
```

类似上面的东西。但现在出现的问题是所有门户的页眉页脚设计并不相同。

所以决定让每个块动态哪些设置将来自数据库，如菜单列表、块的位置等......

这是最好的方法。我开始知道很少有像[Tiles这样的框架](http://tiles.apache.org/)

, [Wicket](http://wicket.apache.org/learn/examples/helloworld.html) , [Sitemash](http://www.sitemesh.org)等...

并且还提到[了更好的替代 Apache Tiles](https://stackoverflow.com/questions/9748481/better-alternative-to-apache-tiles.Finally)的困惑来决定。

任何熟悉这些的人都可以`frameworks`以正确的方式指导我吗？或建议我缺少的任何新方式。

使用java（servlets），Msql作为DB。我没有使用`Struts`（同意不知道:)）。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T08:58:07.143

IMO Tiles 因为其稳定而庞大的用户群，以及良好的文档。它提供了多个 Jsp 的良好编译到视图中

**例子**

```
<definition name="myapp.homepage" template="/layouts/classic.jsp">
  <put-attribute name="title" value="Tiles tutorial homepage" />
  <put-attribute name="header" value="/tiles/banner.jsp" />
  <put-attribute name="menu" value="/tiles/common_menu.jsp" />
  <put-attribute name="body" value="/tiles/home_body.jsp" />
  <put-attribute name="footer" value="/tiles/credits.jsp" />
</definition> 
```

同样明智的是，您可以根据从 servlet 返回的定义名称定义任意多个，tile 将为您构建完整的 JSP。不是那么整洁。

它们可以与许多流行的 MVC 框架集成，例如

```
- Spring MVC
- Struts 2.0 
```

清单还在继续。

# asp.net - 有没有更好的方法在 ASP.NET MVC3 razor CSHTML 文件中获取 PDF 视图或转换

> ID：15341219
> 
> 赞同：1
> 
> 时间：2013-03-11T14:34:48.530
> 
> 标签：asp.net, html, css, asp.net-mvc-3

我已经将 ItextSharp dll 用于 html 到 pdf，但它没有给我页面中使用的外部 css 文件的样式。

请帮助并提出更好的解决方案。

再会！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T16:03:31.873

查看我曾经使用过的这个开源项目：[https](https://github.com/gmanny/Pechkin) ://github.com/gmanny/Pechkin 它利用`wkhtmltopdf`并提供了一个`dll`无需安装任何东西。

# dozer - 将数据结构 String[ ] [ ] 映射到模型类的技巧

> ID：15341226
> 
> 赞同：0
> 
> 时间：2013-03-11T14:35:17.000
> 
> 标签：dozer

我需要你的帮助和技巧来用推土机映射数据。

存在以下情况：

*   从服务层获取 String [ ] [ ]。
    *   第一个 [ ] 代表行
    *   第二个[]代表列

仅供参考：此数据取决于请求参数“表”。

```
// exemplary service call
String[] [] result = service.getData (String table);
String[] [] result = service.getData (Enum table); 
```

根据参数表，必须使用另一个目标实体。

例子 ：

*   参数“table_a”的字符串[][] 应使用目标对象“com.foo.TableA”
*   参数“table_b”的字符串[][] 应使用目标对象“com.bar.TableB”

服务层无法更改。该层始终返回此数据结构作为结果。

我的问题是我对这种情况没有好的起点。

我必须遍历第一个 [] 然后依赖于参数表，必须进行映射。

```
// useful way?
List<com.foo.TableA> mappedResult = new ArrayList<com.foo.TableA>();
for (int i = 0; i < result.size ; i++) {
    String[] rowData = result[i];
    mappedResult.add(mapper.map(rowData; com.foo.TableA.class));
}

// mapping.xml
<mappings>
  <mapping>
      <class-a>how to configure String[] ?  </class-a>
      <class-b> com.foo.TableA </class-b>

      <field>
          <a>src[0] </a>  // 1st column
          <b>column_id</b>
      </field>
  <mapping>
</mappings> 
```

欢迎任何提示！

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T10:44:41.343

为了从字符串数组访问数据，我使用了一个包装器

```
public class RowDataWrapper {

    private final row[];
    public RowDataWrapper (String[] row) {
        this.row=row;
    }

} 
```

及其在 mapping.xml 中的用法

```
<mappings>
  <mapping>
      <class-a>foo.bar.RowDataWrapper</class-a>
      <class-b>com.foo.TableA</class-b>

      <field>
          <a>row[0] </a>  // 1st column
          <b>column_id</b>
      </field>
  <mapping>
</mappings> 
```

# asp.net - ASP.Net 中用于导出 excel 文件的“另存为”对话框？（服务帐号）

> ID：15341230
> 
> 赞同：0
> 
> 时间：2013-03-11T14:35:28.563
> 
> 标签：asp.net, vb.net, excel, excel-interop

我有一个代码用于将导出的文件保存到我的 PC/Destination 但是由于 ASP.NET (4.0) 将显示在运行服务帐户的服务器中，我想让用户在单击 button1 后提示“另存为”对话框，以便他们可以将其保存在各自的文件夹中（**在用户的 PC 中，而不是服务器**中）。（我不能使用环境，因为它会获取服务帐户地址，因为这在服务器中是不可能的。）

注意：要获取用户名，我使用的是 request.servervariables("Logon_User") 并确实在此处查找了一些帖子。-[使用保存对话框将数据表导出到 Excel 文件](https://stackoverflow.com/questions/12430551/exporting-datatable-to-excel-file-with-save-dialog) -使用保存对话框[将 DataGridView 导出到 Excel？](https://stackoverflow.com/questions/14402233/export-datagridview-to-excel-with-save-dialog) - [VBA 宏中另存为位置的对话框](https://stackoverflow.com/questions/6948344/dialog-box-for-save-as-location-in-vba-macro)

```
Dim cnn As SqlConnection
    Dim connectionString As String
    Dim sql As String
    Dim i, j As Integer

    Dim xlApp As Excel.Application
    Dim xlWorkBook As Excel.Workbook
    Dim xlWorkSheet As Excel.Worksheet
    Dim misValue As Object = System.Reflection.Missing.Value

    xlApp = New Excel.Application
    xlWorkBook = xlApp.Workbooks.Add(misValue)
    xlWorkSheet = xlWorkBook.Sheets("sheet1")

    connectionString = "Data Source=xxxx"
    cnn = New SqlConnection(connectionString)
    cnn.Open()
    sql = "SELECT * FROM ControlCharts"
    Dim dscmd As New SqlDataAdapter(sql, cnn)
    Dim ds As New DataSet
    dscmd.Fill(ds)

    For i = 0 To ds.Tables(0).Rows.Count - 1
        For j = 0 To ds.Tables(0).Columns.Count - 1
            xlWorkSheet.Cells(i + 1, j + 1) = _
            ds.Tables(0).Rows(i).Item(j)
        Next
    Next

    'here instead of saving it to the C drive, let the user choose.
    xlWorkSheet.SaveAs("C:\\ControlCharts.xlsx")
    xlWorkBook.Close()
    xlApp.Quit()
    releaseObject(xlApp)
    releaseObject(xlWorkBook)
    releaseObject(xlWorkSheet)
    cnn.Close()
    CheckBox1.Checked = False 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:37:25.200

您不能让用户与服务器上的 UI 和文件系统进行交互。

相反，您可以将文件保存到服务器上的临时路径，然后通过 HTTP 将其作为文件下载。

# android - POST数据到远程数据库的Android问题

> ID：15341240
> 
> 赞同：0
> 
> 时间：2013-03-11T14:36:15.093
> 
> 标签：android, database, post

我正在尝试使用 PHP 文件将数据从 Android 应用程序发送到远程数据库。我遇到的问题是应用程序没有崩溃并且没有发送数据：我知道我可以看到来自 PHP 文件的 JSON 响应的结果，但我不使用它，因为我不知道如何处理 JSON。

这是 php 代码和相关的活动：

```
<?php

        $Nome;
        $Tavolo;

        //Apro la connessione con il server mySQL

        $Conn = mysql_connect("localhost", "root", "");
        if(!$Conn)
        {
            die('Errore di connessione: ' .mysql_error());

        }

            //Seleziono il mio database
            $DBS = mysql_select_db('ordinazioni', $Conn);
            if(!$DBS)
            {
                die('Accesso al database non riuscito: ' .mysql_error());
            }

            //echo "Mi sono connesso!";

            $Nome = $_POST['Nome'];
            $Tavolo = $_POST['Tavolo'];

            $strSQL = mysql_query("INSERT INTO Comande (Nome, Tavolo) VALUES ('$Nome', '$Tavolo')");

?> 
```

安卓代码；

```
public class AggiungiProdotto extends Activity 

{

TextView tv1;
    private static String indirizzo ="http://10.0.2.2/tesina/Aggiungi_Ordinazione";
    private String Nome = "test";

@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.aggiungi_prodotto);

    Invio();

}

public void Invio() 
{
    int NumTavolo = 2;
    final String Tavolo = Integer.toString(NumTavolo);

    Thread thread = new Thread()
    {
        @Override
        public void run() 
        {

            //Intent intent = getIntent();

            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost(indirizzo);

            try 
            {

                List<NameValuePair> Comanda = new ArrayList<NameValuePair>(2);
                Comanda.add(new BasicNameValuePair("Nome", Nome));
                Comanda.add(new BasicNameValuePair("Tavolo", Tavolo));
                httppost.setEntity(new UrlEncodedFormEntity(Comanda));

                ResponseHandler<String> responseHandler = new BasicResponseHandler();
                final String Risposta = httpclient.execute(httppost, responseHandler);
                tv1 = (TextView) findViewById(R.id.tv1);
                tv1.setText("Response : " + Risposta);

            } 
            catch (ClientProtocolException e) 
            {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } 
            catch (IOException e) 
            {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        }

    };

    thread.start();
}

} 
```

你能帮我解决这个问题吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:42:44.917

您没有在请求中添加您的数据。

做

```
httppost.setEntity(new UrlEncodedFormEntity(Comanda)); 
```

前

```
httpclient.execute(httppost); 
```

# ruby-on-rails - Highstocks 将 n 个系列添加到 rails 中的图表

> ID：15341245
> 
> 赞同：0
> 
> 时间：2013-03-11T14:36:27.027
> 
> 标签：ruby-on-rails, ruby-on-rails-3, highcharts

我有一个名为“hack”的模型，它可以有许多“序列”。每个“系列”可以有许多“观察”。“观察”是图表数据（例如日期和值所在的位置）。我希望能够创建一个单一的黑客图表，该图表可以具有可变数量的连续剧，每个连续剧都包含“观察”中图表的值。

我的 hack 控制器的“显示”操作如下所示：

```
def show
  @hack = Hack.find(params[:id])
  @obj = {}
  @hack.serials.each do |s|
    @obj[:name] = s.series_name
    data = s.observations.order("id asc").map{|x| [x.hs_date, x.value]}.to_s.gsub('"', '')
    @obj[:data] = data
  end
end 
```

show.html.erb 文件如下所示：

```
<div id="container" style="height: 500px; min-width: 500px"></div>

<script>
$(function() {
  // Create the chart
  window.chart = new Highcharts.StockChart({
    chart : {
      renderTo : 'container'
    },
    series : 
      <%= raw @obj.to_json %>
    });
});
</script> 
```

运行此代码时，图表显示“无效日期”。我知道数据是正确的，因为 Highstocks 在我使用单个数据系列时会正确生成图表。在这种情况下，hack 控制器的显示动作是：

```
def show
  @hack = Hack.find(params[:id])
end 
```

使用 show.html.erb 文件为：

```
<div id="container" style="height: 500px; min-width: 500px"></div>

<script>
$(function() {
  // Create the chart
  window.chart = new Highcharts.StockChart({
    chart : {
      renderTo : 'container'
    },
    series : [{
      name: 'first',
      data: <%= raw @serial.observations.order("id asc").map{|x| [x.hs_date, x.value]}.to_s.gsub('"', '') %>
            }]
   });
 });
 </script> 
```

我的问题是如何将 n 个连续剧（n = 特定黑客中的连续剧数）添加到 Rails 的 Highstocks 图表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:04:18.107

好的，所以如果我理解正确，您希望每个序列在一个图表中显示为自己的线。我不知道 Ruby on Rails，所以我要在这里“评论”代码。

基本概念是每个系列都应该是系列列表中自己的系列{}。

```
def show
  @hack = Hack.find(params[:id])
  @objs = []
  @hack.serials.each do |s|
    @obj = {}
    @obj[:name] = s.series_name
    data = s.observations.order("id asc").map{|x| [x.hs_date, x.value]}.to_s.gsub('"', '')
    @obj[:data] = data
    @objs APPEND THE NEW @obj
  end
end 
```

然后在新数组`to_json`的内部使用：`eval``@objs`

```
var d = eval('<%= raw @objs.to_json %>'); 
```

完成后，您必须查看字符串数组以将它们转换为 javascript 数组，然后您可以将“d”作为系列的值传递。

```
for (var i=0;i<d.length;i++){
   d[i]['data'] = eval(d[i]['data']);   
} 
```

这是一个展示这个概念的[JSFiddle 。](http://jsfiddle.net/mkremer90/mNxxF/5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:49:49.357

使用`to_json`所以它更具可读性

```
series: <%= @serials.to_json %> 
```

在你的控制器中，`@serials`是

```
@serials = []
@hack.serials.each do |s|
  s.observations.each do |o|
    @serials << [o.hs_date, o.value]
  end
end 
```

# oauth - Meteor.loginWithFacebook 不工作？

> ID：15341246
> 
> 赞同：6
> 
> 时间：2013-03-11T14:36:30.303
> 
> 标签：oauth, meteor, facebook-oauth

添加了**accounts-facebook**包。我正在尝试按照文档使用 facebook 登录：http: [//docs.meteor.com/#meteor_loginwithexternalservice](http://docs.meteor.com/#meteor_loginwithexternalservice)

有这个**按钮点击事件**：

```
Meteor.loginWithFacebook({ requestPermissions: ['email']},
function (error) {
    if (error) {
        return console.log(error);
    }
}); 
```

**而服务器**上的这个设置：

```
Accounts.loginServiceConfiguration.remove({
    service: "facebook"
});
Accounts.loginServiceConfiguration.insert({
    service: "facebook",
    clientId: "389711236782370",
    secret: "2wwd9c47589e3eb19e7dbgfb235b6a12"
}); 
```

我在 facebook 登录弹出窗口中得到一个**未定义的 client_id ：** [https](https://www.facebook.com/dialog/oauth?client_id=undefined&redirect_uri=http://localhost:3000/_oauth/facebook?close) ://www.facebook.com/dialog/oauth?client_id=undefined&redirect_uri=http://localhost:3000/_oauth/facebook?close ...

即使我使用 Meteor 生成的 {{loginButtons}}，我也会得到相同的结果。我还添加了 google 包，它运行良好。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-12T09:49:37.457

**将clientId**更改为**appId**有效！

```
Accounts.loginServiceConfiguration.remove({
    service: "facebook"
});
Accounts.loginServiceConfiguration.insert({
    service: "facebook",
    appId: ".........",
    secret: "........."
}); 
```

感谢 middle8media 的评论：[http ://www.eventedmind.com/posts/meteor-customizing-login](http://www.eventedmind.com/posts/meteor-customizing-login)

# android - 阴影层可与模拟器一起使用，但不能在实际设备上使用

> ID：15341247
> 
> 赞同：8
> 
> 时间：2013-03-11T14:36:33.707
> 
> 标签：android, paint, shadow

我正在创建一个自定义可绘制对象（它从可绘制对象扩展）并且我正在尝试对其施加阴影效果。

这是我的代码的一部分：

```
public void draw(Canvas canvas) {
    Path path = new Path();
    path.moveTo(0, 0);
    path.lineTo(0, Y/2);
    path.lineTo(X/2, Y);
    path.lineTo(X, Y/2);
    path.lineTo(X, 0);
    path.lineTo(0, 0);
    Paint paint = new Paint();
    paint.setColor(context.getResources().getColor(R.color.red_dark));
    paint.setStyle(Style.FILL_AND_STROKE);
    paint.setStrokeWidth(2f);
    paint.setShadowLayer(1, 0, 10f, context.getResources().getColor(R.color.black));
    canvas.drawPath(path, paint);
} 
```

我不知道为什么，但它会产生相同颜色的阴影，我仔细检查了所有内容，但看不出问题出在哪里。我在银河系上对其进行了测试。但是在模拟器上它工作得很好。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-14T10:22:35.187

我不确定，但这可能是因为硬件加速。`setShadowLayer`如果视图加速则不起作用。尝试禁用整个应用程序的加速并检查。[读这个。](http://developer.android.com/guide/topics/graphics/hardware-accel.html)

> 不支持的绘图操作
> 
> setShadowLayer()：仅适用于文本
> 
> 使用软件层类型强制在软件中呈现视图。如果硬件加速的视图（例如，如果您的整个应用程序都是硬件加速的）出现渲染问题，这是一种解决硬件渲染管道限制的简单方法。

使用[setLayerType](http://developer.android.com/reference/android/view/View.html#setLayerType%28int,%20android.graphics.Paint%29)将图层类型设置为单个视图或在清单中为整个应用[关闭加速。](http://developer.android.com/guide/topics/manifest/application-element.html#hwaccel)

# java - 快速排序算法

> ID：15341252
> 
> 赞同：0
> 
> 时间：2013-03-11T14:36:38.857
> 
> 标签：java, quicksort

我没有从任何地方看到这个算法，而是自己做的，只是看到了快速排序是如何工作的，这是在 Java 中，问题是，它排序很好，对最多 6 个值的数量有好处，它挂在值上的时间超过6\. 或者可能有其他一些我不知道的问题。这是代码-

```
import java.util.Scanner;

class Main {
public static void main(String[] args) {

        System.out.print("Enter number of elements= ");

        int x, a[];
        Scanner z = new Scanner(System.in);
        x = Integer.parseInt(z.next());
        a = new int[x];

        for(int i = 0; i < x; i++){
            System.out.print("Enter element #"+(i+1)+"= ");
            a[i] = Integer.parseInt(z.next());
        }

        QuickSort(a, 0, x-1);

        System.out.print("A= ");
        for(int i = 0; i < x; i++){
            System.out.print(a[i]+" ");
        }
    }

    public static void QuickSort(int a[], int low, int high){
        if(low >= high)
            return;

        int l = low + 1, h = high, flag = 0, temp;

        while(l <= h){
            if(a[low] >= a[l]){
                ++l;
                ++flag;
            }
            if(a[low] <a [h]){
                --h;
                ++flag;
            } else if(flag == 0){
                temp = a[l];
                a[l] = a[h];
                a[h] = temp;
                ++l;
                --h;
            }
        }

        temp = a[low];
        a[low] = a[h];
        a[h] = temp;
        QuickSort(a, low, h-1);
        QuickSort(a, h+1, high);
    }
} 
```

感谢所有的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:57:00.210

问题是您忘记`flag`在内部循环中设置回 0，从而导致它进入无限循环。

`flag=0;`在之后添加该`while(l<=h){`行使其工作。尽管您应该真正学习编写并非完全难以辨认的代码。这不仅会让人们更容易地帮助你，它甚至会让你更容易发现这样的错误。

Also, you should really learn basic troubleshooting skills before asking for help. I didn't even need to use a debugger, I just added a couple of print statements to see where it was getting stuck.

# c# - IoC 隐藏平台不匹配

> ID：15341253
> 
> 赞同：0
> 
> 时间：2013-03-11T14:36:39.063
> 
> 标签：c#, visual-studio, inversion-of-control, loose-coupling

假设您有一个 3 层应用程序：

1.  界面层（UI）
2.  业务层（BLL）
3.  数据层 (DAL)：引用 32 位 DLL，因此必须编译为 x86

在传统应用程序中，UI 将引用 BLL，而 BLL 将引用 DAL。如果 UI 或 BLL 设置为“任何 CPU”平台，您将在 C# 编译器中收到平台不匹配警告。因此，x86 要求（或“建议”，因为它是一个警告）会冒泡到 UI，然后编译器会很高兴。

在使用 IoC 的应用程序中，假设您现在添加了第四个程序集“共享接口”，它被所有层引用。此外，UI 引用 BLL 和 DAL，而 BLL 不*引用*DAL。在这种情况下，UI 会看到平台不匹配警告。但是，BLL 可以保持为“任何 CPU”并且不会收到任何警告。您可以想象其余的以及这如何导致运行时错误。

我的推理正确吗？IoC，或者更广泛地说，松散耦合，本质上是否倾向于将一些错误从编译时转移到运行时？

**编辑：**所以在重新考虑这一点时，我意识到我的逻辑是有缺陷的。主程序集 (UI) 是确定应用程序在哪个平台下运行的程序集。因此，即使 BLL 保持为“任何 CPU”，UI 也会强制 x86 并且不会导致任何运行时错误。更好的是，如果 BLL 是共享的并且另一个 DAL 实现不需要 x86，则另一个应用程序可以保持为 Any CPU，因为您没有拖动该引用。还有其他一些编译器错误转移到运行时错误的例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T11:50:01.557

您的推理与 IoC 或松散耦合无关。无论您如何使用 DLL，只要您开始混合 32 位/64 位，这些错误就会出现。错误是在程序集级别，而不是像松散耦合或依赖注入那样的类级别。

# r - 如何在 R 中绘制多组数据？

> ID：15341254
> 
> 赞同：0
> 
> 时间：2013-03-11T14:36:40.153
> 
> 标签：r, plot, graphing

就像在[这里找到](http://www.jpowered.com/php-scripts/vertical-bar-graph/images/php-bar-graph-3d-multi.gif)的图中一样，我想在同一个条形图中显示多个数据集。

我的数据基本上是各个国家的“男性/女性”身高。我想要沿 x 轴的国家和每个国家/地区的男性和女性身高的两个条形图（一个蓝色和一个红色）。

我已经为此苦苦挣扎了几天，但仍然没有弄清楚。

每个数据集当前都存储在自己的数据框中，第一列是“国家”，第二列是“高度”。所以我有一个male_heights 和female_heights 数据框。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T14:56:01.623

这是一个带有一些虚拟数据的示例：

```
# create some dummy data of two data.frames for male and female
set.seed(45)
dd.m <- data.frame(country = sample(letters[1:8]), height=sample(150:200, 8))
dd.f <- data.frame(country = sample(letters[1:8]), height=sample(130:180, 8))

# create an grp column for each of the above data.frames (M, F -> male, female)
dd.m$grp <- "M"
dd.f$grp <- "F"

# merge data together
dd <- rbind(dd.m, dd.f)

# set levels for grp column - which one should be displayed first within the group
# here, female followed by male
dd$grp <- factor(dd$grp, levels=c("F", "M"), ordered=TRUE)

# make sure country is a factor (reorder levels if you have to)
dd$country <- factor(dd$country)

# plot using ggplot
require(ggplot2)    
ggplot(data = dd, aes(x=country)) + 
      geom_bar(aes(weights=height, fill=grp), position="dodge") + 
      scale_fill_brewer(palette = "Set1") 
```

这给出了： ![在此处输入图像描述](../Images/b309894ee73336292bc985343dad6ed4.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T14:56:51.847

首先，您应该根据国家/地区合并两个 data.frame。您可以使用例如 ggplot2 进行绘图。

这是使用 ggplot2 的示例：

```
# some data
male_heights <- data.frame(country = LETTERS[1:20],
                           heights = runif(20, 10,20))
female_heights <- data.frame(country = LETTERS[1:20],
                            heights = runif(20, 10,20))

# merge both data.frame
df_m <- merge(male_heights, female_heights, by = 'country', suffixes=c('_males', '_females'))

# bring data to long format
require(reshape2)
dfm <- melt(df_m)

# plot
ggplot(dfm, aes(x = country, y = value, fill = variable)) +
  geom_bar(stat = 'identity', position = 'dodge') 
```

![在此处输入图像描述](../Images/110ea0140cb335177a5054bad691b680.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-11T16:02:14.380

为了完整起见，这里有一些其他可用选项，一个在基本 R 中，一个带有通常与 R 一起安装的“lattice”包。使用@Arun 的示例数据，这里是每个的基本示例。（有*很多*方法可以自定义每个的外​​观。）

```
## Base R -- Nothing fancy. 
## Requires a vector or matrix for your data
barplot(xtabs(height ~ grp + country, dd), 
        beside = TRUE, col = c("red", "blue")) 
```

![在此处输入图像描述](../Images/6e15f7930bb44d51e31940fda8c47b0f.png)

```
## lattice -- can work directly with your data.frame
## Several interesting options for groupings
library(lattice)
barchart(height ~ country, data = dd, groups = grp, 
         ylim = c(0, max(dd$height)+10), col = c("red", "blue")) 
```

![在此处输入图像描述](../Images/346d675c7d51e4120feebc3c82eb0912.png)

# html - 如何使第二个相邻的 div 具有填充父容器的自动宽度

> ID：15341265
> 
> 赞同：0
> 
> 时间：2013-03-11T14:37:00.753
> 
> 标签：html, css

```
<div class="parent clearfix" style="width:100%; height: 100px">

<div style="float: left; width:150px; height: 50%">
</div>

<div style="float: left;" class="target">
</div>

</div> 
```

我想让类 'target' div 的宽度比具有类 'parent clearfix' 的 div 的宽度小 150px

我该如何做到这一点？在上面的示例中，父 div 是另一个具有指定宽度的 div 的子元素（此指定宽度可以更改）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T14:44:36.583

您可以`display: table`为父母和`display: table-cell`孩子使用（[小提琴](http://jsfiddle.net/X9Qsy/)）。

```
<div style="width:100%; height: 100px; display: table">
    <div style="display: table-cell; width:150px; height: 50%">
    </div>
    <div style="display: table-cell;">
    </div>
</div> 
```

但它不适用于旧版浏览器。

## 更新

另一种方法是给`margin-left: 150px`第二列a `position: absolute`，给第一列a。这适用于大多数浏览器，但当然它不是一个干净的版本，如果第一列的内容比第二列长，你会遇到麻烦。[小提琴](http://jsfiddle.net/ZJe2j/1/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:12:11.160

它应该只在 `width: calc(100%-150px)` 支持 CSS3 的浏览器中被支持

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T14:49:26.540

查看[http://alistapart.com/article/holygrail](http://alistapart.com/article/holygrail)以获得半流体布局。我认为这正是您正在寻找的。

# php - 避免在数据库中重复插入信息

> ID：15341270
> 
> 赞同：0
> 
> 时间：2013-03-11T14:37:21.620
> 
> 标签：php, mysql, sql

嘿伙计们，我有一个名为用户名的表，在我的程序中，我可以使用用户名和密码创建新用户。

但我不想让两个用户使用相同的用户名

我使用 php 和 mysql。

我该如何处理？

谢谢努布

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:38:43.770

添加`UNIQUE`约束以便在列上强制执行不同的值，

```
ALTER TABLE tableNAme ADD CONSTRAINT tb_unique UNIQUE(username) 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/395af/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:40:26.750

您可以检查名称是否已存在并要求用户选择其他名称；

```
SELECT COUNT(username) FROM users WHERE userName = '[name to check]' 
```

并向用户名字段添加唯一索引

# ms-media-foundation - 示例 Grabber Sink release() 问题

> ID：15341272
> 
> 赞同：0
> 
> 时间：2013-03-11T14:37:23.320
> 
> 标签：ms-media-foundation

我使用来自 msdn 示例的大部分代码在我的媒体会话中使用 Sample Grabber Sink。

在 OnProcessSample 方法中，我将数据 memcpy 到媒体缓冲区，将其附加到 MFSample 并将其放入主进程指针。问题是我在 ntdll.dll 中出现内存泄漏或崩溃

> ntdll.dll!@RtlpLowFragHeapFree@8() 未知

SampleGrabberSink：

```
OnProcessSample(...)
{
    MFCreateMemoryBuffer(dwSampleSize,&tmpBuff);
    tmpBuff->Lock(&data,NULL,NULL);
    memcpy(data,pSampleBuffer,dwSampleSize); tmpBuff->Unlock();
    MFCreateSample(&tmpSample);
    tmpSample->AddBuffer(tmpBuff);

    while(!(*Free) && (*pSample)!=NULL)
    {
        Sleep(1);
    }

    (*Free)=false;
    (*pSample)=tmpSample;
    (*Free)=true;
    SafeRelease(&tmpBuff);
} 
```

在主线程中

```
ReadSample()
{
    if(pSample==NULL)
        return;
    while(!Free)
        Sleep(1);
    Free=false;
    //process sample into dx surface//
    SafeRelease(&pSample);
    Free=true;
} 
```

//hr 检查省略// 使用这段代码，我在播放几个视频后得到了 ntdll.dll 错误。我还尝试在队列中推送样本，这样 OnProcess 就不必等待，但是在视频结束后一些内存还没有释放。（即使现在它实际上也不等待，会话速率为 1，主进程可以读取超过 60fps）

**编辑：**这是线程同步问题。多亏了 Roman R ，通过使用[临界区来解决。](http://msdn.microsoft.com/en-us/library/ms682530%28VS.85%29.aspx%3a)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T16:28:56.610

从代码片段中不容易看出，但我想您正在流式线程上刻录周期（您已调用回调），直到全局/共享变量`NULL`出现，然后您在那里复制媒体样本。

您需要查看同步 API 并序列化对共享变量的访问。你不这样做，最终要么访问释放的内存，要么破坏 COM 对象的引用计数。

当您准备好从回调中接受新缓冲区时，您需要在外部设置一个事件，然后回调看到该事件，进入临界区（或读/写器锁），在`*pSample`那里施展魔法，从临界区退出并设置另一个事件指示缓冲区的可用性。

# iphone - 设置 UILocalNotification 的 fireDate

> ID：15341273
> 
> 赞同：0
> 
> 时间：2013-03-11T14:37:24.940
> 
> 标签：iphone, ios, ipad, uilocalnotification

我在 [这里](http://useyourloaf.com/blog/2010/07/31/adding-local-notifications-with-ios-4.html)使用这个应用程序， 它对我很好，但我想手动插入本地通知的 fireDate，而不是使用 datePicker。

```
notif.fireDate = [datePicker date]; 
```

如何手动插入日期（日、月、年、小时和分钟）？

我尝试了以下

```
NSCalendar *calendar = [NSCalendar autoupdatingCurrentCalendar];
NSDateComponents *dateComps = [[NSDateComponents alloc] init];
[dateComps setDay:10];
[dateComps setMonth:3];
[dateComps setYear:2013];
[dateComps setHour:4];
[dateComps setMinute:45];
NSDate *itemDate = [calendar dateFromComponents:dateComps];

int minutesBefore = 2;
notif.fireDate = [itemDate addTimeInterval:-(minutesBefore*60)]; 
```

但它不适用于我。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:44:41.267

使用[NSDateFormatter](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html)您可以直接从 a 转换`NSString`为`NSDate`. 这是一个例子：

```
NSDateFormatter* myFormatter = [[NSDateFormatter alloc] init];
[myFormatter setDateFormat:@"MM/dd/yyyy"];
NSDate* myDate = [myFormatter dateFromString:@"8/26/2012"];
NSLog(@"%@", myDate); 
```

**编辑**
如果你也想要时间

```
NSString *str =@"3/15/2012 9:15 PM";
NSDateFormatter *formatter = [[NSDateFormatter alloc]init];
[formatter setDateFormat:@"MM/dd/yyyy hh:mm a"];
NSTimeZone *gmt = [NSTimeZone timeZoneWithAbbreviation:@"GMT"];
[formatter setTimeZone:gmt];
NSDate *date = [formatter dateFromString:str];

NSLog(@"%@",date); 
```

点击此链接了解更多信息[SO Answer](https://stackoverflow.com/questions/9769190/create-a-nsdate-from-a-string)

而对于 localNotification 也只需在开火日期后实施

```
UIApplication *app=[UIApplication sharedApplication];
[app scheduleLocalNotification:localNotification]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:44:12.310

怎么用`addTimeInterval`？

```
UILocalNotification *localNotif = [[UILocalNotification alloc] init];
localNotif.fireDate = [itemDate addTimeInterval:-(minutesBefore*60)]; 

 //minutesBefore will be type of int and itemDate would be of NSDate type. 
```

更新1：

经过一番搜索后，我发现`addTimeInterval`在 iOS 4 及以后版本中已弃用。相反，您应该使用`dateByAddingTimeInterval`.

```
 localNotif.fireDate = [itemDate dateByAddingTimeInterval:-(minutesBefore*60)]; 
```

*提供负值将**提前**`dateByAddingTimeInterval`几分钟触发通知**`itemDate`*****。**

# php - PHP box creation is slow I have a site with 2 groups of 2 select boxes each containing about 5,000 records, with each group containing the same data, just displayed in a different order with the data being stored in a mysql table. I am finding th

> ID：15341279
> 
> 赞同：0
> 
> 时间：2013-03-11T14:37:36.243
> 
> 标签：php

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:45:02.437

加载速度下降到程序中的几个点。

*   首先，您以给定的顺序（两次）从数据库中提取 5,000 条记录。

*   然后，您将遍历这些项目以将它们转换为 HTML 输出。

*   然后您将页面中的所有 10,000 个项目发送到浏览器。

*   最后，浏览器需要在页面上呈现这些项目。

您可以通过减少项目数量来加速所有这些。例如，不是提供世界上所有城镇的列表，而是提供一个文本框，用户可以输入城镇以减小列表的大小。然后，您可以通过获取较小的城镇匹配列表供他们选择来改善体验（甚至将其作为 AJAX 请求实现，这样他们就不需要提交页面来获取列表）。

# opengl-es-2.0 - glDrawArrays 与 GLES2 崩溃

> ID：15341280
> 
> 赞同：0
> 
> 时间：2013-03-11T14:37:41.103
> 
> 标签：opengl-es-2.0

```
GLuint vBuffer;
glGenBuffers(1, &vBuffer);
glBindBuffer(GL_ARRAY_BUFFER, vBuffer);
int totalSize = sizeof(tempVertexList);
glBufferData(GL_ARRAY_BUFFER, totalSize, tempVertexList, GL_STREAM_DRAW);
glDrawArrays(GL_TRIANGLE_STRIP, 0, vertexCount); 
```

这段代码在涉及 glDrawArrays 时会崩溃，有什么明显的原因吗？vertexCount 为 4 并且 tempVertexList 填充了 4 个 Vertex 结构，定义为

```
typedef struct
{
    float Position[3];
    float Colour[4];
} Vertex; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:18:26.233

```
glVertexAttribPointer(positionSlot, 3, GL_FLOAT, GL_FALSE, sizeof(Vertex), 0);
glVertexAttribPointer(colorSlot, 4, GL_FLOAT, GL_FALSE, sizeof(Vertex), (GLvoid*)(sizeof(float)*3)); 
```

每次更改 GL_ARRAY_BUFFER 都需要调用，不知道才发现 :)

# sql - 如何从 ADSI Openquery 返回列中的所有数据？

> ID：15341282
> 
> 赞同：1
> 
> 时间：2013-03-11T14:37:42.233
> 
> 标签：sql, sql-server, active-directory

我正在尝试从 Active Directory openquery（特别是“thumbnailPhoto”属性）中获取 varbinary 数据类型，但是，它似乎将返回的数据截断为 256 个字符。我使用 Active Directory 应用程序查看当前存储的数据，它比 256 位大很多，因此数据截断肯定存在问题。

我的查询如下所示：

```
选择 *
从公开查询（ADSI，
                      '选择缩略图照片
FROM ''LDAP://XXXXXX/OU=XX,OU=XX,dc=XX,dc=XX''  
其中objectClass =''用户'''）
```

我曾尝试研究在 openquery 中转换/转换的方法，但似乎不可能和/或从未讨论过。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T19:15:19.543

事实证明，使用 SQL Server 接口连接 AD 非常困难，所以我必须使用 DirectorySearch .net 库和 LDAP 查询（[http://technet.microsoft.com/en-us/ library/aa996205(v=exchg.65).aspx](http://technet.microsoft.com/en-us/library/aa996205(v=exchg.65).aspx) ) 以从 AD 获取所有信息，而无需任何数据截断。

# java - 将数组从 javascript 传递给 back bean

> ID：15341284
> 
> 赞同：1
> 
> 时间：2013-03-11T14:37:56.387
> 
> 标签：java, javascript, google-maps, jsf, primefaces

我有一个关于将位置点数组从 javascript 传递到 back bean 的问题。我将使用这个点数组来创建一个多边形。为此，我应该将数组从 javascript 获取到我的 back bean 以将它们保存在数据库中。

这是我的 xhtml 片段：

```
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
        <meta charset="UTF-8">
            <title>Drawing Tools</title>
            <script type="text/javascript"
            src="http://maps.google.com/maps/api/js?sensor=false"></script>
            <style type="text/css">
                #map, html, body {
                    padding: 0;
                    margin: 0;
                    height: 400px;
                    width: 400px;
                }

                #panel {
                    width: 200px;
                    font-family: Arial, sans-serif;
                    font-size: 13px;
                    float: right;
                    margin: 10px;
                }

                #color-palette {
                    clear: both;
                }

                .color-button {
                    width: 14px;
                    height: 14px;
                    font-size: 0;
                    margin: 2px;
                    float: left;
                    cursor: pointer;
                }

                #delete-button {
                    margin-top: 5px;
                }
            </style>
            <script type="text/javascript">
                var drawingManager;
                var selectedShape;
                var colors = ['#1E90FF', '#FF1493', '#32CD32', '#FF8C00', '#4B0082'];
                var selectedColor;
                var colorButtons = {};
                var polyOptions;

                function clearSelection() {
                    if (selectedShape) {
                        selectedShape.setEditable(false);
                        selectedShape = null;
                    }
                }

                function setSelection(shape) {
                    clearSelection();
                    selectedShape = shape;
                    shape.setEditable(true);
                    //selectColor(shape.get('fillColor') || shape.get('strokeColor'));
                }

                function deleteSelectedShape() {
                    if (selectedShape) {
                        selectedShape.setMap(null);
                    }
                }

                function initialize() {
                    var map = new google.maps.Map(document.getElementById('map'), {
                        zoom: 10,
                        center: new google.maps.LatLng(40.344, 39.048),
                        mapTypeId: google.maps.MapTypeId.ROADMAP,
                        disableDefaultUI: true,
                        zoomControl: true
                    });

                    polyOptions = new google.maps.Polygon({
                        strokeColor: '#ff0000',
                        strokeOpacity: 0.8,
                        strokeWeight: 0,
                        fillOpacity: 0.45,
                        fillColor: '#ff0000',
                        editable: false,
                        draggable: true
                    });

                    polyOptions.setMap(map);

                    google.maps.event.addListener(map, 'click', addPoint);

                }

                function addPoint(e) {
                    var vertices = polyOptions.getPath();

                    vertices.push(e.latLng);
                    document.getElementById('verticeForm:sth').value= vertices;

                }
                google.maps.event.addDomListener(window, 'load', initialize);
            </script>
        </meta></meta>
</head>
<body>
    <div id="map"></div>

    <p:commandButton onclick="o.show();"  value="Show">
        <p:dialog widgetVar="o" >
            <h:form id="verticeForm">
                <h:outputLabel id="input">
                    <h:inputHidden id="sth" value="#{projectsController.list}" />
                </h:outputLabel>
            </h:form>
            <h:outputText value="#{projectsController.asd}" />
        </p:dialog>
    </p:commandButton>
</body> 
```

这是我的后台豆片段：

```
 private String sth;

    public String getSth() {
        return sth;
    }

    public void setSth(String sth) {
        this.sth = sth;
    }
    private List<String> list = new ArrayList<String>();

    public List<String> getList() {
        return list;
    }

    public void setList(List<String> list) {
        this.list = list;
    }
    private String asd;

    public String getAsd() {
        if(list.size()>0){
            asd = list.get(0);
            System.out.println(asd);
        }
        return asd;
    }

    public void setAsd(String asd) {
        this.asd = asd;
    }
} 
```

基本上，如何在 JSF 中将顶点数组（在 gmap 上有点）发送到我的后 bean？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T14:46:22.150

将该数组（最好是 JSON）添加为托管 bean 的字段值，然后将其设置为`<h:inputHidden/>`您可以执行并渲染它`<f:ajax/>`以发送和接收数据：

```
<h:inputHidden id="verticesHiddenContainer" value="#{yourBean.vertices}" /> 
```

然后，你的 bean 应该有一个 setter 和一个 getter。如果您选择将其作为 JSON 发送，我建议您使用[Gson](https://sites.google.com/site/gson/gson-user-guide)（因为您已经在 Google 上）来解析它。

该过程将是这样的：

首先，您生成包含`vertices`要发送到服务器的数据的 JSON，然后将其设置为隐藏输入。我正在使用 jQuery，但如果你使用纯 javascript，你将不得不做同样的事情，但使用`document#getElementById`：

```
var vertices = // You set your JSON here.
$("input[id='verticesHiddenContainer'").val(vertices); 
```

`f:ajax`然后，使用和 a执行隐藏组件`commandLink`，如下所示：

```
<h:commandLink value="Send data to server" action="#{yourBean.process}" >
    <f:ajax execute="verticesHiddenContainer" />
</h:commandLink> 
```

该链接现在将触发一个 ajax 请求，该请求使用输入的当前值更新 bean 中的字段。请记住，由于您传递的是 JSON，因此您必须解析它。如果您使用 Gson，则非常简单：

```
public void setVertices(String verticesString) {
    //Since I don't know what kind of structure you use, I suposse
    //something like [[x,y]]. It can be more complex, but the
    //idea would be the same. You parse the string here.
} 
```

SO 中已经有关于 JSON 序列化和解析的很好的答案。如果有疑问，我建议你看看它们：

*   [JSON 到 HashMap](https://stackoverflow.com/questions/2779251/convert-json-to-hashmap-using-gson-in-java)
*   [字符串到 JSON 数组](https://stackoverflow.com/questions/6454889/cant-convert-string-to-jsonarray)（如果您的 JSON 结构不是那么复杂）

# python - 如何在单击按钮时调用 Django 函数？

> ID：15341285
> 
> 赞同：45
> 
> 时间：2013-03-11T14:37:56.970
> 
> 标签：python, django, django-templates, django-views

我正在尝试编写一个 Django 应用程序，但我被困在单击按钮时如何调用视图函数。

在我的模板中，我有一个链接按钮，如下所示，单击它会将您带到不同的网页：

```
<a target="_blank" href="{{ column_3_item.link_for_item }}">Check It Out</a> 
```

单击按钮时，我还想调用 Django 视图函数（以及重定向到目标网站）。视图函数增加数据库中的值，该数据库存储了按钮被单击的次数。

这`column_3_item.link_for_item`是指向外部网站的链接（例如*www.google.com*）。现在，当单击该按钮时，它会打开一个新窗口，将您带到谷歌网站。

我想做的是在单击按钮时调用 Django 视图函数，该按钮更新数据库而不刷新页面。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-03-11T16:42:15.103

这是一种纯 JavaScript 的简约方法。我使用 JQuery，但您可以使用任何库（[甚至根本没有库](http://net.tutsplus.com/articles/news/how-to-make-ajax-requests-with-raw-javascript/)）。

```
<html>
    <head>
        <title>An example</title>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>
            function call_counter(url, pk) {
                window.open(url);
                $.get('YOUR_VIEW_HERE/'+pk+'/', function (data) {
                    alert("counter updated!");
                });
            }
        </script>
    </head>
    <body>
        <button onclick="call_counter('http://www.google.com', 12345);">
            I update object 12345
        </button>
        <button onclick="call_counter('http://www.yahoo.com', 999);">
            I update object 999
        </button>
    </body>
</html> 
```

* * *

**替代方法**

您可以通过以下方式更改链接，而不是放置 JavaScript 代码：

```
<a target="_blank" 
    class="btn btn-info pull-right" 
    href="{% url YOUR_VIEW column_3_item.pk %}/?next={{column_3_item.link_for_item|urlencode:''}}">
    Check It Out
</a> 
```

在你的`views.py`：

```
def YOUR_VIEW_DEF(request, pk):
    YOUR_OBJECT.objects.filter(pk=pk).update(views=F('views')+1)
    return HttpResponseRedirect(request.GET.get('next')) 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2019-09-26T18:01:28.083

我个人使用了 2 种可能的解决方案

1.不使用表格

```
 <button type="submit" value={{excel_path}} onclick="location.href='{% url 'downloadexcel' %}'" name='mybtn2'>Download Excel file</button> 
```

2.使用表格

```
<form action="{% url 'downloadexcel' %}" method="post">
{% csrf_token %}

 <button type="submit" name='mybtn2' value={{excel_path}}>Download results in Excel</button>
 </form> 
```

urls.py 应该有这个

```
path('excel/',views1.downloadexcel,name="downloadexcel"), 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-04T04:08:38.423

以下答案可能对您问题的第一部分有所帮助：

[Django：如何从模板调用视图函数？](https://stackoverflow.com/questions/17599035/django-how-can-i-call-a-view-function-from-template/19761466#19761466)

# c# - 期望：100-继续

> ID：15341287
> 
> 赞同：13
> 
> 时间：2013-03-11T14:38:05.133
> 
> 标签：c#, http, post

关于这个话题有很多问题，但是 - 他们没有给我答案。

从建议 - 有一个要设置`ServicePointManager.Expect100Continue = false`。但这是不可接受的，因为这将是一个模块，与其他几十个模块异步工作。所以可接受的解决方案 - 是每个连接的属性。有一些建议如何设置它，但它似乎不起作用。

这是代码：

```
var conuri = new Uri(connectionString);
var sp = ServicePointManager.FindServicePoint(conuri);
sp.Expect100Continue = false;

_request = (HttpWebRequest)WebRequest.Create(conuri);
_request.ContentType = "text/xml";
_request.Method = "POST";

_request.ContentLength = dataToSend.Length;
requestStream = _request.GetRequestStream();
requestStream.Write(dataToSend, 0, dataToSend.Length); 
```

问题是，`Expect: 100-continue`仍然添加了“requestStream.Write”-标头，但它不应该根据我在这里阅读的建议：[C# Expect100Continue 标头请求](https://stackoverflow.com/questions/13479712/c-sharp-expect100continue-header-request)。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-11T14:41:19.510

你可以这样做：

```
_request.ServicePoint.Expect100Continue = false; 
```

这将禁用`Expect: 100-continue`特定`HttpWebRequest`实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-18T07:55:03.903

当此属性设置为 true 时，使用 POST 方法的客户端请求预计会收到来自服务器的 100-Continue 响应，以指示客户端应该发送要发布的数据。当服务器基于请求标头打算拒绝请求时，此机制允许客户端避免通过网络发送大量数据。

> ServicePointManager.Expect100Continue = true;

# ios - phonegap 2.5.0 in IOS filetransfer上传图片，返回405和code 3

> ID：15341294
> 
> 赞同：0
> 
> 时间：2013-03-11T14:38:20.473
> 
> 标签：ios, cordova, file-transfer

我在 IOS 中使用 FileTransfer.upload 图像有问题，我使用您提供的示例：http: [//docs.phonegap.com/en/2.5.0/cordova_file_file.md.html#FileTransfer](http://docs.phonegap.com/en/2.5.0/cordova_file_file.md.html#FileTransfer)

当我从 ios 调用 FileTransfer.upload 时，我得到代码 3 和 HTTP 状态 405。我尝试从服务器端使用 ashx(handler) 文件。

**所有这些在android上都可以正常工作，两者的代码完全相同。**

我的代码：

```
function uploadPhoto(imageURI) {
    var options = new FileUploadOptions();
    options.fileKey = "file";
    options.fileName = imageURI.substr(imageURI.lastIndexOf('/') + 1);
    options.mimeType="image/jpeg";

    var fileImageTransfer = new FileTransfer();

    fileImageTransfer.upload(imageURI, domain + "/handlers/imageupload.ashx?greetingID=5", win, fail, options);
} 
```

两天没有成功，请帮助我。

10倍。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T02:19:41.110

您需要查看服务器日志以了解导致 405“方法不允许”错误的原因。查看文件是如何被请求的。

# solr - 将 Solr 与“样板”DD4T 一起使用

> ID：15341295
> 
> 赞同：3
> 
> 时间：2013-03-11T14:38:21.410
> 
> 标签：solr, tridion

我想使用 Solr 作为已发布 Tridion 内容的客户端搜索引擎。它可能会作为与主应用程序断开连接的 RESTful 服务来完成。

由于我们几乎肯定会使用样板 DD4T，所有内容都发布到 Broker，因此我有一些担忧，尤其是在索引 PDF 或 Word 文件等二进制文件时——听起来数据库可能会有很大的压力？

推荐什么策略来检索二进制文件并以这种方式索引它们？听起来这会比我们在数据库外部拥有二进制项目更困难？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T14:45:00.577

我们已经决定将二进制文件发布到文件系统 - 您只需在 cd_storage_conf.xml 中配置它，如下所示：

```
<Publication Id="9" defaultStorageId="defaultdb" cached="true">
    <Item typeMapping="Binary" storageId="defaultFile" cached="true"/>
</Publication> 
```

但是，即使您确实选择将二进制文件发布到数据库，这也不应该影响您的 Solr 索引，该索引将完全独立于代理数据库。您将需要编写一些自定义（自定义部署程序？）将您的数据推送到 Solr 索引中，并且您可以选择忽略二进制文件。

# php - PHP在不存在的静态属性上抛出错误

> ID：15341304
> 
> 赞同：1
> 
> 时间：2013-03-11T14:38:41.260
> 
> 标签：php

我正在更改项目中的一些代码，PHP 抛出了一个关于不再存在的类属性的非常奇怪的错误。以下是错误信息：

> 消息：未定义的属性：stdClass::$limit
> 文件：C:\xampp\htdocs\site\Classes\model.php
> 行：48

这是引发错误的大部分方法，第 48 行标记为：

```
$this->st->execute();
$this->st->setFetchMode(PDO::FETCH_OBJ);

if($row = $this->st->fetch()) {
    return $max - $row->limit; // line 48
}

return $max; 
```

`Config::$limit`曾经存在，但是当我对代码进行更改时，我摆脱了它。我已经通过一些文本编辑器验证了上面的代码是保存在 PHP 文件中的真实代码，所以它不是我在 Fritz 上的文本编辑器。

这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:46:39.257

`$row`似乎是`StdClass`返回的对象`PDOStatement::fetch()`。此对象的属性名称对应于结果集中返回的列名称。如果没有属性，那是因为您的 SQL 查询`limit`没有返回列。`limit`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:41:52.940

PDO::FETCH_OBJ 意味着每个结果行都将作为`stdClass`实例获取。

所以唯一可能的原因就是`$row->limit`不存在！
添加`!empty($row->limit)`检查，尝试`var_dump()`以确保这是真的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T14:49:55.287

该错误`Undefined property: stdClass::$limit`并不意味着它正在寻找静态属性；这就是 PHP 引用一般属性的方式（class::property）。

如果有错误或查询结果的某些表示，PDO`fetch()`将返回。`false`当你使用

```
$this->st->setFetchMode(PDO::FETCH_OBJ); 
```

它告诉 PDO 将结果行作为默认类的对象返回，并将行`stdClass`的列名作为属性。所以你得到了那个错误，因为结果行没有`limit`列。

您可以`var_dump($row)`调查实际返回的内容，但很可能正在执行的查询与您的预期不同，或者它正在执行`SELECT *`并且数据库已更改表定义。

# symfony - 创建符号链接失败

> ID：15341307
> 
> 赞同：1
> 
> 时间：2013-03-11T14:38:44.933
> 
> 标签：symfony, deployment, capistrano, symlink, capifony

我正在尝试将我的“开发”分支部署到我的开发服务器，但是当我运行时`cap development deploy`，我收到以下错误：

```
executing "ln -nfs /var/www/xyz.co.uk/shared/web/media /var/www/xyz.co.uk/releases/20130311143220/web/media"
    servers: ["x.xx.xx.xxx"]
    [x.xx.xx.xxx] executing command
*** [err :: x.xx.xx.xxx] ln:
*** [err :: x.xx.xx.xxx] failed to create symbolic link `/var/www/xyz.co.uk/releases/20130311143220/web/media'
*** [err :: x.xx.xx.xxx] : No such file or directory
*** [err :: x.xx.xx.xxx] 
    command finished in 44ms
*** [deploy:update_code] rolling back 
```

当我查看服务器`/var/www/xyz.co.uk/shared/web/media`已创建并`/var/www/xyz.co.uk/releases/20130311143220`已创建时，但一旦符号链接失败，则`20130311143220`在回滚时将其删除。有任何想法吗？我以 root 身份 ssh'ing。

**Capifony 配置**

部署.rb

```
set :stage_dir, 'app/config/deploy' # needed for Symfony2 only
set :stages, %w(production staging development)

set :application, "xyz.co.uk"

set :user, "root"  # The server's user for deploys
set :repository, "git@github.com:xyz/#{application}.git"
set :scm,         :git

set :keep_releases,  3
set :use_sudo,       false
set :shared_files,      ["app/config/parameters.yml"]
set :shared_children,   [app_path + "/logs", web_path + "/media", "vendor"]
set :use_composer, true
set :update_vendors, true
set :dump_assetic_assets, true

require 'capistrano/ext/multistage'
logger.level = Logger::MAX_LEVEL 
```

发展.rb

```
server 'x.xx.xx.xxx', :app, :web, :primary => true
ssh_options[:port] = xxxx
ssh_options[:forward_agent] = true
set :deploy_to, "/var/www/xyz.co.uk/"
set :symfony_env_prod, "test" 
```

**更新**

实际的错误信息是：

```
failed: "sh -c 'ln -nfs /var/www/xyz.co.uk/shared/web/media /var/www/xz.co.uk/releases/20130312135615/web/media'" on x.xx.xx.xxx 
```

另外，这是我的 .gitignore 文件：

```
/web/bundles/
/app/bootstrap*
/app/cache/*
/app/logs/*
/vendor/
/app/config/parameters.yml
composer.phar
/.idea/
/web/media/* 
```

从我的 git 存储库中提取的用户名和密码在我的开发服务器上与在我部署的本地计算机上不同，这会有所不同吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T08:17:51.770

原因是因为我没有设置`set_branch`开发所以它使用的是空的master！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T16:57:40.963

在您的存储库服务器（bitbucked，github）中，媒体文件夹已被推送？似乎 capifony 试图将一个不存在的文件夹设置为共享。

# ironpython - IronPython“从...导入*”在C#中

> ID：15341308
> 
> 赞同：0
> 
> 时间：2013-03-11T14:38:47.563
> 
> 标签：ironpython

如何从外部将类型导入我托管的 IronPython 范围？我可以在我的脚本中执行“from Abc import *”，但我需要始终导入某些类型并避免忘记导入它们，我想由主机硬编码/自动导入它们。

我已经这样做了：

```
strategyScriptEngine.Runtime.LoadAssembly(typeof(Team).Assembly); 
```

我已经尝试过了，但无济于事：

```
strategyScriptEngine.Execute(String.Format("from {0} import *", typeof(Team).Namespace)); 
```

# paypal-sandbox - 沙盒更新后无法使用贝宝沙盒测试帐户登录

> ID：15341312
> 
> 赞同：1
> 
> 时间：2013-03-11T14:38:51.550
> 
> 标签：paypal-sandbox

我的贝宝沙盒测试帐户无法正常工作（www.sandbox.paypal.com），即使我已经在 developer.paypal.com 上登录，它也会递归地要求登录。

图片网址： http: [//postimage.org/image/i3bd584uj/](http://postimage.org/image/i3bd584uj/)

直到 3 月 6 日，它都运行良好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T17:31:13.010

看起来很奇怪，删除你的 developer.paypal.com 应该可以解决这个问题。这样做的原因是您从旧的开发人员门户获得了 cookie，这会干扰新的门户/沙盒环境。删除所有 cookie /所有 paypal.com cookie 后，您应该能够登录新的开发人员门户并访问任何沙盒帐户，而不会出现任何问题。

对此的修复很快就会发布。

# google-analytics - 跟踪 PloneFormGen 表单的“感谢页面”

> ID：15341315
> 
> 赞同：1
> 
> 时间：2013-03-11T14:38:58.040
> 
> 标签：google-analytics, plone, ploneformgen, goal-tracking

我想允许 Google Analytics 跟踪用户已进入 Plone 4.1.6 站点上我的 PloneFormGen（版本 1.7.1）表单的感谢页面。但是该页面使用与表单本身相同的 URL 显示。

我尝试使用*自定义成功操作*覆盖并将其设置为`redirect_to:string:thank-you`（`thank-you`页面的 ID 在哪里）。但这（惊喜，惊喜）将浏览器重定向到感谢页面。虽然这确实会导致一个单独的 URL，但 POST 数据会丢失，因此用户会收到“未收到任何输入。请访问表单”的消息。不完全是我的计划。

我应该怎么做才能在单独的 URL 上显示感谢页面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:31:38.587

感谢 Matt Yoder，[collective.googleanalytics](http://plone.org/products/collective.googleanalytics)有一些钩子来检测 PloneFormGen 感谢页面。它还会做一些其他很棒的魔法，比如跟踪验证错误。

# java - 使用java在selenium中通过id或类名提取图像

> ID：15341323
> 
> 赞同：0
> 
> 时间：2013-03-11T14:39:27.897
> 
> 标签：java, selenium

我们如何使用java在selenium中通过id或类名提取图像并将其显示在swing frame中？我们可以通过以下方式提取文本

```
driver.findElement(By.id("Locator id")).getText(); 
```

但是图像呢？

我已经检查了“href”和“src”（实际上是存在的），但是每次我得到空值时都没有运气。

```
element = driver.findElement(By.id("my_image"));
String myImage = element.getAttribute("href");
System.out.println("Image url is: "+myImage); 
```

我要提取的图像是这样的

*div id="my_image" style="width: 300px; height: 57px;">img width="300" height="57" src="https://www.myimage.com/image/xyz/image? c=85ikffkkgfl" alt="我的图片" style="display:block;"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:10:53.877

您可以从图像中获取 href 并将其加载到您的 swing 组件上（或先下载它然后将其加载到 swing 上）。

你可以像这样得到href：

```
driver.findElement(By.id("Locator id")).getAttribute("href"); 
```

# macos - 将 KVM（为 Linux 编写）移植到 Mac OS X

> ID：15341333
> 
> 赞同：12
> 
> 时间：2013-03-11T14:39:50.243
> 
> 标签：macos, kvm

我正在尝试将 KVM（为 Linux 编写）移植到 Mac OS X。

* * *

**背景工作：**我开始浏览 Apple Developer Documents，其中列出了执行此操作的程序。我无法理解其中的某些部分，而我理解和尝试的部分效果不佳（按计划）。正如Apple Developer文档建议的那样，我也尝试通过fink，macports等，但是，一旦代码在主机上成功编译，这些包管理应用程序就会出现，对吧？（这就是我的假设）。*如果我错了，请纠正我。现在，我正在一一消除所面临的错误。这种方法需要花费大量的时间和精力，而且，我不知道这是否会奏效。

* * *

**问题：**请让我知道我的方法是对还是错。如果正确，请告诉我下一步应该做什么。如果错了，让我知道我的第一步应该是什么。 **PS：**为该项目分配的大量时间已经徒劳无功地尝试了不同的方法。请帮助我采取明确的方法来解决这个问题。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-05-08T18:37:28.043

你的方法不正确。

KVM 本质上是一个非常特定于操作系统的应用程序。将它移植到 Mac OS X 不仅仅是检查代码和修复编译错误的问题——它的重要部分需要完全重写才能在 OS X 上工作。（例如，对于初学者来说，`/dev/kvm`OS上没有X. VT 支持以完全不同的方式工作。）

如果这对您来说是新闻，请立即**返回**。KVM 不是一个简单的软件。如果您不首先了解您正在处理的内容，那么无论您花费多少时间都将无法移植它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-25T11:12:34.237

Windows 的 kvm 现在可用。见：[https](https://github.com/fanwenyi0529/fvm) ://github.com/fanwenyi0529/fvm fvm是kvm的跨平台，可以在windows&linux主机上运行，​​移植到mac类似于windows。

# containers - 无法创建 WebSphere 8 的可嵌入 EJB 容器 - NoClassDefFoundError HpelHelper

> ID：15341336
> 
> 赞同：2
> 
> 时间：2013-03-11T14:39:57.437
> 
> 标签：containers, websphere-8, embeddable

我正在使用 WebSphere 8 的可嵌入 EJB 容器为我的 EJB 和 JUnit4 编写一些单元测试。我的 IDE 是 RAD 8。

这是我的简单测试代码片段：

```
 Map properties = new HashMap();
    properties.put(EJBContainer.PROVIDER,
                "com.ibm.websphere.ejbcontainer.EmbeddableContainerProvider");
    EJBContainer ec = EJBContainer.createEJBContainer(properties); 

```

我得到一个 NoClassDefFoundError：

```
 java.lang.NoClassDefFoundError: com/ibm/ejs/ras/hpel/HpelHelper
at com.ibm.ejs.ras.RasHelper.getThreadId(RasHelper.java:1760)
at com.ibm.ejs.ras.RasEvent6$1.initialValue(RasEvent6.java:101)
at java.lang.ThreadLocal.setInitialValue(ThreadLocal.java:152)
at java.lang.ThreadLocal.get(ThreadLocal.java:142)
at com.ibm.ejs.ras.RasEvent6.<init>(RasEvent6.java:292)
at com.ibm.ejs.ras.MessageEvent6.<init>(MessageEvent6.java:203)
at com.ibm.ejs.ras.Tr.fireMessageEvent(Tr.java:1555)
at com.ibm.ejs.ras.Tr.warning(Tr.java:1207)
at com.ibm.ws.naming.java.javaNameSpaceImpl.localNameSpaceInit(javaNameSpaceImpl.java:347)
at com.ibm.ws.naming.java.javaNameSpaceImpl.init(javaNameSpaceImpl.java:267)
at      com.ibm.ws.naming.java.javaURLInitialContextFactory.getInitialContext(javaURLInitialContextFactory.java:156)
at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:247)
at javax.naming.InitialContext.initializeDefaultInitCtx(InitialContext.java:318)
at javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:348)
at javax.naming.InitialContext.internalInit(InitialContext.java:286)
at javax.naming.InitialContext.<init>(InitialContext.java:211)
at com.ibm.ejs.csi.DefaultComponentMetaData.initializeJavaNameSpace(DefaultComponentMetaData.java:150)
at com.ibm.ejs.csi.DefaultComponentMetaData.<init>(DefaultComponentMetaData.java:122)
at com.ibm.ejs.csi.DefaultComponentMetaData.<clinit>(DefaultComponentMetaData.java:94)
at java.lang.J9VMInternals.initializeImpl(Native Method)
at java.lang.J9VMInternals.initialize(J9VMInternals.java:228)
at com.ibm.ws.threadContext.ComponentMetaDataAccessorImpl.<init>(ComponentMetaDataAccessorImpl.java:59)
at com.ibm.ws.threadContext.ComponentMetaDataAccessorImpl.<clinit>(ComponentMetaDataAccessorImpl.java:54)
at java.lang.J9VMInternals.initializeImpl(Native Method)
at java.lang.J9VMInternals.initialize(J9VMInternals.java:228)
at com.ibm.ws.threadContext.JavaNameSpaceAccessorImpl.<init>(JavaNameSpaceAccessorImpl.java:56)
at com.ibm.ws.threadContext.JavaNameSpaceAccessorImpl.<clinit>(JavaNameSpaceAccessorImpl.java:48)
at java.lang.J9VMInternals.initializeImpl(Native Method)
at java.lang.J9VMInternals.initialize(J9VMInternals.java:228)
at com.ibm.websphere.ejbcontainer.EmbeddableContainer.initNaming(EmbeddableContainer.java:353)
at com.ibm.websphere.ejbcontainer.EmbeddableContainer.initialize(EmbeddableContainer.java:454)
at com.ibm.websphere.ejbcontainer.EmbeddableContainer.open(EmbeddableContainer.java:428)
at com.ibm.websphere.ejbcontainer.EmbeddableContainer.newContainer(EmbeddableContainer.java:382)
at com.ibm.websphere.ejbcontainer.EmbeddableContainerProvider.createEJBContainer(EmbeddableContainerProvider.java:75) 
```

我在任何地方都找不到带有 com/ibm/ejs/ras/hpel/HpelHelper 类的 jar。

这是我的类路径：

```
C:\workspaces\irad8\JSF2.0Test\MyEJBPrj\ejbModule;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.wccm.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.emf.jar;
C:\Program Files\IBM\WebSphere\AppServer\dev\JavaEE\6.0\j2ee.jar;
C:\Program Files\IBM\WebSphere\AppServer\lib\mail-impl.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.runtime.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.ejbportable.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.admin.core.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.admin.services.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.portletcontainer.jar;
C:\Program Files\IBM\WebSphere\AppServer\lib\bootstrap.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.sib.server.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.sip.container.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.sip.interface.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.jsf.myfaces.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.webcontainer.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.wsadie\marshall.jar;
C:\Program Files\IBM\WebSphere\AppServer\lib\ffdcSupport.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.wsadie\wsatlib.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.runtime.dist.jar;
C:\Program Files\IBM\WebSphere\AppServer\installedConnectors\wmq.jmsra.rar\com.ibm.mq.jar;
C:\Program Files\IBM\WebSphere\AppServer\installedConnectors\wmq.jmsra.rar\com.ibm.mq.headers.jar;
C:\Program Files\IBM\WebSphere\AppServer\installedConnectors\wmq.jmsra.rar\com.ibm.mq.pcf.jar;
C:\Program Files\IBM\WebSphere\AppServer\installedConnectors\wmq.jmsra.rar\com.ibm.mq.jmqi.jar;
C:\Program Files\IBM\WebSphere\AppServer\installedConnectors\wmq.jmsra.rar\com.ibm.mq.connector.jar;
C:\Program Files\IBM\WebSphere\AppServer\installedConnectors\wmq.jmsra.rar\com.ibm.mq.commonservices.jar;
C:\Program Files\IBM\WebSphere\AppServer\installedConnectors\wmq.jmsra.rar\dhbcore.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\org.eclipse.emf.common.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\org.eclipse.emf.commonj.sdo.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\org.eclipse.emf.ecore.change.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\org.eclipse.emf.ecore.sdo.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\org.eclipse.emf.ecore.xmi.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\org.eclipse.emf.ecore.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.prereq.wsdl4j.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.wsfp.main.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.prereq.jackson.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.prereq.xlxp.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.prereq.jaxrs.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\javax.j2ee.jaxrs.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.jaxrs.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.prereq.vajava.jar;
C:\Program Files\IBM\WebSphere\AppServer\lib\rsadbutils.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.jpa.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.prereq.commonj-twm.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.prereq.soap.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\org.apache.tuscany.sca.api.jar;
C:\Program Files\IBM\WebSphere\AppServer\dev\sca\1.0\sca_api.jar;
C:\Program Files\IBM\WebSphere\AppServer\dev\xml\xmlapi.jar;
C:\Program Files\IBM\WebSphere\AppServer\plugins\com.ibm.ws.batch.runtime.jar;
C:\Program Files\IBM\WebSphere\AppServer\tivoli\tam\PD.jar;
C:\Program Files\IBM\WebSphere\AppServer\installedConnectors\wmq.jmsra.rar\com.ibm.mqjms.jar;
C:\Program Files (x86)\IBM\SDPShared\plugins\org.junit_4.8.1.v4_8_1_v20100427-1100\junit.jar;
C:\Program Files (x86)\IBM\SDPShared\plugins\org.hamcrest.core_1.1.0.v20090501071000.jar;
C:\Program Files\IBM\WebSphere\AppServer\runtimes\com.ibm.ws.ejb.embeddableContainer_8.0.0.jar;
/C:/Program Files/IBM/SDP/configuration/org.eclipse.osgi/bundles/1486/1/.cp/;
/C:/Program Files/IBM/SDP/configuration/org.eclipse.osgi/bundles/1484/1/.cp/;
/C:/Program Files/IBM/SDP/configuration/org.eclipse.osgi/bundles/1485/1/.cp/ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T14:58:03.897

WebSphere 可嵌入 EJB 容器中包含的 RAS 不使用 HPEL。此错误消息暗示您的类路径中的某些 JAR 正在使用不同的 RAS。您应该删除所有 WebSphere JAR，除了`C:\Program Files\IBM\WebSphere\AppServer\runtimes\com.ibm.ws.ejb.embeddableContainer_8.0.0.‌​jar`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:57:57.597

我能够摆脱这个问题是取消选中项目方面的运行时选择。

我在 JUint 中的配置如下

地图属性 = new HashMap(); properties.put(EJBContainer.PROVIDER, "com.ibm.websphere.ejbcontainer.EmbeddableContainerProvider"); 文件 jar = new File("./target/test_ejb.jar"); properties.put(EJBContainer.MODULES, jar); //可嵌入容器中配置的数据库属性 properties.put("com.ibm.websphere.embeddable.configFileName", "./target/test-classes/embeddable.properties"); EJBContainer ec = EJBContainer.createEJBContainer(properties);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-20T14:23:12.007

连接到 FileNet P8 时，我也遇到了这个错误。我需要：

*   com.ibm.ws.ejb.embeddableContainer_8.5.0.jar
*   com.ibm.ws.ejb.thinclient_8.5.0.jar
*   ibmorb.jar
*   com.ibm.ws.emf.jar
*   j2ee.jar
*   杰斯.jar

# jquery - jquery contains() 不起作用

> ID：15341340
> 
> 赞同：0
> 
> 时间：2013-03-11T14:40:12.077
> 
> 标签：jquery

我正在尝试使用 jquery contains，但它似乎没有显示任何元素。

HTML

```
 <ul class="token-input-list-facebook">
      <li class="token-input-token-facebook"><p>JavaScript</p></li>
      <li class="token-input-token-facebook"><p>Scheme</p></li>
  </ul> 
```

JS

```
 $(".token-input-list-facebook li p:contains('Javascript')"); 
```

小提琴：http: [//jsfiddle.net/cJmxf/](http://jsfiddle.net/cJmxf/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T14:41:19.447

[`:contains`区分大小写](http://api.jquery.com/contains-selector/)。尝试将“JavaScript”中的 S 大写。

[http://jsfiddle.net/mblase75/cJmxf/1/](http://jsfiddle.net/mblase75/cJmxf/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T14:49:00.993

尝试这个。

```
$("p:contains('JavaScript')").css("text-decoration", "underline"); 
```

# ruby-on-rails - 用 td 标签包围 simple_form 关联

> ID：15341343
> 
> 赞同：0
> 
> 时间：2013-03-11T14:40:17.590
> 
> 标签：ruby-on-rails, ruby-on-rails-3, associations, simple-form

好的，这是一个非常简单的问题，但对于我的生活，我在任何地方都找不到这个。我发现了一堆非常接近我需要但没有具体的东西。

所以这是我的看法：

```
<tbody>
    <% permissions.each do |permission| %>
    <tr>
      <td><%=  permission.label %></td>
      <%= simple_form_for permission do |f| %>
      <%= f.association :roles, as: :check_boxes, label: false, label_method:  lambda { |p| "" }, fields_element: "<td>" %>
      <% end %>
    </tr>
    <% end %>
    <%= debug(permissions) %>    
  </tbody> 
```

我只是想把每个角色放在自己的 TD 标签中。我有一种感觉，答案是如此简单，以至于没有人会费心发布任何关于它的东西。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:23:00.490

```
 = f.association :roles, as: :check_boxes, item_wrapper_tag: :td 
```

如果您使用的是 boostrap，请将此选项添加到输入中：`boolean_style: :inline`根据[https://github.com/plataformatec/simple_form/issues/685#issuecomment-10184181](https://github.com/plataformatec/simple_form/issues/685#issuecomment-10184181)

# python - 将 C 对象添加到 Python 列表并将 C 对象列表返回给 python

> ID：15341344
> 
> 赞同：1
> 
> 时间：2013-03-11T14:40:20.187
> 
> 标签：python, c, python-embedding

我正在为 python 编写 C 扩展。

我想知道如何使用`PyList_SetItem`. 例如，

我有一个 C 对象。

```
Atom *a = (Atom *)(PyTuple_GET_ITEM(tmp2, 0)); 
```

我列了一个清单：

```
PyObject* MyList = PyList_New(3); 
```

我不确定以下语句中的第三个参数必须是什么。

```
PyObject_SetItem(MyList, 0, a); 
```

另外，我如何将这个 C 对象列表返回给 python。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T15:26:52.893

第三个参数`PyList_SetItem`是要添加到列表中的 Python 对象，它通常是从 C 类型转换而来的，如下面的简单示例所示：

```
/* This adds one to each item in a list.  For example:
        alist = [1,2,3,4,5]
        RefArgs.MyFunc(alist)
*/
static PyObject * MyFunc(PyObject *self, PyObject *args)
{
   PyObject * ArgList;
   int i;

   PyArg_ParseTuple(args, "O!", &PyList_Type, &ArgList));

   for (i = 0; i < PyList_Size(ArgList); i++)
   {
      PyObject * PyValue;
      long iValue;

      PyValue = PyList_GetItem(ArgList, i);

      /* Add 1 to each item in the list (trivial, I know) */
      iValue = PyLong_AsLong(PyValue) + 1;

      /* SETTING THE ITEM */
      iRetn = PyList_SetItem(ArgList, i, PyLong_FromLong(iValue));

      if (iRetn == -1) Py_RETURN_FALSE;
   }

   Py_RETURN_TRUE;
} 
```

`PyObject_SetItem`很相似。不同之处在于`PyList_SetItem`窃取了引用，但`PyObject_SetItem`只是借用了它。 `PyObject_SetItem`不能与不可变对象一起使用，例如元组。

# c++ - 序列化类提升中的类

> ID：15341349
> 
> 赞同：2
> 
> 时间：2013-03-11T14:40:26.767
> 
> 标签：c++, class, boost-serialization

我尝试在`MFace`BOOST 的帮助下序列化一个类，

```
// class of the face
class MFace
{
     public:
         //constructor
         MFace();
     private:

    //! Vector of the face nodes
        mymath::Vector<DG::MNode*> Nodes;

        friend class boost::serialization::access;
        template<class Archive>
            void serialize(Archive & ar, const unsigned int version){
                //! Vector of the face nodes
                ar & Nodes;
            }
 }; 
```

但该类包含另一个类

```
mymath::Vector<MNode*> Nodes; 
```

所以，当我尝试写入`Nodes`存档时

```
//create a face
MFace Face;

//archive output file
std::ofstream ofs("output.txt");
boost::archive::text_oarchive ar(ofs);
// Write data to archive
ar & Face;
    ... 
```

编译器给了我一个错误

```
error: ‘class mymath::Vector<DG::MNode*>’ has no member named ‘serialize’ 
```

我应该向 MFace 使用的每个类（特别是 mymath::Vector 和 MNodes）添加另一个“序列化”并描述它应该做什么，还是有可能在 MFace 中解决它而不接触其他类？

包括的是

```
#include <boost/archive/text_oarchive.hpp>
#include <boost/archive/text_iarchive.hpp>
//contains mymath::Vector<>
#include "mymath/vector.h"

//containes MNodes
#include "MNode.h"
#include <fstream> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:22:39.067

这是如果我正确地记住了我的 boost 序列化...

您可以添加到 MFace 内部的序列化方法，如下所示：

```
void serialize(Archive & ar, const unsigned int version){
//of the face nodes
    for( <loop to travel through each node in the Nodes vector> )
    {
        ar & currentNode.var1;
        ar & currentNode.var2;
        ar & currentNode.var3;
    }
} 
```

这是假设 Node 对象内部的每个成员都是 boost 库可以序列化的类型。

然而，这样做的问题是您将 MFace 类与 MNode 类型完全耦合——也就是说，如果您向 MNode 添加一个成员，那么您必须记住将其添加到 MFace 类的序列化中。

此外，如果您将任何类型的复杂对象添加到 boost 不知道如何序列化的 MFace 类，那么您必须逐个成员序列化该成员。

序列化最好让每个对象都知道如何序列化自己——如何序列化的定义应该包含在每个类的 serialize() 方法中。

如果将 serialize 方法添加到 DG::MNode 类，这个问题应该会消失。

# java - 按数字对文本文件的行进行排序并按降序输出整行

> ID：15341350
> 
> 赞同：0
> 
> 时间：2013-03-11T14:40:27.117
> 
> 标签：java, android, sorting, text-files, scoring

我正在尝试通过使用此代码将名称和分数保存到文本文件来制作高分系统。

```
String text = name.getText().toString() + " " + score.getText().toString();
            appendLog(text);
        }
    });
}

public void appendLog(String text)
{       
   File logFile = new File("sdcard/logger.file");
   if (!logFile.exists())
   {
      try
      {
         logFile.createNewFile();
      } 
      catch (IOException e)
      {
         // TODO Auto-generated catch block
         e.printStackTrace();
      }
   }

   try
   {
      //BufferedWriter for performance, true to set append to file flag
      BufferedWriter buf = new BufferedWriter(new FileWriter(logFile, true)); 
      buf.append(text);
      buf.newLine();
      buf.close();
   }
   catch (IOException e)
   {
      // TODO Auto-generated catch block
      e.printStackTrace();
   } 
```

我有没有办法对每行中存在的分数进行排序并输出名称及其相应的分数？谁能帮我怎么做？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:43:19.620

让一行代表您的数据模型，即创建一个类，该类`Entry`将具有名称和分数作为其字段。然后您将获得这些对象的列表。编写一个**自定义比较器**以按分数降序对它们进行排序。仅此而已 =)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:33:07.240

正如@juvanis 在他的[回答](https://stackoverflow.com/a/15341415/1542438)中所说，创建一个类来表示每条记录，读取整个文件并将类对象生成到一个列表中，然后对列表进行排序并按排序顺序将对象写入文件中。

这是一个用于表示您的记录的类的示例，它由名称和分数组成。

```
public class Record {

    private int score;
    private String name;

    public getScore () {
        return score;
    }

    public getName () {
        return name;
    }

    public Record ( String name , int score ) {
        this.name = name;
        this.score = score;
    }

} 
```

为了对您的姓名和分数文件进行排序，请根据分数（我想您想将记录从最高分到最低分进行排序）使用此方法：

```
public void sortFile () {

    // Reference to the file
    File file = new File ( "sdcard/logger.file" );
    // Check if the file exists
    if ( ! file.exists () ) {
        // File does not exists
        return;
    }
    // Check if the file can be read
    if ( ! file.canRead () ) {
        // Cannot read file
        return;
    }
    BufferedReader bufferedReader = null;
    // The separator between your name and score
    final String SEPARATOR = " ";
    // A list to host all the records from the file
    List < Record > records = new ArrayList < Record > ();

    try {
        bufferedReader = new BufferedReader ( new FileReader ( file ) );
        String line = null;
        // Read the file line by line
        while ( ( line = bufferedReader.readLine () ) != null ) {
            // Skip if the line is empty
            if ( line.isEmpty () )
                continue;
            // Retrieve the separator index in the line
            int separatorIndex = line.lastIndexOf ( SEPARATOR );
            if ( separatorIndex == -1 ) {
                // Separator not found, file is corrupted
                bufferedReader.close ();
                return;
            }
            // Create a record from this line. It is alright if the name contains spaces, because the last space is taking into account
            records.add ( new Record ( line.substring ( 0 , separatorIndex ) , Integer.parseInt ( line.substring ( separatorIndex + 1 , line.length () ) ) ) );
        }
    } catch ( IOException exception ) {
        // Reading error
    } catch ( NumberFormatException exception ) {
        // Corrupted file (score is not a number)
    } finally {
        try {
            if ( bufferedReader != null )
                bufferedReader.close ();
            } catch ( IOException exception ) {
                // Unable to close reader
            }
    }
    bufferedReader = null;

    // Check if there are at least two records ( no need to sort if there are no records or just one)
    if ( records.size () < 2 )
        return;
    // Sort the records
    Collections.sort ( records , new Comparator < Record > () {
            @Override
            public int compare ( Record record1 , Record record2 ) {
            // Sort the records from the highest score to the lowest
                    return record1.getScore () - record2.getScore ();
            }
    } );

    // Replace old file content with the new sorted one
    BufferedWriter bufferedWriter = null;
    try {
        bufferedWriter = new BufferedWriter ( new FileWriter ( file , false ) ); // Do not append, replace content instead
        for ( Record record : records ) {
            bufferedWriter.append ( record.getName () + SEPARATOR + record.getScore () );
            bufferedWriter.newLine ();
        }
        bufferedWriter.flush ();
        bufferedWriter.close ();
    } catch ( IOException exception ) {
        // Writing error
    } finally {
        try {
            if ( bufferedWriter != null )
                bufferedWriter.close ();
        } catch ( IOException exception ) {
            // Unable to close writer
        }
    }
    bufferedWriter = null;

    // You can output the records, here they are displayed in the log
    for ( int i = 0 ; i < records.size () ; i ++ )
        Log.d ( "Record number : " + i , "Name : \"" + records.get ( i ).getName () + "\" , Score : " + records.get ( i ).getScore () );

} 
```

如果有什么你不明白的，请告诉我。如果它按您的预期工作正常，请尝试并让我保持最新状态。

# python - 从框架对象中获取文档字符串

> ID：15341352
> 
> 赞同：2
> 
> 时间：2013-03-11T14:40:29.427
> 
> 标签：python, introspection, inspect

我使用以下代码在[被调用方法中获取调用者的方法名称](https://stackoverflow.com/questions/900392/getting-the-caller-function-name-inside-another-function-in-python)：

```
import inspect

def B():
    outerframe = inspect.currentframe().f_back
    functionname = outerframe.f_code.co_name
    docstring = ??
    return "caller's name: {0}, docsting: {1}".format(functionname, docstring)

def A():
    """docstring for A"""
    return B()

print A() 
```

但我也想在被调用的方法中从调用者的方法中获取文档字符串。我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:44:31.767

你不能，因为你没有对*函数*对象的引用。具有属性的是函数对象，`__doc__`而不是关联的代码对象。

您必须使用文件名和行号信息来尝试对文档字符串可能是什么做出有根据的猜测，但由于 Python 的动态特性，不能保证它是正确和最新的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:44:16.720

我不一定会建议它，但您始终可以使用 globals() 按名称查找函数。它会是这样的：

```
import inspect

def B():
    """test"""
    outerframe = inspect.currentframe().f_back
    functionname = outerframe.f_code.co_name
    docstring = globals()[ functionname ].__doc__
    return "caller's name: {0}, docsting: {1}".format(functionname, docstring)

def A():
    """docstring for A"""
    return B()

print A() 
```

# ruby-on-rails - validates_uniqueness 关联 ruby on rails？

> ID：15341355
> 
> 赞同：0
> 
> 时间：2013-03-11T14:40:36.240
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有一个`Measure table`并且有以下字段

```
Class Measure < ActiveRecord::Base
  id
  Title
  Question_id
  Answer_id
  Answer_text
end 
```

我有`Package table`一列

```
Class Package < ActiveRecord::Base
  id
  Package_name
end 
```

我有`package_measure`桌子

```
Class PackageMeasure < ActiveRecord::Base
  belongs_to :measure, foreign_key: 'measure_id', primary_key: 'id', class_name: 'Measure'

  id
  package_id
  measure_id
end 
```

现在的问题是`Package_measure`表。我可以`measures`为单个选择多个`package`，我创建了一个`hash`并且它工作正常。我不想将相同添加`question_id`到相同的`package`. 我怎样才能做到这一点？

我想做如下的事情：

```
validates_uniqueness_of :package_id, :scope => measure.question_id 
```

# node.js - 使用nodejs进行远程模拟？

> ID：15341361
> 
> 赞同：1
> 
> 时间：2013-03-11T14:40:55.080
> 
> 标签：node.js, websocket

在客户端，我将进行物理模拟，用户将使用基于 HTML5 的交互式视图创建模拟参数。

模拟参数将被发送到服务器端，子 nodejs 进程将计算结果并发送回客户端。

模拟结果每隔一秒发送给客户端。

我知道我将使用 HTML5 websockets，是否有接近我想要做的原型类型或示例？还是 nodejs 模块？我不是在流式传输文件，而是每秒在一个 json 对象中发送计算。

另外，我应该在我的情况下使用 exec 还是 spawn child_process ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:35:43.907

您可能应该调查：

*   [套接字.io](http://socket.io)
*   [袜子](https://github.com/sockjs)
*   [鞋子](https://github.com/substack/shoe)

这些是用于轻松将 Websockets 与 Node.js 一起使用的实用程序。

此外，如果您的工作进程是用 Node.js 编写的，我建议使用该`cluster`模块来生成它们。否则，spawn 很酷。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T16:57:42.227

如果你想采取coffee-script和AMD风格的loader的方式，你可以看看[这个天气模拟](https://github.com/Wahlque/weather)。我认为这个模拟就像你需要的一样。更多详情如下...

基于以下软件包：

*   [zappajs](https://github.com/zappajs/zappajs) : socket.io 只是其中一个组件
*   [camel](https://github.com/mountain/camel)：具有一流 requirejs AMD 样式加载器和服务器端 WebWorkers 支持的服务器端咖啡脚本环境

关键点：

*   子nodejs进程将计算结果
    *   看这个[https://github.com/Wahlque/weather/blob/master/scripts/celestial-worker.coffee#L18](https://github.com/Wahlque/weather/blob/master/scripts/celestial-worker.coffee#L18)
*   和（结果）发回给客户
    *   看这个[https://github.com/Wahlque/weather/blob/master/scripts/celestial-worker.coffee#L25](https://github.com/Wahlque/weather/blob/master/scripts/celestial-worker.coffee#L25)

我们仍然希望涉及大量计算，但目前进展缓慢。

*   它是[https://github.com/Wahlque/weather/blob/master/sphere/atmosphere.coffee上的 PDE 求解器](https://github.com/Wahlque/weather/blob/master/sphere/atmosphere.coffee)
*   它将由[https://github.com/Wahlque/weather/blob/master/scripts/atmospheric-worker.coffee调用](https://github.com/Wahlque/weather/blob/master/scripts/atmospheric-worker.coffee)

# entity-framework - 嵌套集合的 EF Linq 投影 - 建立关系

> ID：15341364
> 
> 赞同：0
> 
> 时间：2013-03-11T14:41:05.250
> 
> 标签：entity-framework, linq-to-entities, entity-framework-5

我有一个两级嵌套子集合，我将其投影到 DTO 中。我的问题也适用于常规的父->子关系：

```
// There are two types on Parent and two types of Child classes,
// one is EF model, and another is DTO (here I show only one, for simplicity)
public class Parent
{
    public int Id {get;set;}
    public IEnumerable<Child> Children {get;set;}
}

public class Child
{
    public int Id {get;set;}
    public Parent Parent {get;set;}
}

var list = context.Set<Parent>().Select(p=> new DTO.Parent
    {
        Id = p.Id
        Children = (p.Children.Select(c=> new DTO.Child
            {
                Id=c.Id,
                Parent = ?
            }))
    }); 
```

在进行投影时是否可以为子对象分配父引用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:58:52.687

您可以通过 eagar-loading 子项使用 Automapper[进行映射：](http://automapper.org/)

```
Mapper.CreateMap<Parent, DTO.Parent>();
Mapper.CreateMap<Child, DTO.Child>();
var list = Mapper.Map<IEnumerable<DTO.Parent>>(context.Set<Parrent>()
                                                      .Include(p => p.Children)
                                                      .AsEnumerable()); 
```

Automapper 会将每个实体映射到 dto，并为每个 dto 子级提供对 dto 父实例的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T17:33:27.730

我认为不可能`Parent`直接在查询中设置。因此，这只是另一种解决方法，类似于“DTO 关系修复”：

```
public class Parent
{
    public int Id {get;set;}

    private IEnumerable<Child> _children;
    public IEnumerable<Child> Children
    {
        get { return _children; }
        set
        {
            _children = value;
            if (_children != null)
                foreach (var child in _children)
                    child.Parent = this;
        }
    }
} 
```

# objective-c - 为分组的静态 TableView 设置样式

> ID：15341366
> 
> 赞同：1
> 
> 时间：2013-03-11T14:41:08.987
> 
> 标签：objective-c, uitableview, tableview

我有一个分组单元静态 TableView，我想知道如何归档这个设计？边界和阴影。

![表视图](../Images/fd0483ff08fbe8e8275ae7b68bc790ab.png)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:53:08.657

如果没有自定义`drawRect`代码，您将无法更改单元格的背景。

有一个基于[此问题提供的答案的](https://stackoverflow.com/questions/400965/how-to-customize-the-background-border-colors-of-a-grouped-table-view)[GitHub 项目](https://github.com/sburlot/tableviewcellwithbkgnd)。

基本上，您必须根据单元格的位置（顶部、中间、底部）绘制三种不同类型的自定义单元格。我一直希望 iOS 的每个版本都能让您以更直接的方式做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T15:13:23.437

您可以更改单元格的 backroundView 值：

```
UIImage *image = [[UIImage imageNamed:@"image-name"] stretchableImageWithLeftCapWidth:5.0 topCapHeight:5.0];
UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height)];
[imageView setImage:image];
self.backgroundView = imageView;
[imageView release]; 
```

您也可以更改 selectedBackgroundView 值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T15:06:40.153

你必须 UITableViewCell 覆盖`drawRect`。

但是，这里有很好的图书馆。[漂亮的套件](https://github.com/vicpenap/PrettyKit)。

使用 this 您将能够轻松到达。

# php - 显示字段 Drupal 7 中的多个值

> ID：15341368
> 
> 赞同：1
> 
> 时间：2013-03-11T14:41:13.987
> 
> 标签：php, drupal-7, field

您好，我正在使用以下代码在用户配置文件中显示自定义字段。但是我只能让它一次显示一个值。如何从字段中提取多个值？该字段设置为无限整数字段。每个值都在它自己的行上。

```
<?php
    global $user;
    $user_data = user_load($user->uid);
    $test = $user_data->field_companies['und']['0']['value'];
    echo $test;
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:02:38.290

正确的方法是使用[`field_get_items()`](http://api.drupal.org/api/drupal/modules!field!field.module/function/field_get_items/7)函数：

```
$items = field_get_items('user', $user_data, 'field_companies');
foreach ($items as $item) {
  $val = $item['value'];
} 
```

遍历原始值数组是危险的，因为它忽略了语言方面的考虑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:43:51.393

```
foreach ($user_data->field_companies['und'] as $val) {
    // Do something with $val
} 
```

# c# - 调用线程无法访问此对象，因为不同的线程拥有

> ID：15341371
> 
> 赞同：1
> 
> 时间：2013-03-11T14:41:21.610
> 
> 标签：c#, multithreading, dynamic-data-display

我习惯`DynamicDataDisplay`了情节。我收到一条错误消息：**调用线程无法访问此对象，因为**当调试器点击以下行时，另一个线程拥有它：

```
Action AddLineGraph = delegate()
{    
    timeDomainPlotter.AddLineGraph(_ods,
        new Pen(_curveColors[_statsEnableIndex[i]], 2),
        new CirclePointMarker { Size = 5, Fill = _curveColors[_statsEnableIndex[i]] },
        new PenDescription(Convert.ToString(j)));
};

this.Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, AddLineGraph); 
```

我对此感到困惑，因为当我使用`LineGraph`以下方式绘制情节时：

```
Action AddLineGraph = delegate()
{
    timeDomainPlotter.AddLineGraph(_ods, 2, "Ch" + Convert.ToString(j) + _statsName[_statsEnableIndex[i]]);
};

this.Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, AddLineGraph); 
```

它运行良好。所以我想知道为什么绘制点标记会给出错误消息？谢谢。

`_curveColors`编辑：这是我在定义位置添加的更多编码。

```
public void InitiatePlot()
{
//  InitializeComponent();

    //   timeDomainPlotter.Legend.Remove();

    _initialChildrenCount = timeDomainPlotter.Children.Count;

    int count = timeDomainPlotter.Children.Count;

    //do not remove the initial children
    if (count > _initialChildrenCount)
    {
        for (int i = count - 1; i >= _initialChildrenCount; i--)
        {
            timeDomainPlotter.Children.RemoveAt(i);
        }
    }

//  _curveColors = new System.Drawing.Color[_nMaxStatsPerChannel];
    _curveColors = new Brush[_nMaxStatsPerChannel];

    for (int i = 0; i < _nMaxStatsPerChannel; i++)
    {

        _curveColors[i] = new SolidColorBrush((Color)ColorConverter.ConvertFromString(_colorList[i]));
    // _curveColors[i] = System.Drawing.Color.FromName(_colorList[i]);

    }

    _statsName = Enum.GetNames(typeof(Window1.ROISignalList));

    //_statsEnableIndex = new int[_nActiveStatsPerChannel];
    for (int j = 0; j < _nActiveChannels; j++)  // init data source structure
    {
    // count = 0;
        for (int i = 0; i < _nActiveStatsPerChannel; i++)
        {

            _ods = new ObservableDataSource<Point>();
            _odsAll[j * _nActiveStatsPerChannel + i] = _ods;   // _osdAll: C0S0 C0S1 C0S2 C1S0 C1S1 C1S2 ... C4S0 C4S1 C4S2

            Action AddLineGraph = delegate()
        {

            timeDomainPlotter.AddLineGraph(_ods,
                    new Pen(_curveColors[_statsEnableIndex[i]], 2),
                    new CirclePointMarker { Size = 5, Fill = _curveColors[_statsEnableIndex[i]] },
                    new PenDescription(Convert.ToString(j)));
        };
        this.Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, AddLineGraph);

        }
    }
} 
```

* * *

我找到了原因。就像 SpaceghostAli 提到的那样，_curveColors 确实是导致此错误的罪魁祸首。

我不得不说我没有完全弄清楚为什么，但是如果我用定义的颜色替换所有 _curveColors，问题就消失了。特别是，这是给出错误的代码：

```
Action AddLineGraph = delegate()
{

    timeDomainPlotter.AddLineGraph(_ods,
        new Pen(_curveColors[_statsEnableIndex[i]], 2),
        new CirclePointMarker { Size = 5, Fill = _curveColors[_statsEnableIndex[i]] },
        new PenDescription(Convert.ToString(j)));
};

this.Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, AddLineGraph); 
```

这是没有错误的代码：

```
Action AddLineGraph = delegate()
{

    timeDomainPlotter.AddLineGraph(_ods,
        //new Pen(_curveColors[_statsEnableIndex[i]], 2),
        new Pen( new SolidColorBrush(Colors.Transparent), 2),
        new CirclePointMarker { Size = 5, Fill = new SolidColorBrush(Colors.Green) },
        new PenDescription(Convert.ToString(j)));
};

this.Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, AddLineGraph); 
```

您只能看到 _curveColors 更改为确定性颜色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T16:20:06.297

我猜 _curveColors 不是在 UI 线程上创建的。您应该回溯并查看如何调用 InitiatePlot 并确保 UI 线程拥有 _curveColors。

# jquery - Jquery 类在 .html() 之后不可用

> ID：15341375
> 
> 赞同：-1
> 
> 时间：2013-03-11T14:41:28.340
> 
> 标签：jquery, html

因此，当我静态创建元素时，我使用了许多完美运行的 Jquery 插件。但是当通过创建元素`.html()`或`.append()`这些插件似乎不再工作时，我似乎无法弄清楚为什么。有什么提示吗？提前致谢。

因此，这是我要创建并向其中添加插件数据表的表的示例：

```
<a href="javascript:void(0)" title="" onclick="AddElements();">Add</a>
<div id="Container"></div>

<script>
function AddElements()
{
CodeSrouce = '<table cellpadding="0" cellspacing="0" border="0" class="dTable"><thead><th>Name</th><th>Id</th></thead><tbody>';
for(i=0;i<3;i++)
{
CodeSrouce += '<tr><td>'+Name[i]+'</td><td>'+Id[i]+'</td></tr>';
}
CodeSrouce += '</tbody></table>';
$("#Container").html(CodeSrouce);
}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:46:11.983

当插件被这样调用时：

```
$("#myElement").myPlugin(); 
```

该页面查找元素 myElement，然后将插件绑定到它。如果它找不到元素，那么您的代码将什么也不做。

因此，当您创建元素时，您需要在创建元素*后*运行代码。

```
$(function(){
  $("body").append("<ul id='myElement'><li>Hello</ul>");
});

$("#myElement").click(function(){
  console.log("This will never get triggered as it needs to be called after the     append"); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:47:32.503

使用 jQuery On 方法捕获动态创建的对象中的事件。普通事件处理程序不适用于动态创建的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T14:45:10.890

那是因为...动态创建的元素不会引用插件..

您可以在添加元素后再次调用该元素的插件...在 html() 或 append() 之后

例子..

对于日期选择器..

如果输入是动态附加的……说

```
 $("#whatever").append('<input id="test"/>'; 
```

即使`$('#test').datepicker();`在 document.ready 中，datepicker 也不会显示此附加输入，因为何时`datepicker`调用此元素在 DOMtree 中不存在，因此为此您需要在 append() 之后再次调用 datepicker 插件

```
$("#whatever").append('<input id="test"/>';
$('#test').datepicker(); 
```

# c++ - C++：无法用 new 实例化我的类

> ID：15341376
> 
> 赞同：1
> 
> 时间：2013-03-11T14:41:37.417
> 
> 标签：c++, types

使用 Eclipse CDT，我编写了一个抽象类“Lexer”，它驻留在共享库项目中。它由另一个共享库项目中的“UTF8Lexer”继承。为此，我创建了一个 UnitTest++ 测试项目，其中包含以下代码：

```
#include "UnitTest++.h"
#include "UTF8Lexer.h"
#include <fstream>

using namespace std;

programma::Lexer<UChar32, icu::UnicodeString>* getLexer(string sampleFile)
{
    string path = "../samples/" + sampleFile;

    ifstream* stream = new ifstream();
    stream->open (path.data());

    programma::UTF8Lexer l1(stream); //This line compiles fine.

    programma::UTF8Lexer* l2 = new  programma::UTF8Lexer(stream); // Error: "Type 'programma::UTF8Lexer' could not be resolved"

    return l2;
} 
```

我不明白为什么他喜欢 l1 的声明，但不喜欢 l2 的声明......通常不具体的错误消息并没有给我太多线索（虽然我是 C++ 新手，但我工作了很多使用 C# 并在我大学的计算机科学课程中用 C 语言做了一些事情......）。我认为它不能是任何缺失的引用或包含，因为它实际上处理 l1 声明......但是如果我在同一个源文件中创建一些其他类并以相同的方式实例化它，一切正常......

我使用[本教程](http://linuxtortures.blogspot.de/2012/02/shared-libraries-with-eclipse.html)将库连接到他们使用的项目，所以这应该没问题。

我也为此搜索了很多，但事实证明，要么不可能找到这个问题的特定搜索词，要么我发现了某种特殊情况......

以下是上述课程的一些摘录：

*   UTF8Lexer.h：

    ```
    #ifndef UTF8LEXER_H_
    #define UTF8LEXER_H_

    #include "unicode/unistr.h"
    #include "Lexer.h"
    #include <iostream>

    using namespace icu;

    namespace programma {

    class UTF8Lexer : public Lexer<UChar32, UnicodeString> {

    public:

        UTF8Lexer(std::istream* source);

        ~UTF8Lexer();
    ... 
    ```

*   UTF8Lexer.cpp：

    ```
    #include "UTF8Lexer.h"

    namespace programma {

    programma::UTF8Lexer::UTF8Lexer(std::istream* source)
    {
    }

    programma::UTF8Lexer::~UTF8Lexer() {

    }
    ... 
    ```

*   词法分析器.h：

    ```
    #ifndef LEXER_H_
    #define LEXER_H_

    #include "Token.h"

    namespace programma {

    template<typename C, typename S> class Lexer {
    public:
    ... 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:53:31.707

`programma::UTF8Lexer l1(stream);`可能被解析为`programma::UTF8Lexer l1(std::stream __Unnamed_Argument);`，即一个名为 的函数的声明`l1`。删除`using namespace std::`以解决此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T19:54:40.730

我发现是什么导致了我的麻烦：正确地将 'UTF8Lexer' 命名为 'UTFLexer' 解决了所有问题。但是，几个小时后，我和一位班员也遇到了同样的问题。在处理这个看似完全失效的 Eclipse/CDT/GCC 设置几分钟后，我有了重建项目索引的想法：只需右键单击项目，选择“索引”->“重建”。现在它起作用了。

# vb.net - 如何将 DownloadFileAsync 添加到 vb.net 中的更新程序

> ID：15341377
> 
> 赞同：1
> 
> 时间：2013-03-11T14:41:37.700
> 
> 标签：vb.net, asynchronous

我正在制作一个自动文件下载器，当我按下按钮时，我需要它重新下载并覆盖文件，但我不希望它在下载时挂起。我不知道如何为此代码实现 DownloadFileAsync。请帮忙！

这是我的代码：

```
 Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Button1.Enabled = False
        Button1.Text = "Updating..."
        WebBrowser1.Visible = True
        My.Computer.Network.DownloadFile _
          (address:="http://199.91.154.170/e9f6poiwfocg/pei02c8727sa720/Ultra+v08.zip", _
          destinationFileName:=Path.Combine(Environment.GetFolderPath( _
          Environment.SpecialFolder.ApplicationData), _
          "test/Test.zip"), _
          userName:=String.Empty, password:=String.Empty, _
          showUI:=False, connectionTimeout:=100000, _
          overwrite:=True)
        WebBrowser1.Visible = False
        Button1.Text = "Updated!"
        PictureBox1.Visible = True

    End Sub 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:55:15.493

您可以使用`System.Net.WebClient`以异步模式下载文件。

示例代码：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Dim client As New WebClient()
    AddHandler client.DownloadProgressChanged, AddressOf ShowDownloadProgress
    AddHandler client.DownloadFileCompleted, AddressOf OnDownloadComplete
    client.DownloadFileAsync(New Uri("http://199.91.154.170/e9f6poiwfocg/pei02c8727sa720/Ultra v08.zip"), "test/Test.zip")

End Sub

Private Sub OnDownloadComplete(ByVal sender As Object, ByVal e As AsyncCompletedEventArgs)
    If Not e.Cancelled AndAlso e.Error Is Nothing Then
        MessageBox.Show("DOwnload success")
    Else
        MessageBox.Show("Download failed")
    End If
End Sub

Private Sub ShowDownloadProgress(ByVal sender As Object, ByVal e As DownloadProgressChangedEventArgs)
    ProgressBar1.Value = e.ProgressPercentage
End Sub 
```

# actionscript-3 - 使用 adobe air 的 Ipad 应用程序在尝试在发布版本中加载图像时完全挂起

> ID：15341378
> 
> 赞同：0
> 
> 时间：2013-03-11T14:41:45.967
> 
> 标签：actionscript-3, air

我正在尝试从要部署在 Ipad 中的 AIR 应用程序的 url 加载 png 图像。我正在使用 air 3.6 下面是我的代码的简化版本：-

```
var loader:Loader = new Loader();
loader.contentLoaderInfo.addEventListener(flash.events.Event.COMPLETE, onIconLoaded);

loader.contentLoaderInfo.addEventListener(ErrorEvent.ERROR, function(event:ErrorEvent):void {
 trace('security sandbox error ignored');
});

var context:LoaderContext = new LoaderContext(false, ApplicationDomain.currentDomain);
trace("going for image load");
loader.load ( new URLRequest("some url"), context );

private function onIconLoaded(event:flash.events.Event):void 
{           
    trace("image loaded");
    var info:LoaderInfo = event.target as LoaderInfo;       
    addChild(info.content);

} 
```

这在 adobe flex builder 中运行良好（在 4.6 和 4.7 中尝试过）。完成快速包装后，它在 ipad 中也能正常工作。但是在执行“导出发布构建”之后，每当我尝试使用上面的代码片段下载图像时，整个应用程序都会被挂起。

谁能指出我可能是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T19:16:51.783

这可能与ANE有关。我只是有一个非常相似的经验，在调试模式下发布时一切正常，但是当发布 adHoc 或分发时，我的应用程序不会加载。

虽然我使用的是 Flash Pro，但这可能会有所帮助：

我通过在发布设置面板中删除对导入的 ANE 的任何引用解决了这个问题，并保存了我的项目。然后我退出 Flash Pro，重新启动它并加载我的 fla 文件并检查是否仍然没有对 ane 的引用。然后我再次添加了引用并成功发布了我的 adHoc 应用程序。听起来又快又容易，但我花了一天的时间才发现这一点！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T15:14:42.017

这是 adobe air 上的错误。AIR 3.4 存在问题。在 adobe 错误库中，此问题在错误 ID - 3320777 和错误 ID - 3519108 下进行跟踪。解决此问题的唯一方法是将您的第一个远程文件加载为图像文件。

# visual-studio - 不同行中的 Resharper 属性

> ID：15341382
> 
> 赞同：4
> 
> 时间：2013-03-11T14:41:52.003
> 
> 标签：visual-studio, attributes, resharper, line-breaks

我正在尝试将其配置为这样做：

“前”

```
[Att1(P1 = 10)]
[Att2]
[MyMethodOrProperty] 
```

“后”

```
[Att1(P1 = 10), Att2]
[MyMethodOrProperty] 
```

“但我想要”

```
[Att1(P1 = 10)]
[Att2]
[MyMethodOrProperty] 
```

我不想把属性放在同一行，我想保持不变。可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-30T21:29:53.010

此设置位于 ReSharper 选项中。在 ReSharper 7.1.3 中，它位于代码编辑 | C# | 格式样式 | 其他，并确保“在部分中加入或分离属性”设置为“分离”。

# android - 在 Roboguice 3 中注入 Android 应用程序会创建一个副本

> ID：15341386
> 
> 赞同：0
> 
> 时间：2013-03-11T14:42:05.187
> 
> 标签：android, roboguice

使用 Roboguice 3 时，我可以看到它的行为与版本 2 不同。当我有自定义 Application 对象时：

```
public class MyApplication extends Application
{
    ...
} 
```

然后在另一个班级：

```
@Inject
private MyApplication app; 
```

此代码注入另一个 MyApplication 对象，而不是在应用程序启动期间创建的对象。（在 Roboguice2 中并非如此）

捆绑：

```
public class InjectionModule extends AbstractModule
{
    @Override
    protected void configure()
    {
        bind(MyApplication.class).in(Singleton.class);
    }
} 
```

不会改变这种行为。

如何将全局 MyApplication 对象添加到容器中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T21:24:33.707

您将需要为此创建一个提供程序。在您的模块中将您的类绑定到提供者：`bind(MyApplication.class).toProvider(ApplicationProvider.class);`

您的提供者应如下所示：（尚未测试代码）

```
public class ApplicationProvider implements Provider<MyApplication> {
    @Inject 
    Context context;
    @Override
    public MyApplication get() {
         return (MyApplication) context.getApplicationContext();
    }
 } 
```

# linux - 当期望脚本内容被输入时，“交互”不起作用

> ID：15341388
> 
> 赞同：1
> 
> 时间：2013-03-11T14:42:07.303
> 
> 标签：linux, shell, expect

我正在构建一个简单的 ssh 登录包装工具来帮助自动登录到众多服务器中的一个。
它首先从用户输入中获取描述，然后提取相应的（最相关的）服务器 IP 和安全存储在某处的密码，并使用它创建一段期望脚本。

期望脚本看起来像这样：

```
    spawn ssh2 -q -t Bob@172.23.24.35
    预计 {
        "assword:" {发送 "Bob123\r"}
    }
    相互影响

```

当我通过管道将其传递给期望（期望可以从标准输入读取脚本）时，一切都很顺利，直到它达到“交互”。期望声称它接收到 eof 并立即终止。然后我将它存储到一个文件中说 tmp.exp 时发生同样的问题我做“expect < tmp.exp”。但是当我执行“expect -f tmp.exp”时，一切正常。

我认为原因是“交互”从 fd0 获取输入，该输入被我的程序（或 shell）重定向到管道。这是否意味着当我执行“expect < xx.exp”之类的操作时不能使用交互？有没有办法在“交互”命令之前将 fd0 恢复到真实终端？我用谷歌搜索了很多，我得到的只是'close_on_eof 0'之类的东西。我找不到它的含义，也找不到它是如何工作的。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T08:45:27.630

我只是想出了一个方法来做到这一点。看这个例子：

```
$ cat foo.exp
if {[catch {
    #  Close stdin and reopen it as /dev/tty. Then we are
    #+ connecting to a tty.
    close stdin
    open /dev/tty
} err]} {
    puts stderr $err
    exit 1
}

# Without this, inputed lines will be echo'ed twice.
set stty_init -echo
spawn bash --noprofile --norc

expect -re {bash-[.0-9]+(#|\$) }
interact

exit
$ expect < foo.exp
spawn bash --noprofile --norc
bash-4.2# ptree $$
705   screen -T dtterm -U
  24164 bash
    26826 expect
      26827 bash --noprofile --norc
        26830 ptree 26827
bash-4.2# exit
exit
$ 
```

为了让它更智能，我们需要在`stdin`开始时检查是否是 tty。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T03:00:18.337

不确定是否`Tcl`或`Expect`提供了一种内置方法来检查文件描述符是否为 tty。我是这样做的：

```
$ cat foo.exp
if { [catch { system {[[ -t 0 ]]} } error] } {
    puts "stdin is not a tty"
} else {
    puts "stdin is a tty"
}
$ expect foo.exp
stdin is a tty
$ expect < foo.exp
stdin is not a tty
$ 
```

# android - 水平滚动视图并聚焦在右侧

> ID：15341389
> 
> 赞同：0
> 
> 时间：2013-03-11T14:42:07.967
> 
> 标签：android, android-layout

我已经实现`horizontalscrollview`并且我习惯于`horizontalView.fullScroll(HorizontalScrollView.FOCUS_RIGHT`专注于最后一个元素。

我如何在 XML 中做到这一点？

# r - 列配对统计检验

> ID：15341392
> 
> 赞同：3
> 
> 时间：2013-03-11T14:42:22.043
> 
> 标签：r, dataframe

我有两个 data.frames 看起来像：

```
DF1      
  Col1     Col2     Col3    Col4    
 0.1854   0.1660   0.1997   0.4632
 0.1760   0.1336   0.1985   0.4496
 0.1737   0.1316   0.1943   0.4446    
 0.1660   0.1300   0.1896   0.4439

DF2       
  Col1     Col2     Col3    Col4    
 0.2456    0.2107   0.2688  0.5079
 0.2399    0.1952   0.2356  0.1143
 0.2375    0.1947   0.2187  0.0846    
 0.2368    0.1922   0.2087  0.1247 
```

我想在两个 data.frames 之间执行 wilcox.test ，特别是在成对的列之间，这样：

```
test1: between Col1 of DF1 and Col1 of DF2     
test2: between Col2 of DF1 and Col2 of DF2 
```

等等。

我使用了以下脚本：

```
for (i in 1:length(DF2)){ 
    test <- apply(DF1, 2, function(x) wilcox.test(x, as.numeric(DF2[[i]]), correct=TRUE))
} 
```

不幸的是，该脚本的输出与使用以下脚本执行的相同测试的输出不同：

```
test1 = wilcox.test(DF1[,1], DF2[,1],  correct=FALSE)     
test2 = wilcox.test(DF1[,2], DF2[,2],  correct=FALSE) 
```

由于在真实的 data.frames 中我有大约 100 列和 200 行（它们与维度相等）我不能按列制作测试列。

之后`dput(DF1)`：

```
structure(list(Col1 = c(0.1854, 0.1760, 0.1737, 0.1660,....),  class = "data.frame", row.names = c(NA, -100L))) 
```

同样对于`DF2`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T14:48:20.637

这是一个经典`mapply`案例——基本上只是一个多变量版本的`sapply`. 我们使用`mapply`依次遍历每个数据帧。首先，创建一些数据：

```
df1 = data.frame(c1 = runif(10), c2 = runif(10), c3 = runif(10), c4 = runif(10))
df2 = data.frame(c1 = runif(10), c2 = runif(10), c3 = runif(10), c4 = runif(10)) 
```

然后使用`mapply`

```
l = mapply(wilcox.test, df1, df2, SIMPLIFY=FALSE, correct=FALSE) 
```

这里的变量`l`是一个列表。所以，

```
wilcox.test(df1[,1], df2[,1],  correct=FALSE) 
l[[1]]
wilcox.test(df1[,2], df2[,2],  correct=FALSE) 
l[[2]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T14:50:03.383

使用 for 循环来循环列名可能更容易

```
for (name in colnames(DF2)){
    ...
    wilcox.test(DF1[,name], DF2[,name],  correct=FALSE))
    ...
} 
```

# c# - 读取文件，然后从另一个按钮 c# 使用它

> ID：15341396
> 
> 赞同：2
> 
> 时间：2013-03-11T14:42:35.997
> 
> 标签：c#, wav

我正在尝试组合一个表单应用程序来浏览和播放 WAV 文件。目前，它有两个按钮——一个是浏览和选择WAV，另一个是播放。我已经实现了浏览按钮，它工作正常。我通过在按钮内播放 WAV 声音来检查它，如您所见：

```
private void Browse_Click(object sender, EventArgs e) {
    OpenFileDialog tarik = new OpenFileDialog();
    tarik.Title = "Browse...";
    tarik.InitialDirectory = @"Desktop";
    tarik.Filter = "Wav files (*.wav)|*.wav";
    tarik.RestoreDirectory = true;
    if (tarik.ShowDialog() == DialogResult.OK) {
        textBox1.Text = tarik.FileName;
        Stream tarik2 = tarik.OpenFile();
        SoundPlayer snd = new SoundPlayer(tarik2);
        snd.Play();
    }
} 
```

我测试了代码并且它正在工作，但是当我尝试从另一个按钮调用“tarik”时：

```
private void Play_Click(object sender, EventArgs e) {} 
```

如上所示，它说我不允许这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T14:49:24.007

您在浏览处理程序中创建的变量是局部变量（它们应该是），这意味着一旦方法结束就无法访问它们（因为它们不存在）。

您需要创建一个在对象的整个生命周期中都存在的实例字段，以允许其他方法访问它：

```
//new instance field.
private string tarikFileName;

private void Browse_Click(object sender, EventArgs e)
{
    OpenFileDialog tarik = new OpenFileDialog();
    tarik.Title = "Browse...";
    tarik.InitialDirectory = @"Desktop";
    tarik.Filter = "Wav files (*.wav)|*.wav";
    tarik.RestoreDirectory = true;
    if (tarik.ShowDialog() == DialogResult.OK) {
        //store value in instance field
        tarikFileName = tarik.FileName;
        textBox1.Text = tarik.FileName;
        Stream tarik2 = tarik.OpenFile();
        using(SoundPlayer snd = new SoundPlayer(tarik2))
            snd.Play();
    }
}

private void Play_Click(object sender, EventArgs e)
{
    if(tarikFileName != null)
    {
        Stream stream = File.OpenRead(tarikFileName);
        using(SoundPlayer snd = new SoundPlayer(stream))
            snd.Play();
    }
} 
```

另请注意，`SoundPlayer`当您完成它时应该将其处理掉，所以我将它包装在一个`using`块中以确保发生这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T14:50:03.553

为了在这两种方法之间共享数据，您需要一些地方来存储引用。在您的情况下，我建议从`textBox1.Text`. 这样您就不必担心在多个地方管理（打开/关闭）流。

```
private void Browse_Click(object sender, EventArgs e)
{
    OpenFileDialog tarik = new OpenFileDialog();
    tarik.Title = "Browse...";
    tarik.InitialDirectory = @"Desktop";
    tarik.Filter = "Wav files (*.wav)|*.wav";
    tarik.RestoreDirectory = true;
    if (tarik.ShowDialog() == DialogResult.OK) {
        textBox1.Text = tarik.FileName;
    }
}

private void Play_Click(object sender, EventArgs e)
{
        using(Stream tarik2 = File.Open(textBox1.Text, FileMode.Open))
        {
            SoundPlayer snd = new SoundPlayer(tarik2);
            snd.Play();
        }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T14:53:15.527

我建议采用以下方法：

1.  将 声明`SoundPLayer`为`Form`.
2.  在`Browse`按钮的处理程序中获取文件名，创建一个流并`SoundPlayer`用它初始化你。
3.  在`Play`按钮的处理程序中`Play()`调用`SoundPlayer`.

# perl - ksh perl 脚本.. 如果条件

> ID：15341400
> 
> 赞同：0
> 
> 时间：2013-03-11T14:42:44.667
> 
> 标签：perl, ksh

朋友们...

我有 bash 脚本，它每次都调用 perl 脚本并通过电子邮件发送日志文件结果。

我想更改我的 bash 脚本，使其仅在 perl 子例程行计数器（rcounter++）中有值时才发送电子邮件，而不是所有时间。

有关如何更改 .ksh 文件的任何提示？

```
.ksh

#!/bin/ksh
d=`date +%Y%m%d`

log_dir=$HOME
output_file=log.list

if ! list_tables -login /@testdb -outputFile $output_file
   then    
      mailx -s "list report : $d" test@mail < $output_file
 fi

=======Below if condition also works for me=============================

  list_tables -login /@testdb -outputFile $output_file
 if ["$?" -ne "0"];
    then    
          mailx -s "list report : $d" test@mail < $output_file
 fi
======================================================================== 
```

Perl 脚本：list_tables

```
use strict;
use Getopt::Long;

use DBI;
use DBD::Oracle qw(:ora_types);

my $exitStatus = 0;
my %options = ()
my $oracleLogin;
my $outputFile;
my $runDate;
my $logFile;
my $rcounter;

($oracleLogin, $outputFile) = &validateCommandLine();

my $db = &attemptconnect($oracleLogin);

&reportListTables($outputFile);

$db->$disconnect;

exit($rcounter);

#---------------------------
sub reportListTables {

    my $outputFile = shift;

    if ( ! open (OUT,">" . $outputfile)) {
        &logMessage("Error opening $outputFile");
    }

    print OUT &putTitle;

    my $oldDB="DEFAULT";
    my $dbcounter = 0;
    my $i;

    print OUT &putHeader();

    #iterate over results
    for (my $i=0; $i<=$lstSessions; $i++) {
        # print result row
        print OUT &putRow($i);
        $dbCounter++;
    }

    print OUT &putFooter($dbCounter);
    print OUT "   *** Report End \n";

    closeOUT;
}

#------------------------------ 
sub putTitle {
    my $title = qq{
   List Tables: Yesterday
  --------------
};

#------------------------------
sub putHeader {
    my $header = qq{

   TESTDB
  ==============
    OWNER       Table   Created

};

#------------------------------
sub putRow {

    my $indx = shift;
    my $ln = sprintf "%-19s %-30s %-19s",
       $lstSessions[$indx]{owner},
       $lstSessions[$indx]{object_name},
       $lstSessions[$indx]{created};

return "$ln\n";

}

#------------------------------
sub getListTables {

    my $runDt = shift;
       $rcounter = 0;

    my $SQL = qq{
    selct owner, object_name, to_char(created,'MM-DD-YYYY') from dba_objects
    };

    my $sth = $db->prepare ($SQL) or die $db->errstr;

    $sth->execute() or die $db->errstr;;

    while (my @row = $sth->fethcrow_array) {
        $lstSessions[$rcounter] {owner}     =$row[0];
        $lstSessions[$rcounter] {object_name}   =$row[1];
        $lstSessions[$rcounter] {created}   =$row[2];

        &logMessage(" Owner:    $lstSessions[$rcounter]{owner}");
        &logMessage(" Table:    $lstSessions[$rcounter]{object_name}");
        &logMessage(" created:  $lstSessions[$rcounter]{created}");

        $rcounter++;
    }

    &logMessage("$rcounter records found...");

} 
```

谢谢..

如果这让生活更轻松，也很高兴在 perl 中包含 mail-x 部分..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:11:14.187

我不确定我是否正确理解了您的问题。另外，您的代码不完整。所以有一些猜测。

* * *

您*不能*从调用方检查本地 Perl 变量的值。

但是，如果您的问题是 Perl 代码是否在日志文件中添加了任何内容，则解决方案很简单：删除“rcounter records found...”行（无论如何它都没有意义，因为它*总是*执行，查询是否返回结果或不）。然后，让 shell 脚本在调用 Perl 之前备份日志文件，然后再做一个`diff`，只有在`diff`告诉你日志文件中添加了输出时才发送邮件。

如果这对您没有帮助，请澄清问题。

**编辑**（来自下面的评论）：

Shell 脚本编写并不难。现在，您的 Perl 脚本以：

```
$db->($exitStatus); 
```

那是您的退出代码。无论如何，您都不会在您的 shell 脚本中检查它，因此您可以将其更改为更有用的东西，例如写入的数据行数。一个原始的解决方案是通过在 Perl 脚本的顶部（例如 after ）声明它来使其成为`$rcounter`全局的（而不是局部的）。然后你可以简单地替换上面的“exitStatus”行：`getListTables()``my $logFile;`

```
$rcounter; 
```

瞧，您的 Perl 脚本现在返回写入的数据行数。

在 Perl 中，返回码 0 被认为是失败，任何其他值都是成功。在 shell 中，情况正好相反——但幸运的是，您不必担心这一点，因为 Perl 知道这一点，并且在返回调用 shell 时会“反转”（否定）脚本的返回码。

所以你所需要的只是让邮件依赖于 Perl 的非零返回：

```
if list_tables -login /@testdb -outputFile $output_file
then
    mailx -s "list report : $d" test@mail < $output_file
fi 
```

旁边的评论：在我看来，您的编程技能与您要解决的问题的范围不符。如果从 Perl 向 bash 返回一个值会给您带来这么多麻烦，那么您可能应该将时间花在教程上，而不是从数据库获取输入和发送电子邮件。在尝试飞行之前先学会走路...

# ios - 导航栏按钮单击事件在单击其下方区域时触发。

> ID：15341402
> 
> 赞同：6
> 
> 时间：2013-03-11T14:42:46.227
> 
> 标签：ios, cocoa-touch

![在此处输入图像描述](../Images/1d20e3782e4930d7098ec423057eb213.png)

我有带有自定义视图的导航栏作为右栏按钮项。自定义视图中有两个按钮。但是当我触摸右侧导航栏下方的区域时，它会触发按钮触摸事件。我已经通过更改背景颜色检查了按钮和视图的框架，所有这些都设置得很好。我检查了默认的 iOS 应用程序，如时钟、日历、设置、笔记等，它们都有相同的行为。在屏幕截图（默认 iOS 日历应用程序）中触摸红色矩形会触发按钮的触摸事件，我的应用程序也正在发生这种情况。

这是代码..

```
UIView* navigationButtonsView = [[UIView alloc] initWithFrame:CGRectMake(0.0f, 0.0f, 100.0f, 44.0f)];

UIButton *p = [UIButton buttonWithType:UIButtonTypeCustom];
[p setImage:[UIImage imageNamed:@"PBtn.png"] forState:UIControlStateNormal];
[p addTarget:self action:@selector(PButtonPushed:) forControlEvents:UIControlEventTouchUpInside];
[p setFrame:CGRectMake(43, 0, 57, 44)];
[navigationButtonsView addSubview:p];

UIButton *o = [UIButton buttonWithType:UIButtonTypeCustom];
[o addTarget:self action:@selector(oButtonPushed:) forControlEvents:UIControlEventTouchUpInside];
[o setFrame:CGRectMake(0, 0, 38, 44)];
[o setImage:[UIImage imageNamed:@"O.png"] forState:UIControlStateNormal];
[navigationButtonsView addSubview:o];

UIBarButtonItem *barItem = [[UIBarButtonItem alloc] initWithCustomView:navigationButtonsView];
[musicVC.navigationItem setRightBarButtonItem: barItem animated:NO]; 
```

如何更改导航栏按钮的默认 iOS 行为？因为 m 在这些按钮下方有一些 UI，因此它的顶部区域没有响应。提前致谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:56:05.007

这是正常行为 - 两个原因：

1.  iOS 不知道你的手指有多大——所以它必须决定在哪里触摸。在这种情况下，导航栏会覆盖表格视图。

2.  这可能与人机界面指南有关（对不起，没有链接。谷歌它）说最小可触摸区域必须是 44 像素。这种行为可能是试图符合这些要求的“UIBarButtonItem”。

# asp.net-mvc - 部分视图提交返回 null

> ID：15341403
> 
> 赞同：2
> 
> 时间：2013-03-11T14:42:48.920
> 
> 标签：asp.net-mvc, partial-views, razor-2

我正在尝试创建一个视图，它允许用户使用索引视图模型查看当前列出的项目，然后还允许用户使用单独的创建视图模型创建一个新项目

所以我有两个视图模型 -IndexFunkyThingsViewModel -CreateFunkyThingViewModel

本质上，我有一个主要观点：

```
@model IndexFunkyThingsViewModel
@foreach (var item in Model.FunkyThings)
{
/*Indexy stuff*/    
}

/*If create item*/
@if (Model.CreateFunkyThing)
{
@Html.Partial("_CreateFunkyThingPartial", new CreateFunkyThingViewModel());
} 
```

然后在我的部分观点中，我有

```
@model CreateFunkyThingViewModel
@using (Html.BeginForm(MVC.FunkyThings.CreateFunkyThing(Model)))
{
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>Create FunkyThing</legend>
        @Html.EditorForModel();
        <p>
            <input type="submit" class="button green" value="CreateFunkyThing" />
        </p>
    </fieldset>
} 
```

最后在控制器中我有：

```
[HttpPost]
public virtual ActionResult CreateFunkyThing(CreateFunkyThingViewModel createFunkyThingViewModel)
{
    ..
} 
```

这一切似乎编译得很愉快，当我进入视图时，它可以显示创建字段等。然而，当我点击提交按钮时，控制器没有收到任何数据。ActionResult 被调用，但是在调试器中，createFunkyThingViewModel 参数在被提交按钮调用时为空。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:58:41.763

发布到您的控制器时，您不会将模型发送给它。用这个：

```
 @using (Html.BeginForm("CreateFunkyThing", "ControllerName", FormMethod.Post)) 
```

然后从按钮周围删除 p 标签，不要使用任何东西。

段落标签倾向于将按钮与表单分开分组，即使它们位于同一个外部容器中。

# sql - 根据参数查询不同的表

> ID：15341404
> 
> 赞同：2
> 
> 时间：2013-03-11T14:42:56.390
> 
> 标签：sql, sql-server, sql-server-2008

我有一个存储过程，我想根据传入的参数查询生产表或“正在进行的工作”表。我可以编写两个单独的存储过程，但我认为这值得一试。

类似于：

```
create procedure getUserDetails
    @userID int,
    @prod varchar(5)
as 
    begin
        select * from
            if (@prod = 'true')
            Begin
                userprod_table
            else
                userwip_table
            end 
    where something = 'something'
END 
```

这是可能吗？我不想写 2 个几乎相同的 SP：-/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:46:20.687

为什么不使用`if(@prod = 'true')`如下的简单语句：

```
if (@prod = 'true')
begin
    select * from userprod_table where something = 'something'
end  else
begin
    select * from userwip_table where something = 'something'
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:57:51.937

您可以使用 CTE，以免重复您的主要查询

```
with usertable as
(
    select * from userprod_table where 1 = @flag
    union
    select * from userwip_table where 0 = @flag
)
select ... from usertable ... 
```

# python - Python中的无参数lambda？

> ID：15341410
> 
> 赞同：5
> 
> 时间：2013-03-11T14:43:03.813
> 
> 标签：python, lambda

有没有办法编码：

```
def fn():
    return None 
```

作为 lambda，在 Python 中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-11T14:44:11.833

是的，参数列表可以省略：

```
fn = lambda: None 
```

从[5.12 开始生产。拉姆达斯](http://docs.python.org/2/reference/expressions.html#lambda)是：

```
lambda_form     ::=  "lambda" [parameter_list]: expression 
```

方括号`parameter_list`表示可选元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T14:45:20.510

你必须这样做：

```
fn = lambda: None 
```

# opencv - 安装 octave 依赖项：tbb 失败

> ID：15341411
> 
> 赞同：1
> 
> 时间：2013-03-11T14:43:09.537
> 
> 标签：opencv, homebrew

在要点上找到了这个，认为在这里发布很有用： [https ://github.com/mxcl/homebrew/issues/18111](https://github.com/mxcl/homebrew/issues/18111)

在安装opencv时

```
==> Installing octave dependency: tbb
==> Downloading 
http://threadingbuildingblocks.org/sites/default/files/software_releases/source/

curl: (22) The requested URL returned error: 404
Error: Download failed:
http://threadingbuildingblocks.org/sites/default/files/software_releases/source/tbb41_20121003oss_src.tgz 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T14:43:09.537

```
brew update 
```

获取更正的 tbb URL。

# flash - 下载多个文件闪存

> ID：15341413
> 
> 赞同：0
> 
> 时间：2013-03-11T14:43:12.647
> 
> 标签：flash, apache-flex, filereference, urlloader

我有一个带有文件名的数据网格的 Flash 应用程序，我希望用户能够检查该网格中的多个文件并将它们下载到他的本地驱动器。这些文件存储在数据库中的 blob 字段中，我使用 php ro 检索它们。我试图使用 URLLoader 和 FileReference 来下载文件，但它不起作用。这是代码：

```
private function downloadSelected():void {
            var dp:Object=dg.dataProvider;
            var cursor:IViewCursor=dp.createCursor();

            while( !cursor.afterLast )
            {

                //Alert.show(cursor.current.IsChecked.toString());
                if (cursor.current.IsChecked.toString()=="true") {
                    //myAmostras.push(cursor.current.CodBarras.toString());
                    //nenhumaAmostra=false; 

                var u:URLRequest= new URLRequest;
                    var variables:URLVariables = new URLVariables();            
                    variables.amostras = cursor.current.CodBarras.toString();
                    variables.disposition="attach";
                    u = new URLRequest("savereports.php");
                    u.method = URLRequestMethod.POST;
                    u.data=variables;

                    pdfloader = new URLLoader();
                    //pdfloader.dataFormat=URLLoaderDataFormat.BINARY;
                    pdfloader.addEventListener(Event.COMPLETE, completeHandler,false,0,true);
                    pdfloader.addEventListener(IOErrorEvent.IO_ERROR, downloadError); 

                    try {
                        pdfloader.load(u);
                    } catch (error:Error) {
                        Alert.show("Unable to load requested document.");
                    }

                }
                cursor.moveNext();
            }   
        }

        private function downloadError(event:Event):void {
            Alert.show("Error loading file");
        }

        private function completeHandler(event:Event):void {

            var myFileReference:FileReference = new FileReference();

            myFileReference.save(event.target.data);

        } 
```

谁可以帮我这个事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T17:56:10.260

使用 FileReference.download 而不是 URLLoader，我可以下载在数据网格中选择的第一个文件，但其他文件抛出异常 Error#2041

```
 private function downloadSelected():void {
            var dp:Object=dg.dataProvider;
            var cursor:IViewCursor=dp.createCursor();

            var i:int=0;
            while( !cursor.afterLast )
            {
                if (cursor.current.IsChecked.toString()=="true") {

                    var u:URLRequest= new URLRequest;
                    var variables:URLVariables = new URLVariables();            
                    variables.amostras = cursor.current.CodBarras.toString();
                    variables.disposition="attach";
                    u = new URLRequest("savereports.php");
                    u.method = URLRequestMethod.POST;
                    u.data=variables;

                    try {

                        var myFileReference:FileReference = new FileReference();
                        myFileReference.download(u,cursor.current.CodBarras.toString()+".pdf");
                    } catch (error:Error) {
                        Alert.show("Unable to load " + cursor.current.CodBarras.toString()+".pdf" );
                    }

                }
                cursor.moveNext();
            }   
        } 
```

# c++ - 使用模板化仿函数段错误调用 printf（仅限 64 位，32 位中的 valgrind clean）

> ID：15341416
> 
> 赞同：4
> 
> 时间：2013-03-11T14:43:32.570
> 
> 标签：c++, templates, printf, functor

我目前正在调试一些 90 年代后期编写的 C++ 代码，这些代码解析脚本以加载数据、执行简单操作和打印结果等。

编写代码的人使用仿函数将它正在解析的文件中的字符串关键字映射到实际的函数调用，并且它们被模板化（最多 8 个参数）来处理用户可能在他们的请求中请求的无数函数接口脚本。

在大多数情况下，这一切都很好，除了近年来它开始在我们的一些 64 位构建系统上出现段错误。通过 valgrind 运行，令我惊讶的是，我发现错误似乎发生在“printf”内部，这是所说的仿函数之一。这里有一些代码片段来展示它是如何工作的。

首先，正在解析的脚本包含以下行：

```
printf( "%5.7f %5.7f %5.7f %5.7f\n", cos( j / 10 ), tan( j / 10 ), sin( j / 10 ), sqrt( j / 10 ) ); 
```

其中 cos、tan、sin 和 sqrt 也是对应于 libm 的函子（这个细节并不重要，如果我用固定数值替换它们，我会得到相同的结果）。

在调用 printf 时，它是通过以下方式完成的。首先，模板化函子：

```
template<class R, class T1, class T2, class T3, class T4, class T5, class T6, class T7, class T8>
class FType
{
    public :
        FType( const void * f ) { _f = (R (*)(T1,T2,T3,T4,T5,T6,T7,T8))f;  }
        R operator()( T1 a1,T2 a2,T3 a3,T4 a4,T5 a5,T6 a6,T7 a7,T8 a8 )
        { return _f( a1,a2,a3,a4,a5,a6,a7,a8); }

    private :
        R (*_f)(T1,T2,T3,T4,T5,T6,T7,T8);

}; 
```

然后调用它的代码在另一个模板类中——我展示了原型和使用 FType 的相关代码（以及我为调试而放入的一些额外代码）：

```
template<class T1, class T2, class T3, class T4, class T5, class T6, class T7, class T8>
static Token
evalF(
    const void *            f,
    unsigned int            nrargs,
    T1              a1,
    T2              a2,
    T3              a3,
    T4              a4,
    T5              a5,
    T6              a6,
    T7              a7,
    T8              a8,
    vtok &              args,
    const Token &           returnType )
{
  Token     result;

  printf("Count: %i\n",++_count);

  if( _count == 2 ) {
    const char *fmt = *((const char **) &a1);

    result = printf(fmt,a2,a3,a4,a5,a6,a7,a8);

    FType<int, const void*,T2,T3,T4,T5,T6,T7,T8>    f1(f);
    result = f1("Hello, world.\n",a2,a3,a4,a5,a6,a7,a8);
    result = f1("Hello, world2 %5.7f\n",a2,a3,a4,a5,a6,a7,a8);
    result = f1(fmt,a2,a3,a4,a5,a6,a7,a8);
  } else {
    FType<int, T1,T2,T3,T4,T5,T6,T7,T8> f1(f);
    result = f1(a1,a2,a3,a4,a5,a6,a7,a8);
  }
} 
```

我插入了 if(_count == 2) 位（因为这个函数被多次调用）。一般情况下，它只执行else子句中的操作；它使用“f”调用 FType 构造函数（将返回类型模板化为 int），“f”是 printf 的函子（在调试器中验证）。一旦 f1 被构造，它使用所有模板化参数调用重载的调用运算符，并且 valgrind 开始抱怨：

```
==29358== Conditional jump or move depends on uninitialised value(s)
==29358==    at 0x92E3683: __printf_fp (printf_fp.c:406)
==29358==    by 0x92E05B7: vfprintf (vfprintf.c:1629)
==29358==    by 0x92E88D8: printf (printf.c:35)
==29358==    by 0x5348C45: FType<int, void const*, double, double, double, double, void const*, void const*, void const*>::operator()(void const*, double, double, double, double, void const*, void const*, void const*) (Interpreter.cc:321)
==29358==    by 0x51BAB6D: Token evalF<void const*, double, double, double, double, void const*, void const*, void const*>(void const*, unsigned int, void const*, double, double, double, double, void const*, void const*, void const*, std::vector<Token, std::allocator<Token> >&, Token const&) (Interpreter.cc:542) 
```

因此，这导致了 if() 子句中的实验。首先，我尝试使用相同的参数直接调用 printf（注意带有参数 a1 的类型转换技巧 - 格式 - 以使其编译；否则它会抱怨许多没有 T1 的模板实例（char * ）正如 printf 所期望的）。这工作正常。

接下来，我尝试使用其中没有变量的替换格式字符串调用 f1（Hello，world）。这也很好用。

然后我添加其中一个变量（Hello，World2 %5.7f），然后我开始看到上面的 valgrind 错误。

如果我在 32 位系统上运行此代码，它是 valgrind clean（否则相同版本的 glibc、gcc）。

在几个不同的 Linux 系统（全 64 位）上运行，有时我会遇到段错误（例如 RHEL5.8/libc2.5 和 openSUSE11.2/libc-2.10.1），有时我不会（例如 libc2.15使用 Fedora 17 和 Ubunutu 12.04），但 valgrind 总是以类似的方式抱怨所有系统，这让我认为无论它是否崩溃都是侥幸。

这一切都让我怀疑 64 位 glibc 存在某种错误，尽管如果有人能发现这段代码有问题，我会更高兴！

我的一个预感是它以某种方式与变量参数列表的解析有关。这些究竟是如何与模板一起玩的？我实际上并不清楚这是如何工作的，因为它直到运行时才知道格式字符串，那么它如何知道在编译时要创建模板的哪些特定实例？但是，这并不能解释为什么在 32 位中一切看起来都很好。

**更新以回应评论**

感谢大家的有益讨论。我认为 awn 关于 %al 寄存器的答案可能是正确的解释，尽管我还没有验证它。无论如何，为了讨论的方便，这里有一个完整的、最小的程序，它可以在我的 64 位系统上重现错误，其他人可以使用。如果你`#define _VOID_PTR`在顶部，它使用 void * 指针来传递函数指针，就像在原始代码中一样（并触发 valgrind 错误）。如果您注释掉`#define _VOID_PTR`，它将改为使用 WhosCraig 建议的正确原型化的函数指针。这个案子的问题是我不能简单地说`int (*f)(const char *, double, double) = &printf;`因为编译器抱怨原型不匹配（也许我只是很厚，有办法做到这一点？-我猜这是原作者试图解决 void * 指针的问题）。为了处理这种特殊情况，我`wrap_printf()`使用正确的显式参数列表创建了这个函数。当我执行这个版本的代码时，它是 valgrind clean。不幸的是，这并没有告诉我们这是 void * 与函数指针存储问题，还是与 %al 寄存器相关的问题；我认为大多数证据都指向后一种情况，并且我怀疑`printf()`使用固定参数列表包装已迫使编译器做“正确的事情”：

```
#include <cstdio>

#define _VOID_PTR  // set if using void pointers to pass around function pointers

template<class R, class T1, class T2, class T3>
class FType
{
public :
#ifdef _VOID_PTR
  FType( const void * f ) { _f = (R (*)(T1,T2,T3))f; }
#else
  typedef R (*FP)(T1,T2,T3);
  FType( R (*f)(T1,T2,T3 )) { _f = f; }
#endif

  R operator()( T1 a1,T2 a2,T3 a3)
  { return _f( a1,a2,a3); }

private :
  R (*_f)(T1,T2,T3);

};

template <class T1, class T2, class T3> int wrap_printf( T1 a1, T2 a2, T3 a3 ) {
  const char *fmt = *((const char **) &a1);
  return printf(fmt, a2, a3);
}

int main( void ) {

#ifdef _VOID_PTR
  void *f = (void *)printf;
#else
  // this doesn't work because function pointer arguments don't match printf prototype:
  // int (*f)(const char *, double, double) = &printf;

  // Use this wrapper instead:
  int (*f)(const char *, double, double) = &wrap_printf;
#endif

  char a1[]="%5.7f %5.7f\n";
  double a2=1.;
  double a3=0;

  FType<int, const char *, double, double> f1(f);

  printf(a1,a2,a3);
  f1(a1,a2,a3);

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T16:10:59.877

通过 64 位 Linux（和许多其他 Unix）使用的 System V amd64 ABI，具有固定数量参数和可变数量参数的函数具有稍微不同的调用约定。

引用自《System V Application Binary Interface AMD64 Architecture Processor Supplement》Draft 0.99.5 [2]，第 3.2.3 章“参数传递”：

> 对于可能调用使用 varargs 或 stdargs 的函数的调用（无原型调用或对声明中包含省略号 (...) 的函数的调用）%al 用作隐藏参数以指定使用的向量寄存器的数量。

现在，3 步序列：

1.  printf(3) 就是这样一个可变参数函数。因此，期望 %al 寄存器被正确填充。

2.  您的 FType::_f 声明为指向具有固定数量参数的函数的指针。因此，当通过它调用某些东西时，编译器并不关心 %al。

3.  当通过 FType::_f 调用 printf() 时，它期望正确填充 %al（因为 1），但编译器并不关心填充它（因为 2），因此 printf() 会找到一个“垃圾”在%al.

使用“垃圾”而不是正确初始化的值可能很容易导致各种不需要的结果，包括您观察到的段错误。

如需更多信息，请参阅：
[1] [http://en.wikipedia.org/wiki/X86_calling_conventions#x86-64_calling_conventions](http://en.wikipedia.org/wiki/X86_calling_conventions#x86-64_calling_conventions)
[2] [http://x86-64.org/documentation/abi.pdf](http://x86-64.org/documentation/abi.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T07:43:27.203

如果您的编译器与 C++11 兼容，因此可以处理[可变参数模板](http://en.cppreference.com/w/cpp/language/parameter_pack)，并且可以重新排列参数的顺序，您可能可以执行以下操作：

```
template<typename F, typename ...A>
static Token evalF(vtok& args, const Token& resultType, F f, A... a)
{
    Token result;

    f(a...);

    return result;
} 
```

如果你看到[这个例子](http://ideone.com/ffMcJV)，效果很好。

# python - 读取特定字段的 txt 文件并将它们存储在 numpy 数组中

> ID：15341417
> 
> 赞同：1
> 
> 时间：2013-03-11T14:43:32.980
> 
> 标签：python, numpy

我有一个包含文本块的 txt 文件（基本上是一个日志文件）。每个块或段落都有关于事件的某些信息。我需要的是从每个块中仅提取特定信息并将其保存为数组或列表。

每个段落的格式如下：

```
id: [id] Name: [name] time: [timestamp] user: [username] ip: [ip_address of the user] processing_time: [processing time in seconds] 
```

示例段落可以是：

```
id: 23455 Name: ymalsen time: 03:20:20 user: ymanlls ip: 230.33.45.32 processing_time: 05 
```

我需要从每个块中提取的是：

```
 id:[]
 Name:[]
 processing_time: [] 
```

这样我为每个块的结果生成的数组将是：

```
array = [id, name, processing_time] 
```

一个问题是我的文本文件相当大，并且有数千条这样的记录。在 Python 中做我需要做的事情的最佳方法是什么（准确地说是 2.7）。一旦我有了每个数组（对应于每条记录），我会将它们全部保存在一个 ND numpy 数组中，就是这样。任何帮助将不胜感激。

这是我用来清楚地提取所有以 ID 开头的行的东西：

```
import string

log = 'log_1.txt'
file = open(log, 'r')

name_array = []

line = file.readlines()
for a in line:
    if a.startswith('Name: '):
        ' '.join(a.split())
        host_array.append(a) 
```

但它只是提取所有块并将它们放入单个数组中，考虑到我遵循 Id、name 等参数，这有点没用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:04:14.753

您可以使用 numpy 的出色`loadtxt`例程将数据加载到记录数组中，然后从那里提取：

```
import numpy as np

aa = np.loadtxt("proba.txt", usecols=(1, 3, 11), 
                dtype={"names": ("id", "name","proctime"),                       
                        "formats": ("i4", "a100", "i4")})
print aa["name"]
print aa["id"]
print aa["proctime"] 
```

该示例从 加载您的数据`proba.txt`并存储在`aa`. 如果您分别需要它们，则适当的元素 ( `aa["name"]`, `aa["id"]`, `ȧa["proctime"`) 会为您的每一列提供一个列表，否则，您已经将它们放在一个 numpy 数组中。上面的代码产生：

```
['ymalsen' 'ymalsen']
[23455 23455]
[5 5] 
```

对于`proba.txt`具有以下内容的文件：

```
id: 23455 Name: ymalsen time: 03:20:20 user: ymanlls ip: 230.33.45.32 processing_time: 05
id: 23455 Name: ymalsen time: 03:20:20 user: ymanlls ip: 230.33.45.32 processing_time: 05 
```

但是，请注意，这是假设字段内容（字段内）中没有出现空格。不过，字段之间的空格很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:45:11.737

如果名称字段可以包含空格，您可以使用正则表达式提取日期。但是，您必须自己将值转换为相应的 python 类型。以下程序：

```
import numpy as np
import re

PAT = re.compile(r"""id:\s*(?P<id>\d+)\s*
                     Name:\s*(?P<name>[0-9A-Za-z ]+?)\s+time:.*
                     processing_time:\s*(?P<ptime>\d+)""", re.VERBOSE)

values = []
fp = open("proba.txt", "r")
for line in fp:
    match = PAT.match(line)
    if match:
        values.append(( int(match.group("id")),
                        match.group("name"),
                        int(match.group("ptime"))))
fp.close()
print values 
```

将打印结果：

```
[(23455, 'y malsen', 5), (23455, 'ymalsen', 5)] 
```

对于包含内容的文件“proba.txt”

```
id: 23455 Name: y malsen time: 03:20:20 user: ymanlls ip: 230.33.45.32 processing_time: 05
id: 23455 Name: ymalsen time: 03:20:20 user: ymanlls ip: 230.33.45.32 processing_time: 05 
```

# cruisecontrol.net - CCNet - 自动强制先决条件构建

> ID：15341418
> 
> 赞同：0
> 
> 时间：2013-03-11T14:43:42.880
> 
> 标签：cruisecontrol.net

如果我有两个构建，A 和 B，我如何设置 CCNet，以便当 B 被强制时，它会在继续 B 的构建步骤之前自动强制 A 构建？

我见过 ForceBuildPublisher，但是它看起来像是用于依赖构建而不是先决构建。

我还看到了“launchccnetbuild”nant 任务的页面，但代码文件似乎丢失了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T09:38:35.047

恐怕没有“好”的方式。如果您可以让项目 B 等待项目 A 开始和**完成**，则 ForceBuildPublisher 将起作用。对于后一种存在多种可能性，一种是轮询文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T16:08:33.597

正如 Lothar_K 提到的那样，没有“好”的方式。通常当需要这种情况时，来自 Build A 的构建脚本（在你的情况下是 nant 任务）被复制\合并到来自 Build B 的 nant 任务。

另一种方法是根据您的 CCNet 版本使用[顺序任务。](http://confluence.public.thoughtworks.org/display/CCNET/Sequential+Task)

# ember.js - Ember——TypeError：arrangedContent.addArrayObserver 不是函数

> ID：15341429
> 
> 赞同：3
> 
> 时间：2013-03-11T14:44:12.510
> 
> 标签：ember.js, ember-data

我正在尝试用 ember 构建一个简单的类别浏览器。我有两个非常简单的观点。当用户访问时，`/`他们将看到所有类别的列表，当他们单击该列表中的类别时，他们将被定向到`#/10`10 是 id 的位置。

我的问题是，当用户单击`/`路线上的类别时，我收到以下错误

```
TypeError: arrangedContent.addArrayObserver is not a function
[Break On This Error]   

didChange: 'arrangedContentArrayDidChange' 
```

如果我在路由处刷新页面，`#/10`则会对我的后端进行正确的 api 调用`/api/categories?parent=99`。在过渡期间引发此错误的我可能做错了什么？下面是我的代码的完整示例。

模板：

```
<script type="text/x-handlebars">
  {{outlet}}
</script>

<script type="text/x-handlebars" data-template-name="categories">
    {{#each category in controller}}
        <p>{{#linkTo 'category' category}}{{ category.name }}{{/linkTo}}</p>
    {{/each}}
</script>

<!--this is an array instead of object -->
<script type="text/x-handlebars" data-template-name="category">
    {{#each category in controller}}
        <p>{{category.name}}</p>
    {{/each}}
</script> 
```

Javascript：

```
var App = Ember.Application.create();

App.Router.map(function(){
    this.resource('categories', { path : '/' });
    this.resource('category', { path : '/:category_id' });
});

App.CategoriesRoute = Ember.Route.extend({
    model: function(){
        return App.Category.find();
    }
});

//this is causing the error possibly
    App.CategoryRoute = Ember.Route.extend({
        model: function(params){
            return App.Category.find({parent: params.category_id});
        }
    });

App.CategoryController = Ember.ArrayController.extend();

// Models
App.Store = DS.Store.extend({
  revision: 11,
  adapter: 'DS.RESTAdapter'
});

DS.RESTAdapter.configure("plurals", {
  category: "categories"
});

App.Category = DS.Model.extend({
  name: DS.attr('string'),
  parent_id: DS.attr('number')
}); 
```

**调试信息：**

```
DEBUG: Ember.VERSION : 1.0.0-rc.1
DEBUG: Handlebars.VERSION : 1.0.0-rc.3
DEBUG: jQuery.VERSION : 1.9.0 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T15:54:11.383

**提示：**写完这篇文章后，我意识到你可能没有得到正确的模型钩子。当您通过 url 进入您的应用程序时，将调用此钩子。它将 URL 转换为适当的模型，并使用此模型转换为 Route。**我猜你认为这个 model() 钩子会用 {{#linkTo}} 的参数调用？不是这种情况！**

这不起作用，因为您将单个模型传递给模板中的 #linkTo 助手。所以 Ember 想要将这个单一对象设置为 ArrayController 的内容。这会导致您的错误。你的模型钩子返回一个数组。**经验法则：您应该始终将相同的数据结构传递给您在模型挂钩中返回的#linkTo。**

因此，我建议使用事件而不是 linkTo 并执行以下操作：

```
<script type="text/x-handlebars" data-template-name="categories">
    {{#each category in controller}}
        <p {{action 'showParentCategory' category}}>{{category.name}}</p>
    {{/each}}
</script>

App.CategoriesRoute = Ember.Route.extend({
    model: function(){
        return App.Category.find();
    },
    events: {
      showParentCategory : function(parentCategory){
        var cats = App.Category.find({parent: parentCategory.get("category_id")});
        this.transitionTo("category", cats);
      }
    }
}); 
```

**我在这里做了什么？**

1.  我创建了一个名为“showParentCategory”的操作。
2.  由于这是关于路由的操作，因此我正在您的 CategoriesRoute 中处理此事件。如您所见，事件/动作处理程序是在您的路由的 events 属性中声明的。
3.  我在那里执行与您的模型挂钩中相同的逻辑，然后我使用获取的类别手动调用transitinTo。

**更新：如何序列化** 通过实现序列化，您是在告诉 Ember 将什么放入您的 url。

```
App.CategoryRoute = Ember.Route.extend({
    model: function(params){
        return App.Category.find({parent: params.category_id});
    },
    serialize : function(models){
        var first = models.objectAt(0);
        return {
            category_id : first.get("parentId")
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-17T09:16:50.487

如果您对数值执行 #each 而不是对模板中的数组内容执行此操作，则会出现此问题。

我的“民意调查”模型中有一个数值计数。我在迭代，

{{#each poll in content.count}} {{/each}}

我认为，我们只能在 ember 数组上使用#each。

# php - 将 url 映射到子域 (NGINX)

> ID：15341430
> 
> 赞同：0
> 
> 时间：2013-03-11T14:44:15.963
> 
> 标签：php, configuration, nginx, subdomain, configuration-files

我知道这个问题[之前已经在 SO 上提出过，](https://stackoverflow.com/questions/14711666/mapping-subdomains-to-urls-with-nginx)但我无法在我的服务器上复制它。

我要做的是当用户访问时`medicine.example.com`，子域应该映射到`example.com/sites/medicine`. 所以用户看到的 URL 是`medicine.example.com`. index.php 通过 PHP 被剥离。

下面的代码给了我一个`502 bad gateway`错误。

```
server {
    listen      80;
    listen      443 ssl;
    server_name medicine.example.com;

    location / {
        rewrite             ^([^.]*[^/])$ $1/ permanent;
        proxy_pass_header   Set-Cookie;
        proxy_pass          https://example.com/sites$request_uri;
    }
} 
```

理想情况下，解决方案将是基于通配符/正则表达式的，这样不仅`medicine.example.com`可以映射。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:13:00.847

额外的路径将自动转发到上游服务器。所以不需要附加$request_uri。Nginx 很简单。

```
location / {
    proxy_pass     http://example.com/sites/medicine
} 
```

[编辑] 上游服务器也不需要使用 https，因为它浪费了 ssl 协商的资源。使用 http 更好，因为您的上游服务器是内部的。交通很安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T08:20:38.740

我相信如果您希望浏览器中的 URL 保持不变，则无需重写。所以你只需要这个（@Jack 在 $uri 前面有一个额外的 / ）。

$scheme 应该根据用户输入的内容返回 http 或 https

```
server {
    listen      80;
    listen      443 ssl;
    server_name medicine.example.com;

    location / {
        proxy_pass     $scheme://example.com/sites/medicine$request_uri
} 
```

这是 $uri 与 $request_uri 的链接。基本上 $uri 不包括参数。 [http://wiki.nginx.org/HttpCoreModule#.24request_uri](http://wiki.nginx.org/HttpCoreModule#.24request_uri)

# cakephp - CakePHP - 管理多个文件上传字段并正确处理它们

> ID：15341432
> 
> 赞同：1
> 
> 时间：2013-03-11T14:44:17.300
> 
> 标签：cakephp, upload

很长一段时间以来，我一直在烦恼并寻找解决方案。

我正在计划一个使用 CakePHP 的假期报价数据库。到目前为止，数据关系工作正常。现在我有一个掩码“添加报价”，应该可以在不同的字段中上传多个图像，例如有这些字段可用：

```
Name: 
Location:
Image 1:
Image 2:
Image 3:
Image 4: 
```

我将如何处理提供的每个字段的文件上传并将其插入到数据库中的正确字段中？我考虑过多个上传字段，但客户不希望这样。有开关盒的可能解决方案吗？

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:49:44.247

只需像客户要求的那样创建多个字段。

但是将它们存储`$this->data`为一个数组，但要执行以下操作。

```
echo $this->Form->input('image.' , array('type' => 'file' , 'label' => 'image 1'));
echo $this->Form->input('image.' , array('type' => 'file' , 'label' => 'image 2')); 
```

不要忘记图像后的点

现在`pr($this->data)`你会得到类似下面的东西

```
Model => {
image => { 
[1] =>{image info error etc}
[2] =>{image info error etc}
}} 
```

# c++ - 关于时间成本，哪个更昂贵：移动还是重写？C++11

> ID：15341433
> 
> 赞同：1
> 
> 时间：2013-03-11T14:44:23.600
> 
> 标签：c++, c++11, move, dynamic-memory-allocation

让我们假设我有一堆“未使用”的动态对象。每次我需要一个新对象时，我都会使用其中一个“未使用”对象作为新请愿的占位符。就像是：

```
template<typename T>
class my_list
{
public:
   template<typename... Args>
   T* newObject(Args&&... args)
   {
       if (unused.empty())
          return new T(forward<Args>(args)...);
       else {
          auto* newbie = unused.top();
          unused.pop();

          newbie = new (newbie) T(forward<Args>(args)...); // l. X

          return newbie;
       }
   }

private:
   stack<T*> unused; 
```

};

问题是，在第 X 行，什么更有效，书面句子，或者：

```
*newbie = std::move(T(forward<Args>(args)...)); 
```

这意味着，哪一个更省时，调用 a `new`with `newbie`as 地址（避免请求新内存）或简单地移动一个新的临时对象来覆盖原始对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:05:26.877

这是另一个可行的选择。它的优点是，虽然完美转发仍然需要 C++11，但它可以使用尚未更新的库代码来实现移动构造和赋值。

```
T(forward<Args>(args)...).swap(*newbie); 
```

此外，您的移动分配调用已经有一个临时对象，无需显式使其可移动。

```
*newbie = T(forward<Args>(args)...); 
```

与“先销毁，然后就地构建”的方法相比，这些方法中的任何一个都可以更容易地提供异常安全。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T15:05:15.700

是不必要的`move`，因为构造函数调用会临时创建一个纯右值。您的问题归结为哪个更有效：

```
newbie->~T();
new (newbie) T(std::forward<Args>(args)...); 
```

或者

```
*newbie = T(std::forward<Args>(args)...); 
```

假设`T`有一个正确编写的移动赋值运算符，如果有的话，可能几乎没有区别；就副作用而言，`T`在第一种情况下，在构造函数之前调用析构函数，在第二种情况下调用之后，但没有理由相信这会比另一种更影响性能。后者可能会导致更原始的值副本，但任何体面的优化编译器都会消除它们。

在没有性能测试表明前者显着提高性能的情况下，您应该更喜欢后者，因为它更具可读性，并且更容易使异常安全。

# javascript - 使用 Firefox 在嵌套 iframe 上调用 JS 函数

> ID：15341437
> 
> 赞同：0
> 
> 时间：2013-03-11T14:44:31.007
> 
> 标签：javascript, firefox, iframe

我制作了一个处理在线信用卡支付的网站。作为支付过程的一部分，我的网站需要一个 iframe，它与外部安全服务一起验证信用卡数据。我需要将特定信息传递给此 iframe，它将在表单帖子中使用。我通过在此 iframe 上调用一个函数从我的站点执行此操作，如下所示：

```
var frame = window.frames["SecureFrame"];
frame.SetInnerFormValues(...); 
```

这在我的开发环境中运行良好。但是，我的网站还需要在任何客户网站上作为 iframe 运行。所以最后，客户端站点会有一个指向我的支付接口的 iframe，其中有一个指向安全服务的 iframe。当然，这两个 iframe 都使用 SSL。

这似乎给客户端的多个嵌套框架造成了问题。（好吧，Chrome 可以正常工作，但 Firefox 不行）

当最终用户在客户端站点上时，执行我上面的 JS 代码时会发生错误。Firefox 抛出错误，提示“TypeError：frame.SetInnerFormValues 不是函数”。我尝试在 JS 控制台中执行一些代码以尝试在安全框架上访问此 SetInnerFormValues 函数，但我得到的只是“错误：权限被拒绝访问属性'...'”，而只是尝试访问任何内容我自己的网站第一。

拜托，忍者，我需要你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:52:34.663

由于 iFrame 是从另一个网站加载的，因此您不能对其进行常规的 javascript 函数调用。那将是[跨站点脚本（XSS）](http://en.wikipedia.org/wiki/Cross_site_scripting)。您需要在服务器上设置一个接口来响应 SSL 保护 (https:) POST 请求，以确保用户信息的安全。

# java - 搜索文件以查找编码标签

> ID：15341438
> 
> 赞同：0
> 
> 时间：2013-03-11T14:44:31.733
> 
> 标签：java, file, search

我有一个文件需要搜索编码标签，并检索它们识别的数据。标签长度为 4 字节，标识可变长度的 ascii 字符串或以 Little-Endian 编码的两字节整数值。

这些标签似乎都在 4 字节边界上，并且都在文件开头的前 2000 个字节内。我尝试了各种搜索文件的方法。唯一有效的是使用十进制整数值逐字节比较。

在 SO 上找到了一个解决方案，但并不完全针对这个问题：indexOfSubList()。我试过这个测试，但结果是-1。

```
byte[] needle = {68,73,67,77};
byte[] hayStack = {00, 01, 68,73,67,77, 11, 45};
location = Collections.indexOfSubList(Arrays.asList(hayStack), Arrays.asList(needle)); 
```

我绝不会拘泥于这段代码，并且会感激任何其他想法或解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:59:38.293

你的问题有点含糊，你的意思是这样的：

```
// simplified way of identifying tag by first byte of it,
// make it more complex as needed
byte startOfTag = 65;

// for loop assumes tags start at even 4 byte boundary, if not, modify loop
for(int i = 0; i <= data.length-4 ; i += 4) {
    if (data[i] == startOfTag) {
        myTagHandlerMethod(data[i], data[i+1], data[i+2], data[i+3]);
    }
} 
```

* * *

你得到 -1 `Collections.indexOfSubList`，因为`Arrays.asList`它不像你期望的那样工作`byte[]`：它返回`List<byte[]>`，而不是`List<Byte>`。容器必须包含对象引用，不允许未装箱的数字类型......这应该有效：

```
Byte[] needle = {68,73,67,77};
Byte[] hayStack = {00, 01, 68,73,67,77, 11, 45};
location = Collections.indexOfSubList(Arrays.asList(hayStack), Arrays.asList(needle)); 
```

* * *

如果您想在操作原始类型数组时避免重新发明轮子，您可以使用[Google 的 Guava 库](https://code.google.com/p/guava-libraries/wiki/PrimitivesExplained#Primitive_array_utilities)。例如，它有一个`indexOf`您可以在此处使用的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T14:55:03.750

通过将`byte`数组转换为`Byte`数组，您将获得所需的结果：

```
Byte[] needle = { 68, 73, 67, 77 };
Byte[] hayStack = { 00, 01, 68, 73, 67, 77, 11, 45 };
location = Collections.indexOfSubList(Arrays.asList(hayStack),
    Arrays.asList(needle));

// location now equals 2 
```

这是因为`Arrays.asList`它不像你想象的那样对`byte[]`物体进行操作。它返回 a`List<byte[]>`而不是 a `List<Byte>`。

# android - 接受线程上的 IOException

> ID：15341445
> 
> 赞同：7
> 
> 时间：2013-03-11T14:44:47.123
> 
> 标签：android, bluetooth, ioexception, iobluetooth

我的应用程序的一部分通过蓝牙连接到设备，通常工作正常，但偶尔无法连接，我收到以下错误

```
03-11 10:29:20.328: E/BluetoothComService(8059): accept() failed
03-11 10:29:20.328: E/BluetoothComService(8059): java.io.IOException: Operation Canceled
03-11 10:29:20.328: E/BluetoothComService(8059):    at android.bluetooth.BluetoothSocket.acceptNative(Native Method)
03-11 10:29:20.328: E/BluetoothComService(8059):    at android.bluetooth.BluetoothSocket.accept(BluetoothSocket.java:316)
03-11 10:29:20.328: E/BluetoothComService(8059):    at android.bluetooth.BluetoothServerSocket.accept(BluetoothServerSocket.java:105)
03-11 10:29:20.328: E/BluetoothComService(8059):    at android.bluetooth.BluetoothServerSocket.accept(BluetoothServerSocket.java:91)
03-11 10:29:20.328: E/BluetoothComService(8059):    at com.mypackage.name.bluetooth.BluetoothService$AcceptThread.run(BluetoothService.java:298) 
```

这是我得到异常的行

```
socket = mmServerSocket.accept(); 
```

这是完整的 AcceptThread

```
private class AcceptThread extends Thread {
    // The local server socket
    private BluetoothServerSocket mmServerSocket;
    public boolean successInit = false;

    public AcceptThread() {
        closeAllConnections();

        /*
         * if(mmServerSocket != null) { try { mmServerSocket.close(); } catch
         * (IOException e) { e.printStackTrace(); } }
         */
        BluetoothServerSocket tmp = null;

        // Create a new listening server socket
        while (!successInit) {
            try {
                tmp = mAdapter
                        .listenUsingRfcommWithServiceRecord(NAME, MY_UUID);

                successInit = true;
            } catch (Exception e) {

                successInit = false;
            }
        }

        /*
         * try { tmp = mAdapter.listenUsingRfcommWithServiceRecord(NAME,
         * MY_UUID); successInit= true; } catch (IOException e) { Log.e(TAG,
         * "listen() failed", e); tmp = null; successInit = false; }
         */
        mmServerSocket = tmp;
    }

    public void run() {
        if (D)
            Log.d(TAG, "BEGIN mAcceptThread" + this);
        setName("AcceptThread");
        BluetoothSocket socket = null;

        // Listen to the server socket if we're not connected
        while (mState != STATE_CONNECTED) {
            try {
                // This is a blocking call and will only return on a
                // successful connection or an exception
                mAdapter.cancelDiscovery();

                socket = mmServerSocket.accept();
            } catch (IOException e) {
                Log.e(TAG, "accept() failed", e);
                Log.e("Error", "This isn't connecting");
                break;
            }

            // If a connection was accepted
            if (socket != null) {
                synchronized (BluetoothService.this) {
                    switch (mState) {
                    case STATE_LISTEN:
                    case STATE_CONNECTING:
                        // Situation normal. Start the connected thread.
                        connected(socket, socket.getRemoteDevice());
                        break;
                    case STATE_NONE:
                    case STATE_CONNECTED:
                        // Either not ready or already connected. Terminate new
                        // socket.
                        try {
                            socket.close();
                        } catch (IOException e) {
                            Log.e(TAG, "Could not close unwanted socket", e);
                        }
                        break;
                    }
                }
            }
        }
        if (D)
            Log.i(TAG, "END mAcceptThread");
    }

    public void cancel() {
        if (D)
            Log.d(TAG, "cancel " + this);
        try {
            mmServerSocket.close();
        } catch (IOException e) {
            Log.e(TAG, "close() of server failed", e);
        }
    }
} 
```

这是我在开始时调用的函数`AcceptThread`，希望关闭所有内容以重新启动它

```
public void closeAllConnections() {
    if (mmInStream != null) {
        try {mmInStream.close();}
        catch  (Exception e){Log.e(TAG, "close() of connect socket failed", e);}
    }
    if (mmOutStream != null) {
        try {mmOutStream.close();}
        catch (Exception e){Log.e(TAG, "close() of connect socket failed", e);}
    }
    if (mmSocket != null) {
        try {
            mmSocket.close();
            //mmSocket.connect();
        }
        catch (IOException e) {
            Log.e(TAG, "close() of connect socket failed", e);
        }
    }
} 
```

我已经阅读了[蓝牙文档](http://developer.android.com/guide/topics/connectivity/bluetooth.html)和 SO 问题，但我没有找到任何适合我的东西，这让我有点困惑，因为这是我第一次通过 BT 连接。

**笔记**

发生这种情况时，我发现的唯一“修复”是关闭 BT 适配器，强制关闭程序，重新启动 BT 适配器并重新启动应用程序，这显然是不好的。我尝试以编程方式重新启动适配器，但仍然无法连接。

谁能看到我的 BlutoothService 类中可能有什么问题，该类`AcceptThread`位于何处？或者我将如何解决这个问题？谢谢！

# 更新

事实上，似乎连接有时在一个上关闭`Thread`并试图在另一个上重新连接。问题是我无法弄清楚是什么导致它尝试单独连接`Thread`或在发生这种情况时如何修复它。

我可以成功重现此问题的唯一方法是，如果我的 BT 设备已关闭，那么我将关闭 BT 适配器。当我重新打开一切时，我得到了异常并且无法连接。我有客户随机和定期发生这种情况，所以我希望这些问题是相关的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-23T19:20:10.087

好吧，我的部分问题是硬件问题，被发现是第三方制造商的问题。他们的固件不太正确，当它读取 BT 地址时，它偶尔会被损坏。

在软件方面，它定期`AcceptThread`在两个独立的环境中运行。`Threads`我要解决的问题是创建一个函数来关闭套接字和输入/输出流......

```
public void closeAllConnections()
    {
        if (mmInStream != null)
        {
            try {mmInStream.close();}
            catch  (Exception e){Log.e(TAG, "close() of connect socket failed", e);}
        }
        if (mmOutStream != null)
        {
            try {mmOutStream.close();}
            catch (Exception e){Log.e(TAG, "close() of connect socket failed", e);}
        }
        if (mmSocket != null)
        {
          try {
                mmSocket.close();
                Log.e("TAG", "close() of connect socket successfu;");
              } catch (IOException e) {
                   Log.e("TAG", "close() of connect socket failed", e);}
        } 
```

然后在课堂上，我注意到在尝试重新启动服务之前`BluetoothCom`并不总是检查 BT 对象是否存在。`null`

```
private void setupService() {

    // Initialize the BluetoothChatService to perform bluetooth connections
    if((mChatService != null) && (mChatService.getState() != 0)) {
        mChatService.stop();        
    }

    // I didn't have this so it would always start a new instance of the Service
    if (mChatService == null)
        mChatService = new BluetoothService(mHandler);

    mChatService.start();
} 
```

这似乎有所帮助，我不再有这些问题。但是，现在在三星 Galaxy Tab 4 上进行测试，我再次遇到连接问题，但仅限于此设备。也许这些信息可以帮助某人，如果我对新问题有任何其他了解，我会更新我的答案。

*注意：如上所述，此蓝牙应用程序使用来自 Android 的 BluetoothChat 应用程序的修改代码。*

另外，我已经阅读（并注意到）不同的制造商以不同的方式实现 BT 堆栈，这可能会导致头痛（至少如果您对此了解不够的话）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T15:08:37.517

虽然这是旧帖子，但我最近接触了同样的问题，所以我想写下我解决它的方法。

您的代码似乎来自 Google 示例 BlutoothChat（因为它看起来相同，如果我误解了，请见谅）。我还创建了基于此示例的自己的应用程序（API 级别 10）。如果我尝试将一台设备连接到另一台设备，我会遇到 accept() 失败问题，但最后我通过简单地删除 MainActivty 中的一些代码来解决这个问题

在 Google 示例主要活动中，它包含许多活动更改时的方法（开始、暂停等）。

原始代码有这个

```
@Override
public synchronized void onResume() {
    super.onResume();
    if(D) Log.e(TAG, "+ ON RESUME +");
    if (mChatService != null) {
        if (mChatService.getState() == ChatService.STATE_NONE) {
          mChatService.start();
        }
    }
} 
```

此代码启动聊天服务并运行 AcceptThread 以侦听传入连接。

当应用程序启动时，此方法将被调用“一次”并创建 AcceptThread。如果您执行任何其他使主要活动 onPause() 暂停的操作（在 Google 示例案例中，如果您单击菜单以启动 device_list 活动，则主要活动将暂停），当应用程序返回主要活动时，它将调用 create AcceptThread 方法“再一次”，这会导致问题，因为一个线程已经在运行但您尝试中断它。最后发生 accept() 失败错误并抛出 java.io.IOException: Operation Canceled 错误。

所以为了避免这种情况，只需删除 OnResume() 中的代码

```
@Override
public synchronized void onResume() {
    super.onResume();
    if(D) Log.e(TAG, "+ ON RESUME +");
} 
```

或者如果你不想删除任何代码，因为你害怕引起一些问题，把这个代码 (mChatService != null) mChatService.stop(); 在...

```
@Override
public synchronized void onPause() {
    super.onPause();
    if (mChatService != null) mChatService.stop();
    if(D) Log.e(TAG, "- ON PAUSE -");
} 
```

两者在我的项目中都很完美。方法 1 如果活动恢复，则不创建新线程，方法 2 如果您离开当前活动，则终止所有线程，如果您已经有一个，则断开所有当前连接（一旦您返回，它将再次启动线程）。方法 1 不会返回任何错误，但是如果您离开当前活动，方法 2 会再次抛出 accept fail，所以我建议使用方法 1。

需要注意的是，此错误通常发生在您修改 Google 示例 BlutoothChat 之后，它永远不会出现在原始应用程序上。

我看到很多帖子谈论这个问题，但没有看到任何人提出这个答案，所以只想分享这个。希望这会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T16:18:46.173

当 BluetoothServerSocket 关闭或垃圾收集时，应该会发生该异常。我怀疑异常发生在线程的旧副本上。就像这样：当您创建新线程时，旧线程被取消，因此 BluetoothServerSocket 已关闭，因此正确接受失败并出现该错误。在调试器中检查这一点和/或记录各种事件发生在*哪个线程上；*例如，在接受后的行上设置断点，也许在取消函数上，然后检查那里的线程ID——异常是否发生在前一个线程上？

# url - 资源前面的 // 的名称或术语是什么？

> ID：15341446
> 
> 赞同：0
> 
> 时间：2013-03-11T14:44:49.463
> 
> 标签：url, uri

所以[http://cdnjs.com/](http://cdnjs.com/)和我的一些同行都推荐我们使用`//`前面的资源。这个术语或技术叫什么？据我了解，目的是这样`http`或被`https`保留。但是，当我想在谷歌上说`yepnope`与它的兼容性时，我该怎么称呼它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T14:45:58.313

它是一个“相对 URL”——在这种情况下，一个没有协议部分的 URL（因此它使用其父文档中的协议），就像`/foo.html`一个没有协议或服务器名称部分的相对 URL（因此使用协议和服务器其父文档）。

协议相关 URL 的目的是它们可以在文档之间移植（`http`并且`https`短一点）。因此，如果您有：

```
<link rel="stylesheet" href="//cdnjs.cloudflare.com/etc.css"> 
```

...在页面上`http://example.com`，URL 扩展为

```
http://cdnjs.cloudflare.com/etc.css
```

...但如果它在页面上`https://example.com`，它会扩展为

```
https://cdnjs.cloudflare.com/etc.css
```

...并且您不会从浏览器中收到“混合的安全和不安全内容”警告。

一个轻微的缺点是，如果您使用直接从文件系统打开的文件进行一些快速而肮脏的本地测试，它们的协议是`file:`，因此 URL 最终是

```
文件：//cdnjs.cloudflare.com/etc.css
```

...这可能不是指您计算机上的有效资源（并导致关于 SO 的问题）。

更多关于我的博客：[*跳过协议*](http://blog.niftysnippets.org/2011/01/skipping-protocol.html)

# c# - 在c#中用图像替换文本

> ID：15341448
> 
> 赞同：1
> 
> 时间：2013-03-11T14:44:55.273
> 
> 标签：c#, asp.net

那是我的代码：

```
[WebMethod]
public static void SendChatMessage(string msg, int ToClient)
{
    if (msg != null && ToClient != 0)
    {
        if (msg.Contains(":-)")) msg.Replace(":-)", "<img src='Styles/emojie/smile.png'   />  ");
        else if (msg.Contains(":-(")) msg.Replace(":-(", "<img src='Styles/emojie/sad.png'   />  ");
        else if (msg.Contains(":'-(")) msg.Replace(":'-(", "<img src='Styles/emojie/cry.png'   />  ");
        else if (msg.Contains(":-$")) msg.Replace(":-$", "<img src='Styles/emojie/shy.png'   />  ");
        int FromClientID = Convert.ToInt32(HttpContext.Current.Session["ClientID"]);
        string query = "insert into chat (FROM_CLIENT,TO_CLIENT,CHAT_MSG) values (" + FromClientID + "," + ToClient + ",'" + msg + "')";
        new SQLHelper(SQLHelper.ConnectionStrings.WebSiteConnectionString).Insert(query);
    }
} 
```

味精按原样发送到数据库，而不是替换我做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-11T14:46:06.723

您假设`Replace`修改了现有的* 字符串。它没有。它返回一个带有修改的*新字符串。*它必须这样做，因为字符串在 .NET 中是不可变的。*您可能*希望更改字符串（等）的所有*字符串*操作实际上都返回一个新的。*`Substring``ToUpper`*

 *所以你所有的电话都是这样的：

```
msg.Replace(...); 
```

应该是：

```
msg = msg.Replace(...); 
```

您*还*应该开始使用参数化 SQL，而不是将所有值直接放入 SQL 查询中。这将使您的代码更具可读性，避免[SQL 注入攻击](http://bobby-tables.com)，并消除大量数据类型转换问题。

此外，我会在每个`if`语句上使用大括号，并将语句放在单独的行中：

```
if (msg.Contains(":-)"))
{
     msg = msg.Replace(":-)", "<img src='Styles/emojie/smile.png'   />  ");
} 
```

哦，由于这些陈述，目前您只会进行*一*组替换。如果您已经更换了，您真的不想更换吗？真的没有必要先检查......我只是无条件地将电话链接在一起：`msg``if / else``:-(``:-)``Contains`

```
msg = msg.Replace(":-)", "<img src='Styles/emojie/smile.png'/> ")
         .Replace(":-(", "<img src='Styles/emojie/sad.png'/> ")
         .Replace(":'-(", "<img src='Styles/emojie/cry.png'/> ")
         .Replace(":-$", "<img src='Styles/emojie/shy.png'/> "); 
```

简单得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T14:47:04.063

调用`string.Replace`实际上并不会更改字符串，因此您需要重新分配它：

```
msg = msg.Replace( ... ); 
```*

# android - 在点击的视图下方显示下拉列表

> ID：15341458
> 
> 赞同：2
> 
> 时间：2013-03-11T14:45:33.403
> 
> 标签：android, android-spinner

![在此处输入图像描述](../Images/5ff82b9e6cdbe73701baf22ecd23ca85.png)

我如何提出这个观点。我检查了 Spinner 和 PopUp 窗口，但我没有做...请向我推荐任何示例...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T15:03:31.130

您应该选择 Android QuickAction 小部件。

![垂直快速动作](../Images/eb32ea3ab1369b281a5d6b5d3f1c8782.png)

![在此处输入图像描述](../Images/98e211dc54afb229b23dd0fe96e6a355.png)

这是 GithUb 的一个开源项目。

[https://github.com/lorensiuswlt/NewQuickAction3D](https://github.com/lorensiuswlt/NewQuickAction3D)

[https://github.com/alhneiti/Android-QuickAction](https://github.com/alhneiti/Android-QuickAction)

希望这会帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T14:49:22.273

我已经使用 a 实现了这种行为`PopUpWindow`，这是我的代码：

```
// The method that displays the popup.
private void showStatusPopup(final Activity context, Point p) {

   // Inflate the popup_layout.xml
   LinearLayout viewGroup = (LinearLayout) context.findViewById(R.id.llStatusChangePopup);
   LayoutInflater layoutInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
   View layout = layoutInflater.inflate(R.layout.status_popup_layout, null);

   // Creating the PopupWindow
   changeStatusPopUp = new PopupWindow(context);
   changeStatusPopUp.setContentView(layout);
   changeStatusPopUp.setWidth(LinearLayout.LayoutParams.WRAP_CONTENT);
   changeStatusPopUp.setHeight(LinearLayout.LayoutParams.WRAP_CONTENT);
   changeStatusPopUp.setFocusable(true);

   // Some offset to align the popup a bit to the left, and a bit down, relative to button's position.
   int OFFSET_X = -20;
   int OFFSET_Y = 50;

   //Clear the default translucent background
   changeStatusPopUp.setBackgroundDrawable(new BitmapDrawable());

   // Displaying the popup at the specified location, + offsets.
   changeStatusPopUp.showAtLocation(layout, Gravity.NO_GRAVITY, p.x + OFFSET_X, p.y + OFFSET_Y);
} 
```

这是弹出式布局：

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<ImageView
    android:layout_marginLeft="11dp"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@drawable/devider_popup_task_status_change" 
    android:contentDescription="@drawable/devider_popup_task_status_change"/>

<TextView
    android:id="@+id/tvInProgress"
    android:paddingLeft="10dp"
    android:layout_weight="1.0"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:textColor="@color/my_black"
    android:gravity="center_vertical"
    android:clickable="true"
    android:onClick="popupStatusChangeOnClick"
    android:layout_marginLeft="11dp"
    android:layout_marginRight="4dp"
    android:text="@string/inprogress"/>

<ImageView
    android:layout_marginLeft="11dp"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@drawable/devider_popup_task_status_change" 
    android:contentDescription="@drawable/devider_popup_task_status_change"/>

<TextView
    android:id="@+id/tvOnTheWay"
    android:paddingLeft="10dp"
    android:layout_weight="1.0"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:textColor="@color/my_black"
    android:gravity="center_vertical"
    android:clickable="true"
    android:onClick="popupStatusChangeOnClick"
    android:layout_marginLeft="11dp"
    android:layout_marginRight="4dp"
    android:text="@string/ontheway"/>

<ImageView
    android:layout_marginLeft="11dp"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@drawable/devider_popup_task_status_change" 
    android:contentDescription="@drawable/devider_popup_task_status_change"/>

<TextView
    android:id="@+id/tvComplete"
    android:paddingLeft="10dp"
    android:layout_weight="1.0"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:textColor="@color/my_black"
    android:gravity="center_vertical"
    android:clickable="true"
    android:onClick="popupStatusChangeOnClick"
    android:layout_marginLeft="11dp"
    android:layout_marginRight="4dp"
    android:text="@string/complete"/>

<ImageView
    android:layout_marginLeft="11dp"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@drawable/devider_popup_task_status_change" 
    android:contentDescription="@drawable/devider_popup_task_status_change"/>

<TextView
    android:id="@+id/tvFailed"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:paddingLeft="10dp"
    android:layout_weight="1.0"
    android:gravity="center_vertical"
    android:clickable="true"
    android:onClick="popupStatusChangeOnClick"
    android:layout_marginLeft="11dp"
    android:layout_marginRight="4dp"
    android:layout_marginBottom="11dp"
    android:text="@string/failed"
    android:textColor="@color/my_black" /> 
```

当`ImageView`'s 只有 1 个像素的分隔符时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-22T11:18:52.410

你问的是一个[Spinner ，但你也可以使用“](http://developer.android.com/reference/android/widget/Spinner.html) [ListPopupWindow](http://developer.android.com/reference/android/widget/ListPopupWindow.html) ”制作自己的弹出列表

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T15:34:38.503

你也可以使用微调器-

```
 String[] branch={"NEW","prev",...};
 ArrayAdapter<String> list;
 spinner=(Spinner) findViewById(R.id.spinner);
    list=new ArrayAdapter<String>(this,android.R.layout.simple_spinner_item,branch);
    spinner.setAdapter(list);
    spinner.setOnItemSelectedListener(new OnItemSelectedListener() {

        @Override
        public void onItemSelected(AdapterView<?> arg0, View arg1,
                int arg2, long arg3) {
                        } 
```

# php - 获取文本或数据库翻译

> ID：15341460
> 
> 赞同：5
> 
> 时间：2013-03-11T14:45:37.800
> 
> 标签：php, mysql, translation, gettext

哪个更好：

1.  获取文本
2.  自定义基于 MySQL+缓存的功能

Gettext 是一种内置功能，因此我认为它已针对性能进行了调整。使用 poedit 很痛苦，不可能向任何客户展示。

自定义功能允许简单的翻译界面。但可能对 php/db 的使用很重。

我想，你什么时候会用哪一个？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-11T16:00:32.023

本地化很困难。这真的很难。不仅仅是`"pairs of words" => "Wortpaare"`，它比这复杂得多。大多数人在看到 gettext 并感到*“呃，丑陋”*时忘记的是，本地化*过程*比实现的技术细节重要得多。那是因为实际的翻译人员通常不是程序员，甚至可能不是内部人员。这导致的头痛比你想象的要多得多。gettext 真的很老了，经过实战考验，背后有一个巨大的工具链，经过调整以支持这个过程。如果你想正确地做 i18n 和 l10n，你需要一个强大的系统。gettext 就是这样，并且得到了广泛工具的支持。您的 Homebrewed Translation System™ 不会。

首先，您需要一个强大的系统来*提取*可翻译的字符串。由于无法自动且可重复地从源代码中提取可翻译字符串，您需要为每个要翻译的新字符串做大量工作。在 gettext 中，`xgettext`这样做。

接下来，您需要一个工具来将提取的字符串与已经存在的翻译同步，这样就不会丢失任何翻译，并且如果可能的话，只保留稍微更改的翻译。在 gettext 中，`msgmerge`这样做。

接下来，您需要一种向字符串添加额外信息的方法。您希望能够按类别、“域”和上下文对它们进行分组，您可能希望为翻译者添加对源代码的注释，并且您可能希望翻译者能够向翻译添加注释。gettext 支持所有这些。

接下来，您需要一种能够从各种工具中获得良好支持的文件格式，因为您可能会将文件发送到中国以便在那里进行翻译。您可能将它们发送给外部翻译的原因也是您需要一个好的同步工具来合并更改的原因，因为这可能是一个非常异步的过程。PO 文件得到很好的支持，因为 gettext 太老了。根据您的具体需求，有许多开源和商业工具在多个层面支持本地化过程。

不要低估本地化的任务，选择一个非常适合该过程的工具并学习它。gettext 是一个很棒的工具，虽然它不是最适合初学者的。

值得一提的是，这是[我的 Twig 的 gettext 扩展](https://github.com/deceze/Twig-extensions/blob/master/doc/gettext.rst)，它使 PHP 的 gettext 变得更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T15:06:39.960

也许您应该研究一下可以与 MySQL 结合使用的[Memcached 。](http://www.mysql.com/why-mysql/memcached/)它对于获取不经常更改的数据（例如翻译）非常有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-12T10:18:06.063

Gettext 是一种非常古老的格式。它使用文件来存储翻译。它很笨拙，尤其是当您有成千上万的翻译时，可以说是 20,000。管理包含 20,000 个翻译字符串的 PO 文件是一场噩梦，跨 50 种语言是不可能的。然后你必须在 MO 文件中实际编译它。不，谢谢。这在 1990 年可能是有意义的，而不是现在。

相反，数据库功能强大。就像真的很强大。说出你需要的东西，你就能得到它。他们可以在一秒钟内准确地告诉你：

*   哪个翻译字符串没有翻译成哪种语言
*   翻译最初是何时创建的，由谁创建
*   翻译最后一次更新是什么时候以及由谁更新
*   每次翻译的完整历史记录与完成更改的人
*   您可以在物化视图中预翻译所有文本，并通过一个 select 语句获取它们
*   按字母顺序排列翻译字符串，逐页查看和编辑
*   设置哪些用户可以准确更新哪些翻译
*   使用一些简单的 HTML Web 表单，世界上任何地方的任何人都可以在几秒钟内实时翻译您的应用程序，并且具有完整的历史记录、评论每个翻译对、接收和阅读回复、标记待办事项的翻译等等等
*   在几秒钟内分析谁在过去的一天、一周、一个月、一年中完成了多少翻译 - 这样您就可以给予奖励
*   还需要 PO 文件吗？您可以按照您需要的时间表让您的数据库创建这些
*   缺少翻译？您的数据库可以自动向负责该语言的翻译人员发送电子邮件、短信。
*   翻译已被翻译更新？现在数据库可以向负责的审阅者发送电子邮件以进行审批
*   需要快速翻译？您的数据库可以立即调用 API 进行翻译，然后发送电子邮件给负责人进行审核

# .net - CheckBox 不接受代码中的状态更改

> ID：15341465
> 
> 赞同：0
> 
> 时间：2013-03-11T14:45:43.017
> 
> 标签：.net, winforms, checkbox, oxygene

在 winform 上，我有三个不同的复选框。他们都不会以编程方式接受对其状态的任何更改，而只能通过鼠标单击。为什么？

![在此处输入图像描述](../Images/eace4654dbb900c01c6df5606f21f850.png)

这是我在代码中设置它们的状态的方式：

```
 if i=1 then
  ClientChk.Checked := true
 else
  ClientChk.Checked := false;

 if i = 2 then
  HostChk.Checked := true
 else
  HostChk.Checked := false; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:47:51.230

您发布了没有上下文的代码，并希望我们尝试为您进行心理调试。我会试一试，但你真的需要学会让你的问题更完整。

我的猜测是，在您未发布的代码中的某处，您正在启用/禁用`ClientChk`，并且`HostChk`基于该`Enable Remote Mode`框是否被选中，以及当它未被选中时（如您的图像中所示），`ClientChk`and`HostChk`按钮被禁用。快速浏览您的代码（或使用调试器）会很快告诉您是否是问题所在。

顺便说一句，您可以稍微改进您的代码（并根据以下值处理启用/禁用它们`EnableRemoteChk`：

```
ClientChk.Enabled := EnableRemoteChk.Checked;
HostChk.Enabled := ClientChk.Enabled;
if ClientChk.Enabled then
begin
  ClientChk.Checked := (i = 1);
  HostChk.Checked := (i = 2);
end; 
```

# ios - iOS 设置包：应用升级时保留的设置？

> ID：15341466
> 
> 赞同：0
> 
> 时间：2013-03-11T14:45:44.453
> 
> 标签：ios, ios5

快速提问：我正在考虑使用 iOs 设置包。我了解这些设置存储在用户默认值中。我假设当我升级我的应用程序时，应用程序设置会被保留，对吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:50:16.437

快速回答。

NSUserDefaults 设置在应用升级时仍然存在。

[NSUserDefaults 是否通过更新 Appstore 中的应用程序而持续存在？](https://stackoverflow.com/questions/1638766/do-nsuserdefaults-persist-through-an-update-to-an-app-in-the-appstore)

# javascript - Jquery在解析时将巨大的数组拆分为许多新的回调

> ID：15341470
> 
> 赞同：10
> 
> 时间：2013-03-11T14:45:56.643
> 
> 标签：javascript, jquery, asp.net, arrays, json

我偶然发现了一个小问题。我得到一个 JSON 响应，其中包括一个包含 67615 个条目的字节数组。现在它增加了一个

```
`[....,154,156,);jQuery1910039778258679286416_1363006432850(181,104,...] 
```

每约 7300 个字符

现在，当我使用 ajax 方法解析它的正常工作方式时，它给了我一个错误，因为回调使元素列表后的响应 SyntaxError: missing ] 无效

...,184,1,26,65,140,​​86,211,16,194,210,174,1);jQuery17203250109862964784_13639643449...

所以它不再有效

我用它来解析它

```
$.ajax({
    url : url,
    cache : false,
    dataType : "jsonp",
    crossDomain : true,
    success : function(root) {
        console.log(root)

    }
}) 
```

这可能是asp服务器给我对象的问题还是解析有问题？

提前致谢

编辑1：

```
 [WebMethod(Description = " ", EnableSession = true)]
[ScriptMethod(UseHttpGet = true, ResponseFormat = ResponseFormat.Json)]

public Borrower getSessionedBorrowerHeader(ref sysmessage aMessage)
{
    if (!(userValidated(ref aMessage)))
        return null;
    BorrowerControl borrowerControl = new BorrowerControl(LOCALconnectionStringDb,
                                                          WEBconnectionStringDb,
                                                          STATSconnectionStringDb,
                                                          LIBconnectionStringDb,
                                                          CATconnectionStringDb,
                                                          LIBconnectionStringDb,
                                                          Session);
    Borrower returnObj = borrowerControl.getSessionedBorrowerHeader(ref aMessage);
    borrowerControl.Dispose();
    return returnObj;
} 
```

如果您需要更多代码，请告诉我我不喜欢 ASP :(

编辑2：

[http://pastebin.com/e3X2VKxY](http://pastebin.com/e3X2VKxY)

怎么办:(这是JSON答案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T01:16:41.333

这听起来像是一个 ASP 限制因素。这不是 jQuery 特定的，而是针对来自 ASP 服务器的任何 JSON 响应。我也在 ColdFusion 服务器上看到过这个。找到此设置并查看您的限制是否与您达到的限制相关。看看你能不能把它增加到你需要的。

```
<system.web.extensions>  
    <scripting>  
        <webServices>  
            <jsonSerialization maxJsonLength="x"></jsonSerialization>  
        </webServices>  
    </scripting>  
</system.web.extensions> 
```

如果您无权访问服务器设置，您也可以在代码中设置该值。这是一个 MSDN 参考：

[http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.maxjsonlength.aspx](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.maxjsonlength.aspx)

它还在那里指出：

> JSON 字符串的最大长度。默认值为 2097152 个字符，相当于 4 MB 的 Unicode 字符串数据。

这超出了您大约 7300 个字符的长度。但也许有人调整了这个设置。

我也很好奇您看到“多次”返回到回调方法。通常，我认为，这个限制只会截断第一个回调结果的结果。也许您还有其他事情要做？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T17:51:51.810

根据 jQuery 文档，您可以设置 jsonp 回调的名称，以在您的情况下保存字节：`jsonpCallback`

```
function J() { ... }
$.ajax({
    url : url,
    cache : false,
    dataType : "jsonp",
    jsonpCallback : "J",
    crossDomain : true,
    success : function(root) {
        console.log(root)
    }
}) 
```

# javascript - 使用 Javascript 从 HTML 中提取 URL 并在函数中使用它

> ID：15341473
> 
> 赞同：1
> 
> 时间：2013-03-11T14:46:05.700
> 
> 标签：javascript, html-parsing

我需要`link`从 html 中提取 URL。

```
<a rel="nofollow" href="link" class="1"> 
```

整个页面上只有一个这样的链接。

然后我需要`a.href`在这个函数中添加使用它：

```
function changespan() {
    var spans = document.querySelectorAll('span.image');
    for (var i = spans.length; i--; ) {
        var a = document.createElement('a');
        a.href = "http://domain.com";
        spans[i].appendChild(a).appendChild(a.previousSibling);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:54:21.493

试试这个：

```
function changespan() {
    var spans = document.querySelectorAll('span.image'),
        href = document.querySelector('.nofollow-link').href;
    for (var i = spans.length; i--; ) {
        var a = document.createElement('a');
        a.href = href;
        spans[i].appendChild(a).appendChild(a.previousSibling);
    }
} 
```

但是将您的链接类更改为其他内容，然后`1`它不能以数字开头：

```
<a rel="nofollow" href="link" class="nofollow-link">Link</a> 
```

[http://jsfiddle.net/Tqv76/2/](http://jsfiddle.net/Tqv76/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:49:21.953

```
document.getElementsByTagName("a")[0].getAttribute("href"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T14:50:54.127

```
function changespan() {
    var spans = document.querySelectorAll('span.image');
    for (var i = spans.length; i--; ) {
        var a = document.createElement('a');
        a.href = $(".1").attr('href');
        spans[i].appendChild(a).appendChild(a.previousSibling);
    }
} 
```

# perl - 替换在线位置“x”中的字符 92-97

> ID：15341478
> 
> 赞同：-4
> 
> 时间：2013-03-11T14:46:20.860
> 
> 标签：perl, unix, sed, awk, formatting

我有两个文件，需要`file1`从`file2`.

例如：

**文件 1**

```
LOCAR0013LOCBLKAR0013LOCDEFAR0013LOC024500230012BLKAR0013              7Q3G013             003340000000000000

LOCAR0030LOCBLKAR0030LOCDEFAR0030LOC091500960004BLKAR0030              M20G010             000165000000000000

LOCAR0031LOCBLKAR0031LOCDEFAR0031LOC024500230012BLKAR0031              M21G011             002240000000000000 
```

**文件2**

```
LOCAR0013LOCBLKAR0013LOCDEFAR0013LOC024500230012BLKAR0013              7Q3G4GR             000040000000000000

LOCAR0030LOCBLKAR0030LOCDEFAR0030LOC091500960004BLKAR0030              M20GTRS             000105000000000000

LOCAR0031LOCBLKAR0031LOCDEFAR0031LOC024500230012BLKAR0031              M21G2AS             000040000000000000 
```

**新文件的预期输出**

```
LOCAR0013LOCBLKAR0013LOCDEFAR0013LOC024500230012BLKAR0013              7Q3G4GR             003340000000000000

LOCAR0030LOCBLKAR0030LOCDEFAR0030LOC091500960004BLKAR0030              M20GTRS             000165000000000000

LOCAR0031LOCBLKAR0031LOCDEFAR0031LOC024500230012BLKAR0031              M21G2AS             002240000000000000 
```

我在 Unix / Solaris 系统上有这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:18:13.210

这应该做你需要的

```
use strict;
use warnings;
use autodie;

my ($file1, $file2) = @ARGV;

open my $fh1, '<', $file1;
open my $fh2, '<', $file2;

while (my $line2 = <$fh2>) {
    my $line1 = <$fh1>);
    if (defined $line1) {
        substr($line2, 91, 6) = substr($line1, 91, 6);
    }
    print $line2;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:02:59.507

怎么样：

```
$ paste file1 file2 | awk '{print $1,$5,$3}' OFS='\t\t'
LOCAR0013LOCBLKAR0013LOCDEFAR0013LOC024500230012BLKAR0013       7Q3G4GR     003340000000000000

LOCAR0030LOCBLKAR0030LOCDEFAR0030LOC091500960004BLKAR0030       M20GTRS     000165000000000000

LOCAR0031LOCBLKAR0031LOCDEFAR0031LOC024500230012BLKAR0031       M21G2AS     002240000000000000 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T15:18:59.640

假设您在 perl 中将文件加载到内存中：

```
my @file1 = <$fh1>;
my @file2 = <$fh2>;

for my $line (0 .. $#file1) {
    my $replace = substr($file1[$line], 91, 6);  # take your string from file1
    substr($file2[$line], 91, 6) = $replace;     # put it into file2
} 
```

您现在将在`@file2`.

该`substr`函数也可以用作左值，并为其分配一个值，这就是我们在这里所做的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T16:10:01.383

这个单线应该工作：

```
 awk 'NR==FNR{a[$1]=substr($0,92,5);next}($1 in a) {$0=substr($0,1,92) a[$1] substr($0,97)}1' file file2 
```

# ms-access - 如何匹配表1和表2的值，在表2中抓取一个对应的值，然后在表1的表达式中使用

> ID：15341479
> 
> 赞同：0
> 
> 时间：2013-03-11T14:46:21.317
> 
> 标签：ms-access

我在编程方面有点新手/新手，所以请原谅我的天真。在 MS Access 2013 中，我有两个表：表 1 和表 2。我需要一种方法来比较 [表 1].[字段 6] 中输入的值与 [表 2].[字段 2] 中的值，然后当它找到匹配项时，在 [Table 2].[Field 3] 中获取相应的行值，并将其用于 [Table 1].[Field 13] 中的表达式中。

我曾想过使用“If”语句，但两个正在比较的表中有 10 个潜在值，因此表达式会变大并且需要很长时间才能计算出来。特别是一旦表 1 开始获得数百/数千条记录。

有人可以告诉我最简单/最干净的方法吗？

编辑 - 每个请求添加更多细节。

我们出售整车、有轨电车、手提袋等商品。因此，当我们签订合同时，我们将签订 2 辆卡车、3 辆轨道车、10 个集装箱等。这些运输方式中的每一种都有不同的重量，并且定价/销售也不同（美元/磅、美元/公吨等.) 取决于运输方式。这个想法是，当输入合同时，它会查看在 [table 1].[field 6] 中输入的运输方式，将其与主重量表（即表 2）进行比较，以获得数量运输方式是磅、吨等（让我们将此变量称为“x”），因此我可以使用该数字（以及表 1 中其他字段的数量和价格）在新字段中生成总收入数字在表 1 中。 = "x" *[数量]* [价格]。

例如，假设我们卖了 3 辆卡车。当输入卡车作为运输方式时，它会查找卡车的体积（即 46,000 磅），然后在表达式中使用该数字。46,000 x 3 卡车 x 0.39 美元/磅 = 53,820 美元。

我可以创建外壳，并且可以在收入字段中创建表达式。我只是无法弄清楚如何将变量“x”（基于比较表的权重）放入等式 =“x” *[volume]* [price] 而无需简单地执行“If”语句并包括所有 10表达方式中的运输方式。我认为有一种方法可以使用表或查询来带回“x”而不是表达式中的 10 个不同的逻辑测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:36:33.347

你可以试试这个 SQL 语句：

`UPDATE [Table 1] INNER JOIN [Table 2] ON [Table 1].[Field 6]=[Table 2].[Field 2] SET [Table 1].[Field 13] = [Table 2].[Field 3];`

`[Table 2].[Field 3]` `* [Table 1].[Other field]`如果您希望乘以数量和价格，您可以添加或添加任意数量的字段。

您还可以添加`WHERE [Table 1].[Field key] = "current_record_key"`以确保仅更新当前条目。如果您不这样做，它将更新整个表 1，如果权重随时间变化，这可能是一个问题。另一种选择 if `WHERE [Table 1].[Field 13] IS NULL`，这样它只会更新总收入为空的字段。

# sql - 需要一个（简单的）SQLite 语句

> ID：15341481
> 
> 赞同：-5
> 
> 时间：2013-03-11T14:46:34.243
> 
> 标签：sql, sqlite, select

我有两张桌子

```
FRIENDS 
id 
friendID 
name 
prename

FRIENDLIST 
id 
userID 
friendID 
```

我传递了一个用户 ID（称为 myPassedUserID）

我需要一个 SQLite 选择查询。它应该在 FRIENDLIST 中查找 userID=myPassedUserID 的所有朋友 ID，然后从 FRIENDS 中检索与我刚刚查找的朋友 ID 匹配的所有列。

我试过这个：

```
SELECT *

FROM FRIENDS
WHERE friendID IN 
(
    SELECT friendID  
    FROM FRIENDLIST 
    WHERE userID=myPassedUserID
) 
```

但我读到出于性能原因，这并不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:52:57.580

```
SELECT FRIENDS.* from FRIENDS
INNER JOIN FRIENDLIST
ON FRIENDS.FriendID = FRIENDLIST.FriendID
WHERE FRIENDLIST.userID = ? 
```

# c++ - C++ 中的均值偏移实现

> ID：15341486
> 
> 赞同：9
> 
> 时间：2013-03-11T14:46:41.497
> 
> 标签：c++, opencv, machine-learning, computer-vision, mode

任何人都可以推荐 C++ 中的轻量级均值偏移聚类实现吗？我已经在使用 OpenCV，但是它们的均值偏移实现是用于跟踪，而不是聚类。我见过爱迪生，但是，这是用于图像分割而不是聚类。

我可以自己实现它，但宁愿不花时间，也不要冒错误的风险。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-10-02T04:05:40.160

这很旧，但我现在正在使用均值偏移，所以我认为最好回答。

我想我理解你在这里所做的区别，但是当你说你正在寻找**模式检测**时，这在技术意义上是模糊的，因为从算法的角度来看，因为算法本质上是用于搜索**“模式”**，其中是局部最小值或最大值，具体取决于您如何构建优化问题（梯度下降或上升）。

[在 EDISON 网站上找到的这个来源](http://coewww.rutgers.edu/riul/research/code/AMS/index.html)声称是均值偏移聚类算法的 c++ 实现，但如上所述，聚类是均值偏移的所有其他用途所基于的模式搜索行为的主要实现，尤其是分段，因此您当然可以使用 EDISON 源来找到集群实现，即使您必须通过它进行一些搜索。

我还发现了这个[Github 项目](https://github.com/mattnedrich/MeanShift_cpp)，值得，但我以前没有使用过它。

**最后注意：**我还注意到您说“轻量级”实现。请注意，均值偏移不是一种非常有效的算法（我认为它类似于 O(N^3)，但我会检查一下）。也就是说，它仍然可以有效地实施，尽管应该如何衡量它更加模棱两可。不用说， UCLA 研究人员尝试解决更有效的中心点偏移问题的**Quick Shift**是一种类似的非参数模式搜索算法，它可能更像您在“轻量级”算法中寻找的内容。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-01-31T09:31:34.467

这是我的 C++ 版本的均值偏移对象跟踪方法。要成功运行代码，需要将 tf.h 头文件添加到主代码目录。

```
#include "tf.h" // include the header file
using namespace cv;
using namespace std;
#include <stdio.h>

makerect mkr;  // rectangle for encompassing target 
// rcs for row coordination of target window center
//ccs for column coordination of target window center
double rcs=0,ccs=0; 
// w for width of target window 
// l for length of target window
double W=70,L=60;

const int mySizes[3]={16,16,16}; // vector for number of histogram bins
cv::Mat q4hsv = Mat::zeros(3,mySizes,CV_64F); // initializing histogram variable
uchar nbins=16; // var for num of histogram bins
int main(void){     
    printf("enter 14 or 36: \t"); // enter number of input video name
    uint flag; // var for video flag or number
    cin>>flag;
    Mat ref4frame; // reference frame which is used for initializing mean shift parameters
char filename [50]; 
sprintf(filename,"im%d.avi",flag);
VideoCapture capture(filename);
if( !capture.isOpened() )
    throw "Error when reading steam_avi";

unsigned long int f4counter=0; // frame counter var
histhsv hsv; // instantiating histhsv class
for (f4counter=1;f4counter<=40000000;f4counter++){ // a big number to support many frames
    capture >> ref4frame; //reading input image from specified directory
    if( !(ref4frame.data ))   // checking the read status
    {       
       printf("Cannot load file image %s\n", filename);    
        break;    } 
    uchar ndiv = uchar(256/nbins); // division value to which intesity values are divided

if (f4counter==1)   { // special for 1st frame
    char modelname[20];
    if(flag==36){
    sprintf(modelname,"data%d.png",flag);       
    }
    else if (flag==14){
        sprintf(modelname,"data%d.jpg",flag);   
    }
    // imread is defined in tf.h
    Mat img = imread(modelname,1);//reads 1st image
    if( !(img.data ))//check if file loading is ok
    {       
       printf("Cannot load file image %s\n", modelname);       
        break;    } 
    hsv.img=img;//assign new image to hsv object (calculates hsv or rgb hist)
    hsv.run();//run the histogram calculator
// assign temporary hsv object to reference hist q4hsv object
for (int i=0;i<16;i++){
        for(int j=0;j<16;j++){
            for(int k=0;k<16;k++){
                q4hsv.at<double>(i,j,k)=hsv.q[i][j][k];
            }
        }
}
}
if(f4counter<5){averageglobalhsv(ref4frame,q4hsv,rcs,ccs);}
averagelocalhsv(ref4frame,q4hsv,rcs,ccs);//normalizing histogram values (0-1)

    Point pt1; pt1.x=ccs; pt1.y=rcs;
    int thickness=4;//thickness of marker - here is a circle
    int lineType=8;
    int shift=0;
    RNG rng(0xFFFFFFFF);
    cv::circle(ref4frame, pt1, 5, randomColor(rng), thickness, lineType,
shift); //marking object center with a circle
    myimshow("reference frame",ref4frame);//show current image
    waitKey(1); 
}

int c=waitKey(0);
//release memory
ref4frame.release();
destroyAllWindows();
    return 0;
} 
```

这是 tf.h 头文件内容：

```
#include "opencv2/highgui/highgui.hpp"
#include "opencv2/imgproc/imgproc_c.h"
#include "opencv2/imgproc/imgproc.hpp"
#include "opencv2/highgui/highgui.hpp"
#include "opencv2/features2d/features2d.hpp"
#include "opencv2\opencv.hpp"
#include "core\core.hpp"
#include <cstdio>
#include <iostream>
#include <fstream>
#include <math.h>
using namespace cv;
using namespace std;

// makerect class: to create the desired size encompassing window
class makerect
{
public:
    double rcs,ccs,w,l; // ctl row, ctl column, width, length
    uint rmin,rmax,cmin,cmax,height,length;//min max coordination vars
    void run(void);
    makerect();
};
makerect::makerect(){
    rmin=0;rmax=0;cmin=0;cmax=0;rcs=0;ccs=0;w=0;l=0;
}
void makerect::run(){
//not that all points must be either integer or floating point
    rmin=uint(rcs-floor(w/2));//min row coordination
    rmax=uint(rmin+w);//max row coordination
    cmin=uint (ccs-floor(l/2));//min column coordination
    cmax=uint(cmin+l);//max column coordination
    if(cmax>length){cmax=length;cmin=cmax-l;// checking column to be inside image}
    if(rmax>height){rmax=height;rmin=rmax-w;//checking row to be inside image}
}

static Scalar randomColor(RNG& rng)
{
    int icolor = (unsigned)rng;
    return Scalar(icolor&255, (icolor>>8)&255, (icolor>>16)&255);
}
//myimshow: is a function to to show image
void myimshow(char* name4window,Mat &tmp4image){
    namedWindow(name4window,1); imshow(name4window,tmp4image);
}

void averageglobalhsv(Mat ref4frame,Mat &f,double &rcs,double &ccs)
{
    Mat img;
    cvtColor(ref4frame,img,CV_BGR2HSV);//rgb2hsv conversion
    uint n4rowsref=ref4frame.rows;// num of rows
    uint n4colsref=ref4frame.cols;// num of cols
    double *im4bp = new double [n4rowsref*n4colsref];//1-D dynamic array equal to image pixels
    uint nbins=16;// num of histogram bins
    uint ndiv=256/nbins; //division value to which intensities are divided
//vars for image moments (zero to second moments)
double m00=0,m01=0,m10=0,m20=0,m02=0,m11=0,w=0; 

uint R=0,G=0,B=0; //red bin num, green bin num, blue bin num
    for(uint i=0;i<n4rowsref;i++){ //loop through all image rows
        for(uint j=0;j<n4colsref;j++){//loop through all image columns
            Vec3b inten=img.at<Vec3b>(i,j);//a vector of three element
            R=inten.val[2]; G=inten.val[1];  B=inten.val[0];
            R/=ndiv; G/=ndiv;  B/=ndiv;//calculating the bin to which current pixel intensity belong

                im4bp[i*n4colsref+j]=1.3*sqrt(f.at<double>(R,G,B));//calculating spatial weighted kernel histogram formula

        }
    }

    for(uint i=0;i<n4rowsref;i++){//loop through all image rows
        for(uint j=0;j<n4colsref;j++){//loop through all image columns
            w=im4bp[j+n4colsref*i];// weight for pixel at (i,j)
            m01=m01+double(i)*w;//first moment on y/row coordination
            m10=m10+double(j)*w;//first moment on x/column coordination
            m00=m00+w;//zeroth moment which is sum of all moments
        }
    }
if(m00>0){  
rcs=ceil(m01/m00);//central point for row
ccs=ceil(m10/m00);}//central point for column
delete im4bp;//cleaning memory
}

void averagelocalhsv(Mat ref4frame,Mat &f,double &rcs,double &ccs)
{
    Mat img;
cvtColor(ref4frame,img,CV_BGR2HSV); 
makerect mkr;
int sz[]={2,2};
    uint n4rowsref=ref4frame.rows;
    uint n4colsref=ref4frame.cols;
    double *im4bp = new double [n4rowsref*n4colsref];
    uint nbins=16;
    uint ndiv=256/nbins;
double m00=0,m01=0,m10=0,m20=0,m02=0,m11=0,w=0,Dxx,Dyy,Dxy;

uint R=0,G=0,B=0;
    for(uint i=0;i<n4rowsref;i++){
        for(uint j=0;j<n4colsref;j++){
            Vec3b inten=img.at<Vec3b>(i,j);
            R=inten.val[2]; G=inten.val[1];  B=inten.val[0];
            R/=ndiv; G/=ndiv;  B/=ndiv;
            im4bp[i*n4colsref+j]=1.3*sqrt(f.at<double>(R,G,B));
        }
    }

for(int iter=1;iter<5;iter++){
    mkr.rcs=rcs;mkr.ccs=ccs;mkr.w=100;mkr.l=100;mkr.height=ref4frame.rows;
    mkr.length=ref4frame.cols;  mkr.run();

    m00=0;m01=0;m10=0;m20=0;m02=0;m11=0;
    for(uint i=mkr.rmin;i<mkr.rmax;i=i+1){
        for(uint j=mkr.cmin;j<mkr.cmax;j=j+1){
            w=im4bp[j+n4colsref*i];
            m01=m01+double(i)*w;
            m10=m10+double(j)*w;
            m00=m00+w;
        }
    }   
}
if(m00>0){
rcs=ceil(m01/m00);
ccs=ceil(m10/m00);
}
delete im4bp;
}
class histhsv{
public:
    histhsv();
    void run(void);
    Mat img;    
    double q[16][16][16];

};
histhsv::histhsv(){};
void histhsv::run(void){
//Mat hsv4image;
double sum4hist=0;
uchar nbins=16;
uchar ndiv=256/nbins;
double wmax =0;;    
double r_center=0;
double c_center =0;
r_center = img.rows/2;
c_center = img.cols/2;
for (int i=0;i<nbins;i++){for(int j=0;j<nbins;j++){for(int k=0;k<nbins;k++){
q[i][j][k]=0;   }   }   };
    cvtColor(img,img,CV_BGR2HSV);       
    int H=0,S=0,V=0;    
    for(int r=0;r<img.rows;r++){
        for(int c=0;c<img.cols;c++){
            Vec3b intensity = img.at<Vec3b>(r,c);
            H=intensity.val[0]/ndiv;
            S=intensity.val[1]/ndiv;
            V=intensity.val[2]/ndiv;
            q[H][S][V]+=wmax-(pow(r-r_center,2)+pow(c-c_center,2));
            sum4hist+=q[H][S][V];
        }
    }
    for (int i=0;i<nbins;i++){
        for(int j=0;j<nbins;j++){
            for(int k=0;k<nbins;k++){
                q[i][j][k]/=sum4hist;
            }
        }
    }       

} 
```

# expression - 使用正则表达式查找文本

> ID：15341489
> 
> 赞同：-1
> 
> 时间：2013-03-11T14:46:48.623
> 
> 标签：expression

我有这样的字符串`abc+def(ghi)+jkl`，我想得到`{abc,ghi,jkl}`正则表达式的结果。到目前为止，我发现：`[a-z]+(?!\\()`但它返回`{abc,de,ghi,jkl}`. 有谁知道如何编写正确的正则表达式？
例子：

> var + var_s => { **var, var_s** }
> 
> var + 方法（arg）+ var_s => { **var, arg, var_s** }
> 
> string * string_s + method_name(arg,arg_s) => { **string, string_s, arg, arg_s** }
> 
> var + 2 * ( 3 + something ) +count( 3, 性别 ) => { **var, something, 性别**}

我需要将所有字符串都包含 'az Az _' 但不以`(`char 结尾。字符串：`method(, method_name(, count(`由于**(** .

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:48:45.567

```
if (preg_match('/(\w+)/i', $subject, $regs)) {
    $result = $regs[0];
} else {
    $result = "";
} 
```

(\w+)

选项：不区分大小写

匹配下面的正则表达式并将其匹配捕获到反向引用编号 1 «(\w+)»

匹配作为“单词字符”的单个字符（字母、数字和下划线）«\w+»

在一次和无限次之间，尽可能多次，根据需要回馈（贪婪）«+»

（regexbuddy 是你的朋友！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T07:58:35.707

我在[http://msdn.microsoft.com/en-us/library/az24scfc.aspx](http://msdn.microsoft.com/en-us/library/az24scfc.aspx)上找到了解决方案：

> \b[a-zA-Z_]+(?!\()\b

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T12:53:24.643

```
if (preg_match('/\b([a-z]+)(?!\(|\))\b/i', $subject, $regs)) {
    $result = $regs[0];
} else {
    $result = "";
} 
```

# css - 如何使顶部边框紧贴字体的字形？

> ID：15341504
> 
> 赞同：9
> 
> 时间：2013-03-11T14:47:34.397
> 
> 标签：css, border, typography

我需要在一个项目中显示几个字体样本的基线、x 高度和大写高度的规则。我已经处理了基线和 x-height，但是无法获得一个通用的 CSS 规则，该规则将在我应用该规则的任何字体的大写高度处绘制边框。我已经调整了行高，但是字体的字形与其布局框顶部之间的空间因字体而异，因此设置一次对任何字体都不起作用。

这个代码笔示例说明了这个问题： [http ://codepen.io/DrSpatula/pen/BAgqG](http://codepen.io/DrSpatula/pen/BAgqG)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-22T09:29:06.420

您现在将 line-height 应用于 p。如果您在此处删除它，并将 line-height 应用于 span.text，并将其设置为 1.55ex 的值，它会正确显示。

所以你的 CSS 将是：

```
 p {
      font-size: 72px;
      position: relative;
      margin: 0;
      padding: 0;
    }

    p span {
      margin: 0;
      padding: 0;
      display: inline-block;
    }

    .sans {
      font-family: sans-serif;
    }

    .text { 
      border-top: 1px solid blue;
      line-height: 1.55ex;
    }

    .rule {
      height: 1ex;
      border-top: 1px dotted red;
      border-bottom: 1px solid blue;
      position: relative;
      left: -7.25em;
      width: 7.75em;
      top: 1px;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T19:32:10.060

也许我可以帮忙。我做了一个小小提琴给你看。( [http://jsfiddle.net/dgxJh/1/](http://jsfiddle.net/dgxJh/1/) )

但是，我担心使用此解决方案，您将不得不为每种字体大小和每种字体重新定位粉红色线的跨度。但本质上，您将使用以下代码在文本上放置一个跨度：

```
span{
    height: 1px;
    width: 100%;
    background: pink;    
    display: block;
    position: absolute;
    top: 0.6em;
} 
```

不要忘记将容器相对定位

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T12:09:04.457

它很脏，但是您是否尝试过将一个像素的 .gif 作为重复背景，然后您可以设置它相对于字体的位置？

# wordpress - WordPress / Easy Facnybox 错误：未捕获的类型错误：对象 [object Object] 没有方法“fancybox”

> ID：15341509
> 
> 赞同：0
> 
> 时间：2013-03-11T14:47:59.680
> 
> 标签：wordpress

我已经安装了 Easy Fancybox 插件，但遇到了一些错误并且看不到原因，因此非常感谢任何帮助。链接在这里：`http://176.67.171.11/airvent/`

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:05:48.297

看起来你正在使用旧的fancybox，它不适用于你的jQuery库，`1.9.0`如果你想使用旧的fancybox，请使用`1.8.3`jQuery库的版本，否则更新你的fancybox，可以在[**这里找到**](http://fancyapps.com/fancybox/)

# javascript - javascript中的createElement设置“onchange”属性

> ID：15341512
> 
> 赞同：3
> 
> 时间：2013-03-11T14:48:07.920
> 
> 标签：javascript, html

我正在尝试使用“onchange”属性动态添加一个新的输入字段：

```
 var f = document.getElementById("dN[" + fieldsd + "]"); // create/insert new
    el = document.createElement("input");
    el = f.appendChild(el);
    el.name = "dName[" + fieldsd + "]";
    el.id = "dName[" + fieldsd + "]";
    el.onchange =  "validation()"; 
```

我也试过 setAttribute 都对我不起作用。有没有办法使这项工作或解决方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-11T14:58:05.367

在 JavaScript 中，将`onchange`属性设置为指向函数的指针，而不是实际的字符串：

```
var f = document.getElementById("dN[" + fieldsd + "]"); // create/insert new
el = document.createElement("input");
el = f.appendChild(el);
el.name = "dName[" + fieldsd + "]";
el.id = "dName[" + fieldsd + "]";
el.onchange =  validation; 
```

（你有一个名为 的函数`validation`）

如果需要传参，设置`onchange`为调用验证函数的函数：

```
el.onchange = function () {  
    validation(param1, param2, ...);
}; 
```

或者，如果您想从输入本身获取信息，您可以`this`在函数中使用关键字`validation`：

```
el.onchange = validation;

....

function validation() {
    // this is the "context" for the function.  In this case
    // the element that changed.
    var value = this.value;

} 
```

# c# - 从 url 下载图像并不总是保存整个图像 (Winrt)

> ID：15341513
> 
> 赞同：7
> 
> 时间：2013-03-11T14:48:09.450
> 
> 标签：c#, .net, windows-runtime

我正在使用以下代码从 url 下载图像

```
HttpClient client = new HttpClient();
        var stream = await client.GetStreamAsync(new Uri("<your url>"));
        var file = await KnownFolders.PictureLibrary.CreateFileAsync("myfile.png");
        using (var targetStream = await file.OpenAsync(FileAccessMode.ReadWrite))
        {
            using (stream)
                await stream.CopyToAsync(targetStream.AsStreamForWrite());
        } 
```

一些用户报告说它并不总是下载整个图像。他们有时会得到部分图像，其余的只是垃圾。

这有什么原因吗？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-11T14:55:19.857

我建议使用 DownloadData 或 DownloadDataAsync 方法尝试 WebClient 类。

```
File.WriteAllBytes("myfile.png",
    new WebClient().DownloadData("<your url>")); 
```

**编辑**如果流给您带来麻烦，您可以改用字节数组响应。您的内部带有异步代码的“使用”语句可能会导致它提前处理，也许？

```
var httpClient = new HttpClient();
var data = await httpClient.GetByteArrayAsync(new Uri("<Your URI>"));
var file = await KnownFolders.PictureLibrary.CreateFileAsync("myfile.png");
var targetStream = await file.OpenAsync(FileAccessMode.ReadWrite)
await targetStream.AsStreamForWrite().WriteAsync(data, 0, data.Length);
targetStream.FlushAsync().Wait();
targetStream.Close(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-02T09:03:38.193

BackgroundDownloader 是下载文件的最简单方法。

```
using Windows.Storage;

public async Task DownloadPhoto(Uri uri)
{
    var folder = ApplicationData.Current.LocalFolder;
    var photoFile = await folder.CreateFileAsync("photo.jpg", CreationCollisionOption.ReplaceExisting);
    var downloader = new Windows.Networking.BackgroundTransfer.BackgroundDownloader();
    var dl = downloader.CreateDownload(uri, photoFile);
    await dl.StartAsync();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-06T21:38:09.440

如果您使用 HttpClient，那么如果您的图像大于 64K，则会出错。您必须将 httpClient.MaxResponseContentBufferSize 设置为更大的值。

请参阅 MSDN 快速入门，他们将 max-buffer-size 设置为 256K。 [http://msdn.microsoft.com/en-us/library/windows/apps/xaml/JJ152726(v=win.10).aspx](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/JJ152726(v=win.10).aspx)

不过，就我个人而言，我使用的是 BackgroundDownloader。

# c# - 将值绑定到复选框

> ID：15341514
> 
> 赞同：0
> 
> 时间：2013-03-11T14:48:13.053
> 
> 标签：c#, jquery, asp.net, ajax

```
<input type="checkbox" name="chkbox" 
 onclick="Utility('<%# Eval("id") %>');"
checked='<%# Eval("Contacted") %> ' /> 
```

onclick 用于运行 AJAX，它根据复选框被选中或未选中来更新数据库中的记录。

我的 Q 是....我想获取存储在后面代码中的 'contacted' 中的 'T' 或 'F' 我试图通过正常绑定 Eval("Contacted")...（如'Contacted' 后面的代码将具有该值。

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:54:12.487

您可以通过以下方式获取选中的值（真或假）：

```
var isChecked = $("#chkbox").is(":checked"); //returns true or false 
```

您可以使用 prop 设置值

```
$("#chkbox").prop("checked", true); //Sets box to checked. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:02:24.337

我相信你想要达到的是这样的：

```
<input type="checkbox" name="chkbox" id="chkbox" /> 
```

```
    $('#chkbox').change(function(e) {
        if($(this).is(':checked')) {
            // 做任何事
        }
        别的{
            // 做任何事
        }
    });

```

# jquery - KendoUI 图表自定义数据点

> ID：15341524
> 
> 赞同：1
> 
> 时间：2013-03-11T14:48:29.587
> 
> 标签：jquery, kendo-ui, kendo-dataviz

使用 HTML5 版本的 KendoUI DataViz，是否可以更改折线图或绘图图上数据点的形状？它们默认为圆形我想知道是否可以将它们制成正方形或其他形状？

不确定是否需要 css hack，或者是否有可用的方法来更改它们。我似乎找不到一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T20:16:18.543

是的，您可能需要配置要更改的系列的标记类型。[这](http://docs.kendoui.com/documentation/api/dataviz/chart#seriesmarkerstype-stringdefault)是您需要的文档的一部分。

您可以在正方形、三角形和圆形之间进行选择。

[http://docs.kendoui.c​​om/documentation/api/dataviz/chart#seriesmarkerstype-stringdefault](http://docs.kendoui.com/documentation/api/dataviz/chart#seriesmarkerstype-stringdefault)

# mysql - MySQL - 来自右表的连接行的条件

> ID：15341525
> 
> 赞同：1
> 
> 时间：2013-03-11T14:48:31.930
> 
> 标签：mysql, join, group-by

我有两张桌子：

```
mysql> select * from orders;
+------+---------------------+------------+---------+
| id   | created_at          | foreign_id | data    |
+------+---------------------+------------+---------+
|    1 | 2010-10-10 10:10:10 |          3 | order 1 |
|    4 | 2010-10-10 00:00:00 |          6 | order 4 |
|    5 | 2010-10-10 00:00:00 |          7 | order 5 |
+------+---------------------+------------+---------+

mysql> select * from activities;
+------+---------------------+------------+------+
| id   | created_at          | foreign_id | verb |
+------+---------------------+------------+------+
|    1 | 2010-10-10 10:10:10 |          3 | get  |
|    2 | 2010-10-10 10:10:15 |          3 | set  |
|    3 | 2010-10-10 10:10:20 |          3 | put  |
|    4 | 2010-10-10 00:00:00 |          6 | get  |
|    5 | 2010-10-11 00:00:00 |          6 | set  |
|    6 | 2010-10-12 00:00:00 |          6 | put  |
+------+---------------------+------------+------+ 
```

现在我需要加入on列：`activities`为每个订单只选择一个活动（如果存在），这样就可以了。例如，订单和活动几乎是同时创建的。`orders``foreign_id``ABS(TIMESTAMPDIFF(SECOND, orders.created_at, activities.created_at))`

```
+----------+---------+---------------------+-------------+------+---------------------+
| order_id | data    | order_created_at    | activity_id | verb | activity_created_at |
+----------+---------+---------------------+-------------+------+---------------------+
|        1 | order 1 | 2010-10-10 10:10:10 |           1 | get  | 2010-10-10 10:10:10 |
|        4 | order 4 | 2010-10-10 00:00:00 |           4 | get  | 2010-10-10 00:00:00 |
|        5 | order 5 | 2010-10-10 00:00:00 |        NULL | NULL | NULL                |
+----------+---------+---------------------+-------------+------+---------------------+ 
```

以下查询生成包含所需行的行集。如果`GROUP BY`包含语句，则无法控制`activities`连接哪一行。

```
SELECT o.id AS order_id
     , o.data AS data
     , o.created_at AS order_created_at
     , a.id AS activity_id
     , a.verb AS verb
     , a.created_at AS activity_created_at 
FROM orders AS o 
LEFT JOIN activities AS a ON a.foreign_id = o.foreign_id; 
```

是否可以编写这样的查询？理想情况下，我想避免使用 group by，因为这部分是更大的报告查询的一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:13:16.797

因为两个表都引用了一些神秘的外键，所以下面的查询可能会出错，但它可能会给你一个原则，你可以根据自己的目的进行调整......

```
DROP TABLE IF EXISTS orders;

CREATE TABLE orders
(id INT NOT NULL PRIMARY KEY
,created_at DATETIME NOT NULL
,foreign_id INT NOT NULL
,data    VARCHAR(20) NOT NULL
);

INSERT INTO orders VALUES
(1 ,'2010-10-10 10:10:10',3 ,'order 1'),
(4 ,'2010-10-10 00:00:00',6 ,'order 4'),
(5 ,'2010-10-10 00:00:00',7 ,'order 5');

DROP TABLE IF EXISTS activities;

CREATE TABLE activities
(id   INT NOT NULL AUTO_INCREMENT PRIMARY KEY
,created_at          DATETIME NOT NULL
,foreign_id INT NOT NULL
,verb VARCHAR(20) NOT NULL
);

INSERT INTO activities VALUES
(1,'2010-10-10 10:10:10',3,'get'),
(2,'2010-10-10 10:10:15',3,'set'),
(3,'2010-10-10 10:10:20',3,'put'),
(4,'2010-10-10 00:00:00',6,'get'),
(5,'2010-10-11 00:00:00',6,'set'),
(6,'2010-10-12 00:00:00',6,'put');

SELECT o.id order_id
     , o.data
     , o.created_at order_created_at    
     , a.id activity_id 
     , a.verb 
     , a.created_at activity_created_at 
  FROM activities a 
  JOIN orders o 
    ON o.foreign_id = a.foreign_id 
  JOIN 
     ( SELECT a.foreign_id
            , MIN(ABS(TIMEDIFF(a.created_at,o.created_at))) x 
         FROM activities a 
         JOIN orders o 
           ON o.foreign_id = a.foreign_id 
        GROUP 
           BY a.foreign_id
     ) m 
    ON m.foreign_id = a.foreign_id
   AND m.x = ABS(TIMEDIFF(a.created_at,o.created_at))
 UNION DISTINCT
SELECT o.id 
     , o.data
     , o.created_at
     , a.id
     , a.verb
     , a.created_at
  FROM orders o
  LEFT
  JOIN activities a
    ON a.foreign_id = o.foreign_id 
 WHERE a.foreign_id IS NULL;
;

+----------+---------+---------------------+-------------+------+---------------------+
| order_id | data    | order_created_at    | activity_id | verb | activity_created_at |
+----------+---------+---------------------+-------------+------+---------------------+
|        1 | order 1 | 2010-10-10 10:10:10 |           1 | get  | 2010-10-10 10:10:10 |
|        4 | order 4 | 2010-10-10 00:00:00 |           4 | get  | 2010-10-10 00:00:00 |
|        5 | order 5 | 2010-10-10 00:00:00 |        NULL | NULL | NULL                |
+----------+---------+---------------------+-------------+------+---------------------+ 
```

# javascript - 选择一个在 JQuery 中包含 [ ]

> ID：15341529
> 
> 赞同：3
> 
> 时间：2013-03-11T14:48:52.917
> 
> 标签：javascript, jquery, selector

我有一个简单的问题：

*HTML：*
`<input type="checkbox" name="contacts">`

*JAVASCRIPT：*
`$("input[@name=contacts]").each(function()`
`...`

**如果**
*HTML：*
`<input type="checkbox" name="contacts[]">`

*JAVASCRIPT：*
`???`

这是我的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T14:50:04.993

为属性选择器中的值添加引号：

```
$("input[@name='contacts[]']").each(function() { ... }); 
```

# java - 如何将 JMenuItem 转换为 MenuItem 或添加 Action

> ID：15341532
> 
> 赞同：0
> 
> 时间：2013-03-11T14:48:57.943
> 
> 标签：java, swing, menuitem, jmenuitem

在我的 OSX 应用程序上，我有一个带有 JMenus 和 Actions 的 JMenubar

```
editMenu= new JMenu("EDIT);
editMenu.add(new CopyAction());
editMenu.add(new PasteAction()); 
```

但我想向扩展坞添加菜单，我可以使用 Apple 扩展程序和：

```
Application.getApplication().setDockMenu(java.awt.PopupMenu popupMenu) 
```

请注意，这是 awt 而不是 swing，所以我需要添加 MenuItems 而不是 JMenuItems

```
public class DockMenu extends PopupMenu
{
    public DockMenu()
    {
        add(createMenuItemFromAction(new CopyAction()));
        add(createMenuItemFromAction(new PasteAction()));
    }

    public MenuItem createMenuItemFromAction(Action action)
    {
        MenuItem mi = new MenuItem();
        //TODO How do I convert        
    }
} 
```

但我真的不清楚这种转换是如何进行的，因为 menuitem 没有使用操作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:07:53.127

一个 Action 也实现了 ActionListener 所以你不应该做任何特别的事情。只需将 Action 添加到 MenuItem

当您失去此 Action 行为时，您将需要手动设置 MenuItem 的文本和快捷方式。但是您可以直接从 Action 中获取此信息。

```
public MenuItem createMenuItemFromAction(Action action)
{
    MenuItem mi = new MenuItem(action.getValue(Action.NAME));
    mi.addActionListener( action );
} 
```

# ios - iOS 中选项卡式应用程序中的 Mapview

> ID：15341533
> 
> 赞同：1
> 
> 时间：2013-03-11T14:48:57.890
> 
> 标签：ios, cocoa-touch

我想问一些事情，因为作为一个初学者，我不再知道它是如何工作的。首先，我创建了一个新项目，一个单一视图，并添加了一个简单的地图视图。这工作得很好（当然遵循教程）

现在我尝试将这个简单的地图视图添加到我的初始项目中，这是一个基于导航控制器的选项卡。在这个选项卡式应用程序中，我已经添加了两个带有视图控制器的视图，我称它们为thirdview Controller 和fourthview 控制器。我给类thirdview 和fourview 控制器的vc。所以，现在我想在第三个视图上制作地图视图。我做了我在“试验项目”中所做的事情，但它不起作用。好吧，当我运行模拟器时，我看到了一张地图。但它没有显示位置，因为我在 thirdview controller.m 中指定了它

因为它在单视图项目中工作，我想我有一些东西要添加或连接到我的初始选项卡式应用程序中？我会很感激这方面的任何帮助非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:04:14.410

正如我从您所说的那样，您所拥有的是每个以 xCode 开头的人都非常简单且很少忘记的东西 :)

尝试将您的 viewController 和地图（在 xib 或 Storyboard 中）链接到文件所有者的视图和委托。

默认情况下，这些没有链接。只需右键单击它并拖动您的视图并委托给您的文件所有者。

另外，请确保您的每个 viewController 的类在属性中都是真的thirdview 和fourview（不要与xib 标识符混淆！）

希望这对您有所帮助！随意询问是否缺少任何东西:)

# javascript - 更改列表项容器时更改项目属性

> ID：15341535
> 
> 赞同：0
> 
> 时间：2013-03-11T14:49:05.067
> 
> 标签：javascript, jquery, jquery-ui

我有 2 个可排序的连接列表项，我想让该项目在更改列表容器时更改其属性（我的意思是将项目从第一个列表项拖放到第二个），这是我的代码：

```
$(".column").sortable({
    connectWith:    $(".column") ,  
    placeholder:    'widget-placeholder',   
    cursor: 'move' ,
    helper: function (evt, ui) {
        return $(ui).clone().appendTo('body').show();
    },  
    dropOnEmpty: true,  
    zIndex: 10
});

$("#column2").droppable({
    out: function( event, ui ) {
        $(ui.item).attr("rel",'0');
    },
    over: function( event, ui ) {
        $(ui.item).attr("rel",'1');
    }
  }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T12:59:07.623

您已经有了一个良好的开端，但有一些事情需要纠正，有些问题您可能没有意识到：

1.  您的项目是这样构造的：

    ```
    <li id="1" class="item">
         <h3 rel="1">item1</h3>
    </li> 
    ```

    所以你需要`rel`为`h3`元素设置，但你的jsFiddle中的代码是：

    ```
    $("#column2").droppable({
      drop: function( event, ui ) {
        $(this).find('.item').attr("rel",'0');
      }
    }); 
    ```

    所以这是找到`$(this)`具有类的所有元素（即droppable）`item`- 它对应于所有`li`元素。你需要使用：

    ```
    ui.item.find("h3").attr("rel", "0"); 
    ```

2.  您在 jsFiddle 中的排序是：

    ```
    $(".column").sortable({
        connectWith:    $(".column") ,  
        placeholder:    'widget-placeholder',   
        cursor: 'move' ,
        //  utiliser helper-clone pour que le sortable n'est donc pas contenue par un volet 
        helper: function (evt, ui) {
            return $(ui).clone().appendTo('body').show();
        },  
        dropOnEmpty: true,  
        zIndex: 10
    }); 
    ```

    不需要辅助函数 - 你可以使用`helper: "clone"`. 我已经添加`forcePlaceholderSize: true`到我的解决方案中，因为它为用户提供了有用的反馈，以显示 droppable 将被丢弃的位置。如果订购不重要，您可以将其删除。

3.  使用`droppable.drop`and存在问题`droppable.out`- 它们不会捕获拖放到列表开头或末尾的可放置对象的事件（我怀疑这是因为必须将可放置对象拖放**到*到***列表中才能触发事件，并且如果您将它放在列表的开头/结尾，它实际上是一个新位置并且不在*列表*中）。
    所以，我们可以`sortable`改用：

    ```
    $(".column").sortable({
        connectWith: $(".column"),
        placeholder: "widget-placeholder",
        forcePlaceholderSize: true,
        cursor: "move",
        helper: "clone",
        dropOnEmpty: true,
        zIndex: 10
    });

    $("#column2").on("sortreceive", function (event, ui) {
        ui.item.find("h3").attr("rel", "0");
    });

    $("#column2").on("sortremove", function (event, ui) {
        ui.item.find("h3").attr("rel", "1");
    }); 
    ```

请参阅我的[jsFiddle](http://jsfiddle.net/raad/ZzDV9/3/)以获得有效的解决方案。

# sql - 查询包含一个 varbinary (blob) 字段的表时出现 SQL 错误消息

> ID：15341536
> 
> 赞同：1
> 
> 时间：2013-03-11T14:49:05.363
> 
> 标签：sql, delphi, blob, varbinary

我们将 Delphi XE3 与 TSQLDataSet 和 TClientDataset 一起使用，将表从 SQL Server 2012 读入内存。

该表包含各种字段，其中一个是 blob“varbinary(max)”，我们在其中存储来自文本文件的内容。

我的问题是，当我们在 ClientDataset 上打开时，我们收到一条错误消息，说“连接正忙于处理另一个命令的结果”。命令文本是一个简单的“从表名中选择 *”。

仅当表中有多个项目时才会发生这种情况。仅当 blob 字段中有数据 (<> NULL) 时才会发生这种情况。

如果我们向表中添加第二个 varbinary 字段，一切正常。第二个字段不必包含任何数据。

这让我发疯，请帮助。

编辑：作为一种解决方法，我们只是在表中添加了一个“虚拟”varbinary 字段。由于这种奇怪的行为，我们得出结论，这一定是 TClientDataset 组件中的错误。尝试在旧版本的 delphi (XE2 SP3) 中执行相同的操作，结果相同。

# python - NumPy/OpenCV 2：如何裁剪非矩形区域？

> ID：15341538
> 
> 赞同：42
> 
> 时间：2013-03-11T14:49:10.153
> 
> 标签：python, opencv, image-processing, numpy

我有一组形成**形状**的点（闭合折线）。现在我想从**这个形状内**的某个图像中复制/裁剪所有像素，其余部分为黑色/透明。我该怎么做呢？

例如，我有这个：

![在此处输入图像描述](../Images/10f23ae3a0b9c706595b240a326be1ee.png)

我想得到这个：

![在此处输入图像描述](../Images/db8e513e48ba9d26c226211df77555d2.png)

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2013-03-11T16:00:39.130

*edit - 更新为使用具有 Alpha 通道的图像。

这对我有用：

*   制作一个全黑的蒙版（全部蒙版）
*   用 ROI 形状的白色填充多边形
*   将蒙版和您的图像结合起来，在其他地方获得黑色的 ROI

对于接受掩码的函数，您可能只想将图像和掩码分开。但是，我相信这可以满足您的具体要求：

```
import cv2
import numpy as np

# original image
# -1 loads as-is so if it will be 3 or 4 channel as the original
image = cv2.imread('image.png', -1)
# mask defaulting to black for 3-channel and transparent for 4-channel
# (of course replace corners with yours)
mask = np.zeros(image.shape, dtype=np.uint8)
roi_corners = np.array([[(10,10), (300,300), (10,300)]], dtype=np.int32)
# fill the ROI so it doesn't get wiped out when the mask is applied
channel_count = image.shape[2]  # i.e. 3 or 4 depending on your image
ignore_mask_color = (255,)*channel_count
cv2.fillPoly(mask, roi_corners, ignore_mask_color)
# from Masterfool: use cv2.fillConvexPoly if you know it's convex

# apply the mask
masked_image = cv2.bitwise_and(image, mask)

# save the result
cv2.imwrite('image_masked.png', masked_image) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-03-04T06:39:17.153

以下代码有助于裁剪图像并将它们置于白色背景中。

```
import cv2
import numpy as np

# load the image
image_path = 'input image path'
image = cv2.imread(image_path)

# create a mask with white pixels
mask = np.ones(image.shape, dtype=np.uint8)
mask.fill(255)

# points to be cropped
roi_corners = np.array([[(0, 300), (1880, 300), (1880, 400), (0, 400)]], dtype=np.int32)
# fill the ROI into the mask
cv2.fillPoly(mask, roi_corners, 0)

# The mask image
cv2.imwrite('image_masked.png', mask)

# applying th mask to original image
masked_image = cv2.bitwise_or(image, mask)

# The resultant image
cv2.imwrite('new_masked_image.png', masked_image) 
```

输入图像： [![输入图像](../Images/46cdd504cd7350ca16024f334931a71e.png)](https://i.stack.imgur.com/cBK1h.jpg)

蒙版图片： [![蒙版图像](../Images/081c5320dd7f0001291b3927a8d7a5d2.png)](https://i.stack.imgur.com/lmYra.png)

结果输出图像： [![在此处输入图像描述](../Images/202bf48f37103366ebcb4d411670d185.png)](https://i.stack.imgur.com/gfKaH.png)

# jquery - 保存数据时如何显示模式窗口

> ID：15341542
> 
> 赞同：0
> 
> 时间：2013-03-11T14:49:22.100
> 
> 标签：jquery, twitter-bootstrap, symfony-1.4, symfony-forms

当我在 Symfony 中保存一些数据时，我想显示一个模式窗口（Twitter Bootstrap 模式组件）。我使用`doctrine:generate-module`任务来构建模块，但当我单击“保存”按钮并保存数据时不知道如何显示窗口。有什么建议吗？

**编辑**：从学说：generate-admin（错误）更改为学说：generate-module（正确）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:26:54.007

对于保存当前对象的每个操作，生成器定义[一个](http://symfony.com/legacy/doc/jobeet/1_4/en/13?orm=Doctrine#chapter_13_user_flashes)*带有成功消息的[*flash*](http://symfony.com/legacy/doc/jobeet/1_4/en/13?orm=Doctrine#chapter_13_user_flashes)[消息。](http://symfony.com/legacy/doc/jobeet/1_4/en/13?orm=Doctrine#chapter_13_user_flashes)*

 *[您可以在生成器的操作模板中](http://trac.symfony-project.org/browser/branches/1.4/lib/plugins/sfDoctrinePlugin/data/generator/sfDoctrineModule/admin/parts/processFormAction.php)看到它们：

```
$this->getUser()->setFlash('notice', $notice); 
```

Flashes 消息随后显示在名为[`_flashes.php`](http://trac.symfony-project.org/browser/branches/1.4/lib/plugins/sfDoctrinePlugin/data/generator/sfDoctrineModule/admin/template/templates/_flashes.php). 如果一切正常，则在操作中定义并显示通知闪光：

```
<div class="notice">[?php echo __($sf_user->getFlash('notice'), array(), 'sf_admin') ?]</div> 
```

您需要做的是`_flashes.php`在模板文件夹中创建一个文件并编写 javascript 以打开引导模式。就像是：

```
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Modal header</h3>
  </div>
  <div class="modal-body">
    <p><?php echo __($sf_user->getFlash('notice'), array(), 'sf_admin') ?></p>
  </div>
</div>

<script type="text/javascript">
    $('#myModal').modal('show')
</script> 
```

本案例仅涵盖**通知**消息。您还必须涵盖*错误*之一。

* * *

**更新：**

由于您使用的是 Doctrine Generated Module 而不是 Doctrine Admin Generator，因此您必须这样做才能使用闪烁消息：

在您的操作中，找到`processForm`并添加通知：

```
protected function processForm(sfWebRequest $request, sfForm $form)
{
    $notice = $form->getObject()->isNew() ? 'The item was created successfully.' : 'The item was updated successfully.';

    $form->bind($request->getParameter($form->getName()), $request->getFiles($form->getName()));
    if ($form->isValid())
    {
        $alumnos = $form->save();

        $this->getUser()->setFlash('notice', $notice);

        $this->redirect('alumnos/new');
        // $this->redirect('alumnos/edit?id=' . $alumnos->getId());
    }
    else
    {
        $this->getUser()->setFlash('error', 'The item has not been saved due to some errors.', false);
    }
} 
```

然后您可以添加您之前创建的相同`_flashes.php`模板并包含它（在 中`newSuccess.php`，因为您在保存表单后将用户重定向到此操作）：

```
<?php include_partial('flashes') ?> 
```*

# javascript - 动态打开和关闭订阅以限制收到的缓存“未捕获的类型错误：将循环结构转换为 JSON”

> ID：15341546
> 
> 赞同：0
> 
> 时间：2013-03-11T14:49:24.657
> 
> 标签：javascript, mongodb, meteor

为了限制客户端的缓存，我们认为我们可以打开和关闭对特定集合的订阅，方法是按照 Meteor 文档的建议将该集合的 Meteor.subscribe 放在 Meteor.render 中 - “此外，调用 Meteor.subscribe在反应式上下文中设置订阅，当上下文无效时自动停止。”

但是，我们不断收到“未捕获的 TypeError：将循环结构转换为 JSON”错误。

程序流程如下：

```
Appliances = new Meteor.Collection 'appliances'
Alerts = new Meteor.Collection 'alerts' 
```

在客户端

```
under Meteor.startup subscribes to collection 'appliances'
Meteor.subscribe ('appliances')
Use Appliances.find{}.observe to monitor changes 
```

当检测到新的 Appliances 项目时，使用 Meteor.render 重新订阅警报并列出该项目的所有警报

```
Meteor.render(function() {Meteor.subscribe(Alerts); .....} 
```

知道我做错了什么吗？建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T17:17:05.657

我不知道您的错误消息来自哪里。`Deps.autorun()`但是您可以使用Session 变量轻松归档“仅在必要时”订阅：

客户端上的任何位置：

```
Deps.autorun(function () {
  if (!Session.get('isViewingAlerts')) Meteor.subscribe('alerts');
}); 
```

如果您现在使用`Session.set('isViewingAlerts',false)`， autorun 函数中的代码将失效并重新执行。

更进一步，您可以通过向发布函数“alerts”添加参数来订阅警报子集。

编辑：
我最近遇到了一个问题，即使用动态订阅时模板没有反应。由于重绘时未加载订阅。为了解决这个问题，我们为 Metor.subcribe 使用了一个回调，它更改了一个 Session 变量，以使该模板的呈现依赖于准备就绪的订阅，从而获得反应性。

-最好的，扬

# mysql - 在mysql中插入错误（约束）

> ID：15341548
> 
> 赞同：0
> 
> 时间：2013-03-11T14:49:27.360
> 
> 标签：mysql, constraints

当我尝试插入数据库时​​，出现以下错误：

```
DBD::mysql::st execute failed: Cannot add or update a child row: a foreign key constraint fails (`vym`.`vendedor`, CONSTRAINT `fk_vendedor_division` FOREIGN KEY (`codigo_empresa`, `codigo_division`) REFERENCES `division` (`codigo_empresa`, `codigo`)) at vendedores_aes_insert_85 line 53 
```

我知道我有一个限制，但我不知道如何解释该消息。什么是约束，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:50:56.047

看起来该`division`列违反了它。我会检查``fk_vendedor_division`约束的定义。

基本上，错误是说您正在尝试使用另一个`vendedor`表中不存在的表中的除法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T14:51:29.107

约束是表上*的外键*`vym.vendedor`；columns `codigo_empresa`, `codigo_division`) 引用表`division`列 ( `codigo_empresa`, `codigo`)。

# javascript - 什么算作 CPU 密集型任务（例如，排序、搜索等？）

> ID：15341551
> 
> 赞同：32
> 
> 时间：2013-03-11T14:49:34.940
> 
> 标签：javascript, node.js, cpu-usage

你认为什么是 CPU 密集型任务。就...而言，例如算法/代码（与其说是视频编辑等用例）。原因似乎是不使用 NodeJS 的主要原因是我真正喜欢的东西主要是 CPU 密集型任务。那算什么？是排序、搜索、图形横向、矩阵乘法吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-11T15:28:54.127

诸如“密集”或“昂贵”之类的术语是相对的，并不总是很明显哪些活动是 CPU 密集型的。一般来说，任何不是 I/O 的东西都是 CPU。在 node.js 中 I/O 是异步的，所以不是问题。因此，除了 I/O 昂贵之外，我们剩下的一切都是如此。

您选择一般模式的方法是明智的。排序、搜索，甚至一般的算法都受 CPU 限制。当然，你无法消除 CPU 使用率，但如果你可以让你的数据库排序而不是你的应用程序代码，你可能会更好。

我也会留意大循环。不触发任何异步事件的循环是瓶颈。当然，不能完全避免循环。它们是编程生活中的一个事实。如果你的循环很短，那么没问题。如果您发现一个循环运行 10,000 次，您可能需要考虑使用 setTimeout、process.nextTick 或单独的节点进程将其分解。

10,000 被任意挑选。这取决于循环的作用。您的里程可能会有所不同。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-11T16:44:35.710

在计算机上运行的进程或任务需要由操作系统管理的各种资源，如 CPU 周期、内存、磁盘或网络，以便每个任务高效执行（如果可能，无需等待资源）。

> 操作系统试图通过让多个进程同时使用资源来最大化资源利用率。如果一个进程大量请求特定资源，它可能会成为瓶颈（延迟）其执行。据说该过程对该资源来说是资源密集型的。因此，资源密集型是一个相对术语。

排序、搜索、图遍历、矩阵乘法都是 CPU 操作，一个进程是`CPU-intensive`不是取决于它们执行的多少和频率。例如`trans-coding video`or`compressing files`是相当 CPU 密集型的，因为它们运行 CPU 操作的次数远远超过读取/写入内存或磁盘所需的时间。如果你打算这样做，你应该为它创建一个单独的子进程，这样它就不会减慢单线程的节点进程，或者更好地创建一个[节点集群](http://nodejs.org/api/cluster.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T14:55:39.440

Bash 脚本确实涉及到这一点。我的教授总是喋喋不休地要求我们编写高效的代码来简化 CPU 上的工作

这是Linux中低效实践的一个很好的例子

[http://hacktux.com/bash/script/efficient](http://hacktux.com/bash/script/efficient)

我能想到的另一个例子是递归函数，或者是不断调用自身直到满足条件的函数。这些通常会占用大量 CPU 资源。

# python - 计算字符串的百分比而不是统计信息

> ID：15341553
> 
> 赞同：0
> 
> 时间：2013-03-11T14:49:36.433
> 
> 标签：python, statistics, percentage, letter

我想计算文件中每个字母的百分比而不是数字。如何修改以下代码？

```
stat_file = open(filename, 'w')
one_letter = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
for letter in one_letter:
    stat_file.writelines('%s : %d \n' % (letter, statistics[letter])) 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:39:13.620

您需要找到所有字母的总和，如下所示：

```
letter_count=0
for letter in one_letter:
    letter_count= letter_count + statistics[letter] 
```

然后要获得您需要更改代码的百分比，如下所示：

```
stat_file.writelines('%s : %d %% \n' % (letter, (statistics[letter]/letter_count)*100) if statistics[letter]>0 else 0) 
```

注意：我没有测试过代码（这台电脑上没有安装 python），但它应该可以工作。编辑：检查这封信是否发生了 0 次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T18:22:51.987

首先，字母总数可以有两种含义：

**1.只有在`one_letter`（你的问题中只有“AZ”）**

```
one_letter = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
stat = {'A': 5, 
          'B':3, 
          'C':9, 
          'U': 5, 
          'D': 9, 
          'a': 99}

total_count = sum(stat.get(letter, 0) for letter in one_letter) # should be 31 
```

**2.你文件中的所有单词（包括'az'，'0-9'，...）**

```
total_count = sum(stat.values()) # should be 130 
```

之后，您可以通过以下方式计算您的百分比

```
for letter in one_letter:
    stat_file.writelines("%s: %f%%\n" %(letter, \
        stat.get(letter, 0)/float(total_count)*100)) 
```

请注意，`stat.get(letter, 0)`如果不是所有字母都在`stat`.

如果您`stat[letter]`确定`A-Z`在`stat`.

# c# - Excel C#中缺少第一列和第一行

> ID：15341559
> 
> 赞同：0
> 
> 时间：2013-03-11T14:49:45.400
> 
> 标签：c#, excel, excel-2007

我正在尝试在 excel 中读取一个 excel 文件，但由于某种原因，数据中缺少第一列并且缺少第一行。

当我在 excel 中打开文件并保存它而不做任何更改时，文件被正确读取。

关于这可能如何发生的任何想法？

下面是我用来读取文件的代码：

```
string xlConn = "Provider=Microsoft.Jet.OLEDB.4.0;"
            + "Data Source="
            + txt_InputFile.Text
            + ";Extended Properties=Excel 8.0;";

using (OleDbConnection dbConnection = new OleDbConnection(xlConn))
{
    dbConnection.Open();

    // Get the name of the first worksheet:
    DataTable dbSchema = dbConnection.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, null);
    if (dbSchema == null || dbSchema.Rows.Count < 1)
    {
        //"Error: Could not determine the name of the first worksheet."
        throw new Exception(Program.lm_GetMethodLanguage(this.GetType().Name, "wp_InputFile_CloseFromNext", 5) );
    }
    string firstSheetName = dbSchema.Rows[0]["TABLE_NAME"].ToString();

    using (
        OleDbDataAdapter dbCommand = new OleDbDataAdapter("SELECT * FROM [" + firstSheetName + "]",
                                                            dbConnection))
    {
        using (DataSet myDataSet = new DataSet())
        {
            dbCommand.Fill(myDataSet);

            inputData = myDataSet.Tables[0];
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-11T15:05:53.830

使用这个。这将检索 excel 工作表中的所有工作表。

```
 private String[] GetExcelSheetNames(string excelFile)
    {
        try
        {
            excelConnectionString = @"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + ""yoursourcepath"+ ";Extended Properties=Excel 12.0;Persist Security Info=False";
            excelConnection = new OleDbConnection(excelConnectionString);
            excelConnection.Open();
            dt = excelConnection.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, null);

            if (dt == null)
            {
                return null;
            }

            excelSheets = new String[dt.Rows.Count];
            int i = 0;

            foreach (DataRow row in dt.Rows)
            {
                excelSheets[i] = row["TABLE_NAME"].ToString();
                i++;
            }

            return excelSheets;
        }
        catch (Exception ex)
        {
            return null;
        }
        finally
        {
            if (excelConnection != null)
            {
                excelConnection.Close();
                excelConnection.Dispose();
            }
            if (dt != null)
            {
                dt.Dispose();
            }
        }
    } 
```

# asp.net-mvc - 使用 MVC 设计 URL

> ID：15341560
> 
> 赞同：1
> 
> 时间：2013-03-11T14:49:48.637
> 
> 标签：asp.net-mvc, routes, asp.net-mvc-routing

假设我有一个要显示的订单列表。我想让用户能够显示所有订单，来自某个状态的所有订单，以及来自某个类别的所有订单。这些中的每一个都可以按日期范围进行过滤。

不用担心路由，我可能只在查询字符串中添加每个：

```
/orders?State=TX&Category=Books&DateRange=Yesterday 
```

虽然我可以轻松完成这项工作，但它并不“感觉”这是正确的 MVC 做事方式。

我可以有看起来像这样的路线：

```
/orders/              
/orders/state/{state}
/orders/category/{category}
/orders/state/{state}/category/{category}/
/orders/state/{state}/category/{category}/Date/{date-range} 
```

但我仍然想支持每个不存在的过滤器。有没有更好的方法来处理这个问题，还是我只是在想整个事情？

如果我只使用 URL 路径，则不清楚如何创建这些路由而不只是为我想要的所有组合重复它们（状态、无类别、日期、状态、无类别、无日期、无状态、类别、日期等）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T02:38:24.183

我认为查询参数版本适用于 MVC。可能让您感到困惑的是，当您想为用户提供特定订单的页面时，您确实将其`order_id`放入页面中。因此，在传统网站中，您只需创建该 URL

```
/order.html?order_id=1234 
```

（或其他），使用你想使用的 MVC

```
/orders/1234 
```

反而。不同之处在于，您只想在 URL 中放置强制参数——没有页面会中断的参数；不是每个参数。您不能返回没有订单 ID 的订单页面，因此它会出现在 URL 中。

您可以在一个页面上同时拥有这两者；举一个愚蠢的例子，如果你有一个订单的运输跟踪页面，你可以有一个类似的 URL

```
/orders/1234/tracking?since=9%3a00 
```

仅显示自上午 9:00 以来的跟踪事件（到达、离开）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T04:29:28.410

在查询参数中保留搜索/过滤选项实际上是一种常见的做法，例如在 google 上查看。
从我的角度来看，除非您关心过滤结果上的 seo 或希望此页面具有人性化的 url，否则支持任何可能的过滤器的路由是没有意义的。

# jquery - Jquery 验证不能正确验证数字？

> ID：15341564
> 
> 赞同：4
> 
> 时间：2013-03-11T14:49:52.820
> 
> 标签：jquery, asp.net-mvc, jquery-validate, unobtrusive-validation

我在使用 jquery 不显眼的验证验证数字时遇到了问题。我使用的版本是： ASP.MVC 3\. JQuery 1.9.1 JQuery UI 1.10.1 JQuery Validation 1.11.0

我要验证的输入是：

```
<input type="number" value="0" name="Data.time_between_loops.Planned.hour" id="Data_time_between_loops_Planned_hour" data-val-required="The hour field is required." data-val-range-min="0" data-val-range-max="23" data-val-range="The field hour must be between 0 and 23." data-val-number="The field hour must be a number." data-val="true" class="hour valid"> 
```

执行了验证，但问题是它是对作为字符串的值执行的，即当我键入 4 时出现验证错误。

我查看了 jquery.validation 的代码，看起来它不会将任何值（元素值，最小值/最大值）转换为数字，因此 range 函数比较值是字符串。我假设如果您在 jquery 中设置最小/最大范围，那么这些值将不是字符串，但是当您在数据属性中指定它们时，它们是字符串，而 jquery 似乎无法处理这个问题。

这是准备好 jquery 验证中的错误还是我做错了什么？

谢谢， Nadav 我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T16:34:41.490

在模型中使属性数据类型为整数。

关注这些帖子：

[验证 int 数据类型 asp .net mvc3](https://stackoverflow.com/questions/9937512/validation-on-int-data-type-asp-net-mvc3)

```
[Integer(ErrorMessage="Are you stupid? Just fill in numbers only!")]
public int? TestValue { get; set; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T17:34:57.840

[DataType(Integer)] 在 MVC 3 中有效。你可以做一个技巧。即使文本框 type='text' 并使用 javascript 验证该框仅接受数值。然后您可以通过范围验证来验证控件。

# java - 在 JavaFX 构建中添加外部 jar 文件

> ID：15341567
> 
> 赞同：0
> 
> 时间：2013-03-11T14:49:58.047
> 
> 标签：java, deployment, build, javafx

我开发了 javafx 应用程序，它使用来自 apache 的 httpclient jar 来发出 http 请求。

部署应用程序时，我按照文档使用了 winx 和 Inno 设置

我的 build.xml 文件如下：

```
 <target name="-post-jfx-deploy">
    <fx:deploy width="${javafx.run.width}" height="${javafx.run.height}"
       nativeBundles="all"
       outdir="${basedir}/${dist.dir}" outfile="${application.title}">
    <fx:application name="${application.title}" mainClass="${javafx.main.class}"/>
    <fx:resources>
        <fx:fileset dir="${basedir}/${dist.dir}">                
            <include name="*.jar"/>                
            <include name="l${basedir}/${dist.dir}/${lib.dir}/*.jar"/>              
        </fx:fileset>
    </fx:resources>
    <fx:info title="${application.title}" vendor="${application.vendor}"/>
    </fx:deploy>
    </target> 
```

但是，当生成打包的可执行文件时，它似乎不包含 httpjars，因为它会引发异常。

如何在构建中添加外部 jar 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:54:49.363

当我将以下内容添加到我的 javafx 应用程序构建文件时工作

```
<fx:fileset dir="dist" includes="lib/*.jar"/>

<fx:platform>
    <fx:jvmarg value="-Xmx1024m"/>
    <fx:jvmarg value="-verbose:jni"/>
    <property name="my.property" value="something"/>
</fx:platform>

<!-- request user level installation -->
<fx:preferences install="false"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-13T16:32:54.067

您问并回答:)谢谢..我遇到了类似的问题，但我通过以下方式解决了：

[https://stackoverflow.com/a/17092272/2267723](https://stackoverflow.com/a/17092272/2267723)

希望这会有所帮助..

# magento - 如何仅显示允许在 Magento 中登录用户的产品？

> ID：15341568
> 
> 赞同：0
> 
> 时间：2013-03-11T14:50:03.357
> 
> 标签：magento

在我们目前的 Magento 实现中，情况如下：

不同类别下有两种类型的产品（项目）。1\. 允许所有人 2\. 允许特定登录用户（客户）

例如让我们假设有 100 个项目（在不同类别下）允许显示给所有登录或未登录的用户

现在有 10 个项目只能由客户 A 看到（A 组） 5 个项目只能由客户 B 看到。（B 组）

因此，当客户 A 登录时，他/她将看到允许所有 + 来自 Set A 但不来自 Set B 的项目的所有项目。

当客户 B 登录时，他/她会将所有允许的项目都添加到集合 B 但不来自集合 A 的所有 + 项目。

如何在 Magento 中实现此结果？我应该在 MySQL 中还是在 Magento 模块中处理它？

请建议，

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T17:05:37.537

为每个产品创建三个属性。allowedgroupA、allowedGroupB 和 allowedAll。

现在对于仅用于 B 组的产品检查 allowedGroupB 和其他两个属性已完成检查。

仅对于 A 组检查 allowedGroupA 和其他两个属性完成检查的产品相同。

所有组的产品都将 allowedAll 选中。

现在在您的块代码中根据客户登录组应用适当的过滤器。

附加评论：此外，如果您的某些产品仅适用于特定组或所有人，则只有一个属性。允许的组 ID。如果设置了 allowedGroupId 则仅适用于该特定客户组，如果为 0 则适用于所有客户。

# tfs - Team Foundation 服务器中的代码行

> ID：15341571
> 
> 赞同：13
> 
> 时间：2013-03-11T14:50:03.723
> 
> 标签：tfs, azure-devops, lines-of-code

我正在寻找 TFS 的报告工具，我需要在 2 个日期之间为个人开发人员获取代码行，你认为它可以通过 TFS 实现吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2015-10-29T18:10:48.697

这就是我获取 TFS/Visual Studio 项目代码行的方式：

1.  开放式解决方案
2.  打开窗口：查看 -> 其他窗口 -> 代码度量结果
3.  运行指标：单击左上角的图标 - 计算解决方案的代码指标
    *   收集的指标
    *   有代码行列

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-10-08T23:55:00.283

我根据管理要求做了一次。这可能不是完美的解决方案，但它确实有效。我报告了为 TFS 分支添加的 LOC。我附上了旧版本（TFS 2008）的 TFS 立方体屏幕截图，因为这里缺少 TFS 版本。我相信新版本会是类似的。

![在此处输入图像描述](../Images/9e3790c2fb7a72b782e7c50c1319dd03.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-08T10:03:27.803

选项 2：

*   打开解决方案。
*   选择工具栏上的“分析”。
*   单击计算代码指标。
*   如果您单击了一个文件，它将允许您计算该文件，否则，选择“用于解决方案”

选项 3：

*   打开解决方案。
*   在解决方案资源管理器窗口中，右键单击解决方案并选择“计算代码指标”
*   这将再次在“代码指标结果”窗口中生成指标。

# php - 外循环只触发一次

> ID：15341574
> 
> 赞同：0
> 
> 时间：2013-03-11T14:50:07.280
> 
> 标签：php, javascript, loops

我有什么（对我来说）看起来像一个非常基本的嵌套循环。除了外部循环仅在第一次触发：

```
var js_recipes = <?php echo json_encode($recipesArray); ?>;
console.log("there are " + js_recipes.length + " recipes"); //console confirms 2

for (var i = 0; i < js_recipes.length; i++) {
    console.log("adding recipe"); //only fires once
    js_recipe = js_recipes[i];

    //add each ingredient
    for (var i = 0; i < js_recipe.ingredients.length; i++) {
        console.log("adding ing"); //fires multiple times for first recipe
    };
};
console.log("looping complete");//fires ok 
```

控制台输出为：

```
There are 2 recipes
adding recipe
adding ing
adding ing
adding ing
adding ing
looping complete 
```

我一定遗漏了一些简单的东西，但为什么我只迭代第一个食谱？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-11T14:51:20.473

变量的范围[要么是全局范围，要么是声明它的函数](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/var)`i`，所以你在这段代码中只有一个，并且`i`由内循环和外循环递增。

对不同的循环使用不同的迭代器变量。

```
for (var i = 0; i < js_recipes.length; i++) {
    console.log("adding recipe");
    js_recipe = js_recipes[i];

    //add each ingredient
    for (var j = 0; j < js_recipe.ingredients.length; j++) {
        console.log("adding ing"); 
    };
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T14:51:42.603

您正在使用相同的变量`i`。由于[***变量提升***](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/var#var_hoisting)，这两个声明成为一个。因此`i`，每次通过时 get 增加两次...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T14:54:14.717

如果存在函数变量范围问题，可以尝试将内部 for 循环设置为与 i 不同的变量，例如 j。

# javascript - 如何在 Ajax $.getJSON() 中获取 Json 作为键和值？

> ID：15341578
> 
> 赞同：3
> 
> 时间：2013-03-11T14:50:18.230
> 
> 标签：javascript, ajax, json, getjson

我有这个 ajax 代码用于从 Jobs.json 文件中获取 json。

```
 $(document).ready(function(){
        $('#btn2').click( callJobs );
        });

function callJobs()
{

     alert("getting results...");
    $.getJSON('Jobs.json', function(JSON){
        $('#result').empty();

        $.each(JSON.jobs, function(i, JOB){
            $('#result')
            .append(JOB.Job +'<br />')
            .append(JOB.Priority+'<br />')
            .append(JOB.DueDate+'<br />')
            .append(JOB.Iscompleted+'<hr />');
      });
    });
} 
```

Jobs.json 代码如下。

```
{
"jobs":[
  {
     "Job":"Job1",
     "Priority":"Low",
     "DueDate":"11.03.2013",
     "Iscompleted":"No"
  },
  {
     "Job":"Job2",
     "Priority":"High",
     "DueDate":"11.03.2013",
     "Iscompleted" : "No"
  },
  {
     "Job":"Job3",
     "Priority":"Medium",
     "DueDate":"11.03.2013",
     "Iscompleted":"No"
  }
  ]
  } 
```

现在我想动态重写 $.each 函数。也就是说，它将 json 字符串写为键和值，而不是 .append() 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:53:50.337

这将动态遍历每个作业的属性：

```
$.getJSON('Jobs.json', function(JSON){
    var $container = $('#result').empty();

    $.each(JSON.jobs, function(i, JOB) {
        $.each(JOB, function(key, value) {
            $container.append(key + ': ' + value + '<br />');
        });
        $container.append('<hr />');
    }
}); 
```

[**演示**](http://jsbin.com/isizos/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T14:55:07.227

这是我的方法。我添加了评论来解释这个过程。

```
$.each(JSON.jobs, function(i, JOB) {
    // an empty array for the output values
    var values = [];
    // iterator over each property in the current JOB object
    for (var prop in JOB) { 
        // add an item to the array in format "key: value"
        values.push(prop + ': ' + JOB[prop]); 
    }
    // join the array values using '<br />' as separator; 
    // append to #result and add an '<hr />' after
    $('#result').append(values.join('<br />')).append('<hr />');
}); 
```

我对这个解决方案的目标是保持它的可读性（以添加数组为代价），`#result`只选择一次元素，而不必处理知道是否`<br />`在每个循环中添加最后一个元素。`<br />`其他解决方案在最后一个属性之后和之前附加一个额外的，`<hr />`而这个和您的原始解决方案没有。

# java - 从 JAX-WS 服务返回大文件

> ID：15341580
> 
> 赞同：1
> 
> 时间：2013-03-11T14:50:26.787
> 
> 标签：java, web-services, jax-ws, mtom

我正在尝试从 JAX-WS 服务方法返回大文件，但出现奇怪的客户端错误。这是我的代码：

```
@WebService(targetNamespace = "http://java.CAEServer", portName = "CAEInstance")
public interface Instance  {
    @WebMethod(action = "http://java.CAEServer/getResultsArch")
    DataHandler getResultsArch(org.caebeans.caeserver.Instance instance);
} 
```

执行：

```
MTOM(enabled = true, threshold = 2048)
@BindingType(SOAPBinding.SOAP11HTTP_MTOM_BINDING)
@StreamingAttachment(parseEagerly=true, memoryThreshold=4000L)
@WebService(endpointInterface = "org.caebeans.wsrf.Instance")
public class InstanceImpl implements Instance {
    @Override
    public DataHandler getResultsArch(org.caebeans.caeserver.Instance instance) {
        try {
            return workStorageManager.getWorkPackage(instance.getId());
        } catch (Exception e) {
            logger.fatal("Failed to zip work", e);
            throw new RuntimeException("Failed to zip results");
        }
    }
} 
```

getWorkArch 返回带有压缩数据的 DataHandler。这是客户端代码：

```
Instance instanceTransport = new InstanceImplService().getInstanceImplPort();
SOAPBinding binding = (SOAPBinding) ((BindingProvider) instanceTransport).getBinding();
binding.setMTOMEnabled(true);

byte[] resultArch = instanceTransport.getResultsArch(instance); 
```

当我尝试运行它时，我遇到了错误。这是服务器堆栈跟踪：

```
java.io.IOException: Broken pipe
at sun.nio.ch.FileDispatcher.write0(Native Method)
at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:29)
at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:69)
at sun.nio.ch.IOUtil.write(IOUtil.java:40)
at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:336)
at sun.net.httpserver.Request$WriteStream.write(Request.java:397)
at sun.net.httpserver.ChunkedOutputStream.writeChunk(ChunkedOutputStream.java:108)
at sun.net.httpserver.ChunkedOutputStream.write(ChunkedOutputStream.java:77)
at sun.net.httpserver.PlaceholderOutputStream.write(ExchangeImpl.java:390)
at com.sun.xml.internal.ws.transport.http.server.ServerConnectionImpl$2.write(ServerConnectionImpl.java:163)
at javax.activation.DataHandler.writeTo(DataHandler.java:294)
at com.sun.xml.internal.ws.encoding.MtomCodec$ByteArrayBuffer.write(MtomCodec.java:189)
at com.sun.xml.internal.ws.encoding.MtomCodec.encode(MtomCodec.java:156)
at com.sun.xml.internal.ws.encoding.SOAPBindingCodec.encode(SOAPBindingCodec.java:249)
at com.sun.xml.internal.ws.transport.http.HttpAdapter.encodePacket(HttpAdapter.java:328)
at com.sun.xml.internal.ws.transport.http.HttpAdapter.access$100(HttpAdapter.java:82)
at com.sun.xml.internal.ws.transport.http.HttpAdapter$HttpToolkit.handle(HttpAdapter.java:470)
at com.sun.xml.internal.ws.transport.http.HttpAdapter.handle(HttpAdapter.java:233)
at com.sun.xml.internal.ws.transport.http.server.WSHttpHandler.handleExchange(WSHttpHandler.java:95)
at com.sun.xml.internal.ws.transport.http.server.WSHttpHandler.handle(WSHttpHandler.java:80)
at com.sun.net.httpserver.Filter$Chain.doFilter(Filter.java:65)
at sun.net.httpserver.AuthFilter.doFilter(AuthFilter.java:65)
at com.sun.net.httpserver.Filter$Chain.doFilter(Filter.java:68)
at sun.net.httpserver.ServerImpl$Exchange$LinkHandler.handle(ServerImpl.java:557)
at com.sun.net.httpserver.Filter$Chain.doFilter(Filter.java:65)
at sun.net.httpserver.ServerImpl$Exchange.run(ServerImpl.java:529)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:680) 
```

这是客户端堆栈跟踪：

```
xception in thread "main" java.lang.OutOfMemoryError: Java heap space
at com.sun.xml.internal.org.jvnet.staxex.ByteArrayOutputStreamEx.readFrom(ByteArrayOutputStreamEx.java:60)
at com.sun.xml.internal.org.jvnet.staxex.Base64Data.get(Base64Data.java:225)
at com.sun.xml.internal.org.jvnet.staxex.Base64Data.length(Base64Data.java:266)
at com.sun.xml.internal.ws.encoding.MtomCodec$MtomXMLStreamReaderEx.getTextCharacters(MtomCodec.java:508)
at com.sun.xml.internal.bind.v2.runtime.unmarshaller.StAXStreamConnector.handleCharacters(StAXStreamConnector.java:312)
at com.sun.xml.internal.bind.v2.runtime.unmarshaller.StAXStreamConnector.bridge(StAXStreamConnector.java:176)
at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(UnmarshallerImpl.java:351)
at com.sun.xml.internal.bind.v2.runtime.BridgeImpl.unmarshal(BridgeImpl.java:109)
at com.sun.xml.internal.bind.api.Bridge.unmarshal(Bridge.java:222)
at com.sun.xml.internal.ws.client.sei.ResponseBuilder$DocLit.readResponse(ResponseBuilder.java:514)
at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:110)
at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:78)
at com.sun.xml.internal.ws.client.sei.SEIStub.invoke(SEIStub.java:107)
at $Proxy31.getResultsArch(Unknown Source)
at Main.main(Main.java:73) 
```

怎么了？

**编辑**：这是我的主类中的托管代码：

```
Endpoint instanceEndpoint = Endpoint.publish(serverHost + INSTANCE_PATH, instance); 
```

客户端使用默认的 MacOS java 6 设置运行。我正在尝试下载 400Mb 文件，并且在未启用 TOM 的情况下，服务器因 OutOfMemory 错误而崩溃。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:25:48.367

以下是一些建议和意见：

1.  `Broken pipe`当服务器响应客户端但客户端连接**中途终止**时抛出异常。
2.  这很明显，因为您的客户端因内存不足错误而崩溃，并且它无法处理从服务器接收到的具有给定堆大小的数据量（我看到您正试图将数据保存在字节数组中。）。
3.  一种*最快*的解决方案是将客户端 VM**的堆大小**增加到适当的值。
4.  其他更实用的选择（*如果您的用例对此*表示满意）是将数据**流式**传输到持久位置（例如文件）。这样整个数据就不会加载到内存中

编辑：

如果您检查文档。有一个`StreamingDataHandler`类可用于流式传输数据。这个[这个特定的链接](http://docs.oracle.com/cd/E14571_01/web.1111/e13734/mtom.htm)。有一个名为*Streaming SOAP Attachments*的子主题。它提供了大文件下载的示例，非常接近您的用例。我认为您只需要更改客户端代码并使用`StreamingDataHandler`而不是`DataHandler`

# macos - 我在哪里可以找到 CocoaAsyncSocket 的非 ARC 版本？

> ID：15341584
> 
> 赞同：1
> 
> 时间：2013-03-11T14:50:27.857
> 
> 标签：macos, cocoa, asyncsocket

我有一个成功使用 AsyncSocket 的应用程序，但该应用程序需要在 32 位 Mac 系统上运行，所以我想要一个非 ARC 版本的 AsyncSocket。在我的搜索中，我发现 AsyncSocket 在早期版本中确实不是 ARC，但我找不到任何具有旧版本存档的站点。GitHub 似乎只有 ARC 版本。有谁知道我在哪里可以找到非 ARC 版本？

编辑：没关系，我回滚了 github 提交，可以得到我需要的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T18:49:19.340

旧问题的新答案，但如果有人想知道，CocoaAsyncSocket 在 7.1 中已转换为 ARC。为非 ARC 获取最新的 7.0.x。

有关 wiki 的更多信息：[链接](https://github.com/robbiehanson/CocoaAsyncSocket/wiki/ARC)

# c++ - 通过引用传递提升智能指针

> ID：15341586
> 
> 赞同：0
> 
> 时间：2013-03-11T14:50:33.527
> 
> 标签：c++, boost, c++98

以下函数将`Container`我在代码中使用的 a 转换为 ac 接口所需的。我必须将 a 传递`boost::shared_array<CValues>&`给此函数，因为我需要保持其关联的内存处于活动状态，直到我使用 cContainer。有没有更好的方法来做到这一点？

```
CContainer getCContainer(const Container& container, boost::shared_array<CValues>& values)
{
    CContainer cContainer;
    cContainer.type = boost::apply_visitor(CTypeGetter(), container);
    cContainer.nrOfValues = boost::apply_visitor(ContainerSizeGetter(), container);
    values = boost::shared_array<CValues>(new CValues[cContainer.nrOfValues]);
    boost::apply_visitor(ValueSetter(values), container);
    cContainer.values = values.get();
    return cContainer;
}

void store(Container& container)
{
    boost::shared_array<CValue> values;
    CContainer cContainer = getCContainer(container, values);
    cSave(cContainer);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:02:33.857

我会返回它，而不是传入参数。我假设 a`shared_array`只是复制指针，所以它既便宜又能更好地说明你在做什么。无论如何都应该省略副本。

# windows-phone-7 - 如何使用 c#.net 将 livedk messenger 集成到我的 windows phone 应用程序中

> ID：15341587
> 
> 赞同：0
> 
> 时间：2013-03-11T14:50:38.047
> 
> 标签：windows-phone-7, windows-phone-8, windows-phone-7.1, live-connect-sdk, live-sdk

在我的 windows phone 应用程序中，我希望允许同一应用程序的其他用户之间交换信息，并且该信息将用于创建某些记录。

livingdk 是否支持通过 windows phone 中的代码进行消息传递？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T17:53:55.720

Microsoft Live SDK 不公开 Messenger API。您可以访问以下 API 集：

*   [Hotmail API](http://msdn.microsoft.com/en-us/library/live/hh826535.aspx)（日历和联系人）
*   [身份 API](http://msdn.microsoft.com/en-us/library/live/hh826537.aspx)（用户身份和相关元数据）
*   [SkyDrive API](http://msdn.microsoft.com/en-us/library/live/hh826521.aspx)（存储）

# angularjs - AngularJS服务配置值在缩小时被破坏

> ID：15341588
> 
> 赞同：13
> 
> 时间：2013-03-11T14:50:48.903
> 
> 标签：angularjs, minify

在缩小和 AngularJS 方面遇到了一些麻烦；-(

我通过AngularJS Wiki页面找到了这个用于HTTP请求的[jsfiddle “加载”扩展器。](http://jsfiddle.net/dBR2r/8/)

在我发布它之前它工作得很好，并且缩小会破坏它。我找不到在配置上使用“注入”的方法，所以我有点不知道该怎么做。

原始代码：

```
angular.module("app.services", []).config(function($httpProvider) {
  var spinnerFunction;
  $httpProvider.responseInterceptors.push("myHttpInterceptor");
  spinnerFunction = function(data, headersGetter) {
    $("#loader").show();
    return data;
  };
  return $httpProvider.defaults.transformRequest.push(spinnerFunction);
}).factory("myHttpInterceptor", function($q, $window) {
  return function(promise) {
    return promise.then((function(response) {
      $("#loader").hide();
      return response;
    }), function(response) {
      $("#loader").hide();
      return $q.reject(response);
    });
  };
}); 
```

缩小代码：

```
angular.module("app.services", []).config(function (a) {
    var b;
    a.responseInterceptors.push("myHttpInterceptor");
    b = function (d, c) {
        $("#loader").show();
        return d
    };
    return a.defaults.transformRequest.push(b)
}).factory("myHttpInterceptor", function (a, b) {
    return function (c) {
        return c.then((function (d) {
            $("#loader").hide();
            return d
        }), function (d) {
            $("#loader").hide();
            return a.reject(d)
        })
    }
}); 
```

引发以下错误： **错误：未知提供者：来自 app.services**

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-03-11T15:26:15.050

使用[内联注解](http://docs.angularjs.org/guide/di)来定义提供者：

```
angular.module("app.services", [])
  .config(
    [
      '$httpProvider',
      'myHttpInterceptor',
      function($httpProvider, myHttpInterceptor) {
        var spinnerFunction;
        $httpProvider.responseInterceptors.push(myHttpInterceptor);
        spinnerFunction = function(data, headersGetter) {
         $("#loader").show();
         return data;
        };
        return $httpProvider.defaults.transformRequest.push(spinnerFunction);
      }
    ]
  ); 
```

而且，顺便说一句，您应该重新考虑在配置和工厂中使用 jQuery 调用。直接 DOM 操作应在指令内处理。

对于您的情况，`$("#loader").show();`您`$("#loader").show();`应该广播一个事件（例如`$rootScope.$broadcast('loader_show')`），然后在您的自定义“微调器”指令中监听该事件：

HTML：

```
<div spinner class="loader"></div> 
```

JS：

```
app.directive('spinner',
    function() {
      return function ($scope, element, attrs) {
        $scope.$on('loader_show', function(){
          element.show();
        });

        $scope.$on('loader_hide', function(){
          element.hide();
        });
      };

    }

  ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T17:06:40.817

仅针对处于相同情况的其他人...我遵循了@Stewie 的建议，而是做了这个，它只使用 AngularJS 代码，没有愚蠢的 jQuery 依赖 ;-)

**服务：**

```
app.config([
  "$httpProvider", function($httpProvider) {
    var spinnerFunction;
    $httpProvider.responseInterceptors.push("myHttpInterceptor");
    spinnerFunction = function(data, headersGetter) {
      return data;
    };
    return $httpProvider.defaults.transformRequest.push(spinnerFunction);
  }
]).factory("myHttpInterceptor", [
  "$q", "$window", "$rootScope", function($q, $window, $rootScope) {
    return function(promise) {
      $rootScope.$broadcast("loader_show");
      return promise.then((function(response) {
        $rootScope.$broadcast("loader_hide");
        return response;
      }), function(response) {
        $rootScope.$broadcast("loader_hide");
        $rootScope.network_error = true;
        return $q.reject(response);
      });
    };
  }
]); 
```

**指示**

```
app.directive("spinner", function() {
  return function($scope, element, attrs) {
    $scope.$on("loader_show", function() {
      return element.removeClass("hide");
    });
    return $scope.$on("loader_hide", function() {
      return element.addClass("hide");
    });
  };
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-06-18T09:19:33.597

尽管看起来很奇怪，但您也可以使用内联注释来实际`.push()`注入依赖项，`$q`而`$window`不是将 function() 放入`$httpProvider.responseInterceptors`push 数组中：

```
app.config(["$httpProvider", function($httpProvider) {
    $httpProvider.responseInterceptors.push(['$q', '$window', function($q, $window) {
        return function(promise) {
            return promise.then(function(response) {
                    $("#loader").hide();
                    return response;
                },
                function(response) {
                    $("#loader").hide();
                    return $q.reject(response);
                });
        };
    }]);
}]); 
```

# sql - SQL Plus XML 解析器不允许 å ä ö

> ID：15341596
> 
> 赞同：2
> 
> 时间：2013-03-11T14:51:21.630
> 
> 标签：sql, xml, xml-parsing, sqlplus, oracle-sqldeveloper

我有一个包含 XMLType 的表。我的标签包含 Å 和 Ö，例如“ÅR”我已经使用 Oracle SQL Developer 对其进行了解析，但是一旦我尝试在 Sql Plus 中使用相同的查询，它就不会接受 åäö。这个不知道怎么解决。。

所以在终端中（原始文件或 .sql 文件中）

```
select count(d.year)
from fic data, XMLTable('/Arkiv/Record'             
PASSING data.xmldata                
COLUMNS             
YEAR    varchar2(20)    PATH    'ÅR'
) d where data.id =7; 
```

会报以下错误：

```
ORA-19114: XPST0003 - error during parsing the XQuery expression:
LPX-00800: XQuery invalid token ''
1   ÅR
-  ^ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T16:09:38.970

这很可能是 sqlplus（或您从中调用它的 shell）以错误的编码提供数据的问题。

用 .替换文字中的非 ascii 字符`UTL_I18N.raw_to_char ( HEXTORAW ( '<character_as_octet_sequence>' ), '<charset_encoding>' )`。这会将字符转换为数据库字符集，并且应该通过其间的任何工具，因为您只需要 us-ascii 符号进行规范。

在你的例子中：

*   一个圆环 ->`UTL_I18N.raw_to_char ( HEXTORAW ( 'C5' ), 'WE8ISO8859P15' )`
*   O变音 ->`UTL_I18N.raw_to_char ( HEXTORAW ( 'D6' ), 'WE8ISO8859P15' )`

# iis - 显示来自 IIS 的所有站点绑定

> ID：15341599
> 
> 赞同：0
> 
> 时间：2013-03-11T14:51:36.827
> 
> 标签：iis, powershell, binding, sites

是否有任何 powershell 脚本或任何 vbscript 可以显示来自 IIS 的所有站点绑定？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:57:19.143

尝试`Get-WebBinding`cmdlet（IIS 7 及更高版本）：

```
Import-Module WebAdministration
Get-WebBinding 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:59:26.460

试试这个：

```
Import-Module WebAdministration
$Websites = Get-ChildItem IIS:\Sites
$site = $websites
$site.bindings.Collection 
```

# javascript - 使用 PHP 的 Javascript 倒计时

> ID：15341600
> 
> 赞同：3
> 
> 时间：2013-03-11T14:51:39.667
> 
> 标签：javascript

我想在我的 PHP 页面上有一个与特定按钮关联的倒计时，我正在使用以下基于 javascript 的代码但是，它会在页面重新加载时重置目标值，所以如何在不重置目标值的情况下获得相同的值。我可以用会话做点什么？

```
 <html>
    <body>
<p>Time remaining: <span id="countdownTimer"><span>00:00.<small>00</small></span></p>
<script type="text/javascript">
if (document.getElementById('countdownTimer')) {
    pad = function(n, len) { // leading 0's
        var s = n.toString();
        return (new Array( (len - s.length + 1) ).join('0')) + s;
    };

    function countDown() {
        var now = new Date();
        if ( (now.getDay() >= 0) && (now.getDay() <= 6) ) { // Monday to Friday only
            var target = 23; // 15:00hrs is the cut-off point
            if (now.getHours() < target) { // don't do anything if we're past the cut-off point
                var hrs = (target - 1) - now.getHours();
                if (hrs < 0) hrs = 0;
                var mins = 59 - now.getMinutes();
                if (mins < 0) mins = 0;
                var secs = 59 - now.getSeconds();
                if (secs < 0) secs = 0;
                var str = pad(hrs, 2) + ':' + pad(mins, 2) + '.<small>' + pad(secs, 2) + '</small>';
                document.getElementById('countdownTimer').innerHTML = str;
            }
        }
    }
    var timerRunning = setInterval('countDown()', 1000);
}
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T01:13:48.250

而不是像这样评估您的变量“现在”：

```
var now = new Date(); 
```

像这样评估它（假设我们的浏览器支持 LocalStorage）：

```
if (!localStorage.myDate)
    localStorage.myDate = (new Date()).toString();
var now = new Date(localStorage.myDate); 
```

这样，我们只会在首次加载时评估当前日期。之后，我们引用该日期的序列化字符串版本，并在创建“现在”变量时将其作为参数传递。

如果我们想支持旧版浏览器（*咳嗽*IE），我们可以使用 userData 或简单地使用 cookie 做一些非常相似的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T23:31:19.610

所以本质上，你想捕捉“现在”一次，而不是改变，对吗？

```
function getNow(){ //call this rather than use var now = new Date();
  if (window.localStorage){
      if (!localStorage.now){
        localStorage.now = new Date();
      }
      return localStorage.now;
  }else{
    return new Date();
  }
} 
```

请原谅我有一些语法错误（我不确定您是否必须转换日期才能将其存储在 localStorage 中），但这就是它的要点。对于 IE7 及以下支持，您需要使用 cookie，但概念保持不变。

另外，我认为你有一个错误：

```
 if ( (now.getDay() >= 0) && (now.getDay() <= 6) ) 
```

这将永远是真的，请尝试：

```
if ( (now.getDay() > 0) && (now.getDay() < 6) ) 
```

# qt - Qt 5.0.1 无法启动程序

> ID：15341603
> 
> 赞同：1
> 
> 时间：2013-03-11T14:51:43.267
> 
> 标签：qt, compiler-errors

我对 Qt 有奇怪的问题。最近我下载了 Qt 5.0.1。现在我在 Qt 中以“Build->Start”开始的每个项目都运行良好。但是，如果我从资源管理器启动它的发布版本，则没有效果。如果我从资源管理器启动调试版本我有这个错误

![在此处输入图像描述](../Images/cf523fd3bb1758f3071edf8eb7b30bea.png)

怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T07:22:55.023

我认为您忘记在应用程序旁边复制插件目录。Dependency Walker 不会在列表中显示它们，因为它们是由 Qt Core 库在运行时加载的。所以最终的可执行文件在编译时不知道这些插件的链接或位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-03T12:19:05.340

它准确地说，它需要什么——“windows”插件。它应该位于文件夹“平台”中，如`qwindows.dll`.

您可以在[Qt5 官方 windows 部署指南](http://qt-project.org/doc/qt-5.0/qtdoc/deployment-windows.html)中阅读更多内容，但可以在论坛上查看更多实用信息，即[此处](http://qt-project.org/forums/viewthread/25714)。

简而言之：要使您的应用程序（使用动态构建的 Qt 编译）在其他机器上运行，您必须包含许多库。所有这些都应该从

```
Qt_installation_folder/Qt_version/used_compiler/bin
&
Qt_installation_folder/Qt_version/used_compiler/plugins/ 
```

QML 插件应该从

```
Qt_installation_folder/Qt_version/used_compiler/qml
&
Qt_installation_folder/Qt_version/used_compiler/imports 
```

从项目中使用的完全相同的编译器复制 Qt 库非常重要。

下面我向您展示一个带有解释的示例（从[上面的第二个链接](http://qt-project.org/forums/viewthread/25714)借来的）：

```
ROOT FOLDER
│   YourApp.exe
│   D3DCompiler_43.dll        // } \
│   libEGL.dll                // }  --> If you use Qt built with ANGLE support
│   libGLESv2.dll             // } /
│   
│   icudt49.dll               // } \
│   icuin49.dll               // }  --> If you use Qt built with WebKit (Unicode support)
│   icuuc49.dll               // } /
│   
│   Qt5Core.dll               // --> Basic Qt module, always needed
│   Qt5Gui.dll                // --> If you use GUI module
│   
│   Qt5Network.dll            // } \
│   Qt5Qml.dll                // }  --> If you use QML
│   Qt5Quick.dll              // }  --> module
│   Qt5V8.dll                 // } /
│   
│   Qt5Multimedia.dll         // } --> If you use multimedia
│   Qt5MultimediaQuick_p.dll  // } --> from QtQuick
│
├───platforms
│       qwindows.dll          // Always needed for windows
│
├───QtMultimedia              // If you import QtMultimedia 5.x 
│       declarative_multimedia.dll
│       plugins.qmltypes
│       qmldir
│       Video.qml
│
├───QtQuick.2                 // If you import Qt.Quick 2.x
│       plugins.qmltypes
│       qmldir
│       qtquick2plugin.dll 
```

# ios - iOS FloodFill：UIImage vs Core Graphics

> ID：15341605
> 
> 赞同：0
> 
> 时间：2013-03-11T14:51:47.777
> 
> 标签：ios, uiimage, core-graphics, quartz-2d, flood-fill

我正在考虑构建一个会大量使用洪水填充/油漆桶功能的应用程序。我要着色的图像就像着色书页一样；白色背景，黑色边框。我正在争论哪个更好用`UIImage`（通过操作像素数据）或绘制图像`Core Graphics`并更改触摸时的填充颜色。

使用`UIImage`，我无法正确解释视网膜图像；当我将上下文写入 new 时，它会破坏图像`UIImage`，但我可能会弄清楚。我打开提示虽然...

使用`CoreGraphics`，我不知道如何计算当用户触摸一个区域然后实际填充该区域时要填充的形状。我看过，但我没有找到成功的搜索。

总的来说，我相信最佳解决方案是使用`CoreGraphics`，因为它总体上会更轻，而且我不必为不同尺寸保留多个相同图像的副本。

想法？对我轻点！这是我的第一个应用程序和第一个 SO 问题；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:31:38.300

我建议使用核心图形。

代替图像，使用`CGPath`or定义形状`NSBezierPath`，并使用 Core Graphics 来描边和/或填充形状。填充形状就像将绘图模式从仅描边切换到描边和填充一样简单。

使用“PaintCode”应用程序（可让您绘制并为您创建路径代码）可以更轻松地创建更复杂的形状。

不过，作为您的第一个应用程序，我建议您使用较少的自定义图形摆弄。

# pyinstaller - 如果在没有控制台的情况下构建，pyinstaller 程序将无法工作

> ID：15341606
> 
> 赞同：5
> 
> 时间：2013-03-11T14:51:48.947
> 
> 标签：pyinstaller

我有一个小应用程序，我正在尝试针对 Windows 机器构建。该程序创建一个 OpenVPN 连接。如果我构建程序并运行它，它首先会打开一个控制台作为程序输出。如果我将`-w`参数传递给 pyinstaller 以不使用附加的控制台构建它，则程序根本无法运行。它可以正常打开，但永远不会创建 vpn 连接。

使用控制台，一切都完美无缺。

我还为应用程序设置了一个基本日志记录，以查看我的代码可能在哪里停止并且没有写入任何内容。在我的程序上使用控制台会吐出各种日志。

我只是不知道为什么我的程序可以在控制台上完美运行，但没有控制台什么也不做。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-16T00:33:21.557

这个我自己来回答。确保您不打印任何内容，并将所有标准输出重定向到记录器、文件或其他任何内容，而不是控制台。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-11-14T20:53:58.587

我遇到了类似的问题，但找不到任何用于控制台的打印/标准输出语句。我正在使用 subprocess.Popen 并重定向 stdout=subprocess.PIPE。我随后添加了 stderr=subprocess.STDOUT 和 stdin=subprocess.PIPE 并且我的程序正常工作。这个页面（[Python subprocess.call() 在使用 pythonw.exe 时失败](https://stackoverflow.com/questions/337870/python-subprocess-call-fails-when-using-pythonw-exe/386343#386343)）子进程失败帮助我让它工作。

# scala - 在 Play2 Scala 中使用 reactivemongo 显示来自 MongoDB 的图像

> ID：15341608
> 
> 赞同：3
> 
> 时间：2013-03-11T14:51:55.130
> 
> 标签：scala, playframework-2.0

我将此列表传递给 Play2 模板：

```
files: Option[List[(String, reactivemongo.api.gridfs.ReadFile[reactivemongo.bson.BSONValue])]]) 
```

怎么做我从列表中拉出第一张图像并将该图像渲染到 html 标记

```
<img src=" "> 
```

任何帮助都会很棒:)

谢谢丹尼

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:08:39.647

通过查看响应式 mongo 演示应用程序，您似乎必须添加一条从 gridfs 提供图像的路由。查看[路由文件](https://github.com/sgodbillon/reactivemongo-demo-app/blob/master/conf/routes#L13)和[控制器](https://github.com/sgodbillon/reactivemongo-demo-app/blob/master/app/controllers/Application.scala#L158)，该示例显示了如何提供附件。所以你的情况可能是这样的：

在路由文件中：

```
GET     /img/:id            controllers.Images.getImg(id) 
```

在`Images`控制器中：

```
def getImg(id: String) = Action {
  Async {
    import reactivemongo.api.gridfs.Implicits.DefaultReadFileReader
    val file = gridFS.find(BSONDocument("_id" -> new BSONObjectID(id)))
    serve(gridFS, file)
  }
} 
```

然后在您的模板中：

```
@if(files.isDefined) {
    @files.get.map { file =>
    <img src="@routes.Images.getImg(file._1)"/>
  }
} 
```

# javascript - 向滚动幻灯片添加类似子弹的按钮

> ID：15341610
> 
> 赞同：0
> 
> 时间：2013-03-11T14:52:05.097
> 
> 标签：javascript, jquery, html, slideshow

所以我想在幻灯片底部添加类似子弹的按钮，但我找不到教程，所以想你们可以帮助我。这是一个例子： http: [//line25.com/wp-content/uploads/2011/jquery-slideshow/demo/index.html](http://line25.com/wp-content/uploads/2011/jquery-slideshow/demo/index.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:59:34.540

在链接上使用 CSS 背景：

```
<a href="..." class="someClass">...</a> 
```

CSS：

```
.someClass {
    background-image:url(/images/...);   <--path to your image
    background-repeat:no-repeat;
    display:block;
    height:20px;
    width:20px;   <--- set sizes to match your image.
} 
```

# html - 如何使用html在c#中显示表中的最后2项

> ID：15341615
> 
> 赞同：0
> 
> 时间：2013-03-11T14:52:11.990
> 
> 标签：html, visual-studio-2010, razor, asp.net-mvc-4, sql-server-2008-r2

我试图在我的 Index.cshtml 中显示添加到我的表中的最后两个项目。

```
public class News
{
    [Key]
    public int id { get; set; }

    public string Titre { get; set; }

    public string Description { get; set; }

    public string Image { get; set; }

    public System.DateTime Date { get; set; }
} 
```

现在使用这个我想显示使用日期添加的最后两个“新闻”。

```
<!--Last item #1-->
<div class="newsBlock" style="clear:left;">
    <img src="" />
    <p></p>
</div>

<!--Last item #2-->
<div class="newsBlock" style="clear:right;">
    <img src="" />
    <p></p>
</div>
<p style="clear:both;">&nbsp;</p> 
```

我尝试使用剃须刀forloop，但以某种方式无法做到，我最终得到了这个......

```
@foreach (var item in Model)
{
    @{var test = Model.OrderByDescending(modelItem => model.Date).Take(2).ToArray();}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:55:34.257

```
@foreach (var item in Model.OrderByDescending(modelItem => modelItem.Date).Take(2).ToList())
{
    <div class="newsBlock" style="clear:left;">
        <img src="@item.Image" />
        <p>@item.Title</p>
    </div>
} 
```

**或者**

控制器中的更好方法

```
public Action Index()
{
    return View(db.News.OrderByDescending(modelItem => modelItem.Date).Take(2).ToList());
} 
```

看法

```
@model IEnumerable<News>

@foreach (var item in Model)
{
    <div class="newsBlock" style="clear:left;">
        <img src="@item.Image" />
        <p>@item.Title</p>
    </div>
} 
```

# jquery - 垂直图像的纵横比

> ID：15341616
> 
> 赞同：1
> 
> 时间：2013-03-11T14:52:31.740
> 
> 标签：jquery

我遇到的问题是，有时垂直图像没有获得纵横比并且会被拉伸，但是其他一些垂直图像可以很好地获得比例并且可以很好地放入容器中。

两个垂直图像**没有得到高度，因为它的容器纵横比 = NaN**

这是代码：

```
function Gallery(selector){
    this.add_module = function(type, image){

        var portrait_text = image.next('.portrait_text');

        var container = $('<div />' , {
            'class' : 'gallery_container'
        }).append(image).append(portrait_text);

        if(type == 'horizontal'){
            var h_ar = image.attr('height') / image.attr('width');
            var c_width = selector.width();
            var c_height = selector.width()*h_ar
            container.css({
                'width' : c_width -10,
                'height' : c_height
            })
        }
        if(type == 'vertical'){
            var c_width = v_width;
            var c_height = v_height
            container.css({
                'width' : Math.floor(v_width) -5,
                'height' : v_height
            })
        }
        container.css({
            'float' : 'left'
        })
        container.find('img').attr({
            'width' : '100%',
            'height' : '100%'
        })
        container.attr('ar' , c_height/c_width)
        container.appendTo(selector);

        //container.children('img').fitToBox();
    }

    this.resized = function(){
        //console.log(sel)
        $('.gallery_container').each(function(){
            if($(this).attr('ar') >= 1){ // vertical
                $(this).css({
                    'width' : Math.floor(sel.width()/2) -5,
                    'height' : sel.width()/2 * $(this).attr('ar')
                })
            }else{ // horizontal
                $(this).css({
                    'width' : sel.width() -10,
                    'height' : sel.width() * $(this).attr('ar')
                })
            }
        })
    }
    var _this = this;
    var gutter = 0;
    // start vars for counting on vertical images
    var v_counter = 0;
    var w_pxls = 0;
    var h_pxls = 0;
    // iterates through images looking for verticals
    selector.children('img').each(function(){
        if($(this).attr('width') < $(this).attr('height')){
            v_counter++;
            h_pxls += $(this).attr('height');
            w_pxls += $(this).attr('width');
        }
    })
    // calculates average ar for vertical images (anything outside from aspect ratio will be croped)
    var h_avrg = Math.floor(h_pxls/v_counter);
    var w_avrg = Math.floor(w_pxls/v_counter);
    var v_ar = h_avrg/w_avrg;
    var v_width = Math.floor((selector.width())/2);
    var v_height = v_width*v_ar;
    var sel = selector;
    selector.children('img').each(function(){
        if(parseInt($(this).attr('width')) > parseInt($(this).attr('height'))){
            _this.add_module('horizontal', $(this));
        }else{
            _this.add_module('vertical', $(this));
        }
    })
    $(window).bind('resize' , _this.resized);
}

var gallery = new Gallery($('#gallery_images_inner')); 
```

任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:55:48.713

不要将图像高度设置为 100%，将高度设置为`auto`，以便保持比例所需的高度。

问题在这里：

```
container.find('img').attr({
    'width' : '100%'
}) 
```

# symfony - 带有模拟服务的 Symfony 2 功能测试

> ID：15341623
> 
> 赞同：23
> 
> 时间：2013-03-11T14:52:53.690
> 
> 标签：symfony, dependency-injection, phpunit

我有一个控制器，我想为其创建功能测试。该控制器通过类向外部 API 发出 HTTP 请求`MyApiClient`。我需要模拟这个类，所以我可以测试我的控制器如何响应给定的响应（例如，如果类返回 500 响应`MyApiClient`它将做什么）。`MyApiClient`

我通过标准 PHPUnit mockbuilder 创建类的模拟版本没有问题`MyApiClient`：我遇到的问题是让我的控制器将此对象用于多个请求。

我目前在测试中执行以下操作：

```
class ApplicationControllerTest extends WebTestCase
{

    public function testSomething()
    {
        $client = static::createClient();

        $apiClient = $this->getMockMyApiClient();

        $client->getContainer()->set('myapiclient', $apiClient);

        $client->request('GET', '/my/url/here');

        // Some assertions: Mocked API client returns 500 as expected.

        $client->request('GET', '/my/url/here');

        // Some assertions: Mocked API client is not used: Actual MyApiClient instance is being used instead.
    }

    protected function getMockMyApiClient()
    {
        $client = $this->getMockBuilder('Namespace\Of\MyApiClient')
            ->setMethods(array('doSomething'))
            ->getMock();

        $client->expects($this->any())
            ->method('doSomething')
            ->will($this->returnValue(500));

        return $apiClient;
    }
} 
```

似乎在发出第二个请求时正在重建容器，导致`MyApiClient`再次实例化。该类`MyApiClient`通过注解（使用 JMS DI Extra Bundle）配置为服务，并通过注解注入到控制器的属性中。

如果可以的话，我会将每个请求拆分为自己的测试以解决此问题，但不幸的是我做不到：我需要通过 GET 操作向控制器发出请求，然后发布它返回的表单。我想这样做有两个原因：

1）表单使用CSRF保护，所以如果我直接POST到表单而不使用爬虫提交，表单没有通过CSRF检查。

2) 测试表单在提交时生成正确的 POST 请求是一种奖励。

有人对如何做到这一点有任何建议吗？

**编辑：**

这可以在以下不依赖于我的任何代码的单元测试中表示，因此可能更清楚：

```
public function testAMockServiceCanBeAccessedByMultipleRequests()
{
    $client = static::createClient();

    // Set the container to contain an instance of stdClass at key 'testing123'.
    $keyName = 'testing123';
    $client->getContainer()->set($keyName, new \stdClass());

    // Check our object is still set on the container.
    $this->assertEquals('stdClass', get_class($client->getContainer()->get($keyName))); // Passes.

    $client->request('GET', '/any/url/');

    $this->assertEquals('stdClass', get_class($client->getContainer()->get($keyName))); // Passes.

    $client->request('GET', '/any/url/');

    $this->assertEquals('stdClass', get_class($client->getContainer()->get($keyName))); // Fails.
} 
```

此测试失败，即使我`$client->getContainer()->set($keyName, new \stdClass());`在第二次调用之前立即调用`request()`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-11-13T10:29:18.403

当你调用 时`self::createClient()`，你会得到一个 Symfony2 内核的启动实例。这意味着，所有配置都被解析和加载。现在发送请求时，您是第一次让系统完成它的工作，对吧？

在第一个请求之后，您可能想要检查发生了什么，因此，内核处于发送请求的状态，但它仍在运行。

如果您现在运行第二个请求，网络架构要求内核重新启动，因为它已经运行了一个请求。当您第二次执行请求时，将在您的代码中执行此重新启动。

如果您想在请求发送给它之前启动内核并对其进行修改（如您所愿），您必须关闭旧的内核实例并启动一个新的实例。

你可以通过重新运行来做到这一点`self::createClient()`。现在你必须再次应用你的模拟，就像你第一次做的那样。

这是您的第二个示例的修改代码：

```
public function testAMockServiceCanBeAccessedByMultipleRequests()
{
    $keyName = 'testing123';

    $client = static::createClient();
    $client->getContainer()->set($keyName, new \stdClass());

    // Check our object is still set on the container.
    $this->assertEquals('stdClass', get_class($client->getContainer()->get($keyName)));

    $client->request('GET', '/any/url/');

    $this->assertEquals('stdClass', get_class($client->getContainer()->get($keyName)));

    # addded these two lines here:
    $client = static::createClient();
    $client->getContainer()->set($keyName, new \stdClass());

    $client->request('GET', '/any/url/');

    $this->assertEquals('stdClass', get_class($client->getContainer()->get($keyName)));
} 
```

现在您可能想要创建一个单独的方法，为您模拟新实例，因此您不必复制代码......

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-07-03T17:47:44.073

我以为我会跳到这里。Chrisc，我想你想要的是这里：

[https://github.com/PolishSymfonyCommunity/SymfonyMockerContainer](https://github.com/PolishSymfonyCommunity/SymfonyMockerContainer)

我同意您的一般方法，在服务容器中将其配置为参数确实不是一个好方法。整个想法是能够在单独的测试运行期间动态地模拟它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-11T22:05:39.763

您所遇到的行为实际上是您在任何真实场景中所经历的，因为 PHP 不共享任何内容并在每个请求上重建整个堆栈。功能测试套件模仿这种行为不会产生错误的结果。一个示例是具有 ObjectCache 的教条，因此您可以创建对象，而不是将它们保存到数据库中，并且您的测试将全部通过，因为它始终将对象从缓存中取出。

您可以通过不同的方式解决此问题：

创建一个真正的类，它是一个 TestDouble 并模拟您期望从真正的 API 获得的结果。这实际上非常简单：您创建一个`MyApiClientTestDouble`与您的 normal 具有相同签名的新`MyApiClient`方法，并在需要的地方更改方法主体。

在你的 service.yml 中，你可能有这个：

```
parameters:
  myApiClientClass: Namespace\Of\MyApiClient

service:
  myApiClient:
    class: %myApiClientClass% 
```

如果是这种情况，您可以通过将以下内容添加到 config_test.yml 来轻松覆盖所采用的类：

```
parameters:
  myApiClientClass: Namespace\Of\MyApiClientTestDouble 
```

现在服务容器将在测试时使用您的 TestDouble。如果两个类具有相同的签名，则不需要更多。我不知道这是否或如何与 DI Extras Bundle 一起使用。但我想有办法。

或者您可以创建一个 ApiDouble，实现一个“真实”API，其行为方式与您的外部 API 相同，但返回测试数据。然后，您将使 API 的 URI 由服务容器处理（例如 setter 注入）并创建一个指向正确 API 的参数变量（在开发或测试的情况下为测试，在生产环境的情况下为真实的）。

第三种方式有点笨拙，但您始终可以在测试`request`中创建一个私有方法，该方法首先以正确的方式设置容器，然后调用客户端发出请求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-31T11:24:29.430

我不知道你是否知道如何解决你的问题。但这是我使用的解决方案。这对其他人也有好处。

经过长时间搜索在多个客户端请求之间模拟服务的问题后，我发现了这篇博文：

[http://blog.lyrixx.info/2013/04/12/symfony2-how-to-mock-services-during-functional-tests.html](http://blog.lyrixx.info/2013/04/12/symfony2-how-to-mock-services-during-functional-tests.html)

lyrixx 讨论了内核如何在每次请求后关闭，从而在您尝试发出另一个请求时使服务覆盖无效。

为了解决这个问题，他创建了一个仅用于功能测试的 AppTestKernel。

这个 AppTestKernel 扩展了 AppKernel 并且只应用了一些处理程序来修改内核：来自 lyrixx 博客文章的代码示例。

```
<?php

// app/AppTestKernel.php

require_once __DIR__.'/AppKernel.php';

class AppTestKernel extends AppKernel
{
    private $kernelModifier = null;

    public function boot()
    {
        parent::boot();

        if ($kernelModifier = $this->kernelModifier) {
            $kernelModifier($this);
            $this->kernelModifier = null;
        };
    }

    public function setKernelModifier(\Closure $kernelModifier)
    {
        $this->kernelModifier = $kernelModifier;

        // We force the kernel to shutdown to be sure the next request will boot it
        $this->shutdown();
    }
} 
```

然后，当您需要在测试中覆盖服务时，您调用 testAppKernel 上的设置器并应用模拟

```
class TwitterTest extends WebTestCase
{
    public function testTwitter()
    {
        $twitter = $this->getMock('Twitter');
        // Configure your mock here.
        static::$kernel->setKernelModifier(function($kernel) use ($twitter) {
            $kernel->getContainer()->set('my_bundle.twitter', $twitter);
        });

        $this->client->request('GET', '/fetch/twitter'));

        $this->assertSame(200, $this->client->getResponse()->getStatusCode());
    }
} 
```

遵循本指南后，我在使用新的 AppTestKernel 启动 phpunittest 时遇到了一些问题。

我发现 symfonys WebTestCase ( [https://github.com/symfony/symfony/blob/master/src/Symfony/Bundle/FrameworkBundle/Test/WebTestCase.php](https://github.com/symfony/symfony/blob/master/src/Symfony/Bundle/FrameworkBundle/Test/WebTestCase.php) ) 采用它找到的第一个 AppKernel 文件。因此，摆脱这种情况的一种方法是将 AppTestKernel 上的名称更改为在 AppKernel 之前或覆盖该方法以取而代之 TestKernel

在这里，我覆盖了 WebTestCase 中的 getKernelClass 以查找 *TestKernel.php

```
 protected static function getKernelClass()
  {
            $dir = isset($_SERVER['KERNEL_DIR']) ? $_SERVER['KERNEL_DIR'] : static::getPhpUnitXmlDir();

    $finder = new Finder();
    $finder->name('*TestKernel.php')->depth(0)->in($dir);
    $results = iterator_to_array($finder);
    if (!count($results)) {
        throw new \RuntimeException('Either set KERNEL_DIR in your phpunit.xml according to http://symfony.com/doc/current/book/testing.html#your-first-functional-test or override the WebTestCase::createKernel() method.');
    }

    $file = current($results);

    $class = $file->getBasename('.php');

    require_once $file;

    return $class;
} 
```

在此之后，您的测试将使用新的 AppTestKernel 加载，您将能够在多个客户端请求之间模拟服务。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-10-01T04:28:01.083

根据 Mibsen 的回答，您还可以通过扩展 WebTestCase 并覆盖 createClient 方法以类似的方式进行设置。这些方面的东西：

```
class MyTestCase extends WebTestCase
{
    private static $kernelModifier = null;

    /**
     * Set a Closure to modify the Kernel
     */
    public function setKernelModifier(\Closure $kernelModifier)
    {
        self::$kernelModifier = $kernelModifier;

        $this->ensureKernelShutdown();
    }

    /**
     * Override the createClient method in WebTestCase to invoke the kernelModifier
     */
    protected static function createClient(array $options = [], array $server = [])
    {
        static::bootKernel($options);

        if ($kernelModifier = self::$kernelModifier) {
            $kernelModifier->__invoke();
            self::$kernelModifier = null;
        };

        $client = static::$kernel->getContainer()->get('test.client');
        $client->setServerParameters($server);

        return $client;
    }
} 
```

然后在测试中你会做类似的事情：

```
class ApplicationControllerTest extends MyTestCase
{
    public function testSomething()
    {
        $apiClient = $this->getMockMyApiClient();

        $this->setKernelModifier(function () use ($apiClient) {
            static::$kernel->getContainer()->set('myapiclient', $apiClient);
        });

        $client = static::createClient();

        ..... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-21T19:38:26.060

我在 Symfony 4.4 中遇到了同样的问题。

在阅读 [使用 Symfony 在 API 功能测试中创建模拟](https://stackoverflow.com/questions/59672899/symfony-4-4-deprecation-warning-for-multiple-clients-in-user-test-is-deprecated#)后， 我找到了一个解决方案 -`self::ensureKernelShutdown()`

```
...    
$client->request('GET', '/any/url/');
$this->assertEquals('stdClass', get_class($client->getContainer()->get($keyName))); // Passes.

self::ensureKernelShutdown()

$client->request('GET', '/any/url/');
$this->assertEquals('stdClass', get_class($client->getContainer()->get($keyName))); // Passes.
... 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-25T16:24:10.520

做一个模拟：

```
$mock = $this->getMockBuilder($className)
             ->disableOriginalConstructor()
             ->getMock();

$mock->method($method)->willReturn($return); 
```

替换模拟对象上的 service_name：

```
$client = static::createClient()
$client->getContainer()->set('service_name', $mock); 
```

我的问题是使用：

```
self::$kernel->getContainer(); 
```

# matplotlib - 如何使用 matplotlib 为数学文本和常规文本使用不同的字体类型？

> ID：15341628
> 
> 赞同：2
> 
> 时间：2013-03-11T14:53:08.307
> 
> 标签：matplotlib, latex

我正在使用*ieeconf*乳胶类来编写文档。为了生成文档的图，我使用*matplotlib 1.2*。出于某种原因，ieeconf 类对常规文本使用*Times*字体，对数学文本使用*Computer Modern roman*。如果在 matplotlib 我使用以下*matplotlibrc*文件

```
font.family         : serif
font.serif          : Times
text.usetex         : True 
```

图中的常规文本（非数学）看起来与文档其余部分的常规文本完全相同。但是，图中的数学文本看起来与文档中的数学文本不同。如果我改为使用`font.serif : Computer Modern Roman`，那么角色会颠倒过来，数学课文看起来相同，但常规课文看起来不同。

如何让 matplotlib 对常规文本使用一种字体类型，对数学文本使用另一种字体类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:46:30.480

在 Matplotlib 中，您可以使用以下命令提供 Latex 命令：（`rc('text.latex', preamble = [r''])`有点像他们在[这里](http://matplotlib.org/users/pgf.html#custom-preamble)做的）。那么[这](https://tex.stackexchange.com/questions/5675/how-to-change-math-font-only)可能会帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-19T11:15:23.820

从[3.4 版](https://matplotlib.org/stable/users/prev_whats_new/whats_new_3.4.0.html#math-fontfamily-parameter-to-change-text-font-family)开始，您可以使用以下`math_fontfamily`参数执行此操作：

```
import matplotlib.pyplot as plt

fig, ax = plt.subplots(figsize=(6, 5))

# A simple plot for the background.
ax.plot(range(11), color="0.9")

# A text mixing normal text and math text.
msg = (r"Normal Text. $Text\ in\ math\ mode:\ "
       r"\int_{0}^{\infty } x^2 dx$")

# Set the text in the plot.
ax.text(1, 7, msg, size=12, math_fontfamily='cm')

# Set another font for the next text.
ax.text(1, 3, msg, size=12, math_fontfamily='dejavuserif')

# *math_fontfamily* can be used in most places where there is text,
# like in the title:
ax.set_title(r"$Title\ in\ math\ mode:\ \int_{0}^{\infty } x^2 dx$",
             math_fontfamily='stixsans', size=14)

# Note that the normal text is not changed by *math_fontfamily*.
plt.show() 
```

[![在此处输入图像描述](../Images/8276ff28617e0d104d25b7f96da3fef2.png)](https://i.stack.imgur.com/SbEs5.png)

# php - 如何从我自己的库中访问 zend 2 中的 getServiceLocator

> ID：15341633
> 
> 赞同：2
> 
> 时间：2013-03-11T14:53:20.253
> 
> 标签：php, database, api, model, zend-framework2

我一直在 zend 1 中开发一个项目，但决定转移到 zend 2 以利用诸如事件等之类的东西。

我最初的问题是我似乎找不到任何关于如何以我需要的方式使用模型的教程。

我拥有的是一个 Api 控制器，它被路由到 /api/soap

这个soap端点加载了一个类，该类具有我想通过SOAP公开的所有方法

```
namespace MyProject\Controller;

$view = new ViewModel();
$view->setTerminal(true);
$view->setTemplate('index');

$endpoint = new EndpointController();

 $server = new Server(
            null, array('uri' => 'http://api.infinity-mcm.co.uk/api/soap')
 );

$server->setObject($endpoint);

$server->handle(); 
```

我的包含所有功能的控制器是

```
namespace MyProject\Controller;
class EndpointController
{

    public function addSimpleProducts($products)
    {

    }

} 
```

现在我想做的是从这个 EndpointController 中访问我的产品模型。

所以我试过这个：

```
protected function getProductsTable()
{
    if (!$this->productsTable) {
        $sm = $this->getServiceLocator();
        $this->productsTable= $sm->get('MyProject\Model\ProductsTable');
    }
    return $this->productsTable;
} 
```

当我运行它时，我得到了 EndpointController::getServiceLocator() 未定义的致命错误。

我对 Zend 2 很陌生，但在 Zend 1 中，感觉这将是我开发过程中非常小的一步，我已经到了将 zend 2 关闭并返回到 zend 1 甚至切换到 symfony 2 的地步，这很简单使用教义...

帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T08:52:06.667

如果您希望您的控制器能够访问 ServiceManager，那么您需要将 ServiceManager 注入其中。

在 MVC 系统中，这对您来说几乎是自动发生的，因为 ServiceManager 用于创建 Controller 的实例。当您创建`EndpointController`using时，这不会发生在您身上`new`。

您要么需要通过 MVC 创建此控制器，要么实例化和配置您自己的 ServiceManager 实例并将其传递给`EndpointController`.

或者，实例化依赖项，例如`ProductTable`并将它们设置到您的`EndpointController`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:29:36.747

要访问服务定位器，您必须实施`ServiceLocatorAwareInterface`

所以在任何需要这个的控制器中，你可以这样做：

```
namespace MyProject\Controller;

use Zend\ServiceManager\ServiceLocatorAwareInterface,
    Zend\ServiceManager\ServiceLocatorInterface;

class EndpointController implements ServiceLocatorAwareInterface
{
    protected $sm;

    public function addSimpleProducts($products) {

    }

    /**
    * Set service locator
    *
    * @param ServiceLocatorInterface $serviceLocator
    */
    public function setServiceLocator(ServiceLocatorInterface $serviceLocator) {
         $this->sm = $serviceLocator;
    }

    /**
    * Get service locator
    *
    * @return ServiceLocatorInterface
    */
    public function getServiceLocator() {
         return $this->sm;
    }
} 
```

现在服务管理器将自动注入自己。然后你可以像这样使用它：

```
$someService = $this->sm->getServiceLocator()->get('someService'); 
```

如果您使用的是 PHP 5.4+，则可以导入，`ServiceLocatorAwareTrait`因此您不必自己定义 getter 和 setter。

```
class EndpointController implements ServiceLocatorAwareInterface
{
    use Zend\ServiceManager\ServiceLocatorInterface\ServiceLocatorAwareTrait 
```

# sed - 为什么 s/$/,/g 替换第一个字符？

> ID：15341635
> 
> 赞同：0
> 
> 时间：2013-03-11T14:53:24.500
> 
> 标签：sed

操作系统 Ubuntu 12.04

壳牌狂欢

为什么这个 sed 命令

`sed -e 's/$/,/g' test.in`

替换`5`in test.in?

这是test.in的内容

`52147398,9480,12/31/2011 23:22,101049000,LNAM,FNAM,80512725,43,0,75,1/1/2012 6:45,101049000`

以下是运行 sed 的结果

`,2147398,9480,12/31/2011 23:22,101049000,LNAM,FNAM,80512725,43,0,75,1/1/2012 6:45,101049000`

我想在后面加逗号`1010489000`

将日期时间格式替换为`yyyy-mm-dd hh:mm:ss format`, 现在

`s/$/,/g`

按预期工作。这是因为 sed 挂断了 mm/dd/yyyy hh:mm 格式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:34:05.917

可能您的文件是 DOS 格式的。换行符之前的回车将导致逗号被写为覆盖现有字符（在本例中为`5`）的行上的第一个字符。

先转换成 Unix 格式：

```
tr -d '\r' < file > newfile 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:38:14.047

```
$ cat test.txt | sed 's/$/,/g'
52147398,9480,12/31/2011 23:22,101049000,LNAM,FNAM,80512725,43,0,75,1/1/2012 6:45,101049000, 
```

也许文件已损坏？尝试复制/粘贴到新文件中...

也试试，

```
$ hexdump test.txt
hexdump test.txt
0000000 35 32 31 34 37 33 39 38 2c 39 34 38 30 2c 31 32
0000010 2f 33 31 2f 32 30 31 31 20 32 33 3a 32 32 2c 31
0000020 30 31 30 34 39 30 30 30 2c 4c 4e 41 4d 2c 46 4e
0000030 41 4d 2c 38 30 35 31 32 37 32 35 2c 34 33 2c 30
0000040 2c 37 35 2c 31 2f 31 2f 32 30 31 32 20 36 3a 34
0000050 35 2c 31 30 31 30 34 39 30 30 30 0a            
000005c 
```

第一个字符应该是 0x35。

# iphone - 从 safari 返回 iPhone 应用程序

> ID：15341637
> 
> 赞同：2
> 
> 时间：2013-03-11T14:53:27.887
> 
> 标签：iphone, ios, objective-c

从我的 iphone 应用程序中，我在 safari 中调用了一个 url。如何从该网页恢复到我的 iphone 应用程序

就像我们在 facebook 身份验证后返回我们的应用程序一样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T14:58:35.193

如果您可以控制网页，则可以使用 URL 方案。只需使用您的方案添加一个链接。

如果您的方案是`myapp:`：

`<a href="myapp://return_info">Return to the app</a>`

请参阅[此站点](http://mobile.tutsplus.com/tutorials/iphone/ios-sdk-working-with-url-schemes/)以获取教程。

# windows-phone-7 - 检测滚动到列表框的末尾

> ID：15341638
> 
> 赞同：1
> 
> 时间：2013-03-11T14:53:28.360
> 
> 标签：windows-phone-7, windows-phone, data-virtualization

我有一个很大的项目列表，所以我应该从服务器请求相应的页面。当用户滚动到列表框的末尾时，如何捕获事件，以便我可以请求另一个页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T00:08:27.693

您正在寻找的确切解决方案：http: [//danielvaughan.orpius.com/post/Scroll-Based-Data-Loading-in-Windows-Phone-7.aspx](http://danielvaughan.orpius.com/post/Scroll-Based-Data-Loading-in-Windows-Phone-7.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T17:46:05.837

您正在考虑数据虚拟化。肖恩奥斯特在[这里](http://shawnoster.com/2010/08/improving-listbox-performance-in-silverlight-for-windows-phone-7-data-virtualization/)写了一个很好的解释。总而言之，不是`ListBox`管理您的数据，而是您的自定义`IList`实现，它能够在每次需要新数据块时获取新项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T06:25:57.980

如果大于可滚动高度，您可以检查垂直偏移量，用户位于列表的底部，根据需要触发另一个页面的请求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T16:59:38.510

最好的方法是使用`LongListSelector`. 它可以从适用于 Windows Phone 7 的[Windows Phone Toolkit](http://phone.codeplex.com/)获得，或者它内置在 Windows Phone 8 上。它比内置的性能更好，`ListBox`并且具有更多功能。

来自[官方 Windows Phone 开发人员博客](http://blogs.windows.com/windows_phone/b/wpdev/archive/2012/10/01/how-to-create-an-infinite-scrollable-list-with-longlistselector.aspx)（自 2012 年 10 月起）的一篇文章提供了所有详细信息并讲述了如何设置无限滚动。

# php - 如何使用php将复选框值保存到mysql数据库中

> ID：15341639
> 
> 赞同：2
> 
> 时间：2013-03-11T14:53:31.007
> 
> 标签：php, html, mysql

嗨，我有一个带有复选框的表单，我想将复选框的值保存到我的数据库中，但是当我单击复选框并保存它时，它工作正常，当我尝试保存表单而不检查它显示的复选框时未定义的索引任何人都可以帮助我

这是我的html

```
<input type="checkbox" name="active" value="1"></input> 
```

这是我的 php

```
$nactive  = $_POST["active"]; 
```

这是我的保存部分

```
mysql_query("INSERT INTO `usermain`( `username`, `password`, level, active,`zimname`, zimmob, `email`, admin, makhtab)
            Values
                   ('$nuser', '$npwd', '$nlevel', '$nactive', '$nzname', '$nzmob', '$nemail', '0', '$makh')") or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T14:55:33.390

如果未选中该复选框，则浏览器实际上不会在您的 POST 请求中发送数据。您需要检查该值是否已设置，然后相应地更新您的变量。

`$inactive = isset($_POST["active"]) ? $_POST["active"] : 0;`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T14:56:02.080

如果未选中该复选框，则该值不会发布到脚本中。您必须在使用前检查它是否已设置。

```
if(isset($_POST['active'])){
    //do something if is
}
else{
    //do something if not
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T14:57:07.223

在下一页中使用 isset 控件，如下所示：

```
if (!isset($nactive)) $nactive = 0; 
```

如果您的复选框未选中，则值为 0

# ios - NSNumberFormatter 删除货币前的空格

> ID：15341644
> 
> 赞同：3
> 
> 时间：2013-03-11T14:53:35.013
> 
> 标签：ios, objective-c, nsnumberformatter

我正在使用`NSNumberFormatter`将我的数字格式化为字符串。我有一个具有希伯来语（以色列）区域格式（设置->常规->国际->区域格式）的设备。例如，当我尝试格式化数字 100 时，我得到 100 美元。我的目标是删除货币符号前的空格并仅获得 100 美元

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T09:36:06.033

我最终通过删除空格来更改 positiveSuffix 和negativeSuffix 属性

因为我的 NSNumberFormatter 在我的应用程序中是静态的，所以我在每次使用结束时将它们设置为 nil

```
static NSNumberFormatter *currencyFormatter;
if (!currencyFormatter) {
     currencyFormatter = [[NSNumberFormatter alloc] init];
     [currencyFormatter setNumberStyle:NSNumberFormatterCurrencyStyle];
     [currencyFormatter setNegativeFormat:@""];
}

// remove spaces at the suffix
currencyFormatter.positiveSuffix = [currencyFormatter.positiveSuffix stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceCharacterSet]];

currencyFormatter.negativeSuffix = [currencyFormatter.negativeSuffix stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceCharacterSet]];

// get the return number
NSString* retNum = [currencyFormatter stringFromNumber:val];

// this code is for the next time using currencyFormatter
currencyFormatter.positiveSuffix = nil;
currencyFormatter.negativeSuffix = nil;

return retNum; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:57:25.373

在通过 NSNumberFormatter 运行之前从字符串中删除所有空格怎么样？（正如在这个[问题](https://stackoverflow.com/questions/925780/remove-characters-from-nsstring-in-iphone-programming)中回答的那样）

```
NSString *stringWithoutSpaces = [myString 
    stringByReplacingOccurrencesOfString:@" " withString:@""]; 
```

# c# - MVC 模型绑定器 - 获取单个表单错误

> ID：15341645
> 
> 赞同：1
> 
> 时间：2013-03-11T14:53:41.510
> 
> 标签：c#, razor, asp.net-mvc-4, model-binding

我使用 .net 4.5、MVC 4 并且我使用模型绑定器作为表单。我有一个 HTML 验证摘要，它将错误显示为一个列表，效果很好。

我想要做的是获取单个模型属性是否触发了基于 ModelState 的错误，如果是这样，给它一个“错误”CSS 类，它会变成红色。请看下文。

```
<div class="controls">
@{
    // does this element have an error??
    if (Model.LastName == error)
    {
        @Html.ValidationMessageFor(x => x.LastName)
        @Html.TextBoxFor(x => x.LastName, new { type = "text", id = "LastName", name = "LastName", value = Model.LastName, @class = "Error" })
    }
    else
    {
        @Html.ValidationMessageFor(x => x.LastName)
        @Html.TextBoxFor(x => x.LastName, new { type = "text", id = "LastName", name = "LastName", value = Model.LastName, })
    }
}
} 
```

验证摘要

```
@{
    if (ViewBag.Error != null && ViewBag.Error == true)
    {
        <div class="alert alert-error">
            <h3>Error</h3>
            <p>@ViewBag.Message</p>
            <p>@Html.ValidationSummary(false)</p>                
        </div>
    }
    else if (ViewBag.Error != null && ViewBag.Error == false)
    {
        <div class="alert alert-success">
            <h3 style="color:green;">Details Updated Successfully Received</h3>
            <p style="color:green;">@ViewBag.Message</p>
        </div>
    }
} 
```

模型

```
public class UpdateDetailsModel
{
    public VIPSessionObject VIPSessionObject { get; set; }

    [Required]
    [DataType(DataType.Text, ErrorMessage = "Please Enter your First Name")]
    public string FirstName { get; set; }

    [Required]
    [DataType(DataType.Text, ErrorMessage = "Please Enter your Last Name")]
    public string LastName { get; set; }

    [Required]
    [DataType(DataType.PhoneNumber, ErrorMessage = "Please Enter your Phone Number")]
    public string Telephone { get; set; }

    [Required]
    [DataType(DataType.EmailAddress, ErrorMessage = "Please Enter your Email Address")]
    public string Email { get; set; }

    [Required]
    [DataType(DataType.Password, ErrorMessage = "Please Enter your Motorpoint VIP Password")]
    public string Password { get; set; }

    [Required]
    [DataType(DataType.Password, ErrorMessage = "The Passwords must match")]
    [Compare("Password")]
    public string PasswordConfirm { get; set; }

    [Required]
    [DataType(DataType.Date, ErrorMessage = "Please Enter your Date of Birth")]
    public DateTime DateOfBirth { get; set; }

    [Required]
    public int VehiclesInHousehold { get; set; }

    [Required(ErrorMessage = "Please select the number of cars in your household")]
    public int NoOfVehicles { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T16:08:52.807

```
@Html.ValidationMessageFor(model => model.LastName, null, new { @class = "error" }) 
```

然后只需使用红色文本设置 .error CSS 类的样式，如果姓氏不符合模型数据注释指定的内容，它将使用模型属性注释中提供的错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:09:40.010

在您的模型中，您可以删除：

```
 [DataType(DataType.Text, ErrorMessage = "Please Enter your Last Name")] 
```

并将您的 [必需] 替换为：

```
 [Required(ErrorMessage ="Required Field")] 
```

我过去读过使用 [DataType] 属性存在错误，我现在正在谷歌搜索以找到该文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T22:10:28.660

对控件进行手动 JavaScript（或 JQuery）验证呢？最简单的例子：

```
function CheckForm()
{
    var elementValue = document.getElementById('elementId').Value;

    if(elementValue == null || elementValue == '')
    {
       document.getElementById('elementId').className = "Error";
    }
    else 
    {
       document.getElementById('elementId').className = "";
    } 
} 
```

然后你可以在你的表单标签中使用它

```
<form method="POST" action="..."> 
... 
<input id="elementId" type="text" ... />
<input type="submit" onClick="CheckForm()" .../>
</form> 
```

您可以执行任何验证。

或者

按照@Robert 的建议，为 Display、Required、DataType 设置 ErrorMessage 属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T20:49:13.937

我不确定您的问题到底是什么，但任何新的 MVC 4 项目都带有验证助手的样式。他们来了：

```
 /* Styles for validation helpers
 -----------------------------------------------------------*/
 .field-validation-error {
   color: #f00;
 }

 .field-validation-valid {
   display: none;
 }

 .input-validation-error {
   border: 1px solid #f00;
   background-color: #fee;
 }

 .validation-summary-errors {
   font-weight: bold;
   color: #f00;
 }

 .validation-summary-valid {
   display: none;
 } 
```

基本上，只要您有，当表单字段的验证失败时，这会给您一个红色文本：

```
 @Html.ValidationMessageFor(x => x.LastName) 
```

在需要验证的表单字段旁边。您放置在视图模型上的模型和数据验证器看起来不错。

每个表单助手都有一个名为 HtmlAttributes 的可选参数，您可以通过它传递要在页面上呈现的任何 html 属性：

```
 @Html.TextBoxFor(x => x.LastName, null, new {@class = "Error"}) 
```

注意那里的 @ 符号，因为 class 是 C# 中的保留字...

# .net - C# - 两次实例化 BitMap 对象以避免锁定问题的想法

> ID：15341646
> 
> 赞同：0
> 
> 时间：2013-03-11T14:53:46.830
> 
> 标签：.net, garbage-collection, dispose

我在删除以`PictureBox`. 感谢`Hans Passant`我使用他提出的这个片段解决了这个问题：

```
 using (var temp = new Bitmap(openFileDialog1.FileName))
            {
                pictureBox1.Image = new Bitmap(temp);
            } 
```

我试图使代码崩溃，但我不能让它似乎工作，但我不太了解这段代码背后的逻辑。在我做之前：

```
if (MyImage != null)
                    {
                        MyImage.Dispose();

                    }
...
MyImage = new Bitmap(openFileDialog1.FileName);
                    pictureBox1.Image = (Image)MyImage; 
```

这甚至非常罕见地导致了`resource being used`.

为什么这不会发生在我正在使用的新代码中。我问这个是为了了解封面下发生的事情。我知道这`using`保证`Dispose()`会被调用，但`Disposed()`也会在前面的代码中被调用。大多数情况下，资源的释放速度足够快，但是允许新代码**始终**以足够快的速度释放图像以使其可以被删除或我们需要对其进行任何处理的最大区别是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:04:04.930

从文件创建`Bitmap`对象时，只要`Bitmap`对象存在，它就会保持文件打开。

在您的原始代码中，您使用的是`Bitmap`从控件中的文件打开的对象，因此只要控件显示图像，文件就会打开。

在新代码`Bitmap`中，通过复制`Bitmap`从文件创建的对象中的数据来创建新对象。新`Bitmap`对象不会将连接复制到文件，因此当您处理第一个`Bitmap`对象时，文件将被关闭。

使用较少资源的解决方案是将文件中的数据读取到字节数组中，从中创建内存流并使用它来创建图像：

```
using (var m = new MemoryStream(File.ReadAllBytes(openFileDialog1.FileName))) {
  pictureBox1.Image = Image.FromStream(m);
} 
```

# java - Hibernate（映射到交叉引用表）

> ID：15341650
> 
> 赞同：3
> 
> 时间：2013-03-11T14:53:55.167
> 
> 标签：java, hibernate, data-modeling

我正在尝试执行以下操作（非常人为的示例）：

我有两个表 A 和 B，它们形成了一个多对多关系，为此我创建了一个映射表 A_B。然后我有一个表 C，它与映射表 A_B 形成一对多的关系。

```
tableA
------
a_id [pk] 
```

然后

```
tableB
------
b_id [pk] 
```

然后

```
tableA_B
-------
a_id [pk]
b_id [pk] 
```

然后

```
tableC
------
c_id [pk] 
```

然后

```
tableC_AB
---------
c_id [pk]
a_id [pk]
b_id [pk] 
```

因此，在 Hibernate 中，我为 A、B 和 C 创建了实体...

```
ClassA {
    ....
    @JoinTable(
        name="A_B",
        joinColumns={@JoinColumn(name="a_id")},
        inverseJoinColumns={@JoinColumn(name="b_id")}
    )
    @ManyToMany(cascade = {CascadeType.ALL})
    private Set<B> bset = new HashSet<B>();
} 
```

那么（反比关系）

```
ClassB {
    @ManyToMany(mappedBy="bset")
    private Set<A> subjects = new HashSet<A>();
} 
```

这会创建第一个映射 A_B 但是我不确定如何在休眠中创建映射 C_AB。我什至没有 A_B 的实体（仅存在于数据库中）所以我该怎么做呢？

任何帮助表示赞赏。

干杯，

爱

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:30:17.980

我想建议应该使用独立的关联/加入/链接实体类，而不是隐式的多对多表。因为现实世界中不存在没有创建时间、创建者、协议和雇佣合同等附加字段的连接表。

所以我的意思是：

*   tableA_B 应该映射到独立的实体，当两个东西链接在一起时，必须有一些额外的字段。
*   tableC_AB 也应该映射到独立实体。
*   当我们要查找集合字段时，我们可以通过 HQL 的顺序查找和获取集合字段。
*   多对多是错误的，关联表不能有额外的字段，但它应该有

# php - 视频文件上传php

> ID：15341651
> 
> 赞同：-1
> 
> 时间：2013-03-11T14:54:09.157
> 
> 标签：php, video, file-upload

嗨，谁能告诉我如何限制用户上传大尺寸的视频文件，他们应该只上传特定类型的视频文件。他们应该只能上传 8mb 的文件，不能超过这个。下面是我的代码。

```
 <?php
    if(isset($_POST['submit']))
    {

        $filename=$_FILES['file']['name'];
        $filesize=$_FILES['file']['size'];
        $filetype=$_FILES['file']['type'];
        $tmpfile=$_FILES['file']['tmp_name'];
        $unique=str_shuffle("abcde").$filename;

        if ((($filetype == "video/avi")
    || ($filetype == "video/mpeg")
    || ($filetype == "video/mpg")
    || ($filetype == "video/mov")|| ($filetype == "video/wmv") || ($filetype == "video/rm") || ($filetype == "image/mp4"))
    && ($filesize < 8388608 and $filesize > 20))

{

    move_uploaded_file($tmpfile,"uploads/$unique");

        echo'file is uploaded';
}
        else
    {
        echo'failure in uploading';
    }

}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:05:36.207

您还可以限制 HTML 表单中的文件大小：`<input type="hidden" name="MAX_FILE_SIZE" value="8388608" />`尽管它会处理整个上传，然后导致失败。

最好的办法是使用 jQuery 来评估提交时选择的文件，并像你一样使用 PHP 服务器端验证。

EDIT1a：**jQuery**示例：[使用 jQuery，在上传之前限制文件大小](https://stackoverflow.com/questions/307679/using-jquery-restricting-file-size-before-uploading)

EDIT1b：来自工作站点的示例 PHP 上传代码：

```
protected function handle_image_upload($frmFilesID = false, $thisFile = false) {

$fileName = $_FILES["$frmFilesID"]['name'][$thisFile];
$tmpName = $_FILES["$frmFilesID"]['tmp_name'][$thisFile];
if (!is_uploaded_file($tmpName)) { trigger_error("Security block.", E_USER_ERROR); return false; }
$fileSize = $_FILES["$frmFilesID"]['size'][$thisFile];
$fileType = $_FILES["$frmFilesID"]['type'][$thisFile];

// Evaluate File Size
if ($fileSize > '8388608') { trigger_error('File exceeds maximum size.', E_USER_ERROR); return false; }

// Make folder path if needed
$destPath = 'imgdir';
if (!is_dir($destPath) && !@mkdir($destPath, 0777, true)) { trigger_error("Could not create folder.", E_USER_ERROR); return false; }

// Test if file already exists (auto-rename?)
if (file_exists($destPath . '/' . $fileName)) {
    trigger_error("File already exists, rename the file and try again.", E_USER_ERROR);
    return false;
}

// Move uploaded file from tmp
if (move_uploaded_file($tmpName, $destPath . '/' . $fileName)) {
    return true;
} else {
    trigger_error("Invalid results.", E_USER_NOTICE);
    return false;
}

} 
```

为正在上传的每个文件调用该函数：

```
for ($i=0; $i<$count; $i++) {
    $frmFilesID = "ImagesFormIdGoesHere";
    if (!handle_image_upload($frmFilesID, $i)) { echo "<br /><strong>NOTE:</strong> Failed to upload file $i..."; }
} 
```

# android - 应用下载限制

> ID：15341653
> 
> 赞同：0
> 
> 时间：2013-03-11T14:54:14.573
> 
> 标签：android

开发一个应用程序来帮助公司内的员工。我想限制它，以便只有我公司的人才能下载它。这可能吗，还是我可以在第一次使用时对其进行密码保护，然后将其解锁？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:57:50.700

看看[Google Play 私人频道](http://googleenterprise.blogspot.com/2012/12/a-new-way-to-distribute-your-internal.html)。如果您是 Google Apps for Business、Education 或 Government 客户，则可以使用此功能。

# macros - Clojure doseq 生成大量代码？

> ID：15341659
> 
> 赞同：6
> 
> 时间：2013-03-11T14:54:35.857
> 
> 标签：macros, clojure, code-generation

我最近一直在玩clojure，遇到了一个我不知道如何处理的问题。我有一个带有 7 个参数的doseq，它扩展到一个巨大的块，几乎超过了最大类大小。为什么doseq 会扩展到如此巨大的clojure 代码块？

例子：

```
(def q '(doseq
[p0 (nth (:params operator) 0 (quote (nil)))
p1 (nth (:params operator) 1 (quote (nil)))
p2 (nth (:params operator) 2 (quote (nil)))
p3 (nth (:params operator) 3 (quote (nil)))
p4 (nth (:params operator) 4 (quote (nil)))
p5 (nth (:params operator) 5 (quote (nil)))
p6 (nth (:params operator) 6 (quote (nil)))]
(do-print board (:oname operator) p0 p1 p2 p3 p4 p5 p6))) 
```

接着：

```
(macroexpand q) 
```

在我的机器上，这会提供大量代码（97331 字节）。这是正常的还是我做错了什么？运算符是一个简单的 defrecord。如果有人感兴趣，这里是扩展结果的链接：http: [//pastebin.com/6gw1q078](http://pastebin.com/6gw1q078)

编辑：

通过做同样的事情，但使用**for**形式，我得到的东西要小几个数量级（3653 字节）：

```
(def q '(for
[p0 (nth (:params operator) 0 (quote (nil)))
p1 (nth (:params operator) 1 (quote (nil)))
p2 (nth (:params operator) 2 (quote (nil)))
p3 (nth (:params operator) 3 (quote (nil)))
p4 (nth (:params operator) 4 (quote (nil)))
p5 (nth (:params operator) 5 (quote (nil)))
p6 (nth (:params operator) 6 (quote (nil)))]
(do-print board (:oname operator) p0 p1 p2 p3 p4 p5 p6)))

(macroexpand q) 
```

结果在这里： http: [//pastebin.com/9MAKK3VD](http://pastebin.com/9MAKK3VD)

为什么两者之间有如此巨大的差异？doseq 形式看起来很无辜，当我收到一个错误说 java 类大小已超出时，我真的很惊讶。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T16:08:35.170

好吧，看看一个较小的宏观扩展`doseq`揭示了原因：

```
(loop [seq_2365 (seq [1 2])
       chunk_2366 nil
       count_2367 0
       i_2368 0]
  (if (< i_2368 count_2367)
    (let [x (.nth chunk_2366 i_2368)]
      (do x)
      (recur seq_2365 chunk_2366 count_2367 (unchecked-inc i_2368)))
    (when-let [seq_2365 (seq seq_2365)]
      (if (chunked-seq? seq_2365)
        (let [c__4197__auto__ (chunk-first seq_2365)]
          (recur (chunk-rest seq_2365) c__4197__auto__ (int (count c__4197__auto__)) (int 0)))
        (let [x (first seq_2365)]
          (do x)
          (recur (next seq_2365) nil 0 0)))))) 
```

理想情况下，我们只需要最后`let`一种形式，但`doseq`会发出额外的代码以`chunked-seq`特定方式处理，以便它获取第一个块，然后为块中的每个项目执行主体，`doseq`依此类推。

此代码是为单个 seq in 生成的，`doseq`但是当您在其中有 2nd seq 时，会生成类似的用于处理 chunked-seq 的代码，因此它的大小会爆炸。

# fluent-nhibernate - nHibernate 支持哪些版本的 firebird？

> ID：15341660
> 
> 赞同：0
> 
> 时间：2013-03-11T14:54:38.430
> 
> 标签：fluent-nhibernate, firebird

我想将 fluent-nHibernate 用于不同版本的 firebird 数据库。我在 jboss 网站上找到了一些信息，但在[http://nhibernate.info/上什么也没有](http://nhibernate.info/)

支持哪些版本，我在哪里可以找到这样的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T12:07:53.040

由于 fluent-nHibernate 位于 nHibernate 之上，因此您只需要它来支持 Firebird。如果您检查 fluent-nHibernate Firebird 配置的[源代码](https://github.com/jagregory/fluent-nhibernate/blob/master/src/FluentNHibernate/Cfg/Db/FirebirdConfiguration.cs)，您将看到没有对任何 Firebird 版本的引用。

根据nHibernate中 jBoss的这个[链接](https://community.jboss.org/wiki/DatabasesSupportedByNHibernate)`Firebird is supported since version 1.5.3, though version 2.1 is strongly recommended`，这样说。相同的链接还提供了有关如何配置应用程序的建议。

此链接还表明您应该始终尝试使用最新的 Firebird .NET 提供程序，您可以从[Firebird 的网页](http://www.firebirdsql.org/en/net-provider/)下载该提供程序。

最后，您可以在这个[SO question](https://stackoverflow.com/questions/1350907/nhibernate-or-fluent-nhibernate)中找到有关 nHibernate 和 fluent-nHibernate 之间区别的更多信息。

# c++ - 在 OS X 上构建 Qt QIBASE 驱动程序

> ID：15341663
> 
> 赞同：2
> 
> 时间：2013-03-11T14:54:53.633
> 
> 标签：c++, macos, qt, firebird, qmake

我在为 Qt 构建 QIBASE SQL 驱动程序以便能够在 OS X 上使用 Firebird 和 Qt 时遇到问题。

我找到了这个快速指南：http: [//qt-project.org/doc/qt-4.8/sql-driver.html#qibase](http://qt-project.org/doc/qt-4.8/sql-driver.html#qibase)但它似乎不正确。

Firebird 已安装，其头文件为：

```
/Library/Frameworks/Firebird.framework/Headers/ 
```

dylib 文件是：

```
/Library/Frameworks/Firebird.framework/Libraries/ 
```

我已经从[http://qt-project.org/downloads#qt-lib](http://qt-project.org/downloads#qt-lib)下载了 Qt 4.8.4 源并将其解压缩到：

```
~/devel/qt 
```

所以我从这个更改了第一个链接上的代码：

```
cd $QTDIR/src/plugins/sqldrivers/ibase
qmake "INCLUDEPATH+=/opt/interbase/include" "LIBS+=-L/opt/interbase/lib -lfbclient" ibase.pro
make 
```

至：

```
cd ~/devel/qt/src/plugins/sqldrivers/ibase
qmake -spec macx-g++ "INCLUDEPATH+=/Library/Frameworks/Firebird.framework/Headers" "LIBS+=-L/Library/Frameworks/Firebird.framework/Libraries -lfbclient" ibase.pro
make 
```

我从make中得到以下错误：

```
In file included from main.cpp:44:
../../../sql/drivers/ibase/qsql_ibase.h:47:46: error: QtSql/private/qsqlcachedresult_p.h: No such file or directory
In file included from main.cpp:44:
../../../sql/drivers/ibase/qsql_ibase.h:58: error: expected class-name before ‘{’ token
../../../sql/drivers/ibase/qsql_ibase.h:70: error: ‘QSqlCachedResult’ has not been declared
../../../sql/drivers/ibase/qsql_ibase.h:70: error: expected ‘,’ or ‘...’ before ‘&amp;’ token
make[1]: *** [debug/main.o] Error 1
make: *** [debug] Error 2 
```

所以我跑`mdfind qsqlcachedresult_p.h | grep qsqlcachedresult_p.h`了，我得到的唯一结果是：

```
~/devel/qt/src/sql/kernel/qsqlcachedresult_p.h
~/devel/qt/include/QtSql/private/qsqlcachedresult_p.h 
```

请记住，它似乎不作为我安装的 Qt SDK 的一部分存在，并且位于`/Library/Frameworks/Qt*.framework`.

所以我尝试将 devel qt src 文件添加到 INCLUDEPATH 并尝试再次运行 qmake：

```
cd ~/devel/qt/src/plugins/sqldrivers/ibase
qmake -spec macx-g++ "INCLUDEPATH+=~/devel/qt/include" "INCLUDEPATH+=/Library/Frameworks/Firebird.framework/Headers" "LIBS+=-L/Library/Frameworks/Firebird.framework/Libraries -lfbclient" ibase.pro
make 
```

但是现在我得到一大堆“没有命名类型”的错误以及`error: #error "Qt has not been ported to this architecture"`and 。make 返回的全部内容在这里：`error: #error "Qt not configured correctly, please run configure"``error: ../../src/corelib/global/qconfig.h: No such file or directory`

```
In file included from ../../../../include/QtCore/../../src/corelib/global/qglobal.h:62,
                 from ../../../../include/QtCore/qglobal.h:1,
                 from ../../../../include/QtCore/../../src/corelib/global/qnamespace.h:45,
                 from ../../../../include/QtCore/qnamespace.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobjectdefs.h:45,
                 from ../../../../include/QtCore/qobjectdefs.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobject.h:47,
                 from ../../../../include/QtCore/qobject.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:45,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/qconfig.h:1:46: error: ../../src/corelib/global/qconfig.h: No such file or directory
make -f Makefile.Debug
g++ -c -pipe -g -gdwarf-2 -arch x86_64 -Xarch_x86_64 -mmacosx-version-min=10.5 -fvisibility=hidden -fvisibility-inlines-hidden -Wall -W -fPIC -DQT_NO_CAST_TO_ASCII -DQT_NO_CAST_FROM_ASCII -DQT_PLUGIN -DQT_SQL_LIB -DQT_CORE_LIB -DQT_SHARED -I/usr/local/Qt4.8/mkspecs/macx-g++ -I. -I/Library/Frameworks/QtCore.framework/Versions/4/Headers -I/usr/include/QtCore -I/Library/Frameworks/QtSql.framework/Versions/4/Headers -I/usr/include/QtSql -I/usr/include -I../../../../include -I/Library/Frameworks/Firebird.framework/Versions/A/Headers -Idebug -F/Library/Frameworks -o debug/main.o main.cpp
In file included from ../../../../include/QtCore/qglobal.h:1,
                 from ../../../../include/QtCore/../../src/corelib/global/qnamespace.h:45,
                 from ../../../../include/QtCore/qnamespace.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobjectdefs.h:45,
                 from ../../../../include/QtCore/qobjectdefs.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobject.h:47,
                 from ../../../../include/QtCore/qobject.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:45,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/global/qglobal.h:1572:4: error: #error "Qt not configured correctly, please run configure"
../../../../include/QtCore/../../src/corelib/global/qglobal.h:2705:6: error: #error "Qt not configured correctly, please run configure"
In file included from ../../../../include/QtCore/qatomic_arch.h:1,
                 from ../../../../include/QtCore/../../src/corelib/thread/qbasicatomic.h:227,
                 from ../../../../include/QtCore/qbasicatomic.h:1,
                 from ../../../../include/QtCore/../../src/corelib/thread/qatomic.h:46,
                 from ../../../../include/QtCore/qatomic.h:1,
                 from ../../../../include/QtCore/../../src/corelib/tools/qbytearray.h:45,
                 from ../../../../include/QtCore/qbytearray.h:1,
                 from ../../../../include/QtCore/../../src/corelib/tools/qstring.h:46,
                 from ../../../../include/QtCore/qstring.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobject.h:48,
                 from ../../../../include/QtCore/qobject.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:45,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/arch/qatomic_arch.h:96:4: error: #error "Qt has not been ported to this architecture"
In file included from ../../../../include/QtCore/qnamespace.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobjectdefs.h:45,
                 from ../../../../include/QtCore/qobjectdefs.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobject.h:47,
                 from ../../../../include/QtCore/qobject.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:45,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/global/qnamespace.h:51: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qobjectdefs.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobject.h:47,
                 from ../../../../include/QtCore/qobject.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:45,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/kernel/qobjectdefs.h:51: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qchar.h:1,
                 from ../../../../include/QtCore/../../src/corelib/tools/qstring.h:45,
                 from ../../../../include/QtCore/qstring.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobject.h:48,
                 from ../../../../include/QtCore/qobject.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:45,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/tools/qchar.h:51: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qbasicatomic.h:1,
                 from ../../../../include/QtCore/../../src/corelib/thread/qatomic.h:46,
                 from ../../../../include/QtCore/qatomic.h:1,
                 from ../../../../include/QtCore/../../src/corelib/tools/qbytearray.h:45,
                 from ../../../../include/QtCore/qbytearray.h:1,
                 from ../../../../include/QtCore/../../src/corelib/tools/qstring.h:46,
                 from ../../../../include/QtCore/qstring.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobject.h:48,
                 from ../../../../include/QtCore/qobject.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:45,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/thread/qbasicatomic.h:51: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qatomic.h:1,
                 from ../../../../include/QtCore/../../src/corelib/tools/qbytearray.h:45,
                 from ../../../../include/QtCore/qbytearray.h:1,
                 from ../../../../include/QtCore/../../src/corelib/tools/qstring.h:46,
                 from ../../../../include/QtCore/qstring.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobject.h:48,
                 from ../../../../include/QtCore/qobject.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:45,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/thread/qatomic.h:52: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qbytearray.h:1,
                 from ../../../../include/QtCore/../../src/corelib/tools/qstring.h:46,
                 from ../../../../include/QtCore/qstring.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobject.h:48,
                 from ../../../../include/QtCore/qobject.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:45,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/tools/qbytearray.h:71: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qstring.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobject.h:48,
                 from ../../../../include/QtCore/qobject.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:45,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/tools/qstring.h:73: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qiterator.h:1,
                 from ../../../../include/QtCore/../../src/corelib/tools/qlist.h:45,
                 from ../../../../include/QtCore/qlist.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobject.h:50,
                 from ../../../../include/QtCore/qobject.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:45,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/tools/qiterator.h:58: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qalgorithms.h:1,
                 from ../../../../include/QtCore/../../src/corelib/tools/qlist.h:47,
                 from ../../../../include/QtCore/qlist.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobject.h:50,
                 from ../../../../include/QtCore/qobject.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:45,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/tools/qalgorithms.h:51: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qlist.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobject.h:50,
                 from ../../../../include/QtCore/qobject.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:45,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/tools/qlist.h:66: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qscopedpointer.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qobject.h:54,
                 from ../../../../include/QtCore/qobject.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:45,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/tools/qscopedpointer.h:49: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qobject.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:45,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/kernel/qobject.h:60: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qpointer.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:46,
                 from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/kernel/qpointer.h:51: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qplugin.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:45,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/plugin/qplugin.h:52: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qiodevice.h:1,
                 from ../../../../include/QtCore/../../src/corelib/io/qdatastream.h:46,
                 from ../../../../include/QtCore/qdatastream.h:1,
                 from ../../../../include/QtCore/../../src/corelib/tools/qstringlist.h:46,
                 from ../../../../include/QtCore/qstringlist.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qfactoryinterface.h:46,
                 from ../../../../include/QtCore/qfactoryinterface.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:46,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/io/qiodevice.h:61: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qdatastream.h:1,
                 from ../../../../include/QtCore/../../src/corelib/tools/qstringlist.h:46,
                 from ../../../../include/QtCore/qstringlist.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qfactoryinterface.h:46,
                 from ../../../../include/QtCore/qfactoryinterface.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:46,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/io/qdatastream.h:57: error: ‘QtValidLicenseForCoreModule’ does not name a type
../../../../include/QtCore/../../src/corelib/io/qdatastream.h:97: error: ‘BigEndian’ is not a member of ‘QSysInfo’
../../../../include/QtCore/../../src/corelib/io/qdatastream.h:98: error: ‘LittleEndian’ is not a member of ‘QSysInfo’
In file included from ../../../../include/QtCore/qregexp.h:1,
                 from ../../../../include/QtCore/../../src/corelib/tools/qstringlist.h:48,
                 from ../../../../include/QtCore/qstringlist.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qfactoryinterface.h:46,
                 from ../../../../include/QtCore/qfactoryinterface.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:46,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/tools/qregexp.h:56: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qstringmatcher.h:1,
                 from ../../../../include/QtCore/../../src/corelib/tools/qstringlist.h:50,
                 from ../../../../include/QtCore/qstringlist.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qfactoryinterface.h:46,
                 from ../../../../include/QtCore/qfactoryinterface.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:46,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/tools/qstringmatcher.h:51: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qstringlist.h:1,
                 from ../../../../include/QtCore/../../src/corelib/plugin/qfactoryinterface.h:46,
                 from ../../../../include/QtCore/qfactoryinterface.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:46,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/tools/qstringlist.h:59: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qfactoryinterface.h:1,
                 from /Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:46,
                 from main.cpp:42:
../../../../include/QtCore/../../src/corelib/plugin/qfactoryinterface.h:52: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from main.cpp:42:
/Library/Frameworks/QtSql.framework/Versions/4/Headers/qsqldriverplugin.h:52: error: ‘QtValidLicenseForSqlModule’ does not name a type
In file included from ../../../../include/QtCore/qmetatype.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qvariant.h:48,
                 from ../../../../include/QtCore/qvariant.h:1,
                 from ../../../../include/QtSql/../../src/sql/kernel/qsqlresult.h:45,
                 from ../../../../include/QtSql/qsqlresult.h:1,
                 from ../../../sql/drivers/ibase/qsql_ibase.h:45,
                 from main.cpp:44:
../../../../include/QtCore/../../src/corelib/kernel/qmetatype.h:60: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qmap.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qvariant.h:49,
                 from ../../../../include/QtCore/qvariant.h:1,
                 from ../../../../include/QtSql/../../src/sql/kernel/qsqlresult.h:45,
                 from ../../../../include/QtSql/qsqlresult.h:1,
                 from ../../../sql/drivers/ibase/qsql_ibase.h:45,
                 from main.cpp:44:
../../../../include/QtCore/../../src/corelib/tools/qmap.h:59: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qpair.h:1,
                 from ../../../../include/QtCore/../../src/corelib/tools/qhash.h:49,
                 from ../../../../include/QtCore/qhash.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qvariant.h:50,
                 from ../../../../include/QtCore/qvariant.h:1,
                 from ../../../../include/QtSql/../../src/sql/kernel/qsqlresult.h:45,
                 from ../../../../include/QtSql/qsqlresult.h:1,
                 from ../../../sql/drivers/ibase/qsql_ibase.h:45,
                 from main.cpp:44:
../../../../include/QtCore/../../src/corelib/tools/qpair.h:51: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qhash.h:1,
                 from ../../../../include/QtCore/../../src/corelib/kernel/qvariant.h:50,
                 from ../../../../include/QtCore/qvariant.h:1,
                 from ../../../../include/QtSql/../../src/sql/kernel/qsqlresult.h:45,
                 from ../../../../include/QtSql/qsqlresult.h:1,
                 from ../../../sql/drivers/ibase/qsql_ibase.h:45,
                 from main.cpp:44:
../../../../include/QtCore/../../src/corelib/tools/qhash.h:55: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qvariant.h:1,
                 from ../../../../include/QtSql/../../src/sql/kernel/qsqlresult.h:45,
                 from ../../../../include/QtSql/qsqlresult.h:1,
                 from ../../../sql/drivers/ibase/qsql_ibase.h:45,
                 from main.cpp:44:
../../../../include/QtCore/../../src/corelib/kernel/qvariant.h:57: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtCore/qvector.h:1,
                 from ../../../../include/QtSql/../../src/sql/kernel/qsqlresult.h:46,
                 from ../../../../include/QtSql/qsqlresult.h:1,
                 from ../../../sql/drivers/ibase/qsql_ibase.h:45,
                 from main.cpp:44:
../../../../include/QtCore/../../src/corelib/tools/qvector.h:64: error: ‘QtValidLicenseForCoreModule’ does not name a type
In file included from ../../../../include/QtSql/qsql.h:1,
                 from ../../../../include/QtSql/../../src/sql/kernel/qsqlresult.h:47,
                 from ../../../../include/QtSql/qsqlresult.h:1,
                 from ../../../sql/drivers/ibase/qsql_ibase.h:45,
                 from main.cpp:44:
../../../../include/QtSql/../../src/sql/kernel/qsql.h:51: error: ‘QtValidLicenseForSqlModule’ does not name a type
In file included from ../../../../include/QtSql/qsqlresult.h:1,
                 from ../../../sql/drivers/ibase/qsql_ibase.h:45,
                 from main.cpp:44:
../../../../include/QtSql/../../src/sql/kernel/qsqlresult.h:53: error: ‘QtValidLicenseForSqlModule’ does not name a type
In file included from ../../../../include/QtSql/qsqldriver.h:1,
                 from ../../../sql/drivers/ibase/qsql_ibase.h:46,
                 from main.cpp:44:
../../../../include/QtSql/../../src/sql/kernel/qsqldriver.h:57: error: ‘QtValidLicenseForSqlModule’ does not name a type
make[1]: *** [debug/main.o] Error 1
make: *** [debug] Error 2 
```

有人知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T14:52:36.097

修复它，以供将来参考：

我打开`ibase.pro`并添加了以下几行：

```
INCLUDEPATH += /Library/Frameworks/Firebird.framework/Headers
LIBS += -framework Firebird 
```

然后我打开`qsql_ibase.pri`并删除了以下几行：

```
unix {
    !contains(LIBS, .*gds.*):!contains(LIBS, .*libfb.*):LIBS += -lgds
} else {
    !contains(LIBS, .*gds.*):!contains(LIBS, .*fbclient.*) {
        win32-borland:LIBS += gds32.lib
        else:LIBS += -lgds32_ms
    }
} 
```

然后我为这个神秘文件创建了一个符号链接，`qsqlcachedresult_p.h`所以它是所有其他 Qt 头文件所在的位置：

```
mkdir /Library/Frameworks/QtSql.framework/Headers/private
ln -s ~/devel/qt/src/sql/kernel/qsqlcachedresult_p.h /Library/Frameworks/QtSql.framework/Headers/private/qsqlcachedresult_p.h 
```

现在可以像这样构建 QIBASE 驱动程序：

```
cd ~/devel/qt/src/plugins/sqldrivers/ibase
qmake -spec macx-g++ ibase.pro
make 
```

# multithreading - 从线程函数修改全局变量并仍然运行主线程以使用全局变量

> ID：15341664
> 
> 赞同：0
> 
> 时间：2013-03-11T14:54:54.730
> 
> 标签：multithreading, visual-studio-2010, visual-c++, boost, gdi+

我在 Visual C++ 2010 中有一个项目，我必须在其中绘制一些圆圈和线条。圆的坐标取决于两个全局变量。全局变量由两个函数修改，每个函数都在自己的线程中运行。Boost用于多线程。但是，一旦我运行线程，我的主线程就会被阻塞，从而阻止我绘制形状和使用全局变量。我怎样才能解决这个问题？我最终想要实现的是，从在自己的线程中运行的两个独立函数修改全局变量，并使用所述全局变量同时绘制圆圈

```
global_variable_1
global_variable_2

void function_1()
{
    while(true)
    {
    //modifies global_variable_1
    }
}

void function_2()
{
    while(true)
    {
    //modifies global_variable_2
    }
}

void MyOnPaint(HDC hdc)
{
    Graphics graphics(hdc);
    Pen pen(Color::Blue);

    /* Uses global_variable_1 & global_variable_2 to
    draw circles */
}

int APIENTRY _tWinMain(......)
{
    /* Some initial code */

    // Perform application initialization:
    if (!InitInstance (hInstance, nCmdShow))
    {
    return FALSE;
    }

    hAccelTable = LoadAccelerators(hInstance, MAKEINTRESOURCE(IDC_GAZEPOINTEVALUATION));

    /*Start threads*/
    using namespace boost;

    thread thread_1(function_1);

    thread thread_2(function_2);

    //Start threads
    thread_1.join()
    thread_2.join()

    while (GetMessage(&msg, NULL, 0, 0))
    {
        if (!TranslateAccelerator(msg.hwnd, hAccelTable, &msg))
        {
            TranslateMessage(&msg);
            DispatchMessage(&msg);
        }
    }

    return (int) msg.wParam;
}

LRESULT CALLBACK WndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)
{
    int wmId, wmEvent;
    PAINTSTRUCT ps;
    HDC hdc;

    switch (message)
    {
        case WM_COMMAND:
            /* Some code */
        case WM_PAINT:
            hdc = BeginPaint(hWnd, &ps);
            /*CALL MY DRAWING METHOD*/
            MyOnPaint(hdc);   
            EndPaint(hWnd, &ps);
            break;
        case WM_DESTROY:
            /* Some code */
        default:
            /* Some code */
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:16:06.387

`join`调用将永远不会返回，因为您的线程永远循环。从[文档](http://www.boost.org/doc/libs/1_53_0/doc/html/thread/thread_management.html#thread.thread_management.tutorial.join)：

> 为了等待执行线程完成，必须使用 boost::thread 对象的 join()、__join_for 或 __join_until（不推荐使用 timed_join()）成员函数。join() 将阻塞调用线程，直到 boost::thread 对象表示的线程完成。

因此，您永远不会进入您的消息循环。

如果您删除连接调用，这应该会更符合您的预期 - 在更复杂的应用程序中，您需要正确设计线程调度和退出处理。即使是这样，您也可能不得不在生成的线程中添加一些延迟，以避免与 CPU 挂钩，并可能看到您未预料到的其他奇怪现象。

# validation - 如何验证 MongoDB 集合中的 DBRefs？

> ID：15341666
> 
> 赞同：11
> 
> 时间：2013-03-11T14:54:59.303
> 
> 标签：validation, mongodb, dbref

假设我有一个 MongoDB 实例，其中包含 2 个集合 - *places*和*people*。

典型的*场所*文档如下所示：

```
{
    "_id": "someID"
    "name": "Broadway Center"
    "url": "bc.example.net"
} 
```

人员文档如下所示*：*

```
{
    "name": "Erin"
    "place": DBRef("places", "someID")
    "url":  "bc.example.net/Erin"
} 
```

有什么方法可以验证*people*集合中**每个**文档的*位置*DBRef吗？

 **** * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-12T13:07:34.850

没有**官方/内置的方法**来测试 DBRefs 的有效性，因此必须手动执行验证。

我写了一个小脚本 - *validateDBRefs.js*：

```
var returnIdFunc = function(doc) { return doc._id; };

var allPlaceIds  = db.places.find({}, {_id: 1} ).map(returnIdFunc);

var peopleWithInvalidRefs = db.people.find({"place.$id": {$nin: allPlaceIds}}).map(returnIdFunc);

print("Found the following documents with invalid DBRefs");
var length = peopleWithInvalidRefs.length;
for (var i = 0; i < length; i++) {
    print(peopleWithInvalidRefs[i]);
} 
```

运行时：

> mongo DB_NAME validateDBRefs.js

将输出：

> 发现以下具有无效 DBRefs 的文档
> 
> 513c4c25589446268f62f487
> 
> 513c4c26589446268f62f48a

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T12:53:12.080

你可以为此添加一个存储的函数。请注意，mongo 文档不鼓励使用存储函数。你可以[在这里阅读](http://docs.mongodb.org/manual/applications/server-side-javascript/#storing-functions-server-side)

本质上，您创建了一个函数：

```
db.system.js.save(
   {
     _id : "myAddFunction" ,
     value : function (x, y){ return x + y; }
   }
); 
```

一旦创建了函数，您就可以在 where 子句中使用它。因此，您可以编写一个函数来检查 dbRef 中是否存在 id。***

# mysql - 卡在 MySQL 查询中（不是唯一的表/别名：'PRICE'）错误

> ID：15341670
> 
> 赞同：1
> 
> 时间：2013-03-11T14:55:07.330
> 
> 标签：mysql

如下运行我的查询时，我得到一个'非唯一表/别名：'PRICE''。经过几个小时的尝试，我坚持了下来！（这是一个改变的 MS SQL 查询）

```
SELECT
    PRICE_GENERIC.`Part Description` AS post_title,
    `PRICE_GENERIC`.`Part Description` AS post_name,
    PRICE_GENERIC.`Material Long Description` AS post_excerpt,
    "" AS post_content,
    "publish" AS post_status,
    "0" AS menu_order,
    "02/22/2013 17:17" AS post_date,
    "0" AS post_parent,
    "closed" AS comment_status,
    PRICE_GENERIC.`EANUPC Code` AS sku,
    "visible" AS visibility,
    PRICE_GENERIC.`Available Quantity` AS stock,
    "instock" AS stock_status,
    "no" AS backorders,
    "" AS manage_stock,
    PRICE_GENERIC.`Customer Price` AS regular_price,
    "" AS sale_price,
    PRICE.Weight AS weight,
    PRICE.Length AS length,
    PRICE.Width AS width,
    PRICE.Height AS height,
    "taxable" AS tax_status,
    "*" AS tax_class,
    "" AS upsell_ids,
    "" AS crosssell_ids,
    "" AS featured,
    "" AS sale_price_dates_from,
    "" AS sale_price_dates_to,
    'http://' AS file_path,
    "" AS download_limit,
    "" AS external_url,
    "" AS images,
    categories_adj.HOOFDCATEGORIE AS `tax:product_cat`,
    "" AS `tax:product_tag`,
    "simple" AS `tax:product_type`
FROM
    PRICE_GENERIC,
    categories_adj,
    PRICE
INNER JOIN `FEES_GENERIC` ON `PRICE_GENERIC`.`Part Number` = `FEES_GENERIC`.`Part Number`
INNER JOIN `HOURLY_STOCK_GENERIC` ON `PRICE_GENERIC`.`Part Number` = `HOURLY_STOCK_GENERIC`.`Part Number`
INNER JOIN `PRICE` ON `PRICE_GENERIC`.`Part Number` = `PRICE`.`Part Number`
INNER JOIN `CATEGORIES` ON `PRICE`.`Sub-Category` = `CATEGORIES`.`Product Hierarchy Number Level 2`
INNER JOIN `categories_adj` ON `CATEGORIES`.`Product Hierarchy Number Level 2` = `categories_adj`.`Product Hierarchy Number Level 2`
WHERE
    `categories_adj`.`HOOFDCATEGORIE` IS NOT NULL
; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:00:01.380

您在`PRICE`这里加入了两次表：

```
FROM
    PRICE_GENERIC,
    categories_adj,
    PRICE 
```

和这里：

```
INNER JOIN `PRICE` ON `PRICE_GENERIC`.`Part Number` = `PRICE`.`Part Number` 
```

如果这确实是您的意图，而不是错误（在我看来是这样），您需要为其中的最后一个提供别名。

`categories_adj`桌子也一样

# perl - 从 UTF8 文本中提取小写俄语单词

> ID：15341671
> 
> 赞同：1
> 
> 时间：2013-03-11T14:55:08.877
> 
> 标签：perl, unicode, utf-8, text-extraction, utf

在 Windows 7 上使用 ActiveState Perl 5.14.2 或在 CentOS 6.3 Linux 上使用 Perl 5.10.1 我试图从 UTF8 文本中提取所有小写单词：

```
#!/usr/bin/perl -w

use strict;
use warnings;

while(<>) {
    # print "$1\n" while /\b([a-z]{3,})\b/g;
    print "$1\n" while /\b([\x{0430}-\x{044F}]{3,})\b/g;
} 
```

虽然这对英文单词很有效（请参阅上面的注释行），但对于西里尔字母（请参阅[Unicode 范围图表](http://www.unicode.org/charts/PDF/U0400.pdf)）则失败 - 脚本不会打印任何内容。

请问有人知道，有什么问题吗？

为方便起见，下面粘贴了一个示例俄语文本：

> Все смешалось в доме Облонских。Жена узнала, что муж был в связи с бывшею в их доме француженкою-гувернанткой, и объя вила мужу, что не может жить Положение это продолжалось уже третий день и мучительно чувствовалось и самими супругами, и всеми членами семьи, и домось

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:18:28.353

您指的是范围 >255 ( `\x{0430}`)，这是内部 Perl unicode 格式。但是你的字符串似乎没有转换成那种格式。您需要设置`use utf8;`编译指示。这对我有用：

```
#!/usr/bin/perl -w

use strict;
use warnings;
use utf8;

binmode(STDOUT, ":utf8"); #Fix stdout warning

while(<DATA>) {
    print lc($1)."\n" while /\b([\x{0430}-\x{044F}]{3,})\b/g;
}
__DATA__
Все смешалось в доме Облонских. Жена узнала, что муж был.
в связи с бывшею в их доме француженкою-гувернанткой, и объявила мужу, что не может жить с ним в одном доме.
Положение это продолжалось уже третий день и мучительно чувствовалось и самими супругами, и всеми членами семьи, и домочадцами. 
```

但更正确的方法是操作字符，而不是范围。此外，如果您从某个文件中读取，您可能需要设置 utf8 标志：

```
#!/usr/bin/perl -w

use strict;
use warnings;
use utf8;

binmode(STDOUT, ":utf8");

while(<>) {
    utf8::decode($_); #Convert into internal utf8 format
    print lc($1)."\n" while /\b([а-яА-ЯёЁ]{3,})\b/g;
} 
```

Файл:

```
Однажды в студёную зимнуюю пору... ёёёёЁЁЁ йййЙЙЙЙ
Приветт, земляк! 
```

如果启用`use utf8` **lc()**将知道小写字母。

（`ёЁ`是分开的，因为它是变音符号并且不适合范围）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:03:48.077

您需要将 STDIN 和 STDOUT 设置为 UTF-8：

```
binmode STDOUT, ':utf8';
binmode STDIN, ':utf8'; 
```

您的正则表达式应该在此之后工作。

也就是说，我将使用 Unicode 属性测试的组合而不是显式范围：

```
\b(((?=\p{Cyrillic})\p{Lowercase_Letter}){3,})\b 
```

# javafx-2 - JavaFx 获取常规 Y 轴 TickUnit

> ID：15341674
> 
> 赞同：0
> 
> 时间：2013-03-11T14:55:14.510
> 
> 标签：javafx-2

*   我想停止 Y-Axis autoRange , `yAxis.setAutoRange(false)`.
*   我有`Maximum`价值观。假设`Minimum = 0`，
*   如何使用 (max) 为 tickunit 生成常规值。
*   有能力去。

    Y-axis.setUpperBound(max); Y-axis.setTickUnit(tickunit);

# java - 如何在java中检测图像篡改？

> ID：15341678
> 
> 赞同：-1
> 
> 时间：2013-03-11T14:55:19.530
> 
> 标签：java, image-processing, image-segmentation

我想创建一个 java 代码，我想在其中检测图像篡改，例如在同一图像上复制粘贴伪造，我必须使用图像分割来显示图像的哪一部分被复制并粘贴到图像的其他部分。由于我是 java 图像处理的新手，如何从普通图像处理接近这个级别。

1.  如何在java中将图像读取为像素

2.  如何对这些像素进行聚类以形成组。

3.  如何匹配这些组以获得匹配模式。

4.  如何使用图像分割找到原始和复制粘贴。

我只想要一个完美的指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:15:30.450

请参阅 BufferedImage（用于像素操作）和 ImagIO（用于读取）。

数据结构可以优化，但为什么不从像素矩阵开始。一般来说，颜色很重要，因此在一个整数中使用颜色分量而不是 RGB 会更好。

调查寻找自己：边界处的颜色伪影，对比度太强，头发缺失，阴影错误，亮度差异差异。做统计。在一条线 (y, x1..x2) 和区域上移动。认识形状。

有小测试图像，单元测试。

*我无法提供更多帮助。*

# javascript - 如何设置文件上传的路径，如果元素不可见，只能由锚标记引用？

> ID：15341680
> 
> 赞同：9
> 
> 时间：2013-03-11T14:55:22.670
> 
> 标签：javascript, webdriver, anchor, automated-tests

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T16:36:10.120

尝试先显示控件，然后设置值，然后再次隐藏它：

```
JavascriptExecutor js = (JavascriptExecutor) driver;
js.executeScript("document.getElementById('image-selector-button').style.display = 'block';");
driver.findElement(By.id("image-selector-button ")).sendKeys("c:\\myFile.bmp");
js.executeScript("document.getElementById('image-selector-button').style.display = 'none';"); 
```

# php - MYSQL 需要帮助使用 php 从每个“用户”中提取数据

> ID：15341685
> 
> 赞同：1
> 
> 时间：2013-03-11T14:55:29.440
> 
> 标签：php, mysql, database

这就是我所拥有的。此代码从所有用户中获取数据并从 user_days 中减去 1，然后更新每个用户的 user_days 行。

```
$result = mysqli_query($con,"SELECT * FROM users");

while($row = mysqli_fetch_array($result))
  {
  $minusone = $row['user_days']-1;
  mysqli_query($con,"UPDATE users SET user_days=$minusone");
  echo "<br />";
  echo $row['user_days'];
  } 
```

我遇到的问题是：不是从每个用户中减去 1 并更新每个用户字段，而是使用第一个用户的值更新每个用户的字段。

示例：在更新用户 1 有 30 天之前，用户 2 有 60 天

更新后用户 1 有 29 天，用户 2 有 29 天（而不是 59 天）

任何帮助表示赞赏，我希望这个问题很容易理解。

澄清一下，我确实想更新每个字段。我只是不希望从第一个结果中复制更新。

谢谢大家的回答，这给了我很多帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:00:01.810

你为什么不直接跑`UPDATE users SET user_days = user_days-1 WHERE id=XXXXX`？然后全选？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:10:03.363

正如其他答案已经指出的那样，最好的方法是用一行替换整个代码块。

```
mysqli_query($con, "UPDATE users SET user_days=user_days-1"); 
```

然后您可以根据需要选择并显示信息。

在不确切知道您的用途的情况`user_days`下，我认为可能有更好的方法来解决您正在尝试做的事情。我假设这是某种订阅服务，并且此代码将每天运行一次，以减少允许他们访问服务的天数。

更好的方法是`subscriptionExpires`在您的数据库中有一个字段，该字段将保存一个日期时间值。使用您的方法，如果运行此操作的作业失败，每个用户都将获得额外的一天。如果网络蜘蛛或用户找到您的脚本，您的用户帐户将提前到期怎么办。如果您使用帐户到期的实际日期，则无法猜测当前值是否正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T14:59:32.227

您应该将哪条记录指向 UPDATE

```
mysqli_query($con,"UPDATE users SET user_days=$minusone WHERE id=XXXXX"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T14:59:48.503

问题出在`UPDATE`声明上。如果没有`WHERE`子句，它将将该`SET`子句应用于数据库中的每一行。假设您在 users 表中有一个唯一的 id 列`id`，您可以像这样修改您的代码：

```
while($row = mysqli_fetch_array($result))
{
  $minusone = $row['user_days']-1;
  $user_id = $row['id'];
  mysqli_query($con,"UPDATE users SET user_days=$minusone WHERE id=$user_id");
  echo "<br />";
  echo $row['user_days'];
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-11T14:58:20.423

更新记录时，需要指定感兴趣记录的用户 ID，否则当前查询会更新表中的所有行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-11T15:00:26.793

使用以下查询：

```
mysqli_query($con,"UPDATE users SET user_days=$minusone WHERE user_ID = '".$row['user_ID']."'"); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-11T15:01:37.613

您正在使用相同的`$minusone`值更新所有用户。您需要`WHERE`在更新语句中添加一个子句，如下所示：

```
$result = mysqli_query($con,"SELECT * FROM users");

while($row = mysqli_fetch_array($result))
  {
  $minusone = $row['user_days']-1;
  $id_user = $row['id_user'];
  mysqli_query($con,"UPDATE users SET user_days=$minusone WHERE id_user = $id_user");
  echo "<br />";
  echo $row['user_days'];
  } 
```

做你想做的另一种方法是：

```
...
$result = mysqli_query($con,"UPDATE users SET user_days = user_days - 1");
... 
```

这假设您想将 1 减去 all `user_days`。

# sql-server - 使用 Quartz.NET 执行多个存储过程

> ID：15341689
> 
> 赞同：1
> 
> 时间：2013-03-11T14:55:39.067
> 
> 标签：sql-server, quartz.net

在阅读了所有教程之后，我仍然试图围绕 Quartz.NET 展开思考，这些教程看起来非常特定于代码，而不是专注于实现。这就是我想要做的。我有 20 个 SQL 存储过程，它们可以执行各种操作，例如查询日志表、将数据重新提交到其他进程等。我希望这些 SP 在一天中定期运行。所以这对于 Quartz.NET 来说似乎很自然。我计划创建一个 Windows Svc，它实现 Quartz.NET 并在与 Quartz 程序集相同的文件夹中的程序集中包含作业。

我认为，实现这一点的一种不好的方法是为每个 SP 编写一个作业类，并为每个 SP 关联一个单独的触发器。作业类将简单地执行一个特定的 SP，其名称在类中被硬编码。那是不好的方式。

但是对于我的一生，我无法弄清楚好方法是什么。显然，拥有一个只执行通用“按名称执行 SP”的作业类，其中名称来自一个简单的 SQL 表，这似乎是要走的路，但我将如何获得与不同 SP 相关联的不同触发器，以及如何Quartz 知道将所有 20 个 SP 加载到单独的线程上吗？

Quartz 怎么知道要拾取更改的触发器，例如为其中一个 SP 拾取？这是否必须是 Win Svc 上的启动/停止循环才能重新加载作业和触发器，还是我也必须手动编写某种“重新加载”代码？

有什么想法吗？我误解了石英是什么吗？措辞使它听起来像是一个企业调度程序，一个系统，一个你安装的东西。OTOH 的所有文档使它看起来只是一堆类，您可以将它们拼接在一起以创建您的 OWN 调度程序或调度系统，这与 MS 在 .NET 中提供的用于创建执行 FTP 的应用程序的类没有什么不同。可能是我期待太多了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T11:47:28.810

满足您的要求的一种非常简单的方法可能是：

**从示例服务器开始**

以 Quartz.NET 发行版的服务器为起点，您有一个现成的 Windows 服务模板，该模板利用 TopShelf 轻松安装

**使用带有变更检测的 XML 配置**

quartz.config 文件包含实际配置，您可以看到作业和触发器是从 XML 文件 quartz_jobs.xml 中读取的。

您需要添加*quartz.plugin.xml.scanInterval = 10*来观察变化（每十秒）

**使用触发器作业数据映射来参数化作业**

如果 SQL 执行与您建议的一样简单，您可以为每个触发器使用相同的作业类。只需将所需的配置添加到 XML 中的触发器定义（此处的示例每十秒运行一次，添加任意数量的触发器）：

```
<trigger>
  <simple>
    <name>sqlTrigger1</name>
    <job-name>genericSqlJob</job-name>
    <job-group>sqlJobs</job-group>
    <job-data-map>
      <entry>
        <key>sql_to_run</key>
        <value>select 1</value>
      </entry>
    </job-data-map>
    <misfire-instruction>SmartPolicy</misfire-instruction>
    <repeat-count>-1</repeat-count>
    <repeat-interval>10000</repeat-interval>
  </simple>
</trigger> 
```

只需使用quartz_jobs.xml 作为基础并进行必要的更改。

**在工作中使用配置**

您可以从包含作业和触发器参数的上下文的 MergedJobDataMap 访问作业中的配置，后者覆盖前者。

```
public void Execute(IJobExecutionContext context)
{
    string sqlToRun = context.MergedJobDataMap.GetString("sql_to_run");
    SqlTemplate.ExecuteSql(sqlToRun);
} 
```

# android - Android - 来自 arrayadapter getcount() 的 AutoCompleteTextView nullpointerexception

> ID：15341690
> 
> 赞同：0
> 
> 时间：2013-03-11T14:55:39.190
> 
> 标签：android, nullpointerexception, android-arrayadapter, autocompletetextview

当我使用 asyntask 从 api 获取一些搜索结果并填充 arrayadapter 时，我无法弄清楚为什么我不断收到 nullpointerexception

```
public class AddVenueActivity extends Activity implements TextWatcher{
    private AutoCompleteTextView venue_auto_complete;
    private ArrayList<String> venues = new ArrayList<String>();
    private ArrayAdapter<SearchResult> adapter;
    private SmartImageView location_image;
    private VenueManager venueManager;
    private Venue venue;
    private Map<Integer, Object> current_venue_suggest_list = new HashMap<Integer, Object>();
    private TextView venue_name_textview;
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_addvenue);

        try
        {
            venue_auto_complete = (AutoCompleteTextView) findViewById(R.id.add_venue_autocomplete);
            ArrayList<SearchResult> search_results = new ArrayList<SearchResult>();
            adapter = new ArrayAdapter<SearchResult>(this, android.R.layout.simple_list_item_1, search_results);
            venue_auto_complete.setThreshold(2);
            adapter.setNotifyOnChange(true);
            venue_auto_complete.addTextChangedListener(this);
            venue_auto_complete.setAdapter(adapter);
            venue_name_textview = (TextView) findViewById(R.id.add_venue_venue_name);
            venue_name_textview.setVisibility(View.GONE);

            venueManager = new VenueManager();

            location_image = (SmartImageView) findViewById(R.id.add_venue_location_image);

            venue_auto_complete.setOnClickListener(new OnClickListener(){
                @Override
                public void onClick(View arg0) {
                    // TODO Auto-generated method stub
                    venue_auto_complete.setDropDownHeight(LayoutParams.WRAP_CONTENT);
                }
            });

            venue_auto_complete.setOnItemClickListener(new OnItemClickListener(){
                @Override
                public void onItemClick(AdapterView<?> listView, View arg1, int position, long arg3) {
                    try
                    {
                        SearchResult search_result = (SearchResult) listView.getAdapter().getItem(position);
                        Toast.makeText(AddVenueActivity.this, search_result.toString(), Toast.LENGTH_LONG).show();
                        InputMethodManager imm = (InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
                        imm.hideSoftInputFromWindow(venue_auto_complete.getWindowToken(), 0);
                        venue_auto_complete.setText(search_result.venue_name);
                        venue_auto_complete.dismissDropDown();
                        venue_auto_complete.setDropDownHeight(0);

//                      // go find the venue we've selected
                        RequestParams params = new RequestParams();
                        params.put("id", search_result.id.toString());
                        Api.get("/venue", params, new JsonHttpResponseHandler() {
                            @Override
                            public void onSuccess(JSONObject json_response) 
                            {
                                try
                                {
                                    venue = venueManager.addVenueFromJSON(json_response);
                                    venue_name_textview.setVisibility(View.VISIBLE);
                                    venue_name_textview.setText(venue.name);
                                }
                                catch(Exception e)
                                {
                                    Log.v("Error", e.toString());
                                }
                            }
                        });
                    }
                    catch(Exception e)
                    {
                        Log.v("EROORS", e.toString());
                    }
                }
            });
        }
        catch(Exception e)
        {
            e.printStackTrace();
            Log.v("ERROR", e.toString());
        }
    }

    @Override
    public void afterTextChanged(Editable arg0) {
        // TODO Auto-generated method stub

    }

    @Override
    public void beforeTextChanged(CharSequence arg0, int arg1, int arg2,
            int arg3) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onTextChanged(CharSequence arg0, int arg1, int arg2, int arg3) {
//      if(arg0.length() > current_query.length())
//      {
//          current_query = arg0.toString();
            search(arg0.toString());
//      }
    }

    public void search(String query)
    {
        try
        {
            RequestParams params = new RequestParams();
            params.put("q", query);
            Log.v("SEARCH", "Search query for " + query);
            Api.get("/search", params, new JsonHttpResponseHandler() 
            {
                @Override
                public void onSuccess(JSONObject json_response) 
                {
                    try
                    {

                        if(adapter != null){
                            adapter.clear();
                            JSONArray venue_searchs = json_response.getJSONArray("response");

                            for(int i = 0; i < venue_searchs.length(); i++)
                            {
                                JSONObject venue_search_result = venue_searchs.getJSONObject(i);
                                if(venue_search_result.getString("address") != "null")
                                {
                                    adapter.add(new SearchResult(venue_search_result.getInt("id"), venue_search_result.getString("name"), venue_search_result.getString("address")));
                                    //adapter.add(venue_search_result.getString("name") + "\n" + venue_search_result.getString("address"));
                                }
                                else
                                {
                                    adapter.add(new SearchResult(venue_search_result.getInt("id"), venue_search_result.getString("name"), ""));
                                    //adapter.add(venue_search_result.getString("name"));
                                }
                            }

                            venue_auto_complete.setAdapter(adapter);
                            adapter.notifyDataSetChanged();
                        }
                    }
                    catch(Exception e)
                    {
                        Log.v("ERROR", e.toString());
                    }
                }
            });
        }
        catch(Exception e)
        {
            Log.v("error", e.toString());
        }
    }

} 
```

记录猫输出

```
03-11 14:50:55.334: E/AndroidRuntime(21313): FATAL EXCEPTION: main
03-11 14:50:55.334: E/AndroidRuntime(21313): java.lang.NullPointerException
03-11 14:50:55.334: E/AndroidRuntime(21313):    at android.widget.ArrayAdapter.getCount(ArrayAdapter.java:291)
03-11 14:50:55.334: E/AndroidRuntime(21313):    at android.widget.AdapterView.checkFocus(AdapterView.java:689)
03-11 14:50:55.334: E/AndroidRuntime(21313):    at android.widget.AdapterView$AdapterDataSetObserver.onInvalidated(AdapterView.java:812)
03-11 14:50:55.334: E/AndroidRuntime(21313):    at android.database.DataSetObservable.notifyInvalidated(DataSetObservable.java:43)
03-11 14:50:55.334: E/AndroidRuntime(21313):    at android.widget.BaseAdapter.notifyDataSetInvalidated(BaseAdapter.java:54)
03-11 14:50:55.334: E/AndroidRuntime(21313):    at android.widget.ArrayAdapter$ArrayFilter.publishResults(ArrayAdapter.java:469)
03-11 14:50:55.334: E/AndroidRuntime(21313):    at android.widget.Filter$ResultsHandler.handleMessage(Filter.java:282)
03-11 14:50:55.334: E/AndroidRuntime(21313):    at android.os.Handler.dispatchMessage(Handler.java:99)
03-11 14:50:55.334: E/AndroidRuntime(21313):    at android.os.Looper.loop(Looper.java:150)
03-11 14:50:55.334: E/AndroidRuntime(21313):    at android.app.ActivityThread.main(ActivityThread.java:4385)
03-11 14:50:55.334: E/AndroidRuntime(21313):    at java.lang.reflect.Method.invokeNative(Native Method)
03-11 14:50:55.334: E/AndroidRuntime(21313):    at java.lang.reflect.Method.invoke(Method.java:507)
03-11 14:50:55.334: E/AndroidRuntime(21313):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:849)
03-11 14:50:55.334: E/AndroidRuntime(21313):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:607)
03-11 14:50:55.334: E/AndroidRuntime(21313):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:18:30.610

在某些时候，您的 AutoCompleteTextView 会在您使用其数据对其进行初始化之前尝试使用适配器。因此为什么它给出一个空指针异常。也许您在尝试使用 AutoCompleteTextView 时还没有检索到搜索结果？

# reporting-services - 使用报表生成器在条形图中间隔条形

> ID：15341691
> 
> 赞同：0
> 
> 时间：2013-03-11T14:55:39.467
> 
> 标签：reporting-services

我在 Report Builder 3 中制作的条形图中有 3 个系列。例如：第 1 列 Pitch Nights 已售出 10 个，容量 50 个，入住率 20%，我有 5 个基于年份的结果。

当我运行报告时，图表中的条形图彼此相邻（触摸），但我想将它们隔开以使其看起来更整洁。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T00:44:15.417

这里有有限的选择，但你可能会得到你想要的。从视图功能区启用属性。然后选择您的图表系列。要试验的属性是 CustomAttributes / PointWidth。

# c# - FIX 阅读重复组

> ID：15341693
> 
> 赞同：2
> 
> 时间：2013-03-11T14:55:42.373
> 
> 标签：c#, quickfix, fix-protocol

我有一个 FIX 日志文件。我正在迭代线路，将每个字符串放入

```
Message m = new Message(str, false) 
```

因为由于某种原因，文件上的验证失败（甚至是第一行）。现在，我看到它是 35=X 类型，并且 268=4（即 NoMDEntries=4，所以我应该在消息中有 4 个组）

但是，在调试显示中我没有看到任何组。m.base._groups 的计数为 0。

有问题的字符串是：

```
1128=9 | 9=363 | 35=X | 49=CME | 34=3151 | 52=20121216223556363 | 75=20121217 | 268=4 | 279=0 | 22=8 | 48=43585 | 83=902 | 107=6EH3 | 269=4 | 270=13186 | 273=223556000 | 286=5 | 279=0 | 22=8 | 48=43585 | 83=903 | 107=6EH3 | 269=E | 270=13186 | 271=9 | 273=223556000 | 279=0 | 22=8 | 48=43585 | 83=904 | 107=6EH3 | 269=F | 270=13185 | 273=223556000 | 279=1 | 22=8 | 48=43585 | 83=905 | 107=6EH3 | 269=0 | 270=13186 | 271=122 | 273=223556000 | 336=0 | 346=10 | 1023=1 | 10=179 | 
```

另一件事是我如何阅读组？本能地，我想做类似的事情

```
for (int i = 1; i <= noMDEntries; i++) {
    Group g = m.GetGroup(i);
    int action = Int32.Parse(g.GetField(279));
    ....
} 
```

但这不是它的工作原理，我还没有找到具有更好解释的文档。

谢谢你的帮助，约纳坦。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T15:37:40.873

从您的代码片段中，我认为您正在使用本机 C# 实现[QuickFIX/n](http://quickfixn.org)，所以我会相应地回答。

1）您的消息构造失败，因为您没有提供 DataDictionary。

改用`Message::FromString`：

```
Message m = new Message();
m.FromString(msg_str, false, data_dic, data_dic, someMsgFactory); 
```

更好的是，用于`MarketDataIncrementalRefresh::FromString`获得正确的返回类型。

你可以在这里看到这个函数的一些用途：
[https ://github.com/connamara/quickfixn/blob/master/UnitTests/MessageTests.cs](https://github.com/connamara/quickfixn/blob/master/UnitTests/MessageTests.cs)

2) 阅读组...好吧，QF/n 有一个文档页面，我认为这很好地解释了它。
[http://quickfixn.org/tutorial/repeating-groups](http://quickfixn.org/tutorial/repeating-groups)

# java - 如何将 SolrQuery(SOLRJ) 转换为 URL？

> ID：15341702
> 
> 赞同：7
> 
> 时间：2013-03-11T14:56:01.410
> 
> 标签：java, solr, solrj

在使用 SOLRJ 时，我想知道如何使用 SOLR 查询语法将 SolrQuery 对象转换为其 URL 表示。我尝试使用 .toString() 方法，但它没有返回正确的查询表示。还有其他方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T09:36:21.597

对于这个问题，我推荐[ClientUtils.toQueryString 。](http://lucene.apache.org/solr/4_1_0/solr-solrj/org/apache/solr/client/solrj/util/ClientUtils.html#toQueryString%28org.apache.solr.common.params.SolrParams,%20boolean%29)

```
@Test
public void solrQueryToURL() {
  SolrQuery tmpQuery = new SolrQuery("some query");
  Assert.assertEquals("?q=some+query", ClientUtils.toQueryString(tmpQuery, false));
} 
```

[在HttpSolrServer](http://lucene.apache.org/solr/4_1_0/solr-solrj/org/apache/solr/client/solrj/impl/HttpSolrServer)的源代码中，您可以看到 Solrj 代码本身为此使用了它。

```
public NamedList<Object> request(final SolrRequest request, final ResponseParser processor) throws SolrServerException, IOException {

  // ... other code left out

  if( SolrRequest.METHOD.GET == request.getMethod() ) {
    if( streams != null ) {
      throw new SolrException( SolrException.ErrorCode.BAD_REQUEST, "GET can't send streams!" );
    }
    method = new HttpGet( baseUrl + path + ClientUtils.toQueryString( params, false ) );

  // ... other code left out

  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-03T16:16:26.343

SolrJ（测试版本 6.6.0 ）它是：

```
@Test
public void solrQueryToURL() {
  SolrQuery query = new SolrQuery("query");
  Assert.assertEquals("?q=query", query.toQueryString());
} 
```

# codeigniter - 传递数组以查看 codeigniter

> ID：15341706
> 
> 赞同：0
> 
> 时间：2013-03-11T14:56:03.453
> 
> 标签：codeigniter, codeigniter-2

我有自己验证字段的问题。现在表单中有 5-6 个字段。所以我正在检查我的控制器中的每一个，如果有错误我希望再次加载视图并将错误数组传递给它。

我用这个实现了上述功能：

```
<html>
<head>
<title>My Form</title>
<meta http-equiv='Content-Type' content='text/html; charset=utf-8'>

</head>
<body>

<?php
    echo $fullname;
?>

<?
 echo form_open('/membership/register');    
?>

<h5>Username</h5>
<input type="text" name="username" value="" size="50" />

<h5>Password</h5>
<input type="text" name="password" value="" size="50" />

<h5>Password Confirm</h5>
<input type="text" name="cpassword" value="" size="50" />

<h5>Email Address</h5>
<input type="text" name="email" value="" size="50" />

<h5>Mobile</h5>
<input type="text" name="mobile" value="" size="15" />

<h5>Home</h5>
<input type="text" name="home" value="" size="15" />

<h5>Full Name</h5>
<input type="text" name="fullname" value="" size="100" />
<br><br>
<div><input type="submit" value="Submit" /></div>

</form>

</body>
</html> 
```

在控制器中，代码是：

```
 if (preg_match('#[0-9]#',$fullname))
            { 
                $errors['fullname'] = 'wrong name format!';
                $this->load->view('register', $errors); 
            } 
```

现在我遇到的真正问题是许多字段是否错误。我想将 $errors 数组传递给 view 并在那里访问它包含的所有值。所以我不必指定 $fullname 或 $mobile 来获取值。如何才能做到这一点？为了向用户展示所有丢失的东西

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T16:24:25.343

首先，我建议使用 codeigniter 内置的表单验证类

以下是我通常在控制器中处理验证的方式：

```
if ($this->input->post()) 
{
    // process the POST data and store accordingly
    $this->form_validation->set_rules('username', 'Username', 'trim|required|min_length[5]|xss_clean');
    $this->form_validation->set_rules('password', 'Password', 'trim|required|min_length[6]|xss_clean');
    // the rest of your form fields validation can be set here
    if ($this->form_validation->run() == FALSE)
    {
        // validation hasnt run or has errors, here just call your view
        $this->load->view('same_view_file_with_the_form', $data);
    }
    else
    {
        // process the POST data upon correct validation
    }
} 
```

在我的视图文件中，我这样称呼每个错误：

```
<h5>Username</h5>
<input type="text" name="username" value="" size="50" />
<span class="error-red"><?php echo form_error("username"); ?></span>
<h5>Password</h5>
<input type="text" name="password" value="" size="50" />
<span class="error-red"><?php echo form_error("password"); ?></span>
<h5>Password Confirm</h5>
<input type="text" name="cpassword" value="" size="50" />
<span class="error-red"><?php echo form_error("cpassword"); ?></span> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T14:59:41.857

`errors`在绑定到视图之前在控制器中进行所有检查。

例如

```
$errors = array();

if (preg_match('#[0-9]#',$fullname))
{ 
    $errors['fullname'] = 'wrong name format!';
}

if ( do_something_to_validate(mobile) )
{
    $errors['mobile'] = 'invalid mobile';
}

// after checking everything do this
$this->load->view('register', $errors); 
```

# selenium-webdriver - 使用 ChromeWebdriver 时打开 IE

> ID：15341709
> 
> 赞同：0
> 
> 时间：2013-03-11T14:56:07.400
> 
> 标签：selenium-webdriver, selenium-grid, selenium-chromedriver

我尝试过搜索，但没有找到解决方案。在将节点放在其他机器上之前，我试图让 Selenium Grid 在我的本地机器上工作。长话短说，当我尝试使用 chromewebdriver IE 打开时。

一切都可以编译，但 IE 打开而不是 chrome。在尝试查找问题时，我使用了 driver.getCapabilities().getBrowserName()，它显示了 internetexplorer。我尝试查看 remoteWebDriver 类，但找不到将其功能设置为 IE 的位置。

我也尝试过处理和运行类似问题的一些代码，但 IE 仍然打开。任何帮助，将不胜感激。

集线器：java -jar selenium-server-standalone-2.31.0.jar -role hub -port 4444

节点：

```
java -jar selenium-standalone-2.31.0.jar -role node -port 5555 -hub http://localhost:4444/grid/register -browser browserName=chrome,platform=WINDOWS -browser browserName=firefox,platform=WINDOWS 
```

（我也尝试添加 -Dwebdriver.chrome.driver={path to web driver} 但没有运气）

代码：

```
WebDriver driver;
@Before
public void setUp()throws java.net.MalformedURLException{
    DesiredCapabilities capability = DesiredCapabilities.chrome();
    capability.setBrowserName("Chrome");
    capability.setPlatform(Platform.WINDOWS);
    driver = new RemoteWebDriver(new java.net.URL("http://localhost:5555/wd/hub"), capability, capability);
    driver.get("http://book.theautomatedtester.co.uk/chapter1");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T03:52:16.640

您注册的浏览器名称为“chrome”，功能为“Chrome”。理想情况下，这应该抛出没有可用的浏览器

# php - PHP 脚本在终端中有效，但在浏览器中无效

> ID：15341713
> 
> 赞同：2
> 
> 时间：2013-03-11T14:56:30.613
> 
> 标签：php, exec

我正在尝试执行`exec`命令，但遇到了问题。当我运行以下代码时，当我通过浏览器运行它时它不起作用。但是，如果我将`$str`复制的输出粘贴到终端中，它就可以正常工作。什么会导致这种情况，我该如何解决？目前我正在运行`localhost`.

```
$php_location = "/usr/bin/php";
$data = str_replace("\"", "\\\"", json_encode($_POST));
$cwd = __DIR__;

shell_exec($str = "$php_locataion $cwd/phpExcel.php \"$data\" > /home/ryannaddy/Desktop/phpExcel.txt &");

echo $str; 
```

这是文件`shell_exec`正在调用：

```
<?php
set_time_limit(0);
$args = $argv[1];

$data = json_decode(str_replace("\\\"", "\"", $args), true);
echo "hello!"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T14:58:31.687

当您通过浏览器运行它时，它会以可能没有正确权限的 Web 服务器用户身份执行。当您在终端中运行它时，它会以您登录的任何用户身份执行。检查 apache（假设您使用的是 apache）用户对脚本 / 目录是否具有正确的权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T14:58:50.017

该问题可能与权限有关。

当您从 shell 运行某些东西时，它会在您的用户帐户下运行。Web 服务器将以不同的方式运行，通常对任何东西的权限都很少。要么给 Web 服务器的帐户适当的权限，要么在不同的帐户下运行服务器（不推荐！）。

# python - 有没有一种快速的方法可以将 numpy 数组中的一个元素与该数组中的其余元素进行比较？

> ID：15341714
> 
> 赞同：5
> 
> 时间：2013-03-11T14:56:34.763
> 
> 标签：python, arrays, numpy

我有一个数组，我想查看该数组中的任何元素是否大于或等于该数组中的任何其他元素。我可以做两个 for 循环，但我的数组长度为 10,000 或更大，因此创建了一个非常慢的程序。无论如何，我可以更快地做到这一点吗？

[编辑] 我只需要它来查看它是否大于或等于我正在查看的元素之后的元素，如果是，我需要知道它的索引。

[编辑] 我将更清楚地重新解释我的问题，因为当前的解决方案不能满足我的需要。首先，这里有一些代码

```
x=linspace(-10, 10, 10000)
t=linspace(0,5,10000)

u=np.exp(-x**2)

k=u*t+x 
```

所以我取一个 x 数组，通过将它放入高斯得到它的高度，然后基于该高度，这就是 x 值在空间中传播的速度，我用 k 找到。我的问题是，我需要找出高斯何时变为双值函数（或者换句话说，何时发生冲击）。如果我执行 argmax 解决方案，我将始终获得 k 中的最后一个值，因为它非常接近于零，我需要元素之后的第一个值，这将在我的函数中给我一个 double 值。

[编辑] 小例子

```
x=[0,1,2,3,4,5,6,7,8,9,10] #Input 
k=[0,1,2,3,4,5,6,5,4,10] #adjusted for speed

output I want
in this case, 5 is the first number that goes above a number that comes after it.
So I need to know the index of where 5 is located and possibly the index 
of the number that it is greater than 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T16:35:46.740

大于后一个值的第一个值必然对应于局部最小值中的最小值：

```
k = np.array([0,1,2,3,4,5,6,5,4,10])
lm_i = np.where(np.diff(np.sign(np.diff(k))) > 0)[0] + 1
mlm = np.min(k[lm_i])
mlm_i = lm_i[np.argmin(k[lm_i])] 
```

大于后一个值的第一个值的索引是大于该最小局部最小值的第一个索引：

```
i = np.where(k > mlm)[0][0] 
```

![解图](../Images/f4729e09afd9ebfe08cb4a4fdf2dace8.png)

（忽略图形似乎与切线处的水平线相交；这只是一个显示伪影。）

作为一个单行：

```
np.where(k > np.min(k[np.where(np.diff(np.sign(np.diff(k))) > 0)[0] + 1]))[0][0] 
```

请注意，这是大约。比 root 的解决方案快 1000 倍，因为它是完全矢量化的：

```
%timeit np.where(k > np.min(k[np.where(np.diff(np.sign(np.diff(k))) > 0)[0] + 1]))[0][0]
1000 loops, best of 3: 228 us per loop 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T15:09:31.833

矢量化解决方案，比 ecatmur 的解决方案快 25%：

```
np.where(k > np.min(k[np.where(np.diff(k) < 0)[0][0]:]))[0][0] 
```

一种天真的方法：

```
next(i for i in np.arange(len(arr)) if arr[i:].argmin() != 0) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-11T16:23:39.040

**编辑** 实际上，拥有 10,000 项 python for 循环比在 100,000,000 项数组上操作更便宜::

```
In [14]: np.where(np.array([True if np.all(k[:j] <= k[j]) else
                            False for j in xrange(len(k))]) == 0)
Out[14]: (array([5129, 5130, 5131, ..., 6324, 6325, 6326]),)

In [15]: %timeit np.where(np.array([True if np.all(k[:j] <= k[j]) else
                                    False for j in xrange(len(k))]) == 0)
1 loops, best of 3: 201 ms per loop 
```

* * *

就内存而言，这将是昂贵的，但您可以使用广播对搜索进行矢量化。如果你这样做：

```
>>> k <= k[:, None]
array([[ True, False, False, ..., False, False, False],
       [ True,  True, False, ..., False, False, False],
       [ True,  True,  True, ..., False, False, False],
       ..., 
       [ True,  True,  True, ...,  True, False, False],
       [ True,  True,  True, ...,  True,  True, False],
       [ True,  True,  True, ...,  True,  True,  True]], dtype=bool) 
```

返回值是一个布尔数组，其中位置项`[i, j]`告诉您是否`k[j]`小于或等于`k[i]`。什么时候可以使用`np.cumprod`如下：

```
>>> np.cumprod(k <= k[:, None], axis=1)
array([[1, 0, 0, ..., 0, 0, 0],
       [1, 1, 0, ..., 0, 0, 0],
       [1, 1, 1, ..., 0, 0, 0],
       ..., 
       [1, 1, 1, ..., 1, 0, 0],
       [1, 1, 1, ..., 1, 1, 0],
       [1, 1, 1, ..., 1, 1, 1]]) 
```

位置中的项目`[i, j]`告诉您是否`k[j]`小于或等于 中的所有项目`k[:i]`。如果您采用该矩阵的对角线：

```
>>> np.cumprod(k <= k[:, None], axis=1)[np.diag_indices(k.shape[0])]
array([1, 1, 1, ..., 1, 1, 1]) 
```

位置的项目`[i]`告诉你是否`k[i]`小于或等于它之前的所有项目。查找该数组为零的位置：

```
>>> np.where(np.cumprod(k <= k[:, None],
...                     axis=1)[np.diag_indices(k.shape[0])] == 0)
(array([5129, 5130, 5131, ..., 6324, 6325, 6326]),) 
```

并且您将拥有满足您所需条件的所有值的索引。

如果您只对第一个感兴趣：

```
>>> np.argmax(np.cumprod(k <= k[:, None],
...                      axis=1)[np.diag_indices(k.shape[0])] == 0)
5129 
```

这不是一个轻量级的操作，但如果你有足够的内存来容纳所有的布尔数组，它不会让你等待太久：

```
In [3]: %timeit np.argmax(np.cumprod(k <= k[:, None],
                                     axis=1)[np.diag_indices(k.shape[0])] == 0)
1 loops, best of 3: 948 ms per loop 
```

# ios - 从 ScrollView 返回 NSArray 中的位置

> ID：15341715
> 
> 赞同：0
> 
> 时间：2013-03-11T14:56:38.070
> 
> 标签：ios, objective-c, event-handling, nsarray

我正在尝试使用一组可点击的 UIImageView 创建一个滚动视图。我的目标是，当单击 ImageView 时，它会返回它在数组中占据的位置。问题是我不知道如何“抓住”职位的号码。我怎么做？

到目前为止，我有：

```
- (IBAction)respondToTapGesture:(UITapGestureRecognizer *)recognizer {

    NSLog(@"%@",)//here is where i want to return the element's position.
}

-(void) preenchemenu {

    [menu setContentSize:CGSizeMake(400, 91)];
    int x=0;
    imagensmenu=[NSArray arrayWithObjects:[UIImage imageNamed:@"teste2.tiff"],[UIImage    imageNamed:@"teste2.tiff"], nil];

    for (int i = 0; i <3; i++) {

        UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(x,0 , 90, 91)];
        x=x+90;
        imageView.image = [imagensmenu objectAtIndex:i];
        imageView.tag = 1000+ i;
        imageView.userInteractionEnabled = YES;
        imageView.multipleTouchEnabled = YES;
        UITapGestureRecognizer *tapRecognizermenu = [[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(respondToTapGesture:)];
        tapRecognizermenu.numberOfTapsRequired = 1;

        [imageView addGestureRecognizer:tapRecognizermenu];
        [menu addSubview:imageView];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:05:42.010

您可以创建一个数组来保存您的 imageView，然后在点击它时找到您的 imageView 在此数组中的位置。

为此添加属性

```
@property (nonatomic, strong) NSMutableArray *imageViews; 
```

在init中初始化它

```
- (id)init...
{
  self = [super init...
  if (self) {
    _imageViews = [NSMutableArray array];
  }
  return self;
} 
```

然后稍微修改您当前的方法，将 imageViews 以及菜单的子视图添加到此数组中

```
[self.imageViews addObject:imageView];
[menu addSubview:imageView]; 
```

然后在你的手势识别器回调中你可以做

```
- (void)respondToTapGesture:(id)sender;
{
  UIView *view = [sender view];
  NSLog(@"%d", [self.imageViews indexOfObject:view]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T17:17:39.493

只需找到索引

```
- (IBAction)respondToTapGesture:(UITapGestureRecognizer *)recognizer
{
  UIView *view = recognizer.view;
  NSLog(@"Index of image in array is %d", view.tag-1000);
} 
```

# python - 为什么设置 python 2.7 列表跨越类边界

> ID：15341717
> 
> 赞同：0
> 
> 时间：2013-03-11T14:56:44.187
> 
> 标签：python, list, class, python-2.7

在下面的代码中，为什么将 test1 类中的 email_attachments 列表设置为 'attach1' 也会将 test2 类中的 email_attachments 列表设置为 'attach1'？

班级：

```
class classtest:
    smtp_server = ""
    smtp_port = 0
    email_attachments = []

    def class_print(self):

        print self.smtp_server
        print self.smtp_port
        print self.email_attachments 
```

脚本：

```
import ClassTest

def main():
    test1 = ClassTest.classtest()
    test1.smtp_server = "server1"
    test1.smtp_port = "1"
    test1.email_attachments.append("attach1")
    test1.class_print()

    print

    test2 = ClassTest.classtest()
    test2.smtp_server = "server2"
    test2.class_print()

main() 
```

结果：

服务器1

1

['attach1']

服务器2

0

['attach1']

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:02:36.370

您在类顶部定义的 3 个变量与类本身相关联，而不是与类的特定实例相关联，因此它们的值在 test1 和 test2 之间共享。

如果您的意图是为每个类型的对象设置单独的值，`classtest`那么您应该定义一个构造函数并为每个变量使用“self”前缀：

```
def __init__(self):
    self.smtp_server = ""
    self.smtp_port = 0
    self.email_attachments = [] 
```

# lotus-notes - 为什么 Notes 中的 mailto 链接失败并在收件箱中出现双引号失败？

> ID：15341719
> 
> 赞同：0
> 
> 时间：2013-03-11T14:56:50.503
> 
> 标签：lotus-notes, mailto

作为我们社交实现的一部分，我们正在从 Newsgator 向 Notes 邮件发送电子邮件。它包括三个属于mailto 的链接。热点公式如下所示：

```
"mailto:"Like Event" <SocialActivityStream@DAIPortal.daiglobal.net>?subject=Like this activity event. This email references activity event:NGMetaEvent_0D8111ED124B8FE8693DD6C82BD0FA28_634984171780151056.&body=Send this email to like the activity event." 
```

由于多个双引号，我希望这总是失败。

有趣的是，它并不总是失败。如果你把它放在你的垃圾文件夹中，它就可以工作。如果您转发文档，收件人将能够单击链接。如果您只是编辑并保存收到的消息，链接就可以工作。在任何这些情况下，热点公式看起来都完全相同。

那么，为什么当我从收件箱打开文档时它会失败？

# perl - 迭代一个程序擦除原始集合中的数据

> ID：15341721
> 
> 赞同：0
> 
> 时间：2013-03-11T14:56:55.457
> 
> 标签：perl

我正在尝试研究一种算法，在该算法中，给定一个数字列表，我必须计算一个系数，该系数由数据列表中建立的三角形数量与数字具有的最小邻居数之间的比率给出；例如，给定文件的前两行：

```
1 2 3 4 5 6 9
2 1 3
... 
```

1.  如果一行的第一个元素出现在其他行中，并且如果后续行的第一个元素出现在考试中的行中，那么我找到了一个链接；
2.  如果“*链接*”存在，那么我想计算考试行中的其他元素出现在链接所在行中的次数并打印“*我找到了 z 个三角形*”。

比如本例中，当程序比较第一行和第二行，发现“*链接1 2* ”存在，发现有1个由顶点1,2,3组成的三角形。在算法中，我必须将三角形的数量 + 1 除以每行中元素的最小数量 - 2（在这种情况下，最小数量来自第二行，值为 3-2=1）；我正在寻找的系数是 (1+1)/1 = 2;

输出文件将被写为：

```
1 2 1 
```

在前两列中，我找到了建立链接的元素，在第三列中找到了系数的值；

这是我到目前为止编写的代码：

```
use strict;
use warnings;
use 5.010;
use List::Util;

my $filename = "data";
open my $fh, '<', $filename or die "Cannot open $filename: $!";

my $output_file = "output_example";
open my $fi, ">", $output_file or die "Error during $output_file opening: $!";

my %vector;
while (<$fh>) {
    my @fields = split;
    my $root = shift @fields;
    $vector{$root} = { map { $_ => 1} @fields };
}

my @roots = sort { $a <=> $b } keys %vector;
for my $i (0 .. $#roots) {
    my $aa = $roots[$i];
    my $n_element_a = scalar (keys %{$vector{$aa}})-1;

    for my $j ($i+1 .. $#roots) {
        my $minimum;
        my $bb = $roots[$j];
        my $n_element_b = scalar (keys %{$vector{$bb}})-1;
        next unless $vector{$aa}{$bb} and $vector{$bb}{$aa};
        if ($n_element_a < $n_element_b){
            $minimum = $n_element_a;
        }else {
            $minimum = $n_element_b;
        }

        my $triangles = 0;
        for my $cc ( keys %{$vector{$aa}} ) {
            next if $cc == $aa or $cc == $bb;
            if ($vector{$bb}{$cc}) {
                $triangles++;
            }
        }

        my $coeff;
        my @minimum_list;           
        if ($minimum == 0){
            $coeff = ($triangles +1)/($minimum+0.00000000001);
        } else {
            $coeff = ($triangles +1)/($minimum);
        }
        say $fi "$aa $bb $coeff";
    }
}
__DATA__
1 2 3 4 5 6 9
2 1 3
3 1 2
4 1 5
5 1 4
6 1 7 8
8 6 7
9 1 10 11
10 9 11 12 14
11 9 10 12 13
12 10 13 14
13 11 12
14 10 12 15
15 14 
```

我把整个数据集放在最后。输出文件给出：

```
__OUTPUT__
1 2 2
1 3 2
1 4 2
1 5 2
1 6 0.5
1 9 0.5
2 3 2
4 5 2
6 8 2
9 10 1
9 11 1
10 11 1
10 12 1
10 14 1
11 13 2
12 13 1
12 14 1
14 15 100000000000 
```

现在我想找到系数的最小值，识别呈现这个较低值的链接，擦除原始数据集中的这些元素并在“新”数据集上重复相同的程序。

例如，在这种情况下，呈现最小值的链接是`1 6`和`1 9`，系数为`0.5`。所以现在程序应该在文件数据中删除以“1”开头的行中的元素“6”，反之亦然，与 9 相同。所以现在“新”数据集将是：

```
1 2 3 4 5
2 1 3
3 1 2
4 1 5
5 1 4
6 7 8
8 6 7
9 10 11
10 9 11 12 14
11 9 10 12 13
12 10 13 14
13 11 12
14 10 12 15
15 14 
```

**我正在寻找的是**：

1.  如何从`data`文件中包含的数据集中删除呈现最小系数值的元素？

2.  如何迭代过程 N 次？

* * *

为了从输出文件中找到最小值，我想在程序末尾添加以下几行：

```
my $file1 = "output_example";
open my $fg,  "<", $file1 or die "Error during $file1 opening: $!";

my @minimum_vector;
while (<$fg>) {
    push @minimum_vector, [ split ];
}

my $minima=$minimum_vector[0][2];
for my $i (0 .. $#minimum_vector){
    if($minima >= $minimum_vector[$i][2] ){
        $minima=$minimum_vector[$i][2];
    }
}
say $minima;
close $file1; 
```

但它给了我一个错误，`$minima`因为我认为我无法从我刚刚创建的同一个文件中读取（在本例中为 output_example 文件）。如果我在不同的程序中编译，它就会运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T16:48:20.473

迭代的最佳方法可能是将代码分解为子例程。这也将有助于澄清代码并准确跟踪可能出现问题的位置。

```
use strict;
use warnings;
use 5.010;
use List::Utils qw/min/;

sub load_initial_data {
    # open and read file, load it into an arrayref and return it.
}

sub find_coefficients {
    my $data = shift;
    my @results;
    foreach my $row (@$data) {
        # do stuff to calculate $aa, $bb, $coeff
        push @results, [$aa, $bb, $coeff];
    }
    return \@results;
}

sub filter_data {
    my $data = shift;
    my $coefficients = shift;
    my $min = min map { $_->[2] } @$coefficients;
    my @deletions = grep { $min == $_->[2] } @$coefficients;
    foreach my $del (@deletions) {
        delete( $data->{$del->[0]}{$del->[1]} );
    }
}

# doing the actual work:
my $data = load_initial_data(); 
my $coeffs;
foreach my $pass (0 .. $N) {
    $coeffs = find_coefficients( $data );
    $data = filter_data( $data, $coeffs );
    # You could write $data and/or $coeffs out to a file here
    # if you need to keep the intermediate stages
} 
```

# python - 浮点格式：绘制 strftime

> ID：15341722
> 
> 赞同：0
> 
> 时间：2013-03-11T14:56:56.233
> 
> 标签：python, matplotlib, strftime

我正在格式化 MongoDB 文档中的原始时间戳。原来的样子是这样的：

```
"timestamp" : ISODate("2013-03-06T17:10:29Z") 
```

以及格式化的（使用聚合后用作文档的_id）：

```
"_id" : "06-03-13T17:10" 
```

然后我想根据“_id”值（x轴）绘制“数量”（y轴）值

我无法格式化 _id 以便我可以绘制它。

```
amount = [book["price"] for book in sorted["result"]]
time = [book["_id"] for book in sorted["result"]]
P.plot(amount, time)
P.show() 
```

回报：

```
ValueError: invalid literal for float(): 06-03-13T15:36 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:20:21.880

您正在向`plot`函数传递一个字符串，据我所知，这不是有效的 x 轴格式。我很确定你想要拥有你的原始`datetime`对象，然后使用`date2num`它们来格式化它们以传递给 matplotlib。因此，根据您是否将`strftime`格式化的东西用于其他任何事情，将 的输出存储在映射中可能更有意义`date2num`，而不是`strftime`.

请参阅[这篇文章](https://stackoverflow.com/questions/1574088/plotting-time-in-python-with-matplotlib)以获得更多具体信息和一些示例的链接。

# coldfusion - 将 javascript 表单对象传递给远程 CFC

> ID：15341724
> 
> 赞同：0
> 
> 时间：2013-03-11T14:57:03.690
> 
> 标签：coldfusion

我有 2 个文件：test.cfc 和 test.cfm。当我单击中的提交按钮时`test.cfm`，出现以下错误：

> “错误：对象不支持方法的这个属性”。

我知道这与`passForm`函数内部的表单引用有关。但是在谷歌搜索了几个小时后，我仍然无法解决该错误。有什么建议吗？

**测试.cfc**

```
<cfcomponent>
    <cffunction name="getForm"  returntype="String" access="remote">
        <cfargument name="theForm" type="struct">

    </cffunction>
</cfcomponent> 
```

**测试.cfm**

```
<cfajaxproxy cfc="ajaxFunc.test" jsclassname="testCFC">
<script>
    function passForm(theForm)
    {
        try
        {
            var e = new testCFC();
            message = e.getForm(theForm);
            ColdFusion.navigate('', 'myDiv');
        }
    }
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:06:01.827

您看过ColdFusion中的`serializeJSON()`和函数吗？`deserializeJSON()`

[http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=functions_s_03.html](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=functions_s_03.html)

另外，请查看以下线程，这可能对您有所帮助。

[如何将 STRUCT - OR - JSON 传递给 Coldfusion CFC 方法](https://stackoverflow.com/questions/9489557/how-to-pass-struct-or-json-to-coldfusion-cfc-method)

希望有帮助。米奇。

# c# - WPF 树数据模板取决于项目的类型

> ID：15341728
> 
> 赞同：2
> 
> 时间：2013-03-11T14:57:15.900
> 
> 标签：c#, wpf, mvvm

我有一个包含自引用数据的树的 MVVM WPF 应用程序，该数据通过分层转换器绑定到树。（例如：[http](http://www.telerik.com/help/wpf/radtreeview-how-to-bind-to-self-referencing-data.html) ://www.telerik.com/help/wpf/radtreeview-how-to-bind-to-self-referencing-data.html ）

此数据包括 ID、ParentID、文本和类型（等等）。

示例数据：

```
1,0,"FirstItem","Triangle"
2,1,"SubItem1","Circle"
3,1,"SubItem2","Square"
4,2,"SubItem11","Triangle"
5,2,"SubItem12","Heart"
6,3,"SubItem21","Circle" 
```

现在我想为三角形、心形、圆形和正方形提供不同的模板。我的意思不仅仅是改变一个图像，而是一个真正的模板。我怎样才能做到这一点？

亲切的问候，保罗。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T16:51:54.600

如果您`ItemsSource`由不同的类型组成，那么您可以简单地创建`HierarchicalDataTemplates`而不分配 x:Key。如果 a 没有 x:Key 属性`DataTemplate`，框架将`DataTemplate`在遇到该类型时使用它并尝试以可视方式显示它（您可以`DataTemplates` [在此处](https://web.archive.org/web/20160403194858/http://blogs.magnatis.com/tag/datatemplate)阅读有关隐式的更多信息）。例如，如果您有一个类型 Circle 和另一个类型 Square，您的资源中将有以下模板：

```
<Window.Resources>
    <HierarchicalDataTemplate DataType="{x:Type local:Circle}" ItemsSource="{Binding Children}">
        <Ellipse Fill="{Binding Fill}" Width="25" Height="25" Stroke="Black" StrokeThickness="0.25"/>
    </HierarchicalDataTemplate>
    <HierarchicalDataTemplate DataType="{x:Type local:Square}" ItemsSource="{Binding Children}">
        <Rectangle Fill="{Binding Fill}" Width="25" Height="25" Stroke="Black" StrokeThickness="0.25"/>
    </HierarchicalDataTemplate>
</Window.Resources> 
```

然后，如果您`TreeView`在其中遇到这些类型之一`ItemsSource`，它将使用该`HierarchicalDataTemplate`特定类型。

`HierarchicalDataTemplates` [您可以在此处](http://msdn.microsoft.com/en-us/library/system.windows.hierarchicaldatatemplate.aspx)阅读更多信息，并且[此链接](http://blogs.msdn.com/b/mikehillberg/archive/2009/10/30/treeview-and-hierarchicaldatatemplate-step-by-step.aspx)有一个示例，说明它们如何在`TreeView`.

**或者**

如果您的项目都是相同的类型，并且仅通过属性（例如类型）进行区分，则您需要使用`DataTemplateSelector`. 这是一个简单的例子：

代码隐藏：

```
public class ShapeTemplateSelector : DataTemplateSelector
{
    public DataTemplate CircleTemplate { get; set; }
    public DataTemplate SquareTemplate { get; set; }
    public override DataTemplate SelectTemplate(object item, DependencyObject container)
    {
        Shape shape = item as Shape;
        if (shape != null)
        {
            if (shape.Type == "Circle")
                return this.CircleTemplate;
            else if (shape.Type == "Square")
                return this.SquareTemplate;
            }
            return null;
        }
} 
```

和 XAML：

```
<local:ShapeTemplateSelector x:Key="shapeSelector">
    <local:ShapeTemplateSelector.CircleTemplate>
        <HierarchicalDataTemplate DataType="{x:Type local:Shape}" ItemsSource="{Binding Children}">
            <Ellipse Fill="{Binding Fill}" Width="25" Height="25" Stroke="Black" StrokeThickness="0.25"/>
        </HierarchicalDataTemplate>
    </local:ShapeTemplateSelector.CircleTemplate>
    <local:ShapeTemplateSelector.SquareTemplate>
        <HierarchicalDataTemplate DataType="{x:Type local:Shape}" ItemsSource="{Binding Children}">
            <Rectangle Fill="{Binding Fill}" Width="25" Height="25" Stroke="Black" StrokeThickness="0.25"/>
        </HierarchicalDataTemplate>
    </local:ShapeTemplateSelector.SquareTemplate>
</local:ShapeTemplateSelector> 
```

然后在您的 中`TreeView`，您只需分配选择器

```
<TreeView x:Name="Tree" ItemsSource="{Binding Shapes}" ItemTemplateSelector="{DynamicResource shapeSelector}"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T16:30:49.940

如果您有实际不同的类型，则可以使用 DataType 属性（[如何在 WPF DataTemplate 上使用 DataType 属性？](https://stackoverflow.com/questions/1424554/how-do-i-use-the-datatype-property-on-a-wpf-datatemplate)）在 HierarchicalDataTemplate 中指定类型，WPF 将根据类选择模板。

如果您没有不同的类型，但将取决于类中的属性或值，则需要指定 DataTemplateSelector ( [http://tech.pro/tutorial/807/wpf-tutorial-how-to-使用数据模板选择器](http://tech.pro/tutorial/807/wpf-tutorial-how-to-use-a-datatemplateselector)）

# android - Android 电池消耗 - 应用程序设计

> ID：15341735
> 
> 赞同：2
> 
> 时间：2013-03-11T14:57:29.307
> 
> 标签：android, web-services, google-cloud-messaging, batterylevel

我正在设计一个需要接收不断变化的信息的Android应用程序（所以更新间隔必须非常小）。

现在我正在通过使用 REST WebService 来阅读此信息，但我想知道这是否是关于电池消耗的最佳方法。此应用程序必须经常刷新显示的数据（特别是从另一个系统读取的 GPS 数据）。

我一直在阅读有关 Google Cloud Messaging 的信息，但我没有发现这两种方法之间的任何比较。理论上这两种方法都符合我的需求，因为数据变化如此频繁，以至于无论是通过请求还是在计时器..

所以我的问题是：我应该坚持使用 WebServices 还是转向 GCM？还有另一种电池效率高的解决方案吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T14:59:50.587

GCM 使用已经存在的连接 - 绝对推荐在您当前的轮询方法中使用它，并且对电池更友好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T15:09:14.457

想一想，在您的情况下，GCM 会向您发送通知，让您知道您需要刷新数据，因此您拥有的不仅仅是调用刷新：接收通知，处理它，然后调用刷新。因此，如果您需要**如此频繁地刷新**，例如每分钟说一次**并且它是恒定的**，只需跳过通知即可。我会设置一个重复警报，在 BroadcastReceiver 中获取意图并触发 IntentService 进行刷新

# android - SurfaceView 中带有 SimpleOnGestureListener 的 Android GestureDetector

> ID：15341736
> 
> 赞同：4
> 
> 时间：2013-03-11T14:57:30.600
> 
> 标签：android, touch-event, gesturedetector

```
public class GameActivity extends Activity {
    private static final String TAG = "GameActivity";

   . . .

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        Log.d(TAG, "+ onTouchEvent(event:" + event + ")");
        Log.d(TAG, "- onTouchEvent()");
        return super.onTouchEvent(event);
    }

    . . .
}

public class GameView extends SurfaceView implements SurfaceHolder.Callback {
    private static final String TAG = "GameView";

    . . .

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        Log.d(TAG, "+ onTouchEvent(event:" + event + ")");
        gestureDetector.onTouchEvent(event);
        Log.d(TAG, "- onTouchEvent()");
        return super.onTouchEvent(event);
    }

    private SimpleOnGestureListener gestureListener = new SimpleOnGestureListener() {
        private static final String TAG = "GestureListener";

        @Override
        public boolean onSingleTapConfirmed(MotionEvent event) {
            Log.d(TAG, "+ onSingleTapConfirmed(event:" + event + ")");
            singleTapDetected = true;
            Log.d(TAG, "- onSingleTapConfirmed()");
            return true;
        }

        @Override
        public boolean onDoubleTap(MotionEvent event) {
            Log.d(TAG, "+ onDoubleTap(event:" + event + ")");
            doubleTapDetected = true;
            Log.d(TAG, "- onDoubleTap()");
            return true;
        }
    };

    private GestureDetector gestureDetector = new GestureDetector(getContext(), gestureListener);

    . . .
} 
```

我在 AVD 上运行它并单击 SurfaceView (GameView)。
根据 LogCat 日志：

```
03-11 14:19:51.171: D/GameView(4839): + onTouchEvent(event:MotionEvent { action=ACTION_DOWN, id[0]=0, x[0]=1071.0, y[0]=437.0, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=0, eventTime=27223172, downTime=27223172, deviceId=0, source=0x1002 })
03-11 14:19:51.171: D/GameView(4839): - onTouchEvent()
03-11 14:19:51.171: D/GameActivity(4839): + onTouchEvent(event:MotionEvent { action=ACTION_DOWN, id[0]=0, x[0]=1071.0, y[0]=437.0, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=0, eventTime=27223172, downTime=27223172, deviceId=0, source=0x1002 })
03-11 14:19:51.171: D/GameActivity(4839): - onTouchEvent()
03-11 14:19:51.299: D/GameActivity(4839): + onTouchEvent(event:MotionEvent { action=ACTION_UP, id[0]=0, x[0]=1071.0, y[0]=437.0, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=0, eventTime=27223303, downTime=27223172, deviceId=0, source=0x1002 })
03-11 14:19:51.299: D/GameActivity(4839): - onTouchEvent() 
```

**有几个问题：**

1.  为什么`SimpleOnGestureListener`没有被调用？（即使`onTouchEvent()`被调用并且大概该行`gestureDetector.onTouchEvent(event);`已被执行）

2.  为什么 GameActivity`onTouchEvent()`得到**ACTION_DOWN**和**ACTION_UP**，但GameView`onTouchEvent()`只得到**ACTION_DOWN**？

**我尝试过的一些事情**

*   我用与上面显示的相同的代码`GestureDetector`在类上实现了它，它按预期工作，调用`GameActivity``onSingleTapConfirmed()`

*   在 GameView 中，不是私有成员，而是`SimpleOnGestureListener`创建了一个私有成员`class GestureListener extends SimpleOnGestureListener`并使用它来构造`GestureDetector`. 我看到了与描述相同的行为，没有调用监听器。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T16:38:01.850

我将代码调试到android源代码GestureDetector类中。这解释了为什么`SimpleOnGestureListener`没有被调用：

*   接收到 ACTION_DOWN 并生成内部 TAP 消息给 GestureDetector 消息处理程序。
*   `onSingleTapConfirmed()`仅当事件**未**停止时，处理程序才调用侦听器( `!mStillDown`)
*   该事件仍处于关闭状态，因为从未收到 ACTION_UP 事件。

所以你看，这两个问题是相关的，当我找出为什么没有发出 ACTION_UP 我会解决这个问题！

**编辑**

这完成了答案，现在它正在工作。

*   GameView中的调用`super.onTouchEvent()`返回`false`，因为`super`SurfaceView的类是View，所以返回`false`。这就是为什么 ACTION_UP 永远不会被调用
*   GameActivity 中的调用`super.onTouchEvent()`返回`true`，这就是在 GameActivity 上发出 ACTION_UP 的原因。

*注意：如果我设置* `GameView.setclickable(true)` *则* `super.onTouchEvent()` *返回* `true`. *这也是一个可以接受的解决方案*

现在我的 GameView 代码是：

```
@Override
public boolean onTouchEvent(MotionEvent event) {
    Log.d(TAG, "+ onTouchEvent(event:" + event + ")");
    gestureDetector.onTouchEvent(event);
    Log.d(TAG, "- onTouchEvent()");
    return true;
} 
```

当前的 LogCat 日志是：

```
03-11 16:32:06.629: D/GameView(5316): + onTouchEvent(event:MotionEvent { action=ACTION_DOWN, id[0]=0, x[0]=977.0, y[0]=414.0, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=0, eventTime=35158623, downTime=35158623, deviceId=0, source=0x1002 })
03-11 16:32:06.629: D/GameView(5316): - onTouchEvent()
03-11 16:32:06.641: D/GameView(5316): + onTouchEvent(event:MotionEvent { action=ACTION_MOVE, id[0]=0, x[0]=978.0, y[0]=414.0, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=0, eventTime=35158623, downTime=35158623, deviceId=0, source=0x1002 })
03-11 16:32:06.641: D/GameView(5316): - onTouchEvent()
03-11 16:32:06.772: D/GameView(5316): + onTouchEvent(event:MotionEvent { action=ACTION_UP, id[0]=0, x[0]=978.0, y[0]=414.0, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=0, eventTime=35158772, downTime=35158623, deviceId=0, source=0x1002 })
03-11 16:32:06.772: D/GameView(5316): - onTouchEvent()
03-11 16:32:06.931: D/GestureListener(5316): + onSingleTapConfirmed(event:MotionEvent { action=ACTION_DOWN, id[0]=0, x[0]=977.0, y[0]=414.0, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=0, eventTime=35158623, downTime=35158623, deviceId=0, source=0x1002 })
03-11 16:32:06.931: D/GestureListener(5316): - onSingleTapConfirmed() 
```

# c# - 如何自动选择调试库和发布库？

> ID：15341738
> 
> 赞同：2
> 
> 时间：2013-03-11T14:57:35.183
> 
> 标签：c#, debugging, configuration, release, libraries

使用 MS Visual Studio 2008，我创建了一个依赖于第二个库 (helper.dll) 的 C# 库（我们称之为 main.dll）。在 main.dll 的 Debug 版本中，我设置了对 helper.dll 的 debug 版本的引用。但是当我切换到构建 main.dll 的 Release 版本时，输出文件夹仍然包含 helper.dll 的调试版本。我看不到为不同的构建类型选择不同版本的 helper.dll 的方法。在 C++ 中，我可以告诉链接器从哪个文件夹中获取其文件，但我看不到 C# 的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:01:20.570

这样做的典型方法是将所有项目放在一个解决方案中，并在它们之间使用项目引用。然后，当您在 Debug 中构建时，所有组件都将被构建并作为 debug 引用 - 对于 Release 也是如此。

或者，您可以为所有程序集使用单个输出文件夹，从那里引用每个二进制文件，并确保构建顺序正确 - 以便在`helper.dll`构建之前构建到该文件夹`main.dll`​​。但是，这更容易发生故障，并且需要更多的手动维护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T14:59:45.180

当你从 Debug 切换到 Release 时，Visual Studio 在输出的 bin 文件夹中从 Debug 切换到 Release。

将 main.dll 的“始终复制”属性设置为 true。这将确保它被复制到适当的输出文件夹，并始终被引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T15:00:59.267

`helper.dll`如果在同一解决方案中同时构建第二个库，则可以使用项目引用而不是直接引用 .dll。然后，您可以为 mode 设置解决方案级别的配置，并以这种方式`Release`在 mode 下构建两个项目。`Release`

# c# - 将数据发布到 asp.net Web API

> ID：15341744
> 
> 赞同：17
> 
> 时间：2013-03-11T14:57:51.240
> 
> 标签：c#, asp.net, http, asp.net-mvc-4, asp.net-web-api

我正在尝试找出新的 ASP.NET Web API。

到目前为止，我已经能够创建这个方法签名并很好地连接到它并获得有效的响应......

```
[HttpPost]
public HttpResponseMessage CreateAccount() 
```

我可以使用 fiddler 向此方法发送请求，并已验证它正在接收请求。

但是，当我尝试传递数据时，我遇到了问题。

我尝试的第一件事是...

```
[HttpPost]
public HttpResponseMessage CreateAccount([FromBody]string email, [FromBody]string password) 
```

我输入

电子邮件：xyz，密码：abc

进入提琴手的请求正文。当我这样做时，我得到一个 500 错误说明

'不能将多个参数（'email' 和 'password'）绑定到请求的内容。

我也试过这个作为方法签名......

```
[HttpPost]
public HttpResponseMessage CreateAccount([FromBody]UserAccountRequestData data) 
```

UserAccountRequestData 是一个简单的 POCO

```
public class UserAccountRequestData
{
    public string Email { get; set; }
    public string Password { get; set; }
} 
```

我把

{电子邮件：xyz，密码：abc}

或者

数据：{电子邮件：xyz，密码：abc}

进入请求的正文。在这两种尝试填充 POCO 的情况下，我都可以在调试时访问该方法，但数据对象始终为空。

我需要了解如何创建既能接受强类型 POCO 又能接受多种原始类型（如字符串和整数）的 API 方法。

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-11T15:08:05.997

您需要将`Content-Type`标头设置为`application/json`，然后提供有效的 JSON。

```
{"Email":"xyz","Password":"abc"} 
```

# sockets - 套接字连接在无线工具包中运行良好，但在我的诺基亚手机中没有

> ID：15341746
> 
> 赞同：3
> 
> 时间：2013-03-11T14:57:54.683
> 
> 标签：sockets, java-me, nokia

```
 wireless toolkit code 
```

//客户端移动的j2me代码

```
 public class TCPConnectSend extends MIDlet implements CommandListener {
    Display display;

    public TCPConnectSend0 () {
    frm = new Form ("TCPConnectSend0");
    sendCmd = new Command("Send",Command.SCREEN, 1);
    frm.addCommand(sendCmd);
    frm.setCommandListener(this);
    text = new TextField("text:","",40,TextField.ANY);
    frm.append(text);
    }
    public void startApp() {
    if(display==null) {
    display = Display.getDisplay (this);
    }
    display.setCurrent(frm);
    try {
    conn=(SocketConnection)Connector.open("socket://|ip-address|:80");//socket connection to the server

    outs=conn.openOutputStream();
    } catch(IOException e) { }
    }
    public void pauseApp() { }
    public void destroyApp(boolean unconditional) { }
    public void commandAction(Command c, Displayable s) {
    if(c==sendCmd) {
    try {
    outs.write((text.getString()+"\n").getBytes());
    } catch(IOException e) {}
    } else { }
    }
    }

    server code 
```

//这接收来自客户端的套接字请求

```
 class TCPServer
    {
       public static void main(String argv[]) throws Exception
          {
             try {
                ServerSocket server = new ServerSocket(80);
        System.out.println("ip address : "+InetAddress.getLocalHost());         
        System.out.println("waiting for connection");               
        Socket s1 = server.accept();
        System.out.println("connection established");
        BufferedReader br = new BufferedReader(new
InputStreamReader(s1.getInputStream()));    
            while (true) {
                String str1 = br.readLine();
            System.out.println("client says :" +str1);              
                if (str1.equals("quit"))
                        break;
                }
            } catch (Exception e) {
                e.printStackTrace();
            }
          }
    } 
```

//运行此代码后，我在诺基亚手机中遇到 java 安全异常任何其他端口号在诺基亚手机中没有响应

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-11T09:53:08.187

问题的发生是因为诺基亚阻止了其某些系统应用程序的 80 端口号，因此更改端口号和公共 IP 地址就可以了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-27T14:34:38.777

请注意，要使用特权端口（如 80、443、8080 以及通常低于 1000 的任何端口），您需要真实电话的代码签名证书（例如来自 Thawte）。

否则，仍然是更高的非特权端口，如 8000 等

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T11:52:46.957

您应该在客户端代码中添加服务器的公共 IP。

```
(SocketConnection)Connection.open( "socket://105.225.251.58" + ":" + "port" ); 
```

# jquery - 使用 jquery-validate.js 进行表单验证

> ID：15341747
> 
> 赞同：0
> 
> 时间：2013-03-11T14:58:04.203
> 
> 标签：jquery, jquery-validate

我有一个问题，我不知道我做错了什么，因为我遵循了几个示例，但没有一个有效，我没有收到任何错误，任何信号，什么都没有，也许有人可以帮助我

这是我的代码 HTML：

```
 <form id="contact" method="post" action="#">
                <fieldset>
                    <label for="name">NAME</label>
                    <input type="text" class="required input-xlarge" id="name-contact" name="name-contact" value="" placeholder="" minlength="2"> 
```

查询：

```
 $( "#contact" ).validate({
        rules: {
               "name-contact":{
                   required: true
               } 
       },
       messages: {
            "name-contact": {
                required: "Please, enter a name"
            }
       }

   }); 
```

这是我第二次尝试使用这个插件，因为它看起来很简单，它对我来说没有提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:49:53.153

**您发布的代码运行良好**，您可以在此处看到：

**[http://jsfiddle.net/NP8sS/](http://jsfiddle.net/NP8sS/)**

* * *

一些注释，但是只有第一项可以完全破坏事情：

* * *

**1)** 也许你忘了包含 jQuery 和/或 jQuery Validate 插件。查看“框架”和“外部资源”下的 jsFiddle 左侧面板。您是否收到任何 JavaScript 错误？

您应该有两行，按此顺序，其中`src`包含指向您放置这些文件的位置的正确 URL：

```
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="jquery.validate.js"></script> 
```

* * *

**2）** 您在两个地方指定了规则。您有`required`内部规则和元素内部`.validate()`的`minlength`规则。`name-contact`也许更一致并将它们放在一起：

[http://jsfiddle.net/NP8sS/1/](http://jsfiddle.net/NP8sS/1/)

```
rules: {
    "name-contact": {
        required: true,
        minlength: 2
     }
}, 
```

* * *

**3）**您的`for`属性`<label>`包含无效的`name`. 应该：

```
<label for="name-contact">NAME</label> 
```

* * *

**4)**你没有关闭你的`<form>`. 你需要`</form>`在最后加上一个标签。

# c# - 正则表达式解析嵌套标签？

> ID：15341750
> 
> 赞同：0
> 
> 时间：2013-03-11T14:58:20.850
> 
> 标签：c#, .net, regex

我有这样的文字：

```
This is {name1:value1}{name2:{name3:even dipper {name4:valu4} dipper} some inner text} text 
```

我想解析出这样的数据：

```
Name: name1
Value: value1

Name: name2
Value: {name3:even dipper {name4:valu4} dipper} some inner text 
```

然后我将递归处理每个值以解析出嵌套字段。你能推荐一个正则表达式来做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T19:52:43.040

在 C# 中，您可以使用[平衡组](http://msdn.microsoft.com/en-us/library/bs2twtah.aspx#balancing_group_definition)来计算和平衡括号：

```
{ (?'name' \w+ ) :       # start of tag
(?'value'                # named capture
  (?>                    # don't backtrack
    (?:
      [^{}]+             # not brackets
    | (?'open' { )       # count opening bracket
    | (?'close-open' } ) # subtract closing bracket (matches only if open count > 0)
    )*
  )
  (?(open)(?!))          # make sure open is not > 0
)
}                        # end of tag 
```

### [示例](http://ideone.com/016JMO)：

```
string re = @"(?x)       # enable eXtended mode (comments/spaces ignored)
{ (?'name' \w+ ) :       # start of tag
(?'value'                # named capture
  (?>                    # don't backtrack
    (?:
      [^{}]+             # not brackets
    | (?'open' { )       # count opening bracket
    | (?'close-open' } ) # subtract closing bracket (matches only if open count > 0)
    )*
  )
  (?(open)(?!))          # make sure open is not > 0
)
}                        # end of tag
";

string str = @"This is {name1:value1}{name2:{name3:even dipper {name4:valu4} dipper} some inner text} text";

foreach (Match m in Regex.Matches(str, re))
{
    Console.WriteLine("name: {0}, value: {1}", m.Groups["name"], m.Groups["value"]);
} 
```

输出：

```
name: name1, value: value1
name: name2, value: {name3:even dipper {name4:valu4} dipper} some inner text 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T15:47:28.560

如果使用 Perl/PHP/PCRE，它一点也不复杂。您可以使用如下表达式：

```
{(\w+):         # start of tag
   ((?:
      [^{}]+    # not a tag
   |  (?R)      # a tag (recurse to match the whole regex)
   )*)
}               # end of tag 
```

# python - 如何检查 matplotlib 的 pylab 后端是否内联运行？

> ID：15341757
> 
> 赞同：11
> 
> 时间：2013-03-11T14:58:46.283
> 
> 标签：python, matplotlib, ipython, ipython-notebook

我正在修改一个使用 matplotlib 绘制一些特殊图形的 python 模块。

现在，这个模块只是将所有图形保存为文件。

我想让在 ipython notebook 中工作时导入模块并查看结果“内联”成为可能案例。

所以我需要以某种方式检查模块是否已导入 ipython notebook 并且 pylab 是否内联运行。

我怎样才能检查这个？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-11T19:17:37.570

您可以使用以下命令检查 matplotlib 后端：

```
import matplotlib
matplotlib.get_backend() 
```

特别要检查内联 matplotlib：

```
mpl_is_inline = 'inline' in matplotlib.get_backend() 
```

请注意，使用 IPython 笔记本，无论活动的 matplotlib 后端如何，您*始终*可以显示内联图形，其中：

```
display(fig) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-07-24T06:13:03.383

试试呢：

```
try:
    cfg = get_ipython().config
    print('Called by IPython.')

    # Caution: cfg is an IPython.config.loader.Config
    if cfg['IPKernelApp']:
        print('Within IPython QtConsole.')

        try:
            if cfg['IPKernelApp']['pylab'] == 'inline':
                print('inline pylab loaded.')
            else:
                print('pylab loaded, but not in inline mode.')
        except:
            print('pylab not loaded.')
    elif cfg['TerminalIPythonApp']:
        try:
            if cfg['TerminalIPythonApp']['pylab'] == 'inline':
                print('inline pylab loaded.')
            else:
                print('pylab loaded, but not in inline mode.')
        except:
            print('pylab not loaded.')
except:
    print('Not called by IPython.') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-11T17:49:01.727

这让我开始搜索，我想我已经找到了解决方案。不确定这是否实际记录或什至是有意的，但它可能非常有效：

```
get_ipython().config['IPKernelApp']['pylab'] == 'inline' 
```

`get_ipython()`似乎是仅在运行 IPython 时定义的方法；它返回我假设的当前 IPython 会话。然后，您可以访问`config`包含“IPKernelApp”元素的字典属性。后者本身就是一个字典，可以包含一个键`pylab`，它可以是字符串`'inline'`。

我没有广泛尝试，但我猜如果你没有运行 pylab 内联，上面的代码行将评估为 False。

更重要的是，当您不运行笔记本或 pylab 选项时，它会引发 KeyError，因此您需要捕捉到该异常并将引发的异常视为“否”以运行带有 pylab 内联的笔记本。

最后，`get_ipython()`可能会抛出一个`NameError`，和上面类似，这当然也意味着你没有运行 IPython。

我只对此进行了最低限度的测试，但将其导入我的 IPython 笔记本，然后在默认的 Python cmdline 上确实显示它可以工作。

让我们知道这是否适合您。

# python - 如何确定 PyTables 数组的大小（以字节为单位）？

> ID：15341762
> 
> 赞同：0
> 
> 时间：2013-03-11T14:58:56.990
> 
> 标签：python, scientific-computing, pytables

如何确定 PyTables 数组的大小（以字节为单位）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T19:36:33.203

事实证明，由于所有 PyTables 数组都只是下面的 Numpy 数组，因此您可以执行以下操作：

MyPytableFile.root.myPytableArray[:].nbytes

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:41:19.583

它不是直截了当的，但您可以做的一件事是腌制对象，然后确定序列化对象的大小。看到[这个帖子](https://stackoverflow.com/questions/563840/how-can-i-check-the-memory-usage-of-objects-in-ipython/565382#565382)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T12:14:47.770

为什么不

```
arrSizeInBytes = arr.nrows * arr.rowsize 
```

至少等于结果

```
./h5ls -r -v pytables.db | grep "Dataset\|Storage" 
```

# jquery - IE8 无法使用 jquery 1.9 获得正确的图像宽度

> ID：15341765
> 
> 赞同：0
> 
> 时间：2013-03-11T14:58:59.150
> 
> 标签：jquery, internet-explorer

我得到了一个简单的 html/jquery 幻灯片，在所有主流浏览器中都能完美运行，但在 IE8 中却不行

有问题的图像具有内联宽度和高度以及流动的 css： `img{border-style: none;width: auto;height: auto;padding:0;margin:0;}`

使用 jquery 我正在尝试使用以下方法获取 img 宽度：

```
this.img_list = $('.sponsoren_img');
this.theWidth = this.img_list.width(); 
```

保存这个动作的函数是 trigger with`$().ready(function() {...});`

在 IE9,FF en chrome 中，它获得图像的正确宽度，即 140。ie8 认为它的 136

这里发生了什么？

对于那些想要观看实际幻灯片的人，请访问：[www.elementalworks.nl/KPJOD](http://www.elementalworks.nl/KPJOD) 它是 Welkom 框旁边的框。

# php - 使用 YYYY MM DD 格式的 PHP 计算年龄

> ID：15341767
> 
> 赞同：2
> 
> 时间：2013-03-11T14:59:11.813
> 
> 标签：php

我正在尝试获取此代码以从表单中的字段计算年龄。

```
<?php
   $birthDate = "$dob";

   $birthDate = explode("-", $birthDate);

   $age = (date("md", date("U", mktime(0, 0, 0, $birthDate[0], $birthDate[1], $birthDate[2]))) > date("md") ? ((date("Y")-$birthDate[2])-1):(date("Y")-$birthDate[2]));
   echo "Age is: ".$age;
?> 
```

但我无法让它使用输入字段的格式，即 YYYY-MM-DD。

如果我将 $dob 更改为 PHP 使用的欧盟标准格式的日期，它就像一个魅力。

有没有一些简单的方法来纠正这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:05:57.940

始终注意日期符号（即年、月和日的顺序）。

这是有效的（改编的原始代码）：

```
<?php
$birthDate = "1984-05-21";

$birthDate = explode("-", $birthDate);

$age = (date("md", date("U", mktime(0, 0, 0, $birthDate[2], $birthDate[1], $birthDate[0]))) > date("md") ? ((date("Y")-$birthDate[0])-1):(date("Y")-$birthDate[0]));
echo "Age is: ".$age;
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:03:32.917

使用[`DateTime::diff`](http://www.php.net/manual/en/datetime.diff.php)功能

**例子**

```
<?php
$datetime1 = new DateTime('2009-10-11');
$datetime2 = new DateTime('2013-10-13');
$interval = $datetime1->diff($datetime2);
echo $interval->format('%R%y years');
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T15:04:11.183

用于`strtotime($dob)`获取时间戳。然后以人类的方式计算年龄：

```
list($dob_year, $dob_date) = explode('-', date('Y-md', strtotime($dob)));
list($cur_year, $cur_date) = explode('-', date('Y-md'));

$age = $cur_year - $dob_year - ($dob_date >= $cur_date ? 0 : 1); 
```

# c# - 循环抛出异常不能将 Null 转换为 String

> ID：15341768
> 
> 赞同：1
> 
> 时间：2013-03-11T14:59:13.427
> 
> 标签：c#, linq

我在我继承的代码中发现了这一点，事实上它是 Linq 而我以前没有 Linq-ed。我看过一些例子，但我想这不是 100% Linq 问题，但也许是。

我有这个构造：

`var categories = dtResults.AsEnumerable().Select(r => r["Cat"]).Distinct().ToList();`

将 400 个类别指示符作为字符串返回。`dtResults`是`DataTable`从查询中获取其数据的。

接下来，我循环遍历`categories`第一次迭代时出现`Unable to cast object of type 'System.DBNull' to type 'System.String'.`错误，因为`category`索引 0 在循环中为空：`foreach(string category in categories)`。

我无法更改数据，但可以插入空格，但我该怎么做呢？

**更新** @flup请求的循环：

```
foreach (string category in categories)
    {
        for (int i = 0; i < WucEntries2.Length; i++)
        {
            drOutput = dtOutput.NewRow();
            drOutput["Category"] = category;
            drOutput["SubCategory "] = subCategories[i];

            drResults = dtResults.Select(String.Format("Category = '{0}' AND SubCategory = '{1}'", category, subCategories[i]));
            if (drResults.Length > 0)
            {
                foreach (DataColumn column in dtResults.Columns)
                {
                    drOutput[column.ColumnName] = drResults[0][column.ColumnName];
                }
            }
            dtOutput.Rows.Add(drOutput);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:06:39.467

你不能投到`DBNull`，`string`但你可以投到`null`，`string`所以也许：

```
var categories = dtResults.AsEnumerable()
    .Select(r => r["Cat"] == DBNull.Value ? (string)null : r["Cat"].ToString())
    .Distinct()
    .ToList(); 
```

这也会使您的列表 a`List<string>`而不是`List<object>`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:02:29.537

也许你可以试试：

```
var categories = dtResults.AsEnumerable().Select(r => Convert.ToString(r["Cat"]))
                                         .Distinct()
                                         .ToList(); 
```

希望这会有所帮助

# wso2 - 构建仪表板

> ID：15341769
> 
> 赞同：0
> 
> 时间：2013-03-11T14:59:15.687
> 
> 标签：wso2, wso2carbon

是否有针对不同 carbon/wso2 版本的构建仪表板？

我刚刚检查了碳的 4.0.3 标签（[https://svn.wso2.org/repos/wso2/carbon/platform/tags/4.0.3](https://svn.wso2.org/repos/wso2/carbon/platform/tags/4.0.3)）

我假设标签是稳定的。但是构建失败并出现以下错误

```
The project org.wso2.carbon:SecVerifier:4.0.0
(/wso2/4.0.3/products/integration/security-verifier/pom.xml) has 1 error 
[ERROR]     Non-resolvable parent POM: Failure to find
org.wso2.carbon:integration:pom:4.0.0 in http://people.apache.org/repo/m2-incubating
repository was cached in the local repository, resolution will not be reattempted until
the update interval of apache-incubating has elapsed or updates are forced and
'parent.relativePath' points at wrong local POM @ line 22, column 13 -> [Help 2] 
```

这些标签稳定吗？我正在使用 Maven 3.0.5 和 Java 1.6

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T03:51:42.183

WSO2 构建状态仪表板也可以通过[持续构建找到，Bamboo](http://wso2.org/bamboo)。

如果您尝试在已发布的分支上构建某些东西，最简单的方法是仅构建该组件，至于已发布的版本，我们已经发布了带有构建工件的 maven 存储库。

# c# - 在 PCL 中使用 HtmlAgilityPack 或替代方案的 HTML Linq

> ID：15341774
> 
> 赞同：22
> 
> 时间：2013-03-11T14:59:26.210
> 
> 标签：c#, .net, windows-phone-8, html-agility-pack, portable-class-library

我在 .NET 4 上编写了一个项目，目前正在允许它在 Windows Phone 上运行。我正在使用 HtmlAgilityPack，这是一个众所周知的库，它允许通过 HTML 进行 Linq 查询，并且只使用它提供的*LoadHtml*和*Linq*接口。

将类库从 .NET 4 转换为支持 .NET 4 和 WP8 的 PCL（便携式类库）后，我似乎无法再使用 HtmlAgilityPack 库了。**有没有办法让 HtmlAgilityPack 在 PCL 项目下正常运行，或者是否有一个具有类似 Linq 接口的变量替代方案可以按预期工作？**

**编辑**：HtmlAgilityPack 提供 9 个不同的版本，没有一个与 PCL 兼容。它们都没有解决引用中的依赖关系。对于某些版本，它可能看起来确实如此，但在使用时会抛出一个错误，通常是“无法加载，未解决的依赖项”。

**编辑#2**由于很容易错过一个小评论，我会用我想出的解决方案更新这个答案。我提取了基本功能所需的内容，并实现了缺失的组件以使一切正常工作。结果在这里[https://github.com/Deathspike/HtmlAgilityPack-PCL](https://github.com/Deathspike/HtmlAgilityPack-PCL)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T00:19:58.740

一种选择是将 HTML Agility Pack 源代码移植到 PCL。您可以在其上运行[PCL 合规性分析器](https://github.com/object/PclAnalyzer)，以了解这将有多难。

或者，使用抽象模式。为您需要的功能（即`LoadHtml`和`Linq`）创建一个可移植接口，然后通过调用 HTML Agility Pack 为每个平台实现该接口。然后，您的可移植代码可以依赖于特定于平台的实现。

有关更多信息，请参阅此博客文章：[如何使可移植类库为您工作](http://blogs.msdn.com/b/dsplaisted/archive/2012/08/27/how-to-make-portable-class-libraries-work-for-you.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-11T21:12:57.540

你已经提出并回答了你自己的问题——不是吗？

HtmlAgilityPack 不支持与可移植类库一起使用。

充其量，您需要考虑移植/迁移您需要的特定功能，使其适用于您正在使用的平台。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-12T12:01:18.620

查看[HtmlParserSharp](https://github.com/jamietre/HtmlParserSharp)，这是[validator.nu HTML5 parser](http://about.validator.nu/htmlparser/)的 C# 端口。该项目应该很容易构建为 PCL 库，因为它或多或少是一个直接的 C++ 端口，并且仅使用最基本的 .NET 框架类，并进行了一些更新以提高 C# 的性能。

虽然我对 HtmlParserSharp 所做的大部分工作都是针对[CsQuery](http://github.com/jamietre/csquery)，它本身距离 PCL 兼容还有很长的路要走，但完全没有理由认为 HtmlParserSharp 作为一个精益的 HTML 解析器不能完美地为您的目的。该项目包含一个基于 构建 DOM 的示例`XmlElement`，但树构建器是一种抽象，因此您可以轻松地将其更改为使用您自己的树节点对象。

# c# - Console.WriteLine 到 Response.Write？

> ID：15341776
> 
> 赞同：3
> 
> 时间：2013-03-11T14:59:30.783
> 
> 标签：c#, .net, webforms

我在一个 WebForm 中，我想使用这种格式的通用 Console.Writeline：

```
Console.WriteLine("{0}{1}:", myString, myProp); 
```

使用 Response.Write（将代码放在客户端）。我可以吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T15:02:59.047

在这种情况下使用 of`Console.WriteLine("{0}{1}:", myString, myProp);`没有意义，但您可以使用以下[`string.Format()`](http://msdn.microsoft.com/en-gb/library/system.string.format.aspx)方法：

```
Response.Write(string.Format("{0}{1}:", myString, myProp)); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-11T15:04:55.993

您可以编写一个方法，例如

```
public static void WriteToResponse(string format, params object[] args)
{
    Response.Write(String.Format(format, args));
} 
```

上面的方法`Console`相当于`Console.Write`你可以添加一个额外`Response.Write(Environment.NewLine)`的，使其类似于`Console.WriteLine`

```
public static void WriteLineToResponse(string format, params object[] args)
{
    Response.Write(String.Format(format, args));
    Response.Write(Environment.NewLine);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T15:03:45.893

您可以使用：

```
Response.Write (string.Format("{0}{1}:", myString, myProp)); 
```

或者为 Response.Write 创建一个扩展方法，使用字符串、object[] 作为参数。

# sql - 防止来自非特权用户的 SQL 查询阻塞关键进程

> ID：15341779
> 
> 赞同：1
> 
> 时间：2013-03-11T14:59:35.027
> 
> 标签：sql, sql-server, tsql, sql-server-2012, resource-governor

我有一个系统，允许用户登录并构建查询以针对 SQL 2012 服务器运行。系统需要在允许的查询方面非常自由，所以我只是依靠 SQL 授权来防止用户做他们不应该做的事情。

我担心仍然会发生[优先级倒置之类的事情。](http://en.wikipedia.org/wiki/Priority_inversion)假设一个非特权用户登录，找到一个要滥用的表并在其上运行十几个外部连接。或者只是开始一个事务并且从不关闭它。

我想确保非特权用户无法阻止更多特权用户的关键进程。我正在考虑使用[资源管理](http://msdn.microsoft.com/en-us/library/bb933866.aspx)器来执行此操作，但我不确定这是否是我可能需要担心的其他问题的最佳方式。

确保来自非特权用户的查询不会阻塞关键进程的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:27:29.373

资源调控器只能限制任意用户的资源（内存、CPU）。它不能防止优先级倒置，如果发生优先级倒置，资源管理器只会使其持续更长时间。

如果用户可能导致阻塞，那么您必须将用户移动到安全的游乐场（例如备用副本），或者您必须[主动监控阻塞](https://stackoverflow.com/questions/14833204/ms-sql-server-third-party-transaction-blocking-monitor-tools/14834770#14834770)。没有太大的回旋余地。*如果*这些用户只做 R/O 操作，那么你可以尝试使用快照隔离来避免阻塞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:21:41.757

我们遇到了类似的要求，最终转向我们的故障转移 SQL Server 2008 机器上的数据库快照，以供非特权用户使用。这给了我们一些优先级隔离，让我们能够更好地利用我们的故障转移硬件。

现在我们使用的是 SQL Server 2012，我们正在研究 AlwaysOn。它并不完美，但如果您有 HA 环境，则值得考虑。此页面底部提供 AlwaysOn 白皮书：http: [//www.microsoft.com/en-us/sqlserver/solutions-technologies/mission-critical-operations/high-availability.aspx](http://www.microsoft.com/en-us/sqlserver/solutions-technologies/mission-critical-operations/high-availability.aspx)。

# c# - 如何定义多个值映射到单个标签的枚举？

> ID：15341780
> 
> 赞同：9
> 
> 时间：2013-03-11T14:59:36.430
> 
> 标签：c#, .net, enums, bitflags

假设，为了这个例子，我试图解析一个文件，该文件指定记录中的两个任意字节代表一周中的哪一天，因此：

```
DayOfWeek:

 - 0    = Monday
 - 1    = Tuesday
 - 2    = Wednesday
 - 3    = Thursday
 - 4    = Friday
 - 5    = Saturday
 - 6    = Sunday
 - 7-15 = Reserved for Future Use 
```

我可以定义一个枚举来映射到这个字段，因此：

```
public enum DaysOfWeek
{
     Monday = 0,
     Tuesday = 1,
     Wednesday = 2,
     Thursday = 3,
     Friday = 4,
     Saturday = 5,
     Sunday = 6
     ReservedForFutureUse
} 
```

但是我如何定义有效值`ReservedForFutureUse`呢？理想情况下，我想做类似的事情：

```
public enum DaysOfWeek
    {
         Monday = 0,
         Tuesday = 1,
         Wednesday = 2,
         Thursday = 3,
         Friday = 4,
         Saturday = 5,
         Sunday = 6
         ReservedForFutureUse = {7,8,9,10,11,12,13,14,15}
    } 
```

这个问题只会随着更复杂的领域而加剧；例如，假设在这种情况下，7 和 8 都映射到相同的错误情况或其他东西。如何在 C# 枚举中捕获这一要求？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T15:27:32.707

枚举的一个有趣的怪癖是定义为某种枚举类型的变量可以保存该枚举的任何成员未定义的值：

```
public enum DaysOfWeek
{
     Monday = 0,
     Tuesday = 1,
     Wednesday = 2,
     Thursday = 3,
     Friday = 4,
     Saturday = 5,
     Sunday = 6
}

// in other code
DaysOfWeek someDay = (DaysOfWeek)42; // this is perfectly legal 
```

这意味着您实际上不需要定义所有可能出现的值，而只需指定那些对您的代码有意义的值。然后你可以使用一些“catch-all” `if`- 或`switch`-block 来处理未定义的值：

```
switch (someDay)
{
    case DaysOfWeek.Monday:
    {
        // do monday stuff
        break;
    }
    case DaysOfWeek.Tuesday:
    {
        // do tuesday stuff
        break;
    }
    // [...] handle the other weekdays [...]
    default:
    {
        // handle undefined values here
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T15:02:01.483

尽管一个给定的基础价值可以映射到多个`enum`值，但一个`enum`值可以只有一个基础价值。

你可以这样做

```
public enum DaysOfWeek
{
     Monday = 0,
     Tuesday = 1,
     Wednesday = 2,
     Thursday = 3,
     Friday = 4,
     Saturday = 5,
     Sunday = 6
     Reserved1 = 7
     ...
     Reserved8 = 15
} 
```

# sql - 将单独的字段连接到日期

> ID：15341782
> 
> 赞同：-1
> 
> 时间：2013-03-11T14:59:38.777
> 
> 标签：sql, ms-access

您如何在此查询中连接？

SQL

```
SELECT
  eventscheduling.eventID,
  event.eventName,
  event.description,
  sponsorCLUB.Organization,
  department.Dname,
  eventscheduling.smonth,
  eventscheduling.sdate, 
  eventscheduling.syear,
  eventscheduling.tHour,
  eventscheduling.tMinute,
  eventscheduling.tAmPm, 
  eventscheduling.venue,
  eventscheduling.representative 
FROM eventscheduling, event, department, sponsorCLUB
WHERE event.eventID=eventscheduling.eventID and 
  sponsorCLUB.sponsorID=eventscheduling.sponsorID and
  department.DeptID=sponsorCLUB.DeptID and 
  eventscheduling.eventID='"+txtsearch.getText()+"'"; 
```

代码

```
String sql="select eventscheduling.eventID, event.eventName, event.description,
 sponsorCLUB.Organization, department.Dname, eventscheduling.smonth, eventscheduling.sdate, 
eventscheduling.syear, eventscheduling.tHour, eventscheduling.tMinute, eventscheduling.tAmPm, 
eventscheduling.venue, eventscheduling.representative from eventscheduling, event, department, 
sponsorCLUB where event.eventID=eventscheduling.eventID and 
sponsorCLUB.sponsorID=eventscheduling.sponsorID and department.DeptID=sponsorCLUB.DeptID and 
eventscheduling.eventID='"+txtsearch.getText()+"'"; 
```

我想`smonth`,`sdate`和`syear`合并成一个日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:35:56.930

DateSerial 可用于从组成部分创建单个日期 -
[http://www.techonthenet.com/access/functions/date/dateserial.php](http://www.techonthenet.com/access/functions/date/dateserial.php)

```
SELECT
  DateSerial(eventscheduling.syear,
             eventscheduling.smonth,
             eventscheduling.sdate) as eventschedulingdate 
```

顺便说一句，通过允许将用户输入直接添加到 SQL 查询中，您有一个 SQL 注入漏洞。

# xpages - 不能在 XPINC 中调用 XSP 函数

> ID：15341783
> 
> 赞同：1
> 
> 时间：2013-03-11T14:59:40.647
> 
> 标签：xpages, lotus-notes, xpinc

我尝试调用`XSP._isDirty()`XPINC，但它不起作用。在浏览器中一切正常。有一个技巧我可以如何使用它。

当我在 Notesclient 中执行 XPages 时，有没有办法可以看到客户端错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T17:22:37.570

这里有两个问题。

## Q1。XSP._isDirty()

XSP._isDirty() 是一个内部调用。来自 XPages 便携式命令指南（第 156 页）。

> XSP._isDirty() ：由脏保存功能在内部使用 - 请`<xp:view>`参阅`enableModifiedFlag`. 这是一个私人功能。

此调用的代码在文件中`xspClientDojo.js`（在 Domino/Notes 上查找未压缩的文件）。

由于它是内部调用，因此使用风险很大。不能保证它会在以后的版本中按预期工作。

这`enableModifiedFlag`是一个 XPage 属性，允许您将页面标记为脏页并防止用户意外离开页面。[在Infocenter](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.designer.domino.ui.doc/wpd_controls_pref_enablemodifiedflag.html)上有更多关于此的详细信息。

## Q2。客户端调试。

[您可以使用大多数现代浏览器的开发人员面板或类似firebug 插件](http://getfirebug.com)的工具来查看客户端错误。XPages 扩展库附带一个您也可以使用的[Firebug Lite](http://www.openntf.org/blogs/openntf.nsf/d6plinks/NHEF-8GS9DC)组件。

对于 SSJS 和 XSP 引擎问题，您可以通过阅读 Notes 数据文件夹中 IBM_TECHNICAL_SUPPORT 文件夹中的 XPages 日志在 Notes 客户端中查看这些问题。

对于这种“实时”方法是修改启动笔记的快捷方式，如下所示：

```
Target: C:\Lotus\Notes\notes.exe -RPARAMS -console -debug -separateSysLogFiles -consoleLog
Start In : C:\Lotus\Notes\framework\ 
```

更改路径以匹配您的客户端安装。

# web-services - webrequest.create(URL) 处的 NULL 引用异常

> ID：15341785
> 
> 赞同：2
> 
> 时间：2013-03-11T14:59:43.903
> 
> 标签：web-services

我在该行中得到一个空引用异常`webrequest.create(v_strURL)`

```
Dim objHttpWebRequest As HttpWebRequest
        Dim objHttpWebResponse As HttpWebResponse
        Dim objRequestStream As Stream = Nothing
        Dim objResponseStream As Stream = Nothing

        Dim objXMLReader As XmlTextReader

        objHttpWebRequest = CType((WebRequest.Create(v_strURL)), HttpWebRequest) ''This line throws exception. 
```

这`Url`是正确的，并且确实给出了正确的响应。

# api - REST api，具有关系的 POST 实体？

> ID：15341788
> 
> 赞同：9
> 
> 时间：2013-03-11T14:59:47.550
> 
> 标签：api, rest, asp.net-web-api, relationship

我有一个问题，我无法决定如何处理这个问题.. 我需要知道是否有任何标准方法可以解决这个问题.. 或者你们是否对这个问题有任何很好的意见。

问题是我已经开始构建一个非常基本的 API 用于学习目的。API 是一个简单的音乐商店.. 商店有一些专辑需要和艺术家。

因此，关系是艺术家 <--- 1 ----- * ---> 专辑，并且要存在专辑，就需要专辑有艺术家。但艺术家不需要和专辑。

现在问题...

由于这种关系，如果我想创建一个新专辑..我将不得不发布专辑数据..以及整个 Arist 数据..不仅仅是艺术家的 ID..而是整个艺术家..这似乎不是如果你问我，非常有效..因为这有很多不必要的。

所以正如我所看到的，有两种方法可以解决这个问题......要么我只发布整个专辑数据/对象，并允许对象的艺术家数据只包含一个 ID，然后引用艺术家。

所以不要发布：

```
{
"Name":"AlbumName",
"Description":"Some description for the album",
"ReleaseYear": "1992",
"Artist" {
    "Name":"Some artist",
    "Id":"12345",
    "Biography":"Lorem ipsum dolor sit amet"
    }
} 
```

我会这样做：

```
{
    "Name":"AlbumName",
    "Description":"Some description for the album",
    "ReleaseYear": "1992",
    "Artist" {
        "Id":"12345"
        }
    } 
```

选项二是实际上有一个特定于此的路由/ URL ...例如： /api/artist/{artistid}/album 然后只需将专辑对象发布到该 URL ..

但正如我所说..我真的不确定这里是对是错..或者是否有任何标准的处理方式？

提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T15:14:18.313

我会建议这样的事情。

```
POST /musicstore/artist/343/albums

{
    "Name":"AlbumName",
    "Description":"Some description for the album",
    "ReleaseYear": "1992",
} 
```

为艺术家343创建作为专辑集合的子资源的行为隐含地创建了艺术家和专辑之间的关系。无需在有效负载中指定它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-07T10:29:41.160

专辑和艺术家是两个独立的实体，您不应将所有艺术家数据发布到专辑中，只发布其 ID。因此，如果艺术家不存在，则首先创建它，然后发布专辑详细信息，artist_id 是其属性之一。

# ios - iPhone的“跳板”视图到底是什么？

> ID：15341799
> 
> 赞同：2
> 
> 时间：2013-03-11T15:00:16.140
> 
> 标签：ios, uicollectionview, ios-universal-app, springboard

我的问题是，默认的 iPhone 菜单是使用故事板创建的 UIcollection 视图，还是有更多功能？（为了避免模仿其功能）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T18:20:20.963

如果你想了解 SpringBoard 的视图层次结构：

1.  如果 iOS 模拟器尚未运行，请启动它。
2.  确保您在模拟器中查看 SpringBoard。
3.  在 Xcode 中，选择 Product > Attach to Process > springboard。跳板过程位于列表的“系统”部分。
4.  仍然在 Xcode 中，选择 Product > Debug > Pause。
5.  在 Xcode 的调试控制台（应该显示`(lldb)`提示的地方），输入`po [[UIApp keyWindow] recursiveDescription]`.

瞧，你得到了 SpringBoard 的整个屏幕视图层次结构的打印输出。我的开始是这样的：

```
(lldb) po [[UIApp keyWindow] recursiveDescription]
$0 = 0x0b63abf0 <SBAppWindow: 0xce3ef10; baseClass = UIWindow; frame = (0 0; 320 480); layer = <UIWindowLayer: 0xce3f010>>
   | <SBUIRootView: 0xb162de0; frame = (0 0; 320 480); layer = <CALayer: 0xb162e60>>
   |    | <UIView: 0xb163010; frame = (0 0; 320 480); autoresize = W+H; layer = <CALayer: 0xb1630c0>>
   |    |    | <SBWallpaperView: 0xb1632a0; baseClass = UIImageView; frame = (0 0; 320 480); userInteractionEnabled = NO; layer = <CALayer: 0xb160f70>>
   |    |    |    | <UIImageView: 0xb1610d0; frame = (0 0; 0 0); hidden = YES; userInteractionEnabled = NO; layer = <CALayer: 0xb161130>>
   |    |    |    | <UIImageView: 0xb161160; frame = (0 0; 0 0); hidden = YES; userInteractionEnabled = NO; layer = <CALayer: 0xb163390>>
   |    |    | <SBIconContentView: 0xb163da0; frame = (0 0; 320 480); clipsToBounds = YES; autoresize = W+H; layer = <CALayer: 0xb163e50>>
   |    |    |    | <UIView: 0xc939710; frame = (0 371; 320 109); opaque = NO; autoresize = W+TM; layer = <CALayer: 0xc939770>>
   |    |    |    |    | <SBDockIconListView: 0xc9381d0; frame = (0 20; 320 89); autoresize = TM; layer = <CALayer: 0xc9382c0>>
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:25:20.550

[来自Springboard](http://en.wikipedia.org/wiki/SpringBoard)上的维基百科文章：

**Springboard**或**Home Screen**是管理 iOS 主屏幕的标准应用程序。其他任务包括启动 WindowServer、启动和引导应用程序以及在启动时设置一些设备的设置。

# javascript - mysql查询后如何在ajax中获取Json数据

> ID：15341801
> 
> 赞同：0
> 
> 时间：2013-03-11T15:00:22.263
> 
> 标签：javascript, ajax, json

对于我的书店，我开始构建一个收银台脚本。这是一个非常简单的表单，带有 ajax 动态搜索。这是本地 PC 的脚本，因此该脚本不会在网络上发布。

当我扫描 EAN 代码时，我的表单填写了标题、作者、编辑和价格。这本书已准备好添加到篮子中。

现在我试图在这个脚本中引入 Json：但我不明白如何在脚本中获取 mysql 查询的值，并将它们放在我的 cashdesk 表单的正确字段中。

我已经测试了 Mysql 查询和 Json。

查询

```
<?php
header('Content-Type: text/html; charset=ISO-8859-1');

include('connexion.php');
$connect_db = connect();

$i = 0;
$tmp = array();

$fetch = mysql_query("SELECT jos_vm_product.product_id,product_name,product_author,product_editor,jos_vm_product_price.product_price FROM jos_vm_product INNER JOIN jos_vm_product_price ON (jos_vm_product.product_id = jos_vm_product_price.product_id) WHERE product_EAN = '$_POST[EAN]'");

while ($row = mysql_fetch_array($fetch, MYSQL_ASSOC)) {
$tmp[$i] = $row;
}
echo json_encode($tmp);

close();
?> 
```

一个json示例：

```
[{"product_id":"7097","product_name":"Paix pour tous - Livre audio","product_author":"Wayne W. Dyer","product_editor":"Ada","product_price":"20.28"}] 
```

ajax 脚本

```
var xhr = null;
  function getXhr()
  {
  if(window.XMLHttpRequest) xhr = new XMLHttpRequest();
  else if(window.ActiveXObject)
  {
  try
  {
  xhr = new ActiveXObject("Msxml2.XMLHTTP");
  }
  catch (e)
  {
  xhr = new ActiveXObject("Microsoft.XMLHTTP");
}
}
else
{
alert("Not Working");
xhr = false;
}
}

function ajaxEAN()
{
getXhr();
xhr.onreadystatechange = function()
{
if(xhr.readyState == 4 && xhr.status == 200)
{

var data = '{"product_id": "product_id", "product_name":"product_name", "product_author":"product_author", "product_editor":"product_editor", "product_price":"product_price"}';

oData = JSON.parse( data);
for( var i in oData){
document.getElementById( i).value = oData[i];
}

}
}
xhr.open("POST",'ajaxrecupaddr.php',true);
xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
EAN = document.getElementById("EAN").value;
xhr.send("EAN="+EAN);
} 
```

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:12:05.747

据了解，您根本无法从响应中获取 JSON。如果是这样，那么您应该这样做：

```
xhr.onreadystatechange = function()
{
   if(xhr.readyState == 4 && xhr.status == 200) {        
     oData = JSON.parse(xhr.responseText);
     for(var i = 0; i < oData.length; i++) {
         for( var key in oData[i]){
            document.getElementById(key).value = oData[i][key];
         }    
     }
} 
```

在那里，`xhr.responseText`将返回一个带有从服务器接收到的 JSON 的字符串。

另外，一些注意事项：而不是

```
header('Content-Type: text/html; charset=ISO-8859-1'); 
```

你应该更好地使用：

```
header('Content-Type: application/json;'); 
```

此外，在下面的行中，您可以使用 SQL 注入：

```
$fetch = mysql_query("SELECT jos_vm_product.product_id,product_name,product_author,product_editor,jos_vm_product_price.product_price FROM jos_vm_product INNER JOIN jos_vm_product_price ON (jos_vm_product.product_id = jos_vm_product_price.product_id) WHERE product_EAN = '$_POST[EAN]'"); 
```

而不是简单地做`WHERE product_EAN = '$_POST[EAN]'`你应该做的，至少，`WHERE product_EAN = '".mysql_real_esape_string($_POST["EAN"]) . "'`：

```
$fetch = mysql_query("SELECT jos_vm_product.product_id,product_name,product_author,product_editor,jos_vm_product_price.product_price FROM jos_vm_product INNER JOIN jos_vm_product_price ON (jos_vm_product.product_id = jos_vm_product_price.product_id) WHERE product_EAN = '".mysql_real_esape_string($_POST["EAN"]) . "'"); 
```

查看更多关于[`mysql_real_escape_string`](http://php.net/manual/en/function.mysql-real-escape-string.php). `'`当您在 EAN 中有符号时，它将正确地转义所有潜在的危险符号并避免您出错。另外，请阅读上面链接的页面上显示的警告。您应该更好地更改数据库扩展，因为不推荐使用 MySQL 扩展。

# jquery - 我怎样才能使这个简单的代码更有效？

> ID：15341806
> 
> 赞同：0
> 
> 时间：2013-03-11T15:00:43.417
> 
> 标签：jquery

总的来说，我是编程新手，而且由于我是完全自学的，所以我缺乏一些编程的基础知识。这是我编写的一些简单的 jQuery，以确保网站的包装延伸到页脚的开头，即使没有足够的内容：

```
$(window).resize(function() {
    var footerHeight = 147;
    var windowHeight = $(window).height();
    var properHeight = windowHeight - footerHeight;
    $('#main').height(properHeight);
}); 
```

我定义了页脚的高度。然后我得到视口的高度。然后我从视口减去页脚的高度。然后我将该高度应用于`#main`元素。我知道我可以使用 jQuery 来获取页脚的高度，但是我遇到了问题并且由于某种原因它不能正常工作。

我之前重复了代码，但在`$('window').resize()`函数之外，因此它在页面加载时运行一次。

我觉得我可以把它变成一个函数，因为它重复了两次。另外，我在这里询问的主要原因是，如果我在几秒钟内快速调整浏览器的大小，我的浏览器会因为这段代码而占用 CPU。

抱歉，如果这不是要问的正确网站。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:04:43.570

您可以`resize`在绑定事件处理程序后以编程方式触发窗口上的事件：

```
$(window).resize(function() {
    // your code here
}).resize(); 
```

这样可以节省您在触发`// your code here`实际事件之前复制函数外部的部分以执行此操作。`resize`

您提到的 CPU 问题可能与函数内部的实际代码关系不大（这相对微不足道），而与`resize`触发的事件数量有关。取自[jQuery 文档`.resize()`](http://api.jquery.com/resize/)：

> 调整大小处理程序中的代码不应依赖于调用处理程序的次数。根据实现，调整大小事件可以在调整大小进行时连续发送（Internet Explorer 和基于 WebKit 的浏览器，如 Safari 和 Chrome 中的典型行为），或者仅在调整大小操作结束时发送一次（典型行为在其他一些浏览器，例如 Opera）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:06:18.640

在调整大小时防止它吃掉你的 cpu 的一种方法是让它只在调整大小结束时发生，比如：

```
function afterResize()
{
    var footerHeight = 147;
    var windowHeight = $(window).height();
    var properHeight = windowHeight - footerHeight;
    $('#main').height(properHeight);
}

var timeout = null;
$(window).resize(function() 
{
    clearTimeout(timeout);
    timeout = setTimeout(function(){ afterResize(); }, 100);    
}); 
```

这是一个 jsfiddle [http://jsfiddle.net/RxRcQ/1/](http://jsfiddle.net/RxRcQ/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T15:18:55.267

您所做的很好，因为您需要在 window.resize() 事件中明确调用它，因为这会导致视口发生变化。

正如许多人所建议的那样，手动触发调整大小事件是有益的。

为了增强算法，您可能可以使用更少的变量。如下所示。

```
 var postResize;
    $(window).resize(function() {
            clearTimeout(postResize);
            postResize = setTimeout(function() {
                    var footerHeight = 147;
                    $("#main").height($(window).height() - footerHeight);
            }, 100);
    }).resize(); 
```

上述算法增加了性能增强：在用户停止调整窗口大小 100 毫秒之前，它不会进行视口计算。当您将窗口大小调整 400-500 像素（例如）时，这使得函数仅调用一次（而不是 400-500 次调用）。

希望这可以帮助 ：）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T15:05:16.970

只需自己触发调整大小事件。

```
$(window).resize(function() {
    var footerHeight = 147;
    var windowHeight = $(window).height();
    var properHeight = windowHeight - footerHeight;
    $('#main').height(properHeight);
}).resize(); 
```

尽管根据您的内容，您可能需要等到窗口加载后才能执行此操作。

```
$(window).resize(function() {
    var footerHeight = 147;
    var windowHeight = $(window).height();
    var properHeight = windowHeight - footerHeight;
    $('#main').height(properHeight);
}).on("load",function(){
    $(window).resize();
}); 
```

# java - 如何使用 XPath 按特定顺序选择元素

> ID：15341811
> 
> 赞同：2
> 
> 时间：2013-03-11T15:00:56.223
> 
> 标签：java, xpath

我有一个带有节点（Z）的 XML 文件，其中包含随机顺序的子节点（H、W、P）：

```
<X>
  <Y>
    <Z>
      <H>Hello</H>
      <W>World</W>
      <P>!</P>
    </Z>
    <Z>
      <P>!</P>
      <W>World</W>
      <H>Hello</H>
    </Z>
  </Y>
</X> 
```

我想以给定的顺序选择子节点的内容。

我绑了这个：

```
/X/Y/Z/*[self::H or self::W or self::P]/text() 
```

但这将保持错误的顺序：

```
Hello World !
! World Hello 
```

我需要一些方法来按顺序选择相对于 H 的 W 和 P。我怎样才能做到这一点？

我试过这个：

```
/X/Y/Z/(H,W,P)/text() 
```

但是顺序仍然是错误的。

**编辑：**问题表明我只需要文本部分，但我需要节点而不仅仅是文本。原因是，XPath text() 函数似乎有 CDATA 部分的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:16:28.820

对于 XPath 2：

使用 / 选择节点将始终按文档顺序返回节点，无论您如何编写它。

但是，如果您选择原子值而不是节点，它将保持顺序：

```
/X/Y/Z/concat(H,W,P) 
```

您还可以使用永远不会更改顺序的 for-in-return：

```
for $z in /X/Y/Z return ($z/H,$z/W,$z/P) 
```

对于 XPath 3：

在真正的现代实现中，您还可以使用 ! 而不是 / 也将始终保持顺序，否则与 / 相同（并且它也会保持重复）：

```
 /X/Y/Z ! (H,W,P) ! text() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:18:16.520

XPath 将始终遵循 XML 文档树本身的结构，因此 XPath`[self::H or self::W or self::P]/text()`将始终按照出现的顺序返回 H、W 和 P 节点，这就是您看到“Hello World！”的原因。和“！世界你好”。

由于您只需要此处的文本，因此可以像这样使用连接函数：

`concat(/X/Y/Z/H, /X/Y/Z/W, /X/Y/Z/P)`

# matlab - 如何在matlab中使用Newton-Raphson方法找到根的复杂部分？

> ID：15341813
> 
> 赞同：0
> 
> 时间：2013-03-11T15:01:01.640
> 
> 标签：matlab, complex-numbers

```
my_fun = z^3 - 1;
my_deriv = 3*(z^2); 
```

这些是我使用的功能。我可以找到我的解决方案的实部，但是当我使用一个对根具有虚部的函数（例如上面的函数）时，我不知道如何找到它。我的代码为我的初始值遍历不同的值，如果我找到一个根，我将它存储在我的数组中，如果它在数组中找到一个根，它会忽略它。所以我基本上想知道我是否可以更改我的代码以找到具有虚部的根。谢谢

```
clc;
close all;
clear all;

Roots = [];
Array_slot = 1;
threshold = 0.00000001;
% X_initial = 1;

for (j = -10:10)
    X_initial = j;
    if (my_deriv(X_initial) ~= 0)
    counter = 0;

    while (abs(my_fun(X_initial)) > threshold && counter < 100)
        X_initial;
%             imag(X_initial)
        X_one = X_initial - (my_fun(X_initial)/my_deriv(X_initial));
        X_initial = X_one;
%             imag(X_one)
        counter = counter + 1;

    end
    if counter < 1000
    root = (round(X_initial*1000))/1000;

        if ~ismember(root,Roots)

            Roots(Array_slot) = root;
            Array_slot = Array_slot + 1;
        end
    end
end
end

Roots 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:40:41.407

由于您的初始点是真实的，因此您的算法永远不会离开实轴。要找到复数根，您需要从复数点开始，例如`X_initial = 1i`。

我建议你修改你的算法，从一个实点开始，一次从复点开始，以覆盖整个复平面。

此外，`~ismember(root, Roots)`在浮点数的情况下，在过滤掉重复根方面做得不好。你必须想出另一种方法来做到这一点。例如，计算从新获得的根到每个旧根的距离，如果它与其中一个足够接近，则它可能是重复的，因此您可以丢弃它。

附带说明一下，[建议不要使用“i”和“j”作为变量名](https://stackoverflow.com/questions/14790740/using-i-and-j-as-variables-in-matlab)，以防止出现意外行为，尤其是在处理复数时。

# php - 调整/裁剪图像并添加空白

> ID：15341817
> 
> 赞同：0
> 
> 时间：2013-03-11T15:01:11.920
> 
> 标签：php, function, gd, image-resizing

我有这个调整大小和裁剪功能：

```
$file = imagecreatefromjpeg($imagefile["tmp_name"]);

    if($imagefile["type"] == "image/jpg" || $imagefile["type"] == "image/jpeg") {
        $uploaded_file = "/var/www/adimages/".$fid."-".$imagefile["name"];
     } elseif($imagefile["type"] == "image/png") {
        $uploaded_file = "/var/www/adimages/".$fid."-".$imagefile["name"];
     }

    imagejpeg($file, $uploaded_file, 100);
    chmod($uploaded_file, 0644);

    list($width, $height, $type, $attr) = getimagesize($uploaded_file);
    $this->imageSizeW = $width; 
    $this->imageSizeH = $height;
    $this->newSizeW = 250;
    $this->newSizeH = 400;

    $aspect = $width / $height;
    $new_aspect = $this->newSizeW / $this->newSizeH;

    if($aspect >= $new_aspect) {
         $new_height = $this->newSizeH;
         $new_width = $width / ($height / $this->newSizeH);
     } else {
         $new_width = $this->newSizeW;
         $new_height = $height / ($width / $this->newSizeW);
     }

     $img_source = imagecreatefromjpeg($uploaded_file);
     $newimage = imagecreatetruecolor($this->newSizeW, $this->newSizeH);
     imagecopyresampled($newimage, $img_source, 0 - ($new_width - $this->newSizeW) / 2, 0 - ($new_height - $this->newSizeH), 0, 0, $new_width, $new_height, $width, $height);
     imagejpeg($newimage, $uploaded_file, 100);            
} 
```

这几乎可以按预期工作-当它裁剪时，它会删除部分图像。我可以以某种方式扩展/配置此功能，以便它调整图像大小/居中并添加空白，因此图像将与原始图像一样但仍为 250 x 400 像素

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T10:14:05.137

改为使用来自 voret.net 的 Class upload 0.32 - 这就是我想要的！

# php - 通过 AJAX POST 下载文件

> ID：15341818
> 
> 赞同：1
> 
> 时间：2013-03-11T15:01:12.217
> 
> 标签：php, ajax, post, symfony, download

我正在尝试使用 AJAX POST 请求提供简单的下载。用户单击 a`<span>`并开始下载（或显示下载对话框，具体取决于浏览器）。我已经实现了这一切，但是 AJAX 响应不会触发任何浏览器下载行为，我也不知道为什么。

这是我的代码：

HTML/树枝：

```
<span id="export_csv">csv - click me to download the file</span> 
```

javascript:

```
<script type="text/javascript">
$(document).ready(function() {
  $('#export_csv').click(function(){
    var params = "some params";
    $.ajax({
      type: 'POST',
      url:  "{{path('ExportBundle_export', {'format': 'csv','report' : 'basic'})}}",
      data: params
    });
  });
});
</script> 
```

控制器代码（symfony2，但这里没关系）：

```
$response = new Response(file_get_contents($document->getPath()));
$response->setStatusCode(200);
$response->headers->set('Content-Type', $document->getMime());
$response->headers->set('Content-Description', 'Submissions Export');
$response->headers->set('Content-Disposition', 'attachment; filename='
    . $filename . '.' . $format);
$response->headers->set('Content-Transfer-Encoding', 'binary');
$response->headers->set('Pragma', 'no-cache');
$response->headers->set('Expires', '0');
return $response; 
```

这是示例请求：

```
Request URL:http://myapp.local/app_dev.php/export/basic/csv
Request Method:POST
Status Code:200 OK 
```

和响应头：

```
cache-control:private, must-revalidate
Connection:close
content-description:Submissions Export
content-disposition:attachment; filename=report_1363013244.csv
Content-Length:790
content-transfer-encoding:binary
Content-Type:text/csv; charset=UTF-8
Date:Mon, 11 Mar 2013 14:47:24 GMT
expires:0
pragma:no-cache
Server:Apache/2.2.22 (Ubuntu)
x-debug-token:513dee7c99fdb
X-Powered-By:PHP/5.3.10-1ubuntu3.5 
```

我已经检查`Network`了 Google Chrome 类似萤火虫的工具栏中的选项卡，并且响应看起来与文件完全相同。也许我的标题有问题，但我已经检查了两次......

PS 1

我想使用 AJAX 来制作它（我更喜欢它而不是创建 HTML 表单）。

PS 2

我在客户端层（javascript）中有很多参数。我需要所有这些都在控制器中可用（服务器端脚本）。使用 AJAX 时，我只是将它们传递给`data`密钥。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T15:05:19.563

我不明白你为什么要触发下载的ajax调用？你为什么不做一个常规`<a href="download/me">Download</a>`并设置该页面的 mime 类型。这样，您可以运行任何 php 代码，然后回显 mime 类型，这不会导致页面重新加载，您将停留在单击的页面中。

[http://davidwalsh.name/php-header-mime](http://davidwalsh.name/php-header-mime)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T15:06:28.813

您不使用 AJAX 下载文件。

您只需要提供类似的 URL，`<a href="myFile.jpeg">`但问题是您必须使用标头强制下载并`URL Rewriting`拦截请求：

**如果是图像：**

* * *

```
$filename = basename($_GET['img']); // don't accept other directories
$size = @getimagesize($filename);
$fp = @fopen($filename, "rb");
if ($size && $fp)
{
   header("Content-type: {$size['mime']}");
   header("Content-Length: " . filesize($filename));
   header("Content-Disposition: attachment; filename=$filename");
   header('Content-Transfer-Encoding: binary');
   header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
   fpassthru($fp);
   exit;
} 
```

在这种情况下.. URL 不会改变（我认为这就是你想要的）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-07T08:16:58.103

我认为它不可能使用 ajax，我遇到了同样的问题并且没有触发下载。我的解决方案只使用 PHP：

1.  加载页面时在后台创建一个新文件。这将存储在服务器位置。

    ```
    $out = fopen('filename', 'w+');
    //write data in file
    fputcsv($out, some csv values ); 
    ```

2.  有一个链接到客户端下载它

    ```
    <a href='<?php echo $filename;?>' >Export Data to CSV file</a> 
    ```

并且根据执行此操作的频率，您必须定期清理下载，以免填满服务器。

# ios - 错误：发送到已释放实例的消息

> ID：15341822
> 
> 赞同：0
> 
> 时间：2013-03-11T15:01:38.563
> 
> 标签：ios, objective-c, debugging

这个问题源于我之前提出的一个问题。我在调试方面得到了一些帮助，但现在我在 Xcode 的控制台中出现了这个错误：

```
[CFURL absoluteURL]: message sent to deallocated instance 0x949dde0 
```

我已经在所有文件中搜索了一个实例，`absoluteURL`但它似乎只是引导我找到一些 ASIHttp 文件，因为我一直在使用该库。

我正在使用一个 Twitter Auth 代码示例，它带有一些 OAuth 库，我感觉下面的代码可能有问题：

```
NSString * authorizationHeader = OAuthorizationHeader([NSURL URLWithString:@"https://api.twitter.com/oauth/request_token"],
                                                     method,
                                                     bodyData,
                                                     [GSTwitterSignedRequest consumerKey],
                                                     [GSTwitterSignedRequest consumerSecret],
                                                     _authToken,
                                                     _authTokenSecret); 
```

我只是不完全了解如何追踪这一点。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:22:05.513

启用僵尸并在启用 Zombies 的 Instruments 中的 Allocations 工具下运行您的应用程序。还要打开“跟踪引用计数”和“仅跟踪实时分配”（名称的近似值——不要在我面前；分配工具中的两个复选框）。

当应用程序遇到*发送到已释放实例*错误的消息时，您应该能够看到该对象上的所有保留/释放，更重要的是，确切地看到它被分配的位置。

在某个地方，有一个 URL 被过早发布或过度发布。

* * *

[请参阅Instruments 文档](http://developer.apple.com/library/mac/#documentation/developertools/Conceptual/InstrumentsUserGuide/MemoryManagementforYouriOSApp/MemoryManagementforYouriOSApp.html)中的“寻找僵尸” 。

# jqgrid - 分页中的JqGrid rowNum无法正常工作

> ID：15341825
> 
> 赞同：1
> 
> 时间：2013-03-11T15:01:47.900
> 
> 标签：jqgrid

... rowNum：10，寻呼机：'#mypager'，rowList：[10,20,30] ...

在一个有 10 条以上记录的表中，它会全部显示并显示第 1 页，共 0 页，即使`rowNum`它设置为 10。如果我从下拉列表中选择 20，它会显示正确的数字，即使我选择10 之后它再次显示正确的行数。但不是第一次访问。这是为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:41:30.287

调用它可以解决问题：

```
jQuery("#tableToGrid").setGridParam({ rowNum: 10 }).trigger("reloadGrid"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:50:22.440

我想你以错误的方式填充网格。例如，如果您要使用`addRowData`，您可以包含更多行作为 的值`rowNum`。

无论如何，您应该包含更完整的代码，用于创建网格并描述如何在网格中填充数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T15:14:27.047

听起来初始属性设置不正确，请尝试删除该行并重做？

```
 rowNum: 10,
        rowList: [10, 20, 30], 
```

# javascript - 原型 javascript

> ID：15341830
> 
> 赞同：1
> 
> 时间：2013-03-11T15:02:04.263
> 
> 标签：javascript

不能理解：

```
function Rabbit() { }
Rabbit.prototype = { eats: true };
var rabbit = new Rabbit();
Rabbit.prototype = {};
alert(rabbit.eats); //true 
```

和

```
function Rabbit() { }
Rabbit.prototype = { eats: true };
var rabbit = new Rabbit();
Rabbit.prototype.eats = false;
alert(rabbit.eats); // false 
```

为什么？
感谢大家的帮助，我在“在您的第一个示例中，您将 Rabbit.prototype 更改为指向一个全新的、不同的对象。所以现在 Rabbit.prototype 和 rabbit.[[Proto]] 不再指向同一个对象”（c）TJ克劳德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:04:24.227

因为实例背后的原型是在通过创建时`rabbit`分配的（从`Rabbit.prototype`）`new Rabbit`，并且在第一个示例中，您*替换* `Rabbit.prototype`为一个全新的对象，这对`rabbit`实例没有影响。在第二个示例中，您只需*修改*现有对象，它`Rabbit.prototype`和后面的原型`rabbit`都指向，因此由于它们指向同一个对象，因此无论您遵循哪个引用，您都会看到更改。

让我们来看看`var rabbit = new Rabbit();`（省略一些不相关的细节）：

1.  创建了一个新的空白对象。

2.  它的底层原型，通常称为`[[Proto]]`，设置为`Rabbit.prototype`。[`Object.getPrototypeOf`](http://www.ecma-international.org/ecma-262/5.1/#sec-15.2.3.2)（我说“通常称为”是因为规范是这样称呼它的。你不能直接用那个名字来访问它。不过，你可以在支持 ES5 的环境中通过 .Some JavaScript找出给定对象的含义。引擎还通过实际上称为 [in code] 的非标准属性使其可用`__proto__`。）

3.  该新对象被返回并分配给`rabbit`.

现在，我们有两个对象指向原型对象：`Rabbit.prototype`和`rabbit.[[Proto]]`。

在您的第一个示例中，您更改`Rabbit.prototype`为指向一个全新的、不同的对象。所以现在`Rabbit.prototype`和`rabbit.[[Proto]]`不再指向同一个对象。

在您的第二个示例中，您只需更改该共享对象的`eats`属性的值，因此无论您遵循哪个对对象的引用，该更改自然是可见的。

基本上和这个是一样的：

```
var a = {eats: true};
var b = a;
a = {eats: false};
console.log(a.eats); // false
console.log(b.eats); // true 
```

和

```
var a = {eats: true};
var b = a;
a.eats = false;
console.log(a.eats); // false
console.log(b.eats); // false 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:05:40.420

```
Rabbit.prototype = { eats: true }; 
```

相当于

```
Rabbit.prototype = {};
Rabbit.prototype.eats = true; 
```

和

```
Rabbit.prototype.eats = false; 
```

只是使`Rabbit.prototype.eats` `false`（从而使先前的分配无效）。

并且作为 js 引擎，在寻找一个属性时，如果它在本地找不到它，它会寻找它的原型之一（等等），它会使`Rabbit.eats`评估为 false。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T15:04:14.727

在第一种情况下，构造的对象仍然链接到原始原型对象，当然它仍然具有“eats”属性。

在第二种情况下，您没有引入新原型，因此通过实例可以看到更改其“eats”属性的值。

# sql-server-2008-r2 - 合并语句中的性能问题

> ID：15341831
> 
> 赞同：1
> 
> 时间：2013-03-11T15:02:06.717
> 
> 标签：sql-server-2008-r2, merge-statement

我有一个如下的合并语句

```
 MERGE DESTINATION AS DST
 USING ( SELECT <Some_Columns> FROM TABLEA WITH(NOLOCK) INNER JOIN TableB .....

       ) AS SRC
   ON(
     <some conditions>
   )

 WHEN MATCHED THEN 
    UPDATE SET column1 = src.column1
              ...............
              ,Modified_By = @PackageName
              ,Modified_Date = GETDATE() 

 WHEN NOT MATCHED THEN 

    INSERT (<Some_Columns>)
    VALUES(<Some_Columns>)

         OUTPUT        
                  $action, inserted.key'inserted'
                   INTO @tableVar
                ; 
```

对于第一组记录（大约 300,000 条记录），它运行良好，只需 30 秒即可执行。但是对于第二组记录（大约 300,000 条），它需要一个多小时。

两天前，我已经加载了 50 个这样的集合，并且相同的查询运行得非常快，但从今天开始它非常慢。我不知道出了什么问题。

注：查询

> 从 TABLEA 中选择 WITH(NOLOCK) INNER JOIN TableB .....

在所有场景中需要 20 秒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T19:25:30.877

虽然`MERGE`语法更好，并且它*似乎*承诺更好的原子性和没有竞争条件（[但除非你添加，否则不会`HOLDLOCK`，正如 Dan Guzman 的这篇文章所展示的那样](http://weblogs.sqlteam.com/dang/archive/2009/01/31/UPSERT-Race-Condition-With-MERGE.aspx)），我仍然觉得坚持旧式更好，单独的插入/更新方法。主要原因不是语法难学（确实如此），或者难以解决并发问题（事实并非如此），而是存在几个未解决的错误 - 即使在 SQL Server 2012 中也是如此仍然 - 涉及此操作。[我在这篇文章中指出了其中的十几个，它们谈到了`MERGE`最近修复的另一个错误](http://www.sqlperformance.com/2013/02/t-sql-queries/another-merge-bug)。我还在[此处发布的警告提示中详细介绍了](http://www.mssqltips.com/sqlservertip/3074/tip-on-using-caution-with-merge/?utm_source=AaronBertrand)和其他几个人在[这里](https://sqlblog.org/merge)插话。

正如我在评论中所建议的那样，我不想发出天要塌下来的警报，但我真的对切换到没有那么感兴趣，`MERGE`直到有更少的活动错误。所以我建议现在坚持使用老式`UPSERT`的，即使您使用的实际语法可能不是您遇到的性能问题的根源。

```
UPDATE dest SET column1 = src.column1
  FROM dbo.DestinationTable AS dest
  INNER JOIN (some join) AS src
  ON (some condition);

INSERT dest(...) SELECT cols
  FROM (some join) AS src
  WHERE NOT EXISTS 
  (
    SELECT 1 FROM dbo.DestinationTable
    WHERE key = src.key
  ); 
```

对于性能问题，您需要查看会话的等待（[Plan Explorer](https://www.sentryone.com/plan-explorer)`blocking_session_id` * 可以通过为您启动扩展事件会话来帮助解决此问题），或者至少`wait_type_desc`在`sys.dm_exec_requests`查询运行时进行。

^(*免责声明：我曾经为 SQL Sentry 工作。)

# java - JMap 转储格式规范

> ID：15341833
> 
> 赞同：1
> 
> 时间：2013-03-11T15:02:16.460
> 
> 标签：java, heap-dump, jmap

jmap 堆转储格式是否有任何开放规范？

感谢帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T16:05:42.290

如果您需要堆的直方图，您可以使用`jmap -histo <pid>`从您的实时 JVM 获取直方图。如果您已经拥有堆转储文件，则可以使用[Eclipse MAT](http://www.eclipse.org/mat/)（Eclipse 内存分析器工具）加载转储文件并轻松获取您正在寻找的直方图。

也许[Lars Vogel 关于它的小教程](http://www.vogella.com/articles/EclipseMemoryAnalyser/article.html)可以是一个简单的第一步。

关于*hprof 二进制格式*，我前段时间为此添加了书签：http: [//java.net/downloads/heap-snapshot/hprof-binary-format.html](http://java.net/downloads/heap-snapshot/hprof-binary-format.html)，但是开发自己的解析器来获取直方图完全是矫枉过正。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T18:10:18.397

直方图的其他更简单的解决方案是使用[jhat](http://ranjanrakesh.wordpress.com/2013/04/17/java-memory-analysis-just-using-jdk/)而不必担心格式。你可以向下钻取并做各种事情。

# python - Reportlab 未在 Google App Engine 上的 Django 应用程序中生成图表

> ID：15341834
> 
> 赞同：2
> 
> 时间：2013-03-11T15:02:22.107
> 
> 标签：python, django, google-app-engine, reportlab

我有一个在谷歌应用引擎上运行的 django 应用。该应用程序的一项功能是根据使用该应用程序时提供的数据生成图表。我使用reportlab 来制作图表，这在开发过程中很有效。但是，在将应用程序上传到 Google App Engine 时，任何查看图表页面的尝试都会返回以下错误：

“ **ImportError at ... 没有名为 _renderPM 的模块**”

到目前为止，我了解到该错误是由于reportlab 依赖GAE 不支持的PIL 造成的。我已将reportlab 模块放在应用程序的项目目录中，但它仍然无法正常工作。

因此，我的问题是：我需要做什么才能使图表在应用程序上可见？无论如何，我的应用程序要求reportlab在GAE上工作吗？

（应用程序的“mycharts.py”和“views.py”的代码如下所示。）

# mycharts.py

```
from reportlab.graphics.shapes import Drawing, String
from reportlab.graphics.charts.barcharts import VerticalBarChart
from reportlab.graphics.charts.linecharts import HorizontalLineChart
from reportlab.graphics.charts.lineplots import LinePlot
from reportlab.graphics.widgets.markers import makeMarker
from reportlab.graphics.charts.textlabels import Label
from reportlab.graphics.widgets.grids import Grid, DoubleGrid
from reportlab.lib import colors
from models import Caller

#Customer gender filter functions begin here
def male_caller_count():
    return Caller.objects.filter(gender='Male').count()

def female_caller_count():
    return Caller.objects.filter(gender='Female').count()
#Customer gender filter functions end here

class GenderChartDraw(Drawing):
    def __init__(self, width=500, height=500, *args, **kw):

        Drawing.__init__(self,width,height,*args,**kw)

        female = female_caller_count()
        male   = male_caller_count()

        data = [(male, 0), (0, female)]

        self.add(VerticalBarChart(), name='chart')
        self.add(String(100,450,'Caller by Gender'), name='title')
        self.title.fontName = 'Helvetica-Bold'
        self.title.fontSize = 20

        self.chart.x = 70
        self.chart.y = 20
        self.chart.width = 300
        self.chart.height = 400
        self.chart.data = data
        self.chart.strokeColor = colors.black
        self.chart.valueAxis.valueMin = 0
        self.chart.valueAxis.valueMax = 50
        self.chart.valueAxis.valueStep = 5
        self.chart.valueAxis.visibleGrid = 1
        self.chart.categoryAxis.style = 'stacked'
        self.chart.categoryAxis.categoryNames = ['Male', 'Female']
        self.chart.bars[0].fillColor = colors.HexColor('#376BF9')
        self.chart.bars[1].fillColor = colors.HexColor('#FE03E5')
        self.chart.categoryAxis.labels.fontSize = 13

if __name__=='__main__':
    #use the standard 'save' method to save barchart.gif, barchart.pdf etc
    #for quick feedback while working.
    GenderChartDraw().save(formats=['gif','png','jpg','pdf'],outDir='.',fnRoot='barchart') 
```

# 视图.py

```
from django.shortcuts import render, render_to_response
from django.http import HttpResponse, HttpResponseRedirect
from django.template import RequestContext
from django.views.decorators.csrf import csrf_exempt
from datetime import datetime
from models import Caller
import mycharts
from django.contrib.auth.decorators import login_required

@login_required
def app_stats(request):
    return render_to_response('AppStats.html', context_instance=RequestContext(request))

@login_required
def gender_chart(request):
    #instantiate a drawing object
    d = mycharts.GenderChartDraw()

    if 'height' in request:
        d.height = int(request['height'])
    if 'width' in request:
        d.width = int(request['width'])

    if 'numbers' in request:
        strNumbers = request['numbers']
        numbers = map(int, strNumbers.split(','))    
        d.chart.data = [numbers]   #bar charts take a list-of-lists for data

    if 'title' in request:
        d.title.text = request['title']

    #get a GIF (or PNG, JPG, or whatever)
    binaryStuff = d.asString('gif')
    return HttpResponse(binaryStuff, 'image/gif') 
```

# 错误日志

```
ImportError at /CallApp/stats/GenderChart/
No module named _renderPM
see https://www.reportlab.com/software/opensource/rl-addons/
Request Method: GET
Request URL:    http://cacallapp.appspot.com/CallApp/stats/GenderChart/
Django Version: 1.4.3
Exception Type: ImportError
Exception Value:    
No module named _renderPM
see https://www.reportlab.com/software/opensource/rl-addons/
Exception Location: /base/data/home/apps/s~cacallapp/1.365898222031464318/reportlab/graphics/renderPM.py in <module>, line 32
Python Executable:  /python27_runtime/python27_dist/python
Python Version: 2.7.3
Python Path:    
['/base/data/home/apps/s~cacallapp/1.365898222031464318',
 '/python27_runtime/python27_dist/lib/python27.zip',
 '/python27_runtime/python27_dist/lib/python2.7',
 '/python27_runtime/python27_dist/lib/python2.7/plat-linux2',
 '/python27_runtime/python27_dist/lib/python2.7/lib-tk',
 '/python27_runtime/python27_dist/lib/python2.7/lib-old',
 '/python27_runtime/python27_dist/lib/python2.7/lib-dynload',
 '/python27_runtime/python27_dist/lib/python2.7/site-packages',
 '/python27_runtime/python27_lib/versions/1',
 '/python27_runtime/python27_lib/versions/third_party/PIL-1.1.7',
 '/python27_runtime/python27_lib/versions/third_party/PIL-1.1.7/PIL',
 '/python27_runtime/python27_lib/versions/third_party/django-1.4',
 '/python27_runtime/python27_lib/versions/third_party/webapp2-2.3',
 '/python27_runtime/python27_lib/versions/third_party/webob-1.1.1',
 '/python27_runtime/python27_lib/versions/third_party/yaml-3.10',
 '/base/data/home/apps/s~cacallapp/1.365898222031464318/..']
Server time:    Tue, 12 Mar 2013 08:38:21 +0000 
```

# 追溯

```
/python27_runtime/python27_lib/versions/third_party/django-1.4/django/core/handlers/base.py in get_response
                        response = callback(request, *callback_args, **callback_kwargs) ...
▶ Local vars
/python27_runtime/python27_lib/versions/third_party/django-1.4/django/contrib/auth/decorators.py in _wrapped_view
                return view_func(request, *args, **kwargs) ...
▶ Local vars
/base/data/home/apps/s~cacallapp/1.365898222031464318/CallApp/views.py in gender_chart
    binaryStuff = d.asString('gif')
 ...
▶ Local vars
/base/data/home/apps/s~cacallapp/1.365898222031464318/reportlab/graphics/shapes.py in asString
            from reportlab.graphics import renderPM
 ...
▶ Local vars
/base/data/home/apps/s~cacallapp/1.365898222031464318/reportlab/graphics/renderPM.py in <module>
                                    "see https://www.reportlab.com/software/opensource/rl-addons/")
 ...
▶ Local vars 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:47:09.210

SDK 默认不安装 PIL，因为许多应用程序不需要它。尝试安装 PIL：

[https://developers.google.com/appengine/docs/python/images/installingPIL](https://developers.google.com/appengine/docs/python/images/installingPIL)

另外，您是否在 app.yaml 中指定了 PIL：

```
libraries:
- name: PIL
  version: "latest" 
```

# python - 在 tornado web 中更改特定静态文件的 mime 类型

> ID：15341843
> 
> 赞同：6
> 
> 时间：2013-03-11T15:02:39.857
> 
> 标签：python, tornado

我的 /static/ dir 服务器端有一堆文件，其名称如下：

```
Slide0.html    Slide121.html  Slide143.html  Slide165.html  Slide187.html  Slide208.html  
Slide28.html   Slide4.html   Slide71.html  Slide93.html
Slide100.html  Slide122.html  Slide144.html  Slide166.html  Slide188.html  Slide209.html 
```

我在同一个域中获取它们并定期将它们插入到 iframe 中，它们所做的只是渲染一些图像，但浏览器给出以下错误：

```
Resource interpreted as Image but transferred with MIME type text/html: "http://localhost:8888/static/Slide66.html". 
```

我试图徒劳地继承静态文件处理程序：

```
class StaticHandler(tornado.web.StaticFileHandler):

def get(self, path):
    abspath = os.path.abspath(os.path.join(self.root, path))
    mime_type, encoding = mimetypes.guess_type(abspath)
    if mime_type:
        self.set_header("Content-Type", mime_type)

    if 'Slide' in abspath:
        self.set_header('Content-Type',"image/jpg" ) 
```

但错误仍然存​​在我如何调整它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-23T03:57:47.583

在 Tornado 3.1 中，您可以继承`StaticFileHandler`和覆盖`get_content_type()`.

```
class StaticJSONFileHandler(tornado.web.StaticFileHandler):
    def get_content_type(self):
        return 'application/json' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-07T13:59:33.803

问题是您的浏览器正在获取“Slide66.html”以用作图像。您可能会使用“Slide66.html”作为“src”属性生成具有“img”标签的 HTML。

龙卷风正在做正确的事。如果“Slide66.html”确实是一张图片，那么它应该是“Slide66.jpg”。如果它是真正的 html，那么它就不能是图像的“src”。

# iphone - 在横向上全屏播放 youtube，但在纵向上内联 - 在 iPhone 上

> ID：15341845
> 
> 赞同：0
> 
> 时间：2013-03-11T15:02:49.293
> 
> 标签：iphone, ios, objective-c, youtube, autorotate

我有一个 UIWebView 的视图，它的大小只有 iPhone 屏幕的一半。在这个网络视图中，我嵌入了 youtube 视频。该应用程序仅处于纵向模式。虽然我希望看到视频也可以横向播放。

现在我想要以下行为：

1.  在纵向时，内联播放，不要全屏。一种。为此，我使用“webView.allowsInlineMediaPlayback=YES;” 湾。我使用以下链接打开 web 视图：“www.youtube.com/embed/videoid?playsinline=1”
2.  **如果用户将屏幕旋转为横向，我希望视频全屏显示**。
3.  如果用户然后旋转回纵向，我希望视频再次内联。
4.  旋转不应在中间停止视频，或重新开始播放。

我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:35:23.920

由于嵌入式视频使用未记录的 MPInlineVideo(Fullscreen)ViewController，因此您无法使用其 API 并切换到全屏。

因此，我建议使用 iframe 标记的“allowFullScreen”参数。

如果一切都失败了，您应该始终能够更改 web-view 的 frame-size 以使其覆盖整个屏幕。然后，您必须在 iframe 中使用 100% 的宽度/高度。

免责声明：这是一个有根据的猜测。我实际上并没有尝试以这种方式实现它。

# php - 提交表单后重置html表单并再次使用它而不刷新页面

> ID：15341846
> 
> 赞同：0
> 
> 时间：2013-03-11T15:02:55.353
> 
> 标签：php, jquery

我在 PHP 页面中有 html 表单，它提供不同大小的图像下载。

```
<form action='download.php' method='post'>
     <select name='size'>
          <option value='1'>Small</option>
          <option value='2'>Medium</option>
          <option value='3'>Large</option>
     </select>
     <button type='submit'>Download</button>
</form> 
```

在“download.php”页面中，有生成图像并使用标题自动开始下载的代码。

```
header('Content-type: image/jpeg');
header('Content-Disposition: attachment; filename="'.$filename.'"');        
imagejpeg($image, null, 100); 
```

当我点击下载按钮时，表单提交成功并且图像开始下载。因为我在 download.php 文件中使用了标题，所以当前页面不会重定向到 download.php 文件，并且表单保持原样。到目前为止一切正常。

现在，如果我再次单击下载按钮，表单将重定向到 download.php 文件，没有图像下载。

有没有办法在不刷新我的索引页面的情况下多次使用下载按钮？

**笔记：**

1.) 我在索引页面上使用 jquery。

2.) 而不是`<input type='submit' />`, 我正在使用，`<button type='submit'></button>`因为我正在使用 font-awesome jquery 插件将图标放在按钮中。这在输入标签中是不可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:08:42.897

你已经使用 jquery ajax 来做你所要求的。

你可以在这里找到[ajax 教程](http://api.jquery.com/jQuery.ajax/ "Ajax 教程")。

第 1 步：您需要使用 ajax 发布数据

第 2 步：要重置字段，您可以 jquery 使用他们的 ID 重置字段

[ajax jquery 下载脚本](http://johnculviner.com/post/2012/03/22/Ajax-like-feature-rich-file-downloads-with-jQuery-File-Download.aspx)

# ruby-on-rails - RSpec 测试自定义 Rails 日志是否写入

> ID：15341850
> 
> 赞同：2
> 
> 时间：2013-03-11T15:03:01.160
> 
> 标签：ruby-on-rails, logging, rspec

我正在尝试测试一种方法，该方法根据条件将多条消息记录到*不是*默认 Rails 记录器的日志中。我将记录器格式化为`config/environment.rb`：

```
# Format the logger
class Logger
  def format_message(level, time, progname, msg)
    "#{time.to_s(:db)} #{level} -- #{msg}\n"
  end
end 
```

并在`lib/`目录的 ImportRecording 类中创建了一个新的记录器。该类的方法包括以下内容：

```
# some code omitted...
days.each do |day|
  if not hash[day].include? "copied"
    @log.error "#{day} needs to be copied!"
  end
  if not hash[day].include? "compressed"
    @log.error "#{day} needs to be compressed!"
  end
  if not hash[day].include? "imported"
    @log.debug "#{day} needs to be imported"
    `rake RAILS_ENV=#{Rails.env} recordings:import[#{day}]` unless Rails.env == "test"
  end
end
# finishing up logging omitted... 
```

我写了一个小宏来帮助测试这个方法：

```
def stub_todo
  { "20130220" => ["copied"],
    "20130219" => ["copied", "compressed"],
    "20130218" => ["copied", "compressed", "imported"] }
end 
```

这是我的测试：

```
describe ".execute_todo" do
  it "carries out the appropriate commands, based on the todo hash" do
    ImportRecording.execute_todo stub_todo
    ImportRecording.log.should_receive(:debug).with("20130219 needs to be imported")
    ImportRecording.log.should_receive(:error).with("20130220 needs to be compressed!")
    ImportRecording.log.should_receive(:debug).with("20130220 needs to be imported")
  end
end 
```

我在运行这些测试时盯着导入日志并观察添加的行（有延迟，因为现在日志很大），但测试仍然失败。我想知道日志的格式是否搞砸了，但我*将*上述字符串传递给方法`:debug`和`:error`日志。有什么帮助吗？

编辑 3/14/13：

希望有人可以在这里帮助我，我通过测试更改为如下所示：

```
it "carries out the appropriate commands, based on the todo hash" do
  ImportRecording.stub!(:execute_todo).with(stub_todo).and_return(false)
  ImportRecording.log.should_receive(:debug).with("20130219 needs to be imported")
  ImportRecording.log.should_receive(:error).with("20130220 needs to be compressed!")
  ImportRecording.log.should_receive(:debug).with("20130220 needs to be imported")
end 
```

这是我从 RSpec 得到的错误：

```
Failure/Error: ImportRecording.log.should_receive(:debug).with("20130219 needs to be imported")
  (#<Logger:0x007fb04fa83ed0>).debug("20130219 needs to be imported")
    expected: 1 time
    received: 0 times 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T23:54:36.617

我发现了问题。不知何故，这些期望应该在实际导致它们的方法*之前声明。*代码应阅读

```
it "carries out the appropriate commands, based on the todo hash" do
  ImportRecording.log.should_receive(:debug).with("20130219 needs to be imported")
  ImportRecording.log.should_receive(:error).with("20130220 needs to be compressed!")
  ImportRecording.log.should_receive(:debug).with("20130220 needs to be imported")
  ImportRecording.execute_todo stub_todo
end 
```

现在测试通过了。我还必须在测试中添加更多行，以说明由于方法调用而写入日志的每一行。因此，对于未来的研究人员，请陈述您的期望，*然后*调用该方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:30:58.723

*当我运行这些测试并观察添加的行时，我盯着导入日志*

如果您在记录器调用上设置消息预期，则不应*看到*添加到日志中的行。与存根一样，消息期望取代了原始方法的实现。这表明您的记录器设置以某种方式配置错误。

# javascript - 如何访问指令中的属性值？

> ID：15341852
> 
> 赞同：0
> 
> 时间：2013-03-11T15:03:05.133
> 
> 标签：javascript, angularjs, angularjs-directive

我正在尝试将模型绑定到指令中的属性。

Javascript——

```
function Main($scope) {
    $scope.text = "abc"
};

angular.module("myApp", [])
.directive("load", function ($compile) {
    return {
        restrict: 'E',
        replace: true,
        link: function (scope, element, attrs) {
           console.log(attrs);
           element.html(someFunction(attrs.text));
        }
    };
}); 
```

HTML --

```
<div ng-controller="Main">
    <load text="Hello {{text}}"></load>
</div> 
```

[你可以在这里](http://jsfiddle.net/CaGy6/)找到 jsFiddle 。在小提琴中我已经取消了`someFunction`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:57:42.063

这是一个快速的 plunk，显示了从指令中获取范围的 5 种不同方法。最后一个是你想要的：http: [//plnkr.co/edit/e2mMAq](http://plnkr.co/edit/e2mMAq)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:53:18.973

根据我认为您正在尝试做的事情，您需要进行两项修改：

1.  您已将替换设置为 true，因此您可能应该在代码中添加一个模板，以用新标记替换元素。

2.  在链接阶段发生时，尚未对插值进行评估，因此您需要观察属性以寻找变化。

    ```
     angular.module('myApp', [])
          .directive('load', function($compile) {
              return {
                  restrict: 'E',
                  replace: true,
                  link: function (scope, element, attrs) {
                      console.log(attrs);
                      element.html(attrs.text);

                      attrs.$observe('text', function(value) {
                          console.log('new value = ' + value);
                          element.html(value);
                      });
                  }

              };
          }); 
    ```

请查看[观察插值属性](http://docs.angularjs.org/guide/directive)的部分以了解更多详细信息。

# javascript - 块内的代码被包裹在括号内。为什么？

> ID：15341854
> 
> 赞同：2
> 
> 时间：2013-03-11T15:03:13.523
> 
> 标签：javascript

我遇到了这段代码，不明白为什么块中的代码像自动执行函数一样被包裹在括号中。

```
function foo(a,b) {
  var b = b || window,
    a = a.replace(/^\s*<!(?:\[CDATA\[|\-\-)/, "/*$0*/"); 
  if (a && /\S/.test(a)) {
    (b.execScript || function (a) {
      b["eval"].call(b, a)
    })(a);
  }
} 
```

第一个参数是来自脚本标签的文本。我不明白的唯一部分是为什么脚本 eval 被包裹在括号中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T15:06:17.003

我假设您正在谈论这部分：

```
(b.execScript || function (a) {
    b["eval"].call(b, a)
})(a); 
```

这是一种简短的写作形式：

```
if (b.execScript) {
    b.execScript(a);
}
else {
    b["eval"].call(b, a);
} 
```

即`b.execScript`如果定义了就执行，否则调用`b["eval"].call(b, a)`。

分组运算符的目的是在函数调用之前进行评估`... || ...`，即无论分组运算符的结果是什么，它都被视为函数并通过传递`a`给它来调用。

看起来代码可以简化为

```
(b.execScript || b["eval"])(a); 
```

尽管如果显式设置`this`为`b`是必要的，那么函数表达式也是必要的，具有两个只接受一个参数的函数，`a`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-11T15:06:15.397

```
(b.execScript || function (a) {
      b["eval"].call(b, a)
    })(a) 
```

这包含在括号中，因为`||`需要评估该语句以确定在传递参数之前要运行的函数。

如果存在并且是真实的，则此代码`b.execScript`使用参数调用。否则它定义一个新函数并作为参数传递给它。`a``b.execScript``a`

parens wrap 是为了确保`||`在执行函数之前对语句进行评估。没有它，逻辑基本上会进行，如果 b.exec 不存在，则评估自定义函数的值，如果存在，则评估为 b.exec。

因此，使用括号，逻辑等效于：

```
if(b.execScript){
   b.execScript(a)
}
else{
  function (a) {
    b["eval"].call(b, a)
  })(a)

} 
```

没有它，它相当于

if(!b.execScript){ function (a) { b["eval"].call(b, a) })(a) }

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-11T15:06:11.623

加括号是因为`||`操作符比函数调用操作符绑定得更松散`()`。如果没有括号，表达式将被评估，就好像它是这样写的：

```
b.execScript || (function (a) { b["eval"].call(b, a); })(a) 
```

也就是说，它要么是普通值，`b.execScript`要么是调用该函数的值。作者想要的是调用的值`b.execScript`（可能是一个函数）*或*那个小匿名函数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-11T15:05:57.350

因为`(a)`后来。表达方式：

```
(b.execScript || function (a) {
      b["eval"].call(b, a)
    }) 
```

返回一个闭包，然后`a`将其作为参数传递来执行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-11T15:28:56.110

> 为什么块中的代码像自动执行函数一样被包裹在括号中。

因为代码的特定部分*是*自动执行功能：

```
(b.execScript || function (a) {
    b["eval"].call(b, a)
})(a); 
```

这里，变量`b`引用了执行容器，例如`window`，并`a`包含需要执行的 JavaScript 代码。

由于有些浏览器支持`execScript()`而有些只支持`eval()`，因此代码通过测试此浏览器功能来支持它们，如下所示：

```
var tmp = b.execScript || function (a) {
  b["eval"].call(b, a)
}; 
```

这里，`tmp`是一个接受单个参数`a`并执行其中代码的函数；如果`execScript`不可用，则使用一个小的辅助函数。然后它是这样调用的：

```
tmp.call(b, a); 
```

第一个参数`.call()`定义什么`this`时候`tmp`被调用；第二个参数成为 的第一个参数`tmp`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-11T15:07:12.910

括号表达式返回 b.execScript 的结果或新函数。在任何一种情况下，都会使用 a 作为参数调用结果。括号确保解释器评估 || 在调用之前。

# android - chrome 25 iframe 自定义协议不工作

> ID：15341855
> 
> 赞同：5
> 
> 时间：2013-03-11T15:03:14.913
> 
> 标签：android, google-chrome, iframe, protocol-handler

我有协议（如 http），其方案由在 android 中注册的 3rd 方应用程序管理。即，someapp://someaction 或类似的东西。

在将 chrome 升级到最新版本（chrome 25）之前，它工作正常，但升级后，它不起作用。

我只是使用 iframe 来尝试加载注册的应用程序。这是我的代码快照。

```
<iframe src="about:blank" id="myframe"/>
<script>
  function changesrc(){
    document.getElementById("myframe").src="someapp://someaction"
  }
</script> 
```

对这个问题有什么想法吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T19:56:00.677

我们认为这可能存在安全或恶意操作错误，因此不会再在 Chrome 中实施。有关详细信息，请参阅[https://code.google.com/p/chromium/issues/detail?id=169204#c27 。](https://code.google.com/p/chromium/issues/detail?id=169204#c27)

有一个解决方案，您可以构造一个用户可以调用 的[特殊“意图”url 。](https://developers.google.com/chrome/mobile/docs/intents)

基于意图的 URI 的基本语法如下：

```
“intent:”
    HOST/URI-path “;”  // Optional
        “#Intent;”
        package=[string];
        action=[string];
        category=[string];
        component=[string];
                    scheme=[string];
    “;end” 
```

Android 源代码中提供了解析详细信息。

要启动 Zxing 条码扫描器应用程序，您可以将您的 href 编码如下 intent://scan/#Intent;scheme=zxing;package=com.google.zxing.client.android;end 在锚点上的 href 中，如下所示二维码

摘自：[https ://code.google.com/p/zxing/source/browse/trunk/android/AndroidManifest.xml#97](https://code.google.com/p/zxing/source/browse/trunk/android/AndroidManifest.xml#97)

android manifest 将 scheme 定义为“zxing”，将包定义为“com.google.zxing.client.android”，将主机数据定义为“scan” 当用户单击此链接时，他们将直接进入应用程序如果他们已经安装了它，或者如果没有直接安装到 Play 商店。

# web - 为 Retina-ready（网络）准备图像

> ID：15341857
> 
> 赞同：1
> 
> 时间：2013-03-11T15:03:19.957
> 
> 标签：web, photoshop, retina-display, screen-resolution

我有一个问题一直萦绕在我的脑海中：我应该如何准备要在网站上使用的图像以做好视网膜准备？

是的，我一直在互联网上就这个话题花费数小时，但到目前为止我还没有找到一个“最终答案”。

例如，在这个线程中（链接：[retina display 的图像大小](https://stackoverflow.com/questions/12588766/image-size-for-retina-display)），只提到我需要将尺寸加倍。但是分辨率呢？

实际情况：使用 Photoshop（或任何您的修复程序）创建尺寸为 400 像素 x 200 像素的图像，分辨率为 72 ppi。
我应该如何修改这个图像？

*   800 x 400 像素，72 ppi（只需调整大小，乘以 2）
*   800 x 400 像素，144 ppi（尺寸和分辨率乘以 2）
*   400 x 200 像素，144 ppi（只是分辨率的两倍）
*   400 x 200px，246 ppi（相同尺寸，更高分辨率——我从设计 ipad 壁纸的一些教程中得到了数字 246）
*   ……等等……？？

目标是选择图像并将它们显示在非视网膜和视网膜显示器上（即“普通”计算机/笔记本电脑、mac（两个版本，视网膜和非）、iDevices、Androids 等）

期待任何反馈:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T14:19:44.107

您可以使用[Retina.js](http://retinajs.com)将图像替换为更高分辨率版本，但前提是用户设备配备了视网膜显示器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:35:31.873

您链接的问题是正确的。您需要将图像大小加倍以使分辨率加倍。

您感到困惑的是PPI。PPI 是 Pixels Per Inch，它只是衡量图片大小的指标，与显示尺寸相同。

一个不独立于另一个。

400x200 的图像在 72 ppi 显示器上占用的屏幕空间与在 144 ppi 显示器上的 800x400 图像占用的屏幕空间一样多。区别只是 144 ppi 的设备能够在一英寸的屏幕空间中容纳比 72 ppi 更多的像素。

因此，通过将 72ppi 图像的分辨率加倍，您确实可以确保它看起来相同/占用相同数量的屏幕空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-09T10:51:30.470

有一个新的响应式图像[HTML5 标准](http://www.whatwg.org/specs/web-apps/current-work/multipage/edits.html#the-picture-element)。截至 2014 年 7 月，它还只是[浏览器的 beta 版本](http://alistapart.com/blog/post/testing-responsive-images)。但是[Picturefill polyfill](http://scottjehl.github.io/picturefill/)已经可用。

[本文](http://www.smashingmagazine.com/2014/05/14/responsive-images-done-right-guide-picture-srcset/)很好地解释了不同的用例。但是您在这里想要的是简单地为高分辨率（例如“视网膜”）显示器提供替代图像：

```
<img srcset="small.jpg 1x, large.jpg 2x"
   src="small.jpg"
   alt="A rad wolf" /> 
```

# c - linux内核如何检查是否设置了粘滞位

> ID：15341859
> 
> 赞同：3
> 
> 时间：2013-03-11T15:03:23.623
> 
> 标签：c, linux, kernel

我正在开发一个 linux 内核项目，其目的是修改内核以要求某些指定文件（例如重要的系统文件或系统配置文件）在执行（如果是二进制文件）或打开以供读写之前进行验证使用权。

在内核内部，我们只会为设置了粘性位的文件提供验证。那么任何人都知道如何检查文件的粘性位是否设置在内核中？

我搜索了该网站，只看到有关如何在用户区执行此操作的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:15:57.953

请参阅 中的[`check_sticky`](http://lxr.linux.no/#linux+v3.8.2/fs/namei.c#L2203)函数`fs/namei.c`。

# qt - 在 QtCreator 中使用 .pro 和 .pri 正确（树）显示 Qt 项目

> ID：15341860
> 
> 赞同：2
> 
> 时间：2013-03-11T15:03:25.257
> 
> 标签：qt, qt-creator

是否可以使用项目包含文件 (.pri) 显示多于一层的额外级别。例如，如果`.pro`文件包含`.pri`包含两个`.pri`文件的文件。

*   .pro
    *   .pri
        *   .pri
        *   .pri

在 QtCreator (Projects) 中显示具有误导性：

*   .pro
    *   .pri
    *   .pri
    *   .pri

它根本不考虑`.pri`文件在文件系统中的位置，并将它们显示为同一`.pro`级别。还是我做错了什么或只是期待太多？我正在使用`Qt 4.7.4`和`QtCreator 2.2.1`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-04-05T06:58:28.793

从 Qt Creator 3.6 开始，嵌套`.pri`文件显示在树中。您可以查看已解决的[此错误报告](https://bugreports.qt.io/browse/QTCREATORBUG-487)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T07:25:34.443

如果您忽略第二级 .pri 文件并仅使用新目录并将所有包含移动到根 .pri 文件，似乎有某种解决方法。例如：

*   .pro
    *   .pri
        *   新目录 A（而不是另一个 .pri）
        *   新目录 B（而不是另一个 .pri）

QtCreator（项目）显示：

*   .pro
    *   .pri
        *   标头
            *   新目录 A
            *   新目录 B
        *   来源
            *   新目录 A
            *   新目录 B

这样做的好处是您可以保持相同的文件结构。我仍然希望他们实现对 .pri 新级别的检测。但是，如果您发现更多我天堂没有的东西，请告诉我。

# c++ - 用模板定义宏作为变量

> ID：15341861
> 
> 赞同：0
> 
> 时间：2013-03-11T15:03:25.960
> 
> 标签：c++, templates, c-preprocessor

我正在尝试使用宏来创建一些静态变量。

我的问题是，我如何定义一个带有 2 个参数的宏，第一个是模板，第二个是静态变量。模板应该有超过 1 种类型。

例如：

```
#define macro(x, y, z, v) x::y z = v;

int main(int argc, char *argv[]) {
  // this works
  macro(std::queue<int>, value_type, test, 4)
  // this also works
  std::pair<int, int>::first_type x = 3;

  // this is produsing some compiler errors
  macro(std::pair<int, int>, first_type, test2, 4)

  return 0;
} 
```

甚至有可能做到这一点吗？

这是错误：

```
main.cpp(47) : warning C4002: too many actual parameters for macro 'macro'
main.cpp(47) : error C2589: 'int' : illegal token on right side of '::'
main.cpp(47) : error C2589: 'int' : illegal token on right side of '::'
main.cpp(47) : error C2143: syntax error : missing ',' before '::'
main.cpp(50) : error C2143: syntax error : missing ';' before '}'
main.cpp(51) : error C2143: syntax error : missing ';' before '}' 
```

灵感来自 Joachim Pileborg

```
#define macro(x, y, z, v, ...) x<__VA_ARGS__>::y z = v;
...

// now it works
macro(std::pair, first_type, test2, 4, int, int) 
```

谢谢约阿希姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:25:09.070

这不是真正的解决方案，而只是一种解决方法：

```
#define COMMA ,

macro(std::pair<int COMMA int>, first_type, test2, 4) 
```

或者更具可读性：

```
#define wrap(...) __VA_ARGS__

macro(wrap(std::pair<int, int>), first_type, test2, 4) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T15:29:59.103

有几种方法可以去掉那个顶级逗号。

```
typedef std::pair<int, int> int_pair;
macro(int_pair, first_type, test2, 4)

macro((std::pair<int, int>), first_type, test2, 4);

#define macro2(x1, x2, y, z, v) x1, x2::y z = v;
macro2(std::pair<int, int> first_type, test2, 4) 
```

顺便说一句，我会`;`从宏中删除，并在使用宏的任何地方使用它。这使代码看起来更自然。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-11T15:06:51.370

这是因为处理宏的预处理器非常愚蠢。它在第二个宏“调用”中看到五个参数，第一个是`std::pair<int`，第二个是`int>`。您不能有包含逗号的宏参数。

您可能需要查看[variadic macros](http://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html)并重新排列，以便该类位于宏中的最后一个。

# c# - 每个可观察运算符的默认调度程序是什么？

> ID：15341864
> 
> 赞同：47
> 
> 时间：2013-03-11T15:03:30.703
> 
> 标签：c#, system.reactive

[MSDN上的这个页面](http://msdn.microsoft.com/en-us/library/hh242963%28v=vs.103%29.aspx)指出

> 如果你不使用以调度器为参数的重载，Rx 将使用最小并发原则选择一个默认调度器。这意味着选择引入满足操作员需求的最少并发量的调度程序。例如，对于返回带有有限且少量消息的 observable 的操作符，Rx 调用 Immediate。对于返回可能大量或无限数量的消息的运算符，调用 CurrentThread。对于使用计时器的运算符，使用 ThreadPool。

我实际上想要一份参考表，可观察操作员使用哪个默认调度程序，但我在任何地方都找不到。**每个可观察运算符的默认调度程序是什么？**

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2013-03-13T21:07:19.927

哇，这不是微不足道的发现......

在命名空间的深处`System.Reactive.Concurrency`，有一个名为 的内部静态类`SchedulerDefaults`，它被声明为：

```
internal static class SchedulerDefaults
{
    internal static IScheduler AsyncConversions 
    { get { return DefaultScheduler.Instance; }}

    internal static IScheduler ConstantTimeOperations 
    { get { return ImmediateScheduler.Instance; }}

    internal static IScheduler Iteration 
    { get { return CurrentThreadScheduler.Instance; }}

    internal static IScheduler TailRecursion 
    { get { return ImmediateScheduler.Instance; }}

    internal static IScheduler TimeBasedOperations 
    { get { return DefaultScheduler.Instance; }}
} 
```

`AsyncConversions`被使用：

```
Start, ToAsync, FromAsyncPattern 
```

`ConstantTimeOperations`被使用：

```
Empty, GetSchedulerForCurrentContext, Return, StartWith, Throw 
```

`Iteration`被使用：

```
Generate, Range, Repeat, TakeLast, ToObservable, and the ReplaySubject<T> 
```

`TailRecursion`被使用：

```
Run 
```

`TimeBasedOperations`被使用：

```
Buffer, Delay, DelaySubscription, Generate, Interval, Sample, Skip, SkipLast
SkipUntil, Take, TakeLast, TakeLastBuffer, TakeUntil, Throttle, TimeInterval,
Timeout, Timer, Timestamp, Window 
```

# android - 网站未在 WebView 中加载（可能是 JavaScript 问题）

> ID：15341867
> 
> 赞同：-3
> 
> 时间：2013-03-11T15:03:36.677
> 
> 标签：android, webview, web

:) 所以我正在尝试设计一个应用程序，但我遇到了一个我找不到解决方案的问题。

基本上，我设计了一个浏览器应用程序，以加载一个特定的网站--> [http://www.medishala.org/moonstone13/](http://www.medishala.org/moonstone13/) 但不是加载整个页面，它只给我左角的标志，没有别的.. 其他网站加载良好，仅在这一方面面临这个问题。谁能帮帮我？？问题可能是javascript与android不兼容...有人可以提出解决方法吗？谢谢。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:07:17.343

我认为默认情况下在 WebView 中禁用 JavaScript。

尝试启用它：

```
//set JavaScript enabled
mywebview.getSettings().setJavaScriptEnabled(true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:11:48.600

我使用此代码并获得了完整的网站。这是代码：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    this.getWindow().requestFeature(Window.FEATURE_PROGRESS);
    setContentView(R.layout.placement_layout);
    showResults();
}

@SuppressLint("SetJavaScriptEnabled")
private void showResults() {
    getWindow().setFeatureInt(Window.FEATURE_PROGRESS,
            Window.PROGRESS_VISIBILITY_ON);
    mWebView = (WebView) findViewById(R.id.MyWebview);
    mWebView.getSettings().setJavaScriptEnabled(true);
    mWebView.getSettings().setBuiltInZoomControls(false);
    String url = "http://www.medishala.org/moonstone13/";
    Log.d("Link", url);
    mWebView.loadUrl(url);
    final Activity MyActivity = this;
    mWebView.setWebChromeClient(new WebChromeClient() {
        public void onProgressChanged(WebView view, int progress) {
            MyActivity.setTitle("Loading...");
            MyActivity.setProgress(progress * 100);
            if (progress == 100)
                MyActivity.setTitle(R.string.app_name);
        }
    });
}

protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    finish();
} 
```

# css - MVC Webgrid，是否可以将css样式添加到单个列标题？

> ID：15341875
> 
> 赞同：1
> 
> 时间：2013-03-11T15:04:04.890
> 
> 标签：css, asp.net-mvc-3, webgrid

我正在使用 MVC4 和 WebGrid 控件。

我需要将 CSS 样式应用于**除第一列之外的所有列标题**

目前我的代码是：

```
@{
   Webgrid grid = new WebGrid(Model.entrySheet.data);
   grid.GetHtml(columns:Model.columns,headerStyle:"webgridHeader");
 } 
```

这会将 css 样式“webgridHeader”应用于**所有**列。

无论如何设置每个标题列标题的个人样式？

我宁愿使用非 JavaScript 解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:08:39.387

不知道它应该有多动态。`:nth-child(x)`但是如果列的数量是固定的，你可以通过在 css 中使用得到你想要的。当然，较旧的浏览器不理解这一点。

或者，如果它只是第一列，您可以使用`:first-child`更多浏览器都知道的pseduo类，据我所知甚至是IE7。

# jsf - 如何在 ManagedBean 中注入 CDI Bean？

> ID：15341877
> 
> 赞同：6
> 
> 时间：2013-03-11T15:04:05.157
> 
> 标签：jsf, jakarta-ee, ejb, java-ee-6, cdi

我想使用注解@Inject 或@Produce 在ManagedBean 中注入一个CDI Bean。我使用的 CDI Bean 是：

```
@Named
@Startup
@ApplicationScoped
public class BaseBean {

private List<String> custs;

public List<String> getCusts() {
    return custs;
}

public void setCusts(List<String> emps) {
    this.custs = emps;
}

public BaseBean(){

}

@PostConstruct
void init() {
    custs = new ArrayList<String>();
    custs.add("Cust1");
    custs.add("Cust3");
    custs.add("Cust2");
    custs.add("Cust4");
}

} 
```

我要在其中注入 CDI Bean 的 ManagedBean 是：

```
@SessionScoped
@ManagedBean
public class Hello implements Serializable {

@Inject
private BaseBean dBean;

private static final long serialVersionUID = 1L;
private List<String> customers;
private List<String> customersSelect;

public Hello() {
}

@PostConstruct
void init() {
//  dBean = new BaseBean();
    customers = dBean.getCusts();
}

public List<String> getCustomers() {
    return customers;
}

public List<String> getCustomersSelect() {
    return customersSelect;
}

public void setCustomersSelect(List<String> customersSelect) {
    this.customersSelect = customersSelect;
}
} 
```

然而，在 init 函数中，它会抛出 NullPointerException。如果我使用注解@Produces 而不是@Inject，结果是一样的：NullPointerException。CDI Bean 有什么问题（不正确的注释）吗？我是否尝试以错误的方式注入它？我的代码缺少什么吗？我怎样才能让它工作？这是JSF代码：

```
<h:form id ="f">
    <h:selectManyCheckbox layout="pageDirection" border="1"  value="#{hello.customersSelect}">
        <f:selectItems value="#{hello.customers}"></f:selectItems>
    </h:selectManyCheckbox><br />
    <h:commandButton action="response.xhtml" value="Click me" />
</h:form> 
```

PS：如果我使用无状态 Bean 作为 BaseBean 并使用注解 @EJB 注入它，则它可以正常工作。

**更新：**我已经在注释`@SessionScoped`（`javax.enterprise.context.SessionScoped`）和课堂`@Named`上尝试过。`Hello`虽然我没有收到 a `NullPointerException`，但`h:selectManyCheckbox`它是空的。此外，令我震惊的是，当我在文件夹`beans.xml`下添加文件时`META-INF`，我收到一个`StartException`，尽管该文件应该存在。我认为我的应用程序缺少能够进行依赖注入的正确配置。什么可能需要额外的配置？

**更新 2：**当我在 WEB-INF 文件夹中添加 beans.xml 文件时出现此错误。beans.xml 文件是空的，它只包含以下行：

```
<?xml version="1.0" encoding="UTF-8"?> 
```

错误是：

```
Services which failed to start:      service jboss.deployment.unit."JSF1.war".PARSE: org.jboss.msc.service.StartException in service jboss.deployment.unit."JSF1.war".PARSE: Failed to process phase PARSE of deployment "JSF1.war"

12:51:11,482 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) {"JBAS014653: Composite operation failed and was rolled back. Steps that failed:" => {"Operation step-2" => {"JBAS014671: Failed services" => {"jboss.deployment.unit.\"JSF1.war\".PARSE" => "org.jboss.msc.service.StartException in service jboss.deployment.unit.\"JSF1.war\".PARSE: Failed to process phase PARSE of deployment \"JSF1.war\""}}}} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-11T17:20:15.657

如果您`@Named`在 CDI bean 上使用，@patlov 的建议将起作用。但是，如果您在支持 CDI 的环境中工作，**请不要使用`@ManagedBean`**. 相反，一直使用 CDI。看到这个[答案](https://stackoverflow.com/questions/2930889/are-managedbeans-obsolete-in-javaee6-because-of-named-in-cdi-weld)，我相信你会找到许多其他强烈反对你尝试做的事情的答案。

只需从`javax.faces.bean.SessionScoped`to切换`javax.enterprise.context.SessionScoped`，一切都会神奇地工作。但是，您可能会遇到`@ViewScoped`缺少 CDI 的情况，在这种情况下，请使用 JBoss Seam 或 Apache Deltaspike 之类的工具来为您实现它。作为一个额外的好处，如果您已经为 JSF 编写了现有代码，它们还会自动将所有 JSF 范围替换为 CDI 范围。

**更新：** 这应该是 beans.xml 的内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/beans_1_0.xsd">
</beans> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T15:17:13.613

通过将`WEB-INF/beans.xml`文件放入应用程序中，确保您已启用 CDI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T15:12:55.217

如果您使用`@ManagedBean`use`@ManagedProperty`来注入属性：

```
@ManagedProperty(value = "#{baseBean}")
private BaseBean dBean;

// getter and setter 
```

# c# - 实例化后如何找到log4net实例？

> ID：15341878
> 
> 赞同：3
> 
> 时间：2013-03-11T15:04:06.457
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-4, log4net

我在 mvc4 应用程序中使用 log4net（用于学术目的）。我在方法的*global.asax*中调用了这个`Application_Start()`方法。

```
log4net.Config.XmlConfigurator.Configure(); 
```

然后在我的应用程序的任何控制器中，我都可以调用此方法：

```
 ILog _logger = LogManager.GetLogger(typeof(T)); 
```

问题是当我在`Configure()`方法中调用方法时`Application_Start()`，但我没有在任何变量中存储对它的引用，该`GetLogger()`方法如何知道在哪里查找，更准确地说，它在哪里找到 log4net 实例？

就个人而言，我无法想象通往它的路径（除非我知道它被加载的内存位置）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:12:05.543

Log4net 将对它的引用存储在静态变量中。该`GetLogger`方法可以访问该变量并返回适当的值。（实际上，我有点过于简化了。有关完整详细信息，请参阅 log4net 源代码。）

这是[单例模式](http://en.wikipedia.org/wiki/Singleton_pattern)的变体。

顺便说一句，您可以让 log4net 创建多个记录器实例（正如我所说，它是单例的一种变体）。为此，请通过[logger 元素](http://logging.apache.org/log4net/release/manual/configuration.html#loggers)配置其他记录器，然后将您通过该元素的`name`属性分配的名称传递给`LogManager.GetLogger()`. 该`GetLogger`方法将使用传递给它的名称作为适当静态记录器实例的查找键，并在您第一次请求时创建该实例。

# c# - IQueryable 和 IEnumerable 中 .Count() 的区别

> ID：15341879
> 
> 赞同：0
> 
> 时间：2013-03-11T15:04:06.863
> 
> 标签：c#, linq, entity-framework

我有我要传递给函数的对象列表，我想在里面计算它们。当我使用 IQueryable() 时，它不会正确计算它们，但是当我使用 IEnumerable() 时，它会计算它们。

```
public int functCount(IQueryable<MyObject> myLisfOfObjects)  
{
    int numberOfItems = myListOfObjects.Count(o => o.isSet); //isSet is bool property in my object
    return numberOfItem;
} 
```

第一次调用它返回正确数量的项目，但是当我更改列表中某些元素的 isSet 属性时，它返回与第一次调用相同的数字。

```
public int functCount(IEnumerable<MyObject> myLisfOfObjects)  
    {
        int numberOfItems = myListOfObjects.Count(o => o.isSet); //isSet is bool property in my object
        return numberOfItem;
    } 
```

但是当我将代码更改为此时，它每次都会返回正确的计数。

谁能解释我的区别，为什么会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T15:13:10.630

由于您传递给其中任何一个函数的任何内容都不会导致编译错误，因此可以安全地假设它是`IQueryable`. 这意味着`.Count()`它将被重新评估为 SQL 语句并针对数据库运行（忽略您认为在内存中所做的任何更改）。然而，调用`.Count()`是`IEnumerable`调用完全不同的方法，它将简单地返回内存中集合的计数。

换句话说`IEnumerable<T>.Count()`，and`IQueryable<T>.Count()`是两种完全不同的方法，做不同的事情。

# c# - yield return return 是什么样的类

> ID：15341882
> 
> 赞同：9
> 
> 时间：2013-03-11T15:04:13.930
> 
> 标签：c#

所以我注意到这段代码有效：

```
class Program
{
    public static void Main()
    {
        Int32[ ]numbers = {1,2,3,4,5};

        using (var enumerator = Data().GetEnumerator())
        {

        }
    }

    public static IEnumerable<String> Data()
    {
        yield return "Something";
    }
} 
```

特别是，我对这个`using`街区很好奇，因为：

```
Int32[] numbers = { 1, 2, 3, 4, 5, 6 };

using (var enumerator = numbers.GetEnumerator())
{

} 
```

因编译器错误而失败。显然，`yield return`返回的类是`IDisposable`常规数组枚举器，而不是。所以现在我很好奇：究竟`yield return`创造了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-11T15:05:30.577

`IEnumerator<T>`实现`IDisposable`，如您在对象浏览器或 MSDN 中所见。

非泛型`IEnumerator`没有。

基`Array`类实现`IEnumerable`但不实现`IEnumerable<T>`。（因为`Array`不是通用的）
具体的数组类型确实实现了`IEnumerable<T>`，但它们`GetEnumerator()`显式地实现了（我不确定为什么）。
因此，`GetEnumerator()`任何数组类型上的可见都返回`IEnumerator`.

通用`IEnumerable<T>`实现返回一个`System.SZArrayHelper.SZGenericArrayEnumerator<T>`.

此类 (in `Array.cs`) 的源代码具有以下注释，部分解释了这一点（请记住，对泛型数组的所有支持都可以追溯到`IEnumerable<T>`不违反规则的时代）

```
//--------------------------------------------------------------------------------------- 
// ! READ THIS BEFORE YOU WORK ON THIS CLASS. 
//
// The methods on this class must be written VERY carefully to avoid introducing security holes. 
// That's because they are invoked with special "this"! The "this" object
// for all of these methods are not SZArrayHelper objects. Rather, they are of type U[]
// where U[] is castable to T[]. No actual SZArrayHelper object is ever instantiated. Thus, you will
// see a lot of expressions that cast "this" "T[]". 
//
// This class is needed to allow an SZ array of type T[] to expose IList<T>, 
// IList<T.BaseType>, etc., etc. all the way up to IList<Object>. When the following call is 
// made:
// 
//   ((IList<T>) (new U[n])).SomeIListMethod()
//
// the interface stub dispatcher treats this as a special case, loads up SZArrayHelper,
// finds the corresponding generic method (matched simply by method name), instantiates 
// it for type <T> and executes it.
// 
// The "T" will reflect the interface used to invoke the method. The actual runtime "this" will be 
// array that is castable to "T[]" (i.e. for primitivs and valuetypes, it will be exactly
// "T[]" - for orefs, it may be a "U[]" where U derives from T.) 
//--------------------------------------------------------------------------------------- 
```

# jquery - 一次调用更改两个输入之一

> ID：15341899
> 
> 赞同：10
> 
> 时间：2013-03-11T15:04:50.560
> 
> 标签：jquery

我在页面中有下面的代码，如果两个文本字段之一发生更改，则使用两者的值调用一个函数。
该代码工作得很好，但为了提高效率，我想知道是否可以将其归结为单个代码块。

```
$('#popfrom').change(function(){
    var popfrom = $('#popfrom').val();
    var poptill = $('#poptill').val();

    defineDate(popfrom, poptill);
});

$('#poptill').change(function(){
    var popfrom = $('#popfrom').val();
    var poptill = $('#poptill').val();

    defineDate(popfrom, poptill);
}); 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-11T15:06:47.310

JQuery 允许多个选择器，以逗号分隔：

```
$('#popfrom, #poptill').change(function(){ ... 
```

如果您发现需要使用多个元素，通常使用类名更容易。将一类“popfields”添加到您的输入中，您可以简单地使用：

```
$('.popfields').change(function(){ ... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-11T15:07:02.663

将它们添加到同一个类中，然后执行。

```
$('.popClass').change(function(){
    var popfrom = $('#popfrom').val();
    var poptill = $('#poptill').val();

    defineDate(popfrom, poptill);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T15:09:26.060

向两个字段添加相同的类并使用 jQuery '.selector' 选择它们

```
$('.classOfTheTextFiled').change(function(){ .... 
```

:)

# objective-c - 从 UITouch 调用 UITableView 方法

> ID：15341900
> 
> 赞同：0
> 
> 时间：2013-03-11T15:04:51.093
> 
> 标签：objective-c, xcode, uitableview, uitouch

我有一个带有海关单元格的表格，它有子类`UITableViewCells`和我使用的控制触摸`UITouch`（基于本教程的代码[http://gregprice.co.uk/blog/?p=280](http://gregprice.co.uk/blog/?p=280)）我需要内部`touchesEnded`方法获取单元格的索引，它是触碰。

我尝试：

```
-(void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {

   //some code

   UITableView *parentTable = (UITableView *)self.superview;
   NSIndexPath *index = [NSIndexPath alloc];
   index = [parentTable indexPathForSelectedRow];
   NSLog(@"Call, x= %f, index=%d", xPos, index.row);

} 
```

但我总是有 index=0。

我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:12:46.467

不确定这是否会导致问题，但像您在这里一样调用“alloc”是一种不好的做法。我将删除带有 alloc 的行（因为这是为您未初始化或使用的对象创建内存），并且仅在线定义了 NSIndexPath 对象：

```
UITableView *parentTable = (UITableView *)self.superview;
NSIndexPath *index = [parentTable indexPathForSelectedRow];
NSLog(@"Call, x= %f, index=%d", xPos, index.row); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:37:47.320

似乎您正在采取一种非常全面的方式来选择 UITableView 中的一行。将 UITableView 的委托和数据源设置为您正在使用的类，然后实现其协议方法，您可以在 UITableViewDelegate 和 UITableViewDataSource 参考中找到这些方法。完成后，您可以使用此方法确定在表中选择了哪一行

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
} 
```

也许您已经知道这一点，但听起来您是 iOS 开发的新手，我不明白您为什么要手动这样做。

并且正如戴夫莱弗顿的回答所说，不要做这样的分配

# java - jqGrid 过滤器工具栏在 jQuery 选项卡中不起作用

> ID：15341901
> 
> 赞同：1
> 
> 时间：2013-03-11T15:04:55.120
> 
> 标签：java, javascript, jquery, jqgrid

我在这里遇到了一个奇怪的问题。

我已将 jqGrids 放置在 jQuery 选项卡内。以下是截图：

![在此处输入图像描述](../Images/2da73c2bcd36c781aee1305cdc34b94c.png) ![在此处输入图像描述](../Images/32fd03c008d287012a9796906daef672.png)

我正在尝试在我的 jqgrid 中实现过滤器工具栏。但是，每当我在任何一个过滤器工具栏搜索框中输入任何内容时，“加载”弹出窗口都会出现并停留在那里，然后什么也没有发生。下面是截图：

![在此处输入图像描述](../Images/04095810be4041ea2a849998c902f070.png)

在 IE 中它给出了错误：

> jQuery.jgrid 为 null 或不是对象

在 Chrome 中，错误说：

> 未捕获的类型错误：无法调用未定义的方法“getAccessor”

当我删除选项卡时，filtertoolbar 功能可以正常工作。jqGrid 过滤器工具栏和 jQuery 选项卡之间是否有任何问题。

**更新 1**

选项卡 JSP 代码：

```
<script>    
    $(function() {
        $( "#workQueuesTab" ).tabs();
    });    
</script>  
</head>
<body>
      <div style="width:95%" id="workQueuesTab">
          <ul>
              <li><a href="<c:url value="/workQueue/pending"/>">Pending</a></li>
              <li><a href="<c:url value="/workQueue/approved"/>">Approved</a></li>
              <li><a href="<c:url value="/workQueue/additionalSteps"/>">Additional Steps</a></li>
         </ul>
      </div>            
</body> 
```

网格 JSP 代码：

```
<table width="100%">
    <tr>
        <td>
            <span style="font-size: 18px"><b>${status == 'pending' ? 'Pending': 'Approved'}</b></span><br/><br/>
            There are ${workQueueCount} referrals ${status}. Click a row to see details.<a href="<c:url value="/excelExport"/>" id="excelExport" style="float: right;">Export To Excel</a>               
        </td>
    </tr>
    <tr height="5px">
        <td>                            
        </td>
    </tr>
    <tr>
        <td>
            <table id="dartWorkQueueGrid"></table>                              
            <div id="dartWorkQueuePager"></div>
        </td>
    </tr>
</table> 
```

网格 Javascript 代码：

```
 jQuery(document).ready(function($) {

    $('#dartWorkQueueGrid').jqGrid('GridDestroy');
    $("#dartWorkQueueGrid").jqGrid({
        url:contextRoot+'workQueueGrid',
        datatype: 'json',
        jsonReader: {repeatitems: false},
        mtype: 'POST',
        colNames: ['ID','Received','Last Name','First Name','GO','Zone', 'Source', 'Status', 'AS Action', 'VP Report', 'Approved', 'Last Modified', 'Workflow'],
        colModel: [
                   { name: 'referralId', index: 'referralId', width: 30, sortable:true },
                   { name: 'receivedDate', index: 'receivedDate', width: 50, formatter: function(cellValue){return $.datepicker.formatDate('mm-dd-yy', new Date(cellValue));}, sortable:true },                   
                   { name: 'lastName', index: 'lastName', width: 55, sortable:true },
                   { name: 'firstName', index: 'firstName', width: 55, sortable:true },
                   { name: 'goCode', index: 'goCode', width: 30, sortable:true },
                   { name: 'zoneCode', index: 'zoneCode', width: 30, sortable:true },
                   { name: 'sourceName', index: 'sourceName', width: 40, sortable:true, cellattr: function (rowId, tv, rawObject, cm, rdata) { return 'style="white-space: normal;"'; } },
                   { name: 'status', index: 'status', width: 40, sortable:true, cellattr: function (rowId, tv, rawObject, cm, rdata) { return 'style="white-space: normal;"'; } },
                   { name: 'actionAS', index: 'actionAS', width: 30, sortable:true, cellattr: function (rowId, tv, rawObject, cm, rdata) { return 'style="white-space: normal;"'; } },
                   { name: 'vpReportDate', index: 'vpReportDate', width: 50, formatter: function(cellValue){return $.datepicker.formatDate('mm-dd-yy', new Date(cellValue));}, sortable:true },
                   { name: 'approvedDate', index: 'approvedDate', width: 50, formatter: function(cellValue){return $.datepicker.formatDate('mm-dd-yy', new Date(cellValue));}, sortable:true },
                   { name: 'lastModifiedDate', index: 'lastModifiedDate', width: 50, formatter: function(cellValue){return $.datepicker.formatDate('mm-dd-yy', new Date(cellValue));}, sortable:true },
                   { name: 'workflow', index: 'workflow', width: 80, sortable:true, cellattr: function (rowId, tv, rawObject, cm, rdata) { return 'style="white-space: normal;"'; } }
        ],loadError: function(xhr,st,err) {
            alert(err);
        },loadComplete: function (data) {
            var $this = $(this),
            datatype = $this.getGridParam('datatype');
            if (datatype === "xml" || datatype === "json") {
              setTimeout(function () {
                 $this.trigger("reloadGrid");
              }, 10);
           }
        },onSelectRow : function(rowid, status, e) {
            var selRow = $(this).getGridParam("selrow");
            var selReferralId = $(this).getCell(selRow, 'referralId');
            window.location = (contextRoot+"referralDetails?refId=" + selReferralId );            
        },
        pager: '#dartWorkQueuePager',
        sortname: 'receivedDate',
        sortorder: 'desc',
        gridview: true,
        viewrecords: true,
        loadonce: true,
        autowidth: true,
        shrinkToFit: true,
        height: 'auto',
        rowNum: 12,
        ignoreCase: true,
        altRows:true
    }); 

    $("#dartWorkQueueGrid").jqGrid('navGrid','#dartWorkQueuePager',
       {
        edit:false,
        add:false,
        del:false,
        search:false,
        refresh:false
    });

    $("#dartWorkQueueGrid").jqGrid('filterToolbar',
        { 
         stringResult: true, 
         searchOnEnter: false,
         defaultSearch: "cn"
    });
}); 
```

JS的顺序包括：

```
<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/themes/base/jquery-ui.css" />
<link rel="stylesheet" href="<c:url value="/css/ui.jqgrid.css"/>" type="text/css" />
<link rel="stylesheet" href="<c:url value="/css/home.css"/>" type="text/css" />
<link rel="stylesheet" href="<c:url value="/css/styles-nyl.css"/>" type="text/css" />

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script> 
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script> 
<script type="text/javascript" src="http://ajax.microsoft.com/ajax/jQuery.Validate/1.6/jQuery.Validate.min.js"></script>
<script type="text/javascript" src="<c:url value="/js/shared/grid.locale-en.js"/>"></script>
<script type="text/javascript" src="<c:url value="/js/shared/jquery.jqGrid.min.js"/>"></script> 
<script type="text/javascript" src="<c:url value="/js/shared/json2.js"/>"></script>
<script type="text/javascript" src="<c:url value="/js/shared/jquery.loadJSON.js"/>"></script> 
```

**样本数据**

```
 {"rows":[{"receivedDate":1357016400000,"referralId":23450,"lastName":"Smith","firstName":"John","goCode":"A99","zoneCode":"NE","sourceName":"Source Name","status":"Pending","actionAS":"AS Action","vpReportDate":1357016400000,"approvedDate":1357016400000,"lastModifiedDate":1357016400000,"workflow":"Recommendation(s) required"},{"receivedDate":1357102800000,"referralId":23451,"lastName":"Smith","firstName":"John","goCode":"A99","zoneCode":"NE","sourceName":"Source Name","status":"Pending","actionAS":"AS Action","vpReportDate":1357102800000,"approvedDate":1357102800000,"lastModifiedDate":1357102800000,"workflow":"Recommendation(s) required"},{"receivedDate":1357189200000,"referralId":23452,"lastName":"Smith","firstName":"John","goCode":"A99","zoneCode":"NE","sourceName":"Source Name","status":"Pending","actionAS":"AS Action","vpReportDate":1357189200000,"approvedDate":1357189200000,"lastModifiedDate":1357189200000,"workflow":"Recommendation(s) required"}, 
```

我现在被这个问题困扰了好几天，而且无处可去。任何帮助都深表感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:33:19.737

错误

> jQuery.jgrid 为 null 或不是对象

主要意味着您以错误的顺序包含了 jqGrid（`i18n/grid.locale-en.js`和`jquery.jqGrid.min.js`或`jquery.jqGrid.src.js`）或 jQuery JavaScript 文件所需的 JavaScript。您应该将您的代码与jqGrid 文档[中的示例进行比较。](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3afirst_grid#html_file)

此外，我建议您始终包含您使用的 jQuery、jQuery UI 和 jqGrid 的确切版本号。您应该使用`jquery.jqGrid.src.js`（而不是`jquery.jqGrid.min.js`）进行测试并发布错误*的行号*。

**更新**：对不起，但我无法重现您描述的问题。请参阅[演示](http://www.ok-soft-gmbh.com/jqGrid/tarares.htm)。您可以将演示的来源与青春一号进行比较。可能您还有一些未包含在问题文本中的差异。

# javascript - 如何在没有jslint哭犯规的情况下在javascript中转义引用

> ID：15341906
> 
> 赞同：2
> 
> 时间：2013-03-11T15:05:09.217
> 
> 标签：javascript, maven-3, jslint, yui-compressor

我将如何在以下代码行中转义引号，以便 jslint 不会对其发出警告。目前它会在此行上引发“未关闭的字符串”警告。

```
 input = input.replace(/""/g,"\\\""); 
```

我正在使用 maven yuicompressor 插件来缩小 js & css 并使用 jslint 检查 js 文件。这是我的插件配置。

```
 .....
    <plugin>
          <groupId>net.alchim31.maven</groupId>
          <artifactId>yuicompressor-maven-plugin</artifactId>
          <executions>
            <execution>
              <phase>package</phase>
              <goals>
                <goal>compress</goal>
                <goal>jslint</goal>
              </goals>
            </execution>
          </executions>
          <configuration>
            <nosuffix>true</nosuffix>                   
            <excludes>                  
              <exclude>**/*.min.js</exclude>
              <exclude>**/*.min.css</exclude>
            </excludes>
          </configuration>
    </plugin>
    ....... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T17:58:12.270

我不知道这在技术上是否是一个答案，但是当我收到此错误时，我使用的是 1.3.0 版本。升级到版本 1.3.4 修复了该问题，并且不再在该行显示 jslint 错误。

# mfc - CMFCButton::SetToolTip(str) 在 OnInitDialog() 和

> ID：15341908
> 
> 赞同：2
> 
> 时间：2013-03-11T15:05:14.460
> 
> 标签：mfc

我希望我的 CMFCButton 在鼠标悬停时显示工具提示。如果我在 OnInitDialog 中使用 SetToolTip() 方法，它不起作用

```
CMFCButton* bt = ((CMFCButton*)GetDlgItem(IDC_MFCBUTTON1)); 
bt->SetTooltip(_T("tooltip")); 
```

但是，如果我将此代码放入消息句柄函数中，就像另一个按钮的单击句柄一样，它确实有效。我想要的是 CMFCButton 可以在创建对话框时显示工具提示，我应该把这些代码放在哪里？

======================== 顺便说一句，我在属性视图中设置的工具提示文本大部分时间都不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-07T18:01:08.173

我刚刚派生了一个类

```
class CMyButton : public CMFCButton
{
public:
    void SetDelayFullTextTooltipSet(bool DelayFullTextTooltipSet)
    {
        m_bDelayFullTextTooltipSet = DelayFullTextTooltipSet;
    }
}; 
```

`CMFCButton`我使用按钮而不是 Dialog 类上的变量，现在我有一个`CMyButton`.

在电话`OnInitDialog`之后`SetTooltip`，我做

```
button.SetDelayFullTextTooltipSet(FALSE); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T16:53:19.013

您是否调用了基类的 OnInitDialog()？要点是需要在调用 SetToolTip() 之前创建控件。使用调试器进入 OnInitDialog() 并查看控件的 m_hWnd 在您调用 SetToolTip() 时是否有值。

# javascript - 如何从 Blob 转到 ArrayBuffer

> ID：15341912
> 
> 赞同：131
> 
> 时间：2013-03-11T15:05:17.470
> 
> 标签：javascript, blob, arraybuffer

我正在研究 Blob，我注意到当您有一个 ArrayBuffer 时，您可以轻松地将其转换为 Blob，如下所示：

```
var dataView = new DataView(arrayBuffer);
var blob = new Blob([dataView], { type: mimeString }); 
```

我现在的问题是，是否可以从 Blob 转到 ArrayBuffer？

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2013-04-12T21:19:09.937

您可以使用`FileReader`作为.`Blob``ArrayBuffer`

这是一个简短的示例：

```
var arrayBuffer;
var fileReader = new FileReader();
fileReader.onload = function(event) {
    arrayBuffer = event.target.result;
};
fileReader.readAsArrayBuffer(blob); 
```

这是一个更长的例子：

```
// ArrayBuffer -> Blob
var uint8Array  = new Uint8Array([1, 2, 3]);
var arrayBuffer = uint8Array.buffer;
var blob        = new Blob([arrayBuffer]);

// Blob -> ArrayBuffer
var uint8ArrayNew  = null;
var arrayBufferNew = null;
var fileReader     = new FileReader();
fileReader.onload  = function(event) {
    arrayBufferNew = event.target.result;
    uint8ArrayNew  = new Uint8Array(arrayBufferNew);

    // warn if read values are not the same as the original values
    // arrayEqual from: http://stackoverflow.com/questions/3115982/how-to-check-javascript-array-equals
    function arrayEqual(a, b) { return !(a<b || b<a); };
    if (arrayBufferNew.byteLength !== arrayBuffer.byteLength) // should be 3
        console.warn("ArrayBuffer byteLength does not match");
    if (arrayEqual(uint8ArrayNew, uint8Array) !== true) // should be [1,2,3]
        console.warn("Uint8Array does not match");
};
fileReader.readAsArrayBuffer(blob);
fileReader.result; // also accessible this way once the blob has been read 
```

这在 Chrome 27-69、Firefox 20-60 和 Safari 6-11 的控制台中进行了测试。

这里还有一个你可以玩的现场演示：[https ://jsfiddle.net/potatosalad/FbaM6/](https://jsfiddle.net/potatosalad/FbaM6/)

**2018 年 6 月 23 日更新：**感谢 Klaus Klein 关于`event.target.result`vs的提示`this.result`

参考：

*   [https://developer.mozilla.org/en-US/docs/Web/API/FileReader#readAsArrayBuffer()](https://developer.mozilla.org/en-US/docs/Web/API/FileReader#readAsArrayBuffer())
*   [https://www.w3.org/TR/FileAPI/#dfn-readAsArrayBuffer](https://www.w3.org/TR/FileAPI/#dfn-readAsArrayBuffer)

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2019-03-17T06:45:03.053

[`Response`](https://developer.mozilla.org/en-US/docs/Web/API/Response)API 使用一个（不可变的），[`Blob`](https://developer.mozilla.org/en-US/docs/Web/API/Blob/)可以通过多种方式从中检索数据。*OP*只要求，这`ArrayBuffer`是一个演示。

```
var blob = GetABlobSomehow();

// NOTE: you will need to wrap this up in a async block first.
/* Use the await keyword to wait for the Promise to resolve */
await new Response(blob).arrayBuffer();   //=> <ArrayBuffer> 
```

或者你可以使用这个：

```
new Response(blob).arrayBuffer()
.then(/* <function> */); 
```

* * *

> **注意：**此*API与旧（**古老*）浏览器不兼容，因此请查看[**浏览器兼容性表**](https://developer.mozilla.org/en-US/docs/Web/API/Response#Browser_compatibility)以确保安全；）

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2018-08-09T03:00:21.637

或者你可以使用 fetch API

```
fetch(URL.createObjectURL(myBlob)).then(res => res.arrayBuffer()) 
```

我不知道性能差异是什么，这也会显示在 DevTools 的网络选项卡上。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2017-10-02T13:03:23.513

只是为了补充@potatosalad 先生的回答。

您实际上不需要访问函数**范围**来获取**onload**回调的结果，您可以自由地对**event**参数执行以下操作：

```
var arrayBuffer;
var fileReader = new FileReader();
fileReader.onload = function(event) {
    arrayBuffer = event.target.result;
};
fileReader.readAsArrayBuffer(blob); 
```

为什么这样更好？因为那样我们可以使用箭头函数而不会丢失上下文

```
var fileReader = new FileReader();
fileReader.onload = (event) => {
    this.externalScopeVariable = event.target.result;
};
fileReader.readAsArrayBuffer(blob); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2020-08-24T20:28:43.517

`await blob.arrayBuffer()`很好。

问题是何时需要 iOS / Safari 支持.. 因为那个人需要[这个](https://pastebin.com/raw/aZgaz8vm)：

```
Blob.prototype.arrayBuffer ??=function(){ return new Response(this).arrayBuffer() } 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2020-02-13T06:51:54.433

现在（Chrome 76+ 和 FF 69+）有一个[Blob.prototype.arrayBuffer](https://developer.mozilla.org/en-US/docs/Web/API/Blob/arrayBuffer#Browser_compatibility) [()](https://developer.mozilla.org/en-US/docs/Web/API/Blob/arrayBuffer)方法，它将返回一个 Promise 解析，其中 ArrayBuffer 表示 Blob 的数据。

```
(async () => {
  const blob = new Blob(['hello']);
  const buf = await blob.arrayBuffer();
  console.log( buf.byteLength ); // 5
})();
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2021-02-12T07:32:49.373

这是一个异步方法，它首先检查方法的可用性`arrayBuffer`。此功能向后兼容且面向未来。

```
async function blobToArrayBuffer(blob) {
    if ('arrayBuffer' in blob) return await blob.arrayBuffer();

    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.onerror = () => reject;
        reader.readAsArrayBuffer(blob);
    });
} 
```

# java - 如何在 php 中显示 http_post？

> ID：15341914
> 
> 赞同：-1
> 
> 时间：2013-03-11T15:05:21.997
> 
> 标签：java, php, android

我在我的 android 项目中发送了这个 http_post xml：

```
try {
            xml_input();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            Log.e("Hiba!", "Xml_input fgv hivasa");
        }

        // TODO Auto-generated method stub
        HttpPost httppost = new HttpPost("http://users.atw.hu/festivale/xml_post.php");
        StringEntity se;
        try {
            se = new StringEntity(globalconstants.xml_out, HTTP.UTF_8);
            se.setContentType("text/xml");
            httppost.setHeader("Content-Type",
                    "application/soap+xml;charset=UTF-8");
            httppost.setEntity(se);

            HttpClient httpclient = new DefaultHttpClient();
            BasicHttpResponse httpResponse = (BasicHttpResponse) httpclient
                    .execute(httppost);

            HttpEntity r_entity = httpResponse.getEntity();
            String xmlString = EntityUtils.toString(r_entity);

            System.err.println("Error...." + xmlString);
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } 
```

*   我怎样才能在我的 php 网站上显示这个？
*   如果我想要一些规则等发送到服务器，这是一个很好的 xml 发送吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:11:24.590

您可以使用php.ini 中的超全局关联数组访问`http_post`数据。`$_POST`喜欢-

```
echo $_POST['foo']; 
```

# java - 跟踪 Minimax 的最佳移动

> ID：15341917
> 
> 赞同：0
> 
> 时间：2013-03-11T15:05:23.820
> 
> 标签：java, recursion, minimax, alpha-beta-pruning

我知道以前有人问过这种问题，但我无法解决我的疑问。我有一个简单的黑白棋引擎（实际上它玩得很好），它使用下面的类来获得最好的移动：

```
import java.util.*;
import java.util.concurrent.*;

public class MinimaxOthello implements Runnable
{
  private CountDownLatch doneSignal;    
  private int maxDepth;
  private int calls;    
  private OthelloMove bestFound;
  private OthelloBoard board;
  private static float INFINITY = Float.MAX_VALUE/1000;    
  private boolean solve = false;
  private Comparator<OthelloMove> comparator = Collections.reverseOrder(new MoveComparator());

public MinimaxOthello (OthelloBoard board, int maxDepth, CountDownLatch doneSignal, boolean solve)
{
    this.board = board;        
    this.bestFound = new OthelloMove();
    bestFound.setPlayer(board.getCurrentPlayer());
    this.maxDepth = maxDepth; 
    this.doneSignal = doneSignal;                
    this.solve = solve;
}

public OthelloMove getBestFound()
{       
    return this.bestFound;
}
public void run()
{        
    float val = minimax(board, bestFound, -INFINITY, INFINITY, 0);
    System.out.println("calls: " + calls);
    System.out.println("eval: " + val);
    System.out.println();
    doneSignal.countDown();        
}

private float minimax(OthelloBoard board, OthelloMove best, float alpha, float beta, int depth)
{
    calls++;             
    OthelloMove garbage = new OthelloMove();             
    int currentPlayer = board.getCurrentPlayer();

    if (board.checkEnd())
    {                        
        int bd = board.countDiscs(OthelloBoard.BLACK);
        int wd = board.countDiscs(OthelloBoard.WHITE);

        if ((bd > wd) && currentPlayer == OthelloBoard.BLACK)
        {                
            return INFINITY/10;
        }
        else if ((bd < wd) && currentPlayer == OthelloBoard.BLACK)
        {                
            return -INFINITY/10;
        }
        else if ((bd > wd) && currentPlayer == OthelloBoard.WHITE)
        {                
            return -INFINITY/10;
        }
        else if ((bd < wd) && currentPlayer == OthelloBoard.WHITE)
        {                
            return INFINITY/10;
        }
        else 
        {                
            return 0.0f;
        }
    }
    if (!solve)
    {
        if (depth == maxDepth)
            return OthelloHeuristics.eval(currentPlayer, board);
    }

    ArrayList<OthelloMove> moves = board.getAllMoves(currentPlayer);
    if (moves.size() > 1)
    {
        OthelloHeuristics.scoreMoves(moves);        
        Collections.sort(moves, comparator);
    }

    for (OthelloMove mv : moves)
    {                                    
        board.makeMove(mv);            
        float score = - minimax(board, garbage, -beta,  -alpha, depth + 1);           
        board.undoMove(mv);             

        if(score > alpha)
        {  
            alpha = score;                
            best.setFlipSquares(mv.getFlipSquares());
            best.setIdx(mv.getIdx());        
            best.setPlayer(mv.getPlayer());                              
        }

        if (alpha >= beta)
            break;                

    }            
    return alpha;
 }  
} 
```

我有一个*bestFound*实例变量，我的疑问是，为什么必须调用

```
OthelloMove garbage = new OthelloMove(); 
```

并传递它？该代码有效，但对我来说似乎很奇怪！

是否有“更好”的方法来获得最佳移动或主要变化？我真的不是递归专家，这很难调试和可视化。谢谢！

**PS：您可以在[https://github.com/fernandotenorio/克隆它](https://github.com/fernandotenorio/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:13:24.920

看起来你可以去掉`best`参数 to `minimax`，从而省去 for `garbage`，然后替换`best`为`this.bestFound`。`bestFound`如果 depth = 0，则仅设置的属性。

您可以通过制作`this.bestFound`一个最初为空的列表来获得主要变体。在`moves`循环之前，创建一个新的移动。在`if (score > alpha)`零件中，将其属性设置为与现在相同。在循环之后立即将移动推送到列表。主要的变化将是列表的反面。

如果它很重要，您可以进行一些更改以提高类的多线程性：

*   与其将`bestFound`列表存储为实例变量，不如将其设为局部变量`run`并将其作为参数添加到`minimax`
*   不要`Board.makeMove`修改棋盘，而是返回一个新的棋盘实例并应用移动。您可以通过克隆板并将移动代码应用于克隆而不是 mutating 来实现这一点`this`。然后，将克隆的棋盘传递给 minimax 的下一个调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:24:41.997

的第二个参数`minimax`用于返回最佳移动。

该业务`garbage`用于保持每个回合的最佳移动分开。使用您提供的代码，这并不重要。但是如果你想产生从当前棋盘到游戏结束的一系列移动，你需要让它们成为单独的移动对象。

为每个回合使用单独的最佳移动对象允许您使用线程执行许多技巧。首先，您可能想要限制奥赛罗 AI 的思考时间。在每个级别分别跟踪最佳移动意味着您始终拥有迄今为止可用的最佳移动。这也意味着您可以缓存棋盘的最佳移动，并在未来的极小极大搜索中查找。

其次，您可能希望并行搜索最佳移动，当每个极小极大调用独立时，这很容易实现。

# gitlab - 如何从 GitLab CI 获取构建状态？

> ID：15341918
> 
> 赞同：10
> 
> 时间：2013-03-11T15:05:24.040
> 
> 标签：gitlab

我想在 cap 部署场景中添加检查构建状态的`GitLab CI`.

可能吗？

是否`GitLab CI`有一些 API 可以通过提交获取构建/管道状态`SHA`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2017-08-28T15:20:00.490

现在您可以从此网址获取徽章：

```
https://gitlab.com/[namespace]/[project]/badges/[branch]/pipeline.svg 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-11T15:13:11.890

[GitLab CI](https://github.com/gitlabhq/gitlab-ci)基于[Travis](https://travis-ci.org/)，提供[构建状态 url](http://about.travis-ci.org/docs/user/status-images/)甚至构建状态图片：

```
https://travis-ci.org/[YOUR_GITHUB_USERNAME]/[YOUR_PROJECT_NAME].png
# or, limited to some branches
https://travis-ci.org/[YOUR_GITHUB_USERNAME]/[YOUR_PROJECT_NAME].png?branch=master,staging,production 
```

[Joran Beasley](https://stackoverflow.com/users/541038/joran-beasley)提到了网址：

```
http://gitlabci.example.com/projects/2/status.png?ref=master 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-11T15:15:33.403

我找到了这样的链接[http://some.domain/projects/:ID/builds/:SHA/status](http://some.domain/projects/:ID/builds/:SHA/status)。问题已解决

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-07-09T09:05:25.610

*您可以在Pipelines 设置*页面上找到构建徽章信息，即

```
https://<your-gitlab-installation-domain>/<group-name>/<repository-name>/settings/ci_cd 
```

对于特定的存储库：

1.  转到**设置**> **CI / CD**
2.  展开**常规管道设置**部分
3.  向下滚动到**管道状态**和/或**覆盖率报告**
4.  选择你的分支
5.  复制你需要的任何东西（Markdown，也许）

供参考，请参阅：

*   [https://docs.gitlab.com/ee/ci/pipelines.html#badges](https://docs.gitlab.com/ee/ci/pipelines.html#badges)
*   [https://docs.gitlab.com/ee/user/project/pipelines/settings.html](https://docs.gitlab.com/ee/user/project/pipelines/settings.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-02-19T07:08:52.640

# API

从 GitLab 8.1 开始，有新的提交状态 API。

[GitLab CI 提交 API](https://docs.gitlab.com/ee/api/commits.html) v4：

[列出提交的状态](https://docs.gitlab.com/ee/api/commits.html#list-the-statuses-of-a-commit)

```
curl --header "PRIVATE-TOKEN: <your_access_token>" "https://gitlab.example.com/api/v4/projects/17/repository/commits/18f3e63d05582537db6d183d9d557be09e1f90c8/statuses 
```

Ps GitLabs 令牌在[个人访问令牌](https://gitlab.com/profile/personal_access_tokens)页面 ( `https://gitlab.example.com/profile/personal_access_tokens`)中进行管理

# `glab`和`lab`

有两个很棒的工具可以使用`GitLab`：

*   [zaquestion](https://github.com/profclems/glab) [/lab：Lab 包装了 Git 或 Hub，使得克隆、分叉和与 GitLab 上的存储库交互变得简单](https://github.com/zaquestion/lab)

> glab和都是[开源](https://github.com/profclems/glab)`lab`工具，其目标相同是将 GitLab 引入您的命令行并简化开发人员的工作流程。在许多方面`lab`是[集线器](https://github.com/github/hub)，[glab](https://github.com/profclems/glab)是[gh](https://github.com/cli/cli)。
> 
> `lab`旨在让`git`用户感到熟悉并利用`git`它来支持它的许多命令。`glab`由于这个原因，用户会感觉更熟悉`gh`，进而更具交互性并且可能对初学者更友好。

## `lab ci status`

对于 CI 管道的文本表示，`lab`您可能需要：

```
lab ci status [branch] [flags] 
```

### 例子

```
lab ci status
lab ci status upstream 608 --merge-request
lab ci status 600 --wait
lab ci status upstream 125 --merge-request --bridge 'security-tests' 
```

## `glab pipeline status`

对于 CI 管道的文本表示，[`glab`](https://glab.readthedocs.io/en/latest/pipeline/status.html)您可能需要：

`glab pipeline status \[flags\]`

## 例子

```
$ glab pipeline status --live
$ glab pipeline status --branch=master   // Get pipeline for master branch
$ glab pipe status   // Get pipeline for current branch 
```

# hibernate - SchemaExport#execute() 有什么好的文档吗？

> ID：15341922
> 
> 赞同：1
> 
> 时间：2013-03-11T15:05:28.253
> 
> 标签：hibernate

这太疯狂了，但在我查看的所有文档中，都没有写任何解释。

您可以在[文档](http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/tool/hbm2ddl/SchemaExport.html#execute%28boolean,%20boolean,%20boolean,%20boolean%29)中找到以下内容：

> 公共无效执行（布尔脚本，布尔导出，布尔justDrop，布尔justCreate）

也许有人可以在这里记录或分享博客链接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:13:58.837

*   script：如果为 true，则将所需的 SQL 输出到控制台。
*   export：如果为true，则实际*执行*SQL到配置的数据源。
*   justDrop：如果为 true，则仅输出/执行删除数据结构所需的 SQL。
*   justCreate：如果为真，则仅输出/执行创建数据结构所需的 SQL。

# cakephp - CakePHP：为什么我的缓存文件在过期时会引起巨大的峰值？

> ID：15341923
> 
> 赞同：3
> 
> 时间：2013-03-11T15:05:28.547
> 
> 标签：cakephp, caching, cron, cakephp-2.1

我正在使用 cake 2.1.3，目前有一个页面每秒获得数百次查看，因此我使用缓存以更好地处理负载。问题是，一旦缓存过期，我的服务器资源以及数百个 mysql 连接都会激增。

我想知道我是否以错误的方式进行此操作，是否应该运行 cron 来缓存页面而不是我当前的操作方式，或者是否还有其他我没有想到的技术。

这是我的功能在我的控制器中的样子：

```
public function index() {
    $this->layout = 'ajax';

    if (isset($this->params['url']['callback'])) {
        $callback =  $this->params['url']['callback'];
    }else{
        $callback = 'callback';
    }
    $this->set('callback',$callback);

    $today = date("Y-m-d");
    $end_date = strtotime ('+1 day' , strtotime($today)) ;        
    $end_date = date ( 'Y-m-d' , $end_date);

    $start_date = strtotime ('-1 day' , strtotime($today)) ;
    $start_date = date ( 'Y-m-d' , $start_date);

    $total = Cache::read('popular_stories', 'short');
    if (!$total) {
        $total = $this->TrackStoryView->find('all', array(
           'fields' => array('COUNT(story_id) AS theCount', 'headline', 'url'), 
           'conditions' => array('date BETWEEN ? AND ?' => array($start_date,$end_date)),
           'group' => 'story_id',
           'order' => array('theCount DESC'),
           'limit' => 20,
        ));
        Cache::write('popular_stories', $total, 'short');
    }

    $this->set('story', $total);    
} 
```

这是我的缓存配置在我的 bootstrap.php 文件中的样子：

```
Cache::config('short', array(
    'engine' => 'File',
    'duration' => '+60 minutes',
    'path' => CACHE,
    'prefix' => 'cake_short_'
)); 
```

这是我的视图文件中的内容：

`<?php echo $callback . '('.json_encode($story).')'; ?>`

我希望一旦缓存文件过期，一旦第一个人访问它，它就会创建一个新的缓存文件并为每个人提供服务，但是因为每秒有数百人在访问它，所以这种方法似乎是'不适合我，也许我应该以某种方式将视图视图缓存为 cron，或者可能有一种不同的缓存方式，我没有使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T15:07:58.560

**TLDR：**强迫用户为你打破缓存并不理想。使用计时作业或数据更改触发器。

**解释：** “每秒数百次查看”是问题所在。当它过期时，在它试图创建缓存文件期间有“数百个视图”。

第一个人点击它，它开始创建缓存，与此同时，另外一百多人点击它，它看起来，还找不到缓存文件......等等。

如果可以管理，请尝试在更新项目时手动创建缓存，或者运行一个 chron 作业，每 X 分钟创建一个新缓存，而不是让它为用户创建。

Cake 有很多很酷的触发器`afterSave()`，你可以用它们来触发这种事情。但是，如果这对您的情况没有意义，那么计时工作对您来说应该没问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-11T15:18:12.877

听起来您或多或少地找到了答案（自动创建缓存，而不是由用户请求触发）。

要做到这一点，请查看 cake 的 AppShell 类，[这本书在这里谈到了它](http://book.cakephp.org/2.0/en/console-and-shells.html#creating-a-shell)。然后，您可以将其链接到 cron 作业。如果您通过 thru 创建文件`Cache::write`，cake 应该知道它是一个新的缓存文件并透明地读取它。您可能希望保留“如果找不到缓存”块，以防您的 cronjob 失败。

cake 中的 Shells & Tasks 很有趣，可以让您将应用程序从专门使用请求/响应模型中解放出来。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-11T15:10:16.680

我认为答案在于计算出这个查询需要多长时间：

```
$total = $this->TrackStoryView->find('all', array(
           'fields' => array('COUNT(story_id) AS theCount', 'headline', 'url'), 
           'conditions' => array('date BETWEEN ? AND ?' => array($start_date,$end_date)),
           'group' => 'story_id',
           'order' => array('theCount DESC'),
           'limit' => 20,
        )); 
```

假设它需要 500 毫秒。

您每秒获得 100 次点击，因此当缓存清除第一个请求时会发出 find 调用，然后 50 个其他人也在第一个请求完成之前发出 find 调用。

一种替代解决方案：

使缓存的内容永不过期。通过调用运行的不同操作来设置覆盖缓存的 cron 任务：

```
Cache::write('popular_stories', $total, 'short'); 
```

覆盖缓存的内容。

这样，每秒 100 个用户将始终从缓存中读取

# objective-c - 如何在目标c中添加图像作为按钮？

> ID：15341938
> 
> 赞同：1
> 
> 时间：2013-03-11T15:05:58.360
> 
> 标签：objective-c, ios6, uiimage

我想将图像添加为按钮，当它被点击时它应该打开一个新的视图控制器......有谁知道该怎么做？

我创建了一个按钮并添加了图像，但它并不好，因为当我单击图像时，它会在图像周围动画一个正方形，这是我不想要的。这就是我所做的。

```
- (void)setTutorialButtonImage
{
    [self.tutorialButton setImage:[UIImage imageNamed:@"app_logo.png"] forState:UIControlStateNormal];
} 
```

有谁知道怎么做...只是一个图像，当我点击它时启动一个新控制器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:13:57.207

您可以使用禁用突出显示效果

```
self.tutorialButton.adjustsImageWhenHighlighted = NO; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:11:43.163

也尝试为选定和突出显示的状态设置相同的图像

```
[button setBackgroundImage:[UIImage imageNamed:@"app_logo.png"] forState: UIControlStateHighlighted];
[button setBackgroundImage:[UIImage imageNamed:@"app_logo.png"] forState: UIControlStateSelected]; 
```

为了获得更好的外观和感觉，您可以使用

```
- (UIImage *)resizableImageWithCapInsets:(UIEdgeInsets)capInsets 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T15:11:53.127

```
UIButton *sampleButton = [UIButton buttonWithType:UIButtonTypeCustom];
[sampleButton setFrame:CGRectMake(x, y, width, height)];
[sampleButton setBackgroundImage:[UIImage imageNamed:@"image.png"] forState:UIControlStateNormal];
[sampleButton addTarget:self action:@selector(buttonPressed) forControlEvents:UIControlEventTouchUpInside];
[self.view addSubview:sampleButton]; 
```

# ruby-on-rails - 在渲染视图期间使用模板中定义的 form_for formBuilder？

> ID：15341939
> 
> 赞同：0
> 
> 时间：2013-03-11T15:05:58.920
> 
> 标签：ruby-on-rails, templates

我尝试创建一个通用模板，包括一个具有动态内容的**表单**，例如由使用模板的视图定义。（我当前的实现失败，因为视图在渲染过程中抱怨**f**（表单构建器）未定义。

[Rails 1.9.6] 我的模板名为“LAY”

```
 <%= form_for @q_object, :url => request.fullpath do |f|%>
    <!--Do something that happens on every page --> 
    <table>
      <%= yield %>
      <tr><td style="text-align: center">
          <%= f.submit "Submit" %>
        </td></tr>
    </table>
  <%end%> 
```

我的观点

```
<tr><td>
  <%= f.text_area :txt, :rows => 6, :cols => -1, :style => "width:100%" %>
 </td></tr> 
```

我的控制器

```
class Controller < ApplicationController
  layout "LAY" 
```

我的问题在渲染视图轨道期间抱怨 f （表单构建器）未定义。

我做错了什么（显然），但我怎样才能坚持实施理念？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T00:34:28.353

为什么你需要做这个布局？您可以将其设为模板，然后为您想要的每种单独类型的表单设置部分模板。如果你这样做，那么你可以像这样渲染你的个人部分并将它们传递给表单构建器。

```
<%= render :partial => @unique_fields_name, :locals => {:f => f} %> 
```

我会使用部分模板，但如果您真的想使用部分布局，请查看[此](https://stackoverflow.com/questions/6511028/drying-up-a-helper-wrap-form-for-and-access-local-form-variable)问题的第二个答案。它解释了如何设置部分布局。此外，[RailsGuides](http://guides.rubyonrails.org/layouts_and_rendering.html#understanding-yield)有一个关于渲染布局的精彩部分，您可能应该检查一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:11:11.693

我发现它非常简单：只需在模板中创建**form_for并在视图中使用****fields_for**。Fields_for 为您提供了一个表单构建器，但不会创建 html-form...

```
<%=fields_for @q_object, nil, {:builder => MyFormBuilder} do |f|%>
      <%= f.text_area :txt, :rows => 6, :cols => -1, :style => "width:100%" %>
<%end%> 
```

PS: I found NO way in passing parameters from the template to the view, like **<%= yield AweSomeParameter %>**...

# php - PHP - 即使包含它，也找不到类“HbaseClient”

> ID：15341946
> 
> 赞同：1
> 
> 时间：2013-03-11T15:06:14.583
> 
> 标签：php, hbase, thrift, thrift-protocol

一直在为这个挠头。我刚刚开始使用 PHP/Thrift 与 HBase 进行通信（我可以用 Python 做得很好）。出于某种原因，下面的代码正在生成 $client = new 行上找不到的类“HbaseClient”：

```
$GLOBALS['THRIFT_ROOT'] = 'thrift';
require_once( $GLOBALS['THRIFT_ROOT'] . '/Thrift.php' );
require_once( $GLOBALS['THRIFT_ROOT'] . '/transport/TSocket.php' );
require_once( $GLOBALS['THRIFT_ROOT'] . '/transport/TBufferedTransport.php' );
require_once( $GLOBALS['THRIFT_ROOT'] . '/protocol/TBinaryProtocol.php' );
require_once( $GLOBALS['THRIFT_ROOT'] . '/Hbase/Hbase.php' );

try
{
    $socket = new TSocket('127.0.0.1', 9090);
    $transport = new TBufferedTransport($socket, 1024, 1024);
    $protocol = new TBinaryProtocolAccelerated($transport);
    $client = new HbaseClient( $protocol );
    $transport->open();
}
catch (Exception $e)
{
    echo "Exception: %e\r\n";
} 
```

我真的不知道为什么。在 Hbase.php 包含文件中，客户端定义如下：

```
class HbaseClient implements \Hbase\HbaseIf { 
```

我在这里错过了一些非常简单的东西吗？（完整的 HBase.php：http: [//pastebin.com/6kd9r2Se](http://pastebin.com/6kd9r2Se)）

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T15:30:54.010

我相信这是一个命名空间问题。尝试放置：

```
namespace Hbase; 
```

在实例化对象的文件中**或**使用完全限定名称：

```
$client = new Hbase\HbaseClient( $protocol ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:11:20.053

你确定你把 HBase 文件夹放在 THRIFT_ROOT 目录下还是外面？

# c++ - 如何在 Visual C++ 中使用 Delphi 的寄存器调用约定调用函数？

> ID：15341954
> 
> 赞同：4
> 
> 时间：2013-03-11T15:06:30.147
> 
> 标签：c++, visual-studio, delphi, visual-c++, assembly

我有一个用 Visual C++ 2012 编写的程序，我试图调用一个用 Delphi 编写的函数（我没有源代码）。下面是 Visual C++ 中的代码：

```
int (_fastcall *test)(void*) = (int(_fastcall *)(void*))0x00489A7D;

test((void *)0x12345678); 
```

但在编译后的代码中，它实际上是：

```
.text:1000113B                 mov     eax, 489A7Dh
.text:10001140                 mov     ecx, 12345678h
.text:10001145                 call    eax 
```

我所例外的是：

```
.text:1000113B                 mov     ebx, 489A7Dh
.text:10001140                 mov     eax, 12345678h
.text:10001145                 call    ebx 
```

我知道“fastcall”使用 EAX、ECX、EDX 作为参数，但我不知道为什么 Visual C++ 编译器使用 EAX 作为入口点。EAX不应该是第一个参数（12345678h）吗？

我试图在汇编代码中调用 delphi 函数并且它可以工作，但我真的很想知道如何在不使用汇编的情况下做到这一点。

那么是否有可能让 Visual C++ 编译器生成我所例外的代码？如果是，该怎么做？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-11T15:22:18.790

Delphi 的[寄存器](http://docwiki.embarcadero.com/RADStudio/en/Procedures_and_Functions#Calling_Conventions)调用约定，也称为 Borland fastcall，在 x86上按顺序使用[EAX、EDX 和 ECX 寄存器。](http://docwiki.embarcadero.com/RADStudio/en/Program_Control#Register_Convention)

但是，微软的 fastcall 调用约定使用不同的寄存器。它根本不使用 EAX。相反，它使用 ECX 和 EDX 寄存器作为前两个参数，如[文档所述](http://msdn.microsoft.com/en-us/library/6xa169sk.aspx)。

因此，有了这些信息，您可能可以编写一些汇编`register`程序，通过将参数移动到`EAX`寄存器中来从 C++ 进行 Delphi 函数调用。然而，让 Delphi 编译器来做这件事会容易得多。特别是当我想象您的真正问题涉及多个功能和多个参数时。

我建议你写一些 Pascal 代码来适应`stdcall`和`register`。

```
function FuncRegister(param: Pointer): Integer; register; external '...';

function FuncStdcall(param: Pointer): Integer; stdcall;
begin
  Result := FuncRegister(param);
end;

exports
  FuncStdcall; 
```

然后您可以`FuncStdcall`从您的 C++ 代码中调用并让 Delphi 编译器处理参数传递。

# c++ - 如何添加静态链接运行时程序集？

> ID：15341955
> 
> 赞同：0
> 
> 时间：2013-03-11T15:06:32.960
> 
> 标签：c++, visual-studio, assemblies, exe, static-linking

我正在尝试在另一台未安装 Visual Studio 的计算机上运行 exe 文件。当我尝试运行该文件时，我收到错误消息：此应用程序无法启动，因为应用程序配置不正确。重新安装应用程序可能会解决此问题。

我试着寻找答案，我很多网站都提到了静态链接运行时程序集

但我不知道如何将它们添加到我的项目中。

（程序在 c++ 控制台中的 Visual Studios 2008 中）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:31:25.867

很难准确地说出缺少哪些库。这里有一些想法。

*   您正在部署调试版本。由于非开发计算机通常没有部署调试库 (mfc*xxxd.dll & co.)，您的应用程序无法启动。您应该部署发布版本。
*   您的应用程序是使用目标计算机上不可用的较新版本的 C 运行时或 MFC 构建的。您应该为您的 VS / 开发工具版本安装 Visual C++ 可再发行包。
*   如果您无法安装它，您应该将运行时/MFC 库静态链接到您的应用程序。根据您的 VS 版本，您需要转到项目设置并检查运行时库的正确版本（静态与动态）

[如果仍然存在问题，您应该在目标机器上使用Dependency Walker](http://dependencywalker.com)之类的工具准确检查缺少哪些 dll （实际上这应该始终是您应该做的第一件事，而不是猜测）。它将向您显示缺少哪些 dll。如果一切正常，那么您缺少一些延迟加载或 COM dll - 这不是在启动时加载而是按需加载。您可以使用 DependencyWalker 来分析应用程序的启动，以准确查看缺少的内容。

# javascript - 从价值中创造“时间完成”

> ID：15341956
> 
> 赞同：0
> 
> 时间：2013-03-11T15:06:33.180
> 
> 标签：javascript, jquery, math, time

我在 jQuery 中有一个带有暂停/恢复功能的倒数计时器。

我想取“totalSeconds”值并将其添加到当前时间，以便我可以显示倒计时结束的时间......

所以页面加载上的“当前时间”+“totalSeconds”（？）

您将如何计算并`<p>`使用 jQuery 创建标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:36:30.463

下面的代码会将`<p>`元素附加到 body 标记的末尾。如果你想格式化日期，你可以使用[这个](http://archive.plugins.jquery.com/project/jquery-dateFormat)jquery 插件，或者一些简单的字符串操作。

`var totalSeconds = 300;
var date = new Date();
date.setSeconds(date.getSeconds() + totalSeconds);
$("body").append("<p>"+date+"</p>");`

# c# - 如何在 C# 4.0 中使任务进入睡眠状态（或延迟）？

> ID：15341962
> 
> 赞同：72
> 
> 时间：2013-03-11T15:06:49.030
> 
> 标签：c#, .net, multithreading, parallel-processing, task-parallel-library

.NET 4.5 中 有[Task.Delay](http://msdn.microsoft.com/en-us/library/hh160377)

我怎样才能在 .NET 4.0 中做同样的事情？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2013-03-12T09:12:38.973

使用来自 NuGet的[Microsoft.Bcl.Async](http://nuget.org/packages/Microsoft.Bcl.Async/)`TaskEx.Delay`包，它具有.

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2013-03-11T15:20:56.323

您可以在 4.0中使用 a`Timer`创建方法：`Delay`

```
public static Task Delay(double milliseconds)
{
    var tcs = new TaskCompletionSource<bool>();
    System.Timers.Timer timer = new System.Timers.Timer();
    timer.Elapsed+=(obj, args) =>
    {
        tcs.TrySetResult(true);
    };
    timer.Interval = milliseconds;
    timer.AutoReset = false;
    timer.Start();
    return tcs.Task;
} 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-03-11T15:14:28.783

```
using System;
using System.Threading;
using System.Threading.Tasks;

class Program
{
    static void Main()
    {
        Delay(2000).ContinueWith(_ => Console.WriteLine("Done"));
        Console.Read();
    }

    static Task Delay(int milliseconds)
    {
        var tcs = new TaskCompletionSource<object>();
        new Timer(_ => tcs.SetResult(null)).Change(milliseconds, -1);
        return tcs.Task;
    }
} 
```

从[如何在 4.0 中实现 Task.Delay部分](http://stevenhollidge.blogspot.com/2012/06/async-taskdelay.html)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-02-26T11:57:36.133

下面是可取消的 Task.Delay 实现的代码和示例工具。您可能对该`Delay`方法感兴趣。：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace DelayImplementation
{
    class Program
    {
        static void Main(string[] args)
        {
            System.Threading.CancellationTokenSource tcs = new System.Threading.CancellationTokenSource();

            int id = 1;
            Console.WriteLine(string.Format("Starting new delay task {0}. This one will be cancelled.", id));
            Task delayTask = Delay(8000, tcs.Token);
            HandleTask(delayTask, id);

            System.Threading.Thread.Sleep(2000);
            tcs.Cancel();

            id = 2;
            System.Threading.CancellationTokenSource tcs2 = new System.Threading.CancellationTokenSource();
            Console.WriteLine(string.Format("Starting delay task {0}. This one will NOT be cancelled.", id));
            var delayTask2 = Delay(4000, tcs2.Token);
            HandleTask(delayTask2, id);

            System.Console.ReadLine();
        }

        private static void HandleTask(Task delayTask, int id)
        {
            delayTask.ContinueWith(p => Console.WriteLine(string.Format("Task {0} was cancelled.", id)), TaskContinuationOptions.OnlyOnCanceled);
            delayTask.ContinueWith(p => Console.WriteLine(string.Format("Task {0} was completed.", id)), TaskContinuationOptions.OnlyOnRanToCompletion);
        }

        static Task Delay(int delayTime, System.Threading.CancellationToken token)
        {
            TaskCompletionSource<object> tcs = new TaskCompletionSource<object>();

            if (delayTime < 0) throw new ArgumentOutOfRangeException("Delay time cannot be under 0");

            System.Threading.Timer timer = null;
            timer = new System.Threading.Timer(p =>
            {
                timer.Dispose(); //stop the timer
                tcs.TrySetResult(null); //timer expired, attempt to move task to the completed state.
            }, null, delayTime, System.Threading.Timeout.Infinite);

            token.Register(() =>
                {
                    timer.Dispose(); //stop the timer
                    tcs.TrySetCanceled(); //attempt to mode task to canceled state
                });

            return tcs.Task;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-07T03:47:18.823

从这个[答案](https://stackoverflow.com/a/32332759/4955344)扩展想法：

```
new AutoResetEvent(false).WaitOne(1000); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-11T20:43:51.323

您可以下载[Visual Studio Async CTP](http://www.microsoft.com/en-us/download/details.aspx?id=9983)并使用 TaskEx.Delay

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-26T19:02:45.983

```
 public static void DelayExecute(double delay, Action actionToExecute)
    {
        if (actionToExecute != null)
        {
            var timer = new DispatcherTimer
            {
                Interval = TimeSpan.FromMilliseconds(delay)
            };
            timer.Tick += (delegate
            {
                timer.Stop();
                actionToExecute();
            });
            timer.Start();
        }
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-09-01T13:20:01.503

在许多情况下，纯粹的 AutoResetEvent 比 Thread.Sleep()...

```
AutoResetEvent pause = new AutoResetEvent(false);
Task timeout = Task.Factory.StartNew(()=>{
pause.WaitOne(1000, true);
}); 
```

希望它有所帮助

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-26T15:10:42.863

这是一个简洁的、基于计时器的实现，并进行了适当的清理：

```
var wait = new TaskCompletionSource<bool>();
using (new Timer(_ => wait.SetResult(false), null, delay, Timeout.Infinite))
    await wait.Task; 
```

要在 .NET 4.0 上使用此代码，您需要[Microsoft.Bcl.Async](https://www.nuget.org/packages/Microsoft.Bcl.Async/) NuGet 包。

# magento - Magento。为什么在管理网格中，即使使用 addColumnAfter，该列也始终显示在末尾

> ID：15341963
> 
> 赞同：2
> 
> 时间：2013-03-11T15:06:49.420
> 
> 标签：magento

我创建了一个观察者，它在管理员的时事通讯网格中添加了一个字段，如下所示：

```
public function AddItemColumnToGrid($observer)
{
...
    if ($_type == 'adminhtml/newsletter_subscriber_grid') {

        $_block->addColumnAfter('subscriber_name', array(
            'header'=> Mage::helper('newsletter')->__('Name'),
            'type'  => 'text',
            'index' => 'subscriber_name',
        ), 'subscriber_email');
    }
...
} 
```

我想不通。但是 Magento 总是在最后显示我的 Subscriber_name 字段（作为顺序中的最后一个）。ColumnAfter 不起作用。为什么 ？

我正在解决这个问题：

```
 <events>
        <adminhtml_block_html_before> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T16:32:56.817

这是因为排序发生在您进入 HTML 生成之前：

**Mage_Adminhtml_Block_Widget_Grid：**

```
protected function _beforeToHtml()
{
    $this->_prepareGrid();             // <-- sort columns
    return parent::_beforeToHtml();    // <-- dispatch event
} 
```

您可以做的是在添加列后再次排序：

```
 $_block->addColumnAfter('subscriber_name', array(
        'header'=> Mage::helper('newsletter')->__('Name'),
        'type'  => 'text',
        'index' => 'subscriber_name',
    ), 'subscriber_email');
    $_block->sortColumnsByOrder(); 
```

# c# - Thread.CurrentPrincipal 已通过身份验证，但 ClaimsPrincipal.Current 未通过

> ID：15341966
> 
> 赞同：7
> 
> 时间：2013-03-11T15:06:54.693
> 
> 标签：c#, asp.net-web-api, .net-4.5, identity, claims-based-identity

我在我的 WebApi 项目中使用基于声明的授权，并且有一种方法可以检查当前身份是否经过身份验证。当我使用`ClaimsPrincipal.Current`当前身份时，没有经过身份验证，但是当我使用`Thread.CurrentPrincipal`它时。

```
ClaimsPrincipal.Current.Identity.IsAuthenticated; //False
Thread.CurrentPrincipal.Identity.IsAuthenticated; //True 
```

这似乎很奇怪，特别是因为[MSDN 说](http://msdn.microsoft.com/en-us/library/system.security.claims.claimsprincipal.current.aspx) ClaimsPrincipal.Current 只返回 Thread.CurrentPrincipal：

> **评论**
> 
> 默认情况下，返回 Thread.CurrentPrincipal。您可以通过设置 ClaimsPrincipalSelector 属性来更改此行为，以指定要调用的委托以确定当前主体。

有人可以解释一下为什么`ClaimsPrincipal`没有经过身份验证，而理论上两者都包含相同的身份吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-11T15:28:55.480

简而言之，文档说它`Thread.CurrentPrincipal`默认返回是不正确的。

它实际返回的是一个`ClaimsPrincipal` *包装* `Thread.CurrentPrincipal`（如果不是，实际上，已经是 a `ClaimsPrincipal`），使用这个构造函数：

```
public ClaimsPrincipal(IPrincipal principal)
{
    this.m_version = "1.0";
    this.m_identities = new List<ClaimsIdentity>();
    if (principal == null)
    {
        throw new ArgumentNullException("principal");
    }
    ClaimsPrincipal principal2 = principal as ClaimsPrincipal;
    if (principal2 == null)
    {
        this.m_identities.Add(new ClaimsIdentity(principal.Identity));
    }
    else if (principal2.Identities != null)
    {
        this.m_identities.AddRange(principal2.Identities);
    }
} 
```

反过来，正如您所希望看到的，这将返回一个`ClaimsIdentity`包装*主体*身份的 a （同样，如果它不是，实际上已经是 a `ClaimsIdentity`）。

在构建 时`ClaimsIdentity`，我可以看到它最终不会设置身份验证类型（并因此创建一个未经身份验证的身份）的唯一地方是：

```
if(identity is WindowsIdentity)
{
   try
   {
      this.m_authenticationType = identity.AuthenticationType;
   }
   catch(UnauthorizedAccessException)
   {
      this.m_authenticationType = null;
   }
} 
```

因此，*如果*您访问的身份`Thread.CurrentPrincipal.Identity`实际上是一个`WindowsIdentity`实例，并且在您运行的上下文中您拥有受限权限，则构造的`ClaimsIdentity`实例将具有`IsAuthenticated`false。

# ios - 从 PhoneGap iOS 应用程序中删除文本选择

> ID：15341967
> 
> 赞同：4
> 
> 时间：2013-03-11T15:06:55.550
> 
> 标签：ios, cordova

我正在尝试找到一种方法来限制整个 PhoneGap 应用程序中的文本选择。有人知道这样做的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-02-12T07:48:09.107

这对你有用：-

```
<style type="text/css">
   *:not(input):not(textarea) {
   -webkit-user-select: none; /* disable selection/Copy of UIWebView */
   -webkit-touch-callout: none; /* disable the IOS popup when long-press on a link */
  }     
</style> 
```

使用 java 脚本：-

```
 document.documentElement.style.webkitTouchCallout = "none";
 document.documentElement.style.webkitUserSelect = "none"; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-02-11T22:43:38.187

```
html {
-webkit-user-select: none;
} 
```

你的 css 代码中的这个小成分会变魔术！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-09-27T20:13:34.523

在 iOS 9 中，有一个错误导致`-webkit-user-select: none;`无法正常工作。有一个插件可以解决这个问题

[https://github.com/EddyVerbruggen/cordova-plugin-ios-longpress-fix](https://github.com/EddyVerbruggen/cordova-plugin-ios-longpress-fix)

感谢 Frederik Wessberg [https://stackoverflow.com/a/32737049/741850](https://stackoverflow.com/a/32737049/741850)

# bash - 检查最后一个命令

> ID：15341969
> 
> 赞同：1
> 
> 时间：2013-03-11T15:07:03.380
> 
> 标签：bash, .bash-profile

我想在每次执行时执行一些代码`cd`。我正在挂断实际测试是否`cd`是最后一个命令，但我认为我走在正确的轨道上。这是我添加到我的 bash_profile 的内容

```
update_prompt()
{
   if [ 'cd' = $1 ]; then
     #DO STUFF
   fi
}

PROMPT_COMMAND="update_prompt "$(!:0)"; $PROMPT_COMMAND" 
```

这很接近，但它会尝试实际执行 $1 中的命令，而不是将其视为字符串。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:09:21.693

**编辑：**这是我想出的解决方案。它不是直接基于问题，而是基于@schwiz 在评论中的解释：

```
update_prompt()
{
        LAST=$(history | tail -n 1 | cut -d \  -f 5)
        if [ "cd" = "$LAST" ]; then
          # DO STUFF
        fi
}

PROMPT_COMMAND="update_prompt" 
```

* * *

**回答原始问题**：比较字符串变量时将其放在括号中以避免解释：

```
update_prompt()
{
  if [ 'cd' = "$1" ]; then
    # ...
  fi
} 
```

或者，您可以考虑为 定义别名`cd`：

```
alias cd='echo executed && cd' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:21:53.890

这是一种更冗长的写作方式`!:0`，似乎可以更好地使用`PROMPT_COMMAND`：

```
PROMPT_COMMAND='update_prompt $(history -p !:0); $PROMPT_COMMAND'. 
```

单引号防止命令替换发生，直到`PROMPT_COMMAND`实际调用。从技术上讲，没有发生历史扩展；您正在使用该`history`命令将`!:0`字符串作为参数进行处理，但这确实与预期的历史扩展具有相同的效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T16:08:12.577

我会编写一个 wraps 的 shell 函数`cd`，而不是`PROMPT_COMMAND`用来检查最后执行的命令：

```
cd () {
    builtin cd "$@"
    # CUSTOM CODE HERE
} 
```

# gwt - 如何从 Java 应用程序以编程方式编译 GWT 项目？

> ID：15341971
> 
> 赞同：1
> 
> 时间：2013-03-11T15:07:07.327
> 
> 标签：gwt, gwt-compiler

我需要从 Java App 编译一个 GWT 项目。所以我用 CompilerOptions 创建了一个 Compiler 实例，它设置输出目录等。

我的代码是这样的：

```
 Compiler compiler=new Compiler(new CompilerOptions() {......
....
}

   ModuleDef def=new ModuleDef("sampleweb");
            def.clear();
            def.addSourcePackage("D:\\projects\\sampleweb\\src\\com\\sample\\web", new String[]{"client"}, new String[]{}, new String[]{}, true, false);
            def.addGwtXmlFile(new File("D:\\projects\\sampleweb\\src\\com\\sampleweb\\web\\Sampleweb.gwt.xml"));
            TreeLogger logger=new SwingTreeLogger(new SwingLoggerPanel(Type.ALL, new File("x.txt")));
            compiler.run(logger,def); 
```

调用时`compiler.run`，会抛出如图所示的 NullPointerException

```
Exception in thread "main" java.lang.NullPointerException
    at com.google.gwt.dev.cfg.ModuleDef.getCompilationState(ModuleDef.java:373)
    at com.google.gwt.dev.Precompile.precompile(Precompile.java:246)
    at com.google.gwt.dev.Precompile.precompile(Precompile.java:229)
    at com.google.gwt.dev.Precompile.precompile(Precompile.java:141)
    at com.google.gwt.dev.Compiler.run(Compiler.java:232)
    at com.asklepian.TestApp.Starter.main(Starter.java:400) 
```

我应该如何配置编译器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T17:20:34.787

我将只创建 Java 源代码和 XML 模块代码，然后执行调用 GWT 编译器的 Java 进程。GWT 编译器位于 com.google.gwt.dev.Compiler，您可以在 Windows 中使用 java 命令从 DOS 命令 shell 执行它。编译器需要的唯一参数是 GWT 模块位置（模块 xml 文件的位置）。

# log4j - log4j 文件不滚动 - Websphere 7，Windows

> ID：15341976
> 
> 赞同：3
> 
> 时间：2013-03-11T15:07:20.403
> 
> 标签：log4j, websphere, websphere-7

我有一个使用 log4j 在 Windows 服务器环境中的 Websphere 上运行的应用程序。系统正在记录并且似乎遵守 log4j.properties 中定义的 MaxFileSize 限制（20KB - 见下文），但没有滚动日志文件。相反，它只是覆盖现有的日志文件。

这是我在 Websphere 中定义的 log4j.properties 文件：

```
log4j.rootLogger=debug, file

log4j.appender.file=org.apache.log4j.RollingFileAppender
log4j.appender.file.File=F:\\<log_file_directory\\<log_file_name>.log
log4j.appender.file.MaxFileSize=20KB
log4j.appender.file.MaxBackupIndex=50
log4j.appender.file.Append=true
log4j.appender.file.layout=org.apache.log4j.PatternLayout
log4j.appender.file.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n 
```

我的理论是，当 log4j 尝试滚动文件时，应用程序/JVM 会保留对日志文件的引用，并且 Windows 看到该文件正在使用中并阻止它被移动。但我不确定这一点。

任何人都看到日志文件不会滚动的任何原因？或者我的理论是否正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T19:53:54.870

我的问题的解决方案是将 log4j 设置为 WebSphere 中的共享 jar 文件。每个单独的应用程序都有一个对 log4j 开放的文件描述符，以防止日志在遇到`MaxFileSize`.

一旦我将 log4j 设置为共享 jar 并退回服务器，日志就会按预期滚动。我用多种尺寸对此进行了测试，`MaxFileSize`并且都按预期工作。

# git - 删除从特定分支合并的所有提交

> ID：15341977
> 
> 赞同：3
> 
> 时间：2013-03-11T15:07:21.197
> 
> 标签：git

我一直在一个分支上构建一个功能（我们称之为'feature1'），我已经多次合并到我的主分支（'master'）中。我已经间歇性地将其他功能分支合并到 master 中，所以我从“feature1”到“master”的合并提交在上周的其他提交中有点分散。

我想要做的：从 'feature1' -> 'master' 中删除所有合并，就好像它们从未发生过一样。来自其他分支的所有其他工作，我想留在'master'中保持不变。

有没有办法删除仅来自特定来源的提交？即只是'feature1'分支？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T16:05:36.007

好吧，如果这是你只需要做一次的事情，并且合并的数量是可控的，那么你可以这样做：

```
git rebase -i <sha1 of master before I started merging evil branch in> 
```

并手动编辑出您不想要的合并提交。

我确信有一种更自动化的方式来执行此操作`filter-branch`，但如果它是一次性的，那么只需使用 rebase 就可以更快地完成工作。

# .net - 如果我将 .NET 工件打包为 nupkgs，它们如何与 Nolio 一起部署？

> ID：15341979
> 
> 赞同：3
> 
> 时间：2013-03-11T15:07:29.980
> 
> 标签：.net, nuget, nolio

作为 Nolio 的初学者，如果我误解了这一点，我深表歉意。

让我们切入正题：如果我将构建的 .NET 工件作为 nupkg 打包到 CI 系统中并将它们放入 nuget 存储库中，如何使用 Nolio 将它们部署到我的目标环境中？

换句话说，Nolio 是否支持打包在 nupkgs 中的 .NET 工件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T14:28:19.080

首先，您最好在 Nolio[社区](http://www.noliosoft.com/portal/login)中寻求更正式的指南并从他们的支持中获得一些帮助。而且我不确定您是否需要一些特定的 .NET 支持（尽管 Nolio 确实有 iis/.net[支持](http://www.noliosoft.com/solutions/microsoft)）

但简而言之（非常短）：

1.  使用要部署的工件列表创建清单 (xml) 文件
2.  创建一个“元”进程，它将解析清单文件并在 Nolio 中为每个这些工件定义一个存储库工件（这将是您的初始化步骤）
3.  创建一个部署这些工件的流程，该流程将在您要部署文件的实际代理上运行。迭代清单并使用“ROC - Get Artifact”操作将文件获取到部署的机器，并使用其他操作根据需要操作文件。
4.  使用这些过程创建模板。
5.  您可以使用 CI 工具中的 rest 调用从该模板创建一个版本，并在每次构建后运行它。

（但是如果不了解您的具体架构，就无法给出好的答案，并且有很多方法可以使用 Nolio 部署工件......）

# windows-8 - 将 Office 快捷方式固定到 Windows 8 开始的脚本

> ID：15341982
> 
> 赞同：0
> 
> 时间：2013-03-11T15:07:35.130
> 
> 标签：windows-8, vbscript

我需要能够将 MS Office 2013 快捷方式固定在 Windows 8 开始菜单上。我用这个[脚本](http://www.labnol.org/software/shutdown-restart-in-windows-8/20989/)来固定注销按钮，效果很好。我已经修改它以尝试固定 Excel 2013，但它不起作用。

```
 '
' This script will create shortcuts in the Start Menu
'
set WshShell = WScript.CreateObject("WScript.Shell")
strStartMenu = WshShell.SpecialFolders("StartMenu")

set oShellLink = WshShell.CreateShortcut(strStartMenu & "\Excel.lnk")
oShellLink.TargetPath = "C:\Program Files (x86)\Microsoft Office\Office15\EXCEL.EXE"
oShellLink.WindowStyle = 1
oShellLink.IconLocation = "%ProgramFiles% (x86)\Microsoft Office\Office15\XLICONS.EXE"
oShellLink.Description = "Microsoft Excel 2013"
oShellLink.WorkingDirectory = "C:\Program Files (x86)\Microsoft Office\Office15"
oShellLink.Save
Set oShellLink = Nothing

Wscript.Echo "Created Icons" 
```

我究竟做错了什么？

# python - 一次运行 x 个命令

> ID：15341987
> 
> 赞同：2
> 
> 时间：2013-03-11T15:07:42.627
> 
> 标签：python, subprocess, popen

我必须循环运行 200 个文件的程序。

现在我让它们像这样运行：

```
for combo in it.combinations(files, 2):
    cmd = ["command", combo[0], combo[1]]
    subprocess.Popen(cmd) 
```

我想一次只运行 60 个，以免使计算机不堪重负，该命令非常占用处理器资源。一旦有 60 个进程正在运行，那么暂停循环的最佳方法是什么，然后在一个进程完成后重新开始，以便始终有 60 个进程在运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T15:49:43.707

```
#!/usr/bin/env python
import itertools
import subprocess
from multiprocessing.dummy import Pool # use threads

def run(combo):
    cmd = ["command", combo[0], combo[1]]
    return combo, subprocess.call(cmd)

def main():
    p = Pool(60) # 60 subprocesses at a time
    for combo, rc in p.imap_unordered(run, itertools.combinations(files, 2)):
        print("%s exited with %s" % (combo, rc))
    p.close()
    p.join()

if __name__ == "__main__":
    main() 
```

[这个答案演示了限制并发子进程数量的各种技术](https://stackoverflow.com/a/9874484/4279)：它显示了基于 multiprocessing.Pool、concurrent.futures、threading + Queue 的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:25:24.987

这可能会有所帮助：

```
import itertools as it
import time
import subprocess

files = range(5)
max_load = 3
sleep_interval = 0.5

pid_list = []
for combo in it.combinations(files, 2):
  # Random command that takes time
  cmd = ['sleep', str(combo[0]+combo[1])]

  # Launch and record this command
  print "Launching: ", cmd
  pid = subprocess.Popen(cmd)
  pid_list.append(pid)

  # Deal with condtion of exceeding maximum load
  while len(filter(lambda x: x.poll() is None, pid_list)) >= max_load:
    time.sleep(sleep_interval) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T15:16:09.847

你想要这样的东西：

```
import socket
import threading
import Queue
import subprocess

class IPThread(threading.Thread):
    def __init__(self, queue, num):
        super(IPThread, self).__init__()
        self.queue = queue
        self.num = num
    def run(self):
        while True:
            try:
                args = self.queue.get_nowait()
                cmd = ["echo"] + [str(i) for i in args]
                p = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
                out, err = p.communicate()
                print out
            except Queue.Empty:
                # Nothing left in the Queue -- we are done
                print "Queue %d done" % self.num
                break
            except Exception as err:
                # Handle exception
                print err
            self.queue.task_done()

def create_threads(q, size):
    for i in range(size):
        thread = IPThread(q, i)
        thread.setDaemon(True)
        thread.start()
    q.join()

def fill_queue(q):
    # Call q.put(args) in a loop to populate Queue with arguments
    from itertools import permutations
    x = list(range(20))
    for arg1, arg2 in permutations(x, 2):
        q.put([arg1, arg2])
    print q.qsize()

def main():
    q = Queue.Queue()
    fill_queue(q)
    create_threads(q, 60)
    print "Done"

if __name__ == '__main__':
    main() 
```

创建要处理的事情的队列。专门化您的 Thread 派生类。旋转你的线程。等待他们完成。

您可以看出这些任务正在同时运行，因为它们的输出相互干扰。这是一个特点！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T15:17:58.057

你可以做一些非常简单的事情，比如：

```
from time import sleep

count = 0
for combo in it.combinations(files, 2):
    while count < 60:
        cmd = ["command", combo[0], combo[1]]
        subprocess.Popen(cmd)
        count = count + 1
        if subprocess_is_done:
            count = count - 1
    sleep(5) 
```

显然，您需要弄清楚如何`subprocess_is_done`从您的命令中获取信息。

据我所知，这适用于琐碎的案例，但不知道您要运行什么...

# ruby - 使用正则表达式解析数字

> ID：15341988
> 
> 赞同：1
> 
> 时间：2013-03-11T15:07:44.630
> 
> 标签：ruby, regex, parsing

我想取一个数字并将其格式化为价格（作为字符串）。例如，我想取 250000 并显示 $250,000。如何使用正则表达式完成此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T15:28:52.520

要添加逗号，您可以尝试以下操作：

```
/(\d)(?=(?:\d{3})+$)/ 
```

然后将每个匹配替换为`\1,`.

像这样：

```
"12345512312".gsub(/(\d)(?=(?:\d{3})+$)/,'\1,')  => "12,345,512,312" 
```

这将匹配任意数字后跟任意数量的 3 位组。

**例如**，上例中的第一个`2`后面跟着 3 个组`345`：`512`和`312`。第一个`5`后面是 2 组：`512`and`312`等。

不确定您是否可以`$`在同一个正则表达式中添加。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T15:31:04.420

与正则表达式匹配，#@ 很痛苦！在这种情况下，因为正则表达式引擎从字符串的开头开始匹配，而不是结尾（查找从字符串结尾开始并向后移动的 3 位模式）。我建议要么做这样的事情：

```
format_int = ->(s) do
  str = s.reverse.scan(/\d{1,3}/).join(',').reverse
  "$#{str}"
end

format_int['2500600'] => "$2,500,600" 
```

...使用[`Kernel#sprintf`](http://ruby-doc.org/core-2.0/Kernel.html#method-i-sprintf)（这可能有点棘手）或者，如您所愿：我错了，可以使用正则表达式来实现，如[here](https://stackoverflow.com/questions/6458990/how-to-format-a-number-1000-as-1-000)和[here](https://stackoverflow.com/questions/1078347/is-there-a-rails-trick-to-adding-commas-to-large-numbers)所示。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-11T15:29:30.143

试试这个（免责声明 - 不是正则表达式）：

```
def prettify(n)
  int, dec = n.to_s.split('.')
  int = int.reverse.scan(/.{1,3}/).join(',').reverse
  [int, dec].reject(&:empty?).join('.')
end 
```

可能是这种东西的宝石

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-20T20:49:30.723

你应该使用`number_to_currency helper`

```
number_to_currency(1234567890.50)                    # => $1,234,567,890.50
number_to_currency(1234567890.506)                   # => $1,234,567,890.51
number_to_currency(1234567890.506, precision: 3)     # => $1,234,567,890.506
number_to_currency(1234567890.506, locale: :fr)      # => 1 234 567 890,51 €
number_to_currency("123a456")                        # => $123a456

number_to_currency("123a456", raise: true)           # => InvalidNumberError

number_to_currency(-1234567890.50, negative_format: "(%u%n)")
# => ($1,234,567,890.50)
number_to_currency(1234567890.50, unit: "&pound;", separator: ",", delimiter: "")
# => &pound;1234567890,50
number_to_currency(1234567890.50, unit: "&pound;", separator: ",", delimiter: "", format: "%n %u")
# => 1234567890,50 &pound; 
```

有关更多信息，请查看[http://api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html](http://api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html)

# python - python 正则表达式不适用于字符串编码

> ID：15341989
> 
> 赞同：1
> 
> 时间：2013-03-11T15:07:44.640
> 
> 标签：python, regex, unicode

我有一个字符串 (g)，我在其上运行一个简单的正则表达式来查找一个数字。问题是正则表达式不适用于该字符串类型（编码？）。但是，“正常”字符串有效。我错过了什么？请参阅下面的步骤，如repl上所示：

（示例是在线扑克锦标赛的摘要）

***不工作：***

```
>>> g
'F\x00u\x00l\x00l\x00 \x00T\x00i\x00l\x00t\x00 \x00P\x00o\x00k\x00e\x00r\x00 \x00T\x00o\x00u\x00r\x00n\x00a\x00m\x00e\x00n\x00t\x00 \x00S\x00u\x00m\x00m\x00a\x00r\x00y\x00 \x00$\x002\x00.\x002\x005\x00 \x00H\x00e\x00a\x00d\x00s\x00-\x00U\x00p\x00 \x00S\x00i\x00t\x00 \x00&\x00 \x00G\x00o\x00 \x00(\x002\x005\x000\x005\x005\x005\x009\x001\x004\x00)\x00 \x002\x00-\x007\x00 \x00T\x00r\x00i\x00p\x00l\x00e\x00 \x00D\x00r\x00a\x00w\x00 \x00L\x00i\x00m\x00i\x00t\x00 \x00(\x00T\x00u\x00r\x00b\x00o\x00,\x00 \x00H\x00e\x00a\x00d\x00s\x00 \x00U\x00p\x00)\x00\n\x00B\x00u\x00y\x00-\x00I\x00n\x00:\x00 \x00$\x002\x00.\x001\x002\x00 \x00+\x00 \x00$\x000\x00.\x001\x003\x00\n\x00B\x00u\x00y\x00-\x00I\x00n\x00 \x00C\x00h\x00i\x00p\x00s\x00:\x00 \x001\x005\x000\x000\x00\n\x002\x00 \x00E\x00n\x00t\x00r\x00i\x00e\x00s\x00\n\x00T\x00o\x00t\x00a\x00l\x00 \x00P\x00r\x00i\x00z\x00e\x00 \x00P\x00o\x00o\x00l\x00:\x00 \x00$\x004\x00.\x002\x004\x00\n\x00T\x00o\x00u\x00r\x00n\x00a\x00m\x00e\x00n\x00t\x00 \x00s\x00t\x00a\x00r\x00t\x00e\x00d\x00:\x00 \x002\x000\x001\x003\x00/\x000\x003\x00/\x000\x008\x00 \x000\x006\x00:\x000\x000\x00:\x002\x007\x00 \x00E\x00T\x00\n\x00T\x00o\x00u\x00r\x00n\x00a\x00m\x00e\x00n\x00t\x00 \x00f\x00i\x00n\x00i\x00s\x00h\x00e\x00d\x00:\x00 \x002\x000\x001\x003\x00/\x000\x003\x00/\x000\x008\x00 \x000\x006\x00:\x001\x004\x00:\x003\x000\x00 \x00E\x00T\x00\n\x00\n\x001\x00:\x00 \x00A\x00n\x00d\x00r\x00e\x00y\x003\x003\x001\x000\x00,\x00 \x00$\x004\x00.\x002\x004\x00\n\x002\x00:\x00 \x00s\x00y\x00n\x00t\x00h\x00e\x00s\x00i\x00i\x00s\x00\n\x00s\x00y\x00n\x00t\x00h\x00e\x00s\x00i\x00i\x00s\x00 \x00f\x00i\x00n\x00i\x00s\x00h\x00e\x00d\x00 \x00i\x00n\x00 \x002\x00n\x00d\x00 \x00p\x00l\x00a\x00c\x00e'
>>> myre = re.compile(u"""\(([0-9]+)\)""",re.UNICODE)
>>> m = myre.search(g)
>>> m.groups()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'NoneType' object has no attribute 'groups' 
```

***在职的***

```
>>> g="Full Tilt Poker Tournament Summary $2.25 Heads-Up Sit & Go (250555914) 2-7 Triple Draw Limit (Turbo, Heads Up)"
>>> m = myre.search(g)
>>> m.groups()
('250555914',) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T15:12:27.427

您有 UTF-16 编码的数据，尽管没有 BOM（字节顺序标记）。在尝试匹配正则表达式之前先解码为 Unicode：

```
>>> g[:-1].decode('utf-16-le')
u'Full Tilt Poker Tournament Summary $2.25 Heads-Up Sit & Go (250555914) 2-7 Triple Draw Limit (Turbo, Heads Up)\nBuy-In: $2.12 + $0.13\nBuy-In Chips: 1500\n2 Entries\nTotal Prize Pool: $4.24\nTournament started: 2013/03/08 06:00:27 ET\nTournament finished: 2013/03/08 06:14:30 ET\n\n1: Andrey3310, $4.24\n2: synthesiis\nsynthesiis finished in 2nd plac'
>>> myre.search(g[:-1].decode('utf-16-le')).groups()
(u'250555914',) 
```

我必须删除最后一个字节才能进行解码，但最后一个空字节丢失了。如果您缺少最后的数据，您很可能也缺少*开头*的数据，即 BOM 所在的位置。BOM 告诉解码器使用 UTF-16 的哪个变体进行编码（小端或大端），如果没有它，我们需要明确告诉 Python 将其解码为小端。

如果您解码*完整*的数据，包括 BOM，您可以直接使用`.decode('utf-16')`。

如果您从文件中读取它，[`codecs.open()`](http://docs.python.org/2/library/codecs.html#codecs.open)请改用 Python 并将其解码为 Unicode：

```
import codecs

for line in codecs.open('filename.txt', 'r', encoding='utf16'):
    # handle line 
```

因为否则像`.readlines()`在字节级别拆分换行符之类的东西，就像 UTF-16 中的其他所有内容一样被编码为两个字节。

# sublimetext2 - 如何更改 Sublime Text Packages 目录位置？

> ID：15341993
> 
> 赞同：7
> 
> 时间：2013-03-11T15:07:55.657
> 
> 标签：sublimetext2

我想更改 Packages 目录位置或添加一个新的（在网络驱动器上。）

我不能使用符号链接。

我看了一下插件，但找不到。

我在 Windows Vista、Windows 8 上（很快。）

谢谢您的帮助。

克里斯托夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T19:06:07.597

如果版主可以将此帖子变成评论，因为这只是该问题的潜在解决方法（而不是完整的解决方案）。

使用 OSX 操作系统，我会自动备份（通过符号链接到 Dropbox）应用程序支持目录中的整个 SublimeText2 文件夹和子文件夹。由于 Dropbox 在不同的平台上工作，也许这会给原始发布者一些想法，让多台计算机使用相同的`Packages`数据。我成功地使用此方法自动同步了我的所有三 (3) 台计算机 - 即，如果`Packages`目录或子目录中的一台计算机发生任何变化，则所有计算机都会自动同步。

当然，在尝试此方法之前，请在每台计算机上备份您的数据。

# javascript - Javascript自定义应用函数

> ID：15341994
> 
> 赞同：1
> 
> 时间：2013-03-11T15:07:56.173
> 
> 标签：javascript, apply, referenceerror

我正在和一个朋友一起构建一个 javascript 库，该库应该让 HTML5 游戏创建更容易（但这实际上只是为了好玩），这里有一些我遇到问题的代码：

```
/* Calls f on all the elems of the list that pass p and implement f */
    var apply = function (f, p, list) {
        for (var i in list) {
            if (p(list[i]) === true && list[i][f] != undefined && typeof list[i][f] === 'function') {
                list[i][f]();
            }
        }
    };
    this.draw = function(p) {
        apply(moveView, p, this.views);
    }; 
```

用户将调用 this.draw 函数并将谓词传递给它。只有当视图数组中的每个对象都实现了它时，才会执行传递给 apply 函数的函数 moveView。

但是，我的控制台抛出一个错误，提示“未定义 moveView”，这是有道理的，因为 . 在我调用我的应用函数时，我不希望解释器检查 moveView 是否存在，我只想将它传递进去，以便检查每个被应用的对象是否实现了该函数。我认为也许调用 apply like`apply("draw", p, this.views);`会起作用，但那也不起作用，因为在 apply 函数中， f 不再是函数，而是字符串。我真的只是希望能够将任何通用函数名称传递给我的应用函数，这样我就可以在那里进行所有检查。

我所有的代码都可以在我的[Github](http://github.com/shadowthekid/GameBoard.js)上找到。

编辑：

```
 /*View object*/
var View = (function(){
    var constr = function(f, o, i){
        this.frame = utility.checkFrame(f);
        this.orient = utility.checkOrientation(o);
        /*user identification string*/
        this.id = i;
        this.moveView = function(){
                console.log("testing");
        };
    };
return constr;
}()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:23:42.247

我想到了。它在我的 View 对象中：

```
var View = (function(){
this.moveView = function(){
            console.log("testing");
    };
var constr = function(f, o, i){
    this.frame = utility.checkFrame(f);
    this.orient = utility.checkOrientation(o);
    /*user identification string*/
    this.id = i;

};
return constr;
}()); 
```

我将 moveView 移到 View 对象构造函数之外，不再引发错误。这是一个范围问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:14:27.337

如果您的函数在`apply()`被调用时不存在，那么它在您检查函数的对象中也不存在。

此外，如果`f`是您的函数参数，`list[i].f`则不会评估为`list[i].yourFunction`. 它将永远是`list[i].f`。您需要检查`list[i][f]`.

# javascript - 根据验证显示不同的 Fancybox - 递归过多

> ID：15341995
> 
> 赞同：0
> 
> 时间：2013-03-11T15:07:58.467
> 
> 标签：javascript, jquery, fancybox, fancybox-2, video.js

我有一个图像列表，当单击图像时，我需要进行 ajax URL 调用并验证一些参数。

如果验证没问题，我将不得不显示fancybox，否则我应该显示另一个fancybox。

**我的问题：** 当我单击图像并且如果验证为假时，另一个 fanybox 会按预期显示。但是如果验证是真的，Firebug 会抛出一个错误，说“递归过多”。

**PS::**如果验证为真，则期望显示 video.js 播放器。

**HTML 示例：**

```
<a id="videolink" href="#1" title="Test">
  <img class="vidimg" src="1.png" videoId="1" width="180" height="180" />
</a>

<div style="display:none">
      <video id="1" poster="1.png" class="video-js vjs-default-skin">
        <source src="1362993728.mp4" type='video/mp4'>
        <source src="1362993728.webm" type='video/webm'>    
        <source src="1362993728.ogv" type='video/ogg'>                 
    </video>
</div> 
```

**jQuery：**

```
$("a#videolink").click(function(){  
   $videoId = $(this).children("img.vidimg").attr("videoId"); 
   $isValid = "true" or "false" ;       // validation using .ajax() call

   if($isValid == 'true'){
      $(this).fancybox().click();
   }else{
      $("#myModal").fancybox().click()
   }                                             
}); 
```

Firebug在行上显示了“太多递归”：

```
$videoId = $(this).children("img.vidimg").attr("videoId"); 
```

在“false”的情况下要显示的其他 fanybox 内容：

```
 <div style="display:none">
    <div id="myModal"> Invalid Item</div>
 </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T06:07:22.833

以下更改帮助我按预期完成了这项工作..（在播放 fancybox 视频时仍然存在一些问题）。

**HTML 示例：**

```
<div style="display:none">
  <div id="1">
      <video poster="1.png" class="video-js vjs-default-skin">
        <source src="1362993728.mp4" type='video/mp4'>
        <source src="1362993728.webm" type='video/webm'>    
        <source src="1362993728.ogv" type='video/ogg'>                 
    </video>
  </div>
</div> 
```

**jQuery：**

```
$("img.vidimg").click(function(){  
   $videoId = $(this).attr("videoId"); 
   $isValid = "true" or "false" ;       // validation using .ajax() call

   if($isValid == 'true'){
      $('#' + $videoId ).fancybox().click();
   }else{
      $("#myModal").fancybox().click()
   }                                             
}); 
```

对此代码有任何与性能或不良代码实践相关的评论吗？

我将在这里为视频播放器问题创建一个新问题。此更改后，视频无法播放。:(

# magento - 在magento中删除客户地址

> ID：15341997
> 
> 赞同：2
> 
> 时间：2013-03-11T15:07:58.383
> 
> 标签：magento

我需要以编程方式删除客户地址，但我没有找到执行此操作的函数。

```
 $recordedAddresses = array();
    foreach ($customer->getAddresses() as $address)
     {
        $recordedAddresses = $address->toArray();
     } 
```

如上所示，我已经收集了地址的集合，我只想按 id 删除它们。奇怪的是，我没有找到示例，而是使用 API。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T15:37:19.393

查看 Mage_Customer_AddressController 控制器类和 deleteAction() 方法。基本上你只需要通过它的 id 加载地址：

`$address = Mage::getModel('customer/address')->load($addressId);`

然后删除它：

`$address->delete();`

`delete()`是一种可以针对所有模型运​​行的标准方法（请参阅 参考资料`Mage_Core_Model_Abstract`），您还可以设置`_isDeleted`标志并调用`save()`，这将具有相同的结果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-12-21T20:58:42.700

`$address->delete()`在我的案例中使用后，Magento 以某种方式保留了空实体。使用此方法时，帐户中有空地址，导致管理员无法保存客户表单。

我发现从用户帐户中实际删除地址的唯一方法是将受保护的 $_isDeleted 标志更改为 true：

`$address = Mage::getModel('customer/address')->load($addressId); $address->isDeleted(true);`

希望它为那些偶然发现相同 Magento 行为的人节省一些时间。

# javascript - Raphael translate 函数到变换函数

> ID：15341999
> 
> 赞同：0
> 
> 时间：2013-03-11T15:08:08.520
> 
> 标签：javascript, raphael

假设我有以下代码：

```
node.shape.translate(tx, ty); 
```

现在，这行代码的行为很奇怪，可能是因为在 Raphael 文档中，关于[translate 函数](http://raphaeljs.com/reference.html#Element.translate)它说：

> 已弃用！请改用 Element.transform。将给定数量的翻译添加到元素的转换列表中。

现在，我要做的就是将上面的代码“翻译”成 Raphael[变换函数](http://raphaeljs.com/reference.html#Element.transform)。我对这些细节不是很熟悉，所以我不知道该怎么做。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T15:12:51.427

我相信你只需要：

```
node.shape.transform("t" + [tx, ty]); 
```

它利用了字符串连接导致数组隐式转换为字符串的优势，使用它只会将`[tx, ty]`数组`.toString()`作为逗号分隔的列表提供给您。

他们不赞成使用干净的 API 调用来支持这种基于字符串的格式，这似乎很奇怪，尽管......